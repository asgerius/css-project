[{"tags": ["ruby-on-rails", "ruby"], "answers": [{"tags": [], "owner": {"reputation": 2771, "user_id": 1887370, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/08bf95201cabfe02acc28041cff862ff?s=128&d=identicon&r=PG", "display_name": "sakurashinken", "link": "https://stackoverflow.com/users/1887370/sakurashinken"}, "is_accepted": false, "score": 0, "last_activity_date": 1517445092, "creation_date": 1517445092, "answer_id": 48553635, "question_id": 48552214, "link": "https://stackoverflow.com/questions/48552214/kill-background-thread-ruby-on-rails/48553635#48553635", "title": "Kill Background Thread - Ruby on Rails", "body": "<p>I would install and use sidekiq for this. It comes with a dashboard and you can configure cron via the gem sidekiq-scheduler. You can then quiet or kill the job queue from the dashboard, which will stop the emails. Honestly, if you have cron jobs on ROR you should have an active job extension like sidekiq anyways.</p>\n\n<p>Baring that, I would indeed write the pid to a text file and kill via the pid.</p>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 8673386, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d8e47861f9b54702993056e5584cc881?s=128&d=identicon&r=PG&f=1", "display_name": "kojha31", "link": "https://stackoverflow.com/users/8673386/kojha31"}, "is_accepted": false, "score": 1, "last_activity_date": 1517451225, "last_edit_date": 1517451225, "creation_date": 1517450542, "answer_id": 48554258, "question_id": 48552214, "link": "https://stackoverflow.com/questions/48552214/kill-background-thread-ruby-on-rails/48554258#48554258", "title": "Kill Background Thread - Ruby on Rails", "body": "<p>You can do:</p>\n\n<pre><code>ps aux | grep #rake_task_name\nkill -9 pid\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2960, "user_id": 7426461, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/Ldwxy.jpg?s=128&g=1", "display_name": "Cannon Moyer", "link": "https://stackoverflow.com/users/7426461/cannon-moyer"}, "is_accepted": true, "score": 0, "last_activity_date": 1517585179, "creation_date": 1517585179, "answer_id": 48585849, "question_id": 48552214, "link": "https://stackoverflow.com/questions/48552214/kill-background-thread-ruby-on-rails/48585849#48585849", "title": "Kill Background Thread - Ruby on Rails", "body": "<p>So I figured it out finally. The problem was that I was launching a new <code>Thread</code> and not a new <code>Process</code></p>\n\n<p>I fixed the issue by creating a new process like this:</p>\n\n<pre><code>Process.fork do\n   #my code here that loops forever\n   logProcess(Process.pid) #this function is an external function that I created that writes the parameter to a file. \n   #you can use the id from Process.id to kill the process from the CLI.\n\nend\n</code></pre>\n\n<p>You can kill the process by getting the value of <code>Process.id</code> and running </p>\n\n<pre><code>kill -9 process_id_goes_here\n</code></pre>\n"}], "owner": {"reputation": 2960, "user_id": 7426461, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/Ldwxy.jpg?s=128&g=1", "display_name": "Cannon Moyer", "link": "https://stackoverflow.com/users/7426461/cannon-moyer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 369, "favorite_count": 0, "accepted_answer_id": 48585849, "answer_count": 3, "score": 0, "last_activity_date": 1517585179, "creation_date": 1517436299, "last_edit_date": 1517583025, "question_id": 48552214, "link": "https://stackoverflow.com/questions/48552214/kill-background-thread-ruby-on-rails", "title": "Kill Background Thread - Ruby on Rails", "body": "<p>I've created a module that starts a Thread which sends out emails ever 5 minutes. I start the thread by running a rake task once which loads in a module which starts the thread like this: </p>\n\n<pre><code>require \"#{Rails.root}/app/lib/Cron.rb\"\n\nnamespace :cron_starter do\n   desc \"TODO\"\n   task start: :environment do\n      Cron.run\n   end\n\nend\n</code></pre>\n\n<p>The code <code>Cron.run</code> calls my module method that starts the thread which runs an infinite loop. All of this works fine, but what do I do if I need to kill the thread? Is there a way to attach to the thread via another rake task and kill it? I could always write to a basic txt file and kill it that way based on flag, but that doesn't seem very elegant. Thanks in advance. </p>\n\n<p>UPDATE</p>\n\n<p>I tried </p>\n\n<pre><code>ps aux | grep cron_starter:start\n</code></pre>\n\n<p>the output I got was </p>\n\n<pre><code>root     11358  0.0  0.0  12944  1088 pts/0    S+   14:30   0:00 grep --color=auto cron_starter:start\n</code></pre>\n\n<p>I'm not real sure if any of the numbers are process ids, so I attempted to run</p>\n\n<pre><code>kill -9 11358\n\nkill -9 12944\n</code></pre>\n\n<p>The CLI responded with <code>No such process</code></p>\n\n<p>UPDATE 2</p>\n\n<p>I've tried printing Thread.current.object_id to a log file and I've attempted to kill the thread from this ID as well but again I get the same error as above. </p>\n"}, {"tags": ["ruby", "floating-point"], "comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 1, "creation_date": 1517432976, "post_id": 48551433, "comment_id": 84099075, "body": "You can use <a href=\"https://ruby-doc.org/core-2.5.0/Float.html#method-i-round\" rel=\"nofollow noreferrer\"><code>round</code></a> to make the numbers more readable, or you can use string formatting, but keep in mind rounded numbers should be considered <i>approximate</i> and not exact. Floats are nothing but trouble when dealing with monetary units."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1517433043, "post_id": 48551433, "comment_id": 84099113, "body": "That odd value you&#39;re getting is equal to -0.00000000000000036667 which is ever so slightly below zero. Welcome to the wild, wonderful world of <a href=\"https://docs.oracle.com/cd/E19957-01/806-3568/ncg_goldberg.html\" rel=\"nofollow noreferrer\">floating point math</a>."}, {"owner": {"reputation": 4600, "user_id": 5961578, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/df7cbfdd2a92a7926af3bbb8648318aa?s=128&d=identicon&r=PG", "display_name": "moveson", "link": "https://stackoverflow.com/users/5961578/moveson"}, "edited": false, "score": 2, "creation_date": 1517433318, "post_id": 48551433, "comment_id": 84099273, "body": "Yes, but <code>-3.66666666666e-16 &lt; 0</code> will return <code>true</code>. (You are using <code>&gt;</code> where you mean to use <code>&lt;</code>)."}, {"owner": {"reputation": 24560, "user_id": 4880924, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/d40e83be235d4f70428da0d42e12d427?s=128&d=identicon&r=PG&f=1", "display_name": "BKSpurgeon", "link": "https://stackoverflow.com/users/4880924/bkspurgeon"}, "edited": false, "score": 0, "creation_date": 1517433601, "post_id": 48551433, "comment_id": 84099407, "body": "@Jwan622 more explanation on what liability/distribution/addresses are would be very helpful in understanding the overall context"}, {"owner": {"reputation": 8818, "user_id": 2714301, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/23c7ba1f14e71e14f65b7b95516b0f19?s=128&d=identicon&r=PG", "display_name": "Jwan622", "link": "https://stackoverflow.com/users/2714301/jwan622"}, "reply_to_user": {"reputation": 24560, "user_id": 4880924, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/d40e83be235d4f70428da0d42e12d427?s=128&d=identicon&r=PG&f=1", "display_name": "BKSpurgeon", "link": "https://stackoverflow.com/users/4880924/bkspurgeon"}, "edited": false, "score": 0, "creation_date": 1517500069, "post_id": 48551433, "comment_id": 84129332, "body": "edited for you @BKSpurgeon"}, {"owner": {"reputation": 24560, "user_id": 4880924, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/d40e83be235d4f70428da0d42e12d427?s=128&d=identicon&r=PG&f=1", "display_name": "BKSpurgeon", "link": "https://stackoverflow.com/users/4880924/bkspurgeon"}, "edited": false, "score": 0, "creation_date": 1517652889, "post_id": 48551433, "comment_id": 84189271, "body": "why not something like this to do the displaying only: <code>bigDecimalVariable.to_s(\u201c+3F\u201d).truncate(3)</code>"}, {"owner": {"reputation": 24560, "user_id": 4880924, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/d40e83be235d4f70428da0d42e12d427?s=128&d=identicon&r=PG&f=1", "display_name": "BKSpurgeon", "link": "https://stackoverflow.com/users/4880924/bkspurgeon"}, "edited": false, "score": 0, "creation_date": 1517653016, "post_id": 48551433, "comment_id": 84189309, "body": "(you will lose accuracy if converting to floating format for displaying)"}], "owner": {"reputation": 8818, "user_id": 2714301, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/23c7ba1f14e71e14f65b7b95516b0f19?s=128&d=identicon&r=PG", "display_name": "Jwan622", "link": "https://stackoverflow.com/users/2714301/jwan622"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 105, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1517500060, "creation_date": 1517432825, "last_edit_date": 1517500060, "question_id": 48551433, "link": "https://stackoverflow.com/questions/48551433/doing-bigdecimal-accounting-with-ruby-when-can-i-convert-to-float", "title": "Doing BigDecimal accounting with Ruby. When can I convert to float?", "body": "<p>I basically want to know the best to convert my BigDecimal numbers to readable format (float perhaps) for the purposes of displaying them to the client:</p>\n\n<p>In order to figure out liabilities, I do contributions - distributions from each address.</p>\n\n<p>For example, if a person contributes 2 units to an address and that same address distributes 1 unit back to the person, then there is still a 1 unit liability. that's what's going on below. These numbers are all units of cryptocurrency.</p>\n\n<p>Here's another example:</p>\n\n<p>Say <code>address1</code> and <code>address2</code> contribute 2 coins each to <code>address3</code>, and <code>address3</code> distributes 1.0 coins to <code>address1</code> and 0.5 coins to <code>address2</code>, then <code>address3</code> has a 1.0 coin liability to <code>address1</code> and a 1.5 coin liability to <code>address2</code>.</p>\n\n<p>So the actual data using BigDecimal below:</p>\n\n<pre><code>contributions = \n{\"1444\"=&gt;#&lt;BigDecimal:7f915c08f030,'0.502569E2',18(36)&gt;,\n\"alice\"=&gt;#&lt;BigDecimal:7f915c084018,'0.211E1',18(27)&gt;,\n \"address1\"=&gt;#&lt;BigDecimal:7f915c0a4430,'0.87161E1',18(36)&gt;,\n \"address2\"=&gt;#&lt;BigDecimal:7f915c0943f0,'0.84811E1',18(36)&gt;,\n \"address3\"=&gt;#&lt;BigDecimal:7f915c0a43e0,'0.385E0',9(18)&gt;,\n \"address6\"=&gt;#&lt;BigDecimal:7f915c09ebe8,'0.1E1',9(18)&gt;,\n \"address7\"=&gt;#&lt;BigDecimal:7f915c09eb98,'0.1E1',9(18)&gt;,\n \"address8\"=&gt;#&lt;BigDecimal:7f915c09d428,'0.15E1',18(18)&gt;,\n \"address9\"=&gt;#&lt;BigDecimal:7f915c09d3d8,'0.15E1',18(18)&gt;,\n \"address10\"=&gt;#&lt;BigDecimal:7f915c0a7540,'0.132E1',18(36)&gt;,\n \"address11\"=&gt;#&lt;BigDecimal:7f915c0af8a8,'0.392E1',18(36)&gt;,\n \"address12\"=&gt;#&lt;BigDecimal:7f915c0a4980,'0.14E1',18(36)&gt;,\n \"address13\"=&gt;#&lt;BigDecimal:7f915c0af858,'0.2133333333 3333333333 33333334E1',36(54)&gt;,\n \"address14\"=&gt;#&lt;BigDecimal:7f915c0a54c0,'0.3533333333 3333333333 33333334E1',36(45)&gt;,\n \"address15\"=&gt;#&lt;BigDecimal:7f915c0a66e0,'0.1533333333 3333333333 33333334E1',36(36)&gt;,\n \"sdfds\"=&gt;#&lt;BigDecimal:7f915c0a6118,'0.1E0',9(27)&gt;,\n \"sf\"=&gt;#&lt;BigDecimal:7f915c0a6028,'0.1E0',9(27)&gt;,\n \"address20\"=&gt;#&lt;BigDecimal:7f915c0ae688,'0.3E0',9(18)&gt;,\n \"address21\"=&gt;#&lt;BigDecimal:7f915c0ae638,'0.3E0',9(18)&gt;,\n \"address23\"=&gt;#&lt;BigDecimal:7f915c0ae070,'0.1E0',9(27)&gt;,\n \"address22\"=&gt;#&lt;BigDecimal:7f915c0adf80,'0.1E0',9(27)&gt;,\n \"add1\"=&gt;#&lt;BigDecimal:7f915c0ad328,'0.1E0',9(18)&gt;,\n \"add2\"=&gt;#&lt;BigDecimal:7f915c0ad2d8,'0.1E0',9(18)&gt;,\n \"addx\"=&gt;#&lt;BigDecimal:7f915c0acd10,'0.1E0',9(27)&gt;,\n \"addy\"=&gt;#&lt;BigDecimal:7f915c0acc20,'0.1E0',9(27)&gt;}\n</code></pre>\n\n<p>and the distributions:</p>\n\n<pre><code>distributions = \n {\"1444\"=&gt;#&lt;BigDecimal:7f915a9068f0,'0.502569E2',18(63)&gt;,\n \"alice\"=&gt;#&lt;BigDecimal:7f915a8f44e8,'0.211E1',18(27)&gt;,\n \"address1\"=&gt;#&lt;BigDecimal:7f915a906800,'0.87161E1',18(54)&gt;,\n \"address2\"=&gt;#&lt;BigDecimal:7f915a906710,'0.84811E1',18(54)&gt;,\n \"address3\"=&gt;#&lt;BigDecimal:7f915a906620,'0.385E0',9(36)&gt;,\n \"address6\"=&gt;#&lt;BigDecimal:7f915a8fdea8,'0.1E1',9(27)&gt;,\n \"address7\"=&gt;#&lt;BigDecimal:7f915a8fddb8,'0.1E1',9(27)&gt;,\n \"address8\"=&gt;#&lt;BigDecimal:7f915a8fd5e8,'0.15E1',18(18)&gt;,\n \"address9\"=&gt;#&lt;BigDecimal:7f915a8fd4f8,'0.15E1',18(18)&gt;,\n \"address10\"=&gt;#&lt;BigDecimal:7f915a8fc9b8,'0.132E1',18(36)&gt;,\n \"address11\"=&gt;#&lt;BigDecimal:7f915a9071b0,'0.3920000000 0000003E1',27(45)&gt;,\n \"address12\"=&gt;#&lt;BigDecimal:7f915a907660,'0.1400000000 0000001E1',27(36)&gt;,\n \"address13\"=&gt;#&lt;BigDecimal:7f915a9070c0,'0.2133333333 3333337E1',27(45)&gt;,\n \"address14\"=&gt;#&lt;BigDecimal:7f915a906530,'0.3533333333 3333333333 33333334E1',36(54)&gt;,\n \"address15\"=&gt;#&lt;BigDecimal:7f915a8fc148,'0.1533333333 3333334E1',27(27)&gt;,\n \"sdfds\"=&gt;#&lt;BigDecimal:7f915a907f98,'0.1E0',9(27)&gt;,\n \"sf\"=&gt;#&lt;BigDecimal:7f915a907e08,'0.1E0',9(27)&gt;,\n \"address20\"=&gt;#&lt;BigDecimal:7f915a906ad0,'0.3000000000 0000003E0',18(27)&gt;,\n \"address21\"=&gt;#&lt;BigDecimal:7f915a9069e0,'0.3000000000 0000003E0',18(27)&gt;,\n \"address23\"=&gt;#&lt;BigDecimal:7f915a9063c8,'0.1E0',9(27)&gt;,\n \"address22\"=&gt;#&lt;BigDecimal:7f915a906238,'0.1E0',9(27)&gt;,\n \"add1\"=&gt;#&lt;BigDecimal:7f915a9060a8,'0.5E-1',9(27)&gt;,\n \"add2\"=&gt;#&lt;BigDecimal:7f915a905f18,'0.1E0',9(27)&gt;}\n</code></pre>\n\n<p>Ideally, I want my liabilities to look like this:</p>\n\n<pre><code>{\"add1\"=&gt;0.05,\n\"addx\"=&gt;0.1&gt;,\n\"addy\"=&gt;0.1&gt;}\n</code></pre>\n\n<p>But they look like this:</p>\n\n<pre><code>{\"1444\"=&gt;0.0,\n \"alice\"=&gt;0.0,\n \"address1\"=&gt;0.0,\n \"address2\"=&gt;0.0,\n \"address3\"=&gt;0.0,\n \"address6\"=&gt;0.0,\n \"address7\"=&gt;0.0,\n \"address8\"=&gt;0.0,\n \"address9\"=&gt;0.0,\n \"address10\"=&gt;0.0,\n \"address11\"=&gt;-3.0e-16,\n \"address12\"=&gt;-1.0e-16,\n \"address13\"=&gt;-3.66666666666e-16,\n \"address14\"=&gt;0.0,\n \"address15\"=&gt;-6.6666666666e-17,\n \"sdfds\"=&gt;0.0,\n \"sf\"=&gt;0.0,\n \"address20\"=&gt;-3.0e-17,\n \"address21\"=&gt;-3.0e-17,\n \"address23\"=&gt;0.0,\n \"address22\"=&gt;0.0,\n \"add1\"=&gt;0.05,\n \"add2\"=&gt;0.0,\n \"addx\"=&gt;#&lt;BigDecimal:7f915c0acd10,'0.1E0',9(27)&gt;,\n \"addy\"=&gt;#&lt;BigDecimal:7f915c0acc20,'0.1E0',9(27)&gt;}\n</code></pre>\n\n<p>I don't want to include <code>-3.66666666666e-16</code> because that's essentially 0 and even Ruby accounts for it this way when you run <code>-3.66666666666e-16 &gt; 0</code>... it returns <code>false</code>. </p>\n\n<p>This is what I have... is the a better way? The code below is calculating the liabilities by subtracting <code>con</code> from <code>dis</code> and only selecting the liabilities that are greater than 0.0...that makes sense to me and it excludes 1-time grants of coins (there must be a matching contribution to be a liability). Then, I convert everything to floats so it's readable. Does this look right?</p>\n\n<pre><code>liab = @contributions.merge(@distributions) do |key, con, dis|\n      (con - dis)\n    end.select { |addr, amount| amount &gt; 0.0 &amp;&amp; @contributions.keys.include?(addr) }\n\n    liab.merge(liab) do |k, old, new|\n      k = new.to_f\n    end\n</code></pre>\n\n<p>I want the amount returned in float format, not the big decimal object. Is what I'm doing okay? Will I keep accuracy if I convert to float at the end?</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 16229, "user_id": 525478, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/3b6c0b47a0c430a0b141baee7ea845be?s=128&d=identicon&r=PG", "display_name": "Brad Werth", "link": "https://stackoverflow.com/users/525478/brad-werth"}, "edited": false, "score": 0, "creation_date": 1517432788, "post_id": 48551388, "comment_id": 84098983, "body": "See how your (broken) comment_id validation differs from your (working) first_name validation?"}, {"owner": {"reputation": 745, "user_id": 8588607, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/4a6f92294ead1dc2f726601c3f13c0b9?s=128&d=identicon&r=PG&f=1", "display_name": "L&#233;o Coletta", "link": "https://stackoverflow.com/users/8588607/l%c3%a9o-coletta"}, "reply_to_user": {"reputation": 16229, "user_id": 525478, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/3b6c0b47a0c430a0b141baee7ea845be?s=128&d=identicon&r=PG", "display_name": "Brad Werth", "link": "https://stackoverflow.com/users/525478/brad-werth"}, "edited": false, "score": 0, "creation_date": 1517433469, "post_id": 48551388, "comment_id": 84099352, "body": "@BradWerth Yes I fixed it by replacing validate<b>s</b> by validate and replacing the comment_id with **:**comment_id. It works but I&#39;m beginner so is it ok ?"}, {"owner": {"reputation": 16229, "user_id": 525478, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/3b6c0b47a0c430a0b141baee7ea845be?s=128&d=identicon&r=PG", "display_name": "Brad Werth", "link": "https://stackoverflow.com/users/525478/brad-werth"}, "edited": false, "score": 0, "creation_date": 1517433596, "post_id": 48551388, "comment_id": 84099403, "body": "yeah... it&#39;s a little inconsistant, but obviously ok. do you even need it, with <code>validates :comment, presence: true, length: { minimum: 10 }</code>? <a href=\"https://stackoverflow.com/questions/5689888/rails-validate-presence-of-association\" title=\"rails validate presence of association\">stackoverflow.com/questions/5689888/&hellip;</a>"}, {"owner": {"reputation": 745, "user_id": 8588607, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/4a6f92294ead1dc2f726601c3f13c0b9?s=128&d=identicon&r=PG&f=1", "display_name": "L&#233;o Coletta", "link": "https://stackoverflow.com/users/8588607/l%c3%a9o-coletta"}, "reply_to_user": {"reputation": 16229, "user_id": 525478, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/3b6c0b47a0c430a0b141baee7ea845be?s=128&d=identicon&r=PG", "display_name": "Brad Werth", "link": "https://stackoverflow.com/users/525478/brad-werth"}, "edited": false, "score": 0, "creation_date": 1517433966, "post_id": 48551388, "comment_id": 84099576, "body": "@BradWerth That&#39;s the thing : my :parent_id can be nil but if it is not nil it musth exist in the database. Am I overthinking it ^^ ?"}, {"owner": {"reputation": 28138, "user_id": 337166, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/fKzgt.jpg?s=128&g=1", "display_name": "jvnill", "link": "https://stackoverflow.com/users/337166/jvnill"}, "edited": false, "score": 0, "creation_date": 1517441435, "post_id": 48551388, "comment_id": 84102756, "body": "<code>validates :comment_id_presence</code> should be <code>validate :comment_id</code>. That&#39;s what the error is pointing to."}], "answers": [{"tags": [], "owner": {"reputation": 2093, "user_id": 3309314, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/3683a7a05e7e97a67c262b774db00d08?s=128&d=identicon&r=PG&f=1", "display_name": "user3309314", "link": "https://stackoverflow.com/users/3309314/user3309314"}, "is_accepted": true, "score": 1, "last_activity_date": 1517433333, "creation_date": 1517433333, "answer_id": 48551559, "question_id": 48551388, "link": "https://stackoverflow.com/questions/48551388/rails-custom-validation-method-argumenterror-you-need-to-supply-at-least-one/48551559#48551559", "title": "Rails custom validation method : &quot;ArgumentError (You need to supply at least one validation)&quot;", "body": "<p>You should use just <code>validate</code> without <code>s</code> on the end for this case:</p>\n\n<pre><code>validate :comment_id_presence\n</code></pre>\n\n<p>More <a href=\"http://api.rubyonrails.org/classes/ActiveModel/Validations/ClassMethods.html#method-i-validate\" rel=\"nofollow noreferrer\">here</a></p>\n"}], "owner": {"reputation": 745, "user_id": 8588607, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/4a6f92294ead1dc2f726601c3f13c0b9?s=128&d=identicon&r=PG&f=1", "display_name": "L&#233;o Coletta", "link": "https://stackoverflow.com/users/8588607/l%c3%a9o-coletta"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 681, "favorite_count": 0, "accepted_answer_id": 48551559, "answer_count": 1, "score": 0, "last_activity_date": 1517433333, "creation_date": 1517432646, "question_id": 48551388, "link": "https://stackoverflow.com/questions/48551388/rails-custom-validation-method-argumenterror-you-need-to-supply-at-least-one", "title": "Rails custom validation method : &quot;ArgumentError (You need to supply at least one validation)&quot;", "body": "<p>I try to make a custom validation for a comment method which will verify that if a comment id is present then it must exists.</p>\n\n<pre><code>class Comment &lt; ActiveRecord::Base\n  belongs_to :article\n  #Many to one relation with itself (1 comment can have one parent and multiple child)\n  has_many :child, class_name: \"Comment\", foreign_key: \"parent_id\"\n  belongs_to :parent, class_name: \"Comment\", optional: true\n\n  belongs_to :user, optional: true\n\n  validates :comment, presence: true, length: { minimum: 10 }\n  validates :first_name, presence: true, length: { minimum: 2, maximum: 30 }\n  validates :last_name, length: { minimum: 2, maximum: 30 }\n  validates :comment_id_presence\n\n  private\n\n  def comment_id_presence\n    if comment_id != nil &amp;&amp; !Comment.exists?(comment_id)\n      errors.add(:comment_id, \"Le parent doit exister ou \u00eatre nulle\")\n    end\n  end\nend\n</code></pre>\n\n<p>However, I get the following error : ArgumentError (You need to supply at least one validation). I'd like to know what is my mistake or if there is simplier way to do what I want.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "email", "actionmailer"], "comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 2, "creation_date": 1517430105, "post_id": 48550782, "comment_id": 84097640, "body": "What &quot;From:&quot; address are you using? I don&#39;t see one assigned here, and if you omit that many providers will flat-out reject your email."}, {"owner": {"reputation": 911, "user_id": 5079196, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/UWfbG.jpg?s=128&g=1", "display_name": "gwalshington", "link": "https://stackoverflow.com/users/5079196/gwalshington"}, "edited": false, "score": 0, "creation_date": 1517430116, "post_id": 48550782, "comment_id": 84097646, "body": "It sent the email - are you on localhost or in a production environment with something like Sendgrid hooked up?"}, {"owner": {"reputation": 394580, "user_id": 479863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ArUCE.jpg?s=128&g=1", "display_name": "mu is too short", "link": "https://stackoverflow.com/users/479863/mu-is-too-short"}, "edited": false, "score": 2, "creation_date": 1517431686, "post_id": 48550782, "comment_id": 84098419, "body": "If you&#39;re in a development environment you&#39;ll probably have a better time using something like MailCatcher."}, {"owner": {"reputation": 577, "user_id": 8211360, "user_type": "registered", "accept_rate": 57, "profile_image": "https://graph.facebook.com/1535879126476698/picture?type=large", "display_name": "IvanHid", "link": "https://stackoverflow.com/users/8211360/ivanhid"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1517515181, "post_id": 48550782, "comment_id": 84138079, "body": "@tadman which From: address should I specify?"}, {"owner": {"reputation": 577, "user_id": 8211360, "user_type": "registered", "accept_rate": 57, "profile_image": "https://graph.facebook.com/1535879126476698/picture?type=large", "display_name": "IvanHid", "link": "https://stackoverflow.com/users/8211360/ivanhid"}, "reply_to_user": {"reputation": 911, "user_id": 5079196, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/UWfbG.jpg?s=128&g=1", "display_name": "gwalshington", "link": "https://stackoverflow.com/users/5079196/gwalshington"}, "edited": false, "score": 0, "creation_date": 1517515230, "post_id": 48550782, "comment_id": 84138104, "body": "@gwalshington The log is from a localhost environment but I have tried with both development and production environments"}, {"owner": {"reputation": 577, "user_id": 8211360, "user_type": "registered", "accept_rate": 57, "profile_image": "https://graph.facebook.com/1535879126476698/picture?type=large", "display_name": "IvanHid", "link": "https://stackoverflow.com/users/8211360/ivanhid"}, "reply_to_user": {"reputation": 394580, "user_id": 479863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ArUCE.jpg?s=128&g=1", "display_name": "mu is too short", "link": "https://stackoverflow.com/users/479863/mu-is-too-short"}, "edited": false, "score": 0, "creation_date": 1517515287, "post_id": 48550782, "comment_id": 84138148, "body": "@muistooshort thank you I&#39;ll look into that, but I&#39;m working on an application that has already been deployed and I need a solution for the deploy environment"}, {"owner": {"reputation": 911, "user_id": 5079196, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/UWfbG.jpg?s=128&g=1", "display_name": "gwalshington", "link": "https://stackoverflow.com/users/5079196/gwalshington"}, "edited": false, "score": 0, "creation_date": 1517516313, "post_id": 48550782, "comment_id": 84138692, "body": "As everyone is saying, I think you need to configure action mailer to actually send in dev environment. It is working properly though."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1517517154, "post_id": 48550782, "comment_id": 84139112, "body": "You need to specify at least <i>something</i>, but ideally you use an address at a domain you control. If your application has a domain it&#39;s a good idea to use something like <code>info@example.com</code> where <code>example.com</code> is your domain."}], "answers": [{"tags": [], "owner": {"reputation": 1180, "user_id": 3359577, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mj7Xv.jpg?s=128&g=1", "display_name": "razvans", "link": "https://stackoverflow.com/users/3359577/razvans"}, "is_accepted": false, "score": 0, "last_activity_date": 1517434310, "creation_date": 1517434310, "answer_id": 48551785, "question_id": 48550782, "link": "https://stackoverflow.com/questions/48550782/rails-mails-sent-but-never-recieved/48551785#48551785", "title": "Rails mails &quot;Sent&quot; but never recieved", "body": "<p>If you are in development you need to set up action mailer to actually send the email. You can use your gmail to do that. See here: <a href=\"https://stackoverflow.com/questions/11706277/action-mailer-smtp-google-apps\">Action mailer SMTP google apps</a></p>\n\n<p>Or you can use <a href=\"https://github.com/ryanb/letter_opener\" rel=\"nofollow noreferrer\">letter_opener</a>, and probably others like <a href=\"https://rubygems.org/gems/mailcatcher/versions/0.6.4\" rel=\"nofollow noreferrer\">mailcatcher</a>. I used letter_opener successfully.</p>\n"}, {"comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 1, "creation_date": 1517517216, "post_id": 48557298, "comment_id": 84139145, "body": "Ruby 1.9 introduced a new hash style which is a lot cleaner and more JavaScript like: <code>{ address: &quot;localhost&quot;, port: 1025 }</code>. This avoids spiking the &quot;hash rocket&quot; <code>=&gt;</code> in all over the place."}, {"owner": {"reputation": 577, "user_id": 8211360, "user_type": "registered", "accept_rate": 57, "profile_image": "https://graph.facebook.com/1535879126476698/picture?type=large", "display_name": "IvanHid", "link": "https://stackoverflow.com/users/8211360/ivanhid"}, "edited": false, "score": 0, "creation_date": 1517612837, "post_id": 48557298, "comment_id": 84181549, "body": "Thank you very much this fixed the problem!"}], "tags": [], "owner": {"reputation": 167, "user_id": 9273735, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-crLGF5VF2jI/AAAAAAAAAAI/AAAAAAAAALk/fmgr_kmQdxY/photo.jpg?sz=128", "display_name": "Mrunal Selokar", "link": "https://stackoverflow.com/users/9273735/mrunal-selokar"}, "is_accepted": true, "score": 3, "last_activity_date": 1517469575, "creation_date": 1517469575, "answer_id": 48557298, "question_id": 48550782, "link": "https://stackoverflow.com/questions/48550782/rails-mails-sent-but-never-recieved/48557298#48557298", "title": "Rails mails &quot;Sent&quot; but never recieved", "body": "<p>This is because you might not have configured <code>AcionMailer</code> correctly.\nIn file \"/config/environments/production.rb\" or \"/config/environments/development.rb\" according to the environments you are in, add following lines:</p>\n\n<pre><code>config.action_mailer.delivery_method = :smtp\n# SMTP settings for gmail\nconfig.action_mailer.smtp_settings = {\n :address              =&gt; \"smtp.gmail.com\",\n :port                 =&gt; 587,\n :user_name            =&gt; 'your_gmail_username',\n :password             =&gt; 'your_gmail_password',\n :authentication       =&gt; \"plain\",\n :enable_starttls_auto =&gt; true\n}\n</code></pre>\n\n<p>You can also use a gem called <a href=\"https://mailcatcher.me/\" rel=\"nofollow noreferrer\">mailcatcher</a>. \nIn your \"/config/environments/development.rb\" file, add the following lines:</p>\n\n<pre><code>config.action_mailer.delivery_method = :smtp\nconfig.action_mailer.smtp_settings = { :address =&gt; \"localhost\", :port =&gt; 1025 }\n</code></pre>\n\n<p>Restart all services. In your console, move into your project directory and type <code>mailcatcher</code>. You should now be able to see all the sent and received emails via your app at url:  <a href=\"http://127.0.0.1:1080\" rel=\"nofollow noreferrer\">http://127.0.0.1:1080</a></p>\n\n<p>Thanks!</p>\n"}], "owner": {"reputation": 577, "user_id": 8211360, "user_type": "registered", "accept_rate": 57, "profile_image": "https://graph.facebook.com/1535879126476698/picture?type=large", "display_name": "IvanHid", "link": "https://stackoverflow.com/users/8211360/ivanhid"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 81, "favorite_count": 0, "accepted_answer_id": 48557298, "answer_count": 2, "score": 0, "last_activity_date": 1517469575, "creation_date": 1517429959, "question_id": 48550782, "link": "https://stackoverflow.com/questions/48550782/rails-mails-sent-but-never-recieved", "title": "Rails mails &quot;Sent&quot; but never recieved", "body": "<p>Hello I'm trying to send an email from my rails application and I've tried multiple solutions from questions similar to this one but it still doesn't work, here is my UserMailer:</p>\n\n<pre><code>class UserMailer &lt; ActionMailer::Base\n    def welcome_email(user)\n        @user = user\n        @url = 'http://fundacionccb2017.herokuapp.com'\n        mail(to: 'hidalgoivanh@hotmail.com', subject: 'Bienvenido a la aplicaci\u00f3n de ccb')\n    end\nend\n</code></pre>\n\n<p>Here is my welcome_email html</p>\n\n<pre><code>    &lt;!DOCTYPE html&gt;\n&lt;html&gt;\n  &lt;head&gt;\n    &lt;meta content='text/html; charset=UTF-8' http-equiv='Content-Type' /&gt;\n  &lt;/head&gt;\n  &lt;body&gt;\n    &lt;h1&gt;Welcome to example.com, &lt;%= @user.name %&gt;&lt;/h1&gt;\n    &lt;p&gt;\n      You have successfully signed up to example.com,\n      your username is: Pancho.&lt;br&gt;\n    &lt;/p&gt;\n    &lt;p&gt;\n      To login to the site, just follow this link:\n    &lt;/p&gt;\n    &lt;p&gt;Thanks for joining and have a great day!&lt;/p&gt;\n  &lt;/body&gt;\n&lt;/html&gt;\n</code></pre>\n\n<p>And here's how I call it in my controller (inside my Users controller):</p>\n\n<pre><code>def create\n        @user = User.new(user_params)\n        if @user.save\n                        UserMailer.welcome_email(@user).deliver_later\n            session[:user_id] = @user.id\n            redirect_to user_path(@user)\n        else\n            render 'new'\n        end\n    end\n</code></pre>\n\n<p>And this is my message in console:</p>\n\n<pre><code>Started POST \"/users\" for 127.0.0.1 at 2018-01-31 14:10:31 -0600\n  ActiveRecord::SchemaMigration Load (0.2ms)  SELECT \"schema_migrations\".* FROM \"schema_migrations\"\nProcessing by UsersController#create as HTML\n  Parameters: {\"utf8\"=&gt;\"\u2713\", \"authenticity_token\"=&gt;\"COkRNuVqcaqn2Wrso24y7lmWyKt1OX0/gai2FlXfeLBg9R61RmJj81JDsXdiuBZgBxKi4nW6WErl99bDMVp0kA==\", \"user\"=&gt;{\"name\"=&gt;\"Usuario\", \"last_name\"=&gt;\"Apellido1\", \"second_last_name\"=&gt;\"Apellido2\", \"mail\"=&gt;\"ejemplo7@ejemplo.com\", \"username\"=&gt;\"Usuario6\", \"telephone_number\"=&gt;\"555555555555\", \"password\"=&gt;\"[FILTERED]\", \"password_confirmation\"=&gt;\"[FILTERED]\"}}\nUnpermitted parameter: password_confirmation\n   (0.1ms)  begin transaction\n  User Exists (0.2ms)  SELECT  1 AS one FROM \"users\" WHERE LOWER(\"users\".\"mail\") = LOWER(?) LIMIT ?  [[\"mail\", \"ejemplo7@ejemplo.com\"], [\"LIMIT\", 1]]\n  User Exists (0.1ms)  SELECT  1 AS one FROM \"users\" WHERE LOWER(\"users\".\"username\") = LOWER(?) LIMIT ?  [[\"username\", \"Usuario6\"], [\"LIMIT\", 1]]\n  SQL (1.0ms)  INSERT INTO \"users\" (\"name\", \"mail\", \"telephone_number\", \"last_name\", \"second_last_name\", \"username\", \"password_digest\", \"created_at\", \"updated_at\") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?)  [[\"name\", \"Usuario\"], [\"mail\", \"ejemplo7@ejemplo.com\"], [\"telephone_number\", \"555555555555\"], [\"last_name\", \"Apellido1\"], [\"second_last_name\", \"Apellido2\"], [\"username\", \"Usuario6\"], [\"password_digest\", \"$2a$10$jdHJTDiCxL9NPg6ajMye9eZ251RVwfVBAUb2YZEKNvc05lYpqGnFa\"], [\"created_at\", 2018-01-31 20:10:31 UTC], [\"updated_at\", 2018-01-31 20:10:31 UTC]]\n   (4.5ms)  commit transaction\n[ActiveJob] Enqueued ActionMailer::DeliveryJob (Job ID: 922ae0c1-b5ed-4339-b25b-40752f651b9e) to Async(mailers) with arguments: \"UserMailer\", \"welcome_email\", \"deliver_now\", #&lt;GlobalID:0x007f8f94ebd9a0 @uri=#&lt;URI::GID gid://fundacion-ccb/User/7&gt;&gt;\nRedirected to http://localhost:3000/users/7\nCompleted 302 Found in 567ms (ActiveRecord: 6.8ms)\n\n\n  User Load (0.4ms)  SELECT  \"users\".* FROM \"users\" WHERE \"users\".\"id\" = ? LIMIT ?  [[\"id\", 7], [\"LIMIT\", 1]]\n[ActiveJob] [ActionMailer::DeliveryJob] [922ae0c1-b5ed-4339-b25b-40752f651b9e] Performing ActionMailer::DeliveryJob from Async(mailers) with arguments: \"UserMailer\", \"welcome_email\", \"deliver_now\", #&lt;GlobalID:0x007f8f94e04a90 @uri=#&lt;URI::GID gid://fundacion-ccb/User/7&gt;&gt;\nStarted GET \"/users/7\" for 127.0.0.1 at 2018-01-31 14:10:32 -0600\nProcessing by UsersController#show as HTML\n  Parameters: {\"id\"=&gt;\"7\"}\n  User Load (1.7ms)  SELECT  \"users\".* FROM \"users\" WHERE \"users\".\"id\" = ? LIMIT ?  [[\"id\", 7], [\"LIMIT\", 1]]\n  User Load (0.1ms)  SELECT  \"users\".* FROM \"users\" WHERE \"users\".\"id\" = ? LIMIT ?  [[\"id\", 7], [\"LIMIT\", 1]]\n[ActiveJob] [ActionMailer::DeliveryJob] [922ae0c1-b5ed-4339-b25b-40752f651b9e]   Rendering user_mailer/welcome_email.html.erb\n[ActiveJob] [ActionMailer::DeliveryJob] [922ae0c1-b5ed-4339-b25b-40752f651b9e]   Rendered user_mailer/welcome_email.html.erb (0.9ms)\n[ActiveJob] [ActionMailer::DeliveryJob] [922ae0c1-b5ed-4339-b25b-40752f651b9e]   Rendering user_mailer/welcome_email.text.erb\n[ActiveJob] [ActionMailer::DeliveryJob] [922ae0c1-b5ed-4339-b25b-40752f651b9e]   Rendered user_mailer/welcome_email.text.erb (0.3ms)\n[ActiveJob] [ActionMailer::DeliveryJob] [922ae0c1-b5ed-4339-b25b-40752f651b9e] UserMailer#welcome_email: processed outbound mail in 356.4ms\n[ActiveJob] [ActionMailer::DeliveryJob] [922ae0c1-b5ed-4339-b25b-40752f651b9e] Sent mail to hidalgoivanh@hotmail.com (3.6ms)\n[ActiveJob] [ActionMailer::DeliveryJob] [922ae0c1-b5ed-4339-b25b-40752f651b9e] Date: Wed, 31 Jan 2018 14:10:32 -0600\nTo: hidalgoivanh@hotmail.com\nMessage-ID: &lt;5a7222b866548_c343fc7ca75eb68909a7@Ivan-VM.mail&gt;\nSubject: =?UTF-8?Q?Bienvenido_a_la_aplicaci=C3=B3n_de_ccb?=\nMime-Version: 1.0\nContent-Type: multipart/alternative;\n boundary=\"--==_mimepart_5a7222b8645e5_c343fc7ca75eb689082b\";\n charset=UTF-8\nContent-Transfer-Encoding: 7bit\n\n\n----==_mimepart_5a7222b8645e5_c343fc7ca75eb689082b\nContent-Type: text/plain;\n charset=UTF-8\nContent-Transfer-Encoding: base64\n\nQmllbnZlbmlkbyBhIGxhIGZ1bmRhY2nDs24hCj09PT09PT09PT09PT09PT09\nPT09PT09PT09PT09PQpFc3RlIG1lbnNhamUgaGEgc2lkbyBlbnRyZWdhZG8g\nZXhpc3Rvc2FtZW50ZS4K\n\n----==_mimepart_5a7222b8645e5_c343fc7ca75eb689082b\nContent-Type: text/html;\n charset=UTF-8\nContent-Transfer-Encoding: 7bit\n\n&lt;!DOCTYPE html&gt;\n&lt;html&gt;\n  &lt;head&gt;\n    &lt;meta content='text/html; charset=UTF-8' http-equiv='Content-Type' /&gt;\n  &lt;/head&gt;\n  &lt;body&gt;\n    &lt;h1&gt;Welcome to example.com, Usuario&lt;/h1&gt;\n    &lt;p&gt;\n      You have successfully signed up to example.com,\n      your username is: Pancho.&lt;br&gt;\n    &lt;/p&gt;\n    &lt;p&gt;\n      To login to the site, just follow this link:\n    &lt;/p&gt;\n    &lt;p&gt;Thanks for joining and have a great day!&lt;/p&gt;\n  &lt;/body&gt;\n&lt;/html&gt;\n\n----==_mimepart_5a7222b8645e5_c343fc7ca75eb689082b--\n\n[ActiveJob] [ActionMailer::DeliveryJob] [922ae0c1-b5ed-4339-b25b-40752f651b9e] Performed ActionMailer::DeliveryJob from Async(mailers) in 373.06ms\n  Rendering users/show.html.erb within layouts/application\n   (0.1ms)  SELECT COUNT(*) FROM \"projects\" WHERE \"projects\".\"user_id\" = ?  [[\"user_id\", 7]]\n  Rendered users/show.html.erb within layouts/application (476.8ms)\n  Rendered layouts/_navigation.html.erb (1.7ms)\nCompleted 200 OK in 1027ms (Views: 632.3ms | ActiveRecord: 2.2ms)\n</code></pre>\n\n<p>As you can see the email is 'sent' but I never recieved it in my inbox, I have tried with both @gmail and @hotmail accounts.\nHow can I fix this?</p>\n"}, {"tags": ["javascript", "ruby-on-rails", "ruby", "amazon-s3"], "comments": [{"owner": {"reputation": 99, "user_id": 6233643, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-eMQfIRF6hTQ/AAAAAAAAAAI/AAAAAAAAABw/ZxGwfBEqypg/photo.jpg?sz=128", "display_name": "Himanshu Tiwari", "link": "https://stackoverflow.com/users/6233643/himanshu-tiwari"}, "edited": false, "score": 0, "creation_date": 1517427956, "post_id": 48550172, "comment_id": 84096511, "body": "Ok, but without your code no can help you!! So please provide code which you have implemented."}, {"owner": {"reputation": 161, "user_id": 8322369, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/05d67abf60ed3c54e12ce906bd69ed90?s=128&d=identicon&r=PG&f=1", "display_name": "rgc998", "link": "https://stackoverflow.com/users/8322369/rgc998"}, "reply_to_user": {"reputation": 99, "user_id": 6233643, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-eMQfIRF6hTQ/AAAAAAAAAAI/AAAAAAAAABw/ZxGwfBEqypg/photo.jpg?sz=128", "display_name": "Himanshu Tiwari", "link": "https://stackoverflow.com/users/6233643/himanshu-tiwari"}, "edited": false, "score": 0, "creation_date": 1517428560, "post_id": 48550172, "comment_id": 84096831, "body": "@HimanshuTiwari posted above!"}, {"owner": {"reputation": 1331, "user_id": 4189633, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/VG5Vp.jpg?s=128&g=1", "display_name": "Vishal G", "link": "https://stackoverflow.com/users/4189633/vishal-g"}, "edited": false, "score": 0, "creation_date": 1557836432, "post_id": 48550172, "comment_id": 98891687, "body": "<a href=\"https://railschain.com/rails-api-active-storage-and-react-js/\" rel=\"nofollow noreferrer\">railschain.com/rails-api-active-storage-and-react-js</a>   Try this with rails 5"}], "answers": [{"tags": [], "owner": {"reputation": 2093, "user_id": 3309314, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/3683a7a05e7e97a67c262b774db00d08?s=128&d=identicon&r=PG&f=1", "display_name": "user3309314", "link": "https://stackoverflow.com/users/3309314/user3309314"}, "is_accepted": false, "score": 0, "last_activity_date": 1517432888, "creation_date": 1517432888, "answer_id": 48551450, "question_id": 48550172, "link": "https://stackoverflow.com/questions/48550172/using-react-and-rails-to-upload-image-paperclip-and-aws-s3-bucket/48551450#48551450", "title": "Using React and Rails to upload image - Paperclip and AWS S3 bucket", "body": "<p>You're sending a request with JSON including the file as body. Try to send request using <code>FormData</code> instead: </p>\n\n<pre><code>static addComment(comment, project_id, datetime, clientView, file) {\n   debugger\n   const body = FormData.new();\n   body.append('client_view', clientView);\n   body.append('comment_text', comment);\n   body.append('project_id', project_id);\n   body.append('currenttime', datetime);\n   body.append('commentasset', file);\n\n   return fetch(path,{\n     method: 'POST',\n     headers: headers(),\n     body: body\n   })\n   .then( resp =&gt; resp.json())\n }\n</code></pre>\n"}], "owner": {"reputation": 161, "user_id": 8322369, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/05d67abf60ed3c54e12ce906bd69ed90?s=128&d=identicon&r=PG&f=1", "display_name": "rgc998", "link": "https://stackoverflow.com/users/8322369/rgc998"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 471, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1517432888, "creation_date": 1517427593, "last_edit_date": 1517428539, "question_id": 48550172, "link": "https://stackoverflow.com/questions/48550172/using-react-and-rails-to-upload-image-paperclip-and-aws-s3-bucket", "title": "Using React and Rails to upload image - Paperclip and AWS S3 bucket", "body": "<p>I have a react frontend and a Rails backend. I am using the paperclip gem and aws-sdk gem in order to upload images to my app. The whole idea is that a user can upload a comment and in that comment there can be an attachment. I think maybe I am sending my backend the wrong data though because it is not working.... On the frontend i'm using file reader to make a file object and sending my rails app the file object -- but it doesn't seem to be recognizing it. If i want my rails backend to recognize this image attachment, how should the image be formatted in my frontend before i send it to my rails app? </p>\n\n<p>This is how my file object is stored in the state -- on handleChange of course: </p>\n\n<pre><code> handleFileChange = (e) =&gt; {\n  debugger\n\n e.preventDefault();\n\n  let reader = new FileReader();\n  let file = e.target.files[0];\n\n  reader.onloadend = () =&gt; {\n    this.setState({\n      file: file,\n      imagePreviewUrl: reader.result\n    });\n  }\n  reader.readAsDataURL(file)\n}\n</code></pre>\n\n<p>then when i submit the form i use a callback that eventually sends that file object to my adapter which makes the call to the rails backend as sseen below: </p>\n\n<pre><code>  static addComment(comment, project_id, datetime, clientView, file) {\n   debugger\n   return fetch(path,{\n     method: 'POST',\n     headers: headers(),\n     body: JSON.stringify({\n       client_view: clientView,\n       comment_text: comment,\n       project_id: project_id,\n       currenttime: datetime,\n       commentasset: file\n     })\n   })\n   .then( resp =&gt; resp.json())\n }\n</code></pre>\n\n<p>so im sending my rails the file object in the param that is commentasset... but when i hit my byebug on my rails end and check</p>\n\n<pre><code>params[:commentasset] \n</code></pre>\n\n<p>it appears to be blank. Why isnt it sending back my file object? </p>\n"}, {"tags": ["ruby", "ascii-art"], "comments": [{"owner": {"reputation": 52685, "user_id": 980550, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/8emhY.jpg?s=128&g=1", "display_name": "lurker", "link": "https://stackoverflow.com/users/980550/lurker"}, "edited": false, "score": 2, "creation_date": 1517426957, "post_id": 48550000, "comment_id": 84095972, "body": "Try <code>print &quot; &quot; * (count- 2)</code> instead of <code>print &quot; &quot; * (number - 2)</code>"}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "reply_to_user": {"reputation": 52685, "user_id": 980550, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/8emhY.jpg?s=128&g=1", "display_name": "lurker", "link": "https://stackoverflow.com/users/980550/lurker"}, "edited": false, "score": 0, "creation_date": 1517427102, "post_id": 48550000, "comment_id": 84096067, "body": "@lurker: also some boundary conditions wouldn&#39;t hurt :)"}], "answers": [{"comments": [{"owner": {"reputation": 29, "user_id": 7467564, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/259896cf5a66cf93389a39403d1ed3e5?s=128&d=identicon&r=PG&f=1", "display_name": "CJ15", "link": "https://stackoverflow.com/users/7467564/cj15"}, "edited": false, "score": 0, "creation_date": 1517429073, "post_id": 48550068, "comment_id": 84097084, "body": "OK thank you Katamari and @luker both comments/answers helped me with the first part of the triangles now but now the issues is if a user enters 1 it prints 2 stars instead of one am i over looking something."}], "tags": [], "owner": {"reputation": 379, "user_id": 7067918, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a4456e1b265f37c27776d4ba20e634a7?s=128&d=identicon&r=PG&f=1", "display_name": "Katamari", "link": "https://stackoverflow.com/users/7067918/katamari"}, "is_accepted": false, "score": 2, "last_activity_date": 1517427175, "creation_date": 1517427175, "answer_id": 48550068, "question_id": 48550000, "link": "https://stackoverflow.com/questions/48550000/ascii-art-and-numbers/48550068#48550068", "title": "ASCII art and numbers", "body": "<p>The top side of your accidental square is coming from this line</p>\n\n<pre><code>puts \" Enter a number: \"\nnumber = gets.to_i\n--&gt; puts \"*\" * number &lt;--\n</code></pre>\n\n<p>And your right side doesnt slant because the value of  <code>number</code> doesnt change. You should be using <code>count</code> instead</p>\n"}, {"tags": [], "owner": {"reputation": 4103, "user_id": 4271125, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VQnWR.jpg?s=128&g=1", "display_name": "djaszczurowski", "link": "https://stackoverflow.com/users/4271125/djaszczurowski"}, "is_accepted": true, "score": 1, "last_activity_date": 1517430644, "creation_date": 1517430644, "answer_id": 48550940, "question_id": 48550000, "link": "https://stackoverflow.com/questions/48550000/ascii-art-and-numbers/48550940#48550940", "title": "ASCII art and numbers", "body": "<p>Below is an alternative approach where you have decoupled logic of creating rows and what should be present in that rows</p>\n\n<pre><code>def run(how_many_rows, &amp;display_block)\n  how_many_rows.times do |row_index|\n    to_display = display_block.call(row_index)\n\n    puts(to_display)\n  end\nend\n\nhow_many_rows = gets.to_i\n\nrun(how_many_rows) do |row|\n  Array.new(row + 1) do |idx|\n    is_first_char = idx == 0\n    is_last_char  = idx == row\n    is_last_row   = (row + 1) == how_many_rows\n\n    show_star = is_first_char || is_last_char || is_last_row\n\n    if show_star\n      '*'\n    else\n      ' '\n    end\n  end.join\nend\n\nrun(how_many_rows) do |row|\n  (1..(row + 1)).to_a.join\nend\n</code></pre>\n"}], "owner": {"reputation": 29, "user_id": 7467564, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/259896cf5a66cf93389a39403d1ed3e5?s=128&d=identicon&r=PG&f=1", "display_name": "CJ15", "link": "https://stackoverflow.com/users/7467564/cj15"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 198, "favorite_count": 0, "accepted_answer_id": 48550940, "answer_count": 2, "score": -3, "last_activity_date": 1517454150, "creation_date": 1517426873, "last_edit_date": 1517454150, "question_id": 48550000, "link": "https://stackoverflow.com/questions/48550000/ascii-art-and-numbers", "title": "ASCII art and numbers", "body": "<p>I'm trying to write code that prints a number input by a user in a right triangle. For example, if <code>8</code> is entered, it should look as below:</p>\n\n<pre><code>*\n**\n* *\n*  *\n*   *\n*    *\n*     *\n********\n1\n12\n123\n1234\n12345\n123456\n1234567\n123345678\n</code></pre>\n\n<p>I'm trying to get this to work:</p>\n\n<pre><code>puts \" Enter a number: \"\nnumber = gets.to_i\nputs \"*\" * number\ncount = 0\nwhile count &lt; number - 2\n  print \"*\"\n  print \" \" * (number - 2)\n  puts \"*\"\n  count += 1\nend\nputs \"*\" * number\n</code></pre>\n\n<p>The result comes out as a square. This is what I get:</p>\n\n<pre><code>*****\n*   *\n*   *\n*   *\n*****\n</code></pre>\n\n<p>Where am I going wrong?</p>\n"}, {"tags": ["ruby", "ruby-on-rails-4"], "comments": [{"owner": {"reputation": 499, "user_id": 5636930, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-L0BF3IxhZYw/AAAAAAAAAAI/AAAAAAAAAPM/RAOVvQpPSEA/photo.jpg?sz=128", "display_name": "amrrbakry", "link": "https://stackoverflow.com/users/5636930/amrrbakry"}, "edited": false, "score": 0, "creation_date": 1517426970, "post_id": 48549907, "comment_id": 84095980, "body": "see this question and its answers: <a href=\"https://stackoverflow.com/questions/21886170/best-way-to-go-about-sanitizing-user-input-in-rails\" title=\"best way to go about sanitizing user input in rails\">stackoverflow.com/questions/21886170/&hellip;</a>"}, {"owner": {"reputation": 394580, "user_id": 479863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ArUCE.jpg?s=128&g=1", "display_name": "mu is too short", "link": "https://stackoverflow.com/users/479863/mu-is-too-short"}, "edited": false, "score": 0, "creation_date": 1517429945, "post_id": 48549907, "comment_id": 84097544, "body": "So you have an ActiveRecord model and you&#39;re sending raw data out of <code>params</code> to the database by calling <code>where</code> on that model? Sounds like you might want to revisit the design."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 3, "creation_date": 1517430252, "post_id": 48549907, "comment_id": 84097714, "body": "This scope makes no sense. What is <code>:param1</code>? Why is it the first argument? This is a problem. Sanitizing fixes nothing because that scope shouldn&#39;t be valid. The normal pattern is <code>where(x: param[:x])</code> and so on."}, {"owner": {"reputation": 2578, "user_id": 1478058, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7fdc2fbe6012548e09c652be112f9a1b?s=128&d=identicon&r=PG", "display_name": "trushkevich", "link": "https://stackoverflow.com/users/1478058/trushkevich"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1517554259, "post_id": 48549907, "comment_id": 84150729, "body": "@tadman theoretically it&#39;s possible that he sends raw sql (may be he&#39;s rewriting phpmyadmin in ruby, who knows) - smth like <code>params[:param1] == &quot;my_field1 = ? OR my_field2 = ? OR my_field3 = ?&quot;</code> and all the others params are values for placeholders, e.g. <code>params[:param2] == 2; params[:param3] == 3</code>. This will result in a perfectly valid scope <code>Something::Model.where(&quot;my_field1 = 2 OR my_field2 = 2 OR my_field3 = 3&quot;)</code>"}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "reply_to_user": {"reputation": 2578, "user_id": 1478058, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7fdc2fbe6012548e09c652be112f9a1b?s=128&d=identicon&r=PG", "display_name": "trushkevich", "link": "https://stackoverflow.com/users/1478058/trushkevich"}, "edited": false, "score": 0, "creation_date": 1517596541, "post_id": 48549907, "comment_id": 84174899, "body": "@trushkevich That&#39;s exactly why I&#39;m concerned here. Putting parameters like that in directly is <b>extremely</b> risky. There is no safe way of doing it."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1517596564, "post_id": 48549907, "comment_id": 84174911, "body": "Sanitizing doesn&#39;t fix anything here. Can you give examples of the parameters you&#39;re sending?"}], "owner": {"reputation": 203, "user_id": 9226492, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/1101789162a8e10b23e10edb2f56fadd?s=128&d=identicon&r=PG&f=1", "display_name": "jose1221", "link": "https://stackoverflow.com/users/9226492/jose1221"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 61, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1517426493, "creation_date": 1517426493, "question_id": 48549907, "link": "https://stackoverflow.com/questions/48549907/sql-injection-error-at-where-method-in-controller", "title": "SQL injection error at where method in controller", "body": "<p>I have where method in Model and i am calling it in controller.</p>\n\n<pre><code>def some_method\n  test = Something::Model.where(params[:param1],\n                                params[:param2],\n                                params[:param2],\n                                params[:param3])\n  ..more code here..\nend\n</code></pre>\n\n<p>After pushing my code to remote branch, jenkins started throwing brakeman related errors. After further investigation, i found that brakeman is throwing <code>Possible sql injection error at line ``test = Something::Model.where(params[:param1]</code> So after some research i found that i have to use <code>ActionController::Base.helpers.santize</code> so when i used it as follows, it didnt throw any brakeman error.</p>\n\n<pre><code>def some_method\n  test = Something::Model.where(ActionController::Base.helpers.sanitize(params[:param1]),\n                                ActionController::Base.helpers.sanitize(params[:param2]),\n                                ActionController::Base.helpers.sanitize(params[:param2]),\n                                ActionController::Base.helpers.sanitize(params[:param3]))\n  ..more code here..\nend\n</code></pre>\n\n<p>My question is, is this the right way to fix that error or there is better way?</p>\n\n<p>Thanks for reading</p>\n"}, {"tags": ["ruby", "macos", "macos-sierra", "dtrace"], "comments": [{"owner": {"reputation": 41846, "user_id": 926143, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/3396173c3d22988be1a0732d184902aa?s=128&d=identicon&r=PG", "display_name": "7stud", "link": "https://stackoverflow.com/users/926143/7stud"}, "edited": false, "score": 0, "creation_date": 1517429352, "post_id": 48549890, "comment_id": 84097239, "body": "Did you update Xcode recently?"}, {"owner": {"reputation": 6202, "user_id": 1066615, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/iv68W.png?s=128&g=1", "display_name": "sixty4bit", "link": "https://stackoverflow.com/users/1066615/sixty4bit"}, "reply_to_user": {"reputation": 41846, "user_id": 926143, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/3396173c3d22988be1a0732d184902aa?s=128&d=identicon&r=PG", "display_name": "7stud", "link": "https://stackoverflow.com/users/926143/7stud"}, "edited": false, "score": 0, "creation_date": 1517429457, "post_id": 48549890, "comment_id": 84097287, "body": "I did update it yesterday but only after these issues began - in hopes that it might help somehow. I did the TOS agreement etc."}, {"owner": {"reputation": 41846, "user_id": 926143, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/3396173c3d22988be1a0732d184902aa?s=128&d=identicon&r=PG", "display_name": "7stud", "link": "https://stackoverflow.com/users/926143/7stud"}, "edited": false, "score": 0, "creation_date": 1517429683, "post_id": 48549890, "comment_id": 84097397, "body": "My rule is: never upgrade Xcode unless you are forced to.  For the source install, are you following the steps in the README/INSTALL file?  What about updating rbenv?  When&#39;s the last time you used rbenv to install a ruby?  Did you update your OS recently?"}, {"owner": {"reputation": 6202, "user_id": 1066615, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/iv68W.png?s=128&g=1", "display_name": "sixty4bit", "link": "https://stackoverflow.com/users/1066615/sixty4bit"}, "reply_to_user": {"reputation": 41846, "user_id": 926143, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/3396173c3d22988be1a0732d184902aa?s=128&d=identicon&r=PG", "display_name": "7stud", "link": "https://stackoverflow.com/users/926143/7stud"}, "edited": false, "score": 0, "creation_date": 1517432850, "post_id": 48549890, "comment_id": 84099016, "body": "Can&#39;t remember when I last installed a ruby but I had installed 2.5.0 with it so probably December at the latest. Don&#39;t think I updated my OS recently - it was 10.12.6 which was released ~6 months ago but I can&#39;t remember when I updated to it. As for README/INSTALL, no I am just following the steps I got from the &quot;chruby&quot; README (tried chruby also, after removing rbenv thoroughly, because it&#39;s more minimal than rbenv). Where is that exactly? I don&#39;t see it in the unarchived ruby-2.4.2 directory"}, {"owner": {"reputation": 41846, "user_id": 926143, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/3396173c3d22988be1a0732d184902aa?s=128&d=identicon&r=PG", "display_name": "7stud", "link": "https://stackoverflow.com/users/926143/7stud"}, "edited": false, "score": 0, "creation_date": 1517436411, "post_id": 48549890, "comment_id": 84100775, "body": "Is there a docs directory?  Usually the README and INSTALL files are in the top level directory.  I&#39;ve never seen it any other way, and I almost always install from source on OSX."}, {"owner": {"reputation": 6202, "user_id": 1066615, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/iv68W.png?s=128&g=1", "display_name": "sixty4bit", "link": "https://stackoverflow.com/users/1066615/sixty4bit"}, "reply_to_user": {"reputation": 41846, "user_id": 926143, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/3396173c3d22988be1a0732d184902aa?s=128&d=identicon&r=PG", "display_name": "7stud", "link": "https://stackoverflow.com/users/926143/7stud"}, "edited": false, "score": 0, "creation_date": 1517437044, "post_id": 48549890, "comment_id": 84101057, "body": "I will check just to be sure. On the advice of a friend, though, I tried uninstalling XCode and Homebrew, then reinstalling just Homebrew (which includes Xcode command line tools), and that got me moving again"}, {"owner": {"reputation": 41846, "user_id": 926143, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/3396173c3d22988be1a0732d184902aa?s=128&d=identicon&r=PG", "display_name": "7stud", "link": "https://stackoverflow.com/users/926143/7stud"}, "edited": false, "score": 0, "creation_date": 1517437136, "post_id": 48549890, "comment_id": 84101100, "body": "I just downloaded <code>ruby 2.4.3.tar.gz</code> from the ruby website, and I untared it and the README.md fle is at the top level.  I suggest you do <code>$ ls READ*</code> and see what the output is."}, {"owner": {"reputation": 41846, "user_id": 926143, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/3396173c3d22988be1a0732d184902aa?s=128&d=identicon&r=PG", "display_name": "7stud", "link": "https://stackoverflow.com/users/926143/7stud"}, "edited": false, "score": 0, "creation_date": 1517437580, "post_id": 48549890, "comment_id": 84101301, "body": "I&#39;ve got homebrew installed and I use Xcode 9.2 for iOS programming, and I have had no problems on High Sierra (10.13.2).  I would be jettisoning homebrew first.  I prefer installing most things from source, but if it requires more than 3 dependency installs, then lately I&#39;ve been resorting to homebrew.  But I&#39;ve had more problems installing things with homebrew than installing from source.  I use <code>rvm</code> for managing ruby versions."}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1517571554, "post_id": 48549890, "comment_id": 84160086, "body": "Any way to get a stack trace of the <code>make</code> process that&#39;s hanging on that <code>select()</code>?  Or look at the open file descriptors?  Maybe that would allow you to find out just what the make process is waiting for."}], "owner": {"reputation": 6202, "user_id": 1066615, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/iv68W.png?s=128&g=1", "display_name": "sixty4bit", "link": "https://stackoverflow.com/users/1066615/sixty4bit"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 250, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1517427141, "creation_date": 1517426426, "last_edit_date": 1517427141, "question_id": 48549890, "link": "https://stackoverflow.com/questions/48549890/installing-ruby-on-osx-sierra-hangs-indefinitely-on-make-processes-sleeping", "title": "Installing Ruby on OSX Sierra Hangs Indefinitely on &quot;make&quot; (processes &quot;sleeping&quot;)", "body": "<p>OSX 10.12.6 / Xcode 9.2</p>\n\n<p>For some reason the <code>make</code> process is stalling indefinitely when I try to install a new Ruby version or really do anything that involves native extensions in Ruby. </p>\n\n<p>At first I noticed that this was happening when I tried to run <code>bundle install</code> in a Rails app that uses <code>nokogiri</code>. Updating <code>nokogiri</code> and handling the native extensions hung indefinitely. </p>\n\n<p>Then I tried uninstalling-reinstalling Ruby (using <code>rbenv</code>), then re-bundling, and I found that I couldn't even install Ruby with <code>rbenv</code> (same hanging symptom). </p>\n\n<p>So I thought maybe there was a problem with <a href=\"https://github.com/rbenv/rbenv\" rel=\"nofollow noreferrer\">rbenv</a>, but it's also happening when I try to install a new Ruby version from source.</p>\n\n<p>These are the commands I'm running:</p>\n\n<pre><code>$ wget https://cache.ruby-lang.org/pub/ruby/2.4/ruby-2.4.2.tar.bz2\n$ tar -xjvf ruby-2.4.2.tar.bz2\n$ cd ruby-2.4.2\n$ ./configure --prefix=~/.rubies/ruby-2.4.2\n$ make\n</code></pre>\n\n<p>The output from <code>make</code>:</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>\u279c  ruby-2.4.2 make \n\nMakefile:3225: warning: overriding commands for target 'ruby'\n\nMakefile:227: warning: ignoring old commands for target 'ruby'\n\n    CC = clang\n    LD = ld\n    LDSHARED = clang -dynamic -bundle\n    CFLAGS = -O3 -fno-fast-math -ggdb3 -Wall -Wextra -Wno-unused-parameter -Wno-parentheses -Wno-long-long -Wno-missing-field-initializers -Wno-tautological-compare -Wno-parentheses-equality -Wno-constant-logical-operand -Wno-self-assign -Wunused-variable -Wimplicit-int -Wpointer-arith -Wwrite-strings -Wdeclaration-after-statement -Wshorten-64-to-32 -Wimplicit-function-declaration -Wdivision-by-zero -Wdeprecated-declarations -Wextra-tokens   -pipe\n    XCFLAGS = -D_FORTIFY_SOURCE=2 -fstack-protector -fno-strict-overflow -fvisibility=hidden -DRUBY_EXPORT -fPIE\n    CPPFLAGS = -D_XOPEN_SOURCE -D_DARWIN_C_SOURCE -D_DARWIN_UNLIMITED_SELECT -D_REENTRANT   -I. -I.ext/include/x86_64-darwin16 -I./include -I. -I./enc/unicode/9.0.0\n    DLDFLAGS = -Wl,-undefined,dynamic_lookup -Wl,-multiply_defined,suppress -fstack-protector -Wl,-u,_objc_msgSend -Wl,-pie -framework CoreFoundation\n    SOLIBS =\nApple LLVM version 9.0.0 (clang-900.0.39.2)\nTarget: x86_64-apple-darwin16.7.0\nThread model: posix\nInstalledDir: /Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/bin\n</code></pre>\n\n<p>Then the process just hangs. If I get the process using <code>ps</code> and inspect its process tree using <code>pstree</code> and <code>top</code> I get this:</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>    \u279c  ~ ps aux | grep make\n    me         8999   0.0  0.0  2451364   1456 s001  S+    2:01PM   0:00.02 /Applications/Xcode.app/Contents/Developer/usr/bin/make\n\n\u279c  ~ pstree -p 8999\n\n    -+= 00001 root /sbin/launchd\n     \\-+= 01078 me /Applications/iTerm.app/Contents/MacOS/iTerm2\n       \\-+= 01087 me /Applications/iTerm.app/Contents/MacOS/iTerm2 --server login -fp me\n         \\-+= 01088 root login -fp  me\n           \\-+= 01090 me -zsh\n             \\-+= 08999 me /Applications/Xcode.app/Contents/Developer/usr/bin/make\n               \\--- 09012 me echo translating probes probes.d\n\n\u279c  ~ top -pid 09012\n\nPID   COMMAND      %CPU TIME     #TH  #WQ  #POR MEM   PURG CMPR PGRP PPID STATE    BOOSTS     %CPU_ME %CPU_OTHRS UID  FAUL COW\n9012  echo         0.0  00:00.00 5    0    17   496K  0B   0B   8999 8999 sleeping *0[1]      0.00000 0.00000    503  353  13\n</code></pre>\n\n<p>As you can see, it says the process is \"sleeping\" and has no CPU usage. </p>\n\n<p>I found somewhere online that I can use <code>dtruss</code> on OS X as a wrapper to <code>dtrace</code> to get behavior similar to <code>strace</code>, so I tried running <code>make</code> and then tracing it in another window:</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>\u279c  ~ pstree -p 15632\n-+= 00001 root /sbin/launchd\n \\-+= 01078 me /Applications/iTerm.app/Contents/MacOS/iTerm2\n   \\-+= 01087 me /Applications/iTerm.app/Contents/MacOS/iTerm2 --server login -fp me\n     \\-+= 01088 root login -fp me\n       \\-+= 01090 me -zsh\n         \\-+= 15632 me /Applications/Xcode.app/Contents/Developer/usr/bin/make\n           \\--- 15645 me echo translating probes probes.d\n\n\u279c  ~ sudo dtruss -fp 15645\ndtrace: system integrity protection is on, some features will not be available\n\n    PID/THRD  SYSCALL(args)          = return\n15645/0xe4d2:  madvise(0xC42008C000, 0x74000, 0x5)       = 0 0\n15645/0xe4d2:  select(0x0, 0x0, 0x0, 0x0, 0xC420041F18)      = 0 0\n15645/0xe4d2:  select(0x0, 0x0, 0x0, 0x0, 0xC420041F18)      = 0 0\n15645/0xe4d2:  select(0x0, 0x0, 0x0, 0x0, 0xC420041F18)      = 0 0\n</code></pre>\n\n<p>Those \"select\" lines appear once every minute or so, but that's all I'm getting.</p>\n\n<p>I'm totally stumped about what I might be able to try next. Any suggestions?? </p>\n"}, {"tags": ["ruby-on-rails", "ruby", "redis"], "answers": [{"tags": [], "owner": {"reputation": 2093, "user_id": 3309314, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/3683a7a05e7e97a67c262b774db00d08?s=128&d=identicon&r=PG&f=1", "display_name": "user3309314", "link": "https://stackoverflow.com/users/3309314/user3309314"}, "is_accepted": false, "score": 0, "last_activity_date": 1517433970, "creation_date": 1517433970, "answer_id": 48551711, "question_id": 48549812, "link": "https://stackoverflow.com/questions/48549812/find-each-with-hkeys-on-redis-in-ruby-on-rails-app/48551711#48551711", "title": "Find_each with hkeys on Redis in Ruby on Rails App", "body": "<p>Taken from <a href=\"https://redis.io/commands/hkeys\" rel=\"nofollow noreferrer\">Redis HKEYS command</a>:</p>\n\n<blockquote>\n  <p>Returns all field names in the hash stored at key.</p>\n</blockquote>\n\n<p>So Redis by itself doesn't support pagination. </p>\n\n<p>You can get keys from redis and paginate is manually using <a href=\"https://github.com/kaminari/kaminari\" rel=\"nofollow noreferrer\">Kaminari</a>. Look at this <a href=\"https://github.com/kaminari/kaminari/wiki/Kaminari-recipes#-how-do-i-paginate-an-array\" rel=\"nofollow noreferrer\">How do I paginate an Array?</a></p>\n"}, {"tags": [], "owner": {"reputation": 13635, "user_id": 4494, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/5981dd7d253ecf61590502eeb183ee7b?s=128&d=identicon&r=PG", "display_name": "Matthias Winkelmann", "link": "https://stackoverflow.com/users/4494/matthias-winkelmann"}, "is_accepted": false, "score": 0, "last_activity_date": 1517434567, "creation_date": 1517434567, "answer_id": 48551838, "question_id": 48549812, "link": "https://stackoverflow.com/questions/48549812/find-each-with-hkeys-on-redis-in-ruby-on-rails-app/48551838#48551838", "title": "Find_each with hkeys on Redis in Ruby on Rails App", "body": "<p>Redis' hash datatype is ill-suited for data that has so many key/value pairs that you'd want to paginate them, which is why there is no function that allows pagination. (Redis tends to make it hard to shoot yourself in the foot.)</p>\n\n<p>If you need pagination, you'd probably want to use <em>lists</em>, which allow accessing elements at any position with <em>O(N)</em> complexity. </p>\n"}], "owner": {"reputation": 204, "user_id": 6592441, "user_type": "registered", "accept_rate": 62, "profile_image": "https://lh3.googleusercontent.com/-Iyy_SvT-93s/AAAAAAAAAAI/AAAAAAAAAZs/enulpSsytFs/photo.jpg?sz=128", "display_name": "Andre Leoni", "link": "https://stackoverflow.com/users/6592441/andre-leoni"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 89, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1517434567, "creation_date": 1517426179, "question_id": 48549812, "link": "https://stackoverflow.com/questions/48549812/find-each-with-hkeys-on-redis-in-ruby-on-rails-app", "title": "Find_each with hkeys on Redis in Ruby on Rails App", "body": "<p>I need to do something like a find_each on rails with redis.</p>\n\n<p>I need to take for example, the values with limit of 100 registries, and, when i pass the paginate 2, i get other 100 registries.</p>\n\n<p>I'm getting the values with HKEYS method in rails...</p>\n\n<p><code>Model.redis.hkeys(:keysofvalues)</code></p>\n\n<p>I saw the redis documentation and i didn't found nothing with say how it works. </p>\n\n<p>Thanks!</p>\n"}, {"tags": ["ruby", "openssl", "private-key", "ruby-2.1"], "comments": [{"owner": {"reputation": 52334, "user_id": 702638, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/892f65bc0a8a0949ab88598de7d83cab?s=128&d=identicon&r=PG", "display_name": "Hunter McMillen", "link": "https://stackoverflow.com/users/702638/hunter-mcmillen"}, "edited": false, "score": 1, "creation_date": 1517424790, "post_id": 48549458, "comment_id": 84094853, "body": "You probably shouldn&#39;t paste your private key into the question."}, {"owner": {"reputation": 2132, "user_id": 856753, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/1c53a71370f55d0f0a4cc7e4b2c06b91?s=128&d=identicon&r=PG", "display_name": "Micheal", "link": "https://stackoverflow.com/users/856753/micheal"}, "reply_to_user": {"reputation": 52334, "user_id": 702638, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/892f65bc0a8a0949ab88598de7d83cab?s=128&d=identicon&r=PG", "display_name": "Hunter McMillen", "link": "https://stackoverflow.com/users/702638/hunter-mcmillen"}, "edited": false, "score": 0, "creation_date": 1517425172, "post_id": 48549458, "comment_id": 84095054, "body": "it was just a test private key i generated. but you are right, i modified it."}, {"owner": {"reputation": 41846, "user_id": 926143, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/3396173c3d22988be1a0732d184902aa?s=128&d=identicon&r=PG", "display_name": "7stud", "link": "https://stackoverflow.com/users/926143/7stud"}, "edited": false, "score": 1, "creation_date": 1517431962, "post_id": 48549458, "comment_id": 84098558, "body": "@Micheal, Unfortunately, anyone can click on the link &quot;edited x hours ago&quot; and see what you originally posted.  If you make a mistake on SO, it&#39;s preserved for eternity. :("}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1517435091, "post_id": 48549458, "comment_id": 84100151, "body": "Where do you initialize <code>key</code>?"}, {"owner": {"reputation": 41846, "user_id": 926143, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/3396173c3d22988be1a0732d184902aa?s=128&d=identicon&r=PG", "display_name": "7stud", "link": "https://stackoverflow.com/users/926143/7stud"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1517458221, "post_id": 48549458, "comment_id": 84106557, "body": "@tadman, Right there: <i>How do i convert to OpenSSL:Pkey class.</i>"}], "answers": [{"tags": [], "owner": {"reputation": 41846, "user_id": 926143, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/3396173c3d22988be1a0732d184902aa?s=128&d=identicon&r=PG", "display_name": "7stud", "link": "https://stackoverflow.com/users/926143/7stud"}, "is_accepted": true, "score": 2, "last_activity_date": 1517459170, "last_edit_date": 1517459170, "creation_date": 1517431753, "answer_id": 48551171, "question_id": 48549458, "link": "https://stackoverflow.com/questions/48549458/ruby-convert-string-private-key-back-to-openssl-class-for-encryption/48551171#48551171", "title": "ruby convert string private key back to openssl class for encryption", "body": "<blockquote>\n  <p>How do i convert to OpenSSL:Pkey class</p>\n</blockquote>\n\n<pre><code>require 'openssl'\n\nkey = OpenSSL::PKey::RSA.generate(1024, 3)\nencoded_str = key.to_s  #This is your string\nputs encoded_str\n\nputs '*' * 30\n\nkey = OpenSSL::PKey::RSA.new encoded_str\nputs key.to_s  #Should be the same as your string\n\nputs '*' * 30\n\ncipher = OpenSSL::Cipher.new 'DES-EDE3-CBC'\npass_phrase = \"hello world\"\npem_encoded_str = key.export cipher, pass_phrase\nputs pem_encoded_str\n\n\n--output:--\n-----BEGIN RSA PRIVATE KEY-----\nMIICWwIBAAKBgQCtyWCVI8dkpH9ol9q3Ve5GUpOCvrMZWKIiMTOSn6WsQQOZU1Lw\nXb2hBjiSWA2bh1REPaW/+OwGfxHruPv80/J/4vwpezPagprcUSOdfi1coD+X4Cdd\nSd4Y81i11kjlHLVNVYtU8eDS5D8LeotIuG4Lq65HoNrHZC7DCygvBmu1cwIBAwKB\ngHPblbjChO3C/5sP5yTj9C7ht6x/IhDlwWwgzQxqbnLWAmY3jKA+fmtZeww6s70E\n4tgpGSql8q7/YUfQp/3ioal9EhShxMj4GlgcBxBC9RCsQd7AhF/iOVD0ZihTJib1\n1A1M46jp1GagybKO+bRao/eMHr6S6pWjNHdZAxAatqDbAkEA5an7qRz3MBNJespJ\np83dYqbO2uZxjMTT24+KWjJfS7bbH3Kr9vEeZHkbptjSasjk1Gf86UNE4oC6LuBU\nmSco/QJBAMG3Dt9vtd5gDqxOu3Hv5js1+uR6W+nDS6kv7v9dS2BAXkLDK5wxGo6X\nY/0758WvM4UYLNs3ogzfVdbDQkUymy8CQQCZG/0baKTKt4ZR3DEaiT5BxInnREuz\nLeKSX7GRduoyeedqTHKkoL7tphJvOzbx20M4RVNGLNiXAHwfQDhmGhtTAkEAgSS0\nlPUj6ZVfHYnSS/VEJ3lR7abn8SzdG3VJ/5OHlYA+1yzHvXYRtGTtU31FLnTNA2Vz\nPM/BXeo5OdeBg3cSHwJAcrIdUXxPfk21dDymgmTMkj4EsLhaO6/5nGpElt2JNQ8S\ntfgUq8Z2b5XXtm6QJRxAoMYFvfxMfkH93ChpHQjVVg==\n-----END RSA PRIVATE KEY-----\n******************************\n-----BEGIN RSA PRIVATE KEY-----\nMIICWwIBAAKBgQCtyWCVI8dkpH9ol9q3Ve5GUpOCvrMZWKIiMTOSn6WsQQOZU1Lw\nXb2hBjiSWA2bh1REPaW/+OwGfxHruPv80/J/4vwpezPagprcUSOdfi1coD+X4Cdd\nSd4Y81i11kjlHLVNVYtU8eDS5D8LeotIuG4Lq65HoNrHZC7DCygvBmu1cwIBAwKB\ngHPblbjChO3C/5sP5yTj9C7ht6x/IhDlwWwgzQxqbnLWAmY3jKA+fmtZeww6s70E\n4tgpGSql8q7/YUfQp/3ioal9EhShxMj4GlgcBxBC9RCsQd7AhF/iOVD0ZihTJib1\n1A1M46jp1GagybKO+bRao/eMHr6S6pWjNHdZAxAatqDbAkEA5an7qRz3MBNJespJ\np83dYqbO2uZxjMTT24+KWjJfS7bbH3Kr9vEeZHkbptjSasjk1Gf86UNE4oC6LuBU\nmSco/QJBAMG3Dt9vtd5gDqxOu3Hv5js1+uR6W+nDS6kv7v9dS2BAXkLDK5wxGo6X\nY/0758WvM4UYLNs3ogzfVdbDQkUymy8CQQCZG/0baKTKt4ZR3DEaiT5BxInnREuz\nLeKSX7GRduoyeedqTHKkoL7tphJvOzbx20M4RVNGLNiXAHwfQDhmGhtTAkEAgSS0\nlPUj6ZVfHYnSS/VEJ3lR7abn8SzdG3VJ/5OHlYA+1yzHvXYRtGTtU31FLnTNA2Vz\nPM/BXeo5OdeBg3cSHwJAcrIdUXxPfk21dDymgmTMkj4EsLhaO6/5nGpElt2JNQ8S\ntfgUq8Z2b5XXtm6QJRxAoMYFvfxMfkH93ChpHQjVVg==\n-----END RSA PRIVATE KEY-----\n******************************\n-----BEGIN RSA PRIVATE KEY-----\nProc-Type: 4,ENCRYPTED\nDEK-Info: DES-EDE3-CBC,73C71A1D7325EAAF\n\n2sKeayKdmnDxHyYs35ydnt/ZRUUzgVvVl4c9ohxZWurHQwQDNAZ7j1WE+/JNo44y\ndlY9LPW2PfT4fw5yC/k0uN1YPTgtOBKL9jpKfI8pcpea2fyAJzDXu8bdvWiWDnF2\n9pjO/ghe1pZNdfU+yGkweIr6qQH4b6piWPtvf0VBBQnjqq7OqFDYYp1eXVal27+B\nVaZLYk1nWDInUPE7bEEHY5VZLVRNg/wCQ0qPoCDbBXb3cyss9pg7ysrNNi6Fa0Yq\nZ00GYK1yENDnH4mJj9VzDAC1yV8592SdW1qDzDR0QCtQ5BenWunAS61R7wyLkS0L\nvCahavVGW9etAcwXUy12qysNz8MnnGT75/aTqMx6Eu1oj7Lu4orQlz7qNcb7Mtwe\n5tLCRW59PT57K52KSJNjKJpAUrSZ9kJCwt9Mk+zAiRkIg48DztuF0STJ1U0qAN9V\ns61tVHJAPWl9Th7xxGt6pfLErOpikqcte6tFnaMcBRqzeCVXcQfDLMY/RZJgW+34\nCM54FyRH8cGDiajSnpGMsCNM3y41Mk+02yrwVA4jOvXq4yrCjCghL8SnZ9FkTTuh\n6+Uuc2B2DFVbiOwDRCgaIo9jLgEu4Et400QQMnllE9RxDlFIgnCoXP8A9fhNRZu5\nzuH+1K7NpKxqLIqldZdiPKLsXS/rE7CFi/u1RVcHidCnpKR2aPO47ntpLUK9jcHY\nZRpa0hoNY/5mkMgth5qJL6bD6YDkE+6Spsdpxq2f11HK9IuyiTvIav2BVHbIrXcM\nvoMhuSWVW9RPphY9rVxesZWmHN0VPBwwVqNg5KnbLv4=\n-----END RSA PRIVATE KEY-----\n</code></pre>\n"}], "owner": {"reputation": 2132, "user_id": 856753, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/1c53a71370f55d0f0a4cc7e4b2c06b91?s=128&d=identicon&r=PG", "display_name": "Micheal", "link": "https://stackoverflow.com/users/856753/micheal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1038, "favorite_count": 1, "accepted_answer_id": 48551171, "answer_count": 1, "score": 1, "last_activity_date": 1517459170, "creation_date": 1517424721, "last_edit_date": 1517439920, "question_id": 48549458, "link": "https://stackoverflow.com/questions/48549458/ruby-convert-string-private-key-back-to-openssl-class-for-encryption", "title": "ruby convert string private key back to openssl class for encryption", "body": "<p>I have a situation where the private key is stored as a string in the database.</p>\n\n<pre><code>&gt; private_key\n&gt; =&gt; \"-----BEGIN RSA PRIVATE KEY-----\\nMIIEpk9KuPZrNC+pvJzohwXAwJwC8kIZaidMsKbOmyAz\\nZBXKkUZ+gxDu4bd7InKwvjhufmnby0X+XcoPDfn/AoGAViYhxIGcQkVnvSzmdXQS\\ngAgyl9LLB8MIM+q31Aflv0Vg31qjzxBb1p6Am+TwSE5rl+IWULlUAGPNAp5OLztb\\nHY4DVNyfRspd5LiOoVhsqCVitFcV0\\nSwZFd4EmgDlWgZ6F0Dkv/RdIzWcQNOqwQm9OXoEl30D7cbHbbDbncGNJ4oPHaNta\\no3mNu4MCgYB47e229eaJIaVOTkzY2arqiq8hVbIIrqHv8bRtK93TbCM8APow7Hrd\\nlUac3SGmlDbFZ486O7PfT2bblf2u4xpcvKPN6ApHpdegoN1eCwqthWnXCMETbWaM\\nqavVjCaqGFSYOnCxqoiURtiQkW+u3FJaMi4joZqhU34vAnV9mn9G9w==\\n-----END\n&gt; RSA PRIVATE KEY-----\\n\n</code></pre>\n\n<p>\"</p>\n\n<p>How do i convert to OpenSSL:Pkey class.</p>\n\n<pre><code>#&lt;OpenSSL::PKey::RSA:0x007fd98c80bc28&gt;\n</code></pre>\n\n<p>The reason I want to do this so that I can encrypt it as follows.</p>\n\n<pre><code>cipher = OpenSSL::Cipher.new 'DES-EDE3-CBC'\n\nkey_secure = key.export cipher, pass_phrase\n</code></pre>\n\n<p>Since it is a string I get this error:</p>\n\n<pre><code>undefined method `export' for #&lt;String:0x007fdb832f6b40&gt;\n</code></pre>\n"}, {"tags": ["ruby", "linechart", "axlsx"], "comments": [{"owner": {"reputation": 1295, "user_id": 4360863, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/heWif.png?s=128&g=1", "display_name": "Philip Brack", "link": "https://stackoverflow.com/users/4360863/philip-brack"}, "edited": false, "score": 0, "creation_date": 1517425023, "post_id": 48549398, "comment_id": 84094971, "body": "can you please edit your post with your code with enough to reproduce?"}, {"owner": {"reputation": 1, "user_id": 9296020, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1fc5b519e59d66ab32e3f5dd714ea3c5?s=128&d=identicon&r=PG&f=1", "display_name": "Llon", "link": "https://stackoverflow.com/users/9296020/llon"}, "reply_to_user": {"reputation": 1295, "user_id": 4360863, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/heWif.png?s=128&g=1", "display_name": "Philip Brack", "link": "https://stackoverflow.com/users/4360863/philip-brack"}, "edited": false, "score": 0, "creation_date": 1517427085, "post_id": 48549398, "comment_id": 84096055, "body": "@@compAry.each_with_index do |data,index| \t\t    \t\t\t@dbChart.add_series :data =&gt; @wb.sheet_by_name(&quot;DBsim Source&quot; + index.to_s)[&quot;D3:M3&quot;], :labels =&gt; @wb.sheet_by_name(&quot;DBsim Source&quot; + index.to_s)[&quot;D2:M2&quot;], :title =&gt; &quot;Source&quot; + index.to_s, :show_marker =&gt; true \t\t    \t\tend \t\t    \t\t   I basically have 2 individual sheets stored in a global array called @@compAry. I&#39;m cycling through both sheets and making a new series using the &quot;IOPS&quot; data as my labels (which is what I want to change)  P.S - I dont know how to format within this box to make it look cleaner, so sorry about that"}], "owner": {"reputation": 1, "user_id": 9296020, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1fc5b519e59d66ab32e3f5dd714ea3c5?s=128&d=identicon&r=PG&f=1", "display_name": "Llon", "link": "https://stackoverflow.com/users/9296020/llon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 61, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1517424460, "creation_date": 1517424460, "question_id": 48549398, "link": "https://stackoverflow.com/questions/48549398/axlsx-x-axis-scaling", "title": "AXLSX X-Axis Scaling", "body": "<p>Made an account just for this, because I really can't figure this one out using the AXLSX gem. I have a line chart generated already with labels, but I want to space them out evenly using the MAX value rounded up to the nearest 10,000th for 9 points. </p>\n\n<p>The example I attached has 120,152 as the highest values, so I want to set the MAX as 130,000, and have even intervals for each point leading up to it (0, 12k, 24k, 36k, for example). </p>\n\n<p>How would I be able to customize the labels to follow this scheme using the AXLSX gem?</p>\n\n<p><a href=\"https://i.stack.imgur.com/xBJdh.png\" rel=\"nofollow noreferrer\">Picture of my Chart</a></p>\n\n<p>Thanks!</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "answers": [{"comments": [{"owner": {"reputation": 2960, "user_id": 7426461, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/Ldwxy.jpg?s=128&g=1", "display_name": "Cannon Moyer", "link": "https://stackoverflow.com/users/7426461/cannon-moyer"}, "edited": false, "score": 0, "creation_date": 1517428897, "post_id": 48549477, "comment_id": 84097009, "body": "This query would get everything within the last 30 minutes and not 30 minutes ago, right?"}, {"owner": {"reputation": 1196, "user_id": 8426717, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-QwYD3zUWkhA/AAAAAAAAAAI/AAAAAAAABJs/2y8hDOo4fYY/photo.jpg?sz=128", "display_name": "Tai", "link": "https://stackoverflow.com/users/8426717/tai"}, "reply_to_user": {"reputation": 2960, "user_id": 7426461, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/Ldwxy.jpg?s=128&g=1", "display_name": "Cannon Moyer", "link": "https://stackoverflow.com/users/7426461/cannon-moyer"}, "edited": false, "score": 1, "creation_date": 1517429763, "post_id": 48549477, "comment_id": 84097435, "body": "Previous query is like what you said. But I have just updated the query. Please check the new one."}], "tags": [], "owner": {"reputation": 1196, "user_id": 8426717, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-QwYD3zUWkhA/AAAAAAAAAAI/AAAAAAAABJs/2y8hDOo4fYY/photo.jpg?sz=128", "display_name": "Tai", "link": "https://stackoverflow.com/users/8426717/tai"}, "is_accepted": true, "score": 2, "last_activity_date": 1517429719, "last_edit_date": 1517429719, "creation_date": 1517424832, "answer_id": 48549477, "question_id": 48549389, "link": "https://stackoverflow.com/questions/48549389/get-record-created-30-minutes-ago-rails/48549477#48549477", "title": "Get Record Created 30 Minutes Ago - Rails", "body": "<p>Please try below query:</p>\n\n<pre><code># if current time is 3:00:03\n# it will return carts created at 2:30:00 -&gt; 2:30:59\nfrom_mins_ago = 30.minutes.ago.change(sec: 0)\nto_mins_ago   = from_mins_ago.change(sec: 59) \nCart.joins(:cart_addresses).group('carts.id').where(created_at: from_mins_ago..to_min_ago).pluck('carts.id')\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 4690, "user_id": 1937435, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/YyN37.jpg?s=128&g=1", "display_name": "Josh Brody", "link": "https://stackoverflow.com/users/1937435/josh-brody"}, "is_accepted": false, "score": 0, "last_activity_date": 1517424903, "creation_date": 1517424903, "answer_id": 48549495, "question_id": 48549389, "link": "https://stackoverflow.com/questions/48549389/get-record-created-30-minutes-ago-rails/48549495#48549495", "title": "Get Record Created 30 Minutes Ago - Rails", "body": "<p>You could use a range.</p>\n\n<p><code>Cart.joins(:cart_addresses).group('carts.id').where(created_at: 30.minutes.ago..DateTime.now)</code></p>\n\n<p>There's a lot of solutions. </p>\n\n<p>More: <a href=\"https://stackoverflow.com/questions/2381718/rails-activerecord-date-between/12946091\">Rails ActiveRecord date between</a></p>\n"}], "owner": {"reputation": 2960, "user_id": 7426461, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/Ldwxy.jpg?s=128&g=1", "display_name": "Cannon Moyer", "link": "https://stackoverflow.com/users/7426461/cannon-moyer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1653, "favorite_count": 0, "accepted_answer_id": 48549477, "answer_count": 2, "score": 2, "last_activity_date": 1517429719, "creation_date": 1517424412, "question_id": 48549389, "link": "https://stackoverflow.com/questions/48549389/get-record-created-30-minutes-ago-rails", "title": "Get Record Created 30 Minutes Ago - Rails", "body": "<p>I need to get records created 30 minutes ago from <code>Time.now</code>. I'm using a cron and I want to fire the cron once ever minute.  </p>\n\n<p>I essentially need this except it should ignore the seconds so that if <code>Time.now == Wed, 31 Jan 2018 18:00:31 +0000</code> then a record with <code>created_at = \"Wed, 31 Jan 2018 17:30:23 +0000</code> should match. </p>\n\n<p>Here is the query I have so far which doesn't work because the time is improperly evaluated. </p>\n\n<pre><code>Cart.joins(:cart_addresses).group('carts.id').where(created_at: Time.now - 30.minutes).each do |i|\n  puts i.id\nend\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "devise"], "comments": [{"owner": {"reputation": 2885, "user_id": 3372172, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Q3RaO.png?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/3372172/pablo"}, "edited": false, "score": 2, "creation_date": 1517422544, "post_id": 48548762, "comment_id": 84093639, "body": "Does your users table have locked_at field?"}, {"owner": {"reputation": 6277, "user_id": 3889100, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/mhI6k.png?s=128&g=1", "display_name": "TheJim01", "link": "https://stackoverflow.com/users/3889100/thejim01"}, "edited": false, "score": 0, "creation_date": 1517425337, "post_id": 48548762, "comment_id": 84095147, "body": "Please take a look at [<code>https:&#47;&#47;stackoverflow.com&#47;help&#47;how-to-ask</code>](How do I ask a good question?). <b>Some suggestions:</b> Change the title of your post to describe the problem. Include the code where the error is being thrown. Try not to use screenshots for posting errors/code--it&#39;s better when the text is easily copied."}], "answers": [{"tags": [], "owner": {"reputation": 1607, "user_id": 7804093, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pFFFH.jpg?s=128&g=1", "display_name": "Ganesh", "link": "https://stackoverflow.com/users/7804093/ganesh"}, "is_accepted": true, "score": 6, "last_activity_date": 1517423084, "last_edit_date": 1517423084, "creation_date": 1517422545, "answer_id": 48548882, "question_id": 48548762, "link": "https://stackoverflow.com/questions/48548762/undefined-local-variable-or-method-locked-at-for-user0x007f28a2101568-did/48548882#48548882", "title": "undefined local variable or method `locked_at&#39; for #&lt;User:0x007f28a2101568&gt; Did you mean? lock_access", "body": "<p>I think locked_at column were not added for users table</p>\n\n<p>generate migration for adding column in users table</p>\n\n<pre><code>  def change\n    add_column :users, :locked_at, :datetime\n  end\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 268, "user_id": 2474531, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/47L40.jpg?s=128&g=1", "display_name": "thrgamon", "link": "https://stackoverflow.com/users/2474531/thrgamon"}, "is_accepted": false, "score": 1, "last_activity_date": 1560078721, "creation_date": 1560078721, "answer_id": 56514109, "question_id": 48548762, "link": "https://stackoverflow.com/questions/48548762/undefined-local-variable-or-method-locked-at-for-user0x007f28a2101568-did/56514109#56514109", "title": "undefined local variable or method `locked_at&#39; for #&lt;User:0x007f28a2101568&gt; Did you mean? lock_access", "body": "<p>For those who are coming here from Google like me, you may want to also heed this line in the Devise getting started README - <a href=\"https://github.com/plataformatec/devise#getting-started\" rel=\"nofollow noreferrer\">https://github.com/plataformatec/devise#getting-started</a></p>\n\n<blockquote>\n  <p>Next, check the MODEL for any additional configuration options you\n  might want to add, such as confirmable or lockable. If you add an\n  option, be sure to inspect the migration file (created by the\n  generator if your ORM supports them) and uncomment the appropriate\n  section. For example, if you add the confirmable option in the model,\n  you'll need to uncomment the Confirmable section in the migration.</p>\n</blockquote>\n\n<p>Double check your Devise users migration file (<code>db/migrate/TIMESTAMP_devise_create_users.rb</code>) and uncomment any of the necessary sections. In this case, the sections relating to the <code>Lockable</code> module.</p>\n"}], "owner": {"reputation": 269, "user_id": 7895358, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/59e835c2ba409261d31caf24c8116469?s=128&d=identicon&r=PG&f=1", "display_name": "Shreya Choubey", "link": "https://stackoverflow.com/users/7895358/shreya-choubey"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1340, "favorite_count": 0, "accepted_answer_id": 48548882, "answer_count": 2, "score": 2, "last_activity_date": 1560078721, "creation_date": 1517422179, "last_edit_date": 1517426773, "question_id": 48548762, "link": "https://stackoverflow.com/questions/48548762/undefined-local-variable-or-method-locked-at-for-user0x007f28a2101568-did", "title": "undefined local variable or method `locked_at&#39; for #&lt;User:0x007f28a2101568&gt; Did you mean? lock_access", "body": "<p>So I have made a project in ruby on rails for authentication using devise and facebook. While logging in through devise simple sign up I am getting this error of: </p>\n\n<blockquote>\n  <p>undefined local variable or method `locked_at' for # Did you mean? lock_access!</p>\n</blockquote>\n\n<p><a href=\"https://i.stack.imgur.com/oKBE3.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/oKBE3.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["arrays", "ruby"], "comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 1, "creation_date": 1517421529, "post_id": 48548126, "comment_id": 84093025, "body": "Ruby&#39;s naming conventions are such that variable and method names <i>should not</i> contain upper-case letters. Use <code>input_array</code> here instead of what you have for consistency&#39;s sake. Capital letters in Ruby have significant meaning, as a leading capital letter is a constant reserved for <code>ClassName</code> or <code>CONSTANT_NAME</code> type situations."}, {"owner": {"reputation": 24179, "user_id": 1672429, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/0815eb7d4e9dd58022d51ba2011b9c0a?s=128&d=identicon&r=PG", "display_name": "Stefan Pochmann", "link": "https://stackoverflow.com/users/1672429/stefan-pochmann"}, "edited": false, "score": 0, "creation_date": 1517424328, "post_id": 48548126, "comment_id": 84094604, "body": "What&#39;s up with that <code>max</code> thing? Does that have anything to do with your question? How can that <i>ever</i> &quot;work&quot; and &quot;return the rigth value&quot;?"}], "answers": [{"tags": [], "owner": {"reputation": 8640, "user_id": 4055042, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/cd04c63d95d27033b53d4d83fea40c02?s=128&d=identicon&r=PG&f=1", "display_name": "SRack", "link": "https://stackoverflow.com/users/4055042/srack"}, "is_accepted": false, "score": 3, "last_activity_date": 1517424063, "last_edit_date": 1517424063, "creation_date": 1517420622, "answer_id": 48548350, "question_id": 48548126, "link": "https://stackoverflow.com/questions/48548126/multiplying-sub-arrays-itens-in-ruby/48548350#48548350", "title": "Multiplying sub-arrays itens in Ruby", "body": "<p>You're along the right lines with <code>each_slice</code>. This should do it for you:</p>\n\n<pre><code>input_array.each_slice(2).map { |x, y| [x * y] }\n=&gt; [[2], [12], [30]]\n</code></pre>\n\n<p>You don't need the <code>to_a</code> in there, though it works with a nested array if need be.</p>\n\n<p>This iterates through each sub-array (or slice) and return an array of whatever the block evaluates to for each pair. For example, here it multiplies the two elements together and wraps them in a one-item sub-array.</p>\n\n<p>Hope that helps - let me know if you have any questions!</p>\n"}, {"comments": [{"owner": {"reputation": 8640, "user_id": 4055042, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/cd04c63d95d27033b53d4d83fea40c02?s=128&d=identicon&r=PG&f=1", "display_name": "SRack", "link": "https://stackoverflow.com/users/4055042/srack"}, "edited": false, "score": 0, "creation_date": 1517422694, "post_id": 48548637, "comment_id": 84093715, "body": "Is there an advantage to using inject here @tadman? I jotted down that exact method but decided it would be simpler and more idiomatic to times the values as in my answer."}, {"owner": {"reputation": 5130, "user_id": 1443478, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/4J9cr.jpg?s=128&g=1", "display_name": "Brennan", "link": "https://stackoverflow.com/users/1443478/brennan"}, "edited": false, "score": 2, "creation_date": 1517425121, "post_id": 48548637, "comment_id": 84095026, "body": "When you get used to reducing an array using <code>inject</code> like that, it just becomes second nature. In this particular case, where you&#39;re dealing with slices of 2, I think the <code>[x * y]</code> is actually cleaner"}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "reply_to_user": {"reputation": 5130, "user_id": 1443478, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/4J9cr.jpg?s=128&g=1", "display_name": "Brennan", "link": "https://stackoverflow.com/users/1443478/brennan"}, "edited": false, "score": 2, "creation_date": 1517429081, "post_id": 48548637, "comment_id": 84097088, "body": "@Brennan I like using <code>inject</code> or <code>reduce</code> even in trivial cases because it automatically scales. If you change that <code>2</code> to a <code>3</code> it works, no other modifications necessary."}, {"owner": {"reputation": 8640, "user_id": 4055042, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/cd04c63d95d27033b53d4d83fea40c02?s=128&d=identicon&r=PG&f=1", "display_name": "SRack", "link": "https://stackoverflow.com/users/4055042/srack"}, "edited": false, "score": 2, "creation_date": 1517431972, "post_id": 48548637, "comment_id": 84098563, "body": "That&#39;s the answer I was looking for. Cheers @tadman, makes perfect sense. I guess it&#39;s a little bit of accessibility vs flexibility."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "reply_to_user": {"reputation": 8640, "user_id": 4055042, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/cd04c63d95d27033b53d4d83fea40c02?s=128&d=identicon&r=PG&f=1", "display_name": "SRack", "link": "https://stackoverflow.com/users/4055042/srack"}, "edited": false, "score": 2, "creation_date": 1517432083, "post_id": 48548637, "comment_id": 84098614, "body": "@SRack I try to follow the <a href=\"https://en.wikipedia.org/wiki/Zero_one_infinity_rule\" rel=\"nofollow noreferrer\">Zero, One or Infinity Rule</a> whenever possible. This function takes \ud835\udcc3 arguments where \ud835\udcc3 \u2265 2."}, {"owner": {"reputation": 24179, "user_id": 1672429, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/0815eb7d4e9dd58022d51ba2011b9c0a?s=128&d=identicon&r=PG", "display_name": "Stefan Pochmann", "link": "https://stackoverflow.com/users/1672429/stefan-pochmann"}, "edited": false, "score": 1, "creation_date": 1517432539, "post_id": 48548637, "comment_id": 84098848, "body": "Isn&#39;t it \ud835\udcc3 \u2265 1?"}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "reply_to_user": {"reputation": 24179, "user_id": 1672429, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/0815eb7d4e9dd58022d51ba2011b9c0a?s=128&d=identicon&r=PG", "display_name": "Stefan Pochmann", "link": "https://stackoverflow.com/users/1672429/stefan-pochmann"}, "edited": false, "score": 0, "creation_date": 1517432641, "post_id": 48548637, "comment_id": 84098906, "body": "@StefanPochmann Yeah, technically, but <code>inject</code> is only necessary with more than one entry per, so, kind of a subjective call."}, {"owner": {"reputation": 5130, "user_id": 1443478, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/4J9cr.jpg?s=128&g=1", "display_name": "Brennan", "link": "https://stackoverflow.com/users/1443478/brennan"}, "edited": false, "score": 0, "creation_date": 1517432799, "post_id": 48548637, "comment_id": 84098988, "body": "Definitely agree with leaning towards inject even in trivial cases, there just are cases where you know you will be handling only 2-tuples, where explicit math may be more relevant to the system you are trying to model"}], "tags": [], "owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "is_accepted": true, "score": 2, "last_activity_date": 1517421652, "creation_date": 1517421652, "answer_id": 48548637, "question_id": 48548126, "link": "https://stackoverflow.com/questions/48548126/multiplying-sub-arrays-itens-in-ruby/48548637#48548637", "title": "Multiplying sub-arrays itens in Ruby", "body": "<p>You've almost got it, but you need to combine things the right way:</p>\n\n<pre><code>list = [1, 2, 3, 4, 5, 6]\n\nlist.each_slice(2).map { |l| [ l.inject(:*) ] }\n# =&gt; [[2], [12], [30]]\n</code></pre>\n\n<p>The <code>inject</code> operation needs to be moved inside the <code>map</code> because you're not transforming just one of the items, but each of them in turn.</p>\n"}], "owner": {"reputation": 13, "user_id": 8871057, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-sQ0UDzcNdpc/AAAAAAAAAAI/AAAAAAAAC5w/lbiTf8bGV58/photo.jpg?sz=128", "display_name": "Leonardo Marzochi", "link": "https://stackoverflow.com/users/8871057/leonardo-marzochi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 65, "favorite_count": 0, "accepted_answer_id": 48548637, "answer_count": 2, "score": 0, "last_activity_date": 1517424063, "creation_date": 1517419835, "last_edit_date": 1517420368, "question_id": 48548126, "link": "https://stackoverflow.com/questions/48548126/multiplying-sub-arrays-itens-in-ruby", "title": "Multiplying sub-arrays itens in Ruby", "body": "<p>Ok, i want multiply the numbers inside a sub-array that i've created using: <code>each_slice(2)</code></p>\n\n<p>so far i got: </p>\n\n<pre><code>inputArray = [1, 2, 3, 4, 5, 6]\ninputArray.each_slice(2).to_a  #[[1, 2], [3, 4], [5, 6]]\n</code></pre>\n\n<p>whats i've already tried:</p>\n\n<pre><code>if inputArray.length % 2 == 0\n   newArr = inputArray.each_slice(2).to_a\n   newArr = newArr.max #using .max works, but it doesn't always return the rigth value\n   newArr.inject(:*)\n</code></pre>\n\n<p>i'm trying to achieve this result:</p>\n\n<pre><code>#[[2],[12],[30]]\n</code></pre>\n\n<p>As a novice to Ruby and programming in general i'm out of ideas</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "activerecord"], "answers": [{"comments": [{"owner": {"reputation": 8640, "user_id": 4055042, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/cd04c63d95d27033b53d4d83fea40c02?s=128&d=identicon&r=PG&f=1", "display_name": "SRack", "link": "https://stackoverflow.com/users/4055042/srack"}, "edited": false, "score": 0, "creation_date": 1517421309, "post_id": 48548520, "comment_id": 84092892, "body": "Actually, I&#39;m not sure that&#39;s what you&#39;re looking for?? If not, let me know and I&#39;ll delete this."}, {"owner": {"reputation": 8640, "user_id": 4055042, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/cd04c63d95d27033b53d4d83fea40c02?s=128&d=identicon&r=PG&f=1", "display_name": "SRack", "link": "https://stackoverflow.com/users/4055042/srack"}, "reply_to_user": {"reputation": 335, "user_id": 8715466, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1ae07922720a29c1476851c03e9db944?s=128&d=identicon&r=PG&f=1", "display_name": "Mr. bug", "link": "https://stackoverflow.com/users/8715466/mr-bug"}, "edited": false, "score": 0, "creation_date": 1517421443, "post_id": 48548520, "comment_id": 84092981, "body": "That&#39;s straight from ActiveModel :) You&#39;ll be able to grab it in Rails - works with <code>has_secure_password</code>, which I&#39;ll add to my answer :)"}, {"owner": {"reputation": 8640, "user_id": 4055042, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/cd04c63d95d27033b53d4d83fea40c02?s=128&d=identicon&r=PG&f=1", "display_name": "SRack", "link": "https://stackoverflow.com/users/4055042/srack"}, "reply_to_user": {"reputation": 335, "user_id": 8715466, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1ae07922720a29c1476851c03e9db944?s=128&d=identicon&r=PG&f=1", "display_name": "Mr. bug", "link": "https://stackoverflow.com/users/8715466/mr-bug"}, "edited": false, "score": 0, "creation_date": 1517422430, "post_id": 48548520, "comment_id": 84093580, "body": "Welcome - happy to help!"}], "tags": [], "owner": {"reputation": 8640, "user_id": 4055042, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/cd04c63d95d27033b53d4d83fea40c02?s=128&d=identicon&r=PG&f=1", "display_name": "SRack", "link": "https://stackoverflow.com/users/4055042/srack"}, "is_accepted": true, "score": 2, "last_activity_date": 1517421554, "last_edit_date": 1517421554, "creation_date": 1517421253, "answer_id": 48548520, "question_id": 48548092, "link": "https://stackoverflow.com/questions/48548092/overwrite-attribute-value-on-where-rails-5-1/48548520#48548520", "title": "Overwrite attribute value on where - Rails 5.1", "body": "<p>There's an <a href=\"https://apidock.com/rails/ActiveModel/SecurePassword/InstanceMethodsOnActivation/authenticate\" rel=\"nofollow noreferrer\">authenticate</a> method available for this. This works with <a href=\"http://api.rubyonrails.org/classes/ActiveModel/SecurePassword/ClassMethods.html#method-i-has_secure_password\" rel=\"nofollow noreferrer\">has_secure_password</a>.</p>\n\n<p><code>authenticate</code> is used as follows:</p>\n\n<pre><code>user = User.new(password: 'hash-of-the-password')\nuser.save\nuser.authenticate('not-the-password')      # =&gt; false\nuser.authenticate('password') # =&gt; user\n</code></pre>\n\n<p><code>has_secure_password</code> requires a column called <code>password_digest</code> (though you might be able to override this), which is filled with a hash after someone signs up with a password / password confirmation.</p>\n\n<p>Hope that helps - let me know if you need anything more or have any questions.</p>\n"}], "owner": {"reputation": 335, "user_id": 8715466, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1ae07922720a29c1476851c03e9db944?s=128&d=identicon&r=PG&f=1", "display_name": "Mr. bug", "link": "https://stackoverflow.com/users/8715466/mr-bug"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 29, "favorite_count": 0, "accepted_answer_id": 48548520, "answer_count": 1, "score": 0, "last_activity_date": 1517422362, "creation_date": 1517419757, "last_edit_date": 1517422362, "question_id": 48548092, "link": "https://stackoverflow.com/questions/48548092/overwrite-attribute-value-on-where-rails-5-1", "title": "Overwrite attribute value on where - Rails 5.1", "body": "<p>Hello I need to do like Devise in my own implementation and query <code>User.where(:password =&gt; 'password')</code> but password is encrypted and salted. What would be the \"rail\" way of overwriting this behaivour? I tried with an attr_writter</p>\n\n<pre><code>def password=(pass)\n   super(hashpassword(pass))\nend\n</code></pre>\n\n<p>But no success, I still see <code>SELECT  'users'.* FROM 'users' WHERE 'users'.'password' = 'non-salted-password' LIMIT 11</code></p>\n\n<p>Any suggestion? thank you.</p>\n\n<p><strong>Important</strong></p>\n\n<p>I'm not using devise.</p>\n\n<p><strong>About the solution</strong></p>\n\n<p>The approved solution was to use the native \"authenticate\" method, I had to change my password field in the database to password_digest and it worked.</p>\n"}, {"tags": ["ruby", "regex", "testing", "web-scraping", "nokogiri"], "comments": [{"owner": {"reputation": 19159, "user_id": 3600709, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/731c8c4c0029d3414563333de16b8977?s=128&d=identicon&r=PG&f=1", "display_name": "ctwheels", "link": "https://stackoverflow.com/users/3600709/ctwheels"}, "edited": false, "score": 2, "creation_date": 1517418071, "post_id": 48547538, "comment_id": 84090955, "body": "Try <code>\\([LW]\\)\\d+mm</code>"}, {"owner": {"reputation": 19159, "user_id": 3600709, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/731c8c4c0029d3414563333de16b8977?s=128&d=identicon&r=PG&f=1", "display_name": "ctwheels", "link": "https://stackoverflow.com/users/3600709/ctwheels"}, "reply_to_user": {"reputation": 3034, "user_id": 6101071, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9b1da77c00202a8477bee1a68950824f?s=128&d=identicon&r=PG&f=1", "display_name": "Srdjan M.", "link": "https://stackoverflow.com/users/6101071/srdjan-m"}, "edited": false, "score": 3, "creation_date": 1517418314, "post_id": 48547538, "comment_id": 84091135, "body": "@S.Kablar there&#39;s no capture group."}, {"owner": {"reputation": 52685, "user_id": 980550, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/8emhY.jpg?s=128&g=1", "display_name": "lurker", "link": "https://stackoverflow.com/users/980550/lurker"}, "edited": false, "score": 2, "creation_date": 1517418917, "post_id": 48547538, "comment_id": 84091496, "body": "If you want to capture decimal numbers as well, then: <code>&#47;\\([LW]\\)\\d+(\\.\\d+)?mm&#47;</code>, That matches one of <code>(L)</code> or <code>(W)</code>, followed by one or more digits, followed optionally by a decimal point and one or more digits, followed by <code>mm</code>."}, {"owner": {"reputation": 8640, "user_id": 4055042, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/cd04c63d95d27033b53d4d83fea40c02?s=128&d=identicon&r=PG&f=1", "display_name": "SRack", "link": "https://stackoverflow.com/users/4055042/srack"}, "edited": false, "score": 0, "creation_date": 1517419021, "post_id": 48547538, "comment_id": 84091569, "body": "Looks good - just here to add I always find <a href=\"https://regex101.com/\" rel=\"nofollow noreferrer\">Regex101</a> really handy for anything like this."}], "answers": [{"comments": [{"owner": {"reputation": 68, "user_id": 4496385, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/b519085d87ce0df5fdc72c6e493de288?s=128&d=identicon&r=PG&f=1", "display_name": "Joseph Kouroma", "link": "https://stackoverflow.com/users/4496385/joseph-kouroma"}, "edited": false, "score": 0, "creation_date": 1517435769, "post_id": 48548848, "comment_id": 84100467, "body": "Works exactly as I want within regex101.com doesn&#39;t however work with my ruby code."}, {"owner": {"user_type": "does_not_exist", "display_name": "user557597"}, "reply_to_user": {"reputation": 68, "user_id": 4496385, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/b519085d87ce0df5fdc72c6e493de288?s=128&d=identicon&r=PG&f=1", "display_name": "Joseph Kouroma", "link": "https://stackoverflow.com/users/4496385/joseph-kouroma"}, "edited": false, "score": 0, "creation_date": 1517437058, "post_id": 48548848, "comment_id": 84101061, "body": "Ok, even though Ruby supports conditionals, it is an outlier in that when it parses a regex it won&#39;t let an undefined group be referenced before it&#39;s parsed. So something like <code>(?(1)(?!))(group 1)</code> doesn&#39;t work because it is referenced in the conditional before it&#39;s actually parsed (defined). It&#39;s an outlier because almost every other engine supports this. Without this ability, you can&#39;t match out-of-order stuff like this. You have to match one or the other at a time. Sorry.."}, {"owner": {"user_type": "does_not_exist", "display_name": "user557597"}, "reply_to_user": {"reputation": 68, "user_id": 4496385, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/b519085d87ce0df5fdc72c6e493de288?s=128&d=identicon&r=PG&f=1", "display_name": "Joseph Kouroma", "link": "https://stackoverflow.com/users/4496385/joseph-kouroma"}, "edited": false, "score": 1, "creation_date": 1517437365, "post_id": 48548848, "comment_id": 84101208, "body": "@JosephKouroma - Oh, wait. There is a way to fool it. Hang on .. <a href=\"http://rubular.com/r/SMw5bxHVYv\" rel=\"nofollow noreferrer\">rubular.com/r/SMw5bxHVYv</a>"}, {"owner": {"reputation": 68, "user_id": 4496385, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/b519085d87ce0df5fdc72c6e493de288?s=128&d=identicon&r=PG&f=1", "display_name": "Joseph Kouroma", "link": "https://stackoverflow.com/users/4496385/joseph-kouroma"}, "edited": false, "score": 0, "creation_date": 1517671095, "post_id": 48548848, "comment_id": 84194195, "body": "Thank you thats perfect. Im putting the details into a database, how about a regexp which puts only the numbers so in this case 9, 333, 333. {Cirque Black Stone Effect Ceramic Floor Tile, Pack of 9, (L)333mm (W)333mm}"}, {"owner": {"user_type": "does_not_exist", "display_name": "user557597"}, "reply_to_user": {"reputation": 68, "user_id": 4496385, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/b519085d87ce0df5fdc72c6e493de288?s=128&d=identicon&r=PG&f=1", "display_name": "Joseph Kouroma", "link": "https://stackoverflow.com/users/4496385/joseph-kouroma"}, "edited": false, "score": 1, "creation_date": 1517857651, "post_id": 48548848, "comment_id": 84256363, "body": "@JosephKouroma - Yeah, just prepend <code>(?i)Pack\\s*of\\s*(?&lt;PackOf&gt;\\d*)\\s*,</code> to the regex above."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user557597"}, "is_accepted": false, "score": 1, "last_activity_date": 1517438203, "last_edit_date": 1517438203, "creation_date": 1517422429, "answer_id": 48548848, "question_id": 48547538, "link": "https://stackoverflow.com/questions/48547538/ruby-regular-expression-match-dimensions/48548848#48548848", "title": "Ruby Regular Expression match dimensions", "body": "<p>Here is an out of order, len/width regex to get both in one pass.<br>\nDepends on conditionals, so this is if Ruby supports them.  </p>\n\n<p>The values are in the respective named groups.  </p>\n\n<p><strong>Edit</strong>\nFor Ruby, out-of-order can be done like this.\nNote that most engines let you reference a group before it is parsed.<br>\nWith Ruby, you have to at least be inside at the start of the group<br>\nto be able to reference it's (current) contents.   </p>\n\n<p><code>(?:\\s*(?:\\(W\\)(?&lt;width&gt;(?(&lt;width&gt;)(?!))[\\d.]+)(?&lt;width_unit&gt;[cm]?m|in|ft)|\\(L\\)(?&lt;len&gt;(?(&lt;len&gt;)(?!))[\\d.]+)(?&lt;len_unit&gt;[cm]?m|in|ft))){1,2}</code></p>\n\n<p><a href=\"http://rubular.com/r/SMw5bxHVYv\" rel=\"nofollow noreferrer\">http://rubular.com/r/SMw5bxHVYv</a></p>\n\n<p>Formatted  </p>\n\n<pre><code> (?:\n      \\s* \n      (?:\n           \\(W\\)\n           (?&lt;width&gt;                     # (1 start), Width\n                (?(&lt;width&gt;)                   # Conditional, cannot match width again\n                     (?!)\n                )\n                [\\d.]+ \n           )                             # (1 end)\n           (?&lt;width_unit&gt; [cm]? m | in | ft )  # (2)\n        |  \\(L\\)\n           (?&lt;len&gt;                       # (3 start), Len\n                (?(&lt;len&gt;)                     # Conditional, cannot match length again\n                     (?!)\n                )\n                [\\d.]+ \n           )                             # (3 end)\n           (?&lt;len_unit&gt; [cm]? m | in | ft )  # (4)\n      )\n ){1,2}    # Must match one or two\n</code></pre>\n\n<hr>\n\n<p>For other engines, you can put the conditional before the group definition.<br>\n(or at the start of the  group, as above)  </p>\n\n<p><code>(?:\\s*(?:(?(&lt;width&gt;)(?!))\\(W\\)(?&lt;width&gt;[\\d.]+)(?&lt;width_unit&gt;[cm]?m|in|ft)|(?(&lt;len&gt;)(?!))\\(L\\)(?&lt;len&gt;[\\d.]+)(?&lt;len_unit&gt;[cm]?m|in|ft))){1,2}</code></p>\n\n<p><a href=\"https://regex101.com/r/VyCqjt/2\" rel=\"nofollow noreferrer\">https://regex101.com/r/VyCqjt/2</a></p>\n\n<p>Formatted  </p>\n\n<pre><code> (?:\n      \\s* \n      (?:\n           (?(&lt;width&gt;) (?!) )     # Conditional, cannot match width again\n           \\(W\\)\n           (?&lt;width&gt; [\\d.]+ )                  # (1)\n           (?&lt;width_unit&gt; [cm]? m | in | ft )  # (2)\n        |\n           (?(&lt;len&gt;) (?!) )        # Conditional, cannot match length again\n           \\(L\\)\n           (?&lt;len&gt; [\\d.]+ )                 # (3)\n           (?&lt;len_unit&gt; [cm]? m | in | ft ) # (4)\n      )\n ){1,2}     # Must match one or two\n</code></pre>\n"}], "owner": {"reputation": 68, "user_id": 4496385, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/b519085d87ce0df5fdc72c6e493de288?s=128&d=identicon&r=PG&f=1", "display_name": "Joseph Kouroma", "link": "https://stackoverflow.com/users/4496385/joseph-kouroma"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 102, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1517438203, "creation_date": 1517417981, "last_edit_date": 1517418072, "question_id": 48547538, "link": "https://stackoverflow.com/questions/48547538/ruby-regular-expression-match-dimensions", "title": "Ruby Regular Expression match dimensions", "body": "<p>Cirque Black Stone Effect Ceramic Floor Tile, Pack of 9, (L)333mm (W)333mm</p>\n\n<p>I've created a block which iterates through a set of results i need to match the length (L)333mm and the width (W)333mm so I can add them to a database.</p>\n\n<p>I've tried a few regular expressions but non of them are working now it feels like i'm just guessing. </p>\n\n<p><code>product_description = product.at_css('h3 a').text[/\\L[0-9\\.]+mm/]</code></p>\n\n<p>gives <code>nil</code>, can you please point me in the right direction</p>\n"}, {"tags": ["ruby-on-rails", "json", "ruby"], "comments": [{"owner": {"reputation": 8640, "user_id": 4055042, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/cd04c63d95d27033b53d4d83fea40c02?s=128&d=identicon&r=PG&f=1", "display_name": "SRack", "link": "https://stackoverflow.com/users/4055042/srack"}, "edited": false, "score": 2, "creation_date": 1517418158, "post_id": 48547483, "comment_id": 84091012, "body": "It definitely sends like that? I thought that that escaping was just when displaying the stringified JSON in the console, though if you <code>puts</code> the same code you have above it looks as you want it (i.e. it doesn&#39;t <i>actually</i> contain the backslashes when it matters)."}], "answers": [{"tags": [], "owner": {"reputation": 394, "user_id": 9289181, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kEJV4.jpg?s=128&g=1", "display_name": "fl9", "link": "https://stackoverflow.com/users/9289181/fl9"}, "is_accepted": true, "score": 3, "last_activity_date": 1517418020, "creation_date": 1517418020, "answer_id": 48547557, "question_id": 48547483, "link": "https://stackoverflow.com/questions/48547483/rails-escaping-json/48547557#48547557", "title": "Rails Escaping JSON", "body": "<p>You could use <code>JSON.parse</code>, i.e.,</p>\n\n<pre><code>JSON.parse(\"{\\\"api_key\\\":\\\"9e4b33422adb-3832c7-41379-b2f31-8fc295aefb8c8\\\",\\\"ip\\\":\\\"184.61.23.239\\\"}\") \n</code></pre>\n\n<p>returns</p>\n\n<pre><code>{\"api_key\" =&gt; \"9e4b33422adb-3832c7-41379-b2f31-8fc295aefb8c8\",\"ip\" =&gt; \"184.61.23.239\"}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 4750, "user_id": 2650407, "user_type": "registered", "accept_rate": 91, "profile_image": "https://graph.facebook.com/1172460015/picture?type=large", "display_name": "Tom Hammond", "link": "https://stackoverflow.com/users/2650407/tom-hammond"}, "edited": false, "score": 0, "creation_date": 1517673884, "post_id": 48559978, "comment_id": 84195037, "body": "Any idea what the performance improvement for this actually is?"}, {"owner": {"reputation": 1226, "user_id": 4631412, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c260d08bdafaebb6293a7bd2efc9dc35?s=128&d=identicon&r=PG", "display_name": "ThienSuBS", "link": "https://stackoverflow.com/users/4631412/thiensubs"}, "reply_to_user": {"reputation": 4750, "user_id": 2650407, "user_type": "registered", "accept_rate": 91, "profile_image": "https://graph.facebook.com/1172460015/picture?type=large", "display_name": "Tom Hammond", "link": "https://stackoverflow.com/users/2650407/tom-hammond"}, "edited": false, "score": 0, "creation_date": 1517704396, "post_id": 48559978, "comment_id": 84203736, "body": "@TomHammond Please visit <a href=\"https://github.com/ohler55/oj\" rel=\"nofollow noreferrer\">github.com/ohler55/oj</a> and read about Performance Comparisons. Thanks."}], "tags": [], "owner": {"reputation": 1226, "user_id": 4631412, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c260d08bdafaebb6293a7bd2efc9dc35?s=128&d=identicon&r=PG", "display_name": "ThienSuBS", "link": "https://stackoverflow.com/users/4631412/thiensubs"}, "is_accepted": false, "score": 0, "last_activity_date": 1517479354, "creation_date": 1517479354, "answer_id": 48559978, "question_id": 48547483, "link": "https://stackoverflow.com/questions/48547483/rails-escaping-json/48559978#48559978", "title": "Rails Escaping JSON", "body": "<p>Another solution is using gem 'oj'. I prefer to use this gem, because it so fast and good performance.</p>\n\n<p>Using with oj like this:</p>\n\n<pre><code>j = Oj.load(\"{\\\"api_key\\\":\\\"9e4b33422adb-3832c7-41379-b2f31-8fc295aefb8c8\\\",\\\"ip\\\":\\\"184.61.23.239\\\"}\")\n</code></pre>\n\n<p>It will be:</p>\n\n<pre><code>=&gt; {\"api_key\"=&gt;\"9e4b33422adb-3832c7-41379-b2f31-8fc295aefb8c8\", \"ip\"=&gt;\"184.61.23.239\"}\n</code></pre>\n"}], "owner": {"reputation": 4750, "user_id": 2650407, "user_type": "registered", "accept_rate": 91, "profile_image": "https://graph.facebook.com/1172460015/picture?type=large", "display_name": "Tom Hammond", "link": "https://stackoverflow.com/users/2650407/tom-hammond"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 88, "favorite_count": 0, "accepted_answer_id": 48547557, "answer_count": 2, "score": 3, "last_activity_date": 1517479354, "creation_date": 1517417785, "last_edit_date": 1517479102, "question_id": 48547483, "link": "https://stackoverflow.com/questions/48547483/rails-escaping-json", "title": "Rails Escaping JSON", "body": "<p>I'm working on an external API.</p>\n\n<p>They want JSON as a string for a GET request in a query param.</p>\n\n<p>The problem with Ruby is that it treats JSON as a string and escapes quotes, so we end up sending:</p>\n\n<p><code>\"{\\\"api_key\\\":\\\"9e4b33422adb-3832c7-41379-b2f31-8fc295aefb8c8\\\",\\\"ip\\\":\\\"184.61.23.239\\\"}</code></p>\n\n<p>Instead of <code>{\"api_key\":\"9e4b33422adb-3832c7-41379-b2f31-8fc295aefb8c8\",\"ip\":\"184.61.23.239\"}</code> as their system is expecting.</p>\n\n<p>Any idea the best way to handle formatting our JSON to match their criteria?</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 2007, "user_id": 716039, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/76b302eed6a8add5db6b3f2e1c7c9942?s=128&d=identicon&r=PG", "display_name": "dinjas", "link": "https://stackoverflow.com/users/716039/dinjas"}, "edited": false, "score": 0, "creation_date": 1517417723, "post_id": 48547315, "comment_id": 84090672, "body": "<code>{&quot;Team 1&quot;=&gt;0, &quot;Team 2&quot;=&gt;0, &quot;Team 3&quot;=&gt;0, &quot;Team 4&quot;=&gt;0}</code> isn&#39;t an <code>Array</code>, it&#39;s a <code>Hash</code>. <code>doc.values</code> should return an array with one element in it, where the one element is that hash. You could get the keys of it using <code>doc.values.first.keys</code>."}, {"owner": {"reputation": 9030, "user_id": 5101476, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JCQrl.jpg?s=128&g=1", "display_name": "ice\u30c4", "link": "https://stackoverflow.com/users/5101476/ice%e3%83%84"}, "edited": false, "score": 0, "creation_date": 1517418008, "post_id": 48547315, "comment_id": 84090906, "body": "What is <code>doc</code>??"}], "answers": [{"comments": [{"owner": {"reputation": 2571, "user_id": 6822876, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/i6dGp.jpg?s=128&g=1", "display_name": "Carrein", "link": "https://stackoverflow.com/users/6822876/carrein"}, "edited": false, "score": 0, "creation_date": 1517417861, "post_id": 48547378, "comment_id": 84090799, "body": "Slipped my mind I could have accessed the document keys directly! Great answer."}, {"owner": {"reputation": 8640, "user_id": 4055042, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/cd04c63d95d27033b53d4d83fea40c02?s=128&d=identicon&r=PG&f=1", "display_name": "SRack", "link": "https://stackoverflow.com/users/4055042/srack"}, "reply_to_user": {"reputation": 2571, "user_id": 6822876, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/i6dGp.jpg?s=128&g=1", "display_name": "Carrein", "link": "https://stackoverflow.com/users/6822876/carrein"}, "edited": false, "score": 0, "creation_date": 1517417891, "post_id": 48547378, "comment_id": 84090821, "body": "Thanks, happy to help :)"}, {"owner": {"reputation": 24179, "user_id": 1672429, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/0815eb7d4e9dd58022d51ba2011b9c0a?s=128&d=identicon&r=PG", "display_name": "Stefan Pochmann", "link": "https://stackoverflow.com/users/1672429/stefan-pochmann"}, "edited": false, "score": 1, "creation_date": 1517430231, "post_id": 48547378, "comment_id": 84097699, "body": "The last one is strange, <code>puts doc.values.first.keys</code> seems strictly better. And a somewhat funny one: <code>puts doc.first.last.key</code>"}], "tags": [], "owner": {"reputation": 8640, "user_id": 4055042, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/cd04c63d95d27033b53d4d83fea40c02?s=128&d=identicon&r=PG&f=1", "display_name": "SRack", "link": "https://stackoverflow.com/users/4055042/srack"}, "is_accepted": true, "score": 4, "last_activity_date": 1517417523, "creation_date": 1517417523, "answer_id": 48547378, "question_id": 48547315, "link": "https://stackoverflow.com/questions/48547315/printing-all-key-values-in-a-nested-hash-in-ruby/48547378#48547378", "title": "Printing all key values in a nested hash in Ruby?", "body": "<p>This should do it:</p>\n\n<pre><code>puts doc[\"house\"].keys\n</code></pre>\n\n<p>If you don't necessarily know what the first key will be, this also works:</p>\n\n<pre><code>puts doc.values.flat_map(&amp;:keys)\n</code></pre>\n\n<p>Just for fun, here's a third approach, if you know there'll always be just the one outer key:</p>\n\n<pre><code>puts doc[doc.keys.first].keys\n</code></pre>\n\n<p>That what you're after? Hope it helps - let me know if you've any questions!</p>\n"}], "owner": {"reputation": 2571, "user_id": 6822876, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/i6dGp.jpg?s=128&g=1", "display_name": "Carrein", "link": "https://stackoverflow.com/users/6822876/carrein"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 802, "favorite_count": 0, "accepted_answer_id": 48547378, "answer_count": 1, "score": 0, "last_activity_date": 1517418253, "creation_date": 1517417370, "last_edit_date": 1517418253, "question_id": 48547315, "link": "https://stackoverflow.com/questions/48547315/printing-all-key-values-in-a-nested-hash-in-ruby", "title": "Printing all key values in a nested hash in Ruby?", "body": "<p>I have the following hash:</p>\n\n<pre><code>doc = {\"house\"=&gt;{\"Team 1\"=&gt;0, \"Team 2\"=&gt;0, \"Team 3\"=&gt;0, \"Team 4\"=&gt;0}}\n</code></pre>\n\n<p>I am trying to print the \"Team\" keys.</p>\n\n<p>For example:</p>\n\n<pre><code>Team 1\nTeam 2\nTeam 3\nTeam 4\n</code></pre>\n\n<p>I tried using <code>doc.values</code> but this returns an array <code>[{\"Team 1\"=&gt;0, \"Team 2\"=&gt;0, \"Team 3\"=&gt;0, \"Team 4\"=&gt;0}]</code>. Which means I can't do <code>doc.values.keys</code>. </p>\n\n<p>I tried using a for loop, but somehow it prints the value this way instead:</p>\n\n<pre><code>Team 1\n0\nTeam 2\n0\n..\n</code></pre>\n\n<p>Is there a way to to get these keys?</p>\n"}, {"tags": ["mysql", "ruby-on-rails", "ruby", "database", "postgresql"], "comments": [{"owner": {"reputation": 7975, "user_id": 1577357, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/9db0054df76cc4b80888ff713527a652?s=128&d=identicon&r=PG", "display_name": "Zulhilmi Zainudin", "link": "https://stackoverflow.com/users/1577357/zulhilmi-zainudin"}, "edited": false, "score": 0, "creation_date": 1517417441, "post_id": 48547148, "comment_id": 84090450, "body": "This might be helpful for you: <a href=\"https://teamtreehouse.com/community/how-do-i-install-the-mysql-gem-and-how-do-i-set-it-as-the-default-database-for-rails\" rel=\"nofollow noreferrer\">teamtreehouse.com/community/&hellip;</a>  On other hand, you missed <code>rake db:migrate</code> command. The <code>rake db:create</code> command is not enough."}, {"owner": {"reputation": 91121, "user_id": 179125, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5594142dcc49a24b1902ec8059181f8d?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan Running", "link": "https://stackoverflow.com/users/179125/jordan-running"}, "edited": false, "score": 0, "creation_date": 1517417504, "post_id": 48547148, "comment_id": 84090504, "body": "No, it&#39;s not normal for a MySQL-backed app to have <code>adapter: postgres</code> in its <code>database.yml</code>. At any rate, if you&#39;re copying the whole database, you don&#39;t want to run any <code>rake db:</code> commands; you just want to import the whole SQL dump, which should create all of the tables."}, {"owner": {"reputation": 71, "user_id": 9295598, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WF7Jq.png?s=128&g=1", "display_name": "CodeHat", "link": "https://stackoverflow.com/users/9295598/codehat"}, "reply_to_user": {"reputation": 91121, "user_id": 179125, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5594142dcc49a24b1902ec8059181f8d?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan Running", "link": "https://stackoverflow.com/users/179125/jordan-running"}, "edited": false, "score": 0, "creation_date": 1517436160, "post_id": 48547148, "comment_id": 84100659, "body": "@JordanRunning How would i go about importing the whole SQL dump?"}, {"owner": {"reputation": 91121, "user_id": 179125, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5594142dcc49a24b1902ec8059181f8d?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan Running", "link": "https://stackoverflow.com/users/179125/jordan-running"}, "edited": false, "score": 0, "creation_date": 1517436888, "post_id": 48547148, "comment_id": 84100974, "body": "@CodeHat That&#39;s answered in the MySQL docs as well as several Stack Overflow questions. P.S. I misspoke earlier. You probably want to do <code>rake db:create</code>, but you don&#39;t want to do any <i>other</i> <code>rake db:</code> commands. Importing the dump from the other database should recreate the same structure that your migrations would."}], "answers": [{"comments": [{"owner": {"reputation": 71, "user_id": 9295598, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WF7Jq.png?s=128&g=1", "display_name": "CodeHat", "link": "https://stackoverflow.com/users/9295598/codehat"}, "edited": false, "score": 0, "creation_date": 1517436403, "post_id": 48548431, "comment_id": 84100769, "body": "Thanks for this info but when I solely just do this I get an error that database doesn&#39;t exist."}, {"owner": {"reputation": 535, "user_id": 5240585, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5CqxC.png?s=128&g=1", "display_name": "basiszwo", "link": "https://stackoverflow.com/users/5240585/basiszwo"}, "reply_to_user": {"reputation": 71, "user_id": 9295598, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WF7Jq.png?s=128&g=1", "display_name": "CodeHat", "link": "https://stackoverflow.com/users/9295598/codehat"}, "edited": false, "score": 0, "creation_date": 1517440699, "post_id": 48548431, "comment_id": 84102525, "body": "When switching the adapter you need to run rails db:create and rails db:migrate to get things up and running"}, {"owner": {"reputation": 71, "user_id": 9295598, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WF7Jq.png?s=128&g=1", "display_name": "CodeHat", "link": "https://stackoverflow.com/users/9295598/codehat"}, "edited": false, "score": 0, "creation_date": 1517442019, "post_id": 48548431, "comment_id": 84102915, "body": "when doing <code>rake db:migrate</code> I get the following error:  Mackbook-UserName$ bin/rails db:migrate == 20150413001904 AddMetaDataToProducts: migrating ============================ -- add_column(:products, :meta_tags, :text, {:array=&gt;true, :default=&gt;[]}) rails aborted! StandardError: An error has occurred, all later migrations canceled:"}], "tags": [], "owner": {"reputation": 535, "user_id": 5240585, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5CqxC.png?s=128&g=1", "display_name": "basiszwo", "link": "https://stackoverflow.com/users/5240585/basiszwo"}, "is_accepted": false, "score": 0, "last_activity_date": 1517420905, "creation_date": 1517420905, "answer_id": 48548431, "question_id": 48547148, "link": "https://stackoverflow.com/questions/48547148/how-can-i-import-ruby-on-rails-application-to-another-computer/48548431#48548431", "title": "How can i Import ruby on rails application to another computer", "body": "<p>To me this sounds like you got a MySQL dump and the application is configured to use postgres. I am wonderning why this is but you can try using the mysql adapter in your <code>config/database.yml</code> file by setting something like </p>\n\n<pre><code>default: &amp;default\n  adapter: mysql2\n  encoding: utf8\n  pool: &lt;%= ENV.fetch(\"RAILS_MAX_THREADS\") { 5 } %&gt;\n  username: root\n  password:\n  host: localhost\n\ndevelopment:\n  &lt;&lt;: *default\n  database: foobar_development\n</code></pre>\n\n<p>The interesting bit is <code>adapter: mysql2</code>.</p>\n\n<p>I have taken this from a brand new rails application. You need mysql running for sure.</p>\n\n<p>Hope this helps. If not you have to reach out to the other person to get some postgresql compatible dump.</p>\n"}, {"comments": [{"owner": {"reputation": 535, "user_id": 5240585, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5CqxC.png?s=128&g=1", "display_name": "basiszwo", "link": "https://stackoverflow.com/users/5240585/basiszwo"}, "edited": false, "score": 0, "creation_date": 1519501180, "post_id": 48565956, "comment_id": 84939392, "body": "fair enough. Sure you have to ensure your database is running. Sorry I didn&#39;t mention this in my answer."}], "tags": [], "owner": {"reputation": 71, "user_id": 9295598, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WF7Jq.png?s=128&g=1", "display_name": "CodeHat", "link": "https://stackoverflow.com/users/9295598/codehat"}, "is_accepted": true, "score": 0, "last_activity_date": 1517497804, "creation_date": 1517497804, "answer_id": 48565956, "question_id": 48547148, "link": "https://stackoverflow.com/questions/48547148/how-can-i-import-ruby-on-rails-application-to-another-computer/48565956#48565956", "title": "How can i Import ruby on rails application to another computer", "body": "<p>I got it to work! Thank you all for your help! Really appreciated it.\nBelow are the steps that worked for me:</p>\n\n<ol>\n<li>Copy the project to the new computer</li>\n<li>Open terminal and change directory to the project</li>\n<li>Run <code>bundle install</code> to install all the gem dependencies</li>\n<li>Run <code>bundle update</code> to update installed gems</li>\n<li>Start the Postgres server by running <code>pg_ctl -D /usr/local/var/postgres start</code></li>\n<li>Run <code>createdb databasename</code> to create the database on the new computer. The database name has to match the database mentioned in the database.yml file in the config folder.</li>\n<li>Run <code>rake db:schema:load</code> and that's it!</li>\n</ol>\n\n<p>After following the above steps I was able to run <code>rails s</code> to check out the website.</p>\n"}], "owner": {"reputation": 71, "user_id": 9295598, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WF7Jq.png?s=128&g=1", "display_name": "CodeHat", "link": "https://stackoverflow.com/users/9295598/codehat"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 874, "favorite_count": 0, "accepted_answer_id": 48565956, "answer_count": 2, "score": 0, "last_activity_date": 1517497804, "creation_date": 1517416851, "question_id": 48547148, "link": "https://stackoverflow.com/questions/48547148/how-can-i-import-ruby-on-rails-application-to-another-computer", "title": "How can i Import ruby on rails application to another computer", "body": "<p>I'm trying to import ruby on rails project to my computer but am running into all sorts of problems with the database.</p>\n\n<p><strong>Here's the situation:</strong></p>\n\n<p>I have an <em>appname.tar.gz</em> that I got from another developer. I extract it and relocated it to my user directory to work with it.</p>\n\n<ul>\n<li>Next I run <code>bundle install</code> in the directory to install gem\ndependencies. </li>\n<li>Then I run <code>rake db:create</code> to create the database and\nload the schema and structure from the DB folder in the same directory. This is where I'm running into all sorts of issues. When I launch the app I get an error saying DB migration pending.\n\n<ul>\n<li>structure.sql is a MySQL dump 10.13</li>\n<li>while the database.yml file had the adapter set to postgres: <code>adapter: postgres</code>. Is this normal?</li>\n</ul></li>\n</ul>\n\n<p>Is this the best way to import an existing app into your environment?</p>\n\n<p>Any help will be appreciated.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "xml", "excel"], "comments": [{"owner": {"reputation": 31, "user_id": 9283520, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cf38c15cb76bd9870f4c0da2411707d9?s=128&d=identicon&r=PG&f=1", "display_name": "George H", "link": "https://stackoverflow.com/users/9283520/george-h"}, "reply_to_user": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "edited": false, "score": 0, "creation_date": 1517416839, "post_id": 48546892, "comment_id": 84090051, "body": "Ruby, I have added a complete code sample."}, {"owner": {"reputation": 12557, "user_id": 1270789, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/FXwoB.png?s=128&g=1", "display_name": "Ken Y-N", "link": "https://stackoverflow.com/users/1270789/ken-y-n"}, "edited": false, "score": 0, "creation_date": 1517442835, "post_id": 48546892, "comment_id": 84103143, "body": "Can you do something like <code>xml.Land &quot;#{row[7]}&quot; unless row[7].empty?</code>?"}], "answers": [{"comments": [{"owner": {"reputation": 31, "user_id": 9283520, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cf38c15cb76bd9870f4c0da2411707d9?s=128&d=identicon&r=PG&f=1", "display_name": "George H", "link": "https://stackoverflow.com/users/9283520/george-h"}, "edited": false, "score": 0, "creation_date": 1517828450, "post_id": 48547251, "comment_id": 84238508, "body": "Hi unfortunately the above statement did not work and produced an error"}, {"owner": {"reputation": 8640, "user_id": 4055042, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/cd04c63d95d27033b53d4d83fea40c02?s=128&d=identicon&r=PG&f=1", "display_name": "SRack", "link": "https://stackoverflow.com/users/4055042/srack"}, "reply_to_user": {"reputation": 31, "user_id": 9283520, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cf38c15cb76bd9870f4c0da2411707d9?s=128&d=identicon&r=PG&f=1", "display_name": "George H", "link": "https://stackoverflow.com/users/9283520/george-h"}, "edited": false, "score": 0, "creation_date": 1517834475, "post_id": 48547251, "comment_id": 84242007, "body": "Hey @GeorgeH - what was the error? If you edit it into your question and give me a nudge, I&#39;ll take a look. Sure we can get there with this!"}], "tags": [], "owner": {"reputation": 8640, "user_id": 4055042, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/cd04c63d95d27033b53d4d83fea40c02?s=128&d=identicon&r=PG&f=1", "display_name": "SRack", "link": "https://stackoverflow.com/users/4055042/srack"}, "is_accepted": false, "score": 0, "last_activity_date": 1517417192, "creation_date": 1517417192, "answer_id": 48547251, "question_id": 48546892, "link": "https://stackoverflow.com/questions/48546892/xml-creation-pulling-a-value-if-existing-within-an-external-excel-based-templat/48547251#48547251", "title": "XML Creation, pulling a value if existing within an external excel based template", "body": "<p>It looks like you still have access to Ruby methods within the blocks, so could you not use something like:</p>\n\n<pre><code>xml.Land(row[7]) if row[7].present?\n</code></pre>\n\n<p>Might not work in the Nokigiri block - let me know if not and I'll remove the answer.</p>\n\n<p>(Also, do you need to interpolate all of the results? I've removed it from this example, though obviously feel free to pop it back in if needed.)</p>\n"}], "owner": {"reputation": 31, "user_id": 9283520, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cf38c15cb76bd9870f4c0da2411707d9?s=128&d=identicon&r=PG&f=1", "display_name": "George H", "link": "https://stackoverflow.com/users/9283520/george-h"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 30, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1517443688, "creation_date": 1517416027, "last_edit_date": 1517443688, "question_id": 48546892, "link": "https://stackoverflow.com/questions/48546892/xml-creation-pulling-a-value-if-existing-within-an-external-excel-based-templat", "title": "XML Creation, pulling a value if existing within an external excel based template", "body": "<p>I have tried this in ruby and here is my code: </p>\n\n<pre><code> require 'roo'\n require 'roo-xls'\n require 'byebug'\n\n file_name = ARGV.first || \"test_Abnahme_Meld.xls\"\n\n excel_file = Roo::Spreadsheet.open(\"./#{file_name}\", extension: :xls)\n\n xml = Nokogiri::XML::Builder.new(encoding: 'UTF-8') do |xml|\n xml.test(\"version\": \"2.0\",\"xmlns\": \n \"https://www.test.uk/siml/2.0/final\") do\n xml.Data(\"language\": \"GBR\") do\n\n  excel_file.each_with_index do |row, index|\n    next if index == 0\n\n    xml.Aktion(\"teilnehmerkennung\": \"60000592\", \"teilnehmerkennwort\": \n  \"MIGIND05\") do\n      xml.Teilnehmerreferenz \"ref#{row[1].to_i}GRB2\"\n      xml.MeldungVertragsdaten(\"version\":\"1.0\") do\n        xml.Meldemerkmal(\"merkmalcode\":\"K4\") do\n          xml.Kontonummer \"#{row[11].round}\"\n          xml.Datum \"#{row[12]}\"\n          xml.Betrag(\"waehrung\": 'EUR') { |e| e &lt;&lt; \"#{row[13].round}\" }\n          xml.Ratenzahl \"#{row[14].round}\"\n          xml.Ratenart \"#{row[15]}\"\n        end\n          xml.Meldeart (\"neumeldung\") do\n          end\n          xml.Verbraucherdaten do\n            xml.Vorname \"#{row[3]}\"\n            xml.Nachname \"#{row[2]}\"\n            xml.Geschlecht \"#{row[4]}\"\n            xml.Geburtsdatum \"#{row[6]}\"\n            xml.Land \"#{row[7]}\"\n            xml.AktuelleAdresse do\n              xml.Strasse \"#{row[10]}\"\n              xml.PLZ \"#{row[8].round}\"\n              xml.Ort \"#{row[9]}\"\n            end\n          end\n        end\n    end\n    end\n   end \n  end\n end.to_xml\n\n File.open(\"output.xml\", \"w\") { |file| file.write(xml) }\n</code></pre>\n\n<p>Data sample:</p>\n\n<pre><code>vorname nachname geschlecht geburtsdatum land\nGeorge   Jones      m         30/10/1994 PRT\nTom      Kaye       m         19/04/2000\n</code></pre>\n\n<p>This refers to a separate excel sheet where I am referencing to column numbers 2,3,4 etc. </p>\n\n<p>Where I have Land row 5 I want to include this xml item only if there is data for Land in Column 7 on the xls. </p>\n\n<p>I can generate the xml but it's currently putting in land populating land as blank when in fact I do not want it to exist if there is no value in the corresponding row. for example row 2 of the data sample does not contain a land. Can you advise please?</p>\n\n<p>Expected XML Sample for including land and not including land:</p>\n\n<pre><code>&lt;PLZ&gt;74544&lt;/PLZ&gt;\n&lt;Land&gt;PRT&lt;/Land&gt;\n&lt;Ort&gt;Michelbach&lt;/Ort&gt;\n\n&lt;PLZ&gt;74544&lt;/PLZ&gt;\n&lt;Ort&gt;Michelbach&lt;/Ort&gt;\n</code></pre>\n"}, {"tags": ["ruby", "redmine", "rmagick"], "comments": [{"owner": {"reputation": 15, "user_id": 8495482, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-rNvqdEZjblE/AAAAAAAAAAI/AAAAAAAAASc/R9IQ_qWIbT0/photo.jpg?sz=128", "display_name": "novenix", "link": "https://stackoverflow.com/users/8495482/novenix"}, "edited": false, "score": 0, "creation_date": 1517415701, "post_id": 48546771, "comment_id": 84089242, "body": "sorry if its something basic, it my firs time installing this, i am in WINDOWS"}, {"owner": {"reputation": 710, "user_id": 3685411, "user_type": "registered", "accept_rate": 82, "profile_image": "https://graph.facebook.com/651824110/picture?type=large", "display_name": "Snoobie", "link": "https://stackoverflow.com/users/3685411/snoobie"}, "edited": false, "score": 3, "creation_date": 1517415713, "post_id": 48546771, "comment_id": 84089252, "body": "I think ImageMagick is missing from your computer, please follow those step <a href=\"https://www.imagemagick.org/script/advanced-windows-installation.php\" rel=\"nofollow noreferrer\">install imagemagick</a>"}], "owner": {"reputation": 15, "user_id": 8495482, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-rNvqdEZjblE/AAAAAAAAAAI/AAAAAAAAASc/R9IQ_qWIbT0/photo.jpg?sz=128", "display_name": "novenix", "link": "https://stackoverflow.com/users/8495482/novenix"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 372, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1517415767, "creation_date": 1517415601, "last_edit_date": 1517415767, "question_id": 48546771, "link": "https://stackoverflow.com/questions/48546771/gemextbuilderror-error-failed-to-build-gem-native-extension-this-o", "title": "Gem::Ext::BuildError: ERROR: Failed to build gem native extension.&#176;&#176;&#176;&#176;&#176;&#176;&#176; This ocurring when running bundle install --without development test", "body": "<p>i have this problem when im running the comand:<br>\nbundle install --without development test</p>\n\n<blockquote>\n  <p>Gem::Ext::BuildError: ERROR: Failed to build gem native extension.</p>\n  \n  <p>current directory:\n     C:/Ruby25-x64/lib/ruby/gems/2.5.0/gems/rmagick-2.16.0/ext/RMagick\n     C:/Ruby25-x64/bin/ruby.exe -r ./siteconf20180131-9264-1gsyu6v.rb extconf.rb\n     <strong>* extconf.rb failed *</strong>\n     Could not create Makefile due to some reason, probably lack of necessary\n     libraries and/or headers.  Check the mkmf.log file for more details.  You may\n     need configuration options.</p>\n  \n  <p>Provided configuration options:\n         --with-opt-dir\n         --without-opt-dir\n         --with-opt-include\n         --without-opt-include=${opt-dir}/include\n         --with-opt-lib\n         --without-opt-lib=${opt-dir}/lib\n         --with-make-prog\n         --without-make-prog\n         --srcdir=.\n         --curdir\n         --ruby=C:/Ruby25-x64/bin/$(RUBY_BASE_NAME)\n     extconf.rb:141:in ``': No such file or directory - identify -version\n     (Errno::ENOENT)\n         from extconf.rb:141:in <code>configure_compile_options'\n         from extconf.rb:16:in</code>initialize'\n         from extconf.rb:548:in <code>new'\n         from extconf.rb:548:in</code>'></p>\n  \n  <p>extconf failed, exit code 1</p>\n  \n  <p>Gem files will remain installed in\n     C:/Ruby25-x64/lib/ruby/gems/2.5.0/gems/rmagick-2.16.0 for inspection.\n     Results logged to\n     C:/Ruby25-x64/lib/ruby/gems/2.5.0/extensions/x64-mingw32/2.5.0/rmagick-> 2.16.0/gem_make.out</p>\n  \n  <p>An error occurred while installing rmagick (2.16.0), and Bundler cannot\n     continue.\n     Make sure that <code>gem install rmagick -v '2.16.0'</code> succeeds before bundling.</p>\n  \n  <p>In Gemfile:\n       rmagick</p>\n</blockquote>\n\n<p>im doing this to install redmine, and i have all dependencies of ruby updated.</p>\n"}, {"tags": ["ruby", "github", "github-api", "pull-request"], "answers": [{"comments": [{"owner": {"reputation": 121, "user_id": 7095891, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153959073771680/picture?type=large", "display_name": "Kenny Lindahl", "link": "https://stackoverflow.com/users/7095891/kenny-lindahl"}, "edited": false, "score": 0, "creation_date": 1517472793, "post_id": 48554455, "comment_id": 84111817, "body": "Great answer, thanks a lot! I will try it out today and come back with the results."}], "tags": [], "owner": {"reputation": 31626, "user_id": 2614364, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/tQZrZ.jpg?s=128&g=1", "display_name": "Bertrand Martel", "link": "https://stackoverflow.com/users/2614364/bertrand-martel"}, "is_accepted": false, "score": 2, "last_activity_date": 1517452489, "last_edit_date": 1517452489, "creation_date": 1517452045, "answer_id": 48554455, "question_id": 48545950, "link": "https://stackoverflow.com/questions/48545950/github-api-get-pull-request-for-specific-release-tag/48554455#48554455", "title": "Github API: Get pull request for specific release tag", "body": "<p>You can extract the commits between your tag &amp; the previous one and search issues (of type pull request) with each of those commit <a href=\"https://help.github.com/articles/searching-issues-and-pull-requests/#search-by-the-commit-shas-within-a-pull-request\" rel=\"nofollow noreferrer\"><code>SHA</code></a> using search API : </p>\n\n<ul>\n<li>use <a href=\"https://developer.github.com/v3/git/tags/\" rel=\"nofollow noreferrer\">Get tags</a> to extract the list of tags for your repo</li>\n<li>extract the specific tag (release tag name) you are interested to &amp; the previous tag (release tag if existing)</li>\n<li>get all commits between these 2 tags using <a href=\"https://developer.github.com/v3/repos/commits/#compare-two-commits\" rel=\"nofollow noreferrer\">compare</a></li>\n<li><a href=\"https://developer.github.com/v3/search/#search-issues\" rel=\"nofollow noreferrer\">search issues</a> of type pull request with the specific <a href=\"https://help.github.com/articles/searching-issues-and-pull-requests/#search-by-the-commit-shas-within-a-pull-request\" rel=\"nofollow noreferrer\"><code>SHA</code></a>. In this case, you can perform a query(*) with all the commits sha concatenating <code>SHA:&lt;commit sha&gt;</code> to the query</li>\n</ul>\n\n<p>(*)Note that the search query is limited to 256 characters so you'll have to split those search API call</p>\n\n<p>Example using <a href=\"/questions/tagged/bash\" class=\"post-tag\" title=\"show questions tagged &#39;bash&#39;\" rel=\"tag\">bash</a>, <a href=\"/questions/tagged/curl\" class=\"post-tag\" title=\"show questions tagged &#39;curl&#39;\" rel=\"tag\">curl</a> &amp; <a href=\"/questions/tagged/jq\" class=\"post-tag\" title=\"show questions tagged &#39;jq&#39;\" rel=\"tag\">jq</a> :</p>\n\n<pre class=\"lang-bash prettyprint-override\"><code>#!/bin/bash\n\ncurrent_tag=\"v4.8.0\"\nname_with_owner=\"octokit/octokit.rb\"\naccess_token=\"YOUR_ACCESS_TOKEN\"\n\ntags=$(curl -s -H \"Authorization: Token $access_token\" \\\n            \"https://api.github.com/repos/$name_with_owner/tags\")\nkey=$(jq -r --arg current_tag $current_tag 'to_entries | .[] | select(.value.name == $current_tag) | .key' &lt;&lt;&lt; \"$tags\")\nprevious_tag=$(jq -r --arg index $((key+1)) '.[$index | tonumber].name' &lt;&lt;&lt; \"$tags\")\n\necho \"compare between $previous_tag &amp; $current_tag\"\n\ncommits=$(curl -s -H \"Authorization: Token $access_token\" \\\n               \"https://api.github.com/repos/$name_with_owner/compare/$previous_tag...$current_tag\" | \\\n               jq -r '.commits[].sha')\n\n\n# you can have a query of maximum of 256 character so we only process 17 sha for each request\ncount=0\nmax_per_request=17\nwhile read sha; do\n    if [ $count == 0 ]; then\n        query=\"repo:$name_with_owner%20type:pr\"\n    fi\n    query=\"$query%20SHA:%20${sha:0:7}\"\n    count=$((count+1))\n    if ! (($count % $max_per_request)); then\n        echo \"https://api.github.com/search/issues?q=$query\"\n        curl -s -H \"Authorization: Token $access_token\" \\\n            \"https://api.github.com/search/issues?q=$query\" | jq -r '.items[].html_url'\n        count=0\n    fi\ndone &lt;&lt;&lt; \"$commits\"\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 121, "user_id": 7095891, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153959073771680/picture?type=large", "display_name": "Kenny Lindahl", "link": "https://stackoverflow.com/users/7095891/kenny-lindahl"}, "is_accepted": false, "score": 0, "last_activity_date": 1517501829, "last_edit_date": 1517501829, "creation_date": 1517501320, "answer_id": 48567080, "question_id": 48545950, "link": "https://stackoverflow.com/questions/48545950/github-api-get-pull-request-for-specific-release-tag/48567080#48567080", "title": "Github API: Get pull request for specific release tag", "body": "<p>I did it in Ruby:</p>\n\n<ul>\n<li>Using <code>octokit</code> gem</li>\n<li>Only looking for commits with the prefix <code>fix</code> or <code>feat</code></li>\n<li>Purpose: </li>\n</ul>\n\n<p>The code looks like this:</p>\n\n<pre><code>require 'octokit'\nClient = Octokit::Client.new(access_token: YOUR_GITHUB_TOKEN)\n\ndef getCommitsForTag(repo, tagName)\n  previousTag = getPreviousTag repo, tagName\n  (Client.compare repo, previousTag.name, tagName).commits\nend\n\ndef getPreviousTag(repo, tagName)\n  tags = Client.tags repo\n  tags.each_with_index { |tag, index|\n    if tag.name == tagName\n      return tags[index+1]\n    end\n  }\nend\n\ndef filterCommitsByPrefix(commits, commitPrefixArray)\n  filteredArray = []\n  commits.each { |commit|\n    commitPrefixArray.each { |commitPrefix|\n      if commit.commit.message.start_with?(commitPrefix)\n        filteredArray.push(commit)\n      end\n    }\n  }\n  filteredArray\nend\n\ndef getPullRequestsByCommits(commits)\n  query = \"SHA:\"\n  commits.each { |commit| \n    query += \"#{commit.sha},\"\n  }\n  Client.search_issues query\nend\n\n\ndef getPullRequestsForTag(repo, tag)\n  commitsForTag = getCommitsForTag repo, tag\n  fixCommits = filterCommitsByPrefix commitsForTag, ['fix']\n  featCommits = filterCommitsByPrefix commitsForTag, ['feat']\n  {\n    fixes: getPullRequestsByCommits(fixCommits).items,\n    features: getPullRequestsByCommits(featCommits).items\n  }\nend\n\n#Execute it like this:\npullRequestsForTag = getPullRequestsForTag 'octokit/octokit.rb', 'v4.8.0'\n\nputs \"Fix pull requests:\"\nputs pullRequestsForTag[:fixes]\nputs \"Feat pull requests:\"\nputs pullRequestsForTag[:features]\n</code></pre>\n"}], "owner": {"reputation": 121, "user_id": 7095891, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153959073771680/picture?type=large", "display_name": "Kenny Lindahl", "link": "https://stackoverflow.com/users/7095891/kenny-lindahl"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1370, "favorite_count": 1, "answer_count": 2, "score": 5, "last_activity_date": 1517501829, "creation_date": 1517413181, "last_edit_date": 1517422441, "question_id": 48545950, "link": "https://stackoverflow.com/questions/48545950/github-api-get-pull-request-for-specific-release-tag", "title": "Github API: Get pull request for specific release tag", "body": "<p><strong>Is it possible to get a list of pull requests (or just the numbers) related to a release tag?</strong></p>\n\n<hr/>\n\n<p>I have been looking at the Github API documentation all day and have tried different things but i can't see how i could make this work.</p>\n\n<p>I can't see that the pull request information is available when i get a commit via the API, even if the pull request id &amp; link is available here for example:\n<a href=\"https://github.com/octokit/octokit.rb/commit/1d82792d7d16457206418850a3ed0a0230defc81\" rel=\"nofollow noreferrer\">https://github.com/octokit/octokit.rb/commit/1d82792d7d16457206418850a3ed0a0230defc81</a> (see the <strong>#962</strong> link next to <strong>\"master\"</strong> in the top left)</p>\n"}, {"tags": ["ruby", "redis", "background", "sidekiq"], "comments": [{"owner": {"reputation": 318, "user_id": 3150155, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/4b17f5eaf4a8a47e2b7d8e9c92ea04b6?s=128&d=identicon&r=PG&f=1", "display_name": "adanot", "link": "https://stackoverflow.com/users/3150155/adanot"}, "edited": false, "score": 0, "creation_date": 1517422075, "post_id": 48545609, "comment_id": 84093378, "body": "Can you include a screenshot of the workers in the web UI?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2256233"}, "reply_to_user": {"reputation": 318, "user_id": 3150155, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/4b17f5eaf4a8a47e2b7d8e9c92ea04b6?s=128&d=identicon&r=PG&f=1", "display_name": "adanot", "link": "https://stackoverflow.com/users/3150155/adanot"}, "edited": false, "score": 0, "creation_date": 1517460675, "post_id": 48545609, "comment_id": 84107184, "body": "@adanot - added a screenshot"}], "owner": {"user_type": "does_not_exist", "display_name": "user2256233"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 92, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1517484034, "creation_date": 1517412139, "last_edit_date": 1517484034, "question_id": 48545609, "link": "https://stackoverflow.com/questions/48545609/sidekiq-stops-processing-jobs", "title": "Sidekiq stops processing jobs", "body": "<p>I have a rails app which is deployed on 2 ec2 instance with nginx and capistrano. For background job, I had used sidekiq with redis. I have 50 gb RDS. I also have set max_pool_size to 50 of sidekiq concurrency. Sidekiq stops processing job when the busy queue is full. I am unable to find anything in the log. Please help find the issue</p>\n\n<p>Here is Sidekiq Configuration file -</p>\n\n<hr>\n\n<ul>\n<li>:concurrency: 50</li>\n<li>:queues:\n\n<ul>\n<li>default</li>\n<li>thread</li>\n<li>thread1</li>\n<li>[activities, 2]</li>\n<li>[super_jobs, 2]</li>\n<li>[thread4, 1]</li>\n</ul></li>\n</ul>\n\n<p>Sidekiq Log - </p>\n\n<ul>\n<li>2018-01-31T14:56:51.669Z 6814 TID-c5v4s Activities::StreamJob JID-20e396f7a9292a96a4e2a0e5 INFO: start</li>\n<li>2018-01-31T14:56:56.801Z 6814 TID-1jby50 Activities::StreamJob JID-1da433fff954f46f317574d0 INFO: start</li>\n<li>2018-01-31T14:57:06.074Z 6814 TID-1jd5vg SuperJobs::StreamJob JID-48e4a5df330bf70f10f07d1e INFO: start</li>\n<li>2018-01-31T14:58:21.803Z 6814 TID-1jc1w0 SuperJobs::StreamJob JID-c4f2fa480b192aa0e34bb67a INFO: start</li>\n<li>2018-01-31T14:58:22.327Z 6814 TID-c08iw Activities::StreamJob JID-00160e805f166000a801e1be INFO: start</li>\n<li>2018-01-31T14:59:15.924Z 6814 TID-1bviqs SuperJobs::StreamJob JID-84d7241b62126d691c59610a INFO: start</li>\n<li>2018-01-31T15:00:24.390Z 6814 TID-1jblf8 Activities::StreamJob JID-e82b4d7348b0f648bf1d079a INFO: start</li>\n<li>2018-01-31T15:00:39.160Z 6814 TID-1jd7ak Activities::StreamJob JID-c8736ff182fda70f98d867f4 INFO: start</li>\n</ul>\n"}, {"tags": ["ruby-on-rails", "ruby", "routing", "ruby-on-rails-5"], "comments": [{"owner": {"reputation": 13069, "user_id": 158689, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/68fc3ecec3de051d5ad23ebc96f61c62?s=128&d=identicon&r=PG", "display_name": "Aliaksei Kliuchnikau", "link": "https://stackoverflow.com/users/158689/aliaksei-kliuchnikau"}, "edited": false, "score": 1, "creation_date": 1517410707, "post_id": 48544842, "comment_id": 84085700, "body": "You can try to run <code>rake routes</code> - it might give you/SO users an insights into how your routes are actually generated"}, {"owner": {"reputation": 8640, "user_id": 4055042, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/cd04c63d95d27033b53d4d83fea40c02?s=128&d=identicon&r=PG&f=1", "display_name": "SRack", "link": "https://stackoverflow.com/users/4055042/srack"}, "edited": false, "score": 1, "creation_date": 1517410831, "post_id": 48544842, "comment_id": 84085813, "body": "You&#39;re actually defining a few of the routes twice: <code>resources :users</code> is all you need for the standard CRUD routing. This <i>could</i> be the issue - somewhere, you may be overwriting the named pathway for <code>show</code>. I&#39;d start by removing the duplicated routes, or adding a third argument linke <code>as: :the_paths_name</code> to the routes you&#39;re defining line by line."}, {"owner": {"reputation": 8640, "user_id": 4055042, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/cd04c63d95d27033b53d4d83fea40c02?s=128&d=identicon&r=PG&f=1", "display_name": "SRack", "link": "https://stackoverflow.com/users/4055042/srack"}, "edited": false, "score": 0, "creation_date": 1517411090, "post_id": 48544842, "comment_id": 84086012, "body": "Also, just to note, the output you&#39;re getting (i.e. <code>&#47;user.1</code>) comes when passing an arg without a key to paths <i>not</i> expecting an id parameter."}], "answers": [{"comments": [{"owner": {"reputation": 175, "user_id": 8455792, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/10154620878171277/picture?type=large", "display_name": "Martin", "link": "https://stackoverflow.com/users/8455792/martin"}, "edited": false, "score": 0, "creation_date": 1517412758, "post_id": 48545671, "comment_id": 84087194, "body": "Yep! This fixed it. Thanks so much! And now I know for the future."}, {"owner": {"reputation": 8640, "user_id": 4055042, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/cd04c63d95d27033b53d4d83fea40c02?s=128&d=identicon&r=PG&f=1", "display_name": "SRack", "link": "https://stackoverflow.com/users/4055042/srack"}, "reply_to_user": {"reputation": 175, "user_id": 8455792, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/10154620878171277/picture?type=large", "display_name": "Martin", "link": "https://stackoverflow.com/users/8455792/martin"}, "edited": false, "score": 0, "creation_date": 1517412867, "post_id": 48545671, "comment_id": 84087261, "body": "Great, glad to hear it @Martin :)"}], "tags": [], "owner": {"reputation": 8640, "user_id": 4055042, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/cd04c63d95d27033b53d4d83fea40c02?s=128&d=identicon&r=PG&f=1", "display_name": "SRack", "link": "https://stackoverflow.com/users/4055042/srack"}, "is_accepted": true, "score": 2, "last_activity_date": 1517412317, "creation_date": 1517412317, "answer_id": 48545671, "question_id": 48544842, "link": "https://stackoverflow.com/questions/48544842/rails-model-path-routing-error-no-route-matching-model-2-should-be-model-2/48545671#48545671", "title": "Rails model_path routing error, no route matching &quot;model.2&quot;; should be &quot;model/2&quot;", "body": "<p>I'd suggest updating your routes as follows:</p>\n\n<p><strong>config/routes.rb</strong></p>\n\n<pre><code>Rails.application.routes.draw do\n\n  root 'static#home'\n\n  %w( 404 406 422 500 503 ).each do |code|\n    get code, :to =&gt; \"errors#show\", :code =&gt; code \n  end \n\n  #USER PAGES\n  get '/test' =&gt; 'users#test'\n  get 'profile', to: 'users#show', as: :user_profile\n\n  resources :users\nend\n</code></pre>\n\n<p>...as <code>resources :users</code> creates all of the routes I've removed. </p>\n\n<p>The duplicates may have been overwriting a default path, causing the behaviour you're seeing - if you pass an object to a url helper that doesn't expect a parameter, you see the behaviour you're getting (i.e. <code>doesnt_have_an_id_path(@object) =&gt; /doesnt_have_an_id.1</code>).</p>\n\n<p>I've also added a name to the user profile path to avoid this clashing. See if this works (perhaps one step at a time to get the cause and effect) - otherwise, try temporarily removing the profile route. </p>\n\n<p>Re that path, you may have a problem in that the <code>users#show</code> action will expect an <code>:id</code> parameter, yet that route doesn't allow for one. This <em>might</em> be causing the current problem, though if not, may cause issues down the line.</p>\n\n<p>Hope that fixes it - shout if you've any questions / feedback when you've tried it out.</p>\n"}, {"tags": [], "owner": {"reputation": 13069, "user_id": 158689, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/68fc3ecec3de051d5ad23ebc96f61c62?s=128&d=identicon&r=PG", "display_name": "Aliaksei Kliuchnikau", "link": "https://stackoverflow.com/users/158689/aliaksei-kliuchnikau"}, "is_accepted": false, "score": 1, "last_activity_date": 1517413150, "last_edit_date": 1517413150, "creation_date": 1517412670, "answer_id": 48545790, "question_id": 48544842, "link": "https://stackoverflow.com/questions/48544842/rails-model-path-routing-error-no-route-matching-model-2-should-be-model-2/48545790#48545790", "title": "Rails model_path routing error, no route matching &quot;model.2&quot;; should be &quot;model/2&quot;", "body": "<p>In your case the two conflicting routes are:</p>\n\n<pre><code>post '/user/' =&gt; 'users#update'\nget '/user/:id' =&gt; 'users#show'\n</code></pre>\n\n<p>You are trying to use <code>user_path</code> helper method, thus you need to have <code>user</code> named route.\nIf you run <code>rake routes</code> for these two routes you will see this:</p>\n\n<pre><code>Prefix Verb URI Pattern         Controller#Action\n  user POST /user(.:format)     users#create\n       GET  /user/:id(.:format) users#show\n</code></pre>\n\n<p>The <code>Prefix</code> column shows you the named routes which are defined for your application. In this case Rails auto-generated named route <code>user</code> for POST <code>/user</code> endpoint. That means <code>user_path</code> will return /user instead of <code>/user/:id</code> as you expected. Rails generate routes like these when it sees a route definition without parameters. For example if you have <code>get /user/some/more</code> in your routes, Rails will auto-generate named route <code>user_some_more</code> for you and they you will be able to use <code>user_some_more_path</code> helper.</p>\n\n<p>In order to fix your particular case you can stop rails from generating route for POST endpoint by doing this: <code>post '/user/', as: nil</code> and give GET endpoint a name you want: <code>get '/user/:id', as: 'user'</code>. Then you will be able to use <code>user_path(user)</code> to generate paths of format /user/:id.</p>\n"}], "owner": {"reputation": 175, "user_id": 8455792, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/10154620878171277/picture?type=large", "display_name": "Martin", "link": "https://stackoverflow.com/users/8455792/martin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 160, "favorite_count": 0, "accepted_answer_id": 48545671, "answer_count": 2, "score": 4, "last_activity_date": 1517413150, "creation_date": 1517409811, "question_id": 48544842, "link": "https://stackoverflow.com/questions/48544842/rails-model-path-routing-error-no-route-matching-model-2-should-be-model-2", "title": "Rails model_path routing error, no route matching &quot;model.2&quot;; should be &quot;model/2&quot;", "body": "<p>There seems to be something wrong with my routing paths. Normally I should be able to do something like <code>&lt;%= link_to Profile, user_path(@user||current_user) %&gt;</code> and I move on with my day. For whatever reason I'm failing to understand my <code>user_path</code> is not returning <code>/user/:id</code> like I would expect it to do. Instead it is returning <code>/user.:id</code>\nTo test this, I loaded a partial with the following code. </p>\n\n<p><strong>app/view/users/_test.html.rb</strong></p>\n\n<pre><code>&lt;%= @user %&gt;&lt;br&gt;\n&lt;%= @user.id %&gt;&lt;br&gt;\n&lt;%= link_to user_path(@user), user_path(@user) %&gt;&lt;br&gt;\n&lt;%= new_user_path %&gt;&lt;br&gt;\n&lt;%= edit_user_path(@user) %&gt;&lt;br&gt;\n&lt;%= url_for(@user) %&gt;\n</code></pre>\n\n<p>This returned </p>\n\n<p><strong>localhost:3000/test</strong></p>\n\n<pre><code>#&lt;User:0x007fb6cd341f08&gt;\n1\n/user.1\n/users/new\n/users/1/edit\n/user.1\n</code></pre>\n\n<p>I can't figure out what is causing this to happen. The <code>edit_user_path(@user)</code> works perfectly, but the show doesn't. I have read the <a href=\"http://guides.rubyonrails.org/routing.html\" rel=\"nofollow noreferrer\">Rails Routing Guide</a> from top to bottom about three times and I can't figure it out. The closest I found to my problem was on an <a href=\"https://github.com/plataformatec/devise/issues/1100\" rel=\"nofollow noreferrer\">old Rails 3.1 gem problem with Devise</a>, but I'm not even using the Devise gem (maybe I should be?). </p>\n\n<p>Why is my route failing? I'm not really looking for a workaround (though I suppose I'd rather have a workaround than no solution), I want to understand why this is happening and fix it. What's going on?</p>\n\n<p>My routes are pretty vanilla, nothing special going on there, but just in case the problem is there and I missed it, here it is. </p>\n\n<p><strong>config/routes.rb</strong></p>\n\n<pre><code>Rails.application.routes.draw do\n\n  root 'static#home'\n\n  %w( 404 406 422 500 503 ).each do |code|\n    get code, :to =&gt; \"errors#show\", :code =&gt; code \n  end \n\n  #USER PAGES\n  get '/test' =&gt; 'users#test'\n  get '/signup' =&gt; 'users#new'\n  post '/user' =&gt; 'users#create'\n  get '/user/list' =&gt; 'users#index'\n  post '/user/' =&gt; 'users#update'\n  get '/user/:id' =&gt; 'users#show'\n  get 'profile', to: 'users#show'\n\n  resources :users\nend\n</code></pre>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1517409077, "post_id": 48544474, "comment_id": 84084383, "body": "Have you tried calling the above code? It should be fairly obvious if you have."}, {"owner": {"reputation": 2960, "user_id": 7426461, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/Ldwxy.jpg?s=128&g=1", "display_name": "Cannon Moyer", "link": "https://stackoverflow.com/users/7426461/cannon-moyer"}, "reply_to_user": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1517409151, "post_id": 48544474, "comment_id": 84084448, "body": "@engineersmnky I have but I don&#39;t see the point other than making the essentially creating a namespace so that functions don&#39;t walk on one another."}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1517409241, "post_id": 48544474, "comment_id": 84084519, "body": "in the second example you can call <code>MyModule.run</code>. Can you do the same in the first example?"}, {"owner": {"reputation": 2960, "user_id": 7426461, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/Ldwxy.jpg?s=128&g=1", "display_name": "Cannon Moyer", "link": "https://stackoverflow.com/users/7426461/cannon-moyer"}, "reply_to_user": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1517409272, "post_id": 48544474, "comment_id": 84084547, "body": "@engineersmnky no I cannot."}, {"owner": {"reputation": 2960, "user_id": 7426461, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/Ldwxy.jpg?s=128&g=1", "display_name": "Cannon Moyer", "link": "https://stackoverflow.com/users/7426461/cannon-moyer"}, "reply_to_user": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1517409520, "post_id": 48544474, "comment_id": 84084749, "body": "It does, I understand how to directly call them, I&#39;m just not sure when I should use one over the other. @engineersmnky"}, {"owner": {"reputation": 9030, "user_id": 5101476, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JCQrl.jpg?s=128&g=1", "display_name": "ice\u30c4", "link": "https://stackoverflow.com/users/5101476/ice%e3%83%84"}, "edited": false, "score": 0, "creation_date": 1517410111, "post_id": 48544474, "comment_id": 84085226, "body": "Things to research: classes, modules, self, singleton classes, the class Class and how classes themselves are objects."}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 2, "creation_date": 1517410218, "post_id": 48544474, "comment_id": 84085312, "body": "The fist will allow you to mix this method into other classes e.g. <code>class A; include MyModule; end;</code> will allow you to call <code>A.new.run</code> and <code>class A; extend MyModule; end;</code> will allow you to call <code>A.run</code>.  In the second example the <code>run</code> method is bound to <code>MyModule</code> as the receiver and will have to be called as <code>MyModule.run</code>"}, {"owner": {"reputation": 2960, "user_id": 7426461, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/Ldwxy.jpg?s=128&g=1", "display_name": "Cannon Moyer", "link": "https://stackoverflow.com/users/7426461/cannon-moyer"}, "reply_to_user": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1517410294, "post_id": 48544474, "comment_id": 84085379, "body": "@engineersmnky Makes perfect sense now. Thanks!"}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1517410710, "post_id": 48544474, "comment_id": 84085703, "body": "The second example looks very strange. Where did you see it?"}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1517411477, "post_id": 48544474, "comment_id": 84086274, "body": "The only (weird) use case I can think of is to alter constant lookup by defining the method in a module nested <i>within</i> <code>MyModule</code>."}, {"owner": {"reputation": 2960, "user_id": 7426461, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/Ldwxy.jpg?s=128&g=1", "display_name": "Cannon Moyer", "link": "https://stackoverflow.com/users/7426461/cannon-moyer"}, "reply_to_user": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 1, "creation_date": 1517412391, "post_id": 48544474, "comment_id": 84086934, "body": "@Stefan I saw it here <a href=\"http://ruby-doc.com/docs/ProgrammingRuby/html/tut_modules.html\" rel=\"nofollow noreferrer\">ruby-doc.com/docs/ProgrammingRuby/html/tut_modules.html</a>"}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1517415132, "post_id": 48544474, "comment_id": 84088843, "body": "@CannonMoyer indeed and even some built-in Ruby classes use that syntax, for example <a href=\"https://github.com/ruby/ruby/blob/trunk/lib/matrix.rb\" rel=\"nofollow noreferrer\"><code>Matrix</code></a>. Maybe because it resembles the way you invoke the methods. It still looks strange to me."}], "answers": [{"comments": [{"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1517409466, "post_id": 48544610, "comment_id": 84084709, "body": "They are not the same at all (excepting the fact that is this simple example both contain the same method body)"}], "tags": [], "owner": {"reputation": 61, "user_id": 8205478, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/44fe08c4d0ec0cb5755e0520d4bcf6f6?s=128&d=identicon&r=PG&f=1", "display_name": "DevMasterAryan", "link": "https://stackoverflow.com/users/8205478/devmasteraryan"}, "is_accepted": false, "score": -1, "last_activity_date": 1517409084, "creation_date": 1517409084, "answer_id": 48544610, "question_id": 48544474, "link": "https://stackoverflow.com/questions/48544474/meaning-of-syntax-for-ruby-module/48544610#48544610", "title": "Meaning of Syntax for Ruby Module", "body": "<p>I guess both are same but in case when we call module method inside class then we have to give </p>\n\n<pre><code>ModuleName.method_name()\n</code></pre>\n\n<p>So that it can understand that this method is required for included or that particular module</p>\n"}, {"comments": [{"owner": {"reputation": 2960, "user_id": 7426461, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/Ldwxy.jpg?s=128&g=1", "display_name": "Cannon Moyer", "link": "https://stackoverflow.com/users/7426461/cannon-moyer"}, "edited": false, "score": 0, "creation_date": 1517409404, "post_id": 48544664, "comment_id": 84084653, "body": "&quot;self&quot; would be referring to a class where this module was used as a mixin, right?"}, {"owner": {"reputation": 7605, "user_id": 584552, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/dc70f4a04726fada8b9db8a18ff40412?s=128&d=identicon&r=PG", "display_name": "mdesantis", "link": "https://stackoverflow.com/users/584552/mdesantis"}, "reply_to_user": {"reputation": 2960, "user_id": 7426461, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/Ldwxy.jpg?s=128&g=1", "display_name": "Cannon Moyer", "link": "https://stackoverflow.com/users/7426461/cannon-moyer"}, "edited": false, "score": 0, "creation_date": 1517409473, "post_id": 48544664, "comment_id": 84084713, "body": "<code>self</code> outside of an instance method definition refers to the module within <code>self</code> is."}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "reply_to_user": {"reputation": 2960, "user_id": 7426461, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/Ldwxy.jpg?s=128&g=1", "display_name": "Cannon Moyer", "link": "https://stackoverflow.com/users/7426461/cannon-moyer"}, "edited": false, "score": 0, "creation_date": 1517411100, "post_id": 48544664, "comment_id": 84086018, "body": "@CannonMoyer within the body of the module, <code>self</code> and <code>MyModule</code> are identical."}, {"owner": {"reputation": 24179, "user_id": 1672429, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/0815eb7d4e9dd58022d51ba2011b9c0a?s=128&d=identicon&r=PG", "display_name": "Stefan Pochmann", "link": "https://stackoverflow.com/users/1672429/stefan-pochmann"}, "edited": false, "score": 1, "creation_date": 1517431301, "post_id": 48544664, "comment_id": 84098237, "body": "&quot;It&#39;s&quot;? Which one is &quot;it&quot;? They&#39;re showing <i>two</i> versions."}], "tags": [], "owner": {"reputation": 7605, "user_id": 584552, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/dc70f4a04726fada8b9db8a18ff40412?s=128&d=identicon&r=PG", "display_name": "mdesantis", "link": "https://stackoverflow.com/users/584552/mdesantis"}, "is_accepted": true, "score": 3, "last_activity_date": 1517577128, "last_edit_date": 1517577128, "creation_date": 1517409283, "answer_id": 48544664, "question_id": 48544474, "link": "https://stackoverflow.com/questions/48544474/meaning-of-syntax-for-ruby-module/48544664#48544664", "title": "Meaning of Syntax for Ruby Module", "body": "<pre><code>module MyModule\n   def MyModule.run()\n      puts \"running\"\n   end\nend\n</code></pre>\n\n<p>is exactly the same as:</p>\n\n<pre><code>module MyModule\n   def self.run()\n      puts \"running\"\n   end\nend\n</code></pre>\n\n<p>Usually <code>def self.run</code> is used, because it's better when you have to change the module name and it's more idiomatic. I don't see any advantages in writing <code>def MyModule.run</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "is_accepted": false, "score": 2, "last_activity_date": 1517413758, "creation_date": 1517413758, "answer_id": 48546155, "question_id": 48544474, "link": "https://stackoverflow.com/questions/48544474/meaning-of-syntax-for-ruby-module/48546155#48546155", "title": "Meaning of Syntax for Ruby Module", "body": "<p>This has nothing to do with modules. This is just normal method definition syntax.</p>\n\n<p>The syntax for a method definition in Ruby is</p>\n\n<pre><code>def &lt;target&gt;.&lt;selector&gt;(&lt;parameters&gt;)\n  # \u2026\nend\n</code></pre>\n\n<p>For example:</p>\n\n<pre><code>def foo.bar(baz)\nend\n</code></pre>\n\n<p>This will define a method named <code>bar</code> on the object referenced by <code>foo</code> (more precisely, in the singleton class of the object referenced by <code>foo</code>), with a single mandatory positional parameter whose binding is named <code>baz</code>.</p>\n\n<p>Like with message sends, you can leave out the target, and Ruby will use an implicit default. In a message send, the implicit default is <code>self</code>, with a method definition, the default is the so-called <em>default definee</em>, which is <em>usually</em> the closest lexically enclosing module definition body.</p>\n\n<p>So, </p>\n\n<pre><code>def MyModule.run\n</code></pre>\n\n<p>means \"define a method named <code>run</code> on the object <code>MyModule</code> (or more precisely in the singleton class of the object <code>MyModule</code>)\", whereas </p>\n\n<pre><code>def run\n</code></pre>\n\n<p>means \"define a method named <code>run</code> in the default definee\", i.e. the closest lexically enclosing module definition body, which in this case is <code>MyModule</code>.</p>\n\n<p>The second version defines <code>run</code> as an <em>instance method</em> of <code>MyModule</code>, the first version defines <code>run</code> as an instance method of <em>the singleton class of</em> <code>MyModule</code>, which we sometimes call a \"module method\" or \"module function\".</p>\n\n<p>Note that the first version is usually more idiomatically written as </p>\n\n<pre><code>def self.run\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1517416660, "post_id": 48547039, "comment_id": 84089941, "body": "<i>&quot;you could, if you wished, refer to instance variables @bar which aren&#39;t defined in the module, but only in the Foo class&quot;</i> I would not recommend this part as this infers that the <code>Module</code> should have a more intimate knowledge than it should of the <code>Class</code> it is included in or visa versa. If you must use variables in this fashion they should be dependency injected into the the methods defined in the module e.g. <code>def run(arg=self); &quot;#{arg}: running&quot;; end</code> then <code>Foo</code> could call <code>run(@bar)</code>"}, {"owner": {"reputation": 1266, "user_id": 6022100, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/dc0adea29934c8ee1c31f96bf85a7fbc?s=128&d=identicon&r=PG", "display_name": "rwold", "link": "https://stackoverflow.com/users/6022100/rwold"}, "reply_to_user": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1517416999, "post_id": 48547039, "comment_id": 84090152, "body": "Perhaps so- the OP just seemed fundamentally confused about the concept of a mixin, and I thought that this observation may help."}], "tags": [], "owner": {"reputation": 1266, "user_id": 6022100, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/dc0adea29934c8ee1c31f96bf85a7fbc?s=128&d=identicon&r=PG", "display_name": "rwold", "link": "https://stackoverflow.com/users/6022100/rwold"}, "is_accepted": false, "score": 0, "last_activity_date": 1517416501, "creation_date": 1517416501, "answer_id": 48547039, "question_id": 48544474, "link": "https://stackoverflow.com/questions/48544474/meaning-of-syntax-for-ruby-module/48547039#48547039", "title": "Meaning of Syntax for Ruby Module", "body": "<p>This is about using a module as a static namespace vs using a module as a mixin. Have a look at the following code (with output in comments):</p>\n\n<pre><code>module MyModule\n\n   def MyModule.run()\n      puts \"#{self}: running\"\n   end\n\n   def run()\n      puts \"#{self}: running\"\n   end\n\n\nend\n\nclass Foo\n  include MyModule\nend\n\nMyModule.run #MyModule: running\nfoo = Foo.new\nfoo.run #&lt;Foo:0x007f9b269bf028&gt;: running\n</code></pre>\n\n<p>In the first usage, the module is basically just acting as a namespace to which you attach a method.\nIn the second, the module is <em>mixed in</em> to the class <code>Foo</code>. This means that it acts as if the <code>run</code> method was defined within the foo class in the first place; you could, if you wished, refer to instance variables <code>@bar</code> which aren't defined in the module, but only in the <code>Foo</code> class.</p>\n"}], "owner": {"reputation": 2960, "user_id": 7426461, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/Ldwxy.jpg?s=128&g=1", "display_name": "Cannon Moyer", "link": "https://stackoverflow.com/users/7426461/cannon-moyer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 242, "favorite_count": 0, "accepted_answer_id": 48544664, "answer_count": 4, "score": 3, "last_activity_date": 1517577128, "creation_date": 1517408645, "last_edit_date": 1517430923, "question_id": 48544474, "link": "https://stackoverflow.com/questions/48544474/meaning-of-syntax-for-ruby-module", "title": "Meaning of Syntax for Ruby Module", "body": "<p>I've been going through some tutorials to find this information, but haven't seen anything that directly addresses it.</p>\n\n<p>I've seen several times on modules the following syntax:</p>\n\n<pre><code>module MyModule\n\n   def run()\n      puts \"running\"\n   end\nend\n</code></pre>\n\n<p>I've also seen syntax that looks like this:</p>\n\n<pre><code>module MyModule\n\n   def MyModule.run()\n      puts \"running\"\n   end\nend\n</code></pre>\n\n<p>What's the advantage to including the module name before the method and vice versa?</p>\n"}, {"tags": ["ruby", "chef-infra", "erb"], "answers": [{"tags": [], "owner": {"reputation": 43208, "user_id": 78722, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cf611565f0b79abd0b3dc200ad867661?s=128&d=identicon&r=PG", "display_name": "coderanger", "link": "https://stackoverflow.com/users/78722/coderanger"}, "is_accepted": false, "score": 0, "last_activity_date": 1517428671, "creation_date": 1517428671, "answer_id": 48550462, "question_id": 48544160, "link": "https://stackoverflow.com/questions/48544160/chef-kitchen-how-to-generate-from-a-template-locally-without-creating-the-v/48550462#48550462", "title": "Chef / kitchen - how to generate from a template locally (without creating the VM)", "body": "<p>This is not possible. Chef only operates in the context of converging a node. You could write your own code generator of some kind, but it would be unrelated to Chef for the most part (though you might be able to jury rig <code>chef-apply</code> into being helpful, maybe?).</p>\n"}], "owner": {"reputation": 36698, "user_id": 145989, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/d0edf9d0f312ec47d27046845580ba4f?s=128&d=identicon&r=PG", "display_name": "Ondra \u017di\u017eka", "link": "https://stackoverflow.com/users/145989/ondra-%c5%bdi%c5%beka"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 128, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1517428671, "creation_date": 1517407782, "last_edit_date": 1517418497, "question_id": 48544160, "link": "https://stackoverflow.com/questions/48544160/chef-kitchen-how-to-generate-from-a-template-locally-without-creating-the-v", "title": "Chef / kitchen - how to generate from a template locally (without creating the VM)", "body": "<p>I have a Chef cookbook. One of it's goals is to generate configuration file from a <code>.erb</code> template. That's done as one goal in a recipe, and the template input map is filled from the <code>node</code> tree.</p>\n\n<pre><code>template node['bbcpd-bpds-api']['api_config_path'] do\n  source \"opt/bpds-api/conf/api/bpds-api.yml.erb\"\n  mode 0644\n  owner node['bbcpd-bpds-api']['user']\n  group node['bbcpd-bpds-api']['group']\n  variables(\n      :application_protocol =&gt; node['bbcpd-bpds-api']['application_protocol'],\n      :application_port =&gt; node['bbcpd-bpds-api']['application_port'],\n  ...\n</code></pre>\n\n<p>I would like to generate this template <strong>locally</strong> (i.e. to the dir with the cookbook source) without all the other actions which prepare a virtual machine.</p>\n\n<p>Basically, I would like to have something parse the files in <code>/attributes</code> and prepare the <code>node</code> tree and then only run the ERB templating engine, without invoking <code>kitchen converge</code>. Or ideally, <code>kitchen</code> altogether. The preferred target environment is Java / JRuby / Maven.</p>\n\n<p>Is that possible? Or is my best shot to separate the recipe with the template  goal above and to call <code>kitchen converge</code> with only that recipe? How to do that?</p>\n\n<p>See <a href=\"https://docs.chef.io/ctl_kitchen.html#syntax\" rel=\"nofollow noreferrer\">Kitchen commands docs</a>.<br>\nI can only see <code>kitchen converge PLATFORM</code> as an option - I could add a suite. But I don't know what then.</p>\n\n<p>There's also <a href=\"https://docs.chef.io/run_lists.html\" rel=\"nofollow noreferrer\"><code>run_lists</code></a>. But I don't see an explanation of what is run by what form of the runlist entry.</p>\n"}, {"tags": ["ruby", "erb"], "answers": [{"comments": [{"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1517408215, "post_id": 48544242, "comment_id": 84083736, "body": "Ah, THAT is what they meant."}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1517408493, "post_id": 48544242, "comment_id": 84083962, "body": "I think the second one will cause syntax error issues because it will still try to evaluate the nested <code>&lt;% ... %&gt;</code>. That being said if the variable <code>unsubscribe</code> is set to the string <code>&quot;&lt;% unsubscribe %&gt;&quot;</code> it will work fine"}], "tags": [], "owner": {"reputation": 2072, "user_id": 853065, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/aa14452cb8fbbc5b22c10c567ce710d8?s=128&d=identicon&r=PG", "display_name": "yoones", "link": "https://stackoverflow.com/users/853065/yoones"}, "is_accepted": true, "score": 4, "last_activity_date": 1517408239, "last_edit_date": 1517408239, "creation_date": 1517408037, "answer_id": 48544242, "question_id": 48544071, "link": "https://stackoverflow.com/questions/48544071/erb-render-expression-as-string/48544242#48544242", "title": "ERB render expression as string", "body": "<p>Short answer is no. You either:</p>\n\n<ol>\n<li>replace <code>&lt;</code> and <code>&gt;</code> with the equivalent html codes <code>&amp;lt;</code> and <code>&amp;gt;</code>, which looks like <code>&amp;lt;% unsubscribe %&amp;gt;</code>,</li>\n</ol>\n\n<p>or</p>\n\n<ol start=\"2\">\n<li>make your ruby statement print the string: <code>&lt;%= '&lt;% subscribe %&gt;' %&gt;</code></li>\n</ol>\n"}], "owner": {"reputation": 4039, "user_id": 2954587, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/9faba4c8f1437084ee1b2b976eeadaa3?s=128&d=identicon&r=PG&f=1", "display_name": "user2954587", "link": "https://stackoverflow.com/users/2954587/user2954587"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 74, "favorite_count": 0, "accepted_answer_id": 48544242, "answer_count": 1, "score": 0, "last_activity_date": 1517408239, "creation_date": 1517407523, "question_id": 48544071, "link": "https://stackoverflow.com/questions/48544071/erb-render-expression-as-string", "title": "ERB render expression as string", "body": "<p>Is it possible to not render a specific tag as ruby and instead as a string? The erb template is called using <code>ApplicationController.new.render_to_string()</code></p>\n\n<p>For example: </p>\n\n<p>I'd like to have a tag <code>&lt;% unsubscribe %&gt;</code> render to <code>&lt;% unsubscribe %&gt;</code> instead of trying to evaluate the variable <code>unsubscribe</code>. However, for all other tags I'd like it to render as normal. </p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 8640, "user_id": 4055042, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/cd04c63d95d27033b53d4d83fea40c02?s=128&d=identicon&r=PG&f=1", "display_name": "SRack", "link": "https://stackoverflow.com/users/4055042/srack"}, "edited": false, "score": 0, "creation_date": 1517402599, "post_id": 48542280, "comment_id": 84079882, "body": "I&#39;m a little unclear on what you&#39;re asking here - the error looks related to a url, yet you&#39;re referencing assigning a <code>port</code> to an <code>entry</code> elsewhere. Happy to take a look if you&#39;re able to clarify things a little?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user7631988"}, "reply_to_user": {"reputation": 8640, "user_id": 4055042, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/cd04c63d95d27033b53d4d83fea40c02?s=128&d=identicon&r=PG&f=1", "display_name": "SRack", "link": "https://stackoverflow.com/users/4055042/srack"}, "edited": false, "score": 1, "creation_date": 1517402840, "post_id": 48542280, "comment_id": 84080038, "body": "I use a form to create a new entry, a textfield to enter an Url -&gt; creates new Url object. so its related. The same form is used to edit the entry. but if I try to edit the related Url in the form (entering in the texfield) I cant save the entry correctly, as you see."}, {"owner": {"reputation": 8640, "user_id": 4055042, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/cd04c63d95d27033b53d4d83fea40c02?s=128&d=identicon&r=PG&f=1", "display_name": "SRack", "link": "https://stackoverflow.com/users/4055042/srack"}, "edited": false, "score": 0, "creation_date": 1517402886, "post_id": 48542280, "comment_id": 84080066, "body": "Gotcha, cheers @vaekek"}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user7631988"}, "edited": false, "score": 0, "creation_date": 1517403546, "post_id": 48542764, "comment_id": 84080485, "body": "Thanks! I want to update the related URL via the entry&#39;s form(not to create a new one and relate it to the new one, as I do atm). the entry belongs to an url(so there is a colum &quot;url_id&quot;).  @SRack"}, {"owner": {"reputation": 8640, "user_id": 4055042, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/cd04c63d95d27033b53d4d83fea40c02?s=128&d=identicon&r=PG&f=1", "display_name": "SRack", "link": "https://stackoverflow.com/users/4055042/srack"}, "edited": false, "score": 0, "creation_date": 1517403634, "post_id": 48542764, "comment_id": 84080538, "body": "OK great - that should be the latter approach highlighted there. I&#39;ll pop a little more info in my question in a min!"}, {"owner": {"user_type": "does_not_exist", "display_name": "user7631988"}, "edited": false, "score": 0, "creation_date": 1517405472, "post_id": 48542764, "comment_id": 84081765, "body": "I did it that way: <code>@entry.url.name = params[:entry][:url]   @entry.url.save</code> in the controller, but in the view, now I got errors in the create action because I can&#39;t refer to a null object. but how can I display the value then correctly? see my question how i render the view."}, {"owner": {"reputation": 8640, "user_id": 4055042, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/cd04c63d95d27033b53d4d83fea40c02?s=128&d=identicon&r=PG&f=1", "display_name": "SRack", "link": "https://stackoverflow.com/users/4055042/srack"}, "edited": false, "score": 0, "creation_date": 1517408276, "post_id": 48542764, "comment_id": 84083779, "body": "I&#39;ve updated my answer to reflect this @vaekek - if the entry doesn&#39;t have a url already, you&#39;ll need to build one in the controller so it&#39;s available in <code>fields_for</code>. Give that a go and see if it helps :)"}, {"owner": {"reputation": 8640, "user_id": 4055042, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/cd04c63d95d27033b53d4d83fea40c02?s=128&d=identicon&r=PG&f=1", "display_name": "SRack", "link": "https://stackoverflow.com/users/4055042/srack"}, "edited": false, "score": 0, "creation_date": 1517410556, "post_id": 48542764, "comment_id": 84085580, "body": "Great, glad to hear it!"}], "tags": [], "owner": {"reputation": 8640, "user_id": 4055042, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/cd04c63d95d27033b53d4d83fea40c02?s=128&d=identicon&r=PG&f=1", "display_name": "SRack", "link": "https://stackoverflow.com/users/4055042/srack"}, "is_accepted": true, "score": 0, "last_activity_date": 1517408225, "last_edit_date": 1517408225, "creation_date": 1517403419, "answer_id": 48542764, "question_id": 48542280, "link": "https://stackoverflow.com/questions/48542280/change-params-value-before-patch/48542764#48542764", "title": "change params value before patch", "body": "<p>There are two approaches I can think of here, depending on exactly what you're looking to achieve.</p>\n\n<p>If you're looking to assign an <code>entry</code> a new <code>url</code> based on a string params, you can use something like the following:</p>\n\n<p><code>@entry.url = Url.find_by_name(params[:entry][:url])</code></p>\n\n<p>Depending on your models' setup, if there's a <code>url_id</code> column on your entries, you might be better off using a <code>select</code> field on this, passing the URL's name and id to the options. If you can add this info to your question, I can update / rule this out as needed.</p>\n\n<p>If you're just looking to update the URL via the entry's form, you'd be best looking at using <a href=\"http://api.rubyonrails.org/classes/ActiveRecord/NestedAttributes/ClassMethods.html\" rel=\"nofollow noreferrer\">accepts_nested_attributes_for</a>.</p>\n\n<p>Doing this, you can directly update the associated objects through the parent's form. If this sounds like the right approach for you, let me know and I can provide more detail :)</p>\n\n<p>Edit: as per your comment, is sounds like this is the option you're after. So, you'd need something like the following:</p>\n\n<p><strong>entry.rb</strong></p>\n\n<pre><code>accepts_nested_attributes_for :url\n</code></pre>\n\n<p>In the form:</p>\n\n<pre><code>...\nf.nested_fields_for :url do |url_fields|\n  url_fields.text_field :name\nend\n...\n</code></pre>\n\n<p>And you'll need to update the params in your controller to accept these nested fields. I can't remember the exact for they take, but it's something like:</p>\n\n<pre><code>def new / edit # whichever you're in \n  ...\n  @entry.build_url unless @entry.url.present?\nend\n\ndef entry_params\n  params.require(:entry).permit(:description,:rule_id, :protocol_id,   \n  :port, url_attributes: [:name])\nend\n</code></pre>\n\n<p>(It might be you need an empty array or a hash for <code>url_attributes</code>.)</p>\n\n<p>That'll then directly update the associated url. FYI if you've not got an associated URL, you'll need to build one using <code>@entry.build_url</code> in the controller.</p>\n\n<p>Hope this helps - if you've any questions / details to help clarify, let me know and I'll update as needed.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user7631988"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 50, "favorite_count": 0, "accepted_answer_id": 48542764, "answer_count": 1, "score": 1, "last_activity_date": 1517408225, "creation_date": 1517401875, "last_edit_date": 1517401942, "question_id": 48542280, "link": "https://stackoverflow.com/questions/48542280/change-params-value-before-patch", "title": "change params value before patch", "body": "<p>I have a texfield in a form where a foreign key's value is displayed. now I want to update the value and save it to the DB. Here is the code: </p>\n\n<p>for the form I use: </p>\n\n<pre><code>  f.text_field :port, :value =&gt;@entry.port.number, class:\"form-\n  control\", placeholder:\"Port\" \n</code></pre>\n\n<p>in the controller I am using a param method:</p>\n\n<pre><code>def entry_params\n  params.require(:entry).permit(:description,:rule_id, :protocol_id,   \n  :url, :port)\nend\n</code></pre>\n\n<p>the update method looks like this: </p>\n\n<pre><code>def update\n  @entry.url.name = params[:entry][:url]\n  @entry.port.number = params[:entry][:port]\n  if @entry.update(entry_params)\n    flash[:success] = \"Entry was successfully updated!\"\n    redirect_to entry_path(@entry)\n  else\n    render 'edit'\n  end\nend\n</code></pre>\n\n<p>but if I want try to save it, it shows this error: </p>\n\n<pre><code>Url(#70247237379440) expected, got \"www.drive.google.com\" which is an \ninstance of String(#70247218839280)\n</code></pre>\n\n<p>Now my question is, (I'm relativ new to rails) how can I fix this? I know that it expect an object as a parameter but if I change the param like this: </p>\n\n<pre><code>params[:url] = @entry.url\n</code></pre>\n\n<p>it doesn't work.</p>\n"}, {"tags": ["css", "ruby-on-rails", "ruby", "twitter-bootstrap"], "comments": [{"owner": {"reputation": 13039, "user_id": 8270343, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2d2db77e80ad405e70798962f7f89d67?s=128&d=identicon&r=PG&f=1", "display_name": "WebDevBooster", "link": "https://stackoverflow.com/users/8270343/webdevbooster"}, "edited": false, "score": 4, "creation_date": 1517402002, "post_id": 48542257, "comment_id": 84079518, "body": "The latest version of Bootstrap is 4.0.0. It will break your layout if you don&#39;t manually adjust things because B4 is totally incompatible with B3."}], "answers": [{"tags": [], "owner": {"reputation": 3320, "user_id": 4950680, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/C8cEh.jpg?s=128&g=1", "display_name": "Martin Zinovsky", "link": "https://stackoverflow.com/users/4950680/martin-zinovsky"}, "is_accepted": false, "score": 1, "last_activity_date": 1517406916, "creation_date": 1517406916, "answer_id": 48543862, "question_id": 48542257, "link": "https://stackoverflow.com/questions/48542257/upgrading-bootstrap-version-twitter-bootstrap-rails/48543862#48543862", "title": "Upgrading bootstrap version - twitter-bootstrap-rails", "body": "<p>There are several options:</p>\n\n<ol>\n<li><p>You can fork <a href=\"https://github.com/seyhunak/twitter-bootstrap-rails\" rel=\"nofollow noreferrer\">twitter-bootstrap-rails gem</a>, update BS to version 4 and edit your <code>Gemfile</code>: </p>\n\n<pre><code>gem 'twitter-bootstrap-rails', git: 'link_to_your_fork'\n</code></pre></li>\n<li><p>You can migrate to <a href=\"https://github.com/twbs/bootstrap-rubygem\" rel=\"nofollow noreferrer\">bootstrap-rubygem</a> gem instead which uses BS4</p></li>\n<li><p>You can download latest version of BS from <a href=\"https://getbootstrap.com/\" rel=\"nofollow noreferrer\">official site</a> and manually put <code>.js</code> and <code>.css</code> files to <code>./vendor/assets/</code> directory. Look at these SO answers for reference: <a href=\"https://stackoverflow.com/questions/37580325/rails-4-how-to-reference-a-javascript-source-in-vendor-file\">first</a> and <a href=\"https://stackoverflow.com/questions/25983283/how-to-load-vendor-asset-folder-in-rails-4\">second</a></p></li>\n</ol>\n\n<p>For options 2 and 3 make sure you dont use helper methods in your code which <a href=\"https://github.com/seyhunak/twitter-bootstrap-rails/tree/master/app/helpers\" rel=\"nofollow noreferrer\">twitter-bootstrap-rails gem provides</a></p>\n"}], "owner": {"reputation": 1588, "user_id": 723334, "user_type": "registered", "accept_rate": 49, "profile_image": "https://i.stack.imgur.com/Yoz09.jpg?s=128&g=1", "display_name": "prajeesh", "link": "https://stackoverflow.com/users/723334/prajeesh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 400, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1517406916, "creation_date": 1517401801, "question_id": 48542257, "link": "https://stackoverflow.com/questions/48542257/upgrading-bootstrap-version-twitter-bootstrap-rails", "title": "Upgrading bootstrap version - twitter-bootstrap-rails", "body": "<p>I am using bootstrap gem in my project.</p>\n\n<pre><code>gem 'twitter-bootstrap-rails'\n</code></pre>\n\n<p>The bootstrap version that i have now is </p>\n\n<pre><code>/*! normalize.css v3.0.1 | MIT License | git.io/normalize */\n</code></pre>\n\n<p>I need to upgrade to latest bootstrap version.</p>\n\n<p>It seems like the bootstrap version is not updated in the gem (<a href=\"https://github.com/seyhunak/twitter-bootstrap-rails/blob/master/app/assets/stylesheets/twitter-bootstrap-static/bootstrap.css.erb\" rel=\"nofollow noreferrer\">https://github.com/seyhunak/twitter-bootstrap-rails/blob/master/app/assets/stylesheets/twitter-bootstrap-static/bootstrap.css.erb</a>).</p>\n\n<p>How can i upgrade the version in my application?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-3", "cucumber", "factory-bot"], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 8561993, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b61d71d3a87a862783c395b7e9e041a1?s=128&d=identicon&r=PG&f=1", "display_name": "Archana Rajakumar", "link": "https://stackoverflow.com/users/8561993/archana-rajakumar"}, "edited": false, "score": 0, "creation_date": 1517477764, "post_id": 48540434, "comment_id": 84114436, "body": "Thank you guy ,but &quot;Unable to find visible field &quot;signuser_email&quot; that is not disabled (Capybara::ElementNotFound)&quot; this above error is displayed. Please help anyone"}, {"owner": {"reputation": 4216, "user_id": 9269043, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a2763bcfa8917a365c88f8639494de7?s=128&d=identicon&r=PG", "display_name": "Vasilisa", "link": "https://stackoverflow.com/users/9269043/vasilisa"}, "reply_to_user": {"reputation": 11, "user_id": 8561993, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b61d71d3a87a862783c395b7e9e041a1?s=128&d=identicon&r=PG&f=1", "display_name": "Archana Rajakumar", "link": "https://stackoverflow.com/users/8561993/archana-rajakumar"}, "edited": false, "score": 0, "creation_date": 1517483424, "post_id": 48540434, "comment_id": 84118262, "body": "I&#39;m a girl, not a guy :) Do you have in your view an input field with name, id or label text &quot;signuser_email&quot;? <code>fill_in</code> method works via fields name, id or label text, so you need to use a correct one."}, {"owner": {"reputation": 11, "user_id": 8561993, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b61d71d3a87a862783c395b7e9e041a1?s=128&d=identicon&r=PG&f=1", "display_name": "Archana Rajakumar", "link": "https://stackoverflow.com/users/8561993/archana-rajakumar"}, "edited": false, "score": 0, "creation_date": 1517816423, "post_id": 48540434, "comment_id": 84232043, "body": "Sorry, Vasilisa  In view/registration/new.html.erb    &lt;div class=&quot;field&quot;&gt;     &lt;%= f.label :email %&gt;&lt;br /&gt;     &lt;%= f.email_field :email, autofocus: true %&gt;   &lt;/div&gt; When use a fill_in &#39;email&#39;,with:Signuser.last.email   Above same error shown"}], "tags": [], "owner": {"reputation": 4216, "user_id": 9269043, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a2763bcfa8917a365c88f8639494de7?s=128&d=identicon&r=PG", "display_name": "Vasilisa", "link": "https://stackoverflow.com/users/9269043/vasilisa"}, "is_accepted": false, "score": 1, "last_activity_date": 1517396126, "creation_date": 1517396126, "answer_id": 48540434, "question_id": 48539944, "link": "https://stackoverflow.com/questions/48539944/how-to-access-a-created-factory-bot-value-in-cucumber-step-definitions/48540434#48540434", "title": "How to access a created factory bot value in cucumber step definitions?", "body": "<p>You need to create the user in the <code>Given</code> block</p>\n\n<pre><code>Given /^a user with email \"(.+)\"$/ do |email|\n  FactoryBot.create(:user, email: 'user')\nend\n</code></pre>\n\n<p>And after it you can use this user in your step</p>\n\n<pre><code>When (/^enter exists details for Register$/)do\n  fill_in 'user_email', with: User.last.email\nend\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 8561993, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b61d71d3a87a862783c395b7e9e041a1?s=128&d=identicon&r=PG&f=1", "display_name": "Archana Rajakumar", "link": "https://stackoverflow.com/users/8561993/archana-rajakumar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 632, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1517396126, "creation_date": 1517394638, "last_edit_date": 1517394917, "question_id": 48539944, "link": "https://stackoverflow.com/questions/48539944/how-to-access-a-created-factory-bot-value-in-cucumber-step-definitions", "title": "How to access a created factory bot value in cucumber step definitions?", "body": "<p>I m new to factory bot and cucumber,\nHow to access a created record using factory_bot in step definition?\ntest/factories.rb </p>\n\n<pre><code>FactoryBot.define do\n  factory :signuser do\n    email  'abcd1123@test.xyz'\n    password   'test123'\n    password_confirmation 'test123'\n  end\nend\n\n\n#In console\nFactoryBot.create(:signuser)\n\n#features/test_step.rb\n\nWhen (/^enter exists details for Register$/)do\n#I want to access email \"abcd1123@test.xyz\" and password \"test123\" here in textfield\nend\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "metaprogramming"], "comments": [{"owner": {"reputation": 1196, "user_id": 8426717, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-QwYD3zUWkhA/AAAAAAAAAAI/AAAAAAAABJs/2y8hDOo4fYY/photo.jpg?sz=128", "display_name": "Tai", "link": "https://stackoverflow.com/users/8426717/tai"}, "edited": false, "score": 0, "creation_date": 1517393888, "post_id": 48538755, "comment_id": 84074388, "body": "Which rails version are you using?"}, {"owner": {"reputation": 1120, "user_id": 2493018, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/dfa6ee4d8a0c69bb657149627044995e?s=128&d=identicon&r=PG", "display_name": "swilgosz", "link": "https://stackoverflow.com/users/2493018/swilgosz"}, "reply_to_user": {"reputation": 1196, "user_id": 8426717, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-QwYD3zUWkhA/AAAAAAAAAAI/AAAAAAAABJs/2y8hDOo4fYY/photo.jpg?sz=128", "display_name": "Tai", "link": "https://stackoverflow.com/users/8426717/tai"}, "edited": false, "score": 0, "creation_date": 1517574262, "post_id": 48538755, "comment_id": 84161645, "body": "I&#39;m using version of rails: 5.0.2"}], "answers": [{"comments": [{"owner": {"reputation": 1120, "user_id": 2493018, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/dfa6ee4d8a0c69bb657149627044995e?s=128&d=identicon&r=PG", "display_name": "swilgosz", "link": "https://stackoverflow.com/users/2493018/swilgosz"}, "edited": false, "score": 0, "creation_date": 1517434692, "post_id": 48539123, "comment_id": 84099954, "body": "This is amazing and really interesting position. It did helped with my problem and I made use of it even If I decided to go with simpler solution. However 7stud&#39;s answer was the one that deservers approval I really appreciate this one!"}], "tags": [], "owner": {"reputation": 32451, "user_id": 2516474, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a2179a340c0e84edc285d432211145d?s=128&d=identicon&r=PG", "display_name": "SteveTurczyn", "link": "https://stackoverflow.com/users/2516474/steveturczyn"}, "is_accepted": false, "score": 4, "last_activity_date": 1517392271, "creation_date": 1517392271, "answer_id": 48539123, "question_id": 48538755, "link": "https://stackoverflow.com/questions/48538755/eager-load-all-classes-before-routes-rb-being-loaded/48539123#48539123", "title": "Eager load all classes before routes.rb being loaded", "body": "<p>I'd recommend you to Michael Lang's blog entry </p>\n\n<p><a href=\"http://codeconnoisseur.org/ramblings/creating-dynamic-routes-at-runtime-in-rails-4\" rel=\"nofollow noreferrer\">http://codeconnoisseur.org/ramblings/creating-dynamic-routes-at-runtime-in-rails-4</a></p>\n\n<p>His example uses a <code>load</code> method to add entries to your Appplication.routes and then uses a <code>reload</code> method to activate the new routings.</p>\n\n<pre><code>class DynamicRouter\n  def self.load\n    ComingSoon::Application.routes.draw do\n      Page.all.each do |pg|\n        puts \"Routing #{pg.name}\"\n        get \"/#{pg.name}\", :to =&gt; \"pages#show\", defaults: { id: pg.id }\n      end\n    end\n  end\n\n  def self.reload\n    ComingSoon::Application.routes_reloader.reload!\n  end\nend\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1120, "user_id": 2493018, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/dfa6ee4d8a0c69bb657149627044995e?s=128&d=identicon&r=PG", "display_name": "swilgosz", "link": "https://stackoverflow.com/users/2493018/swilgosz"}, "edited": false, "score": 0, "creation_date": 1517434493, "post_id": 48540829, "comment_id": 84099842, "body": "Lool, thanks for that awesome debugging! I was mistaken then, as I tried the <code>rake routes</code> to see if routes are properly generated. Seems I learned a lot thanks to you ;)"}], "tags": [], "owner": {"reputation": 41846, "user_id": 926143, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/3396173c3d22988be1a0732d184902aa?s=128&d=identicon&r=PG", "display_name": "7stud", "link": "https://stackoverflow.com/users/926143/7stud"}, "is_accepted": true, "score": 1, "last_activity_date": 1517401096, "last_edit_date": 1517401096, "creation_date": 1517397305, "answer_id": 48540829, "question_id": 48538755, "link": "https://stackoverflow.com/questions/48538755/eager-load-all-classes-before-routes-rb-being-loaded/48540829#48540829", "title": "Eager load all classes before routes.rb being loaded", "body": "<blockquote>\n  <p>At this point when routes.rb file is loaded, Widget.available_types is\n  empty.</p>\n</blockquote>\n\n<p>I'm not seeing that. Your code seems to work fine for me once I change the name of the class from <code>Widget::a</code> to <code>Widget::Dog</code> to prevent a couple of errors. I also found that I had to kill my terminal window between code changes or else <code>rails c</code> would not reflect my code changes and sometimes would show that <code>Widget.available_types</code> was empty.  </p>\n\n<p>If I add a line to your <code>namespace</code> block in <code>routes.rb</code>:</p>\n\n<pre><code>  namespace :widgets do\n    puts \"[ME]: #{Widget.available_types}\"  #&lt;==== HERE\n\n    Widget.available_types.keys.each do |widget_type|\n      resources widget_type.to_s.pluralize\n    end\n\n  end\n</code></pre>\n\n<p>then do <code>rails s</code>, I see the following output in the server window :</p>\n\n<pre><code>~/rails_projects/myapp2018$ rails s\n=&gt; Booting Puma\n=&gt; Rails 5.1.4 application starting in development \n=&gt; Run `rails server -h` for more startup options\n[ME]: {:dog=&gt;Widget::Dog (call 'Widget::Dog.connection' to establish a connection)}\n...\n...\n</code></pre>\n\n<p>That shows that <code>Widgets.available_types</code> is not empty. And in fact, if I enter the following url in my browser:</p>\n\n<pre><code>http://0.0.0.0:3000/widgets/dogs/show\n</code></pre>\n\n<p>I am taken to the view <code>views/widgets/dogs/show.html.erb</code>.  And if I comment out your namespace block in <code>routes.rb</code>, I get a routing error.  I think that demonstrates that your code successfully creates dynamic routes.</p>\n\n<p>If I kill my terminal window, and then do <code>rails c</code>, I also see that <code>Widgets.available_types</code> is not empty:</p>\n\n<pre><code>$ rails c\n[ME] Widgets.availabe_types: {:dog=&gt;Widget::Dog (call 'Widget::Dog.connection' to establish a connection)}\nRunning via Spring preloader in process 22753\nLoading development environment (Rails 5.1.4)\n2.4.0 :001 &gt; \n</code></pre>\n\n<p>On the other hand, if I do:</p>\n\n<pre><code>$ rake routes\n</code></pre>\n\n<p>I get:</p>\n\n<pre><code>[ME] Widgets.availabe_types: {}\nPrefix Verb URI Pattern                Controller#Action\n       GET  /support(/*all)(.:format)  redirect(301, path: /contact/%{all})\n       GET  /contact(/*path)(.:format) contacts#show\n</code></pre>\n\n<p>That does show that <code>Widgets.available_types</code> is empty.  I'm not sure why that is.</p>\n"}], "owner": {"reputation": 1120, "user_id": 2493018, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/dfa6ee4d8a0c69bb657149627044995e?s=128&d=identicon&r=PG", "display_name": "swilgosz", "link": "https://stackoverflow.com/users/2493018/swilgosz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 302, "favorite_count": 0, "accepted_answer_id": 48540829, "answer_count": 2, "score": 0, "last_activity_date": 1517401096, "creation_date": 1517391150, "last_edit_date": 1517391801, "question_id": 48538755, "link": "https://stackoverflow.com/questions/48538755/eager-load-all-classes-before-routes-rb-being-loaded", "title": "Eager load all classes before routes.rb being loaded", "body": "<p>I'm trying to do some meta programming to dynamically define routes based on existing classes. </p>\n\n<p><strong>My goal</strong>: based on defined classes dynamically create proper routes.</p>\n\n<p>Here is the code:</p>\n\n<pre><code>app/models/widget.rb\n\nclass Widget &lt; ApplicationRecord\n  mattr_reader :available_types\n  class_variable_set(:@@available_types, {})\n\n  def self.type\n    available_types.key(name)\n  end\n\n  def self.register_type(key)\n    @@available_types[key] = self\n  end\nend\n\n\napp/models/widgets/a.rb\nclass Widget::a &lt; Widget\n  register_type :a\nend\n\n\nconfig/environments/development.rb\n...\nconfig.eager_load = true\n...\n</code></pre>\n\n<p>Now when I open the console, and type: <code>Widget.available_types</code> I immediately can see: <code>{ a: Widget::A }</code></p>\n\n<p>So now I'm trying to create routes:</p>\n\n<pre><code>config/routes.rb\nnamespace :widgets do\n  Widget.available_types.keys.each do |widget_type|\n    resources widget_type.to_s.pluralize\n  end\nend\n</code></pre>\n\n<p>Unfortunately that is not working.</p>\n\n<p>At this point when <code>routes.rb</code> file is loaded, <code>Widget.available_types</code> is empty.</p>\n\n<p>Adding this change to <code>routes.rb</code> make it working but it's not a solution</p>\n\n<pre><code>config/routes.rb\n\nWidget::A #manually call the class here. This makes code working but don't want that\n\nnamespace :widgets do\n  Widget.available_types.keys.each do |widget_type|\n    resources widget_type.to_s.pluralize\n  end\nend\n</code></pre>\n\n<p>So my question is: How to force rails to load all necessary classes before <code>routes.rb</code> file is loaded?</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 9066428, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/1fa8220329702e23fca7f66d38fd857e?s=128&d=identicon&r=PG&f=1", "display_name": "CountDubular", "link": "https://stackoverflow.com/users/9066428/countdubular"}, "is_accepted": false, "score": 0, "last_activity_date": 1517477351, "creation_date": 1517477351, "answer_id": 48559345, "question_id": 48538385, "link": "https://stackoverflow.com/questions/48538385/timed-out-waiting-for-response-to-id-namevisit-args/48559345#48559345", "title": "Timed out waiting for response to id, name:&quot;visit&quot;,&quot;args", "body": "<p>Issue was a JSphantom error pop up that occurred when running the test headless. </p>\n\n<p>Adding: <code>page.driver.restart if defined?(page.driver.restart)</code> to the after hook solved the issue. </p>\n"}], "owner": {"reputation": 1, "user_id": 9066428, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/1fa8220329702e23fca7f66d38fd857e?s=128&d=identicon&r=PG&f=1", "display_name": "CountDubular", "link": "https://stackoverflow.com/users/9066428/countdubular"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 254, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1517477351, "creation_date": 1517389935, "question_id": 48538385, "link": "https://stackoverflow.com/questions/48538385/timed-out-waiting-for-response-to-id-namevisit-args", "title": "Timed out waiting for response to id, name:&quot;visit&quot;,&quot;args", "body": "<p>First, I am aware of the fact that there are multiple questions asked about the same issue. However, I cannot seem to fix this with the suggested answers on those questions. I've tried: </p>\n\n<ul>\n<li>expect(page).to have_content</li>\n<li>Capybara.reset_sessions!</li>\n<li>page.driver.reset!</li>\n<li>Increased sleep time </li>\n<li>Updated all the gems </li>\n</ul>\n\n<p>None of these solutions appear to have an effect. The first couple of times running these hooks headless it runs fine, it is after the third time these TimeOuts start. Are there any other options I could try? </p>\n\n<blockquote>\n  <p>Timed out waiting for response to {\"id\":\"9b2de783-a6bc-4fc6-a0a2-1a0e17ead8b2\",\"name\":\"visit\",\"args\":[\"<a href=\"http://test.com/login\" rel=\"nofollow noreferrer\">http://test.com/login</a>\",30]}. It's possible that this happened because something took a very long time (for example a page load was slow). If so, setting the Poltergeist :timeout option to a higher value will help (see the docs for details). If increasing the timeout does not help, this is probably a bug in Poltergeist - please report it to the issue tracker. (Capybara::Poltergeist::TimeoutError)\n  ./features/support/hooks.rb:10:in `Before'</p>\n</blockquote>\n\n<p>Hook code: </p>\n\n<pre><code>$portal = 'http://test.com'\n\nBefore do |scenario|\n  if Capybara.javascript_driver == :selenium\n    page.driver.browser.manage.window.maximize\n    end\nend\n\nBefore('@portal_page_is_open') do\n  visit \"#{$portal}/login\"\n  expect(page).to have_content(\"Log in\")\nend\n\nBefore('@superuser_is_logged_in') do\n  fill_in '_username', :with =&gt; 'testsuperuser'\n  fill_in '_password', :with =&gt; 'Test1234'\n    click_on 'Log in'\n  sleep(5)\nend\n\nBefore('@player_is_found') do\n  expect(page).to have_content(\"Hi testsuperuser\")\n  advanced_search = find('#playerSearch &gt; div &gt; div.pull-right &gt; button.advanced-search.btn.btn-link.btn-small')\n  advanced_search.click\n  sleep(5)\n  fill_in 'playerSearch[customerSearch][firstName]', :with =&gt; $first_name\n  fill_in 'playerSearch[customerSearch][surname]', :with =&gt; $last_name\n  fill_in 'playerSearch[customerSearch][dateOfBirth]', :with =&gt; $date_of_birth\n  sleep(1)\n  click_on 'Search'\n  until page.has_no_content?('Processing request...')\n    sleep(5)\n  end\nend\n\nAfter do |scenario|\n  Cucumber.wants_to_quit = true if scenario.failed?\n  Capybara.current_driver = Capybara.default_driver\n  Capybara.reset_sessions!\n  sleep(10)\nend\n</code></pre>\n\n<p>Timeout settings: </p>\n\n<pre><code>   Capybara.register_driver :poltergeist do |app|\n      Capybara::Poltergeist::Driver.new(app, {debug: false})\n      Capybara::Poltergeist::Driver.new(app, timeout: 120)\n      Capybara::Poltergeist::Driver.new(app, {js_errors: false})\n end \n</code></pre>\n\n<p>Gem list: </p>\n\n<pre><code>ruby \"2.3.3\"\ngem \"rdoc\", \"6.0.1\"\ngem \"rspec\", \"3.7.0\"\ngem \"capybara\", \"2.17.0\"\ngem \"cucumber\", \"3.1.0\"\ngem \"selenium-webdriver\", \"3.8.0\"\ngem \"chronic\", \"0.10.2\"\ngem \"poltergeist\", \"1.17.0\"\ngem \"pg\", \"1.0.0\"\ngem \"rest-client\", \"2.0.0\"\ngem \"stomp\", \"1.4.4\"\ngem \"net-ssh\", \"3.2.0\"\ngem \"net-scp\", \"1.2.1\"\ngem \"savon\", \"2.11.1\"\ngem \"json\"\ngem \"rake\"\n</code></pre>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 4, "creation_date": 1517387728, "post_id": 48536950, "comment_id": 84070421, "body": "Another way to see <code>puts {}.class</code> is <code>puts do ; end.class</code>"}, {"owner": {"reputation": 9030, "user_id": 5101476, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JCQrl.jpg?s=128&g=1", "display_name": "ice\u30c4", "link": "https://stackoverflow.com/users/5101476/ice%e3%83%84"}, "edited": false, "score": 2, "creation_date": 1517392115, "post_id": 48536950, "comment_id": 84073116, "body": "Maybe parenthesis will help <code>puts(){} #=&gt; nil</code>, <code>nil.class #=&gt; NilClass</code>"}], "answers": [{"comments": [{"owner": {"reputation": 109029, "user_id": 2767755, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/BkC8q.jpg?s=128&g=1", "display_name": "Arup Rakshit", "link": "https://stackoverflow.com/users/2767755/arup-rakshit"}, "edited": false, "score": 0, "creation_date": 1524169890, "post_id": 48536981, "comment_id": 86875452, "body": "<code>puts</code> method always returns <code>nil</code>. Passing block, has no effect to it. So return value is <code>nil</code>."}], "tags": [], "owner": {"reputation": 48413, "user_id": 1279683, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1veuT.jpg?s=128&g=1", "display_name": "Marek Lipka", "link": "https://stackoverflow.com/users/1279683/marek-lipka"}, "is_accepted": false, "score": 20, "last_activity_date": 1517384644, "creation_date": 1517384644, "answer_id": 48536981, "question_id": 48536950, "link": "https://stackoverflow.com/questions/48536950/unexpected-behaviour-in-ruby-for-puts-class/48536981#48536981", "title": "Unexpected behaviour in Ruby for &quot;puts {}.class&quot;", "body": "<p><code>puts {}</code> is interpreted as <code>puts</code> method call with empty block passed into it, hence the empty result. <code>puts({}.class)</code> works as you expect. </p>\n"}, {"tags": [], "owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "is_accepted": true, "score": 15, "last_activity_date": 1517385418, "creation_date": 1517385418, "answer_id": 48537191, "question_id": 48536950, "link": "https://stackoverflow.com/questions/48536950/unexpected-behaviour-in-ruby-for-puts-class/48537191#48537191", "title": "Unexpected behaviour in Ruby for &quot;puts {}.class&quot;", "body": "<p>There are a couple things to understand:</p>\n\n<ol>\n<li><p>whenever a hash is the first argument to a method being called, you need to use parenthesis or remove the braces, otherwise ruby thinks it's a block. So <code>puts { foo: \"bar\" }</code> raises a syntax error, but <code>puts foo: \"bar\"</code>, <code>puts(foo: \"bar\")</code>, or <code>puts({foo: \"bar\"})</code> work fine.</p></li>\n<li><p>every method can be called with a block, however only some methods actually call the block. You can test it for yourself - <code>puts(1) { raise }</code> just outputs the number, and doesn't raise an error. <code>puts { 1 }</code> prints nothing, because the block isn't called. </p></li>\n<li><p>The <code>puts</code> method always returns nil. So when you say <code>puts {}.class</code>, that's basically the same as <code>puts.class</code>, which is NilClass</p></li>\n</ol>\n"}], "owner": {"reputation": 191, "user_id": 8252166, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4cec36277e93bae7b763a266a47a55c?s=128&d=identicon&r=PG", "display_name": "MEENAKSHI KUMARI", "link": "https://stackoverflow.com/users/8252166/meenakshi-kumari"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 677, "favorite_count": 2, "accepted_answer_id": 48537191, "answer_count": 2, "score": 15, "last_activity_date": 1517401529, "creation_date": 1517384551, "last_edit_date": 1517401529, "question_id": 48536950, "link": "https://stackoverflow.com/questions/48536950/unexpected-behaviour-in-ruby-for-puts-class", "title": "Unexpected behaviour in Ruby for &quot;puts {}.class&quot;", "body": "<pre><code>puts {}.class\n\n#=&gt; NilClass \n\nputs \"\".class\nString\n#=&gt; nil \n\nputs [].class\nArray\n#=&gt; nil\n</code></pre>\n\n<p>Why is <code>puts {}.class</code> not showing <code>Hash</code> as output and then <code>nil</code> like the others?</p>\n"}, {"tags": ["ruby", "mongodb"], "answers": [{"tags": [], "owner": {"reputation": 1521, "user_id": 7177640, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/21ab719e4dfae3533a20da4f52e5c9e7?s=128&d=identicon&r=PG", "display_name": "nattfodd", "link": "https://stackoverflow.com/users/7177640/nattfodd"}, "is_accepted": true, "score": 2, "last_activity_date": 1517390663, "creation_date": 1517390663, "answer_id": 48538602, "question_id": 48535320, "link": "https://stackoverflow.com/questions/48535320/cannot-add-new-value-to-mongodbs-bson-field-using-ruby/48538602#48538602", "title": "Cannot add new value to MongoDB&#39;s BSON field using Ruby", "body": "<p><code>$push</code> in ruby usually means global variable. So, all you need is to wrap $push operation into parentheses:</p>\n\n<pre><code>- client[:inventory].update_one({\"name\": doc}, {$push =&gt; {\"admins\" =&gt; identity}})\n+ client[:inventory].update_one({\"name\": doc}, {\"$push\" =&gt; {\"admins\" =&gt; identity}})\n</code></pre>\n\n<p>And you should be fine</p>\n"}], "owner": {"reputation": 2571, "user_id": 6822876, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/i6dGp.jpg?s=128&g=1", "display_name": "Carrein", "link": "https://stackoverflow.com/users/6822876/carrein"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 186, "favorite_count": 0, "accepted_answer_id": 48538602, "answer_count": 1, "score": 0, "last_activity_date": 1517390663, "creation_date": 1517377887, "question_id": 48535320, "link": "https://stackoverflow.com/questions/48535320/cannot-add-new-value-to-mongodbs-bson-field-using-ruby", "title": "Cannot add new value to MongoDB&#39;s BSON field using Ruby", "body": "<p>I have a document with the field <code>admins</code> and am looking to add new users into this field. The value for these new users is a simple number string.</p>\n\n<pre><code>def modify_admin(identity, doc)\n  ip_addr = \"127.0.0.1:27017\"\n  client = Mongo::Client.new([ip_addr], :database =&gt; \"camp\")\n  if doc[0] == 'r'\n    doc = doc[2..-1] \n    client[:inventory].update_one({\"name\": doc}, {$push =&gt; {\"admins\" =&gt; identity}})\n  client.close\nend\n</code></pre>\n\n<p>The collection I'm trying to add is in this line: <code>client[:inventory].update_one({\"name\": doc}, {$push =&gt; {\"admins\" =&gt; identity}})</code>,</p>\n\n<p>However I am running into the error <code>NilClass instances are not allowed as keys in a BSON document. (BSON::InvalidKey)</code>.</p>\n\n<p>I have tried different syntax for the <code>$push</code> method but nothing seems to work.</p>\n\n<p>My document structure is as follows, I'm using symbols as the field value.</p>\n\n<pre><code>document = {:name =&gt; build_array[1], :owner =&gt; identity, :admins =&gt; identity}\n</code></pre>\n\n<p>How can I add new values to the <code>:owner</code> field using Ruby?</p>\n"}, {"tags": ["ruby-on-rails", "json", "ruby", "ruby-on-rails-3", "rubygems"], "answers": [{"comments": [{"owner": {"reputation": 541, "user_id": 3423333, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/46ff6a177f0783b392cace549ec65a36?s=128&d=identicon&r=PG&f=1", "display_name": "Alexander Kozachenko", "link": "https://stackoverflow.com/users/3423333/alexander-kozachenko"}, "edited": false, "score": 0, "creation_date": 1517393502, "post_id": 48534774, "comment_id": 84074140, "body": "Unfortunately, not for me."}, {"owner": {"reputation": 61, "user_id": 8205478, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/44fe08c4d0ec0cb5755e0520d4bcf6f6?s=128&d=identicon&r=PG&f=1", "display_name": "DevMasterAryan", "link": "https://stackoverflow.com/users/8205478/devmasteraryan"}, "reply_to_user": {"reputation": 541, "user_id": 3423333, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/46ff6a177f0783b392cace549ec65a36?s=128&d=identicon&r=PG&f=1", "display_name": "Alexander Kozachenko", "link": "https://stackoverflow.com/users/3423333/alexander-kozachenko"}, "edited": false, "score": 0, "creation_date": 1517399846, "post_id": 48534774, "comment_id": 84078246, "body": "Try this steps 1.Remove Gem.lock file 2.Add gem &#39;json&#39; in gemfile 3.run bundle update command 4. run bundle install command    hope this will work"}, {"owner": {"reputation": 541, "user_id": 3423333, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/46ff6a177f0783b392cace549ec65a36?s=128&d=identicon&r=PG&f=1", "display_name": "Alexander Kozachenko", "link": "https://stackoverflow.com/users/3423333/alexander-kozachenko"}, "edited": false, "score": 0, "creation_date": 1517404350, "post_id": 48534774, "comment_id": 84081000, "body": "thank you for attention, but I tried it earlier and it did not help. Tried also to designate versions, but to no avail. I recreated project once again and it magically works now."}], "tags": [], "owner": {"reputation": 61, "user_id": 8205478, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/44fe08c4d0ec0cb5755e0520d4bcf6f6?s=128&d=identicon&r=PG&f=1", "display_name": "DevMasterAryan", "link": "https://stackoverflow.com/users/8205478/devmasteraryan"}, "is_accepted": false, "score": 0, "last_activity_date": 1517374934, "creation_date": 1517374934, "answer_id": 48534774, "question_id": 48534669, "link": "https://stackoverflow.com/questions/48534669/ruby-on-rails-bundler-could-not-find-compatible-versions-for-gem-json/48534774#48534774", "title": "Ruby On Rails: Bundler could not find compatible versions for gem &quot;json&quot;", "body": "<p>Just do </p>\n\n<pre><code>bundle update\n</code></pre>\n\n<p>It works for me</p>\n"}, {"comments": [{"owner": {"reputation": 541, "user_id": 3423333, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/46ff6a177f0783b392cace549ec65a36?s=128&d=identicon&r=PG&f=1", "display_name": "Alexander Kozachenko", "link": "https://stackoverflow.com/users/3423333/alexander-kozachenko"}, "edited": false, "score": 0, "creation_date": 1517393474, "post_id": 48535794, "comment_id": 84074118, "body": "Updated successfully, yet no effect. This is empty project."}], "tags": [], "owner": {"reputation": 749, "user_id": 3767348, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/evVot.jpg?s=128&g=1", "display_name": "veeresh yh", "link": "https://stackoverflow.com/users/3767348/veeresh-yh"}, "is_accepted": false, "score": 0, "last_activity_date": 1517380060, "creation_date": 1517380060, "answer_id": 48535794, "question_id": 48534669, "link": "https://stackoverflow.com/questions/48534669/ruby-on-rails-bundler-could-not-find-compatible-versions-for-gem-json/48535794#48535794", "title": "Ruby On Rails: Bundler could not find compatible versions for gem &quot;json&quot;", "body": "<p>When you run bundle update to update your gems, it updates all of them at once. If your app stops working or your tests start failing, it can be pretty hard to figure out which gem update broke it.</p>\n\n<p>You might think  <code>bundle update gem_name</code> would just update that gem and its dependencies .</p>\n\n<p>Note: <code>bundle update --source gem_name</code> Updates exclusively the gem</p>\n"}, {"comments": [{"owner": {"reputation": 541, "user_id": 3423333, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/46ff6a177f0783b392cace549ec65a36?s=128&d=identicon&r=PG&f=1", "display_name": "Alexander Kozachenko", "link": "https://stackoverflow.com/users/3423333/alexander-kozachenko"}, "edited": false, "score": 0, "creation_date": 1517415423, "post_id": 48546654, "comment_id": 84089029, "body": "sorry, can&#39;t check because re-created project from scratch, but point about load order seems reasonable. thank you"}], "tags": [], "owner": {"reputation": 1266, "user_id": 6022100, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/dc0adea29934c8ee1c31f96bf85a7fbc?s=128&d=identicon&r=PG", "display_name": "rwold", "link": "https://stackoverflow.com/users/6022100/rwold"}, "is_accepted": false, "score": 1, "last_activity_date": 1517415250, "creation_date": 1517415250, "answer_id": 48546654, "question_id": 48534669, "link": "https://stackoverflow.com/questions/48534669/ruby-on-rails-bundler-could-not-find-compatible-versions-for-gem-json/48546654#48546654", "title": "Ruby On Rails: Bundler could not find compatible versions for gem &quot;json&quot;", "body": "<p>Unfortunately I don't have enough rep to comment with a question, so I can't ask what version of json you specified when you added it to your gemfile explicitly or whereabouts in the gemfile you specified it (<a href=\"https://stackoverflow.com/questions/16724566/does-the-order-of-gems-in-your-gemfile-make-a-difference\">see this SO thread</a>). But my best guess is that one of your other dependencies is downloading <code>1.8.6</code>, which is not consistent with version <code>~&gt;1.7.7</code> specified by your version of Active Support. </p>\n\n<p>My suggestion would be to try and explicitly require </p>\n\n<pre><code>json (~&gt; 1.7, &gt;= 1.7.7)\n</code></pre>\n\n<p>at the <strong>end</strong> of your gemfile,  <a href=\"http://bundler.io/v1.16/man/gemfile.5.html#SOURCE-PRIORITY\" rel=\"nofollow noreferrer\"> before something else loads it</a>. If something else is trying to load a more recent version of <code>json</code>, you should get a different error message; you may have to then specify an earlier version of the gem trying to download a conflicting version.</p>\n"}], "owner": {"reputation": 541, "user_id": 3423333, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/46ff6a177f0783b392cace549ec65a36?s=128&d=identicon&r=PG&f=1", "display_name": "Alexander Kozachenko", "link": "https://stackoverflow.com/users/3423333/alexander-kozachenko"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1899, "favorite_count": 0, "answer_count": 3, "score": 3, "last_activity_date": 1517415250, "creation_date": 1517374064, "last_edit_date": 1517390027, "question_id": 48534669, "link": "https://stackoverflow.com/questions/48534669/ruby-on-rails-bundler-could-not-find-compatible-versions-for-gem-json", "title": "Ruby On Rails: Bundler could not find compatible versions for gem &quot;json&quot;", "body": "<p>I did search and none of the existing solutions worked for me, so I created a new question.</p>\n\n<p>Got an error trying to launch the server.</p>\n\n<blockquote>\n  <p>Bundler could not find compatible versions for gem \"json\":<br>\n  In snapshot (Gemfile.lock):<br>\n  json (= 1.8.6)  </p>\n  \n  <p>In Gemfile: rails (= 4.2.4) x86-mingw32 was resolved to 4.2.4,<br>\n  which depends on\n  activesupport (= 4.2.4) x86-mingw32 was resolved to 4.2.4,<br>\n  which depends on json (>= 1.7.7, ~> 1.7) x86-mingw32</p>\n</blockquote>\n\n<p>Gemfile\n     source '<a href=\"https://rubygems.org\" rel=\"nofollow noreferrer\">https://rubygems.org</a>'</p>\n\n<pre><code> gem 'rails', '4.2.4'\n gem 'activerecord-jdbcpostgresql-adapter'\n gem 'sass-rails', '~&gt; 5.0'\n gem 'uglifier', '&gt;= 1.3.0'\n gem 'coffee-rails', '~&gt; 4.1.0'\n gem 'therubyrhino'\n gem 'jquery-rails'\n gem 'jbuilder', '~&gt; 2.0'\n gem 'tzinfo-data', platforms: [:mingw, :mswin, :x64_mingw, :jruby]\n</code></pre>\n\n<p>Gemfile.lock fragment</p>\n\n<pre><code> GEM\n   remote: https://rubygems.org/\n   specs:\n  activesupport (4.2.4)\n       i18n (~&gt; 0.7)\n       json (~&gt; 1.7, &gt;= 1.7.7)\n       minitest (~&gt; 5.1)\n       thread_safe (~&gt; 0.3, &gt;= 0.3.4)\n       tzinfo (~&gt; 1.1)\n\n  json (1.8.6-java)\n</code></pre>\n\n<p>What I tried to do:</p>\n\n<ul>\n<li><p>Delete Gemfile.lock and run bundle install</p></li>\n<li><p>Add json to Gemfile</p></li>\n<li><p>Set both json in Gemfile.lock to 1.8.6-java</p></li>\n</ul>\n\n<blockquote>\n  <p>Bundler could not find compatible versions for gem \"json\":    In\n  snapshot (Gemfile.lock):<br>\n  json (= 1.8.6)  </p>\n  \n  <p>In Gemfile:<br>\n  rails (= 4.2.4) x86-mingw32 was resolved to 4.2.4,<br>\n  which depends on activesupport (= 4.2.4) x86-mingw32 was resolved to 4.2.4,<br>\n  which depends on   json (= 1.8.6) x86-mingw32</p>\n</blockquote>\n\n<p>Delete json (1.8.6-java)  from Gemfile.lock</p>\n\n<p>None of these worked.</p>\n"}, {"tags": ["ruby-on-rails", "arrays", "ruby", "ruby-on-rails-5"], "comments": [{"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1517374902, "post_id": 48534497, "comment_id": 84064870, "body": "Your &quot;Update&quot; statement lacks context. It would be preferable to make it a comment on one of the answers that uses <code>map</code>."}], "answers": [{"comments": [{"owner": {"reputation": 18856, "user_id": 1359650, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/dffc4318ac93e728a26c8e8b51b4eb37?s=128&d=identicon&r=PG", "display_name": "jvillian", "link": "https://stackoverflow.com/users/1359650/jvillian"}, "reply_to_user": {"reputation": 5836, "user_id": 1153022, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/JgpPs.jpg?s=128&g=1", "display_name": "okay56k", "link": "https://stackoverflow.com/users/1153022/okay56k"}, "edited": false, "score": 0, "creation_date": 1517373718, "post_id": 48534552, "comment_id": 84064530, "body": "Sorry. Sloppy late over here."}], "tags": [], "owner": {"reputation": 18856, "user_id": 1359650, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/dffc4318ac93e728a26c8e8b51b4eb37?s=128&d=identicon&r=PG", "display_name": "jvillian", "link": "https://stackoverflow.com/users/1359650/jvillian"}, "is_accepted": false, "score": 1, "last_activity_date": 1517379323, "last_edit_date": 1517379323, "creation_date": 1517373367, "answer_id": 48534552, "question_id": 48534497, "link": "https://stackoverflow.com/questions/48534497/efficient-way-to-convert-collection-to-array-of-hashes-for-render-json/48534552#48534552", "title": "Efficient way to convert collection to array of hashes for render json", "body": "<p>As a starting point, it should be closer to:    </p>\n\n<pre><code>def list\n  @photos = current_user.photos.map do |p|\n    {\n      id: p.id, label: p.name, url: p.uploaded_image.url(:small),\n      size: p.uploaded_image_file_size\n    }\n  end\n  render json: { results: @photos }\nend\n</code></pre>\n\n<p>Just for fun, you <em>could</em> do something like:</p>\n\n<pre><code>class PhotoDecorator &lt; SimpleDelegator\n\n    def attributes\n      %w(id label url size).each_with_object({}) do |attr, hsh|\n        hsh[attr.to_sym] = send(attr)\n      end\n    end\n\n    def label\n      name \n    end\n\n    def url\n      uploaded_image.url(:small)\n    end\n\n    def size\n      uploaded_image_file_size\n    end\n\nend\n</code></pre>\n\n<p>And then:</p>\n\n<pre><code>&gt; @photos = current_user.photos.map{ |photo| PhotoDecorator.new(photo).attributes }\n =&gt; [{:id=&gt;1, :label=&gt;\"some name\", :url=&gt;\"http://www.my_photos.com/123\", :size=&gt;\"256x256\"}, {:id=&gt;2, :label=&gt;\"some other name\", :url=&gt;\"http://www.my_photos/243\", :size=&gt;\"256x256\"}]\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2735, "user_id": 7006199, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kFqCJ.jpg?s=128&g=1", "display_name": "Nimish Gupta", "link": "https://stackoverflow.com/users/7006199/nimish-gupta"}, "is_accepted": false, "score": 1, "last_activity_date": 1517373683, "creation_date": 1517373683, "answer_id": 48534606, "question_id": 48534497, "link": "https://stackoverflow.com/questions/48534497/efficient-way-to-convert-collection-to-array-of-hashes-for-render-json/48534606#48534606", "title": "Efficient way to convert collection to array of hashes for render json", "body": "<p>Please try</p>\n\n<pre><code>def list\n  @photos = current_user.photos.map { |p| { id: p.id, label: p.name, url: p.uploaded_image.url(:small), size: p.uploaded_image_file_size } }\n  render json: { results: @photos }\nend\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 2, "creation_date": 1517375071, "post_id": 48534671, "comment_id": 84064924, "body": "It can be confusing to assign a method the name of one of Ruby&#39;s built-in methods (<code>map</code>)."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user9255572"}, "is_accepted": false, "score": 0, "last_activity_date": 1517382334, "last_edit_date": 1517382334, "creation_date": 1517374074, "answer_id": 48534671, "question_id": 48534497, "link": "https://stackoverflow.com/questions/48534497/efficient-way-to-convert-collection-to-array-of-hashes-for-render-json/48534671#48534671", "title": "Efficient way to convert collection to array of hashes for render json", "body": "<p>You can also do that like this</p>\n\n<pre><code>def array_list\n  @photos = current_user.photos.map { |p| { id: \n  p.id, label: p.name, url: p.uploaded_image.url(:small), size: p.uploaded_image_file_size } }\n  render json: { results: @photos }\nend\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 5836, "user_id": 1153022, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/JgpPs.jpg?s=128&g=1", "display_name": "okay56k", "link": "https://stackoverflow.com/users/1153022/okay56k"}, "edited": false, "score": 0, "creation_date": 1517443102, "post_id": 48534674, "comment_id": 84103216, "body": "This is probably the best since it keeps the MVC house in order."}], "tags": [], "owner": {"reputation": 38307, "user_id": 2057388, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ceef8c04f66cd0e2bd360ef6abc14a81?s=128&d=identicon&r=PG", "display_name": "\u0417\u0435\u043b\u0451\u043d\u044b\u0439", "link": "https://stackoverflow.com/users/2057388/%d0%97%d0%b5%d0%bb%d1%91%d0%bd%d1%8b%d0%b9"}, "is_accepted": true, "score": 3, "last_activity_date": 1517374091, "creation_date": 1517374091, "answer_id": 48534674, "question_id": 48534497, "link": "https://stackoverflow.com/questions/48534497/efficient-way-to-convert-collection-to-array-of-hashes-for-render-json/48534674#48534674", "title": "Efficient way to convert collection to array of hashes for render json", "body": "<ol>\n<li>Don't do it in the contoller</li>\n<li>Don't generate the json response with <code>map</code>, let's <code>as_json(*)</code> method do that for you.</li>\n<li>Don't use <code>@</code> variable in the json render.</li>\n<li>Don't use <code>{}.to_json</code> the <code>render json: {}</code> do it under the hood.</li>\n</ol>\n\n<p>in the photo model.</p>\n\n<pre><code>def as_json(*)\n  super(only: [:id], methods: [:label, :url, :size])\nend\nalias label name\n\ndef size\n  uploaded_image_file_size\nend    \n\ndef url\n  uploaded_image.url(:small)\nend\n</code></pre>\n\n<p>controller code.</p>\n\n<pre><code>def list\n  render json: { results: current_user.photos }\nend\n</code></pre>\n"}], "owner": {"reputation": 5836, "user_id": 1153022, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/JgpPs.jpg?s=128&g=1", "display_name": "okay56k", "link": "https://stackoverflow.com/users/1153022/okay56k"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 704, "favorite_count": 0, "accepted_answer_id": 48534674, "answer_count": 4, "score": 0, "last_activity_date": 1517382334, "creation_date": 1517372948, "last_edit_date": 1517374294, "question_id": 48534497, "link": "https://stackoverflow.com/questions/48534497/efficient-way-to-convert-collection-to-array-of-hashes-for-render-json", "title": "Efficient way to convert collection to array of hashes for render json", "body": "<p>Is there a more efficient way to map a collection of objects to an array of hashes?</p>\n\n<pre><code>def list\n  @photos = []\n  current_user.photos.each do |p|\n    @photos &lt;&lt; {\n      id: p.id, label: p.name, url: p.uploaded_image.url(:small),\n      size: p.uploaded_image_file_size\n    }\n  end\n  render json: { results: @photos }.to_json\nend\n</code></pre>\n\n<p>This seems a bit verbose but the structure it returns is required by the frontend.</p>\n\n<p><strong>Update</strong></p>\n\n<p>So <code>.map</code> is the preferred method then?</p>\n"}, {"tags": ["ruby"], "answers": [{"comments": [{"owner": {"reputation": 109, "user_id": 9292350, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a894b968398c663dcaa7bc469f475d48?s=128&d=identicon&r=PG&f=1", "display_name": "zacty", "link": "https://stackoverflow.com/users/9292350/zacty"}, "edited": false, "score": 0, "creation_date": 1517380310, "post_id": 48534428, "comment_id": 84066884, "body": "Thank you so much!"}], "tags": [], "owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "is_accepted": true, "score": 3, "last_activity_date": 1517385729, "last_edit_date": 1517385729, "creation_date": 1517372429, "answer_id": 48534428, "question_id": 48534274, "link": "https://stackoverflow.com/questions/48534274/optimising-code-for-matching-two-strings-modulo-scrambling/48534428#48534428", "title": "Optimising code for matching two strings modulo scrambling", "body": "<p>Here is one efficient and Ruby-like way of doing that.</p>\n\n<p><strong>Code</strong></p>\n\n<pre><code>def scramble(str1, str2)\n  h1 = char_counts(str1)\n  h2 = char_counts(str2)\n  h2.all? { |ch, nbr| nbr &lt;= h1[ch] }\nend\n\ndef char_counts(str)\n  str.each_char.with_object(Hash.new(0)) { |ch, h| h[ch] += 1 }\nend\n</code></pre>\n\n<p><strong>Examples</strong></p>\n\n<pre><code>scramble('abecacdeba', 'abceae')\n  #=&gt; true\nscramble('abecacdeba', 'abweae')\n  #=&gt; false\n</code></pre>\n\n<p><strong>Explanation</strong></p>\n\n<p>The three steps are as follows.</p>\n\n<pre><code>str1 = 'abecacdeba'\nstr2 = 'abceae'\n\nh1 = char_counts(str1)\n  #=&gt; {\"a\"=&gt;3, \"b\"=&gt;2, \"e\"=&gt;2, \"c\"=&gt;2, \"d\"=&gt;1}\nh2 = char_counts(str2)\n  #=&gt; {\"a\"=&gt;2, \"b\"=&gt;1, \"c\"=&gt;1, \"e\"=&gt;2}\nh2.all? { |ch, nbr| nbr &lt;= h1[ch] }\n  #=&gt; true\n</code></pre>\n\n<p>The last statement is equivalent to </p>\n\n<pre><code>2 &lt;= 3 &amp;&amp; 1 &lt;= 2 &amp;&amp; 1 &lt;= 2 &amp;&amp; 2 &lt;=2\n</code></pre>\n\n<p>The method <code>char_counts</code> constructs what is sometimes called a \"counting hash\".  To understand how <code>char_counts</code> works, see <a href=\"http://ruby-doc.org/core-2.4.0/Hash.html#method-c-new\" rel=\"nofollow noreferrer\">Hash::new</a>, especially the explanation of the effect of providing a default value as an argument of new. In brief, if a hash is defined <code>h = Hash.new(0)</code>, then if <code>h</code> does not have a key <code>k</code>, <code>h[k]</code> returns the default value, here <code>0</code> (and the hash is not changed).</p>\n\n<p>Suppose, for different data,</p>\n\n<pre><code>h1 = { \"a\"=&gt;2 }\nh2 = { \"a\"=&gt;1, \"b\"=&gt;2 }\n</code></pre>\n\n<p>Then we would find that <code>1 &lt;= 2 #=&gt; true</code> but <code>2 &lt;= 0 #=&gt; false</code>, so the method would return <code>false</code>. The second comparison is <code>2 &lt;= h1[\"b\"]</code>. As <code>h1</code> does not have a key <code>\"b\"</code>, <code>h1[\"b\"]</code> returns the default value, <code>0</code>.</p>\n\n<p>The method <code>char_counts</code> is effectively a short way of writing the method expressed as follows.</p>\n\n<pre><code>def char_counts(str)\n  h = {}\n  str.each_char do |ch|\n    h[ch] = 0 unless h.key?(ch) # instead of Hash.new(0)\n    h[ch] = h[c] + 1            # instead of h[c][ += 1\n  end\n  h                             # no need for this if use `each_with_object`\nend\n</code></pre>\n\n<p>See <a href=\"http://ruby-doc.org/core-2.4.0/Enumerable.html#method-i-each_with_object\" rel=\"nofollow noreferrer\">Enumerable#each_with_object</a>, <a href=\"http://ruby-doc.org/core-2.4.0/String.html#method-i-each_char\" rel=\"nofollow noreferrer\">String#each_char</a> (preferable to <a href=\"http://ruby-doc.org/core-2.4.0/String.html#method-i-each_char\" rel=\"nofollow noreferrer\">String.chars</a>, as the latter produces an unneeded temporary array whereas the former returns an enumerator) and <a href=\"http://ruby-doc.org/core-2.4.0/Hash.html#method-i-key\" rel=\"nofollow noreferrer\">Hash#key?</a> (or <code>Hash#has_key?</code>, <code>Hash#include?</code> or <code>Hash#member?</code>).</p>\n\n<p><strong>An Alternative</strong></p>\n\n<pre><code>def scramble(str1, str2)\n  str2.chars.difference(str1.chars).empty?\nend\n\nclass Array\n  def difference(other)\n    h = other.each_with_object(Hash.new(0)) { |e,h| h[e] += 1 }\n    reject { |e| h[e] &gt; 0 &amp;&amp; h[e] -= 1 }\n  end\nend\n</code></pre>\n\n<p>I have found the method <code>Array#difference</code> to be so useful I proposed it be added to the Ruby Core (<a href=\"https://bugs.ruby-lang.org/issues/11815\" rel=\"nofollow noreferrer\">here</a>). The response has been, er, underwhelming.</p>\n"}, {"tags": [], "owner": {"reputation": 24179, "user_id": 1672429, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/0815eb7d4e9dd58022d51ba2011b9c0a?s=128&d=identicon&r=PG", "display_name": "Stefan Pochmann", "link": "https://stackoverflow.com/users/1672429/stefan-pochmann"}, "is_accepted": false, "score": 1, "last_activity_date": 1517432084, "last_edit_date": 1517432084, "creation_date": 1517395909, "answer_id": 48540347, "question_id": 48534274, "link": "https://stackoverflow.com/questions/48534274/optimising-code-for-matching-two-strings-modulo-scrambling/48540347#48540347", "title": "Optimising code for matching two strings modulo scrambling", "body": "<p>One way:</p>\n\n<pre><code>def scramble(s1,s2)\n  s2.chars.uniq.all? { |c| s1.count(c) &gt;= s2.count(c) }\nend\n</code></pre>\n\n<p>Another way:</p>\n\n<pre><code>def scramble(s1,s2)\n  pool = s1.chars.group_by(&amp;:itself)\n  s2.chars.all? { |c| pool[c]&amp;.pop }\nend\n</code></pre>\n\n<p>Yet another:</p>\n\n<pre><code>def scramble(s1,s2)\n  ('a'..'z').all? { |c| s1.count(c) &gt;= s2.count(c) }\nend\n</code></pre>\n\n<p>Since this appears to be <a href=\"https://www.codewars.com/kata/scramblies\" rel=\"nofollow noreferrer\">from codewars</a>, I submitted my first two there. Both got accepted and the first one was a bit faster. Then I was shown solutions of others and saw someone using <code>('a'..'z')</code> and it's fast, so I include that here.</p>\n\n<p>The codewars \"performance tests\" aren't shown explicitly but they're all up to about 45000 letters long. So I benchmarked these solutions as well as Cary's (yours was too slow to be included) on shuffles of the alphabet repeated to be about that long (and doing it 100 times):</p>\n\n<pre><code>               user     system      total        real\nStefan 1   0.812000   0.000000   0.812000 (  0.811765)\nStefan 2   2.141000   0.000000   2.141000 (  2.127585)\nOther      0.125000   0.000000   0.125000 (  0.122248)\nCary 1     2.562000   0.000000   2.562000 (  2.575366)\nCary 2     3.094000   0.000000   3.094000 (  3.106834)\n</code></pre>\n\n<p>Moral of the story? <code>String#count</code> is fast here. Like, ridiculously fast. Almost <em>unbelievably</em> fast (I actually had to run extra tests to believe it). It counts through about <em>1.9 billion letters per second</em> (100 times 26 letters times 2 strings of ~45000 letters, all in 0.12 seconds). Note that the difference to my own first solution is just that I do <code>s2.chars.uniq</code>, and that increases the time from 0.12 seconds to 0.81 seconds. Meaning this double pass through one string takes about six times as long as the 52 passes for counting. The counting is about 150 times faster. I did expect it to be very fast, because it presumably just searches a byte in an array of bytes using C code (edit: <a href=\"https://github.com/ruby/ruby/blob/00716bee784e4f405707a38e8709e71490c7d1bb/string.c#L7532-L7534\" rel=\"nofollow noreferrer\">looks like it does</a>), but this speed still surprised me.</p>\n\n<p>Code:</p>\n\n<pre><code>require 'benchmark'\n\ndef scramble_stefan1(s1,s2)\n  s2.chars.uniq.all? { |c| s1.count(c) &gt;= s2.count(c) }\nend\n\ndef scramble_stefan2(s1,s2)\n  pool = s1.chars.group_by(&amp;:itself)\n  s2.chars.all? { |c| pool[c]&amp;.pop }\nend\n\ndef scramble_other(s1,s2)\n  ('a'..'z').all? { |c| s1.count(c) &gt;= s2.count(c) }\nend\n\ndef scramble_cary1(str1, str2)\n  h1 = char_counts(str1)\n  h2 = char_counts(str2)\n  h2.all? { |ch, nbr| nbr &lt;= h1[ch] }\nend\ndef char_counts(str)\n  str.each_char.with_object(Hash.new(0)) { |ch, h| h[ch] += 1 }\nend\n\ndef scramble_cary2(str1, str2)\n  str2.chars.difference(str1.chars).empty?\nend\nclass Array\n  def difference(other)\n    h = other.each_with_object(Hash.new(0)) { |e,h| h[e] += 1 }\n    reject { |e| h[e] &gt; 0 &amp;&amp; h[e] -= 1 }\n  end\nend\n\nBenchmark.bmbm do |x|\n  n = 100\n  s1 = (('a'..'z').to_a * (45000 / 26)).shuffle.join\n  s2 = s1.chars.shuffle.join\n  x.report('Stefan 1') { n.times { scramble_stefan1(s1, s2) } }\n  x.report('Stefan 2') { n.times { scramble_stefan2(s1, s2) } }\n  x.report('Other') { n.times { scramble_other(s1, s2) } }\n  x.report('Cary 1') { n.times { scramble_cary1(s1, s2) } }\n  x.report('Cary 2') { n.times { scramble_cary2(s1, s2) } }\nend\n</code></pre>\n"}], "owner": {"reputation": 109, "user_id": 9292350, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a894b968398c663dcaa7bc469f475d48?s=128&d=identicon&r=PG&f=1", "display_name": "zacty", "link": "https://stackoverflow.com/users/9292350/zacty"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 75, "favorite_count": 0, "accepted_answer_id": 48534428, "answer_count": 2, "score": -2, "last_activity_date": 1517432084, "creation_date": 1517371330, "last_edit_date": 1517373920, "question_id": 48534274, "link": "https://stackoverflow.com/questions/48534274/optimising-code-for-matching-two-strings-modulo-scrambling", "title": "Optimising code for matching two strings modulo scrambling", "body": "<p>I am trying to write a function <code>scramble(str1, str2)</code> that returns <code>true</code> if a portion of <code>str1</code> characters can be rearranged to match <code>str2</code>, otherwise returns <code>false</code>. Only lower case letters (a-z) will be used. No punctuation or digits will be included. For example:</p>\n\n<ul>\n<li><code>str1 = 'rkqodlw'; str2 = 'world'</code> should return <code>true</code>.</li>\n<li><code>str1 = 'cedewaraaossoqqyt'; str2 = 'codewars'</code> should return <code>true</code>.</li>\n<li><code>str1 = 'katas'; str2 = 'steak'</code> should return <code>false</code>.</li>\n</ul>\n\n<p>This is my code:</p>\n\n<pre><code>def scramble(s1, s2)\n  #sorts strings into arrays\n  first = s1.split(\"\").sort\n  second = s2.split(\"\").sort\n  correctLetters = 0\n  for i in 0...first.length\n    #check for occurrences of first letter\n    occurrencesFirst = first.count(s1[i])\n    for j in 0...second.length\n      #scan through second string\n      occurrencesSecond = second.count(s2[j])\n      #if letter to be tested is correct and occurrences of first less than occurrences of second\n      #meaning word cannot be formed\n      if (s2[j] == s1[i]) &amp;&amp; occurrencesFirst &lt; occurrencesSecond\n        return false\n      elsif s2[j] == s1[i]\n        correctLetters += 1\n      elsif first.count(s1[s2[j]]) == 0\n        return false\n      end\n    end\n  end\n  if correctLetters == 0\n    return false\n  end\n  return true\nend\n</code></pre>\n\n<p>I need help optimising this code. Please give me suggestions.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "postgresql", "authentication"], "comments": [{"owner": {"reputation": 16229, "user_id": 525478, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/3b6c0b47a0c430a0b141baee7ea845be?s=128&d=identicon&r=PG", "display_name": "Brad Werth", "link": "https://stackoverflow.com/users/525478/brad-werth"}, "edited": false, "score": 2, "creation_date": 1517368950, "post_id": 48533884, "comment_id": 84063400, "body": "change <code>puts &quot;Didn&#39;t work&quot;</code> to <code>p @user.errors.full_messages</code> to see why..."}, {"owner": {"reputation": 174, "user_id": 8211949, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/5973d3bcc3861af6f9b9fd17b4cebaf3?s=128&d=identicon&r=PG&f=1", "display_name": "kuwantum", "link": "https://stackoverflow.com/users/8211949/kuwantum"}, "edited": false, "score": 0, "creation_date": 1517369322, "post_id": 48533884, "comment_id": 84063477, "body": "Yeah, the save-failed message doesn&#39;t help at all here"}, {"owner": {"reputation": 497, "user_id": 8032784, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/121caf69992063447bf70cf6688e6a1c?s=128&d=identicon&r=PG", "display_name": "Naji", "link": "https://stackoverflow.com/users/8032784/naji"}, "reply_to_user": {"reputation": 16229, "user_id": 525478, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/3b6c0b47a0c430a0b141baee7ea845be?s=128&d=identicon&r=PG", "display_name": "Brad Werth", "link": "https://stackoverflow.com/users/525478/brad-werth"}, "edited": false, "score": 0, "creation_date": 1517371319, "post_id": 48533884, "comment_id": 84063944, "body": "@BradWerth thank you! Credited in answer"}], "answers": [{"comments": [{"owner": {"reputation": 497, "user_id": 8032784, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/121caf69992063447bf70cf6688e6a1c?s=128&d=identicon&r=PG", "display_name": "Naji", "link": "https://stackoverflow.com/users/8032784/naji"}, "edited": false, "score": 0, "creation_date": 1517371339, "post_id": 48533962, "comment_id": 84063951, "body": "Thank you for the resource! Will look into it"}, {"owner": {"reputation": 1196, "user_id": 8426717, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-QwYD3zUWkhA/AAAAAAAAAAI/AAAAAAAABJs/2y8hDOo4fYY/photo.jpg?sz=128", "display_name": "Tai", "link": "https://stackoverflow.com/users/8426717/tai"}, "reply_to_user": {"reputation": 497, "user_id": 8032784, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/121caf69992063447bf70cf6688e6a1c?s=128&d=identicon&r=PG", "display_name": "Naji", "link": "https://stackoverflow.com/users/8032784/naji"}, "edited": false, "score": 0, "creation_date": 1517371987, "post_id": 48533962, "comment_id": 84064101, "body": "Yep. Basically it is just an operation of Rails to check validation, it doesn&#39;t said that you can&#39;t save user to database because of its validation is violated. As you mention in the log that is because password confirmation is not match."}], "tags": [], "owner": {"reputation": 1196, "user_id": 8426717, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-QwYD3zUWkhA/AAAAAAAAAAI/AAAAAAAABJs/2y8hDOo4fYY/photo.jpg?sz=128", "display_name": "Tai", "link": "https://stackoverflow.com/users/8426717/tai"}, "is_accepted": false, "score": 2, "last_activity_date": 1517370331, "last_edit_date": 1517370331, "creation_date": 1517369191, "answer_id": 48533962, "question_id": 48533884, "link": "https://stackoverflow.com/questions/48533884/rails-postgres-keeps-telling-me-user-exists-when-it-does-not/48533962#48533962", "title": "Rails Postgres keeps telling me User Exists when it Does Not", "body": "<p><code>User Exists</code> in the log mention to an operation that Rails do to check uniqueness validation for email of user. You can try to remove the <code>uniqueness</code> validation and check the log.</p>\n\n<p>More details about how Rails check <code>uniqueness</code> validation: <a href=\"https://robots.thoughtbot.com/the-perils-of-uniqueness-validations\" rel=\"nofollow noreferrer\">https://robots.thoughtbot.com/the-perils-of-uniqueness-validations</a></p>\n"}, {"tags": [], "owner": {"reputation": 497, "user_id": 8032784, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/121caf69992063447bf70cf6688e6a1c?s=128&d=identicon&r=PG", "display_name": "Naji", "link": "https://stackoverflow.com/users/8032784/naji"}, "is_accepted": true, "score": 1, "last_activity_date": 1517371292, "creation_date": 1517371292, "answer_id": 48534266, "question_id": 48533884, "link": "https://stackoverflow.com/questions/48533884/rails-postgres-keeps-telling-me-user-exists-when-it-does-not/48534266#48534266", "title": "Rails Postgres keeps telling me User Exists when it Does Not", "body": "<p>Thanks @BradWerth for the debugging help. Turns out it wasn't writing to the database because the password confirmation didn't match the password. I'm not sure what the <code>User Exists</code> thing is all about (will look in to it @Tai) but this is what's happening now...</p>\n\n<p><strong>using @user.errors.full_messages</strong></p>\n\n<pre><code>Started POST \"/api/user\" for 127.0.0.1 at 2018-01-30 19:55:27 -0800\nProcessing by Api::UserController#create as JSON\n  Parameters: {\"email\"=&gt;\"ktuh@org.com\", \"password\"=&gt;\"[FILTERED]\", \"password_confirmation\"=&gt;\"[FILTERED]\", \"first_name\"=&gt;\"asdfasfd\", \"last_name\"=&gt;\"asdfasddfs\", \"groupname\"=&gt;\"fdsafdasf\", \"admin\"=&gt;\"true\", \"user\"=&gt;{\"email\"=&gt;\"test@test.com\", \"first_name\"=&gt;\"asdfasfd\", \"last_name\"=&gt;\"asdfasddfs\", \"groupname\"=&gt;\"fdsafdasf\", \"admin\"=&gt;\"true\"}}\nCan't verify CSRF token authenticity.\n   (0.3ms)  BEGIN\n  User Exists (0.5ms)  SELECT  1 AS one FROM \"users\" WHERE LOWER(\"users\".\"email\") = LOWER($1) LIMIT $2  [[\"email\", \"ktuh@org.com\"], [\"LIMIT\", 1]]\n   (0.2ms)  ROLLBACK\n[\"Password confirmation doesn't match Password\"]\nNo template found for Api::UserController#create, rendering head :no_content\nCompleted 204 No Content in 117ms (ActiveRecord: 6.4ms)\n</code></pre>\n\n<p><strong>using @user.errors.full_messages with correct password confirmation</strong></p>\n\n<pre><code>Started POST \"/api/user\" for 127.0.0.1 at 2018-01-30 19:55:52 -0800\nProcessing by Api::UserController#create as JSON\n  Parameters: {\"email\"=&gt;\"test@test.com\", \"password\"=&gt;\"[FILTERED]\", \"password_confirmation\"=&gt;\"[FILTERED]\", \"first_name\"=&gt;\"asdfasfd\", \"last_name\"=&gt;\"asdfasddfs\", \"groupname\"=&gt;\"fdsafdasf\", \"admin\"=&gt;\"true\", \"user\"=&gt;{\"email\"=&gt;\"test@test.com\", \"first_name\"=&gt;\"asdfasfd\", \"last_name\"=&gt;\"asdfasddfs\", \"groupname\"=&gt;\"fdsafdasf\", \"admin\"=&gt;\"true\"}}\nCan't verify CSRF token authenticity.\n   (0.2ms)  BEGIN\n  User Exists (0.4ms)  SELECT  1 AS one FROM \"users\" WHERE LOWER(\"users\".\"email\") = LOWER($1) LIMIT $2  [[\"email\", \"ktuh@org.com\"], [\"LIMIT\", 1]]\n  SQL (0.6ms)  INSERT INTO \"users\" (\"email\", \"password_digest\", \"first_name\", \"last_name\", \"groupname\", \"created_at\", \"updated_at\", \"admin\") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING \"id\"  [[\"email\", \"test@test.com\"], [\"password_digest\", \"$2a$10$W1wt6arxrP8sW/K1jQPsLuEX8BUFMl7lOSgvCHa6hBTdON/HCoHNa\"], [\"first_name\", \"asdfasfd\"], [\"last_name\", \"asdfasddfs\"], [\"groupname\", \"fdsafdasf\"], [\"created_at\", \"2018-01-31 03:55:52.787377\"], [\"updated_at\", \"2018-01-31 03:55:52.787377\"], [\"admin\", \"t\"]]\n   (1.0ms)  COMMIT\nit worked\nNo template found for Api::UserController#create, rendering head :no_content\nCompleted 204 No Content in 112ms (ActiveRecord: 2.2ms)\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 497, "user_id": 8032784, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/121caf69992063447bf70cf6688e6a1c?s=128&d=identicon&r=PG", "display_name": "Naji", "link": "https://stackoverflow.com/users/8032784/naji"}, "edited": false, "score": 0, "creation_date": 1517372637, "post_id": 48534285, "comment_id": 84064269, "body": "1) thank you for the reference, i&#39;ll look in to sending the CSRF token with the request (i&#39;m using react so i am outside the rails form)  2) I&#39;m trying to use &quot;Strong Params&quot; but was having issues so this is my workaround for now just to make sure that I can at least write to my database. Here is the link to my previous question using &quot;Strong params&quot; <a href=\"https://stackoverflow.com/questions/48512933/getting-unexpected-user-param-and-cant-access-password-param-in-rails\" title=\"getting unexpected user param and cant access password param in rails\">stackoverflow.com/questions/48512933/&hellip;</a>"}], "tags": [], "owner": {"reputation": 326, "user_id": 3013354, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad9dbf3df6d9dc0944bb224014a3bc2b?s=128&d=identicon&r=PG", "display_name": "nekogami", "link": "https://stackoverflow.com/users/3013354/nekogami"}, "is_accepted": false, "score": 1, "last_activity_date": 1517371443, "creation_date": 1517371443, "answer_id": 48534285, "question_id": 48533884, "link": "https://stackoverflow.com/questions/48533884/rails-postgres-keeps-telling-me-user-exists-when-it-does-not/48534285#48534285", "title": "Rails Postgres keeps telling me User Exists when it Does Not", "body": "<p>I see multiple potential problems here:</p>\n\n<p>1/ Can't verify CSRF token authenticity.\nif this is an API then I assume you are trying to use it outside a rails form which means thats if have to send the csrf token inside the request OR remove de forgery protection from your action.\n<a href=\"http://api.rubyonrails.org/classes/ActionController/RequestForgeryProtection/ClassMethods.html\" rel=\"nofollow noreferrer\">http://api.rubyonrails.org/classes/ActionController/RequestForgeryProtection/ClassMethods.html</a></p>\n\n<p>2/ Rails as a \"Strong Params\" concept that may prevent you from using params directly to manipulate your model.\n<a href=\"http://edgeguides.rubyonrails.org/action_controller_overview.html#strong-parameters\" rel=\"nofollow noreferrer\">http://edgeguides.rubyonrails.org/action_controller_overview.html#strong-parameters</a></p>\n\n<p>\"User EXIST\" is what appears on the output because of the check done with\n<code>ruby\n    validates :email, presence: true, length: { maximum: 255 }, format: { with: VALID_EMAIL_REGEX }, uniqueness: { case_sensitive: false }\n</code></p>\n"}], "owner": {"reputation": 497, "user_id": 8032784, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/121caf69992063447bf70cf6688e6a1c?s=128&d=identicon&r=PG", "display_name": "Naji", "link": "https://stackoverflow.com/users/8032784/naji"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 530, "favorite_count": 0, "accepted_answer_id": 48534266, "answer_count": 3, "score": 2, "last_activity_date": 1517371443, "creation_date": 1517368541, "question_id": 48533884, "link": "https://stackoverflow.com/questions/48533884/rails-postgres-keeps-telling-me-user-exists-when-it-does-not", "title": "Rails Postgres keeps telling me User Exists when it Does Not", "body": "<p>I'm setting up user auth in my Rails app using Postgres and calling <code>User.new()</code> continuously keeps telling me <code>User Exists</code> despite the user definitely NOT being in my database.</p>\n\n<p><strong>app/controllers/api/user_controller.rb</strong></p>\n\n<pre><code>class Api::UserController &lt; ApplicationController\n    respond_to :json\n    protect_from_forgery with: :null_session\n\n\ndef create\n    @user = User.new(\n        email: params[:email],\n        password: params[:password],\n        password_confirmation: params[:password_confirmation],\n        first_name: params[:first_name],\n        last_name: params[:last_name],\n        groupname: params[:groupname],\n        admin: params[:admin]\n    )\n\n    if @user.save\n        puts \"it worked\"\n    else\n        puts \"Didn't work\"\n    end\nend\nend\n</code></pre>\n\n<p><strong>app/models/user.rb</strong></p>\n\n<pre><code>class User &lt; ApplicationRecord\n    before_save { self.email = email.downcase }\n    VALID_EMAIL_REGEX = /\\A[\\w+\\-.]+@[a-z\\d\\-.]+\\.[a-z]+\\z/i\n    validates :email, presence: true, length: { maximum: 255 }, format: { with: VALID_EMAIL_REGEX }, uniqueness: { case_sensitive: false }\n    validates :first_name, presence: true, length: { maximum: 51 }\n    validates :groupname, presence: true, length: { maximum: 51 }\n    has_secure_password\n    validates :password, presence: true, length: { minimum: 6 }\nend\n</code></pre>\n\n<p><strong>app/db.schema.rb</strong></p>\n\n<pre><code>create_table \"users\", force: :cascade do |t|\n    t.string \"email\"\n    t.string \"password_digest\"\n    t.string \"first_name\"\n    t.string \"last_name\"\n    t.string \"groupname\"\n    t.datetime \"created_at\", null: false\n    t.datetime \"updated_at\", null: false\n    t.boolean \"admin\"\n    t.index [\"email\"], name: \"index_users_on_email\", unique: true\n  end\n</code></pre>\n\n<p><strong>terminal response</strong></p>\n\n<pre><code>app/controllers/api/user_controller.rb:31:in `create'\nStarted POST \"/api/user\" for 127.0.0.1 at 2018-01-30 19:03:55 -0800\nProcessing by Api::UserController#create as JSON\n  Parameters: {\"email\"=&gt;\"ktuh@org.com\", \"password\"=&gt;\"[FILTERED]\", \"password_confirmation\"=&gt;\"[FILTERED]\", \"first_name\"=&gt;\"asdfasfd\", \"last_name\"=&gt;\"asdfasddfs\", \"groupname\"=&gt;\"fdsafdasf\", \"admin\"=&gt;\"true\", \"user\"=&gt;{\"email\"=&gt;\"test@test.com\", \"first_name\"=&gt;\"asdfasfd\", \"last_name\"=&gt;\"asdfasddfs\", \"groupname\"=&gt;\"fdsafdasf\", \"admin\"=&gt;\"true\"}}\nCan't verify CSRF token authenticity.\n   (0.2ms)  BEGIN\n  User Exists (0.4ms)  SELECT  1 AS one FROM \"users\" WHERE LOWER(\"users\".\"email\") = LOWER($1) LIMIT $2  [[\"email\", \"ktuh@org.com\"], [\"LIMIT\", 1]]\n   (0.2ms)  ROLLBACK\nDidn't work\nNo template found for Api::UserController#create, rendering head :no_content\nCompleted 204 No Content in 118ms (ActiveRecord: 6.3ms)\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 18856, "user_id": 1359650, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/dffc4318ac93e728a26c8e8b51b4eb37?s=128&d=identicon&r=PG", "display_name": "jvillian", "link": "https://stackoverflow.com/users/1359650/jvillian"}, "edited": false, "score": 2, "creation_date": 1517359760, "post_id": 48532750, "comment_id": 84061224, "body": "Try <a href=\"https://www.google.com/search?client=ubuntu&amp;hs=4w3&amp;channel=fs&amp;q=rails+4.2.6+Fixnum+is+deprecated&amp;spell=1&amp;sa=X&amp;ved=0ahUKEwjArKDx_IDZAhVEwmMKHSb9CE0QBQgkKAA&amp;biw=1273&amp;bih=922\" rel=\"nofollow noreferrer\">googling</a>. Second hit. Your version of rails may not be compatible with your version of ruby."}, {"owner": {"reputation": 330, "user_id": 6482185, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-T11f0D1JFSw/AAAAAAAAAAI/AAAAAAAAAP0/6onfs__d2RE/photo.jpg?sz=128", "display_name": "Will Nguyen", "link": "https://stackoverflow.com/users/6482185/will-nguyen"}, "edited": false, "score": 1, "creation_date": 1517363295, "post_id": 48532750, "comment_id": 84062084, "body": "I recommend rails 5.0 and ruby 2.3.3. That&#39;s enough for you to learn ruby on rails. Take a look on this <a href=\"http://edgeguides.rubyonrails.org/upgrading_ruby_on_rails.html\" rel=\"nofollow noreferrer\">edgeguides.rubyonrails.org/upgrading_ruby_on_rails.html</a>"}], "answers": [{"tags": [], "owner": {"reputation": 61, "user_id": 8930099, "user_type": "registered", "profile_image": "https://graph.facebook.com/10214619289617989/picture?type=large", "display_name": "Matthew Primpas", "link": "https://stackoverflow.com/users/8930099/matthew-primpas"}, "is_accepted": true, "score": 1, "last_activity_date": 1517363376, "creation_date": 1517363376, "answer_id": 48533259, "question_id": 48532750, "link": "https://stackoverflow.com/questions/48532750/rails-server-startup-error-after-project-creation/48533259#48533259", "title": "Rails server startup error after project creation", "body": "<p>You'll need to update Rails to a newer version.  I believe 5.1.4 is the most up-to-date.  I know there are a lot of compatibility issues with Rails 4.2 and any Ruby version above 2.4, as seen in <a href=\"https://github.com/rails/rails/issues/27670\" rel=\"nofollow noreferrer\"><strong>this</strong></a> question and many other queries online.</p>\n\n<p>Try running <code>bundle install</code> while in the Rails application.</p>\n"}], "owner": {"reputation": 99, "user_id": 5499383, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/de6a14b5b7ca748d731bdddbd65e2b85?s=128&d=identicon&r=PG&f=1", "display_name": "Padu", "link": "https://stackoverflow.com/users/5499383/padu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 499, "favorite_count": 0, "accepted_answer_id": 48533259, "answer_count": 1, "score": 2, "last_activity_date": 1517363376, "creation_date": 1517359348, "question_id": 48532750, "link": "https://stackoverflow.com/questions/48532750/rails-server-startup-error-after-project-creation", "title": "Rails server startup error after project creation", "body": "<p>I am trying to learn Ruby on rails and I create a new project and when I try to start the server wit <code>rails server</code> I get this error. </p>\n\n<pre><code>=&gt; Booting WEBrick\n=&gt; Rails 4.2.6 application starting in development on http://localhost:3000\n=&gt; Run `rails server -h` for more startup options\n=&gt; Ctrl-C to shutdown server\n/home/andrei/.rvm/gems/ruby-2.5.0/gems/activesupport-4.2.6/lib/active_support/core_ext/numeric/conversions.rb:121: warning: constant ::Fixnum is deprecated\n/home/andrei/.rvm/gems/ruby-2.5.0/gems/activesupport-4.2.6/lib/active_support/core_ext/numeric/conversions.rb:121: warning: constant ::Bignum is deprecated\nExiting\nTraceback (most recent call last):\n    4222: from bin/rails:3:in `&lt;main&gt;'\n    4221: from bin/rails:3:in `load'\n    4220: from /home/andrei/Projects/Ruby/blog/bin/spring:15:in `&lt;top (required)&gt;'\n    4219: from /home/andrei/Projects/Ruby/blog/bin/spring:15:in `require'\n    4218: from /home/andrei/.rvm/gems/ruby-2.5.0/gems/spring-2.0.2/lib/spring/binstub.rb:31:in `&lt;top (required)&gt;'\n    4217: from /home/andrei/.rvm/gems/ruby-2.5.0/gems/spring-2.0.2/lib/spring/binstub.rb:31:in `load'\n    4216: from /home/andrei/.rvm/gems/ruby-2.5.0/gems/spring-2.0.2/bin/spring:49:in `&lt;top (required)&gt;'\n    4215: from /home/andrei/.rvm/gems/ruby-2.5.0/gems/spring-2.0.2/lib/spring/client.rb:30:in `run'\n     ... 4210 levels...\n       4: from /home/andrei/.rvm/gems/ruby-2.5.0/gems/activesupport-4.2.6/lib/active_support/core_ext/numeric/conversions.rb:131:in `block (2 levels) in &lt;class:Numeric&gt;'\n       3: from /home/andrei/.rvm/gems/ruby-2.5.0/gems/activesupport-4.2.6/lib/active_support/core_ext/numeric/conversions.rb:131:in `block (2 levels) in &lt;class:Numeric&gt;'\n       2: from /home/andrei/.rvm/gems/ruby-2.5.0/gems/activesupport-4.2.6/lib/active_support/core_ext/numeric/conversions.rb:131:in `block (2 levels) in &lt;class:Numeric&gt;'\n       1: from /home/andrei/.rvm/gems/ruby-2.5.0/gems/activesupport-4.2.6/lib/active_support/core_ext/numeric/conversions.rb:131:in `block (2 levels) in &lt;class:Numeric&gt;'\n/home/andrei/.rvm/gems/ruby-2.5.0/gems/activesupport-4.2.6/lib/active_support/core_ext/numeric/conversions.rb:131:in `block (2 levels) in &lt;class:Numeric&gt;': stack level too deep (SystemStackError)\n</code></pre>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 30418, "user_id": 823617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DmWH1.png?s=128&g=1", "display_name": "Casper", "link": "https://stackoverflow.com/users/823617/casper"}, "edited": false, "score": 0, "creation_date": 1517359786, "post_id": 48532701, "comment_id": 84061229, "body": "It&#39;s possible to do this with Ruby on an Unix terminal, but I doubt you can accomplish it with repl.it, as it requires a more low-level access to the tty interface which (probably) isn&#39;t possible through repl.it."}, {"owner": {"reputation": 30418, "user_id": 823617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DmWH1.png?s=128&g=1", "display_name": "Casper", "link": "https://stackoverflow.com/users/823617/casper"}, "edited": false, "score": 0, "creation_date": 1517360076, "post_id": 48532701, "comment_id": 84061324, "body": "Another solution is to use Threads. Please provide some sample code and a description of what exactly you want to happen."}, {"owner": {"reputation": 9030, "user_id": 5101476, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JCQrl.jpg?s=128&g=1", "display_name": "ice\u30c4", "link": "https://stackoverflow.com/users/5101476/ice%e3%83%84"}, "edited": false, "score": 0, "creation_date": 1517360111, "post_id": 48532701, "comment_id": 84061330, "body": "<i>&quot;Id like the user to be able to input when he want.&quot;</i> What do you mean? Can you provide an example with some pseudo code?"}, {"owner": {"reputation": 129, "user_id": 9291873, "user_type": "registered", "profile_image": "https://graph.facebook.com/345620525954849/picture?type=large", "display_name": "Samuel Fyckes", "link": "https://stackoverflow.com/users/9291873/samuel-fyckes"}, "edited": false, "score": 0, "creation_date": 1517360486, "post_id": 48532701, "comment_id": 84061402, "body": "im trying to display ex: Number: 1 that will increase by one every second. to do it im using a loop but id like the user to be able to enter an input whenever he wants but i want the number to continue to increase    sorry i have difficulties to explain"}, {"owner": {"reputation": 129, "user_id": 9291873, "user_type": "registered", "profile_image": "https://graph.facebook.com/345620525954849/picture?type=large", "display_name": "Samuel Fyckes", "link": "https://stackoverflow.com/users/9291873/samuel-fyckes"}, "edited": false, "score": 0, "creation_date": 1517360618, "post_id": 48532701, "comment_id": 84061431, "body": "If i try to put the &quot;gets&quot; in the loop, the loop will stop until i input something, but i just want it to ignore the &quot;gets&quot; unless i input something"}], "answers": [{"comments": [{"owner": {"reputation": 129, "user_id": 9291873, "user_type": "registered", "profile_image": "https://graph.facebook.com/345620525954849/picture?type=large", "display_name": "Samuel Fyckes", "link": "https://stackoverflow.com/users/9291873/samuel-fyckes"}, "edited": false, "score": 1, "creation_date": 1517363000, "post_id": 48533090, "comment_id": 84062003, "body": "Thanks dude thats what i was looking for. Its impressive how people reply fast on this site :)"}, {"owner": {"reputation": 30418, "user_id": 823617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DmWH1.png?s=128&g=1", "display_name": "Casper", "link": "https://stackoverflow.com/users/823617/casper"}, "reply_to_user": {"reputation": 129, "user_id": 9291873, "user_type": "registered", "profile_image": "https://graph.facebook.com/345620525954849/picture?type=large", "display_name": "Samuel Fyckes", "link": "https://stackoverflow.com/users/9291873/samuel-fyckes"}, "edited": false, "score": 0, "creation_date": 1517363319, "post_id": 48533090, "comment_id": 84062087, "body": "@SamuelFyckes Great :) Remember to approve the answer if it works for you, so others can see it too. Thanks."}], "tags": [], "owner": {"reputation": 30418, "user_id": 823617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DmWH1.png?s=128&g=1", "display_name": "Casper", "link": "https://stackoverflow.com/users/823617/casper"}, "is_accepted": true, "score": 2, "last_activity_date": 1517361978, "creation_date": 1517361978, "answer_id": 48533090, "question_id": 48532701, "link": "https://stackoverflow.com/questions/48532701/reading-input-from-user-without-interrupting-program-execution/48533090#48533090", "title": "Reading input from user without interrupting program execution", "body": "<p>You can accomplish what you want using threads and some simple state variables to communicate between the threads.</p>\n\n<p>In this example we use a variable <code>@stop</code> to signal from the main thread to the counting thread when it's time to end the counting loop.</p>\n\n<p>This example works on repl.it directly:<br>\n<a href=\"https://repl.it/repls/RingedIlliterateEnglishsetter\" rel=\"nofollow noreferrer\">https://repl.it/repls/RingedIlliterateEnglishsetter</a></p>\n\n<p>Hopefully this gives you some ideas on how to proceed.</p>\n\n<pre><code>@stop = false\n\nthr = Thread.new {\n  puts \"Counting thread starting...\"\n  i = 0\n\n  loop {\n    i += 1\n    puts i\n    sleep 1\n    break if @stop\n  }\n\n  puts \"Counting thread exit...\"\n}\n\nloop {\n  puts \"\\nWaiting for input...\\nType 'stop' to exit...\"\n  input = gets.chomp\n\n  if input == \"stop\"\n    puts \"Stopping...\"\n    @stop = true\n    break\n  end\n}\n\n# Wait for counting thread to end\nthr.join\nputs \"Main program exit...\"\n</code></pre>\n"}], "owner": {"reputation": 129, "user_id": 9291873, "user_type": "registered", "profile_image": "https://graph.facebook.com/345620525954849/picture?type=large", "display_name": "Samuel Fyckes", "link": "https://stackoverflow.com/users/9291873/samuel-fyckes"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 52, "favorite_count": 0, "accepted_answer_id": 48533090, "answer_count": 1, "score": 0, "last_activity_date": 1517362107, "creation_date": 1517358940, "last_edit_date": 1517362107, "question_id": 48532701, "link": "https://stackoverflow.com/questions/48532701/reading-input-from-user-without-interrupting-program-execution", "title": "Reading input from user without interrupting program execution", "body": "<p>Im trying to do a loop in ruby that display a number + 1 every second. Id like the user to be able to input when he want. the problem is that i have to input something for the loop to continue. sorry for my bad english im fr</p>\n\n<p>p.s im using a online compiler (repl.it)</p>\n"}, {"tags": ["ruby", "regex", "cucumber"], "comments": [{"owner": {"reputation": 778, "user_id": 2581843, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000141231384/picture?type=large", "display_name": "Sander Saelmans", "link": "https://stackoverflow.com/users/2581843/sander-saelmans"}, "edited": false, "score": 0, "creation_date": 1517499968, "post_id": 48532175, "comment_id": 84129254, "body": "Did you update from cucumber 2.x to 3.x?"}], "owner": {"reputation": 11, "user_id": 9291223, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-WVIdqdp2hbc/AAAAAAAAAAI/AAAAAAAAADE/CifZ5PEi4GI/photo.jpg?sz=128", "display_name": "Kate ", "link": "https://stackoverflow.com/users/9291223/kate"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 45, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1517402590, "creation_date": 1517355189, "last_edit_date": 1517402590, "question_id": 48532175, "link": "https://stackoverflow.com/questions/48532175/cucumbercucumberexpressionscucumberexpressionerror-single-transformer-unexp", "title": "Cucumber::CucumberExpressions::CucumberExpressionError: Single transformer unexpectedly matched 2 values", "body": "<p>My step definition: </p>\n\n<pre><code>    Then(/^I create documentation via api( for( (\\d+) child(ren)?)?(,? dimIDs (\\d+)(, (\\d+))?)?(,? levelID (\\d+))?)?$/) do |_, _,\n                                  children_number, _, _,\n                                  dimID1,_,\n                                  dimID2, _,\n                                  levelID|\n.....\nend\n</code></pre>\n\n<p>In my feature file the step is:</p>\n\n<pre><code>    Then I create documentation via api for 1 child, dimIDs 1111, levelID 27\n</code></pre>\n\n<p>I get an error:</p>\n\n<pre><code>Cucumber::CucumberExpressions::CucumberExpressionError: Single transformer unexpectedly matched 2 values - \" 1 child\" and \", dimIDs 1111\"\n</code></pre>\n\n<p>What am I missing? Also could be syntax is different with some updated versions of ruby, cucumber, or selenium? That step was working for sure, but then it started giving the error. </p>\n"}, {"tags": ["ruby", "testing", "rspec", "capybara"], "comments": [{"owner": {"reputation": 23809, "user_id": 351909, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/71a6b8a36a63c2cb9de678c07be6d8a4?s=128&d=identicon&r=PG", "display_name": "moritz", "link": "https://stackoverflow.com/users/351909/moritz"}, "edited": false, "score": 0, "creation_date": 1517355774, "post_id": 48531816, "comment_id": 84060181, "body": "Can you show the code that extracts the textareas&#39; values so that we can see on what data you operate?"}], "answers": [{"comments": [{"owner": {"reputation": 1317, "user_id": 2013212, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/8ad34e90fc30380965ee659d6a825b8c?s=128&d=identicon&r=PG", "display_name": "Jonathon Nordquist", "link": "https://stackoverflow.com/users/2013212/jonathon-nordquist"}, "edited": false, "score": 0, "creation_date": 1517425192, "post_id": 48532576, "comment_id": 84095071, "body": "And that seems to have done the trick.  Thanks for the clarification on filter blocks, they look amazingly useful."}, {"owner": {"reputation": 42014, "user_id": 2709090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/238c2b7cde2c817fc9a5a2b8eaa2ffad?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Walpole", "link": "https://stackoverflow.com/users/2709090/thomas-walpole"}, "reply_to_user": {"reputation": 1317, "user_id": 2013212, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/8ad34e90fc30380965ee659d6a825b8c?s=128&d=identicon&r=PG", "display_name": "Jonathon Nordquist", "link": "https://stackoverflow.com/users/2013212/jonathon-nordquist"}, "edited": false, "score": 0, "creation_date": 1517426567, "post_id": 48532576, "comment_id": 84095774, "body": "@JonathonNordquist You&#39;re welcome, don&#39;t forget to accept the answer (the checkmark) so the question gets marked as answered if you don&#39;t need any more info."}], "tags": [], "owner": {"reputation": 42014, "user_id": 2709090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/238c2b7cde2c817fc9a5a2b8eaa2ffad?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Walpole", "link": "https://stackoverflow.com/users/2709090/thomas-walpole"}, "is_accepted": true, "score": 1, "last_activity_date": 1517364463, "last_edit_date": 1517364463, "creation_date": 1517357878, "answer_id": 48532576, "question_id": 48531816, "link": "https://stackoverflow.com/questions/48531816/need-to-count-the-number-of-emails-in-a-string-using-capybara-rspec/48532576#48532576", "title": "Need to count the number of emails in a string using Capybara/RSpec", "body": "<p>Since all the emails are in one element your inclination to use a filter block is exactly correct. The filter block receives each element that matches the initial selector and needs to return whether or not it matches whatever extra filtering you wish to do (true/false).  Therefore, to check that the element had a string (value not text since it's a form field) with 4 comma separated items it would be something like</p>\n\n<pre><code>expect(page).to have_css(\".css-selectors textarea\"){ |ta|\n  ta.value.split(',').size == 4\n}\n</code></pre>\n\n<p>This will then use Capybaras waiting/retrying behavior while also performing the extra step of checking for a matching number of comma separated items in the text of the element, thereby getting around the race condition.</p>\n\n<p>Your check could also be performed by using a regex for the <code>with</code> option of the field selector, along the lines of</p>\n\n<pre><code>expect(page).to have_field(type: 'textarea', with: /^[^,]+,[^,]+,[^,]+,[^,]+$/)\n</code></pre>\n\n<p>or fillable_field selector</p>\n\n<pre><code>expect(page).to have_selector(:fillable_field, type: 'textarea', with: /^[^,]+,[^,]+,[^,]+,[^,]+$/)\n</code></pre>\n\n<p>Those don't currently scope to the <code>.css-selectors</code> element but you could do that with <code>within</code> or a chained find. You could also ensure a unique element by passing the id/name/label text of the element. Obviously you could make the regex more complicated if you want to actually verify the text strings are emails, etc.</p>\n"}], "owner": {"reputation": 1317, "user_id": 2013212, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/8ad34e90fc30380965ee659d6a825b8c?s=128&d=identicon&r=PG", "display_name": "Jonathon Nordquist", "link": "https://stackoverflow.com/users/2013212/jonathon-nordquist"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 196, "favorite_count": 0, "accepted_answer_id": 48532576, "answer_count": 1, "score": 0, "last_activity_date": 1517364463, "creation_date": 1517352870, "question_id": 48531816, "link": "https://stackoverflow.com/questions/48531816/need-to-count-the-number-of-emails-in-a-string-using-capybara-rspec", "title": "Need to count the number of emails in a string using Capybara/RSpec", "body": "<p>So I have an application which holds multiple entries that are strings of comma separated emails.  The strings live in text area elements where they can be modified.  The application uses JavaScript to modify these strings, I need to use Capybara to watch verify that a target string has the correct number of emails in it.  To illustrate what I mean here's my Cucumber (assuming the target list starts with a 5 email string):</p>\n\n<pre><code>When I remove the 3rd email under list one\nThen I should see 4 emails under list one\nWhen I click the \"Cancel\" button for list one\nThen I should see 5 emails under list one\n</code></pre>\n\n<p>I can pretty easily grab the string with Capybara like so:</p>\n\n<pre><code>expect(page).to have_css(\".css-selectors textarea\")\n</code></pre>\n\n<p>but I don't know what to do from there.  I need to be able to assert that the number of emails in the string is in fact changing to the desired number.  I need to split the string and count the number of emails to see if they match the target number, but everything I've tried leads to a race condition where Capybara checks the value before the JS can finish updating.  I've looked into passing a filter block to the have_css call but I can't find documentation on how that would work, or if it's even the right tactic.  And so I'm out of ideas here.</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 32451, "user_id": 2516474, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a2179a340c0e84edc285d432211145d?s=128&d=identicon&r=PG", "display_name": "SteveTurczyn", "link": "https://stackoverflow.com/users/2516474/steveturczyn"}, "edited": false, "score": 4, "creation_date": 1517350931, "post_id": 48531427, "comment_id": 84058500, "body": "Why don&#39;t you add something to <code>config&#47;initializers</code> ?  <code>startup_cron.rb</code> which contains <code>Cron.run</code> ?"}, {"owner": {"reputation": 2960, "user_id": 7426461, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/Ldwxy.jpg?s=128&g=1", "display_name": "Cannon Moyer", "link": "https://stackoverflow.com/users/7426461/cannon-moyer"}, "reply_to_user": {"reputation": 32451, "user_id": 2516474, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a2179a340c0e84edc285d432211145d?s=128&d=identicon&r=PG", "display_name": "SteveTurczyn", "link": "https://stackoverflow.com/users/2516474/steveturczyn"}, "edited": false, "score": 0, "creation_date": 1517351649, "post_id": 48531427, "comment_id": 84058792, "body": "Such an easy solution! This worked, thanks! @SteveTurczyn"}, {"owner": {"reputation": 16402, "user_id": 4025095, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/blJ4L.jpg?s=128&g=1", "display_name": "Myst", "link": "https://stackoverflow.com/users/4025095/myst"}, "reply_to_user": {"reputation": 32451, "user_id": 2516474, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a2179a340c0e84edc285d432211145d?s=128&d=identicon&r=PG", "display_name": "SteveTurczyn", "link": "https://stackoverflow.com/users/2516474/steveturczyn"}, "edited": false, "score": 0, "creation_date": 1517366015, "post_id": 48531427, "comment_id": 84062759, "body": "@SteveTurczyn - would you mind posting your comment as an answer, so the question would be flagged as &quot;answered&quot; ... and would stop popping up on my screen ;-) ...?"}, {"owner": {"reputation": 32451, "user_id": 2516474, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a2179a340c0e84edc285d432211145d?s=128&d=identicon&r=PG", "display_name": "SteveTurczyn", "link": "https://stackoverflow.com/users/2516474/steveturczyn"}, "reply_to_user": {"reputation": 16402, "user_id": 4025095, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/blJ4L.jpg?s=128&g=1", "display_name": "Myst", "link": "https://stackoverflow.com/users/4025095/myst"}, "edited": false, "score": 0, "creation_date": 1517392474, "post_id": 48531427, "comment_id": 84073380, "body": "@Myst no problem, now done. :)"}], "answers": [{"tags": [], "owner": {"reputation": 32451, "user_id": 2516474, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a2179a340c0e84edc285d432211145d?s=128&d=identicon&r=PG", "display_name": "SteveTurczyn", "link": "https://stackoverflow.com/users/2516474/steveturczyn"}, "is_accepted": true, "score": 2, "last_activity_date": 1517392457, "creation_date": 1517392457, "answer_id": 48539193, "question_id": 48531427, "link": "https://stackoverflow.com/questions/48531427/automatically-run-ruby-script-after-server-load-ruby-on-rails/48539193#48539193", "title": "Automatically run ruby script after server load - Ruby on Rails", "body": "<p>If you want to execute code when rails is started, add an initializer.</p>\n\n<p>It just needs the one line you want to execute.</p>\n\n<p><em>config/initializers/startup_cron.rb</em></p>\n\n<pre><code>Cron.run\n</code></pre>\n"}], "owner": {"reputation": 2960, "user_id": 7426461, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/Ldwxy.jpg?s=128&g=1", "display_name": "Cannon Moyer", "link": "https://stackoverflow.com/users/7426461/cannon-moyer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 63, "favorite_count": 1, "accepted_answer_id": 48539193, "answer_count": 1, "score": 0, "last_activity_date": 1517392457, "creation_date": 1517350587, "question_id": 48531427, "link": "https://stackoverflow.com/questions/48531427/automatically-run-ruby-script-after-server-load-ruby-on-rails", "title": "Automatically run ruby script after server load - Ruby on Rails", "body": "<p>I have a file named Cron.rb located in app/lib. </p>\n\n<p>To execute the file I do something like this. </p>\n\n<pre><code>Cron.run\n</code></pre>\n\n<p>This executes a method which creates a thread and processes cron jobs that I have programmed into the file. </p>\n\n<p>I want a graceful way of automatically starting this Cron.run function when rails is started in either development or production. I can't use a cron Job to start this file. I want it to start alongside the current instance of ActiveRecord with all the other Models, etc.</p>\n"}, {"tags": ["c", "ruby", "dll", "ffi", "fiddle"], "comments": [{"owner": {"reputation": 10161, "user_id": 4677951, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/fnR1Z.png?s=128&g=1", "display_name": "shadowsheep", "link": "https://stackoverflow.com/users/4677951/shadowsheep"}, "edited": false, "score": 0, "creation_date": 1517350532, "post_id": 48531371, "comment_id": 84058343, "body": "I suggest taking a look at this <a href=\"http://swig.org\" rel=\"nofollow noreferrer\">swig.org</a>"}, {"owner": {"reputation": 23, "user_id": 8974331, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/df4b8c154fab8525b73bb0491f92fa2d?s=128&d=identicon&r=PG&f=1", "display_name": "Yof", "link": "https://stackoverflow.com/users/8974331/yof"}, "reply_to_user": {"reputation": 10161, "user_id": 4677951, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/fnR1Z.png?s=128&g=1", "display_name": "shadowsheep", "link": "https://stackoverflow.com/users/4677951/shadowsheep"}, "edited": false, "score": 0, "creation_date": 1517351892, "post_id": 48531371, "comment_id": 84058895, "body": "@shadowsheep SWIG is used for creating extensions though and I&#39;m looking to just load a dll file into my Ruby app and use the functions in it. Am I missing something here?"}, {"owner": {"reputation": 10161, "user_id": 4677951, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/fnR1Z.png?s=128&g=1", "display_name": "shadowsheep", "link": "https://stackoverflow.com/users/4677951/shadowsheep"}, "edited": false, "score": 0, "creation_date": 1517352027, "post_id": 48531371, "comment_id": 84058956, "body": "Nope! You can use swig to auto generate ruby wrapoer for your dll like that <a href=\"http://web.mit.edu/svn/src/swig-1.3.25/Examples/ruby/class/index.html\" rel=\"nofollow noreferrer\">web.mit.edu/svn/src/swig-1.3.25/Examples/ruby/class/index.ht&zwnj;&#8203;ml</a>"}, {"owner": {"reputation": 10161, "user_id": 4677951, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/fnR1Z.png?s=128&g=1", "display_name": "shadowsheep", "link": "https://stackoverflow.com/users/4677951/shadowsheep"}, "edited": false, "score": 0, "creation_date": 1517352322, "post_id": 48531371, "comment_id": 84059052, "body": "See at the tutorial <a href=\"http://www.swig.org/tutorial.html\" rel=\"nofollow noreferrer\">swig.org/tutorial.html</a> sorry I don\u2019t answer with a live example \u2018cause are on my mobile right now."}, {"owner": {"reputation": 23, "user_id": 8974331, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/df4b8c154fab8525b73bb0491f92fa2d?s=128&d=identicon&r=PG&f=1", "display_name": "Yof", "link": "https://stackoverflow.com/users/8974331/yof"}, "reply_to_user": {"reputation": 10161, "user_id": 4677951, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/fnR1Z.png?s=128&g=1", "display_name": "shadowsheep", "link": "https://stackoverflow.com/users/4677951/shadowsheep"}, "edited": false, "score": 0, "creation_date": 1517352628, "post_id": 48531371, "comment_id": 84059167, "body": "Oh cool! O.k thank you! :)"}, {"owner": {"reputation": 10161, "user_id": 4677951, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/fnR1Z.png?s=128&g=1", "display_name": "shadowsheep", "link": "https://stackoverflow.com/users/4677951/shadowsheep"}, "edited": false, "score": 0, "creation_date": 1517352890, "post_id": 48531371, "comment_id": 84059242, "body": "U\u2019r welcome! Happy learning!"}, {"owner": {"reputation": 10161, "user_id": 4677951, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/fnR1Z.png?s=128&g=1", "display_name": "shadowsheep", "link": "https://stackoverflow.com/users/4677951/shadowsheep"}, "edited": false, "score": 0, "creation_date": 1517397260, "post_id": 48531371, "comment_id": 84076705, "body": "I&#39;ve posted an answer for OSX, I hope could help"}, {"owner": {"reputation": 23, "user_id": 8974331, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/df4b8c154fab8525b73bb0491f92fa2d?s=128&d=identicon&r=PG&f=1", "display_name": "Yof", "link": "https://stackoverflow.com/users/8974331/yof"}, "reply_to_user": {"reputation": 10161, "user_id": 4677951, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/fnR1Z.png?s=128&g=1", "display_name": "shadowsheep", "link": "https://stackoverflow.com/users/4677951/shadowsheep"}, "edited": false, "score": 0, "creation_date": 1517419513, "post_id": 48531371, "comment_id": 84091892, "body": "It does, Thank you!!"}, {"owner": {"reputation": 10161, "user_id": 4677951, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/fnR1Z.png?s=128&g=1", "display_name": "shadowsheep", "link": "https://stackoverflow.com/users/4677951/shadowsheep"}, "edited": false, "score": 0, "creation_date": 1517420806, "post_id": 48531371, "comment_id": 84092623, "body": "So if it answers your question, could you flag it as the accepted one?"}], "answers": [{"tags": [], "owner": {"reputation": 10161, "user_id": 4677951, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/fnR1Z.png?s=128&g=1", "display_name": "shadowsheep", "link": "https://stackoverflow.com/users/4677951/shadowsheep"}, "is_accepted": true, "score": 2, "last_activity_date": 1517420132, "last_edit_date": 1517420132, "creation_date": 1517392717, "answer_id": 48539292, "question_id": 48531371, "link": "https://stackoverflow.com/questions/48531371/access-dll-function-on-c-project-from-ruby/48539292#48539292", "title": "access dll function on C project from Ruby", "body": "<p>I suggest using SWIG (<a href=\"http://swig.org\" rel=\"nofollow noreferrer\">http://swig.org</a>)</p>\n\n<p>I'll give you an example on OSX but you could find the equivalent on Windows as well. </p>\n\n<p>Let's say you have a library (in my case hello.bundle or in your case hello.DLL) with this header file <code>hello.h</code></p>\n\n<pre><code>#ifndef __HELLO__\n#define __HELLO__\n\nextern void say_hello(void); \n\n#endif\n</code></pre>\n\n<p>and you wanna call <code>say_hello</code> from a ruby program like that run.rb:</p>\n\n<pre><code># file: run.rb\nrequire 'hello'\n\n# Call a c function\nHello.say_hello\n</code></pre>\n\n<p>(Pay attention here that the module name is Capitalised)</p>\n\n<p>what you have to do is to create a file <code>hello.i</code> like that:</p>\n\n<pre><code>%module hello\n %{\n #include \"hello.h\"\n %}\n\n // Parse the original header file\n %include \"hello.h\"\n</code></pre>\n\n<p>And then run the command:</p>\n\n<pre><code>swig -ruby hello.i\n</code></pre>\n\n<p>This will generate a file <code>.c</code> that is a wrapper that will be installed as a wrapper module for your ruby environment: <code>hello_wrap.c</code>.</p>\n\n<p>Then you need to create a file <code>extconf.rb</code> with this content:</p>\n\n<pre><code>require 'mkmf'\ncreate_makefile('hello')\n</code></pre>\n\n<p>Pay attention that here \"hello\" is the name of our module in the file <code>.i</code>.</p>\n\n<p>Then you must run <code>ruby extconf.rb</code> that will generate a Makefile.</p>\n\n<pre><code>ruby extconf.rb    \ncreating Makefile\n</code></pre>\n\n<p>Then you must type <code>make</code> that will compile the <code>_wrap.c</code> file against the library (in my case .bundle in your case .DLL).</p>\n\n<pre><code>make\ncompiling hello_wrap.c\nlinking shared-object hello.bundle\n</code></pre>\n\n<p>Now you must type <code>make install</code> (or sudo make install on Unix/Osx)</p>\n\n<pre><code>sudo make install\nPassword:\n/usr/bin/install -c -m 0755 hello.bundle /Library/Ruby/Site/2.3.0/universal-darwin17\n</code></pre>\n\n<p>Then you can run your program run.rb</p>\n\n<pre><code>ruby run.rb \nHello, world!\n</code></pre>\n\n<p>I'll paste here below the <code>.c</code> file used to generate the library hello.bundle</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include \"hello.h\"\n\nvoid say_hello(void) {\n    printf(\"Hello, world!\\n\");\n    return;\n}\n</code></pre>\n\n<p>If you leave this file along with it's <code>.h</code> file the Makefile will build the library for you</p>\n\n<pre><code>make\ncompiling hello.c\ncompiling hello_wrap.c\nlinking shared-object hello.bundle\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 8974331, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/df4b8c154fab8525b73bb0491f92fa2d?s=128&d=identicon&r=PG&f=1", "display_name": "Yof", "link": "https://stackoverflow.com/users/8974331/yof"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 275, "favorite_count": 0, "accepted_answer_id": 48539292, "answer_count": 1, "score": 2, "last_activity_date": 1517420132, "creation_date": 1517350296, "question_id": 48531371, "link": "https://stackoverflow.com/questions/48531371/access-dll-function-on-c-project-from-ruby", "title": "access dll function on C project from Ruby", "body": "<p>I have a project written in C controlling hardware devices. I'm trying to access DLL functions in my projects from a Ruby app in order to control the hardware from the Ruby web app. I'm failing in loading the dll project files using FFI and Fiddle. Does anyone have an example I can use to share of a similar case?</p>\n\n<p>Thanks.  </p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-4", "ruby-on-rails-5"], "answers": [{"comments": [{"owner": {"reputation": 133, "user_id": 6427902, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/f83980f84f1a426f857f220724a661f0?s=128&d=identicon&r=PG&f=1", "display_name": "Crazy Coders", "link": "https://stackoverflow.com/users/6427902/crazy-coders"}, "edited": false, "score": 0, "creation_date": 1517351922, "post_id": 48531526, "comment_id": 84058911, "body": "but with this code i can&#39;t get my associated table to link : <code>&lt;%= link_to company_path(c.brand.name,c.id) do  %&gt;</code> here  <code>c.brand.name </code>"}, {"owner": {"reputation": 2946, "user_id": 1430057, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/Tbizp.jpg?s=128&g=1", "display_name": "Subash", "link": "https://stackoverflow.com/users/1430057/subash"}, "reply_to_user": {"reputation": 133, "user_id": 6427902, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/f83980f84f1a426f857f220724a661f0?s=128&d=identicon&r=PG&f=1", "display_name": "Crazy Coders", "link": "https://stackoverflow.com/users/6427902/crazy-coders"}, "edited": false, "score": 0, "creation_date": 1517352207, "post_id": 48531526, "comment_id": 84059016, "body": "@Yal\u0131nSemer You need to do that inside the each categories page, you can do iterate the results you get from <code>Company.where(&#39;name LIKE ?&#39;, &quot;%#{starting_character}%&quot;)</code> and do <code>@companies.each do ... link_to company_path(company.id)</code>"}], "tags": [], "owner": {"reputation": 2946, "user_id": 1430057, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/Tbizp.jpg?s=128&g=1", "display_name": "Subash", "link": "https://stackoverflow.com/users/1430057/subash"}, "is_accepted": false, "score": 1, "last_activity_date": 1517351091, "creation_date": 1517351091, "answer_id": 48531526, "question_id": 48531360, "link": "https://stackoverflow.com/questions/48531360/how-to-show-unique-strings-in-rails/48531526#48531526", "title": "How to show unique strings in Rails?", "body": "<p>You're iterating through all companies so if you have companies like, <code>Facebook</code> and <code>Foxtel</code>, a link with <code>F</code> tag is going to be duplicated. You can do something like</p>\n\n<pre><code>categories = @companies.where(brand_id: @brand.id).pluck(:name).map(&amp;:first).uniq\n</code></pre>\n\n<p>In the above code all it is doing is getting a list of company names and extracting out the first letter and removing the duplicates.</p>\n\n<p>Now you can iterate through the categories and create a link for the category and inside the category page you can get companies starting from that letter</p>\n\n<pre><code>Company.where('name LIKE ?', \"%#{starting_character}%\")\n</code></pre>\n\n<p><code>starting_character</code> gets sent from the list of categories page.</p>\n"}, {"comments": [{"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1517411456, "post_id": 48532478, "comment_id": 84086257, "body": "<code>@list = @companies.group_by {|c| c.name[0]}</code> is a bit cleaner in my opinion and provides the same."}], "tags": [], "owner": {"reputation": 2885, "user_id": 3372172, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Q3RaO.png?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/3372172/pablo"}, "is_accepted": true, "score": 2, "last_activity_date": 1517417220, "last_edit_date": 1517417220, "creation_date": 1517357255, "answer_id": 48532478, "question_id": 48531360, "link": "https://stackoverflow.com/questions/48531360/how-to-show-unique-strings-in-rails/48532478#48532478", "title": "How to show unique strings in Rails?", "body": "<p>New code (with some changes, assuming company belongs_to brand and brand has_many companies)</p>\n\n<pre><code>@brand = Brand.where(slug: params[:brand]).first\n@companies = @brand.companies\n#@list is a hash with letters as keys and an array of companies starting with this letter\n@list = Hash.new { |h,k| h[k]=[] } \n@companies.each { |comp| @list[comp.name[0]] &lt;&lt; comp }\n\n#As \u201cengineersmnky\u201d suggested on a comment the last two sentences can be simplified:\n@list = @companies.group_by { |c| c.name[0] }\n</code></pre>\n\n<p>View:</p>\n\n<pre><code>&lt;% @list.each do |letter, companies| %&gt;\n  &lt;h2&gt;&lt;%= letter %&gt;&lt;h2&gt;\n  &lt;% companies.each do |c| %&gt;     \n    &lt;li&gt;\n      &lt;%= link_to c.name, c %&gt;\n    &lt;/li&gt;\n  &lt;% end %&gt;\n&lt;% end %&gt;\n</code></pre>\n"}], "owner": {"reputation": 133, "user_id": 6427902, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/f83980f84f1a426f857f220724a661f0?s=128&d=identicon&r=PG&f=1", "display_name": "Crazy Coders", "link": "https://stackoverflow.com/users/6427902/crazy-coders"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 75, "favorite_count": 0, "accepted_answer_id": 48532478, "answer_count": 2, "score": -1, "last_activity_date": 1517417220, "creation_date": 1517350260, "last_edit_date": 1517356815, "question_id": 48531360, "link": "https://stackoverflow.com/questions/48531360/how-to-show-unique-strings-in-rails", "title": "How to show unique strings in Rails?", "body": "<p>I want to categorise Companies by letters in my listing page. \nBut there are multiple records that start with the same letter. I can get the first letters of Company names with the <code>.first</code> method.</p>\n\n<p>But my code shows duplicate letters.  </p>\n\n<p>Controller: </p>\n\n<pre><code> @brand = Brand.where(slug: params[:brand]).first\n @companies = Company.where(brand_id: @brand.id)....\n</code></pre>\n\n<p>View: </p>\n\n<pre><code> &lt;% @companies.each do |c| %&gt;\n       &lt;li&gt;\n         &lt;%= link_to company_path(c.brand.name,c.id) do  %&gt;\n            &lt;%= c.name.first %&gt;\n         &lt;% end  %&gt;\n       &lt;/li&gt;\n   &lt;% end %&gt;\n</code></pre>\n\n<p>How would I show only unique letters? </p>\n"}, {"tags": ["ruby", "parsing"], "answers": [{"comments": [{"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 4, "creation_date": 1517348756, "post_id": 48531021, "comment_id": 84057509, "body": "Or <code>File.foreach(fname,&quot;fish&quot;) { |section| section.chomp(&quot;fish&quot;) }</code>"}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "reply_to_user": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 1, "creation_date": 1517348781, "post_id": 48531021, "comment_id": 84057520, "body": "@engineersmnky That&#39;s technically more memory efficient, but also more code. A good call depending on the situation."}, {"owner": {"reputation": 9584, "user_id": 1420684, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/78242bebaa42db9b1f771e6c19a074fe?s=128&d=identicon&r=PG&f=1", "display_name": "Mirror318", "link": "https://stackoverflow.com/users/1420684/mirror318"}, "edited": false, "score": 1, "creation_date": 1517349938, "post_id": 48531021, "comment_id": 84058073, "body": "@tadman <code>File.read</code> will load the whole file at once, not practical for large files. <code>File.foreach</code> is blazing fast, so I&#39;m trying to find ways to use it"}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "reply_to_user": {"reputation": 9584, "user_id": 1420684, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/78242bebaa42db9b1f771e6c19a074fe?s=128&d=identicon&r=PG&f=1", "display_name": "Mirror318", "link": "https://stackoverflow.com/users/1420684/mirror318"}, "edited": false, "score": 0, "creation_date": 1517350040, "post_id": 48531021, "comment_id": 84058108, "body": "@Mirror318 Yeah, there&#39;s trade-offs with both approaches. If your file is &lt;1GB the <code>read</code> method is usually fine, most servers have more than enough memory to handle that. If you&#39;re in a more constrained environment then @engineersmnky&#39;s approach is better."}], "tags": [], "owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "is_accepted": true, "score": 3, "last_activity_date": 1517348604, "creation_date": 1517348604, "answer_id": 48531021, "question_id": 48530767, "link": "https://stackoverflow.com/questions/48530767/ruby-parsing-file-with-delimiter-how-to-not-include-the-delimiter/48531021#48531021", "title": "Ruby parsing file with delimiter\u2014how to not include the delimiter", "body": "<p>The <a href=\"https://ruby-doc.org/core-2.1.0/IO.html#method-c-foreach\" rel=\"nofollow noreferrer\"><code>foreach</code></a> method splits but includes the delimiter, that's just how it works. If you want to hard split on the delimiter and eat that value in the process you can do it manually:</p>\n\n<pre><code>File.read(fname).split('fish')\n</code></pre>\n"}], "owner": {"reputation": 9584, "user_id": 1420684, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/78242bebaa42db9b1f771e6c19a074fe?s=128&d=identicon&r=PG&f=1", "display_name": "Mirror318", "link": "https://stackoverflow.com/users/1420684/mirror318"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 47, "favorite_count": 0, "accepted_answer_id": 48531021, "answer_count": 1, "score": 1, "last_activity_date": 1517348604, "creation_date": 1517347527, "question_id": 48530767, "link": "https://stackoverflow.com/questions/48530767/ruby-parsing-file-with-delimiter-how-to-not-include-the-delimiter", "title": "Ruby parsing file with delimiter\u2014how to not include the delimiter", "body": "<p>This does not include the delimiter:</p>\n\n<pre><code>\"hello1there\".split(\"1\").each {|section| puts section}\n&gt; hello\n&gt; there\n</code></pre>\n\n<p>But when I try something similar with a file:</p>\n\n<pre><code>fname = Rails.root.join('db', 'text.txt')\nFile.foreach(fname, \"fish\") {|section| puts section}\n\n&gt; Hello there\n&gt; How are you\n&gt; fish\n&gt;\n&gt; good bye\n&gt; good morning\n</code></pre>\n\n<p>It includes the delimiter <code>\"fish\"</code> at the end of each section. How do I split a file into sections, and not include the delimiter?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "heroku", "heroku-postgres"], "comments": [{"owner": {"reputation": 1231, "user_id": 1082010, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EiEby.png?s=128&g=1", "display_name": "Mareq", "link": "https://stackoverflow.com/users/1082010/mareq"}, "edited": false, "score": 0, "creation_date": 1517347111, "post_id": 48530194, "comment_id": 84056715, "body": "This gem is skipped because of <code>--skip production</code> switch (it is included only in <i>production</i> group). Try just <code>bundle install</code> and see the result."}, {"owner": {"reputation": 394580, "user_id": 479863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ArUCE.jpg?s=128&g=1", "display_name": "mu is too short", "link": "https://stackoverflow.com/users/479863/mu-is-too-short"}, "edited": false, "score": 0, "creation_date": 1517347536, "post_id": 48530194, "comment_id": 84056935, "body": "You could also avoid this problem (and many problems down the road) by install PostgreSQL in your development and test environments. There are a lot of portability issues that ActiveRecord won&#39;t protect you from so developing and testing with one database while deploying with another is madness."}, {"owner": {"reputation": 151, "user_id": 9277463, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-JYQDrVIYJyQ/AAAAAAAAAAI/AAAAAAAACwQ/wFD8MSfoWpg/photo.jpg?sz=128", "display_name": "Stella Han", "link": "https://stackoverflow.com/users/9277463/stella-han"}, "reply_to_user": {"reputation": 1231, "user_id": 1082010, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EiEby.png?s=128&g=1", "display_name": "Mareq", "link": "https://stackoverflow.com/users/1082010/mareq"}, "edited": false, "score": 0, "creation_date": 1517349076, "post_id": 48530194, "comment_id": 84057676, "body": "@Mareq, i did bundle install, and still had the same error telling me to Add <code>gem &#39;pg&#39;</code> to your Gemfile"}, {"owner": {"reputation": 66, "user_id": 960133, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eaa4976e02977f0abeb5789ecd427b40?s=128&d=identicon&r=PG", "display_name": "lanej", "link": "https://stackoverflow.com/users/960133/lanej"}, "edited": false, "score": 0, "creation_date": 1517353137, "post_id": 48530194, "comment_id": 84059320, "body": "@StellaHan Rails will load Bundler groups depending on your <code>RAILS_ENV</code>.  Make sure <code>RAILS_ENV</code> is defined appropriately in your Heroku configuration and make sure the corresponding Bundler group has the <code>pg</code> gem in it.  For instance, if you are deploying to <code>RAILS_ENV=staging</code>, then the <code>pg</code> gem must be in the <code>staging</code> bundler group.  <code>gem &#39;pg&#39;, groups: %w[staging production]</code>  I think you have not specified <code>RAILS_ENV</code> in your Heroku configuration, therefore Rails is default to <code>development</code> and you do not have <code>pg</code> in your <code>development</code> Bundler group."}, {"owner": {"reputation": 2885, "user_id": 3372172, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Q3RaO.png?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/3372172/pablo"}, "edited": false, "score": 0, "creation_date": 1517357782, "post_id": 48530194, "comment_id": 84060683, "body": "Try adding a specific pg version. In particular not the last one (1.0.0) but the previous one (0.21.0)."}, {"owner": {"reputation": 6942, "user_id": 4172515, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/BYWxd.jpg?s=128&g=1", "display_name": "fool-dev", "link": "https://stackoverflow.com/users/4172515/fool-dev"}, "edited": false, "score": 0, "creation_date": 1517370976, "post_id": 48530194, "comment_id": 84063878, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/48264765/heroku-with-rails-5-error-gemloaderror-specified-postgresql-for-database-ad\">Heroku with rails 5 error Gem::LoadError: Specified &#39;postgresql&#39; for database adapter</a>"}], "answers": [{"tags": [], "owner": {"reputation": 8754, "user_id": 6719819, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/HmF9I.jpg?s=128&g=1", "display_name": "Daniel", "link": "https://stackoverflow.com/users/6719819/daniel"}, "is_accepted": false, "score": 0, "last_activity_date": 1517812927, "creation_date": 1517812927, "answer_id": 48617091, "question_id": 48530194, "link": "https://stackoverflow.com/questions/48530194/rake-assetsprecompile-rake-aborted-error-pushing-to-heroku-ruby-on-rails/48617091#48617091", "title": "rake assets:precompile, rake aborted - error pushing to heroku - ruby on rails", "body": "<p>This may not be the answer you want, but you should avoid using <code>sqlite3</code> for development and then switching to <code>pg</code> for production because of portability issues and general headaches in general.</p>\n\n<p>I recommend you recreate your app in the following manner:</p>\n\n<p><code>rails new name-of-app --database=postgresql</code></p>\n\n<p>In development you always want to think through to the final product. If you know you are going to be deploying it to Heroku, then you know you are going to need PostgreSQL or if you did not know, now you do.</p>\n\n<p>You always want your dev environment to resemble as closely as possible your production environment.</p>\n"}], "owner": {"reputation": 151, "user_id": 9277463, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-JYQDrVIYJyQ/AAAAAAAAAAI/AAAAAAAACwQ/wFD8MSfoWpg/photo.jpg?sz=128", "display_name": "Stella Han", "link": "https://stackoverflow.com/users/9277463/stella-han"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 618, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1517812927, "creation_date": 1517344997, "question_id": 48530194, "link": "https://stackoverflow.com/questions/48530194/rake-assetsprecompile-rake-aborted-error-pushing-to-heroku-ruby-on-rails", "title": "rake assets:precompile, rake aborted - error pushing to heroku - ruby on rails", "body": "<p>I've been trying to deploy my Ruby on Rails app to Heroku but have been running into errors. Really appreciate the help in advance!</p>\n\n<p>I've been following the instructions in this link to deploy my app: <a href=\"http://curriculum.railsbridge.org/intro-to-rails/deploying_to_heroku\" rel=\"nofollow noreferrer\">http://curriculum.railsbridge.org/intro-to-rails/deploying_to_heroku</a></p>\n\n<p>I changed my gemfile to the following and then ran </p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code>bundle install --without production</code></pre>\r\n</div>\r\n</div>\r\n</p>\n\n<p>Gem-file:</p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code>source 'https://rubygems.org'\r\n\r\ngit_source(:github) do |repo_name|\r\n  repo_name = \"#{repo_name}/#{repo_name}\" unless repo_name.include?(\"/\")\r\n  \"https://github.com/#{repo_name}.git\"\r\nend\r\n# Bundle edge Rails instead: gem 'rails', github: 'rails/rails'\r\ngem 'rails', '~&gt; 5.0.3'\r\n\r\n# Use Puma as the app server\r\ngem 'puma', '~&gt; 3.0'\r\n# Use SCSS for stylesheets\r\ngem 'sass-rails', '~&gt; 5.0'\r\n# Use Uglifier as compressor for JavaScript assets\r\ngem 'uglifier', '&gt;= 1.3.0'\r\n# Use CoffeeScript for .coffee assets and views\r\ngem 'coffee-rails', '~&gt; 4.2'\r\n# See https://github.com/rails/execjs#readme for more supported runtimes\r\n# gem 'therubyracer', platforms: :ruby\r\n\r\n# Use jquery as the JavaScript library\r\ngem 'jquery-rails'\r\n# Turbolinks makes navigating your web application faster. Read more: https://github.com/turbolinks/turbolinks\r\ngem 'turbolinks', '~&gt; 5'\r\n# Build JSON APIs with ease. Read more: https://github.com/rails/jbuilder\r\ngem 'jbuilder', '~&gt; 2.5'\r\n# Use Redis adapter to run Action Cable in production\r\n# gem 'redis', '~&gt; 3.0'\r\n# Use ActiveModel has_secure_password\r\n# gem 'bcrypt', '~&gt; 3.1.7'\r\n\r\n# Use Capistrano for deployment\r\n# gem 'capistrano-rails', group: :development\r\n\r\ngroup :development, :test do\r\n  # Call 'byebug' anywhere in the code to stop execution and get a debugger console\r\n  gem 'byebug', platform: :mri\r\n  gem 'sqlite3'\r\nend\r\n\r\ngroup :development do\r\n  # Access an IRB console on exception pages or by using &lt;%= console %&gt; anywhere in the code.\r\n  gem 'web-console', '&gt;= 3.3.0'\r\n  gem 'listen', '~&gt; 3.0.5'\r\n  # Spring speeds up development by keeping your application running in the background. Read more: https://github.com/rails/spring\r\n  gem 'spring'\r\n  gem 'spring-watcher-listen', '~&gt; 2.0.0'\r\nend\r\n\r\ngroup :production do\r\n  gem 'pg'\r\n  gem 'rails_12factor'\r\nend\r\n\r\n# Windows does not include zoneinfo files, so bundle the tzinfo-data gem\r\ngem 'tzinfo-data', platforms: [:mingw, :mswin, :x64_mingw, :jruby]\r\n\r\ngem 'bootstrap-sass', '~&gt; 3.3.7'\r\ngem 'devise', '~&gt; 4.2'\r\n\r\ngem 'toastr-rails', \"~&gt; 1.0\"\r\n\r\ngem 'omniauth', '~&gt; 1.6'\r\ngem 'omniauth-facebook', '~&gt; 4.0'\r\ngem 'paperclip', '~&gt; 5.1.0'\r\ngem 'geocoder', '~&gt; 1.4'\r\n\r\ngem 'jquery-ui-rails', '~&gt; 5.0'\r\ngem 'momentjs-rails', '~&gt; 2.17'</code></pre>\r\n</div>\r\n</div>\r\n</p>\n\n<p>Below is the build log from Heroku. It is complaining about not having gem 'pg' in the gemfile, but I have definitely added it and also did bundle install.</p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code>Running: rake assets:precompile\r\n       rake aborted!\r\n       Gem::LoadError: Specified 'postgresql' for database adapter, but the gem is not loaded. Add `gem 'pg'` to your Gemfile (and ensure its version is at the minimum required by ActiveRecord).</code></pre>\r\n</div>\r\n</div>\r\n</p>\n\n<p>Build log from heroku\n<div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code>-----&gt; Ruby app detected\r\n-----&gt; Compiling Ruby/Rails\r\n-----&gt; Using Ruby version: ruby-2.3.4\r\n###### WARNING:\r\n       You have the `.bundle/config` file checked into your repository\r\n       It contains local state like the location of the installed bundle\r\n       as well as configured git local gems, and other settings that should\r\n       not be shared between multiple checkouts of a single repo. Please\r\n       remove the `.bundle/` folder from your repo and add it to your `.gitignore` file.\r\n       https://devcenter.heroku.com/articles/bundler-configuration\r\n-----&gt; Installing dependencies using bundler 1.15.2\r\n       Running: bundle install --without development:test --path vendor/bundle --binstubs vendor/bundle/bin -j4 --deployment\r\n       Warning: the running version of Bundler (1.15.2) is older than the version that created the lockfile (1.16.1). We suggest you upgrade to the latest version of Bundler by running `gem install bundler`.\r\n       &lt;Fetching a ton of things.....&gt;\r\n       Bundle complete! 25 Gemfile dependencies, 82 gems now installed.\r\n       Gems in the groups development, test and production were not installed.\r\n       Bundled gems are installed into ./vendor/bundle.\r\n       Post-install message from paperclip:\r\n       ##################################################\r\n       #  NOTE FOR UPGRADING FROM 4.3.0 OR EARLIER       #\r\n       ##################################################\r\n       Paperclip is now compatible with aws-sdk &gt;= 2.0.0.\r\n       If you are using S3 storage, aws-sdk &gt;= 2.0.0 requires you to make a few small\r\n       changes:\r\n       * You must set the `s3_region`\r\n       * If you are explicitly setting permissions anywhere, such as in an initializer,\r\n       note that the format of the permissions changed from using an underscore to\r\n       using a hyphen. For example, `:public_read` needs to be changed to\r\n       `public-read`.\r\n       For a walkthrough of upgrading from 4 to 5 and aws-sdk &gt;= 2.0 you can watch\r\n       http://rubythursday.com/episodes/ruby-snack-27-upgrade-paperclip-and-aws-sdk-in-prep-for-rails-5\r\n       Bundle completed (25.24s)\r\n       Cleaning up the bundler cache.\r\n-----&gt; Installing node-v6.11.1-linux-x64\r\n-----&gt; Detecting rake tasks\r\n-----&gt; Preparing app for Rails asset pipeline\r\n       Running: rake assets:precompile\r\n       rake aborted!\r\n       Gem::LoadError: Specified 'postgresql' for database adapter, but the gem is not loaded. Add `gem 'pg'` to your Gemfile (and ensure its version is at the minimum required by ActiveRecord).\r\n       /tmp/build_b5def35a67e05bc1af4c0bb3931868f9/vendor/bundle/ruby/2.3.0/gems/activerecord-5.0.6/lib/active_record/connection_adapters/connection_specification.rb:176:in `rescue in spec'\r\n       \r\n&lt;more errors here&gt;\r\n       /tmp/build_b5def35a67e05bc1af4c0bb3931868f9/vendor/bundle/ruby/2.3.0/gems/rake-12.3.0/exe/rake:27:in `&lt;top (required)&gt;'\r\n       Tasks: TOP =&gt; environment\r\n       (See full trace by running task with --trace)\r\n !\r\n !     Precompiling assets failed.\r\n !\r\n !     Push rejected, failed to compile Ruby app.\r\n !     Push failed</code></pre>\r\n</div>\r\n</div>\r\n</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "stringio"], "answers": [{"comments": [{"owner": {"reputation": 163, "user_id": 8826643, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Q_WvZX8cHD0/AAAAAAAAAAI/AAAAAAAAAZ4/zwbSRnVG-sc/photo.jpg?sz=128", "display_name": "Jon E Kilborn", "link": "https://stackoverflow.com/users/8826643/jon-e-kilborn"}, "edited": false, "score": 1, "creation_date": 1517346215, "post_id": 48530380, "comment_id": 84056236, "body": "Awesome answer. Thank you!"}, {"owner": {"reputation": 803, "user_id": 6360989, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/e0DdG.jpg?s=128&g=1", "display_name": "iamcaleberic", "link": "https://stackoverflow.com/users/6360989/iamcaleberic"}, "reply_to_user": {"reputation": 163, "user_id": 8826643, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Q_WvZX8cHD0/AAAAAAAAAAI/AAAAAAAAAZ4/zwbSRnVG-sc/photo.jpg?sz=128", "display_name": "Jon E Kilborn", "link": "https://stackoverflow.com/users/8826643/jon-e-kilborn"}, "edited": false, "score": 0, "creation_date": 1517346600, "post_id": 48530380, "comment_id": 84056441, "body": "Am glad to help"}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 1, "creation_date": 1517363021, "post_id": 48530380, "comment_id": 84062009, "body": "I suggest you link to relevant parts of Ruby docs, rather than copying part or all of their contents.That way readers can skip the link if they already know what the doc says. Also, without the link readers may have trouble finding the doc for a fuller read. I suggest, for example, &quot;<a href=\"http://ruby-doc.org/core-2.4.0/IO.html#.method-i-close\" rel=\"nofollow noreferrer\">IO.close</a> closes the file and clears any pending writes.&quot;. At a minimum, write <code>close</code> as <code>IO#close</code>"}], "tags": [], "owner": {"reputation": 803, "user_id": 6360989, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/e0DdG.jpg?s=128&g=1", "display_name": "iamcaleberic", "link": "https://stackoverflow.com/users/6360989/iamcaleberic"}, "is_accepted": true, "score": 19, "last_activity_date": 1517391506, "last_edit_date": 1592644375, "creation_date": 1517345824, "answer_id": 48530380, "question_id": 48530095, "link": "https://stackoverflow.com/questions/48530095/what-does-the-rewind-method-do-on-a-tempfile-in-ruby/48530380#48530380", "title": "What does the .rewind method do on a Tempfile in ruby?", "body": "<p><strong>Rewind</strong> - Read more about it on  <a href=\"http://ruby-doc.org/core-2.5.0/IO.html#method-i-rewind\" rel=\"noreferrer\">ruby docs</a></p>\n<p><strong>IO#Close</strong> - Read more on the <a href=\"http://ruby-doc.org/core-2.5.0/IO.html#method-i-close\" rel=\"noreferrer\">ruby docs</a></p>\n<p><strong>Read</strong> - Read more on the <a href=\"http://ruby-doc.org/core-2.5.0/IO.html#method-c-read\" rel=\"noreferrer\">ruby docs</a></p>\n<p><em><strong>Summary</strong></em></p>\n<blockquote>\n<p><strong><a href=\"http://ruby-doc.org/core-2.5.0/IO.html#method-i-rewind\" rel=\"noreferrer\">rewind</a></strong><br />\nPositions ios to the beginning of input, resetting lineno to zero.\nRewind resets the line number to zero</p>\n</blockquote>\n<pre><code>f = File.new(&quot;testfile&quot;)\nf.readline   #=&gt; &quot;This is line one\\n&quot;\nf.rewind     #=&gt; 0\nf.lineno     #=&gt; 0\nf.readline   #=&gt; &quot;This is line one\\n&quot;\n</code></pre>\n<blockquote>\n<p><strong><a href=\"http://ruby-doc.org/core-2.5.0/IO.html#method-i-close\" rel=\"noreferrer\">IO#close</a></strong><br />\nCloses ios and flushes any pending writes to the operating\nsystem.</p>\n<p><strong><a href=\"http://ruby-doc.org/core-2.5.0/IO.html#method-c-read\" rel=\"noreferrer\">read</a>([length [, outbuf]])</strong></p>\n<p>Reads length bytes from the I/O stream. Length must be a non-negative integer or nil. <em><strong>If length is zero, it returns an empty string (&quot;&quot;).</strong></em></p>\n</blockquote>\n"}], "owner": {"reputation": 163, "user_id": 8826643, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Q_WvZX8cHD0/AAAAAAAAAAI/AAAAAAAAAZ4/zwbSRnVG-sc/photo.jpg?sz=128", "display_name": "Jon E Kilborn", "link": "https://stackoverflow.com/users/8826643/jon-e-kilborn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6068, "favorite_count": 1, "accepted_answer_id": 48530380, "answer_count": 1, "score": 16, "last_activity_date": 1517391506, "creation_date": 1517344546, "question_id": 48530095, "link": "https://stackoverflow.com/questions/48530095/what-does-the-rewind-method-do-on-a-tempfile-in-ruby", "title": "What does the .rewind method do on a Tempfile in ruby?", "body": "<p>I've looked through <a href=\"https://ruby-doc.org/stdlib-1.9.3/libdoc/tempfile/rdoc/Tempfile.html\" rel=\"noreferrer\">these docs</a> and Google, and can't seem to find the purpose of <code>.rewind</code>, and how it differs from <code>.close</code>, in the context of working with a <code>Tempfile</code>.</p>\n\n<p>Also, why does <code>.read</code> return an empty string before rewinding?</p>\n\n<p>Here is an example:</p>\n\n<pre><code>file = Tempfile.new('foo')\nfile.path      # =&gt; A unique filename in the OS's temp directory,\n               #    e.g.: \"/tmp/foo.24722.0\"\n               #    This filename contains 'foo' in its basename.\nfile.write(\"hello world\")\nfile.rewind\nfile.read      # =&gt; \"hello world\"\nfile.close\nfile.unlink    # deletes the temp file\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "controller"], "comments": [{"owner": {"reputation": 803, "user_id": 6360989, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/e0DdG.jpg?s=128&g=1", "display_name": "iamcaleberic", "link": "https://stackoverflow.com/users/6360989/iamcaleberic"}, "edited": false, "score": 1, "creation_date": 1517344376, "post_id": 48529896, "comment_id": 84055357, "body": "sounds like an issue with your editor try...after generating the controller remove the project from editor and open it again..."}, {"owner": {"reputation": 1145, "user_id": 3262916, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/91abfd08a0e41f2c1b292d233100e5a4?s=128&d=identicon&r=PG", "display_name": "Ziv Galili", "link": "https://stackoverflow.com/users/3262916/ziv-galili"}, "edited": false, "score": 1, "creation_date": 1517353223, "post_id": 48529896, "comment_id": 84059348, "body": "which editor do you use?"}, {"owner": {"reputation": 1, "user_id": 9291091, "user_type": "registered", "profile_image": "https://graph.facebook.com/10159855825990463/picture?type=large", "display_name": "Miguel Aristondo", "link": "https://stackoverflow.com/users/9291091/miguel-aristondo"}, "edited": false, "score": 0, "creation_date": 1517360259, "post_id": 48529896, "comment_id": 84061355, "body": "I&#39;m using Atom and iterm3 for the terminal. I tried by removing the project and starting again but same problem, it must be something simple I guess, because I&#39;m a beginner n ruby on rails."}], "answers": [{"tags": [], "owner": {"reputation": 976, "user_id": 1980034, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/997b706f5854b7c79e1391d31664af3c?s=128&d=identicon&r=PG", "display_name": "faron", "link": "https://stackoverflow.com/users/1980034/faron"}, "is_accepted": false, "score": 0, "last_activity_date": 1517350730, "creation_date": 1517350730, "answer_id": 48531457, "question_id": 48529896, "link": "https://stackoverflow.com/questions/48529896/terminal-does-not-generate-controller-in-the-editor/48531457#48531457", "title": "Terminal does not generate controller in the editor", "body": "<p>Looks like your editor has cached file tree, you need to refresh it. </p>\n\n<p>What is the editor?</p>\n"}], "owner": {"reputation": 1, "user_id": 9291091, "user_type": "registered", "profile_image": "https://graph.facebook.com/10159855825990463/picture?type=large", "display_name": "Miguel Aristondo", "link": "https://stackoverflow.com/users/9291091/miguel-aristondo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 48, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1517350730, "creation_date": 1517343781, "last_edit_date": 1517349354, "question_id": 48529896, "link": "https://stackoverflow.com/questions/48529896/terminal-does-not-generate-controller-in-the-editor", "title": "Terminal does not generate controller in the editor", "body": "<p>I am new to programming in Ruby and Rails. I am following the instructions to generate a new controller (rails generate controller welcome index). In the terminal, it creates correctly the controller, it appears: </p>\n\n<pre><code>create  app/controllers/welcome_controller.rb\n/ route  get 'welcome/index' \n/ invoke  erb\n/ create    app/views/welcome \n/ create    app/views/welcome/index.html.erb \n</code></pre>\n\n<p>and the rest.. but I can't see the controller in the text editor.  </p>\n\n<p>I tried to delete and generate again the controller, and I have also check with ls in the terminal, and it lists the controller, but in my text editor, I don't see the view and the action in the controller. I am using a ruby 2.3.3 in a mac.   </p>\n"}, {"tags": ["ruby", "ruby-on-rails-4", "openssl"], "comments": [{"owner": {"reputation": 38170, "user_id": 57135, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/S9roh.jpg?s=128&g=1", "display_name": "Joe", "link": "https://stackoverflow.com/users/57135/joe"}, "edited": false, "score": 0, "creation_date": 1517346853, "post_id": 48529779, "comment_id": 84056577, "body": "There&#39;s a lot of logic to some of those commands wrapped up in the OpenSSL CLI.  There are not single API calls to the OpenSSL API that do many of them.  The last time we faced this prospect we gave up and just shelled out to run the openssl CLI commands."}, {"owner": {"reputation": 23809, "user_id": 351909, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/71a6b8a36a63c2cb9de678c07be6d8a4?s=128&d=identicon&r=PG", "display_name": "moritz", "link": "https://stackoverflow.com/users/351909/moritz"}, "edited": false, "score": 0, "creation_date": 1517356545, "post_id": 48529779, "comment_id": 84060373, "body": "Also, ruby&#39;s openssl essentially wraps openssl so you need to install the libs anyways. Depending on the distribution and its packaging, the libs can be installed separately from the command line utils, e.g. in ubuntu there is libssl and openssl."}], "owner": {"reputation": 121, "user_id": 3754535, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/e3e9a6cd050b583ed82c84e99a0e0eb1?s=128&d=identicon&r=PG&f=1", "display_name": "user3754535", "link": "https://stackoverflow.com/users/3754535/user3754535"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 72, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1517343295, "creation_date": 1517343295, "question_id": 48529779, "link": "https://stackoverflow.com/questions/48529779/openssl-commands-to-ruby", "title": "OpenSSL commands to Ruby", "body": "<p>Is there a way to run the following shell commands only on ruby?</p>\n\n<p>I searched for weeks but I'm afraid it's not very well documented. I've tried a few methods from Ruby 'openssl' but I get different results.</p>\n\n<pre><code>%x[openssl pkcs8 -inform DER -in key.key -passin pass:passcode -out key.pem]\n%x[openssl x509 -inform DER -in certificate.cer -noout -serial &gt; serial.txt]\n%x[openssl dgst -sha256 -out sign.bin -sign key.pem serial.txt]\n%x[openssl enc -in sign.bin -a -A -out stamp.txt]\n</code></pre>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1517343418, "post_id": 48529615, "comment_id": 84054946, "body": "The difference between &quot;private&quot; and &quot;public&quot; depends on who&#39;s asking, but I&#39;m not sure Ruby&#39;s reflection features properly categorize things all the time. &quot;Protected&quot; is just a way of saying &quot;public for some, private for others&quot;."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 2, "creation_date": 1517346148, "post_id": 48529615, "comment_id": 84056202, "body": "<a href=\"http://blade.nagaokaut.ac.jp/cgi-bin/scat.rb/ruby/ruby-talk/245072\" rel=\"nofollow noreferrer\">Matz says</a>, &quot;If you understand the current behavior of protected visibility, you will understand why protected_class_method is not useful at all. That&#39;s why we don&#39;t have it.&quot;"}], "answers": [{"comments": [{"owner": {"reputation": 59, "user_id": 9290781, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/726bfc33e95b53a658355254873aea37?s=128&d=identicon&r=PG&f=1", "display_name": "preetpalS", "link": "https://stackoverflow.com/users/9290781/preetpals"}, "reply_to_user": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1517397147, "post_id": 48531343, "comment_id": 84076630, "body": "@CarySwoveland That&#39;s something I never considered before. Another question I have, is would a &quot;protected_class_method&quot; instance method on the &quot;Module&quot; class be made redundant by the method described in the EDIT made in the answer"}, {"owner": {"reputation": 32451, "user_id": 2516474, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a2179a340c0e84edc285d432211145d?s=128&d=identicon&r=PG", "display_name": "SteveTurczyn", "link": "https://stackoverflow.com/users/2516474/steveturczyn"}, "edited": false, "score": 0, "creation_date": 1517402931, "post_id": 48531343, "comment_id": 84080086, "body": "<code>protected_class_method</code> still doesn&#39;t really make sense at a class level. The EDIT code created a protected method for ALL classes. Well, all classes that inherit from <code>Class</code>, which is by design pretty much all standard classes and the default for new classes. Whether you want that kind of global impact is debatable."}, {"owner": {"reputation": 59, "user_id": 9290781, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/726bfc33e95b53a658355254873aea37?s=128&d=identicon&r=PG&f=1", "display_name": "preetpalS", "link": "https://stackoverflow.com/users/9290781/preetpals"}, "edited": false, "score": 0, "creation_date": 1517411145, "post_id": 48531343, "comment_id": 84086055, "body": "@SteveTurczyn The global impact would be undesirable IMHO in terms of the effects of the EDIT code. What I was thinking of was that if there was a &quot;protected_class_method&quot; instance method on the Module class that you could have a method (with a different implementation per each class) that could that only be invoked on classes by other classes perhaps to get metadata from the other class (but that&#39;s not useful IMO). Example: <code>class A; protected_class_method def self.m; :metadata; end; end</code> , <code>class B; def self.p(a); puts a.class.m; end; end</code> , where <code>A.m</code> would fail, but <code>B.p(A.new)</code> wouldn&#39;t."}, {"owner": {"reputation": 32451, "user_id": 2516474, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a2179a340c0e84edc285d432211145d?s=128&d=identicon&r=PG", "display_name": "SteveTurczyn", "link": "https://stackoverflow.com/users/2516474/steveturczyn"}, "edited": false, "score": 0, "creation_date": 1517412812, "post_id": 48531343, "comment_id": 84087226, "body": "I can only see this working with the modifications to <code>Class</code>.  It doesn&#39;t work with sub-classes (say you wanted to make a class ProtectedMethod and class Dog and class Cat that both inherit from ProtectedMethod) as protected methods in a sub-class are either instance methods or not protected.  So, no, don&#39;t think it&#39;s possible, someone smarter than me might find a way."}, {"owner": {"reputation": 32451, "user_id": 2516474, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a2179a340c0e84edc285d432211145d?s=128&d=identicon&r=PG", "display_name": "SteveTurczyn", "link": "https://stackoverflow.com/users/2516474/steveturczyn"}, "reply_to_user": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 1, "creation_date": 1517468343, "post_id": 48531343, "comment_id": 84109761, "body": "@CarySwoveland ok, but don&#39;t let it happen again in another eight years... :)"}, {"owner": {"reputation": 59, "user_id": 9290781, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/726bfc33e95b53a658355254873aea37?s=128&d=identicon&r=PG&f=1", "display_name": "preetpalS", "link": "https://stackoverflow.com/users/9290781/preetpals"}, "edited": false, "score": 0, "creation_date": 1519112167, "post_id": 48531343, "comment_id": 84763955, "body": "@SteveTurczyn <b>protected</b> can actually make a difference for class methods if you consider inheritance and explicit receivers (see: <a href=\"https://stackoverflow.com/a/48879939/9290781\">stackoverflow.com/a/48879939/9290781</a>)."}], "tags": [], "owner": {"reputation": 32451, "user_id": 2516474, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a2179a340c0e84edc285d432211145d?s=128&d=identicon&r=PG", "display_name": "SteveTurczyn", "link": "https://stackoverflow.com/users/2516474/steveturczyn"}, "is_accepted": false, "score": 3, "last_activity_date": 1517351945, "last_edit_date": 1517351945, "creation_date": 1517350182, "answer_id": 48531343, "question_id": 48529615, "link": "https://stackoverflow.com/questions/48529615/why-does-the-instance-method-protected-class-method-not-exist-for-the-module/48531343#48531343", "title": "Why does the instance method &quot;protected_class_method&quot; not exist for the &quot;Module&quot; class in Ruby?", "body": "<p>For me, protected methods only make sense as instance methods.</p>\n\n<p>Protected methods can be called by other instances of the same class.</p>\n\n<pre><code>class Student\n  def initialize(age)\n    @age = age\n  end\n  def older_than?(other)\n    age &gt; other.age\n  end\n  protected\n  def age\n    @age\n  end\nend\n</code></pre>\n\n<p>You can't directly call <code>age</code> on a Student instance</p>\n\n<pre><code>student1 = Student.new(21)\n\nstudent1.age\nNoMethodError: protected method `age' called for #&lt;Student:0x514d058 @age=21&gt;\n</code></pre>\n\n<p>But student1 can reference student2's age</p>\n\n<pre><code>student2 = Student.new(23)\n\nstudent2.older_than?(student1)\n =&gt; true\n</code></pre>\n\n<p>So you can see how an instance's protected methods uniqueness is its ability to be referenced from another instance.</p>\n\n<p>I can't see how you would use a class \"protected method\"... there's no scenario similar to the above.</p>\n\n<p>EDIT</p>\n\n<p>Thanks to Cary Swoveland completely messing with my mind, I realise you can do the following...</p>\n\n<pre><code>class Class\n  def show_k(klass)\n    klass.k\n  end\n  protected\n  def k\n    \"This is k\"\n  end\nend\n</code></pre>\n\n<p>Now if I do </p>\n\n<pre><code>String.k \nNoMethodError: protected method `k' called for String:Class\n</code></pre>\n\n<p>But if I do...</p>\n\n<pre><code>Integer.show_k(String)\n=&gt; \"This is k\"\n</code></pre>\n\n<p>Possible because classes are instances of the Class class.</p>\n\n<p>I'm still not sure how I'd use this, but there you go.</p>\n"}, {"comments": [{"owner": {"reputation": 59, "user_id": 9290781, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/726bfc33e95b53a658355254873aea37?s=128&d=identicon&r=PG&f=1", "display_name": "preetpalS", "link": "https://stackoverflow.com/users/9290781/preetpals"}, "edited": false, "score": 0, "creation_date": 1519110531, "post_id": 48556024, "comment_id": 84763175, "body": "The last line of this answer is not 100% correct if you consider inheritance and invoking class methods with an explicit receiver."}, {"owner": {"reputation": 59, "user_id": 9290781, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/726bfc33e95b53a658355254873aea37?s=128&d=identicon&r=PG&f=1", "display_name": "preetpalS", "link": "https://stackoverflow.com/users/9290781/preetpals"}, "edited": false, "score": 0, "creation_date": 1519111959, "post_id": 48556024, "comment_id": 84763838, "body": "See <a href=\"https://stackoverflow.com/a/48879939/9290781\">stackoverflow.com/a/48879939/9290781</a> for a possible use case of protected in the context of class methods."}], "tags": [], "owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "is_accepted": false, "score": 1, "last_activity_date": 1519111697, "last_edit_date": 1519111697, "creation_date": 1517463493, "answer_id": 48556024, "question_id": 48529615, "link": "https://stackoverflow.com/questions/48529615/why-does-the-instance-method-protected-class-method-not-exist-for-the-module/48556024#48556024", "title": "Why does the instance method &quot;protected_class_method&quot; not exist for the &quot;Module&quot; class in Ruby?", "body": "<p>Let's define a class with one class method.</p>\n\n<pre><code>class K\n  def self.k\n    'hi'\n  end\nend\n</code></pre>\n\n<p><code>def self.k</code> is just a shorthand way to define an <em>instance method</em> <code>k</code> on <code>K</code>'s singleton class. Let's do that and make it protected.</p>\n\n<pre><code>class K\n  class &lt;&lt; self\n    protected def k\n      puts 'hi'\n    end\n  end\nend\n</code></pre>\n\n<p>We find that</p>\n\n<pre><code>K.k\n  #=&gt; NoMethodError: protected method `k' called for K:Class\n</code></pre>\n\n<p>The only way to invoke this method is (as with private methods) is with an implicit receiver:</p>\n\n<pre><code>class K\n  k\nend\n  #=&gt; 'hi'\n</code></pre>\n\n<p>By definition, a protected instance method defined on a singleton class could be invoked by an instance of the same class, but one can cannot create instances of singleton classes.</p>\n\n<p>This behaviour is the same as private class methods, so it would serve no purpose to have protected ones as well. </p>\n"}, {"comments": [{"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1519112630, "post_id": 48879939, "comment_id": 84764177, "body": "Interesting! So now let&#39;s think how having a protected class method could be useful and also how to interpret Katz&#39;s remark (but for me that will be tomorrow, as I&#39;m falling asleep)."}, {"owner": {"reputation": 59, "user_id": 9290781, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/726bfc33e95b53a658355254873aea37?s=128&d=identicon&r=PG&f=1", "display_name": "preetpalS", "link": "https://stackoverflow.com/users/9290781/preetpals"}, "reply_to_user": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1519113414, "post_id": 48879939, "comment_id": 84764570, "body": "That <a href=\"http://blade.nagaokaut.ac.jp/cgi-bin/scat.rb/ruby/ruby-talk/245072\" rel=\"nofollow noreferrer\">comment</a> was really old (in early 2007 before Ruby 1.9 was released) so Ruby must have changed since then. I have a feeling that he would say that it&#39;s not useful. You might want to check out this <a href=\"https://tenderlovemaking.com/2012/09/07/protected-methods-and-ruby-2-0.html\" rel=\"nofollow noreferrer\">blog post</a>."}], "tags": [], "owner": {"reputation": 59, "user_id": 9290781, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/726bfc33e95b53a658355254873aea37?s=128&d=identicon&r=PG&f=1", "display_name": "preetpalS", "link": "https://stackoverflow.com/users/9290781/preetpals"}, "is_accepted": false, "score": 1, "last_activity_date": 1519113684, "last_edit_date": 1519113684, "creation_date": 1519111901, "answer_id": 48879939, "question_id": 48529615, "link": "https://stackoverflow.com/questions/48529615/why-does-the-instance-method-protected-class-method-not-exist-for-the-module/48879939#48879939", "title": "Why does the instance method &quot;protected_class_method&quot; not exist for the &quot;Module&quot; class in Ruby?", "body": "<p>There is a difference between protected and private when declaring class methods (instance methods on a class's singleton class) if you consider inheritance and usage of explicit receivers in class methods. The following sample was tested using Ruby 2.5.</p>\n\n<pre><code>class A\n  class &lt;&lt; self\n    protected def pro\n      puts 'pro'\n    end\n  end\nend\n\nclass B &lt; A\n  class &lt;&lt; self\n    # Works\n    def explicit_receiver_test\n      self.pro\n    end\n\n    # Works\n    def implicit_receiver_test\n      pro\n    end\n  end\nend\n\nbegin\n  B.pro # Throws: NoMethodError\nrescue NoMethodError =&gt; e\n  puts e.message # Prints: protected method `pro' called for B:Class\nend\nB.explicit_receiver_test # Prints: pro\nB.implicit_receiver_test # Prints: pro\n\nclass C\n  class &lt;&lt; self\n    private def pri\n      puts 'pri'\n    end\n  end\nend\n\nclass D &lt; C\n  class &lt;&lt; self\n    # Fails\n    def explicit_receiver_test\n      self.pri\n    end\n\n    # Works\n    def implicit_receiver_test\n      pri\n    end\n  end\nend\n\nbegin\n  D.pri # Throws: NoMethodError\nrescue NoMethodError =&gt; e\n  puts e.message # Prints: private method `pri' called for D:Class\nend\nbegin\n  D.explicit_receiver_test # Throws: NoMethodError\nrescue NoMethodError =&gt; e\n  puts e.message # Prints: private method `pri' called for D:Class\nend\nD.implicit_receiver_test # Prints: pri\n</code></pre>\n"}], "owner": {"reputation": 59, "user_id": 9290781, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/726bfc33e95b53a658355254873aea37?s=128&d=identicon&r=PG&f=1", "display_name": "preetpalS", "link": "https://stackoverflow.com/users/9290781/preetpals"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 532, "favorite_count": 0, "answer_count": 3, "score": 4, "last_activity_date": 1519113684, "creation_date": 1517342587, "question_id": 48529615, "link": "https://stackoverflow.com/questions/48529615/why-does-the-instance-method-protected-class-method-not-exist-for-the-module", "title": "Why does the instance method &quot;protected_class_method&quot; not exist for the &quot;Module&quot; class in Ruby?", "body": "<p>Why does the instance method \"protected_class_method\" not exist for the \"Module\" class in Ruby, while the \"public_class_method\" and \"private_class_method\" instance methods do exist for the \"Module\" class?</p>\n\n<p>This does not follow the pattern of the \"private\", \"protected\", and \"public\" instance methods all being defined for the \"Module\" class.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "rails-activerecord", "rails-console", "rails-models"], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user9276962"}, "is_accepted": true, "score": 1, "last_activity_date": 1517341667, "creation_date": 1517341667, "answer_id": 48529421, "question_id": 48529151, "link": "https://stackoverflow.com/questions/48529151/trouble-creating-a-new-record-in-rails-with-select-boxes-and-foreign-keys/48529421#48529421", "title": "Trouble creating a new record in Rails with Select Boxes and Foreign Keys", "body": "<p>modify create action as follows</p>\n\n<pre><code>def create\n  @category = Category.find(params[:category_id])\n\n  @issue = @category.issues.build(issue_params)\n\n  respond_to do |format|\n    if @issue.save\n      format.html { redirect_to root_path, notice: 'Issue was successfully created.' }        \n    else\n      @categories = Category.enabled\n      @subcategories = Subcategory.enabled\n      format.html { render :new }        \n    end\n  end\nend\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 7322234, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-CeAKal1ee0E/AAAAAAAAAAI/AAAAAAAADaA/wExxrDMLywY/photo.jpg?sz=128", "display_name": "Lucas Borges", "link": "https://stackoverflow.com/users/7322234/lucas-borges"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 30, "favorite_count": 0, "accepted_answer_id": 48529421, "answer_count": 1, "score": 1, "last_activity_date": 1517341667, "creation_date": 1517340687, "question_id": 48529151, "link": "https://stackoverflow.com/questions/48529151/trouble-creating-a-new-record-in-rails-with-select-boxes-and-foreign-keys", "title": "Trouble creating a new record in Rails with Select Boxes and Foreign Keys", "body": "<p>Ruby on Rails newbie here.</p>\n\n<p><strong>TL;DR: When trying to create a new record, I get an error message saying my foreign keys must exist. I'm using Select Boxes on my view. Need help.</strong></p>\n\n<p>I am creating a requests management system for our own support staff here in our company. So far, I have generated a scaffold for Issues and 2 models, one for Category and another for Subcategory. </p>\n\n<p>So far, the relationship I came up with is designed like this:</p>\n\n<p>Issue belongs to Category and Subcategory\nSubcategory belongs to Category. </p>\n\n<p>This means that a user may have a problem with his keyboard, for which he will create an Issue. This issues would belong the the subcategory named \"Peripherals\", which would in turn, belongs to a broader \"Hardware\" category.</p>\n\n<p>I still need to implement Ajax to fetch data for my Select Boxes, but while testing it out in a simpler scenario, I couldn't create my Issues from the \"New Issue\" view. I come across an error message saying that Category and Subcategory must exist. I've reviewed what I've written so far, but couldn't find my mistake. </p>\n\n<p><strong>Here is the code for my create method in the Issues controller</strong></p>\n\n<pre><code>def create\n  @issue = Issue.new(issue_params)\n\n  respond_to do |format|\n    if @issue.save\n      format.html { redirect_to root_path, notice: 'Issue was successfully created.' }        \n    else\n      @categories = Category.enabled\n      @subcategories = Subcategory.enabled\n      format.html { render :new }        \n    end\n  end\nend\n</code></pre>\n\n<p>Here go my Models</p>\n\n<p><strong>Issue Model:</strong></p>\n\n<pre><code>class Issue &lt; ApplicationRecord\n  belongs_to :category\n  belongs_to :subcategory\nend\n</code></pre>\n\n<p><strong>Category Model:</strong></p>\n\n<pre><code>class Category &lt; ApplicationRecord\n  has_many :subcategories\n  has_many :issues\n\n    enum status: { disabled: 0, enabled: 1 }\n\n    after_initialize :set_defaults\n\n  def self.enabled\n    where(status: 'enabled')\n  end\n\n    def set_defaults\n        self.status ||= 1\n    end\nend\n</code></pre>\n\n<p><strong>Subcategory Model</strong></p>\n\n<pre><code>class Subcategory &lt; ApplicationRecord\n  belongs_to :category\n  has_many :issues\n\n  enum status: { disabled: 0, enabled: 1 } \n\n  def self.enabled\n    where(status: 'enabled')\n  end\n\n  after_initialize :set_defaults\n\n  def set_defaults\n    self.status ||= 1 \n  end\nend\n</code></pre>\n\n<p><strong>And finally, here are the parameters passed to the controller:</strong></p>\n\n<pre><code>Processing by IssuesController#create as HTML\nParameters: {\"utf8\"=&gt;\"\u2713\",  \"authenticity_token\"=&gt;\"tzKDayYfEbEwTaOFup/N9kQ+8tr9c0P5otV2B0boKGrgyv+HkQaEvYJ6ZMQeR+8XgCnhJR6PosVcx0jPJpqBEA==\", \"category_id\"=&gt;\"1\", \"subcategory_id\"=&gt;\"1\", \"issue\"=&gt;{\"description\"=&gt;\"Replace broken keyboard.\", \"status\"=&gt;\"1\", \"criticality_level\"=&gt;\"1\"}, \"commit\"=&gt;\"Create Issue\"}\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/AAnih.jpg\" rel=\"nofollow noreferrer\">I was able to create an Issue via Rails Console, though.</a></p>\n\n<p>Could anyone give me a hint on how to solve this? Thanks guys!</p>\n"}, {"tags": ["ruby", "web-scraping", "nokogiri"], "answers": [{"tags": [], "owner": {"reputation": 23809, "user_id": 351909, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/71a6b8a36a63c2cb9de678c07be6d8a4?s=128&d=identicon&r=PG", "display_name": "moritz", "link": "https://stackoverflow.com/users/351909/moritz"}, "is_accepted": true, "score": 0, "last_activity_date": 1517356701, "creation_date": 1517356701, "answer_id": 48532377, "question_id": 48529107, "link": "https://stackoverflow.com/questions/48529107/want-to-get-taobaos-list-of-url-of-products-on-search-result-page-without-taoba/48532377#48532377", "title": "want to get taobao&#39;s list of URL of products on search result page without taobao API", "body": "<p>I don't know taobao.com but the page seems like its running lots of javascript. So perhaps the content can actually not be retrieved with a client without javascript capabilities. So instead of open-uri, you could try the gem selenium-webdriver:</p>\n\n<p><a href=\"https://rubygems.org/gems/selenium-webdriver/versions/2.53.4\" rel=\"nofollow noreferrer\">https://rubygems.org/gems/selenium-webdriver/versions/2.53.4</a></p>\n"}], "owner": {"reputation": 51, "user_id": 8121740, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/RYiYE.png?s=128&g=1", "display_name": "Lyme", "link": "https://stackoverflow.com/users/8121740/lyme"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 356, "favorite_count": 0, "accepted_answer_id": 48532377, "answer_count": 1, "score": 0, "last_activity_date": 1517356701, "creation_date": 1517340496, "question_id": 48529107, "link": "https://stackoverflow.com/questions/48529107/want-to-get-taobaos-list-of-url-of-products-on-search-result-page-without-taoba", "title": "want to get taobao&#39;s list of URL of products on search result page without taobao API", "body": "<p>I want to get taobao's list of URL of products on search result page without taobao API.</p>\n\n<p>I tried following Ruby script.</p>\n\n<pre><code>  require \"open-uri\"\n  require \"rubygems\"\n  require \"nokogiri\"\n\n  url='https://world.taobao.com/search/search.htm?_ksTS=1517338530524_300&amp;spm=a21bp.7806943.20151106.1&amp;search_type=0&amp;_input_charset=utf-8&amp;navigator=all&amp;json=on&amp;q=%E6%99%BA%E8%83%BD%E6%89%8B%E8%A1%A8&amp;cna=htqfEgp0pnwCATyQWEDB%2FRCE&amp;callback=__jsonp_cb&amp;abtest=_AB-LR517-LR854-LR895-PR517-PR854-PR895'\n\n  charset = nil\n  html = open(url) do |f|\n    charset = f.charset\n    f.read\n  end\n  doc = Nokogiri::HTML.parse(html, nil, charset)\n\n  p doc.xpath('//*[@id=\"list-itemList\"]/div/div/ul/li[1]/div/div[1]/div/a/@href').each{|i| puts i.text}\n\n  # =&gt; 0\n</code></pre>\n\n<p>I want to get list of URL like  <code>https://click.simba.taobao.com/cc_im?p=%D6%C7%C4%DC%CA%D6%B1%ED&amp;s=328917633&amp;k=525&amp;e=lDs3%2BStGrhmNjUyxd8vQgTvfT37ERKUkJtUYVk0Fu%2FVZc0vyfhbmm9J7EYm6FR5sh%2BLS%2FyzVVWDh7%2FfsE6tfNMMXhI%2B0UDC%2FWUl0TVvvELm1aVClOoSyIIt8ABsLj0Cfp5je%2FwbwaEz8tmCoZFXvwyPz%2F%2ByQnqo1aHsxssXTFVCsSHkx4WMF4kAJ56h9nOp2im5c3WXYS4sLWfJKNVUNrw%2BpEPOoEyjgc%2Fum8LOuDJdaryOqOtghPVQXDFcIJ70E1c5A%2F3bFCO7mlhhsIlyS%2F6JgcI%2BCdFFR%2BwwAwPq4J5149i5fG90xFC36H%2B6u9EBPvn2ws%2F3%2BHHXRqztKxB9a0FyA0nyd%2BlQX%2FeDu0eNS7syyliXsttpfoRv3qrkLwaIIuERgjVDODL9nFyPftrSrn0UKrE5HoJxUtEjsZNeQxqovgnMsw6Jeaosp7zbesM2QBfpp6NMvKM5e5s1buUV%2F1AkICwRxH7wrUN4%2BFn%2FJ0%2FIDJa4fQd4KNO7J5gQRFseQ9Z1SEPDHzgw%3D</code> however I am getting <code>0</code></p>\n\n<p>What should I do?</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 45, "user_id": 2003822, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/22eade4a1097032ec74f3c42a6087065?s=128&d=identicon&r=PG", "display_name": "Raj", "link": "https://stackoverflow.com/users/2003822/raj"}, "reply_to_user": {"reputation": 9971, "user_id": 8255744, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de22299534b5a8ed244ee8ff4aa6c481?s=128&d=identicon&r=PG&f=1", "display_name": "Simple Lime", "link": "https://stackoverflow.com/users/8255744/simple-lime"}, "edited": false, "score": 0, "creation_date": 1517342878, "post_id": 48529071, "comment_id": 84054685, "body": "Thanks a lot simple lime! I was having frustrations with the formatting as you can tell"}, {"owner": {"reputation": 2885, "user_id": 3372172, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Q3RaO.png?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/3372172/pablo"}, "edited": false, "score": 0, "creation_date": 1517343329, "post_id": 48529071, "comment_id": 84054899, "body": "You are not displaying html code on the page but using puts. Is this the problem you want to solve or is there any other problem with the code?"}, {"owner": {"reputation": 1145, "user_id": 3262916, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/91abfd08a0e41f2c1b292d233100e5a4?s=128&d=identicon&r=PG", "display_name": "Ziv Galili", "link": "https://stackoverflow.com/users/3262916/ziv-galili"}, "edited": false, "score": 0, "creation_date": 1517353841, "post_id": 48529071, "comment_id": 84059545, "body": "Maybe its only me, but i didn&#39;t get whats the result should be? the image you included shows how your page looks now, but do you want to include the data of the <code>puts</code> as well in the page? Or maybe only the volunteers that have match? or maybe those who doesnt have a match? can you please edit your question and add some more info?"}], "answers": [{"comments": [{"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1517349541, "post_id": 48530032, "comment_id": 84057897, "body": "This does not actually answer the question. Additionally it would be <code>def self.connections</code>"}], "tags": [], "owner": {"reputation": 1536, "user_id": 8560709, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/cbaef3d3be3351abec96df526eb2eb30?s=128&d=identicon&r=PG&f=1", "display_name": "random_user_0891", "link": "https://stackoverflow.com/users/8560709/random-user-0891"}, "is_accepted": false, "score": 0, "last_activity_date": 1517344304, "creation_date": 1517344304, "answer_id": 48530032, "question_id": 48529071, "link": "https://stackoverflow.com/questions/48529071/how-do-i-randomly-match-two-records-from-a-table-in-ruby-on-rails/48530032#48530032", "title": "How do I randomly match two records from a table in ruby on rails", "body": "<p>you should move the logic for creating a random connection out of your index and make a separate function in your model for that, then call it in your index action.</p>\n\n<p>in your controller do something like</p>\n\n<pre><code>def index\n  @volunteers = Volunteer.connections\nend\n</code></pre>\n\n<p>in your Volunteer model make a function to handle the connections between volunteers</p>\n\n<pre><code>def connections\n  make some call using the Random function rand()\nend\n</code></pre>\n"}], "owner": {"reputation": 45, "user_id": 2003822, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/22eade4a1097032ec74f3c42a6087065?s=128&d=identicon&r=PG", "display_name": "Raj", "link": "https://stackoverflow.com/users/2003822/raj"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 40, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1517344304, "creation_date": 1517340351, "last_edit_date": 1517342083, "question_id": 48529071, "link": "https://stackoverflow.com/questions/48529071/how-do-i-randomly-match-two-records-from-a-table-in-ruby-on-rails", "title": "How do I randomly match two records from a table in ruby on rails", "body": "<p>I am trying to learn rails by running through some basics and also trying to solve a problem that would help me save time if I got it working. I need to match each volunteer from my volunteer table to another volunteer at random. I want the matched assignments displayed on a new page. How would I do this? My volunteers page look like this:<a href=\"https://i.stack.imgur.com/3fVuv.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/3fVuv.png\" alt=\"enter image description here\"></a></p>\n\n<p>Here's what I am trying currently:</p>\n\n<pre><code>def index\n  @volunteers = Volunteer.all\n  @volunteers.each do |element|\n    item = @volunteers[rand(@volunteers.length)]\n    if (element == item)\n      puts 'failed to find you a match. try again.'\n    else\n      puts element\n      puts item\n    end\n  end\nend\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-4", "refactoring", "ruby-on-rails-5"], "comments": [{"owner": {"reputation": 4600, "user_id": 5961578, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/df7cbfdd2a92a7926af3bbb8648318aa?s=128&d=identicon&r=PG", "display_name": "moveson", "link": "https://stackoverflow.com/users/5961578/moveson"}, "edited": false, "score": 1, "creation_date": 1517338868, "post_id": 48528610, "comment_id": 84052453, "body": "I read a nice <a href=\"https://edelpero.svbtle.com/strong-parameters-the-right-way\" rel=\"nofollow noreferrer\">blog post</a> on this a while back. It&#39;s a bit dated (based on Rails 4) but I think still relevant."}, {"owner": {"reputation": 124, "user_id": 4161887, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/11328f84c0086d3fdceac42129eff772?s=128&d=identicon&r=PG&f=1", "display_name": "Duch", "link": "https://stackoverflow.com/users/4161887/duch"}, "reply_to_user": {"reputation": 4600, "user_id": 5961578, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/df7cbfdd2a92a7926af3bbb8648318aa?s=128&d=identicon&r=PG", "display_name": "moveson", "link": "https://stackoverflow.com/users/5961578/moveson"}, "edited": false, "score": 0, "creation_date": 1517412306, "post_id": 48528610, "comment_id": 84086866, "body": "@moveson This is exactly what I was looking for thank you :). Project is on Rails 4 :)."}], "answers": [{"comments": [{"owner": {"reputation": 124, "user_id": 4161887, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/11328f84c0086d3fdceac42129eff772?s=128&d=identicon&r=PG&f=1", "display_name": "Duch", "link": "https://stackoverflow.com/users/4161887/duch"}, "edited": false, "score": 0, "creation_date": 1517412200, "post_id": 48528855, "comment_id": 84086772, "body": "Thank you, I wasn&#39;t clear but I used &#39;example_field_&#39; pattern only for purpose, normally those are different names. Your approach gives me a good idea, I will use sorted list ` %[\u2026]`."}], "tags": [], "owner": {"reputation": 18856, "user_id": 1359650, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/dffc4318ac93e728a26c8e8b51b4eb37?s=128&d=identicon&r=PG", "display_name": "jvillian", "link": "https://stackoverflow.com/users/1359650/jvillian"}, "is_accepted": false, "score": 4, "last_activity_date": 1517339469, "creation_date": 1517339469, "answer_id": 48528855, "question_id": 48528610, "link": "https://stackoverflow.com/questions/48528610/how-to-refactor-rails-params-method/48528855#48528855", "title": "How to refactor Rails &#39;params&#39; method", "body": "<p>How about something like:</p>\n\n<pre><code>def report_params\n  allowed = (1..48).map{|i| \"example_field_#{i}\".to_sym}\n  params.require(:report).permit(\n    allowed,\n    example_address_1_attributes: Address::PUBLIC_ATTRIBUTES,\n    example_address_2_attributes: Address::PUBLIC_ATTRIBUTES,\n    documents_attributes: Document::PUBLIC_ATTRIBUTES\n  )\nend\n</code></pre>\n\n<p>If I do this in console:</p>\n\n<pre><code>&gt; allowed = (1..48).map{|i| \"example_field_#{i}\".to_sym}\n =&gt; [:example_field_1, :example_field_2, :example_field_3, :example_field_4, :example_field_5, :example_field_6, :example_field_7, :example_field_8, :example_field_9, :example_field_10, :example_field_11, :example_field_12, :example_field_13, :example_field_14, :example_field_15, :example_field_16, :example_field_17, :example_field_18, :example_field_19, :example_field_20, :example_field_21, :example_field_22, :example_field_23, :example_field_24, :example_field_25, :example_field_26, :example_field_27, :example_field_28, :example_field_29, :example_field_30, :example_field_31, :example_field_32, :example_field_33, :example_field_34, :example_field_35, :example_field_36, :example_field_37, :example_field_38, :example_field_39, :example_field_40, :example_field_41, :example_field_42, :example_field_43, :example_field_44, :example_field_45, :example_field_46, :example_field_47, :example_field_48] \n\n&gt; p = ActionController::Parameters.new(report: {example_field_12: 'foo', bogus: 'field', good: 'extra'})\n =&gt; {\"report\"=&gt;{\"example_field_12\"=&gt;\"foo\", \"bogus\"=&gt;\"field\", \"good\"=&gt;\"extra\"}}\n\n&gt; p.require(:report).permit(allowed, :good)\nUnpermitted parameter: bogus\n =&gt; {\"example_field_12\"=&gt;\"foo\", \"good\"=&gt;\"extra\"}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 124, "user_id": 4161887, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/11328f84c0086d3fdceac42129eff772?s=128&d=identicon&r=PG&f=1", "display_name": "Duch", "link": "https://stackoverflow.com/users/4161887/duch"}, "is_accepted": false, "score": 1, "last_activity_date": 1517412646, "creation_date": 1517412646, "answer_id": 48545784, "question_id": 48528610, "link": "https://stackoverflow.com/questions/48528610/how-to-refactor-rails-params-method/48545784#48545784", "title": "How to refactor Rails &#39;params&#39; method", "body": "<p>Moveson placed <a href=\"https://edelpero.svbtle.com/strong-parameters-the-right-way\" rel=\"nofollow noreferrer\">link to a great blog post</a>. I used that approach. It is very useful I don't need to keep shared attributes in models and controllers looks much better ;) ! </p>\n"}], "owner": {"reputation": 124, "user_id": 4161887, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/11328f84c0086d3fdceac42129eff772?s=128&d=identicon&r=PG&f=1", "display_name": "Duch", "link": "https://stackoverflow.com/users/4161887/duch"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 155, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1517412646, "creation_date": 1517338550, "last_edit_date": 1517338716, "question_id": 48528610, "link": "https://stackoverflow.com/questions/48528610/how-to-refactor-rails-params-method", "title": "How to refactor Rails &#39;params&#39; method", "body": "<p>Hello there is simple pattern to deal with params security but it makes a lot of mess in Controller Can i do anything with it ?</p>\n\n<pre><code>def report_params\n  params.require(:report).permit(\n    :example_field_1,\n    :example_field_2,\n    :example_field_3,\n    :example_field_4,\n    :example_field_5,\n    :example_field_6,\n    :example_field_7,\n    :example_field_8,\n    :example_field_9,\n    :example_field_10,\n    :example_field_11,\n    :example_field_12,\n    :example_field_13,\n    :example_field_14,\n    :example_field_15,\n    :example_field_16,\n    :example_field_17,\n    :example_field_18,\n    :example_field_19,\n    :example_field_20,\n    :example_field_21,\n    :example_field_22,\n    :example_field_23,\n    :example_field_24,\n    :example_field_25,\n    :example_field_26,\n    :example_field_27,\n    :example_field_28,\n    :example_field_29,\n    :example_field_30,\n    :example_field_31,\n    :example_field_32,\n    :example_field_33,\n    :example_field_34,\n    :example_field_35,\n    :example_field_36,\n    :example_field_37,\n    :example_field_38,\n    :example_field_39,\n    :example_field_40,\n    :example_field_41,\n    :example_field_42,\n    :example_field_43,\n    :example_field_44,\n    :example_field_45,\n    :example_field_46,\n    :example_field_47,\n    :example_field_48,\n    example_address_1_attributes: Address::PUBLIC_ATTRIBUTES,\n    example_address_2_attributes: Address::PUBLIC_ATTRIBUTES,\n    documents_attributes: Document::PUBLIC_ATTRIBUTES\n  )\nend\n</code></pre>\n\n<p>I made some refactor by specifying shared attributes inside of models. I don't know how to deal with it.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "amazon-s3", "paperclip", "paperclip-validation"], "owner": {"reputation": 3414, "user_id": 1597076, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/71aea3d23c451dcc335764643c9ae4c9?s=128&d=identicon&r=PG", "display_name": "Sumit Munot", "link": "https://stackoverflow.com/users/1597076/sumit-munot"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 56, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1562540698, "creation_date": 1517338293, "last_edit_date": 1562540698, "question_id": 48528545, "link": "https://stackoverflow.com/questions/48528545/upload-file-and-detect-language-from-the-uploaded-content-filename-with-paperc", "title": "Upload file and detect language from the uploaded content / filename with Paperclip for Ruby on Rails", "body": "<p>I have some PDF and video files those I want to upload and detect the language of those from the uploaded contents or file names using Paperclip and Ruby on Rails app on the Linux server.</p>\n\n<p>I'm using s3 storage for uploading files with Paperclip as below</p>\n\n<pre><code>class UserFile &lt; ActiveRecord::Base    \n   has_attached_file :file, storage: :s3, s3_credentials: cred, bucket: bucket, path: \"#{Rails.env}/#{`hostname`}/\"\nend\n</code></pre>\n\n<p>I'm using the Paperclip to upload the files, how can I detect the language or localization or the region of the files from which it is getting uploaded.</p>\n\n<p>I want to discriminate folders to save those files based on language on the server.</p>\n\n<p>So basically I just want to detect the uploaded file locations and language and save that to respected folders.</p>\n"}, {"tags": ["ruby", "rubygems"], "answers": [{"comments": [{"owner": {"reputation": 1869, "user_id": 1454158, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/00c67acbbd503f63bad53da85439b3a4?s=128&d=identicon&r=PG", "display_name": "Volte", "link": "https://stackoverflow.com/users/1454158/volte"}, "edited": false, "score": 0, "creation_date": 1517341099, "post_id": 48528467, "comment_id": 84053703, "body": "Yea that&#39;s fair. I was leaning in that direction as well. I&#39;ve already got a config block in the gem and was thinking about using that to allow a user to specify a config file. I should have specified, the &quot;config&quot; file I&#39;m envisioning is more of a rich yaml file that would describe loads of application specific &quot;policies&quot;. Thanks for the nudge, @moveson!"}], "tags": [], "owner": {"reputation": 4600, "user_id": 5961578, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/df7cbfdd2a92a7926af3bbb8648318aa?s=128&d=identicon&r=PG", "display_name": "moveson", "link": "https://stackoverflow.com/users/5961578/moveson"}, "is_accepted": true, "score": 2, "last_activity_date": 1517338327, "last_edit_date": 1517338327, "creation_date": 1517337982, "answer_id": 48528467, "question_id": 48528320, "link": "https://stackoverflow.com/questions/48528320/find-root-of-project-from-included-gem/48528467#48528467", "title": "Find root of project from included gem", "body": "<p>Most modern gems don't look for a particular config file. Instead, they expect a config file of any name to be executed, which will set configurations via a <code>.config</code> variable on the gem's class name. For example, I might have this config file:</p>\n\n<pre><code># config/initializers/ams.rb\n\nActiveModelSerializers.config.adapter = :json_api\nActiveModelSerializers.config.key_transform = :camel_lower\n</code></pre>\n\n<p>Now it doesn't matter where the file is located or what it's called. So long as the code is executed, ActiveModelSerializers can look at its own <code>ActiveModelSerializers.config</code> variable and it is good to go.</p>\n\n<p>If you wanted an extensive configuration (by means of a .yml file, for example) you might create a <code>.config.path</code> setting and instruct users of your gem to set the path themselves and then create a file in the spot they choose:</p>\n\n<pre><code># config/initializers/gem_b.rb\n\nGemB.config.path = '/config/gem_b.yml'\n</code></pre>\n"}], "owner": {"reputation": 1869, "user_id": 1454158, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/00c67acbbd503f63bad53da85439b3a4?s=128&d=identicon&r=PG", "display_name": "Volte", "link": "https://stackoverflow.com/users/1454158/volte"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 37, "favorite_count": 0, "accepted_answer_id": 48528467, "answer_count": 1, "score": 0, "last_activity_date": 1517338327, "creation_date": 1517337387, "question_id": 48528320, "link": "https://stackoverflow.com/questions/48528320/find-root-of-project-from-included-gem", "title": "Find root of project from included gem", "body": "<p>Here's the scenario. I'm writing <code>GemB</code>, and I plan to use it in <code>ProjectA</code>, but I want to write <code>GemB</code> in a non-specific fashion (as I should). I want <code>GemB</code> to look for a \"config\" file under a \"conventional\" <code>project_a/config/gem_b.yml</code></p>\n\n<p>If that file doesn't exist, <code>GemB</code> can default to it's own <code>gemb/config/default.yml</code></p>\n\n<p><code>ProjectA</code> (probably is a variant of a gem/rails-engine/rails-app etc)\n<code>GemB</code> (definitely a gem)</p>\n\n<p>Is there a dynamic way for <code>GemB</code> to get the root of <code>ProjectA</code> (the project it's being used in)? If I could predict the name, I could call <code>ProjectA.root</code> (likely), so you might suggest calling <code>Rails.root</code> but I can't guarantee that it will be used in a <code>Rails</code> project, (and in this case unlikely anyway, based on the target functionality of <code>GemB</code>).</p>\n\n<p>Trusting that's a sufficient explanation, let me know if I need to clarify!</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 6929, "user_id": 1262519, "user_type": "registered", "accept_rate": 48, "profile_image": "https://i.stack.imgur.com/zvPMu.jpg?s=128&g=1", "display_name": "Sachin Singh", "link": "https://stackoverflow.com/users/1262519/sachin-singh"}, "edited": false, "score": 0, "creation_date": 1517336542, "post_id": 48527978, "comment_id": 84051089, "body": "you can try using sidekiq, and schedule(recurring) job with it."}, {"owner": {"reputation": 980, "user_id": 338536, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/6Kl4s.jpg?s=128&g=1", "display_name": "miligraf", "link": "https://stackoverflow.com/users/338536/miligraf"}, "edited": false, "score": 0, "creation_date": 1517337586, "post_id": 48527978, "comment_id": 84051710, "body": "Do you have any experience with AWS? AWS Lambda would be great for this"}, {"owner": {"reputation": 2960, "user_id": 7426461, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/Ldwxy.jpg?s=128&g=1", "display_name": "Cannon Moyer", "link": "https://stackoverflow.com/users/7426461/cannon-moyer"}, "reply_to_user": {"reputation": 980, "user_id": 338536, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/6Kl4s.jpg?s=128&g=1", "display_name": "miligraf", "link": "https://stackoverflow.com/users/338536/miligraf"}, "edited": false, "score": 0, "creation_date": 1517340576, "post_id": 48527978, "comment_id": 84053432, "body": "@miligraf Some, are you essentially saying to have a get request on my server and use a lambda function to make that request which runs the code?"}, {"owner": {"reputation": 2960, "user_id": 7426461, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/Ldwxy.jpg?s=128&g=1", "display_name": "Cannon Moyer", "link": "https://stackoverflow.com/users/7426461/cannon-moyer"}, "reply_to_user": {"reputation": 6929, "user_id": 1262519, "user_type": "registered", "accept_rate": 48, "profile_image": "https://i.stack.imgur.com/zvPMu.jpg?s=128&g=1", "display_name": "Sachin Singh", "link": "https://stackoverflow.com/users/1262519/sachin-singh"}, "edited": false, "score": 0, "creation_date": 1517340589, "post_id": 48527978, "comment_id": 84053436, "body": "@SachinSingh I&#39;ll look into this one more."}, {"owner": {"reputation": 330, "user_id": 6482185, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-T11f0D1JFSw/AAAAAAAAAAI/AAAAAAAAAP0/6onfs__d2RE/photo.jpg?sz=128", "display_name": "Will Nguyen", "link": "https://stackoverflow.com/users/6482185/will-nguyen"}, "edited": false, "score": 0, "creation_date": 1517365337, "post_id": 48527978, "comment_id": 84062582, "body": "&quot;Rails runner reloads the entire app every time rails runner is executed&quot;. I don&#39;t think so. It just involves a method of a Model. You even can implement in lib/test.rb and run directly from this file: rails r lib/test.rb"}], "owner": {"reputation": 2960, "user_id": 7426461, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/Ldwxy.jpg?s=128&g=1", "display_name": "Cannon Moyer", "link": "https://stackoverflow.com/users/7426461/cannon-moyer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 59, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1517336143, "creation_date": 1517336143, "question_id": 48527978, "link": "https://stackoverflow.com/questions/48527978/create-cron-job-from-thread-ruby-on-rails", "title": "Create Cron Job from Thread - Ruby on Rails", "body": "<p>I'm looking at the Whenever gem for running a process every 30 minutes that sends an email out to a specific list of customers. </p>\n\n<p>The documentation gives a few examples like this one: </p>\n\n<pre><code>every 3.hours do # 1.minute 1.day 1.week 1.month 1.year is also supported\n    runner \"MyModel.some_process\"\n    rake \"my:rake:task\"\n    command \"/usr/bin/my_great_command\"\nend\n</code></pre>\n\n<p>Rails runner reloads the entire app every time rails runner is executed. The same thing applies for rake and I can't think of a way to execute a command directly from the CLI without loading the entire app. </p>\n\n<p>I've looked at the Clockwork gem, but the last commit there was 7 years ago. I do like the idea of having a single thread that executes functions alongside the rails application as long as the app is running. </p>\n\n<p>I would think that creating a Thread and dropping it into my Model like this would work but I don't know if this is the most efficient way of accomplishing what I need.</p>\n\n<pre><code>class MyModel &lt; ApplicationRecord\n    Thread.new do\n        loop do\n            call_some_private_function\n            sleep(30 * 60)\n        end\n    end\nend\n</code></pre>\n\n<p>Any advice would be appreciated!</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 6929, "user_id": 1262519, "user_type": "registered", "accept_rate": 48, "profile_image": "https://i.stack.imgur.com/zvPMu.jpg?s=128&g=1", "display_name": "Sachin Singh", "link": "https://stackoverflow.com/users/1262519/sachin-singh"}, "edited": false, "score": 0, "creation_date": 1517336284, "post_id": 48527699, "comment_id": 84050937, "body": "you have to understand how rails work."}], "answers": [{"tags": [], "owner": {"reputation": 394, "user_id": 9289181, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kEJV4.jpg?s=128&g=1", "display_name": "fl9", "link": "https://stackoverflow.com/users/9289181/fl9"}, "is_accepted": true, "score": 1, "last_activity_date": 1517336076, "creation_date": 1517336076, "answer_id": 48527953, "question_id": 48527699, "link": "https://stackoverflow.com/questions/48527699/rails-file-not-working-on-webserver/48527953#48527953", "title": "Rails file not working on webserver", "body": "<p>It's not enough to simply upload an erb file to a webserver. Your whole rails project needs to be on the webserver as well as the rails binary itself (to run your rails code, like you do on localhost). Usually something like Capistrano is used for an easy rails deployment, see, e.g., <a href=\"https://revs.runtime-revolution.com/deploy-your-rails-app-with-capistrano-5ad5d58e9b07\" rel=\"nofollow noreferrer\">https://revs.runtime-revolution.com/deploy-your-rails-app-with-capistrano-5ad5d58e9b07</a>. </p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user7492670"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 33, "favorite_count": 0, "accepted_answer_id": 48527953, "answer_count": 1, "score": 0, "last_activity_date": 1525557181, "creation_date": 1517335041, "last_edit_date": 1525557181, "question_id": 48527699, "link": "https://stackoverflow.com/questions/48527699/rails-file-not-working-on-webserver", "title": "Rails file not working on webserver", "body": "<p>Am I able to just plug an <code>erb</code> file into a web server and access it via HTTP, and have it run the ruby inside of it and output HTML? Or do I need to set up a rails project?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "rspec", "devise", "rspec-rails"], "answers": [{"comments": [{"owner": {"reputation": 562, "user_id": 7497708, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Ml9nVa_gAJc/AAAAAAAAAAI/AAAAAAAAAH4/OV7SrMI6APk/photo.jpg?sz=128", "display_name": "tmikeschu", "link": "https://stackoverflow.com/users/7497708/tmikeschu"}, "edited": false, "score": 1, "creation_date": 1517839086, "post_id": 48527440, "comment_id": 84245040, "body": "One thing to note on larger applications with more assets, DB relationships, &amp;c is that a login strategy that uses Capybara&#39;s DOM traversal is a lot slower than stubbing a helper method like <code>current_user</code> (see Duch&#39;s answer below)."}], "tags": [], "owner": {"reputation": 901, "user_id": 3219759, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/iOGnN.jpg?s=128&g=1", "display_name": "Ruff9", "link": "https://stackoverflow.com/users/3219759/ruff9"}, "is_accepted": true, "score": 1, "last_activity_date": 1517334100, "creation_date": 1517334100, "answer_id": 48527440, "question_id": 48527129, "link": "https://stackoverflow.com/questions/48527129/how-to-login-in-feature-specs/48527440#48527440", "title": "How to login in feature specs", "body": "<p>You can use Capybara as well to connect your test user. In my rails_helper I have this method:</p>\n\n<pre><code>def create_user_and_log_in\n  create :user, email: 'user@test.com', password: 'password'\n  visit new_user_session_path\n  fill_in :user_email, with: 'user@test.com'\n  fill_in :user_password, with: 'password'\n  click_on 'Connexion'\nend\n</code></pre>\n\n<p>You can then call this method in your specs.</p>\n"}, {"tags": [], "owner": {"reputation": 124, "user_id": 4161887, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/11328f84c0086d3fdceac42129eff772?s=128&d=identicon&r=PG&f=1", "display_name": "Duch", "link": "https://stackoverflow.com/users/4161887/duch"}, "is_accepted": false, "score": 2, "last_activity_date": 1612174488, "last_edit_date": 1612174488, "creation_date": 1517337876, "answer_id": 48528447, "question_id": 48527129, "link": "https://stackoverflow.com/questions/48527129/how-to-login-in-feature-specs/48528447#48528447", "title": "How to login in feature specs", "body": "<p>I was working with different library then Devise but it should works. It's very simple mock:</p>\n<pre><code>allow_any_instance_of(ApplicationController).to receive(:current_user) { user }\n</code></pre>\n<p>You can make it even simpler by making a special helper:</p>\n<pre><code># spec/support/feature_spec_helper.rb`\n\nmodule FeatureSpecHelper\n  def login(user)\n    allow_any_instance_of(ApplicationController).to receive(:current_user) { user }\n  end\nend\n</code></pre>\n<p>Then in spec config (spec_helper or rails_helper) drop anywhere</p>\n<pre><code>Dir[Rails.root.join(&quot;spec/support/**/*.rb&quot;)].each { |f| require f }\n# (...)\nRSpec.configure do |config|\n  config.include FeatureSpecHelper, :type =&gt; :feature\n# (...)\n</code></pre>\n<p>next you can use in feature spec <code>login user</code></p>\n"}, {"tags": [], "owner": {"reputation": 531, "user_id": 4957673, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-wayGJ6nTDdU/AAAAAAAAAAI/AAAAAAAAlAc/A2hj4PoiO1o/photo.jpg?sz=128", "display_name": "Sage Ross", "link": "https://stackoverflow.com/users/4957673/sage-ross"}, "is_accepted": false, "score": 3, "last_activity_date": 1517359199, "creation_date": 1517359199, "answer_id": 48532730, "question_id": 48527129, "link": "https://stackoverflow.com/questions/48527129/how-to-login-in-feature-specs/48532730#48532730", "title": "How to login in feature specs", "body": "<p>In Capybara feature specs in my app, we use the Warden test helpers:</p>\n\n<pre><code># spec/rails_helper.rb\nRSpec.configure do |config|\n  config.include Warden::Test::Helpers\n  Warden.test_mode!\nend\n\n# in the feature spec\nlogin_as(user, scope: :user)\n</code></pre>\n\n<p>Also, for controller specs:</p>\n\n<pre><code>allow(controller).to receive(:current_user).and_return(user)\n</code></pre>\n"}], "owner": {"reputation": 1100, "user_id": 1584736, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/7b8c4392528b20b47726142f7a20c7cd?s=128&d=identicon&r=PG", "display_name": "ngw", "link": "https://stackoverflow.com/users/1584736/ngw"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1664, "favorite_count": 0, "accepted_answer_id": 48527440, "answer_count": 3, "score": 2, "last_activity_date": 1612174488, "creation_date": 1517332850, "question_id": 48527129, "link": "https://stackoverflow.com/questions/48527129/how-to-login-in-feature-specs", "title": "How to login in feature specs", "body": "<p>I have a helper method that is using @request.env and Devise to login the user:</p>\n\n<pre><code>def login_user(user)\n  @request.env[\"devise.mapping\"] = Devise.mappings[:user]\n  sign_in user\nend\n</code></pre>\n\n<p>I'm trying to write a feature spec where I need to login, but login_user is failing:</p>\n\n<pre><code>1) Search finds a manufacturer\n Failure/Error: @request.env[\"devise.mapping\"] = Devise.mappings[:user]\n\n NoMethodError:\n   undefined method `env' for nil:NilClass\n # ./spec/support/controller_macros.rb:3:in `login_user'\n # ./spec/features/search_spec.rb:17:in `block (2 levels) in &lt;top (required)&gt;'\n</code></pre>\n\n<p>How can I fix? I have no experience with feature specs, with cucumber I'd use a feature to login, I'm definitely not sure that's the best practice with rspecs.\nThanks in advance.</p>\n"}, {"tags": ["ruby", "null", "jekyll"], "comments": [{"owner": {"reputation": 803, "user_id": 6360989, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/e0DdG.jpg?s=128&g=1", "display_name": "iamcaleberic", "link": "https://stackoverflow.com/users/6360989/iamcaleberic"}, "edited": false, "score": 0, "creation_date": 1517333677, "post_id": 48527061, "comment_id": 84049598, "body": "You are calling a method on a value that is nil..."}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1517333751, "post_id": 48527061, "comment_id": 84049644, "body": "either <code>context.registers</code> or <code>context.registers[:site].config</code> or <code>context.registers[:site].config[&#39;exiftag&#39;]</code> returns <code>nil</code> since those are the places you are calling <code>[]</code>. you see this method chain is actually interpreted as  <code>context.registers.[](:site).config.[](&#39;exiftag&#39;).[](&#39;sources&zwnj;&#8203;&#39;)</code>"}, {"owner": {"reputation": 803, "user_id": 6360989, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/e0DdG.jpg?s=128&g=1", "display_name": "iamcaleberic", "link": "https://stackoverflow.com/users/6360989/iamcaleberic"}, "edited": false, "score": 0, "creation_date": 1517333850, "post_id": 48527061, "comment_id": 84049683, "body": "[&#39;exiftag&#39;][&#39;sources&#39;] this sources value is nil"}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "reply_to_user": {"reputation": 803, "user_id": 6360989, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/e0DdG.jpg?s=128&g=1", "display_name": "iamcaleberic", "link": "https://stackoverflow.com/users/6360989/iamcaleberic"}, "edited": false, "score": 0, "creation_date": 1517334063, "post_id": 48527061, "comment_id": 84049812, "body": "@iamcaleberic actually this would raise <code>TypeError: no implicit conversion from nil to integer</code> the error must be some method call prior to that like <code>[&#39;exiftag&#39;]</code>"}, {"owner": {"user_type": "does_not_exist", "display_name": "user9289940"}, "edited": false, "score": 0, "creation_date": 1517338353, "post_id": 48527061, "comment_id": 84052162, "body": "Yes. I was missing the method call to exiftag (see below). Thank you!"}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user9289940"}, "edited": false, "score": 0, "creation_date": 1517337821, "post_id": 48527396, "comment_id": 84051857, "body": "Yes, I hade messed up my config.yml. Re-added exiftag:  sources:    - images/photography  And now it is working fine. Thank you and @engineersmnky"}], "tags": [], "owner": {"reputation": 4449, "user_id": 7681659, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/47bc1a3b7231505d61b7f80642bc1a14?s=128&d=identicon&r=PG&f=1", "display_name": "ashmaroli", "link": "https://stackoverflow.com/users/7681659/ashmaroli"}, "is_accepted": true, "score": 1, "last_activity_date": 1517333932, "creation_date": 1517333932, "answer_id": 48527396, "question_id": 48527061, "link": "https://stackoverflow.com/questions/48527061/ruby-error-undefined-method-for-nilnilclass/48527396#48527396", "title": "Ruby - Error: undefined method `[]&#39; for nil:NilClass", "body": "<p>The error could simply mean that you have not set <code>['exiftag']['sources']</code> in your config file.</p>\n\n<p>Your config file should have something similar to below (entry1 and entry2 are just examples):</p>\n\n<pre><code>exiftag:\n  sources:\n    - entry1\n    - entry2\n</code></pre>\n\n<p>Do note, indentation is important in YAML as well..</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user9289940"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1001, "favorite_count": 0, "accepted_answer_id": 48527396, "answer_count": 1, "score": 1, "last_activity_date": 1517333932, "creation_date": 1517332610, "question_id": 48527061, "link": "https://stackoverflow.com/questions/48527061/ruby-error-undefined-method-for-nilnilclass", "title": "Ruby - Error: undefined method `[]&#39; for nil:NilClass", "body": "<p>So, I'm new to Ruby and I'm trying to install <a href=\"https://github.com/aerobless/jekyll-photo-gallery\" rel=\"nofollow noreferrer\">this photo gallery</a> to my Jekyll blog. However, when I'm trying to run </p>\n\n<pre><code>jekyll build\n</code></pre>\n\n<p>I get this error message: </p>\n\n<pre><code>Liquid Exception: undefined method `[]' for nil:NilClass in photography/index.html \njekyll 3.7.2 | Error:  undefined method `[]' for nil:NilClass\n</code></pre>\n\n<p>With --trace it points me to:</p>\n\n<pre><code>/Users/hal9000/Desktop/Plommonstop/_plugins/jekyll-exiftag-mod.rb:18:in `render': undefined method `[]' for nil:NilClass (NoMethodError)\n</code></pre>\n\n<p>But now I don't understand how to proceed. jekyll-exiftag-mod looks like this: </p>\n\n<pre><code>require 'exifr/jpeg'\n\n#Based on https://github.com/benib/jekyll-exiftag by Beni Buess (MIT License)\n#Edited to work as a Liquid-Block instead of a Liquid-Tag, reads the filename from between the\n#brackets. --T.Winter\n\nmodule Jekyll\n  class ExifTag &lt; Liquid::Block\n\n    def initialize(tag_name, params, token)\n      super\n      @args = self.split_params(params)\n    end\n\n    def render(context)\n      #abort context.registers[:site].config['source'].inspect\n      sources = Array.new(context.registers[:site].config['exiftag']['sources'])\n      # first param is the exif tag\n      tag = @args[0]\n\n      # if a second parameter is passed, use it as a possible img source\n      if @args.count &gt; 1\n        sources.unshift(@args[1])\n      end\n\n      # the image can be passed as the third parameter\n      img = super\n\n      # first check if the given img is already the path\n      if File.exist?(img)\n        file_name = img\n      else\n      # then start testing with the sources from _config.yml\n        begin\n          source = sources.shift\n          file_name = File.join(context.registers[:site].config['source'], source, img)\n        end until File.exist?(file_name) or sources.count == 0\n      end\n      # try it and return empty string on failure\n      begin\n        exif = EXIFR::JPEG::new(file_name)\n        return tag.split('.').inject(exif){|o,m| o.send(m)}\n      rescue\n        \"ERROR, EXIF-Tag RB\"\n      end\n    end\n\n    def split_params(params)\n      params.split(\",\").map(&amp;:strip)\n    end\n  end\nend\n\nLiquid::Template.register_tag('exiftag', Jekyll::ExifTag)\n</code></pre>\n\n<p>With row 18:</p>\n\n<pre><code>sources = Array.new(context.registers[:site].config['exiftag']['sources'])\n</code></pre>\n\n<p>What does it mean with \"Undefined method `[]' for nil:NilClass?\" And what exactly is making this problem occur? </p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 5475, "user_id": 6648243, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HH9Jl.jpg?s=128&g=1", "display_name": "dstrants", "link": "https://stackoverflow.com/users/6648243/dstrants"}, "edited": false, "score": 0, "creation_date": 1517332057, "post_id": 48526502, "comment_id": 84048680, "body": "Add the command that is raising the error to your <b>question</b>"}, {"owner": {"reputation": 4600, "user_id": 5961578, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/df7cbfdd2a92a7926af3bbb8648318aa?s=128&d=identicon&r=PG", "display_name": "moveson", "link": "https://stackoverflow.com/users/5961578/moveson"}, "edited": false, "score": 0, "creation_date": 1517332301, "post_id": 48526502, "comment_id": 84048831, "body": "Ruby 2.5 was going to include the bundler gem by default, but at the last minute they pulled it. So for now, we still need to do <code>gem install bundler</code> on a fresh Ruby 2.5 install before we can do <code>bundle install</code>. Incidentally, it looks like you are using your system Ruby. You should strongly consider using a Ruby environment manager like <a href=\"https://github.com/rbenv/rbenv\" rel=\"nofollow noreferrer\">rbenv</a>."}, {"owner": {"reputation": 106, "user_id": 7068514, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Nutz8DCvmuQ/AAAAAAAAAAI/AAAAAAAAEOM/9yQVWpKR5YU/photo.jpg?sz=128", "display_name": "Andrew Losseff", "link": "https://stackoverflow.com/users/7068514/andrew-losseff"}, "edited": false, "score": 0, "creation_date": 1517333257, "post_id": 48526502, "comment_id": 84049354, "body": "&quot;Add the command that is raising the error to your question&quot; I run <code>rails new app</code>"}, {"owner": {"reputation": 106, "user_id": 7068514, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Nutz8DCvmuQ/AAAAAAAAAAI/AAAAAAAAEOM/9yQVWpKR5YU/photo.jpg?sz=128", "display_name": "Andrew Losseff", "link": "https://stackoverflow.com/users/7068514/andrew-losseff"}, "edited": false, "score": 0, "creation_date": 1517333391, "post_id": 48526502, "comment_id": 84049444, "body": "Yes, I did <code>gem install bundler</code> and I&#39;ve installed Ruby 2.5.0 with rbenv."}, {"owner": {"reputation": 330, "user_id": 6482185, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-T11f0D1JFSw/AAAAAAAAAAI/AAAAAAAAAP0/6onfs__d2RE/photo.jpg?sz=128", "display_name": "Will Nguyen", "link": "https://stackoverflow.com/users/6482185/will-nguyen"}, "edited": false, "score": 0, "creation_date": 1517365550, "post_id": 48526502, "comment_id": 84062633, "body": "Did you install ruby 2.3? I suspect that ruby 2.5 is not current default version. It seems like it still accesses to version 2.3 : from /System/Library/Frameworks/Ruby.framework/Versions/2.3/"}, {"owner": {"reputation": 106, "user_id": 7068514, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Nutz8DCvmuQ/AAAAAAAAAAI/AAAAAAAAEOM/9yQVWpKR5YU/photo.jpg?sz=128", "display_name": "Andrew Losseff", "link": "https://stackoverflow.com/users/7068514/andrew-losseff"}, "edited": false, "score": 0, "creation_date": 1517385858, "post_id": 48526502, "comment_id": 84069428, "body": "I had Ruby 2.3 before 2.5. Maybe you are right. I just reinstall everything and it works now."}, {"owner": {"reputation": 7390, "user_id": 865175, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/5ede8c46975134f092fd38bdff2ec8c6?s=128&d=identicon&r=PG", "display_name": "Iulian Onofrei", "link": "https://stackoverflow.com/users/865175/iulian-onofrei"}, "edited": false, "score": 0, "creation_date": 1570541969, "post_id": 48526502, "comment_id": 102939823, "body": "Sometimes, deleting the <code>$GEM_HOME</code> directory fixes this kind of issues."}], "answers": [{"comments": [{"owner": {"reputation": 106, "user_id": 7068514, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Nutz8DCvmuQ/AAAAAAAAAAI/AAAAAAAAEOM/9yQVWpKR5YU/photo.jpg?sz=128", "display_name": "Andrew Losseff", "link": "https://stackoverflow.com/users/7068514/andrew-losseff"}, "edited": false, "score": 1, "creation_date": 1517333151, "post_id": 48526625, "comment_id": 84049294, "body": "Oh, I did it and it didn&#39;t help."}, {"owner": {"reputation": 323, "user_id": 5955937, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/51f758b575f83ba27cfff4aaa3df6900?s=128&d=identicon&r=PG&f=1", "display_name": "Tim Higgins", "link": "https://stackoverflow.com/users/5955937/tim-higgins"}, "reply_to_user": {"reputation": 106, "user_id": 7068514, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Nutz8DCvmuQ/AAAAAAAAAAI/AAAAAAAAEOM/9yQVWpKR5YU/photo.jpg?sz=128", "display_name": "Andrew Losseff", "link": "https://stackoverflow.com/users/7068514/andrew-losseff"}, "edited": false, "score": 0, "creation_date": 1517333294, "post_id": 48526625, "comment_id": 84049383, "body": "Good to know! It would be helpful if you included some solutions (and the outcomes) of things you&#39;ve already tried. Also as @moveson has recommended a version control / env manager such as rbenv or rvm is extremely useful."}, {"owner": {"reputation": 106, "user_id": 7068514, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Nutz8DCvmuQ/AAAAAAAAAAI/AAAAAAAAEOM/9yQVWpKR5YU/photo.jpg?sz=128", "display_name": "Andrew Losseff", "link": "https://stackoverflow.com/users/7068514/andrew-losseff"}, "edited": false, "score": 0, "creation_date": 1517333830, "post_id": 48526625, "comment_id": 84049674, "body": "Sorry, I should&#39;ve said it. My bad. So far I&#39;ve tried <code>gem install bundler</code> and I use rbenv. That&#39;s all."}, {"owner": {"reputation": 323, "user_id": 5955937, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/51f758b575f83ba27cfff4aaa3df6900?s=128&d=identicon&r=PG&f=1", "display_name": "Tim Higgins", "link": "https://stackoverflow.com/users/5955937/tim-higgins"}, "reply_to_user": {"reputation": 106, "user_id": 7068514, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Nutz8DCvmuQ/AAAAAAAAAAI/AAAAAAAAEOM/9yQVWpKR5YU/photo.jpg?sz=128", "display_name": "Andrew Losseff", "link": "https://stackoverflow.com/users/7068514/andrew-losseff"}, "edited": false, "score": 0, "creation_date": 1517333879, "post_id": 48526625, "comment_id": 84049703, "body": "No worries. Did you have a previous install of ruby before using rbenv? What&#39;s the path if you run <code>which bundle</code>?"}, {"owner": {"reputation": 106, "user_id": 7068514, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Nutz8DCvmuQ/AAAAAAAAAAI/AAAAAAAAEOM/9yQVWpKR5YU/photo.jpg?sz=128", "display_name": "Andrew Losseff", "link": "https://stackoverflow.com/users/7068514/andrew-losseff"}, "edited": false, "score": 0, "creation_date": 1517385992, "post_id": 48526625, "comment_id": 84069513, "body": "I just reinstall everything and it works now. Thanks for your help. Maybe the problem was that I installed Rails and after that  rbenv with new Ruby version."}, {"owner": {"reputation": 323, "user_id": 5955937, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/51f758b575f83ba27cfff4aaa3df6900?s=128&d=identicon&r=PG&f=1", "display_name": "Tim Higgins", "link": "https://stackoverflow.com/users/5955937/tim-higgins"}, "reply_to_user": {"reputation": 106, "user_id": 7068514, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Nutz8DCvmuQ/AAAAAAAAAAI/AAAAAAAAEOM/9yQVWpKR5YU/photo.jpg?sz=128", "display_name": "Andrew Losseff", "link": "https://stackoverflow.com/users/7068514/andrew-losseff"}, "edited": false, "score": 0, "creation_date": 1517415624, "post_id": 48526625, "comment_id": 84089187, "body": "Yeah, that&#39;ll do it. Glad you got it figured out!"}], "tags": [], "owner": {"reputation": 323, "user_id": 5955937, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/51f758b575f83ba27cfff4aaa3df6900?s=128&d=identicon&r=PG&f=1", "display_name": "Tim Higgins", "link": "https://stackoverflow.com/users/5955937/tim-higgins"}, "is_accepted": false, "score": 4, "last_activity_date": 1517331184, "creation_date": 1517331184, "answer_id": 48526625, "question_id": 48526502, "link": "https://stackoverflow.com/questions/48526502/cant-find-gem-bundler-ruby/48526625#48526625", "title": "can&#39;t find gem bundler Ruby", "body": "<p>It looks like you may need to do a <code>gem install bundler</code> and get the bundler gem to get rails up and running.</p>\n"}, {"comments": [{"owner": {"reputation": 7390, "user_id": 865175, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/5ede8c46975134f092fd38bdff2ec8c6?s=128&d=identicon&r=PG", "display_name": "Iulian Onofrei", "link": "https://stackoverflow.com/users/865175/iulian-onofrei"}, "edited": false, "score": 0, "creation_date": 1567171412, "post_id": 50005271, "comment_id": 101895294, "body": "Never install with sudo."}, {"owner": {"reputation": 213, "user_id": 3813331, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eab7f2800645d72685ccbf1ad1a89b0f?s=128&d=identicon&r=PG&f=1", "display_name": "almawhoob", "link": "https://stackoverflow.com/users/3813331/almawhoob"}, "reply_to_user": {"reputation": 7390, "user_id": 865175, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/5ede8c46975134f092fd38bdff2ec8c6?s=128&d=identicon&r=PG", "display_name": "Iulian Onofrei", "link": "https://stackoverflow.com/users/865175/iulian-onofrei"}, "edited": false, "score": 0, "creation_date": 1567549146, "post_id": 50005271, "comment_id": 101993504, "body": "@IulianOnofrei Your comment would be more useful if you&#39;ve stated the reason rather than just giving a command. Thank you."}, {"owner": {"reputation": 7390, "user_id": 865175, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/5ede8c46975134f092fd38bdff2ec8c6?s=128&d=identicon&r=PG", "display_name": "Iulian Onofrei", "link": "https://stackoverflow.com/users/865175/iulian-onofrei"}, "edited": false, "score": 0, "creation_date": 1567574656, "post_id": 50005271, "comment_id": 101997810, "body": "<a href=\"https://github.com/calabash/calabash-ios/wiki/Best-Practice%3A--Never-install-gems-with-sudo\" rel=\"nofollow noreferrer\">github.com/calabash/calabash-ios/wiki/&hellip;</a>"}], "tags": [], "owner": {"reputation": 213, "user_id": 3813331, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eab7f2800645d72685ccbf1ad1a89b0f?s=128&d=identicon&r=PG&f=1", "display_name": "almawhoob", "link": "https://stackoverflow.com/users/3813331/almawhoob"}, "is_accepted": false, "score": -1, "last_activity_date": 1524583419, "last_edit_date": 1524583419, "creation_date": 1524583053, "answer_id": 50005271, "question_id": 48526502, "link": "https://stackoverflow.com/questions/48526502/cant-find-gem-bundler-ruby/50005271#50005271", "title": "can&#39;t find gem bundler Ruby", "body": "<p>STEP (1): install the bundler gem:</p>\n\n<pre><code>sudo gem install bundler\n</code></pre>\n\n<p>Once completed, you should get a message similar to this:</p>\n\n<pre><code>Fetching: bundler-1.16.1.gem (100%)\nSuccessfully installed bundler-1.16.1\nParsing documentation for bundler-1.16.1\nInstalling ri documentation for bundler-1.16.1\nDone installing documentation for bundler after 6 seconds\n1 gem installed\n</code></pre>\n\n<p>STEP (2): try checking the bundler version:</p>\n\n<pre><code>bundle -v\n</code></pre>\n\n<p>You should get a version number like this:</p>\n\n<pre><code>Bundler version 1.16.1\n</code></pre>\n\n<p>STEP (3): now you can use bundle install:</p>\n\n<pre><code>bundle install\n</code></pre>\n\n<p>I hope my answer helps.</p>\n"}], "owner": {"reputation": 106, "user_id": 7068514, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Nutz8DCvmuQ/AAAAAAAAAAI/AAAAAAAAEOM/9yQVWpKR5YU/photo.jpg?sz=128", "display_name": "Andrew Losseff", "link": "https://stackoverflow.com/users/7068514/andrew-losseff"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4122, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1524583419, "creation_date": 1517330688, "last_edit_date": 1592644375, "question_id": 48526502, "link": "https://stackoverflow.com/questions/48526502/cant-find-gem-bundler-ruby", "title": "can&#39;t find gem bundler Ruby", "body": "<p>Using Mac OS 13, rbenv.</p>\n<blockquote>\n<p>ruby 2.5.0p0 (2017-12-25 revision 61468) [x86_64-darwin17]</p>\n<p>Rails 5.1.4</p>\n<p>Bundler version 1.16.1</p>\n<p>rbenv 1.1.1</p>\n</blockquote>\n<p>I'm trying to start a new Rails application and then getting this:</p>\n<pre><code>/System/Library/Frameworks/Ruby.framework/Versions/2.3/usr/lib/ruby/2.3.0/rubygems.rb:241:in `bin_path': can't find gem bundler (&gt;= 0) (Gem::GemNotFoundException)\nfrom /Library/Ruby/Gems/2.3.0/gems/railties-5.1.4/lib/rails/generators/app_base.rb:382:in `bundle_command'\nfrom /Library/Ruby/Gems/2.3.0/gems/railties-5.1.4/lib/rails/generators/app_base.rb:416:in `run_bundle'\nfrom (eval):1:in `run_bundle'\nfrom /Library/Ruby/Gems/2.3.0/gems/thor-0.20.0/lib/thor/command.rb:27:in `run'\nfrom /Library/Ruby/Gems/2.3.0/gems/thor-0.20.0/lib/thor/invocation.rb:126:in `invoke_command'\nfrom /Library/Ruby/Gems/2.3.0/gems/thor-0.20.0/lib/thor/invocation.rb:133:in `block in invoke_all'\nfrom /Library/Ruby/Gems/2.3.0/gems/thor-0.20.0/lib/thor/invocation.rb:133:in `each'\nfrom /Library/Ruby/Gems/2.3.0/gems/thor-0.20.0/lib/thor/invocation.rb:133:in `map'\nfrom /Library/Ruby/Gems/2.3.0/gems/thor-0.20.0/lib/thor/invocation.rb:133:in `invoke_all'\nfrom /Library/Ruby/Gems/2.3.0/gems/thor-0.20.0/lib/thor/group.rb:232:in `dispatch'\nfrom /Library/Ruby/Gems/2.3.0/gems/thor-0.20.0/lib/thor/base.rb:466:in `start'\nfrom /Library/Ruby/Gems/2.3.0/gems/railties-5.1.4/lib/rails/commands/application/application_command.rb:24:in `perform'\nfrom /Library/Ruby/Gems/2.3.0/gems/thor-0.20.0/lib/thor/command.rb:27:in `run'\nfrom /Library/Ruby/Gems/2.3.0/gems/thor-0.20.0/lib/thor/invocation.rb:126:in `invoke_command'\nfrom /Library/Ruby/Gems/2.3.0/gems/thor-0.20.0/lib/thor.rb:387:in `dispatch'\nfrom /Library/Ruby/Gems/2.3.0/gems/railties-5.1.4/lib/rails/command/base.rb:63:in `perform'\nfrom /Library/Ruby/Gems/2.3.0/gems/railties-5.1.4/lib/rails/command.rb:44:in `invoke'\nfrom /Library/Ruby/Gems/2.3.0/gems/railties-5.1.4/lib/rails/cli.rb:16:in `&lt;top (required)&gt;'\nfrom /System/Library/Frameworks/Ruby.framework/Versions/2.3/usr/lib/ruby/2.3.0/rubygems/core_ext/kernel_require.rb:127:in `require'\nfrom /System/Library/Frameworks/Ruby.framework/Versions/2.3/usr/lib/ruby/2.3.0/rubygems/core_ext/kernel_require.rb:127:in `rescue in require'\nfrom /System/Library/Frameworks/Ruby.framework/Versions/2.3/usr/lib/ruby/2.3.0/rubygems/core_ext/kernel_require.rb:40:in `require'\nfrom /Library/Ruby/Gems/2.3.0/gems/railties-5.1.4/exe/rails:9:in `&lt;top (required)&gt;'\nfrom /usr/local/bin/rails:22:in `load'\nfrom /usr/local/bin/rails:22:in `&lt;main&gt;'\n</code></pre>\n<p>As I understand it has something to do with a version of Ruby but I have no idea how to resolve the issue.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "guard"], "comments": [{"owner": {"reputation": 241, "user_id": 8064724, "user_type": "registered", "profile_image": "https://graph.facebook.com/1506651869367107/picture?type=large", "display_name": "Bartosz Bonis\u0142awski", "link": "https://stackoverflow.com/users/8064724/bartosz-bonis%c5%82awski"}, "edited": false, "score": 1, "creation_date": 1517342397, "post_id": 48526467, "comment_id": 84054460, "body": "You can call <code>to_a</code> on <code>modified_files</code> and you&#39;ll have array of file paths. Then you can open them and read them"}, {"owner": {"reputation": 149, "user_id": 1339976, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/04e887979300ac301fa81bf7e0f8c4ce?s=128&d=identicon&r=PG", "display_name": "zapatify", "link": "https://stackoverflow.com/users/1339976/zapatify"}, "reply_to_user": {"reputation": 241, "user_id": 8064724, "user_type": "registered", "profile_image": "https://graph.facebook.com/1506651869367107/picture?type=large", "display_name": "Bartosz Bonis\u0142awski", "link": "https://stackoverflow.com/users/8064724/bartosz-bonis%c5%82awski"}, "edited": false, "score": 0, "creation_date": 1517415566, "post_id": 48526467, "comment_id": 84089138, "body": "I tried it, but maybe I&#39;m not understanding this correctly.  If I did something like this <code>puts modified_files.to_a </code> It should puts the array.  But its saying to_a  is an undefined method."}, {"owner": {"reputation": 149, "user_id": 1339976, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/04e887979300ac301fa81bf7e0f8c4ce?s=128&d=identicon&r=PG", "display_name": "zapatify", "link": "https://stackoverflow.com/users/1339976/zapatify"}, "reply_to_user": {"reputation": 241, "user_id": 8064724, "user_type": "registered", "profile_image": "https://graph.facebook.com/1506651869367107/picture?type=large", "display_name": "Bartosz Bonis\u0142awski", "link": "https://stackoverflow.com/users/8064724/bartosz-bonis%c5%82awski"}, "edited": false, "score": 0, "creation_date": 1517415771, "post_id": 48526467, "comment_id": 84089287, "body": "and if I add <code>.to_s</code>, it puts <code>#&lt;Guard::Watcher::Pattern::MatchResult:0x007fabcf8fb588&gt;</code>.  (the object ID I assume)"}], "owner": {"reputation": 149, "user_id": 1339976, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/04e887979300ac301fa81bf7e0f8c4ce?s=128&d=identicon&r=PG", "display_name": "zapatify", "link": "https://stackoverflow.com/users/1339976/zapatify"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 21, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1517330590, "creation_date": 1517330590, "question_id": 48526467, "link": "https://stackoverflow.com/questions/48526467/using-guard-to-write-to-a-db", "title": "Using Guard to write to a DB", "body": "<p>Has anyone used Guard to track files coming in, and reading them?</p>\n\n<p>I'd like Guard to watch a directory for files added to it, then read them, and write the details to a MySQL DB.  </p>\n\n<p>I have Guard set up, and it watches the correct directory, but I dont know how to reference the file to read it. </p>\n\n<p>In my Rails application I have this in the Guardfile:</p>\n\n<pre><code>guard 'rails' do\n  watch(//) do |modified_files|\n    puts \"Modified files: #{modified_files}\"\n  end\nend\n</code></pre>\n\n<p>When I add a file, it returns the object ID: </p>\n\n<pre><code>Modified files: #&lt;Guard::Watcher::Pattern::MatchResult:0x007f8cadb3fe20&gt;\n</code></pre>\n\n<p>How do you parse that object and view its attributes?  Like what if it were a document and I wanted to read it, how can I incorporate <code>File.open</code> with Guard? </p>\n"}, {"tags": ["ruby-on-rails", "ruby", "shopify-app"], "comments": [{"owner": {"reputation": 2765, "user_id": 5864985, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/UlhbW.jpg?s=128&g=1", "display_name": "Ronan Lopes", "link": "https://stackoverflow.com/users/5864985/ronan-lopes"}, "edited": false, "score": 1, "creation_date": 1517329702, "post_id": 48526181, "comment_id": 84047258, "body": "did you restarted your server after that?"}, {"owner": {"reputation": 186, "user_id": 8747498, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/d9142e4eba926547c833a5264ba00c54?s=128&d=identicon&r=PG&f=1", "display_name": "Gyntonic", "link": "https://stackoverflow.com/users/8747498/gyntonic"}, "reply_to_user": {"reputation": 2765, "user_id": 5864985, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/UlhbW.jpg?s=128&g=1", "display_name": "Ronan Lopes", "link": "https://stackoverflow.com/users/5864985/ronan-lopes"}, "edited": false, "score": 0, "creation_date": 1517330858, "post_id": 48526181, "comment_id": 84047974, "body": "Yes, I did... it still doesn&#39;t work @RonanLopes"}, {"owner": {"reputation": 186, "user_id": 8747498, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/d9142e4eba926547c833a5264ba00c54?s=128&d=identicon&r=PG&f=1", "display_name": "Gyntonic", "link": "https://stackoverflow.com/users/8747498/gyntonic"}, "reply_to_user": {"reputation": 1743, "user_id": 4308435, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Vgr6X.jpg?s=128&g=1", "display_name": "Nikita Misharin", "link": "https://stackoverflow.com/users/4308435/nikita-misharin"}, "edited": false, "score": 0, "creation_date": 1517330915, "post_id": 48526181, "comment_id": 84048012, "body": "I&#39;ve tried moving my lib/ folder into app/ folder and it raises me the error: &quot;Unable to load application: ActiveSupport::Concern::MultipleIncludedBlocks: Cannot define multiple &#39;included&#39; blocks for a Concern&quot; @NikitaMisharin"}], "owner": {"reputation": 186, "user_id": 8747498, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/d9142e4eba926547c833a5264ba00c54?s=128&d=identicon&r=PG&f=1", "display_name": "Gyntonic", "link": "https://stackoverflow.com/users/8747498/gyntonic"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 49, "favorite_count": 0, "closed_date": 1517337404, "answer_count": 0, "score": 0, "last_activity_date": 1517329649, "creation_date": 1517329649, "question_id": 48526181, "link": "https://stackoverflow.com/questions/48526181/rails-how-can-i-load-code-located-in-the-lib-folder", "closed_reason": "Duplicate", "title": "Rails:: How can I load code located in the lib/ folder?", "body": "<p>My folders are:</p>\n\n<pre><code>app/\n-  -controllers/\n-        -shopify_app/\n-               -webhooks_controller.rb\nlib/\n-  -shopify_app/\n-        -controller_concerns/\n-               -webhook_verification.rb\n</code></pre>\n\n<p><strong>webhook_verification.rb code is:</strong> </p>\n\n<pre><code>  module ShopifyApp\n    module WebhookVerification\n      extend ActiveSupport::Concern\n\n      included do\n        skip_before_action :verify_authenticity_token, raise: false\n        before_action :verify_request\n      end\n\n      private\n\n      def verify_request\n        data = request.raw_post\n        return head :unauthorized unless hmac_valid?(data)\n      end\n\n      def hmac_valid?(data)\n        secret = ShopifyApp.configuration.secret\n        digest = OpenSSL::Digest.new('sha256')\n        ActiveSupport::SecurityUtils.secure_compare(\n          shopify_hmac,\n          Base64.encode64(OpenSSL::HMAC.digest(digest, secret, data)).strip\n        )\n      end\n\n      def shop_domain\n        request.headers['HTTP_X_SHOPIFY_SHOP_DOMAIN']\n      end\n\n      def shopify_hmac\n        request.headers['HTTP_X_SHOPIFY_HMAC_SHA256']\n      end\n    end\n  end\n</code></pre>\n\n<p>I would like to include the webhook_verification.rb in webhooks_controller.rb doing <strong>\"include ShopifyApp::WebhookVerification\"</strong>  but it doesn't work.</p>\n\n<p>How can I load the lib folder?</p>\n\n<p><strong>Note: I've tried writing this on my config/application.rb but it doesn't seem to work</strong> </p>\n\n<pre><code>config.autoload_paths += %W(#{config.root}/lib)\nconfig.autoload_paths += Dir[\"#{config.root}/lib/**/\"]\n</code></pre>\n"}, {"tags": ["ruby", "loops", "methods", "iterator", "percentage"], "answers": [{"comments": [{"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 2, "creation_date": 1517328088, "post_id": 48525570, "comment_id": 84046182, "body": "Naming-wise, it feels weird to reassign <code>start</code>. That is starting value, not a running counter. :)"}], "tags": [], "owner": {"reputation": 11, "user_id": 2967350, "user_type": "registered", "profile_image": "https://graph.facebook.com/565610876/picture?type=large", "display_name": "Brad Hudson", "link": "https://stackoverflow.com/users/2967350/brad-hudson"}, "is_accepted": false, "score": 0, "last_activity_date": 1517327748, "creation_date": 1517327748, "answer_id": 48525570, "question_id": 48525437, "link": "https://stackoverflow.com/questions/48525437/ruby-how-to-write-a-loop-of-1-percentage-profit-for-one-year-on-a-1000-invest/48525570#48525570", "title": "Ruby. How to write a loop of 1% percentage profit for one year on a 1000$ investment", "body": "<p>The following is super simple but will get the job done. Basically you initialize a variable to 1000, we then loop 365 times. We have a block where all the math happens. It takes the value 1000 and multiplies it by 1.01 and overwrites the value of the intial investment. You can change the 365 to 2 or however many days you want. The puts print the value of the start. Just run this by putting it in a .rb file and running 'ruby file.rb'</p>\n\n<pre><code>start = 1000\n365.times do\n  start = start*1.01\n  puts start\nend\n\nputs start\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1517330180, "post_id": 48525643, "comment_id": 84047539, "body": "You probably have to round each single profit, not just the result. And you shouldn&#39;t use floats."}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "reply_to_user": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1517331449, "post_id": 48525643, "comment_id": 84048328, "body": "I don&#39;t work in finance, and this is not meant to be an enterprise-level solution... But yes, if you ever deal with numbers in important systems then you should <i>never</i> use floats, or you&#39;ll get subtle inaccuracies as pennies get rounded off!"}, {"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 1, "creation_date": 1517349739, "post_id": 48525643, "comment_id": 84057990, "body": "Also, there might be laws prescribing when and how to round, if the money you are calculating with is not yours."}], "tags": [], "owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "is_accepted": false, "score": 2, "last_activity_date": 1517327949, "creation_date": 1517327949, "answer_id": 48525643, "question_id": 48525437, "link": "https://stackoverflow.com/questions/48525437/ruby-how-to-write-a-loop-of-1-percentage-profit-for-one-year-on-a-1000-invest/48525643#48525643", "title": "Ruby. How to write a loop of 1% percentage profit for one year on a 1000$ investment", "body": "<pre><code>1000 * 1.01**365\n#=&gt; 37783.43433288728\n</code></pre>\n\n<p>You don't need to write a program for this; it's a one-line calculation.</p>\n\n<p>But if you want to do it one day at a time and show the output of each day, how about:</p>\n\n<pre><code>money = 1000\n(1..365).each do |day|\n  money *= 1.01\n  puts \"After #{day} days: $#{money.round(2)}\"\nend\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 9030, "user_id": 5101476, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JCQrl.jpg?s=128&g=1", "display_name": "ice\u30c4", "link": "https://stackoverflow.com/users/5101476/ice%e3%83%84"}, "edited": false, "score": 0, "creation_date": 1517351071, "post_id": 48527442, "comment_id": 84058552, "body": "The dollar-sign normally appears to the left of the specified amount."}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "reply_to_user": {"reputation": 9030, "user_id": 5101476, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JCQrl.jpg?s=128&g=1", "display_name": "ice\u30c4", "link": "https://stackoverflow.com/users/5101476/ice%e3%83%84"}, "edited": false, "score": 0, "creation_date": 1517378384, "post_id": 48527442, "comment_id": 84066120, "body": "@SagarPandya indeed, I just took the format from the OP&#39;s question."}], "tags": [], "owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "is_accepted": true, "score": 1, "last_activity_date": 1517334102, "creation_date": 1517334102, "answer_id": 48527442, "question_id": 48525437, "link": "https://stackoverflow.com/questions/48525437/ruby-how-to-write-a-loop-of-1-percentage-profit-for-one-year-on-a-1000-invest/48527442#48527442", "title": "Ruby. How to write a loop of 1% percentage profit for one year on a 1000$ investment", "body": "<p>You should use <a href=\"http://ruby-doc.org/stdlib-2.5.0/libdoc/bigdecimal/rdoc/BigDecimal.html\" rel=\"nofollow noreferrer\"><code>BigDecimal</code></a> instead of <code>Float</code> when dealing with monetary values:</p>\n\n<pre><code>require 'bigdecimal'\n\nmoney      = BigDecimal('1000')\npercentage = BigDecimal('0.01')\n</code></pre>\n\n<p>For the loop I'd use <a href=\"http://ruby-doc.org/core-2.5.0/Integer.html#method-i-upto\" rel=\"nofollow noreferrer\"><code>upto</code></a> which works very intuitively:</p>\n\n<pre><code>1.upto(365) do |day|\n  money += (money * percentage).round(2)\n  printf(\"%3d: %8.2f$\\n\", day, money)\nend\n</code></pre>\n\n<ul>\n<li><code>money * percentage</code> calculates the day's profit, rounded to 2 digits via <a href=\"http://ruby-doc.org/stdlib-2.5.0/libdoc/bigdecimal/rdoc/BigDecimal.html#method-i-round\" rel=\"nofollow noreferrer\"><code>round</code></a>. You can adjust the <a href=\"http://ruby-doc.org/stdlib-2.5.0/libdoc/bigdecimal/rdoc/BigDecimal.html#method-c-mode\" rel=\"nofollow noreferrer\">rounding mode</a> by passing a second argument.</li>\n<li><a href=\"http://ruby-doc.org/core-2.5.0/Kernel.html#method-i-printf\" rel=\"nofollow noreferrer\"><code>printf</code></a> then outputs day and money using the given formatting:\n\n<ul>\n<li><code>%3d</code> prints an integer with width 3</li>\n<li><code>%8.2f</code> prints a float with 2 fractional digits and a total width of 8</li>\n</ul></li>\n</ul>\n\n<p>Output:</p>\n\n<pre><code>  1:  1010.00$\n  2:  1020.10$\n  3:  1030.30$\n     ...\n363: 37039.07$\n364: 37409.46$\n365: 37783.55$\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 9289934, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-KD1HxNewxb8/AAAAAAAAAAI/AAAAAAAACX0/jGzmA6V5L80/photo.jpg?sz=128", "display_name": "Samuele Fabbro", "link": "https://stackoverflow.com/users/9289934/samuele-fabbro"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 101, "favorite_count": 0, "accepted_answer_id": 48527442, "answer_count": 3, "score": 0, "last_activity_date": 1517334102, "creation_date": 1517327389, "last_edit_date": 1517330703, "question_id": 48525437, "link": "https://stackoverflow.com/questions/48525437/ruby-how-to-write-a-loop-of-1-percentage-profit-for-one-year-on-a-1000-invest", "title": "Ruby. How to write a loop of 1% percentage profit for one year on a 1000$ investment", "body": "<p>I'd like to create a ruby program to calculate the 1% on my investment every day for one year.\nFor example, if I invest 1000$ and get a profit of 1% at the end of the day will be 1010.0$ The second day I will invest 1010.0$ and I will get a 1% profit of 1020.1$ and so on.\nI'd like to determine after 365 days what will be my initial investment.\nI'm trying with a loop to print every single returning value but as you see I'm still a superrookie.\nThanks. Sam</p>\n\n<p>I made it alone! Thanks for all of your answers!</p>\n\n<pre><code>money = 1000\ndays = 0\nperc = 0.01\n\nwhile days &lt; 366\n  puts days\n  puts money\n  days += 1\n  money = money * perc + money\nend\n</code></pre>\n"}, {"tags": ["ruby", "nokogiri", "middleman"], "comments": [{"owner": {"reputation": 330, "user_id": 6482185, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-T11f0D1JFSw/AAAAAAAAAAI/AAAAAAAAAP0/6onfs__d2RE/photo.jpg?sz=128", "display_name": "Will Nguyen", "link": "https://stackoverflow.com/users/6482185/will-nguyen"}, "edited": false, "score": 0, "creation_date": 1517365663, "post_id": 48524978, "comment_id": 84062657, "body": "If you&#39;re using MAC OS you need to install xcode first. Double-check if xcode was removed."}, {"owner": {"reputation": 778, "user_id": 2581843, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000141231384/picture?type=large", "display_name": "Sander Saelmans", "link": "https://stackoverflow.com/users/2581843/sander-saelmans"}, "reply_to_user": {"reputation": 330, "user_id": 6482185, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-T11f0D1JFSw/AAAAAAAAAAI/AAAAAAAAAP0/6onfs__d2RE/photo.jpg?sz=128", "display_name": "Will Nguyen", "link": "https://stackoverflow.com/users/6482185/will-nguyen"}, "edited": false, "score": 0, "creation_date": 1517397990, "post_id": 48524978, "comment_id": 84077139, "body": "@WillNguyen, xCode and the command line tools need to be installed. And xcode-select -p should point to an existing xcode.app path."}, {"owner": {"reputation": 21, "user_id": 6465050, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-24NlwesLgoM/AAAAAAAAAAI/AAAAAAAABRg/q5f6_hIN-_A/photo.jpg?sz=128", "display_name": "Mathieu THOMASSET", "link": "https://stackoverflow.com/users/6465050/mathieu-thomasset"}, "edited": false, "score": 0, "creation_date": 1517473567, "post_id": 48524978, "comment_id": 84112230, "body": "Thanks a lot. Indeed xcode has been removed, maybe when I uptaded macos to the latest version ?  So Nokogiri has been updated.  I still have two issue : 1) I need to replace in the Gemfile https by http due to SSL certificate problem. Do you know how to fix that ?"}, {"owner": {"reputation": 21, "user_id": 6465050, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-24NlwesLgoM/AAAAAAAAAAI/AAAAAAAABRg/q5f6_hIN-_A/photo.jpg?sz=128", "display_name": "Mathieu THOMASSET", "link": "https://stackoverflow.com/users/6465050/mathieu-thomasset"}, "edited": false, "score": 0, "creation_date": 1517473651, "post_id": 48524978, "comment_id": 84112270, "body": "2) During the update I had this message : The dependency wdm (~&gt; 0.1.0) will be unused by any of the platforms Bundler is installing for. Bundler is installing for ruby but the dependency is only for x86-mswin32, x86-mingw32. To add those platforms to the bundle, run <code>bundle lock --add-platform x86-mswin32 x86-mingw32</code>. The dependency tzinfo-data (&gt;= 0) will be unused [...] Bundler is installing for ruby but the dependency is only for x86-mswin32, x86-mingw32, java. To add those platforms to the bundle, run <code>bundle lock --add-platform x86-mswin32 x86-mingw32 java</code>."}], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 6465050, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-24NlwesLgoM/AAAAAAAAAAI/AAAAAAAABRg/q5f6_hIN-_A/photo.jpg?sz=128", "display_name": "Mathieu THOMASSET", "link": "https://stackoverflow.com/users/6465050/mathieu-thomasset"}, "edited": false, "score": 0, "creation_date": 1524042260, "post_id": 49714203, "comment_id": 86806280, "body": "Thanks a lot for your help"}], "tags": [], "owner": {"reputation": 139, "user_id": 5543016, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-tppeX-f7ob4/AAAAAAAAAAI/AAAAAAAAAJI/tNq3AaUuxhY/photo.jpg?sz=128", "display_name": "Tim", "link": "https://stackoverflow.com/users/5543016/tim"}, "is_accepted": false, "score": 2, "last_activity_date": 1523158984, "creation_date": 1523158984, "answer_id": 49714203, "question_id": 48524978, "link": "https://stackoverflow.com/questions/48524978/error-message-when-trying-to-update-nokogiri-gem/49714203#49714203", "title": "Error message when trying to update nokogiri gem", "body": "<p>This helped me on <strong>Ubuntu runnung on WSL</strong>: </p>\n\n<p><code>sudo apt-get install build-essential patch ruby-dev zlib1g-dev liblzma-dev</code></p>\n\n<p>From <a href=\"http://www.nokogiri.org/tutorials/installing_nokogiri.html\" rel=\"nofollow noreferrer\">official Nokogiri installation instructions</a></p>\n\n<p>For <strong>Mac OS</strong>, it suggests:</p>\n\n<ol>\n<li><p>First, make sure you have the latest version of RubyGems and xcode commandline tools:</p></li>\n<li><p>Run:</p></li>\n</ol>\n\n<p><code>gem update --system</code></p>\n\n<p><code>xcode-select --install</code></p>\n\n<ol start=\"3\">\n<li>Then install nokogiri:</li>\n</ol>\n\n<p><code>gem install nokogiri</code></p>\n\n<p>There are more troubleshooting tips on that page.</p>\n"}], "owner": {"reputation": 21, "user_id": 6465050, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-24NlwesLgoM/AAAAAAAAAAI/AAAAAAAABRg/q5f6_hIN-_A/photo.jpg?sz=128", "display_name": "Mathieu THOMASSET", "link": "https://stackoverflow.com/users/6465050/mathieu-thomasset"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1764, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1523158984, "creation_date": 1517326040, "question_id": 48524978, "link": "https://stackoverflow.com/questions/48524978/error-message-when-trying-to-update-nokogiri-gem", "title": "Error message when trying to update nokogiri gem", "body": "<p>I have an error message when trying to update Nokogiri gem :</p>\n\n<blockquote>\n  <p>The dependency wdm (~> 0.1.0) will be unused by any of the platforms\n  Bundler is installing for. Bundler is installing for ruby but the\n  dependency is only for x86-mswin32, x86-mingw32. To add those\n  platforms to the bundle, run <code>bundle lock --add-platform x86-mswin32\n  x86-mingw32</code>. The dependency tzinfo-data (>= 0) will be unused by any\n  of the platforms Bundler is installing for. Bundler is installing for\n  ruby but the dependency is only for x86-mswin32, x86-mingw32, java. To\n  add those platforms to the bundle, run <code>bundle lock --add-platform\n  x86-mswin32 x86-mingw32 java</code>. Fetching gem metadata from\n  <a href=\"http://rubygems.org/\" rel=\"nofollow noreferrer\">http://rubygems.org/</a>.............. Fetching gem metadata from\n  <a href=\"http://rubygems.org/\" rel=\"nofollow noreferrer\">http://rubygems.org/</a>.. Resolving dependencies... Using i18n 0.7.0\n  Using json 1.8.3 Using minitest 5.7.0 Using thread_safe 0.3.5 Using\n  tzinfo 1.2.2 Using activesupport 4.1.11 Using addressable 2.3.8 Using\n  execjs 2.5.2 Using autoprefixer-rails 5.2.1 Using sass 3.4.15 Using\n  bootstrap-sass 3.3.5 Using bundler 1.16.0 Using hitimes 1.2.2 Using\n  timers 4.0.1 Using celluloid 0.16.0 Using chunky_png 1.3.4 Using\n  coffee-script-source 1.9.1.1 Using coffee-script 2.4.1 Using\n  multi_json 1.11.1 Using compass-core 1.0.3 Using compass-import-once\n  1.0.5 Using rb-fsevent 0.9.5 Using ffi 1.9.8 Using rb-inotify 0.9.5 Using compass 1.0.3 Using eventmachine 1.0.7 Using http_parser.rb\n  0.6.0 Using em-websocket 0.5.1 Using erubis 2.7.0 Using font-awesome-sass 4.2.2 Using tilt 1.4.1 Using haml 4.0.6 Using hike\n  1.2.3 Using uber 0.0.13 Using hooks 0.4.0 Using htmlcompressor 0.2.0 Using thor 0.19.1 Using jquery-middleman 3.1.2 Using kramdown 1.7.0\n  Using listen 2.10.1 Using padrino-support 0.12.5 Using padrino-helpers\n  0.12.5 Using rack 1.6.4 Using rack-test 0.6.3 Using middleman-core 3.3.12 Using sprockets 2.12.3 Using sprockets-helpers 1.1.0 Using sprockets-sass 1.3.1 Using middleman-sprockets 3.4.2 Using uglifier\n  2.7.1 Using middleman 3.3.12 Using middleman-blog 3.5.3 Using net-ssh 2.9.2 Using net-sftp 2.1.2 Using ptools 1.3.2 Using middleman-deploy 1.0.0 Using middleman-disqus 1.1.0 Using rack-livereload 0.3.15 Using middleman-livereload 3.1.1 Using middleman-minify-html 3.4.1 Using\n  middleman-protect-emails 0.3.1 Using mini_portile2 2.3.0 Fetching\n  nokogiri 1.8.2 (was 1.6.6.4) Installing nokogiri 1.8.2 (was 1.6.6.4)\n  with native extensions Gem::Ext::BuildError: ERROR: Failed to build\n  gem native extension.</p>\n\n<pre><code>current directory: /usr/local/var/rbenv/versions/2.2.2/lib/ruby/gems/2.2.0/gems/nokogiri-1.8.2/ext/nokogiri\n</code></pre>\n  \n  <p>/usr/local/var/rbenv/versions/2.2.2/bin/ruby -r\n  ./siteconf20180130-47766-zngdwi.rb extconf.rb checking if the C\n  compiler accepts ... <strong>* extconf.rb failed *</strong> Could not create\n  Makefile due to some reason, probably lack of necessary libraries\n  and/or headers.  Check the mkmf.log file for more details.  You may\n  need configuration options.</p>\n  \n  <p>Provided configuration options:   --with-opt-dir  --without-opt-dir\n    --with-opt-include  --without-opt-include=${opt-dir}/include\n    --with-opt-lib  --without-opt-lib=${opt-dir}/lib    --with-make-prog\n    --without-make-prog     --srcdir=.  --curdir\n    --ruby=/usr/local/var/rbenv/versions/2.2.2/bin/$(RUBY_BASE_NAME)\n    --help  --clean\n  /usr/local/var/rbenv/versions/2.2.2/lib/ruby/2.2.0/mkmf.rb:456:in\n  <code>try_do': The compiler failed to generate an executable file.\n  (RuntimeError) You have to install development tools first.   from\n  /usr/local/var/rbenv/versions/2.2.2/lib/ruby/2.2.0/mkmf.rb:571:in\n  </code>block in try_compile'    from\n  /usr/local/var/rbenv/versions/2.2.2/lib/ruby/2.2.0/mkmf.rb:522:in\n  <code>with_werror'     from\n  /usr/local/var/rbenv/versions/2.2.2/lib/ruby/2.2.0/mkmf.rb:571:in\n  </code>try_compile'     from extconf.rb:138:in <code>nokogiri_try_compile'   from\n  extconf.rb:162:in</code>block in add_cflags'   from\n  /usr/local/var/rbenv/versions/2.2.2/lib/ruby/2.2.0/mkmf.rb:619:in\n  <code>with_cflags'     from extconf.rb:161:in</code>add_cflags'     from\n  extconf.rb:410:in `'</p>\n  \n  <p>To see why this extension failed to compile, please check the mkmf.log\n  which can be found here:</p>\n  \n  <p>/usr/local/var/rbenv/versions/2.2.2/lib/ruby/gems/2.2.0/extensions/x86_64-darwin-13/2.2.0-static/nokogiri-1.8.2/mkmf.log</p>\n  \n  <p>extconf failed, exit code 1</p>\n  \n  <p>Gem files will remain installed in\n  /usr/local/var/rbenv/versions/2.2.2/lib/ruby/gems/2.2.0/gems/nokogiri-1.8.2\n  for inspection. Results logged to\n  /usr/local/var/rbenv/versions/2.2.2/lib/ruby/gems/2.2.0/extensions/x86_64-darwin-13/2.2.0-static/nokogiri-1.8.2/gem_make.out</p>\n  \n  <p>An error occurred while installing nokogiri (1.8.2), and Bundler\n  cannot continue. Make sure that <code>gem install nokogiri -v '1.8.2'</code>\n  succeeds before bundling.</p>\n  \n  <p>In Gemfile:   nokogiri</p>\n</blockquote>\n"}, {"tags": ["ruby-on-rails", "ruby", "rubocop"], "answers": [{"comments": [{"owner": {"reputation": 119, "user_id": 7738138, "user_type": "registered", "accept_rate": 55, "profile_image": "https://graph.facebook.com/1728017913892004/picture?type=large", "display_name": "JiaPing", "link": "https://stackoverflow.com/users/7738138/jiaping"}, "edited": false, "score": 0, "creation_date": 1518928163, "post_id": 48524946, "comment_id": 84700727, "body": "Thank you! I checked my version is <code>0.52.1</code> . So I probably name it <code>Naming&#47;AccessorMethodName</code> instead of  <code>Style&#47;AccessorMethodName</code> and <code>AccessorMethodName </code>"}], "tags": [], "owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "is_accepted": true, "score": 1, "last_activity_date": 1517325928, "creation_date": 1517325928, "answer_id": 48524946, "question_id": 48524423, "link": "https://stackoverflow.com/questions/48524423/whats-different-between-accessormethodname-and-style-accessormethodname/48524946#48524946", "title": "What&#39;s different between AccessorMethodName and Style/AccessorMethodName", "body": "<p>Rubocop has (unbelievably) still not released <code>v1.0</code> of the library. The developers still often make \"breaking\" changes by moving things around and altering behaviour.</p>\n\n<p>The <code>AccessorMethodName</code> cop was <a href=\"https://github.com/bbatsov/rubocop/blob/master/CHANGELOG.md#new-features-39\" rel=\"nofollow noreferrer\">added</a> to <code>rubocop</code> in <code>v0.16</code>. (<a href=\"https://github.com/bbatsov/rubocop/commit/1ac25b882b53e97601f10d1bf7ed4c450043e18a#diff-4d9059990c47aef226fbaabe9607dbaf\" rel=\"nofollow noreferrer\">Commit</a>).</p>\n\n<p>In <code>v0.50</code>, it was <a href=\"https://github.com/bbatsov/rubocop/commit/d825a020510091b70a04f3db21fc4295f0cae186#diff-ffe3f42d3bcd3318d6fc6c834e3c31fa\" rel=\"nofollow noreferrer\">renamed</a> from <code>Style/AccessorMethodName</code> to <code>Naming/AccessorMethodName</code>.</p>\n\n<p>The exact behaviour of this cop, and the \"correct name\" for it, depends on your <code>rubocop</code> version. But essentially, it's the same thing.</p>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 2967350, "user_type": "registered", "profile_image": "https://graph.facebook.com/565610876/picture?type=large", "display_name": "Brad Hudson", "link": "https://stackoverflow.com/users/2967350/brad-hudson"}, "is_accepted": false, "score": 0, "last_activity_date": 1517326295, "creation_date": 1517326295, "answer_id": 48525054, "question_id": 48524423, "link": "https://stackoverflow.com/questions/48524423/whats-different-between-accessormethodname-and-style-accessormethodname/48525054#48525054", "title": "What&#39;s different between AccessorMethodName and Style/AccessorMethodName", "body": "<p><a href=\"https://github.com/bbatsov/rubocop/blob/aecd5eadfdcb57be213729d2e98fba7a3c02de6c/lib/rubocop/config.rb#L71\" rel=\"nofollow noreferrer\">https://github.com/bbatsov/rubocop/blob/aecd5eadfdcb57be213729d2e98fba7a3c02de6c/lib/rubocop/config.rb#L71</a></p>\n\n<p>Check that line out. Looks like it was moved from Style to 'Naming'. Not sure if it should work without 'Naming/', but it might.</p>\n\n<p>Can also see it here\n<a href=\"http://www.rubydoc.info/gems/rubocop/RuboCop/Config\" rel=\"nofollow noreferrer\">http://www.rubydoc.info/gems/rubocop/RuboCop/Config</a></p>\n"}], "owner": {"reputation": 119, "user_id": 7738138, "user_type": "registered", "accept_rate": 55, "profile_image": "https://graph.facebook.com/1728017913892004/picture?type=large", "display_name": "JiaPing", "link": "https://stackoverflow.com/users/7738138/jiaping"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 185, "favorite_count": 0, "accepted_answer_id": 48524946, "answer_count": 2, "score": 0, "last_activity_date": 1517326295, "creation_date": 1517324327, "last_edit_date": 1517324598, "question_id": 48524423, "link": "https://stackoverflow.com/questions/48524423/whats-different-between-accessormethodname-and-style-accessormethodname", "title": "What&#39;s different between AccessorMethodName and Style/AccessorMethodName", "body": "<p>I've been searching a while and still don't know what's different between these <code>AccessorMethodName</code> and in <code>.rubocop.yml</code> configuration file?</p>\n\n<p>Since I saw my coworker change <code>Style/AccessorMethodName</code> to <code>AccessorMethodName</code>.</p>\n"}, {"tags": ["ruby", "rspec"], "comments": [{"owner": {"reputation": 33085, "user_id": 2423164, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/Nxbnp.jpg?s=128&g=1", "display_name": "ndnenkov", "link": "https://stackoverflow.com/users/2423164/ndnenkov"}, "edited": false, "score": 0, "creation_date": 1517323361, "post_id": 48523815, "comment_id": 84042815, "body": "What is inside <code>new_trx_id</code>? And what do you think <code>#dig</code> does?"}, {"owner": {"reputation": 7004, "user_id": 1103606, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/0d93cc650b93939ea91066fcb5aefae0?s=128&d=identicon&r=PG", "display_name": "Peter Penzov", "link": "https://stackoverflow.com/users/1103606/peter-penzov"}, "reply_to_user": {"reputation": 33085, "user_id": 2423164, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/Nxbnp.jpg?s=128&g=1", "display_name": "ndnenkov", "link": "https://stackoverflow.com/users/2423164/ndnenkov"}, "edited": false, "score": 0, "creation_date": 1517323426, "post_id": 48523815, "comment_id": 84042865, "body": "@ndn it should store very long string"}, {"owner": {"reputation": 33085, "user_id": 2423164, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/Nxbnp.jpg?s=128&g=1", "display_name": "ndnenkov", "link": "https://stackoverflow.com/users/2423164/ndnenkov"}, "edited": false, "score": 0, "creation_date": 1517323569, "post_id": 48523815, "comment_id": 84042966, "body": "Please provide <a href=\"https://stackoverflow.com/help/mcve\">Minimal, Complete and Verifiable example</a> if you want comprehensive help."}, {"owner": {"reputation": 1196, "user_id": 8426717, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-QwYD3zUWkhA/AAAAAAAAAAI/AAAAAAAABJs/2y8hDOo4fYY/photo.jpg?sz=128", "display_name": "Tai", "link": "https://stackoverflow.com/users/8426717/tai"}, "edited": false, "score": 0, "creation_date": 1517323598, "post_id": 48523815, "comment_id": 84042981, "body": "You parse xml using <code>nokogiri</code> or <code>nori</code>? Are there any code between <code>new_xml_body = Nokogiri::XML(new_xml)</code> and the last line?"}, {"owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 0, "creation_date": 1517323736, "post_id": 48523815, "comment_id": 84043094, "body": "<code>new_xml_body.search(&#39;transaction_id&#39;).first.text</code> obviously returns a string. You cannot call <code>dig</code> on a string. What do you think <code>new_xml_body.search(&#39;transaction_id&#39;).first.text</code> returns? What do you try to achieve by calling <code>dig</code>?"}, {"owner": {"reputation": 41846, "user_id": 926143, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/3396173c3d22988be1a0732d184902aa?s=128&d=identicon&r=PG", "display_name": "7stud", "link": "https://stackoverflow.com/users/926143/7stud"}, "edited": false, "score": 2, "creation_date": 1517323868, "post_id": 48523815, "comment_id": 84043187, "body": "<i>I want to use dig in order to get XML tag value</i> -- Why don&#39;t you just use nokogiri for that?  After all, that is what nokogiri is for.   The ruby_dig docs state that dig is a method for Hashes or Arrays, yet you are calling dig() on the return value of Nokogiri::XML(), which is neither a Hash nor an Array, hence the error."}, {"owner": {"reputation": 7004, "user_id": 1103606, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/0d93cc650b93939ea91066fcb5aefae0?s=128&d=identicon&r=PG", "display_name": "Peter Penzov", "link": "https://stackoverflow.com/users/1103606/peter-penzov"}, "reply_to_user": {"reputation": 41846, "user_id": 926143, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/3396173c3d22988be1a0732d184902aa?s=128&d=identicon&r=PG", "display_name": "7stud", "link": "https://stackoverflow.com/users/926143/7stud"}, "edited": false, "score": 0, "creation_date": 1517324613, "post_id": 48523815, "comment_id": 84043743, "body": "@7stud Can you show me working example please?"}], "answers": [{"comments": [{"owner": {"reputation": 41846, "user_id": 926143, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/3396173c3d22988be1a0732d184902aa?s=128&d=identicon&r=PG", "display_name": "7stud", "link": "https://stackoverflow.com/users/926143/7stud"}, "reply_to_user": {"reputation": 7004, "user_id": 1103606, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/0d93cc650b93939ea91066fcb5aefae0?s=128&d=identicon&r=PG", "display_name": "Peter Penzov", "link": "https://stackoverflow.com/users/1103606/peter-penzov"}, "edited": false, "score": 0, "creation_date": 1517384160, "post_id": 48524617, "comment_id": 84068589, "body": "You can&#39;t use dig() on the return value of Nokogiri::XML(), so no I cannot show you an example.  What is your preoccupation with dig() -- it&#39;s an irrelevant method to begin with that provides nothing new to the ruby language."}, {"owner": {"reputation": 7004, "user_id": 1103606, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/0d93cc650b93939ea91066fcb5aefae0?s=128&d=identicon&r=PG", "display_name": "Peter Penzov", "link": "https://stackoverflow.com/users/1103606/peter-penzov"}, "edited": false, "score": 0, "creation_date": 1517384333, "post_id": 48524617, "comment_id": 84068670, "body": "Ok, another way: can you show me how I can convert Nokogiri XML to Hash? After that I will use .dig."}, {"owner": {"reputation": 41846, "user_id": 926143, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/3396173c3d22988be1a0732d184902aa?s=128&d=identicon&r=PG", "display_name": "7stud", "link": "https://stackoverflow.com/users/926143/7stud"}, "reply_to_user": {"reputation": 7004, "user_id": 1103606, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/0d93cc650b93939ea91066fcb5aefae0?s=128&d=identicon&r=PG", "display_name": "Peter Penzov", "link": "https://stackoverflow.com/users/1103606/peter-penzov"}, "edited": false, "score": 0, "creation_date": 1517384474, "post_id": 48524617, "comment_id": 84068736, "body": "@PeterPenzov, Are you using rails?"}, {"owner": {"reputation": 41846, "user_id": 926143, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/3396173c3d22988be1a0732d184902aa?s=128&d=identicon&r=PG", "display_name": "7stud", "link": "https://stackoverflow.com/users/926143/7stud"}, "reply_to_user": {"reputation": 7004, "user_id": 1103606, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/0d93cc650b93939ea91066fcb5aefae0?s=128&d=identicon&r=PG", "display_name": "Peter Penzov", "link": "https://stackoverflow.com/users/1103606/peter-penzov"}, "edited": false, "score": 0, "creation_date": 1517385739, "post_id": 48524617, "comment_id": 84069363, "body": "@PeterPenzov, <code>dig()</code> example at bottom of my answer."}], "tags": [], "owner": {"reputation": 41846, "user_id": 926143, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/3396173c3d22988be1a0732d184902aa?s=128&d=identicon&r=PG", "display_name": "7stud", "link": "https://stackoverflow.com/users/926143/7stud"}, "is_accepted": true, "score": 2, "last_activity_date": 1517391971, "last_edit_date": 1517391971, "creation_date": 1517324972, "answer_id": 48524617, "question_id": 48523815, "link": "https://stackoverflow.com/questions/48523815/undefined-method-dig-for-string0x007f91d8579308/48524617#48524617", "title": "undefined method `dig&#39; for #&lt;String:0x007f91d8579308&gt;", "body": "<p>Nokogiri search example:</p>\n\n<pre><code>require 'nokogiri'\n\nxml_doc  = Nokogiri::XML %q{\n&lt;root&gt;\n  &lt;aliens&gt;\n    &lt;alien&gt;\n      &lt;name&gt;Alf&lt;/name&gt;\n    &lt;/alien&gt;\n    &lt;human&gt;\n      &lt;name&gt;Peter&lt;/name&gt;\n    &lt;/human&gt;\n    &lt;alien&gt;\n      &lt;name&gt;Bob&lt;/name&gt;\n    &lt;/alien&gt;\n  &lt;/aliens&gt;\n&lt;/root&gt;\n}\n\nalien_names = xml_doc.xpath('//alien/name/text()')\n\nalien_names.each do |name|\n  puts name\nend\n\n--output:--\nAlf\nBob\n</code></pre>\n\n<p>And:</p>\n\n<pre><code>xml_doc  = Nokogiri::XML %q{\n&lt;root&gt;\n  &lt;aliens&gt;\n    &lt;alien planet=\"Mars\"&gt;\n      &lt;name&gt;Alf&lt;/name&gt;\n    &lt;/alien&gt;\n    &lt;human&gt;\n      &lt;name&gt;Peter&lt;/name&gt;\n    &lt;/human&gt;\n    &lt;alien planet=\"Alpha Centauri\"&gt;\n      &lt;name&gt;Bob&lt;/name&gt;\n    &lt;/alien&gt;\n  &lt;/aliens&gt;\n&lt;/root&gt;\n}\n\nalien_names = xml_doc.xpath('//alien[@planet=\"Alpha Centauri\"]/name/text()')\n\nalien_names.each do |name|\n  puts name\nend\n\n--output:--\nBob\n</code></pre>\n\n<p>If you know css, you can also use <a href=\"https://www.w3schools.com/cssref/css_selectors.asp\" rel=\"nofollow noreferrer\">css selectors</a>:</p>\n\n<pre><code>name_tags = xml_doc.css('alien &gt; name')\n\nname_tags.each do |name_tag|\n  puts name_tag.text\nend\n\n--output:--\nAlf\nBob\n</code></pre>\n\n<p><strong>Response to comment</strong>:</p>\n\n<p><code>Rails</code> has a <code>Hash#from_xml()</code> method.  Here is an example using <code>dig()</code>:</p>\n\n<pre><code>require 'active_support/core_ext/hash/conversions'\nrequire 'pp'\n\nxml = %q{\n&lt;aliens&gt;\n  &lt;alien planet=\"Mars\"&gt;\n    &lt;name&gt;Alf&lt;/name&gt;\n  &lt;/alien&gt;\n  &lt;human&gt;\n    &lt;name&gt;Peter&lt;/name&gt;\n  &lt;/human&gt;\n  &lt;alien planet=\"Alpha Centauri\"&gt;\n    &lt;name&gt;Bob&lt;/name&gt;\n  &lt;/alien&gt;\n&lt;/aliens&gt;\n}\n\nhash = Hash.from_xml(xml)   #rails method\npp hash\np hash.dig 'aliens', 'human', 'name'\np hash['aliens']['human']['name']\n\n--output:--\n{\"aliens\"=&gt;\n  {\"alien\"=&gt;\n    [{\"planet\"=&gt;\"Mars\", \"name\"=&gt;\"Alf\"},\n     {\"planet\"=&gt;\"Alpha Centauri\", \"name\"=&gt;\"Bob\"}],\n   \"human\"=&gt;{\"name\"=&gt;\"Peter\"}}}\n\n\"Peter\"\n\"Peter\"\n</code></pre>\n\n<p>If you need to run the xml string through nokogiri first, then just do</p>\n\n<pre><code>doc = Nokogiri:XML(xml)\nstring = doc.to_s\nhash = Hash.from_xml(string)\n...\n</code></pre>\n"}], "owner": {"reputation": 7004, "user_id": 1103606, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/0d93cc650b93939ea91066fcb5aefae0?s=128&d=identicon&r=PG", "display_name": "Peter Penzov", "link": "https://stackoverflow.com/users/1103606/peter-penzov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1052, "favorite_count": 0, "accepted_answer_id": 48524617, "answer_count": 1, "score": -1, "last_activity_date": 1517391971, "creation_date": 1517322620, "question_id": 48523815, "link": "https://stackoverflow.com/questions/48523815/undefined-method-dig-for-string0x007f91d8579308", "title": "undefined method `dig&#39; for #&lt;String:0x007f91d8579308&gt;", "body": "<p>I want to use dig in order to get XML tag value. I tried this:</p>\n\n<pre><code>new_xml_body = Nokogiri::XML(new_xml)\nnew_trx_id = new_xml_body.search('transaction_id').first.text\n</code></pre>\n\n<p>Using dig:</p>\n\n<pre><code>require 'nokogiri'\nrequire 'nori'\nrequire 'pry'\nrequire 'active_model'\nrequire 'ruby_dig'\nnew_xml_body = Nokogiri::XML(new_xml)\nnew_trx_id = new_xml_body.dig('transaction_id')\n</code></pre>\n\n<p>But I get:</p>\n\n<pre><code>NoMethodError:\n       undefined method `dig' for #&lt;String:0x007f91d8579308&gt;\n</code></pre>\n\n<p>Can you propose some solution of the problem?</p>\n"}, {"tags": ["ruby", "postgresql", "docker", "dockerfile", "mysql2psql-gem"], "answers": [{"tags": [], "owner": {"reputation": 51, "user_id": 7093108, "user_type": "registered", "profile_image": "https://graph.facebook.com/10206890440164821/picture?type=large", "display_name": "Rafael Jung", "link": "https://stackoverflow.com/users/7093108/rafael-jung"}, "is_accepted": true, "score": 0, "last_activity_date": 1517394702, "creation_date": 1517394702, "answer_id": 48539957, "question_id": 48523164, "link": "https://stackoverflow.com/questions/48523164/error-installing-mysql2psql-error-failed-to-build-gem-native-extension/48539957#48539957", "title": "Error installing mysql2psql: ERROR: Failed to build gem native extension", "body": "<p>First, you have an error in your Dockerfile: you should not put <code>\\</code> on the end of the <code>RUN</code> command.</p>\n\n<p>The problem you are having installing this gem relates to it just being too old. This gem requires <code>gem mysql -v '2.8.1'</code>, which is only compatible with Ruby 2.1 or earlier.</p>\n\n<p>So, to get this working, you could change your ruby version, by using <code>FROM ruby:2.1</code> or using another gem for the task, for example: <a href=\"https://github.com/maxlapshin/mysql2postgres\" rel=\"nofollow noreferrer\">https://github.com/maxlapshin/mysql2postgres</a>.</p>\n\n<p>Working solution:</p>\n\n<pre><code>FROM ruby:2.1\n\nRUN apt-get update &amp;&amp; apt-get install -y \\\n  build-essential \\\n  nodejs \\\n  mysql-client \\\n  libmysqlclient-dev \\\n  libpq-dev\n\nRUN mkdir -p /app\nWORKDIR /app\n\nRUN gem install mysql2psql\n</code></pre>\n"}], "owner": {"reputation": 2502, "user_id": 1016439, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/84184ddecf5e9bb8483f80e7ac2e5fe4?s=128&d=identicon&r=PG", "display_name": "Jepzen", "link": "https://stackoverflow.com/users/1016439/jepzen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 305, "favorite_count": 0, "accepted_answer_id": 48539957, "answer_count": 1, "score": 0, "last_activity_date": 1517394702, "creation_date": 1517320555, "question_id": 48523164, "link": "https://stackoverflow.com/questions/48523164/error-installing-mysql2psql-error-failed-to-build-gem-native-extension", "title": "Error installing mysql2psql: ERROR: Failed to build gem native extension", "body": "<p>Im trying to build a docker container to migrate a MySql database to a Postgresql. Plan is to then ad images for each server in a docker-compose.yml, but my initial image build fails</p>\n\n<p>My dockerfile:</p>\n\n<pre><code>FROM ruby:2.4.0\n\nRUN apt-get update &amp;&amp; apt-get install -y \\ \n  build-essential \\ \n  nodejs \\\n  mysql-client \\ \n  libmysqlclient-dev \\\n  libpq-dev \\\n\n\nRUN mkdir -p /app \nWORKDIR /app\n\nRUN gem install mysql2psql\n</code></pre>\n\n<p>But I get an error: </p>\n\n<pre><code>Building native extensions.  This could take a while...\nERROR:  Error installing mysql2psql:\n        ERROR: Failed to build gem native extension.\n\n    current directory: /usr/local/bundle/gems/mysql-2.8.1/ext/mysql_api\n/usr/local/bin/ruby -r ./siteconf20180130-1553-1id0936.rb extconf.rb\nchecking for mysql_ssl_set()... yes\nchecking for rb_str_set_len()... yes\nchecking for rb_thread_start_timer()... no\nchecking for mysql.h... yes\n*** extconf.rb failed ***\nCould not create Makefile due to some reason, probably lack of necessary\nlibraries and/or headers.  Check the mkmf.log file for more details.  You may\nneed configuration options.\n\nProvided configuration options:\n        --with-opt-dir\n        --without-opt-dir\n        --with-opt-include\n        --without-opt-include=${opt-dir}/include\n        --with-opt-lib\n        --without-opt-lib=${opt-dir}/lib\n        --with-make-prog\n        --without-make-prog\n        --srcdir=.\n        --curdir\n        --ruby=/usr/local/bin/$(RUBY_BASE_NAME)\n        --with-mysql-config\n        --without-mysql-config\nextconf.rb:67:in `&lt;main&gt;': uninitialized constant Config (NameError)\nDid you mean?  RbConfig\n               CONFIG\n\nTo see why this extension failed to compile, please check the mkmf.log which can be found here:\n\n  /usr/local/bundle/extensions/x86_64-linux/2.4.0/mysql-2.8.1/mkmf.log\n\nextconf failed, exit code 1\n\nGem files will remain installed in /usr/local/bundle/gems/mysql-2.8.1 for inspection.\nResults logged to /usr/local/bundle/extensions/x86_64-linux/2.4.0/mysql-2.8.1/gem_make.out\n</code></pre>\n\n<p>What am I missing?</p>\n"}, {"tags": ["ruby", "mongodb"], "answers": [{"tags": [], "owner": {"reputation": 1521, "user_id": 7177640, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/21ab719e4dfae3533a20da4f52e5c9e7?s=128&d=identicon&r=PG", "display_name": "nattfodd", "link": "https://stackoverflow.com/users/7177640/nattfodd"}, "is_accepted": true, "score": 1, "last_activity_date": 1517326383, "creation_date": 1517326383, "answer_id": 48525083, "question_id": 48522619, "link": "https://stackoverflow.com/questions/48522619/retrieve-key-values-from-bson-document-using-ruby/48525083#48525083", "title": "Retrieve key values from BSON document using Ruby", "body": "<p>Since <code>doc</code> is a simple hash, you can call <code>.values</code> method on it, returning values of the hash. And if you're sure there is only one pair of key-value, or you need only the first one, try this:</p>\n\n<pre><code>- puts doc.to_s\n+ puts doc.values.first\n</code></pre>\n"}], "owner": {"reputation": 2571, "user_id": 6822876, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/i6dGp.jpg?s=128&g=1", "display_name": "Carrein", "link": "https://stackoverflow.com/users/6822876/carrein"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 348, "favorite_count": 0, "accepted_answer_id": 48525083, "answer_count": 1, "score": 0, "last_activity_date": 1517326383, "creation_date": 1517318894, "question_id": 48522619, "link": "https://stackoverflow.com/questions/48522619/retrieve-key-values-from-bson-document-using-ruby", "title": "Retrieve key values from BSON document using Ruby", "body": "<p>I'm working with MongoDB using Ruby.</p>\n\n<p>I am able to query a document by doing something like this:</p>\n\n<pre><code>client[:inventory].find({\"owner\": identity}, projection: {\"_id\": 0, \"group\": 1}).each do |doc| \n  #Finds and returns a BSON document matching the query.\n  puts doc.to_s\nend\n</code></pre>\n\n<p>However this gives the following key/value pair in String representation:</p>\n\n<pre><code>{\"name\" =&gt; \"john\"}\n</code></pre>\n\n<p>How would I retrieve <strong>only</strong> the value from the returned BSON document, removing the braces and hash rocket, in this case <code>john</code>?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "transactions"], "comments": [{"owner": {"reputation": 41846, "user_id": 926143, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/3396173c3d22988be1a0732d184902aa?s=128&d=identicon&r=PG", "display_name": "7stud", "link": "https://stackoverflow.com/users/926143/7stud"}, "edited": false, "score": 0, "creation_date": 1517318495, "post_id": 48521841, "comment_id": 84039501, "body": "<i>I&#39;m having an issue running payments</i> --I had a similar issue.  The solution was pretty simple."}, {"owner": {"reputation": 149, "user_id": 5914341, "user_type": "registered", "accept_rate": 46, "profile_image": "https://graph.facebook.com/10208640241620387/picture?type=large", "display_name": "justinedps26", "link": "https://stackoverflow.com/users/5914341/justinedps26"}, "reply_to_user": {"reputation": 41846, "user_id": 926143, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/3396173c3d22988be1a0732d184902aa?s=128&d=identicon&r=PG", "display_name": "7stud", "link": "https://stackoverflow.com/users/926143/7stud"}, "edited": false, "score": 2, "creation_date": 1517319934, "post_id": 48521841, "comment_id": 84040432, "body": "@7stud alright, can you help me please?"}], "owner": {"reputation": 149, "user_id": 5914341, "user_type": "registered", "accept_rate": 46, "profile_image": "https://graph.facebook.com/10208640241620387/picture?type=large", "display_name": "justinedps26", "link": "https://stackoverflow.com/users/5914341/justinedps26"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1508, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1548257805, "creation_date": 1517316336, "last_edit_date": 1517404511, "question_id": 48521841, "link": "https://stackoverflow.com/questions/48521841/probl%c3%a8me-didentification-du-commerce-acc%c3%a8s-refus%c3%a9-e-transactions-paybox", "title": "Probl&#232;me d&#39;identification du commerce. Acc&#232;s refus&#233; ! E-Transactions/Paybox", "body": "<p>I'm having an issue running payments with Paybox via e-transactions system from Cr\u00e9dit Agricole (French bank).</p>\n\n<p>I have no issues with the variables i'm sending through the form, which is the following:</p>\n\n<pre><code>&lt;form method=\"POST\" action=\"&lt;%= ENV['CREDIT_AGRICOLE_URL'] %&gt;\" id=\"paiement-form\"&gt;\n  &lt;input type=\"hidden\" name=\"PBX_SITE\" value=\"&lt;%= ENV['PBX_SITE'] %&gt;\"&gt;\n  &lt;input type=\"hidden\" name=\"PBX_RANG\" value=\"&lt;%= ENV['PBX_RANG'] %&gt;\"&gt;\n  &lt;input type=\"hidden\" name=\"PBX_IDENTIFIANT\" value=\"&lt;%= ENV['PBX_IDENTIFIANT'] %&gt;\"&gt;\n  &lt;input type=\"hidden\" name=\"PBX_TOTAL\" value=\"&lt;%= @commande.total_price_centimes %&gt;\"&gt;\n  &lt;input type=\"hidden\" name=\"PBX_DEVISE\" value=\"978\"&gt;\n  &lt;input type=\"hidden\" name=\"PBX_CMD\" value=\"&lt;%= @commande.code %&gt;\"&gt;\n  &lt;input type=\"hidden\" name=\"PBX_PORTEUR\" value=\"&lt;%= ENV['PBX_PORTEUR'] %&gt;\"&gt;\n  &lt;input type=\"hidden\" name=\"PBX_REPONDRE_A\" value=\"&lt;%= ENV['PBX_REPONDRE_A'] %&gt;\"&gt;\n  &lt;input type=\"hidden\" name=\"PBX_RETOUR\" value=\"&lt;%= ENV['PBX_RETOUR'] %&gt;\"&gt;\n  &lt;input type=\"hidden\" name=\"PBX_EFFECTUE\" value=\"&lt;%= @confirmation_url %&gt;\"&gt;\n  &lt;input type=\"hidden\" name=\"PBX_ANNULE\" value=\"&lt;%= @annulation_url %&gt;\"&gt;\n  &lt;input type=\"hidden\" name=\"PBX_REFUSE\" value=\"&lt;%= @refus_url %&gt;\"&gt;\n  &lt;input type=\"hidden\" name=\"PBX_HASH\" value=\"SHA512\"&gt;\n  &lt;input type=\"hidden\" name=\"PBX_TIME\" value=\"&lt;%= @current_time %&gt;\"&gt;\n  &lt;input type=\"hidden\" name=\"PBX_HMAC\" value=\"&lt;%= @signature %&gt;\"&gt;\n  &lt;input type=\"submit\" value=\"Envoyer\"&gt;\n&lt;/form&gt;\n</code></pre>\n\n<p>I have set up the HMAC this way:</p>\n\n<pre><code>def paiement\n    @commande = Commande.find_by(code: params[:id])\n\n    @confirmation_url = ENV['PBX_EFFECTUE'].gsub('CODE_COMMANDE', @commande.code)\n    @annulation_url = ENV['PBX_ANNULE'].gsub('CODE_COMMANDE', @commande.code)\n    @refus_url = ENV['PBX_REFUSE'].gsub('CODE_COMMANDE', @commande.code)\n\n    @current_time = Time.now.strftime('%FT%T%:z')\n\n    msg = [\n      \"PBX_SITE=#{ENV['PBX_SITE']}\",\n      \"PBX_RANG=#{ENV['PBX_RANG']}\",\n      \"PBX_IDENTIFIANT=#{ENV['PBX_IDENTIFIANT']}\",\n      \"PBX_TOTAL=#{@commande.total_price_centimes}\",\n      \"PBX_DEVISE=978\",\n      \"PBX_CMD=#{@commande.code}\",\n      \"PBX_PORTEUR=#{current_user.email}\",\n      \"PBX_REPONDRE_A=#{ENV['PBX_REPONDRE_A']}\",\n      \"PBX_RETOUR=#{ENV['PBX_RETOUR']}\",\n      \"PBX_EFFECTUE=#{@confirmation_url}\",\n      \"PBX_ANNULE=#{@annulation_url}\",\n      \"PBX_REFUSE=#{@refus_url}\",\n      \"PBX_HASH=SHA512\",\n      \"PBX_TIME=#{@current_time}\"\n    ]\n\n    key = ENV[\"CLE_HMAC\"]\n\n    binKey = [key].pack(\"B*\")\n    digest = OpenSSL::Digest.new('sha512')\n    @signature = OpenSSL::HMAC.hexdigest(digest, binKey, msg.join('&amp;')).upcase\n    binding.pry\n  end\n</code></pre>\n\n<p>Here is their example script in PHP:</p>\n\n<pre><code>// On r\u00e9cup\u00e8re la date au format ISO-8601\n$dateTime = date(\"c\");\n\n// On cr\u00e9e la cha\u00eene \u00e0 hacher sans URLencodage\n$msg = \"PBX_SITE=\".$pbx_site.\n\"&amp;PBX_RANG=\".$pbx_rang.\n\"&amp;PBX_IDENTIFIANT=\".$pbx_identifiant.\n\"&amp;PBX_TOTAL=\".$pbx_total.\n\"&amp;PBX_DEVISE=978\".\n\"&amp;PBX_CMD=\".$pbx_cmd.\n\"&amp;PBX_PORTEUR=\".$pbx_porteur.\n\"&amp;PBX_REPONDRE_A=\".$pbx_repondre_a.\n\"&amp;PBX_RETOUR=\".$pbx_retour.\n\"&amp;PBX_EFFECTUE=\".$pbx_effectue.\n\"&amp;PBX_ANNULE=\".$pbx_annule.\n\"&amp;PBX_REFUSE=\".$pbx_refuse.\n\"&amp;PBX_HASH=SHA512\".\n\"&amp;PBX_TIME=\".$dateTime;\n// echo $msg;\n\n// Si la cl\u00e9 est en ASCII, On la transforme en binaire\n$binKey = pack(\"H*\", $keyTest);\n\n// On calcule l\u2019empreinte (\u00e0 renseigner dans le param\u00e8tre PBX_HMAC) gr\u00e2ce \u00e0 la fonction hash_hmac et //\n// la cl\u00e9 binaire\n// On envoi via la variable PBX_HASH l'algorithme de hachage qui a \u00e9t\u00e9 utilis\u00e9 (SHA512 dans ce cas)\n// Pour afficher la liste des algorithmes disponibles sur votre environnement, d\u00e9commentez la ligne //\n// suivante\n// print_r(hash_algos());\n$hmac = strtoupper(hash_hmac('sha512', $msg, $binKey));\n</code></pre>\n\n<p>And PHP form:</p>\n\n<pre><code>&lt;!------------------ ENVOI DES INFORMATIONS A PAYBOX (Formulaire) ------------------&gt;\n&lt;form method=\"POST\" action=\"&lt;?php echo $serveurOK; ?&gt;\"&gt;\n&lt;input type=\"hidden\" name=\"PBX_SITE\" value=\"&lt;?php echo $pbx_site; ?&gt;\"&gt;\n&lt;input type=\"hidden\" name=\"PBX_RANG\" value=\"&lt;?php echo $pbx_rang; ?&gt;\"&gt;\n&lt;input type=\"hidden\" name=\"PBX_IDENTIFIANT\" value=\"&lt;?php echo $pbx_identifiant; ?&gt;\"&gt;\n&lt;input type=\"hidden\" name=\"PBX_TOTAL\" value=\"&lt;?php echo $pbx_total; ?&gt;\"&gt;\n&lt;input type=\"hidden\" name=\"PBX_DEVISE\" value=\"978\"&gt;\n&lt;input type=\"hidden\" name=\"PBX_CMD\" value=\"&lt;?php echo $pbx_cmd; ?&gt;\"&gt;\n&lt;input type=\"hidden\" name=\"PBX_PORTEUR\" value=\"&lt;?php echo $pbx_porteur; ?&gt;\"&gt;\n&lt;input type=\"hidden\" name=\"PBX_REPONDRE_A\" value=\"&lt;?php echo $pbx_repondre_a; ?&gt;\"&gt;\n&lt;input type=\"hidden\" name=\"PBX_RETOUR\" value=\"&lt;?php echo $pbx_retour; ?&gt;\"&gt;\n&lt;input type=\"hidden\" name=\"PBX_EFFECTUE\" value=\"&lt;?php echo $pbx_effectue; ?&gt;\"&gt;\n&lt;input type=\"hidden\" name=\"PBX_ANNULE\" value=\"&lt;?php echo $pbx_annule; ?&gt;\"&gt;\n&lt;input type=\"hidden\" name=\"PBX_REFUSE\" value=\"&lt;?php echo $pbx_refuse; ?&gt;\"&gt;\n&lt;input type=\"hidden\" name=\"PBX_HASH\" value=\"SHA512\"&gt;\n&lt;input type=\"hidden\" name=\"PBX_TIME\" value=\"&lt;?php echo $dateTime; ?&gt;\"&gt;\n&lt;input type=\"hidden\" name=\"PBX_HMAC\" value=\"&lt;?php echo $hmac; ?&gt;\"&gt;\n&lt;input type=\"submit\" value=\"Envoyer\"&gt;\n&lt;/form&gt;\n</code></pre>\n\n<p>There's something i miss i guess but I've tried a thousand times to find where the problem is coming from but i'm running out of ideas (and time).</p>\n\n<p>Is there anyone to help?</p>\n"}, {"tags": ["html", "ruby-on-rails", "ruby", "xml", "nokogiri"], "comments": [{"owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 0, "creation_date": 1517316754, "post_id": 48521594, "comment_id": 84038366, "body": "Can you please add an example of what kind of <i>invalid</i> HTML you want to fix and how it should be fixed?"}, {"owner": {"reputation": 5895, "user_id": 2834978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/05b09a797fd0c59d1627b30fb4cdba01?s=128&d=identicon&r=PG&f=1", "display_name": "Luis Mu&#241;oz", "link": "https://stackoverflow.com/users/2834978/luis-mu%c3%b1oz"}, "edited": false, "score": 0, "creation_date": 1517322534, "post_id": 48521594, "comment_id": 84042186, "body": "Try RECOVER option as shown <a href=\"http://www.nokogiri.org/tutorials/parsing_an_html_xml_document.html#parse_options\" rel=\"nofollow noreferrer\">here</a>."}, {"owner": {"reputation": 271, "user_id": 6929856, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/b914dd226ff7b648e0820d82dcd6a02e?s=128&d=identicon&r=PG&f=1", "display_name": "ankur", "link": "https://stackoverflow.com/users/6929856/ankur"}, "edited": false, "score": 0, "creation_date": 1517378629, "post_id": 48521594, "comment_id": 84066211, "body": "Luis Munoz - It didn&#39;t help"}, {"owner": {"reputation": 271, "user_id": 6929856, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/b914dd226ff7b648e0820d82dcd6a02e?s=128&d=identicon&r=PG&f=1", "display_name": "ankur", "link": "https://stackoverflow.com/users/6929856/ankur"}, "edited": false, "score": 0, "creation_date": 1517378687, "post_id": 48521594, "comment_id": 84066232, "body": "When I tried using Nokogiri::HTML(document) and then It removed the illegal XML tag which I don&#39;t want. I want the XML tag to print as it is"}, {"owner": {"reputation": 271, "user_id": 6929856, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/b914dd226ff7b648e0820d82dcd6a02e?s=128&d=identicon&r=PG&f=1", "display_name": "ankur", "link": "https://stackoverflow.com/users/6929856/ankur"}, "edited": false, "score": 0, "creation_date": 1517384504, "post_id": 48521594, "comment_id": 84068747, "body": "spickermann- I added an example"}], "answers": [{"tags": [], "owner": {"reputation": 1127, "user_id": 436112, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/301b3c350bcbbd99ea65ee2c467d38e9?s=128&d=identicon&r=PG", "display_name": "Sascha Kaestle", "link": "https://stackoverflow.com/users/436112/sascha-kaestle"}, "is_accepted": false, "score": 0, "last_activity_date": 1517409951, "creation_date": 1517409951, "answer_id": 48544895, "question_id": 48521594, "link": "https://stackoverflow.com/questions/48521594/repair-invalid-html-and-xml/48544895#48544895", "title": "Repair Invalid HTML and XML", "body": "<p>you need to configure <code>norecover</code> so Nokogiri does NOT try to fix the issues:</p>\n\n<pre><code>badly_formed = &lt;&lt;-EOXML\n  &lt;/SESSION_CONFIG VERSION=\u201cbgh:3\u201d\n  &lt;METHODS BASEURL=http://abc.hgd.com /servlet/IAMSERVER/&gt;\n  &lt;ADD_USER URL=\u201caddUser/&gt;\nEOXML\n\nbad_doc  = Nokogiri::HTML(badly_formed) { |config| config.norecover }\n\nputs bad_doc\n\n&lt;!DOCTYPE html PUBLIC \"-//W3C//DTD HTML 4.0 Transitional//EN\" \"http://www.w3.org/TR/REC-html40/loose.dtd\"&gt;\n&lt;html&gt;&lt;body&gt;&lt;p&gt;VERSION=\u201cbgh:3\u201d\n  &lt;methods baseurl=\"http://abc.hgd.com\"&gt;&lt;/methods&gt;\n  &lt;add_user url=\"\u201caddUser/\"&gt;\n&lt;/add_user&gt;&lt;/p&gt;&lt;/body&gt;&lt;/html&gt;\n</code></pre>\n"}], "owner": {"reputation": 271, "user_id": 6929856, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/b914dd226ff7b648e0820d82dcd6a02e?s=128&d=identicon&r=PG&f=1", "display_name": "ankur", "link": "https://stackoverflow.com/users/6929856/ankur"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 176, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1517409951, "creation_date": 1517315635, "last_edit_date": 1517388799, "question_id": 48521594, "link": "https://stackoverflow.com/questions/48521594/repair-invalid-html-and-xml", "title": "Repair Invalid HTML and XML", "body": "<p>I have a document which has invalid HTML and XML. I need to parse it in such a way that whenever any invalid HTML or XML it encounters it should fix it rather than treating it as a normal string. Till now I have tried this technique</p>\n\n<pre><code>Nokogiri::HTML(document)\nNokogiri::XML(document)\n</code></pre>\n\n<p>Both are not working in together.</p>\n\n<p>I also refer this <a href=\"http://www.rngtng.com/2011/02/03/pars-invalid-irregular-html-with-unclosed-tag/\" rel=\"nofollow noreferrer\">link</a> but it didn't help me much. Also, I thought for a hack like to replace invalid HTML and XML with regex but my data is too much big so can't apply that hack</p>\n\n<p>I am calling  Nokogiri::HTML(document) so it handling html very well. But the problem is it is skipping the Xml tag which I don't want. I need those tags to print on the browser</p>\n\n<p>Some tags like</p>\n\n<pre><code>&lt;/SESSION_CONFIG VERSION=\u201cbgh:3\u201d\n&lt;METHODS BASEURL=http://abc.hgd.com /servlet/IAMSERVER/&gt;\n&lt;ADD_USER URL=\u201caddUser/&gt;\n</code></pre>\n\n<p>Though I Know some of the tags are not legal but still I need to print on browser</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "postgresql"], "comments": [{"owner": {"reputation": 37141, "user_id": 5315974, "user_type": "registered", "accept_rate": 47, "profile_image": "https://i.stack.imgur.com/MNGHV.png?s=128&g=1", "display_name": "Vao Tsun", "link": "https://stackoverflow.com/users/5315974/vao-tsun"}, "edited": false, "score": 0, "creation_date": 1517314739, "post_id": 48521033, "comment_id": 84037082, "body": "do users use some identifier before filling the survey?.. you can&#39;t guess user and be sure it was him. so you need an identifier. for anonimity you need to have no relation between identifier and real name(photo,email,any real info)"}, {"owner": {"reputation": 1751, "user_id": 3275308, "user_type": "registered", "accept_rate": 69, "profile_image": "https://graph.facebook.com/100001515476964/picture?type=large", "display_name": "Kkulikovskis", "link": "https://stackoverflow.com/users/3275308/kkulikovskis"}, "reply_to_user": {"reputation": 37141, "user_id": 5315974, "user_type": "registered", "accept_rate": 47, "profile_image": "https://i.stack.imgur.com/MNGHV.png?s=128&g=1", "display_name": "Vao Tsun", "link": "https://stackoverflow.com/users/5315974/vao-tsun"}, "edited": false, "score": 0, "creation_date": 1517316373, "post_id": 48521033, "comment_id": 84038118, "body": "There is a relation between user an survey object. But once &quot;Submit&quot; button is pressed, the answers are saved on a separate table with no relation to the user. My guess is that Some kind of smart &quot;hashing&quot; could be used."}, {"owner": {"reputation": 37141, "user_id": 5315974, "user_type": "registered", "accept_rate": 47, "profile_image": "https://i.stack.imgur.com/MNGHV.png?s=128&g=1", "display_name": "Vao Tsun", "link": "https://stackoverflow.com/users/5315974/vao-tsun"}, "edited": false, "score": 0, "creation_date": 1517316466, "post_id": 48521033, "comment_id": 84038172, "body": "you surely can hash anything, but if you destroy relation between hashing and original user - how user can return?.."}, {"owner": {"reputation": 25268, "user_id": 215168, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/212c9d7980fe9aa71739313d483b3782?s=128&d=identicon&r=PG", "display_name": "Abe Voelker", "link": "https://stackoverflow.com/users/215168/abe-voelker"}, "edited": false, "score": 0, "creation_date": 1517316468, "post_id": 48521033, "comment_id": 84038174, "body": "Can the solution ask users to reference a confirmation code from a previous email?"}, {"owner": {"reputation": 1751, "user_id": 3275308, "user_type": "registered", "accept_rate": 69, "profile_image": "https://graph.facebook.com/100001515476964/picture?type=large", "display_name": "Kkulikovskis", "link": "https://stackoverflow.com/users/3275308/kkulikovskis"}, "reply_to_user": {"reputation": 25268, "user_id": 215168, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/212c9d7980fe9aa71739313d483b3782?s=128&d=identicon&r=PG", "display_name": "Abe Voelker", "link": "https://stackoverflow.com/users/215168/abe-voelker"}, "edited": false, "score": 0, "creation_date": 1517316650, "post_id": 48521033, "comment_id": 84038308, "body": "@AbeVoelker No. It should not involve users doing anything."}, {"owner": {"reputation": 25268, "user_id": 215168, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/212c9d7980fe9aa71739313d483b3782?s=128&d=identicon&r=PG", "display_name": "Abe Voelker", "link": "https://stackoverflow.com/users/215168/abe-voelker"}, "edited": false, "score": 0, "creation_date": 1517317936, "post_id": 48521033, "comment_id": 84039130, "body": "Hmm I was thinking generate a UUID, sign it with MessageEncryptor, and email that to the user (and don&#39;t store anything in the DB). If a user could reference a previous email you could create a linked list, but I don&#39;t know how to do it if they can&#39;t reference a previous email w/o compromising user -&gt; survey relation \ud83e\udd14"}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1517321771, "post_id": 48521033, "comment_id": 84041702, "body": "Given the fact that anonymous and traceable is a oxymoron. The only way I can see to provide analytics of this nature overtime is to have some functional mechanism for scoring an answer based on your own criteria scale. You could then score the answer and store it with the user and the question but the answer itself would remain detached. Obviously on a large scale this scoring mechanism is an of itself would be difficult to write and extremely opinionated but if the objective is simply to see the change over time the score would be directly based on a known factor which could work."}, {"owner": {"reputation": 25268, "user_id": 215168, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/212c9d7980fe9aa71739313d483b3782?s=128&d=identicon&r=PG", "display_name": "Abe Voelker", "link": "https://stackoverflow.com/users/215168/abe-voelker"}, "edited": false, "score": 0, "creation_date": 1517331242, "post_id": 48521033, "comment_id": 84048209, "body": "Maybe try asking on <a href=\"https://security.stackexchange.com/\">security.stackexchange.com</a>"}], "answers": [{"comments": [{"owner": {"reputation": 1751, "user_id": 3275308, "user_type": "registered", "accept_rate": 69, "profile_image": "https://graph.facebook.com/100001515476964/picture?type=large", "display_name": "Kkulikovskis", "link": "https://stackoverflow.com/users/3275308/kkulikovskis"}, "edited": false, "score": 0, "creation_date": 1517317226, "post_id": 48522045, "comment_id": 84038642, "body": "Yes, this was my first Idea but the drawback you mentioned is exactly why I can&#39;t use it. Because you can reverse it."}, {"owner": {"reputation": 2464, "user_id": 1035438, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/d802ced0d7c4ac1f7a3d4958a90eb724?s=128&d=identicon&r=PG", "display_name": "Igor T.", "link": "https://stackoverflow.com/users/1035438/igor-t"}, "reply_to_user": {"reputation": 1751, "user_id": 3275308, "user_type": "registered", "accept_rate": 69, "profile_image": "https://graph.facebook.com/100001515476964/picture?type=large", "display_name": "Kkulikovskis", "link": "https://stackoverflow.com/users/3275308/kkulikovskis"}, "edited": false, "score": 0, "creation_date": 1517318116, "post_id": 48522045, "comment_id": 84039238, "body": "It comes down to the fact that until you are in control over the system that manages (and marks) answers you will always be able to build association. Would be nice to have a solution though!"}], "tags": [], "owner": {"reputation": 2464, "user_id": 1035438, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/d802ced0d7c4ac1f7a3d4958a90eb724?s=128&d=identicon&r=PG", "display_name": "Igor T.", "link": "https://stackoverflow.com/users/1035438/igor-t"}, "is_accepted": false, "score": 0, "last_activity_date": 1517318359, "last_edit_date": 1517318359, "creation_date": 1517317054, "answer_id": 48522045, "question_id": 48521033, "link": "https://stackoverflow.com/questions/48521033/tracable-anonymous-recurring-records/48522045#48522045", "title": "Tracable anonymous recurring records", "body": "<p>One of the simple solutions would be feeding a fixed set of user data to a hash function to calculate an identifier for that user, save it into the separate table along with the answers. </p>\n\n<p>This way you'll be able to gather all submissions per user but there will be no relation to the user record.</p>\n\n<p>A drawback is that if you would still want it you can trace a user by calculating all the hashes for your \"users\" table and associating it with the \"answers\" table. Unless you give up control over either \"users\" or \"answers\" entity to another team/business unit etc.</p>\n"}], "owner": {"reputation": 1751, "user_id": 3275308, "user_type": "registered", "accept_rate": 69, "profile_image": "https://graph.facebook.com/100001515476964/picture?type=large", "display_name": "Kkulikovskis", "link": "https://stackoverflow.com/users/3275308/kkulikovskis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 60, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1517318359, "creation_date": 1517313812, "last_edit_date": 1517316722, "question_id": 48521033, "link": "https://stackoverflow.com/questions/48521033/tracable-anonymous-recurring-records", "title": "Tracable anonymous recurring records", "body": "<p>I have an application where users fill out surveys on a regular basis.</p>\n\n<p>Surveys are sent via e-mail and need to be semi-tracable, meaning, that I need to follow what kind of question categories are sent to each user on each survey. Right now after answering the survey, answers are saved in a separate table and any association to a particular user is removed to guarantee anonymity.</p>\n\n<p>What I would like to achieve is a way where it is not possible to map any anwser with a particular user BUT it is possible to get all answers that any one user has submitted. We want to do this for analysis purposes to track how user's answers change over time, but at the same time preserve complete anonymity on a database level.</p>\n\n<p>Users fill out surveys using several devices so private key storing on their device is not an option.</p>\n\n<p>Application is written in Rails with PostgreSQL, but the solution can also involve other languages if it is not possible in ruby.</p>\n"}, {"tags": ["ruby", "encoding", "mime"], "comments": [{"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1517315154, "post_id": 48520781, "comment_id": 84037328, "body": "<i>&quot;why <code>first.gsub(&#39;_&#39;,&#39; &#39;)</code> is required&quot;</i> \u2013 because in &quot;Q&quot; encoding, <code>&#39; &#39;</code> (space) may be represented as <code>&#39;_&#39;</code> (underscore)."}, {"owner": {"reputation": 571, "user_id": 5474567, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/aE0Hv.jpg?s=128&g=1", "display_name": "Yu Watanabe", "link": "https://stackoverflow.com/users/5474567/yu-watanabe"}, "reply_to_user": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1517390147, "post_id": 48520781, "comment_id": 84071835, "body": "I see . <i>rfc 2047 4.2. The &quot;Q&quot; encoding (2)</i> . Thanks."}], "answers": [{"tags": [], "owner": {"reputation": 571, "user_id": 5474567, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/aE0Hv.jpg?s=128&g=1", "display_name": "Yu Watanabe", "link": "https://stackoverflow.com/users/5474567/yu-watanabe"}, "is_accepted": true, "score": 0, "last_activity_date": 1518063123, "creation_date": 1518063123, "answer_id": 48677405, "question_id": 48520781, "link": "https://stackoverflow.com/questions/48520781/difference-with-q-encoding-and-quoted-printable/48677405#48677405", "title": "Difference with Q encoding and Quoted Printable?", "body": "<p>For me by reading RFC 2047 again , I have realized that below approach does not decode underscore properly , in cases where underscore is encoded as <em>=5F</em>.</p>\n\n<pre><code>decoded = m[3].unpack(\"M\").first.gsub('_',' ')\n</code></pre>\n\n<p>Instead, as it is described in below sentence of <a href=\"https://www.ietf.org/rfc/rfc2047.txt\" rel=\"nofollow noreferrer\">rfc2047</a>, I have substituted literal underscore back to <em>=20</em> first , then unpack it.</p>\n\n<blockquote>\n  <p>Note that the \"_\" always represents hexadecimal 20, even if the SPACE\n  character occupies a different code position in the character set in\n  use.</p>\n</blockquote>\n\n<p>I have coded as below.</p>\n\n<pre><code>decoded = m[3].gsub('_', '=20').unpack('M').first()\n</code></pre>\n"}], "owner": {"reputation": 571, "user_id": 5474567, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/aE0Hv.jpg?s=128&g=1", "display_name": "Yu Watanabe", "link": "https://stackoverflow.com/users/5474567/yu-watanabe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 482, "favorite_count": 1, "accepted_answer_id": 48677405, "answer_count": 1, "score": 1, "last_activity_date": 1518063123, "creation_date": 1517313060, "last_edit_date": 1517313596, "question_id": 48520781, "link": "https://stackoverflow.com/questions/48520781/difference-with-q-encoding-and-quoted-printable", "title": "Difference with Q encoding and Quoted Printable?", "body": "<p>My apology if I am asking a beginners question.</p>\n\n<p>May I ask what is the difference with <em>The Q encoding</em> in <a href=\"https://www.ietf.org/rfc/rfc2047.txt\" rel=\"nofollow noreferrer\">rfc2047 </a>and <em>Quoted-Printable Content-Transfer-Encoding</em> <a href=\"https://tools.ietf.org/html/rfc2045#section-6.7\" rel=\"nofollow noreferrer\">rfc2045</a>? </p>\n\n<blockquote>\n  <p>The \"Q\" encoding is similar to the \"Quoted-Printable\" content-<br>\n  transfer-encoding defined in RFC 2045.</p>\n</blockquote>\n\n<p>I am trying to implement decode logic using ruby's unpack. I have read below page and trying to understand why <strong>first.gsub('_',' ')</strong> is required for <em>Q encoding</em>.</p>\n\n<p><a href=\"https://stackoverflow.com/questions/3473952/is-there-a-way-to-decode-q-encoded-strings-in-ruby/8363256\">Is there a way to decode q-encoded strings in Ruby?</a></p>\n"}, {"tags": ["ruby-on-rails", "ruby", "elasticsearch", "elasticsearch-model"], "answers": [{"comments": [{"owner": {"reputation": 10377, "user_id": 2832282, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/ZJ4WG.jpg?s=128&g=1", "display_name": "Cyril Duchon-Doris", "link": "https://stackoverflow.com/users/2832282/cyril-duchon-doris"}, "edited": false, "score": 0, "creation_date": 1522076390, "post_id": 48527848, "comment_id": 85992845, "body": "@ngw did this translate to ruby by adding <code>indexes :name, type: &#39;text&#39;, fielddate: true</code> ? Strangely I seem to run into the error only in my CI not in local environment :s EDIT: no this causes crashes, where do you add the <code>fielddata</code> in ruby ?"}], "tags": [], "owner": {"reputation": 937, "user_id": 7946535, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/62512bd71281c58e63032bc2197bcb39?s=128&d=identicon&r=PG&f=1", "display_name": "gaurav9620", "link": "https://stackoverflow.com/users/7946535/gaurav9620"}, "is_accepted": true, "score": 1, "last_activity_date": 1517335601, "creation_date": 1517335601, "answer_id": 48527848, "question_id": 48519920, "link": "https://stackoverflow.com/questions/48519920/dont-know-how-to-sort-elasticsearch-model-results/48527848#48527848", "title": "Don&#39;t know how to sort elasticsearch-model results", "body": "<p>Sure the problem is that the type of name is <strong>text</strong>.\nFrom elastic search 5 you can't sort on an analyzed field by default</p>\n\n<p>Sorting can be either done on fields with field_data or doc_values enabled -> the data structure elasticsearch uses for sorting and aggregation.</p>\n\n<ul>\n<li>Doc_values can't be enabled on analyzed string fields.</li>\n<li>And field_data is by default disabled on analyzed string fields.</li>\n</ul>\n\n<p>You can do two things </p>\n\n<ul>\n<li>either change the mapping of name to keyword->which would be non_analyzed and doc_values would be enabled on it then.</li>\n<li>Or you can enable field_data on field <strong>name</strong> by using <strong>\"fielddata\": true</strong>\nHere are links reffering this</li>\n</ul>\n\n<p><a href=\"https://www.elastic.co/guide/en/elasticsearch/reference/current/fielddata.html\" rel=\"nofollow noreferrer\">https://www.elastic.co/guide/en/elasticsearch/reference/current/fielddata.html</a></p>\n\n<p><a href=\"https://www.elastic.co/guide/en/elasticsearch/reference/current/doc-values.html\" rel=\"nofollow noreferrer\">https://www.elastic.co/guide/en/elasticsearch/reference/current/doc-values.html</a></p>\n"}], "owner": {"reputation": 1100, "user_id": 1584736, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/7b8c4392528b20b47726142f7a20c7cd?s=128&d=identicon&r=PG", "display_name": "ngw", "link": "https://stackoverflow.com/users/1584736/ngw"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 565, "favorite_count": 0, "accepted_answer_id": 48527848, "answer_count": 1, "score": 0, "last_activity_date": 1517335601, "creation_date": 1517310489, "question_id": 48519920, "link": "https://stackoverflow.com/questions/48519920/dont-know-how-to-sort-elasticsearch-model-results", "title": "Don&#39;t know how to sort elasticsearch-model results", "body": "<p>I'm using elasticsearch-model on my RoR application to perform a search and have the results sorted.\nI can perform the query and have back unsorted results, but when I add sort everything breaks with:</p>\n\n<pre><code>Elasticsearch::Transport::Transport::Errors::BadRequest: [400] {\"error\":{\"root_cause\":[{\"type\":\"illegal_argument_exception\",\"reason\":\"Fielddata is disabled on text fields by default. Set fielddata=true on [name] in order to load fielddata in memory by uninverting the inverted index. Note that this can however use significant memory. Alternatively use a keyword field instead.\"}],\"type\":\"search_phase_execution_exception\",\"reason\":\"all shards failed\",\"phase\":\"query\",\"grouped\":true,\"failed_shards\":[{\"shard\":0,\"index\":\"profiles\",\"node\":\"mad6gavaR3yTFabsF9m0rg\",\"reason\":{\"type\":\"illegal_argument_exception\",\"reason\":\"Fielddata is disabled on text fields by default. Set fielddata=true on [name] in order to load fielddata in memory by uninverting the inverted index. Note that this can however use significant memory. Alternatively use a keyword field instead.\"}}]},\"status\":400}\nfrom /Users/ngw/.rvm/gems/ruby-2.2.2@utelier/gems/elasticsearch-transport-5.0.4/lib/elasticsearch/transport/transport/base.rb:202:in `__raise_transport_error'\n</code></pre>\n\n<p>which apparently is telling me that the way I configured the indexes is wrong.\nHere is what I'm indexing</p>\n\n<pre><code>def as_indexed_json(options={})\n  {\n    profile_type:     profile_type,\n    name:             name,\n    specialisation:   specialisation,\n    description:      description,\n    tags:             tags,\n    minimum_order:    minimum_order,\n    company_city:     company_city,\n    company_address:  company_address,\n    continent_id:     country.try(:continent).try(:id),\n    country_id:       country.try(:id),\n    industry:         industry.try(:id)\n  }\nend\n</code></pre>\n\n<p>A query can use any of these fields, but not :name, which is only used for sorting purposes.\nThe configuration of my index is very simple:</p>\n\n<pre><code>settings index: { number_of_shards: 1 } do\n  mapping dynamic: false do\n    indexes :name, type: 'text'\n    indexes :description, analyzer: 'english'\n  end\nend\n</code></pre>\n\n<p>I'm pretty sure my indexes are setup wrong, but after searching for some time inside elasticsearch-model tests I can't find anything relevant.\nCan someone help me figure this out? Thanks in advance.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "database", "model"], "answers": [{"comments": [{"owner": {"reputation": 361, "user_id": 9274894, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e2bb3248694aa29f31e2d0d0db3e474e?s=128&d=identicon&r=PG&f=1", "display_name": "C. Ball", "link": "https://stackoverflow.com/users/9274894/c-ball"}, "edited": false, "score": 0, "creation_date": 1517340784, "post_id": 48519854, "comment_id": 84053537, "body": "Thanks for taking the time to answer my question. Can I ask what &quot;xyz&quot; and &quot;abc&quot; are supposed to represent?  The answers from Himanshu and Bartosz place :person_a/:person_b after the &quot;belongs_to&quot; tags, whereas you&#39;ve put those values (or string versions of them) in a &quot;foreign_key&quot; tag instead. What are those things you&#39;re putting in &quot;belongs_to&quot; ?"}, {"owner": {"reputation": 61, "user_id": 8205478, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/44fe08c4d0ec0cb5755e0520d4bcf6f6?s=128&d=identicon&r=PG&f=1", "display_name": "DevMasterAryan", "link": "https://stackoverflow.com/users/8205478/devmasteraryan"}, "reply_to_user": {"reputation": 361, "user_id": 9274894, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e2bb3248694aa29f31e2d0d0db3e474e?s=128&d=identicon&r=PG&f=1", "display_name": "C. Ball", "link": "https://stackoverflow.com/users/9274894/c-ball"}, "edited": false, "score": 0, "creation_date": 1517371684, "post_id": 48519854, "comment_id": 84064023, "body": "You can replace &quot;xyz&quot; and &quot;abc&quot; by name through which you want to access associated record. Let&#39;s say replace &quot;xyz&quot; to &quot;sender&quot; then you can access person like  (Relationship.first.sender  where you have foreign key person_a_id in relationships table.)"}], "tags": [], "owner": {"reputation": 61, "user_id": 8205478, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/44fe08c4d0ec0cb5755e0520d4bcf6f6?s=128&d=identicon&r=PG&f=1", "display_name": "DevMasterAryan", "link": "https://stackoverflow.com/users/8205478/devmasteraryan"}, "is_accepted": false, "score": 0, "last_activity_date": 1517310254, "creation_date": 1517310254, "answer_id": 48519854, "question_id": 48519368, "link": "https://stackoverflow.com/questions/48519368/how-can-i-use-two-records-from-the-same-rails-model-as-foreign-keys-in-a-differe/48519854#48519854", "title": "How can I use two records from the same Rails model as foreign keys in a different Rails model?", "body": "<p>You can do like this\nIn relationship model write</p>\n\n<pre><code>belongs_to : xyz, class_name: \"Person\", foreign_key: \"person_a\"\nbelongs_to : abc, class_name: \"Person\", foreign_key: \"person_b\"\n</code></pre>\n\n<p>In Person model write</p>\n\n<pre><code>has_many :relationships, dependent: :destroy\n</code></pre>\n\n<p>hope it will help</p>\n"}, {"comments": [{"owner": {"reputation": 361, "user_id": 9274894, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e2bb3248694aa29f31e2d0d0db3e474e?s=128&d=identicon&r=PG&f=1", "display_name": "C. Ball", "link": "https://stackoverflow.com/users/9274894/c-ball"}, "edited": false, "score": 0, "creation_date": 1517344180, "post_id": 48519927, "comment_id": 84055283, "body": "Himanshu do you think I&#39;d be better off switching from this to the updated solution described by Bartosz below?  He and another user have noticed a problem with this solution.  I&#39;m still using this solution and it seems to be working, but I don&#39;t know if it&#39;s safe for me to continue using it or if I might run into a problem later on because of the issue they describe."}], "tags": [], "owner": {"reputation": 99, "user_id": 6233643, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-eMQfIRF6hTQ/AAAAAAAAAAI/AAAAAAAAABw/ZxGwfBEqypg/photo.jpg?sz=128", "display_name": "Himanshu Tiwari", "link": "https://stackoverflow.com/users/6233643/himanshu-tiwari"}, "is_accepted": false, "score": 3, "last_activity_date": 1517311103, "last_edit_date": 1517311103, "creation_date": 1517310510, "answer_id": 48519927, "question_id": 48519368, "link": "https://stackoverflow.com/questions/48519368/how-can-i-use-two-records-from-the-same-rails-model-as-foreign-keys-in-a-differe/48519927#48519927", "title": "How can I use two records from the same Rails model as foreign keys in a different Rails model?", "body": "<p>You have defined you migration correctly just add the following in your model to define the relationship between the model.</p>\n\n<pre><code>    class Person &lt; ApplicationRecord::Base\n      has_many :relationships, dependent: :destroy\n    end\n\n    class Relationship &lt; ApplicationRecord::Base\n      belongs_to :person_a, :class_name =&gt; 'Person'\n      belongs_to :person_b, :class_name =&gt; 'Person'\n    end\n</code></pre>\n\n<p>This allows you to access the Person that a Relationship belongs to like this:</p>\n\n<pre><code>@relationship.person_a #user assigned as the first person.\n@relationship.person_b #user assigned as the second person.\n</code></pre>\n\n<p>Hope this works.</p>\n"}, {"tags": [], "owner": {"reputation": 710, "user_id": 3685411, "user_type": "registered", "accept_rate": 82, "profile_image": "https://graph.facebook.com/651824110/picture?type=large", "display_name": "Snoobie", "link": "https://stackoverflow.com/users/3685411/snoobie"}, "is_accepted": false, "score": 1, "last_activity_date": 1517310750, "creation_date": 1517310750, "answer_id": 48520008, "question_id": 48519368, "link": "https://stackoverflow.com/questions/48519368/how-can-i-use-two-records-from-the-same-rails-model-as-foreign-keys-in-a-differe/48520008#48520008", "title": "How can I use two records from the same Rails model as foreign keys in a different Rails model?", "body": "<p>I had to do the same for a chat module, this is an example to how you can do it:</p>\n\n<pre><code>class Conversations &lt; ApplicationRecord\n  belongs_to :sender, foreign_key: :sender_id, class_name: 'User'\n  belongs_to :recipient, foreign_key: :recipient_id, class_name: 'User'\nend\n\nclass User &lt; ApplicationRecord\n  ...\n  has_many :conversations\n  has_many :senders, through: :conversations, dependent: :destroy\n  has_many :recipients, through: :conversations, dependent: :destroy\n  ...\nend\n</code></pre>\n\n<p>More explanations at <a href=\"http://nithinbekal.com/posts/complex-has-many-through/\" rel=\"nofollow noreferrer\">complex-has-many-through</a></p>\n\n<p>Hope it helps,</p>\n"}, {"comments": [{"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1517323112, "post_id": 48520429, "comment_id": 84042623, "body": "And how exactly do you expect <code>Person#relationships</code> to function in this case? The query generated will be <code>SELECT * FROM relationships WHERE person_id = X</code> but person_id is not part of the relationships table"}, {"owner": {"reputation": 1197, "user_id": 400743, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1a0d5c51291898c92154ba4ac1c56cd6?s=128&d=identicon&r=PG", "display_name": "Bartosz Pietraszko", "link": "https://stackoverflow.com/users/400743/bartosz-pietraszko"}, "reply_to_user": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1517342207, "post_id": 48520429, "comment_id": 84054334, "body": "@engineersmnky thanks for pointing that out, my facepalm was crisp and loud. Answer edited."}, {"owner": {"reputation": 361, "user_id": 9274894, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e2bb3248694aa29f31e2d0d0db3e474e?s=128&d=identicon&r=PG&f=1", "display_name": "C. Ball", "link": "https://stackoverflow.com/users/9274894/c-ball"}, "edited": false, "score": 0, "creation_date": 1517343751, "post_id": 48520429, "comment_id": 84055096, "body": "@BartoszPietraszko  I&#39;ve still got your original solution implemented and it seems to work in that it forms the associations and allows me to retrieve/display all of the relationships complete with data about the people in them in my relationships#index and relationships#show actions/views. I&#39;m a bit new to Rails and don&#39;t really understand what the problem with that solution was or the stuff you describe as being the better solution. Do you think it would be okay if I just stuck with the first solution as long as it seems to do what I need? Or will there be problems later on?"}, {"owner": {"reputation": 1197, "user_id": 400743, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1a0d5c51291898c92154ba4ac1c56cd6?s=128&d=identicon&r=PG", "display_name": "Bartosz Pietraszko", "link": "https://stackoverflow.com/users/400743/bartosz-pietraszko"}, "edited": false, "score": 0, "creation_date": 1517346422, "post_id": 48520429, "comment_id": 84056342, "body": "It only works in one direction. Try displaying a person in PeopleController if you have one, and you&#39;ll get error when you get to @person.relationships . If you don&#39;t need it to work both ways, then stick to the code that you have - but delete has_many association from Person model, because it won&#39;t work."}, {"owner": {"reputation": 1197, "user_id": 400743, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1a0d5c51291898c92154ba4ac1c56cd6?s=128&d=identicon&r=PG", "display_name": "Bartosz Pietraszko", "link": "https://stackoverflow.com/users/400743/bartosz-pietraszko"}, "edited": false, "score": 0, "creation_date": 1517346915, "post_id": 48520429, "comment_id": 84056613, "body": "In case you need to load @person.relationships: if you are a newcomer to rails and your app isn&#39;t mission-critical, you will be probably better off writing custom methods as I described. Composite primary keys are pretty non-standard stuff, and you&#39;ll learn more working around the problem manually :) thanks for posting a challenging question."}, {"owner": {"reputation": 361, "user_id": 9274894, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e2bb3248694aa29f31e2d0d0db3e474e?s=128&d=identicon&r=PG&f=1", "display_name": "C. Ball", "link": "https://stackoverflow.com/users/9274894/c-ball"}, "edited": false, "score": 0, "creation_date": 1517423985, "post_id": 48520429, "comment_id": 84094405, "body": "Thanks for taking the time to answer it :)"}], "tags": [], "owner": {"reputation": 1197, "user_id": 400743, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1a0d5c51291898c92154ba4ac1c56cd6?s=128&d=identicon&r=PG", "display_name": "Bartosz Pietraszko", "link": "https://stackoverflow.com/users/400743/bartosz-pietraszko"}, "is_accepted": true, "score": 1, "last_activity_date": 1517347981, "last_edit_date": 1517347981, "creation_date": 1517312055, "answer_id": 48520429, "question_id": 48519368, "link": "https://stackoverflow.com/questions/48519368/how-can-i-use-two-records-from-the-same-rails-model-as-foreign-keys-in-a-differe/48520429#48520429", "title": "How can I use two records from the same Rails model as foreign keys in a different Rails model?", "body": "<p>EDIT: Apologies for a rushed and wrong answer.</p>\n\n<p>Initially, I thought that simple <code>has_many/belongs_to</code> association is possible and sufficient.</p>\n\n<pre><code>class Person &lt; ApplicationRecord\n  has_many :relationships #dependent: :destroy\nend\n\nclass Relationship &lt; ApplicationRecord\n  belongs_to :person_a, class_name: \"Person\"\n  belongs_to :person_b, class_name: \"Person\"\n\n  enum status: [:married, :friends, :separated]\nend\n</code></pre>\n\n<p>As @engineersmnky pointed out, <code>has_many</code> association can't work here because there is no <code>person_id</code> column in <code>relationships</code> table. Since we can declare only one custom foreign key in <code>has_many</code> association, it's not possible to declare it here this way. <code>belongs_to</code> will work, but I don't think that's enough.</p>\n\n<p>One way is to skip declaring <code>has_many</code> and stick to custom method for querying relationships:</p>\n\n<pre><code>class Person &lt; ApplicationRecord\n  def relationships\n    Relationship.where(\"person_a_id = ? OR person_b_id = ?\", id, id)\n  end\nend\n</code></pre>\n\n<p>It will give you an <code>ActiveRecord::Relation</code> to work with, containing exactly the records you need. The drawbacks of this solution are numerous - depending on your needs, you will probably need more code for inserting data, starting with a setter method to assign relationships to people...</p>\n\n<p>What could be a real solution, is to have a composite primary key in Relationship model - composed of <code>:person_a_id</code> and <code>:person_b_id</code>. ActiveRecord doesn't support composite primary keys, but <a href=\"https://github.com/composite-primary-keys/composite_primary_keys\" rel=\"nofollow noreferrer\">this gem</a> seems to fill the gap. Apparently it allows to declare such key and use it as a foreign key in a <code>has_many</code> association. The catch is that your person_a/person_b pairs would have to be unique across <code>relationships</code> table.</p>\n"}], "owner": {"reputation": 361, "user_id": 9274894, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e2bb3248694aa29f31e2d0d0db3e474e?s=128&d=identicon&r=PG&f=1", "display_name": "C. Ball", "link": "https://stackoverflow.com/users/9274894/c-ball"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 89, "favorite_count": 0, "accepted_answer_id": 48520429, "answer_count": 4, "score": 0, "last_activity_date": 1517347981, "creation_date": 1517308748, "question_id": 48519368, "link": "https://stackoverflow.com/questions/48519368/how-can-i-use-two-records-from-the-same-rails-model-as-foreign-keys-in-a-differe", "title": "How can I use two records from the same Rails model as foreign keys in a different Rails model?", "body": "<p>I have two models: person.rb and relationship.rb</p>\n\n<p>I need my :relationships table to reference two rows from the :people table as foreign keys.</p>\n\n<p>Here are the migrations for both tables:</p>\n\n<pre><code>class CreatePeople &lt; ActiveRecord::Migration[5.1]\n  def change\n    create_table :people do |t|\n      t.string :first_name\n      t.string :second_name\n      t.integer :age\n      t.string :gender\n      t.timestamps\n    end\n  end\nend\n\nclass CreateRelationships &lt; ActiveRecord::Migration[5.1]\n  def change\n    create_table :relationships do |t|\n      t.references :person_a\n      t.references :person_b\n      t.string :status\n      t.timestamps\n    end\n  end\nend\n</code></pre>\n\n<p>The idea is the :person_a and :person_b fields will both be individual records from the :people table referenced as foreign keys, while the :status field will just be a description of their relationship (\"Married\", \"Friends\", \"Separated\", etc.)</p>\n\n<p>I'm trying to find out:</p>\n\n<p>1) What is the additional code I have to write in the CreateRelationships migration above in order to set :person_a and :person_b up as foreign keys from the :people table?</p>\n\n<p>2) What code do I need to write in the model files (person.rb and relationship.rb) for both tables below to define the relationship structure I'm talking about?</p>\n\n<pre><code>class Person &lt; ApplicationRecord\nend\n\nclass Relationship &lt; ApplicationRecord\nend\n</code></pre>\n\n<p>I've found one other question on here that deals with this issue, but the answers given were conflicting, some incomplete, and others working with older versions of Rails. None of them have worked for me.</p>\n\n<p>I'm using Rails 5.1.4</p>\n"}, {"tags": ["ruby", "api", "selenium", "testing", "qa"], "comments": [{"owner": {"reputation": 18005, "user_id": 2386774, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dea7da142cb7e85d5d5a8576e2625431?s=128&d=identicon&r=PG", "display_name": "JeffC", "link": "https://stackoverflow.com/users/2386774/jeffc"}, "edited": false, "score": 1, "creation_date": 1517324682, "post_id": 48518668, "comment_id": 84043777, "body": "See: <a href=\"https://meta.stackoverflow.com/questions/253069/whats-the-appropriate-new-current-close-reason-for-how-do-i-do-x\">How do I do X?</a> The expectation on SO is that the user asking a question not only does research to answer their own question but also shares that research, code attempts, and results. This demonstrates that you\u2019ve taken the time to try to help yourself, it saves us from reiterating obvious answers, and most of all it helps you get a more specific and relevant answer! See also: <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a>"}, {"owner": {"reputation": 18005, "user_id": 2386774, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dea7da142cb7e85d5d5a8576e2625431?s=128&d=identicon&r=PG", "display_name": "JeffC", "link": "https://stackoverflow.com/users/2386774/jeffc"}, "edited": false, "score": 0, "creation_date": 1517354043, "post_id": 48518668, "comment_id": 84059607, "body": "You are new to the site but rude comments are not acceptable here. I explained what you need to do to meet the basic standard of a good question. You haven&#39;t posted a single line of code or example data or anything other than a question. I&#39;m not sure how we&#39;re supposed to interpret that given your response as anything other than write my code for me."}], "answers": [{"comments": [{"owner": {"reputation": 45, "user_id": 8366368, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fb7e00f18157eb434739dc4d50250d6f?s=128&d=identicon&r=PG&f=1", "display_name": "JackGruber", "link": "https://stackoverflow.com/users/8366368/jackgruber"}, "edited": false, "score": 0, "creation_date": 1517503904, "post_id": 48544951, "comment_id": 84131930, "body": "Thank Sascha, much appreciated. Ill look into it and report back."}], "tags": [], "owner": {"reputation": 1127, "user_id": 436112, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/301b3c350bcbbd99ea65ee2c467d38e9?s=128&d=identicon&r=PG", "display_name": "Sascha Kaestle", "link": "https://stackoverflow.com/users/436112/sascha-kaestle"}, "is_accepted": true, "score": 0, "last_activity_date": 1517410138, "creation_date": 1517410138, "answer_id": 48544951, "question_id": 48518668, "link": "https://stackoverflow.com/questions/48518668/ruby-api-get-and-delete-all-strings-that-match-pattern/48544951#48544951", "title": "RUBY API GET And Delete All Strings That Match Pattern", "body": "<p>For bulk API calls via HTTP, I suggest: <a href=\"https://github.com/typhoeus/typhoeus\" rel=\"nofollow noreferrer\">https://github.com/typhoeus/typhoeus</a>. Make sure you use sensible configurations, or you will exhaust the API endpoint</p>\n"}], "owner": {"reputation": 45, "user_id": 8366368, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fb7e00f18157eb434739dc4d50250d6f?s=128&d=identicon&r=PG&f=1", "display_name": "JackGruber", "link": "https://stackoverflow.com/users/8366368/jackgruber"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 65, "favorite_count": 0, "accepted_answer_id": 48544951, "answer_count": 1, "score": -1, "last_activity_date": 1517410138, "creation_date": 1517306602, "question_id": 48518668, "link": "https://stackoverflow.com/questions/48518668/ruby-api-get-and-delete-all-strings-that-match-pattern", "title": "RUBY API GET And Delete All Strings That Match Pattern", "body": "<p>For the purposes of QA. Im trying to query my own API and delete strings that match a pattern.</p>\n\n<p>During our QA regression tests, a large number of a certain string are created which all match a pattern similar to \"QATest\" followed by a random set of numbers.</p>\n\n<p>Before the test runs again, Id like to get all of those strings through the API and delete them. </p>\n\n<p>Can any one set me on the right path to do this and where I would start.</p>\n\n<p>I can currently GET one. But not all. So I suppose I need to loop the GET request somehow. Put them in all in array and delete all in the array that match the pattern. But there might be better ways to do it.</p>\n\n<p>Anyone have any ideas? I use Ruby and the rest-client gem. But Im open to other gems if they are better.</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "answers": [{"comments": [{"owner": {"reputation": 464, "user_id": 6430382, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/9437919f33eae9a968334de447c6dccd?s=128&d=identicon&r=PG", "display_name": "Robert", "link": "https://stackoverflow.com/users/6430382/robert"}, "reply_to_user": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1517324882, "post_id": 48518490, "comment_id": 84043913, "body": "As you can observe the timestamp, I added my answer directly with the question. Zakhar answered later."}], "tags": [], "owner": {"reputation": 464, "user_id": 6430382, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/9437919f33eae9a968334de447c6dccd?s=128&d=identicon&r=PG", "display_name": "Robert", "link": "https://stackoverflow.com/users/6430382/robert"}, "is_accepted": false, "score": 0, "last_activity_date": 1517306019, "creation_date": 1517306019, "answer_id": 48518490, "question_id": 48518489, "link": "https://stackoverflow.com/questions/48518489/how-to-average-a-column-in-a-join-table/48518490#48518490", "title": "How to average a column in a join table?", "body": "<p>Argument type for value is a <code>string</code>, change that to <code>integer</code></p>\n"}, {"tags": [], "owner": {"reputation": 147, "user_id": 9284149, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ce9eeeb8c9681c99046d95e418cd9110?s=128&d=identicon&r=PG&f=1", "display_name": "Zakhar Antoshchenko", "link": "https://stackoverflow.com/users/9284149/zakhar-antoshchenko"}, "is_accepted": true, "score": 3, "last_activity_date": 1517307511, "creation_date": 1517307511, "answer_id": 48518964, "question_id": 48518489, "link": "https://stackoverflow.com/questions/48518489/how-to-average-a-column-in-a-join-table/48518964#48518964", "title": "How to average a column in a join table?", "body": "<p>It happened because your 'value' field has a 'string' type. If value will use only as integer, you can change column type to integer or other numeric type, dependency by your database. If you wanna work with string, then if this values will be in integer range, your code can be like: \n<code>@item.items_ratings.where(rating_id: 1).average('CAST(value AS INT)')</code></p>\n"}, {"tags": [], "owner": {"reputation": 1551, "user_id": 4380542, "user_type": "registered", "accept_rate": 51, "profile_image": "https://i.stack.imgur.com/nJSw1.jpg?s=128&g=1", "display_name": "Uday kumar das", "link": "https://stackoverflow.com/users/4380542/uday-kumar-das"}, "is_accepted": false, "score": 0, "last_activity_date": 1517308797, "creation_date": 1517308797, "answer_id": 48519382, "question_id": 48518489, "link": "https://stackoverflow.com/questions/48518489/how-to-average-a-column-in-a-join-table/48519382#48519382", "title": "How to average a column in a join table?", "body": "<p>Use this code:</p>\n\n<pre><code>@item.items_ratings.where(rating_id: 1).average('value')\n</code></pre>\n"}], "owner": {"reputation": 464, "user_id": 6430382, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/9437919f33eae9a968334de447c6dccd?s=128&d=identicon&r=PG", "display_name": "Robert", "link": "https://stackoverflow.com/users/6430382/robert"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 523, "favorite_count": 0, "accepted_answer_id": 48518964, "answer_count": 3, "score": 1, "last_activity_date": 1517308797, "creation_date": 1517306019, "last_edit_date": 1517306560, "question_id": 48518489, "link": "https://stackoverflow.com/questions/48518489/how-to-average-a-column-in-a-join-table", "title": "How to average a column in a join table?", "body": "<p>For each rating_id from items_ratings from an item, get the</p>\n\n<ol>\n<li>name </li>\n<li>average of values</li>\n</ol>\n\n<p>My table setup:</p>\n\n<p>item: <code>id</code>  <code>url</code> <code>name</code></p>\n\n<p>rating: <code>id</code>  <code>name</code>            </p>\n\n<p>items_rating: <code>id</code>  <code>item_id</code> <code>rating_id</code>   <code>value</code></p>\n\n<p>I'm started to solve it with:</p>\n\n<pre><code>(Rating.first.id..Rating.last.id).each do |rating_id|\n   @item.items_ratings ... \nend\n</code></pre>\n\n<p>but now I seem stuck as <code>where(rating_id: rating_id)</code> and <code>average(:value)</code> don't work together from here.</p>\n\n<p>input:</p>\n\n<p><code>@item.items_ratings.where(rating_id: 1)</code></p>\n\n<p>output:</p>\n\n<pre><code>#&lt;ActiveRecord::AssociationRelation\n[#&lt;ItemsRating item_id: 5, rating_id: 1, user_id: 1, value: \"3\"&gt;, #&lt;ItemsRating item_id: 5, rating_id: 1, user_id: 1, value: \"3\"&gt;, \n#&lt;ItemsRating item_id: 5, rating_id: 1, user_id: 1, value: \"3\"&gt;, #&lt;ItemsRating item_id: 5, rating_id: 1, user_id: 1, value: \"4\"&gt;, #&lt;ItemsRating item_id: 5, rating_id: 1, user_id: 1, value: \"5\"&gt;]&gt;\n</code></pre>\n\n<p>input:</p>\n\n<p><code>@item.items_ratings.where(rating_id: 1).average(:value)</code></p>\n\n<p>output:</p>\n\n<pre><code>ActiveRecord::StatementInvalid: PG::UndefinedFunction: ERROR:  function avg(character varying) does not exist\nLINE 1: SELECT AVG(\"items_ratings\".\"value\") FROM \"items_ratings\" WHE...\n               ^\nHINT:  No function matches the given name and argument types. You might need to add explicit type casts.\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-4", "rubygems", "clone"], "comments": [{"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 1, "creation_date": 1517305558, "post_id": 48518150, "comment_id": 84031165, "body": "Please show us some code. What have you tried so far? What error are you getting? Unless I&#39;m missing something, I think you can just use <code>new_record = old_record.dup</code>."}, {"owner": {"reputation": 1713, "user_id": 2545197, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/zIDXo.jpg?s=128&g=1", "display_name": "Abhinay", "link": "https://stackoverflow.com/users/2545197/abhinay"}, "edited": false, "score": 0, "creation_date": 1517305907, "post_id": 48518150, "comment_id": 84031409, "body": "welcome to stackoverflow, would recommend you to go through this article: <a href=\"https://stackoverflow.com/help/how-to-ask\">stackoverflow.com/help/how-to-ask</a>"}, {"owner": {"reputation": 11, "user_id": 6706071, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/d743b1f13259470e262a17307f494781?s=128&d=identicon&r=PG&f=1", "display_name": "suman", "link": "https://stackoverflow.com/users/6706071/suman"}, "reply_to_user": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1517306350, "post_id": 48518150, "comment_id": 84031691, "body": "@TomLord check again i have edited the post"}, {"owner": {"reputation": 41846, "user_id": 926143, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/3396173c3d22988be1a0732d184902aa?s=128&d=identicon&r=PG", "display_name": "7stud", "link": "https://stackoverflow.com/users/926143/7stud"}, "edited": false, "score": 0, "creation_date": 1517307656, "post_id": 48518150, "comment_id": 84032527, "body": "<i>but how to do deep_copy in ruby on rails</i> -- Use a gem: <a href=\"https://everydayrails.com/2015/07/29/deep-cloning.html\" rel=\"nofollow noreferrer\">everydayrails.com/2015/07/29/deep-cloning.html</a> <i>is that right approach to go for deep_clone instead of clone</i> -- If you clone, then changes in one client&#39;s recommendation will appear in another client&#39;s recommendation."}], "answers": [{"tags": [], "owner": {"reputation": 531, "user_id": 4957673, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-wayGJ6nTDdU/AAAAAAAAAAI/AAAAAAAAlAc/A2hj4PoiO1o/photo.jpg?sz=128", "display_name": "Sage Ross", "link": "https://stackoverflow.com/users/4957673/sage-ross"}, "is_accepted": false, "score": 0, "last_activity_date": 1517359920, "creation_date": 1517359920, "answer_id": 48532829, "question_id": 48518150, "link": "https://stackoverflow.com/questions/48518150/deep-clone-in-ruby-on-rails-instead-of-clone-shallow-copy/48532829#48532829", "title": "deep_clone in ruby on rails instead of clone ( shallow copy)", "body": "<p>You probably want to use the <code>deep_cloneable</code> gem, <a href=\"https://github.com/moiristo/deep_cloneable\" rel=\"nofollow noreferrer\">https://github.com/moiristo/deep_cloneable</a></p>\n\n<p>It works well for creating related sets of ActiveRecord objects, and you can specify which relations you do and do not want to clone, with smart behavior around saving them. The only gotchas I've found with it related to the order in which the cloned records get created, which may be different from the original order. So if you've got any subtle bugs around <code>order</code> attributes, deep_clone can be tricky.</p>\n"}], "owner": {"reputation": 11, "user_id": 6706071, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/d743b1f13259470e262a17307f494781?s=128&d=identicon&r=PG&f=1", "display_name": "suman", "link": "https://stackoverflow.com/users/6706071/suman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1630, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1517359920, "creation_date": 1517304995, "last_edit_date": 1517306327, "question_id": 48518150, "link": "https://stackoverflow.com/questions/48518150/deep-clone-in-ruby-on-rails-instead-of-clone-shallow-copy", "title": "deep_clone in ruby on rails instead of clone ( shallow copy)", "body": "<p>I have a recommended item for one particular client and i have to duplicate that particular recommended item entry for other clients too,So I was thinking to deep_clone of that item to that other clients , so that when that item entry is deleted from one client it doesn't get removed from other clients too (basic deep copy concept)</p>\n\n<p>but how to do deep_copy in ruby on rails and is that right approach to go for deep_clone instead of clone ?</p>\n\n<p>here is my code</p>\n\n<pre><code>@item = CuratedItem.find(params[:data_curated_id])   \n@duplicate =Marshal.load( Marshal.dump(@item) )\n</code></pre>\n\n<p>this marshalling does the same thing as clone, it gives the same copied parameters, so what the difference, is clone does a deep copy too ?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "associations", "ruby-on-rails-5", "model-associations"], "comments": [{"owner": {"reputation": 48413, "user_id": 1279683, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1veuT.jpg?s=128&g=1", "display_name": "Marek Lipka", "link": "https://stackoverflow.com/users/1279683/marek-lipka"}, "edited": false, "score": 2, "creation_date": 1517299239, "post_id": 48516446, "comment_id": 84027377, "body": "How about something like <code>user1.professions &lt;&lt; Profession.find_or_create_by(name: &#39;Dev&#39;)</code>?"}, {"owner": {"reputation": 1280, "user_id": 3554338, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/c022fa34c942d95cc255e80cd73f9753?s=128&d=identicon&r=PG&f=1", "display_name": "Aparichith", "link": "https://stackoverflow.com/users/3554338/aparichith"}, "reply_to_user": {"reputation": 48413, "user_id": 1279683, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1veuT.jpg?s=128&g=1", "display_name": "Marek Lipka", "link": "https://stackoverflow.com/users/1279683/marek-lipka"}, "edited": false, "score": 0, "creation_date": 1517299692, "post_id": 48516446, "comment_id": 84027619, "body": "@MarekLipka Thanks. That does the trick."}], "answers": [{"tags": [], "owner": {"reputation": 2386, "user_id": 2933305, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/223ba397b1fef4a7bec7bfc59ca74f11?s=128&d=identicon&r=PG", "display_name": "maicher", "link": "https://stackoverflow.com/users/2933305/maicher"}, "is_accepted": true, "score": 2, "last_activity_date": 1517729747, "last_edit_date": 1517729747, "creation_date": 1517299507, "answer_id": 48516620, "question_id": 48516446, "link": "https://stackoverflow.com/questions/48516446/rails-association-habtm/48516620#48516620", "title": "Rails association HABTM", "body": "<p>I would suggest splitting it into two steps.</p>\n\n<p>At first find or create profession:</p>\n\n<pre><code>profession = Profession.find_or_create_by(name: \"Dev\")\n</code></pre>\n\n<p>Then assign the profession to user:</p>\n\n<pre><code>user1.professions &lt;&lt; profession\nuser2.professions &lt;&lt; profession\n</code></pre>\n\n<p>I would also recommend to set a unique index on <code>professions</code> table's <code>name</code> column. It will guarantee the uniqueness.</p>\n"}, {"tags": [], "owner": {"reputation": 51, "user_id": 2107463, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mw2ml.jpg?s=128&g=1", "display_name": "Hazhir Derakhshi", "link": "https://stackoverflow.com/users/2107463/hazhir-derakhshi"}, "is_accepted": false, "score": 1, "last_activity_date": 1517299581, "creation_date": 1517299581, "answer_id": 48516643, "question_id": 48516446, "link": "https://stackoverflow.com/questions/48516446/rails-association-habtm/48516643#48516643", "title": "Rails association HABTM", "body": "<p>Try to create association as below:</p>\n\n<pre><code>profession = Profession.find_or_create_by(name: \"Dev\")\nuser1.professions &lt;&lt; profession\n\nprofession = Profession.find_or_create_by(name: \"Dev\")\nuser2.professions &lt;&lt; profession\n</code></pre>\n"}], "owner": {"reputation": 1280, "user_id": 3554338, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/c022fa34c942d95cc255e80cd73f9753?s=128&d=identicon&r=PG&f=1", "display_name": "Aparichith", "link": "https://stackoverflow.com/users/3554338/aparichith"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 85, "favorite_count": 0, "accepted_answer_id": 48516620, "answer_count": 2, "score": 2, "last_activity_date": 1517729747, "creation_date": 1517298758, "question_id": 48516446, "link": "https://stackoverflow.com/questions/48516446/rails-association-habtm", "title": "Rails association HABTM", "body": "<p>I need some help in creating association for my new rails application. </p>\n\n<p>I have two models <code>User</code> and <code>Profession</code>. A user might have many professions and profession might belongs to many users.</p>\n\n<p>I can do <code>HABTM</code> association in both the models.</p>\n\n<p>User <code>has_and_belongs_to_many :professions</code></p>\n\n<p>Profession <code>has_and_belongs_to_many :users</code></p>\n\n<p>I want professions table should hold only unique profession name and assign them to many users. But if I try to create professions for users like bellow </p>\n\n<pre><code>user1.professions.create(name: \"Dev\")\n\nuser2.professions.create(name: \"Dev\")\n</code></pre>\n\n<p>Both profession \"Dev\" will get saved in professions table. </p>\n\n<p>How to save unique profession name in Profession model and can assign them to many users?</p>\n"}, {"tags": ["ruby", "sinatra"], "comments": [{"owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 0, "creation_date": 1517299680, "post_id": 48516390, "comment_id": 84027610, "body": "in the future, consider using <code>tree</code> to get a text version of your directory structure, instead of taking a screenshot"}, {"owner": {"reputation": 8818, "user_id": 2714301, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/23c7ba1f14e71e14f65b7b95516b0f19?s=128&d=identicon&r=PG", "display_name": "Jwan622", "link": "https://stackoverflow.com/users/2714301/jwan622"}, "reply_to_user": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 0, "creation_date": 1517327849, "post_id": 48516390, "comment_id": 84046017, "body": "what is &#39;tree&#39;? How do I use it? @maxpleaner"}, {"owner": {"reputation": 41846, "user_id": 926143, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/3396173c3d22988be1a0732d184902aa?s=128&d=identicon&r=PG", "display_name": "7stud", "link": "https://stackoverflow.com/users/926143/7stud"}, "edited": false, "score": 1, "creation_date": 1517329172, "post_id": 48516390, "comment_id": 84046933, "body": "<code>tree</code> is a unix command.  See <a href=\"http://mama.indstate.edu/users/ice/tree/\" rel=\"nofollow noreferrer\">the tree website</a> to see what the output looks like and install tree. Or if you have homebrew installed, it&#39;s as simple as: <code>brew install tree</code>."}, {"owner": {"reputation": 8818, "user_id": 2714301, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/23c7ba1f14e71e14f65b7b95516b0f19?s=128&d=identicon&r=PG", "display_name": "Jwan622", "link": "https://stackoverflow.com/users/2714301/jwan622"}, "edited": false, "score": 0, "creation_date": 1517330027, "post_id": 48516390, "comment_id": 84047446, "body": "I edited my post, thanks for the rec!"}, {"owner": {"reputation": 41846, "user_id": 926143, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/3396173c3d22988be1a0732d184902aa?s=128&d=identicon&r=PG", "display_name": "7stud", "link": "https://stackoverflow.com/users/926143/7stud"}, "edited": false, "score": 0, "creation_date": 1517334911, "post_id": 48516390, "comment_id": 84050241, "body": "Try:  <code>tree `pwd` </code>  -- That will get the top directory to print.  Or  do <code>cd ..</code> then <code>tree app</code>"}], "answers": [{"tags": [], "owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "is_accepted": false, "score": 2, "last_activity_date": 1517299804, "last_edit_date": 1517299804, "creation_date": 1517299457, "answer_id": 48516610, "question_id": 48516390, "link": "https://stackoverflow.com/questions/48516390/easier-way-to-require-spec-files-in-sinatra/48516610#48516610", "title": "Easier way to require spec files in Sinatra", "body": "<p>The file not found is because you use <code>\"lib/*.rb\"</code> and not <code>./\"lib/*.rb\"</code>.</p>\n\n<p>To ensure the dependencies are loaded in the correct order, you can do this:</p>\n\n<ol>\n<li><p>move HouseDistributor to <code>lib/distributor/house_distributor.rb</code></p></li>\n<li><p>Require files like so:</p>\n\n<pre><code>Dir['./lib/**/*.rb']\n.sort_by { |path| path.count(\"/\") }\n.each { |path| require path }\n</code></pre>\n\n<p>this uses <code>**/*.rb</code> to do a recursive search and will sort the files by the count of \"/\" (their depth) before requiring</p></li>\n</ol>\n\n<p>Just a note of caution, if you are doing a recursive require, keep in mind that you actually do want to require all those files. For example if you are are using ActiveRecord and have a schema.rb file, you probably don't want to require that. </p>\n"}, {"comments": [{"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1517323841, "post_id": 48517827, "comment_id": 84043166, "body": "While far more confusing for a novice user it is generally more idiomatic to alter <code>$LOAD_PATH</code> more dynamically. For example: <code>$LOAD_PATH.unshift(File.expand_path(File.dirname(__FILE__)))</code> or as many gems do <code>$:.push File.expand_path(&quot;..&#47;lib&quot;, __FILE__)</code>"}, {"owner": {"reputation": 8818, "user_id": 2714301, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/23c7ba1f14e71e14f65b7b95516b0f19?s=128&d=identicon&r=PG", "display_name": "Jwan622", "link": "https://stackoverflow.com/users/2714301/jwan622"}, "edited": false, "score": 0, "creation_date": 1517325567, "post_id": 48517827, "comment_id": 84044365, "body": "I think my issue is that Sinatra looks for files in the load path which includes this: <code>&quot;&#47;Users&#47;jwan&#47;Desktop&#47;programming&#47;interview_questions&#47;gemini&#47;&zwnj;&#8203;jobcoin_mixer&#47;lib&quot;</code> so it can&#39;t find a file named `lib/something.rb&#39;. How do I get rid of that extra lib?"}, {"owner": {"reputation": 41846, "user_id": 926143, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/3396173c3d22988be1a0732d184902aa?s=128&d=identicon&r=PG", "display_name": "7stud", "link": "https://stackoverflow.com/users/926143/7stud"}, "reply_to_user": {"reputation": 8818, "user_id": 2714301, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/23c7ba1f14e71e14f65b7b95516b0f19?s=128&d=identicon&r=PG", "display_name": "Jwan622", "link": "https://stackoverflow.com/users/2714301/jwan622"}, "edited": false, "score": 1, "creation_date": 1517328390, "post_id": 48517827, "comment_id": 84046404, "body": "@Jwan622,  See bottom of my answer."}, {"owner": {"reputation": 41846, "user_id": 926143, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/3396173c3d22988be1a0732d184902aa?s=128&d=identicon&r=PG", "display_name": "7stud", "link": "https://stackoverflow.com/users/926143/7stud"}, "reply_to_user": {"reputation": 8818, "user_id": 2714301, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/23c7ba1f14e71e14f65b7b95516b0f19?s=128&d=identicon&r=PG", "display_name": "Jwan622", "link": "https://stackoverflow.com/users/2714301/jwan622"}, "edited": false, "score": 0, "creation_date": 1517332313, "post_id": 48517827, "comment_id": 84048841, "body": "@Jwan622, How is that directory getting in $LOAD_PATH?"}, {"owner": {"reputation": 8818, "user_id": 2714301, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/23c7ba1f14e71e14f65b7b95516b0f19?s=128&d=identicon&r=PG", "display_name": "Jwan622", "link": "https://stackoverflow.com/users/2714301/jwan622"}, "edited": false, "score": 0, "creation_date": 1517338970, "post_id": 48517827, "comment_id": 84052513, "body": "I forget now, but I fixed it. At some point I was manually adding the <code>jobcoin_mixer&#47;lib</code> path into the LOAD_PATH, but now I am just adding <code>jobcoin_mixer</code> lib to the LOAD_PATH"}, {"owner": {"reputation": 41846, "user_id": 926143, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/3396173c3d22988be1a0732d184902aa?s=128&d=identicon&r=PG", "display_name": "7stud", "link": "https://stackoverflow.com/users/926143/7stud"}, "reply_to_user": {"reputation": 8818, "user_id": 2714301, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/23c7ba1f14e71e14f65b7b95516b0f19?s=128&d=identicon&r=PG", "display_name": "Jwan622", "link": "https://stackoverflow.com/users/2714301/jwan622"}, "edited": false, "score": 1, "creation_date": 1517348101, "post_id": 48517827, "comment_id": 84057200, "body": "@Jwan622, In sinatra, <code>settings.root</code> is the path to your app directory, so do <code>$LOAD_PATH.unshift settings.root</code>. That way you can move your app to another directory without changing anything. \u2013"}], "tags": [], "owner": {"reputation": 41846, "user_id": 926143, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/3396173c3d22988be1a0732d184902aa?s=128&d=identicon&r=PG", "display_name": "7stud", "link": "https://stackoverflow.com/users/926143/7stud"}, "is_accepted": true, "score": 4, "last_activity_date": 1517347904, "last_edit_date": 1517347904, "creation_date": 1517304080, "answer_id": 48517827, "question_id": 48516390, "link": "https://stackoverflow.com/questions/48516390/easier-way-to-require-spec-files-in-sinatra/48517827#48517827", "title": "Easier way to require spec files in Sinatra", "body": "<p><em>Some explanation of max pleaner's answer...</em></p>\n\n<p>When you write:</p>\n\n<pre><code>require 'lib/house_distributer.rb'\n</code></pre>\n\n<p>ruby looks for the file in the directories assigned to the <code>$LOAD_PATH</code> environment variable.  <code>$LOAD_PATH</code> is an array of Strings, where each String is a path to a directory.  The directories in the $LOAD_PATH array are searched in order, and the first match wins.  </p>\n\n<p>If <code>$LOAD_PATH</code> contains a directory called:</p>\n\n<pre><code>'/Users/7stud/ruby_programs'\n</code></pre>\n\n<p>Then the <code>require</code> statement above will look for a file with the absolute path:</p>\n\n<pre><code>'/Users/7stud/ruby_programs/lib/house_distributer.rb'\n</code></pre>\n\n<p>You can check which directories are in your <code>$LOAD_PATH</code> like this:</p>\n\n<pre><code>$ puts $LOAD_PATH\n</code></pre>\n\n<p>This is what I get:</p>\n\n<pre><code>/Users/7stud/.rvm/gems/ruby-2.4.0@global/gems/did_you_mean-1.1.0/lib\n/Users/7stud/.rvm/rubies/ruby-2.4.0/lib/ruby/site_ruby/2.4.0\n/Users/7stud/.rvm/rubies/ruby-2.4.0/lib/ruby/site_ruby/2.4.0/x86_64-darwin14\n/Users/7stud/.rvm/rubies/ruby-2.4.0/lib/ruby/site_ruby\n/Users/7stud/.rvm/rubies/ruby-2.4.0/lib/ruby/vendor_ruby/2.4.0\n/Users/7stud/.rvm/rubies/ruby-2.4.0/lib/ruby/vendor_ruby/2.4.0/x86_64-darwin14\n/Users/7stud/.rvm/rubies/ruby-2.4.0/lib/ruby/vendor_ruby\n/Users/7stud/.rvm/rubies/ruby-2.4.0/lib/ruby/2.4.0\n/Users/7stud/.rvm/rubies/ruby-2.4.0/lib/ruby/2.4.0/x86_64-darwin14\n</code></pre>\n\n<p>Obviously, your app's files are not in directories like those.</p>\n\n<p>On the other hand, if you <code>require</code> a file whose path starts with a <code>/</code> or a <code>.</code> -- for instance:</p>\n\n<pre><code>require './lib/house_distributer.rb'\n</code></pre>\n\n<p>then ruby skips <code>$LOAD_PATH</code>, and in this case ruby looks for the file relative to the <em>current working directory</em>.  Note however, that the <em>current working directory</em> may not be the directory containing the file with the require statement. For instance, if you execute your sinatra program from a different directory, say two levels up from the file containing the <code>require</code> statement, then the two levels up directory will be the <em>current working directory</em>, and ruby will look for the required file relative to the two levels up directory.</p>\n\n<p>Enter <code>require_relative</code>.  <code>require_relative</code> will look for the file relative to the path of the current file--not the current working directory.  </p>\n\n<p>As a result, you should probably never use <code>require</code> with a relative path and instead use <code>require_relative</code>.</p>\n\n<p>Note that you can also programmatically add paths to $LOAD_PATH any time you want:</p>\n\n<pre><code>$LOAD_PATH &lt;&lt; '/Users/7stud/ruby_programs'\n</code></pre>\n\n<p>And if a file called <code>dog.rb is</code> in that directory, I can require it like so:</p>\n\n<pre><code>require 'dog'  #extension is unnecessary\n</code></pre>\n\n<p><strong>Response to comment</strong>:</p>\n\n<p>The simplest thing to do would be:</p>\n\n<pre><code>$LOAD_PATH &lt;&lt; \"/Users/jwan/Desktop/programming/interview_questions/gemini/\u200c\u200bjobcoin_mixer/\"\n</code></pre>\n\n<p>But in sinatra, <code>settings.root</code> is the path to your app directory, so do:</p>\n\n<pre><code>$LOAD_PATH.unshift setttings.root \n</code></pre>\n\n<p>That way you can move your app to another directory without changing anything.</p>\n\n<p>Or, you can remove <code>lib/</code> from the front of every path that <code>Dir[]</code> returned:</p>\n\n<pre><code>require 'pathname'\n\npaths = [\n  \"lib/house_distributer.rb\", \n  \"lib/distributer.rb\", \n  \"lib/mixer.rb\", \n  \"lib/accounting_service.rb\", \n]\n\nnew_paths = paths.map do |path|\n  pn = Pathname.new path\n  pn.relative_path_from(pn.parent).to_s\nend\n\np new_paths\n\n--output:--\n[\"house_distributer.rb\", \"distributer.rb\", \"mixer.rb\", \"accounting_service.rb\"]\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 11068, "user_id": 335847, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/o0AC7.png?s=128&g=1", "display_name": "iain", "link": "https://stackoverflow.com/users/335847/iain"}, "is_accepted": false, "score": 2, "last_activity_date": 1518386635, "creation_date": 1518386635, "answer_id": 48736969, "question_id": 48516390, "link": "https://stackoverflow.com/questions/48516390/easier-way-to-require-spec-files-in-sinatra/48736969#48736969", "title": "Easier way to require spec files in Sinatra", "body": "<p>The other 2 answers are technically correct and address the <em>goal</em> but not the <em>aim</em>. In other words - <strong><em>why are you doing that in the first place?</em></strong> For instance, why do this:</p>\n\n<blockquote>\n  <p>Also side note, distributer.rb has to be loaded before house_distributer.rb because of this:</p>\n</blockquote>\n\n<pre><code>class HouseDistributer &lt; Distributer\nend\n</code></pre>\n\n<p>And not this?</p>\n\n<pre><code>require_relative \"distributer.rb\"\nclass HouseDistributer &lt; Distributer\nend\n</code></pre>\n\n<p>And in the tests (<em>cough</em>) sorry, the <em>specs</em>:</p>\n\n<pre><code># spec/house_distributer_spec.rb\nrequire 'spec_helper'\nrequire_relative \"../lib/house_distributer.rb\"\n\n# spec/transaction_service_spec.rb\nrequire 'spec_helper'\nrequire_relative \"../lib/transaction_service.rb\"\n</code></pre>\n\n<p>And since <code>transaction_service.rb</code> appears to need <code>HouseDistributer</code> from <code>lib/house_distributer.rb</code>\u2026</p>\n\n<pre><code># lib/transaction_service.rb\nrequire_relative \"house_distributer.rb\"\n</code></pre>\n\n<h3>The rule of thumb</h3>\n\n<p><em>If a file needs another to run then <code>require</code> (or <code>require_relative</code>) it in the file that requires it.</em> Then you get:</p>\n\n<ul>\n<li>A kind of natural sandboxing by only running what is needed (maybe Distributer works perfectly and HouseDistributer has the error because of a monkey patch - how will you know if you <code>require</code> files that aren't actually needed?)</li>\n<li>No need to handle requires elsewhere.</li>\n<li>No need (or much less need) to know the order of requires.</li>\n<li>No need to fiddle about with the load path (which has been a dubious need ever since <code>require_relative</code> was introduced).</li>\n<li>Changing the load path and then using <code>require</code> can break sandboxing and make specs work that should fail by loading a gem you have installed on your system but isn't defined as a dependency in the gemspec.</li>\n</ul>\n\n<p>I'd add, use bundler's sandboxing too, to avoid further errors and let it handle your load path, e.g.</p>\n\n<p><code>bundle install --binstubs --path=vendor</code> (or vendor.noindex on a Mac) then:</p>\n\n<p><code>bin/rspec</code> and whatever commandline args you need.</p>\n"}], "owner": {"reputation": 8818, "user_id": 2714301, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/23c7ba1f14e71e14f65b7b95516b0f19?s=128&d=identicon&r=PG", "display_name": "Jwan622", "link": "https://stackoverflow.com/users/2714301/jwan622"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 637, "favorite_count": 0, "accepted_answer_id": 48517827, "answer_count": 3, "score": 3, "last_activity_date": 1518386635, "creation_date": 1517298545, "last_edit_date": 1517330016, "question_id": 48516390, "link": "https://stackoverflow.com/questions/48516390/easier-way-to-require-spec-files-in-sinatra", "title": "Easier way to require spec files in Sinatra", "body": "<p>I have a <code>spec_helper</code> that looks like this:</p>\n\n<pre><code>require 'pry'\nrequire 'helpers/data_helper.rb'\nrequire 'distributer.rb'\nrequire 'house_distributer.rb'\nrequire 'accounting_service.rb'\nrequire 'mixer_worker.rb'\nrequire 'mixer.rb'\nrequire 'transaction_service.rb'\n\nENV['RACK_ENV'] = 'test'\n\nRSpec.configure do |config|\n  config.mock_with :rspec do |mocks|\n    mocks.verify_partial_doubles = true\n  end\n\n  config.warnings = true\n\n  config.order = :random\nend\n</code></pre>\n\n<p>and a folder structure that looks like this:</p>\n\n<pre><code>.\n\u251c\u2500\u2500 Gemfile\n\u251c\u2500\u2500 Gemfile.lock\n\u251c\u2500\u2500 README.md\n\u251c\u2500\u2500 app.rb\n\u251c\u2500\u2500 config.ru\n\u251c\u2500\u2500 lib\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 accounting_service.rb\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 distributer.rb\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 house_distributer.rb\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 mixer.rb\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 mixer_worker.rb\n\u2502\u00a0\u00a0 \u2514\u2500\u2500 transaction_service.rb\n\u251c\u2500\u2500 public\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 css\n\u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u2514\u2500\u2500 add_coins.css\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 images\n\u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u2514\u2500\u2500 bitcoin_dawg.jpg\n\u2502\u00a0\u00a0 \u2514\u2500\u2500 javascripts\n\u2502\u00a0\u00a0     \u2514\u2500\u2500 add_coins.js\n\u251c\u2500\u2500 spec\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 helpers\n\u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u2514\u2500\u2500 data_helper.rb\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 lib\n\u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u251c\u2500\u2500 accounting_service_spec.rb\n\u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u2514\u2500\u2500 transaction_service_spec.rb\n\u2502\u00a0\u00a0 \u2514\u2500\u2500 spec_helper.rb\n\u2514\u2500\u2500 views\n    \u2514\u2500\u2500 add_coins.erb\n</code></pre>\n\n<p>This does not work:</p>\n\n<pre><code>Dir[\"lib/*.rb\"].each {|file| require file }\n\n[1] pry(main)&gt; Dir[\"lib/*.rb\"]\n=&gt; [\"lib/house_distributer.rb\", \"lib/distributer.rb\", \"lib/mixer.rb\", \"lib/accounting_service.rb\", \"lib/mixer_worker.rb\", \"lib/transaction_service.rb\"]\n</code></pre>\n\n<p>I get this error message:</p>\n\n<pre><code>/Users/jwan/.rbenv/versions/2.1.2/lib/ruby/2.1.0/rubygems/core_ext/kernel_require.rb:55:in `require': cannot load such file -- lib/house_distributer.rb (LoadError)\n    from /Users/jwan/.rbenv/versions/2.1.2/lib/ruby/2.1.0/rubygems/core_ext/kernel_require.rb:55:in `require'\n</code></pre>\n\n<p>What can I do to make this easier?</p>\n\n<p>Also side note, <code>distributer.rb</code> has to be loaded before <code>house_distributer.rb</code> because of this:</p>\n\n<pre><code>class HouseDistributer &lt; Distributer\nend\n</code></pre>\n"}, {"tags": ["ruby", "datetime", "datetime-parsing"], "answers": [{"comments": [{"owner": {"reputation": 2853, "user_id": 117305, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/34791e1d8c4def65f9b93294638a7e04?s=128&d=identicon&r=PG", "display_name": "Joerg", "link": "https://stackoverflow.com/users/117305/joerg"}, "edited": false, "score": 0, "creation_date": 1517299592, "post_id": 48516504, "comment_id": 84027555, "body": "So the specified flag &quot;-&quot; for example (or any flags) does not work with <code>strptime</code>. I need to omit them from the format string. Thanks for that! Missed that little bit in the documentation."}], "tags": [], "owner": {"reputation": 23809, "user_id": 351909, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/71a6b8a36a63c2cb9de678c07be6d8a4?s=128&d=identicon&r=PG", "display_name": "moritz", "link": "https://stackoverflow.com/users/351909/moritz"}, "is_accepted": true, "score": 4, "last_activity_date": 1517298968, "creation_date": 1517298968, "answer_id": 48516504, "question_id": 48516348, "link": "https://stackoverflow.com/questions/48516348/datetime-strptime-cant-parse-date-string/48516504#48516504", "title": "DateTime.strptime can&#39;t parse date string", "body": "<p>Its because <code>strptime</code> doesn't support the flags in the format you are using, have a look at <a href=\"http://ruby-doc.org/stdlib-2.4.2/libdoc/date/rdoc/DateTime.html#method-c-strptime\" rel=\"nofollow noreferrer\">http://ruby-doc.org/stdlib-2.4.2/libdoc/date/rdoc/DateTime.html#method-c-strptime</a></p>\n"}, {"comments": [{"owner": {"reputation": 2853, "user_id": 117305, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/34791e1d8c4def65f9b93294638a7e04?s=128&d=identicon&r=PG", "display_name": "Joerg", "link": "https://stackoverflow.com/users/117305/joerg"}, "edited": false, "score": 0, "creation_date": 1517300291, "post_id": 48516556, "comment_id": 84027970, "body": "That&#39;s it - thank you! I accepted the other answer as it explained that strptime doesn&#39;t support flags - the reason why the <code>fmt</code> doesn&#39;t &quot;match&quot; the datetime string."}], "tags": [], "owner": {"reputation": 1265, "user_id": 6092216, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F6a3O.jpg?s=128&g=1", "display_name": "Nabin Paudyal", "link": "https://stackoverflow.com/users/6092216/nabin-paudyal"}, "is_accepted": false, "score": 2, "last_activity_date": 1517299194, "creation_date": 1517299194, "answer_id": 48516556, "question_id": 48516348, "link": "https://stackoverflow.com/questions/48516348/datetime-strptime-cant-parse-date-string/48516556#48516556", "title": "DateTime.strptime can&#39;t parse date string", "body": "<p>The error is because the format <code>fmt</code> you have provided doesn't match the <code>DateTime</code> string you have provided.</p>\n\n<p>Change your format from</p>\n\n<pre><code>fmt = \"%-m/%-d/%Y %-l:%M:%S %p\"\n</code></pre>\n\n<p>into </p>\n\n<pre><code>fmt = \"%m/%d/%Y %l:%M:%S %p\"\n</code></pre>\n\n<p>Hope this helps.</p>\n"}], "owner": {"reputation": 2853, "user_id": 117305, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/34791e1d8c4def65f9b93294638a7e04?s=128&d=identicon&r=PG", "display_name": "Joerg", "link": "https://stackoverflow.com/users/117305/joerg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 387, "favorite_count": 0, "accepted_answer_id": 48516504, "answer_count": 2, "score": 2, "last_activity_date": 1517299194, "creation_date": 1517298363, "question_id": 48516348, "link": "https://stackoverflow.com/questions/48516348/datetime-strptime-cant-parse-date-string", "title": "DateTime.strptime can&#39;t parse date string", "body": "<p>I don't understand why the following Ruby 2.4 code fails:</p>\n\n<pre><code>irb(main):006:0&gt; require 'date'\n=&gt; false\nirb(main):007:0&gt; fmt = \"%-m/%-d/%Y %-l:%M:%S %p\"\n=&gt; \"%-m/%-d/%Y %-l:%M:%S %p\"\nirb(main):008:0&gt; DateTime.now.strftime(fmt)\n=&gt; \"1/30/2018 7:42:44 AM\"\nirb(main):009:0&gt; DateTime.strptime(\"1/30/2018 7:42:44 AM\", fmt)\nArgumentError: invalid date\n  from (irb):9:in `strptime'\n  from (irb):9\n  from /usr/local/bin/irb:11:in `&lt;main&gt;'\nirb(main):010:0&gt;\n</code></pre>\n\n<p>The datetime format works when I format a date, but the same format string fails when I try to parse a date string in that format.</p>\n"}, {"tags": ["ruby", "telegram"], "owner": {"reputation": 2571, "user_id": 6822876, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/i6dGp.jpg?s=128&g=1", "display_name": "Carrein", "link": "https://stackoverflow.com/users/6822876/carrein"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 341, "favorite_count": 0, "answer_count": 0, "score": 3, "last_activity_date": 1517297484, "creation_date": 1517297484, "question_id": 48516116, "link": "https://stackoverflow.com/questions/48516116/ruby-telegram-bot-passing-value-to-callbackquery", "title": "Ruby Telegram Bot, passing value to CallbackQuery?", "body": "<p>I have a Telegram Bot which updates scores for a set of teams.</p>\n\n<p>Teams are dynamic in size.</p>\n\n<pre><code>def collection_keyboard(identity)\n  ip_addr = \"127.0.0.1:27017\"\n  client = Mongo::Client.new([ip_addr], :database =&gt; \"camp\")\n\n  kb = []\n  client[:inventory].find({\"owner\": identity}, projection: {\"_id\": 0, \"name\": 1}).each do |doc|\n    kb &lt;&lt; Telegram::Bot::Types::InlineKeyboardButton.new(text: doc.to_s , callback_data: ??) //What do i put as the callback data?\n  end\n  markup = Telegram::Bot::Types::InlineKeyboardMarkup.new(inline_keyboard: kb)\n  return markup\nend\n</code></pre>\n\n<p>The above method queries the db and creates an inline keyboard, allowing users to choose which teams score to increment.</p>\n\n<pre><code>Telegram::Bot::Client.run(token) do |bot|\n  bot.listen do |message|\n    case message\n    when Telegram::Bot::Types::CallbackQuery\n      if message.data == ?? //What do i check here?\n\n      end\n    end\n</code></pre>\n\n<p>A second inlinekeyboard will be created once the first CallbackQuery has been returned. This keyboard will allow a user to choose how many points to give e.g. 10, 20, 30.</p>\n\n<p>However, since the group size vary, how do I pass the value of the Inline Keyboard which he user has clicked so that I can add points to that particular team? Since the group is dynamic, I cannot capture all possible callback return value with the regular switch statement?</p>\n\n<p>For example, if a user clicks <code>Yellow</code>, how can I pass this value to the next InlineKeyboard such that the user can add <code>10</code> points to them?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "reactjs", "react-on-rails"], "answers": [{"tags": [], "owner": {"reputation": 1928, "user_id": 6193734, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-yNKciMo2y_0/AAAAAAAAAAI/AAAAAAAACGs/Hg_DmZMu7Lw/photo.jpg?sz=128", "display_name": "Matthieu Libeer", "link": "https://stackoverflow.com/users/6193734/matthieu-libeer"}, "is_accepted": false, "score": 0, "last_activity_date": 1547405302, "last_edit_date": 1547405302, "creation_date": 1547403716, "answer_id": 54171857, "question_id": 48516110, "link": "https://stackoverflow.com/questions/48516110/react-on-rails-how-to-render-other-views-from-a-component-without-using-library/54171857#54171857", "title": "react_on_rails how to render other views from a component without using library", "body": "<p>Most probably, your component sends the POST request using <code>fetch</code>, or <code>ajax</code>, instead of relying on the native behaviour of the form rendered by your React component.</p>\n\n<p>You have a couple of options:</p>\n\n<ol>\n<li>Submit the form natively, this way the redirect will actually redirect.</li>\n<li>Have the server send a JSON response that the React component handles to update itself.</li>\n</ol>\n"}], "owner": {"reputation": 15, "user_id": 9133480, "user_type": "registered", "profile_image": "https://graph.facebook.com/1690680324329869/picture?type=large", "display_name": "Muhammad Taha", "link": "https://stackoverflow.com/users/9133480/muhammad-taha"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 108, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1547405302, "creation_date": 1517297466, "last_edit_date": 1517298414, "question_id": 48516110, "link": "https://stackoverflow.com/questions/48516110/react-on-rails-how-to-render-other-views-from-a-component-without-using-library", "title": "react_on_rails how to render other views from a component without using library", "body": "<p>I've created a rails project and then integrated react with it using <code>react_on_rails</code> gem. I've made one component and placed it inside my <strong>new.html.erb</strong> using <code>react_component</code> helper method. Whenever this erb view renders I get the react component and after filling in the fields the component sends a POST request to <code>todos#create</code> path and the create action after saving the fields redirect to <code>todos#show</code> because of redirect_to <code>@todo</code>. The problem is that the <strong>show.html.erb</strong> is not rendered automatically as before. It gets returned in the response with the React component present inside.</p>\n\n<ol>\n<li>How do I render the view rendered in the response using a standard way?</li>\n<li>Is there any way to handle this situation without using <code>react-router</code> and using only rails defined routes. </li>\n</ol>\n"}, {"tags": ["ruby-on-rails", "ruby", "api", "net-http"], "comments": [{"owner": {"reputation": 7224, "user_id": 448934, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TXtux.jpg?s=128&g=1", "display_name": "Pascal", "link": "https://stackoverflow.com/users/448934/pascal"}, "edited": false, "score": 0, "creation_date": 1517296305, "post_id": 48515714, "comment_id": 84025779, "body": "Are you sure the request body is OK? Can you add a link to the API description?"}, {"owner": {"reputation": 273, "user_id": 6165160, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/0f16ac1aabf77b83e85e72ecaf6a2805?s=128&d=identicon&r=PG&f=1", "display_name": "Abhradip", "link": "https://stackoverflow.com/users/6165160/abhradip"}, "reply_to_user": {"reputation": 7224, "user_id": 448934, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TXtux.jpg?s=128&g=1", "display_name": "Pascal", "link": "https://stackoverflow.com/users/448934/pascal"}, "edited": false, "score": 0, "creation_date": 1517296354, "post_id": 48515714, "comment_id": 84025806, "body": "Here it is: <a href=\"https://search.riskscreen.com/help/guide-api\" rel=\"nofollow noreferrer\">search.riskscreen.com/help/guide-api</a>"}, {"owner": {"reputation": 7224, "user_id": 448934, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TXtux.jpg?s=128&g=1", "display_name": "Pascal", "link": "https://stackoverflow.com/users/448934/pascal"}, "edited": false, "score": 0, "creation_date": 1517296449, "post_id": 48515714, "comment_id": 84025840, "body": "This requires an account."}, {"owner": {"reputation": 273, "user_id": 6165160, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/0f16ac1aabf77b83e85e72ecaf6a2805?s=128&d=identicon&r=PG&f=1", "display_name": "Abhradip", "link": "https://stackoverflow.com/users/6165160/abhradip"}, "reply_to_user": {"reputation": 7224, "user_id": 448934, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TXtux.jpg?s=128&g=1", "display_name": "Pascal", "link": "https://stackoverflow.com/users/448934/pascal"}, "edited": false, "score": 0, "creation_date": 1517296595, "post_id": 48515714, "comment_id": 84025905, "body": "I have edited the post and have given the credentials. Please check."}, {"owner": {"reputation": 471, "user_id": 2395946, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gqI0l.png?s=128&g=1", "display_name": "hoangdd", "link": "https://stackoverflow.com/users/2395946/hoangdd"}, "edited": false, "score": 1, "creation_date": 1517296751, "post_id": 48515714, "comment_id": 84025982, "body": "I think you shouldn&#39;t share your private information to stackoverflow( username, password, api-key). It is risk."}, {"owner": {"reputation": 273, "user_id": 6165160, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/0f16ac1aabf77b83e85e72ecaf6a2805?s=128&d=identicon&r=PG&f=1", "display_name": "Abhradip", "link": "https://stackoverflow.com/users/6165160/abhradip"}, "edited": false, "score": 0, "creation_date": 1517296893, "post_id": 48515714, "comment_id": 84026081, "body": "Okay. But it seems to access the documentation, credentials are needed."}], "answers": [{"comments": [{"owner": {"reputation": 48413, "user_id": 1279683, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1veuT.jpg?s=128&g=1", "display_name": "Marek Lipka", "link": "https://stackoverflow.com/users/1279683/marek-lipka"}, "reply_to_user": {"reputation": 273, "user_id": 6165160, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/0f16ac1aabf77b83e85e72ecaf6a2805?s=128&d=identicon&r=PG&f=1", "display_name": "Abhradip", "link": "https://stackoverflow.com/users/6165160/abhradip"}, "edited": false, "score": 0, "creation_date": 1517297559, "post_id": 48515983, "comment_id": 84026464, "body": "@Abhradip 401 is different than 400, check if you authenticated properly and with correct api key."}, {"owner": {"reputation": 273, "user_id": 6165160, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/0f16ac1aabf77b83e85e72ecaf6a2805?s=128&d=identicon&r=PG&f=1", "display_name": "Abhradip", "link": "https://stackoverflow.com/users/6165160/abhradip"}, "edited": false, "score": 1, "creation_date": 1517298715, "post_id": 48515983, "comment_id": 84027115, "body": "There is no issue with api-key. It is working fine in POSTMAN"}, {"owner": {"reputation": 471, "user_id": 2395946, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gqI0l.png?s=128&g=1", "display_name": "hoangdd", "link": "https://stackoverflow.com/users/2395946/hoangdd"}, "edited": false, "score": 0, "creation_date": 1517305579, "post_id": 48515983, "comment_id": 84031180, "body": "Sorry, I can&#39;t understand why it not work. I try set <code>http.set_debug_output $stderr</code> to see what Ruby request, api-key is included in header. I think you should contact Riskscreen support. Goodluck!"}], "tags": [], "owner": {"reputation": 471, "user_id": 2395946, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gqI0l.png?s=128&g=1", "display_name": "hoangdd", "link": "https://stackoverflow.com/users/2395946/hoangdd"}, "is_accepted": false, "score": 1, "last_activity_date": 1517297671, "last_edit_date": 1517297671, "creation_date": 1517296939, "answer_id": 48515983, "question_id": 48515714, "link": "https://stackoverflow.com/questions/48515714/issue-regarding-http-post-api-call-using-ruby-code/48515983#48515983", "title": "Issue regarding http POST api call using ruby code", "body": "<p>Can you try remove:</p>\n\n<pre><code>req.body = \"[ #{@toSend} ]\"\n</code></pre>\n\n<p>and replace by:</p>\n\n<pre><code>req.set_form_data({})\n# or \nreq.body = \"{}\"\n</code></pre>\n\n<p>Sorry, I'm not sure about that.</p>\n"}, {"comments": [{"owner": {"reputation": 740, "user_id": 5673242, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cdd127bacb8132d2d7297989828d3086?s=128&d=identicon&r=PG&f=1", "display_name": "jpn", "link": "https://stackoverflow.com/users/5673242/jpn"}, "edited": false, "score": 1, "creation_date": 1517307630, "post_id": 48518706, "comment_id": 84032509, "body": "@Abhradip you should also contact RiskScreen and ask them to fix this on their side, as headers as not meant to be case-sensitive! You will also want to ask them to change your access token..."}], "tags": [], "owner": {"reputation": 1196, "user_id": 8426717, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-QwYD3zUWkhA/AAAAAAAAAAI/AAAAAAAABJs/2y8hDOo4fYY/photo.jpg?sz=128", "display_name": "Tai", "link": "https://stackoverflow.com/users/8426717/tai"}, "is_accepted": true, "score": 2, "last_activity_date": 1517306714, "creation_date": 1517306714, "answer_id": 48518706, "question_id": 48515714, "link": "https://stackoverflow.com/questions/48515714/issue-regarding-http-post-api-call-using-ruby-code/48518706#48518706", "title": "Issue regarding http POST api call using ruby code", "body": "<p>Header's keys must be String instead of Symbol</p>\n\n<pre><code>header = {'api-key' =&gt; 'my api key','Content-Type' =&gt; 'application/json', 'Accept' =&gt; 'application/json'}\n</code></pre>\n\n<p>Another issue is <code>net/http</code> is capitalize header automatically, <code>api-key</code> -> <code>Api-Key</code> which cause <code>Authorization Error</code> on your server. One solution is to create new class to wrap <code>api-key</code> to prevent Ruby do that</p>\n\n<pre><code>class HeaderCaseSensitive &lt; String\n  def capitalize\n    self\n  end\n\n  def split(*args)\n    super.each do |str|\n      HeaderCaseSensitive.new(str)\n    end\n  end\n\n  def to_s\n    self\n  end\nend\n</code></pre>\n\n<p>Then change header:</p>\n\n<pre><code>header = {HeaderCaseSensitive.new('api-key') =&gt; 'xxxx','Content-Type' =&gt; 'application/json', 'Accept' =&gt; 'application/json'}\n</code></pre>\n\n<p>To sum up, following code will work:</p>\n\n<pre><code>require 'uri'\nrequire 'net/http'\nrequire 'net/https'\nrequire 'json'\n\nclass HeaderCaseSensitive &lt; String\n  def capitalize\n    self\n  end\n\n  def split(*args)\n    super.each do |str|\n      HeaderCaseSensitive.new(str)\n    end\n  end\n\n  def to_s\n    self\n  end\nend\n\n@toSend = {}.to_json\n\nuri = URI.parse(\"https://api.riskscreen.com/api/v1/user/tokens\")\nhttps = Net::HTTP.new(uri.host,uri.port)\nhttps.use_ssl = true\nhttps.verify_mode = OpenSSL::SSL::VERIFY_NONE\nheader = {HeaderCaseSensitive.new('api-key') =&gt; 'xxx','Content-Type' =&gt; 'application/json', 'Accept' =&gt; 'application/json'}\nhttps.set_debug_output($stdout)\nreq = Net::HTTP::Post.new(uri.path, header)\nreq.body = \"[ #{@toSend} ]\"\n\n\nres = https.request(req)\n\n\nputs \"------------\"\nputs \"Response #{res.code} #{res.message}: #{res.body}\"\n</code></pre>\n"}], "owner": {"reputation": 273, "user_id": 6165160, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/0f16ac1aabf77b83e85e72ecaf6a2805?s=128&d=identicon&r=PG&f=1", "display_name": "Abhradip", "link": "https://stackoverflow.com/users/6165160/abhradip"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 143, "favorite_count": 0, "accepted_answer_id": 48518706, "answer_count": 2, "score": 1, "last_activity_date": 1517306714, "creation_date": 1517295875, "last_edit_date": 1517297032, "question_id": 48515714, "link": "https://stackoverflow.com/questions/48515714/issue-regarding-http-post-api-call-using-ruby-code", "title": "Issue regarding http POST api call using ruby code", "body": "<p>I am going to access the Riskscreen api to authenticate users. To test the api I have written a ruby code snippet to make sample POST call to get the number of tokens I have from the Riskscreen api.</p>\n\n<p>My code is:</p>\n\n<pre><code>require 'uri'\nrequire 'net/http'\nrequire 'net/https'\nrequire 'json'\n\n@toSend = {}.to_json\n\nuri = URI.parse(\"https://api.riskscreen.com/api/v1/user/tokens\")\nhttps = Net::HTTP.new(uri.host,uri.port)\nhttps.use_ssl = true\nhttps.verify_mode = OpenSSL::SSL::VERIFY_NONE\nheader = {'api-key': 'my api key','Content-Type': 'application/json', 'Accept': 'application/json'}\nreq = Net::HTTP::Post.new(uri.path, header)\nreq.body = \"[ #{@toSend} ]\"\nres = https.request(req)\n\n\nputs \"------------\"\nputs \"Response #{res.code} #{res.message}: #{res.body}\"\n</code></pre>\n\n<p>But I am getting the following error:</p>\n\n<pre><code>Response 400 Bad Request\n</code></pre>\n\n<p>If I change the header line to </p>\n\n<pre><code>header = {'api-key'=&gt; 'my-api-key','Content-Type'=&gt; 'application/json', 'Accept'=&gt; 'application/json'}\n</code></pre>\n\n<p>then I am getting this error:</p>\n\n<pre><code>Response 401 Unauthorized\n</code></pre>\n\n<p>Sticking with this for a while. Please help me to sort out this.</p>\n"}, {"tags": ["ruby", "loops", "filter", "logstash"], "answers": [{"tags": [], "owner": {"reputation": 4600, "user_id": 5961578, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/df7cbfdd2a92a7926af3bbb8648318aa?s=128&d=identicon&r=PG", "display_name": "moveson", "link": "https://stackoverflow.com/users/5961578/moveson"}, "is_accepted": false, "score": 0, "last_activity_date": 1517297585, "creation_date": 1517297585, "answer_id": 48516147, "question_id": 48515465, "link": "https://stackoverflow.com/questions/48515465/logstash-ruby-filter-loop-and-data-set/48516147#48516147", "title": "Logstash ruby filter loop and data set", "body": "<p>This will do the trick:</p>\n\n<pre><code>&gt;&gt; hash = {\n    \"data\": [\n        {\"price\": 0.04123445},\n        {\"price\": 0.123454}\n    ]\n}\n\n&gt;&gt; hash.merge(data: hash[:data].map { |pair| pair.transform_values { |value| value.round(2) } })\n{:data=&gt;[{:price=&gt;0.04}, {:price=&gt;0.12}]}\n</code></pre>\n\n<p>Note this does not modify the original hash object. It creates a duplicate with the transformed values.</p>\n"}], "owner": {"reputation": 35, "user_id": 4914339, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-EoN-6B--ZLs/AAAAAAAAAAI/AAAAAAAABtQ/V0Y0zJ4gkx4/photo.jpg?sz=128", "display_name": "Kwang-Ho Song", "link": "https://stackoverflow.com/users/4914339/kwang-ho-song"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 462, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1517297585, "creation_date": 1517294814, "last_edit_date": 1517295214, "question_id": 48515465, "link": "https://stackoverflow.com/questions/48515465/logstash-ruby-filter-loop-and-data-set", "title": "Logstash ruby filter loop and data set", "body": "<p>I have these raw json data:</p>\n\n<pre><code>{\n   \"data\": [\n      {\"price\": 0.04123445},\n      {\"price\": 0.123454}\n   ]\n}\n</code></pre>\n\n<p>I want to convert them to:</p>\n\n<pre><code>{\n   \"data\": [\n      {\"price\": 0.04},\n      {\"price\": 0.12}\n   ]\n}\n</code></pre>\n\n<p>How can I code this with logstash filter?</p>\n"}, {"tags": ["ruby", "amazon-s3", "aws-sdk", "ruby-csv"], "owner": {"reputation": 79, "user_id": 9227197, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/a6b3a69a8b93258722c50c18a118e3bd?s=128&d=identicon&r=PG&f=1", "display_name": "Jurot King", "link": "https://stackoverflow.com/users/9227197/jurot-king"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 67, "favorite_count": 0, "closed_date": 1517294334, "answer_count": 0, "score": 2, "last_activity_date": 1517296999, "creation_date": 1517293283, "last_edit_date": 1517296999, "question_id": 48515109, "link": "https://stackoverflow.com/questions/48515109/how-to-retrieve-csv-headers-only-from-s3", "closed_reason": "Duplicate", "title": "How to retrieve CSV headers only from S3", "body": "<p>I have a large csv file in S3 bucket, I just wanted to get the headers only. Iam using ruby aws-sdk . Any pointers? I needed headers only and I dont want to read the whole csv just to get the headers</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 73209, "user_id": 290394, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/d7908f05c89e965f6bc5308ad6f41256?s=128&d=identicon&r=PG", "display_name": "steenslag", "link": "https://stackoverflow.com/users/290394/steenslag"}, "edited": false, "score": 1, "creation_date": 1517305032, "post_id": 48513017, "comment_id": 84030830, "body": "Rationals are good for this: <code>(8.01r - 8r).to_f</code>"}], "answers": [{"comments": [{"owner": {"reputation": 8818, "user_id": 2714301, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/23c7ba1f14e71e14f65b7b95516b0f19?s=128&d=identicon&r=PG", "display_name": "Jwan622", "link": "https://stackoverflow.com/users/2714301/jwan622"}, "edited": false, "score": 0, "creation_date": 1517292081, "post_id": 48513152, "comment_id": 84024038, "body": "How do I convert scientific notation back to a number?"}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "reply_to_user": {"reputation": 8818, "user_id": 2714301, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/23c7ba1f14e71e14f65b7b95516b0f19?s=128&d=identicon&r=PG", "display_name": "Jwan622", "link": "https://stackoverflow.com/users/2714301/jwan622"}, "edited": false, "score": 1, "creation_date": 1517298822, "post_id": 48513152, "comment_id": 84027161, "body": "@Jwan622 you can use <code>to_s(&#39;F&#39;)</code> to convert the value to a string using  &quot;floating point notation&quot;."}, {"owner": {"reputation": 8818, "user_id": 2714301, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/23c7ba1f14e71e14f65b7b95516b0f19?s=128&d=identicon&r=PG", "display_name": "Jwan622", "link": "https://stackoverflow.com/users/2714301/jwan622"}, "edited": false, "score": 0, "creation_date": 1517327894, "post_id": 48513152, "comment_id": 84046053, "body": "Thanks a lot man!"}], "tags": [], "owner": {"reputation": 25268, "user_id": 215168, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/212c9d7980fe9aa71739313d483b3782?s=128&d=identicon&r=PG", "display_name": "Abe Voelker", "link": "https://stackoverflow.com/users/215168/abe-voelker"}, "is_accepted": true, "score": 5, "last_activity_date": 1517280673, "creation_date": 1517280673, "answer_id": 48513152, "question_id": 48513017, "link": "https://stackoverflow.com/questions/48513017/how-do-i-get-this-math-to-calculate-correctly/48513152#48513152", "title": "How do I get this math to calculate correctly", "body": "<p>You can use Ruby's arbitrary-precision decimal data type, <code>BigDecimal</code>:</p>\n\n<pre><code>BigDecimal.new(\"8.01\") - BigDecimal.new(\"8\") # =&gt; 0.1e-1\n</code></pre>\n"}], "owner": {"reputation": 8818, "user_id": 2714301, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/23c7ba1f14e71e14f65b7b95516b0f19?s=128&d=identicon&r=PG", "display_name": "Jwan622", "link": "https://stackoverflow.com/users/2714301/jwan622"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 89, "favorite_count": 0, "closed_date": 1517290869, "accepted_answer_id": 48513152, "answer_count": 1, "score": 0, "last_activity_date": 1517286763, "creation_date": 1517279597, "last_edit_date": 1517286763, "question_id": 48513017, "link": "https://stackoverflow.com/questions/48513017/how-do-i-get-this-math-to-calculate-correctly", "closed_reason": "Duplicate", "title": "How do I get this math to calculate correctly", "body": "<p>I get this result:</p>\n\n<pre><code>8.01 - 8.0 #=&gt; 0.009999999999999787\n</code></pre>\n\n<p>I want my answer to be <code>0.01</code>. What can I do to fix this? How can I get this to happen? I guess this is float math. Is this due to floating point precision?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "postgresql", "reactjs", "authentication"], "comments": [{"owner": {"reputation": 2093, "user_id": 3309314, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/3683a7a05e7e97a67c262b774db00d08?s=128&d=identicon&r=PG&f=1", "display_name": "user3309314", "link": "https://stackoverflow.com/users/3309314/user3309314"}, "edited": false, "score": 0, "creation_date": 1517286883, "post_id": 48512933, "comment_id": 84022515, "body": "Can you show the browser&#39;s log of request?"}, {"owner": {"reputation": 1213, "user_id": 5664033, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/965444bb2b99f96cd3e3ace4181fa27c?s=128&d=identicon&r=PG", "display_name": "Bala Karthik", "link": "https://stackoverflow.com/users/5664033/bala-karthik"}, "edited": false, "score": 0, "creation_date": 1517288770, "post_id": 48512933, "comment_id": 84022977, "body": "Can you add the form code ..?"}, {"owner": {"reputation": 497, "user_id": 8032784, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/121caf69992063447bf70cf6688e6a1c?s=128&d=identicon&r=PG", "display_name": "Naji", "link": "https://stackoverflow.com/users/8032784/naji"}, "reply_to_user": {"reputation": 2093, "user_id": 3309314, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/3683a7a05e7e97a67c262b774db00d08?s=128&d=identicon&r=PG&f=1", "display_name": "user3309314", "link": "https://stackoverflow.com/users/3309314/user3309314"}, "edited": false, "score": 0, "creation_date": 1517291792, "post_id": 48512933, "comment_id": 84023944, "body": "@user3309314 do you mean the log in my terminal when I submit the post request? If so it I&#39;ve updated the question to reflect the entire log"}, {"owner": {"reputation": 497, "user_id": 8032784, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/121caf69992063447bf70cf6688e6a1c?s=128&d=identicon&r=PG", "display_name": "Naji", "link": "https://stackoverflow.com/users/8032784/naji"}, "reply_to_user": {"reputation": 1213, "user_id": 5664033, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/965444bb2b99f96cd3e3ace4181fa27c?s=128&d=identicon&r=PG", "display_name": "Bala Karthik", "link": "https://stackoverflow.com/users/5664033/bala-karthik"}, "edited": false, "score": 0, "creation_date": 1517292037, "post_id": 48512933, "comment_id": 84024018, "body": "@BalaKarthik by form code do you mean in the view? If so I currently have my React rendering on one <code>index.html.erb</code> page but I can include it if you think it will help"}, {"owner": {"reputation": 1196, "user_id": 8426717, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-QwYD3zUWkhA/AAAAAAAAAAI/AAAAAAAABJs/2y8hDOo4fYY/photo.jpg?sz=128", "display_name": "Tai", "link": "https://stackoverflow.com/users/8426717/tai"}, "edited": false, "score": 0, "creation_date": 1517294337, "post_id": 48512933, "comment_id": 84024923, "body": "Do you have specific gems/library on frontend that used for authentication?"}, {"owner": {"reputation": 497, "user_id": 8032784, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/121caf69992063447bf70cf6688e6a1c?s=128&d=identicon&r=PG", "display_name": "Naji", "link": "https://stackoverflow.com/users/8032784/naji"}, "reply_to_user": {"reputation": 1196, "user_id": 8426717, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-QwYD3zUWkhA/AAAAAAAAAAI/AAAAAAAABJs/2y8hDOo4fYY/photo.jpg?sz=128", "display_name": "Tai", "link": "https://stackoverflow.com/users/8426717/tai"}, "edited": false, "score": 0, "creation_date": 1517294465, "post_id": 48512933, "comment_id": 84024973, "body": "@Tai the only package im using for this is bcrypt..."}, {"owner": {"reputation": 2093, "user_id": 3309314, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/3683a7a05e7e97a67c262b774db00d08?s=128&d=identicon&r=PG&f=1", "display_name": "user3309314", "link": "https://stackoverflow.com/users/3309314/user3309314"}, "edited": false, "score": 0, "creation_date": 1517302052, "post_id": 48512933, "comment_id": 84029007, "body": "@Naji I mean Chrome&#39;s dev console or something like this."}, {"owner": {"reputation": 5535, "user_id": 7295772, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/ZhWhR.jpg?s=128&g=1", "display_name": "Fabrizio Bertoglio", "link": "https://stackoverflow.com/users/7295772/fabrizio-bertoglio"}, "edited": false, "score": 0, "creation_date": 1517311545, "post_id": 48512933, "comment_id": 84035051, "body": "<a href=\"http://adamalbrecht.com/2015/07/20/authentication-using-json-web-tokens-using-rails-and-react/\" rel=\"nofollow noreferrer\">adamalbrecht.com/2015/07/20/&hellip;</a>"}, {"owner": {"reputation": 976, "user_id": 1980034, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/997b706f5854b7c79e1391d31664af3c?s=128&d=identicon&r=PG", "display_name": "faron", "link": "https://stackoverflow.com/users/1980034/faron"}, "edited": false, "score": 0, "creation_date": 1517351255, "post_id": 48512933, "comment_id": 84058629, "body": "sorry, but it looks like either you have cache issue (js in browser?) or not posting some important part. Can you ensure that app is restarted and browser cache is cleared? Also can you show all the code (ex on github)?"}], "answers": [{"comments": [{"owner": {"reputation": 497, "user_id": 8032784, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/121caf69992063447bf70cf6688e6a1c?s=128&d=identicon&r=PG", "display_name": "Naji", "link": "https://stackoverflow.com/users/8032784/naji"}, "edited": false, "score": 0, "creation_date": 1517426778, "post_id": 48547325, "comment_id": 84095877, "body": "Thank you for the info on <code>wrap_parameters</code>! I ended up doing exactly what you said, nesting the parameters under a <code>user</code> key. I&#39;m curious though, when you say that <code>password</code> isn&#39;t a defined attribute in my model, where are you referring? In my <code>UsersController</code> I never defined any attributes in my model, so why is it that everything else is getting defined by default EXCEPT for password?"}, {"owner": {"reputation": 2031, "user_id": 2337830, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a378c6d6daf4fb5ec84b9079db4d5d60?s=128&d=identicon&r=PG", "display_name": "tombeynon", "link": "https://stackoverflow.com/users/2337830/tombeynon"}, "reply_to_user": {"reputation": 497, "user_id": 8032784, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/121caf69992063447bf70cf6688e6a1c?s=128&d=identicon&r=PG", "display_name": "Naji", "link": "https://stackoverflow.com/users/8032784/naji"}, "edited": false, "score": 1, "creation_date": 1517427228, "post_id": 48547325, "comment_id": 84096143, "body": "ActiveRecord will define your table columns as attributes automatically, but password is just a setter method defined by has_secure_password. password_digest on the other hand might be included since it&#39;s a column, but I haven&#39;t tested that."}], "tags": [], "owner": {"reputation": 2031, "user_id": 2337830, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a378c6d6daf4fb5ec84b9079db4d5d60?s=128&d=identicon&r=PG", "display_name": "tombeynon", "link": "https://stackoverflow.com/users/2337830/tombeynon"}, "is_accepted": true, "score": 3, "last_activity_date": 1517417391, "creation_date": 1517417391, "answer_id": 48547325, "question_id": 48512933, "link": "https://stackoverflow.com/questions/48512933/getting-unexpected-user-param-and-cant-access-password-param-in-rails/48547325#48547325", "title": "Getting Unexpected User Param and Can&#39;t access Password Param in Rails", "body": "<p>Rails has a config option <code>wrap_parameters</code> which is enabled by default. This will detect if you haven't provided a root element (<code>:user</code> in this instance), and will duplicate the keys into a root element for you. That is what is causing your first issue.</p>\n\n<p>Password isn't included in the wrapped parameters because it isn't a defined attribute on your model. Only the keys returned in the class method <code>attribute_names</code> are wrapped. You can get explicitly include additional keys with the following method in your controller:</p>\n\n<pre><code>class UsersController &lt; ApplicationController\n    wrap_parameters :user, include: [:password]\nend\n</code></pre>\n\n<p>Alternatively you could just nest the parameters you send to your rails controller under the <code>user</code> key, and ignore <code>wrap_parameters</code> entirely. </p>\n\n<pre><code>axios.post('/api/user', {\n    user: {\n        email: this.state.email,\n        password: this.state.password,\n        first_name: this.state.first_name,\n        last_name: this.state.last_name,\n        groupname: this.state.groupname,\n        admin: this.state.admin\n    }\n})\n</code></pre>\n"}], "owner": {"reputation": 497, "user_id": 8032784, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/121caf69992063447bf70cf6688e6a1c?s=128&d=identicon&r=PG", "display_name": "Naji", "link": "https://stackoverflow.com/users/8032784/naji"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 215, "favorite_count": 0, "accepted_answer_id": 48547325, "answer_count": 1, "score": 1, "last_activity_date": 1517426842, "creation_date": 1517278904, "last_edit_date": 1517426842, "question_id": 48512933, "link": "https://stackoverflow.com/questions/48512933/getting-unexpected-user-param-and-cant-access-password-param-in-rails", "title": "Getting Unexpected User Param and Can&#39;t access Password Param in Rails", "body": "<p>I started setting up a user authentication system in Rails with React and there are two weird things happening:</p>\n\n<p>1) My POST request is including a <code>user</code> param that I'm pretty sure I didn't configure myself (I was following along with a Rails guideline book). This <code>user</code> param has a duplication of all of my other params, as shown:</p>\n\n<pre><code>Started POST \"/api/user\" for 127.0.0.1 at 2018-01-29 21:54:42 -0800\nProcessing by Api::UserController#create as JSON\n   Parameters: {\"email\"=&gt;\"test@test.com\", \"password\"=&gt;\"[FILTERED]\",\n       \"first_name\"=&gt;\"test\", \"last_name\"=&gt;\"test\", \"groupname\"=&gt;\"test\", \n       \"admin\"=&gt;\"true\", \"user\"=&gt;{\"email\"=&gt;\"test@test.com\", \n       \"first_name\"=&gt;\"test\", \"last_name\"=&gt;\"test\", \"groupname\"=&gt;\"test\", \"admin\"=&gt;\"true\"}}\nCan't verify CSRF token authenticity.\nNo template found for Api::UserController#create, rendering head :no_content\nCompleted 204 No Content in 39ms (ActiveRecord: 0.0ms)\n</code></pre>\n\n<p>2) If you didn't notice already, my <code>password</code> param is the only one that isn't included in my <code>user</code> param (probably because of me calling <code>has_secure_password</code> in my <code>users</code> model?), and I can't figure out how to add it to my <code>private</code> variable.</p>\n\n<p>I'm simply trying to write my new user's information into my Postgres database using <code>Users.new()</code>. Here is what I'm working with:</p>\n\n<p><strong>index.js</strong></p>\n\n<pre><code>class Signup extends React.Component {\n  constructor(props) {\n    super(props)\n    this. state = {\n      email: '',\n      password: '',\n      first_name: '',\n      last_name: '',\n      groupname: '',\n      admin: false\n    }\n\n   this.handleChange = this.handleChange.bind(this)\n   this.handleSubmit = this.handleSubmit.bind(this)\n  }\n\n\n handleChange(e) {\n    const { name, value } = e.target\n    this.setState({\n      [name]: value\n    })\n  }\n\n\n handleSubmit(e) {\n    e.preventDefault()\n    axios.post('/api/user', {\n      email: this.state.email,\n      password: this.state.password,\n      first_name: this.state.first_name,\n      last_name: this.state.last_name,\n      groupname: this.state.groupname,\n      admin: this.state.admin\n    })\n    .then(res =&gt; {\n      console.log(res.data)\n    })\n }\n\n\n\nrender() {\n    return (\n      &lt;div&gt;\n        &lt;h3&gt;Sign Up!&lt;/h3&gt;\n\n\n\n        &lt;section&gt;\n          &lt;div&gt;\n                &lt;div className='box'&gt;\n                  &lt;p className=\"subtitle has-text-grey\"&gt;Create Account&lt;/p&gt;\n                  &lt;hr /&gt;\n\n                  &lt;form onSubmit={this.handleSubmit}&gt;\n\n                    &lt;div className=\"field\"&gt;\n                      &lt;div className=\"control\"&gt;\n                        &lt;label&gt;E-mail\n\n                          &lt;input name=\"email\" type=\"text\" className=\"form-control\" onChange={this.handleChange} defaultValue={this.state.email}&gt;&lt;/input&gt;\n\n                        &lt;/label&gt;\n                      &lt;/div&gt;\n                    &lt;/div&gt;\n\n\n                    &lt;div className=\"field\"&gt;\n                      &lt;div className=\"control\"&gt;\n                        &lt;label&gt;Password\n\n                          &lt;input name=\"password\" type=\"password\" className=\"form-control\" onChange={this.handleChange} defaultValue={this.state.password}&gt;&lt;/input&gt;\n\n                        &lt;/label&gt;\n                      &lt;/div&gt;\n                    &lt;/div&gt;\n\n                    &lt;div className=\"field\"&gt;\n                      &lt;div className=\"control\"&gt;\n\n                        &lt;label &gt;First Name\n\n                          &lt;input type=\"text\" className=\"form-control\" name=\"first_name\" onChange={this.handleChange} defaultValue={this.state.first_name}&gt;&lt;/input&gt;\n                        &lt;/label&gt;\n                      &lt;/div&gt;\n                    &lt;/div&gt;\n\n                    &lt;div className=\"field\"&gt;\n                      &lt;div className=\"control\"&gt;\n                        &lt;label&gt;Last Name\n                          &lt;input type=\"text\" className=\"form-control\" name=\"last_name\" onChange={this.handleChange} defaultValue={this.state.last_name}&gt;&lt;/input&gt;\n                        &lt;/label&gt;\n                      &lt;/div&gt;\n                    &lt;/div&gt;\n\n                    &lt;div className=\"field\"&gt;\n                      &lt;div className=\"control\"&gt;\n                        &lt;label&gt;Group\n\n\n                          &lt;input name=\"groupname\" type=\"text\" className=\"form-control\" onChange={this.handleChange} defaultValue={this.state.groupname}&gt;&lt;/input&gt;\n\n                          &lt;hr /&gt;\n\n                          &lt;span className='adminLabel' style={styles.adminLabelStyle}&gt;Are you registerting as an admin?&lt;/span&gt; &lt;span&gt;     &lt;/span&gt;\n\n\n\n                          &lt;input type=\"checkbox\" id=\"groupadmin\" name=\"admin\" onChange={this.handleChange} value='true'&gt;&lt;/input&gt;\n\n                        &lt;/label&gt;\n                      &lt;/div&gt;\n                    &lt;/div&gt;\n\n                    &lt;div className=\"field is-grouped\"&gt;\n                      &lt;div className=\"control\"&gt;\n                          &lt;input type=\"submit\" value='Submit' className=\"button is-normal is-info\"&gt;&lt;/input&gt;\n                      &lt;/div&gt;\n                    &lt;/div&gt;\n                  &lt;/form&gt;\n\n                  &lt;hr /&gt;\n\n                  &lt;form &gt;\n                    &lt;div className=\"feild\"&gt;\n                      &lt;div className=\"control\"&gt;\n                        &lt;div&gt;Already a Member?\n                          &lt;input type=\"submit\" value='Login' className=\"\" onClick={ this.props.action }&gt;&lt;/input&gt;\n                        &lt;/div&gt;\n                      &lt;/div&gt;\n                    &lt;/div&gt;\n                  &lt;/form&gt;\n            &lt;/div&gt;\n          &lt;/div&gt;\n\n        &lt;/section&gt;\n\n\n      &lt;/div&gt;\n    )\n  }\n</code></pre>\n\n<p><strong>index.html.erb</strong></p>\n\n<pre><code>&lt;%= react_component('Index') %&gt;\n</code></pre>\n\n<p><strong>app/controllers/api/user_controller.rb</strong></p>\n\n<pre><code>class Api::UserController &lt; ApplicationController\n    respond_to :json\n    protect_from_forgery with: :null_session\n\n    def create\n        user_params[:password] = params[:password]\n        puts user_params\n        @user = Users.new(user_params)\n    end\n\n\n    private\n        def user_params\n            params.require(:user).permit(:email, :password, :first_name, :last_name, :groupname, :admin)\n        end\n\n\nend\n</code></pre>\n\n<p><strong>app/models/user.rb</strong></p>\n\n<pre><code>class User &lt; ApplicationRecord\n    before_save { self.email = email.downcase }\n    VALID_EMAIL_REGEX = /\\A[\\w+\\-.]+@[a-z\\d\\-.]+\\.[a-z]+\\z/i\n    validates :email, presence: true, length: { maximum: 255 }, format: { with: VALID_EMAIL_REGEX }, uniqueness: { case_sensitive: false }\n    validates :first_name, presence: true, length: { maximum: 51 }\n    validates :groupname, presence: true, length: { maximum: 51 }\n    validates :password, presence: true, length: { minimum: 6 }\n    has_secure_password\nend\n</code></pre>\n\n<p><strong>db schema</strong></p>\n\n<pre><code>  create_table \"users\", force: :cascade do |t|\n    t.string \"email\"\n    t.string \"password_digest\"\n    t.string \"first_name\"\n    t.string \"last_name\"\n    t.integer \"groupid\"\n    t.string \"groupname\"\n    t.datetime \"created_at\", null: false\n    t.datetime \"updated_at\", null: false\n    t.boolean \"admin\"\n    t.index [\"email\"], name: \"index_users_on_email\", unique: true\n  end\n</code></pre>\n\n<p>All in all my actual questions are:\nWHY am I getting a separate <code>users</code> param, WHY doesn't it include my password, and WHY can't I add the password to my <code>user_params</code>??</p>\n"}, {"tags": ["ruby", "watir"], "answers": [{"comments": [{"owner": {"reputation": 657, "user_id": 878462, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/b3646799a509c210896146ae54c60f18?s=128&d=identicon&r=PG", "display_name": "Antonio Bonifati &#39;Farmboy&#39;", "link": "https://stackoverflow.com/users/878462/antonio-bonifati-farmboy"}, "edited": false, "score": 0, "creation_date": 1517334531, "post_id": 48513334, "comment_id": 84050060, "body": "Yep, I&#39;ve tried this but it does not work or does not work anymore with latest firefox and chrome. Tried both and I still get the browser file-download pop-up. I am not doing TDD, just web scraping and so I need to actually get the file."}, {"owner": {"reputation": 3480, "user_id": 4072371, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/112e615d8c60908294e30848d9556186?s=128&d=identicon&r=PG", "display_name": "titusfortner", "link": "https://stackoverflow.com/users/4072371/titusfortner"}, "reply_to_user": {"reputation": 657, "user_id": 878462, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/b3646799a509c210896146ae54c60f18?s=128&d=identicon&r=PG", "display_name": "Antonio Bonifati &#39;Farmboy&#39;", "link": "https://stackoverflow.com/users/878462/antonio-bonifati-farmboy"}, "edited": false, "score": 0, "creation_date": 1518111908, "post_id": 48513334, "comment_id": 84381550, "body": "I&#39;m saying you might be better off bypassing the browser &amp; OS dialog box by doing something like this: <a href=\"https://stackoverflow.com/a/35609783/4072371\">stackoverflow.com/a/35609783/4072371</a> I&#39;m not sure what to say about this not working as several others have reported success with this setup. I&#39;m planning to put a lot of extra time into updating the configuration code in the next version of Watir, so I&#39;ll personally dig into this more soon."}], "tags": [], "owner": {"reputation": 3480, "user_id": 4072371, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/112e615d8c60908294e30848d9556186?s=128&d=identicon&r=PG", "display_name": "titusfortner", "link": "https://stackoverflow.com/users/4072371/titusfortner"}, "is_accepted": false, "score": 1, "last_activity_date": 1518090231, "last_edit_date": 1518090231, "creation_date": 1517282084, "answer_id": 48513334, "question_id": 48512832, "link": "https://stackoverflow.com/questions/48512832/automate-javascript-splash-downloads-in-ruby-watir/48513334#48513334", "title": "Automate javascript splash downloads in Ruby Watir", "body": "<p>The documentation for that is here now: <a href=\"http://watir.com/guides/downloads/\" rel=\"nofollow noreferrer\">http://watir.com/guides/downloads/</a></p>\n\n\n\n<pre><code>prefs = {\n  download: {\n    prompt_for_download: false,\n    default_directory: '/path/to/dir'\n  }\n}\n\nb = Watir::Browser.new :chrome, options: {prefs: prefs}\n</code></pre>\n\n<p>Best practice, though, is not to use Watir or Selenium to handle downloads. Ideally the creation of and access to the file is handled in a unit or integration test. Watir interacts with browsers, whereas downloads are partially an operating system function. This is to say that it may not be possible to do exactly what you need. </p>\n"}, {"tags": [], "owner": {"reputation": 98, "user_id": 1739660, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/qCu5N.jpg?s=128&g=1", "display_name": "niartseoj", "link": "https://stackoverflow.com/users/1739660/niartseoj"}, "is_accepted": false, "score": 0, "last_activity_date": 1518123763, "creation_date": 1518123763, "answer_id": 48694736, "question_id": 48512832, "link": "https://stackoverflow.com/questions/48512832/automate-javascript-splash-downloads-in-ruby-watir/48694736#48694736", "title": "Automate javascript splash downloads in Ruby Watir", "body": "<p>If was having a similar problem and I enable the logger.level it helped me to determine if the prefs were even being set for the \"chromeOptions\"</p>\n\n<pre><code>Selenium::WebDriver.logger.level = :info\n\nprefs = {\n        download: {\n            prompt_for_download: false,\n            default_directory: \"#{FigNewton.download_files}\"\n        }\n    }\n\nargs = ['--ignore-certificate-errors', '--disable-popup-blocking', '--disable-translate', '--disable-infobars']\n\nbrowser = Watir::Browser.new :chrome, options: {prefs: prefs, args: args }\n</code></pre>\n\n<p>I'm not saying this will resolve your issue, however just wanted to provide you the information about the logger.level. I find it helpful.</p>\n"}], "owner": {"reputation": 657, "user_id": 878462, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/b3646799a509c210896146ae54c60f18?s=128&d=identicon&r=PG", "display_name": "Antonio Bonifati &#39;Farmboy&#39;", "link": "https://stackoverflow.com/users/878462/antonio-bonifati-farmboy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 79, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1518123763, "creation_date": 1517278064, "question_id": 48512832, "link": "https://stackoverflow.com/questions/48512832/automate-javascript-splash-downloads-in-ruby-watir", "title": "Automate javascript splash downloads in Ruby Watir", "body": "<p>In case of a download initiated by Javascript (usually by some Javascript code that submits a form, which may be dynamically added to the page), none of the standard method for forcing a file download in Watir worked for me: I still get the browser file-download confirmation pop-up, which cannot be scripted in Watir. Worse, it looks like even conventional methods that worked when following a convential link to download a file, are now broken in newest browsers, please see this other question:\n  <a href=\"https://stackoverflow.com/questions/41192041/how-to-download-a-file-using-watir-6-0\">How to download a file using Watir 6.0</a></p>\n\n<p>Any suggestion on how to do it?</p>\n"}, {"tags": ["jquery", "ruby-on-rails", "ruby", "ajax"], "comments": [{"owner": {"reputation": 2946, "user_id": 1430057, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/Tbizp.jpg?s=128&g=1", "display_name": "Subash", "link": "https://stackoverflow.com/users/1430057/subash"}, "edited": false, "score": 0, "creation_date": 1517273498, "post_id": 48512288, "comment_id": 84019501, "body": "try to convert the data to string format using <code>JSON.stringify()</code> and see if that helps"}, {"owner": {"reputation": 473, "user_id": 4652341, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/32d243374ec979900e471874a9dc7ad9?s=128&d=identicon&r=PG&f=1", "display_name": "James N", "link": "https://stackoverflow.com/users/4652341/james-n"}, "reply_to_user": {"reputation": 2946, "user_id": 1430057, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/Tbizp.jpg?s=128&g=1", "display_name": "Subash", "link": "https://stackoverflow.com/users/1430057/subash"}, "edited": false, "score": 0, "creation_date": 1517274683, "post_id": 48512288, "comment_id": 84019774, "body": "@Subash thanks for the answer. I think a variation of this is needed (but i can&#39;t seem to find any docs to support that). In the <code>$.ajax</code> call, changing <code>data: data</code> to <code>data: JSON.stringify(data)</code> does add <code>prospects</code> to <code>params</code> but combines all of the data into 1 key. it outputs it malformed like this: <code>{&quot;{\\&quot;prospects\\&quot;:&quot;=&gt;{&quot;{},{}&quot;=&gt;{&quot;,\\&quot;user_id\\&quot;:\\&quot;950\\&quot;,\\&quot;team_&zwnj;&#8203;id\\&quot;:\\&quot;\\&quot;}&quot;=&gt;nil}}</code>. any suggestions? i&#39;m almost positive i&#39;ve done something like this before and it didn&#39;t require this level of effort to sanitize params (maybe different now because it&#39;s an array of objects)"}, {"owner": {"reputation": 2946, "user_id": 1430057, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/Tbizp.jpg?s=128&g=1", "display_name": "Subash", "link": "https://stackoverflow.com/users/1430057/subash"}, "edited": false, "score": 1, "creation_date": 1517274932, "post_id": 48512288, "comment_id": 84019834, "body": "what value does <code>prospects</code> hold?"}, {"owner": {"reputation": 473, "user_id": 4652341, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/32d243374ec979900e471874a9dc7ad9?s=128&d=identicon&r=PG&f=1", "display_name": "James N", "link": "https://stackoverflow.com/users/4652341/james-n"}, "reply_to_user": {"reputation": 2946, "user_id": 1430057, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/Tbizp.jpg?s=128&g=1", "display_name": "Subash", "link": "https://stackoverflow.com/users/1430057/subash"}, "edited": false, "score": 0, "creation_date": 1517275281, "post_id": 48512288, "comment_id": 84019907, "body": "@Subash in the example i provided above, <code>prospects</code> would be an array of JS objects."}, {"owner": {"reputation": 2946, "user_id": 1430057, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/Tbizp.jpg?s=128&g=1", "display_name": "Subash", "link": "https://stackoverflow.com/users/1430057/subash"}, "edited": false, "score": 0, "creation_date": 1517275833, "post_id": 48512288, "comment_id": 84020020, "body": "do those JS objects represent model objects, if yes then you can just pass in <code>ids</code> and retrieve them in the backend  to reduce the complexity"}, {"owner": {"reputation": 473, "user_id": 4652341, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/32d243374ec979900e471874a9dc7ad9?s=128&d=identicon&r=PG&f=1", "display_name": "James N", "link": "https://stackoverflow.com/users/4652341/james-n"}, "reply_to_user": {"reputation": 2946, "user_id": 1430057, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/Tbizp.jpg?s=128&g=1", "display_name": "Subash", "link": "https://stackoverflow.com/users/1430057/subash"}, "edited": false, "score": 0, "creation_date": 1517276038, "post_id": 48512288, "comment_id": 84020063, "body": "@Subash love that idea, but unfortunately they are not; they are pure JS objects coming from an API i&#39;m using"}, {"owner": {"reputation": 473, "user_id": 4652341, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/32d243374ec979900e471874a9dc7ad9?s=128&d=identicon&r=PG&f=1", "display_name": "James N", "link": "https://stackoverflow.com/users/4652341/james-n"}, "reply_to_user": {"reputation": 2946, "user_id": 1430057, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/Tbizp.jpg?s=128&g=1", "display_name": "Subash", "link": "https://stackoverflow.com/users/1430057/subash"}, "edited": false, "score": 0, "creation_date": 1517276792, "post_id": 48512288, "comment_id": 84020208, "body": "@Subash I was able to figure it out by taking my array of javascript objects, and calling <a href=\"http://api.jquery.com/jquery.param/\" rel=\"nofollow noreferrer\"><code>$.param(prospects)</code></a> on it before <code>$.ajax</code> submission. On rails I just called <code>JSON.parse(params[:prospects])</code> and its working fine for now"}, {"owner": {"reputation": 330, "user_id": 6482185, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-T11f0D1JFSw/AAAAAAAAAAI/AAAAAAAAAP0/6onfs__d2RE/photo.jpg?sz=128", "display_name": "Will Nguyen", "link": "https://stackoverflow.com/users/6482185/will-nguyen"}, "edited": false, "score": 0, "creation_date": 1517278430, "post_id": 48512288, "comment_id": 84020554, "body": "Why don&#39;t you sprint prospects above _self.sendData(prospects) line to check the value?"}], "answers": [{"tags": [], "owner": {"reputation": 23809, "user_id": 351909, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/71a6b8a36a63c2cb9de678c07be6d8a4?s=128&d=identicon&r=PG", "display_name": "moritz", "link": "https://stackoverflow.com/users/351909/moritz"}, "is_accepted": false, "score": 0, "last_activity_date": 1517307119, "creation_date": 1517307119, "answer_id": 48518828, "question_id": 48512288, "link": "https://stackoverflow.com/questions/48512288/ajax-rails-post-data-value-disappearing/48518828#48518828", "title": "ajax + rails - post data value disappearing", "body": "<p>Confusingly, the <code>dataType</code> option for <code>$.ajax</code> doesn't set the type of the data object. It sets the type of what is expected in the server response. Therefore, you have to add:</p>\n\n<pre><code>...\ndata: JSON.stringify({yada: 'yada'})\ncontentType: 'application/json'\n...\n</code></pre>\n\n<p>Rails will pick that up and give you what you expect via the <code>params</code> function.</p>\n\n<p>I hope that helps.</p>\n"}], "owner": {"reputation": 473, "user_id": 4652341, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/32d243374ec979900e471874a9dc7ad9?s=128&d=identicon&r=PG&f=1", "display_name": "James N", "link": "https://stackoverflow.com/users/4652341/james-n"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 77, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1517337623, "creation_date": 1517273265, "last_edit_date": 1517337623, "question_id": 48512288, "link": "https://stackoverflow.com/questions/48512288/ajax-rails-post-data-value-disappearing", "title": "ajax + rails - post data value disappearing", "body": "<p>I am working on a rails app. I have some JS data i'm sending to rails. The problem is, one of my values in my ajax request is not present in rails' <code>params</code> by the time it makes it from the JS to the controller. </p>\n\n<p>First, what's triggering it is this top level </p>\n\n<pre><code>if (prospects.length &gt; 0) {\n  _self.sendData(prospects);\n} else {\n  alert('must submit more than 1 prospect');\n}\n</code></pre>\n\n<p>that function looks like this</p>\n\n<pre><code>sendData: function(prospects) {\n    var prospects = prospects;\n    var user_id = $('#user_id').val();\n    var team_id = $('#team_id').val();\n\n    var data = {\n      prospects: prospects,\n      user_id: user_id,\n      team_id: team_id\n    }\n\n    // data looks like (from chrome console)\n   // {prospects: Array(2), user_id: \"950\", team_id: \"\"}    \n\n    $.ajax({\n      url: '/path/to/url/',\n      type: 'PUT',\n      dataType: 'json',\n      data: data,\n      success: function(data) {\n        console.log('success from sendData!');\n        console.log(data);\n      },\n      error: function(error) {\n        console.log('error from sendData');\n        console.log(error);\n      }\n    });\n  }\n</code></pre>\n\n<p>In this function above, I see all of my values present. So next, is the rails controller</p>\n\n<pre><code>def process\n    p '*' * 100\n    p params\n    p '*' * 100\nend\n</code></pre>\n\n<p>the output of these <code>p</code> statements are\n\"****************************************************************************************************\"\n{\"user_id\"=>\"950\", \"team_id\"=>\"\", \"action\"=>\"method_name\", \"controller\"=>\"name/of/controller\"}\n\"****************************************************************************************************\"</p>\n\n<p>As you can see, <code>params[:prospects]</code> is nil! I do not see my mistake and have no idea why that value isn't making it to the controller. </p>\n\n<p>Does anyone see why <code>params[:prospects]</code> isn't present?</p>\n\n<p><strong>UPDATE</strong></p>\n\n<p>I was able to get it working by wrapping the <code>$.ajax</code> data inside of jQuery's <a href=\"http://api.jquery.com/jquery.param/\" rel=\"nofollow noreferrer\"><code>$.param()</code></a> function. My working function looks like this</p>\n\n<pre><code>sendData: function(prospects) {\n        var prospects = prospects;\n        var user_id = $('#user_id').val();\n        var team_id = $('#team_id').val();\n\n        var data = {\n          prospects: prospects,\n          user_id: user_id,\n          team_id: team_id\n        }\n\n        var json_data = $.param(data);  \n\n        $.ajax({\n          url: '/path/to/url/',\n          type: 'PUT',\n          dataType: 'json',\n          data: json_data,\n          success: function(data) {\n            console.log('success from sendData!');\n            console.log(data);\n          },\n          error: function(error) {\n            console.log('error from sendData');\n            console.log(error);\n          }\n        });\n      }\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby"], "answers": [{"comments": [{"owner": {"reputation": 107, "user_id": 2648619, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8tmab.jpg?s=128&g=1", "display_name": "elroyalva", "link": "https://stackoverflow.com/users/2648619/elroyalva"}, "edited": false, "score": 0, "creation_date": 1517337463, "post_id": 48512687, "comment_id": 84051622, "body": "I am not actually using <code>Rails 5</code> so that may be an issue. I see a few other options in the comments there that I may try out. I&#39;ll update the OP when I have progress. In the mean time, v 2.0.0 works good enough"}], "tags": [], "owner": {"reputation": 1196, "user_id": 8426717, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-QwYD3zUWkhA/AAAAAAAAAAI/AAAAAAAABJs/2y8hDOo4fYY/photo.jpg?sz=128", "display_name": "Tai", "link": "https://stackoverflow.com/users/8426717/tai"}, "is_accepted": false, "score": 2, "last_activity_date": 1517276880, "creation_date": 1517276880, "answer_id": 48512687, "question_id": 48512273, "link": "https://stackoverflow.com/questions/48512273/how-do-i-run-the-rails-web-console-in-production/48512687#48512687", "title": "How do I run the rails web-console in production?", "body": "<p>You encountered the same issue here: <a href=\"https://github.com/rails/web-console/issues/204\" rel=\"nofollow noreferrer\">https://github.com/rails/web-console/issues/204</a>. Upgrade <code>web-console</code> to <code>3.4.0</code> may help to resolve the problem.</p>\n"}, {"tags": [], "owner": {"reputation": 107, "user_id": 2648619, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8tmab.jpg?s=128&g=1", "display_name": "elroyalva", "link": "https://stackoverflow.com/users/2648619/elroyalva"}, "is_accepted": true, "score": 1, "last_activity_date": 1517534883, "creation_date": 1517534883, "answer_id": 48574395, "question_id": 48512273, "link": "https://stackoverflow.com/questions/48512273/how-do-i-run-the-rails-web-console-in-production/48574395#48574395", "title": "How do I run the rails web-console in production?", "body": "<p>UPDATE:</p>\n\n<p>I found a solution to the problem. It has something to do with how the gem handles logging. I am still not sure why it works in development and not in production though. Here is what I did to get it to work</p>\n\n<p>I added the following code to config/initializers/web_console.rb</p>\n\n<pre><code>WebConsole::View.class_eval do\n  def render(*)\n    super\n  end\nend\n</code></pre>\n\n<p>Essentially, I've overridden the render(*) method located at <a href=\"https://github.com/rails/web-console/commit/4ba9f5044f9322ea16f97e69b7167170c9c34522\" rel=\"nofollow noreferrer\">https://github.com/rails/web-console/commit/4ba9f5044f9322ea16f97e69b7167170c9c34522</a></p>\n\n<p>Thanks for the help everyone</p>\n"}], "owner": {"reputation": 107, "user_id": 2648619, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8tmab.jpg?s=128&g=1", "display_name": "elroyalva", "link": "https://stackoverflow.com/users/2648619/elroyalva"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1653, "favorite_count": 0, "accepted_answer_id": 48574395, "answer_count": 2, "score": 2, "last_activity_date": 1517534883, "creation_date": 1517273124, "last_edit_date": 1517358045, "question_id": 48512273, "link": "https://stackoverflow.com/questions/48512273/how-do-i-run-the-rails-web-console-in-production", "title": "How do I run the rails web-console in production?", "body": "<p>I am trying to run the rails web-console from <a href=\"https://github.com/rails/web-console\" rel=\"nofollow noreferrer\">https://github.com/rails/web-console</a> in production. I know there are warnings against doing this, but the app where I intend to use it is internal and not accessible in production.</p>\n\n<p>Configurations I've used:</p>\n\n<p><code>config.web_console.development_only = false\nconfig.web_console.whitelisted_ips = %w(&lt;IPs that should have permission&gt;)</code></p>\n\n<p>So the console ends up working perfectly in development and test, but fails with a very weird error in production.</p>\n\n<pre><code>ArgumentError: wrong number of arguments (given 0, expected 1)\n    from /Users/someuser/.rvm/gems/ruby-2.3.1/gems/activesupport-4.2.3/lib/active_support/core_ext/kernel/reporting.rb:89:in `capture`\n    from /Users/someuser/.rvm/gems/ruby-2.3.1/gems/web-console-3.3.0/lib/web_console/view.rb:34:in `render`\n    from /Users/someuser/.rvm/gems/ruby-2.3.1/gems/web-console-3.3.0/lib/web_console/template.rb:20:in `render`\n    from /Users/someuser/.rvm/gems/ruby-2.3.1/gems/web-console-3.3.0/lib/web_console/middleware.rb:36:in `block in call`\n    from /Users/someuser/.rvm/gems/ruby-2.3.1/gems/web-console-3.3.0/lib/web_console/middleware.rb:18:in `catch`\n    from /Users/someuser/.rvm/gems/ruby-2.3.1/gems/web-console-3.3.0/lib/web_console/middleware.rb:18:in `call`\n    from /Users/someuser/.rvm/gems/ruby-2.3.1/gems/actionpack-4.2.3/lib/action_dispatch/middleware/show_exceptions.rb:30:in `call`\n    from /Users/someuser/.rvm/gems/ruby-2.3.1/gems/railties-4.2.3/lib/rails/rack/logger.rb:38:in `call_app`\n    from /Users/someuser/.rvm/gems/ruby-2.3.1/gems/railties-4.2.3/lib/rails/rack/logger.rb:20:in `block in call`\n    from /Users/someuser/.rvm/gems/ruby-2.3.1/gems/activesupport-4.2.3/lib/active_support/tagged_logging.rb:68:in `block in tagged`\n    from /Users/someuser/.rvm/gems/ruby-2.3.1/gems/activesupport-4.2.3/lib/active_support/tagged_logging.rb:26:in `tagged`\n    from /Users/someuser/.rvm/gems/ruby-2.3.1/gems/activesupport-4.2.3/lib/active_support/tagged_logging.rb:68:in `tagged`\n    from /Users/someuser/.rvm/gems/ruby-2.3.1/gems/railties-4.2.3/lib/rails/rack/logger.rb:20:in `call`\n    from /Users/someuser/.rvm/gems/ruby-2.3.1/gems/actionpack-4.2.3/lib/action_dispatch/middleware/request_id.rb:21:in `call`\n    from /Users/someuser/.rvm/gems/ruby-2.3.1/gems/rack-1.6.4/lib/rack/methodoverride.rb:22:in `call`\n    from /Users/someuser/.rvm/gems/ruby-2.3.1/gems/rack-1.6.4/lib/rack/runtime.rb:18:in `call`\n    from /Users/someuser/.rvm/gems/ruby-2.3.1/gems/activesupport-4.2.3/lib/active_support/cache/strategy/local_cache_middleware.rb:28:in `call`\n    from /Users/someuser/.rvm/gems/ruby-2.3.1/gems/actionpack-4.2.3/lib/action_dispatch/middleware/static.rb:116:in `call`\n    from /Users/someuser/.rvm/gems/ruby-2.3.1/gems/rack-1.6.4/lib/rack/sendfile.rb:113:in `call`\n    from /Users/someuser/.rvm/gems/ruby-2.3.1/gems/railties-4.2.3/lib/rails/engine.rb:518:in `call`\n    from /Users/someuser/.rvm/gems/ruby-2.3.1/gems/railties-4.2.3/lib/rails/application.rb:165:in `call`\n    from /Users/someuser/.rvm/gems/ruby-2.3.1/gems/rack-1.6.4/lib/rack/lock.rb:17:in `call`\n    from /Users/someuser/.rvm/gems/ruby-2.3.1/gems/rack-1.6.4/lib/rack/content_length.rb:15:in `call`\n    from /Users/someuser/.rvm/gems/ruby-2.3.1/gems/rack-1.6.4/lib/rack/handler/webrick.rb:88:in `service`\n    from /Users/someuser/.rvm/rubies/ruby-2.3.1/lib/ruby/2.3.0/webrick/httpserver.rb:140:in `service`\n    from /Users/someuser/.rvm/rubies/ruby-2.3.1/lib/ruby/2.3.0/webrick/httpserver.rb:96:in `run`\n    from /Users/someuser/.rvm/rubies/ruby-2.3.1/lib/ruby/2.3.0/webrick/server.rb:296:in `block in start_thread`\n</code></pre>\n\n<p>Can I modify the gem somehow to make it work? Or is there a workaround?</p>\n\n<p>Ruby: v2.3.1\nRails: v4.2.1\nweb-console: v3.3.0</p>\n\n<p>Thank you</p>\n\n<p>UPDATE:</p>\n\n<p>I found a solution to the problem. It has something to do with how the gem handles logging. I am still not sure why it works in development and not in production though. Here is what I did to get it to work</p>\n\n<p>I added the following code to config/initializers/web_console.rb</p>\n\n<pre><code>WebConsole::View.class_eval do\n  def render(*)\n    super\n  end\nend\n</code></pre>\n\n<p>Essentially, I've overridden the <code>render(*)</code> method located at <a href=\"https://github.com/rails/web-console/commit/4ba9f5044f9322ea16f97e69b7167170c9c34522\" rel=\"nofollow noreferrer\">https://github.com/rails/web-console/commit/4ba9f5044f9322ea16f97e69b7167170c9c34522</a></p>\n\n<p>Thanks for the help everyone</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "rspec", "rake"], "comments": [{"owner": {"reputation": 25268, "user_id": 215168, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/212c9d7980fe9aa71739313d483b3782?s=128&d=identicon&r=PG", "display_name": "Abe Voelker", "link": "https://stackoverflow.com/users/215168/abe-voelker"}, "edited": false, "score": 0, "creation_date": 1517280213, "post_id": 48512097, "comment_id": 84020942, "body": "Perhaps it&#39;s not rspec calling <code>last_comment</code> now? Can you produce a longer stack trace?"}, {"owner": {"reputation": 21, "user_id": 9286258, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/03dbebb636b4a9c11cffc5105dafd2e0?s=128&d=identicon&r=PG&f=1", "display_name": "magnanimus1994", "link": "https://stackoverflow.com/users/9286258/magnanimus1994"}, "reply_to_user": {"reputation": 25268, "user_id": 215168, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/212c9d7980fe9aa71739313d483b3782?s=128&d=identicon&r=PG", "display_name": "Abe Voelker", "link": "https://stackoverflow.com/users/215168/abe-voelker"}, "edited": false, "score": 0, "creation_date": 1517288073, "post_id": 48512097, "comment_id": 84022787, "body": "Updated with the trace"}, {"owner": {"reputation": 25268, "user_id": 215168, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/212c9d7980fe9aa71739313d483b3782?s=128&d=identicon&r=PG", "display_name": "Abe Voelker", "link": "https://stackoverflow.com/users/215168/abe-voelker"}, "edited": false, "score": 2, "creation_date": 1517290383, "post_id": 48512097, "comment_id": 84023470, "body": "<code>rspec-core-2.99.2</code> would indicate you&#39;re using rspec 2.99.2... perhaps you&#39;re using system gems instead of bundler? What happens if you do <code>bundle exec rake</code>? And <code>bundle show rspec-rails</code>?"}, {"owner": {"reputation": 21, "user_id": 9286258, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/03dbebb636b4a9c11cffc5105dafd2e0?s=128&d=identicon&r=PG&f=1", "display_name": "magnanimus1994", "link": "https://stackoverflow.com/users/9286258/magnanimus1994"}, "reply_to_user": {"reputation": 25268, "user_id": 215168, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/212c9d7980fe9aa71739313d483b3782?s=128&d=identicon&r=PG", "display_name": "Abe Voelker", "link": "https://stackoverflow.com/users/215168/abe-voelker"}, "edited": false, "score": 0, "creation_date": 1517319709, "post_id": 48512097, "comment_id": 84040277, "body": "Updated with this information"}, {"owner": {"reputation": 25268, "user_id": 215168, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/212c9d7980fe9aa71739313d483b3782?s=128&d=identicon&r=PG", "display_name": "Abe Voelker", "link": "https://stackoverflow.com/users/215168/abe-voelker"}, "edited": false, "score": 0, "creation_date": 1517326929, "post_id": 48512097, "comment_id": 84045372, "body": "<code>bundle exec rake</code> is what you want to get working - do you have a longer stack trace for that error? And does just bare <code>bundle</code> work okay (can you share the output?)? I would guess some other gem is doing <code>gem &#39;rspec&#39;, &#39;~&gt; 2&#39;</code> at runtime; whatever gem that is will have to be upgraded"}, {"owner": {"reputation": 21, "user_id": 9286258, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/03dbebb636b4a9c11cffc5105dafd2e0?s=128&d=identicon&r=PG&f=1", "display_name": "magnanimus1994", "link": "https://stackoverflow.com/users/9286258/magnanimus1994"}, "reply_to_user": {"reputation": 25268, "user_id": 215168, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/212c9d7980fe9aa71739313d483b3782?s=128&d=identicon&r=PG", "display_name": "Abe Voelker", "link": "https://stackoverflow.com/users/215168/abe-voelker"}, "edited": false, "score": 0, "creation_date": 1517348695, "post_id": 48512097, "comment_id": 84057470, "body": "I&#39;ve added the <code>bundle</code> output - all the versions are the same as when I just do <code>rspec --version</code>, except <code>rspec-rails</code> is missing. Any idea why it&#39;s not there?"}, {"owner": {"reputation": 21, "user_id": 9286258, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/03dbebb636b4a9c11cffc5105dafd2e0?s=128&d=identicon&r=PG&f=1", "display_name": "magnanimus1994", "link": "https://stackoverflow.com/users/9286258/magnanimus1994"}, "reply_to_user": {"reputation": 25268, "user_id": 215168, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/212c9d7980fe9aa71739313d483b3782?s=128&d=identicon&r=PG", "display_name": "Abe Voelker", "link": "https://stackoverflow.com/users/215168/abe-voelker"}, "edited": false, "score": 0, "creation_date": 1517348726, "post_id": 48512097, "comment_id": 84057492, "body": "I&#39;ve also included the bundle trace."}, {"owner": {"reputation": 25268, "user_id": 215168, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/212c9d7980fe9aa71739313d483b3782?s=128&d=identicon&r=PG", "display_name": "Abe Voelker", "link": "https://stackoverflow.com/users/215168/abe-voelker"}, "edited": false, "score": 0, "creation_date": 1517353300, "post_id": 48512097, "comment_id": 84059378, "body": "Ah if this is for a Rails app you should delete <code>gem &quot;rspec&quot;, &#39;&gt;= 3.7&#39;</code> from your Gemfile and replace it with <code>gem &quot;rspec-rails&quot;</code>. Then execute <code>bundle</code> to install it, then <code>bundle exec rake</code> to run rake. That might fix it."}], "answers": [{"tags": [], "owner": {"reputation": 21, "user_id": 9286258, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/03dbebb636b4a9c11cffc5105dafd2e0?s=128&d=identicon&r=PG&f=1", "display_name": "magnanimus1994", "link": "https://stackoverflow.com/users/9286258/magnanimus1994"}, "is_accepted": false, "score": 0, "last_activity_date": 1517578475, "creation_date": 1517578475, "answer_id": 48583838, "question_id": 48512097, "link": "https://stackoverflow.com/questions/48512097/rake-12-3-still-produces-nomethoderror-undefined-method-last-comment/48583838#48583838", "title": "Rake 12.3 still produces NoMethodError: undefined method &#39;last_comment&#39;", "body": "<p>Finally figured this out: the Rakefile specified <code>rspec ~&gt; 2.9</code>. Just deleted the version number, bundle updated <code>rspec</code> to 3.7, and everything ran smoothly.</p>\n"}], "owner": {"reputation": 21, "user_id": 9286258, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/03dbebb636b4a9c11cffc5105dafd2e0?s=128&d=identicon&r=PG&f=1", "display_name": "magnanimus1994", "link": "https://stackoverflow.com/users/9286258/magnanimus1994"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 851, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1517578475, "creation_date": 1517271627, "last_edit_date": 1517348403, "question_id": 48512097, "link": "https://stackoverflow.com/questions/48512097/rake-12-3-still-produces-nomethoderror-undefined-method-last-comment", "title": "Rake 12.3 still produces NoMethodError: undefined method &#39;last_comment&#39;", "body": "<p><a href=\"https://stackoverflow.com/questions/35893584/nomethoderror-undefined-method-last-comment-after-upgrading-to-rake-11\">NoMethodError: undefined method `last_comment&#39; after upgrading to rake 11</a></p>\n\n<p>I have been encountering the problem described in the thread above. To recap, running <code>rake</code> produces the following error:</p>\n\n<pre><code>NoMethodError: undefined method `last_comment' for #&lt;Rake::Application:0x00000002b15ba0&gt;\n</code></pre>\n\n<p>The consensus in the thread above is that the 'last_comment' method is deprecated in <code>rake 11</code> (replaced by 'last_description'). </p>\n\n<p>The answers claim the solution is to either pin <code>rake</code> to version 10.5 in the Gemfile, which still calls 'last_comment', or upgrade to <code>rake 12</code> and <code>rspec &gt;3.5</code>, where the dependency has been resolved. I've tried both solutions, and I still get the same error.</p>\n\n<p><strong>Update</strong>\nThe <code>bundle exec</code> trace suggests that <code>rake</code> is using the system gem for <code>rspec</code>, which is only 2.9. How do I either upgrade the system gem or get the bundler to recognize the version I've specified in my gem path?</p>\n\n<p><strong>Gemfile</strong></p>\n\n<pre><code>gem \"rake\"\ngem \"rspec\", '&gt;= 3.7'\n</code></pre>\n\n<p><strong>Gemfile.lock</strong></p>\n\n<pre><code>GEM\n\nremote: https://rubygems.org/\n  specs:\n    diff-lcs (1.3)\n    rake (12.3.0)\n    rspec (3.7.0)\n      rspec-core (~&gt; 3.7.0)\n      rspec-expectations (~&gt; 3.7.0)\n      rspec-mocks (~&gt; 3.7.0)\n    rspec-core (3.7.1)\n      rspec-support (~&gt; 3.7.0)\n    rspec-expectations (3.7.0)\n      diff-lcs (&gt;= 1.2.0, &lt; 2.0)\n      rspec-support (~&gt; 3.7.0)\n    rspec-mocks (3.7.0)\n      diff-lcs (&gt;= 1.2.0, &lt; 2.0)\n      rspec-support (~&gt; 3.7.0)\n    rspec-support (3.7.1)\n\nPLATFORMS\n  ruby\n\nDEPENDENCIES\n  rake\n  rspec (&gt;= 3.7)\n\nBUNDLED WITH\n   1.16.1  \n</code></pre>\n\n<p><strong>Versions</strong></p>\n\n<pre><code>ruby 2.3.1\nRails 4.2.6\nrake, version 12.3.0\nRSpec 3.7\n  - rspec-core 3.7.1\n  - rspec-expectations 3.7.0\n  - rspec-mocks 3.7.0\n  - rspec-rails 3.7.2\n  - rspec-support 3.7.0\n</code></pre>\n\n<p><strong>Traces</strong></p>\n\n<p>When I run <code>rake</code>:</p>\n\n<pre><code>/var/lib/gems/2.3.0/gems/rspec-core-2.99.2/lib/rspec/core/rake_task.rb:143:in `initialize'\n/home/alexander/Documents/Coding/Ruby/learn_ruby/Rakefile:8:in `new'\n/home/alexander/Documents/Coding/Ruby/learn_ruby/Rakefile:8:in `&lt;top (required)&gt;'\n/var/lib/gems/2.3.0/gems/rake-12.3.0/lib/rake/rake_module.rb:29:in `load'\n/var/lib/gems/2.3.0/gems/rake-12.3.0/lib/rake/rake_module.rb:29:in `load_rakefile'\n/var/lib/gems/2.3.0/gems/rake-12.3.0/lib/rake/application.rb:703:in `raw_load_rakefile'\n/var/lib/gems/2.3.0/gems/rake-12.3.0/lib/rake/application.rb:104:in `block in load_rakefile'\n/var/lib/gems/2.3.0/gems/rake-12.3.0/lib/rake/application.rb:186:in `standard_exception_handling'\n/var/lib/gems/2.3.0/gems/rake-12.3.0/lib/rake/application.rb:103:in `load_rakefile'\n/var/lib/gems/2.3.0/gems/rake-12.3.0/lib/rake/application.rb:82:in `block in run'\n/var/lib/gems/2.3.0/gems/rake-12.3.0/lib/rake/application.rb:186:in `standard_exception_handling'\n/var/lib/gems/2.3.0/gems/rake-12.3.0/lib/rake/application.rb:80:in `run'\n/var/lib/gems/2.3.0/gems/rake-12.3.0/exe/rake:27:in `&lt;top (required)&gt;'\n/usr/local/bin/rake:23:in `load'\n/usr/local/bin/rake:23:in `&lt;main&gt;'\n</code></pre>\n\n<p>When I run <code>bundle exec rake</code>:</p>\n\n<pre><code>Gem::LoadError: can't activate rspec (~&gt; 2), already activated rspec-3.7.0. Make sure all dependencies are added to Gemfile.\n/var/lib/gems/2.3.0/gems/bundler-1.16.1/lib/bundler/rubygems_integration.rb:404:in `block (2 levels) in replace_gem'\n/home/alexander/Documents/Coding/Ruby/learn_ruby/Rakefile:2:in `&lt;top (required)&gt;'\n/var/lib/gems/2.3.0/gems/rake-12.3.0/lib/rake/rake_module.rb:29:in `load'\n/var/lib/gems/2.3.0/gems/rake-12.3.0/lib/rake/rake_module.rb:29:in `load_rakefile'\n/var/lib/gems/2.3.0/gems/rake-12.3.0/lib/rake/application.rb:703:in `raw_load_rakefile'\n/var/lib/gems/2.3.0/gems/rake-12.3.0/lib/rake/application.rb:104:in `block in load_rakefile'\n/var/lib/gems/2.3.0/gems/rake-12.3.0/lib/rake/application.rb:186:in `standard_exception_handling'\n/var/lib/gems/2.3.0/gems/rake-12.3.0/lib/rake/application.rb:103:in `load_rakefile'\n/var/lib/gems/2.3.0/gems/rake-12.3.0/lib/rake/application.rb:82:in `block in run'\n/var/lib/gems/2.3.0/gems/rake-12.3.0/lib/rake/application.rb:186:in `standard_exception_handling'\n/var/lib/gems/2.3.0/gems/rake-12.3.0/lib/rake/application.rb:80:in `run'\n/var/lib/gems/2.3.0/gems/rake-12.3.0/exe/rake:27:in `&lt;top (required)&gt;'\n/usr/local/bin/rake:23:in `load'\n/usr/local/bin/rake:23:in `&lt;main&gt;'\n</code></pre>\n\n<p>When I just run <code>bundle</code>:</p>\n\n<pre><code>Using rake 12.3.0\nUsing bundler 1.16.1\nUsing diff-lcs 1.3\nUsing rspec-support 3.7.1\nUsing rspec-core 3.7.1\nUsing rspec-expectations 3.7.0\nUsing rspec-mocks 3.7.0\nUsing rspec 3.7.0\n</code></pre>\n\n<p>When I run <code>bundle show rspec-rails</code>, it says that it could not find the gem.</p>\n"}, {"tags": ["ruby", "loops"], "answers": [{"comments": [{"owner": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "edited": false, "score": 0, "creation_date": 1517274713, "post_id": 48512390, "comment_id": 84019785, "body": "That <code>inject</code> couldn&#39;t be replaced by <code>each_with_index</code> to avoid returning the memo object?, the <code>reject</code> for <code>each</code>?"}, {"owner": {"reputation": 4600, "user_id": 5961578, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/df7cbfdd2a92a7926af3bbb8648318aa?s=128&d=identicon&r=PG", "display_name": "moveson", "link": "https://stackoverflow.com/users/5961578/moveson"}, "reply_to_user": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "edited": false, "score": 0, "creation_date": 1517275706, "post_id": 48512390, "comment_id": 84019994, "body": "@SebastianPalma Perhaps it could, but <a href=\"https://stackoverflow.com/a/3852809/5961578\">per the comment line</a>, it&#39;s not even my code. I just needed a way to take the difference between two Arrays without losing the duplicates. However, note that this method needs to work regardless of index, so I can&#39;t think of an <code>each_with_index</code> solution off the top of my head."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1517285552, "post_id": 48512390, "comment_id": 84022183, "body": "I was especially interested in your reference to the 2010 SO answer that used <code>array_difference</code>. Though I had not seen that answer, a couple of years ago <a href=\"https://bugs.ruby-lang.org/issues/11815\" rel=\"nofollow noreferrer\">I proposed that the same method be added to the Ruby core</a>. Curiously, we used the same name (<code>difference</code>) and implemented it in essentially the same way. There has been something less than a groundswell of support for my proposal, but I still think it would be a useful addition. Also, nice answer!"}, {"owner": {"reputation": 1, "user_id": 7273824, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0cea2cdebae725fdd749ff88c25871d9?s=128&d=identicon&r=PG&f=1", "display_name": "Jackie Fahmy", "link": "https://stackoverflow.com/users/7273824/jackie-fahmy"}, "edited": false, "score": 0, "creation_date": 1518779137, "post_id": 48512390, "comment_id": 84654328, "body": "Thanks! This was super helpful."}], "tags": [], "owner": {"reputation": 4600, "user_id": 5961578, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/df7cbfdd2a92a7926af3bbb8648318aa?s=128&d=identicon&r=PG", "display_name": "moveson", "link": "https://stackoverflow.com/users/5961578/moveson"}, "is_accepted": false, "score": 2, "last_activity_date": 1517274916, "last_edit_date": 1517274916, "creation_date": 1517274322, "answer_id": 48512390, "question_id": 48512044, "link": "https://stackoverflow.com/questions/48512044/how-to-find-count-matching-characters-at-the-same-indes-and-at-an-unmatching-ind/48512390#48512390", "title": "How to find count matching characters at the same indes and at an unmatching index", "body": "<p>Here's a clean Ruby solution, written in idiomatic Ruby object-oriented style:</p>\n\n<pre><code>class Mastermind\n  def initialize(input_array, sequence_array)\n    @input_array = input_array\n    @sequence_array = sequence_array\n  end\n\n  def matches\n    [index_matches, other_matches]\n  end\n\n  def results\n    [index_matches.size, other_matches.size]\n  end\n\n  private\n\n  attr_reader :input_array, :sequence_array\n\n  def index_matches\n    input_array.select.with_index { |e, i| e == sequence_array[i] }\n  end\n\n  def other_matches\n    non_exact_input &amp; non_exact_sequence\n  end\n\n  def non_exact_input\n    array_difference(input_array, index_matches)\n  end\n\n  def non_exact_sequence\n    array_difference(sequence_array, index_matches)\n  end\n\n  # This method is based on https://stackoverflow.com/a/3852809/5961578\n  def array_difference(array_1, array_2)\n    counts = array_2.inject(Hash.new(0)) { |h, v| h[v] += 1; h }\n    array_1.reject { |e| counts[e] -= 1 unless counts[e].zero? }\n  end\nend\n</code></pre>\n\n<p>You would use this class as follows:</p>\n\n<pre><code>&gt;&gt; input_array = [\"G\",\"G\",\"G\",\"Y\"]\n&gt;&gt; sequence_array = [\"G\", \"Y\",\"G\",\"G\"]\n&gt;&gt; guess = Mastermind.new(input_array, sequence_array)\n&gt;&gt; guess.results\n#&gt; [2, 2]\n&gt;&gt; guess.matches\n#&gt; [[\"G\", \"G\"], [\"G\", \"Y\"]]\n</code></pre>\n\n<p>Here's how it works. First everything goes into a class called Mastermind. We create a constructor for the class (which in Ruby is a method called <code>initialize</code>) and we have it accept two arguments: input array (the user guess), and sequence array (the answer).</p>\n\n<p>We set each of these arguments to an instance variable, which is indicated by its beginning with <code>@</code>. Then we use <code>attr_reader</code> to create getter methods for <code>@input_array</code> and <code>@sequence_array</code>, which allows us to get the values by calling <code>input_array</code> and <code>sequence_array</code> from any instance method within the class.</p>\n\n<p>We then define two public methods: <code>matches</code> (which returns an array of exact matches and an array of other matches (the ones that match but at the wrong index), and <code>results</code> (which returns a count of each of these two arrays).</p>\n\n<p>Now, within the <code>private</code> portion of our class, we can define the guts of the logic. Each method has a specific job, and each is named to (hopefully) help a reader understand what it is doing.</p>\n\n<p><code>index_matches</code> returns a subset of the input_array whose elements match the sequence_array exactly.</p>\n\n<p><code>other_matches</code> returns a subset of the input_array whose elements do not match the sequence_array exactly, but do match at the wrong index.</p>\n\n<p><code>other_matches</code> relies on <code>non_exact_input</code> and <code>non_exact_sequence</code>, each of which is computed using the <code>array_difference</code> method, which I copied from another SO answer. (There is no convenient Ruby method that allows us to subtract one array from another without deleting duplicates).</p>\n"}, {"tags": [], "owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "is_accepted": false, "score": 1, "last_activity_date": 1517314900, "last_edit_date": 1517314900, "creation_date": 1517285052, "answer_id": 48513712, "question_id": 48512044, "link": "https://stackoverflow.com/questions/48512044/how-to-find-count-matching-characters-at-the-same-indes-and-at-an-unmatching-ind/48513712#48513712", "title": "How to find count matching characters at the same indes and at an unmatching index", "body": "<p><strong>Code</strong></p>\n\n<pre><code>def matches(hidden, guess)\n  indices_wo_match = hidden.each_index.reject { |i| hidden[i] == guess[i] }\n  hidden_counts = counting_hash(hidden.values_at *indices_wo_match)\n  guess_counts = counting_hash(guess.values_at *indices_wo_match)\n  [hidden.size - indices_wo_match.size, guess_counts.reduce(0) { |tot, (k, cnt)|\n    tot + [hidden_counts[k], cnt].min }]\nend\n\ndef counting_hash(arr)\n  arr.each_with_object(Hash.new(0)) { |s, h| h[s] += 1 }\nend\n</code></pre>\n\n<p><strong>Examples</strong></p>\n\n<pre><code>matches [\"G\",\"G\",\"G\",\"Y\"], [\"G\", \"Y\",\"G\",\"G\"]\n  #=&gt; [2, 2]\nmatches [\"X\",\"R\",\"Y\",\"T\"] , [\"T\",\"T\",\"Y\",\"Y\"]\n  #=&gt; [1, 1]\n</code></pre>\n\n<p><strong>Explanation</strong></p>\n\n<p>The steps are as follows.</p>\n\n<pre><code>hidden = [\"G\",\"G\",\"G\",\"Y\"]\nguess = [\"G\", \"Y\",\"G\",\"G\"]\n</code></pre>\n\n<p>Save the indices <code>i</code> for which <code>hidden[i] != guess[i]</code>.</p>\n\n<pre><code>indices_wo_match = hidden.each_index.reject { |i| hidden[i] == guess[i] }\n  #=&gt; [1, 3]\n</code></pre>\n\n<p>Note that the number of indices for which the values are equal is as follows.</p>\n\n<pre><code>hidden.size - indices_wo_match.size\n  #=&gt; 2\n</code></pre>\n\n<p>Now compute the numbers of remaining elements of <code>guess</code> that pair with one of the remaining values of <code>hidden</code> by having the same value. Begin by counting the numbers of instances of each unique element of <code>hidden</code> and then do the same for <code>guess</code>.</p>\n\n<pre><code>hidden_counts = counting_hash(hidden.values_at *indices_wo_match)\n  #=&gt; {\"G\"=&gt;1, \"Y\"=&gt;1}\nguess_counts = counting_hash(guess.values_at *indices_wo_match)\n  #=&gt; {\"Y\"=&gt;1, \"G\"=&gt;1}\n</code></pre>\n\n<p>To understand how <code>counting_hash</code> works, see <a href=\"http://ruby-doc.org/core-2.4.0/Hash.html#method-c-new\" rel=\"nofollow noreferrer\">Hash::new</a>, especially the explanation of the effect of providing a <em>default value</em> as an argument of <code>new</code>. In brief, if a hash is defined <code>h = Hash.new(3)</code>, then if <code>h</code> does not have a key <code>k</code>, <code>h[k]</code> returns the default value, here <code>3</code> (the hash is not changed).</p>\n\n<p>Now compute the numbers of matches of elements of <code>guess</code> that were not equal to the value of <code>hidden</code> at the same index and which pair with an element of <code>hidden</code> that have the same value.</p>\n\n<pre><code>val_matches = guess_counts.reduce(0) do |tot, (k, cnt)|\n  tot + [hidden_counts[k], cnt].min\nend\n  #=&gt; 2\n</code></pre>\n\n<p>Lastly, return the values of interest.</p>\n\n<pre><code>[hidden.size - indices_wo_match.size, val_matches]\n  #=&gt; [2, 2]\n</code></pre>\n\n<p>In the code presented above I have substituted out the variable <code>val_matches</code>.</p>\n\n<p>With Ruby 2.4+ one can use <a href=\"http://ruby-doc.org/core-2.4.0/Enumerable.html#method-i-sum\" rel=\"nofollow noreferrer\">Enumerable#sum</a> to replace</p>\n\n<pre><code>guess_counts.reduce(0) { |tot, (k, cnt)| tot + [hidden_counts[k], cnt].min }\n</code></pre>\n\n<p>with</p>\n\n<pre><code>guess_counts.sum { |k, cnt| [hidden_counts[k], cnt].min }  \n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 1, "creation_date": 1517314644, "post_id": 48514303, "comment_id": 84037023, "body": "That\u2019s nice and short but it\u2019s relatively inefficient due to the repeated use of <code>count</code>, as compared with methods that determine all counts in a single pass."}, {"owner": {"reputation": 24179, "user_id": 1672429, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/0815eb7d4e9dd58022d51ba2011b9c0a?s=128&d=identicon&r=PG", "display_name": "Stefan Pochmann", "link": "https://stackoverflow.com/users/1672429/stefan-pochmann"}, "reply_to_user": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1517316575, "post_id": 48514303, "comment_id": 84038241, "body": "@CarySwoveland I disagree. I just tried it, judging both examples a million times. My solution took 5.9 seconds, yours took 8.1 seconds with reduce and 9.1 seconds with sum."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1517316777, "post_id": 48514303, "comment_id": 84038385, "body": "One thing I do like (which I should have done) is to first calculate <code>full</code> and then subtract <code>full</code> from the second calculation, as it simplifies the second calculation."}, {"owner": {"reputation": 24179, "user_id": 1672429, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/0815eb7d4e9dd58022d51ba2011b9c0a?s=128&d=identicon&r=PG", "display_name": "Stefan Pochmann", "link": "https://stackoverflow.com/users/1672429/stefan-pochmann"}, "reply_to_user": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1517317153, "post_id": 48514303, "comment_id": 84038605, "body": "@CarySwoveland Tried moveson&#39;s solution as well now, took 15.1 seconds."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 1, "creation_date": 1517317557, "post_id": 48514303, "comment_id": 84038871, "body": "Executing <code>count</code> repeatedly is O(n^2) whereas using a counting hash or <code>group_by</code> is close to O(n). I\u2019m not surprised that <code>count</code> would win out with 4-element arrays with lots of dups. Try benchmarking with larger arrays with fewer dups."}, {"owner": {"reputation": 24179, "user_id": 1672429, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/0815eb7d4e9dd58022d51ba2011b9c0a?s=128&d=identicon&r=PG", "display_name": "Stefan Pochmann", "link": "https://stackoverflow.com/users/1672429/stefan-pochmann"}, "reply_to_user": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1517317701, "post_id": 48514303, "comment_id": 84038977, "body": "@CarySwoveland With &quot;larger&quot; I guess you mean n=5? At least that&#39;s the largest of the 18 (!) variations that <a href=\"https://en.wikipedia.org/wiki/Mastermind_(board_game)#Variations\" rel=\"nofollow noreferrer\">Wikipedia&#39;s article</a> lists (not counting the one with n=6 because it&#39;s judged differently)."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1517318408, "post_id": 48514303, "comment_id": 84039440, "body": "I was addressing the problem in general, for arbitrarily-large arrays, thinking that would be of greatest interest and utility to readers who may have the same problem, but one that is unrelated to Mastermind."}, {"owner": {"reputation": 24179, "user_id": 1672429, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/0815eb7d4e9dd58022d51ba2011b9c0a?s=128&d=identicon&r=PG", "display_name": "Stefan Pochmann", "link": "https://stackoverflow.com/users/1672429/stefan-pochmann"}, "reply_to_user": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1517321091, "post_id": 48514303, "comment_id": 84041251, "body": "@CarySwoveland Mmh... I&#39;d say this judging method is pretty Mastermind-specific. At least I think I&#39;ve encountered this several times for Mastermind but never for something else. But ok, added an answer that&#39;s almost as simple and that&#39;s efficient for the generalized task."}], "tags": [], "owner": {"reputation": 24179, "user_id": 1672429, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/0815eb7d4e9dd58022d51ba2011b9c0a?s=128&d=identicon&r=PG", "display_name": "Stefan Pochmann", "link": "https://stackoverflow.com/users/1672429/stefan-pochmann"}, "is_accepted": false, "score": 1, "last_activity_date": 1517318195, "last_edit_date": 1517318195, "creation_date": 1517289272, "answer_id": 48514303, "question_id": 48512044, "link": "https://stackoverflow.com/questions/48512044/how-to-find-count-matching-characters-at-the-same-indes-and-at-an-unmatching-ind/48514303#48514303", "title": "How to find count matching characters at the same indes and at an unmatching index", "body": "<pre><code>def judge(secret, guess)\n  full = secret.zip(guess).count { |s, g| s == g }\n  semi = secret.uniq.sum { |s| [secret.count(s), guess.count(s)].min } - full\n  [full, semi]\nend\n</code></pre>\n\n<p>Demo:</p>\n\n<pre><code>&gt; judge([\"G\",\"G\",\"G\",\"Y\"], [\"G\",\"Y\",\"G\",\"G\"])\n=&gt; [2, 2]\n&gt; judge([\"X\",\"R\",\"Y\",\"T\"], [\"T\",\"T\",\"Y\",\"Y\"])\n=&gt; [1, 1]\n</code></pre>\n\n<p>A shorter alternative, though I find it less clear:</p>\n\n<pre><code>  full = secret.zip(guess).count(&amp;:uniq!)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 24179, "user_id": 1672429, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/0815eb7d4e9dd58022d51ba2011b9c0a?s=128&d=identicon&r=PG", "display_name": "Stefan Pochmann", "link": "https://stackoverflow.com/users/1672429/stefan-pochmann"}, "is_accepted": false, "score": 1, "last_activity_date": 1517321458, "last_edit_date": 1517321458, "creation_date": 1517320581, "answer_id": 48523172, "question_id": 48512044, "link": "https://stackoverflow.com/questions/48512044/how-to-find-count-matching-characters-at-the-same-indes-and-at-an-unmatching-ind/48523172#48523172", "title": "How to find count matching characters at the same indes and at an unmatching index", "body": "<p>I prefer my other answer for its simplicity, but this one would be faster if someone wanted to use this for arrays larger than Mastermind's.</p>\n\n<pre><code>def judge(secret, guess)\n  full = secret.zip(guess).count { |s, g| s == g }\n  pool = secret.group_by(&amp;:itself)\n  [full, guess.count { |g| pool[g]&amp;.pop } - full]\nend\n</code></pre>\n\n<p>Demo:</p>\n\n<pre><code>&gt; judge([\"G\",\"G\",\"G\",\"Y\"], [\"G\",\"Y\",\"G\",\"G\"])\n=&gt; [2, 2]\n&gt; judge([\"X\",\"R\",\"Y\",\"T\"], [\"T\",\"T\",\"Y\",\"Y\"])\n=&gt; [1, 1]\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 7273824, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0cea2cdebae725fdd749ff88c25871d9?s=128&d=identicon&r=PG&f=1", "display_name": "Jackie Fahmy", "link": "https://stackoverflow.com/users/7273824/jackie-fahmy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 93, "favorite_count": 0, "answer_count": 4, "score": 0, "last_activity_date": 1517321458, "creation_date": 1517271224, "question_id": 48512044, "link": "https://stackoverflow.com/questions/48512044/how-to-find-count-matching-characters-at-the-same-indes-and-at-an-unmatching-ind", "title": "How to find count matching characters at the same indes and at an unmatching index", "body": "<p>I have built a version of mastermind that checks a user's input and provides feedback based on how close the user's guess was to the winning sequence. If you're not familiar with the game, you get feedback indicating how many of your characters were guessed correctly at the same index and how many characters guessed are in the sequence, but at the wrong index. If there are duplicates in the guess, then you would not count the extra values unless they correspond to the same number of duplicates in the secret code. </p>\n\n<p>Example: If the sequence is [\"G\",\"G\",\"G\",\"Y\"] and the user guesses [\"G\", \"Y\",\"G\",\"G\"] then you'd want to return 2 for items at the same index and 2 for items at different indexes that are included in the secret sequence. </p>\n\n<p>Another example: If the sequence is [\"X\",\"R\",\"Y\",\"T\"] and the user guesses [\"T\",\"T\",\"Y\",\"Y\"] then you'd return 1 for items at the same index 1 for the character guessed that is in the sequence but at the wrong index.</p>\n\n<p>Anyway, to me this is not a simple problem to solve. Here's the code I used to get it to work, but it's not elegant. There must be a better way. I was hoping someone can tell me what I'm missing here?? New to Ruby... </p>\n\n<pre class=\"lang-html prettyprint-override\"><code>def index_checker(input_array, sequence_array)\n  count = 0\n  leftover_input = []\n  leftover_sequence = []\n\n  input.each_with_index do |char, idx|\n    if char == sequence[idx]\n      count += 1\n    else\n      leftover_input &lt;&lt; char\n      leftover_sequence &lt;&lt; sequence[idx]\n    end\n  end\n\ndiff_index_checker(leftover_input, leftover_sequence, count)\nend\n\ndef diff_index_checker(input, sequence, count)\n  count2 = 0\n  already_counted = []\n\n    input.each do |char|\n      if sequence.include?(char) &amp;&amp; !already_counted.include?(char)\n        count2 += 1\n        already_counted &lt;&lt; char\n      end\n    end\n[count, count2]\nend\n</code></pre>\n\n\n"}, {"tags": ["ruby-on-rails", "ruby", "rspec", "capybara"], "comments": [{"owner": {"reputation": 42014, "user_id": 2709090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/238c2b7cde2c817fc9a5a2b8eaa2ffad?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Walpole", "link": "https://stackoverflow.com/users/2709090/thomas-walpole"}, "edited": false, "score": 0, "creation_date": 1517272329, "post_id": 48511683, "comment_id": 84019218, "body": "What driver are you using with Capybara? and what Capybara settings are you using (<code>Capybara.server</code>, etc)?"}, {"owner": {"reputation": 1364, "user_id": 5737512, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nfjfF.jpg?s=128&g=1", "display_name": "Kaushlendra Tomar", "link": "https://stackoverflow.com/users/5737512/kaushlendra-tomar"}, "edited": false, "score": 0, "creation_date": 1517295022, "post_id": 48511683, "comment_id": 84025219, "body": "you can use <code>gem &quot;chromedriver-helper&quot;</code> to figure out what exactly is working"}, {"owner": {"reputation": 23809, "user_id": 351909, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/71a6b8a36a63c2cb9de678c07be6d8a4?s=128&d=identicon&r=PG", "display_name": "moritz", "link": "https://stackoverflow.com/users/351909/moritz"}, "edited": false, "score": 0, "creation_date": 1517307377, "post_id": 48511683, "comment_id": 84032358, "body": "So the signin should happen in some controller action where it checks the password. Does that succeed?"}, {"owner": {"reputation": 42014, "user_id": 2709090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/238c2b7cde2c817fc9a5a2b8eaa2ffad?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Walpole", "link": "https://stackoverflow.com/users/2709090/thomas-walpole"}, "reply_to_user": {"reputation": 1364, "user_id": 5737512, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nfjfF.jpg?s=128&g=1", "display_name": "Kaushlendra Tomar", "link": "https://stackoverflow.com/users/5737512/kaushlendra-tomar"}, "edited": false, "score": 0, "creation_date": 1517331765, "post_id": 48511683, "comment_id": 84048511, "body": "@Sunny The <code>chromedriver-helper</code> gem works by installing a shim into your ruby bins which can result in hard to debug issues where it&#39;s not running the version you think it is.  A better solution is the <code>webdrivers</code> gem which provides the same service but through a different method."}], "owner": {"reputation": 2074, "user_id": 688071, "user_type": "registered", "accept_rate": 67, "profile_image": "https://graph.facebook.com/1229375604/picture?type=large", "display_name": "Godzilla74", "link": "https://stackoverflow.com/users/688071/godzilla74"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 62, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1517268621, "creation_date": 1517268621, "question_id": 48511683, "link": "https://stackoverflow.com/questions/48511683/capybara-rspec-routing-incorrectly", "title": "Capybara Rspec routing incorrectly", "body": "<p>I'm working on feature tests for my rails app and completely confused.  I've created a test to log in which is routing me back to my root path of <code>/</code>.</p>\n\n<pre><code>1) Sign in user can sign in with valid credentials\n     Failure/Error: expect(page).to have_content I18n.t 'devise.sessions.signed_in'\n       expected to find text \"Signed in successfully.\" in \"Home Login This is where the fun is.\"\n     # ./spec/features/users/sign_in_spec.rb:24:in `block (2 levels) in &lt;top (required)&gt;'\n</code></pre>\n\n<p>In my spec file I have:</p>\n\n<pre><code>feature 'Sign in', :devise do\n  scenario 'user can sign in with valid credentials' do\n    user = FactoryGirl.create(:user)\n    signin(user.email, user.password)\n    expect(page).to have_content I18n.t 'devise.sessions.signed_in'\n  end\nend\n</code></pre>\n\n<p>I created a <code>signin</code> method in a helper file that has:</p>\n\n<pre><code>module Features\n  module SessionHelpers\n  def signin(email, password)\n      visit new_user_session_path\n      fill_in 'Email', with: email\n      fill_in 'Password', with: password\n      click_button 'Log in'\n    end\n  end\nend\n</code></pre>\n\n<p>For some reason this is routing me back to my root path, even though I should be in <code>/admin</code> at this point:</p>\n\n<pre><code>$rescue rspec\n\nFrom: /Users/mine/Coding/project/spec/features/users/sign_in_spec.rb @ line 24 :\n\n    19:   #   When I sign in with valid credentials\n    20:   #   Then I see a success message\n    21:   scenario 'user can sign in with valid credentials' do\n    22:     user = FactoryGirl.create(:user)\n    23:     signin(user.email, user.password)\n =&gt; 24:     expect(page).to have_content I18n.t 'devise.sessions.signed_in'\n    25:   end\n    26: \n\nRSpec::Expectations::ExpectationNotMetError: expected to find text \"Signed in successfully.\" in \"Home Login This is where the fun is.\"\nfrom /Users/mine/.rbenv/versions/2.4.3/lib/ruby/gems/2.4.0/gems/rspec-support-3.6.0/lib/rspec/support.rb:87:in `block in &lt;module:Support&gt;'\n[1] pry(#&lt;RSpec::ExampleGroups::SignIn&gt;)&gt; current_path\n=&gt; \"/\"\n</code></pre>\n\n<p>When I do this all by hand through my own browser I'm able to log in without an issue and being redirected to the correct path <code>/admin</code>.  What am I missing?</p>\n"}, {"tags": ["arrays", "ruby"], "comments": [{"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1517266600, "post_id": 48511309, "comment_id": 84017576, "body": "Your question is unclear, because you have not provided a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>. What is <code>arr</code>? Your code sample should be <b>complete</b> - i.e. I should be able to copy+paste and run it myself."}, {"owner": {"reputation": 394580, "user_id": 479863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ArUCE.jpg?s=128&g=1", "display_name": "mu is too short", "link": "https://stackoverflow.com/users/479863/mu-is-too-short"}, "edited": false, "score": 0, "creation_date": 1517268335, "post_id": 48511309, "comment_id": 84018138, "body": "The second line in your output (with four elements) is a typo, right? And you should <code>a.push(coffee)</code> rather than worry about <code>i</code>."}], "answers": [{"tags": [], "owner": {"reputation": 4690, "user_id": 1937435, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/YyN37.jpg?s=128&g=1", "display_name": "Josh Brody", "link": "https://stackoverflow.com/users/1937435/josh-brody"}, "is_accepted": true, "score": 2, "last_activity_date": 1518137345, "last_edit_date": 1518137345, "creation_date": 1517266696, "answer_id": 48511398, "question_id": 48511309, "link": "https://stackoverflow.com/questions/48511309/print-array-items-3-per-line/48511398#48511398", "title": "print array items 3 per line", "body": "<pre><code>array.each_slice(3).with_index do |part, ind|\n  puts part.join(\", \") + (ind == 3 ? \"\" : \",\")\nend\n</code></pre>\n\n<p>is probably what you want to do.</p>\n"}, {"comments": [{"owner": {"reputation": 394580, "user_id": 479863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ArUCE.jpg?s=128&g=1", "display_name": "mu is too short", "link": "https://stackoverflow.com/users/479863/mu-is-too-short"}, "edited": false, "score": 0, "creation_date": 1517268638, "post_id": 48511507, "comment_id": 84018231, "body": "Nice on spotting the trailing commas but you could use two <code>Array#join</code> calls to avoid messing around with indices like that."}], "tags": [], "owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "is_accepted": false, "score": 2, "last_activity_date": 1517267458, "creation_date": 1517267458, "answer_id": 48511507, "question_id": 48511309, "link": "https://stackoverflow.com/questions/48511309/print-array-items-3-per-line/48511507#48511507", "title": "print array items 3 per line", "body": "<p>Here's a simple solution that <em>almost</em> gets what you asked for:</p>\n\n<pre><code>array.each_slice(3) { |part| puts part.join(', ') }\n\n#=&gt; black iced coffee, cold brew, espresso\n    flat white, frap, latte, drip\n    fancy, smancy\n</code></pre>\n\n<p>However, this is missing the final comma on the first two lines.</p>\n\n<p>If this is important, you might try to add it like so:</p>\n\n<pre><code>array.each_slice(3) { |part| puts part.join(', ') + ',' }\n\n#=&gt; black iced coffee, cold brew, espresso,\n    flat white, frap, latte, drip,\n    fancy, smancy,\n</code></pre>\n\n<p>...but now it's also on the last line!</p>\n\n<p>There's probably a slightly more elegant way to do this, but it's a bit fiddly... How about:</p>\n\n<pre><code>array.each_slice(3).with_index do |part, i|\n  puts part.join(\", \") + (array.size % 3 == i ? '' : ',')\nend\n\n#=&gt; black iced coffee, cold brew, espresso,\n    flat white, frap, latte, drip,\n    fancy, smancy\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 394580, "user_id": 479863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ArUCE.jpg?s=128&g=1", "display_name": "mu is too short", "link": "https://stackoverflow.com/users/479863/mu-is-too-short"}, "is_accepted": false, "score": 2, "last_activity_date": 1517268259, "creation_date": 1517268259, "answer_id": 48511635, "question_id": 48511309, "link": "https://stackoverflow.com/questions/48511309/print-array-items-3-per-line/48511635#48511635", "title": "print array items 3 per line", "body": "<p>I'd probably use <code>each_slice</code> and <code>join</code> to build the individual lines:</p>\n\n<pre><code>a.each_slice(3).map { |a| a.join(', ') }\n</code></pre>\n\n<p>and then <code>join</code> again to join the lines together:</p>\n\n<pre><code>puts a.each_slice(3).map { |a| a.join(', ') }.join(\",\\n\")\n</code></pre>\n\n<p>This assumes, of course, that each line except the last is supposed to contain three elements and that the second line of your sample output is a typo.</p>\n"}], "owner": {"reputation": 6983, "user_id": 973397, "user_type": "registered", "accept_rate": 99, "profile_image": "https://i.stack.imgur.com/7pwAF.jpg?s=128&g=1", "display_name": "fred randall", "link": "https://stackoverflow.com/users/973397/fred-randall"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 99, "favorite_count": 0, "closed_date": 1517346598, "accepted_answer_id": 48511398, "answer_count": 3, "score": -4, "last_activity_date": 1518137345, "creation_date": 1517266180, "last_edit_date": 1517269242, "question_id": 48511309, "link": "https://stackoverflow.com/questions/48511309/print-array-items-3-per-line", "closed_reason": "Duplicate", "title": "print array items 3 per line", "body": "<p>With the below my whole dynamic array outputs, 10 per line - I would like to setup a param to have 3 array items per line, after 3 another line is created.</p>\n\n<pre><code>...     \n     while i &lt; arr.length\n          print \"Define types of coffee drinks: \"\n          coffee = gets.chomp\n          arr[i] = coffee\n          i += 1\n        end\n        puts arr.join(\", \")\n      break\n...\n</code></pre>\n\n<p>For instance after my dynamic array is created it outputs like:</p>\n\n<pre><code>black iced coffee, cold brew, espresso, flat white, frap, latte, drip, fancy, smancy\n</code></pre>\n\n<p>All 10 on one line, I'd like it to output like:</p>\n\n<pre><code>black iced coffee, cold brew, espresso,\nflat white, frap, latte, \ndrip, fancy, smancy\n</code></pre>\n"}, {"tags": ["ruby", "rubocop"], "comments": [{"owner": {"reputation": 8645, "user_id": 368167, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c9596f533dcd61ecf75f150b0d9997b3?s=128&d=identicon&r=PG", "display_name": "Tamer Shlash", "link": "https://stackoverflow.com/users/368167/tamer-shlash"}, "edited": false, "score": 0, "creation_date": 1517265183, "post_id": 48511081, "comment_id": 84017061, "body": "what is the exact error you are getting? can you show the code or at least the line?"}, {"owner": {"reputation": 203, "user_id": 9226492, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/1101789162a8e10b23e10edb2f56fadd?s=128&d=identicon&r=PG&f=1", "display_name": "jose1221", "link": "https://stackoverflow.com/users/9226492/jose1221"}, "reply_to_user": {"reputation": 8645, "user_id": 368167, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c9596f533dcd61ecf75f150b0d9997b3?s=128&d=identicon&r=PG", "display_name": "Tamer Shlash", "link": "https://stackoverflow.com/users/368167/tamer-shlash"}, "edited": false, "score": 0, "creation_date": 1517265488, "post_id": 48511081, "comment_id": 84017185, "body": "@TamerShlash Sure please check the updated question"}], "answers": [{"tags": [], "owner": {"reputation": 8645, "user_id": 368167, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c9596f533dcd61ecf75f150b0d9997b3?s=128&d=identicon&r=PG", "display_name": "Tamer Shlash", "link": "https://stackoverflow.com/users/368167/tamer-shlash"}, "is_accepted": true, "score": 4, "last_activity_date": 1517266103, "creation_date": 1517266103, "answer_id": 48511291, "question_id": 48511081, "link": "https://stackoverflow.com/questions/48511081/how-to-turn-off-cyclomatic-complexity-for-where-is-too-high/48511291#48511291", "title": "how to turn off Cyclomatic complexity for where is too high", "body": "<p>Try this:</p>\n\n<pre><code># rubocop:disable Metrics/CyclomaticComplexity\n.... your method here\n# rubocop:enable Metrics/CyclomaticComplexity\n</code></pre>\n\n<p>Also, if you want to turn off Rubocop for all those test files (since you are going to refactor them), you can try <a href=\"https://stackoverflow.com/a/36896588/368167\">this answer</a>.</p>\n"}], "owner": {"reputation": 203, "user_id": 9226492, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/1101789162a8e10b23e10edb2f56fadd?s=128&d=identicon&r=PG&f=1", "display_name": "jose1221", "link": "https://stackoverflow.com/users/9226492/jose1221"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2519, "favorite_count": 0, "accepted_answer_id": 48511291, "answer_count": 1, "score": 2, "last_activity_date": 1517266103, "creation_date": 1517264951, "last_edit_date": 1517265475, "question_id": 48511081, "link": "https://stackoverflow.com/questions/48511081/how-to-turn-off-cyclomatic-complexity-for-where-is-too-high", "title": "how to turn off Cyclomatic complexity for where is too high", "body": "<p>I have a where method in model that's throwing lint error. The whole code in model is just a test code at this moment and will be refactored later on. So i want to turn off this lint error for now.</p>\n\n<p><strong>UPDATE</strong>:\nHere's the method i am getting lint error at</p>\n\n<pre><code>def self.where(start_date, end_date, customer_id, type, location, is_registered)\n  filtered_data = if start_date &amp;&amp; end_date\n                     customers.select do |e|\n                       e[:startDateTime].to_datetime &gt;= start_date.to_datetime &amp;&amp;\n                         e[:endDateTime].to_datetime &lt;= end_date.to_datetime\n                     end\n                   elsif start_date\n                     customers.select {|e| e[:startDateTime].to_datetime &gt;= start_date.to_datetime }\n                   elsif end_date\n                     customers.select {|e| e[:endDateTime].to_datetime &lt;= end_date.to_datetime }\n                   else\n                     customers\n                   end\n\n  if !is_registered.nil? # is_registered is true or false\n    filtered_data = customers.select { |e| e[:isRegistered].to_s == is_registered }\n  end\n  # Check if hash presents and check if the keys have valid values.\n  if customer_id || type || location\n    hash = { customerId: customer_id.to_i, type: type, location: location }\n    # delete if type, location or customer_id is nil.\n    hash = hash.delete_if { |_k, v| v.nil? || v == 0 }\n    keys = hash.keys\n    filtered_data = filtered_data.select { |h| h.select { |k| keys.include?(k) } == hash }\n  else\n    filtered_data\n  end\n\n  filtered_data.map do |slot|\n    mock_customer(slot[:id], slot[:customerId], slot[:name], slot[:startDateTime],\n               slot[:endDateTime], slot[:location], slot[:status])\n  end\nend\n</code></pre>\n\n<p>I tried adding <code># rubocop:disable Metrics/AbcSize</code> in model but didnt help.</p>\n"}, {"tags": ["javascript", "html", "ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 162909, "user_id": 1175966, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8d3d9dfbd040f9cbc1a6b82f0da2b345?s=128&d=identicon&r=PG", "display_name": "charlietfl", "link": "https://stackoverflow.com/users/1175966/charlietfl"}, "edited": false, "score": 5, "creation_date": 1517263465, "post_id": 48510686, "comment_id": 84016376, "body": "Ruby only runs on the server...long before javascript runs in the browser. Neither knows anything about the other"}, {"owner": {"reputation": 41, "user_id": 8611220, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/v2oas.jpg?s=128&g=1", "display_name": "\u122doll\u03b9n", "link": "https://stackoverflow.com/users/8611220/%e1%88%adoll%ce%b9n"}, "edited": false, "score": 0, "creation_date": 1517263683, "post_id": 48510686, "comment_id": 84016465, "body": "So can I find an element by its Id or name?"}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 2, "creation_date": 1517264055, "post_id": 48510686, "comment_id": 84016613, "body": "You need JavaScript to send data back to Ruby via AJAX or a regular request. Once you&#39;ve rendered the page Ruby is done, no longer involved, and it&#39;s up to the browser to take over."}], "answers": [{"tags": [], "owner": {"reputation": 197, "user_id": 1511138, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7bf3e233fdb80476d8de8730d0bf2c55?s=128&d=identicon&r=PG", "display_name": "amit", "link": "https://stackoverflow.com/users/1511138/amit"}, "is_accepted": false, "score": 0, "last_activity_date": 1517264250, "last_edit_date": 1517264250, "creation_date": 1517263534, "answer_id": 48510765, "question_id": 48510686, "link": "https://stackoverflow.com/questions/48510686/how-to-access-javascript-variable-in-ruby/48510765#48510765", "title": "How to Access JavaScript Variable in Ruby", "body": "<p>I don't think its possible as Ruby is executed server side and javascript is client side language. But you can use ajax to pass client side variable(JS) to server and tackle this situation.</p>\n\n<p>For Example - \nusing little JS you can pass client side variable to server side and get the result. </p>\n\n<pre><code>var email = $('#email').val();\n$.post('/email_lookup?email='+email,function(data){\n  console.log(data);\n});\n</code></pre>\n\n<p>In Controller, you can define an action which will look for provided email and return a json data whether the email exists or not. </p>\n\n<pre><code>def email_lookup\n  @user = User.where(email: params[:email]).try(:first)\n  render json: {\n    email_found: @user.present?\n  }\nend\n</code></pre>\n"}], "owner": {"reputation": 41, "user_id": 8611220, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/v2oas.jpg?s=128&g=1", "display_name": "\u122doll\u03b9n", "link": "https://stackoverflow.com/users/8611220/%e1%88%adoll%ce%b9n"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 168, "favorite_count": 0, "closed_date": 1517264141, "answer_count": 1, "score": 0, "last_activity_date": 1517264250, "creation_date": 1517263204, "question_id": 48510686, "link": "https://stackoverflow.com/questions/48510686/how-to-access-javascript-variable-in-ruby", "closed_reason": "Duplicate", "title": "How to Access JavaScript Variable in Ruby", "body": "<p>I'm trying to do something very simple, but I can't figure out. How can I access a local JavaScript variable in Ruby? Or, if that's not possible, can I find an element on the page by its <code>name</code> or <code>id</code>? I'm trying to fit it into the following:</p>\n\n<pre><code>inp = document.getElementById(\"email\").value; \n\n&lt;% if User.pluck(:email).include? **JAVASCRIPT VARIABLE \"INP\"** then %&gt;\nalert(\"found\")\n&lt;% end %&gt;\n</code></pre>\n\n<p>Thanks.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "rspec", "nokogiri"], "answers": [{"comments": [{"owner": {"reputation": 5836, "user_id": 1153022, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/JgpPs.jpg?s=128&g=1", "display_name": "okay56k", "link": "https://stackoverflow.com/users/1153022/okay56k"}, "edited": false, "score": 0, "creation_date": 1517264422, "post_id": 48510698, "comment_id": 84016783, "body": "Ah, total sense. Thank-you."}], "tags": [], "owner": {"reputation": 25268, "user_id": 215168, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/212c9d7980fe9aa71739313d483b3782?s=128&d=identicon&r=PG", "display_name": "Abe Voelker", "link": "https://stackoverflow.com/users/215168/abe-voelker"}, "is_accepted": true, "score": 4, "last_activity_date": 1517263254, "creation_date": 1517263254, "answer_id": 48510698, "question_id": 48510594, "link": "https://stackoverflow.com/questions/48510594/nokogiri-why-does-this-return-only-the-removed-tag-and-not-the-remainder/48510698#48510698", "title": "Nokogiri: why does this return only the removed tag and not the remainder?", "body": "<p>Because you're assigning the result of <code>.remove</code> to that variable - just remove the assignment</p>\n\n<pre><code>body = \"&lt;img src='/Users/test/Documents/cd-rum/whatever/spec/factories/images/rda.jpg' /&gt;Et qui incidunt provident sed nemo modi pariatur quia.\"\nparsed_body = Nokogiri::HTML::fragment(body)\nparsed_body.search('img').first.remove\nparsed_body.to_html # =&gt; \"Et qui incidunt provident sed nemo modi pariatur quia.\"\n</code></pre>\n"}], "owner": {"reputation": 5836, "user_id": 1153022, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/JgpPs.jpg?s=128&g=1", "display_name": "okay56k", "link": "https://stackoverflow.com/users/1153022/okay56k"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 27, "favorite_count": 0, "accepted_answer_id": 48510698, "answer_count": 1, "score": 1, "last_activity_date": 1517263254, "creation_date": 1517262803, "question_id": 48510594, "link": "https://stackoverflow.com/questions/48510594/nokogiri-why-does-this-return-only-the-removed-tag-and-not-the-remainder", "title": "Nokogiri: why does this return only the removed tag and not the remainder?", "body": "<p>Where <code>body</code> is this:</p>\n\n<pre><code>&lt;img src='/Users/test/Documents/cd-rum/whatever/spec/factories/images/rda.jpg' /&gt;Et qui incidunt provident sed nemo modi pariatur quia.\n</code></pre>\n\n<p>Why does this:</p>\n\n<pre><code>parsed_body = Nokogiri::HTML(body).search('img').first.remove\nparsed_body.to_html\n</code></pre>\n\n<p>Return <em>only</em> the image tag?</p>\n\n<pre><code>Failure/Error: specify { expect(post.parsed_body).to_not include('&lt;img') }\nexpected \"&lt;img src=\\\"/Users/test/Documents/cd-rum/whatever/spec/factories/images/rda.jpg\\\"&gt;\" not to include \"&lt;img\"\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "phantomjs", "cucumber", "capybara"], "comments": [{"owner": {"reputation": 35276, "user_id": 182590, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/134ea397777886d6f0aa992672a50eaa?s=128&d=identicon&r=PG", "display_name": "Mark Thomas", "link": "https://stackoverflow.com/users/182590/mark-thomas"}, "edited": false, "score": 3, "creation_date": 1517262955, "post_id": 48510434, "comment_id": 84016157, "body": "I&#39;m not sure what the problem is, but having a <code>server_host</code> containing an integer seems suspicious. Also, note that &quot;I take screenshot&quot; is not a user action and doesn&#39;t really fit in a scenario."}, {"owner": {"reputation": 82, "user_id": 2547172, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a935201e64162770b3751a7817073c1f?s=128&d=identicon&r=PG", "display_name": "Vaibhav", "link": "https://stackoverflow.com/users/2547172/vaibhav"}, "reply_to_user": {"reputation": 35276, "user_id": 182590, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/134ea397777886d6f0aa992672a50eaa?s=128&d=identicon&r=PG", "display_name": "Mark Thomas", "link": "https://stackoverflow.com/users/182590/mark-thomas"}, "edited": false, "score": 0, "creation_date": 1517481692, "post_id": 48510434, "comment_id": 84117042, "body": "Agreed, it was just to for debug purpose. Thanks for pointing it out."}], "answers": [{"comments": [{"owner": {"reputation": 82, "user_id": 2547172, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a935201e64162770b3751a7817073c1f?s=128&d=identicon&r=PG", "display_name": "Vaibhav", "link": "https://stackoverflow.com/users/2547172/vaibhav"}, "edited": false, "score": 0, "creation_date": 1517311023, "post_id": 48512151, "comment_id": 84034752, "body": "Thanks Thomas, that was exactly the problem."}, {"owner": {"reputation": 42014, "user_id": 2709090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/238c2b7cde2c817fc9a5a2b8eaa2ffad?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Walpole", "link": "https://stackoverflow.com/users/2709090/thomas-walpole"}, "reply_to_user": {"reputation": 82, "user_id": 2547172, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a935201e64162770b3751a7817073c1f?s=128&d=identicon&r=PG", "display_name": "Vaibhav", "link": "https://stackoverflow.com/users/2547172/vaibhav"}, "edited": false, "score": 0, "creation_date": 1517331877, "post_id": 48512151, "comment_id": 84048583, "body": "@Vaibhav You&#39;re welcome, don&#39;t forget to accept the answer (the checkmark) if there&#39;s nothing more you need,  so your question gets marked as answered."}], "tags": [], "owner": {"reputation": 42014, "user_id": 2709090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/238c2b7cde2c817fc9a5a2b8eaa2ffad?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Walpole", "link": "https://stackoverflow.com/users/2709090/thomas-walpole"}, "is_accepted": true, "score": 1, "last_activity_date": 1517272148, "creation_date": 1517272148, "answer_id": 48512151, "question_id": 48510434, "link": "https://stackoverflow.com/questions/48510434/getting-wrong-argument-type-fixnum-expected-string-typeerror-while-runnin/48512151#48512151", "title": "Getting &quot; wrong argument type Fixnum (expected String) (TypeError)&quot; while running the Cucumber tests whenever it encounters the Capybara function", "body": "<p><code>Capybara.server_host</code> needs to be the hostname/ip of an interface Capybara can bind the AUT to, not a number.  </p>\n\n<p>You're probably trying to set the port, which would be</p>\n\n<pre><code>Capybara.server_port = 45454\n</code></pre>\n\n<p>and then judging by your setting of <code>app_host</code> (which probably isn't necessary) you also want to be setting</p>\n\n<pre><code>Capybara.server_host = 'localhost'\n</code></pre>\n"}], "owner": {"reputation": 82, "user_id": 2547172, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a935201e64162770b3751a7817073c1f?s=128&d=identicon&r=PG", "display_name": "Vaibhav", "link": "https://stackoverflow.com/users/2547172/vaibhav"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 208, "favorite_count": 0, "accepted_answer_id": 48512151, "answer_count": 1, "score": 0, "last_activity_date": 1517272148, "creation_date": 1517261982, "question_id": 48510434, "link": "https://stackoverflow.com/questions/48510434/getting-wrong-argument-type-fixnum-expected-string-typeerror-while-runnin", "title": "Getting &quot; wrong argument type Fixnum (expected String) (TypeError)&quot; while running the Cucumber tests whenever it encounters the Capybara function", "body": "<p>I am trying to use capybara in my feature tests, but I keep getting the above error. However, my tests work when non Capybara functions are involved.</p>\n\n<p>Here is the settings in my env.rb:</p>\n\n<pre><code>    Capybara.server_host = 45454\n    #Capybara.server_host = host\n    Capybara.app_host = 'http://localhost:45454'\n    Capybara.default_driver = :poltergeist\n</code></pre>\n\n<p>PATH variable is also set for Phantomjs</p>\n\n<p>Following is the steps definition file where I am facing the issue.</p>\n\n<pre><code>   Given(/^I navigate to home page$/) do \n     visit '/'\n   end\n\n  And /^I take screenshot$/ do\n    page.save_screenshot\n  end\n</code></pre>\n\n<p>Following is the feature file</p>\n\n<pre><code> Scenario: To validate the page shows up\n   Given I navigate to home page\n     And I take screenshot\n</code></pre>\n\n<p>Here is the output:</p>\n\n<pre><code> Scenario: To validate the page shows up\u2190[90m # features/home.feature:8\u2190[0m\n \u2190[31mGiven I navigate to home page\u2190[90m         # features/step_definitions/\n home_steps.rb:8\u2190[0m\u2190[0m\n \u2190[31m      wrong argument type Fixnum (expected String) (TypeError)\u2190[0m\n \u2190[31m      ./features/step_definitions/home_steps.rb:9:in `/^I navigate to \n home\n page$/'\u2190[0m\n \u2190[31m      features/home.feature:9:in `Given I navigate to home page'\u2190[0m\n \u2190[36mAnd I take screenshot\u2190[90m                 # features/step_definitions/\n  home_steps.rb:12\u2190[0m\u2190[0m\n \u2190[31m      wrong argument type Fixnum (expected String) (TypeError)\u2190[0m\n\n \u2190[31mFailing Scenarios:\u2190[0m\n  \u2190[31mcucumber features/home.feature:8\u2190[0m\u2190[90m # Scenario: To validate the \n page\n shows up\u2190[0m\n\n 1 scenario (\u2190[31m1 failed\u2190[0m)\n 2 steps (\u2190[31m1 failed\u2190[0m, \u2190[36m1 skipped\u2190[0m)\n  0m0.649s\n</code></pre>\n"}]