[{"tags": ["ruby-on-rails", "ruby", "postgresql", "sidekiq", "pg"], "comments": [{"owner": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "edited": false, "score": 0, "creation_date": 1521681637, "post_id": 49418424, "comment_id": 85839595, "body": "Can you post an example of the code which hangs in postgres?"}, {"owner": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "edited": false, "score": 0, "creation_date": 1521682005, "post_id": 49418424, "comment_id": 85839657, "body": "Also,  can you post any errors you&#39;re getting?"}, {"owner": {"reputation": 6950, "user_id": 178110, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/66c3241af70dab90d6eac1d07f106f0a?s=128&d=identicon&r=PG", "display_name": "axsuul", "link": "https://stackoverflow.com/users/178110/axsuul"}, "edited": false, "score": 0, "creation_date": 1569605208, "post_id": 49418424, "comment_id": 102664524, "body": "@Niels Kristian did you ever figure this one out?"}], "answers": [{"comments": [{"owner": {"reputation": 1850, "user_id": 1509129, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/63e00648457aaab11a517c2c62887203?s=128&d=identicon&r=PG", "display_name": "urir", "link": "https://stackoverflow.com/users/1509129/urir"}, "edited": false, "score": 0, "creation_date": 1556073861, "post_id": 49419005, "comment_id": 98309253, "body": "How would connection never get closed by the worker?"}, {"owner": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "reply_to_user": {"reputation": 1850, "user_id": 1509129, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/63e00648457aaab11a517c2c62887203?s=128&d=identicon&r=PG", "display_name": "urir", "link": "https://stackoverflow.com/users/1509129/urir"}, "edited": false, "score": 0, "creation_date": 1556093839, "post_id": 49419005, "comment_id": 98315862, "body": "workers should close db connections after completing, but if you wanted to be explicit you could add <code>ActiveRecord::Base.connection.close</code> to the end of this."}], "tags": [], "owner": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "is_accepted": false, "score": 0, "last_activity_date": 1521681233, "creation_date": 1521681233, "answer_id": 49419005, "question_id": 49418424, "link": "https://stackoverflow.com/questions/49418424/how-do-i-debug-a-ruby-process-stuck-in-a-db-transaction/49419005#49419005", "title": "How do I debug a ruby process stuck in a db transaction?", "body": "<p>This is likely do to connections to postgres getting opened by your workers which never get closed.  If you jobs retry, this compounds the problem.  To solve this you might want to run a worker like this on a schedule to clear any unclosed connections:</p>\n\n<pre><code>class DbIdleCleanerWorker\n  include Sidekiq::Worker\n\n  sidekiq_options retry: 0\n\n  def perform()\n    sql = \"SELECT pg_terminate_backend(pid)\n    FROM pg_stat_activity\n    WHERE query != '&lt;IDLE&gt;' AND query NOT ILIKE '%pg_stat_activity%' AND state = 'idle'\n      AND now()-pg_stat_activity.query_start &gt; interval '1 minutes'\n    ORDER BY query_start desc;\"\n    ActiveRecord::Base.connection.execute(sql)\n  end\nend\n</code></pre>\n"}], "owner": {"reputation": 8232, "user_id": 1002814, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/935d2564cfa8572c12763684e072063d?s=128&d=identicon&r=PG", "display_name": "Niels Kristian", "link": "https://stackoverflow.com/users/1002814/niels-kristian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 698, "favorite_count": 1, "answer_count": 1, "score": 2, "last_activity_date": 1521681233, "creation_date": 1521676713, "question_id": 49418424, "link": "https://stackoverflow.com/questions/49418424/how-do-i-debug-a-ruby-process-stuck-in-a-db-transaction", "title": "How do I debug a ruby process stuck in a db transaction?", "body": "<p>I have some ruby background processing running in a quite big rails app. The background processing is performed by the sidekiq gem. From time to time I experience a really strange behaviour which spins into a death spiral.</p>\n\n<p>Some relatively simple jobs that does simple <code>UPDATE</code>s on single records in the connected postgresql database somehow never succeeds. The queries they perform gets stuck in postgresql as <code>waiting</code>, idle in transaction, because a transaction for the update query apparently never sends a <code>COMMIT</code>. While postgresql is waiting for this, it seems like so is the ruby background processing who sent the query! The ruby process seems to be hanging waiting for the transaction to complete from postgresql and hence not doing any further work.</p>\n\n<p>My question is now, in this deadlock situation, how can I further debug where the root cause of the issue originates from? (ruby, postgresql, OS, network, something else)</p>\n\n<p>PS. If I cancel the hanging transactions in postgresql manually by sending <code>SELECT pg_cancel_backend(faulty_pid)</code> then the sidekiq/ruby process which is hanging, immediately gets a connection error and gets back to normal, continuing to pick up jobs and work like nothing happened. This seems to indicate to me, that the connection between the db and ruby is still okay and the ruby process is not really stuck. But somehow something is going wrong.</p>\n\n<p>PS. I'm running ruby 2.4.0, rails 4.2, Postgresql 9.3, sidekiq 4.2 and pg 0.20.0 </p>\n"}, {"tags": ["ruby-on-rails", "ruby", "sqlite"], "comments": [{"owner": {"reputation": 21613, "user_id": 580346, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/ba17945a06aac247b06548d5afe341e8?s=128&d=identicon&r=PG", "display_name": "mrzasa", "link": "https://stackoverflow.com/users/580346/mrzasa"}, "edited": false, "score": 0, "creation_date": 1521676225, "post_id": 49418322, "comment_id": 85838404, "body": "please, paste the error you&#39;re getting"}, {"owner": {"reputation": 119, "user_id": 8068195, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e1db1af864df5cdf7622b9c322498245?s=128&d=identicon&r=PG&f=1", "display_name": "ima_prog", "link": "https://stackoverflow.com/users/8068195/ima-prog"}, "reply_to_user": {"reputation": 21613, "user_id": 580346, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/ba17945a06aac247b06548d5afe341e8?s=128&d=identicon&r=PG", "display_name": "mrzasa", "link": "https://stackoverflow.com/users/580346/mrzasa"}, "edited": false, "score": 0, "creation_date": 1521676413, "post_id": 49418322, "comment_id": 85838455, "body": "thanks for reminding!"}, {"owner": {"reputation": 21613, "user_id": 580346, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/ba17945a06aac247b06548d5afe341e8?s=128&d=identicon&r=PG", "display_name": "mrzasa", "link": "https://stackoverflow.com/users/580346/mrzasa"}, "edited": false, "score": 0, "creation_date": 1521676509, "post_id": 49418322, "comment_id": 85838474, "body": "see here: <a href=\"https://stackoverflow.com/questions/17643897/cannot-load-such-file-sqlite3-sqlite3-native-loaderror-on-ruby-on-rails\" title=\"cannot load such file sqlite3 sqlite3 native loaderror on ruby on rails\">stackoverflow.com/questions/17643897/&hellip;</a>"}, {"owner": {"reputation": 21613, "user_id": 580346, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/ba17945a06aac247b06548d5afe341e8?s=128&d=identicon&r=PG", "display_name": "mrzasa", "link": "https://stackoverflow.com/users/580346/mrzasa"}, "edited": false, "score": 1, "creation_date": 1521676517, "post_id": 49418322, "comment_id": 85838476, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/17643897/cannot-load-such-file-sqlite3-sqlite3-native-loaderror-on-ruby-on-rails\">cannot load such file -- sqlite3/sqlite3_native (LoadError) on ruby on rails</a>"}, {"owner": {"reputation": 119, "user_id": 8068195, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e1db1af864df5cdf7622b9c322498245?s=128&d=identicon&r=PG&f=1", "display_name": "ima_prog", "link": "https://stackoverflow.com/users/8068195/ima-prog"}, "reply_to_user": {"reputation": 21613, "user_id": 580346, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/ba17945a06aac247b06548d5afe341e8?s=128&d=identicon&r=PG", "display_name": "mrzasa", "link": "https://stackoverflow.com/users/580346/mrzasa"}, "edited": false, "score": 0, "creation_date": 1521676755, "post_id": 49418322, "comment_id": 85838538, "body": "in my sqlite3gemspec file in the C folder i have a  &#39; s.require_paths = [&quot;lib&quot;.freeze]&#39; What do I do with the freeze?"}, {"owner": {"reputation": 119, "user_id": 8068195, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e1db1af864df5cdf7622b9c322498245?s=128&d=identicon&r=PG&f=1", "display_name": "ima_prog", "link": "https://stackoverflow.com/users/8068195/ima-prog"}, "reply_to_user": {"reputation": 21613, "user_id": 580346, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/ba17945a06aac247b06548d5afe341e8?s=128&d=identicon&r=PG", "display_name": "mrzasa", "link": "https://stackoverflow.com/users/580346/mrzasa"}, "edited": false, "score": 0, "creation_date": 1521676889, "post_id": 49418322, "comment_id": 85838579, "body": "Just changed it to   s.require_paths = [&quot;lib/sqlite3_native&quot;.freeze] and it didnt work same errors"}, {"owner": {"reputation": 21613, "user_id": 580346, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/ba17945a06aac247b06548d5afe341e8?s=128&d=identicon&r=PG", "display_name": "mrzasa", "link": "https://stackoverflow.com/users/580346/mrzasa"}, "edited": false, "score": 0, "creation_date": 1521678669, "post_id": 49418322, "comment_id": 85838976, "body": "see answers here: <a href=\"https://stackoverflow.com/a/6126062/580346\">stackoverflow.com/a/6126062/580346</a>"}], "answers": [{"tags": [], "owner": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "is_accepted": false, "score": 0, "last_activity_date": 1521682250, "creation_date": 1521682250, "answer_id": 49419113, "question_id": 49418322, "link": "https://stackoverflow.com/questions/49418322/ruby-2-5-0-and-rails-5-1-5-cannot-boot-server-rake-dbmigrate-among-other-thin/49419113#49419113", "title": "Ruby 2.5.0 and Rails 5.1.5 cannot boot server, rake db:migrate, among other things", "body": "<p>This may be obvious but did you first run the following?</p>\n\n<pre><code>bundle install\nrake db:create db:migrate\n</code></pre>\n\n<p>and also maybe see:  <a href=\"https://stackoverflow.com/questions/5800920/error-no-such-file-to-load-sqlite3-sqlite3-native-loaderror/6126062#6126062\">Error &quot;no such file to load&quot; -- sqlite3/sqlite3_native (LoadError)</a></p>\n"}], "owner": {"reputation": 119, "user_id": 8068195, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e1db1af864df5cdf7622b9c322498245?s=128&d=identicon&r=PG&f=1", "display_name": "ima_prog", "link": "https://stackoverflow.com/users/8068195/ima-prog"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 513, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1521682250, "creation_date": 1521676028, "last_edit_date": 1521676427, "question_id": 49418322, "link": "https://stackoverflow.com/questions/49418322/ruby-2-5-0-and-rails-5-1-5-cannot-boot-server-rake-dbmigrate-among-other-thin", "title": "Ruby 2.5.0 and Rails 5.1.5 cannot boot server, rake db:migrate, among other things", "body": "<p>So when I make a rails new Myappwhichever and try to do any rake db:migrate or just even boot the server with rails s, I get errors. Some are cannot load such file sqlite3native. </p>\n\n<p>I tried the solution here :<a href=\"https://stackoverflow.com/questions/49227029/windows-10-ruby2-5-rails-5-1-5-cannot-load-such-file-sqlite3-sqlite3-native\">windows 10 ruby2.5 rails 5.1.5 cannot load such file -- sqlite3/sqlite3_native (LoadError)</a></p>\n\n<p>but I dont think it did anything.</p>\n\n<p>Help! Thanks (running windows 10)</p>\n\n<pre><code>Traceback (most recent call last):\n    22: from bin/rails:4:in `&lt;main&gt;'\n    21: from bin/rails:4:in `require'\n    20: from C:/Ruby25-x64/lib/ruby/gems/2.5.0/gems/railties-5.1.5/lib/rails/commands.rb:16:in `&lt;top (required)&gt;'\n    19: from C:/Ruby25-x64/lib/ruby/gems/2.5.0/gems/railties-5.1.5/lib/rails/command.rb:44:in `invoke'\n    18: from C:/Ruby25-x64/lib/ruby/gems/2.5.0/gems/railties-5.1.5/lib/rails/command/base.rb:63:in `perform'\n    17: from C:/Ruby25-x64/lib/ruby/gems/2.5.0/gems/thor-0.20.0/lib/thor.rb:387:in `dispatch'\n    16: from C:/Ruby25-x64/lib/ruby/gems/2.5.0/gems/thor-0.20.0/lib/thor/invocation.rb:126:in `invoke_command'\n    15: from C:/Ruby25-x64/lib/ruby/gems/2.5.0/gems/thor-0.20.0/lib/thor/command.rb:27:in `run'\n    14: from C:/Ruby25-x64/lib/ruby/gems/2.5.0/gems/railties-5.1.5/lib/rails/commands/server/server_command.rb:130:in `perform'\n    13: from C:/Ruby25-x64/lib/ruby/gems/2.5.0/gems/railties-5.1.5/lib/rails/commands/server/server_command.rb:130:in `tap'\n    12: from C:/Ruby25-x64/lib/ruby/gems/2.5.0/gems/railties-5.1.5/lib/rails/commands/server/server_command.rb:133:in `block in perform'\n    11: from C:/Ruby25-x64/lib/ruby/gems/2.5.0/gems/railties-5.1.5/lib/rails/commands/server/server_command.rb:133:in `require'\n    10: from C:/Users/Owner/Desktop/rubynew/tiredofthis/config/application.rb:7:in `&lt;top (required)&gt;'\n     9: from C:/Ruby25-x64/lib/ruby/gems/2.5.0/gems/bundler-1.16.1/lib/bundler.rb:114:in `require'\n     8: from C:/Ruby25-x64/lib/ruby/gems/2.5.0/gems/bundler-1.16.1/lib/bundler/runtime.rb:65:in `require'\n     7: from C:/Ruby25-x64/lib/ruby/gems/2.5.0/gems/bundler-1.16.1/lib/bundler/runtime.rb:65:in `each'\n     6: from C:/Ruby25-x64/lib/ruby/gems/2.5.0/gems/bundler-1.16.1/lib/bundler/runtime.rb:76:in `block in require'\n     5: from C:/Ruby25-x64/lib/ruby/gems/2.5.0/gems/bundler-1.16.1/lib/bundler/runtime.rb:76:in `each'\n     4: from C:/Ruby25-x64/lib/ruby/gems/2.5.0/gems/bundler-1.16.1/lib/bundler/runtime.rb:81:in `block (2 levels) in require'\n     3: from C:/Ruby25-x64/lib/ruby/gems/2.5.0/gems/bundler-1.16.1/lib/bundler/runtime.rb:81:in `require'\n     2: from C:/Ruby25-x64/lib/ruby/gems/2.5.0/gems/sqlite3-1.3.13-x64-mingw32/lib/sqlite3.rb:2:in `&lt;top (required)&gt;'\n     1: from C:/Ruby25-x64/lib/ruby/gems/2.5.0/gems/sqlite3-1.3.13-x64-mingw32/lib/sqlite3.rb:6:in `rescue in &lt;top (required)&gt;'\nC:/Ruby25-x64/lib/ruby/gems/2.5.0/gems/sqlite3-1.3.13-x64-mingw32/lib/sqlite3.rb:6:in `require': cannot load such file -- sqlite3/sqlite3_native (LoadError)\n</code></pre>\n"}, {"tags": ["ruby", "rails-i18n", "activesupport"], "comments": [{"owner": {"reputation": 30418, "user_id": 823617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DmWH1.png?s=128&g=1", "display_name": "Casper", "link": "https://stackoverflow.com/users/823617/casper"}, "edited": false, "score": 0, "creation_date": 1521728893, "post_id": 49418064, "comment_id": 85864095, "body": "Too little information. Are you using Bundler? What&#39;s the Gemfile? If not using Bundler, what are your <code>require</code> statements?"}, {"owner": {"reputation": 15, "user_id": 6534812, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c83c25a3d7b505a51d7b623f0346c4c?s=128&d=identicon&r=PG&f=1", "display_name": "Ulysses", "link": "https://stackoverflow.com/users/6534812/ulysses"}, "reply_to_user": {"reputation": 30418, "user_id": 823617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DmWH1.png?s=128&g=1", "display_name": "Casper", "link": "https://stackoverflow.com/users/823617/casper"}, "edited": false, "score": 0, "creation_date": 1521737455, "post_id": 49418064, "comment_id": 85870338, "body": "Hi @Casper i just run &quot;gem install --&quot; with the gems i need, my statements are:  <code>require &#39;firebase&#39; require &#39;conekta&#39; require &#39;json&#39; require &#39;savon&#39; require &quot;crack&quot; require &#39;active_support&#47;core_ext&#47;hash&#39;  #from_xml  require &#39;nokogiri&#39; require &#39;xmlsimple&#39; require &#39;mysql2&#39;  class Cron   </code>"}], "answers": [{"comments": [{"owner": {"reputation": 15, "user_id": 6534812, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c83c25a3d7b505a51d7b623f0346c4c?s=128&d=identicon&r=PG&f=1", "display_name": "Ulysses", "link": "https://stackoverflow.com/users/6534812/ulysses"}, "edited": false, "score": 0, "creation_date": 1521766633, "post_id": 49437107, "comment_id": 85883515, "body": "I get it! You are right it seems that the problem is solved. Thanks a lot."}], "tags": [], "owner": {"reputation": 30418, "user_id": 823617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DmWH1.png?s=128&g=1", "display_name": "Casper", "link": "https://stackoverflow.com/users/823617/casper"}, "is_accepted": true, "score": 1, "last_activity_date": 1521747532, "creation_date": 1521747532, "answer_id": 49437107, "question_id": 49418064, "link": "https://stackoverflow.com/questions/49418064/ruby-2-5-activesupport-ubuntu-conflicts-with-i18n/49437107#49437107", "title": "Ruby 2.5 activesupport ubuntu conflicts with i18n", "body": "<p>The problem seems to be that the 1.0.0 version if <code>i18n</code> was just released, but <code>activesupport</code> is not compatible with this version (<code>~&gt; 0.7</code>).</p>\n\n<p>One solution is to remove 1.0.0 system-wide, and reinstall 0.9.5 instead, which is the latest version before 1.0.0:</p>\n\n<pre><code>gem uninstall i18n --all --force\ngem install i18n --version 0.9.5\n</code></pre>\n"}], "owner": {"reputation": 15, "user_id": 6534812, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c83c25a3d7b505a51d7b623f0346c4c?s=128&d=identicon&r=PG&f=1", "display_name": "Ulysses", "link": "https://stackoverflow.com/users/6534812/ulysses"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 123, "favorite_count": 1, "accepted_answer_id": 49437107, "answer_count": 1, "score": 0, "last_activity_date": 1521747532, "creation_date": 1521674366, "question_id": 49418064, "link": "https://stackoverflow.com/questions/49418064/ruby-2-5-activesupport-ubuntu-conflicts-with-i18n", "title": "Ruby 2.5 activesupport ubuntu conflicts with i18n", "body": "<p>I wanna run a simple script with made on Ruby, when i try to run it i get the next error.</p>\n\n<pre><code>Traceback (most recent call last):\n    6: from thread.py:6:in `&lt;main&gt;'\n    5: from /root/.rbenv/versions/2.5.0/lib/ruby/2.5.0/rubygems/core_ext/kernel_require.rb:39:in `require'\n    4: from /root/.rbenv/versions/2.5.0/lib/ruby/2.5.0/rubygems/core_ext/kernel_require.rb:128:in `rescue in require'\n    3: from /root/.rbenv/versions/2.5.0/lib/ruby/2.5.0/rubygems.rb:217:in `try_activate'\n    2: from /root/.rbenv/versions/2.5.0/lib/ruby/2.5.0/rubygems.rb:224:in `rescue in try_activate'\n    1: from /root/.rbenv/versions/2.5.0/lib/ruby/2.5.0/rubygems/specification.rb:1437:in `activate'\n/root/.rbenv/versions/2.5.0/lib/ruby/2.5.0/rubygems/specification.rb:2324:in `raise_if_conflicts': Unable to activate activesupport-5.1.5, because i18n-1.0.0 conflicts with i18n (~&gt; 0.7) (Gem::ConflictError)\n</code></pre>\n\n<p>My Ruby version is:</p>\n\n<pre><code>ruby 2.5.0p0 (2017-12-25 revision 61468) [x86_64-linux]\n</code></pre>\n\n<p>Am i missing something?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-3", "jquery-ui-autocomplete", "typeahead"], "comments": [{"owner": {"reputation": 18856, "user_id": 1359650, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/dffc4318ac93e728a26c8e8b51b4eb37?s=128&d=identicon&r=PG", "display_name": "jvillian", "link": "https://stackoverflow.com/users/1359650/jvillian"}, "edited": false, "score": 2, "creation_date": 1521673375, "post_id": 49417733, "comment_id": 85837554, "body": "What is the question?"}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 2785291, "user_type": "registered", "profile_image": "https://graph.facebook.com/537779522/picture?type=large", "display_name": "&#214;zg&#252;r Erta\u015f", "link": "https://stackoverflow.com/users/2785291/%c3%96zg%c3%bcr-erta%c5%9f"}, "edited": false, "score": 0, "creation_date": 1521717590, "post_id": 49418220, "comment_id": 85855612, "body": "thank you for your kind interest, first of all  i am using a mongodb. And mongoid_search for search indexing and fast search , i think i can use it then, thanks for suggestions ... but it indexes daily with a cron job, and it will cause autocompletion problems for instantaneous records , i have to concentrate on this issue.   will pluck help me on mongodb, i had a small research on it ... and i think it is useless for mongodb , am i wrong ? I am a noobie , i am trying to learn with practicing, sorry for bothering u :))"}, {"owner": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "reply_to_user": {"reputation": 11, "user_id": 2785291, "user_type": "registered", "profile_image": "https://graph.facebook.com/537779522/picture?type=large", "display_name": "&#214;zg&#252;r Erta\u015f", "link": "https://stackoverflow.com/users/2785291/%c3%96zg%c3%bcr-erta%c5%9f"}, "edited": false, "score": 0, "creation_date": 1521721496, "post_id": 49418220, "comment_id": 85858369, "body": "<code>.pluck</code> should still be faster.  try it.  also i removed 1 line which you don&#39;t need.  Every bit helps."}], "tags": [], "owner": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "is_accepted": false, "score": 2, "last_activity_date": 1521721448, "last_edit_date": 1521721448, "creation_date": 1521675366, "answer_id": 49418220, "question_id": 49417733, "link": "https://stackoverflow.com/questions/49417733/typeahead-rails-3-autocomplete-with-user-per-request/49418220#49418220", "title": "typeahead rails 3 autocomplete with user per request", "body": "<p>The problem is you're trying to do realime searching in the database and that is not very efficient.  At least make sure you're indexing books on title. You should have a migration like:</p>\n\n<pre><code>class AddIndexOnBookTitles &lt; ActiveRecord::Migration\n  def change\n    add_index :books, :title, unique: false #or omit false if dupes not allowed.\n  end\nend\n</code></pre>\n\n<p>Then you don't want book objects, but just titles, which you should probably cache somewhere. We can talk about that later.</p>\n\n<p>Don't use <code>.map</code> on an <code>ActiveRecordRelation</code> object but instead <code>.pluck</code> to just pluck the fields you need out of the DB.</p>\n\n<pre><code>def book_titles\n  books = Book.any_of({ :title =&gt; /.*#{params[:title]}.*/ }).pluck(:title)\n  respond_to do |format|\n    format.json { render json: books }\n  end\nend\n</code></pre>\n\n<p>That still might be slow if you have a lot of books. But give that a try first and see if it's any better.  If not, we'll need to do some caching or maybe use Elasticsearch which is designed for this type of thing. </p>\n"}], "owner": {"reputation": 11, "user_id": 2785291, "user_type": "registered", "profile_image": "https://graph.facebook.com/537779522/picture?type=large", "display_name": "&#214;zg&#252;r Erta\u015f", "link": "https://stackoverflow.com/users/2785291/%c3%96zg%c3%bcr-erta%c5%9f"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 41, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1521721448, "creation_date": 1521672275, "last_edit_date": 1521674445, "question_id": 49417733, "link": "https://stackoverflow.com/questions/49417733/typeahead-rails-3-autocomplete-with-user-per-request", "title": "typeahead rails 3 autocomplete with user per request", "body": "<blockquote>\n  <p>The app is using typeahead and bootstrap 3 for, autocomplete function. \n  but now we have so many records that , it is getting really slower. </p>\n</blockquote>\n\n<pre><code>   var substringMatcher = function(strs) {\n        return function findMatches(q, cb) {\n            var matches, substrRegex;\n\n            // an array that will be populated with substring matches\n            matches = [];\n\n            // regex used to determine if a string contains the substring `q`\n            substrRegex = new RegExp(q, 'i');\n\n            // iterate through the pool of strings and for any string that\n            // contains the substring `q`, add it to the `matches` array\n            $.each(strs, function(i, str) {\n                if (substrRegex.test(str)) {\n                    // the typeahead jQuery plugin expects suggestions to a\n                    // JavaScript object, refer to typeahead docs for more info\n                    matches.push({ value: str });\n                }\n            });\n\n            cb(matches);\n        };\n    };\n</code></pre>\n\n<hr>\n\n<pre><code>$('.typeahead').each(function(elem) {\n        $(elem).typeahead({\n            hint: false,\n            highlight: true,\n            minLength: 3\n        }, {\n            displayKey: 'value',\n            source: substringMatcher($(elem).data('source'))\n        });\n    });\n</code></pre>\n\n<blockquote>\n  <p>these are javasxript parts of typeahead fuction used by the app </p>\n</blockquote>\n\n<p><strong>on the view side of the form</strong></p>\n\n<pre><code>&lt;div class=\"form-group\"&gt;\n        &lt;label class=\"col-sm-2 control-label\" for=\"typeahead_book\"&gt;Title&lt;/label&gt;\n        &lt;div class=\"col-sm-3\"&gt;\n        &lt;input value=\"&lt;%=@option.book.try(:title)%&gt;\" name=\"option[book_title]\" type=\"text\" class=\"form-control typeahead typeahead-remote-book\" id=\"typeahead_book\"  data-provide=\"typeahead\" data-items=\"10\" data-source='&lt;%=@book_titles%&gt;'&gt;\n          &lt;p class=\"help-block\"&gt;&lt;small&gt;&lt;%= $autocomplete_message %&gt;&lt;/small&gt;&lt;/p&gt;\n        &lt;/div&gt;\n</code></pre>\n\n<p></p>\n\n<p><strong>i use a callback as</strong></p>\n\n<pre><code>before_filter :get_autocomplete_lists, only: [:new, :edit]\n\ndef get_autocomplete_lists\n\n    @book_titles = Rails.cache.fetch(\"booktitles\", :force =&gt; true, expires_in: 10.minutes) do \n      Book.scoped.map(&amp;:title)\n    end\n\n\n    @publisher_names = Rails.cache.fetch(\"publishernames\", :force =&gt; true, expires_in: 10.minutes) do \n      Publisher.all.map(&amp;:name)\n    end\n\n\n    @users_by_email_name = Rails.cache.fetch(\"users\",  :force =&gt; true, expires_in: 7.days) do \n      User.scoped.map{|user| \"#{user.email} - #{user.name}\"}\n    end \n\n\n    @country_names = Rails.cache.fetch(\"countrynames\",  :force =&gt; true, expires_in: 7.days) do\n      Country.all.map(&amp;:first).sort\n    end\n    # @languages = LanguageList::COMMON_LANGUAGES.map(&amp;:name)\n    # @country_names = Anatolialit::Country::List.sort\n    # \n\n    @languages = Rails.cache.fetch(\"languages\",  :force =&gt; true, expires_in: 7.days) do \n      Anatolialit::Language::EnList.sort\n    end\n\n  end\n</code></pre>\n\n<blockquote>\n  <p>on controller that generates source of the book , as @book_titles , \n  <strong>THE APP IS WORKING NOW</strong> but i have to refactor the code for <strong>performance</strong> issues.Because after 10k record @book_titles is <strong>very big</strong>.\n  <hr>\n   <strong>THAN WHAT I DID</strong>\n  i created a new controller action on application controller</p>\n</blockquote>\n\n<pre><code>def book_titles\n     searchterm = (params[:title])\n     books =Book.any_of({ :title =&gt; /.*#{searchterm}.*/ })\n     respond_to do |format|\n      format.json { render json: books.map(&amp;:title)  }\n     end\n  end\n</code></pre>\n\n<hr>\n\n<blockquote>\n  <p>and i defined a route to use as application controller as an api service </p>\n</blockquote>\n\n<pre><code>get 'booktitles/:title' =&gt; 'application#book_titles', format: :json\n</code></pre>\n\n<blockquote>\n  <p>now when i use a localhost:3000/booktitles/the \n  it brings me as a json data all the books that indicates 'the' in the title.\n  <strong>I think everything Until here is ok.</strong> about refactoring.\n  <hr> \n  but when i use this code below for userside per request for sourcing typeahead </p>\n</blockquote>\n\n<pre><code>$(document).ready(function() {\n  $('.typeahead-remote-book').typeahead({\n      source: function (query, process) {\n          return $.get('/booktitles', { query: query }, function (data) {\n              return typeahead.process(data);\n          });\n      }\n  });\n});\n</code></pre>\n\n<hr>\n\n<blockquote>\n  <p>and i changed the view part of the form to </p>\n</blockquote>\n\n<pre><code>&lt;div class=\"form-group\"&gt;\n        &lt;label class=\"col-sm-2 control-label\" for=\"typeahead_book\"&gt;Title&lt;/label&gt;\n        &lt;div class=\"col-sm-3\"&gt;\n        &lt;input value=\"&lt;%=@option.book.try(:title)%&gt;\" name=\"option[book_title]\" type=\"text\" class=\"form-control typeahead typeahead-remote-book\" id=\"typeahead_book\"  data-provide=\"typeahead\" data-items=\"10\" &gt;\n          &lt;p class=\"help-block\"&gt;&lt;small&gt;&lt;%= $autocomplete_message %&gt;&lt;/small&gt;&lt;/p&gt;\n        &lt;/div&gt;\n      &lt;/div&gt;\n</code></pre>\n\n<p>*I do not know what is wrong with the situation , but it does not work *</p>\n\n<p>could u please help me ? about solving the problem. \nThanks for your kind help.. \nbest regards. </p>\n"}, {"tags": ["ruby", "powershell", "chef-infra"], "comments": [{"owner": {"reputation": 38170, "user_id": 57135, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/S9roh.jpg?s=128&g=1", "display_name": "Joe", "link": "https://stackoverflow.com/users/57135/joe"}, "edited": false, "score": 0, "creation_date": 1521665644, "post_id": 49416188, "comment_id": 85834418, "body": "You have to escape your interior single quotes.  Your string right now is <code>code &#39;wmic &#47;failfast:on product where &quot;name like &#39;</code> and everything after that is a syntax error."}, {"owner": {"reputation": 81, "user_id": 6781074, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b8f53452b2d094f57d94ff92499cb17a?s=128&d=identicon&r=PG&f=1", "display_name": "spunkyquagga", "link": "https://stackoverflow.com/users/6781074/spunkyquagga"}, "reply_to_user": {"reputation": 38170, "user_id": 57135, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/S9roh.jpg?s=128&g=1", "display_name": "Joe", "link": "https://stackoverflow.com/users/57135/joe"}, "edited": false, "score": 0, "creation_date": 1521666782, "post_id": 49416188, "comment_id": 85834959, "body": "@Joe If I do that, the script succeeds without any errors but it fails to do what its supposed to do, i.e, uninstall Something Enterprise.  <code>code &#39;wmic &#47;failfast:on product where &quot;name like \\&#39;Something Enterprise(64-bit)\\&#39;&quot; call uninstall &#47;nointeractive&#39;</code>"}], "answers": [{"comments": [{"owner": {"reputation": 81, "user_id": 6781074, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b8f53452b2d094f57d94ff92499cb17a?s=128&d=identicon&r=PG&f=1", "display_name": "spunkyquagga", "link": "https://stackoverflow.com/users/6781074/spunkyquagga"}, "edited": false, "score": 0, "creation_date": 1521666270, "post_id": 49416330, "comment_id": 85834706, "body": "If I do that, the script succeeds without any errors but it fails to do what its supposed to do, i.e, uninstall Something Enterprise"}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "reply_to_user": {"reputation": 81, "user_id": 6781074, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b8f53452b2d094f57d94ff92499cb17a?s=128&d=identicon&r=PG&f=1", "display_name": "spunkyquagga", "link": "https://stackoverflow.com/users/6781074/spunkyquagga"}, "edited": false, "score": 0, "creation_date": 1521666965, "post_id": 49416330, "comment_id": 85835048, "body": "That&#39;s a problem, I&#39;m sure, but it&#39;s also another question. Stack Overflow tries to keep things focused on one issue at a time. It helps crowd out these questions with lots of other confusion."}], "tags": [], "owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "is_accepted": false, "score": 1, "last_activity_date": 1521665666, "creation_date": 1521665666, "answer_id": 49416330, "question_id": 49416188, "link": "https://stackoverflow.com/questions/49416188/escaping-spaces-in-ruby/49416330#49416330", "title": "Escaping spaces in ruby", "body": "<p>You can use <code>%q[...]</code> if both other quotes are already in use:</p>\n\n<pre><code>code %q[wmic /failfast:on product where \"name like 'Something Enterprise(64-bit)'\" call uninstall /nointeractive]\n</code></pre>\n"}], "owner": {"reputation": 81, "user_id": 6781074, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b8f53452b2d094f57d94ff92499cb17a?s=128&d=identicon&r=PG&f=1", "display_name": "spunkyquagga", "link": "https://stackoverflow.com/users/6781074/spunkyquagga"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 163, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1521665685, "creation_date": 1521665156, "last_edit_date": 1521665548, "question_id": 49416188, "link": "https://stackoverflow.com/questions/49416188/escaping-spaces-in-ruby", "title": "Escaping spaces in ruby", "body": "<p>When I execute the following script block, I get an error:</p>\n\n<pre><code>powershell_script 'uninstall_something' do\n   code 'wmic /failfast:on product where \"name like 'Something Enterprise(64-bit)'\" call uninstall /nointeractive'\n   guard_interpreter :powershell_script\nend\n\nFATAL: SyntaxError: .\\check.rb:6: syntax error, unexpected tCONSTANT, expecting keyword_end\n...roduct where \"name like 'Something Enterprise(64-bit)'\" call un...\n                                     ^\n.\\check.rb:6: syntax error, unexpected tSTRING_BEG, expecting keyword_end\n...ike 'Something Enterprise(64-bit)'\" call uninstall /nointeracti...\n                                     ^\n</code></pre>\n\n<p>I have tried escaping the spaces but I still get the error. If I execute the same PowerShell command in PowerShell, I don't get any error.\nWhat am I missing?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-5"], "answers": [{"tags": [], "owner": {"reputation": 14010, "user_id": 3109182, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/a4b305f0077055b4fdcf715067775d5a?s=128&d=identicon&r=PG", "display_name": "Anthony", "link": "https://stackoverflow.com/users/3109182/anthony"}, "is_accepted": false, "score": 1, "last_activity_date": 1521665232, "creation_date": 1521665232, "answer_id": 49416210, "question_id": 49415896, "link": "https://stackoverflow.com/questions/49415896/rails-how-to-calculate-running-total-on-a-view/49416210#49416210", "title": "Rails How to calculate Running Total on a View?", "body": "<p>Assuming a <code>Transaction</code> is one single transaction for a user, you'd want to do something like:</p>\n\n<p><code>current_user.transactions.pluck(:amount).sum</code></p>\n"}, {"comments": [{"owner": {"reputation": 496, "user_id": 2332309, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/2a70bf66549b8673723a7d9d4422932a?s=128&d=identicon&r=PG", "display_name": "Kevin Custer", "link": "https://stackoverflow.com/users/2332309/kevin-custer"}, "edited": false, "score": 0, "creation_date": 1521941143, "post_id": 49416320, "comment_id": 85945973, "body": "thank you so much for the example.  With this app being a simple place where users can balance their accounts like a handwritten check register, I do want to allow editing of transactions, but I\u2019m a bit lost on how to approach the updating of running balances for all later transactions. Could you help a rails newbie get started? I\u2019m mainly stuck on syntax of doing what I need to do. Much thanks!"}, {"owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "reply_to_user": {"reputation": 496, "user_id": 2332309, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/2a70bf66549b8673723a7d9d4422932a?s=128&d=identicon&r=PG", "display_name": "Kevin Custer", "link": "https://stackoverflow.com/users/2332309/kevin-custer"}, "edited": false, "score": 1, "creation_date": 1521959463, "post_id": 49416320, "comment_id": 85948707, "body": "@odinsride: I updated my answer to address your requirement to be able to update existing amounts."}, {"owner": {"reputation": 496, "user_id": 2332309, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/2a70bf66549b8673723a7d9d4422932a?s=128&d=identicon&r=PG", "display_name": "Kevin Custer", "link": "https://stackoverflow.com/users/2332309/kevin-custer"}, "edited": false, "score": 0, "creation_date": 1521991324, "post_id": 49416320, "comment_id": 85957372, "body": "thanks very much, I would have pulled my hair out trying to come up with this! It covers some things I haven\u2019t yet learned so I will read up a bit :) Thank you again!"}, {"owner": {"reputation": 496, "user_id": 2332309, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/2a70bf66549b8673723a7d9d4422932a?s=128&d=identicon&r=PG", "display_name": "Kevin Custer", "link": "https://stackoverflow.com/users/2332309/kevin-custer"}, "edited": false, "score": 0, "creation_date": 1522092675, "post_id": 49416320, "comment_id": 86002472, "body": "please see my updates in the original post. I am having difficulty with the subsequent transactions running balance getting updated.  Thank you!"}, {"owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "reply_to_user": {"reputation": 496, "user_id": 2332309, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/2a70bf66549b8673723a7d9d4422932a?s=128&d=identicon&r=PG", "display_name": "Kevin Custer", "link": "https://stackoverflow.com/users/2332309/kevin-custer"}, "edited": false, "score": 0, "creation_date": 1522134770, "post_id": 49416320, "comment_id": 86016949, "body": "I am a bit confused about your attributes names, there are <code>current_balance</code> and <code>running_balance</code>. Because the original question is solved I would suggest starting a new question with the new problem."}, {"owner": {"reputation": 496, "user_id": 2332309, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/2a70bf66549b8673723a7d9d4422932a?s=128&d=identicon&r=PG", "display_name": "Kevin Custer", "link": "https://stackoverflow.com/users/2332309/kevin-custer"}, "edited": false, "score": 0, "creation_date": 1522159497, "post_id": 49416320, "comment_id": 86034917, "body": "Current_balance is stored with the account model, which is updated after any transaction is made or updated for the account. Running_balance is stored in the transaction model. I will post a new question, thank you!"}], "tags": [], "owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "is_accepted": true, "score": 1, "last_activity_date": 1521959400, "last_edit_date": 1521959400, "creation_date": 1521665643, "answer_id": 49416320, "question_id": 49415896, "link": "https://stackoverflow.com/questions/49415896/rails-how-to-calculate-running-total-on-a-view/49416320#49416320", "title": "Rails How to calculate Running Total on a View?", "body": "<p>I would store the running total in the database next to the debits and credits.</p>\n\n<p>Why?</p>\n\n<ol>\n<li>You do not want to recalculate the running total on every page view.</li>\n<li>You do not want to calculate the current running total starting from a 0 years ago when all you want is the today's balance.</li>\n</ol>\n\n<p>That said: Optimize for reading your data and calculate the balance when you save a new debit or credit row into your database.</p>\n\n<p>To implement a calculation-on-save just basically need to change two things:</p>\n\n<p>A migration to add a balance column and to backfill existing records. The format of the column (integer, decimal) depends on your setup, same for how to scope the backfill (I assume by a user):</p>\n\n<pre><code>def up\n  add_column :transactions, :balance, :integer\n\n  # This is just a quick and dirty implementation and will run very \n  # slowly. But for a few thousand records it might be fast enough.\n  User.find_each { |user| user.transactions.first.try(:save) }\n\n  change_column_null :transactions, :balance, false\nend\n\ndef down\n  drop_column :transactions, :balance\nend\n</code></pre>\n\n<p>And two callback in your model:</p>\n\n<pre><code>before_save :set_running_balance\nafter_save :recalculate_running_balance, on: :update\n\nprivate\n\ndef set_running_balance\n  previous_balance = previous_transaction_for_user.try(:balance) || 0\n  self.balance = previous_balance + amount\nend\n\ndef recalculate_running_balance\n  # this will recursively trigger the `recalculate_next_running_balance` \n  # callback on the following transactions and thereby update all later \n  # transactions\n  next_transaction_for_user.try(:save)\nend\n\ndef previous_transaction_for_user\n  scope = Transaction.where(user: user).order(:id)\n  scope = scope.where('id &lt; ?', id) if persisted?\n\n  scope.last\nend\n\ndef next_transaction_for_user\n  return if new_record?\n\n  Transaction.where(user: user).where('id &gt; ?', id).order(:id).first\nend\n</code></pre>\n\n<p>With these changes, you should be able to present a running balance even on paginated or filtered pages with a simple <code>&lt;%= transaction.balance %&gt;</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 1, "creation_date": 1521698959, "post_id": 49417060, "comment_id": 85844222, "body": "As I wrote before: This only works if you show all transactions since the account was opened or since it had a balance of 0 of other reasons on the one page. As soon as you start with pagination, filters or flexible time range you will not be able anymore to show a correct running balance with this calculation in the view."}, {"owner": {"reputation": 496, "user_id": 2332309, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/2a70bf66549b8673723a7d9d4422932a?s=128&d=identicon&r=PG", "display_name": "Kevin Custer", "link": "https://stackoverflow.com/users/2332309/kevin-custer"}, "reply_to_user": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 0, "creation_date": 1521840360, "post_id": 49417060, "comment_id": 85919934, "body": "You\u2019re right about this. I ran into the issue today when adding pagination :). I had tried storing the value in DB but got overwhelmed when I realized for example editing a transaction from 3 days ago would require recalculating the running total for all transactions entered afterward. I\u2019m still on the fence as to how to approach this."}], "tags": [], "owner": {"reputation": 496, "user_id": 2332309, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/2a70bf66549b8673723a7d9d4422932a?s=128&d=identicon&r=PG", "display_name": "Kevin Custer", "link": "https://stackoverflow.com/users/2332309/kevin-custer"}, "is_accepted": false, "score": 0, "last_activity_date": 1521668821, "creation_date": 1521668821, "answer_id": 49417060, "question_id": 49415896, "link": "https://stackoverflow.com/questions/49415896/rails-how-to-calculate-running-total-on-a-view/49417060#49417060", "title": "Rails How to calculate Running Total on a View?", "body": "<p>I tried the suggestion about using pluck but I couldn't get it to work.  I may consider moving this logic to a database column but I feel that would be more complex than the solution I came up with. I ended up doing this in my view to achieve what I need.  If there's a better way of doing this in the model or somewhere else I'm open to advice. Thanks!</p>\n\n<pre><code>&lt;% @running_balance = 0 %&gt;\n&lt;% @transactions.each do |transaction| %&gt;\n    &lt;% @running_balance = @running_balance + transaction.amount %&gt;\n    &lt;tr class=\"row m-0\"&gt;\n        &lt;td class=\"col-sm-1 text-center\"&gt;&lt;%= link_to transaction.id, [transaction.account, transaction] %&gt;&lt;/td&gt;\n        &lt;td class=\"col-sm-1 text-center\"&gt;&lt;%= transaction.trx_date.strftime('%m/%d/%Y') %&gt;&lt;/td&gt;\n        &lt;td class=\"col-sm-4\"&gt;&lt;%= transaction.description %&gt;&lt;/td&gt;\n        &lt;td class=\"col-sm-2 text-right\"&gt;&lt;%= if transaction.amount &gt;= 0 then number_to_currency(transaction.amount) end %&gt;&lt;/td&gt;\n        &lt;td class=\"col-sm-2 text-right\"&gt;&lt;%= if transaction.amount &lt; 0 then \"(\" + number_to_currency(transaction.amount.abs) + \")\" end %&gt;&lt;/td&gt;\n        &lt;td class=\"col-sm-2 text-right\"&gt;&lt;%= number_to_currency(@running_balance) %&gt;&lt;/td&gt;\n    &lt;/tr&gt;\n&lt;% end %&gt;\n</code></pre>\n"}], "owner": {"reputation": 496, "user_id": 2332309, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/2a70bf66549b8673723a7d9d4422932a?s=128&d=identicon&r=PG", "display_name": "Kevin Custer", "link": "https://stackoverflow.com/users/2332309/kevin-custer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 521, "favorite_count": 0, "accepted_answer_id": 49416320, "answer_count": 3, "score": 0, "last_activity_date": 1522092604, "creation_date": 1521663922, "last_edit_date": 1522092604, "question_id": 49415896, "link": "https://stackoverflow.com/questions/49415896/rails-how-to-calculate-running-total-on-a-view", "title": "Rails How to calculate Running Total on a View?", "body": "<p>I am making a financial application and I would like to display a running total for the balance in my view, similar to how most online banking platforms work.  I am not sure how to do this.  I store credits as positive numbers and debits as negative numbers in my database.  So I would basically need to sort by date, and add the amounts cumulatively for a new column in my view to display the running balance.</p>\n\n<p>In my model I have defined this, based on lots of searching here:</p>\n\n<pre><code>    def running_total\n       running_total = self.inject(0) { |sum, p| sum + p.amount }\n    end\n</code></pre>\n\n<p>But it does not seem to be working.  I get the error:</p>\n\n<blockquote>\n  <p>undefined method `inject' for #&lt;Transaction:0x00007f15bd9dae70>\n  Did you mean?  inspect</p>\n</blockquote>\n\n<p>Any ideas would be appreciated, thanks!</p>\n\n<h1>Updates:</h1>\n\n<p>Per the advice of @spickermann, I have made some updates to my code, and the running balance is now being calculated properly when creating a new transaction or modifying an old one, but I am still having trouble getting the subsequent records to update the running balance when editing a previous transaction.  As seen in the console, the previous_transaction method is getting fired to select transactions later than the one I'm editing, but the value is not getting updated in the database.  </p>\n\n<p><strong>transaction.rb</strong></p>\n\n<pre><code>class Transaction &lt; ApplicationRecord\n    belongs_to :account\n    attr_accessor :trx_type\n\n    #default_scope { order('trx_date, id DESC') }\n    validates_presence_of :trx_type, :message =&gt; \"Please select debit or credit\"\n    validates :trx_date, presence: true\n    validates :description, presence: true, length: { maximum: 150 }\n    validates :amount, presence: true, numericality: { greater_than_or_equal_to: 0 }\n    validates :memo, length: { maximum: 500 }\n\n    before_save :convert_amount, :set_running_balance\n    after_create :update_account_balance_new\n    after_update :update_account_balance_edit\n    after_destroy :update_account_balance_destroy\n    after_save :recalculate_running_balance, on: :update\n\n    scope :desc, -&gt; { order('trx_date, id DESC') }\n\n    # Determine the transaction_type for existing records based on amount\n    def transaction_type\n        if !new_record?\n            if self.amount &gt;= 0\n                return ['Credit', 'credit']\n            else\n                return ['Debit', 'debit']\n            end\n        else\n            return ['Debit', 'debit']\n        end\n    end\n\nprivate\n\n    def set_running_balance\n        previous_balance = previous_transaction.try(:running_balance) || 0\n        self.running_balance = previous_balance + amount\n    end\n\n    def recalculate_running_balance\n        # this will recursively trigger the `recalculate_next_running_balance` \n        # callback on the following transactions and thereby update all later \n        # transactions\n        next_transaction.try(:save)\n    end\n\n    def previous_transaction\n        scope = Transaction.where(account: account).order(:id)\n        scope = scope.where('id &lt; ?', id) if persisted?\n\n        scope.last\n    end\n\n    def next_transaction\n        return if new_record?\n\n        Transaction.where(account: account).where('id &gt; ?', id).order(:id).first\n    end\n\n    def convert_amount\n        if self.trx_type == \"debit\"\n            self.amount = -self.amount.abs\n        end\n    end\n\n    def update_account_balance_new\n        @account = Account.find(account_id)\n        @account.update_attributes(current_balance: @account.current_balance + amount)\n    end\n\n    def update_account_balance_edit\n        @account = Account.find(account_id)\n        if saved_change_to_amount?\n            @account.update_attributes(current_balance: @account.current_balance - amount_was + amount)\n        end\n    end\n\n    def update_account_balance_destroy\n        @account = Account.find(account_id)\n        @account.update_attributes(current_balance: @account.current_balance - amount_was)\n    end\n\nend\n</code></pre>\n\n<p><strong>Console</strong></p>\n\n<pre><code>Processing by TransactionsController#update as HTML\n  Parameters: {\"utf8\"=&gt;\"\u2713\", \"authenticity_token\"=&gt;\"9GuEIo7a7OUAMA3O26keE8zOlptfzd+F9Enp43hl0A7sh/5ioTDAud0AzLriOWiquU+wbyOoDgK8o6z9OZyLzA==\", \"transaction\"=&gt;{\"trx_type\"=&gt;\"debit\", \"trx_date(1i)\"=&gt;\"2018\", \"trx_date(2i)\"=&gt;\"3\", \"trx_date(3i)\"=&gt;\"26\", \"description\"=&gt;\"Meijer\", \"amount\"=&gt;\"100.00\", \"memo\"=&gt;\"\"}, \"commit\"=&gt;\"Update Transaction\", \"account_id\"=&gt;\"3\", \"id\"=&gt;\"21\"}\n  User Load (0.5ms)  SELECT  \"users\".* FROM \"users\" WHERE \"users\".\"id\" = $1 ORDER BY \"users\".\"id\" ASC LIMIT $2  [[\"id\", 1], [\"LIMIT\", 1]]\n  Account Load (0.5ms)  SELECT  \"accounts\".* FROM \"accounts\" WHERE \"accounts\".\"user_id\" = $1 AND \"accounts\".\"id\" = $2 LIMIT $3  [[\"user_id\", 1], [\"id\", 3], [\"LIMIT\", 1]]\n  Transaction Load (0.4ms)  SELECT  \"transactions\".* FROM \"transactions\" WHERE \"transactions\".\"account_id\" = $1 AND \"transactions\".\"id\" = $2 LIMIT $3  [[\"account_id\", 3], [\"id\", 21], [\"LIMIT\", 1]]\n   (0.1ms)  BEGIN\n  Transaction Load (0.4ms)  SELECT  \"transactions\".* FROM \"transactions\" WHERE \"transactions\".\"account_id\" = 3 AND (id &lt; 21) ORDER BY \"transactions\".\"id\" DESC LIMIT $1  [[\"LIMIT\", 1]]\n  SQL (0.7ms)  UPDATE \"transactions\" SET \"amount\" = $1, \"running_balance\" = $2, \"updated_at\" = $3 WHERE \"transactions\".\"id\" = $4  [[\"amount\", \"-100.0\"], [\"running_balance\", \"1800.0\"], [\"updated_at\", \"2018-03-26 15:14:53.354282\"], [\"id\", 21]]\n  Account Load (0.2ms)  SELECT  \"accounts\".* FROM \"accounts\" WHERE \"accounts\".\"id\" = $1 LIMIT $2  [[\"id\", 3], [\"LIMIT\", 1]]\nDEPRECATION WARNING: The behavior of `attribute_was` inside of after callbacks will be changing in the next version of Rails. The new return value will reflect the behavior of calling the method after `save` returned (e.g. the opposite of what it returns now). To maintain the current behavior, use `attribute_before_last_save` instead. (called from update_account_balance_edit at /home/sitheris/dev/railsapps/olubalance/app/models/transaction.rb:85)\nDEPRECATION WARNING: The behavior of `attribute_changed?` inside of after callbacks will be changing in the next version of Rails. The new return value will reflect the behavior of calling the method after `save` returned (e.g. the opposite of what it returns now). To maintain the current behavior, use `saved_change_to_attribute?` instead. (called from update_account_balance_edit at /home/sitheris/dev/railsapps/olubalance/app/models/transaction.rb:85)\nDEPRECATION WARNING: The behavior of `changed_attributes` inside of after callbacks will be changing in the next version of Rails. The new return value will reflect the behavior of calling the method after `save` returned (e.g. the opposite of what it returns now). To maintain the current behavior, use `saved_changes.transform_values(&amp;:first)` instead. (called from update_account_balance_edit at /home/sitheris/dev/railsapps/olubalance/app/models/transaction.rb:85)\n  User Load (0.3ms)  SELECT  \"users\".* FROM \"users\" WHERE \"users\".\"id\" = $1 LIMIT $2  [[\"id\", 1], [\"LIMIT\", 1]]\n  SQL (0.3ms)  UPDATE \"accounts\" SET \"current_balance\" = $1, \"updated_at\" = $2 WHERE \"accounts\".\"id\" = $3  [[\"current_balance\", \"1200.0\"], [\"updated_at\", \"2018-03-26 15:14:53.358782\"], [\"id\", 3]]\nNEXT TRANSACTION\n  Transaction Load (0.3ms)  SELECT  \"transactions\".* FROM \"transactions\" WHERE \"transactions\".\"account_id\" = 3 AND (id &gt; 21) ORDER BY \"transactions\".\"id\" ASC LIMIT $1  [[\"LIMIT\", 1]]\n  Account Load (0.2ms)  SELECT  \"accounts\".* FROM \"accounts\" WHERE \"accounts\".\"id\" = $1 LIMIT $2  [[\"id\", 3], [\"LIMIT\", 1]]\n   (3.5ms)  COMMIT\nRedirected to http://localhost:3000/accounts/3/transactions/21\nCompleted 302 Found in 22ms (ActiveRecord: 7.4ms)\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-5"], "comments": [{"owner": {"reputation": 1812, "user_id": 9104680, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e2d06cc56c31f995950c00602a0e7d?s=128&d=identicon&r=PG", "display_name": "Derek Hopper", "link": "https://stackoverflow.com/users/9104680/derek-hopper"}, "edited": false, "score": 0, "creation_date": 1521663716, "post_id": 49415704, "comment_id": 85833457, "body": "Have you thought about adding a <code>person</code> method to Person that returns self? That might get you what you want (although you could argue it&#39;s a bit odd)."}, {"owner": {"reputation": 1035, "user_id": 1562489, "user_type": "registered", "accept_rate": 51, "profile_image": "https://i.stack.imgur.com/ApdKz.jpg?s=128&g=1", "display_name": "David Sigley", "link": "https://stackoverflow.com/users/1562489/david-sigley"}, "reply_to_user": {"reputation": 1812, "user_id": 9104680, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e2d06cc56c31f995950c00602a0e7d?s=128&d=identicon&r=PG", "display_name": "Derek Hopper", "link": "https://stackoverflow.com/users/9104680/derek-hopper"}, "edited": false, "score": 0, "creation_date": 1521664184, "post_id": 49415704, "comment_id": 85833691, "body": "That is a little bit odd. But it would definitely work. Can you think of any problems this might cause? and do you think it would be considered as hacky?"}, {"owner": {"reputation": 1812, "user_id": 9104680, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e2d06cc56c31f995950c00602a0e7d?s=128&d=identicon&r=PG", "display_name": "Derek Hopper", "link": "https://stackoverflow.com/users/9104680/derek-hopper"}, "edited": false, "score": 0, "creation_date": 1521664862, "post_id": 49415704, "comment_id": 85834053, "body": "Just throwing out some ideas: In the long term, you might come back to it and ask, &quot;Why do I need a person method on Person?&quot; You could argue that maybe this question indicates a code smell i.e. maybe there&#39;s a better way to design what you&#39;re trying to accomplish. You could also say that if you need to do something special for Person, is this really a concern for Person? Just throwing out my immediate thoughts - I could be totally wrong here."}, {"owner": {"reputation": 1035, "user_id": 1562489, "user_type": "registered", "accept_rate": 51, "profile_image": "https://i.stack.imgur.com/ApdKz.jpg?s=128&g=1", "display_name": "David Sigley", "link": "https://stackoverflow.com/users/1562489/david-sigley"}, "reply_to_user": {"reputation": 1812, "user_id": 9104680, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e2d06cc56c31f995950c00602a0e7d?s=128&d=identicon&r=PG", "display_name": "Derek Hopper", "link": "https://stackoverflow.com/users/9104680/derek-hopper"}, "edited": false, "score": 0, "creation_date": 1521666641, "post_id": 49415704, "comment_id": 85834899, "body": "Those are very good points, I totally agree with you. I do like the simple implementation though :)"}], "answers": [{"comments": [{"owner": {"reputation": 1035, "user_id": 1562489, "user_type": "registered", "accept_rate": 51, "profile_image": "https://i.stack.imgur.com/ApdKz.jpg?s=128&g=1", "display_name": "David Sigley", "link": "https://stackoverflow.com/users/1562489/david-sigley"}, "edited": false, "score": 0, "creation_date": 1521663789, "post_id": 49415777, "comment_id": 85833488, "body": "Ok, so that would stop me from calling it from the context of Person? Maybe I asked the question incorrectly.. but I would like to be able to call from Person and it&#39;ll still work"}], "tags": [], "owner": {"reputation": 1296, "user_id": 8377250, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3705bb7e15384ec8a6b41f60d59b3e10?s=128&d=identicon&r=PG&f=1", "display_name": "mindlis", "link": "https://stackoverflow.com/users/8377250/mindlis"}, "is_accepted": true, "score": 0, "last_activity_date": 1521664495, "last_edit_date": 1521664495, "creation_date": 1521663469, "answer_id": 49415777, "question_id": 49415704, "link": "https://stackoverflow.com/questions/49415704/having-a-model-concern-when-the-models-dont-have-standardised-methods-in-them/49415777#49415777", "title": "Having a model Concern when the models don&#39;t have standardised methods in them", "body": "<p>You can check the record for its type first:</p>\n\n<pre><code>def authorised_items?\n  record = is_a?(Person) ? self : self.person\n  record.authorised?\nend\n</code></pre>\n"}], "owner": {"reputation": 1035, "user_id": 1562489, "user_type": "registered", "accept_rate": 51, "profile_image": "https://i.stack.imgur.com/ApdKz.jpg?s=128&g=1", "display_name": "David Sigley", "link": "https://stackoverflow.com/users/1562489/david-sigley"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 39, "favorite_count": 0, "accepted_answer_id": 49415777, "answer_count": 1, "score": 0, "last_activity_date": 1521664495, "creation_date": 1521663159, "question_id": 49415704, "link": "https://stackoverflow.com/questions/49415704/having-a-model-concern-when-the-models-dont-have-standardised-methods-in-them", "title": "Having a model Concern when the models don&#39;t have standardised methods in them", "body": "<p>I have a Concern that expects all models using it to have a <code>.person</code> function. </p>\n\n<p>The models using it are:\n<code>Bike</code> <code>House</code> <code>Person</code> <code>Garden</code></p>\n\n<p>All of these belong to <code>Person</code> with the exception of <code>Person</code> itself and my concern calls <code>self.person</code> in order to fetch the <code>Person</code> object. </p>\n\n<p>I don't really want to duplicate this code just for <code>Person</code> so I'm wondering what the best solution could be?</p>\n\n<p>Here's why I need it</p>\n\n<pre><code># concern.rb\ndef unauthorised_items?\n  self.person.authorised? # self.person isn't found when calling from a Person instance\nend\n</code></pre>\n\n<p>Whats the best way to keep this concern belonging to <code>Person</code>. I'm happy to make adjustments if I need to.</p>\n\n<p>In reality it's a much larger method, hence why I don't want to repeat it elsewhere just so I can switch <code>self.person.authorised?</code> with <code>self.authorised?</code></p>\n\n<p>Thanks</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "answers": [{"tags": [], "owner": {"reputation": 27144, "user_id": 3857758, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/58c4295826435f049b7fc32b98c240f9?s=128&d=identicon&r=PG&f=1", "display_name": "Ursus", "link": "https://stackoverflow.com/users/3857758/ursus"}, "is_accepted": true, "score": 5, "last_activity_date": 1549467841, "last_edit_date": 1549467841, "creation_date": 1521661314, "answer_id": 49415247, "question_id": 49415219, "link": "https://stackoverflow.com/questions/49415219/is-the-foreign-key-column-required-when-creating-an-object/49415247#49415247", "title": "Is the foreign_key column required when creating an object?", "body": "<p>It's required by default since rails 5. Unless you specify it's not</p>\n\n<pre><code>class Book &lt; ApplicationRecord\n  belongs_to :author, optional: true\nend\n</code></pre>\n"}], "owner": {"reputation": 485, "user_id": 7399323, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/64e3a4116517813a2042aed29f841ede?s=128&d=identicon&r=PG&f=1", "display_name": "evans", "link": "https://stackoverflow.com/users/7399323/evans"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 40, "favorite_count": 0, "accepted_answer_id": 49415247, "answer_count": 1, "score": 2, "last_activity_date": 1549467841, "creation_date": 1521661196, "question_id": 49415219, "link": "https://stackoverflow.com/questions/49415219/is-the-foreign-key-column-required-when-creating-an-object", "title": "Is the foreign_key column required when creating an object?", "body": "<p>I have two models:  </p>\n\n<pre><code>class Author &lt; ApplicationRecord\n  has_many :books\nend\n\nclass Book &lt; ApplicationRecord\n  belongs_to :author\nend\n</code></pre>\n\n<p><code>Book</code> have <code>author_id</code>. \nIs it possible to create a <code>Book</code> without specifying <code>author_id</code>, or is this attribute required?<br>\nerror: <code>Author must be exist</code></p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 4348, "user_id": 3435610, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/IBOFX.jpg?s=128&g=1", "display_name": "Sara Tibbetts", "link": "https://stackoverflow.com/users/3435610/sara-tibbetts"}, "edited": false, "score": 0, "creation_date": 1521660953, "post_id": 49415138, "comment_id": 85831968, "body": "Are you trying to have an entire rails project in one file?"}, {"owner": {"reputation": 3, "user_id": 9211359, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d917a4d7bb4c8e5622c9f08173f0201c?s=128&d=identicon&r=PG&f=1", "display_name": "olaf", "link": "https://stackoverflow.com/users/9211359/olaf"}, "reply_to_user": {"reputation": 4348, "user_id": 3435610, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/IBOFX.jpg?s=128&g=1", "display_name": "Sara Tibbetts", "link": "https://stackoverflow.com/users/3435610/sara-tibbetts"}, "edited": false, "score": 0, "creation_date": 1521661016, "post_id": 49415138, "comment_id": 85831995, "body": "Yes, that&#39;s exactly what I&#39;m trying to do! However, the code needs to be presented in the appendix of a report."}, {"owner": {"reputation": 4348, "user_id": 3435610, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/IBOFX.jpg?s=128&g=1", "display_name": "Sara Tibbetts", "link": "https://stackoverflow.com/users/3435610/sara-tibbetts"}, "edited": false, "score": 0, "creation_date": 1521661074, "post_id": 49415138, "comment_id": 85832031, "body": "Checkout this blog post: <a href=\"https://christoph.luppri.ch/articles/rails/single-file-rails-applications-for-fun-and-bug-reporting/\" rel=\"nofollow noreferrer\">christoph.luppri.ch/articles/rails/&hellip;</a>"}, {"owner": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "edited": false, "score": 0, "creation_date": 1521672695, "post_id": 49415138, "comment_id": 85837307, "body": "Combining the contents of all the files in a directory into a single file (recursively) is very much possible. But presenting it in an order that makes sense is much more challenging."}], "answers": [{"comments": [{"owner": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "edited": false, "score": 0, "creation_date": 1521666264, "post_id": 49415211, "comment_id": 85834703, "body": "This answer relies solely on a link and is thus worthless if the link is broken."}, {"owner": {"reputation": 4348, "user_id": 3435610, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/IBOFX.jpg?s=128&g=1", "display_name": "Sara Tibbetts", "link": "https://stackoverflow.com/users/3435610/sara-tibbetts"}, "reply_to_user": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "edited": false, "score": 0, "creation_date": 1521671437, "post_id": 49415211, "comment_id": 85836940, "body": "@max The link is merely an example where it has been done.  The answer is in the words following."}], "tags": [], "owner": {"reputation": 4348, "user_id": 3435610, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/IBOFX.jpg?s=128&g=1", "display_name": "Sara Tibbetts", "link": "https://stackoverflow.com/users/3435610/sara-tibbetts"}, "is_accepted": true, "score": 1, "last_activity_date": 1521661161, "creation_date": 1521661161, "answer_id": 49415211, "question_id": 49415138, "link": "https://stackoverflow.com/questions/49415138/is-it-possible-to-see-the-underlying-ruby-code-in-rails/49415211#49415211", "title": "Is it possible to see the underlying Ruby code in Rails?", "body": "<p>Yes, it is technically possible.  Here is an example of where it was done: </p>\n\n<p><a href=\"https://gist.github.com/clupprich/0e8b816883ca4dac6b7632a9e8351c48\" rel=\"nofollow noreferrer\">https://gist.github.com/clupprich/0e8b816883ca4dac6b7632a9e8351c48</a></p>\n\n<p>This was done manually though, so if you have an existing application, the only way to do this is manually. </p>\n\n<p>Also, I would not suggest this, as the directory structure is setup the way it is for a reason. </p>\n"}], "owner": {"reputation": 3, "user_id": 9211359, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d917a4d7bb4c8e5622c9f08173f0201c?s=128&d=identicon&r=PG&f=1", "display_name": "olaf", "link": "https://stackoverflow.com/users/9211359/olaf"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 47, "favorite_count": 0, "accepted_answer_id": 49415211, "answer_count": 1, "score": 0, "last_activity_date": 1521661161, "creation_date": 1521660873, "question_id": 49415138, "link": "https://stackoverflow.com/questions/49415138/is-it-possible-to-see-the-underlying-ruby-code-in-rails", "title": "Is it possible to see the underlying Ruby code in Rails?", "body": "<p>I'm currently doing my Final Year Project so I need to include code as part of the submission. Rails generate directories of different files, rather than a block of code that can be copy pasted. If there isn't is there a workaround to submit Rails code in a presentable manner.</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 48413, "user_id": 1279683, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1veuT.jpg?s=128&g=1", "display_name": "Marek Lipka", "link": "https://stackoverflow.com/users/1279683/marek-lipka"}, "edited": false, "score": 0, "creation_date": 1521659401, "post_id": 49414722, "comment_id": 85831108, "body": "The way you described your problem doesn&#39;t make any sense. You defined function without any arguments yet you try to call it with one (<code>change_key(x)</code>). What is this <code>change_key</code> method?"}, {"owner": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "edited": false, "score": 0, "creation_date": 1521659520, "post_id": 49414722, "comment_id": 85831173, "body": "Your method is in the model which has no access to <code>params</code> by default.  Also your method needs to be defined to take an argument if you intend to pass it one."}, {"owner": {"reputation": 15, "user_id": 9530698, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5f9c7ece3ede197da49891537a59f5d7?s=128&d=identicon&r=PG&f=1", "display_name": "Argiris Kats", "link": "https://stackoverflow.com/users/9530698/argiris-kats"}, "edited": false, "score": 0, "creation_date": 1521659589, "post_id": 49414722, "comment_id": 85831215, "body": "the change_key method changes the public_key attribute of every User created. That is the question, how can I pass an argument to a function of Model?"}, {"owner": {"reputation": 48413, "user_id": 1279683, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1veuT.jpg?s=128&g=1", "display_name": "Marek Lipka", "link": "https://stackoverflow.com/users/1279683/marek-lipka"}, "edited": false, "score": 0, "creation_date": 1521659589, "post_id": 49414722, "comment_id": 85831217, "body": "Not to mention that if you call this kind of method in view, you&#39;re probably doing something wrong."}, {"owner": {"reputation": 48413, "user_id": 1279683, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1veuT.jpg?s=128&g=1", "display_name": "Marek Lipka", "link": "https://stackoverflow.com/users/1279683/marek-lipka"}, "edited": false, "score": 1, "creation_date": 1521659639, "post_id": 49414722, "comment_id": 85831247, "body": "Take a look: <a href=\"https://en.wikibooks.org/wiki/Ruby_Programming/Syntax/Method_Calls\" rel=\"nofollow noreferrer\">en.wikibooks.org/wiki/Ruby_Programming/Syntax/Method_Calls</a>"}], "answers": [{"comments": [{"owner": {"reputation": 15, "user_id": 9530698, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5f9c7ece3ede197da49891537a59f5d7?s=128&d=identicon&r=PG&f=1", "display_name": "Argiris Kats", "link": "https://stackoverflow.com/users/9530698/argiris-kats"}, "edited": false, "score": 0, "creation_date": 1521659801, "post_id": 49414826, "comment_id": 85831328, "body": "I get &quot;wrong number of arguments (given 0, expected 1)&quot; when I try this"}, {"owner": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "reply_to_user": {"reputation": 15, "user_id": 9530698, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5f9c7ece3ede197da49891537a59f5d7?s=128&d=identicon&r=PG&f=1", "display_name": "Argiris Kats", "link": "https://stackoverflow.com/users/9530698/argiris-kats"}, "edited": false, "score": 0, "creation_date": 1521659868, "post_id": 49414826, "comment_id": 85831369, "body": "<code>x</code> needs to be defined before you pass it to a method. so first try <code>x = &#39;foo&#39;</code> then call the method with x or just do <code>change_key(&#39;foo&#39;)</code>"}], "tags": [], "owner": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "is_accepted": false, "score": 0, "last_activity_date": 1521659618, "creation_date": 1521659618, "answer_id": 49414826, "question_id": 49414722, "link": "https://stackoverflow.com/questions/49414722/rails-how-to-give-an-argument-to-model-function/49414826#49414826", "title": "RAILS How to give an argument to Model function", "body": "<p>Your method needs to expect an argument:</p>\n\n<pre><code>def change_key(arg)\n  self.public_key = arg\nend\n</code></pre>\n\n<p>However since this is a model method, it should not be called directly in the view as this is not MVC.  But if you wanted to use it in a controller action, that might work.  You'd need to define a controller action and maybe use javascript to make an ajax request to your controller action, where it could then operate on your model.</p>\n"}, {"comments": [{"owner": {"reputation": 15, "user_id": 9530698, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5f9c7ece3ede197da49891537a59f5d7?s=128&d=identicon&r=PG&f=1", "display_name": "Argiris Kats", "link": "https://stackoverflow.com/users/9530698/argiris-kats"}, "edited": false, "score": 0, "creation_date": 1521661407, "post_id": 49414895, "comment_id": 85832204, "body": "I got a &#39;Users&#39; table on my database ( I use devise). A user has some attributes and public_key is on of them (and is just a string). I produce a public key inside a script on new.html.erb and I want to save it on database for each user. What is the proper way to do this?"}, {"owner": {"reputation": 18856, "user_id": 1359650, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/dffc4318ac93e728a26c8e8b51b4eb37?s=128&d=identicon&r=PG", "display_name": "jvillian", "link": "https://stackoverflow.com/users/1359650/jvillian"}, "reply_to_user": {"reputation": 15, "user_id": 9530698, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5f9c7ece3ede197da49891537a59f5d7?s=128&d=identicon&r=PG&f=1", "display_name": "Argiris Kats", "link": "https://stackoverflow.com/users/9530698/argiris-kats"}, "edited": false, "score": 0, "creation_date": 1521661709, "post_id": 49414895, "comment_id": 85832357, "body": "There are multiple ways of doing this. You could do it either in the <code>new</code> or <code>create</code> actions of your <code>UsersController</code>. Or, you could do it in your <code>User</code> model using a <code>call_back</code> either during <code>initialize</code> or <code>save</code>. Any of these has pros and cons."}, {"owner": {"reputation": 15, "user_id": 9530698, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5f9c7ece3ede197da49891537a59f5d7?s=128&d=identicon&r=PG&f=1", "display_name": "Argiris Kats", "link": "https://stackoverflow.com/users/9530698/argiris-kats"}, "edited": false, "score": 0, "creation_date": 1521662064, "post_id": 49414895, "comment_id": 85832538, "body": "First of all thanks for your answers.So inside the new function of the controller I should change the attribute? How would I pass the variable which is on the script to the function of the controller?"}, {"owner": {"reputation": 18856, "user_id": 1359650, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/dffc4318ac93e728a26c8e8b51b4eb37?s=128&d=identicon&r=PG", "display_name": "jvillian", "link": "https://stackoverflow.com/users/1359650/jvillian"}, "reply_to_user": {"reputation": 15, "user_id": 9530698, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5f9c7ece3ede197da49891537a59f5d7?s=128&d=identicon&r=PG&f=1", "display_name": "Argiris Kats", "link": "https://stackoverflow.com/users/9530698/argiris-kats"}, "edited": false, "score": 0, "creation_date": 1521662210, "post_id": 49414895, "comment_id": 85832619, "body": "Welp. I don&#39;t know when the first time is that you need to access the <code>public_key</code>. My tendency would be to set the attribute in the <code>create</code> action, but you <i>could</i> do it in the <code>new</code> action. I also don&#39;t know what your script looks like, but the logic for creating the <code>public_key</code> probably belongs in the controller or in a service."}], "tags": [], "owner": {"reputation": 18856, "user_id": 1359650, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/dffc4318ac93e728a26c8e8b51b4eb37?s=128&d=identicon&r=PG", "display_name": "jvillian", "link": "https://stackoverflow.com/users/1359650/jvillian"}, "is_accepted": true, "score": 0, "last_activity_date": 1521659904, "creation_date": 1521659904, "answer_id": 49414895, "question_id": 49414722, "link": "https://stackoverflow.com/questions/49414722/rails-how-to-give-an-argument-to-model-function/49414895#49414895", "title": "RAILS How to give an argument to Model function", "body": "<p>To pass an argument, you would do</p>\n\n<pre><code>def change_key(params)\n  self.public_key = params[:public_key]\nend\n</code></pre>\n\n<p>Which you could call as:</p>\n\n<pre><code>@model.change_key(x)\n</code></pre>\n\n<p>And, as long as <code>@model</code> has an attribute <code>public_key</code>, and <code>x</code> is something <code>hash</code>-like, then it should work.</p>\n\n<p>Unless, of course, you expect <code>@model.public_key</code> to be persisted. In which case, it would be something more like: </p>\n\n<pre><code>def change_key(params)\n  self.public_key = params[:public_key]\n  self.save\nend\n</code></pre>\n\n<p>Which is silly because you could do that in one shot, like: </p>\n\n<pre><code>def change_key(params)\n  self.update(public_key: params[:public_key])\nend\n</code></pre>\n\n<p>But, why declare a <code>change_key</code> method at all when you can simply do:</p>\n\n<pre><code>@model.update(public_key: params[:public_key])\n</code></pre>\n\n<p>Which, of course, you <em>definitely</em> do not want to do in a <code>view</code> because (IMO) your <code>view</code>s should <em>never</em> be making changes to your models in your views. Doing so requires that your <code>view</code> layer requires intimate knowledge of your <code>model</code> layer - which makes your application brittle.</p>\n"}], "owner": {"reputation": 15, "user_id": 9530698, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5f9c7ece3ede197da49891537a59f5d7?s=128&d=identicon&r=PG&f=1", "display_name": "Argiris Kats", "link": "https://stackoverflow.com/users/9530698/argiris-kats"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 46, "favorite_count": 0, "accepted_answer_id": 49414895, "answer_count": 2, "score": -1, "last_activity_date": 1521659904, "creation_date": 1521659249, "last_edit_date": 1521659271, "question_id": 49414722, "link": "https://stackoverflow.com/questions/49414722/rails-how-to-give-an-argument-to-model-function", "title": "RAILS How to give an argument to Model function", "body": "<p>I have this function in my user.rb Model :</p>\n\n<pre><code>def change_key\n  self.public_key = params[:public_key]\nend\n</code></pre>\n\n<p>I want to call this function from a script on Views (new.html.erb) like this :</p>\n\n<pre><code>change_key(x);\n</code></pre>\n\n<p>and I want self.public_key to get the x value</p>\n\n<p>The result I get is :</p>\n\n<blockquote>\n  <p>undefined local variable or method `params' for</p>\n  \n  <h1></h1>\n</blockquote>\n\n<p>Any thoughts??</p>\n"}, {"tags": ["ios", "ruby", "nsrunloop", "calabash-ios"], "answers": [{"tags": [], "owner": {"reputation": 910, "user_id": 1883278, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/4297e42fb78f909af5da151f61aefa5a?s=128&d=identicon&r=PG", "display_name": "Sankalp", "link": "https://stackoverflow.com/users/1883278/sankalp"}, "is_accepted": false, "score": 0, "last_activity_date": 1521753692, "creation_date": 1521753692, "answer_id": 49438691, "question_id": 49414691, "link": "https://stackoverflow.com/questions/49414691/not-able-to-install-deviceagent-no-valid-iosdeveloperidentities-found-on-system/49438691#49438691", "title": "Not able to install DeviceAgent- No valid iOSDeveloperIdentities found on system", "body": "<p>I was using a distribution certificate. Someone pointed out that's not the right one. I generated a new developer certificate, regenerated the provisioning profile for that certificate and it worked!</p>\n"}], "owner": {"reputation": 910, "user_id": 1883278, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/4297e42fb78f909af5da151f61aefa5a?s=128&d=identicon&r=PG", "display_name": "Sankalp", "link": "https://stackoverflow.com/users/1883278/sankalp"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 429, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1521753692, "creation_date": 1521659125, "question_id": 49414691, "link": "https://stackoverflow.com/questions/49414691/not-able-to-install-deviceagent-no-valid-iosdeveloperidentities-found-on-system", "title": "Not able to install DeviceAgent- No valid iOSDeveloperIdentities found on system", "body": "<p><strong>xcrun xcodebuild -version</strong>: 9.2</p>\n\n<p><strong>run_loop</strong>: 2.6.4</p>\n\n<p><strong>calabash-ios version</strong>: 0.20.5</p>\n\n<p><strong>iOS version</strong>: 11.2.6</p>\n\n<p><strong>Command</strong>- <code>/Users/testmaskin/.rbenv/versions/2.3.1/lib/ruby/gems/2.3.0/gems/run_loop-2.6.4/lib/run_loop/device_agent/bin/iOSDeviceManager install /Users/testmaskin/.rbenv/versions/2.3.1/lib/ruby/gems/2.3.0/gems/run_loop-2.6.4/lib/run_loop/device_agent/ipa/DeviceAgent-Runner.app --device-id 61b08575d55927c0dd0b9192e37a2c1f421cd000</code></p>\n\n<p><strong>Output:</strong></p>\n\n<pre><code>Terminating app due to uncaught exception 'CBXException', \nreason: 'Unable to find appropriate codesign identity for device 61b08575d55927c0dd0b9192e37a2c1f421cd000 / app com.apple.test.DeviceAgent-Runner combo'\n</code></pre>\n\n<p><strong>Output of</strong> <code>tail -F ~/.calabash/iOSDeviceManager/logs/current.log</code></p>\n\n<pre><code>2018-03-20 16:46:04.676 INFO ShellRunner:70 | EXEC: /usr/bin/xcrun codesign -d --entitlements :- /Users/testmaskin/.rbenv/versions/2.3.1/lib/ruby/gems/2.3.0/gems/run_loop-2.6.4/lib/run_loop/device_agent/ipa/DeviceAgent-Runner.app\n2018-03-20 16:46:05.171 INFO ShellRunner:70 | EXEC: /usr/bin/xcrun codesign -d --entitlements :- /Users/testmaskin/.rbenv/versions/2.3.1/lib/ruby/gems/2.3.0/gems/run_loop-2.6.4/lib/run_loop/device_agent/ipa/DeviceAgent-Runner.app\n2018-03-20 16:46:05.258 INFO ShellRunner:70 | EXEC: /usr/bin/xcrun security find-identity -v -p codesigning\n2018-03-20 16:46:05.466 ERROR ConsoleWriter:32 | No valid iOSDeveloperIdentities found on system.\n</code></pre>\n\n<p>However, the profile exists in the <code>/Users/testmaskin/Library/MobileDevice/Provisioning Profiles</code> directory as well as the device UDID exists in that profile. See the output below.</p>\n\n<pre><code>$ /usr/bin/xcrun security find-identity -v -p codesigning\n1) 95CC7E649668236B68C7D309A07AAC5E3C9B409B \"iPhone Distribution: Polly Lal (***********)\"\n     1 valid identities found\n</code></pre>\n\n<p>Not sure what I'm missing here. I have a bunch of such test devices attached to their own Mac Mini hosts. Each of those setup are exhibiting this problem. So I'm sure its not because of a faulty device. Any help is appreciated.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "associations"], "answers": [{"tags": [], "owner": {"reputation": 1336, "user_id": 1060541, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/03f0b2f989d2e3824394dd148f7aeb74?s=128&d=identicon&r=PG", "display_name": "Jorge Najera T", "link": "https://stackoverflow.com/users/1060541/jorge-najera-t"}, "is_accepted": true, "score": 1, "last_activity_date": 1521666749, "creation_date": 1521666749, "answer_id": 49416595, "question_id": 49414192, "link": "https://stackoverflow.com/questions/49414192/rails-owner-polymorphic-route-issue-cannot-find-source-associations/49416595#49416595", "title": "rails owner polymorphic route issue (cannot find source associations)", "body": "<p>To make an polymorphic association you need two fields on your database to get it working. So following your example priority_players table should have owner_id (integer) and owner_type(string) defined to get it working. owner_id will store the id of the record Ex. 10 and owner_type the class model of the record id Ex. \"Customer\". Hope it helps.</p>\n"}], "owner": {"reputation": 1440, "user_id": 4282529, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/dW8oZ.jpg?s=128&g=1", "display_name": "kdweber89", "link": "https://stackoverflow.com/users/4282529/kdweber89"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 25, "favorite_count": 0, "accepted_answer_id": 49416595, "answer_count": 1, "score": 0, "last_activity_date": 1521666749, "creation_date": 1521657380, "question_id": 49414192, "link": "https://stackoverflow.com/questions/49414192/rails-owner-polymorphic-route-issue-cannot-find-source-associations", "title": "rails owner polymorphic route issue (cannot find source associations)", "body": "<p>I'm trying to take an existing module, and add a polymorphic ownership associated through it.  Yet, i'm having trouble getting it all set up, and i'm not sure what i'm missing. </p>\n\n<p>I have a priorityPlayer that is owned by a customer (and eventually a team).</p>\n\n<pre><code>class PriorityPlayer &lt; ActiveRecord::Base\n  has_paper_trail\n\n  belongs_to :owner, polymorphic: true, touch: true\n  validates :owner, presence: true\n  validates :player, presence: true\nend\n</code></pre>\n\n<p>In my customer model I have </p>\n\n<pre><code>has_many :priority_players, as: :owner\n</code></pre>\n\n<p>My schema is set at</p>\n\n<pre><code>create_table \"priority_players\", force: :cascade do |t|\n  t.datetime \"created_at\",  null: false\n  t.integer  \"customer_id\"\n</code></pre>\n\n<p>Would anybody know what i am missing here? With what I have right now I'm getting a error at</p>\n\n<pre><code>Could not find the source association(s) :pharmacy in model PriorityPharmacy.\n</code></pre>\n"}, {"tags": ["ruby", "build", "rubygems", "rake", "travis-ci"], "answers": [{"comments": [{"owner": {"reputation": 79, "user_id": 9526393, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-nLGkiYcBxq0/AAAAAAAAAAI/AAAAAAAAAEQ/lAoLPKsMdLA/photo.jpg?sz=128", "display_name": "Daniel Nunez", "link": "https://stackoverflow.com/users/9526393/daniel-nunez"}, "edited": false, "score": 0, "creation_date": 1521684260, "post_id": 49417118, "comment_id": 85840176, "body": "Sorry for late reply and thanks so much that worked! We&#39;ll keep this weapon in my back pocket. Also new to stack lol on an unrelated note anyway to set email notifications on question activity here ?"}], "tags": [], "owner": {"reputation": 490, "user_id": 8463613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5da8253029fd740a3346ded3124a7729?s=128&d=identicon&r=PG", "display_name": "Jyrki", "link": "https://stackoverflow.com/users/8463613/jyrki"}, "is_accepted": true, "score": 0, "last_activity_date": 1521669148, "creation_date": 1521669148, "answer_id": 49417118, "question_id": 49413618, "link": "https://stackoverflow.com/questions/49413618/travis-ci-build-failure-the-command-bundle-exec-rake-exited-with-1/49417118#49417118", "title": "Travis CI Build Failure: The command &quot;bundle exec rake&quot; exited with 1", "body": "<p>The problem here becomes more clear if you read the error message and the stack trace.  <code>Errno::ENOENT: No such file or directory</code> basically means that Ruby can not find a specific file or directory, in your case it's <code>/home/travis/build/AlphaDaniel/ruby_doc/vendor/bundle/ruby/2.2.0/gems/ruby_doc-2.2.0/favs.txt</code>.  The last line of code that ran is a call to <code>FileUtils.touch</code> (in <a href=\"https://github.com/AlphaDaniel/ruby_doc/blob/84705d13f30186294ba02a3187e89dc65cae9be1/config/environment.rb#L23\" rel=\"nofollow noreferrer\"><code>config/environment.rb:23</code></a>).</p>\n\n<p>You may have asked yourself \"But shouldn't that create this file if it does not yet exist?\".  The answer to that is: yes, <strong>however</strong> only when the parent directories exist as well.  When you <code>gem install</code> your gem, those directories will be created for you.  This is not the case when you clone your repository and run <code>rake</code> (which is also what Travis automatically does for you when it sees a Ruby project).</p>\n\n<p>To solve that, I recommend you to change the <code>fav_dir</code> method's body to something like this:</p>\n\n<pre><code>File.expand_path(\"../favs.txt\", __dir__)\n</code></pre>\n\n<p>Looks a bit magic at first glance, but it isn't really: <a href=\"https://docs.ruby-lang.org/en/2.4.0/Kernel.html#method-i-__dir__\" rel=\"nofollow noreferrer\"><code>__dir__</code></a> is a Ruby method which returns the absolute path of the directory of the file from which this method is called.  In this case this would be e.g. <code>/usr/home/foo/dev/ruby_doc/config</code>.  Finally, <a href=\"https://docs.ruby-lang.org/en/2.4.0/File.html#method-c-expand_path\" rel=\"nofollow noreferrer\"><code>File.expand_path</code></a> allows us to resolve relative paths, in this case the final result will be <code>/usr/home/foo/dev/ruby_doc/favs.txt</code>.<br>\nThis way you don't need to specify any absolute paths or make assumptions about a directory layout, and also ensure that the path exists (as the source file's directory and its parent always exist).</p>\n"}], "owner": {"reputation": 79, "user_id": 9526393, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-nLGkiYcBxq0/AAAAAAAAAAI/AAAAAAAAAEQ/lAoLPKsMdLA/photo.jpg?sz=128", "display_name": "Daniel Nunez", "link": "https://stackoverflow.com/users/9526393/daniel-nunez"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 677, "favorite_count": 0, "accepted_answer_id": 49417118, "answer_count": 1, "score": 0, "last_activity_date": 1521669148, "creation_date": 1521655363, "last_edit_date": 1521657681, "question_id": 49413618, "link": "https://stackoverflow.com/questions/49413618/travis-ci-build-failure-the-command-bundle-exec-rake-exited-with-1", "title": "Travis CI Build Failure: The command &quot;bundle exec rake&quot; exited with 1", "body": "<p>Very new to Travis CI. Build failed with <code>The command \"bundle exec rake\" exited with 1.</code></p>\n\n<p>The build was passing before my latest changes which involved using Fileutils to write to gem directory so I'm assuming this is the culprit.</p>\n\n<p>I found this : <a href=\"https://stackoverflow.com/a/40643667/9526393\">https://stackoverflow.com/a/40643667/9526393</a> but still no luck </p>\n\n<p>Any ideas? </p>\n\n<p>Build: <a href=\"https://travis-ci.org/AlphaDaniel/ruby_doc/builds/356485701?utm_source=github_status&amp;utm_medium=notification\" rel=\"nofollow noreferrer\">https://travis-ci.org/AlphaDaniel/ruby_doc/builds/356485701?utm_source=github_status&amp;utm_medium=notification</a></p>\n\n<p>Repo: <a href=\"https://github.com/AlphaDaniel/ruby_doc\" rel=\"nofollow noreferrer\">https://github.com/AlphaDaniel/ruby_doc</a></p>\n\n<pre><code>    rake aborted!\nErrno::ENOENT: No such file or directory @ rb_sysopen - /home/travis/build/AlphaDaniel/ruby_doc/vendor/bundle/ruby/2.2.0/gems/ruby_doc-2.2.0/favs.txt\n/home/travis/build/AlphaDaniel/ruby_doc/config/environment.rb:23:in `&lt;top (required)&gt;'\n/home/travis/build/AlphaDaniel/ruby_doc/Rakefile:5:in `require_relative'\n/home/travis/build/AlphaDaniel/ruby_doc/Rakefile:5:in `&lt;top (required)&gt;'\n/home/travis/.rvm/rubies/ruby-2.2.3/bin/bundle:30:in `block in &lt;main&gt;'\n/home/travis/.rvm/rubies/ruby-2.2.3/bin/bundle:22:in `&lt;main&gt;'\nErrno::ENOENT: No such file or directory @ utime_internal - /home/travis/build/AlphaDaniel/ruby_doc/vendor/bundle/ruby/2.2.0/gems/ruby_doc-2.2.0/favs.txt\n/home/travis/build/AlphaDaniel/ruby_doc/config/environment.rb:23:in `&lt;top (required)&gt;'\n/home/travis/build/AlphaDaniel/ruby_doc/Rakefile:5:in `require_relative'\n/home/travis/build/AlphaDaniel/ruby_doc/Rakefile:5:in `&lt;top (required)&gt;'\n/home/travis/.rvm/rubies/ruby-2.2.3/bin/bundle:30:in `block in &lt;main&gt;'\n/home/travis/.rvm/rubies/ruby-2.2.3/bin/bundle:22:in `&lt;main&gt;'\n(See full trace by running task with --trace)\n</code></pre>\n"}, {"tags": ["javascript", "jquery", "ruby-on-rails", "ruby", "cookies"], "comments": [{"owner": {"reputation": 18856, "user_id": 1359650, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/dffc4318ac93e728a26c8e8b51b4eb37?s=128&d=identicon&r=PG", "display_name": "jvillian", "link": "https://stackoverflow.com/users/1359650/jvillian"}, "edited": false, "score": 0, "creation_date": 1521655442, "post_id": 49413385, "comment_id": 85828839, "body": "This seems like it might be an <a href=\"http://xyproblem.info/\" rel=\"nofollow noreferrer\">XY Problem</a>. Maybe you&#39;re trying to submit a form that includes your stored value? Or pass the value to the rails server when clicking a link?"}, {"owner": {"reputation": 1347, "user_id": 8052052, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/LeaWG.png?s=128&g=1", "display_name": "Taichi", "link": "https://stackoverflow.com/users/8052052/taichi"}, "reply_to_user": {"reputation": 18856, "user_id": 1359650, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/dffc4318ac93e728a26c8e8b51b4eb37?s=128&d=identicon&r=PG", "display_name": "jvillian", "link": "https://stackoverflow.com/users/1359650/jvillian"}, "edited": false, "score": 0, "creation_date": 1521655818, "post_id": 49413385, "comment_id": 85829039, "body": "What I wanna do is this: When users click an item, if he&#39;s not logged in, pop up modal and let him go to login form(save item_id in JS). After logged in(read item_id in Rails), redirect to the item detail page. Because the pop up modal is implemented by JS, I must share values between JS and Rails."}], "owner": {"reputation": 1347, "user_id": 8052052, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/LeaWG.png?s=128&g=1", "display_name": "Taichi", "link": "https://stackoverflow.com/users/8052052/taichi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 243, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1521656564, "creation_date": 1521654636, "last_edit_date": 1521656564, "question_id": 49413385, "link": "https://stackoverflow.com/questions/49413385/how-to-get-cookies-in-a-different-path-in-rails", "title": "How to get cookies in a different path in Rails", "body": "<p>Using Ruby on Rails 5.0.3 .</p>\n\n<p>Related to <a href=\"https://stackoverflow.com/questions/49410600/how-to-set-cookie-value-in-javascript-and-get-it-in-rails-controller?noredirect=1#comment85824713_49410600\">How to set cookie value in JavaScript and get it in Rails controller</a>.</p>\n\n<p>I'm using cookies to save some value like this.</p>\n\n<pre><code>var itemId = $(e.currentTarget).data('item-id');\ndocument.cookie = 'clicked_item_id=' + itemId.toString();\n</code></pre>\n\n<p>The value is definitely saved in Cookies in <code>chrome://settings/cookies/detail?site=localhost</code> .</p>\n\n<p><a href=\"https://i.stack.imgur.com/K8snD.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/K8snD.jpg\" alt=\"Chrome Cookies settings\"></a>\nBut I cannot access it in Rails like</p>\n\n<pre><code>cookies[:clicked_item_id]\n</code></pre>\n\n<p>or</p>\n\n<pre><code>cookies[\"clicked_item_id\"]\n</code></pre>\n\n<p>This is because <strong>where I save Cookies in JS and where I read Cookies in Rails are in different paths</strong>. But I wanna share Cookies somehow.</p>\n\n<p>How can I do this?</p>\n\n<pre><code>What I wanna do is this:\nWhen users click an item, if he's not logged in,\npop up modal and let him go to login form(save item_id in JS).\nAfter logged in(read item_id in Rails), redirect to the item detail page.\nBecause the pop up modal is implemented by JS, I must share values between JS and Rails.\n</code></pre>\n"}, {"tags": ["ruby", "postgresql"], "comments": [{"owner": {"reputation": 356, "user_id": 7781865, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a015f597dcb8d01d4deae23070c6991f?s=128&d=identicon&r=PG", "display_name": "colincr", "link": "https://stackoverflow.com/users/7781865/colincr"}, "edited": false, "score": 0, "creation_date": 1521652971, "post_id": 49412817, "comment_id": 85827366, "body": "Try <code>rs.as_json</code>"}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 1, "creation_date": 1521653746, "post_id": 49412817, "comment_id": 85827870, "body": "I really hope <code>table</code> is not a user-supplied parameter because you&#39;re putting it in your query without any sort of escaping or validation."}], "answers": [{"comments": [{"owner": {"reputation": 83, "user_id": 9419102, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/3b0a94b437e39bbb234559d4300691ef?s=128&d=identicon&r=PG&f=1", "display_name": "Fatna", "link": "https://stackoverflow.com/users/9419102/fatna"}, "edited": false, "score": 0, "creation_date": 1521654193, "post_id": 49412939, "comment_id": 85828113, "body": "Thanks spickermann, it works, now I will change the method to take two string : def table_content_to_hash(table1,table2) , and do the samething as your code for both tables, I will have two hashes, how to compare the two hashes to see if the two tables have the same content ? thanks."}, {"owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "reply_to_user": {"reputation": 83, "user_id": 9419102, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/3b0a94b437e39bbb234559d4300691ef?s=128&d=identicon&r=PG&f=1", "display_name": "Fatna", "link": "https://stackoverflow.com/users/9419102/fatna"}, "edited": false, "score": 0, "creation_date": 1521656121, "post_id": 49412939, "comment_id": 85829217, "body": "To compare two hashes just use <code>==</code> like this: <code>{ a: 1, b: 2 } == { b: 2, a: 1 } #=&gt; true</code> But wouldn&#39;t it be faster to compare the table in the database with a SQL?"}, {"owner": {"reputation": 83, "user_id": 9419102, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/3b0a94b437e39bbb234559d4300691ef?s=128&d=identicon&r=PG&f=1", "display_name": "Fatna", "link": "https://stackoverflow.com/users/9419102/fatna"}, "edited": false, "score": 0, "creation_date": 1521656682, "post_id": 49412939, "comment_id": 85829534, "body": "the two tables come from two different databases, we want to test data migration from a legacy DB (SQL Server) to Postgress,"}, {"owner": {"reputation": 83, "user_id": 9419102, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/3b0a94b437e39bbb234559d4300691ef?s=128&d=identicon&r=PG&f=1", "display_name": "Fatna", "link": "https://stackoverflow.com/users/9419102/fatna"}, "edited": false, "score": 0, "creation_date": 1521658103, "post_id": 49412939, "comment_id": 85830347, "body": "I did : expect(hash[table1] == (hash2[table2])) but it passed, the hash2 has two diff thing : &quot;address&quot;=&gt;&quot;Texas0  and  &quot;name&quot;=&gt;&quot;David0&quot; , please look at my hash result in my update question."}, {"owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "reply_to_user": {"reputation": 83, "user_id": 9419102, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/3b0a94b437e39bbb234559d4300691ef?s=128&d=identicon&r=PG&f=1", "display_name": "Fatna", "link": "https://stackoverflow.com/users/9419102/fatna"}, "edited": false, "score": 0, "creation_date": 1521661233, "post_id": 49412939, "comment_id": 85832109, "body": "This question is a different issue and has nothing in common with your original question how to build hashes. I suggest that you start a new question for the compare issue."}], "tags": [], "owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "is_accepted": true, "score": 1, "last_activity_date": 1521653238, "creation_date": 1521653238, "answer_id": 49412939, "question_id": 49412817, "link": "https://stackoverflow.com/questions/49412817/postgres-how-to-put-all-the-content-of-a-table-in-a-hash/49412939#49412939", "title": "postgres, how to put all the content of a table in a hash?", "body": "<p>Just initialize your hash with the table name and an empty array right away:</p>\n\n<pre><code>def table_content_to_hash(table)\n  hash = { table =&gt; [] }\n\n  rows = @pg_conn.exec \"SELECT * FROM #{table}\";\n  rows.each do |row|\n    hash[table] &lt;&lt; child\n  end\n\n  puts hash\nend\n</code></pre>\n"}], "owner": {"reputation": 83, "user_id": 9419102, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/3b0a94b437e39bbb234559d4300691ef?s=128&d=identicon&r=PG&f=1", "display_name": "Fatna", "link": "https://stackoverflow.com/users/9419102/fatna"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 266, "favorite_count": 0, "accepted_answer_id": 49412939, "answer_count": 1, "score": 0, "last_activity_date": 1521654378, "creation_date": 1521652860, "last_edit_date": 1521654378, "question_id": 49412817, "link": "https://stackoverflow.com/questions/49412817/postgres-how-to-put-all-the-content-of-a-table-in-a-hash", "title": "postgres, how to put all the content of a table in a hash?", "body": "<p>I would like to put all the results from a select to a hash, that will have the name of the table as the key and the value is an array that will have the rows, here is what I did so far :</p>\n\n<pre><code>def table_content_to_hash(table)\n hash = {}\n rs = @pg_conn.exec \"SELECT * FROM #{table}\";\n rs.each do |child|\n  # want to put table name as key and value is an array that has the rows\n  hash['#{table}'] = child  # THIS ONE IS WRONG\n end\n puts hash\nend\n</code></pre>\n\n<p>Update, my code works after using Spickermann solution, here is the result :</p>\n\n<pre><code>{\"company\"=&gt;[{\"id\"=&gt;\"1\", \"name\"=&gt;\"Paul\", \"age\"=&gt;\"32\", \"address\"=&gt;\"California                                        \", \"salary\"=&gt;\"20000\"}, {\"id\"=&gt;\"2\", \"name\"=&gt;\"Allen\", \"age\"=&gt;\"25\", \"address\"=&gt;\"Texas                                             \", \"salary\"=&gt;\"15000\"}, {\"id\"=&gt;\"3\", \"name\"=&gt;\"Teddy\", \"age\"=&gt;\"23\", \"address\"=&gt;\"Norway\n                                    \", \"salary\"=&gt;\"20000\"}, {\"id\"=&gt;\"4\", \"name\"=&gt;\"Mark\", \"age\"=&gt;\"25\", \"address\"=&gt;\"Rich-Mond\n\", \"salary\"=&gt;\"65000\"}, {\"id\"=&gt;\"5\", \"name\"=&gt;\"David\", \"age\"=&gt;\"27\", \n\"address\"=&gt;\"Texas                                             \", \n \"salary\"=&gt;\"85000\"}, {\"id\"=&gt;\"6\", \"name\"=&gt;\"Kim\", \"age\"=&gt;\"22\", \n \"address\"=&gt;\"South-Hall                                        \", \n \"salary\"=&gt;\"45000\"}, {\"id\"=&gt;\"7\", \"name\"=&gt;\"James\", \"age\"=&gt;\"24\", \n  \"address\"=&gt;\"Houston                                           \", \n\"salary\"=&gt;\"10000\"}]}\n</code></pre>\n\n<p>I don't know ho to remove that space the value of the address.\nThanks,</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 0, "creation_date": 1521651188, "post_id": 49412018, "comment_id": 85826215, "body": "Do you have a presence validator in your model?"}, {"owner": {"reputation": 136, "user_id": 6868843, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/7KRD0.jpg?s=128&g=1", "display_name": "Pynnie", "link": "https://stackoverflow.com/users/6868843/pynnie"}, "reply_to_user": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 0, "creation_date": 1521651237, "post_id": 49412018, "comment_id": 85826246, "body": "no, I try to avoid that way"}, {"owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 0, "creation_date": 1521651412, "post_id": 49412018, "comment_id": 85826379, "body": "I would argue that you cannot ensure that the user selected anything and send anything useful to the server if you do not validate in your model on the server or/and add a foreign constraint to your database that the record actually exists."}], "answers": [{"comments": [{"owner": {"reputation": 470, "user_id": 1249891, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/df65c5095bee4d8e1177fb87c4d81249?s=128&d=identicon&r=PG", "display_name": "Jacob Vanus", "link": "https://stackoverflow.com/users/1249891/jacob-vanus"}, "edited": false, "score": 1, "creation_date": 1521651765, "post_id": 49412366, "comment_id": 85826619, "body": "Also, <code>prompt</code> may be more appropriate for your case than <code>include_blank</code>. Checkout <a href=\"https://stackoverflow.com/questions/11302728/whats-the-difference-between-include-blank-and-prompt-in-the-rails-select-hel#11304099\" title=\"whats the difference between include blank and prompt in the rails select hel%2311304099\">stackoverflow.com/questions/11302728/&hellip;</a>"}, {"owner": {"reputation": 136, "user_id": 6868843, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/7KRD0.jpg?s=128&g=1", "display_name": "Pynnie", "link": "https://stackoverflow.com/users/6868843/pynnie"}, "edited": false, "score": 0, "creation_date": 1521708930, "post_id": 49412366, "comment_id": 85849402, "body": "Thanks, this worked! I will also check out promts, thanks for the advice"}], "tags": [], "owner": {"reputation": 470, "user_id": 1249891, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/df65c5095bee4d8e1177fb87c4d81249?s=128&d=identicon&r=PG", "display_name": "Jacob Vanus", "link": "https://stackoverflow.com/users/1249891/jacob-vanus"}, "is_accepted": true, "score": 2, "last_activity_date": 1521651474, "creation_date": 1521651474, "answer_id": 49412366, "question_id": 49412018, "link": "https://stackoverflow.com/questions/49412018/how-to-make-a-drop-list-selection-mandatory-excluding-the-blank-value/49412366#49412366", "title": "How to make a drop-list selection mandatory excluding the blank value", "body": "<p>Required is an html parameter. Try:</p>\n\n<pre><code>&lt;%= f.collection_select :manufacturer_id, @manufacturers, :id,\n            :name,{include_blank: \"Select manufacturer\"}, {class: \"form-control\",  required: true} %&gt;\n</code></pre>\n"}], "owner": {"reputation": 136, "user_id": 6868843, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/7KRD0.jpg?s=128&g=1", "display_name": "Pynnie", "link": "https://stackoverflow.com/users/6868843/pynnie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 26, "favorite_count": 0, "accepted_answer_id": 49412366, "answer_count": 1, "score": 0, "last_activity_date": 1521651474, "creation_date": 1521650480, "question_id": 49412018, "link": "https://stackoverflow.com/questions/49412018/how-to-make-a-drop-list-selection-mandatory-excluding-the-blank-value", "title": "How to make a drop-list selection mandatory excluding the blank value", "body": "<p>In my code, i have the following drop list</p>\n\n<pre><code>&lt;%= f.collection_select :manufacturer_id, @manufacturers, :id,\n            :name,{include_blank: \"Select manufacturer\",  required: true}, {class: \"form-control\"} %&gt;\n</code></pre>\n\n<p>Somehow the blank is accepted as a selection. Is there a way to prevent this? I want the user to select a value form the drop-list, except for the blank.</p>\n\n<p>Thanks for the help!</p>\n"}, {"tags": ["javascript", "jquery", "ruby-on-rails", "ruby", "session"], "comments": [{"owner": {"reputation": 304305, "user_id": 519413, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/7839089cd91dc5cc5eb1e0cdbf3312ed?s=128&d=identicon&r=PG", "display_name": "Rory McCrossan", "link": "https://stackoverflow.com/users/519413/rory-mccrossan"}, "edited": false, "score": 0, "creation_date": 1521646794, "post_id": 49410600, "comment_id": 85822831, "body": "JS runs on the client and therefore is not able to directly affect the session, which is stored on the server. You could send an AJAX request from JS to the server which gets/sets the session values you require, though."}, {"owner": {"reputation": 100127, "user_id": 67392, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/95e28ac250c4604a6f9d7e34705c3259?s=128&d=identicon&r=PG", "display_name": "Richard", "link": "https://stackoverflow.com/users/67392/richard"}, "edited": false, "score": 0, "creation_date": 1521646820, "post_id": 49410600, "comment_id": 85822857, "body": "You&#39;ll need to make a server request from the client: take a look at <a href=\"https://developer.mozilla.org/en-US/docs/Web/API/XMLHttpRequest\" rel=\"nofollow noreferrer\"><code>XmlHttpRequest</code></a>."}, {"owner": {"reputation": 1347, "user_id": 8052052, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/LeaWG.png?s=128&g=1", "display_name": "Taichi", "link": "https://stackoverflow.com/users/8052052/taichi"}, "edited": false, "score": 0, "creation_date": 1521647159, "post_id": 49410600, "comment_id": 85823133, "body": "Okay, then I can use cookie? Anyway I want to save some value in JS, and get it later in Rails..."}, {"owner": {"reputation": 1347, "user_id": 8052052, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/LeaWG.png?s=128&g=1", "display_name": "Taichi", "link": "https://stackoverflow.com/users/8052052/taichi"}, "edited": false, "score": 0, "creation_date": 1521647284, "post_id": 49410600, "comment_id": 85823259, "body": "I want do it without sending request if I can."}, {"owner": {"reputation": 1223, "user_id": 3422357, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/F984j.jpg?s=128&g=1", "display_name": "Vishal Taj PM", "link": "https://stackoverflow.com/users/3422357/vishal-taj-pm"}, "edited": false, "score": 0, "creation_date": 1521649122, "post_id": 49410600, "comment_id": 85824713, "body": "why you don&#39;t you use browser cookies that you can access or set both from rails and from client side <code>cookies[:key]</code> in <b>Rails</b> and <code>document.cookie</code> to get the cookie list in <b>Client Side</b>."}], "answers": [{"comments": [{"owner": {"reputation": 1347, "user_id": 8052052, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/LeaWG.png?s=128&g=1", "display_name": "Taichi", "link": "https://stackoverflow.com/users/8052052/taichi"}, "edited": false, "score": 0, "creation_date": 1521647407, "post_id": 49410818, "comment_id": 85823366, "body": "Thanks! so Rails cookies does not get encrypted?"}, {"owner": {"reputation": 313, "user_id": 3702804, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/808845f311afec7b91b8dd8cb0eed4f3?s=128&d=identicon&r=PG", "display_name": "Alex Tatarnikov", "link": "https://stackoverflow.com/users/3702804/alex-tatarnikov"}, "reply_to_user": {"reputation": 1347, "user_id": 8052052, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/LeaWG.png?s=128&g=1", "display_name": "Taichi", "link": "https://stackoverflow.com/users/8052052/taichi"}, "edited": false, "score": 1, "creation_date": 1521647700, "post_id": 49410818, "comment_id": 85823600, "body": "Yes, cookies are not encrypted and open for read and modification from the client side. The session is also cookies, in most cases, lets forget about the AR session storage, but all the data that are stored in Rails session are encrypted so without <code>secret_key_base</code> you can&#39;t modify or read this data from the client."}, {"owner": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "edited": false, "score": 0, "creation_date": 1521648301, "post_id": 49410818, "comment_id": 85824088, "body": "Can&#39;t you just set the cookie and send the value via ajax at the same time you click the button?"}], "tags": [], "owner": {"reputation": 313, "user_id": 3702804, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/808845f311afec7b91b8dd8cb0eed4f3?s=128&d=identicon&r=PG", "display_name": "Alex Tatarnikov", "link": "https://stackoverflow.com/users/3702804/alex-tatarnikov"}, "is_accepted": false, "score": 3, "last_activity_date": 1521647285, "creation_date": 1521647285, "answer_id": 49410818, "question_id": 49410600, "link": "https://stackoverflow.com/questions/49410600/how-to-set-cookie-value-in-javascript-and-get-it-in-rails-controller/49410818#49410818", "title": "How to set cookie value in JavaScript and get it in Rails controller", "body": "<p>Unfortunately, you can't modify Rails session from the client side, even if it stored in cookies. Because the rails session is encrypted. As a solution, you can use regular cookies, not the Rails session. </p>\n\n<p>Check <a href=\"http://api.rubyonrails.org/v5.1/classes/ActionDispatch/Cookies.html\" rel=\"nofollow noreferrer\">http://api.rubyonrails.org/v5.1/classes/ActionDispatch/Cookies.html</a> <a href=\"https://www.w3schools.com/js/js_cookies.asp\" rel=\"nofollow noreferrer\">https://www.w3schools.com/js/js_cookies.asp</a>\nfor more information. </p>\n"}, {"tags": [], "owner": {"reputation": 99, "user_id": 5092458, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/361e6a284e192d3f81e84fc95bc2ef0f?s=128&d=identicon&r=PG", "display_name": "Sam Sabey", "link": "https://stackoverflow.com/users/5092458/sam-sabey"}, "is_accepted": false, "score": 0, "last_activity_date": 1522140779, "creation_date": 1522140779, "answer_id": 49508394, "question_id": 49410600, "link": "https://stackoverflow.com/questions/49410600/how-to-set-cookie-value-in-javascript-and-get-it-in-rails-controller/49508394#49508394", "title": "How to set cookie value in JavaScript and get it in Rails controller", "body": "<p>The cookie for the rails app is just some hashed string to ID the server cookie, which has the data.</p>\n\n<p>What they said, use Ajax to some controller method you write to update your necessary info into the rails cookie.  </p>\n"}], "owner": {"reputation": 1347, "user_id": 8052052, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/LeaWG.png?s=128&g=1", "display_name": "Taichi", "link": "https://stackoverflow.com/users/8052052/taichi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2164, "favorite_count": 0, "answer_count": 2, "score": 3, "last_activity_date": 1522140779, "creation_date": 1521646709, "last_edit_date": 1521651092, "question_id": 49410600, "link": "https://stackoverflow.com/questions/49410600/how-to-set-cookie-value-in-javascript-and-get-it-in-rails-controller", "title": "How to set cookie value in JavaScript and get it in Rails controller", "body": "<p>Using Ruby on Rails 5.0.3 .</p>\n\n<p>I want to set some value in cookie using JavaScript (when button clicked), and get it in Rails.</p>\n\n<p>I know how to access session in Rails, which is <code>session[:some_key]</code> or <code>cookies</code>.</p>\n\n<p>But I don't know how to do in JavaScript. (it must be able to accessed from Rails <code>session</code> or <code>cookies</code>.)</p>\n\n<p>How can I do it in JS?</p>\n\n<p>Or any other ways to <strong>save some value in JS, and get it later in Rails</strong> ?</p>\n"}, {"tags": ["javascript", "ruby-on-rails", "ruby", "ajax"], "comments": [{"owner": {"reputation": 313, "user_id": 3702804, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/808845f311afec7b91b8dd8cb0eed4f3?s=128&d=identicon&r=PG", "display_name": "Alex Tatarnikov", "link": "https://stackoverflow.com/users/3702804/alex-tatarnikov"}, "edited": false, "score": 1, "creation_date": 1521646711, "post_id": 49410472, "comment_id": 85822756, "body": "The <code>dataType</code> for the ajax request should be <code>script</code> I guess"}, {"owner": {"reputation": 55, "user_id": 8172461, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/20867da9160bcd0a4989c60f0c5c4746?s=128&d=identicon&r=PG&f=1", "display_name": "belshnickleson97", "link": "https://stackoverflow.com/users/8172461/belshnickleson97"}, "reply_to_user": {"reputation": 313, "user_id": 3702804, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/808845f311afec7b91b8dd8cb0eed4f3?s=128&d=identicon&r=PG", "display_name": "Alex Tatarnikov", "link": "https://stackoverflow.com/users/3702804/alex-tatarnikov"}, "edited": false, "score": 0, "creation_date": 1521647038, "post_id": 49410472, "comment_id": 85823030, "body": "That worked, thank the good lord! @AlexTatarnikov"}], "answers": [{"tags": [], "owner": {"reputation": 129, "user_id": 4944651, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-QdVLr51yOJo/AAAAAAAAAAI/AAAAAAAABNE/Xg2CIoB-czE/photo.jpg?sz=128", "display_name": "Sebastian Meza", "link": "https://stackoverflow.com/users/4944651/sebastian-meza"}, "is_accepted": false, "score": 0, "last_activity_date": 1521649640, "last_edit_date": 1521649640, "creation_date": 1521647441, "answer_id": 49410880, "question_id": 49410472, "link": "https://stackoverflow.com/questions/49410472/render-success-js-erb-personal-alert-not-displaying-ruby-on-rails/49410880#49410880", "title": "Render success.js.erb personal_alert not displaying (Ruby on Rails)", "body": "<p>If you have a <code>remote: true</code> element, the ajax call in your js is unnecessary, besides your remote element should be a link_to with the respective url instead of button_tag</p>\n\n<p>Resulting in the following code in your view:</p>\n\n<pre><code>&lt;%= link_to 'new zipcode', new_zipcode_path, remote: true %&gt;\n</code></pre>\n"}], "owner": {"reputation": 55, "user_id": 8172461, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/20867da9160bcd0a4989c60f0c5c4746?s=128&d=identicon&r=PG&f=1", "display_name": "belshnickleson97", "link": "https://stackoverflow.com/users/8172461/belshnickleson97"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 45, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1543929943, "creation_date": 1521646367, "last_edit_date": 1543929943, "question_id": 49410472, "link": "https://stackoverflow.com/questions/49410472/render-success-js-erb-personal-alert-not-displaying-ruby-on-rails", "title": "Render success.js.erb personal_alert not displaying (Ruby on Rails)", "body": "<p>I have a button that is used to verify a user's zip code. When clicked, the desired functionality would be an alert display saying whether the zip code was verified or not. </p>\n\n<pre><code>&lt;%= button_tag 'Verify zip code', :type =&gt; 'button', :id =&gt; 'self-install', remote: true %&gt;\n</code></pre>\n\n<p>The alert file is in my Views and is in <code>zipcodes/success.js.erb</code> and <code>zipcodes/failure/js.erb</code></p>\n\n<p>This is my controller: </p>\n\n<pre><code>    if data.empty?\n  respond_to do |format|\n    format.html do\n      redirect_to page_path(submitted_page)\n    end\n    format.js do\n      render 'zipcodes/failure'\n    end\n  end\nelse\n  respond_to do |format|\n    format.html do\n      redirect_to page_path(submitted_page)\n    end\n    format.js do\n      render 'zipcodes/success'\n    end\n  end\nend\n</code></pre>\n\n<p>Here is my ajax request: </p>\n\n<pre><code>$(function(){\n$('#self-install').click(function(e){\n  e.preventDefault();\n$.ajax({\n  url: '/zipcodes/new',\n  type: 'get',\n  dataType: 'json',\n  data: { zip: zipCodes },\n  success: function(r){\n  }\n});\n  });\n});\n</code></pre>\n\n<p>When I click the button, my terminal says this: </p>\n\n<p><a href=\"https://i.stack.imgur.com/pxWUr.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/pxWUr.png\" alt=\"enter image description here\"></a></p>\n\n<p><strong>But nothing is displaying.</strong> I am using Ruby on Rails. Any help would be greatly appreciated. Please let me know if there is anything I left out that would be helpful. </p>\n"}, {"tags": ["ruby-on-rails", "ruby", "rspec"], "comments": [{"owner": {"reputation": 4797, "user_id": 177154, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f719bc9e36272f09feca03728b4a160c?s=128&d=identicon&r=PG", "display_name": "draganstankovic", "link": "https://stackoverflow.com/users/177154/draganstankovic"}, "edited": false, "score": 0, "creation_date": 1521649123, "post_id": 49410435, "comment_id": 85824712, "body": "When you say &quot;when posting the request without this nesting&quot; can you share the full code along with how you determine that the challenge_request is empty?"}, {"owner": {"reputation": 3, "user_id": 8452824, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ae5211bc0c1ed6da8c59d23890ad1d8?s=128&d=identicon&r=PG&f=1", "display_name": "Brendan Jones", "link": "https://stackoverflow.com/users/8452824/brendan-jones"}, "reply_to_user": {"reputation": 4797, "user_id": 177154, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f719bc9e36272f09feca03728b4a160c?s=128&d=identicon&r=PG", "display_name": "draganstankovic", "link": "https://stackoverflow.com/users/177154/draganstankovic"}, "edited": false, "score": 0, "creation_date": 1521656464, "post_id": 49410435, "comment_id": 85829419, "body": "@draganstankovic When running without the nesting, <code>:params =&gt; {                 :challenge_request =&gt; valid_challenge_request,                 :recipient_id =&gt; 10000 </code>  I get the following error: ` &lt;ActionController::ParameterMissing: param is missing or the value is empty: challenge_request&gt; with backtrace: `  To confirm the empty challenge_request, I printed out the params in the ChallengeRequestController: ` &lt;ActionController::Parameters {&quot;challenge_request&quot;=&gt;&quot;&quot;, &quot;recipient_id&quot;=&gt;&quot;10000&quot;, &quot;controller&quot;=&gt;&quot;challenge_requests&quot;, &quot;action&quot;=&gt;&quot;create&quot;} permitted: false&gt; `"}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 8452824, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ae5211bc0c1ed6da8c59d23890ad1d8?s=128&d=identicon&r=PG&f=1", "display_name": "Brendan Jones", "link": "https://stackoverflow.com/users/8452824/brendan-jones"}, "edited": false, "score": 0, "creation_date": 1521665762, "post_id": 49414393, "comment_id": 85834480, "body": "Thank you very much! Great explanation and works as expected :)"}], "tags": [], "owner": {"reputation": 9971, "user_id": 8255744, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de22299534b5a8ed244ee8ff4aa6c481?s=128&d=identicon&r=PG&f=1", "display_name": "Simple Lime", "link": "https://stackoverflow.com/users/8255744/simple-lime"}, "is_accepted": true, "score": 1, "last_activity_date": 1521658119, "creation_date": 1521658119, "answer_id": 49414393, "question_id": 49410435, "link": "https://stackoverflow.com/questions/49410435/why-does-my-controller-require-the-params-hash-to-be-repetitively-nested/49414393#49414393", "title": "Why does my controller require the params hash to be repetitively nested?", "body": "<p>It would probably work if you change your <code>valid_challenge_request</code> to be a hash of attributes instead of the model itself.</p>\n\n<pre><code>let(:valid_challenge_request) { FactoryBot.attributes_for(:challenge_request) }\n</code></pre>\n\n<p>You're trying to send along an instance of a model as a parameter to a controller, and something is doing something (I can't find what's doing what to the model) to try and coerce it into something that a browser might send the controller. That conversion is turning the model into an empty string, which is not <strong><code>present</code> or the value <code>false</code></strong> and thus causes the <code>require</code> to throw the <code>ParameterMissing</code></p>\n"}], "owner": {"reputation": 3, "user_id": 8452824, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ae5211bc0c1ed6da8c59d23890ad1d8?s=128&d=identicon&r=PG&f=1", "display_name": "Brendan Jones", "link": "https://stackoverflow.com/users/8452824/brendan-jones"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 53, "favorite_count": 0, "accepted_answer_id": 49414393, "answer_count": 1, "score": 0, "last_activity_date": 1521658119, "creation_date": 1521646277, "question_id": 49410435, "link": "https://stackoverflow.com/questions/49410435/why-does-my-controller-require-the-params-hash-to-be-repetitively-nested", "title": "Why does my controller require the params hash to be repetitively nested?", "body": "<p>I currently have the following situation:</p>\n\n<p>ChallengeRequestsController #new - creates a ChallengeRequest along with another model needing a <em>recpient_id</em>. </p>\n\n<pre><code>def create\n  @challenge_request = ChallengeRequest.new(challenge_params)\n\n  recipient = User.find(params.require(:recipient_id))\n\n  # Rest of method redacted.\nend\n\ndef challenge_params\n  params.require(:challenge_request).permit(:action)\nend\n</code></pre>\n\n<p>With this controller, I have an RSpec test as follows:</p>\n\n<pre><code>RSpec.describe ChallengeRequestsController, type: :controller do\n  describe \"POST #create\" do\n\n    context \"with valid challenge request\" do\n      let(:valid_challenge_request) { build(:challenge_request) }\n\n      context \"with non-exisistent recpient id\" do\n        it \"throws an error\" do\n          expect{\n            post :create, :params =&gt; {\n              :challenge_request =&gt; {\n                :challenge_request =&gt; valid_challenge_request\n              },\n              :recipient_id =&gt; 10000\n            }\n          }.to raise_error ActiveRecord::RecordNotFound\n        end\n      end\n\n    end\n  end\nend\n</code></pre>\n\n<p>Just for reference, here's the Factory:</p>\n\n<pre><code>FactoryGirl.define do\n  factory :challenge_request do\n    action { Faker::LeagueOfLegends.champion }\n  end\nend\n</code></pre>\n\n<p>All of this code works and the test passes, my question is how can I refactor this in a way that I don't need to use the ugly nesting in the request?</p>\n\n<pre><code>:challenge_request =&gt; {\n  :challenge_request =&gt; valid_challenge_request\n}\n</code></pre>\n\n<p>When posting the request without this nesting:</p>\n\n<pre><code>post :create, :params =&gt; {\n  :challenge_request =&gt; valid_challenge_request,\n  :recipient_id =&gt; 10000\n}\n</code></pre>\n\n<p>The challenge_request is empty when the ChallengeRequestController receives the request.</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 14010, "user_id": 3109182, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/a4b305f0077055b4fdcf715067775d5a?s=128&d=identicon&r=PG", "display_name": "Anthony", "link": "https://stackoverflow.com/users/3109182/anthony"}, "edited": false, "score": 1, "creation_date": 1521645554, "post_id": 49410061, "comment_id": 85821827, "body": "how you call the method (with arguments) doesn&#39;t line up with the class you provided.  I assume <code>#call</code> is returning early and not the last value?  We probably need the whole method to help you debug"}, {"owner": {"reputation": 27144, "user_id": 3857758, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/58c4295826435f049b7fc32b98c240f9?s=128&d=identicon&r=PG&f=1", "display_name": "Ursus", "link": "https://stackoverflow.com/users/3857758/ursus"}, "edited": false, "score": 0, "creation_date": 1521646025, "post_id": 49410061, "comment_id": 85822232, "body": "I think this is just called in action&#39;s controller and so it uses this default current_user and params (from the action). What it&#39;s strange to me, that&#39;s not a class method. Unless there is something we can&#39;t see."}, {"owner": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "edited": false, "score": 1, "creation_date": 1521646039, "post_id": 49410061, "comment_id": 85822245, "body": "The class you have provided declares <code>call</code> as an instance method. This should give <code>NoMethodError: undefined method &#39;call&#39; for MyClass:Class</code>."}, {"owner": {"reputation": 1026, "user_id": 1259193, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/5c27a5bd4a603edd14add85de040c6c0?s=128&d=identicon&r=PG", "display_name": "Angelica Rosa", "link": "https://stackoverflow.com/users/1259193/angelica-rosa"}, "edited": false, "score": 1, "creation_date": 1521646075, "post_id": 49410061, "comment_id": 85822267, "body": "It doesn&#39;t raise any error. This is code that i&#39;ve found on the project, and it works. This is the full code: <a href=\"https://gist.github.com/angelicarosa-spindox/b3d8ac508aa9f5c25b5db06be76ae639#file-upload_content_to_thron-rb-L37\" rel=\"nofollow noreferrer\">gist.github.com/angelicarosa-spindox/&hellip;</a>"}, {"owner": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "edited": false, "score": 0, "creation_date": 1521646434, "post_id": 49410061, "comment_id": 85822554, "body": "Then the Interactor module must be declaring a <code>call</code> class method. Because <code>def foo</code> in a Ruby class declares an instance method and <code>def self.foo</code> would declare a class method. Thats some pretty basic irrefutable facts."}, {"owner": {"reputation": 333, "user_id": 8410844, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a22f7cefc10d1200ae2fb0e48fe448d6?s=128&d=identicon&r=PG&f=1", "display_name": "MOPO3OB", "link": "https://stackoverflow.com/users/8410844/mopo3ob"}, "edited": false, "score": 0, "creation_date": 1521646474, "post_id": 49410061, "comment_id": 85822578, "body": "Why doesn&#39;t it raise an error? Could anyone tell me please. I thought it wouldn&#39;t work without an object, i.e. unless it&#39;s <code>MyClass.new.call</code>."}, {"owner": {"reputation": 14010, "user_id": 3109182, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/a4b305f0077055b4fdcf715067775d5a?s=128&d=identicon&r=PG", "display_name": "Anthony", "link": "https://stackoverflow.com/users/3109182/anthony"}, "edited": false, "score": 0, "creation_date": 1521646542, "post_id": 49410061, "comment_id": 85822619, "body": "there is another module there that must be defining <code>self.call</code>"}, {"owner": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "edited": false, "score": 2, "creation_date": 1521646672, "post_id": 49410061, "comment_id": 85822730, "body": "You can use <code>MyClass.method(:call).source_location</code> to track it down."}, {"owner": {"reputation": 1026, "user_id": 1259193, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/5c27a5bd4a603edd14add85de040c6c0?s=128&d=identicon&r=PG", "display_name": "Angelica Rosa", "link": "https://stackoverflow.com/users/1259193/angelica-rosa"}, "reply_to_user": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "edited": false, "score": 0, "creation_date": 1521646868, "post_id": 49410061, "comment_id": 85822896, "body": "Thank you @max, It&#39;s inside a gem: ~/.rvm/gems/ruby-2.4.1/gems/interactor-3.1.0/lib/interactor.&zwnj;&#8203;rb"}, {"owner": {"reputation": 333, "user_id": 8410844, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a22f7cefc10d1200ae2fb0e48fe448d6?s=128&d=identicon&r=PG&f=1", "display_name": "MOPO3OB", "link": "https://stackoverflow.com/users/8410844/mopo3ob"}, "reply_to_user": {"reputation": 14010, "user_id": 3109182, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/a4b305f0077055b4fdcf715067775d5a?s=128&d=identicon&r=PG", "display_name": "Anthony", "link": "https://stackoverflow.com/users/3109182/anthony"}, "edited": false, "score": 0, "creation_date": 1521647478, "post_id": 49410061, "comment_id": 85823432, "body": "@Anthony I see, thank you. @AngelicaRosa, I think line <i>32</i> returns <code>Interactor::Context</code> before <code>content_id</code> could be returned. As far as I understand that means that either line <i>7</i> or <i>20</i> is returning <code>Interactor::Context</code>."}, {"owner": {"reputation": 1026, "user_id": 1259193, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/5c27a5bd4a603edd14add85de040c6c0?s=128&d=identicon&r=PG", "display_name": "Angelica Rosa", "link": "https://stackoverflow.com/users/1259193/angelica-rosa"}, "edited": false, "score": 0, "creation_date": 1521647989, "post_id": 49410061, "comment_id": 85823846, "body": "My case is the other one, line #35 (category is not an array)"}, {"owner": {"reputation": 1026, "user_id": 1259193, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/5c27a5bd4a603edd14add85de040c6c0?s=128&d=identicon&r=PG", "display_name": "Angelica Rosa", "link": "https://stackoverflow.com/users/1259193/angelica-rosa"}, "edited": false, "score": 0, "creation_date": 1521648042, "post_id": 49410061, "comment_id": 85823875, "body": "I&#39;ve also tried to add a context.content_id = &#39;foo&#39; at the beginning of the &quot;call&quot; method, but when i debug the result context, content_id is not there."}, {"owner": {"reputation": 1026, "user_id": 1259193, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/5c27a5bd4a603edd14add85de040c6c0?s=128&d=identicon&r=PG", "display_name": "Angelica Rosa", "link": "https://stackoverflow.com/users/1259193/angelica-rosa"}, "edited": false, "score": 0, "creation_date": 1521648359, "post_id": 49410061, "comment_id": 85824128, "body": "And then... i restarted the app, and it worked. Thank you all!"}], "answers": [{"tags": [], "owner": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "is_accepted": false, "score": 3, "last_activity_date": 1521648319, "last_edit_date": 1521648319, "creation_date": 1521647508, "answer_id": 49410917, "question_id": 49410061, "link": "https://stackoverflow.com/questions/49410061/class-method-call-and-return-value-how-to-get-it/49410917#49410917", "title": "Class method &quot;call&quot; and return value: how to get it", "body": "<blockquote>\n  <p>The call class method is the proper way to invoke an interactor. The\n  hash argument is converted to the interactor instance's context. The\n  call instance method is invoked along with any hooks that the\n  interactor might define. Finally, the context (along with any changes\n  made to it) is returned.<br>\n  <a href=\"https://github.com/collectiveidea/interactor\" rel=\"nofollow noreferrer\">https://github.com/collectiveidea/interactor</a></p>\n</blockquote>\n\n<p>So the proper way to assign a \"return value\" would be:</p>\n\n<pre><code>class MyClass\n  include Interactor\n\n  def call\n    category_id = context.params['category_id']\n    tmp_context = context.clone\n\n    # ...\n\n    context.content_id = content_id\n  end\nend\n\nMyClass.call.content_id # =&gt; some value\n</code></pre>\n\n<p>So to break this down the Interactor module (provided by the interactor gem). Declares a class method named <code>call</code> which creates an instance of MyClass with the \"context\" as an argument. It then calls the <code>call</code> instance method on the instance and returns the context.</p>\n\n<p>You can get a better idea of how this works by looking at the <a href=\"https://github.com/collectiveidea/interactor/blob/7fb2c041b516bf71bdb03715dbabe44c2f83cd47/lib/interactor.rb\" rel=\"nofollow noreferrer\">source code</a>.</p>\n"}], "owner": {"reputation": 1026, "user_id": 1259193, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/5c27a5bd4a603edd14add85de040c6c0?s=128&d=identicon&r=PG", "display_name": "Angelica Rosa", "link": "https://stackoverflow.com/users/1259193/angelica-rosa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 790, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1521648319, "creation_date": 1521645264, "question_id": 49410061, "link": "https://stackoverflow.com/questions/49410061/class-method-call-and-return-value-how-to-get-it", "title": "Class method &quot;call&quot; and return value: how to get it", "body": "<p>I'm completely new to ruby / ruby on rails, i'm just giving a sort of extreme assistance on an old existing project, so, forgive myself if this is a silly question ;)</p>\n\n<p>I have this class:</p>\n\n<pre><code>class MyClass\n  def call\n    category_id = context.params['category_id']\n    tmp_context = context.clone\n\n    ... stuff...\n\n    content_id\n  end\nend\n</code></pre>\n\n<p>Called this way:</p>\n\n<pre><code>MyClass.call(params: params, current_user: current_user)\n</code></pre>\n\n<p>All i need to get is the return value of the function, the \"content_id\".\nI've tried in several ways and all i can get from this function it's a reference to the context:</p>\n\n<pre><code>#&lt;Interactor::Context params={...}, current_user=#&lt;User ...&gt;&gt;\n</code></pre>\n\n<p>But no hint about the return value.</p>\n\n<p>Any suggestion?</p>\n"}, {"tags": ["ruby", "model-view-controller", "routes", "ruby-on-rails-5"], "comments": [{"owner": {"reputation": 356, "user_id": 7781865, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a015f597dcb8d01d4deae23070c6991f?s=128&d=identicon&r=PG", "display_name": "colincr", "link": "https://stackoverflow.com/users/7781865/colincr"}, "edited": false, "score": 0, "creation_date": 1521651573, "post_id": 49409741, "comment_id": 85826491, "body": "What is the output of <code>rake routes</code> ? My gut tells me you should be using new_user_path or something of the like"}, {"owner": {"reputation": 1099, "user_id": 1967868, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/38a7404c188b85337c9613bc2cc7cd93?s=128&d=identicon&r=PG", "display_name": "zauzaj", "link": "https://stackoverflow.com/users/1967868/zauzaj"}, "edited": false, "score": 0, "creation_date": 1521651654, "post_id": 49409741, "comment_id": 85826555, "body": "Could you please output <code>rake routes</code> ?"}, {"owner": {"reputation": 356, "user_id": 7781865, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a015f597dcb8d01d4deae23070c6991f?s=128&d=identicon&r=PG", "display_name": "colincr", "link": "https://stackoverflow.com/users/7781865/colincr"}, "edited": false, "score": 0, "creation_date": 1521652526, "post_id": 49409741, "comment_id": 85827088, "body": "users_path is likely the route for your index route. Try new_user_path"}, {"owner": {"reputation": 15, "user_id": 9529406, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Nisarg Desai", "link": "https://stackoverflow.com/users/9529406/nisarg-desai"}, "edited": false, "score": 0, "creation_date": 1521656506, "post_id": 49409741, "comment_id": 85829446, "body": "users GET    /users(.:format)          users#index           POST   /users(.:format)          users#create  new_user GET    /users/new(.:format)      users#new edit_user GET    /users/:id/edit(.:format) users#edit      user GET    /users/:id(.:format)      users#show           PATCH  /users/:id(.:format)      users#update           PUT    /users/:id(.:format)      users#update           DELETE /users/:id(.:format)      users#destroy"}], "answers": [{"tags": [], "owner": {"reputation": 26, "user_id": 5790876, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84dd4033656bf6de3dd9ae5a0b4710a0?s=128&d=identicon&r=PG&f=1", "display_name": "carrion crow", "link": "https://stackoverflow.com/users/5790876/carrion-crow"}, "is_accepted": true, "score": 0, "last_activity_date": 1521713811, "creation_date": 1521713811, "answer_id": 49425999, "question_id": 49409741, "link": "https://stackoverflow.com/questions/49409741/no-route-matches-put-users-on-create-action/49425999#49425999", "title": "No route matches [PUT] &quot;/users&quot; on create action", "body": "<p>As your <code>rails routes</code> show you :<br>\n<code>POST /users(.:format) users#create new_user</code><br>\nYou must use <code>new_user_path</code> in the form_for url attribute.</p>\n"}], "owner": {"reputation": 15, "user_id": 9529406, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Nisarg Desai", "link": "https://stackoverflow.com/users/9529406/nisarg-desai"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 70, "favorite_count": 0, "accepted_answer_id": 49425999, "answer_count": 1, "score": 1, "last_activity_date": 1521713811, "creation_date": 1521644440, "question_id": 49409741, "link": "https://stackoverflow.com/questions/49409741/no-route-matches-put-users-on-create-action", "title": "No route matches [PUT] &quot;/users&quot; on create action", "body": "<p>I am new to Ruby on Rails. I am trying to create a registration page for my application. While creating a new user I am getting this error. Thanks a lot in advance !</p>\n\n<p>routes. rb</p>\n\n<pre><code>    Rails.application.routes.draw do\n\n  resources :users\n\n\n\n  # For details on the DSL available within this file, see http://guides.rubyonrails.org/routing.html\nend\n</code></pre>\n\n<p>new.html.erb</p>\n\n<pre><code>    &lt;div class='container'&gt;\n  &lt;div class=\"row\"&gt;\n    &lt;div class=\"login col-lg-6 col-lg-offset-3\"&gt;\n    &lt;%= form_for (@userInfo, :url =&gt; users_path, :method =&gt; 'post') do |f| %&gt;\n      &lt;label&gt;First Name&lt;/label&gt;&lt;%= f.text_field(:first_name) %&gt;&lt;br/&gt;&lt;br/&gt;\n      &lt;label&gt;Last Name&lt;/label&gt;&lt;%= f.text_field(:last_name) %&gt;&lt;br/&gt;&lt;br/&gt;\n      &lt;label&gt;Email&lt;/label&gt;&lt;%= f.text_field(:email) %&gt;&lt;br/&gt;&lt;br/&gt;\n      &lt;label&gt;Password&lt;/label&gt;&lt;%= f.text_field(:password) %&gt;&lt;br/&gt;&lt;br/&gt;\n      &lt;label&gt;Date of Birth&lt;/label&gt;&lt;%= f.text_field(:dob) %&gt;&lt;br/&gt;&lt;br/&gt;\n      &lt;label&gt;Contact No.&lt;/label&gt;&lt;%= f.text_field(:contactno) %&gt;&lt;br/&gt;&lt;br/&gt;\n      &lt;%= f.submit('Register User') %&gt;\n\n    &lt;% end %&gt;\n    &lt;/div&gt;\n  &lt;/div&gt;\n&lt;/div&gt;\n</code></pre>\n\n<p>user_controller</p>\n\n<pre><code>    class UsersController &lt; ApplicationController\n\n  layout 'HomeLayout'\n\n  def new\n      @userInfo = TblUserInformation.new\n  end\n\n  def create\n    @userInfo = TblUserInformation.new(params[:user])\n    @userInfo.save\n  end\nend\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "relationship"], "comments": [{"owner": {"reputation": 1141, "user_id": 5063171, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c460af92c72ddc181a0617a9961a778?s=128&d=identicon&r=PG&f=1", "display_name": "El Fadel Anas", "link": "https://stackoverflow.com/users/5063171/el-fadel-anas"}, "edited": false, "score": 0, "creation_date": 1521644084, "post_id": 49409483, "comment_id": 85820641, "body": "Try this   belongs_to :season_team, :foreign_key =&gt; &quot;season_team_id&quot;"}, {"owner": {"reputation": 575, "user_id": 1558075, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/ffa1f9fdcc9f3d9b0819c2487e1fdd02?s=128&d=identicon&r=PG", "display_name": "DeeWBee", "link": "https://stackoverflow.com/users/1558075/deewbee"}, "reply_to_user": {"reputation": 1141, "user_id": 5063171, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c460af92c72ddc181a0617a9961a778?s=128&d=identicon&r=PG&f=1", "display_name": "El Fadel Anas", "link": "https://stackoverflow.com/users/5063171/el-fadel-anas"}, "edited": false, "score": 0, "creation_date": 1521644303, "post_id": 49409483, "comment_id": 85820830, "body": "@AnassAnas that won&#39;t work because <code>season_team_id</code> isn&#39;t a column on <code>linked_team_constraints</code>"}, {"owner": {"reputation": 1141, "user_id": 5063171, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c460af92c72ddc181a0617a9961a778?s=128&d=identicon&r=PG&f=1", "display_name": "El Fadel Anas", "link": "https://stackoverflow.com/users/5063171/el-fadel-anas"}, "edited": false, "score": 0, "creation_date": 1521644387, "post_id": 49409483, "comment_id": 85820900, "body": "ok then add it or use season_team_id_1 instead of it"}], "answers": [{"comments": [{"owner": {"reputation": 575, "user_id": 1558075, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/ffa1f9fdcc9f3d9b0819c2487e1fdd02?s=128&d=identicon&r=PG", "display_name": "DeeWBee", "link": "https://stackoverflow.com/users/1558075/deewbee"}, "edited": false, "score": 0, "creation_date": 1521645633, "post_id": 49409890, "comment_id": 85821893, "body": "So this <i>technically</i> works (all my unit/function tests pass), but is it possible to have multiple foreign keys on a single relation?"}, {"owner": {"reputation": 313, "user_id": 3702804, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/808845f311afec7b91b8dd8cb0eed4f3?s=128&d=identicon&r=PG", "display_name": "Alex Tatarnikov", "link": "https://stackoverflow.com/users/3702804/alex-tatarnikov"}, "reply_to_user": {"reputation": 575, "user_id": 1558075, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/ffa1f9fdcc9f3d9b0819c2487e1fdd02?s=128&d=identicon&r=PG", "display_name": "DeeWBee", "link": "https://stackoverflow.com/users/1558075/deewbee"}, "edited": false, "score": 1, "creation_date": 1521646084, "post_id": 49409890, "comment_id": 85822274, "body": "Unfortunately, no. As &quot;solution&quot;, you can define method <code>linked_team_constraints</code> and just use <code>where</code> clause. <code>LinkedTeamConstraints.where(&#39;season_team_id_1 = ? OR season_team_id_2 = ?&#39;, _id)</code>."}], "tags": [], "owner": {"reputation": 313, "user_id": 3702804, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/808845f311afec7b91b8dd8cb0eed4f3?s=128&d=identicon&r=PG", "display_name": "Alex Tatarnikov", "link": "https://stackoverflow.com/users/3702804/alex-tatarnikov"}, "is_accepted": true, "score": 2, "last_activity_date": 1521644819, "creation_date": 1521644819, "answer_id": 49409890, "question_id": 49409483, "link": "https://stackoverflow.com/questions/49409483/rails-has-many-with-different-column-names/49409890#49409890", "title": "Rails - has_many with different column names?", "body": "<p>You need to specify <code>foreign_key</code> for your relations and have separate relation for each key. Like:</p>\n\n<pre><code>has_many :linked_team_1_constraints, class_name: 'LinkedTeamConstraints', foreign_key: :season_team_id_1, dependent: :destroy   \nhas_many :linked_team_2_constraints, class_name: 'LinkedTeamConstraints', foreign_key: :season_team_id_2, dependent: :destroy\n</code></pre>\n"}], "owner": {"reputation": 575, "user_id": 1558075, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/ffa1f9fdcc9f3d9b0819c2487e1fdd02?s=128&d=identicon&r=PG", "display_name": "DeeWBee", "link": "https://stackoverflow.com/users/1558075/deewbee"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1140, "favorite_count": 0, "accepted_answer_id": 49409890, "answer_count": 1, "score": -1, "last_activity_date": 1521644819, "creation_date": 1521643778, "question_id": 49409483, "link": "https://stackoverflow.com/questions/49409483/rails-has-many-with-different-column-names", "title": "Rails - has_many with different column names?", "body": "<p>I have a data model - <code>SeasonTeams</code> with the following relation: </p>\n\n<p><code>has_many :linked_team_constraints, class_name: 'LinkedTeamConstraints', dependent: :destroy</code></p>\n\n<p>Then I have the <code>LinkedTeamConstraints</code> model as follows: </p>\n\n<p><code>belongs_to :season_team, primary_key: :_id</code></p>\n\n<p>Now when I call <code>destroy</code> on the <code>SeasonTeam</code> - thereby destroying the <code>LinkedTeamConstraint</code> - I get error <code>column linked_team_constraints.season_team_id does not exist</code>. I <em>do</em> have two OTHER columns labeled <code>season_team_id_1</code> and <code>season_team_id_2</code>. How can I establish a has_many relationship such that <code>linked_team_constraints.season_team_id_1</code> or <code>..._id_2</code> is queried instead of <code>...season_team_id</code>. </p>\n\n<p>Would it be something like: </p>\n\n<p><code>has_many :linked_team_constraints... {where(\"_id == ?\", linked_team_constraints.season_team_id_1 || linked_team_constraints.season_team_id_2)}</code>?</p>\n"}, {"tags": ["ruby", "ide", "cloud9"], "comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1521653897, "post_id": 49408171, "comment_id": 85827952, "body": "Do you have a <code>Gemfile</code>? Did you <code>bundle install</code>?"}, {"owner": {"reputation": 11, "user_id": 9501008, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/667f2d4f05651660bc12d65eaa5a7310?s=128&d=identicon&r=PG&f=1", "display_name": "Waterman33", "link": "https://stackoverflow.com/users/9501008/waterman33"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1522205467, "post_id": 49408171, "comment_id": 86056409, "body": "Thanks for the suggestion. It appears that I have a Gemfile, and I tried running bundle install with no luck-see the edit above."}], "owner": {"reputation": 11, "user_id": 9501008, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/667f2d4f05651660bc12d65eaa5a7310?s=128&d=identicon&r=PG&f=1", "display_name": "Waterman33", "link": "https://stackoverflow.com/users/9501008/waterman33"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 59, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1522205360, "creation_date": 1521640316, "last_edit_date": 1522205360, "question_id": 49408171, "link": "https://stackoverflow.com/questions/49408171/how-to-run-a-ruby-application-in-cloud9-ide-that-uses-ruby-2d-gem", "title": "How to run a Ruby application in Cloud9 IDE that uses Ruby 2D gem?", "body": "<p>I am using Cloud9 IDE and have Ruby gems simple2d and ruby2d installed. I am trying to run this code:</p>\n\n<pre><code>require 'ruby2d'\nset width: 300, height: 200\ns = Square.new\ns.color = 'red'\nshow\n</code></pre>\n\n<p>When I run my code, the small terminal at the bottom of the screen says something like \"Your code is running at...link_goes_here\". Clicking the link takes you to a page very similar to:<a href=\"http://web.mit.edu/zelda/BACKUPS/\" rel=\"nofollow noreferrer\"> Ruby on Rails: Welcome Aboard</a>.</p>\n\n<p>I am very new to Ruby, but understand that this page indicates that \"additional steps\" may need to be taken in order to see your application run (i.e. setting up models, controller, and routes). However, after a little bit of Googling, it seems that people only do these \"additional steps\" when doing \"HTML\" related things (please excuse my lack of proper terminology). For example, <a href=\"http://guides.rubyonrails.org/getting_started.html\" rel=\"nofollow noreferrer\">Getting Started with Rails</a> walks the reader through changing the <a href=\"http://guides.rubyonrails.org/getting_started.html\" rel=\"nofollow noreferrer\">Ruby on Rails: Welcome Aboard</a> page to say \"Hello, Rails\" (and then other things after that). </p>\n\n<p>Can someone please explain/show me what to do in order to run my code?</p>\n\n<p>Thanks! </p>\n\n<p><strong>EDIT: 2018-03-27</strong></p>\n\n<p>It appears that I have a Gemfile: <a href=\"https://i.stack.imgur.com/elKSC.png\" rel=\"nofollow noreferrer\">Cloud9 IDE Directory</a></p>\n\n<p>When I ran <code>bundle install</code> I got the following output:</p>\n\n<p><code> \nUsing rake 12.0.0\nUsing i18n 0.8.6\nUsing json 1.8.6\nUsing minitest 5.10.3\nUsing thread_safe 0.3.6\nUsing tzinfo 1.2.3\nUsing activesupport 4.2.5\nUsing builder 3.2.3\nUsing erubis 2.7.0\nUsing mini_portile2 2.2.0\nUsing nokogiri 1.8.0\nUsing rails-deprecated_sanitizer 1.0.3\nUsing rails-dom-testing 1.0.8\nUsing loofah 2.0.3\nUsing rails-html-sanitizer 1.0.3\nUsing actionview 4.2.5\nUsing rack 1.6.8\nUsing rack-test 0.6.3\nUsing actionpack 4.2.5\nUsing globalid 0.4.0\nUsing activejob 4.2.5\nUsing mime-types-data 3.2016.0521\nUsing mime-types 3.1\nUsing mail 2.6.6\nUsing actionmailer 4.2.5\nUsing activemodel 4.2.5\nUsing arel 6.0.4\nUsing activerecord 4.2.5\nUsing debug_inspector 0.0.3\nUsing binding_of_caller 0.7.2\nUsing bundler 1.16.1\nUsing byebug 9.1.0\nUsing coffee-script-source 1.12.2\nUsing execjs 2.7.0\nUsing coffee-script 2.4.1\nUsing thor 0.20.0\nUsing railties 4.2.5\nUsing coffee-rails 4.1.1\nUsing concurrent-ruby 1.0.5\nUsing ffi 1.9.18\nUsing multi_json 1.12.1\nUsing jbuilder 2.7.0\nUsing jquery-rails 4.3.1\nUsing sprockets 3.7.1\nUsing sprockets-rails 3.2.0\nUsing rails 4.2.5\nUsing rb-fsevent 0.10.2\nUsing rb-inotify 0.9.10\nUsing rdoc 4.3.0\nUsing sass-listen 4.0.0\nUsing sass 3.5.1\nUsing tilt 2.0.8\nUsing sass-rails 5.0.6\nUsing sdoc 0.4.2\nUsing spring 2.0.2\nUsing sqlite3 1.3.13\nUsing turbolinks-source 5.0.3\nUsing turbolinks 5.0.1\nUsing uglifier 3.2.0\nUsing web-console 2.3.0\nBundle complete! 12 Gemfile dependencies, 60 gems now installed.\nUse <code>bundle info [gemname]</code> to see where a bundled gem is installed.\n</code></p>\n\n<p>I still run into the same issue when trying to run my code.</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 21613, "user_id": 580346, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/ba17945a06aac247b06548d5afe341e8?s=128&d=identicon&r=PG", "display_name": "mrzasa", "link": "https://stackoverflow.com/users/580346/mrzasa"}, "edited": false, "score": 0, "creation_date": 1521639343, "post_id": 49407721, "comment_id": 85816735, "body": "&quot;Nothing happened&quot; - which page was rendered? Try to update with bang <code>@user.update_attributes!(allowed_params)</code> and see if you have an exception and what is the exception."}, {"owner": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "edited": false, "score": 0, "creation_date": 1521639558, "post_id": 49407721, "comment_id": 85816915, "body": "A word of advice advise is to stick to the rails conventions and call your methods <code>save</code> and <code>update</code> and not <code>update_user</code> as this lets you use convention over configuration instead of manually specifying the routes."}, {"owner": {"reputation": 7598, "user_id": 6708661, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/Qa4Kq.jpg?s=128&g=1", "display_name": "Sagar Gautam", "link": "https://stackoverflow.com/users/6708661/sagar-gautam"}, "edited": false, "score": 0, "creation_date": 1521639600, "post_id": 49407721, "comment_id": 85816941, "body": "When I click the submit button in update case nothing happend, I&#39;ll share my view one minute."}, {"owner": {"reputation": 21613, "user_id": 580346, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/ba17945a06aac247b06548d5afe341e8?s=128&d=identicon&r=PG", "display_name": "mrzasa", "link": "https://stackoverflow.com/users/580346/mrzasa"}, "edited": false, "score": 0, "creation_date": 1521639760, "post_id": 49407721, "comment_id": 85817073, "body": "You probably have validation errors. Please try with <code>update_attributes!</code> and check if any error is raised."}, {"owner": {"reputation": 7598, "user_id": 6708661, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/Qa4Kq.jpg?s=128&g=1", "display_name": "Sagar Gautam", "link": "https://stackoverflow.com/users/6708661/sagar-gautam"}, "reply_to_user": {"reputation": 21613, "user_id": 580346, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/ba17945a06aac247b06548d5afe341e8?s=128&d=identicon&r=PG", "display_name": "mrzasa", "link": "https://stackoverflow.com/users/580346/mrzasa"}, "edited": false, "score": 0, "creation_date": 1521639917, "post_id": 49407721, "comment_id": 85817180, "body": "@mrzasa no error is displayed on form element, what could be the reason ? any idea"}, {"owner": {"reputation": 1266, "user_id": 6022100, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/dc0adea29934c8ee1c31f96bf85a7fbc?s=128&d=identicon&r=PG", "display_name": "rwold", "link": "https://stackoverflow.com/users/6022100/rwold"}, "edited": false, "score": 0, "creation_date": 1521640210, "post_id": 49407721, "comment_id": 85817432, "body": "1) Can you find the console output to terminal, or log files? 2) If you open the developer console in your browser, what status code do you see when you submit your form? Are the submitted parameters what you expect?"}, {"owner": {"reputation": 7598, "user_id": 6708661, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/Qa4Kq.jpg?s=128&g=1", "display_name": "Sagar Gautam", "link": "https://stackoverflow.com/users/6708661/sagar-gautam"}, "reply_to_user": {"reputation": 1266, "user_id": 6022100, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/dc0adea29934c8ee1c31f96bf85a7fbc?s=128&d=identicon&r=PG", "display_name": "rwold", "link": "https://stackoverflow.com/users/6022100/rwold"}, "edited": false, "score": 0, "creation_date": 1521640278, "post_id": 49407721, "comment_id": 85817490, "body": "@rwold I&#39;ll see, I&#39;ve just started learning rails since 2 days and i don&#39;t have good knoledge"}], "answers": [{"tags": [], "owner": {"reputation": 139, "user_id": 7604645, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rdxji.png?s=128&g=1", "display_name": "EarlyZhao", "link": "https://stackoverflow.com/users/7604645/earlyzhao"}, "is_accepted": false, "score": 0, "last_activity_date": 1521643019, "creation_date": 1521643019, "answer_id": 49409192, "question_id": 49407721, "link": "https://stackoverflow.com/questions/49407721/request-denied-while-updating-user-details-in-rails/49409192#49409192", "title": "Request denied while updating user details in rails", "body": "<p>There is a debug way.</p>\n\n<ol>\n<li>You should launch the server in development mode. Then check the changes of development.log file in the terminal by <code>tail -f log/development.log</code>.</li>\n<li>Then do what you want, such as click the \"submit\" button when you changed the fname or other fields.</li>\n<li><p>Then focus on the informations got on step 1. There are what you can get:</p>\n\n<p><code>A. which Controller and action handled the request</code> </p>\n\n<p><code>B. The parameters of this request.</code></p>\n\n<p><code>C. The log of SQLs excuted by DB</code></p>\n\n<p><code>D. The response status</code></p>\n\n<p>Check if the right Controller? or right parameters? or SQLs has been excuted? In addition\uff0c we used to <code>@user.update_attributes!(allowed_params)</code> when debug. It take more informations when something disobeys the rules defined in Model(User).</p></li>\n</ol>\n"}], "owner": {"reputation": 7598, "user_id": 6708661, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/Qa4Kq.jpg?s=128&g=1", "display_name": "Sagar Gautam", "link": "https://stackoverflow.com/users/6708661/sagar-gautam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 50, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1521643019, "creation_date": 1521639083, "last_edit_date": 1521639684, "question_id": 49407721, "link": "https://stackoverflow.com/questions/49407721/request-denied-while-updating-user-details-in-rails", "title": "Request denied while updating user details in rails", "body": "<p>I'm new to ruby on rails.</p>\n\n<p>I've two type of users Admin and User. Admin can create edit and destroy user. I've no problem with create and destroy and have implemented quite easily.</p>\n\n<p>I've used following code in controller,</p>\n\n<pre><code>private\n\ndef allowed_params\n    params.require(:user).permit(:role_id, :email, :password, :password_confirmation, :fname, :lname)\nend \n</code></pre>\n\n<p>to define parameters required and allowed while creating user. </p>\n\n<p><strong>User Create</strong></p>\n\n<pre><code>def save_user\n    @user = User.new(allowed_params)\n    if @user.save\n        redirect_to list_users_path\n    else\n        render 'add_user'\n    end\nend\n</code></pre>\n\n<p><strong>User Update</strong></p>\n\n<pre><code>def update_user\n    @user = User.find(params[:id])\n    if @user.update_attributes(allowed_params)\n        redirect_to list_users_path\n    else\n        render 'edit_user'\n    end\nend\n</code></pre>\n\n<p><strong>View</strong></p>\n\n<pre><code>&lt;div class=\"container\"&gt;\n  &lt;div class=\"row\"&gt;\n    &lt;div class=\"col-md-12\"&gt;\n    &lt;%= link_to \"Admin Dashboard\", admin_dashboard_path, :class=&gt;'pull-left' %&gt;\n      &lt;%= form_for @user, :url =&gt; update_user_path do |f| %&gt;\n        &lt;div class=\"row\"&gt;\n          &lt;div class=\"col-md-12 field\"&gt;\n            &lt;div class=\"col-md-3\"&gt;\n              &lt;h2 style=\"text-align: center;\"&gt;Edit User Details&lt;/h2&gt;\n            &lt;/div&gt;\n          &lt;/div&gt;\n        &lt;/div&gt;\n        &lt;div class=\"row\"&gt;\n          &lt;div class=\"col-md-12 field\"&gt;\n            &lt;div class=\"col-md-3\"&gt;\n              &lt;%= f.label :fname, 'First Name' %&gt;&lt;br /&gt;\n              &lt;%= f.text_field :fname, :class =&gt; 'form-control' %&gt;\n              &lt;p class=\"error\"&gt;&lt;%= show_errors(@user, :fname) %&gt;&lt;/p&gt;\n            &lt;/div&gt;\n          &lt;/div&gt;\n        &lt;/div&gt;\n        &lt;div class=\"row\"&gt;\n          &lt;div class=\"col-md-12 field\"&gt;\n            &lt;div class=\"col-md-3\"&gt;\n              &lt;%= f.label :lname, 'Last Name' %&gt;&lt;br /&gt;\n              &lt;%= f.text_field :lname, :class =&gt; 'form-control' %&gt;\n              &lt;p class=\"error\"&gt;&lt;%= show_errors(@user, :lname) %&gt;&lt;/p&gt;\n            &lt;/div&gt;\n          &lt;/div&gt;\n        &lt;/div&gt;\n\n        &lt;div class=\"row\"&gt;\n          &lt;div class=\"col-md-12 field\"&gt;\n            &lt;div class=\"col-md-3\"&gt;\n                &lt;%= f.label :email, 'Email' %&gt;&lt;br /&gt;\n                &lt;%= f.text_field :email, :class =&gt; 'form-control' %&gt;\n                &lt;p class=\"error\"&gt;&lt;%= show_errors(@user, :email) %&gt;&lt;/p&gt;\n            &lt;/div&gt;\n          &lt;/div&gt;\n        &lt;/div&gt;\n        &lt;div class=\"row\"&gt;\n          &lt;div class=\"col-md-12 field\"&gt;\n            &lt;div class=\"col-md-3\" style=\"text-align: center\"&gt;\n              &lt;%= f.submit \"Update User\", :class =&gt; 'btn btn-sm btn-primary' %&gt;\n            &lt;/div&gt;\n          &lt;/div&gt;\n        &lt;/div&gt;\n      &lt;% end %&gt;\n    &lt;/div&gt;\n  &lt;/div&gt;\n&lt;/div&gt;\n</code></pre>\n\n<p>when I pass only fname, lname and email nothing happened. I need to update user details what should I do here ?</p>\n\n<p>Any suggestion is appreciated.</p>\n"}, {"tags": ["ruby", "authorize.net"], "comments": [{"owner": {"reputation": 206971, "user_id": 250259, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/64839d31baaefafa58120e1a5a503d66?s=128&d=identicon&r=PG", "display_name": "John Conde", "link": "https://stackoverflow.com/users/250259/john-conde"}, "edited": false, "score": 0, "creation_date": 1521639711, "post_id": 49407620, "comment_id": 85817030, "body": "Is it possible to output what the actually request generated by Ruby looks like?"}, {"owner": {"reputation": 537, "user_id": 4907105, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/YbVDe.jpg?s=128&g=1", "display_name": "Sumeet Masih", "link": "https://stackoverflow.com/users/4907105/sumeet-masih"}, "reply_to_user": {"reputation": 206971, "user_id": 250259, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/64839d31baaefafa58120e1a5a503d66?s=128&d=identicon&r=PG", "display_name": "John Conde", "link": "https://stackoverflow.com/users/250259/john-conde"}, "edited": false, "score": 0, "creation_date": 1521640260, "post_id": 49407620, "comment_id": 85817470, "body": "@JohnConde updated the question"}, {"owner": {"reputation": 206971, "user_id": 250259, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/64839d31baaefafa58120e1a5a503d66?s=128&d=identicon&r=PG", "display_name": "John Conde", "link": "https://stackoverflow.com/users/250259/john-conde"}, "edited": false, "score": 0, "creation_date": 1521646934, "post_id": 49407620, "comment_id": 85822946, "body": "It is possible to get the actual XML this produces? I don&#39;t know Ruby so I can&#39;t see what the issue is without seeing the XML of the request."}], "owner": {"reputation": 537, "user_id": 4907105, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/YbVDe.jpg?s=128&g=1", "display_name": "Sumeet Masih", "link": "https://stackoverflow.com/users/4907105/sumeet-masih"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 103, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1521640238, "creation_date": 1521638859, "last_edit_date": 1521640238, "question_id": 49407620, "link": "https://stackoverflow.com/questions/49407620/not-able-to-create-authorize-net-customer-profiles-through-its-api", "title": "Not able to create Authorize.Net customer profiles through its API", "body": "<p>Using <code>authorizenet gem 1.8.9</code>\nruby <code>1.9.3</code></p>\n\n<p>on trying to create a customer profile I am getting this error</p>\n\n<pre><code>require 'authorizenet'\n\ntransaction = AuthorizeNet::API::Transaction.new(some_id, some_key, :gateway =&gt; :sandbox)\n\nrequest = AuthorizeNet::API::CreateCustomerProfileRequest.new(nil,nil,nil, 'liveMode')\n\nrequest.profile = AuthorizeNet::API::CustomerProfileType.new(\"sumeetyesme1870\", \"sumeet new\",\"sumeet@example.com\")\n</code></pre>\n\n<p>actual request </p>\n\n<pre><code> request\n=&gt; #&lt;AuthorizeNet::API::CreateCustomerProfileRequest:0x0000000652d4c8\n @merchantAuthentication=nil,\n @profile=\n  #&lt;AuthorizeNet::API::CustomerProfileType:0x000000067c6c98\n   @description=\"sumeet new\",\n   @email=\"sumeet@masih.com\",\n   @merchantCustomerId=\"sumeetMasih1870\",\n   @paymentProfiles=[],\n   @shipToList=[]&gt;,\n @refId=nil,\n @validationMode=\"liveMode\"&gt;\n\n\nresponse = transaction.create_customer_profile(request)\n</code></pre>\n\n<p>on printing response</p>\n\n<pre><code>puts response.messages.messages[0].code \n</code></pre>\n\n<p>I get <code>E00003</code></p>\n\n<pre><code>puts response.messages.messages[0].text\n</code></pre>\n\n<blockquote>\n  <p>The element 'paymentProfiles' in namespace 'AnetApi/xml/v1/schema/AnetApiSchema.xsd' cannot contain text. List of possible elements expected: 'customerType, billTo, payment, driversLicense, taxId, defaultPaymentProfile' in namespace 'AnetApi/xml/v1/schema/AnetApiSchema.xsd'.</p>\n</blockquote>\n"}, {"tags": ["arrays", "ruby", "memory"], "comments": [{"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 3, "creation_date": 1521634653, "post_id": 49406072, "comment_id": 85813168, "body": "What about <code>b = a.concat(b)</code>?"}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 1, "creation_date": 1521644472, "post_id": 49406072, "comment_id": 85820971, "body": "How do you know that ruby won&#39;t allocate N copies of <code>a</code> (and thus waste this memory) while you add elements one by one? If you <i>do</i> care about memory, you need to memory-profile the code and see how much objects does each variant allocate."}, {"owner": {"reputation": 333, "user_id": 8410844, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a22f7cefc10d1200ae2fb0e48fe448d6?s=128&d=identicon&r=PG&f=1", "display_name": "MOPO3OB", "link": "https://stackoverflow.com/users/8410844/mopo3ob"}, "reply_to_user": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1521648648, "post_id": 49406072, "comment_id": 85824348, "body": "@Stefan then it would be <code>b = a.concat(b); a = []</code> which is the same as <code>b.unshift(*a); a = []</code>. I believe that&#39;s not quite what @user1134991 asked for."}], "answers": [{"comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 1, "creation_date": 1521655958, "post_id": 49409519, "comment_id": 85829108, "body": "This probably creates a lot more garbage than the original attempt, so be aware."}, {"owner": {"reputation": 333, "user_id": 8410844, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a22f7cefc10d1200ae2fb0e48fe448d6?s=128&d=identicon&r=PG&f=1", "display_name": "MOPO3OB", "link": "https://stackoverflow.com/users/8410844/mopo3ob"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1521662164, "post_id": 49409519, "comment_id": 85832589, "body": "@tadman &quot;<i>probably</i>&quot;? You don&#39;t quite understand how this works, do you? Here, let me explain it for you. <code>a.pop(a.size)</code> will return entire array <code>a</code> and will also remove all elements from array <code>a</code>. What&#39;s been happening to memory is determined by implementation of Ruby. Both variants described in the answer completely free memory for array <code>a</code> when using default Ruby."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 1, "creation_date": 1521664663, "post_id": 49409519, "comment_id": 85833953, "body": "That&#39;s &quot;probably&quot; not the way you should explain something to anyone, especially not someone who&#39;s answered thousands of questions about Ruby. I say probably only because different implementations, even different versions of Ruby have variations on how this is handled, but this is by no means a guaranteed &quot;better&quot; solution."}, {"owner": {"reputation": 333, "user_id": 8410844, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a22f7cefc10d1200ae2fb0e48fe448d6?s=128&d=identicon&r=PG&f=1", "display_name": "MOPO3OB", "link": "https://stackoverflow.com/users/8410844/mopo3ob"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1521675643, "post_id": 49409519, "comment_id": 85838227, "body": "@tadman if you are so experienced in &quot;answering <i>thousands</i> of questions about Ruby&quot;, then you should have tested my solutions before saying that \u201cthis ... creates <i>a lot more</i> garbage than the original attempt ...\u201d. By doing so, you would have known that it\u2019s not true. Moreover, the way this is handled is being unchanged from at least Ruby 1.9.3 up to current version."}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 1, "creation_date": 1521733109, "post_id": 49409519, "comment_id": 85867289, "body": "Memory-profiling these snippets and those of OP would help in persuading audience that this sometimes does perform better. At a glance, both these snippets allocate at least one new array of <code>a.size</code>. About the same as the code in the question."}, {"owner": {"reputation": 333, "user_id": 8410844, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a22f7cefc10d1200ae2fb0e48fe448d6?s=128&d=identicon&r=PG&f=1", "display_name": "MOPO3OB", "link": "https://stackoverflow.com/users/8410844/mopo3ob"}, "reply_to_user": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1521734565, "post_id": 49409519, "comment_id": 85868351, "body": "@SergioTulentsev agreed. I found first comment left by Mr. @tadman inappropriate because it said that my code performs worse than the original, but in fact it doesn\u2019t. No analysis have been made before saying that. No doubt that Mr. @tadman is very experienced, but that comment was unprofessional. Note that I have never said that I deny the fact that <code>b += a</code> would perform better on memory. My answer to the question \u201cIs there something more elegant?\u201d begins with words \u201cUsing both <code>unshift</code> and <code>pop</code> ...\u201d."}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1521735027, "post_id": 49409519, "comment_id": 85868685, "body": "took the liberty of including the exact question you were responding to."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1521740970, "post_id": 49409519, "comment_id": 85872497, "body": "@MOPO3OB I made that observation because I had a sneaking suspicion this might be a step backwards. You&#39;re welcome to challenge that, but verbally berating someone for simply having skepticism is really out of line. I&#39;ve addressed performance-related queries before and sometimes the fastest thing is very surprising because of Ruby&#39;s internal optimizations. The problem I have with this solution is it <i>incrementally</i> extends the target array which may result in several increasingly large allocations. A concatenation operation can allocate the new size once."}, {"owner": {"reputation": 333, "user_id": 8410844, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a22f7cefc10d1200ae2fb0e48fe448d6?s=128&d=identicon&r=PG&f=1", "display_name": "MOPO3OB", "link": "https://stackoverflow.com/users/8410844/mopo3ob"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1521741282, "post_id": 49409519, "comment_id": 85872681, "body": "@tadman why do you say that it extends the target array <i>incrementally</i>?"}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1521741382, "post_id": 49409519, "comment_id": 85872756, "body": "That&#39;s what <code>unshift</code> does, it adds one element at a time. If you were doing this on an array of length 1e6 that would require multiple extensions to that array&#39;s size, each one of which is a new allocation + copy of existing data (pointers). Most dynamic arrays resize by increments of 1.5-2x. That means going from length 0 to length 1,000,000 requires about 19-39 allocations."}, {"owner": {"reputation": 333, "user_id": 8410844, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a22f7cefc10d1200ae2fb0e48fe448d6?s=128&d=identicon&r=PG&f=1", "display_name": "MOPO3OB", "link": "https://stackoverflow.com/users/8410844/mopo3ob"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1521741659, "post_id": 49409519, "comment_id": 85872909, "body": "@tadman does it? Doesn&#39;t <code>ary_memcpy0(ary, 0, argc, argv, target_ary); ARY_SET_LEN(ary, len + argc);</code> do that in one step?"}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1521741778, "post_id": 49409519, "comment_id": 85872976, "body": "I&#39;m asking how the initial <code>unshift</code> operation has enough context for Ruby to know that this is the first of a million unshifts you&#39;re about to perform. Obviously it doesn&#39;t, so it just extends the array incrementally using the usual rules. When doing a concat it knows exactly how long the new array has to be, so yeah, then it <i>can</i> extend in one shot."}, {"owner": {"reputation": 333, "user_id": 8410844, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a22f7cefc10d1200ae2fb0e48fe448d6?s=128&d=identicon&r=PG&f=1", "display_name": "MOPO3OB", "link": "https://stackoverflow.com/users/8410844/mopo3ob"}, "edited": false, "score": 1, "creation_date": 1521742400, "post_id": 49409519, "comment_id": 85873338, "body": "I think both <code>concat</code> and <code>unshift</code> know how long the new array would be. They both use <code>RARRAY_LEN()</code> for calculating that."}], "tags": [], "owner": {"reputation": 333, "user_id": 8410844, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a22f7cefc10d1200ae2fb0e48fe448d6?s=128&d=identicon&r=PG&f=1", "display_name": "MOPO3OB", "link": "https://stackoverflow.com/users/8410844/mopo3ob"}, "is_accepted": true, "score": 1, "last_activity_date": 1521734817, "last_edit_date": 1521734817, "creation_date": 1521643876, "answer_id": 49409519, "question_id": 49406072, "link": "https://stackoverflow.com/questions/49406072/unshifting-destructively-an-array-into-an-array-in-ruby/49409519#49409519", "title": "Unshifting destructively an array into an array in Ruby", "body": "<blockquote>\n  <p>Is there something more elegant?</p>\n</blockquote>\n\n<p>Using both <code>unshift</code> and <code>pop</code>:</p>\n\n<pre><code>a = [1,2,3]\nb = [4,5,6]\n\nb.unshift(*a.pop(a.size))\n\np a, b\n# []\n# [1, 2, 3, 4, 5, 6]\n</code></pre>\n\n<p>Or if you don't want to use <code>*</code>:</p>\n\n<pre><code>a = [1,2,3]\nb = [4,5,6]\n\nb.unshift(a.pop(a.size)).flatten!\n\np a, b\n# []\n# [1, 2, 3, 4, 5, 6]\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1521733285, "post_id": 49413745, "comment_id": 85867440, "body": "There were times when MRI would not release any memory at all (its heap would only grow, never shrink). I think it&#39;s better now. :)"}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "reply_to_user": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1521741145, "post_id": 49413745, "comment_id": 85872608, "body": "@SergioTulentsev Ah, the 1.8 days where we had to processes out back and shoot them because they&#39;d become too fat and old."}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1521811531, "post_id": 49413745, "comment_id": 85903632, "body": "Was it only up to 1.8? My memory is fuzzy, but I&#39;m quite sure that 1.9 was also behaving like this."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "reply_to_user": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1521855486, "post_id": 49413745, "comment_id": 85923669, "body": "@SergioTulentsev 1.8 was so bad that &quot;Enterprise Ruby&quot; existed to fix the problem. 1.9 made big improvements, 2.0 largely better."}], "tags": [], "owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "is_accepted": false, "score": 2, "last_activity_date": 1521655851, "creation_date": 1521655851, "answer_id": 49413745, "question_id": 49406072, "link": "https://stackoverflow.com/questions/49406072/unshifting-destructively-an-array-into-an-array-in-ruby/49413745#49413745", "title": "Unshifting destructively an array into an array in Ruby", "body": "<p>There's no guarantee the memory allocated to <code>a</code> will be released just because you've removed all of the elements. Most dynamic array systems allocate as the array is increased in size, that's a hard necessity, but are more relaxed when it comes to decreasing size.</p>\n\n<p>The best approach is to do <code>b += a</code>, let <code>a</code> fall out of scope, and then let the garbage collector sort it out.</p>\n\n<p>Unless you can produce a concrete benchmark that shows that your convoluted approach works better, which it probably doesn't as a splat operation is going to create additional garbage that needs to be collected, you should do the simplest thing that works.</p>\n"}], "owner": {"reputation": 2689, "user_id": 1134991, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/e102cb584a0fba3cd07b0a4d79350ba2?s=128&d=identicon&r=PG", "display_name": "user1134991", "link": "https://stackoverflow.com/users/1134991/user1134991"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 94, "favorite_count": 0, "accepted_answer_id": 49409519, "answer_count": 2, "score": 1, "last_activity_date": 1521734817, "creation_date": 1521634354, "last_edit_date": 1521648890, "question_id": 49406072, "link": "https://stackoverflow.com/questions/49406072/unshifting-destructively-an-array-into-an-array-in-ruby", "title": "Unshifting destructively an array into an array in Ruby", "body": "<p>Say I have two sizable arrays, <code>a</code> and <code>b</code>.</p>\n\n<p>I want to have <code>b=a+b</code>, but I don't really need <code>a</code> afterwards, and would much rather have the memory saved, in order to avoid swapping.</p>\n\n<p>I have thought about simply using:</p>\n\n<pre><code>b.unshift( *a.slice!(0..-1) )\n</code></pre>\n\n<p>But the above has the downside of still keeping a copy of <code>a</code> until the procedure is finished. The other option would be:</p>\n\n<pre><code>while ! a.empty?() do \n       b.unshift( a.pop() )\nend\n</code></pre>\n\n<p>While not elegant, and maybe even slower (this is iterations, I don't know how fast the <code>*</code> operator works, maybe it is on lower level), this keeps the intermediate memory footprint to a minimum.</p>\n\n<p>Is there something more elegant?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "sidekiq"], "comments": [{"owner": {"reputation": 7605, "user_id": 584552, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/dc70f4a04726fada8b9db8a18ff40412?s=128&d=identicon&r=PG", "display_name": "mdesantis", "link": "https://stackoverflow.com/users/584552/mdesantis"}, "edited": false, "score": 0, "creation_date": 1521637494, "post_id": 49405694, "comment_id": 85815216, "body": "I didn&#39;t even know that <code>Sidekiq::Worker</code> acted like a middleware lol thank you for making me discover it!"}, {"owner": {"reputation": 14010, "user_id": 3109182, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/a4b305f0077055b4fdcf715067775d5a?s=128&d=identicon&r=PG", "display_name": "Anthony", "link": "https://stackoverflow.com/users/3109182/anthony"}, "edited": false, "score": 0, "creation_date": 1521639579, "post_id": 49405694, "comment_id": 85816928, "body": "Your last example won&#39;t work right?  The thread that enqueues the job is  [most likely] not the thread that performs the job."}, {"owner": {"reputation": 1980, "user_id": 2555580, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/ugSyl.jpg?s=128&g=1", "display_name": "Ashish Gaur", "link": "https://stackoverflow.com/users/2555580/ashish-gaur"}, "reply_to_user": {"reputation": 14010, "user_id": 3109182, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/a4b305f0077055b4fdcf715067775d5a?s=128&d=identicon&r=PG", "display_name": "Anthony", "link": "https://stackoverflow.com/users/3109182/anthony"}, "edited": false, "score": 0, "creation_date": 1521640978, "post_id": 49405694, "comment_id": 85818095, "body": "@Anthony Sorry I didn&#39;t implement that and test it. I was just sharing what my thoughts are for a solution. I don&#39;t know if it&#39;ll work or not."}], "answers": [{"comments": [{"owner": {"reputation": 1980, "user_id": 2555580, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/ugSyl.jpg?s=128&g=1", "display_name": "Ashish Gaur", "link": "https://stackoverflow.com/users/2555580/ashish-gaur"}, "edited": false, "score": 0, "creation_date": 1521653236, "post_id": 49410531, "comment_id": 85827528, "body": "Thanks Mike, I tried using that but it is triggered in the background job not in the web server. I need the current_user info which is available while processing the request in the web server, that info is no longer available in background server. I need to do this just before perform_async"}, {"owner": {"reputation": 17782, "user_id": 1494519, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af54a0871600db7fbdbb5c558a6e29a3?s=128&d=identicon&r=PG", "display_name": "Mike Perham", "link": "https://stackoverflow.com/users/1494519/mike-perham"}, "reply_to_user": {"reputation": 1980, "user_id": 2555580, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/ugSyl.jpg?s=128&g=1", "display_name": "Ashish Gaur", "link": "https://stackoverflow.com/users/2555580/ashish-gaur"}, "edited": false, "score": 0, "creation_date": 1521669286, "post_id": 49410531, "comment_id": 85836104, "body": "<a href=\"https://github.com/mperham/sidekiq/wiki/Middleware#sometimes-client-side-middleware-should-be-registered-in-both-places\" rel=\"nofollow noreferrer\">github.com/mperham/sidekiq/wiki/&hellip;</a>"}, {"owner": {"reputation": 17782, "user_id": 1494519, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af54a0871600db7fbdbb5c558a6e29a3?s=128&d=identicon&r=PG", "display_name": "Mike Perham", "link": "https://stackoverflow.com/users/1494519/mike-perham"}, "reply_to_user": {"reputation": 1980, "user_id": 2555580, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/ugSyl.jpg?s=128&g=1", "display_name": "Ashish Gaur", "link": "https://stackoverflow.com/users/2555580/ashish-gaur"}, "edited": false, "score": 0, "creation_date": 1521669331, "post_id": 49410531, "comment_id": 85836120, "body": "The client side middleware runs as part of the perform_async.  It&#39;s what you want."}], "tags": [], "owner": {"reputation": 17782, "user_id": 1494519, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af54a0871600db7fbdbb5c558a6e29a3?s=128&d=identicon&r=PG", "display_name": "Mike Perham", "link": "https://stackoverflow.com/users/1494519/mike-perham"}, "is_accepted": true, "score": 1, "last_activity_date": 1521646513, "creation_date": 1521646513, "answer_id": 49410531, "question_id": 49405694, "link": "https://stackoverflow.com/questions/49405694/default-arguments-in-sidekiq-perform-async/49410531#49410531", "title": "Default arguments in sidekiq perform_async", "body": "<p>You need a client/server middleware pair, not just server-side.</p>\n\n<p><a href=\"https://github.com/mperham/sidekiq/wiki/Middleware\" rel=\"nofollow noreferrer\">https://github.com/mperham/sidekiq/wiki/Middleware</a></p>\n"}], "owner": {"reputation": 1980, "user_id": 2555580, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/ugSyl.jpg?s=128&g=1", "display_name": "Ashish Gaur", "link": "https://stackoverflow.com/users/2555580/ashish-gaur"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1042, "favorite_count": 0, "accepted_answer_id": 49410531, "answer_count": 1, "score": 1, "last_activity_date": 1521646513, "creation_date": 1521633271, "question_id": 49405694, "link": "https://stackoverflow.com/questions/49405694/default-arguments-in-sidekiq-perform-async", "title": "Default arguments in sidekiq perform_async", "body": "<p>I need to access the current_user in sidekiq jobs. One way to do this is pass the current_user in the perform_async, however since it's needed at many places I wanted to add it by default.</p>\n\n<p>So I added a server middleware which would fetch the current_user login and set it in Thread.current, here's my middleware</p>\n\n<pre><code>class SidekiqServerMiddleware\n\n  def call(_worker, job, _queue)\n    set_current_user(job['args'])\n    yield\n  end\n\n  private\n  def set_current_user(args)\n    last_arg = args.last\n    return unless last_arg.is_a?(Hash) &amp;&amp; last_arg.key?('current_user')\n    RequestStore.store[:current_user] = last_arg['current_user']\n  end\nend\n</code></pre>\n\n<p>I am using <code>RequestStore</code> to set Thread.current in thread safe way.</p>\n\n<p>However right now I've to pass <code>current_user</code> in the perform_async call. I was searching for a way for sidekiq to do this out of the box but couldn't find any.</p>\n\n<p>One way to achieve this is to create custom module for Sidekiq::Worker</p>\n\n<pre><code>module CustomSidekiqWorker\n  include Sidekiq::Worker\n  before_action set_current_user, only: :perform_async\n\n  def set_current_user\n    RequestStore.store[:current_user] = current_user.login\n  end\nend\n</code></pre>\n\n<p>And then instead of including <code>Sidekiq::Worker</code>, include <code>CustomSidekiqWorker</code>. Is there a more neat way to do this ? Maybe some ruby meta programming I am missing. Thanks for the help.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-5"], "comments": [{"owner": {"reputation": 2487, "user_id": 8098012, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0cbdb5ca9b079de1c9700271166feead?s=128&d=identicon&r=PG", "display_name": "Pavel Mikhailyuk", "link": "https://stackoverflow.com/users/8098012/pavel-mikhailyuk"}, "edited": false, "score": 0, "creation_date": 1521633438, "post_id": 49405422, "comment_id": 85812312, "body": "There are many ways to do this. What is your RDBMS ?"}, {"owner": {"reputation": 1035, "user_id": 1562489, "user_type": "registered", "accept_rate": 51, "profile_image": "https://i.stack.imgur.com/ApdKz.jpg?s=128&g=1", "display_name": "David Sigley", "link": "https://stackoverflow.com/users/1562489/david-sigley"}, "reply_to_user": {"reputation": 2487, "user_id": 8098012, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0cbdb5ca9b079de1c9700271166feead?s=128&d=identicon&r=PG", "display_name": "Pavel Mikhailyuk", "link": "https://stackoverflow.com/users/8098012/pavel-mikhailyuk"}, "edited": false, "score": 0, "creation_date": 1521633736, "post_id": 49405422, "comment_id": 85812527, "body": "Hey @PavelMikhailyuk. I&#39;m using Postgres"}], "answers": [{"comments": [{"owner": {"reputation": 1035, "user_id": 1562489, "user_type": "registered", "accept_rate": 51, "profile_image": "https://i.stack.imgur.com/ApdKz.jpg?s=128&g=1", "display_name": "David Sigley", "link": "https://stackoverflow.com/users/1562489/david-sigley"}, "edited": false, "score": 0, "creation_date": 1521638257, "post_id": 49405931, "comment_id": 85815805, "body": "Excellent! Thanks for your help"}], "tags": [], "owner": {"reputation": 2487, "user_id": 8098012, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0cbdb5ca9b079de1c9700271166feead?s=128&d=identicon&r=PG", "display_name": "Pavel Mikhailyuk", "link": "https://stackoverflow.com/users/8098012/pavel-mikhailyuk"}, "is_accepted": true, "score": 1, "last_activity_date": 1521633961, "creation_date": 1521633961, "answer_id": 49405931, "question_id": 49405422, "link": "https://stackoverflow.com/questions/49405422/using-the-group-function-to-return-an-array-of-ids-as-a-value-and-the-groupf/49405931#49405931", "title": "Using the group function to return an array of ID&#39;s as a value and the .group(:field) as the key", "body": "<p>Based on <a href=\"https://stackoverflow.com/questions/31453151/in-postgres-select-return-a-column-subquery-as-an-array\">this answer</a>, you can use <code>pluck</code> with <code>array_agg</code> and then <code>#to_h</code>:</p>\n\n<pre><code>Subscription.group(:tag_id).pluck(:tag_id, 'array_agg(id)').to_h\n</code></pre>\n"}], "owner": {"reputation": 1035, "user_id": 1562489, "user_type": "registered", "accept_rate": 51, "profile_image": "https://i.stack.imgur.com/ApdKz.jpg?s=128&g=1", "display_name": "David Sigley", "link": "https://stackoverflow.com/users/1562489/david-sigley"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 242, "favorite_count": 0, "accepted_answer_id": 49405931, "answer_count": 1, "score": 0, "last_activity_date": 1521633961, "creation_date": 1521632461, "question_id": 49405422, "link": "https://stackoverflow.com/questions/49405422/using-the-group-function-to-return-an-array-of-ids-as-a-value-and-the-groupf", "title": "Using the group function to return an array of ID&#39;s as a value and the .group(:field) as the key", "body": "<p>I'm trying to group a large table by a foreign key in order to make some changes to those records. </p>\n\n<p>What I would like to do is <code>group(:foreign_key_id)</code> and return the <code>ids</code> in this group. So I would get:\n<code>{foreign_key_id =&gt; [array of ID's with this key], {foreign_key_id =&gt; [array of ID's with this key] }</code></p>\n\n<p>Maybe I should be mapping the (&amp;:id) value, but this function sits behind a <code>where</code> so it's not <em>all</em> records of this foreign key that are returned. </p>\n\n<p>My working code would be something like this:</p>\n\n<p><code>SubscriptionTag.where(subscription_id: @paper.subscriptions.map(&amp;:id).group(:tag_id)</code></p>\n\n<p>This returns all unique tags used by my subset of subscriptions. Now I would like to also return the SubscriptionTag ids  along with each tag_id</p>\n\n<p>I hope this makes sense. </p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "answers": [{"comments": [{"owner": {"reputation": 59, "user_id": 9236065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/19dbeee73ae13dd69f4cbb436a6fa0e7?s=128&d=identicon&r=PG&f=1", "display_name": "gallant", "link": "https://stackoverflow.com/users/9236065/gallant"}, "edited": false, "score": 1, "creation_date": 1521633162, "post_id": 49405591, "comment_id": 85812126, "body": "Thanks JayJay, yeah I realized I am struggling with some fundamental stuff here, so will close this question and go back to the basics of MVC communication. The params hash is a very good tip as I do remember using this before. Thanks!"}], "tags": [], "owner": {"reputation": 670, "user_id": 5119800, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/56905a0cf92d1acb655373d393569923?s=128&d=identicon&r=PG&f=1", "display_name": "JayJay", "link": "https://stackoverflow.com/users/5119800/jayjay"}, "is_accepted": true, "score": 0, "last_activity_date": 1521632990, "creation_date": 1521632990, "answer_id": 49405591, "question_id": 49405116, "link": "https://stackoverflow.com/questions/49405116/how-can-i-access-a-user-entered-string-from-a-rails-form-inside-of-a-ruby-mode/49405591#49405591", "title": "How can I access a user entered string (from a Rails form) inside of a Ruby model?", "body": "<p>So in a nutshell, you want to know how to grab the form param values once the user \"submits\" it to the Rails server? </p>\n\n<p>You can access data sent to a rails controller via the <strong>params</strong> hash, which is a key value pairing. </p>\n\n<pre><code>def find_artist\n    # {\"user_url\":\"www.soudcloud.com/pantera\"}\n    artist_url = params[:user_url]\n    # do something with it from here on\nend\n</code></pre>\n\n<p>The thing to note here is that your form should be routing to some sort of method in the controller which won't be your index method. \nI would suggest giving this a go if you're struggling with the Rails framework: <a href=\"https://www.railstutorial.org/book\" rel=\"nofollow noreferrer\">https://www.railstutorial.org/book</a></p>\n"}], "owner": {"reputation": 59, "user_id": 9236065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/19dbeee73ae13dd69f4cbb436a6fa0e7?s=128&d=identicon&r=PG&f=1", "display_name": "gallant", "link": "https://stackoverflow.com/users/9236065/gallant"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 24, "favorite_count": 0, "accepted_answer_id": 49405591, "answer_count": 1, "score": 0, "last_activity_date": 1521632990, "creation_date": 1521631587, "last_edit_date": 1521632400, "question_id": 49405116, "link": "https://stackoverflow.com/questions/49405116/how-can-i-access-a-user-entered-string-from-a-rails-form-inside-of-a-ruby-mode", "title": "How can I access a user entered string (from a Rails form) inside of a Ruby model?", "body": "<p>I am currently struggling with the rails implementation of an application I wrote in Ruby.</p>\n\n<p><strong>Background:</strong></p>\n\n<p>I am trying to use the Soundcloud API to request a artist's properties based on an artist URL entered by a user inside a rails form. The code that makes the request to the Soundcloud API is inside of two ruby models in my services folder (app/services/soundcloud_query.rb). What I require is the dynamic setting of a variable named <code>@user_url</code> equal to the soundcloud artist URL that the user is interested in.</p>\n\n<p>I have this all working on the command line where I can use the Ruby gets command to get the user input, however, I am struggling to understand how to implement this properly in the rails framework. My query logic is all fine, it is simply the handing of information from a user field to the model that I am struggling with.</p>\n\n<p><strong>Example of expected behaviour:</strong></p>\n\n<p>I have a rails form with one text field. The user is prompted to enter a Soundcloud artist URL inside (example: <a href=\"https://soundcloud.com/alembicmusic\" rel=\"nofollow noreferrer\">https://soundcloud.com/alembicmusic</a> ). I then want to take this string, set it equal to the <code>@user_url</code> property in my <code>soundcloud_query.rb</code> model, and then make the query based on a user entered URL. It is this middle part, where I run the code in my service model AFTER it gets a user input that I am struggling with. </p>\n\n<p>I greatly appreciate any help/tips/resources and thank you for your time in reading this.</p>\n\n<p><strong>Controller:</strong></p>\n\n<pre><code>class SimplePagesController &lt; ApplicationController\n\n  def index\n    @user = SoundcloudUser.new\n    @followers= @user.followers\n  end\nend\n</code></pre>\n"}, {"tags": ["arrays", "ruby"], "comments": [{"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1521630787, "post_id": 49404722, "comment_id": 85810467, "body": "<i>&quot;I have a big array&quot;</i> \u2013 okay, but <code>[1..10]</code> is an array with a <i>single</i> element: the range <code>1..10</code>. Maybe you wanted <code>x = [*1..10]</code>?"}, {"owner": {"reputation": 2322, "user_id": 3088748, "user_type": "registered", "accept_rate": 63, "profile_image": "https://graph.facebook.com/544821277/picture?type=large", "display_name": "AJFaraday", "link": "https://stackoverflow.com/users/3088748/ajfaraday"}, "reply_to_user": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1521630850, "post_id": 49404722, "comment_id": 85810516, "body": "@Stefan Makes a good point, you can change it to an array with <code>(1..10).to_a</code>"}, {"owner": {"reputation": 21, "user_id": 9380591, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d8085d4acec90060c2d19acb398e6e13?s=128&d=identicon&r=PG&f=1", "display_name": "cdDC", "link": "https://stackoverflow.com/users/9380591/cddc"}, "edited": false, "score": 0, "creation_date": 1521630989, "post_id": 49404722, "comment_id": 85810605, "body": "absolutely right, edited as such (ruby novice here :))."}, {"owner": {"reputation": 2322, "user_id": 3088748, "user_type": "registered", "accept_rate": 63, "profile_image": "https://graph.facebook.com/544821277/picture?type=large", "display_name": "AJFaraday", "link": "https://stackoverflow.com/users/3088748/ajfaraday"}, "edited": false, "score": 0, "creation_date": 1521631153, "post_id": 49404722, "comment_id": 85810728, "body": "@cdDC No probs, we&#39;ve all got to start somewhere."}], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 9380591, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d8085d4acec90060c2d19acb398e6e13?s=128&d=identicon&r=PG&f=1", "display_name": "cdDC", "link": "https://stackoverflow.com/users/9380591/cddc"}, "edited": false, "score": 0, "creation_date": 1521630867, "post_id": 49404819, "comment_id": 85810528, "body": "Thanks for the response. My subarrays are not of constant length- can I supply a vector of lengths as argument?"}, {"owner": {"reputation": 2322, "user_id": 3088748, "user_type": "registered", "accept_rate": 63, "profile_image": "https://graph.facebook.com/544821277/picture?type=large", "display_name": "AJFaraday", "link": "https://stackoverflow.com/users/3088748/ajfaraday"}, "reply_to_user": {"reputation": 21, "user_id": 9380591, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d8085d4acec90060c2d19acb398e6e13?s=128&d=identicon&r=PG&f=1", "display_name": "cdDC", "link": "https://stackoverflow.com/users/9380591/cddc"}, "edited": false, "score": 0, "creation_date": 1521631125, "post_id": 49404819, "comment_id": 85810711, "body": "@cdDC Sorry, I misread your question at first. Here&#39;s a solution."}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1521631323, "post_id": 49404819, "comment_id": 85810845, "body": "Note that <code>shift</code> will also modify the receiver, thus leaving an empty <code>x</code>. You might want to <code>dup</code> it beforehand."}, {"owner": {"reputation": 21, "user_id": 9380591, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d8085d4acec90060c2d19acb398e6e13?s=128&d=identicon&r=PG&f=1", "display_name": "cdDC", "link": "https://stackoverflow.com/users/9380591/cddc"}, "edited": false, "score": 0, "creation_date": 1521631401, "post_id": 49404819, "comment_id": 85810905, "body": "Mmm that is a smooth solution. I did not know that shift could take an argument. Thank you very much!"}, {"owner": {"reputation": 2322, "user_id": 3088748, "user_type": "registered", "accept_rate": 63, "profile_image": "https://graph.facebook.com/544821277/picture?type=large", "display_name": "AJFaraday", "link": "https://stackoverflow.com/users/3088748/ajfaraday"}, "reply_to_user": {"reputation": 21, "user_id": 9380591, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d8085d4acec90060c2d19acb398e6e13?s=128&d=identicon&r=PG&f=1", "display_name": "cdDC", "link": "https://stackoverflow.com/users/9380591/cddc"}, "edited": false, "score": 0, "creation_date": 1521631584, "post_id": 49404819, "comment_id": 85811050, "body": "@cdDC No probs, these things come in handy quite a lot. It&#39;s worth reading the ruby docs for Enumerable, and Array to expand your ruby toolkit. Just skimming through API docs until you see something interesting is a surprisingly rewarding task."}, {"owner": {"reputation": 1856, "user_id": 848915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/uTSIa.png?s=128&g=1", "display_name": "Daryll Santos", "link": "https://stackoverflow.com/users/848915/daryll-santos"}, "edited": false, "score": 0, "creation_date": 1521632174, "post_id": 49404819, "comment_id": 85811455, "body": "Nice. @AJFaraday, are there possible unintended effects of the mutation with <code>shift</code>? If the array will be used again, it won&#39;t be the same thing, but what if it wasn&#39;t used again?"}, {"owner": {"reputation": 2322, "user_id": 3088748, "user_type": "registered", "accept_rate": 63, "profile_image": "https://graph.facebook.com/544821277/picture?type=large", "display_name": "AJFaraday", "link": "https://stackoverflow.com/users/3088748/ajfaraday"}, "reply_to_user": {"reputation": 1856, "user_id": 848915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/uTSIa.png?s=128&g=1", "display_name": "Daryll Santos", "link": "https://stackoverflow.com/users/848915/daryll-santos"}, "edited": false, "score": 0, "creation_date": 1521632262, "post_id": 49404819, "comment_id": 85811520, "body": "@DaryllSantos Yes, that is a possibility. If you want to reuse the array, you&#39;d first set a new variable with <code>dup</code>, so you modify one copy, and have one un-mutated copy."}], "tags": [], "owner": {"reputation": 2322, "user_id": 3088748, "user_type": "registered", "accept_rate": 63, "profile_image": "https://graph.facebook.com/544821277/picture?type=large", "display_name": "AJFaraday", "link": "https://stackoverflow.com/users/3088748/ajfaraday"}, "is_accepted": false, "score": 7, "last_activity_date": 1521632924, "last_edit_date": 1521632924, "creation_date": 1521630777, "answer_id": 49404819, "question_id": 49404722, "link": "https://stackoverflow.com/questions/49404722/ruby-split-array-into-subarrays-of-non-constant-length/49404819#49404819", "title": "Ruby- split array into subarrays of non-constant length", "body": "<p>You could try <code>shift</code> which gives you the first element in an array, removing it from the start.</p>\n\n<pre><code>a = [1,2,3,4]\na.shift\n# 1\na\n# [2,3,4]\n</code></pre>\n\n<p>It also takes an argument for the amount to shift off the array.</p>\n\n<pre><code>a = [1,2,3,4]\na.shift(2)\n# [1,2]\na\n# [3,4]\n</code></pre>\n\n<p>So for your arrays...</p>\n\n<pre><code>x = [1,2,3,4,5,6,7,8,9,10]\ny = [1,4,2,3]\n\nz = y.map do |length|\n  x.shift(length)\nend \n\nz\n# [[1], [2, 3, 4, 5], [6, 7], [8, 9, 10]] \n</code></pre>\n\n<ul>\n<li><code>shift</code> with an argument will return an array of that many elements taken off the start of the array. The opposite of this is <code>pop</code>, which works in the same way, but takes elements from the end of the array.</li>\n<li><code>map</code> will iterate through the array, like <code>each</code>, but put the result of each iteration into a new array.</li>\n<li>So iterating through your array of lengths, we'll grab the first few from the array.</li>\n</ul>\n\n<hr>\n\n<p><strong>Addendum:</strong> Some commenters have expressed concern that this method mutates the initial variable. (after this  process, x will be an emtpy array, because it's all been shifted out).</p>\n\n<p>If you needed to use <code>x</code> again after splitting it up, you could use <code>dup</code> to keep an intact copy.</p>\n\n<pre><code>x2 = x.dup\nx2\n# [1,2,3,4,5,6,7,8,9,10]\n\nz = y.map do |length|\n  x2.shift(length)\nend \n\nx\n# [1,2,3,4,5,6,7,8,9,10]\nx2\n# []\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1521631749, "post_id": 49405081, "comment_id": 85811171, "body": "Or <code>y.map { |i| x.slice!(0, i) }</code> which is essentially <code>y.map { |i| x.shift(i) }</code>"}], "tags": [], "owner": {"reputation": 16237, "user_id": 2166798, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/417356917295f5176d2a3e7c21d8f9e8?s=128&d=identicon&r=PG", "display_name": "pjs", "link": "https://stackoverflow.com/users/2166798/pjs"}, "is_accepted": false, "score": 2, "last_activity_date": 1521631924, "last_edit_date": 1521631924, "creation_date": 1521631494, "answer_id": 49405081, "question_id": 49404722, "link": "https://stackoverflow.com/questions/49404722/ruby-split-array-into-subarrays-of-non-constant-length/49405081#49405081", "title": "Ruby- split array into subarrays of non-constant length", "body": "<p>You can use the <code>slice!</code> method along with an array initializer block:</p>\n\n<pre><code>x = (1..10).to_a    # [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]\ny = [1, 4, 2, 3]\nc = Array.new(y.length) {|i| x.slice!(0...y[i])}    # [[1], [2, 3, 4, 5], [6, 7], [8, 9, 10]]\n</code></pre>\n\n<p>or with <code>map</code>, as pointed out by @Stefan:</p>\n\n<pre><code>c = y.map { |i| x.slice!(0, i) }\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 9030, "user_id": 5101476, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JCQrl.jpg?s=128&g=1", "display_name": "ice\u30c4", "link": "https://stackoverflow.com/users/5101476/ice%e3%83%84"}, "is_accepted": false, "score": -1, "last_activity_date": 1521645880, "last_edit_date": 1521645880, "creation_date": 1521643171, "answer_id": 49409245, "question_id": 49404722, "link": "https://stackoverflow.com/questions/49404722/ruby-split-array-into-subarrays-of-non-constant-length/49409245#49409245", "title": "Ruby- split array into subarrays of non-constant length", "body": "<p>Using explicit enumerators.</p>\n\n<pre><code>enumx = x.each\nenumy = y.each\n\nArray.new(y.size) { enumy.next.times.with_object([]) { |_, o| o &lt;&lt; enumx.next } }\n #=&gt; [[1], [2, 3, 4, 5], [6, 7], [8, 9, 10]]\n</code></pre>\n\n<p>To improve readability we could wrap it up in a method.</p>\n\n<pre><code>def taker n, enum\n  n.times.with_object([]) { |_, o| o &lt;&lt; enum.next }\nend\n\nenumx = x.each\nenumy = y.each\n\nArray.new(y.size) { taker enumy.next, enumx }\n #=&gt; [[1], [2, 3, 4, 5], [6, 7], [8, 9, 10]]\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 9380591, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d8085d4acec90060c2d19acb398e6e13?s=128&d=identicon&r=PG&f=1", "display_name": "cdDC", "link": "https://stackoverflow.com/users/9380591/cddc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 80, "favorite_count": 1, "answer_count": 3, "score": 1, "last_activity_date": 1521645880, "creation_date": 1521630503, "last_edit_date": 1521630962, "question_id": 49404722, "link": "https://stackoverflow.com/questions/49404722/ruby-split-array-into-subarrays-of-non-constant-length", "title": "Ruby- split array into subarrays of non-constant length", "body": "<p>here is my issue:</p>\n\n<p>I have a big array that I want to split into an array of arrays. These subarrays must be of lengths given by a second array. </p>\n\n<p>Example</p>\n\n<pre><code>x=[*1..10]\n\ny=[1,4,2,3]\n</code></pre>\n\n<p>I am seeking <code>output=[[1],[2,3,4,5],[6,7],[8,9,10]]</code></p>\n\n<p>Is there a rubyistic trick to do this?</p>\n\n<p>Thanks for your assistance :)</p>\n"}, {"tags": ["ruby"], "answers": [{"comments": [{"owner": {"reputation": 69864, "user_id": 421018, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/e8lcr.jpg?s=128&g=1", "display_name": "Fogmeister", "link": "https://stackoverflow.com/users/421018/fogmeister"}, "edited": false, "score": 0, "creation_date": 1521630329, "post_id": 49404633, "comment_id": 85810150, "body": "Will <code>content[0]</code> error if the <code>content</code> array contains no values?"}, {"owner": {"reputation": 69864, "user_id": 421018, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/e8lcr.jpg?s=128&g=1", "display_name": "Fogmeister", "link": "https://stackoverflow.com/users/421018/fogmeister"}, "edited": false, "score": 0, "creation_date": 1521630401, "post_id": 49404633, "comment_id": 85810200, "body": "That works! Thanks I didn&#39;t know about <code>values_at</code> :)"}, {"owner": {"reputation": 27144, "user_id": 3857758, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/58c4295826435f049b7fc32b98c240f9?s=128&d=identicon&r=PG&f=1", "display_name": "Ursus", "link": "https://stackoverflow.com/users/3857758/ursus"}, "reply_to_user": {"reputation": 69864, "user_id": 421018, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/e8lcr.jpg?s=128&g=1", "display_name": "Fogmeister", "link": "https://stackoverflow.com/users/421018/fogmeister"}, "edited": false, "score": 0, "creation_date": 1521630412, "post_id": 49404633, "comment_id": 85810211, "body": "My pleasure Sir :)"}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 1, "creation_date": 1521632110, "post_id": 49404633, "comment_id": 85811414, "body": "The guard clause can probably be shortened to <code>return unless title &amp;&amp; url</code>"}, {"owner": {"reputation": 27144, "user_id": 3857758, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/58c4295826435f049b7fc32b98c240f9?s=128&d=identicon&r=PG&f=1", "display_name": "Ursus", "link": "https://stackoverflow.com/users/3857758/ursus"}, "edited": false, "score": 0, "creation_date": 1521632625, "post_id": 49404633, "comment_id": 85811755, "body": "Yeah, you&#39;re right. But I tend to avoid unless when I have a compound condition"}], "tags": [], "owner": {"reputation": 27144, "user_id": 3857758, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/58c4295826435f049b7fc32b98c240f9?s=128&d=identicon&r=PG&f=1", "display_name": "Ursus", "link": "https://stackoverflow.com/users/3857758/ursus"}, "is_accepted": true, "score": 3, "last_activity_date": 1521630283, "creation_date": 1521630283, "answer_id": 49404633, "question_id": 49404556, "link": "https://stackoverflow.com/questions/49404556/ruby-assign-and-check-if-nil-in-one-line/49404633#49404633", "title": "Ruby: assign and check if nil in one line", "body": "<p>Anything like this?</p>\n\n<pre><code>def create_button(content)\n  title, url = content[0]&amp;.values_at('text', 'url')\n  return nil if title.nil? || url.nil?\n\n  Button.new(title, url)\nend\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2322, "user_id": 3088748, "user_type": "registered", "accept_rate": 63, "profile_image": "https://graph.facebook.com/544821277/picture?type=large", "display_name": "AJFaraday", "link": "https://stackoverflow.com/users/3088748/ajfaraday"}, "is_accepted": false, "score": 1, "last_activity_date": 1521630421, "creation_date": 1521630421, "answer_id": 49404690, "question_id": 49404556, "link": "https://stackoverflow.com/questions/49404556/ruby-assign-and-check-if-nil-in-one-line/49404690#49404690", "title": "Ruby: assign and check if nil in one line", "body": "<p>You can multiple assign values like this:</p>\n\n<pre><code>a, b = 'a', 'b'\n</code></pre>\n\n<p>When you have one result, like <code>return nil</code>, you could have two conditions in your if.</p>\n\n<pre><code>return nil if a.nil? or b.nil?\n</code></pre>\n\n<p>Or use <code>any?</code></p>\n\n<pre><code>return nil if [a, b].any?(&amp;:nil?)\n</code></pre>\n\n<p>So, the &amp; symbol here is a shortcut to create a lambda, or reusable code block. It will try to run the method <code>nil?</code> on each item in the array. You can use this for other enumerable methods such as <code>each</code>, <code>select</code>, <code>reject</code> or <code>detect</code>.</p>\n\n<p>Here's a nice short form of your method, doing all the same things:</p>\n\n<pre><code>def create_button(content)\n  title, url = content.dig(0, 'text'), content.dig(0, 'url')\n  return nil if [title,url].any(&amp;:nil?)\n  return Button.new(title, url)\nend\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 69864, "user_id": 421018, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/e8lcr.jpg?s=128&g=1", "display_name": "Fogmeister", "link": "https://stackoverflow.com/users/421018/fogmeister"}, "edited": false, "score": 0, "creation_date": 1521630601, "post_id": 49404710, "comment_id": 85810327, "body": "Thanks, I updated my question to put these together as I realised I had not done this."}, {"owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 0, "creation_date": 1521630646, "post_id": 49404710, "comment_id": 85810355, "body": "Perhaps it is just me, but how does your code differ from the one in the question?"}, {"owner": {"reputation": 69864, "user_id": 421018, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/e8lcr.jpg?s=128&g=1", "display_name": "Fogmeister", "link": "https://stackoverflow.com/users/421018/fogmeister"}, "reply_to_user": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 0, "creation_date": 1521630700, "post_id": 49404710, "comment_id": 85810406, "body": "@spickermann I think they must have been responding to my code before my edit."}], "tags": [], "owner": {"reputation": 236, "user_id": 7150057, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/Fi7DJ.jpg?s=128&g=1", "display_name": "Muhammad Asad", "link": "https://stackoverflow.com/users/7150057/muhammad-asad"}, "is_accepted": false, "score": 0, "last_activity_date": 1521630475, "creation_date": 1521630475, "answer_id": 49404710, "question_id": 49404556, "link": "https://stackoverflow.com/questions/49404556/ruby-assign-and-check-if-nil-in-one-line/49404710#49404710", "title": "Ruby: assign and check if nil in one line", "body": "<p>What you could do is </p>\n\n<pre><code>def create_button(content)\n  title = content.dig(0, 'text')\n  url = content.dig(0, 'url')\n\n  return nil if title.nil? || url.nil?\n\n  return Button.new(\n    title,\n    url\n  )\nend\n</code></pre>\n\n<p>because either the title or url is nil you are returning nil.</p>\n"}], "owner": {"reputation": 69864, "user_id": 421018, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/e8lcr.jpg?s=128&g=1", "display_name": "Fogmeister", "link": "https://stackoverflow.com/users/421018/fogmeister"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 471, "favorite_count": 0, "accepted_answer_id": 49404633, "answer_count": 3, "score": 2, "last_activity_date": 1521630475, "creation_date": 1521630017, "question_id": 49404556, "link": "https://stackoverflow.com/questions/49404556/ruby-assign-and-check-if-nil-in-one-line", "title": "Ruby: assign and check if nil in one line", "body": "<p>I have a function defined like...</p>\n\n<pre><code>def create_button(content)\n  title = content.dig(0, 'text')\n  url = content.dig(0, 'url')\n\n  return nil if title.nil? || url.nil?\n\n  return Button.new(\n    title,\n    url\n  )\nend\n</code></pre>\n\n<p>Or something...</p>\n\n<p>Anyway, I was wondering if it would be possible to smoosh those first few lines together and do the assignment, nil check and return in one line?</p>\n"}, {"tags": ["ruby", "integer", "hex"], "answers": [{"tags": [], "owner": {"reputation": 4127, "user_id": 4231385, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d89a541a4609cafea3957e4cdfcca50f?s=128&d=identicon&r=PG&f=1", "display_name": "cremno", "link": "https://stackoverflow.com/users/4231385/cremno"}, "is_accepted": true, "score": 4, "last_activity_date": 1521634991, "creation_date": 1521634991, "answer_id": 49406276, "question_id": 49404408, "link": "https://stackoverflow.com/questions/49404408/convert-integer-in-hex-string-notation-into-a-signed-8-bit-integer/49406276#49406276", "title": "Convert Integer in Hex String Notation into a signed 8-Bit Integer", "body": "<p>The <code>c</code> directive comes very close but it expects a different input: a single character representing the signed 8-bit integer. This requires the input <code>\"0xff\"</code> to be <code>\"\\xff\"</code>. So this conversion must take place first. At least one method known by you can be used here; the other one is <a href=\"https://ruby-doc.org/core/Integer.html#method-i-chr\" rel=\"nofollow noreferrer\"><code>Integer#chr</code></a>:</p>\n\n<pre><code>\"0xff\".hex.chr # =&gt; \"\\xFF\"\n</code></pre>\n\n<p>And the complete solution:</p>\n\n<pre><code>\"0xff\".hex.chr.unpack1(?c) # =&gt; -1\n</code></pre>\n"}], "owner": {"reputation": 157, "user_id": 1025400, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/26f5a9d4d70f670917f6370421d38258?s=128&d=identicon&r=PG", "display_name": "fex", "link": "https://stackoverflow.com/users/1025400/fex"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 157, "favorite_count": 0, "accepted_answer_id": 49406276, "answer_count": 1, "score": 0, "last_activity_date": 1521634991, "creation_date": 1521629590, "question_id": 49404408, "link": "https://stackoverflow.com/questions/49404408/convert-integer-in-hex-string-notation-into-a-signed-8-bit-integer", "title": "Convert Integer in Hex String Notation into a signed 8-Bit Integer", "body": "<p>I'd like to convert a hex string into an 8-bit <strong>signed</strong> integer, as shown in the following example:</p>\n\n<pre><code>irb&gt; \"0xff\".unpack(X)\n=&gt; [-1]\n</code></pre>\n\n<p>The correct value for <strong>X</strong> is missing.</p>\n\n<p>By reding <a href=\"https://ruby-doc.org/core-2.3.0/String.html#method-i-unpack\" rel=\"nofollow noreferrer\">https://ruby-doc.org/core-2.3.0/String.html#method-i-unpack</a> and experimenting I do not find the correct value for <strong>X</strong>.</p>\n\n<hr>\n\n<p>I could code that myself, like also posted here: <a href=\"https://www.ruby-forum.com/topic/138200#615299\" rel=\"nofollow noreferrer\">https://www.ruby-forum.com/topic/138200#615299</a> but I am convinced, there is a more elegant concise ruby way.</p>\n\n<pre><code>irb&gt; length = 8\nirb&gt; mid = 2**(length-1)\nirb&gt; max_unsigned = 2**length\nirb&gt; to_signed = proc {|n| (n&gt;=mid) ? n - max_unsigned : n}\nirb&gt; to_signed[\"0xFF\".to_i(16)]\n=&gt; -1\n</code></pre>\n\n<hr>\n\n<p>Note: For the <strong><em>un</strong>singed</em> case, this is easy:</p>\n\n<pre><code>irb&gt; \"e0\".hex\n=&gt; 224\n</code></pre>\n"}, {"tags": ["ruby", "elasticsearch", "logstash", "elastic-stack"], "answers": [{"tags": [], "owner": {"reputation": 3352, "user_id": 5152338, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5QbPE.png?s=128&g=1", "display_name": "jdno", "link": "https://stackoverflow.com/users/5152338/jdno"}, "is_accepted": true, "score": 2, "last_activity_date": 1521630408, "creation_date": 1521630408, "answer_id": 49404686, "question_id": 49404015, "link": "https://stackoverflow.com/questions/49404015/how-to-add-a-ruby-code-inside-of-the-logstash-config-file/49404686#49404686", "title": "How to add a ruby code inside of the logstash config file?", "body": "<p>As you can tell from the syntax highlighting in your question, there is an issue with the double quotes you are using. Pay close attention to the black letters in the code block:</p>\n\n<pre><code>\"\nrequire 'win32/eventlog'\nlogger = Win32::EventLog.new\nlogger.report_event(:event_type =&gt; Win32::EventLog::INFO, :data =&gt; \"a test event log entry\")\n\"\n</code></pre>\n\n<p>You are wrapping the code block in double quotes, but are also using them to define the string in the event: <code>\"a test event log entry\"</code>. The first quote for the string ends the code block, and LogStash reports a syntax error, because it expected you to close the instruction with a <code>}</code>.</p>\n\n<p>You can also see this in the error message, where it reports the value as the <code>data</code> attribute as a single double quote: <code>:data =&gt; \\\"</code>.</p>\n\n<p>Try wrapping the string in single quotes: <code>'a test event log entry'</code> to fix this issue.</p>\n"}], "owner": {"reputation": 14832, "user_id": 52420, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/01c4a0ffa55d18961ecc75d0bf3eb182?s=128&d=identicon&r=PG", "display_name": "Penguen", "link": "https://stackoverflow.com/users/52420/penguen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2123, "favorite_count": 0, "accepted_answer_id": 49404686, "answer_count": 1, "score": 0, "last_activity_date": 1521630408, "creation_date": 1521628550, "last_edit_date": 1521629425, "question_id": 49404015, "link": "https://stackoverflow.com/questions/49404015/how-to-add-a-ruby-code-inside-of-the-logstash-config-file", "title": "How to add a ruby code inside of the logstash config file?", "body": "<p>I try to send logs to windows event by using logstash. After added some ruby code;it is created below error.How can I send logs to windoes event?</p>\n\n<pre><code>\ninput {\n  file {\n    type => \"json\"\n    path => [\"C:/Temp/logs/*.json\"]\n    start_position => \"beginning\"\n    codec => \"json\"\n    discover_interval => 120\n    stat_interval => 60\n    sincedb_write_interval => 60\n    close_older => 60\n  }\n}\nfilter {\nmutate {\n    remove_field => [ \"path\" ] \n\n}\n   ruby {\n      code => \"\n           require 'win32/eventlog'\nlogger = Win32::EventLog.new\nlogger.report_event(:event_type => Win32::EventLog::INFO, :data => \"a test event log entry\")\n        \"\n        }\n   }\n}\noutput {\n    stdout {\n        codec => rubydebug\n    }\n\n\n\n    elasticsearch {\n       hosts => [\"http://loguser:xxxx@192.158.5.84:333\"]\n       index => \"logstash-%{+YYYY.MM}\"\n    }\n}\n</code></pre>\n\n<p>Error:</p>\n\n<pre><code>\n[2018-03-20T09:51:28,629][ERROR][logstash.agent           ] Cannot create pipeline {:reason=>\"Expected one of #, {, } at line 23, column 75 (byte 464) after filter {\\nmutate {\\n    remove_field => [ \\\"path\\\" ] \\n\\n}\\n   ruby {\\n     init => \\\" require 'win32/eventlog' \\n\\t \\\"\\n     code => \\\"\\n      logger = Win32::EventLog.new\\n      logger.report_event(:event_type => Win32::EventLog::INFO, :data => \\\"\"}\n\n</code></pre>\n"}, {"tags": ["ruby", "memory", "struct", "hash"], "comments": [{"owner": {"reputation": 5312, "user_id": 6535997, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/10156345016155058/picture?type=large", "display_name": "Mark", "link": "https://stackoverflow.com/users/6535997/mark"}, "edited": false, "score": 0, "creation_date": 1521627554, "post_id": 49403477, "comment_id": 85808248, "body": "There are some benchmarks that compare the two: <a href=\"https://gist.github.com/tristang/a961fdc327e7d79439729a6c381227dc\" rel=\"nofollow noreferrer\">gist.github.com/tristang/a961fdc327e7d79439729a6c381227dc</a>"}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1521627578, "post_id": 49403477, "comment_id": 85808263, "body": "Memory efficiency is an implementation detail. Ruby (at the language level) doesn&#39;t specify it."}, {"owner": {"reputation": 2689, "user_id": 1134991, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/e102cb584a0fba3cd07b0a4d79350ba2?s=128&d=identicon&r=PG", "display_name": "user1134991", "link": "https://stackoverflow.com/users/1134991/user1134991"}, "edited": false, "score": 0, "creation_date": 1521628638, "post_id": 49403477, "comment_id": 85809017, "body": "Yeah, that&#39;s a speed benchmark, not footprint. If one needs to swap, the slow can become different."}, {"owner": {"reputation": 16672, "user_id": 22237, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/hkobD.png?s=128&g=1", "display_name": "Kris", "link": "https://stackoverflow.com/users/22237/kris"}, "edited": false, "score": 0, "creation_date": 1521631557, "post_id": 49403477, "comment_id": 85811017, "body": "You might also want to check JRuby versus CRuby."}], "answers": [{"tags": [], "owner": {"reputation": 1856, "user_id": 848915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/uTSIa.png?s=128&g=1", "display_name": "Daryll Santos", "link": "https://stackoverflow.com/users/848915/daryll-santos"}, "is_accepted": false, "score": 0, "last_activity_date": 1521633113, "creation_date": 1521633113, "answer_id": 49405638, "question_id": 49403477, "link": "https://stackoverflow.com/questions/49403477/enjoying-the-memory-footprint-of-struct-like-in-ruby/49405638#49405638", "title": "Enjoying the memory footprint of struct-like in ruby", "body": "<p>Some benchmarks here:</p>\n\n<p><a href=\"https://gist.github.com/rmosolgo/3a2876dbbb721749176644da7325827e\" rel=\"nofollow noreferrer\">https://gist.github.com/rmosolgo/3a2876dbbb721749176644da7325827e</a>.</p>\n\n<p>For Ruby 2.4,</p>\n\n<pre><code>Comparison:\n               Class:  9394405.5 i/s\n             Hash#[]:  8318559.1 i/s - same-ish: difference falls within error\n              Struct:  8074174.5 i/s - same-ish: difference falls within error\n          Hash#fetch:  6148417.9 i/s - 1.53x  slower\n          OpenStruct:  3918462.1 i/s - 2.40x  slower\n</code></pre>\n\n<p>Looks like Structs (and actual hashes, accessed by the <code>[]</code> method, are almost as performant as actual (small) classes. I think what you're looking for here are benchmarking tools, just in case you need to really figure out things (not just for this example). I suggest checking out <a href=\"https://github.com/evanphx/benchmark-ips\" rel=\"nofollow noreferrer\">benchmark-ips</a> for speed, <a href=\"https://github.com/ruby-prof/ruby-prof\" rel=\"nofollow noreferrer\">ruby-prof</a> for profiling, <a href=\"https://github.com/SamSaffron/memory_profiler\" rel=\"nofollow noreferrer\">memory_profiler</a> for memory (I have only used benchmark-ips and ruby-prof).</p>\n\n<p>Alternatives to classes/hashes/etc.. include these gems: <a href=\"https://github.com/tcrayford/Values\" rel=\"nofollow noreferrer\">values</a> and <a href=\"https://github.com/dry-rb/dry-struct\" rel=\"nofollow noreferrer\">dry-struct</a>. I've only used dry-struct, it provide a small typing system that makes me honest re: passing in values.</p>\n\n<p>Good luck.</p>\n"}], "owner": {"reputation": 2689, "user_id": 1134991, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/e102cb584a0fba3cd07b0a4d79350ba2?s=128&d=identicon&r=PG", "display_name": "user1134991", "link": "https://stackoverflow.com/users/1134991/user1134991"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 222, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1521633113, "creation_date": 1521627047, "question_id": 49403477, "link": "https://stackoverflow.com/questions/49403477/enjoying-the-memory-footprint-of-struct-like-in-ruby", "title": "Enjoying the memory footprint of struct-like in ruby", "body": "<p>I have a case where I am having a lot of small records. I.e., many of them, but each record usually has less than 10 fields.<br>I want to use named placeholders, just like C-strcut. As there will be a LOT of them (tens of millions, maybe more), hence, I will require a memory efficient implementation.<br>Ruby has Struct and Hash. I know that Hash may allocate more memory than is needed. Is Strcut, by design, more memory efficient? I.e., I could run some empirical tests, but I want to know that this is the intent, and that it is probably checked, for future versions.<br>These building blocks exist in Perl and Python, and that would influence my decision.</p>\n"}, {"tags": ["ruby", "linux", "openssl", "chef-infra"], "answers": [{"comments": [{"owner": {"reputation": 592, "user_id": 3245316, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/47f80b5070debe4c8d678ddadaf979bb?s=128&d=identicon&r=PG&f=1", "display_name": "MuhammadNe", "link": "https://stackoverflow.com/users/3245316/muhammadne"}, "edited": false, "score": 0, "creation_date": 1521972514, "post_id": 49419316, "comment_id": 85951677, "body": "I have some servers with the exact same versions and they work, same image from digital ocean. How do I check if the package is suitable for CPU?"}], "tags": [], "owner": {"reputation": 43208, "user_id": 78722, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cf611565f0b79abd0b3dc200ad867661?s=128&d=identicon&r=PG", "display_name": "coderanger", "link": "https://stackoverflow.com/users/78722/coderanger"}, "is_accepted": false, "score": 0, "last_activity_date": 1521684420, "last_edit_date": 1521684420, "creation_date": 1521683676, "answer_id": 49419316, "question_id": 49400774, "link": "https://stackoverflow.com/questions/49400774/error-bootstrapping-illegal-instruction/49419316#49419316", "title": "Error Bootstrapping - Illegal instruction", "body": "<p>We do not offer installers for CentOS 5 anymore but for Chef 12 it's possible you got the one for either the wrong CPU arch or CentOS 6 or 7.</p>\n"}, {"comments": [{"owner": {"reputation": 592, "user_id": 3245316, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/47f80b5070debe4c8d678ddadaf979bb?s=128&d=identicon&r=PG&f=1", "display_name": "MuhammadNe", "link": "https://stackoverflow.com/users/3245316/muhammadne"}, "edited": false, "score": 0, "creation_date": 1521972616, "post_id": 49419457, "comment_id": 85951716, "body": "I have some servers with the exact same versions and they work, same image from digital ocean, some works and some don&#39;t, and the package is &quot;chef-12.21.31-1.el5.x86_64.rpm&quot;"}], "tags": [], "owner": {"reputation": 3556, "user_id": 506908, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84c874984f69ef596764255efcd79113?s=128&d=identicon&r=PG", "display_name": "lamont", "link": "https://stackoverflow.com/users/506908/lamont"}, "is_accepted": false, "score": 0, "last_activity_date": 1521685015, "creation_date": 1521685015, "answer_id": 49419457, "question_id": 49400774, "link": "https://stackoverflow.com/questions/49400774/error-bootstrapping-illegal-instruction/49419457#49419457", "title": "Error Bootstrapping - Illegal instruction", "body": "<p>I'd suggest upgrading your operating systems to 5.11 with whatever the latest patches are and rebooting.  It is possible that we've only built and tested on 5.11 and those packages are broken on 5.9.  And like coderanger suggests, validate that you're getting the correct chef package for your system and architecture.  It needs to be something like:</p>\n\n<pre><code>chef-12.21.31-1.el5.x86_64.rpm\n</code></pre>\n\n<p>For 64-bit RHEL5.  For 32-bit RHEL5 it should be:</p>\n\n<pre><code>chef-12.21.31-1.el5.i386.rpm\n</code></pre>\n\n<p>If that doesn't work there's not a lot to be done.  Chef-12 is getting EOL'd, RHEL5 is getting EOL'd and Ruby 2.3 is getting EOL'd.</p>\n"}], "owner": {"reputation": 592, "user_id": 3245316, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/47f80b5070debe4c8d678ddadaf979bb?s=128&d=identicon&r=PG&f=1", "display_name": "MuhammadNe", "link": "https://stackoverflow.com/users/3245316/muhammadne"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 149, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1521685015, "creation_date": 1521618538, "question_id": 49400774, "link": "https://stackoverflow.com/questions/49400774/error-bootstrapping-illegal-instruction", "title": "Error Bootstrapping - Illegal instruction", "body": "<p>I am trying to bootstrap a server sing CHEF tool, the target machine is \"CentOS 5.8\"</p>\n\n<p>But I get this error. Note: It doesn't happen on all the servers.</p>\n\n<blockquote>\n  <p>Starting the first Chef Client run...\n      /opt/chef/embedded/lib/ruby/2.3.0/x86_64-linux/openssl.so: [BUG] Illegal instruction at 0x002b5ac1b082a5\n      ruby 2.3.1p112 (2016-04-26 revision 54768) [x86_64-linux]</p>\n</blockquote>\n\n<pre><code>-- Control frame information -----------------------------------------------\nc:0019 p:-41548458 s:0097 e:000096 TOP    [FINISH]\nc:0018 p:---- s:0095 e:000094 CFUNC  :require\nc:0017 p:0132 s:0091 e:000090 METHOD /opt/chef/embedded/lib/ruby/site_ruby/2.3.0/rubygems/core_ext/kernel_require.rb:55\nc:0016 p:0008 s:0080 e:000079 TOP    /opt/chef/embedded/lib/ruby/2.3.0/openssl.rb:13 [FINISH]\nc:0015 p:---- s:0078 e:000077 CFUNC  :require\nc:0014 p:0132 s:0074 e:000073 METHOD /opt/chef/embedded/lib/ruby/site_ruby/2.3.0/rubygems/core_ext/kernel_require.rb:55\nc:0013 p:0098 s:0063 e:000062 TOP    /opt/chef/embedded/lib/ruby/gems/2.3.0/gems/chef-config-12.21.3/lib/chef-config/config.rb:34 [FINISH]\nc:0012 p:---- s:0061 e:000060 CFUNC  :require\nc:0011 p:0132 s:0057 e:000056 METHOD /opt/chef/embedded/lib/ruby/site_ruby/2.3.0/rubygems/core_ext/kernel_require.rb:55\nc:0010 p:0048 s:0046 e:000045 TOP    /opt/chef/embedded/lib/ruby/gems/2.3.0/gems/chef-12.21.3/lib/chef/config.rb:30 [FINISH]\nc:0009 p:---- s:0044 e:000043 CFUNC  :require\nc:0008 p:0132 s:0040 e:000039 METHOD /opt/chef/embedded/lib/ruby/site_ruby/2.3.0/rubygems/core_ext/kernel_require.rb:55\nc:0007 p:0053 s:0029 e:000028 TOP    /opt/chef/embedded/lib/ruby/gems/2.3.0/gems/chef-12.21.3/lib/chef.rb:24 [FINISH]\nc:0006 p:---- s:0027 e:000026 CFUNC  :require\nc:0005 p:0132 s:0023 e:000022 METHOD /opt/chef/embedded/lib/ruby/site_ruby/2.3.0/rubygems/core_ext/kernel_require.rb:55\nc:0004 p:0051 s:0012 e:000011 TOP    /opt/chef/embedded/lib/ruby/gems/2.3.0/gems/chef-12.21.3/bin/chef-client:23 [FINISH]\nc:0003 p:---- s:0010 e:000009 CFUNC  :load\nc:0002 p:0624 s:0006 E:001360 EVAL   /usr/bin/chef-client:57 [FINISH]\nc:0001 p:0000 s:0002 E:002470 (none) [FINISH]\n\n-- Ruby level backtrace information ----------------------------------------\n/usr/bin/chef-client:57:in `&lt;main&gt;'\n/usr/bin/chef-client:57:in `load'\n/opt/chef/embedded/lib/ruby/gems/2.3.0/gems/chef-12.21.3/bin/chef-client:23:in `&lt;top (required)&gt;'\n/opt/chef/embedded/lib/ruby/site_ruby/2.3.0/rubygems/core_ext/kernel_require.rb:55:in `require'\n/opt/chef/embedded/lib/ruby/site_ruby/2.3.0/rubygems/core_ext/kernel_require.rb:55:in `require'\n/opt/chef/embedded/lib/ruby/gems/2.3.0/gems/chef-12.21.3/lib/chef.rb:24:in `&lt;top (required)&gt;'\n/opt/chef/embedded/lib/ruby/site_ruby/2.3.0/rubygems/core_ext/kernel_require.rb:55:in `require'\n/opt/chef/embedded/lib/ruby/site_ruby/2.3.0/rubygems/core_ext/kernel_require.rb:55:in `require'\n/opt/chef/embedded/lib/ruby/gems/2.3.0/gems/chef-12.21.3/lib/chef/config.rb:30:in `&lt;top (required)&gt;'\n/opt/chef/embedded/lib/ruby/site_ruby/2.3.0/rubygems/core_ext/kernel_require.rb:55:in `require'\n/opt/chef/embedded/lib/ruby/site_ruby/2.3.0/rubygems/core_ext/kernel_require.rb:55:in `require'\n/opt/chef/embedded/lib/ruby/gems/2.3.0/gems/chef-config-12.21.3/lib/chef-config/config.rb:34:in `&lt;top (required)&gt;'\n/opt/chef/embedded/lib/ruby/site_ruby/2.3.0/rubygems/core_ext/kernel_require.rb:55:in `require'\n/opt/chef/embedded/lib/ruby/site_ruby/2.3.0/rubygems/core_ext/kernel_require.rb:55:in `require'\n/opt/chef/embedded/lib/ruby/2.3.0/openssl.rb:13:in `&lt;top (required)&gt;'\n/opt/chef/embedded/lib/ruby/site_ruby/2.3.0/rubygems/core_ext/kernel_require.rb:55:in `require'\n/opt/chef/embedded/lib/ruby/site_ruby/2.3.0/rubygems/core_ext/kernel_require.rb:55:in `require'\n\n-- Machine register context ------------------------------------------------\nRIP: 0x00002b5ac1b082a5 RBP: 0x0000000013f8c5b0 RSP: 0x00007fff325c11a8\nRAX: 0x00000000000306e4 RBX: 0x0000000000000800 RCX: 0x0000000000000000\nRDX: 0x000000004f8bfbff RDI: 0x00002b5ac1c2a4d5 RSI: 0x00007fff325c4fb8\nR8: 0x0000000013ffdf20  R9: 0x00000000ffba2223 R10: 0x000000004f8bfbff\nR11: 0x000000000000000d R12: 0x00000000139619c0 R13: 0x00000000139619c0\nR14: 0x00007fff325c4fb8 R15: 0x0000000000000005 EFL: 0x0000000000010246\n\n-- C level backtrace information -------------------------------------------\n/opt/chef/embedded/lib/libruby.so.2.3 [0x2b5abbd56775]\n/opt/chef/embedded/lib/libruby.so.2.3 [0x2b5abbd571f7]\n/opt/chef/embedded/lib/libruby.so.2.3 [0x2b5abbc34220]\n/opt/chef/embedded/lib/libruby.so.2.3 [0x2b5abbce234a]\n/lib64/libpthread.so.0 [0x2b5abc051ca0]\n/opt/chef/embedded/lib/libcrypto.so.1.0.0(fips_openssl_ia32_cpuid+0x145) [0x2b5ac1b082a5]\n\n-- Other runtime information -----------------------------------------------\n\n* Loaded script: /usr/bin/chef-client\n\n* Loaded features:\n\n    0 enumerator.so\n    1 thread.rb\n    2 rational.so\n    3 complex.so\n    4 /opt/chef/embedded/lib/ruby/2.3.0/x86_64-linux/enc/encdb.so\n    5 /opt/chef/embedded/lib/ruby/2.3.0/x86_64-linux/enc/trans/transdb.so\n    6 /opt/chef/embedded/lib/ruby/2.3.0/unicode_normalize.rb\n    7 /opt/chef/embedded/lib/ruby/2.3.0/x86_64-linux/rbconfig.rb\n    8 /opt/chef/embedded/lib/ruby/site_ruby/2.3.0/rubygems/compatibility.rb\n    9 /opt/chef/embedded/lib/ruby/site_ruby/2.3.0/rubygems/defaults.rb\n    10 /opt/chef/embedded/lib/ruby/site_ruby/2.3.0/rubygems/deprecate.rb\n    11 /opt/chef/embedded/lib/ruby/site_ruby/2.3.0/rubygems/errors.rb\n    12 /opt/chef/embedded/lib/ruby/site_ruby/2.3.0/rubygems/version.rb\n    13 /opt/chef/embedded/lib/ruby/site_ruby/2.3.0/rubygems/requirement.rb\n    14 /opt/chef/embedded/lib/ruby/site_ruby/2.3.0/rubygems/platform.rb\n    15 /opt/chef/embedded/lib/ruby/site_ruby/2.3.0/rubygems/basic_specification.rb\n    16 /opt/chef/embedded/lib/ruby/site_ruby/2.3.0/rubygems/stub_specification.rb\n    17 /opt/chef/embedded/lib/ruby/site_ruby/2.3.0/rubygems/util/list.rb\n    18 /opt/chef/embedded/lib/ruby/2.3.0/x86_64-linux/stringio.so\n    19 /opt/chef/embedded/lib/ruby/site_ruby/2.3.0/rubygems/specification.rb\n    20 /opt/chef/embedded/lib/ruby/site_ruby/2.3.0/rubygems/exceptions.rb\n    21 /opt/chef/embedded/lib/ruby/site_ruby/2.3.0/rubygems/core_ext/kernel_gem.rb\n    22 /opt/chef/embedded/lib/ruby/2.3.0/monitor.rb\n    23 /opt/chef/embedded/lib/ruby/site_ruby/2.3.0/rubygems/core_ext/kernel_require.rb\n    24 /opt/chef/embedded/lib/ruby/site_ruby/2.3.0/rubygems.rb\n    25 /opt/chef/embedded/lib/ruby/site_ruby/2.3.0/rubygems/dependency.rb\n    26 /opt/chef/embedded/lib/ruby/site_ruby/2.3.0/rubygems/path_support.rb\n    27 /opt/chef/embedded/lib/ruby/gems/2.3.0/gems/chef-12.21.3/lib/chef/version.rb\n    28 /opt/chef/embedded/lib/ruby/gems/2.3.0/gems/chef-12.21.3/lib/chef/nil_argument.rb\n    29 /opt/chef/embedded/lib/ruby/gems/2.3.0/gems/chef-12.21.3/lib/chef/mash.rb\n    30 /opt/chef/embedded/lib/ruby/gems/2.3.0/gems/chef-config-12.21.3/lib/chef-config/windows.rb\n    31 /opt/chef/embedded/lib/ruby/gems/2.3.0/gems/chef-config-12.21.3/lib/chef-config/logger.rb\n    32 /opt/chef/embedded/lib/ruby/gems/2.3.0/gems/chef-config-12.21.3/lib/chef-config/exceptions.rb\n    33 /opt/chef/embedded/lib/ruby/gems/2.3.0/gems/mixlib-shellout-2.2.7/lib/mixlib/shellout/exceptions.rb\n    34 /opt/chef/embedded/lib/ruby/gems/2.3.0/gems/chef-12.21.3/lib/chef/exceptions.rb\n    35 /opt/chef/embedded/lib/ruby/2.3.0/logger.rb\n    36 /opt/chef/embedded/lib/ruby/2.3.0/prettyprint.rb\n    37 /opt/chef/embedded/lib/ruby/2.3.0/pp.rb\n    38 /opt/chef/embedded/lib/ruby/gems/2.3.0/gems/chef-12.21.3/lib/chef/monologger.rb\n    39 /opt/chef/embedded/lib/ruby/gems/2.3.0/gems/mixlib-log-1.7.1/lib/mixlib/log/version.rb\n    40 /opt/chef/embedded/lib/ruby/2.3.0/x86_64-linux/date_core.so\n    41 /opt/chef/embedded/lib/ruby/2.3.0/date.rb\n    42 /opt/chef/embedded/lib/ruby/2.3.0/time.rb\n    43 /opt/chef/embedded/lib/ruby/gems/2.3.0/gems/mixlib-log-1.7.1/lib/mixlib/log/formatter.rb\n    44 /opt/chef/embedded/lib/ruby/gems/2.3.0/gems/mixlib-log-1.7.1/lib/mixlib/log.rb\n    45 /opt/chef/embedded/lib/ruby/2.3.0/x86_64-linux/syslog.so\n    46 /opt/chef/embedded/lib/ruby/gems/2.3.0/gems/syslog-logger-1.6.8/lib/syslog-formatter.rb\n    47 /opt/chef/embedded/lib/ruby/gems/2.3.0/gems/syslog-logger-1.6.8/lib/syslog-logger.rb\n    48 /opt/chef/embedded/lib/ruby/gems/2.3.0/gems/chef-12.21.3/lib/chef/mixin/unformatter.rb\n    49 /opt/chef/embedded/lib/ruby/gems/2.3.0/gems/chef-12.21.3/lib/chef/log/syslog.rb\n    50 /opt/chef/embedded/lib/ruby/gems/2.3.0/gems/chef-12.21.3/lib/chef/event_dispatch/base.rb\n    51 /opt/chef/embedded/lib/ruby/gems/2.3.0/gems/chef-12.21.3/lib/chef/event_loggers/base.rb\n    52 /opt/chef/embedded/lib/ruby/gems/2.3.0/gems/chef-12.21.3/lib/chef/platform/query_helpers.rb\n    53 /opt/chef/embedded/lib/ruby/gems/2.3.0/gems/chef-12.21.3/lib/chef/log/winevt.rb\n    54 /opt/chef/embedded/lib/ruby/gems/2.3.0/gems/chef-12.21.3/lib/chef/log.rb\n    55 /opt/chef/embedded/lib/ruby/gems/2.3.0/gems/mixlib-config-2.2.4/lib/mixlib/config/version.rb\n    56 /opt/chef/embedded/lib/ruby/gems/2.3.0/gems/mixlib-config-2.2.4/lib/mixlib/config/configurable.rb\n    57 /opt/chef/embedded/lib/ruby/gems/2.3.0/gems/mixlib-config-2.2.4/lib/mixlib/config/unknown_config_option_error.rb\n    58 /opt/chef/embedded/lib/ruby/gems/2.3.0/gems/mixlib-config-2.2.4/lib/mixlib/config/reopened_config_context_with_configurable_error.rb\n    59 /opt/chef/embedded/lib/ruby/gems/2.3.0/gems/mixlib-config-2.2.4/lib/mixlib/config/reopened_configurable_with_config_context_error.rb\n    60 /opt/chef/embedded/lib/ruby/gems/2.3.0/gems/mixlib-config-2.2.4/lib/mixlib/config.rb\n    61 /opt/chef/embedded/lib/ruby/2.3.0/x86_64-linux/pathname.so\n    62 /opt/chef/embedded/lib/ruby/2.3.0/pathname.rb\n    63 /opt/chef/embedded/lib/ruby/gems/2.3.0/gems/chef-config-12.21.3/lib/chef-config/fips.rb\n    64 /opt/chef/embedded/lib/ruby/gems/2.3.0/gems/chef-config-12.21.3/lib/chef-config/path_helper.rb\n    65 /opt/chef/embedded/lib/ruby/gems/2.3.0/gems/fuzzyurl-0.9.0/lib/fuzzyurl/version.rb\n    66 /opt/chef/embedded/lib/ruby/gems/2.3.0/gems/fuzzyurl-0.9.0/lib/fuzzyurl/fields.rb\n    67 /opt/chef/embedded/lib/ruby/gems/2.3.0/gems/fuzzyurl-0.9.0/lib/fuzzyurl/protocols.rb\n    68 /opt/chef/embedded/lib/ruby/gems/2.3.0/gems/fuzzyurl-0.9.0/lib/fuzzyurl/match.rb\n    69 /opt/chef/embedded/lib/ruby/gems/2.3.0/gems/fuzzyurl-0.9.0/lib/fuzzyurl/strings.rb\n    70 /opt/chef/embedded/lib/ruby/gems/2.3.0/gems/fuzzyurl-0.9.0/lib/fuzzyurl.rb\n    71 /opt/chef/embedded/lib/ruby/gems/2.3.0/gems/chef-config-12.21.3/lib/chef-config/mixin/fuzzy_hostname_matcher.rb\n    72 /opt/chef/embedded/lib/ruby/2.3.0/x86_64-linux/etc.so\n    73 /opt/chef/embedded/lib/ruby/2.3.0/fileutils.rb\n    74 /opt/chef/embedded/lib/ruby/2.3.0/tmpdir.rb\n    75 /opt/chef/embedded/lib/ruby/2.3.0/x86_64-linux/fcntl.so\n    76 /opt/chef/embedded/lib/ruby/gems/2.3.0/gems/mixlib-shellout-2.2.7/lib/mixlib/shellout/unix.rb\n    77 /opt/chef/embedded/lib/ruby/gems/2.3.0/gems/mixlib-shellout-2.2.7/lib/mixlib/shellout.rb\n    78 /opt/chef/embedded/lib/ruby/2.3.0/uri/rfc2396_parser.rb\n    79 /opt/chef/embedded/lib/ruby/2.3.0/uri/rfc3986_parser.rb\n    80 /opt/chef/embedded/lib/ruby/2.3.0/uri/common.rb\n    81 /opt/chef/embedded/lib/ruby/2.3.0/uri/generic.rb\n    82 /opt/chef/embedded/lib/ruby/2.3.0/uri/ftp.rb\n    83 /opt/chef/embedded/lib/ruby/2.3.0/uri/http.rb\n    84 /opt/chef/embedded/lib/ruby/2.3.0/uri/https.rb\n    85 /opt/chef/embedded/lib/ruby/2.3.0/uri/ldap.rb\n    86 /opt/chef/embedded/lib/ruby/2.3.0/uri/ldaps.rb\n    87 /opt/chef/embedded/lib/ruby/2.3.0/uri/mailto.rb\n    88 /opt/chef/embedded/lib/ruby/2.3.0/uri.rb\n    89 /opt/chef/embedded/lib/ruby/gems/2.3.0/gems/addressable-2.4.0/lib/addressable/version.rb\n    90 /opt/chef/embedded/lib/ruby/gems/2.3.0/gems/addressable-2.4.0/lib/addressable/idna/pure.rb\n    91 /opt/chef/embedded/lib/ruby/gems/2.3.0/gems/addressable-2.4.0/lib/addressable/idna.rb\n    92 /opt/chef/embedded/lib/ruby/gems/2.3.0/gems/addressable-2.4.0/lib/addressable/uri.rb\n\n* Process memory map:\n\n00400000-00401000 r-xp 00000000 fd:01 2325                               /opt/chef/embedded/bin/ruby\n00600000-00601000 rw-p 00000000 fd:01 2325                               /opt/chef/embedded/bin/ruby\n137f7000-1416f000 rw-p 137f7000 00:00 0                                  [heap]\n2b5abb9b0000-2b5abb9cc000 r-xp 00000000 fd:01 131404                     /lib64/ld-2.5.so\n2b5abb9cc000-2b5abb9ce000 rw-p 2b5abb9cc000 00:00 0\n2b5abbbcc000-2b5abbbcd000 r--p 0001c000 fd:01 131404                     /lib64/ld-2.5.so\n2b5abbbcd000-2b5abbbce000 rw-p 0001d000 fd:01 131404                     /lib64/ld-2.5.so\n2b5abbbce000-2b5abbe22000 r-xp 00000000 fd:01 2636                       /opt/chef/embedded/lib/libruby.so.2.3.0\n2b5abbe22000-2b5abc022000 ---p 00254000 fd:01 2636                       /opt/chef/embedded/lib/libruby.so.2.3.0\n2b5abc022000-2b5abc02a000 rw-p 00254000 fd:01 2636                       /opt/chef/embedded/lib/libruby.so.2.3.0\n2b5abc02a000-2b5abc03b000 rw-p 2b5abc02a000 00:00 0\n2b5abc043000-2b5abc059000 r-xp 00000000 fd:01 130401                     /lib64/libpthread-2.5.so\n2b5abc059000-2b5abc259000 ---p 00016000 fd:01 130401                     /lib64/libpthread-2.5.so\n2b5abc259000-2b5abc25a000 r--p 00016000 fd:01 130401                     /lib64/libpthread-2.5.so\n2b5abc25a000-2b5abc25b000 rw-p 00017000 fd:01 130401                     /lib64/libpthread-2.5.so\n2b5abc25b000-2b5abc25f000 rw-p 2b5abc25b000 00:00 0\n2b5abc25f000-2b5abc266000 r-xp 00000000 fd:01 130632                     /lib64/librt-2.5.so\n2b5abc266000-2b5abc466000 ---p 00007000 fd:01 130632                     /lib64/librt-2.5.so\n2b5abc466000-2b5abc467000 r--p 00007000 fd:01 130632                     /lib64/librt-2.5.so\n2b5abc467000-2b5abc468000 rw-p 00008000 fd:01 130632                     /lib64/librt-2.5.so\n2b5abc468000-2b5abc469000 rw-p 2b5abc468000 00:00 0\n2b5abc469000-2b5abc46b000 r-xp 00000000 fd:01 130408                     /lib64/libdl-2.5.so\n2b5abc46b000-2b5abc66b000 ---p 00002000 fd:01 130408                     /lib64/libdl-2.5.so\n2b5abc66b000-2b5abc66c000 r--p 00002000 fd:01 130408                     /lib64/libdl-2.5.so\n2b5abc66c000-2b5abc66d000 rw-p 00003000 fd:01 130408                     /lib64/libdl-2.5.so\n2b5abc66d000-2b5abc676000 r-xp 00000000 fd:01 130369                     /lib64/libcrypt-2.5.so\n2b5abc676000-2b5abc875000 ---p 00009000 fd:01 130369                     /lib64/libcrypt-2.5.so\n2b5abc875000-2b5abc876000 r--p 00008000 fd:01 130369                     /lib64/libcrypt-2.5.so\n2b5abc876000-2b5abc877000 rw-p 00009000 fd:01 130369                     /lib64/libcrypt-2.5.so\n2b5abc877000-2b5abc8a5000 rw-p 2b5abc877000 00:00 0\n2b5abc8a5000-2b5abc927000 r-xp 00000000 fd:01 130643                     /lib64/libm-2.5.so\n2b5abc927000-2b5abcb26000 ---p 00082000 fd:01 130643                     /lib64/libm-2.5.so\n2b5abcb26000-2b5abcb27000 r--p 00081000 fd:01 130643                     /lib64/libm-2.5.so\n2b5abcb27000-2b5abcb28000 rw-p 00082000 fd:01 130643                     /lib64/libm-2.5.so\n2b5abcb28000-2b5abcb29000 rw-p 2b5abcb28000 00:00 0\n2b5abcb29000-2b5abcc78000 r-xp 00000000 fd:01 130499                     /lib64/libc-2.5.so\n2b5abcc78000-2b5abce78000 ---p 0014f000 fd:01 130499                     /lib64/libc-2.5.so\n2b5abce78000-2b5abce7c000 r--p 0014f000 fd:01 130499                     /lib64/libc-2.5.so\n2b5abce7c000-2b5abce7d000 rw-p 00153000 fd:01 130499                     /lib64/libc-2.5.so\n2b5abce7d000-2b5abce84000 rw-p 2b5abce7d000 00:00 0\n2b5abce84000-2b5ac0452000 r--p 00000000 fd:01 402051                     /usr/lib/locale/locale-archive\n2b5ac0452000-2b5ac0553000 rw-p 2b5ac0452000 00:00 0\n2b5ac0553000-2b5ac0554000 ---p 2b5ac0553000 00:00 0\n2b5ac0554000-2b5ac0557000 rw-p 2b5ac0554000 00:00 0\n2b5ac0557000-2b5ac0559000 r-xp 00000000 fd:01 3502                       /opt/chef/embedded/lib/ruby/2.3.0/x86_64-linux/enc/encdb.so\n2b5ac0559000-2b5ac0758000 ---p 00002000 fd:01 3502                       /opt/chef/embedded/lib/ruby/2.3.0/x86_64-linux/enc/encdb.so\n2b5ac0758000-2b5ac0759000 rw-p 00001000 fd:01 3502                       /opt/chef/embedded/lib/ruby/2.3.0/x86_64-linux/enc/encdb.so\n2b5ac0759000-2b5ac075b000 r-xp 00000000 fd:01 3545                       /opt/chef/embedded/lib/ruby/2.3.0/x86_64-linux/enc/trans/transdb.so\n2b5ac075b000-2b5ac095b000 ---p 00002000 fd:01 3545                       /opt/chef/embedded/lib/ruby/2.3.0/x86_64-linux/enc/trans/transdb.so\n2b5ac095b000-2b5ac095c000 rw-p 00002000 fd:01 3545                       /opt/chef/embedded/lib/ruby/2.3.0/x86_64-linux/enc/trans/transdb.so\n2b5ac095c000-2b5ac0962000 r-xp 00000000 fd:01 3585                       /opt/chef/embedded/lib/ruby/2.3.0/x86_64-linux/stringio.so\n2b5ac0962000-2b5ac0b62000 ---p 00006000 fd:01 3585                       /opt/chef/embedded/lib/ruby/2.3.0/x86_64-linux/stringio.so\n2b5ac0b62000-2b5ac0b63000 rw-p 00006000 fd:01 3585                       /opt/chef/embedded/lib/ruby/2.3.0/x86_64-linux/stringio.so\n2b5ac0b63000-2b5ac0b99000 r-xp 00000000 fd:01 3490                       /opt/chef/embedded/lib/ruby/2.3.0/x86_64-linux/date_core.so\n2b5ac0b99000-2b5ac0d98000 ---p 00036000 fd:01 3490                       /opt/chef/embedded/lib/ruby/2.3.0/x86_64-linux/date_core.so\n2b5ac0d98000-2b5ac0d9a000 rw-p 00035000 fd:01 3490                       /opt/chef/embedded/lib/ruby/2.3.0/x86_64-linux/date_core.so\n2b5ac0d9a000-2b5ac0d9b000 rw-p 2b5ac0d9a000 00:00 0\n2b5ac0d9b000-2b5ac0d9e000 r-xp 00000000 fd:01 3587                       /opt/chef/embedded/lib/ruby/2.3.0/x86_64-linux/syslog.so\n2b5ac0d9e000-2b5ac0f9d000 ---p 00003000 fd:01 3587                       /opt/chef/embedded/lib/ruby/2.3.0/x86_64-linux/syslog.so\n2b5ac0f9d000-2b5ac0f9e000 rw-p 00002000 fd:01 3587                       /opt/chef/embedded/lib/ruby/2.3.0/x86_64-linux/syslog.so\n2b5ac0f9e000-2b5ac0fa4000 r-xp 00000000 fd:01 3574                       /opt/chef/embedded/lib/ruby/2.3.0/x86_64-linux/pathname.so\n2b5ac0fa4000-2b5ac11a3000 ---p 00006000 fd:01 3574                       /opt/chef/embedded/lib/ruby/2.3.0/x86_64-linux/pathname.so\n2b5ac11a3000-2b5ac11a4000 rw-p 00005000 fd:01 3574                       /opt/chef/embedded/lib/ruby/2.3.0/x86_64-linux/pathname.so\n2b5ac11a4000-2b5ac11a9000 r-xp 00000000 fd:01 3556                       /opt/chef/embedded/lib/ruby/2.3.0/x86_64-linux/etc.so\n2b5ac11a9000-2b5ac13a8000 ---p 00005000 fd:01 3556                       /opt/chef/embedded/lib/ruby/2.3.0/x86_64-linux/etc.so\n2b5ac13a8000-2b5ac13a9000 rw-p 00004000 fd:01 3556                       /opt/chef/embedded/lib/ruby/2.3.0/x86_64-linux/etc.so\n2b5ac13a9000-2b5ac13aa000 r-xp 00000000 fd:01 3557                       /opt/chef/embedded/lib/ruby/2.3.0/x86_64-linux/fcntl.so\n2b5ac13aa000-2b5ac15a9000 ---p 00001000 fd:01 3557                       /opt/chef/embedded/lib/ruby/2.3.0/x86_64-linux/fcntl.so\n2b5ac15a9000-2b5ac15aa000 rw-p 00000000 fd:01 3557                       /opt/chef/embedded/lib/ruby/2.3.0/x86_64-linux/fcntl.so\n2b5ac15aa000-2b5ac15f6000 r-xp 00000000 fd:01 3573                       /opt/chef/embedded/lib/ruby/2.3.0/x86_64-linux/openssl.so\n2b5ac15f6000-2b5ac17f6000 ---p 0004c000 fd:01 3573                       /opt/chef/embedded/lib/ruby/2.3.0/x86_64-linux/openssl.so\n2b5ac17f6000-2b5ac17fa000 rw-p 0004c000 fd:01 3573                       /opt/chef/embedded/lib/ruby/2.3.0/x86_64-linux/openssl.so\n2b5ac17fa000-2b5ac1859000 r-xp 00000000 fd:01 2639                       /opt/chef/embedded/lib/libssl.so.1.0.0\n2b5ac1859000-2b5ac1a59000 ---p 0005f000 fd:01 2639                       /opt/chef/embedded/lib/libssl.so.1.0.0\n2b5ac1a59000-2b5ac1a63000 rw-p 0005f000 fd:01 2639                       /opt/chef/embedded/lib/libssl.so.1.0.0\n2b5ac1a63000-2b5ac1cad000 r-xp 00000000 fd:01 2604                       /opt/chef/embedded/lib/libcrypto.so.1.0.0\n2b5ac1cad000-2b5ac1ead000 ---p 0024a000 fd:01 2604                       /opt/chef/embedded/lib/libcrypto.so.1.0.0\n2b5ac1ead000-2b5ac1ed9000 rw-p 0024a000 fd:01 2604                       /opt/chef/embedded/lib/libcrypto.so.1.0.0\n2b5ac1ed9000-2b5ac1edd000 rw-p 2b5ac1ed9000 00:00 0\n2b5ac1edd000-2b5ac1ef1000 r-xp 00000000 fd:01 2658                       /opt/chef/embedded/lib/libz.so.1.2.11\n2b5ac1ef1000-2b5ac20f1000 ---p 00014000 fd:01 2658                       /opt/chef/embedded/lib/libz.so.1.2.11\n2b5ac20f1000-2b5ac20f2000 rw-p 00014000 fd:01 2658                       /opt/chef/embedded/lib/libz.so.1.2.11\n2b5ac20f2000-2b5ac20f5000 r--s 00000000 fd:01 2325                       /opt/chef/embedded/bin/ruby\n2b5ac20fa000-2b5ac2107000 r-xp 00000000 fd:01 140090                     /lib64/libgcc_s-4.1.2-20080825.so.1\n2b5ac2107000-2b5ac2307000 ---p 0000d000 fd:01 140090                     /lib64/libgcc_s-4.1.2-20080825.so.1\n2b5ac2307000-2b5ac2308000 rw-p 0000d000 fd:01 140090                     /lib64/libgcc_s-4.1.2-20080825.so.1\n2b5ac2308000-2b5ac232c000 r--s 00000000 fd:01 130401                     /lib64/libpthread-2.5.so\n2b5ac232c000-2b5ac2333000 r--s 00000000 fd:01 791674                     /usr/lib64/gconv/gconv-modules.cache\n2b5ac2333000-2b5ac2334000 rw-p 2b5ac2333000 00:00 0\n7fff31bc8000-7fff325c7000 rw-p 7fffff5ff000 00:00 0                      [stack]\n7fff325fd000-7fff32600000 r-xp 7fff325fd000 00:00 0                      [vdso]\nffffffffff600000-ffffffffffe00000 ---p 00000000 00:00 0                  [vsyscall]\n\n\n[NOTE]\nYou may have encountered a bug in the Ruby interpreter or extension libraries.\nBug reports are welcome.\nFor details: http://www.ruby-lang.org/bugreport.html\n</code></pre>\n"}, {"tags": ["mysql", "ruby", "time"], "comments": [{"owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 0, "creation_date": 1521614829, "post_id": 49399821, "comment_id": 85800845, "body": "Your question is unclear to me. What is the problem you are trying to solve: How to format the output (hint: <code>strftime</code>)? Or how to change the timezone to UTC?"}, {"owner": {"reputation": 59, "user_id": 9320758, "user_type": "registered", "accept_rate": 83, "profile_image": "https://graph.facebook.com/1956448207702706/picture?type=large", "display_name": "Joshua Ng", "link": "https://stackoverflow.com/users/9320758/joshua-ng"}, "reply_to_user": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 0, "creation_date": 1521615142, "post_id": 49399821, "comment_id": 85800998, "body": "@spickermann Yes, I would like to format the output"}], "answers": [{"comments": [{"owner": {"reputation": 59, "user_id": 9320758, "user_type": "registered", "accept_rate": 83, "profile_image": "https://graph.facebook.com/1956448207702706/picture?type=large", "display_name": "Joshua Ng", "link": "https://stackoverflow.com/users/9320758/joshua-ng"}, "edited": false, "score": 0, "creation_date": 1521615088, "post_id": 49399889, "comment_id": 85800968, "body": "&#39;sourcetime&#39; is my column name. Is there another way to add .strftime(&quot;%I:%M%p&quot;)"}, {"owner": {"reputation": 412, "user_id": 4779465, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/rxj3q.png?s=128&g=1", "display_name": "Prasanth_Rubyist", "link": "https://stackoverflow.com/users/4779465/prasanth-rubyist"}, "reply_to_user": {"reputation": 59, "user_id": 9320758, "user_type": "registered", "accept_rate": 83, "profile_image": "https://graph.facebook.com/1956448207702706/picture?type=large", "display_name": "Joshua Ng", "link": "https://stackoverflow.com/users/9320758/joshua-ng"}, "edited": false, "score": 0, "creation_date": 1521615214, "post_id": 49399889, "comment_id": 85801034, "body": "if you saved in string date, just convert into date eg:) sourcetime.to_date.strftime(&quot;%I:%M%p&quot;)"}, {"owner": {"reputation": 59, "user_id": 9320758, "user_type": "registered", "accept_rate": 83, "profile_image": "https://graph.facebook.com/1956448207702706/picture?type=large", "display_name": "Joshua Ng", "link": "https://stackoverflow.com/users/9320758/joshua-ng"}, "edited": false, "score": 0, "creation_date": 1521615643, "post_id": 49399889, "comment_id": 85801230, "body": "I&#39;ve edited to show my full code. My &#39;sourcetime&#39; is in a nested array. I don&#39;t see how I could put it into a string to convert it."}], "tags": [], "owner": {"reputation": 412, "user_id": 4779465, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/rxj3q.png?s=128&g=1", "display_name": "Prasanth_Rubyist", "link": "https://stackoverflow.com/users/4779465/prasanth-rubyist"}, "is_accepted": false, "score": 1, "last_activity_date": 1521614777, "creation_date": 1521614777, "answer_id": 49399889, "question_id": 49399821, "link": "https://stackoverflow.com/questions/49399821/format-datatype-for-time-in-mysql/49399889#49399889", "title": "Format Datatype for Time in MySQL", "body": "<p>Can you try <strong>strftime(\"%I:%M%p\")</strong></p>\n\n<pre><code>equipments = result.map { |print_this| print_this.sourcetime.strftime(\"%I:%M%p\") }\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 59, "user_id": 9320758, "user_type": "registered", "accept_rate": 83, "profile_image": "https://graph.facebook.com/1956448207702706/picture?type=large", "display_name": "Joshua Ng", "link": "https://stackoverflow.com/users/9320758/joshua-ng"}, "edited": false, "score": 0, "creation_date": 1521621205, "post_id": 49401005, "comment_id": 85804088, "body": "Nice! May I add for future users that the .to_s is needed to prevent  error <code>Time.parse(record[&#39;sourcetime&#39;].to_s).strftime(&#39;%H:%M:%S&#39;)</code>"}, {"owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "reply_to_user": {"reputation": 59, "user_id": 9320758, "user_type": "registered", "accept_rate": 83, "profile_image": "https://graph.facebook.com/1956448207702706/picture?type=large", "display_name": "Joshua Ng", "link": "https://stackoverflow.com/users/9320758/joshua-ng"}, "edited": false, "score": 0, "creation_date": 1521621423, "post_id": 49401005, "comment_id": 85804206, "body": "What kind of error do you get without the <code>to_s</code>? The <code>pg</code> returns date and time column in a string representation, there shouldn&#39;t be a need to call <code>to_s</code> on something that is already a string."}, {"owner": {"reputation": 59, "user_id": 9320758, "user_type": "registered", "accept_rate": 83, "profile_image": "https://graph.facebook.com/1956448207702706/picture?type=large", "display_name": "Joshua Ng", "link": "https://stackoverflow.com/users/9320758/joshua-ng"}, "edited": false, "score": 0, "creation_date": 1521621480, "post_id": 49401005, "comment_id": 85804247, "body": "<code>no implicit conversion of Time into String</code>"}, {"owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "reply_to_user": {"reputation": 59, "user_id": 9320758, "user_type": "registered", "accept_rate": 83, "profile_image": "https://graph.facebook.com/1956448207702706/picture?type=large", "display_name": "Joshua Ng", "link": "https://stackoverflow.com/users/9320758/joshua-ng"}, "edited": false, "score": 1, "creation_date": 1521621637, "post_id": 49401005, "comment_id": 85804359, "body": "Wow, that is unexpected. It seems to depend on the setup or the gem version if a string or a time is returned. Just skip the <code>Time.parse</code> part your case, <code>record[&#39;sourcetime&#39;].strftime(&#39;%H:%M:%S&#39;)</code> should work in your context."}], "tags": [], "owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "is_accepted": true, "score": 1, "last_activity_date": 1521619454, "creation_date": 1521619454, "answer_id": 49401005, "question_id": 49399821, "link": "https://stackoverflow.com/questions/49399821/format-datatype-for-time-in-mysql/49401005#49401005", "title": "Format Datatype for Time in MySQL", "body": "<p>Two steps are necessary to achieve this:</p>\n\n<ol>\n<li><a href=\"https://ruby-doc.org/stdlib-2.5.0/libdoc/time/rdoc/Time.html#method-c-parse\" rel=\"nofollow noreferrer\"><code>Time.parse</code></a> the string returned from your database into an instance of <code>Time</code>. </li>\n<li>Use <a href=\"https://ruby-doc.org/core-2.5.0/Time.html#method-i-strftime\" rel=\"nofollow noreferrer\"><code>Time#strftime</code></a> to format the instance of <code>Time</code> into the desired output format.</li>\n</ol>\n\n<p>To just display the hours, minutes and seconds of a time (without the date and timezone information) use the <code>'%H:%M:%S'</code> directive (see the <a href=\"https://ruby-doc.org/core-2.5.0/Time.html#method-i-strftime\" rel=\"nofollow noreferrer\">docs</a> for more examples).</p>\n\n<pre><code>require 'time' # `Time.parse` is not Ruby Core but from the Standard Library\n\nequipments = result.map do |record| \n  [\n    Time.parse(record['sourcetime']).strftime('%H:%M:%S'), \n    record['description']\n  ]\nend\n</code></pre>\n"}], "owner": {"reputation": 59, "user_id": 9320758, "user_type": "registered", "accept_rate": 83, "profile_image": "https://graph.facebook.com/1956448207702706/picture?type=large", "display_name": "Joshua Ng", "link": "https://stackoverflow.com/users/9320758/joshua-ng"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 47, "favorite_count": 0, "accepted_answer_id": 49401005, "answer_count": 2, "score": 0, "last_activity_date": 1521619454, "creation_date": 1521614487, "last_edit_date": 1521615542, "question_id": 49399821, "link": "https://stackoverflow.com/questions/49399821/format-datatype-for-time-in-mysql", "title": "Format Datatype for Time in MySQL", "body": "<pre><code>result = connect.query(\"SELECT * FROM data WHERE event_type = 'ALARM_OPENED' AND severity = '2'\")\nequipments = result.map { |print_this| [print_this['sourcetime'], print_this['description']] }\np equipments\n</code></pre>\n\n<p>The Datatype for <code>sourcetime</code> in MySQL workbench is set to TIME</p>\n\n<p>The result I get is <code>2000-01-01 12:00:04 +0100</code></p>\n\n<p>I would like to get only the time <code>12:00:04</code> and drop the date and +0100</p>\n"}, {"tags": ["ruby", "chef-infra", "chef-recipe", "chef-solo"], "answers": [{"comments": [{"owner": {"reputation": 2929, "user_id": 1835756, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/fbe7d85479784751ea97fc986b31d787?s=128&d=identicon&r=PG", "display_name": "Adrian Preuss", "link": "https://stackoverflow.com/users/1835756/adrian-preuss"}, "edited": false, "score": 0, "creation_date": 1521707502, "post_id": 49419323, "comment_id": 85848502, "body": "This does not provide an answer to the question. To critique or request clarification from an author, leave a comment below their post. - <a href=\"/review/low-quality-posts/19190783\">From Review</a>"}, {"owner": {"reputation": 43208, "user_id": 78722, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cf611565f0b79abd0b3dc200ad867661?s=128&d=identicon&r=PG", "display_name": "coderanger", "link": "https://stackoverflow.com/users/78722/coderanger"}, "reply_to_user": {"reputation": 2929, "user_id": 1835756, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/fbe7d85479784751ea97fc986b31d787?s=128&d=identicon&r=PG", "display_name": "Adrian Preuss", "link": "https://stackoverflow.com/users/1835756/adrian-preuss"}, "edited": false, "score": 0, "creation_date": 1521748421, "post_id": 49419323, "comment_id": 85876539, "body": "Erm, what? While 50% of it is the unhelpful answer, I did include the actual answer too."}, {"owner": {"reputation": 3556, "user_id": 506908, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84c874984f69ef596764255efcd79113?s=128&d=identicon&r=PG", "display_name": "lamont", "link": "https://stackoverflow.com/users/506908/lamont"}, "edited": false, "score": 0, "creation_date": 1521825936, "post_id": 49419323, "comment_id": 85913438, "body": "As a chef author I just cut an issue against core chef to deprecate and remove FileEdit because of all these questions.  We&#39;re not kidding that its a dead end and a source of endless pain and people need to stop using it.  <a href=\"https://github.com/chef/chef/issues/7043\" rel=\"nofollow noreferrer\">github.com/chef/chef/issues/7043</a>"}], "tags": [], "owner": {"reputation": 43208, "user_id": 78722, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cf611565f0b79abd0b3dc200ad867661?s=128&d=identicon&r=PG", "display_name": "coderanger", "link": "https://stackoverflow.com/users/78722/coderanger"}, "is_accepted": false, "score": 0, "last_activity_date": 1521683780, "creation_date": 1521683780, "answer_id": 49419323, "question_id": 49399280, "link": "https://stackoverflow.com/questions/49399280/how-to-preserve-indentation-using-chefutilfileedit-functions/49419323#49419323", "title": "How to preserve indentation using Chef::Util::FileEdit functions?", "body": "<p>Answer part one: FileEdit is an internal API to Chef and we do not support its use in recipe code. Do not do this. Period.</p>\n\n<p>More useful answer: you need to manually include the requisite whitespace in your replacement string.</p>\n"}], "owner": {"reputation": 105, "user_id": 6752839, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdcb87627c42b221af73853bc0086d2c?s=128&d=identicon&r=PG&f=1", "display_name": "Raamish Malik", "link": "https://stackoverflow.com/users/6752839/raamish-malik"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 174, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1521683780, "creation_date": 1521612237, "question_id": 49399280, "link": "https://stackoverflow.com/questions/49399280/how-to-preserve-indentation-using-chefutilfileedit-functions", "title": "How to preserve indentation using Chef::Util::FileEdit functions?", "body": "<p>The question is fairly simple and I couldn't find anything related to indentation inside the <a href=\"http://www.rubydoc.info/gems/chef/Chef/Util/FileEdit\" rel=\"nofollow noreferrer\">FileEdit</a> documentations.</p>\n\n<p>What I want is to use <a href=\"http://www.rubydoc.info/gems/chef/Chef%2FUtil%2FFileEdit:insert_line_after_match\" rel=\"nofollow noreferrer\">inser_line_after_match</a> function and the next line should be added with as much indentation as the regex line.</p>\n\n<p>Is it possible?</p>\n\n<p>For example - When I used </p>\n\n<p><code>file_xml.insert_line_after_match(/&lt;cookie-path&gt;\\/analytics&lt;\\/cookie-path&gt;/, \"&lt;cookie-secure&gt;true&lt;/cookie-secure&gt;\")</code> - </p>\n\n<p>The output is</p>\n\n<pre><code>&lt;session-descriptor&gt;\n    &lt;cookie-path&gt;/analytics&lt;/cookie-path&gt;\n&lt;cookie-secure&gt;true&lt;/cookie-secure&gt;\n&lt;/session-descriptor&gt;\n</code></pre>\n\n<p>What I want is the indentation to be maintained like - </p>\n\n<pre><code>&lt;session-descriptor&gt;\n    &lt;cookie-path&gt;/analytics&lt;/cookie-path&gt;\n    &lt;cookie-secure&gt;true&lt;/cookie-secure&gt;\n&lt;/session-descriptor&gt;\n</code></pre>\n\n<p>Also I know I can hard code the spaces, but then not always would I know about how many indents are getting used, so that solution is not the perfect one.</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 19261, "user_id": 4758119, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/F4dJY.jpg?s=128&g=1", "display_name": "Deepak Mahakale", "link": "https://stackoverflow.com/users/4758119/deepak-mahakale"}, "edited": false, "score": 1, "creation_date": 1521611867, "post_id": 49399113, "comment_id": 85799516, "body": "Why would you want to delete the user?  If the user is associated with any other company there will be a problem"}, {"owner": {"reputation": 19261, "user_id": 4758119, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/F4dJY.jpg?s=128&g=1", "display_name": "Deepak Mahakale", "link": "https://stackoverflow.com/users/4758119/deepak-mahakale"}, "edited": false, "score": 0, "creation_date": 1521611940, "post_id": 49399113, "comment_id": 85799546, "body": "If the case is that a user will be associated with only one company I think you should go with <code>company has_many users</code> you don&#39;t need through association in this case"}, {"owner": {"reputation": 1588, "user_id": 723334, "user_type": "registered", "accept_rate": 49, "profile_image": "https://i.stack.imgur.com/Yoz09.jpg?s=128&g=1", "display_name": "prajeesh", "link": "https://stackoverflow.com/users/723334/prajeesh"}, "reply_to_user": {"reputation": 19261, "user_id": 4758119, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/F4dJY.jpg?s=128&g=1", "display_name": "Deepak Mahakale", "link": "https://stackoverflow.com/users/4758119/deepak-mahakale"}, "edited": false, "score": 0, "creation_date": 1521611957, "post_id": 49399113, "comment_id": 85799555, "body": "The user is related to only one company. The scenario is that when a company is deleted, all the associated users should also be deleted."}, {"owner": {"reputation": 19261, "user_id": 4758119, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/F4dJY.jpg?s=128&g=1", "display_name": "Deepak Mahakale", "link": "https://stackoverflow.com/users/4758119/deepak-mahakale"}, "edited": false, "score": 0, "creation_date": 1521611981, "post_id": 49399113, "comment_id": 85799571, "body": "Read the second comment then"}, {"owner": {"reputation": 6207, "user_id": 5117953, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/Ca0RW.jpg?s=128&g=1", "display_name": "Vishal", "link": "https://stackoverflow.com/users/5117953/vishal"}, "edited": false, "score": 2, "creation_date": 1521612371, "post_id": 49399113, "comment_id": 85799740, "body": "@prajeesh are per your requirement the association should be like this <code>user belongs to company, company has many users</code>"}, {"owner": {"reputation": 1588, "user_id": 723334, "user_type": "registered", "accept_rate": 49, "profile_image": "https://i.stack.imgur.com/Yoz09.jpg?s=128&g=1", "display_name": "prajeesh", "link": "https://stackoverflow.com/users/723334/prajeesh"}, "edited": false, "score": 0, "creation_date": 1521613137, "post_id": 49399113, "comment_id": 85800069, "body": "user belongs to company, company has many users doesnt seem to work"}, {"owner": {"reputation": 2985, "user_id": 1918618, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/4Lh3o.jpg?s=128&g=1", "display_name": "Manoj Monga", "link": "https://stackoverflow.com/users/1918618/manoj-monga"}, "edited": false, "score": 0, "creation_date": 1521613543, "post_id": 49399113, "comment_id": 85800256, "body": "What is the issue when you use Vishal&#39;s suggestion?"}, {"owner": {"reputation": 1588, "user_id": 723334, "user_type": "registered", "accept_rate": 49, "profile_image": "https://i.stack.imgur.com/Yoz09.jpg?s=128&g=1", "display_name": "prajeesh", "link": "https://stackoverflow.com/users/723334/prajeesh"}, "edited": false, "score": 0, "creation_date": 1521613858, "post_id": 49399113, "comment_id": 85800393, "body": "Modified the associations as follows. user belongs to company. user has_one company_user, dependent: :destroy. company has_many :company_users, dependent: :destroy. company has_many :users, dependent: :destroy.    still getting deleted only from company and company users."}, {"owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 3, "creation_date": 1521614546, "post_id": 49399113, "comment_id": 85800725, "body": "I would argue that your <code>CompanyUser</code> model is useless if a user belongs to a company directly. Such join models are usually only needed in has_and_belongs_to_many situations. What&#39;s the purpose of that model in your application?"}, {"owner": {"reputation": 3587, "user_id": 4918948, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7db0f565037fbddb5a8d5a30fa1e7273?s=128&d=identicon&r=PG&f=1", "display_name": "Vrushali Pawar", "link": "https://stackoverflow.com/users/4918948/vrushali-pawar"}, "edited": false, "score": 0, "creation_date": 1521615162, "post_id": 49399113, "comment_id": 85801007, "body": "the above mentioned relationship should have has_and_belongs_to_many association"}, {"owner": {"reputation": 2985, "user_id": 1918618, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/4Lh3o.jpg?s=128&g=1", "display_name": "Manoj Monga", "link": "https://stackoverflow.com/users/1918618/manoj-monga"}, "edited": false, "score": 0, "creation_date": 1521615275, "post_id": 49399113, "comment_id": 85801066, "body": "I think first thing you need to do is, mention the clear requirements. Like, User can associate with multiple companies or not? If yes, can they be associated with multiple companies at the same time or they have joining&amp;leaving dates associated? Also, if they can associate to multiple companies, you should not remove the user completely with deletion of company. If users can associate with only one company then you should change your association to be one to many."}], "answers": [{"comments": [{"owner": {"reputation": 1588, "user_id": 723334, "user_type": "registered", "accept_rate": 49, "profile_image": "https://i.stack.imgur.com/Yoz09.jpg?s=128&g=1", "display_name": "prajeesh", "link": "https://stackoverflow.com/users/723334/prajeesh"}, "edited": false, "score": 0, "creation_date": 1521623915, "post_id": 49400388, "comment_id": 85805749, "body": "This works but has one issue. When a user is deleted, corresponding company user should also be deleted. That is why i had added has_one :company_user, dependent: :destroy . But this will railse the &#39;Stack Level too deep&#39;  error.  Any idea on how to fix this?"}], "tags": [], "owner": {"reputation": 3048, "user_id": 2374626, "user_type": "registered", "accept_rate": 52, "profile_image": "https://i.stack.imgur.com/Z78U0.jpg?s=128&g=1", "display_name": "Satishakumar Awati", "link": "https://stackoverflow.com/users/2374626/satishakumar-awati"}, "is_accepted": false, "score": 3, "last_activity_date": 1521616844, "creation_date": 1521616844, "answer_id": 49400388, "question_id": 49399113, "link": "https://stackoverflow.com/questions/49399113/has-many-through-dependent-destroy-issue/49400388#49400388", "title": "has many through, dependent destroy issue", "body": "<p>This will work and find the comments inline for changes done</p>\n\n<pre><code>class Company &lt; ActiveRecord::Base\n    has_many :users, through: :company_users #removed dependent destroy\n    has_many :company_users, dependent: :destroy \nend\n\nclass User &lt; ActiveRecord::Base\n    has_one :company_user\n    has_one :company, through: :company_user\nend\n\nclass CompanyUser &lt; ActiveRecord::Base\n    belongs_to :company\n    belongs_to :user, dependent: :destroy #added dependent destroy\nend\n</code></pre>\n\n<p>Logs</p>\n\n<pre><code>DELETE FROM \"company_users\" WHERE \"company_users\".\"id\" = ?[0m  [[\"id\", 4]]\nDELETE FROM \"users\" WHERE \"users\".\"id\" = ?[0m  [[\"id\", 4]]\nDELETE FROM \"companies\" WHERE \"companies\".\"id\" = ?  [[\"id\", 4]]\n</code></pre>\n"}], "owner": {"reputation": 1588, "user_id": 723334, "user_type": "registered", "accept_rate": 49, "profile_image": "https://i.stack.imgur.com/Yoz09.jpg?s=128&g=1", "display_name": "prajeesh", "link": "https://stackoverflow.com/users/723334/prajeesh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 83, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1521616844, "creation_date": 1521611569, "last_edit_date": 1521613099, "question_id": 49399113, "link": "https://stackoverflow.com/questions/49399113/has-many-through-dependent-destroy-issue", "title": "has many through, dependent destroy issue", "body": "<p>I am having a few issues with dependent destroy functionality.\nThe models are as follows.</p>\n\n<p>Company.rb</p>\n\n<pre><code>has_many :company_users, dependent: :destroy\nhas_many :users, through: :company_users, dependent: :destroy\n</code></pre>\n\n<p>CompanyUser.rb</p>\n\n<pre><code>belongs_to :company\nbelongs_to :user\n</code></pre>\n\n<p>User.rb</p>\n\n<pre><code>has_one :company_user, dependent: :destroy\nhas_one :company, through: :company_user\n</code></pre>\n\n<p>When i delete a company, it needs to delete the company user and ALSO THE USER.</p>\n\n<p>Currently it is deleting only the company user. Any idea on how to fix this?</p>\n"}, {"tags": ["ruby", "google-api", "google-oauth", "google-api-client", "double-click"], "answers": [{"comments": [{"owner": {"reputation": 25, "user_id": 8223442, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-2gWl3BD71Dk/AAAAAAAAAAI/AAAAAAAAAEQ/_ZoryjS0kx8/photo.jpg?sz=128", "display_name": "Phathdt", "link": "https://stackoverflow.com/users/8223442/phathdt"}, "edited": false, "score": 0, "creation_date": 1521619534, "post_id": 49400269, "comment_id": 85803253, "body": "i following the last guide <code>Service accounts</code> ``` scopes = &#39;<a href=\"https://www.googleapis.com/auth/doubleclickbidmanager\" rel=\"nofollow noreferrer\">googleapis.com/auth/doubleclickbidmanager</a>&#39; service = Google::Apis::DoubleclickbidmanagerV1::DoubleClickBidManager&zwnj;&#8203;Service.new service.authorization = Google::Auth.get_application_default(scopes)  service.download_line_items ``` but its still same error PS: i download client_secrets.json from <code>https:&#47;&#47;console.cloud.google.com&#47;apis&#47;credentials</code>"}, {"owner": {"reputation": 70965, "user_id": 1841839, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/ZyKjr.png?s=128&g=1", "display_name": "DaImTo", "link": "https://stackoverflow.com/users/1841839/daimto"}, "reply_to_user": {"reputation": 25, "user_id": 8223442, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-2gWl3BD71Dk/AAAAAAAAAAI/AAAAAAAAAEQ/_ZoryjS0kx8/photo.jpg?sz=128", "display_name": "Phathdt", "link": "https://stackoverflow.com/users/8223442/phathdt"}, "edited": false, "score": 0, "creation_date": 1521619781, "post_id": 49400269, "comment_id": 85803393, "body": "The double click api does not support service account authentication you will need to use oauth2 authentication.  As stated here <a href=\"https://developers.google.com/bid-manager/how-tos/authorizing\" rel=\"nofollow noreferrer\">developers.google.com/bid-manager/how-tos/authorizing</a>"}, {"owner": {"reputation": 25, "user_id": 8223442, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-2gWl3BD71Dk/AAAAAAAAAAI/AAAAAAAAAEQ/_ZoryjS0kx8/photo.jpg?sz=128", "display_name": "Phathdt", "link": "https://stackoverflow.com/users/8223442/phathdt"}, "edited": false, "score": 0, "creation_date": 1521620360, "post_id": 49400269, "comment_id": 85803685, "body": "@DalmTo: thank you for your information. So there is no way to use DBM API with server to server flow? I need to authenticate and call the Google API directly. There is no end user in this case :("}, {"owner": {"reputation": 70965, "user_id": 1841839, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/ZyKjr.png?s=128&g=1", "display_name": "DaImTo", "link": "https://stackoverflow.com/users/1841839/daimto"}, "reply_to_user": {"reputation": 25, "user_id": 8223442, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-2gWl3BD71Dk/AAAAAAAAAAI/AAAAAAAAAEQ/_ZoryjS0kx8/photo.jpg?sz=128", "display_name": "Phathdt", "link": "https://stackoverflow.com/users/8223442/phathdt"}, "edited": false, "score": 0, "creation_date": 1521621573, "post_id": 49400269, "comment_id": 85804308, "body": "Well if you want to access someones data you are going to have to authenticate to the user who owns the data so there is an end user."}, {"owner": {"reputation": 25, "user_id": 8223442, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-2gWl3BD71Dk/AAAAAAAAAAI/AAAAAAAAAEQ/_ZoryjS0kx8/photo.jpg?sz=128", "display_name": "Phathdt", "link": "https://stackoverflow.com/users/8223442/phathdt"}, "edited": false, "score": 0, "creation_date": 1521622254, "post_id": 49400269, "comment_id": 85804710, "body": "@DalmTo: you&#39;re right. Sorry for my bad explanation. What I&#39;m trying to do is accessing my data or another user (I have his google username and password) &#39;s data. And there is no web feature for that. Just make a call from my server directly to google API. I wonder if it is possible? Thanks."}, {"owner": {"reputation": 70965, "user_id": 1841839, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/ZyKjr.png?s=128&g=1", "display_name": "DaImTo", "link": "https://stackoverflow.com/users/1841839/daimto"}, "reply_to_user": {"reputation": 25, "user_id": 8223442, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-2gWl3BD71Dk/AAAAAAAAAAI/AAAAAAAAAEQ/_ZoryjS0kx8/photo.jpg?sz=128", "display_name": "Phathdt", "link": "https://stackoverflow.com/users/8223442/phathdt"}, "edited": false, "score": 0, "creation_date": 1521624344, "post_id": 49400269, "comment_id": 85806037, "body": "You still need to use Oauth2.  You cant use a service account.   Just save the refresh token and use it to access the api as needed"}, {"owner": {"reputation": 25, "user_id": 8223442, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-2gWl3BD71Dk/AAAAAAAAAAI/AAAAAAAAAEQ/_ZoryjS0kx8/photo.jpg?sz=128", "display_name": "Phathdt", "link": "https://stackoverflow.com/users/8223442/phathdt"}, "edited": false, "score": 0, "creation_date": 1521710684, "post_id": 49400269, "comment_id": 85850581, "body": "Hi @DalmTo, i try to Oauth2 with end user with flow at <code>https:&#47;&#47;developers.google.com&#47;bid-manager&#47;how-tos&#47;authorizin&zwnj;&#8203;g</code>  guide, then I have <code>access token</code>, then I use this token to request with gem <code>google-api-client</code> but it always return <code>You are not authorized to use DoubleClick Bid Manager API</code> Then I use <code>Google API explorer</code> and authen with Oauth2, but it return <code>You are not authorized to use DoubleClick Bid Manager API</code> too I think  my account be crazy T.T . Please help me and save my life"}, {"owner": {"reputation": 654, "user_id": 6683147, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69b3599d7eab61ae82354d60a4464703?s=128&d=identicon&r=PG&f=1", "display_name": "Gilg Him", "link": "https://stackoverflow.com/users/6683147/gilg-him"}, "edited": false, "score": 0, "creation_date": 1564412203, "post_id": 49400269, "comment_id": 101012423, "body": "I am getting an empty response using a service account. Also according to the documentation. It is possible to use a service account. I don&#39;t why it&#39;s been said here by many that you cannot? <a href=\"https://developers.google.com/identity/protocols/OAuth2ServiceAccount\" rel=\"nofollow noreferrer\">developers.google.com/identity/protocols/OAuth2ServiceAccoun&zwnj;&#8203;t</a> @DaImTo Also as it seems from that link. The service account and oauth2 aren&#39;t two separate things. You could use a service account with oauth2"}, {"owner": {"reputation": 70965, "user_id": 1841839, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/ZyKjr.png?s=128&g=1", "display_name": "DaImTo", "link": "https://stackoverflow.com/users/1841839/daimto"}, "edited": false, "score": 0, "creation_date": 1564515565, "post_id": 49400269, "comment_id": 101054471, "body": "Where exactly on that page does it state that it works with double bid?   Zero response means that your service account has no data.   Last I checked there was no way to share the data with a service account.    If you do manage to do that please let us know"}, {"owner": {"reputation": 70965, "user_id": 1841839, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/ZyKjr.png?s=128&g=1", "display_name": "DaImTo", "link": "https://stackoverflow.com/users/1841839/daimto"}, "edited": false, "score": 0, "creation_date": 1564515691, "post_id": 49400269, "comment_id": 101054544, "body": "The documentation still lists only Oauth2 for authentication methods <a href=\"https://developers.google.com/bid-manager/how-tos/authorizing\" rel=\"nofollow noreferrer\">developers.google.com/bid-manager/how-tos/authorizing</a> so I think it&#39;s safe to say service accounts are still not supported"}], "tags": [], "owner": {"reputation": 70965, "user_id": 1841839, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/ZyKjr.png?s=128&g=1", "display_name": "DaImTo", "link": "https://stackoverflow.com/users/1841839/daimto"}, "is_accepted": true, "score": 0, "last_activity_date": 1521620081, "last_edit_date": 1521620081, "creation_date": 1521616315, "answer_id": 49400269, "question_id": 49398575, "link": "https://stackoverflow.com/questions/49398575/cant-authenticate-to-doubleclick-bid-manager-api-using-a-service-account/49400269#49400269", "title": "Cant authenticate to Doubleclick bid manager Api using a service account", "body": "<p>When your application requests private data, the request must be authorized by an authenticated user who has access to that data.  Every request your application sends to the Google DoubleClick Bid Manager API must include an authorization token. The token also identifies your application to Google.</p>\n\n<p>This is what the error means by </p>\n\n<blockquote>\n  <p>\"You are not authorized to use DoubleClick Bid Manager API. </p>\n</blockquote>\n\n<p>Make sure that you include the following scope when requesting authentication of the user.</p>\n\n<blockquote>\n  <p><a href=\"https://www.googleapis.com/auth/doubleclickbidmanager\" rel=\"nofollow noreferrer\">https://www.googleapis.com/auth/doubleclickbidmanager</a></p>\n</blockquote>\n\n<p>More info can be found <a href=\"https://developers.google.com/bid-manager/how-tos/authorizing\" rel=\"nofollow noreferrer\">here</a> and there is documentation here on how to get it working with <a href=\"https://developers.google.com/api-client-library/ruby/guide/aaa_oauth\" rel=\"nofollow noreferrer\">ruby</a> you will need to alter the example there for your api as this is for calendar.</p>\n\n<p>Note about service accounts.</p>\n\n<p>Service accounts must be pre-authorized in order to work.  In the case of Google drive you can take the service account email address and share a folder on your google drive with it.  Basically you share data with the service account granting it access to the data.  Not all google apis support service account authentication.   Youtube api, Doubleclick, and blogger I think addsence or adWords as well, are a few that do not support service account authentication as there is no way to share the data with a user without them responding to the share request.</p>\n"}], "owner": {"reputation": 25, "user_id": 8223442, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-2gWl3BD71Dk/AAAAAAAAAAI/AAAAAAAAAEQ/_ZoryjS0kx8/photo.jpg?sz=128", "display_name": "Phathdt", "link": "https://stackoverflow.com/users/8223442/phathdt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1120, "favorite_count": 0, "accepted_answer_id": 49400269, "answer_count": 1, "score": 1, "last_activity_date": 1521620081, "creation_date": 1521608847, "last_edit_date": 1521619903, "question_id": 49398575, "link": "https://stackoverflow.com/questions/49398575/cant-authenticate-to-doubleclick-bid-manager-api-using-a-service-account", "title": "Cant authenticate to Doubleclick bid manager Api using a service account", "body": "<p>i write some code to connect with google api <code>Doubleclick bid manager</code> </p>\n\n<p>I download client_secrets.json at <code>https://console.cloud.google.com/apis/credentials?</code> then run some code like</p>\n\n<pre><code>require 'google/apis/doubleclickbidmanager_v1'\nrequire 'google/api_client/client_secrets'\nservice = Google::Apis::DoubleclickbidmanagerV1::DoubleClickBidManagerService.new\nservice.authorization = Google::Auth.get_application_default(['https://www.googleapis.com/auth/doubleclickbidmanager'])\nservice.download_line_items\n</code></pre>\n\n<p>it response some errors like:</p>\n\n<blockquote>\n  <p>Sending HTTP post <a href=\"https://www.googleapis.com/doubleclickbidmanager/v1/lineitems/downloadlineitems\" rel=\"nofollow noreferrer\">https://www.googleapis.com/doubleclickbidmanager/v1/lineitems/downloadlineitems</a>?\n      403\n      #https://www.googleapis.com/doubleclickbidmanager/v1/lineitems/downloadlineitems == 403 (354 bytes) 1091ms>\n      Caught error unauthorizedApiAccess: You are not authorized to use DoubleClick Bid Manager API. Please contact dbm-support@google.com.\n      Error - #</p>\n  \n  <p>Google::Apis::ClientError: unauthorizedApiAccess: You are not authorized to use DoubleClick Bid Manager API. Please contact dbm-support@google.com.\n  And when i run api at <code>https://developers.google.com/apis-explorer</code>, it return <code>\"You are not authorized to use DoubleClick Bid Manager API. Please contact dbm-support@google.com.\"</code> too\n  Some one know this errors, plz check and help me</p>\n</blockquote>\n"}, {"tags": ["ruby", "chef-infra"], "answers": [{"tags": [], "owner": {"reputation": 43208, "user_id": 78722, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cf611565f0b79abd0b3dc200ad867661?s=128&d=identicon&r=PG", "display_name": "coderanger", "link": "https://stackoverflow.com/users/78722/coderanger"}, "is_accepted": true, "score": 0, "last_activity_date": 1521609719, "creation_date": 1521609719, "answer_id": 49398720, "question_id": 49398572, "link": "https://stackoverflow.com/questions/49398572/chef-handler-exception-handles-the-error-but-will-the-chef-client-stop-running/49398720#49398720", "title": "Chef handler exception handles the error, but will the chef client stop running?", "body": "<p>No, as I mentioned in your last question the only knob we offer is <code>ignore_failure</code>. Anything more complex than that will probably require a custom resource or some other more fancy Ruby code. Handlers (both old-school error handlers and newer event handlers) only respond to events, they cannot change Chef's overall flow control.</p>\n"}], "owner": {"reputation": 5, "user_id": 9222537, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/55cdb0f64fe3e1dc444db7285dcf8747?s=128&d=identicon&r=PG&f=1", "display_name": "Anna", "link": "https://stackoverflow.com/users/9222537/anna"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 35, "favorite_count": 0, "accepted_answer_id": 49398720, "answer_count": 1, "score": 0, "last_activity_date": 1521609719, "creation_date": 1521608826, "question_id": 49398572, "link": "https://stackoverflow.com/questions/49398572/chef-handler-exception-handles-the-error-but-will-the-chef-client-stop-running", "title": "Chef handler exception handles the error, but will the chef client stop running?", "body": "<p>\"An exception handler is used to identify situations that have caused a chef-client run to fail\". But will it stop the chef-client form running? \nWhat should be done if I don't want the chef-client to stop running, in case an error has occurred. </p>\n"}, {"tags": ["ruby", "rubygems", "rvm", "filepath"], "comments": [{"owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 1, "creation_date": 1521609849, "post_id": 49398459, "comment_id": 85798804, "body": "I - as a gem user - wound prefer if I had the change do configure where the file is stored or at least have that data in my home directory. And not share its data with all other users on the same machine in the gem itself folder. Furthermore the gem&#39;s files (what I would see as its source code) should not change after download. My advice is to separate the gem from its data."}, {"owner": {"reputation": 1521, "user_id": 7177640, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/21ab719e4dfae3533a20da4f52e5c9e7?s=128&d=identicon&r=PG", "display_name": "nattfodd", "link": "https://stackoverflow.com/users/7177640/nattfodd"}, "edited": false, "score": 0, "creation_date": 1521622672, "post_id": 49398459, "comment_id": 85804982, "body": "I agree with <i>spickermann</i> - what you&#39;re going to achieve looks very inappropriate. If you&#39;re going to have some sort of the database for the gem, user should be able to set the path of that file manually, so if he re-install the gem, the data will persist. Alternatively, if you just need a temp file, you can use <code>Tempfile</code> instead."}, {"owner": {"reputation": 191, "user_id": 7993383, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cb1ae99f86d1aedeb1a1aa7940ae1916?s=128&d=identicon&r=PG&f=1", "display_name": "dtroof", "link": "https://stackoverflow.com/users/7993383/dtroof"}, "edited": false, "score": 0, "creation_date": 1521629771, "post_id": 49398459, "comment_id": 85809802, "body": "It&#39;s also worth noting that writing to the gem directory may not work in some cases, such as users running system Ruby installations where the gems were installed by root."}], "answers": [{"comments": [{"owner": {"reputation": 79, "user_id": 9526393, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-nLGkiYcBxq0/AAAAAAAAAAI/AAAAAAAAAEQ/lAoLPKsMdLA/photo.jpg?sz=128", "display_name": "Daniel Nunez", "link": "https://stackoverflow.com/users/9526393/daniel-nunez"}, "edited": false, "score": 0, "creation_date": 1521610168, "post_id": 49398629, "comment_id": 85798923, "body": "awesome will give this a try and return feedback, I saw that in .rvm and was wondering if can some how do something regex-ish but also noticed rvm saves separate folders for each ruby version. For instance if i install my gem on 2.3.3 it&#39;ll be in ~/.rvm...........ruby 2.3.3@global etc if installed on another will be that version folder might be another hurdle for this but thanks so much, will give it a go in a few minutes :)"}, {"owner": {"reputation": 79, "user_id": 9526393, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-nLGkiYcBxq0/AAAAAAAAAAI/AAAAAAAAAEQ/lAoLPKsMdLA/photo.jpg?sz=128", "display_name": "Daniel Nunez", "link": "https://stackoverflow.com/users/9526393/daniel-nunez"}, "edited": false, "score": 0, "creation_date": 1521611344, "post_id": 49398629, "comment_id": 85799295, "body": "Update: This doesn&#39;t work due to what I mentioned above <code>~&#47;.rvm&#47;gems&#47;ruby-2.3.3&#47;gems&#47;ruby_doc-2.5.0</code> that&#39;s the current path to my gem directory, I&#39;m assuming if someone only has one version of ruby this would be the file path. will remove and test, maybe can add some condition statements in there and add both file path patterns , though, i&#39;d then have to figure out the ruby <code>x.x.x</code> part \ud83d\ude2b"}, {"owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "reply_to_user": {"reputation": 79, "user_id": 9526393, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-nLGkiYcBxq0/AAAAAAAAAAI/AAAAAAAAAEQ/lAoLPKsMdLA/photo.jpg?sz=128", "display_name": "Daniel Nunez", "link": "https://stackoverflow.com/users/9526393/daniel-nunez"}, "edited": false, "score": 0, "creation_date": 1521611812, "post_id": 49398629, "comment_id": 85799492, "body": "Doesn&#39;t <code>Gem.path</code> give you the current rb version?"}, {"owner": {"reputation": 79, "user_id": 9526393, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-nLGkiYcBxq0/AAAAAAAAAAI/AAAAAAAAAEQ/lAoLPKsMdLA/photo.jpg?sz=128", "display_name": "Daniel Nunez", "link": "https://stackoverflow.com/users/9526393/daniel-nunez"}, "edited": false, "score": 0, "creation_date": 1521612619, "post_id": 49398629, "comment_id": 85799850, "body": "hmm weird... yea sorry i pryd in there giving what i want but didn&#39;t work , let me clean this up and retry .. back with feedback and current code"}, {"owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "reply_to_user": {"reputation": 79, "user_id": 9526393, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-nLGkiYcBxq0/AAAAAAAAAAI/AAAAAAAAAEQ/lAoLPKsMdLA/photo.jpg?sz=128", "display_name": "Daniel Nunez", "link": "https://stackoverflow.com/users/9526393/daniel-nunez"}, "edited": false, "score": 0, "creation_date": 1521613064, "post_id": 49398629, "comment_id": 85800032, "body": "No worries ... many programs create a hidden folder in the home directory which you cann get with <code>Dir.home</code>. I personally have like 20 of these hidden folders created with various programs."}, {"owner": {"reputation": 79, "user_id": 9526393, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-nLGkiYcBxq0/AAAAAAAAAAI/AAAAAAAAAEQ/lAoLPKsMdLA/photo.jpg?sz=128", "display_name": "Daniel Nunez", "link": "https://stackoverflow.com/users/9526393/daniel-nunez"}, "edited": false, "score": 0, "creation_date": 1521613096, "post_id": 49398629, "comment_id": 85800050, "body": "Update: ok so I noticed that was targeting the global folder and my gem is in the regular folder .. I changed to <code>Gem.path[0]</code> and it worked :) but now to see if this persists cross-platform. Either way thanks , giving me a lot to play with :) i&#39;ll do some testing and keep you updated"}], "tags": [], "owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "is_accepted": true, "score": 0, "last_activity_date": 1521609177, "creation_date": 1521609177, "answer_id": 49398629, "question_id": 49398459, "link": "https://stackoverflow.com/questions/49398459/is-it-possible-to-have-my-gem-write-to-its-root-gem-directory/49398629#49398629", "title": "Is it possible to have my gem write to it&#39;s root gem directory?", "body": "<p>One way you could get the gem folder is like so:</p>\n\n<pre><code>def gem_folder(gem_name, version)\n  \"#{Gem.path[1]}/gems/#{gem_name}-#{version}\"\nend\n</code></pre>\n\n<p>You would need to change the version each time you change the gem, but you're likely already doing that. </p>\n\n<p>Unfortunately I have no guarantee that this works in a cross-platform way. </p>\n\n<p>Example:</p>\n\n<pre><code>gem_folder('pry', '0.11.3')\n# =&gt; \"/Users/max/.rbenv/versions/2.3.1/lib/ruby/gems/2.3.0/gems/pry-0.11.3\"\n\n# check find_files as a reference\nGem.find_files(\"pry\")[0]\n# =&gt; \"/Users/max/.rbenv/versions/2.3.1/lib/ruby/gems/2.3.0/gems/pry-0.11.3/lib/pry.rb\"\n</code></pre>\n\n<p>You can hard code the gem name and version for your gem. </p>\n"}], "owner": {"reputation": 79, "user_id": 9526393, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-nLGkiYcBxq0/AAAAAAAAAAI/AAAAAAAAAEQ/lAoLPKsMdLA/photo.jpg?sz=128", "display_name": "Daniel Nunez", "link": "https://stackoverflow.com/users/9526393/daniel-nunez"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 139, "favorite_count": 0, "accepted_answer_id": 49398629, "answer_count": 1, "score": 0, "last_activity_date": 1521609177, "creation_date": 1521608100, "last_edit_date": 1521608568, "question_id": 49398459, "link": "https://stackoverflow.com/questions/49398459/is-it-possible-to-have-my-gem-write-to-its-root-gem-directory", "title": "Is it possible to have my gem write to it&#39;s root gem directory?", "body": "<p>I'm trying to improve my gem's favorites feature by writing to a file included in the gem. My current version works but it requires that the user have the created file in there current working directory for it to work. </p>\n\n<p>I'm currently using <code>FileUtils</code> to write the file but have no clue if 1. this is even possible thinking maybe will have permission issues and 2. if it is possible how to have the path target successfully across different platforms and envs.</p>\n\n<p>Current Code: In my executable</p>\n\n<pre><code>#creator    \nif !File.exist?('usr')\n\n  FileUtils::mkdir 'usr'\n\n  FileUtils::touch 'usr/favorites.txt'\n\nend\n\n\n#writer\nFile.open(\"../ruby_doc_favorites.txt\", \"a\"){|l| l.puts \"some string\"}\n</code></pre>\n\n<p>I would like something like ...</p>\n\n<pre><code>File.open(\"[dynamic_path_to_gem_directory]\", \"a\"){|l| l.puts \"some string\"}\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby"], "answers": [{"tags": [], "owner": {"reputation": 3048, "user_id": 2374626, "user_type": "registered", "accept_rate": 52, "profile_image": "https://i.stack.imgur.com/Z78U0.jpg?s=128&g=1", "display_name": "Satishakumar Awati", "link": "https://stackoverflow.com/users/2374626/satishakumar-awati"}, "is_accepted": false, "score": 4, "last_activity_date": 1521613379, "last_edit_date": 1521613379, "creation_date": 1521612826, "answer_id": 49399425, "question_id": 49398402, "link": "https://stackoverflow.com/questions/49398402/nomethod-error-why-am-i-getting-this-error/49399425#49399425", "title": "NoMethod Error - Why am I getting this error?", "body": "<p>You are using <code>form_for</code> which directly maps html form to object <code>@genre</code>, so rails expects either below one condition to be met</p>\n\n<ol>\n<li><code>genres</code> column in genres table</li>\n<li><code>genres</code> attr_accessor in <code>Genre.rb</code> model.</li>\n<li>instance method by name <code>genres</code> in <code>Genre.rb</code> model.</li>\n</ol>\n\n<p>In your case all three missing.</p>\n\n<p>This line causing the issue</p>\n\n<pre><code>&lt;%= f.input :genres, required: true, input_html: { class: \"input\"}, wrapper: false, label_html: { class:\"label\" } %&gt;\n</code></pre>\n\n<p>I hope it clarifies your issue to some level. Better you provide more details on what you are trying to achieve, it helps everyone to answer in better way.</p>\n\n<p>One thing for sure there is no logic in having <code>genres</code> input field in genre form. </p>\n"}], "owner": {"reputation": 27, "user_id": 9195010, "user_type": "registered", "profile_image": "https://graph.facebook.com/10211061732518982/picture?type=large", "display_name": "Jasmine Anderson", "link": "https://stackoverflow.com/users/9195010/jasmine-anderson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 45, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1521613379, "creation_date": 1521607831, "last_edit_date": 1521608168, "question_id": 49398402, "link": "https://stackoverflow.com/questions/49398402/nomethod-error-why-am-i-getting-this-error", "title": "NoMethod Error - Why am I getting this error?", "body": "<p><a href=\"https://i.stack.imgur.com/b1sdC.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/b1sdC.jpg\" alt=\"Why am I getting this error message?\"></a></p>\n\n<p>This is my Genre controller code: </p>\n\n<pre><code>class GenresController &lt; ApplicationController\n  before_action :set_genre, only: [:show, :edit, :update, :destroy]\n  before_action :authenticate_user!, except: [:index, :show]\n\n\n\n\n    def index\n        @genres = Genre.all.order(\"created_at desc\")\n      end\n\n\n      def show\n      end\n\n      def new\n        @genre = current_user.genres.build\n      end\n\n      def edit\n      end\n\n\n      def create\n        @genre = current_user.genres.build(genre_params)\n\n        respond_to do |format|\n          if @genre.save\n            format.html { redirect_to @genre, notice: 'Genre was successfully created.' }\n            format.json { render :show, status: :created, location: @genre }\n          else\n            format.html { render :new }\n            format.json { render json: @genre.errors, status: :unprocessable_entity }\n          end\n        end\n      end\n\n  def update\n    respond_to do |format|\n      if @genre.update(genre_params)\n        format.html { redirect_to @genre, notice: 'Genre was successfully updated.' }\n        format.json { render :show, status: :ok, location: @genre }\n      else\n        format.html { render :edit }\n        format.json { render json: @genre.errors, status: :unprocessable_entity }\n      end\n    end\n  end\n\n\n  def destroy\n    @genre.destroy\n    respond_to do |format|\n      format.html { redirect_to genres_url, notice: 'Genre was successfully destroyed.' }\n      format.json { head :no_content }\n    end\n  end\n\n  private\n\n      @genre = Genre.find(params[:id])\n    end\n\n\n    def genre_params\n      params.require(:genre).permit(:artist, :album, :songs, :price)\n    end\nend\n</code></pre>\n\n<p>And this is my form code : \n    \n      </p>\n\n<pre><code>&lt;%= simple_form_for @genre, html: { multipart: true } do |f| %&gt;\n  &lt;%= f.error_notification %&gt;\n\n    &lt;div class=\"columns\"&gt;\n\n      &lt;div class=\"field column is-9\"&gt;\n        &lt;div class=\"control\"&gt;\n          &lt;%= f.input :genres, required: true, input_html: { class: \"input\"}, wrapper: false, label_html: { class:\"label\" } %&gt;\n        &lt;/div&gt;\n      &lt;/div&gt;\n\n      &lt;div class=\"field column\"&gt;\n        &lt;div class=\"control\"&gt;\n          &lt;%= f.input :artist, required: true, input_html: { class:\"input\", maxlength: 7  }, wrapper: false, label_html: { class:\"label\" } %&gt;\n        &lt;/div&gt;\n      &lt;/div&gt;\n\n    &lt;/div&gt;\n\n    &lt;div class=\"field\"&gt;\n      &lt;div class=\"control\"&gt;\n        &lt;%= f.input :songs, required: true, input_html: { class:\"input\" }, wrapper: false, label_html: { class:\"label\" } %&gt;\n      &lt;/div&gt;\n    &lt;/div&gt;\n\n    &lt;div class=\"field\"&gt;\n      &lt;div class=\"control\"&gt;\n        &lt;%= f.input :description, required: true, input_html: { class:\"textarea\" }, wrapper: false, label_html: { class:\"label\" } %&gt;\n      &lt;/div&gt;\n    &lt;/div&gt;\n\n    &lt;div class=\"field\"&gt;\n      &lt;div class=\"control\"&gt;\n        &lt;label class=\"label\"&gt;Add images&lt;/label&gt;\n          &lt;div class=\"file\"&gt;\n          &lt;label class=\"file-label\"&gt;\n            &lt;%= f.input :image, as: :file, input_html: { class:\"file-input instrument-image\" }, label: false, wrapper: false %&gt;\n              &lt;span class=\"file-cta\"&gt;\n                &lt;span class=\"file-icon\"&gt;&lt;i class=\"fa fa-upload\"&gt;&lt;/i&gt;&lt;/span&gt;\n                &lt;span class=\"file-label\"&gt;Choose a file\u2026&lt;/span&gt;\n              &lt;/span&gt;\n          &lt;/label&gt;\n          &lt;/div&gt;\n        &lt;/div&gt;\n      &lt;/div&gt;\n      &lt;output id=\"list\"&gt;&lt;/output&gt;\n    &lt;hr /&gt;\n\n     &lt;div class=\"field column\"&gt;\n        &lt;div class=\"control\"&gt;\n          &lt;%= f.input :price, required: true, input_html: { class:\"input\", maxlength: 7  }, wrapper: false, label_html: { class:\"label\" } %&gt;\n        &lt;/div&gt;\n      &lt;/div&gt;\n\n    &lt;div class=\"field is-grouped\"&gt;\n      &lt;div class=\"control\"&gt;\n        &lt;%= f.button :submit, class: 'button is-warning' %&gt;\n        &lt;%= link_to 'Cancel', genres_path, class:'button is-light' %&gt;\n      &lt;/div&gt;\n    &lt;/div&gt;\n\n  &lt;% end %&gt;\n</code></pre>\n\n<p>\n</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 4690, "user_id": 1937435, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/YyN37.jpg?s=128&g=1", "display_name": "Josh Brody", "link": "https://stackoverflow.com/users/1937435/josh-brody"}, "edited": false, "score": 0, "creation_date": 1521606601, "post_id": 49398175, "comment_id": 85797865, "body": "<code>result = &quot; &quot;</code> evaluates to true, which is your problem with <code>until result || input == &#39;quit&#39; .. end</code>"}], "answers": [{"tags": [], "owner": {"reputation": 545, "user_id": 7146589, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/0f3b4cadf837952a1fbc16191d22c2bf?s=128&d=identicon&r=PG&f=1", "display_name": "iceveda06", "link": "https://stackoverflow.com/users/7146589/iceveda06"}, "is_accepted": false, "score": 0, "last_activity_date": 1521607902, "creation_date": 1521607902, "answer_id": 49398420, "question_id": 49398175, "link": "https://stackoverflow.com/questions/49398175/my-ruby-code-does-not-seem-to-be-working/49398420#49398420", "title": "My ruby code does not seem to be working", "body": "<p>tristan,\nyou should change <code>result = \" \"</code> to <code>result = gets.chomp</code> or remove <code>result = \" \"</code> and use <code>result = gets.chomp</code> inside your until statement.  Basically fix what Josh is mentioning in the comments</p>\n"}, {"tags": [], "owner": {"reputation": 7224, "user_id": 448934, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TXtux.jpg?s=128&g=1", "display_name": "Pascal", "link": "https://stackoverflow.com/users/448934/pascal"}, "is_accepted": false, "score": 0, "last_activity_date": 1521624692, "creation_date": 1521624692, "answer_id": 49402571, "question_id": 49398175, "link": "https://stackoverflow.com/questions/49398175/my-ruby-code-does-not-seem-to-be-working/49402571#49402571", "title": "My ruby code does not seem to be working", "body": "<p>There are several Errors in your script. I modified it so it is running:</p>\n\n<pre><code>puts \"Say something:\"\ninput = gets.chomp\nputs \"you just told me #{input}\"\n\nwhile input != \"quit\"\n  puts \"Say something:\"\n  input = gets.chomp\n  if input == \"quit\"\n    puts \"Alright Goodbye\"\n  else\n    puts \"I heard #{input}\"\n  end\nend\n</code></pre>\n\n<ul>\n<li>No need to have two separate variables (<code>result</code>, <code>input</code>) for user input, unless you need both of them</li>\n<li>You used <code>results</code> instead of <code>result</code></li>\n<li>In ruby everything except <code>nil</code> and <code>false</code> is considered <code>true</code>. So <code>\" \"</code>, but also empty string <code>\" \"</code> will be true.</li>\n</ul>\n"}, {"tags": [], "owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "is_accepted": false, "score": 0, "last_activity_date": 1521624948, "creation_date": 1521624948, "answer_id": 49402678, "question_id": 49398175, "link": "https://stackoverflow.com/questions/49398175/my-ruby-code-does-not-seem-to-be-working/49402678#49402678", "title": "My ruby code does not seem to be working", "body": "<p>Did you mean \"until result OR input equal \"quit\" (either of them)\"? \nIf so, it's a classic rookie mistake. It needs to be written like this:</p>\n\n<pre><code>result == 'quit' || input == 'quit'\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2322, "user_id": 3088748, "user_type": "registered", "accept_rate": 63, "profile_image": "https://graph.facebook.com/544821277/picture?type=large", "display_name": "AJFaraday", "link": "https://stackoverflow.com/users/3088748/ajfaraday"}, "is_accepted": false, "score": 0, "last_activity_date": 1521625200, "creation_date": 1521625200, "answer_id": 49402774, "question_id": 49398175, "link": "https://stackoverflow.com/questions/49398175/my-ruby-code-does-not-seem-to-be-working/49402774#49402774", "title": "My ruby code does not seem to be working", "body": "<p>I can see two issues here.</p>\n\n<p>You're never defining something called <code>results</code>, only <code>result</code>. This will probably throw an error saying that <code>results</code> is undefined.</p>\n\n<p>Also, result doesn't seem to add anything, as your program is only using the most recently input piece of information, I'd simplify it to just have one variable named <code>input</code>. </p>\n\n<pre><code>input = gets.chomp\nprint \"you just told me #{input}\"\n\nuntil input == \"quit\"\n  input = gets.chomp\n  if input == \"quit\"\n    puts \"Alright Goodbye\"\n  else\n    puts \"I heard #{input}\"\n  end\nend\n</code></pre>\n\n<p>Also, the <code>until</code> block will move on to the end of your program when <code>input</code> equals 'quit', so you don't need to also check the same condition in your if block. You could just put the result of that condition after the until block.</p>\n\n<pre><code>input = gets.chomp\nuntil input == \"quit\"\n  puts \"I heard #{input}\"\n  input = gets.chomp\nend\nputs \"Alright, Goodbye!\"\n</code></pre>\n\n<p>Basically, you're putting in far more code than you need for this one check.</p>\n\n<p>I hope this helps. Keep learning to code, it's such a rewarding thing to do. :)</p>\n"}], "owner": {"reputation": 71, "user_id": 8472482, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f7600316dfbe1e6b2905a2b979d1093?s=128&d=identicon&r=PG&f=1", "display_name": "tristan lim", "link": "https://stackoverflow.com/users/8472482/tristan-lim"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 54, "favorite_count": 0, "answer_count": 4, "score": -1, "last_activity_date": 1521625200, "creation_date": 1521606298, "question_id": 49398175, "link": "https://stackoverflow.com/questions/49398175/my-ruby-code-does-not-seem-to-be-working", "title": "My ruby code does not seem to be working", "body": "<p>Hi everyone I am having some problems with my code. It is unable to be able to work when i add in the code below.</p>\n\n<pre><code>until result || input == \"quit\" \n</code></pre>\n\n<p>However when i remove the input for that line the code works perfectly okay.</p>\n\n<pre><code>input = gets.chomp\nprint \"you just told me #{input}\"\nresult = \" \"\n\nuntil result || input == \"quit\"\n  result = gets.chomp\n  if result == \"quit\"\n    puts \"Alright Goodbye\"\n  else\n    puts \"I heard #{results}\"\n  end\nend\n</code></pre>\n\n<p>Thank you so much for your help:)</p>\n"}, {"tags": ["ruby", "class", "methods"], "answers": [{"tags": [], "owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "is_accepted": false, "score": 3, "last_activity_date": 1521606078, "creation_date": 1521606078, "answer_id": 49398142, "question_id": 49397993, "link": "https://stackoverflow.com/questions/49397993/method-undefined-error-ruby/49398142#49398142", "title": "Method undefined error - Ruby", "body": "<p>Right here you define an <em>instance method</em></p>\n\n<pre><code>class Num_Part\n\n  def Particiones n \n</code></pre>\n\n<p>You call it like a <em>class method</em>:</p>\n\n<pre><code>Num_Part.Particiones(n)\n</code></pre>\n\n<p>So, either change the definition to <code>def self.Particiones n</code> or change the call to <code>Num_Part.new.Partitiones(n)</code>.</p>\n\n<p>Just a side note, your names don't follow the conventions. For example methods are usually all lowercase</p>\n"}], "owner": {"reputation": 1, "user_id": 9526283, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/103f6f66cfe8392655acaa9bf7817f1c?s=128&d=identicon&r=PG&f=1", "display_name": "Dani", "link": "https://stackoverflow.com/users/9526283/dani"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 31, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1521659445, "creation_date": 1521605116, "last_edit_date": 1521659445, "question_id": 49397993, "link": "https://stackoverflow.com/questions/49397993/method-undefined-error-ruby", "title": "Method undefined error - Ruby", "body": "<p>Here is the code of a number partitions and in the last section I have  trouble, because I can\u00b4t get the number parted due to method error.</p>\n\n<pre><code>class Num_Part\n\n  def Particiones n     //method for the number partititons\n    if n == 1\n      return [[1]]\n    elsif n &lt; 1\n      return [[]]\n    end\n    Particiones(n)\n    listaparticiones = []\n    for k in (n)..downto(0)\n      cola= Particiones(n) - k\n      for x in cola\n        particion= [k] + x\n      end\n      listaparticiones &lt;&lt; particion\n    end\n    return listaparticiones\n  end\n\nend\n\nputs \"Ingrese el Valor de N: \\n\" // this is where i ask for the value or the \nn =Integer(gets.chomp)            //number to be parted\nlista = Particiones(n)\n\n    print \"\\n cantidad de particiones: \" +String(lista.size)\n\nlista.each do |i|\n  print [i]\nend\nobj = Num_Part.new\nobj.Particiones(n)\n</code></pre>\n"}, {"tags": ["ruby", "documentation", "rubymine", "yard"], "comments": [{"owner": {"reputation": 3523, "user_id": 9043475, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FNxvn.jpg?s=128&g=1", "display_name": "Rajagopalan", "link": "https://stackoverflow.com/users/9043475/rajagopalan"}, "edited": false, "score": 1, "creation_date": 1533358484, "post_id": 49397769, "comment_id": 90327870, "body": "Actually these kind problem you can report to JetBrain."}, {"owner": {"reputation": 2125, "user_id": 1446543, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/934816c610f53abdab5f26510478bc24?s=128&d=identicon&r=PG", "display_name": "ForeverZer0", "link": "https://stackoverflow.com/users/1446543/foreverzer0"}, "reply_to_user": {"reputation": 3523, "user_id": 9043475, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FNxvn.jpg?s=128&g=1", "display_name": "Rajagopalan", "link": "https://stackoverflow.com/users/9043475/rajagopalan"}, "edited": false, "score": 0, "creation_date": 1533359341, "post_id": 49397769, "comment_id": 90328001, "body": "Always been to lazy to do this, but actually just did :)  JetBrains actually is pretty good on accepting and implementing feedback and suggestions, so I&#39;ll keep my fingers crossed for future releases."}, {"owner": {"reputation": 3523, "user_id": 9043475, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FNxvn.jpg?s=128&g=1", "display_name": "Rajagopalan", "link": "https://stackoverflow.com/users/9043475/rajagopalan"}, "edited": false, "score": 0, "creation_date": 1533359440, "post_id": 49397769, "comment_id": 90328016, "body": "thanks. I am using RubyMine as well, Love it!"}], "owner": {"reputation": 2125, "user_id": 1446543, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/934816c610f53abdab5f26510478bc24?s=128&d=identicon&r=PG", "display_name": "ForeverZer0", "link": "https://stackoverflow.com/users/1446543/foreverzer0"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 31, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1521603641, "creation_date": 1521603641, "question_id": 49397769, "link": "https://stackoverflow.com/questions/49397769/rubymine-suppression-comments-ignored-by-yard", "title": "RubyMine suppression comments ignored by YARD?", "body": "<p>I have been writing some Ruby code using RubyMine, which I have really learned to like, and have been using YARD for documentation. </p>\n\n<p>I have come across a minor bothersome issue, that I have been unable to find an elegant solution for. RubyMine supports suppression of specific inspections on a \"per expression\", \"per method\", etc. basis, which comes in very handy for certain circumstances, especially for how dynamic Ruby can be.</p>\n\n<p>My problem is when I want to suppress certain inspections on the method level, but these comments show up in my documentation with YARD, as it to reads comments to parse its documentation. Usually I can find a solution by suppressing the inspection within the method on the expression, but I am working on a wrapper that implements callbacks, and uses method stubs with arguments that \"appear\" to be unused, but are meant to be aliased by the end user. </p>\n\n<p>I really don't want to turn off inspection on the project, or even the class level, and I strongly dislike the warnings being there. Just wondering if anyone else has come up with a solution to this little irritation.</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 5141, "user_id": 193980, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/aafa8848c4b764f080b1b31a51eab73d?s=128&d=identicon&r=PG", "display_name": "Phlip", "link": "https://stackoverflow.com/users/193980/phlip"}, "edited": false, "score": 0, "creation_date": 1521603380, "post_id": 49397680, "comment_id": 85797060, "body": "Shelling to the command line utility <code>sendmail</code> would be pretty easy. But have you googled for <code>ruby smtp</code> yet?"}, {"owner": {"reputation": 61, "user_id": 8212516, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0a46fcf100e4fc354aef50b62e4c8d2f?s=128&d=identicon&r=PG&f=1", "display_name": "Robin", "link": "https://stackoverflow.com/users/8212516/robin"}, "reply_to_user": {"reputation": 5141, "user_id": 193980, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/aafa8848c4b764f080b1b31a51eab73d?s=128&d=identicon&r=PG", "display_name": "Phlip", "link": "https://stackoverflow.com/users/193980/phlip"}, "edited": false, "score": 0, "creation_date": 1521603557, "post_id": 49397680, "comment_id": 85797103, "body": "you mean Net::Http?"}, {"owner": {"reputation": 5141, "user_id": 193980, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/aafa8848c4b764f080b1b31a51eab73d?s=128&d=identicon&r=PG", "display_name": "Phlip", "link": "https://stackoverflow.com/users/193980/phlip"}, "edited": false, "score": 0, "creation_date": 1521604151, "post_id": 49397680, "comment_id": 85797237, "body": "No; SMTP is the acronym for the outbound email protocol - Simple Mail Transfer Protocol. When asking such a minimal question here, you should be prepared to back up your question with web searches for your topic."}, {"owner": {"reputation": 61, "user_id": 8212516, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0a46fcf100e4fc354aef50b62e4c8d2f?s=128&d=identicon&r=PG&f=1", "display_name": "Robin", "link": "https://stackoverflow.com/users/8212516/robin"}, "reply_to_user": {"reputation": 5141, "user_id": 193980, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/aafa8848c4b764f080b1b31a51eab73d?s=128&d=identicon&r=PG", "display_name": "Phlip", "link": "https://stackoverflow.com/users/193980/phlip"}, "edited": false, "score": 0, "creation_date": 1521638855, "post_id": 49397680, "comment_id": 85816322, "body": "@philip. Thanks for the information. Yeah, I did but was a little bit confused. I will make sure from next time."}], "answers": [{"tags": [], "owner": {"reputation": 7224, "user_id": 448934, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TXtux.jpg?s=128&g=1", "display_name": "Pascal", "link": "https://stackoverflow.com/users/448934/pascal"}, "is_accepted": false, "score": 0, "last_activity_date": 1521614589, "creation_date": 1521614589, "answer_id": 49399840, "question_id": 49397680, "link": "https://stackoverflow.com/questions/49397680/send-an-email-from-a-plain-ruby-script/49399840#49399840", "title": "send an email from a plain ruby script", "body": "<p>You could shell out to the command line as suggested by Philip. But of course there is also Gem for sending mails: <a href=\"https://github.com/mikel/mail\" rel=\"nofollow noreferrer\">https://github.com/mikel/mail</a></p>\n\n<p>From the README of this gem:</p>\n\n<pre><code>mail = Mail.new do\n  from     'me@test.lindsaar.net'\n  to       'you@test.lindsaar.net'\n  subject  'Here is the image you wanted'\n  body     File.read('body.txt')\n  add_file :filename =&gt; 'somefile.png', :content =&gt; File.read('/somefile.png')\nend\n\nmail.deliver!\n</code></pre>\n"}], "owner": {"reputation": 61, "user_id": 8212516, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0a46fcf100e4fc354aef50b62e4c8d2f?s=128&d=identicon&r=PG&f=1", "display_name": "Robin", "link": "https://stackoverflow.com/users/8212516/robin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 355, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1521614589, "creation_date": 1521603091, "question_id": 49397680, "link": "https://stackoverflow.com/questions/49397680/send-an-email-from-a-plain-ruby-script", "title": "send an email from a plain ruby script", "body": "<p>I am trying to write a ruby script where it sends emails to the users. With the rails framework, I am able to send it but can we do it with just plain ruby script</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 694, "user_id": 7956790, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3qtsm.jpg?s=128&g=1", "display_name": "Kox", "link": "https://stackoverflow.com/users/7956790/kox"}, "edited": false, "score": 0, "creation_date": 1521622248, "post_id": 49397288, "comment_id": 85804705, "body": "Not sure why would you do that on the server.. Or you are talking about encoding it on the frontend in js?"}, {"owner": {"reputation": 21877, "user_id": 131227, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/60e3c03e227b84e2898c29fd711cae5b?s=128&d=identicon&r=PG", "display_name": "z5h", "link": "https://stackoverflow.com/users/131227/z5h"}, "reply_to_user": {"reputation": 694, "user_id": 7956790, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3qtsm.jpg?s=128&g=1", "display_name": "Kox", "link": "https://stackoverflow.com/users/7956790/kox"}, "edited": false, "score": 0, "creation_date": 1521634468, "post_id": 49397288, "comment_id": 85813034, "body": "@kox it&#39;s what I need. Thanks."}], "answers": [{"tags": [], "owner": {"reputation": 5437, "user_id": 1257094, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/Ob6MH.jpg?s=128&g=1", "display_name": "milgner", "link": "https://stackoverflow.com/users/1257094/milgner"}, "is_accepted": true, "score": 1, "last_activity_date": 1549628911, "creation_date": 1549628911, "answer_id": 54592499, "question_id": 49397288, "link": "https://stackoverflow.com/questions/49397288/how-do-i-create-a-properly-encoded-multipart-form-data-string-in-ruby-rails/54592499#54592499", "title": "How do I create a properly encoded multipart/form-data string in Ruby/Rails?", "body": "<p>After seeing many questions like this in forums all over the web back up to 2008, I finally found the solution:</p>\n\n<pre><code>Rack::Test::Utils.build_multipart({foo: 'bar'}, true, true)\n</code></pre>\n\n<p>The first argument is for the data, the second to specify whether it's the first multipart and the last - and most important - is to force it to use multipart even for parameters that don't strictly require it (for example because there's no file upload happening).</p>\n"}], "owner": {"reputation": 21877, "user_id": 131227, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/60e3c03e227b84e2898c29fd711cae5b?s=128&d=identicon&r=PG", "display_name": "z5h", "link": "https://stackoverflow.com/users/131227/z5h"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 181, "favorite_count": 0, "accepted_answer_id": 54592499, "answer_count": 1, "score": 1, "last_activity_date": 1549628911, "creation_date": 1521600349, "question_id": 49397288, "link": "https://stackoverflow.com/questions/49397288/how-do-i-create-a-properly-encoded-multipart-form-data-string-in-ruby-rails", "title": "How do I create a properly encoded multipart/form-data string in Ruby/Rails?", "body": "<p>Given a Hash of <code>string =&gt; string</code>, and <code>string =&gt; file</code> entries, how do I create a multipart/form-data string?</p>\n"}, {"tags": ["ruby", "csv"], "answers": [{"tags": [], "owner": {"reputation": 9971, "user_id": 8255744, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de22299534b5a8ed244ee8ff4aa6c481?s=128&d=identicon&r=PG&f=1", "display_name": "Simple Lime", "link": "https://stackoverflow.com/users/8255744/simple-lime"}, "is_accepted": true, "score": 4, "last_activity_date": 1521601009, "creation_date": 1521601009, "answer_id": 49397379, "question_id": 49397185, "link": "https://stackoverflow.com/questions/49397185/how-to-add-a-custom-convert-to-ruby-csv/49397379#49397379", "title": "How to add a custom convert to ruby csv?", "body": "<p>You can pass the same options to <a href=\"http://ruby-doc.org/stdlib/libdoc/csv/rdoc/CSV.html#method-c-parse\" rel=\"nofollow noreferrer\"><code>parse</code></a> that you can pass to <code>new</code>, and with <a href=\"http://ruby-doc.org/stdlib/libdoc/csv/rdoc/CSV.html#method-c-new\" rel=\"nofollow noreferrer\"><code>new</code></a> you can pass in an array of converters, which can be the name of one of the built-in converters, or a lambda:</p>\n\n<pre><code>table = CSV.parse(csv_data, headers: true, converters: [\n  :integer,\n  -&gt; field, info { 'Credit' == info.header &amp;&amp; field.empty? ? 0 : field },\n  -&gt; field, info { 'Debit' == info.header &amp;&amp; field.empty? ? 0 : field },\n])\n\np table # =&gt; #&lt;CSV::Table mode:col_or_row row_count:2&gt;\nputs table[0]['Debit'] # =&gt; 10\nputs table[0]['Credit'] # =&gt; 0\n</code></pre>\n"}], "owner": {"reputation": 133, "user_id": 6732679, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8306ae971f7d8ae53573c645f361101d?s=128&d=identicon&r=PG", "display_name": "Sanjeev Singh", "link": "https://stackoverflow.com/users/6732679/sanjeev-singh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 420, "favorite_count": 0, "accepted_answer_id": 49397379, "answer_count": 1, "score": 2, "last_activity_date": 1521601009, "creation_date": 1521599509, "question_id": 49397185, "link": "https://stackoverflow.com/questions/49397185/how-to-add-a-custom-convert-to-ruby-csv", "title": "How to add a custom convert to ruby csv?", "body": "<p>Consider a CSV file like below. I would like to change the Credit/Debit field to 0 if they are empty strings and then do some processing. </p>\n\n<p>The roundabout way that I came up with seems inefficient since I read in the csv file, apply the converter and then convert it to CSV::Table for processing. Is there a way to directly apply the converter to parse method ?</p>\n\n<p>For example:</p>\n\n<pre><code>csv_data = &lt;&lt;_\nDescription,Debit,Credit\nEating Out,10,\"\"\n_\ncsv = CSV.new(csv_data, headers: true, converters: :integer)\ncsv.convert do |field, info|\n    if info.index == 1\n        field == \"\" ? 0 : field\n    end\n    if info.index == 2\n        field == \"\" ? 0 : field\n    end\nend\n\ntable = CSV::Table.new(csv.to_a)  #Seems wrong to convert to array\nputs table[0]['Debit']   #10\nputs table[0]['Credit']  #0\n</code></pre>\n"}, {"tags": ["arrays", "ruby", "hash", "iteration"], "comments": [{"owner": {"reputation": 5141, "user_id": 193980, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/aafa8848c4b764f080b1b31a51eab73d?s=128&d=identicon&r=PG", "display_name": "Phlip", "link": "https://stackoverflow.com/users/193980/phlip"}, "edited": false, "score": 0, "creation_date": 1521594074, "post_id": 49396478, "comment_id": 85794804, "body": "Could you edit your post and add more rationale. Why did key3 and key4 get concatenated when key1 and key2 did not, for example?"}, {"owner": {"reputation": 39, "user_id": 2955918, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69e157a96796f5b05d6ef071d9bd03e9?s=128&d=identicon&r=PG&f=1", "display_name": "twenty20", "link": "https://stackoverflow.com/users/2955918/twenty20"}, "reply_to_user": {"reputation": 5141, "user_id": 193980, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/aafa8848c4b764f080b1b31a51eab73d?s=128&d=identicon&r=PG", "display_name": "Phlip", "link": "https://stackoverflow.com/users/193980/phlip"}, "edited": false, "score": 0, "creation_date": 1521594756, "post_id": 49396478, "comment_id": 85794976, "body": "Thanks, I added some extra text at the end"}], "answers": [{"comments": [{"owner": {"reputation": 39, "user_id": 2955918, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69e157a96796f5b05d6ef071d9bd03e9?s=128&d=identicon&r=PG&f=1", "display_name": "twenty20", "link": "https://stackoverflow.com/users/2955918/twenty20"}, "edited": false, "score": 0, "creation_date": 1521599684, "post_id": 49397080, "comment_id": 85796204, "body": "Ah slice_when and slice_before, thanks. Yes, the key1 is always at the start of the sequence, followed by key2 and then key3 and key4, where key3 and key4 can repeat any number of times in any single key1 starting sequence."}], "tags": [], "owner": {"reputation": 9971, "user_id": 8255744, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de22299534b5a8ed244ee8ff4aa6c481?s=128&d=identicon&r=PG&f=1", "display_name": "Simple Lime", "link": "https://stackoverflow.com/users/8255744/simple-lime"}, "is_accepted": true, "score": 2, "last_activity_date": 1521599383, "last_edit_date": 1521599383, "creation_date": 1521598669, "answer_id": 49397080, "question_id": 49396478, "link": "https://stackoverflow.com/questions/49396478/ruby-iterate-over-array-of-irregularly-repeating-hashes/49397080#49397080", "title": "Ruby - iterate over array of irregularly repeating hashes", "body": "<p>If the hashes repeat after all the <code>key3</code> and <code>key4</code>, then <code>key1</code> will always be the first key, so we can use that and the <a href=\"http://ruby-doc.org/core-2.5.0/Enumerable.html#method-i-slice_before\" rel=\"nofollow noreferrer\"><code>slice_before</code></a> method on arrays to split the array into the proper groupings:</p>\n\n<pre><code>output = input.slice_before { |hash| hash.has_key?('key1') }\n</code></pre>\n\n<p>If the condition for a grouping isn't as simple as just 'always start with <code>key1</code>, you can use <a href=\"http://ruby-doc.org/core-2.5.0/Enumerable.html#method-i-slice_when\" rel=\"nofollow noreferrer\"><code>slice_when</code></a> to split a group when 2 adjacent hashes occur where the first contains a concatenate-able key and the second does not:</p>\n\n<pre><code>output = input.slice_when do |current_hash, next_hash|\n  concatenate_keys.any? { |key| current_hash.has_key?(key) } &amp;&amp;\n    concatenate_keys.none? { |key| next_hash.has_key?(key) }\nend \n</code></pre>\n\n<p>From there, we just need to go through and collapse all <code>key3</code> and <code>key4</code> hashes into a single hash, which we can do with <a href=\"http://ruby-doc.org/core/Array.html#method-i-map\" rel=\"nofollow noreferrer\"><code>map</code></a>, <a href=\"http://ruby-doc.org/core/Array.html#method-i-select\" rel=\"nofollow noreferrer\"><code>select</code></a> and <a href=\"http://ruby-doc.org/core/Array.html#method-i-reject\" rel=\"nofollow noreferrer\"><code>reject</code></a>:</p>\n\n<pre><code>concatenate_keys = %w[key3 key4]\ncontains_concatenate_key = -&gt; hash { concatenate_keys.any? { |key| hash.has_key?(key) } }\n\noutput = output.map do |grouping|\n  concatenatable_hashes = grouping.select &amp;contains_concatenate_key\n\n  grouping.reject(&amp;contains_concatenate_key) + [\n    { concatenate_keys.join =&gt; concatenatable_hashes.flat_map(&amp;:values).join }\n  ]\nend\n\np output\n# =&gt; [[{\"key1\"=&gt;\"value1\"}, {\"key2\"=&gt;\"value2\"}, {\"key3key4\"=&gt;\"value3value4value5value6\"}],\n#     [{\"key1\"=&gt;\"value7\"}, {\"key2\"=&gt;\"value8\"}, {\"key3key4\"=&gt;\"value9value10value11value12value13value14\"}],\n#     [{\"key1\"=&gt;\"value15\"}, {\"key2\"=&gt;\"value16\"}, {\"key3key4\"=&gt;\"value17value18\"}]]\n</code></pre>\n"}], "owner": {"reputation": 39, "user_id": 2955918, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69e157a96796f5b05d6ef071d9bd03e9?s=128&d=identicon&r=PG&f=1", "display_name": "twenty20", "link": "https://stackoverflow.com/users/2955918/twenty20"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 60, "favorite_count": 1, "accepted_answer_id": 49397080, "answer_count": 1, "score": 0, "last_activity_date": 1521599383, "creation_date": 1521593627, "last_edit_date": 1521597327, "question_id": 49396478, "link": "https://stackoverflow.com/questions/49396478/ruby-iterate-over-array-of-irregularly-repeating-hashes", "title": "Ruby - iterate over array of irregularly repeating hashes", "body": "<p>Example input array of hashes ( with some regular and irregular repeating pattern )  :</p>\n\n<pre><code>[{ key1 =&gt; value1 }, { key2 =&gt; value2 }, { key3 =&gt; value3 }, \n { key4 =&gt; value4 }, { key3 =&gt; value5 }, { key4 =&gt; value6 }, \n { key1 =&gt; value7 }, { key2 =&gt; value8 }, { key3 =&gt; value9 }, \n { key4 =&gt; value10 }, { key3 =&gt; value11 }, { key4 =&gt;  value12 }, { key3  =&gt; value13 }, { key4 =&gt; value14 },\n { key1 =&gt; value15 }, { key2 =&gt; value16 }, { key3 =&gt;   value17 }, { key4 =&gt; value18 } ]\n</code></pre>\n\n<p>Requirement is to convert the above to this :</p>\n\n<pre><code> [ [{ key1 =&gt; value1 }, { key2 =&gt; value2 },\n    { key3key4 =&gt; value3value4value5value6 } ]\n   [ { key1 =&gt; value7 }, { key2 =&gt; value8 }, \n     { key3key4 =&gt;       value9value10value11value12value13value14 }]\n   [ { key1 =&gt; value15 }, { key2 =&gt; value16 }, { key3key4 =&gt;   value17value18 }] ]\n</code></pre>\n\n<p>( note, e.g., key3key4 and  value5value6value7value8 etc, are just concatenations of the keys and values )</p>\n\n<p>The input structure could be of any number of repeating hashes with key3 and key4 appearing irregularly, sometimes just two hashes, sometimes 3 etc..</p>\n\n<p>I understand array.each and array.map etc, and I think to achieve the above it may need counters or similar employed, but so far my efforts have quickly ended up in a tangled mess, hence posting here for some advice on how best to tackle this.</p>\n\n<p>Edit: a little more rationale, key3 and key4 ( and their values ) get concatenated as they are the keys where the hashes repeat ( irregularly ) in each loop of the pattern, and there is desire to collapse that down into one key:value pair hash in each \u2018repeat\u2019 of the pattern in the output. The values are strings in real problem and it makes sense when they are concatenated</p>\n"}, {"tags": ["ruby", "soap"], "comments": [{"owner": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "edited": false, "score": 0, "creation_date": 1521591003, "post_id": 49396113, "comment_id": 85794059, "body": "If you use <code>text</code> it gets all the text within the xml you receive, hence the 0 from StatusCode, or not? Maybe you&#39;d just need to access the response attribute? <code>n.xpath(&#39;&#47;&#47;Response&#39;).text</code>"}, {"owner": {"reputation": 23, "user_id": 2729138, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/11a3464460dfe87619dddc3e7a9bc036?s=128&d=identicon&r=PG&f=1", "display_name": "user2729138", "link": "https://stackoverflow.com/users/2729138/user2729138"}, "reply_to_user": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "edited": false, "score": 0, "creation_date": 1521592953, "post_id": 49396113, "comment_id": 85794553, "body": "Thank you!  That was it.  I also needed to remove the namespaces:  \tn = Nokogiri::XML::parse(response.body) \tn.remove_namespaces! \tresponse_string = n.xpath(&#39;//Response&#39;).text\t \tlog &quot;#{recipe_name}: SUAC: #{response_string}\\n&quot;"}], "owner": {"reputation": 23, "user_id": 2729138, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/11a3464460dfe87619dddc3e7a9bc036?s=128&d=identicon&r=PG&f=1", "display_name": "user2729138", "link": "https://stackoverflow.com/users/2729138/user2729138"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 35, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1521591126, "creation_date": 1521590925, "last_edit_date": 1521591126, "question_id": 49396113, "link": "https://stackoverflow.com/questions/49396113/extra-character-parsing-xml-http-response", "title": "Extra character parsing xml http response", "body": "<p>I'm running into a bizarre issue.  </p>\n\n<p>The following code results in </p>\n\n<p><code>response_string</code> being <code>\"00172C77BC0CDFC4FDB97E5DB0D114B5BE6\"</code>.The web service is actually returning <code>\"0172C77BC0CDFC4FDB97E5DB0D114B5BE6\"</code> (1 less zero in front)</p>\n\n<pre><code>response = http.request(request)\nn = Nokogiri::XML::parse(response.body)\nresponse_string = n.text        \nlog \"#{response_string}\\n\"  #==00172C77BC0CDFC4FDB97E5DB0D114B5BE6\n</code></pre>\n\n<p>Here's the response from the web service:</p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"utf-8\"?&gt;\n&lt;soap:Envelope&gt;\n    &lt;soap:Body&gt;\n        &lt;GetNextSUACINtimeRTResponse xmlns=\"https://&lt;my website&gt;/\"&gt;\n            &lt;GetNextSUACINtimeRTResult&gt;\n                &lt;Status&gt;\n                    &lt;StatusCode&gt;0&lt;/StatusCode&gt;\n                    &lt;StatusMessage /&gt;\n            &lt;/Status&gt;\n            &lt;Response&gt;0172C77BC0CDFC4FDB97E5DB0D114B5BE6&lt;/Response&gt;  #&lt;--\n        &lt;/GetNextSUACINtimeRTResult&gt;\n    &lt;/GetNextSUACINtimeRTResponse&gt;\n&lt;/soap:Body&gt;\n</code></pre>\n\n<p></p>\n\n<p>I can figure out how to strip off the first character to workaround the issue but that doesn't seem the best way to solve the issue.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "forms", "for-loop", "dropdown"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4932805"}, "edited": false, "score": 1, "creation_date": 1521590144, "post_id": 49395891, "comment_id": 85793817, "body": "please show your code"}, {"owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 0, "creation_date": 1521599567, "post_id": 49395891, "comment_id": 85796171, "body": "you should try and get a little more specific ... what param is not getting passed to the controller? How are you attempting to read the param inn the controller?"}], "owner": {"reputation": 87, "user_id": 1895399, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/f7d17ae60c65c2e94fe1a68cc1dfb591?s=128&d=identicon&r=PG", "display_name": "user1895399", "link": "https://stackoverflow.com/users/1895399/user1895399"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 40, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1521592699, "creation_date": 1521589440, "last_edit_date": 1521592699, "question_id": 49395891, "link": "https://stackoverflow.com/questions/49395891/use-dropdown-selection-to-call-specific-action-in-controller", "title": "Use Dropdown selection to call specific action in controller", "body": "<p>I have a <code>has_many</code> through association for three models. One model has individual tests that can be administered. The second model is the name of a group of those tests. (The group name of triathlon will have associations to multiple records in the individual test model). </p>\n\n<ul>\n<li>I want the user to be able to select a group name from a Dropdown </li>\n<li>and when they do it passes a param to a specific action in a controller that then is tested through the association model. </li>\n</ul>\n\n<p>I can get the form to look correctly, but not pass parameters to a specific action and then return to the same page. </p>\n\n<p>I have searched and tried for hours to no avail. What\u2019s the correct Cr form_for syntax (or something entirely different.)</p>\n\n<p>Below is my current code </p>\n\n<pre><code>&lt;% form_for @labwork, :url =&gt; {:action =&gt; \"groupcreate\"} do |f| %&gt;\n\n&lt;%= f.form_group :lab_id, class: 'row' do |f| %&gt;\n  &lt;%= f.label \"Group\", class: 'control-label col-md-2' %&gt;\n  &lt;div class='col-12 col-md-10'&gt;\n    &lt;%= f.collection_select :lab_id, Labgroup.all, :id, :name, {prompt: \"Choose a lab group \"}, class: \"form-control\" %&gt;\n    &lt;%= f.error_messages %&gt;\n  &lt;/div&gt;\n&lt;% end %&gt;\n\n  &lt;div class=\"d-flex\"&gt;\n&lt;div class=\"ml-auto\"&gt;\n  &lt;%= f.submit class: 'btn btn-primary' %&gt;\n  &lt;%= link_to \"Cancel\", labworks_path, class: 'btn btn-outline-default' %&gt;\n&lt;/div&gt;\n</code></pre>\n\n<p></p>\n\n\n\n<p>I also have a def creategroup in my labworks controller.</p>\n"}, {"tags": ["sql", "ruby-on-rails", "ruby", "postgresql"], "comments": [{"owner": {"reputation": 51013, "user_id": 976775, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/30bd66ad1795804aebe249d8bcb14409?s=128&d=identicon&r=PG", "display_name": "MrYoshiji", "link": "https://stackoverflow.com/users/976775/mryoshiji"}, "edited": false, "score": 2, "creation_date": 1521582910, "post_id": 49394571, "comment_id": 85791160, "body": "This is a <code>BigDecimal</code> object and is very similar to a <code>Float</code> object except that it does not have the famous floating point issue"}, {"owner": {"reputation": 5714, "user_id": 2389501, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/23f6a708c04c660111117c4613592689?s=128&d=identicon&r=PG", "display_name": "Mateusz Urba\u0144ski", "link": "https://stackoverflow.com/users/2389501/mateusz-urba%c5%84ski"}, "reply_to_user": {"reputation": 51013, "user_id": 976775, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/30bd66ad1795804aebe249d8bcb14409?s=128&d=identicon&r=PG", "display_name": "MrYoshiji", "link": "https://stackoverflow.com/users/976775/mryoshiji"}, "edited": false, "score": 0, "creation_date": 1521583245, "post_id": 49394571, "comment_id": 85791294, "body": "So how can I fix my problem?"}, {"owner": {"reputation": 51013, "user_id": 976775, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/30bd66ad1795804aebe249d8bcb14409?s=128&d=identicon&r=PG", "display_name": "MrYoshiji", "link": "https://stackoverflow.com/users/976775/mryoshiji"}, "edited": false, "score": 1, "creation_date": 1521583662, "post_id": 49394571, "comment_id": 85791464, "body": "There is no problem there. It is just displayed differently than a Float. It will act like one. The only place where it will be displayed in that <code>#&lt;BigDecimal:9537330,&#39;0.3E-6&#39;,9(36)&gt;</code> format, it will be in the Rails console. If you print it out on a HTML page, text of anything, it will be printed out as a regular Float (easily) readable by humans"}, {"owner": {"reputation": 394580, "user_id": 479863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ArUCE.jpg?s=128&g=1", "display_name": "mu is too short", "link": "https://stackoverflow.com/users/479863/mu-is-too-short"}, "edited": false, "score": 0, "creation_date": 1521586315, "post_id": 49394571, "comment_id": 85792657, "body": "Let me know if you don&#39;t think this is a duplicate, pretty much the same issue as far I can see."}], "owner": {"reputation": 5714, "user_id": 2389501, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/23f6a708c04c660111117c4613592689?s=128&d=identicon&r=PG", "display_name": "Mateusz Urba\u0144ski", "link": "https://stackoverflow.com/users/2389501/mateusz-urba%c5%84ski"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 30, "favorite_count": 0, "closed_date": 1521586276, "answer_count": 0, "score": 0, "last_activity_date": 1521582090, "creation_date": 1521582090, "question_id": 49394571, "link": "https://stackoverflow.com/questions/49394571/parsing-attributes-from-sql-query-in-ruby-on-rails", "closed_reason": "Duplicate", "title": "Parsing attributes from sql query in Ruby on Rails", "body": "<p>In my Ruby on Rails app I have the following query:</p>\n\n<pre><code>  SELECT\n    u.id,\n    ROUND(COALESCE(AVG(CAST(r.score AS FLOAT)),0)::numeric, 1) AS user_average_rating\n\n    FROM users u\n      LEFT JOIN video_chats v ON v.user_id = u.id\n      LEFT JOIN ratings r     ON r.video_chat_id = v.id\n\n    GROUP BY u.id;\n</code></pre>\n\n<p>Which returns: </p>\n\n<pre><code> id | user_average_rating \n----+---------------------\n  7 |                 2.0\n  3 |                 0.0\n  5 |                 0.0\n  1 |                 0.0\n  4 |                 0.0\n(5 rows)\n</code></pre>\n\n<p>This sql query is a database which is used in my models. The problem that when I use <code>user_average_rating</code> in Ruby on Rails it returns <code>0.2e1</code> instead of <code>2.0</code>. I can call <code>to_f</code> method on <code>0.2e1</code> and then it returns me correct result but I want to get correct result from PostgreSQL without calling any additional methods. Is there any way to do that?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-5"], "answers": [{"comments": [{"owner": {"reputation": 1108, "user_id": 1001807, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/da6835f9d0a471c0093ed1d81f523673?s=128&d=identicon&r=PG", "display_name": "Leon", "link": "https://stackoverflow.com/users/1001807/leon"}, "edited": false, "score": 0, "creation_date": 1521655152, "post_id": 49397227, "comment_id": 85828689, "body": "what i am trying to do is insert the <code>config.logger</code> inside of the <code>config.after_initialize</code> because the logger need a a DB key from the DB, but while i see no error that block is totally ignored and Rails keeps logging inside of the development.log file"}], "tags": [], "owner": {"reputation": 2930, "user_id": 1930295, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/128cc4033ec598b63fa96deb33e26131?s=128&d=identicon&r=PG", "display_name": "danielricecodes", "link": "https://stackoverflow.com/users/1930295/danielricecodes"}, "is_accepted": false, "score": 0, "last_activity_date": 1521599882, "creation_date": 1521599882, "answer_id": 49397227, "question_id": 49394440, "link": "https://stackoverflow.com/questions/49394440/how-can-i-read-a-variable-value-from-database-in-one-of-the-rails-environment-fi/49397227#49397227", "title": "How can i read a variable value from database in one of the Rails environment files", "body": "<p>Use <code>config.after_initialize</code>.  When this callback runs, Rails has been fully loaded. </p>\n\n<p>See <a href=\"http://guides.rubyonrails.org/configuring.html#initialization-events\" rel=\"nofollow noreferrer\">http://guides.rubyonrails.org/configuring.html#initialization-events</a></p>\n"}], "owner": {"reputation": 1108, "user_id": 1001807, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/da6835f9d0a471c0093ed1d81f523673?s=128&d=identicon&r=PG", "display_name": "Leon", "link": "https://stackoverflow.com/users/1001807/leon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 35, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1521599882, "creation_date": 1521581465, "last_edit_date": 1521596857, "question_id": 49394440, "link": "https://stackoverflow.com/questions/49394440/how-can-i-read-a-variable-value-from-database-in-one-of-the-rails-environment-fi", "title": "How can i read a variable value from database in one of the Rails environment files", "body": "<p>I am trying to setup a custom logger with a secret key in config/environments/(dev/prod).rb</p>\n\n<p>The value of the secret key is stored in the database and i have a model that pulls the value, but i think there is no DB connection yet when Rails loads the env files.</p>\n\n<p>Is there any way to have that value pulled from the database inside an environment file in Rails?</p>\n\n<p>for example my model is <code>ApplicationConfig</code></p>\n\n<p>and i need to write in config/environments/development.rb</p>\n\n<pre><code>config.secret_key = ApplicationConfig.value_for('var_name')\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "cron", "backup"], "comments": [{"owner": {"reputation": 1105, "user_id": 6743506, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/8c4ff0176b1060b3f7c504acc2993ec4?s=128&d=identicon&r=PG&f=1", "display_name": "Bryant Jackson", "link": "https://stackoverflow.com/users/6743506/bryant-jackson"}, "edited": false, "score": 0, "creation_date": 1521579656, "post_id": 49393972, "comment_id": 85789743, "body": "What happens when you run <code>&#47;bin&#47;bash -l -c &#39;backup perform -t my_backup&#39;</code> directly on the server?"}, {"owner": {"reputation": 1183, "user_id": 2217725, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/fp99h.jpg?s=128&g=1", "display_name": "royketelaar", "link": "https://stackoverflow.com/users/2217725/royketelaar"}, "reply_to_user": {"reputation": 1105, "user_id": 6743506, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/8c4ff0176b1060b3f7c504acc2993ec4?s=128&d=identicon&r=PG&f=1", "display_name": "Bryant Jackson", "link": "https://stackoverflow.com/users/6743506/bryant-jackson"}, "edited": false, "score": 0, "creation_date": 1521579994, "post_id": 49393972, "comment_id": 85789908, "body": "@BryantJackson This will successfully perform the backup, so the command itself works"}, {"owner": {"reputation": 1105, "user_id": 6743506, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/8c4ff0176b1060b3f7c504acc2993ec4?s=128&d=identicon&r=PG&f=1", "display_name": "Bryant Jackson", "link": "https://stackoverflow.com/users/6743506/bryant-jackson"}, "edited": false, "score": 0, "creation_date": 1521580197, "post_id": 49393972, "comment_id": 85790004, "body": "Interesting, so the command on its own operates exactly as expected, but running the cronjob causes it to fail. Without knowing whats in your backup command, I would recommend fiddling with the timing. Calling the cronjob every minute may be causing you issues. Honestly just a guess though. Maybe set it to every 10 minutes and come back in 20 or so min."}, {"owner": {"reputation": 1183, "user_id": 2217725, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/fp99h.jpg?s=128&g=1", "display_name": "royketelaar", "link": "https://stackoverflow.com/users/2217725/royketelaar"}, "reply_to_user": {"reputation": 1105, "user_id": 6743506, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/8c4ff0176b1060b3f7c504acc2993ec4?s=128&d=identicon&r=PG&f=1", "display_name": "Bryant Jackson", "link": "https://stackoverflow.com/users/6743506/bryant-jackson"}, "edited": false, "score": 0, "creation_date": 1521581371, "post_id": 49393972, "comment_id": 85790547, "body": "@BryantJackson Sadly, this doesn&#39;t work either"}, {"owner": {"reputation": 2487, "user_id": 267693, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7kQYV.jpg?s=128&g=1", "display_name": "Ken Ratanachai S.", "link": "https://stackoverflow.com/users/267693/ken-ratanachai-s"}, "edited": false, "score": 0, "creation_date": 1521581731, "post_id": 49393972, "comment_id": 85790688, "body": "Have you try specify user-name in your crontab? See <a href=\"https://unix.stackexchange.com/a/81814/13082\">unix.stackexchange.com/a/81814/13082</a>"}, {"owner": {"reputation": 1183, "user_id": 2217725, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/fp99h.jpg?s=128&g=1", "display_name": "royketelaar", "link": "https://stackoverflow.com/users/2217725/royketelaar"}, "reply_to_user": {"reputation": 2487, "user_id": 267693, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7kQYV.jpg?s=128&g=1", "display_name": "Ken Ratanachai S.", "link": "https://stackoverflow.com/users/267693/ken-ratanachai-s"}, "edited": false, "score": 0, "creation_date": 1521582163, "post_id": 49393972, "comment_id": 85790880, "body": "@KenRatanachaiS. Yes, that also doesn&#39;t change the outcome :/"}, {"owner": {"reputation": 14010, "user_id": 3109182, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/a4b305f0077055b4fdcf715067775d5a?s=128&d=identicon&r=PG", "display_name": "Anthony", "link": "https://stackoverflow.com/users/3109182/anthony"}, "edited": false, "score": 0, "creation_date": 1521591206, "post_id": 49393972, "comment_id": 85794127, "body": "What logger are you using <a href=\"http://backup.github.io/backup/v4/logging/\" rel=\"nofollow noreferrer\">backup.github.io/backup/v4/logging</a> and what is the output?"}, {"owner": {"reputation": 1183, "user_id": 2217725, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/fp99h.jpg?s=128&g=1", "display_name": "royketelaar", "link": "https://stackoverflow.com/users/2217725/royketelaar"}, "reply_to_user": {"reputation": 14010, "user_id": 3109182, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/a4b305f0077055b4fdcf715067775d5a?s=128&d=identicon&r=PG", "display_name": "Anthony", "link": "https://stackoverflow.com/users/3109182/anthony"}, "edited": false, "score": 0, "creation_date": 1521658508, "post_id": 49393972, "comment_id": 85830598, "body": "@Anthony I haven&#39;t configured any loggers manually. But there is a backup.log in the folder where I configured my Backup. The only backups logged are the ones I did manually."}], "answers": [{"comments": [{"owner": {"reputation": 1105, "user_id": 6743506, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/8c4ff0176b1060b3f7c504acc2993ec4?s=128&d=identicon&r=PG&f=1", "display_name": "Bryant Jackson", "link": "https://stackoverflow.com/users/6743506/bryant-jackson"}, "edited": false, "score": 0, "creation_date": 1521634202, "post_id": 49399791, "comment_id": 85812858, "body": "Good catch; <i>who</i> is running the cronjob, good very well be the source of the issue."}, {"owner": {"reputation": 1183, "user_id": 2217725, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/fp99h.jpg?s=128&g=1", "display_name": "royketelaar", "link": "https://stackoverflow.com/users/2217725/royketelaar"}, "edited": false, "score": 0, "creation_date": 1521657555, "post_id": 49399791, "comment_id": 85829992, "body": "I also tried using <code>sudo crontab -e</code>, instead of <code>crontab -e</code>. This edits the cron file which runs as root. I also inserted the command here, and my cron job does run as root but still doesn&#39;t create a backup file"}, {"owner": {"reputation": 166, "user_id": 9405451, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63e8346fbd71e0bb896aa99f0996801f?s=128&d=identicon&r=PG&f=1", "display_name": "JollyProgrammer", "link": "https://stackoverflow.com/users/9405451/jollyprogrammer"}, "edited": false, "score": 0, "creation_date": 1521687945, "post_id": 49399791, "comment_id": 85841112, "body": "Did you configure the Notifier::Mail correctly like it shows in the guides for the Backup gem. <a href=\"http://backup.github.io/backup/v4/notifier-mail/\" rel=\"nofollow noreferrer\">link</a>."}, {"owner": {"reputation": 1183, "user_id": 2217725, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/fp99h.jpg?s=128&g=1", "display_name": "royketelaar", "link": "https://stackoverflow.com/users/2217725/royketelaar"}, "edited": false, "score": 0, "creation_date": 1521728650, "post_id": 49399791, "comment_id": 85863927, "body": "@JollyProgrammer No, I haven&#39;t configured that file, because I don&#39;t need to be notified via mail. Or is this a necessary thing I need to configure for this to work?"}, {"owner": {"reputation": 166, "user_id": 9405451, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63e8346fbd71e0bb896aa99f0996801f?s=128&d=identicon&r=PG&f=1", "display_name": "JollyProgrammer", "link": "https://stackoverflow.com/users/9405451/jollyprogrammer"}, "edited": false, "score": 0, "creation_date": 1521728894, "post_id": 49399791, "comment_id": 85864097, "body": "It seems like it needs to as it is predefined to send an email everytime the backup finishes successfully. Check it here: <a href=\"http://backup.github.io/backup/v4/notifier-mail/\" rel=\"nofollow noreferrer\">backup.github.io/backup/v4/notifier-mail</a>"}], "tags": [], "owner": {"reputation": 166, "user_id": 9405451, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63e8346fbd71e0bb896aa99f0996801f?s=128&d=identicon&r=PG&f=1", "display_name": "JollyProgrammer", "link": "https://stackoverflow.com/users/9405451/jollyprogrammer"}, "is_accepted": false, "score": 2, "last_activity_date": 1521614362, "creation_date": 1521614362, "answer_id": 49399791, "question_id": 49393972, "link": "https://stackoverflow.com/questions/49393972/cron-jobs-not-executing-command/49399791#49399791", "title": "Cron jobs not executing command", "body": "<p>Did you try running the cron task command as the same user as your application? It may not have the permission to run that command.</p>\n"}], "owner": {"reputation": 1183, "user_id": 2217725, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/fp99h.jpg?s=128&g=1", "display_name": "royketelaar", "link": "https://stackoverflow.com/users/2217725/royketelaar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 202, "favorite_count": 0, "answer_count": 1, "score": 5, "last_activity_date": 1521657788, "creation_date": 1521579373, "last_edit_date": 1521657788, "question_id": 49393972, "link": "https://stackoverflow.com/questions/49393972/cron-jobs-not-executing-command", "title": "Cron jobs not executing command", "body": "<p>I'm trying to schedule backups using cron jobs <a href=\"http://backup.github.io/backup/v4/scheduling-backups/\" rel=\"nofollow noreferrer\">as explained here</a>. </p>\n\n<p>The cron jobs do run but sadly don't execute the command inside it.</p>\n\n<p>This is my schedule.rb file</p>\n\n<pre><code>every 1.minute do\n   command \"backup perform -t my_backup\"\nend\n</code></pre>\n\n<p>Which translates to this cron file:</p>\n\n<pre><code># Begin Whenever generated tasks for: /home/roy/Backup/config/schedule.rb\n* * * * * /bin/bash -l -c 'backup perform -t my_backup'\n\n# End Whenever generated tasks for: /home/roy/Backup/config/schedule.rb\n</code></pre>\n\n<p>The cron jobs then run every minute (I can see that by running <code>grep CRON /var/log/syslog</code>). These are my last cron jobs:</p>\n\n<pre><code>Mar 20 21:48:01 roybuntu CRON[18041]: (roy) CMD (/bin/bash -l -c 'backup perform -t my_backup')\nMar 20 21:48:01 roybuntu CRON[18040]: (roy) MAIL (mailed 37 bytes of output but got status 0x004b from MTA#012)\nMar 20 21:49:01 roybuntu CRON[18063]: (roy) CMD (/bin/bash -l -c 'backup perform -t my_backup')\nMar 20 21:49:01 roybuntu CRON[18062]: (roy) MAIL (mailed 37 bytes of output but got status 0x004b from MTA#012)\n</code></pre>\n\n<p>I also installed postfix because earlier I got \"No MTA installed\" error messages in the example above. However this didn't fix it.</p>\n\n<p>Anyone familiar with this problem and/or know how to fix it?</p>\n\n<p><strong>EDIT:</strong>\nAlso running the cron file as a root user doesn't seem to work. I used <code>sudo crontab -e</code> to edit the root cron file. </p>\n\n<p>This is the output when running the <code>grep CRON /var/log/syslog</code> command after I added a root crontab:</p>\n\n<pre><code>Mar 21 19:36:01 roybuntu CRON[9387]: (root) CMD (/bin/bash -l -c 'backup perform -t my_backup')\nMar 21 19:36:01 roybuntu CRON[9388]: (roy) CMD (/bin/bash -l -c 'backup perform -t my_backup')\nMar 21 19:36:01 roybuntu CRON[9385]: (roy) MAIL (mailed 37 bytes of output but got status 0x004b from MTA#012)\nMar 21 19:36:01 roybuntu CRON[9386]: (root) MAIL (mailed 90 bytes of output but got status 0x004b from MTA#012)\n</code></pre>\n"}, {"tags": ["ruby", "process", "signals"], "owner": {"reputation": 21271, "user_id": 168143, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/75fb60cc633a994debfe8b3a19eb91cb?s=128&d=identicon&r=PG", "display_name": "John Bachir", "link": "https://stackoverflow.com/users/168143/john-bachir"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 26, "favorite_count": 0, "answer_count": 0, "score": 3, "last_activity_date": 1521578091, "creation_date": 1521578091, "question_id": 49393648, "link": "https://stackoverflow.com/questions/49393648/how-can-i-accomodate-other-signal-handlers-when-trapping-a-signal", "title": "How can I accomodate other signal handlers when trapping a signal?", "body": "<p>In Jesse Storimer's excellent book <a href=\"https://www.jstorimer.com/products/working-with-unix-processes\" rel=\"nofollow noreferrer\">Working With Unix Processes</a>, he recommends this method for trapping signals while accommodating previous handlers:</p>\n\n<pre><code>old_handler = trap(:QUIT) {\n\u00a0 # do some cleanup\n\u00a0 puts 'All done!'\n\n\u00a0 old_handler.call if old_handler.respond_to?(:call)\n}\n</code></pre>\n\n<p>This never exits itself. Presumably if a previous handler calls <code>exit</code>, that's fine. But what if there is no other signal handler, only the default one? My tests show that this means the process never exits, because the default one isn't provided by <code>trap</code> (<code>old_handler</code> will be the string <code>\"DEFAULT\"</code>).</p>\n\n<p>From a previous example in the book while demonstrating something else:</p>\n\n<pre><code>old_handler = trap(:INT) {\n\u00a0 old_handler.call\n\u00a0 puts 'This is the second handler'\n\u00a0 exit\n}\n</code></pre>\n\n<p>So if the <code>old_handler</code> calls <code>exit</code>, the program will exit and we will never need to. But if it doesn't, we will take care of <code>exit</code>. This seems fine. It's a bit odd that all handlers everywhere have to be responsible for possibly being the one to ultimately end the program, knowing that only exactly one of them will.</p>\n\n<p>Anyway, assuming that that's true, here's what I've come up with as a pattern that can be universally used:</p>\n\n<pre><code>old_handler = trap(\"INT\") do\n  puts \"doing something custom in response to INT\"\n  if old_handler.respond_to?(:call)\n    puts \"calling old handler for INT\"\n    old_handler.call\n    exit # in case old_handler is a bad citizen\n  else\n    case old_handler\n    when \"DEFAULT\"\n      puts \"done with custom handlers, exiting in response to INT\"\n      exit\n    when \"IGNORE\"\n      puts \"done with custom handlers for INT, system default ignores it\"\n    else\n      # in the case of EXIT it is nil. Not sure of other possibilities\n      puts \"old_handler is : #{old_handler.class}\"\n    end\n  end\nend\n</code></pre>\n\n<p>Is this a the correct way to go about this? Anything I'm missing?</p>\n"}, {"tags": ["arrays", "ruby", "string", "date", "time"], "comments": [{"owner": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "edited": false, "score": 0, "creation_date": 1521576867, "post_id": 49393138, "comment_id": 85788268, "body": "Is it an array of strings? or an array of arrays containing strings, what&#39;s the structure you&#39;re working with?"}, {"owner": {"reputation": 183, "user_id": 5662649, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/c66fd33748de9a2bcc009f8cf1316ecd?s=128&d=identicon&r=PG&f=1", "display_name": "Lyres", "link": "https://stackoverflow.com/users/5662649/lyres"}, "reply_to_user": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "edited": false, "score": 0, "creation_date": 1521577216, "post_id": 49393138, "comment_id": 85788459, "body": "it is an array of strings with each new line separating different elements of the array"}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1521577639, "post_id": 49393138, "comment_id": 85788709, "body": "When posting on Stack Overflow it&#39;s worth taking the time to sketch in at least a partial solution. This is just a dump of data."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1521582433, "post_id": 49393138, "comment_id": 85790992, "body": "You have broken three of the fundamental rules when giving an example. Firstly, you say you say what follows is an array of strings. It is not; it is a pictorial representation of such. It needs to be a valid Ruby object: <code>[&quot;&lt;first line&gt;&quot;, &quot;&lt;second line&gt;&quot;,..., &quot;&lt;last line&gt;&quot;]</code>, in part so that readers can cut and paste. Secondly, you should assign a variable to that object (e.g., <code>strings = [....]</code>) so that readers can refer to that variable in comments and answers without having to define it. I therefore replaced what you have with what @rablex gave in his/her answer. (cont.)"}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1521583198, "post_id": 49393138, "comment_id": 85791272, "body": "(cont.) Thirdly, examples are to as brief as possible but still make your point. You don&#39;t need almost 30 lines; 4 or 5 would be sufficient. Moreover, each line should have been simplified. The first line, for example, could have been, say, <code>&quot;ANT 107 Intro to Archaeology   01:00PM-02:15PM  Markin       &quot;</code>.  The method used to sort the rows is the same for the original and simplified example. In short you are requiring everyone who posts a solutions to waste time doing what you should have done in the first place."}], "answers": [{"comments": [{"owner": {"reputation": 183, "user_id": 5662649, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/c66fd33748de9a2bcc009f8cf1316ecd?s=128&d=identicon&r=PG&f=1", "display_name": "Lyres", "link": "https://stackoverflow.com/users/5662649/lyres"}, "edited": false, "score": 0, "creation_date": 1521577780, "post_id": 49393527, "comment_id": 85788787, "body": "This is interesting, but AM and PM does matter here"}], "tags": [], "owner": {"reputation": 482, "user_id": 159650, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9440222a0c3e33f369eef79712e12204?s=128&d=identicon&r=PG", "display_name": "dwright", "link": "https://stackoverflow.com/users/159650/dwright"}, "is_accepted": false, "score": 1, "last_activity_date": 1521588332, "last_edit_date": 1521588332, "creation_date": 1521577589, "answer_id": 49393527, "question_id": 49393138, "link": "https://stackoverflow.com/questions/49393138/ruby-sort-array-of-strings-by-time-value-in-each-string/49393527#49393527", "title": "Ruby sort array of strings by time value in each string", "body": "<p>Here is a quick hack approach based on your data. Is not really sorting on time (ignores AM/PM) just by time as a numerical value.</p>\n\n<pre><code>strings.sort! { |x,y|\n  # split on time delimeter\n  s = x.index('-')\n  # sort by time as numerical\n  x[s-7..s-1] &lt;=&gt; y[s-7..s-1]\n}\n\nputs strings\n</code></pre>\n\n<p>outputs:</p>\n\n<pre><code>ANT 107 90  Intro to Envrmntl Archaeology   CMWL 101  TTH    01:00PM-02:15PM  Markin       2/15        0      4.00\nANT 294 10  SpTp: Queer Anthropology        CMWL 210  TTH    01:00PM-02:15PM  Neely        0/12        1      4.00\nAMS 210 11  Intro to American Lit II        SMTH 222  TTH    01:00PM-02:15PM  DeProspo,R   1/25        0      4.00\nANT 294 10  SpTp: Queer Anthropology        CMWL 210  TTH    01:00PM-02:15PM  Neely        0/12        1      4.00\nANT 294 10  SpTp: Queer Anthropology        CMWL 210  TTH    01:00PM-02:15PM  Neely        0/12        1      4.00\nANT 107 90  Intro to Envrmntl Archaeology   CMWL 101  TTH    01:00PM-02:15PM  Markin       2/15        0      4.00\nAMS 210 11  Intro to American Lit II        SMTH 222  TTH    01:00PM-02:15PM  DeProspo,R   1/25        0      4.00\nANT 300 10  Language and Culture            CMWL 101  TTH    02:30PM-03:45PM  Neely        1/18        0      4.00\nAMS 394 11  SpTp: Public Opinion Amer Pol   DALY 107  TTH    02:30PM-03:45PM  Cossette     5/16        0      4.00\n...\n...\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 183, "user_id": 5662649, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/c66fd33748de9a2bcc009f8cf1316ecd?s=128&d=identicon&r=PG&f=1", "display_name": "Lyres", "link": "https://stackoverflow.com/users/5662649/lyres"}, "edited": false, "score": 0, "creation_date": 1521578430, "post_id": 49393567, "comment_id": 85789139, "body": "<code>&#47;(\\d{2}:\\d{2}(PM|AM))&#47;</code> could you explain this regex."}, {"owner": {"reputation": 2537, "user_id": 297630, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/feab5e46b16603da5b850f14b304a3a4?s=128&d=identicon&r=PG", "display_name": "ramblex", "link": "https://stackoverflow.com/users/297630/ramblex"}, "reply_to_user": {"reputation": 183, "user_id": 5662649, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/c66fd33748de9a2bcc009f8cf1316ecd?s=128&d=identicon&r=PG&f=1", "display_name": "Lyres", "link": "https://stackoverflow.com/users/5662649/lyres"}, "edited": false, "score": 0, "creation_date": 1521579619, "post_id": 49393567, "comment_id": 85789723, "body": "It matches 2 digits (<code>\\d</code> means 0-9, <code>{2}</code> means match twice) followed by a colon, followed by 2 digits followed by PM or AM. The brackets around the whole thing make it return the whole match. So you&#39;ll end up with something like <code>[[&quot;01:00PM&quot;, &quot;PM&quot;]]</code> (since scan returns the groups) hence why you need <code>time.first.first</code>"}], "tags": [], "owner": {"reputation": 2537, "user_id": 297630, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/feab5e46b16603da5b850f14b304a3a4?s=128&d=identicon&r=PG", "display_name": "ramblex", "link": "https://stackoverflow.com/users/297630/ramblex"}, "is_accepted": true, "score": 3, "last_activity_date": 1521585762, "last_edit_date": 1521585762, "creation_date": 1521577793, "answer_id": 49393567, "question_id": 49393138, "link": "https://stackoverflow.com/questions/49393138/ruby-sort-array-of-strings-by-time-value-in-each-string/49393567#49393567", "title": "Ruby sort array of strings by time value in each string", "body": "<p>Here's another alternative using <code>DateTime</code>:</p>\n\n<pre><code>require 'date'\n\nstrings.sort_by! do |item|\n  time = item.scan(/(\\d{2}:\\d{2}(PM|AM))/)\n  DateTime.parse(time.first.first).to_time.to_i\nend\n\nputs strings\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1521588010, "post_id": 49393636, "comment_id": 85793187, "body": "In view of my edit to the question you could replace <code>data</code> with <code>strings</code> and remove your definition of <code>data</code>."}], "tags": [], "owner": {"reputation": 25573, "user_id": 676874, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/c8e67ec01dc3e7c402255ff26785863f?s=128&d=identicon&r=PG", "display_name": "knut", "link": "https://stackoverflow.com/users/676874/knut"}, "is_accepted": false, "score": 0, "last_activity_date": 1521578057, "creation_date": 1521578057, "answer_id": 49393636, "question_id": 49393138, "link": "https://stackoverflow.com/questions/49393138/ruby-sort-array-of-strings-by-time-value-in-each-string/49393636#49393636", "title": "Ruby sort array of strings by time value in each string", "body": "<p>You can try:</p>\n\n<pre><code>data = &lt;&lt;data.split(\"\\n\")\nANT 107 90  Intro to Envrmntl Archaeology   CMWL 101  TTH    01:00PM-02:15PM  Markin       2/15        0      4.00\nAMS 210 10  Intro to American Lit II        SMTH 222  TTH    11:30AM-12:45PM  DeProspo,R   0/25        0      4.00\nAMS 210 11  Intro to American Lit II        SMTH 222  TTH    01:00PM-02:15PM  DeProspo,R   1/25        0      4.00\nAMS 300 10  Toni Morrison                   DALY 107  TTH    10:00AM-11:15AM  Knight      12/20        0      4.00\nAMS 394 11  SpTp: Public Opinion Amer Pol   DALY 107  TTH    02:30PM-03:45PM  Cossette     5/16        0      4.00\nANT 105 10  Introduction to Anthropology    CMWL 210  TTH    11:30AM-12:45PM  Lampman      1/25        1      4.00\nANT 107 10  Intro to Envrmntl Archaeology   CMWL 101  TTH    11:30AM-12:45PM  Markin       2/25        0      4.00\nANT 107 90  Intro to Envrmntl Archaeology   CMWL 101  TTH    01:00PM-02:15PM  Markin       2/15        0      4.00\nANT 294 10  SpTp: Queer Anthropology        CMWL 210  TTH    01:00PM-02:15PM  Neely        0/12        1      4.00\nANT 300 10  Language and Culture            CMWL 101  TTH    02:30PM-03:45PM  Neely        1/18        0      4.00\nANT 320 10  Race and Ethnicity              CMWL 101  TTH    10:00AM-11:15AM  Lampman     -4/16        2      4.00\nANT 104 10  Intro to World Music &amp; Ethno    GCA  204  TTH    10:00AM-11:15AM  McCollum, J  0/25        0      4.00\nANT 105 10  Introduction to Anthropology    CMWL 210  TTH    11:30AM-12:45PM  Lampman      1/25        1      4.00\nANT 294 10  SpTp: Queer Anthropology        CMWL 210  TTH    01:00PM-02:15PM  Neely        0/12        1      4.00\nANT 300 10  Language and Culture            CMWL 101  TTH    02:30PM-03:45PM  Neely        1/18        0      4.00\nANT 320 10  Race and Ethnicity              CMWL 101  TTH    10:00AM-11:15AM  Lampman     -4/16        2      4.00\nANT 104 10  Intro to World Music &amp; Ethno    GCA  204  TTH    10:00AM-11:15AM  McCollum, J  0/25        0      4.00\nANT 105 10  Introduction to Anthropology    CMWL 210  TTH    11:30AM-12:45PM  Lampman      1/25        1      4.00\nANT 300 10  Language and Culture            CMWL 101  TTH    02:30PM-03:45PM  Neely        1/18        0      4.00\nANT 320 10  Race and Ethnicity              CMWL 101  TTH    10:00AM-11:15AM  Lampman     -4/16        2      4.00\nANT 104 10  Intro to World Music &amp; Ethno    GCA  204  TTH    10:00AM-11:15AM  McCollum, J  0/25        0      4.00\nAMS 210 10  Intro to American Lit II        SMTH 222  TTH    11:30AM-12:45PM  DeProspo,R   0/25        0      4.00\nAMS 210 11  Intro to American Lit II        SMTH 222  TTH    01:00PM-02:15PM  DeProspo,R   1/25        0      4.00\nAMS 300 10  Toni Morrison                   DALY 107  TTH    10:00AM-11:15AM  Knight      12/20        0      4.00\nAMS 394 11  SpTp: Public Opinion Amer Pol   DALY 107  TTH    02:30PM-03:45PM  Cossette     5/16        0      4.00\nANT 104 10  Intro to World Music &amp; Ethno    GCA  204  TTH    10:00AM-11:15AM  McCollum, J  0/25        0      4.00\nANT 294 10  SpTp: Queer Anthropology        CMWL 210  TTH    01:00PM-02:15PM  Neely        0/12        1      4.00\nAMS 300 10  Toni Morrison                   DALY 107  TTH    10:00AM-11:15A\ndata\n\nputs data.sort_by{|x| \n  x =~ /\\s(\\d\\d:\\d\\d)([AP])M/\n  '%s%s' % [$2=='A' ? 0 : 1,$1]\n  }\n</code></pre>\n\n<p>The <code>$2=='A' ? 0 : 1</code> is not needed with your data, but it is relevant for data like</p>\n\n<pre><code>data = &lt;&lt;data.split(\"\\n\")\nANT 107 90  Intro to Envrmntl Archaeology   CMWL 101  TTH    01:00PM-02:15PM  Markin       2/15        0      4.00\nAMS 210 10  Intro to American Lit II        SMTH 222  TTH    02:00AM-12:45PM  DeProspo,R   0/25        0      4.00\ndata\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "is_accepted": false, "score": 0, "last_activity_date": 1521651696, "last_edit_date": 1521651696, "creation_date": 1521585810, "answer_id": 49395336, "question_id": 49393138, "link": "https://stackoverflow.com/questions/49393138/ruby-sort-array-of-strings-by-time-value-in-each-string/49395336#49395336", "title": "Ruby sort array of strings by time value in each string", "body": "<pre><code>arr = [\n \"ANT 107 90  Intro to Archaeology   01:00PM-02:15PM  Markin     \",\n \"AMS 210 10  Intro to Lit I         11:30AM-12:45PM  DeProspo,R \",\n \"AMS 210 11  Intro to Lit II        02:00PM-03:15PM  DeProspo,R \",\n \"AMS 300 10  Toni Morrison          10:00AM-11:15AM  Knight     \"\n]\n\narr.sort_by { |s| [s[40], s[35,5]] }\n  #=&gt; [\"AMS 300 10  Toni Morrison          10:00AM-11:15AM  Knight     \",\n  #    \"AMS 210 10  Intro to Lit I         11:30AM-12:45PM  DeProspo,R \",\n  #    \"ANT 107 90  Intro to Archaeology   01:00PM-02:15PM  Markin     \",\n  #    \"AMS 210 11  Intro to Lit II        02:00PM-03:15PM  DeProspo,R \"]\n</code></pre>\n\n<p>Notice that if <code>s = arr.first</code> then</p>\n\n<pre><code>[s[40], s[35,5]]\n  #=&gt; [\"P\", \"01:00\"]\n</code></pre>\n\n<p>The ordering of arrays used by <a href=\"http://ruby-doc.org/core-2.4.0/Enumerable.html#method-i-sort_by\" rel=\"nofollow noreferrer\">Enumerable#sort_by</a> is explained in the third paragraph of the doc for <a href=\"http://ruby-doc.org/core-2.4.0/Array.html#method-i-3C-3D-3E\" rel=\"nofollow noreferrer\">Array#&lt;=></a>. The ordering of strings (e.g., comparing <code>\"P\"</code> vs <code>\"A\"</code> or <code>\"01:00\"</code> vs <code>\"01:20\"</code>) is explained in the doc for <a href=\"http://ruby-doc.org/core-2.4.0/String.html#method-i-3C-3D-3E\" rel=\"nofollow noreferrer\">String#&lt;=></a>.<code>[\"A\", \"11:30\"]</code> would be sorted before <code>[\"P\", \"01:00\"]</code> because <code>\"A\"</code> precedes <code>\"P\"</code>. Similarly, <code>[\"P\", \"01:00\"]</code> is sorted before <code>[\"P\", \"02:00\"]</code> because the first elements of the two arrays are equal and <code>\"01:00\"</code> precedes <code>\"02:00\"</code>.</p>\n\n<p>One could alternatively write</p>\n\n<pre><code>arr.sort_by { |s| s[40] + s[35,5] }\n</code></pre>\n\n<p>Is <code>s = arr.first</code> then</p>\n\n<pre><code>s[40] + s[35,5]\n  #=&gt; \"P01:00\"\n</code></pre>\n"}], "owner": {"reputation": 183, "user_id": 5662649, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/c66fd33748de9a2bcc009f8cf1316ecd?s=128&d=identicon&r=PG&f=1", "display_name": "Lyres", "link": "https://stackoverflow.com/users/5662649/lyres"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 90, "favorite_count": 0, "accepted_answer_id": 49393567, "answer_count": 4, "score": 1, "last_activity_date": 1521651696, "creation_date": 1521576084, "last_edit_date": 1521581408, "question_id": 49393138, "link": "https://stackoverflow.com/questions/49393138/ruby-sort-array-of-strings-by-time-value-in-each-string", "title": "Ruby sort array of strings by time value in each string", "body": "<p>I have an array of strings like this: </p>\n\n<pre><code>strings = [\n \"ANT 107 90  Intro to Envrmntl Archaeology   CMWL 101  TTH    01:00PM-02:15PM  Markin       2/15        0      4.00\",\n \"AMS 210 10  Intro to American Lit II        SMTH 222  TTH    11:30AM-12:45PM  DeProspo,R   0/25        0      4.00\",\n \"AMS 210 11  Intro to American Lit II        SMTH 222  TTH    01:00PM-02:15PM  DeProspo,R   1/25        0      4.00\",\n \"AMS 300 10  Toni Morrison                   DALY 107  TTH    10:00AM-11:15AM  Knight      12/20        0      4.00\",\n \"AMS 394 11  SpTp: Public Opinion Amer Pol   DALY 107  TTH    02:30PM-03:45PM  Cossette     5/16        0      4.00\",\n \"ANT 105 10  Introduction to Anthropology    CMWL 210  TTH    11:30AM-12:45PM  Lampman      1/25        1      4.00\",\n \"ANT 107 10  Intro to Envrmntl Archaeology   CMWL 101  TTH    11:30AM-12:45PM  Markin       2/25        0      4.00\",\n \"ANT 107 90  Intro to Envrmntl Archaeology   CMWL 101  TTH    01:00PM-02:15PM  Markin       2/15        0      4.00\",\n \"ANT 294 10  SpTp: Queer Anthropology        CMWL 210  TTH    01:00PM-02:15PM  Neely        0/12        1      4.00\",\n \"ANT 300 10  Language and Culture            CMWL 101  TTH    02:30PM-03:45PM  Neely        1/18        0      4.00\",\n \"ANT 320 10  Race and Ethnicity              CMWL 101  TTH    10:00AM-11:15AM  Lampman     -4/16        2      4.00\",\n \"ANT 104 10  Intro to World Music &amp; Ethno    GCA  204  TTH    10:00AM-11:15AM  McCollum, J  0/25        0      4.00\",\n \"ANT 105 10  Introduction to Anthropology    CMWL 210  TTH    11:30AM-12:45PM  Lampman      1/25        1      4.00\",\n \"ANT 294 10  SpTp: Queer Anthropology        CMWL 210  TTH    01:00PM-02:15PM  Neely        0/12        1      4.00\",\n \"ANT 300 10  Language and Culture            CMWL 101  TTH    02:30PM-03:45PM  Neely        1/18        0      4.00\",\n \"ANT 320 10  Race and Ethnicity              CMWL 101  TTH    10:00AM-11:15AM  Lampman     -4/16        2      4.00\",\n \"ANT 104 10  Intro to World Music &amp; Ethno    GCA  204  TTH    10:00AM-11:15AM  McCollum, J  0/25        0      4.00\",\n \"ANT 105 10  Introduction to Anthropology    CMWL 210  TTH    11:30AM-12:45PM  Lampman      1/25        1      4.00\",\n \"ANT 300 10  Language and Culture            CMWL 101  TTH    02:30PM-03:45PM  Neely        1/18        0      4.00\",\n \"ANT 320 10  Race and Ethnicity              CMWL 101  TTH    10:00AM-11:15AM  Lampman     -4/16        2      4.00\",\n \"ANT 104 10  Intro to World Music &amp; Ethno    GCA  204  TTH    10:00AM-11:15AM  McCollum, J  0/25        0      4.00\",\n \"AMS 210 10  Intro to American Lit II        SMTH 222  TTH    11:30AM-12:45PM  DeProspo,R   0/25        0      4.00\",\n \"AMS 210 11  Intro to American Lit II        SMTH 222  TTH    01:00PM-02:15PM  DeProspo,R   1/25        0      4.00\",\n \"AMS 300 10  Toni Morrison                   DALY 107  TTH    10:00AM-11:15AM  Knight      12/20        0      4.00\",\n \"AMS 394 11  SpTp: Public Opinion Amer Pol   DALY 107  TTH    02:30PM-03:45PM  Cossette     5/16        0      4.00\",\n \"ANT 104 10  Intro to World Music &amp; Ethno    GCA  204  TTH    10:00AM-11:15AM  McCollum, J  0/25        0      4.00\",\n \"ANT 294 10  SpTp: Queer Anthropology        CMWL 210  TTH    01:00PM-02:15PM  Neely        0/12        1      4.00\",\n \"AMS 300 10  Toni Morrison                   DALY 107  TTH    10:00AM-11:15AM  Knight      12/20        0      4.00\",\n]\n</code></pre>\n\n<p>I want to sort this array by the start time, first value would be <code>01:00PM</code> for <code>ANT 107 90  Intro to Envrmntl Archaeology</code>. Is there any straight forward way of doing this?</p>\n"}, {"tags": ["ruby", "postgresql"], "comments": [{"owner": {"reputation": 38170, "user_id": 57135, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/S9roh.jpg?s=128&g=1", "display_name": "Joe", "link": "https://stackoverflow.com/users/57135/joe"}, "edited": false, "score": 1, "creation_date": 1521576149, "post_id": 49392901, "comment_id": 85787895, "body": "<a href=\"https://stackoverflow.com/questions/26986443/how-do-i-fetch-column-names-from-a-db-table-into-an-array-using-postgresql-and\" title=\"how do i fetch column names from a db table into an array using postgresql and\">stackoverflow.com/questions/26986443/&hellip;</a>"}, {"owner": {"reputation": 394580, "user_id": 479863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ArUCE.jpg?s=128&g=1", "display_name": "mu is too short", "link": "https://stackoverflow.com/users/479863/mu-is-too-short"}, "reply_to_user": {"reputation": 38170, "user_id": 57135, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/S9roh.jpg?s=128&g=1", "display_name": "Joe", "link": "https://stackoverflow.com/users/57135/joe"}, "edited": false, "score": 1, "creation_date": 1521584458, "post_id": 49392901, "comment_id": 85791801, "body": "@Joe is right (the second answer in particular), look at <code>information_schema.columns</code> rather than trying to kludge something up with an empty query. You could also dig through the Rails/ActiveRecord PostgreSQL driver to see how it figures out table structures (and find that it consults the system tables too)."}, {"owner": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "edited": false, "score": 0, "creation_date": 1521658764, "post_id": 49392901, "comment_id": 85830760, "body": "Not sure this is what the user requested. See comments"}], "answers": [{"comments": [{"owner": {"reputation": 83, "user_id": 9419102, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/3b0a94b437e39bbb234559d4300691ef?s=128&d=identicon&r=PG&f=1", "display_name": "Fatna", "link": "https://stackoverflow.com/users/9419102/fatna"}, "edited": false, "score": 0, "creation_date": 1521653031, "post_id": 49393321, "comment_id": 85827404, "body": "lacostenycoder, Your code work perfect, but I want the value of the hash to be an array of all the returned rows not the column names. Thanks"}, {"owner": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "reply_to_user": {"reputation": 83, "user_id": 9419102, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/3b0a94b437e39bbb234559d4300691ef?s=128&d=identicon&r=PG&f=1", "display_name": "Fatna", "link": "https://stackoverflow.com/users/9419102/fatna"}, "edited": false, "score": 1, "creation_date": 1521657820, "post_id": 49393321, "comment_id": 85830141, "body": "are you doing this in a rails project or just plain ruby?"}], "tags": [], "owner": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "is_accepted": false, "score": -1, "last_activity_date": 1521658593, "last_edit_date": 1521658593, "creation_date": 1521576747, "answer_id": 49393321, "question_id": 49392901, "link": "https://stackoverflow.com/questions/49392901/create-hash-with-keys-are-table-names-values-are-column-names/49393321#49393321", "title": "Create hash with keys are table names, values are column names", "body": "<p>Use <code>.map</code> to create a new array and pass the block.  This should work:</p>\n\n<pre><code>arr_table_names.map do |table|  \n    rs = pg_conn.execute \"SELECT * FROM #{table} WHERE Id=0\"\n    {table =&gt; rs.fields}\nend\n</code></pre>\n\n<p>Update, you wanted a hash with the table names as keys, and columns as values so:</p>\n\n<pre><code>arr_table_names = ['table1','table2','table3']\nhash = {}\narr_table_names.each do |table|  \n    rs = pg_conn.execute \"SELECT * FROM #{table} WHERE Id=0\"\n    hash[table] = rs.fields\nend\n</code></pre>\n\n<p>Update 2, you want the row data as an array for each column(key) in the hash:</p>\n\n<pre><code>arr_table_names = ['table1','table2','table3']\nhash = {}\narr_table_names.each do |table|  \n  rows = pg_conn.execute \"SELECT * FROM #{table}\"\n  hash[table] = rows.entries.map(&amp;:values)\nend\n</code></pre>\n"}], "owner": {"reputation": 83, "user_id": 9419102, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/3b0a94b437e39bbb234559d4300691ef?s=128&d=identicon&r=PG&f=1", "display_name": "Fatna", "link": "https://stackoverflow.com/users/9419102/fatna"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 332, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1521832118, "creation_date": 1521575050, "last_edit_date": 1521823456, "question_id": 49392901, "link": "https://stackoverflow.com/questions/49392901/create-hash-with-keys-are-table-names-values-are-column-names", "title": "Create hash with keys are table names, values are column names", "body": "<p>I would like to iterate an array that has a database table names, I would like to create a hash like this:</p>\n\n<pre><code>{\"table1\"=&gt;[column1,...,columnN],\"table2\"=&gt;[column1,...,columnM]...}\n</code></pre>\n\n<p>This is what I did so far:</p>\n\n<pre><code>arr_table_names = ['table1','table2','table3']\n\narr_table_names.each do |table|  \n rs = pg_conn.exec 'SELECT * FROM table WHERE Id=0'\n column_names = rs.nfields\n   h = Hash.new{|hsh,key| hsh[key] = [] }\n   h[table].push ??? column_names ?? I don't know how in this line\n\nend\n</code></pre>\n\n<p>I tried to use Sebastian's solution, but got a syntax error:</p>\n\n<pre><code>def check_tables_same_content(table1,table2)\n   result = %w[#{table1} #{table2}].each_with_object([]) do |table, arr|\n    arr &lt;&lt; { table.to_sym =&gt; @pg_conn.exec(\"SELECT * FROM #{table} WHERE false\").fields }\n   end\n   puts result2    \n end  \ncheck_tables_same_content('company','company2')\n\ncompany.rb:21:in `exec': ERROR:  syntax error at or near \"#\" (PG::SyntaxError)\nLINE 1: SELECT * FROM #{table1} WHERE false\n                  ^\n</code></pre>\n\n<p>Note that I am not looking on how to return column names.  </p>\n"}, {"tags": ["ruby", "uri", "nokogiri"], "answers": [{"comments": [{"owner": {"reputation": 740, "user_id": 2755116, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/18ac781101ea75e34e41cb56407f5313?s=128&d=identicon&r=PG&f=1", "display_name": "somenxavier", "link": "https://stackoverflow.com/users/2755116/somenxavier"}, "edited": false, "score": 0, "creation_date": 1596044904, "post_id": 49396018, "comment_id": 111686746, "body": "I wna to prepend not adding at the end. And just for specific links (see question) not starting with http"}], "tags": [], "owner": {"reputation": 47898, "user_id": 966023, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/917fcb4327159076f752c0c3c3fddfbb?s=128&d=identicon&r=PG", "display_name": "pguardiario", "link": "https://stackoverflow.com/users/966023/pguardiario"}, "is_accepted": false, "score": -1, "last_activity_date": 1521590199, "creation_date": 1521590199, "answer_id": 49396018, "question_id": 49392472, "link": "https://stackoverflow.com/questions/49392472/how-to-pass-from-relative-links-to-absolute-links-in-nokogiri/49396018#49396018", "title": "How to pass from relative links to absolute links in nokogiri", "body": "<p>With URI:</p>\n\n<pre><code>require 'uri'\nURI.join('http://google.com/', 'foo')\n#&lt;URI::HTTP http://google.com/foo&gt;\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 740, "user_id": 2755116, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/18ac781101ea75e34e41cb56407f5313?s=128&d=identicon&r=PG&f=1", "display_name": "somenxavier", "link": "https://stackoverflow.com/users/2755116/somenxavier"}, "is_accepted": true, "score": 0, "last_activity_date": 1522090156, "creation_date": 1522090156, "answer_id": 49498589, "question_id": 49392472, "link": "https://stackoverflow.com/questions/49392472/how-to-pass-from-relative-links-to-absolute-links-in-nokogiri/49498589#49498589", "title": "How to pass from relative links to absolute links in nokogiri", "body": "<p>First get the document:</p>\n\n<pre><code>&lt;% doc = Nokogiri::HTML(foo)%&gt;\n</code></pre>\n\n<p>where foo is the content you want.</p>\n\n<p>Search links with no scheme and without starting with '/'. So they are relative. With this link append '/' + <code>PREPEND</code></p>\n\n<pre><code>&lt;% for link in doc.search('a[href]').select { |l| URI(l['href']).scheme == nil and URI(l['href']).path.start_with?('/') == false }\n     link['href'] = '/' + PREPEND + '/' + link['href']\n   end\n%&gt;\n</code></pre>\n"}], "owner": {"reputation": 740, "user_id": 2755116, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/18ac781101ea75e34e41cb56407f5313?s=128&d=identicon&r=PG&f=1", "display_name": "somenxavier", "link": "https://stackoverflow.com/users/2755116/somenxavier"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 128, "favorite_count": 1, "accepted_answer_id": 49498589, "answer_count": 2, "score": 0, "last_activity_date": 1522090156, "creation_date": 1521573318, "question_id": 49392472, "link": "https://stackoverflow.com/questions/49392472/how-to-pass-from-relative-links-to-absolute-links-in-nokogiri", "title": "How to pass from relative links to absolute links in nokogiri", "body": "<p>How do you pass from relative links to absolute links:</p>\n\n<pre><code>&lt;a href=\"/foo/ba.pdf\"&gt;A&lt;/a&gt;\n&lt;a href=\"foo/ba.pdf\"&gt;B&lt;/a&gt;\n&lt;a href=\"http://google.com/foo/ba.pdf\"&gt;A&lt;/a&gt;\n&lt;a href=\"#hello\"&gt;A&lt;/a&gt;\n</code></pre>\n\n<p>should transform to</p>\n\n<pre><code>&lt;a href=\"PREFIX/foo/ba.pdf\"&gt;A&lt;/a&gt;\n&lt;a href=\"PREFIX/foo/ba.pdf\"&gt;B&lt;/a&gt;\n&lt;a href=\"http://google.com/foo/ba.pdf\"&gt;A&lt;/a&gt;\n&lt;a href=\"#hello\"&gt;A&lt;/a&gt;\n</code></pre>\n\n<p>where <code>PREFIX</code> is string (user defined)</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "database", "web-development-server"], "comments": [{"owner": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "edited": false, "score": 2, "creation_date": 1521571497, "post_id": 49391945, "comment_id": 85785446, "body": "Just make sure the result of <code>A.find(params[:wishlist_id])</code> isn&#39;t nil. Use a debugger, check your strong params, look for any error."}, {"owner": {"reputation": 107, "user_id": 1200840, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/7772f79201c0f70d0fa895c4b20a7b55?s=128&d=identicon&r=PG", "display_name": "amarradi", "link": "https://stackoverflow.com/users/1200840/amarradi"}, "reply_to_user": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "edited": false, "score": 0, "creation_date": 1521579390, "post_id": 49391945, "comment_id": 85789597, "body": "Thats right! It isn&#39;t nil. But i changed the id-handling via to_param in my model and now i need an other id because i&#39;m using an other id."}, {"owner": {"reputation": 7844, "user_id": 1520557, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/9KKRA.png?s=128&g=1", "display_name": "Drenmi", "link": "https://stackoverflow.com/users/1520557/drenmi"}, "edited": false, "score": 0, "creation_date": 1521580759, "post_id": 49391945, "comment_id": 85790257, "body": "It can&#39;t be <code>nil</code>, because <code>#find</code> raises an exception if it doesn&#39;t find the record, suggesting the code posted is not the one running when the error happens."}, {"owner": {"reputation": 107, "user_id": 1200840, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/7772f79201c0f70d0fa895c4b20a7b55?s=128&d=identicon&r=PG", "display_name": "amarradi", "link": "https://stackoverflow.com/users/1200840/amarradi"}, "edited": false, "score": 0, "creation_date": 1521583160, "post_id": 49391945, "comment_id": 85791262, "body": "now i change the to_param method that the id i use. But there is an error that i&#39;ve never seen before <code>undefined method </code>string&#39; for #&lt;E:0x00007f5699128468&gt; Did you mean? String`"}], "owner": {"reputation": 107, "user_id": 1200840, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/7772f79201c0f70d0fa895c4b20a7b55?s=128&d=identicon&r=PG", "display_name": "amarradi", "link": "https://stackoverflow.com/users/1200840/amarradi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 44, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1521571655, "creation_date": 1521571363, "last_edit_date": 1521571655, "question_id": 49391945, "link": "https://stackoverflow.com/questions/49391945/rails-nomethoderror-in-adminbscontrollercreate", "title": "rails NoMethodError in Admin::BsController#create", "body": "<p>after the community an i solved my problem <a href=\"https://stackoverflow.com/questions/49366165/rails-how-to-use-associated-model-with-the-admin-namespace\">rails how to use Associated Model with the admin namespace</a> i get the data from the form into the controller, my <code>def create</code> crashed.</p>\n\n<p>I'm using rails 5.1.5 with ruby 2.5.0. I have two models the model A and Model B.</p>\n\n<pre><code>Model A has_many bs\nModel B belongs_to a\n</code></pre>\n\n<p>The Controller with the crash is</p>\n\n<p><strong>app/controllers/admin/bs_controller.rb</strong></p>\n\n<pre><code>class Admin::BsController &lt; ApplicationController\n\ndef create\n  @a = A.find(params[:a_id])\n  @b = @a.bs.create(entry_params)\n  redirect_to a_path(@a)\nend\n</code></pre>\n\n<p><strong>NoMethodError in Admin::BsController#create</strong></p>\n\n<p><strong>undefined method `bs' for nil:NilClass</strong></p>\n\n<pre><code>def create\n  @a = A.find(params[:a_id])\n  **@b = @a.bs.create(entry_params)**\n  redirect_to a_path(@a)\nend\n</code></pre>\n\n<p>Is it correct? First i have to find the \"A-Entry\" from is main Model, the i can create the new entry which belongs_to a?</p>\n"}, {"tags": ["mysql", "ruby", "sequel"], "comments": [{"owner": {"reputation": 33954, "user_id": 49478, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/6c42283aeb1521ae0e27bd41b7fdb227?s=128&d=identicon&r=PG", "display_name": "Anthony", "link": "https://stackoverflow.com/users/49478/anthony"}, "edited": false, "score": 0, "creation_date": 1521571759, "post_id": 49391534, "comment_id": 85785589, "body": "Among other things, this would be an unsafe approach since there is no guarantee that <code>- 600</code> would be interpreted as being in seconds. Or rather, there isn&#39;t a guarantee simply from the way the example code. I assume the &quot;incompatible data types&quot; is because <code>created_at</code> is a datetime datatype, and you are trying to interact with it like it&#39;s an integer."}, {"owner": {"reputation": 33954, "user_id": 49478, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/6c42283aeb1521ae0e27bd41b7fdb227?s=128&d=identicon&r=PG", "display_name": "Anthony", "link": "https://stackoverflow.com/users/49478/anthony"}, "edited": false, "score": 0, "creation_date": 1521572050, "post_id": 49391534, "comment_id": 85785773, "body": "This looks useful: <a href=\"http://sequel.jeremyevans.net/rdoc-plugins/files/lib/sequel/extensions/date_arithmetic_rb.html\" rel=\"nofollow noreferrer\">sequel.jeremyevans.net/rdoc-plugins/files/lib/sequel/extensi&zwnj;&#8203;ons/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 4717, "user_id": 1913389, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/QKwb2.png?s=128&g=1", "display_name": "theGreenCabbage", "link": "https://stackoverflow.com/users/1913389/thegreencabbage"}, "edited": false, "score": 0, "creation_date": 1521570740, "post_id": 49391695, "comment_id": 85785012, "body": "It seems like I don&#39;t have <code>update_all</code> in my Sequel: <code>NoMethodError: undefined method update_all&#39; for MyApp::Model::MyTable:Class     org&#47;jruby&#47;RubyBasicObject.java:1657:in method_missing&#39;</code>"}, {"owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "reply_to_user": {"reputation": 4717, "user_id": 1913389, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/QKwb2.png?s=128&g=1", "display_name": "theGreenCabbage", "link": "https://stackoverflow.com/users/1913389/thegreencabbage"}, "edited": false, "score": 0, "creation_date": 1521571190, "post_id": 49391695, "comment_id": 85785284, "body": "I am sorry, I missed that you use <code>Sequel</code>. Please see my updated answer."}], "tags": [], "owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "is_accepted": false, "score": 0, "last_activity_date": 1521571129, "last_edit_date": 1521571129, "creation_date": 1521570501, "answer_id": 49391695, "question_id": 49391534, "link": "https://stackoverflow.com/questions/49391534/updating-all-created-at-rows-to-be-10-minutes-before-in-ruby-sequel/49391695#49391695", "title": "Updating all created_at rows to be 10 minutes before in Ruby Sequel", "body": "<p>I would do this in the database with a SQL command to avoid loading all records into memory first:</p>\n\n<pre><code>MyApp::Model::MyTable.update_sql(\n  created_at: Sequel.lit('DATE_SUB(created_at, INTERVAL 10 MINUTE)')\n)\n</code></pre>\n\n<p>See the documentation of <a href=\"https://dev.mysql.com/doc/refman/5.7/en/date-and-time-functions.html#function_date-sub\" rel=\"nofollow noreferrer\"><code>DATE_SUB</code></a>.</p>\n"}], "owner": {"reputation": 4717, "user_id": 1913389, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/QKwb2.png?s=128&g=1", "display_name": "theGreenCabbage", "link": "https://stackoverflow.com/users/1913389/thegreencabbage"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 165, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1521571129, "creation_date": 1521569966, "question_id": 49391534, "link": "https://stackoverflow.com/questions/49391534/updating-all-created-at-rows-to-be-10-minutes-before-in-ruby-sequel", "title": "Updating all created_at rows to be 10 minutes before in Ruby Sequel", "body": "<p>I am trying to take all the <code>created_at</code> timestamps in my table and decrement around 10 minutes from it (600 seconds). But I can't seem to figure it out.</p>\n\n<pre><code>MyApp::Model::MyTable.select(:created_at).update(:created_at =&gt; :created_at - 600)\n</code></pre>\n\n<p>I select all the rows from the <code>created_at</code> column and perform an update on said row so that each row is now <code>created_at</code> - 600 seconds (10 minutes). However, when I try this, it says <code>incompatible data types in combination</code>. </p>\n\n<p>Can someone give me a better solution to this?</p>\n"}, {"tags": ["ruby", "concurrency", "promise"], "comments": [{"owner": {"reputation": 3320, "user_id": 4950680, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/C8cEh.jpg?s=128&g=1", "display_name": "Martin Zinovsky", "link": "https://stackoverflow.com/users/4950680/martin-zinovsky"}, "edited": false, "score": 0, "creation_date": 1521570119, "post_id": 49391462, "comment_id": 85784643, "body": "Seems like an issue to open in <a href=\"https://github.com/ruby-concurrency/concurrent-ruby/\" rel=\"nofollow noreferrer\">concurrent-ruby repo</a>"}, {"owner": {"reputation": 10005, "user_id": 724036, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/6VXVJ.jpg?s=128&g=1", "display_name": "zishe", "link": "https://stackoverflow.com/users/724036/zishe"}, "reply_to_user": {"reputation": 3320, "user_id": 4950680, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/C8cEh.jpg?s=128&g=1", "display_name": "Martin Zinovsky", "link": "https://stackoverflow.com/users/4950680/martin-zinovsky"}, "edited": false, "score": 0, "creation_date": 1521570185, "post_id": 49391462, "comment_id": 85784682, "body": "I think I use it wrong way."}, {"owner": {"reputation": 3320, "user_id": 4950680, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/C8cEh.jpg?s=128&g=1", "display_name": "Martin Zinovsky", "link": "https://stackoverflow.com/users/4950680/martin-zinovsky"}, "edited": false, "score": 0, "creation_date": 1521570432, "post_id": 49391462, "comment_id": 85784817, "body": "Does not seem like it by <a href=\"http://ruby-concurrency.github.io/concurrent-ruby/frames.html\" rel=\"nofollow noreferrer\">Concurrent::Promise#all? docs</a>. But it returns boolean and I dont see how this can be chained with <a href=\"http://ruby-concurrency.github.io/concurrent-ruby/frames.html\" rel=\"nofollow noreferrer\">Promise.then</a>"}, {"owner": {"reputation": 10005, "user_id": 724036, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/6VXVJ.jpg?s=128&g=1", "display_name": "zishe", "link": "https://stackoverflow.com/users/724036/zishe"}, "reply_to_user": {"reputation": 3320, "user_id": 4950680, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/C8cEh.jpg?s=128&g=1", "display_name": "Martin Zinovsky", "link": "https://stackoverflow.com/users/4950680/martin-zinovsky"}, "edited": false, "score": 0, "creation_date": 1521571839, "post_id": 49391462, "comment_id": 85785635, "body": "Same, doesn&#39;t call <code>proc</code>. With while loop too."}, {"owner": {"reputation": 10005, "user_id": 724036, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/6VXVJ.jpg?s=128&g=1", "display_name": "zishe", "link": "https://stackoverflow.com/users/724036/zishe"}, "edited": false, "score": 0, "creation_date": 1521575230, "post_id": 49391462, "comment_id": 85787420, "body": "yes, same behaviour."}], "answers": [{"comments": [{"owner": {"reputation": 1389, "user_id": 4133078, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/P24yz.jpg?s=128&g=1", "display_name": "Cody Gustafson", "link": "https://stackoverflow.com/users/4133078/cody-gustafson"}, "edited": false, "score": 0, "creation_date": 1521898548, "post_id": 49439986, "comment_id": 85933383, "body": "It is probably worth noting you can call <code>e.wait</code> instead of <code>sleep</code>."}, {"owner": {"reputation": 10005, "user_id": 724036, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/6VXVJ.jpg?s=128&g=1", "display_name": "zishe", "link": "https://stackoverflow.com/users/724036/zishe"}, "edited": false, "score": 0, "creation_date": 1522343820, "post_id": 49439986, "comment_id": 86131555, "body": "Thanks for detailed answer! Was out of internet, so a bit late."}], "tags": [], "owner": {"reputation": 5647, "user_id": 1162143, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/rLSfS.jpg?s=128&g=1", "display_name": "Alexander Presber", "link": "https://stackoverflow.com/users/1162143/alexander-presber"}, "is_accepted": true, "score": 4, "last_activity_date": 1521760778, "creation_date": 1521760778, "answer_id": 49439986, "question_id": 49391462, "link": "https://stackoverflow.com/questions/49391462/concurrentpromise-all-doesnt-work/49439986#49439986", "title": "Concurrent::Promise.all? doesn&#39;t work", "body": "<ol>\n<li><code>Concurrent::Promise.all?</code> returns a <code>Promise</code> and you have to execute it</li>\n<li>you have to pass <code>proc</code> as a block argument <code>&amp;proc</code></li>\n<li>you have to wait for the Promises to finish (e.g. sleep)</li>\n</ol>\n\n<p>This will work:</p>\n\n<pre><code>require 'concurrent'\n\ncbr_promise       = Concurrent::Promise.new { p \"cbr\" }\nbitfinex_promise  = Concurrent::Promise.new { p \"bitfinex\" }\n\nproc = Proc.new do\n  puts 10\nend\n\ne = Concurrent::Promise.all?(cbr_promise, bitfinex_promise).execute.then(&amp;proc)\n\nsleep 1\n</code></pre>\n\n<p>yields</p>\n\n<pre><code>\"cbr\"\n\"bitfinex\"\n10\n</code></pre>\n\n<p>Note how this will not execute <code>proc</code> because one of the Promises fails:</p>\n\n<pre><code>require 'concurrent'\n\ncbr_promise       = Concurrent::Promise.new { p \"cbr\" }\nbitfinex_promise  = Concurrent::Promise.new { p \"bitfinex\"; raise 'error' }\n\nproc = Proc.new do\n  puts 10\nend\n\ne = Concurrent::Promise.all?(cbr_promise, bitfinex_promise).execute.then(&amp;proc)\n\nsleep 1\n</code></pre>\n\n<p>yields</p>\n\n<pre><code>\"cbr\"\n\"bitfinex\"\n</code></pre>\n"}], "owner": {"reputation": 10005, "user_id": 724036, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/6VXVJ.jpg?s=128&g=1", "display_name": "zishe", "link": "https://stackoverflow.com/users/724036/zishe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 564, "favorite_count": 1, "accepted_answer_id": 49439986, "answer_count": 1, "score": 7, "last_activity_date": 1521760778, "creation_date": 1521569702, "last_edit_date": 1521571546, "question_id": 49391462, "link": "https://stackoverflow.com/questions/49391462/concurrentpromise-all-doesnt-work", "title": "Concurrent::Promise.all? doesn&#39;t work", "body": "<p>I'm trying to make some calculations after I got all promises executed. But <code>proc</code> never calls:</p>\n\n<pre><code>cbr_promise = Concurrent::Promise.execute { CbrRatesService.call }\nbitfinex_promise = Concurrent::Promise.execute { BitfinexService.call }\n\nproc = Proc.new do\n  puts 10\nend\nConcurrent::Promise.all?([cbr_promise, bitfinex_promise]).then { proc }\n</code></pre>\n\n<p>Made with <a href=\"https://github.com/ruby-concurrency/concurrent-ruby/\" rel=\"noreferrer\"><code>concurrent-ruby</code></a> gem.</p>\n\n<p>Should I create a loop that will check this every 100 ms for example?</p>\n\n<p><strong>Update</strong></p>\n\n<p>I tried to add a loop and byebug the code (in <code>sidekiq</code> worker):</p>\n\n<pre><code>while @fl\n  Concurrent::Promise.all?([cbr_promise, bitfinex_promise]).then { proc }\nend\n</code></pre>\n\n<p>but the <code>state</code> of all promises is <code>pending</code>. It could be because of byebug, but anyway the <code>proc</code> never calls.</p>\n"}, {"tags": ["ruby", "mongodb", "sinatra", "gitlab", "gitlab-ci"], "answers": [{"tags": [], "owner": {"reputation": 615, "user_id": 9354495, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4dbf4fffcc347aec0b0ce3a55407a2cc?s=128&d=identicon&r=PG&f=1", "display_name": "yuppie-flu", "link": "https://stackoverflow.com/users/9354495/yuppie-flu"}, "is_accepted": false, "score": 4, "last_activity_date": 1522067537, "creation_date": 1522067537, "answer_id": 49491576, "question_id": 49391372, "link": "https://stackoverflow.com/questions/49391372/mongodb-server-doesnt-start-at-gitlab-runner-using-gitlab-ci/49491576#49491576", "title": "MongoDB server doesn&#39;t start at gitlab runner using gitlab-ci", "body": "<p>Your MongoDB most probably runs on GitlabCI, but it is executed in the separate Docker container. It must be accessed from the tests using <code>mongo:27017</code>, not <code>localhost:27017</code>.</p>\n\n<p>Check here: <a href=\"https://docs.gitlab.com/ee/ci/docker/using_docker_images.html#accessing-the-services\" rel=\"nofollow noreferrer\">https://docs.gitlab.com/ee/ci/docker/using_docker_images.html#accessing-the-services</a></p>\n\n<p>So you should fix your configuration (mongoid.yml) appropriately.</p>\n"}, {"tags": [], "owner": {"reputation": 124, "user_id": 10206476, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9uHw7.jpg?s=128&g=1", "display_name": "Vishesh Kumar Singh", "link": "https://stackoverflow.com/users/10206476/vishesh-kumar-singh"}, "is_accepted": false, "score": 0, "last_activity_date": 1588167123, "creation_date": 1588167123, "answer_id": 61503012, "question_id": 49391372, "link": "https://stackoverflow.com/questions/49391372/mongodb-server-doesnt-start-at-gitlab-runner-using-gitlab-ci/61503012#61503012", "title": "MongoDB server doesn&#39;t start at gitlab runner using gitlab-ci", "body": "<p>The problem is with your connection string for the MongoDB database.\nSince you have used the mongo service, and no alias is put, so Gitlab takes \"mongo\" as its hostname.\nAccording to Gitlab:\nThe default aliases for the service\u2019s hostname are created from its image name following these rules:</p>\n\n<ul>\n<li>Everything after the colon (:) is stripped.</li>\n<li>Slash (/) is replaced with double underscores (__) and the primary alias is created.</li>\n<li>Slash (/) is replaced with a single dash (-) and the secondary alias is created (requires GitLab Runner v1.1.0 or higher).</li>\n</ul>\n\n<p>So, instead of localhost, you have to use <strong>mongo:27017</strong></p>\n\n<p><code>Your connection string will be like: mongodb://mongo:27017/${databaseName}</code></p>\n"}], "owner": {"reputation": 31, "user_id": 9524469, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/935a5e69532d54bad84eb2306c8f450f?s=128&d=identicon&r=PG&f=1", "display_name": "Robert John", "link": "https://stackoverflow.com/users/9524469/robert-john"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4836, "favorite_count": 1, "answer_count": 2, "score": 3, "last_activity_date": 1588167123, "creation_date": 1521569389, "question_id": 49391372, "link": "https://stackoverflow.com/questions/49391372/mongodb-server-doesnt-start-at-gitlab-runner-using-gitlab-ci", "title": "MongoDB server doesn&#39;t start at gitlab runner using gitlab-ci", "body": "<p>right now I'm in the middle at developing an application using Ruby and Mongo. But I got stuck when I deploy the application using gitlab-ci where it seems that mongo server doesn't start at test environment on gitlab runner.</p>\n\n<p>Here are my gitlab-ci.yml </p>\n\n<pre><code>stages :\n- test\n- deploy\n\nservices:\n  - mongo:latest\n\nunitTest:API:\n  image: ruby:2.6.10\n  stage: test\n  cache: \n    paths:\n      - API/vendor/\n  before_script:\n    - ruby -v\n    - gem install bundler --no-ri --no-rdoc\n    - bundle install --gemfile=API/Gemfile --path vendor\n  script:\n    - RAILS_ENV=test rspec API/spec\n    - RAILS_ENV=test rubocop API\n  artifacts:\n    paths:\n      - coverage/\n\ndeploy_coba:\n  stage: deploy\n  before_script:\n    - cd API\n  script: \n    - gem install dpl\n    - dpl --provider=heroku --app=exhibisi-cobacoba --api-key=68b12c2b-cfbc-4478-b943-f26552fb907e\n  only:\n    - coba_coba\n\nstaging:\n  stage: deploy\n  before_script:\n    - cd API\n  script: \n    - gem install dpl\n    - dpl --provider=heroku --app=exhibisi-staging --api-key=68b12c2b-cfbc-4478-b943-f26552fb907e\n  only:\n    - sit_uat\n\nproduction:\n  stage: deploy\n  before_script:\n    - cd API\n  script:\n    - gem install dpl\n    - dpl --provider=heroku --app=exhibisi-prod --api-key=68b12c2b-cfbc-4478-b943-f26552fb907e\n  only:\n    - master\n\npages:\n  stage: deploy\n  script:\n    - mv coverage/ public/\n  artifacts:\n    paths:\n      - public\n    expire_in: 30 days\n</code></pre>\n\n<p>and this are the result of the gitlab runner error</p>\n\n<pre><code>    Running with gitlab-runner 10.6.0-rc1 (0a9d5de9)\non docker-auto-scale e11ae361\nUsing Docker executor with image ruby:2.3.0 ...\nStarting service mongo:2.6.10 ...\nPulling docker image mongo:2.6.10 ...\nUsing docker image sha256:54fb6f9984dde283c9ff55f5aba7d883355793dd7997b0f9f75bb31e89607311 for mongo:2.6.10 ...\nWaiting for services to be up and running...\nPulling docker image ruby:2.3.0 ...\nUsing docker image sha256:7ca70eb2dfea00e9e3eaece33024ad5c06b7473728d559e1a3a574629de95a6a for ruby:2.3.0 ...\nRunning on runner-e11ae361-project-5550018-concurrent-0 via runner-e11ae361-srm-1521565965-49af3740...\nCloning repository...\nCloning into '/builds/cymon1997/ppl-coba'...\nChecking out 61333b01 as US02_menampilkan_daftar_produk...\nSkipping Git submodules setup\nChecking cache for default...\nFATAL: file does not exist                         \nFailed to extract cache\n$ ruby -v\nruby 2.3.0p0 (2015-12-25 revision 53290) [x86_64-linux]\n$ gem install bundler --no-ri --no-rdoc\nSuccessfully installed bundler-1.16.1\n1 gem installed\n$ bundle install --gemfile=API/Gemfile --path vendor\nFetching gem metadata from http://rubygems.org/..........\nFetching rake 12.3.0\nInstalling rake 12.3.0\nFetching concurrent-ruby 1.0.5\nInstalling concurrent-ruby 1.0.5\nFetching i18n 0.9.5\nInstalling i18n 0.9.5\nFetching minitest 5.11.3\nInstalling minitest 5.11.3\nFetching thread_safe 0.3.6\nInstalling thread_safe 0.3.6\nFetching tzinfo 1.2.5\nInstalling tzinfo 1.2.5\nFetching activesupport 5.1.5\nInstalling activesupport 5.1.5\nFetching activemodel 5.1.5\nInstalling activemodel 5.1.5\nFetching ast 2.4.0\nInstalling ast 2.4.0\nFetching bson 4.3.0\nInstalling bson 4.3.0 with native extensions\nUsing bundler 1.16.1\nFetching diff-lcs 1.3\nInstalling diff-lcs 1.3\nFetching docile 1.1.5\nInstalling docile 1.1.5\nFetching json 2.1.0\nInstalling json 2.1.0 with native extensions\nFetching mongo 2.5.1\nInstalling mongo 2.5.1\nFetching mongoid 6.3.0\nInstalling mongoid 6.3.0\nFetching mustermann 1.0.2\nInstalling mustermann 1.0.2\nFetching parallel 1.12.1\nInstalling parallel 1.12.1\nFetching parser 2.5.0.3\nInstalling parser 2.5.0.3\nFetching powerpack 0.1.1\nInstalling powerpack 0.1.1\nFetching rack 2.0.4\nInstalling rack 2.0.4\nFetching rack-protection 2.0.1\nInstalling rack-protection 2.0.1\nFetching rack-test 0.8.2\nInstalling rack-test 0.8.2\nFetching racksh 1.0.0\nInstalling racksh 1.0.0\nFetching rainbow 3.0.0\nInstalling rainbow 3.0.0\nFetching rspec-support 3.7.1\nInstalling rspec-support 3.7.1\nFetching rspec-core 3.7.1\nInstalling rspec-core 3.7.1\nFetching rspec-expectations 3.7.0\nInstalling rspec-expectations 3.7.0\nFetching rspec-mocks 3.7.0\nInstalling rspec-mocks 3.7.0\nFetching rspec 3.7.0\nInstalling rspec 3.7.0\nFetching rspec-json_expectations 2.1.0\nInstalling rspec-json_expectations 2.1.0\nFetching ruby-progressbar 1.9.0\nInstalling ruby-progressbar 1.9.0\nFetching unicode-display_width 1.3.0\nInstalling unicode-display_width 1.3.0\nFetching rubocop 0.53.0\nInstalling rubocop 0.53.0\nFetching shotgun 0.9.2\nInstalling shotgun 0.9.2\nFetching simplecov-html 0.10.2\nInstalling simplecov-html 0.10.2\nFetching simplecov 0.15.1\nInstalling simplecov 0.15.1\nFetching tilt 2.0.8\nInstalling tilt 2.0.8\nFetching sinatra 2.0.1\nInstalling sinatra 2.0.1\nBundle complete! 10 Gemfile dependencies, 39 gems now installed.\nBundled gems are installed into `./vendor`\n$ RAILS_ENV=test rspec API/spec\n...FFFF.\n\nFailures:\n\n1) ListProductController GET to /products returns status 200 OK\n    Failure/Error: expect(last_response).to be_ok\n    expected `#&lt;Rack::MockResponse:0x0056395b78af10 @original_headers={\"Content-Type\"=&gt;\"text/html\", \"Content-Length...bled the &lt;code&gt;show_exceptions&lt;/code&gt; setting.&lt;/p&gt;\\n  &lt;/div&gt; &lt;!-- /WRAP --&gt;\\n  &lt;/body&gt;\\n&lt;/html&gt;\\n\"]&gt;.ok?` to return true, got false\n    # ./API/spec/controllers/listproduct_controller_spec.rb:9:in `block (3 levels) in &lt;top (required)&gt;'\n\n2) ListProductController GET to /products show a list of product's name and its icon\n    Failure/Error:\n    Product.each do |product|\n        payload.push({ exhibit_name: product.exhibit_name, icon: product.icon })\n    end\n\n    Mongo::Error::NoServerAvailable:\n    No server is available matching preference: #&lt;Mongo::ServerSelector::Primary:0x47402175180100 tag_sets=[] max_staleness=nil&gt; using server_selection_timeout=30 and local_threshold=0.015\n    # ./API/vendor/ruby/2.3.0/gems/mongo-2.5.1/lib/mongo/server_selector/selectable.rb:119:in `select_server'\n    # ./API/vendor/ruby/2.3.0/gems/mongo-2.5.1/lib/mongo/collection/view/iterable.rb:41:in `block in each'\n    # ./API/vendor/ruby/2.3.0/gems/mongo-2.5.1/lib/mongo/retryable.rb:44:in `read_with_retry'\n    # ./API/vendor/ruby/2.3.0/gems/mongo-2.5.1/lib/mongo/collection/view/iterable.rb:40:in `each'\n    # ./API/vendor/ruby/2.3.0/gems/mongoid-6.3.0/lib/mongoid/query_cache.rb:222:in `each'\n    # ./API/vendor/ruby/2.3.0/gems/mongoid-6.3.0/lib/mongoid/contextual/mongo.rb:132:in `each'\n    # ./API/vendor/ruby/2.3.0/gems/mongoid-6.3.0/lib/mongoid/contextual.rb:20:in `each'\n    # ./API/vendor/ruby/2.3.0/gems/mongoid-6.3.0/lib/mongoid/findable.rb:15:in `each'\n    # ./API/spec/controllers/listproduct_controller_spec.rb:15:in `block (3 levels) in &lt;top (required)&gt;'\n\n3) ListProductController GET to /:id returns status 200 OK\n    Failure/Error: expect(last_response).to be_ok\n    expected `#&lt;Rack::MockResponse:0x0056395c8565b0 @original_headers={\"Content-Type\"=&gt;\"text/html\", \"Content-Length...bled the &lt;code&gt;show_exceptions&lt;/code&gt; setting.&lt;/p&gt;\\n  &lt;/div&gt; &lt;!-- /WRAP --&gt;\\n  &lt;/body&gt;\\n&lt;/html&gt;\\n\"]&gt;.ok?` to return true, got false\n    # ./API/spec/controllers/listproduct_controller_spec.rb:31:in `block (3 levels) in &lt;top (required)&gt;'\n\n4) ListProductController GET to /:id displays the product's profil\n    Failure/Error: product = Product.find_by(exhibit_id: \"EXH1\")\n\n    Mongo::Error::NoServerAvailable:\n    No server is available matching preference: #&lt;Mongo::ServerSelector::Primary:0x69881936872840 tag_sets=[] max_staleness=nil&gt; using server_selection_timeout=30 and local_threshold=0.015\n    # ./API/vendor/ruby/2.3.0/gems/mongo-2.5.1/lib/mongo/server_selector/selectable.rb:119:in `select_server'\n    # ./API/vendor/ruby/2.3.0/gems/mongo-2.5.1/lib/mongo/collection/view/iterable.rb:41:in `block in each'\n    # ./API/vendor/ruby/2.3.0/gems/mongo-2.5.1/lib/mongo/retryable.rb:44:in `read_with_retry'\n    # ./API/vendor/ruby/2.3.0/gems/mongo-2.5.1/lib/mongo/collection/view/iterable.rb:40:in `each'\n    # ./API/vendor/ruby/2.3.0/gems/mongoid-6.3.0/lib/mongoid/query_cache.rb:222:in `each'\n    # ./API/vendor/ruby/2.3.0/gems/mongoid-6.3.0/lib/mongoid/contextual/mongo.rb:278:in `first'\n    # ./API/vendor/ruby/2.3.0/gems/mongoid-6.3.0/lib/mongoid/contextual/mongo.rb:278:in `find_first'\n    # ./API/vendor/ruby/2.3.0/gems/mongoid-6.3.0/lib/mongoid/contextual.rb:20:in `find_first'\n    # ./API/vendor/ruby/2.3.0/gems/mongoid-6.3.0/lib/mongoid/findable.rb:114:in `find_by'\n    # ./API/spec/controllers/listproduct_controller_spec.rb:35:in `block (3 levels) in &lt;top (required)&gt;'\n\nFinished in 7 minutes 2 seconds (files took 1.31 seconds to load)\n8 examples, 4 failures\n\nFailed examples:\n\nrspec ./API/spec/controllers/listproduct_controller_spec.rb:7 # ListProductController GET to /products returns status 200 OK\nrspec ./API/spec/controllers/listproduct_controller_spec.rb:12 # ListProductController GET to /products show a list of product's name and its icon\nrspec ./API/spec/controllers/listproduct_controller_spec.rb:29 # ListProductController GET to /:id returns status 200 OK\nrspec ./API/spec/controllers/listproduct_controller_spec.rb:33 # ListProductController GET to /:id displays the product's profil\n\nCoverage report generated for RSpec to /builds/cymon1997/ppl-coba/coverage. 44 / 56 LOC (78.57%) covered.\nERROR: Job failed: exit code \n</code></pre>\n\n<p>and this are my mongoid.yml file :</p>\n\n<pre><code>development:\n  options:\n    raise_not_found_error: false\n  clients:\n    default:\n      database: mongoid_dev\n      hosts:\n        - localhost:27017\ntest:\n  options:\n    raise_not_found_error: false\n  clients:\n    default:\n      database: mongoid_dev\n      hosts:\n        - localhost:27017\n</code></pre>\n\n<p>Can anybody tell me what I'm missing. I search everywhere about gitlab-ci and databases but only mysql and postgre sql that showed up about this. Did I miss to run the mongo server on test? or Should I run the server from the code itself. Or it is another problem?</p>\n"}, {"tags": ["ruby", "post", "watson"], "comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1521569331, "post_id": 49391275, "comment_id": 85784201, "body": "Can you include more of the code you&#39;re using so the nature of the call is more obvious?"}, {"owner": {"reputation": 65, "user_id": 7937803, "user_type": "registered", "profile_image": "https://graph.facebook.com/10213335909301702/picture?type=large", "display_name": "Acris", "link": "https://stackoverflow.com/users/7937803/acris"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 1, "creation_date": 1521569953, "post_id": 49391275, "comment_id": 85784542, "body": "Just edited. As you can see, it should be pretty straight-forward. I just can&#39;t find the right way to structure this."}], "answers": [{"comments": [{"owner": {"reputation": 65, "user_id": 7937803, "user_type": "registered", "profile_image": "https://graph.facebook.com/10213335909301702/picture?type=large", "display_name": "Acris", "link": "https://stackoverflow.com/users/7937803/acris"}, "edited": false, "score": 0, "creation_date": 1521570452, "post_id": 49391620, "comment_id": 85784831, "body": "I thank you very much, this indeed works. I got so used to API docs that fully describe the request, I never realized I don&#39;t fully understand HTTP requests ( I guess )."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "reply_to_user": {"reputation": 65, "user_id": 7937803, "user_type": "registered", "profile_image": "https://graph.facebook.com/10213335909301702/picture?type=large", "display_name": "Acris", "link": "https://stackoverflow.com/users/7937803/acris"}, "edited": false, "score": 0, "creation_date": 1521570535, "post_id": 49391620, "comment_id": 85784882, "body": "A lot of newer APIs put the authentication in a &quot;sideband&quot; other than the JSON payload. Some argue that makes for cleaner API designs."}], "tags": [], "owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "is_accepted": true, "score": 1, "last_activity_date": 1521570201, "creation_date": 1521570201, "answer_id": 49391620, "question_id": 49391275, "link": "https://stackoverflow.com/questions/49391275/ibm-cloud-query-structure-ruby/49391620#49391620", "title": "IBM Cloud Query Structure ruby", "body": "<p>From <a href=\"https://www.ibm.com/watson/developercloud/tone-analyzer/api/v3/#authentication\" rel=\"nofollow noreferrer\">the documentation</a> it appears these credentials are not supplied via the API body, but instead via <a href=\"https://en.wikipedia.org/wiki/Basic_access_authentication\" rel=\"nofollow noreferrer\">HTTP Auth</a>. That means you call it this way:</p>\n\n<pre><code>response = HTTParty.post(\n  URL,\n  header: @header,\n  data: {\n    text: @body,\n  },\n  basic_auth: {\n    username: @user,\n    password: @password\n  }\n)\n</code></pre>\n"}], "owner": {"reputation": 65, "user_id": 7937803, "user_type": "registered", "profile_image": "https://graph.facebook.com/10213335909301702/picture?type=large", "display_name": "Acris", "link": "https://stackoverflow.com/users/7937803/acris"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 13, "favorite_count": 0, "accepted_answer_id": 49391620, "answer_count": 1, "score": 1, "last_activity_date": 1521570201, "creation_date": 1521569031, "last_edit_date": 1521569842, "question_id": 49391275, "link": "https://stackoverflow.com/questions/49391275/ibm-cloud-query-structure-ruby", "title": "IBM Cloud Query Structure ruby", "body": "<p>I am having issues understanding how to structure my request to IBM Tone Analyzer service. They do not have a SDK for ruby, so I am just trying to create a http request.</p>\n\n<p>However, I keep getting a 'no credentials supplied' response. I just do not know WHERE these credentials have to be put.</p>\n\n<p>I tried having :</p>\n\n<blockquote>\n  <p>body: {username:'...', password:'...'}</p>\n</blockquote>\n\n<p>My credentials do work, I was able to get a response with a curl command.</p>\n\n<p>I tried putting these directly in the query. I am just lost.</p>\n\n<p>EDIT: I am using HTTParty to make my request. Currently I am putting my credentials in every field I can think about, so it looks like</p>\n\n<pre><code>response = HTTParty.post(\n  URL,\n  header: @header,\n  data: {\n    text: @body,\n    username: @user,\n    password: @password\n  },\n  body: {\n    text: @body,\n    username: @user,\n    password: @password\n  },\n  credentials: {\n    text: @body,\n    username: @user,\n    password: @password\n  },\n  user: {\n    username: @user,\n    password: @password\n  },\n  options: {\n    username: @user,\n    password: @password\n  },\n  query: {\n    text: @body,\n    username: @user,\n    password: @password\n  })\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1521568185, "post_id": 49390861, "comment_id": 85783470, "body": "<code>average</code> is a query method (well a <code>CalculationMethod</code> to be exact). This requires a database call to use SQL average function. To avoid this you could do <code>map {|x| x.owned_ratings.inject(0) { |sum, n| sum + n.score } &#47; x.owned_ratings.size }</code>"}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "reply_to_user": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1521568257, "post_id": 49390861, "comment_id": 85783534, "body": "@engineersmnky: ah, but why isn&#39;t it smart enough to use already available data? This expectation is not entirely unreasonable."}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "reply_to_user": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1521568580, "post_id": 49390861, "comment_id": 85783731, "body": "@SergioTulentsev I don&#39;t understand the question? The &quot;already available data&quot; is not a thing. rails won&#39;t even execute the query until you act on <code>owned_ratings</code> and the action being taken is the <code>average</code> method which results in a query. Essentially the query to act on the list would have to be <code>SELECT user_id, AVG(ratings.score) as alias FROM ratings where ratings.user_id IN (list)</code> and then this would have to some how be re associated back into the <code>OwnedRating</code> object."}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "reply_to_user": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1521568744, "post_id": 49390861, "comment_id": 85783845, "body": "@engineersmnky: I&#39;m just rephrasing what I think it is OP means :)"}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1521568825, "post_id": 49390861, "comment_id": 85783886, "body": "I guess you could do <code>User.joins(:owned_ratings).select(*User.column_names).select&zwnj;&#8203;(&quot;AVG(ratings.score) as average_rating_score&quot;).group(*User.column_names)</code> which theoretically could work and will add a virtual attribute of <code>average_rating_score</code> to the <code>User</code> objects"}], "answers": [{"comments": [{"owner": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "edited": false, "score": 1, "creation_date": 1521569180, "post_id": 49390998, "comment_id": 85784085, "body": "Another key point is that the result of performing an aggregate method in Ruby might actually give different results if there is a lot of write activity in the DB since the fetched data may be stale."}], "tags": [], "owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "is_accepted": true, "score": 5, "last_activity_date": 1521568115, "creation_date": 1521568115, "answer_id": 49390998, "question_id": 49390861, "link": "https://stackoverflow.com/questions/49390861/ruby-on-rails-average-method-causes-n1-queries/49390998#49390998", "title": "Ruby on Rails average method causes n+1 queries", "body": "<blockquote>\n  <p>Why <code>includes</code> is not working with aggregate methods? </p>\n</blockquote>\n\n<p>Because it would not make sense to reimplement aggregate methods in ruby, when the database server can do the work so much faster.</p>\n\n<p>In fact, if this is what you need to do, it would probably be better to prepare and execute a raw SQL query, so that entire iteration is done in the database, therefore avoiding roundtrips and N+1 (not to mention loading <strong>everything</strong>).</p>\n"}, {"tags": [], "owner": {"reputation": 3320, "user_id": 4950680, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/C8cEh.jpg?s=128&g=1", "display_name": "Martin Zinovsky", "link": "https://stackoverflow.com/users/4950680/martin-zinovsky"}, "is_accepted": false, "score": 2, "last_activity_date": 1521569037, "last_edit_date": 1521569037, "creation_date": 1521568326, "answer_id": 49391067, "question_id": 49390861, "link": "https://stackoverflow.com/questions/49390861/ruby-on-rails-average-method-causes-n1-queries/49391067#49391067", "title": "Ruby on Rails average method causes n+1 queries", "body": "<p>Because <a href=\"https://apidock.com/rails/ActiveRecord/Calculations/average\" rel=\"nofollow noreferrer\">average</a> actually requires sql query? Try something like:</p>\n\n<pre><code>User.includes(:owned_ratings).map{ |x| x.owned_ratings.map(&amp;:score).instance_eval { reduce(:+) / size.to_f } }\n</code></pre>\n\n<p>Method to calc average in array got from this <a href=\"https://stackoverflow.com/questions/1341271/how-do-i-create-an-average-from-a-ruby-array\">SO answer</a>. Efficiency depends on how much <code>owned_ratings</code> records there are.</p>\n\n<p>Oh <a href=\"https://stackoverflow.com/questions/49390861/ruby-on-rails-average-method-causes-n1-queries/49390998#49390998\">Sergio Tulentsev</a> is right and its better to do on db side</p>\n"}, {"comments": [{"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1521568675, "post_id": 49391175, "comment_id": 85783801, "body": "Aggregate function without a GROUP BY clause"}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1521568891, "post_id": 49391175, "comment_id": 85783928, "body": "Still may be an issue (potentially database dependent) given that &quot;username&quot; (or other user.* columns) is not specified in the group by or an aggregate function"}, {"owner": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "reply_to_user": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1521568949, "post_id": 49391175, "comment_id": 85783958, "body": "Yeah its hard to give an actual working example without more details @engineersmnky. But its a nudge in the right direction."}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 2, "creation_date": 1521569005, "post_id": 49391175, "comment_id": 85783985, "body": "Yeah I was thinking more like my comment above <code>User.joins(:owned_ratings).select(*User.column_names).select&zwnj;&#8203;(&quot;AVG(ratings.score) as average_rating_score&quot;).group(*User.column_names)</code>"}], "tags": [], "owner": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "is_accepted": false, "score": 3, "last_activity_date": 1521568806, "last_edit_date": 1521568806, "creation_date": 1521568649, "answer_id": 49391175, "question_id": 49390861, "link": "https://stackoverflow.com/questions/49390861/ruby-on-rails-average-method-causes-n1-queries/49391175#49391175", "title": "Ruby on Rails average method causes n+1 queries", "body": "<p>This is pretty trivial to accomplish with SQL: </p>\n\n<pre><code>@users = User.select(\n  'users.*, AVG(ratings.score) AS users.average_score'\n).group_by('ratings.user_id').joins(:ratings)\n\n@users.map(&amp;:average_score)\n</code></pre>\n"}], "owner": {"reputation": 5714, "user_id": 2389501, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/23f6a708c04c660111117c4613592689?s=128&d=identicon&r=PG", "display_name": "Mateusz Urba\u0144ski", "link": "https://stackoverflow.com/users/2389501/mateusz-urba%c5%84ski"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 477, "favorite_count": 1, "accepted_answer_id": 49390998, "answer_count": 3, "score": 7, "last_activity_date": 1521569037, "creation_date": 1521567638, "question_id": 49390861, "link": "https://stackoverflow.com/questions/49390861/ruby-on-rails-average-method-causes-n1-queries", "title": "Ruby on Rails average method causes n+1 queries", "body": "<p>I have the following script:</p>\n\n<pre><code>User.includes(:owned_ratings).map{|x| x.owned_ratings.average(:score)}\n</code></pre>\n\n<p>calling <code>x.owned_ratings.average(:score)</code> causes n+1 queries:</p>\n\n<pre><code>   (0.2ms)  SELECT AVG(\"ratings\".\"score\") FROM \"ratings\" INNER JOIN \"video_chats\" ON \"ratings\".\"video_chat_id\" = \"video_chats\".\"id\" WHERE \"video_chats\".\"user_id\" = $1  [[\"user_id\", 4]]\n   (0.1ms)  SELECT AVG(\"ratings\".\"score\") FROM \"ratings\" INNER JOIN \"video_chats\" ON \"ratings\".\"video_chat_id\" = \"video_chats\".\"id\" WHERE \"video_chats\".\"user_id\" = $1  [[\"user_id\", 1]]\n   (0.1ms)  SELECT AVG(\"ratings\".\"score\") FROM \"ratings\" INNER JOIN \"video_chats\" ON \"ratings\".\"video_chat_id\" = \"video_chats\".\"id\" WHERE \"video_chats\".\"user_id\" = $1  [[\"user_id\", 5]]\n   (0.1ms)  SELECT AVG(\"ratings\".\"score\") FROM \"ratings\" INNER JOIN \"video_chats\" ON \"ratings\".\"video_chat_id\" = \"video_chats\".\"id\" WHERE \"video_chats\".\"user_id\" = $1  [[\"user_id\", 7]]\n   (0.1ms)  SELECT AVG(\"ratings\".\"score\") FROM \"ratings\" INNER JOIN \"video_chats\" ON \"ratings\".\"video_chat_id\" = \"video_chats\".\"id\" WHERE \"video_chats\".\"user_id\" = $1  [[\"user_id\", 3]]\n</code></pre>\n\n<p>Why includes is not working with aggregate methods? Is there any way to fix that? I know that I can implement average method on my own and omit the problem but I want to be sure that there is not better solution for that.</p>\n"}, {"tags": ["mysql", "ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "edited": false, "score": 0, "creation_date": 1521565238, "post_id": 49389992, "comment_id": 85781653, "body": "<a href=\"https://dev.mysql.com/doc/refman/5.7/en/privileges-provided.html\" rel=\"nofollow noreferrer\">dev.mysql.com/doc/refman/5.7/en/privileges-provided.html</a>"}], "answers": [{"comments": [{"owner": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "edited": false, "score": 0, "creation_date": 1521565579, "post_id": 49390120, "comment_id": 85781828, "body": "You can always use the Rails <code>DATABASE_URL</code> env var to connect to the database as a more privileged user for performing migrations."}, {"owner": {"reputation": 494, "user_id": 1836846, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/0110aa4330cfdf3bfe83a65861a99eb9?s=128&d=identicon&r=PG", "display_name": "MSD", "link": "https://stackoverflow.com/users/1836846/msd"}, "edited": false, "score": 0, "creation_date": 1521566946, "post_id": 49390120, "comment_id": 85782654, "body": "I&#39;ll confirm this answer once I test it out; thanks for the response!"}], "tags": [], "owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "is_accepted": true, "score": 1, "last_activity_date": 1521565242, "creation_date": 1521565242, "answer_id": 49390120, "question_id": 49389992, "link": "https://stackoverflow.com/questions/49389992/what-mysql-permissions-do-i-need-to-provide-remove-to-prevent-rails-dbreset/49390120#49390120", "title": "What MySQL permissions do I need to provide/remove to prevent Rails&#39; db:reset?", "body": "<p>You probably want to remove the <a href=\"https://dev.mysql.com/doc/refman/5.7/en/privileges-provided.html#priv_drop\" rel=\"nofollow noreferrer\">DROP privilege</a> from your Rails database user.</p>\n\n<p>Keep in mind that the <code>DROP</code> privilege is required too when you want to want to drop a table. </p>\n\n<p>That said: Removing the <code>DROP</code> privilege will cost you the possibility to run <code>drop_table</code> in migration. That might not be an option or it might actually be a good thing - that depends on your requirements.</p>\n"}], "owner": {"reputation": 494, "user_id": 1836846, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/0110aa4330cfdf3bfe83a65861a99eb9?s=128&d=identicon&r=PG", "display_name": "MSD", "link": "https://stackoverflow.com/users/1836846/msd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 102, "favorite_count": 0, "accepted_answer_id": 49390120, "answer_count": 1, "score": 1, "last_activity_date": 1521565242, "creation_date": 1521564825, "question_id": 49389992, "link": "https://stackoverflow.com/questions/49389992/what-mysql-permissions-do-i-need-to-provide-remove-to-prevent-rails-dbreset", "title": "What MySQL permissions do I need to provide/remove to prevent Rails&#39; db:reset?", "body": "<p>My goal is disable the option for users to call <code>rake db:reset</code> on a production machine.</p>\n\n<p>Is there a way to do this via MySQL user permissions (prevent users from making destructive queries)? Is there a way to limit tasks to administrative accounts only? Is there a better way to approach this problem?</p>\n"}, {"tags": ["ruby", "postgresql"], "comments": [{"owner": {"reputation": 2577, "user_id": 1302317, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/Y8lqC.jpg?s=128&g=1", "display_name": "Troy Carlson", "link": "https://stackoverflow.com/users/1302317/troy-carlson"}, "edited": false, "score": 0, "creation_date": 1521564776, "post_id": 49389934, "comment_id": 85781357, "body": "If that is your real username/password, please remove it."}, {"owner": {"reputation": 83, "user_id": 9419102, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/3b0a94b437e39bbb234559d4300691ef?s=128&d=identicon&r=PG&f=1", "display_name": "Fatna", "link": "https://stackoverflow.com/users/9419102/fatna"}, "reply_to_user": {"reputation": 2577, "user_id": 1302317, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/Y8lqC.jpg?s=128&g=1", "display_name": "Troy Carlson", "link": "https://stackoverflow.com/users/1302317/troy-carlson"}, "edited": false, "score": 0, "creation_date": 1521565056, "post_id": 49389934, "comment_id": 85781533, "body": "Thanks Troy, I have removed it ."}, {"owner": {"reputation": 14010, "user_id": 3109182, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/a4b305f0077055b4fdcf715067775d5a?s=128&d=identicon&r=PG", "display_name": "Anthony", "link": "https://stackoverflow.com/users/3109182/anthony"}, "edited": false, "score": 0, "creation_date": 1521565646, "post_id": 49389934, "comment_id": 85781872, "body": "What needs to be compared?  everything? only some fields? is there a unique key that they both share?"}, {"owner": {"reputation": 83, "user_id": 9419102, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/3b0a94b437e39bbb234559d4300691ef?s=128&d=identicon&r=PG&f=1", "display_name": "Fatna", "link": "https://stackoverflow.com/users/9419102/fatna"}, "edited": false, "score": 0, "creation_date": 1521569411, "post_id": 49389934, "comment_id": 85784243, "body": "we need to compare records are the same between the two tables."}, {"owner": {"reputation": 2140, "user_id": 704503, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/mfGyq.jpg?s=128&g=1", "display_name": "Aleksei Zabrodskii", "link": "https://stackoverflow.com/users/704503/aleksei-zabrodskii"}, "edited": false, "score": 0, "creation_date": 1521587877, "post_id": 49389934, "comment_id": 85793152, "body": "@Fatna just so you know, there is edit history for questions and answers and everyone can see previous versions."}], "answers": [{"comments": [{"owner": {"reputation": 83, "user_id": 9419102, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/3b0a94b437e39bbb234559d4300691ef?s=128&d=identicon&r=PG&f=1", "display_name": "Fatna", "link": "https://stackoverflow.com/users/9419102/fatna"}, "edited": false, "score": 0, "creation_date": 1521569520, "post_id": 49390645, "comment_id": 85784311, "body": "Thanks , this is a nice solution, is there any way to find what are the records that are different ? Thanks,"}, {"owner": {"reputation": 1996, "user_id": 2266745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d8dbda830486b6365a4410bf7a6932c9?s=128&d=identicon&r=PG", "display_name": "jumichot", "link": "https://stackoverflow.com/users/2266745/jumichot"}, "reply_to_user": {"reputation": 83, "user_id": 9419102, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/3b0a94b437e39bbb234559d4300691ef?s=128&d=identicon&r=PG&f=1", "display_name": "Fatna", "link": "https://stackoverflow.com/users/9419102/fatna"}, "edited": false, "score": 0, "creation_date": 1521578383, "post_id": 49390645, "comment_id": 85789118, "body": "I&#39;m not really sure, you could select the id + the name and check differences in ruby like in my example, but I don&#39;t think you have the same ids in the two tables. I just thought of another solution. Why doing that in ruby when you can use sql joins ? check my edit"}, {"owner": {"reputation": 83, "user_id": 9419102, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/3b0a94b437e39bbb234559d4300691ef?s=128&d=identicon&r=PG&f=1", "display_name": "Fatna", "link": "https://stackoverflow.com/users/9419102/fatna"}, "edited": false, "score": 0, "creation_date": 1521638787, "post_id": 49390645, "comment_id": 85816248, "body": "Thanks jumichot, but if you read my question, the tables to be compared come from two different databases (postgres and sql server), so we can&#39;t use a sql join."}, {"owner": {"reputation": 83, "user_id": 9419102, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/3b0a94b437e39bbb234559d4300691ef?s=128&d=identicon&r=PG&f=1", "display_name": "Fatna", "link": "https://stackoverflow.com/users/9419102/fatna"}, "edited": false, "score": 0, "creation_date": 1521647528, "post_id": 49390645, "comment_id": 85823472, "body": "Ho to compare results to results2 ?"}, {"owner": {"reputation": 1996, "user_id": 2266745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d8dbda830486b6365a4410bf7a6932c9?s=128&d=identicon&r=PG", "display_name": "jumichot", "link": "https://stackoverflow.com/users/2266745/jumichot"}, "reply_to_user": {"reputation": 83, "user_id": 9419102, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/3b0a94b437e39bbb234559d4300691ef?s=128&d=identicon&r=PG&f=1", "display_name": "Fatna", "link": "https://stackoverflow.com/users/9419102/fatna"}, "edited": false, "score": 0, "creation_date": 1521726325, "post_id": 49390645, "comment_id": 85862135, "body": "These are the results of substracting in the two ways to see all the differences between dataset : result wil give you the records that are only in the first database, and result2 the records that are only in the second database"}], "tags": [], "owner": {"reputation": 1996, "user_id": 2266745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d8dbda830486b6365a4410bf7a6932c9?s=128&d=identicon&r=PG", "display_name": "jumichot", "link": "https://stackoverflow.com/users/2266745/jumichot"}, "is_accepted": false, "score": 0, "last_activity_date": 1521578418, "last_edit_date": 1521578418, "creation_date": 1521566984, "answer_id": 49390645, "question_id": 49389934, "link": "https://stackoverflow.com/questions/49389934/ruby-postgres-compare-data-from-two-tables-coming-from-two-databases/49390645#49390645", "title": "ruby, postgres ,compare data from two tables coming from two databases", "body": "<p>The quick and dirty way would be to do a fast checking on one column, for example the name of the companies and compare the results to see the differences by substracting the resulting arrays :</p>\n\n<pre><code>require 'pg'\npg_conn = PGconn.connect(\"localhost\", 5432, '', '', \"myDB\", \"userxx\", \"Zazzz\")\n\nall_children = pg_conn.exec(\"SELECT name from COMPANY;\") \nall_children2 = pg_conn.exec(\"SELECT name from COMPANY2;\")\n\n# first check the count, if it's the same it's probably a good sign\nputs all_children.length\nputs all_children2.length\n\n# check differences\nresults = all_children.uniq - all_children2.uniq\nresults2 = all_children2.uniq - all_children.uniq\n</code></pre>\n\n<p>For more complex tests you can maybe use the scientist gem from github : <a href=\"https://github.com/github/scientist\" rel=\"nofollow noreferrer\">https://github.com/github/scientist</a> </p>\n\n<p>Edit:\nsql version ? </p>\n\n<pre><code> select * from company left outer join company2 on company.name = company.name2 where company2.name is null;\n</code></pre>\n"}], "owner": {"reputation": 83, "user_id": 9419102, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/3b0a94b437e39bbb234559d4300691ef?s=128&d=identicon&r=PG&f=1", "display_name": "Fatna", "link": "https://stackoverflow.com/users/9419102/fatna"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 145, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1521578418, "creation_date": 1521564619, "last_edit_date": 1521565028, "question_id": 49389934, "link": "https://stackoverflow.com/questions/49389934/ruby-postgres-compare-data-from-two-tables-coming-from-two-databases", "title": "ruby, postgres ,compare data from two tables coming from two databases", "body": "<p>we have a database legacy from a SQL SERVER, and now the new database is a postgres, I would like to do some testing to see if the content is the same from both tables, sinnce I still don't have acess to the legacy database (SQL server), I said let play with the new postgres database by polling two table and try to compare the data, in the iteration loop I got confused, any idea will be helpful :</p>\n\n<pre><code>require 'pg'\npg_conn = PGconn.connect(\"localhost\", 5432, '', '', \"myDB\", \"userxx\", \"Zazzz\")\n\nall_children = pg_conn.exec(\"SELECT * from COMPANY;\") \nall_children2 = pg_conn.exec(\"SELECT * from COMPANY2;\")\n\nall_children.each do |child|\n??????\nend\n</code></pre>\n\n<p>Thanks,</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "mailjet"], "answers": [{"tags": [], "owner": {"reputation": 96, "user_id": 6886914, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/003791b091a398540bd0bb176ac6a72b?s=128&d=identicon&r=PG&f=1", "display_name": "prabhat", "link": "https://stackoverflow.com/users/6886914/prabhat"}, "is_accepted": false, "score": 0, "last_activity_date": 1522045452, "creation_date": 1522045452, "answer_id": 49485161, "question_id": 49389761, "link": "https://stackoverflow.com/questions/49389761/unable-to-integrate-mailjet-in-ruby-on-rails-application/49485161#49485161", "title": "unable to integrate mailjet in ruby on rails application", "body": "<p>Got the answer , actually i had forgot to restart unicorn server that was the reason my mailjet varible was getting undifined,\nfrom console i ran command </p>\n\n<pre><code>etc/init.d/service unicorn_&lt;project-name&gt; restart.\n</code></pre>\n\n<p>thats it.</p>\n"}], "owner": {"reputation": 96, "user_id": 6886914, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/003791b091a398540bd0bb176ac6a72b?s=128&d=identicon&r=PG&f=1", "display_name": "prabhat", "link": "https://stackoverflow.com/users/6886914/prabhat"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 149, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1522045452, "creation_date": 1521564113, "last_edit_date": 1521608765, "question_id": 49389761, "link": "https://stackoverflow.com/questions/49389761/unable-to-integrate-mailjet-in-ruby-on-rails-application", "title": "unable to integrate mailjet in ruby on rails application", "body": "<p>i am new to ruby-on-rails and due to project requirements ive been trying to integrate mailjet to my project. i had followed this link \n    <a href=\"https://github.com/mailjet/mailjet-gem\" rel=\"nofollow noreferrer\">https://github.com/mailjet/mailjet-gem</a> but unable to integrate it properly.\nin config/development.rb i am having</p>\n\n<pre><code>config.action_mailer.delivery_method = :mailjet\n</code></pre>\n\n<p>and my mailjet.rb is also properly created but when im trying to send mail i am getting </p>\n\n<pre><code>undefined delivery method :mailjet\n</code></pre>\n\n<p>and<br>\n    OpenSSL::SSL::SSLError (hostname \u201clocalhost\u201d does not match the server certificate)</p>\n\n<p>i am using rails 4 and ruby 2.</p>\n\n<p>when i integrated mailjet on localmachine within no time it started working but when i am following same steps on prod server i'm getting above errors.</p>\n"}, {"tags": ["ruby", "rethinkdb", "rethinkdb-ruby"], "comments": [{"owner": {"reputation": 13, "user_id": 5431757, "user_type": "registered", "profile_image": "https://graph.facebook.com/1162545037093456/picture?type=large", "display_name": "Alexander Nikolaev", "link": "https://stackoverflow.com/users/5431757/alexander-nikolaev"}, "reply_to_user": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 0, "creation_date": 1521566271, "post_id": 49389058, "comment_id": 85782239, "body": "How I can pass array to arguments?"}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 5431757, "user_type": "registered", "profile_image": "https://graph.facebook.com/1162545037093456/picture?type=large", "display_name": "Alexander Nikolaev", "link": "https://stackoverflow.com/users/5431757/alexander-nikolaev"}, "edited": false, "score": 0, "creation_date": 1521567696, "post_id": 49390510, "comment_id": 85783141, "body": "Thank you for help"}, {"owner": {"reputation": 13, "user_id": 5431757, "user_type": "registered", "profile_image": "https://graph.facebook.com/1162545037093456/picture?type=large", "display_name": "Alexander Nikolaev", "link": "https://stackoverflow.com/users/5431757/alexander-nikolaev"}, "edited": false, "score": 0, "creation_date": 1521573436, "post_id": 49390510, "comment_id": 85786511, "body": "I aceepted this answer, but I can&#39;t vote, because I have low rating"}], "tags": [], "owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "is_accepted": true, "score": 1, "last_activity_date": 1521566469, "creation_date": 1521566469, "answer_id": 49390510, "question_id": 49389058, "link": "https://stackoverflow.com/questions/49389058/how-to-get-many-documents-from-rethinkdb-by-array-of-ids/49390510#49390510", "title": "How to get many documents from RethinkDB by array of ids?", "body": "<p>To expand your <code>ids</code> array into a list of arguments (that is expected by the <code>get_all</code> method) use the splat operator (<code>*array</code>) like this:</p>\n\n<pre><code>ids = [1, 2, 3, 4]\nr.table('users').get_all(*ids, index: 'id') # note the `*`\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 5431757, "user_type": "registered", "profile_image": "https://graph.facebook.com/1162545037093456/picture?type=large", "display_name": "Alexander Nikolaev", "link": "https://stackoverflow.com/users/5431757/alexander-nikolaev"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 81, "favorite_count": 0, "accepted_answer_id": 49390510, "answer_count": 1, "score": 1, "last_activity_date": 1521566469, "creation_date": 1521562095, "question_id": 49389058, "link": "https://stackoverflow.com/questions/49389058/how-to-get-many-documents-from-rethinkdb-by-array-of-ids", "title": "How to get many documents from RethinkDB by array of ids?", "body": "<p>I have array of ids</p>\n\n<pre><code>ids = [1, 2, 3, 4, ...] #1000 ids\n</code></pre>\n\n<p>How I can use this function:</p>\n\n<pre><code>r.table(\"users\").get_all(1, 2, 3, 4, ..1000 ids.., index: \"id\")\n</code></pre>\n\n<p>I can use </p>\n\n<pre><code>r.table(\"users\").filter{ |doc| r.expr(ids).contains(doc[\"id\"])}\n</code></pre>\n\n<p>But it is too slow on DB with 6 mln docs</p>\n\n<p>methods taken here <a href=\"https://www.rethinkdb.com/docs/sql-to-reql/ruby/#select\" rel=\"nofollow noreferrer\">SQL to ReQL cheat sheet</a></p>\n"}, {"tags": ["ruby-on-rails", "arrays", "json", "ruby"], "comments": [{"owner": {"reputation": 10688, "user_id": 790884, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/27659e10cd4f89b49d677aacc2ebc064?s=128&d=identicon&r=PG", "display_name": "Thomas Edwards", "link": "https://stackoverflow.com/users/790884/thomas-edwards"}, "edited": false, "score": 0, "creation_date": 1521561470, "post_id": 49388792, "comment_id": 85779132, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/12723094/parse-json-to-object-ruby\">parse json to object ruby</a>"}, {"owner": {"reputation": 5141, "user_id": 193980, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/aafa8848c4b764f080b1b31a51eab73d?s=128&d=identicon&r=PG", "display_name": "Phlip", "link": "https://stackoverflow.com/users/193980/phlip"}, "edited": false, "score": 2, "creation_date": 1521561552, "post_id": 49388792, "comment_id": 85779188, "body": "Use <code>JSON.parse(body)</code> to convert your json to a hash. Then use <code>hash.dig(&#39;stats&#39;, &#39;score&#39;, &#39;globalScore&#39;, 0, &#39;value&#39;)</code> to run queries on that hash."}, {"owner": {"reputation": 858, "user_id": 3323914, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/2599375be6504817c1e736137bf0aa63?s=128&d=identicon&r=PG&f=1", "display_name": "deez", "link": "https://stackoverflow.com/users/3323914/deez"}, "edited": false, "score": 0, "creation_date": 1521561833, "post_id": 49388792, "comment_id": 85779383, "body": "Looks like the json data you posted is missing some &quot;}&quot;, can you post the original one?"}, {"owner": {"reputation": 301, "user_id": 7572104, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/i976n.png?s=128&g=1", "display_name": "Tearzz", "link": "https://stackoverflow.com/users/7572104/tearzz"}, "edited": false, "score": 0, "creation_date": 1521561996, "post_id": 49388792, "comment_id": 85779503, "body": "The original JSON data is wayyyyy too long."}, {"owner": {"reputation": 301, "user_id": 7572104, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/i976n.png?s=128&g=1", "display_name": "Tearzz", "link": "https://stackoverflow.com/users/7572104/tearzz"}, "reply_to_user": {"reputation": 5141, "user_id": 193980, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/aafa8848c4b764f080b1b31a51eab73d?s=128&d=identicon&r=PG", "display_name": "Phlip", "link": "https://stackoverflow.com/users/193980/phlip"}, "edited": false, "score": 0, "creation_date": 1521562084, "post_id": 49388792, "comment_id": 85779566, "body": "@Phlip that worked thanks! :D"}], "answers": [{"tags": [], "owner": {"reputation": 5141, "user_id": 193980, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/aafa8848c4b764f080b1b31a51eab73d?s=128&d=identicon&r=PG", "display_name": "Phlip", "link": "https://stackoverflow.com/users/193980/phlip"}, "is_accepted": false, "score": 1, "last_activity_date": 1521565304, "creation_date": 1521565304, "answer_id": 49390142, "question_id": 49388792, "link": "https://stackoverflow.com/questions/49388792/extracting-specific-json-data/49390142#49390142", "title": "Extracting specific JSON data", "body": "<p>Use <code>JSON.parse(body)</code> to convert your json to a hash. Then use <code>hash.dig('stats', 'score', 'globalScore', 0, 'value')</code> to run queries on that hash. </p>\n"}, {"tags": [], "owner": {"reputation": 662, "user_id": 5299483, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YE5QQ.jpg?s=128&g=1", "display_name": "Lemon Cat", "link": "https://stackoverflow.com/users/5299483/lemon-cat"}, "is_accepted": true, "score": 1, "last_activity_date": 1521566156, "creation_date": 1521566156, "answer_id": 49390408, "question_id": 49388792, "link": "https://stackoverflow.com/questions/49388792/extracting-specific-json-data/49390408#49390408", "title": "Extracting specific JSON data", "body": "<p>I believe the problem here is that <code>data[\"globalScore\"][\"lifetimeScore\"][\"value\"]</code> doesn't reference a valid \"path\" within the JSON.  Better formatting helps to clarify this:</p>\n\n<pre><code>  hash = {\n    \"accountId\" =&gt; \"some-private-really-long-account-id\",\n    \"stats\" =&gt; {\n      \"score\" =&gt; {\n        \"globalScore\" =&gt; [\n          {\n            \"key\"   =&gt; \"lifetimeScore\", \n            \"value\" =&gt; \"571\", \n            \"key\"   =&gt; \"someOtherKeyHere\", \n            \"value\" =&gt; \"someValue\"\n          }\n        ]\n      }\n    }\n  }\n</code></pre>\n\n<p>This Ruby hash has some issues since a hash can't actually have multiple values for a given key, but that aside, </p>\n\n<pre><code>hash['stats']['score']['globalScore'][0]['value']\n</code></pre>\n\n<p>is a perfectly valid way to access the 'value' field.  </p>\n\n<p>My point is that the problem with the original question is not that hash#dig(...) should be used (as shown by @Phlip), it is that the \"path\" through the Hash data structure was actually invalid.</p>\n\n<pre><code>hash.dig(\"globalScore\", \"lifetimeScore\", \"value)\n</code></pre>\n\n<p>will fail just like the bracketed syntax in the original question.</p>\n"}], "owner": {"reputation": 301, "user_id": 7572104, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/i976n.png?s=128&g=1", "display_name": "Tearzz", "link": "https://stackoverflow.com/users/7572104/tearzz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 86, "favorite_count": 0, "accepted_answer_id": 49390408, "answer_count": 2, "score": 0, "last_activity_date": 1521570284, "creation_date": 1521561395, "last_edit_date": 1521570284, "question_id": 49388792, "link": "https://stackoverflow.com/questions/49388792/extracting-specific-json-data", "title": "Extracting specific JSON data", "body": "<p>I receive (similar to) the following JSON data:</p>\n\n<pre><code>    {\"accountId\"=&gt;\"some-private-really-long-account-id\",\n     \"stats\"=&gt;\n      {\"score\"=&gt;\n        {\"globalScore\"=&gt;\n          [{\"key\"=&gt;\"lifetimeScore\", \"value\"=&gt;\"571\",\n\n          \"key\"=&gt;\"someOtherKeyHere\", \"value\"=&gt;\"someValue\"}]}\n</code></pre>\n\n<p>I am not quite sure how I would get the lifetime score. I've tried doing stuff like this:</p>\n\n<pre><code>puts data[\"globalScore\"][\"lifetimeScore\"][\"value\"]\n</code></pre>\n\n<p>But that doesn't work. (<code>data</code> is of course the JSON data received).</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-5"], "answers": [{"comments": [{"owner": {"reputation": 764, "user_id": 552941, "user_type": "registered", "accept_rate": 20, "profile_image": "https://i.stack.imgur.com/HYsSP.jpg?s=128&g=1", "display_name": "Fernando Aureliano", "link": "https://stackoverflow.com/users/552941/fernando-aureliano"}, "edited": false, "score": 0, "creation_date": 1522673438, "post_id": 49390011, "comment_id": 86229731, "body": "It works. But how can I add the render &lt;%= render todo_list.todo_items, todo_list %&gt; to add items to each list?"}], "tags": [], "owner": {"reputation": 3521, "user_id": 2521680, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/6D935.jpg?s=128&g=1", "display_name": "Rockwell Rice", "link": "https://stackoverflow.com/users/2521680/rockwell-rice"}, "is_accepted": false, "score": 1, "last_activity_date": 1521564880, "creation_date": 1521564880, "answer_id": 49390011, "question_id": 49388707, "link": "https://stackoverflow.com/questions/49388707/rails5-todo-lists/49390011#49390011", "title": "Rails5: Todo Lists", "body": "<p>Since the relationship is set up in the model you can use that to accomplish this.</p>\n\n<pre><code>&lt;% @todo_lists.each do |todo_list| %&gt;\n  &lt;div class=\"index_row clearfix\"&gt;\n    &lt;h2 class=\"todo_list_title\"&gt;&lt;%= link_to todo_list.title, todo_list %&gt;&lt;/h2&gt;\n    &lt;p class=\"todo_list_sub_title\"&gt;&lt;%= todo_list.description %&gt;&lt;/p&gt;\n  &lt;/div&gt;\n  &lt;% if todo_list.todo_items.any? %&gt; # This will use the relationship set up to find any items belonging to this todo list\n    &lt;% todo_list.todo_items.each do | item | %&gt; # Loop through the todo items for this list\n       # code goes in here for the item, whatever you are thinking\n       &lt;p&gt;&lt;%= item.content %&gt;&lt;/p&gt; # or whatever you may need for the item\n    &lt;% end %&gt;\n  &lt;% end %&gt;\n&lt;% end %&gt;\n</code></pre>\n"}], "owner": {"reputation": 764, "user_id": 552941, "user_type": "registered", "accept_rate": 20, "profile_image": "https://i.stack.imgur.com/HYsSP.jpg?s=128&g=1", "display_name": "Fernando Aureliano", "link": "https://stackoverflow.com/users/552941/fernando-aureliano"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 46, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1521564880, "creation_date": 1521561162, "question_id": 49388707, "link": "https://stackoverflow.com/questions/49388707/rails5-todo-lists", "title": "Rails5: Todo Lists", "body": "<p>I'm using as base <a href=\"https://github.com/zeitchef/todo\" rel=\"nofollow noreferrer\">this project</a> to work with todo lists. In this project, we can create multiple todo lists, click at them and open a sepecific todo list tp see or check items. What I want is at the index.html.erb when the todo lists are listed, the items of each one also be listed with the todo lists, so I can have the checklists and they items at the same place on index.html.erb. Someone know wich is the best practice todo that?</p>\n\n<p>Thanks</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 5141, "user_id": 193980, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/aafa8848c4b764f080b1b31a51eab73d?s=128&d=identicon&r=PG", "display_name": "Phlip", "link": "https://stackoverflow.com/users/193980/phlip"}, "edited": false, "score": 1, "creation_date": 1521560339, "post_id": 49388378, "comment_id": 85778317, "body": "Try <code>@policy.create_insured(...)</code>."}, {"owner": {"reputation": 408, "user_id": 1987724, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/IsH6B.jpg?s=128&g=1", "display_name": "Fam", "link": "https://stackoverflow.com/users/1987724/fam"}, "reply_to_user": {"reputation": 5141, "user_id": 193980, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/aafa8848c4b764f080b1b31a51eab73d?s=128&d=identicon&r=PG", "display_name": "Phlip", "link": "https://stackoverflow.com/users/193980/phlip"}, "edited": false, "score": 0, "creation_date": 1521563544, "post_id": 49388378, "comment_id": 85780595, "body": "Hi @Phlip, I made this change and a new error was raised on this line <code>redirect_to @insured</code>, the error is <code>undefined method for &#39;insureds_url&#39;</code>"}], "answers": [{"comments": [{"owner": {"reputation": 408, "user_id": 1987724, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/IsH6B.jpg?s=128&g=1", "display_name": "Fam", "link": "https://stackoverflow.com/users/1987724/fam"}, "edited": false, "score": 0, "creation_date": 1521563417, "post_id": 49388920, "comment_id": 85780514, "body": "Hi @maguri, I&#39;m not sure this is the solution. Doing this creates two new routes and deletes one: <code>GET</code> and <code>POST</code> are created for <code>policy_insureds</code>, and the <code>POST</code> route is deleted for <code>policy_insured</code>. This is incorrect. Each <code>policy</code> should have exactly one <code>insured</code>. Consider that when a <code>:policy</code> resource has one nested <code>:insured</code> resource, the <code>GET</code> and <code>POST</code> routes both exist for <code>policy_insured</code>."}], "tags": [], "owner": {"reputation": 298, "user_id": 9050348, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2qqpq.png?s=128&g=1", "display_name": "maguri", "link": "https://stackoverflow.com/users/9050348/maguri"}, "is_accepted": false, "score": 0, "last_activity_date": 1521570818, "last_edit_date": 1521570818, "creation_date": 1521561752, "answer_id": 49388920, "question_id": 49388378, "link": "https://stackoverflow.com/questions/49388378/following-rails-tutorial-undefined-method-create-for-nilnilclass-with-neste/49388920#49388920", "title": "Following Rails tutorial, undefined method &#39;create&#39; for nil:NilClass, with nested resource", "body": "<p>There is an error in your <code>config/routes.rb</code> file:</p>\n\n<pre><code>resources :policies do\n  # change it for:\n  collection do\n    get 'insured', to: 'policies#show_insured', as: 'show_policy_insured'\n    # maybe unnecessary to be here\n    # get 'insured/new', to: 'insureds#new', as: 'new_policy_insured'\n    # post 'insured/create', to: 'insureds#create', as: 'create_policy_insured'\n    # delete 'insured/delete', to: 'insureds#delete', as: 'delete_policy_insured'\n  end\nend\n#\u00a0add resources here\nresources :insureds\n</code></pre>\n\n<p>In <code>policy_controller.rb</code>:</p>\n\n<pre><code>def show_insured #\u00a0'policy/:id/insureds/\nend\n</code></pre>\n\n<p>In <code>insureds_controller.rb</code>:</p>\n\n<pre><code>def show #\u00a0'/insureds/:id'\nend\n\ndef create\n  ...\n  redirect_to show_policy_insured &amp;&amp; return if @insured_policy\nend\n\n# before_filter or before_action\n@policy = Policy.find(params[:id])\n@insured_policy = @policy.insured\n</code></pre>\n\n<p>Check it and <em>run</em> this to see your <strong>routes</strong>:</p>\n\n<pre><code>$ bundle exec rake routes \n\n\nget /policies/:id/insured   =&gt; 'policies_controller#show_insured'\nget /insureds/:id           =&gt; 'insureds_controller#show'\nget /insured/new            =&gt; 'insureds_controller#new'\npost /insureds/create       =&gt; 'insureds_controller#create'\ndelete /insureds/:id/delete =&gt; 'insureds_controller#delete'\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 408, "user_id": 1987724, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/IsH6B.jpg?s=128&g=1", "display_name": "Fam", "link": "https://stackoverflow.com/users/1987724/fam"}, "is_accepted": true, "score": 0, "last_activity_date": 1521843649, "creation_date": 1521843649, "answer_id": 49459027, "question_id": 49388378, "link": "https://stackoverflow.com/questions/49388378/following-rails-tutorial-undefined-method-create-for-nilnilclass-with-neste/49459027#49459027", "title": "Following Rails tutorial, undefined method &#39;create&#39; for nil:NilClass, with nested resource", "body": "<p>@maguri, that's not all necessary. The stumbling block I was running into was that Rails couldn't automatically determine the correct routes. When I provided my own urls in the <code>form_with</code> declarations, everything went smoothly.</p>\n\n<p>Observe the following change in my <code>_form.html.erb</code> for the Insured model, which <code>belongs_to</code> Policy, which <code>has_one</code> Insured.</p>\n\n<pre><code>&lt;%= form_with model: @insured, url: policy_insured_path(@policy) local: true do |form| %&gt;\n</code></pre>\n\n<p>In my updated <code>insureds_controller.rb</code> file, using @Phlip's suggestion:</p>\n\n<pre><code>def create\n    @policy = Policy.find(params[:policy_id])\n    @insured = @policy.create_insured(insured_params)\n    if @policy.insured.save\n        redirect_to policy_insured_path(params[:policy_id])\n    else\n        render 'new'\n    end\nend\n</code></pre>\n\n<p>This allows me to keep <code>routes.rb</code> clean and simple:</p>\n\n<pre><code>resources :policies do\n    resource: insured\nend\n</code></pre>\n\n<p>Thank you for your answer, it helped me discover the problem was with my routes.</p>\n"}], "owner": {"reputation": 408, "user_id": 1987724, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/IsH6B.jpg?s=128&g=1", "display_name": "Fam", "link": "https://stackoverflow.com/users/1987724/fam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 108, "favorite_count": 0, "accepted_answer_id": 49459027, "answer_count": 2, "score": 3, "last_activity_date": 1521843649, "creation_date": 1521560165, "question_id": 49388378, "link": "https://stackoverflow.com/questions/49388378/following-rails-tutorial-undefined-method-create-for-nilnilclass-with-neste", "title": "Following Rails tutorial, undefined method &#39;create&#39; for nil:NilClass, with nested resource", "body": "<p>I'm following the Rails tutorial and making changes where appropriate, with the intention that my tutorial project will become a full-fledged production app after the completion of the tutorial.</p>\n\n<p>I've run into a snag with the second model portion of the tutorial. Here is how I've written my second model.</p>\n\n<p>In my <code>policy.rb</code>:</p>\n\n<pre><code>class Policy &lt; ApplicationRecord\n    has_one :insured\nend\n</code></pre>\n\n<p>In my <code>insured.rb</code>:</p>\n\n<pre><code>class Insured &lt; ApplicationRecord\n    belongs_to :policy\nend\n</code></pre>\n\n<p>In my <code>routes.rb</code>:</p>\n\n<pre><code>resources :policies do\n    resource :insured\nend\n</code></pre>\n\n<p>In my <code>insureds_controller.rb</code>:</p>\n\n<pre><code>def create\n    @policy = Policy.find(params[:policy_id])\n    # next line is raising the error\n    @insured = @policy.insured.create(insured_params)\n    redirect_to @insured\nend\n\nprivate\n    def insured_params\n        params.permit(:name, :address, :phone, :email)\n    end\n</code></pre>\n\n<p>I've inspected the <code>@policy</code> object with <code>render plain: @policy.inspect</code> and can confirm that ActiveRecord is retrieving the policy correctly. When I inspect the attributes of <code>@policy</code>, using <code>render plain: @policy.attribute_names.inspect</code>, I don't see an <code>insured</code> attribute, which I thought Rails was supposed to automatically manage for me. In the tutorial, an <code>article</code> <code>has_many :comments</code>, and a comment is supposedly easily created and associated with the parent article with this call: <code>@article.comments.create(comment_params)</code>. I also noticed that the tutorial uses <code>params.require(:comment).permit(...)</code> while I have to use <code>params.permit(...)</code>, after inspecting the <code>params</code> hash I saw that the <code>:insured</code> attributes existed in the top-level of the hash, instead of being tied to an <code>:insured</code> key within the hash.</p>\n\n<p>I tried manually saving and assigning the <code>@insured</code> object like so:</p>\n\n<pre><code>def create\n    @policy = Policy.find(params[:policy_id])\n    @insured = Insured.new(insured_params)\n    if @insured.save\n        @policy.insured = @insured\n        redirect_to @insured\n    end\nend\n</code></pre>\n\n<p>Only to run into the following error in my <code>.../insureds/new.html.erb</code>:</p>\n\n<pre><code>&lt;h1&gt;New Insured&lt;/h1&gt;\n&lt;h1&gt;&lt;%= @policy.policy_number %&gt;&lt;/h2&gt;\n&lt;%= render 'form' %&gt;\n&lt;%= link_to 'Cancel', policy_path(@policy) %&gt;\n</code></pre>\n\n<p>Which derives from my partial form <code>.../insureds/_form.html.erb</code>:</p>\n\n<pre><code># the following line raises the error\n&lt;%= form_with model: @insured, local: true do |form| %&gt;\n    # html omitted for brevity\n&lt;% end %&gt;\n</code></pre>\n\n<p>Error: 'undefined method <code>insureds_path</code>'. This is weird because when I inspect the HTML I can see the form action for this view is <code>/policies/[:id]/insured</code>.</p>\n\n<p>Sorry for the massive wall of text, I wanted to show you guys that I did try to figure out what is going wrong.</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "edited": false, "score": 1, "creation_date": 1521559060, "post_id": 49387844, "comment_id": 85777271, "body": "I wouldn&#39;t recommend using break as a method name. It seems to be a reserved keyword."}, {"owner": {"reputation": 2285, "user_id": 2039726, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f1fc7ff9bf8f9489ab7715282a9b7e9c?s=128&d=identicon&r=PG", "display_name": "MrShemek", "link": "https://stackoverflow.com/users/2039726/mrshemek"}, "edited": false, "score": 0, "creation_date": 1521559116, "post_id": 49387844, "comment_id": 85777321, "body": "Start with changing <code>break</code> to something else. It is reserved word in <a href=\"http://www.rubymagic.org/posts/ruby-and-rails-reserved-words\" rel=\"nofollow noreferrer\">ruby</a>"}], "answers": [{"tags": [], "owner": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "is_accepted": true, "score": 2, "last_activity_date": 1521562509, "last_edit_date": 1521562509, "creation_date": 1521560866, "answer_id": 49388613, "question_id": 49387844, "link": "https://stackoverflow.com/questions/49387844/rails-void-value-expression-when-using-gsub-in-helper-method/49388613#49388613", "title": "Rails - void value expression when using gsub in helper method", "body": "<p><code>break</code> is a reserved keyword in Ruby, defined in its implementation, you can take a look to this <a href=\"https://github.com/ruby/ruby/blob/trunk/defs/keywords#L19\" rel=\"nofollow noreferrer\">file</a> among the others:</p>\n\n<pre><code>struct kwtable;\n%%\n__ENCODING__, {keyword__ENCODING__, keyword__ENCODING__}, EXPR_END\n__LINE__, {keyword__LINE__, keyword__LINE__}, EXPR_END\n__FILE__, {keyword__FILE__, keyword__FILE__}, EXPR_END\nBEGIN, {keyword_BEGIN, keyword_BEGIN}, EXPR_END\nEND, {keyword_END, keyword_END}, EXPR_END\nalias, {keyword_alias, keyword_alias}, EXPR_FNAME|EXPR_FITEM\nand, {keyword_and, keyword_and}, EXPR_VALUE\nbegin, {keyword_begin, keyword_begin}, EXPR_BEG\nbreak, {keyword_break, keyword_break}, EXPR_MID\ncase, {keyword_case, keyword_case}, EXPR_VALUE\nclass, {keyword_class, keyword_class}, EXPR_CLASS\ndef, {keyword_def, keyword_def}, EXPR_FNAME\ndefined?, {keyword_defined, keyword_defined}, EXPR_ARG\ndo, {keyword_do, keyword_do}, EXPR_BEG\nelse, {keyword_else, keyword_else}, EXPR_BEG\nelsif, {keyword_elsif, keyword_elsif}, EXPR_VALUE\nend, {keyword_end, keyword_end}, EXPR_END\nensure, {keyword_ensure, keyword_ensure}, EXPR_BEG\nfalse, {keyword_false, keyword_false}, EXPR_END\nfor, {keyword_for, keyword_for}, EXPR_VALUE\nif, {keyword_if, modifier_if}, EXPR_VALUE\nin, {keyword_in, keyword_in}, EXPR_VALUE\nmodule, {keyword_module, keyword_module}, EXPR_VALUE\nnext, {keyword_next, keyword_next}, EXPR_MID\nnil, {keyword_nil, keyword_nil}, EXPR_END\nnot, {keyword_not, keyword_not}, EXPR_ARG\nor, {keyword_or, keyword_or}, EXPR_VALUE\nredo, {keyword_redo, keyword_redo}, EXPR_END\nrescue, {keyword_rescue, modifier_rescue}, EXPR_MID\nretry, {keyword_retry, keyword_retry}, EXPR_END\nreturn, {keyword_return, keyword_return}, EXPR_MID\nself, {keyword_self, keyword_self}, EXPR_END\nsuper, {keyword_super, keyword_super}, EXPR_ARG\nthen, {keyword_then, keyword_then}, EXPR_BEG\ntrue, {keyword_true, keyword_true}, EXPR_END\nundef, {keyword_undef, keyword_undef}, EXPR_FNAME|EXPR_FITEM\nunless, {keyword_unless, modifier_unless}, EXPR_VALUE\nuntil, {keyword_until, modifier_until}, EXPR_VALUE\nwhen, {keyword_when, keyword_when}, EXPR_VALUE\nwhile, {keyword_while, modifier_while}, EXPR_VALUE\nyield, {keyword_yield, keyword_yield}, EXPR_ARG\n%%\n#endif\n</code></pre>\n\n<p>If you want to check and return a specific value if the argument being used is nil, then you can add a return before the gsub operation:</p>\n\n<pre><code>def method_name(string)\n  return string if string.nil?\n  string.to_s.gsub(/(?&lt;=\\) )/, \"\\n\")\nend\n</code></pre>\n"}], "owner": {"reputation": 1050, "user_id": 8671889, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/8eb4eb4560635c6319ccb29a8d7f5be4?s=128&d=identicon&r=PG&f=1", "display_name": "Jake", "link": "https://stackoverflow.com/users/8671889/jake"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 99, "favorite_count": 0, "accepted_answer_id": 49388613, "answer_count": 1, "score": 3, "last_activity_date": 1521562533, "creation_date": 1521558665, "last_edit_date": 1521562533, "question_id": 49387844, "link": "https://stackoverflow.com/questions/49387844/rails-void-value-expression-when-using-gsub-in-helper-method", "title": "Rails - void value expression when using gsub in helper method", "body": "<p>I have the following data that I'm trying to apply a gsub to:</p>\n\n<pre><code>7:30 AM - 5:00 PM (M-F) 7:30 AM - 12 PM (Sat)\n</code></pre>\n\n<p>I'm displaying it like the following:</p>\n\n<pre><code>&lt;% @region.locations.each do |location | %&gt;\n &lt;%= location.hours_operation %&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>I dediced to use a helper to apply the gsub so I went to my region helper file and added the following:</p>\n\n<pre><code>def break(string)\n initial1 = string\n result1 = string.to_s.gsub(/(?&lt;=\\) )/, \"\\n\")\n if result1.nil?\n   initial1\n else\n   result1\n end\nend\n</code></pre>\n\n<p>Then I changed my view to:</p>\n\n<pre><code>&lt;% @region.locations.each do |location | %&gt;\n &lt;%= break(location.hours_operation) %&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>I end up getting an error on the method line saying: </p>\n\n<pre><code>void value expression ak(location.hours_operation)))).to_s)); ^\n</code></pre>\n\n<p>Did I do something wrong in my helper or is there a simpler way to apply the gsub?</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 56328, "user_id": 4265352, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-lzAUc5pYb24/AAAAAAAAAAI/AAAAAAAAAGQ/q3h7bZUnqrs/photo.jpg?sz=128", "display_name": "axiac", "link": "https://stackoverflow.com/users/4265352/axiac"}, "edited": false, "score": 3, "creation_date": 1521558960, "post_id": 49387158, "comment_id": 85777184, "body": "It depends of the definition of <i>&quot;better&quot;</i>. Your current code expresses the intention, everything is clear. Keep it this way."}, {"owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 1, "creation_date": 1521562458, "post_id": 49387158, "comment_id": 85779805, "body": "Where is <code>coordBainates</code> and <code>interest_rate</code> coming from?"}], "answers": [{"tags": [], "owner": {"reputation": 18079, "user_id": 503402, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/873ad707fb34aac8fbdfbfec676e02e9?s=128&d=identicon&r=PG", "display_name": "Max", "link": "https://stackoverflow.com/users/503402/max"}, "is_accepted": true, "score": 2, "last_activity_date": 1521558717, "creation_date": 1521558717, "answer_id": 49387862, "question_id": 49387158, "link": "https://stackoverflow.com/questions/49387158/optimization-of-constructor-in-the-class/49387862#49387862", "title": "Optimization of constructor in the class", "body": "<p>You can define the arguments in an array so you don't have to keep everything in sync. Use a little bit of metaprogramming to get them into instance variables:</p>\n\n<pre><code>class Bank\n  def initialize opts={}\n    keys = %i{name coordinates country max_credit_value min_credit_value interest_rate credit_time}\n    raise ArgumentError, \"invalid options: expected #{keys}, got #{opts.keys}\" unless keys.sort == opts.keys.sort\n    keys.each { |key| instance_variable_set \"@#{key}\", opts[key] }\n  end\nend\n</code></pre>\n\n<p>and then initialize with</p>\n\n<pre><code>Bank.new name: \"Foobar\", coordinates: [2, 5], country: \"US\", etc...\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 1, "creation_date": 1521560098, "post_id": 49388325, "comment_id": 85778146, "body": "Except don&#39;t <i>inherit</i> from Struct. Just <code>Bank = Struct.new(:name, ...</code>"}, {"owner": {"reputation": 340, "user_id": 9335023, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UciBB.png?s=128&g=1", "display_name": "Maciej N\u0119dza", "link": "https://stackoverflow.com/users/9335023/maciej-n%c4%99dza"}, "reply_to_user": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1521560359, "post_id": 49388325, "comment_id": 85778336, "body": "@SergioTulentsev why you don&#39;t recommend inheritance in this case?"}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 3, "creation_date": 1521560488, "post_id": 49388325, "comment_id": 85778438, "body": "It adds nothing. Except one extra level of inheritance. Also is longer to type. &#175;\\_(\u30c4)_/&#175;"}], "tags": [], "owner": {"reputation": 340, "user_id": 9335023, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UciBB.png?s=128&g=1", "display_name": "Maciej N\u0119dza", "link": "https://stackoverflow.com/users/9335023/maciej-n%c4%99dza"}, "is_accepted": false, "score": 1, "last_activity_date": 1521560019, "creation_date": 1521560019, "answer_id": 49388325, "question_id": 49387158, "link": "https://stackoverflow.com/questions/49387158/optimization-of-constructor-in-the-class/49388325#49388325", "title": "Optimization of constructor in the class", "body": "<p>If you aim for shortest code and your constructor code has only assignments then maybe this is <em>better</em></p>\n\n<pre><code>class Bank &lt; Struct.new(:name, :city, :country, :max_credit_value, :min_credit_value, :credit_time)\nend\n</code></pre>\n"}], "owner": {"reputation": 3391, "user_id": 6387618, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/f5af475c8ce7bf4b9d300e40a4f9b6c3?s=128&d=identicon&r=PG", "display_name": "Morozov", "link": "https://stackoverflow.com/users/6387618/morozov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 43, "favorite_count": 0, "accepted_answer_id": 49387862, "answer_count": 2, "score": 0, "last_activity_date": 1521560019, "creation_date": 1521556788, "question_id": 49387158, "link": "https://stackoverflow.com/questions/49387158/optimization-of-constructor-in-the-class", "title": "Optimization of constructor in the class", "body": "<p>How to use hash, i can write this class better?</p>\n\n<pre><code>class Bank\n    def initialize(name, city, country, max_credit_value, min_credit_value, credit_time)\n        @name = name\n        @coordinates = coordBainates\n        @country = country\n        @max_credit_value = max_credit_value\n        @min_credit_value = min_credit_value\n        @interest_rate = interest_rate\n        @credit_time = credit_time \n    end\nend\n</code></pre>\n\n<p>Perhaps there is a better way?</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 2322, "user_id": 3088748, "user_type": "registered", "accept_rate": 63, "profile_image": "https://graph.facebook.com/544821277/picture?type=large", "display_name": "AJFaraday", "link": "https://stackoverflow.com/users/3088748/ajfaraday"}, "edited": false, "score": 0, "creation_date": 1521623013, "post_id": 49386742, "comment_id": 85805184, "body": "Just curious, which database are you using? I&#39;m not completely sure this syntax will work in all of them."}, {"owner": {"reputation": 326, "user_id": 6871619, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/25a77dbd142c184c58ac6f82a8a2805b?s=128&d=identicon&r=PG&f=1", "display_name": "sokoine", "link": "https://stackoverflow.com/users/6871619/sokoine"}, "reply_to_user": {"reputation": 2322, "user_id": 3088748, "user_type": "registered", "accept_rate": 63, "profile_image": "https://graph.facebook.com/544821277/picture?type=large", "display_name": "AJFaraday", "link": "https://stackoverflow.com/users/3088748/ajfaraday"}, "edited": false, "score": 0, "creation_date": 1521713672, "post_id": 49386742, "comment_id": 85852677, "body": "i&#39;m using postgresql"}], "answers": [{"tags": [], "owner": {"reputation": 2322, "user_id": 3088748, "user_type": "registered", "accept_rate": 63, "profile_image": "https://graph.facebook.com/544821277/picture?type=large", "display_name": "AJFaraday", "link": "https://stackoverflow.com/users/3088748/ajfaraday"}, "is_accepted": true, "score": 4, "last_activity_date": 1521555813, "creation_date": 1521555813, "answer_id": 49386823, "question_id": 49386742, "link": "https://stackoverflow.com/questions/49386742/how-do-i-search-category-name-in-rails/49386823#49386823", "title": "How do i search category name in Rails?", "body": "<p>You need to include a <code>joins</code> statement, to say you're including the CATEGORIES table in your query.</p>\n\n<p>Also, if search is a string, you don't need to convert it to a string by using string injection.</p>\n\n<pre><code>def self.search(search)\n  joins(:category).where(\n    [\"categories.name like ? OR title LIKE ? OR description LIKE ?\",\n     search, search, search]\n  )\nend\n</code></pre>\n\n<p>Note that the <code>joins</code> statement uses the name of the relationship. I'm assuming you have a line like this in the Job class:</p>\n\n<pre><code>belongs_to :category\n</code></pre>\n\n<p>And in the SQL fragment, you need to use the name of the table, categories.</p>\n"}], "owner": {"reputation": 326, "user_id": 6871619, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/25a77dbd142c184c58ac6f82a8a2805b?s=128&d=identicon&r=PG&f=1", "display_name": "sokoine", "link": "https://stackoverflow.com/users/6871619/sokoine"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 154, "favorite_count": 0, "accepted_answer_id": 49386823, "answer_count": 1, "score": 2, "last_activity_date": 1521555813, "creation_date": 1521555623, "question_id": 49386742, "link": "https://stackoverflow.com/questions/49386742/how-do-i-search-category-name-in-rails", "title": "How do i search category name in Rails?", "body": "<p>I have a search function in my job model that works fine if i want to search the title or description for jobs</p>\n\n<pre><code>def self.search(search)\n\n    if search\n        where([\"title LIKE ? OR description LIKE ?\", \"%#{search}%\" , \"%#{search}%\"])\n    else\n\n    end\n\nend\n</code></pre>\n\n<p>how do i search by category name? i can only figure out to search categories by category_id and entering the number in the search form.</p>\n\n<pre><code>def self.search(search)\n\n        if search\n            where([\"title LIKE ? OR category_id LIKE ?\", \"%#{search}%\" , \"%#{search}%\"])\n        else\n\n        end\n\n    end\n</code></pre>\n\n<p>my schema </p>\n\n<pre><code>create_table \"categories\", force: :cascade do |t|\n    t.string   \"name\"\n    t.datetime \"created_at\", null: false\n    t.datetime \"updated_at\", null: false\n  end\n\ncreate_table \"jobs\", force: :cascade do |t|\n    t.string   \"title\"\n    t.text     \"description\"\n    t.string   \"company\"\n    t.string   \"url\"\n    t.integer  \"user_id\"\n    t.integer  \"city_id\"\n    t.integer  \"category_id\"\n    t.string   \"phone\"\n    t.string   \"slug\"\n  end\n</code></pre>\n\n<p>My jobs controller</p>\n\n<pre><code>def search\n    @jobs = Job.search(params[:search])\nend\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby"], "answers": [{"tags": [], "owner": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "is_accepted": true, "score": 2, "last_activity_date": 1521555978, "creation_date": 1521555978, "answer_id": 49386893, "question_id": 49386699, "link": "https://stackoverflow.com/questions/49386699/in-rails-how-to-create-a-new-line-on-text-being-displayed/49386893#49386893", "title": "In Rails how to create a new line on text being displayed?", "body": "<p>You could split your string with a regular expression that catches the space between your first parenthesis and the AM hour right after it and then join it with \"\\\". Or also use gsub for that:</p>\n\n<pre><code>str = '7:30 AM - 5:00 PM (M-F) 7:30 AM - 12 PM (Sat)'\n\nputs str.split(/(?&lt;=\\) )/).join(\"\\n\")\n# 7:30 AM - 5:00 PM (M-F) \n# 7:30 AM - 12 PM (Sat)\n\nputs str.gsub(/(?&lt;=\\) )/, \"\\n\")\n# 7:30 AM - 5:00 PM (M-F) \n# 7:30 AM - 12 PM (Sat)\n</code></pre>\n"}], "owner": {"reputation": 1050, "user_id": 8671889, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/8eb4eb4560635c6319ccb29a8d7f5be4?s=128&d=identicon&r=PG&f=1", "display_name": "Jake", "link": "https://stackoverflow.com/users/8671889/jake"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 27, "favorite_count": 0, "accepted_answer_id": 49386893, "answer_count": 1, "score": 1, "last_activity_date": 1521562582, "creation_date": 1521555509, "last_edit_date": 1521562582, "question_id": 49386699, "link": "https://stackoverflow.com/questions/49386699/in-rails-how-to-create-a-new-line-on-text-being-displayed", "title": "In Rails how to create a new line on text being displayed?", "body": "<p>I have a client that it putting in data into a text field that needs to be separated into a new line after a certain character. Basically they are giving me this:</p>\n\n<pre><code>7:30 AM - 5:00 PM (M-F) 7:30 AM - 12 PM (Sat)\n</code></pre>\n\n<p>I'm displaying it in the view as: </p>\n\n<pre><code>&lt;% @region.locations.each do |location| %&gt;\n  &lt;%= location.hours_operation %&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>What I really need is after to a line break after the \")\" or before the number. How do I create the line break?</p>\n"}, {"tags": ["c", "ruby", "ruby-c-extension"], "answers": [{"tags": [], "owner": {"reputation": 18079, "user_id": 503402, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/873ad707fb34aac8fbdfbfec676e02e9?s=128&d=identicon&r=PG", "display_name": "Max", "link": "https://stackoverflow.com/users/503402/max"}, "is_accepted": true, "score": 2, "last_activity_date": 1555076336, "last_edit_date": 1555076336, "creation_date": 1521557022, "answer_id": 49387248, "question_id": 49386573, "link": "https://stackoverflow.com/questions/49386573/difference-between-data-wrap-struct-and-typeddata-wrap-struct/49387248#49387248", "title": "Difference between Data_Wrap_Struct and TypedData_Wrap_Struct?", "body": "<p>It's described pretty well in the <a href=\"https://github.com/ruby/ruby/blob/96db72ce38b27799dd8e80ca00696e41234db6ba/doc/extension.rdoc#encapsulate-c-data-into-a-ruby-object\" rel=\"nofollow noreferrer\">official documentation</a>.</p>\n\n<p>The tl;dr is that <code>Data_Wrap_Struct</code> is deprecated and just lets you set the class and the mark/free functions for the wrapped data. <code>TypedData_Wrap_Struct</code> instead lets you set the class and then takes a pointer to a <code>rb_data_type_struct</code> structure that allows for more advanced options to be set for the wrapping:</p>\n\n<ul>\n<li>the mark/free functions as before, but also</li>\n<li>an internal label to identify the wrapped type</li>\n<li>a function for calculating memory consumption</li>\n<li>arbitrary data (basically letting you wrap data at a class level)</li>\n<li>additional flags for garbage collection optimization</li>\n</ul>\n\n<p>Check my <a href=\"http://silverhammermba.github.io/emberb/c/#data\" rel=\"nofollow noreferrer\">unofficial documentation</a> for a couple examples of how this is used.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user5062790"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 336, "favorite_count": 0, "accepted_answer_id": 49387248, "answer_count": 1, "score": 2, "last_activity_date": 1555076336, "creation_date": 1521555168, "question_id": 49386573, "link": "https://stackoverflow.com/questions/49386573/difference-between-data-wrap-struct-and-typeddata-wrap-struct", "title": "Difference between Data_Wrap_Struct and TypedData_Wrap_Struct?", "body": "<p>I'm wrapping a C struct in a Ruby C extension but I can't find the differente between Data_Wrap_Struct and TypedData_Wrap_Struct in the docs, what's the difference between the two functions?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "rubygems"], "comments": [{"owner": {"reputation": 89, "user_id": 7497632, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/034a3a170972c07cb03d5f9564911dc6?s=128&d=identicon&r=PG&f=1", "display_name": "jon1467", "link": "https://stackoverflow.com/users/7497632/jon1467"}, "edited": false, "score": 1, "creation_date": 1521554015, "post_id": 49386096, "comment_id": 85773127, "body": "Have you run <code>bundle install</code>?"}, {"owner": {"reputation": 1175, "user_id": 1487006, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dbe9ed99a12fd3fa2f8dcd33e303eda0?s=128&d=identicon&r=PG", "display_name": "baarkerlounger", "link": "https://stackoverflow.com/users/1487006/baarkerlounger"}, "edited": false, "score": 0, "creation_date": 1521554020, "post_id": 49386096, "comment_id": 85773128, "body": "What does <code>C:&#47;Sites&#47;sample_app_reference&#47;Rakefile:4:</code> look like? Looks like it&#39;s trying to load <code>bcrypt_ext</code> which it can&#39;t - guessing it has a syntax error or is missing altogether?"}, {"owner": {"reputation": 1175, "user_id": 1487006, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dbe9ed99a12fd3fa2f8dcd33e303eda0?s=128&d=identicon&r=PG", "display_name": "baarkerlounger", "link": "https://stackoverflow.com/users/1487006/baarkerlounger"}, "edited": false, "score": 0, "creation_date": 1521554068, "post_id": 49386096, "comment_id": 85773170, "body": "This might also help you <a href=\"https://github.com/codahale/bcrypt-ruby/issues/142\" rel=\"nofollow noreferrer\">github.com/codahale/bcrypt-ruby/issues/142</a>"}, {"owner": {"reputation": 1, "user_id": 9523124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6f5239147fbb6fc411ac89cf368ff56?s=128&d=identicon&r=PG&f=1", "display_name": "dammy", "link": "https://stackoverflow.com/users/9523124/dammy"}, "edited": false, "score": 0, "creation_date": 1521554165, "post_id": 49386096, "comment_id": 85773257, "body": "i have run bundle install, it still didnt fix it"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 9523124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6f5239147fbb6fc411ac89cf368ff56?s=128&d=identicon&r=PG&f=1", "display_name": "dammy", "link": "https://stackoverflow.com/users/9523124/dammy"}, "edited": false, "score": 0, "creation_date": 1521558605, "post_id": 49386201, "comment_id": 85776924, "body": "i tried it, it didn&#39;t still work i did the exert instruction above and it told me instilled, but after running rails test, its still giving bcrypt error"}, {"owner": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "reply_to_user": {"reputation": 1, "user_id": 9523124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6f5239147fbb6fc411ac89cf368ff56?s=128&d=identicon&r=PG&f=1", "display_name": "dammy", "link": "https://stackoverflow.com/users/9523124/dammy"}, "edited": false, "score": 0, "creation_date": 1521559472, "post_id": 49386201, "comment_id": 85777630, "body": "Can you post your <code>application.rb</code> file?"}], "tags": [], "owner": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "is_accepted": false, "score": -1, "last_activity_date": 1521558292, "last_edit_date": 1521558292, "creation_date": 1521554196, "answer_id": 49386201, "question_id": 49386096, "link": "https://stackoverflow.com/questions/49386096/rails-dbmigrate-is-aborting-giving-some-bcrypt-error/49386201#49386201", "title": "rails db:migrate is aborting giving some bcrypt error", "body": "<p>Try instructions here:  <a href=\"https://github.com/codahale/bcrypt-ruby/issues/142#issuecomment-252508115\" rel=\"nofollow noreferrer\">https://github.com/codahale/bcrypt-ruby/issues/142#issuecomment-252508115</a></p>\n\n<blockquote>\n  <p>I solve it with uninstall all <code>bcrypt</code> gem versions with <code>gem uninstall\n  bcrypt</code> and select option 3 (if exist) and uninstall all <code>bcrypt-ruby</code>\n  gem versions with <code>gem uninstall bcrypt-ruby</code> and select option 3 (if\n  exist) then install <code>bcrypt</code> using <code>gem install bcrypt --platform=ruby</code>\n  then add this line <code>gem 'bcrypt', platforms: :ruby</code> to <code>Gemfile</code>, that is\n  it :D.</p>\n</blockquote>\n"}], "owner": {"reputation": 1, "user_id": 9523124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6f5239147fbb6fc411ac89cf368ff56?s=128&d=identicon&r=PG&f=1", "display_name": "dammy", "link": "https://stackoverflow.com/users/9523124/dammy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 61, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1521558292, "creation_date": 1521553918, "question_id": 49386096, "link": "https://stackoverflow.com/questions/49386096/rails-dbmigrate-is-aborting-giving-some-bcrypt-error", "title": "rails db:migrate is aborting giving some bcrypt error", "body": "<p>i cloned micheal hartl code at <a href=\"https://bitbucket.org/railstutorial/sample_app_4th_ed\" rel=\"nofollow noreferrer\">https://bitbucket.org/railstutorial/sample_app_4th_ed</a> and i tried running rails db:migrate but its giving me error </p>\n\n<pre><code>C:\\Sites\\sample_app_reference&gt;rails db:migrate\nrails aborted!\nLoadError: cannot load such file -- bcrypt_ext\nC:/Sites/sample_app_reference/config/application.rb:7:in `&lt;top (required)&gt;'\nC:/Sites/sample_app_reference/Rakefile:4:in `require_relative'\nC:/Sites/sample_app_reference/Rakefile:4:in `&lt;top (required)&gt;'\nbin/rails:9:in `require'\nbin/rails:9:in `&lt;main&gt;'\n\nCaused by:\nLoadError: cannot load such file -- 2.3/bcrypt_ext\nC:/Sites/sample_app_reference/config/application.rb:7:in `&lt;top (required)&gt;'\nC:/Sites/sample_app_reference/Rakefile:4:in `require_relative'\nC:/Sites/sample_app_reference/Rakefile:4:in `&lt;top (required)&gt;'\nbin/rails:9:in `require'\nbin/rails:9:in `&lt;main&gt;'\n(See full trace by running task with --trace)\n</code></pre>\n\n<p>there is my the error code, i'll like to know why it wasn't working</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "railsapps"], "comments": [{"owner": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "edited": false, "score": 0, "creation_date": 1521554344, "post_id": 49385919, "comment_id": 85773424, "body": "I got 404 error just pasting this in browser:  <a href=\"https://raw.githubusercontent.com/RailsApps/rails-composer/master/composer\" rel=\"nofollow noreferrer\">raw.githubusercontent.com/RailsApps/rails-composer/master/&hellip;</a> Looks like endpoint is not reachable"}], "answers": [{"comments": [{"owner": {"reputation": 10782, "user_id": 225211, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/ffecbcf66a00399a03521069f61c2902?s=128&d=identicon&r=PG", "display_name": "Daniel Kehoe", "link": "https://stackoverflow.com/users/225211/daniel-kehoe"}, "edited": false, "score": 0, "creation_date": 1521554659, "post_id": 49386331, "comment_id": 85773653, "body": "This reply is correct. The person who asked the question is missing the <code>.rb</code> extension from the filename. Is the book in error? Or perhaps he copied it incorrectly?"}], "tags": [], "owner": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "is_accepted": true, "score": 2, "last_activity_date": 1521554517, "creation_date": 1521554517, "answer_id": 49386331, "question_id": 49385919, "link": "https://stackoverflow.com/questions/49385919/why-is-rails-composer-only-creating-a-basic-app-without-features-open-http-4/49386331#49386331", "title": "Why is Rails composer only creating a basic app without features? `open_http&#39;: 404 Not Found (OpenURI::HTTPError)", "body": "<p>Your endpoint is not reachable, try:</p>\n\n<pre><code>rails new rails-devise-roles -m https://raw.githubusercontent.com/RailsApps/rails-composer/master/composer.rb\n</code></pre>\n\n<p>But if that doesn't work, just download the ruby code locally from the raw file and just point to the local rb file.</p>\n\n<p>in your terminal:</p>\n\n<pre><code>curl -O https://raw.githubusercontent.com/RailsApps/rails-composer/master/composer.rb\n\nrails new rails-devise-roles -m composer.rb\n</code></pre>\n"}], "owner": {"reputation": 321, "user_id": 7631261, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/34c3f5c01682697bbf4c010f477c47f1?s=128&d=identicon&r=PG&f=1", "display_name": "Owen", "link": "https://stackoverflow.com/users/7631261/owen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 88, "favorite_count": 0, "accepted_answer_id": 49386331, "answer_count": 1, "score": 1, "last_activity_date": 1521554879, "creation_date": 1521553484, "last_edit_date": 1521554879, "question_id": 49385919, "link": "https://stackoverflow.com/questions/49385919/why-is-rails-composer-only-creating-a-basic-app-without-features-open-http-4", "title": "Why is Rails composer only creating a basic app without features? `open_http&#39;: 404 Not Found (OpenURI::HTTPError)", "body": "<p>I have just completed the detailed and well-explained <a href=\"http://learn-rails.com/learn-ruby-on-rails.html\" rel=\"nofollow noreferrer\">Rails tutorial by Daniel Kehoe</a> and am at the end trying to experiment with Rails Composer.  I am having a problem creating the app on both Cloud 9 and Windows 10 with the same error. The app creates but only a basic rails app and not the Rails composer app with all the extra features. </p>\n\n<p>First I tried to create the new project with the following command:</p>\n\n<pre><code>rails new rails-devise-roles -m https://raw.github.com/RailsApps/rails-composer/master/composer\n</code></pre>\n\n<p>and got the following error:</p>\n\n<pre><code>C:/RailsInstaller/Ruby2.2.0/lib/ruby/2.2.0/open-uri.rb:358:in `open_http': 404 Not Found (OpenURI::HTTPError)\n</code></pre>\n\n<p>I have tried to find line 358 in this file but in the directory C:/RailsInstaller/Ruby2.2.0/lib/ruby/2.2.0 there appears to be no \"open-uri.rb\" file to inspect.</p>\n\n<p>Below is the full app creation command with result:</p>\n\n<pre><code>C:\\&gt;rails new rails-devise-roles -m https://raw.github.com/RailsApps/rails-composer/master/composer\n      create\n      create  README.md\n      create  Rakefile\n      create  config.ru\n      create  .gitignore\n      create  Gemfile\n         run  git init from \".\"\nInitialized empty Git repository in C:/rails-devise-roles/.git/\n      create  app\n      create  app/assets/config/manifest.js\n      create  app/assets/javascripts/application.js\n      create  app/assets/javascripts/cable.js\n      create  app/assets/stylesheets/application.css\n      create  app/channels/application_cable/channel.rb\n      create  app/channels/application_cable/connection.rb\n      create  app/controllers/application_controller.rb\n      create  app/helpers/application_helper.rb\n      create  app/jobs/application_job.rb\n      create  app/mailers/application_mailer.rb\n      create  app/models/application_record.rb\n      create  app/views/layouts/application.html.erb\n      create  app/views/layouts/mailer.html.erb\n      create  app/views/layouts/mailer.text.erb\n      create  app/assets/images/.keep\n      create  app/assets/javascripts/channels\n      create  app/assets/javascripts/channels/.keep\n      create  app/controllers/concerns/.keep\n      create  app/models/concerns/.keep\n      create  bin\n      create  bin/bundle\n      create  bin/rails\n      create  bin/rake\n      create  bin/setup\n      create  bin/update\n      create  bin/yarn\n      create  config\n      create  config/routes.rb\n      create  config/application.rb\n      create  config/environment.rb\n      create  config/secrets.yml\n      create  config/cable.yml\n      create  config/puma.rb\n      create  config/environments\n      create  config/environments/development.rb\n      create  config/environments/production.rb\n      create  config/environments/test.rb\n      create  config/initializers\n      create  config/initializers/application_controller_renderer.rb\n      create  config/initializers/assets.rb\n      create  config/initializers/backtrace_silencers.rb\n      create  config/initializers/cookies_serializer.rb\n      create  config/initializers/cors.rb\n      create  config/initializers/filter_parameter_logging.rb\n      create  config/initializers/inflections.rb\n      create  config/initializers/mime_types.rb\n      create  config/initializers/new_framework_defaults_5_1.rb\n      create  config/initializers/wrap_parameters.rb\n      create  config/locales\n      create  config/locales/en.yml\n      create  config/boot.rb\n      create  config/database.yml\n      create  db\n      create  db/seeds.rb\n      create  lib\n      create  lib/tasks\n      create  lib/tasks/.keep\n      create  lib/assets\n      create  lib/assets/.keep\n      create  log\n      create  log/.keep\n      create  public\n      create  public/404.html\n      create  public/422.html\n      create  public/500.html\n      create  public/apple-touch-icon-precomposed.png\n      create  public/apple-touch-icon.png\n      create  public/favicon.ico\n      create  public/robots.txt\n      create  test/fixtures\n      create  test/fixtures/.keep\n      create  test/fixtures/files\n      create  test/fixtures/files/.keep\n      create  test/controllers\n      create  test/controllers/.keep\n      create  test/mailers\n      create  test/mailers/.keep\n      create  test/models\n      create  test/models/.keep\n      create  test/helpers\n      create  test/helpers/.keep\n      create  test/integration\n      create  test/integration/.keep\n      create  test/test_helper.rb\n      create  test/system\n      create  test/system/.keep\n      create  test/application_system_test_case.rb\n      create  tmp\n      create  tmp/.keep\n      create  tmp/cache\n      create  tmp/cache/assets\n      create  vendor\n      create  vendor/.keep\n      create  package.json\n      remove  config/initializers/cors.rb\n      remove  config/initializers/new_framework_defaults_5_1.rb\n       apply  https://raw.github.com/RailsApps/rails-composer/master/composer\nC:/RailsInstaller/Ruby2.2.0/lib/ruby/2.2.0/open-uri.rb:358:in `open_http': 404 Not Found (OpenURI::HTTPError)\n        from C:/RailsInstaller/Ruby2.2.0/lib/ruby/2.2.0/open-uri.rb:736:in `buffer_open'\n        from C:/RailsInstaller/Ruby2.2.0/lib/ruby/2.2.0/open-uri.rb:211:in `block in open_loop'\n        from C:/RailsInstaller/Ruby2.2.0/lib/ruby/2.2.0/open-uri.rb:209:in `catch'\n        from C:/RailsInstaller/Ruby2.2.0/lib/ruby/2.2.0/open-uri.rb:209:in `open_loop'\n        from C:/RailsInstaller/Ruby2.2.0/lib/ruby/2.2.0/open-uri.rb:150:in `open_uri'\n        from C:/RailsInstaller/Ruby2.2.0/lib/ruby/2.2.0/open-uri.rb:716:in `open'\n        from C:/RailsInstaller/Ruby2.2.0/lib/ruby/2.2.0/open-uri.rb:34:in `open'\n        from C:/RailsInstaller/Ruby2.2.0/lib/ruby/gems/2.2.0/gems/thor-0.20.0/lib/thor/actions.rb:220:in `apply'\n        from C:/RailsInstaller/Ruby2.2.0/lib/ruby/gems/2.2.0/gems/railties-5.1.5/lib/rails/generators/app_base.rb:162:in `apply_rails_template'\n        from (eval):1:in `apply_rails_template'\n        from C:/RailsInstaller/Ruby2.2.0/lib/ruby/gems/2.2.0/gems/thor-0.20.0/lib/thor/command.rb:27:in `run'\n        from C:/RailsInstaller/Ruby2.2.0/lib/ruby/gems/2.2.0/gems/thor-0.20.0/lib/thor/invocation.rb:126:in `invoke_command'\n        from C:/RailsInstaller/Ruby2.2.0/lib/ruby/gems/2.2.0/gems/thor-0.20.0/lib/thor/invocation.rb:133:in `block in invoke_all'\n        from C:/RailsInstaller/Ruby2.2.0/lib/ruby/gems/2.2.0/gems/thor-0.20.0/lib/thor/invocation.rb:133:in `each'\n        from C:/RailsInstaller/Ruby2.2.0/lib/ruby/gems/2.2.0/gems/thor-0.20.0/lib/thor/invocation.rb:133:in `map'\n        from C:/RailsInstaller/Ruby2.2.0/lib/ruby/gems/2.2.0/gems/thor-0.20.0/lib/thor/invocation.rb:133:in `invoke_all'\n        from C:/RailsInstaller/Ruby2.2.0/lib/ruby/gems/2.2.0/gems/thor-0.20.0/lib/thor/group.rb:232:in `dispatch'\n        from C:/RailsInstaller/Ruby2.2.0/lib/ruby/gems/2.2.0/gems/thor-0.20.0/lib/thor/base.rb:466:in `start'\n        from C:/RailsInstaller/Ruby2.2.0/lib/ruby/gems/2.2.0/gems/railties-5.1.5/lib/rails/commands/application/application_command.rb:24:in `perform'\n        from C:/RailsInstaller/Ruby2.2.0/lib/ruby/gems/2.2.0/gems/thor-0.20.0/lib/thor/command.rb:27:in `run'\n        from C:/RailsInstaller/Ruby2.2.0/lib/ruby/gems/2.2.0/gems/thor-0.20.0/lib/thor/invocation.rb:126:in `invoke_command'\n        from C:/RailsInstaller/Ruby2.2.0/lib/ruby/gems/2.2.0/gems/thor-0.20.0/lib/thor.rb:387:in `dispatch'\n        from C:/RailsInstaller/Ruby2.2.0/lib/ruby/gems/2.2.0/gems/railties-5.1.5/lib/rails/command/base.rb:63:in `perform'\n        from C:/RailsInstaller/Ruby2.2.0/lib/ruby/gems/2.2.0/gems/railties-5.1.5/lib/rails/command.rb:44:in `invoke'\n        from C:/RailsInstaller/Ruby2.2.0/lib/ruby/gems/2.2.0/gems/railties-5.1.5/lib/rails/cli.rb:16:in `&lt;top (required)&gt;'\n        from C:/RailsInstaller/Ruby2.2.0/lib/ruby/2.2.0/rubygems/core_ext/kernel_require.rb:69:in `require'\n        from C:/RailsInstaller/Ruby2.2.0/lib/ruby/2.2.0/rubygems/core_ext/kernel_require.rb:69:in `require'\n        from C:/RailsInstaller/Ruby2.2.0/lib/ruby/gems/2.2.0/gems/railties-5.1.5/exe/rails:9:in `&lt;top (required)&gt;'\n        from C:/RailsInstaller/Ruby2.2.0/bin/rails:23:in `load'\n        from C:/RailsInstaller/Ruby2.2.0/bin/rails:23:in `&lt;main&gt;'\n</code></pre>\n"}, {"tags": ["ruby", "optionparser"], "comments": [{"owner": {"reputation": 18079, "user_id": 503402, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/873ad707fb34aac8fbdfbfec676e02e9?s=128&d=identicon&r=PG", "display_name": "Max", "link": "https://stackoverflow.com/users/503402/max"}, "edited": false, "score": 1, "creation_date": 1521555355, "post_id": 49385756, "comment_id": 85774281, "body": "Make <code>-p</code> a normal parameter and then check after parsing that <code>-p</code> and <code>-r</code> were passed together or not at all."}, {"owner": {"reputation": 512, "user_id": 1344643, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/a704ac9164ba2b46c8109fcf598e326e?s=128&d=identicon&r=PG", "display_name": "ed_is_my_name", "link": "https://stackoverflow.com/users/1344643/ed-is-my-name"}, "reply_to_user": {"reputation": 18079, "user_id": 503402, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/873ad707fb34aac8fbdfbfec676e02e9?s=128&d=identicon&r=PG", "display_name": "Max", "link": "https://stackoverflow.com/users/503402/max"}, "edited": false, "score": 0, "creation_date": 1521555489, "post_id": 49385756, "comment_id": 85774371, "body": "@Max  - That might be an okay solution...as long as no other argument takes a &#39;-p&#39; switch."}, {"owner": {"reputation": 18079, "user_id": 503402, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/873ad707fb34aac8fbdfbfec676e02e9?s=128&d=identicon&r=PG", "display_name": "Max", "link": "https://stackoverflow.com/users/503402/max"}, "edited": false, "score": 1, "creation_date": 1521555852, "post_id": 49385756, "comment_id": 85774632, "body": "The same principle applies. There&#39;s no rule saying you can only use optparse to handle arguments. Once it&#39;s done you can do whatever kind of post-processing you want to handle more complex cases."}], "owner": {"reputation": 512, "user_id": 1344643, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/a704ac9164ba2b46c8109fcf598e326e?s=128&d=identicon&r=PG", "display_name": "ed_is_my_name", "link": "https://stackoverflow.com/users/1344643/ed-is-my-name"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 25, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1521553097, "creation_date": 1521553097, "question_id": 49385756, "link": "https://stackoverflow.com/questions/49385756/optionparser-requiring-subparameters", "title": "OptionParser, requiring subparameters", "body": "<p>I'm trying to figure out how to define subparameters for one of my parameters.  This is what I have that is NOT working:</p>\n\n<pre><code>require 'optparse'\n\noptions = {}\nOptionParser.new do |parser|\n  parser.on(\"-r\", \"--require LIBRARY\", \"Require the LIBRARY before executing your script\") do |lib|\n    parser.make_switch([\"-p\"], '--pop THING') do |o|\n         puts \"You required #{o}!\"\n    end\n end\n parser.on(\"-f\", '--file FILE', 'File to be processed') do |file|\n    puts \"This is the file: #{file}\"\n end\nend.parse!\n</code></pre>\n\n<p>I'd like to do:</p>\n\n<pre><code> ruby myapp -r Library -p thing #&lt;--required params\n</code></pre>\n\n<p>or</p>\n\n<pre><code> ruby myapp -f\n</code></pre>\n"}, {"tags": ["ruby", "windows-10", "bundle", "bundler"], "answers": [{"tags": [], "owner": {"reputation": 18079, "user_id": 503402, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/873ad707fb34aac8fbdfbfec676e02e9?s=128&d=identicon&r=PG", "display_name": "Max", "link": "https://stackoverflow.com/users/503402/max"}, "is_accepted": false, "score": 0, "last_activity_date": 1521559294, "creation_date": 1521559294, "answer_id": 49388079, "question_id": 49385656, "link": "https://stackoverflow.com/questions/49385656/error-error-installing-json-error-failed-to-build-gem-native-extension-windo/49388079#49388079", "title": "ERROR: Error installing json: ERROR: Failed to build gem native extension. Windows 10", "body": "<blockquote>\n  <p>mkmf.rb can't find header files for ruby at /usr/lib/ruby/include/ruby.h</p>\n</blockquote>\n\n<p>Some Ruby gems need to be compiled from source on your machine. This requires additional files in your Ruby installation as well as all of the tools and libraries that the gem needs for building.</p>\n\n<p>Getting all of this working on Windows on your own is very, very hard. So instead you should use the <a href=\"https://rubyinstaller.org/downloads/\" rel=\"nofollow noreferrer\">Ruby installer</a> to get your Ruby and dev environment set up correctly.</p>\n"}], "owner": {"reputation": 290, "user_id": 5630536, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/aa8b05352d99138a1001a5ec186497c4?s=128&d=identicon&r=PG&f=1", "display_name": "Speedychuck", "link": "https://stackoverflow.com/users/5630536/speedychuck"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 443, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1521559294, "creation_date": 1521552835, "question_id": 49385656, "link": "https://stackoverflow.com/questions/49385656/error-error-installing-json-error-failed-to-build-gem-native-extension-windo", "title": "ERROR: Error installing json: ERROR: Failed to build gem native extension. Windows 10", "body": "<p>When I run Bundle Install I am coming across this issue: </p>\n\n<pre><code>Building native extensions.  This could take a while...\nERROR:  Error installing json:\n        ERROR: Failed to build gem native extension.\n\n    current directory: /var/lib/gems/2.3.0/gems/json-2.1.0/ext/json/ext/generator\n/usr/bin/ruby2.3 -r ./siteconf20180320-1003-beh1w0.rb extconf.rb\nmkmf.rb can't find header files for ruby at /usr/lib/ruby/include/ruby.h\n\nextconf failed, exit code 1\n\nGem files will remain installed in /var/lib/gems/2.3.0/gems/json-2.1.0 for inspection.\nResults logged to /var/lib/gems/2.3.0/extensions/x86_64-linux/2.3.0/json-2.1.0/gem_make.out\n</code></pre>\n\n<p>I am on windows 10. How do I resolve this issue as I cannot run my cucumber tests from command line.</p>\n"}, {"tags": ["ruby", "selenium"], "comments": [{"owner": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "edited": false, "score": 0, "creation_date": 1521552966, "post_id": 49385584, "comment_id": 85772236, "body": "I guess that <code>end_with?</code> method is defined nowhere. What about using a CSS selector? <code>@driver.find_elements(:css =&gt; &#39;[id$=&quot;-panel&quot;]&#39;)</code>"}, {"owner": {"reputation": 1, "user_id": 3711612, "user_type": "registered", "profile_image": "https://graph.facebook.com/576653568/picture?type=large", "display_name": "user3711612", "link": "https://stackoverflow.com/users/3711612/user3711612"}, "reply_to_user": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "edited": false, "score": 0, "creation_date": 1521554715, "post_id": 49385584, "comment_id": 85773708, "body": "Thanks @SebastianPalma this works :)"}, {"owner": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "edited": false, "score": 0, "creation_date": 1521554767, "post_id": 49385584, "comment_id": 85773763, "body": "Great, would you make an answer?"}], "answers": [{"tags": [], "owner": {"reputation": 3523, "user_id": 9043475, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FNxvn.jpg?s=128&g=1", "display_name": "Rajagopalan", "link": "https://stackoverflow.com/users/9043475/rajagopalan"}, "is_accepted": false, "score": 0, "last_activity_date": 1521555616, "last_edit_date": 1521555616, "creation_date": 1521555057, "answer_id": 49386537, "question_id": 49385584, "link": "https://stackoverflow.com/questions/49385584/finding-a-list-of-elements-that-end-with-a-string-by-using-selenium-with-ruby/49386537#49386537", "title": "Finding a list of elements that end with a string by using Selenium with Ruby", "body": "<p>This would help you</p>\n\n<pre><code> p @driver.find_elements(xpath: \"(.//*)[contains(@id, '-panel')]\").select{|element|element.attribute(\"id\").end_with?\"-panel\"}\n</code></pre>\n\n<p>If you want to iterate and wanted to do perform some action on each element, then you can do</p>\n\n<pre><code>@driver.find_elements(xpath: \"(.//*)[contains(@id, '-panel')]\").select{|element|element.attribute(\"id\").end_with?\"-panel\"}.each do |i|\n  puts i.displayed?  # Or whatever operation you want to perform\nend\n</code></pre>\n\n<p>If you want to check whether all the element with id which consist of <code>-panel</code> is displayed</p>\n\n<pre><code>p @driver.find_elements(xpath: \"(.//*)[contains(@id, '-panel')]\")\n    .select{|element|element.attribute(\"id\").end_with?\"-panel\"}\n    .map{|element| element.displayed?}\n    .all?\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 3711612, "user_type": "registered", "profile_image": "https://graph.facebook.com/576653568/picture?type=large", "display_name": "user3711612", "link": "https://stackoverflow.com/users/3711612/user3711612"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 150, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1521555616, "creation_date": 1521552596, "question_id": 49385584, "link": "https://stackoverflow.com/questions/49385584/finding-a-list-of-elements-that-end-with-a-string-by-using-selenium-with-ruby", "title": "Finding a list of elements that end with a string by using Selenium with Ruby", "body": "<p>I have a method that checks whether a panel is displayed or not.</p>\n\n<pre><code>   def verifyNav(section)\n    wait = Selenium::WebDriver::Wait.new(:timeout =&gt; 10)\n    wait.until { @driver.find_element(:id =&gt; section + '-panel').displayed? == true }\n  end\n</code></pre>\n\n<p>Now I want to add some code that says that any other elements that have an id that ends in '-panel' should not be displayed.</p>\n\n<p>I've done some searching and I found that I can use the end_with method and there seems to be a find_elements method that returns a list of matching elements.</p>\n\n<p>I've found out that</p>\n\n<pre><code>a = 'radio-panel'\na.end_with?('-panel')\n</code></pre>\n\n<p>returns true.. but if I try to call</p>\n\n<pre><code>@driver.find_elements(:id =&gt; end_with?('-panel'))\n</code></pre>\n\n<p>I get an error saying that end_with is an undefined method.</p>\n\n<p>Any ideas on how I can do this?</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 4644, "user_id": 2594185, "user_type": "registered", "profile_image": "https://graph.facebook.com/100003773788931/picture?type=large", "display_name": "Jagdeep Singh", "link": "https://stackoverflow.com/users/2594185/jagdeep-singh"}, "edited": false, "score": 0, "creation_date": 1521551843, "post_id": 49385268, "comment_id": 85771312, "body": "Try with <code>@post.save!</code> (Notice &quot;!&quot;) in your <code>create</code> action."}, {"owner": {"reputation": 194, "user_id": 9252006, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cf140a21843b445b7ea06baef8e054df?s=128&d=identicon&r=PG", "display_name": "benl96", "link": "https://stackoverflow.com/users/9252006/benl96"}, "reply_to_user": {"reputation": 4644, "user_id": 2594185, "user_type": "registered", "profile_image": "https://graph.facebook.com/100003773788931/picture?type=large", "display_name": "Jagdeep Singh", "link": "https://stackoverflow.com/users/2594185/jagdeep-singh"}, "edited": false, "score": 0, "creation_date": 1521552065, "post_id": 49385268, "comment_id": 85771503, "body": "That doesn&#39;t work either..."}, {"owner": {"reputation": 4644, "user_id": 2594185, "user_type": "registered", "profile_image": "https://graph.facebook.com/100003773788931/picture?type=large", "display_name": "Jagdeep Singh", "link": "https://stackoverflow.com/users/2594185/jagdeep-singh"}, "edited": false, "score": 0, "creation_date": 1521552112, "post_id": 49385268, "comment_id": 85771552, "body": "What do you see? Paste your request logs in question."}, {"owner": {"reputation": 194, "user_id": 9252006, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cf140a21843b445b7ea06baef8e054df?s=128&d=identicon&r=PG", "display_name": "benl96", "link": "https://stackoverflow.com/users/9252006/benl96"}, "reply_to_user": {"reputation": 4644, "user_id": 2594185, "user_type": "registered", "profile_image": "https://graph.facebook.com/100003773788931/picture?type=large", "display_name": "Jagdeep Singh", "link": "https://stackoverflow.com/users/2594185/jagdeep-singh"}, "edited": false, "score": 0, "creation_date": 1521552355, "post_id": 49385268, "comment_id": 85771776, "body": "Im sorry but how do i see my request logs?"}, {"owner": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "edited": false, "score": 0, "creation_date": 1521552588, "post_id": 49385268, "comment_id": 85771942, "body": "in your terminal you should see output as you make requests in your browser"}, {"owner": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "edited": false, "score": 0, "creation_date": 1521552869, "post_id": 49385268, "comment_id": 85772170, "body": "also in your code example, what is <code>posts.rb</code> ? Console output doesn&#39;t show an error so must be something in your code."}, {"owner": {"reputation": 194, "user_id": 9252006, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cf140a21843b445b7ea06baef8e054df?s=128&d=identicon&r=PG", "display_name": "benl96", "link": "https://stackoverflow.com/users/9252006/benl96"}, "edited": false, "score": 0, "creation_date": 1521552977, "post_id": 49385268, "comment_id": 85772248, "body": "posts.rb is the post model for active admin - app/admin/posts.rb"}], "answers": [{"comments": [{"owner": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "edited": false, "score": 0, "creation_date": 1521553235, "post_id": 49385654, "comment_id": 85772458, "body": "last part of this answer explains the validation error. Good answer!"}, {"owner": {"reputation": 194, "user_id": 9252006, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cf140a21843b445b7ea06baef8e054df?s=128&d=identicon&r=PG", "display_name": "benl96", "link": "https://stackoverflow.com/users/9252006/benl96"}, "edited": false, "score": 0, "creation_date": 1521553583, "post_id": 49385654, "comment_id": 85772759, "body": "Yes, you were absolutely right. My belongs_to is causing this error. I removed it just to test it and it works like a charm."}, {"owner": {"user_type": "does_not_exist", "display_name": "user6052428"}, "edited": false, "score": 0, "creation_date": 1521553804, "post_id": 49385654, "comment_id": 85772932, "body": "As I am constantly editing post to be more readable and you might not see it, I&#39;ll repeate here &quot;You can also set <code>belongs_to :user</code> association as optional.&quot;. I hope you can google that one."}, {"owner": {"reputation": 48004, "user_id": 216513, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/30a45c64b2ef288f7ec098c5fb353a22?s=128&d=identicon&r=PG", "display_name": "nathanvda", "link": "https://stackoverflow.com/users/216513/nathanvda"}, "edited": false, "score": 0, "creation_date": 1521553969, "post_id": 49385654, "comment_id": 85773086, "body": "He is using ActiveAdmin, so the controller code shown is never used to create new records imho."}, {"owner": {"reputation": 194, "user_id": 9252006, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cf140a21843b445b7ea06baef8e054df?s=128&d=identicon&r=PG", "display_name": "benl96", "link": "https://stackoverflow.com/users/9252006/benl96"}, "edited": false, "score": 0, "creation_date": 1521554046, "post_id": 49385654, "comment_id": 85773148, "body": "Yes, you were absolutely right. My belongs_to is causing this error. I removed it just to test it and it works like a charm. (Rails 5 indeed)  In my posts_controller, do i have to set the image attribute to every permit i use in there? (eg. for def update)  With the current_admin_user code and belongs_to :user it has the same effect like i had before, no posts are created.  I&#39;ve read about Dont Repeat Yourself already, as i mentioned earlier, i am just getting started. :) But i thought i need the <code>params[:post].permit(:title, :body)</code> in my update method aswell."}, {"owner": {"user_type": "does_not_exist", "display_name": "user6052428"}, "edited": false, "score": 0, "creation_date": 1521554341, "post_id": 49385654, "comment_id": 85773421, "body": "Sorry I made a mistake there.  The way I wrote is normal post creation, when you create is as normal logged in user. In admin panel, you create posts with selecting particular user (you have to add <code>user</code> combo box to your form in ActiveAdmin panel)."}, {"owner": {"reputation": 194, "user_id": 9252006, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cf140a21843b445b7ea06baef8e054df?s=128&d=identicon&r=PG", "display_name": "benl96", "link": "https://stackoverflow.com/users/9252006/benl96"}, "edited": false, "score": 0, "creation_date": 1521554433, "post_id": 49385654, "comment_id": 85773478, "body": "No Problem for writing in parts, sir!  About the Rubocop Gem, i installed it and typed rubocop and got 64 files inspected, 434 offenses detected - do i have to change every offense by hand?   434 offenses look like a lot to me :-&#39;"}, {"owner": {"user_type": "does_not_exist", "display_name": "user6052428"}, "edited": false, "score": 0, "creation_date": 1521554647, "post_id": 49385654, "comment_id": 85773645, "body": "These comments are getting offtopic and too long, lets use chat. Ah yeah, I cannot create one as I dont have 100 reputation... Long story short, yeah, you should check every offense. It is a lot, because it detects many anomalies."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6052428"}, "is_accepted": true, "score": 1, "last_activity_date": 1521556897, "last_edit_date": 1521556897, "creation_date": 1521552827, "answer_id": 49385654, "question_id": 49385268, "link": "https://stackoverflow.com/questions/49385268/ruby-on-rails-activeadmin-posts/49385654#49385654", "title": "Ruby on Rails - ActiveAdmin Posts", "body": "<p>From what I see in your edit 1, I see that you render <code>new</code> after submiting form. It means that your Post is not being saved. It also means that your application does exactly what it should do.</p>\n\n<p>I assume that you are using latests Rails 5.</p>\n\n<p>In Post model, you have <code>belongs_to</code> association (Post belongs to User).\nIn Rails 5, that means <code>user</code> or <code>user_id</code> has to be provided, to create Post (Post cannot belong to noone), else you won't be able to save.</p>\n\n<p>Depending how you created association in table, you might be able to pass <code>user</code> or <code>user_id</code> in params.</p>\n\n<p>Another way to create post belonging to particular user is:</p>\n\n<pre><code>@user = User.first\n@post = @user.posts.build(post_params)\n</code></pre>\n\n<p>For ActiveAdmin, you can use default form that is created based on your model.\nJust make sure you permit all params when creating it that way</p>\n\n<pre><code>ActiveAdmin.register Post do\n  permit_params %i[title body image user_id]\n  ...\nend\n</code></pre>\n\n<p>You can also set <code>belongs_to :user</code> association as optional.</p>\n\n<hr>\n\n<p>Now some general advices from me:</p>\n\n<p>First of all use proper indentation.</p>\n\n<p>My advice to you is install Rubocop gem.</p>\n\n<p>Second:</p>\n\n<pre><code>def show\n    @post = Post.find(params[:id])\n    @post = Post.order(\"created_at DESC\").limit(4).offset(1)\nend\n</code></pre>\n\n<p>That doesn't make much sense, you overwrite instance variable just after first assignment. \n<code>@post = Post.order(\"created_at DESC\").limit(4).offset(1)</code> is more of an index action, since it does not show particular posts, it show 2..5 newest posts.</p>\n\n<pre><code>def post_params\n    params.require(:post).permit(:title, :body)\nend\n</code></pre>\n\n<p>Misses <code>image</code> attribute.</p>\n\n<pre><code>def update\n    @post = Post.find(params[:id])\n\n    if @post.update(params[:post].permit(:title, :body))\n        redirect_to @post\n    else\n        render 'edit'\n    end\nend\n</code></pre>\n\n<p>You duplicate <code>params[:post].permit(:title, :body)</code>. You hgave already created private method for that. Use it here. Same goes for creation action, you duplicated it there too. Read what DRY code is about (google it).</p>\n"}, {"comments": [{"owner": {"reputation": 194, "user_id": 9252006, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cf140a21843b445b7ea06baef8e054df?s=128&d=identicon&r=PG", "display_name": "benl96", "link": "https://stackoverflow.com/users/9252006/benl96"}, "edited": false, "score": 0, "creation_date": 1521554302, "post_id": 49386007, "comment_id": 85773387, "body": "Yes! This works! But for the long view, how am i supposed to do it correct?"}, {"owner": {"reputation": 48004, "user_id": 216513, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/30a45c64b2ef288f7ec098c5fb353a22?s=128&d=identicon&r=PG", "display_name": "nathanvda", "link": "https://stackoverflow.com/users/216513/nathanvda"}, "reply_to_user": {"reputation": 194, "user_id": 9252006, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cf140a21843b445b7ea06baef8e054df?s=128&d=identicon&r=PG", "display_name": "benl96", "link": "https://stackoverflow.com/users/9252006/benl96"}, "edited": false, "score": 0, "creation_date": 1521556753, "post_id": 49386007, "comment_id": 85775401, "body": "You mean: how to set the user-id automatically from ActiveAdmin I think? I added that part."}], "tags": [], "owner": {"reputation": 48004, "user_id": 216513, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/30a45c64b2ef288f7ec098c5fb353a22?s=128&d=identicon&r=PG", "display_name": "nathanvda", "link": "https://stackoverflow.com/users/216513/nathanvda"}, "is_accepted": false, "score": 0, "last_activity_date": 1521556724, "last_edit_date": 1521556724, "creation_date": 1521553684, "answer_id": 49386007, "question_id": 49385268, "link": "https://stackoverflow.com/questions/49385268/ruby-on-rails-activeadmin-posts/49386007#49386007", "title": "Ruby on Rails - ActiveAdmin Posts", "body": "<p>You have <code>belongs_to :user</code> but never set a <code>user_id</code>. A <code>belongs_to</code> relation is by default required (in recent rails 4/5), and this will block the saving. The easiest way, for now, to fix this is to write it as following</p>\n\n<pre><code>belongs_to :user, optional: true \n</code></pre>\n\n<p>[EDIT: how to store current-user as owner of post]</p>\n\n<p>If you want to automatically set the user to the currently logged in user, which I think is the intention, you can add the following to your active-admin configuration: </p>\n\n<pre><code>ActiveAdmin.register Post do\n\n  # .. keep your original configuration here ...\n\n  before_build do |record|\n    record.user = current_user\n  end\n\nend\n</code></pre>\n\n<p>Or add an extra field to the form allowing the administrator to select the user? </p>\n"}], "owner": {"reputation": 194, "user_id": 9252006, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cf140a21843b445b7ea06baef8e054df?s=128&d=identicon&r=PG", "display_name": "benl96", "link": "https://stackoverflow.com/users/9252006/benl96"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 133, "favorite_count": 0, "accepted_answer_id": 49385654, "answer_count": 2, "score": 0, "last_activity_date": 1521556897, "creation_date": 1521551737, "last_edit_date": 1521552936, "question_id": 49385268, "link": "https://stackoverflow.com/questions/49385268/ruby-on-rails-activeadmin-posts", "title": "Ruby on Rails - ActiveAdmin Posts", "body": "<p>i followed a Youtube Video to implement ActiveAdmin Theme in my Rails App,- and everything worked like a charm (i thought).</p>\n\n<p><a href=\"https://www.youtube.com/watch?v=i2x995hm8r8\" rel=\"nofollow noreferrer\">https://www.youtube.com/watch?v=i2x995hm8r8</a></p>\n\n<p>I followed every Step he took and i am a little confused right now because i can't create posts.\nWhenever i try to create a New Post and type in the tile, body and select a image- it just won't do anything. It doesn't even give me a Error Message.</p>\n\n<p>posts_controller.rb</p>\n\n<pre><code>class PostController &lt; ApplicationController\n\ndef index\n    @post = Post.all.order('created_at DESC')\nend\n\ndef create\n    @post = Post.new(params[:post].permit(:title, :body))\n\n    if @post.save\n        redirect_to @post\n    else\n        render 'new'\n    end\nend\n\ndef show\n    @post = Post.find(params[:id])\n    @post = Post.order(\"created_at DESC\").limit(4).offset(1)\nend\n\ndef edit\n    @post = Post.find(params[:id])\nend\n\ndef update\n    @post = Post.find(params[:id])\n\n    if @post.update(params[:post].permit(:title, :body))\n        redirect_to @post\n    else\n        render 'edit'\n    end\nend\n\ndef destroy\n    @post = Post.find(params[:id])\n    @post.destroy\n\n    redirect_to posts_path\nend\n\n\nprivate\ndef post_params\n    params.require(:post).permit(:title, :body)\nend\n\nend\n\nActiveAdmin.register Post do\n</code></pre>\n\n<p>posts.rb</p>\n\n<pre><code>permit_params :title, :body, :image\n\nshow do |t|\n    attributes_table do\n        row :title\n        row :body\n        row :image do\n            post.image? ? image_tag(post.image.url, height: '100') : content_tag(:span, \"No image yet\")\n        end\n    end\nend\n\nform :html =&gt; {:multipart =&gt; true} do |f|\n    f.inputs do\n    f.input :title\n    f.input :body\n    f.input :image, hint: f.post.image? ? image_tag(post.image.url, height: '100') : content_tag(:span, \"Upload JPG/PNG/GIF image\")\nend\nf.actions\nend\nend\n</code></pre>\n\n<p>post.rb</p>\n\n<pre><code>class Post &lt; ApplicationRecord\nbelongs_to :user\nvalidates :title, presence: true, length: {minimum: 5}\nvalidates :body, presence: true, length: { maximum: 140}\n\nhas_attached_file :image, styles: { medium: \"300x300&gt;\", thumb: \"100x100&gt;\" }\nvalidates_attachment_content_type :image, content_type: /\\Aimage\\/.*\\z/\n\n\nend\n</code></pre>\n\n<p>EDIT I: </p>\n\n<p><code>Started POST \"/admin/posts\" for 127.0.0.1 at 2018-03-20 14:30:24 +0100\n    Processing by Admin::PostsController#create as HTML\n    Parameters: {\"utf8\"=&gt;\"\u2713\",\n \"authenticity_token\"=&gt;\"f+hfBD3lzgXEfz1q38/i3YciHsbb5LYWbbHUUsyIeOCaNSUReUUVVTBE//Dw0zXxSuFCzcMfYuUGDtIJlNb58w==\", \"post\"=&gt;{\"title\"=&gt;\"asdasdasd\", \"body\"=&gt;\"asdasdasd\"}, \"commit\"=&gt;\"Create Post\"}\n  AdminUser Load (0.3ms)  SELECT  \"admin_users\".* FROM \"admin_users\" WHERE \"admin_users\".\"id\" = $1 ORDER BY \"admin_users\".\"id\" ASC LIMIT $2  [[\"id\", 1], [\"LIMIT\", 1]]\n   (0.2ms)  BEGIN\n   (0.1ms)  ROLLBACK\n  Rendering /Users/useruser/.rvm/gems/ruby-2.4.2/bundler/gems/activeadmin-2cf85fb03ab3/app/views/active_admin/resource/new.html.arb\n  Rendered /Users/useruser/.rvm/gems/ruby-2.4.2/bundler/gems/activeadmin-2cf85fb03ab3/app/views/active_admin/resource/new.html.arb (134.6ms)\n    Completed 200 OK in 230ms (Views: 148.3ms | ActiveRecord: 5.7ms)</code></p>\n\n<p>If you need more of my Code just tell me what i should post in here.\nI am just getting started with Ruby on Rails and Programming overall, so yes indeed, i am a Newb.</p>\n\n<p>Thanks in advance!</p>\n"}, {"tags": ["ruby", "methods", "hash"], "comments": [{"owner": {"reputation": 4644, "user_id": 2594185, "user_type": "registered", "profile_image": "https://graph.facebook.com/100003773788931/picture?type=large", "display_name": "Jagdeep Singh", "link": "https://stackoverflow.com/users/2594185/jagdeep-singh"}, "edited": false, "score": 0, "creation_date": 1521551449, "post_id": 49385054, "comment_id": 85771030, "body": "As per <a href=\"https://apidock.com/ruby/Hash/has_key%3F\" rel=\"nofollow noreferrer\">apidock.com/ruby/Hash/has_key%3F</a> and <a href=\"http://ruby-doc.org/core-2.4.0/Hash.html#method-i-member-3F\" rel=\"nofollow noreferrer\">ruby-doc.org/core-2.4.0/Hash.html#method-i-member-3F</a>, they look to return the same results."}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 4, "creation_date": 1521552287, "post_id": 49385054, "comment_id": 85771712, "body": "FYI <code>Hash.instance_method(:has_key?) == Hash.instance_method(:member?) #=&gt; true</code>"}], "answers": [{"tags": [], "owner": {"reputation": 127444, "user_id": 492405, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/SSPGk.png?s=128&g=1", "display_name": "vcsjones", "link": "https://stackoverflow.com/users/492405/vcsjones"}, "is_accepted": false, "score": 8, "last_activity_date": 1521551540, "creation_date": 1521551540, "answer_id": 49385188, "question_id": 49385054, "link": "https://stackoverflow.com/questions/49385054/ruby-hash-classs-method-has-key-vs-method-member/49385188#49385188", "title": "Ruby Hash classs method has_key? vs method member?", "body": "<p>According to the <a href=\"https://github.com/ruby/ruby/blob/798316eac260e3cd683da2be23fef53ee64cee00/hash.c#L4710\" rel=\"noreferrer\">Ruby source</a>, <code>has_key?</code>, <code>key?</code>, <code>include?</code> and <code>member?</code> are the same implementation.</p>\n"}, {"tags": [], "owner": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "is_accepted": true, "score": 2, "last_activity_date": 1521552414, "creation_date": 1521552414, "answer_id": 49385531, "question_id": 49385054, "link": "https://stackoverflow.com/questions/49385054/ruby-hash-classs-method-has-key-vs-method-member/49385531#49385531", "title": "Ruby Hash classs method has_key? vs method member?", "body": "<p>To see the method definition's source code see documentation, find the method you're looking for then click on the method to expand to see the actual source code:</p>\n\n<p><a href=\"https://ruby-doc.org/core-2.5.0/Hash.html#method-i-member-3F\" rel=\"nofollow noreferrer\">https://ruby-doc.org/core-2.5.0/Hash.html#method-i-member-3F</a></p>\n\n<pre><code>    rb_hash_has_key(VALUE hash, VALUE key)\n    {\n        if (!RHASH(hash)-&gt;ntbl)\n            return Qfalse;\n        if (st_lookup(RHASH(hash)-&gt;ntbl, key, 0)) {\n            return Qtrue;\n        }\n        return Qfalse;\n    }\n</code></pre>\n\n<p><a href=\"https://ruby-doc.org/core-2.5.0/Hash.html#method-i-has_key-3F\" rel=\"nofollow noreferrer\">https://ruby-doc.org/core-2.5.0/Hash.html#method-i-has_key-3F</a></p>\n\n<pre><code>    rb_hash_has_key(VALUE hash, VALUE key)\n    {\n        if (!RHASH(hash)-&gt;ntbl)\n            return Qfalse;\n        if (st_lookup(RHASH(hash)-&gt;ntbl, key, 0)) {\n            return Qtrue;\n        }\n        return Qfalse;\n    }\n</code></pre>\n"}], "owner": {"reputation": 2689, "user_id": 1134991, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/e102cb584a0fba3cd07b0a4d79350ba2?s=128&d=identicon&r=PG", "display_name": "user1134991", "link": "https://stackoverflow.com/users/1134991/user1134991"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 579, "favorite_count": 0, "accepted_answer_id": 49385531, "answer_count": 2, "score": 3, "last_activity_date": 1521552414, "creation_date": 1521551230, "question_id": 49385054, "link": "https://stackoverflow.com/questions/49385054/ruby-hash-classs-method-has-key-vs-method-member", "title": "Ruby Hash classs method has_key? vs method member?", "body": "<p>Is there any difference between the two methods for the Ruby Hash, or is it just \"there is more than 1 way to do it\"?<br>I could not see any measureable difference between the two.<br>\nThanks,</p>\n"}, {"tags": ["javascript", "jquery", "ruby-on-rails", "ruby", "typescript"], "comments": [{"owner": {"reputation": 3375, "user_id": 5338248, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5d12d35dd1099bb5682594d1338fa1c4?s=128&d=identicon&r=PG", "display_name": "Smit Raval", "link": "https://stackoverflow.com/users/5338248/smit-raval"}, "edited": false, "score": 0, "creation_date": 1521551083, "post_id": 49384951, "comment_id": 85770763, "body": "Please show your HTML."}, {"owner": {"reputation": 421, "user_id": 9434120, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/7ca3b1f5217c4b06b142ef05c0758fb0?s=128&d=identicon&r=PG&f=1", "display_name": "Balance", "link": "https://stackoverflow.com/users/9434120/balance"}, "reply_to_user": {"reputation": 3375, "user_id": 5338248, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5d12d35dd1099bb5682594d1338fa1c4?s=128&d=identicon&r=PG", "display_name": "Smit Raval", "link": "https://stackoverflow.com/users/5338248/smit-raval"}, "edited": false, "score": 0, "creation_date": 1521551517, "post_id": 49384951, "comment_id": 85771085, "body": "Updated comment@SmitRaval"}], "answers": [{"comments": [{"owner": {"reputation": 421, "user_id": 9434120, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/7ca3b1f5217c4b06b142ef05c0758fb0?s=128&d=identicon&r=PG&f=1", "display_name": "Balance", "link": "https://stackoverflow.com/users/9434120/balance"}, "edited": false, "score": 0, "creation_date": 1521551792, "post_id": 49385209, "comment_id": 85771268, "body": "Thank&#39;s. Will try now"}], "tags": [], "owner": {"reputation": 119938, "user_id": 2887218, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WL57j.png?s=128&g=1", "display_name": "jcalz", "link": "https://stackoverflow.com/users/2887218/jcalz"}, "is_accepted": true, "score": 2, "last_activity_date": 1521551809, "last_edit_date": 1521551809, "creation_date": 1521551602, "answer_id": 49385209, "question_id": 49384951, "link": "https://stackoverflow.com/questions/49384951/argument-of-type-jqueryhtmlelement-is-not-assignable-to-parameter-of-t/49385209#49385209", "title": "Argument of type &#39;() =&gt; JQuery&lt;HTMLElement&gt;&#39; is not assignable to parameter of type", "body": "<p>In this line:</p>\n\n<pre><code>return $('.airport_field').focus(function () {\n      if (!$(this).val()) { return $(this).val(' ').keydown(); }\n    });\n</code></pre>\n\n<p>Why are you <em>returning</em> the result of that call?  The <code>each()</code> method doesn't want you to return anything unless you want to stop the iteration early, in which case you should return <code>false</code>. That's what the error is telling you:</p>\n\n<blockquote>\n  <p><code>Argument of type '() =&gt; JQuery' is not assignable to parameter of type '(this: HTMLElement, index: number, element: HTMLElement) =&gt; false | void'. Type 'JQuery' is not assignable to type 'false | void'. Type 'JQuery' is not assignable to type 'void'.</code></p>\n</blockquote>\n\n<p>means</p>\n\n<blockquote>\n  <p>The function is returning a <code>JQuery</code>, which isn't appropriate.  It should return <code>false</code> or <code>void</code>, and <code>JQuery</code> isn't either one of those.  Specifically, it's not <code>void</code>. </p>\n</blockquote>\n\n<p>Maybe you should change the above line to just</p>\n\n<pre><code>$('.airport_field').focus(function () {\n    if (!$(this).val()) { return $(this).val(' ').keydown(); }\n  });\n</code></pre>\n\n<p>without the <code>return</code> and see if it works.  </p>\n\n<p>Hope that helps.  Good luck.</p>\n"}], "owner": {"reputation": 421, "user_id": 9434120, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/7ca3b1f5217c4b06b142ef05c0758fb0?s=128&d=identicon&r=PG&f=1", "display_name": "Balance", "link": "https://stackoverflow.com/users/9434120/balance"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3515, "favorite_count": 0, "accepted_answer_id": 49385209, "answer_count": 1, "score": 0, "last_activity_date": 1521559224, "creation_date": 1521550980, "last_edit_date": 1521559224, "question_id": 49384951, "link": "https://stackoverflow.com/questions/49384951/argument-of-type-jqueryhtmlelement-is-not-assignable-to-parameter-of-t", "title": "Argument of type &#39;() =&gt; JQuery&lt;HTMLElement&gt;&#39; is not assignable to parameter of type", "body": "<p>I have ts code to use with jquery autocomplete</p>\n\n<p>Here is code</p>\n\n<pre><code>    function load_autocomplete_fields(){\n    $('.airport_field').each(function() {\n      $(this).autocomplete({\n        delay:10,\n        minLength: 0,\n        source(request, response) {\n          $(this.element[0]).attr('data-req-term', request.term);\n          $.ajax({\n            url: $(this.element[0]).attr('data-source'),\n            dataType: \"json\",\n            data: {\n              term: request.term\n            },\n            success(data) {\n              const results = [];\n              $.map(data.cities, function(value, key) {\n                results.push(value);\n                return $.map(value.airports, (value2, key2) =&gt; results.push(value2));\n              });\n              $.map(data.airports, (value, key) =&gt; results.push(value));\n              return response(results);},\n            error() { return response([]); }\n          });\n          return null;},\n        focus(event, ui) {\n          return false;},\n        select(event, ui) {\n          const qel = $(event.currentTarget);\n          qel.val(ui.item.fullname);\n          $(qel.attr('data-id-element')).val(ui.item.id);\n          return false;}\n      }).data(\"ui-autocomplete\")._renderItem = function(ul, item) {\n        return create_autocomplete_item($(this.element[0]), ul, item);\n    };\n    $('.airport_field').on('autocompleteselect', function() {\n      if (this.id.indexOf('origin') !== -1) {\n        const id = this.id.split('_')[2];\n        return $(`#search_legs_${id}_destination_text`).focus();\n      }\n    });\n    return $('.airport_field').focus(function() {\n      if (!$(this).val()) { return $(this).val(' ').keydown(); }\n    });\n  });\n  }\n</code></pre>\n\n<p>When I try to compile it I have this error</p>\n\n<blockquote>\n  <p>Argument of type '() => JQuery' is not assignable to parameter of type '(this: HTMLElement, index: number, element: HTMLElement) => false | void'.\n    Type 'JQuery' is not assignable to type 'false | void'.\n      Type 'JQuery' is not assignable to type 'void'.</p>\n</blockquote>\n\n<p>in this row <code>$('.airport_field').each(function() {</code></p>\n\n<p>Here is HTML</p>\n\n<pre><code>&lt;ul&gt;\n&lt;li&gt;\n  &lt;div class=\"header\"&gt;&lt;%= _('Fr\u00e5n') %&gt;&lt;/div&gt;\n  &lt;%= text_field_tag 'search[legs][0][origin_text]', @default_lsp[:legs][0][:origin_city][:return],\n                     class: 'field-1 airport_field', placeholder: _('Fr\u00e5n'),\n                     \"data-source\" =&gt; '/autocomplete/origin/flight',\n                     \"data-id-element\" =&gt; '#search_legs_0_origin_id' %&gt;\n  &lt;%= hidden_field_tag 'search[legs][0][origin_id]', @default_lsp[:legs][0][:origin_id] %&gt;\n  &lt;div class=\"quick-destinations hide-small\"&gt;&lt;%= generate_quick_links_html.html_safe %&gt;&lt;/div&gt;\n&lt;/li&gt;\n&lt;li class=\"icon\"&gt;&lt;%= image_tag 'shared/right_left_arrow.png', class: 'right_left_arrow', \"data-number\" =&gt; 0 %&gt;&lt;/li&gt;\n&lt;li&gt;\n  &lt;div class=\"header\"&gt;&lt;%= _('Till') %&gt;&lt;/div&gt;\n  &lt;%= text_field_tag 'search[legs][0][destination_text]', @default_lsp[:legs][0][:destination_city][:return],\n                     class: 'field-3 airport_field', placeholder: _('Till'),\n                     \"data-source\" =&gt; '/autocomplete/destination/flight',\n                     \"data-id-element\" =&gt; '#search_legs_0_destination_id' %&gt;\n  &lt;%= hidden_field_tag 'search[legs][0][destination_id]', @default_lsp[:legs][0][:destination_id] %&gt;\n&lt;/li&gt;\n</code></pre>\n\n<p></p>\n\n<p>How I can solve it?</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 2537, "user_id": 5371321, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/ZFyVo.jpg?s=128&g=1", "display_name": "Narasimha Reddy - Geeker", "link": "https://stackoverflow.com/users/5371321/narasimha-reddy-geeker"}, "edited": false, "score": 3, "creation_date": 1521549221, "post_id": 49384307, "comment_id": 85769438, "body": "hey it seems like image is not a string. if it is string how does this line works<code>&lt;%= image_tag(attachments.image.url(:thumb))%&gt;</code>??"}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1521549471, "post_id": 49384307, "comment_id": 85769589, "body": "What does <code>attachment.image</code> return? Is it really just a string?"}, {"owner": {"reputation": 377, "user_id": 7079742, "user_type": "registered", "accept_rate": 35, "profile_image": "https://i.stack.imgur.com/1KL5C.jpg?s=128&g=1", "display_name": "Dev", "link": "https://stackoverflow.com/users/7079742/dev"}, "reply_to_user": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1521550086, "post_id": 49384307, "comment_id": 85770029, "body": "@Stefan, thanks for the reply... please check out the update in my question. I added what I get from <code>attachment.image</code>"}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 1, "creation_date": 1521550309, "post_id": 49384307, "comment_id": 85770182, "body": "@Dev obviously, it does <b>not</b> return <code>&quot;no-image.jpg&quot;</code> ;-)"}, {"owner": {"reputation": 48004, "user_id": 216513, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/30a45c64b2ef288f7ec098c5fb353a22?s=128&d=identicon&r=PG", "display_name": "nathanvda", "link": "https://stackoverflow.com/users/216513/nathanvda"}, "edited": false, "score": 0, "creation_date": 1521550362, "post_id": 49384307, "comment_id": 85770225, "body": "Important info you mentioned in one of the comments: you are using carrierwave. To access the filename you have to write <code>attachment.image.original_filename</code> or <code>attachment.image.filename</code>."}, {"owner": {"reputation": 377, "user_id": 7079742, "user_type": "registered", "accept_rate": 35, "profile_image": "https://i.stack.imgur.com/1KL5C.jpg?s=128&g=1", "display_name": "Dev", "link": "https://stackoverflow.com/users/7079742/dev"}, "reply_to_user": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1521550556, "post_id": 49384307, "comment_id": 85770361, "body": "Indeed it doesn&#39;t! @Stefan... so what name should I use then? any idea?"}, {"owner": {"reputation": 867, "user_id": 4547547, "user_type": "registered", "accept_rate": 38, "profile_image": "https://lh4.googleusercontent.com/-AW_Jp9ZwOZQ/AAAAAAAAAAI/AAAAAAAAADE/kMpp9v3TDJc/photo.jpg?sz=128", "display_name": "I&#39;m_ADR", "link": "https://stackoverflow.com/users/4547547/im-adr"}, "edited": false, "score": 0, "creation_date": 1521551320, "post_id": 49384307, "comment_id": 85770927, "body": "@Dev maybe you need to store the <code>image_name</code> in your model. And then do something like : <code>Attachment.where(item_id: @item.id).where.not(image_name: &#39;no-image.jpg&#39;)</code>  The thing is that : to filter your attachments it&#39;s better to pass by the <code>Model</code> and not doing this in the view."}], "answers": [{"comments": [{"owner": {"reputation": 377, "user_id": 7079742, "user_type": "registered", "accept_rate": 35, "profile_image": "https://i.stack.imgur.com/1KL5C.jpg?s=128&g=1", "display_name": "Dev", "link": "https://stackoverflow.com/users/7079742/dev"}, "edited": false, "score": 0, "creation_date": 1521549578, "post_id": 49384359, "comment_id": 85769669, "body": "Thanks for the reply and help @Michael Chaney... I did the following but thimage still shows up.. <code>&lt;% @attachments.reject { |attachment| attachment.image == &quot;no-image.jpg&quot; }.each do |attachment| -%&gt; &lt;%= image_tag(attachment.image.url(:mini))%&gt; &lt;%= link_to t(&quot;store_item_edit_2&quot;), remove_item_attachment_path(attachment),                                 data: { confirm: I18n.t(&quot;store_item_edit_3&quot;) },                                 :method =&gt; :delete %&gt;&lt;% end -%&gt;</code>"}, {"owner": {"reputation": 2231, "user_id": 1238868, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b9884f1eabc8587f2c9dfd2b1ccf9a6?s=128&d=identicon&r=PG", "display_name": "Michael Chaney", "link": "https://stackoverflow.com/users/1238868/michael-chaney"}, "reply_to_user": {"reputation": 377, "user_id": 7079742, "user_type": "registered", "accept_rate": 35, "profile_image": "https://i.stack.imgur.com/1KL5C.jpg?s=128&g=1", "display_name": "Dev", "link": "https://stackoverflow.com/users/7079742/dev"}, "edited": false, "score": 0, "creation_date": 1521551359, "post_id": 49384359, "comment_id": 85770954, "body": "Not surprising since <code>attachment.image</code> isn&#39;t a string.  I&#39;m just showing you how to do it based on what you originally posted, but obviously comparing that large object to a string isn&#39;t going to work.  It looks like you need to compare <code>attachment.image.original_filename</code> since you&#39;re using carrierwave."}, {"owner": {"reputation": 2231, "user_id": 1238868, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b9884f1eabc8587f2c9dfd2b1ccf9a6?s=128&d=identicon&r=PG", "display_name": "Michael Chaney", "link": "https://stackoverflow.com/users/1238868/michael-chaney"}, "reply_to_user": {"reputation": 377, "user_id": 7079742, "user_type": "registered", "accept_rate": 35, "profile_image": "https://i.stack.imgur.com/1KL5C.jpg?s=128&g=1", "display_name": "Dev", "link": "https://stackoverflow.com/users/7079742/dev"}, "edited": false, "score": 0, "creation_date": 1521567836, "post_id": 49384359, "comment_id": 85783238, "body": "Argh, don&#39;t use &quot;original_filename&quot;, use &quot;identifier&quot;."}], "tags": [], "owner": {"reputation": 2231, "user_id": 1238868, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b9884f1eabc8587f2c9dfd2b1ccf9a6?s=128&d=identicon&r=PG", "display_name": "Michael Chaney", "link": "https://stackoverflow.com/users/1238868/michael-chaney"}, "is_accepted": false, "score": 3, "last_activity_date": 1521551881, "last_edit_date": 1521551881, "creation_date": 1521549225, "answer_id": 49384359, "question_id": 49384307, "link": "https://stackoverflow.com/questions/49384307/rails-loop-through-and-skip-a-specific-object/49384359#49384359", "title": "Rails: loop through and skip a specific object", "body": "<p>Just use the \"reject\" method.</p>\n\n<pre><code>&lt;% @attachments.reject { |attachment| attachment.image == \"no-image.jpg\" }.each do |attachment| -%&gt;\n  ...\n&lt;% end -%&gt;\n</code></pre>\n\n<p>edit:</p>\n\n<p>Per comments below and above, the original poster is using Carrierwave to store files.  Because of this, \"attachment.image\" is a Carrierwave uploader object.</p>\n\n<pre><code>&lt;% @attachments.reject { |attachment| attachment.image.identifier == \"no-image.jpg\" }.each do |attachment| -%&gt;\n  ...\n&lt;% end -%&gt;\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 412, "user_id": 4779465, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/rxj3q.png?s=128&g=1", "display_name": "Prasanth_Rubyist", "link": "https://stackoverflow.com/users/4779465/prasanth-rubyist"}, "reply_to_user": {"reputation": 377, "user_id": 7079742, "user_type": "registered", "accept_rate": 35, "profile_image": "https://i.stack.imgur.com/1KL5C.jpg?s=128&g=1", "display_name": "Dev", "link": "https://stackoverflow.com/users/7079742/dev"}, "edited": false, "score": 0, "creation_date": 1521549972, "post_id": 49384534, "comment_id": 85769944, "body": "okay, just find file name method for carrierwave, I think filename is default method"}, {"owner": {"reputation": 48004, "user_id": 216513, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/30a45c64b2ef288f7ec098c5fb353a22?s=128&d=identicon&r=PG", "display_name": "nathanvda", "link": "https://stackoverflow.com/users/216513/nathanvda"}, "edited": false, "score": 0, "creation_date": 1521550155, "post_id": 49384534, "comment_id": 85770073, "body": "In carrierwave you can also use <code>original_filename</code>."}, {"owner": {"reputation": 377, "user_id": 7079742, "user_type": "registered", "accept_rate": 35, "profile_image": "https://i.stack.imgur.com/1KL5C.jpg?s=128&g=1", "display_name": "Dev", "link": "https://stackoverflow.com/users/7079742/dev"}, "edited": false, "score": 0, "creation_date": 1521550674, "post_id": 49384534, "comment_id": 85770464, "body": "I&#39;m sorry guys, this <code>&lt;% if attachment.image.original_filename != &quot;no-image.jpg&quot; %&gt;</code> return this <code>private method original_filename&#39; called for #&lt;AttachmentUploader:0x007fccc2587118&gt;</code>"}, {"owner": {"reputation": 412, "user_id": 4779465, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/rxj3q.png?s=128&g=1", "display_name": "Prasanth_Rubyist", "link": "https://stackoverflow.com/users/4779465/prasanth-rubyist"}, "edited": false, "score": 0, "creation_date": 1521550970, "post_id": 49384534, "comment_id": 85770682, "body": "please use &#39;image_identifier&#39; method, ex: attachment.image_identifier"}, {"owner": {"reputation": 48004, "user_id": 216513, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/30a45c64b2ef288f7ec098c5fb353a22?s=128&d=identicon&r=PG", "display_name": "nathanvda", "link": "https://stackoverflow.com/users/216513/nathanvda"}, "edited": false, "score": 0, "creation_date": 1521551809, "post_id": 49384534, "comment_id": 85771287, "body": "Ow apparently <code>original_filename</code> is only available upon upload, afterwards you can use <code>filename</code>."}], "tags": [], "owner": {"reputation": 412, "user_id": 4779465, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/rxj3q.png?s=128&g=1", "display_name": "Prasanth_Rubyist", "link": "https://stackoverflow.com/users/4779465/prasanth-rubyist"}, "is_accepted": false, "score": 3, "last_activity_date": 1521549701, "creation_date": 1521549701, "answer_id": 49384534, "question_id": 49384307, "link": "https://stackoverflow.com/questions/49384307/rails-loop-through-and-skip-a-specific-object/49384534#49384534", "title": "Rails: loop through and skip a specific object", "body": "<p>If you used paperclip you have default method to find file name <strong>original_filename</strong></p>\n\n<pre><code>&lt;% @attachments.each do |attachments| %&gt;\n     &lt;% if attachment.image.original_filename != \"no-image.jpg\" %&gt;\n        &lt;%= image_tag(attachments.image.url(:thumb))%&gt;\n          &lt;%= link_to \"Remove\", remove_item_attachment_path(attachments),\n                                data: { confirm: \"Are you sure\" },\n                                :method =&gt; :delete %&gt;\n\n    &lt;% end %&gt;\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 377, "user_id": 7079742, "user_type": "registered", "accept_rate": 35, "profile_image": "https://i.stack.imgur.com/1KL5C.jpg?s=128&g=1", "display_name": "Dev", "link": "https://stackoverflow.com/users/7079742/dev"}, "is_accepted": false, "score": 0, "last_activity_date": 1521553177, "last_edit_date": 1521553177, "creation_date": 1521551034, "answer_id": 49384975, "question_id": 49384307, "link": "https://stackoverflow.com/questions/49384307/rails-loop-through-and-skip-a-specific-object/49384975#49384975", "title": "Rails: loop through and skip a specific object", "body": "<p>Ok I go it to work with a combination of Michael Chaney and prasanthrubyist answers</p>\n\n<p><code>&lt;% @attachments.reject { |attachment| attachment.image.file.identifier != \"no-image.jpg\" }.each do |attachment| -%&gt;</code></p>\n"}, {"tags": [], "owner": {"reputation": 5898, "user_id": 372479, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/fdf963abc303447cfdc67c1550fd6923?s=128&d=identicon&r=PG", "display_name": "lobati", "link": "https://stackoverflow.com/users/372479/lobati"}, "is_accepted": false, "score": 0, "last_activity_date": 1552680154, "creation_date": 1552680154, "answer_id": 55189919, "question_id": 49384307, "link": "https://stackoverflow.com/questions/49384307/rails-loop-through-and-skip-a-specific-object/55189919#55189919", "title": "Rails: loop through and skip a specific object", "body": "<p>You can also probably do this in the database via your original query. It's often best to try to keep this sort of logic out of the views.</p>\n\n<pre><code>@attachments = Attachment.where(item_id: @item.id).where.not(image: 'no-image.jpg')\n</code></pre>\n\n<p>Or if the database value is <code>nil</code>:</p>\n\n<pre><code>@attachments = Attachment.where(item_id: @item.id).where.not(image: nil)\n</code></pre>\n\n<p>I'd probably add it as a scope on the model so instead you can do something like:</p>\n\n<pre><code>@attachments = @item.attachments.with_image\n</code></pre>\n"}], "owner": {"reputation": 377, "user_id": 7079742, "user_type": "registered", "accept_rate": 35, "profile_image": "https://i.stack.imgur.com/1KL5C.jpg?s=128&g=1", "display_name": "Dev", "link": "https://stackoverflow.com/users/7079742/dev"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 121, "favorite_count": 0, "answer_count": 4, "score": 0, "last_activity_date": 1552680154, "creation_date": 1521549086, "last_edit_date": 1521550038, "question_id": 49384307, "link": "https://stackoverflow.com/questions/49384307/rails-loop-through-and-skip-a-specific-object", "title": "Rails: loop through and skip a specific object", "body": "<p>I'm looping through an array and showing the images:</p>\n\n<pre><code>&lt;% @attachments.each do |attachment| %&gt;\n    &lt;%= image_tag(attachment.image.url(: thumb))%&gt;\n      &lt;%= link_to \"Remove\", remove_item_attachment_path(attachment),\n                            data: { confirm: \"Are you sure\" },\n                            :method =&gt; :delete %&gt;\n</code></pre>\n\n<p>and this is what I have in the controller in order to find the attachments of the specific item:</p>\n\n<pre><code>@attachments = Attachment.where(item_id: @item.id)\n</code></pre>\n\n<p>The image column inside the attachments table is a <code>string</code></p>\n\n<p>I would like the loop to skip and not show a specific image I have stored inside the db, but show all the other images!</p>\n\n<p>I have tried using the <code>break if</code> or <code>next if</code> condition but without any luck:</p>\n\n<pre><code>&lt;% @attachments.each do |attachment| %&gt;\n&lt;% next if attachment.image == \"no-image.jpg\" %&gt;\n    &lt;%= image_tag(attachment.image.url(:thumb))%&gt;\n      &lt;%= link_to \"Remove\", remove_item_attachment_path(attachment),\n                            data: { confirm: \"Are you sure\" },\n                            :method =&gt; :delete %&gt;\n</code></pre>\n\n<p>or </p>\n\n<pre><code>&lt;% @attachments.each do |attachment| %&gt;\n &lt;% break if attachment.image == \"no-image.jpg\" %&gt;\n    &lt;%= image_tag(attachment.image.url(:thumb))%&gt;\n      &lt;%= link_to \"Remove\", remove_item_attachment_path(attachment),\n                            data: { confirm: \"Are you sure\" },\n                            :method =&gt; :delete %&gt;\n</code></pre>\n\n<p>Any ideas on how I can implement this?</p>\n\n<p><strong>Update 1</strong></p>\n\n<p>this is what I'm getting in the console from <code>attachment.image</code></p>\n\n<p><code>#&lt;AttachmentUploader:0x007f8b932016f8 @model=#&lt;Attachment id: 333, item_id: 136, account_id: nil, image: \"no-image.jpg\", created_at: \"2018-03-19 16:59:01\", updated_at: \"2018-03-19 16:59:01\"&gt;, @mounted_as=:image, @storage=#&lt;CarrierWave::Storage::File:0x007f8b93201540 @uploader=#&lt;AttachmentUploader:0x007f8b932016f8 ...&gt;&gt;, @file=#&lt;CarrierWave::SanitizedFile:0x007f8b93200d48 @file=\"/Users/RubymineProjects/public/uploads/attachment/image/333/no-image.jpg\", @original_filename=nil, @content_type=nil&gt;, @versions={:thumb=&gt;#&lt;AttachmentUploader::Uploader70118693643120:0x007f8b93200c58 @model=#&lt;Attachment id: 333, item_id: 136, account_id: nil, image: \"no-image.jpg\", created_at: \"2018-03-19 16:59:01\", updated_at: \"2018-03-19 16:59:01\"&gt;, @mounted_as=:image, @parent_version=#&lt;AttachmentUploader:0x007f8b932016f8 ...&gt;, @storage=#&lt;CarrierWave::Storage::File:0x007f8b93200b40 @uploader=#&lt;AttachmentUploader::Uploader70118693643120:0x007f8b93200c58 ...&gt;&gt;, @file=#&lt;CarrierWave::SanitizedFile:0x007f8b93200578 @file=\"/Users/RubymineProjects/public/uploads/attachment/image/333/thumb_no-image.jpg\", @original_filename=nil, @content_type=nil&gt;, @versions={}&gt;, :mini=&gt;#&lt;AttachmentUploader::Uploader70118685692560:0x007f8b93200c30 @model=#&lt;Attachment id: 333, item_id: 136, account_id: nil, image: \"no-image.jpg\", created_at: \"2018-03-19 16:59:01\", updated_at: \"2018-03-19 16:59:01\"&gt;, @mounted_as=:image, @parent_version=#&lt;AttachmentUploader:0x007f8b932016f8 ...&gt;, @storage=#&lt;CarrierWave::Storage::File:0x007f8b932004b0 @uploader=#&lt;AttachmentUploader::Uploader70118685692560:0x007f8b93200c30 ...&gt;&gt;, @file=#&lt;CarrierWave::SanitizedFile:0x007f8b932034a8 @file=\"/Users/RubymineProjects/public/uploads/attachment/image/333/mini_no-image.jpg\", @original_filename=nil, @content_type=nil&gt;, @versions={}&gt;}&gt;</code></p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 48413, "user_id": 1279683, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1veuT.jpg?s=128&g=1", "display_name": "Marek Lipka", "link": "https://stackoverflow.com/users/1279683/marek-lipka"}, "edited": false, "score": 2, "creation_date": 1521545204, "post_id": 49382870, "comment_id": 85766645, "body": "1. It&#39;s because <code>Method#to_proc</code> returns <code>lambda</code>, which behaves more like method in terms of <code>return</code> and arguments control."}, {"owner": {"reputation": 1266, "user_id": 6022100, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/dc0adea29934c8ee1c31f96bf85a7fbc?s=128&d=identicon&r=PG", "display_name": "rwold", "link": "https://stackoverflow.com/users/6022100/rwold"}, "reply_to_user": {"reputation": 48413, "user_id": 1279683, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1veuT.jpg?s=128&g=1", "display_name": "Marek Lipka", "link": "https://stackoverflow.com/users/1279683/marek-lipka"}, "edited": false, "score": 0, "creation_date": 1521545305, "post_id": 49382870, "comment_id": 85766709, "body": "Wondered if that might be the case, the name is unfortunate then ..."}, {"owner": {"reputation": 48413, "user_id": 1279683, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1veuT.jpg?s=128&g=1", "display_name": "Marek Lipka", "link": "https://stackoverflow.com/users/1279683/marek-lipka"}, "edited": false, "score": 0, "creation_date": 1521545363, "post_id": 49382870, "comment_id": 85766748, "body": "Not really, <code>lambda</code> <i>is</i> a <code>proc</code> either, but a different kind."}, {"owner": {"reputation": 1266, "user_id": 6022100, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/dc0adea29934c8ee1c31f96bf85a7fbc?s=128&d=identicon&r=PG", "display_name": "rwold", "link": "https://stackoverflow.com/users/6022100/rwold"}, "reply_to_user": {"reputation": 48413, "user_id": 1279683, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1veuT.jpg?s=128&g=1", "display_name": "Marek Lipka", "link": "https://stackoverflow.com/users/1279683/marek-lipka"}, "edited": false, "score": 1, "creation_date": 1521545710, "post_id": 49382870, "comment_id": 85766950, "body": "Yes, but I lost half an hour of my life that I would not have done had the method been called <code>to_lambda</code> :/"}, {"owner": {"reputation": 48413, "user_id": 1279683, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1veuT.jpg?s=128&g=1", "display_name": "Marek Lipka", "link": "https://stackoverflow.com/users/1279683/marek-lipka"}, "edited": false, "score": 0, "creation_date": 1521546779, "post_id": 49382870, "comment_id": 85767666, "body": "The reason this method is called <code>to_proc</code> is it&#39;s standard method called internally when you use expressions such as string.each(&amp;:upcase). In this case, it enables to pass this method &#39;almost&#39; directly as a block, with &amp;method(:breaker)."}, {"owner": {"reputation": 5647, "user_id": 1162143, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/rLSfS.jpg?s=128&g=1", "display_name": "Alexander Presber", "link": "https://stackoverflow.com/users/1162143/alexander-presber"}, "reply_to_user": {"reputation": 48413, "user_id": 1279683, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1veuT.jpg?s=128&g=1", "display_name": "Marek Lipka", "link": "https://stackoverflow.com/users/1279683/marek-lipka"}, "edited": false, "score": 0, "creation_date": 1521547758, "post_id": 49382870, "comment_id": 85768436, "body": "@MarekLipka so <b>is</b> there a way to turn a method into a non-lambda proc and thus achieve the desired effect of returning from <code>foo</code>?"}, {"owner": {"reputation": 48413, "user_id": 1279683, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1veuT.jpg?s=128&g=1", "display_name": "Marek Lipka", "link": "https://stackoverflow.com/users/1279683/marek-lipka"}, "reply_to_user": {"reputation": 5647, "user_id": 1162143, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/rLSfS.jpg?s=128&g=1", "display_name": "Alexander Presber", "link": "https://stackoverflow.com/users/1162143/alexander-presber"}, "edited": false, "score": 0, "creation_date": 1521548081, "post_id": 49382870, "comment_id": 85768664, "body": "@MoMolog As far as I know, there isn&#39;t: <a href=\"https://stackoverflow.com/questions/16197082/how-to-convert-method-or-lambda-to-non-lambda-proc\" title=\"how to convert method or lambda to non lambda proc\">stackoverflow.com/questions/16197082/&hellip;</a>"}, {"owner": {"reputation": 1266, "user_id": 6022100, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/dc0adea29934c8ee1c31f96bf85a7fbc?s=128&d=identicon&r=PG", "display_name": "rwold", "link": "https://stackoverflow.com/users/6022100/rwold"}, "reply_to_user": {"reputation": 5647, "user_id": 1162143, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/rLSfS.jpg?s=128&g=1", "display_name": "Alexander Presber", "link": "https://stackoverflow.com/users/1162143/alexander-presber"}, "edited": false, "score": 0, "creation_date": 1521550510, "post_id": 49382870, "comment_id": 85770322, "body": "@MoMolog in my actual use case, in the event of an error I set an <code>@error_msg</code> and rendered a partial to inform the user; so I ended up settling for code that looks like <code>value = my_function; return if @error_msg; #... rest of function</code> which is less than ideal but better than the duplication I had."}, {"owner": {"reputation": 5647, "user_id": 1162143, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/rLSfS.jpg?s=128&g=1", "display_name": "Alexander Presber", "link": "https://stackoverflow.com/users/1162143/alexander-presber"}, "edited": false, "score": 0, "creation_date": 1521551042, "post_id": 49382870, "comment_id": 85770739, "body": "Another option is not to rescue the exception (or rescue and raise a specific own exception) and handle it appropriately in the parent method."}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1521569489, "post_id": 49382870, "comment_id": 85784288, "body": "Have you considered a service object rather than putting all your business logic in the controller?"}, {"owner": {"reputation": 1266, "user_id": 6022100, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/dc0adea29934c8ee1c31f96bf85a7fbc?s=128&d=identicon&r=PG", "display_name": "rwold", "link": "https://stackoverflow.com/users/6022100/rwold"}, "edited": false, "score": 0, "creation_date": 1521577639, "post_id": 49382870, "comment_id": 85788710, "body": "I&#39;m going to move much of the logic out of the controller, yes; but for this specific instance the code I&#39;m trying to extract is processing the <code>params</code> object and conditionally rendering a particular partial as shown in the snippet, so I&#39;m just trying to separate that out and DRY it up."}], "answers": [{"comments": [{"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 1, "creation_date": 1521553668, "post_id": 49385100, "comment_id": 85772822, "body": "Very arguably. :)"}], "tags": [], "owner": {"reputation": 5647, "user_id": 1162143, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/rLSfS.jpg?s=128&g=1", "display_name": "Alexander Presber", "link": "https://stackoverflow.com/users/1162143/alexander-presber"}, "is_accepted": false, "score": 0, "last_activity_date": 1521552462, "last_edit_date": 1521552462, "creation_date": 1521551326, "answer_id": 49385100, "question_id": 49382870, "link": "https://stackoverflow.com/questions/49382870/method-to-proc-doesnt-return-from-enclosed-function/49385100#49385100", "title": "method.to_proc doesn&#39;t return from enclosed function", "body": "<p>What about</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>def foo(string)\n  processed = breaker(string) \n  puts \"This step should not be executed in the event of an error\"\n  processed\nrescue ArgumentError\nend\n\ndef breaker(string)\n  begin\n    string.upcase!\n  rescue\n    puts \"Well you messed that up, didn't you?\"\n    raise ArgumentError.new(\"could not call upcase! on #{string.inspect}\")\n  end\n  string\nend\n</code></pre>\n\n<p>After all this is arguably a pretty good use case for an exception.</p>\n"}, {"tags": [], "owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "is_accepted": false, "score": 0, "last_activity_date": 1521554681, "last_edit_date": 1521554681, "creation_date": 1521553514, "answer_id": 49385933, "question_id": 49382870, "link": "https://stackoverflow.com/questions/49382870/method-to-proc-doesnt-return-from-enclosed-function/49385933#49385933", "title": "method.to_proc doesn&#39;t return from enclosed function", "body": "<p>It seems part of the confusion is that a <code>Proc</code> or <code>lambda</code> for that matter are distinctly different than a closure (block). </p>\n\n<p>Even if you could convert <code>Method#to_proc</code> to a standard <code>Proc</code> e.g. <code>Proc.new</code> this would simply result in a <code>LocalJumpError</code> because the <code>return</code> would be invalid in this context. </p>\n\n<p>You can use <code>next</code> to break out of a standard <code>Proc</code> but the result would be identical to the <code>lambda</code> that you have now. </p>\n\n<p>The reason <code>Method#to_proc</code> returns a <code>lambda</code> is because a <code>lambda</code> is far more representative of a method call than a standard <code>Proc</code> </p>\n\n<p>For Example: </p>\n\n<pre><code>def foo(string)\n  string\nend \nbar = -&gt;(string) { string } #lambda \nbaz = Proc.new {|string| string } \nfoo\n#=&gt; ArgumentError: wrong number of arguments (given 0, expected 1)\nbar.()\n#=&gt; ArgumentError: wrong number of arguments (given 0, expected 1)\nbaz.()\n#=&gt; nil\n</code></pre>\n\n<p>Since you are converting a method to a proc object I am not sure why you would also want the behavior to change as this could cause ambiguity and confusion. Please note that for this reason you can not go in the other direction either e.g. <code>lambda(&amp;baz)</code> does not result in a <code>lambda</code> either as metioned <a href=\"https://bugs.ruby-lang.org/issues/7314\" rel=\"nofollow noreferrer\">Here</a>.</p>\n\n<p>Now that we have explained all of this and why it shouldn't really be done, it is time to remember that nothing is impossible in ruby so this would technically work:</p>\n\n<pre><code>def foo(string)\n  # place assignment in the guard clause\n  # because the empty return will result in `nil` a falsey value\n  return unless processed = method(:breaker).to_proc.call(string) \n  puts \"This step should not be executed in the event of an error\"\n  processed\nend\n\ndef breaker(string)\n  begin\n   string.upcase!\n  rescue\n    puts \"Well you messed that up, didn't you?\"\n    return\n  end\n  string\nend\n</code></pre>\n\n<p><a href=\"https://repl.it/@engineersmnky/QuarterlyCarpalHypermedia\" rel=\"nofollow noreferrer\">Example</a> </p>\n"}], "owner": {"reputation": 1266, "user_id": 6022100, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/dc0adea29934c8ee1c31f96bf85a7fbc?s=128&d=identicon&r=PG", "display_name": "rwold", "link": "https://stackoverflow.com/users/6022100/rwold"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 61, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1521556026, "creation_date": 1521544774, "last_edit_date": 1521556026, "question_id": 49382870, "link": "https://stackoverflow.com/questions/49382870/method-to-proc-doesnt-return-from-enclosed-function", "title": "method.to_proc doesn&#39;t return from enclosed function", "body": "<p>I was trying to DRY up a Rails controller by extracting a method that includes a guard clause to return prematurely from the controller method in the event of an error. I thought this may be possible using a <code>to_proc</code>, like this pure Ruby snippet:</p>\n\n<pre><code>def foo(string)\n  processed = method(:breaker).to_proc.call(string) \n  puts \"This step should not be executed in the event of an error\"\n  processed\nend\n\ndef breaker(string)\n  begin\n   string.upcase!\n  rescue\n    puts \"Well you messed that up, didn't you?\"\n    return\n  end\n  string\nend\n</code></pre>\n\n<p>My thinking was that having called to_proc on the <code>breaker</code> method, calling the early return statement in the <code>rescue</code> clause should escape the execution of <code>foo</code>. However, it didn't work:</p>\n\n<pre><code>2.4.0 :033 &gt; foo('bar')\nThis step should not be executed in the event of an error\n =&gt; \"BAR\" \n2.4.0 :034 &gt; foo(2)\nWell you messed that up, didn't you?\nThis step should not be executed in the event of an error\n =&gt; nil \n</code></pre>\n\n<p>Can anyone please </p>\n\n<ol>\n<li><p>Explain why this doesn't work  </p></li>\n<li><p>Suggest a way of achieving this effect?</p></li>\n</ol>\n\n<p>Thanks in advance.</p>\n\n<p>EDIT: as people are wondering why the hell I would want to do this, the context is that I'm trying to DRY up the <code>create</code> and <code>update</code> methods  in a Rails controller. (I'm trying to be agressive about it as both methods are about 60 LoC. Yuck.) Both methods feature a block like this:</p>\n\n<pre><code>some_var = nil\nif (some complicated condition)\n  # do some stuff\n  some_var = computed_value\nelsif (some marginally less complicated condition)\n  @error_msg =  'This message is the same in both actions.'\n  render partial: \"show_user_the_error\" and return\n# rest of controller actions ...\n</code></pre>\n\n<p>Hence, I wanted to extract this as a block, <em>including the premature return from the controller action</em>. I thought this might be achievable using a Proc, and when that didn't work I wanted to understand why (which I now do thanks to Marek Lipa).</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "web-scraping", "nokogiri"], "comments": [{"owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 0, "creation_date": 1521562190, "post_id": 49382344, "comment_id": 85779630, "body": "Did you check (for example by logging the response) that the sites actually return HTML content? There might be a server error or error page when you call the page without a proper user agent set. Did you check if the selectors actually extract the expected content? Did you check if <code>number_of_new_items</code> changes?"}, {"owner": {"reputation": 21, "user_id": 9518530, "user_type": "registered", "profile_image": "https://graph.facebook.com/10154437528676199/picture?type=large", "display_name": "Max Powah", "link": "https://stackoverflow.com/users/9518530/max-powah"}, "reply_to_user": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 0, "creation_date": 1521575848, "post_id": 49382344, "comment_id": 85787732, "body": "I&#39;m not sure how to log the response. I&#39;ve used tail -f log/production.log to see the running log but I don&#39;t see anything showing whether it&#39;s returning HTML content for any of the scrapes. The CSS selectors appear to be correct according to Chrome extension CSS Selector Tester. I am not sure how to check if the number_of_new_items is changing, however, the app is supposed to give a numerical figure of how many new items have been scraped and I don&#39;t receive anything.  On a related note, normally working website scrapes do not work when trying to use the new ones."}, {"owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 0, "creation_date": 1521625146, "post_id": 49382344, "comment_id": 85806550, "body": "Don&#39;t do too many steps at once (like <code>Nokogiri::HTML(open(url.gsub(&#39;{page}&#39;, page.to_s)))</code> is building the url, downloads the page and initializes Nokogiri. Or <code>doc.css(&quot;...&quot;).reverse.each</code> parses the HTML, changes the order and iterates over the result). Instead, assign intermediate steps to a variable and log them into a file (<code>Rails.logger.debug &quot;...&quot;</code>) or raise an exception if the response is unexpected (<code>raise &quot;No HTML&quot; if open(...).blank?</code>). Or log the <code>Rails.logger.debug &quot;NEW ITEMS: #{number_of_new_items}&quot;</code>"}], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 9518530, "user_type": "registered", "profile_image": "https://graph.facebook.com/10154437528676199/picture?type=large", "display_name": "Max Powah", "link": "https://stackoverflow.com/users/9518530/max-powah"}, "edited": false, "score": 0, "creation_date": 1521556110, "post_id": 49383403, "comment_id": 85774869, "body": "Sorry, those were parts edited out for ease of reading. I have edited the original code snippet to include everything in the scheduler.rb file. (thank you for taking a look)"}], "tags": [], "owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "is_accepted": false, "score": 2, "last_activity_date": 1521546419, "creation_date": 1521546419, "answer_id": 49383403, "question_id": 49382344, "link": "https://stackoverflow.com/questions/49382344/nokogiri-scraping-with-ruby-on-rails-not-working-as-expected/49383403#49383403", "title": "Nokogiri scraping with Ruby On Rails not working as expected", "body": "<p><code>new</code> just initializes an instance but doesn't save the instance. Do you actually call <code>save</code> somewhere?</p>\n\n<p>You have two options:</p>\n\n<p>Call <code>save</code> on the item:</p>\n\n<pre><code>item = action.items.new(\n  # ...\n)\nitem.save\n</code></pre>\n\n<p>Or use <code>create</code> instead of <code>new</code>:</p>\n\n<pre><code>item = action.items.create(\n  # ...\n)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 21, "user_id": 9518530, "user_type": "registered", "profile_image": "https://graph.facebook.com/10154437528676199/picture?type=large", "display_name": "Max Powah", "link": "https://stackoverflow.com/users/9518530/max-powah"}, "is_accepted": false, "score": 0, "last_activity_date": 1522504149, "creation_date": 1522504149, "answer_id": 49588468, "question_id": 49382344, "link": "https://stackoverflow.com/questions/49382344/nokogiri-scraping-with-ruby-on-rails-not-working-as-expected/49588468#49588468", "title": "Nokogiri scraping with Ruby On Rails not working as expected", "body": "<p>In case someone else comes across this. I got the scraping of lot-art.com to work. It seemed that I was lacking specificity in the css selector for nokogiri to pull the correct data.</p>\n\n<p>I am still having continuing issues with lot-tissimo although that appears to be from something else as other scrapers have issues such as scraping-hub's portia spiders.</p>\n"}], "owner": {"reputation": 21, "user_id": 9518530, "user_type": "registered", "profile_image": "https://graph.facebook.com/10154437528676199/picture?type=large", "display_name": "Max Powah", "link": "https://stackoverflow.com/users/9518530/max-powah"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 167, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1522504149, "creation_date": 1521543326, "last_edit_date": 1521556163, "question_id": 49382344, "link": "https://stackoverflow.com/questions/49382344/nokogiri-scraping-with-ruby-on-rails-not-working-as-expected", "title": "Nokogiri scraping with Ruby On Rails not working as expected", "body": "<p>I'm completely new to Ruby on Rails but I think I might be missing something obvious. I'm currently working on a webapp that scrapes auction websites. The bones of the app was created by someone else. I'm currently trying to add new website scrapes but they don't seem to be working.</p>\n\n<p>I have read through some of the Nokogiri documentation, checked that the scraped information is indeed not being written to the database (the seeded URLs that are being targeted have been when I check via the rails console) and used the chrome extension CSS Selector Tester to check that I am targeting the correct CSS selectors. The record ids are correct when I check via the rails console.</p>\n\n<p>I have put what I think are the important sections of code below, but I might be missing something that I don't realise is important.</p>\n\n<p>The websites I'm having issues with are <a href=\"https://www.lot-art.com/auction-search/?form_id=lot_search_form&amp;page=1&amp;mq=&amp;q=Vase&amp;ord=recent\" rel=\"nofollow noreferrer\">Lot-art.com</a> &amp; <a href=\"https://lot-tissimo.com/en/cmd=s&amp;lwr=&amp;ww=Vase&amp;xw=&amp;srt=SN&amp;wg=EUR&amp;page=1\" rel=\"nofollow noreferrer\">Lot-Tissimo.com</a></p>\n\n<p>Any help will be much appreciated.</p>\n\n<p>Seeded URLs</p>\n\n<pre><code>Source.create(name: \"Auction.fr\", query_template: \"https://www.auction.fr/_en/lot/search/?contexte=futures&amp;tri=date_debut%20ASC&amp;query={query}&amp;page={page}\")\nSource.create(name: \"Invaluable.co.uk\", query_template: \"https://www.invaluable.co.uk/search/api/search-results?keyword={query}&amp;size=1000\")\nSource.create(name: \"Interencheres.com\", query_template: \"http://www.interencheres.com/en/recherche/lot?search%5Bkeyword%5D={query}&amp;page={page}\")\nSource.create(name: \"Gazette-drouot.com\", query_template: \"http://catalogue.gazette-drouot.com/html/g/recherche.jsp?numPage={page}&amp;filterDate=1&amp;query={query}&amp;npp=100\")\nSource.create(name: \"Lot-art.com\", query_template: \"http://www.lot-art.com/auction-search/?form_id=lot_search_form&amp;page=1&amp;mq=&amp;q={query}&amp;ord=recent\")\nSource.create(name: \"Lot-tissimo.com\", query_template: \"https://lot-tissimo.com/en/cmd=s&amp;lwr=&amp;ww={query}&amp;xw=&amp;srt=SN&amp;wg=EUR&amp;page={page}\")\n</code></pre>\n\n<p>Scheduler code</p>\n\n<pre><code>require 'rufus-scheduler'\n\nrequire 'nokogiri'\nrequire 'mechanize'\nrequire 'open-uri'\nrequire \"net/https\"\n\n\ns = Rufus::Scheduler.singleton\n\n\ns.interval '1m' do\n  setting = Setting.find(1)\n  agent = Mechanize.new\n\n  agent.user_agent_alias = 'Windows Chrome'\n\n  agent.cookie_jar.load(File.join(Rails.root, 'tmp/cookies.yaml'))\n  List.all.each do |list|\n    number_of_new_items = 0\n\n    list.actions.each do |action|\n      url = action.source.query_template.gsub('{query}', action.list.query)\n\n      case action.source.id\n      when 1 # Auction.fr\n        20.downto(1) do |page|\n          doc = Nokogiri::HTML(open(url.gsub('{page}', page.to_s)))\n\n          doc.css(\"div.list-products &gt; ul &gt; li\").reverse.each do |item_data|\n\n            price = 0\n            if item_data.at_css(\"h3.h4.adjucation.ft-blue\") &amp;&amp; /Selling price : ([\\d\\s]+) \u20ac/.match(item_data.at_css(\"h3.h4.adjucation.ft-blue\").text)\n              price = /Selling price : ([\\d\\s]+) \u20ac/.match(item_data.at_css(\"h3.h4.adjucation.ft-blue\").text)[1].gsub(\" \", \"\")\n            end\n\n            item = action.items.new(\n              title: item_data.at_css(\"h2\").text.strip,\n              url: item_data.at_css(\"h2 a\")[\"href\"],\n              picture: item_data.at_css(\"div.image-wrap.lazy div.image img\")[\"src\"],\n              price: price,\n              currency: \"\u20ac\"\n            )\n\n            ActiveRecord::Base.logger.silence do # This disable writing logs\n              if item.save\n                number_of_new_items = number_of_new_items + 1\n              end\n            end\n\n          end\n        end\n\n      when 97 # Lot-Tissimo.com\n        5.downto(1) do |page|\n          doc = Nokogiri::HTML(open(url.gsub('{page}', page.to_s)))\n\n          doc.css(\"#inhalt &gt; .objektliste\").reverse.each do |item_data|\n\n      #      price = 0\n      #      if item_data.at_css(\"h3.h4.adjucation.ft-blue\") &amp;&amp; /Selling price : ([\\d\\s]+) \u20ac/.match(item_data.at_css(\"h3.h4.adjucation.ft-blue\").text)\n      #        price = /Selling price : ([\\d\\s]+) \u20ac/.match(item_data.at_css(\"h3.h4.adjucation.ft-blue\").text)[1].gsub(\" \", \"\")\n      #      end\n\n            item = action.items.new(\n              title: item_data.at_css(\"div.objli-desc\").text.strip,\n              url: item_data.at_css(\"td.objektliste-foto a\")[\"href\"],\n              picture: item_data.at_css(\"td.objektliste-foto a#lot_link img\")[\"src\"],\n              price: price,\n              currency: \"\u20ac\"\n            )\n\n            ActiveRecord::Base.logger.silence do # This disable writing logs\n              if item.save\n                number_of_new_items = number_of_new_items + 1\n              end\n            end\n\n\n          end\n        end\n\n      when 2 # Invaluable.co.uk\n        doc = JSON.parse(open(url).read)\n\n        doc[\"itemViewList\"].reverse.each do |item_data|\n\n          puts item_data[\"itemView\"][\"photos\"]\n\n          item = action.items.new(\n            title: item_data[\"itemView\"][\"title\"],\n            url: \"https://www.invaluable.co.uk/buy-now/\" + item_data[\"itemView\"][\"title\"].parameterize + \"-\" + item_data[\"itemView\"][\"ref\"],\n            picture: item_data[\"itemView\"][\"photos\"] != nil ? item_data[\"itemView\"][\"photos\"].first[\"_links\"][\"medium\"][\"href\"] : nil,\n            price: item_data[\"itemView\"][\"price\"],\n            currency: item_data[\"itemView\"][\"currencySymbol\"]\n          )\n\n          ActiveRecord::Base.logger.silence do # This disable writing logs\n            if item.save\n              number_of_new_items = number_of_new_items + 1\n            end\n          end\n\n        end\n\n\n\n      when 3 # Interencheres.com\n\n      #  doc = Nokogiri::HTML(open(url))\n       5.downto(1) do |page|\n        doc = Nokogiri::HTML(open(url.gsub('{page}', page.to_s)))\n\n        doc.css(\"div#lots_0 div.ligne_vente\").reverse.each do |item_data|\n\n          price = 0\n\n\n          item = action.items.new(\n            title: item_data.at_css(\"div.ph_vente div.des_vente p a\").text.strip,\n            url: \"http://www.interencheres.com\" + item_data.at_css(\"div.ph_vente div.des_vente p a\")[\"href\"],\n            picture: item_data.at_css(\"div.ph_vente div.gd_ph_vente img\")[\"src\"],\n            price: price,\n            currency: \"\u20ac\"\n          )\n\n          ActiveRecord::Base.logger.silence do # This disable writing logs\n            if item.save\n              number_of_new_items = number_of_new_items + 1\n            end\n            end\n\n          end\n        end\n\n      when 4 # Gazette-drouot.com\n\n         5.downto(1) do |page|\n       #   doc = Nokogiri::HTML(open(url.gsub('{page}', page.to_s)))\n         doc = agent.get(url.gsub('{page}', page.to_s))\n      #  doc = agent.get(url)\n        doc.css(\"div#recherche_resultats div.lot_recherche\").reverse.each do |item_data|\n\n          price = 0\n\n          picture = item_data.at_css(\"img.image_thumb_recherche\") ? item_data.at_css(\"img.image_thumb_recherche\")[\"src\"] : nil\n          item = action.items.new(\n            title: item_data.at_css(\"#des_recherche\").text.strip.truncate(140),\n            url: \"http://catalogue.gazette-drouot.com/html/g/\" + item_data.at_css(\"a.lien_under\")[\"href\"],\n            picture: picture,\n            price: price,\n            currency: \"\u20ac\"\n          )\n\n          ActiveRecord::Base.logger.silence do # This disable writing logs\n            if item.save\n              number_of_new_items = number_of_new_items + 1\n            end\n          end\n          end\n\n        end\n\n      when 69 # Lot-art.com\n\n        doc = agent.get(url)\n        doc.css(\"div.lot_list_holder\").reverse.each do |item_data|\n\n          price = 0\n\n          item = action.items.new(\n            title: item_data.at_css(\"div.lot_list_body a\")[0].text.strip.truncate(140),\n            url: item_data.at_css(\"div.lot_list_body\")[\"href\"],\n            picture: item_data.at_css(\"a.lot_list_thumb img\") [\"src\"],\n            price: price,\n            currency: \"\u20ac\"\n          )\n\n          ActiveRecord::Base.logger.silence do # This disable writing logs\n            if item.save\n              number_of_new_items = number_of_new_items + 1\n            end\n          end\n\n\n        end\n\n      end\n\n    end\n\n    if number_of_new_items &gt; 0 &amp;&amp; setting.notifications_per_hour &gt; setting.notifications_this_hour &amp;&amp; setting.pushover_app_token.present? &amp;&amp; setting.pushover_user_key.present?\n      url = URI.parse(\"https://api.pushover.net/1/messages.json\")\n      req = Net::HTTP::Post.new(url.path)\n      req.set_form_data({\n                          :token =&gt; setting.pushover_app_token,\n                          :user =&gt; setting.pushover_user_key,\n                          :message =&gt; \"#{number_of_new_items} new items on #{list.name}!\",\n                          :url_title =&gt; \"Check the list\",\n                          :url =&gt; \"http://spottheauction.com/lists/#{list.id}\"\n      })\n      res = Net::HTTP.new(url.host, url.port)\n      res.use_ssl = true\n      res.verify_mode = OpenSSL::SSL::VERIFY_PEER\n      res.start {|http| http.request(req) }\n    end\n  end\n  agent.cookie_jar.save(File.join(Rails.root, 'tmp/cookies.yaml'))\nend\n\ns.cron '0 * * * *' do\n  setting = Setting.find(1)\n  setting.notifications_this_hour = 0\n  setting.save\nend\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "multi-tenant"], "comments": [{"owner": {"reputation": 1521, "user_id": 7177640, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/21ab719e4dfae3533a20da4f52e5c9e7?s=128&d=identicon&r=PG", "display_name": "nattfodd", "link": "https://stackoverflow.com/users/7177640/nattfodd"}, "edited": false, "score": 0, "creation_date": 1521539812, "post_id": 49381004, "comment_id": 85762811, "body": "Looks like an intention. So what&#39;s your question?"}, {"owner": {"reputation": 4644, "user_id": 2594185, "user_type": "registered", "profile_image": "https://graph.facebook.com/100003773788931/picture?type=large", "display_name": "Jagdeep Singh", "link": "https://stackoverflow.com/users/2594185/jagdeep-singh"}, "edited": false, "score": 0, "creation_date": 1521552012, "post_id": 49381004, "comment_id": 85771456, "body": "How do you want us to do it for you?"}], "answers": [{"tags": [], "owner": {"reputation": 7032, "user_id": 1743174, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/9f871161f754442df697dce1cede77a5?s=128&d=identicon&r=PG&f=1", "display_name": "Dipak Gupta", "link": "https://stackoverflow.com/users/1743174/dipak-gupta"}, "is_accepted": false, "score": 0, "last_activity_date": 1521556323, "last_edit_date": 1521556323, "creation_date": 1521540488, "answer_id": 49381334, "question_id": 49381004, "link": "https://stackoverflow.com/questions/49381004/rails-multi-tenant-application/49381334#49381334", "title": "Rails Multi tenant Application", "body": "<p>Apartment gem create different schema for different tenenats not databases. You can check difference <a href=\"https://stackoverflow.com/questions/5323740/difference-between-database-and-schema\">here</a>.</p>\n\n<p>For your case you can copy record of one schema using below command:</p>\n\n<pre><code>pg_dump -U &lt;username&gt; -p &lt;port&gt; -n &lt;source&gt; &lt;database name&gt; &gt;&gt; &lt;dump filename&gt;\n</code></pre>\n\n<p><code>source</code> is your schema name for source. It is your primary tenant which you want to copy.</p>\n\n<p><code>target</code> is you schema where you want copy all records.</p>\n\n<p>Change your schema name in your new dump file by opening in any editor.</p>\n\n<pre><code># edit the dump.file\n\nCREATE SCHEMA &lt;source&gt;; =&gt; CREATE SCHEMA &lt;target&gt;;\nALTER SCHEMA &lt;source&gt; OWNER TO &lt;username&gt;; =&gt; ALTER SCHEMA &lt;target&gt; OWNER TO &lt;username&gt;; \n</code></pre>\n\n<p>Now restore new dump file.</p>\n\n<pre><code>psql -U &lt;username&gt; -p &lt;port&gt; -d &lt;database&gt; -f &lt;dump filename&gt;\n</code></pre>\n\n<p>You can copy data from one tenant to another tenanat by creating a rake task and switching tenants.</p>\n\n<pre><code>Apartment::Tenant.switch!(\"one tenant\")\n\n# Retrive data that you want in a local object\n# local_object = Model.all\n\nApartment::Tenant.switch!(\"second tenant\")\n\n# Save all data in second tenant from local_oject\n# local_oject.each do |object|\n#   object.save\n# end\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 4644, "user_id": 2594185, "user_type": "registered", "profile_image": "https://graph.facebook.com/100003773788931/picture?type=large", "display_name": "Jagdeep Singh", "link": "https://stackoverflow.com/users/2594185/jagdeep-singh"}, "edited": false, "score": 0, "creation_date": 1521552041, "post_id": 49384165, "comment_id": 85771477, "body": "This is not an answer. May be add it to your question."}, {"owner": {"reputation": 7032, "user_id": 1743174, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/9f871161f754442df697dce1cede77a5?s=128&d=identicon&r=PG&f=1", "display_name": "Dipak Gupta", "link": "https://stackoverflow.com/users/1743174/dipak-gupta"}, "edited": false, "score": 0, "creation_date": 1521556299, "post_id": 49384165, "comment_id": 85775025, "body": "Is your new tenant properly created ? use switch! instead of switch in your rake task to make sure tenant exist."}], "tags": [], "owner": {"reputation": 1, "user_id": 7167280, "user_type": "registered", "profile_image": "https://graph.facebook.com/1684524548239674/picture?type=large", "display_name": "Nadir Jahan", "link": "https://stackoverflow.com/users/7167280/nadir-jahan"}, "is_accepted": false, "score": 0, "last_activity_date": 1521548637, "creation_date": 1521548637, "answer_id": 49384165, "question_id": 49381004, "link": "https://stackoverflow.com/questions/49381004/rails-multi-tenant-application/49384165#49384165", "title": "Rails Multi tenant Application", "body": "<pre><code>using this way but not saving in new tenant    \nApartment::Tenant.switch(\"tenant1\")\n        members= Member.all\n        Apartment::Tenant.switch(\"tenant2\")\n        members.each do |member|\n          begin\n            member.save\n            puts \"migrating member.id\"\n          rescue=&gt;e\n            puts e\n          end\n        end\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 7167280, "user_type": "registered", "profile_image": "https://graph.facebook.com/1684524548239674/picture?type=large", "display_name": "Nadir Jahan", "link": "https://stackoverflow.com/users/7167280/nadir-jahan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 253, "favorite_count": 0, "answer_count": 2, "score": -2, "last_activity_date": 1521556323, "creation_date": 1521539550, "question_id": 49381004, "link": "https://stackoverflow.com/questions/49381004/rails-multi-tenant-application", "title": "Rails Multi tenant Application", "body": "<p>I am creating a multi-tenant rails app for different clubs. I'm using the apartment gem so it creates different databases for each club which has  more than 100 tables.  now i want to  take dump of one  tenant and import it to other club tenant </p>\n"}, {"tags": ["ruby", "rspec", "sinatra"], "comments": [{"owner": {"reputation": 5647, "user_id": 1162143, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/rLSfS.jpg?s=128&g=1", "display_name": "Alexander Presber", "link": "https://stackoverflow.com/users/1162143/alexander-presber"}, "edited": false, "score": 0, "creation_date": 1521538383, "post_id": 49380262, "comment_id": 85761801, "body": "Is this your complete <code>listproduct_controller_spec.rb</code>? Are you including <code>Rack::Test::Methods</code> anywhere?"}, {"owner": {"reputation": 1, "user_id": 9443278, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4e3e21daee1fd35eec0c436bc1ad82e9?s=128&d=identicon&r=PG&f=1", "display_name": "Fr3ddy", "link": "https://stackoverflow.com/users/9443278/fr3ddy"}, "reply_to_user": {"reputation": 5647, "user_id": 1162143, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/rLSfS.jpg?s=128&g=1", "display_name": "Alexander Presber", "link": "https://stackoverflow.com/users/1162143/alexander-presber"}, "edited": false, "score": 0, "creation_date": 1521545114, "post_id": 49380262, "comment_id": 85766591, "body": "I include that in my spec_helper.rb"}, {"owner": {"reputation": 4338, "user_id": 299774, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/eab8557a9cb59427455bac3cc59d2802?s=128&d=identicon&r=PG", "display_name": "Grzegorz", "link": "https://stackoverflow.com/users/299774/grzegorz"}, "edited": false, "score": 0, "creation_date": 1521556205, "post_id": 49380262, "comment_id": 85774950, "body": "anything interesting in the logs?"}, {"owner": {"reputation": 1, "user_id": 9443278, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4e3e21daee1fd35eec0c436bc1ad82e9?s=128&d=identicon&r=PG&f=1", "display_name": "Fr3ddy", "link": "https://stackoverflow.com/users/9443278/fr3ddy"}, "edited": false, "score": 0, "creation_date": 1521559478, "post_id": 49380262, "comment_id": 85777634, "body": "The logs from the rspec get output like this  Failure/Error: expect(last_response).to be_ok        expected <code>#&lt;Rack::MockResponse:0x000000037d42d8 @original_headers={&quot;Content-Type&quot;=&gt;&quot;text&#47;html&quot;, &quot;Content-Length...bled the &lt;code&gt;show_exceptions&lt;&#47;code&gt; setting.&lt;&#47;p&gt;\\n  &lt;&#47;div&gt; &lt;!-- &#47;WRAP --&gt;\\n  &lt;&#47;body&gt;\\n&lt;&#47;html&gt;\\n&quot;]&gt;.ok?</code> to return true, got false  in the rspec failure, i think it because it returns 500"}], "owner": {"reputation": 1, "user_id": 9443278, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4e3e21daee1fd35eec0c436bc1ad82e9?s=128&d=identicon&r=PG&f=1", "display_name": "Fr3ddy", "link": "https://stackoverflow.com/users/9443278/fr3ddy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 90, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1521560348, "creation_date": 1521537428, "last_edit_date": 1521560348, "question_id": 49380262, "link": "https://stackoverflow.com/questions/49380262/rspec-is-different-from-the-app", "title": "Rspec is different from the app", "body": "<p>I'm currently working on a Ruby/Sinatra App and now I'm stuck because my rspec testing is not working properly on the controller. But when I tried my API using curl or web the code just works!.</p>\n\n<p>Here are my file, spesificly on that line of code</p>\n\n<p>listproduct_controller.rb </p>\n\n<pre><code>get '/' do\n    products = Product.all\n    payload = []\n    products.each do |product|\n        payload.push({ :exhibit_name =&gt; product.exhibit_name, :icon =&gt; product.icon })\n    end\n\n    return {\n        :status =&gt; 'SUCCESS',\n        :message =&gt; 200,\n        :payload =&gt; payload\n    }.to_json\nend\n</code></pre>\n\n<p>and here are my spec file\nlistproduct_controller_spec.rb</p>\n\n<pre><code>context \"GET to /products\" do\n  before { allow(Product).to receive(:all) }\n  before { allow(Product).to receive(:find_by) }\n\n  it \"returns status 200 OK\" do\n    get '/'\n    puts(last_response)\n    expect(last_response).to be_ok\n  end\n\n  it \"show a list of product's name and its icon\" do\n    get '/'\n    @products = Product.all.to_a\n    expect(last_response.body).to include_json(@products)\n  end\nend\n</code></pre>\n\n<p>When I puts the last_response on spec it shows this </p>\n\n<pre><code>500 \n{\"Content-Type\"=&gt;\"text/html\", \"Content-Length\"=&gt;\"212150\"}\n#&lt;Rack::BodyProxy:0x0000000480b1d8&gt;\n</code></pre>\n\n<p>but when im using curl or apps it just works and return\n200 status code with the payload</p>\n\n<p>Can anyone help me what I did wrong?</p>\n\n<p>UPDATE :</p>\n\n<p>I solved it, it was the problem on the database, where all the product in the development database were not on the test database so it returns 500 of empty database.</p>\n"}, {"tags": ["ruby", "chef-infra", "chef-recipe"], "comments": [{"owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 0, "creation_date": 1521537193, "post_id": 49379712, "comment_id": 85760988, "body": "If the error occurred in the first one of your <code>&lt;block of code&gt;</code>, then that should be captured. If you indeed have an error that is not captured, then that must be from the second one of your <code>&lt;block of code&gt;</code>, and there is no way to save that unless you put another <code>begin</code>...<code>rescue</code> block in there."}, {"owner": {"reputation": 31, "user_id": 9260305, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2429eed8eb06f14724581aed331dd79a?s=128&d=identicon&r=PG&f=1", "display_name": "rose", "link": "https://stackoverflow.com/users/9260305/rose"}, "reply_to_user": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 0, "creation_date": 1521537513, "post_id": 49379712, "comment_id": 85761205, "body": "@sawa - second   &lt;block of code&gt; have some log() only nothing else. In the first   &lt;block of code&gt;, have added chef resources like &#39;execute&#39;, which is failing and not able catch by rescue"}], "answers": [{"tags": [], "owner": {"reputation": 43208, "user_id": 78722, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cf611565f0b79abd0b3dc200ad867661?s=128&d=identicon&r=PG", "display_name": "coderanger", "link": "https://stackoverflow.com/users/78722/coderanger"}, "is_accepted": false, "score": 1, "last_activity_date": 1521540357, "creation_date": 1521540357, "answer_id": 49381299, "question_id": 49379712, "link": "https://stackoverflow.com/questions/49379712/catch-run-time-exception-in-chef/49381299#49381299", "title": "Catch run time exception in chef", "body": "<p>This will only catch exceptions at compile time, not converge time. Chef is inherently asynchronous thanks to our two-pass loading model. You can read more about it at <a href=\"https://coderanger.net/two-pass/\" rel=\"nofollow noreferrer\">https://coderanger.net/two-pass/</a>. In general the only option is the <code>ignore_errors</code> property, though that will still show a nasty error trace, it just won't abort the run when a resource errors. More specifically you would need to say what kind of code you're talking about. You probably want to use guard conditions (<code>not_if</code>/<code>only_if</code>) to avoid converging the resource if something is wrong and it will fail.</p>\n"}], "owner": {"reputation": 31, "user_id": 9260305, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2429eed8eb06f14724581aed331dd79a?s=128&d=identicon&r=PG&f=1", "display_name": "rose", "link": "https://stackoverflow.com/users/9260305/rose"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 481, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1521540357, "creation_date": 1521535696, "last_edit_date": 1521537047, "question_id": 49379712, "link": "https://stackoverflow.com/questions/49379712/catch-run-time-exception-in-chef", "title": "Catch run time exception in chef", "body": "<p>I have the following code structure:</p>\n\n<pre><code>begin\n  &lt;block of code&gt;\nrescue Exception =&gt; e\n  &lt;block of code&gt;\nend\n</code></pre>\n\n<p>This cannot catch run time errors, and Chef run fails.</p>\n\n<p>Is there any way to catch exception during run time in Chef?</p>\n"}, {"tags": ["arrays", "ruby", "class"], "comments": [{"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1521534284, "post_id": 49379018, "comment_id": 85759214, "body": "BTW, instead of <code>puts player.inventory.inspect</code> you can write <code>p player.inventory</code>"}], "answers": [{"comments": [{"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1521534239, "post_id": 49379125, "comment_id": 85759189, "body": "Even with this change, your <code>inventory</code> method would still &quot;reset&quot; the array."}], "tags": [], "owner": {"reputation": 138, "user_id": 3653542, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/CqVm5.gif?s=128&g=1", "display_name": "BenjaminJB", "link": "https://stackoverflow.com/users/3653542/benjaminjb"}, "is_accepted": false, "score": 0, "last_activity_date": 1521533309, "creation_date": 1521533309, "answer_id": 49379125, "question_id": 49379018, "link": "https://stackoverflow.com/questions/49379018/array-remains-empty-after-elements-were-pushed-in-a-method/49379125#49379125", "title": "Array remains empty after elements were pushed in a method", "body": "<p>I figured it out 10 seconds after posting this, after messing about with it for an hour.</p>\n\n<p>I needed to add <code>inventory</code> to <code>def initialize</code>, and then pass an empty array to <code>player = Player.new(10,1,2,6)</code> so it became <code>player = Player.new(10,1,2,6,[])</code>.</p>\n\n<p>I still don't know why this works.</p>\n"}, {"tags": [], "owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "is_accepted": true, "score": 3, "last_activity_date": 1521534144, "last_edit_date": 1521534144, "creation_date": 1521533496, "answer_id": 49379173, "question_id": 49379018, "link": "https://stackoverflow.com/questions/49379018/array-remains-empty-after-elements-were-pushed-in-a-method/49379173#49379173", "title": "Array remains empty after elements were pushed in a method", "body": "<p>Whenever you call your <code>inventory</code> method:</p>\n\n<pre><code>def inventory\n  @inventory = []\nend\n</code></pre>\n\n<p>... it assigns a new (empty) array to <code>@inventory</code>, thus overwriting any existing items.</p>\n\n<p>The correct way is to either assign <code>@inventory</code> in <code>initialize</code> and just return it from within the getter:</p>\n\n<pre><code>class Player\n  def initialize(hp, attack, defence, gold)\n    @hp = hp\n    @attack = attack\n    @defence = defence\n    @gold = gold \n    @inventory = []   \n  end\n\n  def inventory\n    @inventory\n  end\n\n  # ...\nend\n</code></pre>\n\n<p>or to not assign it at all in <code>initialize</code> and use the <a href=\"http://ruby-doc.org/core-2.5.0/doc/syntax/assignment_rdoc.html#label-Abbreviated+Assignment\" rel=\"nofollow noreferrer\">conditional assignment</a> operator:</p>\n\n<pre><code>class Player\n  def initialize(hp, attack, defence, gold)\n    @hp = hp\n    @attack = attack\n    @defence = defence\n    @gold = gold    \n  end\n\n  def inventory\n    @inventory ||= []\n  end\n\n  # ...\nend\n</code></pre>\n\n<p>which will assign <code>[]</code> to <code>@inventory</code> only if it was <code>nil</code> or <code>false</code> (i.e. the first time you call <code>inventory</code>).</p>\n\n<p>A getter that just returns the corresponding instance variable (as in the former example) can also be created via <a href=\"http://ruby-doc.org/core-2.5.0/Module.html#method-i-attr_reader\" rel=\"nofollow noreferrer\"><code>attr_reader</code></a>:</p>\n\n<pre><code>class Player\n  attr_reader :inventory\n\n  # ...\nend\n</code></pre>\n"}], "owner": {"reputation": 138, "user_id": 3653542, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/CqVm5.gif?s=128&g=1", "display_name": "BenjaminJB", "link": "https://stackoverflow.com/users/3653542/benjaminjb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 41, "favorite_count": 0, "accepted_answer_id": 49379173, "answer_count": 2, "score": 0, "last_activity_date": 1521534144, "creation_date": 1521532895, "last_edit_date": 1521533523, "question_id": 49379018, "link": "https://stackoverflow.com/questions/49379018/array-remains-empty-after-elements-were-pushed-in-a-method", "title": "Array remains empty after elements were pushed in a method", "body": "<pre><code>class Player\n  def initialize(hp, attack, defence, gold)\n    @hp = hp\n    @attack = attack\n    @defence = defence\n    @gold = gold\n    @inventory = inventory\n  end\n\n  def inventory\n    @inventory = []\n  end\n\n  def buy(item)\n    if @gold &gt;= item.price\n      @gold-=item.price\n      puts \"You hand over #{item.price} gold, and get the #{item.name}.\"\n      puts \"You have #{gold} gold left over.\"\n      @inventory.push([item.name,item.price,item.attack,item.defence])\n      puts \"ITEMS IN INV: #{@inventory}\" # output: ITEMS IN INV: [[\"Dagger\", 4, 1, 0], [\"Mucky Tunic\", 2, 0, 2]]\n    else\n      puts \"You can't afford this item.\"\n    end\n  end\nend\n\n player = Player.new(10,1,2,6)\n puts player.inventory.inspect # output: []\n</code></pre>\n\n<p>The <code>inventory.push</code> line pushes the element to the array while it is inside the method, but when returned outside the method, the <code>inventory</code> array is empty. This is confusing because other variables that were changed inside that method in the same way come back as altered.</p>\n\n<p>sample output when printed from inside the buy method:</p>\n\n<pre><code>ITEMS IN INV: [[\"Dagger\", 4, 1, 0], [\"Mucky Tunic\", 2, 0, 2]]\n</code></pre>\n\n<p>output with <code>player.inventory.inspect</code> outside of the method:</p>\n\n<pre><code>[]\n</code></pre>\n"}, {"tags": ["ruby", "ruby-on-rails-4", "chartkick"], "comments": [{"owner": {"reputation": 4930, "user_id": 5276188, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/N2sAW.jpg?s=128&g=1", "display_name": "Doktor OSwaldo", "link": "https://stackoverflow.com/users/5276188/doktor-oswaldo"}, "edited": false, "score": 1, "creation_date": 1521552703, "post_id": 49378434, "comment_id": 85772036, "body": "that&#39;s not how a column chart works, values with the same key must be grouped or you have to use multiple series. However your case seems to make no senss to be put in a chart..."}, {"owner": {"reputation": 1, "user_id": 9454690, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Tansa Trisna", "link": "https://stackoverflow.com/users/9454690/tansa-trisna"}, "reply_to_user": {"reputation": 4930, "user_id": 5276188, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/N2sAW.jpg?s=128&g=1", "display_name": "Doktor OSwaldo", "link": "https://stackoverflow.com/users/5276188/doktor-oswaldo"}, "edited": false, "score": 0, "creation_date": 1521600502, "post_id": 49378434, "comment_id": 85796404, "body": "I see, thanks for your help @DoktorOSwaldo"}], "owner": {"reputation": 1, "user_id": 9454690, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Tansa Trisna", "link": "https://stackoverflow.com/users/9454690/tansa-trisna"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 128, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1521536478, "creation_date": 1521530593, "last_edit_date": 1592644375, "question_id": 49378434, "link": "https://stackoverflow.com/questions/49378434/how-can-i-show-all-data-records-on-chartkick-without-any-distinct", "title": "How can I show all data records on Chartkick without any distinct?", "body": "<p>I'm trying to visualize my data using Chartkick. Here is my data:</p>\n<pre><code>data = [[&quot;A1&quot;, 62979], [&quot;A1&quot;, -47419], [&quot;A1&quot;, 15560],[&quot;S1&quot;, 0],[&quot;S1&quot;, 0],[&quot;S1&quot;, 0],[&quot;S1&quot;, 0],[&quot;S1&quot;, 0],[&quot;S1&quot;, 0],[&quot;A1&quot;, 0],[&quot;A1&quot;, 0],[&quot;A1&quot;, 0],[&quot;A1&quot;, 0],[&quot;A1&quot;, 0],[&quot;A1&quot;, 0],[&quot;A1&quot;, 0],[&quot;A1&quot;, 0],[&quot;A1&quot;, 0],[&quot;L1&quot;, 0],[&quot;L1&quot;, 41697],[&quot;L1&quot;, 41697]]\n</code></pre>\n<p>and when I tried to print it on my chart using this code:</p>\n<pre><code>column_chart data\n</code></pre>\n<p>I got this output:</p>\n<p><img src=\"https://i.stack.imgur.com/RmUuj.png\" alt=\"this\" /></p>\n<p>I just got the distinct record. All I want is, the chart should print A1 with the value 62979, A1 with the value -47419, other A1 with the value 15560, S1 with the value 0, other S1 with the value 0 and so on. So, my question is, how can I print all records of my data into chart without any distinct value on X axis?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "mongodb", "ruby-on-rails-4", "mongoid"], "comments": [{"owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 0, "creation_date": 1521529439, "post_id": 49378100, "comment_id": 85756838, "body": "What is your question or problem? Does your code raise an error? What is the message? How do you use your code, how do you create a store and its assets?"}, {"owner": {"reputation": 79, "user_id": 4969098, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f0683986b2d13b213a06bfa773ecb269?s=128&d=identicon&r=PG&f=1", "display_name": "Bnaya Zil", "link": "https://stackoverflow.com/users/4969098/bnaya-zil"}, "reply_to_user": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 0, "creation_date": 1521535279, "post_id": 49378100, "comment_id": 85759772, "body": "I edited the question: &quot;The logger print <code>nil</code>, the question is how can I get the related store document?&quot;"}, {"owner": {"reputation": 4644, "user_id": 2594185, "user_type": "registered", "profile_image": "https://graph.facebook.com/100003773788931/picture?type=large", "display_name": "Jagdeep Singh", "link": "https://stackoverflow.com/users/2594185/jagdeep-singh"}, "edited": false, "score": 0, "creation_date": 1521629647, "post_id": 49378100, "comment_id": 85809734, "body": "Show the statements you execute."}], "owner": {"reputation": 79, "user_id": 4969098, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f0683986b2d13b213a06bfa773ecb269?s=128&d=identicon&r=PG&f=1", "display_name": "Bnaya Zil", "link": "https://stackoverflow.com/users/4969098/bnaya-zil"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 40, "favorite_count": 1, "answer_count": 0, "score": 1, "last_activity_date": 1521535256, "creation_date": 1521529327, "last_edit_date": 1521535256, "question_id": 49378100, "link": "https://stackoverflow.com/questions/49378100/rails-4-mongoid-getting-relation-document-id-from-after-initialize-callb", "title": "Rails 4 (Mongoid): Getting relation document `_id` from `after_initialize` callback of embedded document", "body": "<p>I have two models, parent (store) and child (asset), I need to get the store <code>_id</code> from <code>after_initialize</code> callback of embedded asset.</p>\n\n<pre><code>class Store\n  include Mongoid::Document\n  embeds_many :assets\nend\n\n\nclass Asset\n  include Mongoid::Document\n  embedded_in :store\n\n  after_initialize :get_store_id\n\n  def get_store_id\n    logger.info self.store\n  end\nend\n</code></pre>\n\n<p><strong>EDIT:</strong></p>\n\n<p>The logger print <code>nil</code>, the question is how can I get the related store document?</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 0, "creation_date": 1521529556, "post_id": 49377894, "comment_id": 85756883, "body": "Did you consider moving the complex condition into a method on its own? Btw. Rubocop is not only complaining about the number of lines, if you just write it in one line it will complain about the line length or the complexity."}, {"owner": {"reputation": 1513, "user_id": 5746504, "user_type": "registered", "accept_rate": 91, "profile_image": "https://lh6.googleusercontent.com/-4c57-sWfrFM/AAAAAAAAAAI/AAAAAAAACog/XNKIq-S6CDg/photo.jpg?sz=128", "display_name": "Moamen Naanou", "link": "https://stackoverflow.com/users/5746504/moamen-naanou"}, "reply_to_user": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 0, "creation_date": 1521529745, "post_id": 49377894, "comment_id": 85756971, "body": "@spickermann sure, currently I moved it to different method, I&#39;m just checking if there is some way to define &amp; use the hash at same time."}, {"owner": {"reputation": 1513, "user_id": 5746504, "user_type": "registered", "accept_rate": 91, "profile_image": "https://lh6.googleusercontent.com/-4c57-sWfrFM/AAAAAAAAAAI/AAAAAAAACog/XNKIq-S6CDg/photo.jpg?sz=128", "display_name": "Moamen Naanou", "link": "https://stackoverflow.com/users/5746504/moamen-naanou"}, "reply_to_user": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 0, "creation_date": 1521530295, "post_id": 49377894, "comment_id": 85757256, "body": "@spickermann, I don&#39;t have issue with line length, I updated my question, what I&#39;m trying to mention that is to get value of <code>param_a</code>, I need to do some db calls, which I need to avoid repeating while defining <code>param_c</code>"}], "answers": [{"tags": [], "owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "is_accepted": true, "score": 1, "last_activity_date": 1521533665, "creation_date": 1521533665, "answer_id": 49379215, "question_id": 49377894, "link": "https://stackoverflow.com/questions/49377894/inline-hash-assignment-and-usage/49379215#49379215", "title": "Inline hash assignment and usage", "body": "<p>When you have a line like this</p>\n\n<pre><code>variable = { a: 1, b: variable[:a] }\n</code></pre>\n\n<p>then the right side of the assignment is evaluated first - that means the hash is defined first. Then in a second step, the defined hash is assigned to the variable on the left. Therefore the <code>variable[:a]</code> reference in the hash definition must fail, because the hash hasn't been assigned to the <code>variable</code> at that point in time.</p>\n\n<p>In your example, I would extract the condition for <code>params_a</code> into a method on its own and - if the evaluation is expensive - memorize its result:</p>\n\n<pre><code>def do_staff\n  {\n    param_a: a_condition,\n    param_b: 100,\n    param_c: (a_condition ? 'good' : 'bad')\n  }\nend\n\nprivate\n\ndef a_condition\n  # note we cannot use `||=` here because the result \n  # of the condition might be `nil` or `false`\n  @a_condition = condition1 &amp;&amp; condition2 unless defined?(@a_condition)\nend\n</code></pre>\n\n<p>Or you could do the evaluation in the <code>do_staff</code> method once:</p>\n\n<pre><code>def do_staff\n  a_condition = condition1 &amp;&amp; condition2\n\n  {\n    param_a: a_condition,\n    param_b: 100,\n    param_c: (a_condition ? 'good' : 'bad')\n  }\nend\n</code></pre>\n\n<p>Furthermore, I would suggest moving the <code>a_condition ? 'good' : 'bad'</code> part into a method on its own too - just to increase readability. But that refactoring depends on your dependencies and might not make much sense in the context of the sample code in your question.</p>\n"}], "owner": {"reputation": 1513, "user_id": 5746504, "user_type": "registered", "accept_rate": 91, "profile_image": "https://lh6.googleusercontent.com/-4c57-sWfrFM/AAAAAAAAAAI/AAAAAAAACog/XNKIq-S6CDg/photo.jpg?sz=128", "display_name": "Moamen Naanou", "link": "https://stackoverflow.com/users/5746504/moamen-naanou"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 55, "favorite_count": 0, "accepted_answer_id": 49379215, "answer_count": 1, "score": 0, "last_activity_date": 1521533665, "creation_date": 1521528619, "last_edit_date": 1521530144, "question_id": 49377894, "link": "https://stackoverflow.com/questions/49377894/inline-hash-assignment-and-usage", "title": "Inline hash assignment and usage", "body": "<p>I have the following method declaration:</p>\n\n<pre><code>  def do_staff\n    param_a = condition1 &amp;&amp; condition2\n    param_b = 100\n    param_c = param_a ? 'good' : 'bad'\n    # method logic implementation ....\n  end\n</code></pre>\n\n<p>After using <code>rubocop gem</code> to analyze my code, I found that <code>do_staff</code> has more than 10 lines of code, so I need to add the params definition to single hash such as:</p>\n\n<pre><code>args = { param_a: condition1 &amp;&amp; condition2, param_b: 100, param_c: args[:param_a] ? 'good' : 'bad' }\n</code></pre>\n\n<p>The <code>args</code> declaration will definitely throw <code>undefined method '[]' for nil:NilClass</code> because of <code>param_c</code>:</p>\n\n<pre><code>{ param_c: args[:param_a] ? 'good' : 'bad' }\n</code></pre>\n\n<p><strong>The Question is:</strong></p>\n\n<p>Is there any possibility in Ruby to implement such inline declaration where I can avoid repeating the logic of <code>param_a</code> definition while defining <code>param_c</code>?</p>\n"}, {"tags": ["ruby", "selenium", "selenium-webdriver", "selenium-chromedriver", "ui-automation"], "comments": [{"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 1, "creation_date": 1521537367, "post_id": 49377640, "comment_id": 85761118, "body": "Have you tried to use <code>send_keys</code> on an arbitrary element, e.g. <code>body</code>?"}], "owner": {"reputation": 31, "user_id": 9520862, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-vIre-W70c2k/AAAAAAAAAAI/AAAAAAAAEpM/Xhi8GjyPlqg/photo.jpg?sz=128", "display_name": "senthil vel", "link": "https://stackoverflow.com/users/9520862/senthil-vel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 103, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1521537446, "creation_date": 1521527490, "last_edit_date": 1521537446, "question_id": 49377640, "link": "https://stackoverflow.com/questions/49377640/how-to-send-key-combinationscontrolshiftt-using-selenium-with-ruby-on-mac", "title": "How to send key combinations(control+shift+T) using Selenium with Ruby on Mac?", "body": "<p>I need to send the following key combination (<kbd>control</kbd>+<kbd>shift</kbd>+<kbd>T</kbd>) using selenium on a Mac machine with Ruby. Someone suggest me a solution for this.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "url", "uri"], "answers": [{"comments": [{"owner": {"reputation": 288, "user_id": 5241456, "user_type": "registered", "accept_rate": 64, "profile_image": "https://lh3.googleusercontent.com/-dyuG5GGKgAc/AAAAAAAAAAI/AAAAAAAAAHw/r4oZO6Om9MA/photo.jpg?sz=128", "display_name": "Muhammad Rahmatullah", "link": "https://stackoverflow.com/users/5241456/muhammad-rahmatullah"}, "edited": false, "score": 1, "creation_date": 1521516562, "post_id": 49375821, "comment_id": 85752844, "body": "Hi, i really appreciate your help sir :). But may ask you, which one is better ?."}, {"owner": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "reply_to_user": {"reputation": 288, "user_id": 5241456, "user_type": "registered", "accept_rate": 64, "profile_image": "https://lh3.googleusercontent.com/-dyuG5GGKgAc/AAAAAAAAAAI/AAAAAAAAAHw/r4oZO6Om9MA/photo.jpg?sz=128", "display_name": "Muhammad Rahmatullah", "link": "https://stackoverflow.com/users/5241456/muhammad-rahmatullah"}, "edited": false, "score": 0, "creation_date": 1521516894, "post_id": 49375821, "comment_id": 85752927, "body": "Best practice is to use only what you need.  If you only need to operate on a string, use the last option.  If you need to do something else with a URI object, then use one."}, {"owner": {"reputation": 288, "user_id": 5241456, "user_type": "registered", "accept_rate": 64, "profile_image": "https://lh3.googleusercontent.com/-dyuG5GGKgAc/AAAAAAAAAAI/AAAAAAAAAHw/r4oZO6Om9MA/photo.jpg?sz=128", "display_name": "Muhammad Rahmatullah", "link": "https://stackoverflow.com/users/5241456/muhammad-rahmatullah"}, "edited": false, "score": 0, "creation_date": 1521517065, "post_id": 49375821, "comment_id": 85752966, "body": "and with my other question, can you help it too ? currently i&#39;ve tried this code  <code>File.dirname(uri) + &quot;&#47;&quot; + File.basename(Model.first.media, &#39;.mp4&#39;) + &quot;.m3u8&quot;</code>  To change recorded format file in my database, in example previously my file is <code>play&#47;media&#47;41&#47;my_video.mp4 </code>, then i want to change it to <code>.m3u8</code> so i&#39;m using above code"}, {"owner": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "reply_to_user": {"reputation": 288, "user_id": 5241456, "user_type": "registered", "accept_rate": 64, "profile_image": "https://lh3.googleusercontent.com/-dyuG5GGKgAc/AAAAAAAAAAI/AAAAAAAAAHw/r4oZO6Om9MA/photo.jpg?sz=128", "display_name": "Muhammad Rahmatullah", "link": "https://stackoverflow.com/users/5241456/muhammad-rahmatullah"}, "edited": false, "score": 0, "creation_date": 1521517424, "post_id": 49375821, "comment_id": 85753053, "body": "if you just want to change the extension name, again, just use basic string methods:  <code>&quot;play&#47;media&#47;41&#47;my_video.mp4&quot;.gsub(&#39;.mp4&#39;, &#39;.m3u8&#39;)</code> but that assumes <code>.mp4</code> will only be the extension and not anywhere else in the string.  Should be fine if the filenames use normal conventions."}, {"owner": {"reputation": 288, "user_id": 5241456, "user_type": "registered", "accept_rate": 64, "profile_image": "https://lh3.googleusercontent.com/-dyuG5GGKgAc/AAAAAAAAAAI/AAAAAAAAAHw/r4oZO6Om9MA/photo.jpg?sz=128", "display_name": "Muhammad Rahmatullah", "link": "https://stackoverflow.com/users/5241456/muhammad-rahmatullah"}, "edited": false, "score": 0, "creation_date": 1521518165, "post_id": 49375821, "comment_id": 85753201, "body": "Thanks a lot sir, it&#39;s really help me :) . but can i ask one more question. How to get url without filename extension, primary domain and &#39;/&#39; as first char.  url = <a href=\"https://my-bucket.s3.amazonaws.com/model/media/41/cdbb21cc-1c59-4aa3-92ec-917e7237a850.mp4\" rel=\"nofollow noreferrer\">my-bucket.s3.amazonaws.com/model/media/41/&hellip;</a>  expected_url = <code>model&#47;media&#47;41&#47;cdbb21cc-1c59-4aa3-92ec-917e7237a850</code>  currently i&#39;m using this one <code>File.dirname(uri) + &quot;&#47;&quot; + File.basename(Model.first.media, &#39;.mp4&#39;)</code> to get expected_url"}], "tags": [], "owner": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "is_accepted": true, "score": 1, "last_activity_date": 1521518403, "last_edit_date": 1521518403, "creation_date": 1521515891, "answer_id": 49375821, "question_id": 49375672, "link": "https://stackoverflow.com/questions/49375672/ruby-rails-get-url-extension-with-uri/49375821#49375821", "title": "Ruby/Rails : Get url extension with URI", "body": "<p>URI class helps break apart URLs into components and gives you methods like</p>\n\n<pre><code>[:scheme, :userinfo, :host, :port, :path, :query, :fragment]\n</code></pre>\n\n<p>If you simply need to get rid of the first slash it's simple as this with no regex.</p>\n\n<pre><code>uri.path[1..-1] #gives all string characters except the 0 index.\n</code></pre>\n\n<p>But you could probably even get away with:</p>\n\n<pre><code>Model.first.media.split('.com/').last # don't even need URI parse.\n</code></pre>\n\n<p>For last part of your question you can do:</p>\n\n<pre><code>File.dirname(uri.path) # will return =&gt; \"/model/media/41\"\n\nFile.dirname(uri.path)[1..-1] # if you want to remove leading /\n</code></pre>\n"}], "owner": {"reputation": 288, "user_id": 5241456, "user_type": "registered", "accept_rate": 64, "profile_image": "https://lh3.googleusercontent.com/-dyuG5GGKgAc/AAAAAAAAAAI/AAAAAAAAAHw/r4oZO6Om9MA/photo.jpg?sz=128", "display_name": "Muhammad Rahmatullah", "link": "https://stackoverflow.com/users/5241456/muhammad-rahmatullah"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 656, "favorite_count": 0, "accepted_answer_id": 49375821, "answer_count": 1, "score": 1, "last_activity_date": 1521518403, "creation_date": 1521514512, "last_edit_date": 1521514983, "question_id": 49375672, "link": "https://stackoverflow.com/questions/49375672/ruby-rails-get-url-extension-with-uri", "title": "Ruby/Rails : Get url extension with URI", "body": "<p>currently i'm have a bit problem to parse URL using URI</p>\n\n<p>i've tried to use this code :</p>\n\n<pre><code>uri = URI::parse(Model.first.media)\n#&lt;URI::HTTPS https://my-bucket.s3.amazonaws.com/model/media/41/cdbb21cc-1c59-4aa3-92ec-917e7237a850.mp4&gt;\n\nuri.path\n\"/model/media/41/cdbb21cc-1c59-4aa3-92ec-917e7237a850.mp4\"\n\nFile.basename(Model.first.media, '.mp4')\n\"cdbb21cc-1c59-4aa3-92ec-917e7237a850.mp4\"\n</code></pre>\n\n<p>but i'm still confused to get <code>path</code> without <code>/</code> as first char in example <code>model/media/41/cdbb21cc-1c59-4aa3-92ec-917e7237a850.mp4</code> and get only the path without domain and the file in example <code>model/media/41</code></p>\n\n<p>do i must using regex to get above output ? or URI can handle this ?</p>\n\n<p>note: </p>\n\n<p>i've found how to get url extension without first char based on this question <a href=\"https://stackoverflow.com/questions/5129574/ruby-regexp-capture-the-path-of-url\">Ruby regexp: capture the path of url</a></p>\n"}, {"tags": ["ruby", "graphql", "graphql-ruby"], "comments": [{"owner": {"reputation": 51013, "user_id": 976775, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/30bd66ad1795804aebe249d8bcb14409?s=128&d=identicon&r=PG", "display_name": "MrYoshiji", "link": "https://stackoverflow.com/users/976775/mryoshiji"}, "edited": false, "score": 0, "creation_date": 1521554294, "post_id": 49375061, "comment_id": 85773379, "body": "Why are you using a &quot;proxy GraphQL API&quot; to another API (REST)? Why not directly use the REST API? Doing 2 http requests increases the chances of timeouts &amp; other HTTP errors times 2, literally. Can you have eventually a &quot;crawler&quot; to cache the data in your app and then GraphQL would query that cache instead?"}, {"owner": {"reputation": 3995, "user_id": 2037537, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/f13d953be3af2552aaa1ddfa0a05fa46?s=128&d=identicon&r=PG", "display_name": "Roland Studer", "link": "https://stackoverflow.com/users/2037537/roland-studer"}, "edited": false, "score": 0, "creation_date": 1526848091, "post_id": 49375061, "comment_id": 87892232, "body": "Hey. If I am not interested in any information on the cars, I would want to filter inquiries directly with an argument <code>inquiries (brand: &quot;ford&quot;) { ... }</code>, or not? Think first, what you want your API to be, don&#39;t force the consumer of the API to always start at only a few types."}], "owner": {"reputation": 11, "user_id": 9519823, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e13f4430b5591e4d8f281e95dae22857?s=128&d=identicon&r=PG&f=1", "display_name": "nuka", "link": "https://stackoverflow.com/users/9519823/nuka"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 220, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1521509809, "creation_date": 1521509809, "question_id": 49375061, "link": "https://stackoverflow.com/questions/49375061/properly-structuring-a-graphql-api-that-wraps-different-rest-endpoints", "title": "Properly structuring a GraphQL API that wraps different REST endpoints", "body": "<p>this is my first post on stackoverflow (Long time reader). I mainly come from a Python background and am fairly new to Ruby. I'm wondering on what's the recommended way to structure a Ruby GraphQL API like the following. Each one of the keys has a resolver that requests a different websites API to fetch the related data. These are currently nested under cars in the following way (I removed the actual http sources they are hitting since you need api keys):</p>\n\n<pre class=\"lang-ruby prettyprint-override\"><code>Types::CarsType = GraphQL::ObjectType.define do\n  name \"Cars\"\n\n  field :count, types.ID\n  field :contact, types.String\n\n  field :prices do\n    type Types::PricesType\n    resolve -&gt;(obj, args, ctx) {\n       HTTParty.get('http://example.com').parsed_response.fetch('some_key').map { |data| OpenStruct.new(data) }\n    }\n  end\n\n  field :inquiries do\n    type Types::InquiriesType\n    resolve -&gt;(obj, args, ctx) {\n       HTTParty.get('http://example1.com').parsed_response.fetch('some_key').map { |data| OpenStruct.new(data) }\n    }\n  end\nend\n</code></pre>\n\n<p>\n</p>\n\n<pre><code>Types::InquiriesType = GraphQL::ObjectType.define do\n  name \"Inquiries\"\n  field :name, types.String\n  field :phone, types.String\nend\n</code></pre>\n\n\n\n<pre class=\"lang-ruby prettyprint-override\"><code>Types::PricesType = GraphQL::ObjectType.define do\n  name \"Prices\"\n  field :max, types.String\n  field :min, types.String\n  field :suggested, types.String\nend\n</code></pre>\n\n\n\n<pre class=\"lang-ruby prettyprint-override\"><code>Types::QueryType = GraphQL::ObjectType.define do\n  name 'Query'\n\n  field :cars, types.String do\n    type Types::CarsType\n\n    argument :brand, !types[types.String]\n\n    resolve -&gt;(obj, args, ctx) {\n       HTTParty.get('http://example2.com').parsed_response.fetch('some_key').map { |data| OpenStruct.new(data) }\n    }\n  end\nend\n</code></pre>\n\n\n\n<p>An example query:</p>\n\n<pre class=\"lang-html prettyprint-override\"><code>query {\n  cars(brand: \"ford\") {\n    count\n    contact\n\n    prices {\n      max\n      min\n      suggested\n    }\n\n    inquiries {\n      name\n      phone\n    }\n  }\n}\n</code></pre>\n\n\n\n<p>This works fine but I feel like the approach isn't using GraphQL to the fullest. Some immediate problems when I look at it is that If you were to make a query like so, it would now make two API requests when only one is needed (the customer is not requesting any fields on <code>cars</code>, just inquiries). Inquiries is an attribute of cars, so I think it makes sense to be nested under <code>cars</code>? </p>\n\n<pre class=\"lang-html prettyprint-override\"><code>query {\n  cars(brand: \"ford\") {\n    inquiries {\n      name\n      phone\n    }\n  }\n}\n</code></pre>\n\n\n\n<p>I've looked into connections, but I'm not sure if this is the correct use case for them. Is someone with experience in designing solid GraphQL APIs able to weigh in? Should I be trying to leverage unions or interfaces somehow? Thank you so much.</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1521534738, "post_id": 49374978, "comment_id": 85759442, "body": "Try <code>Tumble.new.xyz</code>"}], "answers": [{"comments": [{"owner": {"reputation": 171, "user_id": 9505619, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IMliU.jpg?s=128&g=1", "display_name": "Patrick C", "link": "https://stackoverflow.com/users/9505619/patrick-c"}, "edited": false, "score": 0, "creation_date": 1521511782, "post_id": 49375114, "comment_id": 85751694, "body": "I tried this and no luck, still undefined. What actually DID work is I put all the code from the Tinder module into config/intializers/tumble.rb and renamed it from &quot;module Tinder&quot; to &quot;class Tumble&quot; and everything works as expected. Ugly hack, I&#39;d like to do it the proper way if possible."}, {"owner": {"reputation": 208794, "user_id": 229044, "user_type": "moderator", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/591426cbbacd4025d920467bad356911?s=128&d=identicon&r=PG&f=1", "display_name": "meagar", "link": "https://stackoverflow.com/users/229044/meagar"}, "reply_to_user": {"reputation": 171, "user_id": 9505619, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IMliU.jpg?s=128&g=1", "display_name": "Patrick C", "link": "https://stackoverflow.com/users/9505619/patrick-c"}, "edited": false, "score": 1, "creation_date": 1521513194, "post_id": 49375114, "comment_id": 85752046, "body": "@PatrickC The proper way is described in this answer, either use <code>include</code> and <code>Tumble.new.foo</code>, or use <code>extend</code> and <code>Tumble.foo</code>. If this isn&#39;t working for you, the problem is elsewhere in your code."}], "tags": [], "owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "is_accepted": false, "score": 2, "last_activity_date": 1521510233, "creation_date": 1521510233, "answer_id": 49375114, "question_id": 49374978, "link": "https://stackoverflow.com/questions/49374978/how-to-monkey-patch-a-class-in-rails/49375114#49375114", "title": "How to monkey-patch a class in Rails", "body": "<p>When you call <code>Tumble.foo</code> that's calling <code>foo</code> as if it were a class method.</p>\n\n<p>Yet when you do <code>Tumble.include Tinder</code> that adds the module's instance methods <em>as instance methods of Tumble</em>. </p>\n\n<p>So, your current code should work if you do <code>Tumble.new.foo</code>.</p>\n\n<p>You can also make <code>Tumble.foo</code> work with <code>Tumble.extend Tinder</code>. </p>\n"}, {"tags": [], "owner": {"reputation": 166, "user_id": 9405451, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63e8346fbd71e0bb896aa99f0996801f?s=128&d=identicon&r=PG&f=1", "display_name": "JollyProgrammer", "link": "https://stackoverflow.com/users/9405451/jollyprogrammer"}, "is_accepted": false, "score": 0, "last_activity_date": 1521534596, "creation_date": 1521534596, "answer_id": 49379447, "question_id": 49374978, "link": "https://stackoverflow.com/questions/49374978/how-to-monkey-patch-a-class-in-rails/49379447#49379447", "title": "How to monkey-patch a class in Rails", "body": "<pre><code>class Tinder\n def initialize\n  # some code here\n end\nend\n</code></pre>\n\n<p>Imagine that this above was the class that you wanted to monkey-patch. To monkey-patch it you only need to write (on any place that gets loaded) the class Tinder again with the code to be added like this:</p>\n\n<pre><code>class Tinder\n def some_more_code\n  # does great stuff\n end\nend\n</code></pre>\n\n<p>This is monkey-patch. Modules won't do monkey-patch. They extend functionality but in a different way.</p>\n\n<p>Just be aware not to override any methods of the original class that you want to monkey-patch, unless, of course, if that is your goal.</p>\n"}], "owner": {"reputation": 171, "user_id": 9505619, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IMliU.jpg?s=128&g=1", "display_name": "Patrick C", "link": "https://stackoverflow.com/users/9505619/patrick-c"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1107, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1521534596, "creation_date": 1521509136, "question_id": 49374978, "link": "https://stackoverflow.com/questions/49374978/how-to-monkey-patch-a-class-in-rails", "title": "How to monkey-patch a class in Rails", "body": "<p>I'm trying to monkey-patch the class \"Tumble\" with the module \"Tinder\". But when I add methods to the class, they aren't inherited. Constants, however, are.</p>\n\n<p>lib/tumble.rb:</p>\n\n<pre><code>class Tumble\n  ...\n</code></pre>\n\n<p>lib/tumble/tinder.rb</p>\n\n<pre><code>module Tinder\n  APP_ID = 1234567890\n\n  # Without self\n  def xyz\n    puts 'bar'\n  end\n</code></pre>\n\n<p>config/initializers/tumble.rb</p>\n\n<pre><code>Tumble.include Tinder\n</code></pre>\n\n<p>The app loads Tumble and Tinder and I can access APP_ID:</p>\n\n<pre><code>$ rails r 'puts Tumble::APP_ID'\n1234567890\n</code></pre>\n\n<p>But Tumble didn't inherit the methods:</p>\n\n<pre><code>[~/tinder]$ rails r 'puts Tumble.foo'\nPlease specify a valid ruby command or the path of a script to run.\nRun 'bin/rails runner -h' for help.\n\nundefined method `foo' for Tumble:Class\n[~/tinder]$ rails r 'puts Tumble.xyz'\nPlease specify a valid ruby command or the path of a script to run.\nRun 'bin/rails runner -h' for help.\n\nundefined method `xyz' for Tumble:Class\n</code></pre>\n\n<p>How do I patch Tumble to include these methods from Tinder?</p>\n\n<p>Thanks :)</p>\n"}, {"tags": ["javascript", "jquery", "html", "ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 35763, "user_id": 183181, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/f6642797870d2dd20e4a5c8df347562c?s=128&d=identicon&r=PG", "display_name": "vol7ron", "link": "https://stackoverflow.com/users/183181/vol7ron"}, "edited": false, "score": 0, "creation_date": 1521514998, "post_id": 49374628, "comment_id": 85752514, "body": "If you don&#39;t need to do this dynamically after the page loads, stick to doing it in Ruby"}], "answers": [{"tags": [], "owner": {"reputation": 26120, "user_id": 219883, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/c35b5b0f9e7cce48864f4f1545ead995?s=128&d=identicon&r=PG", "display_name": "Taryn East", "link": "https://stackoverflow.com/users/219883/taryn-east"}, "is_accepted": false, "score": 0, "last_activity_date": 1521514772, "creation_date": 1521514772, "answer_id": 49375696, "question_id": 49374628, "link": "https://stackoverflow.com/questions/49374628/javascript-merging-common-table-rows-that-have-ruby-code/49375696#49375696", "title": "Javascript: Merging common table rows that have ruby code?", "body": "<p><code>checked= !f.paid?</code> this isn't right... should be <code>checked: !f.paid?</code>. </p>\n\n<p>Likewise: <code>id=\"paidrow\"</code> and <code>id=\"price\"</code> etc</p>\n\n<p>In html, ids must be unique. If you have the same thing in multiple rows, that will break the html standard.</p>\n\n<p>Try using <code>class</code> instead of <code>id</code> to match multiple similar things, and use something to uniquify the ids eg:</p>\n\n<pre><code>class=\"paidrow\" id=\"paid_row_&lt;%= f.id %&gt;\"\n</code></pre>\n"}], "owner": {"reputation": 85, "user_id": 6948863, "user_type": "registered", "accept_rate": 30, "profile_image": "https://i.stack.imgur.com/8sWjA.jpg?s=128&g=1", "display_name": "thepersonwho", "link": "https://stackoverflow.com/users/6948863/thepersonwho"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 46, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1521514772, "creation_date": 1521506227, "question_id": 49374628, "link": "https://stackoverflow.com/questions/49374628/javascript-merging-common-table-rows-that-have-ruby-code", "title": "Javascript: Merging common table rows that have ruby code?", "body": "<p>New to Javascript, I'm trying to make a function that will merge rows when they have the same value (in this case, the year (#pin)) and add their numbers(#price). My code doesn't work but it doesn't seem to cause any errors in my web page.</p>\n\n<p>Table row html.erb:</p>\n\n<pre><code>&lt;tr class=\"&lt;%= payment_paid(f.paid)%&gt;\" id=\"paidrow\"&gt;\n     &lt;td&gt;\n       &lt;% if !f.paid %&gt;\n       &lt;%= check_box_tag \"pin_number[]\", f.id, checked= !f.paid? %&gt;\n       &lt;%end%&gt;\n     &lt;/td&gt;\n\n     &lt;td id=\"pin\"&gt;&lt;%= f.year %&gt;&lt;/td&gt;\n     &lt;td&gt;&lt;%= f.quarter %&gt;&lt;/td&gt;\n     &lt;td align=\"right\" id=\"price\"&gt;&lt;%= number_to_currency(f.amount, unit: \"\", \n     precision: 2)%&gt;&lt;/td&gt;\n  &lt;/tr&gt;\n</code></pre>\n\n<p>Javascript:</p>\n\n<pre><code>$(\"#paidrow\").each(function() {\n      var thisId = $(this).find('#pin').text();\n      var sumVal = parseFloat($(this).find('#price').text());\n\n      var $rowsToGroup = $(this).nextAll('tr').filter(function() {\n        return $(this).find('#pin').text() === thisId;\n      });\n\n      $rowsToGroup.each(function() {\n        sumVal += parseFloat($(this).find('#price').text());\n        $(this).remove();\n      });\n\n      $(this).find('#price').text(sumVal);\n    });\n</code></pre>\n\n<p>Code above was taken from the answer posted here: </p>\n\n<p><a href=\"https://stackoverflow.com/questions/38008224/how-to-combine-morethan-2-duplicate-rows-and-sum-the-value-in-html-table-using-j\">how to combine morethan 2 duplicate rows and sum the value in html table using jquery</a></p>\n"}, {"tags": ["ruby", "string", "text", "scripting"], "comments": [{"owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 1, "creation_date": 1521502115, "post_id": 49373996, "comment_id": 85749291, "body": "not sure it&#39;s the best way, but you can just call it with backticks and interpolation"}, {"owner": {"reputation": 1203, "user_id": 1401483, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/JwPtH.jpg?s=128&g=1", "display_name": "sethfri", "link": "https://stackoverflow.com/users/1401483/sethfri"}, "reply_to_user": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 0, "creation_date": 1521523684, "post_id": 49373996, "comment_id": 85754504, "body": "@maxpleaner nice! super new to Ruby and didn&#39;t know this was possible. Feel free to write up an answer and I&#39;ll accept"}], "answers": [{"tags": [], "owner": {"reputation": 11741, "user_id": 1934428, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/072774c5d4204a1c2385560e6114a887?s=128&d=identicon&r=PG", "display_name": "user1934428", "link": "https://stackoverflow.com/users/1934428/user1934428"}, "is_accepted": false, "score": 0, "last_activity_date": 1521526562, "creation_date": 1521526562, "answer_id": 49377430, "question_id": 49373996, "link": "https://stackoverflow.com/questions/49373996/ruby-in-place-edit-inside-ruby-script/49377430#49377430", "title": "Ruby In-Place Edit Inside Ruby Script", "body": "<p>There is no \"real\" in-place edit, even in the example you gave; it just looks like one. In fact, Ruby reads one file, writes the modified one, and renames them. That's why you get a bak file.</p>\n\n<p>If the file fits into your memory, you could read the whole file into a Ruby variable, perform the replacement on the string, and then write the string out to a file of the same name. Technically speaking, it is not really \"in place editing\" either, but comes very close to what you are looking for.</p>\n"}], "owner": {"reputation": 1203, "user_id": 1401483, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/JwPtH.jpg?s=128&g=1", "display_name": "sethfri", "link": "https://stackoverflow.com/users/1401483/sethfri"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 155, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1521526562, "creation_date": 1521501965, "question_id": 49373996, "link": "https://stackoverflow.com/questions/49373996/ruby-in-place-edit-inside-ruby-script", "title": "Ruby In-Place Edit Inside Ruby Script", "body": "<p>I'm writing a script where one of the pieces of work I need to perform is to replace every instance of a string in a file with an empty string, before going on to do some other work. I'd prefer to edit in place instead of reading in the whole file, doing a gsub, and writing it back out. </p>\n\n<p>I know I can do this on the command line:</p>\n\n<pre><code>ruby -pi.bak -e \"gsub(/MyText/, '')\" INSERT_FILE_NAME\n</code></pre>\n\n<p>But since I need to perform some other scripting operations after this, how can I perform this operation from inside a Ruby script? </p>\n"}]