[{"tags": ["ruby"], "comments": [{"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 0, "creation_date": 1567639906, "post_id": 57796374, "comment_id": 102026389, "body": "What encoding is the file in? What encoding are you reading it as? Are the two the same?"}], "answers": [{"comments": [{"owner": {"reputation": 419, "user_id": 10242281, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ff314354a9784604814f64f822c1589e?s=128&d=identicon&r=PG&f=1", "display_name": "Mich28 ", "link": "https://stackoverflow.com/users/10242281/mich28"}, "edited": false, "score": 0, "creation_date": 1567640998, "post_id": 57796562, "comment_id": 102026565, "body": "Thanks TadM and J,  tried but got error, let me try find right encoding.  file travelled from some old TFS/ SQL Server. Is there any way to convert it in single shot."}, {"owner": {"reputation": 419, "user_id": 10242281, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ff314354a9784604814f64f822c1589e?s=128&d=identicon&r=PG&f=1", "display_name": "Mich28 ", "link": "https://stackoverflow.com/users/10242281/mich28"}, "edited": false, "score": 1, "creation_date": 1567641729, "post_id": 57796562, "comment_id": 102026707, "body": "Tx again, at least I learned what problem is , I have more then 1 bad encodings, so need come up with logic find them first and try to do <code>str.force_encoding(\u201cSHIFT-JIS\u201d).encode!</code> ..something."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "reply_to_user": {"reputation": 419, "user_id": 10242281, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ff314354a9784604814f64f822c1589e?s=128&d=identicon&r=PG&f=1", "display_name": "Mich28 ", "link": "https://stackoverflow.com/users/10242281/mich28"}, "edited": false, "score": 1, "creation_date": 1567643066, "post_id": 57796562, "comment_id": 102026941, "body": "Sounds like you&#39;ve got multiple layers of encoding issues. Hope you can sort through it. This is why it&#39;s strongly encouraged to use UTF-8 as often as you can, it&#39;s much less irritating than having to force-switch codepages."}, {"owner": {"reputation": 419, "user_id": 10242281, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ff314354a9784604814f64f822c1589e?s=128&d=identicon&r=PG&f=1", "display_name": "Mich28 ", "link": "https://stackoverflow.com/users/10242281/mich28"}, "edited": false, "score": 0, "creation_date": 1567644675, "post_id": 57796562, "comment_id": 102027233, "body": "Tx T, yes, I&#39;m looking into solution go thru all file system first and do save all into UTF, not sure if it&#39; s cb&#39;e done in Ruby, probably in some PShell.."}, {"owner": {"reputation": 419, "user_id": 10242281, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ff314354a9784604814f64f822c1589e?s=128&d=identicon&r=PG&f=1", "display_name": "Mich28 ", "link": "https://stackoverflow.com/users/10242281/mich28"}, "edited": false, "score": 1, "creation_date": 1567648678, "post_id": 57796562, "comment_id": 102027837, "body": "it was  IBM437 !!!,  I found perfect  solution by SR(c) like on <a href=\"https://gallery.technet.microsoft.com/scriptcenter/Convert-Files-To-UTF-8-5c58db5e\" rel=\"nofollow noreferrer\">gallery.technet.microsoft.com/scriptcenter/&hellip;</a>"}], "tags": [], "owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "is_accepted": true, "score": 2, "last_activity_date": 1567638496, "creation_date": 1567638496, "answer_id": 57796562, "question_id": 57796374, "link": "https://stackoverflow.com/questions/57796374/ruby-nul-chars-after-reading-simple-file/57796562#57796562", "title": "Ruby. NUL chars after reading simple file", "body": "<p>This file is probably in UTF-16 format. You'll need to read it in that way:</p>\n\n<pre><code>File.open(file_name, \"r:UTF-16LE\") do |f|\n  # ...\nend\n</code></pre>\n\n<p>That format is the default in Windows.</p>\n\n<p>You can always fix this by re-saving the file as UTF-8.</p>\n"}], "owner": {"reputation": 419, "user_id": 10242281, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ff314354a9784604814f64f822c1589e?s=128&d=identicon&r=PG&f=1", "display_name": "Mich28 ", "link": "https://stackoverflow.com/users/10242281/mich28"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 38, "favorite_count": 0, "accepted_answer_id": 57796562, "answer_count": 1, "score": 0, "last_activity_date": 1567638496, "creation_date": 1567636601, "question_id": 57796374, "link": "https://stackoverflow.com/questions/57796374/ruby-nul-chars-after-reading-simple-file", "title": "Ruby. NUL chars after reading simple file", "body": "<p>I'm reading simple text files using Ruby for further regex processing and suddenly I see that str <code>NUL</code> after each printable character. Totally lost, where it comes from, I tested typing simple text in  Notepad, saving as txt file and still getting those. I'm on W machine, didn't have this before.\nHow I can process it, probably replace them, not sure how to refer to them.\nMy regex doesn't work with them, tried several ways, using SciTE for run.\ne.g.  <code>use</code> presented as <code>uNULsNULeNUL</code> and not equal to <code>use</code></p>\n\n<pre><code>puts File.read(file_name)\nputs '____________________'\n\nFile.open(file_name, \"r\") do |f|\n  f.each_line do |line|\n    puts 'Line.....' + line\n  end\nend\n</code></pre>\n\n<p>---------------------- below pic on content of file and output:\n<a href=\"https://i.stack.imgur.com/i7vW1.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/i7vW1.jpg\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["ruby", "slack-api"], "comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 1, "creation_date": 1567635760, "post_id": 57796119, "comment_id": 102025585, "body": "You need to show some code for context. Show us what you tried."}, {"owner": {"reputation": 897, "user_id": 5255019, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-obI_W7jTY6M/AAAAAAAAAAI/AAAAAAAACLg/-ccFAzkxIq4/photo.jpg?sz=128", "display_name": "Brian", "link": "https://stackoverflow.com/users/5255019/brian"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1567653205, "post_id": 57796119, "comment_id": 102028564, "body": "@client.web_client.chat_postMessage(text: text.to_s, type: type, as_user: true, mrkdwn: false, channel: channel), with text = &#39;/botname do-something&#39;"}, {"owner": {"reputation": 897, "user_id": 5255019, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-obI_W7jTY6M/AAAAAAAAAAI/AAAAAAAACLg/-ccFAzkxIq4/photo.jpg?sz=128", "display_name": "Brian", "link": "https://stackoverflow.com/users/5255019/brian"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1567653336, "post_id": 57796119, "comment_id": 102028588, "body": "Writing text to the slack channel is not the issue. The issue is the other bot does not interpret what my bot writes."}, {"owner": {"reputation": 897, "user_id": 5255019, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-obI_W7jTY6M/AAAAAAAAAAI/AAAAAAAACLg/-ccFAzkxIq4/photo.jpg?sz=128", "display_name": "Brian", "link": "https://stackoverflow.com/users/5255019/brian"}, "reply_to_user": {"reputation": 23463, "user_id": 4379151, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kOLJQ.jpg?s=128&g=1", "display_name": "Erik Kalkoken", "link": "https://stackoverflow.com/users/4379151/erik-kalkoken"}, "edited": false, "score": 0, "creation_date": 1567701875, "post_id": 57796119, "comment_id": 102051147, "body": "Awesome @ErikKalkoken. Am guessing that is the fix, though I get a Slack::Web::Api::Errors::SlackError, &quot;not_allowed_token_type&quot; error when calling @client.web_client.chat_command(channel: &#39;#a-channel&#39;, command: &#39;/botname&#39;, text: &#39;do-something&#39;)."}, {"owner": {"reputation": 23463, "user_id": 4379151, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kOLJQ.jpg?s=128&g=1", "display_name": "Erik Kalkoken", "link": "https://stackoverflow.com/users/4379151/erik-kalkoken"}, "edited": false, "score": 0, "creation_date": 1567708009, "post_id": 57796119, "comment_id": 102053603, "body": "It only works with a legacy token."}, {"owner": {"reputation": 23463, "user_id": 4379151, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kOLJQ.jpg?s=128&g=1", "display_name": "Erik Kalkoken", "link": "https://stackoverflow.com/users/4379151/erik-kalkoken"}, "edited": false, "score": 0, "creation_date": 1567774697, "post_id": 57796119, "comment_id": 102075024, "body": "If you agree its a duplicate please click on close to confirm. Thanks"}, {"owner": {"reputation": 897, "user_id": 5255019, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-obI_W7jTY6M/AAAAAAAAAAI/AAAAAAAACLg/-ccFAzkxIq4/photo.jpg?sz=128", "display_name": "Brian", "link": "https://stackoverflow.com/users/5255019/brian"}, "reply_to_user": {"reputation": 23463, "user_id": 4379151, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kOLJQ.jpg?s=128&g=1", "display_name": "Erik Kalkoken", "link": "https://stackoverflow.com/users/4379151/erik-kalkoken"}, "edited": false, "score": 1, "creation_date": 1567804390, "post_id": 57796119, "comment_id": 102087287, "body": "Just verified using a legacy token does work. Thank you @ErikKalkoken!"}], "owner": {"reputation": 897, "user_id": 5255019, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-obI_W7jTY6M/AAAAAAAAAAI/AAAAAAAACLg/-ccFAzkxIq4/photo.jpg?sz=128", "display_name": "Brian", "link": "https://stackoverflow.com/users/5255019/brian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 48, "favorite_count": 0, "closed_date": 1567804348, "answer_count": 0, "score": 0, "last_activity_date": 1567634379, "creation_date": 1567634379, "question_id": 57796119, "link": "https://stackoverflow.com/questions/57796119/send-message-to-another-slack-bot", "closed_reason": "Duplicate", "title": "Send message to another slack bot", "body": "<p>As a user, you can request an action of a bot from the OS slack app or web page by typing something like <code>/botname do-something</code>.</p>\n\n<p>But the same message via chat_postMessage is ignored. Have tried <code>as_user</code> with both true and false, as well as <code>mrkdwn</code>.</p>\n\n<p>At a loss as to what to try next.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "metaprogramming", "ruby-on-rails-5.2"], "comments": [{"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 1, "creation_date": 1567636636, "post_id": 57796066, "comment_id": 102025787, "body": "I don&#39;t think their should be a &quot;metaprogramming&quot; tag."}], "answers": [{"comments": [{"owner": {"reputation": 4416, "user_id": 2012677, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/8d7cb2fe712fb17f44f8c354bf37e7b5?s=128&d=identicon&r=PG&f=1", "display_name": "user2012677", "link": "https://stackoverflow.com/users/2012677/user2012677"}, "edited": false, "score": 0, "creation_date": 1567634858, "post_id": 57796161, "comment_id": 102025401, "body": "The elegant option does not work because camelize does not operate the same way as the top version."}, {"owner": {"reputation": 21613, "user_id": 580346, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/ba17945a06aac247b06548d5afe341e8?s=128&d=identicon&r=PG", "display_name": "mrzasa", "link": "https://stackoverflow.com/users/580346/mrzasa"}, "reply_to_user": {"reputation": 4416, "user_id": 2012677, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/8d7cb2fe712fb17f44f8c354bf37e7b5?s=128&d=identicon&r=PG&f=1", "display_name": "user2012677", "link": "https://stackoverflow.com/users/2012677/user2012677"}, "edited": false, "score": 0, "creation_date": 1567667138, "post_id": 57796161, "comment_id": 102032408, "body": "thanks @user2012677 fixed that by moving it inside the interpolation"}], "tags": [], "owner": {"reputation": 21613, "user_id": 580346, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/ba17945a06aac247b06548d5afe341e8?s=128&d=identicon&r=PG", "display_name": "mrzasa", "link": "https://stackoverflow.com/users/580346/mrzasa"}, "is_accepted": true, "score": 3, "last_activity_date": 1567667059, "last_edit_date": 1567667059, "creation_date": 1567634624, "answer_id": 57796161, "question_id": 57796066, "link": "https://stackoverflow.com/questions/57796066/dynamically-create-an-escaped-constant-ruby-on-rails/57796161#57796161", "title": "Dynamically create an escaped constant (Ruby on Rails)", "body": "<p>In Ruby <code>+</code> has lower priority than method invocation <code>.</code>, so you first create a class with <code>\"#{type}\".singularize.camelize.constantize</code> and then you try to add this class to  a string <code>'::'</code> that fails.</p>\n\n<p>To fix it you can:</p>\n\n<pre><code>(\"::\"+\"#{type}\".singularize.camelize).constantize # ugly, but proves the point\n\"::#{type.singularize.camelize}\".constantize #elegant and working :)\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 4416, "user_id": 2012677, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/8d7cb2fe712fb17f44f8c354bf37e7b5?s=128&d=identicon&r=PG&f=1", "display_name": "user2012677", "link": "https://stackoverflow.com/users/2012677/user2012677"}, "edited": false, "score": 0, "creation_date": 1567649141, "post_id": 57796956, "comment_id": 102027918, "body": "&quot;::word&quot;.camelize = &quot;::word&quot;, where &quot;::&quot;+&#39;word&#39;.camelize = ::Word"}], "tags": [], "owner": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "is_accepted": false, "score": 0, "last_activity_date": 1567642401, "creation_date": 1567642401, "answer_id": 57796956, "question_id": 57796066, "link": "https://stackoverflow.com/questions/57796066/dynamically-create-an-escaped-constant-ruby-on-rails/57796956#57796956", "title": "Dynamically create an escaped constant (Ruby on Rails)", "body": "<p>You should not need to concatenate or use parens on the method chain</p>\n\n<pre><code>def make_constant type\n  \"::#{type}\".singularize.camelize.constantize\nend\n</code></pre>\n"}], "owner": {"reputation": 4416, "user_id": 2012677, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/8d7cb2fe712fb17f44f8c354bf37e7b5?s=128&d=identicon&r=PG&f=1", "display_name": "user2012677", "link": "https://stackoverflow.com/users/2012677/user2012677"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 51, "favorite_count": 0, "accepted_answer_id": 57796161, "answer_count": 2, "score": 3, "last_activity_date": 1567667059, "creation_date": 1567634047, "last_edit_date": 1567634657, "question_id": 57796066, "link": "https://stackoverflow.com/questions/57796066/dynamically-create-an-escaped-constant-ruby-on-rails", "title": "Dynamically create an escaped constant (Ruby on Rails)", "body": "<p>I need to dynamically create a constant that is escaped out of the current namespace, so I need the '::' in front of my constant.  However, when I try the below, I get the below error...</p>\n\n<pre><code>def make_constant(type)     \n  \"::\"+\"#{type}\".singularize.camelize.constantize\nend\n</code></pre>\n\n<p>When I try some thing like</p>\n\n<p><code>make_constant(\"MyModel\")</code> the result should be a constant of: </p>\n\n<pre><code>::MyModel\n</code></pre>\n\n<p>However, I get and error:</p>\n\n<blockquote>\n  <p>TypeError (no implicit conversion of Class into String)</p>\n</blockquote>\n"}, {"tags": ["ruby", "string", "comparison", "user-input"], "answers": [{"tags": [], "owner": {"reputation": 21613, "user_id": 580346, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/ba17945a06aac247b06548d5afe341e8?s=128&d=identicon&r=PG", "display_name": "mrzasa", "link": "https://stackoverflow.com/users/580346/mrzasa"}, "is_accepted": true, "score": 1, "last_activity_date": 1567631544, "creation_date": 1567631544, "answer_id": 57795700, "question_id": 57795566, "link": "https://stackoverflow.com/questions/57795566/why-is-user-input-in-ruby-different-from-a-given-string-already-inside-the-code/57795700#57795700", "title": "Why is user input in Ruby different from a given string already inside the code?", "body": "<p>When you call <code>gets</code> the newline that ends the input is stored in the variable:</p>\n\n<pre><code>pry(main)&gt; gets\nqwe\n# =&gt; \"qwe\\n\"\n</code></pre>\n\n<p>To remove it, use <a href=\"https://ruby-doc.org/core-2.6.4/String.html#method-i-chomp\" rel=\"nofollow noreferrer\"><code>String#chomp</code></a>. It removes a separator (by default a newline) from the end of the string:</p>\n\n<pre><code>pry(main)&gt; a = gets\nasd\n#=&gt; \"asd\\n\"\npry(main)&gt; a.chomp\n#=&gt; \"asd\"\n</code></pre>\n\n<p>And in your case:</p>\n\n<pre><code>def prompt(*args)\n    print(\"Enter a string: \")\n    coolstring = gets.chomp # &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt; here\n    return coolstring\nend\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 10856636, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c42c6d9e805465456d547b6fa6ba9b7?s=128&d=identicon&r=PG&f=1", "display_name": "Kamal S.", "link": "https://stackoverflow.com/users/10856636/kamal-s"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 47, "favorite_count": 0, "closed_date": 1567631691, "accepted_answer_id": 57795700, "answer_count": 1, "score": 1, "last_activity_date": 1567631660, "creation_date": 1567630728, "last_edit_date": 1592644375, "question_id": 57795566, "link": "https://stackoverflow.com/questions/57795566/why-is-user-input-in-ruby-different-from-a-given-string-already-inside-the-code", "closed_reason": "Duplicate", "title": "Why is user input in Ruby different from a given string already inside the code?", "body": "<p>My Ruby program evaluates strings in a function called <code>func1</code>.  It asks for user input when it runs.  The string comparison <code>if</code> statement\ndoes not work on user input no matter what.  I can interactively enter the string that should be the same as the program-defined variable constant. But the function interprets the two strings differently. I have added extra debugging steps to verify the string is correct. But I still fail to see why the <code>func1</code> sees user input different from the way I, a human, sees the input.  I expect func1 to receive the user-inputted string <code>foobar</code> and recognize it. This is not what is happening. What am I doing wrong?</p>\n<p>Here is my Ruby program:</p>\n<pre><code>def func1(x)\n    if x == 'foobar' then\n      print &quot;you gave this function foobar&quot;\n      puts &quot; &quot;\n    else\n      print &quot;you did NOT give this function foobar&quot;\n    end\nend\n\ndef prompt(*args)\n    print(&quot;Enter a string: &quot;)\n    coolstring = gets\n    return coolstring\nend\n\nfunc1(&quot;foobar&quot;)\ny = prompt\nprint(y)\nfunc1(y)\n</code></pre>\n<p>Here is some output that shows I entered the string &quot;foobar&quot;:</p>\n<blockquote>\n<p>you gave this function foobar</p>\n<p>Enter a string: foobar</p>\n<p>foobar</p>\n<p>you did NOT give this function foobar</p>\n</blockquote>\n"}, {"tags": ["arrays", "ruby"], "comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1567630706, "post_id": 57795550, "comment_id": 102024229, "body": "What if there&#39;s duplicate values?"}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1567630780, "post_id": 57795550, "comment_id": 102024256, "body": "Hint: A crappy but effective way is to sort the array, then use <code>index</code> to find out where each one went. You can do that with <code>map</code>. A better way is to convert that into pairs, then remap back."}, {"owner": {"reputation": 4229, "user_id": 3973175, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/9c15391d610e59c350912be638b14074?s=128&d=identicon&r=PG", "display_name": "con", "link": "https://stackoverflow.com/users/3973175/con"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 1, "creation_date": 1567630920, "post_id": 57795550, "comment_id": 102024301, "body": "@tadman I&#39;ve edited the question to show how it should look if there are identical values (equivalent of R&#39;s <code>order</code>) how can I do what you&#39;re saying? I am a newb with Ruby"}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1567635051, "post_id": 57795550, "comment_id": 102025436, "body": "You have made the question unnecessarily complex when you show the desired return values as arrays of 1-based indices and then say, &quot;all indices should be 0-based, but these are 1-based&quot;. Unless otherwise stated, indices are zero-based, show just show the desired return values as arrays of (zero-based) indices and say nothing about the index base."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1567635336, "post_id": 57795550, "comment_id": 102025503, "body": "After an answer was posted you changed the question. Yes, you must deal with the possibility of duplicate values, but by giving a tie-breaking rule you made some answers incorrect, including the one to which you awarded the checkmark. Another possibility would be to say that the array contains no duplicate values--which at least would do no harm--and then post a separate, similar question that permits duplicate values and gives a rule for breaking ties. In any event, never change the question after an answer has been posted. Lastly, when you edit there&#39;s no need to write &quot;Edit&quot;."}], "answers": [{"comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1567631426, "post_id": 57795651, "comment_id": 102024487, "body": "Another <code>map</code> could fix that with a +1, but this is what I came up with too."}], "tags": [], "owner": {"reputation": 21613, "user_id": 580346, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/ba17945a06aac247b06548d5afe341e8?s=128&d=identicon&r=PG", "display_name": "mrzasa", "link": "https://stackoverflow.com/users/580346/mrzasa"}, "is_accepted": false, "score": 4, "last_activity_date": 1567631246, "creation_date": 1567631246, "answer_id": 57795651, "question_id": 57795550, "link": "https://stackoverflow.com/questions/57795550/get-array-index-from-sort-in-ruby/57795651#57795651", "title": "get array index from sort in Ruby", "body": "<p>You can do it this way:</p>\n\n<pre><code>[9,43,3,6,7,0].\n  each_with_index.to_a. # [[9, 0], [43, 1], [3, 2], [6, 3], [7, 4], [0, 5]]\n  sort_by(&amp;:first).     # [[0, 5], [3, 2], [6, 3], [7, 4], [9, 0], [43, 1]]\n  map(&amp;:last)           \n#=&gt; [5, 2, 3, 4, 0, 1]\n</code></pre>\n\n<p>First you add index to each element, then you sort by the element and finally you pick just indices.</p>\n\n<p>Note, that array are zero-indexed in Ruby, so the results is less by one comparing to your spec.</p>\n"}, {"comments": [{"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1567636398, "post_id": 57795683, "comment_id": 102025746, "body": "This is terribly inefficient as <code>index</code> must step through <code>arr</code> for each element of the sorted array. I see @tadman pointed that out in a comment on the question."}], "tags": [], "owner": {"reputation": 144312, "user_id": 62076, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/62c90b6f399e6b95554b2da31ca8619a?s=128&d=identicon&r=PG", "display_name": "Alex Wayne", "link": "https://stackoverflow.com/users/62076/alex-wayne"}, "is_accepted": true, "score": 2, "last_activity_date": 1567631453, "creation_date": 1567631453, "answer_id": 57795683, "question_id": 57795550, "link": "https://stackoverflow.com/questions/57795550/get-array-index-from-sort-in-ruby/57795683#57795683", "title": "get array index from sort in Ruby", "body": "<p>You should be able to just map over the sorted array and lookup the index of that number in the original array.</p>\n\n<pre><code>arr = [9,43,3,6,7,0]\narr.sort.map { |n| arr.index(n) } #=&gt; [5, 2, 3, 4, 0, 1]\n</code></pre>\n\n<p>Or if you really want it 1 indexed, instead of zero indexed, for some reason:</p>\n\n<pre><code>arr.sort.map { |n| arr.index(n) + 1 } #=&gt; [6, 3, 4, 5, 1, 2]\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1567636492, "post_id": 57796050, "comment_id": 102025760, "body": "I&#39;ve said nothing about one-based indices as it seems clear that zero-based indices are wanted."}], "tags": [], "owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "is_accepted": false, "score": 1, "last_activity_date": 1567636199, "last_edit_date": 1567636199, "creation_date": 1567633993, "answer_id": 57796050, "question_id": 57795550, "link": "https://stackoverflow.com/questions/57795550/get-array-index-from-sort-in-ruby/57796050#57796050", "title": "get array index from sort in Ruby", "body": "<pre><code>array_a1 = [9,43,3,6,7,0]\n</code></pre>\n\n<h1><p></p></h1>\n\n<pre><code>array_a1.each_index.sort_by { |i| array_a1[i] }\n  #=&gt; [5, 2, 3, 4, 0, 1]\n</code></pre>\n\n<p>If <code>array_a1</code> may contain duplicates and ties are to be broken by the indices of the elements (the element with the smaller index first), you may modify the calculation as follows.</p>\n\n<pre><code>[9,43,3,6,7,7].each_index.sort_by { |i| [array_a1[i], i] }\n  #=&gt; [2, 3, 4, 5, 0, 1]\n</code></pre>\n\n<p><a href=\"https://ruby-doc.org/core-2.6.3/Enumerable.html#method-i-sort_by\" rel=\"nofollow noreferrer\">Enumerable#sort_by</a> compares two elements with the spaceship operator, <code>&lt;=&gt;</code>. Here, as pairs of arrays are being compared, it is the method <a href=\"https://ruby-doc.org/core-2.6.3/Enumerable.html#method-i-sort_by\" rel=\"nofollow noreferrer\">Array#&lt;=></a> that is used. See especially the third paragraph of that doc.</p>\n"}], "owner": {"reputation": 4229, "user_id": 3973175, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/9c15391d610e59c350912be638b14074?s=128&d=identicon&r=PG", "display_name": "con", "link": "https://stackoverflow.com/users/3973175/con"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 73, "favorite_count": 0, "accepted_answer_id": 57795683, "answer_count": 3, "score": 0, "last_activity_date": 1567691286, "creation_date": 1567630639, "last_edit_date": 1567691286, "question_id": 57795550, "link": "https://stackoverflow.com/questions/57795550/get-array-index-from-sort-in-ruby", "title": "get array index from sort in Ruby", "body": "<p>I have an array </p>\n\n<pre><code>array_a1 = [9,43,3,6,7,0]\n</code></pre>\n\n<p>which I'm trying to get the sort indices out of, i.e. the answer should be</p>\n\n<pre><code>array_ordered = [6, 3, 4, 5, 1, 2]\n</code></pre>\n\n<p>I want to do this as a function, so that</p>\n\n<pre><code>def order (array)\n</code></pre>\n\n<p>will return <code>array_ordered</code></p>\n\n<p>I have tried implementing advice from <a href=\"https://stackoverflow.com/questions/37995867/find-the-index-by-current-sort-order-of-an-array-in-ruby\">Find the index by current sort order of an array in ruby</a> but I don't see how I can do what they did for an array :(</p>\n\n<p>if there are identical values in the array, e.g.</p>\n\n<pre><code>array_a1 = [9,43,3,6,7,7]\n</code></pre>\n\n<p>then the result should look like:</p>\n\n<pre><code>array_ordered = [3, 4, 5, 6, 1, 2]\n</code></pre>\n\n<p>(all indices should be 0-based, but these are 1-based)</p>\n"}, {"tags": ["ruby", "string", "mutable"], "comments": [{"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 1, "creation_date": 1567631779, "post_id": 57795068, "comment_id": 102024599, "body": "Why do you turn on frozen strings when you don&#39;t want your strings to be frozen?"}, {"owner": {"reputation": 7390, "user_id": 865175, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/5ede8c46975134f092fd38bdff2ec8c6?s=128&d=identicon&r=PG", "display_name": "Iulian Onofrei", "link": "https://stackoverflow.com/users/865175/iulian-onofrei"}, "reply_to_user": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 0, "creation_date": 1567635029, "post_id": 57795068, "comment_id": 102025432, "body": "Because, as mentioned, it&#39;s enforced by default by RuboCop, and I tend to trust them, and because I do want some strings to be immutable."}], "answers": [{"comments": [{"owner": {"reputation": 4127, "user_id": 4231385, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d89a541a4609cafea3957e4cdfcca50f?s=128&d=identicon&r=PG&f=1", "display_name": "cremno", "link": "https://stackoverflow.com/users/4231385/cremno"}, "edited": false, "score": 1, "creation_date": 1567631761, "post_id": 57795069, "comment_id": 102024591, "body": "Backwards compatible alternatives: <code>String.new(&#39;hello&#39;)</code> or <code>&#39;hello&#39;.dup</code>"}], "tags": [], "owner": {"reputation": 7390, "user_id": 865175, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/5ede8c46975134f092fd38bdff2ec8c6?s=128&d=identicon&r=PG", "display_name": "Iulian Onofrei", "link": "https://stackoverflow.com/users/865175/iulian-onofrei"}, "is_accepted": true, "score": 5, "last_activity_date": 1567627019, "creation_date": 1567627019, "answer_id": 57795069, "question_id": 57795068, "link": "https://stackoverflow.com/questions/57795068/how-do-i-create-a-mutable-string-in-ruby/57795069#57795069", "title": "How do I create a mutable string in Ruby?", "body": "<p>You add a <code>+</code> before the string like:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>string = +'hello'\n\nstring &lt;&lt; ' world'\n\nputs(string)\n</code></pre>\n\n<blockquote>\n  <p>hello world</p>\n</blockquote>\n"}, {"tags": [], "owner": {"reputation": 11166, "user_id": 847116, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/YLb4A.gif?s=128&g=1", "display_name": "jamesc", "link": "https://stackoverflow.com/users/847116/jamesc"}, "is_accepted": false, "score": 4, "last_activity_date": 1567630372, "last_edit_date": 1567630372, "creation_date": 1567628946, "answer_id": 57795267, "question_id": 57795068, "link": "https://stackoverflow.com/questions/57795068/how-do-i-create-a-mutable-string-in-ruby/57795267#57795267", "title": "How do I create a mutable string in Ruby?", "body": "<p>You can also use <code>+=</code>:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>s = 'H'\ns += 'ello\n</code></pre>\n\n<blockquote>\n  <p>=> \"Hello\"</p>\n</blockquote>\n"}, {"comments": [{"owner": {"reputation": 7390, "user_id": 865175, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/5ede8c46975134f092fd38bdff2ec8c6?s=128&d=identicon&r=PG", "display_name": "Iulian Onofrei", "link": "https://stackoverflow.com/users/865175/iulian-onofrei"}, "edited": false, "score": 1, "creation_date": 1567635226, "post_id": 57795496, "comment_id": 102025472, "body": "When <code># frozen_string_literal: true</code> is enabled, you <b>can</b> &#39;mutate&#39; a string by using <code>string &lt;&lt; &#39;string&#39;</code> instead of <code>string += &#39;string&#39;</code> that you mentioned."}, {"owner": {"reputation": 56, "user_id": 7939696, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IEopp.jpg?s=128&g=1", "display_name": "Conturbo", "link": "https://stackoverflow.com/users/7939696/conturbo"}, "reply_to_user": {"reputation": 7390, "user_id": 865175, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/5ede8c46975134f092fd38bdff2ec8c6?s=128&d=identicon&r=PG", "display_name": "Iulian Onofrei", "link": "https://stackoverflow.com/users/865175/iulian-onofrei"}, "edited": false, "score": 0, "creation_date": 1567697165, "post_id": 57795496, "comment_id": 102048933, "body": "This code gave me an error... <code>ruby # frozen_string_literal: true  str = &#39;hello&#39; str &lt;&lt; &#39; world&#39;  </code> ``` Traceback (most recent call last): frozen_strings.rb:4:in `&lt;main&gt;&#39;: can&#39;t modify frozen String (FrozenError) ```"}, {"owner": {"reputation": 56, "user_id": 7939696, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IEopp.jpg?s=128&g=1", "display_name": "Conturbo", "link": "https://stackoverflow.com/users/7939696/conturbo"}, "reply_to_user": {"reputation": 7390, "user_id": 865175, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/5ede8c46975134f092fd38bdff2ec8c6?s=128&d=identicon&r=PG", "display_name": "Iulian Onofrei", "link": "https://stackoverflow.com/users/865175/iulian-onofrei"}, "edited": false, "score": 0, "creation_date": 1568132182, "post_id": 57795496, "comment_id": 102174284, "body": "And besides, that example proves that you cannot mutate strings while <code># frozen_string_literal: true</code> is enabled, but in your first comment you&#39;re asserting that you can."}, {"owner": {"reputation": 7390, "user_id": 865175, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/5ede8c46975134f092fd38bdff2ec8c6?s=128&d=identicon&r=PG", "display_name": "Iulian Onofrei", "link": "https://stackoverflow.com/users/865175/iulian-onofrei"}, "edited": false, "score": 2, "creation_date": 1568132940, "post_id": 57795496, "comment_id": 102174646, "body": "I didn&#39;t want to come up as rude. But your last reply is still incorrect. Again, you can mutate strings, even when <code>frozen_string_literal</code> is set to <code>true</code>, if you initialize it using <code>= +</code>, and <b>not</b> simply <code>=</code>."}], "tags": [], "owner": {"reputation": 56, "user_id": 7939696, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IEopp.jpg?s=128&g=1", "display_name": "Conturbo", "link": "https://stackoverflow.com/users/7939696/conturbo"}, "is_accepted": false, "score": 0, "last_activity_date": 1568132899, "last_edit_date": 1568132899, "creation_date": 1567630335, "answer_id": 57795496, "question_id": 57795068, "link": "https://stackoverflow.com/questions/57795068/how-do-i-create-a-mutable-string-in-ruby/57795496#57795496", "title": "How do I create a mutable string in Ruby?", "body": "<p>When <code># frozen_string_literal: true</code> is enabled, you <strong>cannot</strong> 'mutate' any strings.</p>\n\n<p>Want proof?\nWith the following script...</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code># frozen_string_literal: true\n\nstr = 'hello'\nstr &lt;&lt; ' world'\n\n</code></pre>\n\n<p>you will get the following error...</p>\n\n<pre><code>Traceback (most recent call last):\nfrozen_strings.rb:4:in `&lt;main&gt;': can't modify frozen String (FrozenError)\n</code></pre>\n\n<p>'Mutate' means <em>change the value of the object</em>.\nTherefore, your example fails because <code>&lt;&lt;</code> mutates strings and it is mutating your string <code>string</code> since you are using the <code>&lt;&lt;</code> operator.</p>\n\n<p>Want proof?\nGo into irb!\nEnter the follow:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>str = 'hello' # =&gt; 'hello'\nobj_id1 = str.object_id # =&gt; some number, ex: 12345\nstr &lt;&lt; ' world' # =&gt; 'hello world'\nobj_id2 = str.object_id # =&gt; some number, ex: 12345\nobj_id1 == obj_id2 # this should return true, proving that you mutated the object\n</code></pre>\n\n<p>However, you can get around this by using <code>str += ' world'</code>.\nWhy? Because <code>+=</code> is a shorthand reassignment. Instead of mutating, <code>+=</code> creates a brand new string (with a brand new object_id) and stores it under the same variable name (in this case, str).</p>\n\n<p>Want Proof? Check it out in irb!</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>str = 'hello' # =&gt; 'hello'\nobj_id1 = str.object_id # =&gt; some number, ex: 12345\nstr += ' world' # =&gt; ' world'\nobj_id2 = str.object_id # =&gt; some other number, ex: 356456345\nobj_id1 == obj_id2 # =&gt; this returns false!\n</code></pre>\n\n<p>Let me know if this helped!</p>\n"}, {"comments": [{"owner": {"reputation": 7390, "user_id": 865175, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/5ede8c46975134f092fd38bdff2ec8c6?s=128&d=identicon&r=PG", "display_name": "Iulian Onofrei", "link": "https://stackoverflow.com/users/865175/iulian-onofrei"}, "edited": false, "score": 0, "creation_date": 1575275495, "post_id": 59132415, "comment_id": 104497604, "body": "What does this answer add different from <a href=\"https://stackoverflow.com/a/57795069/865175\">this anwer</a> and <a href=\"https://stackoverflow.com/questions/57795068/how-do-i-create-a-mutable-string-in-ruby/59132415#comment102024591_57795069\">this comment</a>?"}], "tags": [], "owner": {"reputation": 5210, "user_id": 1009442, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/2a01ae9942939ee2b3954a6727d2bb92?s=128&d=identicon&r=PG", "display_name": "Weihang Jian", "link": "https://stackoverflow.com/users/1009442/weihang-jian"}, "is_accepted": false, "score": 1, "last_activity_date": 1575275428, "last_edit_date": 1575275428, "creation_date": 1575258450, "answer_id": 59132415, "question_id": 57795068, "link": "https://stackoverflow.com/questions/57795068/how-do-i-create-a-mutable-string-in-ruby/59132415#59132415", "title": "How do I create a mutable string in Ruby?", "body": "<p><code>frozen_string_literal</code> is for string literal. To create a mutable String instance, use <code>String#new</code> or prepend a <code>+</code> to the string literal.</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code># frozen_string_literal: true\n'foo'.frozen? # =&gt; true\nString.new.frozen? # =&gt; false\n(+'foo').frozen? # =&gt; false\n</code></pre>\n"}], "owner": {"reputation": 7390, "user_id": 865175, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/5ede8c46975134f092fd38bdff2ec8c6?s=128&d=identicon&r=PG", "display_name": "Iulian Onofrei", "link": "https://stackoverflow.com/users/865175/iulian-onofrei"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 444, "favorite_count": 0, "accepted_answer_id": 57795069, "answer_count": 4, "score": 0, "last_activity_date": 1575275428, "creation_date": 1567627019, "question_id": 57795068, "link": "https://stackoverflow.com/questions/57795068/how-do-i-create-a-mutable-string-in-ruby", "title": "How do I create a mutable string in Ruby?", "body": "<p>I am using the <code># frozen_string_literal: true</code> magic comment that RuboCop enforces by default, and I can't append something to a string:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>string = 'hello'\n\nstring &lt;&lt; ' world'\n</code></pre>\n\n<p>because it errors out with:</p>\n\n<blockquote>\n  <p>can't modify frozen String (RuntimeError)</p>\n</blockquote>\n"}, {"tags": ["ruby", "testing", "graphql"], "answers": [{"tags": [], "owner": {"reputation": 3575, "user_id": 111866, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/e742e21c1b64a037eaa90aea1fdf7874?s=128&d=identicon&r=PG", "display_name": "Ross Light", "link": "https://stackoverflow.com/users/111866/ross-light"}, "is_accepted": false, "score": 0, "last_activity_date": 1567654526, "last_edit_date": 1567654526, "creation_date": 1567628824, "answer_id": 57795243, "question_id": 57795043, "link": "https://stackoverflow.com/questions/57795043/how-do-i-create-a-ruby-graphql-inputobject-instance-from-a-hash/57795243#57795243", "title": "How do I create a Ruby GraphQL InputObject instance from a Hash?", "body": "<p><a href=\"https://github.com/rmosolgo/graphql-ruby/blob/6fc8bea4ba9093bfa81da148f4856ba0b5e89014/spec/graphql/schema/input_object_spec.rb#L297\" rel=\"nofollow noreferrer\">Reading the tests more closely</a> revealed that before you can call the constructor, you must first call <a href=\"https://github.com/rmosolgo/graphql-ruby/blob/6fc8bea4ba9093bfa81da148f4856ba0b5e89014/lib/graphql/schema/input_object.rb#L110-L124\" rel=\"nofollow noreferrer\"><code>to_graphql</code></a> (documented in <a href=\"https://graphql-ruby.org/type_definitions/extensions.html\" rel=\"nofollow noreferrer\">Extending the GraphQL-Ruby Type Definition System</a>). This method appears to bake out some schema/metaprogramming data. Adding this line before the <code>new</code> call makes it work as I expect:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>Foo.to_graphql\n</code></pre>\n\n<p>However, the constructor doesn't appear to run any of the type coercions for the arguments: values are returned from the accessor methods verbatim.</p>\n"}], "owner": {"reputation": 3575, "user_id": 111866, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/e742e21c1b64a037eaa90aea1fdf7874?s=128&d=identicon&r=PG", "display_name": "Ross Light", "link": "https://stackoverflow.com/users/111866/ross-light"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 426, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1567654526, "creation_date": 1567626895, "question_id": 57795043, "link": "https://stackoverflow.com/questions/57795043/how-do-i-create-a-ruby-graphql-inputobject-instance-from-a-hash", "title": "How do I create a Ruby GraphQL InputObject instance from a Hash?", "body": "<p>I have a <code>GraphQL::Schema::InputObject</code> subclass that I pass around inside my Rails server's GraphQL mutation handler. I've separated out some of the parts of the code as separate units to test and would like to create an instance of this object in test. How can I do this?</p>\n\n<p>My subclass looks like this:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>class Foo &lt; GraphQL::Schema::InputObject\n  argument :bar, Int, required: true\nend\n</code></pre>\n\n<p>I peeked inside the graphql-ruby tests and <a href=\"https://github.com/rmosolgo/graphql-ruby/blob/6fc8bea4ba9093bfa81da148f4856ba0b5e89014/spec/graphql/schema/input_object_spec.rb#L301-L307\" rel=\"nofollow noreferrer\">saw there's a constructor that take a Hash</a>, so I tried:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>Foo.new({bar: 42}, context: OpenStruct.new(), defaults_used: Set.new())\n</code></pre>\n\n<p>but I get back:</p>\n\n<pre><code>NoMethodError (undefined method `new' for nil:NilClass)\n</code></pre>\n\n<p>I'm using graphql-ruby 1.9.9.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "docker", "dockerfile", "rvm"], "comments": [{"owner": {"reputation": 64542, "user_id": 10008173, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e3ea5d6d5d63e054acb8cfa95a39240d?s=128&d=identicon&r=PG&f=1", "display_name": "David Maze", "link": "https://stackoverflow.com/users/10008173/david-maze"}, "edited": false, "score": 0, "creation_date": 1567627196, "post_id": 57794400, "comment_id": 102023241, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/21895523/why-do-i-have-to-use-bash-l-c-inside-my-container\">Why do I have to use bash -l -c inside my container?</a>"}, {"owner": {"reputation": 64542, "user_id": 10008173, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e3ea5d6d5d63e054acb8cfa95a39240d?s=128&d=identicon&r=PG&f=1", "display_name": "David Maze", "link": "https://stackoverflow.com/users/10008173/david-maze"}, "edited": false, "score": 0, "creation_date": 1567630107, "post_id": 57794400, "comment_id": 102024017, "body": "Usually you don\u2019t want to use a version manager like <code>rvm</code> in a Docker container.  Since you\u2019re packaging a single application, just install the single version of the Ruby interpreter you need as the system Ruby."}], "owner": {"reputation": 105, "user_id": 10953457, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8931d69765be9f007d93d13dc3428bcb?s=128&d=identicon&r=PG", "display_name": "varun", "link": "https://stackoverflow.com/users/10953457/varun"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 98, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1567692282, "creation_date": 1567623656, "question_id": 57794400, "link": "https://stackoverflow.com/questions/57794400/dockerfile-install-ruby-rails-on-rhel7", "title": "Dockerfile install ruby rails on rhel7", "body": "<p>I'm trying to create a Dockerfile to install ruby rails on rhel7. But get this error on rvm. I tried the same steps on local instances and worked fine, but fails via docker build.</p>\n\n<pre><code>FROM registry.access.redhat.com/rhel7\n\nRUN subscription-manager register --username &lt;user&gt; --password &lt;password&gt; --auto-attach\n\nRUN yum install -y gcc-c++ patch readline readline-devel zlib zlib-devel libyaml-devel libffi-devel openssl-devel make bzip2 autoconf automake libtool bison iconv-devel sqlite-devel; \\\n    curl -sSL https://rvm.io/mpapis.asc | gpg2 --import -; \\\n    curl -sSL https://rvm.io/pkuczynski.asc | gpg2 --import -; \\\n    curl -L get.rvm.io | bash -s stable;\\\n    source /etc/profile.d/rvm.sh;\\\n    source /usr/local/rvm/scripts/rvm;\\\n    rvm reload;\\\n    rvm install 2.6.1;\\\n    rvm list;\\\n    rvm use 2.6.1 --default;\\\n    gem install rails;\\\n    ruby --version;\\\n    rails --version\n</code></pre>\n\n<pre><code>\ud83d\udc49  Donate: &lt;code&gt;https://opencollective.com/rvm/donate&lt;/code&gt;\n/bin/sh: rvm: command not found\n/bin/sh: rvm: command not found\n/bin/sh: rvm: command not found\n/bin/sh: rvm: command not found\n/bin/sh: ruby: command not found\nerror building at step {Env:[PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin container=oci] Command:run Args:[curl -sSL https://rvm.io/mpapis.asc | gpg2 --import -;     curl -sSL https://rvm.io/pkuczynski.asc | gpg2 --import -;     curl -L get.rvm.io | bash -s stable;    source /etc/profile.d/rvm.sh;    source /usr/local/rvm/scripts/rvm;    rvm reload;    rvm install 2.6;    rvm list;    rvm use 2.6 --default;    ruby --version] Flags:[] Attrs:map[] Message:RUN curl -sSL https://rvm.io/mpapis.asc | gpg2 --import -;     curl -sSL https://rvm.io/pkuczynski.asc | gpg2 --import -;     curl -L get.rvm.io | bash -s stable;    source /etc/profile.d/rvm.sh;    source /usr/local/rvm/scripts/rvm;    rvm reload;    rvm install 2.6;    rvm list;    rvm use 2.6 --default;    ruby --version Original:RUN curl -sSL https://rvm.io/mpapis.asc | gpg2 --import -;     curl -sSL https://rvm.io/pkuczynski.asc | gpg2 --import -;     curl -L get.rvm.io | bash -s stable;    source /etc/profile.d/rvm.sh;    source /usr/local/rvm/scripts/rvm;    rvm reload;    rvm install 2.6;    rvm list;    rvm use 2.6 --default;    ruby --version}: error while running runtime: exit status 127\n</code></pre>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 6, "creation_date": 1567621796, "post_id": 57793935, "comment_id": 102021163, "body": "Well, obviously they are different. The former generates output right away whereas the latter first creates an instance and then calls an instance method in order to generate the output. Besides, the output is different. What do you mean, specifically?"}], "answers": [{"comments": [{"owner": {"reputation": 969, "user_id": 326242, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35cde28dc376b1403cf4de6cbebc80e5?s=128&d=identicon&r=PG", "display_name": "Andrew Koster", "link": "https://stackoverflow.com/users/326242/andrew-koster"}, "edited": false, "score": 0, "creation_date": 1567624271, "post_id": 57794247, "comment_id": 102022120, "body": "It&#39;s not even clear why a class is necessary in this case. The simplest equivalent code would just be <code>def asdf_call; puts &quot;hello&quot;; end</code>."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "reply_to_user": {"reputation": 969, "user_id": 326242, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35cde28dc376b1403cf4de6cbebc80e5?s=128&d=identicon&r=PG", "display_name": "Andrew Koster", "link": "https://stackoverflow.com/users/326242/andrew-koster"}, "edited": false, "score": 0, "creation_date": 1567624383, "post_id": 57794247, "comment_id": 102022169, "body": "A <code>module</code> could be useful from a namespace perspective."}, {"owner": {"reputation": 969, "user_id": 326242, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35cde28dc376b1403cf4de6cbebc80e5?s=128&d=identicon&r=PG", "display_name": "Andrew Koster", "link": "https://stackoverflow.com/users/326242/andrew-koster"}, "edited": false, "score": 1, "creation_date": 1567625254, "post_id": 57794247, "comment_id": 102022529, "body": "Yeah, and Ruby has modules, so that would be more appropriate if we&#39;re just trying to namespace things. The problem with the question is that we&#39;re being asked to optimize &quot;hello world&quot;, with no use case for it."}], "tags": [], "owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "is_accepted": true, "score": 1, "last_activity_date": 1567622888, "creation_date": 1567622888, "answer_id": 57794247, "question_id": 57793935, "link": "https://stackoverflow.com/questions/57793935/ruby-self-call-inside-a-class/57794247#57794247", "title": "Ruby: self.call inside a class", "body": "<p>This depends entirely on what sort of data you're going to need for context when responding to that method call.</p>\n\n<p>If there's no state involved, the class method approach works better since it doesn't require creating a temporary, and ultimately useless object.</p>\n"}], "owner": {"reputation": 805, "user_id": 4472094, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/aYQD4.jpg?s=128&g=1", "display_name": "Gundam Meister", "link": "https://stackoverflow.com/users/4472094/gundam-meister"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 264, "favorite_count": 0, "accepted_answer_id": 57794247, "answer_count": 1, "score": -1, "last_activity_date": 1567660238, "creation_date": 1567621423, "last_edit_date": 1567625528, "question_id": 57793935, "link": "https://stackoverflow.com/questions/57793935/ruby-self-call-inside-a-class", "title": "Ruby: self.call inside a class", "body": "<p>Is there any difference between these two?</p>\n\n<pre><code>class Asdf\n   def self.call\n      puts \"111\"\n   end\nend\n</code></pre>\n\n<p>and</p>\n\n<pre><code>class Asdf\n  def self.call\n    new.call\n  end\n\n  def call\n    puts \"222\"\n  end\nend\n</code></pre>\n\n<p>both can be called with <code>Asdf.call</code> . Is one a syntactic sugar of the other? Any performance difference between the two? </p>\n"}, {"tags": ["ruby", "unit-testing", "testing", "minitest"], "comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 1, "creation_date": 1567617929, "post_id": 57793108, "comment_id": 102019619, "body": "There&#39;s <a href=\"https://github.com/freerange/mocha\" rel=\"nofollow noreferrer\">whole libraries for this</a>. Which ones are you familiar with?"}, {"owner": {"reputation": 2417, "user_id": 343495, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/823c21aefa18ab5a917aea66cc3c0519?s=128&d=identicon&r=PG", "display_name": "Drew", "link": "https://stackoverflow.com/users/343495/drew"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1567688477, "post_id": 57793108, "comment_id": 102043767, "body": "Had wound up having mocha recommended by another friend--thanks for the tip here as well!  If you want to add mocha as an answer, happy to accept!"}], "answers": [{"tags": [], "owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "is_accepted": true, "score": 1, "last_activity_date": 1567704003, "creation_date": 1567704003, "answer_id": 57810294, "question_id": 57793108, "link": "https://stackoverflow.com/questions/57793108/stubbing-out-instance-methods-in-minitest/57810294#57810294", "title": "Stubbing Out Instance Methods In MiniTest", "body": "<p>There's libraries like <a href=\"https://github.com/freerange/mocha\" rel=\"nofollow noreferrer\">Mocha</a> which are intended to make stubbing and mocking a lot easier. These give you tools which help defining them, and if necessary, later testing that certain methods were executed.</p>\n"}], "owner": {"reputation": 2417, "user_id": 343495, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/823c21aefa18ab5a917aea66cc3c0519?s=128&d=identicon&r=PG", "display_name": "Drew", "link": "https://stackoverflow.com/users/343495/drew"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 31, "favorite_count": 0, "accepted_answer_id": 57810294, "answer_count": 1, "score": 0, "last_activity_date": 1567704003, "creation_date": 1567617457, "question_id": 57793108, "link": "https://stackoverflow.com/questions/57793108/stubbing-out-instance-methods-in-minitest", "title": "Stubbing Out Instance Methods In MiniTest", "body": "<p>I have a handful of instance methods I need to stub out before I test an assertion within the context of MiniTest.</p>\n\n<p>Would there be a way to accomplish this out of the box?</p>\n\n<p>The examples I've come across all seem to be related to just stubbing out one method and then passing a block to be executed within the stubbed context</p>\n"}, {"tags": ["ruby", "web-scraping", "nokogiri", "imgur"], "comments": [{"owner": {"reputation": 3201, "user_id": 2892779, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uvM8S.jpg?s=128&g=1", "display_name": "Jay Dorsey", "link": "https://stackoverflow.com/users/2892779/jay-dorsey"}, "edited": false, "score": 0, "creation_date": 1567616617, "post_id": 57792539, "comment_id": 102019073, "body": "The reason you can&#39;t see the items is because imgur serves up, at that URL, a mostly blank page, then uses javascript to load the content. If you do <code>puts doc.to_html</code> in your script you can see the HTML page it serves up. You need to come up with a way to get the images and titles by either following one of the JS files/scripts linked in the HTML, or use another tool that will render the page first (headless chrome, for example). You may be better off using the imgur API for this task instead of scraping content"}, {"owner": {"reputation": 11, "user_id": 11725813, "user_type": "registered", "profile_image": "https://graph.facebook.com/10219001950140871/picture?type=large", "display_name": "barracius", "link": "https://stackoverflow.com/users/11725813/barracius"}, "reply_to_user": {"reputation": 3201, "user_id": 2892779, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uvM8S.jpg?s=128&g=1", "display_name": "Jay Dorsey", "link": "https://stackoverflow.com/users/2892779/jay-dorsey"}, "edited": false, "score": 0, "creation_date": 1567616833, "post_id": 57792539, "comment_id": 102019160, "body": "Ah thanks! It\u2019s as i feared"}], "answers": [{"tags": [], "owner": {"reputation": 547, "user_id": 3396971, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52c75295766cfc6c5950bb398fa6c7e2?s=128&d=identicon&r=PG", "display_name": "NemyaNation", "link": "https://stackoverflow.com/users/3396971/nemyanation"}, "is_accepted": false, "score": 0, "last_activity_date": 1575644068, "creation_date": 1575644068, "answer_id": 59215453, "question_id": 57792539, "link": "https://stackoverflow.com/questions/57792539/how-to-scrape-images-and-titles-from-imgur-with-nokogiri/59215453#59215453", "title": "How to scrape images and titles from Imgur with nokogiri", "body": "<p>You will find mostly a blank page when trying to scrape the page at url: <a href=\"https://imgur.com/t/memes\" rel=\"nofollow noreferrer\">https://imgur.com/t/memes</a> because the website renders the data using javascript on the client side.</p>\n\n<p>You will want to use something like the <a href=\"https://github.com/watir/watir\" rel=\"nofollow noreferrer\">watir/ruby</a> gem, that allows you to wait until the webpage and all its scripts have been fully loaded before attempting to parse the webpage, meaning you will find the data you except to when you come to parse the document.</p>\n"}], "owner": {"reputation": 11, "user_id": 11725813, "user_type": "registered", "profile_image": "https://graph.facebook.com/10219001950140871/picture?type=large", "display_name": "barracius", "link": "https://stackoverflow.com/users/11725813/barracius"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 103, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1599719228, "creation_date": 1567614746, "last_edit_date": 1599719228, "question_id": 57792539, "link": "https://stackoverflow.com/questions/57792539/how-to-scrape-images-and-titles-from-imgur-with-nokogiri", "title": "How to scrape images and titles from Imgur with nokogiri", "body": "<p>I'm trying to scrape the images and the titles of <a href=\"https://imgur.com/t/memes\" rel=\"nofollow noreferrer\">https://imgur.com/t/memes</a> with Nokogiri.</p>\n<p>This is for a little project, i've already used Nokogiri for scrapping <a href=\"https://www.reddit.com/r/memes/\" rel=\"nofollow noreferrer\">https://www.reddit.com/r/memes/</a> before, and it worked great.</p>\n<pre><code>require 'rest-client'\nrequire 'nokogiri'\n\npage = RestClient.get('https://imgur.com/t/memes')\ndoc = Nokogiri::HTML.parse(page)\nposts = doc.css('.Post-item')\n</code></pre>\n<p>The css class that I need it's called '.Post-item', i have also tried with doc.search, and with 'Post-item' instead of '.Post-item', also i've tried with other css classes of that page, and all of them are returning me [], it should be returning a Nokogiri Parse on that class with all of the posts on that page.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "haml"], "comments": [{"owner": {"reputation": 4690, "user_id": 1937435, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/YyN37.jpg?s=128&g=1", "display_name": "Josh Brody", "link": "https://stackoverflow.com/users/1937435/josh-brody"}, "edited": false, "score": 0, "creation_date": 1567613092, "post_id": 57792155, "comment_id": 102017544, "body": "The <code>f</code> from the <code>form_for</code> block isn&#39;t included in the form partial. You need to include it."}, {"owner": {"reputation": 1, "user_id": 12020794, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9cbc4a1a7b76c00bb51203e5cf6dfbc5?s=128&d=identicon&r=PG&f=1", "display_name": "Sampurna", "link": "https://stackoverflow.com/users/12020794/sampurna"}, "reply_to_user": {"reputation": 4690, "user_id": 1937435, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/YyN37.jpg?s=128&g=1", "display_name": "Josh Brody", "link": "https://stackoverflow.com/users/1937435/josh-brody"}, "edited": false, "score": 0, "creation_date": 1567613152, "post_id": 57792155, "comment_id": 102017578, "body": "and how to include it ? @JoshBrody"}, {"owner": {"reputation": 1, "user_id": 12020794, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9cbc4a1a7b76c00bb51203e5cf6dfbc5?s=128&d=identicon&r=PG&f=1", "display_name": "Sampurna", "link": "https://stackoverflow.com/users/12020794/sampurna"}, "reply_to_user": {"reputation": 4690, "user_id": 1937435, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/YyN37.jpg?s=128&g=1", "display_name": "Josh Brody", "link": "https://stackoverflow.com/users/1937435/josh-brody"}, "edited": false, "score": 0, "creation_date": 1567613529, "post_id": 57792155, "comment_id": 102017763, "body": "$(&#39;#new_lead a&#39;).parent().html(&quot;&lt;%=  j render &#39;form&#39;, locals: { f: f }  %&gt;&quot;) Tried using this too but the error is same @JoshBrody"}, {"owner": {"reputation": 1, "user_id": 12020794, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9cbc4a1a7b76c00bb51203e5cf6dfbc5?s=128&d=identicon&r=PG&f=1", "display_name": "Sampurna", "link": "https://stackoverflow.com/users/12020794/sampurna"}, "reply_to_user": {"reputation": 4690, "user_id": 1937435, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/YyN37.jpg?s=128&g=1", "display_name": "Josh Brody", "link": "https://stackoverflow.com/users/1937435/josh-brody"}, "edited": false, "score": 0, "creation_date": 1567614957, "post_id": 57792155, "comment_id": 102018392, "body": "Thanks  I sorted it out @JoshBrody"}], "owner": {"reputation": 1, "user_id": 12020794, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9cbc4a1a7b76c00bb51203e5cf6dfbc5?s=128&d=identicon&r=PG&f=1", "display_name": "Sampurna", "link": "https://stackoverflow.com/users/12020794/sampurna"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 92, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1567613002, "creation_date": 1567613002, "question_id": 57792155, "link": "https://stackoverflow.com/questions/57792155/locals-in-partial-form-rails-5", "title": "locals in partial form- rails 5", "body": "<p>I am running issues while rendering the partial form . </p>\n\n<p>This is my new.html.haml file</p>\n\n<pre><code>= form_for(@lead, as: :lead, url: admin_leads_path(@lead), html: { method: :post, multipart: true }) do |f|\n= render partial: \"form\", locals: { f: f }\n    #new_lead\n        = link_to 'New Lead', new_admin_lead_path, remote: true\n</code></pre>\n\n<p>I have created a new.js.erb file</p>\n\n<pre><code>$('#new_lead a').parent().html(\"&lt;%=  j render 'form', locals: { lead: @lead }  %&gt;\")\n</code></pre>\n\n<p>I am getting this error</p>\n\n<pre><code>ActionView::Template::Error (undefined local variable or method `f' for #&lt;#&lt;Class:0x0000000008bedf68&gt;:0x00007f647bf9d760&gt;):\n %li{style: \"color: red;\"}= msg\n .form-group\n     = f.label :business_name\n         = f.text_field :business_name, class: \"form-control\"\n</code></pre>\n\n<p>What should the values for locals be set in the new.js.erb file ?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ujs", "ruby-on-rails-6"], "comments": [{"owner": {"reputation": 735, "user_id": 4540883, "user_type": "registered", "accept_rate": 64, "profile_image": "https://graph.facebook.com/10152660906162393/picture?type=large", "display_name": "Diego Velez", "link": "https://stackoverflow.com/users/4540883/diego-velez"}, "edited": false, "score": 1, "creation_date": 1567609198, "post_id": 57791063, "comment_id": 102015455, "body": "I think you are missing the id of the post. like this <code>post_path(post)</code>"}, {"owner": {"reputation": 48413, "user_id": 1279683, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1veuT.jpg?s=128&g=1", "display_name": "Marek Lipka", "link": "https://stackoverflow.com/users/1279683/marek-lipka"}, "edited": false, "score": 0, "creation_date": 1567614855, "post_id": 57791063, "comment_id": 102018351, "body": "Do you see any errors in your JS console?"}, {"owner": {"reputation": 1928, "user_id": 3280050, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c0f86ec29ab3a8f7f841f471d582a933?s=128&d=identicon&r=PG", "display_name": "truongnm", "link": "https://stackoverflow.com/users/3280050/truongnm"}, "reply_to_user": {"reputation": 735, "user_id": 4540883, "user_type": "registered", "accept_rate": 64, "profile_image": "https://graph.facebook.com/10152660906162393/picture?type=large", "display_name": "Diego Velez", "link": "https://stackoverflow.com/users/4540883/diego-velez"}, "edited": false, "score": 0, "creation_date": 1567634185, "post_id": 57791063, "comment_id": 102025257, "body": "@DiegoVelez sorry, I have updated. Yes I have id of the post, same error"}, {"owner": {"reputation": 1928, "user_id": 3280050, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c0f86ec29ab3a8f7f841f471d582a933?s=128&d=identicon&r=PG", "display_name": "truongnm", "link": "https://stackoverflow.com/users/3280050/truongnm"}, "edited": false, "score": 0, "creation_date": 1567634240, "post_id": 57791063, "comment_id": 102025273, "body": "No error on JS hmm"}, {"owner": {"reputation": 1847, "user_id": 1049170, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/e6058ebb749df75fcd91c920e49e4cc7?s=128&d=identicon&r=PG", "display_name": "psantos", "link": "https://stackoverflow.com/users/1049170/psantos"}, "edited": false, "score": 0, "creation_date": 1567766803, "post_id": 57791063, "comment_id": 102071237, "body": "can you show the head part of your layout file?"}, {"owner": {"reputation": 1928, "user_id": 3280050, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c0f86ec29ab3a8f7f841f471d582a933?s=128&d=identicon&r=PG", "display_name": "truongnm", "link": "https://stackoverflow.com/users/3280050/truongnm"}, "edited": false, "score": 0, "creation_date": 1567775334, "post_id": 57791063, "comment_id": 102075379, "body": "Yes, I have updated the post"}, {"owner": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "edited": false, "score": 0, "creation_date": 1580289700, "post_id": 57791063, "comment_id": 106044917, "body": "<code>button_to</code> and the Rails UJS handler actually work in pretty much the exact same way. The UJS handler just creates a form object in JS and submits a POST request with the <code>_method</code> input that Rack::MethodOverride picks up on."}], "answers": [{"comments": [{"owner": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "edited": false, "score": 1, "creation_date": 1580290193, "post_id": 57847267, "comment_id": 106045170, "body": "The browser will always send a GET request when you click a link unless you call <code>e.preventDefault();</code> like the UJS handler does. Thats also the wrong repo for the Rails 6 UJS handler which does not depend on jQuery. The current UJS handlers are at <a href=\"https://github.com/rails/rails/tree/b2eb1d1c55a59fee1e6c4cba7030d8ceb524267c/actionview/app/assets/javascripts/rails-ujs\" rel=\"nofollow noreferrer\">github.com/rails/rails/tree/&hellip;</a>"}, {"owner": {"reputation": 306, "user_id": 7295609, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/eafa51697642ed1af7680b797152fe92?s=128&d=identicon&r=PG&f=1", "display_name": "\ud64d\ud55c\uc11d", "link": "https://stackoverflow.com/users/7295609/%ed%99%8d%ed%95%9c%ec%84%9d"}, "edited": false, "score": 0, "creation_date": 1600416602, "post_id": 57847267, "comment_id": 113086960, "body": "I stuck in a same problem.  I can see Rails UJS(<a href=\"https://github.com/rails/rails/blob/b2eb1d1c55a59fee1e6c4cba7030d8ceb524267c/actionview/app/assets/javascripts/rails-ujs/features/method.coffee;not\" rel=\"nofollow noreferrer\">github.com/rails/rails/blob/&hellip;</a> jquery ujs you linked, but same part) in compiled js on page, pack/js/application-fingerprint.js. But it seems not working"}], "tags": [], "owner": {"reputation": 1928, "user_id": 3280050, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c0f86ec29ab3a8f7f841f471d582a933?s=128&d=identicon&r=PG", "display_name": "truongnm", "link": "https://stackoverflow.com/users/3280050/truongnm"}, "is_accepted": false, "score": 1, "last_activity_date": 1600743548, "last_edit_date": 1600743548, "creation_date": 1567997027, "answer_id": 57847267, "question_id": 57791063, "link": "https://stackoverflow.com/questions/57791063/rails-6-destroy-path-to-get-although-added-rails-ujs/57847267#57847267", "title": "Rails 6 - DESTROY path to GET although added rails/ujs", "body": "<p>I was able to solve the problem. I will share for you guys.</p>\n<p>In my layout I have <code>=javascript_pack_tag 'application'</code> which load Rails UJS already.</p>\n<p>In my view partial I also include another js script <code>javascript_pack_tag 'posts/show'</code>. The problems is in that script, I set to listen to click event then <code>e.preventDefault()</code>, turn out that Rails UJS can't create form delete, then GET request is sent.</p>\n<pre class=\"lang-js prettyprint-override\"><code>document.addEventListener(&quot;DOMContentLoaded&quot;,function() {\n  let postOption = document.getElementsById(&quot;post-options&quot;);\n  postOption.addEventListener(&quot;click&quot;, function(e) {\n      e.stopPropagation();\n      this.classList.toggle(&quot;is-active&quot;);\n    });\n  });\n});\n</code></pre>\n<p><a href=\"https://github.com/rails/jquery-ujs/blob/master/src/rails.js#L213-L232\" rel=\"nofollow noreferrer\">Rails UJS</a></p>\n<pre class=\"lang-js prettyprint-override\"><code>    // Handles &quot;data-method&quot; on links such as:\n    // &lt;a href=&quot;/users/5&quot; data-method=&quot;delete&quot; rel=&quot;nofollow&quot; data-confirm=&quot;Are you sure?&quot;&gt;Delete&lt;/a&gt;\n    handleMethod: function(link) {\n      var href = rails.href(link),\n        method = link.data('method'),\n        target = link.attr('target'),\n        csrfToken = rails.csrfToken(),\n        csrfParam = rails.csrfParam(),\n        form = $('&lt;form method=&quot;post&quot; action=&quot;' + href + '&quot;&gt;&lt;/form&gt;'),\n        metadataInput = '&lt;input name=&quot;_method&quot; value=&quot;' + method + '&quot; type=&quot;hidden&quot; /&gt;';\n\n      if (csrfParam !== undefined &amp;&amp; csrfToken !== undefined &amp;&amp; !rails.isCrossDomain(href)) {\n        metadataInput += '&lt;input name=&quot;' + csrfParam + '&quot; value=&quot;' + csrfToken + '&quot; type=&quot;hidden&quot; /&gt;';\n      }\n\n      if (target) { form.attr('target', target); }\n\n      form.hide().append(metadataInput).appendTo('body');\n      form.submit();\n    },\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 108, "user_id": 1782214, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CdBpe.jpg?s=128&g=1", "display_name": "Abhinav Mathur", "link": "https://stackoverflow.com/users/1782214/abhinav-mathur"}, "edited": false, "score": 0, "creation_date": 1614832047, "post_id": 66265837, "comment_id": 117506734, "body": "This is the only way I could make the logout link for devise work."}], "tags": [], "owner": {"reputation": 53, "user_id": 7548895, "user_type": "registered", "profile_image": "https://graph.facebook.com/406852813001269/picture?type=large", "display_name": "Adrian Rama", "link": "https://stackoverflow.com/users/7548895/adrian-rama"}, "is_accepted": false, "score": 1, "last_activity_date": 1613672320, "creation_date": 1613672320, "answer_id": 66265837, "question_id": 57791063, "link": "https://stackoverflow.com/questions/57791063/rails-6-destroy-path-to-get-although-added-rails-ujs/66265837#66265837", "title": "Rails 6 - DESTROY path to GET although added rails/ujs", "body": "<p>Knowing</p>\n<p><code>helper.link_to &quot;delete&quot;, &quot;/posts/19&quot;, :method =&gt; 'delete', class: 'dropdown-item'</code></p>\n<p>Generates</p>\n<pre><code>&lt;a class=&quot;dropdown-item&quot; rel=&quot;nofollow&quot; data-method=&quot;delete&quot; href=&quot;/posts/19&quot;&gt;Delete&lt;/a&gt;\n</code></pre>\n<p>For me worked</p>\n<pre><code>button_to &quot;Salir&quot;, &quot;/posts/19&quot;, :method =&gt; 'delete', class: &quot;dropdown-item&quot;\n</code></pre>\n<p>Wich generate</p>\n<pre><code>&lt;form class=&quot;button_to&quot; method=&quot;post&quot; action=&quot;/posts/19&quot;&gt;&lt;input type=&quot;hidden&quot; name=&quot;_method&quot; value=&quot;delete&quot;&gt;&lt;input class=&quot;dropdown-item&quot; type=&quot;submit&quot; value=&quot;delete&quot;&gt;&lt;input type=&quot;hidden&quot; name=&quot;authenticity_token&quot; value=&quot;UwJqclJbUaT0Y8Zl53-43JHG9Cc3_D3lOktsfB200jx8G0IFTF_yKhRgXSHXxlUssxtoTYcpt68FLjw-C0WL-g&quot;&gt;&lt;/form&gt;\n</code></pre>\n<p>I think it could be a solution approach.</p>\n"}], "owner": {"reputation": 1928, "user_id": 3280050, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c0f86ec29ab3a8f7f841f471d582a933?s=128&d=identicon&r=PG", "display_name": "truongnm", "link": "https://stackoverflow.com/users/3280050/truongnm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1574, "favorite_count": 0, "answer_count": 2, "score": 3, "last_activity_date": 1613672320, "creation_date": 1567608999, "last_edit_date": 1567775414, "question_id": 57791063, "link": "https://stackoverflow.com/questions/57791063/rails-6-destroy-path-to-get-although-added-rails-ujs", "title": "Rails 6 - DESTROY path to GET although added rails/ujs", "body": "<p>I'm using Rails 6, got this error again.</p>\n\n<p>show.html.erb</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>&lt;%= link_to \"Delete\", post_path(@post), class: \"dropdown-item\", method: :delete %&gt;\n</code></pre>\n\n<p>controller and routes are set up without error.</p>\n\n<p>app/javascript/packs/application.js</p>\n\n<pre class=\"lang-js prettyprint-override\"><code>require(\"@rails/ujs\").start();\n// require(\"turbolinks\").start();\nrequire(\"@rails/activestorage\").start();\nrequire(\"channels\");\n</code></pre>\n\n<p>When click on the link, I can see the log:</p>\n\n<pre><code>Started GET \"/posts/19\" for ::1 at 2019-09-04 23:50:30 +0900\nProcessing by PostsController#show as HTML\n  Parameters: {\"id\"=&gt;\"19\"}\n</code></pre>\n\n<p>Instead of DELETE.</p>\n\n<p>This is what got rendered in HTML:</p>\n\n<pre class=\"lang-html prettyprint-override\"><code>&lt;a class=\"dropdown-item\" rel=\"nofollow\" data-method=\"delete\" href=\"/posts/19\"&gt;Delete&lt;/a&gt;\n</code></pre>\n\n<p>In layouts I include application.js:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>&lt;%= javascript_pack_tag 'application' %&gt;\n</code></pre>\n\n<p>In HTML:</p>\n\n<pre class=\"lang-html prettyprint-override\"><code>&lt;head&gt;\n  &lt;meta name=\"csrf-param\" content=\"authenticity_token\"&gt;\n  &lt;meta name=\"csrf-token\" content=\"+EskpcJWxzYlo5g5lOyRAnx7tgARKbeFqV21YgtRjnlT4/xsmWsRljfqbVmpSDSl2l0s9scz7+C2bezpiLy4fA==\"&gt;\n\n\n  &lt;link rel=\"stylesheet\" media=\"all\" href=\"/assets/trix/dist/trix.self-6dd442511a4fc56685fca816ea1b42de7bbc8a0fd0bfd759530fa9e7625d1a6f.css?body=1\" data-turbolinks-track=\"reload\"&gt;\n  &lt;link rel=\"stylesheet\" media=\"all\" href=\"/assets/actiontext.self-a679dceacb4aa0b812495eb34e20291bc8eab82506add17d18f0b3b3d1353123.css?body=1\" data-turbolinks-track=\"reload\"&gt;\n  &lt;link rel=\"stylesheet\" media=\"all\" href=\"/assets/application.self-2115ce8ad5c8bf2c98589b69e9fc7c0d3ba5251b0d5ef251ec5b3da1da9cb7a8.css?body=1\" data-turbolinks-track=\"reload\"&gt;\n  &lt;link rel=\"stylesheet\" type=\"text/css\" href=\"https://cdn.jsdelivr.net/npm/toastify-js/src/toastify.min.css\"&gt;\n  &lt;script src=\"/packs/js/application-dffd55b262c09e354e1b.js\"&gt;&lt;/script&gt;\n&lt;/head&gt;\n</code></pre>\n\n<p>Actually change to <code>button_to</code> works, it generates this on HTML:</p>\n\n<pre class=\"lang-html prettyprint-override\"><code>&lt;form class=\"button_to\" method=\"post\" action=\"/posts/19\"&gt;\n  &lt;input type=\"hidden\" name=\"_method\" value=\"delete\"&gt;\n  &lt;input class=\"dropdown-item\" type=\"submit\" value=\"Delete\"&gt;\n  &lt;input type=\"hidden\" name=\"authenticity_token\" value=\"ZnfQ05Ah/4LevuR8vXvcYN/CSNAoTDQuwpGHF4WrJDiVV8+wwb4ztsYdsKk9UPZ3k9Gxpfpd/gcobcSBEI6/6A==\"&gt;\n&lt;/form&gt;\n</code></pre>\n\n<p>Notice this line: <code>&lt;input type=\"hidden\" name=\"_method\" value=\"delete\"&gt;</code></p>\n\n<p>I think the problem is Rails UJS hasn't been loaded. I open console and type <code>Rails</code> or <code>Rails.handleMethod</code> and I got </p>\n\n<pre><code>Uncaught ReferenceError: Rails is not defined\n    at &lt;anonymous&gt;:1:1\n(anonymous) @ VM9848:1\n</code></pre>\n"}, {"tags": ["ruby", "datamapper"], "comments": [{"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 1, "creation_date": 1567609828, "post_id": 57790713, "comment_id": 102015788, "body": "<i>&quot;Is there a simple way&quot;</i> \u2013 well, you have to convert the existing EST values in your database to UTC and then store new values in UTC (probably by setting your project&#39;s / server&#39;s timezone). This doesn&#39;t sound too complicated. What specific problem are you facing?"}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1567615450, "post_id": 57790713, "comment_id": 102018588, "body": "It depends what data you have and how far back these times go. Remember that the time-zone definition changed in 2007 so adjusting those values will require careful attention."}], "owner": {"reputation": 1, "user_id": 11957813, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/75e0bc3adecd30fa289e7ec2d38cf50a?s=128&d=identicon&r=PG&f=1", "display_name": "YoungHerm", "link": "https://stackoverflow.com/users/11957813/youngherm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 28, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1567607758, "creation_date": 1567607758, "question_id": 57790713, "link": "https://stackoverflow.com/questions/57790713/how-do-you-convert-all-of-the-datetimes-in-a-project-to-utc", "title": "How do you convert all of the DateTimes in a project to UTC?", "body": "<p>People in different timezones will be using a website I'm building and currently all DateTime properties are in EST using dm-timestamps. Is there a simple way to make it so anything that has been, or will be created has all DateTime properties formatted in UTC?</p>\n"}, {"tags": ["ruby", "ruby-on-rails-3", "devise", "pundit"], "comments": [{"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 1, "creation_date": 1567604698, "post_id": 57788255, "comment_id": 102012734, "body": "What is the question? &quot;How do I set <code>current_user</code> to an <code>Employee</code> instead of a <code>User</code>&quot;?"}, {"owner": {"reputation": 113, "user_id": 10075876, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-j7d3Chl5TZo/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7obE-kTGcNuqf5tWp6sQ3RBQUo5dA/mo/photo.jpg?sz=128", "display_name": "Sabrina", "link": "https://stackoverflow.com/users/10075876/sabrina"}, "reply_to_user": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1567605107, "post_id": 57788255, "comment_id": 102012985, "body": "yes but to also keep the user model authentication. Do you have an idea how that is done?"}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1567626382, "post_id": 57788255, "comment_id": 102022948, "body": "You haven&#39;t shown any code relating to Employer. So I don&#39;t really know what you&#39;ve tried, or where you&#39;re stuck. And i don&#39;t know how to implement it without first knowing how Employer is implemented."}], "answers": [{"tags": [], "owner": {"reputation": 81, "user_id": 13790294, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f55f90cb45449080e9753ecce17eb065?s=128&d=identicon&r=PG&f=1", "display_name": "Ezhil", "link": "https://stackoverflow.com/users/13790294/ezhil"}, "is_accepted": false, "score": 0, "last_activity_date": 1593023184, "creation_date": 1593023184, "answer_id": 62561749, "question_id": 57788255, "link": "https://stackoverflow.com/questions/57788255/pundit-with-second-devise-model/62561749#62561749", "title": "Pundit with second devise model", "body": "<p>You can have workaround here like below for each actions</p>\n<pre><code>def show?\n  true if @user.class.table_name == &quot;employees&quot;\nend\n</code></pre>\n"}], "owner": {"reputation": 113, "user_id": 10075876, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-j7d3Chl5TZo/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7obE-kTGcNuqf5tWp6sQ3RBQUo5dA/mo/photo.jpg?sz=128", "display_name": "Sabrina", "link": "https://stackoverflow.com/users/10075876/sabrina"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 230, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1593023184, "creation_date": 1567599467, "question_id": 57788255, "link": "https://stackoverflow.com/questions/57788255/pundit-with-second-devise-model", "title": "Pundit with second devise model", "body": "<p>I manage the authorization of users in my app with the pundit gem. Everything works fine for the user. Now I created a second devise model: Employers. I want to show a specific page to both logged in user as well as logged in employers. How do I do that?</p>\n\n<p>Here is my policy for the model:</p>\n\n<pre><code>class CurriculumPolicy &lt; ApplicationPolicy\n  class Scope &lt; Scope\n    def resolve\n      scope.all\n    end\n  end\n\n  def create?\n    return true\n  end\n\n  def show?\n    record.user == user || user.admin\n  end\n\n  def update?\n    record.user == user || user.admin\n  end\n\n  def destroy?\n    record.user == user || user.admin\n  end\nend\n</code></pre>\n\n<p>And here is my controller for the index page which I want to make accessible:</p>\n\n<pre><code>class CurriculumsController &lt; ApplicationController\n    skip_before_action :authenticate_user!, only: [:new, :create, :index]\n    before_action :set_curriculum, only: [:show, :edit, :update, :destroy]\n\n  def index\n    # @curriculums = policy_scope(Curriculum).order(created_at: :desc)\n    if params[:query]\n  @curriculums = policy_scope(Curriculum).joins(:user)\n               .where('users.job_category ILIKE ?', \"%#{params[:query]}%\")\n               .where(\n                 'job_category ILIKE :query', query: \"%#{params[:query]}%\"\n                )\n    else\n    @curriculums = policy_scope(Curriculum).order(created_at: :desc)\n    end\n  end\n\n  private\n\n   def set_curriculum\n      @curriculum = Curriculum.find(params[:id])\n    end\n\n  def curriculum_params\n      params.require(:curriculum).permit(:doc)\n  end\n\nend\n</code></pre>\n"}, {"tags": ["ruby", "inheritance", "module"], "comments": [{"owner": {"reputation": 16672, "user_id": 22237, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/hkobD.png?s=128&g=1", "display_name": "Kris", "link": "https://stackoverflow.com/users/22237/kris"}, "edited": false, "score": 0, "creation_date": 1567595696, "post_id": 57787016, "comment_id": 102007736, "body": "Also see <a href=\"http://www.railstips.org/blog/archives/2009/05/15/include-vs-extend-in-ruby/\" rel=\"nofollow noreferrer\">railstips.org/blog/archives/2009/05/15/&hellip;</a>"}, {"owner": {"reputation": 17551, "user_id": 1182464, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/e569ac49e984e3a55ee167b14c11cf41?s=128&d=identicon&r=PG", "display_name": "estani", "link": "https://stackoverflow.com/users/1182464/estani"}, "reply_to_user": {"reputation": 16672, "user_id": 22237, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/hkobD.png?s=128&g=1", "display_name": "Kris", "link": "https://stackoverflow.com/users/22237/kris"}, "edited": false, "score": 0, "creation_date": 1567601553, "post_id": 57787016, "comment_id": 102010873, "body": "@Kris yes I did read it already, but first that is a case of a module define within another (not sure it&#39;s important) and more than that, it&#39;s not about extending (in any way) a method that has to be imported as &quot;extended&quot; (requirement for memoist)"}, {"owner": {"reputation": 89316, "user_id": 238886, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/8ca29123b5669b26f9b6ca2c62d9d215?s=128&d=identicon&r=PG", "display_name": "Wayne Conrad", "link": "https://stackoverflow.com/users/238886/wayne-conrad"}, "edited": false, "score": 1, "creation_date": 1567606998, "post_id": 57787016, "comment_id": 102014058, "body": "I like that you&#39;ve created a standalone example.  It may be too far from reality, however.  I think you may need to give us an example that uses Memoist, so that we can see the actual problem you are having."}, {"owner": {"reputation": 16672, "user_id": 22237, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/hkobD.png?s=128&g=1", "display_name": "Kris", "link": "https://stackoverflow.com/users/22237/kris"}, "edited": false, "score": 0, "creation_date": 1567608358, "post_id": 57787016, "comment_id": 102014944, "body": "A module which is included in a class or another module is usually called a mixin. When you use <code>extend</code> it will create class, not instance, methods. Although you can also create class methods via <code>include</code> too using a bit of extra magic by the way of the <code>included</code> method which can then <code>extend</code> the target class with a nested module by convention called <code>ClassMethods</code>."}], "answers": [{"comments": [{"owner": {"reputation": 17551, "user_id": 1182464, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/e569ac49e984e3a55ee167b14c11cf41?s=128&d=identicon&r=PG", "display_name": "estani", "link": "https://stackoverflow.com/users/1182464/estani"}, "edited": false, "score": 0, "creation_date": 1567601323, "post_id": 57787157, "comment_id": 102010740, "body": "Sorry but class C needs to be extended by module A as I put in the question, this is important. (Is a requirement of memoist, I don&#39;t want to extend on why this is so, but it is)."}, {"owner": {"reputation": 16672, "user_id": 22237, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/hkobD.png?s=128&g=1", "display_name": "Kris", "link": "https://stackoverflow.com/users/22237/kris"}, "edited": false, "score": 0, "creation_date": 1567608135, "post_id": 57787157, "comment_id": 102014813, "body": "This does answer the question."}, {"owner": {"reputation": 48413, "user_id": 1279683, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1veuT.jpg?s=128&g=1", "display_name": "Marek Lipka", "link": "https://stackoverflow.com/users/1279683/marek-lipka"}, "reply_to_user": {"reputation": 17551, "user_id": 1182464, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/e569ac49e984e3a55ee167b14c11cf41?s=128&d=identicon&r=PG", "display_name": "estani", "link": "https://stackoverflow.com/users/1182464/estani"}, "edited": false, "score": 1, "creation_date": 1567609194, "post_id": 57787157, "comment_id": 102015450, "body": "@estani please clarify then. You want to have methods from module <code>A</code> as instance methods as well as class methods? Maybe you should describe what you&#39;re trying to achieve using <code>Memoist</code>?"}], "tags": [], "owner": {"reputation": 48413, "user_id": 1279683, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1veuT.jpg?s=128&g=1", "display_name": "Marek Lipka", "link": "https://stackoverflow.com/users/1279683/marek-lipka"}, "is_accepted": false, "score": 4, "last_activity_date": 1567595455, "creation_date": 1567595455, "answer_id": 57787157, "question_id": 57787016, "link": "https://stackoverflow.com/questions/57787016/module-extending-other-modules-in-ruby/57787157#57787157", "title": "module extending other modules in Ruby", "body": "<p><code>extends</code> adds the methods from the module passed as argument as 'class methods'. What you're looking for is <code>include</code>, which adds methods from (in this case) <code>A</code> module as instance methods, just like you want it to:</p>\n\n<pre><code>module A\n  def a\n    puts 'hi'\n  end\nend\n\nmodule B\n  include A\nend\n\nclass C\n  include B\n  def b\n    a\n  end\nend\nC.new.b\n# hi\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 13442, "user_id": 3982562, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2a3c7aae1d762372cda697833c602ec8?s=128&d=identicon&r=PG", "display_name": "3limin4t0r", "link": "https://stackoverflow.com/users/3982562/3limin4t0r"}, "is_accepted": false, "score": 1, "last_activity_date": 1567616848, "last_edit_date": 1567616848, "creation_date": 1567612413, "answer_id": 57792005, "question_id": 57787016, "link": "https://stackoverflow.com/questions/57787016/module-extending-other-modules-in-ruby/57792005#57792005", "title": "module extending other modules in Ruby", "body": "<p>First of all your example is not entirely valid. A module that is extended doesn't add instance methods by default. Your <code>A</code> module should look something like this:</p>\n\n<pre><code>module Memoist\n  def self.extended(mod)\n    mod.include InstanceMethods\n  end\n\n  module InstanceMethods\n    def a\n      puts 'hi'\n    end\n  end\nend\n</code></pre>\n\n<p>You can <code>extend Memoist</code> in an <code>extended</code>, <code>included</code> or <code>excluded</code> callback. This works as long as you're adding to the interface. The callbacks are triggered after your module is extended, included or prepended. <strong>This means that if you want to extend an existing method using <code>super</code> this won't work since the original is called before your version.</strong></p>\n\n<pre><code>module YourMemoist\n  # Depending on how you want to incorporate your module into the class\n  # you can use one of the following: \n  def self.extended(mod)\n    mod.extend Memoist\n  end\n\n  # def self.included(mod)\n  #   mod.extend Memoist\n  # end\n\n  # def self.prepended(mod)\n  #   mod.extend Memoist\n  # end\n\n  # ...\nend\n\nclass C\n  extend MemoistHelper # or include, prepend\nend\n\nC.new.a #=&gt; prints hi\nC.singleton_class.ancesotrs #=&gt; [#&lt;Class:C&gt;, Memoist, YourMemoist, ...]\n</code></pre>\n\n<p>If you do want to use the <code>super</code> keyword things are going to be a bit more difficult. Since the <code>Memoist</code> module needs to be extended first. One way of doing this by including the module into your own, so you can override them. Pretty simple so far. However <code>Memoist</code> might have an <code>extended</code> callback defined (to add instance methods), which is not triggered when we include the module in our own. So we need to call this manually.</p>\n\n<pre><code>module YourMemoist\n  include Memoist\n\n  def self.extended(mod)\n    Memoist.send(:extended, mod) # using #send to call private method\n    # If you want to add your own instance methods add them after the\n    # above call (as shown in the Memoist module).\n  end\n\n  # ...\nend\n\nclass C\n  extend MemoistHelper\nend\n\nC.new.a #=&gt; prints hi\nC.singleton_class.ancesotrs #=&gt; [#&lt;Class:C&gt;, YourMemoist, Memoist, ...]\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "is_accepted": false, "score": 1, "last_activity_date": 1567618992, "creation_date": 1567618992, "answer_id": 57793425, "question_id": 57787016, "link": "https://stackoverflow.com/questions/57787016/module-extending-other-modules-in-ruby/57793425#57793425", "title": "module extending other modules in Ruby", "body": "<p>Recall that if a module <code>M1</code> is <code>included</code> or <code>extended</code> (or <code>prepended</code>) by a module <code>M2</code>, <code>M1</code>'s instance methods are brought into <code>M2</code>, either as instance methods (if including) or as module methods (if extending). If <code>M1</code> contains module methods (methods invoked on <code>M1</code>) they are skipped over by both <code>include</code> and <code>extend</code>. As classes are modules, this applies when <code>M2</code> is a class.</p>\n\n<pre><code>module M1\n  def i() end\n  def self.m() end\nend\n\nM1.instance_methods\n  #=&gt; [:i] \nM1.methods(false)\n  #=&gt; [:m] \n</code></pre>\n\n<h1><p></p></h1>\n\n<pre><code>module M2; end\n\nM2.extend M1\nM2.instance_methods\n  #=&gt; []\nM2.methods &amp; [:i, :m]\n  #=&gt; [:i]\n</code></pre>\n\n<h1><p></p></h1>\n\n<pre><code>module M3; end\n\nM3.include M1\nM3.instance_methods\n  #=&gt; [:i]\nM3.methods &amp; [:i, :m]\n  #=&gt; []\n</code></pre>\n\n<p>We see that neither <code>M2</code> nor <code>M3</code> contains a method <code>:m</code>. Now consider the following.</p>\n\n<pre><code>module A\n  def a\n    puts 'hi'\n  end\nend\n\nmodule B\n  extend A\nend\n\nB.instance_methods\n  #=&gt; []\nB.methods &amp; [:a]\n  #=&gt; [:a]\n</code></pre>\n\n<p>As expected, <code>B</code> contains no instance methods and its module methods include <code>:a</code>. From the earlier discussion it follows that including or extending <code>B</code> into another module (or class) <code>C</code> brings <em>no instance methods or methods</em> into <code>C</code>.</p>\n\n<p>To add to the functionality of <code>A</code>, <code>B</code> must <code>include</code> (or <code>prepend</code>) <code>A</code>.</p>\n\n<pre><code>module B\n  include A\n  def b\n    puts 'ho'\n  end\nend\n\nB.instance_methods\n  #=&gt; [:b, :a] \nB.methods &amp; [:a, :b]\n  #=&gt; []\n</code></pre>\n\n<p><code>C</code> may then <code>include</code> or <code>extend</code> <code>B</code>, depending on requirements.</p>\n\n<p>One may ask whether there is any reason to define module methods if they are disregarded when the module is included or extended by another module. The answer is that they are simply helper methods that behave as functions in non-OOP languages. An example is the module <a href=\"https://ruby-doc.org/core-2.6.3/Math.html\" rel=\"nofollow noreferrer\">Math</a>, which contains module methods only. They are therefore invoked on the module; for example,</p>\n\n<pre><code>Math.sqrt(2)\n  #=&gt; 1.4142135623730951  \n</code></pre>\n"}], "owner": {"reputation": 17551, "user_id": 1182464, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/e569ac49e984e3a55ee167b14c11cf41?s=128&d=identicon&r=PG", "display_name": "estani", "link": "https://stackoverflow.com/users/1182464/estani"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 83, "favorite_count": 0, "answer_count": 3, "score": 3, "last_activity_date": 1567618992, "creation_date": 1567594867, "last_edit_date": 1567601675, "question_id": 57787016, "link": "https://stackoverflow.com/questions/57787016/module-extending-other-modules-in-ruby", "title": "module extending other modules in Ruby", "body": "<p>I have read quite a few answers here in this regards, but I still cant figure out why the following doesn't work</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>module A\n  def a\n    puts 'hi'\n  end\nend\n\nmodule B\n  extend A\nend\n\nclass C\n  extend B\n  def b\n    a\n  end\nend\nC.new.b # undefined local variable or method `a' for #&lt;C:...\n</code></pre>\n\n<p>I've also tried with:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>module B\n  def self.included(recipient)\n    recipient.extend A\n  end\nend\n</code></pre>\n\n<p>Hoping <code>C</code> will get extended (but I guess the hierarchy is then wrong)</p>\n\n<p><strong>Important</strong>: The Problem is that I have a module that requires to be <code>extended</code> <a href=\"https://github.com/matthewrudy/memoist\" rel=\"nofollow noreferrer\">memoist</a>, and I want to add some functionality to it.</p>\n\n<p>How can I achieve that and why is the first example not working?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "heroku"], "comments": [{"owner": {"reputation": 209, "user_id": 6164286, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-GdxIL2SItVU/AAAAAAAAAAI/AAAAAAAAAKY/6vaPPw0-Yfk/photo.jpg?sz=128", "display_name": "William Tran", "link": "https://stackoverflow.com/users/6164286/william-tran"}, "edited": false, "score": 0, "creation_date": 1567591530, "post_id": 57786027, "comment_id": 102005681, "body": "Have you tried remove <code>Gemfile.lock</code> and run again?"}], "answers": [{"comments": [{"owner": {"reputation": 342, "user_id": 7408438, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/8bb7b1548a23f1ff7ecbb17e50035c52?s=128&d=identicon&r=PG&f=1", "display_name": "sam", "link": "https://stackoverflow.com/users/7408438/sam"}, "reply_to_user": {"reputation": 3429, "user_id": 1414327, "user_type": "registered", "accept_rate": 47, "profile_image": "https://i.stack.imgur.com/xcgRQ.jpg?s=128&g=1", "display_name": "Asnad Atta", "link": "https://stackoverflow.com/users/1414327/asnad-atta"}, "edited": false, "score": 0, "creation_date": 1567601713, "post_id": 57787103, "comment_id": 102010956, "body": "Can you delete gemfile.lock file and test it?"}], "tags": [], "owner": {"reputation": 342, "user_id": 7408438, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/8bb7b1548a23f1ff7ecbb17e50035c52?s=128&d=identicon&r=PG&f=1", "display_name": "sam", "link": "https://stackoverflow.com/users/7408438/sam"}, "is_accepted": false, "score": 0, "last_activity_date": 1567595206, "creation_date": 1567595206, "answer_id": 57787103, "question_id": 57786027, "link": "https://stackoverflow.com/questions/57786027/heroku-deployment-error-you-must-use-bundler-2-or-greater-with-this-lockfile/57787103#57787103", "title": "Heroku deployment error You must use Bundler 2 or greater with this lockfile", "body": "<p><strong>1</strong> For the time being, it is possible to use Bundler 2 via this buildpack: <a href=\"https://github.com/bundler/heroku-buildpack-bundler2\" rel=\"nofollow noreferrer\">https://github.com/bundler/heroku-buildpack-bundler2</a>. You can set your Heroku app to use that buildpack like this:</p>\n\n<pre><code>heroku buildpacks:set https://github.com/bundler/heroku-buildpack-bundler2\n</code></pre>\n\n<p><strong>2.</strong> If first solution is not work for you then try this solution:</p>\n\n<p>Display a list of all your local gems for the bundler gem</p>\n\n<pre><code>gem list bundler\n</code></pre>\n\n<p>This will display the versions of the bundler gem installed locally</p>\n\n<p>bundler (2.0.2, default: 1.17.2)\nif you don't have bundler version 2 installed locally, then run</p>\n\n<pre><code>gem install bundler\n</code></pre>\n\n<p>OR</p>\n\n<pre><code>gem install bundler -v 2.0.2\n</code></pre>\n\n<p>If you have bundler version 2 already installed locally or just installed it, then you need to simply install an update for RubyGems Package Manager locally. To do this, run</p>\n\n<pre><code>gem update --system\n</code></pre>\n\n<p>And then finally run</p>\n\n<pre><code>bundler update --bundler\n</code></pre>\n\n<p>That's all.</p>\n\n<p>I hope this helps.</p>\n"}], "owner": {"reputation": 3429, "user_id": 1414327, "user_type": "registered", "accept_rate": 47, "profile_image": "https://i.stack.imgur.com/xcgRQ.jpg?s=128&g=1", "display_name": "Asnad Atta", "link": "https://stackoverflow.com/users/1414327/asnad-atta"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 50, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1567595206, "creation_date": 1567591203, "question_id": 57786027, "link": "https://stackoverflow.com/questions/57786027/heroku-deployment-error-you-must-use-bundler-2-or-greater-with-this-lockfile", "title": "Heroku deployment error You must use Bundler 2 or greater with this lockfile", "body": "<p>I have rails 6 app and trying to deploy it on heroku but getting error. Here is the log</p>\n\n<pre><code>Counting objects: 403, done.\nDelta compression using up to 4 threads.\nCompressing objects: 100% (156/156), done.\nWriting objects: 100% (403/403), 101.26 KiB | 9.21 MiB/s, done.\nTotal 403 (delta 230), reused 392 (delta 223)\nremote: Compressing source files... done.\nremote: Building source:\nremote: \nremote: -----&gt; Ruby app detected\nremote: \nremote:  !\nremote:  !     You must use Bundler 2 or greater with this lockfile.\nremote:  !\nremote: /tmp/d20190904-93-1wr93w9/bundler-1.15.2/gems/bundler-1.15.2/lib/bundler/lockfile_parser.rb:108:in `warn_for_outdated_bundler_version': You must use Bundler 2 or greater with this lockfile. (Bundler::LockfileError)\nremote:   from /tmp/d20190904-93-1wr93w9/bundler-1.15.2/gems/bundler-1.15.2/lib/bundler/lockfile_parser.rb:95:in `initialize'\nremote:   from /app/tmp/buildpacks/b7af5642714be4eddaa5f35e2b4c36176b839b4abcd9bfe57ee71c358d71152b4fd2cf925c5b6e6816adee359c4f0f966b663a7f8649b0729509d510091abc07/lib/language_pack/helpers/bundler_wrapper.rb:179:in `new'\nremote:   from /app/tmp/buildpacks/b7af5642714be4eddaa5f35e2b4c36176b839b4abcd9bfe57ee71c358d71152b4fd2cf925c5b6e6816adee359c4f0f966b663a7f8649b0729509d510091abc07/lib/language_pack/helpers/bundler_wrapper.rb:179:in `block in parse_gemfile_lock'\nremote:   from /app/tmp/buildpacks/b7af5642714be4eddaa5f35e2b4c36176b839b4abcd9bfe57ee71c358d71152b4fd2cf925c5b6e6816adee359c4f0f966b663a7f8649b0729509d510091abc07/lib/language_pack/instrument.rb:18:in `block (2 levels) in instrument'\nremote:   from /app/tmp/buildpacks/b7af5642714be4eddaa5f35e2b4c36176b839b4abcd9bfe57ee71c358d71152b4fd2cf925c5b6e6816adee359c4f0f966b663a7f8649b0729509d510091abc07/lib/language_pack/instrument.rb:40:in `yield_with_block_depth'\nremote:   from /app/tmp/buildpacks/b7af5642714be4eddaa5f35e2b4c36176b839b4abcd9bfe57ee71c358d71152b4fd2cf925c5b6e6816adee359c4f0f966b663a7f8649b0729509d510091abc07/lib/language_pack/instrument.rb:17:in `block in instrument'\nremote:   from /app/tmp/buildpacks/b7af5642714be4eddaa5f35e2b4c36176b839b4abcd9bfe57ee71c358d71152b4fd2cf925c5b6e6816adee359c4f0f966b663a7f8649b0729509d510091abc07/vendor/ruby/heroku-18/lib/ruby/2.5.0/benchmark.rb:308:in `realtime'\nremote:   from /app/tmp/buildpacks/b7af5642714be4eddaa5f35e2b4c36176b839b4abcd9bfe57ee71c358d71152b4fd2cf925c5b6e6816adee359c4f0f966b663a7f8649b0729509d510091abc07/lib/language_pack/instrument.rb:16:in `instrument'\nremote:   from /app/tmp/buildpacks/b7af5642714be4eddaa5f35e2b4c36176b839b4abcd9bfe57ee71c358d71152b4fd2cf925c5b6e6816adee359c4f0f966b663a7f8649b0729509d510091abc07/lib/language_pack/helpers/bundler_wrapper.rb:135:in `instrument'\nremote:   from /app/tmp/buildpacks/b7af5642714be4eddaa5f35e2b4c36176b839b4abcd9bfe57ee71c358d71152b4fd2cf925c5b6e6816adee359c4f0f966b663a7f8649b0729509d510091abc07/lib/language_pack/helpers/bundler_wrapper.rb:177:in `parse_gemfile_lock'\nremote:   from /app/tmp/buildpacks/b7af5642714be4eddaa5f35e2b4c36176b839b4abcd9bfe57ee71c358d71152b4fd2cf925c5b6e6816adee359c4f0f966b663a7f8649b0729509d510091abc07/lib/language_pack/helpers/bundler_wrapper.rb:161:in `lockfile_parser'\nremote:   from /app/tmp/buildpacks/b7af5642714be4eddaa5f35e2b4c36176b839b4abcd9bfe57ee71c358d71152b4fd2cf925c5b6e6816adee359c4f0f966b663a7f8649b0729509d510091abc07/lib/language_pack/helpers/bundler_wrapper.rb:119:in `specs'\nremote:   from /app/tmp/buildpacks/b7af5642714be4eddaa5f35e2b4c36176b839b4abcd9bfe57ee71c358d71152b4fd2cf925c5b6e6816adee359c4f0f966b663a7f8649b0729509d510091abc07/lib/language_pack/helpers/bundler_wrapper.rb:104:in `block in gem_version'\nremote:   from /app/tmp/buildpacks/b7af5642714be4eddaa5f35e2b4c36176b839b4abcd9bfe57ee71c358d71152b4fd2cf925c5b6e6816adee359c4f0f966b663a7f8649b0729509d510091abc07/lib/language_pack/instrument.rb:18:in `block (2 levels) in instrument'\nremote:   from /app/tmp/buildpacks/b7af5642714be4eddaa5f35e2b4c36176b839b4abcd9bfe57ee71c358d71152b4fd2cf925c5b6e6816adee359c4f0f966b663a7f8649b0729509d510091abc07/lib/language_pack/instrument.rb:40:in `yield_with_block_depth'\nremote:   from /app/tmp/buildpacks/b7af5642714be4eddaa5f35e2b4c36176b839b4abcd9bfe57ee71c358d71152b4fd2cf925c5b6e6816adee359c4f0f966b663a7f8649b0729509d510091abc07/lib/language_pack/instrument.rb:17:in `block in instrument'\nremote:   from /app/tmp/buildpacks/b7af5642714be4eddaa5f35e2b4c36176b839b4abcd9bfe57ee71c358d71152b4fd2cf925c5b6e6816adee359c4f0f966b663a7f8649b0729509d510091abc07/vendor/ruby/heroku-18/lib/ruby/2.5.0/benchmark.rb:308:in `realtime'\nremote:   from /app/tmp/buildpacks/b7af5642714be4eddaa5f35e2b4c36176b839b4abcd9bfe57ee71c358d71152b4fd2cf925c5b6e6816adee359c4f0f966b663a7f8649b0729509d510091abc07/lib/language_pack/instrument.rb:16:in `instrument'\nremote:   from /app/tmp/buildpacks/b7af5642714be4eddaa5f35e2b4c36176b839b4abcd9bfe57ee71c358d71152b4fd2cf925c5b6e6816adee359c4f0f966b663a7f8649b0729509d510091abc07/lib/language_pack/helpers/bundler_wrapper.rb:135:in `instrument'\nremote:   from /app/tmp/buildpacks/b7af5642714be4eddaa5f35e2b4c36176b839b4abcd9bfe57ee71c358d71152b4fd2cf925c5b6e6816adee359c4f0f966b663a7f8649b0729509d510091abc07/lib/language_pack/helpers/bundler_wrapper.rb:103:in `gem_version'\nremote:   from /app/tmp/buildpacks/b7af5642714be4eddaa5f35e2b4c36176b839b4abcd9bfe57ee71c358d71152b4fd2cf925c5b6e6816adee359c4f0f966b663a7f8649b0729509d510091abc07/lib/language_pack/rails6.rb:9:in `block in use?'\nremote:   from /app/tmp/buildpacks/b7af5642714be4eddaa5f35e2b4c36176b839b4abcd9bfe57ee71c358d71152b4fd2cf925c5b6e6816adee359c4f0f966b663a7f8649b0729509d510091abc07/lib/language_pack/instrument.rb:18:in `block (2 levels) in instrument'\nremote:   from /app/tmp/buildpacks/b7af5642714be4eddaa5f35e2b4c36176b839b4abcd9bfe57ee71c358d71152b4fd2cf925c5b6e6816adee359c4f0f966b663a7f8649b0729509d510091abc07/lib/language_pack/instrument.rb:40:in `yield_with_block_depth'\nremote:   from /app/tmp/buildpacks/b7af5642714be4eddaa5f35e2b4c36176b839b4abcd9bfe57ee71c358d71152b4fd2cf925c5b6e6816adee359c4f0f966b663a7f8649b0729509d510091abc07/lib/language_pack/instrument.rb:17:in `block in instrument'\nremote:   from /app/tmp/buildpacks/b7af5642714be4eddaa5f35e2b4c36176b839b4abcd9bfe57ee71c358d71152b4fd2cf925c5b6e6816adee359c4f0f966b663a7f8649b0729509d510091abc07/vendor/ruby/heroku-18/lib/ruby/2.5.0/benchmark.rb:308:in `realtime'\nremote:   from /app/tmp/buildpacks/b7af5642714be4eddaa5f35e2b4c36176b839b4abcd9bfe57ee71c358d71152b4fd2cf925c5b6e6816adee359c4f0f966b663a7f8649b0729509d510091abc07/lib/language_pack/instrument.rb:16:in `instrument'\nremote:   from /app/tmp/buildpacks/b7af5642714be4eddaa5f35e2b4c36176b839b4abcd9bfe57ee71c358d71152b4fd2cf925c5b6e6816adee359c4f0f966b663a7f8649b0729509d510091abc07/lib/language_pack/base.rb:48:in `instrument'\nremote:   from /app/tmp/buildpacks/b7af5642714be4eddaa5f35e2b4c36176b839b4abcd9bfe57ee71c358d71152b4fd2cf925c5b6e6816adee359c4f0f966b663a7f8649b0729509d510091abc07/lib/language_pack/rails6.rb:8:in `use?'\nremote:   from /app/tmp/buildpacks/b7af5642714be4eddaa5f35e2b4c36176b839b4abcd9bfe57ee71c358d71152b4fd2cf925c5b6e6816adee359c4f0f966b663a7f8649b0729509d510091abc07/lib/language_pack.rb:17:in `block (2 levels) in detect'\nremote:   from /app/tmp/buildpacks/b7af5642714be4eddaa5f35e2b4c36176b839b4abcd9bfe57ee71c358d71152b4fd2cf925c5b6e6816adee359c4f0f966b663a7f8649b0729509d510091abc07/lib/language_pack.rb:16:in `each'\nremote:   from /app/tmp/buildpacks/b7af5642714be4eddaa5f35e2b4c36176b839b4abcd9bfe57ee71c358d71152b4fd2cf925c5b6e6816adee359c4f0f966b663a7f8649b0729509d510091abc07/lib/language_pack.rb:16:in `detect'\nremote:   from /app/tmp/buildpacks/b7af5642714be4eddaa5f35e2b4c36176b839b4abcd9bfe57ee71c358d71152b4fd2cf925c5b6e6816adee359c4f0f966b663a7f8649b0729509d510091abc07/lib/language_pack.rb:16:in `block in detect'\nremote:   from /app/tmp/buildpacks/b7af5642714be4eddaa5f35e2b4c36176b839b4abcd9bfe57ee71c358d71152b4fd2cf925c5b6e6816adee359c4f0f966b663a7f8649b0729509d510091abc07/lib/language_pack/instrument.rb:18:in `block (2 levels) in instrument'\nremote:   from /app/tmp/buildpacks/b7af5642714be4eddaa5f35e2b4c36176b839b4abcd9bfe57ee71c358d71152b4fd2cf925c5b6e6816adee359c4f0f966b663a7f8649b0729509d510091abc07/lib/language_pack/instrument.rb:40:in `yield_with_block_depth'\nremote:   from /app/tmp/buildpacks/b7af5642714be4eddaa5f35e2b4c36176b839b4abcd9bfe57ee71c358d71152b4fd2cf925c5b6e6816adee359c4f0f966b663a7f8649b0729509d510091abc07/lib/language_pack/instrument.rb:17:in `block in instrument'\nremote:   from /app/tmp/buildpacks/b7af5642714be4eddaa5f35e2b4c36176b839b4abcd9bfe57ee71c358d71152b4fd2cf925c5b6e6816adee359c4f0f966b663a7f8649b0729509d510091abc07/vendor/ruby/heroku-18/lib/ruby/2.5.0/benchmark.rb:308:in `realtime'\nremote:   from /app/tmp/buildpacks/b7af5642714be4eddaa5f35e2b4c36176b839b4abcd9bfe57ee71c358d71152b4fd2cf925c5b6e6816adee359c4f0f966b663a7f8649b0729509d510091abc07/lib/language_pack/instrument.rb:16:in `instrument'\nremote:   from /app/tmp/buildpacks/b7af5642714be4eddaa5f35e2b4c36176b839b4abcd9bfe57ee71c358d71152b4fd2cf925c5b6e6816adee359c4f0f966b663a7f8649b0729509d510091abc07/lib/language_pack.rb:13:in `detect'\nremote:   from /app/tmp/buildpacks/b7af5642714be4eddaa5f35e2b4c36176b839b4abcd9bfe57ee71c358d71152b4fd2cf925c5b6e6816adee359c4f0f966b663a7f8649b0729509d510091abc07/bin/support/ruby_compile:17:in `block in &lt;main&gt;'\nremote:   from /app/tmp/buildpacks/b7af5642714be4eddaa5f35e2b4c36176b839b4abcd9bfe57ee71c358d71152b4fd2cf925c5b6e6816adee359c4f0f966b663a7f8649b0729509d510091abc07/lib/language_pack/instrument.rb:35:in `block in trace'\nremote:   from /app/tmp/buildpacks/b7af5642714be4eddaa5f35e2b4c36176b839b4abcd9bfe57ee71c358d71152b4fd2cf925c5b6e6816adee359c4f0f966b663a7f8649b0729509d510091abc07/lib/language_pack/instrument.rb:18:in `block (2 levels) in instrument'\nremote:   from /app/tmp/buildpacks/b7af5642714be4eddaa5f35e2b4c36176b839b4abcd9bfe57ee71c358d71152b4fd2cf925c5b6e6816adee359c4f0f966b663a7f8649b0729509d510091abc07/lib/language_pack/instrument.rb:40:in `yield_with_block_depth'\nremote:   from /app/tmp/buildpacks/b7af5642714be4eddaa5f35e2b4c36176b839b4abcd9bfe57ee71c358d71152b4fd2cf925c5b6e6816adee359c4f0f966b663a7f8649b0729509d510091abc07/lib/language_pack/instrument.rb:17:in `block in instrument'\nremote:   from /app/tmp/buildpacks/b7af5642714be4eddaa5f35e2b4c36176b839b4abcd9bfe57ee71c358d71152b4fd2cf925c5b6e6816adee359c4f0f966b663a7f8649b0729509d510091abc07/vendor/ruby/heroku-18/lib/ruby/2.5.0/benchmark.rb:308:in `realtime'\nremote:   from /app/tmp/buildpacks/b7af5642714be4eddaa5f35e2b4c36176b839b4abcd9bfe57ee71c358d71152b4fd2cf925c5b6e6816adee359c4f0f966b663a7f8649b0729509d510091abc07/lib/language_pack/instrument.rb:16:in `instrument'\nremote:   from /app/tmp/buildpacks/b7af5642714be4eddaa5f35e2b4c36176b839b4abcd9bfe57ee71c358d71152b4fd2cf925c5b6e6816adee359c4f0f966b663a7f8649b0729509d510091abc07/lib/language_pack/instrument.rb:35:in `trace'\nremote:   from /app/tmp/buildpacks/b7af5642714be4eddaa5f35e2b4c36176b839b4abcd9bfe57ee71c358d71152b4fd2cf925c5b6e6816adee359c4f0f966b663a7f8649b0729509d510091abc07/bin/support/ruby_compile:15:in `&lt;main&gt;'\nremote:  !     Push rejected, failed to compile Ruby app.\nremote: \nremote:  !     Push failed\nremote: Verifying deploy...\nremote: \nremote: ! Push rejected to evmvp.\nremote: \nTo https://git.heroku.com/evmvp.git\n ! [remote rejected] master -&gt; master (pre-receive hook declined)\nerror: failed to push some refs to 'https://git.heroku.com/evmvp.git'\n</code></pre>\n\n<p>I tried <code>heroku buildpacks:set https://github.com/bundler/heroku-buildpack-bundler2</code> I get <code>Error: The buildpack https://github.com/bundler/heroku-buildpack-bundler2 is already set on your app</code>\nWhat am I doing wrong? Let me know if I need to add anything else.</p>\n"}, {"tags": ["javascript", "ruby-on-rails", "ruby", "capybara", "integration-testing"], "comments": [{"owner": {"reputation": 176, "user_id": 10320701, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SkyZ2.jpg?s=128&g=1", "display_name": "Gabriele Magno", "link": "https://stackoverflow.com/users/10320701/gabriele-magno"}, "edited": false, "score": 0, "creation_date": 1567588738, "post_id": 57785166, "comment_id": 102004039, "body": "it seems that the link to the JS file is not done properly. can you post a screenshot with the folder structure and the path from your HTML index file to the JS file itself?"}, {"owner": {"reputation": 599, "user_id": 11544569, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xEqDN.jpg?s=128&g=1", "display_name": "RomanOks", "link": "https://stackoverflow.com/users/11544569/romanoks"}, "reply_to_user": {"reputation": 176, "user_id": 10320701, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SkyZ2.jpg?s=128&g=1", "display_name": "Gabriele Magno", "link": "https://stackoverflow.com/users/10320701/gabriele-magno"}, "edited": false, "score": 0, "creation_date": 1567589549, "post_id": 57785166, "comment_id": 102004508, "body": "@GabrieleMagno But js connects in the developer environment when I start the server. Does this mean that the file is referenced correctly? I also tried to write js code directly in the application.js file. In the application itself, the code works. But it doesn\u2019t work in tests."}], "answers": [{"tags": [], "owner": {"reputation": 599, "user_id": 11544569, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xEqDN.jpg?s=128&g=1", "display_name": "RomanOks", "link": "https://stackoverflow.com/users/11544569/romanoks"}, "is_accepted": false, "score": 1, "last_activity_date": 1567590769, "creation_date": 1567590769, "answer_id": 57785887, "question_id": 57785166, "link": "https://stackoverflow.com/questions/57785166/why-js-from-a-file-in-tests-does-not-work/57785887#57785887", "title": "Why js from a file in tests does not work?", "body": "<p><strong>This was due to precompile assets.</strong> \nI deleted the public/assets folder, where I had old compiled js files.</p>\n"}], "owner": {"reputation": 599, "user_id": 11544569, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xEqDN.jpg?s=128&g=1", "display_name": "RomanOks", "link": "https://stackoverflow.com/users/11544569/romanoks"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 44, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1567590769, "creation_date": 1567588303, "question_id": 57785166, "link": "https://stackoverflow.com/questions/57785166/why-js-from-a-file-in-tests-does-not-work", "title": "Why js from a file in tests does not work?", "body": "<p>I have a small test to check the appearance of an select by pressing the checkbox.</p>\n\n<p>The js code is in a separate file. If start the server and check manually, everything works.</p>\n\n<p>I also include this file in application.js</p>\n\n<p>But in the test this file is not connected.</p>\n\n<p><strong>If I insert js code directly into the html code, then everything works again.</strong></p>\n\n<p>My js file:</p>\n\n<pre><code>$(document).on('ready', function() {\n  $('#checkme').on('change', function(e) {\n    if ($(this).is(':checked')) {\n      $('#interval').css('display', 'block');\n    } else {\n      $('#interval').css('display', 'none');\n    }\n  })\n});\n</code></pre>\n\n<p>My test:</p>\n\n<pre><code>assert_not page.has_select?(:interval) #true\npage.check('Checkme')                 #true\npage.save_and_open_screenshot(full: true) #screenshot\nassert page.has_select?(:interval) #false\n</code></pre>\n\n<p>In the screenshot I received, I see that the checkbox is active, but js does not work.</p>\n"}, {"tags": ["sql", "ruby", "postgresql"], "comments": [{"owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 5, "creation_date": 1567580970, "post_id": 57783087, "comment_id": 102000067, "body": "Did you consider using an ORM like <a href=\"https://github.com/rails/rails/tree/v6.0.0/activerecord\" rel=\"nofollow noreferrer\">ActiveRecord</a> or <a href=\"https://github.com/jeremyevans/sequel\" rel=\"nofollow noreferrer\">Sequel</a>? There are extremely helpful when it comes to build SQL queries and to sanitize them against SQL injection."}], "answers": [{"comments": [{"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1567582714, "post_id": 57783203, "comment_id": 102000923, "body": "Adding the quotes to the separator seems a bit dirty. You should escape each value separately (according to the query syntax) and then join the results."}], "tags": [], "owner": {"reputation": 1088, "user_id": 7122016, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/SaEq7.jpg?s=128&g=1", "display_name": "eibersji", "link": "https://stackoverflow.com/users/7122016/eibersji"}, "is_accepted": false, "score": -1, "last_activity_date": 1567580981, "creation_date": 1567580981, "answer_id": 57783203, "question_id": 57783087, "link": "https://stackoverflow.com/questions/57783087/how-to-insert-an-array-of-strings-to-sql-query-in-ruby/57783203#57783203", "title": "how to insert an array of strings to sql query in ruby", "body": "<p>I got it.\nI added single quotes to <code>('#{context.codes.join(\"','\")}')</code></p>\n"}, {"comments": [{"owner": {"reputation": 48413, "user_id": 1279683, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1veuT.jpg?s=128&g=1", "display_name": "Marek Lipka", "link": "https://stackoverflow.com/users/1279683/marek-lipka"}, "edited": false, "score": 1, "creation_date": 1567581252, "post_id": 57783220, "comment_id": 102000219, "body": "I guess in this case, where the programmer has full control of what&#39;s stored in <code>context.codes</code>, it isn&#39;t that crucial. But it&#39;s a good practice nevertheless."}], "tags": [], "owner": {"reputation": 167912, "user_id": 240443, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/495d675e3bc42ed1dee469e2ce701f1b?s=128&d=identicon&r=PG", "display_name": "Amadan", "link": "https://stackoverflow.com/users/240443/amadan"}, "is_accepted": true, "score": 8, "last_activity_date": 1567581046, "creation_date": 1567581046, "answer_id": 57783220, "question_id": 57783087, "link": "https://stackoverflow.com/questions/57783087/how-to-insert-an-array-of-strings-to-sql-query-in-ruby/57783220#57783220", "title": "how to insert an array of strings to sql query in ruby", "body": "<p>Don't do that. <a href=\"https://bobby-tables.com/\" rel=\"noreferrer\">Bobby Tables</a> is watching. Instead, provide the adequate number of placeholders:</p>\n\n<pre><code>sql = \"SELECT variants.id,\n                      code,\n                      regular_price,\n                      price_before_sale\n                FROM  variants\n                WHERE variants.code IN (#{context.codes.map { \"?\" }.join(\",\")})\"\n</code></pre>\n\n<p>and then provide <code>*context.codes</code> in statement parameters.</p>\n"}], "owner": {"reputation": 1088, "user_id": 7122016, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/SaEq7.jpg?s=128&g=1", "display_name": "eibersji", "link": "https://stackoverflow.com/users/7122016/eibersji"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 86, "favorite_count": 0, "accepted_answer_id": 57783220, "answer_count": 2, "score": 0, "last_activity_date": 1567581046, "creation_date": 1567580485, "last_edit_date": 1567580835, "question_id": 57783087, "link": "https://stackoverflow.com/questions/57783087/how-to-insert-an-array-of-strings-to-sql-query-in-ruby", "title": "how to insert an array of strings to sql query in ruby", "body": "<p>I have this query in ruby: </p>\n\n<pre><code>  sql = \"SELECT variants.id,\n                      code,\n                      regular_price,\n                      price_before_sale\n                FROM  variants\n                WHERE variants.code IN (#{context.codes.join(\",\")})\"\n</code></pre>\n\n<p>where <code>context.codes = ['PRDCT-1','PRDCT-2']</code></p>\n\n<p>now context.codes becomes <code>(PRDCT1,PRDCT2)</code> inside the sql query because of the <code>.join</code> but what I want to happen is <code>('PRDCT1','PRDCT2')</code> what am I missing? </p>\n\n<p>EDI: I have tried to do <code>(#{context.codes.join(\"','\")})</code> but it returns <code>(PRDCT1','PRDCT2)</code></p>\n"}, {"tags": ["ruby", "ruby-on-rails-5"], "answers": [{"comments": [{"owner": {"reputation": 329, "user_id": 1919995, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/59f2e666102af47b6d8e989f7f435327?s=128&d=identicon&r=PG", "display_name": "Muhammad Yaseen", "link": "https://stackoverflow.com/users/1919995/muhammad-yaseen"}, "edited": false, "score": 0, "creation_date": 1567579028, "post_id": 57782351, "comment_id": 101999296, "body": "Thanks for your reply. I just edited by adding picture for clear understanding."}, {"owner": {"reputation": 48413, "user_id": 1279683, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1veuT.jpg?s=128&g=1", "display_name": "Marek Lipka", "link": "https://stackoverflow.com/users/1279683/marek-lipka"}, "reply_to_user": {"reputation": 329, "user_id": 1919995, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/59f2e666102af47b6d8e989f7f435327?s=128&d=identicon&r=PG", "display_name": "Muhammad Yaseen", "link": "https://stackoverflow.com/users/1919995/muhammad-yaseen"}, "edited": false, "score": 0, "creation_date": 1567584115, "post_id": 57782351, "comment_id": 102001596, "body": "Ok, so what you need in admin view is grouping <code>Amol361</code> records by user, right?"}, {"owner": {"reputation": 48413, "user_id": 1279683, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1veuT.jpg?s=128&g=1", "display_name": "Marek Lipka", "link": "https://stackoverflow.com/users/1279683/marek-lipka"}, "reply_to_user": {"reputation": 329, "user_id": 1919995, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/59f2e666102af47b6d8e989f7f435327?s=128&d=identicon&r=PG", "display_name": "Muhammad Yaseen", "link": "https://stackoverflow.com/users/1919995/muhammad-yaseen"}, "edited": false, "score": 0, "creation_date": 1568009075, "post_id": 57782351, "comment_id": 102123981, "body": "So why don&#39;t you fetch users including <code>amol361s</code> in correct order, and then, in view, do something like <code>&lt;% @users.each do |user| %&gt;</code> and inside of it <code>&lt;%= user.amol361s.each do |amol361| %&gt;</code>?"}, {"owner": {"reputation": 329, "user_id": 1919995, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/59f2e666102af47b6d8e989f7f435327?s=128&d=identicon&r=PG", "display_name": "Muhammad Yaseen", "link": "https://stackoverflow.com/users/1919995/muhammad-yaseen"}, "edited": false, "score": 0, "creation_date": 1572246763, "post_id": 57782351, "comment_id": 103487229, "body": "Thanks for the reply. Actually I was on vacation so the reason for the late reply. And I tried with the above code in my index view but it throws me the error as &quot;undefined method `amol361s&#39; for #&lt;User::ActiveRecord_Relation:0x00007f5de88d0250&gt;&quot; and In my controller I placed the code as &quot;@amol361s = Amol361.all.search(params[:search]).order(&quot;created_at ASC&quot;)       and @users = User.all.amol361s&quot; . Waiting for your reply."}, {"owner": {"reputation": 329, "user_id": 1919995, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/59f2e666102af47b6d8e989f7f435327?s=128&d=identicon&r=PG", "display_name": "Muhammad Yaseen", "link": "https://stackoverflow.com/users/1919995/muhammad-yaseen"}, "edited": false, "score": 0, "creation_date": 1573554824, "post_id": 57782351, "comment_id": 103911250, "body": "undefined method amol361s&#39; for # User::ActiveRecord_Relation:0x00007f5dec19d088."}, {"owner": {"reputation": 329, "user_id": 1919995, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/59f2e666102af47b6d8e989f7f435327?s=128&d=identicon&r=PG", "display_name": "Muhammad Yaseen", "link": "https://stackoverflow.com/users/1919995/muhammad-yaseen"}, "edited": false, "score": 0, "creation_date": 1573554850, "post_id": 57782351, "comment_id": 103911258, "body": "Errors says undefined method"}, {"owner": {"reputation": 89316, "user_id": 238886, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/8ca29123b5669b26f9b6ca2c62d9d215?s=128&d=identicon&r=PG", "display_name": "Wayne Conrad", "link": "https://stackoverflow.com/users/238886/wayne-conrad"}, "edited": false, "score": 0, "creation_date": 1573565150, "post_id": 57782351, "comment_id": 103916627, "body": "The error you are getting is not caused by the code in this answer.  You&#39;ll need to debug that error yourself."}], "tags": [], "owner": {"reputation": 48413, "user_id": 1279683, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1veuT.jpg?s=128&g=1", "display_name": "Marek Lipka", "link": "https://stackoverflow.com/users/1279683/marek-lipka"}, "is_accepted": false, "score": 0, "last_activity_date": 1567577071, "creation_date": 1567577071, "answer_id": 57782351, "question_id": 57782051, "link": "https://stackoverflow.com/questions/57782051/grouping-records-by-user-in-admin-view/57782351#57782351", "title": "Grouping records by user in Admin view", "body": "<p>From what I understand, you can simply eager load user records if the current user is admin, like this:</p>\n\n<pre><code>@amol361s = Amol361.includes(:user).search(params[:search]).order(\"created_at ASC\")\n</code></pre>\n\n<p>If you do this, it will be effective to fetch the user data simply by calling association on each member of this relation, like this:</p>\n\n<pre><code># example:\n@amol361s.first.user.username # or whatever the name of username column is\n</code></pre>\n\n<p>I'm not sure I understood your question correctly though, cause it's a little bit unclear to me. </p>\n"}], "owner": {"reputation": 329, "user_id": 1919995, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/59f2e666102af47b6d8e989f7f435327?s=128&d=identicon&r=PG", "display_name": "Muhammad Yaseen", "link": "https://stackoverflow.com/users/1919995/muhammad-yaseen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 92, "favorite_count": 0, "answer_count": 1, "score": -3, "last_activity_date": 1573556911, "creation_date": 1567575249, "last_edit_date": 1573556911, "question_id": 57782051, "link": "https://stackoverflow.com/questions/57782051/grouping-records-by-user-in-admin-view", "title": "Grouping records by user in Admin view", "body": "<p>I would like to get all records with their usernames when signed in as Admin. For that my controller code is as below;</p>\n\n<p>amol361s_controller.rb</p>\n\n<pre><code>    def index\n\n        if current_user.admin\n          @amol361s = Amol361.all.search(params[:search]).order(\"created_at ASC\")\n          @users = User.all.amol361s\n        else\n          @amol361s = current_user.amol361s.all.search(params[:search]).visible.order(\"created_at ASC\") \n        end\n\n        respond_to do |format|\n          format.html\n          format.js\n        end\n\n    end\n</code></pre>\n\n<p>index.html.erb</p>\n\n<pre><code>&lt;tbody id = \"kola\"&gt;              \n&lt;% @users.each do |user| %&gt;\n&lt;%= user.amol361s.each do |amol361| %&gt;\n\n&lt;tr class=\"tr-&lt;%= cycle('odd', 'even') %&gt;\" id='&lt;%= \"tr_#{amol361.id}\" %&gt;'&gt;\n\n\n&lt;% if current_user &amp;&amp; current_user.admin %&gt;\n&lt;td class=\"col-1\"&gt;&lt;%= link_to amol361.date.try(:strftime,'%d/%m/%Y'), edit_amol361_path(amol361) %&gt;&lt;/td&gt;\n&lt;% else %&gt;\n&lt;td class=\"col-1\"&gt;&lt;%= amol361.date.try(:strftime,'%d/%m/%Y') %&gt;&lt;/td&gt;\n&lt;% end %&gt;\n\n&lt;td class=\"col-3\"&gt;&lt;%= span_with_possibly_red_color amol361.description %&gt;&lt;/td&gt;\n\n\n&lt;td class=\"col-1\"&gt;&lt;%= number_with_precision(amol361.amount, :delimiter =&gt; \",\", :precision =&gt; 2) %&gt;&lt;/td&gt;\n\n&lt;td class=\"col-1 neg\"&gt;&lt;%= number_with_precision(amol361.discount, :delimiter =&gt; \",\", :precision =&gt; 2) %&gt;&lt;/td&gt;\n\n&lt;td class=\"col-1 neg\"&gt;&lt;%= number_with_precision(amol361.paid, :delimiter =&gt; \",\", :precision =&gt; 2) %&gt;&lt;/td&gt;\n\n\n&lt;% @balance += amol361.amount.to_f - amol361.discount.to_f - amol361.paid.to_f %&gt;\n\n&lt;% color = @balance &gt;= 0 ? \"pos\" : \"neg\" %&gt;\n\n&lt;td class=\"col-1 &lt;%= color %&gt;\"&gt;&lt;%= number_with_precision(@balance.abs, :delimiter =&gt; \",\", :precision =&gt; 0) %&gt;&lt;/td&gt;\n\n&lt;td class=\"col-1\"&gt;&lt;%= amol361.delndel %&gt;&lt;/td&gt;\n\n&lt;td class=\"col-1\"&gt;&lt;%= amol361.remark %&gt;&lt;/td&gt;\n\n&lt;% if current_user &amp;&amp; current_user.admin %&gt;\n&lt;td class=\"col-1\"&gt;&lt;%= link_to \"Hide\", hide_amol361_path(amol361), method: :put, remote: true, style: \"color:#bb7272;\" %&gt;\n&lt;%= link_to amol361, method: :delete, data: { confirm: \"Are you sure?\" }, :class =&gt; 'delete_item' do %&gt;\n&lt;i class=\"fa fa-trash\" &gt;&lt;/i&gt;\n&lt;% end %&gt;\n&lt;/td&gt;\n&lt;% end %&gt;\n\n&lt;/tr&gt;\n\n&lt;% end %&gt;\n&lt;% end %&gt;\n\n\n&lt;/tbody&gt;\n</code></pre>\n\n<p>Right now I am getting the error as <strong>undefined method amol361s' for # User::ActiveRecord_Relation:0x00007f5dec19d088</strong>.</p>\n\n<p>So, I am trying to get the records followed by usernames, similar to how we gather records based on month.</p>\n\n<p><a href=\"https://i.stack.imgur.com/CAt14.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/CAt14.png\" alt=\"myimage.png\"></a></p>\n\n<p>Any suggestions are most welcome.</p>\n\n<p>Thank you in advance.</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 303, "user_id": 9479253, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cd34f4996365a59ad414df6950d6d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ashok Damaniya", "link": "https://stackoverflow.com/users/9479253/ashok-damaniya"}, "edited": false, "score": 0, "creation_date": 1567573119, "post_id": 57781588, "comment_id": 101997445, "body": "i suggest you should use nested form , here issue in <b>form.text_area :answer</b> this line because it does not have any index bind with it , it will only submit the last value it found in the form, you should bind index with it and use nested form for achieve your functionality , good luck"}], "owner": {"reputation": 11, "user_id": 12017657, "user_type": "registered", "profile_image": "https://graph.facebook.com/2513028078743041/picture?type=large", "display_name": "Jack Moore", "link": "https://stackoverflow.com/users/12017657/jack-moore"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 58, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1567571955, "creation_date": 1567571955, "question_id": 57781588, "link": "https://stackoverflow.com/questions/57781588/how-to-submit-input-from-a-dynamically-generated-form", "title": "How to submit input from a dynamically generated form?", "body": "<p>I have been tasked with designing an application using Ruby on Rails which allows a business to sign up and then create a question form for users to answer who wish to volunteer doing whatever it may be with that business.\nMy issue is how can I save each of the users answers to the database once they submit the form. Because I am generating the questions form dynamically (as the amount of questions will vary) each answer has the same label and on form submission only the final answer is saved to the database.\nStill fairly new to ruby and I've been looking all over but can't find a solution.</p>\n\n<p>Here is my show.html.erb file that displays the form to the user.</p>\n\n<pre><code>&lt;%=form_with(model: [ @user, @user.user_questions.build ], local: true) do |form| %&gt;\n&lt;% @organisation.questions.each.with_index do |questions, i| %&gt;\n    &lt;h3&gt;Question &lt;%= i+1 %&gt;&lt;/h3&gt;\n    &lt;p&gt; \n        &lt;%= questions.question %&gt;\n    &lt;/p&gt;\n        &lt;p&gt;\n            &lt;%= form.text_area :answer %&gt;\n        &lt;/p&gt;\n        &lt;p style=visibility: hidden&gt;\n            &lt;%= form.text_field :organisation_id, value: @organisation.id %&gt;\n        &lt;/p&gt;\n        &lt;p style=visibility: hidden&gt;\n            &lt;%= form.text_field :create_account_id, value: @user.id %&gt;\n        &lt;/p&gt;\n        &lt;p style=visibility: hidden&gt;\n            &lt;%= form.text_field :question_id, value: questions.id %&gt;\n        &lt;/p&gt;\n        &lt;p style=visibility: hidden&gt;\n            &lt;%= form.text_field :name, value: @user.username %&gt;\n        &lt;/p&gt;\n    &lt;% end %&gt;\n    &lt;p&gt;\n        &lt;%= form.submit \"Submit Answers\"%&gt;\n    &lt;/p&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>This is my controller for handling the form</p>\n\n<pre><code>    def show\n        @organisation = Organisation.find(params[:id])\n        @user = CreateAccount.find(params[:create_account_id])\n    end\n\n    def create\n        @user = CreateAccount.find(params[:create_account_id])\n        @answers = @user.user_questions.create(answer_params)\n\n        if @answers.save\n            redirect_to @user\n        else\n            render 'show'\n        end\n    end\n\n    private\n        def answer_params\n            params.require(:user_question).permit(\n                        :answer, \n                        :name,\n                        :organisation_id, \n                        :create_account_id, \n                        :question_id)\n        end\nend\n</code></pre>\n\n<p>The actual result of form submission is always the very last input being saved to the database.</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1567579131, "post_id": 57781399, "comment_id": 101999333, "body": "<i>&quot;I have the next issue [...]&quot;</i> \u2013 it this a follow-up question? If so, please provide a link to the previous one."}, {"owner": {"reputation": 167912, "user_id": 240443, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/495d675e3bc42ed1dee469e2ce701f1b?s=128&d=identicon&r=PG", "display_name": "Amadan", "link": "https://stackoverflow.com/users/240443/amadan"}, "reply_to_user": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 1, "creation_date": 1567580216, "post_id": 57781399, "comment_id": 101999761, "body": "@Stefan: Some languages express &quot;the following&quot; and &quot;the next&quot; with the same expression - it&#39;s likely just a second language issue."}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "reply_to_user": {"reputation": 167912, "user_id": 240443, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/495d675e3bc42ed1dee469e2ce701f1b?s=128&d=identicon&r=PG", "display_name": "Amadan", "link": "https://stackoverflow.com/users/240443/amadan"}, "edited": false, "score": 0, "creation_date": 1567581273, "post_id": 57781399, "comment_id": 102000230, "body": "@Amadan good point!"}, {"owner": {"reputation": 106, "user_id": 5007444, "user_type": "registered", "profile_image": "https://graph.facebook.com/1001289296556449/picture?type=large", "display_name": "SotoArmando", "link": "https://stackoverflow.com/users/5007444/sotoarmando"}, "edited": false, "score": 0, "creation_date": 1567618099, "post_id": 57781399, "comment_id": 102019682, "body": "Am not used to speak English as good as it should be I ll be mind that. :S"}], "answers": [{"tags": [], "owner": {"reputation": 2837, "user_id": 6245337, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8VoQ5.jpg?s=128&g=1", "display_name": "Ana Mar&#237;a Mart&#237;nez G&#243;mez", "link": "https://stackoverflow.com/users/6245337/ana-mar%c3%ada-mart%c3%adnez-g%c3%b3mez"}, "is_accepted": true, "score": 3, "last_activity_date": 1567571044, "creation_date": 1567571044, "answer_id": 57781455, "question_id": 57781399, "link": "https://stackoverflow.com/questions/57781399/ruby-recursion-return-result-issue/57781455#57781455", "title": "Ruby recursion return result issue", "body": "<p>You are returning <code>true</code> or <code>false</code> in the base cases, but the recursive case is wrong. Ruby returns the returned value of the last statement in the method if it doesn't execute an explicit <code>return</code>. In this case the last statement is <code>exact_sum?(k,coins, i + 1)</code>. What I think you want is to return <code>true</code> if any of the recursive parts is true, which would be:</p>\n\n<pre><code>exact_sum?(k-number,coins, i + 1) || exact_sum?(k,coins, i + 1)\n</code></pre>\n"}], "owner": {"reputation": 106, "user_id": 5007444, "user_type": "registered", "profile_image": "https://graph.facebook.com/1001289296556449/picture?type=large", "display_name": "SotoArmando", "link": "https://stackoverflow.com/users/5007444/sotoarmando"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 81, "favorite_count": 0, "accepted_answer_id": 57781455, "answer_count": 1, "score": 1, "last_activity_date": 1567571044, "creation_date": 1567570580, "question_id": 57781399, "link": "https://stackoverflow.com/questions/57781399/ruby-recursion-return-result-issue", "title": "Ruby recursion return result issue", "body": "<p>I have the next issue when am trying to use recursion.</p>\n\n<p>Test Cases</p>\n\n<pre><code>puts exact_sum?(12, [1, 2, 3, 4, 5]) =&gt; true (he finds it true but returns false)\n\n\nputs exact_sum?(11, [1, 5, 9, 13]) =&gt; false\n</code></pre>\n\n<p>The behavior of the function is what I am aiming to do but even if he finds true he always returns false.</p>\n\n<pre><code>def exact_sum?(k, coins, i = 0)\n  if (k == 0) then \n    print \"there is one true #{k}\"\n    return true\n  elsif (i == coins.length)\n    return false\n  end\n  number = coins[i]\n  exact_sum?(k-number,coins, i + 1)\n  exact_sum?(k,coins, i + 1)\nend\n</code></pre>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 2, "creation_date": 1567565504, "post_id": 57780794, "comment_id": 101996141, "body": "This isn&#39;t really a nested hash. It&#39;s an array of hashes."}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1567579234, "post_id": 57780794, "comment_id": 101999375, "body": "<code>(&quot;type&quot; : &quot;Profile&quot;)</code> isn&#39;t valid Ruby syntax."}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 1, "creation_date": 1567579474, "post_id": 57780794, "comment_id": 101999471, "body": "BTW, the quotes around the hash keys are superfluous and pretty misleading \u2013 it makes the keys look like strings. But <code>&quot;id&quot;:</code> is in fact just <code>id:</code>, i.e. a symbol."}, {"owner": {"reputation": 16672, "user_id": 22237, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/hkobD.png?s=128&g=1", "display_name": "Kris", "link": "https://stackoverflow.com/users/22237/kris"}, "edited": false, "score": 0, "creation_date": 1567596027, "post_id": 57780794, "comment_id": 102007894, "body": "If you want String keys you need to do <code>&quot;id&quot; =&gt; &quot;111&quot;</code>."}], "answers": [{"tags": [], "owner": {"reputation": 862, "user_id": 1600046, "user_type": "registered", "accept_rate": 45, "profile_image": "https://i.stack.imgur.com/5rxUl.jpg?s=128&g=1", "display_name": "Vibol", "link": "https://stackoverflow.com/users/1600046/vibol"}, "is_accepted": true, "score": 1, "last_activity_date": 1567565364, "creation_date": 1567565364, "answer_id": 57780867, "question_id": 57780794, "link": "https://stackoverflow.com/questions/57780794/insert-new-key-value-into-nested-hash-in-ruby/57780867#57780867", "title": "Insert new key value into nested hash in Ruby", "body": "<p>You need to construct a new array from your existing:</p>\n\n<pre><code>photos = [{\"id\": \"111\",\"photo\": \"http://photo.com/111.jpeg\"}, {\"id\": \"222\",  \"photo\": \"http://photo.com/222.jpeg\"}]\n\nnew_photos = photos.map do |photo|\n  if photo[:id] == '111'\n    photo.merge(type: 'Profile')\n  else\n    photo\n  end\nend\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 13442, "user_id": 3982562, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2a3c7aae1d762372cda697833c602ec8?s=128&d=identicon&r=PG", "display_name": "3limin4t0r", "link": "https://stackoverflow.com/users/3982562/3limin4t0r"}, "edited": false, "score": 0, "creation_date": 1567609164, "post_id": 57783526, "comment_id": 102015429, "body": "You can also use the alternative syntax <code>h = photos.find { |h| h[:id] == &quot;111&quot; } and h.update(insert_item)</code> which does the same in this scenario."}], "tags": [], "owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "is_accepted": false, "score": 2, "last_activity_date": 1567582345, "creation_date": 1567582345, "answer_id": 57783526, "question_id": 57780794, "link": "https://stackoverflow.com/questions/57780794/insert-new-key-value-into-nested-hash-in-ruby/57783526#57783526", "title": "Insert new key value into nested hash in Ruby", "body": "<p>The question suggests to me that the element <code>h</code> (a hash) of <code>photos</code> for which <code>h[:id] = \"111</code> (if there is one), is to be modified in place by adding the key-value pair <code>:type=&gt;\"Profile\"</code>.</p>\n\n<pre><code>photos = [{\"id\": \"111\", \"photo\": \"http://photo.com/111.jpeg\"},\n          {\"id\": \"222\", \"photo\": \"http://photo.com/222.jpeg\"}]\n\ninsert_item = { \"type\": \"Profile\" }\n</code></pre>\n\n<h1><p></p></h1>\n\n<pre><code>h = photos.find { |h| h[:id] == \"111\" }\nh.update(insert_item) unless h.nil?\nphotos\n  #=&gt; [{:id=&gt;\"111\", :photo=&gt;\"http://photo.com/111.jpeg\", :type=&gt;\"Profile\"},\n  #    {:id=&gt;\"222\", :photo=&gt;\"http://photo.com/222.jpeg\"}]\n</code></pre>\n\n<p>See <a href=\"https://ruby-doc.org/core-2.6.3/Hash.html#method-i-update\" rel=\"nofollow noreferrer\">Hash#update</a> (aka <code>merge!</code>).</p>\n"}, {"tags": [], "owner": {"reputation": 2572, "user_id": 2862049, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffd65bc37e559c2c407f064f308828a4?s=128&d=identicon&r=PG&f=1", "display_name": "Lukas Baliak", "link": "https://stackoverflow.com/users/2862049/lukas-baliak"}, "is_accepted": false, "score": 0, "last_activity_date": 1567587459, "creation_date": 1567587459, "answer_id": 57784928, "question_id": 57780794, "link": "https://stackoverflow.com/questions/57780794/insert-new-key-value-into-nested-hash-in-ruby/57784928#57784928", "title": "Insert new key value into nested hash in Ruby", "body": "<p>You rly dont need to find object or create new <code>Array</code>.\n<code>Hash</code> it self its object and can be updated.</p>\n\n<pre><code>photos = [{\"id\": \"111\",\"photo\": \"http://photo.com/111.jpeg\"}, {\"id\": \"222\",  \"photo\": \"http://photo.com/222.jpeg\"}]\nphotos.each do |hsh|\n  if hsh[:id] == '111'\n    hsh[:type] = 'Profile'\n    break\n  end\nend\nphotos\n# =&gt; [{:id=&gt;\"111\", :photo=&gt;\"http://photo.com/111.jpeg\", :type=&gt;\"Profile\"}, {:id=&gt;\"222\", :photo=&gt;\"http://photo.com/222.jpeg\"}]\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 13442, "user_id": 3982562, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2a3c7aae1d762372cda697833c602ec8?s=128&d=identicon&r=PG", "display_name": "3limin4t0r", "link": "https://stackoverflow.com/users/3982562/3limin4t0r"}, "is_accepted": false, "score": 0, "last_activity_date": 1567610032, "creation_date": 1567610032, "answer_id": 57791334, "question_id": 57780794, "link": "https://stackoverflow.com/questions/57780794/insert-new-key-value-into-nested-hash-in-ruby/57791334#57791334", "title": "Insert new key value into nested hash in Ruby", "body": "<p>If you need to update multiple values from different objects with different ids you could also build a lookup tree. (Assuming there are no duplicate ids.)</p>\n\n<pre><code>photos = [{\"id\": \"111\",\"photo\": \"http://photo.com/111.jpeg\"}, {\"id\": \"222\",  \"photo\": \"http://photo.com/222.jpeg\"}]\nphoto_lookup = photos.map { |photo| [photo[:id], photo] }.to_h\n#=&gt; { \n#   \"111\" =&gt; {\"id\": \"111\",\"photo\": \"http://photo.com/111.jpeg\"},\n#   \"222\" =&gt; {\"id\": \"222\",  \"photo\": \"http://photo.com/222.jpeg\"}\n# }\n</code></pre>\n\n<p>Then simply fetch the photo and update the value.</p>\n\n<pre><code>photo = photo_lookup[\"111\"] and photo.update(type: 'Profile')\n#                            ^ only update photo if it is found\n</code></pre>\n\n<p>This solution mutates the hash, meaning the hash in <code>photos</code> should also be updated.</p>\n"}], "owner": {"reputation": 187, "user_id": 5888706, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/516d587e08a70e8be8fd9362564ad12d?s=128&d=identicon&r=PG&f=1", "display_name": "Kris", "link": "https://stackoverflow.com/users/5888706/kris"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 240, "favorite_count": 0, "accepted_answer_id": 57780867, "answer_count": 4, "score": -1, "last_activity_date": 1567610032, "creation_date": 1567564765, "last_edit_date": 1567587342, "question_id": 57780794, "link": "https://stackoverflow.com/questions/57780794/insert-new-key-value-into-nested-hash-in-ruby", "title": "Insert new key value into nested hash in Ruby", "body": "<p>I am trying to insert a new key/value <code>{ type: 'Profile'}</code> into the photo hash that has id = 111. </p>\n\n<pre><code>photo_hash = [{\"id\": \"111\",\"photo\": \"http://photo.com/111.jpeg\"}, {\"id\": \"222\",  \"photo\": \"http://photo.com/222.jpeg\"}] \n</code></pre>\n\n<p>So the final result should look like:</p>\n\n<pre><code>photo_hash = [{\"id\": \"111\",\"photo\": \"http://photo.com/111.jpeg\", \"type\" : \"Profile\"}, {\"id\": \"222\",  \"photo\": \"http://photo.com/222.jpeg\"}] \n</code></pre>\n\n<p>I feel like this should be pretty straight forward in Ruby but I am very stuck</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "file", "storage", "temporary"], "comments": [{"owner": {"reputation": 268, "user_id": 2338984, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/05ae3478316058f15a307e78b936822a?s=128&d=identicon&r=PG", "display_name": "sig", "link": "https://stackoverflow.com/users/2338984/sig"}, "edited": false, "score": 2, "creation_date": 1567576678, "post_id": 57780137, "comment_id": 101998381, "body": "Active storage looks ok for me. Its designed to work with files. And you need to save  file. Does not matter for how long. You can delete your &quot;temporary&quot; files later with cron or sidekiq or smtn like this."}, {"owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 1, "creation_date": 1567578788, "post_id": 57780137, "comment_id": 101999208, "body": "I agree, ActiveStorage is the much better option. Especially because if you store that file on one Heroku Dyno it will not be available on other Dynos and it will disappear as soon as the Dyno restarts (what happens more often than you might think). I advise reading about <a href=\"https://devcenter.heroku.com/articles/dynos#ephemeral-filesystem\" rel=\"nofollow noreferrer\">Heroku&#39;s ephemeral filesystem</a>."}, {"owner": {"reputation": 475, "user_id": 4812102, "user_type": "registered", "profile_image": "https://graph.facebook.com/984436241567947/picture?type=large", "display_name": "Aurel Branzeanu", "link": "https://stackoverflow.com/users/4812102/aurel-branzeanu"}, "edited": false, "score": 1, "creation_date": 1567589473, "post_id": 57780137, "comment_id": 102004465, "body": "Is the <a href=\"https://www.rubyguides.com/2019/05/ruby-tempfile/\" rel=\"nofollow noreferrer\">Ruby Tempfile</a> an option?"}], "owner": {"reputation": 609, "user_id": 252071, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/6db33d8ded0d28975ee679dc77e576f3?s=128&d=identicon&r=PG", "display_name": "kg.", "link": "https://stackoverflow.com/users/252071/kg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 391, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1567557488, "creation_date": 1567557488, "question_id": 57780137, "link": "https://stackoverflow.com/questions/57780137/rails-temporary-image-file-storage-and-use-options", "title": "Rails - temporary image file storage and use options", "body": "<p>I have been researching options for the best way to generate, store, and reference a temporary image file in a Rails production environment -- Rails 5.2 and Ruby 2.4 running on Heroku 18 stack.</p>\n\n<p>The image files that this application generates will only need to be available/cached for up to a few hours.  I am not sure how cpu and i/o intensive using the /assets file system is, but I expect there is a more efficient way to generate, store, and reference an image.  </p>\n\n<p>Here is the current prototyped application system which generates a PNG file, stores it in /assets/images, and then references it with image_tag:</p>\n\n<p>PNG file is generated and stored in a file system:</p>\n\n<pre><code>@barcode = Barby::Code128B.new(@variant.sku)\n@blob = Barby::PngOutputter.new(@barcode).to_png\n\npath = Rails.root.join(\"app\", \"assets\", \"images\", \"#{@variant.sku}.png\")\nFile.open(path, 'wb') {|f| f.write @blob }\n</code></pre>\n\n<p>PNG file is referenced in a view:</p>\n\n<pre><code>&lt;%= image_tag \"#{@variant.sku}.png\" %&gt;\n</code></pre>\n\n<p>Active Storage does not seem to be the correct approach since that is meant for user-uploads.  I have thought about using the Low-Level Cache for storage, but there is also the matter of easily referencing the PNG image from the view.  I am looking for some pointers and ideas about the most efficient and proper way to implement such a \"temporary\" file storage system for a production application.  Thank you!</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "undefined", "nomethoderror"], "comments": [{"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1567581188, "post_id": 57780064, "comment_id": 102000183, "body": "The method name <code>get_museum_name</code> is misleading. It implies that it returns a museum&#39;s name, i.e. a string. But instead, it returns an array containing the whole museum (or an empty array). Fixing those quirks makes it much easier to reason about the actual bugs."}], "answers": [{"tags": [], "owner": {"reputation": 862, "user_id": 1600046, "user_type": "registered", "accept_rate": 45, "profile_image": "https://i.stack.imgur.com/5rxUl.jpg?s=128&g=1", "display_name": "Vibol", "link": "https://stackoverflow.com/users/1600046/vibol"}, "is_accepted": true, "score": 1, "last_activity_date": 1567564329, "last_edit_date": 1567564329, "creation_date": 1567561540, "answer_id": 57780492, "question_id": 57780064, "link": "https://stackoverflow.com/questions/57780064/best-way-to-fix-undefined-method/57780492#57780492", "title": "Best way to fix undefined method", "body": "<p>The best way to do it depends on how you want it to be. I think the ideal solution for yours is to check <code>if/else</code> then show the content accordingly:</p>\n\n<pre><code>&lt;% if @top_museum.present? %&gt;\n  &lt;%= @top_museum.museum_name %&gt;\n&lt;% else %&gt;\n  &lt;span&gt;Nothing to display&lt;/span&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>Or using <code>try</code> <code>&lt;%= @top_museum.try(:museum_name) %&gt;</code> or if you have ruby 2.3.0 or newer you can use safe navigation operator <code>&lt;%= @top_museum&amp;.museum_name %&gt;</code> (<a href=\"http://mitrev.net/ruby/2015/11/13/the-operator-in-ruby/\" rel=\"nofollow noreferrer\">Read more</a>).</p>\n"}, {"tags": [], "owner": {"reputation": 735, "user_id": 4540883, "user_type": "registered", "accept_rate": 64, "profile_image": "https://graph.facebook.com/10152660906162393/picture?type=large", "display_name": "Diego Velez", "link": "https://stackoverflow.com/users/4540883/diego-velez"}, "is_accepted": false, "score": 1, "last_activity_date": 1567563059, "creation_date": 1567563059, "answer_id": 57780634, "question_id": 57780064, "link": "https://stackoverflow.com/questions/57780064/best-way-to-fix-undefined-method/57780634#57780634", "title": "Best way to fix undefined method", "body": "<p>You could use try in your helper, that way it tries the query, if it fails then it returns nil </p>\n\n<pre><code>def self.get_museum_name(museum_id)\n   Museum.try(where(id: museum_id))\nend\n</code></pre>\n\n<p>Ref: <a href=\"https://apidock.com/rails/v3.2.1/Object/try\" rel=\"nofollow noreferrer\">https://apidock.com/rails/v3.2.1/Object/try</a></p>\n"}], "owner": {"reputation": 390, "user_id": 4835675, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4ae280a74eadafa995d2ed1f2225cfd7?s=128&d=identicon&r=PG&f=1", "display_name": "Jabba the Hutt", "link": "https://stackoverflow.com/users/4835675/jabba-the-hutt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 107, "favorite_count": 0, "accepted_answer_id": 57780492, "answer_count": 2, "score": 1, "last_activity_date": 1567564329, "creation_date": 1567556554, "last_edit_date": 1567556656, "question_id": 57780064, "link": "https://stackoverflow.com/questions/57780064/best-way-to-fix-undefined-method", "title": "Best way to fix undefined method", "body": "<p>I am building a rails app where I have a museums page which has a feature where it displays the museum with the most exhibits. The problem is that when there are no exhibits added to the db it gives an undefined method 'museum_name'. So the problem I have is I am not sure what would be the best way to make a check that would still allow me to access the page if there are zero exhibits?</p>\n\n<p>Museums controller:</p>\n\n<pre><code>def index\n   @museums = Museum.all\n   most_exhibits = Exhibit.most_exhibits\n   most_exhibits.each do |museum|\n   @top_museum = MuseumsHelper.get_museum_name(museum.museum_id)[0]\nend\n</code></pre>\n\n<p>Helper class method being used:</p>\n\n<pre><code>  def self.get_museum_name(museum_id)\n    Museum.where(id: museum_id)\n  end\n</code></pre>\n\n<p>Display in views:</p>\n\n<pre><code>&lt;%= @top_museum.museum_name %&gt;\n</code></pre>\n"}, {"tags": ["ruby", "taglib-ruby"], "comments": [{"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1567557272, "post_id": 57779875, "comment_id": 101994869, "body": "The formatting of code blocks at stackoverflow.com is explained <a href=\"https://meta.stackexchange.com/questions/22186/how-do-i-format-my-code-blocks\">here</a>."}, {"owner": {"reputation": 13635, "user_id": 1061413, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/0beb915463288cb6e8b50e8121860717?s=128&d=identicon&r=PG", "display_name": "Amit Kumar Gupta", "link": "https://stackoverflow.com/users/1061413/amit-kumar-gupta"}, "edited": false, "score": 0, "creation_date": 1567559868, "post_id": 57779875, "comment_id": 101995302, "body": "I can&#39;t understand what the sentence &quot;I tried with bash and mediainfo a different movie but worked ok&quot; means."}, {"owner": {"reputation": 11166, "user_id": 847116, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/YLb4A.gif?s=128&g=1", "display_name": "jamesc", "link": "https://stackoverflow.com/users/847116/jamesc"}, "edited": false, "score": 0, "creation_date": 1567560748, "post_id": 57779875, "comment_id": 101995434, "body": "You are asking how to use TagLib but you don&#39;t say what TagLib library you are using? I assume taglib-ruby? It seems to me that you are passing seconds into a method that is expecting milliseconds, Why?"}, {"owner": {"reputation": 11166, "user_id": 847116, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/YLb4A.gif?s=128&g=1", "display_name": "jamesc", "link": "https://stackoverflow.com/users/847116/jamesc"}, "edited": false, "score": 0, "creation_date": 1567561347, "post_id": 57779875, "comment_id": 101995511, "body": "1932993085 seconds is 14 hours 31 minutes and 25 seconds as evidenced by <code>Time.at(1932993085).utc.strftime(&quot;%H:%M:%S&quot;)</code>"}, {"owner": {"reputation": 80721, "user_id": 797049, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/5f4f7a23e3d0134123a66015bdc4edd1?s=128&d=identicon&r=PG", "display_name": "Mark Reed", "link": "https://stackoverflow.com/users/797049/mark-reed"}, "edited": false, "score": 0, "creation_date": 1567564651, "post_id": 57779875, "comment_id": 101996014, "body": "No. 1932993085 seconds is over 61 years. What you&#39;ve shown is that POSIX time 1932993085 corresponds to a point in time whose time of day is 2:31:25 pm UTC. In particualar, it&#39;s that time on April 3, 2031 AD."}], "answers": [{"comments": [{"owner": {"reputation": 33, "user_id": 11411096, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/07ff9f233b91c168e4d7002d6ca0afa1?s=128&d=identicon&r=PG&f=1", "display_name": "espr3ss0", "link": "https://stackoverflow.com/users/11411096/espr3ss0"}, "edited": false, "score": 0, "creation_date": 1567597849, "post_id": 57780831, "comment_id": 102008837, "body": "There really should be 2 duration properties because sometimes the audio track is less than the video."}], "tags": [], "owner": {"reputation": 80721, "user_id": 797049, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/5f4f7a23e3d0134123a66015bdc4edd1?s=128&d=identicon&r=PG", "display_name": "Mark Reed", "link": "https://stackoverflow.com/users/797049/mark-reed"}, "is_accepted": true, "score": 0, "last_activity_date": 1567565615, "last_edit_date": 1567565615, "creation_date": 1567565072, "answer_id": 57780831, "question_id": 57779875, "link": "https://stackoverflow.com/questions/57779875/convert-supposed-seconds-to-duration/57780831#57780831", "title": "Convert supposed seconds to duration?", "body": "<p>I'm afraid you are misinformed. The <code>length</code> attribute of a <a href=\"https://www.rubydoc.info/gems/taglib-ruby/TagLib/MP4/File\" rel=\"nofollow noreferrer\"><code>TagLib::MP4::File</code></a> object is inherited from the regular <a href=\"https://ruby-doc.org/core-2.5.0/File.html\" rel=\"nofollow noreferrer\"><code>File</code></a> class and just tells you the size of the file in bytes; it has nothing to do with the duration of the contained media:</p>\n\n<pre><code>$ ls -l test.mp4\n-rw-r--r--@ 1 user  staff  39001360 Aug 14  2015 test.mp4\n$ ruby -rtaglib -e 'TagLib::MP4::File.open(\"test.mp4\"){|f|puts f.length}'\n39001360\n</code></pre>\n\n<p>The particular file I'm examining in the above code snippet happens to be 25 seconds long, but there's no way to tell that from the fact that it's about 39 megabytes in size.</p>\n\n<p>What you want is the <a href=\"https://www.rubydoc.info/gems/taglib-ruby/TagLib/AudioProperties#length-instance_method\" rel=\"nofollow noreferrer\"><code>#length</code></a> method of the <a href=\"https://www.rubydoc.info/gems/taglib-ruby/TagLib/AudioProperties\" rel=\"nofollow noreferrer\"><code>TagLib::MP4::Properties</code></a> object, not the <code>::File</code> one. You can get that by calling <code>#audio_properties</code> on the File object:</p>\n\n<pre><code>TagLib::MP4::File.open(\"filename.mp4\") do |mp4|\n  seconds = mp4.audio_properties.length\n  puts get_duration_hrs_and_mins(seconds)\nend\n</code></pre>\n\n<p>That return value is seconds, not milliseconds, so you need to adjust your <code>get_duration</code> method accordingly. Really you just want something like this:</p>\n\n<pre><code>total_seconds = mp4.audio_properties.length\ntotal_minutes, seconds = total_seconds.divmod(60)\ntotal_hours, minutes = total_minutes.divmod(60)\ndays, hours = total_hours.divmod(24)\n\nputs \"Duration is #{days}d#{hours}h#{minutes}m#{seconds}s\"\n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 11411096, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/07ff9f233b91c168e4d7002d6ca0afa1?s=128&d=identicon&r=PG&f=1", "display_name": "espr3ss0", "link": "https://stackoverflow.com/users/11411096/espr3ss0"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 76, "favorite_count": 0, "accepted_answer_id": 57780831, "answer_count": 1, "score": 1, "last_activity_date": 1567565615, "creation_date": 1567554386, "last_edit_date": 1567560665, "question_id": 57779875, "link": "https://stackoverflow.com/questions/57779875/convert-supposed-seconds-to-duration", "title": "Convert supposed seconds to duration?", "body": "<p>I'm new to Ruby so I'm probably going about this completely wrong, but using <code>taglib-ruby</code> I keep getting a wrong result unless it's a wrong amount of seconds maybe nanoseconds?</p>\n\n<p>I tried with <code>bash</code> and mediainfo a different movie but worked ok ...</p>\n\n<pre><code>$(date -ud \"@$(($seconds/1000))\" +'%_H:%M')\n</code></pre>\n\n<pre><code>def get_duration_hrs_and_mins(milliseconds)\n    return '' unless milliseconds\n\n    hours, milliseconds   = milliseconds.divmod(1000 * 60 * 60)\n    minutes, milliseconds = milliseconds.divmod(1000 * 60)\n    seconds, milliseconds = milliseconds.divmod(1000)\n    \"#{hours}h #{minutes}m #{seconds}s #{milliseconds}ms\"\nend\n\nTagLib::MP4::File.open(\"filename.mp4\") do |mp4|\n    seconds = mp4.length\n    puts get_duration_hrs_and_mins(seconds)\nend\n</code></pre>\n\n<p>The amount of seconds is 1932993085 and the duration should be roughly 2 h 15 min.</p>\n"}, {"tags": ["ruby", "amazon-web-services", "aws-lambda"], "answers": [{"tags": [], "owner": {"reputation": 84135, "user_id": 631619, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/b6f3159af5195eddff62a2dd4f9ad969?s=128&d=identicon&r=PG", "display_name": "Michael Durrant", "link": "https://stackoverflow.com/users/631619/michael-durrant"}, "is_accepted": true, "score": 0, "last_activity_date": 1567556517, "creation_date": 1567556517, "answer_id": 57780058, "question_id": 57779874, "link": "https://stackoverflow.com/questions/57779874/how-to-refer-to-a-param-in-an-aws-lambda-in-ruby/57780058#57780058", "title": "How to refer to a param in an aws lambda in ruby", "body": "<p>This code works:</p>\n\n<pre><code>p event[\"param1\"]\n</code></pre>\n\n<p>or you can also use string interpolation:</p>\n\n<pre><code>p \"#{event['param1']}\"\n</code></pre>\n\n<p>Output from both:</p>\n\n<pre><code>\"abcdefg\"\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 372, "user_id": 10830810, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1a88f3231958627d536621bd638400d4?s=128&d=identicon&r=PG&f=1", "display_name": "devdev_dev", "link": "https://stackoverflow.com/users/10830810/devdev-dev"}, "is_accepted": false, "score": 0, "last_activity_date": 1567557708, "creation_date": 1567557708, "answer_id": 57780155, "question_id": 57779874, "link": "https://stackoverflow.com/questions/57779874/how-to-refer-to-a-param-in-an-aws-lambda-in-ruby/57780155#57780155", "title": "How to refer to a param in an aws lambda in ruby", "body": "<p>You can access it in the lambda, for ex:</p>\n\n<pre><code>get_param = lambda { |key, val| key == 'param1'.to_sym }\n</code></pre>\n\n<p>then say </p>\n\n<pre><code>param = event.select(&amp;get_param)\np param\n</code></pre>\n\n<p>haven't used aws lambdas in Ruby before but maybe this will help! (Try <code>to_sym</code>?)</p>\n"}], "owner": {"reputation": 84135, "user_id": 631619, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/b6f3159af5195eddff62a2dd4f9ad969?s=128&d=identicon&r=PG", "display_name": "Michael Durrant", "link": "https://stackoverflow.com/users/631619/michael-durrant"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 57, "favorite_count": 0, "accepted_answer_id": 57780058, "answer_count": 2, "score": 0, "last_activity_date": 1567557708, "creation_date": 1567554378, "question_id": 57779874, "link": "https://stackoverflow.com/questions/57779874/how-to-refer-to-a-param-in-an-aws-lambda-in-ruby", "title": "How to refer to a param in an aws lambda in ruby", "body": "<p>I have a ruby lambda with</p>\n\n<pre><code>def lambda_handler(event:, context:)\n  p \"#{event}\"\nend\n</code></pre>\n\n<p>Test Event is</p>\n\n<p><a href=\"https://i.stack.imgur.com/8h5AR.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/8h5AR.png\" alt=\"enter image description here\"></a></p>\n\n<p>It show the event:</p>\n\n<pre><code>\"{\\\"param1\\\"=&gt;\\\"abcdefg\\\", \\\"key2\\\"=&gt;\\\"value2\\\", \\\"key3\\\"=&gt;\\\"value3\\\"}\"\n</code></pre>\n\n<p>but how do I get the param ?</p>\n\n<p>I tried</p>\n\n<pre><code>      p \"#{event[param1]}\"\n      p \"#{param1}\"\n</code></pre>\n\n<p>but neither worked</p>\n\n<p>Error from first:</p>\n\n<pre><code>\"errorMessage\": \n\"undefined local variable or method `param1' for #&lt;LambdaHandler:0x00005597b5a7c608&gt;\",\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 731, "user_id": 3813229, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/3d1734bfe19a7636567a4958ec87ddf2?s=128&d=identicon&r=PG&f=1", "display_name": "queroga_vqz", "link": "https://stackoverflow.com/users/3813229/queroga-vqz"}, "edited": false, "score": 1, "creation_date": 1567553178, "post_id": 57779472, "comment_id": 101994227, "body": "Have you tried: results = Task.select(&#39;id, name&#39;)"}, {"owner": {"reputation": 51, "user_id": 5875713, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0orHP.jpg?s=128&g=1", "display_name": "Jetals", "link": "https://stackoverflow.com/users/5875713/jetals"}, "reply_to_user": {"reputation": 731, "user_id": 3813229, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/3d1734bfe19a7636567a4958ec87ddf2?s=128&d=identicon&r=PG&f=1", "display_name": "queroga_vqz", "link": "https://stackoverflow.com/users/3813229/queroga-vqz"}, "edited": false, "score": 0, "creation_date": 1567606380, "post_id": 57779472, "comment_id": 102013709, "body": "I <i><b>did</b></i> actually initially make use of a very similar <code>#select</code> query to get results in-line with what I was looking for, however, trying to pass these results through to render in the view actually violated some other logic of the application having to do with <code>:name</code> being &quot;delegated&quot; to <code>:project</code> in the model: <code>delegate :name, ...etc., :to =&gt; :project</code>."}, {"owner": {"reputation": 51, "user_id": 5875713, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0orHP.jpg?s=128&g=1", "display_name": "Jetals", "link": "https://stackoverflow.com/users/5875713/jetals"}, "reply_to_user": {"reputation": 731, "user_id": 3813229, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/3d1734bfe19a7636567a4958ec87ddf2?s=128&d=identicon&r=PG&f=1", "display_name": "queroga_vqz", "link": "https://stackoverflow.com/users/3813229/queroga-vqz"}, "edited": false, "score": 0, "creation_date": 1567606385, "post_id": 57779472, "comment_id": 102013713, "body": "While your response provides an answer correctly returning the desired data in my console, other influencing application logic plays a role here not explicitly stated in my question. I would say there are a few different ways of approaching this problem which Chris Heald really helped me understand below. Thank you for your input! \ud83d\udc4d"}], "answers": [{"comments": [{"owner": {"reputation": 51, "user_id": 5875713, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0orHP.jpg?s=128&g=1", "display_name": "Jetals", "link": "https://stackoverflow.com/users/5875713/jetals"}, "edited": false, "score": 0, "creation_date": 1567611366, "post_id": 57779660, "comment_id": 102016604, "body": "While I was able to get interesting and revealing results to render from each of these examples, it was the second &quot;Ruby-ish&quot; snippet here which allowed me to circumspect the other influencing application logic and render exactly the data as intended."}, {"owner": {"reputation": 51, "user_id": 5875713, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0orHP.jpg?s=128&g=1", "display_name": "Jetals", "link": "https://stackoverflow.com/users/5875713/jetals"}, "edited": false, "score": 0, "creation_date": 1567611375, "post_id": 57779660, "comment_id": 102016612, "body": "Otherwise, the other examples, links, and rationale provided here are really helping me extend my understanding of Rails queries and what Ruby is capable of, esp. its utility for working with data in the view."}, {"owner": {"reputation": 51, "user_id": 5875713, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0orHP.jpg?s=128&g=1", "display_name": "Jetals", "link": "https://stackoverflow.com/users/5875713/jetals"}, "edited": false, "score": 1, "creation_date": 1567611388, "post_id": 57779660, "comment_id": 102016624, "body": "<i><b>THANK YOU SO MUCH</b></i> for taking the time to write this up. Your response definitely helped me bring some critical threads together in my previously muddled thinking about this problem and about <code>ActiveRecord_Relation</code> objects in general. Literally, this learning moment is among the best things that&#39;s happened to me this week!"}, {"owner": {"reputation": 56502, "user_id": 271475, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b00f41e5f2a69734051f2a78f4f3785?s=128&d=identicon&r=PG", "display_name": "Chris Heald", "link": "https://stackoverflow.com/users/271475/chris-heald"}, "reply_to_user": {"reputation": 51, "user_id": 5875713, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0orHP.jpg?s=128&g=1", "display_name": "Jetals", "link": "https://stackoverflow.com/users/5875713/jetals"}, "edited": false, "score": 1, "creation_date": 1567612664, "post_id": 57779660, "comment_id": 102017307, "body": "So happy that it helped clear some things up for you! :D"}], "tags": [], "owner": {"reputation": 56502, "user_id": 271475, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b00f41e5f2a69734051f2a78f4f3785?s=128&d=identicon&r=PG", "display_name": "Chris Heald", "link": "https://stackoverflow.com/users/271475/chris-heald"}, "is_accepted": true, "score": 2, "last_activity_date": 1567552637, "last_edit_date": 1567552637, "creation_date": 1567552177, "answer_id": 57779660, "question_id": 57779472, "link": "https://stackoverflow.com/questions/57779472/needing-to-render-a-single-field-from-a-model-in-a-table/57779660#57779660", "title": "Needing to render a single field from a model in a table", "body": "<p>Short answer: <code>#pluck</code> will do what's asked in the question. That's roughly equivalent to just running <code>select fieldname from tablename</code>, and getting the results as a list of primitives.</p>\n\n<pre><code># Controller\n@task_names = Task.all.pluck(:name)\n\n# View\n%td=@task_names.join(\", \")\n</code></pre>\n\n<p>Longer answer: </p>\n\n<p>The <code>ActiveRecord::Relation</code> object is a proxy for a query. When you materialize it, it runs the query and then creates an <code>Array</code> of <code>Task</code> instances, one per row returned, with their attributes matching the columns from each row. These Task instances are themselves subclasses of <code>ActiveRecord::Base</code>. This isn't critical to the answer, but it may help your understanding of the structure.</p>\n\n<p>Since you have a list of <code>Task</code> objects, and <code>ActiveRecord::Base</code> instances expose their fields as instance methods, one Ruby-ish way to do this would be use <code>#all</code> to fetch an <code>Array</code> of <code>Task</code> instances, then Array#each to loop through the array, and then you would render out the desired field from each:</p>\n\n<pre><code># Controller\n@tasks = Task.all\n\n#View\n\n%tbody\n- @tasks.each do |task|\n    %tr\n      %td=task.name\n</code></pre>\n\n<p>The reason you might want to do it this way is that you might find yourself wanting additional fields from your tasks. Consider if you wanted the name and due date:</p>\n\n<pre><code>%tbody\n- @tasks.each do |task|\n    %tr\n      %td=task.name\n      %td=task.due_date\n</code></pre>\n\n<p>Rather than having to pluck out a list of values for each field, you can retrieve a list of Task objects, and interact with those instead.</p>\n\n<p>Alternately, if you already have a list of Task objects and wanted to collect all the values for a particular field out of them, you would use <a href=\"https://ruby-doc.org/core-2.6.3/Enumerable.html#method-i-map\" rel=\"nofollow noreferrer\">Enumerable#map</a>:</p>\n\n<pre><code>@tasks = Task.all\n@task_names = @tasks.map(&amp;:name)\n</code></pre>\n\n<p>If you did genuinely want an array of Hashes with the key <code>:name</code> and the value given, you would do something like:</p>\n\n<pre><code>@task_names = Task.pluck(:name).map {|n| {name: n} }\n</code></pre>\n\n<p>In Rails views, <code>render</code> is used to invoke a partial, though, so I suspect you may be wanting to invoke <code>render \"some_partial\", collection: @tasks</code>. If this is the case, then yes, you'll want your collection to be an array of Task objects, if the partial you're rendering expects a list of Task objects.</p>\n\n<p>See <a href=\"https://guides.rubyonrails.org/layouts_and_rendering.html#using-partials\" rel=\"nofollow noreferrer\">the documentation on partials</a> for a more complete explanation.</p>\n\n<p>You may need to define the desired output more clearly to get a more specific answer, but there are many ways to get to the desired slicing of the data. Understanding how ActiveRecord instances operate, and how they're typically used in views will be important to understanding how to get what you want.</p>\n"}], "owner": {"reputation": 51, "user_id": 5875713, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0orHP.jpg?s=128&g=1", "display_name": "Jetals", "link": "https://stackoverflow.com/users/5875713/jetals"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 61, "favorite_count": 0, "accepted_answer_id": 57779660, "answer_count": 1, "score": 1, "last_activity_date": 1567552637, "creation_date": 1567550110, "question_id": 57779472, "link": "https://stackoverflow.com/questions/57779472/needing-to-render-a-single-field-from-a-model-in-a-table", "title": "Needing to render a single field from a model in a table", "body": "<p>Puzzling over a way to render a single field from an ActiveRecord_Relation collection retrieved from our application's Task model:</p>\n\n<pre><code>results = Task.all\n</code></pre>\n\n<p><code>Task.all</code> returns an ActiveRecord_Relation object containing key-value pairs representing the fields of the db and their corresponding values, eg:</p>\n\n<pre><code>[#&lt;Task:0x007ff7af13b628\n  id: 1,\n  name: \"x_task_name\",\n  project_id: 1\n ..., etc.\n]\n</code></pre>\n\n<p>This results in multiple fields (id, project name, task name) rendering in the view using the <code>index</code> method:</p>\n\n<pre><code>def index\n  @task_names = Task.all\n  respond_to do |format|\n    format.html\n    format.json { render json: @task_names}\n  end\nend\n</code></pre>\n\n<p>Which is rendered to the view using haml:</p>\n\n<pre><code>%table#task_activity_report.display\n  %thead\n    %tr\n      %th Task Name\n  %tbody\n    = render @task_names\n</code></pre>\n\n<p>However, all I want to render right now is the Task relation's <code>name</code> field. I've tried changing out my query on the Task model: <code>Task.all</code> with <code>Task.pluck(:name)</code>. This effectively results in an array containing the <em>values</em> of each task name (exactly as noted in the docs), however, my suspicion is that the object I need to pass to the view to have it render successfully should look more like the ActiveRecord_Relation:</p>\n\n<pre><code>[name: \"a_task_name\", name: \"b_task_name\", name: \"c_task_name\", ...n ]\n</code></pre>\n\n<p>Is there a query I can use that will return the desired relation, or should I be using Ruby to process the results of using pluck, iterating over the array and adding a <code>name</code> key to each string-typed element?</p>\n\n<p>Coming to Ruby from a mostly JavaScript background. I need to work with Ruby on Rails at my first dev job.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "authentication", "devise"], "comments": [{"owner": {"reputation": 24560, "user_id": 4880924, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/d40e83be235d4f70428da0d42e12d427?s=128&d=identicon&r=PG&f=1", "display_name": "BKSpurgeon", "link": "https://stackoverflow.com/users/4880924/bkspurgeon"}, "edited": false, "score": 0, "creation_date": 1567548313, "post_id": 57779220, "comment_id": 101993343, "body": "Perhaps consider using the Wizard gem to help simplify this type of multi-page registration. First use devise to handle the username and password, and then use wizard to do what you want."}, {"owner": {"reputation": 4690, "user_id": 1937435, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/YyN37.jpg?s=128&g=1", "display_name": "Josh Brody", "link": "https://stackoverflow.com/users/1937435/josh-brody"}, "edited": false, "score": 0, "creation_date": 1567548951, "post_id": 57779220, "comment_id": 101993469, "body": "Devise doesn&#39;t do anything special in terms of registration. You can do whatever you want to create a new user, even from the console a la <code>User.create(email: &quot;hi@example.com&quot;, password: &quot;password&quot;)</code>"}, {"owner": {"reputation": 15, "user_id": 8286465, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99416f990625ff3431a4241cce3759b6?s=128&d=identicon&r=PG&f=1", "display_name": "Jenny Hong", "link": "https://stackoverflow.com/users/8286465/jenny-hong"}, "reply_to_user": {"reputation": 24560, "user_id": 4880924, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/d40e83be235d4f70428da0d42e12d427?s=128&d=identicon&r=PG&f=1", "display_name": "BKSpurgeon", "link": "https://stackoverflow.com/users/4880924/bkspurgeon"}, "edited": false, "score": 0, "creation_date": 1567549769, "post_id": 57779220, "comment_id": 101993643, "body": "@BKSpurgeon I looked into Wizard and I think it fits best with what I&#39;m looking for. Thank you for that suggestion. I had a follow up question. Wizard is referring to the type of form and the gem that we need to utilize is wicked right? Or am I completely mistaken?"}, {"owner": {"reputation": 24560, "user_id": 4880924, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/d40e83be235d4f70428da0d42e12d427?s=128&d=identicon&r=PG&f=1", "display_name": "BKSpurgeon", "link": "https://stackoverflow.com/users/4880924/bkspurgeon"}, "edited": false, "score": 0, "creation_date": 1567549915, "post_id": 57779220, "comment_id": 101993675, "body": "<a href=\"https://github.com/schneems/wicked\" rel=\"nofollow noreferrer\">github.com/schneems/wicked</a> you are right it is wicked, not wizard"}], "answers": [{"tags": [], "owner": {"reputation": 24560, "user_id": 4880924, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/d40e83be235d4f70428da0d42e12d427?s=128&d=identicon&r=PG&f=1", "display_name": "BKSpurgeon", "link": "https://stackoverflow.com/users/4880924/bkspurgeon"}, "is_accepted": true, "score": 0, "last_activity_date": 1567555153, "creation_date": 1567555153, "answer_id": 57779932, "question_id": 57779220, "link": "https://stackoverflow.com/questions/57779220/customizing-devise-vs-creating-own-authentication-for-multi-page-registration/57779932#57779932", "title": "Customizing Devise vs Creating own authentication for multi page registration", "body": "<p>This can be done by modifying the views and the devise controller to accept multi-part registration, but it is cumbersome: I would counsel you to avoid it. Rather, another option would be to: (i) use devise to handle the email and username in one form and then (ii) handle the multi-part registration using the <a href=\"https://github.com/schneems/wicked\" rel=\"nofollow noreferrer\">wicked gem</a> - whose sole purpose for existence is to handle multi part registration problems.</p>\n"}], "owner": {"reputation": 15, "user_id": 8286465, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99416f990625ff3431a4241cce3759b6?s=128&d=identicon&r=PG&f=1", "display_name": "Jenny Hong", "link": "https://stackoverflow.com/users/8286465/jenny-hong"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 48, "favorite_count": 0, "accepted_answer_id": 57779932, "answer_count": 1, "score": 0, "last_activity_date": 1567555153, "creation_date": 1567548071, "question_id": 57779220, "link": "https://stackoverflow.com/questions/57779220/customizing-devise-vs-creating-own-authentication-for-multi-page-registration", "title": "Customizing Devise vs Creating own authentication for multi page registration", "body": "<p>I'm creating a ruby on rails project (soon to be a mobile app). I wanted to utilize the Devise gem for authentication, but I am struggling with the customization of Devise. I wanted to implement a multi-page registration/sign up process. The standard devise gem automatically provides a form that includes email and password. For my project, I wanted the users to add in their name on one page, then their email on the next page, and then their password on the page after, etc. Please see the <a href=\"https://i.stack.imgur.com/t2ted.jpg\" rel=\"nofollow noreferrer\">attached jpg picture</a> for a super basic example. </p>\n\n<p>So far, I separated the registration controller from the devise package. The registration controller comes with the new.html.erb and the edit.html.erb files. I want to take the standard form in the new.html.erb file and split that into multiple html.erb files. The controller would obviously need to be connected to these multiple files. As I was working on it, I realized how complicated it is. I'm wondering is it better to create my own authentication process instead of devise, or is it better to stick with devise? </p>\n\n<p>I really want to make it work with devise, so if you have any suggestions on how to customize the gem to implement the multipage registration that I want, please let me know.</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 862, "user_id": 1600046, "user_type": "registered", "accept_rate": 45, "profile_image": "https://i.stack.imgur.com/5rxUl.jpg?s=128&g=1", "display_name": "Vibol", "link": "https://stackoverflow.com/users/1600046/vibol"}, "edited": false, "score": 0, "creation_date": 1567572272, "post_id": 57778920, "comment_id": 101997297, "body": "What is your <code>decline&#47;accept</code> logic? That will help me to write better answer for you."}, {"owner": {"reputation": 47, "user_id": 11286717, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-OysRu6ppb0U/AAAAAAAAAAI/AAAAAAAAAAk/c8eR1BlDQ8s/photo.jpg?sz=128", "display_name": "Mr.Movies Tamil", "link": "https://stackoverflow.com/users/11286717/mr-movies-tamil"}, "reply_to_user": {"reputation": 862, "user_id": 1600046, "user_type": "registered", "accept_rate": 45, "profile_image": "https://i.stack.imgur.com/5rxUl.jpg?s=128&g=1", "display_name": "Vibol", "link": "https://stackoverflow.com/users/1600046/vibol"}, "edited": false, "score": 1, "creation_date": 1567572506, "post_id": 57778920, "comment_id": 101997350, "body": "Accept finds requester_id of current user and creates a relationship in table using .create! method. Decline similarly destroys the requester_id from the request table"}], "answers": [{"tags": [], "owner": {"reputation": 862, "user_id": 1600046, "user_type": "registered", "accept_rate": 45, "profile_image": "https://i.stack.imgur.com/5rxUl.jpg?s=128&g=1", "display_name": "Vibol", "link": "https://stackoverflow.com/users/1600046/vibol"}, "is_accepted": false, "score": 0, "last_activity_date": 1567572976, "creation_date": 1567572976, "answer_id": 57781723, "question_id": 57778920, "link": "https://stackoverflow.com/questions/57778920/i-need-to-add-a-destroy-function-for-decline-option-in-my-follow-request-page/57781723#57781723", "title": "I need to add a destroy function for decline option in my follow request page", "body": "<p>Answering to your question, YES we can call the destroy action. But I suggest we go with something more scale and pretty design, here is my rough design (not tested):</p>\n\n<pre><code># routes.rb\nRails.application.routes.draw do\n  resources :requests, only: [] do\n    member do\n      patch :accept\n      patch :decline\n    end\n  end\nend\n\n# request.rb\nclass Request &lt; ApplicationRecord\n  belongs_to :user\n\n  def accept\n    # 1. Do accept logic\n    # 2. Destroy\n    destroy\n  end\n\n  def decline\n    # 1. Do decline logic\n    # 2. Destroy\n    destroy\n  end\nend\n\n# requests_controller.rb\nclass RequestsController &lt; ApplicationController\n  before_action :set_request\n\n  def accept\n    @request.accept\n    # Redirect somewhere\n    redirect_to profile_path\n  end\n\n  def decline\n    @request.decline\n    # Redirect somewhere\n    redirect_to profile_path\n  end\n\n  private\n\n  def set_request\n    @request = Request.find(params[:id])\n  end\nend\n</code></pre>\n\n<p>With the following design you and add more logic easily to <code>decline/accept</code> e.g send email ...</p>\n"}], "owner": {"reputation": 47, "user_id": 11286717, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-OysRu6ppb0U/AAAAAAAAAAI/AAAAAAAAAAk/c8eR1BlDQ8s/photo.jpg?sz=128", "display_name": "Mr.Movies Tamil", "link": "https://stackoverflow.com/users/11286717/mr-movies-tamil"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 27, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1567572976, "creation_date": 1567545899, "last_edit_date": 1567547999, "question_id": 57778920, "link": "https://stackoverflow.com/questions/57778920/i-need-to-add-a-destroy-function-for-decline-option-in-my-follow-request-page", "title": "I need to add a destroy function for decline option in my follow request page", "body": "<p>I am new to rails and I am creating a app in which a clone like twitter. The users are connected with each other by sending request first and the corresponding user accepts or deletes the request. I followed michael-hartl book. </p>\n\n<p>User model:</p>\n\n<pre><code>attr_accessible :email, :name, :password, :password_confirmation, :id\n\nhas_many :reverse_requests, foreign_key: \"requested_id\", class_name:  \"Request\", dependent: :destroy\nhas_many :requesters, through: :reverse_requests, source: :requester\n\nhas_many :requests, foreign_key: \"requester_id\", dependent: :destroy\n\nhas_many :requested_users, through: :requests, source: :requested \n</code></pre>\n\n<p>Accept or decline view:</p>\n\n<pre><code>   &lt;ul class=\"users\"&gt;\n     &lt;% @users.each do |user| %&gt;\n       &lt;%= link_to gravatar_for(user, size: 30), user %&gt;\n       &lt;%= link_to user.name, user %&gt;\n\n//Accept which invokes create\n\n       &lt;%= form_for(current_user.relationships.build(follower_id: user.id)) do |f| %&gt;\n         &lt;%= f.hidden_field :follower_id %&gt;\n         &lt;%= f.submit \"Accept\", class: \"btn btn-large btn-primary\" %&gt;\n       &lt;% end %&gt;\n\n//Decline which invokes destroy\n\n       &lt;%= form_for(user.requests.find_by_requested_id(current_user),\n             html: { method: :delete }) do |f| %&gt;\n         &lt;%= f.submit \"Decline\", class: \"btn btn-large btn-primary\" %&gt;\n       &lt;% end %&gt;\n     &lt;% end %&gt;\n   &lt;/ul&gt;\n</code></pre>\n\n<p>Requests controller:</p>\n\n<pre><code>def create\n  @user = User.find(params[:request][:requested_id])\n  current_user.request!(@user, 2)\n  #current_user.status!(2)\n  respond_to do |format|\n    format.html { redirect_to @user }\n    format.js\n  end\nend\n\ndef destroy\n  @user = Request.find(params[:id]).requester\n  current_user.decline!(@user)\n  respond_to do |format|\n    format.html { redirect_to current_user }\n    format.js\n  end\n\nend\n</code></pre>\n\n<p>When decline is clicked the request is removed from the database as well as from the user requests list. Which I need it also after accepting the request it should be removed from both the database and request list.</p>\n\n<p>Can anyone help to achieve this? </p>\n\n<p>Is it possible to call the destroy function after the accept button is clicked?</p>\n\n<p>Or any other suggestions??</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-5.2"], "answers": [{"comments": [{"owner": {"reputation": 4416, "user_id": 2012677, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/8d7cb2fe712fb17f44f8c354bf37e7b5?s=128&d=identicon&r=PG&f=1", "display_name": "user2012677", "link": "https://stackoverflow.com/users/2012677/user2012677"}, "edited": false, "score": 0, "creation_date": 1567536657, "post_id": 57777199, "comment_id": 101989524, "body": "thank you for the feedback, but styles is not nil, so the issue is not so much the method to remove the blank items, but to figure out why its seeing styles as nil."}, {"owner": {"reputation": 3307, "user_id": 2266827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/Frcc8.png?s=128&g=1", "display_name": "jeffdill2", "link": "https://stackoverflow.com/users/2266827/jeffdill2"}, "reply_to_user": {"reputation": 4416, "user_id": 2012677, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/8d7cb2fe712fb17f44f8c354bf37e7b5?s=128&d=identicon&r=PG&f=1", "display_name": "user2012677", "link": "https://stackoverflow.com/users/2012677/user2012677"}, "edited": false, "score": 1, "creation_date": 1567537162, "post_id": 57777199, "comment_id": 101989725, "body": "It&#39;s got to be. Put in a <code>puts styles.inspect</code> above where you&#39;re removing the empty strings so you can see exactly what the value of <code>styles</code> is at the time of execution."}], "tags": [], "owner": {"reputation": 3307, "user_id": 2266827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/Frcc8.png?s=128&g=1", "display_name": "jeffdill2", "link": "https://stackoverflow.com/users/2266827/jeffdill2"}, "is_accepted": false, "score": 1, "last_activity_date": 1567536841, "last_edit_date": 1567536841, "creation_date": 1567536279, "answer_id": 57777199, "question_id": 57777137, "link": "https://stackoverflow.com/questions/57777137/undefined-method-for-nilnilclass-for-active-record-callback-of-existing-fie/57777199#57777199", "title": "undefined method `-&#39; for nil:NilClass for active record callback of existing field", "body": "<p>You could change it in a number of ways:</p>\n\n<ol>\n<li><p>Using <code>try</code>: </p>\n\n<pre><code>self.styles = styles.try(:-, ['']) if styles_changed?\n</code></pre></li>\n<li><p>Another version using <code>try</code> but this has the benefit of being able to handle both empty strings <em>or</em> <code>nil</code> values:</p>\n\n<pre><code>self.styles = styles.try(:reject, &amp;:blank?) if styles_changed?\n</code></pre></li>\n</ol>\n\n<p>Note that in both examples, I've added <code>self</code>. <code>self</code> is typically implicit in Ruby, but when you're assigning an attribute, you'll have to specify <code>self</code> because otherwise there's no way to distinguish whether you're declaring a local variable or assigning a value to an attribute.</p>\n"}, {"comments": [{"owner": {"reputation": 4416, "user_id": 2012677, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/8d7cb2fe712fb17f44f8c354bf37e7b5?s=128&d=identicon&r=PG&f=1", "display_name": "user2012677", "link": "https://stackoverflow.com/users/2012677/user2012677"}, "edited": false, "score": 0, "creation_date": 1567536800, "post_id": 57777295, "comment_id": 101989591, "body": "did you intentionally make self.style = styles?"}, {"owner": {"reputation": 91121, "user_id": 179125, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5594142dcc49a24b1902ec8059181f8d?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan Running", "link": "https://stackoverflow.com/users/179125/jordan-running"}, "edited": false, "score": 0, "creation_date": 1567537095, "post_id": 57777295, "comment_id": 101989702, "body": "This is the correct solution, but it would be a better answer if it explained why the error was occurring in the absence of <code>self.</code>."}], "tags": [], "owner": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "is_accepted": true, "score": 1, "last_activity_date": 1567538571, "last_edit_date": 1567538571, "creation_date": 1567536743, "answer_id": 57777295, "question_id": 57777137, "link": "https://stackoverflow.com/questions/57777137/undefined-method-for-nilnilclass-for-active-record-callback-of-existing-fie/57777295#57777295", "title": "undefined method `-&#39; for nil:NilClass for active record callback of existing field", "body": "<p>You need to access <code>styles</code> on <code>self</code>:</p>\n\n<pre><code>def remove_empty_from_styles\n  self.styles = styles - [''] if styles_changed?\nend\n</code></pre>\n\n<p><code>styles = styles - ['']</code> assigns the result of <code>styles - ['']</code> to a local variable called <code>styles</code>.</p>\n\n<p><code>self.styles = styles - ['']</code> invokes a <code>styles=</code> method on <code>self</code> passing <code>styles - ['']</code> as an argument.</p>\n"}], "owner": {"reputation": 4416, "user_id": 2012677, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/8d7cb2fe712fb17f44f8c354bf37e7b5?s=128&d=identicon&r=PG&f=1", "display_name": "user2012677", "link": "https://stackoverflow.com/users/2012677/user2012677"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 50, "favorite_count": 0, "accepted_answer_id": 57777295, "answer_count": 2, "score": 2, "last_activity_date": 1567538571, "creation_date": 1567535973, "last_edit_date": 1567536567, "question_id": 57777137, "link": "https://stackoverflow.com/questions/57777137/undefined-method-for-nilnilclass-for-active-record-callback-of-existing-fie", "title": "undefined method `-&#39; for nil:NilClass for active record callback of existing field", "body": "<p>I have a form with a checkbox of different styles. The form works fine, but I am getting an empty string saved in the array of style options.  I would like to remove it. So I created a before_save callback..</p>\n\n<pre><code>Parameters: {\"utf8\"=&gt;\"\u2713\",\"car_form\"=&gt;{\"styles\"=&gt;[\"\",\"Black\"]}}\n</code></pre>\n\n<p>VIEW</p>\n\n<pre><code>&lt;%= f.input :styles, as: :check_boxes, collection: FormCollection::Styles.all %&gt;\n</code></pre>\n\n<p>MODEL</p>\n\n<pre><code>class Car &lt; ApplicationRecord\n  before_save :remove_empty_from_styles\n\n  def remove_empty_from_styles\n     styles = (styles - ['']) if styles_changed?\n  end\nend\n</code></pre>\n\n<p>However, I get:</p>\n\n<blockquote>\n  <p>undefined method `-' for nil:NilClass</p>\n</blockquote>\n\n<p>However, if I comment out the call back everything works fine, the values get saved, like normal.</p>\n\n<p>NOTES: <code>styles</code> is not nil.</p>\n"}, {"tags": ["ruby", "cucumber", "watir"], "comments": [{"owner": {"reputation": 12118, "user_id": 4714829, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fd1b66c22707be26afda19fe995e17ea?s=128&d=identicon&r=PG&f=1", "display_name": "supputuri", "link": "https://stackoverflow.com/users/4714829/supputuri"}, "edited": false, "score": 1, "creation_date": 1567535208, "post_id": 57776637, "comment_id": 101988941, "body": "I would suggest handle this at the browser capability level. I can provide the answer but just want to know if you are using remote driver?"}, {"owner": {"reputation": 5134, "user_id": 1672197, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i8HkV.png?s=128&g=1", "display_name": "orde", "link": "https://stackoverflow.com/users/1672197/orde"}, "edited": false, "score": 0, "creation_date": 1567549225, "post_id": 57776637, "comment_id": 101993527, "body": "This might help: <a href=\"http://watir.com/guides/downloads\" rel=\"nofollow noreferrer\">watir.com/guides/downloads</a>.  But testing file download via webdriver isn&#39;t worth the effort IMO (e.g. fragile, webdriver is wrong tool for the job).  YMMV."}], "owner": {"reputation": 1, "user_id": 9458623, "user_type": "registered", "profile_image": "https://graph.facebook.com/755887441270363/picture?type=large", "display_name": "Deric Montana", "link": "https://stackoverflow.com/users/9458623/deric-montana"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 87, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1567534575, "creation_date": 1567533379, "last_edit_date": 1567534575, "question_id": 57776637, "link": "https://stackoverflow.com/questions/57776637/how-to-set-set-a-new-default-download-directory-or-folder-after-clicking-a-downl", "title": "How to set set a new default download directory or folder after clicking a download button on a page. I am using cucumber with watir", "body": "<p>How to set a new default download directory or folder after clicking a download button on a page. I am using cucumber with watir</p>\n\n<p>Error message:</p>\n\n<pre><code>Then(/^the user clicks on \"(.*)\" download on \"(.*)\" page$/) do |field_name, page_name|\n  # get the XPATH or CSS from page object file, Raises Error if not found\n  begin\n    selector, element_path = get_element_target(field_name, page_name).split('^^')\n  rescue\n    fail(\"Element Xpath is not found for #{field_name} in #{page_name} page objects File\")\n  end\n  if selector.nil? || element_path.nil?\n    fail(\"Element Xpath is not found for #{field_name} in #{page_name} page objects File\")\n  end\n  selector = (selector.downcase.include? 'xpath') ? :xpath : :css\n\n  # Create the Element object\n  element_obj = @browser.element(selector, element_path)\n\n  # Wait for element to be present\n  wait_for_element(element_obj)\n\n  # Focus on element to make it visible\n  focus_on_element(element_obj)\n  DOWNLOAD_DIR = \"#{Dir.pwd}\" + '/features/support/Downloads/'\n\n\n  element_obj.click(DOWNLOAD_DIR)\n\n  end\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "architecture"], "comments": [{"owner": {"reputation": 152277, "user_id": 438992, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/QouOz.jpg?s=128&g=1", "display_name": "Dave Newton", "link": "https://stackoverflow.com/users/438992/dave-newton"}, "edited": false, "score": 2, "creation_date": 1567532881, "post_id": 57776437, "comment_id": 101988106, "body": "You send the data you need with the request--you don&#39;t access controller instances from other different controller instances: controllers are stand-alone, per-request."}, {"owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 1, "creation_date": 1567532973, "post_id": 57776437, "comment_id": 101988140, "body": "Calling one controller method from another is a bit of an antipattern, in my opinion. Instead, define a third, static class that has the shared methods. Call that from the controller"}, {"owner": {"reputation": 8640, "user_id": 4055042, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/cd04c63d95d27033b53d4d83fea40c02?s=128&d=identicon&r=PG&f=1", "display_name": "SRack", "link": "https://stackoverflow.com/users/4055042/srack"}, "edited": false, "score": 0, "creation_date": 1567596397, "post_id": 57776437, "comment_id": 102008066, "body": "Could you add some pseudo code to the question @Matt? It would likely make this a lot easier to help with."}], "owner": {"reputation": 370, "user_id": 8060214, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c0a2d5cd0b3cf6c505873f2e63cacde0?s=128&d=identicon&r=PG&f=1", "display_name": "Matt", "link": "https://stackoverflow.com/users/8060214/matt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 48, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1567574053, "creation_date": 1567532329, "last_edit_date": 1567574053, "question_id": 57776437, "link": "https://stackoverflow.com/questions/57776437/how-can-i-move-data-between-different-controllers-in-rails-while-also-receiving", "title": "How can I move data between different controllers in rails while also receiving user input?", "body": "<p>I'm relatively new to rails, and trying to write a program that involves querying data (a <code>user_id</code> and list of <code>options</code>) from an external API in one controller (<code>Controller A)</code>, pushing the <code>options</code> to a view such that a user can select the option they want (via <code>&lt;select_tag&gt;</code>, and then sending both the <code>user_id</code> and <code>selected_option</code> to a different controller (<code>Controller B</code>).</p>\n\n<p>I use an event listener to send an ajax post request to <code>Controller B</code> when an item is selected from my dropdown list.  The issue is that the ajax request creates a new class instance, where in reality I want to reference the instance of Controller B that I instantiated in <code>Controller A</code>. </p>\n\n<p>How I can get both the <code>user_id</code> and <code>selected_option</code> into <code>Controller B</code> based on the architecture I have described?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "rubygems", "wkhtmltopdf", "wicked-pdf"], "comments": [{"owner": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "edited": false, "score": 0, "creation_date": 1567544778, "post_id": 57776003, "comment_id": 101992377, "body": "Maybe have a look at <a href=\"https://github.com/mileszs/wicked_pdf/issues/721\" rel=\"nofollow noreferrer\">this issue on github</a>"}], "answers": [{"tags": [], "owner": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "is_accepted": false, "score": 0, "last_activity_date": 1567545069, "creation_date": 1567545069, "answer_id": 57778790, "question_id": 57776003, "link": "https://stackoverflow.com/questions/57776003/different-font-displayed-wicked-pdf/57778790#57778790", "title": "Different font displayed wicked_pdf", "body": "<p>This appears to be <a href=\"https://github.com/mileszs/wicked_pdf/issues/721#issuecomment-429560752\" rel=\"nofollow noreferrer\">a known issue</a> with <code>wkhtmltopdf-binary</code>.</p>\n\n<p>You might try locking to an earlier version.  In Gemfile</p>\n\n<pre><code>gem 'wkhtmltopdf-binary', '=0.12.3.1'\n</code></pre>\n"}], "owner": {"reputation": 599, "user_id": 11544569, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xEqDN.jpg?s=128&g=1", "display_name": "RomanOks", "link": "https://stackoverflow.com/users/11544569/romanoks"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 59, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1567545069, "creation_date": 1567530124, "question_id": 57776003, "link": "https://stackoverflow.com/questions/57776003/different-font-displayed-wicked-pdf", "title": "Different font displayed wicked_pdf", "body": "<p>I use wicked_pdf gem in my project.</p>\n\n<p>Everything was fine until I updated the version of the cut version of all gems.</p>\n\n<p>Now the font in my pdf is displayed differently. With what it can be connected?</p>\n\n<p>Also in my text appeared bold headers that were previously common.</p>\n\n<p>The wicked_pdf gem was not updated.</p>\n\n<p>Can the font change due to <em>wkhtmltopdf</em>?</p>\n\n<p>Gem change log:</p>\n\n<pre><code>addressable (2.6.0)\npublic_suffix (&gt;= 2.0.2, &lt; 4.0)\n  addressable (2.7.0)\n  public_suffix (&gt;= 2.0.2, &lt; 5.0)\nautoprefixer-rails (9.5.1)\n  autoprefixer-rails (9.6.1.1)\n\nbcrypt (3.1.12)\n  bcrypt (3.1.13)\n\nbootsnap (1.4.4)\n  bootsnap (1.4.5)\n\ncapybara (3.18.0)\n  capybara (3.28.0)\n\nregexp_parser (~&gt; 1.2)\n  regexp_parser (~&gt; 1.5)\n\ndomain_name (0.5.20180417)\n  domain_name (0.5.20190701)\n\nffi (1.10.0)\n  ffi (1.11.1)\n\njquery-rails (4.3.3)\n  jquery-rails (4.3.5)\n\njwt (2.1.0)\n  jwt (2.2.1)\n\nmini_mime (1.0.1)\n  mini_mime (1.0.2)\n\nminitest-reporters (1.3.6)\n  minitest-reporters (1.3.8)\n\nmocha (1.8.0)\n  mocha (1.9.0)\n\nmsgpack (1.2.10)\n  msgpack (1.3.1)\n\nmultipart-post (2.0.0)\n  multipart-post (2.1.1)\n\nnio4r (2.3.1)\nnokogiri (1.10.3)\n  nio4r (2.5.1)\n  nokogiri (1.10.4)\n\nnotiffany (0.1.1)\n  notiffany (0.1.3)\n\npg_search (2.1.7)\n  pg_search (2.3.0)\n\npublic_suffix (3.0.3)\npuma (3.12.1)\n  public_suffix (4.0.1)\n  puma (4.1.0)\n\nrack-protection (2.0.5)\n  rack-protection (2.0.7)\n\nrails-html-sanitizer (1.0.4)\n  rails-html-sanitizer (1.2.0)\n\nrake (12.3.2)\n rake (12.3.3)\n\nredis (4.1.0)\nregexp_parser (1.4.0)\n  redis (4.1.2)\n  regexp_parser (1.6.0)\n\nruby-progressbar (1.10.0)\n  ruby-progressbar (1.10.1)\n\nsass-rails (5.0.7)\nrailties (&gt;= 4.0.0, &lt; 6)\n  sass-rails (5.0.8)\n  railties (&gt;= 5.2.0)\n\ntwilio-ruby (5.22.3)\n  twilio-ruby (5.25.4)\n\nvcr (4.0.0)\nwebmock (3.5.1)\n  vcr (5.0.0)\n  webmock (3.7.0)\n\nwebsocket-extensions (0.1.3)\n  websocket-extensions (0.1.4)\n\nwicked_pdf (1.1.0)\n</code></pre>\n"}, {"tags": ["ruby", "functional-programming"], "comments": [{"owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 3, "creation_date": 1567532421, "post_id": 57775590, "comment_id": 101987924, "body": "Why don&#39;t you just use class methods (like &#39;static&#39; methods in other languages)?"}, {"owner": {"reputation": 18079, "user_id": 503402, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/873ad707fb34aac8fbdfbfec676e02e9?s=128&d=identicon&r=PG", "display_name": "Max", "link": "https://stackoverflow.com/users/503402/max"}, "reply_to_user": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 0, "creation_date": 1567533030, "post_id": 57775590, "comment_id": 101988165, "body": "@maxpleaner I think OP wants the functions to have a function composition operator, which Ruby&#39;s methods don&#39;t cleanly support"}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 1, "creation_date": 1567538612, "post_id": 57775590, "comment_id": 101990223, "body": "You probably want to use the more minimal JavaScript-style hash declarations: <code>{ start: ... }</code> instead of <code>{ :start =&gt; ... }</code> as that&#39;s been around since Ruby 1.9 and is fully supported now. The old 1.8 style is only necessary when using things like string keys."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 1, "creation_date": 1567539900, "post_id": 57775590, "comment_id": 101990698, "body": "I wrote an answer here on going back from &quot;FP&quot; to OOP because I&#39;m not sure what the goal is here. This isn&#39;t functional programming, it&#39;s just a &quot;bag of functions&quot; as you say. &quot;Functional programming&quot; generally refers to functions that always produce the same output for any given set of arguments, that is <i>they are state-free</i>. Using a closure to encapsulate state completely destroys that. The style you have here isn&#39;t &quot;functional&quot;, but it sure is heavily JavaScript flavoured."}, {"owner": {"reputation": 18079, "user_id": 503402, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/873ad707fb34aac8fbdfbfec676e02e9?s=128&d=identicon&r=PG", "display_name": "Max", "link": "https://stackoverflow.com/users/503402/max"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1567542135, "post_id": 57775590, "comment_id": 101991465, "body": "@tadman definitely agree that this isn&#39;t functional, but it&#39;s close and not that hard to fix."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "reply_to_user": {"reputation": 18079, "user_id": 503402, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/873ad707fb34aac8fbdfbfec676e02e9?s=128&d=identicon&r=PG", "display_name": "Max", "link": "https://stackoverflow.com/users/503402/max"}, "edited": false, "score": 0, "creation_date": 1567546553, "post_id": 57775590, "comment_id": 101992890, "body": "@Max Honestly, it&#39;s nowhere near close. If you&#39;d look at how you&#39;d solve this problem in a functional programming language like Erlang it would look totally different."}, {"owner": {"reputation": 61, "user_id": 10766286, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3bf6d98a48ccb857df68b9a8f1a99d76?s=128&d=identicon&r=PG&f=1", "display_name": "WuMing2", "link": "https://stackoverflow.com/users/10766286/wuming2"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1567564613, "post_id": 57775590, "comment_id": 101996006, "body": "@tadman I understand the fundamental issue with \u201cmessage\u201d but apart from that don\u2019t see what else breaks the FP paradigm. Also you missed the core question: how to organize tens or more of closures in Ruby w/o encapsulation emptying the effect of binding."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1567614993, "post_id": 57775590, "comment_id": 102018406, "body": "I think Ruby is a really bad language to experiment with this form of programming as Ruby&#39;s functional programming comes across much differently. Try this in Erlang or Haskell, languages which force you to think in terms of functions."}], "answers": [{"comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 1, "creation_date": 1567539976, "post_id": 57776618, "comment_id": 101990722, "body": "To make this properly functional you&#39;d have to give everything as an argument, things like <code>bot</code> can&#39;t magically appear. I&#39;m not sure what benefits, if any, this style of programming has."}, {"owner": {"reputation": 61, "user_id": 10766286, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3bf6d98a48ccb857df68b9a8f1a99d76?s=128&d=identicon&r=PG&f=1", "display_name": "WuMing2", "link": "https://stackoverflow.com/users/10766286/wuming2"}, "edited": false, "score": 0, "creation_date": 1567649765, "post_id": 57776618, "comment_id": 102028021, "body": "@Max the anonymous style doesn&#39;t work:  <code>BotControl = Module.new do    Start = proc {bot.run(:async)}  end  BotControl::Start.call  </code>  returns <code>uninitialized constant BotControl::Start (NameError)</code> : why?"}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "reply_to_user": {"reputation": 61, "user_id": 10766286, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3bf6d98a48ccb857df68b9a8f1a99d76?s=128&d=identicon&r=PG&f=1", "display_name": "WuMing2", "link": "https://stackoverflow.com/users/10766286/wuming2"}, "edited": false, "score": 0, "creation_date": 1567650375, "post_id": 57776618, "comment_id": 102028122, "body": "@WuMing2 The example I&#39;d give wouldn&#39;t use procs because that&#39;s not how Ruby works. The &quot;When in Rome&quot; principle applies here. Do it the Ruby way in Ruby. If you want to explore functional programming, that&#39;s a great learning experience, but Ruby&#39;s not the best place to do that. Erlang and by extension Elixir, which is very Ruby inspired and runs in the Erlang VM, are two great places to go for that."}, {"owner": {"reputation": 61, "user_id": 10766286, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3bf6d98a48ccb857df68b9a8f1a99d76?s=128&d=identicon&r=PG&f=1", "display_name": "WuMing2", "link": "https://stackoverflow.com/users/10766286/wuming2"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 1, "creation_date": 1567672425, "post_id": 57776618, "comment_id": 102034937, "body": "@tadman it will be interesting to see a solution in a different language (e.g. Julia). I.e. how you group functions and at the same time leverage closures-ness without encapsulation."}, {"owner": {"reputation": 18079, "user_id": 503402, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/873ad707fb34aac8fbdfbfec676e02e9?s=128&d=identicon&r=PG", "display_name": "Max", "link": "https://stackoverflow.com/users/503402/max"}, "reply_to_user": {"reputation": 61, "user_id": 10766286, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3bf6d98a48ccb857df68b9a8f1a99d76?s=128&d=identicon&r=PG&f=1", "display_name": "WuMing2", "link": "https://stackoverflow.com/users/10766286/wuming2"}, "edited": false, "score": 0, "creation_date": 1567686391, "post_id": 57776618, "comment_id": 102042577, "body": "@WuMing2 edited to clarify why <code>Module.new</code> doesn&#39;t work"}, {"owner": {"reputation": 61, "user_id": 10766286, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3bf6d98a48ccb857df68b9a8f1a99d76?s=128&d=identicon&r=PG&f=1", "display_name": "WuMing2", "link": "https://stackoverflow.com/users/10766286/wuming2"}, "edited": false, "score": 0, "creation_date": 1567762059, "post_id": 57776618, "comment_id": 102068887, "body": "@Max edited my question with the hash form. Interesting, what do you think? I haven\u2019t found references of it in rdoc.  Also a Costant in main() isn\u2019t automatically global?"}, {"owner": {"reputation": 18079, "user_id": 503402, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/873ad707fb34aac8fbdfbfec676e02e9?s=128&d=identicon&r=PG", "display_name": "Max", "link": "https://stackoverflow.com/users/503402/max"}, "reply_to_user": {"reputation": 61, "user_id": 10766286, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3bf6d98a48ccb857df68b9a8f1a99d76?s=128&d=identicon&r=PG&f=1", "display_name": "WuMing2", "link": "https://stackoverflow.com/users/10766286/wuming2"}, "edited": false, "score": 0, "creation_date": 1567776747, "post_id": 57776618, "comment_id": 102076156, "body": "@WuMing2 tadman is right that Ruby is not designed to support FP. <i>Any</i> approach you decide to take is going to have weird issues. I like the module approach because it leverages more of the language and reflects more of a pure functional style. You seem to want a pseudo-functional style where you have closures capturing variables a la javascript. I&#39;m not a big fan of that paradigm, so I don&#39;t have any suggestions of how to do it in a good way."}, {"owner": {"reputation": 61, "user_id": 10766286, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3bf6d98a48ccb857df68b9a8f1a99d76?s=128&d=identicon&r=PG&f=1", "display_name": "WuMing2", "link": "https://stackoverflow.com/users/10766286/wuming2"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 1, "creation_date": 1567780741, "post_id": 57776618, "comment_id": 102078285, "body": "Max and @tadman thanks to both of you. It was nice and useful not to mumble about it on my own."}, {"owner": {"reputation": 61, "user_id": 10766286, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3bf6d98a48ccb857df68b9a8f1a99d76?s=128&d=identicon&r=PG&f=1", "display_name": "WuMing2", "link": "https://stackoverflow.com/users/10766286/wuming2"}, "edited": false, "score": 0, "creation_date": 1567815386, "post_id": 57776618, "comment_id": 102089399, "body": "One follow up question. Closures embed variables outside the block scope. You disagree about using the \u201ccaptured\u201d variables or I misunderstood the closure concept? I am not familiar with JavaScript, just trying to understand."}, {"owner": {"reputation": 18079, "user_id": 503402, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/873ad707fb34aac8fbdfbfec676e02e9?s=128&d=identicon&r=PG", "display_name": "Max", "link": "https://stackoverflow.com/users/503402/max"}, "reply_to_user": {"reputation": 61, "user_id": 10766286, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3bf6d98a48ccb857df68b9a8f1a99d76?s=128&d=identicon&r=PG&f=1", "display_name": "WuMing2", "link": "https://stackoverflow.com/users/10766286/wuming2"}, "edited": false, "score": 0, "creation_date": 1567817216, "post_id": 57776618, "comment_id": 102089612, "body": "@WuMing2 Closures are useful and fine to use in certain contexts, but it looks like you want the entire structure of your program to be based on closures capturing certain local variables when they are created. That sounds like a huge anti-pattern and a headache to maintain."}, {"owner": {"reputation": 61, "user_id": 10766286, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3bf6d98a48ccb857df68b9a8f1a99d76?s=128&d=identicon&r=PG&f=1", "display_name": "WuMing2", "link": "https://stackoverflow.com/users/10766286/wuming2"}, "edited": false, "score": 0, "creation_date": 1567834940, "post_id": 57776618, "comment_id": 102091556, "body": "Thought release from encapsulation and composition capabilities were closures main reason to exist. What\u2019s the use case then?"}, {"owner": {"reputation": 18079, "user_id": 503402, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/873ad707fb34aac8fbdfbfec676e02e9?s=128&d=identicon&r=PG", "display_name": "Max", "link": "https://stackoverflow.com/users/503402/max"}, "reply_to_user": {"reputation": 61, "user_id": 10766286, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3bf6d98a48ccb857df68b9a8f1a99d76?s=128&d=identicon&r=PG&f=1", "display_name": "WuMing2", "link": "https://stackoverflow.com/users/10766286/wuming2"}, "edited": false, "score": 0, "creation_date": 1567857756, "post_id": 57776618, "comment_id": 102095759, "body": "@WuMing2 I see closures as more of a convenience feature: anything you do with a closure you could do explicitly by encapsulating whatever local scope you need in a proper object and then calling a method on that object. But there&#39;s no real benefit to that, so it&#39;s nicer to use closures. Just because a language feature exists doesn&#39;t mean you <i>have</i> to use that feature as much as possible and rely on it for your entire program&#39;s structure. Note that <i>every block in Ruby in a closure</i>! Most blocks should not be capturing local variables!"}], "tags": [], "owner": {"reputation": 18079, "user_id": 503402, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/873ad707fb34aac8fbdfbfec676e02e9?s=128&d=identicon&r=PG", "display_name": "Max", "link": "https://stackoverflow.com/users/503402/max"}, "is_accepted": true, "score": 2, "last_activity_date": 1567686375, "last_edit_date": 1567686375, "creation_date": 1567533278, "answer_id": 57776618, "question_id": 57775590, "link": "https://stackoverflow.com/questions/57775590/how-to-organize-procs-in-ruby/57776618#57776618", "title": "How to organize Procs in Ruby?", "body": "<p>Use modules and constants.</p>\n\n<pre><code>module BotControl\n  Start = proc {bot.run(:async)}\n  Stop = proc do\n      bot.stop\n      exit(0)\n  end\n  Send = proc {DataSpace::Message.then {|m| bot.send_message(channel, m)}}\n  Messaging = proc do |wish|\n      [ Config::MESSAGING[wish.first] , Config::NIGHTTIME_FLAG ].compact.first\n  end\nend\n</code></pre>\n\n<p>Note that this code won't work as-is: the <code>bot</code> variable is not visible! There are a couple approaches to fixing that, but they're beyond the scope of this question (my 2\u00a2, it should be a parameter to those functions).</p>\n\n<p>Usage would look like</p>\n\n<pre><code>(BotControl::Messaging&lt;&lt;CacheControl::GetWish).call\n</code></pre>\n\n<p>Your functions should be constants, so this protects you from reassignment (which a hash wouldn't). Also modules can't be instantiated/inherited so this avoids any kind of OOPness. Another benefit is that modules can be included, so if you have a context where you want some functions to be top-level, you can easily do that.</p>\n\n<hr>\n\n<h2>Edit</h2>\n\n<p>You might be tempted to do this using anonymous modules e.g.</p>\n\n<pre><code>BotControl = Module.new do\n  Start = proc {bot.run(:async)}\n  ...\nend\n</code></pre>\n\n<p>But that won't work because the scope of constants in Ruby is <em>lexical</em> i.e. it matters what module they're inside at the <em>parsing</em> stage, not at runtime. In the above example, at the parser level, <code>Start</code> is simply at top-level, because it is not inside any module (<code>Module.new</code> is just a method call, which is evaluated at runtime). So this approach doesn't actually group anything together.</p>\n"}], "owner": {"reputation": 61, "user_id": 10766286, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3bf6d98a48ccb857df68b9a8f1a99d76?s=128&d=identicon&r=PG&f=1", "display_name": "WuMing2", "link": "https://stackoverflow.com/users/10766286/wuming2"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 137, "favorite_count": 0, "accepted_answer_id": 57776618, "answer_count": 1, "score": 3, "last_activity_date": 1567766032, "creation_date": 1567528226, "last_edit_date": 1567766032, "question_id": 57775590, "link": "https://stackoverflow.com/questions/57775590/how-to-organize-procs-in-ruby", "title": "How to organize Procs in Ruby?", "body": "<p>Translating a script from OOP to FP, I am trying to understand how to replace \"bags of methods\" (classes) with \"bags of procs\".  Procs are those composable (&lt;&lt;), anonymous micro-objects with Binding but I haven't seen an example using more than a couple of #call. My modest script has few tens of methods: replacing them with procs requires some kind of container for code organisation.</p>\n\n<p>Tried to store Procs into hashes. But Hash is not designed with this application in mind.  As example, calling a proc from another proc inside the same hash is awkward.</p>\n\n<p>Tried to store Procs into classes, associated to variables. But encapsulation reduces my capability to access outside variables (losing one key benefits of closures) and complicates access to procs (either with instance variables have to instantiate the class or with class variables have to create class accessor methods).</p>\n\n<p>Tried to store Procs into methods but then where's the gain.</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>\nrequire 'net/http'\nrequire 'json'\nrequire 'iron_cache'\nrequire 'discordrb'\n\nclass Config\n      # config vars\nend\n\ndata_space = {\n    :message =&gt; \"\"\n    }\n\nbot = Discordrb::Bot.new(token: Config::DISCORD_TOKEN, ignore_bots: true)\nchannel = bot.channel(Config::DISCORD_CHANNEL_ID)\ncache = IronCache::Client.new.cache(\"pa\")\n\nbot_control = {\n    :start =&gt; proc {bot.run(:async)},\n    :stop =&gt; proc do\n        bot.stop\n        exit(0)\n    end,\n    :send =&gt; proc {data_space[:message].then {|m| bot.send_message(channel, m)}},\n    \"messaging?\" =&gt; proc do |wish|\n        [ Config::MESSAGING[wish.first] , Config::NIGHTTIME_FLAG ].compact.first\n    end\n}\n\ncache_control = {\n    :get_flag =&gt; proc {|flag| cache.get(flag)&amp;.value},\n    :set_wish =&gt; proc do |wish, exp_sec|\n        cache.put(\"messaging\", wish.to_json, :expires_in =&gt; exp_sec)\n        data_space[:message] &lt;&lt; \"#{wish.first} got it!\"\n    end,\n    :exp_sec =&gt; proc do\n        t = Time.now\n        (t-Time.new(t.year,t.month,t.day,Config::EXP_REF,0,0)).to_i\n    end,\n    :get_wish =&gt; proc do\n        msg = proc {cache_control[:get_flag].call(\"messaging\")}\n        msg ? JSON.parse(msg) : [nil, nil]\n    end\n}\n</code></pre>\n\n<pre class=\"lang-rb prettyprint-override\"><code>bot_control[:start].call\ndata_space[:message] &lt;&lt; \"ah\"\nbot_control[:stop].call if (bot_control[\"messaging?\"]&lt;&lt;cache_control[:get_wish]).call\n(bot_control[:stop]&lt;&lt;bot_control[:send]).call\n</code></pre>\n\n<p>actually delivers.</p>\n\n<p>But isn't the kind of code I consider readable. Or an improvement over OOP.\nPlease advise.</p>\n\n<hr>\n\n<h2>Edit</h2>\n\n<p>Looks like my attempt with a Hash to group procs was in the right direction. As described <a href=\"https://medium.com/@baweaver/functional-programming-in-ruby-closures-ac80547eb40d\" rel=\"nofollow noreferrer\" title=\"elsewhere\">elsewhere</a> a hash within a Proc adds instance methods as #count, #keys and #store to access and manipulate it. Therefore I can write something like:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>\nbc = proc { |args|\n  {\n    start: proc {...},\n    stop: proc {...}\n  }\n}\n\nbot_control = bc.call\nbot_control[:start].call\nbot_control[:stop].call\n\n</code></pre>\n\n<p>With some caveats. Values returned by the hash are procs and composition methods (&lt;&lt; and >>) are added but they don\u2019t work. Also I haven\u2019t found how to reference other values from within the hash. Though it\u2019s possible to add methods (private by default but can be declared public) and reference them from within values. </p>\n\n<p>So I obtained nested closures (variables leak in all the way down) but code at this point isn\u2019t much different from a regular class. #new has become #call (Proc inherit from Method after all) but with not much improvement in FP direction. Please advise. </p>\n"}, {"tags": ["ruby", "graphql", "resolver", "graphql-ruby"], "answers": [{"tags": [], "owner": {"reputation": 70, "user_id": 4060949, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f500078579de4ff8780fc7b9137a7b76?s=128&d=identicon&r=PG&f=1", "display_name": "Hedselu", "link": "https://stackoverflow.com/users/4060949/hedselu"}, "is_accepted": true, "score": 0, "last_activity_date": 1578581059, "creation_date": 1578581059, "answer_id": 59666423, "question_id": 57775424, "link": "https://stackoverflow.com/questions/57775424/undefined-method-deprecation-reason-for-resolvers/59666423#59666423", "title": "Undefined method `deprecation_reason&#39; for Resolvers", "body": "<p>It's pretty old, but maybe someone will use this information. You should change</p>\n\n<pre><code>field :events, function: Resolvers::Events\n</code></pre>\n\n<p>to </p>\n\n<pre><code>field :events, resovler: Resolvers::Events\n</code></pre>\n\n<p>as you are using <code>GraphQL::Schema::Resolver</code> object, not <code>GraphQL::Function</code>.</p>\n"}], "owner": {"reputation": 27, "user_id": 2105510, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oN6YK.png?s=128&g=1", "display_name": "Mat&#237;as Pizarro", "link": "https://stackoverflow.com/users/2105510/mat%c3%adas-pizarro"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 167, "favorite_count": 0, "accepted_answer_id": 59666423, "answer_count": 1, "score": 2, "last_activity_date": 1578581059, "creation_date": 1567527444, "question_id": 57775424, "link": "https://stackoverflow.com/questions/57775424/undefined-method-deprecation-reason-for-resolvers", "title": "Undefined method `deprecation_reason&#39; for Resolvers", "body": "<p>I'm defining a resolver for some fields, using the graphql gem for ruby. </p>\n\n<p>This is the Resolver definition:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>module Resolvers\n  class Events &lt; BaseResolver\n\n    type [Types::EventType], null: true\n\n    argument :input, Types::EventInput, required: true\n\n    def resolve(input:)\n      # do something\n    end\n\n  end\nend\n</code></pre>\n\n<p>This is the BaseResolver class:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>module Resolvers\n  class BaseResolver &lt; GraphQL::Schema::Resolver\n\n  end\nend\n</code></pre>\n\n<p>And this is where I call the Resolver:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>module Types\n  class CommonSpaceType &lt; BaseObject\n\n    field :active, Boolean, null: true\n    field :events, function: Resolvers::Events\n  end\nend\n</code></pre>\n\n<p>This is what I'm getting as a response, using Insomnia:</p>\n\n<p>\"message\": \"undefined method `deprecation_reason' for Resolvers::Events:Class\\nDid you mean?  deprecate_constant\"</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-3", "rubygems"], "answers": [{"tags": [], "owner": {"reputation": 4690, "user_id": 1937435, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/YyN37.jpg?s=128&g=1", "display_name": "Josh Brody", "link": "https://stackoverflow.com/users/1937435/josh-brody"}, "is_accepted": false, "score": 1, "last_activity_date": 1567527502, "creation_date": 1567527502, "answer_id": 57775443, "question_id": 57775365, "link": "https://stackoverflow.com/questions/57775365/how-to-convert-date-with-time-along-with-utc-18-sep-2012095741-0500-to-tim/57775443#57775443", "title": "How to convert date with time along with UTC (18/Sep/2012:09:57:41 -0500) to timestamp in Ruby?", "body": "<pre><code>require 'date' \n\ndate = Date.parse(\"18/Sep/2012:09:57:41 -0500\")\ndate.to_time.to_i # =&gt; 1568782800\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "is_accepted": false, "score": 0, "last_activity_date": 1567536701, "last_edit_date": 1567536701, "creation_date": 1567536344, "answer_id": 57777211, "question_id": 57775365, "link": "https://stackoverflow.com/questions/57775365/how-to-convert-date-with-time-along-with-utc-18-sep-2012095741-0500-to-tim/57777211#57777211", "title": "How to convert date with time along with UTC (18/Sep/2012:09:57:41 -0500) to timestamp in Ruby?", "body": "<p>It's safest to use the class method <a href=\"https://ruby-doc.org/stdlib-2.6.3/libdoc/date/rdoc/DateTime.html#method-c-strptime\" rel=\"nofollow noreferrer\">DateTime::strptime</a> and then convert the resulting <code>DateTime</code> object to a <code>Time</code> object with <a href=\"https://ruby-doc.org/stdlib-2.6.3/libdoc/date/rdoc/DateTime.html#method-i-to_time\" rel=\"nofollow noreferrer\">DateTime#to_time</a>.</p>\n\n<p>The components of the format string used by <code>DateTime#strptime</code> are given in the doc for <a href=\"https://ruby-doc.org/stdlib-2.6.3/libdoc/date/rdoc/DateTime.html#method-i-strftime\" rel=\"nofollow noreferrer\">DateTime#strftime</a>.</p>\n\n<pre><code>str = \"18/Sep/2012:09:57:41 -0500\"\n</code></pre>\n\n<h1><p></p></h1>\n\n<pre><code>require 'time'\n\nfmt = \"%d/%b/%Y:%H:%M:%S %z\"\nDateTime.strptime(str, fmt).to_time\n  #=&gt; 2012-09-18 09:57:41 -0500\n</code></pre>\n\n<h1><p></p></h1>\n\n<pre><code>Date.parse \"Date::parse may work in unexpected ways so I tend to avoid using it.\"\n  #=&gt; #&lt;Date: 2019-05-01 ((2458605j,0s,0n),+0s,2299161j)&gt; \n</code></pre>\n"}], "owner": {"reputation": 159, "user_id": 11341832, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-aWmMF9ZG4mM/AAAAAAAAAAI/AAAAAAAAAxQ/-w_tfJQFeDI/photo.jpg?sz=128", "display_name": "Rajesh G", "link": "https://stackoverflow.com/users/11341832/rajesh-g"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 36, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1567536701, "creation_date": 1567527183, "question_id": 57775365, "link": "https://stackoverflow.com/questions/57775365/how-to-convert-date-with-time-along-with-utc-18-sep-2012095741-0500-to-tim", "title": "How to convert date with time along with UTC (18/Sep/2012:09:57:41 -0500) to timestamp in Ruby?", "body": "<p>I need to convert 18/Sep/2012:09:57:41 -0500 to timestamp in ruby.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "rails-geocoder"], "answers": [{"comments": [{"owner": {"reputation": 65, "user_id": 11536405, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/v16j8.jpg?s=128&g=1", "display_name": "seddka", "link": "https://stackoverflow.com/users/11536405/seddka"}, "edited": false, "score": 0, "creation_date": 1567529500, "post_id": 57775608, "comment_id": 101986832, "body": "Does this mean that i have to override devise create action ?"}, {"owner": {"reputation": 420, "user_id": 1201862, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2XMCc.jpg?s=128&g=1", "display_name": "Gustavo Toro", "link": "https://stackoverflow.com/users/1201862/gustavo-toro"}, "reply_to_user": {"reputation": 65, "user_id": 11536405, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/v16j8.jpg?s=128&g=1", "display_name": "seddka", "link": "https://stackoverflow.com/users/11536405/seddka"}, "edited": false, "score": 0, "creation_date": 1567530254, "post_id": 57775608, "comment_id": 101987135, "body": "I didn&#39;t know that you&#39;re using Devise. In that case, just simple change UserController with RegistrationsController. Updated answer."}, {"owner": {"reputation": 65, "user_id": 11536405, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/v16j8.jpg?s=128&g=1", "display_name": "seddka", "link": "https://stackoverflow.com/users/11536405/seddka"}, "edited": false, "score": 0, "creation_date": 1567537740, "post_id": 57775608, "comment_id": 101989921, "body": "I&#39;m sure your time is so valuable, i&#39;m new to rails, i hope if could take me step to step on how to implement this . i already have a devise controller, i&#39;ll update my question and then keep in mind my <code>user_information.rb</code> is a nested model which belongs to devise <code>user.rb</code> . and what do you mean about implementing helper/model methods ?"}, {"owner": {"reputation": 420, "user_id": 1201862, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2XMCc.jpg?s=128&g=1", "display_name": "Gustavo Toro", "link": "https://stackoverflow.com/users/1201862/gustavo-toro"}, "reply_to_user": {"reputation": 65, "user_id": 11536405, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/v16j8.jpg?s=128&g=1", "display_name": "seddka", "link": "https://stackoverflow.com/users/11536405/seddka"}, "edited": false, "score": 0, "creation_date": 1567538108, "post_id": 57775608, "comment_id": 101990044, "body": "Nested model is not a big deal here, because Devise can handle it. With helper/model methods, I mean, if you copy/paste my solution, it still need implement country_name method, i.e. It could be something like UserInformation.new.country_name(country_code) but it&#39;s up to you."}, {"owner": {"reputation": 65, "user_id": 11536405, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/v16j8.jpg?s=128&g=1", "display_name": "seddka", "link": "https://stackoverflow.com/users/11536405/seddka"}, "edited": false, "score": 0, "creation_date": 1567546933, "post_id": 57775608, "comment_id": 101993010, "body": "in order for this to work i need to set <code>geocoded_by :ip_address</code> ? the documentation doesn&#39;t provide how to really set it up, i still have no idea what i should be doing"}], "tags": [], "owner": {"reputation": 420, "user_id": 1201862, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2XMCc.jpg?s=128&g=1", "display_name": "Gustavo Toro", "link": "https://stackoverflow.com/users/1201862/gustavo-toro"}, "is_accepted": false, "score": 0, "last_activity_date": 1567530326, "last_edit_date": 1567530326, "creation_date": 1567528282, "answer_id": 57775608, "question_id": 57775191, "link": "https://stackoverflow.com/questions/57775191/getting-countries-states-and-cities-in-rails/57775608#57775608", "title": "Getting countries states and cities in rails", "body": "<p>If you want to replace <code>country_select</code> with <code>geocoder</code>, you just need to take this values in controller that you need.</p>\n\n<pre><code>class UsersController &lt; ApplicationController\n  ...\n  def create\n   @user = User.new(user_params)\n   @user.user_information.country = country_name(request.location.country_code)\n   @user.user_information.city = request.location.city\n   @user.save\n  end\nend\n</code></pre>\n\n<p>If you're using Devise...</p>\n\n<pre><code># app/controllers/registrations_controller.rb\nclass RegistrationsController &lt; Devise::RegistrationsController\n  def new\n    super\n  end\n\n  def create\n    # put above logic here\n  end\n\n  def update\n    super\n  end\nend\n</code></pre>\n\n<p>You need to implement helper/model methods needed.</p>\n"}], "owner": {"reputation": 65, "user_id": 11536405, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/v16j8.jpg?s=128&g=1", "display_name": "seddka", "link": "https://stackoverflow.com/users/11536405/seddka"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 414, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1567537858, "creation_date": 1567526492, "last_edit_date": 1567537858, "question_id": 57775191, "link": "https://stackoverflow.com/questions/57775191/getting-countries-states-and-cities-in-rails", "title": "Getting countries states and cities in rails", "body": "<p>I have a user model with a nested model for user's informations, and i have already a working country field with <a href=\"https://github.com/stefanpenner/country_select\" rel=\"nofollow noreferrer\">country_select</a> gem, but it doesn't offer states and cities .</p>\n\n<p>After some research i found this gem <a href=\"http://www.rubygeocoder.com/\" rel=\"nofollow noreferrer\">ruby geocoder</a> and as it says in the documentation :</p>\n\n<p>In Any Rack-Based Framework\nDetect Location of HTTP Request\nGet current user's city and country (using IP address). A location method is added to the standard Rack::Request which returns a Geocoder::Result object:</p>\n\n<pre><code># Rails controller or Sinatra app\ncity = request.location.city\ncountry = request.location.country_code\n</code></pre>\n\n<p>Basically i want to get off using <code>country_select</code> gem and use <code>ruby geocoder</code></p>\n\n<p>I have two models :</p>\n\n<pre><code>models/user.rb\n\nclass User &lt; ApplicationRecord\n  extend FriendlyId\n  friendly_id :username, use: :slugged\n  # Include default devise modules. Others available are:\n  # :confirmable, :lockable, :timeoutable, :trackable and :omniauthable\n  devise :database_authenticatable, :registerable,\n         :recoverable, :rememberable, :validatable\n\n  has_one_attached :avatar, :dependent =&gt; :destroy\n  # User Information\n  has_one :user_information, :dependent =&gt; :destroy\n  accepts_nested_attributes_for :user_information, :allow_destroy =&gt; true\n\n  def with_user_information\n    build_user_information if user_information.nil?\n    self\n  end\n\n  # Login with username or email\n  attr_accessor :login       \n  validates :username, uniqueness: true, presence: true\n\n  def login\n    @login || self.username || self.email\n  end\n\n  def self.find_for_database_authentication(warden_conditions)\n    conditions = warden_conditions.dup\n    if login = conditions.delete(:login)\n      where(conditions.to_h).where([\"lower(username) = :value OR lower(email) = :value\", { :value =&gt; login.downcase }]).first\n    elsif conditions.has_key?(:username) || conditions.has_key?(:email)\n      where(conditions.to_h).first\n    end\n  end\nend\n\n</code></pre>\n\n<p>and a nested model :</p>\n\n<pre><code>models/user_information.rb\n\nclass UserInformation &lt; ApplicationRecord\n  belongs_to :user\n\n  has_one :gender, :dependent =&gt; :destroy\n  accepts_nested_attributes_for :gender, :allow_destroy =&gt; true\n\n  has_one :relationship, :dependent =&gt; :destroy\n  accepts_nested_attributes_for :relationship, :allow_destroy =&gt; true\n\n  def age\n    now = Time.current\n    dob = self.born_in\n    now.year - dob.year - ((now.month &gt; dob.month || (now.month == dob.month &amp;&amp; now.day &gt;= dob.day)) ? 0 : 1)\n  end\n\n  def country_name\n    country = ISO3166::Country[country_code]\n    country.translations[I18n.locale.to_s] || country.name\n  end\nend\n\n</code></pre>\n\n<p>this my devise controller </p>\n\n<pre><code>controllers/accounts_controller.rb\n\nclass AccountsController &lt; Devise::RegistrationsController\n\n  def update\n    self.resource = resource_class.to_adapter.get!(send(:\"current_#{resource_name}\").to_key)\n    prev_unconfirmed_email = resource.unconfirmed_email if resource.respond_to?(:unconfirmed_email)\n    resource_updated = update_resource(resource, account_update_params)\n    yield resource if block_given?\n    if resource_updated\n      set_flash_message_for_update(resource, prev_unconfirmed_email)\n      bypass_sign_in resource, scope: resource_name if sign_in_after_change_password?\n      session[:return_to] ||= request.referer\n      redirect_to session.delete(:return_to)\n    else\n      clean_up_passwords resource\n      set_minimum_password_length\n      session[:return_to] ||= request.referer\n      redirect_to session.delete(:return_to), alert: resource.errors.full_messages[0]\n    end\n  end\n\n  def settings\n    @user = current_user\n    if @user\n      render \"devise/accounts/settings\"\n    else\n      render file: 'public/404', status: 404, formats: [:html]\n    end\n  end\n\n  def passwords\n    @user = current_user\n    if @user\n      render \"devise/accounts/passwords\"\n    else\n      render file: 'public/404', status: 404, formats: [:html]\n    end\n  end\n\n  def security\n    @user = current_user\n    if @user\n      render \"devise/accounts/security\"\n    else\n      render file: 'public/404', status: 404, formats: [:html]\n    end\n  end\n\n  protected\n\n  def update_resource(resource, params)\n    if params[:current_password].blank? &amp;&amp; params[:password].blank? &amp;&amp; params[:password_confirmation].blank? &amp;&amp; params[:email].blank?\n     resource.update_without_password(params.except(:current_password, :password, :password_confirmation, :email))\n    else\n      resource.update_with_password(params)\n    end\n  end\nend\n</code></pre>\n"}, {"tags": ["ruby", "ruby-on-rails-4", "model"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 7574951, "user_type": "registered", "profile_image": "https://graph.facebook.com/10208457119449380/picture?type=large", "display_name": "Vladan Petrovic", "link": "https://stackoverflow.com/users/7574951/vladan-petrovic"}, "edited": false, "score": 0, "creation_date": 1567529213, "post_id": 57775294, "comment_id": 101986743, "body": "Yep, but i can&#39;t access role or grant inside RoleGrant Model. I can access RoleGrant.last.account and etc but can&#39;t do this what i need. I see :grant  and :role are accessible as this model RoleGrant in DB have: role_id and grant_id, but i need their db prop account_id :)"}, {"owner": {"reputation": 1, "user_id": 10089418, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-nLrtiN5cDQo/AAAAAAAAAAI/AAAAAAAAAAw/fuH0SF4FYSo/photo.jpg?sz=128", "display_name": "Rilind Mehmeti", "link": "https://stackoverflow.com/users/10089418/rilind-mehmeti"}, "reply_to_user": {"reputation": 1, "user_id": 7574951, "user_type": "registered", "profile_image": "https://graph.facebook.com/10208457119449380/picture?type=large", "display_name": "Vladan Petrovic", "link": "https://stackoverflow.com/users/7574951/vladan-petrovic"}, "edited": false, "score": 0, "creation_date": 1567603180, "post_id": 57775294, "comment_id": 102011838, "body": "if you try to debug do you have role_id and grant_id present in the object ?"}, {"owner": {"reputation": 1, "user_id": 7574951, "user_type": "registered", "profile_image": "https://graph.facebook.com/10208457119449380/picture?type=large", "display_name": "Vladan Petrovic", "link": "https://stackoverflow.com/users/7574951/vladan-petrovic"}, "edited": false, "score": 0, "creation_date": 1567981057, "post_id": 57775294, "comment_id": 102119492, "body": "Yep i solved this with checking if i actually have role_id and grant_id. Thank you very much Rilind :)"}], "tags": [], "owner": {"reputation": 1, "user_id": 10089418, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-nLrtiN5cDQo/AAAAAAAAAAI/AAAAAAAAAAw/fuH0SF4FYSo/photo.jpg?sz=128", "display_name": "Rilind Mehmeti", "link": "https://stackoverflow.com/users/10089418/rilind-mehmeti"}, "is_accepted": false, "score": 0, "last_activity_date": 1567526905, "creation_date": 1567526905, "answer_id": 57775294, "question_id": 57774989, "link": "https://stackoverflow.com/questions/57774989/how-to-access-parent-model-db-props-id-of-parent-parent-inside-children-model/57775294#57775294", "title": "How to access parent Model DB props (_id of parent parent) inside children Model in Rails?", "body": "<p>Well if you want to do a validation around that would suggest adding a custom validation like for example</p>\n\n<pre><code>def validate_same_account_ids\n  errors.add(:base, 'Role and Grant account_ids do not match!') if role.account_id != grant.account_id\nend\n</code></pre>\n\n<p>Then you can call this before_validation so something like</p>\n\n<pre><code>before_validation :validate_same_account_ids\n</code></pre>\n\n<p>But you might want to add an extra check as well to see if you have actually role and grant present in the RoleGrant record that you are creating</p>\n"}], "owner": {"reputation": 1, "user_id": 7574951, "user_type": "registered", "profile_image": "https://graph.facebook.com/10208457119449380/picture?type=large", "display_name": "Vladan Petrovic", "link": "https://stackoverflow.com/users/7574951/vladan-petrovic"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 31, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1567526905, "creation_date": 1567525551, "question_id": 57774989, "link": "https://stackoverflow.com/questions/57774989/how-to-access-parent-model-db-props-id-of-parent-parent-inside-children-model", "title": "How to access parent Model DB props (_id of parent parent) inside children Model in Rails?", "body": "<p>I am having Model Data Relationship in Rails\nEx, 4 Models. Account, Role and Grant Model which belongs_to Account and RoleGrant Model which belongs to both Role and Grant Model.\nNow, i need to access account_id of Role and Grant Model INSIDE RoleGrant Model in order to compare their account_id.</p>\n\n<p>I try really hard but can't resolve this even after hours of searching.\nI know that i can access (in rails console for example) RoleGrant.last.role.account and will get account with account_id i need but how to do this inside RoleGrant Model in order to validate Role and Grant account_id are same?</p>\n\n<p>Code below is showing RoleGrant class which is doing validation for :role and :grant Model only.</p>\n\n<pre><code>class RoleGrant &lt; ApplicationRecord\n  # Description\n  # An RoleGrant specifies an Grant within role\n\n  # Includes\n  include DefaultPolicyInfo\n\n  # Relations\n  belongs_to :role\n  belongs_to :grant\n\n  # Belongs_to Validation\n  validates :role_id,\n            presence: { if: -&gt; { !role_id.nil? &amp;&amp; role_id_changed? }, message: :not_valid },\n            numericality: { allow_nil: false, only_integer: true, message: :numericality_not_blank }\n\n  validates :grant_id,\n            presence: { if: -&gt; { !grant_id.nil? &amp;&amp; grant_id_changed? }, message: :not_valid },\n            uniqueness: { scope: %i[role_id] },\n            numericality: { allow_nil: false, only_integer: true, message: :numericality_not_blank }\n</code></pre>\n"}, {"tags": ["ruby", "ruby-block"], "comments": [{"owner": {"reputation": 18079, "user_id": 503402, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/873ad707fb34aac8fbdfbfec676e02e9?s=128&d=identicon&r=PG", "display_name": "Max", "link": "https://stackoverflow.com/users/503402/max"}, "edited": false, "score": 1, "creation_date": 1567542783, "post_id": 57774459, "comment_id": 101991699, "body": "Why &quot;make dir variable visible without doing the following&quot;??? Your final example is absolutely the correct way to do it."}, {"owner": {"reputation": 9, "user_id": 2862393, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fe25196b45570f762a25246524a94a01?s=128&d=identicon&r=PG&f=1", "display_name": "mSourire", "link": "https://stackoverflow.com/users/2862393/msourire"}, "reply_to_user": {"reputation": 18079, "user_id": 503402, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/873ad707fb34aac8fbdfbfec676e02e9?s=128&d=identicon&r=PG", "display_name": "Max", "link": "https://stackoverflow.com/users/503402/max"}, "edited": false, "score": 0, "creation_date": 1567550136, "post_id": 57774459, "comment_id": 101993724, "body": "I hoped, to make the code cleaner."}, {"owner": {"reputation": 18079, "user_id": 503402, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/873ad707fb34aac8fbdfbfec676e02e9?s=128&d=identicon&r=PG", "display_name": "Max", "link": "https://stackoverflow.com/users/503402/max"}, "edited": false, "score": 0, "creation_date": 1567599110, "post_id": 57774459, "comment_id": 102009560, "body": "Less code is not always cleaner code. What you&#39;re asking for is how to create an <i>implicit</i> dependency between your methods. That is one of the dirtiest anti-patterns there is."}], "answers": [{"comments": [{"owner": {"reputation": 18079, "user_id": 503402, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/873ad707fb34aac8fbdfbfec676e02e9?s=128&d=identicon&r=PG", "display_name": "Max", "link": "https://stackoverflow.com/users/503402/max"}, "edited": false, "score": 0, "creation_date": 1567542878, "post_id": 57775039, "comment_id": 101991746, "body": "More complicated, more error prone, less flexible. This answers the question as asked but is not a good idea in general."}, {"owner": {"reputation": 9, "user_id": 2862393, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fe25196b45570f762a25246524a94a01?s=128&d=identicon&r=PG&f=1", "display_name": "mSourire", "link": "https://stackoverflow.com/users/2862393/msourire"}, "edited": false, "score": 0, "creation_date": 1567549537, "post_id": 57775039, "comment_id": 101993603, "body": "Thank you very much. I had an idea with an instance variable, but intended to figure out, whether I miss something in understanding of block&#39;s local variable scope. In my example <i>extract_snapshots</i> is called in the same context with <i>dir</i> variable: <code>using_temporary_directory { |dir| extract_snapshots }</code> So, I thought, the variable should be visible inside the method. But it looks like I understand this correctly: the closure would work, if <i>dir</i> variable were visible in the context, where <i>extract_snapshots</i> is defined."}, {"owner": {"reputation": 8640, "user_id": 4055042, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/cd04c63d95d27033b53d4d83fea40c02?s=128&d=identicon&r=PG&f=1", "display_name": "SRack", "link": "https://stackoverflow.com/users/4055042/srack"}, "reply_to_user": {"reputation": 18079, "user_id": 503402, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/873ad707fb34aac8fbdfbfec676e02e9?s=128&d=identicon&r=PG", "display_name": "Max", "link": "https://stackoverflow.com/users/503402/max"}, "edited": false, "score": 0, "creation_date": 1567585503, "post_id": 57775039, "comment_id": 102002284, "body": "@Max thanks for the feedback, I&#39;d tend to agree - earlier versions of my question were clearer on this, though I trimmed it down for brevity. Hope this has helped clarify the issue somewhat though mSourire :)"}], "tags": [], "owner": {"reputation": 8640, "user_id": 4055042, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/cd04c63d95d27033b53d4d83fea40c02?s=128&d=identicon&r=PG&f=1", "display_name": "SRack", "link": "https://stackoverflow.com/users/4055042/srack"}, "is_accepted": false, "score": 0, "last_activity_date": 1567526108, "last_edit_date": 1567526108, "creation_date": 1567525769, "answer_id": 57775039, "question_id": 57774459, "link": "https://stackoverflow.com/questions/57774459/ruby-how-to-make-variables-visible-inside-methods-within-a-block/57775039#57775039", "title": "Ruby: how to make variables visible inside methods within a block?", "body": "<p>You could do something like this, using <a href=\"https://apidock.com/ruby/Module/attr_accessor\" rel=\"nofollow noreferrer\"><code>attr_accessor</code></a>: </p>\n\n<pre><code>  attr_accessor :dir\n\n  def perform\n    using_temporary_directory do\n      extract_snapshots\n      send_snapshots\n    end\n  end\n\n  def using_temporary_directory(&amp;b)\n    Dir.mktmpdir do |dir| \n      self.dir = dir\n      b.call\n    end\n  ensure # clear the variable when you're finished\n    self.dir = nil\n  end\n\n  def extract_snapshots\n    system \"ffmpeg -i #{video_file_path} -vf fps=1/#{INTERVAL} #{dir}/%04d.jpg\"\n  end\n</code></pre>\n\n<p>For an explanation, <code>attr_accessor</code> creates reader and writer methods for you, the equivalent of the following:</p>\n\n<pre><code>def dir\n  @dir\nend\n\ndef dir=(val)\n  @dir=(val)\nend\n</code></pre>\n\n<p>N.B. in my opinion there's nothing wrong with doing it the way you've specified towards the end of your question, so pick and choose as suits your circumstances :)</p>\n\n<p>Hope this helps - let me know how you get on or if you have any questions.</p>\n"}], "owner": {"reputation": 9, "user_id": 2862393, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fe25196b45570f762a25246524a94a01?s=128&d=identicon&r=PG&f=1", "display_name": "mSourire", "link": "https://stackoverflow.com/users/2862393/msourire"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 55, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1567526108, "creation_date": 1567523395, "question_id": 57774459, "link": "https://stackoverflow.com/questions/57774459/ruby-how-to-make-variables-visible-inside-methods-within-a-block", "title": "Ruby: how to make variables visible inside methods within a block?", "body": "<p>The following code gives me\n<code>NameError: undefined local variable or method `dir'</code>\nin <em>extract_snapshots</em> method.</p>\n\n<p>The code is intended to extract snapshots from a video, store them in a created temporary directory, send the snapshots to a service and remove the directory after.</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>  def perform\n    using_temporary_directory do |dir|\n      extract_snapshots\n      send_snapshots\n    end\n  end\n\n  def using_temporary_directory(&amp;b)\n    Dir.mktmpdir { |dir| b.call(dir) }\n  end\n\n  def extract_snapshots\n    system \"ffmpeg -i #{video_file_path} -vf fps=1/#{INTERVAL} #{dir}/%04d.jpg\"\n  end\n</code></pre>\n\n<p>I thought, that <em>dir</em> variable should be visible in <em>extract_snapshots</em> and <em>send_snapshots</em>, because it is on the same level. But it isn't in the scope of those methods.\nIs it possible to make <em>dir</em> variable visible without doing the following:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>  def perform\n    using_temporary_directory do |dir|\n      extract_snapshots(dir)\n      send_snapshots(dir)\n    end\n  end\n</code></pre>\n\n<p>?</p>\n"}, {"tags": ["ruby-on-rails", "json", "ruby"], "comments": [{"owner": {"reputation": 2262, "user_id": 4101569, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/15c4c64e58bc5cdeec8e7ce067131a54?s=128&d=identicon&r=PG", "display_name": "katafrakt", "link": "https://stackoverflow.com/users/4101569/katafrakt"}, "edited": false, "score": 1, "creation_date": 1567520335, "post_id": 57773435, "comment_id": 101982330, "body": "<code>parsed_body</code> has top-level key <code>:result</code>, so you probably need <code>session[:user_id] = parsed_body[:result][0][:id]</code>, but you haven&#39;t given us any hints what is actually wrong in the example you provided. Does it save with wrong id? Or raise exception? By the way, please do not call API from the model."}, {"owner": {"reputation": 49, "user_id": 10428162, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-CwmSCFNKDYA/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DUhJsNIWdxk890DKCpD-46quEGkqg/mo/photo.jpg?sz=128", "display_name": "Harshal Jani", "link": "https://stackoverflow.com/users/10428162/harshal-jani"}, "reply_to_user": {"reputation": 2262, "user_id": 4101569, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/15c4c64e58bc5cdeec8e7ce067131a54?s=128&d=identicon&r=PG", "display_name": "katafrakt", "link": "https://stackoverflow.com/users/4101569/katafrakt"}, "edited": false, "score": 0, "creation_date": 1567522354, "post_id": 57773435, "comment_id": 101983490, "body": "@katafrakt it gives a &quot;NoMethodError in UsersController#create undefined method `[]&#39; for nil:NilClass&quot; error for the implementation I did (mentioned above). My API is a php file that communicates with the phpmyadmin database so I am interacting with it. Frontend Rails - Backend PHP."}, {"owner": {"reputation": 2262, "user_id": 4101569, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/15c4c64e58bc5cdeec8e7ce067131a54?s=128&d=identicon&r=PG", "display_name": "katafrakt", "link": "https://stackoverflow.com/users/4101569/katafrakt"}, "edited": false, "score": 0, "creation_date": 1567522589, "post_id": 57773435, "comment_id": 101983624, "body": "That would be because <code>parsed_body[0]</code> is indeed a <code>nil</code>. Try <code>parsed_body[:result][0][:id]</code> as I mentioned above."}, {"owner": {"reputation": 49, "user_id": 10428162, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-CwmSCFNKDYA/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DUhJsNIWdxk890DKCpD-46quEGkqg/mo/photo.jpg?sz=128", "display_name": "Harshal Jani", "link": "https://stackoverflow.com/users/10428162/harshal-jani"}, "reply_to_user": {"reputation": 2262, "user_id": 4101569, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/15c4c64e58bc5cdeec8e7ce067131a54?s=128&d=identicon&r=PG", "display_name": "katafrakt", "link": "https://stackoverflow.com/users/4101569/katafrakt"}, "edited": false, "score": 0, "creation_date": 1567522794, "post_id": 57773435, "comment_id": 101983742, "body": "@katafrakt As suggested by you I did parsed_body[:result][0][:id]. However, it is just returning me the very 1st id value. What do I do to store the id of the user who registers by inputting his/her id."}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 10089418, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-nLrtiN5cDQo/AAAAAAAAAAI/AAAAAAAAAAw/fuH0SF4FYSo/photo.jpg?sz=128", "display_name": "Rilind Mehmeti", "link": "https://stackoverflow.com/users/10089418/rilind-mehmeti"}, "is_accepted": false, "score": 0, "last_activity_date": 1567527464, "creation_date": 1567527464, "answer_id": 57775429, "question_id": 57773435, "link": "https://stackoverflow.com/questions/57773435/how-can-i-parse-a-json-response-body-to-store-a-keys-value-in-ruby-on-rails/57775429#57775429", "title": "How can I parse a json response.body to store a key&#39;s value in ruby on rails?", "body": "<p>If you want to get the last id in the array that is returned then use the</p>\n\n<pre><code>parsed_body[:result][-1][:id]\n</code></pre>\n"}], "owner": {"reputation": 49, "user_id": 10428162, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-CwmSCFNKDYA/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DUhJsNIWdxk890DKCpD-46quEGkqg/mo/photo.jpg?sz=128", "display_name": "Harshal Jani", "link": "https://stackoverflow.com/users/10428162/harshal-jani"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 214, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1567527464, "creation_date": 1567519702, "question_id": 57773435, "link": "https://stackoverflow.com/questions/57773435/how-can-i-parse-a-json-response-body-to-store-a-keys-value-in-ruby-on-rails", "title": "How can I parse a json response.body to store a key&#39;s value in ruby on rails?", "body": "<p>I am receiving a json response (response.body) from the api call I am making with my model and in my controller I would like to parse it to store its id key's value in my session[:user_id]. </p>\n\n<p>I've tried to implement it in the following way</p>\n\n<pre><code>parsed_body = JSON.parse(User.new.get_credentials, :symbolize_names =&gt; true)\nputs \"The parsed_body is: #{parsed_body}\"\nsession[:user_id] = parsed_body[0][:id]\nputs \"The session id is: #{session[:user_id]} \"\n</code></pre>\n\n<p>The response.body is:</p>\n\n<pre><code>{\"result\":[{\"id\":\"3\",\"username\":\"Sam\",\"password\":\"111\"},{\"id\":\"4\",\"username\":\"Harshal\",\"password\":\"1234\"},{\"id\":\"5\",\"username\":\"Dev\",\"password\":\"112\"},{\"id\":\"6\",\"username\":\"Lam\",\"password\":\"113\"},{\"id\":\"7\",\"username\":\"Tim\",\"password\":\"114\"},{\"id\":\"8\",\"username\":\"Harry\",\"password\":\"222\"}]}\n</code></pre>\n\n<p>The parsed_body is:</p>\n\n<pre><code>{:result=&gt;[{:id=&gt;\"3\", :username=&gt;\"Sam\", :password=&gt;\"111\"}, {:id=&gt;\"4\", :username=&gt;\"Harshal\", :password=&gt;\"1234\"}, {:id=&gt;\"5\", :username=&gt;\"Dev\", :password=&gt;\"112\"}, {:id=&gt;\"6\", :username=&gt;\"Lam\", :password=&gt;\"113\"}, {:id=&gt;\"7\", :username=&gt;\"Tim\", :password=&gt;\"114\"}, {:id=&gt;\"8\", :username=&gt;\"Harry\", :password=&gt;\"222\"}]}\n</code></pre>\n\n<p>Here is my code for users controller, user model and sessions controller:</p>\n\n<p>Users Controller</p>\n\n<pre><code>class UsersController &lt; ApplicationController\n     def create\n        @users = User.new(token: user_params).credentials\n        parsed_body = JSON.parse(User.new.get_credentials, :symbolize_names =&gt; true)\n        puts \"The parsed_body is: #{parsed_body}\"\n        session[:user_id] = parsed_body[0][:id]\n        puts \"The session id is: #{session[:user_id]} \"\n        redirect_to '/dashboard'\n      end\n\n      private \n        def user_params\n          params.require(:user).permit(:id, :username, :password).to_hash\n        end\nend\n</code></pre>\n\n<p>User Model</p>\n\n<pre><code>class User\n\n   def initialize(attributes={})\n        @token ||= attributes[:token]\n    end\n\n   def credentials\n        my_connection = Net::HTTP.new('localhost', 8080)\n        request = my_connection.post('/restapitrial/index.php/Users/insert/', @token.to_json, \"Content-Type\" =&gt; \"application/json\")\n  end\n\n  def get_credentials\n        my_connection = Net::HTTP.new('localhost', 8080)\n        request = my_connection.get('/restapitrial/index.php/Users/displayinfo/', \"Content-Type\" =&gt; \"application/json\")\n        puts \"The req body is #{request.body}\"\n        return request.body\n  end\nend\n</code></pre>\n\n<p>Sessions Controller</p>\n\n<pre><code>class SessionsController &lt; ApplicationController\n\n    def create\n        user = User.find_by(id: login_params[:id])\n        if user &amp;&amp; user.authenticate(login_params[:password])\n            session[:user_id] = user.id\n        redirect_to '/dashboard'\n        else\n            flash[:login_errors] = ['invalid credentials']\n            redirect_to '/'\n        end\n    end\n\n    private \n        def login_params\n            params.require(:login).permit(:id, :username, :password)\n        end\n\nend\n</code></pre>\n"}, {"tags": ["regex", "ruby", "ruby-on-rails-5"], "comments": [{"owner": {"reputation": 481662, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 0, "creation_date": 1567518246, "post_id": 57773003, "comment_id": 101981079, "body": "Looks like you are looking to create a regex, but do not know where to get started. Please check <a href=\"https://stackoverflow.com/questions/22937618\">Reference - What does this regex mean</a> resource, it has plenty  of hints. Also, refer to <a href=\"https://stackoverflow.com/a/2759417/3832970\">Learning Regular Expressions</a> post for some basic regex info. Once you get some expression ready and still have issues with the solution, please edit the question with the latest details and we&#39;ll be glad to help you fix the problem."}, {"owner": {"reputation": 180, "user_id": 11956424, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c7aa174ebed665ba900d9291d298f07?s=128&d=identicon&r=PG&f=1", "display_name": "Amal", "link": "https://stackoverflow.com/users/11956424/amal"}, "reply_to_user": {"reputation": 481662, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 0, "creation_date": 1567518521, "post_id": 57773003, "comment_id": 101981235, "body": "@WiktorStribi\u017cew I will surely check it out but can you please reopen the thread if needed."}, {"owner": {"reputation": 481662, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 0, "creation_date": 1567518706, "post_id": 57773003, "comment_id": 101981356, "body": "<i>Once you get some expression ready and still have issues with the solution, please edit the question with the latest details and we&#39;ll be glad to help you fix the problem.</i>"}], "owner": {"reputation": 180, "user_id": 11956424, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c7aa174ebed665ba900d9291d298f07?s=128&d=identicon&r=PG&f=1", "display_name": "Amal", "link": "https://stackoverflow.com/users/11956424/amal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 19, "favorite_count": 0, "closed_date": 1567518232, "answer_count": 0, "score": 0, "last_activity_date": 1567518164, "creation_date": 1567518164, "question_id": 57773003, "link": "https://stackoverflow.com/questions/57773003/extract-digits-before-and-after-a-string-regular-expression-ruby", "closed_reason": "Duplicate", "title": "Extract digits before and after a string regular expression ruby", "body": "<p>I am trying to get the digits before and after a specific word using regular expression. </p>\n\n<p>Suppose the string i want to test is </p>\n\n<p><strong>\"Started walking 8 hours 9\"</strong></p>\n\n<p>I want to get both the numbers <strong>8</strong> and <strong>9</strong> between <strong>hours</strong>. Please don't mind the grammar of the sentence it is just for an example.</p>\n\n<p>Help is much appreciated. Thanks.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "api", "elasticsearch", "faraday"], "comments": [{"owner": {"reputation": 2262, "user_id": 4101569, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/15c4c64e58bc5cdeec8e7ce067131a54?s=128&d=identicon&r=PG", "display_name": "katafrakt", "link": "https://stackoverflow.com/users/4101569/katafrakt"}, "edited": false, "score": 0, "creation_date": 1567520024, "post_id": 57772613, "comment_id": 101982144, "body": "What is JSONParser? I think it&#39;s not anything standard to Faraday, looking at this: <a href=\"https://github.com/lostisland/faraday/search?q=JSONParser&amp;unscoped_q=JSONParser\" rel=\"nofollow noreferrer\">github.com/lostisland/faraday/&hellip;</a>"}, {"owner": {"reputation": 17, "user_id": 6453242, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/343f93e760e97ac93fa205fbee1ef4ce?s=128&d=identicon&r=PG&f=1", "display_name": "toxerli", "link": "https://stackoverflow.com/users/6453242/toxerli"}, "reply_to_user": {"reputation": 2262, "user_id": 4101569, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/15c4c64e58bc5cdeec8e7ce067131a54?s=128&d=identicon&r=PG", "display_name": "katafrakt", "link": "https://stackoverflow.com/users/4101569/katafrakt"}, "edited": false, "score": 0, "creation_date": 1567520646, "post_id": 57772613, "comment_id": 101982488, "body": "JSONParsers is a custom class to parse the response. I removed it and now it works."}, {"owner": {"reputation": 2262, "user_id": 4101569, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/15c4c64e58bc5cdeec8e7ce067131a54?s=128&d=identicon&r=PG", "display_name": "katafrakt", "link": "https://stackoverflow.com/users/4101569/katafrakt"}, "edited": false, "score": 0, "creation_date": 1567520683, "post_id": 57772613, "comment_id": 101982506, "body": "Good. I guess it assumed that received JSON is an object, not an array."}, {"owner": {"reputation": 17, "user_id": 6453242, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/343f93e760e97ac93fa205fbee1ef4ce?s=128&d=identicon&r=PG&f=1", "display_name": "toxerli", "link": "https://stackoverflow.com/users/6453242/toxerli"}, "reply_to_user": {"reputation": 2262, "user_id": 4101569, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/15c4c64e58bc5cdeec8e7ce067131a54?s=128&d=identicon&r=PG", "display_name": "katafrakt", "link": "https://stackoverflow.com/users/4101569/katafrakt"}, "edited": false, "score": 0, "creation_date": 1567586746, "post_id": 57772613, "comment_id": 102002929, "body": "Exactly. It &#39;has_key?&#39;ed a key in the root, but arrays obviously don&#39;t have keys."}], "owner": {"reputation": 17, "user_id": 6453242, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/343f93e760e97ac93fa205fbee1ef4ce?s=128&d=identicon&r=PG&f=1", "display_name": "toxerli", "link": "https://stackoverflow.com/users/6453242/toxerli"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 100, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1567516763, "creation_date": 1567516763, "question_id": 57772613, "link": "https://stackoverflow.com/questions/57772613/how-to-handle-array-response-from-elastic-api-with-faraday", "title": "How to handle array response from elastic api with faraday?", "body": "<p>I want to receive all Elastic Cloud configuration templates from the Elastic Cloud API with faraday in my Ruby on Rails application.</p>\n\n<p>I've tried to workaround and modify the api call, but it's not possible to not get an array as a response.</p>\n\n<p>This is the repsonse from the api:</p>\n\n<pre><code>[\n  {\n    \"name\": \"Small Template\",\n    \"id\": 1\n  },\n  {\n    \"name\": \"Medium Template\",\n    \"id\": 2\n  },\n  {\n    \"name\": \"Big Template\",\n    \"id\": 3\n  }\n]\n</code></pre>\n\n<p>This is my faraday configuration.</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>Faraday.new(url: \"https://#{ENV['ECE_USERNAME']}:#{ENV['ECE_PASSWORD']}@#{ENV['ECE_HOST']}\") do |c|\n      c.response :json, parser_options: {symbolize_names: true}\n      c.response :logger\n      c.use JSONParser\n      c.adapter Faraday.default_adapter\nend\n</code></pre>\n\n<p>And the api call:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>@conn.get('/api/v1/platform/configuration/templates/deployments?stack_version').body\n</code></pre>\n\n<p>This is the error message I receive</p>\n\n<pre><code>undefined method `has_key?' for #&lt;Array:xxxxx&gt;\n</code></pre>\n\n<p>I don't want to use anything else, but faraday. I'm open to new gems to help faraday, but this client should stay.  </p>\n\n<p>How can I setup faraday to handle the array response or how can I workaround my problem?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "devise", "apartment-gem"], "answers": [{"tags": [], "owner": {"reputation": 7944, "user_id": 10907864, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/tGpcY.jpg?s=128&g=1", "display_name": "Promise Preston", "link": "https://stackoverflow.com/users/10907864/promise-preston"}, "is_accepted": true, "score": 0, "last_activity_date": 1567511948, "creation_date": 1567511948, "answer_id": 57771338, "question_id": 57771337, "link": "https://stackoverflow.com/questions/57771337/apartment-tenantnotfound-one-of-the-following-schemas-is-invalid/57771338#57771338", "title": "Apartment: TenantNotFound - One of the following schema(s) is invalid", "body": "<p><strong>Here's how I fixed it</strong></p>\n\n<p>I simply added an after_create callback called <code>create_tenant</code> to the model of the subdomain for my multi-tenant, which is <code>user.rb</code> in <code>app/models/user.rb</code></p>\n\n<pre><code>class User &lt; ApplicationRecord\n  after_create :create_tenant\n\n  private\n\n  def create_tenant\n    Apartment::Tenant.create(subdomain)\n  end\nend \n</code></pre>\n\n<p>Use this if you used <strong>Devise</strong> for Authentication</p>\n\n<pre><code>class User &lt; ApplicationRecord\n  after_create :create_tenant\n\n  # :confirmable, :lockable, :timeoutable, :trackable and :omniauthable\n  devise :database_authenticatable, :registerable,\n         :recoverable, :rememberable, :validatable\n\n  private\n\n  def create_tenant\n    Apartment::Tenant.create(subdomain)\n  end\nend\n</code></pre>\n\n<p><strong>N/B:</strong> My model name for the Tenant is <strong>User</strong>, your model name may be different, so check through your <code>app/models/</code> to see the model name that you used for the <strong>multi-tenant</strong></p>\n\n<p>You can try creating new tenants again, and everything should run fine.</p>\n\n<p>This advice below may apply to only those who used <strong>Devise</strong> for authentication or to every other person using an authentication system</p>\n\n<p>If you run into any issue like this</p>\n\n<blockquote>\n  <p>Filter chain halted as :require_no_authentication rendered or redirected</p>\n</blockquote>\n\n<p>when trying to fix this issue of <strong>Tenant Not Found</strong>, simply restart your local server by using the code below</p>\n\n<pre><code>rails server\n</code></pre>\n\n<p>and then visit the link below to edit your newly created users/tenant</p>\n\n<pre><code>localhost:3000/users/edit\n</code></pre>\n\n<p><strong>N/B:</strong> The <code>users</code> in <code>localhost:3000/users/edit</code> represents the plural name (table) of the model that I used for my multi-tenant.</p>\n\n<p>When the page opens up, simply <strong>Delete/Cancel the Account</strong> and then that you've created already.</p>\n\n<p>Now you can try creating new tenants again, and everything should run fine.</p>\n\n<p>That's all.</p>\n\n<p><strong>I hope this helps</strong></p>\n"}], "owner": {"reputation": 7944, "user_id": 10907864, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/tGpcY.jpg?s=128&g=1", "display_name": "Promise Preston", "link": "https://stackoverflow.com/users/10907864/promise-preston"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 676, "favorite_count": 0, "accepted_answer_id": 57771338, "answer_count": 1, "score": 1, "last_activity_date": 1567511948, "creation_date": 1567511948, "question_id": 57771337, "link": "https://stackoverflow.com/questions/57771337/apartment-tenantnotfound-one-of-the-following-schemas-is-invalid", "title": "Apartment: TenantNotFound - One of the following schema(s) is invalid", "body": "<p>I am using the <a href=\"https://github.com/influitive/apartment\" rel=\"nofollow noreferrer\">Apartment Gem</a> for the first time for Multitenancy in a Ruby on Rails project. I am trying to create multiple tenants for users in your digital library Rails application. </p>\n\n<p>I am using <a href=\"https://github.com/plataformatec/devise\" rel=\"nofollow noreferrer\">Devise Gem</a> for the authentication of the application, and I have generated the and I have generated config file by running the code below in my terminal</p>\n\n<pre><code>rails generate devise:install\n</code></pre>\n\n<p>I have also generated a <strong>User</strong> model for <strong>Devise</strong> using the code below in my terminal</p>\n\n<pre><code>rails generate devise User\n</code></pre>\n\n<p>And for the <strong>Apartment Gem</strong>, I have installed it and generated the config file by running the code below in my terminal</p>\n\n<pre><code>bundle exec rails generate apartment:install\n</code></pre>\n\n<p>I have also configured the <code>config/initializers/apartment.rb</code> initializer file as needed using the documentation provided, and I have created a new tenant via my signup page at</p>\n\n<pre><code>localhost:3000/users/sign_up\n</code></pre>\n\n<p>But when I try viewing the newly created tenant at</p>\n\n<pre><code>http://newtenant.lvh.me:3000/\n</code></pre>\n\n<p>I get the error below</p>\n\n<blockquote>\n  <p>Apartment::TenantNotFound(One of the following schema(s) is invalid: \"\" \"public\")</p>\n</blockquote>\n\n<p>I have tried to figure out the cause of the issue, but I still haven't been fortunate to get it fixed. I need some help. Thank you in advance.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "activerecord"], "comments": [{"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1567512637, "post_id": 57771245, "comment_id": 101977930, "body": "The subquery is not in the SELECT part of the original query, though."}, {"owner": {"reputation": 766, "user_id": 1488591, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/4373e8b5ebf359cb601120389378406a?s=128&d=identicon&r=PG", "display_name": "kunashir", "link": "https://stackoverflow.com/users/1488591/kunashir"}, "edited": false, "score": 0, "creation_date": 1567513550, "post_id": 57771245, "comment_id": 101978372, "body": "I am not sure but I think the last statement must be like this: <code>.where(&#39;(select...) &gt; 2000&#39;)</code>"}, {"owner": {"reputation": 18856, "user_id": 1359650, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/dffc4318ac93e728a26c8e8b51b4eb37?s=128&d=identicon&r=PG", "display_name": "jvillian", "link": "https://stackoverflow.com/users/1359650/jvillian"}, "edited": false, "score": 0, "creation_date": 1567514364, "post_id": 57771245, "comment_id": 101978864, "body": "The problem with this sort of question, IMO, is that it requires potential answerers to have sufficient knowledge of both SQL and ActiveRecord. If you described your desired results and provide example data, then  might get help from people who have expertise in ActiveRecord but not in SQL."}, {"owner": {"reputation": 1508, "user_id": 1468122, "user_type": "registered", "accept_rate": 41, "profile_image": "https://i.stack.imgur.com/QKC1Z.jpg?s=128&g=1", "display_name": "Ahmad hamza", "link": "https://stackoverflow.com/users/1468122/ahmad-hamza"}, "reply_to_user": {"reputation": 766, "user_id": 1488591, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/4373e8b5ebf359cb601120389378406a?s=128&d=identicon&r=PG", "display_name": "kunashir", "link": "https://stackoverflow.com/users/1488591/kunashir"}, "edited": false, "score": 0, "creation_date": 1567514471, "post_id": 57771245, "comment_id": 101978931, "body": "@kunashir your suggestion worked but then again it looks ugly. Any ideas to write it better ?"}, {"owner": {"reputation": 2388, "user_id": 3655580, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/58695ea14f641ae7e2f15b34434fd6a0?s=128&d=identicon&r=PG&f=1", "display_name": "edariedl", "link": "https://stackoverflow.com/users/3655580/edariedl"}, "edited": false, "score": 0, "creation_date": 1567517578, "post_id": 57771245, "comment_id": 101980700, "body": "@Ahmadhamza could you add more context about what are you trying to achieve?"}, {"owner": {"reputation": 1508, "user_id": 1468122, "user_type": "registered", "accept_rate": 41, "profile_image": "https://i.stack.imgur.com/QKC1Z.jpg?s=128&g=1", "display_name": "Ahmad hamza", "link": "https://stackoverflow.com/users/1468122/ahmad-hamza"}, "reply_to_user": {"reputation": 2388, "user_id": 3655580, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/58695ea14f641ae7e2f15b34434fd6a0?s=128&d=identicon&r=PG&f=1", "display_name": "edariedl", "link": "https://stackoverflow.com/users/3655580/edariedl"}, "edited": false, "score": 0, "creation_date": 1567518215, "post_id": 57771245, "comment_id": 101981059, "body": "@edariedl updated the intention of the query in the question"}, {"owner": {"reputation": 2388, "user_id": 3655580, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/58695ea14f641ae7e2f15b34434fd6a0?s=128&d=identicon&r=PG&f=1", "display_name": "edariedl", "link": "https://stackoverflow.com/users/3655580/edariedl"}, "edited": false, "score": 0, "creation_date": 1567519466, "post_id": 57771245, "comment_id": 101981840, "body": "Could you also add the database schema and the description what is in the lines of the <code>users</code> table? According to your SQL, you go through every user in the account and for every one of those users you will sum all the users with earlier <code>updated_at</code> and look whether it is over 2000. So that would mean that every time you make new deposit, new user is created in the account? Also what DB do you use, so we know which set of tools we can use?"}], "owner": {"reputation": 1508, "user_id": 1468122, "user_type": "registered", "accept_rate": 41, "profile_image": "https://i.stack.imgur.com/QKC1Z.jpg?s=128&g=1", "display_name": "Ahmad hamza", "link": "https://stackoverflow.com/users/1468122/ahmad-hamza"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 74, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1567518198, "creation_date": 1567511628, "last_edit_date": 1567518198, "question_id": 57771245, "link": "https://stackoverflow.com/questions/57771245/how-can-i-rewrite-this-sql-using-activerecord", "title": "How can i rewrite this sql using ActiveRecord?", "body": "<p>I have a raw sql query here:</p>\n\n<pre><code>SELECT\n    min(users.updated_at)\nFROM\n    users\nWHERE\n    account_id = :account_id\n    AND state = 'completed'\n    AND amount &gt; 0\n    and(\n        SELECT\n            sum(amount)\n        FROM\n            users t2\n        WHERE\n            t2.updated_at &lt;= users.updated_at\n            AND t2.account_id = users.account_id\n            AND t2.state = 'completed'\n            AND t2.amount &gt; 0) &gt; 2000;\n</code></pre>\n\n<p><strong>Intention of the query is to fetch the date when user has reached the amount of deposit equivalent to 2000.</strong></p>\n\n<p>I want to rewrite it using Rails's ActiveRecord helpers. My confusion starts with the subquery part. Although i could translate it so far is below:</p>\n\n<pre><code>User\n  .where(account_id: 5087)\n  .where.not(type: EXCLUDED)\n  .in_state(*DEPOSIT_STATES)\n  .deposits    #amount &gt; 0\n  .minimum('updated_at')\n  .select(\"and (select sum(amount) from users t2\n    where t2.updated_at &lt;= users.updated_at\n      and t2.account_id = users.account_id\n      and t2.state = 'completed' and t2.amount &gt; 0) &gt; 2000\")\n</code></pre>\n\n<p><strong>Update</strong></p>\n\n<p>This query worked but this looks ugly. Any ideas to write it better: </p>\n\n<pre><code>User\n  .where(account_id: 5087)\n  .where.not(type: EXCLUDED)\n  .in_state(*DEPOSIT_STATES)\n  .deposits\n  .where(\"(select sum(amount) from users t2\n    where t2.updated_at &lt;= users.updated_at\n      and t2.account_id = users.account_id\n      and t2.state = 'completed' and t2.amount &gt; 0) &gt; 2000\")\n  .minimum('updated_at')\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 8640, "user_id": 4055042, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/cd04c63d95d27033b53d4d83fea40c02?s=128&d=identicon&r=PG&f=1", "display_name": "SRack", "link": "https://stackoverflow.com/users/4055042/srack"}, "edited": false, "score": 2, "creation_date": 1567523813, "post_id": 57770467, "comment_id": 101984308, "body": "I don&#39;t know that you even need methods for this.   Using enums provides a scope for the status, so you could just call, for example, <code>YourModel.in_progress.count</code>. That seems pretty idiomatic to me, and saves the nine lines of code needed to turn the counts into separate methods."}], "answers": [{"tags": [], "owner": {"reputation": 193, "user_id": 6559094, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/591b4f7a0a640b6a1d2a1360bfd5d653?s=128&d=identicon&r=PG", "display_name": "Zavitoski", "link": "https://stackoverflow.com/users/6559094/zavitoski"}, "is_accepted": true, "score": 0, "last_activity_date": 1567509339, "creation_date": 1567509339, "answer_id": 57770558, "question_id": 57770467, "link": "https://stackoverflow.com/questions/57770467/how-to-find-out-the-number-of-records-in-a-table/57770558#57770558", "title": "How to find out the number of records in a table?", "body": "<p>It would be something like this on your model:</p>\n\n<pre><code>def self.pending_count\n where(status: 0).count\nend\n\n\ndef self.in_progress_count\n where(status: 1).count\nend\n\ndef self.finished_count\n where(status: 2).count\nend\n</code></pre>\n\n<p>Then you can just call <code>Model.pending_count</code> (or the other methods) wherever you need it.</p>\n"}], "owner": {"reputation": 5, "user_id": 11455087, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-ybnGsZyKU7A/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcaeNL-qSnn9LqBNIKvEpYWubMcMg/mo/photo.jpg?sz=128", "display_name": "\u0414\u0435\u043d\u0438\u0441 \u0421\u0430\u0435\u043d\u043a\u043e", "link": "https://stackoverflow.com/users/11455087/%d0%94%d0%b5%d0%bd%d0%b8%d1%81-%d0%a1%d0%b0%d0%b5%d0%bd%d0%ba%d0%be"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 64, "favorite_count": 0, "closed_date": 1567524129, "accepted_answer_id": 57770558, "answer_count": 1, "score": -8, "last_activity_date": 1567510228, "creation_date": 1567509009, "last_edit_date": 1567510228, "question_id": 57770467, "link": "https://stackoverflow.com/questions/57770467/how-to-find-out-the-number-of-records-in-a-table", "closed_reason": "Not suitable for this site", "title": "How to find out the number of records in a table?", "body": "<p>I have a scaffold help requisition. There is a status field. Each request can have 3 statuses (pending, in_progress, finished), implemented through enum. It is necessary to write methods that will count the number of requests with each status. For example, method A counts how many total helper prequests with status 0 (pending). I understand that there is nothing complicated about this, but I can't understand and could use some help.</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 13442, "user_id": 3982562, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2a3c7aae1d762372cda697833c602ec8?s=128&d=identicon&r=PG", "display_name": "3limin4t0r", "link": "https://stackoverflow.com/users/3982562/3limin4t0r"}, "edited": false, "score": 0, "creation_date": 1567507932, "post_id": 57770103, "comment_id": 101975416, "body": "What is the current output/result?"}, {"owner": {"reputation": 33, "user_id": 12014085, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5141740972ba662316e374921dabc0cd?s=128&d=identicon&r=PG&f=1", "display_name": "ravindra", "link": "https://stackoverflow.com/users/12014085/ravindra"}, "reply_to_user": {"reputation": 13442, "user_id": 3982562, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2a3c7aae1d762372cda697833c602ec8?s=128&d=identicon&r=PG", "display_name": "3limin4t0r", "link": "https://stackoverflow.com/users/3982562/3limin4t0r"}, "edited": false, "score": 0, "creation_date": 1567508078, "post_id": 57770103, "comment_id": 101975488, "body": "-e:1: syntax error, unexpected tIDENTIFIER, expecting end-of-input start_services &#39;[&#39;dev&#39;,&#39;test&#39;,&#39;uat&#39;]&#39;,&#39;developer&#39;,&#39;                      ^"}], "answers": [{"tags": [], "owner": {"reputation": 48413, "user_id": 1279683, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1veuT.jpg?s=128&g=1", "display_name": "Marek Lipka", "link": "https://stackoverflow.com/users/1279683/marek-lipka"}, "is_accepted": true, "score": 0, "last_activity_date": 1567508328, "creation_date": 1567508328, "answer_id": 57770309, "question_id": 57770103, "link": "https://stackoverflow.com/questions/57770103/how-to-pass-array-as-an-argument-to-a-ruby-function-from-command-line/57770309#57770309", "title": "How to pass array as an argument to a Ruby function from command line?", "body": "<p>You clearly want to pass an array as the first parameter into <code>start_services</code> method, so you should do it like this:</p>\n\n<pre><code>$ ruby -r \"./test.rb\" -e \"start_services ['dev','test','uat'],'developer','welcome123'\"\n# output:\ndev\ntest\nuat\ndeveloper\nwelcome123\n</code></pre>\n\n<p>What you've been trying so far was attempt to pass <code>'[\\'dev\\',\\'test\\',\\'uat\\']'</code> string, which was malformed, because you didn't escape <code>'</code> characters. </p>\n"}, {"tags": [], "owner": {"reputation": 48049, "user_id": 6419007, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/CwqtX.jpg?s=128&g=1", "display_name": "Eric Duminil", "link": "https://stackoverflow.com/users/6419007/eric-duminil"}, "is_accepted": false, "score": 0, "last_activity_date": 1567516516, "creation_date": 1567516516, "answer_id": 57772554, "question_id": 57770103, "link": "https://stackoverflow.com/questions/57770103/how-to-pass-array-as-an-argument-to-a-ruby-function-from-command-line/57772554#57772554", "title": "How to pass array as an argument to a Ruby function from command line?", "body": "<p>Don't pass your credentials as arguments, any user on your system would be able to see them.</p>\n\n<p>Instead, you could save them as environment variables or in a config file.</p>\n\n<pre><code>if ARGV.size == 0\n  puts \"Here's how to launch this script : ruby #{__FILE__} env_name1 env_name2 ...\"\n  exit\nend\n\n# Define those environment variables before launching the script.\n# Alternative : write credentials in a json or yml file.\nnode_username = ENV[\"NODE_USERNAME\"]\nnode_password = ENV[\"NODE_PASSWORD\"]\n\nARGV.each do |env|\n  puts \"Launching environment #{env}\"\nend\n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 12014085, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5141740972ba662316e374921dabc0cd?s=128&d=identicon&r=PG&f=1", "display_name": "ravindra", "link": "https://stackoverflow.com/users/12014085/ravindra"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 219, "favorite_count": 0, "accepted_answer_id": 57770309, "answer_count": 2, "score": 3, "last_activity_date": 1567531560, "creation_date": 1567507536, "last_edit_date": 1567531560, "question_id": 57770103, "link": "https://stackoverflow.com/questions/57770103/how-to-pass-array-as-an-argument-to-a-ruby-function-from-command-line", "title": "How to pass array as an argument to a Ruby function from command line?", "body": "<p>I want to call Ruby function from command line with array as an argument.</p>\n\n<p>Script name is test.rb</p>\n\n<p>In below code Environments are like test,dev,uat.', am passing as <code>['test','dev','uat']</code></p>\n\n<p>I have tried as below:</p>\n\n<pre><code>ruby -r \"./test.rb\" -e \"start_services '['dev','test','uat']','developer','welcome123'\"\n</code></pre>\n\n<pre><code>def start_services(environments,node_user_name,node_password)\n  environments.each do |env|\n    puts env\n  end\n  puts node_user_name\n  puts node_password\nend\n</code></pre>\n\n<p>Output:</p>\n\n<blockquote>\n  <p>-e:1: syntax error, unexpected tIDENTIFIER, expecting end-of-input start_services '['dev','test','uat']','developer',' ^</p>\n</blockquote>\n"}, {"tags": ["javascript", "ruby-on-rails", "ruby", "timezone"], "comments": [{"owner": {"reputation": 2536, "user_id": 3432373, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/dd9272a0aaa7744349c43b461406b276?s=128&d=identicon&r=PG&f=1", "display_name": "t3__rry", "link": "https://stackoverflow.com/users/3432373/t3-rry"}, "edited": false, "score": 0, "creation_date": 1567505408, "post_id": 57769384, "comment_id": 101974090, "body": "Hi, welcome to SO ;) If you mean displaying the locale date <i>on the front-end</i> you could use Javascript&#39;s <code>toLocaleDateString</code> and <code>toLocaleTimeString</code> <a href=\"https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Date/toLocaleDateString\" rel=\"nofollow noreferrer\">developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 60, "user_id": 10864518, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-PjqGuA7MMNY/AAAAAAAAAAI/AAAAAAAAF0I/HPkliFqFwxo/photo.jpg?sz=128", "display_name": "Levi Miller", "link": "https://stackoverflow.com/users/10864518/levi-miller"}, "is_accepted": false, "score": 1, "last_activity_date": 1578276315, "last_edit_date": 1578276315, "creation_date": 1578274108, "answer_id": 59605684, "question_id": 57769384, "link": "https://stackoverflow.com/questions/57769384/how-to-manage-users-timezone-in-rails-right/59605684#59605684", "title": "How to manage user&#39;s timezone in Rails right?", "body": "<p>You're not missing anything important. Every language has different kinds and numbers of bells and whistles adorning its basic parts. The specification for \"<a href=\"http://www.ecma-international.org/ecma-402/1.0/\" rel=\"nofollow noreferrer\">ECMAScript Internationalization API</a>\" (what gives you the power to write <code>Intl.DateTimeFormat().resolvedOptions().timeZone</code>) wasn't introduced until 2012, some years after JavaScript was first conceived.</p>\n\n<p>Somewhat similarly on the back end, the Rails framework provides its own API baked in, allowing you to create <code>Time</code> instances with the added accuracy and functionality of the <code>TZInfo</code> gem thanks to Rails' <code>ActiveSupport::TimeZone</code> wrapper. You don't even have too stray to far from what you might be used to in Ruby, intuitively calling both <code>Time</code> and <code>TZInfo</code> methods on <code>Time</code> in Rails.</p>\n\n<p>The code you wrote above technically relies on a gem. Rails is a gem! Maybe the delineation you're going for is whether we should use libraries that come <em>with</em> our languages and frameworks or reach <em>out</em> for new ones. That difference is not as important as how dependable the libraries are in the first place. So you aren't missing anything! It's just a jungle out there :)</p>\n"}], "owner": {"reputation": 31, "user_id": 12013728, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3819d794f297de08c44f51f7a4b200bd?s=128&d=identicon&r=PG&f=1", "display_name": "gabriel", "link": "https://stackoverflow.com/users/12013728/gabriel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 93, "favorite_count": 2, "answer_count": 1, "score": 3, "last_activity_date": 1578276315, "creation_date": 1567504911, "question_id": 57769384, "link": "https://stackoverflow.com/questions/57769384/how-to-manage-users-timezone-in-rails-right", "title": "How to manage user&#39;s timezone in Rails right?", "body": "<p>I know that there's quite a lot of gems that do the job, but I think it's quite excessive to use a whole gem for such an easy task.</p>\n\n<p>I found that js does it pretty easy:</p>\n\n<pre><code>Intl.DateTimeFormat().resolvedOptions().timeZone\n</code></pre>\n\n<p>The answer is a string like <code>\"Europe/Moscow\"</code>.</p>\n\n<p>We can easily save it to db</p>\n\n<pre><code>create_table :users do |t|\n  t.string :time_zone, default: \"UTC\"\n  ...\nend\n</code></pre>\n\n<p>and set user's time zone like:</p>\n\n<pre><code># app/controllers/application_controller.rb\naround_action :set_time_zone, if: :current_user\n\nprivate\n\ndef set_time_zone(&amp;block)\n  Time.use_zone(current_user.time_zone, &amp;block)\nend\n</code></pre>\n\n<p>So my <strong><em>question</em></strong> is: Am I missing something important (why these gems are being used) or I can do it like I wrote above (without any gems)?</p>\n\n<p><em>Inspired by the <a href=\"https://thoughtbot.com/blog/its-about-time-zones\" rel=\"nofollow noreferrer\">ThoughtBot's article</a> and <a href=\"https://stackoverflow.com/questions/1091372/getting-the-clients-timezone-offset-in-javascript\">this question</a></em></p>\n"}, {"tags": ["ruby-on-rails", "ruby", "rubygems", "rails-admin"], "comments": [{"owner": {"reputation": 1397, "user_id": 4940278, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/06NHi.jpg?s=128&g=1", "display_name": "Luna Lovegood", "link": "https://stackoverflow.com/users/4940278/luna-lovegood"}, "edited": false, "score": 0, "creation_date": 1567507448, "post_id": 57769376, "comment_id": 101975141, "body": "Looks like while trying to save active_storage_blobs you are running into some validation error. Please also add controller side code"}, {"owner": {"reputation": 98, "user_id": 7619689, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b637d6a56c98bf91900dc00f985c0633?s=128&d=identicon&r=PG&f=1", "display_name": "Tunnelblick", "link": "https://stackoverflow.com/users/7619689/tunnelblick"}, "reply_to_user": {"reputation": 1397, "user_id": 4940278, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/06NHi.jpg?s=128&g=1", "display_name": "Luna Lovegood", "link": "https://stackoverflow.com/users/4940278/luna-lovegood"}, "edited": false, "score": 0, "creation_date": 1567509479, "post_id": 57769376, "comment_id": 101976241, "body": "Hi @Surya, this is part of the RailsAdmin and not directly processed by my application&#39;s controllers.  See:  <code>Processing by RailsAdmin::MainController#new as JS</code>"}, {"owner": {"reputation": 98, "user_id": 7619689, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b637d6a56c98bf91900dc00f985c0633?s=128&d=identicon&r=PG&f=1", "display_name": "Tunnelblick", "link": "https://stackoverflow.com/users/7619689/tunnelblick"}, "reply_to_user": {"reputation": 1397, "user_id": 4940278, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/06NHi.jpg?s=128&g=1", "display_name": "Luna Lovegood", "link": "https://stackoverflow.com/users/4940278/luna-lovegood"}, "edited": false, "score": 0, "creation_date": 1567509934, "post_id": 57769376, "comment_id": 101976480, "body": "@Surya I&#39;ve added the relevant part of the RailsAdmin&#39;s MainController"}, {"owner": {"reputation": 1397, "user_id": 4940278, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/06NHi.jpg?s=128&g=1", "display_name": "Luna Lovegood", "link": "https://stackoverflow.com/users/4940278/luna-lovegood"}, "edited": false, "score": 0, "creation_date": 1567510656, "post_id": 57769376, "comment_id": 101976883, "body": "You could override <code>document&#47;new</code> method of RailsAdmin and then use <code>scope</code> to limit the users based on the condition"}, {"owner": {"reputation": 1397, "user_id": 4940278, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/06NHi.jpg?s=128&g=1", "display_name": "Luna Lovegood", "link": "https://stackoverflow.com/users/4940278/luna-lovegood"}, "edited": false, "score": 0, "creation_date": 1567510772, "post_id": 57769376, "comment_id": 101976938, "body": "If you need help on how to do this let me know"}, {"owner": {"reputation": 98, "user_id": 7619689, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b637d6a56c98bf91900dc00f985c0633?s=128&d=identicon&r=PG&f=1", "display_name": "Tunnelblick", "link": "https://stackoverflow.com/users/7619689/tunnelblick"}, "reply_to_user": {"reputation": 1397, "user_id": 4940278, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/06NHi.jpg?s=128&g=1", "display_name": "Luna Lovegood", "link": "https://stackoverflow.com/users/4940278/luna-lovegood"}, "edited": false, "score": 0, "creation_date": 1567512241, "post_id": 57769376, "comment_id": 101977708, "body": "@Surya I&#39;m trying to track this down with my debugger ... I&#39;ve set breakpoints in this RailsAdmin code now ... let&#39;s see"}, {"owner": {"reputation": 1397, "user_id": 4940278, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/06NHi.jpg?s=128&g=1", "display_name": "Luna Lovegood", "link": "https://stackoverflow.com/users/4940278/luna-lovegood"}, "edited": false, "score": 0, "creation_date": 1567513344, "post_id": 57769376, "comment_id": 101978246, "body": "As per RailsAdmin&#39;s logic they will be displaying all of users, you need to change RailsAdmins code and restrict limit users. So you need to <code>monkey patch</code> raisl admin code, which is a simple thing only. In RailsAdmin github page check the implementation of this function <code>document&#47;new </code>"}, {"owner": {"reputation": 98, "user_id": 7619689, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b637d6a56c98bf91900dc00f985c0633?s=128&d=identicon&r=PG&f=1", "display_name": "Tunnelblick", "link": "https://stackoverflow.com/users/7619689/tunnelblick"}, "reply_to_user": {"reputation": 1397, "user_id": 4940278, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/06NHi.jpg?s=128&g=1", "display_name": "Luna Lovegood", "link": "https://stackoverflow.com/users/4940278/luna-lovegood"}, "edited": false, "score": 0, "creation_date": 1567516775, "post_id": 57769376, "comment_id": 101980243, "body": "I really don&#39;t get why I you proposed me to do this. @Surya"}], "owner": {"reputation": 98, "user_id": 7619689, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b637d6a56c98bf91900dc00f985c0633?s=128&d=identicon&r=PG&f=1", "display_name": "Tunnelblick", "link": "https://stackoverflow.com/users/7619689/tunnelblick"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 110, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1567509871, "creation_date": 1567504863, "last_edit_date": 1567509871, "question_id": 57769376, "link": "https://stackoverflow.com/questions/57769376/debug-railsadmin-error-which-causes-transaction-rollback", "title": "Debug RailsAdmin error which causes transaction rollback", "body": "<p>I'm trying to solve a current issue on my rails app. My rails app is using RailsAdmin and I have an issue after trying to upload files via generic RailsAdmin options.</p>\n\n<p>So this app is using Ruby 2.5.3, RailsAdmin 1.4.2 and Rails 5.2.3.</p>\n\n<p>It seems that I'm running in a silent error ... maybe a kind of model validation or something like that buy I even don't get any relevant output on debug mode.</p>\n\n<p>The problem is that I have no certain idea how I should proceed on debugging this problem because these actions are handled within the rails-admin gem.\nEven though I'm using RubyMine with the debugging feature I have no clue where to set the breakpoints because this is handled be the gem. I've tried to break on some initializers but of course that didn't had the intended effect.</p>\n\n<p>So <strong>I would appreciate any hints and help which supports me debugging this problem!</strong></p>\n\n<p>Best regards,</p>\n\n<p>Tunnelblick</p>\n\n<hr>\n\n<p>Debug output:</p>\n\n<pre><code>Started POST \"/administrator/document/new\" for &lt;src_ip&gt; at 2019-09-03 11:47:46 +0200\nProcessing by RailsAdmin::MainController#new as JS\n  Parameters: {\"utf8\"=&gt;\"\u2713\", \"authenticity_token\"=&gt;\"&lt;token&gt;\", \"document\"=&gt;{\"title\"=&gt;\"Testimage\", \"description\"=&gt;\"\", \"page_ids\"=&gt;[\"\", \"\", \"151\"], \"file\"=&gt;#&lt;ActionDispatch::Http::UploadedFile:0x00007f4ebbf196e8 @tempfile=#&lt;Tempfile:/tmp/RackMultipart20190903-3614-gbt3ad.png&gt;, @original_filename=\"generic_testimage.png\", @content_type=\"image/png\", @headers=\"Content-Disposition: form-data; name=\\\"document[file]\\\"; filename=\\\"generic_testimage.png\\\"\\r\\nContent-Type: image/png\\r\\n\"&gt;}, \"remotipart_submitted\"=&gt;\"true\", \"X-Requested-With\"=&gt;\"IFrame\", \"X-HTTP-Accept\"=&gt;\"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript, */*; q=0.01\", \"model_name\"=&gt;\"document\"}\n  User Load (0.7ms)  SELECT  `users`.* FROM `users` WHERE `users`.`id` = 1 ORDER BY `users`.`id` ASC LIMIT 1\n  \u21b3 config/initializers/rails_admin.rb:97\n   (0.9ms)  SELECT `user_roles`.`role_id` FROM `user_roles` WHERE `user_roles`.`user_id` = 1\n  \u21b3 app/models/user.rb:236\n   (0.5ms)  SELECT `roles`.`name` FROM `roles` WHERE `roles`.`id` = 1\n  \u21b3 app/models/user.rb:236\n  Disk Storage (4.5ms) Uploaded file to key: HsSaBijYwg3JLeR8dV7akmpF (checksum: /QSj27UArM/yWCLulQaTpA==)\n   (0.3ms)  BEGIN\n  \u21b3 /home/testvm01/.rvm/gems/ruby-2.5.3@&lt;gemset&gt;/bundler/gems/activerecord-sqlserver-adapter-1105d02d6284/lib/active_record/connection_adapters/sqlserver/transaction.rb:38\n  ActiveStorage::Blob Create (0.6ms)  INSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `byte_size`, `checksum`, `created_at`) VALUES ('HsSaBijYwg3JLeR8dV7akmpF', 'generic_testimage.png', 'image/png', '{\\\"identified\\\":true}', 2673, '/QSj27UArM/yWCLulQaTpA==', '2019-09-03 09:47:46')\n  \u21b3 /home/testvm01/.rvm/gems/ruby-2.5.3@&lt;gemset&gt;/gems/activerecord-5.2.3/lib/active_record/log_subscriber.rb:98\n   (3.6ms)  COMMIT\n  \u21b3 /home/testvm01/.rvm/gems/ruby-2.5.3@&lt;gemset&gt;/bundler/gems/activerecord-sqlserver-adapter-1105d02d6284/lib/active_record/connection_adapters/sqlserver/transaction.rb:42\n   (0.3ms)  BEGIN\n  \u21b3 /home/testvm01/.rvm/gems/ruby-2.5.3@&lt;gemset&gt;/bundler/gems/activerecord-sqlserver-adapter-1105d02d6284/lib/active_record/connection_adapters/sqlserver/transaction.rb:38\n   (0.4ms)  COMMIT\n  \u21b3 /home/testvm01/.rvm/gems/ruby-2.5.3@&lt;gemset&gt;/bundler/gems/activerecord-sqlserver-adapter-1105d02d6284/lib/active_record/connection_adapters/sqlserver/transaction.rb:42\n  Page Load (0.5ms)  SELECT `pages`.* FROM `pages` WHERE `pages`.`id` = 151\n  \u21b3 /home/testvm01/.rvm/gems/ruby-2.5.3@&lt;gemset&gt;/gems/activerecord-5.2.3/lib/active_record/log_subscriber.rb:98\n   (0.3ms)  BEGIN\n  \u21b3 /home/testvm01/.rvm/gems/ruby-2.5.3@&lt;gemset&gt;/bundler/gems/activerecord-sqlserver-adapter-1105d02d6284/lib/active_record/connection_adapters/sqlserver/transaction.rb:38\n\n\n   (0.2ms)  ROLLBACK\n\n\n  \u21b3 /home/testvm01/.rvm/gems/ruby-2.5.3@&lt;gemset&gt;/bundler/gems/activerecord-sqlserver-adapter-1105d02d6284/lib/active_record/connection_adapters/sqlserver/transaction.rb:47\n  Rendering /home/testvm01/.rvm/gems/ruby-2.5.3@&lt;gemset&gt;/gems/rails_admin-1.4.2/app/views/rails_admin/main/new.html.haml\n  Rendered /home/testvm01/.rvm/gems/ruby-2.5.3@&lt;gemset&gt;/gems/rails_admin-1.4.2/app/views/rails_admin/main/_form_field.html.haml (3.9ms)\n  Rendered /home/testvm01/.rvm/gems/ruby-2.5.3@&lt;gemset&gt;/gems/rails_admin-1.4.2/app/views/rails_admin/main/_form_text.html.haml (3.6ms)\n  Rendered /home/testvm01/.rvm/gems/ruby-2.5.3@&lt;gemset&gt;/gems/rails_admin-1.4.2/app/views/rails_admin/main/_form_file_upload.html.haml (7.8ms)\n   (0.5ms)  SELECT COUNT(*) FROM `pages`\n  \u21b3 /home/testvm01/.rvm/gems/ruby-2.5.3@&lt;gemset&gt;/gems/activerecord-5.2.3/lib/active_record/log_subscriber.rb:98\n  CACHE  (0.0ms)  SELECT COUNT(*) FROM `pages`\n  \u21b3 /home/testvm01/.rvm/gems/ruby-2.5.3@&lt;gemset&gt;/gems/activerecord-5.2.3/lib/active_record/log_subscriber.rb:98\n  Rendered /home/testvm01/.rvm/gems/ruby-2.5.3@&lt;gemset&gt;/gems/rails_admin-1.4.2/app/views/rails_admin/main/_form_filtering_multiselect.html.haml (15.9ms)\n  Rendered /home/testvm01/.rvm/gems/ruby-2.5.3@&lt;gemset&gt;/gems/rails_admin-1.4.2/app/views/rails_admin/main/_submit_buttons.html.haml (14.2ms)\n  Rendered /home/testvm01/.rvm/gems/ruby-2.5.3@&lt;gemset&gt;/gems/rails_admin-1.4.2/app/views/rails_admin/main/new.html.haml (70.9ms)\nCompleted 406 Not Acceptable in 124ms (Views: 76.5ms | ActiveRecord: 8.8ms)\n\n\n&lt;src_ip&gt; - - [03/Sep/2019:11:47:46 CEST] \"POST /administrator/document/new HTTP/1.1\" 406 5828\nhttp://&lt;dst_ip&gt;:3000/administrator/Page/151/edit -&gt; /administrator/document/new\nStarted GET \"/rails/active_storage/representations/eyJfcmFpbHMiOnsibWVzc2FnZSI6IkJBaHBBb1VEIiwiZXhwIjpudWxsLCJwdXIiOiJibG9iX2lkIn19--01b687f90aa49f3bfd52fe06cfb950eef8711461/eyJfcmFpbHMiOnsibWVzc2FnZSI6IkJBaDdCam9MY21WemFYcGxTU0lOTVRBd2VERXdNRDRHT2daRlZBPT0iLCJleHAiOm51bGwsInB1ciI6InZhcmlhdGlvbiJ9fQ==--597b84b3c8f143e08ed73e02d88e0aee694d1066/generic_testimage.png\" for &lt;src_ip&gt; at 2019-09-03 11:47:46 +0200\nProcessing by ActiveStorage::RepresentationsController#show as PNG\n  Parameters: {\"signed_blob_id\"=&gt;\"eyJfcmFpbHMiOnsibWVzc2FnZSI6IkJBaHBBb1VEIiwiZXhwIjpudWxsLCJwdXIiOiJibG9iX2lkIn19--01b687f90aa49f3bfd52fe06cfb950eef8711461\", \"variation_key\"=&gt;\"eyJfcmFpbHMiOnsibWVzc2FnZSI6IkJBaDdCam9MY21WemFYcGxTU0lOTVRBd2VERXdNRDRHT2daRlZBPT0iLCJleHAiOm51bGwsInB1ciI6InZhcmlhdGlvbiJ9fQ==--597b84b3c8f143e08ed73e02d88e0aee694d1066\", \"filename\"=&gt;\"generic_testimage\"}\n  ActiveStorage::Blob Load (2.5ms)  SELECT  `active_storage_blobs`.* FROM `active_storage_blobs` WHERE `active_storage_blobs`.`id` = 901 LIMIT 1\n  \u21b3 /home/testvm01/.rvm/gems/ruby-2.5.3@&lt;gemset&gt;/gems/activerecord-5.2.3/lib/active_record/log_subscriber.rb:98\n  Disk Storage (0.1ms) Checked if file exists at key: variants/HsSaBijYwg3JLeR8dV7akmpF/64ff10e27609a8b1f320398d41a1f5791aeb2e108f429b203d5f3c650e0b744d (no)\n  Disk Storage (0.1ms) Downloaded file from key: HsSaBijYwg3JLeR8dV7akmpF\n  Disk Storage (0.3ms) Uploaded file to key: variants/HsSaBijYwg3JLeR8dV7akmpF/64ff10e27609a8b1f320398d41a1f5791aeb2e108f429b203d5f3c650e0b744d\n  Disk Storage (0.8ms) Generated URL for file at key: variants/HsSaBijYwg3JLeR8dV7akmpF/64ff10e27609a8b1f320398d41a1f5791aeb2e108f429b203d5f3c650e0b744d (http://&lt;dst_ip&gt;:3000/rails/active_storage/disk/eyJfcmFpbHMiOnsibWVzc2FnZSI6IkJBaDdDRG9JYTJWNVNTSm5kbUZ5YVdGdWRITXZTSE5UWVVKcGFsbDNaek5LVEdWU09HUldOMkZyYlhCR0x6WTBabVl4TUdVeU56WXdPV0U0WWpGbU16SXdNems0WkRReFlURm1OVGM1TVdGbFlqSmxNVEE0WmpReU9XSXlNRE5rTldZell6WTFNR1V3WWpjME5HUUdPZ1pGVkRvUVpHbHpjRzl6YVhScGIyNUpJbFZwYm14cGJtVTdJR1pwYkdWdVlXMWxQU0puWlc1bGNtbGpYM1JsYzNScGJXRm5aUzV3Ym1jaU95Qm1hV3hsYm1GdFpTbzlWVlJHTFRnbkoyZGxibVZ5YVdOZmRHVnpkR2x0WVdkbExuQnVad1k3QmxRNkVXTnZiblJsYm5SZmRIbHdaVWtpRG1sdFlXZGxMM0J1WndZN0JsUT0iLCJleHAiOiIyMDE5LTA5LTAzVDA5OjUyOjQ2LjU4NVoiLCJwdXIiOiJibG9iX2tleSJ9fQ==--c5bcf6d4ef2e2800968e21be38b234711a8d43a9/generic_testimage.png?content_type=image%2Fpng&amp;disposition=inline%3B+filename%3D%22generic_testimage.png%22%3B+filename%2A%3DUTF-8%27%27generic_testimage.png)\nRedirected to http://&lt;dst_ip&gt;:3000/rails/active_storage/disk/eyJfcmFpbHMiOnsibWVzc2FnZSI6IkJBaDdDRG9JYTJWNVNTSm5kbUZ5YVdGdWRITXZTSE5UWVVKcGFsbDNaek5LVEdWU09HUldOMkZyYlhCR0x6WTBabVl4TUdVeU56WXdPV0U0WWpGbU16SXdNems0WkRReFlURm1OVGM1TVdGbFlqSmxNVEE0WmpReU9XSXlNRE5rTldZell6WTFNR1V3WWpjME5HUUdPZ1pGVkRvUVpHbHpjRzl6YVhScGIyNUpJbFZwYm14cGJtVTdJR1pwYkdWdVlXMWxQU0puWlc1bGNtbGpYM1JsYzNScGJXRm5aUzV3Ym1jaU95Qm1hV3hsYm1GdFpTbzlWVlJHTFRnbkoyZGxibVZ5YVdOZmRHVnpkR2x0WVdkbExuQnVad1k3QmxRNkVXTnZiblJsYm5SZmRIbHdaVWtpRG1sdFlXZGxMM0J1WndZN0JsUT0iLCJleHAiOiIyMDE5LTA5LTAzVDA5OjUyOjQ2LjU4NVoiLCJwdXIiOiJibG9iX2tleSJ9fQ==--c5bcf6d4ef2e2800968e21be38b234711a8d43a9/generic_testimage.png?content_type=image%2Fpng&amp;disposition=inline%3B+filename%3D%22generic_testimage.png%22%3B+filename%2A%3DUTF-8%27%27generic_testimage.png\nCompleted 302 Found in 72ms (ActiveRecord: 2.5ms)\n\n\n&lt;src_ip&gt; - - [03/Sep/2019:11:47:46 CEST] \"GET /rails/active_storage/representations/eyJfcmFpbHMiOnsibWVzc2FnZSI6IkJBaHBBb1VEIiwiZXhwIjpudWxsLCJwdXIiOiJibG9iX2lkIn19--01b687f90aa49f3bfd52fe06cfb950eef8711461/eyJfcmFpbHMiOnsibWVzc2FnZSI6IkJBaDdCam9MY21WemFYcGxTU0lOTVRBd2VERXdNRDRHT2daRlZBPT0iLCJleHAiOm51bGwsInB1ciI6InZhcmlhdGlvbiJ9fQ==--597b84b3c8f143e08ed73e02d88e0aee694d1066/generic_testimage.png HTTP/1.1\" 302 863\nhttp://&lt;dst_ip&gt;:3000/administrator/Page/151/edit -&gt; /rails/active_storage/representations/eyJfcmFpbHMiOnsibWVzc2FnZSI6IkJBaHBBb1VEIiwiZXhwIjpudWxsLCJwdXIiOiJibG9iX2lkIn19--01b687f90aa49f3bfd52fe06cfb950eef8711461/eyJfcmFpbHMiOnsibWVzc2FnZSI6IkJBaDdCam9MY21WemFYcGxTU0lOTVRBd2VERXdNRDRHT2daRlZBPT0iLCJleHAiOm51bGwsInB1ciI6InZhcmlhdGlvbiJ9fQ==--597b84b3c8f143e08ed73e02d88e0aee694d1066/generic_testimage.png\nStarted GET \"/rails/active_storage/disk/eyJfcmFpbHMiOnsibWVzc2FnZSI6IkJBaDdDRG9JYTJWNVNTSm5kbUZ5YVdGdWRITXZTSE5UWVVKcGFsbDNaek5LVEdWU09HUldOMkZyYlhCR0x6WTBabVl4TUdVeU56WXdPV0U0WWpGbU16SXdNems0WkRReFlURm1OVGM1TVdGbFlqSmxNVEE0WmpReU9XSXlNRE5rTldZell6WTFNR1V3WWpjME5HUUdPZ1pGVkRvUVpHbHpjRzl6YVhScGIyNUpJbFZwYm14cGJtVTdJR1pwYkdWdVlXMWxQU0puWlc1bGNtbGpYM1JsYzNScGJXRm5aUzV3Ym1jaU95Qm1hV3hsYm1GdFpTbzlWVlJHTFRnbkoyZGxibVZ5YVdOZmRHVnpkR2x0WVdkbExuQnVad1k3QmxRNkVXTnZiblJsYm5SZmRIbHdaVWtpRG1sdFlXZGxMM0J1WndZN0JsUT0iLCJleHAiOiIyMDE5LTA5LTAzVDA5OjUyOjQ2LjU4NVoiLCJwdXIiOiJibG9iX2tleSJ9fQ==--c5bcf6d4ef2e2800968e21be38b234711a8d43a9/generic_testimage.png?content_type=image%2Fpng&amp;disposition=inline%3B+filename%3D%22generic_testimage.png%22%3B+filename%2A%3DUTF-8%27%27generic_testimage.png\" for &lt;src_ip&gt; at 2019-09-03 11:47:46 +0200\nProcessing by ActiveStorage::DiskController#show as PNG\n  Parameters: {\"content_type\"=&gt;\"image/png\", \"disposition\"=&gt;\"inline; filename=\\\"generic_testimage.png\\\"; filename*=UTF-8''generic_testimage.png\", \"encoded_key\"=&gt;\"eyJfcmFpbHMiOnsibWVzc2FnZSI6IkJBaDdDRG9JYTJWNVNTSm5kbUZ5YVdGdWRITXZTSE5UWVVKcGFsbDNaek5LVEdWU09HUldOMkZyYlhCR0x6WTBabVl4TUdVeU56WXdPV0U0WWpGbU16SXdNems0WkRReFlURm1OVGM1TVdGbFlqSmxNVEE0WmpReU9XSXlNRE5rTldZell6WTFNR1V3WWpjME5HUUdPZ1pGVkRvUVpHbHpjRzl6YVhScGIyNUpJbFZwYm14cGJtVTdJR1pwYkdWdVlXMWxQU0puWlc1bGNtbGpYM1JsYzNScGJXRm5aUzV3Ym1jaU95Qm1hV3hsYm1GdFpTbzlWVlJHTFRnbkoyZGxibVZ5YVdOZmRHVnpkR2x0WVdkbExuQnVad1k3QmxRNkVXTnZiblJsYm5SZmRIbHdaVWtpRG1sdFlXZGxMM0J1WndZN0JsUT0iLCJleHAiOiIyMDE5LTA5LTAzVDA5OjUyOjQ2LjU4NVoiLCJwdXIiOiJibG9iX2tleSJ9fQ==--c5bcf6d4ef2e2800968e21be38b234711a8d43a9\", \"filename\"=&gt;\"generic_testimage\"}\nCompleted 200 OK in 1ms (ActiveRecord: 0.0ms)\n\n\n&lt;src_ip&gt; - - [03/Sep/2019:11:47:46 CEST] \"GET /rails/active_storage/disk/eyJfcmFpbHMiOnsibWVzc2FnZSI6IkJBaDdDRG9JYTJWNVNTSm5kbUZ5YVdGdWRITXZTSE5UWVVKcGFsbDNaek5LVEdWU09HUldOMkZyYlhCR0x6WTBabVl4TUdVeU56WXdPV0U0WWpGbU16SXdNems0WkRReFlURm1OVGM1TVdGbFlqSmxNVEE0WmpReU9XSXlNRE5rTldZell6WTFNR1V3WWpjME5HUUdPZ1pGVkRvUVpHbHpjRzl6YVhScGIyNUpJbFZwYm14cGJtVTdJR1pwYkdWdVlXMWxQU0puWlc1bGNtbGpYM1JsYzNScGJXRm5aUzV3Ym1jaU95Qm1hV3hsYm1GdFpTbzlWVlJHTFRnbkoyZGxibVZ5YVdOZmRHVnpkR2x0WVdkbExuQnVad1k3QmxRNkVXTnZiblJsYm5SZmRIbHdaVWtpRG1sdFlXZGxMM0J1WndZN0JsUT0iLCJleHAiOiIyMDE5LTA5LTAzVDA5OjUyOjQ2LjU4NVoiLCJwdXIiOiJibG9iX2tleSJ9fQ==--c5bcf6d4ef2e2800968e21be38b234711a8d43a9/generic_testimage.png?content_type=image%2Fpng&amp;disposition=inline%3B+filename%3D%22generic_testimage.png%22%3B+filename%2A%3DUTF-8%27%27generic_testimage.png HTTP/1.1\" 200 830\nhttp://&lt;dst_ip&gt;:3000/administrator/Page/151/edit -&gt; /rails/active_storage/disk/eyJfcmFpbHMiOnsibWVzc2FnZSI6IkJBaDdDRG9JYTJWNVNTSm5kbUZ5YVdGdWRITXZTSE5UWVVKcGFsbDNaek5LVEdWU09HUldOMkZyYlhCR0x6WTBabVl4TUdVeU56WXdPV0U0WWpGbU16SXdNems0WkRReFlURm1OVGM1TVdGbFlqSmxNVEE0WmpReU9XSXlNRE5rTldZell6WTFNR1V3WWpjME5HUUdPZ1pGVkRvUVpHbHpjRzl6YVhScGIyNUpJbFZwYm14cGJtVTdJR1pwYkdWdVlXMWxQU0puWlc1bGNtbGpYM1JsYzNScGJXRm5aUzV3Ym1jaU95Qm1hV3hsYm1GdFpTbzlWVlJHTFRnbkoyZGxibVZ5YVdOZmRHVnpkR2x0WVdkbExuQnVad1k3QmxRNkVXTnZiblJsYm5SZmRIbHdaVWtpRG1sdFlXZGxMM0J1WndZN0JsUT0iLCJleHAiOiIyMDE5LTA5LTAzVDA5OjUyOjQ2LjU4NVoiLCJwdXIiOiJibG9iX2tleSJ9fQ==--c5bcf6d4ef2e2800968e21be38b234711a8d43a9/generic_testimage.png?content_type=image%2Fpng&amp;disposition=inline%3B+filename%3D%22generic_testimage.png%22%3B+filename%2A%3DUTF-8%27%27generic_testimage.png\n\n</code></pre>\n\n<hr>\n\n<p>RailsAdmin MainController</p>\n\n<pre><code>RailsAdmin::Config::Actions.all.each do |action|\n      class_eval &lt;&lt;-EOS, __FILE__, __LINE__ + 1\n        def #{action.action_name}\n          action = RailsAdmin::Config::Actions.find('#{action.action_name}'.to_sym)\n          @authorization_adapter.try(:authorize, action.authorization_key, @abstract_model, @object)\n          @action = action.with({controller: self, abstract_model: @abstract_model, object: @object})\n          fail(ActionNotAllowed) unless @action.enabled?\n          @page_name = wording_for(:title)\n\n          instance_eval &amp;@action.controller\n        end\n      EOS\n    end\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "devise", "apartment-gem"], "answers": [{"tags": [], "owner": {"reputation": 7944, "user_id": 10907864, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/tGpcY.jpg?s=128&g=1", "display_name": "Promise Preston", "link": "https://stackoverflow.com/users/10907864/promise-preston"}, "is_accepted": true, "score": 2, "last_activity_date": 1567504408, "creation_date": 1567504408, "answer_id": 57769239, "question_id": 57769238, "link": "https://stackoverflow.com/questions/57769238/apartment-uninitialized-constant-tenant-nameerror/57769239#57769239", "title": "Apartment: uninitialized constant Tenant (NameError)", "body": "<p>I later realized that the issue was from the configuration that I made initially to <strong>Apartment Gem's</strong> <code>config/initializers/apartment.rb</code> initializer file.</p>\n\n<p>After creating the <strong>User</strong> model, I also added it to the excluded models list in the <code>config/initializers/apartment.rb</code> initializer file. </p>\n\n<pre><code>config.excluded_models = %w[Tenant User]\n</code></pre>\n\n<p>I was supposed to instead replace <code>Tenant</code> in the excluded models list with the <code>User</code> model.</p>\n\n<pre><code>config.excluded_models = %w[User]\n</code></pre>\n\n<p>And that fixed the issue for me.</p>\n\n<p><strong>N/B:</strong> If I named the model name of my subdomain for the multiple tenants as <code>Tenant</code>, then I the configuration can be left like this</p>\n\n<pre><code>config.excluded_models = %w[Tenant]\n</code></pre>\n\n<p>But for my case, I named the model name of my subdomain for the multiple tenants as <code>User</code></p>\n\n<p>That's all.</p>\n\n<p><strong>I hope this helps</strong></p>\n"}], "owner": {"reputation": 7944, "user_id": 10907864, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/tGpcY.jpg?s=128&g=1", "display_name": "Promise Preston", "link": "https://stackoverflow.com/users/10907864/promise-preston"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 303, "favorite_count": 0, "accepted_answer_id": 57769239, "answer_count": 1, "score": 0, "last_activity_date": 1567509217, "creation_date": 1567504408, "last_edit_date": 1567509217, "question_id": 57769238, "link": "https://stackoverflow.com/questions/57769238/apartment-uninitialized-constant-tenant-nameerror", "title": "Apartment: uninitialized constant Tenant (NameError)", "body": "<p>I am using the <a href=\"https://github.com/influitive/apartment\" rel=\"nofollow noreferrer\">Apartment Gem</a> for the first time for Multitenancy in a Ruby on Rails project. I am trying to create multiple tenants for users in your digital library Rails application. </p>\n\n<p>I am using <a href=\"https://github.com/plataformatec/devise\" rel=\"nofollow noreferrer\">Devise Gem</a> for the authentication of the application, and I have generated the and I have generated config file by running the code below in my terminal</p>\n\n<pre><code>rails generate devise:install\n</code></pre>\n\n<p>I have also generated a <strong>User</strong> model for <strong>Devise</strong> using the code below in my terminal</p>\n\n<pre><code>rails generate devise User\n</code></pre>\n\n<p>And for the <strong>Apartment Gem</strong>, I have installed it and generated the config file by running the code below in my terminal</p>\n\n<pre><code>bundle exec rails generate apartment:install\n</code></pre>\n\n<p>I have also configured the <code>config/initializers/apartment.rb</code> initializer file as needed using the documentation provided, but when I run the command below in my terminal</p>\n\n<pre><code>rails generate devise:views\n</code></pre>\n\n<p>to generate the views for <strong>Devise</strong>, I get the error below</p>\n\n<blockquote>\n  <p>uninitialized constant Tenant (NameError)</p>\n</blockquote>\n\n<p>I have tried to figure out the cause of the issue, but I still haven't been fortunate to get it fixed. I need some help. Thank you in advance.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "encryption", "attr-encrypted"], "comments": [{"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1567505117, "post_id": 57769230, "comment_id": 101973932, "body": "You generate random keys on each app boot. No wonder your records stop displaying after deploy"}, {"owner": {"reputation": 1263, "user_id": 10221813, "user_type": "registered", "profile_image": "https://graph.facebook.com/10160530708235447/picture?type=large", "display_name": "uno", "link": "https://stackoverflow.com/users/10221813/uno"}, "reply_to_user": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1567550117, "post_id": 57769230, "comment_id": 101993720, "body": "Great.   So I should use a stationary key that I set myself basically? And any ideas on why I can&#39;t decrypt? Does starting the console do anything?"}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1567594236, "post_id": 57769230, "comment_id": 102006982, "body": "A console is a separate app instance (which means new random keys)"}], "owner": {"reputation": 1263, "user_id": 10221813, "user_type": "registered", "profile_image": "https://graph.facebook.com/10160530708235447/picture?type=large", "display_name": "uno", "link": "https://stackoverflow.com/users/10221813/uno"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 298, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1567504382, "creation_date": 1567504382, "question_id": 57769230, "link": "https://stackoverflow.com/questions/57769230/encrypting-with-attr-encrypt-gem-but-cant-decrypt", "title": "Encrypting with attr-encrypt gem but can&#39;t decrypt", "body": "<p>Using gem: <a href=\"https://github.com/attr-encrypted/attr_encrypted\" rel=\"nofollow noreferrer\">https://github.com/attr-encrypted/attr_encrypted</a></p>\n\n<p>Issue 1:</p>\n\n<p>When I create the record and encrypt, I go to the console (via Heroku) and do:</p>\n\n<pre><code>model = Model.find(1)\nmodel.attribute\n</code></pre>\n\n<p>Error: <code>OpenSSL::Cipher::CipherError ()</code></p>\n\n<p>Issue 2:</p>\n\n<p>I create the record, go to edit, the params show decrypted (not sure how if it won't work in console, but does)...</p>\n\n<p>Once I recommit (git push heroku master) or restart heroku, the edit page gives me this error: <code>ActionView::Template::Error ()</code></p>\n\n<p>The error is at the line for the text_field attribute <code>publishable key</code></p>\n\n<p>My setup:</p>\n\n<p>Schema:</p>\n\n<pre><code>    t.string \"encrypted_publishable_key\"\n    t.string \"encrypted_publishable_key_iv\"\n    t.string \"encrypted_secret_key\"\n    t.string \"encrypted_secret_key_iv\"\n    t.index [\"encrypted_publishable_key_iv\"], name: \"index_stripe_apis_on_encrypted_publishable_key_iv\", unique: true\n    t.index [\"encrypted_secret_key_iv\"], name: \"index_stripe_apis_on_encrypted_secret_key_iv\", unique: true\n</code></pre>\n\n<p>Tried removing the index's but still errors persist.</p>\n\n<p>Model:</p>\n\n<pre><code>key = Base64.encode64(SecureRandom.random_bytes(32))\nattr_encrypted :publishable_key, key: Base64.decode64(key)\nattr_encrypted :secret_key, key: Base64.decode64(key)\n</code></pre>\n\n<p>Also tried with:</p>\n\n<pre><code>key = Base64.encode64(SecureRandom.random_bytes(32))\niv = Base64.encode64(SecureRandom.random_bytes(12))\nattr_encrypted :publishable_key, key: Base64.decode64(key), iv: Base64.decode64(iv)\nattr_encrypted :secret_key, key: Base64.decode64(key), iv: Base64.decode64(iv)\n</code></pre>\n\n<p>Wihtout <code>key = Base64.encode64(SecureRandom.random_bytes(32))</code> I get the error \"32 bytes required\".</p>\n\n<p>With the above, the attributes will save but on decryption, both in views and console, I get error:</p>\n\n<p><code>iv must be 12 bytes or longer</code></p>\n\n<p>What am I doing wrong that this will not work?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "cookies"], "answers": [{"tags": [], "owner": {"reputation": 21613, "user_id": 580346, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/ba17945a06aac247b06548d5afe341e8?s=128&d=identicon&r=PG", "display_name": "mrzasa", "link": "https://stackoverflow.com/users/580346/mrzasa"}, "is_accepted": true, "score": 1, "last_activity_date": 1567503921, "creation_date": 1567503921, "answer_id": 57769092, "question_id": 57769042, "link": "https://stackoverflow.com/questions/57769042/how-to-use-response-set-cookie-in-service-object/57769092#57769092", "title": "How to use response.set_cookie in service object?", "body": "<p>You shouldn't set cookies in service objects. They should not depend on the transport method that is used by the client (HTTP in this case). You can return data from a service object and then use that data to set a cookie in a controller.</p>\n"}], "owner": {"reputation": 23, "user_id": 11068464, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0da51aab21127e83e27fde9558a94cb4?s=128&d=identicon&r=PG&f=1", "display_name": "nobody ", "link": "https://stackoverflow.com/users/11068464/nobody"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 75, "favorite_count": 0, "accepted_answer_id": 57769092, "answer_count": 1, "score": 1, "last_activity_date": 1567503969, "creation_date": 1567503780, "last_edit_date": 1567503969, "question_id": 57769042, "link": "https://stackoverflow.com/questions/57769042/how-to-use-response-set-cookie-in-service-object", "title": "How to use response.set_cookie in service object?", "body": "<p>I have method create in my <code>SigninController</code>: </p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>def create\n    user = User.find_by!(email: params[:email])\n    if user.authenticate(params[:password])\n      payload = { user_id: user.id }\n      session = JWTSessions::Session.new(payload: payload, refresh_by_access_allowed: true)\n      tokens = session.login\n      response.set_cookie(JWTSessions.access_cookie,\n                        value: tokens[:access],\n                        httponly: true,\n                        secure: Rails.env.production?)\n      render json: { csrf: tokens[:csrf] }\n    else\n      not_authorized\n    end\n  end\n</code></pre>\n\n<p>How can i transfer this method to ServiceObject? When I copied this code to SignInService i got a </p>\n\n<blockquote>\n  <p>NameError (undefined local variable or method `response' Did you mean respond_to?)</p>\n</blockquote>\n"}, {"tags": ["ruby", "capybara", "google-chrome-headless", "poltergeist"], "answers": [{"comments": [{"owner": {"reputation": 1925, "user_id": 2386548, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/fb0c86baa20f25404248077f3c01e0b8?s=128&d=identicon&r=PG", "display_name": "Carpela", "link": "https://stackoverflow.com/users/2386548/carpela"}, "edited": false, "score": 0, "creation_date": 1567594393, "post_id": 57774385, "comment_id": 102007068, "body": "Hi, aware Poltergeist is not supported anymore, just happens that I had a load of stuff done in poltergeist (planning to move to headless chrome but still haven&#39;t gotten around to it). Tried the above and can confirm they don&#39;t work with Poltergeist. Let me have a go with headless chrome and see if we have more luck."}, {"owner": {"reputation": 42014, "user_id": 2709090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/238c2b7cde2c817fc9a5a2b8eaa2ffad?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Walpole", "link": "https://stackoverflow.com/users/2709090/thomas-walpole"}, "reply_to_user": {"reputation": 1925, "user_id": 2386548, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/fb0c86baa20f25404248077f3c01e0b8?s=128&d=identicon&r=PG", "display_name": "Carpela", "link": "https://stackoverflow.com/users/2386548/carpela"}, "edited": false, "score": 0, "creation_date": 1567607766, "post_id": 57774385, "comment_id": 102014560, "body": "@Carpela Yes - for any driver other than Selenium you&#39;re probably going to have to use <code>@session.evaluate_script(...)</code> to run JS that accesses the keys of session or local storage you&#39;re interested in (which is basically what Selenium does when you call the methods shown in the answer too)"}], "tags": [], "owner": {"reputation": 42014, "user_id": 2709090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/238c2b7cde2c817fc9a5a2b8eaa2ffad?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Walpole", "link": "https://stackoverflow.com/users/2709090/thomas-walpole"}, "is_accepted": true, "score": 1, "last_activity_date": 1567560486, "last_edit_date": 1567560486, "creation_date": 1567523145, "answer_id": 57774385, "question_id": 57766420, "link": "https://stackoverflow.com/questions/57766420/how-do-i-view-local-storage-and-session-storage-using-capybara/57774385#57774385", "title": "How do I view local storage and session storage using capybara", "body": "<p>Poltergeist and headless chrome are different things. Poltergeist is obsolete/discontinued at this point in time, but if you're using headless chrome via the selenium driver you can access them as</p>\n\n<pre><code>@session.driver.browser.local_storage\n@session.driver.browser.session_storage\n</code></pre>\n\n<p>Note: This is selenium driver specific - the only cross driver method would be to access them via <code>evaluate_script</code></p>\n"}], "owner": {"reputation": 1925, "user_id": 2386548, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/fb0c86baa20f25404248077f3c01e0b8?s=128&d=identicon&r=PG", "display_name": "Carpela", "link": "https://stackoverflow.com/users/2386548/carpela"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 307, "favorite_count": 1, "accepted_answer_id": 57774385, "answer_count": 1, "score": 1, "last_activity_date": 1567560486, "creation_date": 1567493699, "question_id": 57766420, "link": "https://stackoverflow.com/questions/57766420/how-do-i-view-local-storage-and-session-storage-using-capybara", "title": "How do I view local storage and session storage using capybara", "body": "<p>I'm doing some analysis to confirm what data is being stored on the client by various interactions with some websites. \nI'd like to automate this using Capybara (and Poltergeist / headless chrome).\nI can get the cookies using</p>\n\n<pre><code>@session.driver.cookies\n</code></pre>\n\n<p>Is there a way to do something similar for any local storage and session storage likewise? Scanning through the docs but can't find anything. </p>\n"}, {"tags": ["ruby", "snmp"], "answers": [{"comments": [{"owner": {"reputation": 1659, "user_id": 4106261, "user_type": "registered", "accept_rate": 97, "profile_image": "https://lh5.googleusercontent.com/-iJUgSCa5y0A/AAAAAAAAAAI/AAAAAAAADY0/Kjs5T9umLVE/photo.jpg?sz=128", "display_name": "Alex Poca", "link": "https://stackoverflow.com/users/4106261/alex-poca"}, "edited": false, "score": 0, "creation_date": 1567509518, "post_id": 57767803, "comment_id": 101976262, "body": "Very elegant way to solve the issue, even if I am quite disappointed if it not possible to convert automatically to a type (at least for the common ones: TimeTicks could be converted in a number of ways).   I am a newbie in Ruby and didn&#39;t know it is possible to send methods like this. Thank you for the time you took to answer"}], "tags": [], "owner": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "is_accepted": true, "score": 1, "last_activity_date": 1567500091, "last_edit_date": 1567500091, "creation_date": 1567499211, "answer_id": 57767803, "question_id": 57766323, "link": "https://stackoverflow.com/questions/57766323/ruby-snmp-how-to-automatically-convert-response-to-its-proper-type/57767803#57767803", "title": "ruby-snmp: how to automatically convert response to its proper type?", "body": "<p>Looking at the code in the <a href=\"https://github.com/hallidave/ruby-snmp/blob/4b9deda96f14f5a216e9743313cf100f9ed1da45/lib/snmp/varbind.rb\" rel=\"nofollow noreferrer\">gem repo</a>, it doesn't look like like there is a method for this.  I suppose you could try to monkey patch it, but not sure if it's worth the trouble.</p>\n\n<p>If you don't like the switch syntax, you could just use a hash lookup like this:</p>\n\n<pre><code>require 'snmp'\n\nHOST = '127.0.0.1'.freeze\n\nTYPE_VALUES = {\n  'OCTET STRING' =&gt; :to_s,\n  'INTEGER' =&gt; :to_i,\n  'TimeTicks' =&gt; :to_s\n}.freeze\n\nregisters = ['sysContact.0', 'sysUpTime.0',\n             'upsIdentManufacturer.0', 'upsIdentModel.0', 'upsIdentName.0']\n\nparams_array = {}\n\nSNMP::Manager.open(host: HOST) do |manager|\n  manager.load_module('UPS-MIB')\n  response = manager.get(registers)\n  response.each_varbind do |vb|\n    if method = TYPE_VALUES[vb.value.ans1_type]\n      params_array[vb.name.to_s] = vb.value.send(method)\n    else\n      puts \"Type '#{vb.value.asn1_type}' not recognized!\"\n      exit(1)\n    end\n  end\nend\npp params_array\n</code></pre>\n"}], "owner": {"reputation": 1659, "user_id": 4106261, "user_type": "registered", "accept_rate": 97, "profile_image": "https://lh5.googleusercontent.com/-iJUgSCa5y0A/AAAAAAAAAAI/AAAAAAAADY0/Kjs5T9umLVE/photo.jpg?sz=128", "display_name": "Alex Poca", "link": "https://stackoverflow.com/users/4106261/alex-poca"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 77, "favorite_count": 0, "accepted_answer_id": 57767803, "answer_count": 1, "score": 1, "last_activity_date": 1567500091, "creation_date": 1567493241, "question_id": 57766323, "link": "https://stackoverflow.com/questions/57766323/ruby-snmp-how-to-automatically-convert-response-to-its-proper-type", "title": "ruby-snmp: how to automatically convert response to its proper type?", "body": "<p>In ruby I read some SNMP registers. Response is an array of objects.</p>\n\n<p>Is there a nice way to convert each object to the proper type avoiding the <code>case..when</code> in the following code? It looks strange that it must be converted  manually as the type is already known:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>require 'snmp'\n\nHOST = '127.0.0.1'.freeze\n\nregisters = ['sysContact.0', 'sysUpTime.0',\n             'upsIdentManufacturer.0', 'upsIdentModel.0', 'upsIdentName.0']\n\nparams_array = {}\nSNMP::Manager.open(host: HOST) do |manager|\n  manager.load_module('UPS-MIB')\n  response = manager.get(registers)\n  response.each_varbind do |vb|\n\n    ##################################\n    # change from here...\n\n    value = nil\n    case vb.value.asn1_type\n    when 'OCTET STRING'        # &lt;==========\n      value = vb.value        \n    when 'INTEGER'             # &lt;==========\n      value = vb.value.to_i\n    when 'TimeTicks'           # &lt;==========\n      value = vb.value.to_s\n    else\n      puts \"Type '#{vb.value.asn1_type}' not recognized!\"\n      exit(1)\n    end\n    params_array[vb.name.to_s] = value\n\n    # ... to here\n    ##################################\n\n    # with something like\n    # params_array[vb.name.to_s] = vb.value._to_its_proper_type_\n\n  end\nend\npp params_array\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "postgresql", "activerecord"], "answers": [{"comments": [{"owner": {"reputation": 4019, "user_id": 767033, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/07fa4dc36952b149cdfe7c140ff08fc5?s=128&d=identicon&r=PG", "display_name": "Chris.Zou", "link": "https://stackoverflow.com/users/767033/chris-zou"}, "edited": false, "score": 0, "creation_date": 1567492230, "post_id": 57765806, "comment_id": 101967578, "body": "Hi @Laurenz, thank you for your answer. I checked my psql version and it is 10.6 (<code>psql (PostgreSQL) 10.6 (Ubuntu 10.6-0ubuntu0.18.04.1)</code>).  I didn&#39;t remember dropping <code>pg_range</code> myself. But it&#39;s possible that I accidentally corrupt it when upgrading system version. Any idea how I can recover it?"}, {"owner": {"reputation": 125670, "user_id": 6464308, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/12PVX.jpg?s=128&g=1", "display_name": "Laurenz Albe", "link": "https://stackoverflow.com/users/6464308/laurenz-albe"}, "reply_to_user": {"reputation": 4019, "user_id": 767033, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/07fa4dc36952b149cdfe7c140ff08fc5?s=128&d=identicon&r=PG", "display_name": "Chris.Zou", "link": "https://stackoverflow.com/users/767033/chris-zou"}, "edited": false, "score": 0, "creation_date": 1567492844, "post_id": 57765806, "comment_id": 101967824, "body": "What you are showing is the <i>client</i> version. What is the result of the SQL statement <code>SHOW server_version;</code>?"}, {"owner": {"reputation": 4019, "user_id": 767033, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/07fa4dc36952b149cdfe7c140ff08fc5?s=128&d=identicon&r=PG", "display_name": "Chris.Zou", "link": "https://stackoverflow.com/users/767033/chris-zou"}, "edited": false, "score": 1, "creation_date": 1567493343, "post_id": 57765806, "comment_id": 101968040, "body": "Hi @Laurenz, I ran <code>SHOW server_version;</code> as you said in my psql shell and it was 9.1.24 \ud83d\ude02I assume this was the cause of the issue? Thank you again!"}, {"owner": {"reputation": 125670, "user_id": 6464308, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/12PVX.jpg?s=128&g=1", "display_name": "Laurenz Albe", "link": "https://stackoverflow.com/users/6464308/laurenz-albe"}, "reply_to_user": {"reputation": 4019, "user_id": 767033, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/07fa4dc36952b149cdfe7c140ff08fc5?s=128&d=identicon&r=PG", "display_name": "Chris.Zou", "link": "https://stackoverflow.com/users/767033/chris-zou"}, "edited": false, "score": 0, "creation_date": 1567521625, "post_id": 57765806, "comment_id": 101983083, "body": "Yes. That is very old and outdated software, and you shouldn&#39;t use it if you love your data."}], "tags": [], "owner": {"reputation": 125670, "user_id": 6464308, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/12PVX.jpg?s=128&g=1", "display_name": "Laurenz Albe", "link": "https://stackoverflow.com/users/6464308/laurenz-albe"}, "is_accepted": true, "score": 1, "last_activity_date": 1567490440, "creation_date": 1567490440, "answer_id": 57765806, "question_id": 57765528, "link": "https://stackoverflow.com/questions/57765528/rails-activerecordstatementinvalid-pgundefinedtable-error-relation-pg-ra/57765806#57765806", "title": "Rails ActiveRecord::StatementInvalid: PG::UndefinedTable: ERROR: relation &quot;pg_range&quot; does not exist LINE 3: LEFT JOIN pg_range as r ON oid = rngtypid", "body": "<p>Any PostgreSQL database of version 9.2 or above will always have a <code>pg_catalog.pg_range</code> table, be it upgraded from an older version or not.</p>\n\n<p>There are two possible explanations for your error:</p>\n\n<ul>\n<li><p>You are inadvertently working with a PostgreSQL database of version 9.0 or lower.</p></li>\n<li><p>You somehow managed to corrupt the system catalogs by dropping <code>pg_range</code>. There are safeguards against that, so that's nothing that can happen by mistake.</p></li>\n</ul>\n"}], "owner": {"reputation": 4019, "user_id": 767033, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/07fa4dc36952b149cdfe7c140ff08fc5?s=128&d=identicon&r=PG", "display_name": "Chris.Zou", "link": "https://stackoverflow.com/users/767033/chris-zou"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 342, "favorite_count": 0, "accepted_answer_id": 57765806, "answer_count": 1, "score": 2, "last_activity_date": 1567490440, "creation_date": 1567488500, "question_id": 57765528, "link": "https://stackoverflow.com/questions/57765528/rails-activerecordstatementinvalid-pgundefinedtable-error-relation-pg-ra", "title": "Rails ActiveRecord::StatementInvalid: PG::UndefinedTable: ERROR: relation &quot;pg_range&quot; does not exist LINE 3: LEFT JOIN pg_range as r ON oid = rngtypid", "body": "<p>I'm using an existing Postgres database for a rails 6 project. When I do some ActiveRecord queries like <code>User.all()</code>, I run into the following error </p>\n\n<pre><code>ActiveRecord::StatementInvalid: PG::UndefinedTable: ERROR:  relation \"pg_range\" does not exist\nLINE 3: LEFT JOIN pg_range as r ON oid = rngtypid\n</code></pre>\n\n<p>After some googling. I found that <code>pg_range</code> was introduced in PostgreSQL 9.2. My existing database was upgraded from an older version (8.x, if I remembered correctly). Was that the reason I ran into this issue. How can I fix it?</p>\n"}, {"tags": ["ruby", "ruby-on-rails-5", "bots", "slack"], "comments": [{"owner": {"reputation": 27334, "user_id": 7758804, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UBA7j.jpg?s=128&g=1", "display_name": "Trenton McKinney", "link": "https://stackoverflow.com/users/7758804/trenton-mckinney"}, "edited": false, "score": 0, "creation_date": 1567490970, "post_id": 57765193, "comment_id": 101967120, "body": "Text has been updated for clarity."}], "answers": [{"tags": [], "owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "is_accepted": true, "score": 0, "last_activity_date": 1567488059, "creation_date": 1567488059, "answer_id": 57765466, "question_id": 57765193, "link": "https://stackoverflow.com/questions/57765193/how-to-extract-the-values-from-a-string-from-slack-ruby-bot/57765466#57765466", "title": "How to extract the values from a string from slack ruby bot", "body": "<p>Wherever you receive the string, you might use the regular expression and <code>String#scan</code> to get the data.</p>\n\n<pre><code>\"I worked on 'stackoverflow' for 10 hours.\".scan /'[^']+'|\\d+/\n#\u21d2 [\"'stackoverflow'\", \"10\"]\n</code></pre>\n"}], "owner": {"reputation": 180, "user_id": 11956424, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c7aa174ebed665ba900d9291d298f07?s=128&d=identicon&r=PG&f=1", "display_name": "Amal", "link": "https://stackoverflow.com/users/11956424/amal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 56, "favorite_count": 0, "accepted_answer_id": 57765466, "answer_count": 1, "score": 0, "last_activity_date": 1567490970, "creation_date": 1567486145, "last_edit_date": 1567490970, "question_id": 57765193, "link": "https://stackoverflow.com/questions/57765193/how-to-extract-the-values-from-a-string-from-slack-ruby-bot", "title": "How to extract the values from a string from slack ruby bot", "body": "<p>I am trying to create a slackbot which can save incoming data to a database.</p>\n\n<p>I have used the gem <code>slack-ruby-bot</code> and I'm able to receive my text, but I want to extract specific parts of the text, to save in a database.</p>\n\n<h3>Given the following received text:</h3>\n\n<ul>\n<li>I worked on 'stackoverflow' for 10 hours.</li>\n</ul>\n\n<p>I must be able to extract the project name, <strong>stackoverflow</strong>, and the hour, which is <strong>10</strong>. Is there someway to do it?</p>\n\n<pre><code>  command 'activity', '/^Activity/' do |client, data, match|\n    client.say(text: \"#{data.text}\", channel: data.channel)\n  end\n</code></pre>\n\n<p>This is just a sample code which gets the command activity.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "heroku", "redis", "sidekiq"], "comments": [{"owner": {"reputation": 17782, "user_id": 1494519, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af54a0871600db7fbdbb5c558a6e29a3?s=128&d=identicon&r=PG", "display_name": "Mike Perham", "link": "https://stackoverflow.com/users/1494519/mike-perham"}, "edited": false, "score": 0, "creation_date": 1567525398, "post_id": 57765042, "comment_id": 101985073, "body": "Please include the full backtrace of any errors."}], "answers": [{"tags": [], "owner": {"reputation": 595, "user_id": 3632472, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4e431a79c8cf18fc5c29ebb94a721dda?s=128&d=identicon&r=PG&f=1", "display_name": "Rakesh", "link": "https://stackoverflow.com/users/3632472/rakesh"}, "is_accepted": false, "score": 0, "last_activity_date": 1567496021, "creation_date": 1567496021, "answer_id": 57766979, "question_id": 57765042, "link": "https://stackoverflow.com/questions/57765042/heroku-sidekiq-redis-puma-configuration-issue/57766979#57766979", "title": "Heroku + Sidekiq + Redis + Puma configuration issue", "body": "<p>web dynos: 4 dynos * 3 client connections per process = 12</p>\n\n<p>workers: 6 workers * (5 redis connections per worker (by default) + concurrency set to 10) = 90</p>\n\n<p>You can get a very good read over here \n<a href=\"https://medium.com/appaloosa-store-engineering/you-should-revise-your-redis-max-connections-setting-8136f063c916\" rel=\"nofollow noreferrer\">https://medium.com/appaloosa-store-engineering/you-should-revise-your-redis-max-connections-setting-8136f063c916</a></p>\n"}], "owner": {"reputation": 681, "user_id": 1117660, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/ha2St.png?s=128&g=1", "display_name": "amtest", "link": "https://stackoverflow.com/users/1117660/amtest"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 207, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1567576949, "creation_date": 1567484893, "last_edit_date": 1567576949, "question_id": 57765042, "link": "https://stackoverflow.com/questions/57765042/heroku-sidekiq-redis-puma-configuration-issue", "title": "Heroku + Sidekiq + Redis + Puma configuration issue", "body": "<p>I have an application in Heroku that is running with sidekiq + Redis + puma.</p>\n\n<p>Heroku configurations:</p>\n\n<p><a href=\"https://i.stack.imgur.com/BATtJ.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/BATtJ.png\" alt=\"enter image description here\"></a></p>\n\n<p><strong>Redis Total plan Connection limit: 200 (using Heroku Redis)</strong></p>\n\n<p><strong>puma.rb</strong></p>\n\n<pre><code>threads_count = ENV.fetch(\"RAILS_MAX_THREADS\") { 5 }\nworkers ENV.fetch(\"WEB_CONCURRENCY\") { 2 }\n</code></pre>\n\n<p><strong>sidekiq.rb</strong></p>\n\n<pre><code>require 'sidekiq'\n\nSidekiq.configure_client do |config|\n  config.redis = { size: 1 }\nend\n\nSidekiq.configure_server do |config|\n  config.redis = { size: 4 }\nend\n</code></pre>\n\n<p><strong>sidekiq.yml</strong></p>\n\n<pre><code>production:\n  :concurrency: 2\n</code></pre>\n\n<p><strong>redis.rb</strong></p>\n\n<pre><code>Redis.current = Redis.new(url: ENV[ENV['REDIS_PROVIDER'] || 'REDIS_URL'])\n</code></pre>\n\n<p>This above configuration is working fine, but I couldn't make use of maximum connections as per this above configuration currently that uses 34 connections</p>\n\n<p>Also when I change this above configuration that is not working getting these errors:</p>\n\n<pre><code>could not obtain a connection from the pool within 5.000 seconds (waited 5.002 \nseconds); all pooled connections were in use\n</code></pre>\n\n<p>I am following this <a href=\"http://manuelvanrijn.nl/sidekiq-heroku-redis-calc/\" rel=\"nofollow noreferrer\">calculator</a></p>\n\n<p>I have also used the REDIS_URL instead of size,</p>\n\n<pre><code>Sidekiq.configure_client do |config|\n  config.redis = { url: ENV['REDIS_URL'] || 'redis://localhost:6379/1' }\nend\n\nSidekiq.configure_server do |config|\n  config.redis = { url: ENV['REDIS_URL'] || 'redis://localhost:6379/1' }\nend\n</code></pre>\n\n<p>that time also we are getting this error:\ncould not obtain a connection from the pool within 5.000 seconds (waited 5.007 seconds); all pooled connections were in use</p>\n\n<p>Full Backtrace:</p>\n\n<p><code>could not obtain a connection from the pool within 5.000 seconds (waited 5.002 seconds); all pooled connections were in use..[\"/app/vendor/bundle/ruby/2.4.0/gems/activerecord-5.1.6/lib/active_record/connection_adapters/abstract/connection_pool.rb:202:in `block in wait_poll'\", \"/app/vendor/bundle/ruby/2.4.0/gems/activerecord-5.1.6/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `loop'\", \"/app/vendor/bundle/ruby/2.4.0/gems/activerecord-5.1.6/lib/active_record/connection_adapters/abstract/connection_pool.rb:193:in `wait_poll'\", \"/app/vendor/bundle/ruby/2.4.0/gems/activerecord-5.1.6/lib/active_record/connection_adapters/abstract/connection_pool.rb:154:in `internal_poll'\", \"/app/vendor/bundle/ruby/2.4.0/gems/activerecord-5.1.6/lib/active_record/connection_adapters/abstract/connection_pool.rb:278:in `internal_poll'\", \"/app/vendor/bundle/ruby/2.4.0/gems/activerecord-5.1.6/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `block in poll'\", \"/app/vendor/ruby-2.4.4/lib/ruby/2.4.0/monitor.rb:214:in `mon_synchronize'\", \"/app/vendor/bundle/ruby/2.4.0/gems/activerecord-5.1.6/lib/active_record/connection_adapters/abstract/connection_pool.rb:158:in `synchronize'\", \"/app/vendor/bundle/ruby/2.4.0/gems/activerecord-5.1.6/lib/active_record/connection_adapters/abstract/connection_pool.rb:148:in `poll'\", \"/app/vendor/bundle/ruby/2.4.0/gems/activerecord-5.1.6/lib/active_record/connection_adapters/abstract/connection_pool.rb:747:in `acquire_connection'\", \"/app/vendor/bundle/ruby/2.4.0/gems/activerecord-5.1.6/lib/active_record/connection_adapters/abstract/connection_pool.rb:500:in `checkout'\", \"/app/vendor/bundle/ruby/2.4.0/gems/activerecord-5.1.6/lib/active_record/connection_adapters/abstract/connection_pool.rb:374:in `connection'\", \"/app/vendor/bundle/ruby/2.4.0/gems/activerecord-5.1.6/lib/active_record/connection_adapters/abstract/connection_pool.rb:931:in `retrieve_connection'\", \"/app/vendor/bundle/ruby/2.4.0/gems/activerecord-5.1.6/lib/active_record/connection_handling.rb:116:in `retrieve_connection'\", \"/app/vendor/bundle/ruby/2.4.0/gems/activerecord-5.1.6/lib/active_record/connection_handling.rb:88:in `connection'\", \"/app/vendor/bundle/ruby/2.4.0/gems/activerecord-5.1.6/lib/active_record/associations/join_dependency.rb:96:in `initialize'\", \"/app/vendor/bundle/ruby/2.4.0/gems/activerecord-5.1.6/lib/active_record/relation/query_methods.rb:1016:in `new'\", \"/app/vendor/bundle/ruby/2.4.0/gems/activerecord-5.1.6/lib/active_record/relation/query_methods.rb:1016:in `build_join_query'\", \"/app/vendor/bundle/ruby/2.4.0/gems/activerecord-5.1.6/lib/active_record/relation/query_methods.rb:1003:in `build_joins'\", \"/app/vendor/bundle/ruby/2.4.0/gems/activerecord-5.1.6/lib/active_record/relation/query_methods.rb:942:in `build_arel'\", \"/app/vendor/bundle/ruby/2.4.0/gems/activerecord-5.1.6/lib/active_record/relation/query_methods.rb:918:in `arel'\", \"/app/vendor/bundle/ruby/2.4.0/gems/activerecord-5.1.6/lib/active_record/relation.rb:678:in `exec_queries'\", \"/app/vendor/bundle/ruby/2.4.0/gems/activerecord-5.1.6/lib/active_record/relation.rb:546:in `load'\", \"/app/vendor/bundle/ruby/2.4.0/gems/activerecord-5.1.6/lib/active_record/relation.rb:255:in `records'\", \"/app/vendor/bundle/ruby/2.4.0/gems/activerecord-5.1.6/lib/active_record/relation/delegation.rb:39:in `each'\", \"/app/app/workers/pos/refresh_menu_worker.rb:19:in `perform'\", \"/app/vendor/bundle/ruby/2.4.0/gems/sidekiq-5.2.1/lib/sidekiq/processor.rb:185:in `execute_job'\", \"/app/vendor/bundle/ruby/2.4.0/gems/sidekiq-5.2.1/lib/sidekiq/processor.rb:167:in `block (2 levels) in process'\", \"/app/vendor/bundle/ruby/2.4.0/gems/sidekiq-5.2.1/lib/sidekiq/middleware/chain.rb:128:in `block in invoke'\", \"/app/vendor/bundle/ruby/2.4.0/gems/sidekiq-5.2.1/lib/sidekiq/middleware/chain.rb:133:in `invoke'\", \"/app/vendor/bundle/ruby/2.4.0/gems/sidekiq-5.2.1/lib/sidekiq/processor.rb:166:in `block in process'\", \"/app/vendor/bundle/ruby/2.4.0/gems/sidekiq-5.2.1/lib/sidekiq/processor.rb:137:in `block (6 levels) in dispatch'\", \"/app/vendor/bundle/ruby/2.4.0/gems/sidekiq-5.2.1/lib/sidekiq/job_retry.rb:98:in `local'\", \"/app/vendor/bundle/ruby/2.4.0/gems/sidekiq-5.2.1/lib/sidekiq/processor.rb:136:in `block (5 levels) in dispatch'\", \"/app/vendor/bundle/ruby/2.4.0/gems/sidekiq-5.2.1/lib/sidekiq/rails.rb:42:in `block in call'\", \"/app/vendor/bundle/ruby/2.4.0/gems/activesupport-5.1.6/lib/active_support/execution_wrapper.rb:85:in `wrap'\", \"/app/vendor/bundle/ruby/2.4.0/gems/activesupport-5.1.6/lib/active_support/reloader.rb:68:in `block in wrap'\", \"/app/vendor/bundle/ruby/2.4.0/gems/activesupport-5.1.6/lib/active_support/execution_wrapper.rb:85:in `wrap'\", \"/app/vendor/bundle/ruby/2.4.0/gems/activesupport-5.1.6/lib/active_support/reloader.rb:67:in `wrap'\", \"/app/vendor/bundle/ruby/2.4.0/gems/sidekiq-5.2.1/lib/sidekiq/rails.rb:41:in `call'\", \"/app/vendor/bundle/ruby/2.4.0/gems/sidekiq-5.2.1/lib/sidekiq/processor.rb:132:in `block (4 levels) in dispatch'\", \"/app/vendor/bundle/ruby/2.4.0/gems/sidekiq-5.2.1/lib/sidekiq/processor.rb:217:in `stats'\", \"/app/vendor/bundle/ruby/2.4.0/gems/sidekiq-5.2.1/lib/sidekiq/processor.rb:127:in `block (3 levels) in dispatch'\", \"/app/vendor/bundle/ruby/2.4.0/gems/sidekiq-5.2.1/lib/sidekiq/job_logger.rb:8:in `call'\", \"/app/vendor/bundle/ruby/2.4.0/gems/sidekiq-5.2.1/lib/sidekiq/processor.rb:126:in `block (2 levels) in dispatch'\", \"/app/vendor/bundle/ruby/2.4.0/gems/sidekiq-5.2.1/lib/sidekiq/job_retry.rb:73:in `global'\", \"/app/vendor/bundle/ruby/2.4.0/gems/sidekiq-5.2.1/lib/sidekiq/processor.rb:125:in `block in dispatch'\", \"/app/vendor/bundle/ruby/2.4.0/gems/sidekiq-5.2.1/lib/sidekiq/logging.rb:48:in `with_context'\", \"/app/vendor/bundle/ruby/2.4.0/gems/sidekiq-5.2.1/lib/sidekiq/logging.rb:42:in `with_job_hash_context'\", \"/app/vendor/bundle/ruby/2.4.0/gems/sidekiq-5.2.1/lib/sidekiq/processor.rb:124:in `dispatch'\", \"/app/vendor/bundle/ruby/2.4.0/gems/sidekiq-5.2.1/lib/sidekiq/processor.rb:165:in `process'\", \"/app/vendor/bundle/ruby/2.4.0/gems/sidekiq-5.2.1/lib/sidekiq/processor.rb:83:in `process_one'\", \"/app/vendor/bundle/ruby/2.4.0/gems/sidekiq-5.2.1/lib/sidekiq/processor.rb:71:in `run'\", \"/app/vendor/bundle/ruby/2.4.0/gems/sidekiq-5.2.1/lib/sidekiq/util.rb:16:in `watchdog'\", \"/app/vendor/bundle/ruby/2.4.0/gems/sidekiq-5.2.1/lib/sidekiq/util.rb:25:in `block in safe_thread'\"]</code></p>\n\n<p>Can anyone suggest the configuration to accommodate maximum connection?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "service-object"], "comments": [{"owner": {"reputation": 862, "user_id": 1600046, "user_type": "registered", "accept_rate": 45, "profile_image": "https://i.stack.imgur.com/5rxUl.jpg?s=128&g=1", "display_name": "Vibol", "link": "https://stackoverflow.com/users/1600046/vibol"}, "edited": false, "score": 1, "creation_date": 1567483535, "post_id": 57764879, "comment_id": 101965374, "body": "Are you running the code in console? From the error, it looks like the method was added after you enter the console, try exit console and go back."}, {"owner": {"reputation": 277, "user_id": 4774554, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d72ff795ced575525d4f5cf033d65520?s=128&d=identicon&r=PG&f=1", "display_name": "VegaStudios", "link": "https://stackoverflow.com/users/4774554/vegastudios"}, "reply_to_user": {"reputation": 862, "user_id": 1600046, "user_type": "registered", "accept_rate": 45, "profile_image": "https://i.stack.imgur.com/5rxUl.jpg?s=128&g=1", "display_name": "Vibol", "link": "https://stackoverflow.com/users/1600046/vibol"}, "edited": false, "score": 1, "creation_date": 1567483679, "post_id": 57764879, "comment_id": 101965401, "body": "I&#39;m running it from the <code>create</code> action of the <code>StoreController</code>. I call the method inside the <code>create</code> action like so, <code>@store = ::Store::CreateService.new(current_user, store_params).execute</code>"}, {"owner": {"reputation": 862, "user_id": 1600046, "user_type": "registered", "accept_rate": 45, "profile_image": "https://i.stack.imgur.com/5rxUl.jpg?s=128&g=1", "display_name": "Vibol", "link": "https://stackoverflow.com/users/1600046/vibol"}, "edited": false, "score": 0, "creation_date": 1567483860, "post_id": 57764879, "comment_id": 101965429, "body": "Don&#39;t find anything wrong with the code, please make sure you save the file."}, {"owner": {"reputation": 277, "user_id": 4774554, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d72ff795ced575525d4f5cf033d65520?s=128&d=identicon&r=PG&f=1", "display_name": "VegaStudios", "link": "https://stackoverflow.com/users/4774554/vegastudios"}, "reply_to_user": {"reputation": 862, "user_id": 1600046, "user_type": "registered", "accept_rate": 45, "profile_image": "https://i.stack.imgur.com/5rxUl.jpg?s=128&g=1", "display_name": "Vibol", "link": "https://stackoverflow.com/users/1600046/vibol"}, "edited": false, "score": 0, "creation_date": 1567484474, "post_id": 57764879, "comment_id": 101965522, "body": "Thanks @Coco, I&#39;ve doubled checked that the file is saved."}, {"owner": {"reputation": 7359, "user_id": 599989, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/d752d2574aeb36bc66471f4d0f8811aa?s=128&d=identicon&r=PG", "display_name": "Bijendra", "link": "https://stackoverflow.com/users/599989/bijendra"}, "edited": false, "score": 1, "creation_date": 1567485617, "post_id": 57764879, "comment_id": 101965738, "body": "Fix the syntax in service, include the method in CreateService"}, {"owner": {"reputation": 303, "user_id": 9479253, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cd34f4996365a59ad414df6950d6d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ashok Damaniya", "link": "https://stackoverflow.com/users/9479253/ashok-damaniya"}, "edited": false, "score": 0, "creation_date": 1567486424, "post_id": 57764879, "comment_id": 101965878, "body": "i suggest you should move your account_id , creation logic in model, and instead of writing <b>@store</b> , you should use attr to define objects , which will give you freedom from writing @store everywhere and just use <b>store</b> to access that object. good luck."}], "answers": [{"tags": [], "owner": {"reputation": 3630, "user_id": 4799659, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153200714295120/picture?type=large", "display_name": "fylooi", "link": "https://stackoverflow.com/users/4799659/fylooi"}, "is_accepted": true, "score": 5, "last_activity_date": 1567485564, "creation_date": 1567485564, "answer_id": 57765123, "question_id": 57764879, "link": "https://stackoverflow.com/questions/57764879/rails-using-private-and-protected-methods-in-a-service-object/57765123#57765123", "title": "Rails using private and protected methods in a Service object", "body": "<p>You have an extra <code>end</code> after <code>def execute..end</code>. That end closes the <code>CreateService</code> class. This means your protected methods are defined on the <code>Store</code> module. </p>\n\n<p>Hence the missing method. </p>\n"}], "owner": {"reputation": 277, "user_id": 4774554, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d72ff795ced575525d4f5cf033d65520?s=128&d=identicon&r=PG&f=1", "display_name": "VegaStudios", "link": "https://stackoverflow.com/users/4774554/vegastudios"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 96, "favorite_count": 0, "accepted_answer_id": 57765123, "answer_count": 1, "score": 2, "last_activity_date": 1567485564, "creation_date": 1567483173, "question_id": 57764879, "link": "https://stackoverflow.com/questions/57764879/rails-using-private-and-protected-methods-in-a-service-object", "title": "Rails using private and protected methods in a Service object", "body": "<p>I'm trying to move some business logic out of one of my controllers, <code>StoreController</code> and into a new <code>Store::CreateService</code> service object. Learning about services recently, it doesn't seem to be much of an established pattern for implementing them. I'm running into an error trying to call a protected method. I can obviously move the logic from those protected methods directly into <code>execute</code> but my understanding was that this should be okay to Rails.</p>\n\n<pre><code>undefined local variable or method `find_and_set_account_id' for #&lt;Store::CreateService:0x00007f832f8928f8&gt;\n</code></pre>\n\n<p>Here is the Service object</p>\n\n<pre><code>module Store\n  class CreateService &lt; BaseService\n\n    def initialize(user, params)\n      @current_user, @params = user, params.dup\n    end\n\n    def execute\n\n      @store = Store.new(params)\n\n      @store.creator = current_user\n\n      find_and_set_account_id\n\n      if @store.save\n        # Make sure that the user is allowed to use the specified visibility level\n        @store.members.create(\n          role: \"owner\",\n          user: current_user\n        )\n      end\n\n      after_create_actions if @store.persisted?\n\n      @store\n    end\n  end\n\n  protected\n\n    def after_create_actions\n      event_service.create_store(@store, current_user)\n    end\n\n    def find_and_set_account_id\n      loop do\n        @store.account_id = SecureRandom.random_number(10**7)\n        break unless Store.where(account_id: account_id).exists?\n      end\n    end\nend\n\n</code></pre>\n"}, {"tags": ["ruby", "gsub"], "comments": [{"owner": {"reputation": 13635, "user_id": 1061413, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/0beb915463288cb6e8b50e8121860717?s=128&d=identicon&r=PG", "display_name": "Amit Kumar Gupta", "link": "https://stackoverflow.com/users/1061413/amit-kumar-gupta"}, "edited": false, "score": 0, "creation_date": 1567481993, "post_id": 57764633, "comment_id": 101965101, "body": "StackOverflow allows you to preview your question before posting it. Unless you put HTML tags within code blocks, StackOverflow will not render them, so it looked like you just had a string &quot;hello hello2 hello3&quot; and were expecting to get the output &quot;address1 address2&quot;, which was very confusing. I edited your post so it makes sense now. Please always try to make it as easy as possible for people to help you successfully -- previewing your questions to see if they look right and using nice formatting like code blocks will help with that."}, {"owner": {"reputation": 13635, "user_id": 1061413, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/0beb915463288cb6e8b50e8121860717?s=128&d=identicon&r=PG", "display_name": "Amit Kumar Gupta", "link": "https://stackoverflow.com/users/1061413/amit-kumar-gupta"}, "edited": false, "score": 0, "creation_date": 1567482142, "post_id": 57764633, "comment_id": 101965133, "body": "Couple questions: what do you mean &quot;do each to check in my DB&quot;? Also, <code>gsub</code> is used to replace substrings, but you say you want to extract substrings. What exactly do you want the result to be? You say you want <code>address1</code> and <code>address2</code>. Does that mean you want an array consisting of those two strings? <code>gsub</code> won&#39;t return you an array of anything, it will just return a modified version of the string."}, {"owner": {"reputation": 481662, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 0, "creation_date": 1570433255, "post_id": 57764633, "comment_id": 102897927, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/22651733/how-to-extract-the-img-src-content-from-a-text-in-ruby\">How to extract the img src content from a text in ruby</a>"}], "answers": [{"comments": [{"owner": {"reputation": 51, "user_id": 11855793, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6264170beae8c5c09d0efd498bec4eb8?s=128&d=identicon&r=PG", "display_name": "overflow", "link": "https://stackoverflow.com/users/11855793/overflow"}, "edited": false, "score": 0, "creation_date": 1567496706, "post_id": 57765288, "comment_id": 101969592, "body": "I appreciate it. I solved this problem with split and array, but I would try this scan method."}], "tags": [], "owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "is_accepted": false, "score": 1, "last_activity_date": 1567490298, "last_edit_date": 1567490298, "creation_date": 1567486808, "answer_id": 57765288, "question_id": 57764633, "link": "https://stackoverflow.com/questions/57764633/how-to-get-src-with-gsubhow-to-extract-something-in-the-pattern/57765288#57765288", "title": "How to get src with gsub?(how to extract something in the pattern?)", "body": "<pre><code>str = \"hello &lt;img src='address1'&gt; hello2 &lt;img src='address2'&gt;hello3\" \n\nstr.scan(/(?&lt;=&lt;img src=')[\\w ]+/)\n  #=&gt; [\"address1\", \"address2\"]\n</code></pre>\n\n<p>See <a href=\"https://ruby-doc.org/core-2.6.3/String.html#method-i-scan\" rel=\"nofollow noreferrer\">String#scan</a>. The regular expression reads, \"match one or more word characters (English letters, digits and the underscore) or spaces, immediately preceded by the string <code>\"&lt;img src='\"</code>, <code>(?&lt;=&lt;img src=')</code> being a <em>positive lookbehind</em>.</p>\n"}], "owner": {"reputation": 51, "user_id": 11855793, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6264170beae8c5c09d0efd498bec4eb8?s=128&d=identicon&r=PG", "display_name": "overflow", "link": "https://stackoverflow.com/users/11855793/overflow"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 56, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1567490298, "creation_date": 1567480637, "last_edit_date": 1567482166, "question_id": 57764633, "link": "https://stackoverflow.com/questions/57764633/how-to-get-src-with-gsubhow-to-extract-something-in-the-pattern", "title": "How to get src with gsub?(how to extract something in the pattern?)", "body": "<p>I want to extract src in the text+tag string. For example, if the text is </p>\n\n<pre><code>hello &lt;img src='address1'&gt; hello2 &lt;img src='address2'&gt;hello3\n</code></pre>\n\n<p>I want to extract <code>address1</code> and <code>address2</code> with <code>gsub</code>.</p>\n\n<p>If I code like this:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>text = \"hello &lt;img src='address1'&gt; hello2 &lt;img src='address2'&gt;hello3\"\ntemp = text.gsub(/.*&lt;img src=/,'').gsub(/&gt;.*/,'')\n</code></pre>\n\n<p>I can get only <code>address2</code> (I mean the last address). I want to extract <code>address1</code> and <code>address2</code>, and do each to check in my DB.</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 6207, "user_id": 5117953, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/Ca0RW.jpg?s=128&g=1", "display_name": "Vishal", "link": "https://stackoverflow.com/users/5117953/vishal"}, "edited": false, "score": 0, "creation_date": 1567485026, "post_id": 57764319, "comment_id": 101965609, "body": "It&#39;s same as an earlier version of rails. please refer this <a href=\"https://devblast.com/b/single-table-inheritance-with-rails-4-part-1\" rel=\"nofollow noreferrer\">devblast.com/b/single-table-inheritance-with-rails-4-part-1</a>"}, {"owner": {"reputation": 45322, "user_id": 421705, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/581b1760881c962648f99d6040d41829?s=128&d=identicon&r=PG", "display_name": "Holger Just", "link": "https://stackoverflow.com/users/421705/holger-just"}, "edited": false, "score": 0, "creation_date": 1567506630, "post_id": 57764319, "comment_id": 101974725, "body": "What exactly is your question?"}], "answers": [{"tags": [], "owner": {"reputation": 595, "user_id": 3632472, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4e431a79c8cf18fc5c29ebb94a721dda?s=128&d=identicon&r=PG&f=1", "display_name": "Rakesh", "link": "https://stackoverflow.com/users/3632472/rakesh"}, "is_accepted": true, "score": 0, "last_activity_date": 1567502870, "creation_date": 1567502870, "answer_id": 57768793, "question_id": 57764319, "link": "https://stackoverflow.com/questions/57764319/single-table-inheritance-in-rails6/57768793#57768793", "title": "Single Table Inheritance in rails6", "body": "<p>Create a model class with class name as Content and two other child class as Term and Phrase which must be inherited from class Content</p>\n\n<h2>syntax would be</h2>\n\n<pre><code># app/models/Content.rb\nclass Content &lt; ApplicationRecord    \n  #your code    \nend\n\n# app/models/term.rb\nclass Term &lt; Content    \n  #your code    \nend\n\n# app/models/phrase.rb\nclass Phrase &lt; Content    \n  #your code    \nend\n</code></pre>\n"}], "owner": {"reputation": 65, "user_id": 11850228, "user_type": "registered", "profile_image": "https://graph.facebook.com/938857089785122/picture?type=large", "display_name": "Dutavi", "link": "https://stackoverflow.com/users/11850228/dutavi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 48, "favorite_count": 0, "accepted_answer_id": 57768793, "answer_count": 1, "score": 0, "last_activity_date": 1567502870, "creation_date": 1567477336, "last_edit_date": 1567497281, "question_id": 57764319, "link": "https://stackoverflow.com/questions/57764319/single-table-inheritance-in-rails6", "title": "Single Table Inheritance in rails6", "body": "<blockquote>\n  <p>I have a problem related to Single Table Inheritance, and I have never used it, can you guys help me?</p>\n</blockquote>\n\n<p>Deck model</p>\n\n<pre><code>name: string\nhas_many Content\nContent has 2 types: Content::ForTerm / Content::ForPhrase\nContent::ForTerm has many Term\nContent::ForPhrase has many Phrase\n</code></pre>\n\n<p>term model :</p>\n\n<pre><code>id, word, meaning, reading\n</code></pre>\n\n<p>phrase model :</p>\n\n<pre><code>id, sentence\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 862, "user_id": 1600046, "user_type": "registered", "accept_rate": 45, "profile_image": "https://i.stack.imgur.com/5rxUl.jpg?s=128&g=1", "display_name": "Vibol", "link": "https://stackoverflow.com/users/1600046/vibol"}, "edited": false, "score": 0, "creation_date": 1567477862, "post_id": 57764305, "comment_id": 101964435, "body": "<code>email</code>, <code>first_name</code>, <code>last_name</code> should be added as table column (using rails migration) rather than virtual attributes, because you want it to get saved to database if I&#39;m not wrong."}, {"owner": {"reputation": 862, "user_id": 1600046, "user_type": "registered", "accept_rate": 45, "profile_image": "https://i.stack.imgur.com/5rxUl.jpg?s=128&g=1", "display_name": "Vibol", "link": "https://stackoverflow.com/users/1600046/vibol"}, "edited": false, "score": 0, "creation_date": 1567477952, "post_id": 57764305, "comment_id": 101964458, "body": "If you could explain what do you want to do with these 2 models, I can share you a better solution/explanation."}, {"owner": {"reputation": 161, "user_id": 9761922, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/c3kTy.jpg?s=128&g=1", "display_name": "Maycon Seidel", "link": "https://stackoverflow.com/users/9761922/maycon-seidel"}, "reply_to_user": {"reputation": 862, "user_id": 1600046, "user_type": "registered", "accept_rate": 45, "profile_image": "https://i.stack.imgur.com/5rxUl.jpg?s=128&g=1", "display_name": "Vibol", "link": "https://stackoverflow.com/users/1600046/vibol"}, "edited": false, "score": 0, "creation_date": 1567478179, "post_id": 57764305, "comment_id": 101964488, "body": "@coco I believe that <code>name</code> and <code>email</code> should be <code>User</code> fields."}, {"owner": {"reputation": 277, "user_id": 4774554, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d72ff795ced575525d4f5cf033d65520?s=128&d=identicon&r=PG&f=1", "display_name": "VegaStudios", "link": "https://stackoverflow.com/users/4774554/vegastudios"}, "edited": false, "score": 0, "creation_date": 1567478186, "post_id": 57764305, "comment_id": 101964490, "body": "There are a few instances where it would be preferable to call <code>member.first_name</code> rather than <code>member.user.first_name</code>, as it appears to do two lookups in my database."}, {"owner": {"reputation": 277, "user_id": 4774554, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d72ff795ced575525d4f5cf033d65520?s=128&d=identicon&r=PG&f=1", "display_name": "VegaStudios", "link": "https://stackoverflow.com/users/4774554/vegastudios"}, "edited": false, "score": 0, "creation_date": 1567478231, "post_id": 57764305, "comment_id": 101964497, "body": "<code>first_name</code>, <code>last_name</code> and <code>email</code> are actual columns on the User table."}, {"owner": {"reputation": 862, "user_id": 1600046, "user_type": "registered", "accept_rate": 45, "profile_image": "https://i.stack.imgur.com/5rxUl.jpg?s=128&g=1", "display_name": "Vibol", "link": "https://stackoverflow.com/users/1600046/vibol"}, "edited": false, "score": 0, "creation_date": 1567478317, "post_id": 57764305, "comment_id": 101964509, "body": "What does <code>User.invite!</code> do?"}, {"owner": {"reputation": 277, "user_id": 4774554, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d72ff795ced575525d4f5cf033d65520?s=128&d=identicon&r=PG&f=1", "display_name": "VegaStudios", "link": "https://stackoverflow.com/users/4774554/vegastudios"}, "reply_to_user": {"reputation": 862, "user_id": 1600046, "user_type": "registered", "accept_rate": 45, "profile_image": "https://i.stack.imgur.com/5rxUl.jpg?s=128&g=1", "display_name": "Vibol", "link": "https://stackoverflow.com/users/1600046/vibol"}, "edited": false, "score": 0, "creation_date": 1567478586, "post_id": 57764305, "comment_id": 101964557, "body": "@Coco it sends an invitation to a user, as part of <code>devise_invitable</code>"}, {"owner": {"reputation": 862, "user_id": 1600046, "user_type": "registered", "accept_rate": 45, "profile_image": "https://i.stack.imgur.com/5rxUl.jpg?s=128&g=1", "display_name": "Vibol", "link": "https://stackoverflow.com/users/1600046/vibol"}, "edited": false, "score": 0, "creation_date": 1567478991, "post_id": 57764305, "comment_id": 101964628, "body": "Ok, why not associate store to user directly? why need to have member object? Is the requirement many to many?"}, {"owner": {"reputation": 277, "user_id": 4774554, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d72ff795ced575525d4f5cf033d65520?s=128&d=identicon&r=PG&f=1", "display_name": "VegaStudios", "link": "https://stackoverflow.com/users/4774554/vegastudios"}, "edited": false, "score": 1, "creation_date": 1567479040, "post_id": 57764305, "comment_id": 101964633, "body": "The <code>member</code> model is a join table, because a user can have many memberships. <code>first_name</code>, <code>last_name</code> and <code>email</code> are actual columns on the User table but there are a few instances where it would be preferable to call <code>member.first_name</code> rather than <code>member.user.first_name</code>, as it appears to do two lookups in my database."}], "answers": [{"comments": [{"owner": {"reputation": 277, "user_id": 4774554, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d72ff795ced575525d4f5cf033d65520?s=128&d=identicon&r=PG&f=1", "display_name": "VegaStudios", "link": "https://stackoverflow.com/users/4774554/vegastudios"}, "edited": false, "score": 0, "creation_date": 1567478128, "post_id": 57764376, "comment_id": 101964480, "body": "Cool, I&#39;ve been seeing <code>delegate</code> lately but haven&#39;t familiarized myself with it yet. Also over-looked the object vs record statement. The <code>member</code> model above is just a join table. Can I delegate the first and last name attributes to the user or does that not make sense?"}, {"owner": {"reputation": 161, "user_id": 9761922, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/c3kTy.jpg?s=128&g=1", "display_name": "Maycon Seidel", "link": "https://stackoverflow.com/users/9761922/maycon-seidel"}, "reply_to_user": {"reputation": 277, "user_id": 4774554, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d72ff795ced575525d4f5cf033d65520?s=128&d=identicon&r=PG&f=1", "display_name": "VegaStudios", "link": "https://stackoverflow.com/users/4774554/vegastudios"}, "edited": false, "score": 1, "creation_date": 1567478316, "post_id": 57764376, "comment_id": 101964508, "body": "Yes, if they are is user fields."}, {"owner": {"reputation": 161, "user_id": 9761922, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/c3kTy.jpg?s=128&g=1", "display_name": "Maycon Seidel", "link": "https://stackoverflow.com/users/9761922/maycon-seidel"}, "reply_to_user": {"reputation": 277, "user_id": 4774554, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d72ff795ced575525d4f5cf033d65520?s=128&d=identicon&r=PG&f=1", "display_name": "VegaStudios", "link": "https://stackoverflow.com/users/4774554/vegastudios"}, "edited": false, "score": 0, "creation_date": 1567626317, "post_id": 57764376, "comment_id": 102022923, "body": "@VegaStudios, please mark it as the answer if it solved your problem"}], "tags": [], "owner": {"reputation": 161, "user_id": 9761922, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/c3kTy.jpg?s=128&g=1", "display_name": "Maycon Seidel", "link": "https://stackoverflow.com/users/9761922/maycon-seidel"}, "is_accepted": true, "score": 1, "last_activity_date": 1567477833, "creation_date": 1567477833, "answer_id": 57764376, "question_id": 57764305, "link": "https://stackoverflow.com/questions/57764305/rails-virtual-attribute-not-available-after-save/57764376#57764376", "title": "Rails virtual attribute not available after save", "body": "<p>Actually, I didn't understand why you would like to use the <code>attribute</code> in this example. I believe that you want/should use <a href=\"https://apidock.com/rails/Module/delegate\" rel=\"nofollow noreferrer\">delegate</a>.</p>\n\n<p>Basically, It seems to work when you invoke <code>invite!</code> because you probably are passing these attributes in parameters, so it initialize the object and set this \"temporary variables\". But, when you try to <code>SELECT</code> the register from database it's not there anymore.</p>\n\n<p>As you flagged, <code>remains alive while the object itself is available</code>. Check that it says the <strong>object</strong>. When you do <code>Member.last</code> it initializes a new object with the data returned from database.</p>\n"}, {"tags": [], "owner": {"reputation": 862, "user_id": 1600046, "user_type": "registered", "accept_rate": 45, "profile_image": "https://i.stack.imgur.com/5rxUl.jpg?s=128&g=1", "display_name": "Vibol", "link": "https://stackoverflow.com/users/1600046/vibol"}, "is_accepted": false, "score": 0, "last_activity_date": 1567480341, "last_edit_date": 1567480341, "creation_date": 1567478739, "answer_id": 57764456, "question_id": 57764305, "link": "https://stackoverflow.com/questions/57764305/rails-virtual-attribute-not-available-after-save/57764456#57764456", "title": "Rails virtual attribute not available after save", "body": "<p>I might go with this:</p>\n\n<pre><code>class Member &lt; ApplicationRecord\n  belongs_to :store\n  belongs_to :user\nend\n\n\nclass User &lt; ApplicationRecord\n  has_many :members\n  has_many :stores, through: :members\n\n  def self.invite_to_store(first_name, last_name, email, store_id)\n    ActiveRecord::Base.transaction do\n      user = invite!(first_name: first_name, last_name: last_name, email: email)\n      user.members.create!(store_id: store_id)\n    end\n  end \nend\n</code></pre>\n\n<p>Then you can call <code>User.invite_to_store('first name', 'last name', 'example@gmail.com', 1)</code></p>\n"}], "owner": {"reputation": 277, "user_id": 4774554, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d72ff795ced575525d4f5cf033d65520?s=128&d=identicon&r=PG&f=1", "display_name": "VegaStudios", "link": "https://stackoverflow.com/users/4774554/vegastudios"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 246, "favorite_count": 0, "accepted_answer_id": 57764376, "answer_count": 2, "score": 1, "last_activity_date": 1567480341, "creation_date": 1567477229, "question_id": 57764305, "link": "https://stackoverflow.com/questions/57764305/rails-virtual-attribute-not-available-after-save", "title": "Rails virtual attribute not available after save", "body": "<p>I'm not sure if this is a problem within my app or my understanding of virtual attributes. Creating a <code>Member</code> object with a <code>first_name</code> and <code>last_name</code> virtual attribute works. However, when I go to retrieve the <code>Member</code>, the first and last name are nil. I say that it works because the <code>User.invite!</code> method it invokes successfully creates and saves a new <code>User</code> with the first and last name. My understanding is from this <a href=\"https://jtway.co/rails-virtual-attributes-use-cases-cf33bd45e2a4\" rel=\"nofollow noreferrer\">article</a> below, but I wanted to get some insight whether I was missing or misunderstanding anything.</p>\n\n<blockquote>\n  <p>The Virtual Attribute is a class attribute, which has no\n  representation in the database. It becomes available after object\n  initialization and remains alive while the object itself is available\n  (like the instance methods)</p>\n</blockquote>\n\n<p>Member</p>\n\n<pre><code>class Member &lt; ApplicationRecord\n  belongs_to :store\n  belongs_to :user\n\n  attribute               :email, :string\n  attribute               :first_name, :string\n  attribute               :last_name, :string\n\n  before_validation       :set_user_id, if: :email?\n\n  private\n\n    def set_user_id\n      self.user = User.invite!({\n        first_name: first_name,\n        last_name: last_name,\n        email: email\n        })\n    end\nend\n</code></pre>\n\n<p>Console</p>\n\n<pre><code>Loading development environment (Rails 6.0.0)\nirb(main):001:0&gt; Member.last\n  Member Load (0.5ms)  SELECT \"members\".* FROM \"members\" ORDER BY \"members\".\"id\" DESC LIMIT $1  [[\"LIMIT\", 1]]\n=&gt; #&lt;Member id: 55, store_id: 43, user_id: 3, created_at: \"2019-09-03 02:05:27\", updated_at: \"2019-09-03 02:05:27\", email: nil, first_name: nil, last_name: nil&gt;\n</code></pre>\n"}, {"tags": ["ruby", "refinements"], "owner": {"reputation": 406, "user_id": 609167, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/05e5b4ced1a3ab4268be046184494ba7?s=128&d=identicon&r=PG", "display_name": "Michael Hunter", "link": "https://stackoverflow.com/users/609167/michael-hunter"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 19, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1567530706, "creation_date": 1567475430, "last_edit_date": 1567530706, "question_id": 57764138, "link": "https://stackoverflow.com/questions/57764138/how-can-you-refine-httpheaders-normalize-header", "title": "How can you refine HTTP::Headers.normalize_header?", "body": "<p>normalize_header in HTTP::headers turns underscores into dashes (<a href=\"https://github.com/httprb/http/issues/337\" rel=\"nofollow noreferrer\">https://github.com/httprb/http/issues/337</a>).  This isn't correct in some cases.  I can easily monkey patch this.  But I was trying to figure out how to use a refinement to narrow the scope of the modification.</p>\n\n<pre><code>require \"http\"\n\nmodule NormalizeHeaderPatch\n  refine HTTP::Headers do\n    def normalize_header(name)\n      puts \"refined normalize_header\"\n      name\n    end\n  end\nend\n\nusing NormalizeHeaderPatch\nauth_res = HTTP.headers(\n  \"client_id\" =&gt; \"client_id\"\n).get(\"https://www.google.com\")\n</code></pre>\n\n<p>But that doesn't work.  My gut is that I have missed something with the refinement not being activated once we are in the scope that ends up calling normalize_header but I don't know how to arrange for that to work.</p>\n"}, {"tags": ["ruby", "arguments", "positional-parameter"], "comments": [{"owner": {"reputation": 25637, "user_id": 6243352, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/715f60f9edc65642a6805752cfeebb27?s=128&d=identicon&r=PG&f=1", "display_name": "ggorlen", "link": "https://stackoverflow.com/users/6243352/ggorlen"}, "edited": false, "score": 2, "creation_date": 1567462689, "post_id": 57763118, "comment_id": 101962087, "body": "That&#39;s just the way ruby was designed. The reason is likely because parens on function calls and definitions are optional, so omitting them makes it ambiguous that it&#39;s a function call with two params. For the definition, the space is unambiguous likely because of the <code>def</code> keyword."}, {"owner": {"reputation": 324, "user_id": 4398376, "user_type": "registered", "accept_rate": 57, "profile_image": "https://graph.facebook.com/100001617753263/picture?type=large", "display_name": "kouty", "link": "https://stackoverflow.com/users/4398376/kouty"}, "reply_to_user": {"reputation": 25637, "user_id": 6243352, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/715f60f9edc65642a6805752cfeebb27?s=128&d=identicon&r=PG&f=1", "display_name": "ggorlen", "link": "https://stackoverflow.com/users/6243352/ggorlen"}, "edited": false, "score": 0, "creation_date": 1567463459, "post_id": 57763118, "comment_id": 101962216, "body": "@ggorlen So the space is ambiguous when &quot;written&quot; after calling the method and the parentheses don&#39;t not desambigue it."}, {"owner": {"reputation": 25637, "user_id": 6243352, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/715f60f9edc65642a6805752cfeebb27?s=128&d=identicon&r=PG&f=1", "display_name": "ggorlen", "link": "https://stackoverflow.com/users/6243352/ggorlen"}, "edited": false, "score": 0, "creation_date": 1567463836, "post_id": 57763118, "comment_id": 101962286, "body": "Yes, because parenthesis are also a tuple in addition to parameter lists. See the dupe link. Ruby doesn&#39;t know if you&#39;re trying to call the method with one tuple literal or with a parameter list. Anyway, there&#39;s never reason to put spaces between functions and their parameter lists, so it&#39;s sort of an academic question."}, {"owner": {"reputation": 324, "user_id": 4398376, "user_type": "registered", "accept_rate": 57, "profile_image": "https://graph.facebook.com/100001617753263/picture?type=large", "display_name": "kouty", "link": "https://stackoverflow.com/users/4398376/kouty"}, "reply_to_user": {"reputation": 25637, "user_id": 6243352, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/715f60f9edc65642a6805752cfeebb27?s=128&d=identicon&r=PG&f=1", "display_name": "ggorlen", "link": "https://stackoverflow.com/users/6243352/ggorlen"}, "edited": false, "score": 0, "creation_date": 1567463959, "post_id": 57763118, "comment_id": 101962306, "body": "@ggorlen Yes I already read it. Thank you."}, {"owner": {"reputation": 394580, "user_id": 479863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ArUCE.jpg?s=128&g=1", "display_name": "mu is too short", "link": "https://stackoverflow.com/users/479863/mu-is-too-short"}, "edited": false, "score": 0, "creation_date": 1567464120, "post_id": 57763118, "comment_id": 101962336, "body": "Also see <a href=\"https://stackoverflow.com/questions/41821628/ruby-how-can-i-kill-warning-interpreted-as-argument-prefix/41822037#41822037\" title=\"ruby how can i kill warning interpreted as argument prefix\">stackoverflow.com/questions/41821628/&hellip;</a>"}, {"owner": {"reputation": 394580, "user_id": 479863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ArUCE.jpg?s=128&g=1", "display_name": "mu is too short", "link": "https://stackoverflow.com/users/479863/mu-is-too-short"}, "edited": false, "score": 1, "creation_date": 1567464362, "post_id": 57763118, "comment_id": 101962374, "body": "Parentheses can be used for expression grouping or calling methods. When you say <code>m(a, b)</code>, they&#39;re method calling parentheses; when you say <code>m (a, b)</code>, they&#39;re expression grouping parentheses. Then, since <code>a, b</code> isn&#39;t an expression (i.e. there&#39;s no comma operator in Ruby), <code>m (a, b)</code> is a syntax error."}, {"owner": {"reputation": 324, "user_id": 4398376, "user_type": "registered", "accept_rate": 57, "profile_image": "https://graph.facebook.com/100001617753263/picture?type=large", "display_name": "kouty", "link": "https://stackoverflow.com/users/4398376/kouty"}, "reply_to_user": {"reputation": 394580, "user_id": 479863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ArUCE.jpg?s=128&g=1", "display_name": "mu is too short", "link": "https://stackoverflow.com/users/479863/mu-is-too-short"}, "edited": false, "score": 1, "creation_date": 1567465395, "post_id": 57763118, "comment_id": 101962516, "body": "@muistooshort It&#39;s perfectly makes sense now. It is different than the answer in the original post I duplicated. Because from the answer there, it seems that space is a parenthesis so space + content + ) would be good and there isn&#39;t. With your answer, logically it&#39;s clear."}, {"owner": {"reputation": 394580, "user_id": 479863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ArUCE.jpg?s=128&g=1", "display_name": "mu is too short", "link": "https://stackoverflow.com/users/479863/mu-is-too-short"}, "edited": false, "score": 1, "creation_date": 1567465883, "post_id": 57763118, "comment_id": 101962579, "body": "Thanks. The one I answered was marked as a duplicate so I figured that question is more canonical than the one I answered. Shame that the &quot;This question already has an answer here:&quot; links don&#39;t go both ways"}, {"owner": {"reputation": 394580, "user_id": 479863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ArUCE.jpg?s=128&g=1", "display_name": "mu is too short", "link": "https://stackoverflow.com/users/479863/mu-is-too-short"}, "edited": false, "score": 0, "creation_date": 1567466824, "post_id": 57763118, "comment_id": 101962708, "body": "So it seems they are linked both ways but the back-links are sort of hidden in the &quot;Linked&quot; sidebar box."}], "owner": {"reputation": 324, "user_id": 4398376, "user_type": "registered", "accept_rate": 57, "profile_image": "https://graph.facebook.com/100001617753263/picture?type=large", "display_name": "kouty", "link": "https://stackoverflow.com/users/4398376/kouty"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 34, "favorite_count": 0, "closed_date": 1567463237, "answer_count": 0, "score": 0, "last_activity_date": 1567462323, "creation_date": 1567462323, "question_id": 57763118, "link": "https://stackoverflow.com/questions/57763118/ruby-method-arguments-writen-after-method-name-and-space-leads-to-error", "closed_reason": "Duplicate", "title": "ruby method arguments writen after method name and space leads to error", "body": "<p>I write a method.</p>\n\n<pre><code>def additionner (x,y) \n\n  puts (x * y) \n\nend \n\nadditionner(2,7)\n</code></pre>\n\n<p>It works, but if I make a space after calling the method, it doesn\u2019t work, why? Note that there is no difference wether there is a space between the method name and the parenthesis inside the definition of the method. </p>\n\n<pre><code>def additionner (x,y)\n\n  puts (x * y)\n\nend\n\nadditionner (2,7)\n</code></pre>\n\n<blockquote>\n  <p>(repl):4: syntax error, unexpected \u2018,\u2019, expecting \u2018)\u2019\n  additionner (2,7)</p>\n</blockquote>\n\n<p>in version: ruby 2.5.5p157 (2019-03-15 revision 67260) [x86_64-linux]</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "graphql"], "comments": [{"owner": {"reputation": 89316, "user_id": 238886, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/8ca29123b5669b26f9b6ca2c62d9d215?s=128&d=identicon&r=PG", "display_name": "Wayne Conrad", "link": "https://stackoverflow.com/users/238886/wayne-conrad"}, "edited": false, "score": 0, "creation_date": 1567468062, "post_id": 57763043, "comment_id": 101962898, "body": "What do you actually get?"}, {"owner": {"reputation": 51, "user_id": 6095971, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yZrM3.jpg?s=128&g=1", "display_name": "Ranchow", "link": "https://stackoverflow.com/users/6095971/ranchow"}, "reply_to_user": {"reputation": 89316, "user_id": 238886, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/8ca29123b5669b26f9b6ca2c62d9d215?s=128&d=identicon&r=PG", "display_name": "Wayne Conrad", "link": "https://stackoverflow.com/users/238886/wayne-conrad"}, "edited": false, "score": 0, "creation_date": 1567493880, "post_id": 57763043, "comment_id": 101968273, "body": "Right now I get back a user object with fields defined in the type only."}], "answers": [{"tags": [], "owner": {"reputation": 51, "user_id": 6095971, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yZrM3.jpg?s=128&g=1", "display_name": "Ranchow", "link": "https://stackoverflow.com/users/6095971/ranchow"}, "is_accepted": false, "score": 0, "last_activity_date": 1567520917, "creation_date": 1567520917, "answer_id": 57773779, "question_id": 57763043, "link": "https://stackoverflow.com/questions/57763043/how-do-i-return-custom-object-in-a-mutation/57773779#57773779", "title": "How do I return custom object in a mutation?", "body": "<p><strong>Update</strong>: Here's the solution that worked for me.\nI created a new type <code>LoginType</code> that defines <code>token</code> and <code>user</code> fields and made the mutation respond to it instead of the <code>UserType</code></p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>module Types\n  class LoginType &lt; BaseObject\n    field :token, String, null: false\n    field :user, Types::UserType, null: false\n  end\nend\n</code></pre>\n\n<p>Thanks to <a href=\"https://rmosolgo.github.io/\" rel=\"nofollow noreferrer\">@rmosolgo</a> for the help</p>\n"}], "owner": {"reputation": 51, "user_id": 6095971, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yZrM3.jpg?s=128&g=1", "display_name": "Ranchow", "link": "https://stackoverflow.com/users/6095971/ranchow"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 321, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1567520917, "creation_date": 1567461540, "question_id": 57763043, "link": "https://stackoverflow.com/questions/57763043/how-do-i-return-custom-object-in-a-mutation", "title": "How do I return custom object in a mutation?", "body": "<p>I'd like my GraphQL mutation to return field that is not defined in the Type Object</p>\n\n<p>I am using the Ruby GraphQL gem with Rails 6. I have described a <code>UserType</code> with the fields <code>username</code>, <code>email</code> and <code>password</code>. In my login mutation, I'd like to return a jwt token as the response. Here's what I have so far;</p>\n\n<p>The user type:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>module Types\n  class UserType &lt; BaseObject\n    field :id, ID, null: false\n    field :email, String, null: false\n    field :username, String, null: false\n  end\nend\n</code></pre>\n\n<p>The mutation:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>module Mutations\n  UserMutation = GraphQL::ObjectType.define do\n   field :login, Types::UserType do\n     argument :username, !types.String\n     argument :password, !types.String\n\n     resolve -&gt;(_obj, args, _ctx) do\n       # perform the authentication and return a jwt token.\n     end\n   end\n  end\nend\n</code></pre>\n\n<p>I expect to get a response like:</p>\n\n<pre><code>{\n  \"data\" : {\n    \"token\": \"my_generated_token\"\n  }\n}\n</code></pre>\n\n<p>or an error message of the same shape.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "devise"], "answers": [{"comments": [{"owner": {"reputation": 41, "user_id": 11081520, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Zr_5Y_lKdb4/AAAAAAAAAAI/AAAAAAAAFlQ/Ghx_aA5_v0Y/photo.jpg?sz=128", "display_name": "Aldo Witzke", "link": "https://stackoverflow.com/users/11081520/aldo-witzke"}, "edited": false, "score": 0, "creation_date": 1567463070, "post_id": 57763048, "comment_id": 101962161, "body": "Thanks for your answer @mrzasa but it is a little bit confusing for me. I am creating a method called success, also the route for it and making after_inactive_sign_up_path_for redirect to &quot;success_path&quot;, which has &#39;devise/registrations/success&#39;, but getting the same error. Did I understand everything wrong? :("}, {"owner": {"reputation": 21613, "user_id": 580346, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/ba17945a06aac247b06548d5afe341e8?s=128&d=identicon&r=PG", "display_name": "mrzasa", "link": "https://stackoverflow.com/users/580346/mrzasa"}, "reply_to_user": {"reputation": 41, "user_id": 11081520, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Zr_5Y_lKdb4/AAAAAAAAAAI/AAAAAAAAFlQ/Ghx_aA5_v0Y/photo.jpg?sz=128", "display_name": "Aldo Witzke", "link": "https://stackoverflow.com/users/11081520/aldo-witzke"}, "edited": false, "score": 0, "creation_date": 1567492135, "post_id": 57763048, "comment_id": 101967547, "body": "you shouldn&#39;t redirect in <code>after_inactive_sign_up_path_for</code>, just return a path to the method:<code>def after_inactive_sign_up_path_for; success_path; end</code>"}, {"owner": {"reputation": 41, "user_id": 11081520, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Zr_5Y_lKdb4/AAAAAAAAAAI/AAAAAAAAFlQ/Ghx_aA5_v0Y/photo.jpg?sz=128", "display_name": "Aldo Witzke", "link": "https://stackoverflow.com/users/11081520/aldo-witzke"}, "edited": false, "score": 0, "creation_date": 1567510197, "post_id": 57763048, "comment_id": 101976619, "body": "If I do this, my resource comes nil, which means it is not passing through my create method. After my create, I want to redirect to a specific view saying his/her sign up was successful (yet he/she needs to confirm email)."}], "tags": [], "owner": {"reputation": 21613, "user_id": 580346, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/ba17945a06aac247b06548d5afe341e8?s=128&d=identicon&r=PG", "display_name": "mrzasa", "link": "https://stackoverflow.com/users/580346/mrzasa"}, "is_accepted": false, "score": 2, "last_activity_date": 1567461605, "creation_date": 1567461605, "answer_id": 57763048, "question_id": 57763010, "link": "https://stackoverflow.com/questions/57763010/render-and-or-redirect-were-called-multiple-times-in-this-action-on-devise/57763048#57763048", "title": "&#39;Render and/or redirect were called multiple times in this action&#39; on devise", "body": "<p><code>after_inactive_sign_up_path_for</code> is not meant to render a view. It's a path that will be used for redirect. You should just put a path to an action rendering<code>'devise/registrations/success'</code>.</p>\n\n<p>The error you see is cause by the fact that the devise controller calls render/redirect and then you try to call it as well.</p>\n"}], "owner": {"reputation": 41, "user_id": 11081520, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Zr_5Y_lKdb4/AAAAAAAAAAI/AAAAAAAAFlQ/Ghx_aA5_v0Y/photo.jpg?sz=128", "display_name": "Aldo Witzke", "link": "https://stackoverflow.com/users/11081520/aldo-witzke"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 84, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1567461703, "creation_date": 1567461266, "last_edit_date": 1567461703, "question_id": 57763010, "link": "https://stackoverflow.com/questions/57763010/render-and-or-redirect-were-called-multiple-times-in-this-action-on-devise", "title": "&#39;Render and/or redirect were called multiple times in this action&#39; on devise", "body": "<p>I am using devise and trying to redirect my user after sign up form to a specific template.</p>\n\n<p>I've checked the docs about <code>after_inactive_sign_up_path_for</code> method but I am receiving an exception saying I am redirecting twice.</p>\n\n<pre><code>RegistrationsController &lt; Devise::RegistrationsController\n\ndef create\n    super\n    UsersCreateJob.perform_later(resource.id) if resource.persisted?\nend\n\nprotected\n\ndef after_inactive_sign_up_path_for(resource)\n   render template: 'devise/registrations/success'\nend\n</code></pre>\n\n<pre><code>Exception\n\nAbstractController::DoubleRenderError in RegistrationsController#create\n\nRender and/or redirect were called multiple times in this action. Please note that you may only call render OR redirect, and at most once per action. Also note that neither redirect nor render terminate execution of the action, so if you want to exit an action after redirecting, you need to do something like \"redirect_to(...) and return\".\n</code></pre>\n\n<p>As far as I understand, the <code>after_inactive_sign_up_path_for</code> method overwrites the one from Devise Registration Controller and redirect to my template, right? Where this other template is coming from?</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "answers": [{"comments": [{"owner": {"reputation": 2251, "user_id": 9785060, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IUduC.png?s=128&g=1", "display_name": "Viktor", "link": "https://stackoverflow.com/users/9785060/viktor"}, "edited": false, "score": 0, "creation_date": 1567451064, "post_id": 57761643, "comment_id": 101959334, "body": "Why is <code>.where(array_one: array_one, array_two: array_two)</code> split into two rows?"}, {"owner": {"reputation": 79, "user_id": 7260304, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2debe2c0055c8c9880c2affaabe0b2f4?s=128&d=identicon&r=PG&f=1", "display_name": "Dok Nabaku", "link": "https://stackoverflow.com/users/7260304/dok-nabaku"}, "edited": false, "score": 0, "creation_date": 1567451467, "post_id": 57761643, "comment_id": 101959452, "body": "Because are different rows on DB."}, {"owner": {"reputation": 11394, "user_id": 794481, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/344337b6819f2f513fa80bb227be3c2d?s=128&d=identicon&r=PG", "display_name": "Tallboy", "link": "https://stackoverflow.com/users/794481/tallboy"}, "edited": false, "score": 1, "creation_date": 1567451791, "post_id": 57761643, "comment_id": 101959522, "body": "No, its not because of that. It&#39;s because you want to dynamically build a query based on conditions. Based on your original question you want to exclude <code>.where(date: ...)</code> if date is nil, which is exactly what the code above does. It doesn&#39;t matter how you split it up. Also, mark answers as chosen once you get it. Cheers"}, {"owner": {"reputation": 11394, "user_id": 794481, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/344337b6819f2f513fa80bb227be3c2d?s=128&d=identicon&r=PG", "display_name": "Tallboy", "link": "https://stackoverflow.com/users/794481/tallboy"}, "reply_to_user": {"reputation": 2251, "user_id": 9785060, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IUduC.png?s=128&g=1", "display_name": "Viktor", "link": "https://stackoverflow.com/users/9785060/viktor"}, "edited": false, "score": 0, "creation_date": 1567451889, "post_id": 57761643, "comment_id": 101959546, "body": "@\u0412\u0438\u043a\u0442\u043e\u0440 i split it up arbitrarily to show the query still works. He can group them or not group them, however he sees fit"}, {"owner": {"reputation": 2251, "user_id": 9785060, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IUduC.png?s=128&g=1", "display_name": "Viktor", "link": "https://stackoverflow.com/users/9785060/viktor"}, "edited": false, "score": 0, "creation_date": 1567452145, "post_id": 57761643, "comment_id": 101959613, "body": "Makse sense, was just wondering if there&#39;s more going on there, +1"}], "tags": [], "owner": {"reputation": 11394, "user_id": 794481, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/344337b6819f2f513fa80bb227be3c2d?s=128&d=identicon&r=PG", "display_name": "Tallboy", "link": "https://stackoverflow.com/users/794481/tallboy"}, "is_accepted": false, "score": 4, "last_activity_date": 1567451899, "last_edit_date": 1567451899, "creation_date": 1567450760, "answer_id": 57761643, "question_id": 57761623, "link": "https://stackoverflow.com/questions/57761623/active-record-query-ignoring-nil-values/57761643#57761643", "title": "Active Record Query ignoring nil values", "body": "<p>You can chain your queries together (it's called lazy loading). They won't actually be executed until the first thing that calls query. This allows you to 'build' the query</p>\n\n<pre><code>query = Record.where(array_one: array_one, array_two: array_two)\nquery = query.where(date: date) if date.present?\n\nquery.each do |row| # now the query is executed\n  # do stuff\nend\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 2251, "user_id": 9785060, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IUduC.png?s=128&g=1", "display_name": "Viktor", "link": "https://stackoverflow.com/users/9785060/viktor"}, "edited": false, "score": 0, "creation_date": 1567453367, "post_id": 57761746, "comment_id": 101959959, "body": "What does the first line do ?"}, {"owner": {"reputation": 4600, "user_id": 5961578, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/df7cbfdd2a92a7926af3bbb8648318aa?s=128&d=identicon&r=PG", "display_name": "moveson", "link": "https://stackoverflow.com/users/5961578/moveson"}, "edited": false, "score": 1, "creation_date": 1567461815, "post_id": 57761746, "comment_id": 101961925, "body": "It starts with whatever scope is already in existence when you call the method."}, {"owner": {"reputation": 89316, "user_id": 238886, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/8ca29123b5669b26f9b6ca2c62d9d215?s=128&d=identicon&r=PG", "display_name": "Wayne Conrad", "link": "https://stackoverflow.com/users/238886/wayne-conrad"}, "reply_to_user": {"reputation": 2251, "user_id": 9785060, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IUduC.png?s=128&g=1", "display_name": "Viktor", "link": "https://stackoverflow.com/users/9785060/viktor"}, "edited": false, "score": 1, "creation_date": 1567468286, "post_id": 57761746, "comment_id": 101962933, "body": "@\u0412\u0438\u043a\u0442\u043e\u0440 It creates a new scope.  Every ActiveRecord query starts with a new scope, usually automatically where you can&#39;t see it.  For example, <code>Record.where...</code> is equivalent to <code>Record.scope.where</code>."}, {"owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 1, "creation_date": 1567490880, "post_id": 57761746, "comment_id": 101967095, "body": "And it make sure that you get a Relation returned even if all conditions are false"}], "tags": [], "owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "is_accepted": false, "score": 2, "last_activity_date": 1567452619, "last_edit_date": 1567452619, "creation_date": 1567451665, "answer_id": 57761746, "question_id": 57761623, "link": "https://stackoverflow.com/questions/57761623/active-record-query-ignoring-nil-values/57761746#57761746", "title": "Active Record Query ignoring nil values", "body": "<p>I would do something like this:</p>\n\n<pre><code>scope = Record.scope\nscope = scope.where(array_one: array_one) if array_one\nscope = scope.where(array_two: array_two) if array_two\nscope = scope.where(date: date) if date\nscope\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 89316, "user_id": 238886, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/8ca29123b5669b26f9b6ca2c62d9d215?s=128&d=identicon&r=PG", "display_name": "Wayne Conrad", "link": "https://stackoverflow.com/users/238886/wayne-conrad"}, "edited": false, "score": 0, "creation_date": 1567468199, "post_id": 57763037, "comment_id": 101962922, "body": "All this time I&#39;ve been programming Ruby, and I didn&#39;t know about Hash#compact.  Nice."}, {"owner": {"reputation": 79, "user_id": 7260304, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2debe2c0055c8c9880c2affaabe0b2f4?s=128&d=identicon&r=PG&f=1", "display_name": "Dok Nabaku", "link": "https://stackoverflow.com/users/7260304/dok-nabaku"}, "edited": false, "score": 0, "creation_date": 1567473397, "post_id": 57763037, "comment_id": 101963738, "body": "I didn&#39;t know about this too, awesome!"}, {"owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 0, "creation_date": 1567495033, "post_id": 57763037, "comment_id": 101968787, "body": "Maybe because it is still kind of new, it was added with version Ruby 2.4.0?"}, {"owner": {"reputation": 1668, "user_id": 1576822, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/FY9gu.jpg?s=128&g=1", "display_name": "Sergio Belevskij", "link": "https://stackoverflow.com/users/1576822/sergio-belevskij"}, "edited": false, "score": 0, "creation_date": 1568699069, "post_id": 57763037, "comment_id": 102346211, "body": "sorry, but in Rails Hash#compact supported since 4.1.8 <a href=\"https://apidock.com/rails/v4.1.8/Hash/compact\" rel=\"nofollow noreferrer\">apidock.com/rails/v4.1.8/Hash/compact</a>"}], "tags": [], "owner": {"reputation": 1668, "user_id": 1576822, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/FY9gu.jpg?s=128&g=1", "display_name": "Sergio Belevskij", "link": "https://stackoverflow.com/users/1576822/sergio-belevskij"}, "is_accepted": false, "score": 4, "last_activity_date": 1567461484, "creation_date": 1567461484, "answer_id": 57763037, "question_id": 57761623, "link": "https://stackoverflow.com/questions/57761623/active-record-query-ignoring-nil-values/57763037#57763037", "title": "Active Record Query ignoring nil values", "body": "<pre><code>Record.where({ array_one: array_one, array_two: array_two, date: date }.compact)\n</code></pre>\n"}], "owner": {"reputation": 79, "user_id": 7260304, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2debe2c0055c8c9880c2affaabe0b2f4?s=128&d=identicon&r=PG&f=1", "display_name": "Dok Nabaku", "link": "https://stackoverflow.com/users/7260304/dok-nabaku"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 136, "favorite_count": 0, "answer_count": 3, "score": 2, "last_activity_date": 1567461484, "creation_date": 1567450649, "question_id": 57761623, "link": "https://stackoverflow.com/questions/57761623/active-record-query-ignoring-nil-values", "title": "Active Record Query ignoring nil values", "body": "<p>Takes a query using some methods like code bellow. How can I ignore the <code>nil</code> values? For example: if the method <code>date</code> returns <code>nil</code> I wanna that the query use just <code>array_one</code> and <code>array_to</code>.</p>\n\n<pre><code>def array_one \n ...\nend \n\ndef array_two \n ...\nend\n\ndef date \n ...\nend\n\nRecord.where(array_one: array_one, array_two: array_two, date: date)\n\n\n\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 486, "user_id": 7069011, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AfPIn.jpg?s=128&g=1", "display_name": "ThorTL67", "link": "https://stackoverflow.com/users/7069011/thortl67"}, "edited": false, "score": 2, "creation_date": 1567439065, "post_id": 57759402, "comment_id": 101955460, "body": "Can you add in the full contents of the error?"}, {"owner": {"reputation": 47, "user_id": 11286717, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-OysRu6ppb0U/AAAAAAAAAAI/AAAAAAAAAAk/c8eR1BlDQ8s/photo.jpg?sz=128", "display_name": "Mr.Movies Tamil", "link": "https://stackoverflow.com/users/11286717/mr-movies-tamil"}, "reply_to_user": {"reputation": 486, "user_id": 7069011, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AfPIn.jpg?s=128&g=1", "display_name": "ThorTL67", "link": "https://stackoverflow.com/users/7069011/thortl67"}, "edited": false, "score": 0, "creation_date": 1567440099, "post_id": 57759402, "comment_id": 101955849, "body": "When I switch to request tab in a page it invokes users controller and request user action it routes to  /request so I am not able to get the user id in params. So I pass the user argument but it shows wrong arguments (0 or 1) error"}], "answers": [{"comments": [{"owner": {"reputation": 47, "user_id": 11286717, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-OysRu6ppb0U/AAAAAAAAAAI/AAAAAAAAAAk/c8eR1BlDQ8s/photo.jpg?sz=128", "display_name": "Mr.Movies Tamil", "link": "https://stackoverflow.com/users/11286717/mr-movies-tamil"}, "edited": false, "score": 0, "creation_date": 1567444369, "post_id": 57759998, "comment_id": 101957267, "body": "How can I access the user variable in show method from requests and what if I had another users variables in show method for example  @users = @user.followed_users.paginate(page: params[:page])."}, {"owner": {"reputation": 88, "user_id": 10063851, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-G5zeMgH7aAs/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7oQYTI4hGcoYfZpKEW3J0snppNW5A/mo/photo.jpg?sz=128", "display_name": "Steve Redka", "link": "https://stackoverflow.com/users/10063851/steve-redka"}, "reply_to_user": {"reputation": 47, "user_id": 11286717, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-OysRu6ppb0U/AAAAAAAAAAI/AAAAAAAAAAk/c8eR1BlDQ8s/photo.jpg?sz=128", "display_name": "Mr.Movies Tamil", "link": "https://stackoverflow.com/users/11286717/mr-movies-tamil"}, "edited": false, "score": 0, "creation_date": 1567447064, "post_id": 57759998, "comment_id": 101958092, "body": "Do you use any autthentication gems? If you are using Devise, currently logged in user is accessed through <code>current_user</code> <a href=\"https://github.com/plataformatec/devise#controller-filters-and-helpers\" rel=\"nofollow noreferrer\">github.com/plataformatec/devise#controller-filters-and-helpe&zwnj;&#8203;rs</a>"}], "tags": [], "owner": {"reputation": 88, "user_id": 10063851, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-G5zeMgH7aAs/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7oQYTI4hGcoYfZpKEW3J0snppNW5A/mo/photo.jpg?sz=128", "display_name": "Steve Redka", "link": "https://stackoverflow.com/users/10063851/steve-redka"}, "is_accepted": false, "score": 1, "last_activity_date": 1567440458, "creation_date": 1567440458, "answer_id": 57759998, "question_id": 57759402, "link": "https://stackoverflow.com/questions/57759402/wrong-arguments-zero-or-one-error-in-rails/57759998#57759998", "title": "Wrong arguments zero or one error in rails", "body": "<blockquote>\n  <p>But when loading the page it shows wrong arguments error.</p>\n</blockquote>\n\n<p><a href=\"https://guides.rubyonrails.org/action_controller_overview.html#parameters\" rel=\"nofollow noreferrer\">https://guides.rubyonrails.org/action_controller_overview.html#parameters</a></p>\n\n<p>You aren't supposed to pass any arguments to Controller methods. In this case you should get user through params:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code># users_controller.rb\ndef show\n  @user = User.find(params[:id])\n  @title = \"Requests\"\n  @users = @user.followed_users.paginate(page: params[:page])\nend\n</code></pre>\n\n<hr>\n\n<blockquote>\n  <p>And also I need to configure my routes so that it will become users/id/requests instead of user/requests.</p>\n</blockquote>\n\n<p><a href=\"https://guides.rubyonrails.org/routing.html#adding-member-routes\" rel=\"nofollow noreferrer\">https://guides.rubyonrails.org/routing.html#adding-member-routes</a></p>\n\n<pre class=\"lang-rb prettyprint-override\"><code># routes.rb\nresources :users do \n  member do\n    get :following, :followers, :requests\n  end\nend\n</code></pre>\n\n<pre class=\"lang-rb prettyprint-override\"><code># users_controller.rb\ndef requests\n  @user = User.find(params[:id])\n  # whatever requests are\n  # @user.requests\nend\n</code></pre>\n\n<p>This is what link should look like in view:</p>\n\n<pre><code>&lt;%= link_to \"Requests\", user_requests_path(current_user) %&gt;\n</code></pre>\n"}], "owner": {"reputation": 47, "user_id": 11286717, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-OysRu6ppb0U/AAAAAAAAAAI/AAAAAAAAAAk/c8eR1BlDQ8s/photo.jpg?sz=128", "display_name": "Mr.Movies Tamil", "link": "https://stackoverflow.com/users/11286717/mr-movies-tamil"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 52, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1567440458, "creation_date": 1567437634, "last_edit_date": 1567438985, "question_id": 57759402, "link": "https://stackoverflow.com/questions/57759402/wrong-arguments-zero-or-one-error-in-rails", "title": "Wrong arguments zero or one error in rails", "body": "<p>I have passed an argument to the controller action. But when loading the page it shows wrong arguments error. And also I need to configure my routes so that it will become users/id/requests instead of user/requests. Because of that I need to pass an user argument.</p>\n\n<pre><code> &lt;% if signed_in? %&gt;\n   &lt;li&gt;&lt;%= link_to \"Requests\", requestuser_path(current_user) %&gt;&lt;/li&gt;\n</code></pre>\n\n<p>usercontroller:</p>\n\n<pre><code> def requestuser(user)\n   @title = \"Requests\"\n   @users = user.followed_users.paginate(page: params[:page])\n end\n</code></pre>\n\n<p>routes.rb</p>\n\n<pre><code>  resources :users do \n    member do\n      get :following, :followers\n    end\n  end\n\n  resources :sessions, only: [:new, :create, :destroy]\n  resources :requests, only: [:create]\n\n match '/request', to: 'users#requestuser', via: [:get, :post], as: :requestuser\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-4", "rubygems", "ruby-on-rails-5"], "comments": [{"owner": {"reputation": 21613, "user_id": 580346, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/ba17945a06aac247b06548d5afe341e8?s=128&d=identicon&r=PG", "display_name": "mrzasa", "link": "https://stackoverflow.com/users/580346/mrzasa"}, "edited": false, "score": 0, "creation_date": 1567437426, "post_id": 57759340, "comment_id": 101954822, "body": "Do you need it for development purposes? If for production purposes - what about the data? Should be shared between offline and online usage?"}, {"owner": {"reputation": 59, "user_id": 10867343, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-nDdWCUAZFa0/AAAAAAAAAAI/AAAAAAAAAAo/ZP8IdoDj40w/photo.jpg?sz=128", "display_name": "F&#233;lix Pujols", "link": "https://stackoverflow.com/users/10867343/f%c3%a9lix-pujols"}, "reply_to_user": {"reputation": 21613, "user_id": 580346, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/ba17945a06aac247b06548d5afe341e8?s=128&d=identicon&r=PG", "display_name": "mrzasa", "link": "https://stackoverflow.com/users/580346/mrzasa"}, "edited": false, "score": 0, "creation_date": 1567438168, "post_id": 57759340, "comment_id": 101955098, "body": "Thank you, The data can be offline, I don&#39;t need it to share it online. And it&#39;s also for production purpose."}, {"owner": {"reputation": 21613, "user_id": 580346, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/ba17945a06aac247b06548d5afe341e8?s=128&d=identicon&r=PG", "display_name": "mrzasa", "link": "https://stackoverflow.com/users/580346/mrzasa"}, "edited": false, "score": 0, "creation_date": 1567439033, "post_id": 57759340, "comment_id": 101955444, "body": "So you just want a local instance of your application, for using on one machine only?"}, {"owner": {"reputation": 486, "user_id": 7069011, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AfPIn.jpg?s=128&g=1", "display_name": "ThorTL67", "link": "https://stackoverflow.com/users/7069011/thortl67"}, "edited": false, "score": 0, "creation_date": 1567439181, "post_id": 57759340, "comment_id": 101955506, "body": "You could run it on a server which is accessible to your network but not the internet perhaps?"}, {"owner": {"reputation": 59, "user_id": 10867343, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-nDdWCUAZFa0/AAAAAAAAAAI/AAAAAAAAAAo/ZP8IdoDj40w/photo.jpg?sz=128", "display_name": "F&#233;lix Pujols", "link": "https://stackoverflow.com/users/10867343/f%c3%a9lix-pujols"}, "edited": false, "score": 0, "creation_date": 1567447631, "post_id": 57759340, "comment_id": 101958278, "body": "Yes, just a local instance, I don&#39;t need anything from the internet."}, {"owner": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "edited": false, "score": 0, "creation_date": 1567449676, "post_id": 57759340, "comment_id": 101958925, "body": "What is the general purpose of the app?  Will it evolve over time? Will new features ever be required? What database(s) are used?"}, {"owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 0, "creation_date": 1567465548, "post_id": 57759340, "comment_id": 101962539, "body": "The crux of this question seems how to be how to run a rails app without a terminal... it already has a built in offline server: <code>rails server</code>"}], "answers": [{"comments": [{"owner": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "edited": false, "score": 0, "creation_date": 1567449585, "post_id": 57759748, "comment_id": 101958896, "body": "If the application relies on a database as many rails apps do, how do you deal with setting up/seeding the database?  There are many things that need consideration. Have you even used this successfully with a basic rails app?"}, {"owner": {"reputation": 2907, "user_id": 565672, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/axgTy.png?s=128&g=1", "display_name": "RED_", "link": "https://stackoverflow.com/users/565672/red"}, "reply_to_user": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "edited": false, "score": 0, "creation_date": 1567613881, "post_id": 57759748, "comment_id": 102017927, "body": "I have used it yeah, it heavily depends on your application target, but I&#39;m suggesting it based on the information provided (that the application can work offline, without any data connection), and just added some things to think about so he doesn&#39;t try and force his application to work with this if it&#39;s not suitable."}], "tags": [], "owner": {"reputation": 2907, "user_id": 565672, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/axgTy.png?s=128&g=1", "display_name": "RED_", "link": "https://stackoverflow.com/users/565672/red"}, "is_accepted": false, "score": 3, "last_activity_date": 1567439191, "creation_date": 1567439191, "answer_id": 57759748, "question_id": 57759340, "link": "https://stackoverflow.com/questions/57759340/how-to-run-rails-web-app-as-a-desktop-or-offline-app/57759748#57759748", "title": "How to run Rails web app as a desktop or offline app", "body": "<p>If you want your application to work offline, and have no connection to the outside world, then you can use <a href=\"https://github.com/pmq20/ruby-packer\" rel=\"nofollow noreferrer\">ruby-packer</a> or similar to create a binary of your application. This option avoids having end users playing with the terminal.</p>\n\n<p>Think of the implications for your use case though:</p>\n\n<ul>\n<li><p>If multiple people use this application, does the data need to be synced between them all or can they all have a local copy that's different? If so then it needs a data connection.</p></li>\n<li><p>Do you need to maintain the hosted version, and does it need to talk to any of the local copies ever?</p></li>\n</ul>\n"}], "owner": {"reputation": 59, "user_id": 10867343, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-nDdWCUAZFa0/AAAAAAAAAAI/AAAAAAAAAAo/ZP8IdoDj40w/photo.jpg?sz=128", "display_name": "F&#233;lix Pujols", "link": "https://stackoverflow.com/users/10867343/f%c3%a9lix-pujols"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 339, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1567439191, "creation_date": 1567437357, "last_edit_date": 1567438031, "question_id": 57759340, "link": "https://stackoverflow.com/questions/57759340/how-to-run-rails-web-app-as-a-desktop-or-offline-app", "title": "How to run Rails web app as a desktop or offline app", "body": "<p>I have a rails web application running on the Heroku server, and I need this application to run using a local server, or running offline. I was trying rack-offline but I wonder if there's a simplest way, like a program to use the local server without applying commands in the terminal. </p>\n\n<p>This is for production purpose, the app is already running and they want it to work without an internet connection. The data can be just for offline usage.</p>\n\n<p>I will appreciate any help. thank you.</p>\n"}, {"tags": ["ruby", "bundler"], "answers": [{"tags": [], "owner": {"reputation": 16672, "user_id": 22237, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/hkobD.png?s=128&g=1", "display_name": "Kris", "link": "https://stackoverflow.com/users/22237/kris"}, "is_accepted": true, "score": 18, "last_activity_date": 1567527146, "last_edit_date": 1567527146, "creation_date": 1567434560, "answer_id": 57758679, "question_id": 57758654, "link": "https://stackoverflow.com/questions/57758654/why-do-i-get-could-not-find-bundler-1-17-3-after-upgrading-ruby/57758679#57758679", "title": "Why do I get `Could not find &#39;bundler&#39; (1.17.3)` after upgrading Ruby?", "body": "<p>This is because <code>gem install bundler</code> will install the newer 2.x version of bundler and the <code>Gemfile.lock</code> specifies the version of bundler to use at the bottom.</p>\n\n<p>You can either:</p>\n\n<h2>Install bundler 1.x</h2>\n\n<pre><code>gem install bundler:1.17.3\n</code></pre>\n\n<p>If this does not work try deleting <code>Gemfile.lock</code> and doing <code>bundle install</code>.</p>\n\n<h2>Upgrade Gemfile.lock to use 2.x</h2>\n\n<pre><code>bundle update --bundler\n</code></pre>\n"}], "owner": {"reputation": 16672, "user_id": 22237, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/hkobD.png?s=128&g=1", "display_name": "Kris", "link": "https://stackoverflow.com/users/22237/kris"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5775, "favorite_count": 0, "accepted_answer_id": 57758679, "answer_count": 1, "score": 7, "last_activity_date": 1567527146, "creation_date": 1567434452, "last_edit_date": 1567434581, "question_id": 57758654, "link": "https://stackoverflow.com/questions/57758654/why-do-i-get-could-not-find-bundler-1-17-3-after-upgrading-ruby", "title": "Why do I get `Could not find &#39;bundler&#39; (1.17.3)` after upgrading Ruby?", "body": "<p>After upgrading from Ruby 2.3 to a newer version and then doing a <code>bundle install</code> I get the error <code>Could not find 'bundler'</code>.</p>\n\n<p>This happens even after doing <code>gem install bundler</code>.</p>\n"}, {"tags": ["ruby", "chef-infra"], "answers": [{"tags": [], "owner": {"reputation": 1376, "user_id": 427117, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c91d05b02cc6a43fadcbe417b66bceb4?s=128&d=identicon&r=PG", "display_name": "Roland", "link": "https://stackoverflow.com/users/427117/roland"}, "is_accepted": true, "score": 1, "last_activity_date": 1567431833, "creation_date": 1567431833, "answer_id": 57758025, "question_id": 57757513, "link": "https://stackoverflow.com/questions/57757513/chef-template-variables-syntax-error-unexpected-expecting-keyword-end/57758025#57758025", "title": "Chef template variables syntax error, unexpected &#39;}&#39;, expecting keyword_end", "body": "<p>I think the error is in your template file, e.g. <code>filebeat.yml.erb</code></p>\n\n<p>The reason for my assumption is based on <code>(erubis):74: syntax error, unexpected '}', expecting keyword_end</code> - erubis is a fast eRuby-compatible template engine (\"erb\") used by chef. So the error origins from parsing/rendering the template file, not a chef specific issue.</p>\n"}], "owner": {"reputation": 6584, "user_id": 1831520, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/QFRGt.jpg?s=128&g=1", "display_name": "sadaf2605", "link": "https://stackoverflow.com/users/1831520/sadaf2605"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 196, "favorite_count": 0, "accepted_answer_id": 57758025, "answer_count": 1, "score": 0, "last_activity_date": 1567431833, "creation_date": 1567429698, "last_edit_date": 1567431047, "question_id": 57757513, "link": "https://stackoverflow.com/questions/57757513/chef-template-variables-syntax-error-unexpected-expecting-keyword-end", "title": "Chef template variables syntax error, unexpected &#39;}&#39;, expecting keyword_end", "body": "<p>For my following recipe:</p>\n\n<pre><code>    template '/etc/filebeat/filebeat.yml' do\n      source 'filebeat.yml.erb'\n      owner 'root'\n      group 'root'\n      mode '0600'\n      variables(\n            stack_name: stack_name, \n            instance_ip: instance_ip\n            )\n    end\n</code></pre>\n\n<p>I am getting following error:</p>\n\n<pre><code>    Chef::Mixin::Template::TemplateError\n    ------------------------------------\n    (erubis):74: syntax error, unexpected '}', expecting keyword_end\n\n    Resource Declaration:\n    ---------------------\n    # In /var/chef/runs/8f9aa33c-6b69-419d-8a02-5668701a228a/local-mode-cache/cache/cookbooks/filebeat/recipes/filebeat.rb\n\n    28: template '/etc/filebeat/filebeat.yml' do\n    29:   source 'filebeat.yml.erb'\n    30:   owner 'root'\n    31:   group 'root'\n    32:   mode '0600'\n    33:   variables(\n    34:         stack_name: stack_name, \n    35:         instance_ip: instance_ip\n    36:         )\n    37: end\n    38: \n\n    Compiled Resource:\n    ------------------\n    # Declared in /var/chef/runs/44a77122-2816-4f89-97c4-9cbff0bbdfcb/local-mode-cache/cache/cookbooks/-filebeat/recipes/filebeat.rb:28:in `from_file'\n\n    template(\"/etc/filebeat/filebeat.yml\") do\n    action [:create]\n    retries 0\n    retry_delay 2\n    default_guard_interpreter :default\n    source \"filebeat.yml.erb\"\n    variables {:stack_name=&gt;\"fsdfsd\", :instance_ip=&gt;\"172.31.63.242\"}\n    declared_type :template\n    cookbook_name \"filebeat\"\n    recipe_name \"filebeat\"\n    owner \"root\"\n    group \"root\"\n    mode \"0600\"\n    path \"/etc/filebeat/filebeat.yml\"\n\nend\n</code></pre>\n\n<p>What am I doing wrong?</p>\n"}, {"tags": ["ruby", "cucumber"], "comments": [{"owner": {"reputation": 264, "user_id": 3124279, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64378a977307311f5255088d3b165dbf?s=128&d=identicon&r=PG&f=1", "display_name": "alwaysLearningABC", "link": "https://stackoverflow.com/users/3124279/alwayslearningabc"}, "edited": false, "score": 0, "creation_date": 1567789120, "post_id": 57756827, "comment_id": 102082109, "body": "I added an answer below with a fix for your code. The error you&#39;re actually seeing looks like it might not be code-related though. Maybe try what it says in this article? <a href=\"https://makandracards.com/makandra/43353-fix-rubygems-binary-error-undefined-method-activate_bin_path-for-gem-module-nomethoderror\" rel=\"nofollow noreferrer\">makandracards.com/makandra/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 264, "user_id": 3124279, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64378a977307311f5255088d3b165dbf?s=128&d=identicon&r=PG&f=1", "display_name": "alwaysLearningABC", "link": "https://stackoverflow.com/users/3124279/alwayslearningabc"}, "reply_to_user": {"reputation": 307, "user_id": 2775990, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/q0b2b.jpg?s=128&g=1", "display_name": "spectator", "link": "https://stackoverflow.com/users/2775990/spectator"}, "edited": false, "score": 0, "creation_date": 1567791401, "post_id": 57825945, "comment_id": 102083023, "body": "I am glad to hear it!"}], "tags": [], "owner": {"reputation": 264, "user_id": 3124279, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64378a977307311f5255088d3b165dbf?s=128&d=identicon&r=PG&f=1", "display_name": "alwaysLearningABC", "link": "https://stackoverflow.com/users/3124279/alwayslearningabc"}, "is_accepted": true, "score": 1, "last_activity_date": 1567788670, "creation_date": 1567788670, "answer_id": 57825945, "question_id": 57756827, "link": "https://stackoverflow.com/questions/57756827/cucumber-ruby-how-to-use-parametertype-to-transform-given-expression/57825945#57825945", "title": "Cucumber ruby how to use ParameterType to transform given expression?", "body": "<p>When I run your code I get this error:</p>\n\n<pre><code>  Scenario: Learn how to write transformations\n    When I print the date for today           \n      wrong number of arguments (given 1, expected 0) (ArgumentError)\n      ./features/support/parameter_types.rb:16:in `block in &lt;top (required)&gt;'\n      features/file.feature:15:in `When I print the date for today'\n</code></pre>\n\n<p>This indicates that the transformer needs to be a function. I got it to work by changing your <code>ParameterType</code> definition to:</p>\n\n<pre><code>ParameterType(\n    name: 'today',\n    regexp: /[\\w]+/,\n    transformer: -&gt;(str) {Date.today}\n)\n</code></pre>\n"}], "owner": {"reputation": 307, "user_id": 2775990, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/q0b2b.jpg?s=128&g=1", "display_name": "spectator", "link": "https://stackoverflow.com/users/2775990/spectator"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 223, "favorite_count": 0, "accepted_answer_id": 57825945, "answer_count": 1, "score": 1, "last_activity_date": 1567788670, "creation_date": 1567426695, "question_id": 57756827, "link": "https://stackoverflow.com/questions/57756827/cucumber-ruby-how-to-use-parametertype-to-transform-given-expression", "title": "Cucumber ruby how to use ParameterType to transform given expression?", "body": "<p>I am trying to use <code>ParameterType</code> as <code>Transform</code> was removed in cucumber from version 3.0 I have the below feature with the step definition and parameter type. Is there any problem in my <code>ParameterType</code> as it is throwing error as follows:</p>\n\n<p>Feature File:</p>\n\n<pre><code>Scenario: Learn how to write transformations\n    When I print the date for today\n</code></pre>\n\n<p>Step Definition</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>When('I print the date for {today}') do |today|\n  puts today\nend\n</code></pre>\n\n<p>Here is the <code>ParameterType</code> am using:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>ParameterType(\n  name: 'today',\n  regexp: /[\\w]+/,\n  transformer: Date.today\n)\n</code></pre>\n\n<p>Error am getting:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>When I print the date for date\nfeatures/wb_test.feature:11\nundefined method `map' for nil:NilClass (NoMethodError)\nc:\\jruby-9.2.7.0\\bin\\cucumber:23:in `\n'\nif Gem.respond_to?(:activate_bin_path)\nload Gem.activate_bin_path('cucumber', 'cucumber', version)\nelse\ngem \"cucumber\", version\n</code></pre>\n\n<p>Please let me know if am doing anything wrong in the above steps.</p>\n"}, {"tags": ["ruby", "liquid"], "answers": [{"tags": [], "owner": {"reputation": 149, "user_id": 5572949, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-OdzVnW9GUWk/AAAAAAAAAAI/AAAAAAAAAFY/O_2K5nFuNSs/photo.jpg?sz=128", "display_name": "B. Irena", "link": "https://stackoverflow.com/users/5572949/b-irena"}, "is_accepted": false, "score": 0, "last_activity_date": 1567683781, "creation_date": 1567683781, "answer_id": 57804742, "question_id": 57754598, "link": "https://stackoverflow.com/questions/57754598/count-items-in-array-with-liquid/57804742#57804742", "title": "Count items in array with Liquid", "body": "<p>Is it possible for you to combine it with JS?\nYou can pass the array to a JS function and do there ther rest.</p>\n"}], "owner": {"reputation": 779, "user_id": 1534504, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/cRD0g.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1534504/pablo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 317, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1567683781, "creation_date": 1567416935, "last_edit_date": 1567606405, "question_id": 57754598, "link": "https://stackoverflow.com/questions/57754598/count-items-in-array-with-liquid", "title": "Count items in array with Liquid", "body": "<p>I have a json object like the following:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>    \"results\"=&gt;{\n        \"data\"=&gt;[\n            {\n                \"id\"=&gt;\"letters\",\n                \"values\"=&gt;[\"A\", \"B\", \"B\", \"X\"]\n            },\n        ]\n    }\n</code></pre>\n\n<p>I am trying to count how many <code>A</code>'s and how many <code>B</code>'s and then add them.</p>\n\n<p>This is my code so far:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>require 'liquid'\nLiquid::Template.error_mode = :strict\n@template = Liquid::Template.parse('\n    {% assign letters = results.data | where: \"id\", \"letters\" %}\n    {{ letters }}\n    {% increment a_count %}\n    {% increment b_count %}\n    {% for letter in letters.values %}\n        {% if letter contains \"A\" %}\n            {% increment a_count %}\n        {% endif %}\n        {% if letter contains \"B\" %}\n            {% increment b_count %}\n        {% endif %}\n    {% else %}\n        The collection is empty.\n    {% endfor %}\n    {% assign count = a_count | plus: b_count %}\n    {{ a_count}} + {{ b_count }} = {{ count }}\n')\nprint(@template.render(\n    \"results\"=&gt; {\n        \"data\"=&gt; [\n            {\n                \"id\"=&gt; \"letters\",\n                \"values\"=&gt; [\"A\", \"B\", \"B\", \"X\"]\n            },\n        ]\n    }\n), { strict_variables: true })\nprint(@template.errors) \n\n</code></pre>\n\n<p>But this doesn't work and I get this output:</p>\n\n<pre><code>\n\n    {\"id\"=&gt;\"letters\", \"values\"=&gt;[\"A\", \"B\", \"B\", \"X\"]}\n    0\n    0\n\n        The collection is empty.\n\n\n    1 + 1 = 2\n</code></pre>\n\n<p>Which is confusing because <code>results.values</code> is not empty and I only call <code>increment</code> once for each <code>a_count</code> and <code>b_count</code> which should set the initial value to <code>0</code>.</p>\n\n<p>The output of <code>print(@template.errors)</code> is only:</p>\n\n<pre><code>{:strict_variables=&gt;true}[]\n</code></pre>\n\n<p>How do I count how many <code>A</code>'s and how many <code>B</code>'s are in the <code>letters.values</code> array?</p>\n"}, {"tags": ["ruby", "logstash"], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 11982656, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-SgBUBvCzKtM/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdJ-LXzEOLxD5p6bKoFi229OlOiUQ/photo.jpg?sz=128", "display_name": "Alisa Faingold", "link": "https://stackoverflow.com/users/11982656/alisa-faingold"}, "edited": false, "score": 2, "creation_date": 1567608586, "post_id": 57776233, "comment_id": 102015084, "body": "Thank you! using java-execution=false and pipeline.workers=1 elapsed filter as you suggest helped me to get the wanted result."}], "tags": [], "owner": {"reputation": 5122, "user_id": 1123206, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f2e6bbd4548aa3f2d748646da4bc073?s=128&d=identicon&r=PG", "display_name": "leandrojmp", "link": "https://stackoverflow.com/users/1123206/leandrojmp"}, "is_accepted": false, "score": 1, "last_activity_date": 1567531312, "creation_date": 1567531312, "answer_id": 57776233, "question_id": 57753835, "link": "https://stackoverflow.com/questions/57753835/logstash-calculate-duration-with-ruby-code/57776233#57776233", "title": "Logstash - Calculate duration with ruby code", "body": "<p>In Logstash the events are independent from each other, your <code>OFF</code> event wouldn't have any information about your <code>ON</code> event, to calculate the duration between two events you would need a common value present in both, for example an unique id for each pair of events.</p>\n\n<p>To do that using the ruby filter you would need to store the time of the <code>ON</code> event somewhere and query it for each <code>OFF</code> event that arrives in your logstash, you could store it in elasticsearch or another database that has a filter in pipeline.</p>\n\n<p>The easiest way to do that is using the elapsed filter, in both cases you would need to set your pipeline to use only 1 worker, depending on the time difference between your events, this would be the only way to make sure that your <code>OFF</code> event would not go through your pipeline before your <code>ON</code> event.</p>\n"}], "owner": {"reputation": 21, "user_id": 11982656, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-SgBUBvCzKtM/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdJ-LXzEOLxD5p6bKoFi229OlOiUQ/photo.jpg?sz=128", "display_name": "Alisa Faingold", "link": "https://stackoverflow.com/users/11982656/alisa-faingold"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 85, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1567531312, "creation_date": 1567413623, "last_edit_date": 1567421947, "question_id": 57753835, "link": "https://stackoverflow.com/questions/57753835/logstash-calculate-duration-with-ruby-code", "title": "Logstash - Calculate duration with ruby code", "body": "<p>After several attempts to work with the \"elapsed\" filter to calculate the duration between events, I try to do so using Ruby code.\nI can't quite figure out how I can get the time of a particular event based on its tag.</p>\n\n<p>For example, these are my events:</p>\n\n<p>05-07 13:20:48.808 1222 1236 D ShutdownThread: shutdown reason is: userrequested</p>\n\n<p>05-07 10:22:28.306 657 657 I boot_progress_start: 9977</p>\n\n<p>05-06 13:20:48.808 1222 1236 D ShutdownThread: shutdown reason is: userrequested</p>\n\n<p>05-06 10:22:28.306 657 657 I boot_progress_start: 9977</p>\n\n<p>05-05 13:20:48.808 1222 1236 D ShutdownThread: shutdown reason is: userrequested</p>\n\n<p>05-05 10:22:28.306 657 657 I boot_progress_start: 9977</p>\n\n<p>This is my code for now:</p>\n\n<pre><code>filter {\n    dissect {\n    mapping =&gt; {\n    \"message\" =&gt; \"%{[@metadata][timestamp]} %{+[@metadata][timestamp]} %{} %{} %{loglevel} %{msg}\"\n        }\n    }   \ndate{\n    match =&gt; [ \"[@metadata][timestamp]\", \"MM-dd HH:mm:ss.SSS\" ]\n}\n\n#device ON\nif \"boot_progress_start\" in [message] {\n    mutate {\n        add_tag =&gt; \"ON_event\" \n    }\n}\n\n#device OFF\nelse if \"shutdown reason is: userrequested\" in [message] {\n    mutate {\n        add_tag =&gt; \"OFF_event\" \n    }\n}\n</code></pre>\n\n<p>How my code in Ruby is supposed be if I want to calculate the time between \"ON\" and \"OFF\" events.</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["arrays", "ruby", "multidimensional-array", "hash"], "answers": [{"comments": [{"owner": {"reputation": 778, "user_id": 4229641, "user_type": "registered", "accept_rate": 36, "profile_image": "https://i.stack.imgur.com/VxtFd.jpg?s=128&g=1", "display_name": "vishnuprasanth", "link": "https://stackoverflow.com/users/4229641/vishnuprasanth"}, "edited": false, "score": 0, "creation_date": 1567420316, "post_id": 57753129, "comment_id": 101947182, "body": "Array#yield_self way was excellent. Also, if you don&#39;t mind, can you explain how your first method is better?"}, {"owner": {"reputation": 13442, "user_id": 3982562, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2a3c7aae1d762372cda697833c602ec8?s=128&d=identicon&r=PG", "display_name": "3limin4t0r", "link": "https://stackoverflow.com/users/3982562/3limin4t0r"}, "edited": false, "score": 1, "creation_date": 1567423090, "post_id": 57753129, "comment_id": 101948424, "body": "If you&#39;re using Ruby 2.6.0 or higher you can use <a href=\"https://ruby-doc.org/core-2.6.4/Object.html#method-i-then\" rel=\"nofollow noreferrer\"><code>#then</code></a> instead of <a href=\"https://ruby-doc.org/core-2.6.4/Object.html#method-i-yield_self\" rel=\"nofollow noreferrer\"><code>#yield_self</code></a> which is shorter and is more understandable imo."}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "reply_to_user": {"reputation": 778, "user_id": 4229641, "user_type": "registered", "accept_rate": 36, "profile_image": "https://i.stack.imgur.com/VxtFd.jpg?s=128&g=1", "display_name": "vishnuprasanth", "link": "https://stackoverflow.com/users/4229641/vishnuprasanth"}, "edited": false, "score": 0, "creation_date": 1567426679, "post_id": 57753129, "comment_id": 101950008, "body": "@vishnuprasanth both snippets are equivalent, I just find the first one easier to grasp."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "reply_to_user": {"reputation": 13442, "user_id": 3982562, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2a3c7aae1d762372cda697833c602ec8?s=128&d=identicon&r=PG", "display_name": "3limin4t0r", "link": "https://stackoverflow.com/users/3982562/3limin4t0r"}, "edited": false, "score": 1, "creation_date": 1567444457, "post_id": 57753129, "comment_id": 101957298, "body": "In case it&#39;s not clear, @3limin4t0r&#39;s is saying that <code>Object#then</code> was introduced as an alias of <code>Object#yield_self</code> in v2.6."}], "tags": [], "owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "is_accepted": true, "score": 6, "last_activity_date": 1567410557, "last_edit_date": 1567410557, "creation_date": 1567410233, "answer_id": 57753129, "question_id": 57752682, "link": "https://stackoverflow.com/questions/57752682/parse-2d-arrays-in-an-optimal-way/57753129#57753129", "title": "Parse 2d arrays in an optimal way", "body": "<p><code>zip</code> is the correct tool here, so your code is fine.</p>\n\n<p>I'd use Ruby's <a href=\"https://ruby-doc.org/core-2.6.3/doc/syntax/assignment_rdoc.html#label-Array+Decomposition\" rel=\"noreferrer\">array decomposition</a> feature to extract keys and values, and <code>to_h</code> instead of <code>Hash[]</code>:</p>\n\n<pre><code>keys, *values = input[:result]\nvalues.map { |v| keys.zip(v).to_h }\n</code></pre>\n\n<p>Or, if you prefer a \"one-liner\": (harder to understand IMO)</p>\n\n<pre><code>input[:result].yield_self { |k, *vs| vs.map { |v| k.zip(v).to_h } }\n</code></pre>\n"}], "owner": {"reputation": 778, "user_id": 4229641, "user_type": "registered", "accept_rate": 36, "profile_image": "https://i.stack.imgur.com/VxtFd.jpg?s=128&g=1", "display_name": "vishnuprasanth", "link": "https://stackoverflow.com/users/4229641/vishnuprasanth"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 83, "favorite_count": 0, "accepted_answer_id": 57753129, "answer_count": 1, "score": 4, "last_activity_date": 1567444963, "creation_date": 1567407958, "question_id": 57752682, "link": "https://stackoverflow.com/questions/57752682/parse-2d-arrays-in-an-optimal-way", "title": "Parse 2d arrays in an optimal way", "body": "<p>I need to parse the following hash of 2d arrays, where the first array has the keys and the rest of the arrays has the values.</p>\n\n<pre><code>input = {\n  \"result\": [\n    [\n      \"id\",\n      \"name\",\n      \"address\"\n    ],\n    [\n      \"1\",\n      \"Vishnu\",\n      \"abc\"\n    ],\n    [\n      \"2\",\n      \"Arun\",\n      \"def\"\n    ],\n    [\n      \"3\",\n      \"Arjun\",\n      \"ghi\"\n    ]\n  ]\n}\n</code></pre>\n\n<p>This is the result I came up with.</p>\n\n<pre><code>input[:result].drop(1).collect{|arr| Hash[input[:result].first.zip arr]}\n</code></pre>\n\n<p>Here I'm iterating through the <code>result</code> array ignoring its first sub array (the one that contains keys) then <code>zip</code> the key array and value array to make a hash afterwards I collect the hash to another array.</p>\n\n<p>The above solution gives me what I want which is a hash</p>\n\n<pre><code>[{\"id\"=&gt;\"1\", \"name\"=&gt;\"Vishnu\", \"address\"=&gt;\"abc\"}, {\"id\"=&gt;\"2\", \"name\"=&gt;\"Arun\", \"address\"=&gt;\"def\"}, {\"id\"=&gt;\"3\", \"name\"=&gt;\"Arjun\", \"address\"=&gt;\"ghi\"}]\n</code></pre>\n\n<p>Is there a better way to achieve the same result?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "routes"], "comments": [{"owner": {"reputation": 7359, "user_id": 599989, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/d752d2574aeb36bc66471f4d0f8811aa?s=128&d=identicon&r=PG", "display_name": "Bijendra", "link": "https://stackoverflow.com/users/599989/bijendra"}, "edited": false, "score": 0, "creation_date": 1567404383, "post_id": 57751987, "comment_id": 101940932, "body": "what is the version of Rails?"}, {"owner": {"reputation": 48413, "user_id": 1279683, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1veuT.jpg?s=128&g=1", "display_name": "Marek Lipka", "link": "https://stackoverflow.com/users/1279683/marek-lipka"}, "edited": false, "score": 1, "creation_date": 1567404475, "post_id": 57751987, "comment_id": 101940951, "body": "You don&#39;t have <code>requestuser</code> named route defined anywhere, so no wonder you get an error."}, {"owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 4, "creation_date": 1567406853, "post_id": 57751987, "comment_id": 101941679, "body": "You can use <code>rails routes</code> in the console if you are unsure what routes exist or how they are named."}, {"owner": {"reputation": 303, "user_id": 9479253, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cd34f4996365a59ad414df6950d6d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ashok Damaniya", "link": "https://stackoverflow.com/users/9479253/ashok-damaniya"}, "edited": false, "score": 0, "creation_date": 1567413252, "post_id": 57751987, "comment_id": 101944096, "body": "try this:- <b>match &#39;/request&#39;, to: &#39;users#requestuser&#39;, via: [:get, :post], as: :requestuser</b>, your code will work as it is without any change , just need to add <b>as: :requestuser</b> in your route."}], "answers": [{"comments": [{"owner": {"reputation": 47, "user_id": 11286717, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-OysRu6ppb0U/AAAAAAAAAAI/AAAAAAAAAAk/c8eR1BlDQ8s/photo.jpg?sz=128", "display_name": "Mr.Movies Tamil", "link": "https://stackoverflow.com/users/11286717/mr-movies-tamil"}, "edited": false, "score": 0, "creation_date": 1567425575, "post_id": 57752385, "comment_id": 101949479, "body": "Why it looks for request_path though i gave users#requestuser"}], "tags": [], "owner": {"reputation": 35, "user_id": 7753818, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F7fXe.jpg?s=128&g=1", "display_name": "Oluwasegun Adeleye", "link": "https://stackoverflow.com/users/7753818/oluwasegun-adeleye"}, "is_accepted": false, "score": 1, "last_activity_date": 1567406234, "creation_date": 1567406234, "answer_id": 57752385, "question_id": 57751987, "link": "https://stackoverflow.com/questions/57751987/undefined-method-or-local-variable-in-rails/57752385#57752385", "title": "Undefined method or local variable in rails", "body": "<p>The <code>requestuser_path</code> route helper method does not exist.</p>\n\n<p>Unless specified, route helper methods are autogenerated in Rails. To see a list of all these helpers and their corresponding controllers and actions, go to <a href=\"http://localhost:3000/rails/info/routes\" rel=\"nofollow noreferrer\">http://localhost:3000/rails/info/routes</a> assuming you are running your development Rails server on port 3000.</p>\n\n<p>In your case, the method you are looking for is <code>request_path</code>, not <code>requestuser_path</code></p>\n\n<p>To learn more about routes in Rails, the official documentation is a good resource. <a href=\"https://guides.rubyonrails.org/routing.html\" rel=\"nofollow noreferrer\">https://guides.rubyonrails.org/routing.html</a></p>\n"}, {"tags": [], "owner": {"reputation": 595, "user_id": 3632472, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4e431a79c8cf18fc5c29ebb94a721dda?s=128&d=identicon&r=PG&f=1", "display_name": "Rakesh", "link": "https://stackoverflow.com/users/3632472/rakesh"}, "is_accepted": false, "score": 0, "last_activity_date": 1567407512, "creation_date": 1567407512, "answer_id": 57752603, "question_id": 57751987, "link": "https://stackoverflow.com/questions/57751987/undefined-method-or-local-variable-in-rails/57752603#57752603", "title": "Undefined method or local variable in rails", "body": "<p>Try not to use ruby keyword as routes or any controller's or model's name. Ruby will throw error. Try to rename the routes \"match '/request', to: 'users#requestuser'\"</p>\n"}, {"tags": [], "owner": {"reputation": 862, "user_id": 1600046, "user_type": "registered", "accept_rate": 45, "profile_image": "https://i.stack.imgur.com/5rxUl.jpg?s=128&g=1", "display_name": "Vibol", "link": "https://stackoverflow.com/users/1600046/vibol"}, "is_accepted": false, "score": 0, "last_activity_date": 1567409198, "creation_date": 1567409198, "answer_id": 57752901, "question_id": 57751987, "link": "https://stackoverflow.com/questions/57751987/undefined-method-or-local-variable-in-rails/57752901#57752901", "title": "Undefined method or local variable in rails", "body": "<ol>\n<li><p>It's always a good practice to run <code>rails routes</code> or <code>rake routes</code> to see how rails generates your routes, in your case pleas use <code>request_path</code></p></li>\n<li><p>It's not recommended to use <code>match</code> and even considered invalid in newer rails version:</p></li>\n</ol>\n\n<blockquote>\n  <p>If you want to expose your action to both GET and POST, add <code>via: [:get, :post]</code> option.\n  If you want to expose your action to GET, use <code>get</code> in the router:\n    Instead of: match \"controller#action\"\n    Do: get \"controller#action\"</p>\n</blockquote>\n"}], "owner": {"reputation": 47, "user_id": 11286717, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-OysRu6ppb0U/AAAAAAAAAAI/AAAAAAAAAAk/c8eR1BlDQ8s/photo.jpg?sz=128", "display_name": "Mr.Movies Tamil", "link": "https://stackoverflow.com/users/11286717/mr-movies-tamil"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 110, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1567409198, "creation_date": 1567403538, "last_edit_date": 1567408337, "question_id": 57751987, "link": "https://stackoverflow.com/questions/57751987/undefined-method-or-local-variable-in-rails", "title": "Undefined method or local variable in rails", "body": "<pre><code>undefined local variable or method `requestuser_path' for #&lt;#&lt;Class:0x007f92de073e10&gt;:0x007f92e191a020&gt;\n</code></pre>\n\n<p>I don't know why this error occurs even though I route to the required controller and the view is also no problem here.</p>\n\n<pre><code># routes.rb\n\nresources :users do \n  member do\n    get :following, :followers\n  end\nend\n\nresources :sessions, only: [:new, :create, :destroy]\nresources :microposts, only: [:create, :destroy]\nresources :relationships, only: [:create, :destroy]\n#resources :requests, only: [:create]\n\nroot to: 'static_pages#home'\n\nmatch '/signup',  to: 'users#new'\nmatch '/signin',  to: 'sessions#new'    \nmatch '/signout', to: 'sessions#destroy', via: :delete\nmatch '/help',    to: 'static_pages#help'\nmatch '/about',   to: 'static_pages#about'\nmatch '/request', to: 'users#requestuser'\n</code></pre>\n\n<p>The named route:</p>\n\n<pre><code>&lt;% if signed_in? %&gt;\n  &lt;li&gt;&lt;%= link_to \"Requests\", requestuser_path %&gt;&lt;/li&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>UsersController:</p>\n\n<pre><code>def requestuser\n  @title = \"Requests\"\n  @user = User.find(params[:id])\n  @users = @user.followed_users.paginate(page: params[:page])\nend\n</code></pre>\n\n<p>I think there is an error in the named route as I am new to Rails. I don't know what is the cause of error. The named route is predefined or how does it work.</p>\n\n<p>I need to learn more topics on Rails can someone tell which is the best site to learn after beginner stage.</p>\n"}, {"tags": ["ruby", "ruby-on-rails-5", "wkhtmltopdf", "wicked-pdf"], "comments": [{"owner": {"reputation": 14827, "user_id": 645886, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2abb0123e9484284a9cb2d36aa9854b3?s=128&d=identicon&r=PG&f=1", "display_name": "Surya", "link": "https://stackoverflow.com/users/645886/surya"}, "edited": false, "score": 0, "creation_date": 1567414861, "post_id": 57751775, "comment_id": 101944796, "body": "It says command error, can you log-in/ssh to the machine/container with the same user as the process which executes this command and checks if you&#39;re able to run the command there?"}, {"owner": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "edited": false, "score": 0, "creation_date": 1567415370, "post_id": 57751775, "comment_id": 101945019, "body": "post full backtrace errors and code that invokes this in your question."}, {"owner": {"reputation": 17497, "user_id": 23915, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b5e935da7b67c03dd56f385b031f485c?s=128&d=identicon&r=PG", "display_name": "Unixmonkey", "link": "https://stackoverflow.com/users/23915/unixmonkey"}, "edited": false, "score": 0, "creation_date": 1572356777, "post_id": 57751775, "comment_id": 103528123, "body": "Have you installed <code>wkhtmltopdf</code> on this server? <code>wicked_pdf</code> requires <code>wkhtmltopdf</code> to be installed."}], "owner": {"reputation": 175, "user_id": 11844918, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8284e2c546dc5c918b8d40d8eba6ed09?s=128&d=identicon&r=PG&f=1", "display_name": "roshita", "link": "https://stackoverflow.com/users/11844918/roshita"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 144, "favorite_count": 0, "answer_count": 0, "score": 5, "last_activity_date": 1567401763, "creation_date": 1567401763, "question_id": 57751775, "link": "https://stackoverflow.com/questions/57751775/unable-to-generate-pdf-in-production-server-usng-wicked-pdf-gem", "title": "Unable to generate pdf in production server usng wicked pdf gem", "body": "<p>I am using wicked pdf to generate pdf. Its working fine in local server but on production mode i got into below errors:</p>\n\n<blockquote>\n  <p>Failed to execute: [\"/usr/local/bundle/bin/wkhtmltopdf\", \"-q\",\n  \"file:////tmp/wicked_pdf20190902-26-811syo.html\",\n  \"/tmp/wicked_pdf_generated_file20190902-26-1x3596l.pdf\"] Error: PDF\n  could not be generated! Command Error:</p>\n</blockquote>\n\n<p>I am running my application on an <strong>Alpine container</strong>.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "http", "net-http", "ruby-2.5"], "comments": [{"owner": {"reputation": 51, "user_id": 11981403, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-FKE41g1_Ucs/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdFRFqS7DU_7gJI66R52Giw0Fw_nA/photo.jpg?sz=128", "display_name": "Jamie", "link": "https://stackoverflow.com/users/11981403/jamie"}, "edited": false, "score": 0, "creation_date": 1567401587, "post_id": 57751736, "comment_id": 101940274, "body": "Now the error reads /Users/j/.rbenv/versions/2.5.3/lib/ruby/2.5.0/openssl/buffer&zwnj;&#8203;ing.rb:182:in `sysread_nonblock&#39;: Operation timed out (Errno::ETIMEDOUT)"}, {"owner": {"reputation": 14827, "user_id": 645886, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2abb0123e9484284a9cb2d36aa9854b3?s=128&d=identicon&r=PG&f=1", "display_name": "Surya", "link": "https://stackoverflow.com/users/645886/surya"}, "edited": false, "score": 1, "creation_date": 1567415206, "post_id": 57751736, "comment_id": 101944953, "body": "Probably it is taking more than a minute to respond? Try increasing the <code>read_timeout</code>(in seconds) for the call."}, {"owner": {"reputation": 51, "user_id": 11981403, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-FKE41g1_Ucs/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdFRFqS7DU_7gJI66R52Giw0Fw_nA/photo.jpg?sz=128", "display_name": "Jamie", "link": "https://stackoverflow.com/users/11981403/jamie"}, "reply_to_user": {"reputation": 14827, "user_id": 645886, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2abb0123e9484284a9cb2d36aa9854b3?s=128&d=identicon&r=PG&f=1", "display_name": "Surya", "link": "https://stackoverflow.com/users/645886/surya"}, "edited": false, "score": 0, "creation_date": 1567417814, "post_id": 57751736, "comment_id": 101946086, "body": "It really shouldn&#39;t take more than a minute because python3 takes less than 2 seconds to read. I&#39;ve tried increasing read_timeout to 100 and no luck"}], "answers": [{"comments": [{"owner": {"reputation": 51, "user_id": 11981403, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-FKE41g1_Ucs/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdFRFqS7DU_7gJI66R52Giw0Fw_nA/photo.jpg?sz=128", "display_name": "Jamie", "link": "https://stackoverflow.com/users/11981403/jamie"}, "edited": false, "score": 0, "creation_date": 1567488120, "post_id": 57763606, "comment_id": 101966262, "body": "I can get a response using net-http2 gem. Thank you! But another problem arises. I cannot select certain elements using Nokogiri. It seems like the respone is leaving out some information or something."}, {"owner": {"reputation": 51, "user_id": 11981403, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-FKE41g1_Ucs/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdFRFqS7DU_7gJI66R52Giw0Fw_nA/photo.jpg?sz=128", "display_name": "Jamie", "link": "https://stackoverflow.com/users/11981403/jamie"}, "edited": false, "score": 0, "creation_date": 1567488664, "post_id": 57763606, "comment_id": 101966394, "body": "<code>ruby url = &quot;https:&#47;&#47;coupang.com&#47;&quot; client = NetHttp2::Client.new(url) res = client.call :get, &#39;&#47;&#39;, headers: { &quot;User-Agent&quot; =&gt; &quot;Mozilla&#47;5.0 (Macintosh; Intel Mac OS X 10_14_6)&quot; } doc = Nokogiri::HTML(res.body) #returns emptry array doc.css(&quot;.recommendation-list&quot;) </code>"}, {"owner": {"reputation": 51, "user_id": 11981403, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-FKE41g1_Ucs/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdFRFqS7DU_7gJI66R52Giw0Fw_nA/photo.jpg?sz=128", "display_name": "Jamie", "link": "https://stackoverflow.com/users/11981403/jamie"}, "edited": false, "score": 0, "creation_date": 1567501439, "post_id": 57763606, "comment_id": 101971979, "body": "I think nokogiri is having trouble parsing javascript rendered part of html. Do you have any suggestion?"}, {"owner": {"reputation": 22836, "user_id": 152786, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/581hP.jpg?s=128&g=1", "display_name": "smathy", "link": "https://stackoverflow.com/users/152786/smathy"}, "reply_to_user": {"reputation": 51, "user_id": 11981403, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-FKE41g1_Ucs/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdFRFqS7DU_7gJI66R52Giw0Fw_nA/photo.jpg?sz=128", "display_name": "Jamie", "link": "https://stackoverflow.com/users/11981403/jamie"}, "edited": false, "score": 0, "creation_date": 1567625815, "post_id": 57763606, "comment_id": 102022730, "body": "If my answer resolved <i>this</i> problem then you should accept it as the answer, and then you should create a new question showing the new problem you&#39;re talking about."}], "tags": [], "owner": {"reputation": 22836, "user_id": 152786, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/581hP.jpg?s=128&g=1", "display_name": "smathy", "link": "https://stackoverflow.com/users/152786/smathy"}, "is_accepted": true, "score": 2, "last_activity_date": 1567468362, "creation_date": 1567468362, "answer_id": 57763606, "question_id": 57751736, "link": "https://stackoverflow.com/questions/57751736/timeout-error-when-making-get-request-on-specific-site-using-ruby-2-5-3/57763606#57763606", "title": "Timeout error when making get request on specific site using ruby 2.5.3", "body": "<p>They're using akamai, so first - they expect HTTP/2 (you'll need an http2 gem for that) and they have some fairly tight User-Agent sniffing.</p>\n\n<p>Here's an example that works using <a href=\"https://github.com/ostinelli/net-http2\" rel=\"nofollow noreferrer\">net-http2</a></p>\n\n<pre><code>client = NetHttp2::Client.new \"https://www.coupang.com/\"\nres = client.call :get, '/', headers: { \"User-Agent\" =&gt; \"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_14_6)\" }\nputs res.body if res.ok?\n</code></pre>\n"}], "owner": {"reputation": 51, "user_id": 11981403, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-FKE41g1_Ucs/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdFRFqS7DU_7gJI66R52Giw0Fw_nA/photo.jpg?sz=128", "display_name": "Jamie", "link": "https://stackoverflow.com/users/11981403/jamie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 294, "favorite_count": 0, "accepted_answer_id": 57763606, "answer_count": 1, "score": 4, "last_activity_date": 1567468362, "creation_date": 1567401420, "last_edit_date": 1567401725, "question_id": 57751736, "link": "https://stackoverflow.com/questions/57751736/timeout-error-when-making-get-request-on-specific-site-using-ruby-2-5-3", "title": "Timeout error when making get request on specific site using ruby 2.5.3", "body": "<p>Can anyone get a proper response from the site www.coupang.com?\nI keep making requests to \"<a href=\"https://www.coupang.com/\" rel=\"nofollow noreferrer\">https://www.coupang.com/</a>\" and I get an error  9 out of 10 times.(Sometimes it works! Surprisingly.)</p>\n\n<pre><code>Traceback (most recent call last):\n        14: from lib/add_sup/test.rb:7:in `&lt;main&gt;'\n        13: from /Users/j/.rbenv/versions/2.5.3/lib/ruby/2.5.0/net/http.rb:485:in `get_response'\n        12: from /Users/j/.rbenv/versions/2.5.3/lib/ruby/2.5.0/net/http.rb:609:in `start'\n        11: from /Users/j/.rbenv/versions/2.5.3/lib/ruby/2.5.0/net/http.rb:910:in `start'\n        10: from /Users/j/.rbenv/versions/2.5.3/lib/ruby/2.5.0/net/http.rb:487:in `block in get_response'\n         9: from /Users/j/.rbenv/versions/2.5.3/lib/ruby/2.5.0/net/http.rb:1365:in `request_get'\n         8: from /Users/j/.rbenv/versions/2.5.3/lib/ruby/2.5.0/net/http.rb:1464:in `request'\n         7: from /Users/j/.rbenv/versions/2.5.3/lib/ruby/2.5.0/net/http.rb:1491:in `transport_request'\n         6: from /Users/j/.rbenv/versions/2.5.3/lib/ruby/2.5.0/net/http.rb:1491:in `catch'\n         5: from /Users/j/.rbenv/versions/2.5.3/lib/ruby/2.5.0/net/http.rb:1494:in `block in transport_request'\n         4: from /Users/j/.rbenv/versions/2.5.3/lib/ruby/2.5.0/net/http/response.rb:29:in `read_new'\n         3: from /Users/j/.rbenv/versions/2.5.3/lib/ruby/2.5.0/net/http/response.rb:40:in `read_status_line'\n         2: from /Users/j/.rbenv/versions/2.5.3/lib/ruby/2.5.0/net/protocol.rb:167:in `readline'\n         1: from /Users/j/.rbenv/versions/2.5.3/lib/ruby/2.5.0/net/protocol.rb:157:in `readuntil'\n/Users/j/.rbenv/versions/2.5.3/lib/ruby/2.5.0/net/protocol.rb:181:in `rbuf_fill': Net::ReadTimeout (Net::ReadTimeout)\n</code></pre>\n\n<p>I have also tried making request using python3 and it works fine.\nI think there is something wrong with my ruby configuration or ruby itself.</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>require 'nokogiri'\nrequire 'open-uri'\nrequire 'net/http'\n\n\nuri = URI(\"https://www.coupang.com/\")\nres = Net::HTTP.get_response(uri)\nputs res.body if res.is_a?(Net::HTTPSuccess)\n</code></pre>\n\n<p>I would appreciate your kind thoughts on this matter. Thank you!</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "validation"], "answers": [{"comments": [{"owner": {"reputation": 77, "user_id": 11871896, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/cUszr.jpg?s=128&g=1", "display_name": "code prodigy", "link": "https://stackoverflow.com/users/11871896/code-prodigy"}, "edited": false, "score": 0, "creation_date": 1567405059, "post_id": 57751928, "comment_id": 101941108, "body": "helpful tip but it didn&#39;t seem to fix my problem"}, {"owner": {"reputation": 928, "user_id": 2724228, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uGNiO.jpg?s=128&g=1", "display_name": "Manoj Menon", "link": "https://stackoverflow.com/users/2724228/manoj-menon"}, "reply_to_user": {"reputation": 77, "user_id": 11871896, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/cUszr.jpg?s=128&g=1", "display_name": "code prodigy", "link": "https://stackoverflow.com/users/11871896/code-prodigy"}, "edited": false, "score": 0, "creation_date": 1567406187, "post_id": 57751928, "comment_id": 101941439, "body": "could you pls share what are the issues you facing now"}, {"owner": {"reputation": 77, "user_id": 11871896, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/cUszr.jpg?s=128&g=1", "display_name": "code prodigy", "link": "https://stackoverflow.com/users/11871896/code-prodigy"}, "edited": false, "score": 0, "creation_date": 1567406270, "post_id": 57751928, "comment_id": 101941470, "body": "I am not facing any errors just that when i try to validate a user email or password no error is shown @Manoj Menon"}, {"owner": {"reputation": 928, "user_id": 2724228, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uGNiO.jpg?s=128&g=1", "display_name": "Manoj Menon", "link": "https://stackoverflow.com/users/2724228/manoj-menon"}, "reply_to_user": {"reputation": 77, "user_id": 11871896, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/cUszr.jpg?s=128&g=1", "display_name": "code prodigy", "link": "https://stackoverflow.com/users/11871896/code-prodigy"}, "edited": false, "score": 0, "creation_date": 1567406436, "post_id": 57751928, "comment_id": 101941516, "body": "are you still using form_tag in views?"}, {"owner": {"reputation": 77, "user_id": 11871896, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/cUszr.jpg?s=128&g=1", "display_name": "code prodigy", "link": "https://stackoverflow.com/users/11871896/code-prodigy"}, "edited": false, "score": 0, "creation_date": 1567406515, "post_id": 57751928, "comment_id": 101941545, "body": "yes i am im change change my question to display it"}, {"owner": {"reputation": 928, "user_id": 2724228, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uGNiO.jpg?s=128&g=1", "display_name": "Manoj Menon", "link": "https://stackoverflow.com/users/2724228/manoj-menon"}, "reply_to_user": {"reputation": 77, "user_id": 11871896, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/cUszr.jpg?s=128&g=1", "display_name": "code prodigy", "link": "https://stackoverflow.com/users/11871896/code-prodigy"}, "edited": false, "score": 0, "creation_date": 1567406892, "post_id": 57751928, "comment_id": 101941697, "body": "pls add error messages display in view inside  form_for block                               &lt;% if @user.errors.any? %&gt;     &lt;% @user.errors.full_messages.each do |message| %&gt;       &lt;li&gt;&lt;%= message %&gt;&lt;/li&gt;     &lt;% end %&gt;   &lt;% end %&gt;"}, {"owner": {"reputation": 928, "user_id": 2724228, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uGNiO.jpg?s=128&g=1", "display_name": "Manoj Menon", "link": "https://stackoverflow.com/users/2724228/manoj-menon"}, "reply_to_user": {"reputation": 77, "user_id": 11871896, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/cUszr.jpg?s=128&g=1", "display_name": "code prodigy", "link": "https://stackoverflow.com/users/11871896/code-prodigy"}, "edited": false, "score": 0, "creation_date": 1567406939, "post_id": 57751928, "comment_id": 101941716, "body": "also pls share your rails application log in question when you submit the form."}, {"owner": {"reputation": 928, "user_id": 2724228, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uGNiO.jpg?s=128&g=1", "display_name": "Manoj Menon", "link": "https://stackoverflow.com/users/2724228/manoj-menon"}, "reply_to_user": {"reputation": 77, "user_id": 11871896, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/cUszr.jpg?s=128&g=1", "display_name": "code prodigy", "link": "https://stackoverflow.com/users/11871896/code-prodigy"}, "edited": false, "score": 0, "creation_date": 1567407107, "post_id": 57751928, "comment_id": 101941782, "body": "Let us <a href=\"https://chat.stackoverflow.com/rooms/198809/discussion-between-manoj-menon-and-code-prodigy\">continue this discussion in chat</a>."}], "tags": [], "owner": {"reputation": 928, "user_id": 2724228, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uGNiO.jpg?s=128&g=1", "display_name": "Manoj Menon", "link": "https://stackoverflow.com/users/2724228/manoj-menon"}, "is_accepted": true, "score": 1, "last_activity_date": 1567408125, "last_edit_date": 1567408125, "creation_date": 1567403064, "answer_id": 57751928, "question_id": 57751669, "link": "https://stackoverflow.com/questions/57751669/rails-validations-error-messages-not-working/57751928#57751928", "title": "rails validations error messages not working", "body": "<p>It seems like your html elements are not associated to User model please try to use form_for tag instead somewhat like below</p>\n\n<pre><code>&lt;%= form_for @user do |form| %&gt;\n  &lt;%= form.text_field :first_name %&gt;\n  &lt;%= form.text_field :last_name %&gt;\n  &lt;%= form.submit %&gt;\n&lt;%end%&gt;\n</code></pre>\n\n<p>Also please use <code>render :new</code> instead of <code>redirect_to root_path</code></p>\n"}, {"tags": [], "owner": {"reputation": 862, "user_id": 1600046, "user_type": "registered", "accept_rate": 45, "profile_image": "https://i.stack.imgur.com/5rxUl.jpg?s=128&g=1", "display_name": "Vibol", "link": "https://stackoverflow.com/users/1600046/vibol"}, "is_accepted": false, "score": 1, "last_activity_date": 1567408292, "last_edit_date": 1567408292, "creation_date": 1567407788, "answer_id": 57752648, "question_id": 57751669, "link": "https://stackoverflow.com/questions/57751669/rails-validations-error-messages-not-working/57752648#57752648", "title": "rails validations error messages not working", "body": "<p>You you need to update your <code>create</code> action to something like this:</p>\n\n<pre><code>def create\n  @user = User.new(password: params[:password], email: params[:email], firstname: params[:firstname], lastname: params[:lastname])\n\n  if @user.save\n    redirect_to user_path(@user)\n  else\n    render :new\n  end\nend\n</code></pre>\n\n<p>Why render <code>new</code> when it fail to save? Because we need to let know know that this form is not valid, and by rendering new with the <code>@user</code> object, you get access to <code>@user.errors</code> where you can do whatever you like (formally form will render a red border and error message next to input).</p>\n"}], "owner": {"reputation": 77, "user_id": 11871896, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/cUszr.jpg?s=128&g=1", "display_name": "code prodigy", "link": "https://stackoverflow.com/users/11871896/code-prodigy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 109, "favorite_count": 0, "accepted_answer_id": 57751928, "answer_count": 2, "score": 0, "last_activity_date": 1567408292, "creation_date": 1567400896, "last_edit_date": 1567406588, "question_id": 57751669, "link": "https://stackoverflow.com/questions/57751669/rails-validations-error-messages-not-working", "title": "rails validations error messages not working", "body": "<p>I am trying to make a login in and sign up page but when i try to validate the email and password no error messages pop up I though they are supposed to pop up the the condition isn't met.</p>\n\n<p>i have tried error messages through layouts view and helper but none work or are too confusing for me to understand.</p>\n\n<pre><code>class UsersController &lt; ApplicationController\n  def new \n    @user = User.new\n  end\n  def create\n    @user = User.create(password: params[:password], email: params[:email], firstname: params[:firstname], lastname: params[:lastname])\n    if @user.save\n        redirect_to user_path(@user)\n    else\n   redirect_to root_path\n    end\n  end\n  def show\n    @user = User.find(params[:id])\n  end\nend\n</code></pre>\n\n<p>This is my users controller</p>\n\n<p>This is my user model</p>\n\n<pre><code>class User &lt; ApplicationRecord\n        has_secure_password\n        validates :email, presence: true, uniqueness: true\n        validates :password, length: { minimum: 4 }\n        validates_format_of :email, :with =&gt; /\\A([^@\\s]+)@((?:[-a-z0-9]+\\.)+ \n [a-z]{2,})\\Z/i, :message =&gt; \"hollksd\"(just for testing)\n end\n</code></pre>\n\n<p>This is my new user view</p>\n\n<pre><code>  &lt;%= form_for @user do |form| %&gt;\n  &lt;p&gt; First name:&lt;%= form.text_field :firstname %&gt;&lt;/p&gt;\n  &lt;p&gt;Last name:&lt;%= form.text_field :lastname %&gt;&lt;/p&gt;\n    &lt;p&gt;Email:&lt;%= form.email_field :email %&gt;&lt;/p&gt;\n      &lt;p&gt;Create password:&lt;%= form.password_field :password %&gt;&lt;/p&gt;\n  &lt;%= form.submit %&gt;\n&lt;%end%&gt;\n</code></pre>\n\n<p>if anyone could help it would be appreciated!</p>\n"}, {"tags": ["ruby", "square-connect"], "answers": [{"tags": [], "owner": {"reputation": 11, "user_id": 12008171, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fad27a20f24dbf59486aba15c094af62?s=128&d=identicon&r=PG&f=1", "display_name": "rubyist_yasunao", "link": "https://stackoverflow.com/users/12008171/rubyist-yasunao"}, "is_accepted": false, "score": 0, "last_activity_date": 1567416502, "creation_date": 1567416502, "answer_id": 57754505, "question_id": 57751623, "link": "https://stackoverflow.com/questions/57751623/usage-of-squareconnectcustomersapi-search-customers-method/57754505#57754505", "title": "Usage of SquareConnect::CustomersApi.search_customers method", "body": "<p>According to API Documents,DataTypes:CustomerFilter,\nfields to be able to filter for SquareConnect::CustomersApi.search_customers are below, Now.</p>\n\n<ul>\n<li>creation_source</li>\n<li>created_at</li>\n<li>updated_at</li>\n</ul>\n\n<p>I think,this method's function is insufficient....</p>\n"}], "owner": {"reputation": 11, "user_id": 12008171, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fad27a20f24dbf59486aba15c094af62?s=128&d=identicon&r=PG&f=1", "display_name": "rubyist_yasunao", "link": "https://stackoverflow.com/users/12008171/rubyist-yasunao"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 48, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1567416965, "creation_date": 1567400495, "last_edit_date": 1567416965, "question_id": 57751623, "link": "https://stackoverflow.com/questions/57751623/usage-of-squareconnectcustomersapi-search-customers-method", "title": "Usage of SquareConnect::CustomersApi.search_customers method", "body": "<p>I want to search customers by name SquareConnect::CustomersApi.search_customers,but the response returned all customer profiles.</p>\n\n<p>The codes below are almost the same as codes of \"<a href=\"https://developer.squareup.com/docs/api/connect/v2/2018-09-18#endpoint-searchcustomers\" rel=\"nofollow noreferrer\">https://developer.squareup.com/docs/api/connect/v2/2018-09-18#endpoint-searchcustomers</a>\".</p>\n\n<pre><code>access_token=Constants::ACCESS_TOKEN\nSquareConnect.configure do |config|\n  config.access_token = access_token\nend\napi = SquareConnect::CustomersApi.new\napi.search_customers({\n  query: {\n    filter: {\n      family_name: {\n        values: [\"test\"],\n        rule: SquareConnect::CustomerInclusionExclusion::INCLUDE\n      }\n    }\n  }\n})\n</code></pre>\n\n<p>It there something wrong?</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "reply_to_user": {"reputation": 167912, "user_id": 240443, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/495d675e3bc42ed1dee469e2ce701f1b?s=128&d=identicon&r=PG", "display_name": "Amadan", "link": "https://stackoverflow.com/users/240443/amadan"}, "edited": false, "score": 2, "creation_date": 1567403977, "post_id": 57751190, "comment_id": 101940807, "body": "@Amadan oh, indeed. <code>h.min_by { |_, v| v.last }</code> of course, thanks!"}, {"owner": {"reputation": 41, "user_id": 9309020, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f0c583864acbbdca6f6f3a313e95860c?s=128&d=identicon&r=PG&f=1", "display_name": "Raj", "link": "https://stackoverflow.com/users/9309020/raj"}, "reply_to_user": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1567408757, "post_id": 57751190, "comment_id": 101942371, "body": "Hi, Thanks for your solution.  Somehow, this did not work properly for me. Maybe I did not put across my problem properly. Anyhow, thanks again"}, {"owner": {"reputation": 9663, "user_id": 5239030, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/76JEw.png?s=128&g=1", "display_name": "iGian", "link": "https://stackoverflow.com/users/5239030/igian"}, "reply_to_user": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1567428670, "post_id": 57751190, "comment_id": 101950929, "body": "Can you explain why the solution from @AlekseiMatiushkin does&#39;t work for you? You can use it as <code>h[h.min_by{|_,v| v.last}.first][0] = :whatever</code>, so <code>h #=&gt; {1=&gt;[0, 0, 6], 2=&gt;[:whatever, 0, 2], 3=&gt;[0, 0, 9], 4=&gt;[7, 1, 4]}</code>"}, {"owner": {"reputation": 16237, "user_id": 2166798, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/417356917295f5176d2a3e7c21d8f9e8?s=128&d=identicon&r=PG", "display_name": "pjs", "link": "https://stackoverflow.com/users/2166798/pjs"}, "edited": false, "score": 0, "creation_date": 1567459103, "post_id": 57751190, "comment_id": 101961384, "body": "Raj, it&#39;s unclear whether the answer you&#39;re seeking is <code>2</code> because that&#39;s the minimum of column 2 of all the values, <code>2</code> because that&#39;s the key for the hash entry that contains the minimum value in column 2 of all the values, or <code>h[2]</code> which is the value array which contains the minimum value in column 2 of all the values.  Could you please clarify by explicitly stating what the return value should be, using an example where there&#39;s no ambiguity between keys, values, and value indices?"}], "answers": [{"comments": [{"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 1, "creation_date": 1567400227, "post_id": 57751438, "comment_id": 101940004, "body": "This does not return the expected result (<code>h[2]</code> <i>array</i>) though."}, {"owner": {"reputation": 16237, "user_id": 2166798, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/417356917295f5176d2a3e7c21d8f9e8?s=128&d=identicon&r=PG", "display_name": "pjs", "link": "https://stackoverflow.com/users/2166798/pjs"}, "reply_to_user": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1567443335, "post_id": 57751438, "comment_id": 101956955, "body": "@AlekseiMatiushkin My reading of Raj&#39;s question was that 1) the array he was looking for was composed of the elements of column 2 from each hash value; and 2) he wanted only the <code>min</code> value at the end, the array was not intrinsically of interest.  If you want to preserve the array for some reason, assign it to a variable and then apply the <code>min</code>."}], "tags": [], "owner": {"reputation": 16237, "user_id": 2166798, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/417356917295f5176d2a3e7c21d8f9e8?s=128&d=identicon&r=PG", "display_name": "pjs", "link": "https://stackoverflow.com/users/2166798/pjs"}, "is_accepted": false, "score": 2, "last_activity_date": 1567399104, "last_edit_date": 1567399104, "creation_date": 1567398557, "answer_id": 57751438, "question_id": 57751190, "link": "https://stackoverflow.com/questions/57751190/how-to-access-min-of-hash-value2-in-ruby/57751438#57751438", "title": "how to access min of hash value[2] in ruby", "body": "<p><a href=\"https://ruby-doc.org/core-2.6.3/Enumerable.html#method-i-collect\" rel=\"nofollow noreferrer\"><code>collect</code></a> will iterate through any enumerable, such as a hash, to create an array containing the values specified by the block argument.  Since it yields an array, you can then apply <code>.min</code>:</p>\n\n<pre><code>h.collect { |_, value| value[2] }.min\n</code></pre>\n\n<p>The enumerator for a hash coughs up both the keys and the values, but since the keys aren't needed in your specification I've used an <code>_</code> placeholder.</p>\n\n<p>If there's any chance some of the values won't have a <code>[2]</code> index, you should change <code>.min</code> to <code>.compact.min</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1567404019, "post_id": 57751635, "comment_id": 101940823, "body": "<code>send</code>?! What for?"}, {"owner": {"reputation": 41, "user_id": 9309020, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f0c583864acbbdca6f6f3a313e95860c?s=128&d=identicon&r=PG&f=1", "display_name": "Raj", "link": "https://stackoverflow.com/users/9309020/raj"}, "edited": false, "score": 0, "creation_date": 1567408850, "post_id": 57751635, "comment_id": 101942395, "body": "Hi, Thanks for your solution.  I needed a single liner without having to write another method.  Anyhow, thanks again"}, {"owner": {"reputation": 303, "user_id": 9479253, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cd34f4996365a59ad414df6950d6d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ashok Damaniya", "link": "https://stackoverflow.com/users/9479253/ashok-damaniya"}, "edited": false, "score": 0, "creation_date": 1567412634, "post_id": 57751635, "comment_id": 101943872, "body": "then you can also convert this method to single line , i just made it separate because i more like modular and dynamic way then linear way, although you can define variable and make linear way also dynamic."}, {"owner": {"reputation": 303, "user_id": 9479253, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cd34f4996365a59ad414df6950d6d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ashok Damaniya", "link": "https://stackoverflow.com/users/9479253/ashok-damaniya"}, "edited": false, "score": 0, "creation_date": 1567412719, "post_id": 57751635, "comment_id": 101943901, "body": "<b>send</b> is the method in which you can pass method name  for calling method dynamically . in simple way <b>dynamic method calling</b>"}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1567428844, "post_id": 57751635, "comment_id": 101950992, "body": "I know what <code>send</code> does, thanks. It just looks weird here, because you might a) use <code>public_send</code> which is <i>always</i> preferred and b) you don\u2019t need to interpolate a parameter, <code>public_send(min_max)</code> would perfectly work."}, {"owner": {"reputation": 303, "user_id": 9479253, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cd34f4996365a59ad414df6950d6d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ashok Damaniya", "link": "https://stackoverflow.com/users/9479253/ashok-damaniya"}, "reply_to_user": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1567432573, "post_id": 57751635, "comment_id": 101952629, "body": "first point i didn&#39;t know so thanks for sharing it, and yes second one its works fine without interpolation. thanks @AlekseiMatiushkin"}], "tags": [], "owner": {"reputation": 303, "user_id": 9479253, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cd34f4996365a59ad414df6950d6d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ashok Damaniya", "link": "https://stackoverflow.com/users/9479253/ashok-damaniya"}, "is_accepted": false, "score": 1, "last_activity_date": 1567400557, "creation_date": 1567400557, "answer_id": 57751635, "question_id": 57751190, "link": "https://stackoverflow.com/questions/57751190/how-to-access-min-of-hash-value2-in-ruby/57751635#57751635", "title": "how to access min of hash value[2] in ruby", "body": "<p>well i am not an expert but i would choose dynamic solution like below </p>\n\n<pre><code>def fetch_value_of(hash, col, min_max)\n  hash.map{|_key, values| values[col]}.send(\"#{min_max}\")\nend \n</code></pre>\n\n<p>pass your hash , column for which you want to have mix/max value and which value you want , minimum or the maximum.</p>\n\n<p>for eg:</p>\n\n<pre><code>fetch_value_of(h, 2, 'max')\n</code></pre>\n"}], "owner": {"reputation": 41, "user_id": 9309020, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f0c583864acbbdca6f6f3a313e95860c?s=128&d=identicon&r=PG&f=1", "display_name": "Raj", "link": "https://stackoverflow.com/users/9309020/raj"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 239, "favorite_count": 0, "answer_count": 2, "score": 4, "last_activity_date": 1567408118, "creation_date": 1567395948, "last_edit_date": 1567408118, "question_id": 57751190, "link": "https://stackoverflow.com/questions/57751190/how-to-access-min-of-hash-value2-in-ruby", "title": "how to access min of hash value[2] in ruby", "body": "<p>How can I access the min or max of particular column of values in a Hash in Ruby</p>\n\n<p>I have a hash with array of values for key. I would like to get min or max value in a particular column of array values so that I can change the value of first column. Below is my code. Any suggestions?</p>\n\n<p><code>lru_c()</code>\nwhen I run this code, I am getting 0, i.e. the least of the values of third hash. what I need is least of the values of column 2 of the array values. i.e. <code>[6,2,9,4].min</code> . I want to access <code>h[2]</code> which has min value in the last column.</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>def lru_c()\n    h = Hash.new{|hsh,key| hsh[key] = [] }\n\n    h[1] = [0,0,6]\n    h[2] = [0,0,2]\n    h[3] = [0,0,9]\n    h[4] = [7,1,4]\n\n    puts h.values[2].min\nend\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "ajax", "rspec"], "comments": [{"owner": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "edited": false, "score": 0, "creation_date": 1567403574, "post_id": 57751047, "comment_id": 101940710, "body": "Are you using some kind of authentication in BranchesController?"}, {"owner": {"reputation": 11, "user_id": 7625897, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa3d5d404480ce0bcdebe552b768f04a?s=128&d=identicon&r=PG&f=1", "display_name": "Adrian Plantilla", "link": "https://stackoverflow.com/users/7625897/adrian-plantilla"}, "reply_to_user": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "edited": false, "score": 0, "creation_date": 1567404187, "post_id": 57751047, "comment_id": 101940872, "body": "@SebastianPalma are these authentications?   <code>load_and_authorize_resource   skip_authorize_resource only: [:branch_users]</code>"}, {"owner": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "edited": false, "score": 0, "creation_date": 1567404389, "post_id": 57751047, "comment_id": 101940935, "body": "Maybe, you can add the code that defines them to see if you can make them return what they need so you aren&#39;t redirected."}, {"owner": {"reputation": 11, "user_id": 7625897, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa3d5d404480ce0bcdebe552b768f04a?s=128&d=identicon&r=PG&f=1", "display_name": "Adrian Plantilla", "link": "https://stackoverflow.com/users/7625897/adrian-plantilla"}, "reply_to_user": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "edited": false, "score": 0, "creation_date": 1567404656, "post_id": 57751047, "comment_id": 101941000, "body": "Sorry I&#39;m not that knowledgable in rails. When you say add the code that defines them, do you mean adding the variables in get :index, params:{} so that it&#39;ll return those variables?"}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1567412711, "post_id": 57751047, "comment_id": 101943897, "body": "@AdrianPlantilla What we are saying is <i>we suspect</i> that your rails application requires users to be &quot;logged in&quot;. But your test is running as a &quot;logged out&quot; user. So either you need to change the controller, to allow &quot;logged out&quot; users to access the resource; <b>or</b> you need to change the test to &quot;log in&quot; the user before calling the endpoint."}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1567412831, "post_id": 57751047, "comment_id": 101943936, "body": "Is this correct? Is there come code (which you haven&#39;t shown us) that requires the user to be logged in/authorised? For example, are you using <code>devise</code>? Or <code>cancancan</code>? Or <code>pundit</code>? I suspect you&#39;re using <code>cancancan</code>, since your code contains: <code>def_delegators  ..., :current_user, :can?</code> -- which seems to imply you have the concept of a &quot;logged in&quot; user who <code>can?</code>/<code>cannot?</code> access a resource."}, {"owner": {"reputation": 11, "user_id": 7625897, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa3d5d404480ce0bcdebe552b768f04a?s=128&d=identicon&r=PG&f=1", "display_name": "Adrian Plantilla", "link": "https://stackoverflow.com/users/7625897/adrian-plantilla"}, "reply_to_user": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1567413319, "post_id": 57751047, "comment_id": 101944124, "body": "@TomLord I just checked the gemfile and it is using devise and cancancan. I&#39;m going to look into it and see if there is an authentication for logged in users. Although why would the tests pass if I downgrade ajax-datatables-rails to 0.3.1 and fail on a higher version? I&#39;m thinking that if there was an authorization, either versions would fail since it still couldnt access the resources"}, {"owner": {"reputation": 303, "user_id": 9479253, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cd34f4996365a59ad414df6950d6d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ashok Damaniya", "link": "https://stackoverflow.com/users/9479253/ashok-damaniya"}, "edited": false, "score": 0, "creation_date": 1567413905, "post_id": 57751047, "comment_id": 101944406, "body": "if there is any signin/ signup mechanism present , then you have to either authenticate your test request or bypass that mechanism  for test specs. good luck !"}, {"owner": {"reputation": 11, "user_id": 7625897, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa3d5d404480ce0bcdebe552b768f04a?s=128&d=identicon&r=PG&f=1", "display_name": "Adrian Plantilla", "link": "https://stackoverflow.com/users/7625897/adrian-plantilla"}, "edited": false, "score": 0, "creation_date": 1567415203, "post_id": 57751047, "comment_id": 101944950, "body": "I have added edited my question to add further information"}, {"owner": {"reputation": 1211, "user_id": 11264208, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zIG6Y.jpg?s=128&g=1", "display_name": "sabhari karthik", "link": "https://stackoverflow.com/users/11264208/sabhari-karthik"}, "edited": false, "score": 0, "creation_date": 1567495241, "post_id": 57751047, "comment_id": 101968892, "body": "@AdrianPlantilla, as Ashok said I doubt that this may be an authorization/authentication issue. Can you comment the authentication and authorization parts of your controller and run the spec? If that succeeds, you can then call login action and add header informations in your spec to simulate a logged in user. Good luck :)"}, {"owner": {"reputation": 11, "user_id": 7625897, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa3d5d404480ce0bcdebe552b768f04a?s=128&d=identicon&r=PG&f=1", "display_name": "Adrian Plantilla", "link": "https://stackoverflow.com/users/7625897/adrian-plantilla"}, "reply_to_user": {"reputation": 1211, "user_id": 11264208, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zIG6Y.jpg?s=128&g=1", "display_name": "sabhari karthik", "link": "https://stackoverflow.com/users/11264208/sabhari-karthik"}, "edited": false, "score": 0, "creation_date": 1567991402, "post_id": 57751047, "comment_id": 102120826, "body": "@sabharikarthik Hello sorry for the super late reply. I was sick for the past few days and was out cold. I have tried commenting out the authentication and authorization parts of the controller and have run the spec. It still shows the same error"}, {"owner": {"reputation": 1211, "user_id": 11264208, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zIG6Y.jpg?s=128&g=1", "display_name": "sabhari karthik", "link": "https://stackoverflow.com/users/11264208/sabhari-karthik"}, "edited": false, "score": 0, "creation_date": 1568084435, "post_id": 57751047, "comment_id": 102152671, "body": "ok. Just to make sure that the call from application and the spec are the same, is this the route which is called from application: &#39;server_name/resource_name?format=json&#39; (this is the route called from spec)? you can also use &#39;puts&#39; to print in server console to ensure both application and spec calls the same action."}], "owner": {"reputation": 11, "user_id": 7625897, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa3d5d404480ce0bcdebe552b768f04a?s=128&d=identicon&r=PG&f=1", "display_name": "Adrian Plantilla", "link": "https://stackoverflow.com/users/7625897/adrian-plantilla"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 266, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1567470942, "creation_date": 1567394065, "last_edit_date": 1567415440, "question_id": 57751047, "link": "https://stackoverflow.com/questions/57751047/rails-rspec-getindex-returns-html-instead-of-json", "title": "Rails rspec get:index returns html instead of json", "body": "<p>I'm working on rspec for a web application. I have an rspec test that calls get:index of the controller and returns a json which I then parse for my tests. Below is the rspec code</p>\n\n<p>branches_controller_spec.rb</p>\n\n<pre><code>describe \"GET #index\" do\nit \"returns the correct json response\" do\n  get :index, params: { format: 'json' }\n  json = JSON.parse(response.body)\n\n  expect(json['draw']).to eq(0)\n  expect(json['recordsTotal']).to eq(1)\n  expect(json['recordsFiltered']).to eq(1)\n  expect(json['data'].size).to eq(1)\nend\n</code></pre>\n\n<p>and this is the :index from the controller</p>\n\n<p>branches_controller.rb</p>\n\n<pre><code>def index\n  respond_to do |format|\n    format.html\n    format.json { render json: BranchesDatatable.new(view_context) }\n    binding.pry\n  end\nend\n</code></pre>\n\n<p>and this is the datatable</p>\n\n<pre><code>class BranchesDatatable &lt; AjaxDatatablesRails::Base\n  include ApplicationHelper\n  def_delegators :@view, :params, :h, :link_to, :current_user, :can?, :content_tag, :url_for, :I18n\n\n  def view_columns\n    @view_columns ||= {\n      name:        { source: 'Branch.name'},\n      email:       { source: 'Branch.email'},\n      location:    { source: 'Branch.location'},\n      branch_head: { source: 'Branch.branch_head'}\n    }\n  end\n\n  private\n\n  def data\n    records.map do |record|\n      {\n        index_checkbox: index_checkboxes(record),\n        name:           record.name,\n        email:          record.email,\n        location:       record.location,\n        branch_head:    record.branch_head,\n        basic_actions:  basic_actions_dropdown(record, record.name)\n      }\n    end\n  end\n\n  def get_raw_records\n    if params[:action].present? &amp;&amp; (params[:action] == 'archive')\n      Branch.all_inactive\n    else\n       Branch.all_active\n    end\n  end\nend\n</code></pre>\n\n<p>With this code, when I run the application, it works perfectly. But when I run the rspec, the test fails. Here is the error line</p>\n\n<pre><code>JSON::ParserError:\n784: unexpected token at '&lt;html&gt;&lt;body&gt;You are being &lt;a href=\"http://test.host/\"&gt;redirected&lt;/a&gt;.&lt;/body&gt;&lt;/html&gt;'\n</code></pre>\n\n<p>I have tried putting render_views inside the tests and also in rails_helper.rb but it still returns this error. I found a half solution that made the test pass. I downgraded the ajax-datatables-rails version from 0.4.0 to 0.3.1 and all the tests passed but upon running the app, the datatable throws an error</p>\n\n<pre><code>DataTables warning: table id=branches-table - Ajax error. For more information about this error, please see http://datatables.net/tn/7\n</code></pre>\n\n<p>I'm new to rails and rspec all together so I might have wrong syntax or formats. If possible, I would like to keep a more updated version of the ajax-datatables-rails gem</p>\n\n<p>Any kind of help would be appreciated. I will provide more information if necessary. </p>\n\n<p><strong>EDIT:</strong></p>\n\n<p>Upon checking, the rspec has the following code</p>\n\n<pre><code>RSpec.describe BranchesController, type: :controller do\n  before(:each) do\n    @branch = create(:branch)\n    @user = create(:admin, branch_id: @branch.id)\n    login_as(@user)\n  end\n</code></pre>\n\n<p>The test logs in before running the test so it has access. I tried testing both the behaviours of ajax-datatables-rails v0.3.1 and v0.4.0 and tried to look for where the error begins. I used binding.pry to check each action that was executed for both versions and discovered that upon running the line </p>\n\n<pre><code>render json: BranchesDatatable.new(view_context)\n</code></pre>\n\n<p>from branches_controller.rb, v0.3.1 returned the json that I want while v0.4.0 threw the error </p>\n\n<blockquote>\n  <p>NoMethodError: undefined method `to_unsafe_h' for nil:NilClass</p>\n</blockquote>\n\n<p>A couple of searches showed that the method 'to_unsafe_h' is a command under rails. Why would it be undefined? I feel like there's a line I'm missing or just some stupid mistake that I just cant find. Do I need to explicitly define 'to_unsafe_h\"? Is there something wrong with my code?</p>\n"}, {"tags": ["javascript", "ruby", "haml"], "answers": [{"comments": [{"owner": {"reputation": 607, "user_id": 2130145, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/fe1fb914161cc2f0edd40eee905b65a8?s=128&d=identicon&r=PG", "display_name": "John Wooten", "link": "https://stackoverflow.com/users/2130145/john-wooten"}, "edited": false, "score": 0, "creation_date": 1567437851, "post_id": 57751069, "comment_id": 101954975, "body": "Thanks, that was obvious after you explained it!  I tried that and it did the one time replacement.  How about how I would access the fill_ins() in javascript and then in javascript do the replacement?  Should I do a string tokenizer and look up each word in the fill_ins() hash somehow?"}], "tags": [], "owner": {"reputation": 167912, "user_id": 240443, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/495d675e3bc42ed1dee469e2ce701f1b?s=128&d=identicon&r=PG", "display_name": "Amadan", "link": "https://stackoverflow.com/users/240443/amadan"}, "is_accepted": true, "score": 1, "last_activity_date": 1567446413, "last_edit_date": 1567446413, "creation_date": 1567394460, "answer_id": 57751069, "question_id": 57750781, "link": "https://stackoverflow.com/questions/57750781/how-to-substitute-a-series-of-keys-into-a-string-being-displayed-using-javascrip/57751069#57751069", "title": "How to substitute a series of keys into a string being displayed using javascript?", "body": "<p>In <code>:javascript</code> block, you should be writing JavaScript, not Ruby.</p>\n\n<p><code>String#gsub</code> is a Ruby method.</p>\n\n<p><a href=\"https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String/replace\" rel=\"nofollow noreferrer\"><code>String.prototype.replace</code></a> is a JavaScript method.</p>\n\n<pre><code>var filled = data.replace(/%%first_name%%/g, 'Ralph');\n</code></pre>\n\n<p>EDIT: Forgot that <code>replace</code> with a string only replaces once. Use regular expression with global flag instead.</p>\n\n<p>Also: to pass the data from Ruby to JavaScript, use this pattern in your template:</p>\n\n<pre><code>&lt;script&gt;\n  const fillIns = &lt;%= fill_ins.to_json %&gt;;\n&lt;/script&gt;\n</code></pre>\n\n<p>Then you can either loop that array and run the <code>replace</code> method with each pair (not optimal) \u2014\u00a0or you can use a regular expression that picks up on the general pattern of the variable:</p>\n\n<pre><code>var filled = data.replace(/%%([^%]+)%%/g, (_, name) =&gt; fillIns[name]);\n</code></pre>\n"}], "owner": {"reputation": 607, "user_id": 2130145, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/fe1fb914161cc2f0edd40eee905b65a8?s=128&d=identicon&r=PG", "display_name": "John Wooten", "link": "https://stackoverflow.com/users/2130145/john-wooten"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 67, "favorite_count": 0, "accepted_answer_id": 57751069, "answer_count": 1, "score": 0, "last_activity_date": 1567446413, "creation_date": 1567390585, "question_id": 57750781, "link": "https://stackoverflow.com/questions/57750781/how-to-substitute-a-series-of-keys-into-a-string-being-displayed-using-javascrip", "title": "How to substitute a series of keys into a string being displayed using javascript?", "body": "<p>I have a set of templates that contain key phrases denoted by %%key%% (could use different delimiters if these are a problem).  In the code presented, the names of the templates are shown in a selector, and when selected, their values are presently being moved into a textarea for display.  Before they are displayed, I wish to go through the template and replace each key with the value associated with that key.  </p>\n\n<p>I have tried using template.gsub 'key' 'value', template.gsub! 'key' 'value', and even template['key'] = 'value', to no avail.  To eliminate other problems, I have tried using simple values for the 'value' and then displaying the result in an alert.  If I don't try the replacement, the alert shows the template.  If I try any of these attempts, I don't get the alert to show, indicating some kind of javascript error, I suppose.  I can't figure out what the error is.</p>\n\n<p>Here is a part of the application_helper.rb:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>  #----------------------------------------------------------------------------\n  def render_haml(haml, locals = {})\n    Haml::Engine.new(haml.strip_heredoc, format: :html5).render(self, locals)\n  end\n\n  #----------------------------------------------------------------------------\n  def create_template_selector\n    get_templates()\n    render_haml &lt;&lt;-HAML\n    %select{{name: \"msg\", id: \"template_selector\"}}\n      - @t_hash.each do |name,message|\n        %option{ :value =&gt; message }= name\n    HAML\n  end\n\n  #----------------------------------------------------------------------------\n  def get_templates()\n    templates = Template.all\n    @t_hash = Hash.new\n    templates.each do |t|\n      @t_hash[t.name] = t.message\n    end\n  end\n</code></pre>\n\n<p>and this is the view partial _text.html.haml, where the selector is embedded and its selection is presented when changed:</p>\n\n<pre><code>    = form_for(@comment, remote: true, html: {id: \"#{id_prefix}_new_comment\"}) do |f|\n      = hidden_field_tag \"comment[commentable_id]\", commentable.id, id: \"#{id_prefix}_comment_commentable_id\"\n      = hidden_field_tag \"comment[commentable_type]\", class_name.classify, id: \"#{id_prefix}_comment_commentable_type\"\n      %div\n        %h3 Select a Template\n        = create_template_selector\n        %div\n          = f.text_area :comment, id: \"#{id_prefix}_comment_comment\", name:\"text_msg\"\n          .buttons\n          = image_tag(\"loading.gif\", size: :thumb, class: \"spinner\", style: \"display: none;\")\n          = f.submit t(:add_note), id: \"#{id_prefix}_comment_submit\"\n          #{t :or}\n          = link_to(t(:cancel), '#', class: 'cancel')\n</code></pre>\n\n<pre><code>    :javascript\n      $(document).ready( function() {\n      $('#template_selector').change(function() {\n        var data= $('select').find('option:selected').val();\n        //\n        // Here is where I put alert(data) and it works\n        // but,\n        // var filled = data.gsub '%%first_name%%' 'Ralph'\n        // followed by alert(filled), shows no alert panel and no error\n        //\n        $(\"##{id_prefix}_comment_comment\").val(data);\n        });\n      }  );\n</code></pre>\n\n<pre><code> How can I create a set of fill_ins like:\n</code></pre>\n\n<pre class=\"lang-rb prettyprint-override\"><code>     def fill_ins()\n        @fillins = Hash.new\n        @fillins['%%first_name%%'] = 'Ralph'\n        @fillins['%%last_name%%'] = 'Jones'\n     ...\n     end\n</code></pre>\n\n<p>and create a function like:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>     def fill_in(template)\n        @fi = fill_ins()\n        @fi.each do 'fkey, fval'\n           template.gsub! fkey fval\n        end\n      end\n</code></pre>\n\n<p>and have it work?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-6"], "answers": [{"comments": [{"owner": {"reputation": 11394, "user_id": 794481, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/344337b6819f2f513fa80bb227be3c2d?s=128&d=identicon&r=PG", "display_name": "Tallboy", "link": "https://stackoverflow.com/users/794481/tallboy"}, "edited": false, "score": 0, "creation_date": 1567392303, "post_id": 57750882, "comment_id": 101938886, "body": "Do you have any suggestions for the naming scheme based on my actual class names? It&#39;s a bit confusing because that would mean that <code>OnlinePaymentCreator &lt; PaymentSplitter</code> and that seems bizarre... unless im misunderstanding (a <code>PaymentSplitter</code> has a specific purpose). Plus there may be multiple other things I want to hide as well."}, {"owner": {"reputation": 11166, "user_id": 847116, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/YLb4A.gif?s=128&g=1", "display_name": "jamesc", "link": "https://stackoverflow.com/users/847116/jamesc"}, "reply_to_user": {"reputation": 11394, "user_id": 794481, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/344337b6819f2f513fa80bb227be3c2d?s=128&d=identicon&r=PG", "display_name": "Tallboy", "link": "https://stackoverflow.com/users/794481/tallboy"}, "edited": false, "score": 0, "creation_date": 1567392521, "post_id": 57750882, "comment_id": 101938919, "body": "@Tallboy It seems fine to have both manual and online payment creator descend from a class called payment_creator rather than PaymentSplitter if that helps although I see no reason to not use PaymentSplitter as the name of the parent"}], "tags": [], "owner": {"reputation": 11166, "user_id": 847116, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/YLb4A.gif?s=128&g=1", "display_name": "jamesc", "link": "https://stackoverflow.com/users/847116/jamesc"}, "is_accepted": true, "score": 1, "last_activity_date": 1567413512, "last_edit_date": 1567413512, "creation_date": 1567391916, "answer_id": 57750882, "question_id": 57750682, "link": "https://stackoverflow.com/questions/57750682/private-service-object-methods-ruby-rails/57750882#57750882", "title": "Private service object methods (Ruby + Rails)", "body": "<p>Perhaps you are looking for inheritance and protected methods</p>\n\n<pre><code>class Foo &lt; ApplicationService\n  def public_method\n  end\n\n  protected\n    #everything after here is private to this class and its descendants\n    def some_method_to_be_shared_with_descendants\n      #I am only accessible from this class and from descendants of this class\n\n      ...\n    end\n\n  private\n    #Everything after here is private to this class only\n\n    def some_private_methods_that_are_only_accessible_from_this_class\n    end\n    ...\nend\n</code></pre>\n\n<p>Then descendant classes like so</p>\n\n<pre><code>class Bar &lt; Foo\n  def do_something\n    # can access protected methods from Foo class here as native methods\n    some_res = some_method_to_be_shared_here\n    # do something with some_res\n  end\nend\n</code></pre>\n\n<p>So you should descend your other 2 classes from PaymentSplitter and set the shared methods as protected</p>\n"}, {"tags": [], "owner": {"reputation": 3630, "user_id": 4799659, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153200714295120/picture?type=large", "display_name": "fylooi", "link": "https://stackoverflow.com/users/4799659/fylooi"}, "is_accepted": false, "score": 1, "last_activity_date": 1567416195, "creation_date": 1567416195, "answer_id": 57754435, "question_id": 57750682, "link": "https://stackoverflow.com/questions/57750682/private-service-object-methods-ruby-rails/57754435#57754435", "title": "Private service object methods (Ruby + Rails)", "body": "<p>Perhaps a private class contained in a module might work better, eg. </p>\n\n<pre><code>module PaymentSplitting\n  def self.included(klass)\n    raise 'Error' unless klass.in?([ManualPaymentCreator, OnlinePaymentCreator])\n  end\n\n  class PaymentSplitter\n  end\n  private_constant :PaymentSplitter\nend\n\n</code></pre>\n\n<p>This should allow you to freely reference <code>PaymentSplitter</code> in any class which includes <code>PaymentSplitting</code>, and you can only include <code>PaymentSplitting</code> in <code>ManualPaymentCreator</code> or <code>OnlinePaymentCreator</code>. Referencing <code>PaymentSplitting::PaymentSplitter</code> will throw a <code>NameError: private constant</code> exception.  </p>\n"}], "owner": {"reputation": 11394, "user_id": 794481, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/344337b6819f2f513fa80bb227be3c2d?s=128&d=identicon&r=PG", "display_name": "Tallboy", "link": "https://stackoverflow.com/users/794481/tallboy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 59, "favorite_count": 0, "accepted_answer_id": 57750882, "answer_count": 2, "score": 1, "last_activity_date": 1567416195, "creation_date": 1567389236, "last_edit_date": 1567391801, "question_id": 57750682, "link": "https://stackoverflow.com/questions/57750682/private-service-object-methods-ruby-rails", "title": "Private service object methods (Ruby + Rails)", "body": "<p>I have a <code>PaymentManager</code> service:</p>\n\n<pre><code>/payment_manager/\n  - online_payment_creator.rb\n  - manual_payment_creator.rb\n  - payment_splitter.rb\n</code></pre>\n\n<p>Code for 3 services:</p>\n\n<pre><code>module PaymentManager\n  class ManualPaymentCreator &lt; ApplicationService\n    def call\n      # do stuff in transaction\n      PaymentSplitter.call(a, b, c)\n    end\n  end\nend\n\nmodule PaymentManager\n  class OnlinePaymentCreator &lt; ApplicationService\n    # do stuff in transaction\n    PaymentSplitter.call(a2, b2, c2)\n  end\nend\n\nmodule PaymentManager\n  class PaymentSplitter &lt; ApplicationService\n    def call(x, y, z)\n      # do very dangerous stuff\n    end\n  end\nend\n</code></pre>\n\n<p>So, the <code>PaymentSplitter</code> essentially splits a payment across multiple invoices, and must be done <strong>only</strong> inside either of the other 2 services, but should never be called on its own (from a controller or in the console, etc).</p>\n\n<p>I normally would make a <code>private</code> method inside <code>ManualPaymentCreator</code> but because it's needed in BOTH services, I don't know how to do that, as I can't use a simple private instance method without duplication.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "error-handling"], "answers": [{"tags": [], "owner": {"reputation": 848, "user_id": 11249670, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f29532e75e13b5f3b631012229f22829?s=128&d=identicon&r=PG&f=1", "display_name": "reesaspieces", "link": "https://stackoverflow.com/users/11249670/reesaspieces"}, "is_accepted": true, "score": 1, "last_activity_date": 1567818768, "last_edit_date": 1567818768, "creation_date": 1567817608, "answer_id": 57829892, "question_id": 57750592, "link": "https://stackoverflow.com/questions/57750592/rails-config-exceptions-app-not-working-if-i-directly-hit-the-localhost3000-40/57829892#57829892", "title": "Rails config.exceptions_app not working if I directly hit the &#39;localhost:3000/404&#39; endpoint", "body": "<p>It was because I hadn't deleted the Rails default html files such as <code>public/404.html</code>. The app would route to these files if you directly hit the endpoints like <code>localhost:3000/404</code>. Now that I've deleted these files, all three endpoints return a <code>404</code> status with the desired json.</p>\n"}], "owner": {"reputation": 848, "user_id": 11249670, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f29532e75e13b5f3b631012229f22829?s=128&d=identicon&r=PG&f=1", "display_name": "reesaspieces", "link": "https://stackoverflow.com/users/11249670/reesaspieces"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 169, "favorite_count": 0, "accepted_answer_id": 57829892, "answer_count": 1, "score": 0, "last_activity_date": 1567818768, "creation_date": 1567387961, "question_id": 57750592, "link": "https://stackoverflow.com/questions/57750592/rails-config-exceptions-app-not-working-if-i-directly-hit-the-localhost3000-40", "title": "Rails config.exceptions_app not working if I directly hit the &#39;localhost:3000/404&#39; endpoint", "body": "<p>I am trying to configure the exceptions app in a Rails API to return custom JSONs for 404/422/500 instead of the default error screen. So far I have done like this:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code># application.rb\nconfig.exceptions_app = routes\n</code></pre>\n\n<pre class=\"lang-rb prettyprint-override\"><code># routes.rb\nget '/404', to: 'application#not_found'\nget '/422', to: 'application#unacceptable'\nget '/500', to: 'application#internal_error'\n</code></pre>\n\n<pre class=\"lang-rb prettyprint-override\"><code># application_controller.rb\ndef not_found\n  render json: { error: 'Not found' }, status: :not_found\nend\n# Likewise, implemented methods for 422 and 500\n</code></pre>\n\n<pre class=\"lang-rb prettyprint-override\"><code># development.rb\nconfig.consider_all_requests_local = false\n</code></pre>\n\n<p>When I test this in the dev server by sending a GET request to a non-existing endpoint, like <code>http://localhost:3000/nonexistingroute</code>, it correctly returns the JSON created in <code>application#not_found</code>.\nIn the console log, I see the error being handled with <code>ActionController::RoutingError (No route matches [GET] \"/nonexistingroute\")</code>.</p>\n\n<p>However, if I try to test the routes\u00a0directly like <code>GET http://localhost:3000/404</code>, it returns a 200 status with the original Rails error screen saying <code>\"The page you were looking for doesn't exist. ... If you are the application owner check the logs for more information.\"</code></p>\n\n<p>Since I see nothing in the console log, I imagine that it's not hitting my route at all. Am I missing something? Is some additional setup necessary to get the exceptions app to work?</p>\n\n<p>I have referred to these questions but none of them answered mine:\n<a href=\"https://stackoverflow.com/q/45805920/11249670\">config.exceptions_app not working in rails</a>\n<a href=\"https://stackoverflow.com/q/16108286/11249670\">Disable all html exception rendering in rails</a></p>\n\n<p>Thank you in advance!</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 4600, "user_id": 5961578, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/df7cbfdd2a92a7926af3bbb8648318aa?s=128&d=identicon&r=PG", "display_name": "moveson", "link": "https://stackoverflow.com/users/5961578/moveson"}, "edited": false, "score": 0, "creation_date": 1567386573, "post_id": 57750350, "comment_id": 101938163, "body": "What have you tried? What does your User model look like?"}, {"owner": {"reputation": 65, "user_id": 11536405, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/v16j8.jpg?s=128&g=1", "display_name": "seddka", "link": "https://stackoverflow.com/users/11536405/seddka"}, "reply_to_user": {"reputation": 4600, "user_id": 5961578, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/df7cbfdd2a92a7926af3bbb8648318aa?s=128&d=identicon&r=PG", "display_name": "moveson", "link": "https://stackoverflow.com/users/5961578/moveson"}, "edited": false, "score": 0, "creation_date": 1567417509, "post_id": 57750350, "comment_id": 101945949, "body": "@moveson i have included my model to my question"}], "answers": [{"comments": [{"owner": {"reputation": 65, "user_id": 11536405, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/v16j8.jpg?s=128&g=1", "display_name": "seddka", "link": "https://stackoverflow.com/users/11536405/seddka"}, "edited": false, "score": 0, "creation_date": 1567417364, "post_id": 57750646, "comment_id": 101945889, "body": "I have updated my question and included my nested model to devise users model. i got this error <code>undefined local variable or method </code>dob&#39; for #&lt;UserInformation:0x00007feccd3a0d60&gt;`"}, {"owner": {"reputation": 11166, "user_id": 847116, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/YLb4A.gif?s=128&g=1", "display_name": "jamesc", "link": "https://stackoverflow.com/users/847116/jamesc"}, "reply_to_user": {"reputation": 65, "user_id": 11536405, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/v16j8.jpg?s=128&g=1", "display_name": "seddka", "link": "https://stackoverflow.com/users/11536405/seddka"}, "edited": false, "score": 0, "creation_date": 1567453452, "post_id": 57750646, "comment_id": 101959974, "body": "@seddka You have supplied no code at all related to your new error. I can&#39;t help with no information"}, {"owner": {"reputation": 11166, "user_id": 847116, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/YLb4A.gif?s=128&g=1", "display_name": "jamesc", "link": "https://stackoverflow.com/users/847116/jamesc"}, "reply_to_user": {"reputation": 65, "user_id": 11536405, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/v16j8.jpg?s=128&g=1", "display_name": "seddka", "link": "https://stackoverflow.com/users/11536405/seddka"}, "edited": false, "score": 0, "creation_date": 1567475006, "post_id": 57750646, "comment_id": 101963977, "body": "@seddka where did you define dob?"}, {"owner": {"reputation": 65, "user_id": 11536405, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/v16j8.jpg?s=128&g=1", "display_name": "seddka", "link": "https://stackoverflow.com/users/11536405/seddka"}, "edited": false, "score": 0, "creation_date": 1567521997, "post_id": 57750646, "comment_id": 101983279, "body": "i got it working, i&#39;ll post an answer about it . thank you for your help, appreciate it !"}], "tags": [], "owner": {"reputation": 11166, "user_id": 847116, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/YLb4A.gif?s=128&g=1", "display_name": "jamesc", "link": "https://stackoverflow.com/users/847116/jamesc"}, "is_accepted": false, "score": 1, "last_activity_date": 1567388764, "creation_date": 1567388764, "answer_id": 57750646, "question_id": 57750350, "link": "https://stackoverflow.com/questions/57750350/calculate-and-display-user-age-in-the-view/57750646#57750646", "title": "Calculate and display user age in the view", "body": "<p>Put the method in your model as a property (instance function rather than class function ) then in your form just pop the result into the page. You have shown no code whatsoever so I can not give you a code example to fix your problem but something like this maybe</p>\n\n<pre><code>class Person ...\n  ...\n\n  def calculated_age\n    now = Time.now.utc.to_date\n    now.year - dob.year - ((now.month &gt; dob.month || (now.month == dob.month &amp;&amp; now.day &gt;= dob.day)) ? 0 : 1)\n  end\n</code></pre>\n\n<p>Then in your view</p>\n\n<pre><code>&lt;%= @person.calculated_age #Or whatever your instance variable name is %&gt;\n</code></pre>\n\n<p>You might also want to add a check that dob is not null and set an appropriate default in the model</p>\n\n<p>This is exactly what models are for. Views should just render the information they are given\nShow more code next time and help people to help you.</p>\n"}, {"tags": [], "owner": {"reputation": 65, "user_id": 11536405, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/v16j8.jpg?s=128&g=1", "display_name": "seddka", "link": "https://stackoverflow.com/users/11536405/seddka"}, "is_accepted": false, "score": 0, "last_activity_date": 1567522497, "creation_date": 1567522497, "answer_id": 57774211, "question_id": 57750350, "link": "https://stackoverflow.com/questions/57750350/calculate-and-display-user-age-in-the-view/57774211#57774211", "title": "Calculate and display user age in the view", "body": "<p>before i tried @jamesc solution:  </p>\n\n<pre><code>def calculated_age\n    now = Time.now.utc.to_date\n    now.year - dob.year - ((now.month &gt; dob.month || (now.month == dob.month &amp;&amp; now.day &gt;= dob.day)) ? 0 : 1)\n  end\n</code></pre>\n\n<p>but i got an error saying :</p>\n\n<p><code>undefined local variable or method dob' for #&lt;UserInformation:0x00007feccd3a0d60&gt;</code></p>\n\n<p>That's because dob was not defined in the calculated method .</p>\n\n<p>This is the solution i came up with :</p>\n\n<pre><code>def age\n    now = Time.current\n    dob = self.born_in\n    now.year - dob.year - ((now.month &gt; dob.month || (now.month == dob.month &amp;&amp; now.day &gt;= dob.day)) ? 0 : 1)\n  end\n</code></pre>\n\n<p>And in Users profile <code>show.html.erb</code> all i had to do is :</p>\n\n<pre><code>&lt;%= @user.user_information.age %&gt;\n</code></pre>\n"}], "owner": {"reputation": 65, "user_id": 11536405, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/v16j8.jpg?s=128&g=1", "display_name": "seddka", "link": "https://stackoverflow.com/users/11536405/seddka"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 108, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1567522497, "creation_date": 1567383769, "last_edit_date": 1567417173, "question_id": 57750350, "link": "https://stackoverflow.com/questions/57750350/calculate-and-display-user-age-in-the-view", "title": "Calculate and display user age in the view", "body": "<p>I have a <code>date_field :born_in</code> for age and i want to display the calculated user age in user profile instead of the regular date format <code>mm/dd/yyyy</code></p>\n\n<p>I found a <a href=\"https://stackoverflow.com/a/2357790/11536405\">method</a> in this answer on how to calculate user's age but i don't know how to implement it in my rails app.</p>\n\n<p><strong>user_information.rb</strong></p>\n\n<pre><code>class UserInformation &lt; ApplicationRecord\n  belongs_to :user\n\n  has_one :gender, :dependent =&gt; :destroy\n  accepts_nested_attributes_for :gender, :allow_destroy =&gt; true\n\n  has_one :relationship, :dependent =&gt; :destroy\n  accepts_nested_attributes_for :relationship, :allow_destroy =&gt; true\nend\n</code></pre>\n\n<p><strong>show.html.erb</strong></p>\n\n<pre><code>&lt;%= @user.user_information.try(:born_in) %&gt;\n</code></pre>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 16237, "user_id": 2166798, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/417356917295f5176d2a3e7c21d8f9e8?s=128&d=identicon&r=PG", "display_name": "pjs", "link": "https://stackoverflow.com/users/2166798/pjs"}, "edited": false, "score": 0, "creation_date": 1567375688, "post_id": 57749797, "comment_id": 101936924, "body": "Homework?  What have you tried?  Is this supposed to handle negative numbers as well?"}, {"owner": {"reputation": 14827, "user_id": 645886, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2abb0123e9484284a9cb2d36aa9854b3?s=128&d=identicon&r=PG&f=1", "display_name": "Surya", "link": "https://stackoverflow.com/users/645886/surya"}, "edited": false, "score": 0, "creation_date": 1567375736, "post_id": 57749797, "comment_id": 101936934, "body": "<code>Math.sqrt(num).round</code>"}, {"owner": {"reputation": 16237, "user_id": 2166798, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/417356917295f5176d2a3e7c21d8f9e8?s=128&d=identicon&r=PG", "display_name": "pjs", "link": "https://stackoverflow.com/users/2166798/pjs"}, "reply_to_user": {"reputation": 14827, "user_id": 645886, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2abb0123e9484284a9cb2d36aa9854b3?s=128&d=identicon&r=PG&f=1", "display_name": "Surya", "link": "https://stackoverflow.com/users/645886/surya"}, "edited": false, "score": 0, "creation_date": 1567375833, "post_id": 57749797, "comment_id": 101936947, "body": "@Surya <code>round</code> doesn&#39;t necessarily go down, and that won&#39;t yield a result which is an integer squared."}, {"owner": {"reputation": 14827, "user_id": 645886, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2abb0123e9484284a9cb2d36aa9854b3?s=128&d=identicon&r=PG&f=1", "display_name": "Surya", "link": "https://stackoverflow.com/users/645886/surya"}, "reply_to_user": {"reputation": 16237, "user_id": 2166798, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/417356917295f5176d2a3e7c21d8f9e8?s=128&d=identicon&r=PG", "display_name": "pjs", "link": "https://stackoverflow.com/users/2166798/pjs"}, "edited": false, "score": 0, "creation_date": 1567375889, "post_id": 57749797, "comment_id": 101936958, "body": "@pjs - It doesn&#39;t have to go down, the question asks for nearest number hence round works."}, {"owner": {"reputation": 16237, "user_id": 2166798, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/417356917295f5176d2a3e7c21d8f9e8?s=128&d=identicon&r=PG", "display_name": "pjs", "link": "https://stackoverflow.com/users/2166798/pjs"}, "reply_to_user": {"reputation": 14827, "user_id": 645886, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2abb0123e9484284a9cb2d36aa9854b3?s=128&d=identicon&r=PG&f=1", "display_name": "Surya", "link": "https://stackoverflow.com/users/645886/surya"}, "edited": false, "score": 0, "creation_date": 1567375924, "post_id": 57749797, "comment_id": 101936961, "body": "@surya &quot;round <b>down</b> to the nearest square number&quot;."}, {"owner": {"reputation": 14827, "user_id": 645886, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2abb0123e9484284a9cb2d36aa9854b3?s=128&d=identicon&r=PG&f=1", "display_name": "Surya", "link": "https://stackoverflow.com/users/645886/surya"}, "reply_to_user": {"reputation": 16237, "user_id": 2166798, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/417356917295f5176d2a3e7c21d8f9e8?s=128&d=identicon&r=PG", "display_name": "pjs", "link": "https://stackoverflow.com/users/2166798/pjs"}, "edited": false, "score": 0, "creation_date": 1567375982, "post_id": 57749797, "comment_id": 101936970, "body": "@pjs - I would like the OP to build their answer on the hint. :)"}, {"owner": {"reputation": 16237, "user_id": 2166798, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/417356917295f5176d2a3e7c21d8f9e8?s=128&d=identicon&r=PG", "display_name": "pjs", "link": "https://stackoverflow.com/users/2166798/pjs"}, "edited": false, "score": 1, "creation_date": 1567376290, "post_id": 57749797, "comment_id": 101937012, "body": "@Josh You&#39;re on the right track.  Take Surya&#39;s hint, your knowledge, and square the result.  Please note that around here you&#39;re expected to show what you&#39;ve tried."}], "answers": [{"comments": [{"owner": {"reputation": 16237, "user_id": 2166798, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/417356917295f5176d2a3e7c21d8f9e8?s=128&d=identicon&r=PG", "display_name": "pjs", "link": "https://stackoverflow.com/users/2166798/pjs"}, "edited": false, "score": 2, "creation_date": 1567378062, "post_id": 57749935, "comment_id": 101937241, "body": "No need for the <code>.to_s.split</code> and conversion back, <code>Integer.sqrt</code> yields an integer..."}, {"owner": {"reputation": 342, "user_id": 10527012, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-9M_lulC3I5c/AAAAAAAAAAI/AAAAAAAAAAc/y7Vd30gaAbA/photo.jpg?sz=128", "display_name": "Pedro Paiva", "link": "https://stackoverflow.com/users/10527012/pedro-paiva"}, "reply_to_user": {"reputation": 16237, "user_id": 2166798, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/417356917295f5176d2a3e7c21d8f9e8?s=128&d=identicon&r=PG", "display_name": "pjs", "link": "https://stackoverflow.com/users/2166798/pjs"}, "edited": false, "score": 0, "creation_date": 1567378759, "post_id": 57749935, "comment_id": 101937331, "body": "True! Thank you!"}], "tags": [], "owner": {"reputation": 342, "user_id": 10527012, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-9M_lulC3I5c/AAAAAAAAAAI/AAAAAAAAAAc/y7Vd30gaAbA/photo.jpg?sz=128", "display_name": "Pedro Paiva", "link": "https://stackoverflow.com/users/10527012/pedro-paiva"}, "is_accepted": true, "score": 2, "last_activity_date": 1567468824, "last_edit_date": 1567468824, "creation_date": 1567377303, "answer_id": 57749935, "question_id": 57749797, "link": "https://stackoverflow.com/questions/57749797/ruby-round-down-to-nearest-square-number/57749935#57749935", "title": "Ruby: Round Down to Nearest Square Number", "body": "<p>Josh, maybe the code below can help you. You can put that in a ruby file and then run in the terminal. It will ask for a value and will return the answer.</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>class Integer\n  def down\n    Integer.sqrt(self) ** 2\n  end\nend\n\nprint \"Enter a valid number: \"\na = gets.to_i\nputs a.down\n</code></pre>\n\n<p>Updated thanks to <a href=\"https://stackoverflow.com/users/2166798/pjs\">pjs</a> and <a href=\"https://stackoverflow.com/users/256970/cary-swoveland\">Cary Swoveland</a>.</p>\n"}], "owner": {"reputation": 19, "user_id": 12007500, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mD62dz3WeycKWMg6AAfIXblFx-D5Ngw45LVTv__iQ=k-s128", "display_name": "Josh", "link": "https://stackoverflow.com/users/12007500/josh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 108, "favorite_count": 0, "accepted_answer_id": 57749935, "answer_count": 1, "score": -1, "last_activity_date": 1567468824, "creation_date": 1567375440, "last_edit_date": 1567376336, "question_id": 57749797, "link": "https://stackoverflow.com/questions/57749797/ruby-round-down-to-nearest-square-number", "title": "Ruby: Round Down to Nearest Square Number", "body": "<p>I want to create a class that makes the number round <strong><em>down</em></strong> to the nearest square number( 1, 4, 9, 16, 25...).</p>\n\n<p>I've tried some other code suggestions but I haven't found anything helpful. I don't know mostly how to get it to the nearest square</p>\n\n<pre><code>class Integer\n  def down\n    #round down to nearest square using self\n  end\nend\n\n(27).down #=&gt; 25\n</code></pre>\n"}, {"tags": ["ruby", "yaml", "travis-ci"], "comments": [{"owner": {"reputation": 1603, "user_id": 4111480, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/efe2b8fc71222d6b38cf9f0e866a9878?s=128&d=identicon&r=PG&f=1", "display_name": "Yorkshireman", "link": "https://stackoverflow.com/users/4111480/yorkshireman"}, "edited": false, "score": 0, "creation_date": 1567371931, "post_id": 57749405, "comment_id": 101936351, "body": "PS I&#39;ve also tried <code>- psql -c &#39;create database authentication-server_test;&#39; -U postgres</code>"}], "answers": [{"comments": [{"owner": {"reputation": 1603, "user_id": 4111480, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/efe2b8fc71222d6b38cf9f0e866a9878?s=128&d=identicon&r=PG&f=1", "display_name": "Yorkshireman", "link": "https://stackoverflow.com/users/4111480/yorkshireman"}, "edited": false, "score": 0, "creation_date": 1567374672, "post_id": 57749671, "comment_id": 101936788, "body": "Thanks man! Was banging my head against a wall for a while on this one. I&#39;ve seen the double-quotes problem in postgres before but I thought Travis was throwing due to yaml syntax rather than postgres throwing a problem. I&#39;ve verified your first solution works. Just verifying the second one. Probably won&#39;t bother with the third one because a cursory google didn&#39;t reveal <code>createdb</code> in the travis docs. Maybe you have a link?"}, {"owner": {"reputation": 1603, "user_id": 4111480, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/efe2b8fc71222d6b38cf9f0e866a9878?s=128&d=identicon&r=PG&f=1", "display_name": "Yorkshireman", "link": "https://stackoverflow.com/users/4111480/yorkshireman"}, "edited": false, "score": 1, "creation_date": 1567374761, "post_id": 57749671, "comment_id": 101936806, "body": "Yes, second one works, too. I&#39;ve gone with that one because it&#39;s neater. Thanks!"}, {"owner": {"reputation": 394580, "user_id": 479863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ArUCE.jpg?s=128&g=1", "display_name": "mu is too short", "link": "https://stackoverflow.com/users/479863/mu-is-too-short"}, "reply_to_user": {"reputation": 1603, "user_id": 4111480, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/efe2b8fc71222d6b38cf9f0e866a9878?s=128&d=identicon&r=PG&f=1", "display_name": "Yorkshireman", "link": "https://stackoverflow.com/users/4111480/yorkshireman"}, "edited": false, "score": 0, "creation_date": 1567382188, "post_id": 57749671, "comment_id": 101937732, "body": "<code>createdb</code> is a standard PostgreSQL command: <a href=\"https://www.postgresql.org/docs/current/app-createdb.html\" rel=\"nofollow noreferrer\">postgresql.org/docs/current/app-createdb.html</a>. The <code>psql -c</code> approach is weird because you have three different things that want to use double quotes (YAML, shell, PostgreSQL), at least the <code>createdb</code> one only has two (YAML, shell) and neither needs quotes."}], "tags": [], "owner": {"reputation": 394580, "user_id": 479863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ArUCE.jpg?s=128&g=1", "display_name": "mu is too short", "link": "https://stackoverflow.com/users/479863/mu-is-too-short"}, "is_accepted": true, "score": 1, "last_activity_date": 1567373792, "creation_date": 1567373792, "answer_id": 57749671, "question_id": 57749405, "link": "https://stackoverflow.com/questions/57749405/escaping-hyphen-in-yaml-key-value-for-travis-ci/57749671#57749671", "title": "Escaping hyphen in yaml key value for Travis CI", "body": "<p>Your problem is that this PostgreSQL identifier:</p>\n\n<pre><code>authentication-server_test\n</code></pre>\n\n<p>needs to be quoted so that PostgreSQL won't try to interpret the <code>-</code> as an operator. Identifiers are quoted with double quotes so you need to this:</p>\n\n<pre><code>\"authentication-server_test\"\n</code></pre>\n\n<p>into the database. You could escape the double quotes in the YAML:</p>\n\n<pre><code>before_script:\n  - bundle exec rake lint\n  - \"psql -c 'create database \\\"authentication-server_test\\\";' -U postgres\"\n</code></pre>\n\n<p>or drop the outer double quotes (the YAML quotes for the string) while adding the inner double quotes (for the PostgreSQL identifier):</p>\n\n<pre><code>before_script:\n  - bundle exec rake lint\n  - psql -c 'create database \"authentication-server_test\";' -U postgres\n</code></pre>\n\n<p>or switch to <code>createdb</code> about avoid the problem altogether:</p>\n\n<pre><code>before_script:\n  - bundle exec rake lint\n  - createdb authentication-server_test -U postgres\n</code></pre>\n\n<p>by only having to worry about the shell's and YAML's quoting needs (neither of which apply here).</p>\n"}], "owner": {"reputation": 1603, "user_id": 4111480, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/efe2b8fc71222d6b38cf9f0e866a9878?s=128&d=identicon&r=PG&f=1", "display_name": "Yorkshireman", "link": "https://stackoverflow.com/users/4111480/yorkshireman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 236, "favorite_count": 0, "accepted_answer_id": 57749671, "answer_count": 1, "score": 1, "last_activity_date": 1567373807, "creation_date": 1567370837, "last_edit_date": 1567373807, "question_id": 57749405, "link": "https://stackoverflow.com/questions/57749405/escaping-hyphen-in-yaml-key-value-for-travis-ci", "title": "Escaping hyphen in yaml key value for Travis CI", "body": "<p>Trying to create the test database in the Travis CI build using the <code>before_script</code> command as specified here: <a href=\"https://docs.travis-ci.com/user/database-setup/#using-postgresql-in-your-builds\" rel=\"nofollow noreferrer\">https://docs.travis-ci.com/user/database-setup/#using-postgresql-in-your-builds</a></p>\n\n<pre><code># .travis.yml\n\nbefore_script:\n  - bundle exec rake lint\n  - \"psql -c 'create database authentication-server_test;' -U postgres\"\n\nlanguage: ruby\n\nservices:\n  - postgresql\n</code></pre>\n\n<p>Travis throws with:</p>\n\n<pre><code>$ psql -c 'create database authentication-server_test;' -U postgres\nERROR:  syntax error at or near \"-\"\nLINE 1: create database authentication-server_test;\n</code></pre>\n\n<p>I've done a fair bit of googling and having trouble working out how to escape that hyphen. The sticking point seems to be that I have to wrap the <code>create database authentication-server_test;</code> in quotes. Note that the example in the Travis docs has no hyphens.</p>\n\n<p>Any ideas?</p>\n"}, {"tags": ["ruby", "callback", "signals", "interrupt"], "answers": [{"comments": [{"owner": {"reputation": 8580, "user_id": 17772, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/620ed2c3129f0c0887efbc5a54d6125c?s=128&d=identicon&r=PG", "display_name": "Ron Klein", "link": "https://stackoverflow.com/users/17772/ron-klein"}, "edited": false, "score": 0, "creation_date": 1567370972, "post_id": 57749169, "comment_id": 101936157, "body": "Thanks for the detailed answer. From the documentation: trap returns the previous handler for the given signal. Interesting."}, {"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "reply_to_user": {"reputation": 8580, "user_id": 17772, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/620ed2c3129f0c0887efbc5a54d6125c?s=128&d=identicon&r=PG", "display_name": "Ron Klein", "link": "https://stackoverflow.com/users/17772/ron-klein"}, "edited": false, "score": 0, "creation_date": 1567402670, "post_id": 57749169, "comment_id": 101940482, "body": "Oops, I missed that! Nice find."}], "tags": [], "owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "is_accepted": false, "score": 2, "last_activity_date": 1567402658, "last_edit_date": 1567402658, "creation_date": 1567368835, "answer_id": 57749169, "question_id": 57748992, "link": "https://stackoverflow.com/questions/57748992/is-it-possible-to-have-multiple-traps-for-a-signal/57749169#57749169", "title": "Is it possible to have multiple traps for a signal", "body": "<blockquote>\n  <p>It seems that only the last signal trap to be declared is the one which would be executed. </p>\n  \n  <p>Is this behavior by design? </p>\n</blockquote>\n\n<p>It is not very explicit in <a href=\"https://ruby-doc.org/core/Signal.html#method-c-trap\" rel=\"nofollow noreferrer\">the documentation of <code>Signal::trap</code></a>, but it is by design:</p>\n\n<blockquote>\n  <p>The command or block specifies code to be run when the signal is raised.</p>\n</blockquote>\n\n<p>Note the use of the singular, and the absence of any mention of something like \"The command or block is added to the list of trap handlers to be run when the signal is raised.\"</p>\n\n<p>It becomes clearer if you look at the <a href=\"http://pubs.opengroup.org/onlinepubs/9699919799/utilities/V3_chap02.html#trap\" rel=\"nofollow noreferrer\">POSIX <code>trap</code> shell builtin</a> after which <code>Signal::trap</code> is modeled:</p>\n\n<blockquote>\n  <p>The action of <code>trap</code> shall override a previous action (either default action or one explicitly set).</p>\n</blockquote>\n\n<p>The <a href=\"http://pubs.opengroup.org/onlinepubs/9699919799/functions/sigaction.html\" rel=\"nofollow noreferrer\">POSIX <code>sigaction</code> function</a> which is the C equivalent to <code>trap</code> says more or less the same thing. Note, however, that the <code>sigaction</code> function also gives a way of retrieving the function pointer to the old action, so <em>theoretically</em>, you could set the action to a function pointer to a new action which uses the function pointer to the old action to call the old action as part of itself, thus in some way chaining the actions.</p>\n\n<p>Note, however, that this would require the old and new action cooperate in some way. Also note that this mode of operation is not modeled by POSIX <code>trap</code>.</p>\n\n<blockquote>\n  <p>If not, how can we have multiple handlers executed to the same signal?</p>\n</blockquote>\n\n<p>From the documentation:</p>\n\n<blockquote>\n  <p>trap returns the previous handler for the given signal.</p>\n</blockquote>\n\n<p>So, <code>Signal::trap</code> implements the behavior from <code>sigaction</code> that gives you access to the \"old\" handler. You could save that old handler somewhere and chain the calls by explicitly calling it from your new handler.</p>\n\n<p>Like with <code>sigaction</code>, this requires some form of cooperation between the handlers.</p>\n"}, {"comments": [{"owner": {"reputation": 17747, "user_id": 241142, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/dc690e6057d0756358e2d80409a945b1?s=128&d=identicon&r=PG", "display_name": "iconoclast", "link": "https://stackoverflow.com/users/241142/iconoclast"}, "edited": false, "score": 0, "creation_date": 1574013211, "post_id": 57749753, "comment_id": 104069686, "body": "Did you intend for the <code>$prev_trap = </code> to be placed before the first <code>Signal.trap</code> statement? If not, I don&#39;t see how this can work."}, {"owner": {"reputation": 8580, "user_id": 17772, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/620ed2c3129f0c0887efbc5a54d6125c?s=128&d=identicon&r=PG", "display_name": "Ron Klein", "link": "https://stackoverflow.com/users/17772/ron-klein"}, "reply_to_user": {"reputation": 17747, "user_id": 241142, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/dc690e6057d0756358e2d80409a945b1?s=128&d=identicon&r=PG", "display_name": "iconoclast", "link": "https://stackoverflow.com/users/241142/iconoclast"}, "edited": false, "score": 0, "creation_date": 1574018112, "post_id": 57749753, "comment_id": 104071203, "body": "@iconoclast , the answer demonstrates the code, as is."}], "tags": [], "owner": {"reputation": 8580, "user_id": 17772, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/620ed2c3129f0c0887efbc5a54d6125c?s=128&d=identicon&r=PG", "display_name": "Ron Klein", "link": "https://stackoverflow.com/users/17772/ron-klein"}, "is_accepted": true, "score": 2, "last_activity_date": 1574018138, "last_edit_date": 1574018138, "creation_date": 1567374948, "answer_id": 57749753, "question_id": 57748992, "link": "https://stackoverflow.com/questions/57748992/is-it-possible-to-have-multiple-traps-for-a-signal/57749753#57749753", "title": "Is it possible to have multiple traps for a signal", "body": "<p>Combining the <a href=\"https://stackoverflow.com/a/57749169/17772\">answer</a> from <a href=\"https://stackoverflow.com/users/2988/j%C3%B6rg-w-mittag\">J\u00f6rg W Mittag</a> and the documentation, here's a simplified solution:</p>\n\n<pre><code># file traps.rb\n\nshould_stop = false\n\nSignal.trap('INT') do\n  puts 'int --&gt; A'\n  should_stop = true\nend\n\n$prev_trap = Signal.trap('INT') do\n  puts 'int --&gt; B'\n  should_stop = true\n  $prev_trap&amp;.call\nend\n\ntimes = 0\nuntil should_stop\n  puts 'waiting to stop'\n  sleep 1\n  times += 1\n  break if times &gt;= 5\nend\n\nputs 'done'\n</code></pre>\n\n<p>After running <code>ruby traps.rb</code>, and pressing <kbd>CTRL</kbd>+<kbd>C</kbd> after 3 seconds, the output looks like this:</p>\n\n<pre>\nwaiting to stop\nwaiting to stop\nwaiting to stop\n^Cint --> B\nint --> A\ndone\n</pre>\n"}], "owner": {"reputation": 8580, "user_id": 17772, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/620ed2c3129f0c0887efbc5a54d6125c?s=128&d=identicon&r=PG", "display_name": "Ron Klein", "link": "https://stackoverflow.com/users/17772/ron-klein"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 314, "favorite_count": 0, "accepted_answer_id": 57749753, "answer_count": 2, "score": 1, "last_activity_date": 1574018138, "creation_date": 1567367360, "last_edit_date": 1574012641, "question_id": 57748992, "link": "https://stackoverflow.com/questions/57748992/is-it-possible-to-have-multiple-traps-for-a-signal", "title": "Is it possible to have multiple traps for a signal", "body": "<p>I'm trying to understand Ruby's <code>trap</code>s for standard signals.</p>\n\n<p>In specific, I'm trying to have multiple signal handlers (\"traps\") for the same signal. It seems impossible. Here's a super simplified code to demonstrate the problem:</p>\n\n<p>file <code>traps.rb</code>:</p>\n\n<pre><code>should_stop = false\n\nSignal.trap 'INT' do\n  # won't be executed :(\n  puts 'int --&gt; A'\n  should_stop = true\nend\n\nSignal.trap 'INT' do\n  # will be executed\n  puts 'int --&gt; B'\n  should_stop = true\nend\n\ntimes = 0\nuntil should_stop\n  puts 'waiting to stop'\n  sleep 1\n  times += 1\n  break if times &gt;= 5\nend\n\nputs 'done'\n</code></pre>\n\n<p>Run the code:</p>\n\n<pre><code>ruby traps.rb\n</code></pre>\n\n<p>Output without pressing <kbd>CTRL</kbd>+<kbd>C</kbd>:</p>\n\n<pre>waiting to stop\nwaiting to stop\nwaiting to stop\nwaiting to stop\nwaiting to stop\ndone\n</pre>\n\n<p>Output with pressing <kbd>CTRL</kbd>+<kbd>C</kbd> after 2 seconds:</p>\n\n<pre>\nwaiting to stop\nwaiting to stop\n^Cint --> B\ndone\n</pre>\n\n<p>It seems that only the last signal trap to be declared is the one which would be executed. </p>\n\n<p>Is this behavior by design? </p>\n\n<p>If not, how can we have multiple handlers executed to the same signal?</p>\n\n<p>The main reason for asking this is that third party libraries might add their trap to a signal.</p>\n\n<p>If we have two different third party libraries that add their trap to the same signal, only one of them would actually be executed. That's where the fun begins :(</p>\n"}, {"tags": ["ruby", "homebrew"], "comments": [{"owner": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "edited": false, "score": 0, "creation_date": 1567356303, "post_id": 57747318, "comment_id": 101933071, "body": "what does repo have to do with with your code? how is any of this relevant to homebrew?"}, {"owner": {"reputation": 625, "user_id": 3788614, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/dbfc36762173d5e003effadd30cef320?s=128&d=identicon&r=PG&f=1", "display_name": "Jack", "link": "https://stackoverflow.com/users/3788614/jack"}, "reply_to_user": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "edited": false, "score": 0, "creation_date": 1567358697, "post_id": 57747318, "comment_id": 101933577, "body": "@lacostenycoder because I&#39;d like to push this project to Homebrew where I can run <code>%</code> (and not <code>percent</code>) in bash and get that result."}, {"owner": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "edited": false, "score": 0, "creation_date": 1567377239, "post_id": 57747318, "comment_id": 101937143, "body": "There is still nothing specific to homebrew here. Is this for your use only?  But why can&#39;t you just use <code>alias %=&#39;percent&#39;</code> ?"}, {"owner": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "edited": false, "score": 0, "creation_date": 1567377614, "post_id": 57747318, "comment_id": 101937192, "body": "also in ruby <code>2 * 2 == 4</code> that is multiplication not percentage"}], "answers": [{"tags": [], "owner": {"reputation": 14471, "user_id": 735926, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/6b5fa39f5bc4b397eb7e55766eecd8c4?s=128&d=identicon&r=PG", "display_name": "bfontaine", "link": "https://stackoverflow.com/users/735926/bfontaine"}, "is_accepted": true, "score": 2, "last_activity_date": 1567515103, "last_edit_date": 1567515103, "creation_date": 1567412677, "answer_id": 57753626, "question_id": 57747318, "link": "https://stackoverflow.com/questions/57747318/naming-brew-command-to-special-character/57753626#57753626", "title": "Naming brew command to special character", "body": "<p>Assuming you pushed your code to <code>https://github.com/Jack/homebrew-percent</code> and tagged it <code>0.1.0</code>, you can create a formula like so:</p>\n\n<pre><code># percent.rb\nclass Percent &lt; Formula\n  homepage \"https://github.com/Jack/homebrew-percent\"\n  url \"https://github.com/Jack/homebrew-percent/archive/0.1.0.tar.gz\"\n\n  def install\n    bin.install \"percent.rb\" =&gt; \"%\"\n  end\nend\n</code></pre>\n\n<p>Note: I wrote a very minimalist formula here; you may want to check Homebrew\u2019s docs regarding <a href=\"https://github.com/Homebrew/brew/blob/master/docs/Formula-Cookbook.md\" rel=\"nofollow noreferrer\">how write a formula</a> and <a href=\"https://docs.brew.sh/How-to-Create-and-Maintain-a-Tap\" rel=\"nofollow noreferrer\">host it in your own repo</a>.</p>\n\n<p>Then, run <code>brew install ./percent.rb</code>. You now have a <code>%</code> executable in your path.\n<strong>However</strong> it <em>won\u2019t</em> work if you use Bash, as <code>%</code> is already recognized as a command (equivalent to <code>fg</code>).</p>\n\n<p>You may want to use a different alias, such as e.g. <code>p</code>. You can also install it as <code>percent</code> then add an alias in your <code>~/.bash_profile</code> or equivalent startup file.</p>\n"}], "owner": {"reputation": 625, "user_id": 3788614, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/dbfc36762173d5e003effadd30cef320?s=128&d=identicon&r=PG&f=1", "display_name": "Jack", "link": "https://stackoverflow.com/users/3788614/jack"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 48, "favorite_count": 0, "accepted_answer_id": 57753626, "answer_count": 1, "score": 0, "last_activity_date": 1567515103, "creation_date": 1567352036, "last_edit_date": 1567480973, "question_id": 57747318, "link": "https://stackoverflow.com/questions/57747318/naming-brew-command-to-special-character", "title": "Naming brew command to special character", "body": "<p>How can I set up a script to PATH with a different name than the repo using brew. For example, let's say I have</p>\n\n<p><strong>percent.rb</strong></p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>    puts to_f(ARGV[0]) * to_i(ARGV[1])\n</code></pre>\n\n<p>in a repo called <code>homebrew-percent</code>.</p>\n\n<p>How can I turn this script into the command <code>%</code> on brew install where it can later be ran as <code>% 99 1000</code> in bash and get 990</p>\n\n<p><strong>Edit:</strong> I'd like to be clear that percent is an <em>example</em>, not my actual project.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "macos", "rubygems", "gemspecs"], "comments": [{"owner": {"reputation": 6942, "user_id": 4172515, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/BYWxd.jpg?s=128&g=1", "display_name": "fool-dev", "link": "https://stackoverflow.com/users/4172515/fool-dev"}, "edited": false, "score": 0, "creation_date": 1567340983, "post_id": 57745974, "comment_id": 101929770, "body": "Exactly what <code>$rails new app</code> or <code>rails new app</code>? if <code>$rails new app</code> then it will through error"}, {"owner": {"reputation": 1, "user_id": 12005818, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-If1Kzz-d4F0/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3re1TDqKb4PKSTDCae8duYYVsWtBvw/photo.jpg?sz=128", "display_name": "Andre Hernandez", "link": "https://stackoverflow.com/users/12005818/andre-hernandez"}, "reply_to_user": {"reputation": 6942, "user_id": 4172515, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/BYWxd.jpg?s=128&g=1", "display_name": "fool-dev", "link": "https://stackoverflow.com/users/4172515/fool-dev"}, "edited": false, "score": 0, "creation_date": 1567355010, "post_id": 57745974, "comment_id": 101932801, "body": "LOL, I do know how to use the command line.... the problem is showing when I run rails new app."}, {"owner": {"reputation": 9125, "user_id": 671422, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/85da2a1fa3e4017815ff5d3a3d70fabe?s=128&d=identicon&r=PG", "display_name": "Yule", "link": "https://stackoverflow.com/users/671422/yule"}, "edited": false, "score": 0, "creation_date": 1567423214, "post_id": 57745974, "comment_id": 101948474, "body": "If you&#39;ve just installed a new version of ruby, you may need to install rails:  <code>gem install rails</code>"}, {"owner": {"reputation": 20735, "user_id": 307106, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/6a13e655e637138f8d571cec3f9cea76?s=128&d=identicon&r=PG", "display_name": "jrochkind", "link": "https://stackoverflow.com/users/307106/jrochkind"}, "edited": false, "score": 0, "creation_date": 1567450158, "post_id": 57745974, "comment_id": 101959077, "body": "What Yule said. Running <code>gem which rails</code> should tell you if you have rails installed."}], "owner": {"reputation": 1, "user_id": 12005818, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-If1Kzz-d4F0/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3re1TDqKb4PKSTDCae8duYYVsWtBvw/photo.jpg?sz=128", "display_name": "Andre Hernandez", "link": "https://stackoverflow.com/users/12005818/andre-hernandez"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 178, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1567354913, "creation_date": 1567340575, "last_edit_date": 1567354913, "question_id": 57745974, "link": "https://stackoverflow.com/questions/57745974/could-not-find-railties-0-a-among-14-total-gems-gemloaderror", "title": "Could not find &#39;railties&#39; (&gt;= 0.a) among 14 total gem(s) (Gem::LoadError)", "body": "<p>When running: $rails new app I get an error!\n(Recently updated ruby.)</p>\n\n<p><code>macOS Mojave 10.14.6</code></p>\n\n<p><code>rails -v = ruby 2.6.3p62 (2019-04-16 revision 67580) [x86_64-darwin18]</code></p>\n\n<h2>When running: <code>$rails new app</code></h2>\n\n<pre><code>/Users/.rbenv/versions/2.3.0/lib/ruby/2.3.0/rubygems/dependency.rb:319:in to_specs': Could not find 'railties' (&gt;= 0.a) among 14 total gem(s) (Gem::LoadError)\n</code></pre>\n\n<p>Checked in '<code>GEM_PATH=/Users/.rvm/gems/ruby-2.6.3:/Users/.rvm/gems/ruby-2.6.3@global</code>', execute <code>gem env</code> for more information</p>\n\n<pre><code>from/Users/.rbenv/versions/2.3.0/lib/ruby/2.3.0/rubygems/dependency.rb:328:in to_spec'\n    from/Users/.rbenv/versions/2.3.0/lib/ruby/2.3.0/rubygems/core_ext/kernel_gem.rb:65:in `gem'\n\nfrom/Users/.rbenv/versions/2.3.0/bin/rails:22:in `&lt;main&gt;'\n</code></pre>\n\n<p>any Rails related code is not WORKING.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "dns", "local"], "comments": [{"owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 0, "creation_date": 1567350117, "post_id": 57745900, "comment_id": 101931682, "body": "<code>192.168.0.100</code> is a local network IP. Is your mobile on the same WiFi or do you try to connect from the mobile network to your home network via its public IP address?"}, {"owner": {"reputation": 312, "user_id": 7657817, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/2d821950016dcd8156cc8022cfb04205?s=128&d=identicon&r=PG", "display_name": "Merkelst", "link": "https://stackoverflow.com/users/7657817/merkelst"}, "reply_to_user": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 0, "creation_date": 1567359706, "post_id": 57745900, "comment_id": 101933790, "body": "@spickermann yes, I&#39;ve try. But I have another problem - I need share local domains by my network to get access to both server by <code>domain.local:port</code>, instead &#39;ip:port&#39;. Because by &#39;ip:port&#39; on mobile devices I cannot get redirects/cookies/data/etc from my second server"}, {"owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 0, "creation_date": 1567360094, "post_id": 57745900, "comment_id": 101933876, "body": "Do you have an appropriate <code>&#47;etc&#47;hosts</code> file on your mobile phone?"}, {"owner": {"reputation": 312, "user_id": 7657817, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/2d821950016dcd8156cc8022cfb04205?s=128&d=identicon&r=PG", "display_name": "Merkelst", "link": "https://stackoverflow.com/users/7657817/merkelst"}, "reply_to_user": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 0, "creation_date": 1567437693, "post_id": 57745900, "comment_id": 101954917, "body": "@spickermann mobile phone - just for example, how I said. Other tablets,phones, TV&#39;s, ps4, etc. And what kind of nonsense? Hot I add <code>&#47;etc&#47;hosts</code> file to, again for example, to iPhone or ps4?"}], "answers": [{"comments": [{"owner": {"reputation": 312, "user_id": 7657817, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/2d821950016dcd8156cc8022cfb04205?s=128&d=identicon&r=PG", "display_name": "Merkelst", "link": "https://stackoverflow.com/users/7657817/merkelst"}, "edited": false, "score": 0, "creation_date": 1567436837, "post_id": 57748329, "comment_id": 101954554, "body": "How I said - I need access on one wifi point to all my servers by local domain, not by ip:port/ngrok/etc. Strictly inside the wifi network."}], "tags": [], "owner": {"reputation": 358, "user_id": 8708097, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/APLHT.jpg?s=128&g=1", "display_name": "Saif chaudhry", "link": "https://stackoverflow.com/users/8708097/saif-chaudhry"}, "is_accepted": false, "score": -1, "last_activity_date": 1567360893, "creation_date": 1567360893, "answer_id": 57748329, "question_id": 57745900, "link": "https://stackoverflow.com/questions/57745900/share-multiple-rails-servers-by-domain-on-my-local-network/57748329#57748329", "title": "Share multiple rails servers by domain on my local network", "body": "<p>you can use ngrok to get access to your localhost on other devices</p>\n\n<pre><code>https://ngrok.com/\n</code></pre>\n"}], "owner": {"reputation": 312, "user_id": 7657817, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/2d821950016dcd8156cc8022cfb04205?s=128&d=identicon&r=PG", "display_name": "Merkelst", "link": "https://stackoverflow.com/users/7657817/merkelst"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 66, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1567360893, "creation_date": 1567339923, "question_id": 57745900, "link": "https://stackoverflow.com/questions/57745900/share-multiple-rails-servers-by-domain-on-my-local-network", "title": "Share multiple rails servers by domain on my local network", "body": "<p>I have two rails servers running on my machine by 3000 and 3001 ports.</p>\n\n<p>My <code>/etc/hosts</code>:</p>\n\n<pre><code>127.0.0.1 application.local\n127.0.0.1 login.application.local\n</code></pre>\n\n<p>I want to get access for this servers from another devices (example - from mobile). I can connect by one port by my machine ip address, like a <code>192.168.0.100:3000</code> or <code>192.168.0.100:3001</code>.</p>\n\n<p>But if I need to redirect from server 1 to server 2 on mobile - I cannot do it, because redirect from <code>192.168.0.100:3000</code> works not there <code>192.168.0.100:3001</code>, but there <code>login.application.local:3001</code> and phone cannot connection by local domain from my machine. </p>\n\n<p>Maybe have solutions to share my two rails servers by local W network? To get access from mobile by <code>application.local:3000</code> domain instead device IP? Or how to solve case, when I want to go from <em>ip:port</em> on my mobile devise to another <em>ip:port</em>?</p>\n"}, {"tags": ["ruby", "rspec", "parallel-testing"], "comments": [{"owner": {"reputation": 1, "user_id": 12005176, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mB9RLV_e33VdOc_oGfmx22DmR2fBP-cBGtqjv4_=k-s128", "display_name": "Balaji Natarajan", "link": "https://stackoverflow.com/users/12005176/balaji-natarajan"}, "edited": false, "score": 0, "creation_date": 1567329699, "post_id": 57743945, "comment_id": 101927667, "body": "the solution uses a before(:each) i want to find the file name in before(:all)"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 12005176, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mB9RLV_e33VdOc_oGfmx22DmR2fBP-cBGtqjv4_=k-s128", "display_name": "Balaji Natarajan", "link": "https://stackoverflow.com/users/12005176/balaji-natarajan"}, "edited": false, "score": 0, "creation_date": 1567329779, "post_id": 57744198, "comment_id": 101927678, "body": "this doesnt work. I am using before(:all)."}], "tags": [], "owner": {"reputation": 703, "user_id": 3744443, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/31cd958c40afab1804323dc579eeb4c5?s=128&d=identicon&r=PG&f=1", "display_name": "fidato", "link": "https://stackoverflow.com/users/3744443/fidato"}, "is_accepted": false, "score": -1, "last_activity_date": 1567324679, "creation_date": 1567324679, "answer_id": 57744198, "question_id": 57743945, "link": "https://stackoverflow.com/questions/57743945/how-to-find-the-currently-running-loaded-spec-file-name-inside-spec-helper/57744198#57744198", "title": "How to find the currently running/loaded spec file name inside spec helper", "body": "<p>I hope the following code can help.</p>\n\n<pre><code>RSpec.configure do |config|\n  config.before(:all) do |example_group|\n    path = example.metadata[:example_group][:file_path]\n    curr_path = config.instance_variable_get(:@curr_file_path)\n    if (curr_path.nil? || path != curr_path)\n      config.instance_variable_set(:@curr_file_path, path)\n      puts path\n    end\n  end\nend\n</code></pre>\n\n<p><a href=\"https://stackoverflow.com/questions/9891028/how-to-get-the-current-test-filename-from-rspec\">Reference</a></p>\n"}], "owner": {"reputation": 1, "user_id": 12005176, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mB9RLV_e33VdOc_oGfmx22DmR2fBP-cBGtqjv4_=k-s128", "display_name": "Balaji Natarajan", "link": "https://stackoverflow.com/users/12005176/balaji-natarajan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 84, "favorite_count": 0, "closed_date": 1567326586, "answer_count": 1, "score": 0, "last_activity_date": 1567329651, "creation_date": 1567322222, "last_edit_date": 1567329651, "question_id": 57743945, "link": "https://stackoverflow.com/questions/57743945/how-to-find-the-currently-running-loaded-spec-file-name-inside-spec-helper", "closed_reason": "Duplicate", "title": "How to find the currently running/loaded spec file name inside spec helper", "body": "<p>I have multiple specs, wish to create separate log files per spec with the spec file name. I need to know which spec file is currently loaded in <code>spec_helper.rb</code>.</p>\n\n<p>I have to create logger object in spec helper</p>\n\n<pre><code>RSpec.configure do |config|\n  config.before(:all) do |example_group|\n    loaded_files = config.instance_variable_get(\"@files_to_run\")\n    # after getting the current spec file name\n    # will create log file here\n  end\nend\n</code></pre>\n\n<p><code>loaded_files</code> have an array of all the spec files that I chose for execution. I need to know which is currently loaded?</p>\n\n<p>I do not want to put a before(:each) block, it will increase the run time and i just need the filename, not a good solution to use before(:each) block.</p>\n"}, {"tags": ["regex", "ruby"], "comments": [{"owner": {"reputation": 83048, "user_id": 2255089, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZNAsT.jpg?s=128&g=1", "display_name": "Casimir et Hippolyte", "link": "https://stackoverflow.com/users/2255089/casimir-et-hippolyte"}, "edited": false, "score": 2, "creation_date": 1567297998, "post_id": 57741822, "comment_id": 101923771, "body": "It seems you only have to split the string on semi-colons, isn&#39;t it? After all, it&#39;s csv file, no?"}, {"owner": {"reputation": 2389, "user_id": 761427, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/gqDlt.jpg?s=128&g=1", "display_name": "Arthur Coll&#233;", "link": "https://stackoverflow.com/users/761427/arthur-coll%c3%a9"}, "reply_to_user": {"reputation": 83048, "user_id": 2255089, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZNAsT.jpg?s=128&g=1", "display_name": "Casimir et Hippolyte", "link": "https://stackoverflow.com/users/2255089/casimir-et-hippolyte"}, "edited": false, "score": 0, "creation_date": 1567321101, "post_id": 57741822, "comment_id": 101926176, "body": "You misunderstand. I am perfectly aware that I can parse the original contents (found in founders.txt) into the csv output that I created based on the code in founders.rb. I was merely curious if it was possible to create a regex that is actually able to match on the cases where the founder entries (separated by semi-colons) have multiple subentries: (age, co | age2, co2, ..., ageN, coN). Hope this clarifies the intent. The .csv was something I was able to create off of the input string, but does not contain all the original entries. Apologies for the misleading ?, I&#39;ve clarified in an edit^."}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 6553328, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/omcAX.jpg?s=128&g=1", "display_name": "Emma", "link": "https://stackoverflow.com/users/6553328/emma"}, "is_accepted": false, "score": 0, "last_activity_date": 1567289653, "last_edit_date": 1567289653, "creation_date": 1567288755, "answer_id": 57741853, "question_id": 57741822, "link": "https://stackoverflow.com/questions/57741822/can-we-create-a-regular-expression-that-matches-every-founder-in-this-list/57741853#57741853", "title": "Can we create a regular expression that matches every founder in this list?", "body": "<p>My guess is that maybe this expression might simply work OK:</p>\n\n<pre><code>\\s*(\\d+)\\s*,\\s*([^)|]*)(?=\\s*\\||\\s*\\))|([^(\\r\\n]*)\\(\n</code></pre>\n\n<h3>Test</h3>\n\n<pre><code>re = /\\s*(\\d+)\\s*,\\s*([^)|]*)(?=\\s*\\||\\s*\\))|([^(\\r\\n]*)\\(/\nstr = 'Elon Musk (32, Tesla | 31, SpaceX | 27, PayPal);\nGarrett Camp (30, Uber);\n'\n\nstr.scan(re) do |match|\n    puts match.to_s\nend\n</code></pre>\n\n<h3>Output</h3>\n\n<pre><code>[nil, nil, \"Elon Musk \"]\n[\"32\", \"Tesla \", nil]\n[\"31\", \"SpaceX \", nil]\n[\"27\", \"PayPal\", nil]\n[nil, nil, \"Garrett Camp \"]\n[\"30\", \"Uber\", nil]\n</code></pre>\n\n<hr>\n\n<blockquote>\n  <p>If you wish to explore/simplify/modify the expression, it's been\n  explained on the top right panel of\n  <a href=\"https://regex101.com/r/Yirwdi/1/\" rel=\"nofollow noreferrer\">regex101.com</a>. If you'd like, you\n  can also watch in <a href=\"https://regex101.com/r/Yirwdi/1/debugger\" rel=\"nofollow noreferrer\">this\n  link</a>, how it would match\n  against some sample inputs.</p>\n</blockquote>\n\n<hr>\n"}, {"comments": [{"owner": {"reputation": 47898, "user_id": 966023, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/917fcb4327159076f752c0c3c3fddfbb?s=128&d=identicon&r=PG", "display_name": "pguardiario", "link": "https://stackoverflow.com/users/966023/pguardiario"}, "edited": false, "score": 1, "creation_date": 1567316604, "post_id": 57742195, "comment_id": 101925552, "body": "This looks about right. I would have used a <code>\\b</code> instead of <code>(?=\\s\\()</code>"}], "tags": [], "owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "is_accepted": true, "score": 5, "last_activity_date": 1571608251, "last_edit_date": 1571608251, "creation_date": 1567293393, "answer_id": 57742195, "question_id": 57741822, "link": "https://stackoverflow.com/questions/57741822/can-we-create-a-regular-expression-that-matches-every-founder-in-this-list/57742195#57742195", "title": "Can we create a regular expression that matches every founder in this list?", "body": "<p>The question only asks for the founders to be matched, so initially I have not included their enterprises. Later, however, I will discuss a possible way to organize all the information. </p>\n\n<p>Use <a href=\"https://ruby-doc.org/core-2.6.3/String.html#method-i-scan\" rel=\"nofollow noreferrer\">String#scan</a> with the following regular expression, which I've defined in free-spacing mode to make it self-documenting.</p>\n\n<pre><code>r = /\n    (?&lt;=\\A|;\\s)  # match the beginning of the string or a semi-colon\n                 # followed by a whitespace char in a positive lookbehind  \n    [\\p{L} ]+    # match one or more Unicode letters or spaces\n    (?=\\s\\()     # match a whitespace followed by \"(\" in a positive lookahead\n    /x           # free-spacing regex definition mode\n</code></pre>\n\n<h1><p></p></h1>\n\n<pre><code>str = \"Paul Graham (31, Viaweb); Jan Koum (33, WhatsApp); Brian Acton (37, WhatsApp); \" +\n      \"Elon Musk (32, Tesla | 31, SpaceX | 27, PayPal); Garrett Camp (30, Uber); \" +\n      \"Travis Kalanick (32, Uber);\"\n</code></pre>\n\n<h1><p></p></h1>\n\n<pre><code>str.scan(r)\n  #=&gt; [\"Paul Graham\", \"Jan Koum\", \"Brian Acton\", \"Elon Musk\", \"Garrett Camp\",\n  #    \"Travis Kalanick\"] \n</code></pre>\n\n<p>This regular expression is conventionally written as follows.</p>\n\n<pre><code>/(?&lt;=\\A|; )[\\p{L} ]+(?= \\()/\n</code></pre>\n\n<p>If additional information is needed it may be desirable to create a hash such as the following.</p>\n\n<pre><code>r = /\n    (?&lt;=\\A|;\\s)  # match the beginning of the string or a semi-colon\n                 # followed by a whitespace char in a positive lookbehind  \n    [\\p{L} ]+    # match one or more Unicode letters or spaces\n    \\([^)]+      # match a \"(\" followed by &gt; 0 characters other than \")\"\n    /x                \n</code></pre>\n\n<h1><p></p></h1>\n\n<pre><code>h = str.scan(r).\n        map { |s| s.split(/ \\(/) }.\n        each_with_object({}) do |(name, startups),h|\n          h[name] = startups.split(/ *\\| */).map do |s|\n            age, co = s.split(/, +/)\n            { age: age.to_i, co: co }\n          end\n    end\n  #=&gt; {\"Paul Graham\"    =&gt;[{:age=&gt;31, :co=&gt;\"Viaweb\"}],\n  #    \"Jan Koum\"       =&gt;[{:age=&gt;33, :co=&gt;\"WhatsApp\"}],\n  #    \"Brian Acton\"    =&gt;[{:age=&gt;37, :co=&gt;\"WhatsApp\"}],\n  #    \"Elon Musk\"      =&gt;[{:age=&gt;32, :co=&gt;\"Tesla\"}, {:age=&gt;31, :co=&gt;\"SpaceX\"},\n  #                        {:age=&gt;27, :co=&gt;\"PayPal\"}],\n  #    \"Garrett Camp\"   =&gt;[{:age=&gt;30, :co=&gt;\"Uber\"}],\n  #    \"Travis Kalanick\"=&gt;[{:age=&gt;32, :co=&gt;\"Uber\"}]}       \n</code></pre>\n\n<p>One could then easily compute, for example,</p>\n\n<pre><code>h.each_with_object(Hash.new { |h,k| h[k] = [] }) do |(name, cos),g|\n  cos.each { |co| g[co[:co]] &lt;&lt; name }\nend\n  #=&gt; {\"Viaweb\"=&gt;[\"Paul Graham\"],\n  #    \"WhatsApp\"=&gt;[\"Jan Koum\", \"Brian Acton\"],\n  #    \"Tesla\"=&gt;[\"Elon Musk\"],\n  #    \"SpaceX\"=&gt;[\"Elon Musk\"],\n  #    \"PayPal\"=&gt;[\"Elon Musk\"],\n  #    \"Uber\"=&gt;[\"Garrett Camp\", \"Travis Kalanick\"]} \n</code></pre>\n\n<p>The regular expression used here is conventionally written:</p>\n\n<pre><code>/(?&lt;=\\A|; )[\\p{L} ]+\\([^\\)]+/                \n</code></pre>\n\n<p>The steps to compute <code>h</code> are as follows.</p>\n\n<pre><code>a = str.scan(r)\n  #=&gt; [\"Paul Graham (31, Viaweb\", \"Jan Koum (33, WhatsApp\", \"Brian Acton (37, WhatsApp\",\n  #    \"Elon Musk (32, Tesla | 31, SpaceX | 27, PayPal\", \"Garrett Camp (30, Uber\",\n  #    \"Travis Kalanick (32, Uber\"]\nb = a.map { |s| s.split(/ \\(/) }\n  #=&gt; [[\"Paul Graham\", \"31, Viaweb\"], [\"Jan Koum\", \"33, WhatsApp\"],\n  #    [\"Brian Acton\", \"37, WhatsApp\"],\n  #    [\"Elon Musk\", \"32, Tesla | 31, SpaceX | 27, PayPal\"],\n  #    [\"Garrett Camp\", \"30, Uber\"], [\"Travis Kalanick\", \"32, Uber\"]] \nh = b.each_with_object({}) do |(name, startups),h|\n  h[name] = startups.split(/ *\\| */).map do |s|\n              age, co = s.split(/, +/)\n              { age: age.to_i, co: co }\n            end\nend\n  #=&gt; &lt;as above&gt;\n</code></pre>\n\n<p>In computing <code>h</code> from <code>b</code>, when</p>\n\n<pre><code>name = \"Elon Musk\"\nstartups = \"32, Tesla | 31, SpaceX | 27, PayPal\"\nh = {\"Paul Graham\" =&gt;[{:age=&gt;31, :co=&gt;\"Viaweb\"}],\n     \"Jan Koum\"    =&gt;[{:age=&gt;33, :co=&gt;\"WhatsApp\"}],\n     \"Brian Acton\" =&gt;[{:age=&gt;37, :co=&gt;\"WhatsApp\"}]}\n</code></pre>\n\n<p>the block calculation is as follows.</p>\n\n<pre><code>c = startups.split(/ *\\| */)\n  #=&gt; [\"32, Tesla\", \"31, SpaceX\", \"27, PayPal\"] \nd = c.map do |s|\n  age, co = s.split(/, +/)\n  { age: age.to_i, co: co }\nend\n  #=&gt; [{:age=&gt;32, :co=&gt;\"Tesla\"}, {:age=&gt;31, :co=&gt;\"SpaceX\"},\n  #    {:age=&gt;27, :co=&gt;\"PayPal\"}] \nh[name] = d\n  #=&gt; [{:age=&gt;32, :co=&gt;\"Tesla\"}, {:age=&gt;31, :co=&gt;\"SpaceX\"},\n  #    {:age=&gt;27, :co=&gt;\"PayPal\"}] \n</code></pre>\n\n<p>and now</p>\n\n<pre><code>h #=&gt; {\"Paul Graham\"=&gt;[{:age=&gt;31, :co=&gt;\"Viaweb\"}],\n  #    \"Jan Koum\"   =&gt;[{:age=&gt;33, :co=&gt;\"WhatsApp\"}],\n  #    \"Brian Acton\"=&gt;[{:age=&gt;37, :co=&gt;\"WhatsApp\"}],\n  #    \"Elon Musk\"  =&gt;[{:age=&gt;32, :co=&gt;\"Tesla\"}, {:age=&gt;31, :co=&gt;\"SpaceX\"},\n  #                    {:age=&gt;27, :co=&gt;\"PayPal\"}]} \n</code></pre>\n"}], "owner": {"reputation": 2389, "user_id": 761427, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/gqDlt.jpg?s=128&g=1", "display_name": "Arthur Coll&#233;", "link": "https://stackoverflow.com/users/761427/arthur-coll%c3%a9"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 151, "favorite_count": 0, "accepted_answer_id": 57742195, "answer_count": 2, "score": 2, "last_activity_date": 1571608251, "creation_date": 1567288520, "last_edit_date": 1567320610, "question_id": 57741822, "link": "https://stackoverflow.com/questions/57741822/can-we-create-a-regular-expression-that-matches-every-founder-in-this-list", "title": "Can we create a regular expression that matches every founder in this list?", "body": "<p>User @adventured posted this on Hacker News:</p>\n\n<pre><code>Paul Graham (31, Viaweb); Jan Koum (33, WhatsApp); Brian Acton (37, WhatsApp); Ev Williams (34, Twitter); Jack Dorsey (33, Square); Elon Musk (32, Tesla | 31, SpaceX | 27, PayPal); Garrett Camp (30, Uber); Travis Kalanick (32, Uber); Brian Chesky (27, Airbnb); Adam Neumann (31, WeWork); Reed Hastings (37, Netflix); Reid Hoffman (36, LinkedIn); Jack Ma (35, Alibaba); Jeff Bezos (30, Amazon); Jerry Sanders (33, AMD); Marc Benioff (35, Salesforce); Ross Perot (32, EDS); Peter Norton (39, Norton); Larry Ellison (33, Oracle); Mitch Kapor (32, Lotus); Leonard Bosack (32, Cisco); Sandy Lerner (29, Cisco); Gordon Moore (39, Intel); Mark Cuban (37, Broadcast.com); Scott Cook (31, Intuit); Nolan Bushnell (29, Atari); Paul Galvin (33, Motorola); Irwin Jacobs (52, Qualcomm); David Duffield (46, PeopleSoft | 64, Workday); Aneel Bhusri (39, Workday); Thomas Siebel (41, Siebel Systems); John McAfee (42, McAfee); Gary Hendrix (32, Symantec); Scott McNealy (28, Sun); Pierre Omidyar (28, eBay); Rich Barton (29, Expedia | 38, Zillow); Jim Clark (38, SGI | 49, Netscape); Charles Wang (32, CA); David Packard (27, HP); Craig Newmark (43, Craigslist); John Warnock (42, Adobe); Robert Noyce (30, Fairchild | 41, Intel); Rod Canion (37, Compaq); Jen-Hsun Huang (30, nVidia); James Goodnight (33, SAS); John Sall (28, SAS); Eli Harari (41, SanDisk); Sanjay Mehrotra (28, SanDisk); Al Shugart (48, Seagate); Finis Conner (34, Seagate); Henry Samueli (37, Broadcom); Henry Nicholas (32, Broadcom); Charles Brewer (36, Mindspring); William Shockley (45, Shockley); Ron Rivest (35, RSA); Adi Shamir (30, RSA); John Walker (32, Autodesk); Halsey Minor (30, CNet); David Filo (28, Yahoo); Jeremy Stoppelman (27, Yelp); Eric Lefkofsky (39, Groupon); Andrew Mason (29, Groupon); Markus Persson (30, Mojang); David Hitz (28, NetApp); Brian Lee (28, Legalzoom); Demis Hassabis (34, DeepMind); Tim Westergren (35, Pandora); Martin Lorentzon (37, Spotify); Ashar Aziz (44, FireEye); Kevin O'Connor (36, DoubleClick); Ben Silbermann (28, Pinterest); Evan Sharp (28, Pinterest); Steve Kirsch (38, Infoseek); Stephen Kaufer (36, TripAdvisor); Michael McNeilly (28, Applied Materials); Eugene McDermott (52, Texas Instruments); Richard Egan (43, EMC); Gary Kildall (32, Digital Research); Hasso Plattner (28, SAP); Robert Glaser (32, Real Networks); Patrick Byrne (37, Overstock.com); Marc Lore (33, Diapers.com); Ed Iacobucci (36, Citrix Systems); Ray Noorda (55, Novell); Tom Leighton (42, Akamai); Daniel Lewin (28, Akamai); Diane Greene (43, VMWare); Mendel Rosenblum (36, VMWare); Michael Mauldin (35, Lycos); Tom Anderson (33, MySpace); Chris DeWolfe (37, MySpace); Mark Pincus (41, Zynga); Caterina Fake (34, Flickr); Stewart Butterfield (31, Flickr | 36, Slack); Kevin Systrom (27, Instagram); Adi Tatarko (37, Houzz); Brian Armstrong (29, Coinbase); Pradeep Sindhu (43, Juniper); Peter Thiel (31, PayPal | 37, Palantir); Jay Walker (42, Priceline.com); Bill Coleman (48, BEA Systems); Evan Goldberg (35, NetSuite); Fred Luddy (48, ServiceNow); Michael Baum (41, Splunk); Nir Zuk (33, Palo Alto Networks); David Sacks (36, Yammer); Jack Smith (28, Hotmail); Sabeer Bhatia (28, Hotmail); Chad Hurley (28, YouTube); Andy Rubin (37, Danger | 41, Android); Rodney Brooks (36, iRobot); Jeff Hawkins (35, Palm); Tom Gosner (39, DocuSign); Niklas Zennstr\u00f6m (37, Skype); Janus Friis (27, Skype); George Kurtz (40, CrowdStrike); Trip Hawkins (28, EA); Gabe Newell (33, Valve); David Bohnett (38, Geocities); Bill Gross (40, GoTo.com/Overture); Subrah Iyar (38, WebEx); Eric Yuan (41, Zoom); Min Zhu (47, WebEx); Bob Parsons (47, GoDaddy); Wilfred Corrigan (43, LSI); Joe Parkinson (33, Micron); Aart J. de Geus (32, Synopsys); Patrick Byrne (37, Overstock); Matthew Prince (34, Cloudflare); Ben Uretsky (28, DigitalOcean); Tom Preston-Werner (28, GitHub); Louis Borders (48, Webvan); John Moores (36, BMC Software); Vivek Ranadiv\u00e9 (40, Tibco); Pony Ma (27, Tencent); Robin Li (32, Baidu); Liu Qiangdong (29, JD.com); Lei Jun (40, Xiaomi); Ren Zhengfei (38, Huawei); Arkady Volozh (36, Yandex); Hiroshi Mikitani (34, Rakuten); Morris Chang (56, Taiwan Semi); Cheng Wei (29, Didi Chuxing); James Liang (29, Ctrip); Zhang Yiming (29, ByteDance);\n</code></pre>\n\n<p>I tried to write a Regex that would have each \"Match group\" correspond to these founders. I was able to get 136/144 of the entries, but I'm kind of confused on how to capture the founders with the pipe entries (Elon Musk, David Duffield, Rich Barton, Robert Noyce, etc. Here is an example:</p>\n\n<pre><code>Elon Musk (32, Tesla | 31, SpaceX | 27, PayPal);\n</code></pre>\n\n<p>I know I can escape the pipes with <code>\\|</code> but even wrapping the \"paren part\" with an <code>*</code> doesn't seem to do it.</p>\n\n<p>Here's the regular expression I created: </p>\n\n<p><code>([A-Za-z\u00e9'.\\/\\s+-]+{2})\\s+\\(([0-9]+),\\s+([A-Za-z0-9\\s+.-\\|]+\\s?)\\);</code> </p>\n\n<p>(I removed the last semi-colon so that I could perform my matches after just running a split(\";\") on the file contents.</p>\n\n<p>I created a simple repro which is here: <a href=\"https://github.com/arthurcolle/founders\" rel=\"nofollow noreferrer\">https://github.com/arthurcolle/founders</a></p>\n\n<p>Here's the code inline, in case you don't want to just go to the very simple repro:</p>\n\n<pre><code>rgx = /([A-Za-z\u00e9'.\\/\\s+-]+{2})\\s+\\(([0-9]+),\\s+([A-Za-z0-9\\s+.-\\|]+\\s?)\\)/\nFOUNDERS_FILE = \"/Users/stochastic-thread/founders/founders.txt\"\n\nfile = File.read(FOUNDERS_FILE)\nitems = file.split(\";\")\nitems.each {|item|\n  matched = rgx.match(item)\n  if matched and matched.size == 4\n    group = \"#{matched[1]},#{matched[2]},#{matched[3]}\\n\"\n    puts group\n    File.open(\"founders.csv\", mode: \"a\") do |f|\n      f.write(group)\n    end\n  end\n}\n</code></pre>\n\n<p>What is the regular expression that would match on every \"founder-company\" group, taking into account the fact that every single founder might have multiple founded companies, with corresponding ages (in the specific format detailed above in the case of Elon Musk? (The \u00f6 character is unicode, so I don't think I'm able to actually match on it because when I put it in the name match group, it said multi-byte characters don't work.)</p>\n\n<p>I know that I can just find entries that don't match the regex, and use a different regex that only matches the parenthesis format, or even just split again on the pipes, but I'm trying to find a \"perfect regex\" for this.</p>\n"}, {"tags": ["javascript", "ruby-on-rails", "ruby", "chart.js", "chart.js2"], "comments": [{"owner": {"reputation": 6316, "user_id": 1184717, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/7f8710cd5754a79df5dc5cd3d5308da2?s=128&d=identicon&r=PG", "display_name": "Mr.", "link": "https://stackoverflow.com/users/1184717/mr"}, "edited": false, "score": 0, "creation_date": 1567271962, "post_id": 57740107, "comment_id": 101919363, "body": "from ruby prespective, if you have the data in hash object, when not to use <a href=\"https://ruby-doc.org/stdlib-2.6.3/libdoc/json/rdoc/JSON.html#module-JSON-label-Generating+JSON\" rel=\"nofollow noreferrer\"><code>to_json</code></a>?"}, {"owner": {"reputation": 1159, "user_id": 11350468, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84eaf3738f7b76dd49b796024c31b590?s=128&d=identicon&r=PG&f=1", "display_name": "user11350468", "link": "https://stackoverflow.com/users/11350468/user11350468"}, "edited": false, "score": 2, "creation_date": 1567271969, "post_id": 57740107, "comment_id": 101919364, "body": "Try <code>data: &lt;%= @hr.to_json.html_safe %&gt;</code>"}, {"owner": {"reputation": 3000, "user_id": 5604852, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh5.googleusercontent.com/-PDS5mZUZSok/AAAAAAAAAAI/AAAAAAAAD9Q/RGu5AZCnSoo/photo.jpg?sz=128", "display_name": "Oliver Trampleasure", "link": "https://stackoverflow.com/users/5604852/oliver-trampleasure"}, "edited": false, "score": 0, "creation_date": 1567272919, "post_id": 57740107, "comment_id": 101919550, "body": "Thanks, .html_safe was the answer. Appreciate the help! That took me hours"}], "answers": [{"comments": [{"owner": {"reputation": 3000, "user_id": 5604852, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh5.googleusercontent.com/-PDS5mZUZSok/AAAAAAAAAAI/AAAAAAAAD9Q/RGu5AZCnSoo/photo.jpg?sz=128", "display_name": "Oliver Trampleasure", "link": "https://stackoverflow.com/users/5604852/oliver-trampleasure"}, "edited": false, "score": 0, "creation_date": 1567272934, "post_id": 57740192, "comment_id": 101919555, "body": "Thanks, <code>.html_safe</code> was the answer. Appreciate the help! That took me hours"}, {"owner": {"reputation": 3775, "user_id": 5268235, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lval0.jpg?s=128&g=1", "display_name": "Minato", "link": "https://stackoverflow.com/users/5268235/minato"}, "reply_to_user": {"reputation": 3000, "user_id": 5604852, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh5.googleusercontent.com/-PDS5mZUZSok/AAAAAAAAAAI/AAAAAAAAD9Q/RGu5AZCnSoo/photo.jpg?sz=128", "display_name": "Oliver Trampleasure", "link": "https://stackoverflow.com/users/5604852/oliver-trampleasure"}, "edited": false, "score": 0, "creation_date": 1567272954, "post_id": 57740192, "comment_id": 101919562, "body": "@OliverTrampleasure No problem :D"}], "tags": [], "owner": {"reputation": 3775, "user_id": 5268235, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lval0.jpg?s=128&g=1", "display_name": "Minato", "link": "https://stackoverflow.com/users/5268235/minato"}, "is_accepted": true, "score": 2, "last_activity_date": 1567272179, "creation_date": 1567272179, "answer_id": 57740192, "question_id": 57740107, "link": "https://stackoverflow.com/questions/57740107/output-array-of-hashes-from-ruby-on-rails-to-chart-js/57740192#57740192", "title": "Output array of hashes from Ruby on Rails to chart.js", "body": "<p>Due to rendering, which uses <code>to_s</code> under the hood which could cause some encoding issues while rendering from a <code>string</code> type object. You should try using using <code>html_safe</code> method on the object returned by <code>@hr.to_json</code> like <code>@hr.to_json.html_safe</code></p>\n"}], "owner": {"reputation": 3000, "user_id": 5604852, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh5.googleusercontent.com/-PDS5mZUZSok/AAAAAAAAAAI/AAAAAAAAD9Q/RGu5AZCnSoo/photo.jpg?sz=128", "display_name": "Oliver Trampleasure", "link": "https://stackoverflow.com/users/5604852/oliver-trampleasure"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 302, "favorite_count": 0, "accepted_answer_id": 57740192, "answer_count": 1, "score": 1, "last_activity_date": 1567272179, "creation_date": 1567271465, "question_id": 57740107, "link": "https://stackoverflow.com/questions/57740107/output-array-of-hashes-from-ruby-on-rails-to-chart-js", "title": "Output array of hashes from Ruby on Rails to chart.js", "body": "<p>I'm having some trouble preparing data from my <strong>Ruby on Rails</strong> project for use in <strong>chart.js</strong>, when using time as a second axis.</p>\n\n<p>I've looked at various other questions and managed to get very close, but am having issues with exporting the data in a format that chart.js can recognise.</p>\n\n<p>Thanks for your help!</p>\n\n<hr>\n\n<h1>Issue</h1>\n\n<p>I need the data to be printed in this form:</p>\n\n<pre><code>data: [\n  {\"x\":1567006282000,\"y\":145},        \n  {\"x\":1567009767000,\"y\":120},\n  {\"x\":1567009838000,\"y\":130}\n]\n</code></pre>\n\n<p>But am currently getting the following:</p>\n\n<pre><code>data: [\n    {&amp;quot;x&amp;quot;:1567006282000,&amp;quot;y&amp;quot;:145}, \n    {&amp;quot;x&amp;quot;:1567009767000,&amp;quot;y&amp;quot;:120}, \n    {&amp;quot;x&amp;quot;:1567009838000,&amp;quot;y&amp;quot;:130}\n]\n</code></pre>\n\n<hr>\n\n<h1>Current Attempt</h1>\n\n<p>I am creating the array as follows from within my controller, where <code>reading_time</code> and <code>obs.heart_rate</code> are integers, I <em>think</em> this is creating an array of hashes:</p>\n\n<pre><code>...\n@hr.push ( { :x =&gt; reading_time, :y =&gt; obs.heart_rate  } )\n...\n</code></pre>\n\n<p>I then print this in my view, converting to json so that it would in theory work with the javascript library chart.js:</p>\n\n<pre><code>...\ndata: &lt;%= @hr.to_json %&gt;,\n...\n</code></pre>\n\n<p>Pretty sure my issue is somewhere in the two lines above, but the full code is below in case it is needed.</p>\n\n<hr>\n\n<h1>Full Code</h1>\n\n<p>This is how I am creating (what I think) is an array of hashes within my <strong>controller</strong>:</p>\n\n<pre><code>def chart \n\n    # Load observations for specific patient\n    @observations = Observation.where(:patient_id =&gt; params[:patient_id]);\n\n    # Prep arrays\n    @readings = []\n    @hr = []\n\n    # Cycle through all observations for this patient\n    @observations.each do |obs| \n\n        # Convert created time to integer\n        # Multiple by 1000 as chart.js expects milliseconds while ruby uses seconds from UNIX epoch\n        reading_time = obs.created_at.to_i * 1000\n\n        # Add time to array so we can use this for the labels\n        @readings.push(reading_time)\n\n        # Create hash of time and observation value\n        hr_temp = {:x =&gt; reading_time , :y =&gt; obs.heart_rate }\n\n        # Push hash to the array\n        @hr.push( hr_temp )\n\n        # Repeat for other obserations - blood pressure, oxygen sats, etc\n\n    end\n\nend\n</code></pre>\n\n<p>And finally how I am then printing that within my <strong>view</strong>:</p>\n\n<pre><code>&lt;script src=\"https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.8.0/Chart.bundle.min.js\" integrity=\"sha256-xKeoJ50pzbUGkpQxDYHD7o7hxe0LaOGeguUidbq6vis=\" crossorigin=\"anonymous\"&gt;&lt;/script&gt;\n\n&lt;canvas id=\"myChart\" width=\"400\" height=\"400\"&gt;&lt;/canvas&gt;\n&lt;script&gt;\n\nvar ctx = document.getElementById('myChart').getContext('2d');\nvar scatterChart = new Chart(ctx, {\n    type: 'line',\n    data: {\n        labels: &lt;%= @readings %&gt;,\n        datasets: [{\n            label: 'Heart Rate',\n            data: &lt;%= @hr.to_json %&gt;,\n            borderWidth: 1\n        }]\n    },\n    options: {\n        scales: {\n            xAxes: [{\n                type: 'time',\n                time: {\n                    parser: 'X', // parse x values as unix timestamp\n                    tooltipFormat: 'MMM Do, \\'YY'\n                },\n            }]\n        }\n    }\n});\n&lt;/script&gt;\n</code></pre>\n\n<hr>\n\n<h1>Working Example</h1>\n\n<p>This is a working hard coded example showing what I am aiming for.</p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-js lang-js prettyprint-override\"><code>var ctx = document.getElementById('myChart').getContext('2d');\r\nvar scatterChart = new Chart(ctx, {\r\n    type: 'line',\r\n    data: {\r\n        datasets: [{\r\n            label: 'Heart Rate',\r\n            data: [\r\n              {\"x\":1567006282000,\"y\":145},        \r\n              {\"x\":1567009767000,\"y\":120},\r\n              {\"x\":1567009838000,\"y\":130}\r\n            ]\r\n        }]\r\n    },\r\n    options: {\r\n        scales: {\r\n\t\txAxes: [{\r\n\t\t\ttype: 'time',\r\n\t\t\ttime: {\r\n\t\t\t\tparser: 'X', // parse x values as unix timestamp\r\n\t\t\t\ttooltipFormat: 'MMM Do, \\'YY'\r\n\t\t\t},\r\n\t\t}]\r\n\t}\r\n    }\r\n});</code></pre>\r\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code>&lt;script src=\"https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.8.0/Chart.bundle.min.js\" integrity=\"sha256-xKeoJ50pzbUGkpQxDYHD7o7hxe0LaOGeguUidbq6vis=\" crossorigin=\"anonymous\"&gt;&lt;/script&gt;\r\n\r\n&lt;canvas id=\"myChart\" width=\"400\" height=\"400\"&gt;&lt;/canvas&gt;</code></pre>\r\n</div>\r\n</div>\r\n</p>\n"}, {"tags": ["ruby", "rufus-scheduler"], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 1222103, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64e760a985650c374e8bf93a10c29cdc?s=128&d=identicon&r=PG", "display_name": "user1222103", "link": "https://stackoverflow.com/users/1222103/user1222103"}, "edited": false, "score": 1, "creation_date": 1567280259, "post_id": 57740764, "comment_id": 101921187, "body": "Your &quot;load&quot; vs &quot;require&quot; suggestion solved the problem. Many thanks for your help, as well as for all your work on Rufus--it is a great piece of software!"}], "tags": [], "owner": {"reputation": 3437, "user_id": 10762, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8d96626e52beb1ff90f57a8e189e1e6f?s=128&d=identicon&r=PG", "display_name": "jmettraux", "link": "https://stackoverflow.com/users/10762/jmettraux"}, "is_accepted": true, "score": 0, "last_activity_date": 1567277417, "last_edit_date": 1567277417, "creation_date": 1567276865, "answer_id": 57740764, "question_id": 57739915, "link": "https://stackoverflow.com/questions/57739915/rufus-scheduler-running-only-once/57740764#57740764", "title": "Rufus-Scheduler Running Only Once", "body": "<p>You could try with</p>\n\n<pre><code>#launcher.rb\n\nrequire \"rubygems\"\nrequire \"rufus-scheduler\"\n\nscheduler = Rufus::Scheduler.new\n\nscheduler.every(\"2m\")do\n  #require \"/home/pi/Bots/script.rb\"\n  load \"/home/pi/Bots/script.rb\"\nend\n\nscheduler.join\n</code></pre>\n\n<p>It may work (\"may\" because I don't know exactly what's in your script.rb). <code>require</code> will not load and run again whatever behind your \"home/pi/Bots/script.rb\" while <code>load</code> will load and run each time.</p>\n\n<p>What happens with your current launcher is that require is called every 2 minutes, but only the first time does it load and run the script.rb.</p>\n\n<p>Please note that the following might be better:</p>\n\n<pre><code># script.rb\n\nmodule MyBot\n  def self.call\n    # do the job...\n  end\nend\n\n\n# launcher.rb\n\nrequire 'rubygems'\nrequire 'rufus-scheduler'\nrequire '/home/pi/Bots/script.rb'\n\nscheduler = Rufus::Scheduler.new\n\nscheduler.every('2m') do\n  MyBot.call\nend\n\nscheduler.join\n</code></pre>\n\n<p>See <a href=\"https://ruby-doc.org/core-2.6.4/Kernel.html#method-i-load\" rel=\"nofollow noreferrer\">Kernel#load</a> and <a href=\"https://ruby-doc.org/core-2.6.4/Kernel.html#method-i-require\" rel=\"nofollow noreferrer\">Kernel#require</a></p>\n"}], "owner": {"reputation": 23, "user_id": 1222103, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64e760a985650c374e8bf93a10c29cdc?s=128&d=identicon&r=PG", "display_name": "user1222103", "link": "https://stackoverflow.com/users/1222103/user1222103"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 92, "favorite_count": 0, "accepted_answer_id": 57740764, "answer_count": 1, "score": 0, "last_activity_date": 1567277417, "creation_date": 1567269848, "question_id": 57739915, "link": "https://stackoverflow.com/questions/57739915/rufus-scheduler-running-only-once", "title": "Rufus-Scheduler Running Only Once", "body": "<p>I am using Rufus Scheduler to run another Ruby script every two minutes. The script runs once, but never again. Is there an error in my code? HTOP shows that \"launcher.rb\" continues to exist as a process after the \"script.rb\" code runs once.</p>\n\n<pre><code>#launcher.rb\n\nrequire \"rubygems\"\nrequire \"rufus-scheduler\"\n\nscheduler = Rufus::Scheduler.new    \n\nscheduler.every(\"2m\")do\n    require \"/home/pi/Bots/script.rb\"\nend\n\nscheduler.join\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "rest"], "comments": [{"owner": {"reputation": 21613, "user_id": 580346, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/ba17945a06aac247b06548d5afe341e8?s=128&d=identicon&r=PG", "display_name": "mrzasa", "link": "https://stackoverflow.com/users/580346/mrzasa"}, "edited": false, "score": 0, "creation_date": 1567261576, "post_id": 57738834, "comment_id": 101916811, "body": "Do you have <code>resources :simulations</code>  added to your <code>routes.rb</code>?"}, {"owner": {"reputation": 33, "user_id": 12003039, "user_type": "registered", "profile_image": "https://graph.facebook.com/10218174126520107/picture?type=large", "display_name": "Jennifer Stephan", "link": "https://stackoverflow.com/users/12003039/jennifer-stephan"}, "reply_to_user": {"reputation": 21613, "user_id": 580346, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/ba17945a06aac247b06548d5afe341e8?s=128&d=identicon&r=PG", "display_name": "mrzasa", "link": "https://stackoverflow.com/users/580346/mrzasa"}, "edited": false, "score": 1, "creation_date": 1567261758, "post_id": 57738834, "comment_id": 101916866, "body": "yes ! resources :simulations, only: [:new, :create, :show, :edit, :update, :destroy] in my routes"}, {"owner": {"reputation": 13378, "user_id": 1430810, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/v669u.jpg?s=128&g=1", "display_name": "arieljuod", "link": "https://stackoverflow.com/users/1430810/arieljuod"}, "edited": false, "score": 0, "creation_date": 1567267489, "post_id": 57738834, "comment_id": 101918284, "body": "The form should use POST method, not GET if you are creating something. use <code>simple_form_for @simulation do |f|</code>, the helper takes care of the url and the method."}], "answers": [{"tags": [], "owner": {"reputation": 21613, "user_id": 580346, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/ba17945a06aac247b06548d5afe341e8?s=128&d=identicon&r=PG", "display_name": "mrzasa", "link": "https://stackoverflow.com/users/580346/mrzasa"}, "is_accepted": false, "score": 0, "last_activity_date": 1567262315, "creation_date": 1567262315, "answer_id": 57738941, "question_id": 57738834, "link": "https://stackoverflow.com/questions/57738834/no-route-matches-get-simulations/57738941#57738941", "title": "No route matches [GET] &quot;/simulations&quot;", "body": "<p>You miss <code>index</code> route in your <code>routes.rb</code>. It maps to <code>/simuations</code> path. </p>\n\n<p>either need to add it to your list:</p>\n\n<pre><code>resources :simulations, only: [:index, :new, :create, :show, :edit, :update, :destroy]\n</code></pre>\n\n<p>or use the implicit \"all REST routes\":</p>\n\n<pre><code>resources :simulations\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 33, "user_id": 12003039, "user_type": "registered", "profile_image": "https://graph.facebook.com/10218174126520107/picture?type=large", "display_name": "Jennifer Stephan", "link": "https://stackoverflow.com/users/12003039/jennifer-stephan"}, "edited": false, "score": 0, "creation_date": 1567263178, "post_id": 57739012, "comment_id": 101917263, "body": "thanks for your answer. just did it. :) the problem seems to be somewhere else now... as in my &quot;rails c&quot;, my create method for simulation does not work because of the params I think. because even in the index redirection after submitting the form, I have a &quot;no method for nil class&quot;"}, {"owner": {"reputation": 11394, "user_id": 794481, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/344337b6819f2f513fa80bb227be3c2d?s=128&d=identicon&r=PG", "display_name": "Tallboy", "link": "https://stackoverflow.com/users/794481/tallboy"}, "reply_to_user": {"reputation": 33, "user_id": 12003039, "user_type": "registered", "profile_image": "https://graph.facebook.com/10218174126520107/picture?type=large", "display_name": "Jennifer Stephan", "link": "https://stackoverflow.com/users/12003039/jennifer-stephan"}, "edited": false, "score": 0, "creation_date": 1567263790, "post_id": 57739012, "comment_id": 101917395, "body": "You probably need to change the route on your form to be the <code>simulation_create_path</code> and not the <code>root_path</code>. The method should also be <code>post</code>"}, {"owner": {"reputation": 11394, "user_id": 794481, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/344337b6819f2f513fa80bb227be3c2d?s=128&d=identicon&r=PG", "display_name": "Tallboy", "link": "https://stackoverflow.com/users/794481/tallboy"}, "reply_to_user": {"reputation": 33, "user_id": 12003039, "user_type": "registered", "profile_image": "https://graph.facebook.com/10218174126520107/picture?type=large", "display_name": "Jennifer Stephan", "link": "https://stackoverflow.com/users/12003039/jennifer-stephan"}, "edited": false, "score": 0, "creation_date": 1567263854, "post_id": 57739012, "comment_id": 101917404, "body": "It also says nil becaues you have no method called <code>def index</code> which sets <code>@simulations = Simulation.all</code>."}, {"owner": {"reputation": 33, "user_id": 12003039, "user_type": "registered", "profile_image": "https://graph.facebook.com/10218174126520107/picture?type=large", "display_name": "Jennifer Stephan", "link": "https://stackoverflow.com/users/12003039/jennifer-stephan"}, "edited": false, "score": 0, "creation_date": 1567264313, "post_id": 57739012, "comment_id": 101917518, "body": "for the index method I have actually ! I added it when adding the route :) I am trying to redirect the path in my form"}], "tags": [], "owner": {"reputation": 11394, "user_id": 794481, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/344337b6819f2f513fa80bb227be3c2d?s=128&d=identicon&r=PG", "display_name": "Tallboy", "link": "https://stackoverflow.com/users/794481/tallboy"}, "is_accepted": false, "score": 0, "last_activity_date": 1567262958, "creation_date": 1567262958, "answer_id": 57739012, "question_id": 57738834, "link": "https://stackoverflow.com/questions/57738834/no-route-matches-get-simulations/57739012#57739012", "title": "No route matches [GET] &quot;/simulations&quot;", "body": "<p>Just simply change it to </p>\n\n<pre><code>resources :simulations\n</code></pre>\n\n<p>or add <code>:index</code> to your list:</p>\n\n<pre><code>resources :simulations, only: [:index, :new, :create, :show, :edit, :update, :destroy]\n</code></pre>\n\n<p>You can also exclude ones for other scenarios (it will do all of them except that):</p>\n\n<pre><code>resources :simulations, except: [:destroy]\n</code></pre>\n\n<p>More on routing is here: <a href=\"https://guides.rubyonrails.org/routing.html\" rel=\"nofollow noreferrer\">https://guides.rubyonrails.org/routing.html</a></p>\n"}, {"tags": [], "owner": {"reputation": 33, "user_id": 12003039, "user_type": "registered", "profile_image": "https://graph.facebook.com/10218174126520107/picture?type=large", "display_name": "Jennifer Stephan", "link": "https://stackoverflow.com/users/12003039/jennifer-stephan"}, "is_accepted": false, "score": 0, "last_activity_date": 1567263017, "creation_date": 1567263017, "answer_id": 57739019, "question_id": 57738834, "link": "https://stackoverflow.com/questions/57738834/no-route-matches-get-simulations/57739019#57739019", "title": "No route matches [GET] &quot;/simulations&quot;", "body": "<p>@mrzasa \nthanks. I added all the resources just to test. and in the index, i wanted to have the attributes of my simulation, so :</p>\n\n<p>index.html.erb</p>\n\n<pre><code>&lt;p&gt;&lt;%= @simulations.first.activity %&gt;&lt;/p&gt;\n&lt;p&gt;&lt;%= @simulations.first.accre %&gt;&lt;/p&gt;\n&lt;p&gt;&lt;%= @simulations.first.reglementary %&gt;&lt;/p&gt;\n&lt;p&gt;&lt;%= @simulations.first.year_existence %&gt;&lt;/p&gt;\n&lt;h1&gt;&lt;%= @simulations.first.result %&gt;&lt;/h1&gt;\n</code></pre>\n\n<p>I end up with a \"undefined method `activity' for nil:NilClass\". My simulation is not created...\nBut in my create method in the controller I added also a redirection to the show of the simulation we just created in the new. </p>\n\n<pre><code>def create\n    @simulation = Simulation.new(simulation_params)\n    @simulation.user = current_user\n    if @simulation.save\n      redirect_to simulation_path(@simulation)\n    else\n      render :new\n    end\n  end\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 33, "user_id": 12003039, "user_type": "registered", "profile_image": "https://graph.facebook.com/10218174126520107/picture?type=large", "display_name": "Jennifer Stephan", "link": "https://stackoverflow.com/users/12003039/jennifer-stephan"}, "is_accepted": false, "score": 0, "last_activity_date": 1567410791, "last_edit_date": 1567410791, "creation_date": 1567265737, "answer_id": 57739374, "question_id": 57738834, "link": "https://stackoverflow.com/questions/57738834/no-route-matches-get-simulations/57739374#57739374", "title": "No route matches [GET] &quot;/simulations&quot;", "body": "<p>Those are the changes/corrections I tried to make in my code:</p>\n\n<p>This is my form:</p>\n\n<pre><code>&lt;%= simple_form_for @simulation, url: simulations_path, method: :get do |f| %&gt;\n\n        &lt;%= f.input :activity,\n        label:\"Quelle est votre cat\u00e9gorie d'activit\u00e9 ?\",\n        collection: Simulation::ACTIVITES,\n        value_method: :activity,\n        as: :select %&gt;\n\n        &lt;%= f.input :reglementary,\n        label:\"Est-ce une activit\u00e9 lib\u00e9rale r\u00e8glement\u00e9e ?\",\n        as: :boolean,\n        value_method: :reglementary,\n        as: :select %&gt;\n\n        &lt;%= f.input :year_existence,\n        label:\"Quel est l'\u00e2ge de l'entreprise en ann\u00e9e d'activit\u00e9 ?\",\n        collection: Simulation::YEAREXISTENCE,\n        include_blank: true,\n        value_method: :year_existence,\n        as: :select %&gt;\n\n        &lt;%= f.input :accre,\n        label:\"Avez-vous obtenu l'ACCRE lors de votre cr\u00e9ation d'entreprise ?\",\n        as: :boolean,\n        include_blank: true,\n        value_method: :accre,\n        as: :select %&gt;\n\n      &lt;%= f.submit \"valider\", class: \"btn btn-primary\" %&gt;\n</code></pre>\n\n<p><img src=\"https://i.stack.imgur.com/QkxV9.png\" alt=\"enter image description here\"></p>\n\n<p>This is what I get when I submit it (the same result with method: <code>:post</code> or <code>:get</code> in the simple_form...)</p>\n\n<p><img src=\"https://i.stack.imgur.com/72q9g.png\" alt=\"enter image description here\"></p>\n\n<p>The <code>params[:simulation][:activity]...</code> are here but the instance is not created...</p>\n\n<p>Is it something wrong in my \"before_save\" method in the Simulation  model?</p>\n\n<blockquote>\n  <p>simulation.rb</p>\n</blockquote>\n\n<pre><code>class Simulation &lt; ApplicationRecord\n  belongs_to :user\n\n  ACTIVITES = [\"liberale\", \"commerciale ou industrielle\", \"artisanale\"]\n  YEAREXISTENCE = [1, 2, 3, 4]\n\n  before_save :set_result\n\n  validates :activity, presence: true, inclusion: { in: ACTIVITES }\n  validates :year_existence, presence: true, inclusion: { in: YEAREXISTENCE }\n  validates :reglementary, presence: true\n  validates :accre, presence: true\n\n  def set_result\n    raise\n    if params[:simulation][:activity] == \"liberale\" &amp;&amp; params[:simulation][:year_existence] == 2 &amp;&amp; params[:simulation][:accre]\n      self.result = 0.12\n    else\n      self.result = 0.23\n    end\n  end\nend\n</code></pre>\n\n<p>or maybe in my \"create method\" in the controller...:</p>\n\n<pre><code>class SimulationsController &lt; ApplicationController\n  before_action :set_simulation, only: [:show, :edit, :update, :destroy, :set_tax_rate]\n\n  def new\n    @simulation = Simulation.new\n  end\n\n  def create\n    @simulation = Simulation.new(simulation_params)\n    @simulation.user = current_user\n    if @simulation.save\n      render :index\n    else\n      render :new\n    end\n  end\n\n  def index\n    @simulations = Simulation.all\n  end\n\n  def edit\n  end\n\n  def show\n  end\n\n  def update\n  end\n\n  def destroy\n  end\n\n  private\n\n  def set_simulation\n    @simulation = Simulation.find(params[:id])\n  end\n\n  def simulation_params\n    params.require(:simulation).permit(:activity, :reglementary, :accre, :year_existence, :user_id)\n  end\nend\n</code></pre>\n\n<p>I am lost right now \ud83d\ude44</p>\n"}, {"tags": [], "owner": {"reputation": 46, "user_id": 7137647, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d088b68fc5b49d6c6b5f27b88a18cc70?s=128&d=identicon&r=PG&f=1", "display_name": "Jayaram", "link": "https://stackoverflow.com/users/7137647/jayaram"}, "is_accepted": true, "score": 3, "last_activity_date": 1567282483, "creation_date": 1567282483, "answer_id": 57741322, "question_id": 57738834, "link": "https://stackoverflow.com/questions/57738834/no-route-matches-get-simulations/57741322#57741322", "title": "No route matches [GET] &quot;/simulations&quot;", "body": "<p>Remove \"url\" and \"method\" options in your simple_form call. Use as below</p>\n\n<pre><code>&lt;%= simple_form_for @simulation do |f| %&gt;\n</code></pre>\n\n<p>By default, simple_forms will use 'POST' http method for submitting the form.\nIn the error, I can see that it hits simulations/index endpoint because of 'GET' httpmethod.</p>\n\n<p>'POST' of /simulations will hit the create action in the controller.\nHope it works.</p>\n"}], "owner": {"reputation": 33, "user_id": 12003039, "user_type": "registered", "profile_image": "https://graph.facebook.com/10218174126520107/picture?type=large", "display_name": "Jennifer Stephan", "link": "https://stackoverflow.com/users/12003039/jennifer-stephan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 66, "favorite_count": 0, "accepted_answer_id": 57741322, "answer_count": 5, "score": 2, "last_activity_date": 1567410791, "creation_date": 1567261487, "last_edit_date": 1567262359, "question_id": 57738834, "link": "https://stackoverflow.com/questions/57738834/no-route-matches-get-simulations", "title": "No route matches [GET] &quot;/simulations&quot;", "body": "<p>I am really new to this forum and to code in general :)</p>\n\n<p>I am trying to create a little simulator in my ruby on rails app. \nI created a model that takes all the attributes to do the calculation and the final result of the simulation will be stored in an attribute of my User model.\nThe objective of the simulator: the user, a freelancer, enters all his enterprise infos, and gets to know at the end of the simulation, how many taxes he has to pay. \nI coded one of the possible path for now, in a \"set_result\" method for my Simulation class. </p>\n\n<p>All the attributes for the simulation are asked to the user via a simple form_for in the view and then the result of the simulation is calculated according to the user inputs to the form.\nmy model looks like this :</p>\n\n<pre><code>class Simulation &lt; ApplicationRecord\n  belongs_to :user\n\n  ACTIVITES = [\"liberale\", \"commerciale ou industrielle\", \"artisanale\"]\n  YEAREXISTENCE = [1, 2, 3, 4]\n\n  before_save :set_result\n\n  validates :activity, presence: true, inclusion: { in: ACTIVITES }\n  validates :year_existence, presence: true, inclusion: { in: YEAREXISTENCE }\n  validates :reglementary, presence: true\n  validates :accre, presence: true\n\n  def set_result\n    answer = params[:simulation]\n\n    if answer[:activity] == \"liberale\" &amp;&amp; answer[:year_existence] == 2 &amp;&amp; answer[:accre]\n      self.result = 0.12\n    else\n      self.result = 0.23\n    end\n  end\nend\n</code></pre>\n\n<p>my controller :</p>\n\n<pre><code>class SimulationsController &lt; ApplicationController\n  before_action :set_simulation, only: [:show, :edit, :update, :destroy, :set_tax_rate]\n\n  def new\n    @simulation = Simulation.new\n  end\n\n  def create\n    binding.pry\n    @simulation = Simulation.new(simulation_params)\n    if @simulation.save\n      render :show\n    else\n      render :new\n    end\n  end\n\n  private\n\n  def set_simulation\n    @simulation = Simulation.find(params[:id])\n  end\n\n  def simulation_params\n    params.require(:simulation).permit(:activity, :user_id)\n  end\nend\n</code></pre>\n\n<p>and my view where I put the simple_form_for and asking all the attributes necessary to simulate the result.</p>\n\n<pre><code>&lt;div class=\"container\"&gt;\n&lt;h1 class= \"structure ml-5\"&gt;simulation&lt;/h1&gt;\n&lt;/div&gt;\n\n&lt;!-- &lt;h1&gt;votre tx : &lt;%= @result %&gt;&lt;/h1&gt; --&gt;\n\n&lt;div class=\"row\"&gt;\n  &lt;div class=\"col-5\"&gt;\n    &lt;%= simple_form_for @simulation, root_path, method: :get do |f| %&gt;\n\n        &lt;%= f.input :activity,\n        label:\"Quelle est votre cat\u00e9gorie d'activit\u00e9 ?\",\n        collection: Simulation::ACTIVITES,\n        include_blank: true,\n        as: :select %&gt;\n\n        &lt;%= f.input :reglementary,\n        label:\"Est-ce une activit\u00e9 lib\u00e9rale r\u00e8glement\u00e9e ?\",\n        as: :boolean,\n        include_blank: true,\n        as: :select %&gt;\n\n        &lt;%= f.input :year_existence,\n        label:\"Quel est l'\u00e2ge de l'entreprise en ann\u00e9e d'activit\u00e9 ?\",\n        collection: Simulation::YEAREXISTENCE,\n        include_blank: true,\n        as: :select %&gt;\n\n        &lt;%= f.input :accre,\n        label:\"Avez-vous obtenu l'ACCRE lors de votre cr\u00e9ation d'entreprise ?\",\n        as: :boolean,\n        include_blank: true,\n        as: :select %&gt;\n\n      &lt;%= f.submit \"valider\", class: \"btn btn-primary\" %&gt;\n    &lt;% end %&gt;\n  &lt;/div&gt;\n&lt;/div&gt;\n``````````````\n\nI tried to \"binding.pry\" to see if the form gets me to the create action from the controller but it seems that it does not. \nWhen I get to the route : \"/simulations/new\", i can enter infos, but when i submit I have the error : \"No route matches [GET] \"/simulations\"\". As is I was redirecting my user to the \"index\" of simulations, which I don't think I did in my code...\n\nwhen I try to create a new simulation in my console by for example\n\nsimul = Simulation.new(activity: \"liberale\"...)\nsimul.user_id = User.last\n\nand then, trying to create it in my db :\n\nsimul.save\n\n\nI get this error :\n\n\"NameError: undefined local variable or method `params' for #&lt;Simulation:0x00007fcb6ea6f5b8&gt;\nfrom /Users/mac/.rbenv/versions/2.6.3/lib/ruby/gems/2.6.0/gems/activemodel-5.2.3/lib/active_model/attribute_methods.rb:430:in `method_missing\"\n\nof course, I removed all the raise and binding.pry before trying it :)\nanyone has an idea of what gets in the way of my simulation params ???\nI am not sure of the \"set_result\" method and especially how I called the params for simulation... maybe that's the problem. I tried to see in my previous apps, and seems that I did the same though...\n\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "ransack"], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 13136341, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/453ffc57d82ef959bcbefe4b3f9bdf5b?s=128&d=identicon&r=PG&f=1", "display_name": "user13136341", "link": "https://stackoverflow.com/users/13136341/user13136341"}, "is_accepted": false, "score": 0, "last_activity_date": 1592239907, "creation_date": 1592239907, "answer_id": 62393078, "question_id": 57738407, "link": "https://stackoverflow.com/questions/57738407/how-to-make-columns-from-joined-tables-available-in-ransack-attribute-field/62393078#62393078", "title": "How to make columns from joined tables available in Ransack attribute field?", "body": "<p>manifest.rb (define <code>ransackable_attributes</code> only for this model)</p>\n\n<pre><code>class Manifest &lt; ApplicationRecord\n  belongs_to :shipper\n  belongs_to :consignee\n  ...\n  private\n  def self.ransackable_attributes(auth_object = nil)\n    super - ['id', 'created_at', 'updated_at', 'consignee_id']\n  end\nend\n</code></pre>\n\n<p>consignee.rb (define <code>ransackable_attributes</code> for this model)</p>\n\n<pre><code>class Consignee &lt; ApplicationRecord\n  has_many :manifest, dependent: :destroy\n  ...\n  private\n  def self.ransackable_attributes(auth_object = nil)\n    if auth_object == :manifest_search\n      ['name']\n    else\n      super\n    end\n  end\nend\n</code></pre>\n\n<p>manifest_controller.rb</p>\n\n<pre><code>...\ndef index\n  @search = ransack_params\n  @search.build_grouping unless @search.groupings.any?\n  @manifests  = @search.result(distinct: true)\n  @search.build_condition\n...\n\nprivate\ndef ransack_params\n  Manifest.ransack(params[:q], auth_object: :manifest_search)\nend\n</code></pre>\n\n<p>index.html.erb (add the associations parameter to <code>attribute_select</code>)</p>\n\n<pre><code>&lt;%= search_form_for @search do |f| %&gt;\n  &lt;%= f.condition_fields do |c| %&gt;\n    &lt;div class=\"field\"&gt;\n      &lt;%= c.attribute_fields do |a| %&gt;\n        &lt;%= a.attribute_select :associations =&gt; [\"consignee\"] %&gt;\n      &lt;% end %&gt;\n      &lt;%= c.predicate_select :only =&gt; [:cont, :not_cont, :matches]%&gt;\n      &lt;%= c.value_fields do |v| %&gt;\n        &lt;%= v.text_field :value %&gt;\n      &lt;% end %&gt;\n    &lt;/div&gt;\n  &lt;% end %&gt;\n</code></pre>\n\n<p>note that the <code>auth_object</code> conditional is optional, but it allows you to have different search pages with different attributes. For example, the consignee page could have its own search form showing all of consignee's attributes, while the manifest search shows only the consignee name as a searchable attribute.</p>\n\n<p>I removed the <code>includes</code> to simplify the code; it's not required to make the search work.  If you need those associations pre-loaded, you can put it back in.</p>\n"}], "owner": {"reputation": 21, "user_id": 2084577, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d6dca37ec372639d0f7d3200f5062134?s=128&d=identicon&r=PG", "display_name": "user2084577", "link": "https://stackoverflow.com/users/2084577/user2084577"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 138, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1592239907, "creation_date": 1567258091, "last_edit_date": 1567258415, "question_id": 57738407, "link": "https://stackoverflow.com/questions/57738407/how-to-make-columns-from-joined-tables-available-in-ransack-attribute-field", "title": "How to make columns from joined tables available in Ransack attribute field?", "body": "<p>I want to display belongs_to relationship columns in ransackable attributes list. So that I can display them in the dropdown, and perform an advanced search on the (joined) table.\nHow can I do that?</p>\n\n<p>Below my model, where each manifest has one consignee. I've adjusted the attribute list, but when I select the consignee name it looks for 'manifest'.'name' and not in 'consignee'.'name' via a JOIN.\nWhen I use the simple search form, it works correctly. </p>\n\n<p>manifest.rb</p>\n\n<pre><code>class Manifest &lt; ApplicationRecord\n  belongs_to :shipper\n  belongs_to :consignee\n  ...\n  def self.ransackable_attributes(auth_object = nil)\n    super - ['id', 'created_at', 'updated_at', 'consignee_id']\n    super + ['consignee_name']\n  end\nend\n</code></pre>\n\n<p>consignee.rb</p>\n\n<pre><code>class Consignee &lt; ApplicationRecord\n  has_many :manifest, dependent: :destroy\n    ...\nend\n</code></pre>\n\n<p>manifest_controller.rb</p>\n\n<pre><code>...\ndef index\n    @search = ransack_params\n    @search.build_grouping unless @search.groupings.any?\n    @manifests  = @search.result(distinct: true)\n    @search.build_condition\n...\nprivate\n    def ransack_params\n        Manifest.includes(:vessel, :pod, :pol, :por, :del,  :consignee).ransack(params[:q])\n    end\nend\n</code></pre>\n\n<p>index.html.erb</p>\n\n<pre><code>&lt;%= search_form_for @search do |f| %&gt;\n  &lt;%= f.condition_fields do |c| %&gt;\n    &lt;div class=\"field\"&gt;\n      &lt;%= c.attribute_fields do |a| %&gt;\n        &lt;%= a.attribute_select %&gt;\n      &lt;% end %&gt;\n      &lt;%= c.predicate_select :only =&gt; [:cont, :not_cont, :matches]%&gt;\n      &lt;%= c.value_fields do |v| %&gt;\n        &lt;%= v.text_field :value %&gt;\n      &lt;% end %&gt;\n    &lt;/div&gt;\n  &lt;% end %&gt;\n</code></pre>\n\n<p>I expect to see Consignee Name in the dropdown list, but only see 'Name' at the bottom. When I select this and press search it returns with an error: </p>\n\n<pre><code>undefined method `type' for nil:NilClass \non line: Manifest.includes(:vessel, :pod, :pol, :por, :del, :consignee).ransack(params[:q])\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "global-variables", "grape"], "comments": [{"owner": {"reputation": 13378, "user_id": 1430810, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/v669u.jpg?s=128&g=1", "display_name": "arieljuod", "link": "https://stackoverflow.com/users/1430810/arieljuod"}, "edited": false, "score": 0, "creation_date": 1567267796, "post_id": 57737984, "comment_id": 101918362, "body": "Do you use redis on your site? you could save the values using redis, it&#39;s really fast, you don&#39;t have to mess with the database and it will be accessible from everywhere"}], "answers": [{"comments": [{"owner": {"reputation": 415, "user_id": 1163466, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/cef17ea14120975403802aff1650cb31?s=128&d=identicon&r=PG", "display_name": "DonRaHulk", "link": "https://stackoverflow.com/users/1163466/donrahulk"}, "edited": false, "score": 0, "creation_date": 1567261286, "post_id": 57738573, "comment_id": 101916738, "body": "hey thanks for you suggestion, but I am not allowed to create any entry in DB for this. But I will try the singleton class way you mentioned. Many thanks."}, {"owner": {"reputation": 7224, "user_id": 448934, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TXtux.jpg?s=128&g=1", "display_name": "Pascal", "link": "https://stackoverflow.com/users/448934/pascal"}, "edited": false, "score": 0, "creation_date": 1567338670, "post_id": 57738573, "comment_id": 101929373, "body": "Why would you not be allowed to store something in the DB?"}], "tags": [], "owner": {"reputation": 14340, "user_id": 2612259, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/70fec6995fdcaebf6362e10bd501f34f?s=128&d=identicon&r=PG", "display_name": "nPn", "link": "https://stackoverflow.com/users/2612259/npn"}, "is_accepted": false, "score": 1, "last_activity_date": 1567346110, "last_edit_date": 1567346110, "creation_date": 1567259363, "answer_id": 57738573, "question_id": 57737984, "link": "https://stackoverflow.com/questions/57737984/rails-global-variable-update-on-each-request-from-api/57738573#57738573", "title": "Rails Global Variable- Update on each request from API", "body": "<p>Ideally you would create a single object to hold these parameters sometime during startup, and then have that single instance injected into each class that needs them via some form of dependency injection,  but since I am unaware of any commonly used dependency injection scheme for rails, I am suggesting these two alternatives. </p>\n\n<p>Some people dislike singletons, but you could store these in a singleton class.</p>\n\n<pre><code>require 'singleton'\n\nclass APIParams\n  include Singleton\n  attr_accessor :v1, :v2\nend\n\nAPIParams.instance.v1 = 3\n\nputs APIParams.instance.v1 \n</code></pre>\n\n<p>It might be overkill but you could also create a model for them and store them in your database.  This might be useful if you have several resources that need to store the same set of variables,  like an <code>api_key</code> and or token for example.</p>\n\n<pre><code>class APIResource &lt; ActiveRecord::Base  \n   # you probably would want some `belongs_to`, has_a relationships here to associate these with the models used in your controllers.\nend\n</code></pre>\n\n<p>backed by a table with fields like</p>\n\n<pre><code>create_table \"api_resources\", force: :cascade do |t|\n  t.string  \"name\",\n  t.string  \"api_key\",\n  t.string  \"token\"\nend\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 415, "user_id": 1163466, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/cef17ea14120975403802aff1650cb31?s=128&d=identicon&r=PG", "display_name": "DonRaHulk", "link": "https://stackoverflow.com/users/1163466/donrahulk"}, "edited": false, "score": 0, "creation_date": 1567580577, "post_id": 57745747, "comment_id": 101999903, "body": "hey thanks for your opinion, I will store in redis and then use it. Wanted to know on the options available. Thanks again I am clear now."}], "tags": [], "owner": {"reputation": 7224, "user_id": 448934, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TXtux.jpg?s=128&g=1", "display_name": "Pascal", "link": "https://stackoverflow.com/users/448934/pascal"}, "is_accepted": false, "score": 1, "last_activity_date": 1567338653, "creation_date": 1567338653, "answer_id": 57745747, "question_id": 57737984, "link": "https://stackoverflow.com/questions/57737984/rails-global-variable-update-on-each-request-from-api/57745747#57745747", "title": "Rails Global Variable- Update on each request from API", "body": "<p>Global variables are a bad idea IMHO. This is more or less the same as a singleton.\nHow will you update the variable and who will do it? When? How will you check if expired? What if you have multiple ruby processes and they use different values? </p>\n\n<p>This sounds like a good use case for a cache and a service that reads from the cache.</p>\n\n<pre><code>class ParameterService\n  def get(parameter_name)\n    if parameter is not in cache or expired\n      read from external service and store in cache\n    end\n    return value from cache\n  end\nend\n</code></pre>\n\n<p>The cache could be something like Redis, a DB, Memcached.</p>\n"}], "owner": {"reputation": 415, "user_id": 1163466, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/cef17ea14120975403802aff1650cb31?s=128&d=identicon&r=PG", "display_name": "DonRaHulk", "link": "https://stackoverflow.com/users/1163466/donrahulk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 693, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1567346110, "creation_date": 1567254086, "question_id": 57737984, "link": "https://stackoverflow.com/questions/57737984/rails-global-variable-update-on-each-request-from-api", "title": "Rails Global Variable- Update on each request from API", "body": "<p>I have used GRAPE gem for creating API end point. </p>\n\n<p>For simple use case, let us consider that when my web service is hit, I hit a another third party REST API and I fetch few values and assign these values to one or two variables. for example variable1,variable2</p>\n\n<p>These values changes frequently from the third party API and so I have to keep updating the variable values also, all is fine when using it in the API code or passing it across methods as params.</p>\n\n<p>But I have few controllers where the updated variables should be taken/updated values to be taken.</p>\n\n<p>Currently what I do is :</p>\n\n<pre><code>class Api &lt; Grape::API     \n version 'v1'\n format :json\n helpers MyProject::Config\n\nresources :foo do      \n  get do\n    variable1 = #hit third party URL\n    $global_variable1 = variable1\n  end\n end\nend\n</code></pre>\n\n<p>In Controller:</p>\n\n<pre><code> class SampleController &lt; ApplicationController\n   def method()\n     some_calc = $global_variable1 + other_variable\n   end\n end\n</code></pre>\n\n<p>Now this works fine, is there any better way to make use other than global variable ?\nOr can we do like this :</p>\n\n<pre><code>Rails.application.config.variable1 = variable1\n</code></pre>\n\n<p>Which is the better way to go forward ?</p>\n\n<p>I tried setting @instance variable like this in the API class, but this gives empty string when accessing it in controller methods.</p>\n\n<pre><code>@variable1 = \"\"\ndef self.variable1\n  @variable1\nend\n</code></pre>\n\n<p>and accessing it like ClassName.variable1</p>\n\n<p>can any one please suggest better way forward ?</p>\n"}, {"tags": ["ruby", "sinatra"], "comments": [{"owner": {"reputation": 299, "user_id": 3251036, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4b88d9e964e6d6500c8d511cde831486?s=128&d=identicon&r=PG&f=1", "display_name": "sammygadd", "link": "https://stackoverflow.com/users/3251036/sammygadd"}, "edited": false, "score": 0, "creation_date": 1567251106, "post_id": 57736564, "comment_id": 101914296, "body": "I just tested the code that you showed and it works just as expected (with or without the halt (which of course shouldn&#39;t matter since we supply a token and don&#39;t get there)). So please add some more info about what you are doing if you what help solving this."}, {"owner": {"reputation": 1429, "user_id": 464538, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/736aec16f008a1fc6397bf26c6a9be46?s=128&d=identicon&r=PG", "display_name": "Klian", "link": "https://stackoverflow.com/users/464538/klian"}, "reply_to_user": {"reputation": 299, "user_id": 3251036, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4b88d9e964e6d6500c8d511cde831486?s=128&d=identicon&r=PG&f=1", "display_name": "sammygadd", "link": "https://stackoverflow.com/users/3251036/sammygadd"}, "edited": false, "score": 0, "creation_date": 1567263862, "post_id": 57736564, "comment_id": 101917406, "body": "Thanks for your reply, I think the problem is with my CORs configuration... I&#39;m digging into it"}, {"owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 0, "creation_date": 1567277626, "post_id": 57736564, "comment_id": 101920638, "body": "I recommend putting a breakpoint in there to invesigate what&#39;s going on"}], "owner": {"reputation": 1429, "user_id": 464538, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/736aec16f008a1fc6397bf26c6a9be46?s=128&d=identicon&r=PG", "display_name": "Klian", "link": "https://stackoverflow.com/users/464538/klian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 37, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1567242343, "creation_date": 1567241813, "last_edit_date": 1567242343, "question_id": 57736564, "link": "https://stackoverflow.com/questions/57736564/weird-behaviour-with-sinatra-before-block-checking-http-headers", "title": "Weird behaviour with Sinatra &quot;before&quot; block checking http headers", "body": "<p>I'm making an API with Sinatra, the application it's working fine, but I've found and error and I don't know how to solve it.</p>\n\n<p>I'm making a GET request from my frontend, sending a token via HTTP Headers, I want to protect a route and I'm doing it with a before block. </p>\n\n<p>Here is my code:</p>\n\n<pre><code>before do\n\n    content_type :json\n    response['Access-Control-Allow-Origin'] = '*'\n    token = request.env['HTTP_MY_TOKEN']\n    p \"TOKEN: 1\" \n    p token\n\n    protected_routes = [\"/link/all\", \"link/create\"]\n    if(protected_routes.include?(request.path_info))\n        p \"TOKEN: 2\" \n        p token\n        if !token\n            p \"TOKEN: 3\" \n            p token\n            halt 401, { 'Content-Type' =&gt; 'application/json' }, { error: 'Error, No token provided' }.to_json\n        end\n    end\n\n\nend\n</code></pre>\n\n<p>The output is: </p>\n\n<pre><code>\"TOKEN: 1\"\nnil\n\"TOKEN: 2\"\nnil\n\"TOKEN: 3\"\nnil\n</code></pre>\n\n<p>But If I comment the \"halt\" line, the output is:</p>\n\n<pre><code>\"TOKEN: 1\"\n\"eyJhbG12cidaasOiJaqIUzI1NiJ9.eyJleHAiOjE1Njg0....\"\n\"TOKEN: 2\"\n\"eyJhbG12cidaasOiJaqIUzI1NiJ9.eyJleHAiOjE1Njg0....\"\n</code></pre>\n\n<p>What is the problem with my code ?</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "nokogiri"], "answers": [{"comments": [{"owner": {"reputation": 155, "user_id": 11275951, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-rf5rkzAdl-w/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rc7MG5-Mv5n_nvI4SttLdHLis7CSQ/mo/photo.jpg?sz=128", "display_name": "Amani Saaduddin", "link": "https://stackoverflow.com/users/11275951/amani-saaduddin"}, "edited": false, "score": 0, "creation_date": 1567326694, "post_id": 57736378, "comment_id": 101927071, "body": "Thanks, but I&#39;ve tried all these and none worked for me."}, {"owner": {"reputation": 7944, "user_id": 10907864, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/tGpcY.jpg?s=128&g=1", "display_name": "Promise Preston", "link": "https://stackoverflow.com/users/10907864/promise-preston"}, "reply_to_user": {"reputation": 155, "user_id": 11275951, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-rf5rkzAdl-w/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rc7MG5-Mv5n_nvI4SttLdHLis7CSQ/mo/photo.jpg?sz=128", "display_name": "Amani Saaduddin", "link": "https://stackoverflow.com/users/11275951/amani-saaduddin"}, "edited": false, "score": 0, "creation_date": 1567337390, "post_id": 57736378, "comment_id": 101929165, "body": "I just edited my answer. Try it out to see if it helps."}], "tags": [], "owner": {"reputation": 7944, "user_id": 10907864, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/tGpcY.jpg?s=128&g=1", "display_name": "Promise Preston", "link": "https://stackoverflow.com/users/10907864/promise-preston"}, "is_accepted": false, "score": 0, "last_activity_date": 1581686332, "last_edit_date": 1581686332, "creation_date": 1567239763, "answer_id": 57736378, "question_id": 57736330, "link": "https://stackoverflow.com/questions/57736330/error-installing-rails-5-2-3-on-ubuntu-18-04/57736378#57736378", "title": "Error Installing Rails 5.2.3 on Ubuntu 18.04", "body": "<p>I just looked at your terminal log and realized that you are using <strong>RVM (Ruby version manager)</strong> as your <strong>ruby manager</strong>. The catch here is that <strong>RVM</strong> seems to be heavyweight as it manages not just your <code>ruby version</code> but also your <code>ruby gems</code>. A better option for you should be to use <strong>rbenv (Ruby environment)</strong>, which manages just your <code>ruby version</code> and <strong>Bundler</strong> which manages <strong>ruby gems</strong>.</p>\n\n<p>This way you will rarely run into conflicts where <strong>RVM</strong> and <strong>Bundler</strong> will be doing the same thing (managing your <code>ruby gems</code>), since rails installation depends on <strong>Bundler</strong>.</p>\n\n<p>Here's a simple command built-in that will remove <strong>RVM</strong> and its related directories from your system:</p>\n\n<pre><code>rvm implode\n</code></pre>\n\n<p>In order to remove the final trace of rvm, you need to remove the rvm gem, too:</p>\n\n<pre><code>gem uninstall rvm\n</code></pre>\n\n<p>If you've made modifications to your <code>PATH</code> you might want to pull those, too. Check your <code>.bashrc</code>, <code>.profile</code> and <code>.bash_profile</code> files, among other things.</p>\n\n<p>You may also have an <code>/etc/rvmrc</code> file, or one in your home directory <code>~/.rvmrc</code> that may need to be removed as well.</p>\n\n<p>When you are done with the removal of <strong>RVM</strong> and all of its files and directories, follow this guide <a href=\"https://www.digitalocean.com/community/tutorials/how-to-install-ruby-on-rails-with-rbenv-on-ubuntu-18-04\" rel=\"nofollow noreferrer\">How To Install Ruby on Rails with rbenv on Ubuntu 18.04</a> to install a fresh copy of <strong>Ruby on Rails</strong> with <strong>rbenv</strong> on your Ubuntu machine.</p>\n\n<p>If you still run into any issue relating to bundler while using <strong>rbenv</strong>, simply follow the instruction below:</p>\n\n<p>You need to simply install an update for RubyGems Package Manager locally. To do this, run</p>\n\n<pre><code>gem update --system\n</code></pre>\n\n<p>If you don't have bundler version 2 installed locally, then run</p>\n\n<pre><code>gem install bundler\n</code></pre>\n\n<p>And then finally run</p>\n\n<pre><code>bundler update --bundler\n</code></pre>\n\n<p>That's all.</p>\n\n<p><strong>I hope this helps.</strong></p>\n"}], "owner": {"reputation": 155, "user_id": 11275951, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-rf5rkzAdl-w/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rc7MG5-Mv5n_nvI4SttLdHLis7CSQ/mo/photo.jpg?sz=128", "display_name": "Amani Saaduddin", "link": "https://stackoverflow.com/users/11275951/amani-saaduddin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 689, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1581686332, "creation_date": 1567239330, "last_edit_date": 1581290807, "question_id": 57736330, "link": "https://stackoverflow.com/questions/57736330/error-installing-rails-5-2-3-on-ubuntu-18-04", "title": "Error Installing Rails 5.2.3 on Ubuntu 18.04", "body": "<p>I'm trying to install Rails 5.2.3 on Ubuntu 18.04 PC using Ruby version -2.5.5 and during the installation I'm facing this error.</p>\n\n<pre><code>$ gem install rails -v 5.2.3\n\nBuilding native extensions. This could take a while...\nERROR:  Error installing rails:\n    ERROR: Failed to build gem native extension.\n\n    current directory: /home/amani/.rvm/gems/ruby-2.5.5/gems/nokogiri-1.10.4/ext/nokogiri\n/home/amani/.rvm/rubies/ruby-2.5.5/bin/ruby -I /home/amani/.rvm/rubies/ruby-2.5.5/lib/ruby/site_ruby/2.5.0 -r ./siteconf20190831-23754-eu6kq8.rb extconf.rb\nchecking if the C compiler accepts ... *** extconf.rb failed ***\nCould not create Makefile due to some reason, probably lack of necessary\nlibraries and/or headers.  Check the mkmf.log file for more details.  You may\nneed configuration options.\n\nProvided configuration options:\n    --with-opt-dir\n    --without-opt-dir\n    --with-opt-include\n    --without-opt-include=${opt-dir}/include\n    --with-opt-lib\n    --without-opt-lib=${opt-dir}/lib\n    --with-make-prog\n    --without-make-prog\n    --srcdir=.\n    --curdir\n    --ruby=/home/amani/.rvm/rubies/ruby-2.5.5/bin/$(RUBY_BASE_NAME)\n    --help\n    --clean\n/home/amani/.rvm/rubies/ruby-2.5.5/lib/ruby/2.5.0/mkmf.rb:456:in `try_do': The compiler failed to generate an executable file. (RuntimeError)\nYou have to install development tools first.\n    from /home/amani/.rvm/rubies/ruby-2.5.5/lib/ruby/2.5.0/mkmf.rb:574:in `block in try_compile'\n    from /home/amani/.rvm/rubies/ruby-2.5.5/lib/ruby/2.5.0/mkmf.rb:521:in `with_werror'\n    from /home/amani/.rvm/rubies/ruby-2.5.5/lib/ruby/2.5.0/mkmf.rb:574:in `try_compile'\n    from extconf.rb:138:in `nokogiri_try_compile'\n    from extconf.rb:162:in `block in add_cflags'\n    from /home/amani/.rvm/rubies/ruby-2.5.5/lib/ruby/2.5.0/mkmf.rb:632:in `with_cflags'\n    from extconf.rb:161:in `add_cflags'\n    from extconf.rb:416:in `&lt;main&gt;'\n</code></pre>\n\n<p>To see why this extension failed to compile, please check the mkmf.log which can be found here:</p>\n\n<pre><code>  /home/amani/.rvm/gems/ruby-2.5.5/extensions/x86_64-linux/2.5.0/nokogiri-1.10.4/mkmf.log\n\nextconf failed, exit code 1\n\nGem files will remain installed in /home/amani/.rvm/gems/ruby-2.5.5/gems/nokogiri-1.10.4 for inspection.\nResults logged to /home/amani/.rvm/gems/ruby-2.5.5/extensions/x86_64-linux/2.5.0/nokogiri-1.10.4/gem_make.out\n</code></pre>\n\n<p>These are the error messages on terminal.</p>\n"}]