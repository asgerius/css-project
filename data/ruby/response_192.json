[{"tags": ["ruby-on-rails", "ruby", "leaflet", "maps"], "comments": [{"owner": {"reputation": 26120, "user_id": 219883, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/c35b5b0f9e7cce48864f4f1545ead995?s=128&d=identicon&r=PG", "display_name": "Taryn East", "link": "https://stackoverflow.com/users/219883/taryn-east"}, "edited": false, "score": 0, "creation_date": 1536794930, "post_id": 52304721, "comment_id": 91556930, "body": "The error is telling you that it can&#39;t find a <code>Toilet</code> via <code>Toilet.all[0]</code> (because it&#39;s nil). Can you gives us a bit more info on what you&#39;re trying to do there? What happens if you try: <code>Toilet.first</code> instead? Can you confirm there are actually Toilets in the db yet? If not - you may need to put <code>if Toilet.count &gt; 0</code> on the end of that line"}, {"owner": {"reputation": 26120, "user_id": 219883, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/c35b5b0f9e7cce48864f4f1545ead995?s=128&d=identicon&r=PG", "display_name": "Taryn East", "link": "https://stackoverflow.com/users/219883/taryn-east"}, "edited": false, "score": 0, "creation_date": 1536795090, "post_id": 52304721, "comment_id": 91556980, "body": "Actually... is <code>toilet_available</code> a scope on your <code>Store</code> model? if so you probably really want to write something like: <code>Store.toilet_available.first</code> instead."}, {"owner": {"reputation": 26120, "user_id": 219883, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/c35b5b0f9e7cce48864f4f1545ead995?s=128&d=identicon&r=PG", "display_name": "Taryn East", "link": "https://stackoverflow.com/users/219883/taryn-east"}, "edited": false, "score": 0, "creation_date": 1536795171, "post_id": 52304721, "comment_id": 91557002, "body": "Note: I&#39;m having to guess what you mean as you haven&#39;t added any actual code to your question ;)  Could you edit your question and add the <code>Toilet</code> and <code>Store</code> models as well as the <code>stores</code> route from your routes file?"}, {"owner": {"reputation": 31, "user_id": 9067058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6101491b055c936e423ac6d5a076ec4e?s=128&d=identicon&r=PG&f=1", "display_name": "catinahat", "link": "https://stackoverflow.com/users/9067058/catinahat"}, "reply_to_user": {"reputation": 26120, "user_id": 219883, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/c35b5b0f9e7cce48864f4f1545ead995?s=128&d=identicon&r=PG", "display_name": "Taryn East", "link": "https://stackoverflow.com/users/219883/taryn-east"}, "edited": false, "score": 0, "creation_date": 1536796128, "post_id": 52304721, "comment_id": 91557187, "body": "<code>stores_path(toilet: Toilet.toilet_available.first)</code> throws a no method error in development"}, {"owner": {"reputation": 31, "user_id": 9067058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6101491b055c936e423ac6d5a076ec4e?s=128&d=identicon&r=PG&f=1", "display_name": "catinahat", "link": "https://stackoverflow.com/users/9067058/catinahat"}, "reply_to_user": {"reputation": 26120, "user_id": 219883, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/c35b5b0f9e7cce48864f4f1545ead995?s=128&d=identicon&r=PG", "display_name": "Taryn East", "link": "https://stackoverflow.com/users/219883/taryn-east"}, "edited": false, "score": 0, "creation_date": 1536796979, "post_id": 52304721, "comment_id": 91557349, "body": "<code>toilet_available</code> in the Toilet model should have two options &quot;yes&quot; and &quot;no&quot;. But neither option shows in the view when I try to select one when creating a new store. This isn&#39;t the case in development - I am able to select &quot;yes&quot; or &quot;no&quot; and create the store. I&#39;m wondering if it&#39;s some kind of postgres related problem, as everything is working fine in development."}, {"owner": {"reputation": 31, "user_id": 9067058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6101491b055c936e423ac6d5a076ec4e?s=128&d=identicon&r=PG&f=1", "display_name": "catinahat", "link": "https://stackoverflow.com/users/9067058/catinahat"}, "reply_to_user": {"reputation": 26120, "user_id": 219883, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/c35b5b0f9e7cce48864f4f1545ead995?s=128&d=identicon&r=PG", "display_name": "Taryn East", "link": "https://stackoverflow.com/users/219883/taryn-east"}, "edited": false, "score": 0, "creation_date": 1536799728, "post_id": 52304721, "comment_id": 91557836, "body": "@TarynEast Have added the code for the models and the link to the repo"}, {"owner": {"reputation": 26120, "user_id": 219883, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/c35b5b0f9e7cce48864f4f1545ead995?s=128&d=identicon&r=PG", "display_name": "Taryn East", "link": "https://stackoverflow.com/users/219883/taryn-east"}, "edited": false, "score": 0, "creation_date": 1536803671, "post_id": 52304721, "comment_id": 91558522, "body": "Ok, I&#39;m still not sure what you&#39;re trying to do with the <code>stores_path</code> here... in a <code>path</code> method, you are creating a URL and with something like <code>stores_path(toilet: thing)</code> I&#39;d be expecting you to be passing an actual toilet object in <code>thing</code>. Not a string value of an individual toilet (which is what <code>toilet_available</code> is), an actual instance of a Toilet object... that&#39;s why I&#39;d like to see the relevant routing code :)"}, {"owner": {"reputation": 26120, "user_id": 219883, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/c35b5b0f9e7cce48864f4f1545ead995?s=128&d=identicon&r=PG", "display_name": "Taryn East", "link": "https://stackoverflow.com/users/219883/taryn-east"}, "edited": false, "score": 0, "creation_date": 1536803776, "post_id": 52304721, "comment_id": 91558543, "body": "Looking at your routes file it&#39;s even simpler than that. you are using the generic <code>stores</code> route... you haven&#39;t told Rails how to generate a route that takes a toilet object. So it doesn&#39;t know what that is for and is just ignoring it. you can write <code>stores_path</code> but it literally has no clue what you mean by <code>stores_path(toilet: anything)</code>... so even if you go this code not to error - it isn&#39;t doing what you think it&#39;s doing. You can&#39;t pass a toilet to the <code>stores_path</code> method unless you specify the toilet in the route."}, {"owner": {"reputation": 26120, "user_id": 219883, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/c35b5b0f9e7cce48864f4f1545ead995?s=128&d=identicon&r=PG", "display_name": "Taryn East", "link": "https://stackoverflow.com/users/219883/taryn-east"}, "edited": false, "score": 0, "creation_date": 1536803815, "post_id": 52304721, "comment_id": 91558550, "body": "Also - if you tell me that creating a Toilet model is breaking instead of selecting yes/no? that confuses me... can you show me the relevant code that does this in the html-form and the controller? Words are ambiguous and while it&#39;s clear to you what you mean, it isn&#39;t clear to me :)"}, {"owner": {"reputation": 31, "user_id": 9067058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6101491b055c936e423ac6d5a076ec4e?s=128&d=identicon&r=PG&f=1", "display_name": "catinahat", "link": "https://stackoverflow.com/users/9067058/catinahat"}, "reply_to_user": {"reputation": 26120, "user_id": 219883, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/c35b5b0f9e7cce48864f4f1545ead995?s=128&d=identicon&r=PG", "display_name": "Taryn East", "link": "https://stackoverflow.com/users/219883/taryn-east"}, "edited": false, "score": 0, "creation_date": 1536855123, "post_id": 52304721, "comment_id": 91582851, "body": "Ooookay, eventually found a solution. On the production (pg) side I hadn&#39;t added anything into the Toilet table. I needed to run <code>heroku run rails console</code> and then <code>Toilet.create(toilet_available = &quot;yes&quot;)</code> and <code>Toilet.create(toilet_available = &quot;no&quot;)</code>. Thanks for all the suggestions and sorry for my ambigious and slightly incoherent questions!"}, {"owner": {"reputation": 26120, "user_id": 219883, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/c35b5b0f9e7cce48864f4f1545ead995?s=128&d=identicon&r=PG", "display_name": "Taryn East", "link": "https://stackoverflow.com/users/219883/taryn-east"}, "edited": false, "score": 0, "creation_date": 1536907097, "post_id": 52304721, "comment_id": 91599337, "body": "All good! I&#39;m glad you found a solution :D"}], "answers": [{"comments": [{"owner": {"reputation": 31, "user_id": 9067058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6101491b055c936e423ac6d5a076ec4e?s=128&d=identicon&r=PG&f=1", "display_name": "catinahat", "link": "https://stackoverflow.com/users/9067058/catinahat"}, "edited": false, "score": 0, "creation_date": 1536850799, "post_id": 52305789, "comment_id": 91580396, "body": "I don&#39;t understand. You say I haven&#39;t defined <code>toilet_available</code> but then say &quot;you defined it as a text that you are intending to store <code>yes</code> or <code>no</code>&quot;"}, {"owner": {"reputation": 5292, "user_id": 2727267, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/0e7c773908a4f6095f63cb9553bbc7af?s=128&d=identicon&r=PG", "display_name": "Beartech", "link": "https://stackoverflow.com/users/2727267/beartech"}, "reply_to_user": {"reputation": 31, "user_id": 9067058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6101491b055c936e423ac6d5a076ec4e?s=128&d=identicon&r=PG&f=1", "display_name": "catinahat", "link": "https://stackoverflow.com/users/9067058/catinahat"}, "edited": false, "score": 0, "creation_date": 1536941019, "post_id": 52305789, "comment_id": 91618182, "body": "Edited my answer. Still not fully understanding your intent."}, {"owner": {"reputation": 5292, "user_id": 2727267, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/0e7c773908a4f6095f63cb9553bbc7af?s=128&d=identicon&r=PG", "display_name": "Beartech", "link": "https://stackoverflow.com/users/2727267/beartech"}, "reply_to_user": {"reputation": 31, "user_id": 9067058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6101491b055c936e423ac6d5a076ec4e?s=128&d=identicon&r=PG&f=1", "display_name": "catinahat", "link": "https://stackoverflow.com/users/9067058/catinahat"}, "edited": false, "score": 0, "creation_date": 1536946317, "post_id": 52305789, "comment_id": 91620682, "body": "Also reference this: <a href=\"https://stackoverflow.com/questions/15047745/how-to-implement-yes-no-instead-of-boolean-for-certain-cases-in-rails\" title=\"how to implement yes no instead of boolean for certain cases in rails\">stackoverflow.com/questions/15047745/&hellip;</a>   and this: <a href=\"https://stackoverflow.com/questions/3664181/rails-or-ruby-yes-no-instead-of-true-false\" title=\"rails or ruby yes no instead of true false\">stackoverflow.com/questions/3664181/&hellip;</a>"}], "tags": [], "owner": {"reputation": 5292, "user_id": 2727267, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/0e7c773908a4f6095f63cb9553bbc7af?s=128&d=identicon&r=PG", "display_name": "Beartech", "link": "https://stackoverflow.com/users/2727267/beartech"}, "is_accepted": false, "score": 0, "last_activity_date": 1536946068, "last_edit_date": 1536946068, "creation_date": 1536805358, "answer_id": 52305789, "question_id": 52304721, "link": "https://stackoverflow.com/questions/52304721/why-wont-my-rails-app-work-when-pushing-to-heroku-actionviewtemplateerror/52305789#52305789", "title": "Why won&#39;t my rails app work when pushing to Heroku: &quot;ActionView::Template::Error (undefined method `toilet_available&#39; for nil:NilClass)&quot;?", "body": "<p>Sorry, I misinterpreted what you were trying to do. I think that even though you are no longer getting the error, you are still not getting the answer you intend to get. You are using a very non-standard way to have a boolean column. On the rails console do this:</p>\n\n<pre><code>t = Toilet.first\nt.toilet_available\n</code></pre>\n\n<p>and look at the return value. Regardless of \"yes\" or \"no\" you are getting a value. So if this:</p>\n\n<pre><code>Toilet.all[0].toilet_available\n</code></pre>\n\n<p>is supposed to mean: \"get all toilets and take the first one where available = yes\" that is NOT what is happening. A DB column defined as the type of <code>String</code> with a \"yes\" or \"no\" is not a boolean and will not act like one without defining a method to interpret it like:</p>\n\n<pre><code>def has_toilet\n  self.toilet_available == \"yes\" ? true : false\nend\n</code></pre>\n\n<p>I think what you are getting with your <code>Toilet.all[0].toilet_available</code> is \"Get all toilets and take the first one of the results and return the text in column toilet_available regardless if that text is <code>true</code> or <code>false</code>\". But if your intent is \"get me the first toilet whose availability is <code>true</code>\" then your code is wrong. </p>\n\n<p>Here is a simple test to use in your development DB where you have plenty of records. In the Rails console do this:</p>\n\n<pre><code>puts Toilet.all[0]\nputs Toilet.all.first\nputs Toilet.where(toilet_available: 'yes').limit(1)\nputs Toilet.find_by(toilet_available: 'yes')\n</code></pre>\n\n<p>They may not all return the same result. The pattern of <code>.all[0]</code> is IMHO a bad way of getting something out of the DB as it is very ambiguous. </p>\n\n<p>Also do this in the console:</p>\n\n<pre><code>Toilet.all.each do |t|\n  puts \"toilet_available is #{t.toilet_available} and is #{t.toilet_available ? true : false}\nend\n</code></pre>\n\n<p>You should see something like:</p>\n\n<pre><code>toilet_available is yes and is true\ntoilet_available is no and is true\n</code></pre>\n\n<p>The point being that in Rails having a text value in a text column results in it being \"true\". The only way to get a false would be for the value to be <code>nil</code>. If <code>toilet_available</code> will only ever have two states then a boolean column type would be more appropriate and what other developers will tend to expect. If the value could be three states like \"yes\", \"no\", \"unknown\" then you could use a column with a state machine.</p>\n"}], "owner": {"reputation": 31, "user_id": 9067058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6101491b055c936e423ac6d5a076ec4e?s=128&d=identicon&r=PG&f=1", "display_name": "catinahat", "link": "https://stackoverflow.com/users/9067058/catinahat"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 61, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1536946068, "creation_date": 1536794677, "last_edit_date": 1536795795, "question_id": 52304721, "link": "https://stackoverflow.com/questions/52304721/why-wont-my-rails-app-work-when-pushing-to-heroku-actionviewtemplateerror", "title": "Why won&#39;t my rails app work when pushing to Heroku: &quot;ActionView::Template::Error (undefined method `toilet_available&#39; for nil:NilClass)&quot;?", "body": "<p>I'm building a store locator app in Rails 5 that uses the Open Street Map API and leaflet-rails gem. Everything works as expected in development environment but when I push to Heroku I get the \"We're sorry, but something went wrong.\" message. I created a function where you can sort stores by whether they have a toilet or not and this seams to be where the problem lies. The Heroku logs show the following:</p>\n\n<pre><code>2018-09-12T22:02:39.751563+00:00 app[web.1]: [30a84d17-6a5a-4b3d-b21f-ee08babfd123] Completed 500 Internal Server Error in 624ms (ActiveRecord: 119.5ms)\n2018-09-12T22:02:39.706503+00:00 app[web.1]: [30a84d17-6a5a-4b3d-b21f-ee08babfd123]   Toilet Load (29.5ms)  SELECT \"toilets\".* FROM \"toilets\"\n2018-09-12T22:02:39.772904+00:00 app[web.1]: [30a84d17-6a5a-4b3d-b21f-ee08babfd123]\n2018-09-12T22:02:39.773276+00:00 app[web.1]: [30a84d17-6a5a-4b3d-b21f-ee08babfd123]     29:                                             &lt;li&gt;&lt;%= link_to \"Log In\", new_user_session_path %&gt; &lt;/li&gt;\n2018-09-12T22:02:39.772915+00:00 app[web.1]: [30a84d17-6a5a-4b3d-b21f-ee08babfd123] ActionView::Template::Error (undefined method `toilet_available' for nil:NilClass):\n2018-09-12T22:02:39.773280+00:00 app[web.1]: [30a84d17-6a5a-4b3d-b21f-ee08babfd123]     30:                                             &lt;li&gt;&lt;%= link_to \"Add Spaeti\", new_user_registration_path %&gt; &lt;/li&gt;\n2018-09-12T22:02:39.773283+00:00 app[web.1]: [30a84d17-6a5a-4b3d-b21f-ee08babfd123]     31:                                     &lt;% end %&gt;\n2018-09-12T22:02:39.773285+00:00 app[web.1]: [30a84d17-6a5a-4b3d-b21f-ee08babfd123]     32:                                     &lt;li&gt;&lt;%= link_to \"Spaetis with toilets\", stores_path(toilet: Toilet.all[0].toilet_available) %&gt;&lt;/li&gt;\n2018-09-12T22:02:39.773288+00:00 app[web.1]: [30a84d17-6a5a-4b3d-b21f-ee08babfd123]     33:                             &lt;/ul&gt;\n2018-09-12T22:02:39.773290+00:00 app[web.1]: [30a84d17-6a5a-4b3d-b21f-ee08babfd123]     34:                     &lt;/div&gt;\n2018-09-12T22:02:39.773292+00:00 app[web.1]: [30a84d17-6a5a-4b3d-b21f-ee08babfd123]     35:             &lt;/nav&gt;\n2018-09-12T22:02:39.773336+00:00 app[web.1]: [30a84d17-6a5a-4b3d-b21f-ee08babfd123]\n2018-09-12T22:02:39.773423+00:00 app[web.1]: [30a84d17-6a5a-4b3d-b21f-ee08babfd123] app/views/layouts/application.html.erb:32:in `_app_views_layouts_application_html_erb__2166090761148733231_41993540'\n</code></pre>\n\n<p>When I remove this line from the view the app loads fine: <code>&lt;li&gt;&lt;%= link_to \"Spaetis with toilets\", stores_path(toilet: Toilet.all[0].toilet_available) %&gt;&lt;/li&gt;</code></p>\n\n<p>What could be causing this error? I've been tearing my hair out for a good few days now...</p>\n\n<p>Store Model:</p>\n\n<pre><code>class Store &lt; ApplicationRecord\n    belongs_to :user\n    belongs_to :toilet\n\n    validates :name, presence: true\n    validates :address, presence: true\n    validates :address_line2, presence: true\n    validates :address_line3, presence: true\n    validates :toilet, presence: true\n    # validates :latitude, presence: true\n    # validates :longitude, presence: true\n    validates :beer_cost, format: { with: /\\A\\d+(?:\\.\\d{0,2})?\\z/ }, numericality: { greater_than: 0, less_than: 10 }\n    validates :latitude, :presence =&gt; {message: \"Not a valid location, please check name address &amp; country fields\" }\n\n    def full_address\n      [address, address_line2, address_line3].compact.join(', ')\n    end\n    geocoded_by :full_address\n    before_validation :geocode,\n      :if =&gt; lambda{ |obj| obj.address_changed? }\n\n    def capitalize_name\n        name.capitalize\n    end\n\n    def capitalize_address\n        address.capitalize\n    end\nend\n</code></pre>\n\n<p>Toilet Model:</p>\n\n<pre><code>class Toilet &lt; ApplicationRecord\n    has_many :stores\nend\n</code></pre>\n\n<p>Schema.rb:</p>\n\n<pre><code>ActiveRecord::Schema.define(version: 20180814220216) do\n\n  create_table \"stores\", force: :cascade do |t|\n    t.string \"name\"\n    t.string \"address\"\n    t.float \"beer_cost\"\n    t.text \"facilities\"\n    t.datetime \"created_at\", null: false\n    t.datetime \"updated_at\", null: false\n    t.float \"latitude\"\n    t.float \"longitude\"\n    t.boolean \"toilet\"\n    t.string \"address_line2\"\n    t.integer \"user_id\"\n    t.integer \"toilet_id\"\n    t.string \"address_line3\"\n  end\n\n  create_table \"toilets\", force: :cascade do |t|\n    t.string \"toilet_available\"\n    t.datetime \"created_at\", null: false\n    t.datetime \"updated_at\", null: false\n  end\n\n  create_table \"users\", force: :cascade do |t|\n    t.string \"email\", default: \"\", null: false\n    t.string \"encrypted_password\", default: \"\", null: false\n    t.string \"reset_password_token\"\n    t.datetime \"reset_password_sent_at\"\n    t.datetime \"remember_created_at\"\n    t.integer \"sign_in_count\", default: 0, null: false\n    t.datetime \"current_sign_in_at\"\n    t.datetime \"last_sign_in_at\"\n    t.string \"current_sign_in_ip\"\n    t.string \"last_sign_in_ip\"\n    t.datetime \"created_at\", null: false\n    t.datetime \"updated_at\", null: false\n    t.index [\"email\"], name: \"index_users_on_email\", unique: true\n    t.index [\"reset_password_token\"], name: \"index_users_on_reset_password_token\", unique: true\n  end\n\nend\n</code></pre>\n\n<p>Github repo: <a href=\"https://github.com/catsinspacesuits/Spaeti-App\" rel=\"nofollow noreferrer\">https://github.com/catsinspacesuits/Spaeti-App</a></p>\n"}, {"tags": ["ruby", "windows", "rubygems"], "comments": [{"owner": {"reputation": 5292, "user_id": 2727267, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/0e7c773908a4f6095f63cb9553bbc7af?s=128&d=identicon&r=PG", "display_name": "Beartech", "link": "https://stackoverflow.com/users/2727267/beartech"}, "edited": false, "score": 0, "creation_date": 1536812283, "post_id": 52304291, "comment_id": 91560338, "body": "Can you ping <code>https:&#47;&#47;rubygems.org</code>? Can you ping Google?"}, {"owner": {"reputation": 653, "user_id": 7148414, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KMhlJ.jpg?s=128&g=1", "display_name": "baseballlover723", "link": "https://stackoverflow.com/users/7148414/baseballlover723"}, "edited": false, "score": 0, "creation_date": 1536873788, "post_id": 52304291, "comment_id": 91591584, "body": "try restarting your computer. I think this happened to me when I canceled turning off my computer. Restarting my windows computer fixed it for me"}, {"owner": {"reputation": 77, "user_id": 3369850, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/5256c0f99ca37da4eb7321e7524d1225?s=128&d=identicon&r=PG&f=1", "display_name": "user3369850", "link": "https://stackoverflow.com/users/3369850/user3369850"}, "edited": false, "score": 0, "creation_date": 1536875551, "post_id": 52304291, "comment_id": 91592122, "body": "This is the result of me pinging api.rubygems.org  {PING api.rubygems.org(2a04:4e42:200::70 (2a04:4e42:200::70)) 56 data bytes ^C --- api.rubygems.org ping statistics --- 143 packets transmitted, 0 received, 100% packet loss, time 401847ms}"}], "owner": {"reputation": 77, "user_id": 3369850, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/5256c0f99ca37da4eb7321e7524d1225?s=128&d=identicon&r=PG&f=1", "display_name": "user3369850", "link": "https://stackoverflow.com/users/3369850/user3369850"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 433, "favorite_count": 0, "answer_count": 0, "score": 3, "last_activity_date": 1536791169, "creation_date": 1536791169, "question_id": 52304291, "link": "https://stackoverflow.com/questions/52304291/error-when-installing-gems-using-wsl-windows-10-ubuntu", "title": "Error when installing gems, using WSL Windows 10 Ubuntu", "body": "<p>I am using Windows 10 WSL ubuntu and am trying to install gems.</p>\n\n<p><code>ERROR: Could not find a valid gem 'rails' (&gt;= 0), here is why: Unable to download data from https://rubygems.org/ - timed out (https://api.rubygems.org/specs.4.8.gz)</code></p>\n\n<p>Is the message I get after typing <code>gem install rails</code></p>\n\n<p>I have disabled IPv6 and it still does not work </p>\n"}, {"tags": ["ruby-on-rails", "ruby", "natural-sort"], "comments": [{"owner": {"reputation": 18856, "user_id": 1359650, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/dffc4318ac93e728a26c8e8b51b4eb37?s=128&d=identicon&r=PG", "display_name": "jvillian", "link": "https://stackoverflow.com/users/1359650/jvillian"}, "edited": false, "score": 0, "creation_date": 1536787791, "post_id": 52303690, "comment_id": 91555088, "body": "I&#39;m not sure what you mean by &#39;smartest&#39;, but that sort order looks correct, no?"}, {"owner": {"reputation": 1221, "user_id": 9375533, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a08c00e9e6694fe8222c6918801dcc0?s=128&d=identicon&r=PG&f=1", "display_name": "dcangulo", "link": "https://stackoverflow.com/users/9375533/dcangulo"}, "edited": false, "score": 0, "creation_date": 1536815563, "post_id": 52303690, "comment_id": 91561177, "body": "What database are you using?"}, {"owner": {"reputation": 11741, "user_id": 1934428, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/072774c5d4204a1c2385560e6114a887?s=128&d=identicon&r=PG", "display_name": "user1934428", "link": "https://stackoverflow.com/users/1934428/user1934428"}, "edited": false, "score": 0, "creation_date": 1536824283, "post_id": 52303690, "comment_id": 91564627, "body": "@Kerby82 : Please clarify - would you like the sorting happen in Ruby (this is what the tags of your post suggest), or would you like the sorting done by the database (this is what the text of your post suggests)."}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1536825078, "post_id": 52303690, "comment_id": 91565034, "body": "Have you considered storing the three parts (e.g. <code>2018</code>, <code>A</code>, <code>1</code>) in different columns with appropriate types?"}], "answers": [{"comments": [{"owner": {"reputation": 1556, "user_id": 2830852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/31ea598b6bc18b59de1e77a4c6f6c3e5?s=128&d=identicon&r=PG", "display_name": "Tarek N. Elsamni", "link": "https://stackoverflow.com/users/2830852/tarek-n-elsamni"}, "edited": false, "score": 0, "creation_date": 1536817007, "post_id": 52303991, "comment_id": 91561591, "body": "This is a nice solution if the returned data from the query is not big or a selection of the first x from the ordered array is not needed. Otherwise, you will need to implement that logic as a SQL query (harder to maintain or understand)."}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1536824514, "post_id": 52303991, "comment_id": 91564735, "body": "Note that the OP wants to <i>&quot;achieve that result directly with active record&quot;</i>"}, {"owner": {"reputation": 672, "user_id": 8748686, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gPuB7.jpg?s=128&g=1", "display_name": "John Skiles Skinner", "link": "https://stackoverflow.com/users/8748686/john-skiles-skinner"}, "reply_to_user": {"reputation": 1556, "user_id": 2830852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/31ea598b6bc18b59de1e77a4c6f6c3e5?s=128&d=identicon&r=PG", "display_name": "Tarek N. Elsamni", "link": "https://stackoverflow.com/users/2830852/tarek-n-elsamni"}, "edited": false, "score": 0, "creation_date": 1536854588, "post_id": 52303991, "comment_id": 91582540, "body": "Ah, well, I believe the request for an ActiveRecord solution was edited onto the question after my answer. In fact, I think there might not be a (pure) ActiveRecord solution. As @TarekN.Elsamni says, it will need to include SQL, perhaps the <code>SUBSTR()</code> function."}], "tags": [], "owner": {"reputation": 672, "user_id": 8748686, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gPuB7.jpg?s=128&g=1", "display_name": "John Skiles Skinner", "link": "https://stackoverflow.com/users/8748686/john-skiles-skinner"}, "is_accepted": false, "score": 1, "last_activity_date": 1536789135, "creation_date": 1536789135, "answer_id": 52303991, "question_id": 52303690, "link": "https://stackoverflow.com/questions/52303690/way-to-order-alphanumeric-string/52303991#52303991", "title": "Way to order alphanumeric string", "body": "<p>Here I'm re-stating your example data as an array:</p>\n\n<pre><code>example_array = %w{2018-A-1 2018-A-10 2018-A-2 2018-A-100 2018-A-11 2018-B-1 2018-B-10 2018-B-2 2018-B-100 2018-A-11}\n</code></pre>\n\n<p>It's not perfectly clear to me what order you're trying to get. If you are trying to sort based only on the digits following the final hyphen, this should work:</p>\n\n<pre><code>example_array.sort_by{|e| e.split(\"-\").last.to_i }\n</code></pre>\n\n<p>If you also intend to include the letter before the final number, perhaps this is what you want:</p>\n\n<pre><code>example_array.sort_by{|e| [e.split(\"-\")[-2], e.split(\"-\").last.to_i] }\n</code></pre>\n"}], "owner": {"reputation": 4312, "user_id": 166034, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/311eb5cf1152752fafbed2a2c85aff5d?s=128&d=identicon&r=PG", "display_name": "Kerby82", "link": "https://stackoverflow.com/users/166034/kerby82"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 163, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1536809764, "creation_date": 1536787512, "last_edit_date": 1536809764, "question_id": 52303690, "link": "https://stackoverflow.com/questions/52303690/way-to-order-alphanumeric-string", "title": "Way to order alphanumeric string", "body": "<p>I have a series of model objects with the following values on a column:</p>\n\n<ul>\n<li>2018-A-1</li>\n<li>2018-A-10</li>\n<li>2018-A-2</li>\n<li>2018-A-100</li>\n<li>2018-A-11</li>\n<li>2018-B-1</li>\n<li>2018-B-10</li>\n<li>2018-B-2</li>\n<li>2018-B-100</li>\n<li>2018-A-11</li>\n</ul>\n\n<p>I would like to query the db and get the result in alphanumeric order. I would like to obtain the result in this order:</p>\n\n<ul>\n<li>2018-A-1</li>\n<li>2018-A-2</li>\n<li>2018-A-10</li>\n<li>...</li>\n</ul>\n\n<p>Instead, I obtain the following order:</p>\n\n<ul>\n<li>2018-A-1</li>\n<li>2018-A-10</li>\n<li>2018-A-100</li>\n<li>...</li>\n</ul>\n\n<p>Any smart way to achieve that result directly with active record?</p>\n"}, {"tags": ["ruby", "ruby-on-rails-5", "erb"], "comments": [{"owner": {"reputation": 2131, "user_id": 577894, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/cbcc29e442c7d9f65a7798c4831f09c6?s=128&d=identicon&r=PG", "display_name": "Abe Petrillo", "link": "https://stackoverflow.com/users/577894/abe-petrillo"}, "edited": false, "score": 2, "creation_date": 1536784777, "post_id": 52303108, "comment_id": 91553948, "body": "Might be worth posting the whole file. Not sure we can help with just the snippet."}, {"owner": {"reputation": 1450, "user_id": 5554158, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/a8KtK.jpg?s=128&g=1", "display_name": "wokoro douye samuel", "link": "https://stackoverflow.com/users/5554158/wokoro-douye-samuel"}, "reply_to_user": {"reputation": 2131, "user_id": 577894, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/cbcc29e442c7d9f65a7798c4831f09c6?s=128&d=identicon&r=PG", "display_name": "Abe Petrillo", "link": "https://stackoverflow.com/users/577894/abe-petrillo"}, "edited": false, "score": 0, "creation_date": 1536786070, "post_id": 52303108, "comment_id": 91554465, "body": "Thanks for your response, just added the entire file as requested."}, {"owner": {"reputation": 5292, "user_id": 2727267, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/0e7c773908a4f6095f63cb9553bbc7af?s=128&d=identicon&r=PG", "display_name": "Beartech", "link": "https://stackoverflow.com/users/2727267/beartech"}, "edited": false, "score": 0, "creation_date": 1536786277, "post_id": 52303108, "comment_id": 91554529, "body": "I would guess that it&#39;s something that&#39;s getting loaded around line 8 and not the file you&#39;ve posted, that has the error. Are there more console messages? Can you show them all if so?"}, {"owner": {"reputation": 1450, "user_id": 5554158, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/a8KtK.jpg?s=128&g=1", "display_name": "wokoro douye samuel", "link": "https://stackoverflow.com/users/5554158/wokoro-douye-samuel"}, "edited": false, "score": 0, "creation_date": 1536787057, "post_id": 52303108, "comment_id": 91554827, "body": "No that&#39;s all I get from the console. Except you want a full stack trace."}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1536789016, "post_id": 52303108, "comment_id": 91555531, "body": "what ruby version?"}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1536789187, "post_id": 52303108, "comment_id": 91555581, "body": "Also check your stylesheets/javascripts, the error likely comes from there."}, {"owner": {"reputation": 1450, "user_id": 5554158, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/a8KtK.jpg?s=128&g=1", "display_name": "wokoro douye samuel", "link": "https://stackoverflow.com/users/5554158/wokoro-douye-samuel"}, "edited": false, "score": 0, "creation_date": 1536789285, "post_id": 52303108, "comment_id": 91555604, "body": "Ruby 2.3.3p222 (2016-11-21 revision 56859) [i386-mingw32]"}, {"owner": {"reputation": 5292, "user_id": 2727267, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/0e7c773908a4f6095f63cb9553bbc7af?s=128&d=identicon&r=PG", "display_name": "Beartech", "link": "https://stackoverflow.com/users/2727267/beartech"}, "edited": false, "score": 0, "creation_date": 1536804038, "post_id": 52303108, "comment_id": 91558592, "body": "A stack trace would be helpful. Also what web server are you using? Is the logging level something you can change? Are you saying that when you click on a page and it goes to render application.html.erb it ONLY produces one sentence? You don&#39;t see the request?"}], "owner": {"reputation": 1450, "user_id": 5554158, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/a8KtK.jpg?s=128&g=1", "display_name": "wokoro douye samuel", "link": "https://stackoverflow.com/users/5554158/wokoro-douye-samuel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 64, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1536787647, "creation_date": 1536784605, "last_edit_date": 1536787647, "question_id": 52303108, "link": "https://stackoverflow.com/questions/52303108/missing-in-a-rails-template-file", "title": "Missing &quot;)&quot; in a rails template file", "body": "<p>I am working on a rails project and am unable to identify the source of the error : <code>SyntaxError: [stdin]:10:26: missing )</code> when i render <code>application.html.erb</code>.</p>\n\n<p><a href=\"https://i.stack.imgur.com/8Xv6s.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/8Xv6s.png\" alt=\"enter image description here\"></a></p>\n\n<p>From the template i can't find the cause of the error or how to fix it.</p>\n\n<p>Am using <code>Rails 5.1.6</code></p>\n\n<p><strong>application.html.erb</strong></p>\n\n<pre><code>&lt;!DOCTYPE html&gt;\n&lt;html&gt;\n  &lt;head&gt;\n  &lt;title&gt;App&lt;/title&gt;\n  &lt;meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\"&gt;\n  &lt;%= csrf_meta_tags %&gt;\n  &lt;%= tag :meta, name: :psj, action: action_name, controller: controller_name %&gt;\n  &lt;%= stylesheet_link_tag 'application', media: 'all', 'data-turbolinks-track': 'reload' %&gt;\n  &lt;%= javascript_include_tag 'application', 'data-turbolinks-track': 'reload' %&gt;\n  &lt;/head&gt;\n  &lt;body&gt;\n    &lt;%= render 'layouts/header' %&gt;\n    &lt;%= yield %&gt;\n    &lt;%= render 'layouts/footer' %&gt;  \n  &lt;/body&gt;\n&lt;/html&gt;\n</code></pre>\n\n<p>Isolating code sections shows that the error is being triggered by either including the lines containing  ** javascript_include_tag ** or <strong>stylesheet_link_tag</strong></p>\n"}, {"tags": ["ruby", "regex"], "comments": [{"owner": {"reputation": 63, "user_id": 2940295, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/f79d9f5846d70ff644348c31c0e075e9?s=128&d=identicon&r=PG", "display_name": "Daniel Jacob Archer", "link": "https://stackoverflow.com/users/2940295/daniel-jacob-archer"}, "reply_to_user": {"reputation": 481662, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 0, "creation_date": 1536783174, "post_id": 52302587, "comment_id": 91553317, "body": "Thanks, that worked!"}, {"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 0, "creation_date": 1536910383, "post_id": 52302587, "comment_id": 91600952, "body": "This problem cannot be solved with a regex, because the <i>exact same</i> domain path may refer to a top-level domain or not, depending on the client&#39;s network. In particular, the domain paths you posted are all <i>relative</i>, not <i>absolute</i> paths, so they are looked up relative to the client&#39;s default suffix. For example, if I work for a company named &quot;Foo&quot; in Germany, which owns the domain <code>foo.de</code>, and it&#39;s communications department is using the domain <code>com</code> and has a server called <code>example</code>, then the DNS query for <code>example.com</code> will actually return the address of <code>example.com.foo.de.</code>."}, {"owner": {"reputation": 481662, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 0, "creation_date": 1538003740, "post_id": 52302587, "comment_id": 91994117, "body": "What is wrong with the answer below?"}], "answers": [{"tags": [], "owner": {"reputation": 481662, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "is_accepted": true, "score": 2, "last_activity_date": 1536783699, "creation_date": 1536783699, "answer_id": 52302897, "question_id": 52302587, "link": "https://stackoverflow.com/questions/52302587/ruby-regular-expression-for-matching-any-subdomains-and-the-top-level-domain/52302897#52302897", "title": "Ruby Regular Expression for matching any subdomains and the top level domain", "body": "<p>You may use</p>\n\n<pre><code>/\\A(?:https?:\\/\\/)?(?:\\S*\\.)?example\\.com\\z/\n</code></pre>\n\n<p>See the <a href=\"http://rubular.com/r/JyO4hwW1vd\" rel=\"nofollow noreferrer\">regex demo</a></p>\n\n<p><strong>Details</strong></p>\n\n<ul>\n<li><code>\\A</code> - start of string</li>\n<li><code>(?:https?:\\/\\/)?</code> - an optional (as the <code>?</code> quantifier at the end repeats 1 or 0 times) non-capturing group matching <code>http</code>, an optional <code>s</code> and then <code>//</code> substring</li>\n<li><code>(?:\\S*\\.)?</code> - an optional non-capturing group matching 1 or 0 occurrences of 0 or more non-whitespace chars (with <code>\\S*</code>) and then a dot (<code>\\.</code>)</li>\n<li><code>example\\.com</code> - an <code>example.com</code> substring</li>\n<li><code>\\z</code> - end of string.</li>\n</ul>\n"}], "owner": {"reputation": 63, "user_id": 2940295, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/f79d9f5846d70ff644348c31c0e075e9?s=128&d=identicon&r=PG", "display_name": "Daniel Jacob Archer", "link": "https://stackoverflow.com/users/2940295/daniel-jacob-archer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 252, "favorite_count": 0, "accepted_answer_id": 52302897, "answer_count": 1, "score": 1, "last_activity_date": 1536807964, "creation_date": 1536782421, "last_edit_date": 1536807964, "question_id": 52302587, "link": "https://stackoverflow.com/questions/52302587/ruby-regular-expression-for-matching-any-subdomains-and-the-top-level-domain", "title": "Ruby Regular Expression for matching any subdomains and the top level domain", "body": "<p>I'm trying to create a regex that will optionally match any subdomains, and match the TLD. For example, it should match\u2026</p>\n\n<ul>\n<li><a href=\"https://example.com\" rel=\"nofollow noreferrer\">https://example.com</a></li>\n<li><a href=\"http://example.com\" rel=\"nofollow noreferrer\">http://example.com</a></li>\n<li><a href=\"https://test.example.com\" rel=\"nofollow noreferrer\">https://test.example.com</a></li>\n<li>test.example.com</li>\n<li>example.com</li>\n</ul>\n\n<p>It should not match\u2026</p>\n\n<ul>\n<li>fakeexample.com</li>\n<li><a href=\"https://fakeexample.com\" rel=\"nofollow noreferrer\">https://fakeexample.com</a></li>\n<li>fake.fakeexample.com</li>\n</ul>\n\n<p>I have this so far, which matches subdomains, but does not match when at the top level domain.\n<code>(\\A|(https?:\\/\\/))?(\\w*|\\S*)\\.{1}example\\.com</code></p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 109029, "user_id": 2767755, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/BkC8q.jpg?s=128&g=1", "display_name": "Arup Rakshit", "link": "https://stackoverflow.com/users/2767755/arup-rakshit"}, "edited": false, "score": 0, "creation_date": 1536780945, "post_id": 52301992, "comment_id": 91552392, "body": "You mean <code>section_id: c.section_id</code> is wrong always? Sorry I am not getting the problem. Could you tell me the more?"}, {"owner": {"reputation": 703, "user_id": 9242883, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/5304442e38e3ce9d20fce061c5ff9f2a?s=128&d=identicon&r=PG&f=1", "display_name": "jj008", "link": "https://stackoverflow.com/users/9242883/jj008"}, "reply_to_user": {"reputation": 109029, "user_id": 2767755, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/BkC8q.jpg?s=128&g=1", "display_name": "Arup Rakshit", "link": "https://stackoverflow.com/users/2767755/arup-rakshit"}, "edited": false, "score": 0, "creation_date": 1536781373, "post_id": 52301992, "comment_id": 91552599, "body": "Yes, using <code>create_template_components</code>, the <code>section_id</code> will always be 123 (for example), even though the <code>section_id</code> will be new."}], "answers": [{"comments": [{"owner": {"reputation": 703, "user_id": 9242883, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/5304442e38e3ce9d20fce061c5ff9f2a?s=128&d=identicon&r=PG&f=1", "display_name": "jj008", "link": "https://stackoverflow.com/users/9242883/jj008"}, "edited": false, "score": 0, "creation_date": 1536781757, "post_id": 52302377, "comment_id": 91552765, "body": "What if I have multiple sections (123 and 125), and separate components associated with those sections? For example, component 124 associated with section 123, and component 126 associated with section 125."}, {"owner": {"reputation": 109029, "user_id": 2767755, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/BkC8q.jpg?s=128&g=1", "display_name": "Arup Rakshit", "link": "https://stackoverflow.com/users/2767755/arup-rakshit"}, "reply_to_user": {"reputation": 703, "user_id": 9242883, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/5304442e38e3ce9d20fce061c5ff9f2a?s=128&d=identicon&r=PG&f=1", "display_name": "jj008", "link": "https://stackoverflow.com/users/9242883/jj008"}, "edited": false, "score": 0, "creation_date": 1536781802, "post_id": 52302377, "comment_id": 91552780, "body": "@jj008 Do you want always a new section to be created when copying from template components? If not, when you want a new one?"}, {"owner": {"reputation": 703, "user_id": 9242883, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/5304442e38e3ce9d20fce061c5ff9f2a?s=128&d=identicon&r=PG&f=1", "display_name": "jj008", "link": "https://stackoverflow.com/users/9242883/jj008"}, "edited": false, "score": 0, "creation_date": 1536781892, "post_id": 52302377, "comment_id": 91552818, "body": "Yes, I want to create a new section when I&#39;m creating a new lesson using a template. So if I create a new lesson, I want to have component 994 associated with section 993, and component 996 associated with section 995 (for example)"}, {"owner": {"reputation": 109029, "user_id": 2767755, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/BkC8q.jpg?s=128&g=1", "display_name": "Arup Rakshit", "link": "https://stackoverflow.com/users/2767755/arup-rakshit"}, "reply_to_user": {"reputation": 703, "user_id": 9242883, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/5304442e38e3ce9d20fce061c5ff9f2a?s=128&d=identicon&r=PG&f=1", "display_name": "jj008", "link": "https://stackoverflow.com/users/9242883/jj008"}, "edited": false, "score": 0, "creation_date": 1536781971, "post_id": 52302377, "comment_id": 91552847, "body": "Ok, then the code I gave, always create new section.. <code>newSection = c.section &amp;&amp; c.section.dup.create</code>"}, {"owner": {"reputation": 703, "user_id": 9242883, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/5304442e38e3ce9d20fce061c5ff9f2a?s=128&d=identicon&r=PG&f=1", "display_name": "jj008", "link": "https://stackoverflow.com/users/9242883/jj008"}, "edited": false, "score": 0, "creation_date": 1536782306, "post_id": 52302377, "comment_id": 91552967, "body": "for <code>c.section</code>, did you mean <code>c.type = &#39;Section&#39;</code>? Also, I&#39;m getting an error saying undefined method <code>create</code>"}, {"owner": {"reputation": 703, "user_id": 9242883, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/5304442e38e3ce9d20fce061c5ff9f2a?s=128&d=identicon&r=PG&f=1", "display_name": "jj008", "link": "https://stackoverflow.com/users/9242883/jj008"}, "edited": false, "score": 0, "creation_date": 1536782756, "post_id": 52302377, "comment_id": 91553148, "body": "There&#39;s no error but the <code>section_id</code> of the component is still not using the <code>id</code> of the newly created section."}, {"owner": {"reputation": 109029, "user_id": 2767755, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/BkC8q.jpg?s=128&g=1", "display_name": "Arup Rakshit", "link": "https://stackoverflow.com/users/2767755/arup-rakshit"}, "reply_to_user": {"reputation": 703, "user_id": 9242883, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/5304442e38e3ce9d20fce061c5ff9f2a?s=128&d=identicon&r=PG&f=1", "display_name": "jj008", "link": "https://stackoverflow.com/users/9242883/jj008"}, "edited": false, "score": 0, "creation_date": 1536782887, "post_id": 52302377, "comment_id": 91553194, "body": "Let us <a href=\"https://chat.stackoverflow.com/rooms/179937/discussion-between-arup-rakshit-and-jj008\">continue this discussion in chat</a>."}], "tags": [], "owner": {"reputation": 109029, "user_id": 2767755, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/BkC8q.jpg?s=128&g=1", "display_name": "Arup Rakshit", "link": "https://stackoverflow.com/users/2767755/arup-rakshit"}, "is_accepted": false, "score": 1, "last_activity_date": 1536785097, "last_edit_date": 1536785097, "creation_date": 1536781562, "answer_id": 52302377, "question_id": 52301992, "link": "https://stackoverflow.com/questions/52301992/rails-model-creating-using-template/52302377#52302377", "title": "Rails Model - Creating Using Template", "body": "<p>Create a shallow copy of <code>Section</code> object, and then create it and attach it to the new components.</p>\n\n<pre><code>def create_template_components\n  if lesson_template\n    lesson_template.components.each do |c|\n      newSection = if c.type == 'Question'\n        c.section &amp;&amp; c.section.dup\n      else\n        nil\n      end\n      newSection.save if newSection\n      self.components.create!({\n        type: c.type,\n        content: c.content,\n        section_id: newSection.try(:id)\n      })\n    end\n  end\nend\n</code></pre>\n\n<p><a href=\"https://api.rubyonrails.org/classes/ActiveRecord/Core.html#method-i-dup\" rel=\"nofollow noreferrer\"><code>#dup</code></a></p>\n\n<blockquote>\n  <p>Duped objects have <strong>no id assigned</strong> and are treated as <strong>new</strong> records. Note\n  that this is a \u201cshallow\u201d copy as it copies the object's attributes\n  only, not its associations. The extent of a \u201cdeep\u201d copy is application\n  specific and is therefore left to the application to implement\n  according to its need. The dup method does not preserve the timestamps\n  (created|updated)_(at|on).</p>\n</blockquote>\n"}, {"comments": [{"owner": {"reputation": 703, "user_id": 9242883, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/5304442e38e3ce9d20fce061c5ff9f2a?s=128&d=identicon&r=PG&f=1", "display_name": "jj008", "link": "https://stackoverflow.com/users/9242883/jj008"}, "edited": false, "score": 0, "creation_date": 1536783095, "post_id": 52302621, "comment_id": 91553284, "body": "I think this is close to what I&#39;m looking for, but the main question is, when I&#39;m creating a new component, how can I use the correct and new section id (when I have different sections and different components associated to those sections?"}, {"owner": {"reputation": 672, "user_id": 8748686, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gPuB7.jpg?s=128&g=1", "display_name": "John Skiles Skinner", "link": "https://stackoverflow.com/users/8748686/john-skiles-skinner"}, "reply_to_user": {"reputation": 703, "user_id": 9242883, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/5304442e38e3ce9d20fce061c5ff9f2a?s=128&d=identicon&r=PG&f=1", "display_name": "jj008", "link": "https://stackoverflow.com/users/9242883/jj008"}, "edited": false, "score": 0, "creation_date": 1536783845, "post_id": 52302621, "comment_id": 91553581, "body": "Well, if the new component you are creating is a section, you don&#39;t have to worry about setting section id. If the new component is a question, this solution should use the new section id. That&#39;s why I&#39;ve named the var <code>new_section</code> and we&#39;re using its id. (Now, if there are more types of components than just those two, or if there are some &quot;orphan&quot; questions that don&#39;t belong to a section, then that would complicate things.)"}, {"owner": {"reputation": 703, "user_id": 9242883, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/5304442e38e3ce9d20fce061c5ff9f2a?s=128&d=identicon&r=PG&f=1", "display_name": "jj008", "link": "https://stackoverflow.com/users/9242883/jj008"}, "edited": false, "score": 0, "creation_date": 1536789734, "post_id": 52302621, "comment_id": 91555720, "body": "Section is a type of component and there are multiple types of components. I&#39;m trying to figure out how to &quot;duplicate&quot; the sections and components from a template with each component having the correct corresponding section_id, according to the template."}, {"owner": {"reputation": 672, "user_id": 8748686, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gPuB7.jpg?s=128&g=1", "display_name": "John Skiles Skinner", "link": "https://stackoverflow.com/users/8748686/john-skiles-skinner"}, "reply_to_user": {"reputation": 703, "user_id": 9242883, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/5304442e38e3ce9d20fce061c5ff9f2a?s=128&d=identicon&r=PG&f=1", "display_name": "jj008", "link": "https://stackoverflow.com/users/9242883/jj008"}, "edited": false, "score": 0, "creation_date": 1536789950, "post_id": 52302621, "comment_id": 91555792, "body": "Yeah, I think I get it. Does this solution not work? What behavior do you see?"}, {"owner": {"reputation": 703, "user_id": 9242883, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/5304442e38e3ce9d20fce061c5ff9f2a?s=128&d=identicon&r=PG&f=1", "display_name": "jj008", "link": "https://stackoverflow.com/users/9242883/jj008"}, "edited": false, "score": 0, "creation_date": 1536790329, "post_id": 52302621, "comment_id": 91555873, "body": "I have revised the data in my question, I&#39;m trying to create/duplicate what&#39;s on the template but keep the &quot;association&quot; (through the section_id)"}, {"owner": {"reputation": 672, "user_id": 8748686, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gPuB7.jpg?s=128&g=1", "display_name": "John Skiles Skinner", "link": "https://stackoverflow.com/users/8748686/john-skiles-skinner"}, "reply_to_user": {"reputation": 703, "user_id": 9242883, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/5304442e38e3ce9d20fce061c5ff9f2a?s=128&d=identicon&r=PG&f=1", "display_name": "jj008", "link": "https://stackoverflow.com/users/9242883/jj008"}, "edited": false, "score": 0, "creation_date": 1536791546, "post_id": 52302621, "comment_id": 91556210, "body": "OK, I&#39;ve updated the code in my answer to handle your new data"}, {"owner": {"reputation": 703, "user_id": 9242883, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/5304442e38e3ce9d20fce061c5ff9f2a?s=128&d=identicon&r=PG&f=1", "display_name": "jj008", "link": "https://stackoverflow.com/users/9242883/jj008"}, "edited": false, "score": 0, "creation_date": 1536855984, "post_id": 52302621, "comment_id": 91583271, "body": "Calling lesson_template.sections results in undefined method. I don&#39;t have inheritance between section and non-sections, the section_id is just a value."}, {"owner": {"reputation": 672, "user_id": 8748686, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gPuB7.jpg?s=128&g=1", "display_name": "John Skiles Skinner", "link": "https://stackoverflow.com/users/8748686/john-skiles-skinner"}, "reply_to_user": {"reputation": 703, "user_id": 9242883, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/5304442e38e3ce9d20fce061c5ff9f2a?s=128&d=identicon&r=PG&f=1", "display_name": "jj008", "link": "https://stackoverflow.com/users/9242883/jj008"}, "edited": false, "score": 0, "creation_date": 1536858140, "post_id": 52302621, "comment_id": 91584332, "body": "Well, <code>lesson_template.components.where(type: &#39;Sections&#39;)</code> should also do it. (I thought that <code>lesson_template.sections</code> would work if STI was set up correctly, but maybe I&#39;m wrong.)"}, {"owner": {"reputation": 703, "user_id": 9242883, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/5304442e38e3ce9d20fce061c5ff9f2a?s=128&d=identicon&r=PG&f=1", "display_name": "jj008", "link": "https://stackoverflow.com/users/9242883/jj008"}, "edited": false, "score": 0, "creation_date": 1536858546, "post_id": 52302621, "comment_id": 91584552, "body": "Also, <code>old_section</code> or any section do not have components. They are all components. Like the data structure that I posted, how would that affect the inner loop?"}, {"owner": {"reputation": 672, "user_id": 8748686, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gPuB7.jpg?s=128&g=1", "display_name": "John Skiles Skinner", "link": "https://stackoverflow.com/users/8748686/john-skiles-skinner"}, "reply_to_user": {"reputation": 703, "user_id": 9242883, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/5304442e38e3ce9d20fce061c5ff9f2a?s=128&d=identicon&r=PG&f=1", "display_name": "jj008", "link": "https://stackoverflow.com/users/9242883/jj008"}, "edited": false, "score": 0, "creation_date": 1536858806, "post_id": 52302621, "comment_id": 91584683, "body": "OK, well, that also was just an attempt at a shorthand; <code>old_section.components</code> could also be written <code>Component.where(section_id: old_section.id)</code>"}], "tags": [], "owner": {"reputation": 672, "user_id": 8748686, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gPuB7.jpg?s=128&g=1", "display_name": "John Skiles Skinner", "link": "https://stackoverflow.com/users/8748686/john-skiles-skinner"}, "is_accepted": false, "score": 1, "last_activity_date": 1536791508, "last_edit_date": 1536791508, "creation_date": 1536782567, "answer_id": 52302621, "question_id": 52301992, "link": "https://stackoverflow.com/questions/52301992/rails-model-creating-using-template/52302621#52302621", "title": "Rails Model - Creating Using Template", "body": "<p>My idea is an outer loop that duplicates sections. The <strong>new</strong> section id is used when recreating other components (outcomes and questions) in an inner loop, which will keep the associations updated and correct.</p>\n\n<pre><code>lesson_template.sections.each do |old_section|\n  # outer loop: recreate section\n   new_section = self.sections.create!({\n    content: old_section.content\n  })\n  old_section.components.each do |old_non_section_component|\n    # inner loop: recreate all components belonging to section\n    self.component.create!({\n      type: old_non_section_component.type,\n      content: old_non_section_component.content,\n      # use id from newly-created section, keeping correct association\n      section_id: new_section.id # &lt;-- IMPORTANT\n    })\n  end\nend\n</code></pre>\n\n<p>It's probably worth updating your question to mention that you are using self-referrential single table inheritance, or whatever this technique is called. It's not something I've seen very often.</p>\n"}], "owner": {"reputation": 703, "user_id": 9242883, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/5304442e38e3ce9d20fce061c5ff9f2a?s=128&d=identicon&r=PG&f=1", "display_name": "jj008", "link": "https://stackoverflow.com/users/9242883/jj008"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 50, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1536791508, "creation_date": 1536779960, "last_edit_date": 1536790896, "question_id": 52301992, "link": "https://stackoverflow.com/questions/52301992/rails-model-creating-using-template", "title": "Rails Model - Creating Using Template", "body": "<p>In my app, I have the ability to create \"lessons\", and each lesson contains several \"components\". Right now, I'm trying to implement the ability to create a lesson from a template so it would duplicate/recreate the components from the template to the new lesson.</p>\n\n<p>The data structure of my <code>component</code> is something like this:</p>\n\n<pre><code>{\n  id: 123,\n  type: Section,\n  content: \"abc\",\n  section_id: null\n},\n{\n  id: 124,\n  type: Question,\n  content: \"abc?\",\n  section_id: 123\n},\n{\n  id: 125,\n  type: Section,\n  content: \"defg\",\n  section_id: null\n},\n{\n  id: 126,\n  type: Outcome,\n  content: \"defg?\",\n  section_id: 125\n},\n</code></pre>\n\n<p>Desired outcome:</p>\n\n<pre><code>{\n  id: 993,\n  type: Section,\n  content: \"abc\",\n  section_id: null\n},\n{\n  id: 994,\n  type: Question,\n  content: \"abc?\",\n  section_id: 993\n},\n{\n  id: 995,\n  type: Section,\n  content: \"defg\",\n  section_id: null\n},\n{\n  id: 996,\n  type: Outcome,\n  content: \"defg?\",\n  section_id: 995\n},\n</code></pre>\n\n<p>You can see that there's an association between the <code>Question</code>/<code>Outcome</code> and the <code>Section</code> through <code>section_id</code>.</p>\n\n<p>In my lesson model, I'm looping through the components of a template and taking their attributes for the newly created lesson components. </p>\n\n<pre><code>class Lesson\n\n  attr_accessor :lesson_template_id\n\n  # == Callbacks ==============================\n  after_create :create_template_components, if: :lesson_template_id_present?\n\n  def lesson_template\n    if @lesson_template_id != ''\n      LessonTemplate.find(@lesson_template_id)\n    else\n      nil\n    end\n  end\n\n\nprivate\n\n  def lesson_template_id_present?\n    !!@lesson_template_id\n  end\n\n\n  def create_template_components\n    if lesson_template\n      lesson_template.components.each do |c|\n        self.components.create!({\n          type: c.type,\n          content: c.content,\n          section_id: c.section_id\n        })\n      end\n    end\n  end\n</code></pre>\n\n<p>But the problem is that the <code>section_id</code> is incorrect because the newly create sections would have a new/different <code>id</code>. How can I revise my model to make sure the components are created properly?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-4", "oraclelinux"], "comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1536781847, "post_id": 52301870, "comment_id": 91552805, "body": "To install historical versions you&#39;ll often need to use RVM or another tool like <a href=\"https://github.com/rbenv/rbenv\" rel=\"nofollow noreferrer\"><code>rbenv</code></a>. This is a common pattern as seen with other tools like Python and Node.js."}], "answers": [{"tags": [], "owner": {"reputation": 21, "user_id": 10355044, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-VaS-ab9i1vs/AAAAAAAAAAI/AAAAAAAAAAo/woUI-6ThZto/photo.jpg?sz=128", "display_name": "Catherine Zarra", "link": "https://stackoverflow.com/users/10355044/catherine-zarra"}, "is_accepted": false, "score": 1, "last_activity_date": 1536780946, "creation_date": 1536780946, "answer_id": 52302237, "question_id": 52301870, "link": "https://stackoverflow.com/questions/52301870/how-to-install-ruby-2-3-on-oracle-linux-7/52302237#52302237", "title": "How to install ruby 2.3 on Oracle Linux 7", "body": "<p>rbenv might work for your purposes. </p>\n\n<p><a href=\"https://github.com/rbenv/rbenv/blob/master/README.md\" rel=\"nofollow noreferrer\">README for rbenv</a></p>\n\n<p><a href=\"https://www.digitalocean.com/community/tutorials/how-to-install-ruby-on-rails-with-rbenv-on-ubuntu-16-04\" rel=\"nofollow noreferrer\">Tutorial on installation</a></p>\n"}], "owner": {"reputation": 143, "user_id": 10254997, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TP2Gw.jpg?s=128&g=1", "display_name": "Ivan Ivanov", "link": "https://stackoverflow.com/users/10254997/ivan-ivanov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 893, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1536780946, "creation_date": 1536779249, "question_id": 52301870, "link": "https://stackoverflow.com/questions/52301870/how-to-install-ruby-2-3-on-oracle-linux-7", "title": "How to install ruby 2.3 on Oracle Linux 7", "body": "<p>How to install ruby 2.3 on Oracle Linux 7 without RVM?\nI don't want using rvm or build from source.</p>\n"}, {"tags": ["ruby", "postgresql", "ruby-on-rails-4", "rails-activerecord"], "answers": [{"tags": [], "owner": {"reputation": 871, "user_id": 2629833, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BAViS.jpg?s=128&g=1", "display_name": "HarsHarI", "link": "https://stackoverflow.com/users/2629833/harshari"}, "is_accepted": false, "score": 0, "last_activity_date": 1536784501, "creation_date": 1536784501, "answer_id": 52303080, "question_id": 52301541, "link": "https://stackoverflow.com/questions/52301541/pgundefinedtable-error-missing-from-clause-entry-for-table-user-events/52303080#52303080", "title": "PG::UndefinedTable: ERROR: missing FROM-clause entry for table &quot;user_events&quot;", "body": "<p>What i got over here that you need those whose title is not 'wow' by above query? Correct.\nIf this is then you should use references method over there as rails don't understand title is on \"user_events\" tables, because you called it from Event also you can write it like this </p>\n\n<blockquote>\n  <p>Event.includes(:attendees).joins(:user_events).where.not(user_events:\n  {title: \"wow\"})</p>\n</blockquote>\n"}], "owner": {"reputation": 5961, "user_id": 2328259, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/a7f760bec40648f4bda5855cd854612e?s=128&d=identicon&r=PG", "display_name": "David", "link": "https://stackoverflow.com/users/2328259/david"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 228, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1536784501, "creation_date": 1536777659, "question_id": 52301541, "link": "https://stackoverflow.com/questions/52301541/pgundefinedtable-error-missing-from-clause-entry-for-table-user-events", "title": "PG::UndefinedTable: ERROR: missing FROM-clause entry for table &quot;user_events&quot;", "body": "<p>I have a bit of a quirky case. I'm not sure if this is a Rails bug (I'm using version 4.1.4). Perhaps, I need to upgrade my version.</p>\n\n<p>Essentially:</p>\n\n<p>My <code>Event</code> model has the following association:</p>\n\n<pre><code>has_many :attendees, -&gt; { order(:name).select('users.*, user_events.event_title') },\nthrough: :user_events,\nsource: :user\n</code></pre>\n\n<p>What this does is get me Users that attend an event and via the <code>user_events</code> join table, it'll also get me their <code>event_title</code>.</p>\n\n<p>This works in simple cases: <code>event.attendees</code></p>\n\n<p>However, it errors out in the following:</p>\n\n<p><code>Event.includes(:attendees).where.not(title: \"wow\")</code></p>\n\n<p>The problem is basically that <code>user_events</code> is not added to the FROM clause in the command that errors out. It is added in <code>event.attendees</code> though.</p>\n\n<p>How would I get it to properly be added?</p>\n\n<p>I've tried <code>Event.includes(:attendees).joins(:user_events).where.not(title: \"wow\")</code> but it adds <code>user_events</code> to the wrong SQL call.</p>\n"}, {"tags": ["arrays", "ruby"], "comments": [{"owner": {"reputation": 394580, "user_id": 479863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ArUCE.jpg?s=128&g=1", "display_name": "mu is too short", "link": "https://stackoverflow.com/users/479863/mu-is-too-short"}, "edited": false, "score": 0, "creation_date": 1536774717, "post_id": 52300621, "comment_id": 91549489, "body": "See also <a href=\"https://stackoverflow.com/q/22417074/479863\">Creating matrix with Array.new(n, Array.new)</a>, <a href=\"https://stackoverflow.com/q/42615737/479863\">Why Array.new(3, &#91;&#93;) works differently ...</a>, and lots of others. Don&#39;t feel bad, the duplicates aren&#39;t easy to find (unless you know the answer already)."}], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 10354619, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65fa3ad3da019c3f47dd2974ee3671be?s=128&d=identicon&r=PG&f=1", "display_name": "M. Sakovich", "link": "https://stackoverflow.com/users/10354619/m-sakovich"}, "edited": false, "score": 0, "creation_date": 1536774131, "post_id": 52300676, "comment_id": 91549243, "body": "I&#39;m trying to make an array with pairs of values. I had the same trouble with 2-dimensional arrays in ruby everytime i set values using something like <code>arr[0][0] = &#39;name&#39;</code>. I think that&#39;s the wrong way to work with 2d-arrays but i haven&#39;t found any other ways."}, {"owner": {"reputation": 394580, "user_id": 479863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ArUCE.jpg?s=128&g=1", "display_name": "mu is too short", "link": "https://stackoverflow.com/users/479863/mu-is-too-short"}, "reply_to_user": {"reputation": 23, "user_id": 10354619, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65fa3ad3da019c3f47dd2974ee3671be?s=128&d=identicon&r=PG&f=1", "display_name": "M. Sakovich", "link": "https://stackoverflow.com/users/10354619/m-sakovich"}, "edited": false, "score": 0, "creation_date": 1536774866, "post_id": 52300676, "comment_id": 91549558, "body": "@M.Sakovich First of all, there are no 2D arrays in Ruby, just arrays-of-arrays; a minor point perhaps but it underlies the real problem of accidental reference sharing. If you want to make an array-of-arrays, use the block form of <code>Array.new</code> as Cody suggests: <code>Array.new(n) { [ ] }</code>."}], "tags": [], "owner": {"reputation": 31012, "user_id": 25398, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3690dee254e9aa9d98ff964a70e89f23?s=128&d=identicon&r=PG", "display_name": "Cody Caughlan", "link": "https://stackoverflow.com/users/25398/cody-caughlan"}, "is_accepted": true, "score": 1, "last_activity_date": 1536773704, "creation_date": 1536773704, "answer_id": 52300676, "question_id": 52300621, "link": "https://stackoverflow.com/questions/52300621/trouble-with-arrays-in-ruby/52300676#52300676", "title": "Trouble with arrays in Ruby", "body": "<p>According to the Ruby Array docs:</p>\n\n<p><a href=\"http://ruby-doc.org/core-2.5.1/Array.html\" rel=\"nofollow noreferrer\">http://ruby-doc.org/core-2.5.1/Array.html</a></p>\n\n<p><code>Note that the second argument populates the array with references to the same object. Therefore, it is only recommended in cases when you need to instantiate arrays with natively immutable objects such as Symbols, numbers, true or false.</code></p>\n\n<p>Which explains why </p>\n\n<pre><code>arr[0][0] = 'name'\n</code></pre>\n\n<p>Sets all keys to the same value. In your case the last-one wins so its <code>time</code></p>\n\n<p>What are you really trying to achieve? Setting a default value? If so, use the block syntax to pre-fill your array, like:</p>\n\n<pre><code> arr = Array.new(6) { [2, '0'] }\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1674, "user_id": 6613299, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/WGQGV.jpg?s=128&g=1", "display_name": "Rohit-Pandey", "link": "https://stackoverflow.com/users/6613299/rohit-pandey"}, "is_accepted": false, "score": 0, "last_activity_date": 1536774495, "creation_date": 1536774495, "answer_id": 52300866, "question_id": 52300621, "link": "https://stackoverflow.com/questions/52300621/trouble-with-arrays-in-ruby/52300866#52300866", "title": "Trouble with arrays in Ruby", "body": "<pre><code>arr = Array.new(6){Array.new(2,'0')}\narr[0][0] = 'pan'\narr[1][0] = 'id'\narr[2][0] = 'type'\narr[3][0] = 'sum'\narr[4][0] = 'partner'\narr[5][0] = 'time'\nputs arr\n</code></pre>\n\n<p>Try This.</p>\n"}], "owner": {"reputation": 23, "user_id": 10354619, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65fa3ad3da019c3f47dd2974ee3671be?s=128&d=identicon&r=PG&f=1", "display_name": "M. Sakovich", "link": "https://stackoverflow.com/users/10354619/m-sakovich"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 30, "favorite_count": 0, "closed_date": 1536774408, "accepted_answer_id": 52300676, "answer_count": 2, "score": 2, "last_activity_date": 1536774495, "creation_date": 1536773460, "question_id": 52300621, "link": "https://stackoverflow.com/questions/52300621/trouble-with-arrays-in-ruby", "closed_reason": "Duplicate", "title": "Trouble with arrays in Ruby", "body": "<p>I make an array and edit values:</p>\n\n<pre><code>arr = Array.new(6, Array.new(2, '0'))\narr[0][0] = 'name'\narr[1][0] = 'id'\narr[2][0] = 'type'\narr[3][0] = 'sum'\narr[4][0] = 'partner'\narr[5][0] = 'time'\n</code></pre>\n\n<p>And after that i have this array:</p>\n\n<pre><code>[[\"time\", \"0\"], [\"time\", \"0\"], [\"time\", \"0\"], [\"time\", \"0\"], [\"time\", \"0\"], [\"time\", \"0\"]]\n</code></pre>\n\n<p>When i need this:</p>\n\n<pre><code>[[\"name\", \"0\"], [\"id\", \"0\"], [\"type\", \"0\"], [\"sum\", \"0\"], [\"partner\", \"0\"], [\"time\", \"0\"]]\n</code></pre>\n\n<p>What do i do wrong?</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "answers": [{"comments": [{"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1536772933, "post_id": 52300388, "comment_id": 91548673, "body": "When defining custom associations like this, you should also define an <code>inverse_of</code> on the association, so that Rails knows how to minimise the number of database queries made when accessing data between objects."}], "tags": [], "owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "is_accepted": false, "score": 0, "last_activity_date": 1536772725, "last_edit_date": 1536772725, "creation_date": 1536772415, "answer_id": 52300388, "question_id": 52299937, "link": "https://stackoverflow.com/questions/52299937/dilemma-between-two-database-schemas-for-my-marketplace-rails-project/52300388#52300388", "title": "Dilemma between two database schemas for my marketplace rails project", "body": "<blockquote>\n  <p>the product must be unique and should belong to only one specific User</p>\n</blockquote>\n\n<p>The point is that there needs to be <strong>two</strong> links between the <code>products</code> table and the <code>users</code> table.</p>\n\n<p>You need the concept of a \"seller\" as well as \"buyers\" (or whatever you choose to name it).</p>\n\n<p>Something like this:</p>\n\n<pre><code>class Product &lt; ApplicationRecord\n  belongs_to :seller, class_name: \"User\"\n  has_many :buyers, through: :orders, class_name: \"User\"\nend\n\nclass User\n  has_many :orders\n  has_many :products_bought, through: :orders, class_name: 'Product'\n  has_many :products_sold, class_name: 'Product'\nend\n</code></pre>\n\n<p>You can then add a uniqueness validation check on the product (possibly scoped to the <code>seller_id</code>?).</p>\n\n<p>If one product had multiple sellers, then you could tweak this association slightly to use a more generic join table (i.e. rename the <code>orders</code> table). But you still need a clear distinction between the \"sellers\" and the \"buyers\".</p>\n"}], "owner": {"reputation": 51, "user_id": 10192738, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EBCq0.jpg?s=128&g=1", "display_name": "Kaido", "link": "https://stackoverflow.com/users/10192738/kaido"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 60, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1536772725, "creation_date": 1536770484, "question_id": 52299937, "link": "https://stackoverflow.com/questions/52299937/dilemma-between-two-database-schemas-for-my-marketplace-rails-project", "title": "Dilemma between two database schemas for my marketplace rails project", "body": "<p>I'm building a market place when a User can both buy and sell.\nOf course he will not be able to buy his own products and once one of his product will be buyed there will be a quantity logic controller behind. However. I'm still stuck at modeling the schema.</p>\n\n<p>At the moment i'm using this schema.</p>\n\n<pre><code>  ActiveRecord::Schema.define(version: 2018_09_11_202223) do\n\n  create_table \"categories\", force: :cascade do |t|\n    t.string \"name\"\n    t.datetime \"created_at\", null: false\n    t.datetime \"updated_at\", null: false\n  end\n\n  create_table \"orders\", force: :cascade do |t|\n    t.integer \"user_id\"\n    t.datetime \"created_at\", null: false\n    t.datetime \"updated_at\", null: false\n    t.index [\"user_id\"], name: \"index_orders_on_user_id\"\n  end\n\n  create_table \"orders_products\", id: false, force: :cascade do |t|\n    t.integer \"order_id\", null: false\n    t.integer \"product_id\", null: false\n    t.index [\"order_id\", \"product_id\"], name: \"index_orders_products_on_order_id_and_product_id\"\n    t.index [\"product_id\", \"order_id\"], name: \"index_orders_products_on_product_id_and_order_id\"\n  end\n\n  create_table \"products\", force: :cascade do |t|\n    t.string \"name\"\n    t.string \"tagline\"\n    t.integer \"user_id\"\n    t.integer \"category_id\"\n    t.datetime \"created_at\", null: false\n    t.datetime \"updated_at\", null: false\n    t.integer \"price\"\n    t.text \"description\"\n    t.index [\"category_id\"], name: \"index_products_on_category_id\"\n    t.index [\"user_id\"], name: \"index_products_on_user_id\"\n  end\n\n  create_table \"users\", force: :cascade do |t|\n    t.string \"email\", default: \"\", null: false\n    t.string \"encrypted_password\", default: \"\", null: false\n    t.string \"reset_password_token\"\n    t.datetime \"reset_password_sent_at\"\n    t.datetime \"remember_created_at\"\n    t.integer \"sign_in_count\", default: 0, null: false\n    t.datetime \"current_sign_in_at\"\n    t.datetime \"last_sign_in_at\"\n    t.string \"current_sign_in_ip\"\n    t.string \"last_sign_in_ip\"\n    t.datetime \"created_at\", null: false\n    t.datetime \"updated_at\", null: false\n    t.index [\"email\"], name: \"index_users_on_email\", unique: true\n    t.index [\"reset_password_token\"], name: \"index_users_on_reset_password_token\", unique: true\n  end\n\nend\n</code></pre>\n\n<p>Whit these models: </p>\n\n<pre><code>class Category &lt; ApplicationRecord\n  has_many :products\nend\n\nclass Order &lt; ApplicationRecord\n  has_and_belongs_to_many :products\n  belongs_to :user\nend\n\nclass Product &lt; ApplicationRecord\n  has_and_belongs_to_many :orders\n  belongs_to :category\n  belongs_to :user\nend\n\nclass User &lt; ApplicationRecord\n  # Include default devise modules. Others available are:\n  # :confirmable, :lockable, :timeoutable, :trackable and :omniauthable\n  devise :database_authenticatable, :registerable,\n         :recoverable, :rememberable, :validatable\n  has_many :orders, :dependent =&gt; :destroy\n  has_many :products, :dependent =&gt; :destroy\nend\n</code></pre>\n\n<p>So basically i'm about to use a HABTOM (has_and_belongs_to_many) associations between the table Orders and Products as you can see inside my models, because an order can have many products and a product can be in many orders( here i'm not sure xD, i think i'm wrong ). Anyway, my dilemma is this, since i've read on internet that in the most of the cases, in situations like this you can use the has_many :through association (HMTA), something  like this:</p>\n\n<pre><code>class Category &lt; ApplicationRecord\n  has_many :products\nend\n\nclass User\n  has_many :orders\n  has_many :products, through: :orders\nend\n\nclass Order\n  belongs_to :user\n  belongs_to :product\nend\n\nclass Product\n  belongs_to :category\n  has_many :orders\n  has_many :users, through: :orders\nend\n</code></pre>\n\n<p>keep in mind that in my marketplace i want the people can both buy and sell, that's why a User can have many products but <strong>the product must be unique and should belong to only one specific User</strong>, for instance an old car, doesn't exist two cars exactly identical, that's why i used this association in my Product model:</p>\n\n<pre><code>class Product &lt; ApplicationRecord\n  has_and_belongs_to_many :orders\n  belongs_to :category\n  belongs_to :user\nend\n</code></pre>\n\n<p>so in the end what do you suggest me to do? should i switch from the HABTOM association to a HMTA? In this case, let's say i want to sell a product, how can i manage the User and Product association? is it possible just using a has_many :through association? Thank you</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-4"], "comments": [{"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 2, "creation_date": 1536769630, "post_id": 52299654, "comment_id": 91547109, "body": "What is not happening? Also <code>SignupHistory.where(member_id: id)[0]</code> could be <code>SignupHistory.find_by_member_id(id)</code>"}, {"owner": {"reputation": 706, "user_id": 6492146, "user_type": "registered", "accept_rate": 82, "profile_image": "https://graph.facebook.com/10157001409455137/picture?type=large", "display_name": "Verty00", "link": "https://stackoverflow.com/users/6492146/verty00"}, "reply_to_user": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1536772107, "post_id": 52299654, "comment_id": 91548314, "body": "@engineersmnky good catch. Additionally you could use <code>SignupHistory.find_by(member_id: id)</code>"}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1536773237, "post_id": 52299654, "comment_id": 91548807, "body": "Given your comments below a better understanding of schema would be a useful addition to this post. (e.g. adding the <code>User</code> and <code>SignupHistory</code> models or at least the schema declarations)"}, {"owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 0, "creation_date": 1536782088, "post_id": 52299654, "comment_id": 91552888, "body": "What is a <code>SignupHistory</code>? Why do you load all and then use the first? Are there multiple <code>SignupHistories</code> per user? Do you really update the first history record? Or the latest? Or the first without a <code>session_end</code> set? What do you try to achieve?"}, {"owner": {"reputation": 1560, "user_id": 5614748, "user_type": "registered", "accept_rate": 68, "profile_image": "https://graph.facebook.com/10153324566173505/picture?type=large", "display_name": "Afolabi Olaoluwa Akinwumi", "link": "https://stackoverflow.com/users/5614748/afolabi-olaoluwa-akinwumi"}, "reply_to_user": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 0, "creation_date": 1536787537, "post_id": 52299654, "comment_id": 91555013, "body": "@spickermann Am only trying to update a table with timestamp upon user signing out of the application."}, {"owner": {"reputation": 1560, "user_id": 5614748, "user_type": "registered", "accept_rate": 68, "profile_image": "https://graph.facebook.com/10153324566173505/picture?type=large", "display_name": "Afolabi Olaoluwa Akinwumi", "link": "https://stackoverflow.com/users/5614748/afolabi-olaoluwa-akinwumi"}, "edited": false, "score": 0, "creation_date": 1536827547, "post_id": 52299654, "comment_id": 91566354, "body": "I think the problem is because I have many records with the same ID, and my solution picking the first [0] will update the first record."}, {"owner": {"reputation": 1560, "user_id": 5614748, "user_type": "registered", "accept_rate": 68, "profile_image": "https://graph.facebook.com/10153324566173505/picture?type=large", "display_name": "Afolabi Olaoluwa Akinwumi", "link": "https://stackoverflow.com/users/5614748/afolabi-olaoluwa-akinwumi"}, "edited": false, "score": 0, "creation_date": 1536827568, "post_id": 52299654, "comment_id": 91566363, "body": "Maybe sorting and picking the last record will work"}, {"owner": {"reputation": 1918, "user_id": 9224452, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb0f303869bf090269cbcc46cef14991?s=128&d=identicon&r=PG&f=1", "display_name": "John Baker", "link": "https://stackoverflow.com/users/9224452/john-baker"}, "edited": false, "score": 0, "creation_date": 1536928827, "post_id": 52299654, "comment_id": 91611089, "body": "Since you have multiple SignupHistories per user, the only problem is finding the right record to update. I think if you pick the recent one or the record that has <code>session_end</code> value empty, would do the trick."}], "answers": [{"comments": [{"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1536769881, "post_id": 52299766, "comment_id": 91547205, "body": "OP If this is the case please also look into your <code>current_user</code> methodology as it should never return &quot;some anonymous user&quot;."}, {"owner": {"reputation": 1560, "user_id": 5614748, "user_type": "registered", "accept_rate": 68, "profile_image": "https://graph.facebook.com/10153324566173505/picture?type=large", "display_name": "Afolabi Olaoluwa Akinwumi", "link": "https://stackoverflow.com/users/5614748/afolabi-olaoluwa-akinwumi"}, "edited": false, "score": 0, "creation_date": 1536771038, "post_id": 52299766, "comment_id": 91547771, "body": "Still didnt work. It updates the first data in the database and not the correct signed out current user. If you login 7 time and sign out 7 times, the current session is what should be updated. In my case it updates only the data of your first sign in which is not current user."}, {"owner": {"reputation": 45322, "user_id": 421705, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/581b1760881c962648f99d6040d41829?s=128&d=identicon&r=PG", "display_name": "Holger Just", "link": "https://stackoverflow.com/users/421705/holger-just"}, "edited": false, "score": 1, "creation_date": 1536771164, "post_id": 52299766, "comment_id": 91547830, "body": "So if you have multiple <code>SignupHistory</code> objects / database rows per user, you have to specifically identify the one you want to update. Just selecting the first one will likely not match your current session."}, {"owner": {"reputation": 1560, "user_id": 5614748, "user_type": "registered", "accept_rate": 68, "profile_image": "https://graph.facebook.com/10153324566173505/picture?type=large", "display_name": "Afolabi Olaoluwa Akinwumi", "link": "https://stackoverflow.com/users/5614748/afolabi-olaoluwa-akinwumi"}, "edited": false, "score": 0, "creation_date": 1536771435, "post_id": 52299766, "comment_id": 91547965, "body": "@HolgerJust Thats what I thought"}, {"owner": {"reputation": 1560, "user_id": 5614748, "user_type": "registered", "accept_rate": 68, "profile_image": "https://graph.facebook.com/10153324566173505/picture?type=large", "display_name": "Afolabi Olaoluwa Akinwumi", "link": "https://stackoverflow.com/users/5614748/afolabi-olaoluwa-akinwumi"}, "edited": false, "score": 0, "creation_date": 1536827541, "post_id": 52299766, "comment_id": 91566348, "body": "I think the problem is because I have many records with the same ID, and my solution picking the first [0] will update the first record."}], "tags": [], "owner": {"reputation": 45322, "user_id": 421705, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/581b1760881c962648f99d6040d41829?s=128&d=identicon&r=PG", "display_name": "Holger Just", "link": "https://stackoverflow.com/users/421705/holger-just"}, "is_accepted": false, "score": 0, "last_activity_date": 1536769794, "creation_date": 1536769794, "answer_id": 52299766, "question_id": 52299654, "link": "https://stackoverflow.com/questions/52299654/timestamp-not-saving-on-the-right-current-user/52299766#52299766", "title": "Timestamp not saving on the right current user", "body": "<p>After running <code>clear_all_sessions</code>, you probably also invalidated the current session. Thus, after calling the method, your <code>current_user</code> method will probably return the details of some anonymous user.</p>\n\n<p>That is, your two calls to <code>current_user</code> will likely return different users. As a workaround, try to save the value of <code>current_user.id</code> in a variable on your <code>destroy</code> method first and use only this variable:</p>\n\n<pre><code>def destroy\n  id = current_user.id\n\n  clear_all_sessions id\n  save_signout_time(id)\n  reset_session\n  redirect_to root_path\nend\n</code></pre>\n"}], "owner": {"reputation": 1560, "user_id": 5614748, "user_type": "registered", "accept_rate": 68, "profile_image": "https://graph.facebook.com/10153324566173505/picture?type=large", "display_name": "Afolabi Olaoluwa Akinwumi", "link": "https://stackoverflow.com/users/5614748/afolabi-olaoluwa-akinwumi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 42, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1536769794, "creation_date": 1536769322, "question_id": 52299654, "link": "https://stackoverflow.com/questions/52299654/timestamp-not-saving-on-the-right-current-user", "title": "Timestamp not saving on the right current user", "body": "<p>The code below saves a Timestamp into <code>session_end</code>. Please don't mind the attribute name called <code>session_end</code>, its supposed to be <code>signout_time</code></p>\n\n<pre><code>class SessionsController &lt; ApplicationController\n  def destroy\n    clear_all_sessions current_user.id\n    save_signout_time(current_user.id)\n    reset_session\n    redirect_to root_path\n  end\n\n  private\n\n  def save_signout_time(id)\n    SignupHistory.where(member_id: id)[0].update(session_end: Time.now)\n  end\nend \n</code></pre>\n\n<p>I don't seems to get what am doing wrong. Any help will be appreciated.</p>\n"}, {"tags": ["sql", "ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 32131, "user_id": 2346461, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/i3xAf.jpg?s=128&g=1", "display_name": "Pavan", "link": "https://stackoverflow.com/users/2346461/pavan"}, "edited": false, "score": 0, "creation_date": 1536768655, "post_id": 52299421, "comment_id": 91546643, "body": "Which database are you using?"}, {"owner": {"reputation": 689, "user_id": 2875377, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/4a9d994f85c436f7bf13c592e6b8989e?s=128&d=identicon&r=PG&f=1", "display_name": "praga2050", "link": "https://stackoverflow.com/users/2875377/praga2050"}, "edited": false, "score": 1, "creation_date": 1536768798, "post_id": 52299421, "comment_id": 91546724, "body": "See the rails server log. what query is running. What is the column type of created_at"}, {"owner": {"reputation": 1, "user_id": 10354292, "user_type": "registered", "profile_image": "https://graph.facebook.com/10210744002230735/picture?type=large", "display_name": "Karmacy", "link": "https://stackoverflow.com/users/10354292/karmacy"}, "edited": false, "score": 0, "creation_date": 1536768801, "post_id": 52299421, "comment_id": 91546726, "body": "sqlite3 for training purposes"}, {"owner": {"reputation": 1, "user_id": 10354292, "user_type": "registered", "profile_image": "https://graph.facebook.com/10210744002230735/picture?type=large", "display_name": "Karmacy", "link": "https://stackoverflow.com/users/10354292/karmacy"}, "edited": false, "score": 0, "creation_date": 1536768873, "post_id": 52299421, "comment_id": 91546759, "body": "Report Load (0.8ms)  SELECT &quot;reports&quot;.* FROM &quot;reports&quot; WHERE &quot;reports&quot;.&quot;created_at&quot; = ?  [[&quot;created_at&quot;, &quot;2018-05-01 00:00:00&quot;]]"}, {"owner": {"reputation": 1, "user_id": 10354292, "user_type": "registered", "profile_image": "https://graph.facebook.com/10210744002230735/picture?type=large", "display_name": "Karmacy", "link": "https://stackoverflow.com/users/10354292/karmacy"}, "edited": false, "score": 0, "creation_date": 1536769006, "post_id": 52299421, "comment_id": 91546822, "body": "column type is datetime"}, {"owner": {"reputation": 2251, "user_id": 9785060, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IUduC.png?s=128&g=1", "display_name": "Viktor", "link": "https://stackoverflow.com/users/9785060/viktor"}, "edited": false, "score": 0, "creation_date": 1536769173, "post_id": 52299421, "comment_id": 91546891, "body": "I think it would be useful if you could specify if you&#39;re looking for a SQL query or ActiveRecord query. Where would you like to display those results ?"}, {"owner": {"reputation": 1, "user_id": 10354292, "user_type": "registered", "profile_image": "https://graph.facebook.com/10210744002230735/picture?type=large", "display_name": "Karmacy", "link": "https://stackoverflow.com/users/10354292/karmacy"}, "edited": false, "score": 0, "creation_date": 1536769420, "post_id": 52299421, "comment_id": 91547010, "body": "I&#39;m looking for an ActiveRecord query i guess, i would like to display those results on the index of the corresponding view. The actual displaying of the results is not really the problem, the problem is actually getting the results im looking for."}, {"owner": {"reputation": 1132, "user_id": 4568250, "user_type": "registered", "profile_image": "https://graph.facebook.com/1041166272565569/picture?type=large", "display_name": "Sidonai", "link": "https://stackoverflow.com/users/4568250/sidonai"}, "edited": false, "score": 0, "creation_date": 1536769763, "post_id": 52299421, "comment_id": 91547157, "body": "so, params[:query] is a string timestamp? what format?"}, {"owner": {"reputation": 1, "user_id": 10354292, "user_type": "registered", "profile_image": "https://graph.facebook.com/10210744002230735/picture?type=large", "display_name": "Karmacy", "link": "https://stackoverflow.com/users/10354292/karmacy"}, "edited": false, "score": 0, "creation_date": 1536769931, "post_id": 52299421, "comment_id": 91547224, "body": "params[:query] is a date from a datepicker, formatted like this: &quot;2018-05-01&quot;"}, {"owner": {"reputation": 1, "user_id": 10354292, "user_type": "registered", "profile_image": "https://graph.facebook.com/10210744002230735/picture?type=large", "display_name": "Karmacy", "link": "https://stackoverflow.com/users/10354292/karmacy"}, "edited": false, "score": 0, "creation_date": 1536770070, "post_id": 52299421, "comment_id": 91547291, "body": "entering a query basically looks like this: <a href=\"http://localhost:3000/reports?utf8=%E2%9C%93&amp;query=2018-05-01\" rel=\"nofollow noreferrer\">localhost:3000/reports?utf8=%E2%9C%93&amp;query=2018-05-01</a>"}, {"owner": {"reputation": 1, "user_id": 10354292, "user_type": "registered", "profile_image": "https://graph.facebook.com/10210744002230735/picture?type=large", "display_name": "Karmacy", "link": "https://stackoverflow.com/users/10354292/karmacy"}, "edited": false, "score": 0, "creation_date": 1536770131, "post_id": 52299421, "comment_id": 91547313, "body": "if i add a time to the query manually it does work, i just want it to ignore the time and display all the results from the requested date."}], "answers": [{"tags": [], "owner": {"reputation": 1132, "user_id": 4568250, "user_type": "registered", "profile_image": "https://graph.facebook.com/1041166272565569/picture?type=large", "display_name": "Sidonai", "link": "https://stackoverflow.com/users/4568250/sidonai"}, "is_accepted": false, "score": 0, "last_activity_date": 1536771987, "last_edit_date": 1536771987, "creation_date": 1536771460, "answer_id": 52300169, "question_id": 52299421, "link": "https://stackoverflow.com/questions/52299421/searching-timestamp-with-query-but-ignoring-the-time/52300169#52300169", "title": "Searching timestamp with query but ignoring the time", "body": "<p>You can try something like this:</p>\n\n<pre><code>def index\n  if params[:query].present?\n    @reports = Report.where(created_at: (Time.new(params[:query]).beginning_of_day()..Time.new(params[:query]).end_of_day()).all\n  else\n    @reports = Report.all\n  end\nend\n</code></pre>\n\n<p>If you need to format the results you can parse the column using all.map( ) like this</p>\n\n<pre><code>Report.where(created_at: (Time.new(params[:query]).beginning_of_day()..Time.new(params[:query]).end_of_day()).all.map{|report| report.created_at = Time.new(report.created_at).your_format }\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1197, "user_id": 400743, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1a0d5c51291898c92154ba4ac1c56cd6?s=128&d=identicon&r=PG", "display_name": "Bartosz Pietraszko", "link": "https://stackoverflow.com/users/400743/bartosz-pietraszko"}, "is_accepted": false, "score": 0, "last_activity_date": 1536772854, "creation_date": 1536772854, "answer_id": 52300477, "question_id": 52299421, "link": "https://stackoverflow.com/questions/52299421/searching-timestamp-with-query-but-ignoring-the-time/52300477#52300477", "title": "Searching timestamp with query but ignoring the time", "body": "<p>Use SQL <a href=\"https://www.sqlite.org/lang_datefunc.html\" rel=\"nofollow noreferrer\"><code>date()</code></a> function.</p>\n\n<pre><code>def index\n  @date = Date.parse(params[:query]) rescue nil\n  if @date\n    @reports = Report.where(\"date(created_at) = ?\", @date)\n  else\n    @reports = Report.all\n  end\nend\n</code></pre>\n\n<p>Do not pass <code>params[:query]</code> directly as an argument for <code>where</code> clause, parse it to <code>Date</code> object first to make sure that it's actually a date.</p>\n"}, {"tags": [], "owner": {"reputation": 21, "user_id": 10355044, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-VaS-ab9i1vs/AAAAAAAAAAI/AAAAAAAAAAo/woUI-6ThZto/photo.jpg?sz=128", "display_name": "Catherine Zarra", "link": "https://stackoverflow.com/users/10355044/catherine-zarra"}, "is_accepted": false, "score": 1, "last_activity_date": 1536780424, "creation_date": 1536780424, "answer_id": 52302105, "question_id": 52299421, "link": "https://stackoverflow.com/questions/52299421/searching-timestamp-with-query-but-ignoring-the-time/52302105#52302105", "title": "Searching timestamp with query but ignoring the time", "body": "<p>I would do something like this:</p>\n\n<pre><code>def index\n  if params[:query].present?\n    # gives a date without a time \n    date = Date.parse(params[:query])\n    @reports = Report.where(created_at: date..(date + 1.day)) \n  else\n    @reports = Report.all\n  end\nend\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1918, "user_id": 9224452, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb0f303869bf090269cbcc46cef14991?s=128&d=identicon&r=PG&f=1", "display_name": "John Baker", "link": "https://stackoverflow.com/users/9224452/john-baker"}, "is_accepted": false, "score": 0, "last_activity_date": 1536936469, "creation_date": 1536936469, "answer_id": 52334369, "question_id": 52299421, "link": "https://stackoverflow.com/questions/52299421/searching-timestamp-with-query-but-ignoring-the-time/52334369#52334369", "title": "Searching timestamp with query but ignoring the time", "body": "<p>You can try this:</p>\n\n<pre><code>def index\n  if params[:query].present?\n    date = Date.parse(params[:query])\n    @reports = Report.where(created_at: date.midnight..date.end_of_day)\n  else\n    @reports = Report.all\n  end\nend\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 10354292, "user_type": "registered", "profile_image": "https://graph.facebook.com/10210744002230735/picture?type=large", "display_name": "Karmacy", "link": "https://stackoverflow.com/users/10354292/karmacy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 99, "favorite_count": 0, "answer_count": 4, "score": 0, "last_activity_date": 1536936469, "creation_date": 1536768460, "question_id": 52299421, "link": "https://stackoverflow.com/questions/52299421/searching-timestamp-with-query-but-ignoring-the-time", "title": "Searching timestamp with query but ignoring the time", "body": "<p>geniuses!</p>\n\n<p>so in my project i'm trying to use a query to search my single-table-database by timestamp, which is formatted like this: \"2018-05-01 00:28:43\".\nIn my request i would like to ignore the time and display all the results which have the chosen date as a timestamp.</p>\n\n<p>Now i'm still learning, tried a lot of searching but could not come up with an answer. This is where i'm at:</p>\n\n<pre><code>def index\n  if params[:query].present?\n    @reports = Report.where(created_at: params[:query])\n  else\n    @reports = Report.all\n  end\nend\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "regex"], "comments": [{"owner": {"reputation": 82895, "user_id": 372239, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/2twLb.jpg?s=128&g=1", "display_name": "Toto", "link": "https://stackoverflow.com/users/372239/toto"}, "edited": false, "score": 0, "creation_date": 1536768661, "post_id": 52299373, "comment_id": 91546649, "body": "What have you tried? What didn&#39;t work?"}, {"owner": {"reputation": 1006, "user_id": 4594902, "user_type": "registered", "accept_rate": 65, "profile_image": "https://graph.facebook.com/686173344826419/picture?type=large", "display_name": "Ilja KO", "link": "https://stackoverflow.com/users/4594902/ilja-ko"}, "reply_to_user": {"reputation": 82895, "user_id": 372239, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/2twLb.jpg?s=128&g=1", "display_name": "Toto", "link": "https://stackoverflow.com/users/372239/toto"}, "edited": false, "score": 0, "creation_date": 1536768703, "post_id": 52299373, "comment_id": 91546673, "body": "3 Steps: <code>gsub(&#47;\\s\\s+&#47;, &#39; &#39;)</code>,  then <code>gsub(&#47;\\A\\W+&#47;, &#39;&#39;)</code> and then <code>gsub(&#47;[^[a-zA-z\\s!?&#228;&#246;&#252;&#196;&#196;&#214;&#220;&#223;]]&#47;, &quot;&quot;)</code>"}, {"owner": {"reputation": 82895, "user_id": 372239, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/2twLb.jpg?s=128&g=1", "display_name": "Toto", "link": "https://stackoverflow.com/users/372239/toto"}, "edited": false, "score": 0, "creation_date": 1536768805, "post_id": 52299373, "comment_id": 91546731, "body": "Remove the inner square brackets: <code>gsub(&#47;[^a-zA-z\\s!?&#228;&#246;&#252;&#196;&#196;&#214;&#220;&#223;]&#47;, &quot;&quot;)</code>"}, {"owner": {"reputation": 1006, "user_id": 4594902, "user_type": "registered", "accept_rate": 65, "profile_image": "https://graph.facebook.com/686173344826419/picture?type=large", "display_name": "Ilja KO", "link": "https://stackoverflow.com/users/4594902/ilja-ko"}, "reply_to_user": {"reputation": 82895, "user_id": 372239, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/2twLb.jpg?s=128&g=1", "display_name": "Toto", "link": "https://stackoverflow.com/users/372239/toto"}, "edited": false, "score": 0, "creation_date": 1536769317, "post_id": 52299373, "comment_id": 91546956, "body": "It didnt change anything. The onyl thing that works is removing consecutive whitepsaces. The one step you are mentioning removes all characters I dont want but chinese ones stay as ??. For the last steps I need to remove whitespaces in fron of the special characters and leading and trailing whitepaces at the beginning and the end of the title"}], "answers": [{"comments": [{"owner": {"reputation": 1006, "user_id": 4594902, "user_type": "registered", "accept_rate": 65, "profile_image": "https://graph.facebook.com/686173344826419/picture?type=large", "display_name": "Ilja KO", "link": "https://stackoverflow.com/users/4594902/ilja-ko"}, "edited": false, "score": 0, "creation_date": 1536772026, "post_id": 52299646, "comment_id": 91548256, "body": "I am working on windows and it uses CP850 so I am getting <code>Encoding::CompatibilityError: incompatible encoding regexp match (UTF-8 regexp with CP850 string)</code>"}, {"owner": {"reputation": 1006, "user_id": 4594902, "user_type": "registered", "accept_rate": 65, "profile_image": "https://graph.facebook.com/686173344826419/picture?type=large", "display_name": "Ilja KO", "link": "https://stackoverflow.com/users/4594902/ilja-ko"}, "edited": false, "score": 0, "creation_date": 1536774343, "post_id": 52299646, "comment_id": 91549346, "body": "Just tested it and all my tests are green with that thank you. And I didnt need to nromalize. The <code>strip</code> and the one with replacing spaces in front of special charachters is all I needed. Thank you for that again"}], "tags": [], "owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "is_accepted": true, "score": 0, "last_activity_date": 1536769297, "creation_date": 1536769297, "answer_id": 52299646, "question_id": 52299373, "link": "https://stackoverflow.com/questions/52299373/i-need-a-way-to-remove-non-german-letters-and-only-allow-specific-characters/52299646#52299646", "title": "I need a way to remove non-german letters and only allow specific characters", "body": "<p>The main issue here would be to <strong>unicode normalize the input to <code>:nfc</code> form</strong>:</p>\n\n<pre><code>'   \u00a7$%\"\"%&amp; \u00dcberschnell    du$\u00a7\"rch   die Nacht . ' \\\n'Genie\u00dfen Sie Ihre Aussicht , Sie Bl\u00f6dm\u4eba\u7269ann   !   $\"\u00a7 '.\n  unicode_normalize(:nfc).  # \u21d0 HERE\n  gsub(/\\s+([,.!?])/, \"\\\\1\").\n  gsub(/[^a-zA-Z,.!?\u00e4\u00f6\u00fc\u00c4\u00c4\u00d6\u00dc\u00df\\s]/, \"\").\n  strip.\n  squeeze\n\n#\u21d2 \"\u00dcberschnel durch die Nacht. Genie\u00dfen Sie Ihre Ausicht, Sie Bl\u00f6dman!\"\n</code></pre>\n"}], "owner": {"reputation": 1006, "user_id": 4594902, "user_type": "registered", "accept_rate": 65, "profile_image": "https://graph.facebook.com/686173344826419/picture?type=large", "display_name": "Ilja KO", "link": "https://stackoverflow.com/users/4594902/ilja-ko"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 53, "favorite_count": 0, "accepted_answer_id": 52299646, "answer_count": 1, "score": 0, "last_activity_date": 1536772360, "creation_date": 1536768284, "last_edit_date": 1536772360, "question_id": 52299373, "link": "https://stackoverflow.com/questions/52299373/i-need-a-way-to-remove-non-german-letters-and-only-allow-specific-characters", "title": "I need a way to remove non-german letters and only allow specific characters", "body": "<p>I want to gsub a String so that I have a string in the end which has </p>\n\n<ul>\n<li>only german letters and normal Numbers</li>\n<li>no special characters except <code>,</code>  <code>.</code> <code>?</code> and <code>!</code></li>\n<li>no leading or trailing non-printable characters</li>\n<li>no consecutive non-printable characters, there should only be one space between words</li>\n<li>there should be no whitespace in front of the allowed special characters <code>.</code> <code>,</code> <code>?</code> <code>!</code></li>\n<li>the <code>,</code> and <code>.</code> is not allowed to be the last character</li>\n</ul>\n\n<p>Example (On two lines to be more visible for you):</p>\n\n<pre><code>'   \u00a7$%\"\"%&amp; \u00dcberschnell    du$\u00a7\"rch   die Nacht .\n    Genie\u00dfen Sie Ihre Aussicht , Sie Bl\u00f6dm\u4eba\u7269ann   !   $\"\u00a7 '\n</code></pre>\n\n<p>Should become:</p>\n\n<pre><code>'\u00dcberschnell durch die Nacht. Genie\u00dfen Sie Ihre Aussicht, Sie Bl\u00f6dmann!'\n</code></pre>\n\n<p>I hope it is clear what I need to the string to happen. Its for prettier titles in my Rails app when the user types anything that isnt English or german or doesnt care about right punctuation or so.</p>\n\n<p>Edit: This is what works ok at the moment thanks to @mudasobwa</p>\n\n<pre><code>irb(main):021:0&gt; str='   \u00a7$%\"\"%&amp; \u00dcberschnell    du$\u00a7\"rch   die Nacht .   Genie\u00dfen Sie Ihre Aussicht , Sie Bl\u00f6dm??an&gt;\n=&gt; \"   \\xF5$%\\\"\\\"%&amp; \\x9Aberschnell    du$\\xF5\\\"rch   die Nacht .   Genie\\xE1en Sie Ihre Aussicht , Sie Bl\\x94dm??ann   !   $\\\"\\xF5 \"\n\nirb(main):016:0&gt; str=str.gsub(/\\s\\s+/, ' ')\n=&gt; \" \\xF5$%\\\"\\\"%&amp; \\x9Aberschnell du$\\xF5\\\"rch die Nacht . Genie\\xE1en Sie Ihre Aussicht , Sie Bl\\x94dm??ann ! $\\\"\\xF5 \"\n\nirb(main):017:0&gt; str=str.gsub(/[^a-zA-z\\s!?.,\u00e4\u00f6\u00fc\u00c4\u00c4\u00d6\u00dc\u00df]/, \"\")\n=&gt; \"  \\x9Aberschnell durch die Nacht . Genie\\xE1en Sie Ihre Aussicht , Sie Bl\\x94dm??ann !  \"\n\nirb(main):018:0&gt; str=str.gsub(/\\s+([,.!?])/, \"\\\\1\")\n=&gt; \"  \\x9Aberschnell durch die Nacht. Genie\\xE1en Sie Ihre Aussicht, Sie Bl\\x94dm??ann!  \"\n\nirb(main):019:0&gt; str=str.strip\n=&gt; \"\\x9Aberschnell durch die Nacht. Genie\\xE1en Sie Ihre Aussicht, Sie Bl\\x94dm??ann!\"\n\nirb(main):020:0&gt; str=str.encode(\"UTF-8\").unicode_normalize(:nfc)\n=&gt; \"\u00dcberschnell durch die Nacht. Genie\u00dfen Sie Ihre Aussicht, Sie Bl\u00f6dm??ann!\"\n</code></pre>\n\n<p>But when on Windows I get a <code>Encoding::CompatibilityError: incompatible encoding regexp match (UTF-8 regexp with CP850 string)</code></p>\n\n<p>Will this happen in the production app on HEroku also or can I just use this without worrying??</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "api", "ruby-on-rails-5", "rails-api"], "answers": [{"tags": [], "owner": {"reputation": 672, "user_id": 8748686, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gPuB7.jpg?s=128&g=1", "display_name": "John Skiles Skinner", "link": "https://stackoverflow.com/users/8748686/john-skiles-skinner"}, "is_accepted": false, "score": 0, "last_activity_date": 1536777445, "creation_date": 1536777445, "answer_id": 52301500, "question_id": 52299336, "link": "https://stackoverflow.com/questions/52299336/leaderboard-for-sum-of-points-number-of-games/52301500#52301500", "title": "Leaderboard for sum of points / number of games", "body": "<p>To get the sum of a user's points from all their stats:</p>\n\n<pre><code>user_sum_points = user.stats.map(&amp;:points).compact.sum\n</code></pre>\n\n<p>I'm not quite sure what second number you are asking for. Are you planning to divide by the total number of matches a user has played? If so, then you can count the unique ids of their matches:</p>\n\n<pre><code>user_num_matches = user.stats.map(&amp;:match_id).uniq.length\n</code></pre>\n\n<p>Finally, do the division:</p>\n\n<pre><code>(user_sum_points / user_num_matches) unless user_num_matches == 0\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 9663, "user_id": 5239030, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/76JEw.png?s=128&g=1", "display_name": "iGian", "link": "https://stackoverflow.com/users/5239030/igian"}, "is_accepted": false, "score": 1, "last_activity_date": 1536784876, "creation_date": 1536784876, "answer_id": 52303169, "question_id": 52299336, "link": "https://stackoverflow.com/questions/52299336/leaderboard-for-sum-of-points-number-of-games/52303169#52303169", "title": "Leaderboard for sum of points / number of games", "body": "<p>I think you can further refine the query, but this should work joining User and Stat ang grouping by user_id.</p>\n\n<p>In controller:</p>\n\n<pre><code>@users = User.joins(:match_stats)\n             .group('users.id')\n             .select(\"users.name AS name, SUM(match_stats.points) as tot_points, COUNT(DISTINCT match_stats.match_id) AS tot_matches, (SUM(match_stats.points)/COUNT(DISTINCT match_stats.match_id)) AS average_points_per_match\")\n             .order(\"average_points_per_match DESC\")\n             .limit(10)\n</code></pre>\n\n<p>And in view (very basic):</p>\n\n<pre><code>&lt;% @users.each do |user| %&gt;\n  &lt;p&gt;&lt;%= user.name %&gt; | &lt;%= user.tot_points %&gt; | &lt;%= user.tot_matches %&gt; | &lt;%= user.average_points_per_match %&gt;&lt;/p&gt;\n&lt;% end %&gt;\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 117, "user_id": 10068674, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-8gRv54FhhWE/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7oH6R244hnLFuogLjfnpdDcQc_9-w/mo/photo.jpg?sz=128", "display_name": "some thing", "link": "https://stackoverflow.com/users/10068674/some-thing"}, "is_accepted": false, "score": 0, "last_activity_date": 1536820543, "creation_date": 1536820543, "answer_id": 52307885, "question_id": 52299336, "link": "https://stackoverflow.com/questions/52299336/leaderboard-for-sum-of-points-number-of-games/52307885#52307885", "title": "Leaderboard for sum of points / number of games", "body": "<p>my old code:  </p>\n\n<pre><code>stat= section\n    .group(:user_id)\n    .select(\"user_id, count(*) as matches_count, sum(points) as score\")\n    .where.not(match_id: nil)\n</code></pre>\n\n<p>turn to this: </p>\n\n<pre><code>stat= section\n    .group(:user_id)\n    .select(\"user_id, COUNT(DISTINCT match_id) as matches_count, sum(points) as score\")\n    .where.not(match_id: nil)\n</code></pre>\n\n<p>Fixed this by using <code>COUNT(DISTINCT match_id)</code> instead of <code>COUNT(*)</code>. Thanks! Credit to: @Ovidiu Toma</p>\n"}], "owner": {"reputation": 117, "user_id": 10068674, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-8gRv54FhhWE/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7oH6R244hnLFuogLjfnpdDcQc_9-w/mo/photo.jpg?sz=128", "display_name": "some thing", "link": "https://stackoverflow.com/users/10068674/some-thing"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 63, "favorite_count": 0, "answer_count": 3, "score": 1, "last_activity_date": 1536820543, "creation_date": 1536768159, "question_id": 52299336, "link": "https://stackoverflow.com/questions/52299336/leaderboard-for-sum-of-points-number-of-games", "title": "Leaderboard for sum of points / number of games", "body": "<p>I've got stat model : </p>\n\n<pre><code>Stat(id: integer, points: float, user_id: integer, match_id: integer, team_id: integer)\n</code></pre>\n\n<p>For match model: </p>\n\n<pre><code> Match(id: integer, team_a_id: integer, team_b_id: integer)\n</code></pre>\n\n<p>Stat can be duplicate with same <code>user_id</code> and <code>match_id</code>. What I need is to get the <code>SUM</code> of points for each <code>user_id</code> then divide it to number of <code>match_id</code> which is games played. </p>\n\n<p>Example:</p>\n\n<pre><code>{id: 1, points: 2, user_id: 1, match_id: 1, team_id: 1}\n{id: 2, points: 3, user_id: 1, match_id: 1, team_id: 1}\n{id: 3, points: 4, user_id: 1, match_id: 2, team_id: 1}\n</code></pre>\n\n<p>So here I got 2 game. I need to get the sum of points of <code>user_id</code> then divide it to number of his game which is 2 (match_id 1 and 2). Then get the top 10 highest pointer.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "testing", "factory-bot"], "answers": [{"comments": [{"owner": {"reputation": 7633, "user_id": 417449, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/313df1d3543ef456912017412509a395?s=128&d=identicon&r=PG", "display_name": "Noah Clark", "link": "https://stackoverflow.com/users/417449/noah-clark"}, "edited": false, "score": 0, "creation_date": 1536776201, "post_id": 52299310, "comment_id": 91550197, "body": "This would work to solve the problem listed above, but I&#39;m running into an issue where this is being done in a call back upon creation. So, the creation blows up before it gets the approval created."}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "reply_to_user": {"reputation": 7633, "user_id": 417449, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/313df1d3543ef456912017412509a395?s=128&d=identicon&r=PG", "display_name": "Noah Clark", "link": "https://stackoverflow.com/users/417449/noah-clark"}, "edited": false, "score": 0, "creation_date": 1536812591, "post_id": 52299310, "comment_id": 91560406, "body": "Then just assign the value instead of calling update_attributes."}, {"owner": {"reputation": 7633, "user_id": 417449, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/313df1d3543ef456912017412509a395?s=128&d=identicon&r=PG", "display_name": "Noah Clark", "link": "https://stackoverflow.com/users/417449/noah-clark"}, "edited": false, "score": 0, "creation_date": 1536843080, "post_id": 52299310, "comment_id": 91575351, "body": "It never gets to that step because the association blows up. I think there is a better way to structure the factories that I&#39;m playing around with."}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "reply_to_user": {"reputation": 7633, "user_id": 417449, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/313df1d3543ef456912017412509a395?s=128&d=identicon&r=PG", "display_name": "Noah Clark", "link": "https://stackoverflow.com/users/417449/noah-clark"}, "edited": false, "score": 0, "creation_date": 1536848067, "post_id": 52299310, "comment_id": 91578579, "body": "Create the <code>approval</code> association inside the <code>after</code> callback."}], "tags": [], "owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "is_accepted": false, "score": 0, "last_activity_date": 1536768059, "creation_date": 1536768059, "answer_id": 52299310, "question_id": 52299159, "link": "https://stackoverflow.com/questions/52299159/factorybot-eventable-id/52299310#52299310", "title": "FactoryBot Eventable ID", "body": "<p>Cross-references might be resolved with <code>after</code> clause as <a href=\"https://github.com/thoughtbot/factory_bot/wiki/Example-factories.rb-file\" rel=\"nofollow noreferrer\">shown here</a>:</p>\n\n<pre><code>factory :order_with_approval do\n  status 'approved'\n  association :approval, factory: :approval\n\n  after(:build, :create) do |order, _evaluator|\n    order.approval.update_attributes!(eventable: order)\n  end\nend\n</code></pre>\n"}], "owner": {"reputation": 7633, "user_id": 417449, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/313df1d3543ef456912017412509a395?s=128&d=identicon&r=PG", "display_name": "Noah Clark", "link": "https://stackoverflow.com/users/417449/noah-clark"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 36, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1536768059, "creation_date": 1536767496, "last_edit_date": 1536767935, "question_id": 52299159, "link": "https://stackoverflow.com/questions/52299159/factorybot-eventable-id", "title": "FactoryBot Eventable ID", "body": "<p>I have a factory that looks like:</p>\n\n<pre><code>factory :order_with_approval do\n   status      'approved'\n   association :approval, factory: :approval\nend\n</code></pre>\n\n<p>Now, I need the approval model to take the order id and set it as the eventable id. I've been able to figure this out in the other direction by doing: </p>\n\n<pre><code>factory :cancellation do\n  reason 'a reason'\n  cancellation_date Date.current\n  association :eventable, factory: :order\nend\n</code></pre>\n\n<p>So what might work is if I can pass in something other than a new factory into the association. What I'd like to do is pass in the parent factory. Is that possible? Can I achieve this some other way?</p>\n"}, {"tags": ["ruby", "regex", "regex-group"], "answers": [{"comments": [{"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1536764930, "post_id": 52298272, "comment_id": 91544474, "body": "It would work for <code>scan</code>, but would not work for <code>gsub</code>. The matches are actually empty."}, {"owner": {"reputation": 32214, "user_id": 1977903, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/C7rRA.png?s=128&g=1", "display_name": "bragboy", "link": "https://stackoverflow.com/users/1977903/bragboy"}, "reply_to_user": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1536765065, "post_id": 52298272, "comment_id": 91544546, "body": "Ah, thanks for the info. I was actually looking for a solution for <code>scan</code>. Good to know that it will not work <code>gsub</code>"}], "tags": [], "owner": {"reputation": 32214, "user_id": 1977903, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/C7rRA.png?s=128&g=1", "display_name": "bragboy", "link": "https://stackoverflow.com/users/1977903/bragboy"}, "is_accepted": false, "score": -1, "last_activity_date": 1536764691, "last_edit_date": 1536764691, "creation_date": 1536764618, "answer_id": 52298272, "question_id": 52298173, "link": "https://stackoverflow.com/questions/52298173/regex-capture-an-overlapping-pattern/52298272#52298272", "title": "Regex: Capture an overlapping pattern", "body": "<p>Found out the answer (referenced from the duplicate post)</p>\n\n<p><code>(?=(pack my box.{0,14}))\n</code></p>\n\n<p><a href=\"https://i.stack.imgur.com/Xre0i.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Xre0i.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 32214, "user_id": 1977903, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/C7rRA.png?s=128&g=1", "display_name": "bragboy", "link": "https://stackoverflow.com/users/1977903/bragboy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 67, "favorite_count": 1, "closed_date": 1536764654, "answer_count": 1, "score": 0, "last_activity_date": 1536764691, "creation_date": 1536764272, "question_id": 52298173, "link": "https://stackoverflow.com/questions/52298173/regex-capture-an-overlapping-pattern", "closed_reason": "Duplicate", "title": "Regex: Capture an overlapping pattern", "body": "<p>I would want to capture all combinations of my pattern even if it is overlapped.</p>\n\n<p><strong>Sample text</strong></p>\n\n<blockquote>\n  <p>pack my box 12345 pack my box 67890 blah blah far away another pack my box 99999 is present</p>\n</blockquote>\n\n<p><strong>Expected output</strong></p>\n\n<pre><code>Match 1 - pack my box 12345 pack my\nMatch 2 - pack my box 67890 blah bl\nMatch 3 - pack my box 99999 is pres\n</code></pre>\n\n<p><strong>Regex</strong></p>\n\n<blockquote>\n  <p>/pack my box.{0,14}/</p>\n</blockquote>\n\n<p>However, <code>Match 2</code> is not outputted since it is overlapping with 1.</p>\n\n<p><a href=\"http://rubular.com/\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/kUHEA.png\" alt=\"enter image description here\"></a></p>\n\n<p>Obviously, this is an <a href=\"http://sscce.org/\" rel=\"nofollow noreferrer\">SSCCE</a> version of a bigger problem.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "security", "heroku"], "comments": [{"owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 0, "creation_date": 1536764418, "post_id": 52298171, "comment_id": 91544168, "body": "When someone has access to the Rails console, doesn&#39;t that mean that he able to change all code and remove this check anyway? Or that he could just read the database credentials and connect directly?"}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "reply_to_user": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 0, "creation_date": 1536764648, "post_id": 52298171, "comment_id": 91544312, "body": "@spickermann full rails console - yeah. But maybe some kind of sandboxed web console can be implemented. One that shields its internals while being powerful enough to be useful."}], "answers": [{"tags": [], "owner": {"reputation": 29107, "user_id": 122080, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/6fa1cdda524d49996a8bc6917328de3d?s=128&d=identicon&r=PG", "display_name": "Damien MATHIEU", "link": "https://stackoverflow.com/users/122080/damien-mathieu"}, "is_accepted": false, "score": 2, "last_activity_date": 1536770691, "creation_date": 1536770691, "answer_id": 52299986, "question_id": 52298171, "link": "https://stackoverflow.com/questions/52298171/how-can-i-log-all-rails-production-console-access-on-heroku/52299986#52299986", "title": "How can I log all Rails production console access on Heroku?", "body": "<p>Heroku doesn't give you any way to do that automatically.<br>\nConsoles are code being executed though. So you could log the start of a <code>bin/console</code> wherever you want, and ask the person for their reason as the beginning of the session.</p>\n\n<p>As mentioned by spickermann in the comments, people with push access would be able to override that. But Heroku logs all deployments. So if someone tried doing that, you'd know about it too.</p>\n"}], "owner": {"reputation": 151, "user_id": 888398, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/25e2f99ea6ae202cd2c5cff6bbf89197?s=128&d=identicon&r=PG", "display_name": "hash12", "link": "https://stackoverflow.com/users/888398/hash12"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 84, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1536770691, "creation_date": 1536764265, "question_id": 52298171, "link": "https://stackoverflow.com/questions/52298171/how-can-i-log-all-rails-production-console-access-on-heroku", "title": "How can I log all Rails production console access on Heroku?", "body": "<p>I would like to incorporate company policy into the Rails console so that any customer data being accessed via the console is logged and saved.</p>\n\n<p>Ideally, whenever a developer opens up the console, it should ask him/her for the reason they are doing so along with the customer context if any, and then save any commands run in that session. This log should be stored somewhere and ideally land up in the Inbox of someone who monitors these things.</p>\n\n<p>My question is if such a paradigm exists already on Heroku, and addon, or through a gem, or if not, some direction on how this can be implemented?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-4"], "comments": [{"owner": {"reputation": 51013, "user_id": 976775, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/30bd66ad1795804aebe249d8bcb14409?s=128&d=identicon&r=PG", "display_name": "MrYoshiji", "link": "https://stackoverflow.com/users/976775/mryoshiji"}, "edited": false, "score": 0, "creation_date": 1536763000, "post_id": 52297630, "comment_id": 91543294, "body": "You may want to approach this the other way and instead have some Javascript making XHR calls every X minutes from the client&#39;s browser in order to give you the opportunity to log each of those events. Then, you can simply know when the user was <i>not</i> using your website by checking the &quot;logged-in and displaying the page&quot; events. This period XHR call could send relevant data like a timestamp, the IP of the client, maybe the current page displayed, etc."}, {"owner": {"reputation": 1560, "user_id": 5614748, "user_type": "registered", "accept_rate": 68, "profile_image": "https://graph.facebook.com/10153324566173505/picture?type=large", "display_name": "Afolabi Olaoluwa Akinwumi", "link": "https://stackoverflow.com/users/5614748/afolabi-olaoluwa-akinwumi"}, "reply_to_user": {"reputation": 51013, "user_id": 976775, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/30bd66ad1795804aebe249d8bcb14409?s=128&d=identicon&r=PG", "display_name": "MrYoshiji", "link": "https://stackoverflow.com/users/976775/mryoshiji"}, "edited": false, "score": 0, "creation_date": 1536763154, "post_id": 52297630, "comment_id": 91543397, "body": "@MrYoshiji can you help me with a solution? Any code do deal with that?"}, {"owner": {"reputation": 51013, "user_id": 976775, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/30bd66ad1795804aebe249d8bcb14409?s=128&d=identicon&r=PG", "display_name": "MrYoshiji", "link": "https://stackoverflow.com/users/976775/mryoshiji"}, "edited": false, "score": 0, "creation_date": 1536763157, "post_id": 52297630, "comment_id": 91543400, "body": "To extend my suggestion: You can also implement a &quot;compressor&quot; script to convert those raw events into period of activity by finding consecutive events for the same user."}, {"owner": {"reputation": 51013, "user_id": 976775, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/30bd66ad1795804aebe249d8bcb14409?s=128&d=identicon&r=PG", "display_name": "MrYoshiji", "link": "https://stackoverflow.com/users/976775/mryoshiji"}, "edited": false, "score": 0, "creation_date": 1536763297, "post_id": 52297630, "comment_id": 91543485, "body": "A simple AJAX call inside a setTimeout defined in your application layout - only if the user is signed in I presume - to a controller endpoint storing this event should do the trick."}], "owner": {"reputation": 1560, "user_id": 5614748, "user_type": "registered", "accept_rate": 68, "profile_image": "https://graph.facebook.com/10153324566173505/picture?type=large", "display_name": "Afolabi Olaoluwa Akinwumi", "link": "https://stackoverflow.com/users/5614748/afolabi-olaoluwa-akinwumi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 27, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1536763780, "creation_date": 1536762672, "last_edit_date": 1536763780, "question_id": 52297630, "link": "https://stackoverflow.com/questions/52297630/updating-database-attribute-based-on-some-calculated-logic", "title": "updating database attribute based on some calculated logic", "body": "<p>Here is what I am willing to do:</p>\n\n<ul>\n<li>..save into database (signup_history's table) the value inside created_at + session timeout defined with ENV['SESSION_EXPIRE']</li>\n<li>..then, when a user signs out (i.e in the SessionsController#destroy action), override session_end column with current_time (i.e. Time.now)</li>\n</ul>\n\n<p><strong>SessionsController#destroy</strong></p>\n\n<pre><code>def destroy\n  clear_all_sessions current_user.id\n  reset_session\n  redirect_to root_path\nend\n\n\ndef save_signup_history(member_id)\n  SignupHistory.create(\n    member_id: member_id,\n    email_id: @member.email,\n    ip: request.remote_ip, # Useful for Remote IP\n    accept_language: request.headers[\"Accept-Language\"],\n    ua: request.headers[\"User-Agent\"],\n    login_location: get_ip_location(request.remote_ip), # returns remote login location\n  )\nend\n</code></pre>\n\n<p><strong>This is what I have done but am confused of my logic</strong></p>\n\n<pre><code>def session_end_method\n  if session.destroy\n    Time.now\n  else\n    SignupHistory.created_at + ENV['SESSION_EXPIRE']\n  end\nend\n\ndef update_signup_history\n  SignupHistory.update(\n    session_end: session_end_method # call the method that is doing the logic so the value can be updated into the cell.\n  )\nend\n</code></pre>\n\n<p>But this doesn't work and I can agree its not a robust solution. Can someone please help me? All I want to do is update the column session_end in the database based on my explanation.</p>\n\n<p>As you can see from the picture below, session_end aint saving anything in the database.</p>\n\n<p><a href=\"https://i.stack.imgur.com/tZwaC.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/tZwaC.png\" alt=\"session_end\"></a></p>\n"}, {"tags": ["ruby-on-rails", "ruby", "haml"], "comments": [{"owner": {"reputation": 79498, "user_id": 298624, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/5b84ccc2f7709bbb7105baeb40e0961b?s=128&d=identicon&r=PG", "display_name": "fl00r", "link": "https://stackoverflow.com/users/298624/fl00r"}, "edited": false, "score": 1, "creation_date": 1536759705, "post_id": 52296426, "comment_id": 91541112, "body": "you might have <code>= render &#39;projects&#47;cta_banner_guest_presta.html.haml&#39;</code> somewhere else"}, {"owner": {"reputation": 1012, "user_id": 10347572, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iottG.jpg?s=128&g=1", "display_name": "escanxr", "link": "https://stackoverflow.com/users/10347572/escanxr"}, "reply_to_user": {"reputation": 79498, "user_id": 298624, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/5b84ccc2f7709bbb7105baeb40e0961b?s=128&d=identicon&r=PG", "display_name": "fl00r", "link": "https://stackoverflow.com/users/298624/fl00r"}, "edited": false, "score": 0, "creation_date": 1536759824, "post_id": 52296426, "comment_id": 91541182, "body": "hi @fl00r, this is the only one (not the same mistake twice haha)"}, {"owner": {"reputation": 79498, "user_id": 298624, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/5b84ccc2f7709bbb7105baeb40e0961b?s=128&d=identicon&r=PG", "display_name": "fl00r", "link": "https://stackoverflow.com/users/298624/fl00r"}, "edited": false, "score": 0, "creation_date": 1536759930, "post_id": 52296426, "comment_id": 91541250, "body": "it&#39;s haml, then you might have indentation problems. In your question, the indentation is not valid for example. You have an extra tab before render."}, {"owner": {"reputation": 1012, "user_id": 10347572, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iottG.jpg?s=128&g=1", "display_name": "escanxr", "link": "https://stackoverflow.com/users/10347572/escanxr"}, "reply_to_user": {"reputation": 79498, "user_id": 298624, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/5b84ccc2f7709bbb7105baeb40e0961b?s=128&d=identicon&r=PG", "display_name": "fl00r", "link": "https://stackoverflow.com/users/298624/fl00r"}, "edited": false, "score": 0, "creation_date": 1536760305, "post_id": 52296426, "comment_id": 91541485, "body": "the indentation is also right, I had to do it with whitespace in the post so it&#39;s a bit different from my code (but all is good, I checked before to ask)"}, {"owner": {"reputation": 79498, "user_id": 298624, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/5b84ccc2f7709bbb7105baeb40e0961b?s=128&d=identicon&r=PG", "display_name": "fl00r", "link": "https://stackoverflow.com/users/298624/fl00r"}, "edited": false, "score": 2, "creation_date": 1536760503, "post_id": 52296426, "comment_id": 91541623, "body": "Again. That&#39;s invalid haml in your question."}, {"owner": {"reputation": 1012, "user_id": 10347572, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iottG.jpg?s=128&g=1", "display_name": "escanxr", "link": "https://stackoverflow.com/users/10347572/escanxr"}, "reply_to_user": {"reputation": 79498, "user_id": 298624, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/5b84ccc2f7709bbb7105baeb40e0961b?s=128&d=identicon&r=PG", "display_name": "fl00r", "link": "https://stackoverflow.com/users/298624/fl00r"}, "edited": false, "score": 0, "creation_date": 1536761548, "post_id": 52296426, "comment_id": 91542289, "body": "@floor i changed this, but it&#39;s not the problem with the banner"}, {"owner": {"reputation": 79498, "user_id": 298624, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/5b84ccc2f7709bbb7105baeb40e0961b?s=128&d=identicon&r=PG", "display_name": "fl00r", "link": "https://stackoverflow.com/users/298624/fl00r"}, "edited": false, "score": 2, "creation_date": 1536762085, "post_id": 52296426, "comment_id": 91542697, "body": "ok, now your code is valid and doesn&#39;t have any issues, so the problem is somewhere else. Double check if you render <code>projects&#47;cta_banner_guest_presta.html.haml</code> somewhere else."}], "answers": [{"comments": [{"owner": {"reputation": 1012, "user_id": 10347572, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iottG.jpg?s=128&g=1", "display_name": "escanxr", "link": "https://stackoverflow.com/users/10347572/escanxr"}, "edited": false, "score": 0, "creation_date": 1536761497, "post_id": 52296922, "comment_id": 91542258, "body": "I had this before, you&#39;re right, I returned to this solution. But it&#39;s not the problem, the banner still here if i&#39;m connected and there is no offers"}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "reply_to_user": {"reputation": 1012, "user_id": 10347572, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iottG.jpg?s=128&g=1", "display_name": "escanxr", "link": "https://stackoverflow.com/users/10347572/escanxr"}, "edited": false, "score": 3, "creation_date": 1536761868, "post_id": 52296922, "comment_id": 91542516, "body": "@escanxr &quot; the banner still here if i&#39;m connected and there is no offers&quot; - judging from the code you posted so far in this question, this seems to be impossible. I&#39;m afraid we&#39;ll need some kind of <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> (to even see the problem)"}], "tags": [], "owner": {"reputation": 1233, "user_id": 7960859, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/tyaFp.png?s=128&g=1", "display_name": "obermillerk", "link": "https://stackoverflow.com/users/7960859/obermillerk"}, "is_accepted": false, "score": 0, "last_activity_date": 1536761290, "last_edit_date": 1536761290, "creation_date": 1536760539, "answer_id": 52296922, "question_id": 52296426, "link": "https://stackoverflow.com/questions/52296426/why-do-i-have-to-put-the-condition-twice/52296922#52296922", "title": "Why do I have to put the condition twice?", "body": "<p>Your helper is doing nothing. You're just returning nil if that condition is met (or if it isn't). Instead, just return that long Boolean logic and have an <code>- if cta_banner_position(@offers, index)</code>. This will fix the indentation issue that @fl00r mentioned, since there was nothing for your cta banner to be nested under previously. </p>\n\n<p>I don't think the helper was even being called before, usually need a - in front of Ruby for it to execute in haml</p>\n"}], "owner": {"reputation": 1012, "user_id": 10347572, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iottG.jpg?s=128&g=1", "display_name": "escanxr", "link": "https://stackoverflow.com/users/10347572/escanxr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 70, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1536761411, "creation_date": 1536759032, "last_edit_date": 1536761411, "question_id": 52296426, "link": "https://stackoverflow.com/questions/52296426/why-do-i-have-to-put-the-condition-twice", "title": "Why do I have to put the condition twice?", "body": "<p>I don't really have a problem, but I don't understand the solution.</p>\n\n<p>On the project view (show), I check if the viewer is connected. If not, I render a banner at a certain position depending on the number of offers.</p>\n\n<p><strong>Offers view (rendered within the project view):</strong></p>\n\n<pre><code>- @offers.each_with_index do |offer, index|\n\n   - if !user_signed_in? &amp;&amp; (@project.published? || @project.pending_attribution?)\n      - if cta_banner_position(@offers, index)\n         = render 'projects/cta_banner_guest_presta.html.haml'\n</code></pre>\n\n<p><strong>cta_banner_position helper:</strong></p>\n\n<pre><code>def cta_banner_position(offer, index)\n   index == 2 || (offer.size == 2 &amp;&amp; index == 1) || (offer.size == 1 &amp;&amp; index == 0)\nend\n</code></pre>\n\n<p><strong>The rendered banner:</strong></p>\n\n<pre><code>.row\n   .col-md-12\n      .project-cta.p-5.mb-2.text-center\n         %h5\n            %strong\n               blabla\n          %p.text-muted blabla\n          %p.m-0\n             = link_to \"Send a quote\", \"\", class: \"btn btn-primary px-3\", data: { toggle: 'modal', target: '#modal-sign' }, onclick: \"ga('send', 'event', 'button', 'Clic', 'Projects signup inoffers');\", tabindex: -1\n</code></pre>\n\n<p>I use each_with_index to obtain the position and set the banner, this works but, if I'm connected, I can see the banner (despite the !user_signed_in condition) ONLY if there no offer.</p>\n\n<p>I don't understand why I have the rendered banner while I'm connected.\nTo solve this problem, I also must add \" <em>- if !user_signed_in?</em> \" at the top of the banner file. When I do it, the banner stops showing if I'm signed in.</p>\n\n<p>Could anyone explain to me why he ignores the first condition, and especially why only when there is no offer?</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 0, "creation_date": 1536758186, "post_id": 52295623, "comment_id": 91540005, "body": "Where do you expect to see <code>puts</code> printing its message to? STDOUT? A log files? The next web page?"}, {"owner": {"reputation": 1431, "user_id": 729535, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5593abb6ec21bc7a9c2070a82a27e4e3?s=128&d=identicon&r=PG", "display_name": "Luiz Carvalho", "link": "https://stackoverflow.com/users/729535/luiz-carvalho"}, "reply_to_user": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 0, "creation_date": 1536762526, "post_id": 52295623, "comment_id": 91543006, "body": "Hello @spickermann in STDOUT!"}, {"owner": {"reputation": 13442, "user_id": 3982562, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2a3c7aae1d762372cda697833c602ec8?s=128&d=identicon&r=PG", "display_name": "3limin4t0r", "link": "https://stackoverflow.com/users/3982562/3limin4t0r"}, "edited": false, "score": 0, "creation_date": 1536762827, "post_id": 52295623, "comment_id": 91543189, "body": "Can we get the part of the server log that says what request is made and which controller/action handled the request? We currently don&#39;t have much to go on."}, {"owner": {"reputation": 1431, "user_id": 729535, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5593abb6ec21bc7a9c2070a82a27e4e3?s=128&d=identicon&r=PG", "display_name": "Luiz Carvalho", "link": "https://stackoverflow.com/users/729535/luiz-carvalho"}, "reply_to_user": {"reputation": 13442, "user_id": 3982562, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2a3c7aae1d762372cda697833c602ec8?s=128&d=identicon&r=PG", "display_name": "3limin4t0r", "link": "https://stackoverflow.com/users/3982562/3limin4t0r"}, "edited": false, "score": 0, "creation_date": 1536772292, "post_id": 52295623, "comment_id": 91548401, "body": "@JohanWentholt yes of course, I&#39;ll edit post again. And show it for you. But this controller are simplified to make more readable."}], "answers": [{"tags": [], "owner": {"reputation": 1431, "user_id": 729535, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5593abb6ec21bc7a9c2070a82a27e4e3?s=128&d=identicon&r=PG", "display_name": "Luiz Carvalho", "link": "https://stackoverflow.com/users/729535/luiz-carvalho"}, "is_accepted": true, "score": 1, "last_activity_date": 1536774553, "creation_date": 1536774553, "answer_id": 52300880, "question_id": 52295623, "link": "https://stackoverflow.com/questions/52295623/how-to-set-a-before-action-to-route-method-in-stealth-bot-framework/52300880#52300880", "title": "How to set a before_action to route method in Stealth bot framework?", "body": "<p>Ok, I know the reason to this not work, <a href=\"https://github.com/hellostealth/stealth/blob/master/lib/stealth/controller/controller.rb#L36\" rel=\"nofollow noreferrer\">route</a> is not a action, is only a special method of <code>Stealth::Controller</code>, so callbacks will not called by <code>before_action</code> or another callback.</p>\n"}], "owner": {"reputation": 1431, "user_id": 729535, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5593abb6ec21bc7a9c2070a82a27e4e3?s=128&d=identicon&r=PG", "display_name": "Luiz Carvalho", "link": "https://stackoverflow.com/users/729535/luiz-carvalho"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 32, "favorite_count": 0, "accepted_answer_id": 52300880, "answer_count": 1, "score": 2, "last_activity_date": 1536774553, "creation_date": 1536756519, "last_edit_date": 1536772815, "question_id": 52295623, "link": "https://stackoverflow.com/questions/52295623/how-to-set-a-before-action-to-route-method-in-stealth-bot-framework", "title": "How to set a before_action to route method in Stealth bot framework?", "body": "<p>I'm trying use <code>before_action's</code> callback in my <a href=\"https://github.com/hellostealth/stealth/\" rel=\"nofollow noreferrer\">Stealth</a> Bot, but isn't work. I don't know if this is a correct way to follow.</p>\n\n<p>This is my code:</p>\n\n<pre><code>class BotController &lt; Stealth::Controller\n\n  helper :all\n  before_action :print_this, only: :route\n\n\n  def route\n    if current_session.present?\n      step_to session: current_session\n    else\n      step_to flow: 'hello', state: 'say_hello'\n    end\n  end\n\n  def print_this\n    puts \"\\n\\n\\n\\n\\n aaaaaaaaaaaaaaaaaaa \\n\\n\\n\\n\"\n  end\n\nend\n</code></pre>\n\n<p>Nothing happens, no error, no print message.</p>\n\n<p>Whats could be wrong?</p>\n\n<p><strong>EDIT:</strong></p>\n\n<p><code>before_action</code> works in another controllers, but not in <code>BotController</code></p>\n\n<p><strong>EDIT 2:</strong>\nThis is a log with behavior:</p>\n\n<p><strong>1)</strong> Using <code>before_action :print_this, only: :route</code></p>\n\n<pre><code>sidekiq_1   | 2018-09-12T17:13:10.544Z 1 TID-gt9nk8dzx Stealth::Services::HandleMessageJob JID-1b773e7908fcb72b7aa10a3d INFO: start\nsidekiq_1   | [previous_session] User 160479129292600: setting to \nsidekiq_1   | [session] User 160479129292600: setting session to hello-&gt;say_hello\nsidekiq_1   | [previous_session] User 160479129292600: setting to hello-&gt;say_hello\nsidekiq_1   | [session] User 160479129292600: setting session to main-&gt;show_menu    \nsidekiq_1   | 2018-09-12T17:13:11.738Z 1 TID-gt9nk8dzx Stealth::Services::HandleMessageJob JID-1b773e7908fcb72b7aa10a3d INFO: done: 1.194 sec\n</code></pre>\n\n<p><strong>2)</strong> Using <code>before_action :print_this, only: :say_hello</code> (<code>say_hello</code> is a action of <code>HellosController &lt; BotController</code> HERE WORKS</p>\n\n<pre><code>sidekiq_1   | 2018-09-12T17:18:24.751Z 1 TID-gte80drk9 Stealth::Services::HandleMessageJob JID-62e6901208770b68439ac083 INFO: start\nsidekiq_1   | [previous_session] User 1604791292926176: setting to atendimento-&gt;say_meus_atendimentos\nsidekiq_1   | [session] User 1604791292926176: setting session to hello-&gt;say_hello\nsidekiq_1   | \nsidekiq_1   | \nsidekiq_1   | \nsidekiq_1   | \nsidekiq_1   | \nsidekiq_1   |  aaaaaaaaaaaaaaaaaaa \nsidekiq_1   | \nsidekiq_1   | \nsidekiq_1   | \nsidekiq_1   | [previous_session] User 1604791292926176: setting to hello-&gt;say_hello\nsidekiq_1   | [session] User 1604791292926176: setting session to main-&gt;show_menu\nsidekiq_1   | 2018-09-12T17:18:25.524Z 1 TID-gte80drk9 Stealth::Services::HandleMessageJob JID-62e6901208770b68439ac083 INFO: done: 0.772 sec\n</code></pre>\n\n<p>Is this, not working in <code>BotController</code> only.</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1536759356, "post_id": 52295313, "comment_id": 91540868, "body": "What do you mean by &quot;<code>cny</code> as a string&quot;? Do you mean, for example, that you want to get <code>{ min: 10_00, max: 50_000_00 }</code> if <code>transaction_type == &quot;online_banking&quot;</code>? (But that&#39;s not a <code>String</code>?...)"}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1536759427, "post_id": 52295313, "comment_id": 91540925, "body": "What result would you expect if <code>transaction_type == &quot;bank_payout&quot;</code>? <code>nil</code>? What about if <code>transaction_type == &quot;not_a_real_type&quot;</code>? Please be specific about what your question is."}, {"owner": {"reputation": 7004, "user_id": 1103606, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/0d93cc650b93939ea91066fcb5aefae0?s=128&d=identicon&r=PG", "display_name": "Peter Penzov", "link": "https://stackoverflow.com/users/1103606/peter-penzov"}, "reply_to_user": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1536759432, "post_id": 52295313, "comment_id": 91540928, "body": "ok, let&#39;s skip the part as a string. How I can get the key?"}, {"owner": {"reputation": 7004, "user_id": 1103606, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/0d93cc650b93939ea91066fcb5aefae0?s=128&d=identicon&r=PG", "display_name": "Peter Penzov", "link": "https://stackoverflow.com/users/1103606/peter-penzov"}, "reply_to_user": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1536759481, "post_id": 52295313, "comment_id": 91540956, "body": "I expect to get only the random key <code>thb</code> for example."}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1536759564, "post_id": 52295313, "comment_id": 91541013, "body": "Ohhhh, right... So <code>cny</code>, <code>thb</code>, etc represent currencies, and you want a <b>RANDOM</b> currency for a given transaction type?"}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1536759587, "post_id": 52295313, "comment_id": 91541031, "body": "<code>AMOUNT_LIMITS[transaction_type.to_sym].keys.sample.to_s</code>?"}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1536769296, "post_id": 52295313, "comment_id": 91546947, "body": "By the way, this is far beyond the scope of your question, but if this is needed in an application then perhaps it would be better to store this data in a database, not a hardcoded hash (which is possibly not a great data structure choice anyway, due to awkward conversions like the above!). For example, you could have a <code>transaction_types</code> table, an <code>currencies</code> table and a <code>currencies_transaction_types</code> JOIN table that contains the <code>min</code> and <code>max</code> values shown above. Doing this would make any sort of data fetching much easier to follow/edit/extend compared to the above."}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1536769473, "post_id": 52295313, "comment_id": 91547028, "body": "e.g. You could do something like: <code>TransactionType.find_by(name: &#39;qqpay&#39;).currencies.order(&#39;RAND()&#39;).first.name</code>"}], "answers": [{"comments": [{"owner": {"reputation": 7004, "user_id": 1103606, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/0d93cc650b93939ea91066fcb5aefae0?s=128&d=identicon&r=PG", "display_name": "Peter Penzov", "link": "https://stackoverflow.com/users/1103606/peter-penzov"}, "edited": false, "score": 0, "creation_date": 1536758150, "post_id": 52295365, "comment_id": 91539982, "body": "I made a mistake. I need to get the currency based on the transaction type. Can you show me updated answer please?"}], "tags": [], "owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "is_accepted": false, "score": 1, "last_activity_date": 1536761971, "last_edit_date": 1536761971, "creation_date": 1536755805, "answer_id": 52295365, "question_id": 52295313, "link": "https://stackoverflow.com/questions/52295313/get-key-name-from-map/52295365#52295365", "title": "Get key name from Map", "body": "<p>To get a sample with weights:</p>\n\n<pre><code>AMOUNT_LIMITS.values.flat_map { |h| h.map(&amp;:first) }.sample.to_s\n#\u21d2 'thb'\n</code></pre>\n\n<p>To get any currency with the same probability, use <code>uniq</code> in the middle:</p>\n\n<pre><code>AMOUNT_LIMITS.values.flat_map { |h| h.map(&amp;:first) }.uniq.sample.to_s\n#\u21d2 'cny'\n</code></pre>\n\n<hr>\n\n<p>To get currency based on transaction type:</p>\n\n<pre><code>AMOUNT_LIMITS[:onlibe_banking].keys.sample.to_s\n#\u21d2 'cny'\n</code></pre>\n"}], "owner": {"reputation": 7004, "user_id": 1103606, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/0d93cc650b93939ea91066fcb5aefae0?s=128&d=identicon&r=PG", "display_name": "Peter Penzov", "link": "https://stackoverflow.com/users/1103606/peter-penzov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 62, "favorite_count": 0, "answer_count": 1, "score": -4, "last_activity_date": 1536761971, "creation_date": 1536755650, "last_edit_date": 1536759138, "question_id": 52295313, "link": "https://stackoverflow.com/questions/52295313/get-key-name-from-map", "title": "Get key name from Map", "body": "<p>I have this Ruby structure</p>\n\n<pre><code>AMOUNT_LIMITS = {\n    qqpay: {\n      cny: { min: 10_00,     max: 10_00_00 }\n    },\n    online_banking: {\n      cny: { min: 10_00,     max: 50_000_00 },\n      thb: { min: 10_00,     max: 500_000_00 },\n      idr: { min: 10_000_00, max: 50_000_000_00 },\n      myr: { min: 10_00,     max: 10_000_00 }\n    },\n    bank_payout: {          \n      thb: { min: 350_00,    max: 350_00 },\n      idr: { min: 50_000_00, smax: 50_000_00 },\n      myr: { min: 50_00,     max: 50_00 }\n    }\n</code></pre>\n\n<p>How I can get the currency type from the map? For example:</p>\n\n<pre><code>AMOUNT_LIMITS[transaction_type.to_sym].sample\n</code></pre>\n\n<p>I need only the key for example <code>cny</code> as a String.</p>\n"}, {"tags": ["ruby", "windows", "rspec", "azure-pipelines"], "comments": [{"owner": {"reputation": 9436, "user_id": 252627, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/b8128cc645c1a135f1fc28ba1294b53c?s=128&d=identicon&r=PG", "display_name": "janpio", "link": "https://stackoverflow.com/users/252627/janpio"}, "edited": false, "score": 0, "creation_date": 1536756074, "post_id": 52295200, "comment_id": 91538428, "body": "Oh, there might be a feature request for ruby from 2 years ago that would have fixed my problem: <a href=\"https://bugs.ruby-lang.org/issues/12656#change-70095\" rel=\"nofollow noreferrer\">bugs.ruby-lang.org/issues/12656#change-70095</a> Unfortunately it wasn&#39;t merged (yet)."}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1536763778, "post_id": 52295200, "comment_id": 91543764, "body": "Can you explain why you would need this functionality tested? Obviously solving it is a bit more difficult but if we understood the context there might be a suitable workaround that would still meet your requirements"}, {"owner": {"reputation": 29355, "user_id": 205580, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/460e6e299e385fd46df156c85a1dd55f?s=128&d=identicon&r=PG", "display_name": "Eryk Sun", "link": "https://stackoverflow.com/users/205580/eryk-sun"}, "edited": false, "score": 0, "creation_date": 1536772947, "post_id": 52295200, "comment_id": 91548678, "body": "For compatibility with legacy programs and scripts, the <code>TEMP</code> environment variable uses 8.3 DOS filenames, if they exist. For performance, NTFS can be configured to not create these legacy filenames, so on some systems it may contain &quot;VssAdministrator&quot; instead of &quot;VSSADM~1&quot;, or whatever the generated short name turns out to be. It isn&#39;t always the same. It depends on collisions with existing filenames, and can even be set manually."}, {"owner": {"reputation": 9436, "user_id": 252627, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/b8128cc645c1a135f1fc28ba1294b53c?s=128&d=identicon&r=PG", "display_name": "janpio", "link": "https://stackoverflow.com/users/252627/janpio"}, "reply_to_user": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1536783879, "post_id": 52295200, "comment_id": 91553600, "body": "@engineersmnky Good question. Short: Because it is an existing text that I want to adapt to also work on Windows. Longer: In the specific example above the tool runs code to create some files. One includes a method that returns a list of the generated files. So this <code>expect</code> is used to confirm that the correct files were generated and the code that should return them actually does. You can look at it here: <a href=\"https://github.com/fastlane/fastlane/blob/e8787caf698667922ee061a0053b8f622b693057/fastlane/spec/plugins_specs/plugin_generator_spec.rb#L113-L144\" rel=\"nofollow noreferrer\">github.com/fastlane/fastlane/blob/&hellip;</a>"}, {"owner": {"reputation": 9436, "user_id": 252627, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/b8128cc645c1a135f1fc28ba1294b53c?s=128&d=identicon&r=PG", "display_name": "janpio", "link": "https://stackoverflow.com/users/252627/janpio"}, "reply_to_user": {"reputation": 29355, "user_id": 205580, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/460e6e299e385fd46df156c85a1dd55f?s=128&d=identicon&r=PG", "display_name": "Eryk Sun", "link": "https://stackoverflow.com/users/205580/eryk-sun"}, "edited": false, "score": 0, "creation_date": 1536784386, "post_id": 52295200, "comment_id": 91553792, "body": "Interesting information @eryksun. The path here is created with <code>Dir.mktmpdir</code>. Does this use <code>TEMP</code>? Both the path with <code>VssAdministrator</code> and <code>VSSADM~1</code> are generated on the same system, in the same script (which I just couldn&#39;t understand enough yet to pinpoint it to a specific ruby method - might be different ones are used to create the both sides of the comparison)."}, {"owner": {"reputation": 29355, "user_id": 205580, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/460e6e299e385fd46df156c85a1dd55f?s=128&d=identicon&r=PG", "display_name": "Eryk Sun", "link": "https://stackoverflow.com/users/205580/eryk-sun"}, "edited": false, "score": 2, "creation_date": 1536785207, "post_id": 52295200, "comment_id": 91554133, "body": "The code that yields &quot;VSSADM~1&quot; is very likely using the value of <code>TEMP</code> or from <a href=\"https://docs.microsoft.com/en-us/windows/desktop/api/fileapi/nf-fileapi-gettemppathw\" rel=\"nofollow noreferrer\"><code>GetTempPath</code></a> directly. The other code is probably calling <a href=\"https://docs.microsoft.com/en-us/windows/desktop/api/fileapi/nf-fileapi-getlongpathnamew\" rel=\"nofollow noreferrer\"><code>GetLongPathName</code></a>. Doing this manually in Ruby will probably require an FFI (foreign function interface) call. I don&#39;t use Ruby to know what that would entail. In Python we have ctypes or cffi for this."}, {"owner": {"reputation": 9436, "user_id": 252627, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/b8128cc645c1a135f1fc28ba1294b53c?s=128&d=identicon&r=PG", "display_name": "janpio", "link": "https://stackoverflow.com/users/252627/janpio"}, "edited": false, "score": 0, "creation_date": 1536785432, "post_id": 52295200, "comment_id": 91554225, "body": "That would be pretty simple with ruby at least: <a href=\"https://stackoverflow.com/questions/10224572/convert-long-filename-to-short-filename-8-3/10244481#10244481\" title=\"convert long filename to short filename 8 3\">stackoverflow.com/questions/10224572/&hellip;</a> (also works with <code>GetLongPathName</code> of course). Problem is that I really don&#39;t want to add any (or &quot;to much&quot;) platform specific code - I would really prefer to &quot;just make it work&quot; by e.g. setting a config value or similar. Seems I have to understand the code on a deeper level :/"}, {"owner": {"reputation": 5449, "user_id": 681520, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/701baebf68d1d7faa9f9def6a24fe356?s=128&d=identicon&r=PG", "display_name": "Kimmo Lehto", "link": "https://stackoverflow.com/users/681520/kimmo-lehto"}, "edited": false, "score": 0, "creation_date": 1536826520, "post_id": 52295200, "comment_id": 91565845, "body": "Have you tried if <code>File.expand_path(path)</code> or <code>Pathname.new(path).realpath</code> gives some sort of normalized path?"}], "owner": {"reputation": 9436, "user_id": 252627, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/b8128cc645c1a135f1fc28ba1294b53c?s=128&d=identicon&r=PG", "display_name": "janpio", "link": "https://stackoverflow.com/users/252627/janpio"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 258, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1536756022, "creation_date": 1536755339, "last_edit_date": 1536756022, "question_id": 52295200, "link": "https://stackoverflow.com/questions/52295200/short-file-name-8-3-filename-vs-long-file-name-for-paths-in-ruby", "title": "Short file name (8.3 filename) vs. long file name for paths in Ruby", "body": "<p>I am working on a test suite that also compare loads of paths, e.g. something like that:</p>\n\n<pre><code>expect(all_classes).to contain_exactly(\n  File.expand_path(\"lib/#{plugin_info.actions_path}/#{plugin_name}_action.rb\"),\n  File.expand_path(\"lib/#{plugin_info.helper_path}/#{plugin_name}_helper.rb\")\n)\n</code></pre>\n\n<p>Unfortunately on Windows, this sometimes causes test failures if the generated temporary paths contain a directory, that triggers <a href=\"https://en.wikipedia.org/wiki/8.3_filename#VFAT_and_Computer-generated_8.3_filenames\" rel=\"nofollow noreferrer\">8.3 filenames</a>. An example:</p>\n\n<pre><code>2018-09-11T20:52:42.9346535Z   1) Fastlane::PluginGenerator#generate creates a plugin.rb file for the plugin\n2018-09-11T20:52:42.9346797Z      Failure/Error:\n2018-09-11T20:52:42.9347031Z        expect(all_classes).to contain_exactly(\n2018-09-11T20:52:42.9347330Z          File.expand_path(\"lib/#{plugin_info.actions_path}/#{plugin_name}_action.rb\"),\n2018-09-11T20:52:42.9347673Z          File.expand_path(\"lib/#{plugin_info.helper_path}/#{plugin_name}_helper.rb\")\n2018-09-11T20:52:42.9347922Z        )\n2018-09-11T20:52:42.9348040Z \n2018-09-11T20:52:42.9348443Z        expected collection contained:  [\"C:/Users/VSSADM~1/AppData/Local/Temp/d20180911-3656-1muipt1/fastlane-plugin-tester_thing/lib/fastla...muipt1/fastlane-plugin-tester_thing/lib/fastlane/plugin/tester_thing/helper/tester_thing_helper.rb\"]\n2018-09-11T20:52:42.9349108Z        actual collection contained:    [\"C:/Users/VssAdministrator/AppData/Local/Temp/d20180911-3656-1muipt1/fastlane-plugin-tester_thing/li...muipt1/fastlane-plugin-tester_thing/lib/fastlane/plugin/tester_thing/helper/tester_thing_helper.rb\"]\n2018-09-11T20:52:42.9349732Z        the missing elements were:      [\"C:/Users/VSSADM~1/AppData/Local/Temp/d20180911-3656-1muipt1/fastlane-plugin-tester_thing/lib/fastla...muipt1/fastlane-plugin-tester_thing/lib/fastlane/plugin/tester_thing/helper/tester_thing_helper.rb\"]\n2018-09-11T20:52:42.9350359Z        the extra elements were:        [\"C:/Users/VssAdministrator/AppData/Local/Temp/d20180911-3656-1muipt1/fastlane-plugin-tester_thing/li...muipt1/fastlane-plugin-tester_thing/lib/fastlane/plugin/tester_thing/helper/tester_thing_helper.rb\"]\n2018-09-11T20:52:42.9350855Z      # ./fastlane/spec/plugins_specs/plugin_generator_spec.rb:135:in `block (4 levels) in &lt;top (required)&gt;'\n2018-09-11T20:52:42.9351199Z      # ./fastlane/spec/plugins_specs/plugin_generator_spec.rb:119:in `chdir'\n2018-09-11T20:52:42.9351541Z      # ./fastlane/spec/plugins_specs/plugin_generator_spec.rb:119:in `block (3 levels) in &lt;top (required)&gt;'\n</code></pre>\n\n<p>In this case the problem lies in the path of the temp directory generated on a Azure DevOps pipelines machine: <code>C:/Users/VssAdministrator/AppData/...</code> vs. <code>C:/Users/VSSADM~1/AppData/...</code></p>\n\n<p>Some of the ruby methods seem to return the long version, some others the short one. Complicating it seems that the same methods sometimes return the one, and then the other - depending on some context I didn't understand yet, at least that is how it seems to me after debugging the test failures a bit.</p>\n\n<p>Can someone explain to me what is going on and any ideas how I can fix this?   Is there a way to \"standardize\" everything on one \"method\" of representing a path?<br>\nAnything else I should read or look at to fix this?</p>\n"}, {"tags": ["ruby", "aerospike"], "comments": [{"owner": {"reputation": 2459, "user_id": 1364745, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/8wyHq.jpg?s=128&g=1", "display_name": "kporter", "link": "https://stackoverflow.com/users/1364745/kporter"}, "edited": false, "score": 0, "creation_date": 1536755316, "post_id": 52294841, "comment_id": 91537902, "body": "I suspect you are seeing this because you have supplied a bin name to a single-bin namespace. Try { nil =&gt; 1 } or { &#39;&#39; =&gt; 1}."}, {"owner": {"reputation": 707, "user_id": 733171, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/275p8.jpg?s=128&g=1", "display_name": "Apurva Mayank", "link": "https://stackoverflow.com/users/733171/apurva-mayank"}, "reply_to_user": {"reputation": 2459, "user_id": 1364745, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/8wyHq.jpg?s=128&g=1", "display_name": "kporter", "link": "https://stackoverflow.com/users/1364745/kporter"}, "edited": false, "score": 0, "creation_date": 1536755670, "post_id": 52294841, "comment_id": 91538138, "body": "@kporter when I try {&#39;&#39; =&gt; 1} it throws the same error. In case of {nil =&gt; 1} it throws Aerospike::Exceptions::Parse: bin name `` is not a string."}, {"owner": {"reputation": 2459, "user_id": 1364745, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/8wyHq.jpg?s=128&g=1", "display_name": "kporter", "link": "https://stackoverflow.com/users/1364745/kporter"}, "edited": false, "score": 1, "creation_date": 1536756318, "post_id": 52294841, "comment_id": 91538597, "body": "Possibly the ruby client doesn&#39;t support single-bin yet. I&#39;ve pinged our client development team to look into this, but I didn&#39;t find any documentation for it."}, {"owner": {"reputation": 707, "user_id": 733171, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/275p8.jpg?s=128&g=1", "display_name": "Apurva Mayank", "link": "https://stackoverflow.com/users/733171/apurva-mayank"}, "reply_to_user": {"reputation": 2459, "user_id": 1364745, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/8wyHq.jpg?s=128&g=1", "display_name": "kporter", "link": "https://stackoverflow.com/users/1364745/kporter"}, "edited": false, "score": 0, "creation_date": 1536758256, "post_id": 52294841, "comment_id": 91540069, "body": "@kporter Thanks. Kindly let me know the progress"}, {"owner": {"reputation": 2229, "user_id": 4147181, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CIuNh.jpg?s=128&g=1", "display_name": "Meher", "link": "https://stackoverflow.com/users/4147181/meher"}, "edited": false, "score": 3, "creation_date": 1536794853, "post_id": 52294841, "comment_id": 91556915, "body": "Are you by any chance also attempting to store the key? (which wouldn&#39;t be supported with single bin configuration I believe). But it doesn&#39;t seem that you would be doing this based on the shared code... I wouldn&#39;t expect this to be a default policy."}], "answers": [{"tags": [], "owner": {"reputation": 834, "user_id": 1573115, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ef104e52dbbf38b796179483816e20c9?s=128&d=identicon&r=PG", "display_name": "Jan Hecking", "link": "https://stackoverflow.com/users/1573115/jan-hecking"}, "is_accepted": true, "score": 4, "last_activity_date": 1536807698, "creation_date": 1536807698, "answer_id": 52306044, "question_id": 52294841, "link": "https://stackoverflow.com/questions/52294841/how-to-resolve-aerospikeexceptionsaerospike-unsupported-server-feature-for/52306044#52306044", "title": "How to resolve Aerospike::Exceptions::Aerospike: Unsupported Server Feature for Ruby Client?", "body": "<p>The \"Unsupported Server Feature\" error you are getting is because the Ruby client is sending the user key to the server by default, but the Aerospike server does not support storing the user key for the data-in-memory &amp; single-bin setup. You should see an error message like this in your server logs:</p>\n\n<pre><code>Sep 13 2018 02:42:20 GMT: WARNING (rw): (rw_utils.c:153) {sbin} can't store key if data-in-memory &amp; single-bin\n</code></pre>\n\n<p>You'll need to disable sending the key as part of the put request by setting the <code>send_key</code> write policy setting to <code>false</code>:</p>\n\n<pre><code>$ bundle exec irb\n2.5.0 :001 &gt; require 'aerospike'; include Aerospike;\n =&gt; Object\n2.5.0 :002 &gt; client = Client.new; key = Key.new('sbin', 'test', 'foo'); nil\n =&gt; nil\n2.5.0 :003 &gt; client.put(key, Bin.new('', 42), send_key: false)\n =&gt; nil\n2.5.0 :004 &gt; client.get(key).bins['']\n =&gt; 42\n</code></pre>\n"}], "owner": {"reputation": 707, "user_id": 733171, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/275p8.jpg?s=128&g=1", "display_name": "Apurva Mayank", "link": "https://stackoverflow.com/users/733171/apurva-mayank"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 144, "favorite_count": 1, "accepted_answer_id": 52306044, "answer_count": 1, "score": 1, "last_activity_date": 1536807698, "creation_date": 1536754162, "question_id": 52294841, "link": "https://stackoverflow.com/questions/52294841/how-to-resolve-aerospikeexceptionsaerospike-unsupported-server-feature-for", "title": "How to resolve Aerospike::Exceptions::Aerospike: Unsupported Server Feature for Ruby Client?", "body": "<p>While I am trying to write into aerospike using ruby client I am getting the following exception:-</p>\n\n<h2>Aerospike::Exceptions::Aerospike: Unsupported Server Feature</h2>\n\n<p>Details:-</p>\n\n<pre><code>Aerospike version:- 4.3\nClient: [Ruby] aerospike - 2.4.0\nnamespaces: NS1, NS2, NS3 \n</code></pre>\n\n<h2>    Note: NS2 and NS3 have single-bin true data-in-index true</h2>\n\n<p>Code(which causes the exception):-</p>\n\n<pre><code>client = Aerospike::Client.new('aerospike:3000')\nkey = Aerospike::Key.new('NS2', 'set name', 'this is the key')\ndata = { 'record'  =&gt; 1 }\nclient.put(key, data) # this line raises the exception\nAerospike::Exceptions::Aerospike: Unsupported Server Feature\n</code></pre>\n\n<p>The exception is not raised if I change NS2 in the key to NS1.</p>\n"}, {"tags": ["ruby", "simplecov"], "comments": [{"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 1, "creation_date": 1536753139, "post_id": 52294125, "comment_id": 91536554, "body": "How are <a href=\"https://ruby-doc.org/core/Kernel.html#method-i-require\" rel=\"nofollow noreferrer\"><code>Kernel#require</code></a> (and others) not executed?! It\u2019s plain old good ruby method declared on <code>Kernel</code>."}, {"owner": {"reputation": 9436, "user_id": 252627, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/b8128cc645c1a135f1fc28ba1294b53c?s=128&d=identicon&r=PG", "display_name": "janpio", "link": "https://stackoverflow.com/users/252627/janpio"}, "reply_to_user": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1536754464, "post_id": 52294125, "comment_id": 91537391, "body": "I edited the question to specify that this means code I care about - which does not include all the <code>require</code>, <code>module</code> etc. in files that were not loaded. Sorry for being imprecise before."}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1536754591, "post_id": 52294125, "comment_id": 91537456, "body": "How do you suppose any tool would distinguish <code>Foo#bar</code> from <code>Kernel#require</code>; <i>that was indeed loaded</i>?"}, {"owner": {"reputation": 9436, "user_id": 252627, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/b8128cc645c1a135f1fc28ba1294b53c?s=128&d=identicon&r=PG", "display_name": "janpio", "link": "https://stackoverflow.com/users/252627/janpio"}, "reply_to_user": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1536754738, "post_id": 52294125, "comment_id": 91537540, "body": "No idea, which is why I am asking here. I only have the usecase, not the solution yet ;) Maybe some configuration to exclude and mark the methods listed above as irrelevant (similar to <code>end</code> and <code>rescue</code>) perhaps?"}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1536755389, "post_id": 52294125, "comment_id": 91537943, "body": "Neither <code>end</code> nor <code>rescue</code> are <i>methods</i>. <code>require</code> is indeed <i>a method</i>. Declared on <code>Kernel</code>. That is <i>included</i> into every ruby object. It might <i>fail</i>."}, {"owner": {"reputation": 9436, "user_id": 252627, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/b8128cc645c1a135f1fc28ba1294b53c?s=128&d=identicon&r=PG", "display_name": "janpio", "link": "https://stackoverflow.com/users/252627/janpio"}, "reply_to_user": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1536755834, "post_id": 52294125, "comment_id": 91538257, "body": "I get that now. I still don&#39;t care about these methods in this code coverage result though as it doesn&#39;t help me to achieve my goal which is to be able to look at the <i>for me</i> relevant code coverage of specific tests."}], "answers": [{"comments": [{"owner": {"reputation": 9436, "user_id": 252627, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/b8128cc645c1a135f1fc28ba1294b53c?s=128&d=identicon&r=PG", "display_name": "janpio", "link": "https://stackoverflow.com/users/252627/janpio"}, "edited": false, "score": 0, "creation_date": 1536756681, "post_id": 52295461, "comment_id": 91538876, "body": "Thanks, while this might work for a small project, I unfortunately can&#39;t edit a few thousand files for each individual spec being run. (I added that limitation to my initial question for future readers)"}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "reply_to_user": {"reputation": 9436, "user_id": 252627, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/b8128cc645c1a135f1fc28ba1294b53c?s=128&d=identicon&r=PG", "display_name": "janpio", "link": "https://stackoverflow.com/users/252627/janpio"}, "edited": false, "score": 4, "creation_date": 1536764254, "post_id": 52295461, "comment_id": 91544062, "body": "@janpio it appears you could patch <a href=\"https://www.rubydoc.info/gems/simplecov/SimpleCov/LinesClassifier\" rel=\"nofollow noreferrer\">SimpleCov::LinesClassifier</a> if you really wanted to"}], "tags": [], "owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "is_accepted": false, "score": 0, "last_activity_date": 1536756114, "creation_date": 1536756114, "answer_id": 52295461, "question_id": 52294125, "link": "https://stackoverflow.com/questions/52294125/ruby-code-coverage-without-all-the-requires-and-method-defintions/52295461#52295461", "title": "Ruby code coverage without all the requires and method defintions?", "body": "<p>The very <code>README</code> of <code>simplecov</code> says:</p>\n\n<blockquote>\n  <p>You can exclude code from the coverage report by wrapping it in <code># :nocov:</code>.<br>\n  <sup>\u2014 <a href=\"https://github.com/colszowka/simplecov#ignoringskipping-code\" rel=\"nofollow noreferrer\">https://github.com/colszowka/simplecov#ignoringskipping-code</a></sup></p>\n</blockquote>\n\n<p>E. g. to skip <code>require</code>:</p>\n\n<pre><code># :nocov:\nrequire 'foo'\n# :nocov:\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 9436, "user_id": 252627, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/b8128cc645c1a135f1fc28ba1294b53c?s=128&d=identicon&r=PG", "display_name": "janpio", "link": "https://stackoverflow.com/users/252627/janpio"}, "edited": false, "score": 0, "creation_date": 1538159647, "post_id": 52533869, "comment_id": 92060463, "body": "Wow, that is a neat idea!"}], "tags": [], "owner": {"reputation": 3364, "user_id": 360632, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/eb541570e97cbad9d90e5082462ad9ca?s=128&d=identicon&r=PG", "display_name": "DMA57361", "link": "https://stackoverflow.com/users/360632/dma57361"}, "is_accepted": false, "score": 4, "last_activity_date": 1538040897, "creation_date": 1538040897, "answer_id": 52533869, "question_id": 52294125, "link": "https://stackoverflow.com/questions/52294125/ruby-code-coverage-without-all-the-requires-and-method-defintions/52533869#52533869", "title": "Ruby code coverage without all the requires and method defintions?", "body": "<p>SimpleCov is simply showing you what Ruby's Coverage library collects and as the comments on your question have said, those things <em>are</em> executed, but I too find this frustrating - I don't want a class that's loaded, but not used, to be at 40% coverage.</p>\n\n<p>My solution is to remove coverage that only occurs as part of the loading process. We're using Rails, so we start by loading every file in the application (this is easy in rails, there's a eager_load config); take a snapshot of coverage at that time; run the test suite; then finally deduct the snapshot from the final result before simplecov outputs. Any line covered exactly once in the load snapshot and exactly once in the final result is removed.</p>\n\n<p>Below is a custom SimpleCov formatter I cobbled together a while back that does this job. It's a bit of a hack since it messes with the internal result object of the gem, so be aware that it might not be stable for new versions, but it's working for us with the current simplecov (0.16.1). Also note that since it uses <code>Coverage.peek_result</code> this <strong>requires Ruby 2.3 or later</strong>.</p>\n\n<p>Use it by setting <code>SimpleCovWithoutLoadingFormatter</code> as your formatter for simplecov and in your test suite setup call <code>SimpleCovWithoutLoadingFormatter.take_load_snapshot</code> immediately after loading <em>every</em> file your application.</p>\n\n<pre><code>require 'simplecov'\n\nclass SimpleCovWithoutLoadingFormatter\n  def self.take_load_snapshot\n    @coverage_load_lines_mask = Coverage.peek_result\n  end\n\n  def self.coverage_load_lines_mask\n    @coverage_load_lines_mask\n  end\n\n  def format(result)\n    if self.class.coverage_load_lines_mask&amp;.any?\n      result_merge_count = result.command_name.split(',').count\n\n      result.files.each do |source_file|\n        _file, load_mask = self.class.coverage_load_lines_mask.detect { |file, _load_mask| file == source_file.filename }\n        next unless load_mask\n\n        source_file.coverage.each_with_index do |count, i|\n          source_file.coverage[i] = nil if count&amp;.positive? &amp;&amp; count&amp;.==(load_mask[i] * result_merge_count)\n        end\n      end\n    end\n\n    SimpleCov::Formatter::HTMLFormatter.new.format(result)\n  end\nend\n</code></pre>\n"}], "owner": {"reputation": 9436, "user_id": 252627, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/b8128cc645c1a135f1fc28ba1294b53c?s=128&d=identicon&r=PG", "display_name": "janpio", "link": "https://stackoverflow.com/users/252627/janpio"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 464, "favorite_count": 0, "answer_count": 2, "score": 3, "last_activity_date": 1538040897, "creation_date": 1536751869, "last_edit_date": 1536756593, "question_id": 52294125, "link": "https://stackoverflow.com/questions/52294125/ruby-code-coverage-without-all-the-requires-and-method-defintions", "title": "Ruby code coverage without all the requires and method defintions?", "body": "<p>When using a super simple <code>simplecov</code> setup like</p>\n\n<pre><code>require 'simplecov'\nSimpleCov.start\n</code></pre>\n\n<p>I get loads of \"coverage\" for files and code that were not really \"executed\" (in any sense that I would care about when looking at code coverage for a specific test) at all with the individual test I was running.</p>\n\n<p>For example all the <code>require</code>, <code>module</code>, <code>class</code>, <code>def</code>, <code>attr_accessor</code> etc. are marked in green for <em>all</em> files that were loaded on the coverage report generated. I do not care about those, and would be happy if those files would report 0% coverage if no \"actual code\" was executed in them.</p>\n\n<p><code>end</code>, <code>rescue</code> and comments for example are considered not relevant and not marked red <em>or</em> green in any files. I would like similar behavior for the methods listed above.</p>\n\n<p>Is there a way to get a code coverage that really only includes (and measures) the actual code lines being executed that I care about?</p>\n\n<hr>\n\n<p>Update after first answer:\nMarking all <em>other</em> code as \"not relevant\" via e.g. <a href=\"https://github.com/colszowka/simplecov#ignoringskipping-code\" rel=\"nofollow noreferrer\"><code># :nocov:</code></a> is unfortunately not an option as this would affect thousands of files for each individual test run.</p>\n"}, {"tags": ["ruby", "ssh", "vagrant", "vagrantfile"], "answers": [{"comments": [{"owner": {"reputation": 715, "user_id": 6928292, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/a0nBD.jpg?s=128&g=1", "display_name": "aphexlog", "link": "https://stackoverflow.com/users/6928292/aphexlog"}, "edited": false, "score": 0, "creation_date": 1536766077, "post_id": 52298302, "comment_id": 91545157, "body": "so if I am to understand this correctly... Should I allow the vagrant user to provision the additional users?"}, {"owner": {"reputation": 715, "user_id": 594628, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/132c4e5e2dbd09ab1a9a76911bc56982?s=128&d=identicon&r=PG", "display_name": "Tyler Gannon", "link": "https://stackoverflow.com/users/594628/tyler-gannon"}, "reply_to_user": {"reputation": 715, "user_id": 6928292, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/a0nBD.jpg?s=128&g=1", "display_name": "aphexlog", "link": "https://stackoverflow.com/users/6928292/aphexlog"}, "edited": false, "score": 0, "creation_date": 1536766736, "post_id": 52298302, "comment_id": 91545553, "body": "You need to actually <b>create</b> that user, unless it already exists on the box you&#39;re using to create your machine.  More interesting to me, is why you need a user of a different name ... what special use scenario do you have that means you can&#39;t use the <code>vagrant</code> user?"}, {"owner": {"reputation": 715, "user_id": 6928292, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/a0nBD.jpg?s=128&g=1", "display_name": "aphexlog", "link": "https://stackoverflow.com/users/6928292/aphexlog"}, "edited": false, "score": 0, "creation_date": 1536767105, "post_id": 52298302, "comment_id": 91545750, "body": "I am trying to set up a dev env for dummies... so I would really like to be able to NFS mount the host home dir to the guest home dir and use the same user.name. basically as seamless as possible :) this would even let them use their own IDEs without having to sync changes with that vagrant box.."}, {"owner": {"reputation": 715, "user_id": 6928292, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/a0nBD.jpg?s=128&g=1", "display_name": "aphexlog", "link": "https://stackoverflow.com/users/6928292/aphexlog"}, "edited": false, "score": 0, "creation_date": 1536767218, "post_id": 52298302, "comment_id": 91545809, "body": "I already have the NFS mount working in such a way that in mounts a user.name (host user.name home dir) dir to the ~vagrant user home dir (~vagrant/user.name)"}, {"owner": {"reputation": 715, "user_id": 594628, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/132c4e5e2dbd09ab1a9a76911bc56982?s=128&d=identicon&r=PG", "display_name": "Tyler Gannon", "link": "https://stackoverflow.com/users/594628/tyler-gannon"}, "reply_to_user": {"reputation": 715, "user_id": 6928292, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/a0nBD.jpg?s=128&g=1", "display_name": "aphexlog", "link": "https://stackoverflow.com/users/6928292/aphexlog"}, "edited": false, "score": 0, "creation_date": 1536767468, "post_id": 52298302, "comment_id": 91545957, "body": "That&#39;s what the Vagrant shared folder is for, right?"}, {"owner": {"reputation": 715, "user_id": 6928292, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/a0nBD.jpg?s=128&g=1", "display_name": "aphexlog", "link": "https://stackoverflow.com/users/6928292/aphexlog"}, "edited": false, "score": 0, "creation_date": 1536767645, "post_id": 52298302, "comment_id": 91546047, "body": "the vagrant shared dir at &#39;/vagrant&#39; or the one i mounted at &#39;~vagrant/user.name&#39;?"}, {"owner": {"reputation": 715, "user_id": 594628, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/132c4e5e2dbd09ab1a9a76911bc56982?s=128&d=identicon&r=PG", "display_name": "Tyler Gannon", "link": "https://stackoverflow.com/users/594628/tyler-gannon"}, "reply_to_user": {"reputation": 715, "user_id": 6928292, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/a0nBD.jpg?s=128&g=1", "display_name": "aphexlog", "link": "https://stackoverflow.com/users/6928292/aphexlog"}, "edited": false, "score": 0, "creation_date": 1536767725, "post_id": 52298302, "comment_id": 91546104, "body": "I guess I&#39;m missing why you need to mount the entire user home directory.  Just the shared folder with the project in it should be sufficient.  Particularly if this is for &quot;dummies&quot; then you might not want them mucking around in the home directory getting lost."}, {"owner": {"reputation": 715, "user_id": 6928292, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/a0nBD.jpg?s=128&g=1", "display_name": "aphexlog", "link": "https://stackoverflow.com/users/6928292/aphexlog"}, "edited": false, "score": 0, "creation_date": 1536768574, "post_id": 52298302, "comment_id": 91546597, "body": "ahh, that makes sense.. I wouldn&#39;t want them to accidentally destroy their host_home dir thinking that they are doing a &quot;clean up&quot; or something :)"}], "tags": [], "owner": {"reputation": 715, "user_id": 594628, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/132c4e5e2dbd09ab1a9a76911bc56982?s=128&d=identicon&r=PG", "display_name": "Tyler Gannon", "link": "https://stackoverflow.com/users/594628/tyler-gannon"}, "is_accepted": false, "score": 0, "last_activity_date": 1536764718, "creation_date": 1536764718, "answer_id": 52298302, "question_id": 52294094, "link": "https://stackoverflow.com/questions/52294094/vagrant-machine-unable-to-authenticate-with-my-newly-created-user-over-ssh/52298302#52298302", "title": "Vagrant machine unable to authenticate with my newly created user over ssh", "body": "<p>I believe you'll have to create a new user on your Vagrant machine.  As per the docs for the <a href=\"https://www.vagrantup.com/docs/vagrantfile/ssh_settings.html#available-settings\" rel=\"nofollow noreferrer\">ssh.username</a> setting, it doesn't sound like that setting actually creates a user.  It only helps you to tell Vagrant what user to connect as, if the box was made with a username other than <em>vagrant</em>.</p>\n\n<p>You probably need to shell out to <code>useradd</code> during provisioning.</p>\n"}], "owner": {"reputation": 715, "user_id": 6928292, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/a0nBD.jpg?s=128&g=1", "display_name": "aphexlog", "link": "https://stackoverflow.com/users/6928292/aphexlog"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 39, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1536764718, "creation_date": 1536751787, "last_edit_date": 1536764368, "question_id": 52294094, "link": "https://stackoverflow.com/questions/52294094/vagrant-machine-unable-to-authenticate-with-my-newly-created-user-over-ssh", "title": "Vagrant machine unable to authenticate with my newly created user over ssh", "body": "<p>My vagrantfile looks like this:</p>\n\n<pre><code># -*- mode: ruby -*-\n# vi: set ft=ruby :\n\nvagrant_home = \"/home/vagrant/\"\nlocal_share = \"#{ENV['HOME']}\"\n\nunless Vagrant.has_plugin?(\"vagrant-vbguest\")\n  puts \"Vagrant plugin 'vagrant-vbguest' is not installed!\"\n  puts \"Execute: vagrant plugin install vagrant-vbguest\"\nend\n\nunless Vagrant.has_plugin?(\"vagrant-sshfs\")\n  puts \"Vagrant plugin 'vagrant-sshfs' is not installed!\"\n  puts \"Execute: vagrant plugin install vagrant-sshfs\"\nend\n\nVagrant.configure(\"2\") do |stage|\n    stage.vm.box = \"centos/7\"\n    stage.vm.hostname = \"HSS-IAAS-VB\"\n    stage.vm.box_check_update = true\n    stage.vm.network \"private_network\", :type =&gt; 'dhcp'\n    stage.vm.provider \"virtualbox\" do |vb|\n      vb.name = \"centos7-dev\"\n      vb.gui = false\n      vb.memory = \"1024\"\n    stage.ssh.keys_only = false\n    stage.ssh.username = \"#{ENV['USER']}\"\n    stage.ssh.forward_agent    = true\n    stage.ssh.insert_key       = true\n    stage.ssh.private_key_path =  \"#{ENV['HOME']}/.ssh/id_rsa\" , \"/home/#{ENV['USER']}/.ssh/id_rsa\n    stage.vm.provision :shell, privileged: false do |s|\n      ssh_pub_key = File.readlines(\"#{Dir.home}/.ssh/id_rsa.pub\").first.strip\n      s.inline = &lt;&lt;-SHELL\n        echo #{ssh_pub_key} &gt;&gt; #{ENV['home']}.ssh/authorized_keys\n        sudo bash -c \\\"echo #{ssh_pub_key} &gt;&gt; #{ENV['home']}/.ssh/authorized_keys\\\"\n      SHELL\n    end\n  end\nend\n</code></pre>\n\n<p>My issue is that when I run this vagrantfile, I receive an error that states the following: <code>default: Warning: Authentication failure. Retrying...</code> and if I run in debug mode I just see a bunch of timeouts.. </p>\n\n<p>All that I am trying to do is rather than create a \"vagrant\" user, I want to create a user that is the same as the user on the host machine by using <code>#{ENV['USER']}</code> and have the user immediately be able to run <code>vagrant ssh</code> and if their host user is test.user, then the guest user will be test.user..</p>\n\n<p><code>vagrant ssh-config</code> was:</p>\n\n<pre><code>Host default\n  HostName 127.0.0.1\n  User aaron.west\n  Port 2200\n  UserKnownHostsFile /dev/null\n  StrictHostKeyChecking no\n  PasswordAuthentication no\n  IdentityFile /Users/aaron.west/.ssh/id_rsa\n  IdentityFile /Users/aaron.west/.ssh/id_rsa\n  LogLevel FATAL\n</code></pre>\n\n<p>all help is appreciated :)</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 32131, "user_id": 2346461, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/i3xAf.jpg?s=128&g=1", "display_name": "Pavan", "link": "https://stackoverflow.com/users/2346461/pavan"}, "edited": false, "score": 0, "creation_date": 1536751491, "post_id": 52293893, "comment_id": 91535650, "body": "What does the server log look when you trigger this action? Please update the question with it."}, {"owner": {"reputation": 1298, "user_id": 6305204, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/jGfSZ.png?s=128&g=1", "display_name": "con--", "link": "https://stackoverflow.com/users/6305204/con"}, "edited": false, "score": 0, "creation_date": 1536751923, "post_id": 52293893, "comment_id": 91535905, "body": "Have you seen <a href=\"https://stackoverflow.com/questions/22943892/actioncontrollerunknownformat?rq=1\">this related question</a>. Have you tried wrapping the call in a respond_to block?"}, {"owner": {"reputation": 13441, "user_id": 2199600, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8sl6u.jpg?s=128&g=1", "display_name": "Igor Drozdov", "link": "https://stackoverflow.com/users/2199600/igor-drozdov"}, "edited": false, "score": 2, "creation_date": 1536752008, "post_id": 52293893, "comment_id": 91535949, "body": "do you have <code>answers&#47;results.html.erb</code> file?"}, {"owner": {"reputation": 19, "user_id": 9825021, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "digital king", "link": "https://stackoverflow.com/users/9825021/digital-king"}, "edited": false, "score": 0, "creation_date": 1536752199, "post_id": 52293893, "comment_id": 91536037, "body": "I have updated the question so it includes the server log"}, {"owner": {"reputation": 19, "user_id": 9825021, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "digital king", "link": "https://stackoverflow.com/users/9825021/digital-king"}, "edited": false, "score": 0, "creation_date": 1536752215, "post_id": 52293893, "comment_id": 91536043, "body": "Yes, I do have a results.html.erb file"}, {"owner": {"reputation": 706, "user_id": 6492146, "user_type": "registered", "accept_rate": 82, "profile_image": "https://graph.facebook.com/10157001409455137/picture?type=large", "display_name": "Verty00", "link": "https://stackoverflow.com/users/6492146/verty00"}, "edited": false, "score": 2, "creation_date": 1536758794, "post_id": 52293893, "comment_id": 91540480, "body": "Can we see your <code>routes.rb</code> file"}, {"owner": {"reputation": 19, "user_id": 9825021, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "digital king", "link": "https://stackoverflow.com/users/9825021/digital-king"}, "edited": false, "score": 0, "creation_date": 1536802339, "post_id": 52293893, "comment_id": 91558270, "body": "I&#39;ve added the routes.rb file."}, {"owner": {"reputation": 19, "user_id": 9825021, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "digital king", "link": "https://stackoverflow.com/users/9825021/digital-king"}, "edited": false, "score": 0, "creation_date": 1536888311, "post_id": 52293893, "comment_id": 91594746, "body": "Anyone find a solution for this yet?"}], "owner": {"reputation": 19, "user_id": 9825021, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "digital king", "link": "https://stackoverflow.com/users/9825021/digital-king"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 122, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1536802303, "creation_date": 1536751028, "last_edit_date": 1536802303, "question_id": 52293893, "link": "https://stackoverflow.com/questions/52293893/actioncontrollerunknownformat-in-answercontrollerresults", "title": "ActionController::UnknownFormat in AnswerController#results", "body": "<p>This is the error I'm getting </p>\n\n<blockquote>\n  <p>AnswerController#results is missing a template for this request format\n  and variant. request.formats: [\"text/html\"] request.variant: [] NOTE!\n  For XHR/Ajax or API requests, this action would normally respond with\n  204 No Content: an empty white screen. Since you're loading it in a\n  web browser, we assume that you expected to actually render a\n  template, not nothing, so we're showing an error to be extra-clear. If\n  you expect 204 No Content, carry on. That's what you'll get from an\n  XHR or API request. Give it a shot.</p>\n</blockquote>\n\n<p>I'm not sure what it means by \"missing template\". I'm also not sure why I'm getting this error. I am going to provide all the code that I think might be relevant to this issue.</p>\n\n<p><strong>answer_controller.rb</strong></p>\n\n<pre><code>class AnswerController &lt; ApplicationController\n  def create\n    @answer = current_quiz.answers.create(question_id: question, choice_id: choice)\n    redirect_to question_quiz_path(current_quiz)\n  end\n\n  def results\n    @choices = choices_hash\n    @results = questions.map do |question|\n      {\n        question.question =&gt; CountChoicesService.call(question.id)\n      }\n    end\n  end\n\n  private\n\n  def question\n    @question ||= params[:question]\n  end\n\n  def choice\n    @choice ||= params[:choice]\n  end\n\n  def choices\n    @choices ||= Array.wrap(Choice.all)\n  end\n\n  def choices_hash\n    choices_hash = {}\n    choices.each { |choice| choices_hash[choice.id] = choice.choice }\n    choices_hash\n  end\n\n  def questions\n    @questions ||= Array.wrap(Question.all)\n  end\nend\n</code></pre>\n\n<p><strong>count_choices_service.rb</strong></p>\n\n<pre><code>class CountChoicesService\n  def self.call(question_id)\n    new(question_id).call\n  end\n\n  def call\n    only_finished.to_a\n  end\n\n  private\n\n  attr_reader :question_id\n\n  def initialize(question_id)\n    @question_id = question_id\n  end\n\n  def count_choices_by_question\n    Answer\n      .select(\"COUNT(choice_id), choice_id\")\n      .where(question_id: question_id)\n      .group(:choice_id)\n      .order(:choice_id)\n  end\n\n  def only_finished\n    count_choices_by_question.where(answers: { quiz_id: quiz_ids })\n  end\n\n  def finished_quizzes\n    Quiz.finished\n  end\n\n  def quiz_ids\n    @quiz_ids = finished_quizzes.map(&amp;:id)\n  end\nend\n</code></pre>\n\n<p>application_controller.rb</p>\n\n<pre><code>class ApplicationController &lt; ActionController::Base\n  protect_from_forgery with: :exception\n\n  protected\n\n  def check_existing_quiz!\n    redirect_to question_quiz_path(current_quiz) if current_quiz.present?\n  end\n\n  def check_finished_quiz!\n    redirect_to results_answer_index_path if quiz_finished?\n    redirect_to new_quiz_path unless current_quiz.present?\n  end\n\n  private\n\n  def current_quiz\n    @current_quiz ||= session[:current_quiz] &amp;&amp; Quiz.find_by(id: session[:current_quiz])\n  end\n\n  def quiz_finished?\n    current_quiz.present? &amp;&amp; !current_quiz.is_active\n  end\nend\n</code></pre>\n\n<p><strong>quiz_controller.rb</strong></p>\n\n<pre><code>class QuizController &lt; ApplicationController\n  before_action :check_existing_quiz!, only: [:new, :create]\n  before_action :check_finished_quiz!, only: [:question]\n\n  def new\n    @quiz = Quiz.new\n  end\n\n  def create\n    @quiz = Quiz.create(is_active: true)\n    session[:current_quiz] = @quiz.id\n    redirect_to question_quiz_path(@quiz)\n  end\n\n  def question\n    @question = NextQuestionService.next(current_quiz)\n    if @question\n      @answer = Answer.new\n    else\n      current_quiz.update_attribute(:is_active, false)\n      redirect_to results_answer_index_path\n    end\n  end\nend\n</code></pre>\n\n<p><strong>seeds.rb</strong></p>\n\n<pre><code>Question.destroy_all\nChoice.destroy_all\n\ndata_file = Rails.root.join('db', 'data.json')\ncollection = JSON.parse(File.read(data_file))['questions']\n\ncollection.each do |item|\n  question = Question.create!(question: item['question'])\n  item['choices'].each do |choice|\n    question.choices.create!(choice: choice)\n  end\nend\n\np \"Created #{Question.count} questions\"\np \"Created #{Choice.count} choices\"\n</code></pre>\n\n<p><strong>data.json</strong></p>\n\n<pre><code>{\n  \"questions\": [\n    {\n      \"question\": \"Who is Luke Skywalker\u2019s dad?\",\n      \"choices\": [\"French Montana\", \"Anakin Skywalker\", \"The Dude\"]\n    },\n    {\n      \"question\": \"Which is the only film of the original six in which desert planet Tatooine doesn\u2019t appear?\",\n      \"choices\": [\"The Last Jedi\", \"Revenge of the Sith\", \"The Empire Strikes Back\"]\n    },\n    {\n      \"question\": \"Who kills Jabba The Hutt?\",\n      \"choices\": [\"Princess Leia\", \"Frodo\", \"Han Solo\"]\n    },\n    {\n      \"question\": \"What was Luke Skywalker\u2019s original surname?\",\n      \"choices\": [\"Starkiller\", \"The Phantom\", \"Arnold Schwarzenegger\"]\n    },\n    {\n      \"question\": \"What planet do Wookiees come from?\",\n      \"choices\": [\"Venus\", \"Jupiter\", \"Kashyyk\"]\n    }\n  ]\n}\n</code></pre>\n\n<p><strong>schema.rb</strong></p>\n\n<pre><code>ActiveRecord::Schema.define(version: 2018_09_05_120106) do\n\n  create_table \"answers\", force: :cascade do |t|\n    t.integer \"quiz_id\"\n    t.integer \"question_id\"\n    t.integer \"choice_id\"\n    t.datetime \"created_at\", null: false\n    t.datetime \"updated_at\", null: false\n    t.index [\"choice_id\"], name: \"index_answers_on_choice_id\"\n    t.index [\"question_id\"], name: \"index_answers_on_question_id\"\n    t.index [\"quiz_id\"], name: \"index_answers_on_quiz_id\"\n  end\n\n  create_table \"choices\", force: :cascade do |t|\n    t.text \"choice\"\n    t.integer \"question_id\"\n    t.datetime \"created_at\", null: false\n    t.datetime \"updated_at\", null: false\n    t.index [\"question_id\"], name: \"index_choices_on_question_id\"\n  end\n\n  create_table \"questions\", force: :cascade do |t|\n    t.text \"question\"\n    t.datetime \"created_at\", null: false\n    t.datetime \"updated_at\", null: false\n  end\n\n  create_table \"quizzes\", force: :cascade do |t|\n    t.boolean \"is_active\"\n    t.datetime \"created_at\", null: false\n    t.datetime \"updated_at\", null: false\n  end\n\nend\n</code></pre>\n\n<p><strong>routes.rb</strong></p>\n\n<pre><code>Rails.application.routes.draw do\n  # For details on the DSL available within this file, see http://guides.rubyonrails.org/routing.html\n  resources :quiz, only: [:new, :create] do\n    member do\n      get 'question'\n    end\n  end\n\n  resources :answer, only: [:create] do\n    collection do\n      get 'results'\n    end\n  end\n</code></pre>\n\n<p>root to: 'quiz#question'</p>\n\n<p>get '*path' => redirect('/')\nend</p>\n\n<p><strong>server log</strong></p>\n\n<pre><code>ActionController::UnknownFormat (AnswerController#results is missing a template for this request format and variant.\n</code></pre>\n\n<p><code>request.formats: [\"text/html\"]</code>\n<code>request.variant: []</code></p>\n\n<p><code>NOTE! For XHR/Ajax or API requests, this action would normally respond with 204 No Content: an empty white screen. Since you're loading it in a web browser, we assume that you expected to actually render a template, not nothing, so we're showing an error to be extra-clear. If you expect 204 No Content, carry on. That's what you'll get from an XHR or API request. Give it a shot.</code></p>\n\n<pre><code>actionpack (5.2.1) lib/action_controller/metal/implicit_render.rb:55:in `default_render'\nactionpack (5.2.1) lib/action_controller/metal/basic_implicit_render.rb:6:in `block in send_action'\nactionpack (5.2.1) lib/action_controller/metal/basic_implicit_render.rb:6:in `tap'\nactionpack (5.2.1) lib/action_controller/metal/basic_implicit_render.rb:6:in `send_action'\nactionpack (5.2.1) lib/abstract_controller/base.rb:194:in `process_action'\nactionpack (5.2.1) lib/action_controller/metal/rendering.rb:30:in `process_action'\nactionpack (5.2.1) lib/abstract_controller/callbacks.rb:42:in `block in process_action'\nactivesupport (5.2.1) lib/active_support/callbacks.rb:132:in `run_callbacks'\nactionpack (5.2.1) lib/abstract_controller/callbacks.rb:41:in `process_action'\nactionpack (5.2.1) lib/action_controller/metal/rescue.rb:22:in `process_action'\nactionpack (5.2.1) lib/action_controller/metal/instrumentation.rb:34:in `block in process_action'\nactivesupport (5.2.1) lib/active_support/notifications.rb:168:in `block in instrument'\nactivesupport (5.2.1) lib/active_support/notifications/instrumenter.rb:23:in `instrument'\nactivesupport (5.2.1) lib/active_support/notifications.rb:168:in `instrument'\nactionpack (5.2.1) lib/action_controller/metal/instrumentation.rb:32:in `process_action'\nactionpack (5.2.1) lib/action_controller/metal/params_wrapper.rb:256:in `process_action'\nactiverecord (5.2.1) lib/active_record/railties/controller_runtime.rb:24:in `process_action'\nactionpack (5.2.1) lib/abstract_controller/base.rb:134:in `process'\nactionview (5.2.1) lib/action_view/rendering.rb:32:in `process'\nactionpack (5.2.1) lib/action_controller/metal.rb:191:in `dispatch'\nactionpack (5.2.1) lib/action_controller/metal.rb:252:in `dispatch'\nactionpack (5.2.1) lib/action_dispatch/routing/route_set.rb:52:in `dispatch'\nactionpack (5.2.1) lib/action_dispatch/routing/route_set.rb:34:in `serve'\nactionpack (5.2.1) lib/action_dispatch/journey/router.rb:52:in `block in serve'\nactionpack (5.2.1) lib/action_dispatch/journey/router.rb:35:in `each'\nactionpack (5.2.1) lib/action_dispatch/journey/router.rb:35:in `serve'\nactionpack (5.2.1) lib/action_dispatch/routing/route_set.rb:840:in `call'\nrack (2.0.5) lib/rack/tempfile_reaper.rb:15:in `call'\nrack (2.0.5) lib/rack/etag.rb:25:in `call'\nrack (2.0.5) lib/rack/conditional_get.rb:25:in `call'\nrack (2.0.5) lib/rack/head.rb:12:in `call'\nactionpack (5.2.1) lib/action_dispatch/http/content_security_policy.rb:18:in `call'\nrack (2.0.5) lib/rack/session/abstract/id.rb:232:in `context'\nrack (2.0.5) lib/rack/session/abstract/id.rb:226:in `call'\nactionpack (5.2.1) lib/action_dispatch/middleware/cookies.rb:670:in `call'\nactiverecord (5.2.1) lib/active_record/migration.rb:559:in `call'\nactionpack (5.2.1) lib/action_dispatch/middleware/callbacks.rb:28:in `block in call'\nactivesupport (5.2.1) lib/active_support/callbacks.rb:98:in `run_callbacks'\nactionpack (5.2.1) lib/action_dispatch/middleware/callbacks.rb:26:in `call'\nactionpack (5.2.1) lib/action_dispatch/middleware/executor.rb:14:in `call'\nactionpack (5.2.1) lib/action_dispatch/middleware/debug_exceptions.rb:61:in `call'\nweb-console (3.6.2) lib/web_console/middleware.rb:135:in `call_app'\nweb-console (3.6.2) lib/web_console/middleware.rb:30:in `block in call'\nweb-console (3.6.2) lib/web_console/middleware.rb:20:in `catch'\nweb-console (3.6.2) lib/web_console/middleware.rb:20:in `call'\nactionpack (5.2.1) lib/action_dispatch/middleware/show_exceptions.rb:33:in `call'\nrailties (5.2.1) lib/rails/rack/logger.rb:38:in `call_app'\nrailties (5.2.1) lib/rails/rack/logger.rb:26:in `block in call'\nactivesupport (5.2.1) lib/active_support/tagged_logging.rb:71:in `block in tagged'\nactivesupport (5.2.1) lib/active_support/tagged_logging.rb:28:in `tagged'\nactivesupport (5.2.1) lib/active_support/tagged_logging.rb:71:in `tagged'\nrailties (5.2.1) lib/rails/rack/logger.rb:26:in `call'\nsprockets-rails (3.2.1) lib/sprockets/rails/quiet_assets.rb:13:in `call'\nactionpack (5.2.1) lib/action_dispatch/middleware/remote_ip.rb:81:in `call'\nactionpack (5.2.1) lib/action_dispatch/middleware/request_id.rb:27:in `call'\nrack (2.0.5) lib/rack/method_override.rb:22:in `call'\nrack (2.0.5) lib/rack/runtime.rb:22:in `call'\nactivesupport (5.2.1) lib/active_support/cache/strategy/local_cache_middleware.rb:29:in `call'\nactionpack (5.2.1) lib/action_dispatch/middleware/executor.rb:14:in `call'\nactionpack (5.2.1) lib/action_dispatch/middleware/static.rb:127:in `call'\nrack (2.0.5) lib/rack/sendfile.rb:111:in `call'\nrailties (5.2.1) lib/rails/engine.rb:524:in `call'\npuma (3.12.0) lib/puma/configuration.rb:225:in `call'\npuma (3.12.0) lib/puma/server.rb:658:in `handle_request'\npuma (3.12.0) lib/puma/server.rb:472:in `process_client'\npuma (3.12.0) lib/puma/server.rb:332:in `block in run'\npuma (3.12.0) lib/puma/thread_pool.rb:133:in `block in spawn_thread'\n</code></pre>\n\n<p>I've been stuck on this for a long time now and I could not find any relevant answers for my problem.</p>\n"}, {"tags": ["ruby", "python-3.x", "capistrano3", "virtualenvwrapper"], "comments": [{"owner": {"reputation": 1298, "user_id": 6305204, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/jGfSZ.png?s=128&g=1", "display_name": "con--", "link": "https://stackoverflow.com/users/6305204/con"}, "edited": false, "score": 0, "creation_date": 1536750383, "post_id": 52293561, "comment_id": 91535034, "body": "Probably an issue with .bashrc or .profile not being loaded, see <a href=\"https://stackoverflow.com/questions/4978564/invoking-bash-aliases-in-rake\">this answer</a>. What does <code>type workon</code> return?"}, {"owner": {"reputation": 545, "user_id": 1658053, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/1bf2373eaf0666115f63f3b5fb3287d6?s=128&d=identicon&r=PG&f=1", "display_name": "polarcare", "link": "https://stackoverflow.com/users/1658053/polarcare"}, "reply_to_user": {"reputation": 1298, "user_id": 6305204, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/jGfSZ.png?s=128&g=1", "display_name": "con--", "link": "https://stackoverflow.com/users/6305204/con"}, "edited": false, "score": 0, "creation_date": 1536751108, "post_id": 52293561, "comment_id": 91535447, "body": "Yeah I&#39;ve tried &quot;source ~/.bashrc and .profile&quot; but no joy. Not sure how to get Capistrano to acknowledge it."}, {"owner": {"reputation": 1298, "user_id": 6305204, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/jGfSZ.png?s=128&g=1", "display_name": "con--", "link": "https://stackoverflow.com/users/6305204/con"}, "edited": false, "score": 0, "creation_date": 1536751384, "post_id": 52293561, "comment_id": 91535595, "body": "Could also be that you&#39;re using execute instead of system. What does <code>type workon</code> return when you enter it in the console?"}, {"owner": {"reputation": 545, "user_id": 1658053, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/1bf2373eaf0666115f63f3b5fb3287d6?s=128&d=identicon&r=PG&f=1", "display_name": "polarcare", "link": "https://stackoverflow.com/users/1658053/polarcare"}, "reply_to_user": {"reputation": 1298, "user_id": 6305204, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/jGfSZ.png?s=128&g=1", "display_name": "con--", "link": "https://stackoverflow.com/users/6305204/con"}, "edited": false, "score": 0, "creation_date": 1536754067, "post_id": 52293561, "comment_id": 91537165, "body": "type workon returns &quot;workon is a function \\n workon() {function code displayed}&quot;"}], "answers": [{"comments": [{"owner": {"reputation": 545, "user_id": 1658053, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/1bf2373eaf0666115f63f3b5fb3287d6?s=128&d=identicon&r=PG&f=1", "display_name": "polarcare", "link": "https://stackoverflow.com/users/1658053/polarcare"}, "edited": false, "score": 1, "creation_date": 1536764918, "post_id": 52297310, "comment_id": 91544466, "body": "Switching from &quot;workon&quot; to &quot;source /path/to/.virtualenvs/myproject/bin/activate&quot; works. Thank you for your help."}], "tags": [], "owner": {"reputation": 55797, "user_id": 7976758, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/512cfbaf98d63ca4acd57b2df792aec6?s=128&d=identicon&r=PG", "display_name": "phd", "link": "https://stackoverflow.com/users/7976758/phd"}, "is_accepted": true, "score": 2, "last_activity_date": 1536761742, "creation_date": 1536761742, "answer_id": 52297310, "question_id": 52293561, "link": "https://stackoverflow.com/questions/52293561/activate-virtualenv-wrapper-with-capistrano/52297310#52297310", "title": "Activate Virtualenv Wrapper with Capistrano", "body": "<p><code>workon</code> is not a program but a shell function from <code>virtualenvwrapper</code>. For <code>bash</code> to find it you have to source <code>virtualenvwrapper.sh</code> in the shell.</p>\n"}], "owner": {"reputation": 545, "user_id": 1658053, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/1bf2373eaf0666115f63f3b5fb3287d6?s=128&d=identicon&r=PG&f=1", "display_name": "polarcare", "link": "https://stackoverflow.com/users/1658053/polarcare"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 126, "favorite_count": 0, "accepted_answer_id": 52297310, "answer_count": 1, "score": 1, "last_activity_date": 1536761742, "creation_date": 1536749991, "question_id": 52293561, "link": "https://stackoverflow.com/questions/52293561/activate-virtualenv-wrapper-with-capistrano", "title": "Activate Virtualenv Wrapper with Capistrano", "body": "<p>I am trying to deploy a Django project with Capistrano. Capistrano deploys the code to my server and finishes deploy steps.</p>\n\n<p>But when I try add a custom task like this...</p>\n\n<pre><code>task :collect_static do\n  on roles(:app) do |host|\n    execute \"cd #{release_path}/myproject\"\n    execute \"workon myproject\"\n    execute \"./manage.py collectstatic\"\n  end\nend\n\nafter \"deploy:updated\", \"collect_static\"\n</code></pre>\n\n<p>It throws the following error...</p>\n\n<pre><code>02 bash: workon: command not found\n</code></pre>\n\n<p>After the deploy, if I SSH manually onto server and run workon command it works fine(same user). Just Capistrano doesn't recognise it? </p>\n"}, {"tags": ["ruby", "bundle", "bundler"], "comments": [{"owner": {"reputation": 16672, "user_id": 22237, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/hkobD.png?s=128&g=1", "display_name": "Kris", "link": "https://stackoverflow.com/users/22237/kris"}, "edited": false, "score": 4, "creation_date": 1536749443, "post_id": 52293120, "comment_id": 91534561, "body": "The <code>.bundle</code> directory is usually excluded from version control."}, {"owner": {"reputation": 6462, "user_id": 3784008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/55ou4.jpg?s=128&g=1", "display_name": "anothermh", "link": "https://stackoverflow.com/users/3784008/anothermh"}, "reply_to_user": {"reputation": 16672, "user_id": 22237, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/hkobD.png?s=128&g=1", "display_name": "Kris", "link": "https://stackoverflow.com/users/22237/kris"}, "edited": false, "score": 1, "creation_date": 1538804879, "post_id": 52293120, "comment_id": 92281402, "body": "To elaborate on @Kris&#39;s comment, the official bundler documentation states <a href=\"https://bundler.io/rationale.html#checking-your-code-into-version-control\" rel=\"nofollow noreferrer\">&quot;Do not check in the .bundle directory, or any of the files inside it. Those files are specific to each particular machine, and are used to persist installation options between runs of the bundle install command.&quot;</a>"}], "owner": {"reputation": 1838, "user_id": 3692286, "user_type": "registered", "accept_rate": 48, "profile_image": "https://i.stack.imgur.com/deAJz.jpg?s=128&g=1", "display_name": "jleeothon", "link": "https://stackoverflow.com/users/3692286/jleeothon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 73, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1536748466, "creation_date": 1536748466, "question_id": 52293120, "link": "https://stackoverflow.com/questions/52293120/bundle-install-saves-parameters-in-the-config-file-can-it-be-prevented", "title": "`bundle install` saves parameters in the config file, can it be prevented?", "body": "<p>Documentation for <code>bundle config</code> says that a configuration file is necessary for remembering options such as <code>--path</code> or <code>--without</code>.</p>\n\n<p>I find that when I run <code>bundle install --without some-group</code> or <code>BUNDLE_WITHOUT=some-group bundle install</code>, my <code>.bundle/config</code> file has a new line, namely:</p>\n\n<pre><code>BUNDLE_WITHOUT: \"some-group\"\n</code></pre>\n\n<p>I would like be able to install without a certain group yet not have a new line in <code>.bundle/config</code>.</p>\n\n<p>This is inconvenient because <code>.bundle/config</code> is naturally under source control, but I have two development environments, one where <code>some-group</code> can be installed and one where it can't.</p>\n\n<p>I don't want developers to see untracked modifications in their git status when they develop in the platform where an environment variable <code>BUNDLE_WITHOUT</code> is set.</p>\n\n<p>Recommendations?</p>\n"}, {"tags": ["ruby", "encoder"], "comments": [{"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1536745979, "post_id": 52292283, "comment_id": 91532436, "body": "Please show the desired output for the string <code>&quot;aA0\ufffd&quot;</code>."}, {"owner": {"reputation": 9030, "user_id": 5101476, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JCQrl.jpg?s=128&g=1", "display_name": "ice\u30c4", "link": "https://stackoverflow.com/users/5101476/ice%e3%83%84"}, "edited": false, "score": 0, "creation_date": 1536748095, "post_id": 52292283, "comment_id": 91533754, "body": "What do you need this for?"}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1536749931, "post_id": 52292283, "comment_id": 91534817, "body": "<i>&quot;Any other character could be greater than 26.&quot;</i> -- What does this mean? Does every other character get encoded to 27? I&#39;m guessing so, by the title of your question, but &quot;greater than 26&quot; is an unnecessarily ambiguous requirement."}], "answers": [{"comments": [{"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 1, "creation_date": 1536766880, "post_id": 52292438, "comment_id": 91545616, "body": "Alternatively <code>&#39;a&#39;.upto(&#39;z&#39;).with_index(1).to_h.tap {|h| h.default = 27}</code> and <code>each_char</code> might be nicer since <code>chars</code> returns an <code>Array</code> rather than an <code>Enumerator</code>"}], "tags": [], "owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "is_accepted": false, "score": 2, "last_activity_date": 1536767383, "last_edit_date": 1536767383, "creation_date": 1536746283, "answer_id": 52292438, "question_id": 52292283, "link": "https://stackoverflow.com/questions/52292283/a-to-z-as-1-to-27-encoder-in-ruby/52292438#52292438", "title": "a to z as 1 to 27 encoder in Ruby", "body": "<p><code>Hash</code> as a <code>subst</code> is good enough since Ruby 2.3 where <code>Hash#to_proc</code> was implemented.</p>\n\n<pre><code>subst =\n  [*?a..?z].zip(1..26).to_h.tap do |h|\n    h.default_proc = -&gt;(_, _) { 27 }\n  end\n\"aA0\".downcase.each_char.map(&amp;subst)\n#\u21d2 [1, 1, 27]\n</code></pre>\n\n<hr>\n\n<p>or (credits go to @engineersmnky):</p>\n\n<pre><code>'a'.upto('z').with_index(1).to_h.tap {|h| h.default = 27 }\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "is_accepted": false, "score": 3, "last_activity_date": 1536768911, "last_edit_date": 1536768911, "creation_date": 1536750574, "answer_id": 52293745, "question_id": 52292283, "link": "https://stackoverflow.com/questions/52292283/a-to-z-as-1-to-27-encoder-in-ruby/52293745#52293745", "title": "a to z as 1 to 27 encoder in Ruby", "body": "<p>Here is a solution that maps the string directly to an <code>Array</code> of <code>Integer</code>s; making use of the fact that <code>\"a\".ord == 97</code>, <code>\"b\".ord == 98</code>, etc:</p>\n\n<pre><code>def encode(str)\n  str.each_char.map do |char|\n    char.match?(/[a-z]/i) ? c.downcase.ord - 96 : 27\n  end\nend\n\nencode(\"aAzZ1&amp;\")\n#=&gt; [1, 1, 26, 26, 27, 27]\n</code></pre>\n\n<p>Edit: Or similarly, you could perform the <code>String#downcase</code> before looping through the characters:</p>\n\n<pre><code>def encode(str)\n  str.downcase.each_char.map do |char|\n    char.match?(/[a-z]/) ? c.ord - 96 : 27\n  end\nend\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1536789651, "post_id": 52301051, "comment_id": 91555692, "body": "How about <code>letters.index(self.downcase)&amp;.+(1) || 27</code>"}], "tags": [], "owner": {"reputation": 9663, "user_id": 5239030, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/76JEw.png?s=128&g=1", "display_name": "iGian", "link": "https://stackoverflow.com/users/5239030/igian"}, "is_accepted": false, "score": 0, "last_activity_date": 1536775264, "creation_date": 1536775264, "answer_id": 52301051, "question_id": 52292283, "link": "https://stackoverflow.com/questions/52292283/a-to-z-as-1-to-27-encoder-in-ruby/52301051#52301051", "title": "a to z as 1 to 27 encoder in Ruby", "body": "<p>My option monkey patching the String class.</p>\n\n<pre><code>module MyEncoding\n  def encode_char_to_int\n    letters = [*\"a\"..\"z\"]\n    return letters.index(self.downcase) + 1 if letters.include? self.downcase \n    return 27 # rand(27..255)\n  end\n\n  def my_encode\n    self.split(\"\").map(&amp;:encode_char_to_int)#.join(\"\")\n  end\nend\n\nString.include MyEncoding\n\n\"aAzZ1&amp;\".my_encode #=&gt; [1, 1, 26, 26, 27, 27]\n</code></pre>\n"}], "owner": {"reputation": 1397, "user_id": 4940278, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/06NHi.jpg?s=128&g=1", "display_name": "Luna Lovegood", "link": "https://stackoverflow.com/users/4940278/luna-lovegood"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 141, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1536775264, "creation_date": 1536745858, "last_edit_date": 1536747201, "question_id": 52292283, "link": "https://stackoverflow.com/questions/52292283/a-to-z-as-1-to-27-encoder-in-ruby", "title": "a to z as 1 to 27 encoder in Ruby", "body": "<p>Is there any encoding format or standard that satisfies the following conditions?</p>\n\n<ul>\n<li>A-Z and a-z should be encoded as 1-26.</li>\n<li>Any other character could be greater than 26.</li>\n</ul>\n\n<p>If not, what is the best way to do such conversion?</p>\n\n<p>Hash map is one obvious way, but my ruby intuition says there must be something better.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "unit-testing", "rspec", "yield"], "answers": [{"comments": [{"owner": {"reputation": 92, "user_id": 6358270, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c30933301b8eed6cd6216044fae75dab?s=128&d=identicon&r=PG&f=1", "display_name": "Seybol", "link": "https://stackoverflow.com/users/6358270/seybol"}, "edited": false, "score": 0, "creation_date": 1536746109, "post_id": 52292182, "comment_id": 91532529, "body": "Awesome !! Thanks a lot ! It works perfectly ! And thanks for the tips."}], "tags": [], "owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "is_accepted": true, "score": 4, "last_activity_date": 1536745533, "creation_date": 1536745533, "answer_id": 52292182, "question_id": 52291698, "link": "https://stackoverflow.com/questions/52291698/ruby-rspec-and-yield-stubbing/52292182#52292182", "title": "Ruby, Rspec, and yield stubbing", "body": "<p>The issue is <code>.and_yield(Faker::Name.name, Faker::Name.last_name)</code> is being executed <em>once</em>. Your function is <em>already</em> prepared to receive a param, use it:</p>\n\n<pre><code>40.times do |i|\n  allow(friends).to receive(:search_for_names).with(i).and_yield(\n    \"#{Faker::Name.name}_#{i}\",\n    \"#{Faker::Name.last_name}_#{i}\"\n  )\nend\n</code></pre>\n\n<hr>\n\n<p><em>Sidenote:</em> instead of introducing a local variable <code>count</code>, just use what <code>Integer#times</code> passes to the block:</p>\n\n<pre><code>def execute\n  40.times do |count|\n    search_for_names(count) do |name, last_name|\n      yield name, last_name\n    end\n  end\nend\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "is_accepted": false, "score": 2, "last_activity_date": 1536769042, "last_edit_date": 1536769042, "creation_date": 1536768303, "answer_id": 52299382, "question_id": 52291698, "link": "https://stackoverflow.com/questions/52291698/ruby-rspec-and-yield-stubbing/52299382#52299382", "title": "Ruby, Rspec, and yield stubbing", "body": "<p>Another option is to use the block syntax of <code>receive</code> like so </p>\n\n<pre><code>allow(friends).to receive(:search_for_names) do |_,&amp;block| \n  block.call(Faker::Name.name, Faker::Name.last_name)\nend\n</code></pre>\n\n<p>rather than implicitly <code>yielding</code> to the block instead we capture the block (<code>&amp;block</code>) and then explicitly call it with the <code>Faker</code> arguments. </p>\n\n<p>This avoids the need for the internal loop 40 times to make <code>allow</code>ances as every time <code>search_for_names</code> is called this block will be executed again.</p>\n\n<p><a href=\"https://repl.it/@engineersmnky/AllowReceiveandBlock\" rel=\"nofollow noreferrer\">Repl Example</a></p>\n"}], "owner": {"reputation": 92, "user_id": 6358270, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c30933301b8eed6cd6216044fae75dab?s=128&d=identicon&r=PG&f=1", "display_name": "Seybol", "link": "https://stackoverflow.com/users/6358270/seybol"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2827, "favorite_count": 0, "accepted_answer_id": 52292182, "answer_count": 2, "score": 1, "last_activity_date": 1536769042, "creation_date": 1536743974, "question_id": 52291698, "link": "https://stackoverflow.com/questions/52291698/ruby-rspec-and-yield-stubbing", "title": "Ruby, Rspec, and yield stubbing", "body": "<p>Let's say I have a class like this in Ruby:</p>\n\n<pre><code>class Test\n  def execute\n    count = 0\n    40.times do\n      search_for_names(count) do |name, last_name|\n        yield name, last_name\n      end\n      count += 1\n    end\n  end\n\n  def search_for_names(count)\n    friend = get_friend_name(count)\n    yield friend.name, friend.last_name\n  end\nend\n</code></pre>\n\n<p>My question is: how do I do to stub my search_for_names method to get 40 different names in my Rspec test? (I installed Faker).\nI tried:</p>\n\n<pre><code>let(:friends) do\ndescribed_class.new\nend\n\nallow(friends).to receive(:search_for_names).and_yield(\n      Faker::Name.name,\n      Faker::Name.last_name\n)\n\n it 'finds multiple friends' do\n    friends.execute do |name, last_name|\n      puts name\n      expect(name).not_to be_empty\n      expect(last_name).not_to be_empty\n    end\n  end\n</code></pre>\n\n<p>But it prints always the same name x40.</p>\n\n<p>And... :</p>\n\n<pre><code>allow(friends).to receive(:search_for_names).and_yield(\n      Faker::Name.name,\n      Faker::Name.last_name\n    ).and_yield(\n      Faker::Name.name,\n      Faker::Name.last_name\n    )\n</code></pre>\n\n<p>But it prints two different names x40 (80 names). But I would like to have only 40 times a different name. Is it possible ?\nThanks in advance !</p>\n"}, {"tags": ["ruby", "watir", "irb"], "comments": [{"owner": {"reputation": 13, "user_id": 7486135, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-FB05YOSf4rc/AAAAAAAAAAI/AAAAAAAAABY/qAE2yDrKlBQ/photo.jpg?sz=128", "display_name": "Dan Moskalchuck", "link": "https://stackoverflow.com/users/7486135/dan-moskalchuck"}, "reply_to_user": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 0, "creation_date": 1536741712, "post_id": 52290852, "comment_id": 91529750, "body": "@sawa, how could I solve this issue? What am I missing? What am I doing wrong?"}, {"owner": {"reputation": 3523, "user_id": 9043475, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FNxvn.jpg?s=128&g=1", "display_name": "Rajagopalan", "link": "https://stackoverflow.com/users/9043475/rajagopalan"}, "reply_to_user": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 0, "creation_date": 1536753725, "post_id": 52290852, "comment_id": 91536943, "body": "@sawa what&#39;s not clear for you?"}, {"owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "reply_to_user": {"reputation": 3523, "user_id": 9043475, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FNxvn.jpg?s=128&g=1", "display_name": "Rajagopalan", "link": "https://stackoverflow.com/users/9043475/rajagopalan"}, "edited": false, "score": 0, "creation_date": 1536809222, "post_id": 52290852, "comment_id": 91559682, "body": "@Rajagopalan As I wrote, the question was not clear before the edit."}, {"owner": {"reputation": 3523, "user_id": 9043475, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FNxvn.jpg?s=128&g=1", "display_name": "Rajagopalan", "link": "https://stackoverflow.com/users/9043475/rajagopalan"}, "reply_to_user": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 0, "creation_date": 1536809813, "post_id": 52290852, "comment_id": 91559811, "body": "@sawa Okay, Fine."}], "answers": [{"tags": [], "owner": {"reputation": 3523, "user_id": 9043475, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FNxvn.jpg?s=128&g=1", "display_name": "Rajagopalan", "link": "https://stackoverflow.com/users/9043475/rajagopalan"}, "is_accepted": true, "score": 0, "last_activity_date": 1536743480, "creation_date": 1536743480, "answer_id": 52291534, "question_id": 52290852, "link": "https://stackoverflow.com/questions/52290852/netreadtimeout-error-when-watirbrowser-new/52291534#52291534", "title": "Net::ReadTimeout Error when Watir::Browser.new", "body": "<p>As you said this happens when page load exceeds 60 seconds, you can increase the page load timeout by the following code</p>\n\n<pre><code>client = Selenium::WebDriver::Remote::Http::Default.new\nclient.read_timeout = 120 # seconds\ndriver = Selenium::WebDriver.for :firefox,http_client: client\nb=Watir::Browser.new driver\n</code></pre>\n\n<p>Now your code would wait for 120 seconds for any page load which has been caused by #click and also wait to load the url by goto method.</p>\n"}], "owner": {"reputation": 13, "user_id": 7486135, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-FB05YOSf4rc/AAAAAAAAAAI/AAAAAAAAABY/qAE2yDrKlBQ/photo.jpg?sz=128", "display_name": "Dan Moskalchuck", "link": "https://stackoverflow.com/users/7486135/dan-moskalchuck"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 944, "favorite_count": 1, "accepted_answer_id": 52291534, "answer_count": 1, "score": 0, "last_activity_date": 1536743480, "creation_date": 1536741241, "last_edit_date": 1536741734, "question_id": 52290852, "link": "https://stackoverflow.com/questions/52290852/netreadtimeout-error-when-watirbrowser-new", "title": "Net::ReadTimeout Error when Watir::Browser.new", "body": "<p><strong>I'm trying to start watir browser,</strong></p>\n\n<pre><code>irb(main):001:0&gt; require 'watir'\n=&gt; true\nirb(main):002:0&gt; browser = Watir::Browser.new\n</code></pre>\n\n<p>Watir opens a new chrome browser with <code>data:,</code>wrote in the search bar. After 60 seconds of waiting, the browser just closes, and I'm getting this error in console:</p>\n\n<pre><code>Net::ReadTimeout: Net::ReadTimeout\n    from /usr/lib/ruby/2.3.0/net/protocol.rb:158:in `rbuf_fill'\n    from /usr/lib/ruby/2.3.0/net/protocol.rb:136:in `readuntil'\n    from /usr/lib/ruby/2.3.0/net/protocol.rb:146:in `readline'\n    from /usr/lib/ruby/2.3.0/net/http/response.rb:40:in `read_status_line'\n    from /usr/lib/ruby/2.3.0/net/http/response.rb:29:in `read_new'\n    from /usr/lib/ruby/2.3.0/net/http.rb:1437:in `block in transport_request'\n    from /usr/lib/ruby/2.3.0/net/http.rb:1434:in `catch'\n    from /usr/lib/ruby/2.3.0/net/http.rb:1434:in `transport_request'\n    from /usr/lib/ruby/2.3.0/net/http.rb:1407:in `request'\n    from /usr/lib/ruby/2.3.0/net/http.rb:1400:in `block in request'\n    from /usr/lib/ruby/2.3.0/net/http.rb:853:in `start'\n    from /usr/lib/ruby/2.3.0/net/http.rb:1398:in `request'\n    from /var/lib/gems/2.3.0/gems/selenium-webdriver-3.14.0/lib/selenium/webdriver/remote/http/default.rb:121:in `response_for'\n    from /var/lib/gems/2.3.0/gems/selenium-webdriver-3.14.0/lib/selenium/webdriver/remote/http/default.rb:76:in `request'\n    from /var/lib/gems/2.3.0/gems/selenium-webdriver-3.14.0/lib/selenium/webdriver/remote/http/common.rb:62:in `call'\n    from /var/lib/gems/2.3.0/gems/selenium-webdriver-3.14.0/lib/selenium/webdriver/remote/bridge.rb:164:in `execute'\n    from /var/lib/gems/2.3.0/gems/selenium-webdriver-3.14.0/lib/selenium/webdriver/remote/bridge.rb:97:in `create_session'\n    from /var/lib/gems/2.3.0/gems/selenium-webdriver-3.14.0/lib/selenium/webdriver/remote/bridge.rb:53:in `handshake'\n    from /var/lib/gems/2.3.0/gems/selenium-webdriver-3.14.0/lib/selenium/webdriver/chrome/driver.rb:48:in `initialize'\n    from /var/lib/gems/2.3.0/gems/selenium-webdriver-3.14.0/lib/selenium/webdriver/common/driver.rb:44:in `new'\n    from /var/lib/gems/2.3.0/gems/selenium-webdriver-3.14.0/lib/selenium/webdriver/common/driver.rb:44:in `for'\n    from /var/lib/gems/2.3.0/gems/selenium-webdriver-3.14.0/lib/selenium/webdriver.rb:86:in `for'\n    from /var/lib/gems/2.3.0/gems/watir-6.13.0/lib/watir/browser.rb:48:in `initialize'\n    from (irb):3:in `new'\n    from (irb):3\n    from /usr/bin/irb:11:in `&lt;main&gt;'\n</code></pre>\n\n<p><strong>How could I solve this issue?</strong></p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 32131, "user_id": 2346461, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/i3xAf.jpg?s=128&g=1", "display_name": "Pavan", "link": "https://stackoverflow.com/users/2346461/pavan"}, "edited": false, "score": 0, "creation_date": 1536740856, "post_id": 52290627, "comment_id": 91529225, "body": "Is <code>@client</code> available in <code>create</code> action? If so you can just do <code>@note.client_id = @client.id</code>"}, {"owner": {"reputation": 49, "user_id": 10351786, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-qhgIlxRCj9k/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaPNtGs8HJeuz95Pt8hP2ESBynByTQ/mo/photo.jpg?sz=128", "display_name": "Saul Anstey", "link": "https://stackoverflow.com/users/10351786/saul-anstey"}, "reply_to_user": {"reputation": 32131, "user_id": 2346461, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/i3xAf.jpg?s=128&g=1", "display_name": "Pavan", "link": "https://stackoverflow.com/users/2346461/pavan"}, "edited": false, "score": 0, "creation_date": 1536741739, "post_id": 52290627, "comment_id": 91529766, "body": "Woops, there we go, I knew it could be something that simple. That fixes all issues. Cheers mate!"}, {"owner": {"reputation": 706, "user_id": 6492146, "user_type": "registered", "accept_rate": 82, "profile_image": "https://graph.facebook.com/10157001409455137/picture?type=large", "display_name": "Verty00", "link": "https://stackoverflow.com/users/6492146/verty00"}, "edited": false, "score": 0, "creation_date": 1536742022, "post_id": 52290627, "comment_id": 91529934, "body": "Check out my answer below. I show you a very &quot;Rails&quot; way to to this using the <code>.build()</code> method"}], "answers": [{"comments": [{"owner": {"reputation": 706, "user_id": 6492146, "user_type": "registered", "accept_rate": 82, "profile_image": "https://graph.facebook.com/10157001409455137/picture?type=large", "display_name": "Verty00", "link": "https://stackoverflow.com/users/6492146/verty00"}, "reply_to_user": {"reputation": 49, "user_id": 10351786, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-qhgIlxRCj9k/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaPNtGs8HJeuz95Pt8hP2ESBynByTQ/mo/photo.jpg?sz=128", "display_name": "Saul Anstey", "link": "https://stackoverflow.com/users/10351786/saul-anstey"}, "edited": false, "score": 0, "creation_date": 1536742853, "post_id": 52291008, "comment_id": 91530449, "body": "Awesome. If this helped please select it as the answer!"}], "tags": [], "owner": {"reputation": 706, "user_id": 6492146, "user_type": "registered", "accept_rate": 82, "profile_image": "https://graph.facebook.com/10157001409455137/picture?type=large", "display_name": "Verty00", "link": "https://stackoverflow.com/users/6492146/verty00"}, "is_accepted": true, "score": 0, "last_activity_date": 1536741800, "creation_date": 1536741800, "answer_id": 52291008, "question_id": 52290627, "link": "https://stackoverflow.com/questions/52290627/upload-image-with-active-record-and-save-item-with-reference-to-session-model/52291008#52291008", "title": "Upload Image with Active Record and Save Item with Reference to Session Model", "body": "<p>Instead of </p>\n\n<p><code>@note = Note.new(note_params)</code> </p>\n\n<p>try </p>\n\n<p><code>@note = Client.new.notes.build(note_params)</code> </p>\n\n<p>the <code>.notes</code> method (i.e. \"<code>Client.new.notes</code>\" ) comes from assuming you have a <code>has_many :notes</code> declaration in your <code>Client</code> model. </p>\n\n<p>If you are only using a <code>has_one :note</code> declaration in your Client model then the <code>.build()</code> method will not work.  </p>\n"}], "owner": {"reputation": 49, "user_id": 10351786, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-qhgIlxRCj9k/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaPNtGs8HJeuz95Pt8hP2ESBynByTQ/mo/photo.jpg?sz=128", "display_name": "Saul Anstey", "link": "https://stackoverflow.com/users/10351786/saul-anstey"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 25, "favorite_count": 0, "accepted_answer_id": 52291008, "answer_count": 1, "score": 0, "last_activity_date": 1536741800, "creation_date": 1536740438, "question_id": 52290627, "link": "https://stackoverflow.com/questions/52290627/upload-image-with-active-record-and-save-item-with-reference-to-session-model", "title": "Upload Image with Active Record and Save Item with Reference to Session Model", "body": "<p>2 questions really:\n1) I am trying to save a note that belongs to the Client model (which also is used as login to create the session - therefore session[:id] = @client.id)\n2)The note is an image, uploaded using ActiveRecord model.</p>\n\n<p>Post request seems to be working fine but the note doesn't save. I am trying to only save the image first and client.id reference at first. The rest of the columns in the model will be filled in later using edit.</p>\n\n<p>db schema contains the 2 ActiveRecord tables.\nThere seems to be no errors coming up but no new note is created (@note.save = false), which could be because currently nothing is being saved to a new note, just a new blob... in cmd you can see blob creation insert works fine, and then the next transaction is rolledback.\nHow would I add the logic to save @client.id in the note?</p>\n\n<p>Below my code snippets...</p>\n\n<p><strong>the form for from the view:</strong></p>\n\n<pre><code>&lt;div class=\"image-upload\"&gt;\n        &lt;h3&gt;Upload image of sick note&lt;/h3&gt;\n        &lt;div class=\"signup-form\"&gt;\n            &lt;%= form_for(@note) do |f| %&gt;\n                &lt;%= f.file_field :image %&gt;          \n                &lt;%= f.submit \"Load Sick Note\", class: \"btn-submit\" %&gt; \n            &lt;% end %&gt;\n        &lt;/div&gt;\n    &lt;/div&gt;\n</code></pre>\n\n<p><strong>The create in the controller:</strong></p>\n\n<pre><code>def create\n        @note = Note.new(note_params)\n        if @note.save \n            redirect_to '/' \n        else \n            redirect_to '/dashboard' \n        end \n    end\n\n    private\n\n    def note_params\n        params.require(:note).permit(:image)\n    end\n</code></pre>\n\n<p><strong>Note model:</strong></p>\n\n<pre><code>class Note &lt; ApplicationRecord\n    belongs_to :client\n    has_one_attached :image\nend\n</code></pre>\n"}, {"tags": ["ruby", "cryptography", "modular-arithmetic"], "comments": [{"owner": {"reputation": 2251, "user_id": 9785060, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IUduC.png?s=128&g=1", "display_name": "Viktor", "link": "https://stackoverflow.com/users/9785060/viktor"}, "edited": false, "score": 3, "creation_date": 1536738591, "post_id": 52289766, "comment_id": 91527917, "body": "I think it would be helpful to give an example of X,Y and the expected output."}, {"owner": {"reputation": 121, "user_id": 9716002, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Alloysius Goh", "link": "https://stackoverflow.com/users/9716002/alloysius-goh"}, "reply_to_user": {"reputation": 2251, "user_id": 9785060, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IUduC.png?s=128&g=1", "display_name": "Viktor", "link": "https://stackoverflow.com/users/9785060/viktor"}, "edited": false, "score": 0, "creation_date": 1536758737, "post_id": 52289766, "comment_id": 91540442, "body": "@VIktor x = 65537; y = 147720936134669456975617202169086913591832713006137189368588&zwnj;&#8203;33403083630967210260&zwnj;&#8203;10354258414621865101&zwnj;&#8203;49328644813449230183&zwnj;&#8203;61049907164682263472&zwnj;&#8203;08766655183837590841&zwnj;&#8203;16646191872547556483&zwnj;&#8203;67460685678889387690&zwnj;&#8203;52417227010885342717&zwnj;&#8203;00867144889033866109&zwnj;&#8203;54714383852836526318&zwnj;&#8203;63019502999263022932&zwnj;&#8203;85507357594571617185&zwnj;&#8203;598409976"}], "answers": [{"comments": [{"owner": {"reputation": 121, "user_id": 9716002, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Alloysius Goh", "link": "https://stackoverflow.com/users/9716002/alloysius-goh"}, "edited": false, "score": 1, "creation_date": 1536738034, "post_id": 52289853, "comment_id": 91527601, "body": "I will take a look. Thank you so much."}], "tags": [], "owner": {"reputation": 1556, "user_id": 2830852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/31ea598b6bc18b59de1e77a4c6f6c3e5?s=128&d=identicon&r=PG", "display_name": "Tarek N. Elsamni", "link": "https://stackoverflow.com/users/2830852/tarek-n-elsamni"}, "is_accepted": false, "score": -1, "last_activity_date": 1536742938, "last_edit_date": 1536742938, "creation_date": 1536737846, "answer_id": 52289853, "question_id": 52289766, "link": "https://stackoverflow.com/questions/52289766/find-inverse-mod-in-ruby/52289853#52289853", "title": "Find inverse mod in ruby", "body": "<p>This code in ruby is calculating the inverse mod correctly:</p>\n\n<p><a href=\"https://gist.github.com/jingoro/2388745\" rel=\"nofollow noreferrer\">https://gist.github.com/jingoro/2388745</a></p>\n\n<pre><code># Some modular arithmetic helper methods useful for number theory or\n# cryptography.\n#\n# # Examples\n#\n# Compute the greatest common denominator of 114 and 48:\n#\n#     gcd(114, 48) #=&gt; 6\n#\n# Compute `a` and `b` such that `a*x + b*y = gcd(x, y)`:\n#\n#     g, a, b = gcdext(3, 5)\n#     g #=&gt; 1\n#     a #=&gt; 2\n#     b #=&gt; -1\n#\n# Compute the inverse of 4 modulo 7:\n#\n#     invert(4, 7) #=&gt; 2\n#\n# Compute 3 raised to 4 modulo 5:\n#\n#     powmod(3, 4, 5) #=&gt; 1\n#\nmodule ModularArithmetic\n\n  module_function\n\n  # Returns the greatest common denominator of `x` and `y`.\n  #\n  # @param [Integer] x\n  # @param [Integer] y\n  # @return [Integer]\n  def gcd(x, y)\n    gcdext(x, y).first\n  end\n\n  # Returns an array of the form `[gcd(x, y), a, b]`, where\n  # `ax + by = gcd(x, y)`.\n  #\n  # @param [Integer] x\n  # @param [Integer] y\n  # @return [Array&lt;Integer&gt;]\n  def gcdext(x, y)\n    if x &lt; 0\n      g, a, b = gcdext(-x, y)\n      return [g, -a, b]\n    end\n    if y &lt; 0\n      g, a, b = gcdext(x, -y)\n      return [g, a, -b]\n    end\n    r0, r1 = x, y\n    a0 = b1 = 1\n    a1 = b0 = 0\n    until r1.zero?\n      q = r0 / r1\n      r0, r1 = r1, r0 - q*r1\n      a0, a1 = a1, a0 - q*a1\n      b0, b1 = b1, b0 - q*b1\n    end\n    [r0, a0, b0]\n  end\n\n  # Returns the inverse of `num` modulo `mod`.\n  #\n  # @param [Integer] num the number\n  # @param [Integer] mod the modulus\n  # @return [Integer]\n  # @raise ZeroDivisionError if the inverse of `base` does not exist\n  def invert(num, mod)\n    g, a, b = gcdext(num, mod)\n    unless g == 1\n      raise ZeroDivisionError.new(\"#{num} has no inverse modulo #{mod}\")\n    end\n    a % mod\n  end\n\n  # Returns `base` raised to `exp` modulo `mod`.\n  #\n  # @param [Integer] base the base\n  # @param [Integer] exp the exponent\n  # @param [Integer] mod the modulus\n  # @return [Integer]\n  # @raise ZeroDivisionError if the `exp` is negative and the inverse\n  #   of `base` does not exist\n  def powmod(base, exp, mod)\n    if exp &lt; 0\n      base = invert(base, mod)\n      exp = -exp\n    end\n    result = 1\n    multi = base % mod\n    until exp.zero?\n      result = (result * multi) % mod if exp.odd?\n      exp &gt;&gt;= 1\n      multi = (multi * multi) % mod\n    end\n    result\n  end\n\nend\n</code></pre>\n\n<p>I did not check the logic but tried several inputs and got expected output</p>\n"}, {"tags": [], "owner": {"reputation": 9663, "user_id": 5239030, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/76JEw.png?s=128&g=1", "display_name": "iGian", "link": "https://stackoverflow.com/users/5239030/igian"}, "is_accepted": true, "score": 1, "last_activity_date": 1536747296, "creation_date": 1536747296, "answer_id": 52292770, "question_id": 52289766, "link": "https://stackoverflow.com/questions/52289766/find-inverse-mod-in-ruby/52292770#52292770", "title": "Find inverse mod in ruby", "body": "<p>Brute force for small numbers:</p>\n\n<pre><code>def inv_mod(num, mod)\n  res = nil\n  (0..mod).each do |step|\n    k = (step * mod) + 1\n    return k / num if k % num == 0\n   end\n  res\nend\n\ninv_mod(7, 31) # =&gt; 9\n</code></pre>\n\n<p>There should be a faster algorithm over there.</p>\n"}, {"tags": [], "owner": {"reputation": 333, "user_id": 8410844, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a22f7cefc10d1200ae2fb0e48fe448d6?s=128&d=identicon&r=PG&f=1", "display_name": "MOPO3OB", "link": "https://stackoverflow.com/users/8410844/mopo3ob"}, "is_accepted": false, "score": 0, "last_activity_date": 1584370865, "creation_date": 1584370865, "answer_id": 60708316, "question_id": 52289766, "link": "https://stackoverflow.com/questions/52289766/find-inverse-mod-in-ruby/60708316#60708316", "title": "Find inverse mod in ruby", "body": "<p>Here is my implementation of algorithm from <a href=\"https://www.geeksforgeeks.org/multiplicative-inverse-under-modulo-m/\" rel=\"nofollow noreferrer\">here</a>.</p>\n\n<pre><code>def modInverse(a, m)\n    (1..m).each{|x| break x if (a*x % m == 1)}\nend\n</code></pre>\n"}], "owner": {"reputation": 121, "user_id": 9716002, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Alloysius Goh", "link": "https://stackoverflow.com/users/9716002/alloysius-goh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 471, "favorite_count": 0, "accepted_answer_id": 52292770, "answer_count": 3, "score": 1, "last_activity_date": 1584370865, "creation_date": 1536737517, "last_edit_date": 1536739630, "question_id": 52289766, "link": "https://stackoverflow.com/questions/52289766/find-inverse-mod-in-ruby", "title": "Find inverse mod in ruby", "body": "<p>Is there a function or method to find the inverse mod of say x and y in ruby?</p>\n\n<p>Something like <code>inverse(x,y)</code> in the crypto library from python. I'm trying to use it to find d for a rsa implementation. </p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 1831, "user_id": 4160532, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Ey34JagqMzQ/AAAAAAAAAAI/AAAAAAAAABo/G70W8D2LXM4/photo.jpg?sz=128", "display_name": "Kedarnag Mukanahallipatna", "link": "https://stackoverflow.com/users/4160532/kedarnag-mukanahallipatna"}, "edited": false, "score": 0, "creation_date": 1536737897, "post_id": 52289762, "comment_id": 91527517, "body": "Is this an actual code in one of your application or are you just asking us to help in refactoring ? The reason I&#39;m asking is, there seems to be a redundant lines."}, {"owner": {"reputation": 1735, "user_id": 4903843, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/9o6SR.jpg?s=128&g=1", "display_name": "Nilay Singh", "link": "https://stackoverflow.com/users/4903843/nilay-singh"}, "edited": false, "score": 0, "creation_date": 1536738327, "post_id": 52289762, "comment_id": 91527785, "body": "This is actual code I am using."}, {"owner": {"reputation": 1735, "user_id": 4903843, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/9o6SR.jpg?s=128&g=1", "display_name": "Nilay Singh", "link": "https://stackoverflow.com/users/4903843/nilay-singh"}, "reply_to_user": {"reputation": 706, "user_id": 6492146, "user_type": "registered", "accept_rate": 82, "profile_image": "https://graph.facebook.com/10157001409455137/picture?type=large", "display_name": "Verty00", "link": "https://stackoverflow.com/users/6492146/verty00"}, "edited": false, "score": 0, "creation_date": 1536738519, "post_id": 52289762, "comment_id": 91527872, "body": "@Verty00 you can put anything in the variables."}, {"owner": {"reputation": 706, "user_id": 6492146, "user_type": "registered", "accept_rate": 82, "profile_image": "https://graph.facebook.com/10157001409455137/picture?type=large", "display_name": "Verty00", "link": "https://stackoverflow.com/users/6492146/verty00"}, "edited": false, "score": 0, "creation_date": 1536739560, "post_id": 52289762, "comment_id": 91528470, "body": "I understand that. I need to see where you call this. And how you get the values. For instance are you loading params into this method in the conroller?"}, {"owner": {"reputation": 1735, "user_id": 4903843, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/9o6SR.jpg?s=128&g=1", "display_name": "Nilay Singh", "link": "https://stackoverflow.com/users/4903843/nilay-singh"}, "edited": false, "score": 0, "creation_date": 1536739936, "post_id": 52289762, "comment_id": 91528687, "body": "I am getting params and passing it to search function in model. I am using module and I am extending it into my model."}], "answers": [{"comments": [{"owner": {"reputation": 394580, "user_id": 479863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ArUCE.jpg?s=128&g=1", "display_name": "mu is too short", "link": "https://stackoverflow.com/users/479863/mu-is-too-short"}, "edited": false, "score": 1, "creation_date": 1536739324, "post_id": 52289977, "comment_id": 91528325, "body": "Or observe that <code>Sector = ? or Sector = ?</code> in SQL is equivalent to <code>Sector in (?, ?)</code> and that <code>where(Sector: some_array)</code> becomes <code>&quot;Sector&quot; in (...)</code>. So you can replace some guard conditions with assignments to a <code>sectors</code> variable (which may be an array of sectors or just a single sector) and say <code>where(Sector: sectors)</code>. This also takes care of possible case sensitivity issues with the <code>Sector</code> column name."}, {"owner": {"reputation": 1556, "user_id": 2830852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/31ea598b6bc18b59de1e77a4c6f6c3e5?s=128&d=identicon&r=PG", "display_name": "Tarek N. Elsamni", "link": "https://stackoverflow.com/users/2830852/tarek-n-elsamni"}, "reply_to_user": {"reputation": 394580, "user_id": 479863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ArUCE.jpg?s=128&g=1", "display_name": "mu is too short", "link": "https://stackoverflow.com/users/479863/mu-is-too-short"}, "edited": false, "score": 0, "creation_date": 1536739606, "post_id": 52289977, "comment_id": 91528497, "body": "That&#39;s true :) I did not pay that much attention to the code logic. I only thought about the most known general practices to simplify nested conditions logic. Good catch \ud83d\udc4d"}, {"owner": {"reputation": 706, "user_id": 6492146, "user_type": "registered", "accept_rate": 82, "profile_image": "https://graph.facebook.com/10157001409455137/picture?type=large", "display_name": "Verty00", "link": "https://stackoverflow.com/users/6492146/verty00"}, "edited": false, "score": 0, "creation_date": 1536739609, "post_id": 52289977, "comment_id": 91528498, "body": "This is a bad &quot;answer&quot; to me because it is just more of the same. See my answer below for a truly &quot;Ruby/Rails&quot; way of solving this."}, {"owner": {"reputation": 1556, "user_id": 2830852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/31ea598b6bc18b59de1e77a4c6f6c3e5?s=128&d=identicon&r=PG", "display_name": "Tarek N. Elsamni", "link": "https://stackoverflow.com/users/2830852/tarek-n-elsamni"}, "edited": false, "score": 1, "creation_date": 1536739756, "post_id": 52289977, "comment_id": 91528585, "body": "I like your answer to guide the OP on better practices for Ruby/Rails :) but I read the question as: &quot;How to simplify big conditions?&quot; and that was my answer for this specific question not paying attention to code logic and rails things! I tried to make my answer as generic as possible to help the OP and anyone else who will visit this question in the future searching for &quot;How to simplify big conditions&quot; .."}, {"owner": {"reputation": 1556, "user_id": 2830852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/31ea598b6bc18b59de1e77a4c6f6c3e5?s=128&d=identicon&r=PG", "display_name": "Tarek N. Elsamni", "link": "https://stackoverflow.com/users/2830852/tarek-n-elsamni"}, "reply_to_user": {"reputation": 394580, "user_id": 479863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ArUCE.jpg?s=128&g=1", "display_name": "mu is too short", "link": "https://stackoverflow.com/users/479863/mu-is-too-short"}, "edited": false, "score": 0, "creation_date": 1536739874, "post_id": 52289977, "comment_id": 91528654, "body": "@muistooshort could you please edit my answer with your observation? I&#39;ll accept your edit after reviewing it. Thanks in advance."}, {"owner": {"reputation": 706, "user_id": 6492146, "user_type": "registered", "accept_rate": 82, "profile_image": "https://graph.facebook.com/10157001409455137/picture?type=large", "display_name": "Verty00", "link": "https://stackoverflow.com/users/6492146/verty00"}, "edited": false, "score": 0, "creation_date": 1536740675, "post_id": 52289977, "comment_id": 91529115, "body": "@TarekN.Elsamni See my answer below on using scopes. This answer here does not do anything to simplify your code. Its must refactoring into slightly less conditionals. If you see my answer I show you how to refactor the code the &quot;Rails Way&quot; to get rid of ALL conditionals."}, {"owner": {"reputation": 1556, "user_id": 2830852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/31ea598b6bc18b59de1e77a4c6f6c3e5?s=128&d=identicon&r=PG", "display_name": "Tarek N. Elsamni", "link": "https://stackoverflow.com/users/2830852/tarek-n-elsamni"}, "edited": false, "score": 1, "creation_date": 1536741040, "post_id": 52289977, "comment_id": 91529334, "body": "I like it :) I&#39;d personally do that the same as you did in my rails project. but I had different POV when I looked into it. I focused more on killing conditions in general and did not think at all about Ruby/Rails. Your answer is more elegant but I wanted to provide a stack/technology agnostic answer :)"}], "tags": [], "owner": {"reputation": 1556, "user_id": 2830852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/31ea598b6bc18b59de1e77a4c6f6c3e5?s=128&d=identicon&r=PG", "display_name": "Tarek N. Elsamni", "link": "https://stackoverflow.com/users/2830852/tarek-n-elsamni"}, "is_accepted": false, "score": 2, "last_activity_date": 1536740108, "last_edit_date": 1536740108, "creation_date": 1536738261, "answer_id": 52289977, "question_id": 52289762, "link": "https://stackoverflow.com/questions/52289762/how-to-simplify-big-conditions/52289977#52289977", "title": "How to simplify big conditions", "body": "<p>You can use a guard statement which is basically <code>return something if some_condition?</code>. This only doable in specific scenarios (where one of the condition is executing a single statement:</p>\n\n<p>Bad example:</p>\n\n<pre><code>if condition?\n  do_something\nelse\n  do_something_else\nend\n</code></pre>\n\n<p>This could be written as:</p>\n\n<pre><code>return do_something if condition?\ndo_something_else\n</code></pre>\n\n<p>This will give you less code branching.</p>\n\n<hr>\n\n<p>Also, another recommendation is to call another method with more conditions instead of nesting conditions in one single shot.</p>\n\n<p>Bad example:</p>\n\n<pre><code>if condition?\n  if condition_two?\n    do_something_two\n  else\n    do_something\n  end\nelse\n  do_something_else\nend\n</code></pre>\n\n<p>This could be written as:</p>\n\n<pre><code>if condition?\n  call_another_method \nelse\n  do_something_else\nend\n\ndef call_another_method\n  if condition_two?\n    do_something_two\n  else\n    do_something\n  end\nend\n</code></pre>\n\n<hr>\n\n<p>An example from your code could be:</p>\n\n<pre><code>if rain_fall_type == 'All'\n  all\nelse\n  if year == 'All'\n    if rain_fall_type == \"None\"\n      where('Sector = ? OR Sector = ? OR Sector = ?', \"Primary\", 'Secondary', 'Tertiary').order('id')\n    else\n      # all\n        where(Sector: rain_fall_type).order('id')\n    end\n  else\n    if rain_fall_type == \"All\"\n      order(\"#{year} \")\n\n    elsif rain_fall_type == \"None\"\n      where('Sector = ? OR Sector = ? OR Sector = ?', \"Primary\", 'Secondary', 'Tertiary').order('id')\n      else\n      where(Sector: rain_fall_type).order(\"#{year} \")\n      end\n  end\nend\n</code></pre>\n\n<p>That could be converted to:</p>\n\n<pre><code>return all if rain_fall_type == 'All'\nif year == 'All'\n  return where('Sector = ? OR Sector = ? OR Sector = ?', \"Primary\", 'Secondary', 'Tertiary').order('id') if rain_fall_type == \"None\"\n  where(Sector: rain_fall_type).order('id')\nelse\n  return order(\"#{year} \") if rain_fall_type == \"All\"\n  return where('Sector = ? OR Sector = ? OR Sector = ?', \"Primary\", 'Secondary', 'Tertiary').order('id') if rain_fall_type == \"None\"\n  where(Sector: rain_fall_type).order(\"#{year} \")\nend\n</code></pre>\n\n<p>I hope this could help :)</p>\n\n<p><strong>NOTE:</strong> This is to answer the original question of <code>How to simplify big conditions?</code>. But the original post is not following Rails/Ruby way of doing search and filters and not making a good use of scopes.</p>\n"}, {"comments": [{"owner": {"reputation": 16077, "user_id": 319702, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/Rb5G2.jpg?s=128&g=1", "display_name": "sameera207", "link": "https://stackoverflow.com/users/319702/sameera207"}, "edited": false, "score": 1, "creation_date": 1536789389, "post_id": 52290188, "comment_id": 91555634, "body": "moving the selections to <code>scopes</code> like in this answer is the way to go \ud83d\udc4d"}], "tags": [], "owner": {"reputation": 706, "user_id": 6492146, "user_type": "registered", "accept_rate": 82, "profile_image": "https://graph.facebook.com/10157001409455137/picture?type=large", "display_name": "Verty00", "link": "https://stackoverflow.com/users/6492146/verty00"}, "is_accepted": false, "score": 2, "last_activity_date": 1536744593, "last_edit_date": 1536744593, "creation_date": 1536738956, "answer_id": 52290188, "question_id": 52289762, "link": "https://stackoverflow.com/questions/52289762/how-to-simplify-big-conditions/52290188#52290188", "title": "How to simplify big conditions", "body": "<p>This is probably the best explanation of how you should set this up.</p>\n\n<pre><code>class Product &lt; ActiveRecord::Base\n  # custom_scope_1\n  scope :status, -&gt; (status) { where status: status }\n  # custom_scope_2\n  scope :location, -&gt; (location_id) { where location_id: location_id }\n  # custom_scope_3\n  scope :search, -&gt; (name) { where(\"name like ?\", \"#{name}%\")}\nend\n\ndef index\n   @products = Product.where(nil) # creates an anonymous scope\n   @products = @products.status(params[:status]) if params[:status].present?\n   @products = @products.location(params[:location]) if params[:location].present?\n   @products = @products.search(params[:search]) if params[:search].present?\nend\n</code></pre>\n\n<p>This can be cleaned up further by...</p>\n\n<pre><code>def index\n  @products = Product.where(nil)\n  filtering_params(params).each do |key, value|\n    @products = @products.public_send(key, value) if value.present?\n  end\nend\n\nprivate\n\n# A list of the param names that can be used for filtering the Products\ndef filtering_params(params)\n  params.slice(:status, :location, :search)\nend\n</code></pre>\n\n<p>This method uses ruby meta-programming to loop through parameters and dynamically call predefined <a href=\"https://guides.rubyonrails.org/active_record_querying.html#scopes\" rel=\"nofollow noreferrer\">scopes</a> on a model </p>\n\n<p>You can move this code into a module and include it into any model that supports filtering</p>\n\n<p><code>app/models/concerns/filterable.rb</code></p>\n\n<pre><code>module Filterable\n  extend ActiveSupport::Concern\n\n  module ClassMethods\n    def filter(filtering_params)\n      results = self.where(nil)\n      filtering_params.each do |key, value|\n        results = results.public_send(key, value) if value.present?\n      end\n      results\n    end\n  end\nend\n</code></pre>\n\n<p><code>app/models/product.rb</code></p>\n\n<pre><code>class Product\n  include Filterable\n  ...\nend\n</code></pre>\n\n<p><code>app/controllers/product_controller.rb</code></p>\n\n<pre><code>def index\n  @products = Product.filter(params.slice(:status, :location, :search))\nend\n</code></pre>\n\n<p>You now have filtering and searching of your models with one line in the controller and one line in the model</p>\n"}, {"comments": [{"owner": {"reputation": 1735, "user_id": 4903843, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/9o6SR.jpg?s=128&g=1", "display_name": "Nilay Singh", "link": "https://stackoverflow.com/users/4903843/nilay-singh"}, "edited": false, "score": 0, "creation_date": 1536780831, "post_id": 52301765, "comment_id": 91552331, "body": "Thanks for answering the perfect answer, If you can explain that would be great and where I was doing wrong."}, {"owner": {"reputation": 1735, "user_id": 4903843, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/9o6SR.jpg?s=128&g=1", "display_name": "Nilay Singh", "link": "https://stackoverflow.com/users/4903843/nilay-singh"}, "edited": false, "score": 0, "creation_date": 1536781389, "post_id": 52301765, "comment_id": 91552607, "body": "Some of the logic is working but compare!= &quot;none&quot; not working."}, {"owner": {"reputation": 18856, "user_id": 1359650, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/dffc4318ac93e728a26c8e8b51b4eb37?s=128&d=identicon&r=PG", "display_name": "jvillian", "link": "https://stackoverflow.com/users/1359650/jvillian"}, "reply_to_user": {"reputation": 1735, "user_id": 4903843, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/9o6SR.jpg?s=128&g=1", "display_name": "Nilay Singh", "link": "https://stackoverflow.com/users/4903843/nilay-singh"}, "edited": false, "score": 0, "creation_date": 1536781506, "post_id": 52301765, "comment_id": 91552663, "body": "Hang on. Found a bug and fixing it. I&#39;ll look at that, too."}, {"owner": {"reputation": 18856, "user_id": 1359650, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/dffc4318ac93e728a26c8e8b51b4eb37?s=128&d=identicon&r=PG", "display_name": "jvillian", "link": "https://stackoverflow.com/users/1359650/jvillian"}, "reply_to_user": {"reputation": 1735, "user_id": 4903843, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/9o6SR.jpg?s=128&g=1", "display_name": "Nilay Singh", "link": "https://stackoverflow.com/users/4903843/nilay-singh"}, "edited": false, "score": 0, "creation_date": 1536784482, "post_id": 52301765, "comment_id": 91553833, "body": "I think that fixed it and my RSPEC tests seem to be passing."}], "tags": [], "owner": {"reputation": 18856, "user_id": 1359650, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/dffc4318ac93e728a26c8e8b51b4eb37?s=128&d=identicon&r=PG", "display_name": "jvillian", "link": "https://stackoverflow.com/users/1359650/jvillian"}, "is_accepted": true, "score": 1, "last_activity_date": 1536784105, "last_edit_date": 1536784105, "creation_date": 1536778733, "answer_id": 52301765, "question_id": 52289762, "link": "https://stackoverflow.com/questions/52289762/how-to-simplify-big-conditions/52301765#52301765", "title": "How to simplify big conditions", "body": "<p>First of all, some of your logic doesn't make sense:</p>\n\n<pre><code>def search(search, compare, year, rain_fall_type)\n  if search == 'All'\n    if rain_fall_type == 'All'\n      all\n    else\n      # rain_fall_type != 'All'\n      if year == 'All'\n        if rain_fall_type == \"None\"\n          where('Sector = ? OR Sector = ? OR Sector = ?', \"Primary\", 'Secondary', 'Tertiary').order('id')\n        else\n          where(Sector: rain_fall_type).order('id')\n        end\n      else\n        # in rain_fall_type != 'All' branch, so meaningless 'if'\n        if rain_fall_type == \"All\"\n          order(\"#{year} \")\n        elsif rain_fall_type == \"None\"\n          where('Sector = ? OR Sector = ? OR Sector = ?', \"Primary\", 'Secondary', 'Tertiary').order('id')\n        else\n          where(Sector: rain_fall_type).order(\"#{year} \")\n        end\n      end\n    end\n  elsif compare != \"None\"\n    # both are same, so meaningless 'if'\n    if year == 'All'\n      where('Sector = ? OR Sector = ?', rain_fall_type, compare).order(:id)\n    else\n      where('Sector = ? OR Sector = ?', rain_fall_type, compare).order(:id)\n    end\n  else\n    # search != 'All'\n    if rain_fall_type == 'All'\n      all.order('id')\n    else\n      if year == 'All'\n        if rain_fall_type == \"None\"\n          where('Sector = ? ', search).order('id')\n        else\n          where('Sector = ? ', rain_fall_type).order('id')\n        end\n      else\n        if rain_fall_type == \"None\"\n          # in search != 'All' branch, so meaningless 'if'\n          # AND both are same, so again meaningless 'if'\n          if search == \"All\"\n            where('Sector = ? ', search).order('id')\n          else\n            where('Sector = ? ', search).order('id')\n          end\n        else\n          where('Sector = ? ', rain_fall_type).order('id')\n        end\n      end\n    end\n  end\nend\n</code></pre>\n\n<p>There's more like that and I won't point it all out because we're throwing all that <code>if</code> stuff out, anyway.</p>\n\n<p>Ultimately, we're going to defer the querying to the end of the method, like this: </p>\n\n<pre><code>def search(search, compare, year, rain_fall_type)\n\n  ...\n\n  @query = all \n  @query = @query.where(Sector: @sectors) if @sectors\n  @query = @query.order(@order) if @order\n  @query\n\nend\n</code></pre>\n\n<p>That way, you take <em>all</em> of your <code>where</code> and <code>order</code> statements, and do them only once at the end. That saves a lot of typing right there. See the comment from muistooshort for why <code>(Sector: @sectors)</code> works. </p>\n\n<p>So, the trick is setting <code>@sectors</code> and <code>@order</code>.  First, I'm going to assign the input variables to instance variables because I like it like that (and to avoid confusion between the variable <code>@search</code> and the method <code>search</code>):</p>\n\n<pre><code>def search(search, compare, year, rain_fall_type)\n  @search, @compare, @year, @rain_fall_type = search, compare, year, rain_fall_type\n\n  ...\n\n  @query = all \n  @query = @query.where(Sector: @sectors) if @sectors\n  @query = @query.order(@order) if @order\n  @query\nend\n</code></pre>\n\n<p>Now, this answer is going on too long already, so I won't drag you through all the gorey details. But, adding in a couple of helper methods (<code>sectors_to_use</code>, and <code>order_to_use</code>) and substituting them in for <code>@sectors</code> and <code>@order</code>, you basically end up with this:</p>\n\n<pre><code>def search(search, compare, year, rain_fall_type)\n  @search, @compare, @year, @rain_fall_type = search, compare, year, rain_fall_type\n  @query = all \n  @query = @query.where(Sector: sectors_to_use) if sectors_to_use\n  @query = @query.order(order_to_use) if order_to_use\n  @query\nend\n\nprivate \n\ndef sectors_to_use\n  return [@rain_fall_type, @compare] if @search != 'All' &amp;&amp; @compare != 'None'\n  unless @rain_fall_type == 'All'\n    if @rain_fall_type == 'None'\n      @search == 'All' ? ['Primary', 'Secondary', 'Tertiary'] : [@search]\n    else\n      [@rain_fall_type]\n    end  \n  end\nend\n\ndef order_to_use\n  return nil if (@search == 'All') &amp;&amp; (@rain_fall_type == 'All')\n  return @year if (@search == 'All') &amp;&amp; !(@year == 'All')\n  return :id\nend\n</code></pre>\n\n<p>That's less than half the lines of code, over a thousand fewer characters, and a whole lot fewer <code>ifs</code>.</p>\n"}], "owner": {"reputation": 1735, "user_id": 4903843, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/9o6SR.jpg?s=128&g=1", "display_name": "Nilay Singh", "link": "https://stackoverflow.com/users/4903843/nilay-singh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 122, "favorite_count": 0, "accepted_answer_id": 52301765, "answer_count": 3, "score": 1, "last_activity_date": 1536784105, "creation_date": 1536737508, "last_edit_date": 1536738818, "question_id": 52289762, "link": "https://stackoverflow.com/questions/52289762/how-to-simplify-big-conditions", "title": "How to simplify big conditions", "body": "<p>I have five dropdowns, and I need to put conditions on each of them. My code is:</p>\n\n<pre><code>   def search(search, compare, year, rain_fall_type)\n    if search == 'All'\n      if rain_fall_type == 'All'\n        all\n      else\n        if year == 'All'\n          if rain_fall_type == \"None\"\n            where('Sector = ? OR Sector = ? OR Sector = ?', \"Primary\", 'Secondary', 'Tertiary').order('id')\n          else\n            # all\n             where(Sector: rain_fall_type).order('id')\n          end\n        else\n          if rain_fall_type == \"All\"\n            order(\"#{year} \")\n\n          elsif rain_fall_type == \"None\"\n            where('Sector = ? OR Sector = ? OR Sector = ?', \"Primary\", 'Secondary', 'Tertiary').order('id')\n           else\n            where(Sector: rain_fall_type).order(\"#{year} \")\n           end\n        end\n        # where(Year: year).order(\"#{rain_fall_type} \")\n      end\n    elsif compare != \"None\"\n      if year == 'All'\n        where('Sector = ? OR Sector = ?', rain_fall_type, compare).order(:id)\n      else\n        where('Sector = ? OR Sector = ?', rain_fall_type, compare).order(:id)\n      end\n    else\n\n      if rain_fall_type == 'All'\n        all.order('id')\n      else\n        if year == 'All'\n\n          if rain_fall_type == \"None\"\n            where('Sector = ? ', search).order('id')\n          else\n\n            where('Sector = ? ', rain_fall_type).order('id')\n          end\n        else\n\n          if rain_fall_type == \"None\"\n\n            if search == \"All\"\n              where('Sector = ? ', search).order('id')\n            else\n              where('Sector = ? ', search).order('id')\n            end\n          else\n            # all\n            where('Sector = ? ', rain_fall_type).order('id')\n          end\n        end\n      end\n    end\n  end\n</code></pre>\n\n<p>It has many <code>if</code> and <code>else</code>. I am trying to minimise the conditions. What can be the best way to shrink this code? Someone suggested that I should use <code>switch</code> <code>case</code> instead. Should I use it? If so, how?</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 1, "creation_date": 1536731080, "post_id": 52288175, "comment_id": 91524011, "body": "Show us what have you tried."}, {"owner": {"reputation": 1006, "user_id": 4594902, "user_type": "registered", "accept_rate": 65, "profile_image": "https://graph.facebook.com/686173344826419/picture?type=large", "display_name": "Ilja KO", "link": "https://stackoverflow.com/users/4594902/ilja-ko"}, "reply_to_user": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 1, "creation_date": 1536731190, "post_id": 52288175, "comment_id": 91524046, "body": "nothing :( It&#39;s 8 am, Ive allready worked through the night and I dont know how to do a regex for this. I would start maybe to find the first ascii character and cut the string till the last one but how to detect multiple spaces in between I dont know"}, {"owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 0, "creation_date": 1536733225, "post_id": 52288175, "comment_id": 91524952, "body": "Define &quot;special characters&quot;."}, {"owner": {"reputation": 5449, "user_id": 681520, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/701baebf68d1d7faa9f9def6a24fe356?s=128&d=identicon&r=PG", "display_name": "Kimmo Lehto", "link": "https://stackoverflow.com/users/681520/kimmo-lehto"}, "edited": false, "score": 1, "creation_date": 1536733472, "post_id": 52288175, "comment_id": 91525075, "body": "so it should remove the word &quot;very&quot;?"}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 2, "creation_date": 1536734453, "post_id": 52288175, "comment_id": 91525592, "body": "<i>&quot;It&#39;s 8 am, Ive allready worked through the night&quot;</i> \u2013 better get some sleep."}], "answers": [{"comments": [{"owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 0, "creation_date": 1536733492, "post_id": 52288327, "comment_id": 91525086, "body": "Why are you not using <code>squeeze</code>?"}, {"owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 0, "creation_date": 1536733558, "post_id": 52288327, "comment_id": 91525122, "body": "Why are you passing a block via proc?"}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "reply_to_user": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 0, "creation_date": 1536733853, "post_id": 52288327, "comment_id": 91525289, "body": "1. For the sake of being regex-agnostic as requested. 2. For no reason, updated, thanks."}], "tags": [], "owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "is_accepted": false, "score": 2, "last_activity_date": 1536733868, "last_edit_date": 1536733868, "creation_date": 1536731738, "answer_id": 52288327, "question_id": 52288175, "link": "https://stackoverflow.com/questions/52288175/how-to-remove-special-characters-and-multiple-spaces-from-a-string/52288327#52288327", "title": "How to remove special characters and multiple spaces from a string", "body": "<p>Do it step by step:</p>\n\n<pre><code>str.\n  gsub(/\\A\\W+/, ''). # remove garbage from the very beginning\n  gsub(/\\W*\\z/) { |m| m[/\\A\\p{Punct}*/] }. # leave trailing punctuation\n  gsub(/\\s{2,}/, ' ') # squeeze\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 5449, "user_id": 681520, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/701baebf68d1d7faa9f9def6a24fe356?s=128&d=identicon&r=PG", "display_name": "Kimmo Lehto", "link": "https://stackoverflow.com/users/681520/kimmo-lehto"}, "is_accepted": false, "score": 1, "last_activity_date": 1536734575, "last_edit_date": 1536734575, "creation_date": 1536733319, "answer_id": 52288675, "question_id": 52288175, "link": "https://stackoverflow.com/questions/52288175/how-to-remove-special-characters-and-multiple-spaces-from-a-string/52288675#52288675", "title": "How to remove special characters and multiple spaces from a string", "body": "<p>This will regex will:</p>\n\n<ol>\n<li>Question and exclamantion marks that are not preceded by a \"normal\" character or a question or exclamation mark.</li>\n<li>Whitespaces that are not preceded by a \"normal\" character</li>\n<li>All non-\"normal\" characters</li>\n<li>The word \"very\"</li>\n</ol>\n\n<p>(I assume \"normal\" characters in this case are <code>0..9</code>, <code>a..z</code> and <code>A..Z</code>).</p>\n\n<pre><code>str = '\"      !:;:\u00a7\"   this string is     very normal!?   \"\u00a7$\"\u00a7\"$\"\u00a7$    $\"$\u00a7\"      \"'\n\nstr.gsub(/\n  (?:\\bvery\\s+) |\n  (?:(?&lt;![A-Za-z\\d!?])[!?]) |\n  (?:(?&lt;![A-Za-z\\d])\\s) |\n  [^A-Za-z\\s\\d!?]\n/x, '')\n\n=&gt; \"this string is normal!?\"\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "is_accepted": false, "score": 2, "last_activity_date": 1536771705, "last_edit_date": 1536771705, "creation_date": 1536734171, "answer_id": 52288859, "question_id": 52288175, "link": "https://stackoverflow.com/questions/52288175/how-to-remove-special-characters-and-multiple-spaces-from-a-string/52288859#52288859", "title": "How to remove special characters and multiple spaces from a string", "body": "<pre><code>R = /\n    (?:           # begin a non-capture group\n      \\p{Alnum}+  # match one or more alphanumeric characters\n      [ ]+        # match one or more spaces\n    )*            # end non-capture group and execute zero or more times\n    \\p{Alnum}+    # match one or more alphanumeric characters\n    [!?]*         # match zero or more characters '!' and '?'\n    /x            # free-spacing regex definition mode\n\ndef extract(str)\n  str[R].squeeze(' ')\nend\n\narr = [\n  '      !:;:\u00a7\"   this  string is normal?   \"\u00a7$\"\u00a7\"$\"\u00a7$    $\"$\u00a7\"      ',\n  '      !:;:\u00a7\"   this string    is very normal!   \"\u00a7$\"\u00a7\"$\"\u00a7$    $\"$\u00a7\"      ',\n  '      !:;:\u00a7\"   this string is     very normal!?   \"\u00a7$\"\u00a7\"$\"\u00a7$    $\"$\u00a7\"      ',\n  '      !:;:\u00a7\"   cette  cha\u00eene  est normale?   \"\u00a7$\"\u00a7\"$\"\u00a7$    $\"$\u00a7\"    '\n]\narr.each { |s| puts extract(s) }\n</code></pre>\n\n<p>prints</p>\n\n<pre><code>this string is normal?\nthis string is very normal!\nthis string is very normal!?\ncette cha\u00eene est normale?\n</code></pre>\n\n<p>See the doc for <code>\\p{Alnum}</code> in <a href=\"http://ruby-doc.org/core-2.5.1/Regexp.html\" rel=\"nofollow noreferrer\">Regexp</a> (search for \"\\p{} construct\"). </p>\n\n<p>I wrote the regular expression in free-spacing mode in order to document each step. It would conventionally be written as follows.</p>\n\n<pre><code>/(?:\\p{Alnum}+ +)*\\p{Alnum}+[!?]*/\n</code></pre>\n\n<p>Notice that in free-spacing mode I put a space in a character class. Had I not done so the space would have been removed before the regular expression was evaluated.</p>\n\n<p>If non-alphanumeric characters, other than spaces, are permitted in the interior of the string, change the regular expression to the following.</p>\n\n<pre><code>def extract(str)\n  str.gsub(R,'')\nend\n\nR = /\n    \\A              # match the beginning of the string\n    [^\\p{Alnum}]+   # match one non-alphanumeric characters\n    |               # or\n    [^\\p{Alnum}!?]  # match a character other than a alphanumeric, '!' and '?'\n    [^\\p{Alnum}]+   # match one non-alphanumeric characters\n    \\z              # match the end of the string\n    |               # or\n    [ ]             # match a space...\n    (?=[ ])         # ...followed by a space\n    /x              # free-spacing regex definition mode\n\nextract '  !:;:\u00a7\"   this  string $$ is abnormal?   \"\u00a7$\"  $\"$\u00a7\"  '\n</code></pre>\n\n<p>prints</p>\n\n<pre><code>\"this string $$ is abnormal?\"\n</code></pre>\n"}], "owner": {"reputation": 1006, "user_id": 4594902, "user_type": "registered", "accept_rate": 65, "profile_image": "https://graph.facebook.com/686173344826419/picture?type=large", "display_name": "Ilja KO", "link": "https://stackoverflow.com/users/4594902/ilja-ko"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 68, "favorite_count": 1, "closed_date": 1536740026, "answer_count": 3, "score": -3, "last_activity_date": 1536771705, "creation_date": 1536730951, "last_edit_date": 1536733212, "question_id": 52288175, "link": "https://stackoverflow.com/questions/52288175/how-to-remove-special-characters-and-multiple-spaces-from-a-string", "closed_reason": "Needs details or clarity", "title": "How to remove special characters and multiple spaces from a string", "body": "<p>I want to remove all special characters (including spaces) from a string's beginning and end and replace consecutive spaces with one. For example,</p>\n\n<pre><code>\"      !:;:\u00a7\"   this string is normal.   \"\u00a7$\"\u00a7\"$\"\u00a7$    $\"$\u00a7\"     \"\n</code></pre>\n\n<p>should become:</p>\n\n<pre><code>\"this string is normal\"\n</code></pre>\n\n<p>I want to allow <code>!</code> and <code>?</code> at the end of the string.</p>\n\n<pre><code>\"      !:;:\u00a7\"   this  string is normal?   \"\u00a7$\"\u00a7\"$\"\u00a7$    $\"$\u00a7\"      \"\n\"      !:;:\u00a7\"   this string    is very normal!   \"\u00a7$\"\u00a7\"$\"\u00a7$    $\"$\u00a7\"      \"\n\"      !:;:\u00a7\"   this string is     very normal!?   \"\u00a7$\"\u00a7\"$\"\u00a7$    $\"$\u00a7\"      \"\n</code></pre>\n\n<p>should become:</p>\n\n<pre><code>\"this string is normal?\"\n\"this string is normal!\"\n\"this string is normal!?\"\n</code></pre>\n\n<p>This is all for getting nice titles in an app.</p>\n\n<p>Can someone help me please? Or does anyone know a good regex command for nice titles?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-5"], "comments": [{"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 1, "creation_date": 1536729319, "post_id": 52287819, "comment_id": 91523452, "body": "<i>Sidenote:</i> you are abusing <code>each</code> for actual <i>mapping</i>. It should be (instead of the whole <code>stat.each</code>): <code>stat.map { |f| (f.sum_points.to_f &#47; f.matches_count.to_f).round(2) }</code>."}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1536729439, "post_id": 52287819, "comment_id": 91523493, "body": "Yes, this is possible, do the math, <code>ORDER BY</code> and <code>LIMIT 10</code> in the database."}, {"owner": {"reputation": 117, "user_id": 10068674, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-8gRv54FhhWE/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7oH6R244hnLFuogLjfnpdDcQc_9-w/mo/photo.jpg?sz=128", "display_name": "some thing", "link": "https://stackoverflow.com/users/10068674/some-thing"}, "reply_to_user": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1536730887, "post_id": 52287819, "comment_id": 91523936, "body": "I already get this limit using this code <code>new_stat = a.sort_by(&amp;:sum_points).reverse.first(10).flatten</code> I replaced my code with your code <code>.map</code>. Thank you."}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 1, "creation_date": 1536730996, "post_id": 52287819, "comment_id": 91523977, "body": "<code>a.sort_by.reverse</code> does the sorting and reversing in ruby, which is extremely inefficient. That all should be done in the DB enforcing only 10 necessary rows to be returned from the DB to Rails."}], "answers": [{"comments": [{"owner": {"reputation": 117, "user_id": 10068674, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-8gRv54FhhWE/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7oH6R244hnLFuogLjfnpdDcQc_9-w/mo/photo.jpg?sz=128", "display_name": "some thing", "link": "https://stackoverflow.com/users/10068674/some-thing"}, "edited": false, "score": 0, "creation_date": 1536753192, "post_id": 52290515, "comment_id": 91536591, "body": "I&#39;m getting the correct points but I&#39;ve got another problem <code>count(*)</code> gives the number of record. So if there is 53 records I get /53 what i need is by match_id which is number of games played."}, {"owner": {"reputation": 81, "user_id": 5233652, "user_type": "registered", "profile_image": "https://graph.facebook.com/1180065645343273/picture?type=large", "display_name": "Ovidiu Toma", "link": "https://stackoverflow.com/users/5233652/ovidiu-toma"}, "reply_to_user": {"reputation": 117, "user_id": 10068674, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-8gRv54FhhWE/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7oH6R244hnLFuogLjfnpdDcQc_9-w/mo/photo.jpg?sz=128", "display_name": "some thing", "link": "https://stackoverflow.com/users/10068674/some-thing"}, "edited": false, "score": 0, "creation_date": 1536762010, "post_id": 52290515, "comment_id": 91542631, "body": "In our case the count is computed based on the group, that being said, within that select <code>count(*)</code> returns the number of records within that group(as in: the number of stats of an user), it doesn&#39;t return the number of all of the Stats in the database. If you want the number of matches within that group, use <code>count(match_id)</code> instead of <code>count(*)</code>, if you want the distinct matches use <code>COUNT(DISTINCT match_id)</code>."}], "tags": [], "owner": {"reputation": 81, "user_id": 5233652, "user_type": "registered", "profile_image": "https://graph.facebook.com/1180065645343273/picture?type=large", "display_name": "Ovidiu Toma", "link": "https://stackoverflow.com/users/5233652/ovidiu-toma"}, "is_accepted": true, "score": 1, "last_activity_date": 1536740064, "creation_date": 1536740064, "answer_id": 52290515, "question_id": 52287819, "link": "https://stackoverflow.com/questions/52287819/working-with-my-leaderboard-possible-to-minimize-workload/52290515#52290515", "title": "Working with my leaderboard. Possible to minimize workload", "body": "<p>The most efficient way would be to compute the data using the sql and only retrieve the top 10. </p>\n\n<p>Basically, right now you're manually parsing the whole active record array to compute the sum_points and then you're sorting and reversing all of the data to retrieve the top 10. Like you've said, the performance will suffer when large amount of data will be in the database.</p>\n\n<p>Here's my solution that will compute and retrieve the top 10 using only sql queries:</p>\n\n<pre><code>stat = Stat.group(:user_id)\n.select(\"user_id, round((sum(points) /count(*)), 2) as sum_points\")\n.where.not(points: 0).where.not(match_id: nil).order(\"sum_points DESC\").first(10)\n</code></pre>\n"}], "owner": {"reputation": 117, "user_id": 10068674, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-8gRv54FhhWE/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7oH6R244hnLFuogLjfnpdDcQc_9-w/mo/photo.jpg?sz=128", "display_name": "some thing", "link": "https://stackoverflow.com/users/10068674/some-thing"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 62, "favorite_count": 0, "accepted_answer_id": 52290515, "answer_count": 1, "score": 2, "last_activity_date": 1536740064, "creation_date": 1536728896, "question_id": 52287819, "link": "https://stackoverflow.com/questions/52287819/working-with-my-leaderboard-possible-to-minimize-workload", "title": "Working with my leaderboard. Possible to minimize workload", "body": "<p>I've got stat model : </p>\n\n<pre><code>Stat(id: integer, points: float, user_id: integer, match_id: integer, team_id: integer)\n</code></pre>\n\n<p>For match model: </p>\n\n<pre><code> Match(id: integer, team_a_id: integer, team_b_id: integer)\n</code></pre>\n\n<p>Here's my code now:</p>\n\n<pre><code>stat= Stat\n.group(:user_id)\n.select(\"user_id, count(*) as matches_count, sum(points) as score\")\n.where.not(points: 0)\n.where.not(match_id: nil)\n\nstat.each do |f|\n  new_value = (f.sum_points.to_f / f.matches_count.to_f)\n  f.sum_points = new_value.round(2)\n  a &lt;&lt; f\nend\n\nnew_stat = a.sort_by(&amp;:sum_points).reverse.first(10).flatten\n</code></pre>\n\n<p>I have to change the value of <code>sum_points</code> on each data what if I got a lot of data so it will take time is there a way to minimize it? What I need is the first top 10.</p>\n"}, {"tags": ["html", "ruby", "parsing", "nokogiri"], "answers": [{"comments": [{"owner": {"reputation": 39, "user_id": 10350889, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/21c1f8257f83e149c66188a02adc06b7?s=128&d=identicon&r=PG&f=1", "display_name": "Buklau", "link": "https://stackoverflow.com/users/10350889/buklau"}, "edited": false, "score": 0, "creation_date": 1536854642, "post_id": 52295516, "comment_id": 91582563, "body": "Hi! do you think you could check out the answer that I posted and give me suggestions on how I can improve it/fix the problem I&#39;m having? Thanks!"}], "tags": [], "owner": {"reputation": 47898, "user_id": 966023, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/917fcb4327159076f752c0c3c3fddfbb?s=128&d=identicon&r=PG", "display_name": "pguardiario", "link": "https://stackoverflow.com/users/966023/pguardiario"}, "is_accepted": false, "score": 1, "last_activity_date": 1536756244, "creation_date": 1536756244, "answer_id": 52295516, "question_id": 52287477, "link": "https://stackoverflow.com/questions/52287477/how-to-parse-html-file-headings-with-ruby/52295516#52295516", "title": "How to parse HTML file headings with Ruby", "body": "<p><code>traverse</code> is a good idea. You want to keep track of the latest h1, h2,h3, etc:...</p>\n\n<pre><code>@state = {}\nrecords = []\nnokogiri_object.traverse { |node|\n  next unless desired_headings.include?(node.name)\n  @state[node.name] = node.text\n  case node.name\n    when 'h1'\n      records &lt;&lt; {\n        h1: @state['h1']\n      }\n    when 'h2'\n      records &lt;&lt; {\n        h1: @state['h1'],\n        h2: @state['h2'],\n      }\n\n  end\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 0, "creation_date": 1573969786, "post_id": 52317615, "comment_id": 104060071, "body": "Please don&#39;t add code in answers that &quot;mostly works&quot;. Answers need to be working solutions. Also, don&#39;t prompt for additional commentary or information such as &quot;Any suggestions?&quot; in an answer. Answers are for that purpose only, whereas comments are for commentary and requesting additional information from the person asking."}], "tags": [], "owner": {"reputation": 39, "user_id": 10350889, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/21c1f8257f83e149c66188a02adc06b7?s=128&d=identicon&r=PG&f=1", "display_name": "Buklau", "link": "https://stackoverflow.com/users/10350889/buklau"}, "is_accepted": false, "score": -1, "last_activity_date": 1536854569, "creation_date": 1536854569, "answer_id": 52317615, "question_id": 52287477, "link": "https://stackoverflow.com/questions/52287477/how-to-parse-html-file-headings-with-ruby/52317615#52317615", "title": "How to parse HTML file headings with Ruby", "body": "<p>So, I came up with a solution that mostly works, except that it isn't storing my \"records\" in my array of records as I want it to. My solution is </p>\n\n<pre><code>require \"rubygems\"\nrequire \"nokogiri\"\nrequire \"json\"   \n\narray_of_records = [] #Store the records in an array\ndesired_headings = ['h1','h2','h3','h4','p'] # headings used to split html into \nrecords\n\nDir.glob('./source/*.html') { |html_file|\n\n  latest_headings = {}; # hash to store latest data from headings\n\n  nokogiri_object = File.open(html_file) { |f| Nokogiri::HTML(f, nil, 'UTF-8') }\n  nokogiri_object.traverse { |node|\n\n    next unless desired_headings.include?(node.name)\n\n    case node.name\n    when (\"h1\"..\"h4\")\n\n      @record = {}\n      latest_headings[node.name] = node.text\n      latest_headings.each { |key,value|\n        @record[key] = value if key &lt;= node.name\n      }\n      link = node.css('a')[0]\n      link = link['id'] if !link.nil?\n      @record['link'] = link if !link.nil?\n    when \"p\"\n      @record['content'] = node.text\n    end\n\n    array_of_records &lt;&lt; @record\n    puts @record\n\n  } #end loop through nodes\n puts array_of_records    \n\n} #end loop through files\n</code></pre>\n\n<p>I would expect that <code>puts @record</code> would print the same thing that <code>puts array_of_records</code> prints, but I find that <code>array_of_records</code> does not contain what <code>puts @record prints</code>. Any suggestions? </p>\n"}], "owner": {"reputation": 39, "user_id": 10350889, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/21c1f8257f83e149c66188a02adc06b7?s=128&d=identicon&r=PG&f=1", "display_name": "Buklau", "link": "https://stackoverflow.com/users/10350889/buklau"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 314, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1573969642, "creation_date": 1536726272, "last_edit_date": 1573969642, "question_id": 52287477, "link": "https://stackoverflow.com/questions/52287477/how-to-parse-html-file-headings-with-ruby", "title": "How to parse HTML file headings with Ruby", "body": "<p>I have an HTML file that I would like to parse in Ruby. The HTML file is very simple and only contains headers, links, and paragraphs. I am using Nokogiri to parse. </p>\n\n<p>An example of an HTML file I am dealing with is:</p>\n\n<pre><code>&lt;h1&gt;&lt;a id=\"Dog_0\"&gt;&lt;/a&gt;Dog&lt;/h1&gt;\n&lt;h2&gt;&lt;a id=\"Washing_dogs_3\"&gt;&lt;/a&gt;Washing Dogs&lt;/h2&gt;\n&lt;h3&gt;Use soap&lt;/h3&gt;\n&lt;h2&gt;&lt;a id=\"Walking_dogs_1\"&gt;&lt;/a&gt;Walking Dogs&lt;/h2&gt;\n</code></pre>\n\n<p>I need to treat <code>h1</code> headings as a parent, <code>h2</code> headings as children of the <code>h1</code> heading it is under, <code>h3</code> headings as children of the <code>h2</code> heading it is under, etc. </p>\n\n<p>I want to store this information in an array of hashes, such that</p>\n\n<pre><code>[ { \n   h1: \"Dog\",\n link: \"Dog_0\",  \n},{\n   h1: \"Dog\",\n   h2: \"Washing Dogs\",\n   link: \"Dog_0#Washing_dogs_3\"\n},{\n   h1: \"Dog\",\n   h2: \"Washing Dogs\",\n   h3: \"Use Soap\",\n   link: \"Dog_0#Washing_dogs_3\"\n},{\n   h1: \"Dog\",\n   h2: \"Walking Dogs\"\n   link: \"Dog_0#Walking_dogs_1\"\n}]\n</code></pre>\n\n<p>Since none of the nodes are nested, I don't think I can use any of the useful methods for finding children. What I have so far is: </p>\n\n<pre><code>array_of_records = []; #Store the records in an array\ndesired_headings = ['h1','h2','h3','h4','p'] # headings used to split html into records\n\nDir.glob('*.html') { |html_file|\n\n\n  nokogiri_object = File.open(html_file) { |f| Nokogiri::HTML(f, nil, 'UTF-8') }\n\n  nokogiri_object.traverse { |node|\n   next unless desired_headings.include?(node.name)\n   record = {}\n   record[node.name.to_sym] = node.text.gsub(/[\\r\\n]/,'').split.join(\" \")\n   link = node.css('a')[0]\n\n   record[:link] = link['id'] if !link.nil?\n\n   array_of_records &lt;&lt; record\n  }\n</code></pre>\n\n<p>This code manages to capture what heading I am parsing and stores its contents in a hash as</p>\n\n<pre><code> {heading: \"content\"} \n</code></pre>\n\n<p>but does not capture the parent-like information I need to capture. </p>\n"}, {"tags": ["ruby", "string", "ip", "ip-address"], "answers": [{"comments": [{"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1536730181, "post_id": 52286767, "comment_id": 91523713, "body": "I forgot to include <code>require &#39;ipaddr&#39;</code>, but the code ran fine without it (using Ruby v2.5.1). I then noticed that <code>ipaddr</code> is a <a href=\"https://stdgems.org/2.5.1/\" rel=\"nofollow noreferrer\">&quot;default gem&quot;</a> in Ruby v2.5.1, but not in v2.4. Does that mean <code>require &#39;ipaddr&#39;</code> is not needed in v2.5.1+?"}], "tags": [], "owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "is_accepted": false, "score": 0, "last_activity_date": 1536722106, "last_edit_date": 1536722106, "creation_date": 1536720442, "answer_id": 52286767, "question_id": 52286423, "link": "https://stackoverflow.com/questions/52286423/get-ipv4-out-of-a-ruby-string-that-contains-both-ipv4-and-ipv6/52286767#52286767", "title": "Get IPv4 out of a Ruby string that contains both IPv4 and IPv6?", "body": "<pre><code>header = \"2600:1740:8540:cff9:1c50:617:c9c5:63f7, 165.154.107.112, 166.155.108.113\"\n\nheader.split(/\\s?,\\s?/).find { |s| IPAddr.new(s).ipv4? }\n  #=&gt; \"165.154.107.112\"\n</code></pre>\n\n<p>or</p>\n\n<pre><code>header.split(/,\\s+/).select { |s| IPAddr.new(s).ipv4? }\n  #=&gt; [\"165.154.107.112\", \"166.155.108.113\"]\n</code></pre>\n\n<p>See <a href=\"https://ruby-doc.org/stdlib-2.5.1/libdoc/ipaddr/rdoc/IPAddr.html#method-c-new\" rel=\"nofollow noreferrer\">IPAddr::new</a> and <a href=\"https://ruby-doc.org/stdlib-2.5.1/libdoc/ipaddr/rdoc/IPAddr.html#method-i-ipv4-3F\" rel=\"nofollow noreferrer\">IPAddr#ipv4?</a>.</p>\n\n<p>If <code>\"header = \"</code> is part of the string <code>str</code>, replace <code>header.split</code> with <code>str[/\\d.+/].split</code>.</p>\n\n<p>If the string may contain text that is not a valid IP address, you could write the following.</p>\n\n<pre><code>header.split(/\\s?,\\s?/).find { |s| (IPAddr.new(s) rescue nil)&amp;.ipv4? }\n</code></pre>\n\n<p><code>IPAddr.new('cat')</code>, for example, raises the exception <code>IPAddr::InvalidAddressError (invalid address)</code>. <code>&amp;</code> is Ruby's <a href=\"http://mitrev.net/ruby/2015/11/13/the-operator-in-ruby/\" rel=\"nofollow noreferrer\">safe navigation operator</a>, which made it's debut in v2.3.</p>\n"}, {"tags": [], "owner": {"reputation": 2501, "user_id": 1859956, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/rgRBJ.jpg?s=128&g=1", "display_name": "emi", "link": "https://stackoverflow.com/users/1859956/emi"}, "is_accepted": true, "score": 0, "last_activity_date": 1536720957, "last_edit_date": 1536720957, "creation_date": 1536720483, "answer_id": 52286773, "question_id": 52286423, "link": "https://stackoverflow.com/questions/52286423/get-ipv4-out-of-a-ruby-string-that-contains-both-ipv4-and-ipv6/52286773#52286773", "title": "Get IPv4 out of a Ruby string that contains both IPv4 and IPv6?", "body": "<p>Assuming your header is always as you've posted:</p>\n\n<pre><code>require 'ipaddr'\n\nheader = \"165.154.107.112, 2600:1740:8540:cff9:1c50:617:c9c5:63f7\"\n\nip = header.split(', ').select {|ip| ip if IPAddr.new(ip).ipv4? }.pop\n\n# =&gt; \"165.154.107.112\"\n</code></pre>\n"}], "owner": {"reputation": 22592, "user_id": 147586, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e4f5d494ebdc9e7cce1aecf3ce3e8bc1?s=128&d=identicon&r=PG", "display_name": "Shpigford", "link": "https://stackoverflow.com/users/147586/shpigford"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 315, "favorite_count": 0, "accepted_answer_id": 52286773, "answer_count": 2, "score": 0, "last_activity_date": 1536722106, "creation_date": 1536717482, "question_id": 52286423, "link": "https://stackoverflow.com/questions/52286423/get-ipv4-out-of-a-ruby-string-that-contains-both-ipv4-and-ipv6", "title": "Get IPv4 out of a Ruby string that contains both IPv4 and IPv6?", "body": "<p>I have a string from the <code>X-Forwarded-For</code> header that contains both IPv4 and IPv6 addresses. </p>\n\n<p>I need to pull just the IPv4 address from the string.</p>\n\n<p>It's comma-separated, but the order of them changes so I can't just split and pull the second item.</p>\n\n<p>Example: <code>header = 2600:1740:8540:cff9:1c50:617:c9c5:63f7, 165.154.107.112</code></p>\n\n<p>I ultimately just want <code>165.154.107.112</code>.</p>\n\n<p>I'm using Ruby 2.5.1 <em>(and this happens to be inside a Rails 5.2.0 app, for what it's worth)</em>.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "activerecord"], "answers": [{"tags": [], "owner": {"reputation": 6207, "user_id": 5117953, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/Ca0RW.jpg?s=128&g=1", "display_name": "Vishal", "link": "https://stackoverflow.com/users/5117953/vishal"}, "is_accepted": false, "score": 0, "last_activity_date": 1536718113, "creation_date": 1536718113, "answer_id": 52286489, "question_id": 52286063, "link": "https://stackoverflow.com/questions/52286063/ruby-on-rails-select-all-child-associations-with-a-matching-id/52286489#52286489", "title": "Ruby on Rails - Select all child associations with a matching id", "body": "<p>Fetch record with single query instead of long ruby code</p>\n\n<pre><code>current_user.orders.left_outer_joins(order_items: :products).select(\"orders .* order_items.item_id = #{product_id}\").group(\"orders.id\")\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 6644, "user_id": 1219460, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f8e98f29daa5c09c5fd1c2a09f72750?s=128&d=identicon&r=PG", "display_name": "Carlos Ramirez III", "link": "https://stackoverflow.com/users/1219460/carlos-ramirez-iii"}, "is_accepted": true, "score": 2, "last_activity_date": 1536728933, "creation_date": 1536728933, "answer_id": 52287828, "question_id": 52286063, "link": "https://stackoverflow.com/questions/52286063/ruby-on-rails-select-all-child-associations-with-a-matching-id/52287828#52287828", "title": "Ruby on Rails - Select all child associations with a matching id", "body": "<h1>Avoid querying for records in Ruby instead of Active Record</h1>\n\n<p>The main concern with the code as it\u2019s currently written is that most of the querying is done using Ruby instead of letting the database handle it via Active Record.</p>\n\n<p>As soon as you used the <code>map</code> method, you told Active Record to return the records from the database and instantiate them into memory. </p>\n\n<p>By writing the entire query using Active Record alone, you\u2019ll achieve much better performance, avoid multiple queries, AND the code will be simpler. </p>\n\n<h1>Using <code>joins</code> + <code>where</code> clause</h1>\n\n<p>The key to your query is making use of <code>joins</code> to link up all the associations and <code>where</code> to filter them to the ones you want. </p>\n\n<p>Start with this</p>\n\n<pre><code>current_user.orders.joins(:order_items)\n</code></pre>\n\n<p>From here you can use a <code>where</code> clause to filter by the <code>product_id</code> in question.</p>\n\n<pre><code>current_user.orders.joins(:order_items).where(order_items: { item_id: product_id })\n</code></pre>\n\n<p>The <code>where</code> clause is able to take a <code>Hash</code> as a parameter and you can use that hash to specify that you want to filter on a joined table (in this case the <code>order_items</code> table). </p>\n\n<hr>\n\n<p>The documentation for this is here:<br>\n<a href=\"https://guides.rubyonrails.org/active_record_querying.html#specifying-conditions-on-the-joined-tables\" rel=\"nofollow noreferrer\">https://guides.rubyonrails.org/active_record_querying.html#specifying-conditions-on-the-joined-tables</a></p>\n"}], "owner": {"reputation": 1737, "user_id": 4476186, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/f3452238962a96a1515d4ab4420aaf35?s=128&d=identicon&r=PG&f=1", "display_name": "Gerard Simpson", "link": "https://stackoverflow.com/users/4476186/gerard-simpson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1583, "favorite_count": 0, "accepted_answer_id": 52287828, "answer_count": 2, "score": 0, "last_activity_date": 1536728933, "creation_date": 1536714307, "question_id": 52286063, "link": "https://stackoverflow.com/questions/52286063/ruby-on-rails-select-all-child-associations-with-a-matching-id", "title": "Ruby on Rails - Select all child associations with a matching id", "body": "<ul>\n<li>I have a <code>user</code> </li>\n<li>A <code>user</code> <code>has_many</code> <code>orders</code>.</li>\n<li>An <code>order</code> <code>has_many</code>\n<code>order_items</code>.</li>\n<li><code>order_items</code> have a polymorphic association to <code>products</code> through <code>items</code></li>\n</ul>\n\n<p>I am trying to select all <code>orders</code> that have <code>order_items</code> that have a <code>product</code> that matches my <code>product_id</code>.</p>\n\n<p>This is an existing codebase and a big refactor isn't possible at the moment.</p>\n\n<p>I have approached the problem like this:</p>\n\n<pre><code>orders = current_user\n          .orders\n          .current\n          .map { |order| order.order_items }\n          .flatten\n          .select { |order_item| order_item.item_id.to_s == product_id }\n          .map { |order_item| order_item.order }\n</code></pre>\n\n<p>It works, I just want to know if there is a better or more \"Ruby way\" to do this?</p>\n"}, {"tags": ["ruby", "xml", "savon"], "answers": [{"comments": [{"owner": {"reputation": 2480, "user_id": 1561081, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/acd9e93464c089acdf36bf1d8ce793c9?s=128&d=identicon&r=PG", "display_name": "lrleon", "link": "https://stackoverflow.com/users/1561081/lrleon"}, "edited": false, "score": 0, "creation_date": 1536717492, "post_id": 52286335, "comment_id": 91520921, "body": "ok. Thank you; I&#39;ll test it. However, I wonder how should be done for services receiving the xml along with other parameters?"}, {"owner": {"reputation": 3271, "user_id": 387177, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ce58186c9663c82e5fef7fcca045fa57?s=128&d=identicon&r=PG", "display_name": "Steffen Roller", "link": "https://stackoverflow.com/users/387177/steffen-roller"}, "reply_to_user": {"reputation": 2480, "user_id": 1561081, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/acd9e93464c089acdf36bf1d8ce793c9?s=128&d=identicon&r=PG", "display_name": "lrleon", "link": "https://stackoverflow.com/users/1561081/lrleon"}, "edited": false, "score": 1, "creation_date": 1536718578, "post_id": 52286335, "comment_id": 91521162, "body": "build the client with :namespace, :namespaces, log: true, log_level: :debug, pretty_print_xml: true and look what the result is. Savon uses Builder for the XML body. Sometimes I found it too complicated to use it to build my message. I build the XML from a string instead. If it works, is maintainable and performant then I move on to the next problem :-)."}, {"owner": {"reputation": 2480, "user_id": 1561081, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/acd9e93464c089acdf36bf1d8ce793c9?s=128&d=identicon&r=PG", "display_name": "lrleon", "link": "https://stackoverflow.com/users/1561081/lrleon"}, "edited": false, "score": 1, "creation_date": 1536796900, "post_id": 52286335, "comment_id": 91557338, "body": "Hi Steffen. I solved the problem by building the request through <code>build</code> method, then I put `client.call(name.intern, xml: req.gsub(&quot;\\&amp;lt;&quot;, &quot;&lt;&quot;).gsub(&quot;\\&amp;gt;&quot;, &quot;&gt;&quot;)&#39;. That is, I replace the ill symbols. Not exactly a good way but that works.  Thank you"}], "tags": [], "owner": {"reputation": 3271, "user_id": 387177, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ce58186c9663c82e5fef7fcca045fa57?s=128&d=identicon&r=PG", "display_name": "Steffen Roller", "link": "https://stackoverflow.com/users/387177/steffen-roller"}, "is_accepted": true, "score": 1, "last_activity_date": 1536716755, "creation_date": 1536716755, "answer_id": 52286335, "question_id": 52285927, "link": "https://stackoverflow.com/questions/52285927/problem-with-savon-gem-and-special-characters/52286335#52286335", "title": "problem with savon gem and special characters", "body": "<p>If you have a XML message and can't get it to work with Savon's ruby objects then you can send verbatim XML like this:</p>\n\n<pre><code>client.call(service_name.intern, xml: \"&lt;tag1&gt;values&lt;/tag1&gt;\")\n</code></pre>\n\n<p>The details are described in the documentation <a href=\"http://savonrb.com/version2/locals.html\" rel=\"nofollow noreferrer\">http://savonrb.com/version2/locals.html</a></p>\n"}], "owner": {"reputation": 2480, "user_id": 1561081, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/acd9e93464c089acdf36bf1d8ce793c9?s=128&d=identicon&r=PG", "display_name": "lrleon", "link": "https://stackoverflow.com/users/1561081/lrleon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 151, "favorite_count": 0, "accepted_answer_id": 52286335, "answer_count": 1, "score": 0, "last_activity_date": 1536716755, "creation_date": 1536712958, "question_id": 52285927, "link": "https://stackoverflow.com/questions/52285927/problem-with-savon-gem-and-special-characters", "title": "problem with savon gem and special characters", "body": "<p>I'm implementing a ruby interface to soap services connecting to a special database called yardi. In order to do that, I use the savon gem.</p>\n\n<p>Many of the required services have already been implemented. However, some services in yardi require as a parameter a full XML compliant with a given yardi provided xds. I'm having problems with these services.</p>\n\n<p>The problem fundamentally is that savon changes the received xml and changes some characters; for example <code>&lt;</code>, <code>&gt;</code>, <code>\"</code>, etc.</p>\n\n<p>This is an real example of xml passed to a service:</p>\n\n<pre><code>&lt;YsiTran xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\" xmlns=\"\"&gt;&lt;Charges&gt;&lt;Charge&gt;&lt;Amount&gt;100.0&lt;/Amount&gt;&lt;AccountId&gt;49610000&lt;/AccountId&gt;&lt;ChargeCodeId&gt;rentr&lt;/ChargeCodeId&gt;&lt;Date&gt;2017-01-23T00:00:00&lt;/Date&gt;&lt;Notes&gt;Charge with segments&lt;/Notes&gt;&lt;PersonId&gt;t0001306&lt;/PersonId&gt;&lt;PostMonth&gt;2017-04-01&lt;/PostMonth&gt;&lt;PropertyId&gt;385pa&lt;/PropertyId&gt;&lt;Reference&gt;Internet&lt;/Reference&gt;&lt;UnitId&gt;B3&lt;/UnitId&gt;&lt;Segment1&gt;collect&lt;/Segment1&gt;&lt;Segment2&gt;Technical&lt;/Segment2&gt;&lt;Segment3&gt;After due date&lt;/Segment3&gt;&lt;Segment4&gt;NA&lt;/Segment4&gt;&lt;Segment5&gt;IT&lt;/Segment5&gt;&lt;Segment6&gt;Owner&lt;/Segment6&gt;&lt;Segment7&gt;Testing&lt;/Segment7&gt;&lt;Segment8&gt;Testing&lt;/Segment8&gt;&lt;Segment9&gt;Employee&lt;/Segment9&gt;&lt;Segment10&gt;Sigma&lt;/Segment10&gt;&lt;Segment11&gt;January&lt;/Segment11&gt;&lt;Segment12&gt;Block 1&lt;/Segment12&gt;&lt;/Charge&gt;&lt;/Charges&gt;&lt;/YsiTran&gt;\n</code></pre>\n\n<p>I'm pretty sure this xml is correct because I have tested it by using <a href=\"http://www.soapui.org\" rel=\"nofollow noreferrer\">SoapUI</a>. That is, when I put the xml to SoapUI with the given xml the service responds correctly.</p>\n\n<p>Now, when I put the previous xml to savon and I see the request, I notice that the xml is transformed to</p>\n\n<pre><code>&amp;lt;YsiTran xmlns:xsi=&amp;quot;http://www.w3.org/2001/XMLSchema-instance&amp;quot; xmlns:xsd=&amp;quot;http://www.w3.org/2001/XMLSchema&amp;quot; xmlns=&amp;quot;&amp;quot;&amp;gt;&amp;lt;Charges&amp;gt;&amp;lt;Charge&amp;gt;&amp;lt;Amount&amp;gt;100.0&amp;lt;/Amount&amp;gt;&amp;lt;AccountId&amp;gt;49610000&amp;lt;/AccountId&amp;gt;&amp;lt;ChargeCodeId&amp;gt;rentr&amp;lt;/ChargeCodeId&amp;gt;&amp;lt;Date&amp;gt;2017-01-23T00:00:00&amp;lt;/Date&amp;gt;&amp;lt;Notes&amp;gt;Charge with segments&amp;lt;/Notes&amp;gt;&amp;lt;PersonId&amp;gt;t0001306&amp;lt;/PersonId&amp;gt;&amp;lt;PostMonth&amp;gt;2017-04-01&amp;lt;/PostMonth&amp;gt;&amp;lt;PropertyId&amp;gt;385pa&amp;lt;/PropertyId&amp;gt;&amp;lt;Reference&amp;gt;Internet&amp;lt;/Reference&amp;gt;&amp;lt;UnitId&amp;gt;B3&amp;lt;/UnitId&amp;gt;&amp;lt;Segment1&amp;gt;collect&amp;lt;/Segment1&amp;gt;&amp;lt;Segment2&amp;gt;Technical&amp;lt;/Segment2&amp;gt;&amp;lt;Segment3&amp;gt;After due date&amp;lt;/Segment3&amp;gt;&amp;lt;Segment4&amp;gt;NA&amp;lt;/Segment4&amp;gt;&amp;lt;Segment5&amp;gt;IT&amp;lt;/Segment5&amp;gt;&amp;lt;Segment6&amp;gt;Owner&amp;lt;/Segment6&amp;gt;&amp;lt;Segment7&amp;gt;Testing&amp;lt;/Segment7&amp;gt;&amp;lt;Segment8&amp;gt;Testing&amp;lt;/Segment8&amp;gt;&amp;lt;Segment9&amp;gt;Employee&amp;lt;/Segment9&amp;gt;&amp;lt;Segment10&amp;gt;Sigma&amp;lt;/Segment10&amp;gt;&amp;lt;Segment11&amp;gt;January&amp;lt;/Segment11&amp;gt;&amp;lt;Segment12&amp;gt;Block 1&amp;lt;/Segment12&amp;gt;&amp;lt;/Charge&amp;gt;&amp;lt;/Charges&amp;gt;&amp;lt;/YsiTran&amp;gt;\n</code></pre>\n\n<p>As someone could notice, for a reason that I ignore savon changed some symbols.</p>\n\n<p>I'm performing the request some like this:</p>\n\n<pre><code>client.call(service_name.intern, \n            message: { # other parameters\n                       'TransactionXml' =&gt; transaction_xml })\n</code></pre>\n\n<p><code>client</code> is a savon object and <code>transaction_xml</code> is a ruby string containing the xml.</p>\n\n<p>Any clue, tip? Thanks in advance</p>\n"}, {"tags": ["ruby", "mongodb", "bson"], "comments": [{"owner": {"reputation": 775, "user_id": 1544440, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/75da798fa2e162ff6eab82bc51a2d3a3?s=128&d=identicon&r=PG", "display_name": "Omar Bahareth", "link": "https://stackoverflow.com/users/1544440/omar-bahareth"}, "edited": false, "score": 0, "creation_date": 1536924967, "post_id": 52284964, "comment_id": 91608902, "body": "Hey, this might be a possible duplicate of <a href=\"https://stackoverflow.com/questions/2532845/how-i-know-my-documents-size-inside-mongodb-with-the-ruby-driver\">How I know my document&#39;s size inside MongoDB with the ruby driver</a>. Could you take a look there and see if the answers there help you out?"}, {"owner": {"reputation": 3, "user_id": 6641022, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b128359705bc2ebb48a71d41555b0f36?s=128&d=identicon&r=PG&f=1", "display_name": "B..", "link": "https://stackoverflow.com/users/6641022/b"}, "reply_to_user": {"reputation": 775, "user_id": 1544440, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/75da798fa2e162ff6eab82bc51a2d3a3?s=128&d=identicon&r=PG", "display_name": "Omar Bahareth", "link": "https://stackoverflow.com/users/1544440/omar-bahareth"}, "edited": false, "score": 0, "creation_date": 1536941355, "post_id": 52284964, "comment_id": 91618350, "body": "That page suggests using BSON.serialize, but it doesn&#39;t seem to exist.  I think it may have been part of a previous version."}], "answers": [{"tags": [], "owner": {"reputation": 775, "user_id": 1544440, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/75da798fa2e162ff6eab82bc51a2d3a3?s=128&d=identicon&r=PG", "display_name": "Omar Bahareth", "link": "https://stackoverflow.com/users/1544440/omar-bahareth"}, "is_accepted": true, "score": 0, "last_activity_date": 1536946306, "creation_date": 1536946306, "answer_id": 52336768, "question_id": 52284964, "link": "https://stackoverflow.com/questions/52284964/get-mongodb-object-size-through-ruby-connector/52336768#52336768", "title": "Get MongoDB object size through Ruby connector", "body": "<p>As of <a href=\"https://github.com/mongodb/bson-ruby/blob/1a682e22ec998a2ad652a2d680f2f1515ef867ad/CHANGELOG.md#200\" rel=\"nofollow noreferrer\">Mongo's Ruby Driver 2.0</a> release, <code>BSON.serialize</code> is removed. If you have a <code>BSON::Document</code>, you can transform it to a <code>BSON::ByteBuffer</code> by calling <code>to_bson</code>, and then get its size by calling <code>length</code> on that.</p>\n\n<p>Example:</p>\n\n<pre><code>BSON::Document.new({a: 1}).to_bson.length\n=&gt; 12\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 6641022, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b128359705bc2ebb48a71d41555b0f36?s=128&d=identicon&r=PG&f=1", "display_name": "B..", "link": "https://stackoverflow.com/users/6641022/b"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 56, "favorite_count": 0, "accepted_answer_id": 52336768, "answer_count": 1, "score": 0, "last_activity_date": 1536946306, "creation_date": 1536704693, "question_id": 52284964, "link": "https://stackoverflow.com/questions/52284964/get-mongodb-object-size-through-ruby-connector", "title": "Get MongoDB object size through Ruby connector", "body": "<p>How do I get the BSON document size of a MongoDB record using the Ruby connector?  For BSON::Document.new(some_hash), .size seems to return the number of keys for the document, .bson_size doesn't exist, and .data_size returns an error.  </p>\n"}, {"tags": ["ruby-on-rails", "ruby", "sidekiq"], "comments": [{"owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 2, "creation_date": 1536731073, "post_id": 52284058, "comment_id": 91524006, "body": "I would argue that not using autoloading is one of the reasons to put external classes into the <code>lib</code> folder. I wouldn&#39;t try to make autoloading working with the <code>lib</code> folder. I would always use an explicit <code>require</code> to load features from the <code>lib</code> folder."}], "answers": [{"tags": [], "owner": {"reputation": 3119, "user_id": 4842949, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-0agpj31wtZ8/AAAAAAAAAAI/AAAAAAAAAAA/mSolbNN-zIY/photo.jpg?sz=128", "display_name": "Joseph Cho", "link": "https://stackoverflow.com/users/4842949/joseph-cho"}, "is_accepted": true, "score": 5, "last_activity_date": 1607709999, "last_edit_date": 1607709999, "creation_date": 1536699901, "answer_id": 52284201, "question_id": 52284058, "link": "https://stackoverflow.com/questions/52284058/why-use-apps-libs-instead-of-libs-in-rails/52284201#52284201", "title": "Why use /apps/libs instead of /libs in Rails?", "body": "<p>In my experience <code>apps/libs</code> is easier to use. You can literally stick in something like <code>Class MathFunction</code> and use it elsewhere (e.g. controllers or modules) with <code>MathFunction.sqrRoot</code>.</p>\n<p>To use <code>/libs</code> you need to configure your Rails app with <code>autoload_paths</code>. <code>autoload_paths</code> also need some tweaking to work properly in <a href=\"https://bigbinary.com/blog/rails-5-disables-autoloading-after-booting-the-app-in-production\" rel=\"nofollow noreferrer\">production</a>. Matz himself discourages <code>autoload</code> because it's in the process of <a href=\"https://bugs.ruby-lang.org/issues/5653\" rel=\"nofollow noreferrer\">being deprecated</a>.</p>\n<p>The only time I've needed to use the <code>libs</code> directory is for making custom rake tasks. Otherwise I stick to <code>apps/libs</code>.</p>\n"}], "owner": {"reputation": 69, "user_id": 615743, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/88ed3c3a7038678bec573bfa6d186551?s=128&d=identicon&r=PG", "display_name": "klementine", "link": "https://stackoverflow.com/users/615743/klementine"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 845, "favorite_count": 1, "accepted_answer_id": 52284201, "answer_count": 1, "score": 4, "last_activity_date": 1607709999, "creation_date": 1536699184, "question_id": 52284058, "link": "https://stackoverflow.com/questions/52284058/why-use-apps-libs-instead-of-libs-in-rails", "title": "Why use /apps/libs instead of /libs in Rails?", "body": "<p>In the sidekiq documentation, there is <a href=\"https://github.com/mperham/sidekiq/wiki/Problems-and-Troubleshooting#autoloading\" rel=\"nofollow noreferrer\">this quote</a> about preferring to use <code>/apps/libs</code> instead of <code>/libs</code> in Rails projects related to autoloading errors:</p>\n\n<blockquote>\n  <p>A lib/ directory will only cause pain. Move the code to app/lib/ and make sure the code inside follows the class/filename conventions.</p>\n</blockquote>\n\n<p>Additionally there is also:</p>\n\n<blockquote>\n  <p>Don't configure extra paths in autoload_paths or eager_load_paths. That's a hack; follow the conventions! Any directory underneath app/ may contain Ruby code, you don't need to explicitly configure anything.</p>\n</blockquote>\n\n<p>My questions are:</p>\n\n<p>Is there any truth to these statements that using <code>/apps/libs</code> is better than <code>/libs</code>?</p>\n\n<p>Is this only helpful for autoloading Rails related objects (such as AR models, controllers, jobs, etc)? Or will it also help POROs?</p>\n\n<p>Is there only a specific context that these comments make sense?</p>\n"}, {"tags": ["ruby", "metaprogramming"], "comments": [{"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 1, "creation_date": 1536695054, "post_id": 52282962, "comment_id": 91514476, "body": "If we define &quot;metaprogramming&quot; as &quot;code that writes code&quot;, then there&#39;s none of that here, yet. And, judging from your verbiage, this task <i>might</i> be too advanced. Before one attempts something like this, he better have a clear understanding of core ruby/oop concepts: variable vs. method vs. message, return values and how to return objects from methods, various ways of storing state of an object and when to use which, and so on, and so forth."}, {"owner": {"reputation": 103, "user_id": 9826359, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/755b6aabe0a7a2f4774bd28f1eeecf27?s=128&d=identicon&r=PG&f=1", "display_name": "buddingprogrammer", "link": "https://stackoverflow.com/users/9826359/buddingprogrammer"}, "reply_to_user": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1536695222, "post_id": 52282962, "comment_id": 91514564, "body": "@SergioTulentsev The motivation for this question came from <a href=\"https://www.codewars.com/kata/5571d9fc11526780a000011a\" rel=\"nofollow noreferrer\">codewars.com/kata/5571d9fc11526780a000011a</a> which leads me to believe it&#39;s not too advanced for Ruby."}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1536695370, "post_id": 52282962, "comment_id": 91514637, "body": "For ruby - no. For you today - likely yes :) That problem is 3 kyu, one of the higher difficulties."}, {"owner": {"reputation": 103, "user_id": 9826359, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/755b6aabe0a7a2f4774bd28f1eeecf27?s=128&d=identicon&r=PG&f=1", "display_name": "buddingprogrammer", "link": "https://stackoverflow.com/users/9826359/buddingprogrammer"}, "reply_to_user": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1536695466, "post_id": 52282962, "comment_id": 91514684, "body": "@SergioTulentsev which I agree with you on. I&#39;m just pointing out it&#39;s a task suited for Ruby, going against your original statement before you edited it."}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1536695511, "post_id": 52282962, "comment_id": 91514711, "body": "Well yes, people do this kind of thing in ruby all the time. I never said otherwise."}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 1, "creation_date": 1536696413, "post_id": 52282962, "comment_id": 91515117, "body": "Thanks for bringing my attention to this kata, it looks very interesting. So many possibilities. I should do it sometime!"}], "answers": [{"tags": [], "owner": {"reputation": 1553, "user_id": 4149820, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bb809f7e739416524f3c380fe8f4fe45?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas", "link": "https://stackoverflow.com/users/4149820/thomas"}, "is_accepted": true, "score": 1, "last_activity_date": 1536694700, "creation_date": 1536694700, "answer_id": 52283086, "question_id": 52282962, "link": "https://stackoverflow.com/questions/52282962/ruby-metaprogramming-depths/52283086#52283086", "title": "Ruby Metaprogramming &quot;Depths&quot;", "body": "<p>You need to add some kind of recursion :</p>\n\n<pre><code>class StackOverflow\n  def initialize(name)\n    @name = name\n  end\n\n  def method_missing(argument, *args)\n    argument = argument.to_s\n\n    if argument =~ /failing/\n      puts 'FOUND FAILING'\n      puts argument\n      puts args[0]\n      return\n    end\n\n    if argument =~ /this_test_is/\n      puts 'FOUND THIS TEST IS'\n      puts argument\n      puts args[0]\n      return StackOverflow.new(\"this_test_is\")\n    end\n\n    if argument =~ /this_works=/\n      instance_variable_set(\"@#{argument.to_s.chop}\", args[0])\n      return\n    else\n      return instance_variable_get(\"@#{argument}\").to_s\n    end\n  end\nend\n\ntest = StackOverflow.new(\"post\")\ntest.this_works = true\nputs \"IT WORKED: \" + test.this_works\ntest.this_test_is.failing\n</code></pre>\n\n<p>prints this :</p>\n\n<pre><code>IT WORKED: true\nFOUND THIS TEST IS\nthis_test_is\n\nFOUND FAILING\nfailing\n</code></pre>\n"}], "owner": {"reputation": 103, "user_id": 9826359, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/755b6aabe0a7a2f4774bd28f1eeecf27?s=128&d=identicon&r=PG&f=1", "display_name": "buddingprogrammer", "link": "https://stackoverflow.com/users/9826359/buddingprogrammer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 61, "favorite_count": 0, "accepted_answer_id": 52283086, "answer_count": 1, "score": 1, "last_activity_date": 1536694700, "creation_date": 1536694070, "question_id": 52282962, "link": "https://stackoverflow.com/questions/52282962/ruby-metaprogramming-depths", "title": "Ruby Metaprogramming &quot;Depths&quot;", "body": "<p>I'm starting to learn metaprogramming in Ruby and (I think) I'm understanding how to add instance methods and variables, but only if passed in one at a time. For example, <code>test.new_value = true</code>. I'm wondering how to add an extra depth to my command with two dots <code>test.like.this</code>. For example:</p>\n\n<pre><code>class StackOverflow\n  def initialize(name)\n    @name = name\n  end\n\n  def method_missing(argument, *args)\n    argument = argument.to_s\n\n    if argument =~ /failing/\n      puts 'FOUND FAILING'\n      puts argument\n      puts args[0]\n      return\n    end\n\n    if argument =~ /this_test_is/\n      puts 'FOUND THIS TEST IS'\n      puts argument\n      puts args[0]\n      return\n    end\n\n    if argument =~ /this_works=/\n      instance_variable_set(\"@#{argument.to_s.chop}\", args[0])\n      return\n    else\n      return instance_variable_get(\"@#{argument}\").to_s\n    end\n  end\nend\n\ntest = StackOverflow.new(\"post\")\ntest.this_works = true\nputs \"IT WORKED: \" + test.this_works\ntest.this_test_is.failing\n</code></pre>\n\n<p>gives me the following output:</p>\n\n<pre><code>ruby 2.5.0p0 (2017-12-25 revision 61468) [x86_64-linux]\n\nIT WORKED: true\nFOUND THIS TEST IS\nthis_test_is\n\nundefined method `failing' for nil:NilClass\n(repl):44:in `&lt;main&gt;'\n</code></pre>\n\n<p>What I'm looking to do is treat this as a variable and value pair. I'd like to know how to do both of these scenarios:</p>\n\n<p>A: Recognise <code>this_test_is</code> and treat it as a variable to have it store the string (or symbol is fine) <code>failing</code>.</p>\n\n<p>B: Recognise <code>failing</code> as the variable and if I see <code>this_test_is</code> then set <code>failing</code> to <code>true</code>, as opposed to <code>false</code> if I find <code>this_test_is_not</code>.</p>\n\n<p>Thank you in advance!</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "rbenv"], "comments": [{"owner": {"reputation": 61438, "user_id": 63034, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/ZXKMO.jpg?s=128&g=1", "display_name": "mikej", "link": "https://stackoverflow.com/users/63034/mikej"}, "edited": false, "score": 0, "creation_date": 1536697465, "post_id": 52282701, "comment_id": 91515583, "body": "There&#39;s a lot here going on here, but a couple of pointers. The first step in the <a href=\"https://github.com/lewagon/setup/blob/master/macOS.md#installing-ruby-with-rbenv\" rel=\"nofollow noreferrer\">setup</a> you linked to covers removing existing rbenv installations and should help with the &quot;You seem to have multiple rbenv installs&quot;. Don&#39;t worry about <code>.profile</code> - I could be wrong on this, but I don&#39;t think that file gets used by zsh. Lastly, please clarify the &quot;nothing happens&quot;."}, {"owner": {"reputation": 646, "user_id": 8919469, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/f51a8277c113b7415c6b2bbd82be9615?s=128&d=identicon&r=PG&f=1", "display_name": "johan", "link": "https://stackoverflow.com/users/8919469/johan"}, "reply_to_user": {"reputation": 61438, "user_id": 63034, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/ZXKMO.jpg?s=128&g=1", "display_name": "mikej", "link": "https://stackoverflow.com/users/63034/mikej"}, "edited": false, "score": 0, "creation_date": 1536698018, "post_id": 52282701, "comment_id": 91515784, "body": "I removed the rbenv and rvm installation Nothing happens, usually when I install gem , there are traces of the installation, here it just seems to skip the command <code>gem install ...</code>"}, {"owner": {"reputation": 646, "user_id": 8919469, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/f51a8277c113b7415c6b2bbd82be9615?s=128&d=identicon&r=PG&f=1", "display_name": "johan", "link": "https://stackoverflow.com/users/8919469/johan"}, "reply_to_user": {"reputation": 61438, "user_id": 63034, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/ZXKMO.jpg?s=128&g=1", "display_name": "mikej", "link": "https://stackoverflow.com/users/63034/mikej"}, "edited": false, "score": 0, "creation_date": 1536698189, "post_id": 52282701, "comment_id": 91515850, "body": "I edited my question  see at the end"}], "answers": [{"tags": [], "owner": {"reputation": 646, "user_id": 8919469, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/f51a8277c113b7415c6b2bbd82be9615?s=128&d=identicon&r=PG&f=1", "display_name": "johan", "link": "https://stackoverflow.com/users/8919469/johan"}, "is_accepted": true, "score": 0, "last_activity_date": 1536699160, "creation_date": 1536699160, "answer_id": 52284055, "question_id": 52282701, "link": "https://stackoverflow.com/questions/52282701/troubles-re-installing-ruby/52284055#52284055", "title": "troubles re-installing ruby", "body": "<p>I fixed with:</p>\n\n<ul>\n<li><code>brew update</code></li>\n<li><code>brew upgrade</code></li>\n<li><code>brew uninstall ruby</code></li>\n</ul>\n"}], "owner": {"reputation": 646, "user_id": 8919469, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/f51a8277c113b7415c6b2bbd82be9615?s=128&d=identicon&r=PG&f=1", "display_name": "johan", "link": "https://stackoverflow.com/users/8919469/johan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 124, "favorite_count": 0, "accepted_answer_id": 52284055, "answer_count": 1, "score": 0, "last_activity_date": 1536699160, "creation_date": 1536692927, "last_edit_date": 1536698160, "question_id": 52282701, "link": "https://stackoverflow.com/questions/52282701/troubles-re-installing-ruby", "title": "troubles re-installing ruby", "body": "<p>I had  <strong>RVM</strong> and <strong>RBENV</strong> installed on my computer and I decided to keep only <strong>RBENV</strong> So I followed this <a href=\"https://github.com/lewagon/setup/blob/master/macOS.md#installing-ruby-with-rbenv\" rel=\"nofollow noreferrer\">setup</a>\n<em>I am on mac with high sierra</em></p>\n\n<ul>\n<li><p>The first trouble I am facing is that <code>ruby -v</code> displays nothing.\nI know that my ruby version is ok because of ohmyzsh <code>[2.4.4]</code></p></li>\n<li><p>When I try to run this command <code>gem install rake bundler rspec rubocop pry pry-byebug hub colored octokit</code>nothing happens... I can't install bundler nor rails.... I am not supposed to use the sudo... What could be wrong and how could I find fix this? \nI can't even launch <code>irb</code> and <code>gem install bundler</code>does nothing </p></li>\n</ul>\n\n<p>there must be a conflict somewhere? </p>\n\n<p>I ran this <a href=\"http://curl%20https://gist.githubusercontent.com/ssaunier/056a755214f4109760ca306c14dd569f/raw/wagon_diagnostic.sh%20%7C%20sh\" rel=\"nofollow noreferrer\">dignostic</a>:</p>\n\n<pre><code>  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current\n                                 Dload  Upload   Total   Spent    Left  Speed\n100   320  100   320    0     0    858      0 --:--:-- --:--:-- --:--:--   860\n--- PATH ---\n./bin:/Users/bill/.rbenv/shims:/usr/local/opt/rbenv/bin:/usr/bin:/bin:/usr/sbin:/sbin:/usr/local/bin:/opt/ImageMagick/bin:/usr/local/sbin\n--- RBENV ---\nrbenv is /usr/local/opt/rbenv/bin/rbenv\nrbenv is /usr/local/bin/rbenv\n  system\n* 2.4.4 (set by /Users/bill/.rbenv/version)\n--- RUBY ---\nruby is /Users/bill/.rbenv/shims/ruby\nruby is /usr/bin/ruby\nruby is /usr/local/bin/ruby\n--- GEM ---\ngem is /Users/bill/.rbenv/shims/gem\ngem is /usr/bin/gem\ngem is /usr/local/bin/gem\n--- POSTGRES ---\npostgres is /usr/local/bin/postgres\npostgres (PostgreSQL) 10.5\n2018-09-11 17:04:51.406 CEST [30591] FATAL:  database files are incompatible with server\n2018-09-11 17:04:51.406 CEST [30591] DETAIL:  The data directory was initialized by PostgreSQL version 9.6, which is not compatible with this version 10.5.\n</code></pre>\n\n<p>See my .zshrc</p>\n\n<pre><code>ZSH=$HOME/.oh-my-zsh\n\n# You can change the theme with another one:\n#   https://github.com/robbyrussell/oh-my-zsh/wiki/themes\nZSH_THEME=\"robbyrussell\"\n\n# Add ruby version on prompt (float right)\nif [ -x \"$(command -v rbenv)\" ]; then RPS1='[$(ruby_prompt_info)]$EPS1'; fi\n\n# Useful plugins for Rails development with Sublime Text\nplugins=(gitfast brew rbenv last-working-dir common-aliases sublime zsh-syntax-highlighting history-substring-search)\n\n# Prevent Homebrew from reporting - https://github.com/Homebrew/brew/blob/master/share/doc/homebrew/Analytics.md\nexport HOMEBREW_NO_ANALYTICS=1\n\n# Actually load Oh-My-Zsh\nsource \"${ZSH}/oh-my-zsh.sh\"\n\n# Rails and Ruby uses the local `bin` folder to store binstubs.\n# So instead of running `bin/rails` like the doc says, just run `rails`\nexport PATH=\"./bin:${PATH}:/usr/local/sbin\"\n\n# Store your own aliases in the ~/.aliases file and load the here.\n[[ -f \"$HOME/.aliases\" ]] &amp;&amp; source \"$HOME/.aliases\"\n\n# Encoding stuff for the terminal\nexport LANG=en_US.UTF-8\nexport LC_ALL=en_US.UTF-8\nexport BUNDLER_EDITOR=\"'/Applications/Sublime Text.app/Contents/SharedSupport/bin/subl'\"\nexport BUNDLER_EDITOR=\"'/Applications/Sublime Text.app/Contents/SharedSupport/bin/subl'\"\nexport BUNDLER_EDITOR=\"'/Applications/Sublime Text.app/Contents/SharedSupport/bin/subl'\"\neval \"$(rbenv init -)\"\n</code></pre>\n\n<p>Also ran this <a href=\"http://curl%20-fsSL%20https://github.com/rbenv/rbenv-installer/raw/master/bin/rbenv-doctor%20%7C%20bash\" rel=\"nofollow noreferrer\">diganostic</a>: </p>\n\n<pre><code>  You seem to have multiple rbenv installs in the following locations.\n  Please pick just one installation and remove the others.\n\n  /usr/local/opt/rbenv/bin/rbenv\n  /usr/local/bin/rbenv\n\nChecking for rbenv shims in PATH: OK\nChecking `rbenv install' support: /usr/local/bin/rbenv-install (ruby-build 20180822)\nCounting installed Ruby versions: 1 versions\nChecking RubyGems settings: OK\nAuditing installed plugins: %\n</code></pre>\n\n<p>here is a screenshot of my <code>~</code>maybe something needs to be removed ? what about that <code>.rvmrc</code> it says <code>rvm_auto_reload_flag=1\nrvm_auto_reload_flag=2</code>\n<a href=\"https://i.stack.imgur.com/zGOWD.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/zGOWD.png\" alt=\"enter image description here\"></a></p>\n\n<h3>EDIT</h3>\n\n<p>I am opening the folders and files:\nin <code>.profile</code>it says:</p>\n\n<pre><code>export PATH=\"$PATH:$HOME/.rvm/bin\" # Add RVM to PATH for scripting\n[[ -s \"$HOME/.rvm/scripts/rvm\" ]] &amp;&amp; source \"$HOME/.rvm/scripts/rvm\" # Load RVM into a shell session *as a function*\n</code></pre>\n\n<p><strong>Clarify the \"nothing  happens\"</strong></p>\n\n<pre><code>  ~ gem install rake bundler rspec rubocop pry pry-byebug hub colored octokit\n\n\u279c  ~\n</code></pre>\n"}, {"tags": ["ruby", "lambda", "parameter-passing"], "answers": [{"tags": [], "owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "is_accepted": true, "score": 3, "last_activity_date": 1536693717, "creation_date": 1536693717, "answer_id": 52282870, "question_id": 52282497, "link": "https://stackoverflow.com/questions/52282497/is-there-an-elegant-way-to-pass-do-nothing-as-a-lambda/52282870#52282870", "title": "Is there an elegant way to pass &#39;do nothing&#39; as a lambda?", "body": "<p>I would recommend rethinking <code>foo</code> instead.</p>\n\n<p>That being said I do not think there is a more elegant way, but if you really wanted to you could add something like this (which is uglier in my opinion than what you have)</p>\n\n<pre><code>module Kernel\n  def noop\n    Proc.new {}\n  end\nend\n</code></pre>\n\n<p>Then call as </p>\n\n<pre><code>def foo(blk)\n  blk.call(1,2,3,4,5)\nend\n\nfoo(noop) \n#=&gt; nil\n</code></pre>\n"}], "owner": {"reputation": 9435, "user_id": 2626000, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/j8GY0.jpg?s=128&g=1", "display_name": "Aaron Christiansen", "link": "https://stackoverflow.com/users/2626000/aaron-christiansen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 170, "favorite_count": 0, "accepted_answer_id": 52282870, "answer_count": 1, "score": 1, "last_activity_date": 1536693717, "creation_date": 1536692022, "question_id": 52282497, "link": "https://stackoverflow.com/questions/52282497/is-there-an-elegant-way-to-pass-do-nothing-as-a-lambda", "title": "Is there an elegant way to pass &#39;do nothing&#39; as a lambda?", "body": "<p>Suppose I have a method, <code>foo</code>, which requires a lambda parameter. The lambda is invoked by <code>foo</code> with arguments. I don't actually want anything to happen upon execution of the lambda.</p>\n\n<p>Currently, I'm doing this:</p>\n\n<pre><code>foo(-&gt;(*) {})\n</code></pre>\n\n<p>This looks a tad ugly, and I have to believe that there is a more elegant and legible way of writing this built into the Ruby language.</p>\n\n<p>Is there a better way of passing a 'do nothing' lambda?</p>\n"}, {"tags": ["ruby", "solaris"], "answers": [{"tags": [], "owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "is_accepted": true, "score": 2, "last_activity_date": 1536764210, "creation_date": 1536764210, "answer_id": 52298151, "question_id": 52282412, "link": "https://stackoverflow.com/questions/52282412/unable-to-compile-ruby-2-5-1-on-solaris-10-sparc/52298151#52298151", "title": "Unable to compile Ruby 2.5.1 on Solaris 10 SPARC", "body": "<p>Looks like a bug in <a href=\"https://github.com/ruby/ruby/blob/v2_5_1/ext/socket/raddrinfo.c\" rel=\"nofollow noreferrer\">the source code</a>. <code>parse_numeric_port()</code> is only defined if \n<code>GETADDRINFO_EMU</code> isn't defined, but the code uses <code>parse_numeric_port()</code> if <code>GETADDRINFO_EMU</code> is defined or not (note my comments added to the code):</p>\n\n<pre><code>#ifndef GETADDRINFO_EMU\nstruct getaddrinfo_arg\n{\n    const char *node;\n    const char *service;\n    const struct addrinfo *hints;\n    struct addrinfo **res;\n};\n\n#ifdef HAVE_INET_PTON\nstatic int\nparse_numeric_port(const char *service, int *portp)\n{\n    unsigned long u;\n\n    if (!service) {\n        *portp = 0;\n        return 1;\n    }\n\n    if (strspn(service, \"0123456789\") != strlen(service))\n        return 0;\n\n    errno = 0;\n    u = STRTOUL(service, NULL, 10);\n    if (errno)\n        return 0;\n\n    if (0x10000 &lt;= u)\n        return 0;\n\n    *portp = (int)u;\n\n    return 1;\n}\n#endif\n\nstatic void *\nnogvl_getaddrinfo(void *arg)\n{\n    int ret;\n    struct getaddrinfo_arg *ptr = arg;\n    ret = getaddrinfo(ptr-&gt;node, ptr-&gt;service, ptr-&gt;hints, ptr-&gt;res);\n#ifdef __linux__\n    /* On Linux (mainly Ubuntu 13.04) /etc/nsswitch.conf has mdns4 and\n     * it cause getaddrinfo to return EAI_SYSTEM/ENOENT. [ruby-list:49420]\n     */\n    if (ret == EAI_SYSTEM &amp;&amp; errno == ENOENT)\n    ret = EAI_NONAME;\n#endif\n    return (void *)(VALUE)ret;\n}\n#endif  // *** This closes #ifndef GETADDRINFO_EMU ***\n\nstatic int\nnumeric_getaddrinfo(const char *node, const char *service,\n        const struct addrinfo *hints,\n        struct addrinfo **res)\n{\n#ifdef HAVE_INET_PTON\n# if defined __MINGW64__\n#   define inet_pton(f,s,d)        rb_w32_inet_pton(f,s,d)\n# endif\n\n    int port;\n\n    // *** But this uses parse_numeric_port() even if it wasn't defined ***\n    if (node &amp;&amp; parse_numeric_port(service, &amp;port)) {\n    static const struct {\n        int socktype;\n</code></pre>\n\n<p>You can either find a way to NOT have <code>GETADDRINFO_EMU</code> defined when you build, or you can file a bug report and wait for a fix.</p>\n"}], "owner": {"reputation": 759, "user_id": 2077644, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/49dde1608911b1724d850a8eb6f408d4?s=128&d=identicon&r=PG", "display_name": "Karthi1234", "link": "https://stackoverflow.com/users/2077644/karthi1234"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 80, "favorite_count": 0, "accepted_answer_id": 52298151, "answer_count": 1, "score": 0, "last_activity_date": 1536764210, "creation_date": 1536691646, "last_edit_date": 1536700985, "question_id": 52282412, "link": "https://stackoverflow.com/questions/52282412/unable-to-compile-ruby-2-5-1-on-solaris-10-sparc", "title": "Unable to compile Ruby 2.5.1 on Solaris 10 SPARC", "body": "<p>Am trying to compile Ruby 2.5.1 on Solaris 10 SPARC where am ended with the below error. Not sure why am getting Undefined symbol for socket. </p>\n\n<pre><code>generating a glommed object with DTrace probes for static library\nlinking static-library libruby-static.a\ngenerating enc.mk\ncompiling enc/encinit.c\nlinking ruby\nUndefined                       first referenced\n symbol                             in file\nparse_numeric_port                  ext/socket/socket.a(raddrinfo.o)\nld: fatal: Symbol referencing errors. No output written to ruby\ncollect2: ld returned 1 exit status\n*** Error code 1\nThe following command caused the error:\ngcc -std=c99  -L. -L/usr/local/lib -L.  -L/var/tools/openssl/lib main.o ext/extinit.o ext/socket/socket.a ext/cgi/escape/escape.a  ext/continuation/continuation.a ext/racc/cparse/cparse.a  ext/openssl/openssl.a ext/ripper/ripper.a  ext/objspace/objspace.a ext/pty/pty.a ext/zlib/zlib.a  ext/etc/etc.a ext/fcntl/fcntl.a ext/dbm/dbm.a  ext/strscan/strscan.a ext/fiber/fiber.a  ext/readline/readline.a ext/digest/digest.a  ext/digest/bubblebabble/bubblebabble.a ext/digest/md5/md5.a  ext/digest/rmd160/rmd160.a ext/digest/sha1/sha1.a  ext/digest/sha2/sha2.a ext/fiddle/fiddle.a  ext/syslog/syslog.a ext/date/date_core.a  ext/coverage/coverage.a ext/nkf/nkf.a ext/gdbm/gdbm.a  ext/io/console/console.a ext/io/nonblock/nonblock.a  ext/io/wait/wait.a ext/rbconfig/sizeof/sizeof.a  ext/psych/psych.a ext/json/generator/generator.a  ext/json/parser/parser.a ext/stringio/stringio.a  ext/pathname/pathname.a ext/sdbm/sdbm.a  ext/bigdecimal/bigdecimal.a enc/encinit.o enc/libenc.a enc/libtrans.a -lruby-static  -lpthread -lrt -lgmp -lsocket -ldl -lcrypt -lm  -lsocket -lnsl -lssl -lcrypto -lz -lreadline -lncurses -ldl  -lffi -lgdbm -lyaml -lsocket -lnsl -lssl -lcrypto -lz -lreadline -lncurses -ldl  -lffi -lgdbm -lyaml -o ruby\nmake: Fatal error: Command failed for target `ruby'\nCurrent working directory /usr/share/src/ruby-2.5.1\n*** Error code 1\nThe following command caused the error:\nmake  EXTOBJS=\"ext/extinit.o ext/socket/socket.a ext/cgi/escape/escape.a  ext/continuation/continuation.a ext/racc/cparse/cparse.a  ext/openssl/openssl.a ext/ripper/ripper.a  ext/objspace/objspace.a ext/pty/pty.a ext/zlib/zlib.a  ext/etc/etc.a ext/fcntl/fcntl.a ext/dbm/dbm.a  ext/strscan/strscan.a ext/fiber/fiber.a  ext/readline/readline.a ext/digest/digest.a  ext/digest/bubblebabble/bubblebabble.a ext/digest/md5/md5.a  ext/digest/rmd160/rmd160.a ext/digest/sha1/sha1.a  ext/digest/sha2/sha2.a ext/fiddle/fiddle.a  ext/syslog/syslog.a ext/date/date_core.a  ext/coverage/coverage.a ext/nkf/nkf.a ext/gdbm/gdbm.a  ext/io/console/console.a ext/io/nonblock/nonblock.a  ext/io/wait/wait.a ext/rbconfig/sizeof/sizeof.a  ext/psych/psych.a ext/json/generator/generator.a  ext/json/parser/parser.a ext/stringio/stringio.a  ext/pathname/pathname.a ext/sdbm/sdbm.a  ext/bigdecimal/bigdecimal.a enc/encinit.o enc/libenc.a enc/libtrans.a\" EXTLIBS=\"-lsocket -lnsl -lssl -lcrypto -lz -lreadline -lncurses -ldl  -lffi -lgdbm -lyaml\"  EXTLDFLAGS=\"-L/usr/local/lib -L.  -L/var/tools/openssl/lib\" EXTINITS=\"socket cgi/escape continuation racc/cparse openssl ripper  objspace pty zlib etc fcntl dbm strscan fiber readline  digest digest/bubblebabble digest/md5 digest/rmd160  digest/sha1 digest/sha2 fiddle syslog date_core coverage  nkf gdbm io/console io/nonblock io/wait rbconfig/sizeof  psych json/ext/generator json/ext/parser stringio pathname  sdbm bigdecimal\"  UPDATE_LIBRARIES=\"no\" SHOWFLAGS= ruby\nmake: Fatal error: Command failed for target `ruby'\nCurrent working directory /usr/share/src/ruby-2.5.1\n*** Error code 1\nThe following command caused the error:\nmake -f exts.mk  libdir=\"/var/tools/ruby251/lib\" LIBRUBY_EXTS=./.libruby-with-ext.time \\\n    EXTENCS=\"enc/encinit.o enc/libenc.a enc/libtrans.a\" UPDATE_LIBRARIES=no static\nmake: Fatal error: Command failed for target `build-ext'\n</code></pre>\n\n<p>Can anyone help on this please? </p>\n"}, {"tags": ["ruby", "selenium-chromedriver", "export-to-csv", "watir", "roo-gem"], "comments": [{"owner": {"reputation": 44680, "user_id": 1200545, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbbfea5f6583c16f96fc11ef821cfeee?s=128&d=identicon&r=PG&f=1", "display_name": "Justin Ko", "link": "https://stackoverflow.com/users/1200545/justin-ko"}, "edited": false, "score": 0, "creation_date": 1536692977, "post_id": 52282329, "comment_id": 91513560, "body": "I&#39;m not sure I understand the question. The code should already return all of the text. At least it works when I run against the sample HTML - eg <code>search_results</code> equals <code>[&quot;FUJI 50mm lens\\nmore product info&quot;, &quot;FUJI 50mm lens\\nmore product info 2&quot;]</code>. Is there more to the page that would cause the code not to work?"}, {"owner": {"reputation": 45, "user_id": 8561357, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S3b2p.png?s=128&g=1", "display_name": "djangodev", "link": "https://stackoverflow.com/users/8561357/djangodev"}, "reply_to_user": {"reputation": 44680, "user_id": 1200545, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbbfea5f6583c16f96fc11ef821cfeee?s=128&d=identicon&r=PG&f=1", "display_name": "Justin Ko", "link": "https://stackoverflow.com/users/1200545/justin-ko"}, "edited": false, "score": 0, "creation_date": 1536693820, "post_id": 52282329, "comment_id": 91513907, "body": "Hey @justin-ko I actually just saw your comment on my other question after I posted this and that gave me what I needed to know. I had to include brackets around search_results <code>search_results = browser.divs(class: &quot;results_row&quot;).map(&amp;:text)  csv &lt;&lt; [search_results]</code>. For some reason I do not get all the div&#39;s text content when writing to csv unless the variable is specified in array format. Before I had <code>csv &lt;&lt; search_results</code>"}, {"owner": {"reputation": 44680, "user_id": 1200545, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbbfea5f6583c16f96fc11ef821cfeee?s=128&d=identicon&r=PG&f=1", "display_name": "Justin Ko", "link": "https://stackoverflow.com/users/1200545/justin-ko"}, "edited": false, "score": 0, "creation_date": 1536694742, "post_id": 52282329, "comment_id": 91514312, "body": "That&#39;s weird. I would only expect that to change how it gets written to CSV (not what was retrieved from the page). <code>csv &lt;&lt; [search_results]</code> should write all the text to a single cell, where as <code>csv &lt;&lt; search_results</code> would have split across multiple columns."}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 2, "creation_date": 1536697387, "post_id": 52282329, "comment_id": 91515559, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/52280347/how-to-write-method-to-csv-not-just-string-ruby-csv-gem\">How to write method to csv not just string? Ruby csv gem</a>"}, {"owner": {"reputation": 45, "user_id": 8561357, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S3b2p.png?s=128&g=1", "display_name": "djangodev", "link": "https://stackoverflow.com/users/8561357/djangodev"}, "reply_to_user": {"reputation": 44680, "user_id": 1200545, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbbfea5f6583c16f96fc11ef821cfeee?s=128&d=identicon&r=PG&f=1", "display_name": "Justin Ko", "link": "https://stackoverflow.com/users/1200545/justin-ko"}, "edited": false, "score": 0, "creation_date": 1536716079, "post_id": 52282329, "comment_id": 91520670, "body": "yeah @JustinKo it does get split across multiple columns without the array, but it only write the first two &#39;a&#39; tags text content"}], "owner": {"reputation": 45, "user_id": 8561357, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S3b2p.png?s=128&g=1", "display_name": "djangodev", "link": "https://stackoverflow.com/users/8561357/djangodev"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 131, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1536691335, "creation_date": 1536691335, "question_id": 52282329, "link": "https://stackoverflow.com/questions/52282329/how-to-write-all-text-content-from-div-element-to-csv-ruby-csv-chromedriver", "title": "How to write ALL text content from div element to csv? Ruby, csv, chromedriver, watir", "body": "<p>I am writing text content from a div element to a csv file using the ruby csv gem. When I output this div's text content to the console, I get all the text content including that from child divs. When I write to the csv file, it only outputs the text content from 'a' child elements. I need it to also include all the text from a child div and it's 'a' elements.\nHere is the HTML:</p>\n\n<pre><code>&lt;div class=\"bodytag\" style=\"padding-bottom:30px; overflow:visible\"&gt; \n&lt;h2&gt;Search Results for \"serialnum3\"&lt;/h2&gt;\n&lt;div id=\"results_banner\"&gt;\nProducts\n&lt;span&gt;Showing 1 to 2 of 2 results&lt;/span&gt;\n&lt;/div&gt;\n&lt;div class=\"pg_dir\"&gt;&lt;/div&gt;\n&lt;div class=\"results_row\"&gt;\n&lt;a href=\"/products/fuji/\" title=\"Fuji, Inc.\"&gt;FUJI&lt;/a&gt;\n&lt;a href=\"/products/fuji/50mm lens/\" title=\"Fuji, Inc.\"&gt;50mm lens&lt;/a&gt;\n&lt;div class=\"results_subrow\"&gt;\n    &lt;p&gt;more product info&lt;/p&gt;\n&lt;/div&gt;\n&lt;/div&gt;\n&lt;div class=\"results_row\"&gt;\n&lt;a href=\"/products/fuji/\" title=\"Fuji, Inc. 2\"&gt;FUJI&lt;/a&gt;\n&lt;a href=\"/products/fuji/50mm lens/\" title=\"Fuji, Inc.\"&gt;50mm lens&lt;/a&gt;\n&lt;div class=\"results_subrow\"&gt;\n    &lt;p&gt;more product info 2&lt;/p&gt;  \n&lt;/div&gt;\n</code></pre>\n\n<p></p>\n\n \n\n<p>Here is my code:</p>\n\n<pre><code> if\nbrowser.div(:class =&gt; \"results_row\").exists?\nsearch_results = browser.divs(class: \"results_row\").map(&amp;:text)\ncsv &lt;&lt; search_results\nelse\ncsv &lt;&lt; %w(\"no search results\")\nend\n</code></pre>\n\n<p>My end goal is to use the csv data as an excel column so if anyone knows an easier way I'd love to hear it! Right now I am successfully using roo to parse an excel column as an array for search terms. I would like to use roo to write the div element's text content in an adjacent column instead of writing to csv but couldn't figure out how to do it with roo.</p>\n"}, {"tags": ["ruby", "methods", "numbers"], "answers": [{"comments": [{"owner": {"reputation": 9663, "user_id": 5239030, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/76JEw.png?s=128&g=1", "display_name": "iGian", "link": "https://stackoverflow.com/users/5239030/igian"}, "edited": false, "score": 2, "creation_date": 1536691781, "post_id": 52282323, "comment_id": 91512970, "body": "<code>70304.digits # =&gt; [4, 0, 3, 0, 7]</code> already reversed. Just to remove zeroes: <code>num.digits.reverse.each_with_index.map {|val, idx| val == 0 ? nil : val * (10 ** idx)}.compact.reverse.join(&#39; + &#39;)</code>"}, {"owner": {"reputation": 55, "user_id": 10304624, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/43521d982e2df2eadd2a76b8a1d5b95d?s=128&d=identicon&r=PG&f=1", "display_name": "rhea.rao", "link": "https://stackoverflow.com/users/10304624/rhea-rao"}, "edited": false, "score": 0, "creation_date": 1536692852, "post_id": 52282323, "comment_id": 91513506, "body": "Thanks, I realized too after going through it again, I did a select method outside:"}, {"owner": {"reputation": 55, "user_id": 10304624, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/43521d982e2df2eadd2a76b8a1d5b95d?s=128&d=identicon&r=PG&f=1", "display_name": "rhea.rao", "link": "https://stackoverflow.com/users/10304624/rhea-rao"}, "edited": false, "score": 1, "creation_date": 1536692874, "post_id": 52282323, "comment_id": 91513514, "body": "num.digits.each_with_index.map{| val, idx | val * (10 ** idx)}.select{|x| x != 0}.reverse.join(&quot; + &quot;)"}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1536694092, "post_id": 52282323, "comment_id": 91514024, "body": "Updated with zero suppression added. The <code>if</code> returns <code>nil</code> if that condition is false."}, {"owner": {"reputation": 9971, "user_id": 8255744, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de22299534b5a8ed244ee8ff4aa6c481?s=128&d=identicon&r=PG&f=1", "display_name": "Simple Lime", "link": "https://stackoverflow.com/users/8255744/simple-lime"}, "reply_to_user": {"reputation": 55, "user_id": 10304624, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/43521d982e2df2eadd2a76b8a1d5b95d?s=128&d=identicon&r=PG&f=1", "display_name": "rhea.rao", "link": "https://stackoverflow.com/users/10304624/rhea-rao"}, "edited": false, "score": 2, "creation_date": 1536697789, "post_id": 52282323, "comment_id": 91515698, "body": "in @rhea.rao comment: <code>select { |x| x != 0 }</code> could also just be <code>reject(&amp;:zero?)</code>, which imo is much cleaner...in the answer itself <code>each_with_index.map</code> could just be <code>map.with_index</code> and <code>digits.reverse</code> needs to just be <code>digits</code>"}], "tags": [], "owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "is_accepted": true, "score": 2, "last_activity_date": 1536694082, "last_edit_date": 1536694082, "creation_date": 1536691302, "answer_id": 52282323, "question_id": 52282186, "link": "https://stackoverflow.com/questions/52282186/write-number-in-expanded-form-ruby-not-printing-out-zeros/52282323#52282323", "title": "Write Number in Expanded Form - Ruby NOT Printing Out Zeros", "body": "<p><code>each_with_index</code> doesn't transform anything, it just iterates, so the result of <code>val * (10 ** idx)</code> is discarded.</p>\n\n<p>What you need is to <code>map</code> this:</p>\n\n<pre><code>def expanded_form(num)\n  num.digits.reverse.each_with_index.map do |val, idx|\n    if (val &gt; 0)\n      val * (10 ** idx)\n    end\n  end.compact.reverse.join(' + ')\nend\n</code></pre>\n\n<p>As <code>map</code> returns a new array you can skip the whole <code>Array.new</code> part and the <code>&lt;&lt;</code> insertion step which wasn't doing what you expected anyway.</p>\n"}, {"tags": [], "owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "is_accepted": false, "score": 1, "last_activity_date": 1611714952, "last_edit_date": 1611714952, "creation_date": 1536699878, "answer_id": 52284195, "question_id": 52282186, "link": "https://stackoverflow.com/questions/52282186/write-number-in-expanded-form-ruby-not-printing-out-zeros/52284195#52284195", "title": "Write Number in Expanded Form - Ruby NOT Printing Out Zeros", "body": "<p>Here is another solution</p>\n<pre><code>num.digits.each_with_index.with_object([]) do |(n,i),obj|\n  obj.unshift(&quot;#{n}#{'0' * i}&quot;) if n &gt; 0\nend.join(&quot; + &quot;)\n</code></pre>\n<p>Since digits is in reverse we build the <code>Array</code> in reverse using unshift.</p>\n<p>Since the final value is a <code>String</code> anyway we use <code>String#*</code> to add the needed zeros and we don't add the the zeros in to the <code>Array</code> at all.</p>\n<p>Or use <code>String#ljust</code> to zero pad the output</p>\n<pre><code>num.digits.each.with_index(1).with_object([]) do |(n,i),obj|\n  obj.unshift(n.to_s.ljust(i,'0')) if n &gt; 0\nend.join(&quot; + &quot;)\n</code></pre>\n"}], "owner": {"reputation": 55, "user_id": 10304624, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/43521d982e2df2eadd2a76b8a1d5b95d?s=128&d=identicon&r=PG&f=1", "display_name": "rhea.rao", "link": "https://stackoverflow.com/users/10304624/rhea-rao"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 483, "favorite_count": 0, "accepted_answer_id": 52282323, "answer_count": 2, "score": 0, "last_activity_date": 1611714952, "creation_date": 1536690806, "last_edit_date": 1536693033, "question_id": 52282186, "link": "https://stackoverflow.com/questions/52282186/write-number-in-expanded-form-ruby-not-printing-out-zeros", "title": "Write Number in Expanded Form - Ruby NOT Printing Out Zeros", "body": "<p>Was practicing this question on Codewars: </p>\n\n<p>You will be given a number and you will need to return it as a string in Expanded Form. For example:</p>\n\n<pre><code>expanded_form(12); # Should return '10 + 2'\nexpanded_form(42); # Should return '40 + 2'\nexpanded_form(70304); # Should return '70000 + 300 + 4'\n</code></pre>\n\n<p>My code:</p>\n\n<pre><code>def expanded_form(num)\n  arry = Array.new\n  arry &lt;&lt; num.digits.reverse.each_with_index {|val, idx| val * (10 ** idx)} \n  arry.reverse.join(\" + \")\nend\n</code></pre>\n\n<p>I was testing it against the examples listed above, but I got back <code>\"1 + 2\"</code>, <code>\"4 + 2\"</code>, <code>\"7 + 3 + 4\"</code>, why doesn't the <code>each_with_index</code> seem to work?</p>\n\n<p><strong>Edited 3:03 pm, Sep 11, 2018:</strong>\nI fixed all above mistakes, including removing zeros, and as @iGian pointed out, the .digits method already reverse all the numbers, what I have right now:</p>\n\n<pre><code>def expanded_form(num)\n  num.digits.each_with_index.map{| val, idx | val * (10 ** idx)}.select{|x| x != 0}.reverse.join(\" + \")\nend\n</code></pre>\n\n<p>Cheers!</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-4", "geocoder"], "comments": [{"owner": {"reputation": 32131, "user_id": 2346461, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/i3xAf.jpg?s=128&g=1", "display_name": "Pavan", "link": "https://stackoverflow.com/users/2346461/pavan"}, "edited": false, "score": 0, "creation_date": 1536690522, "post_id": 52282072, "comment_id": 91512273, "body": "What does the <code>request</code> contain?"}, {"owner": {"reputation": 1560, "user_id": 5614748, "user_type": "registered", "accept_rate": 68, "profile_image": "https://graph.facebook.com/10153324566173505/picture?type=large", "display_name": "Afolabi Olaoluwa Akinwumi", "link": "https://stackoverflow.com/users/5614748/afolabi-olaoluwa-akinwumi"}, "reply_to_user": {"reputation": 32131, "user_id": 2346461, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/i3xAf.jpg?s=128&g=1", "display_name": "Pavan", "link": "https://stackoverflow.com/users/2346461/pavan"}, "edited": false, "score": 0, "creation_date": 1536690725, "post_id": 52282072, "comment_id": 91512381, "body": "Honestly I don&#39;t even know, neither do I know how to check what <code>request</code> contain."}, {"owner": {"reputation": 32131, "user_id": 2346461, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/i3xAf.jpg?s=128&g=1", "display_name": "Pavan", "link": "https://stackoverflow.com/users/2346461/pavan"}, "edited": false, "score": 0, "creation_date": 1536690842, "post_id": 52282072, "comment_id": 91512458, "body": "Just do <code>raise request.inspect</code> inside the <code>save_signup_history</code> method and paste the output in the question"}, {"owner": {"reputation": 3467, "user_id": 3393308, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9a3f30f7c191e8d556c70c951fe3d9af?s=128&d=identicon&r=PG", "display_name": "yorodm", "link": "https://stackoverflow.com/users/3393308/yorodm"}, "edited": false, "score": 0, "creation_date": 1536690908, "post_id": 52282072, "comment_id": 91512488, "body": "Is this data from you accessing your app via localhost?"}, {"owner": {"reputation": 1560, "user_id": 5614748, "user_type": "registered", "accept_rate": 68, "profile_image": "https://graph.facebook.com/10153324566173505/picture?type=large", "display_name": "Afolabi Olaoluwa Akinwumi", "link": "https://stackoverflow.com/users/5614748/afolabi-olaoluwa-akinwumi"}, "edited": false, "score": 0, "creation_date": 1536690946, "post_id": 52282072, "comment_id": 91512515, "body": "Yes from localhost"}], "answers": [{"comments": [{"owner": {"reputation": 1560, "user_id": 5614748, "user_type": "registered", "accept_rate": 68, "profile_image": "https://graph.facebook.com/10153324566173505/picture?type=large", "display_name": "Afolabi Olaoluwa Akinwumi", "link": "https://stackoverflow.com/users/5614748/afolabi-olaoluwa-akinwumi"}, "edited": false, "score": 0, "creation_date": 1536701063, "post_id": 52284274, "comment_id": 91517029, "body": "But I already have the IP save into the database using <code>ip: request.ip</code>. Am trying to get location such as you signin in from New York, and it records New York, and if signing in from London, it records London"}, {"owner": {"reputation": 2072, "user_id": 3389795, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LiAJt.jpg?s=128&g=1", "display_name": "Shiko", "link": "https://stackoverflow.com/users/3389795/shiko"}, "reply_to_user": {"reputation": 1560, "user_id": 5614748, "user_type": "registered", "accept_rate": 68, "profile_image": "https://graph.facebook.com/10153324566173505/picture?type=large", "display_name": "Afolabi Olaoluwa Akinwumi", "link": "https://stackoverflow.com/users/5614748/afolabi-olaoluwa-akinwumi"}, "edited": false, "score": 0, "creation_date": 1536701160, "post_id": 52284274, "comment_id": 91517058, "body": "@AfolabiOlaoluwaAkinwumi I thought you are having issue with IP as I can you are showing localhost IP"}, {"owner": {"reputation": 2072, "user_id": 3389795, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LiAJt.jpg?s=128&g=1", "display_name": "Shiko", "link": "https://stackoverflow.com/users/3389795/shiko"}, "reply_to_user": {"reputation": 1560, "user_id": 5614748, "user_type": "registered", "accept_rate": 68, "profile_image": "https://graph.facebook.com/10153324566173505/picture?type=large", "display_name": "Afolabi Olaoluwa Akinwumi", "link": "https://stackoverflow.com/users/5614748/afolabi-olaoluwa-akinwumi"}, "edited": false, "score": 0, "creation_date": 1536701205, "post_id": 52284274, "comment_id": 91517072, "body": "@AfolabiOlaoluwaAkinwumi you need to use a service like <a href=\"https://www.iplocation.net/\" rel=\"nofollow noreferrer\">iplocation.net</a> to get the location of IP addresses you have"}, {"owner": {"reputation": 1560, "user_id": 5614748, "user_type": "registered", "accept_rate": 68, "profile_image": "https://graph.facebook.com/10153324566173505/picture?type=large", "display_name": "Afolabi Olaoluwa Akinwumi", "link": "https://stackoverflow.com/users/5614748/afolabi-olaoluwa-akinwumi"}, "edited": false, "score": 0, "creation_date": 1536701652, "post_id": 52284274, "comment_id": 91517218, "body": "Can you show example using iplocation.net without loosing my request params fro the id?"}, {"owner": {"reputation": 1560, "user_id": 5614748, "user_type": "registered", "accept_rate": 68, "profile_image": "https://graph.facebook.com/10153324566173505/picture?type=large", "display_name": "Afolabi Olaoluwa Akinwumi", "link": "https://stackoverflow.com/users/5614748/afolabi-olaoluwa-akinwumi"}, "edited": false, "score": 0, "creation_date": 1536704006, "post_id": 52284274, "comment_id": 91517998, "body": "okay I see your very beautiful update. Thank you. So, if I need to return <code>regionName</code> and <code>country</code> I can do <code>result[&quot;regionName&quot;] &amp;&amp; result[&quot;country&quot;]</code> ? Such that I can have <code>New York, United States</code> saved in the database."}, {"owner": {"reputation": 2072, "user_id": 3389795, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LiAJt.jpg?s=128&g=1", "display_name": "Shiko", "link": "https://stackoverflow.com/users/3389795/shiko"}, "reply_to_user": {"reputation": 1560, "user_id": 5614748, "user_type": "registered", "accept_rate": 68, "profile_image": "https://graph.facebook.com/10153324566173505/picture?type=large", "display_name": "Afolabi Olaoluwa Akinwumi", "link": "https://stackoverflow.com/users/5614748/afolabi-olaoluwa-akinwumi"}, "edited": false, "score": 0, "creation_date": 1536704122, "post_id": 52284274, "comment_id": 91518040, "body": "@AfolabiOlaoluwaAkinwumi you can change last line from <code>result[&quot;regionName&quot;]</code> to <code>&quot;#{result[&#39;country&#39;]},#{result[&#39;regionName&#39;]}&quot;</code>"}, {"owner": {"reputation": 1560, "user_id": 5614748, "user_type": "registered", "accept_rate": 68, "profile_image": "https://graph.facebook.com/10153324566173505/picture?type=large", "display_name": "Afolabi Olaoluwa Akinwumi", "link": "https://stackoverflow.com/users/5614748/afolabi-olaoluwa-akinwumi"}, "edited": false, "score": 0, "creation_date": 1536704668, "post_id": 52284274, "comment_id": 91518219, "body": "Yes I surely will do that. Thank you so much."}], "tags": [], "owner": {"reputation": 2072, "user_id": 3389795, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LiAJt.jpg?s=128&g=1", "display_name": "Shiko", "link": "https://stackoverflow.com/users/3389795/shiko"}, "is_accepted": true, "score": 1, "last_activity_date": 1536704358, "last_edit_date": 1536704358, "creation_date": 1536700252, "answer_id": 52284274, "question_id": 52282072, "link": "https://stackoverflow.com/questions/52282072/saving-login-location-into-the-database-of-my-rails-app/52284274#52284274", "title": "Saving login location into the database of my rails app", "body": "<p>You can use <code>request.remote_ip</code> to get the IP address.\nTO get the location of IP address saved in DB, you can use one of the free API services that fetch location information based on IP:<br>\n - <a href=\"http://ip-api.com/\" rel=\"nofollow noreferrer\">http://ip-api.com/</a><br>\n - <a href=\"https://www.iplocation.net/\" rel=\"nofollow noreferrer\">https://www.iplocation.net/</a><br>\n - etc..</p>\n\n<pre><code>class SessionsController &lt; ApplicationController\n\n  require 'net/http'\n  require 'json'\n\n  def save_signup_history(member_id)\n    SignupHistory.create(\n        member_id: member_id,\n        ip: request.ip,\n        accept_language: request.headers[\"Accept-Language\"],\n        ua: request.headers[\"User-Agent\"],\n        login_location: get_address(request.remote_ip)\n    )\n  end\n\n\n#http://ip-api.com/json/208.80.152.201\n  def get_address(ip)\n    url = \"http://ip-api.com/json/#{ip}\"\n    uri = URI(url)\n    response = Net::HTTP.get(uri)\n    result = JSON.parse(response)\n    result[\"regionName\"] # returns region name \n  end\nend\n</code></pre>\n\n<p><strong>JSON Response:</strong>  </p>\n\n<pre><code>{\n\"as\":\"AS14907 Wikimedia Foundation, Inc.\",\n\"city\":\"San Francisco (South Beach)\",\n\"country\":\"United States\",\n\"countryCode\":\"US\",\n\"isp\":\"Wikimedia Foundation, Inc.\",\n\"lat\":37.787,\n\"lon\":-122.4,\n\"org\":\"Wikimedia Foundation, Inc.\",\n\"query\":\"208.80.152.201\",\n\"region\":\"\",\n\"regionName\":\"California\",\n\"status\":\"success\",\n\"timezone\":\"America/Los_Angeles\",\n\"zip\":\"94105\"\n}\n</code></pre>\n\n<p><strong>Reference:</strong><br>\n<a href=\"https://apidock.com/rails/ActionController/Request/remote_ip\" rel=\"nofollow noreferrer\">https://apidock.com/rails/ActionController/Request/remote_ip</a> </p>\n"}], "owner": {"reputation": 1560, "user_id": 5614748, "user_type": "registered", "accept_rate": 68, "profile_image": "https://graph.facebook.com/10153324566173505/picture?type=large", "display_name": "Afolabi Olaoluwa Akinwumi", "link": "https://stackoverflow.com/users/5614748/afolabi-olaoluwa-akinwumi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 118, "favorite_count": 0, "accepted_answer_id": 52284274, "answer_count": 1, "score": 0, "last_activity_date": 1536704358, "creation_date": 1536690332, "question_id": 52282072, "link": "https://stackoverflow.com/questions/52282072/saving-login-location-into-the-database-of-my-rails-app", "title": "Saving login location into the database of my rails app", "body": "<p>When I sign into the application, the code below gets called. So inside the SessionsController, SignupHistory table gets populated with the <code>.create</code> method.</p>\n\n<p><strong>application_controller.rb</strong></p>\n\n<pre><code>class ApplicationController &lt; ActionController::Base\n  protect_from_forgery with: :exception\n\n  helper_method :current_user\n  before_action :set_timezone, :current_country\n\n  def current_country\n    if session[:ip_country_code].present?\n      return @current_country = session[:ip_country_code]\n    end\n    use_default = request.location.nil? || request.location.country_code.blank? || request.location.country_code == 'RD'\n    country_code = use_default ? ENV['DEFAULT_IP_COUNTRY_CODE'] : request.location.country_code\n    @current_country = session[:ip_country_code] = country_code\n  end\nend\n</code></pre>\n\n<p><strong>sessions_controller.rb</strong></p>\n\n<pre><code>class SessionsController &lt; ApplicationController\n  def save_signup_history(member_id)\n    SignupHistory.create(\n      member_id: member_id,\n      ip: request.ip,\n      accept_language: request.headers[\"Accept-Language\"],\n      ua: request.headers[\"User-Agent\"],\n      login_location: request.location\n    )\n  end\nend\n</code></pre>\n\n<p><strong>database attributes</strong></p>\n\n<p><a href=\"https://i.stack.imgur.com/rlB18.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/rlB18.png\" alt=\"databse\"></a></p>\n\n<p>However, instead of the line <code>login_location: request.location</code> to write the location of the IP signing in into the database such as <code>New York</code>, what I get in the database is: </p>\n\n<blockquote>\n  <p>--- !ruby/object:Geocoder::Result::Ipstack data: ip: 127.0.0.1 country_name: Reserved country_code: RD cache_hit:</p>\n</blockquote>\n\n<p><strong>How do I save location based on the IP signing in into my database</strong></p>\n"}, {"tags": ["ruby", "elasticsearch"], "answers": [{"comments": [{"owner": {"reputation": 1978, "user_id": 1222355, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/44e0773345e9065b2e012b434370dbbb?s=128&d=identicon&r=PG", "display_name": "David West", "link": "https://stackoverflow.com/users/1222355/david-west"}, "edited": false, "score": 0, "creation_date": 1536872445, "post_id": 52285585, "comment_id": 91591121, "body": "What about single quotes and colons. Do those need to be escaped? Maybe that happens as part of changing things to be valid JSON."}, {"owner": {"reputation": 9, "user_id": 6680726, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-fmVq6bNXAso/AAAAAAAAAAI/AAAAAAAAAPw/Zc3FAxcJnJY/photo.jpg?sz=128", "display_name": "Nikunj Bhalla", "link": "https://stackoverflow.com/users/6680726/nikunj-bhalla"}, "reply_to_user": {"reputation": 1978, "user_id": 1222355, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/44e0773345e9065b2e012b434370dbbb?s=128&d=identicon&r=PG", "display_name": "David West", "link": "https://stackoverflow.com/users/1222355/david-west"}, "edited": false, "score": 0, "creation_date": 1536986072, "post_id": 52285585, "comment_id": 91629917, "body": "Correct, those are all part of creating a paresable JSON. If your code builds a good JSON, elastic search would parse it."}], "tags": [], "owner": {"reputation": 9, "user_id": 6680726, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-fmVq6bNXAso/AAAAAAAAAAI/AAAAAAAAAPw/Zc3FAxcJnJY/photo.jpg?sz=128", "display_name": "Nikunj Bhalla", "link": "https://stackoverflow.com/users/6680726/nikunj-bhalla"}, "is_accepted": false, "score": 0, "last_activity_date": 1536709813, "creation_date": 1536709813, "answer_id": 52285585, "question_id": 52281691, "link": "https://stackoverflow.com/questions/52281691/tokenizing-data-to-send-into-elasticsearch-bulk-with-standard-library-ruby/52285585#52285585", "title": "Tokenizing Data to send into Elasticsearch bulk with standard library Ruby", "body": "<p>Firstly, the only valid kind of data you send to ES is the one that's JSON. So all you need to take care is, how you create a valid JSON, as that's the only thing ES deals in.</p>\n\n<p>That being said, one of the most common scenario when data gets errored out, is when you define an index mapping/templates yourself while creating the index, and set the data type of all the fields before hand. Now the data you are posting to ES doesn't follow that data type, it will error out while converting.</p>\n\n<p>Hope it helps.</p>\n"}], "owner": {"reputation": 1978, "user_id": 1222355, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/44e0773345e9065b2e012b434370dbbb?s=128&d=identicon&r=PG", "display_name": "David West", "link": "https://stackoverflow.com/users/1222355/david-west"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 28, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1536709813, "creation_date": 1536688762, "question_id": 52281691, "link": "https://stackoverflow.com/questions/52281691/tokenizing-data-to-send-into-elasticsearch-bulk-with-standard-library-ruby", "title": "Tokenizing Data to send into Elasticsearch bulk with standard library Ruby", "body": "<p>I want to use some plain old ruby to send valid data to Elasticsearch so it won't error. Are there guidelines for what I need, code snippets, or standard safe formats I can put my data in so that it won't error when I send it to Elasticsearch?</p>\n\n<p>If there is a library that you want to recommend I may consider it if it has a method that takes a string and outputs something safe I can send to Elasticsearch, but I would like to look at the source and minimize unneeded dependencies. I can make a bare bones version from the source.</p>\n\n<p>Thanks.</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 9663, "user_id": 5239030, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/76JEw.png?s=128&g=1", "display_name": "iGian", "link": "https://stackoverflow.com/users/5239030/igian"}, "edited": false, "score": 0, "creation_date": 1536690987, "post_id": 52280728, "comment_id": 91512542, "body": "Please fix some (if then else) syntax to let user run your code. For process in parallel: <a href=\"https://stackoverflow.com/questions/15782492/how-to-run-two-methods-in-parallel-ruby\" title=\"how to run two methods in parallel ruby\">stackoverflow.com/questions/15782492/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 139, "user_id": 8967338, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-psqz4dfuuUE/AAAAAAAAAAI/AAAAAAAAFfw/inGPHJmghNs/photo.jpg?sz=128", "display_name": "Eric Christensen", "link": "https://stackoverflow.com/users/8967338/eric-christensen"}, "edited": false, "score": 0, "creation_date": 1536688730, "post_id": 52281630, "comment_id": 91511343, "body": "I found found this method while searching:  t1 = Thread.new{esxitest()} t2 = Thread.new{proxytest()} t3 = Thread.new{domaintest()} t1.join t2.join t3.join  And that starts them all together"}, {"owner": {"reputation": 14827, "user_id": 645886, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2abb0123e9484284a9cb2d36aa9854b3?s=128&d=identicon&r=PG&f=1", "display_name": "Surya", "link": "https://stackoverflow.com/users/645886/surya"}, "edited": false, "score": 0, "creation_date": 1536689031, "post_id": 52281630, "comment_id": 91511506, "body": "@dennisvandehoef - Good point. I think OP wants them to execute them concurrently. Can you think of how that can be done via Threads? Probably also point out that OP should remove <code>loop</code> from other methods as well and all are moved under one method instead?"}, {"owner": {"reputation": 14827, "user_id": 645886, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2abb0123e9484284a9cb2d36aa9854b3?s=128&d=identicon&r=PG&f=1", "display_name": "Surya", "link": "https://stackoverflow.com/users/645886/surya"}, "edited": false, "score": 0, "creation_date": 1536689133, "post_id": 52281630, "comment_id": 91511558, "body": "@dennisvandehoef - Also I would suggest avoid putting questions in your answer to OP. For any clarifications/questions write a comment in comments section below the question/post."}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "reply_to_user": {"reputation": 139, "user_id": 8967338, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-psqz4dfuuUE/AAAAAAAAAAI/AAAAAAAAFfw/inGPHJmghNs/photo.jpg?sz=128", "display_name": "Eric Christensen", "link": "https://stackoverflow.com/users/8967338/eric-christensen"}, "edited": false, "score": 0, "creation_date": 1536689614, "post_id": 52281630, "comment_id": 91511800, "body": "@EricChristensen neither that nor this answer will run &quot;in parallel&quot;. This answer will run them in order and using threads will technically just use a scheduling algorithm to swap between threads but they will run concurrently which for this case seems more than sufficient"}, {"owner": {"reputation": 139, "user_id": 8967338, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-psqz4dfuuUE/AAAAAAAAAAI/AAAAAAAAFfw/inGPHJmghNs/photo.jpg?sz=128", "display_name": "Eric Christensen", "link": "https://stackoverflow.com/users/8967338/eric-christensen"}, "edited": false, "score": 0, "creation_date": 1536689806, "post_id": 52281630, "comment_id": 91511890, "body": "@enginnersmnky oh okay; thanks for the clarification. Sorry, I am very new to ruby and coding in general."}], "tags": [], "owner": {"reputation": 570, "user_id": 5600652, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/274096d1a68cf5740240b6ffb789c5c7?s=128&d=identicon&r=PG", "display_name": "Dennis van de Hoef", "link": "https://stackoverflow.com/users/5600652/dennis-van-de-hoef"}, "is_accepted": false, "score": 1, "last_activity_date": 1536688493, "creation_date": 1536688493, "answer_id": 52281630, "question_id": 52280728, "link": "https://stackoverflow.com/questions/52280728/is-there-a-way-to-run-three-looping-ruby-methods-at-the-same-time-in-parallel/52281630#52281630", "title": "Is there a way to run three looping ruby methods at the same time (in parallel)?", "body": "<p>when I first look at your code I have 2 questions:</p>\n\n<p>1) How are you staring this code, would it not be easier to start each monitoring as its own process?</p>\n\n<p>2) I see 3 methods containing a loop, why not move the loop to a surrounding method?</p>\n\n<pre><code>def do_tests\n  loop do\n    esxitest\n    proxytest\n    domaintest\n    sleep(10)\n  end\nend\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 97, "user_id": 6927514, "user_type": "registered", "profile_image": "https://graph.facebook.com/1417569534938796/picture?type=large", "display_name": "Harsimar Sandhu", "link": "https://stackoverflow.com/users/6927514/harsimar-sandhu"}, "is_accepted": false, "score": 0, "last_activity_date": 1536818612, "creation_date": 1536818612, "answer_id": 52307524, "question_id": 52280728, "link": "https://stackoverflow.com/questions/52280728/is-there-a-way-to-run-three-looping-ruby-methods-at-the-same-time-in-parallel/52307524#52307524", "title": "Is there a way to run three looping ruby methods at the same time (in parallel)?", "body": "<p>you can use multi-threading for this purpose. Basically, Thread is used to achieve parallelism.</p>\n\n<p>here, it's a good read <a href=\"https://www.tutorialspoint.com/ruby/ruby_multithreading.htm\" rel=\"nofollow noreferrer\">https://www.tutorialspoint.com/ruby/ruby_multithreading.htm</a></p>\n"}], "owner": {"reputation": 139, "user_id": 8967338, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-psqz4dfuuUE/AAAAAAAAAAI/AAAAAAAAFfw/inGPHJmghNs/photo.jpg?sz=128", "display_name": "Eric Christensen", "link": "https://stackoverflow.com/users/8967338/eric-christensen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 338, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1536818612, "creation_date": 1536684704, "last_edit_date": 1536687994, "question_id": 52280728, "link": "https://stackoverflow.com/questions/52280728/is-there-a-way-to-run-three-looping-ruby-methods-at-the-same-time-in-parallel", "title": "Is there a way to run three looping ruby methods at the same time (in parallel)?", "body": "<p>So I am working on making a script that runs pings on network devices then alerts me by email if a device goes offline. And the script works perfectly! </p>\n\n<p>But I want to be able to run multiple of these methods at the same time. Here are the three methods (they are calling other methods, so just ignore that).</p>\n\n<p>But I want to be able to run these loop methods all at the same time.</p>\n\n<pre><code>def esxitest\n    loop do\n    test = system \"ping -c 4 192.168.1.229\"\n    puts test\n        if test == false \n            test2 = system \"ping -c 4 192.168.1.229\"\n            puts test2\n                if test2 == false\n                    sendalert1\n                    break\n                else\n                end\n        end\n    else test == true\n    sleep(10) #300\n    end\nend\n\ndef proxytest\n    loop do\n    test = system \"ping -c 4 192.168.1.226\"\n    puts test\n        if test == false \n            test2 = system \"ping -c 4 192.168.1.226\"\n            puts test2\n                if test2 == false\n                    sendalert2\n                    break\n                else\n                end\n        end\n    else test == true\n    sleep(20) #300\n    end\nend\n\ndef domaintest\n    loop do\n    test = system \"ping -c 4 192.168.1.227\"\n    puts test\n        if test == false \n            test2 = system \"ping -c 4 192.168.1.227\"\n            puts test2\n                if test2 == false\n                    sendalert3\n                    break\n                else\n                end\n        end\n    else test == true\n    sleep(30) #300\n    end\nend\n</code></pre>\n"}, {"tags": ["ruby", "factory-bot"], "comments": [{"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 1, "creation_date": 1536684838, "post_id": 52280552, "comment_id": 91509487, "body": "Why not use <code>let!(:user)</code> this forces invocation before each example."}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 2, "creation_date": 1536685143, "post_id": 52280552, "comment_id": 91509641, "body": "&quot;I want to shorten to this&quot; - in that snippet, <code>user_attributes</code> is not defined. And if you add it, code becomes just about the same length and complexity as the other snippet."}, {"owner": {"reputation": 383, "user_id": 3985721, "user_type": "registered", "accept_rate": 15, "profile_image": "https://www.gravatar.com/avatar/9bee4235ea6f190c87d8162dfcc75009?s=128&d=identicon&r=PG&f=1", "display_name": "Josh Hadik", "link": "https://stackoverflow.com/users/3985721/josh-hadik"}, "reply_to_user": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1536685300, "post_id": 52280552, "comment_id": 91509708, "body": "@SergioTulentsev, right, my hope is that something like &quot;user.factory_attributes&quot; (which isn&#39;t a real method) could be used to replace the need for explicitly defining the attributes."}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 1, "creation_date": 1536685713, "post_id": 52280552, "comment_id": 91509899, "body": "@JoshHadik: what? That would make those two declarations mutually dependent (and therefore impossible)."}, {"owner": {"reputation": 383, "user_id": 3985721, "user_type": "registered", "accept_rate": 15, "profile_image": "https://www.gravatar.com/avatar/9bee4235ea6f190c87d8162dfcc75009?s=128&d=identicon&r=PG&f=1", "display_name": "Josh Hadik", "link": "https://stackoverflow.com/users/3985721/josh-hadik"}, "reply_to_user": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1536685808, "post_id": 52280552, "comment_id": 91509951, "body": "@SergioTulentsev that&#39;s my bad, I forgot to remove the user_attributes variable from when I copied the let(:user) statement. Just updated."}], "answers": [{"comments": [{"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1536684570, "post_id": 52280647, "comment_id": 91509341, "body": "However this might need a bit of cleaning given id, timestamps, etc. would be included in <code>attributes</code> where as <code>attributes_for</code> will just be a <code>Hash</code> of the factory defined attributes"}, {"owner": {"reputation": 383, "user_id": 3985721, "user_type": "registered", "accept_rate": 15, "profile_image": "https://www.gravatar.com/avatar/9bee4235ea6f190c87d8162dfcc75009?s=128&d=identicon&r=PG&f=1", "display_name": "Josh Hadik", "link": "https://stackoverflow.com/users/3985721/josh-hadik"}, "edited": false, "score": 0, "creation_date": 1536684847, "post_id": 52280647, "comment_id": 91509497, "body": "Normally, this works. The problem is that I&#39;m trying to access virtual attributes from  Factory that don&#39;t actually exist on the User model (&#39;password&#39; and &#39;password_confirmation,&#39;) and #attributes only returns the actual attributes defined in the ActiveRecord model"}, {"owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "reply_to_user": {"reputation": 383, "user_id": 3985721, "user_type": "registered", "accept_rate": 15, "profile_image": "https://www.gravatar.com/avatar/9bee4235ea6f190c87d8162dfcc75009?s=128&d=identicon&r=PG&f=1", "display_name": "Josh Hadik", "link": "https://stackoverflow.com/users/3985721/josh-hadik"}, "edited": false, "score": 0, "creation_date": 1536685290, "post_id": 52280647, "comment_id": 91509702, "body": "@JoshHadik I updated my answer to address your comment."}], "tags": [], "owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "is_accepted": false, "score": 2, "last_activity_date": 1536687688, "last_edit_date": 1536687688, "creation_date": 1536684359, "answer_id": 52280647, "question_id": 52280552, "link": "https://stackoverflow.com/questions/52280552/how-can-i-generate-attributes-for-an-already-created-factory/52280647#52280647", "title": "How can I generate :attributes_for an already created Factory?", "body": "<p><code>FactoryBot.build(:user)</code> returns an instance of an <code>ActiveRecord</code> model. Therefore you can just use <a href=\"https://api.rubyonrails.org/v5.1/classes/ActiveRecord/AttributeMethods.html#method-i-attributes\" rel=\"nofollow noreferrer\"><code>ActiveRecord::Base#attributes</code></a> to return the list of attributes of the current object:</p>\n\n<pre><code>@user = FactoryBot.build(:user)\n@user.attributes\n</code></pre>\n\n<p>Once the factory returned an instance of <code>User</code> that <code>user</code> has no information anymore about how it was initialized. Therefore it is impossible to read values that do not exist on the instance. </p>\n\n<p>A workaround might be something like this:</p>\n\n<pre><code>let(:parameters) do\n  { user: FactoryBot.attributes_for(:user) }\nend\n\nbefore do\n  FactoryBot.create(:user, parameters[:user])\nend\n\nit \"redirects to the root path on successful sign in\" do\n  post user_session_path(params: parameters)\n  expect(response).to redirect_to(root_path)\nend\n</code></pre>\n\n<p>But actually, I think you should be more explicit about what attributes you really care about. You care about the user's email and user's password - all other attributes are not relevant in this spec. Therefore I would write the spec like this:</p>\n\n<pre><code>let(:email) { 'foobar@example.tld' }\nlet(:password) { 'secret' }\n\nbefore do\n  FactoryBot.create(:user, email: email, password: password, password_confirmation: password)\nend\n\nit \"redirects to the root path on successful sign in\" do\n  post user_session_path(params: { user: { email: email, password: password } })\n  expect(response).to redirect_to(root_path)\nend\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 383, "user_id": 3985721, "user_type": "registered", "accept_rate": 15, "profile_image": "https://www.gravatar.com/avatar/9bee4235ea6f190c87d8162dfcc75009?s=128&d=identicon&r=PG&f=1", "display_name": "Josh Hadik", "link": "https://stackoverflow.com/users/3985721/josh-hadik"}, "edited": false, "score": 1, "creation_date": 1536687402, "post_id": 52281046, "comment_id": 91510687, "body": "Yeah no your right. The whole idea was based on a misconception of how FactoryBot works, in particular for some reason I was thinking that FactoryBot was setting a few variables that a completely different gem (Devise) was actually responsible for. Goes to show the &#39;magic&#39; of Rails can screw you over if you get lazy with it. Thanks. While this didn&#39;t specifically answer my question (which I now realize made no sense in the first place,) it did help me out a lot in understanding how FactoryBot actually works, so I&#39;ll set this as the accepted answer."}], "tags": [], "owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "is_accepted": true, "score": 1, "last_activity_date": 1536686062, "creation_date": 1536686062, "answer_id": 52281046, "question_id": 52280552, "link": "https://stackoverflow.com/questions/52280552/how-can-i-generate-attributes-for-an-already-created-factory/52281046#52281046", "title": "How can I generate :attributes_for an already created Factory?", "body": "<blockquote>\n  <p>Is there any easy way to access the 'virtual attributes' for an already built factory?</p>\n</blockquote>\n\n<p>I think you are confused about terminology and/or how factory bot works. You don't build <strong>factories</strong>. Factory already exists and it builds <strong>users</strong> (in this case). </p>\n\n<p>After a user is built/created, it has no knowledge of what factory built it. And rightly so. Users can be created in many ways. If that method did actually exist, what would you expect it to return when you create a user with <code>User.create</code>?</p>\n"}], "owner": {"reputation": 383, "user_id": 3985721, "user_type": "registered", "accept_rate": 15, "profile_image": "https://www.gravatar.com/avatar/9bee4235ea6f190c87d8162dfcc75009?s=128&d=identicon&r=PG&f=1", "display_name": "Josh Hadik", "link": "https://stackoverflow.com/users/3985721/josh-hadik"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 162, "favorite_count": 0, "accepted_answer_id": 52281046, "answer_count": 2, "score": 0, "last_activity_date": 1536687688, "creation_date": 1536683929, "last_edit_date": 1536687634, "question_id": 52280552, "link": "https://stackoverflow.com/questions/52280552/how-can-i-generate-attributes-for-an-already-created-factory", "title": "How can I generate :attributes_for an already created Factory?", "body": "<p><strong>Update (Don't answer this)</strong></p>\n\n<p>I just learned that this question doesn't actually make sense. It was based on my own misconception of Factories and how they work.</p>\n\n<hr>\n\n<p>The whole idea was based on a misconception of how FactoryBot works, in particular for some reason I was thinking that FactoryBot was setting a few variables that a completely different gem (Devise) was actually responsible for.</p>\n\n<p>Is there any easy way to access the 'virtual attributes' for an already built factory?</p>\n\n<p>Something like :attributes_for, but used on an instance of a Factory instead of the class?</p>\n\n<p>So you could do something like this:</p>\n\n<pre><code>FactoryBot.define do\n  factory :user do\n    email { Faker::Internet.email }\n    password { \"password\" }\n    password_confirmation { \"password\" }\n  end\nend\n\n@user = FactoryBot.build(:user)\n\n@user.factory_attributes # Not a real method\n#-&gt; { email: \"name@gmail.com\", password: \"123456\", password_confirmation: \"123456\" }\n</code></pre>\n\n<hr>\n\n<p><strong>Why I Want This</strong> </p>\n\n<p>If you're wondering, I want this to be able to shorten the following code for a 'Login' request spec.</p>\n\n<p>From this:</p>\n\n<pre><code>let(:user_attributes) do\n  FactoryBot.attributes_for(:user)\nend\n\nlet(:user) do\n  FactoryBot.create(:user, user_attributes)\nend\n\n# Triggers the create method in let(:user)\n# Necessary to ensure the user exists in the database before testing sign in.\nbefore { user } \n\nlet(:user_params) do \n  { user: user_attributes }\nend\n\nit \"redirects to the root path on successful sign in\" do\n  post user_session_path(params: user_params)\n  expect(response).to redirect_to(root_path)\nend\n</code></pre>\n\n<p>To this:</p>\n\n<pre><code>let(:user) do\n  FactoryBot.create(:user)\nend\n\nlet(:user_params) do \n  { user: user.factory_attributes }\nend\n\nit \"redirects to the root path on successful sign in\" do\n  post user_session_path(params: user_params)\n  expect(response).to redirect_to(root_path)\nend\n</code></pre>\n\n<p>Which is significantly cleaner and less confusing than the first, especially for newer devs (could see someone with little RSpec experience spending quite some time trying to figure out just what in the hell the line \"before { user }\" is doing)</p>\n"}, {"tags": ["sql", "ruby", "string", "optimization"], "comments": [{"owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 0, "creation_date": 1536683804, "post_id": 52280467, "comment_id": 91508973, "body": "You are saying that your code basically works? What do you expect to improve? What are you optimizing for? Maintainability? Readability? Memory usage?"}, {"owner": {"reputation": 705, "user_id": 5327403, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/c293099c7e61e9c0396c0ca2d2e983f6?s=128&d=identicon&r=PG&f=1", "display_name": "FrankTheTank", "link": "https://stackoverflow.com/users/5327403/frankthetank"}, "reply_to_user": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 0, "creation_date": 1536683964, "post_id": 52280467, "comment_id": 91509048, "body": "Yes it currently works, it just seems to me like there is a way to make this process cleaner. Specifically, is there a better way to handle what I am doing beside just having a switch statement and manual symbol names passed as the parameters to WhQueryHelper.sql_query(). I have the Query strings in another module and not my class because it takes up too much space and is not clean. So readability and maintainability would be the main things I am wondering about."}, {"owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 0, "creation_date": 1536684217, "post_id": 52280467, "comment_id": 91509174, "body": "I would suggest storing each SQL query in a file on its own and name the files by their current <code>q_sym</code>. Than the code only needs to check if a file with that name exists and if it does then load its content."}, {"owner": {"reputation": 705, "user_id": 5327403, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/c293099c7e61e9c0396c0ca2d2e983f6?s=128&d=identicon&r=PG&f=1", "display_name": "FrankTheTank", "link": "https://stackoverflow.com/users/5327403/frankthetank"}, "reply_to_user": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 0, "creation_date": 1536684707, "post_id": 52280467, "comment_id": 91509405, "body": "Ya that would be a good work around and cleaner thanks"}, {"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 1, "creation_date": 1536685303, "post_id": 52280467, "comment_id": 91509711, "body": "For code that works but needs improvement (as opposed to code that doesn&#39;t work and needs fixing), the <a href=\"https://codereview.stackexchange.com\">Code Review</a> community is much better equipped."}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 1, "creation_date": 1536685587, "post_id": 52280467, "comment_id": 91509837, "body": "Why not just store the query strings as return values from method calls? e.g. <code>module WhQueryHelper; def self.qm_code; YOUR_QUERY_STRING_HERE; end; end</code> and then just use <code>qs = self.public_send(:qm_code)</code> ? You could also just use a large <code>Hash</code> of {code: &quot;query string&quot;} as a constant and then use <code>qs = YOUR_HASH[code]</code>"}], "owner": {"reputation": 705, "user_id": 5327403, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/c293099c7e61e9c0396c0ca2d2e983f6?s=128&d=identicon&r=PG&f=1", "display_name": "FrankTheTank", "link": "https://stackoverflow.com/users/5327403/frankthetank"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 34, "favorite_count": 1, "answer_count": 0, "score": 0, "last_activity_date": 1536683585, "creation_date": 1536683585, "question_id": 52280467, "link": "https://stackoverflow.com/questions/52280467/best-way-to-call-method-with-parameter-to-correspond-to-one-of-many-strings-rub", "title": "Best Way to Call Method With Parameter to Correspond to One of Many Strings (Ruby)", "body": "<p>I am trying to create a system where I call a method in a separate module from my class that executes an SQL query based on a string in that module. So for instance right now I am currently making a call in my WhLoan class as follows:</p>\n\n<p><strong>WhLoan Class</strong></p>\n\n<pre><code>qm_code = WhQueryHelper.sql_query(:qm_code)\n</code></pre>\n\n<p>that makes a call to a method in my WhQueryHelper module which contains strings that should be executed as an sql statement depending on what was passed, in my case this being symbol. How this is sorted out in my WhQueryHelper module can be seen below:</p>\n\n<p><strong>WhQueryHelper Module</strong></p>\n\n<pre><code>  QUALIFIED_MORTGAGE_TYPE_QUERY = \" \nSELECT\n  [LoanNum] AS loan_number,\n  [QM_Code] AS qualified_mortgage_type\nFROM\n  [clg_strategy].[dbo].[QM_Codes] (NOLOCK)\n\"\ndef self.sql_query(q_sym)\n conn = Apollo::SqlServer.get_connection(CONFIG_PREFIX)\n qs = self.map_to_query_string(q_sym)\n res = conn.execute(qs).to_a\n conn.close if conn &amp;&amp; conn.active?\n res.empty? ? nil : res \nend \n\ndef self.map_to_query_string(q_sym)\n qs = \"\"\n  case q_sym\n  when :lock_type\n    qs = LOCK_TYPE_QUERY\n  when :home_indicators\n    qs = HOME_INDICATORS_QUERY\n  when :hpm_indicator\n    qs = HIGHER_PRICED_MORTGAGE_INDICATOR_QUERY\n  when :qm_code\n    qs = QUALIFIED_MORTGAGE_TYPE_QUERY\n  when :db_eligibility\n    qs = APPLICANT_INCOME_PERCENT_OF_MEDIAN_QUERY\n  when :corr_tnw_amount\n    qs = CORRESPONDENT_TOTAL_NET_WORTH_AMOUNT_QUERY\n  else\n    raise \"not a valid q_sym passed from #{caller[0]}\"\n  qs  \n end \nend \n</code></pre>\n\n<p><strong>TLDR</strong> So essentially right now I just pass a symbol to a method in a separate module where this symbol is then run through a case statement to see which string in that module it correlates to, and then I run that string as an SQL statement. How can this life-cycle be improved so that I can create a lot of separate variables in my WhLoan class that can call the WhQueryHelper module to get the correct SQL statement return value?   </p>\n"}, {"tags": ["ruby-on-rails", "ruby", "csv", "parsing", "methods"], "comments": [{"owner": {"reputation": 13378, "user_id": 1430810, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/v669u.jpg?s=128&g=1", "display_name": "arieljuod", "link": "https://stackoverflow.com/users/1430810/arieljuod"}, "edited": false, "score": 1, "creation_date": 1536683530, "post_id": 52280347, "comment_id": 91508847, "body": "don&#39;t use capital S on the variable, and remove the <code>%w(..)</code> and the <code>puts</code>, you are mixing a lot of things there"}, {"owner": {"reputation": 45, "user_id": 8561357, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S3b2p.png?s=128&g=1", "display_name": "djangodev", "link": "https://stackoverflow.com/users/8561357/djangodev"}, "reply_to_user": {"reputation": 13378, "user_id": 1430810, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/v669u.jpg?s=128&g=1", "display_name": "arieljuod", "link": "https://stackoverflow.com/users/1430810/arieljuod"}, "edited": false, "score": 0, "creation_date": 1536684070, "post_id": 52280347, "comment_id": 91509114, "body": "ok yeah I didn&#39;t mean to include puts thank you"}, {"owner": {"reputation": 45, "user_id": 8561357, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S3b2p.png?s=128&g=1", "display_name": "djangodev", "link": "https://stackoverflow.com/users/8561357/djangodev"}, "reply_to_user": {"reputation": 13378, "user_id": 1430810, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/v669u.jpg?s=128&g=1", "display_name": "arieljuod", "link": "https://stackoverflow.com/users/1430810/arieljuod"}, "edited": false, "score": 0, "creation_date": 1536684909, "post_id": 52280347, "comment_id": 91509533, "body": "ok so it is now successfully writing to the csv. But outputing to the console gets all the text content in the div element and writing to the csv gets only the first title. Is there a way to work around this?"}], "answers": [{"comments": [{"owner": {"reputation": 45, "user_id": 8561357, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S3b2p.png?s=128&g=1", "display_name": "djangodev", "link": "https://stackoverflow.com/users/8561357/djangodev"}, "edited": false, "score": 0, "creation_date": 1536684364, "post_id": 52280439, "comment_id": 91509245, "body": "This works but the text from the div element contains commas and there&#39;s text from different child elements in the div that is not being appended to the csv."}, {"owner": {"reputation": 45, "user_id": 8561357, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S3b2p.png?s=128&g=1", "display_name": "djangodev", "link": "https://stackoverflow.com/users/8561357/djangodev"}, "edited": false, "score": 0, "creation_date": 1536684417, "post_id": 52280439, "comment_id": 91509267, "body": "put to the console gets all the text content. Writing to the csv gets only the first title. The array format must be interrupted by commas in the text content"}, {"owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "reply_to_user": {"reputation": 45, "user_id": 8561357, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S3b2p.png?s=128&g=1", "display_name": "djangodev", "link": "https://stackoverflow.com/users/8561357/djangodev"}, "edited": false, "score": 0, "creation_date": 1536684789, "post_id": 52280439, "comment_id": 91509449, "body": "You might want to add examples of what <code>browser.divs(class: &#39;results_row&#39;).map(&amp;:text)</code> returns and what you want to add to your CSV instead to your question."}], "tags": [], "owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "is_accepted": false, "score": 1, "last_activity_date": 1536683491, "creation_date": 1536683491, "answer_id": 52280439, "question_id": 52280347, "link": "https://stackoverflow.com/questions/52280347/how-to-write-method-to-csv-not-just-string-ruby-csv-gem/52280439#52280439", "title": "How to write method to csv not just string? Ruby csv gem", "body": "<p><code>%w[Searchresults]</code> creates an array containing the word <code>Searchresults</code>. You probably want something like this:</p>\n\n<pre><code># assign the array returned from `map` to the `search_results` variable\nsearch_results = browser.divs(class: 'results_row').map(&amp;:text)\n\n# output the `search_results`. Note that the return value of `puts` is `nil`\n# therefore something like `Searchresults = puts browser...` doesn't work\nputs search_results\n\n# append `search_results` to your csv \ncsv &lt;&lt; search_results\n</code></pre>\n"}], "owner": {"reputation": 45, "user_id": 8561357, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S3b2p.png?s=128&g=1", "display_name": "djangodev", "link": "https://stackoverflow.com/users/8561357/djangodev"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 160, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1536686052, "creation_date": 1536683098, "last_edit_date": 1536686052, "question_id": 52280347, "link": "https://stackoverflow.com/questions/52280347/how-to-write-method-to-csv-not-just-string-ruby-csv-gem", "title": "How to write method to csv not just string? Ruby csv gem", "body": "<p>I need to put the text content from an html element to a csv file. With the ruby csv gem, it seems that the primary write method for wrapped Strings and IOs only converts a string even if an object is specified.</p>\n\n<p>For example:</p>\n\n<pre><code> Searchresults = puts browser.divs(class: 'results_row').map(&amp;:text)\n csv &lt;&lt; %w(Searchresults)\n</code></pre>\n\n<p>returns only \"searchresults\" in the csv file. </p>\n\n<p>It seems like there should be a way to specify the text from the div element to be put and not just a literal string.</p>\n\n<p>Edit:</p>\n\n<p>Okay arieljuod and spickermann were right. Now I am getting text content from the div element output to the csv, but not all of it like when I output to the console. The div element \"results_row\" has two a elements with text content. It also has a child div \"results_subrow\" with a paragraph of text content that is not getting written to the csv.\nHTML:</p>\n\n<pre><code>&lt;div class=\"bodytag\" style=\"padding-bottom:30px; overflow:visible\"&gt; \n&lt;h2&gt;Search Results for \"serialnum3\"&lt;/h2&gt;\n&lt;div id=\"results_banner\"&gt;\n    Products\n    &lt;span&gt;Showing 1 to 2 of 2 results&lt;/span&gt;\n&lt;/div&gt;\n&lt;div class=\"pg_dir\"&gt;&lt;/div&gt;\n&lt;div class=\"results_row\"&gt;\n    &lt;a href=\"/products/fuji/\" title=\"Fuji, Inc.\"&gt;FUJI&lt;/a&gt;\n    &lt;a href=\"/products/fuji/50mm lens/\" title=\"Fuji, Inc.\"&gt;50mm lens&lt;/a&gt;\n    &lt;div class=\"results_subrow\"&gt;\n        &lt;p&gt;more product info&lt;/p&gt;\n    &lt;/div&gt;\n&lt;/div&gt;\n&lt;div class=\"results_row\"&gt;\n    &lt;a href=\"/products/fuji/\" title=\"Fuji, Inc. 2\"&gt;FUJI&lt;/a&gt;\n    &lt;a href=\"/products/fuji/50mm lens/\" title=\"Fuji, Inc.\"&gt;50mm lens&lt;/a&gt;\n    &lt;div class=\"results_subrow\"&gt;\n        &lt;p&gt;more product info 2&lt;/p&gt;  \n    &lt;/div&gt;\n&lt;/div&gt;\n&lt;div class=\"pg_dir\"&gt;&lt;/div&gt;  \n</code></pre>\n\n<p></p>\n\n<p>My code:</p>\n\n<pre><code> search_results = browser.divs(class: 'results_row').map(&amp;:text)\n csv &lt;&lt; search_results\n</code></pre>\n\n<p>I'm thinking that including the child div \"results_subrow\" in the locator will find what I am missing. Like:</p>\n\n<pre><code>search_results = browser.divs(class: 'results_row', 'results_subrow').map(&amp;:text)\n csv &lt;&lt; search_results\n</code></pre>\n"}, {"tags": ["ruby", "sinatra", "capistrano", "bundler", "capistrano3"], "comments": [{"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1536680797, "post_id": 52279446, "comment_id": 91507450, "body": "are you using a version control for ruby like <code>rvm</code> or <code>rbenv</code>? If so there are gems that plug this into <code>capistrano</code> (<a href=\"https://github.com/capistrano/rvm\" rel=\"nofollow noreferrer\">rvm</a> or <a href=\"https://github.com/capistrano/rbenv\" rel=\"nofollow noreferrer\">rbenv</a>) allowing you to specify the ruby version which is your real issue. If not try this <a href=\"https://coderwall.com/p/krkw7a/setting-ruby-version-in-capistrano-3\" rel=\"nofollow noreferrer\">coderwall.com/p/krkw7a/setting-ruby-version-in-capistrano-3</a>"}, {"owner": {"reputation": 23753, "user_id": 134367, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/PgGXL.png?s=128&g=1", "display_name": "craig", "link": "https://stackoverflow.com/users/134367/craig"}, "reply_to_user": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1536681322, "post_id": 52279446, "comment_id": 91507740, "body": "It would make things a lot easier, but no, they don&#39;t support either of these.  I&#39;ll try the <code>ruby_version</code> option."}], "owner": {"reputation": 23753, "user_id": 134367, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/PgGXL.png?s=128&g=1", "display_name": "craig", "link": "https://stackoverflow.com/users/134367/craig"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 549, "favorite_count": 1, "answer_count": 0, "score": 1, "last_activity_date": 1618700974, "creation_date": 1536679764, "last_edit_date": 1536690489, "question_id": 52279446, "link": "https://stackoverflow.com/questions/52279446/specify-a-bundler-version-to-be-used-in-capistrano", "title": "Specify a Bundler version to be used in Capistrano", "body": "<p>I'm using Capistrano to deploy a Sinatra app to hosting company (<a href=\"https://railsplayground.com/\" rel=\"nofollow noreferrer\">https://railsplayground.com/</a>).</p>\n\n<p>The hosting company supports 3 versions of Ruby:</p>\n\n<pre><code>$ ruby -v\nruby 2.0.0p645 (2015-04-13 revision 50299) [x86_64-linux]\n\n$ /usr/local/bin/ruby224 -v\nruby 2.2.4p230 (2015-12-16 revision 53155) [x86_64-linux]\n\n$ /usr/local/bin/ruby233 -v\nruby 2.3.3p222 (2016-11-21 revision 56859) [x86_64-linux]\n</code></pre>\n\n<p>As <a href=\"https://rubygems.org/gems/sinatra/versions/2.0.3\" rel=\"nofollow noreferrer\">Sinatra 2.0.3 requires Ruby >=2.2.0</a>, I decide to use Ruby 2.3.3.  The hosting company has created related executables:</p>\n\n<pre><code>$ /usr/local/bin/ruby233 /usr/local/bin/gem233 -v\n2.5.2\n\n$ /usr/local/bin/ruby233 /usr/local/bin/bundle233 -v\nBundler version 1.14.4\n</code></pre>\n\n<p>To test the Gem-installation process, I created a folder with a Gemfile:</p>\n\n<pre><code>$ cat Gemfile\nsource 'http://rubygems.org'\ngem 'sinatra'\n</code></pre>\n\n<p>I ran bundler (<code>$ /usr/local/bin/ruby233 /usr/local/bin/bundle233 install --path=vendor/bundle</code>) and the gems were install the in application's <code>vendor/bundle</code> directory:</p>\n\n<pre><code>$ ll vendor/bundle/ruby/2.3.0/gems/\ntotal 28\ndrwxrwxr-x 7 foobar foobar 4096 Sep 10 06:35 ./\ndrwxrwxr-x 9 foobar foobar 4096 Sep 10 06:35 ../\ndrwxrwxr-x 5 foobar foobar 4096 Sep 10 06:35 mustermann-1.0.3/\ndrwxrwxr-x 7 foobar foobar 4096 Sep 10 06:35 rack-2.0.5/\ndrwxrwxr-x 3 foobar foobar 4096 Sep 10 06:35 rack-protection-2.0.3/\ndrwxrwxr-x 4 foobar foobar 4096 Sep 10 06:35 sinatra-2.0.3/\ndrwxrwxr-x 7 foobar foobar 4096 Sep 10 06:35 tilt-2.0.8/\n</code></pre>\n\n<p>Next, I created a simple Sinatra application and attempted to deploy it.</p>\n\n<p><code>Gemfile</code>:</p>\n\n<pre><code>source \"http://rubygems.org\"\n\ngem \"sinatra\"\n\ngroup :development do\n    # deployment\n    gem 'capistrano'\n    gem 'capistrano-bundler'\n    gem 'capistrano-passenger'\nend\n</code></pre>\n\n<p><code>config.ru</code>:</p>\n\n<pre><code>require 'bundler'\nBundler.setup\n\n# desired\n#/usr/local/bin/ruby233 /usr/local/bin/bundle233 install --path=vendor/bundle\n\nrequire File.join(File.dirname(__FILE__), 'app')\nrun Sinatra::Application\n</code></pre>\n\n<p><code>deploy.rb</code>:</p>\n\n<pre><code>set :git_user, 'foobar'\nset :application, \"cap\"\nset :repo_url, \"git@bitbucket.org:#{fetch(:git_user)}/#{fetch(:application)}.git\"\nset :branch, 'master'\nset :passenger_restart_with_touch, true\n</code></pre>\n\n<p><code>staging.rb</code>:</p>\n\n<pre><code>set :stage, :staging\nset :ssh_user, 'foobarbaz'\nset :use_sudo, false\nserver \"supersonic.webhostserver.biz\", user: fetch(:ssh_user), roles: %w{app, web, db}\nset :tmp_dir, \"/home/#{fetch(:ssh_user)}/tmp\"\nset :deploy_to, \"/home/#{fetch(:ssh_user)}/apps/#{fetch(:application)}\"\n</code></pre>\n\n<p>I ran the staging deployment (from workstation):</p>\n\n<pre><code>$ bundle exec cap staging deploy\n</code></pre>\n\n<p>When the script attempts to install the Gems, it fails:</p>\n\n<pre><code>00:14 bundler:install\n      01 bundle install --path /home/foobarbaz/apps/cap/shared/bundle --without development test --deployment --quiet\n      01 stdin: is not a tty\n      01 An error occurred while installing mustermann (1.0.3), and Bundler cannot\n      01 continue.\n      01 Make sure that `gem install mustermann -v '1.0.3'` succeeds before bundling.\n(Backtrace restricted to imported tasks)\ncap aborted!\nSSHKit::Runner::ExecuteError: Exception while executing as foobarbaz@supersonic.webhostserver.biz: bundle exit status: 5\nbundle stdout: An error occurred while installing mustermann (1.0.3), and Bundler cannot\ncontinue.\nMake sure that `gem install mustermann -v '1.0.3'` succeeds before bundling.\nbundle stderr: stdin: is not a tty\n</code></pre>\n\n<p>It fails because <code>mustermann</code> requires Ruby >= 2.2.0, but the script is attempting to install the Gem using Ruby 2.0 (the default).</p>\n\n<p>How do I get capistrano (version 3.11.0 on my workstation) to use the desired version of bundler (bundle233) on the server?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "factory-bot", "rails-console"], "comments": [{"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 1, "creation_date": 1536676898, "post_id": 52278422, "comment_id": 91504947, "body": "<code>require</code> will return <code>false</code> if the library is already loaded in <code>LOAD_PATH</code> this is not a failure."}], "answers": [{"tags": [], "owner": {"reputation": 27144, "user_id": 3857758, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/58c4295826435f049b7fc32b98c240f9?s=128&d=identicon&r=PG&f=1", "display_name": "Ursus", "link": "https://stackoverflow.com/users/3857758/ursus"}, "is_accepted": false, "score": 2, "last_activity_date": 1536676842, "creation_date": 1536676842, "answer_id": 52278489, "question_id": 52278422, "link": "https://stackoverflow.com/questions/52278422/rails-console-requiring-factory-girl-fails/52278489#52278489", "title": "Rails Console requiring Factory Girl fails", "body": "<p>It returns <code>false</code> because it's already been required and loaded. Try </p>\n\n<p><code>FactoryGirl</code> </p>\n\n<p>to verify the constant exists</p>\n"}, {"tags": [], "owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "is_accepted": true, "score": 5, "last_activity_date": 1536676954, "last_edit_date": 1592644375, "creation_date": 1536676954, "answer_id": 52278531, "question_id": 52278422, "link": "https://stackoverflow.com/questions/52278422/rails-console-requiring-factory-girl-fails/52278531#52278531", "title": "Rails Console requiring Factory Girl fails", "body": "<p>When <code>require</code> returns <code>false</code> then this doesn't mean that an error occured. It means that the feature was already loaded.</p>\n<p>From the <a href=\"https://ruby-doc.org/core-2.5.1/Kernel.html#method-i-require\" rel=\"noreferrer\">documentation of <code>require</code></a>:</p>\n<blockquote>\n<p><code>require(name)</code> \u2192 <code>true</code> or <code>false</code></p>\n<p>Loads the given <code>name</code>, returning <code>true</code> if successful and <code>false</code> if the feature is already loaded.</p>\n</blockquote>\n<p>When <code>require</code> is not able to load the feature than it will raise a <code>LoadError</code>.</p>\n"}], "owner": {"reputation": 619, "user_id": 4465803, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/efb00ec60acadab7e2073bb987c9dbab?s=128&d=identicon&r=PG&f=1", "display_name": "Asif", "link": "https://stackoverflow.com/users/4465803/asif"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 594, "favorite_count": 0, "accepted_answer_id": 52278531, "answer_count": 2, "score": -1, "last_activity_date": 1536676954, "creation_date": 1536676666, "question_id": 52278422, "link": "https://stackoverflow.com/questions/52278422/rails-console-requiring-factory-girl-fails", "title": "Rails Console requiring Factory Girl fails", "body": "<p>I know that FactoryGirl has been deprecated in favor of FactoryBot, but we haven't yet updated our code, so we are still using FactoryGirl. Regardless, requiring FactoryGirl in the Rails Console should work, but it isnt'. </p>\n\n<p>The gem is included properly in my Gemfile</p>\n\n<pre><code>group :test, :development do\n   ...  \n  gem 'factory_girl_rails', '~&gt; 4.9.0'\n   ...\nend\n</code></pre>\n\n<p>And it appears when I run <code>bundle</code></p>\n\n<pre><code>$ bundle | grep factory\nUsing factory_girl 4.9.0\nUsing factory_girl_rails 4.9.0\n</code></pre>\n\n<p>But when I require it in the console, it fails. </p>\n\n<pre><code>[1] pry(main)&gt; require 'factory_girl_rails'\n=&gt; false\n[3] pry(main)&gt; require 'factory_girl'\n=&gt; false\n</code></pre>\n\n<p>This doesn't seem to happen with any of the other gems in my Gemfile. Can anyone help me fix this?</p>\n"}, {"tags": ["ruby", "selenium-webdriver", "foreach", "selenium-chromedriver", "watir"], "comments": [{"owner": {"reputation": 44680, "user_id": 1200545, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbbfea5f6583c16f96fc11ef821cfeee?s=128&d=identicon&r=PG&f=1", "display_name": "Justin Ko", "link": "https://stackoverflow.com/users/1200545/justin-ko"}, "edited": false, "score": 0, "creation_date": 1536673419, "post_id": 52277285, "comment_id": 91502531, "body": "What exception did you get when doing <code>browser.divs(:class =&gt; &quot;results_row&quot;)</code>? <code>#divs</code> is the correct when to get a collection of matching divs. I have written some stuff about locating elements vs collections <a href=\"https://leanpub.com/watirways/read#leanpub-auto-element-vs-collection\" rel=\"nofollow noreferrer\">in a book</a> if it helps."}, {"owner": {"reputation": 44680, "user_id": 1200545, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbbfea5f6583c16f96fc11ef821cfeee?s=128&d=identicon&r=PG&f=1", "display_name": "Justin Ko", "link": "https://stackoverflow.com/users/1200545/justin-ko"}, "edited": false, "score": 0, "creation_date": 1536673626, "post_id": 52277285, "comment_id": 91502714, "body": "Maybe the undefined method error is not from <code>divs</code> directly, but what you were doing with it? The code should be like <code>puts browser.divs(class: &#39;results_row&#39;).map(&amp;:text)</code>"}, {"owner": {"reputation": 45, "user_id": 8561357, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S3b2p.png?s=128&g=1", "display_name": "djangodev", "link": "https://stackoverflow.com/users/8561357/djangodev"}, "reply_to_user": {"reputation": 44680, "user_id": 1200545, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbbfea5f6583c16f96fc11ef821cfeee?s=128&d=identicon&r=PG&f=1", "display_name": "Justin Ko", "link": "https://stackoverflow.com/users/1200545/justin-ko"}, "edited": false, "score": 0, "creation_date": 1536673908, "post_id": 52277285, "comment_id": 91502922, "body": "Wow you&#39;re right Justin. The exception was for the text method &quot;<code>block in &lt;main&gt;&#39;: undefined method </code>text&#39; for #&lt;Watir::DivCollection:0x00000005193160&gt; (NoMethodError)&quot;. I thought it was the results_row method. Thanks so much."}, {"owner": {"reputation": 45, "user_id": 8561357, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S3b2p.png?s=128&g=1", "display_name": "djangodev", "link": "https://stackoverflow.com/users/8561357/djangodev"}, "reply_to_user": {"reputation": 44680, "user_id": 1200545, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbbfea5f6583c16f96fc11ef821cfeee?s=128&d=identicon&r=PG&f=1", "display_name": "Justin Ko", "link": "https://stackoverflow.com/users/1200545/justin-ko"}, "edited": false, "score": 0, "creation_date": 1536674229, "post_id": 52277285, "comment_id": 91503150, "body": "and your book looks like just what I need. Thanks"}, {"owner": {"reputation": 3523, "user_id": 9043475, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FNxvn.jpg?s=128&g=1", "display_name": "Rajagopalan", "link": "https://stackoverflow.com/users/9043475/rajagopalan"}, "edited": false, "score": 0, "creation_date": 1536676296, "post_id": 52277285, "comment_id": 91504584, "body": "You don&#39;t have to pass the delete key"}, {"owner": {"reputation": 44680, "user_id": 1200545, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbbfea5f6583c16f96fc11ef821cfeee?s=128&d=identicon&r=PG&f=1", "display_name": "Justin Ko", "link": "https://stackoverflow.com/users/1200545/justin-ko"}, "edited": false, "score": 0, "creation_date": 1536680592, "post_id": 52277285, "comment_id": 91507307, "body": "@KevinGraham, since this is the same root problem as some of the older questions on the site, I&#39;m going to mark this as a duplicate."}, {"owner": {"reputation": 45, "user_id": 8561357, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S3b2p.png?s=128&g=1", "display_name": "djangodev", "link": "https://stackoverflow.com/users/8561357/djangodev"}, "reply_to_user": {"reputation": 44680, "user_id": 1200545, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbbfea5f6583c16f96fc11ef821cfeee?s=128&d=identicon&r=PG&f=1", "display_name": "Justin Ko", "link": "https://stackoverflow.com/users/1200545/justin-ko"}, "edited": false, "score": 0, "creation_date": 1536686733, "post_id": 52277285, "comment_id": 91510371, "body": "Ok thanks @justin-ko, btw is it possible to include a child element in the div locator so that I get all the text content output? I&#39;m trying to write to a csv but only get text in the a elements of &quot;results_row&quot; div. I also need the text from a child div &quot;results_subrow&quot;. I&#39;m thinking something like: <code>search_results = browser.divs(class: &#39;results_row&#39;, &#39;results_subrow&#39;).map(&amp;:text)  csv &lt;&lt; search_results</code>"}, {"owner": {"reputation": 44680, "user_id": 1200545, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbbfea5f6583c16f96fc11ef821cfeee?s=128&d=identicon&r=PG&f=1", "display_name": "Justin Ko", "link": "https://stackoverflow.com/users/1200545/justin-ko"}, "edited": false, "score": 0, "creation_date": 1536689802, "post_id": 52277285, "comment_id": 91511888, "body": "Yes. <code>#divs</code> creates a collection of elements that you can iterate over an inspect. For example, getting the child div would be: <code>browser.divs(class: &#39;results_row&#39;).map { |parent_div| parent_div.div(class: &#39;results_subrow&#39;).text }</code>. Similar can be done for getting the links."}], "owner": {"reputation": 45, "user_id": 8561357, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S3b2p.png?s=128&g=1", "display_name": "djangodev", "link": "https://stackoverflow.com/users/8561357/djangodev"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 122, "favorite_count": 0, "closed_date": 1536680604, "answer_count": 0, "score": 0, "last_activity_date": 1536675099, "creation_date": 1536673128, "last_edit_date": 1536675099, "question_id": 52277285, "link": "https://stackoverflow.com/questions/52277285/how-to-locate-all-div-elements-of-the-same-class-to-print-text-content-watir-c", "closed_reason": "Duplicate", "title": "How to Locate All Div Elements of The Same Class to Print Text Content? Watir, Chromedriver", "body": "<p>I'm trying to print the text content of each div of a specific class: \"results_row\". I would locate each div by other locators like title and id if I just needed the text from these two divs, but the divs are search results for a serial number from an array. I want to be able to print text from each div after searching so I can iterate through the array of serials.</p>\n\n<p>Here is my HTML: </p>\n\n<pre><code>&lt;div class=\"bodytag\" style=\"padding-bottom:30px; overflow:visible\"&gt; \n    &lt;h2&gt;Search Results for \"serialnum3\"&lt;/h2&gt;\n    &lt;div id=\"results_banner\"&gt;\n        Products\n        &lt;span&gt;Showing 1 to 2 of 2 results&lt;/span&gt;\n    &lt;/div&gt;\n    &lt;div class=\"pg_dir\"&gt;&lt;/div&gt;\n    &lt;div class=\"results_row\"&gt;\n        &lt;a href=\"/products/fuji/\" title=\"Fuji, Inc.\"&gt;FUJI&lt;/a&gt;\n        &lt;a href=\"/products/fuji/50mm lens/\" title=\"Fuji, Inc.\"&gt;50mm lens&lt;/a&gt;\n        &lt;div class=\"results_subrow\"&gt;\n            &lt;p&gt;more product info&lt;/p&gt;\n        &lt;/div&gt;\n    &lt;/div&gt;\n    &lt;div class=\"results_row\"&gt;\n        &lt;a href=\"/products/fuji/\" title=\"Fuji, Inc. 2\"&gt;FUJI&lt;/a&gt;\n        &lt;a href=\"/products/fuji/50mm lens/\" title=\"Fuji, Inc.\"&gt;50mm lens&lt;/a&gt;\n        &lt;div class=\"results_subrow\"&gt;\n            &lt;p&gt;more product info 2&lt;/p&gt;  \n        &lt;/div&gt;\n    &lt;/div&gt;\n    &lt;div class=\"pg_dir\"&gt;&lt;/div&gt;  \n&lt;/div&gt;\n</code></pre>\n\n<p>And here is my code:</p>\n\n<pre><code>SERIALS = [\"s1\",\"s2\",\"s3\"]\nSERIALS.each do |item|\n        browser.span(:id =&gt; \"search\").click\n        browser.send_keys [:control, 'a']\n        browser.send_keys :delete\n        browser.send_keys \"#{item}\"\n        browser.send_keys :return\n        puts \"sleeping 3\"\n        sleep(3)\n\n     #Scrape text from results_row divs\n     results_row = browser.div(:class =&gt; \"results_row\")\n     puts results_row.text\n    end\n</code></pre>\n\n<p>I need to somehow call all divs of that class when I define the results_row method before printing so that it won't just grab the first div of that class on the page and move on to the next serial. I feel like there is a simple solution like making div plural when defining the method results_row <code>results_row = browser.divs(:class =&gt; \"results_row\")</code>but that leaves the method undefined.</p>\n\n<p>Maybe there is a way to iterate over each div in the \"bodytag\" div as if they were lis in a ul. For that I'm considering something like this:</p>\n\n<pre><code>BodyTag = browser.div(:class =&gt; \"bodytag\")\nBodyTag.divs.each_with_index do |e|\n results_row = browser.div(:class =&gt; \"results_row\")\n puts results_row.text\n end\n</code></pre>\n"}, {"tags": ["ruby", "ruby-on-rails-3"], "comments": [{"owner": {"reputation": 655, "user_id": 6046641, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c716b970d2d8e6ca81ed19a4b0c26fb1?s=128&d=identicon&r=PG", "display_name": "Umesh Malhotra", "link": "https://stackoverflow.com/users/6046641/umesh-malhotra"}, "edited": false, "score": 0, "creation_date": 1536673013, "post_id": 52276961, "comment_id": 91502257, "body": "What is code below render for? and what exactly is the problem you are facing?"}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1536673189, "post_id": 52276961, "comment_id": 91502361, "body": "<i>&quot;if I have sixteen offers on a project, I have sixteen times the entirely list of offers&quot;</i> -- Are you saying that you have <code>16*16 == 256</code> offers displaying on the page? As far as I can tell, that would only happen if <code>@offers</code> contains 256 items! (And it would have nothing to do with the use of <code>each</code> vs <code>each_with_index</code>."}, {"owner": {"reputation": 79498, "user_id": 298624, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/5b84ccc2f7709bbb7105baeb40e0961b?s=128&d=identicon&r=PG", "display_name": "fl00r", "link": "https://stackoverflow.com/users/298624/fl00r"}, "edited": false, "score": 0, "creation_date": 1536673337, "post_id": 52276961, "comment_id": 91502467, "body": "Are those 16 duplicates are identical? the same id and so on. If so, then it looks like you have some &quot;cycle&quot; before this <code>each_with_index</code> block. So you are iterating over <code>@offers</code> somewhere before this particular <code>each_with_index</code> call. Show more code please."}, {"owner": {"reputation": 1012, "user_id": 10347572, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iottG.jpg?s=128&g=1", "display_name": "escanxr", "link": "https://stackoverflow.com/users/10347572/escanxr"}, "edited": false, "score": 0, "creation_date": 1536673660, "post_id": 52276961, "comment_id": 91502738, "body": "Hello Umesh, I edited the post to show the code in my render."}, {"owner": {"reputation": 832, "user_id": 5594180, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iv01N.png?s=128&g=1", "display_name": "Sa\u0161a Zejnilovi\u0107", "link": "https://stackoverflow.com/users/5594180/sa%c5%a1a-zejnilovi%c4%87"}, "edited": false, "score": 0, "creation_date": 1536673686, "post_id": 52276961, "comment_id": 91502762, "body": "How is @offers.each_with_index implemented?"}, {"owner": {"reputation": 1012, "user_id": 10347572, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iottG.jpg?s=128&g=1", "display_name": "escanxr", "link": "https://stackoverflow.com/users/10347572/escanxr"}, "edited": false, "score": 0, "creation_date": 1536673730, "post_id": 52276961, "comment_id": 91502799, "body": "Hi Tom, this is exactly my problem, but if I check in my console, @offers contain only 16 records and not 256..."}, {"owner": {"reputation": 1012, "user_id": 10347572, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iottG.jpg?s=128&g=1", "display_name": "escanxr", "link": "https://stackoverflow.com/users/10347572/escanxr"}, "edited": false, "score": 0, "creation_date": 1536673925, "post_id": 52276961, "comment_id": 91502936, "body": "Hi fl00r, i thought the same thing but there no loop or something like this... My code is rendered in another file but there not &quot;cycle&quot; inside..."}, {"owner": {"reputation": 79498, "user_id": 298624, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/5b84ccc2f7709bbb7105baeb40e0961b?s=128&d=identicon&r=PG", "display_name": "fl00r", "link": "https://stackoverflow.com/users/298624/fl00r"}, "edited": false, "score": 0, "creation_date": 1536673976, "post_id": 52276961, "comment_id": 91502972, "body": "show how <code>@offers</code> are initialized."}, {"owner": {"reputation": 3090, "user_id": 4454732, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh3.googleusercontent.com/-8OrTJkCtkn4/AAAAAAAAAAI/AAAAAAAAA4s/7jp2lrThK2k/photo.jpg?sz=128", "display_name": "David Hempy", "link": "https://stackoverflow.com/users/4454732/david-hempy"}, "edited": false, "score": 0, "creation_date": 1536674020, "post_id": 52276961, "comment_id": 91503009, "body": "Can you show your controller code? Is this for #index?"}, {"owner": {"reputation": 79498, "user_id": 298624, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/5b84ccc2f7709bbb7105baeb40e0961b?s=128&d=identicon&r=PG", "display_name": "fl00r", "link": "https://stackoverflow.com/users/298624/fl00r"}, "edited": false, "score": 0, "creation_date": 1536674027, "post_id": 52276961, "comment_id": 91503014, "body": "the banner is rendered also 16 times? or only once?"}, {"owner": {"reputation": 1012, "user_id": 10347572, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iottG.jpg?s=128&g=1", "display_name": "escanxr", "link": "https://stackoverflow.com/users/10347572/escanxr"}, "edited": false, "score": 0, "creation_date": 1536674245, "post_id": 52276961, "comment_id": 91503158, "body": "I edited the post to show the controller. This is not for index (works in index) but for show action. And yes, the banner is rendered also 16 times"}, {"owner": {"reputation": 79498, "user_id": 298624, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/5b84ccc2f7709bbb7105baeb40e0961b?s=128&d=identicon&r=PG", "display_name": "fl00r", "link": "https://stackoverflow.com/users/298624/fl00r"}, "edited": false, "score": 0, "creation_date": 1536674397, "post_id": 52276961, "comment_id": 91503274, "body": "the answer is the same. You are iterating over the <code>@offers</code> somewhere else. The problem is not in a code you showed. I suppose you should show entire view."}, {"owner": {"reputation": 1012, "user_id": 10347572, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iottG.jpg?s=128&g=1", "display_name": "escanxr", "link": "https://stackoverflow.com/users/10347572/escanxr"}, "edited": false, "score": 0, "creation_date": 1536674479, "post_id": 52276961, "comment_id": 91503324, "body": "Well, I need to sleep... I have a &quot;= render partial: &quot;projects/offers/offer&quot;, collection: @offers&quot; so the collection is the &quot;problem&quot;... Thanks for your help, I&#39;m going to find how can I work with each_with_index with this collection"}, {"owner": {"reputation": 79498, "user_id": 298624, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/5b84ccc2f7709bbb7105baeb40e0961b?s=128&d=identicon&r=PG", "display_name": "fl00r", "link": "https://stackoverflow.com/users/298624/fl00r"}, "edited": false, "score": 0, "creation_date": 1536674557, "post_id": 52276961, "comment_id": 91503375, "body": "yes, <code>collection: @offers</code> is the reason"}, {"owner": {"reputation": 1012, "user_id": 10347572, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iottG.jpg?s=128&g=1", "display_name": "escanxr", "link": "https://stackoverflow.com/users/10347572/escanxr"}, "edited": false, "score": 0, "creation_date": 1536674623, "post_id": 52276961, "comment_id": 91503425, "body": "Yes fl00r, you are right. It&#39;s a big website with a lot of rendered code and I work on this project since few days, so sometimes it&#39;s a bit difficult to know exactly how every functionalities works.."}], "owner": {"reputation": 1012, "user_id": 10347572, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iottG.jpg?s=128&g=1", "display_name": "escanxr", "link": "https://stackoverflow.com/users/10347572/escanxr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 60, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1536674125, "creation_date": 1536672161, "last_edit_date": 1536674125, "question_id": 52276961, "link": "https://stackoverflow.com/questions/52276961/each-with-index-duplicated-records", "title": "each_with_index duplicated records", "body": "<p>first of all, excuse me if my english is not always very good.</p>\n\n<p>I have a problem with the each_with_index... When I show a project, I display the offers for this project. I have to make appear a banner in third position of offers, so I use each_with_index for that.</p>\n\n<p>The problem is that: if I have sixteen offers on a project, I have sixteen times the entirely list of offers, and I don't know why.</p>\n\n<p>This is my code: </p>\n\n<pre><code>- @offers.each_with_index do |offer, index|\n  - if !user_signed_in? &amp;&amp; (@project.published? || @project.pending_attribution?)\n\n    - if @offers.size &gt;= 3 &amp;&amp; index == 3\n      = render 'offer_cta'\n\n  - contact_bloc = user_contact_bloc(offer.user, viewer: current_user, display_contact_info: offer.display_contact_info?)\n  .card.offer-card.mt-4[offer]{ class: offer_class(offer) }\n    .card-header.d-flex.justify-content-between.align-items-center.border-bottom-0\n      .offer-date\n        %span.text-muted\n          Offer filed on\n          = l(offer.created_at, format: '%d/%m/%Y \u00e0 %Hh%M')\n        - if user_signed_in? &amp;&amp; current_user.admin? &amp;&amp; !offer.user.suspended_at.nil?\n          ... exctera\n</code></pre>\n\n<p>Also, if I try this in my console, I don't have any problem...</p>\n\n<p>Have you ever had this problem?</p>\n\n<p>Don't hesitate to ask me if you need more information.</p>\n\n<p><strong>EDIT :</strong></p>\n\n<p>This is the code in my render 'offer_cta', a very basic code:</p>\n\n<pre><code>.row\n        .col-md-12\n          .project-cta.p-5.mb-2.text-center\n            %h5\n              %strong\n                blabla\n            %p.text-muted blablabla\n            %p.m-0\n              = link_to \"Send a quote\", \"\", class: \"btn btn-primary px-3\", data: { toggle: 'modal', target: '#modal-sign' }, onclick: \"ga('send', 'event', 'button', 'Clic', 'Sign up');\", tabindex: -1\n</code></pre>\n\n<p>@offers initialization:</p>\n\n<pre><code>@offers = @project.offers_accessible_by(current_ability, current_user)\n@offers.mark_as_read_for(current_user)\n@offers = @offers.includes(:offer_interactions, user: [:user_profile, :user_subscription, :user_contact])\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby"], "answers": [{"tags": [], "owner": {"reputation": 6039, "user_id": 2137458, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8cfca832ee746f3e3d9971148f52dc64?s=128&d=identicon&r=PG", "display_name": "NM Pennypacker", "link": "https://stackoverflow.com/users/2137458/nm-pennypacker"}, "is_accepted": true, "score": 4, "last_activity_date": 1536676184, "last_edit_date": 1536676184, "creation_date": 1536672105, "answer_id": 52276936, "question_id": 52276728, "link": "https://stackoverflow.com/questions/52276728/rails-5-preventing-access-to-admin-pages-based-on-ip-address/52276936#52276936", "title": "Rails 5: Preventing access to /admin pages based on IP address", "body": "<p>You can create a <code>before_action</code> like this:</p>\n\n<pre><code>class ApplicationController &lt; ActionController::Base\n  before_action :filter_ip_address\n\n  protected\n\n  def filter_ip_address\n    current_ip_address = request.env['HTTP_X_REAL_IP']\n    head :unauthorized unless current_ip_address == \"XX.XX.XX.XX\"\n  end\nend\n</code></pre>\n\n<p>The example given is for <code>application_controller</code>, but you can put it wherever you need if you don't want to call it everywhere.</p>\n\n<p>This is a modified version of the example I found here: <a href=\"https://coderwall.com/p/v980ha/restrict-ip-access-in-rails\" rel=\"nofollow noreferrer\">https://coderwall.com/p/v980ha/restrict-ip-access-in-rails</a></p>\n"}], "owner": {"reputation": 59, "user_id": 9917756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/451e1e07fb2e0cb049ce342de138a9d5?s=128&d=identicon&r=PG&f=1", "display_name": "mr.coder", "link": "https://stackoverflow.com/users/9917756/mr-coder"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 68, "favorite_count": 0, "accepted_answer_id": 52276936, "answer_count": 1, "score": 2, "last_activity_date": 1536676184, "creation_date": 1536671394, "last_edit_date": 1536676097, "question_id": 52276728, "link": "https://stackoverflow.com/questions/52276728/rails-5-preventing-access-to-admin-pages-based-on-ip-address", "title": "Rails 5: Preventing access to /admin pages based on IP address", "body": "<p>I have been building a rails 5.2 app, and so far I want to separate or restrict access to <code>/admin</code> pages to only be accessible through office computers (local ips). </p>\n\n<p>How can I achieve that, knowing I used <code>activeadmin</code> and <code>petergate</code> for authorization? </p>\n"}, {"tags": ["ruby", "windows", "calabash-android"], "answers": [{"tags": [], "owner": {"reputation": 5470, "user_id": 2568849, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/UxtGh.png?s=128&g=1", "display_name": "Mesut GUNES", "link": "https://stackoverflow.com/users/2568849/mesut-gunes"}, "is_accepted": false, "score": 0, "last_activity_date": 1538642401, "creation_date": 1538642401, "answer_id": 52642500, "question_id": 52276319, "link": "https://stackoverflow.com/questions/52276319/no-signatures-files-found-in-meta-inf-cannot-proceed-runtimeerror/52642500#52642500", "title": "No signatures files found in META-INF. Cannot proceed. (RuntimeError)", "body": "<p>If you do not have <code>debug.keystore</code> file create it bu the following command, you need <code>keytool</code> which is in <code>JAVA_HOME/bin</code>:</p>\n\n<pre><code>keytool -genkey -v -keystore ~/.android/debug.keystore -alias androiddebugkey -storepass android -keypass android -keyalg RSA -keysize 2048 -validity 10000 -dname \"CN=Android Debug,O=Android,C=US\"\n</code></pre>\n\n<p>Then run the <code>calabash-android setup</code> to assign this debug.keystore:</p>\n\n<pre><code>$ calabash-android setup\n  Please enter keystore information to use a custom keystore instead of the default\n  Please enter keystore location\n  ...\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 1616476, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0PKOs.jpg?s=128&g=1", "display_name": "Sathish", "link": "https://stackoverflow.com/users/1616476/sathish"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 782, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1538642401, "creation_date": 1536670038, "last_edit_date": 1592644375, "question_id": 52276319, "link": "https://stackoverflow.com/questions/52276319/no-signatures-files-found-in-meta-inf-cannot-proceed-runtimeerror", "title": "No signatures files found in META-INF. Cannot proceed. (RuntimeError)", "body": "<h3>Resign</h3>\n<p>D:\\test&gt;bundle exec calabash-android resign app-staging.apk</p>\n<p>D:\\test&gt;</p>\n<h3>When i do run/build</h3>\n<pre><code>D:\\test&gt;bundle exec calabash-android run app-staging.apk\nNo test server found for this combination of app and calabash version. Recreating test server.\n*** WARNING: You must use ANSICON 1.31 or higher (https://github.com/adoxa/ansicon/) to get coloured output on Windows\nWARNING: skipped META-INF/CERT.RSA as unsafe\nC:/Ruby23-x64/lib/ruby/gems/2.3.0/gems/calabash-android-0.9.6/lib/calabash-android/helpers.rb:188:in block (2 levels) in fingerprint_from_apk': No s re files found in META-INF. Cannot proceed. (RuntimeError) from C:/Ruby23-x64/lib/ruby/gems/2.3.0/gems/calabash-android-0.9.6/lib/calabash-android/helpers.rb:170:inchdir'\nfrom C:/Ruby23-x64/lib/ruby/gems/2.3.0/gems/calabash-android-0.9.6/lib/calabash-android/helpers.rb:170:in block in fingerprint_from_apk' from C:/Ruby23-x64/lib/ruby/2.3.0/tmpdir.rb:89:inmktmpdir'\nfrom C:/Ruby23-x64/lib/ruby/gems/2.3.0/gems/calabash-android-0.9.6/lib/calabash-android/helpers.rb:169:in fingerprint_from_apk' from C:/Ruby23-x64/lib/ruby/gems/2.3.0/gems/calabash-android-0.9.6/bin/calabash-android-build.rb:2:incalabash_build'\nfrom C:/Ruby23-x64/lib/ruby/gems/2.3.0/gems/calabash-android-0.9.6/lib/calabash-android/helpers.rb:107:in build_test_server_if_needed' from C:/Ruby23-x64/lib/ruby/gems/2.3.0/gems/calabash-android-0.9.6/bin/calabash-android-run.rb:16:incalabash_run'\nfrom C:/Ruby23-x64/lib/ruby/gems/2.3.0/gems/calabash-android-0.9.6/bin/calabash-android:86:in &lt;top (required)&gt;' from C:/Ruby23-x64/bin/calabash-android:22:inload'\nfrom C:/Ruby23-x64/bin/calabash-android:22:in\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "redis", "actioncable"], "answers": [{"comments": [{"owner": {"reputation": 724, "user_id": 5494897, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/7cd2f409e842eb3572bc8ca0f33b68f3?s=128&d=identicon&r=PG", "display_name": "Bradley", "link": "https://stackoverflow.com/users/5494897/bradley"}, "edited": false, "score": 0, "creation_date": 1536742841, "post_id": 52287275, "comment_id": 91530441, "body": "Oh!!! Nice one. I must have went over those files 100 times and just didn&#39;t see that. &quot;my eyes!!!!&quot;. Thanks a million @rparr. Fair play."}, {"owner": {"reputation": 724, "user_id": 5494897, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/7cd2f409e842eb3572bc8ca0f33b68f3?s=128&d=identicon&r=PG", "display_name": "Bradley", "link": "https://stackoverflow.com/users/5494897/bradley"}, "edited": false, "score": 0, "creation_date": 1536743213, "post_id": 52287275, "comment_id": 91530687, "body": "Thanks for the taken the time to read the question rparr. There was a lot going on in it. Much appreciated."}, {"owner": {"reputation": 143, "user_id": 5222293, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3ca09f3aeb7d735c0b7ac0d193d0c483?s=128&d=identicon&r=PG&f=1", "display_name": "rparr", "link": "https://stackoverflow.com/users/5222293/rparr"}, "reply_to_user": {"reputation": 724, "user_id": 5494897, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/7cd2f409e842eb3572bc8ca0f33b68f3?s=128&d=identicon&r=PG", "display_name": "Bradley", "link": "https://stackoverflow.com/users/5494897/bradley"}, "edited": false, "score": 0, "creation_date": 1536743795, "post_id": 52287275, "comment_id": 91531054, "body": "You&#39;re welcome, @Bradley, I&#39;m glad I could help. Sometimes all it takes is someone else to take a look at your code. :)"}], "tags": [], "owner": {"reputation": 143, "user_id": 5222293, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3ca09f3aeb7d735c0b7ac0d193d0c483?s=128&d=identicon&r=PG&f=1", "display_name": "rparr", "link": "https://stackoverflow.com/users/5222293/rparr"}, "is_accepted": true, "score": 2, "last_activity_date": 1536724590, "creation_date": 1536724590, "answer_id": 52287275, "question_id": 52275761, "link": "https://stackoverflow.com/questions/52275761/action-cable-in-rails-5-2-throwing-a-nomethoderror/52287275#52287275", "title": "Action Cable in Rails 5.2 throwing a NoMethodError", "body": "<blockquote>\n  <p><strong>Note:</strong> I have yet to use ActionCable myself so take my response with a grain of salt.</p>\n</blockquote>\n\n<p>In your <code>app/channels/listings_channel.rb</code> file <code>ApplicationCable::channel</code> should have a capital \"C\" on channel.</p>\n\n<p><strong>Current:</strong> <code>class ListingsChannel &lt; ApplicationCable::channel</code></p>\n\n<p><strong>Required:</strong> <code>class ListingsChannel &lt; ApplicationCable::Channel</code></p>\n\n<p>It looks like Ruby things that there is a function called <code>channel</code> in your <code>ApplicationCable</code> module and that's why you're getting an error.</p>\n\n<p>Also, since you didn't post the code, make sure that you have a <code>Channel</code> class within the <code>ApplicationCable</code> namespace. Based off <a href=\"https://github.com/rails/actioncable-examples/blob/master/app/channels/application_cable/channel.rb\" rel=\"nofollow noreferrer\">this repository</a>, you should also have this file in your app folder:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code># /channels/application_cable/channel.rb\nmodule ApplicationCable\n  class Channel &lt; ActionCable::Channel::Base\n  end\nend\n</code></pre>\n"}], "owner": {"reputation": 724, "user_id": 5494897, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/7cd2f409e842eb3572bc8ca0f33b68f3?s=128&d=identicon&r=PG", "display_name": "Bradley", "link": "https://stackoverflow.com/users/5494897/bradley"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 724, "favorite_count": 0, "accepted_answer_id": 52287275, "answer_count": 1, "score": 2, "last_activity_date": 1536724590, "creation_date": 1536668267, "last_edit_date": 1536685227, "question_id": 52275761, "link": "https://stackoverflow.com/questions/52275761/action-cable-in-rails-5-2-throwing-a-nomethoderror", "title": "Action Cable in Rails 5.2 throwing a NoMethodError", "body": "<p>I'm setting up Action cable in my Rails 5.2 app for comments on a listings page. jQuery is not my strong point but I'm sure I've got that end right. I'm receiving this error when I load the page. I'm have disabled Turbolinks so the call on the jQuery coffee script I'm sure is correct. I've double checked file locations and typos and cannot for the life of me figure out why the method 'channel' is not being called. Here are the files. </p>\n\n<p>app/assets/javascripts/channels/listings.coffee</p>\n\n<pre class=\"lang-coffee prettyprint-override\"><code>jQuery -&gt;\ncomments = $('#comments')\nif comments.length &gt; 0 \n    App.global_chat = App.cable.subscriptions.create {\n        channel: \"ListingsChannel\"\n        listing_id: comments.data(\"listing-id\")\n    },\n    connected: -&gt;\n    disconnected: -&gt;\n    received: (data) -&gt;\n        comments.append data['comment']\n    send_comment: (comment, listing_id) -&gt;\n        @perform 'send_comment', comment: comment, listing_id: listing_id\n$('#new_comment').submit (e) -&gt;\n    $this = $(this)\n    textarea = $this.find('#comment_content')\n    if $.trim(textarea.val()).length &gt; 1\n        App.global_chat.send_comment textarea.val(),\n        comments.data('listing-id')\n        textarea.val('')\n    e.preventDefault()\n    return false\n</code></pre>\n\n<p>app/channels/listings_channel.rb</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>class ListingsChannel &lt; ApplicationCable::channel\n    def subscribed\n        # point to the stream\n        stream_from \"listings_#{params['listing_id']}_channel\"\n    end\n\n    def unsubscribed\n    end\n\n    # uses the method in the coffee script to get the data required to attach to the comment\n    def send_comment(data)\n        current_user.comments.create!(content: data['comment'], listing_id: data['listing_id'])\n    end\nend\n</code></pre>\n\n<p>Error message:</p>\n\n<pre><code>[ActionCable] [bradley@email.com] [2] Registered connection (Z2lkOi8vZ2xvYmFsLWFieC9Vc2VyLzI)\n[ActionCable] [bradley@email.com] [2] Could not execute command from ({\"command\"=&gt;\"subscribe\", \"identifier\"=&gt;\"{\\\"channel\\\":\\\"ListingsChannel\\\",\\\"listing_id\\\":6}\"}) [NoMethodError - undefined method `channel' for ApplicationCable:Module]: /Users/bradley/Development/app_name/app/channels/listings_channel.rb:1:in\n</code></pre>\n\n<p>app/channels/application_cable/connection.rb</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>module ApplicationCable\n      class Connection &lt; ActionCable::Connection::Base\n            identified_by :current_user\n\n            def connect\n                self.current_user = find_verified_user\n                logger.add_tags 'ActionCable', current_user.email\n                logger.add_tags 'ActionCable', current_user.id\n            end\n\n            protected\n\n            def find_verified_user\n                # recreating devise functionality for current_user methods\n                if verified_user = env['warden'].user\n                    verified_user\n                end\n            end\n      end\n end\n</code></pre>\n\n<p>app/controllers/comments_controller.rb</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>class CommentsController &lt; ApplicationController\ndef create\n    # grabs current user and builds the comment based on relationships set up\n    @comment = current_user.comments.build(comment_params)\nend\n\nprivate\n\ndef comment_params\n    params.require(:comment).permit(:content)\nend\n</code></pre>\n\n<p>end</p>\n\n<p>app/jobs/comment_broadcast_job.rb</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>class CommentBroadcastJob &lt; ApplicationJob\n#create queue/list served in order\nqueue_as :default\n\ndef perform(comment)\n    # start broadcast on actioncable / create a channell/ render comment\n    ActionCable.server.broadcast \"listings_#{comment.listing.id}_channel\", comment: render_comment(comment)\nend\n\nprivate\n\ndef render_comment(comment)\n    # call the comments controller and render the partial in the views, pass in the variable to render\n    CommentsController.render partial: 'comments/comment', locals: { comment: comment }\nend\n</code></pre>\n\n<p>end</p>\n\n<p>app/assets/javascripts/application.js</p>\n\n<pre><code>//= require jquery\n//= require rails-ujs\n//= require popper\n//= require bootstrap-sprockets\n//= require snackbar\n//= require activestorage\n//= require cable\n//= require_tree .\n</code></pre>\n\n<p>The form inspected to see if there is any mislaid # call or anything. \n<a href=\"https://i.stack.imgur.com/pRNgo.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/pRNgo.png\" alt=\"enter image description here\"></a></p>\n\n<p>Not sure what else I can add here. Hard to find anything related to that error but its clear it's not finding something along the way. </p>\n\n<p>any help would be more that appreciated. Thanks all. </p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 786, "user_id": 2502372, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ETaor.jpg?s=128&g=1", "display_name": "Lucas Wieloch", "link": "https://stackoverflow.com/users/2502372/lucas-wieloch"}, "edited": false, "score": 0, "creation_date": 1536667556, "post_id": 52275502, "comment_id": 91498503, "body": "You need to change the Rails action that you want to redirect and use a <code>redirect_to</code> pointing to the NodeJS API url. <a href=\"https://api.rubyonrails.org/classes/ActionController/Redirecting.html\" rel=\"nofollow noreferrer\">Here</a> you can find <code>redirect_to</code> documentation"}, {"owner": {"reputation": 1331, "user_id": 1361124, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/HNipK.jpg?s=128&g=1", "display_name": "BastienSander", "link": "https://stackoverflow.com/users/1361124/bastiensander"}, "reply_to_user": {"reputation": 786, "user_id": 2502372, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ETaor.jpg?s=128&g=1", "display_name": "Lucas Wieloch", "link": "https://stackoverflow.com/users/2502372/lucas-wieloch"}, "edited": false, "score": 0, "creation_date": 1536670503, "post_id": 52275502, "comment_id": 91500462, "body": "I am trying with something like <code>class Api::V2::RedirectController &lt; Api::BaseController   skip_authorization_check    def apiV3     redirect_to &#39;http:&#47;&#47;XXXX&#47;api&#47;v3&#39;   end end </code>  But I can&#39;t find any success"}, {"owner": {"reputation": 786, "user_id": 2502372, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ETaor.jpg?s=128&g=1", "display_name": "Lucas Wieloch", "link": "https://stackoverflow.com/users/2502372/lucas-wieloch"}, "edited": false, "score": 0, "creation_date": 1536670752, "post_id": 52275502, "comment_id": 91500669, "body": "That is the way to do it on Rails. What happens after the redirect? What do you get as response? can you post your <code>BaseController</code> code?"}, {"owner": {"reputation": 1331, "user_id": 1361124, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/HNipK.jpg?s=128&g=1", "display_name": "BastienSander", "link": "https://stackoverflow.com/users/1361124/bastiensander"}, "reply_to_user": {"reputation": 786, "user_id": 2502372, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ETaor.jpg?s=128&g=1", "display_name": "Lucas Wieloch", "link": "https://stackoverflow.com/users/2502372/lucas-wieloch"}, "edited": false, "score": 0, "creation_date": 1536670966, "post_id": 52275502, "comment_id": 91500814, "body": "Lots of things, you&#39;re right !  I am trying without. As a reponse I don&#39;t have anything, the server is not responding even if it has no errors in the console."}, {"owner": {"reputation": 786, "user_id": 2502372, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ETaor.jpg?s=128&g=1", "display_name": "Lucas Wieloch", "link": "https://stackoverflow.com/users/2502372/lucas-wieloch"}, "edited": false, "score": 1, "creation_date": 1536671192, "post_id": 52275502, "comment_id": 91500968, "body": "Not even a status code? That&#39;s odd. Can you provide more details? Try posting request log and <code>BaseController</code> code."}, {"owner": {"reputation": 1331, "user_id": 1361124, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/HNipK.jpg?s=128&g=1", "display_name": "BastienSander", "link": "https://stackoverflow.com/users/1361124/bastiensander"}, "reply_to_user": {"reputation": 786, "user_id": 2502372, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ETaor.jpg?s=128&g=1", "display_name": "Lucas Wieloch", "link": "https://stackoverflow.com/users/2502372/lucas-wieloch"}, "edited": false, "score": 0, "creation_date": 1536671675, "post_id": 52275502, "comment_id": 91501317, "body": "Edited with more infos"}, {"owner": {"reputation": 786, "user_id": 2502372, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ETaor.jpg?s=128&g=1", "display_name": "Lucas Wieloch", "link": "https://stackoverflow.com/users/2502372/lucas-wieloch"}, "edited": false, "score": 0, "creation_date": 1536672391, "post_id": 52275502, "comment_id": 91501828, "body": "Hmm, everything seems OK on those logs to me. You can see 302 redirect to the location you specified. Which means that if there is an error, it could be on NodeJS application, or <code>ActionController</code> (although it&#39;s unlikely since logs are OK). Can you perform this action directly on NodeJS API?"}, {"owner": {"reputation": 1331, "user_id": 1361124, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/HNipK.jpg?s=128&g=1", "display_name": "BastienSander", "link": "https://stackoverflow.com/users/1361124/bastiensander"}, "reply_to_user": {"reputation": 786, "user_id": 2502372, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ETaor.jpg?s=128&g=1", "display_name": "Lucas Wieloch", "link": "https://stackoverflow.com/users/2502372/lucas-wieloch"}, "edited": false, "score": 0, "creation_date": 1536676365, "post_id": 52275502, "comment_id": 91504636, "body": "I think I understand, it seems to be because I redirect to the exact route I wrote but not the path, the query params &amp; the body right ?"}, {"owner": {"reputation": 786, "user_id": 2502372, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ETaor.jpg?s=128&g=1", "display_name": "Lucas Wieloch", "link": "https://stackoverflow.com/users/2502372/lucas-wieloch"}, "edited": false, "score": 0, "creation_date": 1536680318, "post_id": 52275502, "comment_id": 91507132, "body": "Indeed, yes. I found <a href=\"https://stackoverflow.com/questions/2144391/ruby-on-rails-post-parameters-on-redirect-to\">this post</a> on the topic, it will point you to the correct solution."}], "owner": {"reputation": 1331, "user_id": 1361124, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/HNipK.jpg?s=128&g=1", "display_name": "BastienSander", "link": "https://stackoverflow.com/users/1361124/bastiensander"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 488, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1536671602, "creation_date": 1536667358, "last_edit_date": 1536671602, "question_id": 52275502, "link": "https://stackoverflow.com/questions/52275502/ruby-on-rails-redirect-entire-request", "title": "Ruby On Rails - Redirect entire request", "body": "<p>I have a <code>Rails API 4.2.10</code> and a NodeJS API.</p>\n\n<p>Some of the Rails Request are deprecated and needs to be redirected to the NodeJS API.</p>\n\n<p>I would like to not do the redirection by my WebServer (NgInx) but somewhere in Rails.</p>\n\n<p>I would like to redirect the entire request => Url, Headers, body....\nAnd return the NodeJS API body &amp; status code.</p>\n\n<p>Being a noob in ruby I tried some like making the requests myself but the Rails API still uses the create methods &amp; so the related objects for example.</p>\n\n<p>Here is my controller code :</p>\n\n<pre><code> class Api::V2::RedirectController &lt; ActionController::API\n\n   def apiV3\n     redirect_to 'http://api-v3-node/api/v3'   end\n\n end\n</code></pre>\n\n<p>When I try with Postman, I get logs but \"Could not get any response\"</p>\n\n<p>Here are the corresponding outputs :</p>\n\n<pre><code>[2018-09-11T13:08:12.633224 #61]  INFO -- : Started POST \"/api/v2/notes?token=[FILTERED]\" for 172.19.0.1 at 2018-09-11 13:08:12 +0000\n[2018-09-11T13:08:12.656050 #61]  INFO -- : {:_method=&gt;\"POST\", :_path=&gt;\"/api/v2/notes\", :_format=&gt;:json, :_controller=&gt;\"Api::V2::RedirectController\", :_action=&gt;\"apiV3\", :_status=&gt;302, :_duration=&gt;1.05, :_view=&gt;0.0, :_location=&gt;\"http://api-v3-node/api/v3\", :short_message=&gt;\"[302] POST /api/v2/notes (Api::V2::RedirectController#apiV3)\"}\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "docker", "rubygems", "bundler"], "answers": [{"comments": [{"owner": {"reputation": 7734, "user_id": 2490003, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/3dRD0.png?s=128&g=1", "display_name": "user2490003", "link": "https://stackoverflow.com/users/2490003/user2490003"}, "edited": false, "score": 0, "creation_date": 1570825217, "post_id": 52274402, "comment_id": 103051097, "body": "This is the unfortunate answer, i ran into this as well. Before you upgrade your entire droplet, check what else is using memory. For me it was the current docker containers running <code>puma</code> web server and other things. You can analyze memory usage with <code>top</code> (hit shift + <code>&gt;</code> once to sort by <code>MEM %</code>). Items that start in <code>bundle</code> are probably ruby processes started with <code>bundle exec</code>. I stopped the containers and rebuilt and it worked. While building I run this as a cheap way to capture available mem every second: <code>while sleep 1; do cat &#47;proc&#47;meminfo | grep MemFree &gt;&gt; ~&#47;out; done</code>"}], "tags": [], "owner": {"reputation": 533, "user_id": 771564, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/49bd4c92dcc00d019e3f6a2a858b803f?s=128&d=identicon&r=PG", "display_name": "Peter Mellett", "link": "https://stackoverflow.com/users/771564/peter-mellett"}, "is_accepted": true, "score": 3, "last_activity_date": 1536663687, "creation_date": 1536663687, "answer_id": 52274402, "question_id": 52274102, "link": "https://stackoverflow.com/questions/52274102/rails-bundle-install-failed-with-docker/52274402#52274402", "title": "Rails Bundle Install failed with Docker", "body": "<blockquote>\n  <p>Cannot allocate memory - /usr/local/bin/ruby -r ./siteconf20180911-15-1atjs2q.rb\n  extconf.rb 2>&amp;1</p>\n</blockquote>\n\n<p>This line indicates that your Digital Ocean droplet doesn't have enough RAM to build your dependencies and therefore the docker build fails.</p>\n\n<p>I've had the same problem and unfortunately you just need more resources.</p>\n\n<p>Alternatively you could build the image, tag and push it to a docker repository then pull and run it on your DO droplet to avoid the build step.</p>\n"}, {"tags": [], "owner": {"reputation": 761, "user_id": 7786120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3acd54907ef6cb3d7de0ebd91177850d?s=128&d=identicon&r=PG&f=1", "display_name": "Akshay Goyal", "link": "https://stackoverflow.com/users/7786120/akshay-goyal"}, "is_accepted": false, "score": 1, "last_activity_date": 1536673829, "creation_date": 1536673829, "answer_id": 52277527, "question_id": 52274102, "link": "https://stackoverflow.com/questions/52274102/rails-bundle-install-failed-with-docker/52277527#52277527", "title": "Rails Bundle Install failed with Docker", "body": "<p>Use alpine version of ruby. It will consume much less space. For ex: <code>FROM ruby:2.5.1-alpine</code></p>\n"}], "owner": {"reputation": 47, "user_id": 6862097, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c6aa8004ef5e6d65486edf420ab324b?s=128&d=identicon&r=PG&f=1", "display_name": "Anandha Kumar", "link": "https://stackoverflow.com/users/6862097/anandha-kumar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 834, "favorite_count": 0, "accepted_answer_id": 52274402, "answer_count": 2, "score": 0, "last_activity_date": 1536673829, "creation_date": 1536662553, "last_edit_date": 1536663312, "question_id": 52274102, "link": "https://stackoverflow.com/questions/52274102/rails-bundle-install-failed-with-docker", "title": "Rails Bundle Install failed with Docker", "body": "<p>I tried installing Rails with docker, I got the below error</p>\n\n<pre><code>Installing websocket-driver 0.6.5 with native extensions\nGem::Ext::BuildError: ERROR: Failed to build gem native extension.\n\ncurrent directory:\n/usr/local/bundle/gems/websocket-driver-0.6.5/ext/websocket-driver\n/usr/local/bin/ruby -r ./siteconf20180911-15-1atjs2q.rb extconf.rb\nCannot allocate memory - /usr/local/bin/ruby -r ./siteconf20180911-15-1atjs2q.rb\nextconf.rb 2&gt;&amp;1\n\nGem files will remain installed in /usr/local/bundle/gems/websocket-driver-0.6.5\nfor inspection.\nResults logged to\n/usr/local/bundle/extensions/x86_64-linux/2.5.0/websocket-driver-0.6.5/gem_make.out\n\nAn error occurred while installing websocket-driver (0.6.5), and Bundler cannot\ncontinue.\nMake sure that `gem install websocket-driver -v '0.6.5' --source\n'https://rubygems.org/'` succeeds before bundling.\n\nIn Gemfile:\n  rails was resolved to 5.1.6, which depends on\n    actioncable was resolved to 5.1.6, which depends on\n      websocket-driver\n</code></pre>\n\n<p>Here my docker file</p>\n\n<pre><code>FROM ruby:latest\n\nRUN apt-get -y update &amp;&amp; apt-get install -y curl\n\nRUN curl -sL https://deb.nodesource.com/setup_8.x | bash -\n\nRUN apt-get -y update &amp;&amp; apt-get -y install nodejs\n\nRUN mkdir -p /app\n\nWORKDIR /app\n\nCOPY . /app\n\nRUN gem install rails\n\nRUN  /app/bin/setup\n\nRUN chmod -R 755 /app\n\nEXPOSE 3000\n\nCMD [\"bundle\", \"exec\", \"puma\", \"-C\", \"config/puma.rb\",\"-e\",\"alpha\"]\n</code></pre>\n\n<p>I tried installing in my mac machine its working good. I bought a new ubuntu 16.04 server from the digital ocean and try installing the same. I got this error. I am using Docker version 18.03.1-ce, build 9ee9f40. </p>\n\n<p>In my app/bin/setup I'm running below commands</p>\n\n<pre><code>#!/usr/bin/env ruby\nrequire 'pathname'\nrequire 'fileutils'\ninclude FileUtils\n\n# path to your application root.\nAPP_ROOT = Pathname.new File.expand_path('../../', __FILE__)\n\ndef system!(*args)\n  system(*args) || abort(\"\\n== Command #{args} failed ==\")\nend\n\nchdir APP_ROOT do\n  # This script is a starting point to setup your application.\n  # Add necessary setup steps to this file.\n\n  puts '== Installing dependencies =='\n  system! 'gem install bundler --conservative'\n  system('bundle check') || system!('bundle install')\n\n  puts \"\\n== Removing old tempfiles ==\"\n  system! 'bin/rails tmp:clear'\n\n  puts \"\\n== Precompiling Assets ==\"\n  system! 'bin/rails assets:precompile'\n\n  puts \"\\n== Restarting application server ==\"\n  system! 'bin/rails restart'\nend\n</code></pre>\n\n<p>I tried with ruby:latest, ruby:2.4.1 nothing works. </p>\n\n<p>After few suggestions I added sudo apt-get install ruby-dev in my Dockerfile but this also doesn't work</p>\n"}, {"tags": ["ruby", "shell", "vagrant"], "comments": [{"owner": {"reputation": 38307, "user_id": 2057388, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ceef8c04f66cd0e2bd360ef6abc14a81?s=128&d=identicon&r=PG", "display_name": "\u0417\u0435\u043b\u0451\u043d\u044b\u0439", "link": "https://stackoverflow.com/users/2057388/%d0%97%d0%b5%d0%bb%d1%91%d0%bd%d1%8b%d0%b9"}, "edited": false, "score": 0, "creation_date": 1536660105, "post_id": 52273109, "comment_id": 91493985, "body": "How it&#39;s fails? Do you know what the command <code>sudo su</code> does? <code>sudo</code> execute command as another user, <code>su</code> run a command with substitute user and group."}, {"owner": {"reputation": 107, "user_id": 5445033, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/4ef5857f9895dea99907b35ea7f1a57a?s=128&d=identicon&r=PG&f=1", "display_name": "johnson", "link": "https://stackoverflow.com/users/5445033/johnson"}, "reply_to_user": {"reputation": 38307, "user_id": 2057388, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ceef8c04f66cd0e2bd360ef6abc14a81?s=128&d=identicon&r=PG", "display_name": "\u0417\u0435\u043b\u0451\u043d\u044b\u0439", "link": "https://stackoverflow.com/users/2057388/%d0%97%d0%b5%d0%bb%d1%91%d0%bd%d1%8b%d0%b9"}, "edited": false, "score": 0, "creation_date": 1536660541, "post_id": 52273109, "comment_id": 91494272, "body": "so it should be sudo su root"}, {"owner": {"reputation": 107, "user_id": 5445033, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/4ef5857f9895dea99907b35ea7f1a57a?s=128&d=identicon&r=PG&f=1", "display_name": "johnson", "link": "https://stackoverflow.com/users/5445033/johnson"}, "reply_to_user": {"reputation": 38307, "user_id": 2057388, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ceef8c04f66cd0e2bd360ef6abc14a81?s=128&d=identicon&r=PG", "display_name": "\u0417\u0435\u043b\u0451\u043d\u044b\u0439", "link": "https://stackoverflow.com/users/2057388/%d0%97%d0%b5%d0%bb%d1%91%d0%bd%d1%8b%d0%b9"}, "edited": false, "score": 0, "creation_date": 1536660553, "post_id": 52273109, "comment_id": 91494284, "body": "then it should work right"}, {"owner": {"reputation": 107, "user_id": 5445033, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/4ef5857f9895dea99907b35ea7f1a57a?s=128&d=identicon&r=PG&f=1", "display_name": "johnson", "link": "https://stackoverflow.com/users/5445033/johnson"}, "reply_to_user": {"reputation": 38307, "user_id": 2057388, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ceef8c04f66cd0e2bd360ef6abc14a81?s=128&d=identicon&r=PG", "display_name": "\u0417\u0435\u043b\u0451\u043d\u044b\u0439", "link": "https://stackoverflow.com/users/2057388/%d0%97%d0%b5%d0%bb%d1%91%d0%bd%d1%8b%d0%b9"}, "edited": false, "score": 0, "creation_date": 1536660597, "post_id": 52273109, "comment_id": 91494312, "body": "but i am getting error as /home/midhun/lab/virtualbox/Vagrantfile:18: warning: Insecure world writable dir /opt in PATH, mode 040777"}], "owner": {"reputation": 107, "user_id": 5445033, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/4ef5857f9895dea99907b35ea7f1a57a?s=128&d=identicon&r=PG&f=1", "display_name": "johnson", "link": "https://stackoverflow.com/users/5445033/johnson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 54, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1536660331, "creation_date": 1536659073, "last_edit_date": 1536660331, "question_id": 52273109, "link": "https://stackoverflow.com/questions/52273109/login-as-root-to-shell-using-ruby-script", "title": "Login as root to shell using ruby script", "body": "<p>I want to login as root and run the remaining script</p>\n\n<p>for that i used </p>\n\n<p><strong>system 'sudo su'</strong> but it fails.Here is the ruby script.</p>\n\n<p>My requirement is to login as root on the system  by prompting for password  and then become the root user and run the remaining script.Please help me i am new to ruby</p>\n\n<pre><code># -*- mode: ruby -*-\n# vi: set ft=ruby :\nserver_disk='server.vdi'\ndesktop_disk='desktop.vdi'\nVagrant.configure(2) do |config|\n config.vm.box = \"centos/7\"\n config.vm.define \"classroom\" do |s|\n  s.vbguest.auto_update = false\n  s.vm.network \"private_network\", ip: \"192.168.33.254\"\n  s.vm.synced_folder \".\", \"/vagrant\", disabled: true\n  #s.vm.synced_folder \"../repos\", \"/repos\", owner: \"root\", group: \"root\"\n  s.vm.synced_folder \"scripts/classroom\", \"/usr/local/scripts\", type: \"rsync\", owner: \"root\", group: \"root\"\n  s.vm.provision \"shell\", inline: &lt;&lt;-SHELL\n   chmod u+x /usr/local/scripts/classroom.sh\n   /usr/local/scripts/classroom.sh\n  SHELL\n end\n system 'sudo su'\n config.vm.define \"server\" do |a|\n  a.vbguest.auto_update = false\n  a.vm.provider \"virtualbox\" do |v|\n   unless File.exist?(server_disk)\n    v.customize ['createhd', '--filename', server_disk, '--size', 20 * 1024]\n   end\n   v.customize ['storageattach', :id, '--storagectl', 'IDE Controller', '--port', 1, '--device', 0, '--type', 'hdd', '--medium', server_disk]\n   end\n  a.vm.network \"private_network\", ip: \"192.168.33.11\"\n  a.vm.synced_folder \".\", \"/vagrant\", disabled: true\n  a.vm.synced_folder \"scripts/server\", \"/usr/local/scripts\", type: \"rsync\", owner: \"root\", group: \"root\"\n  a.vm.provision \"shell\", inline: &lt;&lt;-SHELL\n   chmod u+x /usr/local/scripts/server.sh\n   /usr/local/scripts/server.sh\n  SHELL\n  end \n config.vm.define \"desktop\" do |b|\n  b.vbguest.auto_update = false\n  b.vm.provider \"virtualbox\" do |v|\n   unless File.exist?(desktop_disk)\n    v.customize ['createhd', '--filename', desktop_disk, '--size', 20 * 1024]\n   end\n   v.customize ['storageattach', :id, '--storagectl', 'IDE Controller', '--port', 1, '--device', 0, '--type', 'hdd', '--medium', desktop_disk]\n   end\n  b.vm.network \"private_network\", ip: \"192.168.33.10\"\n  b.vm.synced_folder \".\", \"/vagrant\", disabled: true\n  b.vm.synced_folder \"scripts/desktop\", \"/usr/local/scripts\", type: \"rsync\", owner: \"root\", group: \"root\"\n  b.vm.provision \"shell\", inline: &lt;&lt;-SHELL\n   chmod u+x /usr/local/scripts/desktop.sh\n   /usr/local/scripts/desktop.sh\n  SHELL\n  end\nend\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-5"], "comments": [{"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1536656107, "post_id": 52272023, "comment_id": 91491531, "body": "What does the <code>matches</code> table/model look like? What have you tried? Will this query be ran frequently? (In which case, have you looked into adding a <code>counter</code> cache column?)"}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1536656184, "post_id": 52272023, "comment_id": 91491569, "body": "Do you need to optimise fetching both values in a single query, or are these two separate queries you need to execute?"}, {"owner": {"reputation": 117, "user_id": 10068674, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-8gRv54FhhWE/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7oH6R244hnLFuogLjfnpdDcQc_9-w/mo/photo.jpg?sz=128", "display_name": "some thing", "link": "https://stackoverflow.com/users/10068674/some-thing"}, "reply_to_user": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1536656517, "post_id": 52272023, "comment_id": 91491749, "body": "@Tim Sorry I&#39;ve updated my question. It is for my leaderboard so I think this will be run frequently. Anything would do but if it can be done by single query much better but i don&#39;t think it&#39;s possible with one query."}, {"owner": {"reputation": 6207, "user_id": 5117953, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/Ca0RW.jpg?s=128&g=1", "display_name": "Vishal", "link": "https://stackoverflow.com/users/5117953/vishal"}, "edited": false, "score": 0, "creation_date": 1536658013, "post_id": 52272023, "comment_id": 91492712, "body": "@something can you try this <code>Stat .select(&quot;user_id, ( sum(points) &#47; count(*)) as avg&quot;)</code> ? you will get your output in <code>avg </code> attribute"}], "answers": [{"comments": [{"owner": {"reputation": 117, "user_id": 10068674, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-8gRv54FhhWE/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7oH6R244hnLFuogLjfnpdDcQc_9-w/mo/photo.jpg?sz=128", "display_name": "some thing", "link": "https://stackoverflow.com/users/10068674/some-thing"}, "edited": false, "score": 0, "creation_date": 1536657239, "post_id": 52272286, "comment_id": 91492222, "body": "Hmmm it seems like this code gives <code>matches_count</code> = to total number of match. I need is number of match that player played."}, {"owner": {"reputation": 117, "user_id": 10068674, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-8gRv54FhhWE/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7oH6R244hnLFuogLjfnpdDcQc_9-w/mo/photo.jpg?sz=128", "display_name": "some thing", "link": "https://stackoverflow.com/users/10068674/some-thing"}, "edited": false, "score": 0, "creation_date": 1536657347, "post_id": 52272286, "comment_id": 91492289, "body": "And yes you&#39;re right user_id and match_id pair is unique."}, {"owner": {"reputation": 13441, "user_id": 2199600, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8sl6u.jpg?s=128&g=1", "display_name": "Igor Drozdov", "link": "https://stackoverflow.com/users/2199600/igor-drozdov"}, "reply_to_user": {"reputation": 117, "user_id": 10068674, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-8gRv54FhhWE/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7oH6R244hnLFuogLjfnpdDcQc_9-w/mo/photo.jpg?sz=128", "display_name": "some thing", "link": "https://stackoverflow.com/users/10068674/some-thing"}, "edited": false, "score": 2, "creation_date": 1536657636, "post_id": 52272286, "comment_id": 91492474, "body": "the code should give the number of matches the player played, because the query is grouped by <code>user_id</code>. Have you tried and received wrong results?"}, {"owner": {"reputation": 117, "user_id": 10068674, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-8gRv54FhhWE/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7oH6R244hnLFuogLjfnpdDcQc_9-w/mo/photo.jpg?sz=128", "display_name": "some thing", "link": "https://stackoverflow.com/users/10068674/some-thing"}, "edited": false, "score": 0, "creation_date": 1536658422, "post_id": 52272286, "comment_id": 91492956, "body": "my bad I got it wrong i&#39;ve got a default stat with empty match_id so that user can have default 0 stat that&#39;s why it&#39;s displaying 2 now I&#39;ve modified it with where.not(match_id: nil). Thank you!"}], "tags": [], "owner": {"reputation": 13441, "user_id": 2199600, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8sl6u.jpg?s=128&g=1", "display_name": "Igor Drozdov", "link": "https://stackoverflow.com/users/2199600/igor-drozdov"}, "is_accepted": true, "score": 3, "last_activity_date": 1536656288, "creation_date": 1536656288, "answer_id": 52272286, "question_id": 52272023, "link": "https://stackoverflow.com/questions/52272023/sum-of-object-and-compute/52272286#52272286", "title": "Sum of object and compute", "body": "<p>I assume, that every stat has unique <code>user_id</code> and <code>match_id</code> pair, then the following request will do the trick:</p>\n\n<pre><code>Stat\n  .group(:user_id)\n  .select(\"user_id, count(*) as matches_count, sum(points) as sum_points\")\n</code></pre>\n\n<p>As a result, you'll receive a collection of the following objects:</p>\n\n<pre><code>#&lt;ActiveRecord::Relation [#&lt;Stat id: nil, user_id: 1&gt;, #&lt;Stat id: nil, user_id: 2&gt;]&gt;\n</code></pre>\n\n<p>Every object has <code>sum_points</code> and <code>matches_count</code> methods available:</p>\n\n<pre><code>stats = Stat\n  .group(:user_id)\n  .select(\"user_id, count(*) as matches_count, sum(points) as sum_points\")\n\nstats.first.user_id # =&gt; returns user_id\nstats.first.matches_count # =&gt; returns the number of matches played\nstats.first.sum_points # =&gt; returns the number of points earned\n</code></pre>\n"}], "owner": {"reputation": 117, "user_id": 10068674, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-8gRv54FhhWE/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7oH6R244hnLFuogLjfnpdDcQc_9-w/mo/photo.jpg?sz=128", "display_name": "some thing", "link": "https://stackoverflow.com/users/10068674/some-thing"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 62, "favorite_count": 0, "accepted_answer_id": 52272286, "answer_count": 1, "score": 0, "last_activity_date": 1536720423, "creation_date": 1536655366, "last_edit_date": 1536720423, "question_id": 52272023, "link": "https://stackoverflow.com/questions/52272023/sum-of-object-and-compute", "title": "Sum of object and compute", "body": "<p>I've got stat model : </p>\n\n<pre><code>Stat(id: integer, points: float, user_id: integer, match_id: integer)\n</code></pre>\n\n<p>right now here's my code:</p>\n\n<pre><code>stat = Stat.where.not(points: 0).group(:user_id).sum(\"points\")\n</code></pre>\n\n<p>what I need is to get the sum of points of each player then get how many matches they have then (sum of points / match count). With the code above I can only get the sum of each player.</p>\n\n<p><strong>EDIT</strong></p>\n\n<pre><code>Stat(id: integer, points: float, user_id: integer, match_id: integer, team_id: integer)\n</code></pre>\n\n<p>For match model: </p>\n\n<pre><code> Match(id: integer, team_a_id: integer, team_b_id: integer)\n</code></pre>\n\n<p><strong>EDIT</strong></p>\n\n<p>Here's my code now:</p>\n\n<pre><code>stat.each do |f|\n  new_value = (f.sum_points.to_f / f.matches_count.to_f)\n  f.sum_points = new_value.round(2)\n  a &lt;&lt; f\nend\n\nnew_stat = a.sort_by(&amp;:sum_points).reverse.first(10).flatten\n</code></pre>\n\n<p>I have to change the value of <code>sum_points</code> on each data what if I got a lot of data so it will take time is there a way to minimize it? What I need is the first top 10.</p>\n"}, {"tags": ["ruby", "shell"], "comments": [{"owner": {"reputation": 1594, "user_id": 2681997, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/qgKiM.jpg?s=128&g=1", "display_name": "Ajay Barot", "link": "https://stackoverflow.com/users/2681997/ajay-barot"}, "edited": false, "score": 0, "creation_date": 1536668383, "post_id": 52271919, "comment_id": 91499045, "body": "This might help you <a href=\"https://stackoverflow.com/q/166347/2681997\">stackoverflow.com/q/166347/2681997</a>. You can run any shell command in ruby using Backticks (or back-ticks)."}, {"owner": {"reputation": 31, "user_id": 10342796, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c6689e65ee9728365ebd263dbca2c30a?s=128&d=identicon&r=PG&f=1", "display_name": "jnass", "link": "https://stackoverflow.com/users/10342796/jnass"}, "reply_to_user": {"reputation": 1594, "user_id": 2681997, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/qgKiM.jpg?s=128&g=1", "display_name": "Ajay Barot", "link": "https://stackoverflow.com/users/2681997/ajay-barot"}, "edited": false, "score": 0, "creation_date": 1536941028, "post_id": 52271919, "comment_id": 91618187, "body": "I will try. Thank you"}], "owner": {"reputation": 31, "user_id": 10342796, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c6689e65ee9728365ebd263dbca2c30a?s=128&d=identicon&r=PG&f=1", "display_name": "jnass", "link": "https://stackoverflow.com/users/10342796/jnass"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 467, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1536668607, "creation_date": 1536655038, "last_edit_date": 1536668089, "question_id": 52271919, "link": "https://stackoverflow.com/questions/52271919/metasploit-ruby-script-to-execute-shell-commands", "title": "metasploit ruby script to execute shell commands", "body": "<p>I am trying to make a metasploit script to execute a shell command. \nThe commands that I want to be execute in metasploit is the following</p>\n\n<pre><code>shell\ncd /data/data/com.metasploit.stage/files\nsh and.sh\nexit\n</code></pre>\n\n<p>I'm not familiar with ruby. Can anybody tell me how I can make it to work \nI try to use <code>exec('shell')</code> for the first command but it doesn't work.</p>\n"}, {"tags": ["ruby", "selenium", "webdriver", "capybara", "capybara-webkit"], "answers": [{"tags": [], "owner": {"reputation": 42014, "user_id": 2709090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/238c2b7cde2c817fc9a5a2b8eaa2ffad?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Walpole", "link": "https://stackoverflow.com/users/2709090/thomas-walpole"}, "is_accepted": true, "score": 1, "last_activity_date": 1536680063, "creation_date": 1536680063, "answer_id": 52279528, "question_id": 52270519, "link": "https://stackoverflow.com/questions/52270519/how-to-access-selenium-rotation-from-capybara/52279528#52279528", "title": "How to access selenium rotation= from capybara", "body": "<p>The only driver the <code>Rotatable</code> module is included into is the remote driver (Selenium::WebDriver::Remote::Driver) - <a href=\"https://github.com/SeleniumHQ/selenium/blob/master/rb/lib/selenium/webdriver/remote/driver.rb#L31\" rel=\"nofollow noreferrer\">https://github.com/SeleniumHQ/selenium/blob/master/rb/lib/selenium/webdriver/remote/driver.rb#L31</a> - so that's the only one the <code>rotation=</code> method is supported in.  You are using the local chrome driver (Selenium::WebDriver::Chrome::Driver) where the method is not supported/implemented.</p>\n"}], "owner": {"reputation": 1845, "user_id": 574923, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/YGvbp.jpg?s=128&g=1", "display_name": "Nils_e", "link": "https://stackoverflow.com/users/574923/nils-e"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 79, "favorite_count": 0, "accepted_answer_id": 52279528, "answer_count": 1, "score": 0, "last_activity_date": 1536680063, "creation_date": 1536649920, "question_id": 52270519, "link": "https://stackoverflow.com/questions/52270519/how-to-access-selenium-rotation-from-capybara", "title": "How to access selenium rotation= from capybara", "body": "<p>I am trying to access the rotation= definition and my IDE (RubyMine) does show it has the correct path there with this line and I can read the rotatable.rb file that it lives in.</p>\n\n<pre><code>page.driver.browser.rotation = :portrait\n</code></pre>\n\n<p>I also tried</p>\n\n<pre><code>Capybara.current_session.driver.browser.rotation = :portrait\n</code></pre>\n\n<p>But when it runs I get this error</p>\n\n<pre><code>undefined method `rotation=' for #&lt;Selenium::WebDriver::Chrome::Driver:0x00007fc80a90b210&gt; (NoMethodError)\n</code></pre>\n\n<p>I have checked the docs here, as well. <a href=\"https://www.rubydoc.info/gems/selenium-webdriver/Selenium/WebDriver/DriverExtensions/Rotatable\" rel=\"nofollow noreferrer\">https://www.rubydoc.info/gems/selenium-webdriver/Selenium/WebDriver/DriverExtensions/Rotatable</a></p>\n\n<p>Any advice on what I am doing incorrectly?</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 6207, "user_id": 5117953, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/Ca0RW.jpg?s=128&g=1", "display_name": "Vishal", "link": "https://stackoverflow.com/users/5117953/vishal"}, "edited": false, "score": 0, "creation_date": 1536650871, "post_id": 52270466, "comment_id": 91488715, "body": "In which table you want to post this params and why ?"}, {"owner": {"reputation": 63, "user_id": 9281878, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Qef8x.jpg?s=128&g=1", "display_name": "AksharaDL", "link": "https://stackoverflow.com/users/9281878/aksharadl"}, "reply_to_user": {"reputation": 6207, "user_id": 5117953, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/Ca0RW.jpg?s=128&g=1", "display_name": "Vishal", "link": "https://stackoverflow.com/users/5117953/vishal"}, "edited": false, "score": 0, "creation_date": 1536651566, "post_id": 52270466, "comment_id": 91489072, "body": "user should able to slect the colour, position , and user_avatar and the values should get saved in those tables"}, {"owner": {"reputation": 18856, "user_id": 1359650, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/dffc4318ac93e728a26c8e8b51b4eb37?s=128&d=identicon&r=PG", "display_name": "jvillian", "link": "https://stackoverflow.com/users/1359650/jvillian"}, "edited": false, "score": 0, "creation_date": 1536652195, "post_id": 52270466, "comment_id": 91489408, "body": "Since you&#39;re submitting to your <code>ChatbotsController</code>, you should show that code. Also, your form only has a field for <code>:colour</code>. Where are the other fields (<code>position</code>, and <code>user_avatar</code>)?"}, {"owner": {"reputation": 6207, "user_id": 5117953, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/Ca0RW.jpg?s=128&g=1", "display_name": "Vishal", "link": "https://stackoverflow.com/users/5117953/vishal"}, "edited": false, "score": 0, "creation_date": 1536658306, "post_id": 52270466, "comment_id": 91492883, "body": "are you passing any field like user avatar and position ?"}, {"owner": {"reputation": 63, "user_id": 9281878, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Qef8x.jpg?s=128&g=1", "display_name": "AksharaDL", "link": "https://stackoverflow.com/users/9281878/aksharadl"}, "edited": false, "score": 0, "creation_date": 1536659392, "post_id": 52270466, "comment_id": 91493581, "body": "I have updated show.html.erb"}], "owner": {"reputation": 63, "user_id": 9281878, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Qef8x.jpg?s=128&g=1", "display_name": "AksharaDL", "link": "https://stackoverflow.com/users/9281878/aksharadl"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 50, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1536651802, "creation_date": 1536649704, "last_edit_date": 1536651802, "question_id": 52270466, "link": "https://stackoverflow.com/questions/52270466/how-to-post-the-values-from-chat-controller-to-other-tables-using-rails", "title": "how to post the values from chat controller to other tables using rails", "body": "<p>I wanted know, how to post the values from the chat controller to other tables using rails.</p>\n\n<pre><code>class Chat &lt; ApplicationRecord\nbelongs_to :user\nhas_many :visitors\nhas_many :themes\n\nclass Colour &lt; ApplicationRecord\nhas_many :themes\nhas_many :chatbots, through: :themes\nhas_many :user_avatars, through: :themes\nvalidates :hash_code, presence: true\n\nclass UserAvatar &lt; ApplicationRecord\nbelongs_to :user\nhas_many :themes\nhas_many :chatbots, through: :themes\nhas_many :colours, through: :themes\nvalidates :image_icon,:presence =&gt; true\n\nclass Theme &lt; ApplicationRecord\nbelongs_to :chatbot\nbelongs_to :user_avatar\nbelongs_to :colour\nvalidates :position, presence: true\n</code></pre>\n\n<p>Here in chat i should able to select colour, position, user avatar and it should be saved in those table, but here I dont know how to post the values from chat controller to other tables (for selecting the colour I am using color-picker)</p>\n\n<p>code for chat_controller is given below </p>\n\n<pre><code>class ChatsController &lt; ApplicationController\nlayout 'dashboard'\nbefore_action :authenticate_user!\n\ndef index\n    @chatbot = Chatbot.all.where(:user_id =&gt; current_user.id)\nend\n\ndef new\n    @chatbot = Chatbot.new\nend\n\ndef show\n    @chatbot = Chatbot.find_by_id(params[:id])\n\nend\n\ndef edit\n    @chatbot = Chatbot.find_by_id(params[:id])\nend\n\n\ndef destroy\n    @chatbot = Chatbot.find_by_id(params[:id])\n    if @chatbot.destroy\n        flash[:success] = \"Successfully deleted!\"\n    else\n        flash[:success] = \"Deletion Failed!\"\n    end\nend\n\ndef create\n     @colour = Colour.new(colour_params)\n     if @colour.save\n        redirect_to chatbots_path\n     end\n    end\n\nprivate\n  def colour_params\n  params.require(:colour).permit(:hash_code)\nend\ndef chatbot_params\n    params.require(:chatbot).permit(:id,:name,:description,:embed_id)\nend\nend\n\n\n\nshow.html.erb\n\n\n&lt;%= form_for  @chatbot, :url =&gt; {:controller =&gt; 'chatbots', :action =&gt; \n\"create\" }, html: { method: :post } do |f| %&gt;\n &lt;%= f.label \"Select Theme Color\" %&gt;\n  &lt;%= f.hidden_field :colour_ids %&gt;\n     &lt;%= f.text_field :colour, class: \"color-picker\", id: \"theme-picker\" %&gt;\n    &lt;%= f.submit \"Save\" , class: \"btn btn-primary\"%&gt;\n&lt;% end %&gt;\n\n# code for position-select\n\n\n# code for user avatar\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "paypal", "paypal-sandbox", "paypal-rest-sdk"], "comments": [{"owner": {"reputation": 1831, "user_id": 4160532, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Ey34JagqMzQ/AAAAAAAAAAI/AAAAAAAAABo/G70W8D2LXM4/photo.jpg?sz=128", "display_name": "Kedarnag Mukanahallipatna", "link": "https://stackoverflow.com/users/4160532/kedarnag-mukanahallipatna"}, "edited": false, "score": 1, "creation_date": 1536650250, "post_id": 52270423, "comment_id": 91488382, "body": "Have you looked at <a href=\"https://github.com/paypal/PayPal-Ruby-SDK\" rel=\"nofollow noreferrer\">this</a> ? This gem provides methods that help you make payments, get payment details and a lot more."}, {"owner": {"reputation": 101, "user_id": 2203818, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/1156d358b8c7b148836547b3adaa53c2?s=128&d=identicon&r=PG", "display_name": "kolbykskk", "link": "https://stackoverflow.com/users/2203818/kolbykskk"}, "reply_to_user": {"reputation": 1831, "user_id": 4160532, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Ey34JagqMzQ/AAAAAAAAAAI/AAAAAAAAABo/G70W8D2LXM4/photo.jpg?sz=128", "display_name": "Kedarnag Mukanahallipatna", "link": "https://stackoverflow.com/users/4160532/kedarnag-mukanahallipatna"}, "edited": false, "score": 0, "creation_date": 1536674860, "post_id": 52270423, "comment_id": 91503610, "body": "I did see that but I didn&#39;t realize I could use that the same way, to allow users to authorize with a button and then I can access their payments. Thank you! I will try it out."}, {"owner": {"reputation": 1831, "user_id": 4160532, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Ey34JagqMzQ/AAAAAAAAAAI/AAAAAAAAABo/G70W8D2LXM4/photo.jpg?sz=128", "display_name": "Kedarnag Mukanahallipatna", "link": "https://stackoverflow.com/users/4160532/kedarnag-mukanahallipatna"}, "edited": false, "score": 0, "creation_date": 1536676996, "post_id": 52270423, "comment_id": 91505024, "body": "Yup, that gem should serve all the requirements that you&#39;re looking for. You can always comeback here, if you run into any issues."}, {"owner": {"reputation": 101, "user_id": 2203818, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/1156d358b8c7b148836547b3adaa53c2?s=128&d=identicon&r=PG", "display_name": "kolbykskk", "link": "https://stackoverflow.com/users/2203818/kolbykskk"}, "reply_to_user": {"reputation": 1831, "user_id": 4160532, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Ey34JagqMzQ/AAAAAAAAAAI/AAAAAAAAABo/G70W8D2LXM4/photo.jpg?sz=128", "display_name": "Kedarnag Mukanahallipatna", "link": "https://stackoverflow.com/users/4160532/kedarnag-mukanahallipatna"}, "edited": false, "score": 0, "creation_date": 1536707044, "post_id": 52270423, "comment_id": 91518772, "body": "I don&#39;t see any resources for authorization. @KedarnagMukanahallipatna"}, {"owner": {"reputation": 101, "user_id": 2203818, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/1156d358b8c7b148836547b3adaa53c2?s=128&d=identicon&r=PG", "display_name": "kolbykskk", "link": "https://stackoverflow.com/users/2203818/kolbykskk"}, "reply_to_user": {"reputation": 1831, "user_id": 4160532, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Ey34JagqMzQ/AAAAAAAAAAI/AAAAAAAAABo/G70W8D2LXM4/photo.jpg?sz=128", "display_name": "Kedarnag Mukanahallipatna", "link": "https://stackoverflow.com/users/4160532/kedarnag-mukanahallipatna"}, "edited": false, "score": 0, "creation_date": 1536707906, "post_id": 52270423, "comment_id": 91518979, "body": "Turns out I needed both gems, I have it working now."}, {"owner": {"reputation": 101, "user_id": 2203818, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/1156d358b8c7b148836547b3adaa53c2?s=128&d=identicon&r=PG", "display_name": "kolbykskk", "link": "https://stackoverflow.com/users/2203818/kolbykskk"}, "reply_to_user": {"reputation": 1831, "user_id": 4160532, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Ey34JagqMzQ/AAAAAAAAAAI/AAAAAAAAABo/G70W8D2LXM4/photo.jpg?sz=128", "display_name": "Kedarnag Mukanahallipatna", "link": "https://stackoverflow.com/users/4160532/kedarnag-mukanahallipatna"}, "edited": false, "score": 0, "creation_date": 1536735206, "post_id": 52270423, "comment_id": 91526007, "body": "@KedarnagMukanahallipatna actually, I was mistaken. I&#39;m stuck and not sure where to go from here. Can you help? I&#39;m using both gems but when I try to pull payments, it&#39;s pulling the payments from my App&#39;s sandbox account, not the account that I authenticated with."}, {"owner": {"reputation": 1831, "user_id": 4160532, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Ey34JagqMzQ/AAAAAAAAAAI/AAAAAAAAABo/G70W8D2LXM4/photo.jpg?sz=128", "display_name": "Kedarnag Mukanahallipatna", "link": "https://stackoverflow.com/users/4160532/kedarnag-mukanahallipatna"}, "edited": false, "score": 0, "creation_date": 1536735369, "post_id": 52270423, "comment_id": 91526097, "body": "Sure. Can you share the configuration you have done ? <code>paypal.yml</code>"}, {"owner": {"reputation": 101, "user_id": 2203818, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/1156d358b8c7b148836547b3adaa53c2?s=128&d=identicon&r=PG", "display_name": "kolbykskk", "link": "https://stackoverflow.com/users/2203818/kolbykskk"}, "reply_to_user": {"reputation": 1831, "user_id": 4160532, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Ey34JagqMzQ/AAAAAAAAAAI/AAAAAAAAABo/G70W8D2LXM4/photo.jpg?sz=128", "display_name": "Kedarnag Mukanahallipatna", "link": "https://stackoverflow.com/users/4160532/kedarnag-mukanahallipatna"}, "edited": false, "score": 0, "creation_date": 1536735666, "post_id": 52270423, "comment_id": 91526281, "body": "Sure, added it to the original post. I did not change any of the &quot;Credentials for Classic APIs&quot; other than the sandbox_email_address"}, {"owner": {"reputation": 1831, "user_id": 4160532, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Ey34JagqMzQ/AAAAAAAAAAI/AAAAAAAAABo/G70W8D2LXM4/photo.jpg?sz=128", "display_name": "Kedarnag Mukanahallipatna", "link": "https://stackoverflow.com/users/4160532/kedarnag-mukanahallipatna"}, "reply_to_user": {"reputation": 101, "user_id": 2203818, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/1156d358b8c7b148836547b3adaa53c2?s=128&d=identicon&r=PG", "display_name": "kolbykskk", "link": "https://stackoverflow.com/users/2203818/kolbykskk"}, "edited": false, "score": 0, "creation_date": 1536735817, "post_id": 52270423, "comment_id": 91526372, "body": "Let us <a href=\"https://chat.stackoverflow.com/rooms/179877/discussion-between-kedarnag-mukanahallipatna-and-kolbykskk\">continue this discussion in chat</a>."}], "owner": {"reputation": 101, "user_id": 2203818, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/1156d358b8c7b148836547b3adaa53c2?s=128&d=identicon&r=PG", "display_name": "kolbykskk", "link": "https://stackoverflow.com/users/2203818/kolbykskk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 78, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1536735585, "creation_date": 1536649489, "last_edit_date": 1536735585, "question_id": 52270423, "link": "https://stackoverflow.com/questions/52270423/ruby-paypal-permissions-sdk-gem", "title": "Ruby PayPal Permissions SDK Gem", "body": "<p>I'm using this gem stated in the title: <a href=\"https://github.com/paypal/permissions-sdk-ruby\" rel=\"nofollow noreferrer\">https://github.com/paypal/permissions-sdk-ruby</a></p>\n\n<p>I got everything to work, but it seems the gem only has built-in methods that request basic and advanced user info. However, I need to get transaction/payment data. What's the best way to go about this?</p>\n\n<p>Do I use the tokens to now make requests manually via HTTParty or such?</p>\n\n<p>paypal.yml</p>\n\n<pre><code>test: &amp;default\n\n  # Credentials for REST APIs\n  client_id: AZeKLB9rkwMumoPHGg_xG-sMOtEREDh3VeSP2cgbdorScFDkGBAoG2WQ0ZNtIgdKM6eaCfYqKmXzxDqS\n  client_secret: ELXfwfA4wGU_PEwjIiYllCvs7gQCYsaWyN_yzXux5XSrHv6ZxGEUasnSIHvkAZ4-rYXTcvC4Igy097xo\n\n  # Mode can be 'live' or 'sandbox'\n  mode: sandbox\n\n  # Credentials for Classic APIs\n  app_id: APP-80W284485P519543T\n  username: jb-us-seller_api1.paypal.com\n  password: WX4WTU3S8MY44S7F\n  signature: AFcWxV21C7fd0v3bYYYRCpSSRl31A7yDhhsPUU2XhtMoZXsWHFxu-RWy\n  # # With Certificate\n  # cert_path: \"config/cert_key.pem\"\n  sandbox_email_address: kolbywebdev-facilitator@gmail.com\n\n  # # IP Address\n  # ip_address: 127.0.0.1\n  # # HTTP Proxy\n  # http_proxy: http://proxy-ipaddress:3129/\n\ndevelopment:\n  &lt;&lt;: *default\n\nproduction:\n  &lt;&lt;: *default\n  mode: live\n</code></pre>\n"}, {"tags": ["ruby", "user-input", "sublimetext", "gets"], "comments": [{"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1536645968, "post_id": 52269569, "comment_id": 91486487, "body": "No way this code enters an infinite loop. There is <i>no magic</i> in coding. Try to change first <code>print</code> to <code>puts</code> and see what\u2019s happening. Maybe it\u2019s your OS is too dumb."}, {"owner": {"reputation": 86, "user_id": 1466958, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F2ZlA.jpg?s=128&g=1", "display_name": "zealouscoder", "link": "https://stackoverflow.com/users/1466958/zealouscoder"}, "reply_to_user": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1536646549, "post_id": 52269569, "comment_id": 91486712, "body": "Ok. What if you run the code in sublime text and try <b>command+b</b>?"}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1536646620, "post_id": 52269569, "comment_id": 91486747, "body": "I do not run code from editors. Editors are made to edit the code, not to run it."}, {"owner": {"reputation": 446, "user_id": 8356015, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PaYtW.jpg?s=128&g=1", "display_name": "Ravi Teja Dandu", "link": "https://stackoverflow.com/users/8356015/ravi-teja-dandu"}, "edited": false, "score": 1, "creation_date": 1536646796, "post_id": 52269569, "comment_id": 91486807, "body": "Ran this code. No infinite loop."}, {"owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 0, "creation_date": 1536647415, "post_id": 52269569, "comment_id": 91487057, "body": "Cannot be reproduced as is. The infinite loop must be coming from somewhere other than what you wrote here, such as additional environment, script that calls this piece of code."}, {"owner": {"reputation": 13379, "user_id": 1033027, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/b56ea1c43a4ecb1060ec8bcb8d2bce78?s=128&d=identicon&r=PG", "display_name": "Jules", "link": "https://stackoverflow.com/users/1033027/jules"}, "edited": false, "score": 0, "creation_date": 1536648079, "post_id": 52269569, "comment_id": 91487377, "body": "This code does not contain an infinite loop. Whatever&#39;s causing it <i>must</i> be before the first line of your snippet."}, {"owner": {"reputation": 9971, "user_id": 8255744, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de22299534b5a8ed244ee8ff4aa6c481?s=128&d=identicon&r=PG&f=1", "display_name": "Simple Lime", "link": "https://stackoverflow.com/users/8255744/simple-lime"}, "edited": false, "score": 1, "creation_date": 1536648215, "post_id": 52269569, "comment_id": 91487434, "body": "The question makes it sound like you enter an infinite loop before you reach the first line of your code: &quot;it enters an infinite loop <b>instead</b> of prompting user to &#39;Enter something&#39;&quot;"}], "answers": [{"tags": [], "owner": {"reputation": 171, "user_id": 8049767, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/81389d5c791911b87d3930a380a9dd70?s=128&d=identicon&r=PG&f=1", "display_name": "Joe Rivera", "link": "https://stackoverflow.com/users/8049767/joe-rivera"}, "is_accepted": false, "score": 0, "last_activity_date": 1536648184, "creation_date": 1536648184, "answer_id": 52270092, "question_id": 52269569, "link": "https://stackoverflow.com/questions/52269569/accepting-user-input-using-gets-leads-to-infinite-loop-in-sublime-text/52270092#52270092", "title": "Accepting user input using gets leads to infinite loop in Sublime text", "body": "<p>There is no obvious reason why this code should lock into an infinite loop. I ran it just for kicks under <code>ruby 2.4.1p111</code>. Code runs as the described expectation, no infinite loop.</p>\n"}, {"tags": [], "owner": {"reputation": 101, "user_id": 5629073, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-djnHIQew9Yw/AAAAAAAAAAI/AAAAAAAAABE/G3pLZ4yDGro/photo.jpg?sz=128", "display_name": "Nuttapon", "link": "https://stackoverflow.com/users/5629073/nuttapon"}, "is_accepted": false, "score": 0, "last_activity_date": 1536648388, "creation_date": 1536648388, "answer_id": 52270151, "question_id": 52269569, "link": "https://stackoverflow.com/questions/52269569/accepting-user-input-using-gets-leads-to-infinite-loop-in-sublime-text/52270151#52270151", "title": "Accepting user input using gets leads to infinite loop in Sublime text", "body": "<p>It's not an infinite loop. It's just waiting for the input data.</p>\n\n<p>It's quite the basic flow of a CLI app to ask the user for input:</p>\n\n<p>And also using the <code>#gets</code> method to capture, store, and operator on that input.</p>\n"}, {"tags": [], "owner": {"reputation": 9663, "user_id": 5239030, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/76JEw.png?s=128&g=1", "display_name": "iGian", "link": "https://stackoverflow.com/users/5239030/igian"}, "is_accepted": true, "score": 1, "last_activity_date": 1536650163, "creation_date": 1536650163, "answer_id": 52270589, "question_id": 52269569, "link": "https://stackoverflow.com/questions/52269569/accepting-user-input-using-gets-leads-to-infinite-loop-in-sublime-text/52270589#52270589", "title": "Accepting user input using gets leads to infinite loop in Sublime text", "body": "<p>Sublime does not allow to input data, so <strong>it seems like an infinite loop</strong>.\nAlso, you don't see <code>Enter something</code> because the output is \"enqueued on the stream\". You need to flush the output in order to see it. Look at this topic: <a href=\"https://stackoverflow.com/questions/39920517/how-to-print-stdout-immediately\">How to print stdout immediately?</a></p>\n\n<p>So, to see the first line printed in Sublime add <code>STDOUT.flush</code> after <code>print</code> (<code>puts</code>).</p>\n\n<pre><code>puts 'Enter something'\nSTDOUT.flush\ninput_user = gets.strip\n</code></pre>\n\n<p>Now, if you build from Sublime (CMD + B), you can see the first line printed, but the execution still hangs because Sublime does not pick up the input.</p>\n\n<p>For a proper test <strong>run on terminal</strong>, there it works correctly, even without flushing.</p>\n"}], "owner": {"reputation": 86, "user_id": 1466958, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F2ZlA.jpg?s=128&g=1", "display_name": "zealouscoder", "link": "https://stackoverflow.com/users/1466958/zealouscoder"}, "delete_vote_count": 1, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 161, "favorite_count": 0, "closed_date": 1536650201, "accepted_answer_id": 52270589, "answer_count": 3, "score": -4, "last_activity_date": 1556168747, "creation_date": 1536645745, "last_edit_date": 1556168747, "question_id": 52269569, "link": "https://stackoverflow.com/questions/52269569/accepting-user-input-using-gets-leads-to-infinite-loop-in-sublime-text", "closed_reason": "Not suitable for this site", "title": "Accepting user input using gets leads to infinite loop in Sublime text", "body": "<p>When I run this code in Sublime text, it enters an infinite loop instead of prompting user to 'Enter something'. </p>\n\n<pre><code>print 'Enter something'\ninput_user = gets.strip\nif(input_user == 'something')\n    puts 'You are smart'\nelse\n    puts 'You are not'\nend\n</code></pre>\n\n<ol>\n<li>Can someone please help me understand why this is happening? </li>\n<li>Are there any other efficient ways to accept user input in ruby other than <code>gets</code> (without using third party libraries)?</li>\n</ol>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 2, "creation_date": 1536645328, "post_id": 52269467, "comment_id": 91486244, "body": "The name must be fully qualified: <code>res = Bottle::Operation.new</code>."}, {"owner": {"reputation": 19, "user_id": 9088469, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/07f878be15c6628f2ebc6936ba56ae82?s=128&d=identicon&r=PG&f=1", "display_name": "Shan_Boy", "link": "https://stackoverflow.com/users/9088469/shan-boy"}, "reply_to_user": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1536645903, "post_id": 52269467, "comment_id": 91486454, "body": "thanks it worked, but Is it the right way to make use of Begin and End Functionality?"}], "answers": [{"comments": [{"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "reply_to_user": {"reputation": 7565, "user_id": 1021515, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/Z9QcP.jpg?s=128&g=1", "display_name": "mwp", "link": "https://stackoverflow.com/users/1021515/mwp"}, "edited": false, "score": 0, "creation_date": 1536646112, "post_id": 52269550, "comment_id": 91486539, "body": "@mwp nah, indeed, thanks, fixed. I don\u2019t remember much of ruby, should have checked against docs."}, {"owner": {"reputation": 167912, "user_id": 240443, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/495d675e3bc42ed1dee469e2ce701f1b?s=128&d=identicon&r=PG", "display_name": "Amadan", "link": "https://stackoverflow.com/users/240443/amadan"}, "edited": false, "score": 0, "creation_date": 1536649582, "post_id": 52269550, "comment_id": 91488086, "body": "You could also use it to pack several statements into one expression. For example: <code>x = 2; y = begin puts &quot;x is #{x}&quot;; x end * 3</code>. It is not often this is useful, but inserting debug statements into expressions is one way to use it."}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "reply_to_user": {"reputation": 167912, "user_id": 240443, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/495d675e3bc42ed1dee469e2ce701f1b?s=128&d=identicon&r=PG", "display_name": "Amadan", "link": "https://stackoverflow.com/users/240443/amadan"}, "edited": false, "score": 1, "creation_date": 1536650049, "post_id": 52269550, "comment_id": 91488283, "body": "@Amadan yeah, I was almost to mention it, but IMHO it should be avoided in favour of <code>Object#tap</code>: <code>y = 42.tap { |x| puts &quot;The answer is: #{x}&quot; }</code>."}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 3, "creation_date": 1536650150, "post_id": 52269550, "comment_id": 91488332, "body": "It&#39;s also useful in combination with modifier <code>while</code> / <code>until</code>, e.g. <code>begin ... end while condition</code> \u2013 this runs the body at least once, regardless of the condition."}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "reply_to_user": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1536650306, "post_id": 52269550, "comment_id": 91488412, "body": "@Stefan indeed, thanks, I have updated the answer with that one."}], "tags": [], "owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "is_accepted": true, "score": 3, "last_activity_date": 1536650283, "last_edit_date": 1536650283, "creation_date": 1536645647, "answer_id": 52269550, "question_id": 52269467, "link": "https://stackoverflow.com/questions/52269467/ruby-begin-and-end-block-usage/52269550#52269550", "title": "Ruby Begin and End Block usage", "body": "<blockquote>\n  <p>What is the correct way to use begin and end block? how and where to use</p>\n</blockquote>\n\n<p>Typically you don\u2019t use <code>begin</code>/<code>end</code> at all.</p>\n\n<p>The error in your code is that outside of the <code>module</code>, the class name must be fully qualified. That said, the following will fix the issue:</p>\n\n<pre><code>- res = Operation.new\n+ res = Bottle::Operation.new\n</code></pre>\n\n<hr>\n\n<p><code>begin</code>/<code>end</code> might be needed when:</p>\n\n<ul>\n<li>you need a block to be executed within <code>while</code> / <code>until</code> (credits to @Stefan);</li>\n<li>you want to <code>rescue</code> an exception;</li>\n<li>you want to have an <code>ensure</code> block.</li>\n</ul>\n\n<p>The summing up:</p>\n\n<pre><code>begin\n  puts \"[begin]\"\n  raise \"from [begin]\"\nrescue StandardError =&gt; e\n  puts \"[rescue]\"\n  puts e.message\nensure\n  puts \"[ensure]\"\nend\n\n#\u21d2\u00a0[begin]\n#  [rescue]\n#  from [begin]\n#  [ensure]\n</code></pre>\n"}], "owner": {"reputation": 19, "user_id": 9088469, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/07f878be15c6628f2ebc6936ba56ae82?s=128&d=identicon&r=PG&f=1", "display_name": "Shan_Boy", "link": "https://stackoverflow.com/users/9088469/shan-boy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 84, "favorite_count": 0, "accepted_answer_id": 52269550, "answer_count": 1, "score": 1, "last_activity_date": 1536650283, "creation_date": 1536645226, "last_edit_date": 1536645363, "question_id": 52269467, "link": "https://stackoverflow.com/questions/52269467/ruby-begin-and-end-block-usage", "title": "Ruby Begin and End Block usage", "body": "<p>I have written the logic to find the \"Bottle's Problem\"</p>\n\n<pre><code>  module Bottle\n      class Operation\n        def input\n          puts 'Enter the number of bottles:'\n          num = gets.chomp.to_i\n          bottle_operation(num)\n        end\n\n        def bottle_operation(num)\n          while (num &lt; 10) &amp;&amp; (num &gt; 0)\n            puts \"#{num} bottles\"\n            num -= 1\n            puts \"One bottle open. #{num} bottles yet to be opened.\"\n          end\n      end\n     end\n     begin\n       res = Operation.new\n       res.input\n     end\n    end\n</code></pre>\n\n<p>I was asked to use Begin and End block outside the module, since its not correct way to use. By doing so I got the following error</p>\n\n<pre><code>module Bottle\n  class Operation\n    def input\n      puts 'Enter the number of bottles:'\n      num = gets.chomp.to_i\n      bottle_operation(num)\n    end\n\n    def bottle_operation(num)\n      while (num &lt; 10) &amp;&amp; (num &gt; 0)\n        puts \"#{num} bottles\"\n        num -= 1\n        puts \"One bottle open. #{num} bottles yet to be opened.\"\n      end\n  end\n end\nend\n\nbegin\n   res = Operation.new\n   res.input\n end\n</code></pre>\n\n<blockquote>\n  <p>ERROR `&lt;main>': uninitialized constant Operation (NameError)</p>\n</blockquote>\n\n<p>What is the correct way to use begin and end block? how and where to use</p>\n"}, {"tags": ["ruby", "google-chrome", "selenium-webdriver", "selenium-chromedriver", "spotify"], "comments": [{"owner": {"reputation": 1, "user_id": 5219158, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-US875f-774Y/AAAAAAAAAAI/AAAAAAAAT3I/qjuqx_syRJc/photo.jpg?sz=128", "display_name": "Matthias Pr&#246;ll", "link": "https://stackoverflow.com/users/5219158/matthias-pr%c3%b6ll"}, "edited": false, "score": 0, "creation_date": 1583785235, "post_id": 52269331, "comment_id": 107226388, "body": "Idk about 1, but about 2: Yeah, spotify works with this solution"}], "owner": {"reputation": 1469, "user_id": 1227960, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/e6c5f5b95e74dce0d8cbe095febd9e00?s=128&d=identicon&r=PG", "display_name": "kukrt", "link": "https://stackoverflow.com/users/1227960/kukrt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 628, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1583785235, "creation_date": 1536644486, "question_id": 52269331, "link": "https://stackoverflow.com/questions/52269331/browsing-spotify-with-headless-chrome-shows-enable-player-in-your-browser", "title": "browsing spotify with headless chrome shows &quot;enable player in your browser&quot;", "body": "<h1>what I want to archive</h1>\n\n<p>I am trying to play spotify in background without showing the player.</p>\n\n<h1>env</h1>\n\n<pre class=\"lang-sh prettyprint-override\"><code>$ uname -a\nDarwin mbp.local 16.7.0 Darwin Kernel Version 16.7.0: Thu Jun 21 20:07:39 PDT 2018; root:xnu-3789.73.14~1/RELEASE_X86_64 x86_64\n\n$ chromedriver --version\nChromeDriver 2.41.578706 (5f725d1b4f0a4acbf5259df887244095596231db)\n\n$ /Applications/Google\\ Chrome.app/Contents/MacOS/Google\\ Chrome --version\nGoogle Chrome 69.0.3497.81\n</code></pre>\n\n<ol>\n<li>normal chromedriver shows and plays spotify without a problem</li>\n<li>headless chromedriver won't</li>\n</ol>\n\n<p><a href=\"https://i.stack.imgur.com/GxmsV.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/GxmsV.png\" alt=\"enter image description here\"></a></p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>Capybara.register_driver :chrome do |app|\n  options = Selenium::WebDriver::Chrome::Options.new\n  options.add_argument(\"user-data-dir=/path/to/profile/dir\")\n  options.add_argument(\"--headless\")\n  options.add_argument(\"--window-size=1280,800\")\n  Capybara::Selenium::Driver.new(app,\n    browser: :chrome,\n    options: options,\n  )\nend\n\nsession = Capybara::Session.new(:chrome)\nsession.visit \"https://spotify.com\"\n# .. login script / login with the same chrome profile without --headless beforehand\nsession.click_on \"Web Player\"\n# this give me the image above \"enable player in your browser\"\nsession.save_screenshot(\"/path/to/a/filename.png\")\n</code></pre>\n\n<h1>my thoughts</h1>\n\n<ol>\n<li>It's \"Widevine Content Decryption Module\" related, and widevine doesn't load-up in headless no matter what?</li>\n<li>If on a headless linux with xvfb + normal chromedriver will play spotify?</li>\n</ol>\n"}, {"tags": ["sql", "ruby", "ruby-on-rails-4", "sqlite"], "comments": [{"owner": {"reputation": 4806, "user_id": 1945697, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/bGRTK.jpg?s=128&g=1", "display_name": "Sloan Thrasher", "link": "https://stackoverflow.com/users/1945697/sloan-thrasher"}, "edited": false, "score": 2, "creation_date": 1536642583, "post_id": 52268947, "comment_id": 91485401, "body": "Edit your question and the rails code that isn&#39;t executing the query, and any error messages you are seeing. Please, no screen shots or images...."}, {"owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 0, "creation_date": 1536642943, "post_id": 52268947, "comment_id": 91485506, "body": "How does your code look so far? How do your models look like? How did you define the association between clients and sales in your models?"}, {"owner": {"reputation": 121, "user_id": 3754535, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/e3e9a6cd050b583ed82c84e99a0e0eb1?s=128&d=identicon&r=PG&f=1", "display_name": "user3754535", "link": "https://stackoverflow.com/users/3754535/user3754535"}, "edited": false, "score": 0, "creation_date": 1536642971, "post_id": 52268947, "comment_id": 91485516, "body": "When I run the query on &quot;DB Browser for SQLite&quot; Windows app, the code runs fine, but when I try to run it in my Rails app it throws a ActiveRecord::StatementInvalid error, that&#39;s why I&#39;m searching if there is a ActiveRecord equivalent to this query."}, {"owner": {"reputation": 121, "user_id": 3754535, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/e3e9a6cd050b583ed82c84e99a0e0eb1?s=128&d=identicon&r=PG&f=1", "display_name": "user3754535", "link": "https://stackoverflow.com/users/3754535/user3754535"}, "edited": false, "score": 0, "creation_date": 1536643253, "post_id": 52268947, "comment_id": 91485585, "body": "My main goal is to build a clients table with a validation of how many sales of the client are over 29 days of antiquity."}, {"owner": {"reputation": 7007, "user_id": 10195153, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VnLka.jpg?s=128&g=1", "display_name": "danblack", "link": "https://stackoverflow.com/users/10195153/danblack"}, "edited": false, "score": 0, "creation_date": 1536644086, "post_id": 52268947, "comment_id": 91485849, "body": "Why is there a mysql tag here? The date criteria should be part of the WHERE criteria. <code>sales.created_at &lt; (julianday(&#39;now&#39;) - 29)</code> maybe."}, {"owner": {"reputation": 121, "user_id": 3754535, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/e3e9a6cd050b583ed82c84e99a0e0eb1?s=128&d=identicon&r=PG&f=1", "display_name": "user3754535", "link": "https://stackoverflow.com/users/3754535/user3754535"}, "edited": false, "score": 0, "creation_date": 1536644680, "post_id": 52268947, "comment_id": 91486032, "body": "I don&#39;t want to exclude the sales that are not over 29 days, I would like just to count them in a column."}], "answers": [{"comments": [{"owner": {"reputation": 121, "user_id": 3754535, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/e3e9a6cd050b583ed82c84e99a0e0eb1?s=128&d=identicon&r=PG&f=1", "display_name": "user3754535", "link": "https://stackoverflow.com/users/3754535/user3754535"}, "edited": false, "score": 0, "creation_date": 1536651010, "post_id": 52270055, "comment_id": 91488782, "body": "Thank you very much, but the code still lack the most important column, the  &quot;outdated_sales&quot; part, that&#39;s the thing I&#39;m looking for."}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1536672070, "post_id": 52270055, "comment_id": 91501615, "body": "Also <code>clients.id == sales.client_id</code> can be removed as it is implied by the <code>join</code> and if it is not removed <code>==</code> should be <code>=</code>."}], "tags": [], "owner": {"reputation": 104, "user_id": 7884173, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kDyf2NzUs6Q/AAAAAAAAAAI/AAAAAAAAABA/XKDrrtxQp0Y/photo.jpg?sz=128", "display_name": "Tushar Kulkarni", "link": "https://stackoverflow.com/users/7884173/tushar-kulkarni"}, "is_accepted": false, "score": 1, "last_activity_date": 1536671986, "last_edit_date": 1536671986, "creation_date": 1536648031, "answer_id": 52270055, "question_id": 52268947, "link": "https://stackoverflow.com/questions/52268947/sql-query-to-rails-activerecord/52270055#52270055", "title": "SQL query to Rails ActiveRecord", "body": "<p>Below could be an equivalent ruby query for the given sql query.</p>\n\n<pre><code>Client.joins(:sales)\n  .where(\"clients.id == sales.client_id AND sales.sku IS NOT IN (?)\", [\"\", nil])\n  .select(\"id, razon, rfc, state, city, count(sales.id) as num_sales\")\n  .order(\"sales.created_at\")\n</code></pre>\n\n<p>Hope this helps.</p>\n"}], "owner": {"reputation": 121, "user_id": 3754535, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/e3e9a6cd050b583ed82c84e99a0e0eb1?s=128&d=identicon&r=PG&f=1", "display_name": "user3754535", "link": "https://stackoverflow.com/users/3754535/user3754535"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 928, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1536671986, "creation_date": 1536642048, "last_edit_date": 1536644911, "question_id": 52268947, "link": "https://stackoverflow.com/questions/52268947/sql-query-to-rails-activerecord", "title": "SQL query to Rails ActiveRecord", "body": "<p>I have the following SQLite query, which is the ActiveRecord equivalent?</p>\n\n<p>My main goal here is to build a clients table with a validation of how many sales of the client are over 29 days of antiquity. Any help is appreciated guys.</p>\n\n<pre><code>select\n    clients.id,\n    clients.razon,\n    clients.rfc,\n    clients.state,\n    clients.city,\n    count(sales.id) AS \"Num sales\",\n    SUM(\n        CASE WHEN (\n            (julianday('now') - julianday(sales.created_at) &gt; 29)\n        ) THEN 1 ELSE 0 END\n    ) AS outdated_sales\nfrom clients\njoin sales\n    where clients.id = sales.client_id\n    and sales.sku != \"\"\nGROUP by sales.client_id\nORDER BY sales.created_at asc;\n</code></pre>\n"}, {"tags": ["ruby", "rspec"], "comments": [{"owner": {"reputation": 2408, "user_id": 704265, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/6509f143119b40d9e09eedd49903866b?s=128&d=identicon&r=PG", "display_name": "Finch_Powers", "link": "https://stackoverflow.com/users/704265/finch-powers"}, "edited": false, "score": 2, "creation_date": 1536633051, "post_id": 52267356, "comment_id": 91483296, "body": "Please provide more details. Can you provide a code sample, input and output?"}, {"owner": {"reputation": 832, "user_id": 5594180, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iv01N.png?s=128&g=1", "display_name": "Sa\u0161a Zejnilovi\u0107", "link": "https://stackoverflow.com/users/5594180/sa%c5%a1a-zejnilovi%c4%87"}, "edited": false, "score": 0, "creation_date": 1536674120, "post_id": 52267356, "comment_id": 91503085, "body": "rest-client natively uses UTF-8, which means the server that is sending the request could be at fault and is sending the date in wrong encoding. Try forcing encoding to UTF-8"}], "answers": [{"tags": [], "owner": {"reputation": 791, "user_id": 4424428, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/346d6b5a83ea67778742c4703a928b59?s=128&d=identicon&r=PG&f=1", "display_name": "16kb", "link": "https://stackoverflow.com/users/4424428/16kb"}, "is_accepted": true, "score": 0, "last_activity_date": 1536681314, "last_edit_date": 1536681314, "creation_date": 1536630700, "answer_id": 52267634, "question_id": 52267356, "link": "https://stackoverflow.com/questions/52267356/issue-with-character-entities-in-xml-output/52267634#52267634", "title": "Issue with character entities in XML output", "body": "<p><strong>Method 1</strong></p>\n\n<p>Since you are using <a href=\"https://github.com/sparklemotion/nokogiri\" rel=\"nofollow noreferrer\">Nokogiri</a>, you could use </p>\n\n<pre><code>Nokogiri::HTML.parse \"&amp;lt;CUST_LAST_NM&amp;gt;Lastname&amp;lt;/CUST_LAST_NM&amp;gt\"\n</code></pre>\n\n<p><strong>Method 2</strong> (If you are using Rails)</p>\n\n<p>If you need this done in the views,</p>\n\n<pre><code>&lt;%= raw '&amp;lt;CUST_LAST_NM&amp;gt;Lastname&amp;lt;/CUST_LAST_NM&amp;gt' %&gt;\n</code></pre>\n\n<p>works too.</p>\n\n<p><strong>Method 3</strong></p>\n\n<p>You could also use the CGI library</p>\n\n<pre><code>CGI.unescapeHTML(\"&amp;lt;CUST_LAST_NM&amp;gt;Lastname&amp;lt;/CUST_LAST_NM&amp;gt\")\n</code></pre>\n"}], "owner": {"reputation": 37, "user_id": 7484701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3930b3dd959734af64955b475d52a2f7?s=128&d=identicon&r=PG&f=1", "display_name": "Kumar-58", "link": "https://stackoverflow.com/users/7484701/kumar-58"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 42, "favorite_count": 0, "accepted_answer_id": 52267634, "answer_count": 1, "score": 0, "last_activity_date": 1536681314, "creation_date": 1536627845, "question_id": 52267356, "link": "https://stackoverflow.com/questions/52267356/issue-with-character-entities-in-xml-output", "title": "Issue with character entities in XML output", "body": "<p>I am using \"rest-client\" to run a GET request and output XML is containing &amp;lt and &amp;gt characters instead of '&lt;>'. I tried using to_xml method but it is not working. I am using NOKOGIRI to search a particular string in the output. </p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"utf-8\"?&gt;\n&lt;string xmlns=\"http://host.xyz.com\"&gt;&amp;lt;NewDataSet&amp;gt;\n&amp;lt;CUST_LAST_NM&amp;gt;Lastname&amp;lt;/CUST_LAST_NM&amp;gt;\n&amp;lt;CUST_FRST_NM&amp;gt;Firstname&amp;lt;/CUST_FRST_NM&amp;gt;\n&amp;lt;CUST_SHRT_NM&amp;gt;short&amp;lt;/CUST_SHRT_NM&amp;gt; \n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "rails-activerecord"], "answers": [{"comments": [{"owner": {"reputation": 18856, "user_id": 1359650, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/dffc4318ac93e728a26c8e8b51b4eb37?s=128&d=identicon&r=PG", "display_name": "jvillian", "link": "https://stackoverflow.com/users/1359650/jvillian"}, "edited": false, "score": 0, "creation_date": 1536632398, "post_id": 52267536, "comment_id": 91483209, "body": "Why not just <code>first</code> instead of <code>limit(1)</code>?"}], "tags": [], "owner": {"reputation": 1142, "user_id": 3562561, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/5455f5135299cdb6b4640148fa176f9f?s=128&d=identicon&r=PG", "display_name": "treiff", "link": "https://stackoverflow.com/users/3562561/treiff"}, "is_accepted": false, "score": 1, "last_activity_date": 1536630574, "last_edit_date": 1536630574, "creation_date": 1536629725, "answer_id": 52267536, "question_id": 52267311, "link": "https://stackoverflow.com/questions/52267311/how-to-transform-this-sql-query-into-rails-active-record/52267536#52267536", "title": "How to transform this SQL Query into Rails Active Record?", "body": "<p>I think the simplest you could do this is by adding a scope on your <code>Location</code> model to return the most recent location.  </p>\n\n<p>While this doesn't give you the same SQL as you wrote manually it should provide the same results.</p>\n\n<p><strong>location.rb</strong></p>\n\n<pre><code>scope :most_recent, -&gt; { order(created_at: :desc).limit(1) }\n</code></pre>\n\n<p>Then something like:</p>\n\n<pre><code>user = User.last\nuser.locations.most_recent\n</code></pre>\n\n<p>This should give you this SQL output which will return the most recently created location for the user.</p>\n\n<pre><code>SELECT  \"locations\".* FROM \"locations\" WHERE \"locations\".\"user_id\" = $1  ORDER BY \"locations\".\"created_at\" DESC LIMIT 1\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2630, "user_id": 1706670, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c7a901672979d5870dc01f9787c0b2a4?s=128&d=identicon&r=PG", "display_name": "PGill", "link": "https://stackoverflow.com/users/1706670/pgill"}, "is_accepted": true, "score": 3, "last_activity_date": 1536632840, "creation_date": 1536632840, "answer_id": 52267862, "question_id": 52267311, "link": "https://stackoverflow.com/questions/52267311/how-to-transform-this-sql-query-into-rails-active-record/52267862#52267862", "title": "How to transform this SQL Query into Rails Active Record?", "body": "<p>You can create a <code>has_one</code> association </p>\n\n<pre><code>class User\n  has_one :last_location, -&gt; { order 'created_at DESC' }, class_name: \"Location\"\nend\n</code></pre>\n\n<p>Then you can do </p>\n\n<pre><code>users = User.includes(:last_location)\nusers.each { |u| u.last_location; ... }\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 966, "user_id": 6384607, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/dc77165b05cef4d2d4f6ed65d6bf9b21?s=128&d=identicon&r=PG&f=1", "display_name": "t s", "link": "https://stackoverflow.com/users/6384607/t-s"}, "edited": false, "score": 0, "creation_date": 1536662983, "post_id": 52268381, "comment_id": 91495656, "body": "Not an active record query !"}, {"owner": {"reputation": 106, "user_id": 10313230, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/21061b249a7307894515bfb911b5b657?s=128&d=identicon&r=PG&f=1", "display_name": "tekuri", "link": "https://stackoverflow.com/users/10313230/tekuri"}, "reply_to_user": {"reputation": 966, "user_id": 6384607, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/dc77165b05cef4d2d4f6ed65d6bf9b21?s=128&d=identicon&r=PG&f=1", "display_name": "t s", "link": "https://stackoverflow.com/users/6384607/t-s"}, "edited": false, "score": 0, "creation_date": 1536671641, "post_id": 52268381, "comment_id": 91501295, "body": "Thank you, for review.It will give active record collection by using above query"}], "tags": [], "owner": {"reputation": 106, "user_id": 10313230, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/21061b249a7307894515bfb911b5b657?s=128&d=identicon&r=PG&f=1", "display_name": "tekuri", "link": "https://stackoverflow.com/users/10313230/tekuri"}, "is_accepted": false, "score": 0, "last_activity_date": 1536643776, "last_edit_date": 1536643776, "creation_date": 1536637768, "answer_id": 52268381, "question_id": 52267311, "link": "https://stackoverflow.com/questions/52267311/how-to-transform-this-sql-query-into-rails-active-record/52268381#52268381", "title": "How to transform this SQL Query into Rails Active Record?", "body": "<p>You can try this: </p>\n\n<pre><code> User.where(\"id in (SELECT user_id from locations l \n        INNER JOIN users u ON u.id = l.user_id ORDER BY l.created_at desc LIMIT 1)\")\n</code></pre>\n"}], "owner": {"reputation": 1269, "user_id": 1442577, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/fc268665968fd71388b7dcbb221e86fa?s=128&d=identicon&r=PG", "display_name": "Rafael Fragoso", "link": "https://stackoverflow.com/users/1442577/rafael-fragoso"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 102, "favorite_count": 0, "accepted_answer_id": 52267862, "answer_count": 3, "score": 0, "last_activity_date": 1536811610, "creation_date": 1536627387, "last_edit_date": 1536811610, "question_id": 52267311, "link": "https://stackoverflow.com/questions/52267311/how-to-transform-this-sql-query-into-rails-active-record", "title": "How to transform this SQL Query into Rails Active Record?", "body": "<p>I have the following query:</p>\n\n<pre><code>SELECT * FROM users \nJOIN locations \nON locations.id = (\n    SELECT id from locations \n    WHERE locations.user_id = users.id \n    ORDER BY locations.created_at \n    desc LIMIT 1\n)\n</code></pre>\n\n<p>And this basically means that I have 2 models (User, Locations) in which User has_many Locations.</p>\n\n<p>The result I expect is: For each user, I want to pull their last location.</p>\n\n<p>How can I do that using only ActiveRecord?</p>\n"}, {"tags": ["php", "html", "json", "ruby"], "comments": [{"owner": {"reputation": 312, "user_id": 9163595, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/uNloV.jpg?s=128&g=1", "display_name": "JamesBond", "link": "https://stackoverflow.com/users/9163595/jamesbond"}, "edited": false, "score": 0, "creation_date": 1536627859, "post_id": 52267309, "comment_id": 91482445, "body": "could you perhaps include your html table"}, {"owner": {"reputation": 11, "user_id": 10344725, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-6agHwBbeyMg/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaORaT1mt0pAIdiRfWHXVE7NoVgrYw/mo/photo.jpg?sz=128", "display_name": "Raghav Chugh", "link": "https://stackoverflow.com/users/10344725/raghav-chugh"}, "reply_to_user": {"reputation": 312, "user_id": 9163595, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/uNloV.jpg?s=128&g=1", "display_name": "JamesBond", "link": "https://stackoverflow.com/users/9163595/jamesbond"}, "edited": false, "score": 0, "creation_date": 1536631663, "post_id": 52267309, "comment_id": 91483075, "body": "Here&#39;s the sample table : <a href=\"http://aryan786.srkm.in/table.html\" rel=\"nofollow noreferrer\">aryan786.srkm.in/table.html</a>  If you convert this table html on given site link. It works just fine but with own code some error.  Would like to understand what they may be using in order to fix issue."}], "answers": [{"tags": [], "owner": {"reputation": 829, "user_id": 10303343, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/n69nR.jpg?s=128&g=1", "display_name": "Marat Badykov", "link": "https://stackoverflow.com/users/10303343/marat-badykov"}, "is_accepted": false, "score": 0, "last_activity_date": 1536628925, "creation_date": 1536628925, "answer_id": 52267463, "question_id": 52267309, "link": "https://stackoverflow.com/questions/52267309/convert-html-table-to-json-http-convertjson-com-html-table-to-json-htm/52267463#52267463", "title": "Convert HTMl table to JSON + http://convertjson.com/html-table-to-json.htm", "body": "<p>You can use JQuery to do that.</p>\n\n<p>Sample table:</p>\n\n<pre><code>&lt;table id='table'&gt;\n    &lt;thead&gt;\n        &lt;tr&gt;\n            &lt;th class='table_head' width='80px'&gt;Header1&lt;/th&gt;\n            &lt;th class='table_head' width='435px'&gt;Header2&lt;/th&gt;\n            &lt;th class='table_head' width='100px'&gt;Header3&lt;/th&gt;\n            &lt;th class='table_head' width='100px'&gt;Header4&lt;/th&gt;\n            &lt;th class='table_head' width='100px'&gt;Header5&lt;/th&gt;\n            &lt;th class='table_head' width='100px'&gt;Header6&lt;/th&gt;\n            &lt;th class='table_head' width='100px'&gt;Header7&lt;/th&gt;\n            &lt;th class='table_head' width='80px'&gt;Header8&lt;/th&gt;\n        &lt;/tr&gt;\n    &lt;/thead&gt;\n    &lt;tbody&gt;\n        &lt;!-- Rows --&gt;\n    &lt;/tbody&gt;\n&lt;/table&gt;\n</code></pre>\n\n<p>For selecting data from table you can use this code</p>\n\n<pre><code>   $('#table tr').each(function (index, tr) {\n        var cols = [];\n\n        //get td of each row and insert it into cols array\n        $(this).find('td').each(function (colIndex, c) {\n            cols.push(c.textContent);\n        });\n\n        //insert this cols(full rows data) array into tableData array\n        tableData.push(cols);\n      });\n</code></pre>\n\n<p>And to encode your data as json you can use <a href=\"https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/JSON/stringify\" rel=\"nofollow noreferrer\">JSON.stringify</a>;</p>\n\n<pre><code>JSON.stringify(tableData) \n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 10344725, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-6agHwBbeyMg/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaORaT1mt0pAIdiRfWHXVE7NoVgrYw/mo/photo.jpg?sz=128", "display_name": "Raghav Chugh", "link": "https://stackoverflow.com/users/10344725/raghav-chugh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 75, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1536628925, "creation_date": 1536627368, "question_id": 52267309, "link": "https://stackoverflow.com/questions/52267309/convert-html-table-to-json-http-convertjson-com-html-table-to-json-htm", "title": "Convert HTMl table to JSON + http://convertjson.com/html-table-to-json.htm", "body": "<p>I am looking for some solution to convert my HTML table data to json. This website is doing similar </p>\n\n<p><a href=\"http://convertjson.com/html-table-to-json.htm\" rel=\"nofollow noreferrer\">http://convertjson.com/html-table-to-json.htm</a></p>\n\n<p>I am looking for help code to convert. I tried some solutions but at some point of end there's issue.</p>\n\n<p>All i need is a json output so i can convert it in array and proceed further.</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 18856, "user_id": 1359650, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/dffc4318ac93e728a26c8e8b51b4eb37?s=128&d=identicon&r=PG", "display_name": "jvillian", "link": "https://stackoverflow.com/users/1359650/jvillian"}, "edited": false, "score": 1, "creation_date": 1536622731, "post_id": 52266807, "comment_id": 91481488, "body": "Perhaps because Rails isn&#39;t loaded when running <code>ruby bin&#47;template_check.rb foo=bar</code>? Have you considered making it a <code>rake</code> task so that Rails is loaded?"}, {"owner": {"reputation": 473, "user_id": 4652341, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/32d243374ec979900e471874a9dc7ad9?s=128&d=identicon&r=PG&f=1", "display_name": "James N", "link": "https://stackoverflow.com/users/4652341/james-n"}, "reply_to_user": {"reputation": 18856, "user_id": 1359650, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/dffc4318ac93e728a26c8e8b51b4eb37?s=128&d=identicon&r=PG", "display_name": "jvillian", "link": "https://stackoverflow.com/users/1359650/jvillian"}, "edited": false, "score": 0, "creation_date": 1536624028, "post_id": 52266807, "comment_id": 91481759, "body": "@jvillian would definitely consider that. the person I am working with wanted a bin script because of how it is going to be used in the future. I was able to get this working by adding <code>require File.expand_path(File.join(File.dirname(__FILE__), &#39;..&#39;, &#39;config&#39;, &#39;environment&#39;))</code> to the top of the file. However, it did take a second to boot up so maybe there is a better way to approach this. I will keep the rake task option in mind."}], "answers": [{"tags": [], "owner": {"reputation": 1420, "user_id": 5045091, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MAqXn.jpg?s=128&g=1", "display_name": "theterminalguy", "link": "https://stackoverflow.com/users/5045091/theterminalguy"}, "is_accepted": false, "score": 0, "last_activity_date": 1536625901, "creation_date": 1536625901, "answer_id": 52267142, "question_id": 52266807, "link": "https://stackoverflow.com/questions/52266807/rails-root-uninitialized-constant/52267142#52267142", "title": "Rails.root - uninitialized constant", "body": "<p>Run with <code>$ rails runner bin/my_class.rb</code>. You can find out more about rails runner <a href=\"https://guides.rubyonrails.org/command_line.html#rails-runner\" rel=\"nofollow noreferrer\">here</a></p>\n"}, {"tags": [], "owner": {"reputation": 106, "user_id": 10313230, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/21061b249a7307894515bfb911b5b657?s=128&d=identicon&r=PG&f=1", "display_name": "tekuri", "link": "https://stackoverflow.com/users/10313230/tekuri"}, "is_accepted": false, "score": 0, "last_activity_date": 1536638494, "creation_date": 1536638494, "answer_id": 52268463, "question_id": 52266807, "link": "https://stackoverflow.com/questions/52266807/rails-root-uninitialized-constant/52268463#52268463", "title": "Rails.root - uninitialized constant", "body": "<pre><code>You can try with\n\nrails r bin/my_class.rb  if your file is under bin\n</code></pre>\n\n<p>other wise you can use</p>\n\n<p>rails r #{file_name}.rb specify the file name</p>\n"}], "owner": {"reputation": 473, "user_id": 4652341, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/32d243374ec979900e471874a9dc7ad9?s=128&d=identicon&r=PG&f=1", "display_name": "James N", "link": "https://stackoverflow.com/users/4652341/james-n"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 551, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1536687335, "creation_date": 1536622570, "last_edit_date": 1536687335, "question_id": 52266807, "link": "https://stackoverflow.com/questions/52266807/rails-root-uninitialized-constant", "title": "Rails.root - uninitialized constant", "body": "<p>I am writing a script located in <code>/bin</code> of a rails 5 project. Basically I am trying to iterate through various files and paths. Something to help me with this effort is <code>Rails.root</code> so I don't have to worry about relative paths etc</p>\n\n<p>The problem is, when I am attempting to use <code>Rails.root</code> in my script, I am getting an error: </p>\n\n<p><code>uninitialized constant Rails (NameError)</code></p>\n\n<p>My script looks something like this</p>\n\n<p><strong>bin/my_class.rb</strong></p>\n\n<pre><code>class MyClass\n  def initialize\n    ...\n  end\n\n  def my_function\n    ...\n    Rails.root.to_s\n  end \nend\n\nMyClass.new.my_function\n</code></pre>\n\n<p>Then i call my script like</p>\n\n<p><code>ruby bin/template_check.rb foo=bar</code></p>\n\n<p>And it's breaking on the line where I am calling <code>Rails.root</code> with the error message: </p>\n\n<p><code>uninitialized constant Rails (NameError)</code></p>\n\n<p>I have tried</p>\n\n<ul>\n<li>moving Rails.root to a constant above the class (thought maybe it was a name conflict or something?). didn't work</li>\n<li>changing the name to <code>::Rails.root.to_s</code>. did not work either</li>\n</ul>\n\n<p>Does anyone know why I cannot access <code>Rails.root</code> inside of my script?</p>\n\n<p><strong>edit</strong>\nI was able to get this resolved by adding </p>\n\n<p><code>require File.expand_path(File.join(File.dirname(__FILE__), '..', 'config', 'environment'))</code> </p>\n\n<p>to the top of my script. This loads rails. as a default, the script is slower, and I'm not a huge fan of loading all of rails just to use <code>Rails.root</code>, but for now it works. </p>\n\n<p>Other solutions like the answers below are to either use <code>rails runner</code> to run the script, or to wrap everything in a rake task. </p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 326, "user_id": 1282499, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/809aea7c5bd0d12d0e23027c1ccb4f24?s=128&d=identicon&r=PG", "display_name": "Susan Wright", "link": "https://stackoverflow.com/users/1282499/susan-wright"}, "edited": false, "score": 0, "creation_date": 1536614476, "post_id": 52265503, "comment_id": 91479337, "body": "Is this minitest? in rspec you definitely need a path, something like <code>post :new, params</code>"}, {"owner": {"reputation": 152277, "user_id": 438992, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/QouOz.jpg?s=128&g=1", "display_name": "Dave Newton", "link": "https://stackoverflow.com/users/438992/dave-newton"}, "edited": false, "score": 0, "creation_date": 1536614591, "post_id": 52265503, "comment_id": 91479377, "body": "A post tests the action, not the model. The syntax depends on what you&#39;re using to test; you have no path here but one seems to be generated, so you&#39;d need to check whatever you&#39;re using."}], "answers": [{"comments": [{"owner": {"reputation": 1006, "user_id": 4594902, "user_type": "registered", "accept_rate": 65, "profile_image": "https://graph.facebook.com/686173344826419/picture?type=large", "display_name": "Ilja KO", "link": "https://stackoverflow.com/users/4594902/ilja-ko"}, "edited": false, "score": 0, "creation_date": 1536615685, "post_id": 52265794, "comment_id": 91479703, "body": "I figured that out too allready but I have a problem with your solution because the <code>category</code> parameter must be there because of the routing so when I dont do the line which you commented out it gives me a routing error. Can you provide in your answer where I should put <code>category: @valid_category</code> to make the routing work?"}, {"owner": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "reply_to_user": {"reputation": 1006, "user_id": 4594902, "user_type": "registered", "accept_rate": 65, "profile_image": "https://graph.facebook.com/686173344826419/picture?type=large", "display_name": "Ilja KO", "link": "https://stackoverflow.com/users/4594902/ilja-ko"}, "edited": false, "score": 0, "creation_date": 1536616052, "post_id": 52265794, "comment_id": 91479831, "body": "If you have a nested route you would call it as: <code>category_posts_path(@valid_category)</code>. Again I&#39;m guessing you have set it up conventionally."}, {"owner": {"reputation": 1006, "user_id": 4594902, "user_type": "registered", "accept_rate": 65, "profile_image": "https://graph.facebook.com/686173344826419/picture?type=large", "display_name": "Ilja KO", "link": "https://stackoverflow.com/users/4594902/ilja-ko"}, "edited": false, "score": 0, "creation_date": 1536616364, "post_id": 52265794, "comment_id": 91479942, "body": "allright the scopes helped me alot. I now did it like this: <code>posts_path(category: @valid_category)</code>. Before that I just put it in front of <code>params:{...}</code> or behind. Now it works. Marked as the right answer. And yes I have put it conventionally but under a <code>locale</code> scope and this again under a <code>*category</code> dynamic wildcard scope"}], "tags": [], "owner": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "is_accepted": true, "score": 0, "last_activity_date": 1536615284, "creation_date": 1536615284, "answer_id": 52265794, "question_id": 52265503, "link": "https://stackoverflow.com/questions/52265503/how-to-properly-post-a-record-in-rails-testing/52265794#52265794", "title": "How to properly post a record in Rails testing", "body": "<p>Provided you have setup the routes according to the <a href=\"https://guides.rubyonrails.org/routing.html#resource-routing-the-rails-default\" rel=\"nofollow noreferrer\">Rails conventions</a> (with <code>resources :posts</code>) you should create a post by send a POST request to <code>/posts</code></p>\n\n<p>You can inspect the actual route by running <code>$ rails routes</code>.</p>\n\n<pre><code>test 'make a new post with invalid title' do\n  log_in_as(@user_archer)\n  # this is not needed in an integration test\n  # - get new_post_path category: @valid_category\n  assert_no_difference 'Post.count' do\n    post posts_path, params: { post: {\n      title:    @invalid_title,\n      body:     @valid_body,\n      user_id:  @valid_user_id ,\n      category: @valid_category}}\n    end\n  end\nend\n</code></pre>\n"}], "owner": {"reputation": 1006, "user_id": 4594902, "user_type": "registered", "accept_rate": 65, "profile_image": "https://graph.facebook.com/686173344826419/picture?type=large", "display_name": "Ilja KO", "link": "https://stackoverflow.com/users/4594902/ilja-ko"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 50, "favorite_count": 0, "accepted_answer_id": 52265794, "answer_count": 1, "score": 0, "last_activity_date": 1536615284, "creation_date": 1536613692, "last_edit_date": 1536614244, "question_id": 52265503, "link": "https://stackoverflow.com/questions/52265503/how-to-properly-post-a-record-in-rails-testing", "title": "How to properly post a record in Rails testing", "body": "<p>I want to test that a creation of a new <code>Post</code> fails in my Rails forum app.</p>\n\n<p>A <code>Post</code> should not be created when there is an empty title present.</p>\n\n<p>I am trying this but it gives me bad URI Error:</p>\n\n<pre><code>Error:\nPostsNewTest#test_make_a_new_post_with_invalid_title:\nURI::InvalidURIError: bad URI(is not URI?): http://www.example.com:80{:params=&gt;{:post=&gt;{:title=&gt;\"\", :body=&gt;\"body\", :user_id=&gt;762146111, :category=&gt;\"general/announcements\"}}}\n    test/integration/posts_new_test.rb:31:in `block (2 levels) in &lt;class:PostsNewTest&gt;'\n    test/integration/posts_new_test.rb:30:in `block in &lt;class:PostsNewTest&gt;'\n</code></pre>\n\n<p>Here is what I try, I fiddled a lot to get it work but I simply don't know how to do it properly. I would be pleased if someone could help me get it right:</p>\n\n<pre><code>  test 'make a new post with invalid title' do\n    log_in_as(@user_archer)\n    get new_post_path category: @valid_category\n    assert_no_difference 'Post.count' do\n      post  params: { post: {title:    @invalid_title,\n                            body:     @valid_body,\n                            user_id:  @valid_user_id ,\n                            category: @valid_category}}\n    end\n  end\n</code></pre>\n\n<p>I dont get the route right where to post because it is not a named route like <code>post_a_Post_path</code></p>\n\n<p>Edit: Extra question does this belong into an Integration Test or should this be part of the Model Test for a <code>Post</code>?</p>\n"}, {"tags": ["ruby", "ubuntu", "vagrant"], "comments": [{"owner": {"reputation": 107, "user_id": 5445033, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/4ef5857f9895dea99907b35ea7f1a57a?s=128&d=identicon&r=PG&f=1", "display_name": "johnson", "link": "https://stackoverflow.com/users/5445033/johnson"}, "edited": false, "score": 1, "creation_date": 1536694744, "post_id": 52264706, "comment_id": 91514314, "body": "On changing the IDECONTROLLER to IDE the issue was fixe"}], "answers": [{"tags": [], "owner": {"reputation": 107, "user_id": 5445033, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/4ef5857f9895dea99907b35ea7f1a57a?s=128&d=identicon&r=PG&f=1", "display_name": "johnson", "link": "https://stackoverflow.com/users/5445033/johnson"}, "is_accepted": false, "score": 0, "last_activity_date": 1536694843, "creation_date": 1536694843, "answer_id": 52283127, "question_id": 52264706, "link": "https://stackoverflow.com/questions/52264706/storage-attach-id-different-from-the-vagrant-customisation-id/52283127#52283127", "title": "storage-attach id different from the vagrant customisation id", "body": "<p>On changing the IDECONTROLLER to IDE the issue was fixed</p>\n"}], "owner": {"reputation": 107, "user_id": 5445033, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/4ef5857f9895dea99907b35ea7f1a57a?s=128&d=identicon&r=PG&f=1", "display_name": "johnson", "link": "https://stackoverflow.com/users/5445033/johnson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 33, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1536694843, "creation_date": 1536609735, "question_id": 52264706, "link": "https://stackoverflow.com/questions/52264706/storage-attach-id-different-from-the-vagrant-customisation-id", "title": "storage-attach id different from the vagrant customisation id", "body": "<p>I am using vagrant and ubuntu16.04 .</p>\n\n<p>When i ran vagrant up i got the error as </p>\n\n<pre><code>A customization command failed:\n\n[\"storageattach\", :id, \"--storagectl\", \"IDE Controller\", \"--port\", 1, \"--device\", 0, \"--type\", \"hdd\", \"--medium\", \"server.vdi\"]\n\nThe following error was experienced:\n\n#&lt;Vagrant::Errors::VBoxManageError: There was an error while executing `VBoxManage`, a CLI used by Vagrant\nfor controlling VirtualBox. The command and stderr is shown below.\n\nCommand: [\"storageattach\", \"538c4e03-f4ea-4adf-af6e-02d303d56f13\", \"--storagectl\", \"IDE Controller\", \"--port\", \"1\", \"--device\", \"0\", \"--type\", \"hdd\", \"--medium\", \"server.vdi\"]\n\nStderr: VBoxManage: error: Could not find a controller named 'IDE Controller'\n&gt;\n\nPlease fix this customization and try again.\n</code></pre>\n\n<p>There seems to be conflict between the id generated by script and virtualbox machines one.</p>\n\n<p>My Vagrant file is</p>\n\n<pre><code># -*- mode: ruby -*-\n# vi: set ft=ruby :\nserver_disk='server.vdi'\ndesktop_disk='desktop.vdi'\nVagrant.configure(2) do |config|\n config.vm.box = \"centos/7\"\n config.vm.define \"classroom\" do |s|\n  s.vbguest.auto_update = false\n  s.vm.network \"private_network\", ip: \"192.168.33.254\"\n  s.vm.synced_folder \".\", \"/vagrant\", disabled: true\n  #s.vm.synced_folder \"../repos\", \"/repos\", owner: \"root\", group: \"root\"\n  s.vm.synced_folder \"scripts/classroom\", \"/usr/local/scripts\", type: \"rsync\", owner: \"root\", group: \"root\"\n  s.vm.provision \"shell\", inline: &lt;&lt;-SHELL\n   chmod u+x /usr/local/scripts/classroom.sh\n   /usr/local/scripts/classroom.sh\n  SHELL\n end\n\n config.vm.define \"server\" do |a|\n  a.vbguest.auto_update = false\n  a.vm.provider \"virtualbox\" do |v|\n   unless File.exist?(server_disk)\n    v.customize ['createhd', '--filename', server_disk, '--size', 20 * 1024]\n   end\n   v.customize ['storageattach', :id, '--storagectl', 'IDE Controller', '--port', 1, '--device', 0, '--type', 'hdd', '--medium', server_disk]\n   end\n  a.vm.network \"private_network\", ip: \"192.168.33.11\"\n  a.vm.synced_folder \".\", \"/vagrant\", disabled: true\n  a.vm.synced_folder \"scripts/server\", \"/usr/local/scripts\", type: \"rsync\", owner: \"root\", group: \"root\"\n  a.vm.provision \"shell\", inline: &lt;&lt;-SHELL\n   chmod u+x /usr/local/scripts/server.sh\n   /usr/local/scripts/server.sh\n  SHELL\n  end\n\n config.vm.define \"desktop\" do |b|\n  b.vbguest.auto_update = false\n  b.vm.provider \"virtualbox\" do |v|\n   unless File.exist?(desktop_disk)\n    v.customize ['createhd', '--filename', desktop_disk, '--size', 20 * 1024]\n   end\n   v.customize ['storageattach', :id, '--storagectl', 'IDE Controller', '--port', 1, '--device', 0, '--type', 'hdd', '--medium', desktop_disk]\n   end\n  b.vm.network \"private_network\", ip: \"192.168.33.10\"\n  b.vm.synced_folder \".\", \"/vagrant\", disabled: true\n  b.vm.synced_folder \"scripts/desktop\", \"/usr/local/scripts\", type: \"rsync\", owner: \"root\", group: \"root\"\n  b.vm.provision \"shell\", inline: &lt;&lt;-SHELL\n   chmod u+x /usr/local/scripts/desktop.sh\n   /usr/local/scripts/desktop.sh\n  SHELL\n  end\nend\n</code></pre>\n\n<p>VBoxManage list vms\ngives output as\n\"ubuntu-server\" {bc38335e-ddf7-48a1-b0be-3df2495b91df}</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "rubygems", "ruby-on-rails-5", "bundle"], "comments": [{"owner": {"reputation": 1612, "user_id": 1146473, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/798f66c6c7e53703e2a30ff911b0e884?s=128&d=identicon&r=PG", "display_name": "ekampp", "link": "https://stackoverflow.com/users/1146473/ekampp"}, "edited": false, "score": 0, "creation_date": 1536648997, "post_id": 52264369, "comment_id": 91487816, "body": "Have you read and handled this note in the installation instructions? <code>Note using v8.h and compiling MiniRacer requires a C++11 standard compiler, more specifically clang 3.5 (or later) or gcc 4.8 (or later).</code> <a href=\"https://github.com/discourse/mini_racer#installation\" rel=\"nofollow noreferrer\">github.com/discourse/mini_racer#installation</a>"}, {"owner": {"reputation": 2208, "user_id": 4061422, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/ZHGRC.png?s=128&g=1", "display_name": "vipin", "link": "https://stackoverflow.com/users/4061422/vipin"}, "reply_to_user": {"reputation": 1612, "user_id": 1146473, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/798f66c6c7e53703e2a30ff911b0e884?s=128&d=identicon&r=PG", "display_name": "ekampp", "link": "https://stackoverflow.com/users/1146473/ekampp"}, "edited": false, "score": 0, "creation_date": 1536651461, "post_id": 52264369, "comment_id": 91489027, "body": "I have tried  many solution stackoverflow..... But issue still remains"}, {"owner": {"reputation": 1612, "user_id": 1146473, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/798f66c6c7e53703e2a30ff911b0e884?s=128&d=identicon&r=PG", "display_name": "ekampp", "link": "https://stackoverflow.com/users/1146473/ekampp"}, "edited": false, "score": 1, "creation_date": 1536662258, "post_id": 52264369, "comment_id": 91495255, "body": "Yes. This isn&#39;t a stack overflow link, though. This is a link to the actual documentation for the gem you&#39;re trying to install."}, {"owner": {"reputation": 2208, "user_id": 4061422, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/ZHGRC.png?s=128&g=1", "display_name": "vipin", "link": "https://stackoverflow.com/users/4061422/vipin"}, "reply_to_user": {"reputation": 1612, "user_id": 1146473, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/798f66c6c7e53703e2a30ff911b0e884?s=128&d=identicon&r=PG", "display_name": "ekampp", "link": "https://stackoverflow.com/users/1146473/ekampp"}, "edited": false, "score": 0, "creation_date": 1536662773, "post_id": 52264369, "comment_id": 91495539, "body": "okay, I tried with this ..... thanks"}, {"owner": {"reputation": 2208, "user_id": 4061422, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/ZHGRC.png?s=128&g=1", "display_name": "vipin", "link": "https://stackoverflow.com/users/4061422/vipin"}, "reply_to_user": {"reputation": 1612, "user_id": 1146473, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/798f66c6c7e53703e2a30ff911b0e884?s=128&d=identicon&r=PG", "display_name": "ekampp", "link": "https://stackoverflow.com/users/1146473/ekampp"}, "edited": false, "score": 0, "creation_date": 1536732763, "post_id": 52264369, "comment_id": 91524729, "body": "no it&#39;s not working on my mac 10.14"}, {"owner": {"reputation": 449, "user_id": 2572921, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nepMs.jpg?s=128&g=1", "display_name": "Ben Toogood", "link": "https://stackoverflow.com/users/2572921/ben-toogood"}, "edited": false, "score": 0, "creation_date": 1536925150, "post_id": 52264369, "comment_id": 91609005, "body": "Have you installed the xcode command line tools? xcode-select --install"}, {"owner": {"reputation": 2208, "user_id": 4061422, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/ZHGRC.png?s=128&g=1", "display_name": "vipin", "link": "https://stackoverflow.com/users/4061422/vipin"}, "edited": false, "score": 0, "creation_date": 1536935584, "post_id": 52264369, "comment_id": 91615234, "body": "Yes already latest version xcode-select installed"}], "answers": [{"comments": [{"owner": {"reputation": 2208, "user_id": 4061422, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/ZHGRC.png?s=128&g=1", "display_name": "vipin", "link": "https://stackoverflow.com/users/4061422/vipin"}, "reply_to_user": {"reputation": 534, "user_id": 3057462, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/0vwrs.jpg?s=128&g=1", "display_name": "hiveer", "link": "https://stackoverflow.com/users/3057462/hiveer"}, "edited": false, "score": 0, "creation_date": 1546773255, "post_id": 52495420, "comment_id": 94955197, "body": "Can you change your mini racer version according to your rails"}], "tags": [], "owner": {"reputation": 2208, "user_id": 4061422, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/ZHGRC.png?s=128&g=1", "display_name": "vipin", "link": "https://stackoverflow.com/users/4061422/vipin"}, "is_accepted": true, "score": 7, "last_activity_date": 1537869523, "creation_date": 1537869523, "answer_id": 52495420, "question_id": 52264369, "link": "https://stackoverflow.com/questions/52264369/error-occurred-while-installing-mini-racer-0-2-0/52495420#52495420", "title": "Error occurred while installing mini_racer (0.2.0)", "body": "<p>Problem solve after change mini_racer gem version</p>\n\n<pre><code>mini_racer (0.2.1)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 5363, "user_id": 1330816, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/069c339da8e2fde6d3c664fc78d904c8?s=128&d=identicon&r=PG", "display_name": "paneer_tikka", "link": "https://stackoverflow.com/users/1330816/paneer-tikka"}, "is_accepted": false, "score": 13, "last_activity_date": 1552135125, "creation_date": 1552135125, "answer_id": 55077433, "question_id": 52264369, "link": "https://stackoverflow.com/questions/52264369/error-occurred-while-installing-mini-racer-0-2-0/55077433#55077433", "title": "Error occurred while installing mini_racer (0.2.0)", "body": "<p>I  ran into the exact same issue on <strong>OS X Mojave</strong> with exact same stack trace as above. The following solution fixed it for me:\n(Credit to author of this blog Dave Kimura): <a href=\"https://blog.driftingruby.com/updated-to-mojave/\" rel=\"noreferrer\">https://blog.driftingruby.com/updated-to-mojave/</a>\nSolution was simply:</p>\n\n<ol>\n<li><p>Make sure you have installed xcode tools (skip if already done)</p>\n\n<blockquote>\n  <p>xcode-select --install</p>\n</blockquote></li>\n<li><p>Now run the following command and follow the on-screen installer</p>\n\n<blockquote>\n  <p>open /Library/Developer/CommandLineTools/Packages/macOS_SDK_headers_for_macOS_10.14.pkg</p>\n</blockquote></li>\n</ol>\n\n<p>That's it. Now mini_racer should install happily.</p>\n"}, {"tags": [], "owner": {"reputation": 546, "user_id": 2632214, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7KQFi.jpg?s=128&g=1", "display_name": "Jonatas  Eduardo", "link": "https://stackoverflow.com/users/2632214/jonatas-eduardo"}, "is_accepted": false, "score": 1, "last_activity_date": 1596332058, "creation_date": 1596332058, "answer_id": 63211567, "question_id": 52264369, "link": "https://stackoverflow.com/questions/52264369/error-occurred-while-installing-mini-racer-0-2-0/63211567#63211567", "title": "Error occurred while installing mini_racer (0.2.0)", "body": "<h2>In <strong>docker-compose</strong> with <strong>Docker</strong> image like <code>ruby</code>, you can try:</h2>\n<ol>\n<li>Delete <code>Gemfile.lock</code> inside image</li>\n<li>Run <code>bundle install</code> again.</li>\n</ol>\n"}], "owner": {"reputation": 2208, "user_id": 4061422, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/ZHGRC.png?s=128&g=1", "display_name": "vipin", "link": "https://stackoverflow.com/users/4061422/vipin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6486, "favorite_count": 4, "accepted_answer_id": 52495420, "answer_count": 3, "score": 13, "last_activity_date": 1617003624, "creation_date": 1536608115, "question_id": 52264369, "link": "https://stackoverflow.com/questions/52264369/error-occurred-while-installing-mini-racer-0-2-0", "title": "Error occurred while installing mini_racer (0.2.0)", "body": "<p>I am using mac 10.14. I have some problem with mini_racer gem. After run bundle install the below error occurs. I don't know how can I solve this.</p>\n\n<p><strong>Error</strong> </p>\n\n<pre><code>Installing mini_racer 0.2.0 with native extensions\nGem::Ext::BuildError: ERROR: Failed to build gem native extension.\n\ncurrent directory:\n/Users/vipinkumar/.rvm/gems/ruby-2.5.1@ry_rails5/gems/mini_racer-0.2.0/ext/mini_racer_extension\n/Users/vipinkumar/.rvm/rubies/ruby-2.5.1/bin/ruby -r\n./siteconf20180911-791-fpmt3t.rb extconf.rb\nchecking for -lpthread... yes\nchecking for -lobjc... yes\ncreating Makefile\n\ncurrent directory:\n/Users/vipinkumar/.rvm/gems/ruby-2.5.1@ry_rails5/gems/mini_racer-0.2.0/ext/mini_racer_extension\nmake \"DESTDIR=\" clean\n\ncurrent directory:\n/Users/vipinkumar/.rvm/gems/ruby-2.5.1@ry_rails5/gems/mini_racer-0.2.0/ext/mini_racer_extension\nmake \"DESTDIR=\"\ncompiling mini_racer_extension.cc\nclang: warning: argument unused during compilation: '-rdynamic'\n[-Wunused-command-line-argument]\nIn file included from mini_racer_extension.cc:2:\nIn file included from\n/Users/vipinkumar/.rvm/rubies/ruby-2.5.1/include/ruby-2.5.0/ruby.h:33:\nIn file included from\n/Users/vipinkumar/.rvm/rubies/ruby-2.5.1/include/ruby-2.5.0/ruby/ruby.h:2040:\n/Users/vipinkumar/.rvm/rubies/ruby-2.5.1/include/ruby-2.5.0/ruby/intern.h:47:19:\nwarning: 'register' storage class specifier is deprecated and incompatible with\nC++17 [-Wdeprecated-register]\nvoid rb_mem_clear(register VALUE*, register long);\n                  ^~~~~~~~~\n/Users/vipinkumar/.rvm/rubies/ruby-2.5.1/include/ruby-2.5.0/ruby/intern.h:47:36:\nwarning: 'register' storage class specifier is deprecated and incompatible with\nC++17 [-Wdeprecated-register]\nvoid rb_mem_clear(register VALUE*, register long);\n                                   ^~~~~~~~~\n2 warnings generated.\nlinking shared-object mini_racer_extension.bundle\nclang: warning: libstdc++ is deprecated; move to libc++ [-Wdeprecated]\nld: library not found for -lstdc++\nclang: error: linker command failed with exit code 1 (use -v to see invocation)\nmake: *** [mini_racer_extension.bundle] Error 1\n\nmake failed, exit code 2\n\nGem files will remain installed in\n/Users/vipinkumar/.rvm/gems/ruby-2.5.1@ry_rails5/gems/mini_racer-0.2.0 for\ninspection.\nResults logged to\n/Users/vipinkumar/.rvm/gems/ruby-2.5.1@ry_rails5/extensions/x86_64-darwin-18/2.5.0/mini_racer-0.2.0/gem_make.out\n\nAn error occurred while installing mini_racer (0.2.0), and Bundler\ncannot continue.\nMake sure that `gem install mini_racer -v '0.2.0' --source\n'https://rubygems.org/'` succeeds before bundling.\n\nIn Gemfile:\n  mini_racer\n</code></pre>\n\n<p>Ruby version 2.5.0 or 2.5.1 and rails 5.0</p>\n\n<p><strong>GemFile</strong> </p>\n\n<pre><code>gem 'mini_racer', platforms: :ruby\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "heroku", "assets", "pipeline"], "answers": [{"comments": [{"owner": {"reputation": 45, "user_id": 10134443, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GACPj.jpg?s=128&g=1", "display_name": "Aerodyne", "link": "https://stackoverflow.com/users/10134443/aerodyne"}, "edited": false, "score": 0, "creation_date": 1536655150, "post_id": 52271830, "comment_id": 91490988, "body": "Thank you, this worked! I think the issue I was having was that I was running the rake assets:precompile on heroku with heroku run. Thanks very much for the prompt solution :)"}], "tags": [], "owner": {"reputation": 101, "user_id": 5629073, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-djnHIQew9Yw/AAAAAAAAAAI/AAAAAAAAABE/G3pLZ4yDGro/photo.jpg?sz=128", "display_name": "Nuttapon", "link": "https://stackoverflow.com/users/5629073/nuttapon"}, "is_accepted": true, "score": 0, "last_activity_date": 1536654693, "creation_date": 1536654693, "answer_id": 52271830, "question_id": 52264240, "link": "https://stackoverflow.com/questions/52264240/rails-on-heroku-site-does-not-load-actionviewtemplateerror-the-asset-i/52271830#52271830", "title": "Rails on Heroku - Site does not load - ActionView::Template::Error (The asset &quot;image.jpg&quot; is not present in the asset pipeline.)", "body": "<p>It's the simplest way to fix this problem is; You need to run as follows;</p>\n\n<ol>\n<li><code>rails assets:precompile RAILS_ENV=production</code></li>\n<li><code>git add .</code></li>\n<li><code>git commit -m {message}</code></li>\n<li><code>git push heroku master</code> (push the code to the heroku again)</li>\n</ol>\n\n<p>I tried to do it from your code and work fine.</p>\n"}], "owner": {"reputation": 45, "user_id": 10134443, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GACPj.jpg?s=128&g=1", "display_name": "Aerodyne", "link": "https://stackoverflow.com/users/10134443/aerodyne"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 512, "favorite_count": 0, "accepted_answer_id": 52271830, "answer_count": 1, "score": 3, "last_activity_date": 1536654693, "creation_date": 1536607486, "question_id": 52264240, "link": "https://stackoverflow.com/questions/52264240/rails-on-heroku-site-does-not-load-actionviewtemplateerror-the-asset-i", "title": "Rails on Heroku - Site does not load - ActionView::Template::Error (The asset &quot;image.jpg&quot; is not present in the asset pipeline.)", "body": "<p>I've build a simple website, using Rails so I can deploy it to Heroku. It runs perfectly locally, everything works fine. It deploys fine to Heroku but when opening the webpage (<a href=\"http://a-clean.herokuapp.com/\" rel=\"nofollow noreferrer\">http://a-clean.herokuapp.com/</a>) I get the following error displayed:</p>\n\n<p>We're sorry, but something went wrong.</p>\n\n<p>If you are the application owner check the logs for more information.</p>\n\n<p>When I check the logs (running heroku logs in terminal) it shows the error:</p>\n\n<pre><code>ActionView::Template::Error (The asset \"a_clean_sample_1.jpg\" is not present in the asset pipeline.)\n</code></pre>\n\n<p>So far this is just a one-page website with a couple of partials. Here is the github repository: <a href=\"https://github.com/webbc99/a-clean\" rel=\"nofollow noreferrer\">https://github.com/webbc99/a-clean</a></p>\n\n<p>The image it's failing on is loaded in app/views/welcome/home.html.erb line 57.</p>\n\n<p>Rails version 5.1.6, Ruby version 2.5.0</p>\n\n<p>I've double checked that the images are in fact in the app/assets/images folder, and the image_tags are using the file extensions.</p>\n\n<p>I've tried running <code>heroku run rake assets:precompile</code>, and I've tried using the <code>rails12factor</code> gem and also without it. I have tried changing <code>config.assets.compile = false</code> to <code>true</code> in the config/environments/production.rb which did get the page to load but all of the images were ignoring styling and were huge.</p>\n\n<p>What is really confusing me is that I have deployed several other rails apps, same rails version, same ruby version, and none of these have had this issue before.</p>\n\n<p>Here is a working app:\n<a href=\"https://github.com/webbc99/presumptuous\" rel=\"nofollow noreferrer\">https://github.com/webbc99/presumptuous</a>\n<a href=\"https://presumptuous.herokuapp.com/\" rel=\"nofollow noreferrer\">https://presumptuous.herokuapp.com/</a></p>\n\n<p>Any help would be greatly appreciated, been googling this for hours with no luck.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "unit-testing", "testing", "ruby-on-rails-5.2"], "comments": [{"owner": {"reputation": 5141, "user_id": 193980, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/aafa8848c4b764f080b1b31a51eab73d?s=128&d=identicon&r=PG", "display_name": "Phlip", "link": "https://stackoverflow.com/users/193980/phlip"}, "edited": false, "score": 0, "creation_date": 1536606036, "post_id": 52263829, "comment_id": 91475713, "body": "call <code>Post.create!</code> to assert validity. Then the error spew contains the reason your post is invalid. It might not be what you think."}, {"owner": {"reputation": 4348, "user_id": 3435610, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/IBOFX.jpg?s=128&g=1", "display_name": "Sara Tibbetts", "link": "https://stackoverflow.com/users/3435610/sara-tibbetts"}, "edited": false, "score": 2, "creation_date": 1536606090, "post_id": 52263829, "comment_id": 91475740, "body": "<code>validates :title, presence: false</code>, so is a post without a title supposed to be valid?"}, {"owner": {"reputation": 2251, "user_id": 9785060, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IUduC.png?s=128&g=1", "display_name": "Viktor", "link": "https://stackoverflow.com/users/9785060/viktor"}, "edited": false, "score": 0, "creation_date": 1536608088, "post_id": 52263829, "comment_id": 91476614, "body": "What is this point of this : <code>validates :title, presence: false</code> ? Why is there a title attribute if you don&#39;t want it to be present?"}], "answers": [{"tags": [], "owner": {"reputation": 3593, "user_id": 613256, "user_type": "registered", "accept_rate": 20, "profile_image": "https://i.stack.imgur.com/JuDL2.jpg?s=128&g=1", "display_name": "Stanislav Mekhonoshin", "link": "https://stackoverflow.com/users/613256/stanislav-mekhonoshin"}, "is_accepted": false, "score": 1, "last_activity_date": 1536606604, "creation_date": 1536606604, "answer_id": 52264050, "question_id": 52263829, "link": "https://stackoverflow.com/questions/52263829/validation-tests-in-ruby-on-rails-always-false/52264050#52264050", "title": "Validation tests in Ruby on Rails always false", "body": "<p>There is no point in having <code>validates :title, presence: false</code></p>\n\n<p>Most probably you want to validate the presence of title, so you should have <code>presence: true</code>.</p>\n\n<p>In addition, I don't see any sense for validating length, against zero.</p>\n\n<p>Also, I'd edit your code in the following way, since there is no point in having strong_parameters in the model.</p>\n\n<pre><code>class Post &lt; ApplicationRecord\n    belongs_to :category\n    belongs_to :admin_user\n\n    has_many :comment, dependent: :destroy\n    validates :title, presence: false\n    validates :body, length: { minimum: 0 }\nend\n</code></pre>\n\n<p>And finally, you can use <a href=\"https://github.com/thoughtbot/shoulda-matchers\" rel=\"nofollow noreferrer\">https://github.com/thoughtbot/shoulda-matchers</a> for more convenient validations testing.</p>\n"}, {"tags": [], "owner": {"reputation": 897, "user_id": 3504731, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/fFyHM.jpg?s=128&g=1", "display_name": "Ccyan", "link": "https://stackoverflow.com/users/3504731/ccyan"}, "is_accepted": false, "score": 0, "last_activity_date": 1536618199, "creation_date": 1536618199, "answer_id": 52266276, "question_id": 52263829, "link": "https://stackoverflow.com/questions/52263829/validation-tests-in-ruby-on-rails-always-false/52266276#52266276", "title": "Validation tests in Ruby on Rails always false", "body": "<p>To answer your question on why both tests are failing, the reason I believe is with <code>validates :title, presence: false</code> like others have pointed out and I don't think it's needed here.</p>\n\n<p>1) I believe the first one fails because you are setting the title to an empty string. I could be wrong, but try setting it to <code>nil</code> and see if it still fails.</p>\n\n<p>2) Similar to the first test, you are setting a title while your code expects it to not be present, causing the validation to also fail.</p>\n\n<p>Hope this helped clearing some things up for you.</p>\n"}], "owner": {"reputation": 87, "user_id": 8922261, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/c8bb81479bfb4ab61083329fa5a631b6?s=128&d=identicon&r=PG&f=1", "display_name": "Goose9192", "link": "https://stackoverflow.com/users/8922261/goose9192"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 249, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1536618199, "creation_date": 1536605597, "question_id": 52263829, "link": "https://stackoverflow.com/questions/52263829/validation-tests-in-ruby-on-rails-always-false", "title": "Validation tests in Ruby on Rails always false", "body": "<p>I am writing some unit tests in Ruby on Rails. Even when I expect the test to have an outcome that passes the validation, the test fails. \nHere is my model that I am testing:</p>\n\n<pre><code>class Post &lt; ApplicationRecord\n    def permitted_params\n        params.require(:post).permit(:title, :body, :category_id, :admin_user_id)\n    end\n    belongs_to :category\n    belongs_to :admin_user\n    has_many :comment, :dependent =&gt; :destroy\n    validates :title, presence: false\n    validates_length_of :body, :minimum =&gt; 0\nend\n</code></pre>\n\n<p>Here are my tests for this model:</p>\n\n<pre><code>class PostTest &lt; ActiveSupport::TestCase\n  # test \"the truth\" do\n  #    assert true\n  # end\n  test \"If title is there\" do\n    post = Post.create(:title =&gt; \"\", :body =&gt; \"\")\n    assert post.valid?\n  end\n\n  test \"If body is long enough\" do\n    post = Post.create(:title =&gt; \"Some Title\", :body =&gt; \"hhhhhhhhhhhhhhhhhhhhhhhhh\")\n    assert post.valid?\n  end\nend\n</code></pre>\n\n<p>This is the error message: </p>\n\n<pre><code>F\n\nFailure:\nPostTest#test_If_title_is_there [test/models/post_test.rb:9]:\nExpected false to be truthy.\n</code></pre>\n\n<p>I get two failures after running my test. I am using Ruby on Rails version 5.2.1 and Ruby version 2.5.1. Any help would be much appreciated. I am not quite sure why both tests are failing. Thank you in advance. </p>\n"}, {"tags": ["ruby", "canonicalization"], "comments": [{"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 0, "creation_date": 1536603660, "post_id": 52263298, "comment_id": 91474594, "body": "Can you give an example of such differences? I know that Ruby&#39;s I/O and file libraries are deliberately <i>not</i> intended to be portable (matz has explicitly said so on multiple occasions), but I don&#39;t see anything in the documentation that seems to openly indicate an instance of such behavior for this particular method."}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 1, "creation_date": 1536610286, "post_id": 52263298, "comment_id": 91477639, "body": "If you are worried about the order why not sort it? Regardless of the order they are returned in sorting will always be the same."}, {"owner": {"reputation": 1978, "user_id": 1222355, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/44e0773345e9065b2e012b434370dbbb?s=128&d=identicon&r=PG", "display_name": "David West", "link": "https://stackoverflow.com/users/1222355/david-west"}, "edited": false, "score": 0, "creation_date": 1536688850, "post_id": 52263298, "comment_id": 91511409, "body": "I agree with sorting? curious as to why that is not built in but I guess it was a YAGNI thing. If you need to sort it you can. I&#39;ve never thought of a case where it shouldn&#39;t be sorted though..."}, {"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 0, "creation_date": 1536689385, "post_id": 52263298, "comment_id": 91511681, "body": "Again, can you explain what <i>exactly</i> this difference is that you are seeing that you attribute to the OS? I don&#39;t see any differences in the results you posted. (The order is different, obviously, but the documentation of the method doesn&#39;t guarantee any ordering anyway, so the method is allowed to return any order it wants.)"}, {"owner": {"reputation": 1978, "user_id": 1222355, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/44e0773345e9065b2e012b434370dbbb?s=128&d=identicon&r=PG", "display_name": "David West", "link": "https://stackoverflow.com/users/1222355/david-west"}, "reply_to_user": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 0, "creation_date": 1536689522, "post_id": 52263298, "comment_id": 91511752, "body": "@J&#246;rgWMittag one difference is the order. There may be other differences. I think one that is documented is .dotfiles behavior that is different. So yes there is one exact difference that I&#39;m highlighting. That is the order. The question is now amended with an added sentence to call that out. Sure the method is allowed to return whatever it wants now I want to ensure standardization of format and am wondering where/if canonicalization has been formally approached or considered."}, {"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 0, "creation_date": 1536689988, "post_id": 52263298, "comment_id": 91511979, "body": "Just out of curiosity, how did you determine that this difference is due to the OS and not, for example, the filesystem? Or the implementation? I know that, for example, on some implementations of Ruby, <code>Dir::[]</code> returns what the OS&#39;s <code>glob</code> function returns. The <code>glob</code> function, in turn, returns whatever the relevant syscall returns, which in turn returns what the relevant filesystem driver returns. At least on some filesystems, that will be in ascending order of inode numbers, and at least on some filesystem, inodes are allocated linearly. So, in that case, the order is completely \u2026"}, {"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 0, "creation_date": 1536690056, "post_id": 52263298, "comment_id": 91512019, "body": "\u2026 independent of the OS and only dependent on which order you created the files in. But nonetheless, there is no order guarantee in the documentation, so every order is equally valid, and every order is equal."}], "answers": [{"comments": [{"owner": {"reputation": 1978, "user_id": 1222355, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/44e0773345e9065b2e012b434370dbbb?s=128&d=identicon&r=PG", "display_name": "David West", "link": "https://stackoverflow.com/users/1222355/david-west"}, "edited": false, "score": 0, "creation_date": 1536689132, "post_id": 52264146, "comment_id": 91511556, "body": "I made the question clearer. Despite my preference for Linux and OSX I still work with Windows and Ruby. The experience is not bad."}], "tags": [], "owner": {"reputation": 3593, "user_id": 613256, "user_type": "registered", "accept_rate": 20, "profile_image": "https://i.stack.imgur.com/JuDL2.jpg?s=128&g=1", "display_name": "Stanislav Mekhonoshin", "link": "https://stackoverflow.com/users/613256/stanislav-mekhonoshin"}, "is_accepted": false, "score": 0, "last_activity_date": 1536607084, "creation_date": 1536607084, "answer_id": 52264146, "question_id": 52263298, "link": "https://stackoverflow.com/questions/52263298/best-practices-for-multiple-os-consistency-when-using-rubys-dir-glob/52264146#52264146", "title": "Best Practices for multiple OS consistency when using Ruby&#39;s Dir.glob", "body": "<p>Usually, FS libraries behave in a different way on Mac and Linux. I don't consider windows as a platform for Ruby.</p>\n\n<p>So, from my experience, it was enough just to add a conditional operator, that checks the current platform name, and sorts the result in required way. As far as I remember, the difference was in the order of returned files.</p>\n"}], "owner": {"reputation": 1978, "user_id": 1222355, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/44e0773345e9065b2e012b434370dbbb?s=128&d=identicon&r=PG", "display_name": "David West", "link": "https://stackoverflow.com/users/1222355/david-west"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 54, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1536689439, "creation_date": 1536603014, "last_edit_date": 1536689439, "question_id": 52263298, "link": "https://stackoverflow.com/questions/52263298/best-practices-for-multiple-os-consistency-when-using-rubys-dir-glob", "title": "Best Practices for multiple OS consistency when using Ruby&#39;s Dir.glob", "body": "<p>I noticed recently during a debugging session that <code>Dir.glob</code> (aka <code>Dir[]</code>) behaves differently depending on the OS. Specifically the order the files are returned in is different.</p>\n\n<p>What are recommended ways to use <code>Dir.glob</code> in Ruby when you know the code will be used on a variety of OSes?</p>\n\n<p>Example Difference:\nI cloned the project <a href=\"https://github.com/fraunhoferfokus/deckschrubber\" rel=\"nofollow noreferrer\">DeckSchrubber</a> in Linux and Windows</p>\n\n<p>Windows:</p>\n\n<pre><code>irb(main):003:0&gt; puts Dir['./*']\n./CHANGELOG.md\n./LICENSE\n./main.go\n./README.md\n./types.go\n./util\n=&gt; nil\n</code></pre>\n\n<p>Linux:</p>\n\n<pre><code>irb(main):011:0&gt; puts Dir['./*']\n./main.go\n./LICENSE\n./util\n./types.go\n./README.md\n./CHANGELOG.md\n=&gt; nil\n</code></pre>\n\n<p>Once again I am asking for solutions and idioms to ensure the output is canonical.</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 4338, "user_id": 299774, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/eab8557a9cb59427455bac3cc59d2802?s=128&d=identicon&r=PG", "display_name": "Grzegorz", "link": "https://stackoverflow.com/users/299774/grzegorz"}, "edited": false, "score": 0, "creation_date": 1572515147, "post_id": 52263205, "comment_id": 103586665, "body": "Are you using spring?"}], "answers": [{"comments": [{"owner": {"reputation": 3425, "user_id": 1493116, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/9371f372f90b7c283579b097c67b9cd2?s=128&d=identicon&r=PG", "display_name": "LewlSauce", "link": "https://stackoverflow.com/users/1493116/lewlsauce"}, "edited": false, "score": 0, "creation_date": 1536607567, "post_id": 52264231, "comment_id": 91476385, "body": "Yeah that&#39;s the only function that ExamResult is mentioned. If I remove the Thread.start {check_logs}, I never get the error. It seems that it works just fine at first, but if I refresh the web page, it&#39;s almost like my ability to call that model goes away."}, {"owner": {"reputation": 3593, "user_id": 613256, "user_type": "registered", "accept_rate": 20, "profile_image": "https://i.stack.imgur.com/JuDL2.jpg?s=128&g=1", "display_name": "Stanislav Mekhonoshin", "link": "https://stackoverflow.com/users/613256/stanislav-mekhonoshin"}, "reply_to_user": {"reputation": 3425, "user_id": 1493116, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/9371f372f90b7c283579b097c67b9cd2?s=128&d=identicon&r=PG", "display_name": "LewlSauce", "link": "https://stackoverflow.com/users/1493116/lewlsauce"}, "edited": false, "score": 0, "creation_date": 1536607737, "post_id": 52264231, "comment_id": 91476468, "body": "That happens because Rails reloads your models on the page refresh, and that constant, that previously pointed to the ExamResult, is not available anymore. I&#39;d not recommend you to write threaded code in the scope of Rails app. Take a look at Sidekiq gem, for example. It&#39;ll do that in safe way for you."}, {"owner": {"reputation": 3425, "user_id": 1493116, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/9371f372f90b7c283579b097c67b9cd2?s=128&d=identicon&r=PG", "display_name": "LewlSauce", "link": "https://stackoverflow.com/users/1493116/lewlsauce"}, "edited": false, "score": 0, "creation_date": 1536607835, "post_id": 52264231, "comment_id": 91476511, "body": "Gotcha. I tried sidekiq, but it doesn&#39;t look like you can actually stop a sidekiq worker right? For example, this code checks an instance variable to see if it changed and it stops if so. However, I don&#39;t think I can do the same in sidekiq no?"}, {"owner": {"reputation": 3593, "user_id": 613256, "user_type": "registered", "accept_rate": 20, "profile_image": "https://i.stack.imgur.com/JuDL2.jpg?s=128&g=1", "display_name": "Stanislav Mekhonoshin", "link": "https://stackoverflow.com/users/613256/stanislav-mekhonoshin"}, "reply_to_user": {"reputation": 3425, "user_id": 1493116, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/9371f372f90b7c283579b097c67b9cd2?s=128&d=identicon&r=PG", "display_name": "LewlSauce", "link": "https://stackoverflow.com/users/1493116/lewlsauce"}, "edited": false, "score": 0, "creation_date": 1536608150, "post_id": 52264231, "comment_id": 91476655, "body": "Well, you can implement almost the same logic inside of sidekiq worker. If some conditions are met, then you can just return from sidekiq job&#39;s <code>perform</code> method, and it will stop, until the next job is scheduled. As an alternative, you can give a try to <a href=\"https://github.com/thuehlinger/daemons\" rel=\"nofollow noreferrer\">github.com/thuehlinger/daemons</a> gem, that is built for writing long-running applications and servers."}, {"owner": {"reputation": 3425, "user_id": 1493116, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/9371f372f90b7c283579b097c67b9cd2?s=128&d=identicon&r=PG", "display_name": "LewlSauce", "link": "https://stackoverflow.com/users/1493116/lewlsauce"}, "edited": false, "score": 0, "creation_date": 1536608257, "post_id": 52264231, "comment_id": 91476711, "body": "Gotcha. Perhaps the sidekiq worker can check the database for an updated status every 5 seconds. Not sure if that&#39;d be a heavy hit to performance, but I&#39;ll give it a shot. I really appreciate it!"}, {"owner": {"reputation": 3425, "user_id": 1493116, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/9371f372f90b7c283579b097c67b9cd2?s=128&d=identicon&r=PG", "display_name": "LewlSauce", "link": "https://stackoverflow.com/users/1493116/lewlsauce"}, "edited": false, "score": 0, "creation_date": 1536613104, "post_id": 52264231, "comment_id": 91478819, "body": "So I just converted this into a sidekiq worker, but the sidekiq worker is having another problem. It seems to be accessing an old instance of the model. Is there a way to allow it to get the current model data?"}, {"owner": {"reputation": 3593, "user_id": 613256, "user_type": "registered", "accept_rate": 20, "profile_image": "https://i.stack.imgur.com/JuDL2.jpg?s=128&g=1", "display_name": "Stanislav Mekhonoshin", "link": "https://stackoverflow.com/users/613256/stanislav-mekhonoshin"}, "reply_to_user": {"reputation": 3425, "user_id": 1493116, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/9371f372f90b7c283579b097c67b9cd2?s=128&d=identicon&r=PG", "display_name": "LewlSauce", "link": "https://stackoverflow.com/users/1493116/lewlsauce"}, "edited": false, "score": 1, "creation_date": 1536613985, "post_id": 52264231, "comment_id": 91479167, "body": "Sure. &#39;my_object.reload&#39; should pull changed attributes from the database."}], "tags": [], "owner": {"reputation": 3593, "user_id": 613256, "user_type": "registered", "accept_rate": 20, "profile_image": "https://i.stack.imgur.com/JuDL2.jpg?s=128&g=1", "display_name": "Stanislav Mekhonoshin", "link": "https://stackoverflow.com/users/613256/stanislav-mekhonoshin"}, "is_accepted": true, "score": 2, "last_activity_date": 1536607451, "creation_date": 1536607451, "answer_id": 52264231, "question_id": 52263205, "link": "https://stackoverflow.com/questions/52263205/a-copy-of-xxx-has-been-removed-from-the-module-but-is-still-active/52264231#52264231", "title": "A copy of XXX has been removed from the module but is still active", "body": "<p>I don't think that provided error is somehow related to the code above.\nUsually, this error happens when you modify your classes at runtime with metaprogramming.</p>\n\n<p>Take a look at places where you require, define <code>ExamResult</code>, it looks like you require it several times in your code.</p>\n"}], "owner": {"reputation": 3425, "user_id": 1493116, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/9371f372f90b7c283579b097c67b9cd2?s=128&d=identicon&r=PG", "display_name": "LewlSauce", "link": "https://stackoverflow.com/users/1493116/lewlsauce"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 216, "favorite_count": 0, "accepted_answer_id": 52264231, "answer_count": 1, "score": 0, "last_activity_date": 1536607451, "creation_date": 1536602589, "question_id": 52263205, "link": "https://stackoverflow.com/questions/52263205/a-copy-of-xxx-has-been-removed-from-the-module-but-is-still-active", "title": "A copy of XXX has been removed from the module but is still active", "body": "<p>I am basically running a background process that checks for files, and then updates the rails model based on the data discovered in the file. However, I can't access the model from within the thread because of an error. </p>\n\n<p>Here's my example:</p>\n\n<pre><code>def check_logs\n    while @start == 1\n        results = Dir.glob(\"#{@path}/*.txt\")\n        unless results.empty?\n            results.each do |result|\n                file_name = result.split(\"/\")[-1]\n                data = File.open(result).read\n\n                if file_name.include? \"get\"\n                    data_contents = data.split(\"\\n\")\n                    time = data_contents[0]\n                    ExamResult.create(time: time)\n                end\n                FileUtils.rm_rf result\n            end\n        end\n\n        sleep 5\n    end\nend\n\ndef start_agent\n    @start = 1\n    Thread.start {check_logs}\nend\n\ndef stop_agent\n   @start = 0\nend\n</code></pre>\n\n<p>However, while it's in the background, this is the error that I see coming across the console:</p>\n\n<blockquote>\n  <p> terminated with exception (report_on_exception is true):\n  Traceback (most recent call last):    5: from\n  portal/lib/custom_rb/exam_results/exam_custom.rb:69:in <code>block in\n  start_monitoring_agent'   4: from\n  portal/lib/custom_rb/exam_results/exam_custom.rb:40:in</code>check_logs'\n    3: from portal/lib/custom_rb/exam_results/exam_custom.rb:40:in <code>each'\n    2: from portal/lib/custom_rb/exam_results/exam_custom.rb:46:in</code>block\n  in check_logs'    1: from\n  /home/nutella/.rvm/gems/ruby-2.5.1/gems/activesupport-5.1.6/lib/active_support/dependencies.rb:202:in <code>const_missing'\n  /home/user/.rvm/gems/ruby-2.5.1/gems/activesupport-5.1.6/lib/active_support/dependencies.rb:496:in</code>load_missing_constant': A copy of ExamResult has been removed from\n  the module tree but is still active! (ArgumentError)</p>\n</blockquote>\n\n<p>My goal here is just to have a backgrounded process to monitor for logs. I've seen some other posts about this same exact error, but perhaps I could be doing this a little better other than the solutions provided for them.</p>\n\n<p>Any thoughts or feedback would be greatly appreciated.</p>\n"}, {"tags": ["ruby", "mixins"], "comments": [{"owner": {"reputation": 71199, "user_id": 1301972, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/T5G7N.jpg?s=128&g=1", "display_name": "Todd A. Jacobs", "link": "https://stackoverflow.com/users/1301972/todd-a-jacobs"}, "edited": false, "score": 1, "creation_date": 1536602473, "post_id": 52263083, "comment_id": 91474053, "body": "I don&#39;t really get what you&#39;re trying to do. Perhaps you can declare a class method with <code>self.add_comment</code> and then call it from your instance as <code>M1.add_comment</code>."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 2, "creation_date": 1536606147, "post_id": 52263083, "comment_id": 91475774, "body": "Modules may contain two kinds of methods: module methods and instance methods. The former are defined on a module <code>M</code> as <code>def M.mm...end</code> or more commonly, <code>def self.mm...end</code> from within the module. These are invoked on the module (e.g. <code>Math.sqrt(10)</code>). Instance methods--what you have in your example--require an instance of a class <code>C</code> as their receiver and therefore must be instance methods of <code>C</code>. The latter can only be achieved by executing <code>C.include M</code> or <code>include M</code> from within <code>C</code> (or from an ancestor of <code>C</code>). If <code>M</code> is included in <code>C</code> any module methods in <code>M</code> are passed over."}], "answers": [{"tags": [], "owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "is_accepted": true, "score": 1, "last_activity_date": 1536602724, "creation_date": 1536602724, "answer_id": 52263229, "question_id": 52263083, "link": "https://stackoverflow.com/questions/52263083/ruby-how-to-call-module-methods-from-class-in-the-same-namespace/52263229#52263229", "title": "Ruby How to call module methods from class in the same namespace", "body": "<p>Normally you can cover this off with a <em>lazy initializer</em>:</p>\n\n<pre><code>def comments \n  @comments ||= [ ]\nend\n</code></pre>\n\n<p>Where that populates <code>@comments</code> with an empty array unless it's already defined.</p>\n\n<p>That makes the <code>add_comment</code> method redundant since you can just do:</p>\n\n<pre><code>comments &lt;&lt; comment\n</code></pre>\n\n<p>Without any intermediation.</p>\n\n<p>Now note that the <code>comments</code> method is defined as a <em>mixin method</em>, not as a stand-alone one. That means it doesn't exist until some other module or class calls <code>include</code> on that module.</p>\n\n<p>To make it stand-alone:</p>\n\n<pre><code>def self.comments \n  @comments ||= [ ]\nend\n</code></pre>\n\n<p>Now you can do this:</p>\n\n<pre><code>M1.comments &lt;&lt; 'New comment'\n</code></pre>\n"}], "owner": {"reputation": 555, "user_id": 2256033, "user_type": "registered", "accept_rate": 29, "profile_image": "https://i.stack.imgur.com/YBDjx.jpg?s=128&g=1", "display_name": "Santhosh Nagulanchi", "link": "https://stackoverflow.com/users/2256033/santhosh-nagulanchi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 562, "favorite_count": 0, "accepted_answer_id": 52263229, "answer_count": 1, "score": 0, "last_activity_date": 1536602724, "creation_date": 1536602079, "question_id": 52263083, "link": "https://stackoverflow.com/questions/52263083/ruby-how-to-call-module-methods-from-class-in-the-same-namespace", "title": "Ruby How to call module methods from class in the same namespace", "body": "<p>I am new to Ruby and trying to understand the module methods in ruby. </p>\n\n<pre><code>module M1\n    def comments \n      if @comments\n        @comments\n      else\n        @comments = []\n      end\n    end\n\n    def add_comment(comment)\n       comments &lt;&lt; comment\n    end\n\n    class Audio\n\n         &lt;&lt;How do i call add_comment or comments &gt;&gt;\n         def someMethod\n            add_comment \"calling module method from class which is in  same namespace or module\"\n         end\n\n    end\n\nend\n</code></pre>\n\n<p>Getting the following exception if I call on Module or Class. \n(undefined method `add_comment' for M1:Module)</p>\n"}, {"tags": ["java", "ruby", "encryption", "aes", "bouncycastle"], "comments": [{"owner": {"reputation": 36469, "user_id": 238704, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VgOZI.png?s=128&g=1", "display_name": "President James K. Polk", "link": "https://stackoverflow.com/users/238704/president-james-k-polk"}, "edited": false, "score": 2, "creation_date": 1536626591, "post_id": 52261338, "comment_id": 91482196, "body": "CFB mode has an additional parameter, the feedback size. It&#39;s clear from the Java code that you&#39;ve chosen 8 bit feedback mode there. In the Ruby code you&#39;re evidently getting a default feedback size, which I&#39;m guessing is 128."}, {"owner": {"reputation": 3153, "user_id": 1003190, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/5c542965e5d3a5ff7f9bddd60b3a4d2a?s=128&d=identicon&r=PG", "display_name": "aspyct", "link": "https://stackoverflow.com/users/1003190/aspyct"}, "reply_to_user": {"reputation": 36469, "user_id": 238704, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VgOZI.png?s=128&g=1", "display_name": "President James K. Polk", "link": "https://stackoverflow.com/users/238704/president-james-k-polk"}, "edited": false, "score": 0, "creation_date": 1536651579, "post_id": 52261338, "comment_id": 91489078, "body": "You&#39;re totally right! When I use a block size of 128 for java, I get the same results. Cheers! Now unfortunately I can&#39;t modify the java implementation, and I must match it with ruby. So far I didn&#39;t find a way to change the block size on Ruby... I&#39;ll keep looking, but any hint is welcome!"}], "answers": [{"tags": [], "owner": {"reputation": 3153, "user_id": 1003190, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/5c542965e5d3a5ff7f9bddd60b3a4d2a?s=128&d=identicon&r=PG", "display_name": "aspyct", "link": "https://stackoverflow.com/users/1003190/aspyct"}, "is_accepted": true, "score": 1, "last_activity_date": 1536652803, "creation_date": 1536652803, "answer_id": 52271302, "question_id": 52261338, "link": "https://stackoverflow.com/questions/52261338/aes-128-cfb-java-bouncycastle-vs-ruby-openssl/52271302#52271302", "title": "AES 128 CFB, Java/BouncyCastle vs Ruby/OpenSSL", "body": "<p>So as James indicated, the block size was wrong on ruby. I should use 8 bit block size for the CFB, but instead was using the default 128 bit.</p>\n\n<p>This solved it:</p>\n\n<pre><code>cipher = OpenSSL::Cipher.new(\"AES-128-CFB8\")\n</code></pre>\n"}], "owner": {"reputation": 3153, "user_id": 1003190, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/5c542965e5d3a5ff7f9bddd60b3a4d2a?s=128&d=identicon&r=PG", "display_name": "aspyct", "link": "https://stackoverflow.com/users/1003190/aspyct"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 196, "favorite_count": 0, "accepted_answer_id": 52271302, "answer_count": 1, "score": 2, "last_activity_date": 1536652803, "creation_date": 1536594188, "last_edit_date": 1536652120, "question_id": 52261338, "link": "https://stackoverflow.com/questions/52261338/aes-128-cfb-java-bouncycastle-vs-ruby-openssl", "title": "AES 128 CFB, Java/BouncyCastle vs Ruby/OpenSSL", "body": "<p>I'm trying to match the AES encryption from the java implementation of BouncyCastle with Ruby. Somehow, even with the same key, IV and payload, I can't seem to get the same results in both languages.</p>\n\n<p>In this example, I'm using ruby to generate the key and IV, and then reuse this key and IV\u00a0in the java code.</p>\n\n<p>Can anyone spot what's wrong?</p>\n\n<p>Here's the ruby code:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>require 'openssl'\n\ncipher = OpenSSL::Cipher::AES.new(128, \"CFB\")\ncipher.encrypt\n\npayload = \"\\x01\\x02\\x03\\x04\".b\n\nputs \"key\"\nputs cipher.random_key.unpack(\"H*\")\n\nputs \"iv\"\nputs cipher.random_iv.unpack(\"H*\")\n\nputs (cipher.update(payload) + cipher.final).unpack(\"H*\")\n</code></pre>\n\n<p>And its output:</p>\n\n<pre><code>key\n19900205760f9b9696b34cacdbf0189d\niv\nb549f3bb806c4bce9c949f61185f2c38\n303dc6e6\n</code></pre>\n\n<p>And the (not so) corresponding java code</p>\n\n<pre class=\"lang-java prettyprint-override\"><code>byte[] key = hexStringToByteArray(\"19900205760f9b9696b34cacdbf0189d\");\nbyte[] iv = hexStringToByteArray(\"b549f3bb806c4bce9c949f61185f2c38\");\nbyte[] payload = new byte[] { 1, 2, 3, 4};\n\nAESEngine aesEngine = new AESEngine();\nCFBBlockCipher cipher = new CFBBlockCipher(aesEngine, 8);\nParametersWithIV params = new ParametersWithIV(new KeyParameter(key), iv);\n\nBufferedBlockCipher bbc = new BufferedBlockCipher(cipher);\nbbc.init(true, params);\n\nbyte[] output = new byte[payload.length];\nint result = bbc.processBytes(payload, 0, payload.length, output, 0);\nbbc.doFinal(output, result);\n\nSystem.out.println(\"With\u00a0BC: \" + bytesToHex(output));\n</code></pre>\n\n<p>The java result is </p>\n\n<pre><code>305F1C09\n</code></pre>\n\n<p>For any payload, the first byte is always identical with both implementations, but then the rest varies. Could it be that the cipher feedback loop is not working the same way?</p>\n\n<p>Edit: As James indicated in the comments, it's a problem of block size. In the code above, ruby seems to be using a default of 128 bit block size, whereas the java code uses 8\u00a0bit block. In my case, I must match the ruby code to java, so I now need to find a way to use 8 bit block size with ruby.</p>\n\n<p>I'm dry. Any idea here?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "middleman"], "comments": [{"owner": {"reputation": 2133, "user_id": 3820185, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6XZmR.jpg?s=128&g=1", "display_name": "wiesion", "link": "https://stackoverflow.com/users/3820185/wiesion"}, "edited": false, "score": 0, "creation_date": 1536593050, "post_id": 52260281, "comment_id": 91469561, "body": "Are you using RedCarpet to render your MD? If so, you can specify the <a href=\"https://github.com/vmg/redcarpet#darling-i-packed-you-a-couple-renderers-for-lunch\" rel=\"nofollow noreferrer\">link attributes</a>"}, {"owner": {"reputation": 781, "user_id": 411671, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/990c54f71cc01020845d3c6d20b380aa?s=128&d=identicon&r=PG", "display_name": "BasTaller", "link": "https://stackoverflow.com/users/411671/bastaller"}, "edited": false, "score": 0, "creation_date": 1610573186, "post_id": 52260281, "comment_id": 116180257, "body": "wrong notation: no comma needed in rel values."}], "answers": [{"comments": [{"owner": {"reputation": 55, "user_id": 505187, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aa49c056195e26dec9d91009974157de?s=128&d=identicon&r=PG", "display_name": "nothingme", "link": "https://stackoverflow.com/users/505187/nothingme"}, "edited": false, "score": 0, "creation_date": 1536592274, "post_id": 52260668, "comment_id": 91469081, "body": "If I add the helper method like above - will I then need to change the link one by one in view like how you mentioned for usage in view? I have multiple links in md and if that&#39;s the case then it would be a hassle to go through one by one."}, {"owner": {"reputation": 1357, "user_id": 6229122, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-tQUnBjPGP9o/AAAAAAAAAAI/AAAAAAAACww/wJS82aCB06E/photo.jpg?sz=128", "display_name": "Alex Suslyakov", "link": "https://stackoverflow.com/users/6229122/alex-suslyakov"}, "reply_to_user": {"reputation": 55, "user_id": 505187, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aa49c056195e26dec9d91009974157de?s=128&d=identicon&r=PG", "display_name": "nothingme", "link": "https://stackoverflow.com/users/505187/nothingme"}, "edited": false, "score": 0, "creation_date": 1536592472, "post_id": 52260668, "comment_id": 91469198, "body": "@nothingme it&#39;s better to update them one-by-one than have an implicit addition of this attributes for all the links. It should be as easy as one <i>find and replace</i>  But it&#39;s up to you, you can add a decorator for the helper. I&#39;ll update the answer with an example"}, {"owner": {"reputation": 1357, "user_id": 6229122, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-tQUnBjPGP9o/AAAAAAAAAAI/AAAAAAAACww/wJS82aCB06E/photo.jpg?sz=128", "display_name": "Alex Suslyakov", "link": "https://stackoverflow.com/users/6229122/alex-suslyakov"}, "reply_to_user": {"reputation": 55, "user_id": 505187, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aa49c056195e26dec9d91009974157de?s=128&d=identicon&r=PG", "display_name": "nothingme", "link": "https://stackoverflow.com/users/505187/nothingme"}, "edited": false, "score": 0, "creation_date": 1536592786, "post_id": 52260668, "comment_id": 91469400, "body": "@nothingme check out the last edit. I hope it&#39;ll help"}], "tags": [], "owner": {"reputation": 1357, "user_id": 6229122, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-tQUnBjPGP9o/AAAAAAAAAAI/AAAAAAAACww/wJS82aCB06E/photo.jpg?sz=128", "display_name": "Alex Suslyakov", "link": "https://stackoverflow.com/users/6229122/alex-suslyakov"}, "is_accepted": true, "score": 5, "last_activity_date": 1536592733, "last_edit_date": 1536592733, "creation_date": 1536591822, "answer_id": 52260668, "question_id": 52260281, "link": "https://stackoverflow.com/questions/52260281/set-target-blank-and-rel-nofollow-noindex-noreferrer-to-all-links/52260668#52260668", "title": "Set target=\u201c_blank\u201d and rel=\u201cnofollow, noindex, noreferrer\u201d to all links", "body": "<p>A good approach here is to create your own helper-method under <code>app/helpers</code> and use it in your views</p>\n\n<p>Smth like:</p>\n\n<pre><code>def link_to_new_window(name = nil, options = nil, html_options = {}, &amp;block)\n  html_options[:target] = '_blank'\n  html_options[:rel] = 'nofollow, noindex, noreferrer'\n  helper.link_to(name, options, html_options, &amp;block)\nend\n</code></pre>\n\n<p><strong>UPD</strong>\nI see that you're using <code>middleman</code>. Don't have much experience with it, but you can decorate like this pretty-much any helper method</p>\n\n<p>Note the <code>helper</code> call, it'll allow you to use Rails helpers when they not explicitly included</p>\n\n<p>To decorate the original method you can do:</p>\n\n<pre><code>module LinkToWithNewWindow\n  def link_to(name = nil, options = nil, html_options = {}, &amp;block)\n    html_options[:target] = '_blank'\n    html_options[:rel] = 'nofollow, noindex, noreferrer'\n    super(name, options, html_options, &amp;block)\n  end\nend\n::ActionView::Helpers::UrlHelper.prepend LinkToWithNewWindow\n</code></pre>\n\n<p><em>Replace ActionView with the helper you use if needed</em>\nBut again, do it at your own risk</p>\n"}], "owner": {"reputation": 55, "user_id": 505187, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aa49c056195e26dec9d91009974157de?s=128&d=identicon&r=PG", "display_name": "nothingme", "link": "https://stackoverflow.com/users/505187/nothingme"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 874, "favorite_count": 1, "accepted_answer_id": 52260668, "answer_count": 1, "score": 2, "last_activity_date": 1604759686, "creation_date": 1536590508, "last_edit_date": 1604759686, "question_id": 52260281, "link": "https://stackoverflow.com/questions/52260281/set-target-blank-and-rel-nofollow-noindex-noreferrer-to-all-links", "title": "Set target=\u201c_blank\u201d and rel=\u201cnofollow, noindex, noreferrer\u201d to all links", "body": "<p>There seems to be a way how to set external links to no-follow per default to avoid losing important link juice through do-follow links to external websites it would be really good and make things much easier if we had automated that.</p>\n\n<p>I have a lot of articles/blog posts in markdown that is being generated upon middleman deployment. It\u2019s a hassle to manually add {:target=\"_blank\" rel=\"nofollow, noindex, noreferrer\"} at the end of each link within the text.</p>\n\n<p>I've researched that I can add </p>\n\n<pre><code>&lt;meta name =\u201drobots\u201d content=\u201dindex\u201d&gt;\n</code></pre>\n\n<p>but I'm guessing there must be a more granular approach is to include the noFollow tag for individual links.</p>\n\n<p>Is there a way to set link attributes in config.rb so that it's set like below?</p>\n\n<pre><code>target=\"_blank\" rel=\"nofollow, noindex, noreferrer\"\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "database"], "comments": [{"owner": {"reputation": 18856, "user_id": 1359650, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/dffc4318ac93e728a26c8e8b51b4eb37?s=128&d=identicon&r=PG", "display_name": "jvillian", "link": "https://stackoverflow.com/users/1359650/jvillian"}, "edited": false, "score": 0, "creation_date": 1536593671, "post_id": 52260260, "comment_id": 91469909, "body": "This is not directly related to your question. But... It seems very unusual that you are trying to create a record in an <code>index</code> action. Also, it looks like you&#39;re trying to create an <code>Invitation</code> in the <code>BlogController</code>, which also seems very unusual. Why not use the <code>create</code> action of an <code>InvitationController</code>?"}, {"owner": {"reputation": 75, "user_id": 9326999, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/11bfc4b0f12f6a76a7cd56c7fc4cb7a7?s=128&d=identicon&r=PG&f=1", "display_name": "synopsa", "link": "https://stackoverflow.com/users/9326999/synopsa"}, "reply_to_user": {"reputation": 18856, "user_id": 1359650, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/dffc4318ac93e728a26c8e8b51b4eb37?s=128&d=identicon&r=PG", "display_name": "jvillian", "link": "https://stackoverflow.com/users/1359650/jvillian"}, "edited": false, "score": 0, "creation_date": 1536594793, "post_id": 52260260, "comment_id": 91470523, "body": "I was just wondering how can I can create my own form and connect it with a model without using scaffolding. Made this just for testing, thanks anyway"}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1536599045, "post_id": 52260260, "comment_id": 91472526, "body": "Try and get out of the habit of doing things like <code>&quot;#{x}&quot;</code> where <code>x</code> is what you mean, or in rare occasions <code>x.to_s</code> to force it to a string. Also try and use the Ruby 1.9 hash declaration style, it&#39;s been around for ages: <code>create(name: @name, email: @email, ...)</code> It&#39;s far less verbose and more consistent with other languages."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1536599093, "post_id": 52260260, "comment_id": 91472556, "body": "Note: If you&#39;re editing a model it&#39;s expected you&#39;ll use <code>form_for</code> with the model passed in and then <code>form.email_field</code> and so on."}], "answers": [{"comments": [{"owner": {"reputation": 75, "user_id": 9326999, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/11bfc4b0f12f6a76a7cd56c7fc4cb7a7?s=128&d=identicon&r=PG&f=1", "display_name": "synopsa", "link": "https://stackoverflow.com/users/9326999/synopsa"}, "edited": false, "score": 0, "creation_date": 1536592630, "post_id": 52260543, "comment_id": 91469289, "body": "Thanks! but why it makes one blank record apart from one that is filled? I deleted all from seeds.rb"}, {"owner": {"reputation": 32131, "user_id": 2346461, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/i3xAf.jpg?s=128&g=1", "display_name": "Pavan", "link": "https://stackoverflow.com/users/2346461/pavan"}, "reply_to_user": {"reputation": 75, "user_id": 9326999, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/11bfc4b0f12f6a76a7cd56c7fc4cb7a7?s=128&d=identicon&r=PG&f=1", "display_name": "synopsa", "link": "https://stackoverflow.com/users/9326999/synopsa"}, "edited": false, "score": 1, "creation_date": 1536592936, "post_id": 52260543, "comment_id": 91469487, "body": "@synopsa Did you run <code>rake db:seed</code> when you have that code in <code>seeds.rb</code>? If so it creates blank record as <code>@name</code>, <code>@email</code> and <code>@question</code> all are nil"}], "tags": [], "owner": {"reputation": 32131, "user_id": 2346461, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/i3xAf.jpg?s=128&g=1", "display_name": "Pavan", "link": "https://stackoverflow.com/users/2346461/pavan"}, "is_accepted": true, "score": 3, "last_activity_date": 1536592018, "last_edit_date": 1536592018, "creation_date": 1536591399, "answer_id": 52260543, "question_id": 52260260, "link": "https://stackoverflow.com/questions/52260260/how-to-connect-input-from-text-area-tag-email-field-tag-to-database/52260543#52260543", "title": "How to connect input from text_area_tag/email_field_tag to database?", "body": "<p>You are doing it wrong. You can't access the <em>instance variables</em> that are defined in the controller inside <code>seeds.rb</code>. Instead you just need to create the record inside the <code>index</code> action</p>\n\n<pre><code>def index\n  @name = params['name']\n  @email = params['email']\n  @question = params['question']\n  Invitation.create(:name =&gt; @name, :email =&gt; @email, :question =&gt; @question)\nend\n</code></pre>\n\n<p><code>seeds.rb</code> is used to create records with default values to seed the database. Normally these values are <em>hardcoded</em>.</p>\n"}], "owner": {"reputation": 75, "user_id": 9326999, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/11bfc4b0f12f6a76a7cd56c7fc4cb7a7?s=128&d=identicon&r=PG&f=1", "display_name": "synopsa", "link": "https://stackoverflow.com/users/9326999/synopsa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 37, "favorite_count": 0, "accepted_answer_id": 52260543, "answer_count": 1, "score": 0, "last_activity_date": 1536592018, "creation_date": 1536590436, "question_id": 52260260, "link": "https://stackoverflow.com/questions/52260260/how-to-connect-input-from-text-area-tag-email-field-tag-to-database", "title": "How to connect input from text_area_tag/email_field_tag to database?", "body": "<p>This is my code</p>\n\n<p>from index.html.erb</p>\n\n<pre><code>&lt;%= form_for index_path, :method =&gt; \"POST\"  do %&gt;\n  &lt;%= label_tag :name, \"Enter your full name: \" %&gt;\n  &lt;%= text_field_tag :name, @name, :placeholder =&gt; \"Enter your name\" %&gt;&lt;br/&gt;\n\n  &lt;%= label_tag :email, \"Enter your e-mail address: \" %&gt;\n  &lt;%= email_field_tag :email, @email, :placeholder =&gt; \"something@domain.com\" %&gt;&lt;br/&gt;\n  &lt;%= label_tag :question, \"Type your question: \" %&gt;\n  &lt;%= text_area_tag :question, @question, :size =&gt; \"30x5\", :placeholder =&gt; \"Your text goes here\", :maxlength =&gt; \"130\" %&gt;&lt;br/&gt;\n\n\n\n\n  &lt;%= submit_tag \"Ask Question\" %&gt; \n</code></pre>\n\n<p>from Blog Controller</p>\n\n<pre><code>class BlogController &lt; ApplicationController\n  def index\n    @name = params['name']\n    @email = params['email']\n    @question = params['question']\n  end\n\n  def about\n  end\n\n  def contact\n  end\nend\n</code></pre>\n\n<p>And from seeds.rb:</p>\n\n<pre><code>Invitation.create(:name =&gt; \"#{@name}\", :email =&gt; \"#{@email}\", :question =&gt; \"#{@question}\")\n</code></pre>\n\n<p>When I fill all fields and submit, it creates blank record in database, what am I doing wrong?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "heroku"], "comments": [{"owner": {"reputation": 20989, "user_id": 148844, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/263aa1ae12d9757f78167b80e596c3df?s=128&d=identicon&r=PG", "display_name": "Chloe", "link": "https://stackoverflow.com/users/148844/chloe"}, "edited": false, "score": 0, "creation_date": 1541309199, "post_id": 52259494, "comment_id": 93168632, "body": "Can you show us the JavaScript code around <code>scoreName</code>?"}], "answers": [{"comments": [{"owner": {"reputation": 185, "user_id": 10097909, "user_type": "registered", "profile_image": "https://graph.facebook.com/10156305774400751/picture?type=large", "display_name": "Jacques", "link": "https://stackoverflow.com/users/10097909/jacques"}, "edited": false, "score": 0, "creation_date": 1536596553, "post_id": 52259635, "comment_id": 91471418, "body": "Hey there, I just tried your suggestion but it seems that when pushing to Heroku after the changes that I still get them same error message."}, {"owner": {"reputation": 2251, "user_id": 9785060, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IUduC.png?s=128&g=1", "display_name": "Viktor", "link": "https://stackoverflow.com/users/9785060/viktor"}, "reply_to_user": {"reputation": 185, "user_id": 10097909, "user_type": "registered", "profile_image": "https://graph.facebook.com/10156305774400751/picture?type=large", "display_name": "Jacques", "link": "https://stackoverflow.com/users/10097909/jacques"}, "edited": false, "score": 2, "creation_date": 1536600973, "post_id": 52259635, "comment_id": 91473469, "body": "@JacquesNall&#233;tamby just to make sure, you did <code>git add</code> and <code>git commit</code> after making the changes to the <code>production.rb</code> file and before trying to push again?"}, {"owner": {"reputation": 185, "user_id": 10097909, "user_type": "registered", "profile_image": "https://graph.facebook.com/10156305774400751/picture?type=large", "display_name": "Jacques", "link": "https://stackoverflow.com/users/10097909/jacques"}, "reply_to_user": {"reputation": 2251, "user_id": 9785060, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IUduC.png?s=128&g=1", "display_name": "Viktor", "link": "https://stackoverflow.com/users/9785060/viktor"}, "edited": false, "score": 0, "creation_date": 1536602052, "post_id": 52259635, "comment_id": 91473875, "body": "@VIktor, Yes, I can confirm that I did but still getting the error of &quot;Uglifier::Error: Unexpected token name &#171;scoreName&#187;, expected punc &#171;,&#187;.&quot; when trying to push."}, {"owner": {"reputation": 2251, "user_id": 9785060, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IUduC.png?s=128&g=1", "display_name": "Viktor", "link": "https://stackoverflow.com/users/9785060/viktor"}, "reply_to_user": {"reputation": 185, "user_id": 10097909, "user_type": "registered", "profile_image": "https://graph.facebook.com/10156305774400751/picture?type=large", "display_name": "Jacques", "link": "https://stackoverflow.com/users/10097909/jacques"}, "edited": false, "score": 0, "creation_date": 1536602849, "post_id": 52259635, "comment_id": 91474215, "body": "@JacquesNall&#233;tamby Did you take a look at <a href=\"https://stackoverflow.com/questions/46270497/heroku-push-execjsruntimeerror-syntaxerror-name-expected\">this</a> ? Looks very similar to your issue"}, {"owner": {"reputation": 7811, "user_id": 379779, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/4c3bd8d869b7e1caa45485b0b3e126a4?s=128&d=identicon&r=PG", "display_name": "zawhtut", "link": "https://stackoverflow.com/users/379779/zawhtut"}, "edited": false, "score": 1, "creation_date": 1536638071, "post_id": 52259635, "comment_id": 91484350, "body": "<a href=\"https://github.com/lautis/uglifier/issues/142\" rel=\"nofollow noreferrer\">github.com/lautis/uglifier/issues/142</a> stated that Harmony implementation is halted."}, {"owner": {"reputation": 12955, "user_id": 147390, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/db953d125f5cc49756edb6149f1b813e?s=128&d=identicon&r=PG", "display_name": "Schneems", "link": "https://stackoverflow.com/users/147390/schneems"}, "edited": false, "score": 1, "creation_date": 1537217154, "post_id": 52259635, "comment_id": 91695717, "body": "I also recommend making sure <code>RAILS_ENV=production bundle exec rake assets:precompile</code> works locally before pushing to heroku."}, {"owner": {"reputation": 371, "user_id": 7573223, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIuXz.jpg?s=128&g=1", "display_name": "SMAG", "link": "https://stackoverflow.com/users/7573223/smag"}, "edited": false, "score": 0, "creation_date": 1547680857, "post_id": 52259635, "comment_id": 95279775, "body": "This is implied, but to be explicit: All environments in Heroku that precompile need to be updated with the harmony flag.  In my case changing <code>production.rb</code> alone was not enough, I also needed to update the <code>staging.rb</code> for the staging environment which lives between development and production for the Heroku build to be successful."}], "tags": [], "owner": {"reputation": 32131, "user_id": 2346461, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/i3xAf.jpg?s=128&g=1", "display_name": "Pavan", "link": "https://stackoverflow.com/users/2346461/pavan"}, "is_accepted": true, "score": 17, "last_activity_date": 1547704709, "last_edit_date": 1547704709, "creation_date": 1536588469, "answer_id": 52259635, "question_id": 52259494, "link": "https://stackoverflow.com/questions/52259494/heroku-push-issue/52259635#52259635", "title": "Heroku push issue", "body": "<blockquote>\n  <p>Uglifier::Error: Unexpected token name \u00abscoreName\u00bb, expected punc \u00ab,\u00bb.\n  To use ES6 syntax, harmony mode must be enabled with\n  Uglifier.new(:harmony => true)</p>\n</blockquote>\n\n<p>You just need to change</p>\n\n<pre><code>config.assets.js_compressor = :uglifier\n</code></pre>\n\n<p>to</p>\n\n<pre><code>config.assets.js_compressor = Uglifier.new(harmony: true)\n</code></pre>\n\n<p>in <code>production.rb</code> (or the appropriate Heroku environment like <code>staging.rb</code> where the error is being thrown in the build pipeline)</p>\n\n<p><a href=\"https://github.com/lautis/uglifier/issues/127\" rel=\"noreferrer\"><em>Source</em></a></p>\n"}], "owner": {"reputation": 185, "user_id": 10097909, "user_type": "registered", "profile_image": "https://graph.facebook.com/10156305774400751/picture?type=large", "display_name": "Jacques", "link": "https://stackoverflow.com/users/10097909/jacques"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2145, "favorite_count": 1, "accepted_answer_id": 52259635, "answer_count": 1, "score": 9, "last_activity_date": 1547704709, "creation_date": 1536588012, "question_id": 52259494, "link": "https://stackoverflow.com/questions/52259494/heroku-push-issue", "title": "Heroku push issue", "body": "<p>I am having an issue with pushing my app to Heroku. Below is my terminal output when I try to use \"git push heroku master\"</p>\n\n<pre><code>Counting objects: 22, done.\nDelta compression using up to 8 threads.\nCompressing objects: 100% (22/22), done.\nWriting objects: 100% (22/22), 2.16 KiB | 2.16 MiB/s, done.\nTotal 22 (delta 15), reused 0 (delta 0)\nremote: Compressing source files... done.\nremote: Building source:\nremote: \nremote: -----&gt; Ruby app detected\nremote: -----&gt; Compiling Ruby/Rails\nremote: -----&gt; Using Ruby version: ruby-2.5.1\nremote: -----&gt; Installing dependencies using bundler 1.15.2\nremote:        Running: bundle install --without development:test --path vendor/bundle --binstubs vendor/bundle/bin -j4 --deployment\nremote:        Warning: the running version of Bundler (1.15.2) is older than the version that created the lockfile (1.16.4). We suggest you upgrade to the latest version of Bundler by running `gem install bundler`.\nremote:        Fetching gem metadata from https://rubygems.org/.........\nremote:        Fetching version metadata from https://rubygems.org/..\nremote:        Fetching dependency metadata from https://rubygems.org/.\nremote:        Using rake 12.3.1\nremote:        Using concurrent-ruby 1.0.5\nremote:        Using minitest 5.11.3\nremote:        Using thread_safe 0.3.6\nremote:        Using builder 3.2.3\nremote:        Using erubi 1.7.1\nremote:        Using mini_portile2 2.3.0\nremote:        Using crass 1.0.4\nremote:        Using rack 2.0.5\nremote:        Using nio4r 2.3.1\nremote:        Using websocket-extensions 0.1.3\nremote:        Using mini_mime 1.0.0\nremote:        Using arel 9.0.0\nremote:        Using mimemagic 0.3.2\nremote:        Using bcrypt 3.1.12\nremote:        Using msgpack 1.2.4\nremote:        Using bundler 1.15.2\nremote:        Using cancancan 2.2.0\nremote:        Using coffee-script-source 1.12.2\nremote:        Using execjs 2.7.0\nremote:        Using method_source 0.9.0\nremote:        Using thor 0.20.0\nremote:        Using orm_adapter 0.5.0\nremote:        Using ffi 1.9.25\nremote:        Using multi_json 1.13.1\nremote:        Using pg 1.0.0\nremote:        Using puma 3.12.0\nremote:        Using rb-fsevent 0.10.3\nremote:        Using tilt 2.0.8\nremote:        Using turbolinks-source 5.1.0\nremote:        Fetching will_paginate 3.1.6\nremote:        Using tzinfo 1.2.5\nremote:        Using nokogiri 1.8.4\nremote:        Using i18n 1.1.0\nremote:        Using rack-test 1.1.0\nremote:        Using warden 1.2.7\nremote:        Using sprockets 3.7.2\nremote:        Using mail 2.7.0\nremote:        Using websocket-driver 0.7.0\nremote:        Using marcel 0.3.2\nremote:        Using coffee-script 2.4.1\nremote:        Using uglifier 4.1.18\nremote:        Using rb-inotify 0.9.10\nremote:        Using bootsnap 1.3.1\nremote:        Using turbolinks 5.1.1\nremote:        Using loofah 2.2.2\nremote:        Using activesupport 5.2.1\nremote:        Using sass-listen 4.0.0\nremote:        Using rails-html-sanitizer 1.0.4\nremote:        Using rails-dom-testing 2.0.3\nremote:        Using globalid 0.4.1\nremote:        Using activemodel 5.2.1\nremote:        Using jbuilder 2.7.0\nremote:        Using sass 3.5.7\nremote:        Using actionview 5.2.1\nremote:        Using activejob 5.2.1\nremote:        Using activerecord 5.2.1\nremote:        Using actionpack 5.2.1\nremote:        Using actioncable 5.2.1\nremote:        Using actionmailer 5.2.1\nremote:        Using activestorage 5.2.1\nremote:        Using railties 5.2.1\nremote:        Using sprockets-rails 3.2.1\nremote:        Using coffee-rails 4.2.2\nremote:        Using responders 2.4.0\nremote:        Using jquery-rails 4.3.3\nremote:        Using rails 5.2.1\nremote:        Using sass-rails 5.0.7\nremote:        Using devise 4.5.0\nremote:        Installing will_paginate 3.1.6\nremote:        Bundle complete! 20 Gemfile dependencies, 69 gems now installed.\nremote:        Gems in the groups development and test were not installed.\nremote:        Bundled gems are installed into ./vendor/bundle.\nremote:        Bundle completed (3.33s)\nremote:        Cleaning up the bundler cache.\nremote:        Warning: the running version of Bundler (1.15.2) is older than the version that created the lockfile (1.16.4). We suggest you upgrade to the latest version of Bundler by running `gem install bundler`.\nremote:        The latest bundler is 1.16.4, but you are currently running 1.15.2.\nremote:        To update, run `gem install bundler`\nremote: -----&gt; Installing node-v8.10.0-linux-x64\nremote: -----&gt; Detecting rake tasks\nremote: -----&gt; Preparing app for Rails asset pipeline\nremote:        Running: rake assets:precompile\nremote:        Yarn executable was not detected in the system.\nremote:        Download Yarn at https://yarnpkg.com/en/docs/install\nremote:        I, [2018-09-10T13:46:40.231019 #394]  INFO -- : Writing /tmp/build_d03dd820f3a6d398522db8ceeafe1812/public/assets/0-2f224f1c26eb187a4e48a623951f607419e6582b45063cb2a247ed92b2dee9fd.png\nremote:        I, [2018-09-10T13:46:40.233643 #394]  INFO -- : Writing /tmp/build_d03dd820f3a6d398522db8ceeafe1812/public/assets/1-e939388a981a2f5d794dc2c45f36224116d5d457d766baccfbafaab654933b89.png\nremote:        I, [2018-09-10T13:46:40.236052 #394]  INFO -- : Writing /tmp/build_d03dd820f3a6d398522db8ceeafe1812/public/assets/2-c97fc71270db08081907559965118e78d296b15ead96645a309f0098bbfc9ab4.png\nremote:        I, [2018-09-10T13:46:40.238092 #394]  INFO -- : Writing /tmp/build_d03dd820f3a6d398522db8ceeafe1812/public/assets/3-0fd2895b84fe6c3fe38b92e1282c65fab8b7b74fc6e92f8827d65451910d6ba4.png\nremote:        I, [2018-09-10T13:46:40.240552 #394]  INFO -- : Writing /tmp/build_d03dd820f3a6d398522db8ceeafe1812/public/assets/4-de0b5807f5a4eeb9e90e6d171904ec57848010b65d20494419565f8424884c60.png\nremote:        I, [2018-09-10T13:46:40.242957 #394]  INFO -- : Writing /tmp/build_d03dd820f3a6d398522db8ceeafe1812/public/assets/5-8dd2b09aa49f1caf833c87cc4bcb7700d31dc842e82c2fa60ddf84635af5693d.png\nremote:        I, [2018-09-10T13:46:40.249959 #394]  INFO -- : Writing /tmp/build_d03dd820f3a6d398522db8ceeafe1812/public/assets/cancel-custom-off-e7d2ac9d0d0574c9b41e3f4b838a258d31f491f3ce616b695295b5754897528d.png\nremote:        I, [2018-09-10T13:46:40.252393 #394]  INFO -- : Writing /tmp/build_d03dd820f3a6d398522db8ceeafe1812/public/assets/cancel-custom-on-e801e71a9008b085e080ca40ded7c86ee0aebcc5baee50f5c8282a1d4d14404d.png\nremote:        I, [2018-09-10T13:46:40.254896 #394]  INFO -- : Writing /tmp/build_d03dd820f3a6d398522db8ceeafe1812/public/assets/cancel-off-5758f74356b87443c8dd8d07a98b4be8b9e5b0a6304baf27bbd2b99d8e02d01c.png\nremote:        I, [2018-09-10T13:46:40.256937 #394]  INFO -- : Writing /tmp/build_d03dd820f3a6d398522db8ceeafe1812/public/assets/cancel-on-52afce0580c4df0b09e2302d54750e9d7b882b7c6c6847a16c98f606b2451389.png\nremote:        I, [2018-09-10T13:46:40.363704 #394]  INFO -- : Writing /tmp/build_d03dd820f3a6d398522db8ceeafe1812/public/assets/off-12ebbed5d82fd3c5e97d907750d59738e230e120a2c6310a75f698f4e9a02d43.png\nremote:        I, [2018-09-10T13:46:40.366453 #394]  INFO -- : Writing /tmp/build_d03dd820f3a6d398522db8ceeafe1812/public/assets/on-a138853be3ec7e6cb69a9e761fe1a2fe5985d17c2463a277f8da4a5ca7598039.png\nremote:        I, [2018-09-10T13:46:40.379200 #394]  INFO -- : Writing /tmp/build_d03dd820f3a6d398522db8ceeafe1812/public/assets/star-half-mono-2faa84c4e49ad062e611850004ec93ec89760d221400969a70918b4248b333df.png\nremote:        I, [2018-09-10T13:46:40.381479 #394]  INFO -- : Writing /tmp/build_d03dd820f3a6d398522db8ceeafe1812/public/assets/star-half-808ffaeee4006e4930f89f5dcf46f603eb173ecc365b8f3df2b822bb6747c0b8.png\nremote:        I, [2018-09-10T13:46:40.383760 #394]  INFO -- : Writing /tmp/build_d03dd820f3a6d398522db8ceeafe1812/public/assets/star-off-cf9b07584547d5d561dfac9cdbf7b6a530cb72a1b7a1096411966036c4017d38.png\nremote:        I, [2018-09-10T13:46:40.385981 #394]  INFO -- : Writing /tmp/build_d03dd820f3a6d398522db8ceeafe1812/public/assets/star-on-88233ad1abcd2282b53edb9465a6bef42fd32de319f014e4059353e4fd8a7e0a.png\nremote:        rake aborted!\nremote:        Uglifier::Error: Unexpected token name \u00abscoreName\u00bb, expected punc \u00ab,\u00bb. To use ES6 syntax, harmony mode must be enabled with Uglifier.new(:harmony =&gt; true).\nremote:        /tmp/build_d03dd820f3a6d398522db8ceeafe1812/vendor/bundle/ruby/2.5.0/gems/uglifier-4.1.18/lib/uglifier.rb:234:in `parse_result'\nremote:        /tmp/build_d03dd820f3a6d398522db8ceeafe1812/vendor/bundle/ruby/2.5.0/gems/uglifier-4.1.18/lib/uglifier.rb:216:in `run_uglifyjs'\nremote:        /tmp/build_d03dd820f3a6d398522db8ceeafe1812/vendor/bundle/ruby/2.5.0/gems/uglifier-4.1.18/lib/uglifier.rb:168:in `compile'\nremote:        /tmp/build_d03dd820f3a6d398522db8ceeafe1812/vendor/bundle/ruby/2.5.0/gems/sprockets-3.7.2/lib/sprockets/uglifier_compressor.rb:53:in `call'\nremote:        /tmp/build_d03dd820f3a6d398522db8ceeafe1812/vendor/bundle/ruby/2.5.0/gems/sprockets-3.7.2/lib/sprockets/uglifier_compressor.rb:28:in `call'\nremote:        /tmp/build_d03dd820f3a6d398522db8ceeafe1812/vendor/bundle/ruby/2.5.0/gems/sprockets-3.7.2/lib/sprockets/processor_utils.rb:75:in `call_processor\nremote:        /tmp/build_d03dd820f3a6d398522db8ceeafe1812/vendor/bundle/ruby/2.5.0/gems/sprockets-3.7.2/lib/sprockets/processor_utils.rb:57:in `block in call_processors'\nremote:        /tmp/build_d03dd820f3a6d398522db8ceeafe1812/vendor/bundle/ruby/2.5.0/gems/sprockets-3.7.2/lib/sprockets/processor_utils.rb:56:in `reverse_each'\nremote:        /tmp/build_d03dd820f3a6d398522db8ceeafe1812/vendor/bundle/ruby/2.5.0/gems/sprockets-3.7.2/lib/sprockets/processor_utils.rb:56:in `call_processors'\nremote:        /tmp/build_d03dd820f3a6d398522db8ceeafe1812/vendor/bundle/ruby/2.5.0/gems/sprockets-3.7.2/lib/sprockets/loader.rb:134:in `load_from_unloaded'\nremote:        /tmp/build_d03dd820f3a6d398522db8ceeafe1812/vendor/bundle/ruby/2.5.0/gems/sprockets-3.7.2/lib/sprockets/loader.rb:60:in `block in load'\nremote:        /tmp/build_d03dd820f3a6d398522db8ceeafe1812/vendor/bundle/ruby/2.5.0/gems/sprockets-3.7.2/lib/sprockets/loader.rb:317:in `fetch_asset_from_dependency_cache'\nremote:        /tmp/build_d03dd820f3a6d398522db8ceeafe1812/vendor/bundle/ruby/2.5.0/gems/sprockets-3.7.2/lib/sprockets/loader.rb:44:in `load'\nremote:        /tmp/build_d03dd820f3a6d398522db8ceeafe1812/vendor/bundle/ruby/2.5.0/gems/sprockets-3.7.2/lib/sprockets/cached_environment.rb:20:in `block in initialize'\nremote:        /tmp/build_d03dd820f3a6d398522db8ceeafe1812/vendor/bundle/ruby/2.5.0/gems/sprockets-3.7.2/lib/sprockets/cached_environment.rb:47:in `load'\nremote:        /tmp/build_d03dd820f3a6d398522db8ceeafe1812/vendor/bundle/ruby/2.5.0/gems/sprockets-3.7.2/lib/sprockets/base.rb:66:in `find_asset'\nremote:        /tmp/build_d03dd820f3a6d398522db8ceeafe1812/vendor/bundle/ruby/2.5.0/gems/sprockets-3.7.2/lib/sprockets/base.rb:73:in `find_all_linked_assets'\nremote:        /tmp/build_d03dd820f3a6d398522db8ceeafe1812/vendor/bundle/ruby/2.5.0/gems/sprockets-3.7.2/lib/sprockets/manifest.rb:142:in `block in find'\nremote:        /tmp/build_d03dd820f3a6d398522db8ceeafe1812/vendor/bundle/ruby/2.5.0/gems/sprockets-3.7.2/lib/sprockets/legacy.rb:114:in `block (2 levels) in logical_paths'\nremote:        /tmp/build_d03dd820f3a6d398522db8ceeafe1812/vendor/bundle/ruby/2.5.0/gems/sprockets-3.7.2/lib/sprockets/path_utils.rb:228:in `block in stat_tree\nremote:        /tmp/build_d03dd820f3a6d398522db8ceeafe1812/vendor/bundle/ruby/2.5.0/gems/sprockets-3.7.2/lib/sprockets/path_utils.rb:212:in `block in stat_directory'\nremote:        /tmp/build_d03dd820f3a6d398522db8ceeafe1812/vendor/bundle/ruby/2.5.0/gems/sprockets-3.7.2/lib/sprockets/path_utils.rb:209:in `each'\nremote:        /tmp/build_d03dd820f3a6d398522db8ceeafe1812/vendor/bundle/ruby/2.5.0/gems/sprockets-3.7.2/lib/sprockets/path_utils.rb:209:in `stat_directory'\nremote:        /tmp/build_d03dd820f3a6d398522db8ceeafe1812/vendor/bundle/ruby/2.5.0/gems/sprockets-3.7.2/lib/sprockets/path_utils.rb:227:in `stat_tree'\nremote:        /tmp/build_d03dd820f3a6d398522db8ceeafe1812/vendor/bundle/ruby/2.5.0/gems/sprockets-3.7.2/lib/sprockets/legacy.rb:105:in `each'\nremote:        /tmp/build_d03dd820f3a6d398522db8ceeafe1812/vendor/bundle/ruby/2.5.0/gems/sprockets-3.7.2/lib/sprockets/legacy.rb:105:in `block in logical_paths\nremote:        /tmp/build_d03dd820f3a6d398522db8ceeafe1812/vendor/bundle/ruby/2.5.0/gems/sprockets-3.7.2/lib/sprockets/legacy.rb:104:in `each'\nremote:        /tmp/build_d03dd820f3a6d398522db8ceeafe1812/vendor/bundle/ruby/2.5.0/gems/sprockets-3.7.2/lib/sprockets/legacy.rb:104:in `logical_paths'\nremote:        /tmp/build_d03dd820f3a6d398522db8ceeafe1812/vendor/bundle/ruby/2.5.0/gems/sprockets-3.7.2/lib/sprockets/manifest.rb:140:in `find'\nremote:        /tmp/build_d03dd820f3a6d398522db8ceeafe1812/vendor/bundle/ruby/2.5.0/gems/sprockets-3.7.2/lib/sprockets/manifest.rb:186:in `compile'\nremote:        /tmp/build_d03dd820f3a6d398522db8ceeafe1812/vendor/bundle/ruby/2.5.0/gems/sprockets-rails-3.2.1/lib/sprockets/rails/task.rb:68:in `block (3 levels) in define'\nremote:        /tmp/build_d03dd820f3a6d398522db8ceeafe1812/vendor/bundle/ruby/2.5.0/gems/sprockets-3.7.2/lib/rake/sprocketstask.rb:147:in `with_logger'\nremote:        /tmp/build_d03dd820f3a6d398522db8ceeafe1812/vendor/bundle/ruby/2.5.0/gems/sprockets-rails-3.2.1/lib/sprockets/rails/task.rb:67:in `block (2 levels) in define'\nremote:        /tmp/build_d03dd820f3a6d398522db8ceeafe1812/vendor/bundle/ruby/2.5.0/gems/rake-12.3.1/exe/rake:27:in `&lt;top (required)&gt;'\nremote:        Tasks: TOP =&gt; assets:precompile\nremote:        (See full trace by running task with --trace)\nremote: \nremote:  !\nremote:  !     Precompiling assets failed.\nremote:  !\nremote:  !     Push rejected, failed to compile Ruby app.\nremote: \nremote:  !     Push failed\nremote: Verifying deploy...\nremote: \nremote: !   Push rejected to whispering-springs-21097.\nremote: \nTo https://git.heroku.com/whispering-springs-21097.git\n ! [remote rejected] master -&gt; master (pre-receive hook declined)\n</code></pre>\n\n<p>Below is also my gemfile. </p>\n\n<pre><code>source 'https://rubygems.org'\ngit_source(:github) { |repo| \"https://github.com/#{repo}.git\" }\n\nruby '2.5.1'\n\n# Bundle edge Rails instead: gem 'rails', github: 'rails/rails'\ngem 'rails', '~&gt; 5.2.1'\n# Use sqlite3 as the database for Active Record\ngroup :development, :test do\ngem 'sqlite3'\nend\n# Use Puma as the app server\ngem 'puma', '~&gt; 3.11'\n# Use SCSS for stylesheets\ngem 'sass-rails', '~&gt; 5.0'\n# Use Uglifier as compressor for JavaScript assets\ngem 'uglifier', '&gt;= 1.3.0'\n# See https://github.com/rails/execjs#readme for more supported runtimes\n# gem 'mini_racer', platforms: :ruby\n\n# Use CoffeeScript for .coffee assets and views\ngem 'coffee-rails', '~&gt; 4.2'\n# Turbolinks makes navigating your web application faster. Read more: https://github.com/turbolinks/turbolinks\ngem 'turbolinks', '~&gt; 5'\n# Build JSON APIs with ease. Read more: https://github.com/rails/jbuilder\ngem 'jbuilder', '~&gt; 2.5'\n# Use Redis adapter to run Action Cable in production\n# gem 'redis', '~&gt; 4.0'\n# Use ActiveModel has_secure_password\n# gem 'bcrypt', '~&gt; 3.1.7'\ngem 'jquery-rails', '~&gt; 4.3', '&gt;= 4.3.3'\n# Use ActiveStorage variant\n# gem 'mini_magick', '~&gt; 4.8'\n\n# Use Capistrano for deployment\n# gem 'capistrano-rails', group: :development\n\n# Reduces boot times through caching; required in config/boot.rb\ngem 'bootsnap', '&gt;= 1.1.0', require: false\n\ngroup :development, :test do\n  # Call 'byebug' anywhere in the code to stop execution and get a debugger console\n  gem 'byebug', platforms: [:mri, :mingw, :x64_mingw]\nend\n\ngroup :development do\n  # Access an interactive console on exception pages or by calling 'console' anywhere in the code.\n  gem 'web-console', '&gt;= 3.3.0'\n  gem 'listen', '&gt;= 3.0.5', '&lt; 3.2'\n  # Spring speeds up development by keeping your application running in the background. Read more: https://github.com/rails/spring\n  gem 'spring'\n  gem 'spring-watcher-listen', '~&gt; 2.0.0'\nend\n\n\n# Windows does not include zoneinfo files, so bundle the tzinfo-data gem\ngem 'tzinfo-data', platforms: [:mingw, :mswin, :x64_mingw, :jruby]\ngem 'devise', '~&gt; 4.5'\ngem 'cancancan', '~&gt; 2.2'\ngem 'will_paginate', '~&gt; 3.1.0'\ngroup :production do\n  gem 'pg'\nend\n</code></pre>\n\n<p>I am able to push the code to github without any problems. However, Heroku seems to keep coming up with the same issue. </p>\n\n<p>Below is also my production.rb file.</p>\n\n<pre><code>Rails.application.configure do\n  # Settings specified here will take precedence over those in config/application.rb.\n  config.action_mailer.default_url_options = { host: \"whispering-springs-21097\n.herokuapp.com\" }\n  # Code is not reloaded between requests.\n  config.cache_classes = true\n\n  # Eager load code on boot. This eager loads most of Rails and\n  # your application in memory, allowing both threaded web servers\n  # and those relying on copy on write to perform better.\n  # Rake tasks automatically ignore this option for performance.\n  config.eager_load = true\n\n  # Full error reports are disabled and caching is turned on.\n  config.consider_all_requests_local       = false\n  config.action_controller.perform_caching = true\n\n  # Ensures that a master key has been made available in either ENV[\"RAILS_MASTER_KEY\"]\n  # or in config/master.key. This key is used to decrypt credentials (and other encrypted files).\n  # config.require_master_key = true\n\n  # Disable serving static files from the `/public` folder by default since\n  # Apache or NGINX already handles this.\n  config.public_file_server.enabled = ENV['RAILS_SERVE_STATIC_FILES'].present?\n\n  # Compress JavaScripts and CSS.\n  config.assets.js_compressor = :uglifier\n  # config.assets.css_compressor = :sass\n\n  # Do not fallback to assets pipeline if a precompiled asset is missed.\n  config.assets.compile = true\n\n  # `config.assets.precompile` and `config.assets.version` have moved to config/initializers/assets.rb\n\n  # Enable serving of images, stylesheets, and JavaScripts from an asset server.\n  # config.action_controller.asset_host = 'http://assets.example.com'\n\n  # Specifies the header that your server uses for sending files.\n  # config.action_dispatch.x_sendfile_header = 'X-Sendfile' # for Apache\n  # config.action_dispatch.x_sendfile_header = 'X-Accel-Redirect' # for NGINX\n\n  # Store uploaded files on the local file system (see config/storage.yml for options)\n  config.active_storage.service = :local\n\n  # Mount Action Cable outside main process or domain\n  # config.action_cable.mount_path = nil\n  # config.action_cable.url = 'wss://example.com/cable'\n  # config.action_cable.allowed_request_origins = [ 'http://example.com', /http:\\/\\/example.*/ ]\n\n  # Force all access to the app over SSL, use Strict-Transport-Security, and use secure cookies.\n  # config.force_ssl = true\n\n  # Use the lowest log level to ensure availability of diagnostic information\n  # when problems arise.\n  config.log_level = :debug\n\n  # Prepend all log lines with the following tags.\n  config.log_tags = [ :request_id ]\n\n  # Use a different cache store in production.\n  # config.cache_store = :mem_cache_store\n\n  # Use a real queuing backend for Active Job (and separate queues per environment)\n  # config.active_job.queue_adapter     = :resque\n  # config.active_job.queue_name_prefix = \"nameofapp_#{Rails.env}\"\n\n  config.action_mailer.perform_caching = false\n\n  # Ignore bad email addresses and do not raise email delivery errors.\n  # Set this to true and configure the email server for immediate delivery to raise delivery errors.\n  # config.action_mailer.raise_delivery_errors = false\n\n  # Enable locale fallbacks for I18n (makes lookups for any locale fall back to\n  # the I18n.default_locale when a translation cannot be found).\n  config.i18n.fallbacks = true\n\n  # Send deprecation notices to registered listeners.\n  config.active_support.deprecation = :notify\n\n  # Use default logging formatter so that PID and timestamp are not suppressed.\n  config.log_formatter = ::Logger::Formatter.new\n\n  # Use a different logger for distributed setups.\n  # require 'syslog/logger'\n  # config.logger = ActiveSupport::TaggedLogging.new(Syslog::Logger.new 'app-name')\n\n  if ENV[\"RAILS_LOG_TO_STDOUT\"].present?\n    logger           = ActiveSupport::Logger.new(STDOUT)\n    logger.formatter = config.log_formatter\n    config.logger    = ActiveSupport::TaggedLogging.new(logger)\n  end\n\n  # Do not dump schema after migrations.\n  config.active_record.dump_schema_after_migration = false\nend\n</code></pre>\n\n<p>Any advice would be greatly appreciated. </p>\n"}, {"tags": ["ruby-on-rails", "ruby", "hash"], "answers": [{"comments": [{"owner": {"reputation": 377, "user_id": 2563577, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/m4S4U.jpg?s=128&g=1", "display_name": "SaravanaKumAr", "link": "https://stackoverflow.com/users/2563577/saravanakumar"}, "edited": false, "score": 0, "creation_date": 1536590190, "post_id": 52259677, "comment_id": 91467795, "body": "Thanks for the answer. In you code the options are single hash but I want it to be an array of hash again."}], "tags": [], "owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "is_accepted": true, "score": 2, "last_activity_date": 1536588609, "creation_date": 1536588609, "answer_id": 52259677, "question_id": 52259074, "link": "https://stackoverflow.com/questions/52259074/converting-array-of-hashes-to-array-of-nested-hash-in-ruby/52259677#52259677", "title": "Converting array of hashes to array of nested hash in Ruby", "body": "<p>All you need is to recursively build an inner hash:</p>\n\n<pre><code>data.\n  each_with_object(Hash.new { |h, k| h[k] = h.dup.clear }) do |h, acc|\n   (h[:category].split('.').\n        reduce(acc) do |inner, cat|\n          inner[\"label\"] = cat\n          inner[\"options\"] ||= {}\n        end || {}).\n     merge!(\"tag\" =&gt; h[:tag], \"description\" =&gt; h[:description])\n  end\n#\u21d2 {\n#    \"label\" =&gt; \"Population\",\n#  \"options\" =&gt; {\n#      \"label\" =&gt; \"Behaviors\",\n#    \"options\" =&gt; {\n#        \"label\" =&gt; \"Commute\",\n#      \"options\" =&gt; {\n#        \"description\" =&gt; \"Work Outside the Home\",\n#              \"label\" =&gt; \"Vehicle\",\n#            \"options\" =&gt; {\n#          \"description\" =&gt; \"Bike to Work\",\n#                  \"tag\" =&gt; \"mbike\"\n#        },\n#                \"tag\" =&gt; \"away\"\n#      }\n#    }\n#  }\n# }\n</code></pre>\n"}], "owner": {"reputation": 377, "user_id": 2563577, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/m4S4U.jpg?s=128&g=1", "display_name": "SaravanaKumAr", "link": "https://stackoverflow.com/users/2563577/saravanakumar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 166, "favorite_count": 0, "accepted_answer_id": 52259677, "answer_count": 1, "score": -3, "last_activity_date": 1536588609, "creation_date": 1536586742, "question_id": 52259074, "link": "https://stackoverflow.com/questions/52259074/converting-array-of-hashes-to-array-of-nested-hash-in-ruby", "title": "Converting array of hashes to array of nested hash in Ruby", "body": "<p>In my ruby on rails application am getting below data from API service, the data format is array of hashes like below.</p>\n\n<pre><code>data = [\n  {\"category\": \"Population.Behaviors.Commute\", \"tag\": \"away\", \"description\": \"Work Outside the Home\"},\n  {\"category\": \"Population.Behaviors.Commute.Vehicle\", \"tag\": \"mbike\", \"description\": \"Bike to Work\"}\n]\n</code></pre>\n\n<p>The above code format I have to convert to the below format for generating the form elements.  </p>\n\n<pre><code>response_format = [\n  {\n    \"label\": \"Population\",\n    \"options\": [\n      {\n        \"label\": \"Behaviors\",\n        \"options\": [\n          {\n            \"label\": \"Commute\",\n            \"options\": [\n              {\n                \"label\": \"Vehicle\",\n                \"options\": [\n                  {\n                    \"tag\": \"mbike\",\n                    \"description\": \"Bike to Work\"\n                  }\n                ]\n              },\n              {\n                \"tag\": \"away\",\n                \"description\": \"Work Outside the Home\"\n              }\n            ]\n          }\n        ]\n      }\n    ]\n  }\n]\n</code></pre>\n\n<p>Anyone kindly help to achieve the solution. </p>\n"}, {"tags": ["ruby", "chef-infra"], "comments": [{"owner": {"reputation": 1777, "user_id": 3353157, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6168a2c2f5e3582addf6d9d70ce13749?s=128&d=identicon&r=PG", "display_name": "Peter Camilleri", "link": "https://stackoverflow.com/users/3353157/peter-camilleri"}, "edited": false, "score": 0, "creation_date": 1536593308, "post_id": 52257036, "comment_id": 91469703, "body": "Tried to run your code and it ain&#39;t runnable Ruby code. Some crucial info must be missing from the question."}, {"owner": {"reputation": 5304, "user_id": 740394, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/796442b522b037319711277a81d775ca?s=128&d=identicon&r=PG", "display_name": "Rodrigo", "link": "https://stackoverflow.com/users/740394/rodrigo"}, "edited": false, "score": 0, "creation_date": 1536594759, "post_id": 52257036, "comment_id": 91470507, "body": "Looks like ruby_block doesn&#39;t accept <code>only_if</code>  <a href=\"https://docs.chef.io/resource_ruby_block.html\" rel=\"nofollow noreferrer\">docs.chef.io/resource_ruby_block.html</a>"}, {"owner": {"reputation": 89, "user_id": 2269537, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jZffw.jpg?s=128&g=1", "display_name": "CiCa", "link": "https://stackoverflow.com/users/2269537/cica"}, "edited": false, "score": 0, "creation_date": 1536603168, "post_id": 52257036, "comment_id": 91474376, "body": "Tried commenting the <code>only_if</code> - same result unfortunately"}], "answers": [{"comments": [{"owner": {"reputation": 89, "user_id": 2269537, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jZffw.jpg?s=128&g=1", "display_name": "CiCa", "link": "https://stackoverflow.com/users/2269537/cica"}, "edited": false, "score": 1, "creation_date": 1536603324, "post_id": 52262027, "comment_id": 91474454, "body": "When you say - &#39;no longer an option&#39;. Do you have any background info as to why? Has something recently changed with regards to the usability of resources inside a Ruby block? Just trying to better understand what&#39;s going on as there doesn&#39;t seem to be a lot of <code>Chef::Resource::Execute.new</code> examples out there, to compare against..."}, {"owner": {"reputation": 43208, "user_id": 78722, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cf611565f0b79abd0b3dc200ad867661?s=128&d=identicon&r=PG", "display_name": "coderanger", "link": "https://stackoverflow.com/users/78722/coderanger"}, "reply_to_user": {"reputation": 89, "user_id": 2269537, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jZffw.jpg?s=128&g=1", "display_name": "CiCa", "link": "https://stackoverflow.com/users/2269537/cica"}, "edited": false, "score": 0, "creation_date": 1536605219, "post_id": 52262027, "comment_id": 91475363, "body": "It never really worked correctly but in days long past (like years ago) you could manually construct resource objects and fool Chef into running them. That no longer works, they really have to be created by Chef&#39;s machinery. And that means using Chef&#39;s tools rather than writing your own way."}], "tags": [], "owner": {"reputation": 43208, "user_id": 78722, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cf611565f0b79abd0b3dc200ad867661?s=128&d=identicon&r=PG", "display_name": "coderanger", "link": "https://stackoverflow.com/users/78722/coderanger"}, "is_accepted": false, "score": 0, "last_activity_date": 1536597180, "creation_date": 1536597180, "answer_id": 52262027, "question_id": 52257036, "link": "https://stackoverflow.com/questions/52257036/running-execute-resource-inside-ruby-block/52262027#52262027", "title": "Running Execute resource inside Ruby Block", "body": "<p>This is no longer an option. Write a custom resource instead. Or just use a normal resource.</p>\n"}], "owner": {"reputation": 89, "user_id": 2269537, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jZffw.jpg?s=128&g=1", "display_name": "CiCa", "link": "https://stackoverflow.com/users/2269537/cica"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 532, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1536597180, "creation_date": 1536579734, "question_id": 52257036, "link": "https://stackoverflow.com/questions/52257036/running-execute-resource-inside-ruby-block", "title": "Running Execute resource inside Ruby Block", "body": "<p>Trying to use the code below, to make resolv.conf immutable:</p>\n\n<pre><code>ruby_block \"immutable_resolv\" do\n       block do\n               r = Chef::Resource::Execute.new(\"attr settings\")\n               r.command \"/usr/bin/chattr +i /etc/resolv.conf\"\n               r.run_action(:create)\n       end\n       only_if { ::File.exist?('/etc/resolv.conf') }\nend\n</code></pre>\n\n<p>Executing against a node returns:</p>\n\n<pre><code>================================================================================\nError executing action `run` on resource 'ruby_block[immutable_resolv]'\n================================================================================\n\nNoMethodError\n-------------\nundefined method `events' for nil:NilClass\n</code></pre>\n\n<p>Can anyone advise what's going wrong with this? I've narrowed it down to a problem with the <code>r.run_action</code> line, but unsure why it's causing the error?       </p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "answers": [{"tags": [], "owner": {"reputation": 3867, "user_id": 3906189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/432b41df14bd9197f1b8601cabf49386?s=128&d=identicon&r=PG", "display_name": "siegy22", "link": "https://stackoverflow.com/users/3906189/siegy22"}, "is_accepted": true, "score": 1, "last_activity_date": 1536576245, "creation_date": 1536576245, "answer_id": 52256082, "question_id": 52255533, "link": "https://stackoverflow.com/questions/52255533/how-to-get-all-file-names-under-a-folder-set-into-enum-in-rails/52256082#52256082", "title": "How to get all file names under a folder set into enum in Rails?", "body": "<p>From the docs: <a href=\"https://api.rubyonrails.org/classes/ActiveRecord/Enum.html\" rel=\"nofollow noreferrer\">https://api.rubyonrails.org/classes/ActiveRecord/Enum.html</a></p>\n\n<blockquote>\n  <p>Declare an enum attribute where the values map to integers in the database.</p>\n</blockquote>\n\n<p>So if you pass an array (what you do) it'll store the index of the given object not the value.</p>\n\n<p>What you can do is pass in a hash:</p>\n\n<pre><code>assets_path = Rails.root.join('app', 'assets')\nassets_files = assets_path.entries.reject(&amp;File.method(:directory?))\n\n\nenum image: assets_files.map { |img| [img, img] }.to_h\n</code></pre>\n"}], "owner": {"reputation": 421, "user_id": 10130996, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/58411fd54b0352f580242debb34e4583?s=128&d=identicon&r=PG&f=1", "display_name": "zseikyocho", "link": "https://stackoverflow.com/users/10130996/zseikyocho"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 71, "favorite_count": 0, "accepted_answer_id": 52256082, "answer_count": 1, "score": 0, "last_activity_date": 1536576245, "creation_date": 1536574318, "question_id": 52255533, "link": "https://stackoverflow.com/questions/52255533/how-to-get-all-file-names-under-a-folder-set-into-enum-in-rails", "title": "How to get all file names under a folder set into enum in Rails?", "body": "<p>Using Rails 5.</p>\n\n<p>There are some files under the path:</p>\n\n<pre><code>ls app/assets/\na.jpg b.jpg c.jpg\n</code></pre>\n\n<p>Now use this way get all file names under model:</p>\n\n<pre><code>assets_path = Rails.root.join('app', 'assets')\nassets_files = Dir.entries(assets_path).select { |f| !File.directory? f}\n\nenum image: assets_files\n</code></pre>\n\n<p>However, can't get the real file use this way in the index.html.erb:</p>\n\n<pre><code>- @products.each do |product|\n  = product.image\n</code></pre>\n\n<p>Even there is a <code>a.jpg</code> data in the database.</p>\n\n<p>Another issue, set this select item in the _form.html.erb view:</p>\n\n<pre><code>= f.select :image, Product.images.map {|k, v| [k, k]}\n</code></pre>\n\n<p>it can been shown in the html select item:</p>\n\n<pre><code>&lt;select name='product[image]' id='product_image'&gt;\n  &lt;option value='a.jpg'&gt;a.jpg&lt;/option&gt;\n  &lt;option value='b.jpg'&gt;b.jpg&lt;/option&gt;\n  &lt;option value='c.jpg'&gt;c.jpg&lt;/option&gt;\n&lt;/select&gt;\n</code></pre>\n\n<p>But after save the data, found 1 in db when selected <code>a.jpg</code>.</p>\n\n<p>Anything wrong?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "activerecord"], "comments": [{"owner": {"reputation": 199, "user_id": 6670519, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/t7r9T.jpg?s=128&g=1", "display_name": "Dapeng114", "link": "https://stackoverflow.com/users/6670519/dapeng114"}, "edited": false, "score": 2, "creation_date": 1536574438, "post_id": 52255506, "comment_id": 91458295, "body": "Record.order(created_at: :desc).first"}, {"owner": {"reputation": 51, "user_id": 9937206, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a2ad5dc0a1ab32d105345cffc4c0475b?s=128&d=identicon&r=PG&f=1", "display_name": "Noname", "link": "https://stackoverflow.com/users/9937206/noname"}, "reply_to_user": {"reputation": 199, "user_id": 6670519, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/t7r9T.jpg?s=128&g=1", "display_name": "Dapeng114", "link": "https://stackoverflow.com/users/6670519/dapeng114"}, "edited": false, "score": 0, "creation_date": 1536574603, "post_id": 52255506, "comment_id": 91458365, "body": "Thank you @Dapeng114! why &quot;.first&quot; if I&#39;m trying to find the the newest(last) record? wouldn&#39;t it be Record.where(created_at: :desc).last ? (I know u have ur reasons and im probably wrong but would like to understand it better)"}, {"owner": {"reputation": 199, "user_id": 6670519, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/t7r9T.jpg?s=128&g=1", "display_name": "Dapeng114", "link": "https://stackoverflow.com/users/6670519/dapeng114"}, "edited": false, "score": 0, "creation_date": 1536574810, "post_id": 52255506, "comment_id": 91458455, "body": "My answer is the same with your first option. <code>Article Load (0.5ms)  SELECT  `articles`.* FROM `articles` ORDER BY `articles`.`created_at` DESC LIMIT 1</code>"}, {"owner": {"reputation": 51, "user_id": 9937206, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a2ad5dc0a1ab32d105345cffc4c0475b?s=128&d=identicon&r=PG&f=1", "display_name": "Noname", "link": "https://stackoverflow.com/users/9937206/noname"}, "reply_to_user": {"reputation": 199, "user_id": 6670519, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/t7r9T.jpg?s=128&g=1", "display_name": "Dapeng114", "link": "https://stackoverflow.com/users/6670519/dapeng114"}, "edited": false, "score": 0, "creation_date": 1536580034, "post_id": 52255506, "comment_id": 91461332, "body": "@Dapeng114 got it!! THANK YOU!"}], "answers": [{"tags": [], "owner": {"reputation": 973, "user_id": 9989384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/530602201f9551563176b0b648b7d50b?s=128&d=identicon&r=PG&f=1", "display_name": "Cryptex Technologies", "link": "https://stackoverflow.com/users/9989384/cryptex-technologies"}, "is_accepted": false, "score": 1, "last_activity_date": 1536574743, "creation_date": 1536574743, "answer_id": 52255638, "question_id": 52255506, "link": "https://stackoverflow.com/questions/52255506/find-last-created-at-record/52255638#52255638", "title": "Find last created_at record", "body": "<p>In Rails, you can also add the line</p>\n\n<pre><code>default_scope { order(created_at: :asc) } \n</code></pre>\n\n<p>to the Record model to ensure that Record.last behaves as expected you can find the newest record</p>\n\n<p>You can refer the link <a href=\"https://guides.rubyonrails.org/active_record_querying.html#passing-in-arguments\" rel=\"nofollow noreferrer\">scopes in rails</a></p>\n"}, {"comments": [{"owner": {"reputation": 51, "user_id": 9937206, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a2ad5dc0a1ab32d105345cffc4c0475b?s=128&d=identicon&r=PG&f=1", "display_name": "Noname", "link": "https://stackoverflow.com/users/9937206/noname"}, "edited": false, "score": 0, "creation_date": 1536580300, "post_id": 52256746, "comment_id": 91461438, "body": "So to have the most recent/latest record from the database is it: <code>Record.order(created_at: :desc).last</code> or  <code>Record.order(created_at: :desc).first</code> as someone suggest before? also? tree index?"}, {"owner": {"reputation": 79498, "user_id": 298624, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/5b84ccc2f7709bbb7105baeb40e0961b?s=128&d=identicon&r=PG", "display_name": "fl00r", "link": "https://stackoverflow.com/users/298624/fl00r"}, "reply_to_user": {"reputation": 51, "user_id": 9937206, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a2ad5dc0a1ab32d105345cffc4c0475b?s=128&d=identicon&r=PG&f=1", "display_name": "Noname", "link": "https://stackoverflow.com/users/9937206/noname"}, "edited": false, "score": 0, "creation_date": 1536581245, "post_id": 52256746, "comment_id": 91462029, "body": "sorry, it is <code>first</code> of course. or <code>Record.order(created_at: :asc).last</code>. Tree index is an &quot;ordered&quot; kind of index that can easily retreive sorted data. Search for &quot;btree index in mysql/postgresql&quot; or other rdbms of your choice."}], "tags": [], "owner": {"reputation": 79498, "user_id": 298624, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/5b84ccc2f7709bbb7105baeb40e0961b?s=128&d=identicon&r=PG", "display_name": "fl00r", "link": "https://stackoverflow.com/users/298624/fl00r"}, "is_accepted": true, "score": 0, "last_activity_date": 1536581250, "last_edit_date": 1536581250, "creation_date": 1536578547, "answer_id": 52256746, "question_id": 52255506, "link": "https://stackoverflow.com/questions/52255506/find-last-created-at-record/52256746#52256746", "title": "Find last created_at record", "body": "<p>That's a valid request</p>\n\n<pre><code>Record.order(created_at: :desc).first\n</code></pre>\n\n<p>take care of a tree index on this field to have a better performance, though</p>\n"}], "owner": {"reputation": 51, "user_id": 9937206, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a2ad5dc0a1ab32d105345cffc4c0475b?s=128&d=identicon&r=PG&f=1", "display_name": "Noname", "link": "https://stackoverflow.com/users/9937206/noname"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1445, "favorite_count": 0, "accepted_answer_id": 52256746, "answer_count": 2, "score": 1, "last_activity_date": 1536581250, "creation_date": 1536574258, "question_id": 52255506, "link": "https://stackoverflow.com/questions/52255506/find-last-created-at-record", "title": "Find last created_at record", "body": "<p>How can I find the last record by their created_at field? </p>\n\n<p><code>Record.order(\"created_at\").last</code></p>\n\n<p>or </p>\n\n<p><code>Record.where(:created_at).last</code></p>\n\n<p>or </p>\n\n<p>Neither and there is a better way? </p>\n"}, {"tags": ["ruby", "tabular"], "comments": [{"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 2, "creation_date": 1536573911, "post_id": 52255345, "comment_id": 91458032, "body": "How would that table look like? What have you tried so far? What problems did you encounter?"}, {"owner": {"reputation": 9663, "user_id": 5239030, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/76JEw.png?s=128&g=1", "display_name": "iGian", "link": "https://stackoverflow.com/users/5239030/igian"}, "edited": false, "score": 0, "creation_date": 1536578617, "post_id": 52255345, "comment_id": 91460642, "body": "An helpful tool could be <a href=\"https://ruby-doc.org/core-2.5.0/String.html#method-i-rjust\" rel=\"nofollow noreferrer\">ruby-doc.org/core-2.5.0/String.html#method-i-rjust</a>, but as Stefan pointed, how&#39;s the table?"}], "answers": [{"tags": [], "owner": {"reputation": 167912, "user_id": 240443, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/495d675e3bc42ed1dee469e2ce701f1b?s=128&d=identicon&r=PG", "display_name": "Amadan", "link": "https://stackoverflow.com/users/240443/amadan"}, "is_accepted": false, "score": 0, "last_activity_date": 1536581053, "creation_date": 1536581053, "answer_id": 52257400, "question_id": 52255345, "link": "https://stackoverflow.com/questions/52255345/fizzbuzz-program-output-in-form-of-table/52257400#52257400", "title": "FizzBuzz Program Output in form of table", "body": "<p>Here is FizzBuzz in form of a table:</p>\n\n<pre><code>def fizzbuzz_gen(num)\n  Enumerator.new do |y|\n    (1..num).each do |i|\n      if i % 3 == 0 &amp;&amp; i % 5 == 0\n        y &lt;&lt; 'FizzBuzz'\n      elsif i % 3 == 0\n        y &lt;&lt; 'Fizz'\n      elsif i % 5 == 0\n        y &lt;&lt; 'Buzz'\n      else\n        y &lt;&lt; i.to_s\n      end\n    end\n  end\nend\n\ndef fill_to_width(width, e)\n  result = \"\"\n  future_length = -1\n  while result.length + future_length &lt; width\n    result &lt;&lt; e.next\n    result &lt;&lt; \" \"\n    future_length = e.peek.length\n  end\n  result.center(width)\nend\n\ndef format_table(num)\n  fb = fizzbuzz_gen(num)\n  begin\n    puts fill_to_width(75, fb)\n    puts fill_to_width(75, fb)\n    loop do\n      puts \"%10s%s%31s%s\" % [\"\", fill_to_width(12, fb), \"\", fill_to_width(12, fb)]\n    end\n  rescue StopIteration\n  end\nend\n\nformat_table(100)\n</code></pre>\n\n<p>There may be less numbers output than specified, in order for one leg not to be shorter than another.</p>\n"}], "owner": {"reputation": 19, "user_id": 9088469, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/07f878be15c6628f2ebc6936ba56ae82?s=128&d=identicon&r=PG&f=1", "display_name": "Shan_Boy", "link": "https://stackoverflow.com/users/9088469/shan-boy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 77, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1536595003, "creation_date": 1536573730, "last_edit_date": 1536595003, "question_id": 52255345, "link": "https://stackoverflow.com/questions/52255345/fizzbuzz-program-output-in-form-of-table", "title": "FizzBuzz Program Output in form of table", "body": "<p>I have written the logic for the program to perform FizzBuzz operations:</p>\n\n<h1>fizzbuzz</h1>\n\n<pre><code>module FizzBuzz\n  class Operation\n    def input\n      puts 'Enter a number upto which Fizz/Buzz needs to be printed'\n      num = gets.chomp.to_i\n      fizzbuzz_function(num)\n    end\n\n    def fizzbuzz_function(num)\n      for i in 1..num\n        if i % 3 == 0 &amp;&amp; i % 5 == 0\n          puts 'FizzBuzz'\n        elsif i % 3 == 0\n          puts 'Fizz'\n        elsif i % 5 == 0\n          puts 'Buzz'\n        else\n          puts i\n        end\n      end\n    end\nend\n  res = Operation.new\n  res.input\nend\n</code></pre>\n\n<p>But I am trying to print the output in form of a table.</p>\n"}, {"tags": ["ruby", "byte", "filesize"], "comments": [{"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1536573814, "post_id": 52255235, "comment_id": 91457978, "body": "Which units do you have to convert?"}, {"owner": {"reputation": 154, "user_id": 3636388, "user_type": "registered", "accept_rate": 31, "profile_image": "https://www.gravatar.com/avatar/6466644a0ef8d77f6e2dfbb0ae0e8554?s=128&d=identicon&r=PG&f=1", "display_name": "user3636388", "link": "https://stackoverflow.com/users/3636388/user3636388"}, "reply_to_user": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1536573928, "post_id": 52255235, "comment_id": 91458038, "body": "Commonly used units of filesize, B, KB, MB, GB"}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 1, "creation_date": 1536574189, "post_id": 52255235, "comment_id": 91458169, "body": "I don&#39;t know any gem for this but you can probably parse a <code>number unit</code> pattern and perform the conversion yourself. Shouldn&#39;t be that hard."}], "answers": [{"tags": [], "owner": {"reputation": 5449, "user_id": 681520, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/701baebf68d1d7faa9f9def6a24fe356?s=128&d=identicon&r=PG", "display_name": "Kimmo Lehto", "link": "https://stackoverflow.com/users/681520/kimmo-lehto"}, "is_accepted": true, "score": 4, "last_activity_date": 1536577505, "last_edit_date": 1536577505, "creation_date": 1536576614, "answer_id": 52256193, "question_id": 52255235, "link": "https://stackoverflow.com/questions/52255235/convert-human-readable-file-size-to-bytes-in-ruby/52256193#52256193", "title": "Convert human readable file size to bytes in ruby", "body": "<p>There's <a href=\"https://github.com/dominikh/filesize\" rel=\"nofollow noreferrer\">filesize</a> (<a href=\"https://rubygems.org/gems/filesize/versions/0.1.1\" rel=\"nofollow noreferrer\">rubygems</a>)</p>\n\n<p>It's quite trivial to write your own:</p>\n\n<pre><code>module ToBytes\n  def to_bytes\n    md = match(/^(?&lt;num&gt;\\d+)\\s?(?&lt;unit&gt;\\w+)?$/)\n    md[:num].to_i * \n      case md[:unit]\n      when 'KB'\n        1024\n      when 'MB'\n        1024**2\n      when 'GB'\n        1024**3\n      when 'TB'\n        1024**4\n      when 'PB'\n        1024**5\n      when 'EB'\n        1024**6\n      when 'ZB'\n        1024**7\n      when 'YB'\n        1024**8\n      else\n        1\n      end\n  end\nend\n\nsize_string = \"10KB\"\nsize_string.extend(ToBytes).to_bytes\n=&gt; 10240\n\nString.include(ToBytes)\n\"1024 KB\".to_bytes\n=&gt; 1048576\n</code></pre>\n\n<p>If you need <code>KiB</code>, <code>MiB</code> etc then you just add multipliers. </p>\n"}, {"tags": [], "owner": {"reputation": 80955, "user_id": 1002260, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/5ec9c21c8d54825b04def7a41998d18d?s=128&d=identicon&r=PG", "display_name": "Steven Penny", "link": "https://stackoverflow.com/users/1002260/steven-penny"}, "is_accepted": false, "score": -1, "last_activity_date": 1605670242, "last_edit_date": 1605670242, "creation_date": 1605641999, "answer_id": 64882205, "question_id": 52255235, "link": "https://stackoverflow.com/questions/52255235/convert-human-readable-file-size-to-bytes-in-ruby/64882205#64882205", "title": "Convert human readable file size to bytes in ruby", "body": "<p>Here is a method using <code>while</code>:</p>\n<pre><code>def number_format(n)\n   n2, n3 = n, 0\n   while n2 &gt;= 1e3\n      n2 /= 1e3\n      n3 += 1\n   end\n   return '%.3f' % n2 + ['', ' k', ' M', ' G'][n3]\nend\n\ns = number_format(9012345678)\nputs s == '9.012 G'\n</code></pre>\n<p><a href=\"https://ruby-doc.org/core/doc/syntax/control_expressions_rdoc.html#label-while+Loop\" rel=\"nofollow noreferrer\">https://ruby-doc.org/core/doc/syntax/control_expressions_rdoc.html#label-while+Loop</a></p>\n"}], "owner": {"reputation": 154, "user_id": 3636388, "user_type": "registered", "accept_rate": 31, "profile_image": "https://www.gravatar.com/avatar/6466644a0ef8d77f6e2dfbb0ae0e8554?s=128&d=identicon&r=PG&f=1", "display_name": "user3636388", "link": "https://stackoverflow.com/users/3636388/user3636388"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 977, "favorite_count": 0, "accepted_answer_id": 52256193, "answer_count": 2, "score": 0, "last_activity_date": 1605670242, "creation_date": 1536573348, "question_id": 52255235, "link": "https://stackoverflow.com/questions/52255235/convert-human-readable-file-size-to-bytes-in-ruby", "title": "Convert human readable file size to bytes in ruby", "body": "<p>I went through this <a href=\"https://stackoverflow.com/questions/16026048/pretty-file-size-in-ruby\">link</a>. My requirement is the exact reverse of this. Example a string 10KB needs to be converted to 10240 (its equivalent byte size). Do we have any gem for this? or inbuilt method in ruby? I did my research, I wasn't able to spot it</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1536578090, "post_id": 52255193, "comment_id": 91460326, "body": "That code, in isolation, should work fine in both rails versions. There must be something else that causes the error. Can you show us the <i>full</i> stack trace, not just the last line?"}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 4, "creation_date": 1536578132, "post_id": 52255193, "comment_id": 91460355, "body": "My guess (given the lack of information) is that you&#39;re using an older version of <code>ransack</code>; support for rails 5.2.1 was added in <a href=\"https://github.com/activerecord-hackery/ransack/pull/938\" rel=\"nofollow noreferrer\">this PR</a> -- you need to update the gem."}, {"owner": {"reputation": 135, "user_id": 4632255, "user_type": "registered", "profile_image": "https://graph.facebook.com/686108588166757/picture?type=large", "display_name": "Gopi Raju", "link": "https://stackoverflow.com/users/4632255/gopi-raju"}, "reply_to_user": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 2, "creation_date": 1536579786, "post_id": 52255193, "comment_id": 91461221, "body": "Thanks, @Tom Lord. yeah, after updating my ransack gem version 1.8.8 to 2.0.1 it&#39;s working."}], "owner": {"reputation": 135, "user_id": 4632255, "user_type": "registered", "profile_image": "https://graph.facebook.com/686108588166757/picture?type=large", "display_name": "Gopi Raju", "link": "https://stackoverflow.com/users/4632255/gopi-raju"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 263, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1536573222, "creation_date": 1536573222, "question_id": 52255193, "link": "https://stackoverflow.com/questions/52255193/rails-5-2-1-association-issues", "title": "Rails 5.2.1 association issues", "body": "<p>I'm facing joins association issue in Rails 5.2.1, below query working properly in rails 5.2.0 but not in 5.2.1</p>\n\n<pre><code>User.joins(:roles).where(email: 'test@gmail.com', roles: {titles: ['test1', 'test2']})\n</code></pre>\n\n<p>Here relation between user and roles had has_many, following error I'm getting while running this query in rails console.</p>\n\n<pre><code>ArgumentError: wrong number of arguments (given 3, expected 2)\n</code></pre>\n\n<p>from /Users/testuser/.rvm/gems/ruby-2.5.1/gems/activerecord-5.2.1/lib/active_record/associations/join_dependency/join_association.rb:12:in `initialize'</p>\n"}, {"tags": ["ruby-on-rails", "json", "ruby"], "answers": [{"comments": [{"owner": {"reputation": 135, "user_id": 2834674, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a84a1b121afaf680a039cc7c1c2a9652?s=128&d=identicon&r=PG", "display_name": "turkeyman84", "link": "https://stackoverflow.com/users/2834674/turkeyman84"}, "edited": false, "score": 0, "creation_date": 1536578490, "post_id": 52256604, "comment_id": 91460574, "body": "Thank you for this, it has pointed me in the right direction. My implementation is also posted as an answer now."}], "tags": [], "owner": {"reputation": 536, "user_id": 8436554, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/d3XUa.jpg?s=128&g=1", "display_name": "Amr Adel", "link": "https://stackoverflow.com/users/8436554/amr-adel"}, "is_accepted": false, "score": 1, "last_activity_date": 1536578068, "creation_date": 1536578068, "answer_id": 52256604, "question_id": 52255085, "link": "https://stackoverflow.com/questions/52255085/how-to-sort-a-nested-array-of-json-objects-in-ruby/52256604#52256604", "title": "How to sort a nested array of JSON objects in Ruby?", "body": "<p>I believe <code>.sort_by { |x| x[0][\"column_value\"] }</code> is the main problem, for example if you got something like this.</p>\n\n<pre><code>f = [[{'a' =&gt; 4}, {'a' =&gt; 2}]]\n# =&gt; [[{\"a\"=&gt;4}, {\"a\"=&gt;2}]]\nf.sort_by{|d| d[0]['a']}\n# =&gt; [[{\"a\"=&gt;4}, {\"a\"=&gt;2}]], won't change anything\nf.first.sort_by{|d| d['a'] } # first represent the [0] here\n# =&gt; [{\"a\"=&gt;2}, {\"a\"=&gt;4}], This gonna work\n</code></pre>\n\n<p>Using your approach got something wrong which is you are doing sort on the outer array, making when it like this <code>{ |x| x[0][\"column_value\"] }</code> I believe ruby tried to sort <code>(outer array)</code> by sorting its inner arrays <code>(which is one)</code> on some attribute called <code>'column_value'</code>, But specifying that your working on the inner array will affect the inner array as the example above, Hope it works with you.</p>\n\n<p>You can use <code>sort_by!</code> to sort it in-place.</p>\n"}, {"tags": [], "owner": {"reputation": 135, "user_id": 2834674, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a84a1b121afaf680a039cc7c1c2a9652?s=128&d=identicon&r=PG", "display_name": "turkeyman84", "link": "https://stackoverflow.com/users/2834674/turkeyman84"}, "is_accepted": false, "score": 0, "last_activity_date": 1536578529, "creation_date": 1536578529, "answer_id": 52256735, "question_id": 52255085, "link": "https://stackoverflow.com/questions/52255085/how-to-sort-a-nested-array-of-json-objects-in-ruby/52256735#52256735", "title": "How to sort a nested array of JSON objects in Ruby?", "body": "<p>A worked implementation is below, probably this is not optimal but it works:</p>\n\n<pre><code>  def set_sorted_data(data)\n    @new_data = data\n    self.report_template.report_template_columns.where('sort_priority != ?', 1000).order(:sort_priority).reverse.each_with_index do |report_template_column|\n      @new_data[0].each_with_index do |item_row_datum, index|\n        if item_row_datum[:column_id] == report_template_column.column_id\n          @index = index\n        end\n      end\n      if report_template_column.column_type == 'number'\n        @new_data.sort_by! { |item_row_datum| item_row_datum[@index][:column_value].to_i }\n      elsif report_template_column.column_type == 'datetime'\n        @new_data.sort_by! { |item_row_datum| item_row_datum[@index][:column_value].to_date }\n      else\n        @new_data.sort_by! { |item_row_datum| item_row_datum[@index][:column_value].to_s }\n      end\n      if report_template_column.sort_direction == 'desc'\n        @new_data = @new_data.reverse\n      end\n    end\n    return @new_data\n  end\n</code></pre>\n"}], "owner": {"reputation": 135, "user_id": 2834674, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a84a1b121afaf680a039cc7c1c2a9652?s=128&d=identicon&r=PG", "display_name": "turkeyman84", "link": "https://stackoverflow.com/users/2834674/turkeyman84"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 211, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1536578529, "creation_date": 1536572851, "last_edit_date": 1536572989, "question_id": 52255085, "link": "https://stackoverflow.com/questions/52255085/how-to-sort-a-nested-array-of-json-objects-in-ruby", "title": "How to sort a nested array of JSON objects in Ruby?", "body": "<p>Good morning! I have a tricky dataset to work with in Rails. It's an array of an array of JSON objects, each with 4 attributes. Example is below:</p>\n\n<pre><code>[\n    [\n        {\n            \"column_name\": \"ID\",\n            \"column_id\": \"item_attributes#id\",\n            \"column_value\": \"25295119-7113-42fe-90d5-394c7a841b31\",\n            \"column_type\": \"string\"\n        },\n        {\n            \"column_name\": \"Name\",\n            \"column_id\": \"item_attributes#name\",\n            \"column_value\": \"Webform submission\",\n            \"column_type\": \"string\"\n        },\n        {\n            \"column_name\": \"Current owner\",\n            \"column_id\": \"item_attributes#current_owner\",\n            \"column_value\": \"Joe Bloggs\",\n            \"column_type\": \"string\"\n        },\n        {\n            \"column_name\": \"State\",\n            \"column_id\": \"item_attributes#state\",\n            \"column_value\": \"New Task\",\n            \"column_type\": \"string\"\n        },\n        {\n            \"column_name\": \"Status\",\n            \"column_id\": \"item_attributes#status\",\n            \"column_value\": \"In progress\",\n            \"column_type\": \"string\"\n        },\n        {\n            \"column_name\": \"Created at\",\n            \"column_id\": \"item_attributes#created_at\",\n            \"column_value\": \"07/09/2018, 10:47 am\",\n            \"column_type\": \"datetime\"\n        },\n        {\n            \"column_name\": \"Updated at\",\n            \"column_id\": \"item_attributes#updated_at\",\n            \"column_value\": \"07/09/2018, 10:47 am\",\n            \"column_type\": \"datetime\"\n        },\n        {\n            \"column_name\": \"Task reviewer\",\n            \"column_id\": \"item_participant_attributes#90a76abe-028f-45bc-8390-433bc39ba02e\",\n            \"column_value\": \"Jane Bloggs\",\n            \"column_type\": \"string\"\n        },\n        {\n            \"column_name\": \"Task owner\",\n            \"column_id\": \"item_participant_attributes#5bce3a02-07bf-4353-9f3d-2cc60f787584\",\n            \"column_value\": \"Jack blogs\",\n            \"column_type\": \"string\"\n        },\n        {\n            \"column_name\": \"Make a list of your weekly tasks. Update status of this object to complete when it's complete.\",\n            \"column_id\": \"element_attributes#533e26d8-c313-4d94-ab99-37263b0aa4ee\",\n            \"column_value\": null,\n            \"column_type\": \"string\"\n        },\n        {\n            \"column_name\": \"Set target end date (choose Friday for end of this week)\",\n            \"column_id\": \"element_attributes#6eeddd67-e1de-40c3-b220-197ddf554241\",\n            \"column_value\": null,\n            \"column_type\": \"datetime\"\n        },\n        {\n            \"column_name\": \"Reviewer comments (optional)\",\n            \"column_id\": \"element_attributes#3923358c-85f0-444b-9287-4738d9148eb9\",\n            \"column_value\": null,\n            \"column_type\": \"string\"\n        }\n    ], \n    [...]\n]\n</code></pre>\n\n<p>I have a model called <code>ReportTemplateColumn</code> model that defines the <code>sort_priority</code> and <code>sort_direction</code> required for each item, along with it's relevant <code>column_id</code>. </p>\n\n<p>I need to loop through the <code>ReportTemplateColumns</code> and apply their sort direction in order of priority to the dataset described above.</p>\n\n<p>For example, I know that I need to re-order the dataset by <code>column_id = item_attributes#name</code> in order <code>desc</code>. The array of arrays needs to change order based on the <code>column_value</code> value.</p>\n\n<p><strong>My attempt</strong></p>\n\n<pre><code>  def set_sorted_data(data)\n    @new_data = data\n    self.report_template.report_template_columns.where('sort_priority != ?', 1000).order(:sort_priority).each do |report_template_column|\n      @new_data = @new_data.sort_by { |x| x[0][\"column_value\"] }\n    end\n    return @new_data\n  end\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "activerecord", "save", "overriding"], "comments": [{"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1536572459, "post_id": 52254416, "comment_id": 91457312, "body": "What are you trying to achieve by overriding <code>save</code>? Maybe there&#39;s a better solution."}], "answers": [{"comments": [{"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1536570985, "post_id": 52254538, "comment_id": 91456518, "body": "You can just write <code>super</code> to pass any given arguments."}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1536571291, "post_id": 52254538, "comment_id": 91456676, "body": "<i>&quot;I think it is a terrible idea&quot;</i> \u2013 do you have a better suggestion for the OP?"}, {"owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "reply_to_user": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 1, "creation_date": 1536572023, "post_id": 52254538, "comment_id": 91457060, "body": "I decided against just writing <code>super</code> to make it clearer what needs to happen. Better suggestion? Depends on what the OP really want to achieve. I would probably just create a method with a name that makes it easier to understand how this implementation differs from the original <code>save</code> method - <code>save_into_default_db</code>?"}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1536572836, "post_id": 52254538, "comment_id": 91457486, "body": "That approach would work if the OP wants to have both, the original <code>save</code> and a variant that uses the <code>:default</code> database config. If however the goal is to make the <code>User</code> model use the <code>:default</code> config, then having a different method name would probably not work well (think of <code>create</code> or <code>update</code> which still call <code>save</code> under the hood)."}, {"owner": {"reputation": 97, "user_id": 6927514, "user_type": "registered", "profile_image": "https://graph.facebook.com/1417569534938796/picture?type=large", "display_name": "Harsimar Sandhu", "link": "https://stackoverflow.com/users/6927514/harsimar-sandhu"}, "edited": false, "score": 0, "creation_date": 1536580248, "post_id": 52254538, "comment_id": 91461410, "body": "what I want to achieve is basically use default/master db only for write queries and for reading purposes it should go to slave db (which I set default in EB environment)"}], "tags": [], "owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "is_accepted": false, "score": 5, "last_activity_date": 1536570935, "creation_date": 1536570935, "answer_id": 52254538, "question_id": 52254416, "link": "https://stackoverflow.com/questions/52254416/overriding-save-in-ruby-on-rails/52254538#52254538", "title": "Overriding save in Ruby on Rails", "body": "<p>I think it is a terrible idea to override such an important method of the public <code>ActiveRecord</code> API. </p>\n\n<p>But if you really want to override <code>save</code> then you should allow your <code>save</code> method to receive the same arguments as the <a href=\"https://api.rubyonrails.org/classes/ActiveRecord/Persistence.html#method-i-save\" rel=\"noreferrer\">original <code>save</code> method</a> and pass these arguments to <code>super</code> too.</p>\n\n<pre><code>def save(*args)\n  # ...\n  Multidb.use(:default) do\n    super(*args)\n  end\n  # ...\nend\n</code></pre>\n"}], "owner": {"reputation": 97, "user_id": 6927514, "user_type": "registered", "profile_image": "https://graph.facebook.com/1417569534938796/picture?type=large", "display_name": "Harsimar Sandhu", "link": "https://stackoverflow.com/users/6927514/harsimar-sandhu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 241, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1536570935, "creation_date": 1536570435, "question_id": 52254416, "link": "https://stackoverflow.com/questions/52254416/overriding-save-in-ruby-on-rails", "title": "Overriding save in Ruby on Rails", "body": "<p>Hello i want to override save method in ruby but while doing so i get \nfollowing error while saving a object with some changes</p>\n\n<pre><code>    User.name = \"alex\"\n    User.save\n</code></pre>\n\n<p>ArgumentError: wrong number of arguments (1 for 0) </p>\n\n<p>My code is as below</p>\n\n<pre><code>class ActiveRecord::Base\n\n  def save()\n      p \"in My save\\n\"\n      Multidb.use(:default) do\n          p \"calling super\\n\"\n      super()\n      end\n      p \"saved\\n\"\n  end\n\nend\n</code></pre>\n"}, {"tags": ["ruby", "ubuntu", "vagrant"], "owner": {"reputation": 107, "user_id": 5445033, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/4ef5857f9895dea99907b35ea7f1a57a?s=128&d=identicon&r=PG&f=1", "display_name": "johnson", "link": "https://stackoverflow.com/users/5445033/johnson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 435, "favorite_count": 1, "answer_count": 0, "score": 1, "last_activity_date": 1536595221, "creation_date": 1536560682, "last_edit_date": 1536595221, "question_id": 52252148, "link": "https://stackoverflow.com/questions/52252148/ssh-freeze-while-running-vagrant-up", "title": "ssh freeze while running vagrant up", "body": "<p>I am trying to setup an RHCE lab on my machine. I've installed vagrant version <code>Vagrant 2.1.4</code> and virtualbox 5 on ubuntu 16.04. I downloaded centos-7.0-x86_64.box from [<a href=\"https://computingforgeeks.com/how-to-addinstall-and-run-centos-7-vagrant-box-to-virtualbox-using-vagrant/][1]\" rel=\"nofollow noreferrer\">https://computingforgeeks.com/how-to-addinstall-and-run-centos-7-vagrant-box-to-virtualbox-using-vagrant/][1]</a></p>\n\n<p>I installed vagrant plugins vagrant plugin  vagrant-vbguest &amp;&amp;  sahara</p>\n\n<p>Here is my vagrant   script</p>\n\n<pre><code># -*- mode: ruby -*-\n# vi: set ft=ruby :\nserver_disk='server.vdi'\ndesktop_disk='desktop.vdi'\nVagrant.configure(2) do |config|\n config.vm.box = \"centos/7\"\n config.vm.define \"classroom\" do |s|\n  s.vbguest.auto_update = false\n  s.vm.network \"private_network\", ip: \"192.168.33.254\"\n  s.vm.synced_folder \".\", \"/vagrant\", disabled: true\n  #s.vm.synced_folder \"../repos\", \"/repos\", owner: \"root\", group: \"root\"\n  s.vm.synced_folder \"scripts/classroom\", \"/usr/local/scripts\", type: \"rsync\", owner: \"root\", group: \"root\"\n  s.vm.provision \"shell\", inline: &lt;&lt;-SHELL\n   chmod u+x /usr/local/scripts/classroom.sh\n   /usr/local/scripts/classroom.sh\n  SHELL\n end\n\n config.vm.define \"server\" do |a|\n  a.vbguest.auto_update = false\n  a.vm.provider \"virtualbox\" do |v|\n   unless File.exist?(server_disk)\n    v.customize ['createhd', '--filename', server_disk, '--size', 20 * 1024]\n   end\n   v.customize ['storageattach', :id, '--storagectl', 'IDE Controller', '--port', 1, '--device', 0, '--type', 'hdd', '--medium', server_disk]\n   end\n  a.vm.network \"private_network\", ip: \"192.168.33.11\"\n  a.vm.synced_folder \".\", \"/vagrant\", disabled: true\n  a.vm.synced_folder \"scripts/server\", \"/usr/local/scripts\", type: \"rsync\", owner: \"root\", group: \"root\"\n  a.vm.provision \"shell\", inline: &lt;&lt;-SHELL\n   chmod u+x /usr/local/scripts/server.sh\n   /usr/local/scripts/server.sh\n  SHELL\n  end\n\n config.vm.define \"desktop\" do |b|\n  b.vbguest.auto_update = false\n  b.vm.provider \"virtualbox\" do |v|\n   unless File.exist?(desktop_disk)\n    v.customize ['createhd', '--filename', desktop_disk, '--size', 20 * 1024]\n   end\n   v.customize ['storageattach', :id, '--storagectl', 'IDE Controller', '--port', 1, '--device', 0, '--type', 'hdd', '--medium', desktop_disk]\n   end\n  b.vm.network \"private_network\", ip: \"192.168.33.10\"\n  b.vm.synced_folder \".\", \"/vagrant\", disabled: true\n  b.vm.synced_folder \"scripts/desktop\", \"/usr/local/scripts\", type: \"rsync\", owner: \"root\", group: \"root\"\n  b.vm.provision \"shell\", inline: &lt;&lt;-SHELL\n   chmod u+x /usr/local/scripts/desktop.sh\n   /usr/local/scripts/desktop.sh\n  SHELL\n  end\nend\n</code></pre>\n\n<p>When I run <strong>sudo vagrant up</strong></p>\n\n<p>I get error</p>\n\n<pre><code>An error occurred in the underlying SSH library that Vagrant uses.\nThe error message is shown below. In many cases, errors from this\nlibrary are caused by ssh-agent issues. Try disabling your SSH\nagent or removing some keys and try again.\n\nIf the problem persists, please report a bug to the net-ssh project.\n\ntimeout during server version negotiating\n</code></pre>\n\n<p>I am following this <a href=\"https://github.com/frezbo/lab\" rel=\"nofollow noreferrer\">https://github.com/frezbo/lab</a> .Please do help me.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "postgresql", "master", "slave"], "owner": {"reputation": 97, "user_id": 6927514, "user_type": "registered", "profile_image": "https://graph.facebook.com/1417569534938796/picture?type=large", "display_name": "Harsimar Sandhu", "link": "https://stackoverflow.com/users/6927514/harsimar-sandhu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 128, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1536560124, "creation_date": 1536560124, "question_id": 52252050, "link": "https://stackoverflow.com/questions/52252050/split-read-to-slave-and-write-to-master-in-ar-multidb", "title": "Split read to slave and write to master in ar_multidb", "body": "<p>I am currently working in Ruby on rails I want to split connection between master-slave so that read queries go to slave and write to master I am currently using ar-multidb gem. I know it doesn't support this.</p>\n\n<p>So is there a way around of doing this without using another gem like octopus or makara. </p>\n\n<p>One way I can think of is setting my default connection to slave and putting write queries in Multidb.use(:default) block. But this is a lot of effort plus can cause code failures.</p>\n"}]