[{"tags": ["ruby", "metaprogramming"], "comments": [{"owner": {"reputation": 5004, "user_id": 327815, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/17f2e18da0338911cd6ea464ff2613d1?s=128&d=identicon&r=PG", "display_name": "Jokester", "link": "https://stackoverflow.com/users/327815/jokester"}, "edited": false, "score": 0, "creation_date": 1492647041, "post_id": 43507963, "comment_id": 74070679, "body": "<code>? :</code> does not &quot;bind&quot; to a object, so <code>send</code> is less likely to work with it. Other similar syntaxes are <code>if &#47; while &#47; begin</code> etc. In case that is needed in practice, we could use a a proxy object."}, {"owner": {"reputation": 7978, "user_id": 362583, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/00043d88daa3d0998b41008d4a914013?s=128&d=identicon&r=PG", "display_name": "Bohdan", "link": "https://stackoverflow.com/users/362583/bohdan"}, "edited": false, "score": 1, "creation_date": 1492657590, "post_id": 43507963, "comment_id": 74073263, "body": "hello have you considered eval/instance_eval?"}, {"owner": {"reputation": 578, "user_id": 2536578, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/8b4a84b3ea0d7a53d21413a4a4ca1768?s=128&d=identicon&r=PG", "display_name": "Courtland Caldwell", "link": "https://stackoverflow.com/users/2536578/courtland-caldwell"}, "reply_to_user": {"reputation": 7978, "user_id": 362583, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/00043d88daa3d0998b41008d4a914013?s=128&d=identicon&r=PG", "display_name": "Bohdan", "link": "https://stackoverflow.com/users/362583/bohdan"}, "edited": false, "score": 0, "creation_date": 1492722472, "post_id": 43507963, "comment_id": 74112606, "body": "@Bohdan yes I suppose that is the best solution."}], "answers": [{"tags": [], "owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "is_accepted": true, "score": 1, "last_activity_date": 1492662451, "creation_date": 1492662451, "answer_id": 43510201, "question_id": 43507963, "link": "https://stackoverflow.com/questions/43507963/invoke-using-send-in-ruby/43510201#43510201", "title": "Invoke `?:` using `send` in Ruby", "body": "<p>There is no way to do that. The ternary operator construction, or the <code>?</code> part of it, is not a method; as you noticed, it is a syntactic construct. Meanwhile, <code>send</code> can only handle methods.</p>\n"}], "owner": {"reputation": 578, "user_id": 2536578, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/8b4a84b3ea0d7a53d21413a4a4ca1768?s=128&d=identicon&r=PG", "display_name": "Courtland Caldwell", "link": "https://stackoverflow.com/users/2536578/courtland-caldwell"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 44, "favorite_count": 0, "accepted_answer_id": 43510201, "answer_count": 1, "score": 0, "last_activity_date": 1492662621, "creation_date": 1492646223, "last_edit_date": 1492662621, "question_id": 43507963, "link": "https://stackoverflow.com/questions/43507963/invoke-using-send-in-ruby", "title": "Invoke `?:` using `send` in Ruby", "body": "<p>Can I / how would I go about calling the ternary operator using the <code>send :name, *args, &amp;blk</code> syntax construct? I don't have a practical reason to do this, but it came up.</p>\n\n<p>Here you can see my woeful attempts:</p>\n\n<pre><code>i = 7\n\nsend \"?:\", proc { i &gt; 2 }, true, false\n# =&gt; NoMethodError: undefined method `?:' for main:Object\n\nproc { i &gt; 2 }.send \"?:\", true, false\n# =&gt; NoMethodError: undefined method `?:' for #&lt;Proc:0x00000001ef77b0@(irb):3&gt;\n\nproc { i &gt; 2 }.call.send \"?:\", true, false\n# =&gt; NoMethodError: undefined method `?:' for true:TrueClass\n</code></pre>\n"}, {"tags": ["ruby", "rubygems", "bundler"], "comments": [{"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 0, "creation_date": 1492646135, "post_id": 43507841, "comment_id": 74070459, "body": "Your question is broad. I&#39;d recommend removing the line about the other technologies and write a concise question specifically about that problem as it&#39;s a can of worms."}, {"owner": {"reputation": 21, "user_id": 7264887, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ecfb50797dcc4e87fa8b52ae494c4d8?s=128&d=identicon&r=PG&f=1", "display_name": "user7264887", "link": "https://stackoverflow.com/users/7264887/user7264887"}, "reply_to_user": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 0, "creation_date": 1492650501, "post_id": 43507841, "comment_id": 74071529, "body": "Thanks for the suggestion.  I am unsure about exactly how much context is needed for someone to offer an answer, so I just included as much as I could possibly think of."}], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 7264887, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ecfb50797dcc4e87fa8b52ae494c4d8?s=128&d=identicon&r=PG&f=1", "display_name": "user7264887", "link": "https://stackoverflow.com/users/7264887/user7264887"}, "edited": false, "score": 0, "creation_date": 1492650402, "post_id": 43507906, "comment_id": 74071503, "body": "I tried this, putting &quot;ruby &#39;2.2.4&#39;&quot; in the Gemfile, and it tells me the same error message that the docs say I would get,  &quot;Your Ruby version is 2.0.0, but your Gemfile specified 2.2.4&quot;.  It seems like the Gemfile line is being taken as a preference rather than a command.  I tried reading through more of those docs, specifically the page, and its follow-up links, you posted... if there be some way to resolve this in those docs, I can&#39;t find it."}], "tags": [], "owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "is_accepted": false, "score": 1, "last_activity_date": 1492645817, "creation_date": 1492645817, "answer_id": 43507906, "question_id": 43507841, "link": "https://stackoverflow.com/questions/43507841/how-to-control-which-version-of-ruby-gets-used-when-running-bundle/43507906#43507906", "title": "How to control which version of Ruby gets used when running bundle", "body": "<p>The <a href=\"http://bundler.io/v1.14/gemfile.html\" rel=\"nofollow noreferrer\">Bundler docs</a> spell this out:</p>\n\n<blockquote>\n  <p>You can specify the required version of Ruby in the <code>Gemfile</code> with <code>ruby</code>. If the <code>Gemfile</code> is loaded on a different Ruby version, Bundler will raise an exception with an explanation.</p>\n</blockquote>\n\n<pre><code>ruby '1.9.3'\n</code></pre>\n\n<blockquote>\n  <p>What this means is that this app has a dependency to a Ruby VM that is ABI compatible with 1.9.3. If the version check does not match, Bundler will raise an exception. This will ensure the running code matches. You can be more specific with the <code>:engine</code> and <code>:engine_version</code> options.</p>\n</blockquote>\n\n<pre><code>ruby '1.9.3', :engine =&gt; 'jruby', :engine_version =&gt; '1.6.7'\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 0, "creation_date": 1492710396, "post_id": 43509189, "comment_id": 74106144, "body": ":-) That&#39;s how we learn. And how we learn to work with SO. Once you&#39;ve gone through the cycle a couple times it starts to make sense how to define a question and all the information that&#39;s needed. I like Jon Skeet&#39;s &quot;<a href=\"https://codeblog.jonskeet.uk/2010/08/29/writing-the-perfect-question/\" rel=\"nofollow noreferrer\">Writing the perfect question</a>&quot; and &quot;<a href=\"https://blog.codinghorror.com/rubber-duck-problem-solving/\" rel=\"nofollow noreferrer\">Rubber Duck Problem Solving</a>&quot;."}], "tags": [], "owner": {"reputation": 21, "user_id": 7264887, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ecfb50797dcc4e87fa8b52ae494c4d8?s=128&d=identicon&r=PG&f=1", "display_name": "user7264887", "link": "https://stackoverflow.com/users/7264887/user7264887"}, "is_accepted": false, "score": 0, "last_activity_date": 1492655461, "creation_date": 1492655461, "answer_id": 43509189, "question_id": 43507841, "link": "https://stackoverflow.com/questions/43507841/how-to-control-which-version-of-ruby-gets-used-when-running-bundle/43509189#43509189", "title": "How to control which version of Ruby gets used when running bundle", "body": "<p>I finally figured out the exact incantation in order to get the intended result, and I now realize the situation is unreasonable to expect any stranger to attempt to answer.</p>\n\n<p>It involved <a href=\"https://www.chef.io/\" rel=\"nofollow noreferrer\">chef</a>, and I was supposed to run <code>chef exec bundle</code>.</p>\n"}], "owner": {"reputation": 21, "user_id": 7264887, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ecfb50797dcc4e87fa8b52ae494c4d8?s=128&d=identicon&r=PG&f=1", "display_name": "user7264887", "link": "https://stackoverflow.com/users/7264887/user7264887"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 41, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1492655461, "creation_date": 1492645356, "last_edit_date": 1492650514, "question_id": 43507841, "link": "https://stackoverflow.com/questions/43507841/how-to-control-which-version-of-ruby-gets-used-when-running-bundle", "title": "How to control which version of Ruby gets used when running bundle", "body": "<p>In ~/src/project/ containing all the files, I'm attempting to run <code>bundle</code> and <code>bundle install</code>, but it tells me I need a gem called \"buff-extensions\" and that gem installer requires Ruby version >= 2.2.0 to work properly.</p>\n\n<p>When I ran <code>ruby --version</code>, it said Ruby 2.2.4p230 is being used when run from that directory.</p>\n\n<p>I know there are several versions of Ruby on the machine in several places, and I'm struggling to follow the paths and figure out which technology is using which piece.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "middleman", "contentful"], "answers": [{"comments": [{"owner": {"reputation": 620, "user_id": 716161, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/991c09f40c1200f4fa8149a0a2ee7a86?s=128&d=identicon&r=PG&f=1", "display_name": "umbriel", "link": "https://stackoverflow.com/users/716161/umbriel"}, "edited": false, "score": 0, "creation_date": 1492721314, "post_id": 43507750, "comment_id": 74112113, "body": "Hi David, thanks for taking your time to help me. Do you know roughly how I would do that with hashes (from contentful)? I&#39;m not super familiar with how to do that. With arrays it&#39;s a bit easier"}, {"owner": {"reputation": 620, "user_id": 716161, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/991c09f40c1200f4fa8149a0a2ee7a86?s=128&d=identicon&r=PG&f=1", "display_name": "umbriel", "link": "https://stackoverflow.com/users/716161/umbriel"}, "edited": false, "score": 0, "creation_date": 1492723793, "post_id": 43507750, "comment_id": 74113124, "body": "The following kind of worked, but now they are getting deleted in the cache. I have to reload the page a couple of times to get the tiles to reappear. Very strange   <code>&lt;% content.reject{|key, value| key &gt;= this.id }.sort_by{ |index| rand }.each do |id, this| %&gt;       &lt;%= partial &quot;partials&#47;tile&quot; %&gt;     &lt;% end %&gt;</code>"}], "tags": [], "owner": {"reputation": 334, "user_id": 5439158, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-1iztlFARX3s/AAAAAAAAAAI/AAAAAAAABLM/iVNkWGjfUno/photo.jpg?sz=128", "display_name": "David Litvak", "link": "https://stackoverflow.com/users/5439158/david-litvak"}, "is_accepted": true, "score": 4, "last_activity_date": 1492644697, "creation_date": 1492644697, "answer_id": 43507750, "question_id": 43507578, "link": "https://stackoverflow.com/questions/43507578/rails-delete-if-using-hashes-to-ignore-current-article-middleman/43507750#43507750", "title": "rails delete_if using hashes to ignore current article (Middleman)", "body": "<p>I'm the maintainer of contentful_middleman. Looks like you could just send the <code>this</code> to the partial as local, then iterate through your content and make sure that you exclude the one that matches the id of <code>this</code>.</p>\n"}], "owner": {"reputation": 620, "user_id": 716161, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/991c09f40c1200f4fa8149a0a2ee7a86?s=128&d=identicon&r=PG&f=1", "display_name": "umbriel", "link": "https://stackoverflow.com/users/716161/umbriel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 169, "favorite_count": 0, "accepted_answer_id": 43507750, "answer_count": 1, "score": 6, "last_activity_date": 1498923967, "creation_date": 1492643582, "last_edit_date": 1498923967, "question_id": 43507578, "link": "https://stackoverflow.com/questions/43507578/rails-delete-if-using-hashes-to-ignore-current-article-middleman", "title": "rails delete_if using hashes to ignore current article (Middleman)", "body": "<p>I've got an easy one for you guys.</p>\n\n<p><strong>I want to have a featured content section where the current article is EXCLUDED</strong></p>\n\n<p>So this works using Middleman Blog with <code>delete_if</code>:</p>\n\n<pre><code>&lt;% blog(content).articles.delete_if{|item| item == current_article}.each do |article| %&gt;\n  &lt;%= article_content %&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>However I'm using Middleman proxies so I don't have access to the <code>current_article</code> method...</p>\n\n<p>I've got an YAML structure that holds the following mock data (amongst others) with the folder setup like: <strong>data > site > caseStudy > RANDOM-ID423536.yaml</strong> (Generated by a CMS)</p>\n\n<p><a href=\"https://i.stack.imgur.com/9CSR5.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/9CSR5.png\" alt=\"enter image description here\"></a></p>\n\n<p>Inside each <code>yaml</code> file you'll find stuff like: </p>\n\n<pre><code>:id: 2k1YccJrQsKE2siSO6o6ac\n:title: Heyplace\n</code></pre>\n\n<p>My <code>config.rb</code> looks like this</p>\n\n<pre><code>data.site.caseStudy.each do | id, this |\n  proxy \"/cases/#{this.slug}/index.html\", \"/cases/cases-template.html\", :locals =&gt; { this: this }, :ignore =&gt; true\nend\n</code></pre>\n\n<p>My template file holds the following</p>\n\n<pre><code>&lt;%= partial(:'partials/footer', :locals =&gt; {:content =&gt; data.site.caseStudy, :title =&gt; 'See more projects'}) %&gt;\n</code></pre>\n\n<p>My loop that gets content</p>\n\n<pre><code>&lt;% content.each do |id, this| %&gt;\n  &lt;%= partial \"partials/tile\" %&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p><strong>So I guess my question is, how can I use <code>delete_if</code> in this instance so that the current article isnt being displayed?</strong> </p>\n\n<p>I have tried stuff like, but to no avail:</p>\n\n<pre><code>&lt;% content.delete_if{|e| e.title == content.title}.each do |id, this| %&gt;\n  &lt;%= partial \"partials/tile\" %&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>Any help is appreciated! Thank you!</p>\n\n<p>Solved, ended up doing </p>\n\n<pre><code>&lt;% content.reject{ | id, item| item == this }.each do |id, this| %&gt;\n&lt;%= partial \"partials/tile\", :locals =&gt; { :this =&gt; this, :dir =&gt; \"/#{this.content_type_id.downcase}/\", :secondary =&gt; 'View' } %&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>Courtesy of @David Litvak </p>\n"}, {"tags": ["ruby", "selenium", "capybara"], "comments": [{"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 0, "creation_date": 1492643617, "post_id": 43507530, "comment_id": 74069756, "body": "We don&#39;t care if you&#39;re new to a language. We only care that you&#39;ve researched the problem and put in effort to solve the problem, then asked a concise and well-asked question. &quot;<a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a>&quot;, &quot;<a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>&quot; and their linked pages, and &quot;<a href=\"http://meta.stackoverflow.com/questions/261592\">How much research effort is expected of Stack Overflow users?</a>&quot; are useful."}], "answers": [{"tags": [], "owner": {"reputation": 42014, "user_id": 2709090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/238c2b7cde2c817fc9a5a2b8eaa2ffad?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Walpole", "link": "https://stackoverflow.com/users/2709090/thomas-walpole"}, "is_accepted": true, "score": 1, "last_activity_date": 1492646439, "creation_date": 1492646439, "answer_id": 43507996, "question_id": 43507530, "link": "https://stackoverflow.com/questions/43507530/how-to-execute-logic-only-if-an-element-is-visible/43507996#43507996", "title": "How to execute logic only if an element is visible", "body": "<p>You need to use one of the <code>has_xxx?</code> methods which return a boolean result rather than raising if it can't find - <a href=\"http://www.rubydoc.info/gems/capybara/Capybara/Node/Matchers#has_selector%3F-instance_method\" rel=\"nofollow noreferrer\">http://www.rubydoc.info/gems/capybara/Capybara/Node/Matchers#has_selector%3F-instance_method</a></p>\n\n<pre><code>def reset_filters()\n  clear_filters() if page.has_selector?(:filter_icon_button)\nend\n</code></pre>\n\n<p>Note: This will wait up to Capybara.default_max_wait_time seconds for a matching element to be visible on the page (and then return false if it never does). If you just want it to immediately decide without the possible waiting you can do</p>\n\n<pre><code>page.has_selector?(:filter_icon_button, wait: 0) # or wait: false\n</code></pre>\n"}], "owner": {"reputation": 3855, "user_id": 1318265, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/a842d45c144ed4f26c9ce500490b0a42?s=128&d=identicon&r=PG", "display_name": "Chase Sandmann", "link": "https://stackoverflow.com/users/1318265/chase-sandmann"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 110, "favorite_count": 0, "accepted_answer_id": 43507996, "answer_count": 1, "score": 0, "last_activity_date": 1492646439, "creation_date": 1492643304, "last_edit_date": 1492643487, "question_id": 43507530, "link": "https://stackoverflow.com/questions/43507530/how-to-execute-logic-only-if-an-element-is-visible", "title": "How to execute logic only if an element is visible", "body": "<p>I don't know if this is possible but I want to branch my code and only perform an action on an element if it exists in the DOM,  otherwise I want the test to continue as normal, something like this:</p>\n\n<pre><code>def reset_filters()\n  clear_filters() if find(:filter_icon_button).exists?\nend\n</code></pre>\n\n<p>Whenever I do this, the tests always fails because it can't find the selector, which is the thing I'm trying to test.  </p>\n\n<p>How can I make this work?</p>\n"}, {"tags": ["ruby", "parsing"], "answers": [{"comments": [{"owner": {"reputation": 185, "user_id": 3841384, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/aPY5J.png?s=128&g=1", "display_name": "oorahduc", "link": "https://stackoverflow.com/users/3841384/oorahduc"}, "edited": false, "score": 0, "creation_date": 1492651604, "post_id": 43508214, "comment_id": 74071826, "body": "I should have been more obvious in that I don&#39;t have direct access to the machine with ansible - only access to the github. Otherwise this would have been very clear and easy. Thanks."}], "tags": [], "owner": {"reputation": 71199, "user_id": 1301972, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/T5G7N.jpg?s=128&g=1", "display_name": "Todd A. Jacobs", "link": "https://stackoverflow.com/users/1301972/todd-a-jacobs"}, "is_accepted": false, "score": 2, "last_activity_date": 1492647996, "creation_date": 1492647996, "answer_id": 43508214, "question_id": 43507396, "link": "https://stackoverflow.com/questions/43507396/ruby-section-an-ansible-hosts-file-into-nested-array/43508214#43508214", "title": "Ruby: Section an ansible hosts file into nested array", "body": "<h2>Parse Inventory into Ruby Hash from Ansible's CLI Output</h2>\n\n<p>You can parse the output of an <a href=\"https://docs.ansible.com/ansible/intro_inventory.html\" rel=\"nofollow noreferrer\">Ansible inventory</a> as (mostly) JSON. This is actually easier and more reliable than parsing an INI-like file directly, although the Ansible CLI wraps the results you want inside a top-level <code>groups</code> value.</p>\n\n<pre><code>require 'json'\n\noutput = %x(ansible localhost -i /tmp/example.ini -m debug -a 'var=groups')\njson   = JSON.parse(output.sub /^.*=&gt;/, '')\n\njson['groups']\n#=&gt; {\"all\"=&gt;[\"host1\", \"host2\", \"host3\", \"host4\"], \"group1\"=&gt;[\"host1\", \"host2\"], \"group2\"=&gt;[\"host3\", \"host4\"], \"ungrouped\"=&gt;[\"localhost\"]}\n\njson['groups']['group1']\n#=&gt; [\"host1\", \"host2\"]\n\n# Use Hash#dig on recent Rubies to simplify lookups.\njson.dig 'groups', 'group2'\n#=&gt; [\"host3\", \"host4\"]\n</code></pre>\n\n<p>If you <em>really</em> need just the groups that start with the string <code>group</code>, you can extract them dynamically. For example:</p>\n\n<pre><code>json['groups'].keys.select { |k| k.start_with? 'group' }.map do |key|\n  { key =&gt; json['groups'][key] }\nend.reduce({}, :merge)\n#=&gt; {\"group1\"=&gt;[\"host1\", \"host2\"], \"group2\"=&gt;[\"host3\", \"host4\"]}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 185, "user_id": 3841384, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/aPY5J.png?s=128&g=1", "display_name": "oorahduc", "link": "https://stackoverflow.com/users/3841384/oorahduc"}, "edited": false, "score": 1, "creation_date": 1492651658, "post_id": 43508297, "comment_id": 74071839, "body": "This worked perfectly. The key bit that I was missing was the /^&#91;.*?(?:\\n\\n|\\z)/m regex. Thanks, mate."}], "tags": [], "owner": {"reputation": 71199, "user_id": 1301972, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/T5G7N.jpg?s=128&g=1", "display_name": "Todd A. Jacobs", "link": "https://stackoverflow.com/users/1301972/todd-a-jacobs"}, "is_accepted": true, "score": 3, "last_activity_date": 1492651814, "last_edit_date": 1492651814, "creation_date": 1492648582, "answer_id": 43508297, "question_id": 43507396, "link": "https://stackoverflow.com/questions/43507396/ruby-section-an-ansible-hosts-file-into-nested-array/43508297#43508297", "title": "Ruby: Section an ansible hosts file into nested array", "body": "<h2>Direct INI Parse</h2>\n\n<p>If you don't want to do a full parse, you can treat your corpus as an INI file with sections. Such files can be tricky and have numerous edge cases, especially if you can't rigorously define how sections are separated. However, the following will work with your specific corpus.</p>\n\n<pre><code># Read the file.\nini = File.read '/tmp/example.ini'\n\n# Split the file into sections. Assumes only one blank line between\n# sections.\nsections = ini.scan /^\\[.*?(?:\\n\\n|\\z)/m\n\n# Return an array of hashes, then merge them. Use the first element\n# from each split as the hash key.\nhash = sections.map do |section| \n  array = section.split\n  key   = array.shift.delete '[]'\n  { key =&gt; array }\nend.reduce({}, :merge)\n\n#=&gt; {\"group1\"=&gt;[\"host1\", \"host2\"], \"group2\"=&gt;[\"host3\", \"host4\"]}\n</code></pre>\n\n<p>There are all kinds of ways this can fail on a more complex INI-like file, so you may need to do a more comprehensive parse of your file if you go this route. Alternatively, you can just save the result as a file, and then <a href=\"https://stackoverflow.com/a/43508214/1301972\">parse the inventory into a Ruby hash using the Ansible CLI</a>.</p>\n"}, {"tags": [], "owner": {"reputation": 61, "user_id": 4620054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c46111fc308726ea928be364c4587b82?s=128&d=identicon&r=PG", "display_name": "Timothy Kovalev", "link": "https://stackoverflow.com/users/4620054/timothy-kovalev"}, "is_accepted": false, "score": 1, "last_activity_date": 1583864747, "creation_date": 1583864747, "answer_id": 60623775, "question_id": 43507396, "link": "https://stackoverflow.com/questions/43507396/ruby-section-an-ansible-hosts-file-into-nested-array/60623775#60623775", "title": "Ruby: Section an ansible hosts file into nested array", "body": "<p>There is an <a href=\"https://docs.ansible.com/ansible/2.4/ansible-inventory.html\" rel=\"nofollow noreferrer\"><code>ansible-inventory</code></a> command. An example for</p>\n\n<pre class=\"lang-sh prettyprint-override\"><code>ansible-inventory  -i path/to/inventory --export --list\n</code></pre>\n\n<p>An example result is like</p>\n\n<pre><code>{\n    \"all\": {\n        \"children\": [\n            \"db\",\n            \"ungrouped\",\n            \"web\"\n        ]\n    },\n    \"db\": {\n        \"hosts\": [\n            \"demo_db\"\n        ]\n    },\n    \"web\": {\n        \"hosts\": [\n            \"demo_app\"\n        ]\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 185, "user_id": 3841384, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/aPY5J.png?s=128&g=1", "display_name": "oorahduc", "link": "https://stackoverflow.com/users/3841384/oorahduc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 356, "favorite_count": 1, "accepted_answer_id": 43508297, "answer_count": 3, "score": 2, "last_activity_date": 1583864747, "creation_date": 1492642408, "question_id": 43507396, "link": "https://stackoverflow.com/questions/43507396/ruby-section-an-ansible-hosts-file-into-nested-array", "title": "Ruby: Section an ansible hosts file into nested array", "body": "<p>I'm retrieving an ansible hosts file via http.get which looks like this:</p>\n\n<pre><code>[group1]\nhost1\nhost2\n\n[group2]\nhost3\nhost4\n</code></pre>\n\n<p>How do I iterate beginning at each group, and collapse the following lines until the next group into a nested hash like this?</p>\n\n<pre><code>{ \"group1\" =&gt; [\"host1\", \"1host2\"], \"group2\" =&gt; [\"host3\", \"host4\"] }\n</code></pre>\n"}, {"tags": ["ruby", "decimal", "number-formatting", "pretty-print"], "answers": [{"tags": [], "owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "is_accepted": false, "score": 2, "last_activity_date": 1492642052, "last_edit_date": 1492642052, "creation_date": 1492641353, "answer_id": 43507226, "question_id": 43506799, "link": "https://stackoverflow.com/questions/43506799/how-to-pretty-print-decimal-format/43507226#43507226", "title": "How to pretty-print decimal format", "body": "<p>When you use <code>to_d</code> or <code>to_f</code> you're telling Ruby to convert the value to a BigDouble or Float, but that doesn't specify output format, which is a different problem.</p>\n\n<p>Ruby supports string formatting in a couple flavors, but generally you define a format that is then used to \"pretty-print\" the output:</p>\n\n<pre><code>foo = 0.4e1\n'%1.1f' % foo # =&gt; \"4.0\"\n</code></pre>\n\n<p>Note that the output is a string, not a Float or BigDecimal. Everything is converted to a String before being output to the console. Ruby's format strings follow the <code>sprintf</code> format strings used by C, Perl and many other languages. See <a href=\"https://ruby-doc.org/core-2.4.1/Kernel.html#method-i-sprintf\" rel=\"nofollow noreferrer\"><code>sprintf</code></a> for more information.</p>\n\n<p>And, while <code>sprintf</code> exists, I rarely see it used. Instead String's <a href=\"https://ruby-doc.org/core-2.4.1/String.html#method-i-25\" rel=\"nofollow noreferrer\"><code>%</code></a> method is used more often, followed by Kernel's <a href=\"https://ruby-doc.org/core-2.4.1/Kernel.html#method-i-format\" rel=\"nofollow noreferrer\"><code>format</code></a> method.</p>\n\n<p>Also note that <code>10.to_d / 2.5</code> is invalid because <code>10</code> is an Integer, and Integer doesn't know how to <code>to_d</code>:</p>\n\n<pre><code>10.class # =&gt; Integer\n10.respond_to?(:to_d) # =&gt; false\n10.to_d / 2.5    # =&gt; NoMethodError: undefined method `to_d' for 10:Integer\n</code></pre>\n\n<p>Requiring BigDecimal is necessary to get <code>to_d</code>:</p>\n\n<pre><code>require 'bigdecimal'\nrequire 'bigdecimal/util'\n\n10.to_d / 2.5    # =&gt; 0.4e1\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 45322, "user_id": 421705, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/581b1760881c962648f99d6040d41829?s=128&d=identicon&r=PG", "display_name": "Holger Just", "link": "https://stackoverflow.com/users/421705/holger-just"}, "is_accepted": false, "score": 1, "last_activity_date": 1492641384, "creation_date": 1492641384, "answer_id": 43507228, "question_id": 43506799, "link": "https://stackoverflow.com/questions/43506799/how-to-pretty-print-decimal-format/43507228#43507228", "title": "How to pretty-print decimal format", "body": "<p>In Ruby 2.4, <code>BigDecimal#inspect</code> is equivalent to <code>BigDecimal#to_s</code> which always defaults to use the scientific notation.</p>\n\n<pre><code>decimal = 10.to_d / 2.5\ndecimal.inspect\n# =&gt; \"0.4e1\"\n\n# equivalent to\ndecimal.to_s\n# =&gt; \"0.4e1\"\n</code></pre>\n\n<p>Fortunately, the class accepts an argument to its <code>to_s</code> method which allows you to specify the format of the resulting string. Among other options, you can specify if you want the scientific notation or the conventional floating point notation. Thus, by using it as follows, you can get your desired result:</p>\n\n<pre><code>decimal.to_s(\"F\")\n# =&gt; \"4.0\"\n</code></pre>\n\n<p><a href=\"https://ruby-doc.org/stdlib/libdoc/bigdecimal/rdoc/BigDecimal.html#method-i-to_s\" rel=\"nofollow noreferrer\">The documentation of BigDecimal#to_s</a> goes into detail how you can set further formatting options.</p>\n\n<p>Unfortunately for your apparent use-case, there is no way in Ruby to change the default format. In order to get the floating point notation, you always have to explicitly add the <code>\"F\"</code> argument to the <code>to_s</code> method.</p>\n"}, {"comments": [{"owner": {"reputation": 16877, "user_id": 136819, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/ad09fdcf485291f372a3811f5c2fb61e?s=128&d=identicon&r=PG", "display_name": "Zyphrax", "link": "https://stackoverflow.com/users/136819/zyphrax"}, "edited": false, "score": 1, "creation_date": 1492646714, "post_id": 43507319, "comment_id": 74070594, "body": "Thank you, exactly what I was looking for!"}], "tags": [], "owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "is_accepted": true, "score": 4, "last_activity_date": 1492641968, "creation_date": 1492641968, "answer_id": 43507319, "question_id": 43506799, "link": "https://stackoverflow.com/questions/43506799/how-to-pretty-print-decimal-format/43507319#43507319", "title": "How to pretty-print decimal format", "body": "<p>You could monkey-patch the method the pretty-printer uses. \"Normal\" IRb uses <code>inspect</code>, but most of the pretty-printer libraries have their own methods.</p>\n\n<p>For example, the <a href=\"https://ruby-doc.org/stdlib/libdoc/pp/rdoc/index.html\" rel=\"nofollow noreferrer\"><code>pp</code> library</a> from the standard library uses a method called <code>pretty_print</code>. <code>BigDecimal</code> doesn't have its own implementation of <code>pretty_print</code> unfortunately, it simply inherits the one from <code>Numeric</code> which just delegates to <code>inspect</code>.</p>\n\n<p>So, we can write our own!</p>\n\n<pre><code>class BigDecimal\n  def pretty_print(pp)\n    pp.text to_s('F')\n  end\nend\n\npp 10.to_d / 2.5\n# 4.0\n</code></pre>\n"}], "owner": {"reputation": 16877, "user_id": 136819, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/ad09fdcf485291f372a3811f5c2fb61e?s=128&d=identicon&r=PG", "display_name": "Zyphrax", "link": "https://stackoverflow.com/users/136819/zyphrax"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1450, "favorite_count": 0, "accepted_answer_id": 43507319, "answer_count": 3, "score": 2, "last_activity_date": 1492642052, "creation_date": 1492639184, "last_edit_date": 1492640852, "question_id": 43506799, "link": "https://stackoverflow.com/questions/43506799/how-to-pretty-print-decimal-format", "title": "How to pretty-print decimal format", "body": "<p>Is there a way to change the default format of decimals when I pretty-print them?</p>\n\n<pre><code>irb(main):521:0&gt; pp 10.to_d / 2.5   \n0.4e1\n</code></pre>\n\n<p>I would like to format it as:</p>\n\n<pre><code>irb(main):521:0&gt; pp 10.to_d / 2.5   \n4.0\n</code></pre>\n\n<p>I don't really care about potential precision loss. The default format is especially annoying to read when you're pretty-printing Rails records:</p>\n\n<pre><code>&lt;\n  ...  \n  id: 49391,  \n  operator_id: 1,  \n  tax_rate: 0.10e2,  \n  sales_price: 0.1e2,  \n  unit_price: 0.2e1,  \n  &gt;\n</code></pre>\n\n<p>I know that I can do <code>to_s</code> or <code>to_f</code>, etc., but the whole point of pretty-print is that I don't have to convert my records before I can have a quick glance at them.</p>\n"}, {"tags": ["arrays", "ruby"], "comments": [{"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 0, "creation_date": 1492642567, "post_id": 43506682, "comment_id": 74069427, "body": "It&#39;s important to use proper Ruby syntax when asking a question about code you&#39;ve written. <code>Stack_{tower_select}[-1]</code> isn&#39;t valid and results in &quot;NoMethodError: undefined method `Stack_&#39; for main:Object&quot;. See &quot;<a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>&quot; and the linked page."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 7892292, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/953508273faa519eb55b88e1f106bab8?s=128&d=identicon&r=PG&f=1", "display_name": "dande313", "link": "https://stackoverflow.com/users/7892292/dande313"}, "edited": false, "score": 0, "creation_date": 1492788541, "post_id": 43506987, "comment_id": 74145220, "body": "Genius! Thank you so much!"}], "tags": [], "owner": {"reputation": 73209, "user_id": 290394, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/d7908f05c89e965f6bc5308ad6f41256?s=128&d=identicon&r=PG", "display_name": "steenslag", "link": "https://stackoverflow.com/users/290394/steenslag"}, "is_accepted": false, "score": 1, "last_activity_date": 1492641108, "last_edit_date": 1492641108, "creation_date": 1492640077, "answer_id": 43506987, "question_id": 43506682, "link": "https://stackoverflow.com/questions/43506682/using-input-to-determine-which-array-to-call/43506987#43506987", "title": "Using input to determine which array to call", "body": "<p>Put your stacks in an Array or Hash and everything gets easier. This uses a Hash (they look scary at first, but are a breeze to handle):</p>\n\n<pre><code>stacks = {1 =&gt; [5,4,3],\n          2 =&gt; [5,2,1],\n          3 =&gt; [5]}  # a Hash\n\n puts \"Please select a tower\" \n tower_select = gets.chomp.to_i\n puts \"Please select where you'd like to move\" \n tower_move = gets.chomp.to_i\n\n if stacks[tower_select][-1] &lt; stacks[tower_move][-1]   \n   stacks[tower_move] &lt;&lt; stacks[tower_select][-1]   \n   stacks[tower_select].delete_at(-1)\n   #or just: stacks[tower_move] &lt;&lt; stacks[tower_select].pop \n else puts \"ERROR: Invalid move\"\n end\n\np stacks\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1, "user_id": 7892292, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/953508273faa519eb55b88e1f106bab8?s=128&d=identicon&r=PG&f=1", "display_name": "dande313", "link": "https://stackoverflow.com/users/7892292/dande313"}, "edited": false, "score": 0, "creation_date": 1492788564, "post_id": 43507649, "comment_id": 74145245, "body": "Brilliant! Thank you so much for your help!"}], "tags": [], "owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "is_accepted": false, "score": 1, "last_activity_date": 1492643953, "creation_date": 1492643953, "answer_id": 43507649, "question_id": 43506682, "link": "https://stackoverflow.com/questions/43506682/using-input-to-determine-which-array-to-call/43507649#43507649", "title": "Using input to determine which array to call", "body": "<p>Yes, it <em>is</em> possible using Ruby's reflection methods:</p>\n\n<pre><code> if const_get(:\"Stack_#{tower_select}\")[-1] &lt; const_get(:\"Stack_#{tower_move}\")[-1]   \n   const_get(:\"Stack_#{tower_move}\") &lt;&lt; const_get(:\"Stack_#{tower_select}\")[-1]   \n   const_get(:\"Stack_#{tower_select}\").delete_at(-1) \n else\n   puts 'ERROR: Invalid move'\n end\n</code></pre>\n\n<p>But you <em>do not want to do this</em>. Seriously. Don't. Just \u2026 don't.</p>\n\n<p><em>Whenever</em> you feel the need to have variables (or in this case constants, but it doesn't matter) named like <code>foo_1</code>, <code>foo_2</code>, etc. there is a better solution. You know, Ruby already has a data structure that you can put things into that you want to access by index. They are called arrays, and you already know about them since you actually use them in your code already:</p>\n\n<pre><code>stacks = [[5, 4, 3], [5, 2, 1], [5]]\n\nputs 'Please select a tower'\ntower_select = gets.to_i - 1 # somehow, \"normal\" humans count from 1 \u2026\nputs \"Please select where you'd like to move\" \ntower_move = gets.to_i - 1\n\nif stacks[tower_select].last &lt; stacks[tower_move].last   \n  stacks[tower_move] &lt;&lt; stacks[tower_select].pop   \nelse\n  puts 'ERROR: Invalid move'\nend\n</code></pre>\n\n<p>[You might notice a couple of additional fixes I put in there. Your code wasn't wrong, but this is more idiomatic.]</p>\n"}], "owner": {"reputation": 1, "user_id": 7892292, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/953508273faa519eb55b88e1f106bab8?s=128&d=identicon&r=PG&f=1", "display_name": "dande313", "link": "https://stackoverflow.com/users/7892292/dande313"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 32, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1492643953, "creation_date": 1492638618, "last_edit_date": 1492638880, "question_id": 43506682, "link": "https://stackoverflow.com/questions/43506682/using-input-to-determine-which-array-to-call", "title": "Using input to determine which array to call", "body": "<p>I'm still getting the basics of Ruby, and just completed an assignment to recreate the Tower of Hanoi. I would REALLY like to condense my code, but for that, I would need to call upon a specific array based on the users input. For example:</p>\n\n<pre><code> Stack_1=[5,4,3] \n Stack_2=[5,2,1] \n Stack_3=[5]\n\n puts \"Please select a tower\" \n tower_select=gets.chomp.to_i\n puts \"Please select where you'd like to move\" \n tower_move=gets.chomp.to_i\n\n if Stack_{tower_select}[-1] &lt; Stack_{tower_move}[-1]   \n   Stack_{tower_move} &lt;&lt; Stack_{tower_select}[-1]   \n   Stack_{tower_select}.delete_at(-1) \n else puts \"ERROR: Invalid move\"\n end\n</code></pre>\n\n<p>Is this possible? </p>\n"}, {"tags": ["ruby-on-rails", "ruby", "command-line-interface"], "comments": [{"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 0, "creation_date": 1492642728, "post_id": 43506676, "comment_id": 74069483, "body": "Please use proper capitalization and grammar when asking. SO isn&#39;t a discussion list where anything goes, it&#39;s an online reference book where grammar counts."}, {"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 0, "creation_date": 1492643088, "post_id": 43506676, "comment_id": 74069596, "body": "Do you want to determine if an email address is valid according to the RFC rules, or only whether it&#39;s a deliverable address? The first takes a very non-trivial pattern. The second is best done by trying to send an email to that address requesting a response. <a href=\"http://stackoverflow.com/a/201378/128421\">stackoverflow.com/a/201378/128421</a> will help."}], "answers": [{"comments": [{"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 0, "creation_date": 1492642948, "post_id": 43506772, "comment_id": 74069555, "body": "Regular expressions this simple won&#39;t begin to handle the full range of valid Email addresses."}, {"owner": {"reputation": 171, "user_id": 6781533, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-15wtcU_pJAA/AAAAAAAAAAI/AAAAAAAABpc/Xoq4Mr9HvRE/photo.jpg?sz=128", "display_name": "Carter Brainerd", "link": "https://stackoverflow.com/users/6781533/carter-brainerd"}, "reply_to_user": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 0, "creation_date": 1492643022, "post_id": 43506772, "comment_id": 74069579, "body": "Yes I know, was just using it as an example. He could go so far as to check the email addresses in MX records."}], "tags": [], "owner": {"reputation": 171, "user_id": 6781533, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-15wtcU_pJAA/AAAAAAAAAAI/AAAAAAAABpc/Xoq4Mr9HvRE/photo.jpg?sz=128", "display_name": "Carter Brainerd", "link": "https://stackoverflow.com/users/6781533/carter-brainerd"}, "is_accepted": false, "score": 0, "last_activity_date": 1492639037, "creation_date": 1492639037, "answer_id": 43506772, "question_id": 43506676, "link": "https://stackoverflow.com/questions/43506676/how-to-handle-a-cli-error/43506772#43506772", "title": "How to handle a CLI error", "body": "<p>You can do this with <a href=\"https://ruby-doc.org/core-2.2.0/Regexp.html\" rel=\"nofollow noreferrer\">Regular Expressions</a>. </p>\n\n<p>To validate whether the email is a valid one or not, you can use regex like so:</p>\n\n\n\n<pre><code>def validate_email\n  VALID_EMAIL_REGEX = /\\A[\\w+\\-.]+@[a-z\\d\\-]+(\\.[a-z\\d\\-]+)*\\.[a-z]+\\z/i\n  if email =~ VALID_EMAIL_REGEX\n    # Do someting here\n  else\n    validate_email\n  end\nend\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 199, "user_id": 7853452, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-spCZZ8oWRRU/AAAAAAAAAAI/AAAAAAAAAiQ/BiYJ549C63A/photo.jpg?sz=128", "display_name": "Dori Aviram", "link": "https://stackoverflow.com/users/7853452/dori-aviram"}, "is_accepted": false, "score": 0, "last_activity_date": 1492639399, "creation_date": 1492639399, "answer_id": 43506845, "question_id": 43506676, "link": "https://stackoverflow.com/questions/43506676/how-to-handle-a-cli-error/43506845#43506845", "title": "How to handle a CLI error", "body": "<p>You can enter this code into <code>until</code> loop</p>\n\n<pre><code>p 'Enter email value'\nparams[:email] = gets.chomp\nuntil email invalid do\n        p 'Enter email value'\n        params[:email] = gets.chomp\nend\n</code></pre>\n\n<p>Read more at: <a href=\"https://www.tutorialspoint.com/ruby/ruby_loops.htm\" rel=\"nofollow noreferrer\">https://www.tutorialspoint.com/ruby/ruby_loops.htm</a></p>\n"}], "owner": {"reputation": 1241, "user_id": 4402478, "user_type": "registered", "accept_rate": 32, "profile_image": "https://www.gravatar.com/avatar/6db20762ebe145c59b6e10eb68955678?s=128&d=identicon&r=PG&f=1", "display_name": "user", "link": "https://stackoverflow.com/users/4402478/user"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 22, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1492642883, "creation_date": 1492638585, "last_edit_date": 1492642883, "question_id": 43506676, "link": "https://stackoverflow.com/questions/43506676/how-to-handle-a-cli-error", "title": "How to handle a CLI error", "body": "<p>I have a simple CLI, something like:</p>\n\n<pre><code>p 'Enter email value'\nparams[:email] = gets.chomp\n</code></pre>\n\n<p>and I want to handle email validation and if the email is invalid then rerun the previous prompt.</p>\n\n<p>I have method for validating email, that simply returns true or false, something like:</p>\n\n<pre><code>p 'Enter email value'\nparams[:email] = gets.chomp\nif email invalid\n  'error- invalid email'\n</code></pre>\n\n<p>and again run </p>\n\n<pre><code>p 'Enter email value'\nparams[:email] = gets.chomp\n</code></pre>\n\n<p>How can I do it?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "cron", "scheduled-tasks", "rails-activejob"], "comments": [{"owner": {"reputation": 1704, "user_id": 3076240, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7aecba75e7673597442c574d786cec2f?s=128&d=identicon&r=PG&f=1", "display_name": "Jon", "link": "https://stackoverflow.com/users/3076240/jon"}, "edited": false, "score": 0, "creation_date": 1492644982, "post_id": 43506632, "comment_id": 74070179, "body": "Up voted because a rails only way to do this would be nice.  Personally I have used cron jobs to run rails scripts."}, {"owner": {"reputation": 1843, "user_id": 4067720, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a52c645614505bcaeb65a6c5199158c1?s=128&d=identicon&r=PG", "display_name": "Glyoko", "link": "https://stackoverflow.com/users/4067720/glyoko"}, "edited": false, "score": 0, "creation_date": 1492715764, "post_id": 43506632, "comment_id": 74109176, "body": "Just to clarify something about external gems vs ActiveJob: AJ provides a <i>common interface</i> to various queue adapters making it so the same code using, say, Resque, can be easily switched over to say, Sidekiq. You don&#39;t really get much benefit from AJ <i>without</i> using some tool outside of rails core, however."}, {"owner": {"reputation": 1280, "user_id": 3554338, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/c022fa34c942d95cc255e80cd73f9753?s=128&d=identicon&r=PG&f=1", "display_name": "Aparichith", "link": "https://stackoverflow.com/users/3554338/aparichith"}, "edited": false, "score": 0, "creation_date": 1542274312, "post_id": 43506632, "comment_id": 93512692, "body": "Did anyone tried  <a href=\"https://guides.rubyonrails.org/active_job_basics.html\" rel=\"nofollow noreferrer\">active_job</a> ?"}], "answers": [{"comments": [{"owner": {"reputation": 134, "user_id": 5959809, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/tfdOs.jpg?s=128&g=1", "display_name": "F404", "link": "https://stackoverflow.com/users/5959809/f404"}, "edited": false, "score": 0, "creation_date": 1492725522, "post_id": 43511152, "comment_id": 74113761, "body": "Thank you for your answer. As both answers have confirmed, there is no built-in scheduler on Rails."}, {"owner": {"reputation": 223, "user_id": 2983135, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39844e7354bb5fef03ccbaa6b68ac3e2?s=128&d=identicon&r=PG", "display_name": "nitanshu verma", "link": "https://stackoverflow.com/users/2983135/nitanshu-verma"}, "reply_to_user": {"reputation": 134, "user_id": 5959809, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/tfdOs.jpg?s=128&g=1", "display_name": "F404", "link": "https://stackoverflow.com/users/5959809/f404"}, "edited": false, "score": 0, "creation_date": 1493017123, "post_id": 43511152, "comment_id": 74212421, "body": "No, It&#39;s not that ActiveJob provides you every bit of redis and sidekiq but it is the core of rails you&#39;ll have to first go through the documentation then you&#39;ll be able to handle this but redis and sidekiq will give you much better understanding of this also with ui."}], "tags": [], "owner": {"reputation": 223, "user_id": 2983135, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39844e7354bb5fef03ccbaa6b68ac3e2?s=128&d=identicon&r=PG", "display_name": "nitanshu verma", "link": "https://stackoverflow.com/users/2983135/nitanshu-verma"}, "is_accepted": false, "score": 1, "last_activity_date": 1492667178, "creation_date": 1492667178, "answer_id": 43511152, "question_id": 43506632, "link": "https://stackoverflow.com/questions/43506632/schedule-an-activejob-in-rails/43511152#43511152", "title": "Schedule an ActiveJob in Rails", "body": "<p>I think you should go for <strong>sidekiq</strong> using <strong>redis</strong> write a task to schedule a job, to do so just install these two gem and can go for their documentation:</p>\n\n<pre><code>gem 'redis-rails'\n</code></pre>\n\n<p>then install sidekiq</p>\n\n<pre><code>gem 'sidekiq'\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1843, "user_id": 4067720, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a52c645614505bcaeb65a6c5199158c1?s=128&d=identicon&r=PG", "display_name": "Glyoko", "link": "https://stackoverflow.com/users/4067720/glyoko"}, "edited": false, "score": 0, "creation_date": 1492715866, "post_id": 43527955, "comment_id": 74109228, "body": "To be clear, although this uses cron syntax, it does not go through cron. It works entirely within Redis/Resque."}, {"owner": {"reputation": 134, "user_id": 5959809, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/tfdOs.jpg?s=128&g=1", "display_name": "F404", "link": "https://stackoverflow.com/users/5959809/f404"}, "edited": false, "score": 0, "creation_date": 1492725431, "post_id": 43527955, "comment_id": 74113729, "body": "Thanks for the explanation and the links. I need to investigate which is the role of Redis in the job scheduler process as both answers have suggested use external gem + Redis. But this will be a good topic for another question. Anyway, I probably use Resque."}], "tags": [], "owner": {"reputation": 1843, "user_id": 4067720, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a52c645614505bcaeb65a6c5199158c1?s=128&d=identicon&r=PG", "display_name": "Glyoko", "link": "https://stackoverflow.com/users/4067720/glyoko"}, "is_accepted": false, "score": 1, "last_activity_date": 1492715404, "creation_date": 1492715404, "answer_id": 43527955, "question_id": 43506632, "link": "https://stackoverflow.com/questions/43506632/schedule-an-activejob-in-rails/43527955#43527955", "title": "Schedule an ActiveJob in Rails", "body": "<p>Most of the major AJ adapters have some functionality for scheduling jobs, but some have that functionality separated into separate gems. For Resque for example, there's a separate <a href=\"https://github.com/resque/resque-scheduler\" rel=\"nofollow noreferrer\">resque-scheduler</a> gem that works alongside the vanilla Resque gem for exactly this.</p>\n\n<p>And <a href=\"https://github.com/resque/resque-scheduler#scheduled-jobs-recurring-jobs\" rel=\"nofollow noreferrer\">here's</a> the bit about recurring jobs. After some basic setup, you create a schedule.yml file defining how/when you want your job to run, e.g.</p>\n\n<pre><code># config/initializers/resque_scheduler.rb\nResque.schedule = YAML.load_file('../calendar.yml')\n\n# config/calendar.yml\nyour_recurring_job:\n  cron: \"0 0 * * *\" # Every day at midnight\n  class: \"YourJobClass\"\n  queue: your_queue\n  args:\n  description: \"This job does a thing, daily\"\n</code></pre>\n\n<p>I don't know about every adapter, but the major ones usually have similar sister gems that provide this functionality.</p>\n"}, {"comments": [{"owner": {"reputation": 134, "user_id": 5959809, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/tfdOs.jpg?s=128&g=1", "display_name": "F404", "link": "https://stackoverflow.com/users/5959809/f404"}, "edited": false, "score": 1, "creation_date": 1492728208, "post_id": 43530981, "comment_id": 74114755, "body": "Nice approach!  Your approach will allow me to execute the job once a day without using an external gem, but how to run it initially?"}, {"owner": {"reputation": 19544, "user_id": 317989, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/2cc8d0c8db8ad0ff2ed65ff3f5a56dd6?s=128&d=identicon&r=PG", "display_name": "house9", "link": "https://stackoverflow.com/users/317989/house9"}, "reply_to_user": {"reputation": 134, "user_id": 5959809, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/tfdOs.jpg?s=128&g=1", "display_name": "F404", "link": "https://stackoverflow.com/users/5959809/f404"}, "edited": false, "score": 0, "creation_date": 1492739951, "post_id": 43530981, "comment_id": 74117728, "body": "just enqueue it the first time from rails console <code>bundle exec rails console</code> - <code>WeatherJob.perform_later</code> will cause it to run immediately which will enqueue the record to run again 24 hours later"}], "tags": [], "owner": {"reputation": 19544, "user_id": 317989, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/2cc8d0c8db8ad0ff2ed65ff3f5a56dd6?s=128&d=identicon&r=PG", "display_name": "house9", "link": "https://stackoverflow.com/users/317989/house9"}, "is_accepted": true, "score": 3, "last_activity_date": 1492727421, "creation_date": 1492727421, "answer_id": 43530981, "question_id": 43506632, "link": "https://stackoverflow.com/questions/43506632/schedule-an-activejob-in-rails/43530981#43530981", "title": "Schedule an ActiveJob in Rails", "body": "<p>This is not real scheduling, but you can fake it in certain situations if you don't need the scheduling to be totally accurate, i.e. in your case run the job once a day:</p>\n\n<pre><code>class WeatherJob &lt; ApplicationJob\n  def perform\n    reschedule_job\n\n    do_work\n  end\n\n  def do_work\n    # ...\n  end\n\n  def reschedule_job\n    self.class.set(wait: 24.hours).perform_later\n  end\nend\n</code></pre>\n\n<p>enqueuing jobs to run in the future using ActiveJob should work with DelayedJob or Sidekiq, might not be supported in all active job backends?</p>\n"}], "owner": {"reputation": 134, "user_id": 5959809, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/tfdOs.jpg?s=128&g=1", "display_name": "F404", "link": "https://stackoverflow.com/users/5959809/f404"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2973, "favorite_count": 0, "accepted_answer_id": 43530981, "answer_count": 3, "score": 5, "last_activity_date": 1492728681, "creation_date": 1492638372, "last_edit_date": 1492728681, "question_id": 43506632, "link": "https://stackoverflow.com/questions/43506632/schedule-an-activejob-in-rails", "title": "Schedule an ActiveJob in Rails", "body": "<p>I'm doing a weather API which will get, process and save data from another API. In order to get the daily updates (request URL info, get the JSON/XML data, construct my data and save it to my database) I think the most proper way is to use an ActiveJob. </p>\n\n<p>I want to schedule the job to run periodically. I would like something like UNIX cron or Spring @Scheduled annotation for Java.</p>\n\n<p>I have seen another questions on Stack Overflow(<a href=\"https://stackoverflow.com/questions/40994581/rails-5-scheduler-to-update-database-once-a-day\">this one</a>) about scheduling jobs but they use external gems like whenever. I have been looking for a backend that allows to execute the job in the Rails API (<a href=\"http://edgeapi.rubyonrails.org/classes/ActiveJob/QueueAdapters.html\" rel=\"nofollow noreferrer\">Backends</a>), but it seems that none of the available allows scheduling a job. </p>\n\n<p>Is there anything on the Rails framework (version 5) that allows me to do what I'm trying to? Or I must use an external gem? </p>\n\n<p>Thank you so much.</p>\n\n<p>Edit\n If is useful for anyone, here is the schema for the job:</p>\n\n<pre><code>class ImportDailyDataJob &lt; ApplicationJob\n  queue_as :default\n\n  def perform(*args)\n    # Do something later\n  end\n\n  private\n\n  def prepare_request\n    # return the request object\n  end\n\n  def request_data\n    # Get the data from external API.\n  end\n\n  def process_data\n    # Process the data\n  end\n\n  def save_processed_data\n    # Saves the data to the database\n  end\nend\n</code></pre>\n"}, {"tags": ["ruby", "sinatra"], "answers": [{"tags": [], "owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "is_accepted": true, "score": 1, "last_activity_date": 1492636547, "creation_date": 1492636547, "answer_id": 43506207, "question_id": 43505824, "link": "https://stackoverflow.com/questions/43505824/how-to-return-a-json-response-from-a-before-block/43506207#43506207", "title": "How to return a JSON response from a before block", "body": "<p>I would consider using <a href=\"http://www.rubydoc.info/github/sinatra/sinatra/Sinatra%2FBase%3Ahalt\" rel=\"nofollow noreferrer\"><code>halt</code></a>:</p>\n\n<pre><code>before do\n  unless APIHelper.valid_key?(params[:key])\n    halt 404, { 'Content-Type' =&gt; 'application/json' }, \n              { error: 'Error, invalid API key' }.to_json\n  end\nend\n\nget '/test' do\n  json status: 200, body: 'just a test'\nend\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 23, "user_id": 7662258, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uCgOL.png?s=128&g=1", "display_name": "Daniel Bober", "link": "https://stackoverflow.com/users/7662258/daniel-bober"}, "is_accepted": false, "score": 0, "last_activity_date": 1492636598, "creation_date": 1492636598, "answer_id": 43506215, "question_id": 43505824, "link": "https://stackoverflow.com/questions/43505824/how-to-return-a-json-response-from-a-before-block/43506215#43506215", "title": "How to return a JSON response from a before block", "body": "<p>You can use <code>halt</code> method to return response with specific code, body and headers. So it looks like this:\n<code>\nbefore do\n  halt 401, {'Content-Type' =&gt; 'application/json'}, '{\"Message\": \"...\"}'\nend\n</code>\nIt looks sloppy so you can just redirect to another url, that provide some service</p>\n"}], "owner": {"reputation": 880, "user_id": 5279080, "user_type": "registered", "accept_rate": 68, "profile_image": "https://lh5.googleusercontent.com/-LoDm6XYbQug/AAAAAAAAAAI/AAAAAAAAABE/t33anFH2T3I/photo.jpg?sz=128", "display_name": "alilland", "link": "https://stackoverflow.com/users/5279080/alilland"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 808, "favorite_count": 0, "accepted_answer_id": 43506207, "answer_count": 2, "score": 0, "last_activity_date": 1492636598, "creation_date": 1492635105, "last_edit_date": 1492635519, "question_id": 43505824, "link": "https://stackoverflow.com/questions/43505824/how-to-return-a-json-response-from-a-before-block", "title": "How to return a JSON response from a before block", "body": "<p>I am writing a Sinatra-based API, and want to protect certain endpoints with an API key, validating the key before the route is processed.</p>\n\n<p>I understand why throwing an error in the <code>before</code> block doesn't work, because the <code>begin</code>/<code>rescue</code> statements haven't been called yet, however I want a JSON response to be sent back to the client with the error message as a JSON object.</p>\n\n<p>How would I do this?</p>\n\n<pre><code>namespace '/v1/sponser/:key' do\n\n  before do\n    if APIHelper.valid_key?(params[:key]) == false\n      throw 'Error, invalid API key'\n      # is it possible to return a JSON response from the before statement here?\n    end\n  end\n\n  get '/test' do\n    begin\n      json status: 200, body: 'just a test'\n    rescue =&gt; error\n      json status: 404, error: error\n    end\n  end\n\nend\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-5"], "comments": [{"owner": {"reputation": 1084, "user_id": 765297, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bcfaf2a6732b6ae657d0dd6675655d97?s=128&d=identicon&r=PG", "display_name": "zarazan", "link": "https://stackoverflow.com/users/765297/zarazan"}, "edited": false, "score": 0, "creation_date": 1492634954, "post_id": 43505701, "comment_id": 74066314, "body": "Post your database migration for these two objects. You probably have a foreign key constraint in your database."}], "answers": [{"tags": [], "owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "is_accepted": true, "score": 4, "last_activity_date": 1508504743, "last_edit_date": 1508504743, "creation_date": 1492637110, "answer_id": 43506334, "question_id": 43505701, "link": "https://stackoverflow.com/questions/43505701/ruby-on-rails-how-to-replace-one-has-one-association-with-another-without-del/43506334#43506334", "title": "Ruby on Rails - How to replace one has_one association with another without :delete or :destroy", "body": "<p>Since Rails 5 <code>belongs_to</code> associations require the associated object to exist (see: <a href=\"https://github.com/rails/rails/pull/18937\" rel=\"nofollow noreferrer\">PR introducing this behavior</a>).</p>\n\n<p>That said: If you want to keep a <code>room</code> although it does not have a <code>dungeon</code> associated you have to change your <code>belongs_to</code> definition to:</p>\n\n<pre><code>belongs_to :dungeon, optional: true\n</code></pre>\n"}], "owner": {"reputation": 105, "user_id": 4168493, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AOh14Gh4PbDKClzj_AbeEngyP9_8YvFHdK0QOmbRB1nB=k-s128", "display_name": "cincospenguinos", "link": "https://stackoverflow.com/users/4168493/cincospenguinos"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1176, "favorite_count": 0, "accepted_answer_id": 43506334, "answer_count": 1, "score": 0, "last_activity_date": 1508504743, "creation_date": 1492634599, "question_id": 43505701, "link": "https://stackoverflow.com/questions/43505701/ruby-on-rails-how-to-replace-one-has-one-association-with-another-without-del", "title": "Ruby on Rails - How to replace one has_one association with another without :delete or :destroy", "body": "<p>I have these two classes:</p>\n\n<pre><code>    class Dungeon &lt; ApplicationRecord\n      has_one :room\n      ...\n    end\n\n    class Room &lt; ApplicationRecord\n      belongs_to :dungeon\n      ...\n    end\n</code></pre>\n\n<p>I want to be able to replace Dungeon's one Room object with another without actually deleting or destroying Dungeon's original Room object. When I try using <code>update(room: r)</code>, I get </p>\n\n<pre><code>ActiveRecord::RecordNotSaved: Failed to remove the existing associated room. The record failed to save after its foreign key was set to nil.\n</code></pre>\n\n<p>What do I need to do to be able to simply replace Dungeon's one room with another?</p>\n"}, {"tags": ["ruby-on-rails", "json", "ruby"], "comments": [{"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 0, "creation_date": 1492635685, "post_id": 43505695, "comment_id": 74066684, "body": "Show us your attempt at doing this. Without evidence of your effort it looks like you gave up quickly and want us to write it for you. Read &quot;<a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>&quot; and &quot;<a href=\"http://meta.stackoverflow.com/questions/261592\">How much research effort is expected of Stack Overflow users?</a>&quot;"}, {"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 0, "creation_date": 1492636195, "post_id": 43505695, "comment_id": 74066933, "body": "No, there is no way to get inside the JSON serializing process. I&#39;d generate the initial JSON, calculate whatever it is you want, then add that value to the original object and reserialize it. But it sounds like your question is an &quot;<a href=\"https://meta.stackexchange.com/q/66377/153968\">XY Problem</a>&quot; where you&#39;re asking about Y when you should have asked about X. What is the overall goal? What you&#39;re trying to do with the JSON is easy but your description isn&#39;t good. See &quot;<a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>&quot; and the linked page. BTW, your example JSON won&#39;t create valid JSON output."}, {"owner": {"reputation": 9659, "user_id": 6136634, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d7487290ff90aebf6848d9c638c067bb?s=128&d=identicon&r=PG", "display_name": "Gerry", "link": "https://stackoverflow.com/users/6136634/gerry"}, "edited": false, "score": 0, "creation_date": 1492636358, "post_id": 43505695, "comment_id": 74067025, "body": "Do all values need to be validated, or just one (or few) of them? How do you assign all other values? Show more of your real code so we can better understand your problem."}], "answers": [{"tags": [], "owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "is_accepted": false, "score": -1, "last_activity_date": 1492637005, "last_edit_date": 1492637005, "creation_date": 1492636524, "answer_id": 43506203, "question_id": 43505695, "link": "https://stackoverflow.com/questions/43505695/how-to-check-for-value-while-creating-json-output/43506203#43506203", "title": "How to check for value while creating JSON output", "body": "<p>I'd go about it like this:</p>\n\n<pre><code>require 'active_support/core_ext/object/blank'\nrequire 'json'\n\nsome_value = 'foo'\nhash = {\n  abc: \"abc\",\n  xyz: \"xyz\"\n}\n\nhash.merge!(pqr: some_value) unless some_value.blank?\nputs hash.to_json \n\n# &gt;&gt; {\"abc\":\"abc\",\"xyz\":\"xyz\",\"pqr\":\"foo\"}\n</code></pre>\n\n<p>If <code>some_value = ''</code> it'll result in:</p>\n\n<pre><code># &gt;&gt; {\"abc\":\"abc\",\"xyz\":\"xyz\"}\n</code></pre>\n\n<p>Don't create the JSON then try to change it. Instead create the base object, make the test then merge in the change, then serialize to JSON.</p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 1361479, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ed0babba03db05692b5fac81d338fed?s=128&d=identicon&r=PG", "display_name": "JP Camargo", "link": "https://stackoverflow.com/users/1361479/jp-camargo"}, "is_accepted": false, "score": 0, "last_activity_date": 1492638167, "creation_date": 1492638167, "answer_id": 43506591, "question_id": 43505695, "link": "https://stackoverflow.com/questions/43505695/how-to-check-for-value-while-creating-json-output/43506591#43506591", "title": "How to check for value while creating JSON output", "body": "<p>I don't think you can.</p>\n\n<p>But, some other ways to deal with it, assuming you have active_support, you could use a hash <a href=\"https://apidock.com/rails/Hash/compact\" rel=\"nofollow noreferrer\">compact</a> (<code>sample_json.compact</code>), which will remove key-value pairs with <code>nil</code> values.</p>\n\n<p>But If you do need <code>!v.blank?</code>, you could do:\n<code>\nsample_json.select { |_, value| !value.blank? }\n</code></p>\n"}], "owner": {"reputation": 5412, "user_id": 697033, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/b9a174a1c104593989507de16c8bb769?s=128&d=identicon&r=PG", "display_name": "tech_human", "link": "https://stackoverflow.com/users/697033/tech-human"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 45, "favorite_count": 0, "answer_count": 2, "score": -2, "last_activity_date": 1492638167, "creation_date": 1492634586, "last_edit_date": 1492635970, "question_id": 43505695, "link": "https://stackoverflow.com/questions/43505695/how-to-check-for-value-while-creating-json-output", "title": "How to check for value while creating JSON output", "body": "<p>I am creating JSON output and want to check the value before I create the key value pair. Is there a way to do it while creating the JSON rather than adding it later?</p>\n\n<p>I am creating this JSON output:</p>\n\n<pre><code>sample_json = {\n  abc: \"abc\",\n  xyz: \"xyz\",\n  pqr: some_value unless some_value.blank?\n}\n</code></pre>\n\n<p>In this example I cannot check for <code>unless some_value.blank?</code> while creating the JSON string, so I first create the JSON and then add <code>pqr: some_value</code> separately after checking for a blank value, something like this:</p>\n\n<pre><code>sample_json = {\n  abc: \"abc\",\n  xyz: \"xyz\"\n}\n\nsample_json[:pqr] = some_value unless some_value.blank?\n</code></pre>\n\n<p>Is there is a way to add the check while creating the JSON itself like in the first example?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-4"], "answers": [{"comments": [{"owner": {"reputation": 1695, "user_id": 427354, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/8b1da0d743d87175b7cc0ef93c8fcad7?s=128&d=identicon&r=PG", "display_name": "User7354632781", "link": "https://stackoverflow.com/users/427354/user7354632781"}, "edited": false, "score": 0, "creation_date": 1492634011, "post_id": 43505390, "comment_id": 74065754, "body": "Thanks. So my class is in models/views/def_usage.rb and i am naming it in factory girl Views::DefUsage then it should work right? but getting same error"}, {"owner": {"reputation": 7878, "user_id": 630780, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/fskbD.png?s=128&g=1", "display_name": "Carl Markham", "link": "https://stackoverflow.com/users/630780/carl-markham"}, "edited": false, "score": 1, "creation_date": 1492634156, "post_id": 43505390, "comment_id": 74065841, "body": "try just <code>models&#47;def_usage.rb</code> and call the class <code>DefUsage</code> no real reason why you need to have it in a <code>views</code> folder"}, {"owner": {"reputation": 1695, "user_id": 427354, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/8b1da0d743d87175b7cc0ef93c8fcad7?s=128&d=identicon&r=PG", "display_name": "User7354632781", "link": "https://stackoverflow.com/users/427354/user7354632781"}, "edited": false, "score": 0, "creation_date": 1492634500, "post_id": 43505390, "comment_id": 74066049, "body": "so when i moved it to models/abc/def_usage.rb and naming Abc::DefUsage in factory then it works. works for now. Thanks meagar and Carl"}], "tags": [], "owner": {"reputation": 208794, "user_id": 229044, "user_type": "moderator", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/591426cbbacd4025d920467bad356911?s=128&d=identicon&r=PG&f=1", "display_name": "meagar", "link": "https://stackoverflow.com/users/229044/meagar"}, "is_accepted": true, "score": 2, "last_activity_date": 1492633308, "creation_date": 1492633308, "answer_id": 43505390, "question_id": 43505290, "link": "https://stackoverflow.com/questions/43505290/uninitialized-constant-name-error/43505390#43505390", "title": "uninitialized constant name error", "body": "<p>Your path needs to match your module/class hierarchy.</p>\n\n<p>If you want your class to be in <code>app/models/views/def.rb</code>, then your class needs to be <code>Views::Def</code>.</p>\n\n<p>If you want your class to be <code>Abc::Def</code>, your path needs to be <code>app/models/abc/def.rb</code>.</p>\n\n<p>If you want your class name to be <code>DefUsage</code>, your file name needs to be <code>def_usage.rb</code>.</p>\n\n<p>You can't use arbitrary paths and class names. They need to match if you want Rails to automatically load constants for you.</p>\n"}], "owner": {"reputation": 1695, "user_id": 427354, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/8b1da0d743d87175b7cc0ef93c8fcad7?s=128&d=identicon&r=PG", "display_name": "User7354632781", "link": "https://stackoverflow.com/users/427354/user7354632781"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 212, "favorite_count": 0, "accepted_answer_id": 43505390, "answer_count": 1, "score": -1, "last_activity_date": 1492633308, "creation_date": 1492632942, "question_id": 43505290, "link": "https://stackoverflow.com/questions/43505290/uninitialized-constant-name-error", "title": "uninitialized constant name error", "body": "<p>I have model as follows</p>\n\n<p>app/models/views/def_usage.rb</p>\n\n<pre><code>class Abc\n  class Def &lt; ActiveRecord::Base\n\nself.table_name = 'vSomeview'\n\n  end\nend\n</code></pre>\n\n<p>I am trying to create a factory girl for this</p>\n\n<p>spec/factories/views/def_usage.rb</p>\n\n<pre><code>FactoryGirl.define do\n  factory :def_usage, class: Abc::DefUsage do\n ......\n  end\nend\n</code></pre>\n\n<p>I am getting error <code>uninitialized constant Abc::DefUsage (NameError)</code></p>\n\n<p>I tried changing <code>class: Views::Abc::DefUsage</code> or <code>Views::DefUsage</code> but no luck. i am getting that error when i am trying to do <code>rails console</code>. why i am getting that error?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "devise", "routing"], "answers": [{"tags": [], "owner": {"reputation": 4062, "user_id": 316729, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/9249736dae1898d537770886061c06f9?s=128&d=identicon&r=PG", "display_name": "Sam Joseph", "link": "https://stackoverflow.com/users/316729/sam-joseph"}, "is_accepted": false, "score": 0, "last_activity_date": 1492678911, "last_edit_date": 1495541861, "creation_date": 1492678911, "answer_id": 43514887, "question_id": 43505269, "link": "https://stackoverflow.com/questions/43505269/routing-constraint-warden-session-with-devise-and-capybara/43514887#43514887", "title": "Routing constraint warden session with Devise and Capybara", "body": "<p>I think you might want to reset the session inbetween tests ...</p>\n\n<p><code>Capybara.reset_sessions!</code></p>\n\n<p>see <a href=\"https://stackoverflow.com/a/26734459/316729\">https://stackoverflow.com/a/26734459/316729</a></p>\n"}], "owner": {"reputation": 7011, "user_id": 812939, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/1e305e2a6daaae36635f9a88c2a7a48a?s=128&d=identicon&r=PG", "display_name": "Nick ONeill", "link": "https://stackoverflow.com/users/812939/nick-oneill"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 103, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1492678911, "creation_date": 1492632870, "last_edit_date": 1492638055, "question_id": 43505269, "link": "https://stackoverflow.com/questions/43505269/routing-constraint-warden-session-with-devise-and-capybara", "title": "Routing constraint warden session with Devise and Capybara", "body": "<p>I'm using Capybara for some feature tests and have added a routing constraint. </p>\n\n<p>Here's a snippet of the code:</p>\n\n<pre><code>class LenderConstraint\n    def matches?(request)\n        user_cookie = request.session.fetch('warden.user.user.key')\n    end\nend\n</code></pre>\n\n<p>This works properly but it's not available in the test environment. Everything was working properly with the tests up until the addition of this constraint. What's the most effective way to get this working?</p>\n\n<p><strong>Update</strong></p>\n\n<p>It works when I run the individual test but not when I run the suite.</p>\n\n<p><strong>Update 2</strong></p>\n\n<p>I've debugged the session and the issue is pertaining to  <code>warden.user.user.key</code> not being properly set. When I call:</p>\n\n<p><code>login_as(@user, scope: :user)</code> with a user ID of 1, the value of <code>request.session.fetch('warden.user.user.key')</code> returns 2 which is the ID of the first user the system logged in during the test suite.</p>\n"}, {"tags": ["ruby", "calabash-android"], "comments": [{"owner": {"reputation": 111, "user_id": 917613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b4450555b42e36e563d0563f611fd8d?s=128&d=identicon&r=PG", "display_name": "snikolau", "link": "https://stackoverflow.com/users/917613/snikolau"}, "edited": false, "score": 0, "creation_date": 1492633247, "post_id": 43505104, "comment_id": 74065320, "body": "Does your original code contain <code>require &#39;calabash-android&#47;gestures&#39;</code>? If ruby wouldn&#39;t be able to load this file it would throw the error <code>LoadError: cannot load such file -- &#39;calabash-android&#47;gestures&#39;</code>."}, {"owner": {"reputation": 95, "user_id": 4355521, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/9e406a6bd7a4dbc9e506125d33b2b0f5?s=128&d=identicon&r=PG&f=1", "display_name": "hectorhfm", "link": "https://stackoverflow.com/users/4355521/hectorhfm"}, "reply_to_user": {"reputation": 111, "user_id": 917613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b4450555b42e36e563d0563f611fd8d?s=128&d=identicon&r=PG", "display_name": "snikolau", "link": "https://stackoverflow.com/users/917613/snikolau"}, "edited": false, "score": 0, "creation_date": 1492633569, "post_id": 43505104, "comment_id": 74065516, "body": "It did not contain the require, I already have included it, but same error is shown."}, {"owner": {"reputation": 111, "user_id": 917613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b4450555b42e36e563d0563f611fd8d?s=128&d=identicon&r=PG", "display_name": "snikolau", "link": "https://stackoverflow.com/users/917613/snikolau"}, "edited": false, "score": 0, "creation_date": 1492633665, "post_id": 43505104, "comment_id": 74065564, "body": "What if you use <code>Calabash::Android::Gestures::MultiTouchGesture.new(gest)</code> instead of <code>MultiTouchGesture.new(gest)</code>"}, {"owner": {"reputation": 95, "user_id": 4355521, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/9e406a6bd7a4dbc9e506125d33b2b0f5?s=128&d=identicon&r=PG&f=1", "display_name": "hectorhfm", "link": "https://stackoverflow.com/users/4355521/hectorhfm"}, "reply_to_user": {"reputation": 111, "user_id": 917613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b4450555b42e36e563d0563f611fd8d?s=128&d=identicon&r=PG", "display_name": "snikolau", "link": "https://stackoverflow.com/users/917613/snikolau"}, "edited": false, "score": 0, "creation_date": 1492634251, "post_id": 43505104, "comment_id": 74065903, "body": "Now it seems to be working. Thank you very much! Is there a way I could reduce Calabash::Android::Gestures::MultiTouchGesture to a shorter resolution operator?"}, {"owner": {"reputation": 111, "user_id": 917613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b4450555b42e36e563d0563f611fd8d?s=128&d=identicon&r=PG", "display_name": "snikolau", "link": "https://stackoverflow.com/users/917613/snikolau"}, "edited": false, "score": 0, "creation_date": 1492634449, "post_id": 43505104, "comment_id": 74066024, "body": "You can try to use <code>Gestures::MultiTouchGesture.new(gest)</code>, not sure if all namespaces are loaded. Alternatively, you can put <code>include Calabash::Android::Gestures</code> after requires part, then just <code>MultiTouchGesture.new(gest)</code> should work."}], "owner": {"reputation": 95, "user_id": 4355521, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/9e406a6bd7a4dbc9e506125d33b2b0f5?s=128&d=identicon&r=PG&f=1", "display_name": "hectorhfm", "link": "https://stackoverflow.com/users/4355521/hectorhfm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 53, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1492633203, "creation_date": 1492632246, "last_edit_date": 1492633203, "question_id": 43505104, "link": "https://stackoverflow.com/questions/43505104/ruby-uniniatialized-constant-in-calabash-step", "title": "Ruby uniniatialized constant in Calabash Step", "body": "<p>I am writing some interface tests using Cucumber as skeleton for Android-Calabash. The tests are written in Ruby.</p>\n\n<p>I am receiving the following execution error: </p>\n\n<blockquote>\n  <p>uninitialized constant MultiTouchGesture</p>\n</blockquote>\n\n<p>The code generating it is:</p>\n\n<pre><code>require 'calabash-android/calabash_steps'\nrequire 'calabash-android/gestures'\n\n        When(/^When I touch the spaceship and an asteroid at the same time$/) do\n            gest = []\n            multi_touch = MultiTouchGesture.new(gest)\n            gestures.add_touch(touch(\"* id:'spaceship'\"), 0)\n            gestures.add_touch(touch(\"* id:'asteroid'\"), 1)\n        end\n</code></pre>\n\n<p>I guess Ruby does not find gestures.rb where MultiTouchGesture class is, even if I have imported it using 'require'. I have checked for gestures.rb and it is not missing in my computer, it is in the following path:</p>\n\n<blockquote>\n  <p>C:\\Ruby23-x64\\lib\\ruby\\gems\\2.3.0\\gems\\calabash-android-0.9.0\\lib\\calabash-android</p>\n</blockquote>\n\n<p>What can I do to make Ruby find the class?</p>\n\n<p>Here is the documentation for MultiTouchGesture class:\n<a href=\"http://www.rubydoc.info/gems/calabash-android/Calabash/Android/Gestures/MultiTouchGesture\" rel=\"nofollow noreferrer\">http://www.rubydoc.info/gems/calabash-android/Calabash/Android/Gestures/MultiTouchGesture</a></p>\n\n<p>Thank you,</p>\n\n<p>H\u00e9ctor</p>\n"}, {"tags": ["ruby", "session", "sinatra", "passenger"], "answers": [{"tags": [], "owner": {"reputation": 21, "user_id": 6051152, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ef509cee2d23f93774976dea6ca0bb56?s=128&d=identicon&r=PG&f=1", "display_name": "Wout_", "link": "https://stackoverflow.com/users/6051152/wout"}, "is_accepted": false, "score": 0, "last_activity_date": 1492704613, "creation_date": 1492704613, "answer_id": 43524699, "question_id": 43504994, "link": "https://stackoverflow.com/questions/43504994/sinatra-app-has-session-issues-in-production/43524699#43524699", "title": "Sinatra app has session issues in production", "body": "<p>After some more researching I found the configuration option <strong>passenger_sticky_sessions</strong>. Because in my web application session storage is quite important, this works fine for me. However, the use of this is not recommended in all use cases because all the clients sends will be routed to the same originating application process.</p>\n\n<p>Documentation: <a href=\"https://www.phusionpassenger.com/library/config/nginx/reference/#passenger_sticky_sessions\" rel=\"nofollow noreferrer\">https://www.phusionpassenger.com/library/config/nginx/reference/#passenger_sticky_sessions</a></p>\n\n<p>With this configuration parameter 'on' in my conf file in nginx/sites-enabled, I was able to just use the simple rack session pool:</p>\n\n<pre><code>use Rack::Session::Pool, path: '/', expire_after: 2592000\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 6051152, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ef509cee2d23f93774976dea6ca0bb56?s=128&d=identicon&r=PG&f=1", "display_name": "Wout_", "link": "https://stackoverflow.com/users/6051152/wout"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 192, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1492704613, "creation_date": 1492631860, "last_edit_date": 1495540934, "question_id": 43504994, "link": "https://stackoverflow.com/questions/43504994/sinatra-app-has-session-issues-in-production", "title": "Sinatra app has session issues in production", "body": "<p>I've been working on a web application in Ruby using Sinatra. While in development, I really never had a lot of issues with sessions. However, now i'm ussing passenger to actually deploy the application I have quite a lot of issues regarding that session data keeps getting 'reset'. </p>\n\n<p>I've seen other stack overflow questions related to this problem but no answer has yet fixed it for me. I've tried a couple of things:  </p>\n\n<ul>\n<li><a href=\"https://stackoverflow.com/a/2256179/6051152\">Putting 'use Rack::Session::Pool' inside config.ru as suggested here</a>  </li>\n<li><a href=\"http://www.rubydoc.info/gems/rack/Rack/Session/Pool\" rel=\"nofollow noreferrer\">Used Rack::Session::Pool like explained here</a></li>\n<li><a href=\"http://recipes.sinatrarb.com/p/middleware/share_session_with_memcached\" rel=\"nofollow noreferrer\">Tried Memcache as explained here</a></li>\n<li><a href=\"https://github.com/redis-store/redis-rack\" rel=\"nofollow noreferrer\">Tried Redis-Rack</a> (gives me an error: Exception NoMethodError in Rack application object (undefined method `foreign_key' for nil:NilClass))</li>\n</ul>\n\n<p>Nothing seems to be helping really... I either end up having an error or my session gets reset each request. I know that passenger probably uses multiple threads and that that is the cause for the sessions to not be working, but I cannot seem to find a solution to the problem.</p>\n\n<p>Am I missing something obvious here? Any suggestions?</p>\n\n<p><strong>Gemfile</strong>  </p>\n\n<pre><code>source \"https://rubygems.org\"\n\ngem 'mongo', '1.8.6'\ngem 'sinatra', '1.4.8'\ngem 'mongo_mapper'\ngem 'bson_ext'\ngem 'active_model_serializers'\ngem 'activemodel-serializers-xml'\ngem 'sinatra-flash'\ngem 'sinatra-param', require: 'sinatra/param'\ngem 'rack-recaptcha2', git: 'https://github.com/nicolas-simplex/rack-    recaptcha'\ngem 'mail'\ngem 'slugify'\ngem 'biz'\ngem 'bcrypt'\ngem 'redis-rack'\n\ngroup :development do\n  gem 'mailcatcher', '~&gt; 0.6.4'\nend\n</code></pre>\n\n<p><strong>config.ru</strong><br>\nIt had different forms depending on if I used just Rack::Session::Pool, Memcache or Redis. This one was the one I used for redis:</p>\n\n<pre><code>require 'rubygems'\nrequire 'sinatra'\nrequire File.expand_path '../app.rb', __FILE__\n\nrequire 'rack'\nrequire 'rack/session/redis'\n\nrequire_relative './app'\n\napp = App.new\n\nsessioned = use Rack::Session::Redis.new(app)\n\nrun sessioned\n</code></pre>\n\n<p><strong>App.rb</strong>  </p>\n\n<pre><code>require 'rubygems'\nrequire 'bundler/setup'\nrequire 'sinatra'\n\nrequire 'slugify'\n\nclass App &lt; Sinatra::Base\n  use Rack::Protection\n\n  set :bind, '0.0.0.0'\nend\n\nrequire_relative './config/init'  # Initialize configuration files\nrequire_relative './helpers/init' # Initialize helpers\nrequire_relative './routes/init'  # Initialize routes\nrequire_relative './models/init'  # Initialize models\n\nrequire_relative './util/tokens'  # Token utility\n\n... # Some database seeding, basic setup for some data I use\n</code></pre>\n\n<p><strong>TL;DR</strong><br>\nSinatra and Passenger together resets sessions in production, while this doesn't happen in development.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "node.js", "npm"], "answers": [{"tags": [], "owner": {"reputation": 1212, "user_id": 1341809, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/afdd238a7321a4dbdbf70cd063d7ef61?s=128&d=identicon&r=PG", "display_name": "learner", "link": "https://stackoverflow.com/users/1341809/learner"}, "is_accepted": false, "score": 0, "last_activity_date": 1492697418, "creation_date": 1492697418, "answer_id": 43521964, "question_id": 43504039, "link": "https://stackoverflow.com/questions/43504039/browserifyrailsbrowserifyerror-with-npm-and-rails/43521964#43521964", "title": "BrowserifyRails::BrowserifyError with npm and rails", "body": "<p>Solved.</p>\n\n<p>I followed instruction from <a href=\"https://blog.skcript.com/setting-up-browserify-and-react-on-rails-ef5bc0f07cda\" rel=\"nofollow noreferrer\">this link</a>. Just add this configuration in my application.rb file:</p>\n\n<pre><code>config.browserify_rails.commandline_options = \u201c \u2014 transform reactify \u2014 extension=\\\u201d.jsx\\\u201d\u201d\n</code></pre>\n\n<p>After that, <code>npm init</code>, followed by <code>npm install</code>. I've executed those commands in the root folder of my project.</p>\n"}], "owner": {"reputation": 1212, "user_id": 1341809, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/afdd238a7321a4dbdbf70cd063d7ef61?s=128&d=identicon&r=PG", "display_name": "learner", "link": "https://stackoverflow.com/users/1341809/learner"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 619, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1492697418, "creation_date": 1492628548, "last_edit_date": 1495540016, "question_id": 43504039, "link": "https://stackoverflow.com/questions/43504039/browserifyrailsbrowserifyerror-with-npm-and-rails", "title": "BrowserifyRails::BrowserifyError with npm and rails", "body": "<p>I'm trying to run a local application using ruby on rails. At first time to run local server, it complain about nodejs, which was installed sucessfully.\nAfter, the error when local server is about to run:</p>\n\n<pre><code>Unable to run node_modules/.bin/browserify. Ensure you have installed it with npm.\n</code></pre>\n\n<p>Npm was installed and browserify with this command:</p>\n\n<pre><code>npm install -g browserify\n</code></pre>\n\n<p>Installed with no problems. But when I do this command</p>\n\n<pre><code>npm install browserify-incremental\n</code></pre>\n\n<p>It installs but shows this warning:</p>\n\n<pre><code>UNMET DEPENDENCY browserify@^12.0.1 browserify\n</code></pre>\n\n<p>I follow <a href=\"https://stackoverflow.com/questions/31816443/unable-to-run-node-modules-bin-browserifyinc-ensure-you-have-installed-it-with\">this thread</a> on SO.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "windows", "twitter", "twitter-gem"], "comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1492627678, "post_id": 43503652, "comment_id": 74061993, "body": "It looks like you already have a table named <code>tweets</code> and your migration is failing. Did you create that manually prior to using the gem? Can you scrub your database and rebuild it from scratch using <code>rake db:migrate</code>?"}, {"owner": {"reputation": 1, "user_id": 7410217, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d65227bab0a3f76413001a7f5d278215?s=128&d=identicon&r=PG&f=1", "display_name": "Cristina Mihailescu", "link": "https://stackoverflow.com/users/7410217/cristina-mihailescu"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 1, "creation_date": 1492628391, "post_id": 43503652, "comment_id": 74062409, "body": "I used <code>rails db:reset</code>. Thank you very much! It&#39;s working now!"}], "owner": {"reputation": 1, "user_id": 7410217, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d65227bab0a3f76413001a7f5d278215?s=128&d=identicon&r=PG&f=1", "display_name": "Cristina Mihailescu", "link": "https://stackoverflow.com/users/7410217/cristina-mihailescu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 154, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1492627138, "creation_date": 1492627138, "question_id": 43503652, "link": "https://stackoverflow.com/questions/43503652/post-on-twitter-using-twitter-gem-rails-app", "title": "Post on twitter using twitter gem - rails app", "body": "<p>I'm using rails to build an application which allows users to authorize and connect to the Twitter API using their Twitter account. The log in works, but i have a problem with the posts (i'm using <a href=\"https://github.com/sferik/twitter\" rel=\"nofollow noreferrer\">this gem</a>): when i try to run rails db:migrate i get this error:</p>\n\n<pre><code>$ rails db:migrate\nrails aborted!\nStandardError: An error has occurred, this and all later migrations canceled:\n\nPG::DuplicateTable: ERROR:  relation \"tweets\" already exists\n: CREATE TABLE \"tweets\" (\"id\" serial primary key, \"user_id\" integer, \"body\" text, \"created_at\" timestamp NOT NULL, \"updated_at\" timestamp NOT NULL)\nC:/Users/......./db/migrate/20170419185735_create_tweets.rb:3:in `change'\nbin/rails:4:in `require'\nbin/rails:4:in `&lt;main&gt;'\nActiveRecord::StatementInvalid: PG::DuplicateTable: ERROR:  relation \"tweets\" already exists\n: CREATE TABLE \"tweets\" (\"id\" serial primary key, \"user_id\" integer, \"body\" text, \"created_at\" timestamp NOT NULL, \"updated_at\" timestamp NOT NULL)\nC:/Users/......./db/migrate/20170419185735_create_tweets.rb:3:in `change'\nbin/rails:4:in `require'\nbin/rails:4:in `&lt;main&gt;'\nPG::DuplicateTable: ERROR:  relation \"tweets\" already exists\nC:/Users/......./db/migrate/20170419185735_create_tweets.rb:3:in `change'\nbin/rails:4:in `require'\nbin/rails:4:in `&lt;main&gt;'\nTasks: TOP =&gt; db:migrate\n(See full trace by running task with --trace)\n== 20170419185735 CreateTweets: migrating =====================================\n-- create_table(:tweets)\n</code></pre>\n\n<p>I'm new to rails so any help would be appreciated!</p>\n"}, {"tags": ["ruby", "irb"], "comments": [{"owner": {"reputation": 208794, "user_id": 229044, "user_type": "moderator", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/591426cbbacd4025d920467bad356911?s=128&d=identicon&r=PG&f=1", "display_name": "meagar", "link": "https://stackoverflow.com/users/229044/meagar"}, "edited": false, "score": 2, "creation_date": 1492627197, "post_id": 43503453, "comment_id": 74061720, "body": "Your question makes no sense. IRB is a repl, it s meant to run each line one line at a time. There is no reason/sense behind trying to run both of those lines &quot;at the same time&quot;. If you want to run an entire script, put it in a file and <code>ruby &lt;file&gt;</code>, don&#39;t use IRB."}, {"owner": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "edited": false, "score": 0, "creation_date": 1492627225, "post_id": 43503453, "comment_id": 74061733, "body": "You can use semicolon <code>;</code> to chain your statements. And also you can interpolate that as <code>print &quot;2+3 is equal to #{2+3}&quot;</code>."}, {"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 0, "creation_date": 1492630816, "post_id": 43503453, "comment_id": 74063872, "body": "Semicolons don&#39;t &quot;chain&quot; statements, they let them be written on the same line, but they remain separate statements. And, while we <i>can</i> use semicolons, they&#39;re not idiomatic and they lead to code that isn&#39;t written clearly."}], "answers": [{"comments": [{"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 0, "creation_date": 1492630872, "post_id": 43503648, "comment_id": 74063913, "body": "This isn&#39;t the Ruby-way. The two lines should be written without the semicolon if they&#39;re separate lines."}], "tags": [], "owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "is_accepted": false, "score": -1, "last_activity_date": 1492627122, "creation_date": 1492627122, "answer_id": 43503648, "question_id": 43503453, "link": "https://stackoverflow.com/questions/43503453/add-line-break-new-line-in-irb/43503648#43503648", "title": "Add line break/new line in IRB?", "body": "<p>You can put a semicolon after the first line, like this:</p>\n\n<pre><code>print \"2+3 is equal to \";\nprint 2 + 3\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 23, "user_id": 7891201, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zb8kK.jpg?s=128&g=1", "display_name": "mrbtx", "link": "https://stackoverflow.com/users/7891201/mrbtx"}, "edited": false, "score": 1, "creation_date": 1492629445, "post_id": 43503670, "comment_id": 74063026, "body": "On second reading, I realized I&#39;d read too much into this and it was an example the book didn&#39;t actually want me to write in <code>irb</code> since it didn&#39;t have the <code>irb(main):</code> notation in front of it. Womp. Thanks!"}, {"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 1, "creation_date": 1492630649, "post_id": 43503670, "comment_id": 74063751, "body": "&quot;but also adds a newline&quot; probably should be &quot;but also conditionally adds a newline if the output doesn&#39;t already end with a newline&quot;"}, {"owner": {"reputation": 9030, "user_id": 5101476, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JCQrl.jpg?s=128&g=1", "display_name": "ice\u30c4", "link": "https://stackoverflow.com/users/5101476/ice%e3%83%84"}, "edited": false, "score": 1, "creation_date": 1493151783, "post_id": 43503670, "comment_id": 74289637, "body": "<code>print</code> and <code>puts</code> also accept multiple arguments so <code>print &#39;hello&#39;, 2+3</code> #=&gt; <code>hello5</code>, similarly for <code>puts</code>."}], "tags": [], "owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "is_accepted": true, "score": 0, "last_activity_date": 1492627206, "creation_date": 1492627206, "answer_id": 43503670, "question_id": 43503453, "link": "https://stackoverflow.com/questions/43503453/add-line-break-new-line-in-irb/43503670#43503670", "title": "Add line break/new line in IRB?", "body": "<p>That book might be taking very tiny steps to introducing this idea:</p>\n\n<pre><code>print \"Continues...\"\nputs \"(Up to here)\"\n</code></pre>\n\n<p>The <code>print</code> function just outputs to the terminal exactly what it's given. The <code>puts</code> function does the same but also adds a newline, which is what you want.</p>\n\n<p>The more Ruby way of doing this is either:</p>\n\n<pre><code>puts \"2+3 equals #{2+3}\" # Using string interpolation\nputs \"2+3 equals %d\" % (2 + 3) # Using sprintf-style interpolation\n</code></pre>\n\n<p>Now if you're using <code>irb</code>, that's a Read-Evaluate-Print-Loop (REPL) which means it executes everything you type in as soon as you press enter, by design. If you want to use your original code, you need to force it on one line:</p>\n\n<pre><code>print \"2+3 equals \"; print 2+3\n</code></pre>\n\n<p>Then that will work as expected. The <code>;</code> line separator is rarely used in Ruby, most style guides encourage you to split things up onto multiple lines, but if you do need to do a one-liner, this is how.</p>\n\n<p>When writing code in, say a <code>.rb</code> file the return key is just used for formatting and doesn't execute any code.</p>\n"}, {"tags": [], "owner": {"reputation": 508, "user_id": 4170455, "user_type": "registered", "accept_rate": 80, "profile_image": "https://graph.facebook.com/100000635283093/picture?type=large", "display_name": "Abdul Wahab", "link": "https://stackoverflow.com/users/4170455/abdul-wahab"}, "is_accepted": false, "score": 5, "last_activity_date": 1492627671, "creation_date": 1492627671, "answer_id": 43503807, "question_id": 43503453, "link": "https://stackoverflow.com/questions/43503453/add-line-break-new-line-in-irb/43503807#43503807", "title": "Add line break/new line in IRB?", "body": "<p>You could use semicolon at the end of statement like this <code>puts \"hello\";puts\"world\"</code> </p>\n"}], "owner": {"reputation": 23, "user_id": 7891201, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zb8kK.jpg?s=128&g=1", "display_name": "mrbtx", "link": "https://stackoverflow.com/users/7891201/mrbtx"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1903, "favorite_count": 0, "accepted_answer_id": 43503670, "answer_count": 3, "score": 2, "last_activity_date": 1492630708, "creation_date": 1492626470, "last_edit_date": 1492630708, "question_id": 43503453, "link": "https://stackoverflow.com/questions/43503453/add-line-break-new-line-in-irb", "title": "Add line break/new line in IRB?", "body": "<p>How do I add a line-break/new-line in IRB/Ruby? The book I'm learning from shows this code: </p>\n\n<pre><code>print \"2+3 is equal to \"\nprint 2 + 3\n</code></pre>\n\n<p>without telling how to go to the second line without hitting <kbd>Enter</kbd>, which obviously just runs the program.</p>\n"}, {"tags": ["ruby", "selenium", "capybara"], "comments": [{"owner": {"reputation": 42014, "user_id": 2709090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/238c2b7cde2c817fc9a5a2b8eaa2ffad?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Walpole", "link": "https://stackoverflow.com/users/2709090/thomas-walpole"}, "edited": false, "score": 0, "creation_date": 1492626357, "post_id": 43503335, "comment_id": 74061210, "body": "What is the stacktrace for the error, and what driver are you using?"}, {"owner": {"reputation": 42014, "user_id": 2709090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/238c2b7cde2c817fc9a5a2b8eaa2ffad?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Walpole", "link": "https://stackoverflow.com/users/2709090/thomas-walpole"}, "edited": false, "score": 0, "creation_date": 1492626672, "post_id": 43503335, "comment_id": 74061400, "body": "Do you have more of the stacktrace that would show the line in Capybara?"}], "answers": [{"comments": [{"owner": {"reputation": 3855, "user_id": 1318265, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/a842d45c144ed4f26c9ce500490b0a42?s=128&d=identicon&r=PG", "display_name": "Chase Sandmann", "link": "https://stackoverflow.com/users/1318265/chase-sandmann"}, "edited": false, "score": 0, "creation_date": 1492629506, "post_id": 43503582, "comment_id": 74063066, "body": "This was indeed the answer.  The xpath I actually had in my code was more complicated than I listed here and resulted in several inputs being selected, the first of which was a checkbox."}], "tags": [], "owner": {"reputation": 42014, "user_id": 2709090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/238c2b7cde2c817fc9a5a2b8eaa2ffad?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Walpole", "link": "https://stackoverflow.com/users/2709090/thomas-walpole"}, "is_accepted": true, "score": 1, "last_activity_date": 1492626900, "creation_date": 1492626900, "answer_id": 43503582, "question_id": 43503335, "link": "https://stackoverflow.com/questions/43503335/undefined-method-for-string-nomethoderror/43503582#43503582", "title": "Undefined method `^&#39; for String (NoMethodError)", "body": "<p>You're using selenium, and I'm guessing the field element you're finding is a checkbox, which takes <code>true</code> or <code>false</code> when calling set, not a string.</p>\n"}, {"tags": [], "owner": {"reputation": 508, "user_id": 4170455, "user_type": "registered", "accept_rate": 80, "profile_image": "https://graph.facebook.com/100000635283093/picture?type=large", "display_name": "Abdul Wahab", "link": "https://stackoverflow.com/users/4170455/abdul-wahab"}, "is_accepted": false, "score": 2, "last_activity_date": 1492629546, "creation_date": 1492629546, "answer_id": 43504309, "question_id": 43503335, "link": "https://stackoverflow.com/questions/43503335/undefined-method-for-string-nomethoderror/43504309#43504309", "title": "Undefined method `^&#39; for String (NoMethodError)", "body": "<p>You should declare function in top of file because ruby execute in top to bottom fasion  like this </p>\n\n<pre><code>   def fill_in_field(field_name, value)\n  field = find(:filter_field, field_name)\n   field.set(value)\n  end\n\nCapybara.add_selector(:filter_field) {xpath { |field_name| \".//div[contains(@class,'#{field_name}')]//input\" }}\n</code></pre>\n"}], "owner": {"reputation": 3855, "user_id": 1318265, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/a842d45c144ed4f26c9ce500490b0a42?s=128&d=identicon&r=PG", "display_name": "Chase Sandmann", "link": "https://stackoverflow.com/users/1318265/chase-sandmann"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 896, "favorite_count": 0, "accepted_answer_id": 43503582, "answer_count": 2, "score": 0, "last_activity_date": 1492629546, "creation_date": 1492626056, "last_edit_date": 1492626685, "question_id": 43503335, "link": "https://stackoverflow.com/questions/43503335/undefined-method-for-string-nomethoderror", "title": "Undefined method `^&#39; for String (NoMethodError)", "body": "<p>I'm very new to Cucumber/Capybara/Ruby/Selenium and I'm just trying to set a simple field with a value.  I'm finding the field with a special selector and then trying to set it:</p>\n\n<pre><code>Capybara.add_selector(:filter_field) {xpath { |field_name| \".//div[contains(@class,'#{field_name}')]//input\" }}\n\ndef fill_in_field(field_name, value)\n  field = find(:filter_field, field_name)\n  field.set(value)\nend\n</code></pre>\n\n<blockquote>\n  <p>undefined method `^' for \"1\":String (NoMethodError)\n  ./features/support/ui_interface_react.rb:271:in `fill_in_field'</p>\n</blockquote>\n\n<p>The error occurs on the line <code>field.set(value)</code>.  I know that <em>value</em> is a string and <em>field</em> is a <code>#&lt;Capybara::Node::Element&gt;</code>.  What am I doing wrong?</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 639, "user_id": 7046734, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RQ62P.jpg?s=128&g=1", "display_name": "Mayank", "link": "https://stackoverflow.com/users/7046734/mayank"}, "edited": false, "score": 0, "creation_date": 1492624609, "post_id": 43502761, "comment_id": 74060132, "body": "Because build will generate a new object every time it&#39;s called. <code>build</code> method basically generates a skeleton object empty from class and every time you are rendering ticket form it is doing that..."}, {"owner": {"reputation": 1428, "user_id": 2730725, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/1a694df4d71660fc4d84ccbb92469e38?s=128&d=identicon&r=PG&f=1", "display_name": "user273072545345", "link": "https://stackoverflow.com/users/2730725/user273072545345"}, "reply_to_user": {"reputation": 639, "user_id": 7046734, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RQ62P.jpg?s=128&g=1", "display_name": "Mayank", "link": "https://stackoverflow.com/users/7046734/mayank"}, "edited": false, "score": 0, "creation_date": 1492624730, "post_id": 43502761, "comment_id": 74060223, "body": "@Mayank, so what should the <code>&lt;%= form_for([@project, @project.tickets.build]) do |f| %&gt;</code> be then? Because I&#39;ve tried <code>&lt;%= form_for([@project, @project.tickets]) do |f| %&gt;</code> and I get <code>NoMethodError in Tickets#edit</code> and <code>undefined method &#39;to_key&#39; for #&lt;Ticket::ActiveRecord_Associations_CollectionProxy:0x007fa0&zwnj;&#8203;cfea2410&gt;</code>"}, {"owner": {"reputation": 1428, "user_id": 2730725, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/1a694df4d71660fc4d84ccbb92469e38?s=128&d=identicon&r=PG&f=1", "display_name": "user273072545345", "link": "https://stackoverflow.com/users/2730725/user273072545345"}, "reply_to_user": {"reputation": 639, "user_id": 7046734, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RQ62P.jpg?s=128&g=1", "display_name": "Mayank", "link": "https://stackoverflow.com/users/7046734/mayank"}, "edited": false, "score": 0, "creation_date": 1492624843, "post_id": 43502761, "comment_id": 74060287, "body": "@Mayank, I&#39;ve also tried this: <code>&lt;%= form_for(@project, @project.tickets) do |f| %&gt;</code>, and I get this error: <code>TypeError in Tickets#edit</code> and <code>no implicit conversion of Symbol into Integer</code>"}], "owner": {"reputation": 1428, "user_id": 2730725, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/1a694df4d71660fc4d84ccbb92469e38?s=128&d=identicon&r=PG&f=1", "display_name": "user273072545345", "link": "https://stackoverflow.com/users/2730725/user273072545345"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 25, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1492628437, "creation_date": 1492624103, "last_edit_date": 1492628437, "question_id": 43502761, "link": "https://stackoverflow.com/questions/43502761/nested-ticket-edit-action-comes-up-blank-inside-project", "title": "Nested Ticket Edit Action Comes Up Blank Inside Project", "body": "<p>I am building a rails app to learn about nested controllers actions. Hence I have <code>Projects</code> to which <code>Tickets</code> are nested underneath. It's basically a rip-off from Rails Action. Now, I am trying to add edit action in Ticket's controller.</p>\n\n<p>Everything works fine in Projects, ie, all the actions.</p>\n\n<p>Everything seems to work fine in Tickets. As stated earlier, it's a rip-off from Rails Action. So trying learn how to put in correct stuff within blank actions, ie, <code>Edit</code>, <code>Show</code>, <code>Update</code>, and <code>Destroy</code></p>\n\n<p>When I added edit action in <code>Tickets</code> show page, and clicked on it, it showed the page, but the form fields are blank. </p>\n\n<p>The url path is correct: <code>http://127.0.0.1:3000/projects/2/tickets/2/edit</code> so that means the resources are set up correctly. </p>\n\n<p>How do I fix this so it shows the previous content? My vague understanding is that it may have to do with the form? </p>\n\n<p><strong>Current Tickets Controller</strong> </p>\n\n<pre><code>class TicketsController &lt; ApplicationController\n\n    #which actions are necessary? learn how to not need set_project set_ticket\n    before_action :set_project\n    before_action :set_ticket, only: [:show, :edit, :update, :destroy]\n\n    def create \n        @ticket = @project.tickets.build(ticket_params) \n\n        if @ticket.save\n            flash[:notice] = \"Ticket has been created.\" \n            redirect_to project_path(@project)\n        else\n            flash.now[:alert] = \"Ticket has not been created.\"\n            render \"new\"\n        end\n    end \n\n    def new \n        @ticket = @project.tickets.build\n    end\n\n    def show\n    end\n\n    def edit \n        @ticket = @project.tickets.find(params[:id]) \n    end\n\n    def update\n    end\n\n    def destroy\n    end\n\n\n    private \n\n        def ticket_params\n            params.require(:ticket).permit(:title, :description)\n        end\n\n        def set_project \n            @project = Project.find(params[:project_id])\n        end\n\n        def set_ticket \n            @ticket = @project.tickets.find(params[:id]) \n        end\n\nend\n</code></pre>\n\n<p><strong>show.html.erb - Ticket</strong></p>\n\n<pre><code>&lt;h1&gt;&lt;%= @project.title %&gt;&lt;/h1&gt;\n\n&lt;h3&gt;&lt;%= @ticket.title %&gt;&lt;/h3&gt;\n\n&lt;%= link_to \"All Projects\", projects_path %&gt;\n\n&lt;%= link_to \"Edit Ticket\", edit_project_ticket_path %&gt;\n</code></pre>\n\n<p><strong>_form.html.erb - Ticket</strong></p>\n\n<pre><code>&lt;%= form_for([@project, @project.tickets.build]) do |f| %&gt;\n\n    &lt;p&gt;\n        &lt;%= f.label :title %&gt;&lt;br/&gt;\n        &lt;%= f.text_field :title %&gt;\n    &lt;/p&gt;\n\n    &lt;p&gt;\n        &lt;%= f.label :description %&gt;&lt;br /&gt;\n        &lt;%= f.text_area :description %&gt;\n    &lt;/p&gt;\n\n    &lt;p&gt;\n        &lt;%= f.submit %&gt;\n    &lt;/p&gt;\n\n&lt;% end %&gt;\n</code></pre>\n\n<p><strong>EDIT, I've updated the _form.html.erb to the following code beneath, and it seems to work, ie, it shows the contents to modify. Yay. But when I click on <code>Update Ticket</code> button, it doesn't move beyond the page.</strong> </p>\n\n<pre><code>&lt;%= form_for [@project,@ticket] do |f| %&gt;\n</code></pre>\n\n<p><strong>EDIT AGAIN</strong></p>\n\n<p>I updated the ticket's controller actions for <code>Show</code> and <code>Update</code>, and now it seems to work! Including it for feedback in case this was done incorrectly. </p>\n\n<pre><code>class TicketsController &lt; ApplicationController\n\n    #which actions are necessary? learn how to not need set_project set_ticket\n    before_action :set_project\n    before_action :set_ticket, only: [:show, :edit, :update, :destroy]\n\n    def create \n        @ticket = @project.tickets.build(ticket_params) \n\n        if @ticket.save\n            flash[:notice] = \"Ticket has been created.\" \n            redirect_to project_path(@project)\n        else\n            flash.now[:alert] = \"Ticket has not been created.\"\n            render \"new\"\n        end\n    end \n\n    def new \n        @ticket = @project.tickets.build\n    end\n\n    def show\n        @ticket = @project.tickets.find(params[:id]) \n    end\n\n    def edit \n        @ticket = @project.tickets.find(params[:id]) \n    end\n\ndef update\n  if @ticket.update(ticket_params)\n    flash[:notice] = \"Ticket has been updated.\"\n    redirect_to [@project, @ticket]\n  else\n    flash.now[:alert] = \"Ticket has not been updated.\"\n    render \"edit\"\n  end\nend\n\n    def destroy\n    end\n\n\n    private \n\n        def ticket_params\n            params.require(:ticket).permit(:title, :description)\n        end\n\n        def set_project \n            @project = Project.find(params[:project_id])\n        end\n\n        def set_ticket \n            @ticket = @project.tickets.find(params[:id]) \n        end\n\nend\n</code></pre>\n"}, {"tags": ["ruby", "cucumber", "watir"], "comments": [{"owner": {"reputation": 418, "user_id": 6331585, "user_type": "registered", "accept_rate": 60, "profile_image": "https://lh5.googleusercontent.com/--Spi1QdCgC0/AAAAAAAAAAI/AAAAAAAABnU/sJNL2oLTBHY/photo.jpg?sz=128", "display_name": "Vishwas Nahar", "link": "https://stackoverflow.com/users/6331585/vishwas-nahar"}, "edited": false, "score": 0, "creation_date": 1492623335, "post_id": 43502391, "comment_id": 74059314, "body": "It is not clear, can you describe more"}, {"owner": {"reputation": 15, "user_id": 6145638, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/999cb6d4e796365091f111dbf4a33407?s=128&d=identicon&r=PG", "display_name": "Bhuvana", "link": "https://stackoverflow.com/users/6145638/bhuvana"}, "reply_to_user": {"reputation": 418, "user_id": 6331585, "user_type": "registered", "accept_rate": 60, "profile_image": "https://lh5.googleusercontent.com/--Spi1QdCgC0/AAAAAAAAAAI/AAAAAAAABnU/sJNL2oLTBHY/photo.jpg?sz=128", "display_name": "Vishwas Nahar", "link": "https://stackoverflow.com/users/6331585/vishwas-nahar"}, "edited": false, "score": 0, "creation_date": 1492623708, "post_id": 43502391, "comment_id": 74059570, "body": "So there are 5 links on a page. All 5 have similar source code. I am trying to click each one of them and able to do only the first one, even though I call the other 4 the same way. The first link is visible on the page as &#39;Rapid Alignment&#39; and this code works to locate that link -@browser.div(class:&#39;ms-vb itx&#39;).link(:text =&gt;&#39;Rapid Alignment&#39;).click. The second link is visible on the page as &#39;Design Develop Integrate and Test&#39; and this code does not work to locate it -@browser.div(class:&#39;ms-vb itx&#39;).link(:text =&gt;&#39;Design Develop Integrate and Test&#39;).click"}, {"owner": {"reputation": 5134, "user_id": 1672197, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i8HkV.png?s=128&g=1", "display_name": "orde", "link": "https://stackoverflow.com/users/1672197/orde"}, "edited": false, "score": 0, "creation_date": 1492623734, "post_id": 43502391, "comment_id": 74059591, "body": "What do you mean by &quot;does not work&quot;?  Silently fails?  Throws an <code>unable to locate element</code> error?  Without the associated HTML, it&#39;s just speculation.  Please edit the question and include the HTML."}, {"owner": {"reputation": 15, "user_id": 6145638, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/999cb6d4e796365091f111dbf4a33407?s=128&d=identicon&r=PG", "display_name": "Bhuvana", "link": "https://stackoverflow.com/users/6145638/bhuvana"}, "edited": false, "score": 0, "creation_date": 1492623825, "post_id": 43502391, "comment_id": 74059658, "body": "Yes Throws an unable to locate element error"}, {"owner": {"reputation": 15, "user_id": 6145638, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/999cb6d4e796365091f111dbf4a33407?s=128&d=identicon&r=PG", "display_name": "Bhuvana", "link": "https://stackoverflow.com/users/6145638/bhuvana"}, "edited": false, "score": 0, "creation_date": 1492623989, "post_id": 43502391, "comment_id": 74059764, "body": "HTML of the first link that works &lt;div class=&quot;ms-vb itx&quot; onmouseover=&quot;OnItem(this)&quot; CTXName=&quot;ctx586&quot; id=&quot;1&quot; Field=&quot;LinkTitle&quot; Perm=&quot;0xb008031061&quot; EventType=&quot;&quot;&gt;&lt;a onfocus=&quot;OnLink(this)&quot; href=&quot;<a href=\"https://asdm.nwie.net/_layouts/15/listform.aspx?PageType=4&amp;amp;ListId=%7B498507E1%2D9E59%2D40CB%2D882F%2D29589F70D58E%7D&amp;amp;ID=1&amp;amp;ContentTypeID=0x0100223D60E8C5C0184998F45999F450A3A5\" rel=\"nofollow noreferrer\">asdm.nwie.net/_layouts/15/&hellip;</a>&quot; onclick=&quot;EditLink2(this,586);return false;&quot; target=&quot;_self&quot;&gt;Rapid Alignment&lt;/a&gt;&lt;/div&gt;"}, {"owner": {"reputation": 15, "user_id": 6145638, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/999cb6d4e796365091f111dbf4a33407?s=128&d=identicon&r=PG", "display_name": "Bhuvana", "link": "https://stackoverflow.com/users/6145638/bhuvana"}, "edited": false, "score": 0, "creation_date": 1492624027, "post_id": 43502391, "comment_id": 74059787, "body": "HTML of the second link that does not get located &lt;div class=&quot;ms-vb itx&quot; onmouseover=&quot;OnItem(this)&quot; CTXName=&quot;ctx586&quot; id=&quot;3&quot; Field=&quot;LinkTitle&quot; Perm=&quot;0xb008031061&quot; EventType=&quot;&quot;&gt;&lt;a onfocus=&quot;OnLink(this)&quot; href=&quot;<a href=\"https://asdm.nwie.net/_layouts/15/listform.aspx?PageType=4&amp;amp;ListId=%7B498507E1%2D9E59%2D40CB%2D882F%2D29589F70D58E%7D&amp;amp;ID=3&amp;amp;ContentTypeID=0x0100223D60E8C5C0184998F45999F450A3A5\" rel=\"nofollow noreferrer\">asdm.nwie.net/_layouts/15/&hellip;</a>&quot; onclick=&quot;EditLink2(this,586);return false;&quot; target=&quot;_self&quot;&gt;Design Develop Integrate and Test&lt;/a&gt;&lt;/div&gt;"}, {"owner": {"reputation": 15, "user_id": 6145638, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/999cb6d4e796365091f111dbf4a33407?s=128&d=identicon&r=PG", "display_name": "Bhuvana", "link": "https://stackoverflow.com/users/6145638/bhuvana"}, "reply_to_user": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1492624297, "post_id": 43502391, "comment_id": 74059969, "body": "@engineersmnky I have tried locating just the second one alone too. It does not locate it."}, {"owner": {"reputation": 798, "user_id": 4091011, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/f05f3852947f6076f3ad900ec0dac603?s=128&d=identicon&r=PG&f=1", "display_name": "RAJ", "link": "https://stackoverflow.com/users/4091011/raj"}, "edited": false, "score": 0, "creation_date": 1492625939, "post_id": 43502391, "comment_id": 74060972, "body": "@Bhuvana Please read my answer below, all you need is link text, nothing else, your code fails because every time it looks into the first division."}, {"owner": {"reputation": 15, "user_id": 6145638, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/999cb6d4e796365091f111dbf4a33407?s=128&d=identicon&r=PG", "display_name": "Bhuvana", "link": "https://stackoverflow.com/users/6145638/bhuvana"}, "reply_to_user": {"reputation": 798, "user_id": 4091011, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/f05f3852947f6076f3ad900ec0dac603?s=128&d=identicon&r=PG&f=1", "display_name": "RAJ", "link": "https://stackoverflow.com/users/4091011/raj"}, "edited": false, "score": 0, "creation_date": 1492626117, "post_id": 43502391, "comment_id": 74061084, "body": "@RAJ, thanks for your help, but just using link text, was not locating the element."}, {"owner": {"reputation": 798, "user_id": 4091011, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/f05f3852947f6076f3ad900ec0dac603?s=128&d=identicon&r=PG&f=1", "display_name": "RAJ", "link": "https://stackoverflow.com/users/4091011/raj"}, "edited": false, "score": 0, "creation_date": 1492627016, "post_id": 43502391, "comment_id": 74061606, "body": "@Bhuvana It&#39;s because more than one link present and some of them were hidden so it tries to interact the first one so it gives you the error that it&#39;s not visible, I have updated my answer, you can try that one and let me know. I have included the visible locator now."}, {"owner": {"reputation": 798, "user_id": 4091011, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/f05f3852947f6076f3ad900ec0dac603?s=128&d=identicon&r=PG&f=1", "display_name": "RAJ", "link": "https://stackoverflow.com/users/4091011/raj"}, "edited": false, "score": 0, "creation_date": 1492627140, "post_id": 43502391, "comment_id": 74061683, "body": "@Bhuvana See the updated answer with visible locators, you don&#39;t have to bother about the index!"}], "answers": [{"comments": [{"owner": {"reputation": 798, "user_id": 4091011, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/f05f3852947f6076f3ad900ec0dac603?s=128&d=identicon&r=PG&f=1", "display_name": "RAJ", "link": "https://stackoverflow.com/users/4091011/raj"}, "edited": false, "score": 0, "creation_date": 1492625837, "post_id": 43502935, "comment_id": 74060908, "body": "Your code will fail if any of the division doesn&#39;t have the link and your last code is not even an expected answer, she doesn&#39;t want to select a link which has the text of Rapid alignment, she wants to click all the link."}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "reply_to_user": {"reputation": 798, "user_id": 4091011, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/f05f3852947f6076f3ad900ec0dac603?s=128&d=identicon&r=PG&f=1", "display_name": "RAJ", "link": "https://stackoverflow.com/users/4091011/raj"}, "edited": false, "score": 1, "creation_date": 1492626232, "post_id": 43502935, "comment_id": 74061146, "body": "@RAJ this was an example of how to facilitate the question. the assumption is that <code>ms-vb itx</code> is a link wrapper and based on the HTML posted this appears to be the case. As for <code>select</code> it was an example on how to filter out the desired link from the <code>DivCollection</code>. P.S. your code will not work either (those in glass houses)"}], "tags": [], "owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "is_accepted": false, "score": 1, "last_activity_date": 1492624688, "creation_date": 1492624688, "answer_id": 43502935, "question_id": 43502391, "link": "https://stackoverflow.com/questions/43502391/how-to-locating-similar-html-elements-in-watir-using-ruby/43502935#43502935", "title": "How to locating similar HTML elements in Watir using Ruby", "body": "<p>I think the issue is the use of <code>#div</code> which will return a single div</p>\n\n<p>Try this instead</p>\n\n<pre><code>divs = @browser.divs(class:'ms-vb itx')\n</code></pre>\n\n<p>Then </p>\n\n<pre><code>divs.each do |d|\n  d.link.click\nend\n</code></pre>\n\n<p><code>#divs</code> returns a <code>DivCollection</code> which includes <code>Enumerable</code> so all <code>Enumerable</code> methods will work as well including things like <code>select</code> e.g.</p>\n\n<pre><code>divs.select { |d| d.link(:text =&gt;'Rapid Alignment') }\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 15, "user_id": 6145638, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/999cb6d4e796365091f111dbf4a33407?s=128&d=identicon&r=PG", "display_name": "Bhuvana", "link": "https://stackoverflow.com/users/6145638/bhuvana"}, "edited": false, "score": 0, "creation_date": 1492626016, "post_id": 43503098, "comment_id": 74061024, "body": "without the index, it spit the error unable to locate the error. Thanks."}, {"owner": {"reputation": 798, "user_id": 4091011, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/f05f3852947f6076f3ad900ec0dac603?s=128&d=identicon&r=PG&f=1", "display_name": "RAJ", "link": "https://stackoverflow.com/users/4091011/raj"}, "reply_to_user": {"reputation": 15, "user_id": 6145638, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/999cb6d4e796365091f111dbf4a33407?s=128&d=identicon&r=PG", "display_name": "Bhuvana", "link": "https://stackoverflow.com/users/6145638/bhuvana"}, "edited": false, "score": 0, "creation_date": 1492626144, "post_id": 43503098, "comment_id": 74061097, "body": "@Bhuvana you don&#39;t need any index as long as your link text is unique. simply try writing <code>b.a(:text,&#39;Rapid Alignment&#39;).click</code> it will surely work."}, {"owner": {"reputation": 15, "user_id": 6145638, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/999cb6d4e796365091f111dbf4a33407?s=128&d=identicon&r=PG", "display_name": "Bhuvana", "link": "https://stackoverflow.com/users/6145638/bhuvana"}, "edited": false, "score": 0, "creation_date": 1492626515, "post_id": 43503098, "comment_id": 74061300, "body": "@Raj, it is not working. Gives the error Element is not currently visible and so may not be interacted with."}, {"owner": {"reputation": 798, "user_id": 4091011, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/f05f3852947f6076f3ad900ec0dac603?s=128&d=identicon&r=PG&f=1", "display_name": "RAJ", "link": "https://stackoverflow.com/users/4091011/raj"}, "reply_to_user": {"reputation": 15, "user_id": 6145638, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/999cb6d4e796365091f111dbf4a33407?s=128&d=identicon&r=PG", "display_name": "Bhuvana", "link": "https://stackoverflow.com/users/6145638/bhuvana"}, "edited": false, "score": 0, "creation_date": 1492626842, "post_id": 43503098, "comment_id": 74061496, "body": "@Bhuvana Okay, then more than one link present I guess, So you use this code <code>b.link(:text=&gt;&#39;Rapid Alignment&#39;,:visible=&gt;true).click</code>"}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1492627483, "post_id": 43503098, "comment_id": 74061880, "body": "@RAJ if both were to be visible then you would be clicking the first one"}, {"owner": {"reputation": 15, "user_id": 6145638, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/999cb6d4e796365091f111dbf4a33407?s=128&d=identicon&r=PG", "display_name": "Bhuvana", "link": "https://stackoverflow.com/users/6145638/bhuvana"}, "edited": false, "score": 0, "creation_date": 1492627587, "post_id": 43503098, "comment_id": 74061953, "body": "@Raj, it resulted in TypeError: expected one of [String, Regexp], got true:TrueClass"}, {"owner": {"reputation": 286, "user_id": 6349403, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/ce09db1dc600f8c20326e791aa8e0e6c?s=128&d=identicon&r=PG&f=1", "display_name": "Gopal", "link": "https://stackoverflow.com/users/6349403/gopal"}, "reply_to_user": {"reputation": 15, "user_id": 6145638, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/999cb6d4e796365091f111dbf4a33407?s=128&d=identicon&r=PG", "display_name": "Bhuvana", "link": "https://stackoverflow.com/users/6145638/bhuvana"}, "edited": false, "score": 0, "creation_date": 1492628113, "post_id": 43503098, "comment_id": 74062262, "body": "@Bhuvana Did you use the colon before :visible ?"}, {"owner": {"reputation": 286, "user_id": 6349403, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/ce09db1dc600f8c20326e791aa8e0e6c?s=128&d=identicon&r=PG&f=1", "display_name": "Gopal", "link": "https://stackoverflow.com/users/6349403/gopal"}, "reply_to_user": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1492628184, "post_id": 43503098, "comment_id": 74062298, "body": "@engineersmnky no link text itself is the identification."}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "reply_to_user": {"reputation": 286, "user_id": 6349403, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/ce09db1dc600f8c20326e791aa8e0e6c?s=128&d=identicon&r=PG&f=1", "display_name": "Gopal", "link": "https://stackoverflow.com/users/6349403/gopal"}, "edited": false, "score": 0, "creation_date": 1492628264, "post_id": 43503098, "comment_id": 74062338, "body": "@Gopal there are 2 links with this text thus the error reported above. Plus one should never rely on the uniqueness of link text what if I had one in the navigation bar and one in the footer? As for your comment about visible it is expecting <code>&quot;true&quot;</code> not <code>true</code> <a href=\"https://github.com/watir/watir/blob/master/lib/watir/elements/select.rb#L120\" rel=\"nofollow noreferrer\">Source Reference</a> in HTML <code>visible=&quot;true&quot;</code> not <code>visible=true</code>"}, {"owner": {"reputation": 286, "user_id": 6349403, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/ce09db1dc600f8c20326e791aa8e0e6c?s=128&d=identicon&r=PG&f=1", "display_name": "Gopal", "link": "https://stackoverflow.com/users/6349403/gopal"}, "reply_to_user": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1492628790, "post_id": 43503098, "comment_id": 74062632, "body": "@engineersmnky please read here <a href=\"http://watir.github.io/watir-6-1/\" rel=\"nofollow noreferrer\">watir.github.io/watir-6-1</a> I have posted code after execution, it works fine for me"}, {"owner": {"reputation": 286, "user_id": 6349403, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/ce09db1dc600f8c20326e791aa8e0e6c?s=128&d=identicon&r=PG&f=1", "display_name": "Gopal", "link": "https://stackoverflow.com/users/6349403/gopal"}, "reply_to_user": {"reputation": 15, "user_id": 6145638, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/999cb6d4e796365091f111dbf4a33407?s=128&d=identicon&r=PG", "display_name": "Bhuvana", "link": "https://stackoverflow.com/users/6145638/bhuvana"}, "edited": false, "score": 0, "creation_date": 1492628923, "post_id": 43503098, "comment_id": 74062705, "body": "@Bhuvana please read here to know how to use visible locators <a href=\"http://watir.github.io/watir-6-1/\" rel=\"nofollow noreferrer\">watir.github.io/watir-6-1</a>"}], "tags": [], "owner": {"reputation": 798, "user_id": 4091011, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/f05f3852947f6076f3ad900ec0dac603?s=128&d=identicon&r=PG&f=1", "display_name": "RAJ", "link": "https://stackoverflow.com/users/4091011/raj"}, "is_accepted": false, "score": 0, "last_activity_date": 1492626947, "last_edit_date": 1492626947, "creation_date": 1492625234, "answer_id": 43503098, "question_id": 43502391, "link": "https://stackoverflow.com/questions/43502391/how-to-locating-similar-html-elements-in-watir-using-ruby/43503098#43503098", "title": "How to locating similar HTML elements in Watir using Ruby", "body": "<p>This fails because div is same so it tries to locate the same div everytime and starts to search the given link, So it fails second time when you tries to locate the different link.</p>\n\n<p>Actually you do not need of div to locate that link, you simply write this code it will work</p>\n\n<pre><code>b.link(:text=&gt;'Rapid Alignment',:visible=&gt;true).click\n\nb.link(:text=&gt;'Design Develop Integrate and Test',:visible=&gt;true).click\n</code></pre>\n\n<p>That link text itself is the identification to that link, So you do not need of any division, directly write b.link(), it's enough. </p>\n"}, {"comments": [{"owner": {"reputation": 798, "user_id": 4091011, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/f05f3852947f6076f3ad900ec0dac603?s=128&d=identicon&r=PG&f=1", "display_name": "RAJ", "link": "https://stackoverflow.com/users/4091011/raj"}, "edited": false, "score": 0, "creation_date": 1492625553, "post_id": 43503113, "comment_id": 74060737, "body": "This is completely unnecessary because link text itself is enough to identify the link."}, {"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 0, "creation_date": 1492631112, "post_id": 43503113, "comment_id": 74064080, "body": "&quot;You should consider locating using the id attributes, which should be unique.&quot; IDs <i>must</i> be unique according to the spec."}], "tags": [], "owner": {"reputation": 5134, "user_id": 1672197, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i8HkV.png?s=128&g=1", "display_name": "orde", "link": "https://stackoverflow.com/users/1672197/orde"}, "is_accepted": true, "score": 0, "last_activity_date": 1492648272, "last_edit_date": 1492648272, "creation_date": 1492625262, "answer_id": 43503113, "question_id": 43502391, "link": "https://stackoverflow.com/questions/43502391/how-to-locating-similar-html-elements-in-watir-using-ruby/43503113#43503113", "title": "How to locating similar HTML elements in Watir using Ruby", "body": "<p>You'll have to specify which <code>&lt;div&gt;</code> you are targeting.  There are two or possibly more <code>&lt;div&gt;</code> tags with the same <code>class</code> attribute.</p>\n\n<p>Given this HTML snippet:</p>\n\n<pre><code>&lt;div class=\"ms-vb itx\" onmouseover=\"OnItem(this)\" CTXName=\"ctx586\" id=\"1\" Field=\"LinkTitle\" Perm=\"0xb008031061\" EventType=\"\"&gt;&lt;a onfocus=\"OnLink(this)\" href=\"asdm.nwie.net/_layouts/15/\u2026\" onclick=\"EditLink2(this,586);return false;\" target=\"_self\"&gt;Rapid Alignment&lt;/a&gt;&lt;/div&gt; \n\n&lt;div class=\"ms-vb itx\" onmouseover=\"OnItem(this)\" CTXName=\"ctx586\" id=\"3\" Field=\"LinkTitle\" Perm=\"0xb008031061\" EventType=\"\"&gt;&lt;a onfocus=\"OnLink(this)\" href=\"asdm.nwie.net/_layouts/15/\u2026\" onclick=\"EditLink2(this,586);return false;\" target=\"_self\"&gt;Design Develop Integrate and Test&lt;/a&gt;&lt;/div&gt;\n</code></pre>\n\n<p>You need to target the appropriate <code>&lt;div&gt;</code> by supplying the index in the locator:</p>\n\n<pre><code>p b.div(:class =&gt; 'ms-vb itx').link(:text =&gt; 'Rapid Alignment').exists?\n#=&gt; true\np b.div(:class =&gt; 'ms-vb itx').link(:text =&gt; 'Design Develop Integrate and Test').exists?\n#=&gt; false\np b.div(:class =&gt; 'ms-vb itx', :index =&gt; 1).link(:text =&gt; 'Design Develop Integrate and Test').exists?\n#=&gt; true\n</code></pre>\n\n<p>But locating elements by index can be fragile if and when UI elements change.  You should consider locating using the <code>id</code> attributes, which--according to <a href=\"https://www.w3.org/TR/2011/WD-html5-20110525/elements.html#the-id-attribute\" rel=\"nofollow noreferrer\">spec</a>--are unique.</p>\n"}], "owner": {"reputation": 15, "user_id": 6145638, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/999cb6d4e796365091f111dbf4a33407?s=128&d=identicon&r=PG", "display_name": "Bhuvana", "link": "https://stackoverflow.com/users/6145638/bhuvana"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 253, "favorite_count": 0, "accepted_answer_id": 43503113, "answer_count": 3, "score": 0, "last_activity_date": 1492648272, "creation_date": 1492622921, "last_edit_date": 1492630992, "question_id": 43502391, "link": "https://stackoverflow.com/questions/43502391/how-to-locating-similar-html-elements-in-watir-using-ruby", "title": "How to locating similar HTML elements in Watir using Ruby", "body": "<p>I am trying to click links on a page and able to do only the first one. There are four more having similar code, but it says it cannot locate the other four. </p>\n\n<p>This is the line of code that works:</p>\n\n<pre><code>@browser.div(class:'ms-vb itx').link(:text =&gt;'Rapid Alignment').click \n</code></pre>\n\n<p>This is one of the four that does not work:</p>\n\n<pre><code>@browser.div(class:'ms-vb itx').link(:text =&gt;'Design Develop Integrate and Test').click\n</code></pre>\n\n<p>HTML:</p>\n\n<pre><code>&lt;div class=\"ms-vb itx\" onmouseover=\"OnItem(this)\" CTXName=\"ctx586\" id=\"1\" Field=\"LinkTitle\" Perm=\"0xb008031061\" EventType=\"\"&gt;&lt;a onfocus=\"OnLink(this)\" href=\"asdm.nwie.net/_layouts/15/\u2026; onclick=\"EditLink2(this,586);return false;\" target=\"_self\"&gt;Rapid Alignment&lt;/a&gt;&lt;/div&gt;\n\n&lt;div class=\"ms-vb itx\" onmouseover=\"OnItem(this)\" CTXName=\"ctx586\" id=\"3\" Field=\"LinkTitle\" Perm=\"0xb008031061\" EventType=\"\"&gt;&lt;a onfocus=\"OnLink(this)\" href=\"asdm.nwie.net/_layouts/15/\u2026; onclick=\"EditLink2(this,586);return false;\" target=\"_self\"&gt;Design Develop Integrate and Test&lt;/a&gt;&lt;/div&gt;\n</code></pre>\n"}, {"tags": ["javascript", "ruby", "ajax", "sinatra"], "comments": [{"owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 0, "creation_date": 1492622061, "post_id": 43501961, "comment_id": 74058572, "body": "can you use <code>puts params</code> to see whether or not the name is present?"}, {"owner": {"reputation": 154, "user_id": 7887886, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/fef2abd4b1a921dd0e1ebbac5ee36dda?s=128&d=identicon&r=PG&f=1", "display_name": "zzero", "link": "https://stackoverflow.com/users/7887886/zzero"}, "reply_to_user": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 0, "creation_date": 1492622176, "post_id": 43501961, "comment_id": 74058652, "body": "yes i see in console {&quot;salutation&quot;=&gt;&quot;2&quot;, &quot;name&quot;=&gt;&quot;Friend&quot;}"}], "answers": [{"tags": [], "owner": {"reputation": 154, "user_id": 7887886, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/fef2abd4b1a921dd0e1ebbac5ee36dda?s=128&d=identicon&r=PG&f=1", "display_name": "zzero", "link": "https://stackoverflow.com/users/7887886/zzero"}, "is_accepted": true, "score": 0, "last_activity_date": 1492752507, "creation_date": 1492752507, "answer_id": 43534578, "question_id": 43501961, "link": "https://stackoverflow.com/questions/43501961/sinatra-output-params-to-text-file/43534578#43534578", "title": "sinatra output params to text file?", "body": "<p>I solved with this</p>\n\n<pre><code>f = File.open('text.txt', 'w')\n\nold_out = $stdout\n$stdout = f\n\n  puts   params[:salutation] \nf.close\n\n$stdout = old_out\nputs 'goodbye'\n</code></pre>\n"}], "owner": {"reputation": 154, "user_id": 7887886, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/fef2abd4b1a921dd0e1ebbac5ee36dda?s=128&d=identicon&r=PG&f=1", "display_name": "zzero", "link": "https://stackoverflow.com/users/7887886/zzero"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 118, "favorite_count": 0, "accepted_answer_id": 43534578, "answer_count": 1, "score": 0, "last_activity_date": 1492752507, "creation_date": 1492621588, "question_id": 43501961, "link": "https://stackoverflow.com/questions/43501961/sinatra-output-params-to-text-file", "title": "sinatra output params to text file?", "body": "<p>Im trying to use this code for output ajax paramas to text file but dont work</p>\n\n<p>I dont know because its not working</p>\n\n<p>I am using this  code for print parameters</p>\n\n<p>f.write params[:name]</p>\n\n<pre><code>require 'sinatra'\nrequire 'pp'\n\nget '/' do\n  erb :index\nend\n\n\n\nget '/2' do\n  content_type 'text/javascript'\n  File.read(File.join('public', 'jquery-1.7.1.js'))\n\nend\n\n\npost '/greeting' do\n  puts \"params\"\n  #pp params\n\n  \"&lt;p&gt;#{params[:salutation]}, #{params[:name]}&lt;/p&gt;\"\nend\n\n\npost '/greeting' do\n   puts \"params\"\n  #pp params\n  File.read(File.join('public', 'name_of_the_file.txt'))\n  File.open('name_of_the_file.txt', 'w') do |f|\n    f.write params[:name]\n  end\nend\n</code></pre>\n\n<p>zz</p>\n\n<pre><code>&lt;html&gt;\n  &lt;head&gt;\n    &lt;script src=\"/2\"&gt;&lt;/script&gt;\n    &lt;script type=\"text/javascript\"&gt;\n      $(document).ready(function() {\nax=2;\n$('body').on(\"click   reset\",function(e){  ax= e.target.value ; }); \nax=2;\n        $.post(\"greeting\", { salutation:  ax, name: \"Friend\" },\n          function(result) { $(\"#greeting\").html(result);\n        });\n      });\n    &lt;/script&gt;\n  &lt;/head&gt;\n  &lt;body&gt;\n    &lt;h1&gt;Sinatra Ajax Demo using jQuery&lt;/h1&gt;\n&lt;label for=\"male\"&gt;Male&lt;/label&gt;\n  &lt;input type=\"radio\" name=\"gender\" id=\"male\" value=\"male\"&gt;&lt;br&gt;\n  &lt;label for=\"female\"&gt;Female&lt;/label&gt;\n  &lt;input type=\"radio\" name=\"gender\" id=\"female\" value=\"female\"&gt;&lt;br&gt;\n  &lt;label for=\"other\"&gt;Other&lt;/label&gt;\n  &lt;input type=\"radio\" name=\"gender\" id=\"other\" value=\"other\"&gt;&lt;br&gt;&lt;br&gt;\n  &lt;input type=\"submit\" value=\"Submit\"&gt;\n    &lt;div id=\"greeting\"&gt;\n      &lt;p&gt;Hello, World&lt;/p&gt;\n    &lt;/div&gt;\n  &lt;/body&gt;\n&lt;/html&gt;\n</code></pre>\n\n<p>PLease help me to solve this question</p>\n"}, {"tags": ["ruby", "ruby-on-rails-4"], "comments": [{"owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 1, "creation_date": 1492620384, "post_id": 43501336, "comment_id": 74057430, "body": "Why don&#39;t you follow Rails conventions? Using uppercase table and column names doesn&#39;t allow you to use Rails&#39; magic and will make everything much harder."}], "answers": [{"comments": [{"owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 1, "creation_date": 1492620308, "post_id": 43501400, "comment_id": 74057387, "body": "I am not sure if this will work. It seems like the OP uses uppercase column names."}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "reply_to_user": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 1, "creation_date": 1492621842, "post_id": 43501400, "comment_id": 74058439, "body": "@spickermann depends on the adapter used and/or the database itself. I know <code>sql-server</code> adapter has an option for <code>reflect_lowercase_schema</code> which is handled appropriately (for method naming e.g. ` def State` becomes <code>def state</code> when set to <code>true</code>) . As for the database I know ms-sql doesn&#39;t care about case, mySQL has an option to enable/disable, this feature and I have not come across a time where postgresql cares (can&#39;t speak for any others as I haven&#39;t used them). @marmeladze maybe change the name to <code>:flagged_californians</code> :)"}, {"owner": {"reputation": 5483, "user_id": 4481312, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/teLso.jpg?s=128&g=1", "display_name": "marmeladze", "link": "https://stackoverflow.com/users/4481312/marmeladze"}, "edited": false, "score": 0, "creation_date": 1492625749, "post_id": 43501400, "comment_id": 74060856, "body": "yeah, that&#39;s better -))"}, {"owner": {"reputation": 5483, "user_id": 4481312, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/teLso.jpg?s=128&g=1", "display_name": "marmeladze", "link": "https://stackoverflow.com/users/4481312/marmeladze"}, "reply_to_user": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 0, "creation_date": 1492625858, "post_id": 43501400, "comment_id": 74060925, "body": "@spickermann i&#39;ve just shown how it should be written, and assume that the question owner knows how he/she will be able to fix it to work correct way."}], "tags": [], "owner": {"reputation": 5483, "user_id": 4481312, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/teLso.jpg?s=128&g=1", "display_name": "marmeladze", "link": "https://stackoverflow.com/users/4481312/marmeladze"}, "is_accepted": false, "score": 0, "last_activity_date": 1492625733, "last_edit_date": 1492625733, "creation_date": 1492619801, "answer_id": 43501400, "question_id": 43501336, "link": "https://stackoverflow.com/questions/43501336/how-to-write-a-scope-for-where-conditions-in-model/43501400#43501400", "title": "how to write a scope for where conditions in model", "body": "<p>not exactly like below, but should belike that. </p>\n\n<pre><code>  scope :customers_from_california, -&gt; { where(state: \"California\") }\n  scope :having_status_flag, -&gt; { where(flag: \"Y\") }\n</code></pre>\n\n<p>you can also join them like, </p>\n\n<pre><code>  scope :flagged_californians, -&gt;{customers_from_california.where(flag: \"Y\")}\n</code></pre>\n\n<p>p.s. i know naming sucks -))</p>\n"}], "owner": {"reputation": 55, "user_id": 7062008, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/8acb00bd1a8aca08a88885857f4371cc?s=128&d=identicon&r=PG&f=1", "display_name": "user938438932", "link": "https://stackoverflow.com/users/7062008/user938438932"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 35, "favorite_count": 0, "answer_count": 1, "score": -3, "last_activity_date": 1492625733, "creation_date": 1492619564, "question_id": 43501336, "link": "https://stackoverflow.com/questions/43501336/how-to-write-a-scope-for-where-conditions-in-model", "title": "how to write a scope for where conditions in model", "body": "<p>I have following model </p>\n\n<pre><code>class Customer\n  class CustomerUsage &lt; ActiveRecord::Base\n\n    self.table_name = 'vCustomerDetails'\n\n  end\nend\n</code></pre>\n\n<p>How do i write scope for <code>where vCustomerDetails.State = 'California' and vCustomerDetails.Statusflag = 'Y'</code> ?</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 0, "creation_date": 1492620563, "post_id": 43501291, "comment_id": 74057554, "body": "How many ids are there in the constant? What is the size of the object array? Using a <code>Set</code> instead of an array might improve the performance a lot."}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 1, "creation_date": 1492622396, "post_id": 43501291, "comment_id": 74058808, "body": "Is there a reason this cannot be a query parameter? something like <code>scope :in_constant_array, -&gt; { where( object_type_id: Constant::SOME_IDS)}</code> then you can leverage SQL to do the lifting rather than in mem"}, {"owner": {"reputation": 1849, "user_id": 3437721, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/3e6fac72d7b35f2177b6f56eab43db28?s=128&d=identicon&r=PG&f=1", "display_name": "user3437721", "link": "https://stackoverflow.com/users/3437721/user3437721"}, "edited": false, "score": 0, "creation_date": 1492637623, "post_id": 43501291, "comment_id": 74067631, "body": "There is only a dozen or so IDs in the constant.."}], "answers": [{"tags": [], "owner": {"reputation": 18856, "user_id": 1359650, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/dffc4318ac93e728a26c8e8b51b4eb37?s=128&d=identicon&r=PG", "display_name": "jvillian", "link": "https://stackoverflow.com/users/1359650/jvillian"}, "is_accepted": false, "score": 0, "last_activity_date": 1492619993, "creation_date": 1492619993, "answer_id": 43501452, "question_id": 43501291, "link": "https://stackoverflow.com/questions/43501291/comparing-a-constant-array-with-object-array/43501452#43501452", "title": "Comparing a constant array with object array", "body": "<p>Use <code>select</code> instead of <code>collect</code>. </p>\n\n<p><code>collect</code> is returning the result of the evaluation (<code>true</code> or <code>false</code>). <code>select</code> will return the objects.</p>\n\n<p>This <a href=\"http://jacopretorius.net/2012/01/ruby-map-collect-and-select.html\" rel=\"nofollow noreferrer\">article</a> may be of use.</p>\n"}, {"tags": [], "owner": {"reputation": 67463, "user_id": 203130, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/1RE8c.jpg?s=128&g=1", "display_name": "coreyward", "link": "https://stackoverflow.com/users/203130/coreyward"}, "is_accepted": true, "score": 3, "last_activity_date": 1492620086, "creation_date": 1492620086, "answer_id": 43501489, "question_id": 43501291, "link": "https://stackoverflow.com/questions/43501291/comparing-a-constant-array-with-object-array/43501489#43501489", "title": "Comparing a constant array with object array", "body": "<p>You don't want to do a <code>collect</code> (aka <code>map</code>), which returns the result of the block. You want to return the object in the collection based on the result of the block. For that, there's <a href=\"https://ruby-doc.org/core/Array.html#method-i-select\" rel=\"nofollow noreferrer\">select</a>:</p>\n\n<pre><code>some_object_attributes.select do |attr| \n  Constant::SOME_IDS.include? attr.object.object_type_id\nend\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 67463, "user_id": 203130, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/1RE8c.jpg?s=128&g=1", "display_name": "coreyward", "link": "https://stackoverflow.com/users/203130/coreyward"}, "edited": false, "score": 0, "creation_date": 1492623131, "post_id": 43501852, "comment_id": 74059205, "body": "I suck at algorithmic complexity, but doesn&#39;t <code>values_at</code> do a similar thing behind the scenes, iterating and matching? It&#39;s surely faster than doing so in Ruby, but still affects your cost."}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "reply_to_user": {"reputation": 67463, "user_id": 203130, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/1RE8c.jpg?s=128&g=1", "display_name": "coreyward", "link": "https://stackoverflow.com/users/203130/coreyward"}, "edited": false, "score": 0, "creation_date": 1492623487, "post_id": 43501852, "comment_id": 74059438, "body": "@coreyward it looks up the hash, it is promised to be O(1)."}, {"owner": {"reputation": 67463, "user_id": 203130, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/1RE8c.jpg?s=128&g=1", "display_name": "coreyward", "link": "https://stackoverflow.com/users/203130/coreyward"}, "edited": false, "score": 0, "creation_date": 1492623678, "post_id": 43501852, "comment_id": 74059552, "body": "Ohhh that&#39;s right because the hash lookup table is divided by bitwise hashing and the full table isn&#39;t scanned. Awesome."}], "tags": [], "owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "is_accepted": false, "score": 3, "last_activity_date": 1492621215, "creation_date": 1492621215, "answer_id": 43501852, "question_id": 43501291, "link": "https://stackoverflow.com/questions/43501291/comparing-a-constant-array-with-object-array/43501852#43501852", "title": "Comparing a constant array with object array", "body": "<p>Just out of curiosity, for a really huge array that way it might be faster:</p>\n\n<pre><code>some_object_attributes.group_by do |attr|\n  attr.object.object_type_id\nend.values_at(*Constant::SOME_IDS).flatten\n</code></pre>\n\n<p>This is <code>O(N)</code> because it does not look up the <code>Constant::SOME_IDS</code> array for each element.</p>\n"}], "owner": {"reputation": 1849, "user_id": 3437721, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/3e6fac72d7b35f2177b6f56eab43db28?s=128&d=identicon&r=PG&f=1", "display_name": "user3437721", "link": "https://stackoverflow.com/users/3437721/user3437721"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 80, "favorite_count": 0, "accepted_answer_id": 43501489, "answer_count": 3, "score": 0, "last_activity_date": 1492621215, "creation_date": 1492619392, "question_id": 43501291, "link": "https://stackoverflow.com/questions/43501291/comparing-a-constant-array-with-object-array", "title": "Comparing a constant array with object array", "body": "<p>I have a collection of objects with certain attributes.\nI also have a CONSTANT array of ids.</p>\n\n<p>I want to return the whole objects who have an id that exists in the constant array.</p>\n\n<p>This is what I have so far, but it just returns true or false for each, I need it to return an array of all the objects:</p>\n\n<pre><code>some_object_attributes.collect { |attr| (Constant::SOME_IDS.include? attr.object.object_type_id)}\n</code></pre>\n\n<p>How can I return every <code>attr.object</code> which has an ID in the constant array?</p>\n"}, {"tags": ["ruby", "associations", "ruby-on-rails-5"], "comments": [{"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1492623047, "post_id": 43501240, "comment_id": 74059166, "body": "How do you intend to use this? e.g. will it be <code>user = User.first</code> and then <code>user.matchers</code>? if so then the then answer is add this to the <code>User</code> class <code>def matchers; Match.where(first_id: self.id).or(second_id: self.id)</code> if you want eager loading then you need to change the scope to <code>has_many :matchers, -&gt; {joins(&quot;INNER JOIN matches ON users.id IN (matches.first_id, matches.second_id)&quot;)}, class_name: Match</code>. Otherwise a little <code>Arel</code> could make this cleaner. Honestly not sure what this is for but a join table would probably be better something like <code>user_matches</code>."}, {"owner": {"reputation": 845, "user_id": 4077574, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/orn50.png?s=128&g=1", "display_name": "Galaxy", "link": "https://stackoverflow.com/users/4077574/galaxy"}, "reply_to_user": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1492671817, "post_id": 43501240, "comment_id": 74078661, "body": "@engineersmnky By declaring these relationships, I want to gain some extra function from rails for free, like: &#39; user.matchers.create name: &#39;Edw&#39; &#39; to create a user and match it with current user, &#39; user.destroy &#39; to destroy the user and relative mathing ..."}, {"owner": {"reputation": 845, "user_id": 4077574, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/orn50.png?s=128&g=1", "display_name": "Galaxy", "link": "https://stackoverflow.com/users/4077574/galaxy"}, "reply_to_user": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1492671839, "post_id": 43501240, "comment_id": 74078683, "body": "Not sure if it is possible. @engineersmnky"}], "owner": {"reputation": 845, "user_id": 4077574, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/orn50.png?s=128&g=1", "display_name": "Galaxy", "link": "https://stackoverflow.com/users/4077574/galaxy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 31, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1492619251, "creation_date": 1492619251, "question_id": 43501240, "link": "https://stackoverflow.com/questions/43501240/association-through-a-self-join-table", "title": "Association through a self-join table", "body": "<p>Let's say we have a model Match as</p>\n\n<pre><code>class CreateSomething &lt; ActiveRecord::Migration[5.0]\n\n  def change\n    create_table :matches do |t|\n      # a match with 2 user id\n      t.integer :first_id \n      t.integer :second_id\n      t.boolean :active, default: true # is active or not\n    end\n  end\n\n  def change\n    create_table :users do |t|\n      t.string :name\n    end\n  end\n\nend\n</code></pre>\n\n<p>I want User model to access Matching of whose first_id or second_id equals to current user.\nHow could I define such a matching without 'where'?\nHow could I access all the matchers?</p>\n\n<pre><code>class User &lt; ApplicationRecord\n\n  # a example with where\n  has_many :matching,\n           -&gt; { where \"first_id==#{id} OR second_id==#{id}\" },\n           class_name: 'Match'\n\n  has_many :matchers, # then ... how?\n\nend\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "mongodb"], "comments": [{"owner": {"reputation": 394580, "user_id": 479863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ArUCE.jpg?s=128&g=1", "display_name": "mu is too short", "link": "https://stackoverflow.com/users/479863/mu-is-too-short"}, "edited": false, "score": 0, "creation_date": 1492618610, "post_id": 43499860, "comment_id": 74056270, "body": "The <code>mongo_client</code> and <code>collection</code> class methods sort of do accept arguments, they&#39;re just hidden in environment variables (<code>ENV[&#39;MONGO_URL&#39;]</code> and friends). Is that the source of your confusion?"}, {"owner": {"reputation": 1098, "user_id": 2787618, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/1e84d0ff3fb5b879228988358fa3cda1?s=128&d=identicon&r=PG&f=1", "display_name": "leenyburger", "link": "https://stackoverflow.com/users/2787618/leenyburger"}, "reply_to_user": {"reputation": 394580, "user_id": 479863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ArUCE.jpg?s=128&g=1", "display_name": "mu is too short", "link": "https://stackoverflow.com/users/479863/mu-is-too-short"}, "edited": false, "score": 0, "creation_date": 1492786171, "post_id": 43499860, "comment_id": 74143523, "body": "I don&#39;t think so.  self.collection sets collection = &#39;race1&#39;.  Then I&#39;m calling and returning mongo_client(&#39;race1&#39;).  But the database (@@db) set up in mongo_client is Mongo::Client.new(&#39;test&#39;).use(MONGO_URL).  Right?  So how does the &#39;race1&#39; database get loaded?  I don&#39;t see that anywhere in the mongo_client method."}], "owner": {"reputation": 1098, "user_id": 2787618, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/1e84d0ff3fb5b879228988358fa3cda1?s=128&d=identicon&r=PG&f=1", "display_name": "leenyburger", "link": "https://stackoverflow.com/users/2787618/leenyburger"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 111, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1492615230, "creation_date": 1492615230, "question_id": 43499860, "link": "https://stackoverflow.com/questions/43499860/how-does-mongodb-access-collecition-variable-in-ruby", "title": "How does MongoDB access collecition variable in Ruby", "body": "<p>I'm having trouble understanding how the line \n<code>return mongo_client[collection]</code> calls the mongo_client method using the collection variable.  </p>\n\n<p>I can create a new Solution class, which (as I understand) calls the initialize method and creates the @coll variable.  The @coll variable is created by calling self.collection.  In self.collection I return mongo_client[collection].  However, the mongo_client method does not accept any arguments.  And the method seems to be \"hard coded\" to use a specific URL.  How does the collection variable get to the mongo_client method?</p>\n\n<pre><code>  class Solution\n  MONGO_URL='mongodb://localhost:27017'\n  MONGO_DATABASE='test'\n  RACE_COLLECTION='race1'\n\n  # helper function to obtain connection to server and set connection to use specific DB\n  # set environment variables MONGO_URL and MONGO_DATABASE to alternate values if not\n  # using the default.\n  def self.mongo_client\n    url=ENV['MONGO_URL'] ||= MONGO_URL\n    database=ENV['MONGO_DATABASE'] ||= MONGO_DATABASE \n    db = Mongo::Client.new(url)\n    @@db=db.use(database)\n  end\n\n  # helper method to obtain collection used to make race results. set environment\n  # variable RACE_COLLECTION to alternate value if not using the default.\n  def self.collection\n    collection=ENV['RACE_COLLECTION'] ||= RACE_COLLECTION\n    return mongo_client[collection]\n  end\ndef initialize\n    @coll=self.class.collection\n  end\n</code></pre>\n"}, {"tags": ["ruby", "enums"], "comments": [{"owner": {"reputation": 56328, "user_id": 4265352, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-lzAUc5pYb24/AAAAAAAAAAI/AAAAAAAAAGQ/q3h7bZUnqrs/photo.jpg?sz=128", "display_name": "axiac", "link": "https://stackoverflow.com/users/4265352/axiac"}, "edited": false, "score": 2, "creation_date": 1492616695, "post_id": 43499849, "comment_id": 74054921, "body": "I cannot tell why it returns <code>nil</code> but if you squeeze <code>.force</code> just before <code>.each</code> it returns what you want."}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 1, "creation_date": 1492618081, "post_id": 43499849, "comment_id": 74055901, "body": "When called with a block, <a href=\"http://ruby-doc.org/core-2.4.1/Enumerator.html#method-i-each\" rel=\"nofollow noreferrer\"><code>Enumerator#each</code></a> returns whatever the enumerator&#39;s block returns (in the doc&#39;s example, <code>each</code> returns <code>:method_returned</code>). So the actual question is: why doesn&#39;t <code>Enumerator::Lazy</code> provide a proper return value?"}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "reply_to_user": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 2, "creation_date": 1492619756, "post_id": 43499849, "comment_id": 74057043, "body": "@Stefan <code>Enumerator::Lazy</code> is designed to create <i>no intermediate arrays</i>. What happens there is basically <a href=\"https://github.com/ruby/ruby/pull/101/files#diff-efe8e903560c362c42e95673077801a6R1242\" rel=\"nofollow noreferrer\">a <code>foldl</code> of given functions</a>, that\u2019s why intermediate functions don\u2019t return arrays, and, hence, all the intermediate results are <code>nil</code>s."}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "reply_to_user": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1492621362, "post_id": 43499849, "comment_id": 74058117, "body": "@mudasobwa it doesn&#39;t have to create an intermediate array. It could just return itself, i.e. the <code>Enumerator::Lazy</code> instance."}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "reply_to_user": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 1, "creation_date": 1492621619, "post_id": 43499849, "comment_id": 74058292, "body": "@Stefan it can\u2019t return both a pointer to the reducer <i>and</i> self :) To make functional folding to work, it is to return the former."}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "reply_to_user": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1492621946, "post_id": 43499849, "comment_id": 74058505, "body": "@mudasobwa both? If it can return <code>nil</code>, it could also return <code>self</code>. Am I missing something?"}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "reply_to_user": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1492622289, "post_id": 43499849, "comment_id": 74058738, "body": "@Stefan it is implemented in c and it in fact returns a pointer to a function, see the code I linked. It becomes nil in ruby only."}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "reply_to_user": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1492622878, "post_id": 43499849, "comment_id": 74059094, "body": "@mudasobwa do you think that <code>nil</code> was introduced accidentally or on purpose? I could easily implement a chainable <code>each</code>: <a href=\"https://gist.github.com/sos4nt/78396f0e97cf694a853c70225fc182c9\" rel=\"nofollow noreferrer\">gist.github.com/sos4nt/78396f0e97cf694a853c70225fc182c9</a>"}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "reply_to_user": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1492624398, "post_id": 43499849, "comment_id": 74060030, "body": "@Stefan your implementation is ruby and it basically ruins the whole idea. <code>Lazy::Enumerator</code> is implemented in <code>c</code> completely. The implementation returns a curried function. What happens when one chains two <code>select</code>s, the <code>fun(fun(arg))</code> is passing the argument through a chain of functions, there is <i>no intermediate <code>self</code></i>. Once the chain is ended, the call to actual block happens. That\u2019s why there is (for instance) no <code>enum_for</code> for <code>select</code>. <code>select</code> requires a block, because for each iterated value, the chain of functions will be called, not results are chained."}, {"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 0, "creation_date": 1492624980, "post_id": 43499849, "comment_id": 74060380, "body": "This looks like a violation of the contract of <code>each</code>, which is supposed to return <code>self</code>. This can only possibly be true if <code>self</code> is <code>nil</code>, but that can&#39;t be because <code>nil</code> doesn&#39;t respond to <code>each</code>. I would say it is a bug."}, {"owner": {"reputation": 195, "user_id": 4162120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/07ba3841f030dc9fac9c375abca84881?s=128&d=identicon&r=PG&f=1", "display_name": "Joep", "link": "https://stackoverflow.com/users/4162120/joep"}, "reply_to_user": {"reputation": 56328, "user_id": 4265352, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-lzAUc5pYb24/AAAAAAAAAAI/AAAAAAAAAGQ/q3h7bZUnqrs/photo.jpg?sz=128", "display_name": "axiac", "link": "https://stackoverflow.com/users/4265352/axiac"}, "edited": false, "score": 0, "creation_date": 1492629022, "post_id": 43499849, "comment_id": 74062754, "body": "@axiac that will change the behavior of this snippet of code, because <code>send_message</code> can cause another message in <code>messages</code> to be considered spam. I&#39;ve added some context in the question for clarification."}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "reply_to_user": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 0, "creation_date": 1492664706, "post_id": 43499849, "comment_id": 74075281, "body": "@J&#246;rgWMittag would you mind to point out where \u201cthe contract of <code>each</code>\u201d states it\u2019s \u201csupposed to return <code>self</code>\u201d?"}], "answers": [{"comments": [{"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1492618182, "post_id": 43500874, "comment_id": 74055965, "body": "That returns an empty array, because <code>nil.to_a</code> is <code>[]</code>. You have to move the <code>.to_a</code> before <code>.each</code>"}, {"owner": {"reputation": 48049, "user_id": 6419007, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/CwqtX.jpg?s=128&g=1", "display_name": "Eric Duminil", "link": "https://stackoverflow.com/users/6419007/eric-duminil"}, "edited": false, "score": 0, "creation_date": 1492618277, "post_id": 43500874, "comment_id": 74056026, "body": "It also doesn&#39;t answer the question. <code>[1,2,3].lazy.select{|x| x&gt;1 }.each{|x| p x}</code> evaluates each element but still returns <code>nil</code>."}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "reply_to_user": {"reputation": 48049, "user_id": 6419007, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/CwqtX.jpg?s=128&g=1", "display_name": "Eric Duminil", "link": "https://stackoverflow.com/users/6419007/eric-duminil"}, "edited": false, "score": 0, "creation_date": 1492619256, "post_id": 43500874, "comment_id": 74056724, "body": "@EricDuminil that is because <code>nil.to_a #\u21d2\u00a0[]</code> as Stefan pointed out above."}, {"owner": {"reputation": 195, "user_id": 4162120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/07ba3841f030dc9fac9c375abca84881?s=128&d=identicon&r=PG&f=1", "display_name": "Joep", "link": "https://stackoverflow.com/users/4162120/joep"}, "edited": false, "score": 0, "creation_date": 1492628246, "post_id": 43500874, "comment_id": 74062330, "body": "<code>.each</code>, when given a block, already evaluates lazy enumerators. Example: <code>[1,2].lazy.each { } # =&gt; [1,2]</code>"}], "tags": [], "owner": {"reputation": 40236, "user_id": 923315, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/j6lLI.jpg?s=128&g=1", "display_name": "peter", "link": "https://stackoverflow.com/users/923315/peter"}, "is_accepted": false, "score": 0, "last_activity_date": 1492636547, "last_edit_date": 1492636547, "creation_date": 1492618122, "answer_id": 43500874, "question_id": 43499849, "link": "https://stackoverflow.com/questions/43499849/why-does-each-return-nil-when-called-on-a-lazy-enum-after-select/43500874#43500874", "title": "Why does `.each` return nil when called on a lazy enum after `.select`?", "body": "<p>If you use .map it returns the expected result, why each gives nil in this case is unclear.</p>\n\n<pre><code> p [1,2,3].lazy.select{|x| x&gt;1 }.map{|x| x}.to_a #=&gt; [2, 3]\n</code></pre>\n\n<p>or just</p>\n\n<pre><code>p [1,2,3].lazy.select{|x| x&gt;1 }.to_a #=&gt; [2, 3]\n</code></pre>\n\n<p>On this subject, read this <a href=\"http://railsware.com/blog/2012/03/13/ruby-2-0-enumerablelazy/\" rel=\"nofollow noreferrer\">http://railsware.com/blog/2012/03/13/ruby-2-0-enumerablelazy/</a> blog</p>\n"}, {"comments": [{"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 3, "creation_date": 1492622380, "post_id": 43501510, "comment_id": 74058796, "body": "The collection doesn&#39;t have to be huge. Maybe <code>message_is_spam?</code> is just an expensive operation and the OP wants to send each non-spam message as soon as possible instead of waiting for all checks to complete. BTW, I think <code>sent_messages</code> is supposed to be an array, not an <code>Enumerator::Lazy</code> instance."}, {"owner": {"reputation": 195, "user_id": 4162120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/07ba3841f030dc9fac9c375abca84881?s=128&d=identicon&r=PG&f=1", "display_name": "Joep", "link": "https://stackoverflow.com/users/4162120/joep"}, "edited": false, "score": 0, "creation_date": 1492628425, "post_id": 43501510, "comment_id": 74062435, "body": "The first alternative solution will not work, because <code>send_message</code> can affect the outcome of later <code>message_is_spam?</code> calls. I&#39;ve edited the question to clarify this. The second solution works fine as a workaround, but requires the reader to know about <code>send_message</code>&#39;s return value to fully grasp the code."}], "tags": [], "owner": {"reputation": 48049, "user_id": 6419007, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/CwqtX.jpg?s=128&g=1", "display_name": "Eric Duminil", "link": "https://stackoverflow.com/users/6419007/eric-duminil"}, "is_accepted": true, "score": 3, "last_activity_date": 1492638097, "last_edit_date": 1492638097, "creation_date": 1492620146, "answer_id": 43501510, "question_id": 43499849, "link": "https://stackoverflow.com/questions/43499849/why-does-each-return-nil-when-called-on-a-lazy-enum-after-select/43501510#43501510", "title": "Why does `.each` return nil when called on a lazy enum after `.select`?", "body": "<h1>Possible explanation</h1>\n\n<p>One of the purposes of <a href=\"https://ruby-doc.org/core-2.4.0/Enumerator/Lazy.html\" rel=\"nofollow noreferrer\"><code>Enumerator::Lazy</code></a> is to avoid having a huge (or possibly infinite) array in memory. This could explain why <a href=\"http://ruby-doc.org/core-2.4.1/Enumerator.html#method-i-each\" rel=\"nofollow noreferrer\"><code>Enumerator#each</code></a> doesn't return the desired array.</p>\n\n<p>Instead of risking running out of memory with a huge array, methods like <a href=\"https://ruby-doc.org/core-2.4.0/Enumerator/Lazy.html#method-i-reject\" rel=\"nofollow noreferrer\"><code>Lazy#reject</code></a> prefer returning <code>nil</code> as an alternative value (the one returned by <code>each</code> afterwards) :</p>\n\n<pre><code>return lazy_add_method(obj, 0, 0, Qnil, Qnil, &amp;lazy_reject_funcs);\n</code></pre>\n\n<p>In comparison, <code>Enumerable#lazy</code> returns :</p>\n\n<pre><code>VALUE result = lazy_to_enum_i(obj, sym_each, 0, 0, lazyenum_size);\n</code></pre>\n\n<p>I suspect that the distinct arguments :</p>\n\n<ul>\n<li><code>Qnil</code> for <code>reject</code></li>\n<li><code>sym_each</code> for <code>lazy</code></li>\n</ul>\n\n<p>are the reason why :</p>\n\n<ul>\n<li><code>[].lazy.each {}</code> returns <code>[]</code></li>\n<li><code>[].lazy.select{}.each {}</code> returns <code>nil</code>.</li>\n</ul>\n\n<p>Still, it doesn't seem consistent for <code>each</code> to return an array or <code>nil</code>\n.</p>\n\n<h1>Alternatives</h1>\n\n<h3>each</h3>\n\n<p>A more verbose alternative for your code could be :</p>\n\n<pre><code>messages = %w(a b c)\nmessages_to_send = messages.lazy.reject{|x| puts \"Is '#{x}' spam?\"}\nmessages_to_send.each{ |m| puts \"Send '#{m}'\" }\n# Is 'a' spam?\n# Send 'a'\n# Is 'b' spam?\n# Send 'b'\n# Is 'c' spam?\n# Send 'c'\n</code></pre>\n\n<p><code>Lazy#reject</code> returns a <code>Lazy</code> Enumerator, so the second <code>message_is_spam?</code> will be executed after the first <code>send_message</code>.</p>\n\n<p>There's one problem though, calling <code>to_a</code> on the lazy enumerator will call <code>reject</code> again :</p>\n\n<pre><code>sent_messages = messages_to_send.to_a\n# Is 'a' spam?\n# Is 'b' spam?\n# Is 'c' spam?\n</code></pre>\n\n<h3><code>map</code> and modified method</h3>\n\n<p>You could also return <code>m</code> at the end of <code>send_message</code> and use <a href=\"https://ruby-doc.org/core-2.4.0/Enumerator/Lazy.html#method-i-map\" rel=\"nofollow noreferrer\"><code>Lazy#map</code></a>:</p>\n\n<pre><code>sent_messages = messages.lazy.reject { |m| message_is_spam?(m) }\n                             .map { |m| send_message(m) }.to_a\n</code></pre>\n\n<p><code>map</code> should reliably return the desired Enumerator::Lazy object. Calling <a href=\"http://ruby-doc.org/core-2.4.1/Enumerable.html#method-i-to_a\" rel=\"nofollow noreferrer\"><code>Enumerable#to_a</code></a> ensures that <code>sent_messages</code> is an array.</p>\n\n<h3><code>map</code> and explicit return</h3>\n\n<p>If you don't want to modify <code>send_message</code>, you could return <code>m</code> explicitely at the end of each <code>map</code> iteration :</p>\n\n<pre><code>messages = %w(a b c)\n\nsent_messages = messages.lazy.reject{ |m| puts \"Is '#{m}' spam?\" }\n                             .map{ |m| puts \"Send '#{m}'\"; m }.to_a   \n# Is 'a' spam?\n# Send 'a'\n# Is 'b' spam?\n# Send 'b'\n# Is 'c' spam?\n# Send 'c'\n\np sent_messages\n# [\"a\", \"b\", \"c\"]\n</code></pre>\n\n<h3>Modified logic</h3>\n\n<p>Yet another alternative would be to redefine your logic without <code>lazy</code> :</p>\n\n<pre><code>sent_messages = messages.map do |m|\n  next if message_is_spam?(m)\n  send_message(m)\n  m\nend.compact\n</code></pre>\n"}], "owner": {"reputation": 195, "user_id": 4162120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/07ba3841f030dc9fac9c375abca84881?s=128&d=identicon&r=PG&f=1", "display_name": "Joep", "link": "https://stackoverflow.com/users/4162120/joep"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 415, "favorite_count": 2, "accepted_answer_id": 43501510, "answer_count": 2, "score": 16, "last_activity_date": 1492675975, "creation_date": 1492615192, "last_edit_date": 1492675975, "question_id": 43499849, "link": "https://stackoverflow.com/questions/43499849/why-does-each-return-nil-when-called-on-a-lazy-enum-after-select", "title": "Why does `.each` return nil when called on a lazy enum after `.select`?", "body": "<p>I have a snippet of code that goes like this:</p>\n\n<pre><code>sent_messages = messages.lazy.reject { |m| message_is_spam?(m) }\n                             .each   { |m| send_message(m) }\n# Do something with sent_messages...\n</code></pre>\n\n<p>Some context: the <code>message_is_spam?</code> method returns true if the recipient of the message was messaged within the last 5 minutes. When <code>messages</code> contains several messages for the same recipient, the latter message will be considered spam only after the first message is sent. To ensure the latter message is considered spam, I lazily reject spam messages and send them.</p>\n\n<p>I expect <code>.each</code> to return an array containing all items, but instead I get <code>nil</code>. <code>.each</code> always returns an array, except in this one scenario:</p>\n\n<pre><code>[].each {}                # =&gt; []\n[].lazy.each {}           # =&gt; []\n[].select {}.each {}      # =&gt; []\n[].lazy.select {}.each {} # =&gt; nil\n</code></pre>\n\n<p>To add to the confusion, JRuby returns <code>[]</code> in all of the examples above.</p>\n\n<p>Why does <code>.each</code> return nil when called like this? I can't find anything in the docs about it, and it's difficult to figure out what's going on in the C-code.</p>\n\n<p>I've already figured out a way to completely bypass this issue; if I select up to 1 message per recipient (<code>messages.uniq_by(&amp;:recipient)</code>), the operation no longer <em>needs</em> to be lazy. Nonetheless, this still surprises me.</p>\n"}, {"tags": ["ruby", "facebook-graph-api", "koala", "koala-gem"], "comments": [{"owner": {"reputation": 111, "user_id": 917613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b4450555b42e36e563d0563f611fd8d?s=128&d=identicon&r=PG", "display_name": "snikolau", "link": "https://stackoverflow.com/users/917613/snikolau"}, "edited": false, "score": 0, "creation_date": 1492632208, "post_id": 43499645, "comment_id": 74064730, "body": "What <code>post.inspect</code> and <code>post.class</code> returns?"}], "owner": {"reputation": 557, "user_id": 904296, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/9e85f04784de6af2050b7cd131b8a108?s=128&d=identicon&r=PG", "display_name": "grooble", "link": "https://stackoverflow.com/users/904296/grooble"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 114, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1492614710, "creation_date": 1492614710, "question_id": 43499645, "link": "https://stackoverflow.com/questions/43499645/koala-how-to-get-shares-from-facebook-graph-api", "title": "koala: how to get shares from Facebook Graph API", "body": "<p>I'm trying to get the count of shares from a Facebook page, but I can't seem to get the result out of the hash.\nHere's what I have:</p>\n\n<pre><code>y_response = @graph.get_connection('some_fb_page','posts',\n                            {fields: ['message', 'id', 'from', 'type', \n'properties', 'link', 'shares', 'likes.summary(true)', \n 'comments.summary(true)', 'created_time', 'updated_time']\n                            })\n</code></pre>\n\n<p>So y_response is Koala::Facebook::API::GraphCollection</p>\n\n<pre><code>y_response.each do |post|\n</code></pre>\n\n<p>and each of the post elements is a Hash</p>\n\n<pre><code>puts post[\"shares\"]\n</code></pre>\n\n<p>gives me: {\"count\"=>3}</p>\n\n<p>but </p>\n\n<pre><code>puts post[\"shares\"][\"count\"]\n</code></pre>\n\n<p>gives an </p>\n\n<pre><code>undefined method `[]' for nil:NilClass (NoMethodError)\n</code></pre>\n\n<p>I've also tried </p>\n\n<pre><code>puts post[\"shares\"][:count]\nputs post[\"shares\"][count]\nputs post[\"shares\"].count\n</code></pre>\n\n<p>for laughs.</p>\n\n<p>What am I doing wrong?\nHow do I get the count from the hash?</p>\n"}, {"tags": ["javascript", "html", "ruby", "sinatra"], "answers": [{"tags": [], "owner": {"reputation": 154, "user_id": 7887886, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/fef2abd4b1a921dd0e1ebbac5ee36dda?s=128&d=identicon&r=PG&f=1", "display_name": "zzero", "link": "https://stackoverflow.com/users/7887886/zzero"}, "is_accepted": true, "score": 0, "last_activity_date": 1492616610, "creation_date": 1492616610, "answer_id": 43500365, "question_id": 43499618, "link": "https://stackoverflow.com/questions/43499618/sinatra-cant-load-javascript-files-after-that-i-server-in-public-folderbecause/43500365#43500365", "title": "sinatra cant load javascript files after that I server in public folder(because its MIME type (&#39;text/html&#39;) is not executable )?", "body": "<p>I solve with this</p>\n\n<pre><code>require 'sinatra'\nrequire 'pp'\n\nget '/' do\n  erb :index\nend\n\n\n\nget '/2' do\n  content_type 'text/javascript'\n  File.read(File.join('public', 'jquery-1.7.1.js'))\n\nend\n\n\npost '/greeting' do\n  #puts \"params\"\n  #pp params\n\n  \"&lt;p&gt;#{params[:salutation]}, #{params[:name]}&lt;/p&gt;\"\nend\n</code></pre>\n"}], "owner": {"reputation": 154, "user_id": 7887886, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/fef2abd4b1a921dd0e1ebbac5ee36dda?s=128&d=identicon&r=PG&f=1", "display_name": "zzero", "link": "https://stackoverflow.com/users/7887886/zzero"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 274, "favorite_count": 0, "accepted_answer_id": 43500365, "answer_count": 1, "score": 0, "last_activity_date": 1492616722, "creation_date": 1492614609, "last_edit_date": 1492616722, "question_id": 43499618, "link": "https://stackoverflow.com/questions/43499618/sinatra-cant-load-javascript-files-after-that-i-server-in-public-folderbecause", "title": "sinatra cant load javascript files after that I server in public folder(because its MIME type (&#39;text/html&#39;) is not executable )?", "body": "<p>Im trying to load  javascript file but appears a MIME type error ; dont works I dont know how solve </p>\n\n<p>How i could solve this </p>\n\n<p>this is my html code</p>\n\n<pre><code>&lt;html&gt;\n  &lt;head&gt;\n    &lt;script src=\"/2\"&gt;&lt;/script&gt;\n    &lt;script type=\"text/javascript\"&gt;\n      $(document).ready(function() {\n        var param = { salutation: 5+6, name: \"Friend\" };\n        $.post(\"greeting\", param, function(result) { \n          console.log(\"param\",param);\n          $(\"#greeting\").html(result);\n        });\n      });\n    &lt;/script&gt;\n  &lt;/head&gt;\n  &lt;body&gt;\n    &lt;h1&gt;Sinatra Ajax Demo using jQuery&lt;/h1&gt;\n    &lt;div id=\"greeting\"&gt;\n      &lt;p&gt;Hello, World&lt;/p&gt;\n    &lt;/div&gt;\n  &lt;/body&gt;\n&lt;/html&gt;\n</code></pre>\n\n<p>and this is my ruby sinatra  code</p>\n\n<pre><code>require 'sinatra'\nrequire 'pp'\n\nget '/' do\n  erb :index\nend\n\n\n\nget '/2' do\n  File.read(File.join('public', 'jquery-1.7.1.js'))\n\nend\n\n\npost '/greeting' do\n  #puts \"params\"\n  #pp params\n\n  \"&lt;p&gt;#{params[:salutation]}, #{params[:name]}&lt;/p&gt;\"\nend\n</code></pre>\n\n<p>Please help me with this</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "caching", "nokogiri"], "comments": [{"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 1, "creation_date": 1492614340, "post_id": 43499493, "comment_id": 74053251, "body": "Apparently, not. Cache is good for storing strings, though."}, {"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 1, "creation_date": 1492631584, "post_id": 43499493, "comment_id": 74064365, "body": "Why would you want to store an object? Store a serialized hash or array containing information you scraped from HTML or XML using Nokogiri. If you need to store objects then look into memoization."}, {"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 1, "creation_date": 1492712746, "post_id": 43499493, "comment_id": 74107489, "body": "Thinking about this more, a memory cache is good for things you need to access immediately, but, if the machine goes down, can also be recreated quickly. If you&#39;re using Nokogiri, odds are good you&#39;re scraping a page, which implies you&#39;re loading that page, and the load, parse, scrape process adds latency you don&#39;t want (hence the idea to use a cache), but instead you should gather your (meta)data and store it in your database where it&#39;s permanently available. The DBM will cache internally. It&#39;s not as fast as an in-memory cache but it&#39;s better than recreating on request or at app startup."}], "answers": [{"comments": [{"owner": {"reputation": 16802, "user_id": 1235929, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/9f460ae7deb6fa19034c810a53b9fbac?s=128&d=identicon&r=PG", "display_name": "Dave", "link": "https://stackoverflow.com/users/1235929/dave"}, "edited": false, "score": 0, "creation_date": 1493145620, "post_id": 43553526, "comment_id": 74285916, "body": "Hi, Where are you converting this back to a Nokogiri doc? My requirement is I need to invoke a cache method that allows me to store and retrieve Nokogiri docs.  If they take some intermediate form in between, that&#39;s fine, but the end result must be a Nokogiri doc.  I&#39;m still not seeing how to achieve this with what you have provided."}, {"owner": {"reputation": 16802, "user_id": 1235929, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/9f460ae7deb6fa19034c810a53b9fbac?s=128&d=identicon&r=PG", "display_name": "Dave", "link": "https://stackoverflow.com/users/1235929/dave"}, "edited": false, "score": 0, "creation_date": 1493240748, "post_id": 43553526, "comment_id": 74337400, "body": "Done!  See my code in my question.  The get_cached_data method contains the code strting with &quot;$cache.fetch(url) {&quot;.  The method &quot;get_content(url, headers, follow_redirects)&quot; returns the Nokogiri doc.  So where do I take the result of that, convert it to XML, and then convert it back to a String?"}, {"owner": {"reputation": 1379, "user_id": 2101252, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JXPjA.jpg?s=128&g=1", "display_name": "s1mpl3", "link": "https://stackoverflow.com/users/2101252/s1mpl3"}, "reply_to_user": {"reputation": 16802, "user_id": 1235929, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/9f460ae7deb6fa19034c810a53b9fbac?s=128&d=identicon&r=PG", "display_name": "Dave", "link": "https://stackoverflow.com/users/1235929/dave"}, "edited": false, "score": 0, "creation_date": 1493242117, "post_id": 43553526, "comment_id": 74338071, "body": "can you add the get_content method code? What you should be saving in the cache is a string (xml)"}, {"owner": {"reputation": 16802, "user_id": 1235929, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/9f460ae7deb6fa19034c810a53b9fbac?s=128&d=identicon&r=PG", "display_name": "Dave", "link": "https://stackoverflow.com/users/1235929/dave"}, "edited": false, "score": 0, "creation_date": 1493301230, "post_id": 43553526, "comment_id": 74366871, "body": "get_content is a really long method that downloads a file from teh internet and converts it to a Nokogiri Document.  Know that it returns a Nokogiri document or nil (if nothing was returned)."}], "tags": [], "owner": {"reputation": 1379, "user_id": 2101252, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JXPjA.jpg?s=128&g=1", "display_name": "s1mpl3", "link": "https://stackoverflow.com/users/2101252/s1mpl3"}, "is_accepted": false, "score": 3, "last_activity_date": 1609522494, "last_edit_date": 1609522494, "creation_date": 1492817924, "answer_id": 43553526, "question_id": 43499493, "link": "https://stackoverflow.com/questions/43499493/how-do-i-use-a-rails-cache-to-store-nokogiri-objects/43553526#43553526", "title": "How do I use a Rails cache to store Nokogiri objects?", "body": "<p>Store the xml as string, not the object and parse them once you get them out of the cache.</p>\n<p>Edit: response to comment</p>\n<p>Cache this instead</p>\n<pre><code>nokogiri_object.to_xml\n</code></pre>\n<p>Edit2: response to comment. Something along this lines. You will need to post more code if you want more specific help.</p>\n<pre><code>nokogiri_object = Nokogiri::XML(cache.fetch('xml_doc'))\n</code></pre>\n<p>Edit3: Response to 'Thanks but what is the code for &quot;Store serialized object in cache&quot;? I thought the body of the &quot;$cache.fetch(url) {&quot; would take care of storing and then retrieving things?'</p>\n<pre><code>cache.write('url', xml_or_serialized_nokogiri_string)\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 16802, "user_id": 1235929, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/9f460ae7deb6fa19034c810a53b9fbac?s=128&d=identicon&r=PG", "display_name": "Dave", "link": "https://stackoverflow.com/users/1235929/dave"}, "edited": false, "score": 0, "creation_date": 1493301115, "post_id": 43646792, "comment_id": 74366777, "body": "Thanks but what is the code for &quot;Store serialized object in cache&quot;?  I thought the body of the &quot;$cache.fetch(url) {&quot; would take care of storing and then retrieiving things?"}, {"owner": {"reputation": 1462, "user_id": 1230053, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1bc0f56c16d50540f99313692762924e?s=128&d=identicon&r=PG", "display_name": "Ken Stipek", "link": "https://stackoverflow.com/users/1230053/ken-stipek"}, "reply_to_user": {"reputation": 16802, "user_id": 1235929, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/9f460ae7deb6fa19034c810a53b9fbac?s=128&d=identicon&r=PG", "display_name": "Dave", "link": "https://stackoverflow.com/users/1235929/dave"}, "edited": false, "score": 1, "creation_date": 1493321600, "post_id": 43646792, "comment_id": 74379854, "body": "You very well may not need anything there, I was thinking you may be doing something additional there. Simply skip it, what you are looking for is <code>serialize</code>."}, {"owner": {"reputation": 16802, "user_id": 1235929, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/9f460ae7deb6fa19034c810a53b9fbac?s=128&d=identicon&r=PG", "display_name": "Dave", "link": "https://stackoverflow.com/users/1235929/dave"}, "edited": false, "score": 0, "creation_date": 1493391755, "post_id": 43646792, "comment_id": 74412629, "body": "yes but this is still failing because &quot;get_content&quot; returns a Nokogiri Document (the method cannot be altered, sadly) and as such it is causing the outer &quot;$cache.fetch&quot; to fail with the error I listed.  Assume I know nothing (which is basically true) and please spell it out for me.  How do I write a method that returns a Nokogiri Document that utilizes my Rails cache?"}, {"owner": {"reputation": 1379, "user_id": 2101252, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JXPjA.jpg?s=128&g=1", "display_name": "s1mpl3", "link": "https://stackoverflow.com/users/2101252/s1mpl3"}, "edited": false, "score": 0, "creation_date": 1493400521, "post_id": 43646792, "comment_id": 74417728, "body": "Dave did you check Edit3?  fetch and write are two different calls. It looks like some place the Nokogiri object not the string is being saved to the cache"}, {"owner": {"reputation": 1462, "user_id": 1230053, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1bc0f56c16d50540f99313692762924e?s=128&d=identicon&r=PG", "display_name": "Ken Stipek", "link": "https://stackoverflow.com/users/1230053/ken-stipek"}, "reply_to_user": {"reputation": 16802, "user_id": 1235929, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/9f460ae7deb6fa19034c810a53b9fbac?s=128&d=identicon&r=PG", "display_name": "Dave", "link": "https://stackoverflow.com/users/1235929/dave"}, "edited": false, "score": 0, "creation_date": 1493410628, "post_id": 43646792, "comment_id": 74422704, "body": "@Dave I have updated my answer, this should be all you need to do to store the serialized Nokogiri object and retrieve it. :)"}, {"owner": {"reputation": 16802, "user_id": 1235929, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/9f460ae7deb6fa19034c810a53b9fbac?s=128&d=identicon&r=PG", "display_name": "Dave", "link": "https://stackoverflow.com/users/1235929/dave"}, "edited": false, "score": 0, "creation_date": 1493413106, "post_id": 43646792, "comment_id": 74423786, "body": "Oh ok, so to tie it all together, if I call $cache.fetch(url) by itself, should that just return the serialized string or nil if there is no entry in the $cache?"}, {"owner": {"reputation": 1462, "user_id": 1230053, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1bc0f56c16d50540f99313692762924e?s=128&d=identicon&r=PG", "display_name": "Ken Stipek", "link": "https://stackoverflow.com/users/1230053/ken-stipek"}, "reply_to_user": {"reputation": 16802, "user_id": 1235929, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/9f460ae7deb6fa19034c810a53b9fbac?s=128&d=identicon&r=PG", "display_name": "Dave", "link": "https://stackoverflow.com/users/1235929/dave"}, "edited": false, "score": 0, "creation_date": 1493416451, "post_id": 43646792, "comment_id": 74424991, "body": "@Dave, that is correct - <a href=\"http://api.rubyonrails.org/classes/ActiveSupport/Cache/Store.html#method-i-fetch\" rel=\"nofollow noreferrer\">api.rubyonrails.org/classes/ActiveSupport/Cache/&hellip;</a>"}], "tags": [], "owner": {"reputation": 1462, "user_id": 1230053, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1bc0f56c16d50540f99313692762924e?s=128&d=identicon&r=PG", "display_name": "Ken Stipek", "link": "https://stackoverflow.com/users/1230053/ken-stipek"}, "is_accepted": true, "score": 2, "last_activity_date": 1493410582, "last_edit_date": 1493410582, "creation_date": 1493253836, "answer_id": 43646792, "question_id": 43499493, "link": "https://stackoverflow.com/questions/43499493/how-do-i-use-a-rails-cache-to-store-nokogiri-objects/43646792#43646792", "title": "How do I use a Rails cache to store Nokogiri objects?", "body": "<p>User Nokogiri's Serialize functionality:</p>\n\n<pre><code>$cache = ActiveSupport::Cache::MemoryStore.new \nnoko_object = Nokogiri::HTML::Document.new\n\nserial = noko_object.serialize\n$cache.write(url, serial)\n// Serialized Nokogiri document is now in store at the URL key.\nresult = $cache.read(url)\n\nnoko_object = Nokogiri::HTML::Document.new(result)\n// noko_object is now the original document again :)\n</code></pre>\n\n<p><a href=\"http://www.rubydoc.info/github/sparklemotion/nokogiri/Nokogiri%2FHTML%2FDocument%3Aserialize\" rel=\"nofollow noreferrer\">Check out the documentation here for more information</a>.</p>\n"}], "owner": {"reputation": 16802, "user_id": 1235929, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/9f460ae7deb6fa19034c810a53b9fbac?s=128&d=identicon&r=PG", "display_name": "Dave", "link": "https://stackoverflow.com/users/1235929/dave"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 604, "favorite_count": 0, "accepted_answer_id": 43646792, "answer_count": 2, "score": 9, "last_activity_date": 1609522494, "creation_date": 1492614245, "last_edit_date": 1493240618, "question_id": 43499493, "link": "https://stackoverflow.com/questions/43499493/how-do-i-use-a-rails-cache-to-store-nokogiri-objects", "title": "How do I use a Rails cache to store Nokogiri objects?", "body": "<p>I'm using Rails 5  to use a Rails cache to store Nokogiri objects.  </p>\n\n<p>I created this in config/initializers/cache.rb:</p>\n\n<pre><code>$cache = ActiveSupport::Cache::MemoryStore.new\n</code></pre>\n\n<p>and I wanted to store documents like:</p>\n\n<pre><code>$cache.fetch(url) {\n  result = get_content(url, headers, follow_redirects)\n}\n</code></pre>\n\n<p>but I'm getting this error:</p>\n\n<pre><code>Error during processing: (TypeError) no _dump_data is defined for class Nokogiri::HTML::Document\n/Users/davea/.rvm/gems/ruby-2.4.0/gems/activesupport-5.0.2/lib/active_support/cache.rb:671:in `dump'\n/Users/davea/.rvm/gems/ruby-2.4.0/gems/activesupport-5.0.2/lib/active_support/cache.rb:671:in `dup_value!'\n/Users/davea/.rvm/gems/ruby-2.4.0/gems/activesupport-5.0.2/lib/active_support/cache/memory_store.rb:128:in `write_entry'\n/Users/davea/.rvm/gems/ruby-2.4.0/gems/activesupport-5.0.2/lib/active_support/cache.rb:398:in `block in write'\n/Users/davea/.rvm/gems/ruby-2.4.0/gems/activesupport-5.0.2/lib/active_support/cache.rb:562:in `block in instrument'\n/Users/davea/.rvm/gems/ruby-2.4.0/gems/activesupport-5.0.2/lib/active_support/notifications.rb:166:in `instrument'\n/Users/davea/.rvm/gems/ruby-2.4.0/gems/activesupport-5.0.2/lib/active_support/cache.rb:562:in `instrument'\n/Users/davea/.rvm/gems/ruby-2.4.0/gems/activesupport-5.0.2/lib/active_support/cache.rb:396:in `write'\n/Users/davea/.rvm/gems/ruby-2.4.0/gems/activesupport-5.0.2/lib/active_support/cache.rb:596:in `save_block_result_to_cache'\n/Users/davea/.rvm/gems/ruby-2.4.0/gems/activesupport-5.0.2/lib/active_support/cache.rb:300:in `fetch'\n/Users/davea/Documents/workspace/myproject/app/helpers/webpage_helper.rb:116:in `get_cached_content'\n/Users/davea/Documents/workspace/myproject/app/helpers/webpage_helper.rb:73:in `get_url'\n/Users/davea/Documents/workspace/myproject/app/services/abstract_my_object_finder_service.rb:29:in `process_data'\n/Users/davea/Documents/workspace/myproject/app/services/run_crawlers_service.rb:26:in `block (2 levels) in run_all_crawlers'\n/Users/davea/.rvm/gems/ruby-2.4.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:348:in `run_task'\n/Users/davea/.rvm/gems/ruby-2.4.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:337:in `block (3 levels) in create_worker'\n/Users/davea/.rvm/gems/ruby-2.4.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `loop'\n/Users/davea/.rvm/gems/ruby-2.4.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:320:in `block (2 levels) in create_worker'\n/Users/davea/.rvm/gems/ruby-2.4.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `catch'\n/Users/davea/.rvm/gems/ruby-2.4.0/gems/concurrent-ruby-1.0.5/lib/concurrent/executor/ruby_thread_pool_executor.rb:319:in `block in create_worker'\n</code></pre>\n\n<p>What do I need to do in order to be able to store these objects in a cache?</p>\n\n\n"}, {"tags": ["javascript", "ruby-on-rails", "ruby", "websocket", "actioncable"], "comments": [{"owner": {"reputation": 25732, "user_id": 93311, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/hgn1T.jpg?s=128&g=1", "display_name": "Trip", "link": "https://stackoverflow.com/users/93311/trip"}, "edited": false, "score": 3, "creation_date": 1494025381, "post_id": 43499326, "comment_id": 74669159, "body": "Any luck? I&#39;m getting that generic error as well."}], "owner": {"reputation": 129, "user_id": 6495928, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/ibZTS.jpg?s=128&g=1", "display_name": "BoB", "link": "https://stackoverflow.com/users/6495928/bob"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 673, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1492619548, "creation_date": 1492613831, "last_edit_date": 1492619548, "question_id": 43499326, "link": "https://stackoverflow.com/questions/43499326/rails-5-actioncable-not-receiving-data-received-method-not-called", "title": "Rails 5 ActionCable Not Receiving Data received method not called", "body": "<p>When I post a new comment in the product page, an alert should appear to all the users that are logged in and in that page, also the comment should appear without refreshing the page.</p>\n\n<p>When there's incoming data on the websocket for this channel ProductChannel the function received in product.js should be called, but instead nothing happens. Any ideas what could be the problem?</p>\n\n<pre><code>App.product = App.cable.subscriptions.create(\"ProductChannel\", {\n  connected: function() {\n    // Called when the subscription is ready for use on the server\n  },\n\n  disconnected: function() {\n    // Called when the subscription has been terminated by the server\n  },\n\n  received: function(data) {\n    // Called when there's incoming data on the websocket for this channel\n    $('.alert.alert-info').show().delay(3000).fadeOut('slow');\n    $('.product-reviews').prepend(data.comment);\n    $(\"#average-rating\").attr('data-score', data.average_rating);\n    refreshRating();\n  },\n\n  listen_to_comments: function(){\n    return this.perform('listen', {\n      product_id: $(\"[data-product-id]\").data(\"product-id\")\n    });\n  }\n});\n\n$(document).on('turbolinks:load', function() {\n  App.product.listen_to_comments();\n});\n</code></pre>\n\n<p>product_channel.rb</p>\n\n<pre><code>class ProductChannel &lt; ApplicationCable::Channel\n  def subscribed\n    # stream_from \"some_channel\"\n    # stream_from \"product_channel\"\n  end\n\n  def unsubscribed\n    # Any cleanup needed when channel is unsubscribed\n  end\n\n  def listen(data)\n    stop_all_streams\n    stream_for data[\"product_id\"]\n  end\nend\n</code></pre>\n\n<p>comments_controller.rb</p>\n\n<pre><code>class CommentsController &lt; ApplicationController\n\n  def index\n    redirect_to root_path\n  end\n\n  def create\n    @product = Product.find(params[:product_id])\n    @comment = @product.comments.new(comment_params)\n    @comment.user = current_user\n    respond_to do |format|\n      if @comment.save\n        ProductChannel.broadcast_to @product.id, comment: CommentsController.render(partial: 'comments/comment', locals: {comment: @comment, current_user: current_user}), average_rating: @product.average_rating\n        format.html { redirect_to @product, notice: 'Review was created successfully.' }\n        format.json { render :show, status: :created, location: @product }\n        format.js\n      else\n        format.html { redirect_to @product, alert: 'Review was not saved successfully.' }\n        format.json { render json: @comment.errors, status: :unprocessable_entity }\n      end\n    end\n  end\n</code></pre>\n\n<p>Also I get this error Unable to process ProductChannel#listen({\"product_id\"=>9})</p>\n"}, {"tags": ["ruby", "backbone.js", "coffeescript", "haml", "middleman"], "comments": [{"owner": {"reputation": 5651, "user_id": 2295592, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/7WNgQ.png?s=128&g=1", "display_name": "caffeinated.tech", "link": "https://stackoverflow.com/users/2295592/caffeinated-tech"}, "edited": false, "score": 0, "creation_date": 1492618240, "post_id": 43499173, "comment_id": 74056000, "body": "Please include source of <code>C:&#47;interface_project&#47;config.rb</code>"}, {"owner": {"reputation": 1, "user_id": 6704534, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-bzfAnrnheHw/AAAAAAAAAAI/AAAAAAAALEE/taszjKM6v1I/photo.jpg?sz=128", "display_name": "harinath cherukuwada", "link": "https://stackoverflow.com/users/6704534/harinath-cherukuwada"}, "reply_to_user": {"reputation": 5651, "user_id": 2295592, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/7WNgQ.png?s=128&g=1", "display_name": "caffeinated.tech", "link": "https://stackoverflow.com/users/2295592/caffeinated-tech"}, "edited": false, "score": 0, "creation_date": 1492619098, "post_id": 43499173, "comment_id": 74056614, "body": "Yes I have included the config.rb code"}], "answers": [{"tags": [], "owner": {"reputation": 234, "user_id": 4371783, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1813c3e2d125e66f413cb2976305b4c3?s=128&d=identicon&r=PG&f=1", "display_name": "Adam", "link": "https://stackoverflow.com/users/4371783/adam"}, "is_accepted": false, "score": 0, "last_activity_date": 1494176271, "creation_date": 1494176271, "answer_id": 43834198, "question_id": 43499173, "link": "https://stackoverflow.com/questions/43499173/i-am-getting-error-when-i-use-middleman-command-when-am-trying-to-add-the-js-and/43834198#43834198", "title": "I am getting error when i use middleman command when am trying to add the js and css files in the build", "body": "<p>This doesn't have anything to do with Slick.js... that error is telling you compass_config is undefined.</p>\n\n<p>Try this: </p>\n\n<p>add <code>gem \"middleman-compass\"</code> to your Gemfile </p>\n\n<p>run <code>bundle install</code></p>\n\n<p>If that doesn't fix it, try placing <code>activate :compass</code> before your <code>compass_config do |config|</code> block.</p>\n"}], "owner": {"reputation": 1, "user_id": 6704534, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-bzfAnrnheHw/AAAAAAAAAAI/AAAAAAAALEE/taszjKM6v1I/photo.jpg?sz=128", "display_name": "harinath cherukuwada", "link": "https://stackoverflow.com/users/6704534/harinath-cherukuwada"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 280, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1494176271, "creation_date": 1492613457, "last_edit_date": 1492619051, "question_id": 43499173, "link": "https://stackoverflow.com/questions/43499173/i-am-getting-error-when-i-use-middleman-command-when-am-trying-to-add-the-js-and", "title": "I am getting error when i use middleman command when am trying to add the js and css files in the build", "body": "<p>Need Assistance on the below points</p>\n\n<p>1.When am trying to run middleman command I am facing this problem can anyone please help in this\nissue\n2. And I have added slick.js in my js folder and tried running the build I can able to see the js file but content it is not referring\n2. need to add CSS file also</p>\n\n<p>please help me in the above points</p>\n\n<pre><code>C:\\interface_project&gt;middleman\nWARN: Unresolved specs during Gem::Specification.reset:\nthor (&lt; 2.0, &gt;= 0.17.0)\nrack (&lt; 3, &gt;= 1.4.5)\nactivesupport (&lt; 5.1, &gt;= 3.1, &gt;= 4.2)\naddressable (&gt; 2.3)\nlisten (&gt; 3.0.0)\nsass (&gt;= 3.4)\nexecjs (&lt; 3, &gt;= 0.3.0, &gt; 2.0)\nconcurrent-ruby (&gt; 1.0)\nWARN: Clearing out unresolved specs.\nPlease report a bug if this causes problems.\nC:/interface_project/config.rb:13:in evaluate_configuration!': undefined methodcompass_config' for #Middleman::ConfigContext:0x000000047f2a70 (NoMethodErro\nr)\nfrom C:/Ruby23-x64/lib/ruby/gems/2.3.0/gems/middleman-core-4.2.1/lib/mid\ndleman-core/application.rb:329:in instance_eval' from C:/Ruby23-x64/lib/ruby/gems/2.3.0/gems/middleman-core-4.2.1/lib/mid dleman-core/application.rb:329:inevaluate_configuration!'\nfrom C:/Ruby23-x64/lib/ruby/gems/2.3.0/gems/middleman-core-4.2.1/lib/mid\ndleman-core/application.rb:286:in initialize' from C:/Ruby23-x64/lib/ruby/gems/2.3.0/gems/middleman-cli-4.2.1/bin/midd leman:49:innew'\nfrom C:/Ruby23-x64/lib/ruby/gems/2.3.0/gems/middleman-cli-4.2.1/bin/midd\nleman:49:in ' from C:/Ruby23-x64/bin/middleman:22:inload'\nfrom C:/Ruby23-x64/bin/middleman:22:in `\n</code></pre>\n\n<p>Below is the config.rb you can see the below code \n    config.rb </p>\n\n<pre><code>###\n# Compass\n###\n\n# Susy grids in Compass\n# First: gem install compass-susy-plugin\n# require 'susy'\n\n# Change Compass configuration\n# require 'compass'\nrequire 'premailer'\n\ncompass_config do |config|\n  config.output_style = :nested\n  config.line_comments = false\nend\n\n\nset :haml, :attr_wrapper =&gt; \"\\\"\"\n\n###\n# Page options, layouts, aliases and proxies\n###\n\n# Per-page layout changes:\n#\n# With no layout\n# page \"/path/to/file.html\", :layout =&gt; false\n#\n# With alternative layout\n# page \"/path/to/file.html\", :layout =&gt; :otherlayout\n#\n# A path which all have the same layout\n# with_layout :admin do\n#   page \"/admin/*\"\n# end\n\n# Make sure that all partials are rendered without a layout\npage \"/partials/*\", :layout =&gt; false\n\n\npage \"/orders.html\", :layout =&gt; \"layout-dealer\"\npage \"/dashboard.html\", :layout =&gt; \"layout-dealer\"\n# Proxy (fake) files\n# page \"/this-page-has-no-template.html\", :proxy =&gt; \"/template-file.html\" do\n#   @which_fake_page = \"Rendering a fake page with a variable\"\n# end\n\n###\n# Helpers\n###\n\n# set :attr_wrapper, \"\\\"\"\n\n# Refresh pages automatically\nactivate :livereload\n\n# Automatic image dimensions on image_tag helper\nactivate :automatic_image_sizes\n\n# Methods defined in the helpers block are available in templates\nhelpers do\n\n  # Print an array of string values as a text list\n  def text_list(listtext,sep1=\", \", sep2=\" or \")\n    n = listtext.size\n    if n &gt; 1\n      if n == 2\n        (listtext.first(n-1)).join(sep1) + sep2 + listtext.last\n      else\n        (listtext.first(n-1)).join(sep1) + sep1 + sep2 + listtext.last\n      end\n    else\n      listtext.first\n    end\n  end\n\nend\n\nset :css_dir, 'assets/css'\n\nset :js_dir, 'assets/js'\n\nset :images_dir, 'assets/images'\n\nmodule PreMailer\n  class &lt;&lt; self\n    def registered(app)\n      require \"premailer\"\n      app.after_build do |builder|\n        prefix = build_dir + File::SEPARATOR\n        Dir.chdir(build_dir) do\n          Dir.glob('email-template.html') do |file|\n            premailer = Premailer.new(file, :warn_level =&gt; Premailer::Warnings::SAFE, :adapter =&gt; :nokogiri, :preserve_styles =&gt; true, :remove_comments =&gt; true, :remove_ids =&gt; true)\n            fileout = File.open(file, \"w\")\n            fileout.puts premailer.to_inline_css\n            fileout.close\n            # FileUtils.cp file, prefix+'email-build/'\n            premailer.warnings.each do |w|\n              builder.say_status :premailer, \"#{w[:message]} (#{w[:level]}) may not render properly in #{w[:clients]}\"\n            end\n            builder.say_status :premailer, prefix+file\n          end\n        end\n      end\n    end\n    alias :included :registered\n  end\nend\n\n::Middleman::Extensions.register(:inline_premailer, PreMailer)\n# activate :inline_premailer\n\n# Build-specific configuration\nset :build_dir, \"public\"\n\n# Build-specific configuration\nconfigure :build do\n  # For example, change the Compass output style for deployment\n  # activate :minify_css\n\n  # Minify Javascript on build\n  # activate :minify_javascript, :ignore =&gt; /locale/\n\n  # Enable cache buster\n  # activate :cache_buster\n\n  # Use relative URLs\n  activate :relative_assets\n\n  # Compress PNGs after build\n  # First: gem install middleman-smusher\n  # require \"middleman-smusher\"\n  # activate :smusher\n\n  # Or use a different image path\n  # set :http_path, \"/Content/images/\"\n\n  # ignore the build directory for emails\n  ignore 'email-build/*'\n  ignore 'node_modules/*'\n  ignore 'server.coffee'\n  ignore 'web.config'\nend\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "activerecord", "ruby-on-rails-5"], "answers": [{"tags": [], "owner": {"reputation": 1472, "user_id": 379767, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/hxYhr.jpg?s=128&g=1", "display_name": "Hannes Stru&#223;", "link": "https://stackoverflow.com/users/379767/hannes-stru%c3%9f"}, "is_accepted": true, "score": 0, "last_activity_date": 1492614538, "creation_date": 1492614538, "answer_id": 43499591, "question_id": 43499149, "link": "https://stackoverflow.com/questions/43499149/adding-order-to-a-relation-makes-relation-saving-fail/43499591#43499591", "title": "Adding order to a relation makes relation saving fail", "body": "<p>Using <a href=\"http://guides.rubyonrails.org/association_basics.html#bi-directional-associations\" rel=\"nofollow noreferrer\"><code>inverse_of</code></a> fixes it:</p>\n\n<pre><code>has_many :tasks, -&gt; { order(name: :asc) }, inverse_of: :solution\n</code></pre>\n\n<p>and</p>\n\n<pre><code>belongs_to :problem, inverse_of: :tasks\n</code></pre>\n"}], "owner": {"reputation": 1472, "user_id": 379767, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/hxYhr.jpg?s=128&g=1", "display_name": "Hannes Stru&#223;", "link": "https://stackoverflow.com/users/379767/hannes-stru%c3%9f"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 25, "favorite_count": 0, "accepted_answer_id": 43499591, "answer_count": 1, "score": 1, "last_activity_date": 1492614538, "creation_date": 1492613406, "question_id": 43499149, "link": "https://stackoverflow.com/questions/43499149/adding-order-to-a-relation-makes-relation-saving-fail", "title": "Adding order to a relation makes relation saving fail", "body": "<p>In Rails 5, given these two models:</p>\n\n<pre><code>class Solution &lt; ApplicationRecord\n  has_many :tasks, -&gt; { order(name: :asc) }\nend\n\nclass Task &lt; ApplicationRecord\n  belongs_to :solution\nend\n</code></pre>\n\n<p>This code will fail with <code>ActiveRecord::RecordInvalid: Validation failed: Tasks is invalid</code>:</p>\n\n<pre><code>solution = Solution.new(name: \"My Solution\", tasks: [\n  Task.new(name: \"My Task\")\n])\n\nsolution.save!\n</code></pre>\n\n<p>This is due to the task's <code>solution</code> being <code>nil</code>:</p>\n\n<pre><code>(byebug) pp solution.tasks[0].errors.messages\n{:solution=&gt;[\"must exist\"]}\n</code></pre>\n\n<p>However, when removing the order from the <code>has_many</code> clause (into just <code>has_many :tasks</code>), it works fine:</p>\n\n<pre><code>(byebug) pp solution.tasks[0].solution == nil\nfalse\n</code></pre>\n\n<p>Is this expected?</p>\n\n<p>Example project (look at the last two commits): <a href=\"https://github.com/hannesstruss/test_order_validation\" rel=\"nofollow noreferrer\">https://github.com/hannesstruss/test_order_validation</a></p>\n"}, {"tags": ["ruby-on-rails", "ruby", "activerecord"], "comments": [{"owner": {"reputation": 2023, "user_id": 979091, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/a3480528206a15015e4a3ba9a68037c4?s=128&d=identicon&r=PG", "display_name": "omnikron", "link": "https://stackoverflow.com/users/979091/omnikron"}, "edited": false, "score": 0, "creation_date": 1492692733, "post_id": 43498343, "comment_id": 74093342, "body": "Maybe <a href=\"http://stackoverflow.com/a/15477926/979091\">this answer</a> using Arel&#39;s greater than/less than functions is helpful."}, {"owner": {"reputation": 2553, "user_id": 1706831, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/34b7c15de97dd917f6159feb72a3a5a8?s=128&d=identicon&r=PG", "display_name": "Kori John Roys", "link": "https://stackoverflow.com/users/1706831/kori-john-roys"}, "reply_to_user": {"reputation": 2023, "user_id": 979091, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/a3480528206a15015e4a3ba9a68037c4?s=128&d=identicon&r=PG", "display_name": "omnikron", "link": "https://stackoverflow.com/users/979091/omnikron"}, "edited": false, "score": 0, "creation_date": 1492788268, "post_id": 43498343, "comment_id": 74145052, "body": "thanks omnikron ah, <code>gt</code> and <code>lt</code>, that&#39;s good to know, thanks."}], "answers": [{"comments": [{"owner": {"reputation": 2553, "user_id": 1706831, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/34b7c15de97dd917f6159feb72a3a5a8?s=128&d=identicon&r=PG", "display_name": "Kori John Roys", "link": "https://stackoverflow.com/users/1706831/kori-john-roys"}, "edited": false, "score": 0, "creation_date": 1492612204, "post_id": 43498538, "comment_id": 74051559, "body": "is <code>or</code> supported in Rails 4?"}, {"owner": {"reputation": 2292, "user_id": 5448888, "user_type": "registered", "accept_rate": 56, "profile_image": "https://graph.facebook.com/898095120243525/picture?type=large", "display_name": "Chakreshwar Sharma", "link": "https://stackoverflow.com/users/5448888/chakreshwar-sharma"}, "edited": false, "score": 0, "creation_date": 1492612427, "post_id": 43498538, "comment_id": 74051752, "body": "No, or comes in rails5"}], "tags": [], "owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "is_accepted": false, "score": 6, "last_activity_date": 1492611880, "creation_date": 1492611880, "answer_id": 43498538, "question_id": 43498343, "link": "https://stackoverflow.com/questions/43498343/activerecord-multiple-where-date-range/43498538#43498538", "title": "ActiveRecord multiple where date range", "body": "<p>You can pass <a href=\"http://guides.rubyonrails.org/active_record_querying.html#range-conditions\" rel=\"noreferrer\">ranges</a> to <code>where</code> and use <code>or</code>:</p>\n\n<pre><code>time_range = (start_at..end_at)\nProject.where(start_at: time_range).or(Project.where(end_at: time_range))\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 2553, "user_id": 1706831, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/34b7c15de97dd917f6159feb72a3a5a8?s=128&d=identicon&r=PG", "display_name": "Kori John Roys", "link": "https://stackoverflow.com/users/1706831/kori-john-roys"}, "edited": false, "score": 0, "creation_date": 1492616918, "post_id": 43499716, "comment_id": 74055085, "body": "is BETWEEN not inclusive? Is that why you are using <code>beginning_of_day</code> and <code>end_of_day</code> ?"}, {"owner": {"reputation": 678, "user_id": 1876625, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/71046152bb2e7018ac20ff446aa178d4?s=128&d=identicon&r=PG", "display_name": "ehoffmann", "link": "https://stackoverflow.com/users/1876625/ehoffmann"}, "reply_to_user": {"reputation": 2553, "user_id": 1706831, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/34b7c15de97dd917f6159feb72a3a5a8?s=128&d=identicon&r=PG", "display_name": "Kori John Roys", "link": "https://stackoverflow.com/users/1706831/kori-john-roys"}, "edited": false, "score": 1, "creation_date": 1492617894, "post_id": 43499716, "comment_id": 74055771, "body": "It depends of the datatype of your database column. <code>beginning_of_day</code> and <code>end_of_day</code> ensure your query will return relevant results with a <code>DATETIME</code> type."}], "tags": [], "owner": {"reputation": 678, "user_id": 1876625, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/71046152bb2e7018ac20ff446aa178d4?s=128&d=identicon&r=PG", "display_name": "ehoffmann", "link": "https://stackoverflow.com/users/1876625/ehoffmann"}, "is_accepted": false, "score": 1, "last_activity_date": 1492614866, "creation_date": 1492614866, "answer_id": 43499716, "question_id": 43498343, "link": "https://stackoverflow.com/questions/43498343/activerecord-multiple-where-date-range/43499716#43499716", "title": "ActiveRecord multiple where date range", "body": "<p>For Rails 4 you could use <code>BETWEEN</code> and <code>hash</code> params:</p>\n\n<pre><code>Project.where(\n  \"(start_at BETWEEN :start_at AND :end_at) OR (end_at BETWEEN :start_at AND :end_at)\",\n  start_at: start_at.beginning_of_day, end_at: end_at.end_of_day)\n</code></pre>\n"}], "owner": {"reputation": 2553, "user_id": 1706831, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/34b7c15de97dd917f6159feb72a3a5a8?s=128&d=identicon&r=PG", "display_name": "Kori John Roys", "link": "https://stackoverflow.com/users/1706831/kori-john-roys"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 803, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1492614866, "creation_date": 1492611414, "last_edit_date": 1492612299, "question_id": 43498343, "link": "https://stackoverflow.com/questions/43498343/activerecord-multiple-where-date-range", "title": "ActiveRecord multiple where date range", "body": "<p>Is there a more ActiveRecord idiomatic way to find which records have a <code>start_at</code> or <code>end_at</code> within a certain date_range? (Basically, need to find the records that start or end in a given time frame). Here's what I'm currently doing:</p>\n\n<pre><code>Project.where('(start_at &gt;= ? AND start_at &lt;= ?) OR (end_at &gt;= ? AND end_at &lt;= ?)', start_at, end_at, start_at, end_at)\n</code></pre>\n"}, {"tags": ["ruby", "websocket", "ruby-on-rails-5", "actioncable"], "answers": [{"comments": [{"owner": {"reputation": 1672, "user_id": 6594668, "user_type": "registered", "accept_rate": 15, "profile_image": "https://www.gravatar.com/avatar/7d7abb51f365e465123208807ee0b07b?s=128&d=identicon&r=PG&f=1", "display_name": "prograils", "link": "https://stackoverflow.com/users/6594668/prograils"}, "reply_to_user": {"reputation": 240, "user_id": 5597363, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/73054308b2cba2802226fc4e92b6ead4?s=128&d=identicon&r=PG&f=1", "display_name": "Achilles", "link": "https://stackoverflow.com/users/5597363/achilles"}, "edited": false, "score": 0, "creation_date": 1492768326, "post_id": 43537484, "comment_id": 74130768, "body": "Try to set <code>gem &#39;pg&#39;</code> instead of <code>gem &#39;sqlite3&#39;</code> (and bundle install)   See also:  <a href=\"https://www.pluralsight.com/guides/ruby-ruby-on-rails/creating-a-chat-using-rails-action-cable\" rel=\"nofollow noreferrer\">pluralsight.com/guides/ruby-ruby-on-rails/&hellip;</a>"}, {"owner": {"reputation": 240, "user_id": 5597363, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/73054308b2cba2802226fc4e92b6ead4?s=128&d=identicon&r=PG&f=1", "display_name": "Achilles", "link": "https://stackoverflow.com/users/5597363/achilles"}, "edited": false, "score": 0, "creation_date": 1492772391, "post_id": 43537484, "comment_id": 74133674, "body": "I will try that, but what is the reason of setting &#39;pg&#39; instead of &#39;sqlite3&#39;"}, {"owner": {"reputation": 1672, "user_id": 6594668, "user_type": "registered", "accept_rate": 15, "profile_image": "https://www.gravatar.com/avatar/7d7abb51f365e465123208807ee0b07b?s=128&d=identicon&r=PG&f=1", "display_name": "prograils", "link": "https://stackoverflow.com/users/6594668/prograils"}, "reply_to_user": {"reputation": 240, "user_id": 5597363, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/73054308b2cba2802226fc4e92b6ead4?s=128&d=identicon&r=PG&f=1", "display_name": "Achilles", "link": "https://stackoverflow.com/users/5597363/achilles"}, "edited": false, "score": 0, "creation_date": 1492774605, "post_id": 43537484, "comment_id": 74135201, "body": "1 <a href=\"https://www.pluralsight.com/guides/ruby-ruby-on-rails/creating-a-chat-using-rails-action-cable#installing-actioncable\" rel=\"nofollow noreferrer\">pluralsight.com/guides/ruby-ruby-on-rails/&hellip;</a> 2 <a href=\"http://guides.rubyonrails.org/action_cable_overview.html#dependencies\" rel=\"nofollow noreferrer\">guides.rubyonrails.org/action_cable_overview.html#dependenci&zwnj;&#8203;es</a>"}], "tags": [], "owner": {"reputation": 1672, "user_id": 6594668, "user_type": "registered", "accept_rate": 15, "profile_image": "https://www.gravatar.com/avatar/7d7abb51f365e465123208807ee0b07b?s=128&d=identicon&r=PG&f=1", "display_name": "prograils", "link": "https://stackoverflow.com/users/6594668/prograils"}, "is_accepted": false, "score": 1, "last_activity_date": 1496213504, "last_edit_date": 1496213504, "creation_date": 1492762799, "answer_id": 43537484, "question_id": 43497644, "link": "https://stackoverflow.com/questions/43497644/action-cable-is-not-working-with-rails-5/43537484#43537484", "title": "Action Cable is not working with rails 5", "body": "<p>You might try to use Action Cable without Redis (since Redis is not strictly required for Action Cable):</p>\n\n<pre><code>development:\n  adapter: async\n\ntest:\n  adapter: async\n\nproduction:\n  adapter: redis\n  url: redis://localhost:6379/1\n</code></pre>\n\n<p>But this probably is not the origin of your problem. Your <code>room.coffee</code> lacks some <code>speak</code>-calling code. Add to <code>room.coffee</code> something like this:</p>\n\n<pre><code>$ -&gt;\n  $('#send_form').submit (event)-&gt;\n    App.room.speak event.currentTarget['message'].value\n    event.currentTarget['message'].value = \"\"\n    event.preventDefault()\n    false\n</code></pre>\n\n<p>Here's a template:</p>\n\n<pre><code>&lt;div class=\"jumbotron\"&gt;\n  &lt;form id=\"send_form\"&gt;\n    &lt;label&gt;Message:&lt;/label&gt;\n    &lt;input id=\"message\" type=\"text\" data-behavior=\"room_speaker\"&gt;\n    &lt;br&gt; \n    &lt;input type=\"submit\" data-behavior=\"room_speaker\"&gt;\n  &lt;/form&gt;\n&lt;/div&gt;\n</code></pre>\n"}], "owner": {"reputation": 240, "user_id": 5597363, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/73054308b2cba2802226fc4e92b6ead4?s=128&d=identicon&r=PG&f=1", "display_name": "Achilles", "link": "https://stackoverflow.com/users/5597363/achilles"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2664, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1496213504, "creation_date": 1492609663, "last_edit_date": 1492610993, "question_id": 43497644, "link": "https://stackoverflow.com/questions/43497644/action-cable-is-not-working-with-rails-5", "title": "Action Cable is not working with rails 5", "body": "<p>I am a beginner in Rails 5 and I am trying to implement web sockets in my app. I am trying to copy and run a test app at first and I figure out it is not working as it is not transmitting and receiving the data. <code>received: (data) -&gt;</code> is never called. I also observed that it never gets connected with my redis server either (which I installed with brew). I am pasting all the code below. Thanks in advance.</p>\n\n<pre><code>//room.coffee\n\nApp.room = App.cable.subscriptions.create \"RoomChannel\",\nconnected: -&gt; \n# Called when the subscription is ready for use on the server \ndisconnected: -&gt; \n# Called when the subscription has been terminated by the server \n\nreceived: (data) -&gt; \nalert(data['message'])\nspeak: (message) -&gt; \n@perform 'speak', message: message\n</code></pre>\n\n<p>room_chanel.rb</p>\n\n<pre><code># Be sure to restart your server when you modify this file. Action \nCable runs in a loop that does not support auto reloading.\nclass RoomChannel &lt; ApplicationCable::Channel\ndef subscribed\n stream_from \"room_channel\"\nend\n\ndef unsubscribed\n  # Any cleanup needed when channel is unsubscribed\nend\n\ndef speak(data)\n  ActionCable.server.broadcast \"room_channel\", message: data['message']\nend\nend\n</code></pre>\n\n<p>Gemfile</p>\n\n<pre><code>source 'https://rubygems.org'\n\ngit_source(:github) do |repo_name|\n  repo_name = \"#{repo_name}/#{repo_name}\" unless repo_name.include?(\"/\")\n  \"https://github.com/#{repo_name}.git\"\nend\n# Bundle edge Rails instead: gem 'rails', github: 'rails/rails'\ngem 'rails', '~&gt; 5.0.2'\n\n# Use postgresql as the database for Active Record\ngem 'sqlite3'\n# Use Puma as the app server\ngem 'puma'\n# Use SCSS for stylesheets\ngem 'sass-rails', '~&gt; 5.0'\n# Use Uglifier as compressor for JavaScript assets\ngem 'uglifier', '&gt;= 1.3.0'\n# Use CoffeeScript for .coffee assets and views\ngem 'coffee-rails', '~&gt; 4.1.0'\n# See https://github.com/rails/execjs#readme for more supported runtimes\n# gem 'therubyracer', platforms: :ruby\n\ngem 'redis'\n\n# Use jquery as the JavaScript library\ngem 'jquery-rails'\n# Turbolinks makes navigating your web application faster. Read more: https://github.com/turbolinks/turbolinks\ngem 'turbolinks', '~&gt; 5.x'\n# Build JSON APIs with ease. Read more: https://github.com/rails/jbuilder\ngem 'jbuilder', '~&gt; 2.0'\n# Use Redis adapter to run Action Cable in production\n# gem 'redis', '~&gt; 3.0'\n# Use ActiveModel has_secure_password\n# gem 'bcrypt', '~&gt; 3.1.7'\n\n# Use Capistrano for deployment\n# gem 'capistrano-rails', group: :development\n\ngroup :development, :test do\n  # Call 'byebug' anywhere in the code to stop execution and get a debugger console\n  gem 'byebug', platform: :mri\nend\n\ngroup :development do\n  # Access an IRB console on exception pages or by using &lt;%= console %&gt; anywhere in the code.\n  gem 'web-console', '&gt;= 3.3.0'\n  gem 'listen', '~&gt; 3.0.5'\n  # Spring speeds up development by keeping your application running in the background. Read more: https://github.com/rails/spring\n  gem 'spring'\n  gem 'spring-watcher-listen', '~&gt; 2.0.0'\nend\n\n# Windows does not include zoneinfo files, so bundle the tzinfo-data gem\ngem 'tzinfo-data', platforms: [:mingw, :mswin, :x64_mingw, :jruby]\n</code></pre>\n\n<p>cable.yml</p>\n\n<pre><code># Action Cable uses Redis by default to administer connections, channels, and sending/receiving messages over the WebSocket.\nproduction:\n  adapter: redis\n  url: redis://localhost:6379/1\n\ndevelopment:\n  adapter: redis\n  url: redis://localhost:6379/1\n\ntest:\n  adapter: redis\n  url: redis://localhost:6379/1\n</code></pre>\n\n<p>cable.coffee</p>\n\n<pre><code># Action Cable provides the framework to deal with WebSockets in Rails.\n    # You can generate new channels where WebSocket features live using the rails generate channel command.\n    #\n    # Turn on the cable connection by removing the comments after the require statements (and ensure it's also on in config/routes.rb).\n    #\n    #= require action_cable\n    #= require_self\n    #= require_tree ./channels\n    #\n    @App ||= {}\n    App.cable = ActionCable.createConsumer()\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 2450, "user_id": 1114667, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/c855f4e65f04cfbbe403fdb18e32fdfd?s=128&d=identicon&r=PG", "display_name": "Ilya Lavrov", "link": "https://stackoverflow.com/users/1114667/ilya-lavrov"}, "edited": false, "score": 0, "creation_date": 1492609394, "post_id": 43497500, "comment_id": 74049233, "body": "Try without <code>if</code>: <code>@posts = Post.where(hidden: admin_signed_in? ? true : false )</code>"}], "answers": [{"tags": [], "owner": {"reputation": 19261, "user_id": 4758119, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/F4dJY.jpg?s=128&g=1", "display_name": "Deepak Mahakale", "link": "https://stackoverflow.com/users/4758119/deepak-mahakale"}, "is_accepted": true, "score": 4, "last_activity_date": 1492610412, "last_edit_date": 1492610412, "creation_date": 1492609442, "answer_id": 43497542, "question_id": 43497500, "link": "https://stackoverflow.com/questions/43497500/add-search-parameter-if-condition-is-true/43497542#43497542", "title": "Add search parameter if condition is true", "body": "<p>You have an syntax error. you are using both <code>if</code> and <code>ternary (? :)</code>. Just change it to </p>\n\n<pre><code>@posts = Post.where(hidden: admin_signed_in?)\n</code></pre>\n\n<p>You don't need to pass <code>true</code> and <code>false</code> manually</p>\n\n<p><strong>NOTE:</strong>\nBut, it will not return you the posts with <code>hidden = false</code> if <code>admin_signed_in?</code> returns true</p>\n\n<p>So, you might want to change it to</p>\n\n<pre><code>@posts = Post.where(({hidden: true} if admin_signed_in?))\n</code></pre>\n"}, {"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user2926036"}, "edited": false, "score": 0, "creation_date": 1492612350, "post_id": 43497755, "comment_id": 74051688, "body": "I removed all additional methods before post my question"}], "tags": [], "owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "is_accepted": false, "score": 2, "last_activity_date": 1492610255, "last_edit_date": 1492610255, "creation_date": 1492609949, "answer_id": 43497755, "question_id": 43497500, "link": "https://stackoverflow.com/questions/43497500/add-search-parameter-if-condition-is-true/43497755#43497755", "title": "Add search parameter if condition is true", "body": "<p>I think your refactoring will not work, because <code>Post.all</code> will not return the same as <code>Post.where(hidden: true)</code>. The later will only list posts that <em>are</em> hidden, but not visible ones.</p>\n\n<p>I would refactor the code to something like:</p>\n\n<pre><code>@posts = Post.all\n@posts = @posts.where(hidden: false) unless admin_signed_in?\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1492613374, "post_id": 43497789, "comment_id": 74052517, "body": "Caveat: admins will only see hidden posts."}], "tags": [], "owner": {"reputation": 32451, "user_id": 2516474, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a2179a340c0e84edc285d432211145d?s=128&d=identicon&r=PG", "display_name": "SteveTurczyn", "link": "https://stackoverflow.com/users/2516474/steveturczyn"}, "is_accepted": false, "score": 2, "last_activity_date": 1492613535, "last_edit_date": 1492613535, "creation_date": 1492610025, "answer_id": 43497789, "question_id": 43497500, "link": "https://stackoverflow.com/questions/43497500/add-search-parameter-if-condition-is-true/43497789#43497789", "title": "Add search parameter if condition is true", "body": "<p>The problem with the ternary is the \"if\"</p>\n\n<pre><code>@posts = Post.where(hidden: if admin_signed_in? ? true : false )\n</code></pre>\n\n<p>Should be</p>\n\n<pre><code>@posts = Post.where(hidden: admin_signed_in? ? true : false )\n</code></pre>\n\n<p>And of course you can consider the other solutions posted.</p>\n\n<p>Stefan has pointed out that admins will only see hidden posts, not all posts, so if you're going to stick with the ternary then you really want...</p>\n\n<pre><code>@posts = Post.where(hidden: admin_signed_in? ? [true,  false, nil] : false )\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "is_accepted": false, "score": 0, "last_activity_date": 1492613831, "creation_date": 1492613831, "answer_id": 43499325, "question_id": 43497500, "link": "https://stackoverflow.com/questions/43497500/add-search-parameter-if-condition-is-true/43499325#43499325", "title": "Add search parameter if condition is true", "body": "<p><code>unless</code> with <code>else</code> is quite confusing. I'd change it to:</p>\n\n<pre><code>if admin_signed_in?\n  @posts = Post.all\nelse\n  @posts = Post.where(hidden: false)\nend\n</code></pre>\n\n<p>Other than that, I think the code reads just fine.</p>\n\n<p>However, you could replace it with a ternary operator:</p>\n\n<pre><code>@posts = admin_signed_in? ? Post.all : Post.where(hidden: false)\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user2926036"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 65, "favorite_count": 0, "accepted_answer_id": 43497542, "answer_count": 4, "score": 1, "last_activity_date": 1492613831, "creation_date": 1492609328, "question_id": 43497500, "link": "https://stackoverflow.com/questions/43497500/add-search-parameter-if-condition-is-true", "title": "Add search parameter if condition is true", "body": "<p>I have code in my controller where i want filter some records for non-authorized users:</p>\n\n<pre><code>unless admin_signed_in?\n  @posts = Post.where(hidden: false)\nelse\n  @posts = Post.all\nend\n</code></pre>\n\n<p>I tried to refactoring this, but can't make right query</p>\n\n<pre><code>@posts = Post.where(hidden: if admin_signed_in? ? true : false )\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>.../app/controllers/posts_controller.rb:7: syntax error, unexpected ')', expecting keyword_then or ';' or '\\n' in_signed_in? ? true : false )\n</code></pre>\n"}, {"tags": ["ruby", "cucumber"], "answers": [{"tags": [], "owner": {"reputation": 2754, "user_id": 5114911, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/1698453063709112/picture?type=large", "display_name": "KyleFairns", "link": "https://stackoverflow.com/users/5114911/kylefairns"}, "is_accepted": true, "score": 0, "last_activity_date": 1492616149, "last_edit_date": 1492616149, "creation_date": 1492612896, "answer_id": 43498966, "question_id": 43497249, "link": "https://stackoverflow.com/questions/43497249/how-to-define-steps-for-scenario-outline-with-ruby/43498966#43498966", "title": "How to define steps for Scenario Outline with ruby", "body": "<p>If you're looking to merge the capture with the email address:</p>\n\n<pre><code>When(/^I provide (vip\\d+)@yopmail\\.com$/) do |email|\n     browser.text_field(:name, \"Email\").set(\"#{email}@yopmail.com\")\nend\n</code></pre>\n\n<p>This will concatenate the captured text (\"vip\" literally plus any number of numerical values with a length of one or more) with the string \"@yopmail.com\"</p>\n\n<p><strong>A note on how Scenario Outline works</strong></p>\n\n<p>Scenario Outline will grab the lines from the examples table, and simply use the columns to create individual scenarios that use the values that match the column headers in place of the placeholders.</p>\n\n<p>For instance:</p>\n\n<pre><code>Scenario Outline: A note\n Given I am logged in as &lt;user&gt;\n When I go to the homepage\n Then I should see \"Welcome Back, &lt;display_name&gt;\"\n\nExamples:\n| user           | display_name |\n| rick@stley.com | Rick Astley  |\n| tammy1992      | Tammy Holmes |\n</code></pre>\n\n<p>Would be converted into two scenarios:</p>\n\n<pre><code>Scenario: A note\n Given I am logged in as rick@stley.com\n When I go to the homepage\n Then I should see \"Welcome Back, Rick Astley\"\n\nScenario: A note\n Given I am logged in as tammy1992\n When I go to the homepage\n Then I should see \"Welcome Back, Tammy Holmes\"\n</code></pre>\n\n<p>Which makes it no different to writing your normal scenario, the place holders that you use simply complete the step that you are writing.</p>\n\n<p><strong>How I would write your Scenario</strong></p>\n\n<p>Cucumber is a tool meant to bridge the conversational gap between testers, developers and management.</p>\n\n<pre><code>Scenario Outline: Log in with valid data\n   Given I am on the Sign up Form\n   When I sign up with the email \"&lt;Email&gt;\" and password \"&lt;Password&gt;\"\n   Then I should be able to log in as \"&lt;Email&gt;\" with password \"&lt;Password&gt;\"\n\nExamples:\n| Email                | Password |\n| vip17041@yopmail.com | 123      |\n| vip17042@yopmail.com | 123      |\n</code></pre>\n\n<p>We don't necessarily have to know each individual step of the process, and the feature file shows the intent of the test.\nWhat this seems to be looking for is whether you can log in after registering a new account, so why not write it as such?</p>\n"}, {"tags": [], "owner": {"reputation": 3257, "user_id": 4341733, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0b1793f226cb3189da8bc9c6264d72b7?s=128&d=identicon&r=PG", "display_name": "diabolist", "link": "https://stackoverflow.com/users/4341733/diabolist"}, "is_accepted": false, "score": 0, "last_activity_date": 1492690995, "creation_date": 1492690995, "answer_id": 43519438, "question_id": 43497249, "link": "https://stackoverflow.com/questions/43497249/how-to-define-steps-for-scenario-outline-with-ruby/43519438#43519438", "title": "How to define steps for Scenario Outline with ruby", "body": "<p>As someone who has used Cucumber for many years I would advise you to avoid using Scenario Outlines. Features and scenarios are for expressing intent in simple clear terms, not programming things using tables.</p>\n\n<p>You can write your scenario as</p>\n\n<pre><code>Scenario: I should be welcomed when I sign in\n  Given I am registered\n  When I sign in\n  Then I should be welcomed\n</code></pre>\n\n<p>Good scenarios state what behaviour they are trying to verify in their title, and then have steps that are consistent with this behaviour. They have no need to explain HOW your application implements that behaviour. Putting that information in your scenarios makes them longer, harder to implement, and much more difficult to maintain.</p>\n\n<p>A side effect of such simple scenarios is that the step definitions are much simpler and easier to write. No regex's params or table parsing needed here.</p>\n\n<p>You can see a simple example of this approach here (<a href=\"https://github.com/diabolo/cuke_up/tree/master/features\" rel=\"nofollow noreferrer\">https://github.com/diabolo/cuke_up/tree/master/features</a>), </p>\n"}], "owner": {"reputation": 13, "user_id": 7890032, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d184e0d783bbf4c5ba65d4bea98bd2c?s=128&d=identicon&r=PG&f=1", "display_name": "Kate Mal", "link": "https://stackoverflow.com/users/7890032/kate-mal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2165, "favorite_count": 0, "accepted_answer_id": 43498966, "answer_count": 2, "score": 1, "last_activity_date": 1492690995, "creation_date": 1492608667, "question_id": 43497249, "link": "https://stackoverflow.com/questions/43497249/how-to-define-steps-for-scenario-outline-with-ruby", "title": "How to define steps for Scenario Outline with ruby", "body": "<p>I have a registration form and need to test it using cucumber and ruby. \nI decided to user Scenario Outline with different values in table:</p>\n\n<pre><code>Scenario Outline: Log in with valid data\n   Given I am on the Sign up Form\n   When I provide &lt;Email&gt;\n   And I provide Confirm &lt;\u0421Email&gt;\n   And I provide &lt;Password&gt;\n   And I provide Confirm &lt;\u0421Password&gt;\n   And I click on Register button\n   Then I registered to the site\n\nExamples:\n| Email                | CEmail              | Password | CPassword       |\n| vip17041@yopmail.com |vip17041@yopmail.com | 123      | 123             |\n| vip17042@yopmail.com |vip17042@yopmail.com |123       | 123             | \n</code></pre>\n\n<p>Now I need create steps definition. In step definition I need to put into the fields values from the table.\nHow could I do that? Previously I used the next method:</p>\n\n<pre><code>    When(/^I provide vip(\\d+)@yopmail\\.com$/) do |email|\n         browser.text_field(:name, \"Email\").set(\"email@yopmail.com\")\n</code></pre>\n\n<p>But how could I set instead of hard coded email - email from my table?</p>\n\n<p>Thanks</p>\n"}, {"tags": ["ruby", "couchbase"], "answers": [{"comments": [{"owner": {"reputation": 1306, "user_id": 1015188, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aec3c080c0980eb6dcea2b565b22aba0?s=128&d=identicon&r=PG", "display_name": "atedja", "link": "https://stackoverflow.com/users/1015188/atedja"}, "edited": false, "score": 0, "creation_date": 1495738212, "post_id": 43497606, "comment_id": 75389377, "body": "Looks like the CB team has abandoned Ruby completely. You can still get the previous versions here: <a href=\"https://developer.couchbase.com/server/other-products/release-notes-archives/c-sdk\" rel=\"nofollow noreferrer\">developer.couchbase.com/server/other-products/&hellip;</a>"}], "tags": [], "owner": {"reputation": 173, "user_id": 7889583, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3b2690c4e036de8df691f071e64e7329?s=128&d=identicon&r=PG", "display_name": "Martin", "link": "https://stackoverflow.com/users/7889583/martin"}, "is_accepted": false, "score": 2, "last_activity_date": 1492609578, "creation_date": 1492609578, "answer_id": 43497606, "question_id": 43495114, "link": "https://stackoverflow.com/questions/43495114/couchbase-401-unauthorized/43497606#43497606", "title": "Couchbase 401 Unauthorized", "body": "<p>Turns out libcouchbase2-core-2.7.4 made some changes to the authorization mechanism that didn't work with my current version of the rubygem 'couchbase'.</p>\n\n<p>Rolling back to 2.7.3 fixed this.</p>\n\n<p>See the changelog here </p>\n\n<p><a href=\"https://github.com/couchbase/libcouchbase/blob/master/RELEASE_NOTES.markdown\" rel=\"nofollow noreferrer\">https://github.com/couchbase/libcouchbase/blob/master/RELEASE_NOTES.markdown</a></p>\n"}, {"comments": [{"owner": {"reputation": 1306, "user_id": 1015188, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aec3c080c0980eb6dcea2b565b22aba0?s=128&d=identicon&r=PG", "display_name": "atedja", "link": "https://stackoverflow.com/users/1015188/atedja"}, "edited": false, "score": 0, "creation_date": 1495738353, "post_id": 43944109, "comment_id": 75389437, "body": "I am getting inconsistent results when passing credentials.  <code>@client.design_docs</code> works fine, but <code>set</code> doesn&#39;t.  If I don&#39;t pass credentials, <code>design_docs</code> doesn&#39;t work, but <code>set</code> works."}], "tags": [], "owner": {"reputation": 3458, "user_id": 98509, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/dd70f9d8cc5f9ee488d68e7a787ba526?s=128&d=identicon&r=PG", "display_name": "avsej", "link": "https://stackoverflow.com/users/98509/avsej"}, "is_accepted": true, "score": 1, "last_activity_date": 1494612858, "creation_date": 1494612858, "answer_id": 43944109, "question_id": 43495114, "link": "https://stackoverflow.com/questions/43495114/couchbase-401-unauthorized/43944109#43944109", "title": "Couchbase 401 Unauthorized", "body": "<p>As a workaround, you should now explicitly pass user credentials. It is also done in preparations to Couchbase Server 5, where authentication and security in general has been improved a lot.</p>\n\n<pre><code>require 'couchbase'\n@client = Couchbase.new(:node_list =&gt; ['172.19.4.22'], :bucket =&gt; 'markets',\n                        :username =&gt; 'markets')\n@client.design_docs\n</code></pre>\n"}], "owner": {"reputation": 173, "user_id": 7889583, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3b2690c4e036de8df691f071e64e7329?s=128&d=identicon&r=PG", "display_name": "Martin", "link": "https://stackoverflow.com/users/7889583/martin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 492, "favorite_count": 0, "accepted_answer_id": 43944109, "answer_count": 2, "score": 2, "last_activity_date": 1501656029, "creation_date": 1492603130, "last_edit_date": 1494613074, "question_id": 43495114, "link": "https://stackoverflow.com/questions/43495114/couchbase-401-unauthorized", "title": "Couchbase 401 Unauthorized", "body": "<p>I have a production cluster running Couchbase Community Edition, and it's been running fine for over 3 years now. Today, it started to give out:</p>\n\n<pre><code>[appserver1 root]$ bundle exec ruby cbtest.rb \n\n/opt/rbenv/versions/2.2.2/lib/ruby/gems/2.2.0/gems/couchbase-1.3.15/lib/couchbase/bucket.rb:146:in `continue': failed to execute HTTP request, Success (Not an error) (key=\"/pools/default/buckets/markets/ddocs\", status=\"401\" (Unauthorized), error=0x00) (Couchbase::Error::HTTP)\n    from /opt/rbenv/versions/2.2.2/lib/ruby/gems/2.2.0/gems/couchbase-1.3.15/lib/couchbase/bucket.rb:146:in `design_docs'\n    from cbtest.rb:3:in `&lt;main&gt;'\n</code></pre>\n\n<p>Whereas, on another identical server</p>\n\n<pre><code>[appserver2 root]$ bundle exec ruby cbtest.rb \n\n[appserver2 root]$ \n</code></pre>\n\n<p>Here this the code of the script:</p>\n\n<pre><code>require 'couchbase'\n\n@client = Couchbase.new(:node_list =&gt; ['172.19.4.22'], :bucket =&gt; 'markets')\n\n@client.design_docs\n</code></pre>\n\n<p>I decided to strace the process, and the only difference i could find was <code>Authorization: Basic 0g--</code> was present in the failing transaction, but absent in the succeeding one.</p>\n\n<p>This is beyond me, as it's delving into the couchbase code.</p>\n\n<p>Thanks very much</p>\n"}, {"tags": ["ruby", "mocking", "minitest"], "answers": [{"tags": [], "owner": {"reputation": 125, "user_id": 1184078, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/262fad9c15ed00a8c630e2909d201146?s=128&d=identicon&r=PG", "display_name": "Warren Le", "link": "https://stackoverflow.com/users/1184078/warren-le"}, "is_accepted": false, "score": -1, "last_activity_date": 1502830133, "last_edit_date": 1502830133, "creation_date": 1502829205, "answer_id": 45701102, "question_id": 43494606, "link": "https://stackoverflow.com/questions/43494606/minitest-mock-expect-keyword-arguments/45701102#45701102", "title": "minitest - mock - expect keyword arguments", "body": "<p>based on @nus <a href=\"https://stackoverflow.com/questions/12499259/why-doesnt-minitestspec-have-a-wont-raise-assertion#comment64180153_12499262\">comment</a>,</p>\n\n<pre><code>class FooTest\n  def test_fnc_arguments\n    Foo.new.fnc a: \"a\", b: \"b\"\n    # assert true # optional\n  end\nend\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 4374, "user_id": 2987689, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DpqMx.jpg?s=128&g=1", "display_name": "Artur Beljajev", "link": "https://stackoverflow.com/users/2987689/artur-beljajev"}, "edited": false, "score": 0, "creation_date": 1536867154, "post_id": 50167933, "comment_id": 91588616, "body": "Calling <code>send</code> instead of calling a method directly is against the principle of least astonishment. Expect a question &quot;why is it made so&quot; from someone (possibly you) who will read that in production code at some point later. P.S. Consider using <code>public_send</code> if you really want to go that way."}, {"owner": {"reputation": 129, "user_id": 428728, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/48b82c3ec2b05c3d1b35d360513f5baf?s=128&d=identicon&r=PG", "display_name": "Marc", "link": "https://stackoverflow.com/users/428728/marc"}, "edited": false, "score": 2, "creation_date": 1547225626, "post_id": 50167933, "comment_id": 95132776, "body": "I got confused too and thought there was some meta-magic happening, but imagine the method is really called <code>deliver</code> rather than <code>send</code> and the example becomes straight-forward:  you are just mocking the <code>deliver</code> method, and passing a block to verify the expectation rather than letting the mock object verify it with its default implementation."}], "tags": [], "owner": {"reputation": 5210, "user_id": 1009442, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/2a01ae9942939ee2b3954a6727d2bb92?s=128&d=identicon&r=PG", "display_name": "Weihang Jian", "link": "https://stackoverflow.com/users/1009442/weihang-jian"}, "is_accepted": true, "score": 2, "last_activity_date": 1525417358, "last_edit_date": 1525417358, "creation_date": 1525412646, "answer_id": 50167933, "question_id": 43494606, "link": "https://stackoverflow.com/questions/43494606/minitest-mock-expect-keyword-arguments/50167933#50167933", "title": "minitest - mock - expect keyword arguments", "body": "<p>Below is a real-world example from my company's codebase:</p>\n\n<pre><code>mailer = MiniTest::Mock.new\nmailer.expect :send, 123 do |template_name:, data:, to:, subject:|\n  true\nend\nmailer.send template_name: \"xxx\", data: {}, to: [], subject: \"yyy\"\n</code></pre>\n\n<p>If you also want to verify arguments' types:</p>\n\n<pre><code>mailer.expect :send, 123 do |template_name:, data:, to:, subject:|\n  template_name.is_a?(String) &amp;&amp;\n    data.is_a?(Hash) &amp;&amp;\n    to.is_a?(Array) &amp;&amp;\n    subject.is_a?(String) &amp;&amp;\nend\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 4374, "user_id": 2987689, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DpqMx.jpg?s=128&g=1", "display_name": "Artur Beljajev", "link": "https://stackoverflow.com/users/2987689/artur-beljajev"}, "is_accepted": false, "score": 0, "last_activity_date": 1536868174, "creation_date": 1536868174, "answer_id": 52320832, "question_id": 43494606, "link": "https://stackoverflow.com/questions/43494606/minitest-mock-expect-keyword-arguments/52320832#52320832", "title": "minitest - mock - expect keyword arguments", "body": "<pre><code>require 'minitest/autorun'\n\nclass APIClient\n  def call; end\nend\n\nclass APIClientTest &lt; Minitest::Test\n  def test_keyword_aguments_expection\n    api_client = Minitest::Mock.new\n    api_client.expect(:call, true, [{ endpoint_url: 'https://api.test', secret_key: 'test' }])\n    api_client.call(endpoint_url: 'https://api.test', secret_key: 'test')\n    api_client.verify\n  end\nend\n\n# Running:\n.\nFinished in 0.000726s, 1377.5945 runs/s, 0.0000 assertions/s.\n1 runs, 0 assertions, 0 failures, 0 errors, 0 skips\n[Finished in 0.7s]\n</code></pre>\n"}], "owner": {"reputation": 5824, "user_id": 781743, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d19aed08825cbb3a52289ce9d5613035?s=128&d=identicon&r=PG", "display_name": "graywolf", "link": "https://stackoverflow.com/users/781743/graywolf"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1509, "favorite_count": 0, "accepted_answer_id": 50167933, "answer_count": 3, "score": 3, "last_activity_date": 1536868174, "creation_date": 1492601717, "question_id": 43494606, "link": "https://stackoverflow.com/questions/43494606/minitest-mock-expect-keyword-arguments", "title": "minitest - mock - expect keyword arguments", "body": "<p>When I want to verify that mock is send expected arguments, I can do</p>\n\n<pre><code>@mock.expect(:fnc, nil, [\"a, \"b\"])\n</code></pre>\n\n<p>however, if class I want to mock looks like this</p>\n\n<pre><code>class Foo\n    def fnc a:, b:\n    end\nend\n</code></pre>\n\n<p>how can I mock it and verify values passed as <code>a:</code>, <code>b:</code>?</p>\n"}, {"tags": ["ruby", "ip", "cidr"], "comments": [{"owner": {"reputation": 418, "user_id": 6331585, "user_type": "registered", "accept_rate": 60, "profile_image": "https://lh5.googleusercontent.com/--Spi1QdCgC0/AAAAAAAAAAI/AAAAAAAABnU/sJNL2oLTBHY/photo.jpg?sz=128", "display_name": "Vishwas Nahar", "link": "https://stackoverflow.com/users/6331585/vishwas-nahar"}, "edited": false, "score": 0, "creation_date": 1492601811, "post_id": 43494538, "comment_id": 74043487, "body": "This can help <a href=\"https://stackoverflow.com/questions/13406603/ip-range-to-cidr-in-ruby-rails\" title=\"ip range to cidr in ruby rails\">stackoverflow.com/questions/13406603/&hellip;</a>"}, {"owner": {"reputation": 171, "user_id": 7499654, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b543fbb3d42c84f706b5ef1312a42ae9?s=128&d=identicon&r=PG&f=1", "display_name": "mf370", "link": "https://stackoverflow.com/users/7499654/mf370"}, "reply_to_user": {"reputation": 418, "user_id": 6331585, "user_type": "registered", "accept_rate": 60, "profile_image": "https://lh5.googleusercontent.com/--Spi1QdCgC0/AAAAAAAAAAI/AAAAAAAABnU/sJNL2oLTBHY/photo.jpg?sz=128", "display_name": "Vishwas Nahar", "link": "https://stackoverflow.com/users/6331585/vishwas-nahar"}, "edited": false, "score": 0, "creation_date": 1492601989, "post_id": 43494538, "comment_id": 74043613, "body": "Thank you @VishwasNahar, however in that question they don&#39;t convert a range of IP addresses to a single CIDR"}], "answers": [{"tags": [], "owner": {"reputation": 171, "user_id": 7499654, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b543fbb3d42c84f706b5ef1312a42ae9?s=128&d=identicon&r=PG&f=1", "display_name": "mf370", "link": "https://stackoverflow.com/users/7499654/mf370"}, "is_accepted": true, "score": 1, "last_activity_date": 1492637629, "last_edit_date": 1492637629, "creation_date": 1492604562, "answer_id": 43495648, "question_id": 43494538, "link": "https://stackoverflow.com/questions/43494538/how-to-convert-ip-range-to-a-single-cidr-using-ruby/43495648#43495648", "title": "How to convert IP range to a single CIDR using Ruby", "body": "<p>Found it!</p>\n\n<pre><code>require 'netaddr'\n\nstartip = '250.154.64.0'\nendip = '250.154.64.255'\n\nip_net_range = NetAddr.range(startip, endip, :Inclusive =&gt; true, :Objectify =&gt; true)\ncidrs = NetAddr.merge(ip_net_range, :Objectify =&gt; true)\n\nputs cidrs\n</code></pre>\n\n<p>output: <code>250.154.64.0/24</code></p>\n"}], "owner": {"reputation": 171, "user_id": 7499654, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b543fbb3d42c84f706b5ef1312a42ae9?s=128&d=identicon&r=PG&f=1", "display_name": "mf370", "link": "https://stackoverflow.com/users/7499654/mf370"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 553, "favorite_count": 0, "accepted_answer_id": 43495648, "answer_count": 1, "score": 1, "last_activity_date": 1492637629, "creation_date": 1492601557, "last_edit_date": 1492637587, "question_id": 43494538, "link": "https://stackoverflow.com/questions/43494538/how-to-convert-ip-range-to-a-single-cidr-using-ruby", "title": "How to convert IP range to a single CIDR using Ruby", "body": "<p>Does Ruby have a simple way to convert a range of IP addresses to CIDR?</p>\n\n<p>I know in Python we can do it like this:</p>\n\n<pre><code>cidr = netaddr.iprange_to_cidrs(startip, endip)\n</code></pre>\n\n<p>I've looked to other questions here at StackOverflow and none of them are about converting a range of IP addresses to a <strong>single</strong> CIDR, like:</p>\n\n<pre><code>startip = '250.154.64.0'\nendip = '250.154.64.255'\n\noutput: '250.154.64.0/24'\n</code></pre>\n"}, {"tags": ["javascript", "ruby-on-rails", "ruby", "view", "filter"], "comments": [{"owner": {"reputation": 460, "user_id": 2784001, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/b4f3b49b1586a19d8a6ffbb4c75c3510?s=128&d=identicon&r=PG&f=1", "display_name": "Ankit Pandey", "link": "https://stackoverflow.com/users/2784001/ankit-pandey"}, "edited": false, "score": 0, "creation_date": 1492602481, "post_id": 43494067, "comment_id": 74043966, "body": "You can use two select tag, one for category and one for type and a submit button for search"}, {"owner": {"reputation": 9659, "user_id": 6136634, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d7487290ff90aebf6848d9c638c067bb?s=128&d=identicon&r=PG", "display_name": "Gerry", "link": "https://stackoverflow.com/users/6136634/gerry"}, "edited": false, "score": 0, "creation_date": 1492605348, "post_id": 43494067, "comment_id": 74046065, "body": "Category filter is also a link? Filters are applied one at a time? It will help if you share complete code (i.e. for both filters, no just one)."}, {"owner": {"reputation": 359, "user_id": 5647122, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/b39146a60ae9aaf0a9e3924fd4c1789a?s=128&d=identicon&r=PG&f=1", "display_name": "KingOfBabu", "link": "https://stackoverflow.com/users/5647122/kingofbabu"}, "edited": false, "score": 0, "creation_date": 1492605778, "post_id": 43494067, "comment_id": 74046416, "body": "Yes, this is two link and they are not applied at the same time. The filter for category is similar to this one."}], "answers": [{"comments": [{"owner": {"reputation": 5483, "user_id": 4481312, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/teLso.jpg?s=128&g=1", "display_name": "marmeladze", "link": "https://stackoverflow.com/users/4481312/marmeladze"}, "edited": false, "score": 0, "creation_date": 1492609154, "post_id": 43497278, "comment_id": 74049032, "body": "dude, you&#39;ve a great last name. upvoted only for this reason -))"}, {"owner": {"reputation": 2062, "user_id": 4896126, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/aUY9T.png?s=128&g=1", "display_name": "Marcos R. Guevara", "link": "https://stackoverflow.com/users/4896126/marcos-r-guevara"}, "reply_to_user": {"reputation": 5483, "user_id": 4481312, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/teLso.jpg?s=128&g=1", "display_name": "marmeladze", "link": "https://stackoverflow.com/users/4481312/marmeladze"}, "edited": false, "score": 0, "creation_date": 1492609229, "post_id": 43497278, "comment_id": 74049098, "body": "well, but here is not a site for jokes @marmeladze, people wants to solve."}, {"owner": {"reputation": 5483, "user_id": 4481312, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/teLso.jpg?s=128&g=1", "display_name": "marmeladze", "link": "https://stackoverflow.com/users/4481312/marmeladze"}, "edited": false, "score": 0, "creation_date": 1492609339, "post_id": 43497278, "comment_id": 74049186, "body": "i&#39;m not joking. your answer will work, but is not a good solution. i just upvoted for your surname."}, {"owner": {"reputation": 2062, "user_id": 4896126, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/aUY9T.png?s=128&g=1", "display_name": "Marcos R. Guevara", "link": "https://stackoverflow.com/users/4896126/marcos-r-guevara"}, "reply_to_user": {"reputation": 5483, "user_id": 4481312, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/teLso.jpg?s=128&g=1", "display_name": "marmeladze", "link": "https://stackoverflow.com/users/4481312/marmeladze"}, "edited": false, "score": 0, "creation_date": 1492609377, "post_id": 43497278, "comment_id": 74049223, "body": "ah ok, yes, is an ugly solution"}, {"owner": {"reputation": 38307, "user_id": 2057388, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ceef8c04f66cd0e2bd360ef6abc14a81?s=128&d=identicon&r=PG", "display_name": "\u0417\u0435\u043b\u0451\u043d\u044b\u0439", "link": "https://stackoverflow.com/users/2057388/%d0%97%d0%b5%d0%bb%d1%91%d0%bd%d1%8b%d0%b9"}, "edited": false, "score": 0, "creation_date": 1492609531, "post_id": 43497278, "comment_id": 74049337, "body": "This is <code>... == true</code> excess."}], "tags": [], "owner": {"reputation": 2062, "user_id": 4896126, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/aUY9T.png?s=128&g=1", "display_name": "Marcos R. Guevara", "link": "https://stackoverflow.com/users/4896126/marcos-r-guevara"}, "is_accepted": false, "score": 2, "last_activity_date": 1492608744, "creation_date": 1492608744, "answer_id": 43497278, "question_id": 43494067, "link": "https://stackoverflow.com/questions/43494067/ruby-on-rails-two-different-filter-in-view-for-the-same-data/43497278#43497278", "title": "Ruby on Rails - Two different filter in view for the same data", "body": "<pre><code>  def show_categories\n     if selected_videos == true\n      @videos = Video.joins(:media).where(\"medium.category_id = ?\", params[:id])\n     else\n      @videos = [] # not the most clean but a way is to pass an empty array...\n     end\n     if selected_pictures == true\n       @pictures = Picture.joins(:media).where(\"medium.category_id = ?\", params[:id])\n     else\n      @pictures = [] # the same, empty array...\n    end\n  end\n</code></pre>\n\n<p>Now you just need to pass something like checkboxes to enable content</p>\n"}, {"comments": [{"owner": {"reputation": 359, "user_id": 5647122, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/b39146a60ae9aaf0a9e3924fd4c1789a?s=128&d=identicon&r=PG&f=1", "display_name": "KingOfBabu", "link": "https://stackoverflow.com/users/5647122/kingofbabu"}, "edited": false, "score": 0, "creation_date": 1492613533, "post_id": 43497395, "comment_id": 74052634, "body": "So with this solution, I need to replace the link_to with checkbox ?"}, {"owner": {"reputation": 1223, "user_id": 3012473, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/gSYLc.png?s=128&g=1", "display_name": "buncis", "link": "https://stackoverflow.com/users/3012473/buncis"}, "reply_to_user": {"reputation": 359, "user_id": 5647122, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/b39146a60ae9aaf0a9e3924fd4c1789a?s=128&d=identicon&r=PG&f=1", "display_name": "KingOfBabu", "link": "https://stackoverflow.com/users/5647122/kingofbabu"}, "edited": false, "score": 1, "creation_date": 1492615692, "post_id": 43497395, "comment_id": 74054184, "body": "@KingOfBabu you can still use the link_to/button but don&#39;t forget to send the parameter to controller see this <a href=\"http://stackoverflow.com/questions/2695538/add-querystring-parameters-to-link-to\" title=\"add querystring parameters to link to\">stackoverflow.com/questions/2695538/&hellip;</a>"}, {"owner": {"reputation": 2062, "user_id": 4896126, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/aUY9T.png?s=128&g=1", "display_name": "Marcos R. Guevara", "link": "https://stackoverflow.com/users/4896126/marcos-r-guevara"}, "edited": false, "score": 0, "creation_date": 1492615985, "post_id": 43497395, "comment_id": 74054414, "body": "<code>params[:video]</code>, <code>params[:picture]</code>"}], "tags": [], "owner": {"reputation": 1223, "user_id": 3012473, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/gSYLc.png?s=128&g=1", "display_name": "buncis", "link": "https://stackoverflow.com/users/3012473/buncis"}, "is_accepted": false, "score": 2, "last_activity_date": 1492615816, "last_edit_date": 1492615816, "creation_date": 1492609065, "answer_id": 43497395, "question_id": 43494067, "link": "https://stackoverflow.com/questions/43494067/ruby-on-rails-two-different-filter-in-view-for-the-same-data/43497395#43497395", "title": "Ruby on Rails - Two different filter in view for the same data", "body": "<p>if you have created search form_tag</p>\n\n<p>just add toggle form/checkboxes for each type then add the condition in controller</p>\n\n<pre><code>def show_categories\n  @pictures = Picture.joins(:media).where(\"medium.category_id = ?\", params[:category]) if params[:picture]=='true'   \n  @videos = Video.joins(:media).where(\"medium.category_id = ?\", params[:category]) if params[:video]=='true'\nend\n</code></pre>\n\n<p>I expected the url will be like this</p>\n\n<pre><code>yourhostname/yourmodels?utf8=\u2713&amp;picture=boolean&amp;video=boolean&amp;category=integer\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 9659, "user_id": 6136634, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d7487290ff90aebf6848d9c638c067bb?s=128&d=identicon&r=PG", "display_name": "Gerry", "link": "https://stackoverflow.com/users/6136634/gerry"}, "is_accepted": true, "score": 1, "last_activity_date": 1492629211, "last_edit_date": 1492629211, "creation_date": 1492621036, "answer_id": 43501801, "question_id": 43494067, "link": "https://stackoverflow.com/questions/43494067/ruby-on-rails-two-different-filter-in-view-for-the-same-data/43501801#43501801", "title": "Ruby on Rails - Two different filter in view for the same data", "body": "<p>If i understand correctly, the problem seems to be that your app doesn't <em>remember</em> the value of previous filter.</p>\n\n<p>You can simulate this by sending the selected filters as parameters and adding them to your links, so the next request will get the value of the previous filter (if any).</p>\n\n<p>There is no need to use separate actions, the filters can be applied with just one action in your controller (i used <code>show_media</code> in my example), you just need to check <code>params</code> to show the right information.</p>\n\n<pre><code># controller/galeries_controller.rb\n\ndef show_media\n  @category = params[:category]\n  @type     = params[:type]\n  @pictures = media(Picture) if @type == \"pictures\"\n  @videos   = media(Video) if @type == \"videos\"\nend\n\nprivate\ndef media(model)\n  if @category.blank?\n    model.order('created_at DESC')\n  else\n    model.joins(:media).where(\"medium.category_id = ?\", params[:id])\n  end\nend\n</code></pre>\n\n<p>Here you are setting the values for <code>@pictues</code> or <code>@videos</code>, but instead of using two actions, you just check the <code>type</code> to set one or the other.</p>\n\n<p>The method <code>media</code> receives the model object (<code>Video</code> or <code>Picture</code>) to be used and returns the related model records depending if <code>category</code> is provided or not (this helps you DRY your code a little).</p>\n\n<p>Next, you must update your links to include both <code>type</code> and <code>category</code>, this needs to be done in both <code>index.html.erb</code> and <code>show_media.js.erb</code>:</p>\n\n<pre><code># index.html.erb\n\n&lt;%= link_to show_media_path(type: \"pictures\"), remote: true, id: \"btn-pictures\", class: \"btn btn-default\" do %&gt;\n    &lt;em class=\"glyphicon glyphicon-picture\"&gt;&lt;/em&gt; Pictures\n&lt;% end %&gt;\n\n&lt;%= link_to show_media_path(type: \"videos\"), remote: true, id: \"btn-videos\", class: \"btn btn-default\" do %&gt;\n    &lt;em class=\"glyphicon glyphicon-video\"&gt;&lt;/em&gt; Videos\n&lt;% end %&gt;\n\n&lt;% @categories.each do |c| %&gt;\n  &lt;li class=\"\" id=\"btn-filter&lt;%= c.id %&gt;\"&gt;\n    &lt;%= link_to show_categories_path(id: c.id), remote: true, \"data-category-id\": c.id, class: \"category-id\" do %&gt;\n    &lt;span class=\"badge pull-right\"&gt;&lt;%= Media.joins(:pictures).where(category_id: c.id).count + Media.joins(:videos).where(category_id: c.id).count  %&gt;&lt;/span&gt; &lt;%= c.name %&gt;\n    &lt;% end %&gt;\n  &lt;/li&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>We added <code>type</code> to <code>pictures</code> and <code>videos</code> (no <code>category</code> since none is selected yet), and a couple of attributes (<code>data-category-id</code> and <code>class</code>) to your categories links to be able to identify them on <code>show_media.js.erb</code>.</p>\n\n<pre><code># show_media.js.erb\n\n$(\"#media_filter\").html(\"&lt;%= escape_javascript(render partial: 'partials/media_filter', locals: { medias: @videos} ) %&gt;\"); \n$(\"#media_filter\").append(\"&lt;%= escape_javascript(render partial: 'partials/media_filter', locals: { medias: @pictures } ) %&gt;\");\n$(#'btn-pictures').attr('href',\"&lt;%= show_media_path(type: 'pictures', category: @category) %&gt;\");\n$(#'btn-videos').attr('href',\"&lt;%= show_media_path(type: 'pictures', category: @category) %&gt;\");\n$('.category-id').each(function() {\n  $(this).attr(\"href\", \"/show_media?type=&lt;%= @type %&gt;\" + \"&amp;category=\" + $(this).attr(\"data-category-id\");\n});\n</code></pre>\n\n<p>The added lines will modify your links to include both <code>type</code> and <code>category</code> parameters depending on what have you requested before, using the <code>@category</code> and <code>@type</code> variables created in your controller.</p>\n\n<p>Now, no matter what you click first, you will always pass the correct selected filters to your controller without losing them every time.</p>\n"}], "owner": {"reputation": 359, "user_id": 5647122, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/b39146a60ae9aaf0a9e3924fd4c1789a?s=128&d=identicon&r=PG&f=1", "display_name": "KingOfBabu", "link": "https://stackoverflow.com/users/5647122/kingofbabu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 400, "favorite_count": 0, "accepted_answer_id": 43501801, "answer_count": 3, "score": 0, "last_activity_date": 1492629211, "creation_date": 1492600231, "last_edit_date": 1492607343, "question_id": 43494067, "link": "https://stackoverflow.com/questions/43494067/ruby-on-rails-two-different-filter-in-view-for-the-same-data", "title": "Ruby on Rails - Two different filter in view for the same data", "body": "<p>On the main page, I have a list of videos and pictures. Those videos &amp; pictures belongs to a category. So, I have a filter for the category and one for the type(vid\u00e9os or pictures). The problem is that I can't use both filter at the same time without altering the first one. If for example I want to show only the picture and then I want a specific category, I get all pictures and <strong>videos</strong> from the category selected. <BR/> Exemple with a filter of pictures :<BR/> view/galeries/index.html.erb</p>\n\n<pre><code>&lt;%= link_to show_pictures_path, :remote =&gt; true, :id =&gt; \"btn-pictures\", :class =&gt; \"btn btn-default\" do %&gt;\n&lt;em class=\"glyphicon glyphicon-picture\"&gt;&lt;/em&gt; Pictures\n&lt;% end %&gt;\n</code></pre>\n\n<p>controller/galeries_controller.rb</p>\n\n<pre><code>  def show_pictures\n    @selected = Picture.order('created_at DESC')\n  end\n</code></pre>\n\n<p>view/galeries/show_pictures.js.erb</p>\n\n<pre><code>$(\"#media_filter\").html(\"&lt;%= escape_javascript(render partial: 'partials/media_filter', locals: { medias: @selected } ) %&gt;\");\n</code></pre>\n\n<p><BR/>EDIT - Exemple for categories : \n<BR/>\nview/galeries/index.html.erb</p>\n\n<pre><code>&lt;% @categories.each do |c| %&gt;\n  &lt;li class=\"\" id=btn-filter&lt;%=c.id%&gt;&gt;\n    &lt;%= link_to show_categories_path(:id =&gt; c.id), :remote =&gt; true do %&gt;\n    &lt;span class=\"badge pull-right\"&gt;&lt;%= Media.joins(:pictures).where(category_id: c.id).count + Media.joins(:videos).where(category_id: c.id).count  %&gt;&lt;/span&gt; &lt;%= c.name %&gt;\n    &lt;% end %&gt;\n  &lt;/li&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>controller/galeries_controller.rb</p>\n\n<pre><code>  def show_categories\n   @videos = Video.joins(:media).where(\"medium.category_id = ?\", params[:id])\n   @pictures = Picture.joins(:media).where(\"medium.category_id = ?\", params[:id])\n  end\n</code></pre>\n\n<p>view/galeries/show_categories.js.erb</p>\n\n<pre><code>$(\"#media_filter\").html(\"&lt;%= escape_javascript(render partial: 'partials/media_filter', locals: { medias: @videos} ) %&gt;\"); \n$(\"#media_filter\").append(\"&lt;%= escape_javascript(render partial: 'partials/media_filter', locals: { medias: @pictures } ) %&gt;\");\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "postgresql", "pg-search"], "comments": [{"owner": {"reputation": 5483, "user_id": 4481312, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/teLso.jpg?s=128&g=1", "display_name": "marmeladze", "link": "https://stackoverflow.com/users/4481312/marmeladze"}, "edited": false, "score": 0, "creation_date": 1492599018, "post_id": 43493378, "comment_id": 74041463, "body": "yeah, of course it is possible. if it wouldn&#39;t be possible, you should not even think about it -)) post some code -))"}, {"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 0, "creation_date": 1492637738, "post_id": 43493378, "comment_id": 74067689, "body": "Please read &quot;<a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a>&quot; and &quot;<a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>&quot; and their linked pages. It isn&#39;t clear and is broad."}], "answers": [{"comments": [{"owner": {"reputation": 119, "user_id": 7039910, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/464edee302c4920a64df3b21810ed084?s=128&d=identicon&r=PG&f=1", "display_name": "crcerror", "link": "https://stackoverflow.com/users/7039910/crcerror"}, "edited": false, "score": 0, "creation_date": 1492656611, "post_id": 43493945, "comment_id": 74073036, "body": "well maybe, but I didn&#39;t see any info about defining search function in PgSearch manuals. I added some code, maybe it will be clearer to solve the puzzle."}], "tags": [], "owner": {"reputation": 126, "user_id": 7671535, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d72f2ebb9c75787f4eed75f12d82a96?s=128&d=identicon&r=PG&f=1", "display_name": "pip36", "link": "https://stackoverflow.com/users/7671535/pip36"}, "is_accepted": false, "score": 0, "last_activity_date": 1492599859, "creation_date": 1492599859, "answer_id": 43493945, "question_id": 43493378, "link": "https://stackoverflow.com/questions/43493378/pg-search-rails-prevent-redirect-to-page-with-search-results-if-there-wasnt/43493945#43493945", "title": "pg_search + Rails - Prevent redirect to page with search results if there wasnt&#39;t any of them", "body": "<p>Something like this?</p>\n\n<pre><code>if (&lt;your search function&gt;).empty?\n  flash.now[:notice] = \"No, results\"\n  render '&lt;your current search page&gt;'\nelse\n  redirect_to '&lt;your search results page&gt;'\nend\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 119, "user_id": 7039910, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/464edee302c4920a64df3b21810ed084?s=128&d=identicon&r=PG&f=1", "display_name": "crcerror", "link": "https://stackoverflow.com/users/7039910/crcerror"}, "edited": false, "score": 0, "creation_date": 1492655586, "post_id": 43494835, "comment_id": 74072791, "body": "Well, the point is not to define was there any text to search but to check before the forwarding to results page - do rails have any results to show and if not - avoid redirecting.  But I must admit you&#39;re right - I surely must add some code to check if there any text to search. Thanks :)"}, {"owner": {"reputation": 119, "user_id": 7039910, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/464edee302c4920a64df3b21810ed084?s=128&d=identicon&r=PG&f=1", "display_name": "crcerror", "link": "https://stackoverflow.com/users/7039910/crcerror"}, "edited": false, "score": 0, "creation_date": 1492656282, "post_id": 43494835, "comment_id": 74072957, "body": "Well, it seems to me multisearch is more complicated than I think. What I did wrong here? Didn&#39;t see any flash.now.  def self.multisearch(query)     if query.present?       multisearch(query)     else       flash.now[:notice] = &quot;alert! no query at all!&quot;     end   end"}], "tags": [], "owner": {"reputation": 6105, "user_id": 1700874, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/ad36477949cfd7db659cd4420537911c?s=128&d=identicon&r=PG&f=1", "display_name": "The Whiz of Oz", "link": "https://stackoverflow.com/users/1700874/the-whiz-of-oz"}, "is_accepted": false, "score": 0, "last_activity_date": 1492602325, "creation_date": 1492602325, "answer_id": 43494835, "question_id": 43493378, "link": "https://stackoverflow.com/questions/43493378/pg-search-rails-prevent-redirect-to-page-with-search-results-if-there-wasnt/43494835#43494835", "title": "pg_search + Rails - Prevent redirect to page with search results if there wasnt&#39;t any of them", "body": "<p>I recommend using the model approach</p>\n\n<p>Article.rb</p>\n\n<pre><code>  def self.search(query)\n    if query.present?\n      search_for(query) # takes you to your search method\n    else\n      # No query? Return all records, newest first.\n      Article.all.order('updated_at DESC')\n    end\n  end\n\npg_search_scope :search_for,\n  ...\n</code></pre>\n\n<p>Article index or search search results page</p>\n\n<pre><code>- if @articles.present?\n  # Show articles\n- else\n  p No articles found. Use other queries\n</code></pre>\n\n<p>Controller</p>\n\n<pre><code>  def index\n    @articles = Article.search(params[:query])\n</code></pre>\n\n<p>Best practice is to always tell the user whether he is getting any results or if he made a typo or needs to look things up differently.</p>\n"}], "owner": {"reputation": 119, "user_id": 7039910, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/464edee302c4920a64df3b21810ed084?s=128&d=identicon&r=PG&f=1", "display_name": "crcerror", "link": "https://stackoverflow.com/users/7039910/crcerror"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 156, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1492655354, "creation_date": 1492598437, "last_edit_date": 1492655354, "question_id": 43493378, "link": "https://stackoverflow.com/questions/43493378/pg-search-rails-prevent-redirect-to-page-with-search-results-if-there-wasnt", "title": "pg_search + Rails - Prevent redirect to page with search results if there wasnt&#39;t any of them", "body": "<p>Appreciate for a help. I'm using Rails 4, ruby 2.2.3 and PostgreSQL 9.6. \nI have website with search based on pg_search, and it works perfectly with multiple models:</p>\n\n<pre><code>/app/models/event.rb:\n\nmultisearchable against: [:title, :subtitle]\n</code></pre>\n\n<p>Both searchable models and search controller setted up very simple by official manuals.</p>\n\n<pre><code>/app/controllers/results_controller.rb:\n\nclass ResultsController &lt; FrontendController\n  def index\n    @search_results = PgSearch.multisearch(params[:query])\n  end\nend\n</code></pre>\n\n<p>And my results view:</p>\n\n<pre><code>/app/views/results/index.slim:\n\n.search-results-wrap\n  - @search_results.each do |pg_search_document|\n    #showing title of each result, etc.\n</code></pre>\n\n<p>Now I need to improve it by checking before redirect to page with search results - are there any results at all? I mean, there isn't much sense in redirecting if there are no results and it will be more smart to just show a flash message(or something like that) \"sorry, no results\" on current page.</p>\n\n<p>Is there possible ways to do it?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "database", "sqlite"], "comments": [{"owner": {"reputation": 47232, "user_id": 1772830, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/Qtoqg.jpg?s=128&g=1", "display_name": "Andrey Deineko", "link": "https://stackoverflow.com/users/1772830/andrey-deineko"}, "edited": false, "score": 3, "creation_date": 1492596518, "post_id": 43492575, "comment_id": 74039742, "body": "capitalize: <code>Genre.new</code> :) (It&#39;s assuming you have created corresponding models under <code>&#47;app&#47;models</code>)"}, {"owner": {"reputation": 159, "user_id": 6090227, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh4.googleusercontent.com/-BSkQ2-EmWyw/AAAAAAAAAAI/AAAAAAAABC4/ZBDdVA1dosQ/photo.jpg?sz=128", "display_name": "sindhugauri", "link": "https://stackoverflow.com/users/6090227/sindhugauri"}, "reply_to_user": {"reputation": 47232, "user_id": 1772830, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/Qtoqg.jpg?s=128&g=1", "display_name": "Andrey Deineko", "link": "https://stackoverflow.com/users/1772830/andrey-deineko"}, "edited": false, "score": 0, "creation_date": 1492596709, "post_id": 43492575, "comment_id": 74039882, "body": "@AndreyDeineko, it&#39;s giving this error: NameError: undefined local variable or method `slef&#39; for #&lt;Class:0x00557fd5727ba8&gt; Did you mean?  sleep  This is followed by some other messages which are similar to the one I posted originally..."}, {"owner": {"reputation": 47232, "user_id": 1772830, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/Qtoqg.jpg?s=128&g=1", "display_name": "Andrey Deineko", "link": "https://stackoverflow.com/users/1772830/andrey-deineko"}, "edited": false, "score": 0, "creation_date": 1492597302, "post_id": 43492575, "comment_id": 74040291, "body": "Look where stacktrace points you <code>Rails&#47;ScholarShip&#47;ScholarShip&#47;app&#47;models&#47;genre.rb:2:in &#39;&lt;class:Genre&gt;&#39;</code> - it&#39;s the approximate place of where error comes from"}], "answers": [{"tags": [], "owner": {"reputation": 4527, "user_id": 5497690, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/577c8ad14fffb59cd619e43634c51dad?s=128&d=identicon&r=PG&f=1", "display_name": "puneet18", "link": "https://stackoverflow.com/users/5497690/puneet18"}, "is_accepted": false, "score": 2, "last_activity_date": 1492596741, "last_edit_date": 1492596741, "creation_date": 1492596642, "answer_id": 43492658, "question_id": 43492575, "link": "https://stackoverflow.com/questions/43492575/add-record-to-the-tables-in-rails/43492658#43492658", "title": "Add record to the tables in rails", "body": "<p>Try below code to initialize object:</p>\n\n<pre><code>Genre.new\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 159, "user_id": 6090227, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh4.googleusercontent.com/-BSkQ2-EmWyw/AAAAAAAAAAI/AAAAAAAABC4/ZBDdVA1dosQ/photo.jpg?sz=128", "display_name": "sindhugauri", "link": "https://stackoverflow.com/users/6090227/sindhugauri"}, "edited": false, "score": 0, "creation_date": 1492599393, "post_id": 43493412, "comment_id": 74041763, "body": "Wow. That was the problem. How foolish of me. Thanks a lot @MayankJani"}], "tags": [], "owner": {"reputation": 76, "user_id": 3805343, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d9e1f88c4fd882c7cbc141b59e6fb26c?s=128&d=identicon&r=PG", "display_name": "Mayank Jani", "link": "https://stackoverflow.com/users/3805343/mayank-jani"}, "is_accepted": true, "score": 2, "last_activity_date": 1492603875, "last_edit_date": 1492603875, "creation_date": 1492598548, "answer_id": 43493412, "question_id": 43492575, "link": "https://stackoverflow.com/questions/43492575/add-record-to-the-tables-in-rails/43493412#43493412", "title": "Add record to the tables in rails", "body": "<p>Did you used <code>slef</code> instead of <code>self</code> anywhere into genre model (<code>app/models/genre.rb</code>)?</p>\n\n<p>Can you please post code of genre model?</p>\n"}], "owner": {"reputation": 159, "user_id": 6090227, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh4.googleusercontent.com/-BSkQ2-EmWyw/AAAAAAAAAAI/AAAAAAAABC4/ZBDdVA1dosQ/photo.jpg?sz=128", "display_name": "sindhugauri", "link": "https://stackoverflow.com/users/6090227/sindhugauri"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 65, "favorite_count": 0, "accepted_answer_id": 43493412, "answer_count": 2, "score": 1, "last_activity_date": 1492603875, "creation_date": 1492596427, "last_edit_date": 1492596893, "question_id": 43492575, "link": "https://stackoverflow.com/questions/43492575/add-record-to-the-tables-in-rails", "title": "Add record to the tables in rails", "body": "<p>This is my schema.rb file (to show you the tables I've made)</p>\n\n<pre><code>ActiveRecord::Schema.define(version: 20170413171853) do\n\ncreate_table \"bookmarks\", force: :cascade do |t|\nt.string   \"bk_name\"\nt.string   \"size\"\nt.string   \"brand\"\nt.string   \"product_id\"\nt.integer  \"mrp\"\nt.text     \"colour\"\nt.integer  \"stock\"\nt.integer  \"discount\"\nt.text     \"bk_description\"\nt.integer  \"bk_id\"\nt.integer  \"cart_unit\"\nt.datetime \"created_at\",     null: false\nt.datetime \"updated_at\",     null: false\nend\n\n\n\ncreate_table \"books\", force: :cascade do |t|\n    t.string   \"book_name\"\n    t.integer  \"cart_unit\"\n    t.integer  \"product_id\"\n    t.integer  \"pages\"\n    t.integer  \"stock\"\n    t.text     \"synopsis\"\n    t.integer  \"mrp\"\n    t.string   \"author\"\n    t.string   \"publisher\"\n    t.integer  \"rating\"\n    t.string   \"genre_name\"\n    t.integer  \"book_id\"\n    t.integer  \"genre_id\"\n    t.integer  \"discount\"\n    t.datetime \"created_at\", null: false\n    t.datetime \"updated_at\", null: false\n  end\n\n  create_table \"customers\", force: :cascade do |t|\n    t.integer  \"customer_id\"\n    t.integer  \"phone\"\n    t.string   \"email\"\n    t.string   \"password\"\n    t.string   \"last_name\"\n    t.string   \"first_name\"\n    t.string   \"address_1\"\n    t.string   \"address_2\"\n    t.string   \"city\"\n    t.string   \"state\"\n    t.integer  \"postal_code\"\n    t.datetime \"created_at\",  null: false\n    t.datetime \"updated_at\",  null: false\n  end\n\n  create_table \"genres\", force: :cascade do |t|\n    t.integer  \"genre_id\"\n    t.string   \"genre_name\"\n    t.text     \"description\"\n    t.datetime \"created_at\",  null: false\n    t.datetime \"updated_at\",  null: false\n  end\n\n  create_table \"notebooks\", force: :cascade do |t|\n    t.integer  \"ntbk_id\"\n    t.integer  \"pages\"\n    t.text     \"ntbk_description\"\n    t.string   \"ntbk_name\"\n    t.string   \"brand\"\n    t.integer  \"product_id\"\n    t.text     \"colour\"\n    t.text     \"stock\"\n    t.integer  \"mrp\"\n    t.integer  \"cart_unit\"\n    t.integer  \"discount\"\n    t.datetime \"created_at\",       null: false\n    t.datetime \"updated_at\",       null: false\n  end\n\n  create_table \"orders\", force: :cascade do |t|\n    t.integer  \"order_id\"\n    t.integer  \"order_number\"\n    t.date     \"order_date\"\n    t.date     \"shipping_date\"\n    t.date     \"payment_date\"\n    t.integer  \"bk_id\"\n    t.string   \"bk_name\"\n    t.integer  \"ntbk_id\"\n    t.integer  \"bk_cart\"\n    t.integer  \"book_cart\"\n    t.integer  \"ntbk_cart\"\n    t.string   \"ntbk_name\"\n    t.integer  \"ntbk_mrp\"\n    t.integer  \"bk_mrp\"\n    t.integer  \"book_mrp\"\n    t.string   \"book_name\"\n    t.integer  \"book_id\"\n    t.datetime \"created_at\",    null: false\n    t.datetime \"updated_at\",    null: false\n  end\n\n  create_table \"products\", force: :cascade do |t|\n    t.integer  \"product_id\"\n    t.string   \"product_name\"\n    t.text     \"description\"\n    t.datetime \"created_at\",   null: false\n    t.datetime \"updated_at\",   null: false\n  end\n\n  create_table \"reviews\", force: :cascade do |t|\n    t.integer  \"review_id\"\n    t.integer  \"ntbk_id\"\n    t.integer  \"bk_id\"\n    t.integer  \"customer_id\"\n    t.integer  \"rating\"\n    t.text     \"content\"\n    t.date     \"date_written\"\n    t.integer  \"book_id\"\n    t.datetime \"created_at\",   null: false\n    t.datetime \"updated_at\",   null: false\n  end\n\nend\n</code></pre>\n\n<p>My problem is this: I want to add records to the tables. I ran the command <em>rails console --sandbox</em>. I've read that if you haven't added anything to the tables and run say bookmark.new, it'll return an object with attributes as nill. Well this isn't happening in my case.</p>\n\n<pre><code>irb(main):001:0&gt; genre.new\nNameError: undefined local variable or method `genre' for main:Object\n    from (irb):1\nfrom /home/gauri/.rbenv/versions/2.4.0/lib/ruby/gems/2.4.0/gems/railties-5.0.1/lib/rails/commands/console.rb:65:in `start'\n\nfrom /home/gauri/.rbenv/versions/2.4.0/lib/ruby/gems/2.4.0/gems/railties-5.0.1/lib/rails/commands/console_helper.rb:9:in `start'\n\nfrom /home/gauri/.rbenv/versions/2.4.0/lib/ruby/gems/2.4.0/gems/railties-5.0.1/lib/rails/commands/commands_tasks.rb:78:in `console'\n\nfrom /home/gauri/.rbenv/versions/2.4.0/lib/ruby/gems/2.4.0/gems/railties-5.0.1/lib/rails/commands/commands_tasks.rb:49:in `run_command!'\n\nfrom /home/gauri/.rbenv/versions/2.4.0/lib/ruby/gems/2.4.0/gems/railties-5.0.1/lib/rails/commands.rb:18:in `&lt;top (required)&gt;'\n\nfrom /home/gauri/.rbenv/versions/2.4.0/lib/ruby/gems/2.4.0/gems/activesupport-5.0.1/lib/active_support/dependencies.rb:293:in `require'\n\nfrom /home/gauri/.rbenv/versions/2.4.0/lib/ruby/gems/2.4.0/gems/activesupport-5.0.1/lib/active_support/dependencies.rb:293:in `block in require'\n\nfrom /home/gauri/.rbenv/versions/2.4.0/lib/ruby/gems/2.4.0/gems/activesupport-5.0.1/lib/active_support/dependencies.rb:259:in `load_dependency'\n\nfrom /home/gauri/.rbenv/versions/2.4.0/lib/ruby/gems/2.4.0/gems/activesupport-5.0.1/lib/active_support/dependencies.rb:293:in `require'\n\nfrom /home/gauri/Academics/CS/Ruby on Rails/ScholarShip/ScholarShip/bin/rails:9:in `&lt;top (required)&gt;'\n\nfrom /home/gauri/.rbenv/versions/2.4.0/lib/ruby/gems/2.4.0/gems/activesupport-5.0.1/lib/active_support/dependencies.rb:287:in `load'\n\nfrom /home/gauri/.rbenv/versions/2.4.0/lib/ruby/gems/2.4.0/gems/activesupport-5.0.1/lib/active_support/dependencies.rb:287:in `block in load'\n\nfrom /home/gauri/.rbenv/versions/2.4.0/lib/ruby/gems/2.4.0/gems/activesupport-5.0.1/lib/active_support/dependencies.rb:259:in `load_dependency'\n\nfrom /home/gauri/.rbenv/versions/2.4.0/lib/ruby/gems/2.4.0/gems/activesupport-5.0.1/lib/active_support/dependencies.rb:287:in `load'\n\nfrom /home/gauri/.rbenv/versions/2.4.0/lib/ruby/gems/2.4.0/gems/spring-2.0.1/lib/spring/commands/rails.rb:6:in `call'\n\nfrom /home/gauri/.rbenv/versions/2.4.0/lib/ruby/gems/2.4.0/gems/spring-2.0.1/lib/spring/command_wrapper.rb:38:in `call'\n\nfrom /home/gauri/.rbenv/versions/2.4.0/lib/ruby/gems/2.4.0/gems/spring-2.0.1/lib/spring/application.rb:191:in `block in serve'\n\nfrom /home/gauri/.rbenv/versions/2.4.0/lib/ruby/gems/2.4.0/gems/spring-2.0.1/lib/spring/application.rb:161:in `fork'\n\nfrom /home/gauri/.rbenv/versions/2.4.0/lib/ruby/gems/2.4.0/gems/spring-2.0.1/lib/spring/application.rb:161:in `serve'\n\nfrom /home/gauri/.rbenv/versions/2.4.0/lib/ruby/gems/2.4.0/gems/spring-2.0.1/lib/spring/application.rb:131:in `block in run'\n\nfrom /home/gauri/.rbenv/versions/2.4.0/lib/ruby/gems/2.4.0/gems/spring-2.0.1/lib/spring/application.rb:125:in `loop'\n\nfrom /home/gauri/.rbenv/versions/2.4.0/lib/ruby/gems/2.4.0/gems/spring-2.0.1/lib/spring/application.rb:125:in `run'\n\nfrom /home/gauri/.rbenv/versions/2.4.0/lib/ruby/gems/2.4.0/gems/spring-2.0.1/lib/spring/application/boot.rb:19:in `&lt;top (required)&gt;'\n\nfrom /home/gauri/.rbenv/versions/2.4.0/lib/ruby/2.4.0/rubygems/core_ext/kernel_require.rb:55:in `require'\n\nfrom /home/gauri/.rbenv/versions/2.4.0/lib/ruby/2.4.0/rubygems/core_ext/kernel_require.rb:55:in `require'\nfrom -e:1:in `&lt;main&gt;'\n</code></pre>\n\n<p>What on Earth is happening and why?</p>\n\n<p>EDIT: On typing Genre.new, this happens:-</p>\n\n<pre><code>NameError: undefined local variable or method `slef' for #&lt;Class:0x00557fd5727ba8&gt;\nDid you mean?  sleep\n    from /home/gauri/.rbenv/versions/2.4.0/lib/ruby/gems/2.4.0/gems/activerecord-5.0.1/lib/active_record/dynamic_matchers.rb:21:in `method_missing'\n    from /home/gauri/Academics/CS/Ruby on Rails/ScholarShip/ScholarShip/app/models/genre.rb:2:in `&lt;class:Genre&gt;'\n    from /home/gauri/Academics/CS/Ruby on Rails/ScholarShip/ScholarShip/app/models/genre.rb:1:in `&lt;top (required)&gt;'\n    from /home/gauri/.rbenv/versions/2.4.0/lib/ruby/gems/2.4.0/gems/activesupport-5.0.1/lib/active_support/dependencies.rb:477:in `load'\n    from /home/gauri/.rbenv/versions/2.4.0/lib/ruby/gems/2.4.0/gems/activesupport-5.0.1/lib/active_support/dependencies.rb:477:in `block in load_file'\n    from /home/gauri/.rbenv/versions/2.4.0/lib/ruby/gems/2.4.0/gems/activesupport-5.0.1/lib/active_support/dependencies.rb:662:in `new_constants_in'\n    from /home/gauri/.rbenv/versions/2.4.0/lib/ruby/gems/2.4.0/gems/activesupport-5.0.1/lib/active_support/dependencies.rb:476:in `load_file'\n    from /home/gauri/.rbenv/versions/2.4.0/lib/ruby/gems/2.4.0/gems/activesupport-5.0.1/lib/active_support/dependencies.rb:375:in `block in require_or_load'\n    from /home/gauri/.rbenv/versions/2.4.0/lib/ruby/gems/2.4.0/gems/activesupport-5.0.1/lib/active_support/dependencies.rb:37:in `block in load_interlock'\n    from /home/gauri/.rbenv/versions/2.4.0/lib/ruby/gems/2.4.0/gems/activesupport-5.0.1/lib/active_support/dependencies/interlock.rb:12:in `block in loading'\n    from /home/gauri/.rbenv/versions/2.4.0/lib/ruby/gems/2.4.0/gems/activesupport-5.0.1/lib/active_support/concurrency/share_lock.rb:150:in `exclusive'\n    from /home/gauri/.rbenv/versions/2.4.0/lib/ruby/gems/2.4.0/gems/activesupport-5.0.1/lib/active_support/dependencies/interlock.rb:11:in `loading'\n    from /home/gauri/.rbenv/versions/2.4.0/lib/ruby/gems/2.4.0/gems/activesupport-5.0.1/lib/active_support/dependencies.rb:37:in `load_interlock'\n    from /home/gauri/.rbenv/versions/2.4.0/lib/ruby/gems/2.4.0/gems/activesupport-5.0.1/lib/active_support/dependencies.rb:358:in `require_or_load'\n    from /home/gauri/.rbenv/versions/2.4.0/lib/ruby/gems/2.4.0/gems/activesupport-5.0.1/lib/active_support/dependencies.rb:511:in `load_missing_constant'\n    from /home/gauri/.rbenv/versions/2.4.0/lib/ruby/gems/2.4.0/gems/activesupport-5.0.1/lib/active_support/dependencies.rb:203:in `const_missing'\n... 2 levels...\n    from /home/gauri/.rbenv/versions/2.4.0/lib/ruby/gems/2.4.0/gems/railties-5.0.1/lib/rails/commands/console_helper.rb:9:in `start'\n    from /home/gauri/.rbenv/versions/2.4.0/lib/ruby/gems/2.4.0/gems/railties-5.0.1/lib/rails/commands/commands_tasks.rb:78:in `console'\n    from /home/gauri/.rbenv/versions/2.4.0/lib/ruby/gems/2.4.0/gems/railties-5.0.1/lib/rails/commands/commands_tasks.rb:49:in `run_command!'\n    from /home/gauri/.rbenv/versions/2.4.0/lib/ruby/gems/2.4.0/gems/railties-5.0.1/lib/rails/commands.rb:18:in `&lt;top (required)&gt;'\n    from /home/gauri/.rbenv/versions/2.4.0/lib/ruby/gems/2.4.0/gems/activesupport-5.0.1/lib/active_support/dependencies.rb:293:in `require'\n    from /home/gauri/.rbenv/versions/2.4.0/lib/ruby/gems/2.4.0/gems/activesupport-5.0.1/lib/active_support/dependencies.rb:293:in `block in require'\n    from /home/gauri/.rbenv/versions/2.4.0/lib/ruby/gems/2.4.0/gems/activesupport-5.0.1/lib/active_support/dependencies.rb:259:in `load_dependency'\n    from /home/gauri/.rbenv/versions/2.4.0/lib/ruby/gems/2.4.0/gems/activesupport-5.0.1/lib/active_support/dependencies.rb:293:in `require'\n    from /home/gauri/Academics/CS/Ruby on Rails/ScholarShip/ScholarShip/bin/rails:9:in `&lt;top (required)&gt;'\n    from /home/gauri/.rbenv/versions/2.4.0/lib/ruby/gems/2.4.0/gems/activesupport-5.0.1/lib/active_support/dependencies.rb:287:in `load'\n    from /home/gauri/.rbenv/versions/2.4.0/lib/ruby/gems/2.4.0/gems/activesupport-5.0.1/lib/active_support/dependencies.rb:287:in `block in load'\n    from /home/gauri/.rbenv/versions/2.4.0/lib/ruby/gems/2.4.0/gems/activesupport-5.0.1/lib/active_support/dependencies.rb:259:in `load_dependency'\n    from /home/gauri/.rbenv/versions/2.4.0/lib/ruby/gems/2.4.0/gems/activesupport-5.0.1/lib/active_support/dependencies.rb:287:in `load'\n    from /home/gauri/.rbenv/versions/2.4.0/lib/ruby/2.4.0/rubygems/core_ext/kernel_require.rb:55:in `require'\n    from /home/gauri/.rbenv/versions/2.4.0/lib/ruby/2.4.0/rubygems/core_ext/kernel_require.rb:55:in `require'\n    from -e:1:in `&lt;main&gt;'\n</code></pre>\n"}, {"tags": ["ruby", "ruby-on-rails-4", "paperclip", "dropzone.js"], "answers": [{"comments": [{"owner": {"reputation": 142, "user_id": 1934322, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/32b206381eb6824c26dd292b03ec2dfa?s=128&d=identicon&r=PG", "display_name": "QNeville", "link": "https://stackoverflow.com/users/1934322/qneville"}, "edited": false, "score": 0, "creation_date": 1492617917, "post_id": 43494386, "comment_id": 74055790, "body": "And you are correct! I spent way too much time on this. Thank you!"}], "tags": [], "owner": {"reputation": 4644, "user_id": 2594185, "user_type": "registered", "profile_image": "https://graph.facebook.com/100003773788931/picture?type=large", "display_name": "Jagdeep Singh", "link": "https://stackoverflow.com/users/2594185/jagdeep-singh"}, "is_accepted": true, "score": 1, "last_activity_date": 1492601106, "creation_date": 1492601106, "answer_id": 43494386, "question_id": 43492492, "link": "https://stackoverflow.com/questions/43492492/dropzone-js-unpermitted-parameters-in-rails-4/43494386#43494386", "title": "Dropzone JS Unpermitted Parameters In Rails 4", "body": "<p>From your model <code>Photo</code> definition, it is clear that you want to upload 1 attachment file per record. But the params you are receiving in your controller are those for uploading multiple attachments.</p>\n\n<pre><code>{ ..., attachment =&gt; { 0 =&gt; #&lt;ActionDispatch::Http::UploadedFile }, ... }\n</code></pre>\n\n<p>If you want to permit only 1 attachment in your params, your params should be in form:</p>\n\n<pre><code>{ ..., attachment =&gt; #&lt;ActionDispatch::Http::UploadedFile, ... }\n</code></pre>\n\n<p>Looking at the <a href=\"http://www.dropzonejs.com/#config-uploadMultiple\" rel=\"nofollow noreferrer\">dropzone options</a>, i would say, try to change <code>uploadMultiple: true</code> to <code>uploadMultiple: false</code> in drop zone configuration. Let me know, if the problem still persists.</p>\n"}], "owner": {"reputation": 142, "user_id": 1934322, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/32b206381eb6824c26dd292b03ec2dfa?s=128&d=identicon&r=PG", "display_name": "QNeville", "link": "https://stackoverflow.com/users/1934322/qneville"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 538, "favorite_count": 0, "accepted_answer_id": 43494386, "answer_count": 1, "score": 0, "last_activity_date": 1492601106, "creation_date": 1492596200, "question_id": 43492492, "link": "https://stackoverflow.com/questions/43492492/dropzone-js-unpermitted-parameters-in-rails-4", "title": "Dropzone JS Unpermitted Parameters In Rails 4", "body": "<p>I've been struggling with this issue all night. I'm trying to upload multiple \"Photo\" models with Dropzone.js with the paperclip attribute \"attachment\". Currently I'm using the DropZone-Rails gem (I've tried several versions all with same result).</p>\n\n<pre><code># photo.rb\n\nclass Photo &lt; ActiveRecord::Base\n\n  has_attached_file :attachment, styles: { medium: \"720x720&gt;\", thumb: \"360x360&gt;\" }, default_url: \"/images/:style/missing.png\"\n  validates_attachment_content_type :attachment, content_type: /\\Aimage\\/.*\\Z/\n  belongs_to :gallery\n  belongs_to :user\n\nend\n</code></pre>\n\n<p>As you can see below, I've whitelisted the attachment parameter.</p>\n\n<pre><code>#photos_controller.rb\nclass PhotosController &lt; ApplicationController\n  before_action :set_photo, only: [:show, :edit, :update, :destroy]\n\n\n.........\n\nprivate\n\n# Use callbacks to share common setup or constraints between actions.\ndef set_photo\n  @photo = Photo.find(params[:id])\nend\n\n# Never trust parameters from the scary internet, only allow the white list through.\ndef photo_params\n\n  params.require(:photo).permit(:attachment, :gallery_id)\n\nend\n</code></pre>\n\n<p>DropZone loads as expected, configured here with:\n  Dropzone.autoDiscover = false;</p>\n\n<p>In my template:</p>\n\n<pre><code>  $(\"#new_photo\").dropzone({  \n    // restrict photo size to a maximum 1MB\n    maxFilesize: 4,\n\n    paramName: \"photo[attachment]\",\n\n    addRemoveLinks: true,\n    uploadMultiple: true,\n\n    success: function(file, response){\n      $(file.previewTemplate).find('.dz-remove').attr('id', response.fileID);\n      $(file.previewElement).addClass(\"dz-success\");\n    }\n\n  }); \n\n  var myDropzone = new Dropzone();\n</code></pre>\n\n<p>My form with DropZone's fallback:</p>\n\n<pre><code>&lt;%= form_for(Photo.new, html: { multipart: true, class: \"dropzone\"}) do |f|  %&gt;\n  &lt;%= f.hidden_field :gallery_id, :value=&gt;@gallery.id %&gt;\n  &lt;div class=\"fallback\"&gt;\n    &lt;%= f.file_field :attachment %&gt;\n\n    &lt;%= f.submit \"Upload\" %&gt;\n  &lt;/div&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>My log's output for params is (before getting filtered): </p>\n\n<pre><code>Parameters: {\"utf8\"=&gt;\"\u2713\",     \"authenticity_token\"=&gt;\"5ftDcdfB1YpL4UF1fupC/I11xRx3HV5GYih5kshO/KSXzSrZS5Iu1wVRhbLFiyfQWQbwP3R5mxeoJLiM+cUJDg==\", \"photo\"=&gt;{\"gallery_id\"=&gt;\"13\", \"attachment\"=&gt;{\"0\"=&gt;#&lt;ActionDispatch::Http::UploadedFile:0x007f8058e13c48 @tempfile=#&lt;Tempfile:/var/folders/jb/f02hpkhs3813_b6w_bvyxkxw0000gn/T/RackMultipart20170419-16050-8s5zd8.jpg&gt;, @original_filename=\"624bbbf5b3c8a293950c8ed24a0c4eef.jpg\", @content_type=\"image/jpeg\", @headers=\"Content-Disposition: form-data; name=\\\"photo[attachment][0]\\\"; filename=\\\"624bbbf5b3c8a293950c8ed24a0c4eef.jpg\\\"\\r\\nContent-Type: image/jpeg\\r\\n\"&gt;}}}\n</code></pre>\n\n<p>This leads to: </p>\n\n<pre><code>Unpermitted parameter: attachment\n{\"gallery_id\"=&gt;\"13\"}\n</code></pre>\n\n<p>Any help would be greatly appreciated. I've searched everything and tried everything and can't seem to make it work. Thank you.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "grape", "grape-api"], "comments": [{"owner": {"reputation": 404, "user_id": 762837, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/7cddfee8fed4b62c1b9fbbb5dace9fec?s=128&d=identicon&r=PG", "display_name": "mintuhouse", "link": "https://stackoverflow.com/users/762837/mintuhouse"}, "edited": false, "score": 0, "creation_date": 1492651099, "post_id": 43491759, "comment_id": 74071684, "body": "can you try <code>mount Api::Sap::Api, at: &#39;&#47;api&#39;</code>"}, {"owner": {"reputation": 173, "user_id": 1774481, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/b8b480fd4e8544998e458cbf69c03985?s=128&d=identicon&r=PG", "display_name": "user1774481", "link": "https://stackoverflow.com/users/1774481/user1774481"}, "reply_to_user": {"reputation": 404, "user_id": 762837, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/7cddfee8fed4b62c1b9fbbb5dace9fec?s=128&d=identicon&r=PG", "display_name": "mintuhouse", "link": "https://stackoverflow.com/users/762837/mintuhouse"}, "edited": false, "score": 0, "creation_date": 1492879359, "post_id": 43491759, "comment_id": 74174523, "body": "His walk is half because his me makes a random on the received data and it is weird that it is not planned or my configuration is bad"}], "owner": {"reputation": 173, "user_id": 1774481, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/b8b480fd4e8544998e458cbf69c03985?s=128&d=identicon&r=PG", "display_name": "user1774481", "link": "https://stackoverflow.com/users/1774481/user1774481"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 402, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1492594441, "creation_date": 1492594441, "question_id": 43491759, "link": "https://stackoverflow.com/questions/43491759/i18n-translation-with-gem-grape-for-ruby-on-rails", "title": "I18n translation with gem grape for ruby on rails", "body": "<p>I start to translate my database with the <code>globalize3</code> gem that works well and when I change url it will look for me the data of the language like this <code>Localhost:3000/en/post</code></p>\n\n<p>I created an API with the Grape gem but I would like to do the same as the site which means <code>localhost:300/en/api/v1/momuments</code></p>\n\n<p>But no data goes out and I do not know if I have configured <code>Grape</code> for who gets me the content according to the languages.</p>\n\n<p>Here is the configuration of my routes.</p>\n\n<pre><code>scope \"(:locale)\", locale: /en|nl/ do\n resources :categories\n resources :monuments\n root 'pages#index'\n devise_for :users\n\n # API+API Documentation\n mount Api::Sap::Api, at: \"api\"\n mount GrapeSwaggerRails::Engine, at: \"api/documentation\"\nend\n</code></pre>\n\n<p>Thanks</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 3630, "user_id": 4799659, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153200714295120/picture?type=large", "display_name": "fylooi", "link": "https://stackoverflow.com/users/4799659/fylooi"}, "edited": false, "score": 0, "creation_date": 1492602755, "post_id": 43490619, "comment_id": 74044145, "body": "Try putting <code>MyImage</code> in an initializer. That should cause Rails to load <code>MyImage</code> first."}, {"owner": {"reputation": 6044, "user_id": 3906965, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/c1d2cce52fc69b94c86cb07293091922?s=128&d=identicon&r=PG&f=1", "display_name": "Abhishek", "link": "https://stackoverflow.com/users/3906965/abhishek"}, "reply_to_user": {"reputation": 3630, "user_id": 4799659, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153200714295120/picture?type=large", "display_name": "fylooi", "link": "https://stackoverflow.com/users/4799659/fylooi"}, "edited": false, "score": 0, "creation_date": 1492669273, "post_id": 43490619, "comment_id": 74077168, "body": "But <code>MyImage &lt; MachineImage</code>, would force <code>MachineImage</code> to be called and again it will run in infinite circular loop."}], "answers": [{"comments": [{"owner": {"reputation": 6044, "user_id": 3906965, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/c1d2cce52fc69b94c86cb07293091922?s=128&d=identicon&r=PG&f=1", "display_name": "Abhishek", "link": "https://stackoverflow.com/users/3906965/abhishek"}, "edited": false, "score": 0, "creation_date": 1492597162, "post_id": 43491614, "comment_id": 74040192, "body": "Nice workaround! +1 for that. But I&#39;m using similar thing in other project &amp; it works. What could be the reason for that? Also, why does it work with SQLite but not for MySQL?"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user1011792"}, "is_accepted": false, "score": 2, "last_activity_date": 1492594035, "creation_date": 1492594035, "answer_id": 43491614, "question_id": 43490619, "link": "https://stackoverflow.com/questions/43490619/how-to-fix-circular-dependency-detected-while-autoloading-constant-error-in-rail/43491614#43491614", "title": "How to fix Circular dependency detected while autoloading constant error in rails?", "body": "<p>I would say that superclass shouldn't really know about sublclasses, however if you have to do so, in your specific case instead of having a constant AVAILABLE_FLAVORS, make it a class method:</p>\n\n<pre><code> def self.available_flavors\n  { \"MyImage\" =&gt; MyImage}\n end\n</code></pre>\n\n<p>This method won't be called when loading the class, then no circular dependency is there.</p>\n"}], "owner": {"reputation": 6044, "user_id": 3906965, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/c1d2cce52fc69b94c86cb07293091922?s=128&d=identicon&r=PG&f=1", "display_name": "Abhishek", "link": "https://stackoverflow.com/users/3906965/abhishek"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2247, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1492598752, "creation_date": 1492591205, "last_edit_date": 1495540014, "question_id": 43490619, "link": "https://stackoverflow.com/questions/43490619/how-to-fix-circular-dependency-detected-while-autoloading-constant-error-in-rail", "title": "How to fix Circular dependency detected while autoloading constant error in rails?", "body": "<p>I've created multiple rails application from scratch, but somehow I'm not able fix <code>Circular dependency error</code>. For reproducing the error, I created new app with following commands,</p>\n\n<pre><code>rails new circular_test -d mysql\ncd circular_test\nrails g model MyImage\nrails g scaffold MachineImage\nrm db/migrate/20170419063916_create_my_image.rb\nrails db:create\nrails db:migrate\n</code></pre>\n\n<p>After this I edited the models, which are as follows,</p>\n\n<p><strong>app/models/machine_image.rb</strong></p>\n\n<pre><code>class MachineImage &lt; ApplicationRecord\n   AVAILABLE_FLAVORS = { \"MyImage\" =&gt; MyImage}\nend\n</code></pre>\n\n<p><strong>app/models/my_image.rb</strong></p>\n\n<pre><code>class MyImage &lt; MachineImage\nend\n</code></pre>\n\n<p>Everything else was left with default setting. Nothing was changed. Note that, <code>MyImage</code> is inheriting from <code>MachineImage</code>, instead of <code>ApplicationRecord</code>. When I ran this application in development environment, everything works. But when I run the application in production mode (I made sure db:create &amp; db:migrate is done for prod environment as well),</p>\n\n<blockquote>\n  <p>RAILS_ENV=production rails s</p>\n</blockquote>\n\n<p>I get following error on running above command,</p>\n\n<pre><code>=&gt; Booting Puma\n=&gt; Rails 5.0.2 application starting in production on http://0.0.0.0:3000\n=&gt; Run `rails server -h` for more startup options\nExiting\n/Users/abhigup/.rvm/gems/ruby-2.2.2/gems/activesupport-5.0.2/lib/active_support/dependencies.rb:509:in `load_missing_constant': Circular dependency detected while autoloading constant MyImage (RuntimeError)\n    from /Users/abhigup/.rvm/gems/ruby-2.2.2/gems/activesupport-5.0.2/lib/active_support/dependencies.rb:203:in `const_missing'\n    from /Users/abhigup/.rvm/gems/ruby-2.2.2/gems/activesupport-5.0.2/lib/active_support/dependencies.rb:543:in `load_missing_constant'\n    from /Users/abhigup/.rvm/gems/ruby-2.2.2/gems/activesupport-5.0.2/lib/active_support/dependencies.rb:203:in `const_missing'\n    from /Users/abhigup/Work/git/circular_test/app/models/machine_image.rb:2:in `&lt;class:MachineImage&gt;'\n    from /Users/abhigup/Work/git/circular_test/app/models/machine_image.rb:1:in `&lt;top (required)&gt;'\n    from /Users/abhigup/.rvm/gems/ruby-2.2.2/gems/activesupport-5.0.2/lib/active_support/dependencies.rb:293:in `require'\n    from /Users/abhigup/.rvm/gems/ruby-2.2.2/gems/activesupport-5.0.2/lib/active_support/dependencies.rb:293:in `block in require'\n    from /Users/abhigup/.rvm/gems/ruby-2.2.2/gems/activesupport-5.0.2/lib/active_support/dependencies.rb:259:in `load_dependency'\n    from /Users/abhigup/.rvm/gems/ruby-2.2.2/gems/activesupport-5.0.2/lib/active_support/dependencies.rb:293:in `require'\n    from /Users/abhigup/.rvm/gems/ruby-2.2.2/gems/activesupport-5.0.2/lib/active_support/dependencies.rb:380:in `block in require_or_load'\n    from /Users/abhigup/.rvm/gems/ruby-2.2.2/gems/activesupport-5.0.2/lib/active_support/dependencies.rb:37:in `block in load_interlock'\n    from /Users/abhigup/.rvm/gems/ruby-2.2.2/gems/activesupport-5.0.2/lib/active_support/dependencies/interlock.rb:12:in `block in loading'\n    from /Users/abhigup/.rvm/gems/ruby-2.2.2/gems/activesupport-5.0.2/lib/active_support/concurrency/share_lock.rb:150:in `exclusive'\n    from /Users/abhigup/.rvm/gems/ruby-2.2.2/gems/activesupport-5.0.2/lib/active_support/dependencies/interlock.rb:11:in `loading'\n    from /Users/abhigup/.rvm/gems/ruby-2.2.2/gems/activesupport-5.0.2/lib/active_support/dependencies.rb:37:in `load_interlock'\n    from /Users/abhigup/.rvm/gems/ruby-2.2.2/gems/activesupport-5.0.2/lib/active_support/dependencies.rb:358:in `require_or_load'\n    from /Users/abhigup/.rvm/gems/ruby-2.2.2/gems/activesupport-5.0.2/lib/active_support/dependencies.rb:511:in `load_missing_constant'\n    from /Users/abhigup/.rvm/gems/ruby-2.2.2/gems/activesupport-5.0.2/lib/active_support/dependencies.rb:203:in `const_missing'\n    from /Users/abhigup/Work/git/circular_test/app/models/my_image.rb:1:in `&lt;top (required)&gt;'\n    from /Users/abhigup/.rvm/gems/ruby-2.2.2/gems/activesupport-5.0.2/lib/active_support/dependencies.rb:293:in `require'\n    from /Users/abhigup/.rvm/gems/ruby-2.2.2/gems/activesupport-5.0.2/lib/active_support/dependencies.rb:293:in `block in require'\n    from /Users/abhigup/.rvm/gems/ruby-2.2.2/gems/activesupport-5.0.2/lib/active_support/dependencies.rb:259:in `load_dependency'\n    from /Users/abhigup/.rvm/gems/ruby-2.2.2/gems/activesupport-5.0.2/lib/active_support/dependencies.rb:293:in `require'\n    from /Users/abhigup/.rvm/gems/ruby-2.2.2/gems/activesupport-5.0.2/lib/active_support/dependencies.rb:380:in `block in require_or_load'\n    from /Users/abhigup/.rvm/gems/ruby-2.2.2/gems/activesupport-5.0.2/lib/active_support/dependencies.rb:37:in `block in load_interlock'\n    from /Users/abhigup/.rvm/gems/ruby-2.2.2/gems/activesupport-5.0.2/lib/active_support/dependencies/interlock.rb:12:in `block in loading'\n    from /Users/abhigup/.rvm/gems/ruby-2.2.2/gems/activesupport-5.0.2/lib/active_support/concurrency/share_lock.rb:150:in `exclusive'\n    from /Users/abhigup/.rvm/gems/ruby-2.2.2/gems/activesupport-5.0.2/lib/active_support/dependencies/interlock.rb:11:in `loading'\n    from /Users/abhigup/.rvm/gems/ruby-2.2.2/gems/activesupport-5.0.2/lib/active_support/dependencies.rb:37:in `load_interlock'\n    from /Users/abhigup/.rvm/gems/ruby-2.2.2/gems/activesupport-5.0.2/lib/active_support/dependencies.rb:358:in `require_or_load'\n    from /Users/abhigup/.rvm/gems/ruby-2.2.2/gems/activesupport-5.0.2/lib/active_support/dependencies.rb:336:in `depend_on'\n    from /Users/abhigup/.rvm/gems/ruby-2.2.2/gems/activesupport-5.0.2/lib/active_support/dependencies.rb:252:in `require_dependency'\n    from /Users/abhigup/.rvm/gems/ruby-2.2.2/gems/railties-5.0.2/lib/rails/engine.rb:476:in `block (2 levels) in eager_load!'\n    from /Users/abhigup/.rvm/gems/ruby-2.2.2/gems/railties-5.0.2/lib/rails/engine.rb:475:in `each'\n    from /Users/abhigup/.rvm/gems/ruby-2.2.2/gems/railties-5.0.2/lib/rails/engine.rb:475:in `block in eager_load!'\n    from /Users/abhigup/.rvm/gems/ruby-2.2.2/gems/railties-5.0.2/lib/rails/engine.rb:473:in `each'\n    from /Users/abhigup/.rvm/gems/ruby-2.2.2/gems/railties-5.0.2/lib/rails/engine.rb:473:in `eager_load!'\n    from /Users/abhigup/.rvm/gems/ruby-2.2.2/gems/railties-5.0.2/lib/rails/engine.rb:354:in `eager_load!'\n    from /Users/abhigup/.rvm/gems/ruby-2.2.2/gems/railties-5.0.2/lib/rails/application/finisher.rb:59:in `each'\n    from /Users/abhigup/.rvm/gems/ruby-2.2.2/gems/railties-5.0.2/lib/rails/application/finisher.rb:59:in `block in &lt;module:Finisher&gt;'\n    from /Users/abhigup/.rvm/gems/ruby-2.2.2/gems/railties-5.0.2/lib/rails/initializable.rb:30:in `instance_exec'\n    from /Users/abhigup/.rvm/gems/ruby-2.2.2/gems/railties-5.0.2/lib/rails/initializable.rb:30:in `run'\n    from /Users/abhigup/.rvm/gems/ruby-2.2.2/gems/railties-5.0.2/lib/rails/initializable.rb:55:in `block in run_initializers'\n    from /Users/abhigup/.rvm/rubies/ruby-2.2.2/lib/ruby/2.2.0/tsort.rb:226:in `block in tsort_each'\n    from /Users/abhigup/.rvm/rubies/ruby-2.2.2/lib/ruby/2.2.0/tsort.rb:348:in `block (2 levels) in each_strongly_connected_component'\n    from /Users/abhigup/.rvm/rubies/ruby-2.2.2/lib/ruby/2.2.0/tsort.rb:429:in `each_strongly_connected_component_from'\n    from /Users/abhigup/.rvm/rubies/ruby-2.2.2/lib/ruby/2.2.0/tsort.rb:347:in `block in each_strongly_connected_component'\n    from /Users/abhigup/.rvm/rubies/ruby-2.2.2/lib/ruby/2.2.0/tsort.rb:345:in `each'\n    from /Users/abhigup/.rvm/rubies/ruby-2.2.2/lib/ruby/2.2.0/tsort.rb:345:in `call'\n    from /Users/abhigup/.rvm/rubies/ruby-2.2.2/lib/ruby/2.2.0/tsort.rb:345:in `each_strongly_connected_component'\n    from /Users/abhigup/.rvm/rubies/ruby-2.2.2/lib/ruby/2.2.0/tsort.rb:224:in `tsort_each'\n    from /Users/abhigup/.rvm/rubies/ruby-2.2.2/lib/ruby/2.2.0/tsort.rb:203:in `tsort_each'\n    from /Users/abhigup/.rvm/gems/ruby-2.2.2/gems/railties-5.0.2/lib/rails/initializable.rb:54:in `run_initializers'\n    from /Users/abhigup/.rvm/gems/ruby-2.2.2/gems/railties-5.0.2/lib/rails/application.rb:352:in `initialize!'\n    from /Users/abhigup/Work/git/circular_test/config/environment.rb:5:in `&lt;top (required)&gt;'\n    from /Users/abhigup/Work/git/circular_test/config.ru:3:in `require_relative'\n    from /Users/abhigup/Work/git/circular_test/config.ru:3:in `block in &lt;main&gt;'\n    from /Users/abhigup/.rvm/gems/ruby-2.2.2/gems/rack-2.0.1/lib/rack/builder.rb:55:in `instance_eval'\n    from /Users/abhigup/.rvm/gems/ruby-2.2.2/gems/rack-2.0.1/lib/rack/builder.rb:55:in `initialize'\n    from /Users/abhigup/Work/git/circular_test/config.ru:in `new'\n    from /Users/abhigup/Work/git/circular_test/config.ru:in `&lt;main&gt;'\n    from /Users/abhigup/.rvm/gems/ruby-2.2.2/gems/rack-2.0.1/lib/rack/builder.rb:49:in `eval'\n    from /Users/abhigup/.rvm/gems/ruby-2.2.2/gems/rack-2.0.1/lib/rack/builder.rb:49:in `new_from_string'\n    from /Users/abhigup/.rvm/gems/ruby-2.2.2/gems/rack-2.0.1/lib/rack/builder.rb:40:in `parse_file'\n    from /Users/abhigup/.rvm/gems/ruby-2.2.2/gems/rack-2.0.1/lib/rack/server.rb:318:in `build_app_and_options_from_config'\n    from /Users/abhigup/.rvm/gems/ruby-2.2.2/gems/rack-2.0.1/lib/rack/server.rb:218:in `app'\n    from /Users/abhigup/.rvm/gems/ruby-2.2.2/gems/railties-5.0.2/lib/rails/commands/server.rb:59:in `app'\n    from /Users/abhigup/.rvm/gems/ruby-2.2.2/gems/rack-2.0.1/lib/rack/server.rb:353:in `wrapped_app'\n    from /Users/abhigup/.rvm/gems/ruby-2.2.2/gems/rack-2.0.1/lib/rack/server.rb:282:in `start'\n    from /Users/abhigup/.rvm/gems/ruby-2.2.2/gems/railties-5.0.2/lib/rails/commands/server.rb:79:in `start'\n    from /Users/abhigup/.rvm/gems/ruby-2.2.2/gems/railties-5.0.2/lib/rails/commands/commands_tasks.rb:90:in `block in server'\n    from /Users/abhigup/.rvm/gems/ruby-2.2.2/gems/railties-5.0.2/lib/rails/commands/commands_tasks.rb:85:in `tap'\n    from /Users/abhigup/.rvm/gems/ruby-2.2.2/gems/railties-5.0.2/lib/rails/commands/commands_tasks.rb:85:in `server'\n    from /Users/abhigup/.rvm/gems/ruby-2.2.2/gems/railties-5.0.2/lib/rails/commands/commands_tasks.rb:49:in `run_command!'\n    from /Users/abhigup/.rvm/gems/ruby-2.2.2/gems/railties-5.0.2/lib/rails/commands.rb:18:in `&lt;top (required)&gt;'\n    from /Users/abhigup/Work/git/circular_test/bin/rails:9:in `require'\n    from /Users/abhigup/Work/git/circular_test/bin/rails:9:in `&lt;top (required)&gt;'\n    from /Users/abhigup/.rvm/gems/ruby-2.2.2/gems/spring-2.0.1/lib/spring/client/rails.rb:28:in `load'\n    from /Users/abhigup/.rvm/gems/ruby-2.2.2/gems/spring-2.0.1/lib/spring/client/rails.rb:28:in `call'\n    from /Users/abhigup/.rvm/gems/ruby-2.2.2/gems/spring-2.0.1/lib/spring/client/command.rb:7:in `call'\n    from /Users/abhigup/.rvm/gems/ruby-2.2.2/gems/spring-2.0.1/lib/spring/client.rb:30:in `run'\n    from /Users/abhigup/.rvm/gems/ruby-2.2.2/gems/spring-2.0.1/bin/spring:49:in `&lt;top (required)&gt;'\n    from /Users/abhigup/.rvm/gems/ruby-2.2.2/gems/spring-2.0.1/lib/spring/binstub.rb:31:in `load'\n    from /Users/abhigup/.rvm/gems/ruby-2.2.2/gems/spring-2.0.1/lib/spring/binstub.rb:31:in `&lt;top (required)&gt;'\n    from /Users/abhigup/.rvm/rubies/ruby-2.2.2/lib/ruby/site_ruby/2.2.0/rubygems/core_ext/kernel_require.rb:69:in `require'\n    from /Users/abhigup/.rvm/rubies/ruby-2.2.2/lib/ruby/site_ruby/2.2.0/rubygems/core_ext/kernel_require.rb:69:in `require'\n    from /Users/abhigup/Work/git/circular_test/bin/spring:15:in `&lt;top (required)&gt;'\n    from bin/rails:3:in `load'\n    from bin/rails:3:in `&lt;main&gt;'\n</code></pre>\n\n<p>I was able to solve the problem by making <code>config.eager_load = false</code> in production.rb, but that is not ideal way to solve this issue. To addon, in my previous application I had similar structure, but it works flawlessly in production mode. Only difference is, that it is using SQLite. Is MySQL creating issue with this kind of structure? If not, What is the ideal way to solve this issue?</p>\n\n<p><strong>Note</strong>: I've tried looked into <a href=\"https://stackoverflow.com/questions/18013055/circular-dependency-detected-while-autoloading-constant-user\">this</a>, but it doesn't apply to me. As this error is related to <code>load_missing_constant</code>.</p>\n\n<p>Ruby version: 2.2.2</p>\n\n<p>Rails version: 5.0.2</p>\n\n<p>OS: macOS Sierra 10.12.4</p>\n\n<p>MySQL version: 5.7.17 Homebrew</p>\n\n<p><strong>Update</strong>: I found <a href=\"http://neethack.com/2015/04/rails-circular-dependency/\" rel=\"nofollow noreferrer\">this</a> article, which talks about possible reason. But it didn't specify, why the logic fails only when I try to use MySQL.</p>\n"}, {"tags": ["android", "ruby", "adb", "appium"], "answers": [{"comments": [{"owner": {"reputation": 1772, "user_id": 5743300, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/86b739012f3bafbce2e40f59f3291c0e?s=128&d=identicon&r=PG&f=1", "display_name": "Emjey", "link": "https://stackoverflow.com/users/5743300/emjey"}, "edited": false, "score": 0, "creation_date": 1492590674, "post_id": 43490162, "comment_id": 74035641, "body": "Thanks for the reply, I somehow have missed the quote while copying from my IDE to here. Its the same error even with quotes."}, {"owner": {"reputation": 1772, "user_id": 5743300, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/86b739012f3bafbce2e40f59f3291c0e?s=128&d=identicon&r=PG&f=1", "display_name": "Emjey", "link": "https://stackoverflow.com/users/5743300/emjey"}, "edited": false, "score": 0, "creation_date": 1492590743, "post_id": 43490162, "comment_id": 74035685, "body": "As I see from your answer, that <code>require_relative</code> is loading a particular file, I wanted to know, if the files mentioned in the above in <code>require_relative</code> are a part of <code>appium_lib</code>? Any idea on this?"}, {"owner": {"reputation": 1772, "user_id": 5743300, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/86b739012f3bafbce2e40f59f3291c0e?s=128&d=identicon&r=PG&f=1", "display_name": "Emjey", "link": "https://stackoverflow.com/users/5743300/emjey"}, "edited": false, "score": 0, "creation_date": 1496989279, "post_id": 43490162, "comment_id": 75898115, "body": "I got what are those. Those are just to refer an other file, to call a method from one file to another."}, {"owner": {"reputation": 1772, "user_id": 5743300, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/86b739012f3bafbce2e40f59f3291c0e?s=128&d=identicon&r=PG&f=1", "display_name": "Emjey", "link": "https://stackoverflow.com/users/5743300/emjey"}, "edited": false, "score": 0, "creation_date": 1496989293, "post_id": 43490162, "comment_id": 75898126, "body": "Feel so embarassed now, to have not known this concept."}], "tags": [], "owner": {"reputation": 40236, "user_id": 923315, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/j6lLI.jpg?s=128&g=1", "display_name": "peter", "link": "https://stackoverflow.com/users/923315/peter"}, "is_accepted": true, "score": 1, "last_activity_date": 1492594333, "last_edit_date": 1492594333, "creation_date": 1492589821, "answer_id": 43490162, "question_id": 43487784, "link": "https://stackoverflow.com/questions/43487784/appiumruby-load-error-in-the-gem/43490162#43490162", "title": "Appium:Ruby: Load error in the gem", "body": "<p>You requested me for help, but other than the error you published originally I can just give you some general advise since I have no experience with appium itself and the prerequisites are too high to try.</p>\n\n<p>Where did you get the code for the require_relatives you are making ?\nI can't find much documentation online. They should refer to gems or ruby files.\nIn the case of a gem (like <code>require 'appium_lib'</code>) you need to meet the prerequisites (iOs only ?, gem installed ? etc), in case of a ruby script file you can check where the file is located in your filesystem and you'd better make use of the fileextension <code>.rb</code>.</p>\n\n<p>eg <code>require_relative './libs/adbManager.rb'</code>\nwould be a file that is located in a subfolder libs of your main script called <code>adbManager.rb</code>.</p>\n\n<p>If it would be part of appium it would rather be something like </p>\n\n<pre><code>require 'appium_lib/adbManager'\n</code></pre>\n"}], "owner": {"reputation": 1772, "user_id": 5743300, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/86b739012f3bafbce2e40f59f3291c0e?s=128&d=identicon&r=PG&f=1", "display_name": "Emjey", "link": "https://stackoverflow.com/users/5743300/emjey"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1023, "favorite_count": 0, "accepted_answer_id": 43490162, "answer_count": 1, "score": 2, "last_activity_date": 1492594333, "creation_date": 1492582461, "last_edit_date": 1492590763, "question_id": 43487784, "link": "https://stackoverflow.com/questions/43487784/appiumruby-load-error-in-the-gem", "title": "Appium:Ruby: Load error in the gem", "body": "<p>I am having errors while loading this <code>require-relative</code> element. Any ideas how to resolve it? </p>\n\n<p>I have tried searching the android sdk, for the following mentioned in the <code>require relative</code>, is there any file that I should be placing to get this work?></p>\n\n<pre><code>require 'appium_lib'\nrequire_relative './libs/adbManager'\nrequire_relative './libs/error_handler'\nrequire_relative './libs/android_manifest_parser'\n</code></pre>\n\n<p>The error: </p>\n\n<pre><code>cannot load such file -- /Users/jain/Documents/fslearning-android/Features/Support/libs/adbManager (LoadError)\n/Users/jain/Documents/fslearning-android/Features/Support/hooks.rb:2:in `require_relative'\n/Users/jain/Documents/fslearning-android/Features/Support/hooks.rb:2:in `&lt;top (required)&gt;'\n/usr/local/lib/ruby/gems/2.4.0/gems/cucumber-2.4.0/lib/cucumber/rb_support/rb_language.rb:96:in `load'\n/usr/local/lib/ruby/gems/2.4.0/gems/cucumber-2.4.0/lib/cucumber/rb_support/rb_language.rb:96:in `load_code_file'\n/usr/local/lib/ruby/gems/2.4.0/gems/cucumber-2.4.0/lib/cucumber/runtime/support_code.rb:142:in `load_file'\n/usr/local/lib/ruby/gems/2.4.0/gems/cucumber-2.4.0/lib/cucumber/runtime/support_code.rb:84:in `block in load_files!'\n/usr/local/lib/ruby/gems/2.4.0/gems/cucumber-2.4.0/lib/cucumber/runtime/support_code.rb:83:in `each'\n/usr/local/lib/ruby/gems/2.4.0/gems/cucumber-2.4.0/lib/cucumber/runtime/support_code.rb:83:in `load_files!'\n/usr/local/lib/ruby/gems/2.4.0/gems/cucumber-2.4.0/lib/cucumber/runtime.rb:253:in `load_step_definitions'\n/usr/local/lib/ruby/gems/2.4.0/gems/cucumber-2.4.0/lib/cucumber/runtime.rb:61:in `run!'\n/usr/local/lib/ruby/gems/2.4.0/gems/cucumber-2.4.0/lib/cucumber/cli/main.rb:32:in `execute!'\n/usr/local/lib/ruby/gems/2.4.0/gems/cucumber-2.4.0/bin/cucumber:8:in `&lt;top (required)&gt;'\n/usr/local/bin/cucumber:22:in `load'\n/usr/local/bin/cucumber:22:in `&lt;main&gt;'\n</code></pre>\n"}, {"tags": ["python", "ruby"], "comments": [{"owner": {"reputation": 8478, "user_id": 3811592, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/76q7x.jpg?s=128&g=1", "display_name": "d-coder", "link": "https://stackoverflow.com/users/3811592/d-coder"}, "edited": false, "score": 1, "creation_date": 1492582175, "post_id": 43487590, "comment_id": 74030421, "body": "Do you notice the endpoint in the case of both ? HINT: Look at the trailing slashes."}, {"owner": {"reputation": 1, "user_id": 5144331, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ceb32bcff16030f19de9e63c162120d1?s=128&d=identicon&r=PG&f=1", "display_name": "Johns Now", "link": "https://stackoverflow.com/users/5144331/johns-now"}, "reply_to_user": {"reputation": 8478, "user_id": 3811592, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/76q7x.jpg?s=128&g=1", "display_name": "d-coder", "link": "https://stackoverflow.com/users/3811592/d-coder"}, "edited": false, "score": 0, "creation_date": 1492582390, "post_id": 43487590, "comment_id": 74030528, "body": "Yes, even after fixing that I&#39;m getting the same result"}, {"owner": {"reputation": 8478, "user_id": 3811592, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/76q7x.jpg?s=128&g=1", "display_name": "d-coder", "link": "https://stackoverflow.com/users/3811592/d-coder"}, "edited": false, "score": 0, "creation_date": 1492582620, "post_id": 43487590, "comment_id": 74030644, "body": "Good! One less probable cause to think about. Now What about HEADERS part in ruby code ?"}, {"owner": {"reputation": 1, "user_id": 5144331, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ceb32bcff16030f19de9e63c162120d1?s=128&d=identicon&r=PG&f=1", "display_name": "Johns Now", "link": "https://stackoverflow.com/users/5144331/johns-now"}, "reply_to_user": {"reputation": 8478, "user_id": 3811592, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/76q7x.jpg?s=128&g=1", "display_name": "d-coder", "link": "https://stackoverflow.com/users/3811592/d-coder"}, "edited": false, "score": 0, "creation_date": 1492583097, "post_id": 43487590, "comment_id": 74030899, "body": "Sorry I forgot to add HEADERS in my post. The HEADERS that I declare is that following: <code>HEADERS = {&#39;User-Agent&#39;=&gt; &#39;Mozilla&#47;5.0 (Macintosh; Intel Mac OS X 10_12_3) AppleWebKit&#47;537.36 (KHTML, like Gecko) Chrome&#47;57.0.2987.133 Safari&#47;537.36&#39;,             &#39;Accept&#39;=&gt; &quot;text&#47;html,application&#47;xhtml+xml,application&#47;xml;q=0.9,image&zwnj;&#8203;&#47;webp,*&#47;*;q=0.8&quot;   }</code>"}, {"owner": {"reputation": 8478, "user_id": 3811592, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/76q7x.jpg?s=128&g=1", "display_name": "d-coder", "link": "https://stackoverflow.com/users/3811592/d-coder"}, "edited": false, "score": 0, "creation_date": 1492583218, "post_id": 43487590, "comment_id": 74030972, "body": "Please update the code in the question too."}, {"owner": {"reputation": 1, "user_id": 5144331, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ceb32bcff16030f19de9e63c162120d1?s=128&d=identicon&r=PG&f=1", "display_name": "Johns Now", "link": "https://stackoverflow.com/users/5144331/johns-now"}, "reply_to_user": {"reputation": 8478, "user_id": 3811592, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/76q7x.jpg?s=128&g=1", "display_name": "d-coder", "link": "https://stackoverflow.com/users/3811592/d-coder"}, "edited": false, "score": 0, "creation_date": 1492583611, "post_id": 43487590, "comment_id": 74031176, "body": "Yes will do. Thank you so much for taking the time to help me"}, {"owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 0, "creation_date": 1492585202, "post_id": 43487590, "comment_id": 74032135, "body": "Why did you choose <a href=\"https://www.ruby-toolbox.com/projects/unirest\" rel=\"nofollow noreferrer\"><code>unirest</code></a>? That gem didn&#39;t get any updates in the last three years and has only about 75k downloads. Whereas well-known gems like <code>rest-client</code> or <code>faraday</code> have millions (both have more that 30M) of downloads, a bigger community and much better documentation."}, {"owner": {"reputation": 1, "user_id": 5144331, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ceb32bcff16030f19de9e63c162120d1?s=128&d=identicon&r=PG&f=1", "display_name": "Johns Now", "link": "https://stackoverflow.com/users/5144331/johns-now"}, "edited": false, "score": 0, "creation_date": 1492585440, "post_id": 43487590, "comment_id": 74032289, "body": "There&#39;s no reason in particular. I tried the ruby port of python&#39;s requests package and I&#39;m running into the same issue. I even tried using the <code>open-uri</code> library but that doesn&#39;t work either"}, {"owner": {"reputation": 35276, "user_id": 182590, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/134ea397777886d6f0aa992672a50eaa?s=128&d=identicon&r=PG", "display_name": "Mark Thomas", "link": "https://stackoverflow.com/users/182590/mark-thomas"}, "edited": false, "score": 0, "creation_date": 1492646925, "post_id": 43487590, "comment_id": 74070653, "body": "Why are you using different headers in each case?"}, {"owner": {"reputation": 35276, "user_id": 182590, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/134ea397777886d6f0aa992672a50eaa?s=128&d=identicon&r=PG", "display_name": "Mark Thomas", "link": "https://stackoverflow.com/users/182590/mark-thomas"}, "reply_to_user": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 0, "creation_date": 1492728992, "post_id": 43487590, "comment_id": 74115028, "body": "Also, I should mention like @spickermann alluded to, that as a rubyist I&#39;ve never heard of unirest. Maybe it has some failings? Try the gems he mentioned first."}, {"owner": {"reputation": 1, "user_id": 5144331, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ceb32bcff16030f19de9e63c162120d1?s=128&d=identicon&r=PG&f=1", "display_name": "Johns Now", "link": "https://stackoverflow.com/users/5144331/johns-now"}, "edited": false, "score": 0, "creation_date": 1492734107, "post_id": 43487590, "comment_id": 74116343, "body": "I used headers to see if there was a header that was missing from the ruby request. <a href=\"https://github.com/kshvmdn/nba.js/issues/16\" rel=\"nofollow noreferrer\">github.com/kshvmdn/nba.js/issues/16</a> this could be contributing to the issue btw!"}], "owner": {"reputation": 1, "user_id": 5144331, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ceb32bcff16030f19de9e63c162120d1?s=128&d=identicon&r=PG&f=1", "display_name": "Johns Now", "link": "https://stackoverflow.com/users/5144331/johns-now"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 137, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1492583586, "creation_date": 1492581666, "last_edit_date": 1492583586, "question_id": 43487590, "link": "https://stackoverflow.com/questions/43487590/ruby-vs-python-get-request", "title": "Ruby vs Python get request", "body": "<p>I'm trying to make a GET request to the NBA API in ruby. I've tried both the <code>unirest</code> library but the request hangs after 5 minutes. </p>\n\n<p>When I use python's <code>requests</code> library for the same url + endpoint it works. Here's what I'm trying for each:</p>\n\n<pre><code>require \"unirest\"\n\nbase_url = \"http://stats.nba.com/stats\"\nteam_endpoint = \"/teamgamelog\"\nparams = {:TeamID =&gt; \"1610612739\", :Season =&gt; \"2016-17\", :SeasonType =&gt; \"Playoffs\"}\n\nHEADERS = {'user-agent'=&gt; 'Mozilla/5.0 (Macintosh; Intel Mac OS X 10_10_5) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/45.0.2454.101 Safari/537.36',\n        'Accept'=&gt; \"text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8\"\n}\n\nresponse = Unirest.get \"#{base_url}#{team_endpoint}\", headers: HEADERS, \nparameters: params\n</code></pre>\n\n<p>The above code doesn't work (the connection eventually times-out). The following python code works:</p>\n\n<pre><code>import requests\n\nbase_url = 'http://stats.nba.com/stats'\nHEADERS = {'user-agent': ('Mozilla/5.0 (Macintosh; Intel Mac OS X 10_10_5) '\n               'AppleWebKit/537.36 (KHTML, like Gecko) '\n               'Chrome/45.0.2454.101 Safari/537.36'),}\nend_point = '/teamgamelog'\nPARAMS = {'TeamID': '1610612739', 'Season': '2016-17', 'SeasonType': 'Playoffs'}\n\nr = requests.get(base_url+end_point, headers=HEADERS, params=PARAMS)\n</code></pre>\n\n<p>Any advice on solving the ruby case?</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 38092, "user_id": 18706, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/cabf735ce7b8b4471ef46ea54f71832d?s=128&d=identicon&r=PG", "display_name": "mahemoff", "link": "https://stackoverflow.com/users/18706/mahemoff"}, "edited": false, "score": 0, "creation_date": 1492581640, "post_id": 43487548, "comment_id": 74030154, "body": "You could try defining <code>def a=(val)</code> at class level. That would capture it, but not sure how you&#39;d  make it work like a normal local assignment too."}], "answers": [{"comments": [{"owner": {"reputation": 47232, "user_id": 1772830, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/Qtoqg.jpg?s=128&g=1", "display_name": "Andrey Deineko", "link": "https://stackoverflow.com/users/1772830/andrey-deineko"}, "edited": false, "score": 0, "creation_date": 1492583559, "post_id": 43488031, "comment_id": 74031145, "body": "I wonder why the exercise says &quot;Could you get the values from outside the class A?&quot; and &quot;Write your code which outputs like this:&quot; I suppose it implies not changing the class definition, which makes the task impossible AFAIKT."}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "reply_to_user": {"reputation": 47232, "user_id": 1772830, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/Qtoqg.jpg?s=128&g=1", "display_name": "Andrey Deineko", "link": "https://stackoverflow.com/users/1772830/andrey-deineko"}, "edited": false, "score": 1, "creation_date": 1492584094, "post_id": 43488031, "comment_id": 74031468, "body": "@AndreyDeineko well, it\u2019s possible with NIF reading the stack :) These exercises are outdated (2009) and are in general looking like not the best source for exercises at all."}, {"owner": {"reputation": 11741, "user_id": 1934428, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/072774c5d4204a1c2385560e6114a887?s=128&d=identicon&r=PG", "display_name": "user1934428", "link": "https://stackoverflow.com/users/1934428/user1934428"}, "edited": false, "score": 0, "creation_date": 1492603949, "post_id": 43488031, "comment_id": 74044972, "body": "@mudasobwa : What is NIF? Didn&#39;t find it on Google. But IMO it doesn&#39;t make sense to ask for the value of local variables which might or might not spring into existence, when seeing the class from the outside, i.e without actually executing a method. The variables don&#39;t exist by themselves, and asking for their value is meaningless."}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "reply_to_user": {"reputation": 11741, "user_id": 1934428, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/072774c5d4204a1c2385560e6114a887?s=128&d=identicon&r=PG", "display_name": "user1934428", "link": "https://stackoverflow.com/users/1934428/user1934428"}, "edited": false, "score": 0, "creation_date": 1492604173, "post_id": 43488031, "comment_id": 74045151, "body": "@user1934428 It\u2019s also known as <a href=\"https://spin.atomicobject.com/2013/02/15/ffi-foreign-function-interfaces/\" rel=\"nofollow noreferrer\">FFI</a> and stands for Native Function Interface. Yes, it makes not much sense to try to discover locals from the outside.."}], "tags": [], "owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "is_accepted": false, "score": 0, "last_activity_date": 1492583298, "creation_date": 1492583298, "answer_id": 43488031, "question_id": 43487548, "link": "https://stackoverflow.com/questions/43487548/ruby-retrieve-local-variable-from-class/43488031#43488031", "title": "Ruby: Retrieve local variable from class", "body": "<p>One might get an access to all the local variables of the class by returning it\u2019s binding from the class definition (see <a href=\"https://ruby-doc.org/core/Binding.html#method-i-local_variables\" rel=\"nofollow noreferrer\"><code>Binding#local_variables</code></a> for details):</p>\n\n<pre><code>a = class A\n  v1 = 3.14\n  v2 = 42\n  binding\nend\n\na.local_variable_get(:v1)\n#\u21d2\u00a03.14\na.local_variable_get(:v2)\n#\u21d2\u00a042\n</code></pre>\n\n<p>But the main question is why would you want to do that? The <em>local</em> variable is meant to remain <em>local</em>. This is how it is supposed to behave. Also, one is unable to modify the local variable in the original <code>binding</code> (what is returned is a read-only copy of an original binding.)</p>\n"}, {"comments": [{"owner": {"reputation": 47232, "user_id": 1772830, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/Qtoqg.jpg?s=128&g=1", "display_name": "Andrey Deineko", "link": "https://stackoverflow.com/users/1772830/andrey-deineko"}, "edited": false, "score": 0, "creation_date": 1492584304, "post_id": 43488320, "comment_id": 74031594, "body": "<code>but in the example, you mention only instance- and class-variables.</code> Really? :) What are <code>a = 33</code> and <code>a = 3</code>, then, if not local variables?"}, {"owner": {"reputation": 47232, "user_id": 1772830, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/Qtoqg.jpg?s=128&g=1", "display_name": "Andrey Deineko", "link": "https://stackoverflow.com/users/1772830/andrey-deineko"}, "edited": false, "score": 2, "creation_date": 1492605060, "post_id": 43488320, "comment_id": 74045826, "body": "Even though your answer might be valuable for other readers, but definitely not for OP, since for him, quote: <i>&quot;it&#39;s pretty straightforward to get the instance and class variables dynamically, even the local variable inside the constructor. [...] But I&#39;m stumped as to how to get the local variables <code>a=3</code>.&quot;</i>. So effectively, this answer has nothing to do with the question :)"}, {"owner": {"reputation": 11741, "user_id": 1934428, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/072774c5d4204a1c2385560e6114a887?s=128&d=identicon&r=PG", "display_name": "user1934428", "link": "https://stackoverflow.com/users/1934428/user1934428"}, "reply_to_user": {"reputation": 47232, "user_id": 1772830, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/Qtoqg.jpg?s=128&g=1", "display_name": "Andrey Deineko", "link": "https://stackoverflow.com/users/1772830/andrey-deineko"}, "edited": false, "score": 0, "creation_date": 1492662994, "post_id": 43488320, "comment_id": 74074744, "body": "Indeed! If this was present in the original question and not added later, I definitely have not seen it! It is correct, I missed the point completely!!"}], "tags": [], "owner": {"reputation": 11741, "user_id": 1934428, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/072774c5d4204a1c2385560e6114a887?s=128&d=identicon&r=PG", "display_name": "user1934428", "link": "https://stackoverflow.com/users/1934428/user1934428"}, "is_accepted": false, "score": 1, "last_activity_date": 1492584235, "creation_date": 1492584235, "answer_id": 43488320, "question_id": 43487548, "link": "https://stackoverflow.com/questions/43487548/ruby-retrieve-local-variable-from-class/43488320#43488320", "title": "Ruby: Retrieve local variable from class", "body": "<p>Your question is unclear. In the title, you write \"local variables\", but in the example, you mention only instance- and class-variables. </p>\n\n<p>As for the instance variables, you can use Object#instance_variables to get a list of known instance variables at this point. Note however that instance variables are created dynamically, not at the time of class declaration. For example, given the class</p>\n\n<pre><code>class AA; \n  def initialize; @x=1; end; \n  def f; @y=1; end; \nend\n</code></pre>\n\n<p>the expression </p>\n\n<pre><code>AA.new.instance_variables\n</code></pre>\n\n<p>would return <code>[:@x]</code> - the :@y is missing, because it doesn't exist yet.</p>\n\n<p>You don't have a way to automatically (i.e. without modifying the class) retrieve local variables. As <em>mudasobwa</em> explained in his answer, you would have to explictly pass back a binding.</p>\n"}, {"tags": [], "owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "is_accepted": false, "score": 2, "last_activity_date": 1492696271, "last_edit_date": 1492696271, "creation_date": 1492617894, "answer_id": 43500799, "question_id": 43487548, "link": "https://stackoverflow.com/questions/43487548/ruby-retrieve-local-variable-from-class/43500799#43500799", "title": "Ruby: Retrieve local variable from class", "body": "<p>The question seems to boil down to this: given the following:</p>\n\n<pre><code>class A\n  attr_reader :instance_var\n  def initialize\n    @instance_var = (@instance_var ||= 0) + 1\n    instance_local_var = 33\n    puts \"instance_local_variables = #{ local_variables }\"\n    instance_local_var = 33\n  end\n  class_local_var = 3\n  puts \"class_local_variables = #{ local_variables }\"\n  class_local_var = 3\nend\n  # class_local_variables = [:class_local_var]\n  #=&gt; 3\n</code></pre>\n\n<p>can one determine the values of <code>instance_local_var</code> and <code>class_local_var</code>?</p>\n\n<p><strong>Determine the value of <code>class_local_var</code></strong></p>\n\n<p>The answer to this question is clearly \"no\" because <code>class_local_var</code> no longer exists (has been marked for garbage collection) after <code>end</code> is executed<sup>1</sup>:</p>\n\n<pre><code>A.send(:local_variables)\n  #=&gt; []\n</code></pre>\n\n<p><strong>Determine the value of <code>instance_local_var</code></strong></p>\n\n<pre><code>a = A.new\n  # instance_local_variables = [:instance_local_var]\n  #=&gt; #&lt;A:0x007ff3ea8dbb80 @instance_var=1&gt; \n</code></pre>\n\n<p>Note that <code>@instance_var #=&gt; 1</code>.</p>\n\n<p><code>A.new</code> does not return the value of <code>instance_local_var</code>, but because that variable is assigned a value in the last line of <code>initialize</code>, that value can be obtained by executing <code>initialize</code> once again.<sup>2</sup></p>\n\n<pre><code>instance_local_var = a.send(:initialize)\n  #=&gt; 33\n</code></pre>\n\n<p>There is a problem, however:</p>\n\n<pre><code>a.instance_var\n  #=&gt; 2\n</code></pre>\n\n<p>Executing <code>initialize</code> a second time has caused an unwanted side effect. My definition of <code>initialize</code> is artificial, but it highlights the fact that many undesirable side effects could occur by executing <code>initialize</code> a second time.</p>\n\n<p>Now let's obtain a new instance.</p>\n\n<pre><code>b = A.new\n  # instance_local_variables = [:instance_local_var]\n  #=&gt; #&lt;A:0x007fee0996e7c8 @instance_var=1&gt;\n</code></pre>\n\n<p>Again, <code>@instance_var=1</code>. One possible workaround to the side-effects of calling <code>initialize</code> twice for a given instance is to subclass <code>A</code> and use <code>super</code>.</p>\n\n<pre><code>class B &lt; A\n  attr_reader :b\n  def initialize\n    @b = super\n  end\nend\n\nB.new.b\n  #=&gt; 33\na.instance_var\n  #=&gt; 1\n</code></pre>\n\n<p>There is no guarantee that undesirable side-effects can be avoided with this approach (e.g., <code>initialize</code> for any instance may perform a database operation that should occur only once), but it appears to leave the initial instance <code>a</code> unaffected. This is of course all hypothetical.</p>\n\n<p><sup>1. <code>send</code> must be used because <code>A.private_methods.include?(:local_variables) #=&gt; true</code></sup></p>\n\n<p><sup>2. <code>A.new.send(:initialize)</code> is required because <code>iniitialize</code> is private.</sup> </p>\n"}], "owner": {"reputation": 638, "user_id": 1464892, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/437699b3e917fb8869599cadaf397e3b?s=128&d=identicon&r=PG&f=1", "display_name": "prajo", "link": "https://stackoverflow.com/users/1464892/prajo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 372, "favorite_count": 1, "answer_count": 3, "score": 1, "last_activity_date": 1492696271, "creation_date": 1492581468, "question_id": 43487548, "link": "https://stackoverflow.com/questions/43487548/ruby-retrieve-local-variable-from-class", "title": "Ruby: Retrieve local variable from class", "body": "<p>I was reading up on metaprogramming and came across this exercise:</p>\n\n<p><a href=\"http://ruby-metaprogramming.rubylearning.com/html/Exercise_1.html\" rel=\"nofollow noreferrer\">http://ruby-metaprogramming.rubylearning.com/html/Exercise_1.html</a></p>\n\n<p>The question is:</p>\n\n<p>Given this class definition:</p>\n\n<pre><code>class A\n  def initialize\n    @a = 11\n    @@a = 22\n    a = 33\n  end\n  @a = 1\n  @@a = 2\n  a = 3\nend\n</code></pre>\n\n<p>Retrieve all the variables from outside the class, with output like so:</p>\n\n<pre><code>1\n2\n3\n11\n22\n33\n</code></pre>\n\n<p>Now, it's pretty straightforward to get the instance and class variables dynamically, even the local variable inside the constructor (it's the return value of the initialize method). But I'm stumped as to how to get the local variables <code>a=3</code>.</p>\n\n<p>As far as I know, this is not possible because the local variables cease to exist after the class definition is first read.</p>\n\n<p>The only roundabout way that I have made this work is to set a variable to the \"return\" value (for lack of a better term) of when the class is declared, like so:</p>\n\n<pre><code>val = class A\n  a = 3\nend\n\nputs val # =&gt; 3\n</code></pre>\n\n<p>Is this the only way?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "twitter-bootstrap", "rubygems", "acts-as-taggable-on"], "answers": [{"tags": [], "owner": {"reputation": 667, "user_id": 6141597, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8d52107448cce3dc1010f66ceb534270?s=128&d=identicon&r=PG&f=1", "display_name": "abax", "link": "https://stackoverflow.com/users/6141597/abax"}, "is_accepted": true, "score": 0, "last_activity_date": 1492610122, "creation_date": 1492610122, "answer_id": 43497836, "question_id": 43487446, "link": "https://stackoverflow.com/questions/43487446/my-rails-controller-didnt-work/43497836#43497836", "title": "My rails controller didn&#39;t work", "body": "<p>It looks like you are reassigning <code>@articles</code> in your controller to use pagination, which is overwriting <code>.includes</code> from the previous line. Try:</p>\n\n<pre><code>def index\n  articles = params[:tag].present? ? Article.tagged_with(params[:tag]) : Article.all\n  articles = articles.includes(:tags)\n  @articles = articles.page(params[:page])\nend\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 7760321, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/21335c4016c48fd0d38a228c06c2e788?s=128&d=identicon&r=PG&f=1", "display_name": "Justin", "link": "https://stackoverflow.com/users/7760321/justin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 51, "favorite_count": 1, "accepted_answer_id": 43497836, "answer_count": 1, "score": -2, "last_activity_date": 1492610122, "creation_date": 1492581052, "question_id": 43487446, "link": "https://stackoverflow.com/questions/43487446/my-rails-controller-didnt-work", "title": "My rails controller didn&#39;t work", "body": "<p>My rails application is used acts-as-taggable-on. I would like to add function which articles can be searched by tags. </p>\n\n<p>In my articles_controller.rb</p>\n\n<pre><code>  def index\n  @articles = params[:tag].present? ? Article.tagged_with(params[:tag]) : Article.all\n  @articles = @articles.includes(:tags)\n  @articles = Article.page(params[:page])\n  end\n</code></pre>\n\n<p>In index.html.erb</p>\n\n<pre><code>&lt;%= render partial:'tags',locals:{tags: article.tags}%&gt;\n</code></pre>\n\n<p>In _tags.html.erb</p>\n\n<pre><code>&lt;% tags.each do |tag| %&gt;\n&lt;%= link_to \"#{tag.name} (#{tag.taggings_count})\", articles_path(tag: tag.name) %&gt;\n&lt;%end%&gt;\n</code></pre>\n\n<p>However, article wasn't scoped by tags. I confirmed that acts-as-taggable-on is working. Only tagged_with method doesn't work.</p>\n\n<p>If you know any solution, please tell me.</p>\n\n<p>In Active record</p>\n\n<pre><code> irb(main):001:0&gt; Article.tagged_with(\"\u30a2\u30c3\u30d7\u30eb\u30d1\u30a4\") \n  ActsAsTaggableOn::Tag Load (25.9ms)  SELECT \"tags\".* FROM \"tags\" WHERE (LOWER(name) = LOWER('\u30a2\u30c3\u30d7\u30eb\u30d1\u30a4'))\n  Article Load (2.6ms)  SELECT \"articles\".* FROM \"articles\" JOIN taggings articles_taggings_2902983  ON articles_taggings_2902983.taggable_id = articles.id AND articles_taggings_2902983.taggable_type = 'Article' AND articles_taggings_2902983.tag_id = 2\n=&gt; #&lt;ActiveRecord::Relation [#&lt;Article id: 6, title: \"\u6a2a\u6d5c\u306e\u30a2\u30c3\u30d7\u30eb\u30d1\u30a4\u5c02\u9580\u5e97\", content: \"\u6a2a\u6d5c\u306e\u8d64\u30ec\u30f3\u30ac\u5009\u5eab\u306b\u30aa\u30fc\u30d7\u30f3\u3057\u305f\u30a2\u30c3\u30d7\u30eb\u30d1\u30a4\u5c02\u9580\u306e\u304a\u5e97\u3002\u5199\u771f\u306e\u30e9\u30ba\u30d9\u30ea\u30fc\u30bd\u30fc\u30b9\u306f\u4eba\u6c17\u306e\u5473\", created_at: \"2017ge: \"ras.jpg\"&gt;, #&lt;Article id: 18, title: \"tagfie\", content: \"\u30bf\u30b0\u306e\u6a5f\u80fd\u3092\u4fee\u7406\u3059\u308b\u305f\u3081\u306e\u30c6\u30b9\u30c8\u8a18\u4e8b\u3067\u3059\u3002\", created_at: \"2017-04-05 15:41:23\", updated_at: \"2017-04-05 16:48:39\", image: nil&gt;, #&lt;Article  pie\", content: \"Apple pie\u306e\u8a18\u4e8b\u3067\u3059\", created_at: \"2017-04-09 10:36:38\", updated_at: \"2017-04-09 10:36:38\", image: nil&gt;]&gt;\nirb(main):002:0&gt; \n</code></pre>\n\n<p>However, by rails s</p>\n\n<pre><code>ActiveRecord::SchemaMigration Load (2.7ms)  SELECT \"schema_migrations\".* FROM \"schema_migrations\"\nDEPRECATION WARNING: before_filter is deprecated and will be removed in Rails 5.1. Use before_action instead. (called from &lt;class:ApplicationController&gt; at /Users/futamidaiki/Desktop/lablab/choco/app/controllers/application_controller.rb:2)\nProcessing by ArticlesController#index as HTML\n  Parameters: {\"tag\"=&gt;\"\u30a2\u30c3\u30d7\u30eb\u30d1\u30a4\"}\n  ActsAsTaggableOn::Tag Load (5.8ms)  SELECT \"tags\".* FROM \"tags\" WHERE (LOWER(name) = LOWER('\u30a2\u30c3\u30d7\u30eb\u30d1\u30a4'))\n  Rendering articles/index.html.erb within layouts/application\n  Article Load (2.7ms)  SELECT  \"articles\".* FROM \"articles\" LIMIT ? OFFSET ?  [[\"LIMIT\", 10], [\"OFFSET\", 0]]\n  ActsAsTaggableOn::Tag Load (3.7ms)  SELECT \"tags\".* FROM \"tags\" INNER JOIN \"taggings\" ON \"tags\".\"id\" = \"taggings\".\"tag_id\" WHERE \"taggings\".\"taggable_id\" = ? AND \"taggings\".\"taggable_type\" = ? AND \"taggings\".\"context\" = ?  [[\"taggable_id\", 5], [\"taggable_type\", \"Article\"], [\"context\", \"tags\"]]\n  Rendered articles/_tags.html.erb (7.8ms)\n  User Load (3.2ms)  SELECT  \"users\".* FROM \"users\" WHERE \"users\".\"id\" = ? ORDER BY \"users\".\"id\" ASC LIMIT ?  [[\"id\", 2], [\"LIMIT\", 1]]\n  ActsAsTaggableOn::Tag Load (0.2ms)  SELECT \"tags\".* FROM \"tags\" INNER JOIN \"taggings\" ON \"tags\".\"id\" = \"taggings\".\"tag_id\" WHERE \"taggings\".\"taggable_id\" = ? AND \"taggings\".\"taggable_type\" = ? AND \"taggings\".\"context\" = ?  [[\"taggable_id\", 6], [\"taggable_type\", \"Article\"], [\"context\", \"tags\"]]\n  Rendered articles/_tags.html.erb (2.4ms)\n  ActsAsTaggableOn::Tag Load (0.5ms)  SELECT \"tags\".* FROM \"tags\" INNER JOIN \"taggings\" ON \"tags\".\"id\" = \"taggings\".\"tag_id\" WHERE \"taggings\".\"taggable_id\" = ? AND \"taggings\".\"taggable_type\" = ? AND \"taggings\".\"context\" = ?  [[\"taggable_id\", 7], [\"taggable_type\", \"Article\"], [\"context\", \"tags\"]]\n  Rendered articles/_tags.html.erb (2.8ms)\n  ActsAsTaggableOn::Tag Load (0.3ms)  SELECT \"tags\".* FROM \"tags\" INNER JOIN \"taggings\" ON \"tags\".\"id\" = \"taggings\".\"tag_id\" WHERE \"taggings\".\"taggable_id\" = ? AND \"taggings\".\"taggable_type\" = ? AND \"taggings\".\"context\" = ?  [[\"taggable_id\", 8], [\"taggable_type\", \"Article\"], [\"context\", \"tags\"]]\n  Rendered articles/_tags.html.erb (2.3ms)\n  ActsAsTaggableOn::Tag Load (0.2ms)  SELECT \"tags\".* FROM \"tags\" INNER JOIN \"taggings\" ON \"tags\".\"id\" = \"taggings\".\"tag_id\" WHERE \"taggings\".\"taggable_id\" = ? AND \"taggings\".\"taggable_type\" = ? AND \"taggings\".\"context\" = ?  [[\"taggable_id\", 10], [\"taggable_type\", \"Article\"], [\"context\", \"tags\"]]\n  Rendered articles/_tags.html.erb (1.7ms)\n  ActsAsTaggableOn::Tag Load (0.2ms)  SELECT \"tags\".* FROM \"tags\" INNER JOIN \"taggings\" ON \"tags\".\"id\" = \"taggings\".\"tag_id\" WHERE \"taggings\".\"taggable_id\" = ? AND \"taggings\".\"taggable_type\" = ? AND \"taggings\".\"context\" = ?  [[\"taggable_id\", 11], [\"taggable_type\", \"Article\"], [\"context\", \"tags\"]]\n  Rendered articles/_tags.html.erb (1.4ms)\n  ActsAsTaggableOn::Tag Load (0.2ms)  SELECT \"tags\".* FROM \"tags\" INNER JOIN \"taggings\" ON \"tags\".\"id\" = \"taggings\".\"tag_id\" WHERE \"taggings\".\"taggable_id\" = ? AND \"taggings\".\"taggable_type\" = ? AND \"taggings\".\"context\" = ?  [[\"taggable_id\", 18], [\"taggable_type\", \"Article\"], [\"context\", \"tags\"]]\n  Rendered articles/_tags.html.erb (1.8ms)\n  ActsAsTaggableOn::Tag Load (0.2ms)  SELECT \"tags\".* FROM \"tags\" INNER JOIN \"taggings\" ON \"tags\".\"id\" = \"taggings\".\"tag_id\" WHERE \"taggings\".\"taggable_id\" = ? AND \"taggings\".\"taggable_type\" = ? AND \"taggings\".\"context\" = ?  [[\"taggable_id\", 19], [\"taggable_type\", \"Article\"], [\"context\", \"tags\"]]\n  Rendered articles/_tags.html.erb (1.7ms)\n  ActsAsTaggableOn::Tag Load (0.3ms)  SELECT \"tags\".* FROM \"tags\" INNER JOIN \"taggings\" ON \"tags\".\"id\" = \"taggings\".\"tag_id\" WHERE \"taggings\".\"taggable_id\" = ? AND \"taggings\".\"taggable_type\" = ? AND \"taggings\".\"context\" = ?  [[\"taggable_id\", 20], [\"taggable_type\", \"Article\"], [\"context\", \"tags\"]]\n  Rendered articles/_tags.html.erb (1.8ms)\n   (0.2ms)  SELECT COUNT(*) FROM \"articles\"\n  Rendered articles/index.html.erb within layouts/application (1827.4ms)\n  ActsAsTaggableOn::Tag Load (0.5ms)  SELECT \"tags\".* FROM \"tags\" WHERE (LOWER(name) = LOWER('\u6e0b\u8c37'))\n  ActsAsTaggableOn::Tag Load (0.3ms)  SELECT \"tags\".* FROM \"tags\" WHERE (LOWER(name) = LOWER('\u8868\u53c2\u9053'))\n  ActsAsTaggableOn::Tag Load (0.3ms)  SELECT \"tags\".* FROM \"tags\" WHERE (LOWER(name) = LOWER('\u9752\u5c71'))\n  ActsAsTaggableOn::Tag Load (0.2ms)  SELECT \"tags\".* FROM \"tags\" WHERE (LOWER(name) = LOWER('\u6a2a\u6d5c'))\n  ActsAsTaggableOn::Tag Load (0.3ms)  SELECT \"tags\".* FROM \"tags\" WHERE (LOWER(name) = LOWER('\u305d\u306e\u4ed6'))\nCompleted 200 OK in 3143ms (Views: 2865.4ms | ActiveRecord: 21.7ms)\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby"], "answers": [{"comments": [{"owner": {"reputation": 28716, "user_id": 828193, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/pmNlX.png?s=128&g=1", "display_name": "user000001", "link": "https://stackoverflow.com/users/828193/user000001"}, "edited": false, "score": 4, "creation_date": 1492581090, "post_id": 43487399, "comment_id": 74029918, "body": "+1 was about to post a really similar but a bit storter asnwer: <code>data.reject{|k,v| [:c, :d].include?(k) &amp;&amp; v == &#39;&#39;}</code>"}, {"owner": {"reputation": 12629, "user_id": 4739257, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/MdhEs.jpg?s=128&g=1", "display_name": "Ilya", "link": "https://stackoverflow.com/users/4739257/ilya"}, "reply_to_user": {"reputation": 28716, "user_id": 828193, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/pmNlX.png?s=128&g=1", "display_name": "user000001", "link": "https://stackoverflow.com/users/828193/user000001"}, "edited": false, "score": 0, "creation_date": 1492586137, "post_id": 43487399, "comment_id": 74032773, "body": "The first part is super ugly (deleting hash elements with <code>each_with_object</code> is a something new in Ruby), the second is cool, thanks, @user000001 :)"}, {"owner": {"reputation": 47232, "user_id": 1772830, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/Qtoqg.jpg?s=128&g=1", "display_name": "Andrey Deineko", "link": "https://stackoverflow.com/users/1772830/andrey-deineko"}, "reply_to_user": {"reputation": 12629, "user_id": 4739257, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/MdhEs.jpg?s=128&g=1", "display_name": "Ilya", "link": "https://stackoverflow.com/users/4739257/ilya"}, "edited": false, "score": 0, "creation_date": 1492586343, "post_id": 43487399, "comment_id": 74032905, "body": "Both solutions result in new object - hash. If @Ilya thinks that something gets deleted in either of these - I added link to documentation for beginners, feel free to learn what each method does and how they do not delete anything."}, {"owner": {"reputation": 12629, "user_id": 4739257, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/MdhEs.jpg?s=128&g=1", "display_name": "Ilya", "link": "https://stackoverflow.com/users/4739257/ilya"}, "edited": false, "score": 0, "creation_date": 1492586534, "post_id": 43487399, "comment_id": 74033034, "body": "@Adnrey, I didn&#39;t say that it&#39;s incorrect - it&#39;s just as ugly as the instance in question :) What is the point to post this, if the author already has as clumsy solution as yours (IMO even more readable)?"}, {"owner": {"reputation": 3914, "user_id": 4057366, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/uZ3e5.jpg?s=128&g=1", "display_name": "Alex Holubenko", "link": "https://stackoverflow.com/users/4057366/alex-holubenko"}, "edited": false, "score": 0, "creation_date": 1492586911, "post_id": 43487399, "comment_id": 74033272, "body": "what about <code>#empty?</code> instead of comparison with empty string ?)"}, {"owner": {"reputation": 47232, "user_id": 1772830, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/Qtoqg.jpg?s=128&g=1", "display_name": "Andrey Deineko", "link": "https://stackoverflow.com/users/1772830/andrey-deineko"}, "reply_to_user": {"reputation": 3914, "user_id": 4057366, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/uZ3e5.jpg?s=128&g=1", "display_name": "Alex Holubenko", "link": "https://stackoverflow.com/users/4057366/alex-holubenko"}, "edited": false, "score": 0, "creation_date": 1492587032, "post_id": 43487399, "comment_id": 74033347, "body": "@AlexGolubenko It is the problem of most of the answers here, they don&#39;t take corner cases into account :) <code>[].empty?</code> =&gt; <code>true</code>. Not what OP wants, even though it reads much cleaner :)"}, {"owner": {"reputation": 12629, "user_id": 4739257, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/MdhEs.jpg?s=128&g=1", "display_name": "Ilya", "link": "https://stackoverflow.com/users/4739257/ilya"}, "edited": false, "score": 0, "creation_date": 1492587987, "post_id": 43487399, "comment_id": 74033981, "body": "One more: the author wrote <code>to get the same result</code>. Strictly speaking (you&#39;re like  nit-picking, right?:)), your answer is wrong because you create a new object instead of mutate existing (see docs about <code>delete</code> method in the questoin)"}], "tags": [], "owner": {"reputation": 47232, "user_id": 1772830, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/Qtoqg.jpg?s=128&g=1", "display_name": "Andrey Deineko", "link": "https://stackoverflow.com/users/1772830/andrey-deineko"}, "is_accepted": true, "score": 2, "last_activity_date": 1492585431, "last_edit_date": 1495541404, "creation_date": 1492580893, "answer_id": 43487399, "question_id": 43487356, "link": "https://stackoverflow.com/questions/43487356/delete-key-from-hash-if-value-is-empty-in-ruby/43487399#43487399", "title": "Delete key from hash if value is empty in Ruby", "body": "<p>You can use <a href=\"http://ruby-doc.org/core-2.4.1/Enumerable.html#method-i-each_with_object\" rel=\"nofollow noreferrer\">Enumerable#<code>each_with_object</code></a> to build a new hash on the fly applying your conditions:</p>\n\n<pre><code>data.each_with_object({}) do |(k, v), h|\n  h[k] = v unless %i(c d).include?(k) &amp;&amp; v == ''\nend\n#=&gt; {:a=&gt;\"A\", :b=&gt;\"\", :c=&gt;\"C\"}\n</code></pre>\n\n<p>As <a href=\"https://stackoverflow.com/users/828193/user000001\">@user000001</a> suggested in comments, another good option is to use <a href=\"http://ruby-doc.org/core-2.4.1/Enumerable.html#method-i-reject\" rel=\"nofollow noreferrer\">Enumerable#<code>reject</code></a>:</p>\n\n<pre><code>data.reject { |k, v| %i(c d).include?(k) &amp;&amp; v == '' }\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 3367, "user_id": 822256, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2ITN7.png?s=128&g=1", "display_name": "sa77", "link": "https://stackoverflow.com/users/822256/sa77"}, "is_accepted": false, "score": 0, "last_activity_date": 1492582489, "last_edit_date": 1492582489, "creation_date": 1492581415, "answer_id": 43487530, "question_id": 43487356, "link": "https://stackoverflow.com/questions/43487356/delete-key-from-hash-if-value-is-empty-in-ruby/43487530#43487530", "title": "Delete key from hash if value is empty in Ruby", "body": "<p>you can just use <code>select</code> to extract hash with keys that have values</p>\n\n<pre><code>data = {:a =&gt; 'A', :b =&gt; '', :c =&gt; 'C', :d =&gt; ''}\ndata.select() {|k, v| v.present? || k == :a || k == :b }\n# =&gt; =&gt; {:a=&gt;\"A\", :b=&gt;\"\", :c=&gt;\"C\"}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 12629, "user_id": 4739257, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/MdhEs.jpg?s=128&g=1", "display_name": "Ilya", "link": "https://stackoverflow.com/users/4739257/ilya"}, "edited": false, "score": 0, "creation_date": 1492581759, "post_id": 43487559, "comment_id": 74030212, "body": "Note, that <code>delete_if</code> mutates the original object"}, {"owner": {"reputation": 47232, "user_id": 1772830, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/Qtoqg.jpg?s=128&g=1", "display_name": "Andrey Deineko", "link": "https://stackoverflow.com/users/1772830/andrey-deineko"}, "edited": false, "score": 0, "creation_date": 1492581760, "post_id": 43487559, "comment_id": 74030213, "body": "It&#39;s you second answer and it is wrong again. Please, read the question carefully."}, {"owner": {"reputation": 47232, "user_id": 1772830, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/Qtoqg.jpg?s=128&g=1", "display_name": "Andrey Deineko", "link": "https://stackoverflow.com/users/1772830/andrey-deineko"}, "edited": false, "score": 0, "creation_date": 1492581913, "post_id": 43487559, "comment_id": 74030289, "body": "Yes, now that you&#39;ve stolen the <code>%i(c d).include?(k)</code> part it became... wrong again. Why? Because you do not have <code>k</code> block variable."}, {"owner": {"reputation": 47232, "user_id": 1772830, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/Qtoqg.jpg?s=128&g=1", "display_name": "Andrey Deineko", "link": "https://stackoverflow.com/users/1772830/andrey-deineko"}, "edited": false, "score": 0, "creation_date": 1492582362, "post_id": 43487559, "comment_id": 74030514, "body": "Answer is still wring wrong. <code>&quot; &quot;.to_s.strip</code> =&gt; <code>&quot;&quot;</code>, which is not what OP wants. It clearly states: <code>if their value is an empty string</code>. <code>&quot; &quot;</code> <b><i>is not</i></b> an empty string."}, {"owner": {"reputation": 47232, "user_id": 1772830, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/Qtoqg.jpg?s=128&g=1", "display_name": "Andrey Deineko", "link": "https://stackoverflow.com/users/1772830/andrey-deineko"}, "reply_to_user": {"reputation": 12629, "user_id": 4739257, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/MdhEs.jpg?s=128&g=1", "display_name": "Ilya", "link": "https://stackoverflow.com/users/4739257/ilya"}, "edited": false, "score": 0, "creation_date": 1492584670, "post_id": 43487559, "comment_id": 74031832, "body": "@Ilya You have <b><i>changed</i></b> the wrong answer leaving it wrong. I wonder what&#39;s the point of that? :)"}], "tags": [], "owner": {"reputation": 999, "user_id": 2039718, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4URjU.jpg?s=128&g=1", "display_name": "Dnyanarth lonkar", "link": "https://stackoverflow.com/users/2039718/dnyanarth-lonkar"}, "is_accepted": false, "score": 1, "last_activity_date": 1492581796, "last_edit_date": 1492581796, "creation_date": 1492581554, "answer_id": 43487559, "question_id": 43487356, "link": "https://stackoverflow.com/questions/43487356/delete-key-from-hash-if-value-is-empty-in-ruby/43487559#43487559", "title": "Delete key from hash if value is empty in Ruby", "body": "<p>You can also use <code>delete if</code>:</p>\n\n<pre><code>data = { :a =&gt; 'A', :b =&gt; '', :c =&gt; 'C', :d =&gt; '' }\ndata.delete_if { |k, value| %i(c d).include?(k) &amp;&amp; value.to_s.strip == '' }\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 47232, "user_id": 1772830, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/Qtoqg.jpg?s=128&g=1", "display_name": "Andrey Deineko", "link": "https://stackoverflow.com/users/1772830/andrey-deineko"}, "edited": false, "score": 0, "creation_date": 1492582472, "post_id": 43487724, "comment_id": 74030573, "body": "not what OP wants. It clearly states: <code>if their value is an empty string</code>. <code>nil.blank?</code> =&gt; <code>true</code> (wrong). <code>&quot; &quot;.blank?</code> =&gt; <code>true</code> (wrong)..."}, {"owner": {"reputation": 28138, "user_id": 337166, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/fKzgt.jpg?s=128&g=1", "display_name": "jvnill", "link": "https://stackoverflow.com/users/337166/jvnill"}, "reply_to_user": {"reputation": 47232, "user_id": 1772830, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/Qtoqg.jpg?s=128&g=1", "display_name": "Andrey Deineko", "link": "https://stackoverflow.com/users/1772830/andrey-deineko"}, "edited": false, "score": 0, "creation_date": 1492595310, "post_id": 43487724, "comment_id": 74038862, "body": "it&#39;s semantics.  OP can easily change the if condition to <code>data[key] == &#39;&#39;</code>.  You don&#39;t necessarily need to supply the exact code."}, {"owner": {"reputation": 47232, "user_id": 1772830, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/Qtoqg.jpg?s=128&g=1", "display_name": "Andrey Deineko", "link": "https://stackoverflow.com/users/1772830/andrey-deineko"}, "edited": false, "score": 0, "creation_date": 1492595470, "post_id": 43487724, "comment_id": 74038988, "body": "Can agree with that. But for beginner this can look the same and later she&#39;d find herself lost having weird bug. I think it is at least worth noting that it&#39;s not equal to initial code."}], "tags": [], "owner": {"reputation": 28138, "user_id": 337166, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/fKzgt.jpg?s=128&g=1", "display_name": "jvnill", "link": "https://stackoverflow.com/users/337166/jvnill"}, "is_accepted": false, "score": 1, "last_activity_date": 1492582237, "creation_date": 1492582237, "answer_id": 43487724, "question_id": 43487356, "link": "https://stackoverflow.com/questions/43487356/delete-key-from-hash-if-value-is-empty-in-ruby/43487724#43487724", "title": "Delete key from hash if value is empty in Ruby", "body": "<p>you can always just iterate through the list of keys</p>\n\n<pre><code>KEYS_TO_DELETE_IF_BLANK = %i[c d]\n\nKEYS_TO_DELETE_IF_BLANK.each do |key|\n  data.delete(key) if data[key].blank?\nend\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 16396, "user_id": 2564298, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/BhG1x.jpg?s=128&g=1", "display_name": "Rajdeep Singh", "link": "https://stackoverflow.com/users/2564298/rajdeep-singh"}, "is_accepted": false, "score": 4, "last_activity_date": 1492582767, "creation_date": 1492582767, "answer_id": 43487881, "question_id": 43487356, "link": "https://stackoverflow.com/questions/43487356/delete-key-from-hash-if-value-is-empty-in-ruby/43487881#43487881", "title": "Delete key from hash if value is empty in Ruby", "body": "<p>You can use <code>Hash#delete_if</code> method</p>\n\n<pre><code>unwanted_keys = [:c, :d]\nhash = {:a =&gt; 'A', :b =&gt; '', :c =&gt; 'C', :d =&gt; ''}\nhash.delete_if{ |k,v| unwanted_keys.include?(k) &amp;&amp; v.blank? }\n</code></pre>\n\n<p>Hope that helps!</p>\n"}], "owner": {"reputation": 3233, "user_id": 1198897, "user_type": "registered", "accept_rate": 45, "profile_image": "https://i.stack.imgur.com/PtqIb.jpg?s=128&g=1", "display_name": "Calvin", "link": "https://stackoverflow.com/users/1198897/calvin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1331, "favorite_count": 0, "accepted_answer_id": 43487399, "answer_count": 5, "score": -2, "last_activity_date": 1492586700, "creation_date": 1492580743, "last_edit_date": 1492584086, "question_id": 43487356, "link": "https://stackoverflow.com/questions/43487356/delete-key-from-hash-if-value-is-empty-in-ruby", "title": "Delete key from hash if value is empty in Ruby", "body": "<p>Given:</p>\n\n<pre><code>data = {:a =&gt; 'A', :b =&gt; '', :c =&gt; 'C', :d =&gt; ''}\n</code></pre>\n\n<p>Objective: To remove key <code>:c</code> and <code>:d</code> if their value is an empty string. However, <code>:a</code> and <code>:b</code> should remain even if their value is an empty string. In the above example, end result should be:</p>\n\n<pre><code>{:a =&gt; 'A', :b =&gt; '', :c =&gt; 'C'}\n</code></pre>\n\n<p>Current approach:</p>\n\n<pre><code>if data[:c] == ''\n  data.delete(:c)\nend\nif data[:d] == ''\n  data.delete(:d)\nend\n</code></pre>\n\n<p>Is there a better approach to get the same result? (In reality, key of type c and d is more than 10 which result in a long list of <code>if</code> checks.)</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-4", "devise", "sti"], "answers": [{"comments": [{"owner": {"reputation": 33, "user_id": 5072531, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-hRE-FfYukAg/AAAAAAAAAAI/AAAAAAAACH8/jJMDbdZKhc4/photo.jpg?sz=128", "display_name": "Suvajit Chakrabarty", "link": "https://stackoverflow.com/users/5072531/suvajit-chakrabarty"}, "edited": false, "score": 0, "creation_date": 1492584043, "post_id": 43487342, "comment_id": 74031429, "body": "This is not working. Now whenever I am trying to access even the pages that typeA is allowed to access, it is signing him out. Also when I am signed out and trying to access &#39;<a href=\"http://localhost:3000/rate\" rel=\"nofollow noreferrer\">localhost:3000/rate</a>&#39;, it shows a Rails error page stating that unknown variable &#39;current_user.type&#39;. With the code that I had done earlier, when I am signed out and I would try to access &#39;<a href=\"http://localhost:3000/rate\" rel=\"nofollow noreferrer\">localhost:3000/rate</a>&#39;, it would just refresh the page with the Devise flash message stating &#39;You need to sign in or sign up before continuing&#39; which I am good with. Anyway thanks for your answer."}, {"owner": {"reputation": 38092, "user_id": 18706, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/cabf735ce7b8b4471ef46ea54f71832d?s=128&d=identicon&r=PG", "display_name": "mahemoff", "link": "https://stackoverflow.com/users/18706/mahemoff"}, "reply_to_user": {"reputation": 33, "user_id": 5072531, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-hRE-FfYukAg/AAAAAAAAAAI/AAAAAAAACH8/jJMDbdZKhc4/photo.jpg?sz=128", "display_name": "Suvajit Chakrabarty", "link": "https://stackoverflow.com/users/5072531/suvajit-chakrabarty"}, "edited": false, "score": 0, "creation_date": 1492584458, "post_id": 43487342, "comment_id": 74031701, "body": "Ah didn&#39;t realise authenticate_user! was standard Devise, so you shouldn&#39;t be overriding it. I think the code here should work. It will first authenticate to set current_user, then authorize."}], "tags": [], "owner": {"reputation": 38092, "user_id": 18706, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/cabf735ce7b8b4471ef46ea54f71832d?s=128&d=identicon&r=PG", "display_name": "mahemoff", "link": "https://stackoverflow.com/users/18706/mahemoff"}, "is_accepted": false, "score": 0, "last_activity_date": 1492584398, "last_edit_date": 1492584398, "creation_date": 1492580694, "answer_id": 43487342, "question_id": 43487271, "link": "https://stackoverflow.com/questions/43487271/how-do-i-make-certain-pages-of-my-ruby-on-rails-application-inaccessible-to-one/43487342#43487342", "title": "How do I make certain pages of my ruby on rails application inaccessible to one of my STI based Devise User model types?", "body": "<p>Try this:</p>\n\n<pre><code>class ApplicationController\n\n  before_action :authenticate_user!\n\n  def authorize_user!\n    if current_user.type == \"typeA\"\n      sign_out(current_user)\n      redirect_to new_user_session_path\n    end\n  end\n\nend\n</code></pre>\n\n<p>with your controller:</p>\n\n<pre><code>class SomeController &lt; ApplicationController\n\n    before_action :authorize_user!, except: [:index, :show]\n\n    def top_secret\n        ...\n    end\n\nend\n</code></pre>\n\n<p>I believe if a before_action (the new name for before_filter) renders or redirects, the action won't be processed.</p>\n"}, {"comments": [{"owner": {"reputation": 33, "user_id": 5072531, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-hRE-FfYukAg/AAAAAAAAAAI/AAAAAAAACH8/jJMDbdZKhc4/photo.jpg?sz=128", "display_name": "Suvajit Chakrabarty", "link": "https://stackoverflow.com/users/5072531/suvajit-chakrabarty"}, "edited": false, "score": 0, "creation_date": 1492585123, "post_id": 43488063, "comment_id": 74032099, "body": "I do not want the whole controller to be inaccessible to typeA. I want only the &#39;rate&#39; page to be inaccessible to him. There are other methods like index, create, show etc, which should still be accessible to him. How do I put that in my code ?"}, {"owner": {"reputation": 3367, "user_id": 822256, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2ITN7.png?s=128&g=1", "display_name": "sa77", "link": "https://stackoverflow.com/users/822256/sa77"}, "reply_to_user": {"reputation": 33, "user_id": 5072531, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-hRE-FfYukAg/AAAAAAAAAAI/AAAAAAAACH8/jJMDbdZKhc4/photo.jpg?sz=128", "display_name": "Suvajit Chakrabarty", "link": "https://stackoverflow.com/users/5072531/suvajit-chakrabarty"}, "edited": false, "score": 0, "creation_date": 1492585271, "post_id": 43488063, "comment_id": 74032186, "body": "you can use <code>only:</code> option to do that <code>before_filter { |c| c.confirm_user_type(TypeA) }, :only =&gt; [:rate]</code>"}, {"owner": {"reputation": 33, "user_id": 5072531, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-hRE-FfYukAg/AAAAAAAAAAI/AAAAAAAACH8/jJMDbdZKhc4/photo.jpg?sz=128", "display_name": "Suvajit Chakrabarty", "link": "https://stackoverflow.com/users/5072531/suvajit-chakrabarty"}, "edited": false, "score": 0, "creation_date": 1492585759, "post_id": 43488063, "comment_id": 74032511, "body": "The error page that I get now is /Users/Suvajit/Documents/Code/Rails/Mckenzie/app/controllers&zwnj;&#8203;/dishes_controller.r&zwnj;&#8203;b:4: syntax error, unexpected &#39;:&#39;, expecting keyword_end .confirm_user_type(TypeA) } :only =&gt; [:rate] ^      The code that I have used is     <code>before_filter  { |c| c.confirm_user_type(TypeA) }, :only =&gt; [:rate]</code>"}, {"owner": {"reputation": 3367, "user_id": 822256, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2ITN7.png?s=128&g=1", "display_name": "sa77", "link": "https://stackoverflow.com/users/822256/sa77"}, "reply_to_user": {"reputation": 33, "user_id": 5072531, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-hRE-FfYukAg/AAAAAAAAAAI/AAAAAAAACH8/jJMDbdZKhc4/photo.jpg?sz=128", "display_name": "Suvajit Chakrabarty", "link": "https://stackoverflow.com/users/5072531/suvajit-chakrabarty"}, "edited": false, "score": 0, "creation_date": 1492586525, "post_id": 43488063, "comment_id": 74033031, "body": "try this: <code>before_filter { |c| c.action_name == &quot;rate&quot; &amp;&amp; c.confirm_user_type(TypeA) }</code>"}, {"owner": {"reputation": 33, "user_id": 5072531, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-hRE-FfYukAg/AAAAAAAAAAI/AAAAAAAACH8/jJMDbdZKhc4/photo.jpg?sz=128", "display_name": "Suvajit Chakrabarty", "link": "https://stackoverflow.com/users/5072531/suvajit-chakrabarty"}, "edited": false, "score": 0, "creation_date": 1492587239, "post_id": 43488063, "comment_id": 74033473, "body": "Hey this worked. I just also had to include the line <code>sign_out(current_user)</code>  before redirecting to new_user_session_path so that it doesn&#39;t say that the user is already signed in and redirects to the root page instead. Anyway, thanks a lot. I would have voted you your answer up but my stackoverflow reputation is below 15 so I can&#39;t make a vote."}, {"owner": {"reputation": 3367, "user_id": 822256, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2ITN7.png?s=128&g=1", "display_name": "sa77", "link": "https://stackoverflow.com/users/822256/sa77"}, "reply_to_user": {"reputation": 33, "user_id": 5072531, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-hRE-FfYukAg/AAAAAAAAAAI/AAAAAAAACH8/jJMDbdZKhc4/photo.jpg?sz=128", "display_name": "Suvajit Chakrabarty", "link": "https://stackoverflow.com/users/5072531/suvajit-chakrabarty"}, "edited": false, "score": 0, "creation_date": 1492587975, "post_id": 43488063, "comment_id": 74033971, "body": "You can accept the answer if this solves your problem."}, {"owner": {"reputation": 33, "user_id": 5072531, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-hRE-FfYukAg/AAAAAAAAAAI/AAAAAAAACH8/jJMDbdZKhc4/photo.jpg?sz=128", "display_name": "Suvajit Chakrabarty", "link": "https://stackoverflow.com/users/5072531/suvajit-chakrabarty"}, "edited": false, "score": 0, "creation_date": 1492588079, "post_id": 43488063, "comment_id": 74034030, "body": "Sorry, I had forgotten to do that :)"}], "tags": [], "owner": {"reputation": 3367, "user_id": 822256, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2ITN7.png?s=128&g=1", "display_name": "sa77", "link": "https://stackoverflow.com/users/822256/sa77"}, "is_accepted": true, "score": 1, "last_activity_date": 1492583712, "last_edit_date": 1492583712, "creation_date": 1492583401, "answer_id": 43488063, "question_id": 43487271, "link": "https://stackoverflow.com/questions/43487271/how-do-i-make-certain-pages-of-my-ruby-on-rails-application-inaccessible-to-one/43488063#43488063", "title": "How do I make certain pages of my ruby on rails application inaccessible to one of my STI based Devise User model types?", "body": "<p>you can add another <code>before_filter</code> on the controller you want to restrict the access just to confirm your STI user type without overiding devise's <code>authenticate_user!</code> filter. </p>\n\n<p><strong>application_controller.rb</strong></p>\n\n<pre><code>class ApplicationController &lt; ActionController::Base\n\n  def confirm_user_type(user_type)\n    redirect_to new_user_session_path unless current_user.is_a?(user_type)\n  end\n\nend\n</code></pre>\n\n<p><strong>pages_controller.rb</strong></p>\n\n<pre><code>class PagesController &lt; ApplicationController\n  # must be authenticated to access\n  before_filter :authenticate_user!\n  # must be user of TypeA to access\n  before_filter { |c| c.confirm_user_type(TypeA) }\n\n  def rate\n    ...\n  end\nend\n</code></pre>\n\n<p>Then, you can use the same filter <code>before_filter { |c| c.confirm_user_type(TypeB) }</code> for STI user <code>type: 'TypeB'</code></p>\n"}], "owner": {"reputation": 33, "user_id": 5072531, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-hRE-FfYukAg/AAAAAAAAAAI/AAAAAAAACH8/jJMDbdZKhc4/photo.jpg?sz=128", "display_name": "Suvajit Chakrabarty", "link": "https://stackoverflow.com/users/5072531/suvajit-chakrabarty"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 88, "favorite_count": 0, "accepted_answer_id": 43488063, "answer_count": 2, "score": 1, "last_activity_date": 1492584398, "creation_date": 1492580384, "question_id": 43487271, "link": "https://stackoverflow.com/questions/43487271/how-do-i-make-certain-pages-of-my-ruby-on-rails-application-inaccessible-to-one", "title": "How do I make certain pages of my ruby on rails application inaccessible to one of my STI based Devise User model types?", "body": "<p>I want one pages of my ruby on rails web application inaccessible to one of my STI model types. I have two models typeA and typeB inheriting from User. I have used the column type in the User table to implement STI. I am using Devise gem for User sessions. I want one webpage '<a href=\"http://localhost:3000/rate\" rel=\"nofollow noreferrer\">http://localhost:3000/rate</a>' inaccessible to my typeA User. Whenever an User logs in who is of the type 'typeA', he does not have the option of seeing the link 'Rate'. But I also do not want him to be able to access that page by the link '<a href=\"http://localhost:3000/rate\" rel=\"nofollow noreferrer\">http://localhost:3000/rate</a>'. If he tries to access it through that link, I want to sign him out and make him log in again. \nI managed this by using a piece of code in my Controller with the specific method for 'rate'.</p>\n\n<pre><code>def rate\n  if current_user.type == \"typeA\"\n    sign_out(current_user)\n    redirect_to new_user_session_path\n  else\n    #Code for User of typeB\n  end\nend\n</code></pre>\n\n<p>This is working but I wanted to know if this can be done in a better way using <strong>before_filter :authenticate_user!</strong> or something else\nRight now my before_filter part looks like this</p>\n\n<pre><code>before_filter :authenticate_user!, except: [:index, :show]\n</code></pre>\n\n<p>Is there any way I can make a change to the upper code to achieve that functionality.<br>\nP.S: Maybe this can be done better if I had used roles or other gems like CanCan/Pundit but I do not have much time left to submit my project, so I do not want to get into all that right now.</p>\n"}, {"tags": ["ruby", "compass-sass", "compass"], "comments": [{"owner": {"reputation": 418, "user_id": 6331585, "user_type": "registered", "accept_rate": 60, "profile_image": "https://lh5.googleusercontent.com/--Spi1QdCgC0/AAAAAAAAAAI/AAAAAAAABnU/sJNL2oLTBHY/photo.jpg?sz=128", "display_name": "Vishwas Nahar", "link": "https://stackoverflow.com/users/6331585/vishwas-nahar"}, "edited": false, "score": 0, "creation_date": 1492579791, "post_id": 43487035, "comment_id": 74029375, "body": "try with this gem install compass"}, {"owner": {"reputation": 13, "user_id": 6324477, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-RRSTnTj51Mk/AAAAAAAAAAI/AAAAAAAAAAw/fSsFGkvnY_c/photo.jpg?sz=128", "display_name": "Edzel Kim Lowie Abliter", "link": "https://stackoverflow.com/users/6324477/edzel-kim-lowie-abliter"}, "reply_to_user": {"reputation": 418, "user_id": 6331585, "user_type": "registered", "accept_rate": 60, "profile_image": "https://lh5.googleusercontent.com/--Spi1QdCgC0/AAAAAAAAAAI/AAAAAAAABnU/sJNL2oLTBHY/photo.jpg?sz=128", "display_name": "Vishwas Nahar", "link": "https://stackoverflow.com/users/6331585/vishwas-nahar"}, "edited": false, "score": 0, "creation_date": 1492581223, "post_id": 43487035, "comment_id": 74029984, "body": "I try that, but the same error"}, {"owner": {"reputation": 4477, "user_id": 703903, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/91ffc6b42d4813fdff4f101d00181744?s=128&d=identicon&r=PG", "display_name": "odlp", "link": "https://stackoverflow.com/users/703903/odlp"}, "edited": false, "score": 0, "creation_date": 1492679668, "post_id": 43487035, "comment_id": 74083656, "body": "Strange it&#39;s trying to connect to <code>localhost:80</code> for Ruby Gems. What happens if you run: <code>gem install compass --source https:&#47;&#47;rubygems.org</code>"}], "owner": {"reputation": 13, "user_id": 6324477, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-RRSTnTj51Mk/AAAAAAAAAAI/AAAAAAAAAAw/fSsFGkvnY_c/photo.jpg?sz=128", "display_name": "Edzel Kim Lowie Abliter", "link": "https://stackoverflow.com/users/6324477/edzel-kim-lowie-abliter"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 230, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1492579516, "creation_date": 1492579516, "last_edit_date": 1592644375, "question_id": 43487035, "link": "https://stackoverflow.com/questions/43487035/installing-gem-compass-error-failed-to-open-connection-to-localhost80-in-windo", "title": "Installing gem compass error (Failed to open connection to localhost:80 in Windows)", "body": "<p>How can I get rid of this one... Thanks</p>\n<p>ERROR:  Could not find a valid gem 'compass' (&gt;= 0), here is why:</p>\n<p>Unable to download data from <a href=\"https://rubygems.org/\" rel=\"nofollow noreferrer\">https://rubygems.org/</a></p>\n<ul>\n<li><p>Errno::ECONNREFUSED: Failed to open TCP connection to localhost:80</p>\n<p>(No connection could be made because the target machine actively refused it.</p>\n</li>\n<li><p>connect(2) for &quot;localhost&quot; port 80) (<a href=\"https://api.rubygems.org/specs.4.8.gz\" rel=\"nofollow noreferrer\">https://api.rubygems.org/specs.4.8.gz</a>)</p>\n</li>\n</ul>\n"}, {"tags": ["ruby", "testunit"], "comments": [{"owner": {"reputation": 70793, "user_id": 28128, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/4e974a514f0764fdfe99a8915f192002?s=128&d=identicon&r=PG", "display_name": "David Grayson", "link": "https://stackoverflow.com/users/28128/david-grayson"}, "edited": false, "score": 1, "creation_date": 1492578678, "post_id": 43486662, "comment_id": 74028944, "body": "Try renaming <code>test&#47;spec.rb</code> to <code>test&#47;foo_test.rb</code>.  I think it needs to end with <code>_test.rb</code>."}, {"owner": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "edited": false, "score": 0, "creation_date": 1492579053, "post_id": 43486662, "comment_id": 74029093, "body": "It runs inside the folder but doesn&#39;t load the test-unit, try copying it 1 folder back."}, {"owner": {"reputation": 3515, "user_id": 3574628, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/W5BJ2.jpg?s=128&g=1", "display_name": "luther", "link": "https://stackoverflow.com/users/3574628/luther"}, "reply_to_user": {"reputation": 70793, "user_id": 28128, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/4e974a514f0764fdfe99a8915f192002?s=128&d=identicon&r=PG", "display_name": "David Grayson", "link": "https://stackoverflow.com/users/28128/david-grayson"}, "edited": false, "score": 0, "creation_date": 1492585924, "post_id": 43486662, "comment_id": 74032646, "body": "@DavidGrayson: Thank you. The <code>*_test.rb</code> filename got it running."}], "answers": [{"comments": [{"owner": {"reputation": 7389, "user_id": 2235594, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/4MssP.jpg?s=128&g=1", "display_name": "davegson", "link": "https://stackoverflow.com/users/2235594/davegson"}, "edited": false, "score": 0, "creation_date": 1492610774, "post_id": 43498013, "comment_id": 74050354, "body": "now you know and don&#39;t have to try/think anymore don&#39;t you? ;)"}, {"owner": {"reputation": 70793, "user_id": 28128, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/4e974a514f0764fdfe99a8915f192002?s=128&d=identicon&r=PG", "display_name": "David Grayson", "link": "https://stackoverflow.com/users/28128/david-grayson"}, "reply_to_user": {"reputation": 7389, "user_id": 2235594, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/4MssP.jpg?s=128&g=1", "display_name": "davegson", "link": "https://stackoverflow.com/users/2235594/davegson"}, "edited": false, "score": 1, "creation_date": 1492624648, "post_id": 43498013, "comment_id": 74060162, "body": "Why the downvote?  My comment turned out to be the right answer so I posted it as an answer.  Please upvote.  If you are @luther, please upvote and mark as the answer."}, {"owner": {"reputation": 3515, "user_id": 3574628, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/W5BJ2.jpg?s=128&g=1", "display_name": "luther", "link": "https://stackoverflow.com/users/3574628/luther"}, "reply_to_user": {"reputation": 7389, "user_id": 2235594, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/4MssP.jpg?s=128&g=1", "display_name": "davegson", "link": "https://stackoverflow.com/users/2235594/davegson"}, "edited": false, "score": 1, "creation_date": 1492664579, "post_id": 43498013, "comment_id": 74075240, "body": "@TheCha\u0362mp: I have to agree with DavidGrayson. The filename thing is a very specific and undocumented requirement. It&#39;s not reasonable to expect people to guess the correct answer."}, {"owner": {"reputation": 7389, "user_id": 2235594, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/4MssP.jpg?s=128&g=1", "display_name": "davegson", "link": "https://stackoverflow.com/users/2235594/davegson"}, "edited": false, "score": 1, "creation_date": 1492672767, "post_id": 43498013, "comment_id": 74079271, "body": "I&#39;d suggest you rephrase the sentence to bring across assurance. You don&#39;t have to <i>think</i> it needs to end with <code>_test.rb</code>, you should <i>know</i> by now. Something like: &quot;Rename x to y, as it needs to end with z&quot;"}, {"owner": {"reputation": 3515, "user_id": 3574628, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/W5BJ2.jpg?s=128&g=1", "display_name": "luther", "link": "https://stackoverflow.com/users/3574628/luther"}, "edited": false, "score": 0, "creation_date": 1492714895, "post_id": 43498013, "comment_id": 74108717, "body": "Now I understand. I misunderstood your first comment to be sarcasm towards my OP. My bad."}], "tags": [], "owner": {"reputation": 70793, "user_id": 28128, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/4e974a514f0764fdfe99a8915f192002?s=128&d=identicon&r=PG", "display_name": "David Grayson", "link": "https://stackoverflow.com/users/28128/david-grayson"}, "is_accepted": true, "score": 0, "last_activity_date": 1493020169, "last_edit_date": 1493020169, "creation_date": 1492610600, "answer_id": 43498013, "question_id": 43486662, "link": "https://stackoverflow.com/questions/43486662/how-do-you-use-test-unit/43498013#43498013", "title": "How do you use test-unit?", "body": "<p>Rename <code>test/spec.rb</code> to <code>test/foo_test.rb</code>, as your test files need to end with <code>_test.rb</code>.</p>\n"}], "owner": {"reputation": 3515, "user_id": 3574628, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/W5BJ2.jpg?s=128&g=1", "display_name": "luther", "link": "https://stackoverflow.com/users/3574628/luther"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 40, "favorite_count": 0, "accepted_answer_id": 43498013, "answer_count": 1, "score": 0, "last_activity_date": 1493020169, "creation_date": 1492577480, "last_edit_date": 1492578199, "question_id": 43486662, "link": "https://stackoverflow.com/questions/43486662/how-do-you-use-test-unit", "title": "How do you use test-unit?", "body": "<p>My <code>test/run_test.rb</code> is exactly as the docs have it <a href=\"https://github.com/test-unit/test-unit/blob/master/doc/text/how-to.md\" rel=\"nofollow noreferrer\">here</a>. My <code>test/spec.rb</code> has simply <code>puts 'hello'</code>, yet running <code>ruby test/run_test.rb</code> outputs nothing at all.</p>\n\n<p>I can't find any other documentation on test-unit.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "csv", "geojson"], "answers": [{"tags": [], "owner": {"reputation": 2450, "user_id": 1114667, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/c855f4e65f04cfbbe403fdb18e32fdfd?s=128&d=identicon&r=PG", "display_name": "Ilya Lavrov", "link": "https://stackoverflow.com/users/1114667/ilya-lavrov"}, "is_accepted": false, "score": 0, "last_activity_date": 1492581474, "creation_date": 1492581474, "answer_id": 43487549, "question_id": 43486536, "link": "https://stackoverflow.com/questions/43486536/how-to-parse-geojson-with-ruby-and-save-coordinates-to-csv-file/43487549#43487549", "title": "How to parse GeoJSON with Ruby and save coordinates to .csv file?", "body": "<p>You may use <a href=\"https://github.com/rgeo/rgeo-geojson\" rel=\"nofollow noreferrer\"><code>rgeo-geojson</code> gem</a> to do it:</p>\n\n<pre><code>require 'rgeo/geo_json'\nrequire 'csv'\n\npoints = RGeo::GeoJSON.decode(json, json_parser: :json) # json must be a string here\n\nCSV.open(\"points.csv\", \"w\") do |csv|\n  csv &lt;&lt; [\"x\", \"y\"]\n  points.each do |point|\n    csv &lt;&lt; [point.geometry.x, point.geometry.y]\n  end\nend\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 11, "user_id": 7560529, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/400a12532bb878d264136f6343d85767?s=128&d=identicon&r=PG&f=1", "display_name": "Jason", "link": "https://stackoverflow.com/users/7560529/jason"}, "edited": false, "score": 0, "creation_date": 1492635488, "post_id": 43487734, "comment_id": 74066590, "body": "I solved my problem by using online tools that convert GeoJSON to CSV. But your approach will be very convenient  when I have many GeoJSON files. Thanks!"}], "tags": [], "owner": {"reputation": 5483, "user_id": 4481312, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/teLso.jpg?s=128&g=1", "display_name": "marmeladze", "link": "https://stackoverflow.com/users/4481312/marmeladze"}, "is_accepted": false, "score": 0, "last_activity_date": 1492582256, "creation_date": 1492582256, "answer_id": 43487734, "question_id": 43486536, "link": "https://stackoverflow.com/questions/43486536/how-to-parse-geojson-with-ruby-and-save-coordinates-to-csv-file/43487734#43487734", "title": "How to parse GeoJSON with Ruby and save coordinates to .csv file?", "body": "<p>If you just want storing lat and lng in csv file, </p>\n\n<pre><code>$ cat geo.json \n{  \"type\": \"FeatureCollection\",\n    \"features\": [\n{ \n  \"type\": \"Feature\",\n  \"id\": 1,\n  \"properties\": {\n    \"cluster\": {\n      \"x\": -0.229559,\n      \"y\": 0.270089\n    }\n  },\n  \"geometry\": {\n    \"type\": \"Point\",\n    \"coordinates\": [\n      -74.1518294,\n      40.5793043\n    ]\n  }\n},\n{\n  \"type\": \"Feature\",\n  \"id\": 2,\n  \"properties\": {\n    \"cluster\": {\n      \"x\": 0.00379515,\n      \"y\": 0.121912\n    }\n  },\n  \"geometry\": {\n    \"type\": \"Point\",\n    \"coordinates\": [\n      -74.0818064,\n      40.9278118\n    ]\n  }\n}  \n]\n  }\n</code></pre>\n\n<p>ruby script</p>\n\n<pre><code>require 'json'\nrequire 'csv'\n\nq = h['features'].map {|e| e['geometry']['coordinates'] }\n#=&gt; [[-74.1518294, 40.5793043], [-74.0818064, 40.9278118]]\nCSV.open('coords.csv', 'wb') {|csv| q.each {|e|csv &lt;&lt; e }}\n</code></pre>\n\n<p>contents of csv file.   </p>\n\n<pre><code>$ cat coords.csv \n-74.1518294,40.5793043\n-74.0818064,40.9278118\n</code></pre>\n\n<p>If you also want to store ids, change </p>\n\n<pre><code>q = h[\"features\"].map {|e| [e['id'], e['geometry']['coordinates']].flatten }\n</code></pre>\n\n<p>if you want to write headers, </p>\n\n<pre><code>CSV.open('coords.csv', \"wb\") do |csv|\n  csv &lt;&lt; ['ID', 'LAT', 'LNG']\n  q.each {|e|csv &lt;&lt; e }\nend\n</code></pre>\n\n<p>contents of coords</p>\n\n<pre><code>$ cat coords.csv \nID,LAT,LNG\n1,-74.1518294,40.5793043\n2,-74.0818064,40.9278118\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 7560529, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/400a12532bb878d264136f6343d85767?s=128&d=identicon&r=PG&f=1", "display_name": "Jason", "link": "https://stackoverflow.com/users/7560529/jason"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 981, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1492582256, "creation_date": 1492576854, "last_edit_date": 1492577357, "question_id": 43486536, "link": "https://stackoverflow.com/questions/43486536/how-to-parse-geojson-with-ruby-and-save-coordinates-to-csv-file", "title": "How to parse GeoJSON with Ruby and save coordinates to .csv file?", "body": "<p>I want to parse a GeoJSON file (Point type) and save the coordinates (lat/lng) to .CSV file. How to do this with Ruby? Following is a GeoJSON file. Thanks in advance!</p>\n\n<pre><code>{  \"type\": \"FeatureCollection\",  \n    \"features\": [\n{ \"type\": \"Feature\",\n  \"id\": 1,\n  \"properties\": {\n    \"cluster\": {\n      \"x\": -0.229559,\n      \"y\": 0.270089\n    }\n  },\n  \"geometry\": {\n    \"type\": \"Point\",\n    \"coordinates\": [\n      -74.1518294,\n      40.5793043\n    ]\n  }\n},\n{\n  \"type\": \"Feature\",\n  \"id\": 2,\n  \"properties\": {\n    \"cluster\": {\n      \"x\": 0.00379515,\n      \"y\": 0.121912\n    }\n  },\n  \"geometry\": {\n    \"type\": \"Point\",\n    \"coordinates\": [\n      -74.0818064,\n      40.9278118\n    ]\n  }\n}, ]}          \n</code></pre>\n"}, {"tags": ["ruby", "string"], "comments": [{"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1492580326, "post_id": 43486332, "comment_id": 74029578, "body": "What should be <code>string_3</code> be if <code>string_1 = &quot;abgdegdfg&quot;</code>?"}], "answers": [{"comments": [{"owner": {"reputation": 3914, "user_id": 4057366, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/uZ3e5.jpg?s=128&g=1", "display_name": "Alex Holubenko", "link": "https://stackoverflow.com/users/4057366/alex-holubenko"}, "edited": false, "score": 0, "creation_date": 1492590776, "post_id": 43486619, "comment_id": 74035708, "body": "You can use <code>#chars</code> instead <code>#split</code> =&gt; <code>&quot;abcdefg&quot;.chars =&gt; [&quot;a&quot;, &quot;b&quot;, &quot;c&quot;, &quot;d&quot;, &quot;e&quot;, &quot;f&quot;, &quot;g&quot;]</code>"}], "tags": [], "owner": {"reputation": 104, "user_id": 7884173, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kDyf2NzUs6Q/AAAAAAAAAAI/AAAAAAAAABA/XKDrrtxQp0Y/photo.jpg?sz=128", "display_name": "Tushar Kulkarni", "link": "https://stackoverflow.com/users/7884173/tushar-kulkarni"}, "is_accepted": false, "score": 0, "last_activity_date": 1492577262, "creation_date": 1492577262, "answer_id": 43486619, "question_id": 43486332, "link": "https://stackoverflow.com/questions/43486332/how-to-generate-string-3-from-the-difference-between-string-1-and-string-2/43486619#43486619", "title": "How to generate string_3 from the difference between string_1 and string_2?", "body": "<p>Please follow below steps:</p>\n\n<pre><code>string_1 = \"abcdefg\".split(\"\") =&gt; [\"a\", \"b\", \"c\", \"d\", \"e\", \"f\", \"g\"]\nstring_2 = \"adg\".split(\"\") =&gt; [\"a\", \"d\", \"g\"]\nstring_3 = string_1 - string_2 =&gt; [\"b\", \"c\", \"e\", \"f\"]\nstring_3 = string_3.join() =&gt; [\"bcef\"]\n</code></pre>\n\n<p>I think this is what you want.\nHope this helps.</p>\n"}, {"tags": [], "owner": {"reputation": 200, "user_id": 995573, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pNFb1.png?s=128&g=1", "display_name": "codesponge", "link": "https://stackoverflow.com/users/995573/codesponge"}, "is_accepted": false, "score": 0, "last_activity_date": 1492578228, "creation_date": 1492578228, "answer_id": 43486805, "question_id": 43486332, "link": "https://stackoverflow.com/questions/43486332/how-to-generate-string-3-from-the-difference-between-string-1-and-string-2/43486805#43486805", "title": "How to generate string_3 from the difference between string_1 and string_2?", "body": "<p>This will work for the data in your example but might be insufficient for more complicated data.</p>\n\n<pre><code>string_1 = \"abcdefg\"\nstring_2 = \"adg\"\n\n(string_1.chars - string_2.chars).join\n =&gt; \"bcef\"\n</code></pre>\n\n<p>on one line</p>\n\n<pre><code>(\"abcdefg\".chars - \"adg\".chars).join\n =&gt; \"bcef\"\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1492583256, "post_id": 43487034, "comment_id": 74030996, "body": "There are several weaknesses with this answer. 1) Why convert a string to an array, operate on it and then convert back to a string, when there are several more efficient ways to do this with <code>String</code> methods alone, such as <code>delete</code>, <code>tr</code> and <code>gsub</code>? 2) <code>Array#keep_if</code> (aka <code>select!</code>) mutates <code>string_1</code>, which is not part of the spec. 3) You can avoid the negation  in the block (and the mutation) by using <code>reject</code>. 4) traversing <code>string_2</code> for each character in <code>string_1</code> is very inefficient. 5) use <code>each_char</code> rather than <code>chars</code> to avoid the creation of a temporary array."}], "tags": [], "owner": {"reputation": 5483, "user_id": 4481312, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/teLso.jpg?s=128&g=1", "display_name": "marmeladze", "link": "https://stackoverflow.com/users/4481312/marmeladze"}, "is_accepted": false, "score": 0, "last_activity_date": 1492579516, "creation_date": 1492579516, "answer_id": 43487034, "question_id": 43486332, "link": "https://stackoverflow.com/questions/43486332/how-to-generate-string-3-from-the-difference-between-string-1-and-string-2/43487034#43487034", "title": "How to generate string_3 from the difference between string_1 and string_2?", "body": "<p>@codesponge have provided the cleanest answer, but let me post it for curiosity. </p>\n\n<pre><code>string_1.chars.keep_if {|e| !string_2.include? e }.join\n#=&gt; \"bcef\"\n</code></pre>\n\n<p><code>drop_while</code>, <code>take_while</code> and other similar methods also could be used. </p>\n"}, {"tags": [], "owner": {"reputation": 9602, "user_id": 3607136, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/NRFso.jpg?s=128&g=1", "display_name": "Gagan Gami", "link": "https://stackoverflow.com/users/3607136/gagan-gami"}, "is_accepted": false, "score": 3, "last_activity_date": 1492580358, "last_edit_date": 1492580358, "creation_date": 1492579663, "answer_id": 43487082, "question_id": 43486332, "link": "https://stackoverflow.com/questions/43486332/how-to-generate-string-3-from-the-difference-between-string-1-and-string-2/43487082#43487082", "title": "How to generate string_3 from the difference between string_1 and string_2?", "body": "<p>Try: <strong><a href=\"http://ruby-doc.org/core-2.4.1/String.html#method-i-tr\" rel=\"nofollow noreferrer\">String#tr</a></strong></p>\n\n<pre><code> &gt; string_3 = string_1.tr(string_2, '')\n #=&gt; \"bcef\" \n</code></pre>\n\n<p><strong>OR</strong></p>\n\n<p><strong><a href=\"http://ruby-doc.org/core-2.4.1/String.html#method-i-delete\" rel=\"nofollow noreferrer\">String#delete</a></strong></p>\n\n<pre><code> &gt; string_3 = string_1.delete(string_2)\n #=&gt; \"bcef\" \n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 1, "creation_date": 1492615763, "post_id": 43487360, "comment_id": 74054228, "body": "I just noticed that @Gagan edited his answer to include mine before I posted my answer. As he beat me by only 6 seconds, I&#39;ll leave my answer. :-)."}, {"owner": {"reputation": 9602, "user_id": 3607136, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/NRFso.jpg?s=128&g=1", "display_name": "Gagan Gami", "link": "https://stackoverflow.com/users/3607136/gagan-gami"}, "edited": false, "score": 0, "creation_date": 1492662745, "post_id": 43487360, "comment_id": 74074676, "body": "no worries, 6 sec doesn&#39;t matter right solution matter, even though I beat you with 6 sec still your answer accepted ;) :D 1+"}], "tags": [], "owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "is_accepted": true, "score": 1, "last_activity_date": 1492580754, "creation_date": 1492580754, "answer_id": 43487360, "question_id": 43486332, "link": "https://stackoverflow.com/questions/43486332/how-to-generate-string-3-from-the-difference-between-string-1-and-string-2/43487360#43487360", "title": "How to generate string_3 from the difference between string_1 and string_2?", "body": "<p><a href=\"http://ruby-doc.org/core-2.4.0/String.html#method-i-delete\" rel=\"nofollow noreferrer\">String#delete</a> is provided for precisely this purpose. I'm surprised it was suggested earlier. Perhaps some Rubiests think this method is for deleting substrings, which is not correct.</p>\n\n<pre><code>string_1 = \"abacdefg\"\nstring_2 = \"adg\"\n\nstring_1.delete(string_2)\n  #=&gt; \"bcef\"\n</code></pre>\n\n<p>Note that I added an <code>\"a\"</code> to <code>string_1</code> to show that both <code>\"a\"</code>'s are deleted.</p>\n"}], "owner": {"reputation": 23, "user_id": 7715482, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a0fcabb1e3b54d76def90fd257d2242e?s=128&d=identicon&r=PG&f=1", "display_name": "Fabio", "link": "https://stackoverflow.com/users/7715482/fabio"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 56, "favorite_count": 1, "accepted_answer_id": 43487360, "answer_count": 5, "score": 0, "last_activity_date": 1492580754, "creation_date": 1492575781, "last_edit_date": 1492579656, "question_id": 43486332, "link": "https://stackoverflow.com/questions/43486332/how-to-generate-string-3-from-the-difference-between-string-1-and-string-2", "title": "How to generate string_3 from the difference between string_1 and string_2?", "body": "<p>I have 2 strings:</p>\n\n<pre><code>string_1 = \"abcdefg\"\n\nstring_2 = \"adg\"\n</code></pre>\n\n<p>How to generate <code>string_3</code> from the difference between <code>string_1</code> and <code>string_2</code>?</p>\n\n<pre><code>string_3 = \"bcef\"\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 5074, "user_id": 4207394, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/mmfTf.png?s=128&g=1", "display_name": "Deep", "link": "https://stackoverflow.com/users/4207394/deep"}, "edited": false, "score": 0, "creation_date": 1492573261, "post_id": 43485895, "comment_id": 74027188, "body": "In your set_project method the params[:id] should be params[:project_id] I guess"}, {"owner": {"reputation": 119, "user_id": 7738138, "user_type": "registered", "accept_rate": 55, "profile_image": "https://graph.facebook.com/1728017913892004/picture?type=large", "display_name": "JiaPing", "link": "https://stackoverflow.com/users/7738138/jiaping"}, "reply_to_user": {"reputation": 5074, "user_id": 4207394, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/mmfTf.png?s=128&g=1", "display_name": "Deep", "link": "https://stackoverflow.com/users/4207394/deep"}, "edited": false, "score": 0, "creation_date": 1492574362, "post_id": 43485895, "comment_id": 74027487, "body": "Thank you!  I solved it now"}], "answers": [{"comments": [{"owner": {"reputation": 119, "user_id": 7738138, "user_type": "registered", "accept_rate": 55, "profile_image": "https://graph.facebook.com/1728017913892004/picture?type=large", "display_name": "JiaPing", "link": "https://stackoverflow.com/users/7738138/jiaping"}, "edited": false, "score": 0, "creation_date": 1492577350, "post_id": 43486115, "comment_id": 74028441, "body": "I changed params[:id]  into params[:project_id] and the error was solved. Thank you for helping me!"}], "tags": [], "owner": {"reputation": 99, "user_id": 1776169, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XJB9n.jpg?s=128&g=1", "display_name": "yatindra rao", "link": "https://stackoverflow.com/users/1776169/yatindra-rao"}, "is_accepted": false, "score": 0, "last_activity_date": 1492574408, "creation_date": 1492574408, "answer_id": 43486115, "question_id": 43485895, "link": "https://stackoverflow.com/questions/43485895/ruby-couldnt-find-project-with-id/43486115#43486115", "title": "ruby- Couldn&#39;t find Project with &#39;id&#39;=", "body": "<p>This error say that Rails is not able to find any <strong>Project</strong> record with this id.</p>\n\n<p>Is there any Project record in a database? </p>\n\n<p>Please post stack trace.</p>\n"}, {"tags": [], "owner": {"reputation": 4527, "user_id": 5497690, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/577c8ad14fffb59cd619e43634c51dad?s=128&d=identicon&r=PG&f=1", "display_name": "puneet18", "link": "https://stackoverflow.com/users/5497690/puneet18"}, "is_accepted": false, "score": 0, "last_activity_date": 1492579058, "creation_date": 1492579058, "answer_id": 43486943, "question_id": 43485895, "link": "https://stackoverflow.com/questions/43485895/ruby-couldnt-find-project-with-id/43486943#43486943", "title": "ruby- Couldn&#39;t find Project with &#39;id&#39;=", "body": "<p>change your set_project function with below code:</p>\n\n<pre><code>private \ndef set_project \n  @project = Project.find(params[:project_id]) \nend\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 5074, "user_id": 4207394, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/mmfTf.png?s=128&g=1", "display_name": "Deep", "link": "https://stackoverflow.com/users/4207394/deep"}, "is_accepted": true, "score": 0, "last_activity_date": 1492661755, "creation_date": 1492661755, "answer_id": 43510108, "question_id": 43485895, "link": "https://stackoverflow.com/questions/43485895/ruby-couldnt-find-project-with-id/43510108#43510108", "title": "ruby- Couldn&#39;t find Project with &#39;id&#39;=", "body": "<p>As you are inside the <code>ProjectCommentsController</code> the <code>params[:id]</code> will give you the <code>id</code> of <code>ProjectComment</code> and not of <code>Project</code>. So in your method:</p>\n\n<pre><code>def set_project\n    @project = Project.find(params[:id])\nend\n</code></pre>\n\n<p>Change the <code>params[:id]</code> to <code>params[:project_id]</code> which will solve your issue.</p>\n"}], "owner": {"reputation": 119, "user_id": 7738138, "user_type": "registered", "accept_rate": 55, "profile_image": "https://graph.facebook.com/1728017913892004/picture?type=large", "display_name": "JiaPing", "link": "https://stackoverflow.com/users/7738138/jiaping"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 807, "favorite_count": 0, "accepted_answer_id": 43510108, "answer_count": 3, "score": 0, "last_activity_date": 1492661755, "creation_date": 1492573023, "last_edit_date": 1492661629, "question_id": 43485895, "link": "https://stackoverflow.com/questions/43485895/ruby-couldnt-find-project-with-id", "title": "ruby- Couldn&#39;t find Project with &#39;id&#39;=", "body": "<p>I got this Nested Resources Error like below:</p>\n\n<p>ActiveRecord::RecordNotFound at /admin/projects/2/project_comments</p>\n\n<p>Couldn't find Project with 'id'=</p>\n\n<p>routes.rb</p>\n\n<pre><code>namespace :admin do\nresources :users\nresources :projects do\n  resources :project_users\n  resources :project_comments\nend\nend\n</code></pre>\n\n<p>project.rb</p>\n\n<pre><code>has_many :project_comments\n</code></pre>\n\n<p>project_comment.rn</p>\n\n<pre><code>belongs_to :project\n</code></pre>\n\n<p>project_comments_co</p>\n\n<pre><code>class Admin::ProjectCommentsController &lt; ApplicationController\nbefore_action :set_project_comment, only: [:show, :edit, :update, :destroy]  \nbefore_action :set_project\n\n\ndef your_action\n    # these are for debugging\n    puts params.inspect\n    puts params[:option_id]\n    @event = Event.find(params[:event_id])\n    @option = Option.find(params[:option_id])\nend\n\ndef index\n    @project_comments = @project.project_comments.all\nend\n\ndef new\n    @project_comment = @project.project_comments.new\nend\n\ndef create\n    @project_comment = @project.project_comments.new(project_comment_params)\n\n    if @project_comment.save\n    else\n    end\nend\n\ndef show\nend\n\ndef edit\nend\n\ndef update\n    if  @project_comment.update(project_comment_params)\n    else\n    end\nend\n\ndef destroy\n    @project_comment.destroy\nend\n\nprivate\ndef set_project\n    @project = Project.find(params[:id])\nend\n\n\ndef set_project_comment\n    @set_project_comment = ProjectComment.find(params[:id])\nend\n\n\ndef project_comment_params\n    params.require(:project_comment).permit(:project_id, :user_id, :comment)    \nend\n</code></pre>\n\n<p>end</p>\n\n<p>Thank you for helping me!</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-3"], "comments": [{"owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 0, "creation_date": 1492567431, "post_id": 43485021, "comment_id": 74025662, "body": "how is <code>product</code> defined? It appears to be <code>nil</code>."}, {"owner": {"reputation": 21, "user_id": 7823659, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/8ba8fc72506870c8f2c045263f4d148e?s=128&d=identicon&r=PG&f=1", "display_name": "bookaka", "link": "https://stackoverflow.com/users/7823659/bookaka"}, "reply_to_user": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 0, "creation_date": 1492567742, "post_id": 43485021, "comment_id": 74025764, "body": "max without the user conditional works"}, {"owner": {"reputation": 21, "user_id": 7823659, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/8ba8fc72506870c8f2c045263f4d148e?s=128&d=identicon&r=PG&f=1", "display_name": "bookaka", "link": "https://stackoverflow.com/users/7823659/bookaka"}, "reply_to_user": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 0, "creation_date": 1492567775, "post_id": 43485021, "comment_id": 74025775, "body": "but the feedback has one product"}, {"owner": {"reputation": 21, "user_id": 7823659, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/8ba8fc72506870c8f2c045263f4d148e?s=128&d=identicon&r=PG&f=1", "display_name": "bookaka", "link": "https://stackoverflow.com/users/7823659/bookaka"}, "reply_to_user": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 0, "creation_date": 1492567782, "post_id": 43485021, "comment_id": 74025778, "body": "has_one :product, through: :order"}, {"owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 0, "creation_date": 1492567783, "post_id": 43485021, "comment_id": 74025780, "body": "you mean you remove all calls to <code>product</code>? or just remove the <code>if</code>/<code>end</code> lines?"}, {"owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 0, "creation_date": 1492567809, "post_id": 43485021, "comment_id": 74025787, "body": "oh i get it now. it&#39;s defined elsewhere on the model"}, {"owner": {"reputation": 21, "user_id": 7823659, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/8ba8fc72506870c8f2c045263f4d148e?s=128&d=identicon&r=PG&f=1", "display_name": "bookaka", "link": "https://stackoverflow.com/users/7823659/bookaka"}, "reply_to_user": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 0, "creation_date": 1492567893, "post_id": 43485021, "comment_id": 74025809, "body": "if i remove   if user and end lines"}], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 7823659, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/8ba8fc72506870c8f2c045263f4d148e?s=128&d=identicon&r=PG&f=1", "display_name": "bookaka", "link": "https://stackoverflow.com/users/7823659/bookaka"}, "edited": false, "score": 0, "creation_date": 1492568084, "post_id": 43485117, "comment_id": 74025865, "body": "Samir thank you the code is inside the feedback model well i did not  instantiating i just grab and put there. the feedback/order related product"}, {"owner": {"reputation": 149, "user_id": 5741371, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh5.googleusercontent.com/-JV7UwoV1eKU/AAAAAAAAAAI/AAAAAAAAAK4/Is3T8ArskQU/photo.jpg?sz=128", "display_name": "Samir Haddad", "link": "https://stackoverflow.com/users/5741371/samir-haddad"}, "reply_to_user": {"reputation": 21, "user_id": 7823659, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/8ba8fc72506870c8f2c045263f4d148e?s=128&d=identicon&r=PG&f=1", "display_name": "bookaka", "link": "https://stackoverflow.com/users/7823659/bookaka"}, "edited": false, "score": 0, "creation_date": 1492569781, "post_id": 43485117, "comment_id": 74026297, "body": "Besides my approach, @maxple gave you a fine set of options to solve your problem. It really depends on how you want you application to behave. If you just want to avoid this error, you either use my approach or his maxple 3rd approach."}], "tags": [], "owner": {"reputation": 149, "user_id": 5741371, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh5.googleusercontent.com/-JV7UwoV1eKU/AAAAAAAAAAI/AAAAAAAAAK4/Is3T8ArskQU/photo.jpg?sz=128", "display_name": "Samir Haddad", "link": "https://stackoverflow.com/users/5741371/samir-haddad"}, "is_accepted": false, "score": 0, "last_activity_date": 1492567859, "creation_date": 1492567859, "answer_id": 43485117, "question_id": 43485021, "link": "https://stackoverflow.com/questions/43485021/rails-how-make-a-conditional-inside-a-method-on-the-model/43485117#43485117", "title": "Rails How make a conditional inside a method on the model", "body": "<p>Your question is not totally clear. You didn't mention in which model this code is inside and your condition seems okay. </p>\n\n<p>It seems <code>product</code> is nil, so maybe you are missing something that was not mentioned in the question, like instantiating that product. Or maybe you want your condition to be:</p>\n\n<pre><code>if user &amp;&amp; product\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 21, "user_id": 7823659, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/8ba8fc72506870c8f2c045263f4d148e?s=128&d=identicon&r=PG&f=1", "display_name": "bookaka", "link": "https://stackoverflow.com/users/7823659/bookaka"}, "edited": false, "score": 0, "creation_date": 1492568555, "post_id": 43485155, "comment_id": 74026000, "body": "thank you. for the explanation. i&#39;ll try to use your method. grabbing a already product related to the model.  the product exists but but is related with the associated model"}], "tags": [], "owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "is_accepted": false, "score": 0, "last_activity_date": 1492568172, "creation_date": 1492568172, "answer_id": 43485155, "question_id": 43485021, "link": "https://stackoverflow.com/questions/43485021/rails-how-make-a-conditional-inside-a-method-on-the-model/43485155#43485155", "title": "Rails How make a conditional inside a method on the model", "body": "<p>The problem is that this method assumes there is an existing product for the model in question. However if no record has been created at, then product will be nil.</p>\n\n<p>This can be addressed in a few ways, which you use depends on your use-case.</p>\n\n<ol>\n<li><p>making sure that this model creates a product upon save, e.g. through <code>before_save</code>:</p>\n\n<pre><code>before_save :ensure_product_exists\ndef ensure_product_exists\n  product ||= Product.create(foo_id: self.id) # replace with correct foreign key\nend\n</code></pre></li>\n<li><p>making this method create the product if it does not yet exist, e.g.</p>\n\n<pre><code>product ||= Product.new(foo_id: self.id) # replace with correct foreign key\n</code></pre></li>\n<li><p>making the method return early if the product does not exist, e.g.</p>\n\n<pre><code>return unless product\n</code></pre></li>\n<li><p>raising an error unless the product exists</p>\n\n<pre><code>raise(RuntimeError, \"product doesn't exist\") unless product\n</code></pre></li>\n</ol>\n"}], "owner": {"reputation": 21, "user_id": 7823659, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/8ba8fc72506870c8f2c045263f4d148e?s=128&d=identicon&r=PG&f=1", "display_name": "bookaka", "link": "https://stackoverflow.com/users/7823659/bookaka"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 182, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1492592722, "creation_date": 1492567167, "last_edit_date": 1492592722, "question_id": 43485021, "link": "https://stackoverflow.com/questions/43485021/rails-how-make-a-conditional-inside-a-method-on-the-model", "title": "Rails How make a conditional inside a method on the model", "body": "<p>I'm trying to make that just the user can feedback on a feedback method in the feedback model. but in the logs shows</p>\n\n<blockquote>\n  <p>NoMethodError (undefined method `total_feedbacks' for nil:NilClass)</p>\n</blockquote>\n\n<p>so show to make a conditional in the model?</p>\n\n<pre><code>def feedback_product\n  user = User.find_by_id(attributes['user_id'])\n\n  if user\n    product.total_feedbacks += 1\n    product.average_rating = product.feedbacks.where('buyer_feedback_date IS NOT NULL').rated(Feedback::FROM_BUYERS).average(:buyer_rating)\n    product.save\n  end\nend\n</code></pre>\n\n<p>the feedback<br>\n<code>belongs_to :user</code><br>\nand user<br>\n<code>has_many :feedbacks</code></p>\n"}, {"tags": ["ruby-on-rails", "ruby", "undefined", "rails-activerecord"], "comments": [{"owner": {"reputation": 2186, "user_id": 4005809, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/oLzhL.jpg?s=128&g=1", "display_name": "Steve Carey", "link": "https://stackoverflow.com/users/4005809/steve-carey"}, "edited": false, "score": 0, "creation_date": 1492563175, "post_id": 43484378, "comment_id": 74024671, "body": "Try adding if attend person at the end of each erb statement. So the first one would be &lt;%= attend.person.name + &#39; &#39; + attend.person.last_name if attend.person.present? %&gt;"}, {"owner": {"reputation": 2186, "user_id": 4005809, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/oLzhL.jpg?s=128&g=1", "display_name": "Steve Carey", "link": "https://stackoverflow.com/users/4005809/steve-carey"}, "edited": false, "score": 0, "creation_date": 1492563245, "post_id": 43484378, "comment_id": 74024688, "body": "Rails will throw an error on an associated attribute like attend.person.name if it is blank otherwise."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1492563924, "post_id": 43484378, "comment_id": 74024819, "body": "Please post code, errors or textual output here as plain-text, not as images that can be hard to read, can\u2019t be copy-pasted to help test code or use in answers, and are hostile to those who use screen readers. You can edit your question to add the code in the body of your question. Use the <code>{}</code> button to format any blocks of code, or indent with four spaces for the same effect."}, {"owner": {"reputation": 164, "user_id": 4412754, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UH0hnBWkUrM/AAAAAAAAAAI/AAAAAAAAAA0/m_3j_-s4Tlc/photo.jpg?sz=128", "display_name": "cabolanoz", "link": "https://stackoverflow.com/users/4412754/cabolanoz"}, "edited": false, "score": 1, "creation_date": 1492565665, "post_id": 43484378, "comment_id": 74025264, "body": "Even though you can hide the error message by validating the presence of one value of the person (attendee) as the answers shown below with try method, the correct answer for this is that your validations in the models are not working correctly. Since your errors say that the person object is nil from an specific event, you should validate in your Attend model the existance of people for an event and the error will go away since you&#180;re always have people for events. Could be something with validate_presence_of person."}], "answers": [{"comments": [{"owner": {"reputation": 49, "user_id": 4351403, "user_type": "registered", "profile_image": "https://graph.facebook.com/701200402/picture?type=large", "display_name": "Jose Rafael", "link": "https://stackoverflow.com/users/4351403/jose-rafael"}, "edited": false, "score": 1, "creation_date": 1492608566, "post_id": 43484762, "comment_id": 74048537, "body": "Thank you so much"}], "tags": [], "owner": {"reputation": 191, "user_id": 1381261, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dRFzB.jpg?s=128&g=1", "display_name": "umang", "link": "https://stackoverflow.com/users/1381261/umang"}, "is_accepted": false, "score": 1, "last_activity_date": 1492565293, "creation_date": 1492565293, "answer_id": 43484762, "question_id": 43484378, "link": "https://stackoverflow.com/questions/43484378/rails-undefined-method-name-for-nilnilclass-and-i-dont-get-why/43484762#43484762", "title": "Rails undefined method `name&#39; for nil:NilClass and I don&#39;t get why", "body": "<p>Rails has a built-in helper to handle <code>nil</code> values elegantly:</p>\n\n<p><code>&lt;%= @attend.person.try(:name) + ' ' + attend.person.try(:last_name) %&gt;</code></p>\n\n<p>If <code>person</code> is <code>nil</code>, it will return <code>nil</code> instead of raising a <code>NoMethodError</code> exception.</p>\n\n<p>Also, you can concatenate these strings in a more elegant way by taking advantage of string interpolation in Ruby. When you use double quotes, anything in the string wrapped inside <code>#{}</code> gets evaluated as Ruby code.</p>\n\n<p><code>&lt;%= \"#{@attend.person.try(:name)} #{attend.person.try(:last_name)}\" %&gt;</code></p>\n"}], "owner": {"reputation": 49, "user_id": 4351403, "user_type": "registered", "profile_image": "https://graph.facebook.com/701200402/picture?type=large", "display_name": "Jose Rafael", "link": "https://stackoverflow.com/users/4351403/jose-rafael"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 216, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1492565293, "creation_date": 1492562483, "question_id": 43484378, "link": "https://stackoverflow.com/questions/43484378/rails-undefined-method-name-for-nilnilclass-and-i-dont-get-why", "title": "Rails undefined method `name&#39; for nil:NilClass and I don&#39;t get why", "body": "<p>Hi guys I am developing a system I created on RoR</p>\n\n<p>My idea is that a person can attend to serveral events, So I have 3 tables:\nPerson, event, and attend</p>\n\n<p>Attend contains person_id event_id I would say that it is a kind of associative table\n<a href=\"https://i.stack.imgur.com/Ap6LC.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Ap6LC.png\" alt=\"Person model\"></a></p>\n\n<p><a href=\"https://i.stack.imgur.com/sPFFT.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/sPFFT.png\" alt=\"enter image description here\"></a></p>\n\n<p><a href=\"https://i.stack.imgur.com/e2lCD.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/e2lCD.png\" alt=\"enter image description here\"></a></p>\n\n<p>I want to show the attendants of a specific event so I in the show action of my controller I  have <a href=\"https://i.stack.imgur.com/hZdpe.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/hZdpe.png\" alt=\"enter image description here\"></a> </p>\n\n<p>And in my view</p>\n\n<h2><a href=\"https://i.stack.imgur.com/kEI7N.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/kEI7N.png\" alt=\"enter image description here\"></a></h2>\n\n<p>I get the right info in most of the events\n<a href=\"https://i.stack.imgur.com/BmApL.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/BmApL.png\" alt=\"enter image description here\"></a></p>\n\n<p>But only in a few this is happening to me \n<a href=\"https://i.stack.imgur.com/8UtLS.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/8UtLS.png\" alt=\"enter image description here\"></a></p>\n\n<p>and I HAVE NO IDEA WHAT TO DO.</p>\n\n<p>Thanks in advance for your attention and help</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 4, "creation_date": 1492561980, "post_id": 43484293, "comment_id": 74024382, "body": "What&#39;s the way you tried in Ruby? Even half-broken, totally hopeless code is a sign you&#39;ve invested effort in your solution, and it motivates people to help."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1492586063, "post_id": 43484293, "comment_id": 74032730, "body": "A simple example that includes your desired result would be helpful."}, {"owner": {"reputation": 2553, "user_id": 1706831, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/34b7c15de97dd917f6159feb72a3a5a8?s=128&d=identicon&r=PG", "display_name": "Kori John Roys", "link": "https://stackoverflow.com/users/1706831/kori-john-roys"}, "reply_to_user": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1492588384, "post_id": 43484293, "comment_id": 74034199, "body": "@CarySwoveland I included sample tests with input and desired output."}], "answers": [{"comments": [{"owner": {"reputation": 2553, "user_id": 1706831, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/34b7c15de97dd917f6159feb72a3a5a8?s=128&d=identicon&r=PG", "display_name": "Kori John Roys", "link": "https://stackoverflow.com/users/1706831/kori-john-roys"}, "edited": false, "score": 0, "creation_date": 1492588941, "post_id": 43484629, "comment_id": 74034513, "body": "Thanks! I had read through enumerable and I guess I skipped over <code>cycle</code>, or failed to understand exactly what it did. That&#39;s a nice way to do it."}, {"owner": {"reputation": 2553, "user_id": 1706831, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/34b7c15de97dd917f6159feb72a3a5a8?s=128&d=identicon&r=PG", "display_name": "Kori John Roys", "link": "https://stackoverflow.com/users/1706831/kori-john-roys"}, "edited": false, "score": 0, "creation_date": 1492590073, "post_id": 43484629, "comment_id": 74035240, "body": "What I finally came up with was pretty similar to what you have here, with the collection tracking logic pulled out into a class."}], "tags": [], "owner": {"reputation": 6559, "user_id": 382520, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/05f73868bd13eba39cab490c897f1333?s=128&d=identicon&r=PG", "display_name": "JCorcuera", "link": "https://stackoverflow.com/users/382520/jcorcuera"}, "is_accepted": false, "score": 1, "last_activity_date": 1492564384, "creation_date": 1492564384, "answer_id": 43484629, "question_id": 43484293, "link": "https://stackoverflow.com/questions/43484293/how-to-combine-two-ruby-collections/43484629#43484629", "title": "How to combine two Ruby collections?", "body": "<p>Here is something, the idea is to iterate every array until both of them reach their max index:</p>\n\n<pre><code>def custom_combine(a,b,x)\n  max_index_a = a.count - 1\n  max_index_b = b.count - 1\n  a_run_out = false\n  b_run_out = false\n\n  output = []\n\n  a.cycle.each_with_index do |elem_a, index_a|\n    output &lt;&lt; elem_a\n    # base on a index get x elements from b\n    x.times do |i|\n      index_b = ((index_a * x) + i) % (max_index_b + 1)\n      output &lt;&lt; b[index_b]\n      b_run_out = true if index_b == max_index_b\n    end\n    a_run_out = true if index_a == max_index_a\n    break if a_run_out &amp;&amp; b_run_out\n  end\n\n  output\nend\n\na = %w(a1 a2 a3 a4)\nb = %w(b1 b2 b3 b4 b5)\nx = 3\n\ncustom_combine(a,b,x)\n# =&gt; [\"a1\", \"b1\", \"b2\", \"b3\", \"a2\", \"b4\", \"b5\", \"b1\", \"a3\", \"b2\", \"b3\", \"b4\", \"a4\", \"b5\", \"b1\", \"b2\"] \n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 67463, "user_id": 203130, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/1RE8c.jpg?s=128&g=1", "display_name": "coreyward", "link": "https://stackoverflow.com/users/203130/coreyward"}, "is_accepted": false, "score": 1, "last_activity_date": 1492570442, "creation_date": 1492570442, "answer_id": 43485512, "question_id": 43484293, "link": "https://stackoverflow.com/questions/43484293/how-to-combine-two-ruby-collections/43485512#43485512", "title": "How to combine two Ruby collections?", "body": "<p><code>Enumerable</code> has an <code>each_slice</code> method that'll let you iterate over an enumerable object N items at a time. Using it, you can do something like this:</p>\n\n<pre><code>a1 = [1, 2, 3, 4, 5, 6] \na2 = [10, 11, 12, 20, 21, 22, 30, 31, 32, 40, 41, 42, 50, 51, 52, 60] \n\na1.each_slice(1).zip(a2.each_slice(3)).flatten\n\n# =&gt; [1, 10, 11, 12, 2, 20, 21, 22, 3, 30, 31, 32, 4, 40, 41, 42, 5, 50, 51, 52, 6, 60] \n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2553, "user_id": 1706831, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/34b7c15de97dd917f6159feb72a3a5a8?s=128&d=identicon&r=PG", "display_name": "Kori John Roys", "link": "https://stackoverflow.com/users/1706831/kori-john-roys"}, "is_accepted": false, "score": 0, "last_activity_date": 1492590020, "creation_date": 1492590020, "answer_id": 43490221, "question_id": 43484293, "link": "https://stackoverflow.com/questions/43484293/how-to-combine-two-ruby-collections/43490221#43490221", "title": "How to combine two Ruby collections?", "body": "<p>Here's what finally jumped out of my brain at 4.30am:</p>\n\n<pre><code>class InfiniteArray\n  private\n  attr_reader :collection\n  attr_accessor :index, :wrapped_count\n  public\n\n  def initialize(collection)\n    @collection = collection\n    reset\n  end\n\n  def next\n    value = collection[index]\n    if index &lt; collection.length - 1\n      self.index = index + 1\n    else\n      self.index = 0\n      self.wrapped_count = wrapped_count + 1\n    end\n    value\n  end\n\n  def wrapped?\n    wrapped_count &gt; 0\n  end\n\n  def reset\n    @index = 0\n    @wrapped_count = 0\n  end\nend\n\nclass IntervalCopier\n  private\n  attr_reader :source_collection, :destination_collection, :interval\n  public\n\n  def initialize(source_collection, destination_collection, interval)\n    @source_collection = InfiniteArray.new(source_collection)\n    @destination_collection = InfiniteArray.new(destination_collection)\n    @interval = interval\n  end\n\n  def copy\n    final = []\n    until source_collection.wrapped? &amp;&amp; destination_collection.wrapped? do\n      final &lt;&lt; source_collection.next\n      interval.times { final &lt;&lt; destination_collection.next }\n    end\n    [source_collection, destination_collection].each(&amp;:reset)\n    final\n  end\nend\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1070, "user_id": 1133429, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ds55r.png?s=128&g=1", "display_name": "Eric Mathison", "link": "https://stackoverflow.com/users/1133429/eric-mathison"}, "is_accepted": false, "score": 0, "last_activity_date": 1492742831, "last_edit_date": 1492742831, "creation_date": 1492740490, "answer_id": 43532775, "question_id": 43484293, "link": "https://stackoverflow.com/questions/43484293/how-to-combine-two-ruby-collections/43532775#43532775", "title": "How to combine two Ruby collections?", "body": "<pre><code>def copy(array1, array2, slice_length)\n  iterations = [array1.length,\n                (array2.length.to_f / slice_length.to_f).round\n               ].max\n\n  result = []\n  enum1 = array1.cycle\n  enum2 = array2.cycle\n\n  iterations.times do\n    result &lt;&lt; enum1.next\n    slice_length.times { result &lt;&lt; enum2.next }\n  end\n\n  result\nend\n\nrequire 'minitest/autorun'\n\nclass TestCopy &lt; Minitest::Test\n  def test_copy\n    assert_equal(%w(a1 b1 a2 b2 a3 b3),                               copy(%w(a1 a2 a3),    %w(b1 b2 b3),       1))\n    assert_equal(%w(a1 b1),                                           copy(%w(a1),          %w(b1),             1))\n    assert_equal(%w(a1 b1 a1 b2 a1 b3),                               copy(%w(a1),          %w(b1 b2 b3),       1))\n    assert_equal(%w(a1 b1 b2 a2 b3 b4 a1 b5 b1),                      copy(%w(a1 a2),       %w(b1 b2 b3 b4 b5), 2))\n    assert_equal(%w(a1 b1 b2 a2 b3 b4 a1 b5 b1),                      copy(%w(a1 a2),       %w(b1 b2 b3 b4 b5), 2))\n    assert_equal(%w(a1 b1 b2 b3 a2 b4 b5 b1 a3 b2 b3 b4 a4 b5 b1 b2), copy(%w(a1 a2 a3 a4), %w(b1 b2 b3 b4 b5), 3))\n  end\nend\n</code></pre>\n"}], "owner": {"reputation": 2553, "user_id": 1706831, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/34b7c15de97dd917f6159feb72a3a5a8?s=128&d=identicon&r=PG", "display_name": "Kori John Roys", "link": "https://stackoverflow.com/users/1706831/kori-john-roys"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 74, "favorite_count": 0, "answer_count": 4, "score": 0, "last_activity_date": 1492742831, "creation_date": 1492561696, "question_id": 43484293, "link": "https://stackoverflow.com/questions/43484293/how-to-combine-two-ruby-collections", "title": "How to combine two Ruby collections?", "body": "<p>A user is given two inputs, <code>A</code> and <code>B</code> (collections), and a number, <code>X</code>, and must create an output. The output starts with the first value from <code>A</code>, then takes <code>X</code> units from <code>B</code>, then the second value of <code>A</code>, and continuing like that until both <code>A</code> and <code>B</code> have been exhausted. You can assume <code>1 &lt; X &lt; sizeof(B)</code>. However, if either <code>A</code> or <code>B</code> runs out, you should loop back to the beginning of the short collection, and continue until the other runs out. The looping back should continue until both collections have hit their end.</p>\n\n<p>What is an <em>elegant</em> way to do this in Ruby? I have some half-broken code and can't seem to find a good way to do this. No, it's not a homework problem. I have strange hobbies.</p>\n\n<p>Here's some sample tests of the behavior I want:</p>\n\n<pre><code># SomeModule.copy(A, B, X)\nSomeModule.copy(%w(a1 a2 a3),    %w(b1 b2 b3),       1) == %w(a1 b1 a2 b2 a3 b3))\nSomeModule.copy(%w(a1),          %w(b1),             1) == %w(a1 b1))\nSomeModule.copy(%w(a1),          %w(b1 b2 b3),       1) == %w(a1 b1 a1 b2 a1 b3))\nSomeModule.copy(%w(a1 a2),       %w(b1 b2 b3 b4 b5), 2) == %w(a1 b1 b2 a2 b3 b4 a1 b5 b1))\nSomeModule.copy(%w(a1 a2),       %w(b1 b2 b3 b4 b5), 2) == %w(a1 b1 b2 a2 b3 b4 a1 b5 b1))\nSomeModule.copy(%w(a1 a2 a3 a4), %w(b1 b2 b3 b4 b5), 3) == %w(a1 b1 b2 b3 a2 b4 b5 b1 a3 b2 b3 b4 a4 b5 b1 b2))\n</code></pre>\n"}, {"tags": ["arrays", "ruby", "activerecord", "sinatra"], "answers": [{"tags": [], "owner": {"reputation": 27144, "user_id": 3857758, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/58c4295826435f049b7fc32b98c240f9?s=128&d=identicon&r=PG&f=1", "display_name": "Ursus", "link": "https://stackoverflow.com/users/3857758/ursus"}, "is_accepted": true, "score": 2, "last_activity_date": 1492588090, "last_edit_date": 1492588090, "creation_date": 1492560144, "answer_id": 43484111, "question_id": 43483737, "link": "https://stackoverflow.com/questions/43483737/how-to-add-data-to-returned-activerecord-query-records/43484111#43484111", "title": "How to add data to returned ActiveRecord query records", "body": "<p>Try this one. <code>map</code> method to transform your result, <code>attributes</code> method to have an hash with fields and values and <code>merge</code> method to add the task.</p>\n\n<pre><code>get \"/:task/:account_id/contacts\" do\n  @contacts = Contact.where(\"Account = ?\", params[:account_id]).map do |c|\n    c.attributes.merge(\"Task\": params[:task])\n  end\n\n  @contacts.to_json\nend\n</code></pre>\n"}], "owner": {"reputation": 551, "user_id": 1993178, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/FvkIh.png?s=128&g=1", "display_name": "csakon", "link": "https://stackoverflow.com/users/1993178/csakon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 28, "favorite_count": 0, "accepted_answer_id": 43484111, "answer_count": 1, "score": 0, "last_activity_date": 1492601062, "creation_date": 1492557441, "last_edit_date": 1492601062, "question_id": 43483737, "link": "https://stackoverflow.com/questions/43483737/how-to-add-data-to-returned-activerecord-query-records", "title": "How to add data to returned ActiveRecord query records", "body": "<p>I'm doing a simple query to a database table to send off to an external service, but I need to add an element to each of the returned records before I do so.</p>\n\n<p><strong>app.rb</strong></p>\n\n<pre><code>get \"/:task/:account_id/contacts\" do\n  @contacts = Contact.where(\"Account = ?\", params[:account_id])\n\n  @contacts.to_json\nend\n</code></pre>\n\n<p>Provides me the data I need formatted as</p>\n\n<pre><code>[{\"Name\":\"Charlie Spencer\",\"sfid\":\"a014100000AYi2ZABG\",\"id\":29,\"Account\":\"a054100000FsEA8AAN\"},{\"Name\":\"Philip Leak\",\"sfid\":\"a014100000AYi3PCHZ\",\"id\":48,\"Account\":\"a054100000FsEA8AAN\"}]\n</code></pre>\n\n<p>But I need to add the provided task within the route to the results before sending it off via json as such:</p>\n\n<pre><code>[{\"Name\":\"Charlie Spencer\",\"sfid\":\"a014100000AYi2ZABG\",\"id\":29,\"Account\":\"a054100000FsEA8AAN\",\"Task\":\"a014100000AYiWMCC1\"},{\"Name\":\"Philip Leak\",\"sfid\":\"a014100000AYi3PCHZ\",\"id\":48,\"Account\":\"a054100000FsEA8AAN\",\"Task\":\"a014100000AYiWMCC1\"}]\n</code></pre>\n\n<p>How do I iterate over the returned results before sending it off?</p>\n"}, {"tags": ["ruby", "string", "indexing"], "comments": [{"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1492557684, "post_id": 43483555, "comment_id": 74023315, "body": "By &quot;How do I find the first index of a string that occurs before a particular index?&quot; do you main &quot;For a given string, how do I find the largest index of the beginning of a substring such that the index does not exceed a specified value?&quot; &quot;another string&quot; is confusing, as you don&#39;t give a second string in your example."}], "answers": [{"tags": [], "owner": {"reputation": 73209, "user_id": 290394, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/d7908f05c89e965f6bc5308ad6f41256?s=128&d=identicon&r=PG", "display_name": "steenslag", "link": "https://stackoverflow.com/users/290394/steenslag"}, "is_accepted": true, "score": 1, "last_activity_date": 1492557634, "last_edit_date": 1492557634, "creation_date": 1492556844, "answer_id": 43483648, "question_id": 43483555, "link": "https://stackoverflow.com/questions/43483555/how-do-i-find-the-first-index-of-a-string-that-occurs-before-a-specified-index-i/43483648#43483648", "title": "How do I find the first index of a string that occurs before a specified index in another string?", "body": "<pre><code>str = \"ab cd ab cd ab cd ef\"\n\n# find the first index of \"ab\", working backwards from index 10:\np str.rindex(\"ab\", 10) # =&gt; 6\n</code></pre>\n\n<p><code>rindex</code> being short for \"reverse_index\", I guess.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user7055375"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 36, "favorite_count": 0, "accepted_answer_id": 43483648, "answer_count": 1, "score": 2, "last_activity_date": 1492557634, "creation_date": 1492556298, "question_id": 43483555, "link": "https://stackoverflow.com/questions/43483555/how-do-i-find-the-first-index-of-a-string-that-occurs-before-a-specified-index-i", "title": "How do I find the first index of a string that occurs before a specified index in another string?", "body": "<p>I'm using Ruby 2.4.  How do I find theh first index of a string that occurs before a particular index in another string?  That is, let's say I have this string</p>\n\n<pre><code>\"ab cd ab cd ab cd ef\"\n</code></pre>\n\n<p>And I want to find the first index of \"ab\" that occurs before index 10 in the above string.  The answer would be index 6 in this example.  If I want to find the index of \"ab\" that occurs before index 5 in teh above string, the answer would be zero.  I'm not sure how to use Ruby's \"index\" function to achieve what I want.</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "answers": [{"comments": [{"owner": {"reputation": 2771, "user_id": 1887370, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/08bf95201cabfe02acc28041cff862ff?s=128&d=identicon&r=PG", "display_name": "sakurashinken", "link": "https://stackoverflow.com/users/1887370/sakurashinken"}, "edited": false, "score": 0, "creation_date": 1492553933, "post_id": 43483094, "comment_id": 74022208, "body": "How should I pass the params with a delete request? as url parameters?"}, {"owner": {"reputation": 183, "user_id": 4996744, "user_type": "registered", "profile_image": "https://graph.facebook.com/455012207986992/picture?type=large", "display_name": "Vineeth Subbaraya", "link": "https://stackoverflow.com/users/4996744/vineeth-subbaraya"}, "reply_to_user": {"reputation": 2771, "user_id": 1887370, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/08bf95201cabfe02acc28041cff862ff?s=128&d=identicon&r=PG", "display_name": "sakurashinken", "link": "https://stackoverflow.com/users/1887370/sakurashinken"}, "edited": false, "score": 0, "creation_date": 1492554166, "post_id": 43483094, "comment_id": 74022274, "body": "Yes send it as url parameters like &quot;delete_path(ids_list: [1,2,3])&quot;"}], "tags": [], "owner": {"reputation": 183, "user_id": 4996744, "user_type": "registered", "profile_image": "https://graph.facebook.com/455012207986992/picture?type=large", "display_name": "Vineeth Subbaraya", "link": "https://stackoverflow.com/users/4996744/vineeth-subbaraya"}, "is_accepted": true, "score": 2, "last_activity_date": 1492553691, "creation_date": 1492553691, "answer_id": 43483094, "question_id": 43482887, "link": "https://stackoverflow.com/questions/43482887/delete-multiple-models-in-rails/43483094#43483094", "title": "Delete multiple models in rails", "body": "<p>You can do it with either POST or DELETE request, but I would prefer to do it as a DELETE. You can do something like this:</p>\n\n<pre><code>Model.where(id: params[:id_list]).destroy_all\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 21, "user_id": 4487015, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-o2-wlOz79gg/AAAAAAAAAAI/AAAAAAAABb0/ISZ1LAnBIVg/photo.jpg?sz=128", "display_name": "Rui Ribeiro", "link": "https://stackoverflow.com/users/4487015/rui-ribeiro"}, "is_accepted": false, "score": 2, "last_activity_date": 1492555648, "creation_date": 1492555648, "answer_id": 43483437, "question_id": 43482887, "link": "https://stackoverflow.com/questions/43482887/delete-multiple-models-in-rails/43483437#43483437", "title": "Delete multiple models in rails", "body": "<p>Pass the params in the url, something like /model/destroy_multiple?ids=[1,2,3]</p>\n\n<p>Then in the controller:</p>\n\n<pre><code>def destroy_multiple\n   Model.destroy_all(params[:id_list])\nend\n</code></pre>\n\n<p><strong>But remember:</strong></p>\n\n<ul>\n<li><code>destroy</code> / <code>destroy_all</code>: The associated objects are destroyed alongside this object by calling their destroy method</li>\n<li><code>delete</code> / <code>delete_all</code>: All associated objects are destroyed immediately without calling their :destroy method</li>\n</ul>\n\n<p>If your model doesn't have associated records you should use <strong>delete_all because is faster.</strong> </p>\n"}], "owner": {"reputation": 2771, "user_id": 1887370, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/08bf95201cabfe02acc28041cff862ff?s=128&d=identicon&r=PG", "display_name": "sakurashinken", "link": "https://stackoverflow.com/users/1887370/sakurashinken"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 443, "favorite_count": 0, "accepted_answer_id": 43483094, "answer_count": 2, "score": 0, "last_activity_date": 1492555648, "creation_date": 1492552677, "question_id": 43482887, "link": "https://stackoverflow.com/questions/43482887/delete-multiple-models-in-rails", "title": "Delete multiple models in rails", "body": "<p>I have a rails model where I would like to destroy multiple records from one call from the controller. My controller method is something like</p>\n\n<pre><code>def destroy_multiple\n   Model.destroy_all(params[:id_list])\nend\n</code></pre>\n\n<p>My question is what is the best way to submit the ids? As a POST request? GET request? URL parameter on a DELETE request? what is the best way to do this? </p>\n"}, {"tags": ["arrays", "ruby", "ruby-hash"], "comments": [{"owner": {"reputation": 4373, "user_id": 1810460, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5daef67cac318d3e35f84bc3f315bcfc?s=128&d=identicon&r=PG", "display_name": "Hamms", "link": "https://stackoverflow.com/users/1810460/hamms"}, "edited": false, "score": 1, "creation_date": 1492552758, "post_id": 43482850, "comment_id": 74021772, "body": "yeah, just set <code>hash.default = &quot;invalid&quot;</code>. From <a href=\"http://ruby-doc.org/core-2.0.0/Hash.html#method-i-default-3D\" rel=\"nofollow noreferrer\">the docs</a>"}, {"owner": {"reputation": 16229, "user_id": 525478, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/3b6c0b47a0c430a0b141baee7ea845be?s=128&d=identicon&r=PG", "display_name": "Brad Werth", "link": "https://stackoverflow.com/users/525478/brad-werth"}, "edited": false, "score": 0, "creation_date": 1492553841, "post_id": 43482850, "comment_id": 74022170, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/2990812/initializing-hashes\">Initializing hashes</a>"}], "answers": [{"comments": [{"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1492554391, "post_id": 43482912, "comment_id": 74022354, "body": "Note that this mutates <code>hash</code>."}], "tags": [], "owner": {"reputation": 73209, "user_id": 290394, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/d7908f05c89e965f6bc5308ad6f41256?s=128&d=identicon&r=PG", "display_name": "steenslag", "link": "https://stackoverflow.com/users/290394/steenslag"}, "is_accepted": false, "score": 3, "last_activity_date": 1492553172, "last_edit_date": 1492553172, "creation_date": 1492552787, "answer_id": 43482912, "question_id": 43482850, "link": "https://stackoverflow.com/questions/43482850/how-to-return-a-string-when-there-is-an-non-existent-element-in-a-hash-using-an/43482912#43482912", "title": "How to return a string when there is an non-existent element in a hash using an array", "body": "<p>If a hash has to respond with a default value for a nonexistent key, then this value has to be set. Usually it is set on the initialization of the hash:</p>\n\n<pre><code>hash = Hash.new(\"invalid\")\n</code></pre>\n\n<p>but it can be done anytime</p>\n\n<pre><code>hash={\"a\"=&gt;1,\"b\"=&gt;2,\"c\"=&gt;3,\"d\"=&gt;4,\"e\"=&gt;5,\"f\"=&gt;6}\narray=[\"b\",\"a\",\"c\",\"f\",\"z\",\"q\"]\n\nhash.default = \"invalid\"\np hash.values_at(*array)  #compact is superfluous\n\n# =&gt; [2, 1, 3, 6, \"invalid\", \"invalid\"]\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1492554694, "post_id": 43482941, "comment_id": 74022457, "body": "Good explanation. Consider providing a link to the doc <a href=\"http://ruby-doc.org/core-2.4.0/Hash.html#method-i-fetch\" rel=\"nofollow noreferrer\">Hash#fetch</a>."}], "tags": [], "owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "is_accepted": false, "score": 3, "last_activity_date": 1492552954, "creation_date": 1492552954, "answer_id": 43482941, "question_id": 43482850, "link": "https://stackoverflow.com/questions/43482850/how-to-return-a-string-when-there-is-an-non-existent-element-in-a-hash-using-an/43482941#43482941", "title": "How to return a string when there is an non-existent element in a hash using an array", "body": "<pre><code>array.map do |key|\n  hash.fetch key, 'invalid'\nend\n</code></pre>\n\n<p>if fetch is called with one argument, then if the key doesn't exist it will raise an error. However an optional second argument can set a custom return value for nonexistent keys. </p>\n\n<p>The benefit of this over <code>hash.default=</code> or passing the default in the Hash constructor is that the hash itself is not changed, so if you lookup a nonexistent key in the future it will return nil as expected instead of 'invalid'.</p>\n"}, {"tags": [], "owner": {"reputation": 6814, "user_id": 5227053, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/30254853024c1381c7e51ca09b9341e7?s=128&d=identicon&r=PG&f=1", "display_name": "AnoE", "link": "https://stackoverflow.com/users/5227053/anoe"}, "is_accepted": false, "score": 2, "last_activity_date": 1492553165, "creation_date": 1492553165, "answer_id": 43482988, "question_id": 43482850, "link": "https://stackoverflow.com/questions/43482850/how-to-return-a-string-when-there-is-an-non-existent-element-in-a-hash-using-an/43482988#43482988", "title": "How to return a string when there is an non-existent element in a hash using an array", "body": "<p>Try this:</p>\n\n<pre><code>array.map { |key|\n    hash.has_key?(key) ? hash[key] : 'invalid'\n}\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 7886342, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-gkF6QTDLs0M/AAAAAAAAAAI/AAAAAAAAAaw/CZHRFbQmn44/photo.jpg?sz=128", "display_name": "Andre", "link": "https://stackoverflow.com/users/7886342/andre"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 136, "favorite_count": 0, "answer_count": 3, "score": 1, "last_activity_date": 1494690691, "creation_date": 1492552462, "last_edit_date": 1494690691, "question_id": 43482850, "link": "https://stackoverflow.com/questions/43482850/how-to-return-a-string-when-there-is-an-non-existent-element-in-a-hash-using-an", "title": "How to return a string when there is an non-existent element in a hash using an array", "body": "<p>I have this hash and this array, and execute the following command...</p>\n\n<pre><code>hash={\"a\"=&gt;1,\"b\"=&gt;2,\"c\"=&gt;3,\"d\"=&gt;4,\"e\"=&gt;5,\"f\"=&gt;6}\narray=[\"b\",\"a\",\"c\",\"f\",\"z\",\"q\"]\nprint hash.values_at(*array).compact\n</code></pre>\n\n<p>So I want it to return something like:</p>\n\n<pre><code>#=&gt; [2,1,3,6,\"invalid\",\"invalid\"]\n</code></pre>\n\n<p>Is there a way to declare all other elements non-existent in the hash as \"invalid\", without declaring one by one (e.g. \"g\"=>\"invalid\", \"h\"=>\"invalid\"...)?</p>\n"}, {"tags": ["ruby", "ruby-on-rails-4"], "comments": [{"owner": {"reputation": 4557, "user_id": 1847280, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4124a0c3fbe08db2e0021e3e09b76e7f?s=128&d=identicon&r=PG", "display_name": "Yevgeniy Anfilofyev", "link": "https://stackoverflow.com/users/1847280/yevgeniy-anfilofyev"}, "edited": false, "score": 0, "creation_date": 1492551270, "post_id": 43482453, "comment_id": 74021142, "body": "Maybe <code>@table_name</code> inside of <code>self.has_condition_flag</code> will help you"}, {"owner": {"reputation": 1695, "user_id": 427354, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/8b1da0d743d87175b7cc0ef93c8fcad7?s=128&d=identicon&r=PG", "display_name": "User7354632781", "link": "https://stackoverflow.com/users/427354/user7354632781"}, "reply_to_user": {"reputation": 4557, "user_id": 1847280, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4124a0c3fbe08db2e0021e3e09b76e7f?s=128&d=identicon&r=PG", "display_name": "Yevgeniy Anfilofyev", "link": "https://stackoverflow.com/users/1847280/yevgeniy-anfilofyev"}, "edited": false, "score": 0, "creation_date": 1492551428, "post_id": 43482453, "comment_id": 74021209, "body": "tried it. same error"}, {"owner": {"reputation": 4557, "user_id": 1847280, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4124a0c3fbe08db2e0021e3e09b76e7f?s=128&d=identicon&r=PG", "display_name": "Yevgeniy Anfilofyev", "link": "https://stackoverflow.com/users/1847280/yevgeniy-anfilofyev"}, "edited": false, "score": 0, "creation_date": 1492551572, "post_id": 43482453, "comment_id": 74021275, "body": "See, <code>vCustomerDetails</code> is a local value to <code>has_condition_flag</code>. You can&#39;t address to it. That is what the error about"}], "answers": [{"tags": [], "owner": {"reputation": 1379, "user_id": 2101252, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JXPjA.jpg?s=128&g=1", "display_name": "s1mpl3", "link": "https://stackoverflow.com/users/2101252/s1mpl3"}, "is_accepted": false, "score": 0, "last_activity_date": 1492568615, "last_edit_date": 1492568615, "creation_date": 1492551671, "answer_id": 43482668, "question_id": 43482453, "link": "https://stackoverflow.com/questions/43482453/how-to-get-single-latest-record-from-a-view-and-test-it-in-console/43482668#43482668", "title": "how to get single latest record from a view and test it in console", "body": "<p>Remove  vCustomerDetails</p>\n\n<pre><code>module Customer\n  class CustomerUsage &lt; ActiveRecord::Base\n\nself.table_name = 'vCustomerDetails'\n\ndef self.has_condition_flag(user_id)      \n    where(\"vCustomerDetails.UserID = #{user_id}\")\n    .order('vCustomerDetails.EntryDate DESC')\n    .last\n   end\n  end\nend\n</code></pre>\n\n<p>to select a limited number of columns use </p>\n\n<pre><code>.select('HasConditionFlag')\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1695, "user_id": 427354, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/8b1da0d743d87175b7cc0ef93c8fcad7?s=128&d=identicon&r=PG", "display_name": "User7354632781", "link": "https://stackoverflow.com/users/427354/user7354632781"}, "is_accepted": false, "score": 0, "last_activity_date": 1492551984, "creation_date": 1492551984, "answer_id": 43482745, "question_id": 43482453, "link": "https://stackoverflow.com/questions/43482453/how-to-get-single-latest-record-from-a-view-and-test-it-in-console/43482745#43482745", "title": "how to get single latest record from a view and test it in console", "body": "<p>this one worked</p>\n\n<pre><code> def self.has_condition_flag(user_id)\n      CustomerUsage\n        .select(\"vCustomerDetails.HasConditionFlag\")\n        .where(\"vCustomerDetails.UserID = #{user_id}\")\n        .order('vCustomerDetails.EntryDate DESC')\n        .first\n</code></pre>\n"}], "owner": {"reputation": 1695, "user_id": 427354, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/8b1da0d743d87175b7cc0ef93c8fcad7?s=128&d=identicon&r=PG", "display_name": "User7354632781", "link": "https://stackoverflow.com/users/427354/user7354632781"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 17, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1492568615, "creation_date": 1492550690, "last_edit_date": 1492551012, "question_id": 43482453, "link": "https://stackoverflow.com/questions/43482453/how-to-get-single-latest-record-from-a-view-and-test-it-in-console", "title": "how to get single latest record from a view and test it in console", "body": "<p>I kinda have 2 questions. I have following model and method to get the latest record from view. but when i try to test in console i get error <code>undefined method or variable vCustomerDetails</code> why i am getting the error?</p>\n\n<p>Also, how do i select only one column from view?</p>\n\n<pre><code>SELECT TOP 1 HasConditionFlag FROM vCustomerDetails\nWHERE vCustomerDetails.UserID = @user_id\nORDER BY EntryDate DESC\n</code></pre>\n\n<p>Model</p>\n\n<pre><code>module Customer\n  class CustomerUsage &lt; ActiveRecord::Base\n\nself.table_name = 'vCustomerDetails'\n\ndef self.has_condition_flag(user_id)\n  vCustomerDetails\n    .where(\"vCustomerDetails.UserID = #{user_id}\")\n    .order('vCustomerDetails.EntryDate DESC')\n    .last\n   end\n  end\nend\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "heroku", "vue.js", "asset-pipeline"], "answers": [{"comments": [{"owner": {"reputation": 2364, "user_id": 388280, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/67227642f4c9822bc306c8fe6a5f6742?s=128&d=identicon&r=PG", "display_name": "ytbryan", "link": "https://stackoverflow.com/users/388280/ytbryan"}, "edited": false, "score": 1, "creation_date": 1498012123, "post_id": 43499942, "comment_id": 76317007, "body": "For further vue integration on rails, I would recommend checking out <code>webpacker</code> project (<a href=\"https://github.com/rails/webpacker\" rel=\"nofollow noreferrer\">github.com/rails/webpacker</a>) and specifically <code>rails new app webpack=vue</code>command in rails 5.1"}], "tags": [], "owner": {"reputation": 1281, "user_id": 2308531, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/DV29D.jpg?s=128&g=1", "display_name": "Maxim Fedotov", "link": "https://stackoverflow.com/users/2308531/maxim-fedotov"}, "is_accepted": true, "score": 0, "last_activity_date": 1492615463, "creation_date": 1492615463, "answer_id": 43499942, "question_id": 43482139, "link": "https://stackoverflow.com/questions/43482139/vue-js-not-working-on-heroku-rails-app/43499942#43499942", "title": "Vue.js not working on Heroku Rails app", "body": "<p>There was a Javascript error, specifically, I needed to include Tether to use Bootstrap. On local there is no minification, so even with an error, Vue.js was working. But on Production, one JS error would completely stop the whole application JS compiling. </p>\n\n<p>Making sure I have that dependency fixed the problem.</p>\n"}], "owner": {"reputation": 1281, "user_id": 2308531, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/DV29D.jpg?s=128&g=1", "display_name": "Maxim Fedotov", "link": "https://stackoverflow.com/users/2308531/maxim-fedotov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1189, "favorite_count": 1, "accepted_answer_id": 43499942, "answer_count": 1, "score": 0, "last_activity_date": 1492615463, "creation_date": 1492549329, "question_id": 43482139, "link": "https://stackoverflow.com/questions/43482139/vue-js-not-working-on-heroku-rails-app", "title": "Vue.js not working on Heroku Rails app", "body": "<p>I've been trying to deploy my Rails + Vue.js app to Heroku. Vue.js works just fine locally, but not on Heroku. I feel I am not doing something with asset pipeline, but can't figure out what.</p>\n\n<p>I am using <code>vuejs-rails</code> gem for Vue, here is the full Gemfile:</p>\n\n<pre><code>source 'https://rubygems.org'\nruby '2.3.1'\n\ngit_source(:github) do |repo_name|\n  repo_name = \"#{repo_name}/#{repo_name}\" unless repo_name.include?(\"/\")\n  \"https://github.com/#{repo_name}.git\"\nend\n\n# Assets\ngem 'vuejs-rails'\ngem 'bootstrap', '~&gt; 4.0.0.alpha6'\ngem 'rails', '~&gt; 5.0.1'\ngem 'jquery-rails'\ngem 'jbuilder', '~&gt; 2.5'\ngem 'coffee-rails', '~&gt; 4.2'\ngem 'sass-rails', '~&gt; 5.0'\ngem \"haml-rails\", \"~&gt; 0.9\"\ngem 'dentaku'\ngem \"browserify-rails\"\n# Server\ngem 'puma', '~&gt; 3.0'\ngem 'pg'\ngem 'uglifier', '&gt;= 1.3.0'\ngem 'rollbar'\n\n# Use Capistrano for deployment\n# gem 'capistrano-rails', group: :development\n\ngroup :development, :test do\n  # Call 'byebug' anywhere in the code to stop execution and get a debugger console\n  gem 'byebug', platform: :mri\nend\n\ngroup :development do\n  # Access an IRB console on exception pages or by using &lt;%= console %&gt; anywhere in the code.\n  gem 'web-console', '&gt;= 3.3.0'\n  gem 'listen', '~&gt; 3.0.5'\n  # Spring speeds up development by keeping your application running in the background. Read more: https://github.com/rails/spring\n  gem 'spring'\n  gem 'spring-watcher-listen', '~&gt; 2.0.0'\nend\n\ngroup :test do\n  gem 'rspec-rails'\nend\n\n# Windows does not include zoneinfo files, so bundle the tzinfo-data gem\ngem 'tzinfo-data', platforms: [:mingw, :mswin, :x64_mingw, :jruby]\n</code></pre>\n\n<h2>Application.js</h2>\n\n<pre><code>//= require jquery\n//= require jquery_ujs\n//= require bootstrap-sprockets\n//= require vue\n//= require_tree .\n</code></pre>\n\n<p>I've configured Multiple Heroku Buildpacks as seen in my App.json</p>\n\n<h2>App.json</h2>\n\n<pre><code>{\n  \"name\": \"test_name\",\n  \"description\": \"Some stuff\",\n  \"addons\": [\n    \"deployhooks\",\n    \"newrelic\",\n    \"rollbar\"\n  ],\n  \"buildpacks\": [\n    {\n      \"url\": \"heroku/nodejs\"\n    },\n    {\n      \"url\": \"urn:buildpack:heroku/ruby\"\n    }\n  ]\n}\n</code></pre>\n\n<p>And here is the output when I deploy to Heroku. Doesn't seem like assets:precompile does anything:</p>\n\n<pre><code>remote: Compressing source files... done.\nremote: Building source:\nremote: \nremote: -----&gt; Node.js app detected\nremote: \nremote: -----&gt; Creating runtime environment\nremote:        \nremote:        NPM_CONFIG_LOGLEVEL=error\nremote:        NPM_CONFIG_PRODUCTION=true\nremote:        NODE_VERBOSE=false\nremote:        NODE_ENV=production\nremote:        NODE_MODULES_CACHE=true\nremote: \nremote: -----&gt; Installing binaries\nremote:        engines.node (package.json):  unspecified\nremote:        engines.npm (package.json):   unspecified (use default)\nremote:        \nremote:        Resolving node version 6.x via semver.io...\nremote:        Downloading and installing node 6.10.2...\nremote:        Using default npm version: 3.10.10\nremote: \nremote: -----&gt; Restoring cache\nremote:        Loading 2 from cacheDirectories (default):\nremote:        - node_modules\nremote:        - bower_components (not cached - skipping)\nremote: \nremote: -----&gt; Building dependencies\nremote:        Installing node modules (package.json)\nremote: \nremote: -----&gt; Caching build\nremote:        Clearing previous node cache\nremote:        Saving 2 cacheDirectories (default):\nremote:        - node_modules\nremote:        - bower_components (nothing to cache)\nremote: \nremote: -----&gt; Build succeeded!\nremote: -----&gt; Ruby app detected\nremote: -----&gt; Compiling Ruby/Rails\nremote: -----&gt; Using Ruby version: ruby-2.3.1\nremote: -----&gt; Installing dependencies using bundler 1.13.7\nremote:        Running: bundle install --without development:test --path vendor/bundle --binstubs vendor/bundle/bin -j4 --deployment\nremote:        Warning: the running version of Bundler (1.13.7) is older than the version that created the lockfile (1.14.6). We suggest you upgrade to the latest version of Bundler by running `gem install bundler`.\nremote:        Fetching gem metadata from https://rubygems.org/.........\nremote:        Fetching version metadata from https://rubygems.org/..\nremote:        Fetching dependency metadata from https://rubygems.org/.\nremote:        Using rake 12.0.0\nremote:        Using concurrent-ruby 1.0.5\nremote:        Using i18n 0.8.1\nremote:        Using minitest 5.10.1\nremote:        Using thread_safe 0.3.6\nremote:        Using builder 3.2.3\nremote:        Using erubis 2.7.0\nremote:        Using mini_portile2 2.1.0\nremote:        Using rack 2.0.1\nremote:        Using nio4r 2.0.0\nremote:        Using websocket-extensions 0.1.2\nremote:        Using mime-types-data 3.2016.0521\nremote:        Using arel 7.1.4\nremote:        Using public_suffix 2.0.5\nremote:        Using execjs 2.7.0\nremote:        Using sass 3.4.23\nremote:        Using method_source 0.8.2\nremote:        Using thor 0.19.4\nremote:        Using coffee-script-source 1.12.2\nremote:        Using dentaku 2.0.10\nremote:        Using tilt 2.0.7\nremote:        Using sexp_processor 4.9.0\nremote:        Using multi_json 1.12.1\nremote:        Using pg 0.20.0\nremote:        Using puma 3.8.2\nremote:        Using bundler 1.13.7\nremote:        Using vuejs-rails 2.2.1\nremote:        Using nokogiri 1.7.1\nremote:        Using websocket-driver 0.6.5\nremote:        Using mime-types 3.1\nremote:        Using addressable 2.5.1\nremote:        Using autoprefixer-rails 6.7.7.2\nremote:        Using uglifier 3.2.0\nremote:        Using rack-test 0.6.3\nremote:        Using sprockets 3.7.1\nremote:        Using tzinfo 1.2.3\nremote:        Using coffee-script 2.4.1\nremote:        Using ruby_parser 3.9.0\nremote:        Using haml 4.0.7\nremote:        Using rollbar 2.12.0\nremote:        Using loofah 2.0.3\nremote:        Using mail 2.6.4\nremote:        Using bootstrap 4.0.0.alpha6\nremote:        Using activesupport 5.0.2\nremote:        Using rails-html-sanitizer 1.0.3\nremote:        Using rails-dom-testing 2.0.2\nremote:        Using globalid 0.4.0\nremote:        Using activemodel 5.0.2\nremote:        Using jbuilder 2.6.3\nremote:        Using html2haml 2.1.0\nremote:        Using actionview 5.0.2\nremote:        Using activejob 5.0.2\nremote:        Using activerecord 5.0.2\nremote:        Using actionpack 5.0.2\nremote:        Using actioncable 5.0.2\nremote:        Using actionmailer 5.0.2\nremote:        Using railties 5.0.2\nremote:        Using sprockets-rails 3.2.0\nremote:        Using browserify-rails 4.1.0\nremote:        Using coffee-rails 4.2.1\nremote:        Using haml-rails 0.9.0\nremote:        Using jquery-rails 4.3.1\nremote:        Using rails 5.0.2\nremote:        Using sass-rails 5.0.6\nremote:        Bundle complete! 21 Gemfile dependencies, 64 gems now installed.\nremote:        Gems in the groups development and test were not installed.\nremote:        Bundled gems are installed into ./vendor/bundle.\nremote:        Bundle completed (2.30s)\nremote:        Cleaning up the bundler cache.\nremote:        Warning: the running version of Bundler (1.13.7) is older than the version that created the lockfile (1.14.6). We suggest you upgrade to the latest version of Bundler by running `gem install bundler`.\nremote: -----&gt; Detecting rake tasks\nremote: -----&gt; Preparing app for Rails asset pipeline\nremote:        Running: rake assets:precompile\nremote:        Asset precompilation completed (1.56s)\nremote:        Cleaning assets\nremote:        Running: rake assets:clean\nremote: \nremote: -----&gt; Discovering process types\nremote:        Procfile declares types     -&gt; web\nremote:        Default types for buildpack -&gt; console, rake, worker\nremote: \nremote: -----&gt; Compressing...\nremote:        Done: 44.4M\nremote: -----&gt; Launching...\nremote:        Released v11\nremote:        https://nlp-calculator.herokuapp.com/ deployed to Heroku\nremote: \nremote: Verifying deploy... done.\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby"], "answers": [{"tags": [], "owner": {"reputation": 99, "user_id": 1776169, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XJB9n.jpg?s=128&g=1", "display_name": "yatindra rao", "link": "https://stackoverflow.com/users/1776169/yatindra-rao"}, "is_accepted": false, "score": 0, "last_activity_date": 1492575458, "last_edit_date": 1495540933, "creation_date": 1492575458, "answer_id": 43486274, "question_id": 43482094, "link": "https://stackoverflow.com/questions/43482094/rails-hamlit-loaderror-incompatible-library-version/43486274#43486274", "title": "Rails hamlit LoadError. Incompatible library version", "body": "<p>You can run these commands:</p>\n\n<pre><code>gem uninstall hamlit\nbundle install\n</code></pre>\n\n<p>References: <a href=\"http://guides.rubygems.org/command-reference/#gem-pristine\" rel=\"nofollow noreferrer\">http://guides.rubygems.org/command-reference/#gem-pristine</a> <a href=\"https://stackoverflow.com/questions/34474847/ruby-on-rails-incompatible-library\">Ruby on Rails incompatible library</a></p>\n"}], "owner": {"reputation": 1212, "user_id": 1341809, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/afdd238a7321a4dbdbf70cd063d7ef61?s=128&d=identicon&r=PG", "display_name": "learner", "link": "https://stackoverflow.com/users/1341809/learner"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 171, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1492575458, "creation_date": 1492549159, "question_id": 43482094, "link": "https://stackoverflow.com/questions/43482094/rails-hamlit-loaderror-incompatible-library-version", "title": "Rails hamlit LoadError. Incompatible library version", "body": "<p>After installing many gems sucessfully, I'm facing a LoadError problem when I call rails local server (with rails s).\nThe complaining is related to incompatible library version.</p>\n\n<pre><code>gems/ruby-2.3.1@global/gems/hamlit-2.8.1/lib/hamlit/attribute_builder.rb:2:in `require': incompatible library version - /home/alex/.rvm/gems/ruby-2.3.1@global/gems/hamlit-2.8.1/lib/hamlit/hamlit.so (LoadError)\nfrom /home/alex/.rvm/gems/ruby-2.3.1@global/gems/hamlit-2.8.1/lib/hamlit/attribute_builder.rb:2:in `&lt;top (required)&gt;'\nfrom /home/alex/.rvm/gems/ruby-2.3.1@global/gems/hamlit-2.8.1/lib/hamlit/attribute_compiler.rb:2:in `require'\nfrom /home/alex/.rvm/gems/ruby-2.3.1@global/gems/hamlit-2.8.1/lib/hamlit/attribute_compiler.rb:2:in `&lt;top (required)&gt;'\nfrom /home/alex/.rvm/gems/ruby-2.3.1@global/gems/hamlit-2.8.1/lib/hamlit/compiler/tag_compiler.rb:3:in `require'\nfrom /home/alex/.rvm/gems/ruby-2.3.1@global/gems/hamlit-2.8.1/lib/hamlit/compiler/tag_compiler.rb:3:in `&lt;top (required)&gt;'\nfrom /home/alex/.rvm/gems/ruby-2.3.1@global/gems/hamlit-2.8.1/lib/hamlit/compiler.rb:7:in `require'\nfrom /home/alex/.rvm/gems/ruby-2.3.1@global/gems/hamlit-2.8.1/lib/hamlit/compiler.rb:7:in `&lt;top (required)&gt;'\nfrom /home/alex/.rvm/gems/ruby-2.3.1@global/gems/hamlit-2.8.1/lib/hamlit/engine.rb:4:in `require'\nfrom /home/alex/.rvm/gems/ruby-2.3.1@global/gems/hamlit-2.8.1/lib/hamlit/engine.rb:4:in `&lt;top (required)&gt;'\nfrom /home/alex/.rvm/gems/ruby-2.3.1@global/gems/hamlit-2.8.1/lib/hamlit.rb:2:in `require'\nfrom /home/alex/.rvm/gems/ruby-2.3.1@global/gems/hamlit-2.8.1/lib/hamlit.rb:2:in `&lt;top (required)&gt;'\nfrom /usr/lib/ruby/vendor_ruby/bundler/runtime.rb:77:in `require'\nfrom /usr/lib/ruby/vendor_ruby/bundler/runtime.rb:77:in `block (2 levels) in require'\nfrom /usr/lib/ruby/vendor_ruby/bundler/runtime.rb:72:in `each'\nfrom /usr/lib/ruby/vendor_ruby/bundler/runtime.rb:72:in `block in require'\nfrom /usr/lib/ruby/vendor_ruby/bundler/runtime.rb:61:in `each'\nfrom /usr/lib/ruby/vendor_ruby/bundler/runtime.rb:61:in `require'\nfrom /usr/lib/ruby/vendor_ruby/bundler.rb:99:in `require'\nfrom /usr/local/RubyWorkspace/produtos_adaptativos/config/application.rb:14:in `&lt;top (required)&gt;'\nfrom /home/alex/.rvm/gems/ruby-2.3.1@global/gems/railties-4.2.6/lib/rails/commands/commands_tasks.rb:78:in `require'\nfrom /home/alex/.rvm/gems/ruby-2.3.1@global/gems/railties-4.2.6/lib/rails/commands/commands_tasks.rb:78:in `block in server'\nfrom /home/alex/.rvm/gems/ruby-2.3.1@global/gems/railties-4.2.6/lib/rails/commands/commands_tasks.rb:75:in `tap'\nfrom /home/alex/.rvm/gems/ruby-2.3.1@global/gems/railties-4.2.6/lib/rails/commands/commands_tasks.rb:75:in `server'\nfrom /home/alex/.rvm/gems/ruby-2.3.1@global/gems/railties-4.2.6/lib/rails/commands/commands_tasks.rb:39:in `run_command!'\nfrom /home/alex/.rvm/gems/ruby-2.3.1@global/gems/railties-4.2.6/lib/rails/commands.rb:17:in `&lt;top (required)&gt;'\nfrom /usr/local/RubyWorkspace/produtos_adaptativos/bin/rails:9:in `require'\nfrom /usr/local/RubyWorkspace/produtos_adaptativos/bin/rails:9:in `&lt;top (required)&gt;'\nfrom /home/alex/.rvm/gems/ruby-2.3.1@global/gems/spring-2.0.0/lib/spring/client/rails.rb:28:in `load'\nfrom /home/alex/.rvm/gems/ruby-2.3.1@global/gems/spring-2.0.0/lib/spring/client/rails.rb:28:in `call'\nfrom /home/alex/.rvm/gems/ruby-2.3.1@global/gems/spring-2.0.0/lib/spring/client/command.rb:7:in `call'\nfrom /home/alex/.rvm/gems/ruby-2.3.1@global/gems/spring-2.0.0/lib/spring/client.rb:30:in `run'\nfrom /home/alex/.rvm/gems/ruby-2.3.1@global/gems/spring-2.0.0/bin/spring:49:in `&lt;top (required)&gt;'\nfrom /home/alex/.rvm/gems/ruby-2.3.1@global/gems/spring-2.0.0/lib/spring/binstub.rb:31:in `load'\nfrom /home/alex/.rvm/gems/ruby-2.3.1@global/gems/spring-2.0.0/lib/spring/binstub.rb:31:in `&lt;top (required)&gt;'\nfrom /usr/lib/ruby/2.3.0/rubygems/core_ext/kernel_require.rb:68:in `require'\nfrom /usr/lib/ruby/2.3.0/rubygems/core_ext/kernel_require.rb:68:in `require'\nfrom /usr/local/RubyWorkspace/produtos_adaptativos/bin/spring:13:in `&lt;top (required)&gt;'\nfrom bin/rails:3:in `load'\nfrom bin/rails:3:in `&lt;main&gt;'\n</code></pre>\n\n<p>Do I need to do a downgrade of this lib?</p>\n"}, {"tags": ["ruby", "date", "parsing", "time"], "answers": [{"tags": [], "owner": {"reputation": 28716, "user_id": 828193, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/pmNlX.png?s=128&g=1", "display_name": "user000001", "link": "https://stackoverflow.com/users/828193/user000001"}, "is_accepted": true, "score": 3, "last_activity_date": 1492547850, "creation_date": 1492547850, "answer_id": 43481757, "question_id": 43481688, "link": "https://stackoverflow.com/questions/43481688/how-to-parse-date-and-time-with-date-strptime/43481757#43481757", "title": "How to parse date and time with Date.strptime", "body": "<p><code>Date</code> doesn't contain information about the exact time, use <code>DateTime</code> instead:</p>\n\n<pre><code>DateTime.strptime(\"2017:03:11 18:02:30\", '%Y:%m:%d %H:%M:%S').strftime('%Y:%m:%d %H:%M:%S')\n=&gt; \"2017:03:11 18:02:30\"\n</code></pre>\n"}], "owner": {"reputation": 2540, "user_id": 519790, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/b92a265cc1560fb04362d5bc63d42a0d?s=128&d=identicon&r=PG", "display_name": "multiholle", "link": "https://stackoverflow.com/users/519790/multiholle"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1124, "favorite_count": 0, "accepted_answer_id": 43481757, "answer_count": 1, "score": 1, "last_activity_date": 1492550641, "creation_date": 1492547549, "last_edit_date": 1492550641, "question_id": 43481688, "link": "https://stackoverflow.com/questions/43481688/how-to-parse-date-and-time-with-date-strptime", "title": "How to parse date and time with Date.strptime", "body": "<p>If I use <code>Date#strptime</code> to parse an Exif date like <code>2017:03:11 18:02:30</code> the time is ignored: </p>\n\n<pre><code>Date.strptime(\"2017:03:11 18:02:30\", '%Y:%m:%d %H:%M:%S').strftime('%Y:%m:%d %H:%M:%S')\n=&gt; \"2017:03:11 00:00:00\"\n</code></pre>\n\n<p>What am I doing wrong?</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 512, "user_id": 714186, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/80a2796024c64b5ae0bacb945d541d7f?s=128&d=identicon&r=PG&f=1", "display_name": "my_overflowed_stack", "link": "https://stackoverflow.com/users/714186/my-overflowed-stack"}, "reply_to_user": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1492550844, "post_id": 43481271, "comment_id": 74020975, "body": "@engineersmnky would that work both ways though?  I would like &quot;@configuration&quot; to get updated when the &quot;@abc&quot; is updated and &quot;@abc&quot; updated when &quot;@configuration&quot; is updated"}], "answers": [{"comments": [{"owner": {"reputation": 512, "user_id": 714186, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/80a2796024c64b5ae0bacb945d541d7f?s=128&d=identicon&r=PG&f=1", "display_name": "my_overflowed_stack", "link": "https://stackoverflow.com/users/714186/my-overflowed-stack"}, "edited": false, "score": 0, "creation_date": 1492655701, "post_id": 43483570, "comment_id": 74072818, "body": "This is great.  I don&#39;t see your implementation of the Configuration class.  Can you post that please?"}, {"owner": {"reputation": 512, "user_id": 714186, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/80a2796024c64b5ae0bacb945d541d7f?s=128&d=identicon&r=PG&f=1", "display_name": "my_overflowed_stack", "link": "https://stackoverflow.com/users/714186/my-overflowed-stack"}, "edited": false, "score": 0, "creation_date": 1492655738, "post_id": 43483570, "comment_id": 74072829, "body": "Nevermind i see it.  didn&#39;t scroll down in the code block.  Thanks!"}], "tags": [], "owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "is_accepted": true, "score": 1, "last_activity_date": 1492619017, "last_edit_date": 1492619017, "creation_date": 1492556374, "answer_id": 43483570, "question_id": 43481271, "link": "https://stackoverflow.com/questions/43481271/update-attribute-based-on-update-of-hash/43483570#43483570", "title": "Update Attribute Based on Update of Hash", "body": "<p>Here is an expanded example of what I believe you are trying to achieve.</p>\n\n<p>I Created a class for <code>Configuration</code> to manage predefined keys so that you cannot manipulate the keys in the hash. I only gave it access to <code>[]</code> and <code>[]=</code> and added <code>to_h</code> for <code>Hash</code> but duped the <code>@configuration</code> so you can't manipulate it through there either. </p>\n\n<pre><code>class SomeClass\n  # build this list in anyway you see fit \n  PREDEFINED_KEYS =  [:abc, :def, :ghi] \n  # define getter/setter methods for the PREDEFINED_KEYS\n  PREDEFINED_KEYS.each do |m|\n    define_method(m) do \n      @configuration[m] \n    end\n    define_method(\"#{m}=\") do |val|\n      @configuration[m] = val\n    end\n  end \n  # intialize a new Configuration with the PREDEFINED_KEYS\n  def initialize\n    @configuration = Configuration.new(PREDEFINED_KEYS)\n  end\n  # alternate implementation using initialize instead of a constant\n  # def initialize(keys)\n  #   @configuration = Configuration.new(keys)\n  #   instance_eval do \n  #     keys.each do |m|\n  #       define_singleton_method(m) do \n  #         @configuration[m] \n  #       end\n  #       define_singleton_method(\"#{m}=\") do |val|\n  #         @configuration[m] = val\n  #       end\n  #     end\n  #   end\n  # end\n  # Usage: SomeClass.new([:abc,:def,:ghi])\n\n  # accept a block and return the configuration class\n  def configuration\n    yield @configuration if block_given? \n    @configuration \n  end\n  # convert to a proper Hash\n  def to_h\n    @configuration.to_h\n  end\n\n  class Configuration\n    class UndefinedKeyError &lt; StandardError;end\n    # start out all keys with a value of nil\n    def initialize(keys)\n      @configuration = Hash[keys.product([nil])]\n    end\n    # retrieve value by key just like a normal Hash\n    def [](k)\n      @configuration[k]\n    end\n    # set value by key like a normal Hash \n    # excepting the key must be one of the keys defined in initialization\n    def []=(k,v)\n      raise(UndefinedKeyError, \"must be one of #{@configuration.keys}\") unless @configuration.has_key?(k)\n      @configuration[k] = v\n    end\n    def to_h\n      @configuration.dup\n    end\n  end\nend\n</code></pre>\n\n<p>Then your use case should work appropriately. All you have to do is read out the keys from your file in place of the statically defined <code>PREDEFINED_KEYS</code></p>\n\n<p>Usage</p>\n\n<pre><code>s = SomeClass.new\ns.abc = 12\ns.to_h\n#=&gt; {abc: 12, def: nil, ghi: nil}\ns.configuration[:def] = 19\ns.to_h\n#=&gt; {abc: 12, def: 19, ghi: nil}\ns.configuration do |c|\n  c[:ghi] = 22\nend.to_h\n#=&gt; {abc: 12, def: 19, ghi: 22}\ns.ghi\n#=&gt; 22\ns.configuration[:rbc] = 19\n#=&gt; SomeClass::Configuration::UndefinedKeyError: must be one of [:abc, :def, :ghi]\ns.configuration[:lmn]\n#=&gt; nil\n</code></pre>\n"}], "owner": {"reputation": 512, "user_id": 714186, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/80a2796024c64b5ae0bacb945d541d7f?s=128&d=identicon&r=PG&f=1", "display_name": "my_overflowed_stack", "link": "https://stackoverflow.com/users/714186/my-overflowed-stack"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 57, "favorite_count": 0, "accepted_answer_id": 43483570, "answer_count": 1, "score": 0, "last_activity_date": 1492619017, "creation_date": 1492546010, "question_id": 43481271, "link": "https://stackoverflow.com/questions/43481271/update-attribute-based-on-update-of-hash", "title": "Update Attribute Based on Update of Hash", "body": "<p>I have a project where I am dynamically creating attributes on a class and these attributes are also stored as a hash in another property that serves as a collection of all of these attributes and their values.  What I'd like to be able to do is update the attribute when the hash is updated and vice versa.</p>\n\n<p>Something like this:</p>\n\n<pre><code>class SomeClass\n\n\n  def initialize\n    #code that creates the attributes on the class\n    config_list.each { |config| self.class.send(:attr_accessor, config) }\n  end\n\n  #list of attributes that are dynamically added to the class\n  #this is normally read from a config file but I added it here to simplify\n  def config_list\n    [:abc, :def, :ghi]\n  end\n\n  def configuration\n    config_list.inject({}) do |r,e| \n      r[e] = instance_variable_get(\"@#{e.to_s}\"); r \n    end\n  end\nend\n</code></pre>\n\n<p>Usage:</p>\n\n<pre><code>x = SomeClass.new\n  #=&gt; #&lt;SomeClass:0x007f9931990710&gt;\nx.abc = 5\n  #=&gt; 5\nx.configuration\n  #=&gt; {:abc=&gt;5, :def=&gt;nil, :ghi=&gt;nil}\nx.configuration[:abc] = 10\n  #=&gt; 10\nx.abc\n  #=&gt; 5\n</code></pre>\n\n<p>I'd like that final last call of:</p>\n\n<pre><code>x.abc\n</code></pre>\n\n<p>to return 10 because the configuration's value was updated.  Is that possible?  If so, how do I do it?</p>\n"}, {"tags": ["ruby", "ldap", "netldap"], "answers": [{"tags": [], "owner": {"reputation": 3090, "user_id": 4454732, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh3.googleusercontent.com/-8OrTJkCtkn4/AAAAAAAAAAI/AAAAAAAAA4s/7jp2lrThK2k/photo.jpg?sz=128", "display_name": "David Hempy", "link": "https://stackoverflow.com/users/4454732/david-hempy"}, "is_accepted": true, "score": 0, "last_activity_date": 1492543531, "creation_date": 1492543531, "answer_id": 43480607, "question_id": 43480606, "link": "https://stackoverflow.com/questions/43480606/netldap-add-failed-with-no-error-message-how-can-i-find-the-reason-why-the/43480607#43480607", "title": "Net::LDAP add() failed with no error message. How can I find the reason why the record did not validate?", "body": "<p>Then I stumbled across <code>ldap.get_operation_result</code>, I had a real facepalm moment. I've intentionally recreated several of the issues I painfully solved through careful inspection with <code>get_operation_result</code> in my arsenal, and each time it described exactly what the problem was. </p>\n\n<p>This function is useful in the case of rescuing an exception, or if add(), modify(), delete(), etc. simply returns false. </p>\n\n<pre><code> ldap.add(dn: dn, attributes: attributes)\n Rails.logger.info(\"ldap.add: #{ldap.get_operation_result}\")\n</code></pre>\n\n<p>The snippet above saved my sanity, not to mention hours of tedious hunt-and-peck testing. </p>\n\n<p>For example, here is just one part of an error message it revealed that I did not provide the required <code>sn</code> attribute:</p>\n\n<pre><code>ERR_279 Required attributes [sn(2.5.4.4)] not found within entry uid=david,o=users,dc=example,dc=com\"\n</code></pre>\n\n<p>It will also show messages related to bad server connection credentials, etc.  </p>\n\n<p>HTH</p>\n"}], "owner": {"reputation": 3090, "user_id": 4454732, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh3.googleusercontent.com/-8OrTJkCtkn4/AAAAAAAAAAI/AAAAAAAAA4s/7jp2lrThK2k/photo.jpg?sz=128", "display_name": "David Hempy", "link": "https://stackoverflow.com/users/4454732/david-hempy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 215, "favorite_count": 0, "accepted_answer_id": 43480607, "answer_count": 1, "score": 0, "last_activity_date": 1492543531, "creation_date": 1492543531, "question_id": 43480606, "link": "https://stackoverflow.com/questions/43480606/netldap-add-failed-with-no-error-message-how-can-i-find-the-reason-why-the", "title": "Net::LDAP add() failed with no error message. How can I find the reason why the record did not validate?", "body": "<p>I beat myself up for two days as I built a Ruby on Rails application that manages users in LDAP. While fine-tuning the inclusion and formatting of various attributes, I would frequently have <code>ldap.add()</code> fail with little feedback other than possibly an exception raised. I usually knew it was a data validation error, such as a missing required attribute or poorly formatted attribute values -- but I could not find anything on the server (Apache DS) or client end that would indicate <em>which</em> field failed, or <em>why</em> it was failing. </p>\n\n<p>So...how do you see the reason <em>why</em> an LDAP add (or replace, delete, open...) failed?</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 1, "creation_date": 1492544588, "post_id": 43480555, "comment_id": 74017478, "body": "if you say <code>array.delete</code> than check the value of <code>array</code> it will have been modified. However if you use <code>-</code> or <code>find</code> as some answers suggest, you will get a new array as a result and the original will not be modified."}, {"owner": {"reputation": 28716, "user_id": 828193, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/pmNlX.png?s=128&g=1", "display_name": "user000001", "link": "https://stackoverflow.com/users/828193/user000001"}, "reply_to_user": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 0, "creation_date": 1492544770, "post_id": 43480555, "comment_id": 74017609, "body": "@maxple: The example in the <a href=\"https://stackoverflow.com/revisions/43480555/1\">original revision</a> left the structure unmodified"}, {"owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "reply_to_user": {"reputation": 28716, "user_id": 828193, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/pmNlX.png?s=128&g=1", "display_name": "user000001", "link": "https://stackoverflow.com/users/828193/user000001"}, "edited": false, "score": 0, "creation_date": 1492545236, "post_id": 43480555, "comment_id": 74017880, "body": "@user000001 it had <code>delete</code> still."}, {"owner": {"reputation": 28716, "user_id": 828193, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/pmNlX.png?s=128&g=1", "display_name": "user000001", "link": "https://stackoverflow.com/users/828193/user000001"}, "reply_to_user": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 0, "creation_date": 1492545702, "post_id": 43480555, "comment_id": 74018148, "body": "@maxple: True, I should have said that it left <code>event_payload</code> unmodified. I read the <code>tag_load</code> variable as temporary. Your first comment pointing out the difference is still useful though, in case OP (or anyone else) doesn&#39;t see the difference."}, {"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 1, "creation_date": 1492548747, "post_id": 43480555, "comment_id": 74019908, "body": "Please read &quot;<a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a>&quot; and &quot;<a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>&quot; and the linked pages. Your question isn&#39;t clear. Please reread it, and imagine a coworker handed you a sheet of paper with your question printed on it and then walked away. Could you answer the question? What would you want to know? It&#39;s important that all information needed to answer be in the question. When you clarify the question because of a comment then put the information into the question by modifying it and adding the info where you would have put it initially. Don&#39;t use &quot;edit&quot; or &quot;update&quot; tags as we can see what changed."}, {"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 0, "creation_date": 1492548979, "post_id": 43480555, "comment_id": 74020041, "body": "For instance &quot;... and turn it into a string.&quot;? Your values are already strings."}], "answers": [{"tags": [], "owner": {"reputation": 28716, "user_id": 828193, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/pmNlX.png?s=128&g=1", "display_name": "user000001", "link": "https://stackoverflow.com/users/828193/user000001"}, "is_accepted": true, "score": 3, "last_activity_date": 1492544571, "last_edit_date": 1492544571, "creation_date": 1492544249, "answer_id": 43480766, "question_id": 43480555, "link": "https://stackoverflow.com/questions/43480555/whats-an-easier-way-to-break-down-this-array/43480766#43480766", "title": "What&#39;s an easier way to break down this array?", "body": "<p>Use the <code>-</code> operator:</p>\n\n<pre><code>@tag = (array - [\"garden_shop\"]).first\n</code></pre>\n\n<p>Source: <a href=\"https://ruby-doc.org/core-2.2.0/Array.html#method-i-2D\" rel=\"nofollow noreferrer\">https://ruby-doc.org/core-2.2.0/Array.html#method-i-2D</a><br>\nRelated: <a href=\"https://stackoverflow.com/questions/10034678/how-can-i-delete-one-element-from-an-array-by-value\">How can I delete one element from an array by value</a></p>\n"}, {"tags": [], "owner": {"reputation": 12629, "user_id": 4739257, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/MdhEs.jpg?s=128&g=1", "display_name": "Ilya", "link": "https://stackoverflow.com/users/4739257/ilya"}, "is_accepted": false, "score": 3, "last_activity_date": 1492544433, "creation_date": 1492544433, "answer_id": 43480822, "question_id": 43480555, "link": "https://stackoverflow.com/questions/43480555/whats-an-easier-way-to-break-down-this-array/43480822#43480822", "title": "What&#39;s an easier way to break down this array?", "body": "<p>It seems like <code>find</code> is exactly you want: </p>\n\n<pre><code>array.find {|v| v != 'garden_shop'}\n#=&gt; \"some_value\"\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "is_accepted": false, "score": 1, "last_activity_date": 1492550310, "last_edit_date": 1492550310, "creation_date": 1492549711, "answer_id": 43482228, "question_id": 43480555, "link": "https://stackoverflow.com/questions/43480555/whats-an-easier-way-to-break-down-this-array/43482228#43482228", "title": "What&#39;s an easier way to break down this array?", "body": "<p>I'd use:</p>\n\n<pre><code>if array.first == 'garden_shop' \n  array.last \nelse\n  array.first \nend\n# =&gt; \"some_value\"\n</code></pre>\n\n<p>This can also be written more concisely as:</p>\n\n<pre><code>array.first == 'garden_shop' ? array.last : array.first\n# =&gt; \"some_value\"\n</code></pre>\n\n<p>but it sacrifices readability. </p>\n\n<p>This might help:</p>\n\n<pre><code>array = [\"garden_shop\",\"some_value\"]\ncompare do\n  user000001 { (array - [\"garden_shop\"]).first }\n  ilya { array.find {|v| v != 'garden_shop'} }\n  ttm {\n    if array.first == 'garden_shop' \n      array.last \n    else\n      array.first \n    end\n  }\nend\n\n# &gt;&gt; Running each test 32768 times. Test will take about 2 seconds.\n# &gt;&gt; ttm is faster than ilya by 5x \u00b1 1.0\n# &gt;&gt; ilya is similar to user000001\n</code></pre>\n\n<p>And, just for thoroughness:</p>\n\n<pre><code>compare do\n  ttm1 { array.first == 'garden_shop' ? array.last : array.first }\n  ttm2 {\n    if array.first == 'garden_shop' \n      array.last \n    else\n      array.first \n    end\n  }\nend\n# &gt;&gt; Running each test 32768 times. Test will take about 1 second.\n# &gt;&gt; ttm1 is similar to ttm2\n</code></pre>\n"}], "owner": {"reputation": 44, "user_id": 7863484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e57a73e4af37d9b9a6cc19ec0c2d1fb9?s=128&d=identicon&r=PG", "display_name": "lunchableavenger", "link": "https://stackoverflow.com/users/7863484/lunchableavenger"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 83, "favorite_count": 0, "accepted_answer_id": 43480766, "answer_count": 3, "score": -1, "last_activity_date": 1492586703, "creation_date": 1492543331, "last_edit_date": 1492549291, "question_id": 43480555, "link": "https://stackoverflow.com/questions/43480555/whats-an-easier-way-to-break-down-this-array", "title": "What&#39;s an easier way to break down this array?", "body": "<p>I have an array of two values in a random order.\nI want to find what the other value is and turn it into a string.</p>\n\n<p>This is what I currently have in Ruby, but I'm trying to clean it up and make it more concise.</p>\n\n<pre><code> array = [\"garden_shop\",\"some_value\"]\n tag = array.delete(\"garden_shop\")\n @tag = tag.first\n</code></pre>\n\n<p>Which should result in: </p>\n\n<pre><code>@tag = \"some_value\"\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "activerecord", "eager-loading", "bullet"], "comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 1, "creation_date": 1492542507, "post_id": 43479600, "comment_id": 74016279, "body": "Normally this refers to something iterating over a list of those things and calling <code>tickets?</code> on each one. That code is not shown but presumably you have a list of mulitiple...whatever these are."}, {"owner": {"reputation": 3997, "user_id": 3998420, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/55ea542584d3fd2a430c3d409bdafc95?s=128&d=identicon&r=PG&f=1", "display_name": "bkunzi01", "link": "https://stackoverflow.com/users/3998420/bkunzi01"}, "edited": false, "score": 1, "creation_date": 1492542984, "post_id": 43479600, "comment_id": 74016567, "body": "Look at your logs!  When you see the database being hit many times for one request you probably have an N+1 situation.  You can use eager loading to instead hit the db just once to grab the associated table and then load the records."}, {"owner": {"reputation": 16229, "user_id": 525478, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/3b6c0b47a0c430a0b141baee7ea845be?s=128&d=identicon&r=PG", "display_name": "Brad Werth", "link": "https://stackoverflow.com/users/525478/brad-werth"}, "edited": false, "score": 1, "creation_date": 1492549025, "post_id": 43479600, "comment_id": 74020076, "body": "When I see questions like this, I feel obliged to link to this answer: <a href=\"http://stackoverflow.com/a/26251892/525478\">stackoverflow.com/a/26251892/525478</a>. YMMV"}], "answers": [{"tags": [], "owner": {"reputation": 14087, "user_id": 1544012, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bbaed9ca8e4320fd64d1989c0e0f488b?s=128&d=identicon&r=PG", "display_name": "BoraMa", "link": "https://stackoverflow.com/users/1544012/borama"}, "is_accepted": true, "score": 5, "last_activity_date": 1492542686, "creation_date": 1492542686, "answer_id": 43480395, "question_id": 43479600, "link": "https://stackoverflow.com/questions/43479600/implement-eager-loading-to-stop-n1-rails/43480395#43480395", "title": "Implement eager loading to stop N+1 - Rails", "body": "<p>Bullet points you to the place where it <em>detected multiple calls</em> of the same association, <strong>not</strong> to the place where you should add eager loading. </p>\n\n<p>Somewhere in the <code>_list.html.erb</code> template you probably traverse your RSVPs (whatever that is) and for each RSVP you are trying to determine whether it has any ticket or not by calling the <code>tickets</code> association.</p>\n\n<p>Bullet advices you to add <code>include(:tickets)</code> <strong>to the finder which sets up the variable for RSVPs</strong> (probably somewhere in your AcceptedRSVPs controller) that you traverse in the template. Once that is done, there won't be an SQL run for each RSVP to find out its tickets and thus you'll get rid of the N+1 problem.</p>\n"}], "owner": {"reputation": 6503, "user_id": 5650878, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/xh7BI.png?s=128&g=1", "display_name": "Bitwise", "link": "https://stackoverflow.com/users/5650878/bitwise"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1438, "favorite_count": 0, "accepted_answer_id": 43480395, "answer_count": 1, "score": 2, "last_activity_date": 1492547724, "creation_date": 1492539901, "last_edit_date": 1492547724, "question_id": 43479600, "link": "https://stackoverflow.com/questions/43479600/implement-eager-loading-to-stop-n1-rails", "title": "Implement eager loading to stop N+1 - Rails", "body": "<p>I currently have a page that takes 11 seconds to load. I'm using the Bullet Gem to help me find where the N+1 query is happening. Its giving my some output but I really don't know what to do with it. Here is the output from Bullet:</p>\n\n<pre><code>GET /events/1679/dashboard\nUSE eager loading detected\n  RSVP =&gt; [:tickets]\n  Add to your finder: :includes =&gt; [:tickets]\nCall stack\n  /Users/cameronbass/Desktop/Work/blackbird-rsvp/app/decorators/rsvp_decorator.rb:54:in `tickets?'\n  /Users/cameronbass/Desktop/Work/blackbird-rsvp/app/views/accepted_rsvps/_list.html.erb:33:in `block in _app_views_accepted_rsvps__list_html_erb___1211423417683052584_70339569780320'\n</code></pre>\n\n<p>And it's telling me to put it on this line</p>\n\n<pre><code>def tickets?\n  rsvp.tickets.any?\nend\n</code></pre>\n\n<p>Here is the association:</p>\n\n<pre><code>has_many :tickets, through: :attendees\n</code></pre>\n\n<p>attendee.rb</p>\n\n<pre><code>has_one :ticket\n</code></pre>\n"}, {"tags": ["arrays", "ruby", "pack", "unpack"], "answers": [{"tags": [], "owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "is_accepted": false, "score": 3, "last_activity_date": 1492540588, "creation_date": 1492540588, "answer_id": 43479782, "question_id": 43479598, "link": "https://stackoverflow.com/questions/43479598/packing-to-byte-string-using-c-directive-in-ruby/43479782#43479782", "title": "packing to byte string using (&quot;C&quot;) directive in Ruby", "body": "<p>Why would it return <code>\"\\x21\"</code>? The <code>\\x</code> notation is reserved for non-printable characters, but since <code>\\x21</code> is equivalent to <code>!</code> then that's what's displayed.</p>\n\n<p>The <code>inspect</code> version of a string is generally the most <em>readable</em> version of it, not the most literal.</p>\n\n<p>Likewise:</p>\n\n<pre><code>\"!\".ord\n# =&gt; 33\n\"\\x21\".ord\n# =&gt; 33\n\"\\x21\".ord.to_s(16)\n# =&gt; \"21\"\n33.chr\n# =&gt; \"!\"\n</code></pre>\n\n<p>There's a number of special characters <a href=\"https://ruby-doc.org/core-2.4.1/doc/syntax/literals_rdoc.html\" rel=\"nofollow noreferrer\">documented in the Strings section</a>:</p>\n\n<pre><code>\\a             bell, ASCII 07h (BEL)\n\\b             backspace, ASCII 08h (BS)\n\\t             horizontal tab, ASCII 09h (TAB)\n\\n             newline (line feed), ASCII 0Ah (LF)\n\\v             vertical tab, ASCII 0Bh (VT)\n\\f             form feed, ASCII 0Ch (FF)\n\\r             carriage return, ASCII 0Dh (CR)\n\\e             escape, ASCII 1Bh (ESC)\n\\s             space, ASCII 20h (SPC)\n\\\\             backslash, \\\n\\nnn           octal bit pattern, where nnn is 1-3 octal digits ([0-7])\n\\xnn           hexadecimal bit pattern, where nn is 1-2 hexadecimal digits ([0-9a-fA-F])\n\\unnnn         Unicode character, where nnnn is exactly 4 hexadecimal digits ([0-9a-fA-F])\n\\u{nnnn ...}   Unicode character(s), where each nnnn is 1-6 hexadecimal digits ([0-9a-fA-F])\n\\cx or \\C-x    control character, where x is an ASCII printable character\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 45322, "user_id": 421705, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/581b1760881c962648f99d6040d41829?s=128&d=identicon&r=PG", "display_name": "Holger Just", "link": "https://stackoverflow.com/users/421705/holger-just"}, "is_accepted": false, "score": 2, "last_activity_date": 1492540625, "creation_date": 1492540625, "answer_id": 43479794, "question_id": 43479598, "link": "https://stackoverflow.com/questions/43479598/packing-to-byte-string-using-c-directive-in-ruby/43479794#43479794", "title": "packing to byte string using (&quot;C&quot;) directive in Ruby", "body": "<p>These strings are fully equivalent, they are just different representation if exactly the same bytes:</p>\n\n<pre><code>\"\\a\" == \"\\x07\"\n# =&gt; true\n\n\"\\x21\" == \"!\"\n# =&gt; true\n</code></pre>\n\n<p>If you have a look at <a href=\"http://www.asciitable.com/\" rel=\"nofollow noreferrer\">the ASCII table</a>, you'll see that the hex 21 (decimal 33) is represented by the exclamation mark character. Similarly, the hex 7 (and decimal 7) character is represented by a control character called BEL (bell) which us usually represented as <code>\"\\a\"</code>.</p>\n\n<p>In general, Ruby choses the most generic representation of strings when printing them. There will always be other (equivalent) representations you can use in your code. However, the will always map back to the exact same bytes in memory.</p>\n"}], "owner": {"reputation": 119, "user_id": 2849029, "user_type": "registered", "accept_rate": 0, "profile_image": "https://graph.facebook.com/505400089/picture?type=large", "display_name": "Josh Kestenberg", "link": "https://stackoverflow.com/users/2849029/josh-kestenberg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 474, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1608624176, "creation_date": 1492539896, "last_edit_date": 1608624176, "question_id": 43479598, "link": "https://stackoverflow.com/questions/43479598/packing-to-byte-string-using-c-directive-in-ruby", "title": "packing to byte string using (&quot;C&quot;) directive in Ruby", "body": "<p>I'm trying to pack a byte array into a string using <code>array.pack(\"C\")</code> but I'm getting some weird values pack. For example, when I say <code>[7].pack(\"C\")</code>, the return value is <code>\"\\a\"</code>, whereas when I say  <code>\"\\x07\".unpack(\"C\")</code>, the return value is <code>[7]</code>, which is the desired behavior. </p>\n\n<p><code>[6].pack(\"C\")</code> for example returns <code>\"\\x06\"</code>, again the desired outcome, whereas <code>[33].pack(\"C\")</code> returns <code>\"!\"</code>.</p>\n\n<p>I'm new to bytes and hex in general. What is happening here? In my understanding, <code>[33].pack(\"C\")</code> should return <code>\"\\x21\"</code>.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "docker", "rspec", "webmock"], "comments": [{"owner": {"reputation": 4426, "user_id": 5300329, "user_type": "registered", "accept_rate": 85, "profile_image": "https://lh3.googleusercontent.com/-ED2Y0YdnPoU/AAAAAAAAAAI/AAAAAAAAARY/inM3zvRnhsU/photo.jpg?sz=128", "display_name": "OscarAkaElvis", "link": "https://stackoverflow.com/users/5300329/oscarakaelvis"}, "edited": false, "score": 0, "creation_date": 1492541924, "post_id": 43479492, "comment_id": 74015924, "body": "In your Dockerfile you must put <code>EXPOSE xx</code> where xx is the port you want to expose to other containers"}, {"owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 0, "creation_date": 1492544758, "post_id": 43479492, "comment_id": 74017597, "body": "In addition to Docker config you would have to tell rspec to allow the HTTP requests. See the &quot;Real requests to network can be allowed or disabled&quot; section on the <a href=\"https://github.com/bblimke/webmock\" rel=\"nofollow noreferrer\">webmock readme</a>. By the way, the reason HTTP requests are often disabled/mocked in tests is that it makes the tests run faster."}], "owner": {"reputation": 2362, "user_id": 1459901, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Uc6uH.jpg?s=128&g=1", "display_name": "Cisplatin", "link": "https://stackoverflow.com/users/1459901/cisplatin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 516, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1492539541, "creation_date": 1492539541, "question_id": 43479492, "link": "https://stackoverflow.com/questions/43479492/how-to-allow-http-requests-to-other-docker-containers-with-rspec", "title": "How to allow HTTP requests to other docker containers with RSpec?", "body": "<p>I have a docker project with a few different moving parts, and I want one container to be able to call the API of another container.</p>\n\n<p>However, sending any kind of request in my rspec tests yields:</p>\n\n<blockquote>\n  <p>WebMock::NetConnectNotAllowedError: Real HTTP connections are\n  disabled. Unregistered request: ...</p>\n</blockquote>\n\n<p>How can I allow it to call the other container?</p>\n"}, {"tags": ["ruby", "rufus-scheduler"], "answers": [{"tags": [], "owner": {"reputation": 3437, "user_id": 10762, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8d96626e52beb1ff90f57a8e189e1e6f?s=128&d=identicon&r=PG", "display_name": "jmettraux", "link": "https://stackoverflow.com/users/10762/jmettraux"}, "is_accepted": false, "score": 4, "last_activity_date": 1492547135, "last_edit_date": 1492547135, "creation_date": 1492544390, "answer_id": 43480811, "question_id": 43479264, "link": "https://stackoverflow.com/questions/43479264/how-to-schedule-daily-job-using-rufus-scheduler/43480811#43480811", "title": "How to schedule daily job using Rufus Scheduler", "body": "<blockquote>\n  <p>Is this a correct way doing it ?</p>\n</blockquote>\n\n<p>Yes, it is a correct way of doing it.</p>\n\n<blockquote>\n  <p>Or should I create a cron job ?</p>\n</blockquote>\n\n<p>It depends on what you are building.</p>\n\n<p>Doing</p>\n\n<pre><code>scheduler.every '1d' do\n  # ...\nend\n</code></pre>\n\n<p>will schedule now and then again in now + 24 * 3600 seconds and then again in now + 2 * 24 * 3600 seconds...</p>\n\n<p>Doing</p>\n\n<pre><code>scheduler.cron '0 2 * * *' do\n  # ...\nend\n</code></pre>\n\n<p>will schedule every day at 2am.</p>\n\n<p>Some people prefer the certainty of having some admin jobs run while the system is less busy (hence my example choice of 2am).</p>\n\n<p>The rufus-scheduler documentation is explaining both and trusting you to choose the one that fits your requirements.</p>\n"}], "owner": {"reputation": 1117, "user_id": 470835, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/FDagI.jpg?s=128&g=1", "display_name": "Saurabh Saxena", "link": "https://stackoverflow.com/users/470835/saurabh-saxena"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2344, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1505118236, "creation_date": 1492538621, "last_edit_date": 1505118236, "question_id": 43479264, "link": "https://stackoverflow.com/questions/43479264/how-to-schedule-daily-job-using-rufus-scheduler", "title": "How to schedule daily job using Rufus Scheduler", "body": "<p>I am trying to schedule a daily job using Rufus Scheduler.\nIs this a correct way doing it? </p>\n\n<pre><code>require 'rufus-scheduler'\n\nscheduler = Rufus::Scheduler.new\n\nscheduler.every '1d' do\n  # Daily job code\nend\n</code></pre>\n\n<p>Or should I create a cron job ? \nCannot find anything in Rufus documentation. </p>\n"}, {"tags": ["ruby-on-rails", "ruby", "model-view-controller", "routes"], "comments": [{"owner": {"reputation": 2116, "user_id": 6780663, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9207ba3b9163582570078b687f9b2792?s=128&d=identicon&r=PG&f=1", "display_name": "Alejandro Montilla", "link": "https://stackoverflow.com/users/6780663/alejandro-montilla"}, "edited": false, "score": 0, "creation_date": 1492538840, "post_id": 43479259, "comment_id": 74013969, "body": "To what view do you want to link? Please run <code>rake routes</code> and post the output."}, {"owner": {"reputation": 3997, "user_id": 3998420, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/55ea542584d3fd2a430c3d409bdafc95?s=128&d=identicon&r=PG&f=1", "display_name": "bkunzi01", "link": "https://stackoverflow.com/users/3998420/bkunzi01"}, "edited": false, "score": 0, "creation_date": 1492539123, "post_id": 43479259, "comment_id": 74014177, "body": "All your routes are &quot;get&quot; requests.  You need to add a route, that will &quot;post&quot; the data from the form to a controller and action you&#39;re looking to process it in.  For ex.  post &#39;input_output/SignUp&#39;"}, {"owner": {"reputation": 159, "user_id": 6090227, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh4.googleusercontent.com/-BSkQ2-EmWyw/AAAAAAAAAAI/AAAAAAAABC4/ZBDdVA1dosQ/photo.jpg?sz=128", "display_name": "sindhugauri", "link": "https://stackoverflow.com/users/6090227/sindhugauri"}, "reply_to_user": {"reputation": 2116, "user_id": 6780663, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9207ba3b9163582570078b687f9b2792?s=128&d=identicon&r=PG&f=1", "display_name": "Alejandro Montilla", "link": "https://stackoverflow.com/users/6780663/alejandro-montilla"}, "edited": false, "score": 0, "creation_date": 1492539793, "post_id": 43479259, "comment_id": 74014620, "body": "@AlejandroMontilla I want to link it to the view called &#39;micropost&#39; which is part of the controller called InputOutput which also contains the Sign Up page and Login page."}, {"owner": {"reputation": 159, "user_id": 6090227, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh4.googleusercontent.com/-BSkQ2-EmWyw/AAAAAAAAAAI/AAAAAAAABC4/ZBDdVA1dosQ/photo.jpg?sz=128", "display_name": "sindhugauri", "link": "https://stackoverflow.com/users/6090227/sindhugauri"}, "reply_to_user": {"reputation": 3997, "user_id": 3998420, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/55ea542584d3fd2a430c3d409bdafc95?s=128&d=identicon&r=PG&f=1", "display_name": "bkunzi01", "link": "https://stackoverflow.com/users/3998420/bkunzi01"}, "edited": false, "score": 0, "creation_date": 1492540049, "post_id": 43479259, "comment_id": 74014784, "body": "@bkunzi01 I&#39;m not quite sure what the exact format of the &quot;post&quot; route should be. As stated in the previous comment, the view that I want the button to direct to is called &quot;micropost&quot;. So how should I be framing this?"}, {"owner": {"reputation": 3997, "user_id": 3998420, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/55ea542584d3fd2a430c3d409bdafc95?s=128&d=identicon&r=PG&f=1", "display_name": "bkunzi01", "link": "https://stackoverflow.com/users/3998420/bkunzi01"}, "edited": false, "score": 0, "creation_date": 1492540219, "post_id": 43479259, "comment_id": 74014885, "body": "What is the name of the controller and the controller&#39;s action that point to this view?  All Rails views are associated to a controller and an action within that controller.  Tell us that and we can give you the route.  I&#39;d highly recommend some tutorials on Rails Routing."}, {"owner": {"reputation": 2116, "user_id": 6780663, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9207ba3b9163582570078b687f9b2792?s=128&d=identicon&r=PG&f=1", "display_name": "Alejandro Montilla", "link": "https://stackoverflow.com/users/6780663/alejandro-montilla"}, "reply_to_user": {"reputation": 3997, "user_id": 3998420, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/55ea542584d3fd2a430c3d409bdafc95?s=128&d=identicon&r=PG&f=1", "display_name": "bkunzi01", "link": "https://stackoverflow.com/users/3998420/bkunzi01"}, "edited": false, "score": 0, "creation_date": 1492540255, "post_id": 43479259, "comment_id": 74014907, "body": "@bkunzi01 is rigth, you need to add something like <code>post &#39;&#47;micropost&#39; =&gt; &quot;input_output#micropost&quot;</code> to your route file."}, {"owner": {"reputation": 159, "user_id": 6090227, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh4.googleusercontent.com/-BSkQ2-EmWyw/AAAAAAAAAAI/AAAAAAAABC4/ZBDdVA1dosQ/photo.jpg?sz=128", "display_name": "sindhugauri", "link": "https://stackoverflow.com/users/6090227/sindhugauri"}, "reply_to_user": {"reputation": 2116, "user_id": 6780663, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9207ba3b9163582570078b687f9b2792?s=128&d=identicon&r=PG&f=1", "display_name": "Alejandro Montilla", "link": "https://stackoverflow.com/users/6780663/alejandro-montilla"}, "edited": false, "score": 0, "creation_date": 1492541162, "post_id": 43479259, "comment_id": 74015451, "body": "@AlejandroMontilla the error after adding that to the route file is the same as before : <b>No route matches [POST] &quot;/input_output/SignUp&quot;</b>"}, {"owner": {"reputation": 159, "user_id": 6090227, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh4.googleusercontent.com/-BSkQ2-EmWyw/AAAAAAAAAAI/AAAAAAAABC4/ZBDdVA1dosQ/photo.jpg?sz=128", "display_name": "sindhugauri", "link": "https://stackoverflow.com/users/6090227/sindhugauri"}, "reply_to_user": {"reputation": 3997, "user_id": 3998420, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/55ea542584d3fd2a430c3d409bdafc95?s=128&d=identicon&r=PG&f=1", "display_name": "bkunzi01", "link": "https://stackoverflow.com/users/3998420/bkunzi01"}, "edited": false, "score": 0, "creation_date": 1492541283, "post_id": 43479259, "comment_id": 74015528, "body": "@bkunzi01 the name of the controller is InputOutput. It&#39;s actions are SignUp, Login and micropost. If you can recommend any rails routing tutorials, I would be grateful because my brain is far too scattered right now and I feel as if I&#39;m all over the place."}], "answers": [{"tags": [], "owner": {"reputation": 2186, "user_id": 4005809, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/oLzhL.jpg?s=128&g=1", "display_name": "Steve Carey", "link": "https://stackoverflow.com/users/4005809/steve-carey"}, "is_accepted": false, "score": 0, "last_activity_date": 1492543306, "last_edit_date": 1492543306, "creation_date": 1492542611, "answer_id": 43480374, "question_id": 43479259, "link": "https://stackoverflow.com/questions/43479259/redirect-button-to-view-in-ruby-on-rails/43480374#43480374", "title": "Redirect button to view in Ruby on Rails", "body": "<p>This is pretty simple. Instead of </p>\n\n<pre><code>&lt;%= button_to \"View profile\", input_output_micropost_path%&gt;\n</code></pre>\n\n<p>Make that a submit</p>\n\n<pre><code>&lt;%= f.submit \"Sign up\", class: \"btn btn-default\" %&gt;\n</code></pre>\n\n<p>Then in your controller in the create action add a redirect at the end. Something like this</p>\n\n<pre><code>def create\n  @user = User.new(user_params)\n  if @user.save\n    redirect_to input_output_micropost_path, notice: 'User was successfully created.'\n  else\n    render :new\n  end\nend\n</code></pre>\n\n<p>Edit:\nYou need RESTful routes for your user model. If you are putting that under the input_output namespace it would be something like this</p>\n\n<pre><code>resources :input_outputs do\n  resources :users\nend\n</code></pre>\n\n<p>I recommend the Rails Tutorial book by Michael Hardt. It shows how to do something like this in very good detail. It's a classic.</p>\n"}, {"tags": [], "owner": {"reputation": 38, "user_id": 1018532, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MMH5H.jpg?s=128&g=1", "display_name": "MarioV", "link": "https://stackoverflow.com/users/1018532/mariov"}, "is_accepted": false, "score": 0, "last_activity_date": 1492544380, "creation_date": 1492544380, "answer_id": 43480806, "question_id": 43479259, "link": "https://stackoverflow.com/questions/43479259/redirect-button-to-view-in-ruby-on-rails/43480806#43480806", "title": "Redirect button to view in Ruby on Rails", "body": "<p>The top part of your routes are wrong, the route must point to a controller and action inside the controller, so the routes should be something like:</p>\n\n<pre>\n   root to: 'static_pages#home'\n   get '/genre', to: 'static_pages#genre' \n   get '/accessories', to: 'static_pages#accessories'\n   get '/aboutus', to: 'static_pages#aboutus'\n   get '/contactus', to: 'static_pages#contactus'\n\n   get '/Home', to: 'static_pages#home'\n   get '/Login', to: 'input_output#Login' \n   get '/micropost', to: 'input_output#micropost'\n   get '/SignUp', to: 'input_output#SignUp'\n   get '/Home', to: 'static_pages#home'\n   get '/Login', to: 'input_output#Login' \n   get '/micropost', to: 'input_output#micropost'\n  ##################################################\n  #### Action for the form is set as post, so signup\n  #### must be a post route\n  ##################################################\n   post '/SignUp', to: 'input_output#SignUp'\n</pre>\n"}], "owner": {"reputation": 159, "user_id": 6090227, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh4.googleusercontent.com/-BSkQ2-EmWyw/AAAAAAAAAAI/AAAAAAAABC4/ZBDdVA1dosQ/photo.jpg?sz=128", "display_name": "sindhugauri", "link": "https://stackoverflow.com/users/6090227/sindhugauri"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1916, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1492544380, "creation_date": 1492538610, "last_edit_date": 1492539966, "question_id": 43479259, "link": "https://stackoverflow.com/questions/43479259/redirect-button-to-view-in-ruby-on-rails", "title": "Redirect button to view in Ruby on Rails", "body": "<p>I have a login and a signup page. I want that after clicking on the login or signup button, the user is redirected to another view which will be a micropost.</p>\n\n<p>The code for the signup page is as follows. (as in the form part) - </p>\n\n<pre><code>   &lt;h2 class=\"text-center\"&gt;Sign Up&lt;/h2&gt;\n                &lt;%= form_for(input_output_SignUp_url) do |f| %&gt; \n                &lt;%= f.label :first_name,\"First name:\" %&gt;\n                &lt;%= f.text_field :first_name %&gt;\n\n                &lt;%= f.label :last_name,\"Last name:\" %&gt;\n                &lt;%=f.text_field :last_name %&gt;\n\n                &lt;%= f.label :email,\"Email:\" %&gt;\n                &lt;%= f.email_field :email %&gt;\n\n                &lt;%= f.label :phone,\"Phone no:\"%&gt;\n                &lt;%= f.text_field :phone %&gt;\n\n                &lt;%= f.label :city,\"City:\" %&gt;\n                &lt;%= f.text_field :city %&gt;\n\n                &lt;%= f.label :addr_1,\"Address 1:\" %&gt;\n                &lt;%=f.text_field :addr_1 %&gt;\n\n                &lt;%= f.label :addr_2,\"Address 2:\" %&gt;\n                &lt;%= f.text_field :addr_2 %&gt;\n\n                &lt;%= f.label :state,\"State:\"%&gt;\n                &lt;%= f.text_field :state %&gt;\n\n                &lt;%= f.label :postal_code,\"Postal Code:\"%&gt;\n                &lt;%= f.text_field :postal_code %&gt;\n\n                &lt;%= f.label :password,\"Password:\"%&gt;\n                &lt;%= f.password_field :password %&gt;\n\n                &lt;%= f.label :password_confirmation, \"Confirmation:\" %&gt;\n                &lt;%= f.password_field :password_confirmation, class: 'form-control' %&gt;\n\n                &lt;%= button_to \"View profile\", input_output_micropost_path%&gt;\n            &lt;% end %&gt;\n</code></pre>\n\n<p>Now this isn't working. When I click on the button, it shows an error- <strong>No route matches [POST] \"/input_output/SignUp\"</strong></p>\n\n<p>The routes file is as follows:-</p>\n\n<pre><code>   root 'static_pages#home'\n\n   get 'static_pages/home'\n   get 'static_pages/genre'\n   get 'static_pages/accessories'\n   get 'static_pages/contactus'\n   get 'static_pages/aboutus'\n\n   get 'input_output/Login'\n   get 'input_output/SignUp'\n   get 'input_output/micropost'\n\n   get '/genre', to: 'static_pages#genre' \n   get '/accessories', to: 'static_pages#accessories'\n   get '/aboutus', to: 'static_pages#aboutus'\n   get 'contactus', to: 'static_pages#contactus'\n\n   get 'Home', to: 'static_pages#home'\n   get '/Login', to: 'input_output#Login' \n   get '/micropost', to: 'input_output#micropost'\n   get '/SignUp', to: 'input_output#SignUp'\nend\n</code></pre>\n\n<p>How can I make this error go away?</p>\n\n<p>Edit:- As asked, this is the result of <em>rake routes</em>\n/home/gauri/.rbenv/versions/2.4.0/lib/ruby/gems/2.4.0/gems/activesupport-5.0.1/lib/active_support/xml_mini.rb:51: warning: constant ::Fixnum is deprecated</p>\n\n<p>/home/gauri/.rbenv/versions/2.4.0/lib/ruby/gems/2.4.0/gems/activesupport-5.0.1/lib/active_support/xml_mini.rb:52: warning: constant ::Bignum is deprecated</p>\n\n<p>/home/gauri/.rbenv/versions/2.4.0/lib/ruby/gems/2.4.0/gems/activesupport-5.0.1/lib/active_support/core_ext/numeric/conversions.rb:138: warning: constant ::Fixnum is deprecated</p>\n\n<p>rake aborted!</p>\n\n<p>ArgumentError: Missing :controller key on routes definition, please check your routes.</p>\n\n<p>/home/gauri/Academics/CS/Ruby on Rails/ScholarShip/ScholarShip/config/routes.rb:25:in `block in '</p>\n\n<p>/home/gauri/Academics/CS/Ruby on Rails/ScholarShip/ScholarShip/config/routes.rb:1:in `'</p>\n\n<p>/home/gauri/Academics/CS/Ruby on Rails/ScholarShip/ScholarShip/config/environment.rb:5:in `'</p>\n\n<p>Tasks: TOP => routes => environment</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "rspec", "ruby-on-rails-5", "factory-bot"], "comments": [{"owner": {"reputation": 3439, "user_id": 5665799, "user_type": "registered", "accept_rate": 59, "profile_image": "https://i.stack.imgur.com/YOrLl.jpg?s=128&g=1", "display_name": "Kieran E", "link": "https://stackoverflow.com/users/5665799/kieran-e"}, "edited": false, "score": 0, "creation_date": 1492548149, "post_id": 43479231, "comment_id": 74019557, "body": "In your <code>after(:create)</code> block, you look for a role.  But have you verified that the role exists? <code>find_by</code> will pass nil and not throw an error if a record isn&#39;t found.  It&#39;s equivalent to <code>where(&lt;criteria&gt;).first</code>"}, {"owner": {"reputation": 3439, "user_id": 5665799, "user_type": "registered", "accept_rate": 59, "profile_image": "https://i.stack.imgur.com/YOrLl.jpg?s=128&g=1", "display_name": "Kieran E", "link": "https://stackoverflow.com/users/5665799/kieran-e"}, "edited": false, "score": 0, "creation_date": 1492548225, "post_id": 43479231, "comment_id": 74019603, "body": "Also, just as a heads up, look into <code>byebug</code> for stuff like this.  If you&#39;ve never used it, it&#39;s a fantastic debugging tool"}, {"owner": {"reputation": 1, "user_id": 7885488, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3LHUu.jpg?s=128&g=1", "display_name": "DCCAKES", "link": "https://stackoverflow.com/users/7885488/dccakes"}, "reply_to_user": {"reputation": 3439, "user_id": 5665799, "user_type": "registered", "accept_rate": 59, "profile_image": "https://i.stack.imgur.com/YOrLl.jpg?s=128&g=1", "display_name": "Kieran E", "link": "https://stackoverflow.com/users/5665799/kieran-e"}, "edited": false, "score": 0, "creation_date": 1493062466, "post_id": 43479231, "comment_id": 74242727, "body": "got it sorted! Thanks!"}, {"owner": {"reputation": 8754, "user_id": 6719819, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/HmF9I.jpg?s=128&g=1", "display_name": "Daniel", "link": "https://stackoverflow.com/users/6719819/daniel"}, "edited": false, "score": 1, "creation_date": 1512833899, "post_id": 43479231, "comment_id": 82420880, "body": "It would help if you posted what you got sorted out as the answer so that it can serve future users. Remember, this is not just for you, the purpose of posting questions is also to help others. Additionally, I was going to suggest you need to set up each user in your factory as a separate block, you seem to have all your :user and :admin_user in the same do block."}], "owner": {"reputation": 1, "user_id": 7885488, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3LHUu.jpg?s=128&g=1", "display_name": "DCCAKES", "link": "https://stackoverflow.com/users/7885488/dccakes"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 186, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1492538534, "creation_date": 1492538534, "question_id": 43479231, "link": "https://stackoverflow.com/questions/43479231/factory-girl-rspec-issue-has-many-through-factory", "title": "Factory Girl rspec issue: has_many through factory", "body": "<p>I am having an issue regarding Factory Girl in Rails. I currently have pundit setup  am trying to test my user policies yet the factory does not seem to work when in rspec. </p>\n\n<p>Inside the rails console, I can load up the console and type:</p>\n\n<pre><code>    user=FactoryGirl.create(:admin_user)\n    r=user.roles\n</code></pre>\n\n<p>This works correctly creates a user and the correct associations between a user and a role. However, when the factory is used in rspec- A user is created but not the associated assignment. (I discovered this by using 'pp' inside the specific tests.)  </p>\n\n<p>I do not need to create a role, since the roles are set so I am looking them up. </p>\n\n<p>Any ideas? </p>\n\n<h1>Models</h1>\n\n<pre><code>    class User &lt; ApplicationRecord\n     has_many :assignments, dependent: :destroy\n     has_many :roles, through: :assignments, dependent: :destroy\n\n      def has_role?(roles)\n        roles.each do |role|\n          if self.roles.include? role\n            return true\n          end\n        end\n\n        false\n      end\n\n    class Role &lt; ApplicationRecord\n      # Associations\n      has_many :assignments\n      has_many :users, through: :assignments\n\n    class Assignment &lt; ApplicationRecord\n      # Associations\n      belongs_to :user\n      belongs_to :role\n</code></pre>\n\n<h1>Factories</h1>\n\n<pre><code>    FactoryGirl.define do\n      factory :user do\n        first_name  {Faker::Name.first_name}\n        last_name   {Faker::Name.last_name}\n        email       {Faker::Internet.email}\n        password    {Faker::Internet.password(8)}\n\n          factory :admin_user do\n                after(:create) do |user|\n                Assignment.create(user: user , role: Role.find_by(label:'System Admin') )\n            end\n          end\n\n      end\n    end\n</code></pre>\n\n<h1>Tests</h1>\n\n<h2>User Policy Test</h2>\n\n<pre><code>    describe UserPolicy do\n      subject { UserPolicy }\n\n       let (:current_user) { FactoryGirl.build_stubbed :user}\n       let (:other_user) { FactoryGirl.build_stubbed :user }\n       let (:admin) { FactoryGirl.build_stubbed :admin_user}\n\n\n      permissions :index? do\n        it \"denies access if not an admin\" do\n          expect(UserPolicy).not_to permit(current_user)\n        end\n        it \"allows access for an admin\" do\n          expect(UserPolicy).to permit(admin)\n        end\n      end\n    end\n</code></pre>\n\n<h2>Other Test With same Issue</h2>\n\n<pre><code>    feature 'User index page', :devise do\n\n      after(:each) do\n        Warden.test_reset!\n      end\n\n      scenario 'user sees own email address' do\n        user = FactoryGirl.create(:admin_user)\n        expect(user.has_role?(Role.where(label: 'System Admin'))).to eq true\n        login_as(user, scope: :user)\n        visit users_path\n        expect(page).to have_content user.email\n      end\n\n    end\n</code></pre>\n\n<p>This test fails since the user has no role assigned. </p>\n\n<h1>Controller</h1>\n\n<pre><code>    class AssignmentsController &lt; ApplicationController\n      def create\n        @assignment = Assignment.new(assignment_params)\n        if @assignment.save\n          redirect_to users_path(), :notice =&gt; \"Role Added\"\n        else\n          flash[:alert]=\"Unable to Add Role\"\n        end\n      end\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "atom-editor", "rubocop", "linter"], "comments": [{"owner": {"reputation": 5074, "user_id": 4207394, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/mmfTf.png?s=128&g=1", "display_name": "Deep", "link": "https://stackoverflow.com/users/4207394/deep"}, "edited": false, "score": 0, "creation_date": 1492538657, "post_id": 43479200, "comment_id": 74013849, "body": "Did you add the gem rubocop in your application?"}, {"owner": {"reputation": 85, "user_id": 6510821, "user_type": "registered", "profile_image": "https://graph.facebook.com/1710425042554788/picture?type=large", "display_name": "Alexandr  Kurilovich", "link": "https://stackoverflow.com/users/6510821/alexandr-kurilovich"}, "reply_to_user": {"reputation": 5074, "user_id": 4207394, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/mmfTf.png?s=128&g=1", "display_name": "Deep", "link": "https://stackoverflow.com/users/4207394/deep"}, "edited": false, "score": 2, "creation_date": 1492538880, "post_id": 43479200, "comment_id": 74014002, "body": "i just did this <code>gem install rubocop</code>"}, {"owner": {"reputation": 12661, "user_id": 5343387, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/15a14cec3014822297a08ed6dfae2563?s=128&d=identicon&r=PG&f=1", "display_name": "Matt Schuchard", "link": "https://stackoverflow.com/users/5343387/matt-schuchard"}, "edited": false, "score": 0, "creation_date": 1492540558, "post_id": 43479200, "comment_id": 74015091, "body": "Sounds like a botched install."}], "answers": [{"comments": [{"owner": {"reputation": 353, "user_id": 1767058, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/zouzw.png?s=128&g=1", "display_name": "JCC", "link": "https://stackoverflow.com/users/1767058/jcc"}, "edited": false, "score": 1, "creation_date": 1562539952, "post_id": 44844931, "comment_id": 100394920, "body": "@rpbaltazar The problem with this solution is that you&#39;re locked into the Ruby version. Is there a solution that would allow any rvm ruby versions to use the same rubocop binary? That way, you don&#39;t ever need to set a specific path in the linter. It seems that the default path that the linter looks in is /usr/local/bin/rubocop? Perhaps installing it there somehow or syslink?"}, {"owner": {"reputation": 781, "user_id": 2893397, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a5d7ff72c038139fe1b4d0e78a3e8e08?s=128&d=identicon&r=PG", "display_name": "rpbaltazar", "link": "https://stackoverflow.com/users/2893397/rpbaltazar"}, "reply_to_user": {"reputation": 353, "user_id": 1767058, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/zouzw.png?s=128&g=1", "display_name": "JCC", "link": "https://stackoverflow.com/users/1767058/jcc"}, "edited": false, "score": 0, "creation_date": 1562740602, "post_id": 44844931, "comment_id": 100466616, "body": "@JCC you are entirely right when it comes to the being locked. That was a fix I did on my configuration at the time, but I have since stopped using Atom, so I haven&#39;t played around with it anymore. My opinion is that the rubocop lint should pick up whichever gemset is loaded in the path its being executed and if none, default to the default gemset. Not sure what is the current status, but it might worth for you to try to install rubocop globally (<a href=\"https://pennyforyourcode.com/installing-a-ruby-gem-globally-in-rvm-ffa7222f7e7\" rel=\"nofollow noreferrer\">pennyforyourcode.com/&hellip;</a>) and remove the executable path that i mention in my comment."}, {"owner": {"reputation": 353, "user_id": 1767058, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/zouzw.png?s=128&g=1", "display_name": "JCC", "link": "https://stackoverflow.com/users/1767058/jcc"}, "edited": false, "score": 1, "creation_date": 1562951511, "post_id": 44844931, "comment_id": 100555384, "body": "Thanks for the link to that blog about the @global option. Unfortunately, my earlier comment was made in full knowledge of this option. The global option for example, you can have gemsets for ruby-2.5.1=&gt; (default)  global  and gemsets for ruby-2.6.3=&gt; (default)  global. Each ruby version has its own set of gemsets and the global will install it within each version and be available for any of the gemsets that you create within each ruby version. Does that make sense? That means we still need to change the path on the linter each time we switch ruby versions."}], "tags": [], "owner": {"reputation": 781, "user_id": 2893397, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a5d7ff72c038139fe1b4d0e78a3e8e08?s=128&d=identicon&r=PG", "display_name": "rpbaltazar", "link": "https://stackoverflow.com/users/2893397/rpbaltazar"}, "is_accepted": true, "score": 8, "last_activity_date": 1498820610, "creation_date": 1498820610, "answer_id": 44844931, "question_id": 43479200, "link": "https://stackoverflow.com/questions/43479200/atom-editor-dont-work-rubocop-with-atom/44844931#44844931", "title": "Atom-Editor: Don&#39;t work rubocop with atom", "body": "<p>It seems that you're using rvm to manage your environment. What i did to get it to work was follow the instructions on their repo: <a href=\"https://github.com/AtomLinter/linter-rubocop#settings\" rel=\"noreferrer\">https://github.com/AtomLinter/linter-rubocop#settings</a></p>\n\n<pre><code># make sure I'm in the global gemset\n$ rvm gemset use global\n# install the gem\n$ gem install rubocop\n</code></pre>\n\n<p>configure atom to use the global. Edit your atom's config file (<code>config.cson</code>) and add</p>\n\n<pre><code>*:\n  \"linter-rubocop\":\n    executablePath: \"~/.rvm/gems/ruby-2.3.1@global/wrappers\"\n  \"linter-ui-default\": {}\n</code></pre>\n\n<p>Note: make sure that the ruby version is the one you're using.</p>\n"}, {"tags": [], "owner": {"reputation": 7944, "user_id": 10907864, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/tGpcY.jpg?s=128&g=1", "display_name": "Promise Preston", "link": "https://stackoverflow.com/users/10907864/promise-preston"}, "is_accepted": false, "score": 1, "last_activity_date": 1602669399, "creation_date": 1602669399, "answer_id": 64350812, "question_id": 43479200, "link": "https://stackoverflow.com/questions/43479200/atom-editor-dont-work-rubocop-with-atom/64350812#64350812", "title": "Atom-Editor: Don&#39;t work rubocop with atom", "body": "<p>I had this same issue when working on a <strong>Rails 6</strong> application in <strong>Ubuntu 20.04</strong> with <strong>rbenv</strong> as my ruby version manager.</p>\n<p>I already had rubocop installed in the project, but Atom editor was still throwing this error.</p>\n<p>All I had to do was to install the rubocop gem to be available globally on the machine. Open a new terminal and install it using:</p>\n<pre><code>gem install rubocop\n</code></pre>\n<p>That's all.</p>\n<p><strong>I hope this helps</strong></p>\n"}], "owner": {"reputation": 85, "user_id": 6510821, "user_type": "registered", "profile_image": "https://graph.facebook.com/1710425042554788/picture?type=large", "display_name": "Alexandr  Kurilovich", "link": "https://stackoverflow.com/users/6510821/alexandr-kurilovich"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2791, "favorite_count": 1, "accepted_answer_id": 44844931, "answer_count": 2, "score": 7, "last_activity_date": 1602669457, "creation_date": 1492538403, "last_edit_date": 1602669457, "question_id": 43479200, "link": "https://stackoverflow.com/questions/43479200/atom-editor-dont-work-rubocop-with-atom", "title": "Atom-Editor: Don&#39;t work rubocop with atom", "body": "<p>I tried connect rubocop in atom and got error in atom.</p>\n\n<pre><code>linter-registry.js [sm]:144 [Linter] Error running RuboCop Error: /usr/lib/ruby/2.3.0/rubygems/dependency.rb:319:in `to_specs': Could not find 'rubocop' (&gt;= 0.a) among 16 total gem(s) (Gem::LoadError)\nChecked in 'GEM_PATH=/home/kurilovichay/.rvm/gems/ruby-2.3.1:/home/kurilovichay/.rvm/gems/ruby-2.3.1@global', execute `gem env` for more information\n    from /usr/lib/ruby/2.3.0/rubygems/dependency.rb:328:in `to_spec'\n    from /usr/lib/ruby/2.3.0/rubygems/core_ext/kernel_gem.rb:65:in `gem'\n    from /usr/local/bin/rubocop:22:in `&lt;main&gt;'\n    at parseFromStd (/home/kurilovichay/.atom/packages/linter-rubocop/src/index.js:41:43)\n    at Object.&lt;anonymous&gt; (/home/kurilovichay/.atom/packages/linter-rubocop/src/index.js:212:27)\n    at next (&lt;anonymous&gt;)\n    at step (/home/kurilovichay/.atom/packages/linter-rubocop/src/index.js:11:273)\n</code></pre>\n\n<p>which rubocop return:</p>\n\n<pre><code>/usr/local/bin/rubocop\n</code></pre>\n\n<p>it's wrong?</p>\n"}, {"tags": ["ruby", "windows"], "comments": [{"owner": {"reputation": 290, "user_id": 5753640, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pgFc3.jpg?s=128&g=1", "display_name": "Cameron Roe", "link": "https://stackoverflow.com/users/5753640/cameron-roe"}, "edited": false, "score": 0, "creation_date": 1492537953, "post_id": 43479011, "comment_id": 74013414, "body": "Are you getting an error message? If so, what error message did you get?"}, {"owner": {"reputation": 1978, "user_id": 1222355, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/44e0773345e9065b2e012b434370dbbb?s=128&d=identicon&r=PG", "display_name": "David West", "link": "https://stackoverflow.com/users/1222355/david-west"}, "reply_to_user": {"reputation": 290, "user_id": 5753640, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pgFc3.jpg?s=128&g=1", "display_name": "Cameron Roe", "link": "https://stackoverflow.com/users/5753640/cameron-roe"}, "edited": false, "score": 0, "creation_date": 1492538017, "post_id": 43479011, "comment_id": 74013450, "body": "No error message. It just does not close apps or start my scheduled tasks for any pc past the first. It never goes to the rescue either."}, {"owner": {"reputation": 290, "user_id": 5753640, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pgFc3.jpg?s=128&g=1", "display_name": "Cameron Roe", "link": "https://stackoverflow.com/users/5753640/cameron-roe"}, "edited": false, "score": 0, "creation_date": 1492538137, "post_id": 43479011, "comment_id": 74013512, "body": "Try putting a <code>puts node</code> in the loop and make sure all of the nodes are being looped through."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1492538559, "post_id": 43479011, "comment_id": 74013787, "body": "You need to get errors of some kind or there&#39;s no way of knowing what&#39;s wrong here. You could start by killing off these ugly back-tick-style command executions and replace that with <code>system(&#39;taskill.exe&#39;, &#39;&#47;S&#39;, node, &#39;&#47;U&#39;, &#39;joe_user&#39;, ...)</code> where you can capture the result of that command. You can also use <a href=\"https://docs.ruby-lang.org/en/2.4.0/Open3.html\" rel=\"nofollow noreferrer\"><code>popen3</code></a> to capture any diagnostic output that might be relevant."}, {"owner": {"reputation": 1978, "user_id": 1222355, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/44e0773345e9065b2e012b434370dbbb?s=128&d=identicon&r=PG", "display_name": "David West", "link": "https://stackoverflow.com/users/1222355/david-west"}, "edited": false, "score": 0, "creation_date": 1492540600, "post_id": 43479011, "comment_id": 74015120, "body": "I did have a version with <code>popen3</code>. It tried to print the stderr in the rescue. it never did. I did not do <code>puts node</code>, but I debugged. It only went through the first node."}], "answers": [{"tags": [], "owner": {"reputation": 1978, "user_id": 1222355, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/44e0773345e9065b2e012b434370dbbb?s=128&d=identicon&r=PG", "display_name": "David West", "link": "https://stackoverflow.com/users/1222355/david-west"}, "is_accepted": true, "score": 0, "last_activity_date": 1492649509, "creation_date": 1492649509, "answer_id": 43508417, "question_id": 43479011, "link": "https://stackoverflow.com/questions/43479011/windows-command-line-scripting-with-ruby-each-loop-behaving-unexpectedly/43508417#43508417", "title": "Windows command line scripting with Ruby. #each loop behaving unexpectedly", "body": "<p>Fixed it:</p>\n\n<pre><code>nodes = (1234..1235).to_a\nnodes.map! { |node| \"pc\" + node.to_s }\napps_to_close = [\"iexplore.exe\", \"powershell.exe\", \"ruby.exe\", \"chrome.exe\", \n  \"cmd.exe\", \"taskhost.exe\", \"git.exe\", \"git-tfs.exe\"]\n\ndef process_node(apps_to_close, node)\n  begin\n     apps_to_close.each do |app|\n      `taskkill.exe /S #{node} /U joe_user /P joe_pass /IM #{app} /F`\n    end\n     Process.spawn(\"@powershell cmdkey.exe /add:#{node} /user:joe_user /pass:joe_pass; \n      schtasks /RUN /TN \\\"start_my_sched_task\\\" /s \\\"#{node}\\\"\")\n  rescue\n    puts \"#{node} could not be restarted\"\n  end\nend\n\nnodes.each do |node|\n  process_node(apps_to_close, node)\nend\n</code></pre>\n"}], "owner": {"reputation": 1978, "user_id": 1222355, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/44e0773345e9065b2e012b434370dbbb?s=128&d=identicon&r=PG", "display_name": "David West", "link": "https://stackoverflow.com/users/1222355/david-west"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 48, "favorite_count": 0, "accepted_answer_id": 43508417, "answer_count": 1, "score": 1, "last_activity_date": 1492649509, "creation_date": 1492537767, "last_edit_date": 1492537960, "question_id": 43479011, "link": "https://stackoverflow.com/questions/43479011/windows-command-line-scripting-with-ruby-each-loop-behaving-unexpectedly", "title": "Windows command line scripting with Ruby. #each loop behaving unexpectedly", "body": "<p>I'm expecting multiple machines to close processes and restart a <code>.bat</code> file (I'm scripting Windows.) It only works for the first machine.</p>\n\n<pre><code>nodes = (1234..1235).to_a\nnodes.map! { |node| \"pc\" + node.to_s }\napps_to_close = [\"iexplore.exe\", \"powershell.exe\", \"ruby.exe\", \"chrome.exe\", \n  \"cmd.exe\", \"taskhost.exe\", \"git.exe\", \"git-tfs.exe\"]\n\ndef process_node(apps_to_close, node)\n  begin\n     apps_to_close.each do |app|\n      `taskkill.exe /S #{node} /U joe_user /P joe_pass /IM #{app} /F`\n    end\n     `@powershell cmdkey.exe /add:#{node} /user:joe_user /pass:joe_pass; \n      schtasks /RUN /TN \"start_my_sched_task\" /s \"#{node}\"`\n  rescue\n    puts \"#{node} could not be restarted\"\n  end\nend\n\nnodes.each do |node|\n  process_node(apps_to_close, node)\nend\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-3", "ruby-on-rails-4", "ruby-on-rails-3.2"], "comments": [{"owner": {"reputation": 5134, "user_id": 1672197, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i8HkV.png?s=128&g=1", "display_name": "orde", "link": "https://stackoverflow.com/users/1672197/orde"}, "edited": false, "score": 3, "creation_date": 1492537179, "post_id": 43478771, "comment_id": 74013002, "body": "Link to documentatIon: <a href=\"https://ruby-doc.org/core-2.4.0/String.html#method-i-count\" rel=\"nofollow noreferrer\">ruby-doc.org/core-2.4.0/String.html#method-i-count</a>"}, {"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 0, "creation_date": 1492539474, "post_id": 43478771, "comment_id": 74014419, "body": "This is covered in the documentation."}], "answers": [{"comments": [{"owner": {"reputation": 3997, "user_id": 3998420, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/55ea542584d3fd2a430c3d409bdafc95?s=128&d=identicon&r=PG&f=1", "display_name": "bkunzi01", "link": "https://stackoverflow.com/users/3998420/bkunzi01"}, "reply_to_user": {"reputation": 3, "user_id": 7518409, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4K0PP.jpg?s=128&g=1", "display_name": "Aravind Narayanan", "link": "https://stackoverflow.com/users/7518409/aravind-narayanan"}, "edited": false, "score": 0, "creation_date": 1492538176, "post_id": 43478823, "comment_id": 74013540, "body": "Anytime.  If that&#39;s all you need mark it correct for others to reference."}, {"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 1, "creation_date": 1492540961, "post_id": 43478823, "comment_id": 74015322, "body": "Don&#39;t rush to accept answers. SO is a global site, and it takes many hours for everyone to see and formulate good answers. Premature selection discourages others from answering, which potentially hurts you, and others who search for similar solutions in the future. Remember, SO isn&#39;t about you getting an answer only, it&#39;s about documenting programming problems and their solutions for others in the future, so the better the question, and the attending solutions, the better for everyone."}, {"owner": {"reputation": 3, "user_id": 7518409, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4K0PP.jpg?s=128&g=1", "display_name": "Aravind Narayanan", "link": "https://stackoverflow.com/users/7518409/aravind-narayanan"}, "edited": false, "score": 1, "creation_date": 1492597270, "post_id": 43478823, "comment_id": 74040271, "body": "If it&#39;s about documenting programming problems and solutions, how does my selection discourage others from answering?"}], "tags": [], "owner": {"reputation": 3997, "user_id": 3998420, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/55ea542584d3fd2a430c3d409bdafc95?s=128&d=identicon&r=PG&f=1", "display_name": "bkunzi01", "link": "https://stackoverflow.com/users/3998420/bkunzi01"}, "is_accepted": true, "score": 2, "last_activity_date": 1492539519, "last_edit_date": 1492539519, "creation_date": 1492537116, "answer_id": 43478823, "question_id": 43478771, "link": "https://stackoverflow.com/questions/43478771/how-does-count-work-in-ruby-when-a-string-is-set-as-the-parameter/43478823#43478823", "title": "How does count work in Ruby when a string is set as the parameter?", "body": "<p>Basically, <code>name.count(\"aeiou\")</code> will return any instances of any characters in name that match \"a\" or \"e\" or \"i\" or \"o\" or \"u\".  If you want to count as a string you'd use <code>scan</code> like:</p>\n\n<pre><code>name.scan(/aeiou/).count \n</code></pre>\n\n<p><code>count</code> also includes whitespaces.</p>\n"}], "owner": {"reputation": 3, "user_id": 7518409, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4K0PP.jpg?s=128&g=1", "display_name": "Aravind Narayanan", "link": "https://stackoverflow.com/users/7518409/aravind-narayanan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 73, "favorite_count": 0, "accepted_answer_id": 43478823, "answer_count": 1, "score": -1, "last_activity_date": 1492539519, "creation_date": 1492536887, "question_id": 43478771, "link": "https://stackoverflow.com/questions/43478771/how-does-count-work-in-ruby-when-a-string-is-set-as-the-parameter", "title": "How does count work in Ruby when a string is set as the parameter?", "body": "<p>How does count work in this code:</p>\n\n<pre><code>name= \"abcdef\"\nputs name.count(\"aeiou\")\nputs name.count(\"^aeiou\")\n</code></pre>\n\n<p>Does it count for the occurrences of \"a\", \"e\", \"i\", \"o\" and \"u\"?</p>\n\n<p>If yes, how can I count the occurrences of \"aeiou\" as a single string?</p>\n\n<p>Does the negation include counting for 'spaces'? Why/why not?</p>\n"}, {"tags": ["ruby", "multithreading", "mri"], "comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1492536185, "post_id": 43478376, "comment_id": 74012389, "body": "Each thread must allocate enough memory for the stack, and the stack size is defined by <a href=\"http://clearcove.ca/2013/10/how-to-increase-max-stack-size-for-ruby-2-0-when-experiencing-systemstackerror-stack-level-too-deep/\" rel=\"nofollow noreferrer\">various parameters</a>, but even then this doesn&#39;t account for all of the memory usage seen here. I&#39;ve reproduced this to a degree on a Fedora machine, but I can run ~500 threads without any problems."}, {"owner": {"reputation": 1637, "user_id": 4415902, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/5f4d39ddb78671645241c0cae6a5d7ce?s=128&d=identicon&r=PG&f=1", "display_name": "atlascoder", "link": "https://stackoverflow.com/users/4415902/atlascoder"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1492536850, "post_id": 43478376, "comment_id": 74012823, "body": "@tadman, yes, I know that restriction in threads count may looks not really significant, but my questions came from a real case, where I used threads within not-so-small Rails project and I got the limit of memory. But the question is why thread must allocate more memory if it has its memory space already? It uses the shared objects and from this point I see that it&#39;s just a routine, that is executing concurrently. Even if it creates variables - its like other variables in other blocks, isn&#39;t?"}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1492537023, "post_id": 43478376, "comment_id": 74012922, "body": "I&#39;m not 100% sure of the MRI internals, but I know it has a lot of baggage with respect to the Global Interpreter Lock and various historical compatibility concerns. The new thread does need its own copy of some things, but the things it needs varies considerably from version 1.9 to 2.4 as improvements have been made. The <i>heap</i> is shared, but other elements aren&#39;t, especially the stack."}, {"owner": {"reputation": 1637, "user_id": 4415902, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/5f4d39ddb78671645241c0cae6a5d7ce?s=128&d=identicon&r=PG&f=1", "display_name": "atlascoder", "link": "https://stackoverflow.com/users/4415902/atlascoder"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 1, "creation_date": 1492538039, "post_id": 43478376, "comment_id": 74013460, "body": "It seems your suggestion has matter. I&#39;ve tried to allocate some memory with <code>arr = 10000000.times.inject([]){|a,i| a&lt;&lt;i}</code> (mapped ~ 300M) and after i made <code>Thread.new{sleep}</code> it has added only ~50M to mapped. This amount is very similar to overhead for new thread without additional objects. So, it really may be some overhead for GIL..."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1492538173, "post_id": 43478376, "comment_id": 74013536, "body": "If you can come up with more concrete metrics on what&#39;s allocated and if this is actually erroneous, I&#39;m sure the Ruby performance team might be interested. I&#39;m not sure how gnarly the threading C code in MRI is, but that&#39;s one place to start digging."}, {"owner": {"reputation": 1637, "user_id": 4415902, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/5f4d39ddb78671645241c0cae6a5d7ce?s=128&d=identicon&r=PG&f=1", "display_name": "atlascoder", "link": "https://stackoverflow.com/users/4415902/atlascoder"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1492539398, "post_id": 43478376, "comment_id": 74014354, "body": "Well, I am not sure that it&#39;s a bug, I guess it&#39;s just some conscious overhead of ruby interpreter. But another interesting thing.. I&#39;ve tried this on Rubinius, where no GIL as I know, and rbx has added some allocation and created new process when Thread.new, with new pid and the same memory mapping size, but object variables still shared. Well.. It looks like some trick around concurrency-safe of interpreters"}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1492539721, "post_id": 43478376, "comment_id": 74014586, "body": "Jruby, Rubinius, and MRI Ruby probably have wildly different memory consumption profiles. I&#39;d expect Rubinius to be the leanest since that&#39;s a from-scratch implementation with an emphasis on efficiency, so maybe that&#39;s an option if you&#39;re getting pinned on memory."}, {"owner": {"reputation": 1637, "user_id": 4415902, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/5f4d39ddb78671645241c0cae6a5d7ce?s=128&d=identicon&r=PG&f=1", "display_name": "atlascoder", "link": "https://stackoverflow.com/users/4415902/atlascoder"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1492540452, "post_id": 43478376, "comment_id": 74015019, "body": "@tadman, thanks! I will try to dig deeper. Anyway, as for mentioned case with Rails, I think it&#39;s not a good idea to process many threaded routines in Rails app - it&#39;s better to make another, not bound to Rails process, if possible. It was just curious interest, and knowing)"}], "owner": {"reputation": 1637, "user_id": 4415902, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/5f4d39ddb78671645241c0cae6a5d7ce?s=128&d=identicon&r=PG&f=1", "display_name": "atlascoder", "link": "https://stackoverflow.com/users/4415902/atlascoder"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 459, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1492540688, "creation_date": 1492535632, "last_edit_date": 1492540688, "question_id": 43478376, "link": "https://stackoverflow.com/questions/43478376/mri-duplicates-memory-allocation-when-thread-new", "title": "MRI duplicates memory allocation when Thread.new", "body": "<p>It seems that MRI makes duplication of memory allocation for every new thread.</p>\n\n<p>I use Ubuntu x64, ruby-2.2.4 (rvm), and this what i get:</p>\n\n<p>Just started irb:</p>\n\n<p><a href=\"https://i.stack.imgur.com/wgJqE.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/wgJqE.png\" alt=\"enter image description here\"></a></p>\n\n<p>I see <code>pmap -d 1656</code> 59760K (<em>allocated memory, or '[ stack ]' for the program stack [man pmap(1)]</em>) memory usage:</p>\n\n<p><a href=\"https://i.stack.imgur.com/rwZNv.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/rwZNv.png\" alt=\"enter image description here\"></a></p>\n\n<p>And when creating a thread:</p>\n\n<p><a href=\"https://i.stack.imgur.com/2QJWD.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/2QJWD.png\" alt=\"enter image description here\"></a></p>\n\n<p>I see <code>pmap -d 1656</code> 127352K memory usage:</p>\n\n<p><a href=\"https://i.stack.imgur.com/c6bfB.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/c6bfB.png\" alt=\"enter image description here\"></a></p>\n\n<p>So, I see duplication 59760K -> 127352K of memory allocation.</p>\n\n<hr>\n\n<p>Such behavior is similar to result of the <code>fork()</code> call, which being used for creation a new process, makes a copy of its calling process data ('copy-on-write' is out this context) for new process.</p>\n\n<p>But Thread is created in the same process and shares its data, and it looks strange...</p>\n\n<p>In practice, it means that Thread in Ruby has similar to Process restriction in memory usage: new thread creation fails when allocated memory getting closer to physical memory size.</p>\n\n<p>I am curious, WHY?</p>\n\n<p><strong>UPDATE</strong></p>\n\n<p>It's not duplication memory but additional allocation for ~50K for each thread.\nThanks @tadman for suggestion that it's an overhead and not something like copying memory in the fork()'s way.</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 6814, "user_id": 5227053, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/30254853024c1381c7e51ca09b9341e7?s=128&d=identicon&r=PG&f=1", "display_name": "AnoE", "link": "https://stackoverflow.com/users/5227053/anoe"}, "edited": false, "score": 0, "creation_date": 1492543599, "post_id": 43478185, "comment_id": 74016910, "body": "Without trying to be snide, did you actually <i>read</i> the error message? It says exactly where the problem lies and gives no hint at all that it is related to passing render arguments..."}], "answers": [{"tags": [], "owner": {"reputation": 47232, "user_id": 1772830, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/Qtoqg.jpg?s=128&g=1", "display_name": "Andrey Deineko", "link": "https://stackoverflow.com/users/1772830/andrey-deineko"}, "is_accepted": true, "score": 4, "last_activity_date": 1492535119, "creation_date": 1492535119, "answer_id": 43478211, "question_id": 43478185, "link": "https://stackoverflow.com/questions/43478185/how-to-pass-multiple-parameter-in-render-action-in-ruby-on-rails/43478211#43478211", "title": "how to pass multiple parameter in render action in ruby on rails", "body": "<p>Your code is valid and correct - it is exactly how you pass multiple params to render.</p>\n\n<p>The error comes from the fact, that <code>@piece</code> is <code>nil</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 6814, "user_id": 5227053, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/30254853024c1381c7e51ca09b9341e7?s=128&d=identicon&r=PG&f=1", "display_name": "AnoE", "link": "https://stackoverflow.com/users/5227053/anoe"}, "edited": false, "score": 0, "creation_date": 1492543483, "post_id": 43478715, "comment_id": 74016848, "body": "While this answer is factually correct, I would advise against it. <code>#try</code> had its place when <code>nil</code> is an expected and common value for the variable, but for an action like this (which looks like a form being saved)  I would assume that <code>nil</code> would suggest an error. So <code>try</code> would just hide the error from the developer/log file - the user will notice though."}], "tags": [], "owner": {"reputation": 104, "user_id": 7884173, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kDyf2NzUs6Q/AAAAAAAAAAI/AAAAAAAAABA/XKDrrtxQp0Y/photo.jpg?sz=128", "display_name": "Tushar Kulkarni", "link": "https://stackoverflow.com/users/7884173/tushar-kulkarni"}, "is_accepted": false, "score": -2, "last_activity_date": 1492542980, "last_edit_date": 1492542980, "creation_date": 1492536692, "answer_id": 43478715, "question_id": 43478185, "link": "https://stackoverflow.com/questions/43478185/how-to-pass-multiple-parameter-in-render-action-in-ruby-on-rails/43478715#43478715", "title": "how to pass multiple parameter in render action in ruby on rails", "body": "<p>Your code is absolutely correct for multiple parameters. The error is because you are getting <code>nil</code> value in <code>@piece</code>.\nYou can simply handle <code>nil</code> values as follows:\n<code>@piece.try(:folder_id)</code></p>\n\n<p>And your code will look something like:</p>\n\n<pre><code>.modal-body =render 'folders/pieces/update', id: @piece , folder_id: @piece.try(:folder_id)\n</code></pre>\n\n<p>This will not throw any error in case of <code>nil</code> value.</p>\n"}], "owner": {"reputation": 310, "user_id": 7541230, "user_type": "registered", "accept_rate": 62, "profile_image": "https://lh3.googleusercontent.com/-MnZCJewegMY/AAAAAAAAAAI/AAAAAAAAANc/ufWXqXVuBq4/photo.jpg?sz=128", "display_name": "youssef hassoun", "link": "https://stackoverflow.com/users/7541230/youssef-hassoun"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 899, "favorite_count": 0, "accepted_answer_id": 43478211, "answer_count": 2, "score": 0, "last_activity_date": 1492542980, "creation_date": 1492535023, "last_edit_date": 1492535155, "question_id": 43478185, "link": "https://stackoverflow.com/questions/43478185/how-to-pass-multiple-parameter-in-render-action-in-ruby-on-rails", "title": "how to pass multiple parameter in render action in ruby on rails", "body": "<p>my source code is </p>\n\n<pre><code>.modal-body\n  =render 'folders/pieces/update', id: @piece , folder_id: @piece.folder_id\n</code></pre>\n\n<p>It throws an error:</p>\n\n<pre><code>undefined method 'folder_id' for nil:NilClass \n</code></pre>\n\n<p>I want to pass two parameters in render page</p>\n"}, {"tags": ["ruby", "chef-infra", "chef-recipe", "chef-solo"], "answers": [{"tags": [], "owner": {"reputation": 43208, "user_id": 78722, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cf611565f0b79abd0b3dc200ad867661?s=128&d=identicon&r=PG", "display_name": "coderanger", "link": "https://stackoverflow.com/users/78722/coderanger"}, "is_accepted": false, "score": 0, "last_activity_date": 1492539586, "creation_date": 1492539586, "answer_id": 43479505, "question_id": 43477594, "link": "https://stackoverflow.com/questions/43477594/in-chef-solo-how-to-use-a-common-cookbook-into-other-cookbooks/43479505#43479505", "title": "In chef solo, how to use a common cookbook into other cookbooks", "body": "<p>This is too broad a question for StackOverflow but you can find the introductory Chef tutorials at learn.chef.io which covers the basics of creating cookbooks. Beyond that really all you need to know for this is that cookbooks can depend on each other much like libraries in other languages, via the <code>depends</code> keyword in the <code>metadata.rb</code> file. You can find more about using the <code>metadata.rb</code> file in both the tutorials and Chef documentation.</p>\n"}], "owner": {"reputation": 1, "user_id": 1571556, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/78f3340f28f7122b53c140a12bdab473?s=128&d=identicon&r=PG", "display_name": "pratyyy", "link": "https://stackoverflow.com/users/1571556/pratyyy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 32, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1492539586, "creation_date": 1492533033, "question_id": 43477594, "link": "https://stackoverflow.com/questions/43477594/in-chef-solo-how-to-use-a-common-cookbook-into-other-cookbooks", "title": "In chef solo, how to use a common cookbook into other cookbooks", "body": "<p>I have lots of common attributes across cookbooks. \nAfter researching I found the correct way (for my use case) is to use a common cookbook. But since I am new to chef world, I am not able to figure out how to use one. </p>\n"}, {"tags": ["ruby-on-rails", "ruby", "unit-testing", "rspec"], "answers": [{"tags": [], "owner": {"reputation": 166, "user_id": 7863279, "user_type": "registered", "profile_image": "https://graph.facebook.com/403907693327439/picture?type=large", "display_name": "Kyle Boss", "link": "https://stackoverflow.com/users/7863279/kyle-boss"}, "is_accepted": true, "score": 2, "last_activity_date": 1492535317, "last_edit_date": 1492535317, "creation_date": 1492534767, "answer_id": 43478103, "question_id": 43477535, "link": "https://stackoverflow.com/questions/43477535/how-to-save-a-variable-in-an-rspec-expect/43478103#43478103", "title": "How to save a variable in an rspec expect?", "body": "<p>You could declare the variable, say <code>captured_arg</code> before the <code>expect</code> (or <code>allow</code>, if you don't want it to fail if <code>my_instance</code> does not receive <code>my_function</code>). Then you can collect the arguments in a block and set <code>captured_arg</code> within that block.</p>\n\n<pre><code>captured_arg = nil\nexpect(my_instance).to receive(:my_function) { |arg| captured_arg = arg }\n</code></pre>\n\n<p><strong>Edit: (Keyword Arguments)</strong></p>\n\n<p>If you are using <a href=\"https://robots.thoughtbot.com/ruby-2-keyword-arguments\" rel=\"nofollow noreferrer\">keyword arguments</a>, just modify the script above slightly, using <code>arg</code> as the keyword argument you'd like to capture:</p>\n\n<pre><code>captured_arg = nil\nexpect(my_instance).to receive(:my_function) { |args| captured_arg = args[:arg] }\n</code></pre>\n"}], "owner": {"reputation": 2362, "user_id": 1459901, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Uc6uH.jpg?s=128&g=1", "display_name": "Cisplatin", "link": "https://stackoverflow.com/users/1459901/cisplatin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 789, "favorite_count": 0, "accepted_answer_id": 43478103, "answer_count": 1, "score": 3, "last_activity_date": 1492535317, "creation_date": 1492532854, "question_id": 43477535, "link": "https://stackoverflow.com/questions/43477535/how-to-save-a-variable-in-an-rspec-expect", "title": "How to save a variable in an rspec expect?", "body": "<p>I have something along the following lines in one of my <code>spec</code> files:</p>\n\n<pre><code>expect(my_instance).to receive(:my_function).with(arg: instance_of(String))\n</code></pre>\n\n<p>I want to be able to capture the actual value of <code>arg</code> in a variable I can use in the spec. Is there a way to do that? I checked the rspec docs but didn't find anything like that.</p>\n"}, {"tags": ["ruby", "variables", "scope", "sinatra", "rufus-scheduler"], "comments": [{"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 2, "creation_date": 1492535977, "post_id": 43476509, "comment_id": 74012271, "body": "<code>connections</code> is local to the file but is out of context in the method (change in lexical scope). If you really must then make it an instance variable <code>@connections</code> this will change the scope but <code>@connections</code> will now be an instance variable in the context of <code>main</code> which seems unwieldy."}, {"owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 0, "creation_date": 1492567645, "post_id": 43476509, "comment_id": 74025730, "body": "another way to do it would be to capitalize the c so it is a constant."}, {"owner": {"reputation": 2540, "user_id": 519790, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/b92a265cc1560fb04362d5bc63d42a0d?s=128&d=identicon&r=PG", "display_name": "multiholle", "link": "https://stackoverflow.com/users/519790/multiholle"}, "reply_to_user": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1492590429, "post_id": 43476509, "comment_id": 74035457, "body": "@engineersmnky How do I put connections in the context of my Sinatra application?"}], "answers": [{"tags": [], "owner": {"reputation": 3437, "user_id": 10762, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8d96626e52beb1ff90f57a8e189e1e6f?s=128&d=identicon&r=PG", "display_name": "jmettraux", "link": "https://stackoverflow.com/users/10762/jmettraux"}, "is_accepted": false, "score": 2, "last_activity_date": 1492650759, "creation_date": 1492650759, "answer_id": 43508564, "question_id": 43476509, "link": "https://stackoverflow.com/questions/43476509/sinatra-event-triggered-by-rufus-scheduler/43508564#43508564", "title": "Sinatra event triggered by Rufus Scheduler", "body": "<p>And here is a version with global variables.</p>\n\n<blockquote>\n  <p>How do I put connections in the context of my Sinatra application?</p>\n</blockquote>\n\n<p>Sorry, with this <code>$connections</code> and <code>$scheduler</code> it's in the context of the whole Ruby process, but for a limited script/service, it's OK.</p>\n\n<pre><code>require 'sinatra'\nrequire 'rufus-scheduler'\nrequire 'json'\n\n\nset :server, :thin\n$connections = []\n$scheduler = Rufus::Scheduler.new\n\n\nget '/' do\n    erb :index\nend\n\nget '/events', provides: 'text/event-stream' do\n  stream :keep_open do |out|\n    $connections &lt;&lt; out\n    $connections.reject!(&amp;:closed?)\n  end\nend\n\ndef send_event(id, body)\n\n  body[:id] = id\n\n  event = \"data: #{body.to_json}\"\n  $connections.each { |out| out &lt;&lt; event }\nend\n\n$scheduler.interval '2s' do\n\n  random = (0...8).map { (65 + rand(26)).chr }.join\n  send_event('random', { random: random })\nend\n</code></pre>\n"}], "owner": {"reputation": 2540, "user_id": 519790, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/b92a265cc1560fb04362d5bc63d42a0d?s=128&d=identicon&r=PG", "display_name": "multiholle", "link": "https://stackoverflow.com/users/519790/multiholle"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 183, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1492650759, "creation_date": 1492529809, "last_edit_date": 1492530410, "question_id": 43476509, "link": "https://stackoverflow.com/questions/43476509/sinatra-event-triggered-by-rufus-scheduler", "title": "Sinatra event triggered by Rufus Scheduler", "body": "<p>Trying to send an event from within Rufus Schedulers results in this error:</p>\n\n<pre><code>{ 70231586340180 rufus-scheduler intercepted an error:\n  70231586340180   job:\n  70231586340180     Rufus::Scheduler::IntervalJob \"2s\" {}\n  70231586340180   error:\n  70231586340180     70231586340180\n  70231586340180     NameError\n  70231586340180     undefined local variable or method `connections' for main:Object\n  70231586340180       picture-frame.rb:31:in `send_event'\n  70231586340180       picture-frame.rb:24:in `block in &lt;main&gt;'\n...\n</code></pre>\n\n<p>It seems like I can't access <code>connections</code> from within the Rufus Job. How can I fix this? This is my code:</p>\n\n<pre><code>require 'sinatra'\nrequire 'rufus-scheduler'\nrequire 'json'\n\n\nset :server, :thin\nconnections = []\nscheduler = Rufus::Scheduler.new\n\n\nget '/' do\n    erb :index\nend\n\nget '/events', provides: 'text/event-stream' do\n  stream :keep_open do |out|\n    connections &lt;&lt; out\n    connections.reject!(&amp;:closed?)\n  end\nend\n\nscheduler.interval '2s' do\n    random = (0...8).map { (65 + rand(26)).chr }.join\n    send_event('random', { random: random })\nend\n\ndef send_event(id, body)\n  body[:id] = id\n\n  event = \"data: #{body.to_json}\"\n  connections.each { |out| out &lt;&lt; event }\nend\n</code></pre>\n"}, {"tags": ["jquery", "ruby-on-rails", "ruby", "ajax", "ruby-on-rails-4"], "comments": [{"owner": {"reputation": 183, "user_id": 4996744, "user_type": "registered", "profile_image": "https://graph.facebook.com/455012207986992/picture?type=large", "display_name": "Vineeth Subbaraya", "link": "https://stackoverflow.com/users/4996744/vineeth-subbaraya"}, "edited": false, "score": 0, "creation_date": 1492530028, "post_id": 43476329, "comment_id": 74008436, "body": "Did you try by removing the format.html line in your edit action?"}, {"owner": {"reputation": 321, "user_id": 7768323, "user_type": "registered", "accept_rate": 27, "profile_image": "https://www.gravatar.com/avatar/4dc775ad1110dce42d259e3592704dcd?s=128&d=identicon&r=PG&f=1", "display_name": "jeff", "link": "https://stackoverflow.com/users/7768323/jeff"}, "reply_to_user": {"reputation": 183, "user_id": 4996744, "user_type": "registered", "profile_image": "https://graph.facebook.com/455012207986992/picture?type=large", "display_name": "Vineeth Subbaraya", "link": "https://stackoverflow.com/users/4996744/vineeth-subbaraya"}, "edited": false, "score": 0, "creation_date": 1492530488, "post_id": 43476329, "comment_id": 74008764, "body": "@VineethSubbaraya thanks for answer, yes I did but  it still shows me the record without the result of the query"}, {"owner": {"reputation": 183, "user_id": 4996744, "user_type": "registered", "profile_image": "https://graph.facebook.com/455012207986992/picture?type=large", "display_name": "Vineeth Subbaraya", "link": "https://stackoverflow.com/users/4996744/vineeth-subbaraya"}, "edited": false, "score": 0, "creation_date": 1492531946, "post_id": 43476329, "comment_id": 74009821, "body": "Can you please explain what the search function is doing in the index action? did you mean to put it there?"}, {"owner": {"reputation": 321, "user_id": 7768323, "user_type": "registered", "accept_rate": 27, "profile_image": "https://www.gravatar.com/avatar/4dc775ad1110dce42d259e3592704dcd?s=128&d=identicon&r=PG&f=1", "display_name": "jeff", "link": "https://stackoverflow.com/users/7768323/jeff"}, "reply_to_user": {"reputation": 183, "user_id": 4996744, "user_type": "registered", "profile_image": "https://graph.facebook.com/455012207986992/picture?type=large", "display_name": "Vineeth Subbaraya", "link": "https://stackoverflow.com/users/4996744/vineeth-subbaraya"}, "edited": false, "score": 0, "creation_date": 1492532377, "post_id": 43476329, "comment_id": 74010089, "body": "@VineethSubbaraya the Search function is simply the use of gems kaminari and ransack for pagination and search, they work fine"}, {"owner": {"reputation": 183, "user_id": 4996744, "user_type": "registered", "profile_image": "https://graph.facebook.com/455012207986992/picture?type=large", "display_name": "Vineeth Subbaraya", "link": "https://stackoverflow.com/users/4996744/vineeth-subbaraya"}, "edited": false, "score": 0, "creation_date": 1492532818, "post_id": 43476329, "comment_id": 74010364, "body": "Can you also please check if you are getting any errors on your browser console? And try using pry debugger to check whether your function is returning you  the right results"}, {"owner": {"reputation": 321, "user_id": 7768323, "user_type": "registered", "accept_rate": 27, "profile_image": "https://www.gravatar.com/avatar/4dc775ad1110dce42d259e3592704dcd?s=128&d=identicon&r=PG&f=1", "display_name": "jeff", "link": "https://stackoverflow.com/users/7768323/jeff"}, "reply_to_user": {"reputation": 183, "user_id": 4996744, "user_type": "registered", "profile_image": "https://graph.facebook.com/455012207986992/picture?type=large", "display_name": "Vineeth Subbaraya", "link": "https://stackoverflow.com/users/4996744/vineeth-subbaraya"}, "edited": false, "score": 0, "creation_date": 1492535076, "post_id": 43476329, "comment_id": 74011696, "body": "@VineethSubbaraya yes I getting this error: ActionView::Template::Error (undefined method `TOTAL&#39; for #&lt;Pedidoliberado:0x86a65fa0&gt; because that column was created in the query"}, {"owner": {"reputation": 183, "user_id": 4996744, "user_type": "registered", "profile_image": "https://graph.facebook.com/455012207986992/picture?type=large", "display_name": "Vineeth Subbaraya", "link": "https://stackoverflow.com/users/4996744/vineeth-subbaraya"}, "edited": false, "score": 0, "creation_date": 1492535727, "post_id": 43476329, "comment_id": 74012097, "body": "You should use &quot;@pedidosliberados&quot; to be available in your view file. And please check the result of your query because it seems that &quot;TOTAL&quot; is not available."}, {"owner": {"reputation": 321, "user_id": 7768323, "user_type": "registered", "accept_rate": 27, "profile_image": "https://www.gravatar.com/avatar/4dc775ad1110dce42d259e3592704dcd?s=128&d=identicon&r=PG&f=1", "display_name": "jeff", "link": "https://stackoverflow.com/users/7768323/jeff"}, "reply_to_user": {"reputation": 183, "user_id": 4996744, "user_type": "registered", "profile_image": "https://graph.facebook.com/455012207986992/picture?type=large", "display_name": "Vineeth Subbaraya", "link": "https://stackoverflow.com/users/4996744/vineeth-subbaraya"}, "edited": false, "score": 0, "creation_date": 1492536890, "post_id": 43476329, "comment_id": 74012849, "body": "So I have &quot;@pedidosliberados&quot; in the view, when I load the page the query works because it shows me the data, but the problem is that when I modify the registry and show it by ajax using update.js.erb then it is not printing my record of the result Of the query that uses an inner join with another table but it is printing only without the query, showing only the data that are of the table &quot;orders released&quot; and the others that were created in the query does not show them because apparently it is not doing Use the query in ajax"}], "answers": [{"comments": [{"owner": {"reputation": 321, "user_id": 7768323, "user_type": "registered", "accept_rate": 27, "profile_image": "https://www.gravatar.com/avatar/4dc775ad1110dce42d259e3592704dcd?s=128&d=identicon&r=PG&f=1", "display_name": "jeff", "link": "https://stackoverflow.com/users/7768323/jeff"}, "edited": false, "score": 0, "creation_date": 1492542107, "post_id": 43479097, "comment_id": 74016042, "body": "excelent but with that line is showing all the records of the query again including those already had and had not modified, is there any way to show only the one that modifies?"}, {"owner": {"reputation": 183, "user_id": 4996744, "user_type": "registered", "profile_image": "https://graph.facebook.com/455012207986992/picture?type=large", "display_name": "Vineeth Subbaraya", "link": "https://stackoverflow.com/users/4996744/vineeth-subbaraya"}, "reply_to_user": {"reputation": 321, "user_id": 7768323, "user_type": "registered", "accept_rate": 27, "profile_image": "https://www.gravatar.com/avatar/4dc775ad1110dce42d259e3592704dcd?s=128&d=identicon&r=PG&f=1", "display_name": "jeff", "link": "https://stackoverflow.com/users/7768323/jeff"}, "edited": false, "score": 0, "creation_date": 1492542688, "post_id": 43479097, "comment_id": 74016402, "body": "After update try running &quot;@pedidoliberado.proceso_pedidos_lib&quot;. That should run the query for that particular record."}, {"owner": {"reputation": 321, "user_id": 7768323, "user_type": "registered", "accept_rate": 27, "profile_image": "https://www.gravatar.com/avatar/4dc775ad1110dce42d259e3592704dcd?s=128&d=identicon&r=PG&f=1", "display_name": "jeff", "link": "https://stackoverflow.com/users/7768323/jeff"}, "edited": false, "score": 0, "creation_date": 1492543840, "post_id": 43479097, "comment_id": 74017061, "body": "woth that line I am getting this error: NoMethodError (undefined method `proceso_pedidos_lib&#39; for #&lt;Pedidoliberado:0x8656b6a8&gt;):"}, {"owner": {"reputation": 183, "user_id": 4996744, "user_type": "registered", "profile_image": "https://graph.facebook.com/455012207986992/picture?type=large", "display_name": "Vineeth Subbaraya", "link": "https://stackoverflow.com/users/4996744/vineeth-subbaraya"}, "reply_to_user": {"reputation": 321, "user_id": 7768323, "user_type": "registered", "accept_rate": 27, "profile_image": "https://www.gravatar.com/avatar/4dc775ad1110dce42d259e3592704dcd?s=128&d=identicon&r=PG&f=1", "display_name": "jeff", "link": "https://stackoverflow.com/users/7768323/jeff"}, "edited": false, "score": 0, "creation_date": 1492544328, "post_id": 43479097, "comment_id": 74017323, "body": "Since you have written the query as a class method, you cannot call it on an instance. If you remove the keyword self and write it as an instance method you can use it with individual records."}], "tags": [], "owner": {"reputation": 183, "user_id": 4996744, "user_type": "registered", "profile_image": "https://graph.facebook.com/455012207986992/picture?type=large", "display_name": "Vineeth Subbaraya", "link": "https://stackoverflow.com/users/4996744/vineeth-subbaraya"}, "is_accepted": false, "score": 0, "last_activity_date": 1492547612, "last_edit_date": 1492547612, "creation_date": 1492538104, "answer_id": 43479097, "question_id": 43476329, "link": "https://stackoverflow.com/questions/43476329/show-a-record-result-of-a-query-using-ajax/43479097#43479097", "title": "Show a record result of a query using ajax", "body": "<p>You are not running the query in your update action. The queried parameters won't be available unless you run it in your update action. Also you have written a class method which won't be available for instance(individual record)</p>\n\n<pre><code>def self.proceso_pedidos_lib\n    query = select(\"[pedidosliberados].PEDIDO AS Pedido, SUM([detalle].IMPORTE) AS IMPORTE, SUM([detalle].IVA) AS IVA, SUM([detalle].IMPORTE) + SUM([detalle].IVA) AS TOTAL\")\n        .joins('inner join detalle ON pedidosliberados.PEDIDO = detalle.PEDIDO ')\n    query\nend\n</code></pre>\n\n<p>You would have to run this below command to get join fields like IMPORTE and such.</p>\n\n<pre><code>  @pedidoliberado.proceso_pedidos_lib\n</code></pre>\n"}], "owner": {"reputation": 321, "user_id": 7768323, "user_type": "registered", "accept_rate": 27, "profile_image": "https://www.gravatar.com/avatar/4dc775ad1110dce42d259e3592704dcd?s=128&d=identicon&r=PG&f=1", "display_name": "jeff", "link": "https://stackoverflow.com/users/7768323/jeff"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 68, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1492547612, "creation_date": 1492529359, "last_edit_date": 1492535105, "question_id": 43476329, "link": "https://stackoverflow.com/questions/43476329/show-a-record-result-of-a-query-using-ajax", "title": "Show a record result of a query using ajax", "body": "<p>I am using a query that involves two tables to display the records in the view, when modifying that record I use ajax by adding a \"Remote True\" to the form and adding in the edit action in the controller the \"format.Json \"and creating an update.js.erb file in which I render my registry after updating it to display it updating the view. My problem is that the record is the result of a query and at the time of rendering it with ajax in the view its not taking the result of the query.</p>\n\n<p>With ajax how could I render the query result?</p>\n\n<p>my index action:</p>\n\n<pre><code>@search_liberados = Pedidoliberado.proceso_pedidos_lib.search(search_params)\n\n@search_liberados.sorts = 'Pza desc' if @search_liberados.sorts.empty?\n@pedidosliberados = @search_liberados.result().page(params[:pedidosliberados]).per(15)\n</code></pre>\n\n<p>this is my view</p>\n\n<pre><code>  &lt;tbody id=\"container_pedidosliberados\"&gt;\n            &lt;%= render @pedidosliberados %&gt;&lt;!--carga todos los productos--&gt;\n  &lt;/tbody&gt;\n</code></pre>\n\n<p>my partial _pedidoliberado:</p>\n\n<pre><code>&lt;tr id=\"pedidoliberado_&lt;%= pedidoliberado.id %&gt;\"&gt;\n  &lt;td class=\"component_name_body_col\"&gt;&lt;%=pedidoliberado.TOTAL%&gt;&lt;/td&gt;\n  &lt;td class=\"component_name_body_col\"&gt;\n    &lt;%= form_for(pedidoliberado, :method =&gt; :put, remote: true, :url =&gt; {:controller =&gt;'pedidosliberados', :action =&gt; 'update', :id =&gt; pedidoliberado.ID}, html: {class: \"form-horizontal \"}) do |f| %&gt;&lt;!--ajax--&gt;\n\n      &lt;%= f.hidden_field :STATUS %&gt;\n\n        &lt;%= submit_tag \"save\", class: \"btn btn-primary Entregar\", data: { disable_with: 'Actualizando' }%&gt;\n\n    &lt;% end %&gt;\n  &lt;/td&gt;\n&lt;/tr&gt;\n</code></pre>\n\n<p>my query:</p>\n\n<pre><code>  def self.proceso_pedidos_lib\n    query = select(\"[pedidosliberados].PEDIDO AS Pedido, SUM([detalle].IMPORTE) AS IMPORTE, SUM([detalle].IVA) AS IVA, SUM([detalle].IMPORTE) + SUM([detalle].IVA) AS TOTAL\")\n            .joins('inner join detalle ON pedidosliberados.PEDIDO = detalle.PEDIDO ')\n    query\n  end\n</code></pre>\n\n<p>my edit action:</p>\n\n<pre><code>  def update\n    respond_to do |format|\n      if @pedidoliberado.update(pedidoliberado_params)\n        format.html { redirect_to @pedidoliberado, notice: 'Pedidoliberado was successfully updated.' }\n        format.json { render :show, status: :ok, location: @pedidoliberado }\n        format.js {flash.now[:notice] = 'saved.'} #ajax\n      else\n        format.html { render :edit }\n        format.json { render json: @pedidoliberado.errors, status: :unprocessable_entity }\n        format.js {flash.now[:alert] = 'Error.'} #ajax\n      end\n    end\n  end\n</code></pre>\n\n<p>my update.js.erb:</p>\n\n<pre><code>$(\"#pedidoliberado_&lt;%= @pedidoliberado.id %&gt;\").fadeOut(500, function(){\n  $(this).remove();\n  $(\"#container_pedidosliberados\").prepend('&lt;%= j render @pedidoliberado %&gt;');\n\n});\n$(\"#notice\").html(\"&lt;%= escape_javascript(render :partial =&gt; 'partials/flash' , :locals =&gt; { :flash =&gt; flash }).html_safe %&gt;\");\n\nsetTimeout(function(){\n  $('#notice').fadeIn(\"slow\", function() {\n    $(this).create();\n  })\n}, 1500);\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "memory-management", "sidekiq"], "comments": [{"owner": {"reputation": 1778, "user_id": 96737, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b4b379fcddfda99b441d86a3e013c16d?s=128&d=identicon&r=PG", "display_name": "Gaston", "link": "https://stackoverflow.com/users/96737/gaston"}, "edited": false, "score": 0, "creation_date": 1492531207, "post_id": 43475951, "comment_id": 74009341, "body": "Can you post the output of <code>ps au --sort=-%mem</code>? That will show the complete command and will confirm what those <code>bundle</code> processes are actually calling. Also, can you post the <code>top</code> output of your previous droplet? It will help to compare both outputs."}, {"owner": {"reputation": 1801, "user_id": 1135515, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/21noA.png?s=128&g=1", "display_name": "Dan Tappin", "link": "https://stackoverflow.com/users/1135515/dan-tappin"}, "reply_to_user": {"reputation": 1778, "user_id": 96737, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b4b379fcddfda99b441d86a3e013c16d?s=128&d=identicon&r=PG", "display_name": "Gaston", "link": "https://stackoverflow.com/users/96737/gaston"}, "edited": false, "score": 0, "creation_date": 1492553666, "post_id": 43475951, "comment_id": 74022093, "body": "I am guessing you meant <code>ps aux --sort=-%mem</code>"}], "answers": [{"comments": [{"owner": {"reputation": 1801, "user_id": 1135515, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/21noA.png?s=128&g=1", "display_name": "Dan Tappin", "link": "https://stackoverflow.com/users/1135515/dan-tappin"}, "edited": false, "score": 0, "creation_date": 1492553782, "post_id": 43479849, "comment_id": 74022142, "body": "Thanks Mike - I know I have lots of clean / refactoring etc. to do which I am sure will help."}], "tags": [], "owner": {"reputation": 17782, "user_id": 1494519, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af54a0871600db7fbdbb5c558a6e29a3?s=128&d=identicon&r=PG", "display_name": "Mike Perham", "link": "https://stackoverflow.com/users/1494519/mike-perham"}, "is_accepted": false, "score": 1, "last_activity_date": 1492540802, "creation_date": 1492540802, "answer_id": 43479849, "question_id": 43475951, "link": "https://stackoverflow.com/questions/43475951/rails-app-sidekiq-high-memory-usage/43479849#43479849", "title": "Rails app Sidekiq high memory usage", "body": "<p>There's tons of reasons why your Ruby process might be eating too much memory.  Any gem or app code can allocate any amount of memory so in general, it is impossible for SO to tell you why.  Here's one possible reason:</p>\n\n<p><a href=\"https://github.com/rails/rails/issues/27002#issuecomment-260086170\" rel=\"nofollow noreferrer\">https://github.com/rails/rails/issues/27002#issuecomment-260086170</a></p>\n"}, {"comments": [{"owner": {"reputation": 1801, "user_id": 1135515, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/21noA.png?s=128&g=1", "display_name": "Dan Tappin", "link": "https://stackoverflow.com/users/1135515/dan-tappin"}, "edited": false, "score": 0, "creation_date": 1492553735, "post_id": 43481873, "comment_id": 74022120, "body": "This is the best answer - my code will effect that but the concurrency was the biggest one by far.  Thanks"}, {"owner": {"reputation": 1801, "user_id": 1135515, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/21noA.png?s=128&g=1", "display_name": "Dan Tappin", "link": "https://stackoverflow.com/users/1135515/dan-tappin"}, "edited": false, "score": 0, "creation_date": 1492632520, "post_id": 43481873, "comment_id": 74064905, "body": "Hmmmm... WTH. It dropped right off to 80% but now slowly creeped right back to 95%"}], "tags": [], "owner": {"reputation": 134, "user_id": 602912, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2e13462d4ab0296d2e892fe48c3e47ef?s=128&d=identicon&r=PG", "display_name": "Rub&#233;n T.F.", "link": "https://stackoverflow.com/users/602912/rub%c3%a9n-t-f"}, "is_accepted": false, "score": 1, "last_activity_date": 1492548285, "creation_date": 1492548285, "answer_id": 43481873, "question_id": 43475951, "link": "https://stackoverflow.com/questions/43475951/rails-app-sidekiq-high-memory-usage/43481873#43481873", "title": "Rails app Sidekiq high memory usage", "body": "<p>Keep an eye on how many Sidekiq processes do you have running, what is the configured concurrency, the polling and also the number of queues you use. A high number of any of those can cause high memory usage. You can tweak those values in your <code>sidekiq.yml</code> and test-drive how they affect to your environment.</p>\n\n<p>For more info: <a href=\"https://github.com/mperham/sidekiq/wiki/Advanced-Options\" rel=\"nofollow noreferrer\">https://github.com/mperham/sidekiq/wiki/Advanced-Options</a></p>\n"}], "owner": {"reputation": 1801, "user_id": 1135515, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/21noA.png?s=128&g=1", "display_name": "Dan Tappin", "link": "https://stackoverflow.com/users/1135515/dan-tappin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3773, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1492553648, "creation_date": 1492528301, "last_edit_date": 1492553648, "question_id": 43475951, "link": "https://stackoverflow.com/questions/43475951/rails-app-sidekiq-high-memory-usage", "title": "Rails app Sidekiq high memory usage", "body": "<p>I have a Rails 4 app deployed on Digital Ocean using Ubuntu 14.04.5 LTS.  The app seems to run fine but the system runs at 95% memory all the time.  I even upgraded the droplet to double the RAM and it's still at 95%.</p>\n\n<p>Here is my top output:</p>\n\n<pre><code>top - 11:03:54 up  8:37,  1 user,  load average: 0.00, 0.03, 0.05\nTasks: 118 total,   1 running, 117 sleeping,   0 stopped,   0 zombie\n%Cpu(s):  0.2 us,  0.2 sy,  0.0 ni, 99.7 id,  0.0 wa,  0.0 hi,  0.0 si,  0.0 st\nKiB Mem:   2049956 total,  1980616 used,    69340 free,     8708 buffers\nKiB Swap:  1048572 total,  1036928 used,    11644 free.    47864 cached Mem\n\n  PID USER      PR  NI    VIRT    RES    SHR S  %CPU %MEM     TIME+ COMMAND                                                                                                                                                               \n 7510 ubuntu    20   0  780436 274428   2540 S   0.0 13.4   0:27.66 ruby                                                                                                                                                                  \n 1313 root      20   0 1921472 250948   2700 S   0.0 12.2   1:42.70 bundle                                                                                                                                                                \n 1315 root      20   0 1876992 246204   2664 S   0.0 12.0   1:44.10 bundle                                                                                                                                                                \n 1359 root      20   0 1928636 236168   2692 S   0.0 11.5   1:42.58 bundle                                                                                                                                                                \n 6408 ubuntu    20   0  781764 175368   2244 S   0.3  8.6   1:10.81 ruby                                                                                                                                                                  \n 8681 ubuntu    20   0  984140 156708   1884 S   0.3  7.6   1:37.95 ruby                                                                                                                                                                  \n 8810 ubuntu    20   0  646824 117356   2548 S   0.0  5.7   0:11.07 ruby                                                                                                                                                                  \n 8821 ubuntu    20   0  646920 112728   2532 S   0.0  5.5   0:11.48 ruby                                                                                                                                                                  \n 8797 ubuntu    20   0  646728  82372   2960 S   0.0  4.0   0:14.33 ruby                                                                                                                                                                  \n 1932 ubuntu    20   0  332292  56948   1552 S   0.0  2.8   0:04.88 ruby\n</code></pre>\n\n<p>I know there are tons of blog posts etc. on Rail app memory optimization.  The 3 bundle processes are what confuses me.  My app (actually 2 apps - one production and one staging) uses Redis / Sidekiq which are the bundle processes.  So my question(s) are:</p>\n\n<p>1) Is this 'normal'?</p>\n\n<p>2) If not is there a way to start troubleshooting this?</p>\n\n<p><strong>UPDATE</strong></p>\n\n<p>Here is the top output:</p>\n\n<pre><code>ubuntu@rails-01:~$ ps aux --sort=-%mem\nUSER       PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND\nroot      1291  8.8  9.4 846856 194624 ?       Sl   18:04   0:23 sidekiq 4.2.10 production [0 of 3 busy]                                                                                  \nroot      1411  8.9  9.4 846824 194532 ?       Sl   18:04   0:24 sidekiq 4.2.10 production [0 of 3 busy]                                                                                  \nroot      1272  9.1  9.4 712752 193516 ?       Sl   18:04   0:24 sidekiq 4.2.10 staging [0 of 1 busy]                                                                                  \nubuntu    2254  0.6  9.3 645792 192648 ?       Sl   18:05   0:01 Passenger RubyApp: /home/ubuntu/production/current/public (production)\nubuntu    1986  0.6  9.3 645048 192064 ?       Sl   18:05   0:01 Passenger RubyApp: /home/ubuntu/staging/current/public (staging)\nubuntu    1762  9.8  9.2 375520 190264 ?       Sl   18:04   0:24 Passenger AppPreloader: /home/ubuntu/production/current   \nubuntu    1678  9.5  9.2 374872 189588 ?       Sl   18:04   0:25 Passenger AppPreloader: /home/ubuntu/staging/current      \nubuntu    2082  0.2  9.1 645144 187524 ?       Sl   18:05   0:00 Passenger RubyApp: /home/ubuntu/staging/current/public (staging)\nubuntu    1839  2.9  3.9 197300 79976 ?        Sl   18:04   0:06 Passenger AppPreloader: /home/ubuntu/landing/current      \nubuntu    1962  0.1  3.8 332292 78720 ?        Sl   18:05   0:00 Passenger RubyApp: /home/ubuntu/landing/current/public (production)\nubuntu    1969  0.0  3.7 332388 76044 ?        Sl   18:05   0:00 Passenger RubyApp: /home/ubuntu/landing/current/public (production)\n</code></pre>\n\n<p>I forgot I have 2 production workers on the server and 1 staging.  I had concurrency at 5 and 2 but I then lowered that to 3 and 1.  All Sidekiq is doing is some low level upload image processing and bulk record creations, updated and deletes that I don't want the user to sit around waiting for a page load on.</p>\n\n<p>I am now seeing it level off at 80%.  Better but still seems high.  I think the next will be lots of code optimization etc.  I am sure I have lots of things I can find here.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-5", "has-one"], "comments": [{"owner": {"reputation": 2116, "user_id": 6780663, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9207ba3b9163582570078b687f9b2792?s=128&d=identicon&r=PG&f=1", "display_name": "Alejandro Montilla", "link": "https://stackoverflow.com/users/6780663/alejandro-montilla"}, "edited": false, "score": 2, "creation_date": 1492527396, "post_id": 43475498, "comment_id": 74006345, "body": "You cant pass a object to the params hash like that. You could try sending the <code>id</code> of that object and later find that the object in your destination."}], "answers": [{"comments": [{"owner": {"reputation": 313, "user_id": 7511524, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/TXVnb.jpg?s=128&g=1", "display_name": "Manspider", "link": "https://stackoverflow.com/users/7511524/manspider"}, "edited": false, "score": 0, "creation_date": 1492589236, "post_id": 43476033, "comment_id": 74034696, "body": "I tried this but I get this error now <code>undefined method </code>pilot_id&#39; for #&lt;Starship id: nil, name: nil, created_at: nil, updated_at: nil&gt; Did you mean? pilot`. Any Idea of where I may have made a mistake ?"}, {"owner": {"reputation": 32451, "user_id": 2516474, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a2179a340c0e84edc285d432211145d?s=128&d=identicon&r=PG", "display_name": "SteveTurczyn", "link": "https://stackoverflow.com/users/2516474/steveturczyn"}, "reply_to_user": {"reputation": 313, "user_id": 7511524, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/TXVnb.jpg?s=128&g=1", "display_name": "Manspider", "link": "https://stackoverflow.com/users/7511524/manspider"}, "edited": false, "score": 0, "creation_date": 1492594531, "post_id": 43476033, "comment_id": 74038289, "body": "Ah, right, sorry, it&#39;s a <code>has_one</code>.  Answer modified.  Cheers"}], "tags": [], "owner": {"reputation": 32451, "user_id": 2516474, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a2179a340c0e84edc285d432211145d?s=128&d=identicon&r=PG", "display_name": "SteveTurczyn", "link": "https://stackoverflow.com/users/2516474/steveturczyn"}, "is_accepted": true, "score": 6, "last_activity_date": 1492594512, "last_edit_date": 1492594512, "creation_date": 1492528515, "answer_id": 43476033, "question_id": 43475498, "link": "https://stackoverflow.com/questions/43475498/model-expected-got-string-error-when-using-select-tag/43476033#43476033", "title": "Model(#...) expected, got String(#...) error when using select tag", "body": "<p>Use collection select and return just the pilot id.</p>\n\n<pre><code>&lt;%= f.collection_select(:pilot_id, Pilot.all, :id, :name) %&gt;\n</code></pre>\n\n<p>Note that you'll need to change your starship_params</p>\n\n<pre><code>  def starship_params\n    params.require(:starship).permit(:name, :pilot_id)\n  end\n</code></pre>\n\n<p>Add an attr_accessor for :pilot_id</p>\n\n<pre><code>class Starship &lt; ApplicationRecord\n  attr_accessor :pilot_id\n</code></pre>\n\n<p>Modify your create as follows...</p>\n\n<pre><code>def create\n  @starship = Starship.new(starship_params)\n  @starship.pilot = Pilot.find(@starship.pilot_id)\n  respond_to do |format|\n    ...\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 313, "user_id": 7511524, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/TXVnb.jpg?s=128&g=1", "display_name": "Manspider", "link": "https://stackoverflow.com/users/7511524/manspider"}, "edited": false, "score": 0, "creation_date": 1492592097, "post_id": 43476203, "comment_id": 74036566, "body": "I got <code>Couldn&#39;t find Pilot without an ID</code>. I tried with <code>f.select :pilot</code> and <code>params.require(:starship).permit(:name, :pilot)</code> instead and got the original error again"}], "tags": [], "owner": {"reputation": 639, "user_id": 7046734, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RQ62P.jpg?s=128&g=1", "display_name": "Mayank", "link": "https://stackoverflow.com/users/7046734/mayank"}, "is_accepted": false, "score": 1, "last_activity_date": 1492529028, "creation_date": 1492529028, "answer_id": 43476203, "question_id": 43475498, "link": "https://stackoverflow.com/questions/43475498/model-expected-got-string-error-when-using-select-tag/43476203#43476203", "title": "Model(#...) expected, got String(#...) error when using select tag", "body": "<p>You have a one to one optional relationship. Just listing all pilots can overwrite them. Its better to create a new pilot than assigning one from whole list.</p>\n\n<p>Still if you want to use try this code. Remember you can also use <code>Pilot.pluck(:id)</code> below if you want to transfer pilot.</p>\n\n<pre><code>&lt;div class=\"field\"&gt;\n  &lt;%= f.label :pilot_id %&gt;\n  &lt;%= f.select :pilot_id, Pilot.where('starship_id is NULL').pluck(:id) %&gt;\n&lt;/div&gt;\n</code></pre>\n\n<p>Now in your <code>starship_controller</code>  create method\nwrite </p>\n\n<pre><code>def create\n    @starship = Starship.new(starship_params)\n    pilot = @starship.build_pilot\n    pilot.id= params[:starship][:pilot_id]\n    pilot.reload\n    respond_to do |format|\n      if @starship.save\n        format.html { redirect_to root_path, notice: 'Starship successfully created.' }\n       else\n         format.html { redirect_to root_path, notice: 'Error occured.' }\n       end\nend\n</code></pre>\n\n<p>Your strong params should be</p>\n\n<pre><code>def starship_params\n    params.require(:starship).permit(:name, :pilot_id)\nend\n</code></pre>\n\n<p>Hope this helps...</p>\n"}, {"comments": [{"owner": {"reputation": 313, "user_id": 7511524, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/TXVnb.jpg?s=128&g=1", "display_name": "Manspider", "link": "https://stackoverflow.com/users/7511524/manspider"}, "edited": false, "score": 0, "creation_date": 1492589060, "post_id": 43478863, "comment_id": 74034601, "body": "Still got the same error here but with this hash now <code>{&quot;name&quot;=&gt;&quot;Nostromo&quot;, &quot;pilot&quot;=&gt;&quot;2&quot;}</code>"}], "tags": [], "owner": {"reputation": 104, "user_id": 7884173, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kDyf2NzUs6Q/AAAAAAAAAAI/AAAAAAAAABA/XKDrrtxQp0Y/photo.jpg?sz=128", "display_name": "Tushar Kulkarni", "link": "https://stackoverflow.com/users/7884173/tushar-kulkarni"}, "is_accepted": false, "score": 0, "last_activity_date": 1492537735, "last_edit_date": 1492537735, "creation_date": 1492537280, "answer_id": 43478863, "question_id": 43475498, "link": "https://stackoverflow.com/questions/43475498/model-expected-got-string-error-when-using-select-tag/43478863#43478863", "title": "Model(#...) expected, got String(#...) error when using select tag", "body": "<blockquote>\n  <p>Just replace below code with your code and you are good to go.</p>\n</blockquote>\n\n<p></p>\n\n<pre><code>&lt;%= f.label :pilot %&gt;\n&lt;%= f.select :pilot, Pilot.all.map{ |p| [p.name, p.id] } %&gt;\n</code></pre>\n\n<p></p>\n\n<p>This will show pilot's name in the select dropdown and will save particular pilot's id while saving.</p>\n"}], "owner": {"reputation": 313, "user_id": 7511524, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/TXVnb.jpg?s=128&g=1", "display_name": "Manspider", "link": "https://stackoverflow.com/users/7511524/manspider"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1946, "favorite_count": 1, "accepted_answer_id": 43476033, "answer_count": 3, "score": 3, "last_activity_date": 1492594512, "creation_date": 1492527119, "question_id": 43475498, "link": "https://stackoverflow.com/questions/43475498/model-expected-got-string-error-when-using-select-tag", "title": "Model(#...) expected, got String(#...) error when using select tag", "body": "<p>I scaffolded a simple example to illustrate a problem I'm having.\nIn this example I have a Starship and a Pilot. I want to be able to assign an existing pilot to the starship at creation.</p>\n\n<p><strong>starship.rb</strong></p>\n\n<pre><code>class Starship &lt; ApplicationRecord\n  has_one :pilot\n\n  validates :name, presence: true\nend\n</code></pre>\n\n<p><strong>pilot.rb</strong></p>\n\n<pre><code>class Pilot &lt; ApplicationRecord\n  belongs_to :starship, optional: true\n\n  validates :name, presence: true\nend\n</code></pre>\n\n<p><strong>starships/_form.html.erb</strong></p>\n\n<pre><code>&lt;div class=\"field\"&gt;\n  &lt;%= f.label :pilot %&gt;\n  &lt;%= f.select :pilot, Pilot.all %&gt;\n&lt;/div&gt;\n</code></pre>\n\n<p><strong>starships_controller.rb</strong></p>\n\n<pre><code>  def starship_params\n    params.require(:starship).permit(:name, :pilot)\n  end\n</code></pre>\n\n<p><strong>params hash</strong></p>\n\n<pre><code>{\"name\"=&gt;\"Nostromo\", \"pilot\"=&gt;\"#&lt;Pilot:0x007f85ff547f90&gt;\"}\n</code></pre>\n\n<p>And I get this error</p>\n\n<pre><code>Pilot(#70106745549840) expected, got String(#70106709663840)\n</code></pre>\n\n<p>I see that my pilot is sent as a string in the hash, but I don't seem to find how I am supposed to do it otherwise.</p>\n"}, {"tags": ["arrays", "ruby"], "comments": [{"owner": {"reputation": 35578, "user_id": 3000206, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/BK1fo.jpg?s=128&g=1", "display_name": "Carcigenicate", "link": "https://stackoverflow.com/users/3000206/carcigenicate"}, "edited": false, "score": 0, "creation_date": 1492525527, "post_id": 43474901, "comment_id": 74004804, "body": "You just need to swap each pair? What have you tried? There&#39;s many ways of going about this, and &quot;best&quot; is subjective."}], "answers": [{"tags": [], "owner": {"reputation": 270444, "user_id": 405017, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/2024054e404233ed97b7d9287aff103d?s=128&d=identicon&r=PG", "display_name": "Phrogz", "link": "https://stackoverflow.com/users/405017/phrogz"}, "is_accepted": true, "score": 5, "last_activity_date": 1492526845, "last_edit_date": 1492526845, "creation_date": 1492525581, "answer_id": 43474936, "question_id": 43474901, "link": "https://stackoverflow.com/questions/43474901/how-to-change-order-of-elements-in-array-of-arrays/43474936#43474936", "title": "How to change order of elements in array of arrays?", "body": "<p>Various options (each version followed by short-hand sugar):</p>\n\n<pre><code># Create a new array of swapped elements\nmy_array = my_array.map{ |a| a.reverse }\nmy_array = my_array.map(&amp;:reverse)\n\n# Mutate the existing array with swapped elements\nmy_array.map!{ |a| a.reverse }\nmy_array.map!(&amp;:reverse)\n\n# Mutate the elements in the existing array\nmy_array.each{ |a| a.reverse! }\nmy_array.each(&amp;:reverse!)\n</code></pre>\n\n<p>The first option is the 'safest', insofar as no existing arrays are modified (in case you have other references to them that should not be changed).</p>\n\n<p>The second option is roughly the same as the first, unless you had two references to <code>my_array</code> and wanted one of them unswapped.</p>\n\n<p>The third option is the most 'destructive'; every reference to the pairwise elements will be changed. However, it's also the most memory-efficient, because no new arrays are created.</p>\n"}, {"tags": [], "owner": {"reputation": 12629, "user_id": 4739257, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/MdhEs.jpg?s=128&g=1", "display_name": "Ilya", "link": "https://stackoverflow.com/users/4739257/ilya"}, "is_accepted": false, "score": 2, "last_activity_date": 1492536529, "last_edit_date": 1492536529, "creation_date": 1492534246, "answer_id": 43477928, "question_id": 43474901, "link": "https://stackoverflow.com/questions/43474901/how-to-change-order-of-elements-in-array-of-arrays/43477928#43477928", "title": "How to change order of elements in array of arrays?", "body": "<p>Just-for-fun answer (rotate the matrix like rubik's cube):</p>\n\n<pre><code>array = [[:name1, :value1], [:name2, :value2]]\narray.transpose # [[:name1, :name2], [:value1, :value2]]\n     .reverse   # [[:value1, :value2], [:name1, :name2]]\n     .transpose\n#=&gt; [[:value1, :name1], [:value2, :name2]]\n</code></pre>\n\n<p>One more (not as funny and obvious, but still possible) way:</p>\n\n<pre><code>array.inject(&amp;:zip).reverse.inject(&amp;:zip)\n#=&gt; [[:value1, :name1], [:value2, :name2]]\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 2450, "user_id": 1114667, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/c855f4e65f04cfbbe403fdb18e32fdfd?s=128&d=identicon&r=PG", "display_name": "Ilya Lavrov", "link": "https://stackoverflow.com/users/1114667/ilya-lavrov"}, "edited": false, "score": 0, "creation_date": 1492538838, "post_id": 43478257, "comment_id": 74013966, "body": "This solution expect all names and values are unique."}], "tags": [], "owner": {"reputation": 2450, "user_id": 1114667, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/c855f4e65f04cfbbe403fdb18e32fdfd?s=128&d=identicon&r=PG", "display_name": "Ilya Lavrov", "link": "https://stackoverflow.com/users/1114667/ilya-lavrov"}, "is_accepted": false, "score": 0, "last_activity_date": 1492535274, "creation_date": 1492535274, "answer_id": 43478257, "question_id": 43474901, "link": "https://stackoverflow.com/questions/43474901/how-to-change-order-of-elements-in-array-of-arrays/43478257#43478257", "title": "How to change order of elements in array of arrays?", "body": "<p>One more way is to use <code>to_h</code> <code>to_a</code>:</p>\n\n<pre><code>array = [[:name1, :value2], [:name2, :value2]]\narray.to_h   # {name1: :value1, name2: :value2}\n     .invert # {value1: :name1, value2: :name2}\n     .to_a   # [[:value1, :name1], [:value2, :name2]]\n</code></pre>\n"}], "owner": {"reputation": 2450, "user_id": 1114667, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/c855f4e65f04cfbbe403fdb18e32fdfd?s=128&d=identicon&r=PG", "display_name": "Ilya Lavrov", "link": "https://stackoverflow.com/users/1114667/ilya-lavrov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 249, "favorite_count": 0, "accepted_answer_id": 43474936, "answer_count": 3, "score": 0, "last_activity_date": 1492536529, "creation_date": 1492525486, "last_edit_date": 1492526194, "question_id": 43474901, "link": "https://stackoverflow.com/questions/43474901/how-to-change-order-of-elements-in-array-of-arrays", "title": "How to change order of elements in array of arrays?", "body": "<p>I want to transform the array</p>\n\n<pre><code>[[:name1, :value1], [:name2, :value2]]\n</code></pre>\n\n<p>to array</p>\n\n<pre><code>[[:value1, :name1], [:value2, :name2]]\n</code></pre>\n\n<p>What is the best way to do this?</p>\n"}, {"tags": ["ruby", "watir", "watir-webdriver", "pageobjects", "page-object-gem"], "answers": [{"comments": [{"owner": {"reputation": 45, "user_id": 7499041, "user_type": "registered", "accept_rate": 60, "profile_image": "https://lh4.googleusercontent.com/-gLueZSFWHjc/AAAAAAAAAAI/AAAAAAAAFJc/8neg8JhuRFo/photo.jpg?sz=128", "display_name": "Ram Kumar", "link": "https://stackoverflow.com/users/7499041/ram-kumar"}, "edited": false, "score": 0, "creation_date": 1492525754, "post_id": 43474863, "comment_id": 74004982, "body": "We use some format and it doesn&#39;t matter on passing arguments"}], "tags": [], "owner": {"reputation": 1379, "user_id": 2101252, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JXPjA.jpg?s=128&g=1", "display_name": "s1mpl3", "link": "https://stackoverflow.com/users/2101252/s1mpl3"}, "is_accepted": false, "score": 0, "last_activity_date": 1492525382, "creation_date": 1492525382, "answer_id": 43474863, "question_id": 43474621, "link": "https://stackoverflow.com/questions/43474621/converting-string-to-element-in-page-object/43474863#43474863", "title": "converting string to element in page object", "body": "<p>I haven't used that gem but the argument in the method is wrong. Instead of</p>\n\n<pre><code>def click_link(args:) \n</code></pre>\n\n<p>use</p>\n\n<pre><code>def click_link(args) \n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 45, "user_id": 7499041, "user_type": "registered", "accept_rate": 60, "profile_image": "https://lh4.googleusercontent.com/-gLueZSFWHjc/AAAAAAAAAAI/AAAAAAAAFJc/8neg8JhuRFo/photo.jpg?sz=128", "display_name": "Ram Kumar", "link": "https://stackoverflow.com/users/7499041/ram-kumar"}, "edited": false, "score": 0, "creation_date": 1492575877, "post_id": 43475242, "comment_id": 74027970, "body": "Exactly the one I want.. Thanks"}], "tags": [], "owner": {"reputation": 44680, "user_id": 1200545, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbbfea5f6583c16f96fc11ef821cfeee?s=128&d=identicon&r=PG&f=1", "display_name": "Justin Ko", "link": "https://stackoverflow.com/users/1200545/justin-ko"}, "is_accepted": true, "score": 3, "last_activity_date": 1492526420, "creation_date": 1492526420, "answer_id": 43475242, "question_id": 43474621, "link": "https://stackoverflow.com/questions/43474621/converting-string-to-element-in-page-object/43475242#43475242", "title": "converting string to element in page object", "body": "<p>You can use <code>send</code> to convert a String to method call:</p>\n\n<pre><code>def click_link(text)\n  send(\"link_for_#{text}\")\nend\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 104, "user_id": 7884173, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kDyf2NzUs6Q/AAAAAAAAAAI/AAAAAAAAABA/XKDrrtxQp0Y/photo.jpg?sz=128", "display_name": "Tushar Kulkarni", "link": "https://stackoverflow.com/users/7884173/tushar-kulkarni"}, "is_accepted": false, "score": 0, "last_activity_date": 1492538518, "creation_date": 1492538518, "answer_id": 43479225, "question_id": 43474621, "link": "https://stackoverflow.com/questions/43474621/converting-string-to-element-in-page-object/43479225#43479225", "title": "converting string to element in page object", "body": "<p>Below mentioned code will solve your problem:</p>\n\n<p>(\"link_for_#{args}_element\")</p>\n\n<p>When you need to write/get dynamic value from any ruby variable in double quotes use \"#{variable}\" syntax.</p>\n"}], "owner": {"reputation": 45, "user_id": 7499041, "user_type": "registered", "accept_rate": 60, "profile_image": "https://lh4.googleusercontent.com/-gLueZSFWHjc/AAAAAAAAAAI/AAAAAAAAFJc/8neg8JhuRFo/photo.jpg?sz=128", "display_name": "Ram Kumar", "link": "https://stackoverflow.com/users/7499041/ram-kumar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 450, "favorite_count": 0, "accepted_answer_id": 43475242, "answer_count": 3, "score": -1, "last_activity_date": 1492558523, "creation_date": 1492524748, "last_edit_date": 1492558523, "question_id": 43474621, "link": "https://stackoverflow.com/questions/43474621/converting-string-to-element-in-page-object", "title": "converting string to element in page object", "body": "<p>Page object gem with ruby, and I have defined some number of page-objects for links like:</p>\n\n<pre><code>  link(:link_for_1week, text: /1 wk/)\n  link(:link_for_2week, text: /2 wks/)\n  link(:link_for_3week, text: /3 wks/)\n  link(:link_for_4week, text: /4 wks/)\n  link(:link_for_5week, text: /5 wks/)\n  link(:link_for_6week, text: /6 wks/)\n  link(:link_for_2months, text: /2 mo/)\n  link(:link_for_3months, text: /3 mo/)\n  link(:link_for_6months, text: /6 mo/)\n  link(:link_for_1year, text: /1 yr/)\n</code></pre>\n\n<p>and I am having a method to call these links dynamically with user input:</p>\n\n<pre><code>If I give user input as '1week' it has to click on 'link_for_1week'\nIf I give user input as '2week' it has to click on 'link_for_2week' \nand so\n</code></pre>\n\n<p>I don't know how to do and I even used instance_eval, but it doesn't work:</p>\n\n<pre><code>def click_link(args:)\n  self.browser.instance_eval('link_for_'+args+'_element.click')\nend\n</code></pre>\n\n<p>But am not able to click the link.</p>\n\n<p>I am not sure on using this instance_eval.. apart from instance_eval also most welcomed...</p>\n"}, {"tags": ["ruby", "sequel"], "comments": [{"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 0, "creation_date": 1492540120, "post_id": 43474031, "comment_id": 74014831, "body": "Without examples of your code it&#39;s difficult to do more than throw out broad suggestions. (Read &quot;<a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>&quot; and the linked page.)"}, {"owner": {"reputation": 3685, "user_id": 868273, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/5f15d325ebd0a236f9a4a2a5d2501c96?s=128&d=identicon&r=PG", "display_name": "okliv", "link": "https://stackoverflow.com/users/868273/okliv"}, "reply_to_user": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 0, "creation_date": 1492550604, "post_id": 43474031, "comment_id": 74020869, "body": "i&#39;ve got an answer. accepted it (Jeremy answered exactly what i asked). what do i have to read more? thanks a lot for your anxiety."}], "answers": [{"comments": [{"owner": {"reputation": 3685, "user_id": 868273, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/5f15d325ebd0a236f9a4a2a5d2501c96?s=128&d=identicon&r=PG", "display_name": "okliv", "link": "https://stackoverflow.com/users/868273/okliv"}, "edited": false, "score": 0, "creation_date": 1492526827, "post_id": 43474891, "comment_id": 74005857, "body": "thanks for the hack, Jeremy. i realize it looks like a not well designed solution but in my case there is really no way to freeze a db structure while app is running. so i need to actualize a connection from time to time. maybe restarting the process - is a solution too , but am i wrong it is much more slower / heavier than the schema clearing? (and, in fact, i didn&#39;t consider this possibility, for now, to do it programmatically from an app controller, for example)"}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "reply_to_user": {"reputation": 3685, "user_id": 868273, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/5f15d325ebd0a236f9a4a2a5d2501c96?s=128&d=identicon&r=PG", "display_name": "okliv", "link": "https://stackoverflow.com/users/868273/okliv"}, "edited": false, "score": 1, "creation_date": 1492529269, "post_id": 43474891, "comment_id": 74007836, "body": "@okliv why is there no way to &quot;freeze&quot; the db structure are you allowing users to change the structure of the database in real time? This seems like it might be a design flaw unless you can thoroughly explain a use case for this."}, {"owner": {"reputation": 3685, "user_id": 868273, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/5f15d325ebd0a236f9a4a2a5d2501c96?s=128&d=identicon&r=PG", "display_name": "okliv", "link": "https://stackoverflow.com/users/868273/okliv"}, "reply_to_user": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1492529354, "post_id": 43474891, "comment_id": 74007925, "body": "@engineersmnky, because this is the &quot;admin&quot; app to manage db structure =)"}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "reply_to_user": {"reputation": 3685, "user_id": 868273, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/5f15d325ebd0a236f9a4a2a5d2501c96?s=128&d=identicon&r=PG", "display_name": "okliv", "link": "https://stackoverflow.com/users/868273/okliv"}, "edited": false, "score": 0, "creation_date": 1492529447, "post_id": 43474891, "comment_id": 74007991, "body": "@okliv there are ways to simulate table change by using vertical tables rather than altering table structure horizontally."}, {"owner": {"reputation": 3685, "user_id": 868273, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/5f15d325ebd0a236f9a4a2a5d2501c96?s=128&d=identicon&r=PG", "display_name": "okliv", "link": "https://stackoverflow.com/users/868273/okliv"}, "reply_to_user": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1492529575, "post_id": 43474891, "comment_id": 74008083, "body": "@engineersmnky you are totally right except that is not my case :)"}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "reply_to_user": {"reputation": 3685, "user_id": 868273, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/5f15d325ebd0a236f9a4a2a5d2501c96?s=128&d=identicon&r=PG", "display_name": "okliv", "link": "https://stackoverflow.com/users/868273/okliv"}, "edited": false, "score": 2, "creation_date": 1492529643, "post_id": 43474891, "comment_id": 74008135, "body": "@okliv best of luck (seems like a rabbit hole I would try and avoid)"}, {"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 1, "creation_date": 1492540325, "post_id": 43474891, "comment_id": 74014951, "body": "If you are changing the DB under the code, perhaps you should connect to  the DB immediately before you need it then close it as soon as you are finished with an action. That way you&#39;re working in tiny bursts, not expecting the DB schema to be in a certain state. I agree with Jeremy and engineersmnky, what you&#39;re doing is not good practice, even if you&#39;re trying to write an &quot;admin&quot; app. The goal of the code doesn&#39;t make it safe to do things that are bad practice, instead you need more robustness. Jeremy is the expert on how Sequel works so his opinions should hold a lot of weight."}, {"owner": {"reputation": 828, "user_id": 2696867, "user_type": "registered", "profile_image": "https://graph.facebook.com/1294176482/picture?type=large", "display_name": "animatedgif", "link": "https://stackoverflow.com/users/2696867/animatedgif"}, "edited": false, "score": 0, "creation_date": 1591045838, "post_id": 43474891, "comment_id": 109903235, "body": "Jeremy, is <code>get_db_schema</code> a replacement for this? Or does that do something else and I&#39;m not following correctly. Thanks"}], "tags": [], "owner": {"reputation": 11331, "user_id": 132053, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f183bcc4176b308c9edabe79299e448f?s=128&d=identicon&r=PG", "display_name": "Jeremy Evans", "link": "https://stackoverflow.com/users/132053/jeremy-evans"}, "is_accepted": true, "score": 4, "last_activity_date": 1492525463, "creation_date": 1492525463, "answer_id": 43474891, "question_id": 43474031, "link": "https://stackoverflow.com/questions/43474031/how-to-refresh-db-connection-with-sequel/43474891#43474891", "title": "How to refresh DB connection with Sequel", "body": "<p>You shouldn't be changing the structure of the database in an incompatible way while Sequel is running.  The easiest way to solve this issue is just to restart the process after changing the database schema, and Sequel will pick up the new database structure.</p>\n\n<p>If you really wanted to try to do this without restarting the process, you could remove the cached schemas (<code>@db.instance_variable_get(:@schemas).clear</code>), and reset the dataset for all model classes (<code>ModelClass.dataset = ModelClass.dataset</code> for each Sequel::Model).  However, that doesn't necessarily result in the same thing, since if you remove a column, the old column name will still have a method defined for it.</p>\n"}], "owner": {"reputation": 3685, "user_id": 868273, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/5f15d325ebd0a236f9a4a2a5d2501c96?s=128&d=identicon&r=PG", "display_name": "okliv", "link": "https://stackoverflow.com/users/868273/okliv"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 416, "favorite_count": 0, "accepted_answer_id": 43474891, "answer_count": 1, "score": 0, "last_activity_date": 1492539863, "creation_date": 1492523165, "last_edit_date": 1492539863, "question_id": 43474031, "link": "https://stackoverflow.com/questions/43474031/how-to-refresh-db-connection-with-sequel", "title": "How to refresh DB connection with Sequel", "body": "<p>I use <code>Sequel::Model.DB</code> to interact with my DB, but for some reason, the DB structure was changed, for example, via the DB console.</p>\n\n<p>This method:</p>\n\n<pre><code>Sequel::Model.db.schema('table_name')\n</code></pre>\n\n<p>still returns the old DB, cached from the first connection I guess.</p>\n\n<p>How can I reset that cache or, ideally, ensure the actual DB connection on each request?</p>\n\n<p>I tried to use a new connection every time:</p>\n\n<pre><code>def db\n  @db ||= Sequel.connect(Sequel::Model.db.opts)\nend\n</code></pre>\n\n<p>but, predictably, I got this error eventually:</p>\n\n<pre><code>Sequel::DatabaseConnectionError - PG::ConnectionBad: FATAL:  sorry, too many clients already\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "github", "capistrano"], "comments": [{"owner": {"reputation": 1, "user_id": 7884418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a70bc525de0eb31e4e20a7403658fdf?s=128&d=identicon&r=PG&f=1", "display_name": "gerzson", "link": "https://stackoverflow.com/users/7884418/gerzson"}, "reply_to_user": {"reputation": 418, "user_id": 6331585, "user_type": "registered", "accept_rate": 60, "profile_image": "https://lh5.googleusercontent.com/--Spi1QdCgC0/AAAAAAAAAAI/AAAAAAAABnU/sJNL2oLTBHY/photo.jpg?sz=128", "display_name": "Vishwas Nahar", "link": "https://stackoverflow.com/users/6331585/vishwas-nahar"}, "edited": false, "score": 0, "creation_date": 1492522949, "post_id": 43473894, "comment_id": 74002688, "body": "I want to deploy the preproduction branch"}, {"owner": {"reputation": 418, "user_id": 6331585, "user_type": "registered", "accept_rate": 60, "profile_image": "https://lh5.googleusercontent.com/--Spi1QdCgC0/AAAAAAAAAAI/AAAAAAAABnU/sJNL2oLTBHY/photo.jpg?sz=128", "display_name": "Vishwas Nahar", "link": "https://stackoverflow.com/users/6331585/vishwas-nahar"}, "edited": false, "score": 0, "creation_date": 1492522994, "post_id": 43473894, "comment_id": 74002726, "body": "did you run this : bundle exec git push origin preproduction"}, {"owner": {"reputation": 1, "user_id": 7884418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a70bc525de0eb31e4e20a7403658fdf?s=128&d=identicon&r=PG&f=1", "display_name": "gerzson", "link": "https://stackoverflow.com/users/7884418/gerzson"}, "reply_to_user": {"reputation": 418, "user_id": 6331585, "user_type": "registered", "accept_rate": 60, "profile_image": "https://lh5.googleusercontent.com/--Spi1QdCgC0/AAAAAAAAAAI/AAAAAAAABnU/sJNL2oLTBHY/photo.jpg?sz=128", "display_name": "Vishwas Nahar", "link": "https://stackoverflow.com/users/6331585/vishwas-nahar"}, "edited": false, "score": 0, "creation_date": 1492523042, "post_id": 43473894, "comment_id": 74002779, "body": "yes, and I get everyting up-to-date message. when I run the localhost, I can see the changes, but when I push to live, does not show."}, {"owner": {"reputation": 418, "user_id": 6331585, "user_type": "registered", "accept_rate": 60, "profile_image": "https://lh5.googleusercontent.com/--Spi1QdCgC0/AAAAAAAAAAI/AAAAAAAABnU/sJNL2oLTBHY/photo.jpg?sz=128", "display_name": "Vishwas Nahar", "link": "https://stackoverflow.com/users/6331585/vishwas-nahar"}, "edited": false, "score": 0, "creation_date": 1492523733, "post_id": 43473894, "comment_id": 74003346, "body": "try switch : bundle exec cap -S branch=preproduction deploy:setup"}, {"owner": {"reputation": 1, "user_id": 7884418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a70bc525de0eb31e4e20a7403658fdf?s=128&d=identicon&r=PG&f=1", "display_name": "gerzson", "link": "https://stackoverflow.com/users/7884418/gerzson"}, "reply_to_user": {"reputation": 418, "user_id": 6331585, "user_type": "registered", "accept_rate": 60, "profile_image": "https://lh5.googleusercontent.com/--Spi1QdCgC0/AAAAAAAAAAI/AAAAAAAABnU/sJNL2oLTBHY/photo.jpg?sz=128", "display_name": "Vishwas Nahar", "link": "https://stackoverflow.com/users/6331585/vishwas-nahar"}, "edited": false, "score": 0, "creation_date": 1492524106, "post_id": 43473894, "comment_id": 74003647, "body": "invalid option: -S"}, {"owner": {"reputation": 418, "user_id": 6331585, "user_type": "registered", "accept_rate": 60, "profile_image": "https://lh5.googleusercontent.com/--Spi1QdCgC0/AAAAAAAAAAI/AAAAAAAABnU/sJNL2oLTBHY/photo.jpg?sz=128", "display_name": "Vishwas Nahar", "link": "https://stackoverflow.com/users/6331585/vishwas-nahar"}, "edited": false, "score": 0, "creation_date": 1492524315, "post_id": 43473894, "comment_id": 74003828, "body": "Check this <a href=\"https://stackoverflow.com/questions/38700400/deploy-once-a-specific-branch-with-capistrano\" title=\"deploy once a specific branch with capistrano\">stackoverflow.com/questions/38700400/&hellip;</a>"}, {"owner": {"reputation": 1, "user_id": 7884418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a70bc525de0eb31e4e20a7403658fdf?s=128&d=identicon&r=PG&f=1", "display_name": "gerzson", "link": "https://stackoverflow.com/users/7884418/gerzson"}, "reply_to_user": {"reputation": 418, "user_id": 6331585, "user_type": "registered", "accept_rate": 60, "profile_image": "https://lh5.googleusercontent.com/--Spi1QdCgC0/AAAAAAAAAAI/AAAAAAAABnU/sJNL2oLTBHY/photo.jpg?sz=128", "display_name": "Vishwas Nahar", "link": "https://stackoverflow.com/users/6331585/vishwas-nahar"}, "edited": false, "score": 0, "creation_date": 1492524892, "post_id": 43473894, "comment_id": 74004271, "body": "I tried it, but is does not sort the issue as the preproduction still have the older version live."}], "owner": {"reputation": 1, "user_id": 7884418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a70bc525de0eb31e4e20a7403658fdf?s=128&d=identicon&r=PG&f=1", "display_name": "gerzson", "link": "https://stackoverflow.com/users/7884418/gerzson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 269, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1492523372, "creation_date": 1492522806, "last_edit_date": 1492523372, "question_id": 43473894, "link": "https://stackoverflow.com/questions/43473894/deployment-not-updating-the-local-branch-using-capistrano", "title": "deployment not updating the local branch using capistrano", "body": "<p>I am trying to deploy the changes in the repo I made locally(merged master to local branch), but while the changes work on localhost, it does not update in the deployment, using bundle exec cap preproduction deploy.\nI am new using capistrano. </p>\n\n<p>Any idea what I am doing wrong? </p>\n\n<p>Thanks</p>\n"}, {"tags": ["ruby", "http", "http-headers"], "comments": [{"owner": {"reputation": 81732, "user_id": 1427878, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/db5fbf44c0eeeaf38c4e4a54ce9eff7a?s=128&d=identicon&r=PG&f=1", "display_name": "CBroe", "link": "https://stackoverflow.com/users/1427878/cbroe"}, "edited": false, "score": 1, "creation_date": 1492522828, "post_id": 43473856, "comment_id": 74002571, "body": "<a href=\"https://docs.ruby-lang.org/en/2.0.0/Net/HTTP.html#class-Net::HTTP-label-Setting+Headers\" rel=\"nofollow noreferrer\">docs.ruby-lang.org/en/2.0.0/Net/&hellip;</a>"}, {"owner": {"reputation": 31, "user_id": 7829144, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/73bde03dee7fa67cc4124c7652db9016?s=128&d=identicon&r=PG&f=1", "display_name": "r.az91", "link": "https://stackoverflow.com/users/7829144/r-az91"}, "reply_to_user": {"reputation": 81732, "user_id": 1427878, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/db5fbf44c0eeeaf38c4e4a54ce9eff7a?s=128&d=identicon&r=PG&f=1", "display_name": "CBroe", "link": "https://stackoverflow.com/users/1427878/cbroe"}, "edited": false, "score": 0, "creation_date": 1492523525, "post_id": 43473856, "comment_id": 74003175, "body": "thank you for your answer, but i dont understand, how i can use these informations"}, {"owner": {"reputation": 81732, "user_id": 1427878, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/db5fbf44c0eeeaf38c4e4a54ce9eff7a?s=128&d=identicon&r=PG&f=1", "display_name": "CBroe", "link": "https://stackoverflow.com/users/1427878/cbroe"}, "edited": false, "score": 0, "creation_date": 1492523827, "post_id": 43473856, "comment_id": 74003426, "body": "Why not? What exactly is the problem?"}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 1, "creation_date": 1492529079, "post_id": 43473856, "comment_id": 74007702, "body": "@r.az91 did you read the link because amazingly both your questions were answered by that link without the need to even scroll. &quot;Setting Headers&quot; and &quot;Basic Authentication&quot; are right there and I don&#39;t mean to sound crass but if that part is not understandable is it possible you might be a little too new ruby to really be trying to make Net requests?"}, {"owner": {"reputation": 171, "user_id": 6781533, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-15wtcU_pJAA/AAAAAAAAAAI/AAAAAAAABpc/Xoq4Mr9HvRE/photo.jpg?sz=128", "display_name": "Carter Brainerd", "link": "https://stackoverflow.com/users/6781533/carter-brainerd"}, "edited": false, "score": 0, "creation_date": 1492534108, "post_id": 43473856, "comment_id": 74011122, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/587559/how-to-make-an-http-get-with-modified-headers\">How to make an HTTP GET with modified headers?</a>"}, {"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 0, "creation_date": 1492541215, "post_id": 43473856, "comment_id": 74015491, "body": "Please read &quot;<a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a>&quot; and &quot;<a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>&quot; and the linked pages, along with &quot;<a href=\"http://meta.stackoverflow.com/questions/261592\">How much research effort is expected of Stack Overflow users?</a>&quot;. We expect evidence of your effort in a question, where did you search and why didn&#39;t it help? What did you try and why didn&#39;t it work? Your example shows no such effort. Throwing up your hands and asking without that evidence is a good way to get your question closed as off-topic. As far as Net::HTTP, there are better libraries for writing clients. Net::HTTP is pretty low-level."}], "answers": [{"comments": [{"owner": {"reputation": 31, "user_id": 7829144, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/73bde03dee7fa67cc4124c7652db9016?s=128&d=identicon&r=PG&f=1", "display_name": "r.az91", "link": "https://stackoverflow.com/users/7829144/r-az91"}, "edited": false, "score": 0, "creation_date": 1492605124, "post_id": 43477883, "comment_id": 74045884, "body": "thank you for your help. i get a message: &quot;Connection reset by peer&quot;. how can I solve these Problem?"}, {"owner": {"reputation": 171, "user_id": 6781533, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-15wtcU_pJAA/AAAAAAAAAAI/AAAAAAAABpc/Xoq4Mr9HvRE/photo.jpg?sz=128", "display_name": "Carter Brainerd", "link": "https://stackoverflow.com/users/6781533/carter-brainerd"}, "reply_to_user": {"reputation": 31, "user_id": 7829144, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/73bde03dee7fa67cc4124c7652db9016?s=128&d=identicon&r=PG&f=1", "display_name": "r.az91", "link": "https://stackoverflow.com/users/7829144/r-az91"}, "edited": false, "score": 0, "creation_date": 1492608446, "post_id": 43477883, "comment_id": 74048420, "body": "See <a href=\"http://stackoverflow.com/questions/1434451/what-does-connection-reset-by-peer-mean\">here</a> to read more about the connection reset by peer error. It could be that the server only accepts certain headers and is denying your connection. Also, be sure that port 80/443 is open on the target you&#39;re trying to connect to."}], "tags": [], "owner": {"reputation": 171, "user_id": 6781533, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-15wtcU_pJAA/AAAAAAAAAAI/AAAAAAAABpc/Xoq4Mr9HvRE/photo.jpg?sz=128", "display_name": "Carter Brainerd", "link": "https://stackoverflow.com/users/6781533/carter-brainerd"}, "is_accepted": false, "score": 0, "last_activity_date": 1492534734, "last_edit_date": 1492534734, "creation_date": 1492534045, "answer_id": 43477883, "question_id": 43473856, "link": "https://stackoverflow.com/questions/43473856/how-can-i-make-http-requests-under-ruby-with-modified-header/43477883#43477883", "title": "How can I make HTTP Requests under Ruby with modified header?", "body": "<p>Instead of declaring the request as such: <code>Net::HTTP.get(uri)</code>,\nuse <code>.new</code>. </p>\n\n<p>So a rewrite of your code would be:</p>\n\n<pre class=\"lang-ruby prettyprint-override\"><code>uri = URI.parse('https://www.blablubbxxx0.com/')\nreq = Net::HTTP::Get.new(uri.path)\nreq.add_field(\"HeaderName\", \"HeaderValue\")    # Adding a header\nreq['If-Modified-Since'] = file.mtime.rfc2822 # Setting a header\n\n\nres = Net::HTTP.new(url.host, url.port).start do |http|\n  http.request(req)\nend\n</code></pre>\n\n<p>Code from <a href=\"https://dzone.com/articles/send-custom-headers-ruby\" rel=\"nofollow noreferrer\">https://dzone.com/articles/send-custom-headers-ruby</a></p>\n"}], "owner": {"reputation": 31, "user_id": 7829144, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/73bde03dee7fa67cc4124c7652db9016?s=128&d=identicon&r=PG&f=1", "display_name": "r.az91", "link": "https://stackoverflow.com/users/7829144/r-az91"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 42, "favorite_count": 0, "answer_count": 1, "score": -3, "last_activity_date": 1492534734, "creation_date": 1492522722, "question_id": 43473856, "link": "https://stackoverflow.com/questions/43473856/how-can-i-make-http-requests-under-ruby-with-modified-header", "title": "How can I make HTTP Requests under Ruby with modified header?", "body": "<p>how can I make HTTP Requests under Ruby with modiefied header?</p>\n\n<p>I want to add attributes like \"PublicKey\" and \"Accept\".</p>\n\n<p>And I want add a new authentication header value like \"Basic\".</p>\n\n<p>My approach:</p>\n\n<pre><code>uri = URI('https://www.blablubbxxx0.com/')\nNet::HTTP.get(uri)\n.\n.\n.\n.\n.\n.\n.\n.\n</code></pre>\n"}, {"tags": ["ios", "ruby-on-rails", "ruby", "redirect", "ios-universal-links"], "comments": [{"owner": {"reputation": 4023, "user_id": 396964, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/9d5d2fc7ebac788a7eca7acd89a96485?s=128&d=identicon&r=PG", "display_name": "chrismanderson", "link": "https://stackoverflow.com/users/396964/chrismanderson"}, "edited": false, "score": 1, "creation_date": 1492525809, "post_id": 43473602, "comment_id": 74005023, "body": "Are you getting redirected from http to https or vice versa? A production-only redirect could likely be an SSL redirect."}, {"owner": {"reputation": 973, "user_id": 3462026, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/583615379/picture?type=large", "display_name": "Fdo", "link": "https://stackoverflow.com/users/3462026/fdo"}, "reply_to_user": {"reputation": 4023, "user_id": 396964, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/9d5d2fc7ebac788a7eca7acd89a96485?s=128&d=identicon&r=PG", "display_name": "chrismanderson", "link": "https://stackoverflow.com/users/396964/chrismanderson"}, "edited": false, "score": 0, "creation_date": 1492528643, "post_id": 43473602, "comment_id": 74007304, "body": "@chrismanderson Yes, it works for <code>curl https:&#47;&#47;www.website.com&#47;...</code> but not for <code>curl https:&#47;&#47;website.com&#47;...</code>. SSL works fine but I don&#39;t know which URL is Apple using to fetch the asset, it might be an issue if they only fetch bare domains (without <code>www</code> prefix). I&#39;m not sure if such a redirect is possible using Rails configuration (I inherited this codebase and don&#39;t know very well exactly what to look for). I just updated the question to include this."}, {"owner": {"reputation": 14087, "user_id": 1544012, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bbaed9ca8e4320fd64d1989c0e0f488b?s=128&d=identicon&r=PG", "display_name": "BoraMa", "link": "https://stackoverflow.com/users/1544012/borama"}, "edited": false, "score": 2, "creation_date": 1492543121, "post_id": 43473602, "comment_id": 74016646, "body": "This may indeed be a DNS configuration issue. Can you post your DNS config, at least the <code>A</code> and <code>CNAME</code> records?"}, {"owner": {"reputation": 3997, "user_id": 3998420, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/55ea542584d3fd2a430c3d409bdafc95?s=128&d=identicon&r=PG&f=1", "display_name": "bkunzi01", "link": "https://stackoverflow.com/users/3998420/bkunzi01"}, "edited": false, "score": 0, "creation_date": 1492543482, "post_id": 43473602, "comment_id": 74016844, "body": "Follow Borama&#39;s instruction.  99% sure that&#39;s what you need."}], "owner": {"reputation": 973, "user_id": 3462026, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/583615379/picture?type=large", "display_name": "Fdo", "link": "https://stackoverflow.com/users/3462026/fdo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 154, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1492528186, "creation_date": 1492522083, "last_edit_date": 1492528186, "question_id": 43473602, "link": "https://stackoverflow.com/questions/43473602/i-dont-know-what-might-be-causing-a-redirect-response-in-rails-app", "title": "I don&#39;t know what might be causing a redirect response in Rails app", "body": "<p>I'm trying to render a file to support <a href=\"https://developer.apple.com/library/content/documentation/General/Conceptual/AppSearch/UniversalLinks.html\" rel=\"nofollow noreferrer\">Apple Universal Links</a>, which means basically rendering a very small JSON file.</p>\n\n<p>One of the requisites in Apple's website is to serve the file without redirects. But for some reason this project I'm working on has an automatic redirect from <code>website.com/path</code> to <code>www.website.com/path</code> <strong>in production only</strong>. I'm not sure if this was intentional and configured this way or if this error lives outside Rails scope (DNS config maybe?).</p>\n\n<p>The Rails (4.1.x) app has the following Router entry:</p>\n\n<pre><code># Router\nget '/.well-known/apple-app-site-association', to: 'static_pages#universal_links'\n</code></pre>\n\n<p>And controller function declaration:</p>\n\n<pre><code>def universal_links\n  file = File.join(Rails.root, 'app/views/static_pages/apple-app-site-association')\n  send_file file, disposition: 'inline', type: 'application/json'\nend\n</code></pre>\n\n<p>Now, the following requests appear to work properly:</p>\n\n<ul>\n<li><strong>DEVELOPMENT</strong>: <code>curl localhost:3000/.well-known/apple-app-site-association</code></li>\n<li><strong>PRODUCTION</strong>: <code>curl www.website.com/.well-known/apple-app-site-association</code></li>\n<li><strong>PRODUCTION</strong>: <code>curl https://www.website.com/.well-known/apple-app-site-association</code></li>\n</ul>\n\n<p>But these requests are <strong>not working</strong>:</p>\n\n<ul>\n<li><strong>PRODUCTION</strong>: <code>curl website.com/.well-known/apple-app-site-association</code></li>\n<li><strong>PRODUCTION</strong>: <code>curl https://website.com/.well-known/apple-app-site-association</code></li>\n</ul>\n\n<p>They (both) respond with the redirect:</p>\n\n<pre><code>&lt;html&gt;&lt;body&gt;You are being &lt;a href=\"http://www.website.com/.well-known/apple-app-site-association\"&gt;redirected&lt;/a&gt;.&lt;/body&gt;&lt;/html&gt;\n</code></pre>\n\n<p>I'm not sure about this being the only reason why the Universal links are not working properly, but I need to understand what is causing this app to redirect (and maybe a way to customize this behavior).</p>\n\n<p><strong>Note:</strong> From the <a href=\"https://search.developer.apple.com/appsearch-validation-tool/\" rel=\"nofollow noreferrer\">Apple's validation tool</a> I'm getting the following information:\n<a href=\"https://i.stack.imgur.com/iG6Wf.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/iG6Wf.png\" alt=\"validation tool fail\"></a></p>\n"}, {"tags": ["ruby-on-rails", "ruby", "heroku", "devise", "activeadmin"], "comments": [{"owner": {"reputation": 2116, "user_id": 6780663, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9207ba3b9163582570078b687f9b2792?s=128&d=identicon&r=PG&f=1", "display_name": "Alejandro Montilla", "link": "https://stackoverflow.com/users/6780663/alejandro-montilla"}, "edited": false, "score": 0, "creation_date": 1492533644, "post_id": 43473375, "comment_id": 74010825, "body": "The table was successfully created on heroku?"}, {"owner": {"reputation": 409, "user_id": 7735007, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh3.googleusercontent.com/-148Zy7EZT4I/AAAAAAAAAAI/AAAAAAAAAQU/7vF0QGaNUgs/photo.jpg?sz=128", "display_name": "Achyut", "link": "https://stackoverflow.com/users/7735007/achyut"}, "reply_to_user": {"reputation": 2116, "user_id": 6780663, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9207ba3b9163582570078b687f9b2792?s=128&d=identicon&r=PG&f=1", "display_name": "Alejandro Montilla", "link": "https://stackoverflow.com/users/6780663/alejandro-montilla"}, "edited": false, "score": 0, "creation_date": 1492535613, "post_id": 43473375, "comment_id": 74012018, "body": "The table was not created on heroku.."}, {"owner": {"reputation": 2116, "user_id": 6780663, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9207ba3b9163582570078b687f9b2792?s=128&d=identicon&r=PG&f=1", "display_name": "Alejandro Montilla", "link": "https://stackoverflow.com/users/6780663/alejandro-montilla"}, "edited": false, "score": 0, "creation_date": 1492535978, "post_id": 43473375, "comment_id": 74012272, "body": "You need to run <code>db:migrate</code> and see what&#39;s the error. You can obtain an interactive shell session by running <code>heroku run bash</code>."}, {"owner": {"reputation": 409, "user_id": 7735007, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh3.googleusercontent.com/-148Zy7EZT4I/AAAAAAAAAAI/AAAAAAAAAQU/7vF0QGaNUgs/photo.jpg?sz=128", "display_name": "Achyut", "link": "https://stackoverflow.com/users/7735007/achyut"}, "reply_to_user": {"reputation": 2116, "user_id": 6780663, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9207ba3b9163582570078b687f9b2792?s=128&d=identicon&r=PG&f=1", "display_name": "Alejandro Montilla", "link": "https://stackoverflow.com/users/6780663/alejandro-montilla"}, "edited": false, "score": 0, "creation_date": 1492582320, "post_id": 43473375, "comment_id": 74030493, "body": "The table already exists in the database. So that I have removed the migration created by active admin. When I run <code>rake db:migrate</code> no errors appear."}], "answers": [{"tags": [], "owner": {"reputation": 409, "user_id": 7735007, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh3.googleusercontent.com/-148Zy7EZT4I/AAAAAAAAAAI/AAAAAAAAAQU/7vF0QGaNUgs/photo.jpg?sz=128", "display_name": "Achyut", "link": "https://stackoverflow.com/users/7735007/achyut"}, "is_accepted": true, "score": 1, "last_activity_date": 1492743816, "creation_date": 1492743816, "answer_id": 43533233, "question_id": 43473375, "link": "https://stackoverflow.com/questions/43473375/why-my-active-admin-shows-errors-which-perfetly-worked-locally/43533233#43533233", "title": "Why my active admin shows errors which perfetly worked locally?", "body": "<p>As I see the error, I tried a lot and finally succeed. The main error is</p>\n\n<blockquote>\n  <p>PG::UndefinedTable: ERROR: relation \"admin_users\" does not exist</p>\n</blockquote>\n\n<p>This says that relation <code>admin_users</code> does not exist. It means the migration is trying to change the <code>admin_users</code> which already existed in the table. But actually it does not exist in the table we have to create it.<br /><br />\nHence, in the migration file created by active admin <code>/db/migrate/xxxxxxxxxxxxx_add_devise_to_admin_users.rb</code>, replace <code>change</code> with <code>create</code> as <code>change_table :admin_users do |t|</code> with <code>create_table :admin_users do |t|</code></p>\n\n<p>Finally, push to the heroku and run <code>heroku run rake db:migrate</code></p>\n"}], "owner": {"reputation": 409, "user_id": 7735007, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh3.googleusercontent.com/-148Zy7EZT4I/AAAAAAAAAAI/AAAAAAAAAQU/7vF0QGaNUgs/photo.jpg?sz=128", "display_name": "Achyut", "link": "https://stackoverflow.com/users/7735007/achyut"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 528, "favorite_count": 1, "accepted_answer_id": 43533233, "answer_count": 1, "score": 0, "last_activity_date": 1492743816, "creation_date": 1492521480, "question_id": 43473375, "link": "https://stackoverflow.com/questions/43473375/why-my-active-admin-shows-errors-which-perfetly-worked-locally", "title": "Why my active admin shows errors which perfetly worked locally?", "body": "<p>I am trying to add admin interface with <code>activeadmin</code> in my rails app. I have successfully completed locally but it gives error after deploying to heroku.\nI have done all the things which is necessary for database migrations like:</p>\n\n<pre><code>heroku run rake db:create\nheroku run rake db:migrate\n</code></pre>\n\n<p>I have changed the production to see the error:</p>\n\n<pre><code>config.consider_all_requests_local = true\n</code></pre>\n\n<p>When I navigate to <code>[mysitename].herokuapp.com/admin</code> it gives the error like below:</p>\n\n<blockquote>\n  <p>ActiveRecord::StatementInvalid in\n  ActiveAdmin::Devise::SessionsController#new</p>\n  \n  <p>PG::UndefinedTable: ERROR: relation \"admin_users\" does not exist LINE\n  8: WHERE a.attrelid = '\"admin_users\"'::regclass ^ : SELECT a.attname,\n  format_type(a.atttypid, a.atttypmod), pg_get_expr(d.adbin, d.adrelid),\n  a.attnotnull, a.atttypid, a.atttypmod, (SELECT c.collname FROM\n  pg_collation c, pg_type t WHERE c.oid = a.attcollation AND t.oid =\n  a.atttypid AND a.attcollation &lt;> t.typcollation),\n  col_description(a.attrelid, a.attnum) AS comment FROM pg_attribute a\n  LEFT JOIN pg_attrdef d ON a.attrelid = d.adrelid AND a.attnum =\n  d.adnum WHERE a.attrelid = '\"admin_users\"'::regclass AND a.attnum > 0\n  AND NOT a.attisdropped ORDER BY a.attnum</p>\n</blockquote>\n\n<p>And I clone my heroku and see if <code>admin_users</code> in <code>schema.rb</code> exists or not. I found there is <code>admin_users</code> table in <code>schema.rb</code>.</p>\n\n<p>My <code>routes.rb</code> is:</p>\n\n<pre><code>Rails.application.routes.draw do\n  devise_for :admin_users, ActiveAdmin::Devise.config\n  ActiveAdmin.routes(self)\n  devise_for :users\n  resources :users, only: :show\n  resources :posts do\n    resources :comments\n    resources :upvotes, only: :create\n    resources :downvotes, only: :create\n  end\n  root 'posts#index'  \nend\n</code></pre>\n\n<p>My <code>active_admin.rb</code> is: </p>\n\n<pre><code>ActiveAdmin.setup do |config|\n\n  config.site_title = \"Instapost\"\n\n  config.authentication_method = :authenticate_admin_user!\n\n  config.current_user_method = :current_admin_user\n\n  config.logout_link_path = :destroy_admin_user_session_path\n\n  config.comments = false\n\n  config.comments_menu = false\n\n  config.batch_actions = true\n\n  config.localize_format = :long\n\n  config.favicon = 'favicon.ico'\n\nend\n</code></pre>\n\n<p>I have searched a lot. But any solutions could not solve this problem. If anybody know about this please help me to solve the problem.</p>\n"}, {"tags": ["mysql", "sql", "ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 5483, "user_id": 4481312, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/teLso.jpg?s=128&g=1", "display_name": "marmeladze", "link": "https://stackoverflow.com/users/4481312/marmeladze"}, "edited": false, "score": 0, "creation_date": 1492520822, "post_id": 43472953, "comment_id": 74000952, "body": "you should fix your <code>order_params</code> functions body as, <code>params.require(:order).permit(:name, :email, :address, :city, :postcode, :buyer_id, :latitude, :longitude)</code> or sth similar to this."}, {"owner": {"reputation": 261, "user_id": 4658490, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/01f1048062a5663d21d0c98ffdc26ec1?s=128&d=identicon&r=PG&f=1", "display_name": "Sanju B Myh", "link": "https://stackoverflow.com/users/4658490/sanju-b-myh"}, "edited": false, "score": 0, "creation_date": 1492520861, "post_id": 43472953, "comment_id": 74000978, "body": "under order_params action <code>buyer_id</code>, <code>latitude</code>, <code>longitude</code> attributes are missing, try adding these"}, {"owner": {"reputation": 21, "user_id": 3531964, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/8cf4cb0bf103679aa3f205fd274958fb?s=128&d=identicon&r=PG&f=1", "display_name": "Walsh259", "link": "https://stackoverflow.com/users/3531964/walsh259"}, "reply_to_user": {"reputation": 261, "user_id": 4658490, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/01f1048062a5663d21d0c98ffdc26ec1?s=128&d=identicon&r=PG&f=1", "display_name": "Sanju B Myh", "link": "https://stackoverflow.com/users/4658490/sanju-b-myh"}, "edited": false, "score": 0, "creation_date": 1492523784, "post_id": 43472953, "comment_id": 74003389, "body": "@SanjuBMyh I have added these extras and they process correctly, however, the ddate ones are still missing."}], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 3531964, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/8cf4cb0bf103679aa3f205fd274958fb?s=128&d=identicon&r=PG&f=1", "display_name": "Walsh259", "link": "https://stackoverflow.com/users/3531964/walsh259"}, "edited": false, "score": 0, "creation_date": 1492524145, "post_id": 43474160, "comment_id": 74003676, "body": "Thank you for the answer. in the form, I have been using a script taken from the Asp.net version of the website that I am trying to recreate. Thanks for your help, I will try and change it."}, {"owner": {"reputation": 21, "user_id": 3531964, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/8cf4cb0bf103679aa3f205fd274958fb?s=128&d=identicon&r=PG&f=1", "display_name": "Walsh259", "link": "https://stackoverflow.com/users/3531964/walsh259"}, "edited": false, "score": 0, "creation_date": 1492539660, "post_id": 43474160, "comment_id": 74014551, "body": "Adding this to the form <b>name=&quot;order[ddate1]&quot;</b>  instead of  name=&quot;ddate1&quot; fixed the issue."}], "tags": [], "owner": {"reputation": 639, "user_id": 7046734, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RQ62P.jpg?s=128&g=1", "display_name": "Mayank", "link": "https://stackoverflow.com/users/7046734/mayank"}, "is_accepted": true, "score": 1, "last_activity_date": 1492523493, "creation_date": 1492523493, "answer_id": 43474160, "question_id": 43472953, "link": "https://stackoverflow.com/questions/43472953/ruby-on-rails-form-data-not-adding-to-the-database-via-sql/43474160#43474160", "title": "Ruby on Rails, Form data not adding to the database via sql", "body": "<p>You have set up your strong params as:</p>\n\n<pre><code>def order_params\n  params.require(:order).permit(:name, :email, :address, :city, :county, :postcode, :ddate1, :ddate2, :ddate3)\nend\n</code></pre>\n\n<p>Which indicates that you permit <code>ddate1, ddate2 and ddate3</code> from inside the order object i.e. they should be inside the order hash while \nyour parameters shows that they are outside the require object <code>order</code></p>\n\n<pre><code>Parameters: {\"utf8\"=&gt;\"\u2713\", \"authenticity_token\"=&gt;\"bKcYiOq93T301ty4av2yyAqr4kKY11nn8I7qP7SWKmVgs/qgRmGcf82m5nAdnP1QqlvRFX8vjiSXa7dD4temwg==\", \"order\"=&gt;{\"name\"=&gt;\"Bruce Clay\", \"email\"=&gt;\"bruce@dia.com\", \"address\"=&gt;\"12\", \"city\"=&gt;\"chippenham\", \"postcode\"=&gt;\"kt12 3pw\"}, \"DeliveryDates.DeliveryConfirm\"=&gt;\"false\", \"DeliveryDates.DeliveryDisagree\"=&gt;\"True\", \"DeliveryDates.DeliveryDisagreeMessage\"=&gt;\"\", \"ddate1\"=&gt;\"20/04/2017\", \"ddate2\"=&gt;\"25/04/2017\", \"ddate3\"=&gt;\"23/04/2017\", \"card-identifier\"=&gt;\"7FA7C55A-D3B3-45AC-AA82-D8850CD1E715\"}\n</code></pre>\n\n<p>You need to put them in view like you've done with other attributes <code>name, email etc</code> \npreferably use them as:</p>\n\n<pre><code>&lt;%= f.text_field :ddate1, class=\"your_class\" %&gt;\n</code></pre>\n\n<p>where f is your form object iterator.</p>\n\n<p>My guess is that you're using html syntax to generate form elements for <code>ddate1, ddate2, ddate3</code>. Please change them</p>\n\n<p>Hope this helps</p>\n"}], "owner": {"reputation": 21, "user_id": 3531964, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/8cf4cb0bf103679aa3f205fd274958fb?s=128&d=identicon&r=PG&f=1", "display_name": "Walsh259", "link": "https://stackoverflow.com/users/3531964/walsh259"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 111, "favorite_count": 0, "accepted_answer_id": 43474160, "answer_count": 1, "score": 0, "last_activity_date": 1492524046, "creation_date": 1492520472, "last_edit_date": 1492524046, "question_id": 43472953, "link": "https://stackoverflow.com/questions/43472953/ruby-on-rails-form-data-not-adding-to-the-database-via-sql", "title": "Ruby on Rails, Form data not adding to the database via sql", "body": "<p>When placing an order on my ruby site only half of the information is added to the database. \nWhen I submit the form the server returns the following:</p>\n\n<pre><code>Processing by OrdersController#create as HTML\n  Parameters: {\"utf8\"=&gt;\"\u2713\", \"authenticity_token\"=&gt;\"bKcYiOq93T301ty4av2yyAqr4kKY11nn8I7qP7SWKmVgs/qgRmGcf82m5nAdnP1QqlvRFX8vjiSXa7dD4temwg==\", \"order\"=&gt;{\"name\"=&gt;\"Bruce Clay\", \"email\"=&gt;\"bruce@dia.com\", \"address\"=&gt;\"12\", \"city\"=&gt;\"chippenham\", \"postcode\"=&gt;\"kt12 3pw\"}, \"DeliveryDates.DeliveryConfirm\"=&gt;\"false\", \"DeliveryDates.DeliveryDisagree\"=&gt;\"True\", \"DeliveryDates.DeliveryDisagreeMessage\"=&gt;\"\", \"ddate1\"=&gt;\"20/04/2017\", \"ddate2\"=&gt;\"25/04/2017\", \"ddate3\"=&gt;\"23/04/2017\", \"card-identifier\"=&gt;\"7FA7C55A-D3B3-45AC-AA82-D8850CD1E715\"}\n</code></pre>\n\n<p>The information gets inserted apart from the ddates options. </p>\n\n<pre><code>SQL (9.9ms)  INSERT INTO `orders` (`name`, `email`, `address`, `city`, `postcode`, `buyer_id`, `latitude`, `longitude`, `created_at`, `updated_at`) VALUES ('Bruce Claypot', 'bruce@dia.com', '12', 'chippenham', 'kt12 3pw', 1, 51.3862775, -0.3865515, '2017-04-18 12:50:21', '2017-04-18 12:50:21')\n</code></pre>\n\n<p>The orders controller has the following params :</p>\n\n<pre><code>def order_params\n  params.require(:order).permit(:name, :email, :address, :city, :county, :postcode, :ddate1, :ddate2, :ddate3)\nend\n</code></pre>\n\n<p>and under def create : </p>\n\n<pre><code>@order = Order.new(order_params)\n</code></pre>\n\n<p>I'm really lost as to what is causing this issue as I have tried changing the params options but nothing will work. </p>\n\n<p>Thanks for your help. </p>\n\n<p>ADDED order model.</p>\n\n<pre><code>class Order &lt; ActiveRecord::Base\n    belongs_to :user\n\n    has_many :product_items, dependent: :destroy \n     has_many :statuses\n\n    validates :name, :email, :address, :city, :postcode, presence: true\n\n\n    geocoded_by :postcode\n\n# def address\n#   [address, postcode].compact.join(', ')\n# end# can also be an IP address\nafter_validation :geocode# auto-fetch coordinates\n\n    def add_product_items_from_basket(basket)\n        basket.product_items.each do |item|\n            item.basket_id = nil\n            product_items &lt;&lt; item\n        end\n    end\n\n    def total_price\n        product_items.map(&amp;:total_price).sum\n    end\n\nSTATUSES = ['pending', 'offered', 'accepted', 'declined', 'returned', 'completed', 'canceled', 'refunded']\nvalidates_inclusion_of :status, :in =&gt; STATUSES,\n          :message =&gt; \"{{value}} must be in #{STATUSES.join ','}\"\n\nend\n</code></pre>\n\n<p>Order Form script being used.</p>\n\n<pre><code> &lt;input class=\"text\"  id=\"ddate1\" name=\"ddate1\" type=\"text\" value=\"\"&gt;&lt;img class=\"ui-datepicker-trigger\" src=\"../assets/calendar.png\" alt=\"Select date\" title=\"Select date\"&gt;\n                    &lt;/div&gt;\n                    &lt;span class=\"field-validation-valid\" data-valmsg-for=\"DeliveryDates.DeliveryDateFirst\" data-valmsg-replace=\"true\"&gt;&lt;/span&gt;\n                &lt;/th&gt;\n                &lt;script&gt;\n    $('#order_ddate1').ready(function(){\n           var date_input=$('input[name=\"ddate1\"]'); //our date input has the name \"date\"\n      var container=$('.bootstrap-iso form').length&gt;0 ? $('.bootstrap-iso form').parent() : \"body\";\n      var options={\n        format: 'dd/mm/yyyy',\n        startDate: \"+2d\",\n        container: container,\n        todayHighlight: true,\n        autoclose: true,\n      };\n      date_input.datepicker(options);\n    })\n&lt;/script&gt;\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "erb"], "comments": [{"owner": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "edited": false, "score": 0, "creation_date": 1492520372, "post_id": 43472809, "comment_id": 74000596, "body": "What about <code>&lt;%= link_to &#39;Bla&#39;, &#39;bla bla&#39;, class: &#39;ch-share-social__link&#39; %&gt;</code>?"}, {"owner": {"reputation": 5312, "user_id": 6535997, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/10156345016155058/picture?type=large", "display_name": "Mark", "link": "https://stackoverflow.com/users/6535997/mark"}, "reply_to_user": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "edited": false, "score": 0, "creation_date": 1492520594, "post_id": 43472809, "comment_id": 74000776, "body": "I tried but I&#39;m not sure how to structure a link_to block with all my nested code - I&#39;ve edited the question to include it I probably should have done that from the start"}, {"owner": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "edited": false, "score": 0, "creation_date": 1492520672, "post_id": 43472809, "comment_id": 74000828, "body": "&lt;%= link_to ... do %&gt;...&lt;% end %&gt; may work?"}], "answers": [{"tags": [], "owner": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "is_accepted": true, "score": 2, "last_activity_date": 1492520731, "creation_date": 1492520731, "answer_id": 43473058, "question_id": 43472809, "link": "https://stackoverflow.com/questions/43472809/trouble-with-ruby-removing-spaces-from-string-in-erb-link-to/43473058#43473058", "title": "Trouble with ruby removing spaces from string in ERB (link_to)", "body": "<p>Try with:</p>\n\n<pre><code>&lt;li&gt;\n  &lt;%= link_to 'bla bla', class: 'ch-share-social__link' do %&gt;\n    &lt;svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 24 24\" class=\"ch-share-social__icon\" &gt;\n      &lt;title&gt;Share on Twitter&lt;/title&gt;\n      &lt;use xlink:href=\"&lt;%=asset_path('general.svg')%&gt;#twitter\"&gt;&lt;/use&gt;\n    &lt;/svg&gt;\n  &lt;% end %&gt;\n&lt;/li&gt;\n</code></pre>\n"}], "owner": {"reputation": 5312, "user_id": 6535997, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/10156345016155058/picture?type=large", "display_name": "Mark", "link": "https://stackoverflow.com/users/6535997/mark"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 58, "favorite_count": 0, "accepted_answer_id": 43473058, "answer_count": 1, "score": 0, "last_activity_date": 1492520731, "creation_date": 1492520127, "last_edit_date": 1492520561, "question_id": 43472809, "link": "https://stackoverflow.com/questions/43472809/trouble-with-ruby-removing-spaces-from-string-in-erb-link-to", "title": "Trouble with ruby removing spaces from string in ERB (link_to)", "body": "<p>I'm trying to create a link to a url with spaces in it, my code is as follows:</p>\n\n<pre><code>&lt;a href=&lt;%= \"bla bla\" %&gt;, class=\"ch-share-social__link\"&gt;\n</code></pre>\n\n<p>This produces a link to \"bla\". When I remove the erb brackets and simply input it as raw text:</p>\n\n<pre><code>&lt;a href=\"bla bla\", class=\"ch-share-social__link\"&gt;\n</code></pre>\n\n<p>Then this produces a link to \"bla bla\". I need to use ruby to calculate what goes inside the string so can't simply drop the ERB brackets.</p>\n\n<p>Is there any way to get &lt;%= \"bla bla\" %> to return 'bla bla' and not just 'bla' as it is right now?</p>\n\n<p>Thanks in advance.</p>\n\n<p>EDIT: The full block of my link is: </p>\n\n<pre><code>&lt;li&gt;\n  &lt;a href=&lt;%= \"bla bla\" %&gt;, class=\"ch-share-social__link\"&gt;\n    &lt;svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 24 24\" class=\"ch-share-social__icon\" &gt;\n      &lt;title&gt;Share on Twitter&lt;/title&gt;\n      &lt;use xlink:href=\"&lt;%=asset_path('general.svg')%&gt;#twitter\"&gt;&lt;/use&gt;\n    &lt;/svg&gt;\n  &lt;/a&gt;\n&lt;/li&gt;\n</code></pre>\n\n<p>If there is a better way for me to do this using link_to please let me know, I did try briefly but was getting various errors and thought this would be easier.</p>\n"}, {"tags": ["sql-server", "ruby", "jdbc", "jruby"], "comments": [{"owner": {"reputation": 80989, "user_id": 466862, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d873f397779db38cd510d9ee5416fd43?s=128&d=identicon&r=PG", "display_name": "Mark Rotteveel", "link": "https://stackoverflow.com/users/466862/mark-rotteveel"}, "edited": false, "score": 0, "creation_date": 1492525595, "post_id": 43472281, "comment_id": 74004856, "body": "Try <code>EXEC(&#39;INSERT INTO dbo.test (FirstName, LastName)Values(?,?)&#39;, ?, ?) AT [DATALOADER01]</code>. You need to pass the parameters to the parametrized query you are executing."}, {"owner": {"reputation": 860, "user_id": 2113026, "user_type": "registered", "accept_rate": 34, "profile_image": "https://www.gravatar.com/avatar/400a0a9ac1dd70a914af6ea0a3d31821?s=128&d=identicon&r=PG", "display_name": "Jake Evans", "link": "https://stackoverflow.com/users/2113026/jake-evans"}, "reply_to_user": {"reputation": 80989, "user_id": 466862, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d873f397779db38cd510d9ee5416fd43?s=128&d=identicon&r=PG", "display_name": "Mark Rotteveel", "link": "https://stackoverflow.com/users/466862/mark-rotteveel"}, "edited": false, "score": 0, "creation_date": 1492527304, "post_id": 43472281, "comment_id": 74006259, "body": "Perfect, that works! Thanks!"}, {"owner": {"reputation": 80989, "user_id": 466862, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d873f397779db38cd510d9ee5416fd43?s=128&d=identicon&r=PG", "display_name": "Mark Rotteveel", "link": "https://stackoverflow.com/users/466862/mark-rotteveel"}, "edited": false, "score": 0, "creation_date": 1492527422, "post_id": 43472281, "comment_id": 74006365, "body": "Great, I wasn&#39;t 100% sure it would work, and I didn&#39;t have an SQL Server install at hand to check"}], "answers": [{"tags": [], "owner": {"reputation": 80989, "user_id": 466862, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d873f397779db38cd510d9ee5416fd43?s=128&d=identicon&r=PG", "display_name": "Mark Rotteveel", "link": "https://stackoverflow.com/users/466862/mark-rotteveel"}, "is_accepted": true, "score": 2, "last_activity_date": 1492527578, "creation_date": 1492527578, "answer_id": 43475701, "question_id": 43472281, "link": "https://stackoverflow.com/questions/43472281/exec-at-remote-server-using-paramaterized-query/43475701#43475701", "title": "EXEC at remote server using paramaterized query", "body": "<p>If you use </p>\n\n<pre><code>EXEC('INSERT INTO dbo.test (FirstName, LastName)Values(?,?)') AT [DATALOADER01]\n</code></pre>\n\n<p>You are only asking SQL Server to forward the string <code>'INSERT INTO dbo.test (FirstName, LastName)Values(?,?)'</code> to the linked server. It does not know about the parameters. To be able to supply the parameters, you need to explicitly send them as part of the <code>exec</code> statement you are executing. So you need to use:</p>\n\n<pre><code>EXEC('INSERT INTO dbo.test (FirstName, LastName)Values(?,?)', ?, ?) AT [DATALOADER01]\n</code></pre>\n\n<p>Here you add two parameters to the <code>exec</code> command, which then allows SQL Server to recognize you want to pass parameters.</p>\n"}], "owner": {"reputation": 860, "user_id": 2113026, "user_type": "registered", "accept_rate": 34, "profile_image": "https://www.gravatar.com/avatar/400a0a9ac1dd70a914af6ea0a3d31821?s=128&d=identicon&r=PG", "display_name": "Jake Evans", "link": "https://stackoverflow.com/users/2113026/jake-evans"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 85, "favorite_count": 1, "accepted_answer_id": 43475701, "answer_count": 1, "score": 0, "last_activity_date": 1492527578, "creation_date": 1492518790, "last_edit_date": 1492525646, "question_id": 43472281, "link": "https://stackoverflow.com/questions/43472281/exec-at-remote-server-using-paramaterized-query", "title": "EXEC at remote server using paramaterized query", "body": "<p>I am trying to run the following SQL on a Linked Server;</p>\n\n<pre><code>INSERT INTO dbo.test (FirstName, LastName)Values(?,?)\n</code></pre>\n\n<p><code>dbo.test</code> exists on a linked server with an alias from the local SQL server of (<code>DATALOADER01</code>).</p>\n\n<p>Therefore, the query I want to perform is;</p>\n\n<pre><code>EXEC('INSERT INTO dbo.test (FirstName, LastName)Values(?,?)') AT [DATALOADER01]\n</code></pre>\n\n<p>Ruby code that is executing the SQL;</p>\n\n<pre><code>def connect(server, database)\n    url = \"jdbc:sqlserver://%s;databaseName=%s;integratedSecurity=true\" % [server, database]\n    return java.sql.DriverManager.get_connection(url)\nend\n\n    def execute_q(statement, options = [])\n        @conn = connect('sql','master')\n        ps = @conn.prepareStatement(statement)\n        options.each_with_index do |opt, index|\n            set_param(ps, index.to_i + 1, opt)  \n        end\n        ps.execute()\n    end\n</code></pre>\n\n<p>There error I get is 'Index 1 is out of range'</p>\n\n<p>The code works when I pass a non-paramterized query to <code>execute_q</code>. For example;</p>\n\n<pre><code>EXEC('CREATE TABLE dbo.test2 (Test nvarchar(max))') AT [DATALOADER01]\n</code></pre>\n\n<p>There are no permissions issues, and the links are setup correctly, so I am not concerned there are issues there. </p>\n\n<p>I appreciate I can do an insert to a linked server without using <code>EXEC</code>, however <code>MERGE</code> statements do not work unless done this way.</p>\n"}, {"tags": ["android", "ruby", "cucumber", "appium", "appium-ios"], "comments": [{"owner": {"reputation": 1413, "user_id": 2607372, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/bWlAQ.png?s=128&g=1", "display_name": "vikramvi", "link": "https://stackoverflow.com/users/2607372/vikramvi"}, "edited": false, "score": 0, "creation_date": 1503324721, "post_id": 43471993, "comment_id": 78556386, "body": "did you find any solution for this problem, even I&#39;m searching for answer."}, {"owner": {"reputation": 1772, "user_id": 5743300, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/86b739012f3bafbce2e40f59f3291c0e?s=128&d=identicon&r=PG&f=1", "display_name": "Emjey", "link": "https://stackoverflow.com/users/5743300/emjey"}, "reply_to_user": {"reputation": 1413, "user_id": 2607372, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/bWlAQ.png?s=128&g=1", "display_name": "vikramvi", "link": "https://stackoverflow.com/users/2607372/vikramvi"}, "edited": false, "score": 0, "creation_date": 1503345160, "post_id": 43471993, "comment_id": 78567074, "body": "Yes! I ll post the answer, as to what I did. I actually created two sets of desired capabilities and invoking appium only when the same is being called and not when the execution started. So, in this case, I am calling iOS capability only when the device is not android."}, {"owner": {"reputation": 1413, "user_id": 2607372, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/bWlAQ.png?s=128&g=1", "display_name": "vikramvi", "link": "https://stackoverflow.com/users/2607372/vikramvi"}, "edited": false, "score": 0, "creation_date": 1503391954, "post_id": 43471993, "comment_id": 78583556, "body": "can you please post answer &amp; accept as well, it can be helpful to others as well."}], "answers": [{"comments": [{"owner": {"reputation": 1772, "user_id": 5743300, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/86b739012f3bafbce2e40f59f3291c0e?s=128&d=identicon&r=PG&f=1", "display_name": "Emjey", "link": "https://stackoverflow.com/users/5743300/emjey"}, "edited": false, "score": 0, "creation_date": 1530706414, "post_id": 51164680, "comment_id": 89329558, "body": "True! Declaring cucumber variables is smart though. I am using this for testing on various browsers, by having a `ENV[&#39;BROWSER&#39;]"}], "tags": [], "owner": {"reputation": 405, "user_id": 4420429, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/Th7ed.jpg?s=128&g=1", "display_name": "jose luis gonzalez clua", "link": "https://stackoverflow.com/users/4420429/jose-luis-gonzalez-clua"}, "is_accepted": false, "score": 0, "last_activity_date": 1530667826, "creation_date": 1530667826, "answer_id": 51164680, "question_id": 43471993, "link": "https://stackoverflow.com/questions/43471993/auto-detect-os-of-device-in-appium/51164680#51164680", "title": "Auto detect OS of device in appium", "body": "<p>I also ran into this dilema but I solved differently.</p>\n\n<p>In our case we are using Cucumber on top of Appium so I just execute it with an argument that represents my platform, for example:</p>\n\n<p>cucumber PLATFORM=iOS</p>\n\n<p>Then in my env.rb I get the argument:</p>\n\n<p>@platform = ENV['PLATFORM']</p>\n\n<p>And then I just use it to get the capabilities I want:</p>\n\n<pre><code>if @platform == \"DROID\"\n  Appium::Driver.new(droid_caps, true)\nelse\n  Appium::Driver.new(ios_caps, true)\nend\n</code></pre>\n\n<p>When you are running a test you always know which platform you are testing so it makes sense to send it as an argument. </p>\n"}], "owner": {"reputation": 1772, "user_id": 5743300, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/86b739012f3bafbce2e40f59f3291c0e?s=128&d=identicon&r=PG&f=1", "display_name": "Emjey", "link": "https://stackoverflow.com/users/5743300/emjey"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 942, "favorite_count": 2, "answer_count": 1, "score": 1, "last_activity_date": 1530667826, "creation_date": 1492518074, "last_edit_date": 1492519295, "question_id": 43471993, "link": "https://stackoverflow.com/questions/43471993/auto-detect-os-of-device-in-appium", "title": "Auto detect OS of device in appium", "body": "<p>I am using <code>appium_lib</code>to automate my tests in both iOS and Android</p>\n\n<p>Currently, I am maintaining two suites, one for android seperately and another for iOS.</p>\n\n<p>Is there a provision in this cucumber with appium_lib gem, to maintain the cases for both iOS and Android both in a single suite? And let appium automatically detect which device is connected, and execute the test cases tagged accordingly?</p>\n\n<p>Like if Appium detects it to be iOS, run the test cases that are tagged under iOS <code>cucumber -t @ios</code></p>\n\n<p>I understand <code>env.rb</code> could be of help in this and in <code>hooks.rb</code> under <code>before do</code> I could provide a <code>if</code> and <code>else</code> condition with </p>\n\n<pre><code>    if $driver.device_is_android? == 'true'\n    'cucumber -t @Android'\n  else\n    'cucumber -t @iOS'\n  end\n</code></pre>\n\n<p>Something like this? Is it possible? I am unable to find information on the internet with respect to auto detect of device OS, and hence posted this as a question with my thoughts.</p>\n\n<p>I understand I can read the versions of the OS with the command <code>adb shell getprop | grep build.version.release</code> , and hence wanted to know if its possible to read the OS with one common command, apart from <code>$driver.device_is_android?</code></p>\n\n<p>Now to run the cucumber cases, for iOS and Android, I need to pass individual capabilities in appium. Is there a way to do it programmatically in the <code>if</code> and <code>else</code> condition itself? </p>\n"}]