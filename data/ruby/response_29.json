[{"tags": ["ruby", "heroku", "sinatra", "rack", "unicorn"], "comments": [{"owner": {"reputation": 14010, "user_id": 3109182, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/a4b305f0077055b4fdcf715067775d5a?s=128&d=identicon&r=PG", "display_name": "Anthony", "link": "https://stackoverflow.com/users/3109182/anthony"}, "edited": false, "score": 2, "creation_date": 1438214188, "post_id": 31713038, "comment_id": 51363879, "body": "is a 6.5yr old version of ruby necessary for this app?"}, {"owner": {"reputation": 264, "user_id": 1698908, "user_type": "registered", "accept_rate": 89, "profile_image": "https://graph.facebook.com/2259453/picture?type=large", "display_name": "Evan Appleby", "link": "https://stackoverflow.com/users/1698908/evan-appleby"}, "reply_to_user": {"reputation": 14010, "user_id": 3109182, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/a4b305f0077055b4fdcf715067775d5a?s=128&d=identicon&r=PG", "display_name": "Anthony", "link": "https://stackoverflow.com/users/3109182/anthony"}, "edited": false, "score": 0, "creation_date": 1438214562, "post_id": 31713038, "comment_id": 51363974, "body": "Ruby 2+ seemed to cause problems initially with Heroku/Postgres, but it has been sometime since I re-evaluated it."}, {"owner": {"reputation": 4054, "user_id": 978728, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/nJkFo.png?s=128&g=1", "display_name": "Erowlin", "link": "https://stackoverflow.com/users/978728/erowlin"}, "edited": false, "score": 0, "creation_date": 1450791219, "post_id": 31713038, "comment_id": 56575043, "body": "We got the exact same problem on one of our development application. We got the error message &quot;Request older than xxx ms&quot;, even when the request is done immediatly, by watching the logs in live. I will create an issue on Github. BTW we are in Ruby 2.2x and Rails 4.2. There is something related on Chrome browser, because when I open the same request on Safari or Firefox, there is not such problem. There is something related at this place in the rack-timeout gem : <a href=\"https://www.omniref.com/ruby/gems/rack-timeout/0.2.4/symbols/Rack::Timeout::RequestTimeoutError#line=74\" rel=\"nofollow noreferrer\">omniref.com/ruby/gems/rack-timeout/0.2.4/symbols/&hellip;</a>"}], "owner": {"reputation": 264, "user_id": 1698908, "user_type": "registered", "accept_rate": 89, "profile_image": "https://graph.facebook.com/2259453/picture?type=large", "display_name": "Evan Appleby", "link": "https://stackoverflow.com/users/1698908/evan-appleby"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 222, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1438213680, "creation_date": 1438213680, "question_id": 31713038, "link": "https://stackoverflow.com/questions/31713038/only-able-to-recover-offline-heroku-app-by-removing-racktimeout", "title": "Only able to recover offline Heroku app by removing Rack::Timeout", "body": "<p>Heroku app using Ruby/Sinatra/Unicorn crashed recently and even though I restarted the app and scaled up the dynos, the app would continue to timeout, even if I was calling an empty function.</p>\n\n<p>I saw the following Rack::Timeout error in my logs, so I tried removing Rack::Timeout from my app, which after a 2min pause brought the app back to life and now runs in &lt;1s.</p>\n\n<pre><code>/app/vendor/bundle/ruby/1.9.1/gems/rack-timeout-0.2.4/lib/rack/timeout.rb:83:incall:\nRequest older than 30000ms. (Rack::Timeout::RequestExpiryError)\n</code></pre>\n\n<p>Heroku has said that removing Rack::Timeout is not recommended for apps running on Unicorn, so is there a better solution to this? Why is the app not resuming after a restart?</p>\n\n<p>For reference, here is my Gemfile:</p>\n\n<pre><code>source 'https://rubygems.org'\nruby '1.9.3'\n#gem 'rack-timeout'\ngem 'sinatra'\ngem \"pg\"\ngem 'activerecord'\ngem 'activesupport'\ngem 'sinatra-activerecord'\ngem 'unicorn'\ngroup :production do\n    gem 'newrelic_rpm'\nend\n</code></pre>\n\n<p>Here is my config.ru</p>\n\n<pre><code>#require \"rack-timeout\"\n#use Rack::Timeout\n#Rack::Timeout.timeout = (ENV[\"RACK_TIMEOUT\"] || 10).to_i\n\nuse Rack::Deflater\n\nrequire './web'\nrun Sinatra::Application\nuse ActiveRecord::ConnectionAdapters::ConnectionManagement\n</code></pre>\n\n<p>And here is my unicorn.rb:</p>\n\n<pre><code># config/unicorn.rb\nworker_processes (ENV[\"WEB_CONCURRENCY\"] || 3).to_i\ntimeout (ENV['WEB_TIMEOUT'] || 15).to_i\npreload_app true\n\nbefore_fork do |server, worker|\n    Signal.trap 'TERM' do\n        puts 'Unicorn master intercepting TERM and sending myself QUIT instead'\n        Process.kill 'QUIT', Process.pid\n    end\n\n    defined?(ActiveRecord::Base) and ActiveRecord::Base.connection.disconnect!\nend\n\nafter_fork do |server, worker|\n    Signal.trap 'TERM' do\n        puts 'Unicorn worker intercepting TERM and doing nothing. Wait for master to send QUIT'\n    end\n\n    defined?(ActiveRecord::Base) and ActiveRecord::Base.establish_connection\nend\n</code></pre>\n"}, {"tags": ["ruby", "post", "compression", "gzip", "net-http"], "comments": [{"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 0, "creation_date": 1438216419, "post_id": 31712973, "comment_id": 51364437, "body": "Have you tried anything? Where have you searched? As is, you&#39;re asking us to write a tutorial for you and they exist already."}, {"owner": {"reputation": 8894, "user_id": 150050, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/a3036a782fc6c728ec1eba30e7b73b34?s=128&d=identicon&r=PG", "display_name": "aaa90210", "link": "https://stackoverflow.com/users/150050/aaa90210"}, "reply_to_user": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 0, "creation_date": 1438216535, "post_id": 31712973, "comment_id": 51364461, "body": "@theTinMan the ruby docs for Net::HTTP::POST mention nothing about compression."}, {"owner": {"reputation": 167912, "user_id": 240443, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/495d675e3bc42ed1dee469e2ce701f1b?s=128&d=identicon&r=PG", "display_name": "Amadan", "link": "https://stackoverflow.com/users/240443/amadan"}, "edited": false, "score": 1, "creation_date": 1438217328, "post_id": 31712973, "comment_id": 51364668, "body": "You need to use <code>Zlib</code> to compress data and <code>Content-Encoding: gzip</code> header. None of this is specific to <code>Net::HTTP::POST</code>, AFAIK."}, {"owner": {"reputation": 478, "user_id": 834161, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/d8823cc73d7fabdc52c4b21eec6663b2?s=128&d=identicon&r=PG", "display_name": "Richardsondx", "link": "https://stackoverflow.com/users/834161/richardsondx"}, "edited": false, "score": 0, "creation_date": 1457575556, "post_id": 31712973, "comment_id": 59472767, "body": "Did you figure this out? I&#39;m experiencing a similar issue on jruby 9.0.5.x"}], "answers": [{"tags": [], "owner": {"reputation": 41, "user_id": 6683095, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4350f21ec68a664ac0fd829f4ecf8bcc?s=128&d=identicon&r=PG&f=1", "display_name": "skladd", "link": "https://stackoverflow.com/users/6683095/skladd"}, "is_accepted": false, "score": 4, "last_activity_date": 1528380633, "creation_date": 1528380633, "answer_id": 50743419, "question_id": 31712973, "link": "https://stackoverflow.com/questions/31712973/ruby-nethttp-post-send-data-gzip-compressed/50743419#50743419", "title": "Ruby Net::HTTP POST send data gzip compressed", "body": "<p>Example for posting JSON:</p>\n\n<pre><code>require('zlib')\nrequire('net/http')\nrequire('json')\n\ndata = {my: 'data'}\nuri = URI('http://example.com/api/endpoint')\n\nheaders = {\n  'Content-Type' =&gt; 'application/json',\n  'Content-Encoding' =&gt; 'gzip',\n}\nrequest = Net::HTTP::Post.new(uri, headers)\n\ngzip = Zlib::GzipWriter.new(StringIO.new)\ngzip &lt;&lt; data.to_json\nrequest.body = gzip.close.string\n\nresponse = Net::HTTP.start(uri.hostname, uri.port) do |http|\n  http.request(request)\nend\n</code></pre>\n"}], "owner": {"reputation": 8894, "user_id": 150050, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/a3036a782fc6c728ec1eba30e7b73b34?s=128&d=identicon&r=PG", "display_name": "aaa90210", "link": "https://stackoverflow.com/users/150050/aaa90210"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1398, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1528380633, "creation_date": 1438213215, "question_id": 31712973, "link": "https://stackoverflow.com/questions/31712973/ruby-nethttp-post-send-data-gzip-compressed", "title": "Ruby Net::HTTP POST send data gzip compressed", "body": "<p>I am using Net::HTTP::Post under JRUBY 1.9.2 to send data to a custom server (not a web server), that want the data to be gzipped compressed.</p>\n\n<p>How can I tell Net::HTTP::Post to gzip compress the data it is POSTING?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "nginx", "amazon-ec2", "passenger"], "comments": [{"owner": {"reputation": 5286, "user_id": 455770, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/mMHwz.jpg?s=128&g=1", "display_name": "Rots", "link": "https://stackoverflow.com/users/455770/rots"}, "edited": false, "score": 0, "creation_date": 1438219751, "post_id": 31712676, "comment_id": 51365263, "body": "Do you have to use that passenger version? If so, try adding to your Gemfile <code>gem &#39;passenger&#39;, &#39;1:4.0.59-1~precise1&#39;</code>"}, {"owner": {"reputation": 399, "user_id": 719661, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/f52d8660c0c8d98223778a71ba89844a?s=128&d=identicon&r=PG&f=1", "display_name": "dcalixto", "link": "https://stackoverflow.com/users/719661/dcalixto"}, "reply_to_user": {"reputation": 5286, "user_id": 455770, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/mMHwz.jpg?s=128&g=1", "display_name": "Rots", "link": "https://stackoverflow.com/users/455770/rots"}, "edited": false, "score": 0, "creation_date": 1438222160, "post_id": 31712676, "comment_id": 51365741, "body": "for me does not matter wich version, any that works and don&#39;t give problem."}, {"owner": {"reputation": 399, "user_id": 719661, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/f52d8660c0c8d98223778a71ba89844a?s=128&d=identicon&r=PG&f=1", "display_name": "dcalixto", "link": "https://stackoverflow.com/users/719661/dcalixto"}, "reply_to_user": {"reputation": 5286, "user_id": 455770, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/mMHwz.jpg?s=128&g=1", "display_name": "Rots", "link": "https://stackoverflow.com/users/455770/rots"}, "edited": false, "score": 0, "creation_date": 1438222186, "post_id": 31712676, "comment_id": 51365749, "body": "so i installed the last and the same problem happens"}, {"owner": {"reputation": 399, "user_id": 719661, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/f52d8660c0c8d98223778a71ba89844a?s=128&d=identicon&r=PG&f=1", "display_name": "dcalixto", "link": "https://stackoverflow.com/users/719661/dcalixto"}, "reply_to_user": {"reputation": 5286, "user_id": 455770, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/mMHwz.jpg?s=128&g=1", "display_name": "Rots", "link": "https://stackoverflow.com/users/455770/rots"}, "edited": false, "score": 0, "creation_date": 1438222202, "post_id": 31712676, "comment_id": 51365755, "body": "E: Version &#39;5.0.15&#39; for &#39;passenger&#39; was not found"}, {"owner": {"reputation": 5286, "user_id": 455770, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/mMHwz.jpg?s=128&g=1", "display_name": "Rots", "link": "https://stackoverflow.com/users/455770/rots"}, "edited": false, "score": 0, "creation_date": 1438222633, "post_id": 31712676, "comment_id": 51365849, "body": "What&#39;s in your Gemfile?"}, {"owner": {"reputation": 399, "user_id": 719661, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/f52d8660c0c8d98223778a71ba89844a?s=128&d=identicon&r=PG&f=1", "display_name": "dcalixto", "link": "https://stackoverflow.com/users/719661/dcalixto"}, "reply_to_user": {"reputation": 5286, "user_id": 455770, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/mMHwz.jpg?s=128&g=1", "display_name": "Rots", "link": "https://stackoverflow.com/users/455770/rots"}, "edited": false, "score": 0, "creation_date": 1438222894, "post_id": 31712676, "comment_id": 51365896, "body": "group :production do   gem &quot;pg&quot;   gem &#39;passenger&#39;   end   #gem &#39;debugger&#39;    gem &#39;rubber&#39; gem &#39;open4&#39;"}, {"owner": {"reputation": 5286, "user_id": 455770, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/mMHwz.jpg?s=128&g=1", "display_name": "Rots", "link": "https://stackoverflow.com/users/455770/rots"}, "edited": false, "score": 0, "creation_date": 1438226309, "post_id": 31712676, "comment_id": 51366752, "body": "Looks fine. Try looking into the Capfile and Gemfile here at the <a href=\"https://github.com/dliggat/bloggy\" rel=\"nofollow noreferrer\">example project</a>. Try having <code>require &#39;rubber&#39;</code> before the production group."}, {"owner": {"reputation": 399, "user_id": 719661, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/f52d8660c0c8d98223778a71ba89844a?s=128&d=identicon&r=PG&f=1", "display_name": "dcalixto", "link": "https://stackoverflow.com/users/719661/dcalixto"}, "reply_to_user": {"reputation": 5286, "user_id": 455770, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/mMHwz.jpg?s=128&g=1", "display_name": "Rots", "link": "https://stackoverflow.com/users/455770/rots"}, "edited": false, "score": 0, "creation_date": 1438228869, "post_id": 31712676, "comment_id": 51367416, "body": "thank&#39;s man, but still the same"}], "owner": {"reputation": 399, "user_id": 719661, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/f52d8660c0c8d98223778a71ba89844a?s=128&d=identicon&r=PG&f=1", "display_name": "dcalixto", "link": "https://stackoverflow.com/users/719661/dcalixto"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 51, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1438211372, "creation_date": 1438211372, "question_id": 31712676, "link": "https://stackoverflow.com/questions/31712676/rubber-nginx-passenger-deployment-passenger-was-not-found", "title": "Rubber Nginx Passenger deployment &#39;passenger&#39; was not found", "body": "<p>someone is getting this error on the log trying to deploy on ec2?</p>\n\n<pre><code> ** [out :: db01.y.com] libgdbm-dev is already the newest version.\n ** [out :: db01.y.com] libgdbm3 is already the newest version.\n ** [out :: db01.y.com] libncurses5-dev is already the newest version.\n ** [out :: db01.y.com] libreadline6-dev is already the newest version.\n ** [out :: db01.y.com] zlib1g-dev is already the newest version.\n ** [out :: db01.y.com] collectd is already the newest version.\n ** [out :: db01.y.com] monit is already the newest version.\n ** [out :: db01.y.com] ec2-ami-tools is already the newest version.\n ** [out :: db01.y.com] build-essential is already the newest version.\n ** [out :: app01.y.com] \n ** [out :: app01.y.com] Reading state information...\n ** [out :: app01.y.com] \n ** [out :: app01.y.com] E: Version '1:4.0.59-1~precise1' for 'passenger' was not found\n</code></pre>\n\n<p>my passenger_nginx, so have some specific version to this passenger_ngnix?</p>\n\n<pre><code> passenger_version: '1:4.0.59-1~`lsb_release -sc`1'\n    passenger_ruby: \"#{ruby_path}/bin/ruby\"\n    nginx_log_dir: /mnt/nginx/logs\n    use_ssl_key: false\n    roles:\n      passenger_nginx:\n        packages: [libcurl4-openssl-dev, libpcre3-dev, nginx-extras, [passenger, \"#{passenger_version}\"]]\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-3", "ruby-on-rails-4"], "comments": [{"owner": {"reputation": 2376, "user_id": 3311657, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/9d1d7b5444ea5fbb3b5e0ecb8303a88e?s=128&d=identicon&r=PG", "display_name": "steve klein", "link": "https://stackoverflow.com/users/3311657/steve-klein"}, "edited": false, "score": 0, "creation_date": 1438209667, "post_id": 31712282, "comment_id": 51362709, "body": "<code>if params[:q][0,1] == &#39;&quot;&#39; &amp;&amp; params[:q][-1,1] == &#39;&quot;&#39; #do quote thing else #do other thing</code>?"}, {"owner": {"reputation": 1033, "user_id": 2081579, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/2cf910eeba1f1377ca935807d309165f?s=128&d=identicon&r=PG", "display_name": "Doublespeed", "link": "https://stackoverflow.com/users/2081579/doublespeed"}, "edited": false, "score": 0, "creation_date": 1438209783, "post_id": 31712282, "comment_id": 51362742, "body": "hmm, but by the time it gets into the params hash, isn&#39;t the quotes encoded or eliminated? What exactly does the params hash contain when the endpoint is hit?"}, {"owner": {"reputation": 9917, "user_id": 1586221, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/96ab4c67eb62b315a8e7584f7dfd547a?s=128&d=identicon&r=PG", "display_name": "tompave", "link": "https://stackoverflow.com/users/1586221/tompave"}, "reply_to_user": {"reputation": 1033, "user_id": 2081579, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/2cf910eeba1f1377ca935807d309165f?s=128&d=identicon&r=PG", "display_name": "Doublespeed", "link": "https://stackoverflow.com/users/2081579/doublespeed"}, "edited": false, "score": 0, "creation_date": 1438210064, "post_id": 31712282, "comment_id": 51362837, "body": "@user2081579 the best way to find out is to try. Anyway, check my answer."}], "answers": [{"comments": [{"owner": {"reputation": 7158, "user_id": 1445444, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/e0baa59194d1ab50811481dd6b4aab5c?s=128&d=identicon&r=PG&f=1", "display_name": "Horse Voice", "link": "https://stackoverflow.com/users/1445444/horse-voice"}, "edited": false, "score": 0, "creation_date": 1438214641, "post_id": 31712441, "comment_id": 51363992, "body": "thank you. How would i extract just the string from the final double quotes example after checking params[:q] contains &quot;\\&quot;?"}, {"owner": {"reputation": 7158, "user_id": 1445444, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/e0baa59194d1ab50811481dd6b4aab5c?s=128&d=identicon&r=PG&f=1", "display_name": "Horse Voice", "link": "https://stackoverflow.com/users/1445444/horse-voice"}, "edited": false, "score": 0, "creation_date": 1438217698, "post_id": 31712441, "comment_id": 51364744, "body": "thanks. But I get an error: <code>clean.match(pattern)[1] NoMethodError: undefined method </code>[]&#39; for nil:NilClass`"}, {"owner": {"reputation": 9917, "user_id": 1586221, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/96ab4c67eb62b315a8e7584f7dfd547a?s=128&d=identicon&r=PG", "display_name": "tompave", "link": "https://stackoverflow.com/users/1586221/tompave"}, "reply_to_user": {"reputation": 7158, "user_id": 1445444, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/e0baa59194d1ab50811481dd6b4aab5c?s=128&d=identicon&r=PG&f=1", "display_name": "Horse Voice", "link": "https://stackoverflow.com/users/1445444/horse-voice"}, "edited": false, "score": 0, "creation_date": 1438218700, "post_id": 31712441, "comment_id": 51364996, "body": "That&#39;s because there is no match. My example was just that: an example. you need to expand the code, read the docs, and restructure it to make it safe for any kind of input."}, {"owner": {"reputation": 7158, "user_id": 1445444, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/e0baa59194d1ab50811481dd6b4aab5c?s=128&d=identicon&r=PG&f=1", "display_name": "Horse Voice", "link": "https://stackoverflow.com/users/1445444/horse-voice"}, "edited": false, "score": 0, "creation_date": 1438290776, "post_id": 31712441, "comment_id": 51403701, "body": "All I need is to be able to check whether the variable contains a string literal. <code>with_quotes?(&quot;hello&quot;)</code> returns nothing. Where as <code>with_quotes?(&quot;\\&quot;which one is your fav?\\&quot;&quot;)</code> returns a 0. Not sure what to do with this. Should I check for where the call to with_quotes? is equal to 0?"}, {"owner": {"reputation": 9917, "user_id": 1586221, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/96ab4c67eb62b315a8e7584f7dfd547a?s=128&d=identicon&r=PG", "display_name": "tompave", "link": "https://stackoverflow.com/users/1586221/tompave"}, "reply_to_user": {"reputation": 7158, "user_id": 1445444, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/e0baa59194d1ab50811481dd6b4aab5c?s=128&d=identicon&r=PG&f=1", "display_name": "Horse Voice", "link": "https://stackoverflow.com/users/1445444/horse-voice"}, "edited": false, "score": 0, "creation_date": 1438296383, "post_id": 31712441, "comment_id": 51405904, "body": "I have the feeling that you&#39;re not very familiar with Ruby. The <code>with_quotes?</code> method works for what you need to do. Check <a href=\"http://ruby-doc.org/core-2.2.2/String.html#method-i-3D-7E\" rel=\"nofollow noreferrer\">the docs</a>, and you&#39;ll see why it returns <code>0</code>. And remember than in Ruby everything evaluates to <code>true</code>, with the exception of <code>false</code> and <code>nil</code>."}], "tags": [], "owner": {"reputation": 9917, "user_id": 1586221, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/96ab4c67eb62b315a8e7584f7dfd547a?s=128&d=identicon&r=PG", "display_name": "tompave", "link": "https://stackoverflow.com/users/1586221/tompave"}, "is_accepted": true, "score": 2, "last_activity_date": 1438218993, "last_edit_date": 1438218993, "creation_date": 1438209964, "answer_id": 31712441, "question_id": 31712282, "link": "https://stackoverflow.com/questions/31712282/how-to-check-rails-params-hash-from-url-query-parameter-contains-double-quoted-s/31712441#31712441", "title": "How to check rails params hash from url query parameter contains double quoted string?", "body": "<p>Try with <code>request.fullpath</code>. Also, the content of <code>params[:q]</code> should change to show the escaped characters:</p>\n\n<pre><code>http://localhost:3000/?q=hello\n\nrequest.fullpath\n# =&gt; \"/?q=hello\"\nparams[:q]\n# =&gt; \"hello\"\n\n\n\nhttp://localhost:3000/?q=hello+world\n\nrequest.fullpath\n# =&gt; \"/?q=hello+world\"\nparams[:q]\n# =&gt; \"hello world\"\n\n\n\nhttp://localhost:3000/?q=\"hello world\"\n\nrequest.fullpath\n# =&gt; \"/?q=%22hello%20world%22\"\nparams[:q]\n# =&gt; \"\\\"hello world\\\"\"\n</code></pre>\n\n<h3>Further answer as requested in comment:</h3>\n\n<pre><code>require \"uri\" # not required inside Rails\n\nraw = \"/?q=%22hello%20world%22\"\nclean = URI.unescape(raw)\n# =&gt; \"/?q=\\\"hello world\\\"\"\n\npattern = /\\A\\/\\?q\\=\\\"(.*)\\\"\\z/\nclean.match(pattern)[1]\n#\u00a0=&gt; \"hello world\"\n</code></pre>\n\n<h3>A more practical method:</h3>\n\n<pre><code>def query\n  if (q = params[:q]).present? &amp;&amp; with_quotes?(q)\n    q.gsub(\"\\\"\", \"\")\n  end\nend\n\n\ndef with_quotes?(string)\n  string =~ /\\A\\\"/\nend\n</code></pre>\n"}], "owner": {"reputation": 7158, "user_id": 1445444, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/e0baa59194d1ab50811481dd6b4aab5c?s=128&d=identicon&r=PG&f=1", "display_name": "Horse Voice", "link": "https://stackoverflow.com/users/1445444/horse-voice"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2154, "favorite_count": 1, "accepted_answer_id": 31712441, "answer_count": 1, "score": 4, "last_activity_date": 1438218993, "creation_date": 1438209051, "question_id": 31712282, "link": "https://stackoverflow.com/questions/31712282/how-to-check-rails-params-hash-from-url-query-parameter-contains-double-quoted-s", "title": "How to check rails params hash from url query parameter contains double quoted string?", "body": "<p>I created a GET endpoint to serve an API using rails. I want to be able to check for when the user passes double quotes for the query parameter in the url.</p>\n\n<p>So for example the user could call the below endpoint by passing the query parameter with double quotes or no quotes. My application is expected to behave differently if the double quotes are found in the query params..</p>\n\n<pre><code>localhost:8080/company/data.json?q=\"America Online in UK\"&amp;size=10\n</code></pre>\n\n<p>Now the user can also call the endpoint with no double quotes like this:</p>\n\n<pre><code>localhost:8080/company/data.json?q=America+Online+in+UK&amp;size=10\n</code></pre>\n\n<p>OR</p>\n\n<pre><code>localhost:8080/company/data.json?q=AOL&amp;size=10\n</code></pre>\n\n<p>How do I handle the above use-cases in a rails controller with respect to spaces and double quotes?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "sass", "gulp"], "comments": [{"owner": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "edited": false, "score": 0, "creation_date": 1438211726, "post_id": 31711568, "comment_id": 51363284, "body": "If this is a rails project make sure you have run <code>bundle install</code>. Also if you are using Rails you can consider using the built in assets keychain. Gulp is really powerful but is a bit of a swiss-army-chainsaw-lightsaber while Sprockets (the build in rails asset pipeline) usually just works."}, {"owner": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "edited": false, "score": 0, "creation_date": 1438211770, "post_id": 31711568, "comment_id": 51363296, "body": "<a href=\"http://guides.rubyonrails.org/asset_pipeline.html\" rel=\"nofollow noreferrer\">guides.rubyonrails.org/asset_pipeline.html</a>"}], "answers": [{"tags": [], "owner": {"reputation": 4566, "user_id": 1976941, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/854b13c934b2fda36ed88825add2c32d?s=128&d=identicon&r=PG", "display_name": "Mario Araque", "link": "https://stackoverflow.com/users/1976941/mario-araque"}, "is_accepted": false, "score": 1, "last_activity_date": 1438237142, "creation_date": 1438237142, "answer_id": 31716422, "question_id": 31711568, "link": "https://stackoverflow.com/questions/31711568/gulp-sass-ruby-not-working/31716422#31716422", "title": "gulp sass ruby not working", "body": "<p>I guess something went wrong while installing the Sass gem. Try reinstall Sass.</p>\n\n<pre><code>gem uninstall sass\ngem install sass\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1850, "user_id": 552621, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c20d79c6ba506fbed052ef164ffa225?s=128&d=identicon&r=PG", "display_name": "Nour Wolf", "link": "https://stackoverflow.com/users/552621/nour-wolf"}, "is_accepted": false, "score": 0, "last_activity_date": 1441582537, "creation_date": 1441582537, "answer_id": 32429335, "question_id": 31711568, "link": "https://stackoverflow.com/questions/31711568/gulp-sass-ruby-not-working/32429335#32429335", "title": "gulp sass ruby not working", "body": "<p>Make sure that your System Environment <code>Path</code> variable includes:</p>\n\n<p><code>C:\\Windows\\System32</code></p>\n\n<p>Obviously, Ruby bin directory should be included as well. For example:</p>\n\n<p><code>C:\\Ruby22\\bin</code></p>\n\n<p>I am not affiliated with <a href=\"http://www.rapidee.com\" rel=\"nofollow\">RapidEE</a> but I find their app is great for editing Environment Variables.</p>\n"}], "owner": {"reputation": 151, "user_id": 5141010, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/55807ffd32668755c4760c27f882afce?s=128&d=identicon&r=PG&f=1", "display_name": "angel", "link": "https://stackoverflow.com/users/5141010/angel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1261, "favorite_count": 1, "answer_count": 2, "score": 1, "last_activity_date": 1441582537, "creation_date": 1438205681, "question_id": 31711568, "link": "https://stackoverflow.com/questions/31711568/gulp-sass-ruby-not-working", "title": "gulp sass ruby not working", "body": "<p>I'm just starting to use ruby, gulp and node...</p>\n\n<p>I installed ruby for windows, then I installed the sass, then I install the node, gulp and the plugin gulp-ruby-sass</p>\n\n<p>I have this in my gulpfile.js</p>\n\n<pre><code>var gulp = require('gulp');\nvar sass = require('gulp-ruby-sass');\n\n\ngulp.task('styles', function() {\n    return sass('sass/**/*.scss', { style: 'compressed' })\n        .pipe(gulp.dest('./css/'));\n});\n</code></pre>\n\n<p>when i Try to run the gulp styles I got this error</p>\n\n<pre><code>C:\\Users\\angel\\project.test&gt;gulp styles\n[14:29:02] Using gulpfile ~\\project.test\\gulpfile.js\n[14:29:02] Starting 'styles'...\n\nevents.js:85\n      throw er; // Unhandled 'error' event\n            ^\nError: Gem cmd is not installed.\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1438239543, "post_id": 31711304, "comment_id": 51371345, "body": "If your array had other transactions by Robert and others, your code might produce, say, <code>h = { &#39;Robert&#39;=&gt;180, &#39;Thelma&#39;=&gt;240 }</code>. You could then write <code>h.keys.each { |k| h[k] = { dollar: h[k] } }; h #=&gt; { &#39;Robert&#39;=&gt;{ :dollar=&gt;180 }, &#39;Thelma&#39;=&gt;{ :dollar=&gt;240 } }</code>. I like this approach because it breaks the problem into two smaller problems: calculating totals and formatting. I think that is easiest to understand and facilitates testing and maintenance."}, {"owner": {"reputation": 152277, "user_id": 438992, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/QouOz.jpg?s=128&g=1", "display_name": "Dave Newton", "link": "https://stackoverflow.com/users/438992/dave-newton"}, "edited": false, "score": 1, "creation_date": 1438257512, "post_id": 31711304, "comment_id": 51382610, "body": "I lean in another direction altogether and favor real classes instead of an ad-hoc hash. The hashes are closer to that, e.g., here the people are just keys, they reach have a single account account, and the account has a &quot;field&quot; with the account balance."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "reply_to_user": {"reputation": 152277, "user_id": 438992, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/QouOz.jpg?s=128&g=1", "display_name": "Dave Newton", "link": "https://stackoverflow.com/users/438992/dave-newton"}, "edited": false, "score": 0, "creation_date": 1438271012, "post_id": 31711304, "comment_id": 51392436, "body": "I&#39;ll defer to @Dave any day when it comes to advice on building apps. Coding is just a hobby for me, so I&#39;m only guessing when it comes to the big picture. Aside: Dave, just two more sleeps before the Nerf Rival Apollo XV-700 is released!"}, {"owner": {"reputation": 152277, "user_id": 438992, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/QouOz.jpg?s=128&g=1", "display_name": "Dave Newton", "link": "https://stackoverflow.com/users/438992/dave-newton"}, "reply_to_user": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1438273333, "post_id": 31711304, "comment_id": 51393980, "body": "@CarySwoveland Tragically my advice is no better than anybody else&#39;s (or worse!) But on the Nerf gun I think there&#39;s no room for disagreement."}], "answers": [{"comments": [{"owner": {"reputation": 1781, "user_id": 3277633, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/d4a27cdac076e1e488208b60677242e0?s=128&d=identicon&r=PG&f=1", "display_name": "user3277633", "link": "https://stackoverflow.com/users/3277633/user3277633"}, "edited": false, "score": 0, "creation_date": 1438205807, "post_id": 31711368, "comment_id": 51361149, "body": "Hi @Dave, thanks for the detailed explanation. Learned something new today. If you can, can you please breakdown the parameters of <code>Hash.new</code> please? Although the code works perfectly, I&#39;d really like to understand the logic behind it."}, {"owner": {"reputation": 152277, "user_id": 438992, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/QouOz.jpg?s=128&g=1", "display_name": "Dave Newton", "link": "https://stackoverflow.com/users/438992/dave-newton"}, "reply_to_user": {"reputation": 1781, "user_id": 3277633, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/d4a27cdac076e1e488208b60677242e0?s=128&d=identicon&r=PG&f=1", "display_name": "user3277633", "link": "https://stackoverflow.com/users/3277633/user3277633"}, "edited": false, "score": 0, "creation_date": 1438206689, "post_id": 31711368, "comment_id": 51361539, "body": "@user3277633 The docs for <code>Hash.new</code> already break it down; nutshell is that you can pass nothing, pass a default value, or a block that creates the value for a given key when the key doesn&#39;t already exist in the hash."}], "tags": [], "owner": {"reputation": 152277, "user_id": 438992, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/QouOz.jpg?s=128&g=1", "display_name": "Dave Newton", "link": "https://stackoverflow.com/users/438992/dave-newton"}, "is_accepted": true, "score": 2, "last_activity_date": 1438204864, "creation_date": 1438204864, "answer_id": 31711368, "question_id": 31711304, "link": "https://stackoverflow.com/questions/31711304/ruby-add-a-nested-key-to-an-existing-hash/31711368#31711368", "title": "Ruby add a nested key to an existing hash", "body": "<p>You initialize the hash entry to <code>0</code>. You can't index the number <code>0</code>. </p>\n\n<p>If you want the value at the hash to be an object then you should have each hash entry be a new hash <code>{ dollar: 0 }</code>, one way being:</p>\n\n<pre><code>&gt; totals = Hash.new { |hash, key| hash[key] = { dollar: 0 } }\n&gt; totals[:foo][:dollar] += 50\n&gt; totals\n =&gt; { :foo =&gt; { :dollar =&gt; 50 } }\n&gt; totals[:foo][:dollar] += 50\n&gt; totals[:bar][:dollar] += 10\n&gt; totals\n =&gt; { :foo =&gt; { :dollar =&gt; 100 }, :bar =&gt; { :dollar =&gt; 10 } }\n</code></pre>\n"}], "owner": {"reputation": 1781, "user_id": 3277633, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/d4a27cdac076e1e488208b60677242e0?s=128&d=identicon&r=PG&f=1", "display_name": "user3277633", "link": "https://stackoverflow.com/users/3277633/user3277633"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 662, "favorite_count": 1, "accepted_answer_id": 31711368, "answer_count": 1, "score": 0, "last_activity_date": 1438204864, "creation_date": 1438204663, "question_id": 31711304, "link": "https://stackoverflow.com/questions/31711304/ruby-add-a-nested-key-to-an-existing-hash", "title": "Ruby add a nested key to an existing hash", "body": "<p>I'm stuck on what appears to be a very simple problem.</p>\n\n<p>If I have a transactions array <code>[#&lt;payer: \"Robert\", dollar: 100, cent: 10&gt;]</code>  </p>\n\n<pre><code>totals = Hash.new(0)\ntransactions.each do |t|\n  totals[t.payer] += t.dollar\nend\ntotals\n</code></pre>\n\n<p>the code above will return <code>{\"Robert\"=&gt;100}</code>. What I am looking for is something closer to <code>{\"Robert\" =&gt; { dollar: 100 }}</code></p>\n\n<p>So I attempted  </p>\n\n<pre><code>totals = Hash.new(0)\ntransactions.each do |t|\n  totals[t.payer][:dollar] += t.dollar\nend\ntotals\n</code></pre>\n\n<p>but this returns a <code>no implicit conversion of Symbol into Integer</code> Error. if I change the <code>[:dollar]</code> to <code>[\"dollar\"]</code> it returns a <code>no implicit conversion of String into Integer</code></p>\n\n<p>What is the root of the my problem?</p>\n"}, {"tags": ["javascript", "ruby-on-rails", "ruby", "ruby-on-rails-4", "html-safe"], "comments": [{"owner": {"reputation": 38307, "user_id": 2057388, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ceef8c04f66cd0e2bd360ef6abc14a81?s=128&d=identicon&r=PG", "display_name": "\u0417\u0435\u043b\u0451\u043d\u044b\u0439", "link": "https://stackoverflow.com/users/2057388/%d0%97%d0%b5%d0%bb%d1%91%d0%bd%d1%8b%d0%b9"}, "edited": false, "score": 0, "creation_date": 1438204944, "post_id": 31711166, "comment_id": 51360792, "body": "<a href=\"http://apidock.com/rails/String/html_safe\" rel=\"nofollow noreferrer\">html_safe</a> - Marks a string as trusted safe. It will be inserted into HTML with no additional escaping performed. It is your responsibilty to ensure that the string contains no malicious content. This method is equivalent to the <code>raw</code> helper in views. It is recommended that you use <code>sanitize</code> instead of this method. It should never be called on user input."}, {"owner": {"reputation": 1514, "user_id": 3749865, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c1873b0d2c86671bb1b3d44b53b48c09?s=128&d=identicon&r=PG", "display_name": "Christian Rolle", "link": "https://stackoverflow.com/users/3749865/christian-rolle"}, "edited": false, "score": 0, "creation_date": 1438608817, "post_id": 31711166, "comment_id": 51505648, "body": "You got several answers. If one of them helped in any way, please close the question by choosing one?"}], "answers": [{"comments": [{"owner": {"reputation": 1514, "user_id": 3749865, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c1873b0d2c86671bb1b3d44b53b48c09?s=128&d=identicon&r=PG", "display_name": "Christian Rolle", "link": "https://stackoverflow.com/users/3749865/christian-rolle"}, "edited": false, "score": 1, "creation_date": 1438237571, "post_id": 31711362, "comment_id": 51370378, "body": "to_json also escapes the strings."}], "tags": [], "owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "is_accepted": false, "score": 1, "last_activity_date": 1438237674, "last_edit_date": 1438237674, "creation_date": 1438204854, "answer_id": 31711362, "question_id": 31711166, "link": "https://stackoverflow.com/questions/31711166/html-safe-is-not-working-in-rails-to-javascript/31711362#31711362", "title": "html_safe is not working in rails to javascript", "body": "<p>I would use <code>to_json</code>:</p>\n\n<pre><code>//javascript\nvar lineChartData = {\n    labels : &lt;%== @cars.to_json %&gt; \n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1514, "user_id": 3749865, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c1873b0d2c86671bb1b3d44b53b48c09?s=128&d=identicon&r=PG", "display_name": "Christian Rolle", "link": "https://stackoverflow.com/users/3749865/christian-rolle"}, "is_accepted": true, "score": 0, "last_activity_date": 1438205435, "last_edit_date": 1438205435, "creation_date": 1438205091, "answer_id": 31711421, "question_id": 31711166, "link": "https://stackoverflow.com/questions/31711166/html-safe-is-not-working-in-rails-to-javascript/31711421#31711421", "title": "html_safe is not working in rails to javascript", "body": "<p>Although I don't advise to inject Ruby variables into JavaScript directly using the <a href=\"http://apidock.com/rails/ActionView/Helpers/OutputSafetyHelper/raw\" rel=\"nofollow\">OutputSafetyHelper#raw</a> works:</p>\n\n<pre><code>//javascript\nvar lineChartData = {\n  labels : &lt;%= raw @cars %&gt; \n}\n</code></pre>\n\n<p>I suggest to embed those Strings into HTML and fetch them with JavaScript.</p>\n"}, {"tags": [], "owner": {"reputation": 7893, "user_id": 254046, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/23164d8e3973e48e56921f7600538ca1?s=128&d=identicon&r=PG", "display_name": "Javid Jamae", "link": "https://stackoverflow.com/users/254046/javid-jamae"}, "is_accepted": false, "score": 0, "last_activity_date": 1438208044, "creation_date": 1438208044, "answer_id": 31712093, "question_id": 31711166, "link": "https://stackoverflow.com/questions/31711166/html-safe-is-not-working-in-rails-to-javascript/31712093#31712093", "title": "html_safe is not working in rails to javascript", "body": "<p>It seems like you're generating a JS view using ERB. I would recommend not mixing ERB with JS like this. Try using a tool like <a href=\"https://github.com/gazay/gon\" rel=\"nofollow\">Gon</a> which allows you to set the variable onto a Ruby object in the controller, and allows you to reference the data in your JS using a Javascript object. The advantage to this approach is that you can write pure JS and keep it in the assets directory. Then you can take advantage of the asset pipeline: minimizing, uglifying, coffee script, etc. Pure JS in the assets directory is also more easily tested using a JS testing framework like Jasmine. </p>\n"}], "owner": {"reputation": 4159, "user_id": 1959050, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/421de4eb68c9e4a007b0c90f05c15999?s=128&d=identicon&r=PG", "display_name": "Philip7899", "link": "https://stackoverflow.com/users/1959050/philip7899"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1812, "favorite_count": 1, "accepted_answer_id": 31711421, "answer_count": 3, "score": 0, "last_activity_date": 1438237674, "creation_date": 1438204177, "question_id": 31711166, "link": "https://stackoverflow.com/questions/31711166/html-safe-is-not-working-in-rails-to-javascript", "title": "html_safe is not working in rails to javascript", "body": "<p>I have an array of strings declared in my controller that I need to use in a js file.  Here is my code:</p>\n\n<pre><code>#controller\n@cars = current_user.cars.completed.collect{|c| c.name.titleize }\nputs \"#{@cars.inspect}\"\n</code></pre>\n\n<p>The <code>puts</code> returns:</p>\n\n<pre><code>[\"Presentation 2\", \"Presentation 1\"]\n</code></pre>\n\n<p>I now need to use the array in javascript, so I do:</p>\n\n<pre><code>//javascript\nvar lineChartData = {\n    labels : &lt;%= @cars %&gt; \n}\n</code></pre>\n\n<p>The javascript is not working though because the browser is reading it as:</p>\n\n<pre><code>//javascruot\nvar lineChartData = {\n    labels : [&amp;quot;Presentation 2&amp;quot;, &amp;quot;Presentation 1&amp;quot;], \n}\n</code></pre>\n\n<p>I have tried using <code>html_safe</code> like this:</p>\n\n<pre><code>#controller\n@cars = current_user.cars.completed.collect{|c| c.name.titleize.html_safe }\nputs \"#{@cars.inspect}\"\n</code></pre>\n\n<p>but it has no effect.  How do I get the quotes to work properly?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "multithreading", "ruby-on-rails-4", "routes"], "comments": [{"owner": {"reputation": 91121, "user_id": 179125, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5594142dcc49a24b1902ec8059181f8d?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan Running", "link": "https://stackoverflow.com/users/179125/jordan-running"}, "edited": false, "score": 0, "creation_date": 1438204290, "post_id": 31711135, "comment_id": 51360452, "body": "Use resourceful routes. There&#39;s no reason not to, and it will save you a lot of headaches like this."}, {"owner": {"reputation": 304, "user_id": 4962804, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/91Rix.png?s=128&g=1", "display_name": "Joe Dayvie", "link": "https://stackoverflow.com/users/4962804/joe-dayvie"}, "reply_to_user": {"reputation": 91121, "user_id": 179125, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5594142dcc49a24b1902ec8059181f8d?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan Running", "link": "https://stackoverflow.com/users/179125/jordan-running"}, "edited": false, "score": 0, "creation_date": 1438204406, "post_id": 31711135, "comment_id": 51360509, "body": "I just was not sure if resourceful routes were similar to scaffold. It&#39;s an option but always the best way to go?"}, {"owner": {"reputation": 91121, "user_id": 179125, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5594142dcc49a24b1902ec8059181f8d?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan Running", "link": "https://stackoverflow.com/users/179125/jordan-running"}, "edited": false, "score": 2, "creation_date": 1438204564, "post_id": 31711135, "comment_id": 51360588, "body": "There are times when you may need to manually define a route with e.g. <code>get</code> in addition to your resourceful routes, but all of the routes you posted correspond directly to routes that <code>resources</code> would automatically define for you, so it&#39;s absolutely the best way to go in your case."}, {"owner": {"reputation": 304, "user_id": 4962804, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/91Rix.png?s=128&g=1", "display_name": "Joe Dayvie", "link": "https://stackoverflow.com/users/4962804/joe-dayvie"}, "reply_to_user": {"reputation": 91121, "user_id": 179125, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5594142dcc49a24b1902ec8059181f8d?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan Running", "link": "https://stackoverflow.com/users/179125/jordan-running"}, "edited": false, "score": 0, "creation_date": 1438204609, "post_id": 31711135, "comment_id": 51360622, "body": "Okay, thank you - If you wanted to post in the answer, I will give you the points. Thanks again."}, {"owner": {"reputation": 304, "user_id": 4962804, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/91Rix.png?s=128&g=1", "display_name": "Joe Dayvie", "link": "https://stackoverflow.com/users/4962804/joe-dayvie"}, "reply_to_user": {"reputation": 91121, "user_id": 179125, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5594142dcc49a24b1902ec8059181f8d?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan Running", "link": "https://stackoverflow.com/users/179125/jordan-running"}, "edited": false, "score": 0, "creation_date": 1438204713, "post_id": 31711135, "comment_id": 51360679, "body": "Side note, it is not possible to user the :as with resourceful routes, is it?"}, {"owner": {"reputation": 91121, "user_id": 179125, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5594142dcc49a24b1902ec8059181f8d?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan Running", "link": "https://stackoverflow.com/users/179125/jordan-running"}, "edited": false, "score": 1, "creation_date": 1438204787, "post_id": 31711135, "comment_id": 51360714, "body": "Yes, it&#39;s absolutely possible. Have you read the Rails Guide on routing? <a href=\"http://guides.rubyonrails.org/routing.html#overriding-the-named-helpers\" rel=\"nofollow noreferrer\">guides.rubyonrails.org/&hellip;</a>"}, {"owner": {"reputation": 304, "user_id": 4962804, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/91Rix.png?s=128&g=1", "display_name": "Joe Dayvie", "link": "https://stackoverflow.com/users/4962804/joe-dayvie"}, "reply_to_user": {"reputation": 91121, "user_id": 179125, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5594142dcc49a24b1902ec8059181f8d?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan Running", "link": "https://stackoverflow.com/users/179125/jordan-running"}, "edited": false, "score": 0, "creation_date": 1438204802, "post_id": 31711135, "comment_id": 51360726, "body": "Will check there, perfect, thank you!"}], "answers": [{"tags": [], "owner": {"reputation": 5250, "user_id": 5154683, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eae81933dce5ced9ec019414bbd4f0f4?s=128&d=identicon&r=PG&f=1", "display_name": "Robert Nubel", "link": "https://stackoverflow.com/users/5154683/robert-nubel"}, "is_accepted": false, "score": 1, "last_activity_date": 1438208436, "last_edit_date": 1495541168, "creation_date": 1438208436, "answer_id": 31712171, "question_id": 31711135, "link": "https://stackoverflow.com/questions/31711135/nested-routes-for-comments-without-using-resources/31712171#31712171", "title": "Nested routes for comments without using resources", "body": "<p>You can do nested routes \"manually\" like so:</p>\n\n<pre><code>get '/threads/:thread_id/comments/new' =&gt; 'comments#new'\nget '/threads/:thread_id/comments/:id' =&gt; 'comments#show'\n</code></pre>\n\n<p>And CommentsController's <code>new</code> action can do something like:</p>\n\n<pre><code>def new\n  @thread = Thread.find(params[:thread_id])\n  @comment = @thread.comments.build\nend\n</code></pre>\n\n<p>However, I strongly agree with <a href=\"https://stackoverflow.com/questions/31711135/nested-routes-for-comments-with-our-using-resources#comment51360588_31711135\">Jordan's advice above</a>; your routes are a bit messy, not fully RESTful, and would be much easier to express via resourceful routing.</p>\n"}], "owner": {"reputation": 304, "user_id": 4962804, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/91Rix.png?s=128&g=1", "display_name": "Joe Dayvie", "link": "https://stackoverflow.com/users/4962804/joe-dayvie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 41, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1438211508, "creation_date": 1438204065, "last_edit_date": 1438211508, "question_id": 31711135, "link": "https://stackoverflow.com/questions/31711135/nested-routes-for-comments-without-using-resources", "title": "Nested routes for comments without using resources", "body": "<p>I am in the process of building a forum and the threads are setup and viewing no problem. While in the process of trying to create the comments within a thread, I seem to be confused with how to setup the routes. Normally I know people have nested routes:</p>\n\n<pre><code>resources :threads do\n  resources :comments\nend\n</code></pre>\n\n<p>Though the difference is my routes do not use the resources method as I have them setup individually:</p>\n\n<pre><code>get '/thread' =&gt; 'threads#discussion'\npost '/create_thread' =&gt; 'threads#create'\nget '/create_thread' =&gt; 'threads#new', :as =&gt; :new_thread\nget '/threads/:id' =&gt; 'threads#show', :as =&gt; :thread_show\nget 'threads/edit/:id' =&gt; 'threads#edit', :as =&gt; :edit_thread\nput '/threads/edit/:id' =&gt; 'threads#update', :as =&gt; :update_thread\ndelete 'threads/:id' =&gt; 'threads#destroy'\n</code></pre>\n\n<p><strong><em>Thread/threads replaced the actual location name</em></strong></p>\n\n<p>Is there a way for me to place nested routes for the comments within each thread? I've give the proper associations for each model (Users, Threads, Comments) and added the user_id, thread_id to the Comments model.</p>\n\n<p>If you have any knowledge on the correct way to setup the routes for the comments or know of an article, please list it here. </p>\n\n<p>Thank you so much!</p>\n\n<p><strong>EDIT</strong></p>\n\n<p>The comments will be placed directly onto the thread page and not a new page.</p>\n\n<p>Joe</p>\n"}, {"tags": ["ruby", "linux", "redhat", "compass"], "answers": [{"comments": [{"owner": {"reputation": 347, "user_id": 4039218, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/f9fac22be973336c30c92ad6a19f6cfa?s=128&d=identicon&r=PG&f=1", "display_name": "anon", "link": "https://stackoverflow.com/users/4039218/anon"}, "edited": false, "score": 2, "creation_date": 1438212524, "post_id": 31712514, "comment_id": 51363488, "body": "ruby-devel is not in RHEL7. That&#39;s what the issue is."}, {"owner": {"reputation": 347, "user_id": 4039218, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/f9fac22be973336c30c92ad6a19f6cfa?s=128&d=identicon&r=PG&f=1", "display_name": "anon", "link": "https://stackoverflow.com/users/4039218/anon"}, "edited": false, "score": 0, "creation_date": 1438213222, "post_id": 31712514, "comment_id": 51363655, "body": "So it requires &#39;Development Tools&#39; in addition to all the other packages as well. It fixed it up :)"}, {"owner": {"reputation": 7219, "user_id": 326516, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/61292ea4b013ef2834a28f9ff390c6fd?s=128&d=identicon&r=PG", "display_name": "Micah Elliott", "link": "https://stackoverflow.com/users/326516/micah-elliott"}, "reply_to_user": {"reputation": 347, "user_id": 4039218, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/f9fac22be973336c30c92ad6a19f6cfa?s=128&d=identicon&r=PG&f=1", "display_name": "anon", "link": "https://stackoverflow.com/users/4039218/anon"}, "edited": false, "score": 0, "creation_date": 1438214479, "post_id": 31712514, "comment_id": 51363952, "body": "I do see ruby-devel in CentOS 7, so that&#39;s surprising RHEL7 does not have it. Anyway, glad you solved it. Good idea to have &#39;Development Tools&#39; on there to be on the safe side."}, {"owner": {"reputation": 7219, "user_id": 326516, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/61292ea4b013ef2834a28f9ff390c6fd?s=128&d=identicon&r=PG", "display_name": "Micah Elliott", "link": "https://stackoverflow.com/users/326516/micah-elliott"}, "reply_to_user": {"reputation": 347, "user_id": 4039218, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/f9fac22be973336c30c92ad6a19f6cfa?s=128&d=identicon&r=PG&f=1", "display_name": "anon", "link": "https://stackoverflow.com/users/4039218/anon"}, "edited": false, "score": 0, "creation_date": 1439569106, "post_id": 31712514, "comment_id": 51931307, "body": "@Tushar-Gupta Did this answer solve your issue? If so, please mark it as accepted so that others can see that it worked for this case."}], "tags": [], "owner": {"reputation": 7219, "user_id": 326516, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/61292ea4b013ef2834a28f9ff390c6fd?s=128&d=identicon&r=PG", "display_name": "Micah Elliott", "link": "https://stackoverflow.com/users/326516/micah-elliott"}, "is_accepted": true, "score": 4, "last_activity_date": 1439569268, "last_edit_date": 1439569268, "creation_date": 1438210402, "answer_id": 31712514, "question_id": 31710990, "link": "https://stackoverflow.com/questions/31710990/unable-to-install-compass-on-redhat-7/31712514#31712514", "title": "Unable to install Compass on RedHat 7", "body": "<p>I believe you also need a <code>yum install ruby-devel</code> to get the <code>ruby.h</code> onto your system. If that's not enough, the bigger-hammer approach would be to install the full 'Development Tools' packages with:</p>\n\n<pre><code>yum groupinstall 'Development Tools'\n</code></pre>\n"}], "owner": {"reputation": 347, "user_id": 4039218, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/f9fac22be973336c30c92ad6a19f6cfa?s=128&d=identicon&r=PG&f=1", "display_name": "anon", "link": "https://stackoverflow.com/users/4039218/anon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1775, "favorite_count": 0, "accepted_answer_id": 31712514, "answer_count": 1, "score": 3, "last_activity_date": 1439569268, "creation_date": 1438203497, "question_id": 31710990, "link": "https://stackoverflow.com/questions/31710990/unable-to-install-compass-on-redhat-7", "title": "Unable to install Compass on RedHat 7", "body": "<p>I am trying to install compass on RedHat 7. </p>\n\n<p>I have ruby version ruby 2.0.0p598 (2014-11-13) [x86_64-linux] installed.</p>\n\n<p>I am executing the following commands:</p>\n\n<pre><code>sudo yum insatll ruby\nsudo yum install gcc gcc-c++ make automake autoconf curl-devel openssl-devel zlib-devel httpd-devel apr-devel apr-util-devel sqlite-devel\nsudo gem install compass --http-proxy http://XXXXX:XXXX@XXXX:8080\n</code></pre>\n\n<p>I am getting the following error:</p>\n\n<p>Building native extensions.  This could take a while...\nERROR:  Error installing compass:\n        ERROR: Failed to build gem native extension.</p>\n\n<pre><code>/usr/bin/ruby -r ./siteconf20150729-6603-73q6zu.rb extconf.rb\n</code></pre>\n\n<p>mkmf.rb can't find header files for ruby at /usr/share/include/ruby.h</p>\n\n<p>extconf failed, exit code 1</p>\n\n<p>Gem files will remain installed in /usr/local/share/gems/gems/ffi-1.9.10 for inspection.\nResults logged to /usr/local/lib64/gems/ruby/ffi-1.9.10/gem_make.out</p>\n\n<p>Not sure how to fix this. Before installing compass I even tried </p>\n\n<pre><code>sudo gem update --system\n</code></pre>\n\n<p>Still the same error. Then I tried updating ruby to 2.2.2 but still the same error. The gem version is 2.0.14</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "answers": [{"tags": [], "owner": {"reputation": 37836, "user_id": 24195, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bb4bebe360045a2dce663ee875f13723?s=128&d=identicon&r=PG", "display_name": "Rob Di Marco", "link": "https://stackoverflow.com/users/24195/rob-di-marco"}, "is_accepted": true, "score": 2, "last_activity_date": 1438203576, "creation_date": 1438203576, "answer_id": 31711018, "question_id": 31710904, "link": "https://stackoverflow.com/questions/31710904/hashslice-like-method-that-returns-nil-if-given-key-are-not-present/31711018#31711018", "title": "Hash#slice like method that returns nil if given key are not present", "body": "<p>I would use a <code>reduce</code> of the terms you are interested in:</p>\n\n<pre><code>hash = {a: 1, b: 2, d: 4}\n[:a, :c, :d].reduce({}) {|h, k| h[k] = hash[k]; h }\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 52685, "user_id": 980550, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/8emhY.jpg?s=128&g=1", "display_name": "lurker", "link": "https://stackoverflow.com/users/980550/lurker"}, "is_accepted": false, "score": 1, "last_activity_date": 1438210355, "creation_date": 1438210355, "answer_id": 31712507, "question_id": 31710904, "link": "https://stackoverflow.com/questions/31710904/hashslice-like-method-that-returns-nil-if-given-key-are-not-present/31712507#31712507", "title": "Hash#slice like method that returns nil if given key are not present", "body": "<p>Another option:</p>\n\n<pre><code>hash = {a: 1, b: 2, d: 4}\n[:a, :c, :d].collect { |k| [k, hash[k]] }.to_h\n =&gt; {:a=&gt;1, :c=&gt;nil, :d=&gt;4}\n</code></pre>\n\n<p>You can monkey patch <code>Hash</code> to add it as a method:</p>\n\n<pre><code>class Hash\n  def my_slice(*keys)\n    keys.collect { |k| [k, self[k]] }.to_h\n  end\nend\n\n {a: 1, b: 2, d: 4}.my_slice(:a, :c, :d)\n =&gt; {:a=&gt;1, :c=&gt;nil, :d=&gt;4}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1268, "user_id": 5442, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1ca3a0180e953e56d528a3b5ddb3d6b3?s=128&d=identicon&r=PG", "display_name": "kranzky", "link": "https://stackoverflow.com/users/5442/kranzky"}, "is_accepted": false, "score": 2, "last_activity_date": 1438231064, "creation_date": 1438231064, "answer_id": 31715258, "question_id": 31710904, "link": "https://stackoverflow.com/questions/31710904/hashslice-like-method-that-returns-nil-if-given-key-are-not-present/31715258#31715258", "title": "Hash#slice like method that returns nil if given key are not present", "body": "<p>Here's my solution; it creates a new Hash from the <code>keys</code> array with <code>nil</code> values, and merges that with the results of the slice:</p>\n\n<pre><code>&gt; Hash[keys.zip].merge(hash.slice(*keys))\n =&gt; {:a=&gt;1, :c=&gt;nil, :d=&gt;4}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 5953064, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/611a0bcc9ece9ae8cad0fc76e306c2d3?s=128&d=identicon&r=PG", "display_name": "Joe Gaudet", "link": "https://stackoverflow.com/users/5953064/joe-gaudet"}, "is_accepted": false, "score": 0, "last_activity_date": 1553123012, "creation_date": 1553123012, "answer_id": 55271405, "question_id": 31710904, "link": "https://stackoverflow.com/questions/31710904/hashslice-like-method-that-returns-nil-if-given-key-are-not-present/55271405#55271405", "title": "Hash#slice like method that returns nil if given key are not present", "body": "<p>Another approach if you're not fond of using reduce (though I am) is to map the keys to an array of tuples and then call to_h. Like so:</p>\n\n<pre><code>hash = {a: 1, b: 2, d: 4}\n[:a, :c, :d].map{|k| [k, hash[k]]}.to_h\n</code></pre>\n"}], "owner": {"reputation": 11845, "user_id": 1536527, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/Sgr8O.png?s=128&g=1", "display_name": "ironsand", "link": "https://stackoverflow.com/users/1536527/ironsand"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1191, "favorite_count": 1, "accepted_answer_id": 31711018, "answer_count": 4, "score": 6, "last_activity_date": 1553123012, "creation_date": 1438203195, "question_id": 31710904, "link": "https://stackoverflow.com/questions/31710904/hashslice-like-method-that-returns-nil-if-given-key-are-not-present", "title": "Hash#slice like method that returns nil if given key are not present", "body": "<p>I'm using <code>Hash#slice</code> method in my rails environment.</p>\n\n<p><code>slice</code> method works like this:</p>\n\n<pre><code>{ a: 1, b: 2, d: 4 }.slice(:a, :c, :d)\n=&gt; {:a=&gt;1, :d=&gt;4}\n</code></pre>\n\n<p>But I want to return a <code>nil</code> if given key are not present, like this:</p>\n\n<pre><code>{ a: 1, b: 2, d: 4 }.slice(:a, :c, :d)\n=&gt; {:a=&gt;1, :c=&gt;nil, :d=&gt;4}\n</code></pre>\n\n<p>This is what I wrote for the function, is there better way to write this function?</p>\n\n<pre><code>hash = {a: 1, b: 2, d: 4}\nkeys = [:a, :c, :d]\nkeys_not_present = keys.map { |key| key unless hash.has_key?(key) }.compact\nkeys_not_present = keys_not_present.zip([nil]*keys_not_present.size).to_h\nhash.slice(*keys).merge(keys_not_present)\n</code></pre>\n\n<p>The order of the hash is not concerned.</p>\n"}, {"tags": ["python", "ruby", "automation", "psql"], "answers": [{"tags": [], "owner": {"reputation": 643, "user_id": 501294, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0581be4e17d12b4a81978d92f33e4524?s=128&d=identicon&r=PG", "display_name": "fishsticks", "link": "https://stackoverflow.com/users/501294/fishsticks"}, "is_accepted": true, "score": 3, "last_activity_date": 1438203703, "creation_date": 1438203703, "answer_id": 31711048, "question_id": 31710837, "link": "https://stackoverflow.com/questions/31710837/pythonic-way-to-print-out-column-conditions-in-database-psql/31711048#31711048", "title": "pythonic way to print out column conditions in database (psql)", "body": "<p>For a Postgres query, I think this does what you're looking for.</p>\n\n<pre><code>SELECT column_name FROM information_schema.columns WHERE table_name='some_table' AND data_type='varchar(2)';\n</code></pre>\n\n<p>This just selects all the <code>varchar(2)</code> columns in a specific table, but you can drop that part to get them throughout the entire database. You can also add in <code>table_schema='some_schema'</code> for just a certain schema in the database.</p>\n\n<p>As far as a pythonic or ruby way to do it, I don't know of one, other than running that query in psycopg or some other Postgres adapter.</p>\n\n<p>More info on <a href=\"http://www.postgresql.org/docs/current/static/infoschema-columns.html\" rel=\"nofollow\">information_schema.columns</a></p>\n"}], "owner": {"reputation": 6798, "user_id": 3282434, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/bd87b9229901acfa4c6f754da6bf3655?s=128&d=identicon&r=PG&f=1", "display_name": "codyc4321", "link": "https://stackoverflow.com/users/3282434/codyc4321"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 44, "favorite_count": 1, "accepted_answer_id": 31711048, "answer_count": 1, "score": 2, "last_activity_date": 1438203703, "creation_date": 1438202989, "question_id": 31710837, "link": "https://stackoverflow.com/questions/31710837/pythonic-way-to-print-out-column-conditions-in-database-psql", "title": "pythonic way to print out column conditions in database (psql)", "body": "<p>I have a nasty error with no direction when using factory boy to make fake models:</p>\n\n<p><code>DataError: value too long for type character varying(2)</code></p>\n\n<p>Is there a pythonic (or ruby) way to print out only the names of columns that are varchar(2) type in the database?  I'd assume it's in some pgadmin3 metadata? Thank you</p>\n"}, {"tags": ["ruby"], "answers": [{"comments": [{"owner": {"reputation": 1781, "user_id": 3277633, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/d4a27cdac076e1e488208b60677242e0?s=128&d=identicon&r=PG&f=1", "display_name": "user3277633", "link": "https://stackoverflow.com/users/3277633/user3277633"}, "edited": false, "score": 1, "creation_date": 1438203071, "post_id": 31710753, "comment_id": 51359721, "body": "thanks! this is exactly what I&#39;m looking for. I&#39;ll accept it as soon as SO lets me. By any chance, can you explain how the code might change if there is an an additional <code>pears_eaten</code> per person? I tried the following <code>totals[a.name][a.apples_eaten] += a.apples_eaten   totals[a.name][a.pears_eaten] += a.pears_eaten</code> but that does not seem to be correct"}, {"owner": {"reputation": 1667, "user_id": 359660, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/73a63c1f44ef127e609753975421ef7f?s=128&d=identicon&r=PG", "display_name": "LanceH", "link": "https://stackoverflow.com/users/359660/lanceh"}, "reply_to_user": {"reputation": 1781, "user_id": 3277633, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/d4a27cdac076e1e488208b60677242e0?s=128&d=identicon&r=PG&f=1", "display_name": "user3277633", "link": "https://stackoverflow.com/users/3277633/user3277633"}, "edited": false, "score": 0, "creation_date": 1438226720, "post_id": 31710753, "comment_id": 51366871, "body": "Make an apples_total hash and a pears_total hash, perhaps?  Then you&#39;d just sum them each on their own line with apple_totals[a.name] += a.apples_eaten then the next line pear_totals[a.name] += a.pears_eaten.   Or keep it in a hash of hashes with totals[&quot;pears&quot;][a.name] += a.pears_eaten."}], "tags": [], "owner": {"reputation": 1667, "user_id": 359660, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/73a63c1f44ef127e609753975421ef7f?s=128&d=identicon&r=PG", "display_name": "LanceH", "link": "https://stackoverflow.com/users/359660/lanceh"}, "is_accepted": true, "score": 1, "last_activity_date": 1438202707, "creation_date": 1438202707, "answer_id": 31710753, "question_id": 31710610, "link": "https://stackoverflow.com/questions/31710610/ruby-return-total-count-of-each-item-in-array/31710753#31710753", "title": "Ruby: return total count of each item in array", "body": "<p>Throw them all into a new hash that maps names => individual_total:</p>\n\n<pre><code>totals = Hash.new(0)\napple_array.each do |a|\n  totals[a.name] += a.apples_eaten\nend\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2100, "user_id": 216804, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/867f72b560a1d525767b48f15e7c9506?s=128&d=identicon&r=PG", "display_name": "bigsolom", "link": "https://stackoverflow.com/users/216804/bigsolom"}, "is_accepted": false, "score": 1, "last_activity_date": 1438203445, "creation_date": 1438203445, "answer_id": 31710976, "question_id": 31710610, "link": "https://stackoverflow.com/questions/31710610/ruby-return-total-count-of-each-item-in-array/31710976#31710976", "title": "Ruby: return total count of each item in array", "body": "<pre><code>apple_array.inject(Hash.new 0) { |sum, e| sum[e.name] += e.apples_eaten;sum }\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 167912, "user_id": 240443, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/495d675e3bc42ed1dee469e2ce701f1b?s=128&d=identicon&r=PG", "display_name": "Amadan", "link": "https://stackoverflow.com/users/240443/amadan"}, "is_accepted": false, "score": 0, "last_activity_date": 1438219349, "creation_date": 1438219349, "answer_id": 31713772, "question_id": 31710610, "link": "https://stackoverflow.com/questions/31710610/ruby-return-total-count-of-each-item-in-array/31713772#31713772", "title": "Ruby: return total count of each item in array", "body": "<p>With multiple attributes:</p>\n\n<pre><code># list the fruit\nattributes = %i(apples_eaten pears_eaten)\n# define the struct\nMeal = Struct.new(:name, *attributes)\n# create sample data\napple_array = [Meal.new(\"bob\", 1, 2), Meal.new(\"marge\", 5, 4), Meal.new(\"gomer\", 7, 1), Meal.new(\"bob\", 5, 0), Meal.new(\"gomer\", 3, 9)]\n\ntotals = apple_array.inject(\n  # start from a hash that defaults to empty stomach\n  Hash.new { |h, k| h[k] = Meal.new(k, 0, 0) }\n) { |r, e|\n  # then for each value in apple_array, add each attribute to the total\n  attributes.each do |a|\n    r[e.name][a] += e[a]\n  end\n  # mustn't forget to return the accumulator\n  r\n# hash was just for easy lookup, but we want an array, so...\n}.values\n\nrequire 'pp'\npp totals\n# =&gt; [#&lt;struct Meal name=\"bob\", apples_eaten=6, pears_eaten=2&gt;,\n#     #&lt;struct Meal name=\"marge\", apples_eaten=5, pears_eaten=4&gt;,\n#     #&lt;struct Meal name=\"gomer\", apples_eaten=10, pears_eaten=10&gt;]\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1268, "user_id": 5442, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1ca3a0180e953e56d528a3b5ddb3d6b3?s=128&d=identicon&r=PG", "display_name": "kranzky", "link": "https://stackoverflow.com/users/5442/kranzky"}, "is_accepted": false, "score": 0, "last_activity_date": 1438230576, "creation_date": 1438230576, "answer_id": 31715196, "question_id": 31710610, "link": "https://stackoverflow.com/questions/31710610/ruby-return-total-count-of-each-item-in-array/31715196#31715196", "title": "Ruby: return total count of each item in array", "body": "<p>Here's my solution. It sorts the array by <code>:name</code>, then partitions the array into sub-arrays where each item has the same <code>:name</code>, then reduces the sub-arrays to a single item which sums <code>:apples_eaten</code>. It should be obvious how to sum other attributes as well...</p>\n\n<pre><code>apple_array = apple_array\n  .sort_by { |a| a[:name] }\n  .slice_when { |a, b| a[:name] != b[:name] }\n  .map do |l|\n    l.reduce do |a, b|\n      a[:apples_eaten] += b[:apples_eaten]\n      a\n    end\n  end\n</code></pre>\n"}], "owner": {"reputation": 1781, "user_id": 3277633, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/d4a27cdac076e1e488208b60677242e0?s=128&d=identicon&r=PG&f=1", "display_name": "user3277633", "link": "https://stackoverflow.com/users/3277633/user3277633"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 268, "favorite_count": 0, "accepted_answer_id": 31710753, "answer_count": 4, "score": 2, "last_activity_date": 1438230576, "creation_date": 1438202243, "last_edit_date": 1438203491, "question_id": 31710610, "link": "https://stackoverflow.com/questions/31710610/ruby-return-total-count-of-each-item-in-array", "title": "Ruby: return total count of each item in array", "body": "<p>If I have an array  </p>\n\n<pre><code>apple_array = [\n  #&lt;name: \"Bob\", apples_eaten: 3&gt;,\n  #&lt;name: \"Robert\", apples_eaten: 7&gt;,\n  #&lt;name: \"Bob\", apples_eaten: 5&gt;,\n  #&lt;name: \"Rebecca\", apples_eaten: 2&gt;,\n  #&lt;name: \"Robert\", apples_eaten: 3&gt;\n]\n</code></pre>\n\n<p>how do I return something along the lines of the following, which goes through the array and calculates the total based on one of the attributes in the array?</p>\n\n<pre><code>name: Bob, apples_eaten: 8\nname: Robert, apples_eaten: 10\nname: Rebecca, apples_eaten: 2\n</code></pre>\n\n<p>Right now I know how to return the total amount of <code>apples_eaten</code> by calling <code>apple_array.inject(0) { |sum, e| sum + e.apples_eaten }</code>, Is there a way to map that line to each individual name?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "gem"], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 5170937, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sJUoy.jpg?s=128&g=1", "display_name": "Sailorxyz", "link": "https://stackoverflow.com/users/5170937/sailorxyz"}, "edited": false, "score": 0, "creation_date": 1438204279, "post_id": 31710558, "comment_id": 51360443, "body": "So, it&#39;s treated just as if it were a gem? I got confused because I kept seeing it referred to as a plugin and somehow thought plugins and gems were managed differently because they were packaged differently."}], "tags": [], "owner": {"reputation": 20590, "user_id": 504963, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/xlYLo.jpg?s=128&g=1", "display_name": "Antarr Byrd", "link": "https://stackoverflow.com/users/504963/antarr-byrd"}, "is_accepted": true, "score": 1, "last_activity_date": 1438202009, "last_edit_date": 1592644375, "creation_date": 1438202009, "answer_id": 31710558, "question_id": 31710476, "link": "https://stackoverflow.com/questions/31710476/how-to-install-gem-in-rails-4/31710558#31710558", "title": "How to install gem in rails 4?", "body": "<h3>Gemfile</h3>\n<pre><code>gem 'princely', '~&gt; 1.4.1'  \n</code></pre>\n<p>or if you prefer to point to github</p>\n<pre><code>gem 'princely', github: 'mbleigh/princely'\n</code></pre>\n<p>then run <code>bundle install</code></p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 5170988, "user_type": "registered", "profile_image": "https://graph.facebook.com/882606101777068/picture?type=large", "display_name": "Pratham Alag", "link": "https://stackoverflow.com/users/5170988/pratham-alag"}, "is_accepted": false, "score": 0, "last_activity_date": 1438205766, "creation_date": 1438205766, "answer_id": 31711596, "question_id": 31710476, "link": "https://stackoverflow.com/questions/31710476/how-to-install-gem-in-rails-4/31711596#31711596", "title": "How to install gem in rails 4?", "body": "<p>Go to into your gemfile, do what Antarr Byrd said. Basically put in those lines above or below and of the lines about gems already there. Running bundle install will result in a new Gemfile.lock, at which point it'll start working.</p>\n"}], "owner": {"reputation": 3, "user_id": 5170937, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sJUoy.jpg?s=128&g=1", "display_name": "Sailorxyz", "link": "https://stackoverflow.com/users/5170937/sailorxyz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 103, "favorite_count": 0, "accepted_answer_id": 31710558, "answer_count": 2, "score": 0, "last_activity_date": 1438205766, "creation_date": 1438201712, "last_edit_date": 1438202828, "question_id": 31710476, "link": "https://stackoverflow.com/questions/31710476/how-to-install-gem-in-rails-4", "title": "How to install gem in rails 4?", "body": "<p>How do you install plugins in Rails 4? Or more specifically, how do you install the Princely plugin for PrinceXML? I've spent a lot of time Googling but have not come up with anything. Everything seems to be for earlier versions of Rails. I get the impression that one would put in in the Gem file somehow? If someone could clarify this for me, I'd be most appreciative.</p>\n"}, {"tags": ["ruby", "struct", "liquid"], "comments": [{"owner": {"reputation": 5139, "user_id": 1735262, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fGuXb.png?s=128&g=1", "display_name": "Reinstate Monica -- notmaynard", "link": "https://stackoverflow.com/users/1735262/reinstate-monica-notmaynard"}, "edited": false, "score": 0, "creation_date": 1438201892, "post_id": 31710397, "comment_id": 51359064, "body": "What do you mean &quot;struct within a struct&quot;? Ruby doesn&#39;t exactly have structs."}, {"owner": {"reputation": 18773, "user_id": 91830, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2505b282d57c29be797dc35b245adb4c?s=128&d=identicon&r=PG", "display_name": "Philip Hallstrom", "link": "https://stackoverflow.com/users/91830/philip-hallstrom"}, "reply_to_user": {"reputation": 5139, "user_id": 1735262, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fGuXb.png?s=128&g=1", "display_name": "Reinstate Monica -- notmaynard", "link": "https://stackoverflow.com/users/1735262/reinstate-monica-notmaynard"}, "edited": false, "score": 0, "creation_date": 1438202221, "post_id": 31710397, "comment_id": 51359250, "body": "@iamnotmaynard Not sure this is what OP wants, but Ruby does have structs. <a href=\"http://ruby-doc.org/core-2.2.2/Struct.html\" rel=\"nofollow noreferrer\">ruby-doc.org/core-2.2.2/Struct.html</a>"}, {"owner": {"reputation": 5139, "user_id": 1735262, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fGuXb.png?s=128&g=1", "display_name": "Reinstate Monica -- notmaynard", "link": "https://stackoverflow.com/users/1735262/reinstate-monica-notmaynard"}, "edited": false, "score": 0, "creation_date": 1438202601, "post_id": 31710397, "comment_id": 51359485, "body": "Ah, I see. I had seen those before but forgotten. I was thinking about C-style structs."}, {"owner": {"reputation": 52685, "user_id": 980550, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/8emhY.jpg?s=128&g=1", "display_name": "lurker", "link": "https://stackoverflow.com/users/980550/lurker"}, "edited": false, "score": 0, "creation_date": 1438215443, "post_id": 31710397, "comment_id": 51364199, "body": "Based upon your naming I am left wondering: does each Category have potentially more than one <code>Field</code>? So are you looking for a list or collection of <code>Struct</code> within a <code>Struct</code>, not just a <code>Struct</code> within a <code>Struct</code>?"}], "answers": [{"comments": [{"owner": {"reputation": 52685, "user_id": 980550, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/8emhY.jpg?s=128&g=1", "display_name": "lurker", "link": "https://stackoverflow.com/users/980550/lurker"}, "reply_to_user": {"reputation": 109, "user_id": 962915, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/558a1355cd9f2584c80afdd92ec984d2?s=128&d=identicon&r=PG", "display_name": "user962915", "link": "https://stackoverflow.com/users/962915/user962915"}, "edited": false, "score": 0, "creation_date": 1438251920, "post_id": 31713196, "comment_id": 51378918, "body": "@user962915 you&#39;re very welcome. If you find my answer acceptable, if you could be so kind as to check the &quot;accept&quot; check mark to indicate your acceptance, I&#39;d appreciate it. Thank you."}], "tags": [], "owner": {"reputation": 52685, "user_id": 980550, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/8emhY.jpg?s=128&g=1", "display_name": "lurker", "link": "https://stackoverflow.com/users/980550/lurker"}, "is_accepted": false, "score": 1, "last_activity_date": 1438218722, "last_edit_date": 1438218722, "creation_date": 1438214727, "answer_id": 31713196, "question_id": 31710397, "link": "https://stackoverflow.com/questions/31710397/in-ruby-can-i-have-a-struct-within-a-struct/31713196#31713196", "title": "In Ruby, can I have a Struct within a Struct?", "body": "<p>By the naming, and description of your question, it sounds like you are wanting a collection or list of <code>Struct</code> within another <code>Struct</code>, not just a <code>Struct</code> within a <code>Struct</code>.</p>\n\n<p>Define a <code>Category</code> struct:</p>\n\n<pre><code>Struct.new('Category', :name, :description, :fields)\n =&gt; Struct::Category\n</code></pre>\n\n<p>Define a <code>Field</code> struct:</p>\n\n<pre><code>Struct.new('Field', :name, :description)\n =&gt; Struct::Field\n</code></pre>\n\n<p>When you create a <code>Category</code> instance, it can have an array for the <code>fields</code> member, which might originally be empty:</p>\n\n<pre><code>@category = Struct::Category.new('Foo', 'This is a foo', Array.new)\n=&gt; #&lt;struct Struct::Category name=\"Foo\", description=\"This is a foo\", fields=[]&gt;\n</code></pre>\n\n<p>Then add some fields to <code>@category</code>:</p>\n\n<pre><code>@category.fields &lt;&lt; [ 'Field 1', \"This is field 1\" ]\n@category.fields &lt;&lt; [ 'Field 2', 'This is field 2' ]\n...\n</code></pre>\n\n<p>Then your fields display method could look like:</p>\n\n<pre><code>def fields\n  @category.fields.each { |f| puts f.name + ' ' + f.description }\nend\n</code></pre>\n\n<p>Or whatever you wish to do with the fields.</p>\n"}], "owner": {"reputation": 109, "user_id": 962915, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/558a1355cd9f2584c80afdd92ec984d2?s=128&d=identicon&r=PG", "display_name": "user962915", "link": "https://stackoverflow.com/users/962915/user962915"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 560, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1438218722, "creation_date": 1438201421, "last_edit_date": 1438202429, "question_id": 31710397, "link": "https://stackoverflow.com/questions/31710397/in-ruby-can-i-have-a-struct-within-a-struct", "title": "In Ruby, can I have a Struct within a Struct?", "body": "<p>I want to code the following logical structure:</p>\n\n<blockquote>\n<pre><code>category\n  name\n  description\n  fields\n\nfield\n  name\n  description \n</code></pre>\n</blockquote>\n\n<p>I'm using liquid drops for this. So if I have:</p>\n\n<pre><code>class FieldDrop &lt; liquid::Drop\n  def initialize(field)\n    @field = field\n  end\n  def name\n    @field.name\n  end\n  def description\n    @field.description\n  end\nend\n</code></pre>\n\n<p>then how do I get the CategoryDrop class to reference the FieldDrop within its <code>def fields</code> method?</p>\n\n<p>My struct is:</p>\n\n<pre><code>Category = Struct.new(:name, :description, :fields)\n</code></pre>\n\n<p>based on the CategoryDrop where </p>\n\n<pre><code>def fields\n  @category.fields\nend\n</code></pre>\n\n<p>I want <code>def fields</code> to expand into @field.name + ' ' + @field.description for each field.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "sorting", "psql"], "answers": [{"tags": [], "owner": {"reputation": 377, "user_id": 1900969, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/681ea2e04dee304f1cfc6864ea470435?s=128&d=identicon&r=PG", "display_name": "Guido", "link": "https://stackoverflow.com/users/1900969/guido"}, "is_accepted": false, "score": 0, "last_activity_date": 1438201714, "creation_date": 1438201714, "answer_id": 31710479, "question_id": 31710327, "link": "https://stackoverflow.com/questions/31710327/sorting-posts-by-most-liked-over-the-past-24-hours-on-ruby-on-rails/31710479#31710479", "title": "Sorting posts by most liked over the past 24 hours on Ruby on Rails", "body": "<pre><code>class Post &lt; ActiveRecord::Base\n    acts_as_votable\n    default_scope { where(:created_at =&gt; ((Time.current - 24.hours)..Time.current)) }\n    default_scope { order(:cached_votes_up =&gt; :desc) }\nend\n</code></pre>\n\n<p>Something like that. You can have more than one default_scope and they are merged.</p>\n"}], "owner": {"reputation": 193, "user_id": 1837676, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/a295b35e68023c56f211bf5df921b8a7?s=128&d=identicon&r=PG", "display_name": "Steez", "link": "https://stackoverflow.com/users/1837676/steez"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 168, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1438201714, "creation_date": 1438201145, "question_id": 31710327, "link": "https://stackoverflow.com/questions/31710327/sorting-posts-by-most-liked-over-the-past-24-hours-on-ruby-on-rails", "title": "Sorting posts by most liked over the past 24 hours on Ruby on Rails", "body": "<p>Currently my app is using the <a href=\"https://github.com/ryanto/acts_as_votable\" rel=\"nofollow\">acts_as_votable</a> gem and the default_scope is set to order posts by most up votes. All votes are cached, as seen in the acts_as_votable documentation. However after time my content will get stale, so I would like to have user posts sorted by most votes over the past 24 hours, similar to reddit. </p>\n\n<pre><code>class Post &lt; ActiveRecord::Base\n    acts_as_votable\n    default_scope { order(:cached_votes_up =&gt; :desc) } \nend\n</code></pre>\n\n<p>Additionally here is the schema.rb for the votes table, which has a created at field.</p>\n\n<pre><code>create_table \"votes\", force: :cascade do |t|\n    t.integer  \"votable_id\"\n    t.string   \"votable_type\"\n    t.integer  \"voter_id\"\n    t.string   \"voter_type\"\n    t.boolean  \"vote_flag\"\n    t.string   \"vote_scope\"\n    t.integer  \"vote_weight\"\n    t.datetime \"created_at\"\n    t.datetime \"updated_at\"\n  end\n</code></pre>\n\n<p>Thanks in advance. Feel free to ask any questions.</p>\n"}, {"tags": ["ruby", "gsub"], "comments": [{"owner": {"reputation": 4965, "user_id": 270155, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/WHLFo.jpg?s=128&g=1", "display_name": "Andy Joiner", "link": "https://stackoverflow.com/users/270155/andy-joiner"}, "edited": false, "score": 0, "creation_date": 1438200547, "post_id": 31710098, "comment_id": 51358334, "body": "Try printing the before and after values before/instead of the rename.  Please update the question showing an example of the 2 prints."}, {"owner": {"reputation": 73, "user_id": 4470222, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/70c6d7653fbb0c4d356091ab4898f807?s=128&d=identicon&r=PG&f=1", "display_name": "odinsy", "link": "https://stackoverflow.com/users/4470222/odinsy"}, "reply_to_user": {"reputation": 4965, "user_id": 270155, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/WHLFo.jpg?s=128&g=1", "display_name": "Andy Joiner", "link": "https://stackoverflow.com/users/270155/andy-joiner"}, "edited": false, "score": 0, "creation_date": 1438201220, "post_id": 31710098, "comment_id": 51358737, "body": "With this example, I get the same name. This pattern doesn&#39;t work."}], "answers": [{"comments": [{"owner": {"reputation": 18773, "user_id": 91830, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2505b282d57c29be797dc35b245adb4c?s=128&d=identicon&r=PG", "display_name": "Philip Hallstrom", "link": "https://stackoverflow.com/users/91830/philip-hallstrom"}, "reply_to_user": {"reputation": 73, "user_id": 4470222, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/70c6d7653fbb0c4d356091ab4898f807?s=128&d=identicon&r=PG&f=1", "display_name": "odinsy", "link": "https://stackoverflow.com/users/4470222/odinsy"}, "edited": false, "score": 1, "creation_date": 1438202025, "post_id": 31710234, "comment_id": 51359136, "body": "Are you sure your file names are what you think they are? I just ran the above and it&#39;s working (updating my comment now)"}, {"owner": {"reputation": 73, "user_id": 4470222, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/70c6d7653fbb0c4d356091ab4898f807?s=128&d=identicon&r=PG&f=1", "display_name": "odinsy", "link": "https://stackoverflow.com/users/4470222/odinsy"}, "edited": false, "score": 0, "creation_date": 1438204686, "post_id": 31710234, "comment_id": 51360664, "body": "Yeah. Sorry. Names &quot;File1&quot;, &quot;File2&quot; are just a example. Actually files have a different names but with &quot;(vip)-smthing.mp4&quot; in the end of filename. I need to create pattern for gsub - find &quot;(vip)-smthing.mp4&quot; and replace it with &quot;.mp4&quot;. Thank you."}, {"owner": {"reputation": 18773, "user_id": 91830, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2505b282d57c29be797dc35b245adb4c?s=128&d=identicon&r=PG", "display_name": "Philip Hallstrom", "link": "https://stackoverflow.com/users/91830/philip-hallstrom"}, "reply_to_user": {"reputation": 73, "user_id": 4470222, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/70c6d7653fbb0c4d356091ab4898f807?s=128&d=identicon&r=PG&f=1", "display_name": "odinsy", "link": "https://stackoverflow.com/users/4470222/odinsy"}, "edited": false, "score": 1, "creation_date": 1438205041, "post_id": 31710234, "comment_id": 51360835, "body": "Oh, <code>if src =~ &#47;^(.*?)\\(vip\\)&#47;</code> ."}, {"owner": {"reputation": 73, "user_id": 4470222, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/70c6d7653fbb0c4d356091ab4898f807?s=128&d=identicon&r=PG&f=1", "display_name": "odinsy", "link": "https://stackoverflow.com/users/4470222/odinsy"}, "edited": false, "score": 0, "creation_date": 1438205488, "post_id": 31710234, "comment_id": 51361021, "body": "Yeah, it works.   <code>ruby rename.rb </code> <code>renaming &#39;File2 (vip)-bFfq1pH480l.mp4&#39; to &#39;File2 .mp4&#39;</code> <code>renaming &#39;File1 (vip)-dHsq8aF2P0U.mp4&#39; to &#39;File1 .mp4&#39;</code>  Good! But can u say me what i need to read for understand this?"}], "tags": [], "owner": {"reputation": 18773, "user_id": 91830, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2505b282d57c29be797dc35b245adb4c?s=128&d=identicon&r=PG", "display_name": "Philip Hallstrom", "link": "https://stackoverflow.com/users/91830/philip-hallstrom"}, "is_accepted": false, "score": 1, "last_activity_date": 1438202071, "last_edit_date": 1438202071, "creation_date": 1438200813, "answer_id": 31710234, "question_id": 31710098, "link": "https://stackoverflow.com/questions/31710098/how-to-write-pattern-for-rename-in-ruby/31710234#31710234", "title": "How to write pattern for rename in Ruby?", "body": "<pre><code>#!/usr/bin/env ruby\nrequire 'fileutils'\nlist = Dir.glob('*.mp4')\nlist.each do |src|\n  if src =~ /^(File\\d+)/\n    dst = \"#{$1}.mp4\"\n    puts \"renaming '#{src}' to '#{dst}'\"\n    File.rename(src, dst)\n  end\nend\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>$ ls\nFile1 (vip)-dHsq8aF2P0U.mp4 File2 (vip)-asdfsad.mp4     foo.rb\n\n$ ruby foo.rb\nrenaming 'File1 (vip)-dHsq8aF2P0U.mp4' to 'File1.mp4'\nrenaming 'File2 (vip)-asdfsad.mp4' to 'File2.mp4'\n\n$ ls\nFile1.mp4   File2.mp4   foo.rb\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 73, "user_id": 4470222, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/70c6d7653fbb0c4d356091ab4898f807?s=128&d=identicon&r=PG&f=1", "display_name": "odinsy", "link": "https://stackoverflow.com/users/4470222/odinsy"}, "is_accepted": true, "score": 0, "last_activity_date": 1438209757, "last_edit_date": 1438209757, "creation_date": 1438206965, "answer_id": 31711891, "question_id": 31710098, "link": "https://stackoverflow.com/questions/31710098/how-to-write-pattern-for-rename-in-ruby/31711891#31711891", "title": "How to write pattern for rename in Ruby?", "body": "<p>The answer is:</p>\n\n<pre><code>#!/usr/bin/env ruby\nrequire 'fileutils'\nlist = %x(ls -1 | grep .mp4).split(\",\")\nlist.each do |i|\n  puts i.gsub(/ \\(vip\\)-\\S+\\./, \".\")\nend\n</code></pre>\n\n<p>Thanks to Philip Hallstrom and <a href=\"http://rubular.com/\" rel=\"nofollow\">http://rubular.com/</a></p>\n"}], "owner": {"reputation": 73, "user_id": 4470222, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/70c6d7653fbb0c4d356091ab4898f807?s=128&d=identicon&r=PG&f=1", "display_name": "odinsy", "link": "https://stackoverflow.com/users/4470222/odinsy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 99, "favorite_count": 0, "accepted_answer_id": 31711891, "answer_count": 2, "score": 2, "last_activity_date": 1438209757, "creation_date": 1438200294, "last_edit_date": 1438206329, "question_id": 31710098, "link": "https://stackoverflow.com/questions/31710098/how-to-write-pattern-for-rename-in-ruby", "title": "How to write pattern for rename in Ruby?", "body": "<p>I have several files of this type:</p>\n\n<pre><code>File-1 (vip)-eojUBB_8V_4.mp4\nFile-2 (vip)-Ek2iyeeL1Vc.mp4\nFile-3 (vip)-Gh8F6OJa0gU.mp4\nFile-4 (vip)-SvL_aZt3zyU.mp4\n</code></pre>\n\n<p>and wanna rename file to:</p>\n\n<pre><code>File-1.mp4 \nFile-2.mp4\n</code></pre>\n\n<p>Names \"File1\" and \"File2\" are just a example. Actually files have a different names but with \"(vip)-smthing.mp4\" in the end of filename.</p>\n\n<p>I wrote the script:</p>\n\n<pre><code>#!/usr/bin/env ruby\nrequire 'fileutils'\nlist = %x(ls -1 | grep .mp4).split(\",\")\nlist.each do |i|\n  File.rename(i, i.gsub(/(vip)*.mp4/, \".mp4\"))\nend\n</code></pre>\n\n<p>but can't understand, what pattern I need to write inside gsub.</p>\n\n<p>Bash example work's fine, but i need to write it on Ruby.</p>\n\n<pre><code>ls -1 | sed 's/-[^-]\\+\\././'\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "architecture", "code-duplication"], "answers": [{"tags": [], "owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "is_accepted": false, "score": 1, "last_activity_date": 1438199478, "creation_date": 1438199478, "answer_id": 31709858, "question_id": 31709771, "link": "https://stackoverflow.com/questions/31709771/rails-how-to-avoid-duplication-between-different-applications/31709858#31709858", "title": "Rails - How to avoid duplication between different applications", "body": "<p>If you want to reuse code in multiple applications then I suggest to extract that code into a Gem and require that Gem in each application.</p>\n"}, {"comments": [{"owner": {"reputation": 6859, "user_id": 2643172, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/VMWUe.jpg?s=128&g=1", "display_name": "Mauricio Moraes", "link": "https://stackoverflow.com/users/2643172/mauricio-moraes"}, "edited": false, "score": 0, "creation_date": 1438199903, "post_id": 31709887, "comment_id": 51357958, "body": "Doesn&#39;t it slow down debugging? I mean, by looking for the problem, switching to the gem project, searching inside, changing, testing the other 2 apps after each change?"}, {"owner": {"reputation": 10621, "user_id": 312907, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/9decae0c588d499686dfbfe3b1072914?s=128&d=identicon&r=PG", "display_name": "Francesco Belladonna", "link": "https://stackoverflow.com/users/312907/francesco-belladonna"}, "reply_to_user": {"reputation": 6859, "user_id": 2643172, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/VMWUe.jpg?s=128&g=1", "display_name": "Mauricio Moraes", "link": "https://stackoverflow.com/users/2643172/mauricio-moraes"}, "edited": false, "score": 1, "creation_date": 1438200344, "post_id": 31709887, "comment_id": 51358210, "body": "First, you want to have tests in your gem, that for sure. But it doesn&#39;t slow down debugging: errors raised by the gem are displayed as <code>gemname&#47;file_in_gem:line_number</code> so you&#39;ll still find problems easily. Also, if you are following testing practices, you shouldn&#39;t test your gem in the other two applications, that&#39;s already tested in the gem itself. About switching projects, my editor support fast switching with ctrl+alt+p, so I never feel &quot;interrupted&quot;"}, {"owner": {"reputation": 6859, "user_id": 2643172, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/VMWUe.jpg?s=128&g=1", "display_name": "Mauricio Moraes", "link": "https://stackoverflow.com/users/2643172/mauricio-moraes"}, "edited": false, "score": 0, "creation_date": 1438201015, "post_id": 31709887, "comment_id": 51358617, "body": "I understand. Can you update your answer with those comments about testing? btw, the link you provided is good."}, {"owner": {"reputation": 10621, "user_id": 312907, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/9decae0c588d499686dfbfe3b1072914?s=128&d=identicon&r=PG", "display_name": "Francesco Belladonna", "link": "https://stackoverflow.com/users/312907/francesco-belladonna"}, "reply_to_user": {"reputation": 6859, "user_id": 2643172, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/VMWUe.jpg?s=128&g=1", "display_name": "Mauricio Moraes", "link": "https://stackoverflow.com/users/2643172/mauricio-moraes"}, "edited": false, "score": 0, "creation_date": 1438208469, "post_id": 31709887, "comment_id": 51362267, "body": "Done, added also a good article about a company that brought it to the maximum, splitting the entire app into sub engines: <a href=\"http://tech.taskrabbit.com/blog/2014/02/11/rails-4-engines/\" rel=\"nofollow noreferrer\">tech.taskrabbit.com/blog/2014/02/11/rails-4-engines</a> (very interesting article)"}], "tags": [], "owner": {"reputation": 10621, "user_id": 312907, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/9decae0c588d499686dfbfe3b1072914?s=128&d=identicon&r=PG", "display_name": "Francesco Belladonna", "link": "https://stackoverflow.com/users/312907/francesco-belladonna"}, "is_accepted": true, "score": 2, "last_activity_date": 1438208434, "last_edit_date": 1438208434, "creation_date": 1438199586, "answer_id": 31709887, "question_id": 31709771, "link": "https://stackoverflow.com/questions/31709771/rails-how-to-avoid-duplication-between-different-applications/31709887#31709887", "title": "Rails - How to avoid duplication between different applications", "body": "<p>That's simple, make your own gem. You can keep it closed (use <code>git: 'git location'</code>) or make it open and use rubygems.</p>\n\n<p>You can start with <code>bundle gem yourgem</code>, and this is a very good article on <a href=\"https://quickleft.com/blog/engineering-lunch-series-step-by-step-guide-to-building-your-first-ruby-gem/\" rel=\"nofollow\">how to build your first gem</a></p>\n\n<p>You manage this as a completely separate project. We are doing this in our company and it's working great</p>\n\n<h3>Update 1</h3>\n\n<p>As suggested, you want to have tests in your gem, for sure. It won't slow down debugging: errors raised by the gem are displayed as <code>gemname/file_in_gem:line_number</code> so you'll still detect problems easily. Also, if you are following good testing practices, you shouldn't test your gem in the other applications: the gem is already tested in its own codebase.</p>\n\n<p>You might want to check this article about <a href=\"http://tech.taskrabbit.com/blog/2014/02/11/rails-4-engines/\" rel=\"nofollow\">splitting a rails application</a> into a lot of sub-engines. Obviously this is an extreme approach which will provide good results only in very large projects and bigger teams, but it shows you that it's actually a good idea splitting a Rails application.</p>\n"}], "owner": {"reputation": 6859, "user_id": 2643172, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/VMWUe.jpg?s=128&g=1", "display_name": "Mauricio Moraes", "link": "https://stackoverflow.com/users/2643172/mauricio-moraes"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 53, "favorite_count": 3, "accepted_answer_id": 31709887, "answer_count": 2, "score": 1, "last_activity_date": 1438208434, "creation_date": 1438199158, "question_id": 31709771, "link": "https://stackoverflow.com/questions/31709771/rails-how-to-avoid-duplication-between-different-applications", "title": "Rails - How to avoid duplication between different applications", "body": "<p>This may seem quite a broad question, but I've searched around and didn't find ways to avoid duplication <strong>between different apps</strong>. Only inside an app.</p>\n\n<p>I'm working with three different rails applications for some time now. From time to time I find myself refactoring some file like my <code>icons_helper.rb</code>. When I finish. Its better than before but different from the same file in my other two rails apps.</p>\n\n<p>Other typical examples of duplicated code:</p>\n\n<ul>\n<li>Styles </li>\n<li>Layouts</li>\n<li>Messages (notices, alerts, ...) </li>\n<li>Etc.</li>\n</ul>\n\n<p>What should I do to avoid this inter-app duplication? Is writing a gem that wraps those files the best choice?</p>\n"}, {"tags": ["ruby", "bash", "stream", "tail"], "comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1438198258, "post_id": 31709369, "comment_id": 51357035, "body": "Generally you just keep attempting to read from a file handle and it will produce data as more is available."}, {"owner": {"reputation": 2159, "user_id": 4898937, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/iwgDT.jpg?s=128&g=1", "display_name": "ciaoben", "link": "https://stackoverflow.com/users/4898937/ciaoben"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1438198441, "post_id": 31709369, "comment_id": 51357121, "body": "@tadman how can I read only the new data everytime?"}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1438270949, "post_id": 31709369, "comment_id": 51392390, "body": "All file-handles have pointers to their current position within the file. This will be at the last spot you successfully read data unless you close it."}], "answers": [{"comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1438199540, "post_id": 31709630, "comment_id": 51357744, "body": "Not really necessary to fork out here, especially when this doesn&#39;t <code>shellescape</code> properly."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1438270845, "post_id": 31709630, "comment_id": 51392310, "body": "Spinning up the <code>tail</code> command in <code>-f</code> mode ls a really clunky way of doing this, Ruby can do the exact same thing using <code>File</code>. Secondly, if the path variable has a space in it, this command fails. You <i>need</i> to call <a href=\"http://ruby-doc.org/stdlib-2.0.0/libdoc/shellwords/rdoc/Shellwords.html#method-c-shellescape\" rel=\"nofollow noreferrer\"><code>shellescape</code></a> on any arguments to the shell supplied by the user."}], "tags": [], "owner": {"reputation": 5933, "user_id": 3501228, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/6ocDo.jpg?s=128&g=1", "display_name": "Noman Ur Rehman", "link": "https://stackoverflow.com/users/3501228/noman-ur-rehman"}, "is_accepted": false, "score": 0, "last_activity_date": 1438198679, "creation_date": 1438198679, "answer_id": 31709630, "question_id": 31709369, "link": "https://stackoverflow.com/questions/31709369/how-to-parse-and-work-on-real-time-output-in-ruby/31709630#31709630", "title": "How to parse and work on real time output in ruby?", "body": "<p>You can use the <a href=\"http://ruby-doc.org/stdlib-1.9.3/libdoc/pty/rdoc/PTY.html\" rel=\"nofollow\">pty</a> module.</p>\n\n<p>You will need to do something like this:</p>\n\n<pre><code>require 'pty'\n\ncmd = \"tail -f &lt;path-to-your-log-file&gt;\"\n\nbegin\n  PTY.spawn(cmd) do |stdout, stdin, pid|\n    begin\n      # print output to show how it works\n      # you will need to extract your info from \"line\" variable below\n      stdout.each { |line| print line }\n    rescue Errno::EIO\n      puts \"This means the process has finished giving output\"\n    end\n  end\nrescue PTY::ChildExited\n  puts \"Child process exited!\"\nend\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 91121, "user_id": 179125, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5594142dcc49a24b1902ec8059181f8d?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan Running", "link": "https://stackoverflow.com/users/179125/jordan-running"}, "is_accepted": false, "score": 1, "last_activity_date": 1438199029, "creation_date": 1438199029, "answer_id": 31709733, "question_id": 31709369, "link": "https://stackoverflow.com/questions/31709369/how-to-parse-and-work-on-real-time-output-in-ruby/31709733#31709733", "title": "How to parse and work on real time output in ruby?", "body": "<p>The easiest way (and most Unix-y way) is to use the <code>-n</code> or <code>-p</code> arguments to the <code>ruby</code> command. From the man page (<code>man ruby</code>):</p>\n\n\n\n<pre class=\"lang-none prettyprint-override\"><code>-n     Causes Ruby to assume the following loop around your script, which makes\n       it iterate over file name arguments somewhat like sed -n or awk.\n\n             while gets\n               ...\n             end\n</code></pre>\n\n<p>That's vague (and the \"file name arguments\" bit is misleading), so here's an example (let's call it <code>sum.rb</code>):</p>\n\n<pre class=\"lang-ruby prettyprint-override\"><code>BEGIN {\n  sum = 0\n}\n\nsum += $_.to_i\n\nEND {\n  puts \"Sum: #{sum}\"\n}\n</code></pre>\n\n<p>What will happen when we run this script with <code>ruby -n</code> is, the code in the <code>BEGIN</code> block will run once, then the code outside the block will run for every line of input piped to Ruby\u2014the line is stored in <code>$_</code>\u2014and then the code in the <code>END</code> block will run.</p>\n\n<p>Suppose we have a file with the following content (let's call it <code>data.txt</code>):</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>10\n15\n25\n50\n</code></pre>\n\n<p>Now we can do this:</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>$ cat data.txt | ruby -n sum.rb\nSum: 100\n</code></pre>\n\n<p>What if we only want to sum the first two numbers? Use <code>head</code>!</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>$ head -2 data.txt | ruby -n sum.rb\nSum: 25\n</code></pre>\n\n<p>What if we want to print every number, in addition to the sum? Use <code>-p</code> (for \"print\") instead of <code>-n</code>:</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>$ head -2 data.txt | ruby -p sum.rb\n10\n15\nSum: 25\n</code></pre>\n\n<p>The <code>ruby</code> command is very powerful. For example, the <code>-a</code> option will <strong>a</strong>utomatically split each line into an array and put it in <code>$F</code>, so if your input has two columns the first column of each line will be in <code>$F[0]</code>, the second in <code>$F[1]</code>, and so on. I highly recommend typing <code>man ruby</code> and taking a few minutes to see what options are available. Here's a good blog post that goes over some of the features: <a href=\"http://arjanvandergaag.nl/blog/using-ruby-command-line-options.html\" rel=\"nofollow\">http://arjanvandergaag.nl/blog/using-ruby-command-line-options.html</a></p>\n\n<p>One last thing: For ease of use, I recommend adding a shebang line to the top of your script, e.g.:</p>\n\n<pre class=\"lang-sh prettyprint-override\"><code>#!/usr/bin/env ruby -n\n</code></pre>\n\n<p>...and then using <code>chmod</code> to make your script executable (e.g. <code>chmod ug+x sum.rb</code>). This way your script can specify all of the arguments it needs and you can just do <code>cat data.txt | ./sum.rb</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1438270913, "post_id": 31709789, "comment_id": 51392358, "body": "It&#39;s pretty much this, but: <code>while true</code> can be <code>loop do</code> and comparing vs <code>nil</code> isn&#39;t necessary. Do <code>while (line = f.gets)</code>."}], "tags": [], "owner": {"reputation": 2356, "user_id": 1547872, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/x2Brf.jpg?s=128&g=1", "display_name": "dileep nandanam", "link": "https://stackoverflow.com/users/1547872/dileep-nandanam"}, "is_accepted": false, "score": 0, "last_activity_date": 1438199236, "creation_date": 1438199236, "answer_id": 31709789, "question_id": 31709369, "link": "https://stackoverflow.com/questions/31709369/how-to-parse-and-work-on-real-time-output-in-ruby/31709789#31709789", "title": "How to parse and work on real time output in ruby?", "body": "<pre><code>f=File.open(\"path_to_log_file\")\nno_of_lines_per_fetch = 1\nf.seek(0, no_of_lines_per_fetch)\n\ndef decision_making_function(data)\n  #your logic\n  puts \"processing #{data}\"\nend\n\nwhile true\n  if (line=f.gets) != nil\n    decision_making_function(line)\n  end\nend\n</code></pre>\n"}], "owner": {"reputation": 2159, "user_id": 4898937, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/iwgDT.jpg?s=128&g=1", "display_name": "ciaoben", "link": "https://stackoverflow.com/users/4898937/ciaoben"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 698, "favorite_count": 1, "answer_count": 3, "score": 0, "last_activity_date": 1438199236, "creation_date": 1438197834, "question_id": 31709369, "link": "https://stackoverflow.com/questions/31709369/how-to-parse-and-work-on-real-time-output-in-ruby", "title": "How to parse and work on real time output in ruby?", "body": "<p>I would like to do a simple thing in ruby: enter in a server , launch a <code>tailf -f</code> command on a log file, and perform some operation on the stream of output. (like extract some info)</p>\n\n<p>How can I do it in ruby?</p>\n\n<p>If a use the backtick to execute the command, the output it is never returned, is there a data structure to old this continuos output?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "rspec", "bcrypt-ruby"], "comments": [{"owner": {"reputation": 2376, "user_id": 3311657, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/9d1d7b5444ea5fbb3b5e0ecb8303a88e?s=128&d=identicon&r=PG", "display_name": "steve klein", "link": "https://stackoverflow.com/users/3311657/steve-klein"}, "edited": false, "score": 0, "creation_date": 1438198380, "post_id": 31709305, "comment_id": 51357094, "body": "Are you creating the same <code>:user</code> twice, once in the <code>let</code> and then subsequently in each test?  Perhaps you should build the user in the <code>let</code> since you are creating for each test."}, {"owner": {"reputation": 21, "user_id": 2139140, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c9dae373a16a1cac903e60b13f3fd99?s=128&d=identicon&r=PG", "display_name": "kevinjy", "link": "https://stackoverflow.com/users/2139140/kevinjy"}, "reply_to_user": {"reputation": 2376, "user_id": 3311657, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/9d1d7b5444ea5fbb3b5e0ecb8303a88e?s=128&d=identicon&r=PG", "display_name": "steve klein", "link": "https://stackoverflow.com/users/3311657/steve-klein"}, "edited": false, "score": 0, "creation_date": 1438198903, "post_id": 31709305, "comment_id": 51357386, "body": "The <code>:create</code> method in this case is trying to create a session, not a user. Also, I forgot to mention: I&#39;m using database_cleaner around each example, so the examples shouldn&#39;t be interacting with each other."}], "answers": [{"tags": [], "owner": {"reputation": 21, "user_id": 2139140, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c9dae373a16a1cac903e60b13f3fd99?s=128&d=identicon&r=PG", "display_name": "kevinjy", "link": "https://stackoverflow.com/users/2139140/kevinjy"}, "is_accepted": false, "score": 0, "last_activity_date": 1454102727, "creation_date": 1454102727, "answer_id": 35094316, "question_id": 31709305, "link": "https://stackoverflow.com/questions/31709305/simulating-a-login-attempt-with-incorrect-password-in-an-rspec-controller-spec-r/35094316#35094316", "title": "Simulating a login attempt with incorrect password in an RSpec controller spec raises BCrypt::Errors::InvalidHash", "body": "<p>Resetting the database fixed this problem, although it's still not clear to me what caused it or why it only happened under such specific circumstances.</p>\n"}], "owner": {"reputation": 21, "user_id": 2139140, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c9dae373a16a1cac903e60b13f3fd99?s=128&d=identicon&r=PG", "display_name": "kevinjy", "link": "https://stackoverflow.com/users/2139140/kevinjy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 442, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1454102727, "creation_date": 1438197610, "question_id": 31709305, "link": "https://stackoverflow.com/questions/31709305/simulating-a-login-attempt-with-incorrect-password-in-an-rspec-controller-spec-r", "title": "Simulating a login attempt with incorrect password in an RSpec controller spec raises BCrypt::Errors::InvalidHash", "body": "<p>The SessionController spec for an app I'm working on currently looks like this:</p>\n\n<pre><code>require 'rails_helper'\n\nRSpec.describe SessionController do\n  let(:user) { create(:user, phone_verified: true, email_verified: true) }\n\n  describe \"POST #create\" do\n    context \"with valid username and password\" do\n      before do\n        post :create, user: { username: user.username, password: user.password }\n      end\n      specify { expect(response).to redirect_to(dashboard_path) }\n      specify { expect(session[:user_id]).to eq(user.id) }\n    end\n\n    context \"with invalid username\" do\n      before do\n        post :create, user: { username: \"doesntexist\", password: user.password }\n      end\n      specify { expect(response).to render_template(\u201clogin\u201d) }\n      specify { expect(session[:user_id]).to be_nil }\n    end\n\n    context \"with invalid password\" do\n      before do\n        post :create, user: { username: user.username, password: \"badpassword\" }\n      end\n      specify { expect(response).to render_template(\u201clogin\u201d) }\n      specify { expect(session[:user_id]).to be_nil }\n    end\n  end\nend\n</code></pre>\n\n<p>The first two context blocks work exactly as expected. The examples in the third context block fail:</p>\n\n<pre><code>2) SessionController POST #create with invalid password\n     Failure/Error: post :create, user: { username: user.username, password: \"badpassword\" }\n     BCrypt::Errors::InvalidHash:\n       invalid hash\n</code></pre>\n\n<p>From what I've been able to find out on StackOverflow and by looking at the bcrypt-ruby source code, this means the password digest stored in the database is invalid. Since all three blocks are using the same <code>let</code> block to create the user, I'm at a loss as to why this would happen with an incorrect password and not a correct one. It also works normally when I start up <code>rails s</code> and try to log in through the view. Does anyone have any idea what is happening?</p>\n\n<p>We're using the built-in has_secure_password method, and we're not using devise or any other authentication-related gems.</p>\n"}, {"tags": ["ruby", "regex", "string"], "comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 1, "creation_date": 1438196542, "post_id": 31708775, "comment_id": 51356094, "body": "What&#39;s with <code>&quot;#{file.include? (&quot;_P2&quot;)}&quot; == &quot;true&quot;</code>? This isn&#39;t bash. Just do <code>file.include?(&quot;_P2&quot;)</code>. Likewise, all instances of <code>&quot;#{x}&quot;</code> can be replaced with <code>x</code>, there&#39;s no need for stringifying a string."}, {"owner": {"reputation": 89, "user_id": 1296969, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/yvy6v.jpg?s=128&g=1", "display_name": "bitmvr", "link": "https://stackoverflow.com/users/1296969/bitmvr"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1438697765, "post_id": 31708775, "comment_id": 51548771, "body": "It&#39;s called String Interpolation. It&#39;s more of less of a habit at this point. It isn&#39;t needed for that instance no, but if I were wanting to add to this string I <i>WOULD</i> need to do that or concatenate. I do not like doing   <code>var1 = bob puts var1 + &#39; is an engineer&#39; </code>.   That looks quite dirty to me when I can just use   <code>var1 = bob &quot;#{var1} is an engineer&quot; </code>  So by doing that often, I <b>usually</b> wrap my variables in that by habit and my readability."}, {"owner": {"reputation": 89, "user_id": 1296969, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/yvy6v.jpg?s=128&g=1", "display_name": "bitmvr", "link": "https://stackoverflow.com/users/1296969/bitmvr"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1438698239, "post_id": 31708775, "comment_id": 51549163, "body": "I do understand however there is some additional overhead and if the script is going to need to scale I would need to remove the additional and unnecessary processing of casting a string to a string. Thanks for keeping me straight ;)"}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1438793543, "post_id": 31708775, "comment_id": 51598478, "body": "Yes, that is one form of string interpolation, but it&#39;s pointless when you&#39;re not adding anything to the string. It&#39;s even borderline ridiculous when you&#39;re casting the results of a function call to a string and comparing that to a string when the return value is a boolean. If you&#39;re looking for readability, use the <i>minimal</i> representation. <code>x = y</code> is better than <code>x = &quot;#{y}&quot;</code> every time. Don&#39;t forget <code>&quot;%s is an engineer&quot; % var1</code> is also an option."}], "answers": [{"comments": [{"owner": {"reputation": 2560, "user_id": 5112122, "user_type": "registered", "profile_image": "https://graph.facebook.com/10206053108358704/picture?type=large", "display_name": "Horacio", "link": "https://stackoverflow.com/users/5112122/horacio"}, "edited": false, "score": 1, "creation_date": 1438196947, "post_id": 31709026, "comment_id": 51356331, "body": "This could work too  &quot;#{bob[0..-5]}_#{bob[-4..-1]}&quot; but it&#39;s dirty, wurde answer is the correct one."}], "tags": [], "owner": {"reputation": 2044, "user_id": 1107211, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/mte2a.jpg?s=128&g=1", "display_name": "wurde", "link": "https://stackoverflow.com/users/1107211/wurde"}, "is_accepted": false, "score": 3, "last_activity_date": 1438196593, "creation_date": 1438196593, "answer_id": 31709026, "question_id": 31708775, "link": "https://stackoverflow.com/questions/31708775/insert-into-string-and-preserve-original-variable-state/31709026#31709026", "title": "Insert into String and preserve original variable state", "body": "<pre><code>bob = \"ThisIsDefaultText\"\nputs bob.dup.insert(-5, '_')\n#=&gt; ThisIsDefault_Text\nputs bob\n#=&gt; ThisIsDefaultText\n</code></pre>\n\n<p>The the String parent Object has a duplicate method .dup that will \"produce a shallow copy\". </p>\n"}], "owner": {"reputation": 89, "user_id": 1296969, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/yvy6v.jpg?s=128&g=1", "display_name": "bitmvr", "link": "https://stackoverflow.com/users/1296969/bitmvr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 51, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1438208811, "creation_date": 1438195817, "last_edit_date": 1438208811, "question_id": 31708775, "link": "https://stackoverflow.com/questions/31708775/insert-into-string-and-preserve-original-variable-state", "title": "Insert into String and preserve original variable state", "body": "<p>I'm renaming files based on a text file of names produced from a database dump. I'm doing a directory listing and checking each if it contains an \"_P2.PSD\". If the file contains that sub-string I loop through 3 different places where an underscore could be and see if that string exists in a file. If I find a match based off of the contents of the file, I will rename the image with that format.</p>\n\n<p>Here is a portion of the code:</p>\n\n<pre><code>Dir.glob(\"#{directory}\").each do |file|\n  if \"#{file.include? (\"_P2\")}\" == \"true\"\n    if File.readlines(\"#{db_Dump}\").grep(/#{file.insert(-11, '_')}/).size &gt; 0\n      logger.info{\"#{file}\"}\n      #mod_file =   file.insert(-11, '_')\n      #logger.info{\"#{file} -&gt; #{mod_file}\"}\n    elsif File.readlines(\"#{db_Dump}\").grep(/#{file.insert(-10, '_')}/).size &gt; 0\n      logger.info{\"#{file}\"}\n      #mod_file =   file.insert(-10, '_')\n      #logger.info{\"#{file} -&gt; #{mod_file}\"}\n    elsif File.readlines(\"#{db_Dump}\").grep(/#{file.insert(-9, '_')}/).size &gt; 0\n      logger.info{\"#{file}\"}\n      #mod_file =   file.insert(-9, '_')\n      #logger.info{\"#{file} -&gt; #{mod_file}\"}\n    else\n      logger.info{\"NO_UNDERSCORE_PLACEMENT_FOUND -&gt; #{file}\"}\n    end\n  end\nend\n</code></pre>\n\n<p>The real issue:</p>\n\n<pre><code>irb(main):001:0&gt; bob=\"ThisIsDefaultText\"\n=&gt; \"ThisIsDefaultText\"\nirb(main):002:0&gt; puts bob.insert(-5,'_')\nThisIsDefault_Text\n=&gt; nil\nirb(main):003:0&gt; puts bob\nThisIsDefault_Text\n=&gt; nil\nirb(main):004:0&gt;\n</code></pre>\n"}, {"tags": ["ruby", "regex"], "comments": [{"owner": {"reputation": 13948, "user_id": 283342, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/e3ef6dbec3a443e7cda5b5624311ca08?s=128&d=identicon&r=PG&f=1", "display_name": "Adrian", "link": "https://stackoverflow.com/users/283342/adrian"}, "edited": false, "score": 0, "creation_date": 1438195754, "post_id": 31708684, "comment_id": 51355635, "body": "If it works in irb it should work in a file. Maybe try printing the value of <code>date</code> before using <code>gsub</code> to make sure that it is what you think it is?"}, {"owner": {"reputation": 73, "user_id": 3918722, "user_type": "registered", "accept_rate": 15, "profile_image": "https://www.gravatar.com/avatar/5a761faa2965b945f23400b8426bc1fd?s=128&d=identicon&r=PG&f=1", "display_name": "codecalypso", "link": "https://stackoverflow.com/users/3918722/codecalypso"}, "reply_to_user": {"reputation": 13948, "user_id": 283342, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/e3ef6dbec3a443e7cda5b5624311ca08?s=128&d=identicon&r=PG&f=1", "display_name": "Adrian", "link": "https://stackoverflow.com/users/283342/adrian"}, "edited": false, "score": 0, "creation_date": 1438195794, "post_id": 31708684, "comment_id": 51355661, "body": "Yeah I&#39;ve tried that using logger.info."}], "answers": [{"tags": [], "owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "is_accepted": false, "score": 6, "last_activity_date": 1438195839, "creation_date": 1438195839, "answer_id": 31708783, "question_id": 31708684, "link": "https://stackoverflow.com/questions/31708684/change-date-format-in-ruby/31708783#31708783", "title": "Change date format in ruby", "body": "<p>Just parse and rewrite:</p>\n\n<pre><code>require 'date'\n\nd = Date.strptime('29-07-2015', '%d-%m-%Y')\n\nd.strftime('%Y-%m-%d')\n# =&gt; \"2015-07-29\"\n</code></pre>\n\n<p>The <code>strptime</code> function and <code>strftime</code> function take the same formatting options, so they can undo what the other produces.</p>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4227915"}, "is_accepted": false, "score": 0, "last_activity_date": 1438195930, "creation_date": 1438195930, "answer_id": 31708811, "question_id": 31708684, "link": "https://stackoverflow.com/questions/31708684/change-date-format-in-ruby/31708811#31708811", "title": "Change date format in ruby", "body": "<p>With regex, something like that:</p>\n\n<pre><code>(\\d{2})-(\\d{2})-(\\d{4})\n</code></pre>\n\n<p><a href=\"https://regex101.com/r/bP3rY0/1\" rel=\"nofollow\">Regex live here.</a></p>\n"}, {"tags": [], "owner": {"reputation": 6119, "user_id": 165753, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/w6iBN.jpg?s=128&g=1", "display_name": "dimid", "link": "https://stackoverflow.com/users/165753/dimid"}, "is_accepted": false, "score": 0, "last_activity_date": 1438244862, "last_edit_date": 1438244862, "creation_date": 1438195934, "answer_id": 31708813, "question_id": 31708684, "link": "https://stackoverflow.com/questions/31708684/change-date-format-in-ruby/31708813#31708813", "title": "Change date format in ruby", "body": "<p>Without regex, but will solve your problem:</p>\n\n<p><code>\"29-07-2015\".split('-').reverse.join('-')</code></p>\n"}, {"tags": [], "owner": {"reputation": 1297, "user_id": 5042431, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8VZqF.jpg?s=128&g=1", "display_name": "Charles", "link": "https://stackoverflow.com/users/5042431/charles"}, "is_accepted": false, "score": 0, "last_activity_date": 1438196780, "creation_date": 1438196780, "answer_id": 31709085, "question_id": 31708684, "link": "https://stackoverflow.com/questions/31708684/change-date-format-in-ruby/31709085#31709085", "title": "Change date format in ruby", "body": "<p>All you need to do is <code>my_date.reverse!</code>. All you want is to flip that date, and it is a string. Strings can be reversed. </p>\n"}], "owner": {"reputation": 73, "user_id": 3918722, "user_type": "registered", "accept_rate": 15, "profile_image": "https://www.gravatar.com/avatar/5a761faa2965b945f23400b8426bc1fd?s=128&d=identicon&r=PG&f=1", "display_name": "codecalypso", "link": "https://stackoverflow.com/users/3918722/codecalypso"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 258, "favorite_count": 0, "answer_count": 4, "score": 0, "last_activity_date": 1438244862, "creation_date": 1438195517, "last_edit_date": 1438195646, "question_id": 31708684, "link": "https://stackoverflow.com/questions/31708684/change-date-format-in-ruby", "title": "Change date format in ruby", "body": "<pre><code>my date = \"29-07-2015\"\n</code></pre>\n\n<p>what I want: <code>\"2015-07-29\"</code></p>\n\n<p>This works in irb but not my ruby file:</p>\n\n<pre><code>date.gsub(/(\\d{2})-(\\d{2})-(\\d{4})/, '\\3-\\2-\\1') \n</code></pre>\n\n<p>Is there an alternative way to do this?</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "answers": [{"tags": [], "owner": {"reputation": 8503, "user_id": 1946861, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/2ObQs.jpg?s=128&g=1", "display_name": "jlhonora", "link": "https://stackoverflow.com/users/1946861/jlhonora"}, "is_accepted": true, "score": 4, "last_activity_date": 1438194316, "creation_date": 1438194316, "answer_id": 31708331, "question_id": 31708294, "link": "https://stackoverflow.com/questions/31708294/how-to-save-the-user-registration-date-rails/31708331#31708331", "title": "How to save the user registration date [rails]", "body": "<p><code>Time.now</code> should work. Also, if your model has <a href=\"http://edgeguides.rubyonrails.org/active_record_migrations.html\" rel=\"nofollow\">timestamps</a> you could use the <code>created_at</code> attribute.</p>\n\n<p>To convert a datetime to a date you can use <code>Time.now.to_date</code> or <code>created_at.to_date</code>. Depends on what you end up using.</p>\n"}, {"tags": [], "owner": {"reputation": 2033, "user_id": 174514, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ziJ7S.jpg?s=128&g=1", "display_name": "aks", "link": "https://stackoverflow.com/users/174514/aks"}, "is_accepted": false, "score": 1, "last_activity_date": 1438328125, "creation_date": 1438328125, "answer_id": 31740617, "question_id": 31708294, "link": "https://stackoverflow.com/questions/31708294/how-to-save-the-user-registration-date-rails/31740617#31740617", "title": "How to save the user registration date [rails]", "body": "<p>I highly recommend that you use <a href=\"https://github.com/plataformatec/devise\" rel=\"nofollow\"><code>devise</code></a>.  You'll get <code>created_at</code> and <code>updated_at</code> fields built-in to a <code>user</code> model, which will automatically track the user registration date and most recent change date, respectively.</p>\n\n<p>A single line in your <code>user</code> model will insert <code>devise</code>-based authentication and get you a lot of features with little or no programming effort on your part:</p>\n\n<pre><code>devise :database_authenticatable, :registerable, :confirmable, :recoverable\n</code></pre>\n"}], "owner": {"reputation": 599, "user_id": 4929753, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/7f4edccafe958081e3dda2c428095f05?s=128&d=identicon&r=PG&f=1", "display_name": "Pino ", "link": "https://stackoverflow.com/users/4929753/pino"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 72, "favorite_count": 1, "accepted_answer_id": 31708331, "answer_count": 2, "score": 1, "last_activity_date": 1438328125, "creation_date": 1438194164, "last_edit_date": 1438196950, "question_id": 31708294, "link": "https://stackoverflow.com/questions/31708294/how-to-save-the-user-registration-date-rails", "title": "How to save the user registration date [rails]", "body": "<p>When I save an user through a registration, I want to save the day in which this registration is made. I've tried using <code>Date.today</code>, but it doesn't work. </p>\n\n<p>What's the best solution?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "pdf"], "comments": [{"owner": {"reputation": 5250, "user_id": 5154683, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eae81933dce5ced9ec019414bbd4f0f4?s=128&d=identicon&r=PG&f=1", "display_name": "Robert Nubel", "link": "https://stackoverflow.com/users/5154683/robert-nubel"}, "edited": false, "score": 0, "creation_date": 1438194571, "post_id": 31708118, "comment_id": 51354907, "body": "You probably want to use <code>:document =&gt; file.read</code>, but it really depends on what <code>pdf_upload_request</code> does. Can you post the definition of that function?"}, {"owner": {"reputation": 71, "user_id": 4894086, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/3e2ec60a83a33c8911d19e1964694322?s=128&d=identicon&r=PG&f=1", "display_name": "William Sumfest", "link": "https://stackoverflow.com/users/4894086/william-sumfest"}, "reply_to_user": {"reputation": 5250, "user_id": 5154683, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eae81933dce5ced9ec019414bbd4f0f4?s=128&d=identicon&r=PG&f=1", "display_name": "Robert Nubel", "link": "https://stackoverflow.com/users/5154683/robert-nubel"}, "edited": false, "score": 0, "creation_date": 1438194811, "post_id": 31708118, "comment_id": 51355047, "body": "pdf_upload_request sends a post request to an api endpoint with params as the body of the request. The :document element of params must be a file, so I&#39;m not sure if file.read is the correct format for the request. I tried it and received a 400 error:  &quot;The submitted data was not a file. Check the encoding type on the form.&quot;"}], "answers": [{"comments": [{"owner": {"reputation": 71, "user_id": 4894086, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/3e2ec60a83a33c8911d19e1964694322?s=128&d=identicon&r=PG&f=1", "display_name": "William Sumfest", "link": "https://stackoverflow.com/users/4894086/william-sumfest"}, "edited": false, "score": 0, "creation_date": 1438195364, "post_id": 31708432, "comment_id": 51355395, "body": "I receive the following HTTP response: &lt;HTTParty::Response:0x7fd0ea924b78 parsed_response={&quot;document&quot;=&gt;[&quot;The submitted data was not a file. Check the encoding type on the form.&quot;]}, @response=#&lt;Net::HTTPBadRequest 400 BAD REQUEST readbody=true&gt;, @headers={&quot;server&quot;=&gt;[&quot;nginx/1.4.6 (Ubuntu)&quot;], &quot;date&quot;=&gt;[&quot;Wed, 29 Jul 2015 18:38:29 GMT&quot;], &quot;content-type&quot;=&gt;[&quot;application/json&quot;], &quot;transfer-encoding&quot;=&gt;[&quot;chunked&quot;], &quot;connection&quot;=&gt;[&quot;close&quot;], &quot;x-xss-protection&quot;=&gt;[&quot;1&quot;], &quot;x-content-options&quot;=&gt;[&quot;nosniff&quot;], &quot;strict-transport-security&quot;=&gt;[&quot;max-age=31536000 ; includeSubDomains&quot;],"}, {"owner": {"reputation": 1362, "user_id": 3236557, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/p6V9b.jpg?s=128&g=1", "display_name": "Kirill Zhukov", "link": "https://stackoverflow.com/users/3236557/kirill-zhukov"}, "reply_to_user": {"reputation": 71, "user_id": 4894086, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/3e2ec60a83a33c8911d19e1964694322?s=128&d=identicon&r=PG&f=1", "display_name": "William Sumfest", "link": "https://stackoverflow.com/users/4894086/william-sumfest"}, "edited": false, "score": 0, "creation_date": 1438196296, "post_id": 31708432, "comment_id": 51355941, "body": "@WilliamSumfest, that means, that you are not using API correctly."}, {"owner": {"reputation": 1362, "user_id": 3236557, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/p6V9b.jpg?s=128&g=1", "display_name": "Kirill Zhukov", "link": "https://stackoverflow.com/users/3236557/kirill-zhukov"}, "reply_to_user": {"reputation": 71, "user_id": 4894086, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/3e2ec60a83a33c8911d19e1964694322?s=128&d=identicon&r=PG&f=1", "display_name": "William Sumfest", "link": "https://stackoverflow.com/users/4894086/william-sumfest"}, "edited": false, "score": 0, "creation_date": 1438196428, "post_id": 31708432, "comment_id": 51356016, "body": "@WilliamSumfest, as answered previously you should use <code>httmultiparty</code> gem"}], "tags": [], "owner": {"reputation": 1362, "user_id": 3236557, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/p6V9b.jpg?s=128&g=1", "display_name": "Kirill Zhukov", "link": "https://stackoverflow.com/users/3236557/kirill-zhukov"}, "is_accepted": false, "score": 0, "last_activity_date": 1438194639, "creation_date": 1438194639, "answer_id": 31708432, "question_id": 31708118, "link": "https://stackoverflow.com/questions/31708118/opening-file-in-ruby-returning-empty-file/31708432#31708432", "title": "Opening File in Ruby returning empty file", "body": "<p>Try this:  </p>\n\n<pre><code>file = File.read(pdf_location)\nparams = {\n  # other irrelevant entries\n  document: file\n}\nheaders = {}\npdf_upload_request('post', params, headers)\n</code></pre>\n\n<p>Not sure but may be you need to close file first...</p>\n"}, {"comments": [{"owner": {"reputation": 71, "user_id": 4894086, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/3e2ec60a83a33c8911d19e1964694322?s=128&d=identicon&r=PG&f=1", "display_name": "William Sumfest", "link": "https://stackoverflow.com/users/4894086/william-sumfest"}, "edited": false, "score": 0, "creation_date": 1438196099, "post_id": 31708768, "comment_id": 51355835, "body": "I am using HTTMultiParty to handle the post request to the server. This is my post request =&gt; HTTMultiParty.post(url, :body =&gt; params, :headers =&gt; headers)"}, {"owner": {"reputation": 5250, "user_id": 5154683, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eae81933dce5ced9ec019414bbd4f0f4?s=128&d=identicon&r=PG&f=1", "display_name": "Robert Nubel", "link": "https://stackoverflow.com/users/5154683/robert-nubel"}, "reply_to_user": {"reputation": 71, "user_id": 4894086, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/3e2ec60a83a33c8911d19e1964694322?s=128&d=identicon&r=PG&f=1", "display_name": "William Sumfest", "link": "https://stackoverflow.com/users/4894086/william-sumfest"}, "edited": false, "score": 0, "creation_date": 1438196670, "post_id": 31708768, "comment_id": 51356176, "body": "Try following the example more closely and see if that helps. E.g., <code>HTTMultiParty.post(url, query: { document: File.new(pdf_location) })</code> -- the differences being &quot;query&quot; instead of &quot;body&quot;, and File.new instead of File.open."}], "tags": [], "owner": {"reputation": 5250, "user_id": 5154683, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eae81933dce5ced9ec019414bbd4f0f4?s=128&d=identicon&r=PG&f=1", "display_name": "Robert Nubel", "link": "https://stackoverflow.com/users/5154683/robert-nubel"}, "is_accepted": false, "score": 1, "last_activity_date": 1438195774, "creation_date": 1438195774, "answer_id": 31708768, "question_id": 31708118, "link": "https://stackoverflow.com/questions/31708118/opening-file-in-ruby-returning-empty-file/31708768#31708768", "title": "Opening File in Ruby returning empty file", "body": "<p>Most likely, the API is expecting a POST with <code>Content-Type: multipart/form-data</code>. Just sending the file handle (which <code>document: file</code> does) won't work, as the file handle is only relevant to your local Ruby process; and even sending the binary string as a parameter won't work, since your content-type isn't properly set to encode a file.</p>\n\n<p>Since you're already using HTTParty, though, you can fix this by using <a href=\"https://github.com/jwagener/httmultiparty\" rel=\"nofollow\">HTTMultiParty</a>:</p>\n\n<pre><code>require 'httmultiparty'\nclass SomeClient\n  include HTTMultiParty\n  base_uri 'http://localhost:3000'\nend\n\nSomeClient.post('/', :query =&gt; {\n  :foo      =&gt; 'bar',\n  :somefile =&gt; File.new('README.md')\n})\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 71, "user_id": 4894086, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/3e2ec60a83a33c8911d19e1964694322?s=128&d=identicon&r=PG&f=1", "display_name": "William Sumfest", "link": "https://stackoverflow.com/users/4894086/william-sumfest"}, "is_accepted": false, "score": 0, "last_activity_date": 1438206138, "creation_date": 1438206138, "answer_id": 31711690, "question_id": 31708118, "link": "https://stackoverflow.com/questions/31708118/opening-file-in-ruby-returning-empty-file/31711690#31711690", "title": "Opening File in Ruby returning empty file", "body": "<p>So the issue arose from the multi threading i used to avoid timeout errors. The file path would get generated and referenced in the api call before anything was actually written into the document.</p>\n"}], "owner": {"reputation": 71, "user_id": 4894086, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/3e2ec60a83a33c8911d19e1964694322?s=128&d=identicon&r=PG&f=1", "display_name": "William Sumfest", "link": "https://stackoverflow.com/users/4894086/william-sumfest"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 663, "favorite_count": 0, "answer_count": 3, "score": 2, "last_activity_date": 1438206138, "creation_date": 1438193613, "last_edit_date": 1438201642, "question_id": 31708118, "link": "https://stackoverflow.com/questions/31708118/opening-file-in-ruby-returning-empty-file", "title": "Opening File in Ruby returning empty file", "body": "<p>I am currently trying to store a pdf in a hash for an api call in ruby. The path to the pdf is stored as:</p>\n\n<pre><code>/Users/myUserName/Desktop/REPOSITORY/path_to_file.pdf\n</code></pre>\n\n<p>I am using a block to store the file in the hash as so:</p>\n\n<pre><code>File.open(pdf_location, \"rb\") do |file|\n        params = {\n          other irrelevant entries\n          :document =&gt; file\n        }\n        pdf_upload_request('post', params, headers)\nend\n</code></pre>\n\n<p>I am receiving a 400 error from the server that my document is empty and when I do <code>puts file.read</code>, it is empty. However, when I visit the filepath, it's clear that the file is not empty. Am I missing something here? Any help would be greatly appreciated. Thank you!</p>\n\n<p>Edit------</p>\n\n<p>I recorded my http request with vcr, here it is:</p>\n\n<pre><code>request:\n    method: post\n    uri: request_uri\n    body:\n      encoding: US-ASCII\n      string: ''\n    headers:\n      Authorization:\n      - Bearer 3ZOCPnwfoN7VfdGh7k4lrBuEYs4gN1\n      Content-Type:\n      - multipart/form-data; boundary=-----------RubyMultipartPost\n      Content-Length:\n      - '246659'\n</code></pre>\n\n<p>So i don't think the issue is with me sending the file with multipart encoding</p>\n\n<p>Update--------</p>\n\n<p>The filepaths to the pdf are generated from a url, and stored in a the tmp folder of my application. They are generated through this method:</p>\n\n<pre><code>def get_temporary_pdf(chrono_detail, recording, host)\n    auth_token = User.find(chrono_detail.user_id).authentication_token\n      # pdf_location = \"https://54.84.224.252/recording/5/analysis.pdf/?token=Ybp37kw7HrSt8NyyPnBZ\"\n    pdf_location = host + '/recordings/' + recording.id.to_s + '/analysis.pdf/?format=pdf&amp;download=true&amp;token=' + auth_token\n    filename = \"Will\" + '_' + recording.id.to_s + '_' + Date.new.to_s + '.pdf'\n    Thread.new do\n      File.open(Rails.root.join(\"tmp\",filename), \"wb\") do |file|\n        file.write(open(pdf_location, {ssl_verify_mode: OpenSSL::SSL::VERIFY_NONE}).read)\n      end\n    end\n    Rails.root.join(\"tmp\",filename)\n  end \n</code></pre>\n\n<p>They are then called using the api call:</p>\n\n<pre><code>client.upload_document(patient_id, file_path, description)\n</code></pre>\n\n<p>I can see them physically in my temp folder, and can view them with preview. Everything seems to work. But as a test of uncertainty, I changed file_path to point to a different pdf:</p>\n\n<pre><code>Users/myUsername/Desktop/example.pdf.\n</code></pre>\n\n<p>Using this file path worked. The pdf was uploaded to the third party system correctly, I can physically see it there. Do you think this means it is an issue with the tmp folder or how i generate the temporary pdf's?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "pdf-generation", "wkhtmltopdf"], "answers": [{"comments": [{"owner": {"reputation": 924, "user_id": 5156200, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/9532c8dc80ba03725a07b502ebef5af5?s=128&d=identicon&r=PG&f=1", "display_name": "Bruno E.", "link": "https://stackoverflow.com/users/5156200/bruno-e"}, "edited": false, "score": 2, "creation_date": 1438193758, "post_id": 31708057, "comment_id": 51354455, "body": "PDFKit.new takes all options wkhtmltopdf supports, see <a href=\"http://wkhtmltopdf.org/usage/wkhtmltopdf.txt\" rel=\"nofollow noreferrer\">wkhtmltopdf.org/usage/wkhtmltopdf.txt</a> for the complete list (search for footer)"}, {"owner": {"reputation": 882, "user_id": 1373218, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/2b48128905fc53707d4a21e4ce1e6e89?s=128&d=identicon&r=PG", "display_name": "Poyi", "link": "https://stackoverflow.com/users/1373218/poyi"}, "reply_to_user": {"reputation": 924, "user_id": 5156200, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/9532c8dc80ba03725a07b502ebef5af5?s=128&d=identicon&r=PG&f=1", "display_name": "Bruno E.", "link": "https://stackoverflow.com/users/5156200/bruno-e"}, "edited": false, "score": 0, "creation_date": 1438194030, "post_id": 31708057, "comment_id": 51354616, "body": "Thanks @BrunoE. that&#39;s what I was looking for."}], "tags": [], "owner": {"reputation": 882, "user_id": 1373218, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/2b48128905fc53707d4a21e4ce1e6e89?s=128&d=identicon&r=PG", "display_name": "Poyi", "link": "https://stackoverflow.com/users/1373218/poyi"}, "is_accepted": false, "score": 2, "last_activity_date": 1438193442, "creation_date": 1438193442, "answer_id": 31708057, "question_id": 31707815, "link": "https://stackoverflow.com/questions/31707815/how-to-create-fixed-footer-header-with-pdfkit-in-rails/31708057#31708057", "title": "How to create fixed footer/header with PDFKit in rails?", "body": "<p>I just dug into the gem more and saw the :header_center option. </p>\n\n<p>Looks like I'll be able to pass in value (probably a template as well) when creating the PDF like so.</p>\n\n<pre><code>kit = PDFKit.new(html, :header_center =&gt; \"foo\", :footer_center =&gt; \"bar\")\n</code></pre>\n"}], "owner": {"reputation": 882, "user_id": 1373218, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/2b48128905fc53707d4a21e4ce1e6e89?s=128&d=identicon&r=PG", "display_name": "Poyi", "link": "https://stackoverflow.com/users/1373218/poyi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3419, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1438193442, "creation_date": 1438192705, "question_id": 31707815, "link": "https://stackoverflow.com/questions/31707815/how-to-create-fixed-footer-header-with-pdfkit-in-rails", "title": "How to create fixed footer/header with PDFKit in rails?", "body": "<p>I'm using <a href=\"https://github.com/pdfkit/pdfkit\" rel=\"nofollow\">https://github.com/pdfkit/pdfkit</a> in rails to generate a PDF. </p>\n\n<pre><code>kit = PDFKit.new(html)\nkit.stylesheets &lt;&lt; 'app/assets/stylesheets/pdf.css'\nkit.to_pdf\n</code></pre>\n\n<p>The PDF renders properly based on the HTML. I'm just curious how to introduce a fixed footer/header. For instance, if I like to add a page number fixed at the bottom of the page along with a logo on every single page.</p>\n\n<p>Thanks in advance.</p>\n"}, {"tags": ["javascript", "ruby", "interpreter"], "comments": [{"owner": {"reputation": 2623, "user_id": 625354, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/xc5hf.jpg?s=128&g=1", "display_name": "Dbz", "link": "https://stackoverflow.com/users/625354/dbz"}, "edited": false, "score": 0, "creation_date": 1438193692, "post_id": 31707725, "comment_id": 51354401, "body": "Can you post any research you have done on the subject and more importantly what you have already attempted?"}], "answers": [{"tags": [], "owner": {"reputation": 13948, "user_id": 283342, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/e3ef6dbec3a443e7cda5b5624311ca08?s=128&d=identicon&r=PG&f=1", "display_name": "Adrian", "link": "https://stackoverflow.com/users/283342/adrian"}, "is_accepted": false, "score": 0, "last_activity_date": 1438193742, "creation_date": 1438193742, "answer_id": 31708165, "question_id": 31707725, "link": "https://stackoverflow.com/questions/31707725/embedding-a-ruby-interpreter-in-browser/31708165#31708165", "title": "embedding a ruby interpreter in browser", "body": "<p>If you want the code to be executed client-side, you could use <a href=\"http://kripken.github.io/emscripten-site/\" rel=\"nofollow\">emscripten</a>. This is what <a href=\"http://repl.it/languages/Ruby\" rel=\"nofollow\">repl.it</a> does.</p>\n\n<p>If you want the code to be executed server-side, you could use the Ideone API if you don't want to have to deal with security.</p>\n\n<p>Note: Stack Overflow won't let me post a link to the Ideone API, so here is the URL: <code>http colon slash slash ideone.com slash api</code></p>\n"}, {"comments": [{"owner": {"reputation": 25686, "user_id": 975097, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/dbbc1b2bc18739858cfa3b7ddcba7362?s=128&d=identicon&r=PG", "display_name": "Anderson Green", "link": "https://stackoverflow.com/users/975097/anderson-green"}, "edited": false, "score": 0, "creation_date": 1602948545, "post_id": 37120288, "comment_id": 113883607, "body": "Ruby has also been <a href=\"https://awesomeopensource.com/project/appcypher/awesome-wasm-langs#ruby\" rel=\"nofollow noreferrer\">ported to WebAssembly</a>, which is supported in most Web browsers nowadays."}], "tags": [], "owner": {"reputation": 213, "user_id": 2304511, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cf3c73ff695a758432f256d3cfd76472?s=128&d=identicon&r=PG", "display_name": "R. Peereboom", "link": "https://stackoverflow.com/users/2304511/r-peereboom"}, "is_accepted": false, "score": 1, "last_activity_date": 1543956347, "last_edit_date": 1543956347, "creation_date": 1462809461, "answer_id": 37120288, "question_id": 31707725, "link": "https://stackoverflow.com/questions/31707725/embedding-a-ruby-interpreter-in-browser/37120288#37120288", "title": "embedding a ruby interpreter in browser", "body": "<p>It's been a while since this question has been asked but in case people are still interested...</p>\n\n<blockquote>\n  <p>Opal was another thought, but that seems to only be server side. One option would be to send the string of ruby code to the server and execute it with eval, but that seems like a security nightmare.</p>\n</blockquote>\n\n<p>You can run Opal on the client side just fine!</p>\n\n<p><a href=\"https://opalrb.com/docs/guides/v0.9.2/opal_parser.html\" rel=\"nofollow noreferrer\">Add opal to your site and then use <code>Opal.compile()</code> and <code>Opal.eval()</code> to run ruby scripts.</a> What they've essentially done is to run the opal parser through the opal parser leading to a JS version of the parser. You can find a pre-compiled version of opal that includes the parser by dowloading opal-parser.min.js from the site. This should give you access to the <code>.compile()</code> and <code>.eval()</code> functions.</p>\n\n<p>Here is the simplest complete online ruby compiler I could come uo with. Note that <code>puts</code> prints to the console, so be sure to have something that returns a non-nil value as your last statement if you want to see any output.</p>\n\n<p></p>\n\n<h2>Index.html</h2>\n\n<pre><code>&lt;!doctype html&gt;\n&lt;html lang=\"en\"&gt;\n  &lt;head&gt;\n    &lt;meta charset=\"utf-8\"&gt;\n    &lt;title&gt;Compile ruby from your browser&lt;/title&gt;\n  &lt;/head&gt;\n  &lt;body&gt;\n    &lt;h1&gt;Input&lt;/h1&gt;\n    &lt;textarea id=\"input\" rows=\"5\" cols=\"50\"&gt;\nputs \"Hello, World!\"\n3 * 5\nputs \"blurb\"\n4**6\n    &lt;/textarea&gt;\n    &lt;button id=\"compile\" onclick=\"compile()\"&gt;Compile!&lt;/button&gt;\n\n    &lt;h1&gt;Transpiled&lt;/h1&gt;\n    &lt;textarea id=\"transpiled\" rows=\"5\" cols=\"50\"&gt;&lt;/textarea&gt;\n\n    &lt;h1&gt;Output&lt;/h1&gt;\n    &lt;textarea id=\"output\" rows=\"5\" cols=\"50\"&gt;&lt;/textarea&gt;\n\n    &lt;script src=\"js/opal.min.js\"&gt;&lt;/script&gt;\n    &lt;script src=\"js/opal-parser.min.js\"&gt;&lt;/script&gt;\n    &lt;script type=\"text/javascript\"&gt;Opal.load('opal-parser')&lt;/script&gt;\n    &lt;script src=\"js/scripts.js\"&gt;&lt;/script&gt;\n  &lt;/body&gt;\n&lt;/html&gt;\n</code></pre>\n\n<h2>script.js</h2>\n\n<pre><code>function compile() {\n  const input = document.getElementById(\"input\");\n  const transpiled = document.getElementById(\"transpiled\");\n  const output = document.getElementById(\"output\");\n\n  transpiled.value = Opal.compile(input.value);\n  output.value = eval(transpiled.value);\n}\n\ndocument.onload = function() { compile(); }\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 4894215, "user_type": "registered", "profile_image": "https://graph.facebook.com/2403402439608/picture?type=large", "display_name": "Eric Schwarzenbach", "link": "https://stackoverflow.com/users/4894215/eric-schwarzenbach"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 976, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1543956347, "creation_date": 1438192484, "question_id": 31707725, "link": "https://stackoverflow.com/questions/31707725/embedding-a-ruby-interpreter-in-browser", "title": "embedding a ruby interpreter in browser", "body": "<p>I have a rails app where I'm trying to allow users to interactively write ruby code, something akin to <a href=\"https://rubymonk.com/learning/books/1-ruby-primer/chapters/6-objects/lessons/35-introduction-to-objects\" rel=\"nofollow\">rubymonk</a>. The plan is to a have a textarea where they can write ruby code, with a button which will execute everything they've written. I can't for the life of me figure out how to do this.</p>\n\n<p>First I was looking at RubyJS, but that seems to just allow you to define ruby objects in javascript. It still requires you to be writing JS. \nOpal was another thought, but that seems to only be server side. \nOne option would be to send the string of ruby code to the server and execute it with <code>eval</code>, but that seems like a security nightmare.</p>\n\n<p>So this all brings me to my final question. Is there any JS library which will take a chunk of code written in ruby (as a string), and compile it into JS and execute it? Or if I've overlooked something, is there a simpler solution?</p>\n"}, {"tags": ["ruby", "ruby-on-rails-4", "paperclip"], "comments": [{"owner": {"reputation": 3210, "user_id": 5089231, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zX0dy.jpg?s=128&g=1", "display_name": "Athar", "link": "https://stackoverflow.com/users/5089231/athar"}, "edited": false, "score": 0, "creation_date": 1438192890, "post_id": 31707664, "comment_id": 51353908, "body": "what happens if you check <code>user.profile_image</code> after this <code>user.profile_image.destroy</code>"}, {"owner": {"reputation": 507, "user_id": 4029651, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Harunojikan", "link": "https://stackoverflow.com/users/4029651/harunojikan"}, "reply_to_user": {"reputation": 3210, "user_id": 5089231, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zX0dy.jpg?s=128&g=1", "display_name": "Athar", "link": "https://stackoverflow.com/users/5089231/athar"}, "edited": false, "score": 0, "creation_date": 1438193263, "post_id": 31707664, "comment_id": 51354147, "body": "the paperclip attachment is still there and other things like     <code>profile_image_file_name</code> and <code>profile_image_file_size</code> is still there and not nil"}, {"owner": {"reputation": 3210, "user_id": 5089231, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zX0dy.jpg?s=128&g=1", "display_name": "Athar", "link": "https://stackoverflow.com/users/5089231/athar"}, "edited": false, "score": 0, "creation_date": 1438193668, "post_id": 31707664, "comment_id": 51354386, "body": "dont you think that <code>user.profile_image.destroy</code> is not working correct.? as it is not deleting profile_image.?"}, {"owner": {"reputation": 507, "user_id": 4029651, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Harunojikan", "link": "https://stackoverflow.com/users/4029651/harunojikan"}, "reply_to_user": {"reputation": 3210, "user_id": 5089231, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zX0dy.jpg?s=128&g=1", "display_name": "Athar", "link": "https://stackoverflow.com/users/5089231/athar"}, "edited": false, "score": 0, "creation_date": 1438193781, "post_id": 31707664, "comment_id": 51354470, "body": "i just tried something else. upon <code>user.profile_image.destory</code> I also have to do <code>user.update(profile_image_file_name: nil, profile_image_content_type: nil, profile_image_file_size: nil, profile_image_updated_at: nil)</code> then when I call <code>user.profile_image.url</code>, it will give the me appropriate default_url I specified"}, {"owner": {"reputation": 2376, "user_id": 3311657, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/9d1d7b5444ea5fbb3b5e0ecb8303a88e?s=128&d=identicon&r=PG", "display_name": "steve klein", "link": "https://stackoverflow.com/users/3311657/steve-klein"}, "edited": false, "score": 2, "creation_date": 1438193871, "post_id": 31707664, "comment_id": 51354526, "body": "You need to save the object after destroy (<code>user.save</code>).  See <a href=\"http://stackoverflow.com/questions/5343937/delete-an-image-with-paperclip?answertab=active#tab-top\">this answer</a>."}, {"owner": {"reputation": 507, "user_id": 4029651, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Harunojikan", "link": "https://stackoverflow.com/users/4029651/harunojikan"}, "edited": false, "score": 0, "creation_date": 1438194000, "post_id": 31707664, "comment_id": 51354599, "body": "ah i see. thanks for helping. can you create the answer so i can mark it as answer for this question"}], "answers": [{"tags": [], "owner": {"reputation": 2376, "user_id": 3311657, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/9d1d7b5444ea5fbb3b5e0ecb8303a88e?s=128&d=identicon&r=PG", "display_name": "steve klein", "link": "https://stackoverflow.com/users/3311657/steve-klein"}, "is_accepted": true, "score": 2, "last_activity_date": 1438194417, "last_edit_date": 1495541642, "creation_date": 1438194417, "answer_id": 31708362, "question_id": 31707664, "link": "https://stackoverflow.com/questions/31707664/rails-paperclip-destroy-clear-removes-the-file-from-s3-but-url-is-still-di/31708362#31708362", "title": "rails paperclip .destroy &amp; .clear removes the file from s3, but .url is still directing to s3 instead of default_url", "body": "<p>After destroying the image, you need to save the object:</p>\n\n<pre><code>user = User.first\nuser.profile_image.destroy\n\n# saving changes to instance\nuser.save\n</code></pre>\n\n<p>Credit to <a href=\"https://stackoverflow.com/questions/5343937/delete-an-image-with-paperclip?answertab=active#tab-top\">this SO answer</a>.</p>\n"}], "owner": {"reputation": 507, "user_id": 4029651, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Harunojikan", "link": "https://stackoverflow.com/users/4029651/harunojikan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 652, "favorite_count": 0, "accepted_answer_id": 31708362, "answer_count": 1, "score": 1, "last_activity_date": 1438194417, "creation_date": 1438192263, "question_id": 31707664, "link": "https://stackoverflow.com/questions/31707664/rails-paperclip-destroy-clear-removes-the-file-from-s3-but-url-is-still-di", "title": "rails paperclip .destroy &amp; .clear removes the file from s3, but .url is still directing to s3 instead of default_url", "body": "<p>I have this problem where I want to delete the file from s3 and have the system returns me the default url. However upon trying the code below and successfully deleting the files in s3, the url I get still points to s3.</p>\n\n<p>I did the following code</p>\n\n<pre><code>user = User.first\nuser.profile_image.destroy\n# i also tried\n# user.profile_image.clear\n\nrender json: {profile_image: user.profile_image.url}\n# the url that paperclip gives me is still points to the s3 server instead of my default picture link\n</code></pre>\n"}, {"tags": ["ruby", "rails-console"], "comments": [{"owner": {"reputation": 13948, "user_id": 283342, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/e3ef6dbec3a443e7cda5b5624311ca08?s=128&d=identicon&r=PG&f=1", "display_name": "Adrian", "link": "https://stackoverflow.com/users/283342/adrian"}, "edited": false, "score": 1, "creation_date": 1438191806, "post_id": 31707468, "comment_id": 51353259, "body": "No, not unless you write code to parse it yourself, which is probably a bad idea."}], "answers": [{"comments": [{"owner": {"reputation": 1877, "user_id": 965613, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/UiRBe.png?s=128&g=1", "display_name": "planarian", "link": "https://stackoverflow.com/users/965613/planarian"}, "edited": false, "score": 0, "creation_date": 1438196622, "post_id": 31708444, "comment_id": 51356140, "body": "Is that really all there is to it? I thought those other fields might be important."}, {"owner": {"reputation": 924, "user_id": 5156200, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/9532c8dc80ba03725a07b502ebef5af5?s=128&d=identicon&r=PG&f=1", "display_name": "Bruno E.", "link": "https://stackoverflow.com/users/5156200/bruno-e"}, "reply_to_user": {"reputation": 1877, "user_id": 965613, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/UiRBe.png?s=128&g=1", "display_name": "planarian", "link": "https://stackoverflow.com/users/965613/planarian"}, "edited": false, "score": 1, "creation_date": 1438197085, "post_id": 31708444, "comment_id": 51356415, "body": "Yes, have a look at <a href=\"http://ruby-doc.org/stdlib-2.2.2/libdoc/bigdecimal/rdoc/BigDecimal.html#method-i-inspect\" rel=\"nofollow noreferrer\">ruby-doc.org/stdlib-2.2.2/libdoc/bigdecimal/rdoc/&hellip;</a> to see a more detailed explanation of what you get."}], "tags": [], "owner": {"reputation": 924, "user_id": 5156200, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/9532c8dc80ba03725a07b502ebef5af5?s=128&d=identicon&r=PG&f=1", "display_name": "Bruno E.", "link": "https://stackoverflow.com/users/5156200/bruno-e"}, "is_accepted": false, "score": 2, "last_activity_date": 1438194673, "creation_date": 1438194673, "answer_id": 31708444, "question_id": 31707468, "link": "https://stackoverflow.com/questions/31707468/reconstituting-an-object-from-console-output/31708444#31708444", "title": "reconstituting an object from console output", "body": "<p>Manually you can just call <code>BigDecimal.new('0.1E3').to_s</code> in a rails console and get the number: <code>=&gt; \"100.0\"</code>.</p>\n\n<p>In that example the E notation is really simple, you just have to move the . by the number after E positions. If it's > 0 move it to the right, if it's smaller &lt; 0 move it to the left. See <a href=\"https://en.wikipedia.org/wiki/Scientific_notation#E_notation\" rel=\"nofollow\">https://en.wikipedia.org/wiki/Scientific_notation#E_notation</a> for a more detailed explanation.</p>\n\n<p><code>0.1E3 == 1.0E2 == 10.0E1 == 100.0E0 == 100.0</code></p>\n"}], "owner": {"reputation": 1877, "user_id": 965613, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/UiRBe.png?s=128&g=1", "display_name": "planarian", "link": "https://stackoverflow.com/users/965613/planarian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 150, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1438194673, "creation_date": 1438191682, "last_edit_date": 1438192315, "question_id": 31707468, "link": "https://stackoverflow.com/questions/31707468/reconstituting-an-object-from-console-output", "title": "reconstituting an object from console output", "body": "<p>Is there a way to convert console output like <code>\"#&lt;BigDecimal:6999660,'0.1E3',9(36)&gt;\"</code> back into the original object? The integer form of this number is 100, but I have no way of knowing that when I see it returned by RSpec (for example).</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "web", "sti"], "comments": [{"owner": {"reputation": 3614, "user_id": 1569930, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/7bc43a689388dd4697947ffe8f4c9dcd?s=128&d=identicon&r=PG", "display_name": "eirikir", "link": "https://stackoverflow.com/users/1569930/eirikir"}, "edited": false, "score": 0, "creation_date": 1438191960, "post_id": 31707405, "comment_id": 51353347, "body": "What is STI? Did you create a migration to create a <code>parents</code> table, or did you just edit <code>schema.rb</code>?"}, {"owner": {"reputation": 755, "user_id": 1974787, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/f8bfd50de2a896e92a3f34f4750ff739?s=128&d=identicon&r=PG", "display_name": "Burak &#214;zmen", "link": "https://stackoverflow.com/users/1974787/burak-%c3%96zmen"}, "reply_to_user": {"reputation": 3614, "user_id": 1569930, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/7bc43a689388dd4697947ffe8f4c9dcd?s=128&d=identicon&r=PG", "display_name": "eirikir", "link": "https://stackoverflow.com/users/1569930/eirikir"}, "edited": false, "score": 0, "creation_date": 1438199584, "post_id": 31707405, "comment_id": 51357771, "body": "@eirikir I&#39;ve properly created all models, and gave a <b>type</b> column to specify its type. STI is Single Table Inheritance."}], "answers": [{"comments": [{"owner": {"reputation": 755, "user_id": 1974787, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/f8bfd50de2a896e92a3f34f4750ff739?s=128&d=identicon&r=PG", "display_name": "Burak &#214;zmen", "link": "https://stackoverflow.com/users/1974787/burak-%c3%96zmen"}, "edited": false, "score": 0, "creation_date": 1438200614, "post_id": 31707592, "comment_id": 51358385, "body": "I&#39;ve properly created my models. My User model has a type column that specifies the type: Patient, Doctor and Admin. However, I can not access the columns of Patient model."}, {"owner": {"reputation": 1827, "user_id": 1362329, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QRckP.jpg?s=128&g=1", "display_name": "neydroid", "link": "https://stackoverflow.com/users/1362329/neydroid"}, "reply_to_user": {"reputation": 755, "user_id": 1974787, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/f8bfd50de2a896e92a3f34f4750ff739?s=128&d=identicon&r=PG", "display_name": "Burak &#214;zmen", "link": "https://stackoverflow.com/users/1974787/burak-%c3%96zmen"}, "edited": false, "score": 0, "creation_date": 1438317247, "post_id": 31707592, "comment_id": 51410927, "body": "I&#39;ll expand my answer, you need to create fathername field in Users table, STI uses the same table for all the models."}], "tags": [], "owner": {"reputation": 1827, "user_id": 1362329, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QRckP.jpg?s=128&g=1", "display_name": "neydroid", "link": "https://stackoverflow.com/users/1362329/neydroid"}, "is_accepted": false, "score": 1, "last_activity_date": 1438192013, "creation_date": 1438192013, "answer_id": 31707592, "question_id": 31707405, "link": "https://stackoverflow.com/questions/31707405/undefined-method-when-accessing-attributes-of-a-model-sti/31707592#31707592", "title": "undefined method when accessing attributes of a model (STI)", "body": "<p>You should add fathername field to the model User, because this is the one that inherits from ActiveRecord::Base</p>\n\n<p>STI works with only one table (in this case Users) and adds a field named \"type\" that saves the name of the Model that is saving the record, it saves \"Patient\" for patients records, \"Doctor\" for doctors records, etc. all in the same table Users.</p>\n\n<p><a href=\"http://api.rubyonrails.org/classes/ActiveRecord/Inheritance.html\" rel=\"nofollow\">http://api.rubyonrails.org/classes/ActiveRecord/Inheritance.html</a></p>\n\n<p>I hope this helps.</p>\n"}], "owner": {"reputation": 755, "user_id": 1974787, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/f8bfd50de2a896e92a3f34f4750ff739?s=128&d=identicon&r=PG", "display_name": "Burak &#214;zmen", "link": "https://stackoverflow.com/users/1974787/burak-%c3%96zmen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 778, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1438192013, "creation_date": 1438191486, "question_id": 31707405, "link": "https://stackoverflow.com/questions/31707405/undefined-method-when-accessing-attributes-of-a-model-sti", "title": "undefined method when accessing attributes of a model (STI)", "body": "<p>I have 4 models: <code>Patient</code>, <code>Admin</code>, <code>Doctor</code>, <code>User</code>. <code>Patient</code>, <code>Admin</code> and <code>Doctor</code> extends <code>User</code>.</p>\n\n<pre><code>// patient.rb\nclass Patient &lt; User\nend\n\n// doctor.rb\nclass Doctor &lt; User\nend\n\n// admin.rb\nclass Admin &lt; User\nend\n</code></pre>\n\n<p>However, I cannot get child-class-specific attributes. When I call, for example <code>patient.fathername</code>, it gives me the error </p>\n\n<p><strong>NoMethodError: undefined method `fathername' for #Patient:0x007fa4c172a188</strong></p>\n\n<p>while I have <code>fathername</code> column in my <code>Patient</code> model.</p>\n\n<pre><code>//schema.rb\ncreate_table \"patients\", force: :cascade do |t|\nt.string   \"fathername\"\nend\n</code></pre>\n\n<p>Made some research about the problem, and realized that other people who use STI also encountered with this problem. However, I could not understand any of the solutions and source of the problem. What is wrong with STI and getting attributes?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "elasticsearch", "lucene", "nosql"], "comments": [{"owner": {"reputation": 4388, "user_id": 1177441, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/6903fda46d4ae632ad26fb1470dfdd84?s=128&d=identicon&r=PG", "display_name": "Jibi Abraham", "link": "https://stackoverflow.com/users/1177441/jibi-abraham"}, "edited": false, "score": 0, "creation_date": 1438234699, "post_id": 31707298, "comment_id": 51369170, "body": "A suggestion, it would help tremendously if you stated in words what your query/aggregation is supposed to be doing instead of making the reader deduce it from your code samples"}, {"owner": {"reputation": 1751, "user_id": 1212336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4002e9409f235e93386772dbe71c1500?s=128&d=identicon&r=PG", "display_name": "adamliesko", "link": "https://stackoverflow.com/users/1212336/adamliesko"}, "reply_to_user": {"reputation": 4388, "user_id": 1177441, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/6903fda46d4ae632ad26fb1470dfdd84?s=128&d=identicon&r=PG", "display_name": "Jibi Abraham", "link": "https://stackoverflow.com/users/1177441/jibi-abraham"}, "edited": false, "score": 0, "creation_date": 1438236548, "post_id": 31707298, "comment_id": 51369927, "body": "What I need is to filter document with certain conditions, filter them also by nested document condition. I do not need any ranking or scoring/sorting. I just need the aggregation of such a query under the crawl_page_id."}], "answers": [{"tags": [], "owner": {"reputation": 1751, "user_id": 1212336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4002e9409f235e93386772dbe71c1500?s=128&d=identicon&r=PG", "display_name": "adamliesko", "link": "https://stackoverflow.com/users/1212336/adamliesko"}, "is_accepted": true, "score": 0, "last_activity_date": 1438418418, "last_edit_date": 1438418418, "creation_date": 1438192449, "answer_id": 31707716, "question_id": 31707298, "link": "https://stackoverflow.com/questions/31707298/elasticsearch-nested-query-aggregations/31707716#31707716", "title": "Elasticsearch nested query aggregations", "body": "<p>Nevermind, you probably can't get any better than this.</p>\n\n<pre><code> {\"query\"=&gt;\n          {\"filtered\"=&gt;\n            {\"query\"=&gt;{{\"match_all\"=&gt;{}},\n             \"filter\"=&gt;{\n               \"bool\"=&gt;{\n                 \"must\"=&gt;[\n                    {\"term\"=&gt;{\"domain_id\"=&gt;7721}}, \n                    {\"range\"=&gt;{\"goals\"=&gt;{\"gte\"=&gt;0}}}\n                    \"nested\"=&gt;{\"path\"=&gt;\"by_traffic_source\", \n                        \"filter\"=&gt;{\n                          {\"term\"=&gt;{\"by_traffic_source.source\"=&gt;\"organic\"}}\n                        }\n                      }\n                    }\n                  ]},\n\n               }\n              }\n            },\n         \"aggs\"=&gt;{\"crawl_pages\"=&gt;{\"terms\"=&gt;{\"field\"=&gt;\"crawl_page_id\", \"size\"=&gt;200}}}}\n</code></pre>\n"}], "owner": {"reputation": 1751, "user_id": 1212336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4002e9409f235e93386772dbe71c1500?s=128&d=identicon&r=PG", "display_name": "adamliesko", "link": "https://stackoverflow.com/users/1212336/adamliesko"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 455, "favorite_count": 1, "accepted_answer_id": 31707716, "answer_count": 1, "score": 1, "last_activity_date": 1505439518, "creation_date": 1438191071, "last_edit_date": 1506103282, "question_id": 31707298, "link": "https://stackoverflow.com/questions/31707298/elasticsearch-nested-query-aggregations", "title": "Elasticsearch nested query aggregations", "body": "<p>Now that I got it right, could you advise me about improving the performance?</p>\n\n<p>I am trying to implement an aggregator filter in my Ruby on Rails app (which does not matter much). I am querying the elasticsearch with following conditions.</p>\n\n<p>What I need is to filter document with certain conditions, filter them also by nested document condition. I do not need any ranking or scoring/sorting. I just need the aggregation of such a query under the <code>crawl_page_id</code>. </p>\n\n<p>Any help is really appreciated.</p>\n\n<p><strong>here is the mapping of the index:</strong></p>\n\n<pre><code>{:created_at=&gt;{:type=&gt;\"date\"}, \n :updated_at=&gt;{:type=&gt;\"date\"}, \n :domain_id=&gt;{:type=&gt;\"integer\"}, \n :users=&gt;{:type=&gt;\"integer\"}, \n :new_users=&gt;{:type=&gt;\"integer\"}, \n :sessions=&gt;{:type=&gt;\"integer\"}, \n :pageviews=&gt;{:type=&gt;\"integer\"}, \n :session_duration=&gt;{:type=&gt;\"integer\"}, \n :bounces=&gt;{:type=&gt;\"integer\"}, \n :exits=&gt;{:type=&gt;\"integer\"}, \n :conversion_rate=&gt;{:type=&gt;\"integer\"}, \n :goals=&gt;{:type=&gt;\"integer\"}, \n :assists=&gt;{:type=&gt;\"integer\"}, \n :unique_referrers=&gt;{:type=&gt;\"integer\"}, \n :by_traffic_source=&gt;{:type=&gt;\"nested\", \n   :properties=&gt;{\n      :source=&gt;{:type=&gt;\"string\", :index=&gt;:not_analyzed}, \n      :goals=&gt;{:type=&gt;\"integer\"}, \n      :pageviews=&gt;{:type=&gt;\"integer\"}, \n      :assists=&gt;{:type=&gt;\"integer\"}}}, \n  :by_goals=&gt;{:type=&gt;\"nested\", \n    :properties=&gt;{\n      :id=&gt;{:type=&gt;\"integer\"}, \n      :goals=&gt;{:type=&gt;\"integer\"}, \n      :assists=&gt;{:type=&gt;\"integer\"}}}, \n  :url=&gt;{:type=&gt;\"string\"}, \n  :timestamp=&gt;{:type=&gt;\"date\"}, \n  :rdn_url=&gt;{:type=&gt;\"string\"}, \n  :scheme=&gt;{:type=&gt;\"string\"}, \n  :host=&gt;{:type=&gt;\"string\"}, \n  :port=&gt;{:type=&gt;\"integer\"}, \n  :path=&gt;{:type=&gt;\"string\"}, \n  :query_string=&gt;{:type=&gt;\"string\"}, \n  :crawl_page_id=&gt;{:type=&gt;\"string\"}\n}\n}\n</code></pre>\n\n<p>This one works for me. Is there any better way (perf. wise) to execute such a query?</p>\n\n<pre><code>   {\"query\"=&gt;\n          {\"filtered\"=&gt;\n            {\"query\"=&gt;{{\"match_all\"=&gt;{}},\n             \"filter\"=&gt;{\n               \"bool\"=&gt;{\n                 \"must\"=&gt;[\n                    {\"term\"=&gt;{\"domain_id\"=&gt;7721}}, \n                    {\"range\"=&gt;{\"goals\"=&gt;{\"gte\"=&gt;0}}}\n                    \"nested\"=&gt;{\"path\"=&gt;\"by_traffic_source\", \n                        \"filter\"=&gt;{\n                          {\"term\"=&gt;{\"by_traffic_source.source\"=&gt;\"organic\"}}\n                        }\n                      }\n                    }\n                  ]},\n\n               }\n              }\n            },\n         \"aggs\"=&gt;{\"crawl_pages\"=&gt;{\"terms\"=&gt;{\"field\"=&gt;\"crawl_page_id\", \"size\"=&gt;200}}}}\n</code></pre>\n"}, {"tags": ["ruby", "ruby-on-rails-4", "activerecord", "rails-activerecord"], "comments": [{"owner": {"reputation": 3210, "user_id": 5089231, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zX0dy.jpg?s=128&g=1", "display_name": "Athar", "link": "https://stackoverflow.com/users/5089231/athar"}, "edited": false, "score": 0, "creation_date": 1438190478, "post_id": 31707055, "comment_id": 51352508, "body": "you want to fetch those objects of model 1 who dont have any assosiation present in model 2.?"}], "answers": [{"comments": [{"owner": {"reputation": 924, "user_id": 5156200, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/9532c8dc80ba03725a07b502ebef5af5?s=128&d=identicon&r=PG&f=1", "display_name": "Bruno E.", "link": "https://stackoverflow.com/users/5156200/bruno-e"}, "edited": false, "score": 0, "creation_date": 1438196485, "post_id": 31707261, "comment_id": 51356058, "body": "That won&#39;t work very well for bigger tables. You first get all ids from one table and then put them back into another query. The suggestion by @Athar is the better approach, because the Database can handle the hard work."}], "tags": [], "owner": {"reputation": 32131, "user_id": 2346461, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/i3xAf.jpg?s=128&g=1", "display_name": "Pavan", "link": "https://stackoverflow.com/users/2346461/pavan"}, "is_accepted": true, "score": 1, "last_activity_date": 1438190954, "creation_date": 1438190954, "answer_id": 31707261, "question_id": 31707055, "link": "https://stackoverflow.com/questions/31707055/query-all-instances-of-a-model-with-0-associations/31707261#31707261", "title": "Query all instances of a model with 0 associations", "body": "<p>You can do like this</p>\n\n<pre><code>@model2_ids = Model2.pluck(:model1_id)\n@some_variable = Model1.where.not(id: @model2_ids)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 3210, "user_id": 5089231, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zX0dy.jpg?s=128&g=1", "display_name": "Athar", "link": "https://stackoverflow.com/users/5089231/athar"}, "is_accepted": false, "score": 0, "last_activity_date": 1438191022, "creation_date": 1438191022, "answer_id": 31707283, "question_id": 31707055, "link": "https://stackoverflow.com/questions/31707055/query-all-instances-of-a-model-with-0-associations/31707283#31707283", "title": "Query all instances of a model with 0 associations", "body": "<p>considering table name of Model1 is <code>model1</code> and table name of Model2 is <code>model2</code></p>\n\n<p>try this</p>\n\n<pre><code>Model1.joins(\"left outer join model2 on model2.model1_id = model1.id\").where(model2: {model1_id: nil})\n</code></pre>\n"}], "owner": {"reputation": 20915, "user_id": 392684, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/DXigI.jpg?s=128&g=1", "display_name": "Enrique Moreno Tent", "link": "https://stackoverflow.com/users/392684/enrique-moreno-tent"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 17, "favorite_count": 0, "accepted_answer_id": 31707261, "answer_count": 2, "score": 0, "last_activity_date": 1438191022, "creation_date": 1438190247, "last_edit_date": 1438190668, "question_id": 31707055, "link": "https://stackoverflow.com/questions/31707055/query-all-instances-of-a-model-with-0-associations", "title": "Query all instances of a model with 0 associations", "body": "<p>I have a <code>Model1</code>and a <code>Model2</code> with an 1:N relationship (Model1 has_many Model2). How can I query all the instances of <code>Model1</code> without any association with any <code>Model2</code>?</p>\n"}, {"tags": ["ruby", "macos", "ruby-on-rails-4", "rubymine"], "comments": [{"owner": {"reputation": 4071, "user_id": 3806046, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/5fedf50ce7cd2659bca902e9a2969158?s=128&d=identicon&r=PG&f=1", "display_name": "jkeuhlen", "link": "https://stackoverflow.com/users/3806046/jkeuhlen"}, "edited": false, "score": 0, "creation_date": 1438197323, "post_id": 31706725, "comment_id": 51356539, "body": "What are you trying to do with these? You can always set/access environment variables (these are system-wide). Is that what you want?"}, {"owner": {"reputation": 1737, "user_id": 824167, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/Gl9ya.jpg?s=128&g=1", "display_name": "Vlad Miller", "link": "https://stackoverflow.com/users/824167/vlad-miller"}, "reply_to_user": {"reputation": 4071, "user_id": 3806046, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/5fedf50ce7cd2659bca902e9a2969158?s=128&d=identicon&r=PG&f=1", "display_name": "jkeuhlen", "link": "https://stackoverflow.com/users/3806046/jkeuhlen"}, "edited": false, "score": 0, "creation_date": 1438198465, "post_id": 31706725, "comment_id": 51357136, "body": "I want to setup db connection string, aws parameters, etc in my environment variables and I don&#39;t want to add those to development.rb file, because I use docker to run db, other dev just runs it from localhost, and some other differences as well. I know I can export those variables in ~/.bash_profile, however I want to have those variables exported per project."}, {"owner": {"reputation": 4071, "user_id": 3806046, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/5fedf50ce7cd2659bca902e9a2969158?s=128&d=identicon&r=PG&f=1", "display_name": "jkeuhlen", "link": "https://stackoverflow.com/users/3806046/jkeuhlen"}, "edited": false, "score": 0, "creation_date": 1438198977, "post_id": 31706725, "comment_id": 51357428, "body": "Would setting them in some other configuration file work? Say <code>project_config.rb</code>. You could use this file for all of those default variables and just instantiate the config class to get to the variables."}, {"owner": {"reputation": 1737, "user_id": 824167, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/Gl9ya.jpg?s=128&g=1", "display_name": "Vlad Miller", "link": "https://stackoverflow.com/users/824167/vlad-miller"}, "reply_to_user": {"reputation": 4071, "user_id": 3806046, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/5fedf50ce7cd2659bca902e9a2969158?s=128&d=identicon&r=PG&f=1", "display_name": "jkeuhlen", "link": "https://stackoverflow.com/users/3806046/jkeuhlen"}, "edited": false, "score": 0, "creation_date": 1438249292, "post_id": 31706725, "comment_id": 51377255, "body": "@jkeuhlen this would only add extra complexity to ruby code. Also most of the variables are not common between developers. Something like <code>.env</code> file would totally work if rails or rubymine could read &amp; export it"}, {"owner": {"reputation": 4071, "user_id": 3806046, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/5fedf50ce7cd2659bca902e9a2969158?s=128&d=identicon&r=PG&f=1", "display_name": "jkeuhlen", "link": "https://stackoverflow.com/users/3806046/jkeuhlen"}, "edited": false, "score": 1, "creation_date": 1438264232, "post_id": 31706725, "comment_id": 51387379, "body": "I found some information from Jetbrains (who produces RubyMine) that tells you just how to do this :)"}], "answers": [{"comments": [{"owner": {"reputation": 1737, "user_id": 824167, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/Gl9ya.jpg?s=128&g=1", "display_name": "Vlad Miller", "link": "https://stackoverflow.com/users/824167/vlad-miller"}, "edited": false, "score": 1, "creation_date": 1438298863, "post_id": 31725615, "comment_id": 51406638, "body": "Do you also feel some bad smell here? Simple activity to setup env variables becomes pain in the ass."}, {"owner": {"reputation": 4071, "user_id": 3806046, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/5fedf50ce7cd2659bca902e9a2969158?s=128&d=identicon&r=PG&f=1", "display_name": "jkeuhlen", "link": "https://stackoverflow.com/users/3806046/jkeuhlen"}, "reply_to_user": {"reputation": 1737, "user_id": 824167, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/Gl9ya.jpg?s=128&g=1", "display_name": "Vlad Miller", "link": "https://stackoverflow.com/users/824167/vlad-miller"}, "edited": false, "score": 0, "creation_date": 1438350955, "post_id": 31725615, "comment_id": 51429459, "body": "@VladMiller It may be, but that&#39;s because you are setting them specifically for RubyMine rather than system wide. If this solves your problem, don&#39;t forget to accept! :)"}], "tags": [], "owner": {"reputation": 4071, "user_id": 3806046, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/5fedf50ce7cd2659bca902e9a2969158?s=128&d=identicon&r=PG&f=1", "display_name": "jkeuhlen", "link": "https://stackoverflow.com/users/3806046/jkeuhlen"}, "is_accepted": false, "score": 1, "last_activity_date": 1438264184, "creation_date": 1438264184, "answer_id": 31725615, "question_id": 31706725, "link": "https://stackoverflow.com/questions/31706725/setup-default-ruby-variables-in-rubymine/31725615#31725615", "title": "Setup default Ruby variables in RubyMine", "body": "<p>Jetbrains actually has <a href=\"https://devnet.jetbrains.com/docs/DOC-1160\" rel=\"nofollow\">a page</a> to help you do just this:</p>\n\n<blockquote>\n  <p>Mac OS X applies .bash_profile and .profile only for Terminal.app environment and  Apple's technical documentation suggests using ~/.MacOSX/environment.plist for other applications. So, by default  PATH value will differ for RubyMine and the console.</p>\n\n<pre><code>MacOS 10.6 or later\n</code></pre>\n  \n  <p>We recommend to manage your environment variables using <a href=\"http://www.rubicode.com/Software/RCEnvironment/\" rel=\"nofollow\">free\n  Enviroment Variables</a> preference pane instead of environment.plist\n  manual editing.</p>\n\n<pre><code>MacOS &lt; 10.6\n</code></pre>\n  \n  <p>Unfortunately, the \"environment.plist\" approach doesn't always work on\n  MacOS &lt; 10.6, e.g if you start RubyMine from Spotlight the environment\n  is not applied.</p>\n  \n  <p>Thus real solution is to set your environment variables in\n  /etc/launchd.conf (thanks to David Goudreau for this tip). For\n  detailed description please read Mac OS X Global Environment Variables\n  article.</p>\n  \n  <p>So you should:</p>\n  \n  <ol>\n  <li><p>Open /etc/launchd.conf file (e.g. $sudo nano /etc/launchd.conf)</p></li>\n  <li><p>Then set correct PATH env variable</p>\n\n<pre><code>setenv PATH /Users/romeo/.gem/ruby/1.8/bin:/opt/local/bin:/opt/local/sbin:/opt/local/libexec/git-core:/usr/local/mysql/bin:/usr/local/bin:/usr/bin:/bin:/usr/sbin:/sbin\n</code></pre></li>\n  <li><p>Set other env variables for RubyMine if necessary</p></li>\n  <li><p>Save changes</p></li>\n  <li><p>Reboot</p></li>\n  </ol>\n  \n  <p>P.S: If you always launch RubyMine using Dock or QuickSilver and do\n  not use Spotlight you can install Enviroment Variables preference pane\n  and use it instead of the manual environment.plist editing.</p>\n  \n  <p>NB: Please don't miss \"/usr/local/bin:/usr/bin:/bin:/usr/sbin:/sbin\"\n  in the end of PATH value, because PATH=...:$PATH doesn't work here.</p>\n</blockquote>\n"}], "owner": {"reputation": 1737, "user_id": 824167, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/Gl9ya.jpg?s=128&g=1", "display_name": "Vlad Miller", "link": "https://stackoverflow.com/users/824167/vlad-miller"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 863, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1438264184, "creation_date": 1438189214, "last_edit_date": 1438193624, "question_id": 31706725, "link": "https://stackoverflow.com/questions/31706725/setup-default-ruby-variables-in-rubymine", "title": "Setup default Ruby variables in RubyMine", "body": "<p>I use mac and rubymine <em>7.1.2</em> and I want to setup default environment variables? Is it possible to setup them up per run configuration so every test, rails generator, rails console has access to them.</p>\n\n<p>Is there something like <code>.env</code> file or something else, so it's possible just set them once?</p>\n"}, {"tags": ["javascript", "ruby", "parsing", "nokogiri", "mechanize"], "comments": [{"owner": {"reputation": 5134, "user_id": 1672197, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i8HkV.png?s=128&g=1", "display_name": "orde", "link": "https://stackoverflow.com/users/1672197/orde"}, "edited": false, "score": 3, "creation_date": 1438189398, "post_id": 31706522, "comment_id": 51351883, "body": "FWIW: <code>mechanize</code> doesn&#39;t support javascript, and <a href=\"https://help.linkedin.com/app/answers/detail/a_id/56347/~/linkedins-scraping-software-policy\" rel=\"nofollow noreferrer\">linkedin</a> doesn&#39;t want you scraping their site."}, {"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 0, "creation_date": 1438190261, "post_id": 31706522, "comment_id": 51352378, "body": "LinkedIn has an API. I&#39;d recommend using it or you&#39;ll probably find your code will have a short useful life."}, {"owner": {"reputation": 2345, "user_id": 4511585, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/IC7eZ.jpg?s=128&g=1", "display_name": "albttx", "link": "https://stackoverflow.com/users/4511585/albttx"}, "edited": false, "score": 0, "creation_date": 1438191006, "post_id": 31706522, "comment_id": 51352831, "body": "ok ... it&#39;s just for personal ... to learn mechanize ... It&#39;s pissed me off if i just stop trying ... how can i conturn this ?"}, {"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 1, "creation_date": 1438218737, "post_id": 31706522, "comment_id": 51365008, "body": "Use a site that is a better target? Create your own using Sinatra and HAML to generate forms and test against it locally? Seriously, start simple then slowly ramp up the complexity. Or, is your intent to scrape LinkedIn and it&#39;s not really a learning exercise?"}], "owner": {"reputation": 2345, "user_id": 4511585, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/IC7eZ.jpg?s=128&g=1", "display_name": "albttx", "link": "https://stackoverflow.com/users/4511585/albttx"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 76, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1438188589, "creation_date": 1438188589, "question_id": 31706522, "link": "https://stackoverflow.com/questions/31706522/mechanize-and-nokogiri-script", "title": "Mechanize and Nokogiri script", "body": "<p>I need to parse LinkedIn, and i met a problem..\nI start to use Mechanize in ruby, for parsing and moving on the website.</p>\n\n<p>My problem is, when i want to get the name of user, if i check the DOM with chrome, i can see the name of users, and my html balise...\nThe problem is, the html code, is in JS ! </p>\n\n<p>I let you see by yourself : <a href=\"http://pastebin.com/bZKA9Dr8\" rel=\"nofollow\">http://pastebin.com/bZKA9Dr8</a></p>\n\n<p>I need to click on the link where the class is \"title\" ... so the name of users .. </p>\n\n<p>I tried some line like :</p>\n\n<pre><code>res = page.search('.bd')\n</code></pre>\n\n<p>but nothing is find ... </p>\n\n<p>Thanks everyone, and sorry for my bad english .. ;)</p>\n"}, {"tags": ["arrays", "ruby"], "comments": [{"owner": {"reputation": 2374, "user_id": 115192, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Nsobz.jpg?s=128&g=1", "display_name": "gernberg", "link": "https://stackoverflow.com/users/115192/gernberg"}, "edited": false, "score": 1, "creation_date": 1438188289, "post_id": 31706369, "comment_id": 51351160, "body": "What have you attempted so far?"}, {"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 0, "creation_date": 1438190372, "post_id": 31706369, "comment_id": 51352452, "body": "Show us an example of what your resulting array will be."}], "answers": [{"tags": [], "owner": {"reputation": 8117, "user_id": 1207687, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/cOUI4.jpg?s=128&g=1", "display_name": "Wes Foster", "link": "https://stackoverflow.com/users/1207687/wes-foster"}, "is_accepted": false, "score": 2, "last_activity_date": 1438188315, "creation_date": 1438188315, "answer_id": 31706436, "question_id": 31706369, "link": "https://stackoverflow.com/questions/31706369/delete-duplicate-elements-from-array/31706436#31706436", "title": "Delete duplicate elements from Array", "body": "<p>A quick way to remove duplicate values from multiple arrays is by using <code>uniq</code></p>\n\n<pre><code>array1 = [\"dog\", \"cat\", \"had\"]\narray2 = [\"big\", \"fight\", \"had\"]\n\nnew_array = (array1 + array2).uniq  # &lt;- [\"dog\", \"cat\", \"had\", \"big\", \"fight\"]\n</code></pre>\n\n<p><code>uniq</code> removes duplicate values from an array. By combining <code>array1</code> and <code>array2</code> together, you can then filter out duplicates between the two of them.</p>\n"}, {"comments": [{"owner": {"reputation": 109029, "user_id": 2767755, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/BkC8q.jpg?s=128&g=1", "display_name": "Arup Rakshit", "link": "https://stackoverflow.com/users/2767755/arup-rakshit"}, "reply_to_user": {"reputation": 397, "user_id": 4974679, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/8190b2ed4d78a5845c3a4b0cb3fb7d36?s=128&d=identicon&r=PG&f=1", "display_name": "Arwa", "link": "https://stackoverflow.com/users/4974679/arwa"}, "edited": false, "score": 0, "creation_date": 1438188969, "post_id": 31706588, "comment_id": 51351589, "body": "@Arwa I was following your subject line <i>Delete object from array if already exist</i>.. If you are dealing with <code>Array</code>, not need to define your own."}], "tags": [], "owner": {"reputation": 109029, "user_id": 2767755, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/BkC8q.jpg?s=128&g=1", "display_name": "Arup Rakshit", "link": "https://stackoverflow.com/users/2767755/arup-rakshit"}, "is_accepted": false, "score": 3, "last_activity_date": 1438188779, "creation_date": 1438188779, "answer_id": 31706588, "question_id": 31706369, "link": "https://stackoverflow.com/questions/31706369/delete-duplicate-elements-from-array/31706588#31706588", "title": "Delete duplicate elements from Array", "body": "<p>You can use <code>Array#|</code> ( it does union operation) to remove duplicates too.</p>\n\n<pre><code>array1 = [\"dog\", \"cat\", \"had\"]\narray2 = [\"big\", \"fight\", \"had\"]\narray1 | array2\n# =&gt; [\"dog\", \"cat\", \"had\", \"big\", \"fight\"]\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 17357, "user_id": 794242, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e871d15815cfef926f21737a5ccd30c4?s=128&d=identicon&r=PG", "display_name": "Wand Maker", "link": "https://stackoverflow.com/users/794242/wand-maker"}, "is_accepted": false, "score": 1, "last_activity_date": 1438190349, "last_edit_date": 1438190349, "creation_date": 1438189980, "answer_id": 31706974, "question_id": 31706369, "link": "https://stackoverflow.com/questions/31706369/delete-duplicate-elements-from-array/31706974#31706974", "title": "Delete duplicate elements from Array", "body": "<p>If I want to solve your problem literally, then, I will write something like this:</p>\n\n<pre><code>array1 = [ :obj11, :obj21, :obj31 ]\narray2 = [ :obj21, :obj22, :obj23 ]\n\nnew_array = (array1 - array2) + array2\np new_array\n</code></pre>\n\n<p><code>(array1 - array2)</code> takes those elements from <code>array1</code> that are also present in <code>array2</code> and adding <code>array2</code> to that will get you the final result</p>\n\n<p><em>Output</em></p>\n\n<pre><code>[:obj11, :obj31, :obj21, :obj22, :obj23]\n</code></pre>\n\n<hr>\n\n<p><em>(Note: I used symbols as elements of arrays for illustration purposes)</em></p>\n"}, {"comments": [{"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1438206153, "post_id": 31708009, "comment_id": 51361288, "body": "Good answer. Rather than <code>array2 &lt;&lt; array1; array2.flatten!</code> I would suggest <code>array2.concat(array1)</code>."}, {"owner": {"reputation": 397, "user_id": 4974679, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/8190b2ed4d78a5845c3a4b0cb3fb7d36?s=128&d=identicon&r=PG&f=1", "display_name": "Arwa", "link": "https://stackoverflow.com/users/4974679/arwa"}, "reply_to_user": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1438208765, "post_id": 31708009, "comment_id": 51362380, "body": "Thanks, I will change it."}], "tags": [], "owner": {"reputation": 397, "user_id": 4974679, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/8190b2ed4d78a5845c3a4b0cb3fb7d36?s=128&d=identicon&r=PG&f=1", "display_name": "Arwa", "link": "https://stackoverflow.com/users/4974679/arwa"}, "is_accepted": false, "score": 1, "last_activity_date": 1438193325, "creation_date": 1438193325, "answer_id": 31708009, "question_id": 31706369, "link": "https://stackoverflow.com/questions/31706369/delete-duplicate-elements-from-array/31708009#31708009", "title": "Delete duplicate elements from Array", "body": "<p>I got the answer. In the following I delete from array1 what is already exist in array2. Equality here works as I define it in the question. Thus, checking if attributes (that have been defined in the method ==) are equal.</p>\n\n<pre><code>array1.delete_if{|elem| array2.any?{|e| e == elem}}\n</code></pre>\n\n<p>Then add the rest of array1 into array2.</p>\n\n<pre><code>array2 &lt;&lt; array1\n</code></pre>\n\n<p>Then I flatten array2.</p>\n\n<pre><code>array2.flatten!\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "is_accepted": false, "score": 0, "last_activity_date": 1438198651, "last_edit_date": 1438198651, "creation_date": 1438195036, "answer_id": 31708549, "question_id": 31706369, "link": "https://stackoverflow.com/questions/31706369/delete-duplicate-elements-from-array/31708549#31708549", "title": "Delete duplicate elements from Array", "body": "<p>You could do that as follows:</p>\n\n<pre><code> a2.concat(a1.delete_if { |e| a2.include?(e) })\n</code></pre>\n\n<p>Here's an example:</p>\n\n<pre><code>class MyClass\n  attr_reader :a, :b, :c\n  def initialize(a, b, c)\n    @a, @b, @c = a, b, c\n  end\n  def ==(other)\n    self.a == other.a &amp;&amp; self.b == other.b\n  end\nend\n\na1 = [MyClass.new('cat', 'bat', 'rat'),\n      MyClass.new('dog', 'hog', 'pig'),\n      MyClass.new('jay', 'bee', 'fly'),]\n  #=&gt; [#&lt;MyClass:0x007fca8407b678 @a=\"cat\", @b=\"bat\", @c=\"rat\"&gt;,\n  #    #&lt;MyClass:0x007fca8407bee8 @a=\"dog\", @b=\"hog\", @c=\"pig\"&gt;,\n  #    #&lt;MyClass:0x007fca84073ef0 @a=\"jay\", @b=\"bee\", @c=\"fly\"&gt;] \na2 = [MyClass.new('fly', 'bee', 'bat'),\n      MyClass.new('cat', 'bat', 'rat'),\n      MyClass.new('dog', 'hog', 'cat'),] \n  #=&gt; [#&lt;MyClass:0x007fca840382d8 @a=\"fly\", @b=\"bee\", @c=\"bat\"&gt;,\n  #    #&lt;MyClass:0x007fca840381e8 @a=\"cat\", @b=\"bat\", @c=\"rat\"&gt;,\n  #    #&lt;MyClass:0x007fca840380d0 @a=\"dog\", @b=\"hog\", @c=\"cat\"&gt;] \n\na2.concat(a1.delete_if { |e| a2.include?(e) })\n  #=&gt; [#&lt;MyClass:0x007f96d404ea08 @a=\"fly\", @b=\"bee\", @c=\"bat\"&gt;,\n  #    #&lt;MyClass:0x007f96d404e8c8 @a=\"cat\", @b=\"bat\", @c=\"rat\"&gt;,\n  #    #&lt;MyClass:0x007f96d404e710 @a=\"dog\", @b=\"hog\", @c=\"cat\"&gt;,\n  #    #&lt;MyClass:0x007f96d409d9c8 @a=\"jay\", @b=\"bee\", @c=\"fly\"&gt;] \na1\n  #=&gt; [#&lt;MyClass:0x007f96d409d9c8 @a=\"jay\", @b=\"bee\", @c=\"fly\"&gt;]  \n</code></pre>\n\n<p>If we change the first element of <code>a1</code> from:</p>\n\n<pre><code> MyClass.new('cat', 'bat', 'rat')\n</code></pre>\n\n<p>to:</p>\n\n<pre><code> MyClass.new('cat', 'rat', 'bat')\n</code></pre>\n\n<p>we obtain:</p>\n\n<pre><code>a2.concat(a1.delete_if { |e| a2.include?(e) })\n  #=&gt; [#&lt;MyClass:0x007f89528568c0 @a=\"fly\", @b=\"bee\", @c=\"bat\"&gt;,\n  #    #&lt;MyClass:0x007f8952856708 @a=\"cat\", @b=\"bat\", @c=\"rat\"&gt;,\n  #    #&lt;MyClass:0x007f89528562d0 @a=\"dog\", @b=\"hog\", @c=\"cat\"&gt;,\n  #    #&lt;MyClass:0x007f89519277f0 @a=\"cat\", @b=\"rat\", @c=\"bat\"&gt;,\n  #    #&lt;MyClass:0x007f8951927598 @a=\"jay\", @b=\"bee\", @c=\"fly\"&gt;] \n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 31319, "user_id": 981183, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/88dd7155ef7c0e5f43ab8d1a9efdecab?s=128&d=identicon&r=PG&f=1", "display_name": "K M Rakibul Islam", "link": "https://stackoverflow.com/users/981183/k-m-rakibul-islam"}, "is_accepted": false, "score": 0, "last_activity_date": 1439179953, "creation_date": 1439179953, "answer_id": 31911520, "question_id": 31706369, "link": "https://stackoverflow.com/questions/31706369/delete-duplicate-elements-from-array/31911520#31911520", "title": "Delete duplicate elements from Array", "body": "<p>Another way (using <code>intersection</code> operation):</p>\n\n<pre><code>   array1 = [ 1, 2, 3, 4, 5 ]\n   array2 = [ 2, 3, 4, 5, 6 ]\n   final_array = array1 + array2\n   final_array &amp; final_array\n</code></pre>\n\n<p>This will also delete duplicates. IRB output:</p>\n\n<pre><code>2.2.1 :012 &gt; array1 = [ 1, 2, 3, 4, 5 ]\n =&gt; [1, 2, 3, 4, 5] \n2.2.1 :013 &gt; array2 = [ 2, 3, 4, 5, 6 ]\n =&gt; [2, 3, 4, 5, 6] \n2.2.1 :014 &gt; final_array = array1 + array2\n =&gt; [1, 2, 3, 4, 5, 2, 3, 4, 5, 6] \n2.2.1 :015 &gt; final_array &amp; final_array\n =&gt; [1, 2, 3, 4, 5, 6] \n</code></pre>\n"}], "owner": {"reputation": 397, "user_id": 4974679, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/8190b2ed4d78a5845c3a4b0cb3fb7d36?s=128&d=identicon&r=PG&f=1", "display_name": "Arwa", "link": "https://stackoverflow.com/users/4974679/arwa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 90, "favorite_count": 0, "answer_count": 6, "score": 3, "last_activity_date": 1439179953, "creation_date": 1438188115, "last_edit_date": 1495535220, "question_id": 31706369, "link": "https://stackoverflow.com/questions/31706369/delete-duplicate-elements-from-array", "title": "Delete duplicate elements from Array", "body": "<p>I have two arrays, <code>array1</code> and <code>array2</code>, as follows:</p>\n\n<pre><code>array1 = [ obj11, obj21, obj31 ]\narray2 = [ obj21, obj22, obj23 ]\n</code></pre>\n\n<p>Objects in both arrays are from the same class. I want to check if <code>array1</code> contains objects that already exist in <code>array2</code> and delete them.</p>\n\n<p>Let's say <code>obj11</code> and <code>obj22</code> are equal. By \"equal,\" I mean they have similar attribute values. Then I would like to delete <code>obj11</code> from <code>array1</code>, then insert <code>obj21</code> and <code>obj31</code> in <code>array2</code>. </p>\n\n<p>I already define equality for attributes in the objects' class from <a href=\"https://stackoverflow.com/questions/3941074/comparing-objects-in-ruby\">here</a>:</p>\n\n<pre><code>def ==(other)\n  return self.a == other.a &amp;&amp; self.b == other.b\nend\n</code></pre>\n\n<p>The resulting array would be:</p>\n\n<pre><code>array2 = [ obj21, obj22, obj23, obj21, obj31 ]\n</code></pre>\n"}, {"tags": ["ruby", "linux", "vim"], "answers": [{"comments": [{"owner": {"reputation": 4071, "user_id": 3806046, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/5fedf50ce7cd2659bca902e9a2969158?s=128&d=identicon&r=PG&f=1", "display_name": "jkeuhlen", "link": "https://stackoverflow.com/users/3806046/jkeuhlen"}, "edited": false, "score": 1, "creation_date": 1438185045, "post_id": 31705258, "comment_id": 51349145, "body": "For more information on the differences between <code>[backtick]</code> <code>system()</code> and <code>exec()</code>, take a look at this other SO question: <a href=\"http://stackoverflow.com/questions/6338908/ruby-difference-between-exec-system-and-x-or-backticks\" title=\"ruby difference between exec system and x or backticks\">stackoverflow.com/questions/6338908/&hellip;</a>"}], "tags": [], "owner": {"reputation": 16076, "user_id": 802618, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6111449042dd940f360673d25d61ea6b?s=128&d=identicon&r=PG", "display_name": "Kristj&#225;n", "link": "https://stackoverflow.com/users/802618/kristj%c3%a1n"}, "is_accepted": false, "score": 2, "last_activity_date": 1438185186, "last_edit_date": 1438185186, "creation_date": 1438184922, "answer_id": 31705258, "question_id": 31704989, "link": "https://stackoverflow.com/questions/31704989/creating-alias-on-ruby-vim-output-is-not-to-a-terminal/31705258#31705258", "title": "Creating alias on Ruby - Vim output is not to a terminal", "body": "<p>Backticks capture command output into a string for you to use in your script, which Vim is rightfully unhappy with because it won't be able to print you a UI. Use <code>system()</code> instead, which hands everything over to the new process. If you don't need to come back to your Ruby script, you can use <code>exec()</code>, which replaces the process entirely.</p>\n\n<p>You're also going to need to quote your message as <code>git commit -m \"#{ARGV[0]}\"</code>, or it will be interpreted as <code>git commit -m My Commit Message</code> and complain there are no files <code>Commit</code> or <code>Message</code>. And then of course, you'll need to escape the message itself so you don't break out of the doublequotes early. Look at <a href=\"http://ruby-doc.org/stdlib-2.0.0/libdoc/shellwords/rdoc/Shellwords.html#method-c-shellescape\" rel=\"nofollow\">Shellwords#shellescape</a> for that.</p>\n"}], "owner": {"reputation": 19941, "user_id": 1197775, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/e53f945a0f4c5ada2f489f65d182c147?s=128&d=identicon&r=PG&f=1", "display_name": "sites", "link": "https://stackoverflow.com/users/1197775/sites"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 145, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1438185186, "creation_date": 1438184185, "last_edit_date": 1438184608, "question_id": 31704989, "link": "https://stackoverflow.com/questions/31704989/creating-alias-on-ruby-vim-output-is-not-to-a-terminal", "title": "Creating alias on Ruby - Vim output is not to a terminal", "body": "<p>I am trying to create an alias on Ruby:</p>\n\n<pre><code>#!/usr/bin/env ruby\n\nif ARGV[0]\n  `git add -A &amp;&amp; git commit -m #{ARGV[0]} &amp;&amp; git push`\nelse\n  `git add -A &amp;&amp; EDITOR='TERM=xterm vim' git commit &amp;&amp; git push`\nend\n</code></pre>\n\n<p>I tried first without <code>EDITOR...</code>, but any thing I try I get <code>Vim: Warning: Output is not to a terminal</code>.</p>\n\n<p>What I want is vim to appear when I do not enter any commit message. But instead I get that message.</p>\n\n<h1>Update</h1>\n\n<p>I think what I need is to capture editor output as git does. How could I do that?</p>\n"}, {"tags": ["arrays", "ruby", "string"], "comments": [{"owner": {"reputation": 15090, "user_id": 310892, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/Jy9kc.jpg?s=128&g=1", "display_name": "Lee Jarvis", "link": "https://stackoverflow.com/users/310892/lee-jarvis"}, "edited": false, "score": 3, "creation_date": 1438182827, "post_id": 31704164, "comment_id": 51347420, "body": "<code>Array(projects).join(&#39;, &#39;)</code>"}, {"owner": {"reputation": 25560, "user_id": 14253, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/235c58ad566abb4c7979bc7033e9882c?s=128&d=identicon&r=PG", "display_name": "DGM", "link": "https://stackoverflow.com/users/14253/dgm"}, "edited": false, "score": 1, "creation_date": 1438184041, "post_id": 31704164, "comment_id": 51348368, "body": "Make that comment into an answer, it&#39;s the right way."}, {"owner": {"reputation": 39041, "user_id": 27358, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/fed1635f89478c88eda07e87de452bcf?s=128&d=identicon&r=PG", "display_name": "David Moles", "link": "https://stackoverflow.com/users/27358/david-moles"}, "reply_to_user": {"reputation": 15090, "user_id": 310892, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/Jy9kc.jpg?s=128&g=1", "display_name": "Lee Jarvis", "link": "https://stackoverflow.com/users/310892/lee-jarvis"}, "edited": false, "score": 0, "creation_date": 1484175917, "post_id": 31704164, "comment_id": 70407284, "body": "Seriously, @LeeJarvis, post that as an answer so we can upvote it."}, {"owner": {"reputation": 62092, "user_id": 3538012, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/dcc3c1ad5e4ae4d79ba377020978d107?s=128&d=identicon&r=PG&f=1", "display_name": "Peter Duniho", "link": "https://stackoverflow.com/users/3538012/peter-duniho"}, "reply_to_user": {"reputation": 39041, "user_id": 27358, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/fed1635f89478c88eda07e87de452bcf?s=128&d=identicon&r=PG", "display_name": "David Moles", "link": "https://stackoverflow.com/users/27358/david-moles"}, "edited": false, "score": 0, "creation_date": 1484339779, "post_id": 31704164, "comment_id": 70485931, "body": "@DavidMoles: 18 months later, I think it&#39;s safe to say Lee won&#39;t mind if someone else takes his comment and posts it as an answer. Frankly, it&#39;s not against community standards to use someone else&#39;s comment as the basis for an answer, even if the comment is only minutes old. A decent answer takes more effort to write up than an off-hand comment, and often the commenter has no intention of investing that effort. More power to the person who runs with the idea and provides something useful."}], "answers": [{"tags": [], "owner": {"reputation": 3396, "user_id": 2803660, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/97dcc39b47364ae9599cd685d96999cc?s=128&d=identicon&r=PG", "display_name": "MrHaze", "link": "https://stackoverflow.com/users/2803660/mrhaze"}, "is_accepted": false, "score": 4, "last_activity_date": 1438182931, "last_edit_date": 1438182931, "creation_date": 1438182496, "answer_id": 31704341, "question_id": 31704164, "link": "https://stackoverflow.com/questions/31704164/how-to-define-a-ruby-method-that-either-takes-an-array-or-a-string/31704341#31704341", "title": "How to define a Ruby method that either takes an Array or a String?", "body": "<p>You can check the type of the input, for example:</p>\n\n<pre><code>&gt;&gt; a = ['foo', 'bar']\n=&gt; ['foo', 'bar']\n&gt;&gt; a.is_a? Array\n=&gt; true\n</code></pre>\n\n<p>you can also check string with <code>is_a?</code></p>\n\n<p>You would end up with something link:</p>\n\n<pre><code>def list(projects)\n    if projects.is_a? Array\n        puts projects.join(', ')\n    else\n        puts projects\n    end\nend\n\nlist('a') # a\nlist(['a', 'b']) # a, b\n</code></pre>\n\n<p>You have many ways of doing this in Ruby, <code>respond_to?</code> and <code>kind_of?</code> also work</p>\n"}, {"tags": [], "owner": {"reputation": 17497, "user_id": 23915, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b5e935da7b67c03dd56f385b031f485c?s=128&d=identicon&r=PG", "display_name": "Unixmonkey", "link": "https://stackoverflow.com/users/23915/unixmonkey"}, "is_accepted": false, "score": 3, "last_activity_date": 1438182656, "creation_date": 1438182656, "answer_id": 31704398, "question_id": 31704164, "link": "https://stackoverflow.com/questions/31704164/how-to-define-a-ruby-method-that-either-takes-an-array-or-a-string/31704398#31704398", "title": "How to define a Ruby method that either takes an Array or a String?", "body": "<p>One way would be you could type-check the input:</p>\n\n<pre><code>def list(projects)\n  if projects.is_a?(String)\n    projects = [projects]\n  end\n  puts projects.join(', ')\nend\n</code></pre>\n\n<p>Or you could use <code>Array()</code> to auto-convert a string into an array, or leave an existing array alone:</p>\n\n<pre><code>def list(projects)\n  Array(projects).join(', ')\nend\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "reply_to_user": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 1, "creation_date": 1438183313, "post_id": 31704625, "comment_id": 51347785, "body": "@SergioTulentsev I know i just wanted to show all the ways it can be used without any concern for errors. Plus originally I didn&#39;t have the flatten in there and then I figured since the OP asked to pass a true array this would be the easiest way to handle this."}, {"owner": {"reputation": 17357, "user_id": 794242, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e871d15815cfef926f21737a5ccd30c4?s=128&d=identicon&r=PG", "display_name": "Wand Maker", "link": "https://stackoverflow.com/users/794242/wand-maker"}, "edited": false, "score": 0, "creation_date": 1438190678, "post_id": 31704625, "comment_id": 51352640, "body": "Why is <code>flatten</code> needed? When I tried <code>projects.join(&#39;, &#39;)</code> it seems to give desired result"}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "reply_to_user": {"reputation": 17357, "user_id": 794242, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e871d15815cfef926f21737a5ccd30c4?s=128&d=identicon&r=PG", "display_name": "Wand Maker", "link": "https://stackoverflow.com/users/794242/wand-maker"}, "edited": false, "score": 0, "creation_date": 1438192477, "post_id": 31704625, "comment_id": 51353646, "body": "@WandMaker without <code>flatten</code>, <code>list([&#39;a&#39;, &#39;b&#39;])</code> would result in a nested array. Removing <code>flatten</code> works in this case because <code>join</code> can handle nested arrays."}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "reply_to_user": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1438209641, "post_id": 31704625, "comment_id": 51362701, "body": "@stefan and @wandmaker thank you I didn&#39;t even try just using <code>#join</code>.  Answer updated."}, {"owner": {"reputation": 39041, "user_id": 27358, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/fed1635f89478c88eda07e87de452bcf?s=128&d=identicon&r=PG", "display_name": "David Moles", "link": "https://stackoverflow.com/users/27358/david-moles"}, "edited": false, "score": 5, "creation_date": 1484175760, "post_id": 31704625, "comment_id": 70407220, "body": "_this will allow you to pass an Array and/or a String without issue_\u2014I don&#39;t think this is strictly true. It works because <code>join</code> handles nested arrays, but consider something like <code>def count_args(*p); p.size; end</code>\u2014<code>count_args(*arr)</code> will return 7, but <code>count_args(arr)</code> will return 1. The caller still needs to know to splat the array."}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "reply_to_user": {"reputation": 39041, "user_id": 27358, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/fed1635f89478c88eda07e87de452bcf?s=128&d=identicon&r=PG", "display_name": "David Moles", "link": "https://stackoverflow.com/users/27358/david-moles"}, "edited": false, "score": 0, "creation_date": 1484182111, "post_id": 31704625, "comment_id": 70409158, "body": "@DavidMoles yes for your case but not the presented case as you pointed out <code>Array#join</code> handles nested Arrays so my statement is true"}, {"owner": {"reputation": 39041, "user_id": 27358, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/fed1635f89478c88eda07e87de452bcf?s=128&d=identicon&r=PG", "display_name": "David Moles", "link": "https://stackoverflow.com/users/27358/david-moles"}, "edited": false, "score": 13, "creation_date": 1484246471, "post_id": 31704625, "comment_id": 70442557, "body": "@engineersmnky I&#39;m sorry you&#39;re taking it personally. If you run across one of my answers while searching for information and find it steers you in the wrong direction, by all means comment and downvote."}], "tags": [], "owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "is_accepted": true, "score": 6, "last_activity_date": 1438211118, "last_edit_date": 1438211118, "creation_date": 1438183194, "answer_id": 31704625, "question_id": 31704164, "link": "https://stackoverflow.com/questions/31704164/how-to-define-a-ruby-method-that-either-takes-an-array-or-a-string/31704625#31704625", "title": "How to define a Ruby method that either takes an Array or a String?", "body": "<p>Why not something like this: </p>\n\n<pre><code>def list(*projects)\n  projects.join(', ')\nend\n</code></pre>\n\n<p>Then you can call it with as many arguments as you please </p>\n\n<pre><code>list('a')\n#=&gt; \"a\"\nlist('a','b')\n#=&gt; \"a, b\"\narr = %w(a b c d e f g)\nlist(*arr)\n#=&gt; \"a, b, c, d, e, f, g\"\nlist(arr,'h','i')\n#=&gt; \"a, b, c, d, e, f, g, h, i\"\n</code></pre>\n\n<p>The splat (*) will automatically convert all arguments into an Array,  this will allow you to pass an Array and/or a String without issue. It will work fine with other objects too</p>\n\n<pre><code>list(1,2,'three',arr,{\"test\" =&gt; \"hash\"}) \n#=&gt; \"1, 2, three, a, b, c, d, e, f, g, {\\\"test\\\"=&gt;\\\"hash\\\"}\"\n</code></pre>\n\n<p><sup><sub>Thank you @Stefan and @WandMaker for pointing out <code>Array#join</code> can handle nested Arrays</sub>\n</sup></p>\n"}, {"tags": [], "owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "is_accepted": false, "score": 1, "last_activity_date": 1438184440, "creation_date": 1438184440, "answer_id": 31705102, "question_id": 31704164, "link": "https://stackoverflow.com/questions/31704164/how-to-define-a-ruby-method-that-either-takes-an-array-or-a-string/31705102#31705102", "title": "How to define a Ruby method that either takes an Array or a String?", "body": "<p>I would ask the provided value if it responds to <code>join</code>:</p>\n\n<pre><code>def list(projects)\n  projects.respond_to?(:join) ? projects.join(', ') : projects \nend\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1438187509, "post_id": 31705134, "comment_id": 51350706, "body": "I&#39;ve voted to undelete <a href=\"http://stackoverflow.com/a/31704638/477037\">sawa&#39;s answer</a>, accepting <i>either</i> an array <i>or</i> a list of objects is the way to go. Trying to handle both is cumbersome."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "reply_to_user": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 1, "creation_date": 1438187845, "post_id": 31705134, "comment_id": 51350903, "body": "@Stefan, I didn&#39;t know one can vote to undelete an answer. That&#39;s weird, but there are now two votes. Perhaps sawa will yield to our wishes and voluntarily undelete it."}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1438188127, "post_id": 31705134, "comment_id": 51351069, "body": "For the record, I didn&#39;t suggest removing <code>flatten</code> :)"}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "reply_to_user": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1438188436, "post_id": 31705134, "comment_id": 51351248, "body": "@Sergio, I don&#39;t know how I totally misread your comment, but since a string doesn&#39;t respond to <code>flatten</code>, I don&#39;t understand what your meant."}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1438189256, "post_id": 31705134, "comment_id": 51351799, "body": "BTW, <code>[*obj]</code> can have unexpected results if <code>obj</code> responds to <code>to_a</code>. Try <code>list(Time.now)</code>"}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1438189668, "post_id": 31705134, "comment_id": 51352039, "body": "<code>[*projects]</code> is equivalent to <code>Array(projects)</code> isn&#39;t it?"}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1438189767, "post_id": 31705134, "comment_id": 51352099, "body": "@CarySwoveland: I meant that he didn&#39;t <i>need</i> to do splatting: <code>list(*ary)</code>. Could have just done <code>list(ary)</code>, because of the <code>flatten</code> there."}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "reply_to_user": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1438189868, "post_id": 31705134, "comment_id": 51352155, "body": "@SergioTulentsev <code>ary</code> could be a string, you can&#39;t <code>flatten</code> a string"}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "reply_to_user": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1438189947, "post_id": 31705134, "comment_id": 51352203, "body": "@Stefan: I think Cary and I, we&#39;re talking about engineersmnky&#39;s answer. String doesn&#39;t have a chance to be flattened there."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "reply_to_user": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1438190112, "post_id": 31705134, "comment_id": 51352297, "body": "@Stefan, with regard to your last comment, I think so. I noticed Lee Jarvis mentioned that in a comment on the question.  Your penultimate comment is interesting. Readers:  <code>[*Time.now][5] #=&gt; 2015</code>."}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "reply_to_user": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1438190113, "post_id": 31705134, "comment_id": 51352298, "body": "@SergioTulentsev of course. The splat is needed to convert <code>ary</code> to an array. Otherwise <code>list(&#39;a&#39;)</code> would result in <code>&#39;a&#39;.flatten</code>"}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "reply_to_user": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1438190302, "post_id": 31705134, "comment_id": 51352409, "body": "@Stefan: read the answer. And I was talking about splatting in the method <i>call</i>, not method definition."}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "reply_to_user": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1438190431, "post_id": 31705134, "comment_id": 51352488, "body": "@Stefan: maybe it&#39;s called differently. I call both usages &quot;splatting&quot; :)"}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "reply_to_user": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1438190496, "post_id": 31705134, "comment_id": 51352524, "body": "@SergioTulentsev sorry, I was talking about the splat in <code>def list(*projects)</code> and could not understand your point :-)"}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "reply_to_user": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1438190572, "post_id": 31705134, "comment_id": 51352568, "body": "@Stefan: yeah, I figured :)"}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 2, "creation_date": 1438210947, "post_id": 31705134, "comment_id": 51363094, "body": "This is the longest conversation about any one of my answers and it&#39;s not even on my answer. :)"}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1552594312, "post_id": 31705134, "comment_id": 97081698, "body": "@sawa, care to undelete your answer?"}], "tags": [], "owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "is_accepted": false, "score": 2, "last_activity_date": 1552594237, "last_edit_date": 1552594237, "creation_date": 1438184565, "answer_id": 31705134, "question_id": 31704164, "link": "https://stackoverflow.com/questions/31704164/how-to-define-a-ruby-method-that-either-takes-an-array-or-a-string/31705134#31705134", "title": "How to define a Ruby method that either takes an Array or a String?", "body": "<pre><code>def list(projects)\n  puts Array(projects).join(', ')\nend\n\nlist ['a', 'b']\na, b\nlist 'a'\na\n</code></pre>\n\n<p>One could alternatively write</p>\n\n<pre><code>puts [*projects].join(', ')\n</code></pre>\n\n<p>A caveat: don't use this.</p>\n\n<p>I posted this solution only to show two ways it could be done. @sawa, in his now-deleted answer, is right: users of the method should not be permitted to pass an array as an argument. Instead, they should be restricted to passing individual elements. If:</p>\n\n<pre><code>arr = [1,2,3]\n</code></pre>\n\n<p>the method would be called by one of the following:</p>\n\n<pre><code>list 1\nlist 1,2\nlist 1,2,3\nlist *arr\n</code></pre>\n\n<p>but not:</p>\n\n<pre><code>list arr\n</code></pre>\n\n<p>This simplifies the method and makes its application more consistent. Ask yourself this: why permit <code>arr</code> in lieu of <code>*arr</code>? To save one character?</p>\n\n<p>The method that does this is @engineersmnky's answer with <code>.flatten</code> removed.</p>\n"}], "owner": {"reputation": 23433, "user_id": 1127485, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/e7eccba442d1ee3ca8e4ded89b343362?s=128&d=identicon&r=PG", "display_name": "sschuberth", "link": "https://stackoverflow.com/users/1127485/sschuberth"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4575, "favorite_count": 0, "accepted_answer_id": 31704625, "answer_count": 5, "score": 10, "last_activity_date": 1552594237, "creation_date": 1438182025, "last_edit_date": 1438183032, "question_id": 31704164, "link": "https://stackoverflow.com/questions/31704164/how-to-define-a-ruby-method-that-either-takes-an-array-or-a-string", "title": "How to define a Ruby method that either takes an Array or a String?", "body": "<p>I defined a method that takes an Array (of Strings), like</p>\n\n<pre><code>def list(projects)\n  puts projects.join(', ')\nend\n\nlist(['a', 'b'])\n</code></pre>\n\n<p>However, as a short-hand for calling it with an Array that only consists of a single String element, I'd like the same function to also accept a single plain String like</p>\n\n<pre><code>  list('a')\n</code></pre>\n\n<p>What would be the Ruby way to handle this inside the method?</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 32131, "user_id": 2346461, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/i3xAf.jpg?s=128&g=1", "display_name": "Pavan", "link": "https://stackoverflow.com/users/2346461/pavan"}, "edited": false, "score": 0, "creation_date": 1438180946, "post_id": 31703678, "comment_id": 51345965, "body": "Can you post the controller code?"}, {"owner": {"reputation": 732, "user_id": 958503, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/AqaXx.png?s=128&g=1", "display_name": "Raza Hussain", "link": "https://stackoverflow.com/users/958503/raza-hussain"}, "edited": false, "score": 0, "creation_date": 1438181005, "post_id": 31703678, "comment_id": 51346027, "body": "please add model relations in your code"}, {"owner": {"reputation": 32131, "user_id": 2346461, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/i3xAf.jpg?s=128&g=1", "display_name": "Pavan", "link": "https://stackoverflow.com/users/2346461/pavan"}, "edited": false, "score": 1, "creation_date": 1438182063, "post_id": 31703678, "comment_id": 51346864, "body": "Chnage <code>reservation_params</code> to <code>params.require(:reservation).permit(:Class_point, :Date_trip, :dep_id, :arr_id, :route_id).merge(user_id: current_user.id)</code>"}, {"owner": {"reputation": 599, "user_id": 4929753, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/7f4edccafe958081e3dda2c428095f05?s=128&d=identicon&r=PG&f=1", "display_name": "Pino ", "link": "https://stackoverflow.com/users/4929753/pino"}, "edited": false, "score": 0, "creation_date": 1438182136, "post_id": 31703678, "comment_id": 51346922, "body": "seems it works, thank you man!"}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1438182233, "post_id": 31703678, "comment_id": 51347001, "body": "Please note method names in ruby should be snake_case not CamelCase. Uppercase letters are meant to be reserved for Constants (e.g. Class, Module, or CONSTANT definitions) so things like Class_point should be class_point"}, {"owner": {"reputation": 599, "user_id": 4929753, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/7f4edccafe958081e3dda2c428095f05?s=128&d=identicon&r=PG&f=1", "display_name": "Pino ", "link": "https://stackoverflow.com/users/4929753/pino"}, "edited": false, "score": 0, "creation_date": 1438182441, "post_id": 31703678, "comment_id": 51347141, "body": "Can i ask you one more thing? To see only the reservations made by the current user which url should i link to? thank you"}], "answers": [{"comments": [{"owner": {"reputation": 599, "user_id": 4929753, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/7f4edccafe958081e3dda2c428095f05?s=128&d=identicon&r=PG&f=1", "display_name": "Pino ", "link": "https://stackoverflow.com/users/4929753/pino"}, "edited": false, "score": 0, "creation_date": 1438181345, "post_id": 31703795, "comment_id": 51346302, "body": "I posted the controller and the model"}], "tags": [], "owner": {"reputation": 779, "user_id": 5135282, "user_type": "registered", "profile_image": "https://graph.facebook.com/511721875/picture?type=large", "display_name": "Alexandre Voyer", "link": "https://stackoverflow.com/users/5135282/alexandre-voyer"}, "is_accepted": false, "score": 0, "last_activity_date": 1438181059, "creation_date": 1438181059, "answer_id": 31703795, "question_id": 31703678, "link": "https://stackoverflow.com/questions/31703678/how-to-link-user-with-his-own-reservation-rails/31703795#31703795", "title": "How to link User with his own reservation Rails", "body": "<p>I would be curious to see the model... if a reservation belongs to a user, in the reservation's controller for edit you can simply go @reservation = Reservation.find(params[:id]) and then @reservation.user will give you the user's information</p>\n\n<hr>\n"}, {"tags": [], "owner": {"reputation": 32131, "user_id": 2346461, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/i3xAf.jpg?s=128&g=1", "display_name": "Pavan", "link": "https://stackoverflow.com/users/2346461/pavan"}, "is_accepted": true, "score": 1, "last_activity_date": 1438182613, "creation_date": 1438182613, "answer_id": 31704386, "question_id": 31703678, "link": "https://stackoverflow.com/questions/31703678/how-to-link-user-with-his-own-reservation-rails/31704386#31704386", "title": "How to link User with his own reservation Rails", "body": "<p>You are not creating a <code>reservation</code> with a value for <code>user_id</code>, so <code>user_id</code> is always <strong><em>nil</em></strong>. You can change your <code>reservation_params</code> like below to make it work.</p>\n\n<pre><code>def reservation_params\n  params.require(:reservation).permit(:Class_point, :Date_trip, :dep_id, :arr_id, :route_id).merge(user_id: current_user.id)\nend\n</code></pre>\n\n<p>And also as <strong><em>@engineersmnky</em></strong> pointed out, you should use <code>:class_point</code>,<code>:date_trip</code> instead of <code>:Class_point</code>,<code>:Date_trip</code></p>\n"}], "owner": {"reputation": 599, "user_id": 4929753, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/7f4edccafe958081e3dda2c428095f05?s=128&d=identicon&r=PG&f=1", "display_name": "Pino ", "link": "https://stackoverflow.com/users/4929753/pino"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 252, "favorite_count": 0, "accepted_answer_id": 31704386, "answer_count": 2, "score": 1, "last_activity_date": 1438182613, "creation_date": 1438180777, "last_edit_date": 1438181316, "question_id": 31703678, "link": "https://stackoverflow.com/questions/31703678/how-to-link-user-with-his-own-reservation-rails", "title": "How to link User with his own reservation Rails", "body": "<p>can you help me to fix this issue? \nI have Reservation and User and I want to see from the user profile the reservations that he made. This is the code i wrote so far:</p>\n\n<pre><code> app/views/reservations/index.html.erb\n.\n.\n.\n\n\n    &lt;tbody&gt;\n        &lt;% @reservations.each do |reservation| %&gt;\n          &lt;tr&gt;\n            &lt;td&gt;&lt;%= reservation.Class_point %&gt;&lt;/td&gt;\n            &lt;td&gt;&lt;%= reservation.Date_trip %&gt;&lt;/td&gt;\n            &lt;td&gt;&lt;%= reservation.dep.try(:city) %&gt;&lt;/td&gt;\n            &lt;td&gt;&lt;%= reservation.arr.try(:city) %&gt;&lt;/td&gt;\n            &lt;td&gt;&lt;%= reservation.route.countStop %&gt;&lt;/td&gt;\n            &lt;td&gt;&lt;%= reservation.user_id %&gt;&lt;/td&gt;\n            &lt;td&gt;&lt;%= link_to 'Show', reservation %&gt;&lt;/td&gt;\n            &lt;td&gt;&lt;%= link_to 'Edit', edit_reservation_path(reservation) %&gt;&lt;/td&gt;\n            &lt;td&gt;&lt;%= link_to 'Destroy', reservation, method: :delete, data: { confirm: 'Are you sure?' } %&gt;&lt;/td&gt;\n.\n.\n.\n\napp/controllers/reservations_controller\n\nclass ReservationsController &lt; ApplicationController\n  before_action :logged_in_user, only: [:edit, :new, :update, :destroy]\n  before_action :set_reservation, only: [:show, :edit, :update, :destroy]\n\n  # GET /reservations\n  # GET /reservations.json\n  def index\n    @reservations = Reservation.all\n  end\n\n  # GET /reservations/1\n  # GET /reservations/1.json\n  def show\n  end\n\n  # GET /reservations/new\n  def new\n    @reservation = Reservation.new\n  end\n\n  # GET /reservations/1/edit\n  def edit\n  end\n\n  # POST /reservations\n  # POST /reservations.json\n  def create\n    @reservation = Reservation.new(reservation_params)\n\n    respond_to do |format|\n      if @reservation.save\n        format.html { redirect_to @reservation, notice: 'Reservation was successfully created.' }\n        format.json { render :show, status: :created, location: @reservation }\n      else\n        format.html { render :new }\n        format.json { render json: @reservation.errors, status: :unprocessable_entity }\n      end\n    end\n  end\n\n  # PATCH/PUT /reservations/1\n  # PATCH/PUT /reservations/1.json\n  def update\n    respond_to do |format|\n      if @reservation.update(reservation_params)\n        format.html { redirect_to @reservation, notice: 'Reservation was successfully updated.' }\n        format.json { render :show, status: :ok, location: @reservation }\n      else\n        format.html { render :edit }\n        format.json { render json: @reservation.errors, status: :unprocessable_entity }\n      end\n    end\n  end\n\n  # DELETE /reservations/1\n  # DELETE /reservations/1.json\n  def destroy\n    @reservation.destroy\n    respond_to do |format|\n      format.html { redirect_to reservations_url, notice: 'Reservation was successfully destroyed.' }\n      format.json { head :no_content }\n    end\n  end\n\n  private\n    # Use callbacks to share common setup or constraints between actions.\n    def set_reservation\n      @reservation = Reservation.find(params[:id])\n    end\n\n    # Never trust parameters from the scary internet, only allow the white list through.\n    def reservation_params\n      params.require(:reservation).permit(:Class_point, :Date_trip, :dep_id, :arr_id, :route_id, :user_id)\n    end\n\n  def logged_in_user\n      unless logged_in?\n        flash[:danger] = \"Please log in.\"\n        redirect_to login_url\n      end\n  end\nend\n\n\n\napp/models/reservation.rb\n\nclass Reservation &lt; ActiveRecord::Base\n  belongs_to :dep ,:class_name =&gt; 'Stop', :foreign_key =&gt; 'dep_id'\n  belongs_to :arr ,:class_name =&gt; 'Stop',:foreign_key =&gt; 'arr_id'\n  belongs_to :route\n  belongs_to :user\n  delegate :CountStop, :to =&gt; :route, prefix: true, :allow_nil =&gt; false\n  delegate :city ,:to =&gt; :arr, :allow_nil =&gt; false\n  delegate :city ,:to =&gt; :dep, :allow_nil =&gt; false\nend\n</code></pre>\n\n<p>The problem is that when I create a new Reservation, user_id does not appear..\nwhat can I do? thank you</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "apache", "apache2", "passenger"], "answers": [{"comments": [{"owner": {"reputation": 1796, "user_id": 2505621, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56d6c5fb64f4c58eef1732d0bfa29aba?s=128&d=identicon&r=PG", "display_name": "Thomas Chafiol", "link": "https://stackoverflow.com/users/2505621/thomas-chafiol"}, "edited": false, "score": 0, "creation_date": 1438269951, "post_id": 31707134, "comment_id": 51391635, "body": "Thanks a lot!! I have to set /assets instead of /public."}], "tags": [], "owner": {"reputation": 787, "user_id": 2582475, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04b7b53d905d43e3d1a813e6a7dfd729?s=128&d=identicon&r=PG", "display_name": "Jerry", "link": "https://stackoverflow.com/users/2582475/jerry"}, "is_accepted": true, "score": 1, "last_activity_date": 1438190528, "creation_date": 1438190528, "answer_id": 31707134, "question_id": 31703667, "link": "https://stackoverflow.com/questions/31703667/how-prevent-passenger-to-redirect-the-http-request-to-the-rails-server-when-the/31707134#31707134", "title": "How prevent passenger to redirect the http request to the rails server when the request ask for a public asset?", "body": "<p>Try this :)</p>\n\n<pre><code>&lt;Location /public&gt;\n   PassengerEnabled off\n&lt;/Location&gt;\n</code></pre>\n"}], "owner": {"reputation": 1796, "user_id": 2505621, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56d6c5fb64f4c58eef1732d0bfa29aba?s=128&d=identicon&r=PG", "display_name": "Thomas Chafiol", "link": "https://stackoverflow.com/users/2505621/thomas-chafiol"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 560, "favorite_count": 0, "accepted_answer_id": 31707134, "answer_count": 1, "score": 1, "last_activity_date": 1438190528, "creation_date": 1438180740, "question_id": 31703667, "link": "https://stackoverflow.com/questions/31703667/how-prevent-passenger-to-redirect-the-http-request-to-the-rails-server-when-the", "title": "How prevent passenger to redirect the http request to the rails server when the request ask for a public asset?", "body": "<p>I'm using Apache2 and Passenger to serve my web rails application.</p>\n\n<p>I'm using the asset pipeline of Rails to serve static assets from the Rails.root/public folder.\nUsually when a request for an asset file is made, Apache2 success to find the corresponding asset file and serve it. I'm happy with that.</p>\n\n<p>But when the asset is missing, Passenger is taking over the request and redirect it to rails. Then Rails is generating a 404 error.</p>\n\n<p>My goal is to prevent Apache/Passenger to redirect to the Rails app if the asset is missing. I'm trying to generate a 404 error without using Rails. I want that as soon as Apache2 fail to get the asset, he send back the error.</p>\n\n<p>I'm using a virtualhost, here is my configuration file. (I'm using SSL)\nI want the public folder to be serve only with Apache even with the files are missing.</p>\n\n<pre><code>&lt;VirtualHost *:443&gt;\n    ServerName DOMAIN_NAME\n\n    DocumentRoot /home/RAILS_APP_PATH/public\n    #Here I saw some others configurations files having other directives, maybe I should add one.\n\n    PassengerFriendlyErrorPages On\n\n    RewriteEngine On\n\n    ErrorDocument 503 /503.html\n    RewriteCond %{REQUEST_URI} !^/503.html$\n    RewriteCond %{DOCUMENT_ROOT}/../tmp/maintenance.txt -f\n    RewriteCond %{DOCUMENT_ROOT}/%{REQUEST_FILENAME} !-f\n    RewriteRule ^(.*)$ /503.html [NC,R=503,L]\n    RewriteCond %{DOCUMENT_ROOT}/../tmp/maintenance.txt !-f\n    RewriteCond %{REQUEST_URI} ^/503.html\n    RewriteRule ^503.html https://DOMAIN_NAME.com/ [R=302,L]\n\n    SSLEngine ON\n    SSLCertificateFile /home/SSL_PATH/certificat.crt\n    SSLCertificateKeyFile /home/SSL_PATH/certificat.key\n    SSLCertificateChainFile /home/SSL_PATH/bundle.crt\n\n&lt;/VirtualHost&gt;\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-4"], "comments": [{"owner": {"reputation": 32131, "user_id": 2346461, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/i3xAf.jpg?s=128&g=1", "display_name": "Pavan", "link": "https://stackoverflow.com/users/2346461/pavan"}, "edited": false, "score": 0, "creation_date": 1438180715, "post_id": 31703605, "comment_id": 51345806, "body": "What you are trying to do? As per your code <code>@cart_items</code> doesn&#39;t contain <code>product_id</code>."}, {"owner": {"user_type": "does_not_exist", "display_name": "user3766324"}, "reply_to_user": {"reputation": 32131, "user_id": 2346461, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/i3xAf.jpg?s=128&g=1", "display_name": "Pavan", "link": "https://stackoverflow.com/users/2346461/pavan"}, "edited": false, "score": 0, "creation_date": 1438180923, "post_id": 31703605, "comment_id": 51345954, "body": "@cart_items is an array of LineItems which contains a field product_id. I am trying to add items to the cart, while detecting if the item being added is already present in the cart. Each item is identified by product_id"}, {"owner": {"reputation": 32131, "user_id": 2346461, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/i3xAf.jpg?s=128&g=1", "display_name": "Pavan", "link": "https://stackoverflow.com/users/2346461/pavan"}, "edited": false, "score": 0, "creation_date": 1438181149, "post_id": 31703605, "comment_id": 51346132, "body": "You have <code>@cart_items = find_cart_items</code> What is value of <code>session[:cart_items]</code> in <code>find_cart_items</code> method?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user3766324"}, "reply_to_user": {"reputation": 32131, "user_id": 2346461, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/i3xAf.jpg?s=128&g=1", "display_name": "Pavan", "link": "https://stackoverflow.com/users/2346461/pavan"}, "edited": false, "score": 0, "creation_date": 1438181389, "post_id": 31703605, "comment_id": 51346323, "body": "Find_cart_items is a private method in store_controller I&#39;ve put up above."}, {"owner": {"reputation": 32131, "user_id": 2346461, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/i3xAf.jpg?s=128&g=1", "display_name": "Pavan", "link": "https://stackoverflow.com/users/2346461/pavan"}, "edited": false, "score": 0, "creation_date": 1438181461, "post_id": 31703605, "comment_id": 51346378, "body": "I can see that. What&#39;s the value of <code>session[:cart_items]</code>?"}, {"owner": {"reputation": 3832, "user_id": 136508, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/391f9b787cdc12aa2c179713f5103e3a?s=128&d=identicon&r=PG", "display_name": "ilan berci", "link": "https://stackoverflow.com/users/136508/ilan-berci"}, "edited": false, "score": 0, "creation_date": 1438181666, "post_id": 31703605, "comment_id": 51346548, "body": "session[:cart_items] is not an array as you expect, it&#39;s a hash.  Check how it was initially assigned"}, {"owner": {"user_type": "does_not_exist", "display_name": "user3766324"}, "reply_to_user": {"reputation": 32131, "user_id": 2346461, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/i3xAf.jpg?s=128&g=1", "display_name": "Pavan", "link": "https://stackoverflow.com/users/2346461/pavan"}, "edited": false, "score": 0, "creation_date": 1438182718, "post_id": 31703605, "comment_id": 51347336, "body": "I expected session[:cart_items] to be an array of LineItems. Any suggestions for how I could store an array of LineItems in a session? @Pavan initially I suppose it&#39;s an empty array, then the first LineItem is added to it. Is there any way I can access session[:xyz] on rails console?"}, {"owner": {"reputation": 1785, "user_id": 3373470, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/8f968c218643a09267014e4beaeb4770?s=128&d=identicon&r=PG&f=1", "display_name": "onebree", "link": "https://stackoverflow.com/users/3373470/onebree"}, "edited": false, "score": 0, "creation_date": 1438182938, "post_id": 31703605, "comment_id": 51347512, "body": "Please edit the title of the question to be more description. There are <i>many</i> questions where the title includes &quot;undefined error&quot;"}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user3766324"}, "edited": false, "score": 0, "creation_date": 1438187149, "post_id": 31704479, "comment_id": 51350507, "body": "Yes that&#39;s what I mean"}], "tags": [], "owner": {"reputation": 6537, "user_id": 1092012, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/10370955d7505a5738d223e11015bfc4?s=128&d=identicon&r=PG", "display_name": "Nathan", "link": "https://stackoverflow.com/users/1092012/nathan"}, "is_accepted": true, "score": 0, "last_activity_date": 1438183726, "last_edit_date": 1438183726, "creation_date": 1438182852, "answer_id": 31704479, "question_id": 31703605, "link": "https://stackoverflow.com/questions/31703605/error-on-trying-to-retrieve-an-object-stored-in-session/31704479#31704479", "title": "Error on trying to retrieve an object stored in session", "body": "<p><code>item = @cart_items.find {|i| i.product_id == product}</code></p>\n\n<p>Seems <code>i</code> is a Hash, so you can't call <code>#product_id</code> on it.</p>\n\n<p>Try <code>i['product_id']</code> or <code>i[:product_id]</code>. If that doesn't work, try to debug using <a href=\"https://github.com/rweng/pry-rails\" rel=\"nofollow\" title=\"pry\">pry</a> or some similar tool, and figure out what <code>i</code> is.</p>\n\n<hr>\n\n<p>Also, this doesn't seem to make sense: </p>\n\n<p><code>item = @cart_items.find {|i| i.product_id == product}</code></p>\n\n<p>Don't you mean:</p>\n\n<p><code>item = @cart_items.find {|i| i.product_id == product.id}</code></p>\n"}, {"tags": [], "owner": {"reputation": 742, "user_id": 1843864, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/5adbd699985cbc48f675057051824d8d?s=128&d=identicon&r=PG", "display_name": "Tom Wilson", "link": "https://stackoverflow.com/users/1843864/tom-wilson"}, "is_accepted": false, "score": 0, "last_activity_date": 1438186809, "creation_date": 1438186809, "answer_id": 31705989, "question_id": 31703605, "link": "https://stackoverflow.com/questions/31703605/error-on-trying-to-retrieve-an-object-stored-in-session/31705989#31705989", "title": "Error on trying to retrieve an object stored in session", "body": "<p>It seems like you are attempting to save an array of ActiveRecord objects in the session.  </p>\n\n<p>Session data is serialized, and sometimes with unexpected results.  There are many references to how this can be a problem, for example,\n<a href=\"http://railscasts.com/episodes/13-dangers-of-model-in-session?view=comments\" rel=\"nofollow\">Railscasts: Dangers of Model in Session</a>.</p>\n\n<p>To see what's going on, you can stop &amp; debug (or just puts) the @cart_items variable, right after line 9 in your controller.  I'll bet the @cart_items variable does not contain what you think. (It seems like the session is deserializing it as an array of Hashes.)</p>\n\n<p>The standard advice is to save an array of LineItem id's in the session rather than an array of LineItem objects themselves.  Then the session serialization/deserialization should work very simply with no surprises.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user3766324"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 68, "favorite_count": 0, "accepted_answer_id": 31704479, "answer_count": 2, "score": -1, "last_activity_date": 1438234594, "creation_date": 1438180562, "last_edit_date": 1438234594, "question_id": 31703605, "link": "https://stackoverflow.com/questions/31703605/error-on-trying-to-retrieve-an-object-stored-in-session", "title": "Error on trying to retrieve an object stored in session", "body": "<p>I am getting the following error:</p>\n\n<pre><code> NoMethodError in StoreController#add_to_cart\n undefined method `product_id' for #&lt;Hash:0xb9d34aa0&gt;\n\n Extracted source (around line #11):\n\n 9      @cart_items = find_cart_items\n 10      @cart_total_price = session[:cart_total_price]\n 11     item = @cart_items.find {|i| i.product_id == product}\n 12      if item\n 13        item.update_quantity_by_one\n 14      else\n</code></pre>\n\n<p>store_controller.rb</p>\n\n<pre><code>class StoreController &lt; ApplicationController\n\n  def index\n      @products = Product.salable_items\n  end\n\n  def add_to_cart\n      product = Product.find(params[:id])\n        @cart_items = find_cart_items\n      @cart_total_price = session[:cart_total_price]\n        item = @cart_items.find {|i| i.product_id == product}\n      if item\n        item.update_quantity_by_one\n      else\n        li = LineItem.new\n        if li.save\n          li.for_product(product)\n          @cart_items &lt;&lt; li\n        else\n          flash[:alert] = \"Error encountered.\"\n        end\n      end\n\n      #@cart_items &lt;&lt; LineItem.for_product(product)\n      @cart_total_price += product.price\n        redirect_to display_cart_path\n  end\n\n  def display_cart\n      @items = session[:cart_items]\n  end\n\n  private \n    def find_cart_items\n        if session[:cart_items].nil?\n        session[:cart_total_price] = 0\n        session[:cart_items] = Array.new\n      else\n        session[:cart_items]\n      end\n    end\nend\n</code></pre>\n\n<p>line_item.rb</p>\n\n<pre><code>class LineItem &lt; ActiveRecord::Base\n    belongs_to :product\n\n    def for_product(product) \n        update_attribute(:quantity, 1)\n        update_attribute(:product, product)\n        update_attribute(:unit_price, product.price)\n    end\n\n    def update_quantity_by_one\n        self.quantity += 1\n    end\nend\n</code></pre>\n\n<p>I get this error on adding the <strong>second item</strong> to the cart i.e. when there is one <code>LineItem</code> already present in <code>session[:cart_items]</code>. I have simulated this sequence of events in the rails console where everything works fine and I am able to retrieve the correct object on executing <code>@cart_items.find {|i| i.product_id == product}</code>, but when I launch in the browser, the above said error occurs. What might the problem be? Why is a 'hash' getting retrieved?  </p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-3.1", "rails-activerecord"], "comments": [{"owner": {"reputation": 787, "user_id": 2582475, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04b7b53d905d43e3d1a813e6a7dfd729?s=128&d=identicon&r=PG", "display_name": "Jerry", "link": "https://stackoverflow.com/users/2582475/jerry"}, "edited": false, "score": 0, "creation_date": 1438190806, "post_id": 31702745, "comment_id": 51352724, "body": "Not able to follow your question. Can you explain it a little bit more?"}, {"owner": {"reputation": 397, "user_id": 957444, "user_type": "registered", "accept_rate": 31, "profile_image": "https://www.gravatar.com/avatar/efd97d86e0d759c6e56cdc98e5e17f80?s=128&d=identicon&r=PG", "display_name": "constantine1", "link": "https://stackoverflow.com/users/957444/constantine1"}, "reply_to_user": {"reputation": 787, "user_id": 2582475, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04b7b53d905d43e3d1a813e6a7dfd729?s=128&d=identicon&r=PG", "display_name": "Jerry", "link": "https://stackoverflow.com/users/2582475/jerry"}, "edited": false, "score": 0, "creation_date": 1438264103, "post_id": 31702745, "comment_id": 51387280, "body": "Edited. Is the question clear now?"}], "owner": {"reputation": 397, "user_id": 957444, "user_type": "registered", "accept_rate": 31, "profile_image": "https://www.gravatar.com/avatar/efd97d86e0d759c6e56cdc98e5e17f80?s=128&d=identicon&r=PG", "display_name": "constantine1", "link": "https://stackoverflow.com/users/957444/constantine1"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 157, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1438264072, "creation_date": 1438178514, "last_edit_date": 1438264072, "question_id": 31702745, "link": "https://stackoverflow.com/questions/31702745/rails-3-select-multiple-values-from-table-joined-multiple-times", "title": "Rails 3 select multiple values from table joined multiple times", "body": "<p>Let's say I have ActiveRecord models A, B and C:</p>\n\n<pre><code>class A &lt; ActiveRecord::Base    \n    belongs_to :c\n    has_one :b\nend\n\nclass B &lt; ActiveRecord::Base\n    belongs_to :c\nend\n\nclass C &lt; ActiveRecord::Base\n    has_many :a\n    has_one :c\nend\n</code></pre>\n\n<p>The database tables look like:</p>\n\n<pre><code>Table a:\nid (auto increment) | b_id | c_id\n\nTable b:\nid (auto increment) | c_id\n\nTable c:\nid (auto increment)\n</code></pre>\n\n<p>Now I want,</p>\n\n<pre><code>SELECT a.id, b.id, c.id, b_c.id\n    FROM a\nINNER JOIN b ON a.b_id = b.id\nINNER JOIN c ON a.c_id = c.id\nINNER JOIN c b_c b.c_id = b_c.id\n</code></pre>\n\n<p>I know I can do it by using SQL directly in <code>joins</code> and <code>select</code>:</p>\n\n<pre><code>A.joins(:b, :c).joins('INNER JOIN c b_c b.c_id = b_c.id')\n</code></pre>\n\n<p>Is there a rails way to do it?\nCan his be in Rail-like syntax? Something like:</p>\n\n<pre><code>A.joins(:c, :b =&gt; :c).select(:c =&gt; :id).select(:b =&gt; { :c =&gt; :id})\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "amazon", "sidekiq", "chef-recipe"], "answers": [{"tags": [], "owner": {"reputation": 85, "user_id": 2634143, "user_type": "registered", "accept_rate": 30, "profile_image": "https://i.stack.imgur.com/oDfQi.jpg?s=128&g=1", "display_name": "Sergii Naumenko", "link": "https://stackoverflow.com/users/2634143/sergii-naumenko"}, "is_accepted": false, "score": 0, "last_activity_date": 1438253640, "creation_date": 1438253640, "answer_id": 31721836, "question_id": 31702057, "link": "https://stackoverflow.com/questions/31702057/cannot-delete-processes-in-opsworks-recipe/31721836#31721836", "title": "Cannot delete processes in opsworks recipe", "body": "<p>I found solutions</p>\n\n<pre><code>command \"kill -9 `cat tmp/pids/sidekiq.pid`; bundle exec sidekiq -C config/myschool_sidekiq.yml -d -L log/sidekiq.log -P tmp/pids/sidekiq.pid\"\n</code></pre>\n"}], "owner": {"reputation": 85, "user_id": 2634143, "user_type": "registered", "accept_rate": 30, "profile_image": "https://i.stack.imgur.com/oDfQi.jpg?s=128&g=1", "display_name": "Sergii Naumenko", "link": "https://stackoverflow.com/users/2634143/sergii-naumenko"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 35, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1438253640, "creation_date": 1438177007, "question_id": 31702057, "link": "https://stackoverflow.com/questions/31702057/cannot-delete-processes-in-opsworks-recipe", "title": "Cannot delete processes in opsworks recipe", "body": "<p>I wrote own custom recipe:</p>\n\n<pre><code>node[:deploy].each do |application, deploy|\n  Chef::Log.info(\"test\")\n  release_path = ::File.join(deploy[:deploy_to], 'current')\n\n  execute \"start\" do\n    cwd release_path\n    command \"pkill -f sidekiq; bundle exec sidekiq -C config/myschool_sidekiq.yml -d -L log/sidekiq.log\"\n    environment \"RAILS_ENV\" =&gt; 'staging'\n  end\nend\n</code></pre>\n\n<p>And deploy is failed.</p>\n\n<p>If I run code without </p>\n\n<pre><code>pkill -f sidekiq;\n</code></pre>\n\n<p>than deploy is success but old sidekiq process remained.</p>\n\n<p>In logs I didn't see anything.</p>\n"}, {"tags": ["ruby", "math", "shoes"], "comments": [{"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 3, "creation_date": 1438177565, "post_id": 31701988, "comment_id": 51343240, "body": "pick number <i>a</i> from 0..9 and number <i>b</i> from 0..a"}, {"owner": {"reputation": 4071, "user_id": 3806046, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/5fedf50ce7cd2659bca902e9a2969158?s=128&d=identicon&r=PG&f=1", "display_name": "jkeuhlen", "link": "https://stackoverflow.com/users/3806046/jkeuhlen"}, "edited": false, "score": 0, "creation_date": 1438177566, "post_id": 31701988, "comment_id": 51343245, "body": "While this may be answered here, questions like <code>is my implementation good?</code> or <code>how can I improve this code?</code> are better for the <a href=\"http://codereview.stackexchange.com/\">Code Review</a> stack exchange"}, {"owner": {"reputation": 3870, "user_id": 2336725, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/20a0b96a26cf233d752469445595f872?s=128&d=identicon&r=PG", "display_name": "Teepeemm", "link": "https://stackoverflow.com/users/2336725/teepeemm"}, "edited": false, "score": 3, "creation_date": 1438177592, "post_id": 31701988, "comment_id": 51343265, "body": "Don&#39;t link to your code; most people won&#39;t follow the link.  Post it here instead.  Subtraction results in a negative number 45% of the time.  Unless you have a really slow loop, that should be sufficient."}, {"owner": {"reputation": 31885, "user_id": 1008938, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/EOZbS.png?s=128&g=1", "display_name": "Linuxios", "link": "https://stackoverflow.com/users/1008938/linuxios"}, "reply_to_user": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 1, "creation_date": 1438177773, "post_id": 31701988, "comment_id": 51343426, "body": "@Stefan is exactly right. You only need to do that for subtraction though."}, {"owner": {"reputation": 184, "user_id": 3800524, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/7478fdb5e644d85e0875f8200b33a279?s=128&d=identicon&r=PG&f=1", "display_name": "Sebastjan Hribar", "link": "https://stackoverflow.com/users/3800524/sebastjan-hribar"}, "edited": false, "score": 0, "creation_date": 1438179416, "post_id": 31701988, "comment_id": 51344761, "body": "Thank you all! I&#39;ll keep in  mind the code linking and code review suggestions in the future."}], "answers": [{"comments": [{"owner": {"reputation": 184, "user_id": 3800524, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/7478fdb5e644d85e0875f8200b33a279?s=128&d=identicon&r=PG&f=1", "display_name": "Sebastjan Hribar", "link": "https://stackoverflow.com/users/3800524/sebastjan-hribar"}, "edited": false, "score": 0, "creation_date": 1438179457, "post_id": 31702840, "comment_id": 51344809, "body": "Thank you for this solution!"}], "tags": [], "owner": {"reputation": 2607, "user_id": 4470392, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CvLjT.jpg?s=128&g=1", "display_name": "Maxim Pontyushenko", "link": "https://stackoverflow.com/users/4470392/maxim-pontyushenko"}, "is_accepted": true, "score": 1, "last_activity_date": 1438178714, "creation_date": 1438178714, "answer_id": 31702840, "question_id": 31701988, "link": "https://stackoverflow.com/questions/31701988/doing-math-with-ruby/31702840#31702840", "title": "doing math with ruby", "body": "<p>Maybe instead of while and stuff you should do something like this:</p>\n\n<pre><code>  def compute(operator)\n    input_1, input_2 = prepare_arguments(operator)\n    result = case operator\n    when \"add\"\n      input_1 + input_2\n    when \"multiply\"\n      input_1 * input_2\n    when \"subtract\"\n      input_1 - input_2\n    when \"divide\"\n      input_1 / input_2\n    end\n\n    {result: result, operator: operator, input_1: input_1, input_2: input_2}\n  end\n\n  def prepare_arguments(operator)\n    case operator\n    when \"subtract\"\n      [first_argument = rand(0..9), first_argument + rand(0..9)].reverse\n    when \"divide\"\n      [first_argument = rand(1..9), first_argument * rand(0..9)].reverse\n    else\n      [rand(0..9), rand(0..9)]\n    end\n  end\n</code></pre>\n\n<p>So if you have an operator it will result with correct arguments and the result of computation.</p>\n"}], "owner": {"reputation": 184, "user_id": 3800524, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/7478fdb5e644d85e0875f8200b33a279?s=128&d=identicon&r=PG&f=1", "display_name": "Sebastjan Hribar", "link": "https://stackoverflow.com/users/3800524/sebastjan-hribar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 305, "favorite_count": 0, "closed_date": 1438199928, "accepted_answer_id": 31702840, "answer_count": 1, "score": 1, "last_activity_date": 1438178714, "creation_date": 1438176829, "last_edit_date": 1438177304, "question_id": 31701988, "link": "https://stackoverflow.com/questions/31701988/doing-math-with-ruby", "closed_reason": "Not suitable for this site", "title": "doing math with ruby", "body": "<p>I'm refactgoring a learning game for kids to learn spelling and math. I'm trying to expand the math by multiplication, subtraction and division operators.</p>\n\n<p>The problem occurs when the process loopes for a long time, because I don't want it to return a negative number.</p>\n\n<p>Brief process description:\nThe two numbers for selected operator are generated randomly from ranges (currently 0..9). The computation executes and if the result is a negative number the whole process runs again.</p>\n\n<p>The problem of course occurs only with subtraction and division.</p>\n\n<p>Sources: </p>\n\n<ul>\n<li><p>loop code: lines 82 to 85 in <a href=\"https://github.com/sebastjan-hribar/abc123/blob/master/lib/abc123.rb\" rel=\"nofollow\">https://github.com/sebastjan-hribar/abc123/blob/master/lib/abc123.rb</a></p></li>\n<li><p>helpers: <a href=\"https://github.com/sebastjan-hribar/abc123/blob/master/lib/abc123/helpers_math.rb\" rel=\"nofollow\">https://github.com/sebastjan-hribar/abc123/blob/master/lib/abc123/helpers_math.rb</a></p></li>\n</ul>\n\n<p>My question?</p>\n\n<p>Is there a more elegant way of implementing these calculations to avoid the result often being a negative number (maybe by predefining the numbers to be used as input1 and input2)?</p>\n\n<p>The addition runs ok, but with subtraction it often loops w/o end.</p>\n"}, {"tags": ["ruby", "sinatra", "haml"], "comments": [{"owner": {"reputation": 11068, "user_id": 335847, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/o0AC7.png?s=128&g=1", "display_name": "iain", "link": "https://stackoverflow.com/users/335847/iain"}, "edited": false, "score": 1, "creation_date": 1438249809, "post_id": 31701460, "comment_id": 51377669, "body": "Use Sinatra Partial? <a href=\"https://github.com/yb66/Sinatra-Partial\" rel=\"nofollow noreferrer\">github.com/yb66/Sinatra-Partial</a>"}, {"owner": {"reputation": 623, "user_id": 846250, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o1e1i.png?s=128&g=1", "display_name": "To\ub9c8SE", "link": "https://stackoverflow.com/users/846250/to%eb%a7%88se"}, "reply_to_user": {"reputation": 11068, "user_id": 335847, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/o0AC7.png?s=128&g=1", "display_name": "iain", "link": "https://stackoverflow.com/users/335847/iain"}, "edited": false, "score": 0, "creation_date": 1438337309, "post_id": 31701460, "comment_id": 51420591, "body": "@iain unfortunately this one didn&#39;t work either, when I try to adapt my code to call <code>partial</code> rather than <code>haml</code>, I end with a <code>LocalJumpError - no block given (yield)</code>. It looks like, whatever I try, the inner block (containing the <code>%span</code>s) is never transmitted correctly. But I&#39;m clueless as to where it fails, or why."}, {"owner": {"reputation": 11068, "user_id": 335847, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/o0AC7.png?s=128&g=1", "display_name": "iain", "link": "https://stackoverflow.com/users/335847/iain"}, "edited": false, "score": 0, "creation_date": 1438415779, "post_id": 31701460, "comment_id": 51452074, "body": "Is it that you want to be able to pass contents <i>dynamically</i> to <code>inner_block</code>, or is this just the strategy you&#39;ve taken to try to get nested partials to work?"}, {"owner": {"reputation": 623, "user_id": 846250, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o1e1i.png?s=128&g=1", "display_name": "To\ub9c8SE", "link": "https://stackoverflow.com/users/846250/to%eb%a7%88se"}, "reply_to_user": {"reputation": 11068, "user_id": 335847, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/o0AC7.png?s=128&g=1", "display_name": "iain", "link": "https://stackoverflow.com/users/335847/iain"}, "edited": false, "score": 0, "creation_date": 1440852989, "post_id": 31701460, "comment_id": 52450197, "body": "@iain sorry for the late reply, yes I want to pass contents dynamically, as I&#39;m calling my real life <code>inner_template</code> with some parameters such as the contents of the header, and the block itself is a parameter. Please note that the block will display values defined in the route."}, {"owner": {"reputation": 11068, "user_id": 335847, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/o0AC7.png?s=128&g=1", "display_name": "iain", "link": "https://stackoverflow.com/users/335847/iain"}, "edited": false, "score": 0, "creation_date": 1441041501, "post_id": 31701460, "comment_id": 52508110, "body": "No problem. Maybe it&#39;s because you&#39;ve simplified the code in the question to help clarify, but I&#39;m not really seeing what you&#39;re aiming for or why it will improve what you&#39;ve got?"}], "owner": {"reputation": 623, "user_id": 846250, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o1e1i.png?s=128&g=1", "display_name": "To\ub9c8SE", "link": "https://stackoverflow.com/users/846250/to%eb%a7%88se"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 406, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1438175544, "creation_date": 1438175544, "question_id": 31701460, "link": "https://stackoverflow.com/questions/31701460/rendering-nested-haml-templates-with-blocks-as-parameters", "title": "Rendering nested HAML templates with blocks as parameters", "body": "<p>I am currently using an helper method to render a HAML nested partial/template in Sinatra. For the sake of simplicity I just wrote a minimal example but of course my code is much larger. The point is that I want to factorise <code>inner_template</code> instead of copy/pasting everywhere:</p>\n\n<pre class=\"lang-ruby prettyprint-override\"><code>require 'sinatra'\nrequire 'haml'\n\nhelpers do\n  def inner_template(&amp;block)\n    haml_tag('div', :class =&gt; 'title', &amp;block)\n  end\nend\n\nget '/' do\n  haml :index\nend\n\n__END__\n\n@@ layout\n%html\n  = yield\n\n@@ index\n%div.div1\n  - inner_template do\n    %span Item 1\n  - inner_template do\n    %span Item 2\n</code></pre>\n\n<p>This correctly renders the page like this:</p>\n\n<pre class=\"lang-html prettyprint-override\"><code>&lt;html&gt;\n  &lt;div class='div1'&gt;\n    &lt;div class='title'&gt;\n      &lt;span&gt;Item 1&lt;/span&gt;\n    &lt;/div&gt;\n    &lt;div class='title'&gt;\n      &lt;span&gt;Item 2&lt;/span&gt;\n    &lt;/div&gt;\n  &lt;/div&gt;\n&lt;/html&gt;\n</code></pre>\n\n<p>The problem is that my real life <code>inner_template</code> method has a consequent number of tags, and I find it quite inelegant (and cumbersome when I must edit it). I also want to keep all the inner-most blocks (my items) on the same page, otherwise I'll end up with dozens of small files and it will be a headache to maintain that.</p>\n\n<p>I am under the impression that, since I can use an helper method which only uses <code>haml_tag</code> methods, there must be a way to make everything work in pure HAML. But I cannot figure out how to do it properly. For instance if I just try the obvious way:</p>\n\n<pre class=\"lang-ruby prettyprint-override\"><code>require 'sinatra'\nrequire 'haml'\n\nget '/' do\n  haml :index\nend\n\n__END__\n\n@@ layout\n%html\n  = yield\n\n@@ index\n%div.div1\n  = haml :inner_template do\n    %span Item 1\n  = haml :inner_template do\n    %span Item 2\n\n@@ inner_template\n%div.title\n  = yield\n</code></pre>\n\n<p>This doesn't work, the inner_template is rendered after its \"inner\" block (as to what exactly yields the value 1, I do not know):</p>\n\n<pre class=\"lang-html prettyprint-override\"><code>&lt;html&gt;\n  &lt;div class='div1'&gt;\n      &lt;span&gt;Item 1&lt;/span&gt;\n  &lt;div class='title'&gt;\n      1\n    &lt;/div&gt;\n      &lt;span&gt;Item 2&lt;/span&gt;\n  &lt;div class='title'&gt;\n      1\n    &lt;/div&gt;\n  &lt;/div&gt;\n&lt;/html&gt;\n</code></pre>\n\n<p>I tried a very long list of hacks, I also tried to use <code>content_for</code> or similar solutions (which only seem to apply to old versions of Sinatra anyway), but I cannot find examples that match my approach (which could be a hint that it's just not possible). And it looks like the block is not passed at all to the HAML renderer when calling <code>haml</code>.</p>\n\n<p>So I would like to know whether or not this can be done in pure HAML (and how, or why not)?</p>\n"}, {"tags": ["ruby", "optimization", "svg", "sprite", "middleman"], "answers": [{"tags": [], "owner": {"reputation": 133, "user_id": 1766334, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/aae16261f0de91d897c3479232f451fe?s=128&d=identicon&r=PG", "display_name": "kylesimmonds", "link": "https://stackoverflow.com/users/1766334/kylesimmonds"}, "is_accepted": false, "score": 2, "last_activity_date": 1440728238, "creation_date": 1440728238, "answer_id": 32262360, "question_id": 31701251, "link": "https://stackoverflow.com/questions/31701251/optimize-svg-and-create-svg-sprite-ruby-middleman/32262360#32262360", "title": "Optimize SVG and create SVG sprite - ruby middleman", "body": "<p>I <em>very</em> recently released a tool for this purporse, except using Nanoc. I haven't used Middleman, but since they're both static-site generators you should be able to fit it to your needs.</p>\n\n<p><a href=\"https://github.com/kylesimmonds/svg_spriter\" rel=\"nofollow\">https://github.com/kylesimmonds/svg_spriter</a></p>\n\n<p>It will take a folder of SVGs, optimize them using <a href=\"https://github.com/fnando/svg_optimizer\" rel=\"nofollow\">svg_optimize</a>, and compile them into a sprite.</p>\n\n<p>A big caveat: it's at the lowest level in production right now, being only a minimally viable product. If you want to start learning more about Ruby and gem creation, I invite you to contribute to the project.</p>\n"}, {"tags": [], "owner": {"reputation": 2192, "user_id": 6028118, "user_type": "registered", "profile_image": "https://graph.facebook.com/10207732365459658/picture?type=large", "display_name": "Krishnamoorthy Acharya", "link": "https://stackoverflow.com/users/6028118/krishnamoorthy-acharya"}, "is_accepted": false, "score": 0, "last_activity_date": 1532687027, "creation_date": 1532687027, "answer_id": 51555963, "question_id": 31701251, "link": "https://stackoverflow.com/questions/31701251/optimize-svg-and-create-svg-sprite-ruby-middleman/51555963#51555963", "title": "Optimize SVG and create SVG sprite - ruby middleman", "body": "<p>Please find the np for the sprite image creator</p>\n\n<p><a href=\"https://www.npmjs.com/package/svg-sprite-generator\" rel=\"nofollow noreferrer\">https://www.npmjs.com/package/svg-sprite-generator</a></p>\n\n<p>npm install -g svg-sprite-generator</p>\n\n<p>Generate sprite by folder name:</p>\n\n<p>svg-sprite-generate -d path/to/directory/of/svg/files -o path/to/sprite.svg</p>\n\n<p>svg-sprite-generate -d svg/ -o sprite.svg</p>\n"}], "owner": {"reputation": 125, "user_id": 1130651, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/pkorN.jpg?s=128&g=1", "display_name": "mhyassin", "link": "https://stackoverflow.com/users/1130651/mhyassin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 452, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1532687027, "creation_date": 1438175042, "question_id": 31701251, "link": "https://stackoverflow.com/questions/31701251/optimize-svg-and-create-svg-sprite-ruby-middleman", "title": "Optimize SVG and create SVG sprite - ruby middleman", "body": "<p>I'm running a middleman application which is based on ruby.\nI have a folder full of SVG files I need to optimize them in order to create an SVG Sprite out of them.</p>\n\n<p>I'm searching for gem that does that but I can't find anything, and I'm a newbie at ruby applications so I can't even know how to do that myself.</p>\n\n<p>Is there anything that can help me?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-4", "activerecord", "jruby"], "comments": [{"owner": {"reputation": 3543, "user_id": 2231236, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/ZyG2H.jpg?s=128&g=1", "display_name": "Nithin", "link": "https://stackoverflow.com/users/2231236/nithin"}, "edited": false, "score": 0, "creation_date": 1438173587, "post_id": 31700604, "comment_id": 51340341, "body": "is <code>type</code> a attribute ?"}, {"owner": {"reputation": 445, "user_id": 4614631, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/f265ae565682c3f4c98ec4a55b2ebc72?s=128&d=identicon&r=PG&f=1", "display_name": "Sulaiman Adeeyo", "link": "https://stackoverflow.com/users/4614631/sulaiman-adeeyo"}, "reply_to_user": {"reputation": 3543, "user_id": 2231236, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/ZyG2H.jpg?s=128&g=1", "display_name": "Nithin", "link": "https://stackoverflow.com/users/2231236/nithin"}, "edited": false, "score": 0, "creation_date": 1438173642, "post_id": 31700604, "comment_id": 51340380, "body": "No. type is a method called in the Rails Framework."}, {"owner": {"reputation": 2545, "user_id": 1808649, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/7OGag.jpg?s=128&g=1", "display_name": "Fran Martinez", "link": "https://stackoverflow.com/users/1808649/fran-martinez"}, "edited": false, "score": 0, "creation_date": 1438174460, "post_id": 31700604, "comment_id": 51340995, "body": "Did you try to create &#39;%&#39;+search before this call?   search = &quot;%#{search}&quot;"}], "answers": [{"comments": [{"owner": {"reputation": 445, "user_id": 4614631, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/f265ae565682c3f4c98ec4a55b2ebc72?s=128&d=identicon&r=PG&f=1", "display_name": "Sulaiman Adeeyo", "link": "https://stackoverflow.com/users/4614631/sulaiman-adeeyo"}, "edited": false, "score": 0, "creation_date": 1438178750, "post_id": 31701224, "comment_id": 51344237, "body": "Can you give an example relative to the User model?"}, {"owner": {"reputation": 445, "user_id": 4614631, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/f265ae565682c3f4c98ec4a55b2ebc72?s=128&d=identicon&r=PG&f=1", "display_name": "Sulaiman Adeeyo", "link": "https://stackoverflow.com/users/4614631/sulaiman-adeeyo"}, "edited": false, "score": 0, "creation_date": 1438271933, "post_id": 31701224, "comment_id": 51393061, "body": "The two looks the same on the documentation page. Could you provide me an example of the ActiveRecord::Querying.find_by_sql?"}, {"owner": {"reputation": 2545, "user_id": 1808649, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/7OGag.jpg?s=128&g=1", "display_name": "Fran Martinez", "link": "https://stackoverflow.com/users/1808649/fran-martinez"}, "reply_to_user": {"reputation": 445, "user_id": 4614631, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/f265ae565682c3f4c98ec4a55b2ebc72?s=128&d=identicon&r=PG&f=1", "display_name": "Sulaiman Adeeyo", "link": "https://stackoverflow.com/users/4614631/sulaiman-adeeyo"}, "edited": false, "score": 0, "creation_date": 1438327161, "post_id": 31701224, "comment_id": 51414710, "body": "I have add you some comments."}], "tags": [], "owner": {"reputation": 2545, "user_id": 1808649, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/7OGag.jpg?s=128&g=1", "display_name": "Fran Martinez", "link": "https://stackoverflow.com/users/1808649/fran-martinez"}, "is_accepted": false, "score": 0, "last_activity_date": 1438327682, "last_edit_date": 1438327682, "creation_date": 1438174977, "answer_id": 31701224, "question_id": 31700604, "link": "https://stackoverflow.com/questions/31700604/rails-4-2-3-activerecord-error/31701224#31701224", "title": "Rails 4.2.3 ActiveRecord Error", "body": "<p>The method <code>ActiveRecord::Base.find_by_sql</code> has been deprecated for this Rails version: \n<a href=\"http://apidock.com/rails/ActiveRecord/Base/find_by_sql/class\" rel=\"nofollow\">http://apidock.com/rails/ActiveRecord/Base/find_by_sql/class</a></p>\n\n<p>You should use <code>ActiveRecord::Querying.find_by_sql</code> as an alternative.\n<a href=\"http://apidock.com/rails/ActiveRecord/Querying/find_by_sql\" rel=\"nofollow\">http://apidock.com/rails/ActiveRecord/Querying/find_by_sql</a></p>\n\n<h2>UPDATE</h2>\n\n<p>I am not really sure about your error, but I recommend you to: </p>\n\n<ol>\n<li><p>See what happens with a simple query example, like <code>select id FROM giftcard_orders</code>, </p></li>\n<li><p>Use directly the module: </p>\n\n<p><code>ActiveRecord::Querying.find_by_sql(['select id FROM giftcard_orders'])</code></p></li>\n<li><p>If this doesn't work, try to check that the find_by_sql method is called. Be careful with this:</p>\n\n<p><code>$&gt; bundle open activerecord</code> go to <code>lib/activerecord/querying.rb</code> and put something to show you that is really using it (maybe a rails logger or a pry)\n<a href=\"https://github.com/rails/rails/blob/v4.2.3/activerecord/lib/active_record/querying.rb\" rel=\"nofollow\">https://github.com/rails/rails/blob/v4.2.3/activerecord/lib/active_record/querying.rb</a></p></li>\n<li><p>If you suspect is an ActiveRecord bug, open an issue on the github Rails repository:</p>\n\n<p><a href=\"https://github.com/rails/rails/issues\" rel=\"nofollow\">https://github.com/rails/rails/issues</a></p></li>\n</ol>\n"}], "owner": {"reputation": 445, "user_id": 4614631, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/f265ae565682c3f4c98ec4a55b2ebc72?s=128&d=identicon&r=PG&f=1", "display_name": "Sulaiman Adeeyo", "link": "https://stackoverflow.com/users/4614631/sulaiman-adeeyo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 404, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1438327682, "creation_date": 1438173434, "question_id": 31700604, "link": "https://stackoverflow.com/questions/31700604/rails-4-2-3-activerecord-error", "title": "Rails 4.2.3 ActiveRecord Error", "body": "<p>All:</p>\n\n<p>I am working on a project using the Ruby-on-Rails Framework. This project was initially based on Rails 4.0.9. I did a Brakeman Vulnerability Scan and I got n \"Medium\" level issue report that 4.0.9 is prone to DoS attack so I upgraded to 4.2.3.</p>\n\n<p>But after the upgrade, I first got an error about \"<em>tzinfo</em>\" Data Source not found so I included the <em>tzinfo-data</em> gem with the platforms specification. That done, then my DB Queries using ActiveRecord Model starts failing whenever I do a method call on the results from the query.</p>\n\n<p><strong>CODE:</strong></p>\n\n<pre><code>query = ['SELECT id, firstname, lastname, status, code FROM giftcard_orders WHERE phone = ? AND description LIKE ? ', phone, '%'+search]\n\n@users = User.find_by_sql(query)\n\nif @users.count &gt; 0\n   @users.each do |user|\n       user[:code] = user[:code].do_decrypt\n   end\nend\n</code></pre>\n\n<p>But immediately after the find_by_sql, I get some errors as below:</p>\n\n<p>Completed 500 Internal Server Error in 685ms (ActiveRecord: 0.0ms)</p>\n\n<p>*</p>\n\n<pre><code>NoMethodError (undefined method `type' for \"int identity(10)\":String):\n  activerecord (4.2.3) lib/active_record/attribute_methods/time_zone_conversion.rb:64:in `create_time_zone_conversion_attribute?'\n  activerecord (4.2.3) lib/active_record/attribute_methods/time_zone_conversion.rb:53:in `inherited'\n  org/jruby/RubyProc.java:290:in `call'\n  org/jruby/RubyProc.java:271:in `call'\n  activerecord (4.2.3) lib/active_record/attribute_decorators.rb:61:in `matching'\n  org/jruby/RubyArray.java:2468:in `select'\n  activerecord (4.2.3) lib/active_record/attribute_decorators.rb:60:in `matching'\n  activerecord (4.2.3) lib/active_record/attribute_decorators.rb:56:in `decorators_for'\n  activerecord (4.2.3) lib/active_record/attribute_decorators.rb:47:in `apply'\n  activerecord (4.2.3) lib/active_record/attribute_decorators.rb:29:in `add_user_provided_columns'\n  org/jruby/RubyArray.java:2399:in `collect'\n  org/jruby/RubyArray.java:2412:in `map'\n  activerecord (4.2.3) lib/active_record/attribute_decorators.rb:28:in `add_user_provided_columns'\n  activerecord (4.2.3) lib/active_record/attributes.rb:93:in `columns'\n  activerecord (4.2.3) lib/active_record/attributes.rb:98:in `columns_hash'\n  C:0:in `columns_hash'\n  activerecord (4.2.3) lib/active_record/relation/query_methods.rb:1067:in `arel_columns'\n  org/jruby/RubyArray.java:2399:in `collect'\n  org/jruby/RubyArray.java:2412:in `map'\n  activerecord (4.2.3) lib/active_record/relation/query_methods.rb:1066:in `arel_columns'\n  activerecord (4.2.3) lib/active_record/relation/query_methods.rb:1059:in `build_select'\n  activerecord (4.2.3) lib/active_record/relation/query_methods.rb:878:in `build_arel'\n  activerecord (4.2.3) lib/active_record/relation/query_methods.rb:858:in `arel'\n  activerecord (4.2.3) lib/active_record/relation/calculations.rb:210:in `perform_calculation'\n  activerecord (4.2.3) lib/active_record/relation/calculations.rb:127:in `calculate'\n  activerecord (4.2.3) lib/active_record/relation/calculations.rb:42:in `count'\n  activerecord (4.2.3) lib/active_record/relation.rb:268:in `empty?'\n  activerecord (4.2.3) lib/active_record/relation.rb:278:in `any?'\n</code></pre>\n\n<p>*</p>\n"}, {"tags": ["ruby", "curl", "rest-client"], "comments": [{"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1438174568, "post_id": 31700425, "comment_id": 51341070, "body": "Could you show some Ruby code? It&#39;s unclear what you are trying to do."}, {"owner": {"reputation": 4071, "user_id": 3806046, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/5fedf50ce7cd2659bca902e9a2969158?s=128&d=identicon&r=PG&f=1", "display_name": "jkeuhlen", "link": "https://stackoverflow.com/users/3806046/jkeuhlen"}, "edited": false, "score": 2, "creation_date": 1438176996, "post_id": 31700425, "comment_id": 51342805, "body": "Welcome to SO! When more information is requested in the comments, it is best to edit your question to add the relevant information so that new viewers will not have to search through the comments to find all they need to help you. Also, if you show some attempt at a solution off the bat, more people will be inclined to give a helping hand."}, {"owner": {"reputation": 2322, "user_id": 3088748, "user_type": "registered", "accept_rate": 63, "profile_image": "https://graph.facebook.com/544821277/picture?type=large", "display_name": "AJFaraday", "link": "https://stackoverflow.com/users/3088748/ajfaraday"}, "edited": false, "score": 0, "creation_date": 1438177309, "post_id": 31700425, "comment_id": 51343031, "body": "This is an example which grabs the content of a url: <a href=\"https://www.codecademy.com/courses/ruby-beginner-en-pEdhY/0/1?curriculum_id=5122d839c0a131c35f00013d\" rel=\"nofollow noreferrer\">codecademy.com/courses/ruby-beginner-en-pEdhY/0/&hellip;</a> combining this with the docs for OpenURI (<a href=\"http://ruby-doc.org/stdlib-2.1.5/libdoc/open-uri/rdoc/OpenURI.html\" rel=\"nofollow noreferrer\">ruby-doc.org/stdlib-2.1.5/libdoc/open-uri/rdoc/OpenURI.html</a>&zwnj;&#8203;) may yield the results you want."}, {"owner": {"reputation": 1756, "user_id": 295671, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/0fc94068a4be0dd57d34a223722f2690?s=128&d=identicon&r=PG", "display_name": "james246", "link": "https://stackoverflow.com/users/295671/james246"}, "edited": false, "score": 0, "creation_date": 1438177348, "post_id": 31700425, "comment_id": 51343071, "body": "@the_bear What is the error you are getting?"}, {"owner": {"reputation": 1, "user_id": 5169373, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Fbpxy.jpg?s=128&g=1", "display_name": "the_bear", "link": "https://stackoverflow.com/users/5169373/the-bear"}, "edited": false, "score": 1, "creation_date": 1438177734, "post_id": 31700425, "comment_id": 51343387, "body": "no answer, time out. But the curl works well."}, {"owner": {"reputation": 951, "user_id": 4003753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/E8P02.jpg?s=128&g=1", "display_name": "dreamingblackcat", "link": "https://stackoverflow.com/users/4003753/dreamingblackcat"}, "edited": false, "score": 0, "creation_date": 1438231104, "post_id": 31700425, "comment_id": 51367972, "body": "<a href=\"http://stackoverflow.com/questions/3692574/how-do-i-do-basic-authentication-with-restclient\" title=\"how do i do basic authentication with restclient\">stackoverflow.com/questions/3692574/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 5170988, "user_type": "registered", "profile_image": "https://graph.facebook.com/882606101777068/picture?type=large", "display_name": "Pratham Alag", "link": "https://stackoverflow.com/users/5170988/pratham-alag"}, "is_accepted": false, "score": 0, "last_activity_date": 1438205953, "creation_date": 1438205953, "answer_id": 31711644, "question_id": 31700425, "link": "https://stackoverflow.com/questions/31700425/how-to-convert-curl-code-to-ruby/31711644#31711644", "title": "How to convert curl code to ruby", "body": "<p>Try to use a library like curb or curb-fu. They are pretty cool gems and the documentation makes them pretty easy to use.</p>\n"}], "owner": {"reputation": 1, "user_id": 5169373, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Fbpxy.jpg?s=128&g=1", "display_name": "the_bear", "link": "https://stackoverflow.com/users/5169373/the-bear"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 284, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1438205953, "creation_date": 1438172991, "last_edit_date": 1438177252, "question_id": 31700425, "link": "https://stackoverflow.com/questions/31700425/how-to-convert-curl-code-to-ruby", "title": "How to convert curl code to ruby", "body": "<p>I'm in trouble to convert the curl code below to ruby using Rest-Client library. </p>\n\n<p>curl code: </p>\n\n<pre><code>curl https://my_url -u user_token: -F \"data[price]=$ 100,00\"\n</code></pre>\n\n<p>Ruby code that I tried without success: </p>\n\n<pre><code>request = RestClient.new 'https://my_url', user: user_token, password: pwd\n\nrequest.post :data =&gt; { :price =&gt; '$ 100,00' }, :multipart =&gt; true, :verify_ssl =&gt; true \n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "rspec", "gem", "factory-bot"], "comments": [{"owner": {"reputation": 109029, "user_id": 2767755, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/BkC8q.jpg?s=128&g=1", "display_name": "Arup Rakshit", "link": "https://stackoverflow.com/users/2767755/arup-rakshit"}, "edited": false, "score": 2, "creation_date": 1438172961, "post_id": 31700345, "comment_id": 51339899, "body": "Ahh! good to see some specs,, :)"}, {"owner": {"reputation": 15775, "user_id": 634513, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/328293e03f2d7b888ecf197ec1ffb7a7?s=128&d=identicon&r=PG", "display_name": "Ismael Abreu", "link": "https://stackoverflow.com/users/634513/ismael-abreu"}, "edited": false, "score": 0, "creation_date": 1441882041, "post_id": 31700345, "comment_id": 52858937, "body": "Although it may be possible. It&#39;s questionable if you should share the specs. You should only use what the gem provides. And the specs should be for your application so you shouldn&#39;t need the factories."}], "answers": [{"comments": [{"owner": {"reputation": 2545, "user_id": 1808649, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/7OGag.jpg?s=128&g=1", "display_name": "Fran Martinez", "link": "https://stackoverflow.com/users/1808649/fran-martinez"}, "edited": false, "score": 3, "creation_date": 1452851514, "post_id": 32499634, "comment_id": 57358937, "body": "<code>Dir[File.join(GEM_ROOT, &#39;spec&#39;, &#39;factories&#39;, &#39;**&#39;,&#39;*.rb&#39;)].each { |file| require(file) } </code>   This will include factories in subfolders as well"}, {"owner": {"reputation": 569, "user_id": 1770571, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LM82B.jpg?s=128&g=1", "display_name": "Salma Gomaa", "link": "https://stackoverflow.com/users/1770571/salma-gomaa"}, "edited": false, "score": 0, "creation_date": 1562831720, "post_id": 32499634, "comment_id": 100503540, "body": "GEM_ROOT = Gem.loaded_specs[gem_name].full_gem_path"}], "tags": [], "owner": {"reputation": 1221, "user_id": 169595, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/de57f32fba414151a49f92fe3b3bc8d7?s=128&d=identicon&r=PG", "display_name": "RngTng", "link": "https://stackoverflow.com/users/169595/rngtng"}, "is_accepted": false, "score": 12, "last_activity_date": 1441881655, "creation_date": 1441881655, "answer_id": 32499634, "question_id": 31700345, "link": "https://stackoverflow.com/questions/31700345/how-can-i-share-the-factories-that-i-have-in-a-gem-and-use-it-in-other-project/32499634#32499634", "title": "How can I share the factories that I have in a GEM and use it in other project?", "body": "<p>The problem is that you probably don't expose the spec folder (and herewith the factories) in the load path. Which, in general, is the right thing to do. Check you <code>*.gemspec</code>, you probably have something like:</p>\n\n<pre><code>s.require_paths = [\"lib\"]\n</code></pre>\n\n<p>This means only files under the <code>lib</code> directory can be required by other projects using your gem. See <a href=\"http://guides.rubygems.org/specification-reference/#require_paths=\">http://guides.rubygems.org/specification-reference/#require_paths=</a></p>\n\n<p>So to solve your problem, you'd need to place a file inside the <code>lib</code> folder which 'knowns' where your factories are and requires those. So in you case, create a file <code>lib/&lt;your gem name&gt;/factories.rb</code> and add:</p>\n\n<pre><code>GEM_ROOT = File.dirname(File.dirname(File.dirname(__FILE__)))\n\nDir[File.join(GEM_ROOT, 'spec', 'factories', '*.rb')].each { |file| require(file) }\n</code></pre>\n\n<p>In the other Project load the factories with:</p>\n\n<p><code>require '&lt;your gem name&gt;/factories'</code></p>\n\n<p>Works fine for me. The only thing I havn't figured out yet is how to namespace your factories. Not sure if factory girl allows this.</p>\n"}, {"tags": [], "owner": {"reputation": 4477, "user_id": 703903, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/91ffc6b42d4813fdff4f101d00181744?s=128&d=identicon&r=PG", "display_name": "odlp", "link": "https://stackoverflow.com/users/703903/odlp"}, "is_accepted": true, "score": 6, "last_activity_date": 1525951601, "creation_date": 1525951601, "answer_id": 50271876, "question_id": 31700345, "link": "https://stackoverflow.com/questions/31700345/how-can-i-share-the-factories-that-i-have-in-a-gem-and-use-it-in-other-project/50271876#50271876", "title": "How can I share the factories that I have in a GEM and use it in other project?", "body": "<p>An alternative to <code>require</code>-ing each factory file as suggested in the other answer, is to update the <code>FactoryBot.definition_file_paths</code> configuration.</p>\n\n<h2>In your gem defining the factories:</h2>\n\n<p>Create a file which will resolve the factory path:</p>\n\n<pre><code># lib/my_gem/test_support.rb\n\nmodule MyGem\n  module TestSupport\n    FACTORY_PATH = File.expand_path(\"../../spec/factories\", __dir__)\n  end\nend\n</code></pre>\n\n<h2>In you app / gem using the factories from the other gem:</h2>\n\n<pre><code># spec/spec_helper.rb or similar\n\nrequire \"my_gem/test_support\"\n\nFactoryBot.definition_file_paths = [\n  MyGem::TestSupport::FACTORY_PATH,\n  # Any other paths you want to add e.g.\n  # Rails.root.join(\"spec\", \"factories\")\n]\n\nFactoryBot.find_definitions\n</code></pre>\n\n<p>The advantage of the <code>definition_file_paths</code> solution is that other functionality like <code>FactoryBot.reload</code> will work as intended.</p>\n"}], "owner": {"reputation": 4631, "user_id": 1080046, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/trbrs.png?s=128&g=1", "display_name": "Eki Eqbal", "link": "https://stackoverflow.com/users/1080046/eki-eqbal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2457, "favorite_count": 5, "accepted_answer_id": 50271876, "answer_count": 2, "score": 18, "last_activity_date": 1525951601, "creation_date": 1438172733, "question_id": 31700345, "link": "https://stackoverflow.com/questions/31700345/how-can-i-share-the-factories-that-i-have-in-a-gem-and-use-it-in-other-project", "title": "How can I share the factories that I have in a GEM and use it in other project?", "body": "<p>I have a gem that includes some Factories. The gem looks something like: </p>\n\n<pre><code>.\n\u251c\u2500\u2500 Gemfile\n\u251c\u2500\u2500 Gemfile.lock\n\u251c\u2500\u2500 README.md\n\u251c\u2500\u2500 Rakefile\n\u251c\u2500\u2500 db\n\u251c\u2500\u2500 lib\n\u2502   \u251c\u2500\u2500 models\n\u2502   \u2502   \u251c\u2500\u2500 users.rb\n\u251c\u2500\u2500 pkg\n\u251c\u2500\u2500 core.gemspec\n\u251c\u2500\u2500 spec\n\u2502   \u251c\u2500\u2500 factories\n\u2502   \u2502   \u2514\u2500\u2500 users.rb\n\u2502   \u251c\u2500\u2500 fixtures\n\u2502   \u251c\u2500\u2500 helpers\n\u2502   \u251c\u2500\u2500 integration\n\u2502   \u251c\u2500\u2500 spec_helper.rb\n\u2502   \u251c\u2500\u2500 support\u2502   \u2502 \n\u2502   \u2514\u2500\u2500 unit\n\u2502       \u2514\u2500\u2500 users_spec.rb\n\u2514\u2500\u2500 tasks\n</code></pre>\n\n<p>Now i'm using the gem in another Ruby project (Grape) by adding something like <code>gem 'core', git: 'https://url.git'</code>. </p>\n\n<p>Now everything is working fine as I can use <code>User</code> model from Grape project. </p>\n\n<p>However I want to use the factories (<code>users</code>) so I can write further integration tests for Grape project. </p>\n\n<p>In Grape project, in <code>spec_helper.rb</code> it looks like: </p>\n\n<pre><code>require 'rubygems'\nrequire 'bundler/setup'\nBundler.require(:default, :development)\n\nENV['RACK_ENV'] ||= 'test'\n\nrequire 'rack/test'\n\nrequire File.expand_path('../../config/environment', __FILE__)\n\nRSpec.configure do |config|\n  config.mock_with :rspec\n  config.expect_with :rspec\n  config.raise_errors_for_deprecations!\n  config.include FactoryGirl::Syntax::Methods\nend\n\nrequire 'capybara/rspec'\nCapybara.configure do |config|\n  config.app = Test::App.new\n  config.server_port = 9293\nend\n</code></pre>\n\n<p>Now my test 'users_spec.rb' looks like: </p>\n\n<pre><code>require 'spec_helper'\n\ndescribe App::UsersController do\n  include Rack::Test::Methods\n\n  def app\n    App::API\n  end\n\n  describe \"/users/me\" do\n    context \"with invalid access token\" do\n      before(:each) do\n        get \"/api/v2/users/me\"\n        user = build(:user)\n      end      \n\n      it 'returns 401 error code' do\n        expect(last_response.status).to eq(401)\n        expect(user).to eq(nil)\n      end\n    end    \n  end\nend\n</code></pre>\n\n<p>Now when I try to run the test using <code>rspec spec/api/users_spec.rb</code> I get : </p>\n\n<p>I keep getting this error: </p>\n\n<pre><code> Failure/Error: user = build(:user)\n ArgumentError:\n   Factory not registered: user\n</code></pre>\n\n<p>Any help would be appreciated as I've been struggling for this. </p>\n"}, {"tags": ["ruby-on-rails", "ruby", "rspec", "capybara"], "comments": [{"owner": {"reputation": 1785, "user_id": 3373470, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/8f968c218643a09267014e4beaeb4770?s=128&d=identicon&r=PG&f=1", "display_name": "onebree", "link": "https://stackoverflow.com/users/3373470/onebree"}, "edited": false, "score": 0, "creation_date": 1438174077, "post_id": 31700266, "comment_id": 51340697, "body": "(1) Given by your first paragraph, classes in Ruby are UpperCamelCase. (2) It looks like you are repeating yourself in your test. Try doing <code>within &#39;#timeline-event_modal&#39; do</code>, followed by the related events (fill_in, check). (3) When using Capybara, you should not need to use <code>sleep 1</code>. Instead, try something like <code>wait: 3</code>. The default wait time is 2 seconds. Only some methods accept the <code>wait</code> option."}, {"owner": {"reputation": 569, "user_id": 3770055, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/f6dae6771242b5d2dfc9f692a71cc0f5?s=128&d=identicon&r=PG&f=1", "display_name": "Zoinks10", "link": "https://stackoverflow.com/users/3770055/zoinks10"}, "reply_to_user": {"reputation": 1785, "user_id": 3373470, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/8f968c218643a09267014e4beaeb4770?s=128&d=identicon&r=PG&f=1", "display_name": "onebree", "link": "https://stackoverflow.com/users/3373470/onebree"}, "edited": false, "score": 0, "creation_date": 1438176904, "post_id": 31700266, "comment_id": 51342729, "body": "Thanks. I if use <code>wait: 3</code> I get a syntax error, the code is expecting an <code>end</code>. If I use <code>wait 3</code> then the Rspec test says it&#39;s an undefined method. I use sleep effectively in other Capybara tests like this, and it was originally failing without that (i.e. it wasn&#39;t waiting for the Modal to appear and was missing the content). <code>Sleep 1</code> is long enough for the fields to appear and those element.find tests to pass."}, {"owner": {"reputation": 1785, "user_id": 3373470, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/8f968c218643a09267014e4beaeb4770?s=128&d=identicon&r=PG&f=1", "display_name": "onebree", "link": "https://stackoverflow.com/users/3373470/onebree"}, "edited": false, "score": 0, "creation_date": 1438179688, "post_id": 31700266, "comment_id": 51344997, "body": "Like I said, the <code>wait</code> option does not apply to all Capybara methods. I use it, for example, when doing <code>page.accept_confirm(wait: 3) { click_link &#39;Delete&#39; }</code> to click a delete link that triggers a modal that asks &quot;are you sure?&quot; When using capybara for feature tests, you may find it helpful to use its DSL to the max, like using <code>scenario</code> to mark each example. I recommend reading up on the Github page docs more, too"}, {"owner": {"reputation": 569, "user_id": 3770055, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/f6dae6771242b5d2dfc9f692a71cc0f5?s=128&d=identicon&r=PG&f=1", "display_name": "Zoinks10", "link": "https://stackoverflow.com/users/3770055/zoinks10"}, "reply_to_user": {"reputation": 1785, "user_id": 3373470, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/8f968c218643a09267014e4beaeb4770?s=128&d=identicon&r=PG&f=1", "display_name": "onebree", "link": "https://stackoverflow.com/users/3373470/onebree"}, "edited": false, "score": 0, "creation_date": 1438181702, "post_id": 31700266, "comment_id": 51346570, "body": "Thanks for the assistance. Any ideas why my factories/test DB won&#39;t accept the newly inserted timeline_event in this case? I was having a similar issue with the model spec, and my factory was the issue there (I needed to call sales_opportunity.reload to get that working) so I get the impression that these Factories don&#39;t work well when recycled through multiple tests. (BTW, sales_opportunity.reload doesn&#39;t work here)."}, {"owner": {"reputation": 1785, "user_id": 3373470, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/8f968c218643a09267014e4beaeb4770?s=128&d=identicon&r=PG&f=1", "display_name": "onebree", "link": "https://stackoverflow.com/users/3373470/onebree"}, "edited": false, "score": 0, "creation_date": 1438182579, "post_id": 31700266, "comment_id": 51347245, "body": "Unfortunately I cannot help that much further. You may want to read documentation on all related gems/technologies before proceeding?"}, {"owner": {"reputation": 569, "user_id": 3770055, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/f6dae6771242b5d2dfc9f692a71cc0f5?s=128&d=identicon&r=PG&f=1", "display_name": "Zoinks10", "link": "https://stackoverflow.com/users/3770055/zoinks10"}, "reply_to_user": {"reputation": 1785, "user_id": 3373470, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/8f968c218643a09267014e4beaeb4770?s=128&d=identicon&r=PG&f=1", "display_name": "onebree", "link": "https://stackoverflow.com/users/3373470/onebree"}, "edited": false, "score": 1, "creation_date": 1438183667, "post_id": 31700266, "comment_id": 51348048, "body": "No problem, I appreciate your help, especially with the DRYing up of my code (which is almost certainly its biggest weakness). I&#39;ll find the answer somehow, it&#39;s just annoying when you hit a day-long brick wall like this and are trying to learn it on your own."}, {"owner": {"reputation": 1785, "user_id": 3373470, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/8f968c218643a09267014e4beaeb4770?s=128&d=identicon&r=PG&f=1", "display_name": "onebree", "link": "https://stackoverflow.com/users/3373470/onebree"}, "edited": false, "score": 0, "creation_date": 1438184228, "post_id": 31700266, "comment_id": 51348527, "body": "I suggest visiting the Ruby chat room for any additional help. They are great !"}, {"owner": {"reputation": 42014, "user_id": 2709090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/238c2b7cde2c817fc9a5a2b8eaa2ffad?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Walpole", "link": "https://stackoverflow.com/users/2709090/thomas-walpole"}, "edited": false, "score": 0, "creation_date": 1438188432, "post_id": 31700266, "comment_id": 51351244, "body": "If the timeline_events is empty it would imply that either the form isn&#39;t submitting or its failing validations when attempting to save -- what do your test logs show as far as the submission after &#39;Save&#39; is pressed?  - Note that your expect(current_path).to eq(sales_opportunity_path(sales_opportunity)) line isn&#39;t actually doing anything since you&#39;re on that path when you click &#39;Save&#39; and the expectation doesn&#39;t wait for anything so it can possibly be executed before the &#39;Save&#39; click causes any change to the url"}, {"owner": {"reputation": 569, "user_id": 3770055, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/f6dae6771242b5d2dfc9f692a71cc0f5?s=128&d=identicon&r=PG&f=1", "display_name": "Zoinks10", "link": "https://stackoverflow.com/users/3770055/zoinks10"}, "edited": false, "score": 0, "creation_date": 1438223135, "post_id": 31700266, "comment_id": 51365930, "body": "Thanks Tom - you&#39;re right, for some reason the Activity field is being found by Capybara, but the &#39;Sign the contract&#39; text is not being passed through to the controller. I&#39;ll see whether I can work out why this is happening. Do you have a solution for the path expectation test? Could I test for whether or not the server responds successfully to the AJAX call?"}, {"owner": {"reputation": 569, "user_id": 3770055, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/f6dae6771242b5d2dfc9f692a71cc0f5?s=128&d=identicon&r=PG&f=1", "display_name": "Zoinks10", "link": "https://stackoverflow.com/users/3770055/zoinks10"}, "edited": false, "score": 0, "creation_date": 1438225505, "post_id": 31700266, "comment_id": 51366574, "body": "Tom - fantastic; I solved the problem by being more specific with the Capybara targeting of DOM elements. Thanks for your help - if you want to add that as an answer I&#39;d be happy to select it as the solution. Cheers!"}], "owner": {"reputation": 569, "user_id": 3770055, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/f6dae6771242b5d2dfc9f692a71cc0f5?s=128&d=identicon&r=PG&f=1", "display_name": "Zoinks10", "link": "https://stackoverflow.com/users/3770055/zoinks10"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 333, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1438176015, "creation_date": 1438172489, "last_edit_date": 1438176015, "question_id": 31700266, "link": "https://stackoverflow.com/questions/31700266/why-isnt-my-rspec-feature-test-using-capybara-to-add-an-item-to-the-test-databa", "title": "Why isn&#39;t my Rspec Feature test using Capybara to add an item to the test database collection?", "body": "<p>I have a page in my app for Sales_Opportunities. These have_many Timeline_Events, which can be added via a Bootstrap modal on the Sales_Opportunity page. It actually works in the real-world app (using the localhost server on my machine I can get the feature working), but the test itself does not - and when I use Byebug it's clear the sales_opportunity.timeline_events array is empty.</p>\n\n<p>My Sales Opportunity Spec:</p>\n\n<pre><code>describe 'the Sales Opportunity view', :type =&gt; :feature do\n  let(:company) {FactoryGirl.create(:company, :with_users)}\n  let(:user) {company.organization.users.first}\n  let!(:sales_opportunity) { FactoryGirl.create(:sales_opportunity, user: user, company: company )}\n\n  describe 'the Sales Opportunity details view' do\n    before(:each) do\n      sign_in user\n      visit sales_opportunity_path(sales_opportunity)\n    end\n\n    it 'has links to add a timeline event' do\n      expect(page).to have_link('Add new task')\n    end\n\n    it 'adds a new timeline event', js: true do\n      page.click_link('Add new task')\n      sleep 1\n      page.find('#timeline-event_modal').fill_in('Activity', with: \"Sign the contract\")\n      page.find('#timeline-event_modal').fill_in('Due date', with: \"2014/10/15\")\n      page.find('#timeline-event_modal').check \"Completed\"\n      page.find('#timeline-event_modal').fill_in('timeline_event_event_notes', with: \"Some example notes\")\n      page.find('#timeline-event_modal').click_button('Save')\n      expect(current_path).to eq(sales_opportunity_path(sales_opportunity))\n      byebug\n      expect(page).to have_content('Sign the contract')\n      expect(page).to have_content('2014-10-15')\n      expect(page).to have_content('Yes')\n      expect(page).to have_content('Some example notes')\n    end\n  end\n</code></pre>\n\n<p>Factory girl code (Company):</p>\n\n<pre><code>FactoryGirl.define do\n  factory :company do\n    company_name            \"Test Company\"\n    existing_customer       \"False\"\n\n    trait :with_users do\n      association           :organization, :with_users\n    end \n  end\nend\n</code></pre>\n\n<p>Factory (Organization):</p>\n\n<pre><code>FactoryGirl.define do\n  sequence(:organization_name) { |n| \"Organization - #{n}\" }\n\n  factory :organization do\n    organization_name { generate(:organization_name) }\n\n    trait :with_users do\n      before(:create) do |organization|\n        organization.users &lt;&lt; FactoryGirl.build(:user)\n        organization.users &lt;&lt; FactoryGirl.build(:user, name: \"Second User\", email: \"email2@example.com\")\n      end\n    end\n  end\nend\n</code></pre>\n\n<p>Factory for Sales Opportunity:</p>\n\n<pre><code>FactoryGirl.define do\n  sequence(:opportunity_name)    { |n| \"Sales Oppotunity - #{n}\" }\n\n  factory :sales_opportunity do\n    user\n    opportunity_name     { generate(:opportunity_name) }\n    close_date           \"2014/12/12\"\n    sale_value           10000\n    company_id           7\n  end\nend\n</code></pre>\n\n<p>I can include the Controller and View code if it helps, but as mentioned the code actually works in the app on the development server (timeline event is updated and inserted into a table on the sales_opportunity show page) so it's something to do with the way I've set up my tests, set up my factories, or my misunderstanding of the way this works.</p>\n\n<p>For reference I have other code that works exactly the same way on other views, with factories and rspec tests that give positive results. </p>\n\n<p>Byebug output from the break above:</p>\n\n<pre><code>(byebug) sales_opportunity\n#&lt;SalesOpportunity id: 2535, close_date: \"2014-12-12 00:00:00\", user_id: 22124, created_at: \"2015-07-29 12:06:35\", updated_at: \"2015-07-29 12:06:35\", pipeline_status: 0, opportunity_name: \"Sales Oppotunity - 15\", company_id: 7650, sale_value: #&lt;BigDecimal:7ffbbfe2e7b8,'0.1E5',9(27)&gt;, swot_score: 0&gt;\n\n(byebug) company\n#&lt;Company id: 7650, company_name: \"Test Company\", existing_customer: false, created_at: \"2015-07-29 12:06:35\", updated_at: \"2015-07-29 12:06:35\", organization_id: 34613&gt;\n\n(byebug) sales_opportunity.timeline_events\n#&lt;ActiveRecord::Associations::CollectionProxy []&gt;\n\n(byebug) user\n#&lt;User id: 22124, name: \"Test user 124\", email: \"test.user124@example.com\", created_at: \"2015-07-29 12:06:35\", updated_at: \"2015-07-29 12:06:35\", password_digest: \"$2a$04$bRkyvW1g9NtC9x4Skyicme6YDUUxDxA6Eg2iPoT9Xsy...\", organization_id: 34613, remember_token: \"47307ea19e1a63cf2ebdcc6a2cf8f763aef1561b\", admin: false, password_reset_token: nil, password_reset_sent_at: nil&gt;\n</code></pre>\n\n<p>I get the following error from the rspec run:</p>\n\n<pre><code>Failure/Error: expect(page).to have_content('Sign the contract')\nRspec then lists the items on my page until the timeline_events table:\nNo data available in table Showing 0 to 0 of 0\n</code></pre>\n\n<p>So it's clear that the array is still empty once the \"Save\" button is clicked and we return to the sales_opportunity page in the test suite.</p>\n\n<p>Any idea what I'm doing wrong or how I could clean up my Factories/tests to get this working? Or is there another alternative way to ensure the functionality works without this type of test?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ubuntu", "ruby-on-rails-4", "ubuntu-14.04"], "comments": [{"owner": {"reputation": 25, "user_id": 3301847, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/114e0d2b64121048ea130923b4193ee0?s=128&d=identicon&r=PG&f=1", "display_name": "user3301847", "link": "https://stackoverflow.com/users/3301847/user3301847"}, "edited": false, "score": 0, "creation_date": 1438171386, "post_id": 31699690, "comment_id": 51338815, "body": "Can anybody help with this?"}, {"owner": {"reputation": 9323, "user_id": 1047207, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/2U8wC.jpg?s=128&g=1", "display_name": "RAJ", "link": "https://stackoverflow.com/users/1047207/raj"}, "edited": false, "score": 0, "creation_date": 1438171445, "post_id": 31699690, "comment_id": 51338851, "body": "Paste complete backtrace of error."}, {"owner": {"reputation": 25, "user_id": 3301847, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/114e0d2b64121048ea130923b4193ee0?s=128&d=identicon&r=PG&f=1", "display_name": "user3301847", "link": "https://stackoverflow.com/users/3301847/user3301847"}, "reply_to_user": {"reputation": 9323, "user_id": 1047207, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/2U8wC.jpg?s=128&g=1", "display_name": "RAJ", "link": "https://stackoverflow.com/users/1047207/raj"}, "edited": false, "score": 0, "creation_date": 1438171503, "post_id": 31699690, "comment_id": 51338897, "body": "@RAJ  /usr/bin/env: ruby: No such file or directory. This is what I get to my cron.log file."}, {"owner": {"reputation": 9323, "user_id": 1047207, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/2U8wC.jpg?s=128&g=1", "display_name": "RAJ", "link": "https://stackoverflow.com/users/1047207/raj"}, "edited": false, "score": 0, "creation_date": 1438171531, "post_id": 31699690, "comment_id": 51338920, "body": "Are you using rvm? If yes, what is the output of <code>rvm list</code>"}, {"owner": {"reputation": 25, "user_id": 3301847, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/114e0d2b64121048ea130923b4193ee0?s=128&d=identicon&r=PG&f=1", "display_name": "user3301847", "link": "https://stackoverflow.com/users/3301847/user3301847"}, "reply_to_user": {"reputation": 9323, "user_id": 1047207, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/2U8wC.jpg?s=128&g=1", "display_name": "RAJ", "link": "https://stackoverflow.com/users/1047207/raj"}, "edited": false, "score": 0, "creation_date": 1438171618, "post_id": 31699690, "comment_id": 51338991, "body": "@RAJ I&#39;m using rbenv"}, {"owner": {"reputation": 9323, "user_id": 1047207, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/2U8wC.jpg?s=128&g=1", "display_name": "RAJ", "link": "https://stackoverflow.com/users/1047207/raj"}, "edited": false, "score": 0, "creation_date": 1438171840, "post_id": 31699690, "comment_id": 51339153, "body": "Is your application running okay? Post output of <code>which ruby</code> &amp; <code>whereis ruby</code>"}, {"owner": {"reputation": 9323, "user_id": 1047207, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/2U8wC.jpg?s=128&g=1", "display_name": "RAJ", "link": "https://stackoverflow.com/users/1047207/raj"}, "edited": false, "score": 0, "creation_date": 1438171941, "post_id": 31699690, "comment_id": 51339224, "body": "Try <code>set :default_env, { path: &quot;~&#47;.rbenv&#47;shims:~&#47;.rbenv&#47;bin:$PATH&quot; }</code>"}], "owner": {"reputation": 25, "user_id": 3301847, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/114e0d2b64121048ea130923b4193ee0?s=128&d=identicon&r=PG&f=1", "display_name": "user3301847", "link": "https://stackoverflow.com/users/3301847/user3301847"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 229, "favorite_count": 1, "answer_count": 0, "score": 1, "last_activity_date": 1438170759, "creation_date": 1438170759, "question_id": 31699690, "link": "https://stackoverflow.com/questions/31699690/whenever-gem-cron-job-error-ubuntu-rails", "title": "Whenever gem cron job error Ubuntu Rails", "body": "<p>I'm trying to schedule activejob with Whenever gem.</p>\n\n<pre><code>set :output, \"#{path}/log/cron.log\"\nevery 5.minutes do\n  runner 'TestJob.perform_now', :environment =&gt; 'development' \nend\n</code></pre>\n\n<p>By I get error, and don\u2019t know how to fix it. I run project on Ubuntu system.</p>\n\n<p><strong>error</strong></p>\n\n<pre><code>/usr/bin/env: ruby: No such file or directory\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "json", "ruby-on-rails-4", "rspec"], "comments": [{"owner": {"reputation": 811, "user_id": 325642, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0690149664b3a2e0c0776107de646769?s=128&d=identicon&r=PG", "display_name": "David Bella", "link": "https://stackoverflow.com/users/325642/david-bella"}, "edited": false, "score": 0, "creation_date": 1447191116, "post_id": 31699685, "comment_id": 55053998, "body": "Hello rico_mac - You mention that you are using jbuilder for your json views. It looks like you have <code>:json</code> in your formats, but you don&#39;t have <code>:jbuilder</code> in your handlers. Have you ensured that your engine has jbuilder as a dependency and that it is being required properly?"}], "answers": [{"tags": [], "owner": {"reputation": 422, "user_id": 4158525, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000883584513/picture?type=large", "display_name": "dharmesh", "link": "https://stackoverflow.com/users/4158525/dharmesh"}, "is_accepted": false, "score": 1, "last_activity_date": 1562326190, "creation_date": 1562326190, "answer_id": 56902247, "question_id": 31699685, "link": "https://stackoverflow.com/questions/31699685/rails-engines-and-jbuilder-view-tests/56902247#56902247", "title": "Rails Engines and jbuilder view tests", "body": "<p>Any gem you add as a dependency for your rails engine, You need to require the gem in your gem module declaration. </p>\n\n<p>Example:</p>\n\n<p>Location : <code>engine_root/lib/module_name.rb</code></p>\n\n<pre><code>require \"module_name/engine\"\nrequire 'mongoid'\nrequire 'jbuilder'\nmodule module_name\n  # Your code goes here...\nend\n</code></pre>\n"}], "owner": {"reputation": 800, "user_id": 3290423, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/cf08b4a89aa05d600469502f103c187a?s=128&d=identicon&r=PG&f=1", "display_name": "rico_mac", "link": "https://stackoverflow.com/users/3290423/rico-mac"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 296, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1562326190, "creation_date": 1438170747, "question_id": 31699685, "link": "https://stackoverflow.com/questions/31699685/rails-engines-and-jbuilder-view-tests", "title": "Rails Engines and jbuilder view tests", "body": "<p>I am building a rails engine that handles a search functionality in my app. </p>\n\n<p>Originally, it was built as a controller concern in an existing app with an associated <a href=\"http://api.rubyonrails.org/classes/ActionDispatch/Routing/Mapper/Concerns.html\" rel=\"nofollow\">routing concern</a> and json views. This has now been extracted into an engine without ActiveRecord which I hope to able to mount on other apps.</p>\n\n<p>Whether the above is any use to the question I am not sure.</p>\n\n<p>I would like to test my json files (constructed via jbuilder) but am having trouble marrying the specs with the app.</p>\n\n<p>I can't seem to get past this error </p>\n\n<pre><code>  1) views/api/search/feed.json should render without error\n     Failure/Error: render\n     ActionView::MissingTemplate:\n       Missing template views/api/search/feed with {:locale=&gt;[:en], :formats=&gt;[:html, :text, :js, :css, :ics, :csv, :vcf, :png, :jpeg, :gif, :bmp, :tiff, :mpeg, :xml, :rss, :atom, :yaml, :multipart_form, :url_encoded_form, :json, :pdf, :zip], :variants=&gt;[], :handlers=&gt;[\"json\"]}. Searched in:\n         * \"/Users/***/projects/morse_searchable/spec/dummy/app/views\"\n         * \"/Users/***/projects/morse_searchable/app/views\"\n</code></pre>\n\n<p>I feel it could be a number of issues, which one I am not sure.</p>\n\n<ul>\n<li>Am I testing the engine in the right place? </li>\n<li>In the process of removing Active Record have I messed something up?</li>\n<li>Is this how we normally test json files, let alone json files in engines?</li>\n</ul>\n\n<p>For extra info I've added a <a href=\"http://pastebin.com/tky7hLQt\" rel=\"nofollow\">pastebin link to the current folder structure</a> should that shed any light on the issue.</p>\n\n<p>Any guidance is greatly appreciated.</p>\n\n<p>(using rails 4 and rspec)</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 38307, "user_id": 2057388, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ceef8c04f66cd0e2bd360ef6abc14a81?s=128&d=identicon&r=PG", "display_name": "\u0417\u0435\u043b\u0451\u043d\u044b\u0439", "link": "https://stackoverflow.com/users/2057388/%d0%97%d0%b5%d0%bb%d1%91%d0%bd%d1%8b%d0%b9"}, "edited": false, "score": 2, "creation_date": 1438169476, "post_id": 31699157, "comment_id": 51337503, "body": "What kind of help you want? Write code? Reference for read?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4865423"}, "reply_to_user": {"reputation": 38307, "user_id": 2057388, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ceef8c04f66cd0e2bd360ef6abc14a81?s=128&d=identicon&r=PG", "display_name": "\u0417\u0435\u043b\u0451\u043d\u044b\u0439", "link": "https://stackoverflow.com/users/2057388/%d0%97%d0%b5%d0%bb%d1%91%d0%bd%d1%8b%d0%b9"}, "edited": false, "score": 0, "creation_date": 1438169810, "post_id": 31699157, "comment_id": 51337712, "body": "It could be a piece of code, it could be a reference for read - I&#39;d appreciate any help, I just don&#39;t know how to do it."}, {"owner": {"reputation": 489, "user_id": 1303501, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d44af6531fbd70f0c0df5dce8b83f72?s=128&d=identicon&r=PG", "display_name": "Glupo", "link": "https://stackoverflow.com/users/1303501/glupo"}, "edited": false, "score": 0, "creation_date": 1438169919, "post_id": 31699157, "comment_id": 51337780, "body": "Please share how your localizations are stored and how is distance counted)"}, {"owner": {"reputation": 38307, "user_id": 2057388, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ceef8c04f66cd0e2bd360ef6abc14a81?s=128&d=identicon&r=PG", "display_name": "\u0417\u0435\u043b\u0451\u043d\u044b\u0439", "link": "https://stackoverflow.com/users/2057388/%d0%97%d0%b5%d0%bb%d1%91%d0%bd%d1%8b%d0%b9"}, "edited": false, "score": 0, "creation_date": 1438170146, "post_id": 31699157, "comment_id": 51337926, "body": "@jestemkarol you should try something by self. Your question is probably too broad."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4865423"}, "reply_to_user": {"reputation": 38307, "user_id": 2057388, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ceef8c04f66cd0e2bd360ef6abc14a81?s=128&d=identicon&r=PG", "display_name": "\u0417\u0435\u043b\u0451\u043d\u044b\u0439", "link": "https://stackoverflow.com/users/2057388/%d0%97%d0%b5%d0%bb%d1%91%d0%bd%d1%8b%d0%b9"}, "edited": false, "score": 0, "creation_date": 1438170315, "post_id": 31699157, "comment_id": 51338027, "body": "@\u0417\u0435\u043b\u0451\u043d\u044b\u0439 I just want some references how to do it, because I don&#39;t have any idea what can I use"}, {"owner": {"reputation": 38307, "user_id": 2057388, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ceef8c04f66cd0e2bd360ef6abc14a81?s=128&d=identicon&r=PG", "display_name": "\u0417\u0435\u043b\u0451\u043d\u044b\u0439", "link": "https://stackoverflow.com/users/2057388/%d0%97%d0%b5%d0%bb%d1%91%d0%bd%d1%8b%d0%b9"}, "edited": false, "score": 0, "creation_date": 1438170385, "post_id": 31699157, "comment_id": 51338080, "body": "Questions asking us to recommend or find a book, tool, software library, tutorial or other off-site resource are off-topic for Stack Overflow as they tend to attract opinionated answers and spam. Just try something, make some research, google is your friend. <a href=\"http://stackoverflow.com/help/how-to-ask\">stackoverflow.com/help/how-to-ask</a>"}, {"owner": {"reputation": 250, "user_id": 4909361, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/4c537320a14a84539a5e85fab6c7fab1?s=128&d=identicon&r=PG&f=1", "display_name": "Brian Kunzig", "link": "https://stackoverflow.com/users/4909361/brian-kunzig"}, "edited": false, "score": 0, "creation_date": 1438170599, "post_id": 31699157, "comment_id": 51338226, "body": "Are you asking how to save the weekly info and then compare it?  Also, do you mean location or localisation?  If you could also post your routes that may help since you will probably benefit from them being nested here."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4865423"}, "reply_to_user": {"reputation": 250, "user_id": 4909361, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/4c537320a14a84539a5e85fab6c7fab1?s=128&d=identicon&r=PG&f=1", "display_name": "Brian Kunzig", "link": "https://stackoverflow.com/users/4909361/brian-kunzig"}, "edited": false, "score": 0, "creation_date": 1438170789, "post_id": 31699157, "comment_id": 51338375, "body": "@BrianKunzig Yes, exactly. Weekly info about all the distance made. I&#39;m sorry, my mistake - locations, of course. Routes added to post."}, {"owner": {"reputation": 250, "user_id": 4909361, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/4c537320a14a84539a5e85fab6c7fab1?s=128&d=identicon&r=PG&f=1", "display_name": "Brian Kunzig", "link": "https://stackoverflow.com/users/4909361/brian-kunzig"}, "edited": false, "score": 0, "creation_date": 1438171143, "post_id": 31699157, "comment_id": 51338649, "body": "Add the location routes as well.  If you&#39;re using resource routing for both, the locations resource should be nested in the trips resource.  Doing this will give immediate access to the trips id in your params hash which is probably needed.  Add the route, and the form that takes the data to your post so I know."}], "owner": {"user_type": "does_not_exist", "display_name": "user4865423"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 41, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1438170718, "creation_date": 1438169234, "last_edit_date": 1438170718, "question_id": 31699157, "link": "https://stackoverflow.com/questions/31699157/show-weekly-statistic-for-variables", "title": "Show weekly statistic for variables", "body": "<p>I created a nested model for two locations. I use a method to count the distance between these two locations. I'd like to take statistics to count all the distances weekly and show it in a view like this:</p>\n\n<pre><code>Week 1 - 80 kms / Week 2 - 32 kms\n</code></pre>\n\n<p>Could someone help me with it?</p>\n\n<p><strong>@edit</strong></p>\n\n<p>Getting distance:</p>\n\n<pre><code>&lt;% @distance = Geocoder::Calculations.distance_between(@trip.locations.first, @trip.locations.last) %&gt;\n</code></pre>\n\n<p>Trip model:</p>\n\n<pre><code>class Trip &lt; ActiveRecord::Base\nhas_many :locations\n\naccepts_nested_attributes_for :locations\nend\n</code></pre>\n\n<p>Location model:</p>\n\n<pre><code>class Location &lt; ActiveRecord::Base\nbelongs_to :trip\n\nextend Geocoder::Model::ActiveRecord\ngeocoded_by :address\nafter_validation :geocode, :if =&gt; :address_changed?\n\nend\n</code></pre>\n\n<p>Trips controller:</p>\n\n<pre><code>def index\n@trips = Trip.all\n@trip = Trip.new\n2.times { location = @trip.locations.build }\nend\n\n\ndef show\n@trip = Trip.includes(:locations).find(params[:id])\nend\n</code></pre>\n\n<p>And I get the locations from a field_for form</p>\n\n<p>also routes:</p>\n\n<pre><code>resources :trips\nroot 'trips#index'\n</code></pre>\n"}, {"tags": ["ruby", "svg", "nokogiri"], "comments": [{"owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 0, "creation_date": 1438167960, "post_id": 31698491, "comment_id": 51336542, "body": "What is your question?"}, {"owner": {"reputation": 508, "user_id": 1602453, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/ec7cace3f5f96a4ca43247370f437158?s=128&d=identicon&r=PG", "display_name": "Eschon", "link": "https://stackoverflow.com/users/1602453/eschon"}, "reply_to_user": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 1, "creation_date": 1438168263, "post_id": 31698491, "comment_id": 51336739, "body": "Ups seems I forgot it. I added it."}, {"owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 0, "creation_date": 1438168412, "post_id": 31698491, "comment_id": 51336828, "body": "Have you noticed that the g tags are nested? Do you want the outer one, or the inner ones, or all?"}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1438168721, "post_id": 31698491, "comment_id": 51337025, "body": "Assuming you will filter your nested <code>g</code>s later: <code>doc.at &#39;g&#39;</code>."}, {"owner": {"reputation": 11227, "user_id": 1087866, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/52hpI.jpg?s=128&g=1", "display_name": "Jon Cairns", "link": "https://stackoverflow.com/users/1087866/jon-cairns"}, "edited": false, "score": 0, "creation_date": 1438169043, "post_id": 31698491, "comment_id": 51337230, "body": "Do you know for sure that the document is being parsed correctly? Try <code>puts doc.to_s</code>, which should show the XML. I&#39;ve had it before where I&#39;ve incorrectly instantiated the document, and it&#39;s provided an empty XML as a response."}, {"owner": {"reputation": 508, "user_id": 1602453, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/ec7cace3f5f96a4ca43247370f437158?s=128&d=identicon&r=PG", "display_name": "Eschon", "link": "https://stackoverflow.com/users/1602453/eschon"}, "reply_to_user": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 0, "creation_date": 1438169094, "post_id": 31698491, "comment_id": 51337261, "body": "@sawa I only wan&#39;t the inner ones but I don&#39;t care if the outer one is included since I&#39;m going to edit them based on their ids."}, {"owner": {"reputation": 508, "user_id": 1602453, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/ec7cace3f5f96a4ca43247370f437158?s=128&d=identicon&r=PG", "display_name": "Eschon", "link": "https://stackoverflow.com/users/1602453/eschon"}, "reply_to_user": {"reputation": 11227, "user_id": 1087866, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/52hpI.jpg?s=128&g=1", "display_name": "Jon Cairns", "link": "https://stackoverflow.com/users/1087866/jon-cairns"}, "edited": false, "score": 0, "creation_date": 1438169151, "post_id": 31698491, "comment_id": 51337292, "body": "@joonty I&#39;m positive that it is parsed correctly otherwise removing namespaces shouldn&#39;t work either."}, {"owner": {"reputation": 11227, "user_id": 1087866, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/52hpI.jpg?s=128&g=1", "display_name": "Jon Cairns", "link": "https://stackoverflow.com/users/1087866/jon-cairns"}, "edited": false, "score": 0, "creation_date": 1438169478, "post_id": 31698491, "comment_id": 51337505, "body": "@Eschon sorry, missed that at the end there"}, {"owner": {"reputation": 508, "user_id": 1602453, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/ec7cace3f5f96a4ca43247370f437158?s=128&d=identicon&r=PG", "display_name": "Eschon", "link": "https://stackoverflow.com/users/1602453/eschon"}, "reply_to_user": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1438169586, "post_id": 31698491, "comment_id": 51337568, "body": "@mudasobwa <code>doc.at &#39;g&#39;</code> gives me the following array <code>[ &quot;id&quot;, &quot;L_691200_group&quot; ]</code> which is not what I need."}, {"owner": {"reputation": 11227, "user_id": 1087866, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/52hpI.jpg?s=128&g=1", "display_name": "Jon Cairns", "link": "https://stackoverflow.com/users/1087866/jon-cairns"}, "edited": false, "score": 0, "creation_date": 1438169608, "post_id": 31698491, "comment_id": 51337582, "body": "@Eschon <code>doc.css(&quot;g&quot;)</code> works for me - which version of Nokogiri are you using?"}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1438169827, "post_id": 31698491, "comment_id": 51337723, "body": "@Eschon <code>doc.at &#39;g&#39;</code> gives you the first met instance of <code>Nokogiri::XML::Element</code>, not an array."}, {"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "reply_to_user": {"reputation": 11227, "user_id": 1087866, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/52hpI.jpg?s=128&g=1", "display_name": "Jon Cairns", "link": "https://stackoverflow.com/users/1087866/jon-cairns"}, "edited": false, "score": 0, "creation_date": 1438274282, "post_id": 31698491, "comment_id": 51394477, "body": "@joonty &quot;Do you know for sure that the document is being parsed correctly?&quot; Using <code>doc.to_s</code> isn&#39;t the way to  see if there are errors as Nokogiri will attempt to fix the document if it can&#39;t parse, and big documents can be exhausting to check manually because humans suck at looking at freeform text and finding inconsistencies. Instead let Nokogiri <i>show</i> the errors: <a href=\"http://www.rubydoc.info/github/sparklemotion/nokogiri/Nokogiri/XML/Document:errors\" rel=\"nofollow noreferrer\"><code>doc.errors</code></a> returns the errors found in the document."}], "answers": [{"comments": [{"owner": {"reputation": 508, "user_id": 1602453, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/ec7cace3f5f96a4ca43247370f437158?s=128&d=identicon&r=PG", "display_name": "Eschon", "link": "https://stackoverflow.com/users/1602453/eschon"}, "edited": false, "score": 0, "creation_date": 1438169886, "post_id": 31699317, "comment_id": 51337761, "body": "Ok that really works I had an error in my code later on that made me think it was not working. My own stupidity got me again"}], "tags": [], "owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "is_accepted": true, "score": 3, "last_activity_date": 1438169674, "creation_date": 1438169674, "answer_id": 31699317, "question_id": 31698491, "link": "https://stackoverflow.com/questions/31698491/nokogiri-cant-get-g-tags-from-svg/31699317#31699317", "title": "Nokogiri can&#39;t get g tags from svg", "body": "<p>It sounds like you have an induced error. I will post this as an answer for a sake of code formatting.</p>\n\n<pre><code>\u25b6 Nokogiri::VERSION\n#\u21d2 \"1.5.4\"\n\n\u25b6 xml = Nokogiri.parse '&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;...'\n\u25b6 xml.xpath('//xmlns:g').size\n#\u21d2 5\n</code></pre>\n\n<p>Besides that, <code>xml.css 'g'</code> works the same way.</p>\n"}], "owner": {"reputation": 508, "user_id": 1602453, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/ec7cace3f5f96a4ca43247370f437158?s=128&d=identicon&r=PG", "display_name": "Eschon", "link": "https://stackoverflow.com/users/1602453/eschon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 801, "favorite_count": 0, "accepted_answer_id": 31699317, "answer_count": 1, "score": 1, "last_activity_date": 1438169674, "creation_date": 1438167350, "last_edit_date": 1438168216, "question_id": 31698491, "link": "https://stackoverflow.com/questions/31698491/nokogiri-cant-get-g-tags-from-svg", "title": "Nokogiri can&#39;t get g tags from svg", "body": "<p>I have a svg file like this:</p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n&lt;svg xmlns=\"http://www.w3.org/2000/svg\" xml:space=\"preserve\" height=\"700\" width=\"1024\" viewBox=\"0 0 1024 700\" shape-rendering=\"geometricPrecision\" text-rendering=\"geometricPrecision\" image-rendering=\"optimizeQuality\" fill-rule=\"evenodd\" clip-rule=\"evenodd\"  xmlns:xlink=\"http://www.w3.org/1999/xlink\"&gt;\n&lt;g id=\"L_691200_group\"&gt;\n&lt;g id=\"L_691200_background\"&gt;\n&lt;path stroke-width=\"5\" fill=\"none\" fill-rule=\"nonzero\" stroke=\"black\" d=\"...\"/&gt;\n&lt;/g&gt;\n&lt;g id=\"L_691200_path\"&gt;&lt;path d=\"...\"/&gt;&lt;/g&gt;\n&lt;g id=\"L_691200_icon\"&gt;&lt;circle cx=\"387.413\" cy=\"485.451\" r=\"7.99993\" stroke-width=\"1\" stroke=\"black\"/&gt;&lt;circle cx=\"478.876\" cy=\"379.327\" r=\"2.50001\" stroke-width=\"1\" stroke=\"black\"/&gt;&lt;circle cx=\"276.717\" cy=\"593.047\" r=\"2.50001\" stroke-width=\"1\" stroke=\"black\"/&gt;&lt;/g&gt;\n&lt;g id=\"L_691200_symbol\"&gt;\n&lt;path fill=\"white\" fill-rule=\"nonzero\" d=\"...\"/&gt;\n&lt;/g&gt;\n&lt;/g&gt;\n&lt;/svg&gt;\n</code></pre>\n\n<p>I tried to parse it in Ruby using Nokogiri but I cannot get the g tags.</p>\n\n<p>I tried various things:</p>\n\n<pre><code>groups = doc.xpath('//g')\ngroups = doc.xpath('//xmlns:g')\ngroups = doc.xpath('//g', 'g' =&gt; 'http://www.w3.org/2000/svg')\ngroups = doc.css('g')\n</code></pre>\n\n<p>But groups is always empty. The only way I got it to work was to remove namespaces from doc. But I can't do it that way since I need to save the document again after changing a few thins.</p>\n\n<p>How can I get the g tags without removing the namespace?</p>\n"}, {"tags": ["ruby", "cgi"], "comments": [{"owner": {"reputation": 1111, "user_id": 834459, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/e439ef4645473b8a95fb2cf36ab15559?s=128&d=identicon&r=PG", "display_name": "Vidur", "link": "https://stackoverflow.com/users/834459/vidur"}, "edited": false, "score": 1, "creation_date": 1438170231, "post_id": 31698265, "comment_id": 51337973, "body": "Are you using Rails? Because there&#39;s an ActiveSupport Rescuable module that does something similar - <a href=\"http://api.rubyonrails.org/classes/ActiveSupport/Rescuable/ClassMethods.html\" rel=\"nofollow noreferrer\">api.rubyonrails.org/classes/ActiveSupport/Rescuable/&hellip;</a>"}, {"owner": {"reputation": 132, "user_id": 1878561, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c00ebe58a66b5bf06daf489caabfa65c?s=128&d=identicon&r=PG", "display_name": "Andy Royal", "link": "https://stackoverflow.com/users/1878561/andy-royal"}, "reply_to_user": {"reputation": 1111, "user_id": 834459, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/e439ef4645473b8a95fb2cf36ab15559?s=128&d=identicon&r=PG", "display_name": "Vidur", "link": "https://stackoverflow.com/users/834459/vidur"}, "edited": false, "score": 0, "creation_date": 1438176305, "post_id": 31698265, "comment_id": 51342290, "body": "Thanks but no, I&#39;m just using plain Ruby"}, {"owner": {"reputation": 123805, "user_id": 622310, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/8b6d35219e1808520bc238b28161e2e6?s=128&d=identicon&r=PG", "display_name": "Borodin", "link": "https://stackoverflow.com/users/622310/borodin"}, "edited": false, "score": 0, "creation_date": 1438182789, "post_id": 31698265, "comment_id": 51347393, "body": "This question doesn&#39;t seem to be related to Perl so I&#39;ve removed the tag"}], "answers": [{"comments": [{"owner": {"reputation": 132, "user_id": 1878561, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c00ebe58a66b5bf06daf489caabfa65c?s=128&d=identicon&r=PG", "display_name": "Andy Royal", "link": "https://stackoverflow.com/users/1878561/andy-royal"}, "edited": false, "score": 0, "creation_date": 1438176430, "post_id": 31699695, "comment_id": 51342384, "body": "Thanks! The second link is the key one for me, somewhere in there it suggests setting <code>$stdout.sync = true</code> so I&#39;ll edit the reply with that."}], "tags": [], "owner": {"reputation": 19192, "user_id": 257635, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/El2tc.jpg?s=128&g=1", "display_name": "Chankey Pathak", "link": "https://stackoverflow.com/users/257635/chankey-pathak"}, "is_accepted": true, "score": 1, "last_activity_date": 1438179455, "last_edit_date": 1438179455, "creation_date": 1438170781, "answer_id": 31699695, "question_id": 31698265, "link": "https://stackoverflow.com/questions/31698265/how-can-i-redirect-error-messages-to-the-browser-in-cgi-ruby/31699695#31699695", "title": "How can I redirect error messages to the browser in CGI/Ruby?", "body": "<pre><code> group :development do\n    gem 'better_errors'\n    gem 'binding_of_caller'\n    gem 'meta_request'\nend\n</code></pre>\n\n<p>See this railscast: <a href=\"http://railscasts.com/episodes/402-better-errors-railspanel?view=asciicast\" rel=\"nofollow\">Better Errors &amp; RailsPanel</a> and this thread <a href=\"https://groups.google.com/forum/#!topic/comp.lang.ruby/GfPfMBbnCfw\" rel=\"nofollow\">redirect errors to browser in ruby + cgi</a>, where it suggests this:</p>\n\n<pre><code>$stdout.sync = true\n$stderr.reopen $stdout\nputs \"Content-type: text/html\\n\\n\"`\n</code></pre>\n\n<p>The content-type needs to be early in the code, as any errors before it will not be sent to the browser.</p>\n"}], "owner": {"reputation": 132, "user_id": 1878561, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c00ebe58a66b5bf06daf489caabfa65c?s=128&d=identicon&r=PG", "display_name": "Andy Royal", "link": "https://stackoverflow.com/users/1878561/andy-royal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 100, "favorite_count": 0, "accepted_answer_id": 31699695, "answer_count": 1, "score": 1, "last_activity_date": 1438182751, "creation_date": 1438166740, "last_edit_date": 1438182751, "question_id": 31698265, "link": "https://stackoverflow.com/questions/31698265/how-can-i-redirect-error-messages-to-the-browser-in-cgi-ruby", "title": "How can I redirect error messages to the browser in CGI/Ruby?", "body": "<p>I've been using CGI/Perl for a while and have got used to using Carp to redirect error messages to the browser with something like:</p>\n\n<pre><code>use CGI::Carp qw(warningsToBrowser fatalsToBrowser set_message);\nset_message(\"Please report this error to the administrator\");\n\n...\n\nwarningsToBrowser(1);\n</code></pre>\n\n<p>I'm considering making the switch to using Ruby instead of Perl, but I can't find a way to do a similar error redirection. Is there a Ruby module which can do this?</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 9323, "user_id": 1047207, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/2U8wC.jpg?s=128&g=1", "display_name": "RAJ", "link": "https://stackoverflow.com/users/1047207/raj"}, "edited": false, "score": 0, "creation_date": 1438165836, "post_id": 31697737, "comment_id": 51335206, "body": "Your question is not clear &gt;&gt;&gt; why i receive the followoing as the input, instead of the database? &lt;&lt;&lt;"}, {"owner": {"reputation": 9323, "user_id": 1047207, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/2U8wC.jpg?s=128&g=1", "display_name": "RAJ", "link": "https://stackoverflow.com/users/1047207/raj"}, "edited": false, "score": 0, "creation_date": 1438166230, "post_id": 31697737, "comment_id": 51335450, "body": "<code>&lt;%= debug @outlet %&gt;</code> is this content of <code>maps&#47;map</code> template?"}, {"owner": {"reputation": 9323, "user_id": 1047207, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/2U8wC.jpg?s=128&g=1", "display_name": "RAJ", "link": "https://stackoverflow.com/users/1047207/raj"}, "edited": false, "score": 0, "creation_date": 1438166794, "post_id": 31697737, "comment_id": 51335799, "body": "Can you post output of <code>Brand.all</code> from rails console into your question?"}, {"owner": {"reputation": 39050, "user_id": 2336231, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/d7kOQ.jpg?s=128&g=1", "display_name": "BroiSatse", "link": "https://stackoverflow.com/users/2336231/broisatse"}, "edited": false, "score": 0, "creation_date": 1438167851, "post_id": 31697737, "comment_id": 51336475, "body": "Shouldn&#39;t <code>get &#39;maps&#47;map&#39; =&gt; &#39;maps#map&#39;</code> be <code>get &#39;maps&#47;map&#39; =&gt; &#39;maps#maps&#39;</code>? You didn&#39;t show us <code>map</code> action in your controller."}, {"owner": {"reputation": 605, "user_id": 1398515, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/5e66c923725405358c56acb9ab4f93a2?s=128&d=identicon&r=PG", "display_name": "Datt", "link": "https://stackoverflow.com/users/1398515/datt"}, "edited": false, "score": 0, "creation_date": 1438168019, "post_id": 31697737, "comment_id": 51336573, "body": "your route  is get <code>&#39;maps&#47;map&#39; =&gt; &#39;maps#map&#39;</code> and action name is <code>maps</code>  confirm it. and also confirm the views file name is <code>map.ext</code>"}, {"owner": {"reputation": 1066, "user_id": 4393829, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/nK83a.jpg?s=128&g=1", "display_name": "m2j", "link": "https://stackoverflow.com/users/4393829/m2j"}, "edited": false, "score": 0, "creation_date": 1438169068, "post_id": 31697737, "comment_id": 51337250, "body": "I&#39;m trying to pass a variable from controller to view page,.. how can i do that/"}, {"owner": {"reputation": 250, "user_id": 4909361, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/4c537320a14a84539a5e85fab6c7fab1?s=128&d=identicon&r=PG&f=1", "display_name": "Brian Kunzig", "link": "https://stackoverflow.com/users/4909361/brian-kunzig"}, "edited": false, "score": 0, "creation_date": 1438170191, "post_id": 31697737, "comment_id": 51337948, "body": "Is your view file named &quot;map.html.erb&quot; and in the maps view folder?  Also, try &lt;%= @outlet.inspect %&gt;   in your view and let us know exactly what the output is!"}, {"owner": {"reputation": 1066, "user_id": 4393829, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/nK83a.jpg?s=128&g=1", "display_name": "m2j", "link": "https://stackoverflow.com/users/4393829/m2j"}, "edited": false, "score": 0, "creation_date": 1438170383, "post_id": 31697737, "comment_id": 51338078, "body": "it&#39;s named <code>map.html.erb</code> only... I received <code>nil</code>"}], "answers": [{"tags": [], "owner": {"reputation": 21, "user_id": 4222573, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-8dR9Wm9Ie0k/AAAAAAAAAAI/AAAAAAAAB94/GMMc-ppTRsc/photo.jpg?sz=128", "display_name": "Isaac Jarquin", "link": "https://stackoverflow.com/users/4222573/isaac-jarquin"}, "is_accepted": false, "score": 0, "last_activity_date": 1438172455, "creation_date": 1438172455, "answer_id": 31700257, "question_id": 31697737, "link": "https://stackoverflow.com/questions/31697737/rails-render-nothing/31700257#31700257", "title": "Rails render nothing", "body": "<p>You only need to change the name of the method in your controller from maps to map and then your view should be map.html.erb</p>\n\n<p>when you do get 'maps/map' => 'maps#map' rails will look for a method called map in your maps controller. the best you can do, is to check your routes with\nbundle exec rake routes</p>\n"}], "owner": {"reputation": 1066, "user_id": 4393829, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/nK83a.jpg?s=128&g=1", "display_name": "m2j", "link": "https://stackoverflow.com/users/4393829/m2j"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 323, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1438172455, "creation_date": 1438165348, "last_edit_date": 1438168970, "question_id": 31697737, "link": "https://stackoverflow.com/questions/31697737/rails-render-nothing", "title": "Rails render nothing", "body": "<p>I'm trying to pass a variable from controller to view page</p>\n\n<p>My controller is </p>\n\n<pre><code>class MapsController &lt; ApplicationController\n    def maps\n        @outlet = Brand.all\n        render \"maps/map\"\n    end\nend\n</code></pre>\n\n<p>my view page is </p>\n\n<pre><code>&lt;%= debug @outlet %&gt;\n</code></pre>\n\n<p>my route is </p>\n\n<pre><code>  get 'maps/map' =&gt; 'maps#map'\n</code></pre>\n\n<p>my database is</p>\n\n<pre><code>id   brand_id\n 1     hello\n 2     hi\n 3     this_is _some_text\n</code></pre>\n\n<p>why i receive the followoing as the input, instead of the database?</p>\n\n<pre><code>--- \n...\n</code></pre>\n\n<p>can anyone help me out?</p>\n"}, {"tags": ["html", "ruby", "steam", "marketplace"], "answers": [{"comments": [{"owner": {"reputation": 105, "user_id": 4702449, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IqSNB.jpg?s=128&g=1", "display_name": "corybantic", "link": "https://stackoverflow.com/users/4702449/corybantic"}, "edited": false, "score": 0, "creation_date": 1438164455, "post_id": 31697309, "comment_id": 51334247, "body": "Thanks! I&#39;ll try it out!"}, {"owner": {"reputation": 105, "user_id": 4702449, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IqSNB.jpg?s=128&g=1", "display_name": "corybantic", "link": "https://stackoverflow.com/users/4702449/corybantic"}, "edited": false, "score": 0, "creation_date": 1438164575, "post_id": 31697309, "comment_id": 51334339, "body": "Is this the correct syntax for the html if I want to put the retrieved src into html?   &lt;img src=&lt;% bookmark.pricecheck%&gt;&gt;&lt;/img&gt;"}, {"owner": {"reputation": 167912, "user_id": 240443, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/495d675e3bc42ed1dee469e2ce701f1b?s=128&d=identicon&r=PG", "display_name": "Amadan", "link": "https://stackoverflow.com/users/240443/amadan"}, "reply_to_user": {"reputation": 105, "user_id": 4702449, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IqSNB.jpg?s=128&g=1", "display_name": "corybantic", "link": "https://stackoverflow.com/users/4702449/corybantic"}, "edited": false, "score": 0, "creation_date": 1438216722, "post_id": 31697309, "comment_id": 51364521, "body": "That will work if you are lucky, depending on the contents of the variable. <code>&lt;img src=&quot;&lt;%= bookmark.pricecheck%&gt;&quot;&gt;&lt;&#47;img&gt;</code> should be more robust; but you&#39;ll only be completely safe if you also do some escaping on the string. If you are using Erubis instead of ERb (default for Rails; if you aren&#39;t, you should), you can use <code>&lt;img src=&quot;&lt;%== bookmark.pricecheck%&gt;&quot;&gt;&lt;&#47;img&gt;</code> to be completely safe (it escapes stuff for you)."}], "tags": [], "owner": {"reputation": 167912, "user_id": 240443, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/495d675e3bc42ed1dee469e2ce701f1b?s=128&d=identicon&r=PG", "display_name": "Amadan", "link": "https://stackoverflow.com/users/240443/amadan"}, "is_accepted": true, "score": 1, "last_activity_date": 1438164328, "creation_date": 1438164328, "answer_id": 31697309, "question_id": 31697164, "link": "https://stackoverflow.com/questions/31697164/retrieve-an-image-from-a-website-using-ruby-and-nokogiri/31697309#31697309", "title": "Retrieve an image from a website using Ruby and Nokogiri", "body": "<p>The image does not have that class; the <code>div</code> that the image is wrapped in does. That said,</p>\n\n<pre><code>html.at_css('.market_listing_largeimage img')['src']\n</code></pre>\n"}], "owner": {"reputation": 105, "user_id": 4702449, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IqSNB.jpg?s=128&g=1", "display_name": "corybantic", "link": "https://stackoverflow.com/users/4702449/corybantic"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 123, "favorite_count": 1, "accepted_answer_id": 31697309, "answer_count": 1, "score": 0, "last_activity_date": 1438164328, "creation_date": 1438163939, "question_id": 31697164, "link": "https://stackoverflow.com/questions/31697164/retrieve-an-image-from-a-website-using-ruby-and-nokogiri", "title": "Retrieve an image from a website using Ruby and Nokogiri", "body": "<p>I am trying to get an image from this website using Ruby. \n<a href=\"https://steamcommunity.com/market/listings/730/M4A1-S%20%7C%20Cyrex%20(Minimal%20Wear)\" rel=\"nofollow\">https://steamcommunity.com/market/listings/730/M4A1-S%20%7C%20Cyrex%20(Minimal%20Wear)</a>\nSo far, I have successful code to get the name of the item listed on the website:</p>\n\n<pre><code> html = Nokogiri::HTML.parse(open('https://steamcommunity.com/market/listings/730/'+url2))\n title = html.css('title').text\n titles = title.sub(/^Steam Community Market :: Listings for / , '')\n</code></pre>\n\n<p>Which results in \"M4A1-S | Cyrex (Minimal Wear)\"</p>\n\n<p>(The \"url2\" comes from an input box on the html page that I made)</p>\n\n<p>The image on the Steam Website has a class of \"market_listing_largeimage\".</p>\n\n<p>Is there a way to also use Nokogiri to get the image src so that I can then input it into Html?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "railstutorial.org"], "comments": [{"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1438164176, "post_id": 31697068, "comment_id": 51334061, "body": "<code>def User.digest</code> \u2261 <code>def self.digest</code> \u2261 <code>class &lt;&lt; self ; def digest ... end</code> is a declaration of class method. <code>def digest</code> is a declaration of an instance method, that is to be called on instances: <code>User.new.digest</code> rather on the class itself: <code>User.digest</code>."}], "answers": [{"tags": [], "owner": {"reputation": 9323, "user_id": 1047207, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/2U8wC.jpg?s=128&g=1", "display_name": "RAJ", "link": "https://stackoverflow.com/users/1047207/raj"}, "is_accepted": false, "score": 1, "last_activity_date": 1438171276, "last_edit_date": 1438171276, "creation_date": 1438164354, "answer_id": 31697323, "question_id": 31697068, "link": "https://stackoverflow.com/questions/31697068/railstutorial-org-chapter-8-digest-method-definition/31697323#31697323", "title": "Railstutorial.org Chapter 8: digest method definition", "body": "<p>Followings are <strong>class methods</strong> which are equivalent to each other:</p>\n\n<pre><code>def User.digest(string)\n  # MY LOGIC\nend\n\ndef self.digest(string)\n  # MY LOGIC\nend\n</code></pre>\n\n<p>Class methods got called directly on class like <code>User.digest(\"my_string\")</code>.</p>\n\n<blockquote>\n  <p>We are in the User class so every method in it should be accessible by User.</p>\n</blockquote>\n\n<p>Unfortunately, this is <strong>NOT</strong> true. Only class methods will get called using <code>User.&lt;method_name&gt;</code>.</p>\n\n<p>If you have defined a method</p>\n\n<pre><code>def digest(string)\n  # MY LOGIC\nend\n</code></pre>\n\n<p>Above is an <strong>instance method</strong> and will  get called on the instance (object) of <code>User</code> class (NOT directly on class) like:</p>\n\n<pre><code>user = User.new\nuser.digest(\"string\")\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 161, "user_id": 4430474, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a95b2fdd9a51a2a244a1dfd14dc3a078?s=128&d=identicon&r=PG&f=1", "display_name": "rasmus1610", "link": "https://stackoverflow.com/users/4430474/rasmus1610"}, "edited": false, "score": 1, "creation_date": 1438165512, "post_id": 31697666, "comment_id": 51334996, "body": "thats a great and especially friendly answer :) thank you.. usually you feel so stupid asking such a basic stuff here :D"}], "tags": [], "owner": {"reputation": 60, "user_id": 4311399, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d6c7f5fefe9ec1ea5837589e02a48922?s=128&d=identicon&r=PG", "display_name": "jwgoh", "link": "https://stackoverflow.com/users/4311399/jwgoh"}, "is_accepted": true, "score": 3, "last_activity_date": 1438226958, "last_edit_date": 1438226958, "creation_date": 1438165147, "answer_id": 31697666, "question_id": 31697068, "link": "https://stackoverflow.com/questions/31697068/railstutorial-org-chapter-8-digest-method-definition/31697666#31697666", "title": "Railstutorial.org Chapter 8: digest method definition", "body": "<p>If you do <code>def digest(string)</code>, you are actually defining an <strong>instance</strong> method.</p>\n\n<p>Read more about class and instance methods here: <a href=\"http://www.railstips.org/blog/archives/2009/05/11/class-and-instance-methods-in-ruby/\" rel=\"nofollow\">http://www.railstips.org/blog/archives/2009/05/11/class-and-instance-methods-in-ruby/</a></p>\n\n<p>Michael Hartl actually explains why he defined the <strong>class</strong> method this way at the bottom (Section 8.6 point 1).</p>\n\n<blockquote>\n  <p>...we defined the new token and digest class methods by explicitly prefixing them with User. This works fine and, because they are actually called using User.new_token and User.digest, it is probably the clearest way to define them....</p>\n</blockquote>\n\n<p>The other alternatives to define User class methods are:</p>\n\n<pre><code>def self.digest(string)\n  #your code here\nend\n</code></pre>\n\n<p>or</p>\n\n<pre><code>class &lt;&lt; self\n  def digest(string)\n    #your code here\n  end\nend\n</code></pre>\n\n<p>Hope this helps! I also learned Rails using his book :)</p>\n"}], "owner": {"reputation": 161, "user_id": 4430474, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a95b2fdd9a51a2a244a1dfd14dc3a078?s=128&d=identicon&r=PG&f=1", "display_name": "rasmus1610", "link": "https://stackoverflow.com/users/4430474/rasmus1610"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 454, "favorite_count": 0, "accepted_answer_id": 31697666, "answer_count": 2, "score": 0, "last_activity_date": 1438226958, "creation_date": 1438163716, "question_id": 31697068, "link": "https://stackoverflow.com/questions/31697068/railstutorial-org-chapter-8-digest-method-definition", "title": "Railstutorial.org Chapter 8: digest method definition", "body": "<p>I'm currently working through Michael Hartl's Rails tutorial and I found a method definition I don't quite get: </p>\n\n<pre><code>class User &lt; ActiveRecord::Base\n\n\nbefore_save { self.email = email.downcase }\n  validates :name,  presence: true, length: { maximum: 50 }\n  VALID_EMAIL_REGEX = /\\A[\\w+\\-.]+@[a-z\\d\\-.]+\\.[a-z]+\\z/i\n  validates :email, presence: true, length: { maximum: 255 },\n                    format: { with: VALID_EMAIL_REGEX },\n                    uniqueness: { case_sensitive: false }\n  has_secure_password\n  validates :password, presence: true, length: { minimum: 6 }\n\n  # Returns the hash digest of the given string.\n  def User.digest(string)\n    cost = ActiveModel::SecurePassword.min_cost ? BCrypt::Engine::MIN_COST :\n                                                  BCrypt::Engine.cost\n    BCrypt::Password.create(string, cost: cost)\n  end\nend\n</code></pre>\n\n<p>The crucial part is the definiton of <code>User.digest</code> ... why does he write <code>def User.digest(string)</code> and not just <code>def digest(string)</code> ... </p>\n\n<p>We are in the User class so every method in it should be accessible by <code>User.&lt;method_name&gt;</code>. So isn't it redundant or wrong to define a method like this?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-4", "rails-activerecord"], "comments": [{"owner": {"reputation": 5074, "user_id": 4207394, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/mmfTf.png?s=128&g=1", "display_name": "Deep", "link": "https://stackoverflow.com/users/4207394/deep"}, "edited": false, "score": 1, "creation_date": 1438162851, "post_id": 31696091, "comment_id": 51333261, "body": "make it <code>hosts.host_type</code>, as there is always the table name in the raw sql part. And <code>hosts</code> should be your table name and <code>host_type</code> its column."}], "answers": [{"tags": [], "owner": {"reputation": 714, "user_id": 5159834, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh4.googleusercontent.com/-aH1V7Vjlqn4/AAAAAAAAAAI/AAAAAAAAKuQ/3LCsGyKtPV8/photo.jpg?sz=128", "display_name": "Pierangelo Orizio", "link": "https://stackoverflow.com/users/5159834/pierangelo-orizio"}, "is_accepted": false, "score": 1, "last_activity_date": 1438161942, "creation_date": 1438161942, "answer_id": 31696373, "question_id": 31696091, "link": "https://stackoverflow.com/questions/31696091/rails-search-with-multiple-conditions/31696373#31696373", "title": "Rails Search with multiple Conditions", "body": "<p>You can use if params[:query].present?</p>\n\n<pre><code>@events_results = Event.order('event_date ASC').all\n\n@events_results = Event.where(\"name LIKE '%#{params[:query]}%'\").order('event_date ASC').all if params[:query].present?\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 34818, "user_id": 2149092, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/34986a72d47c42ae5685b37ba32d1e22?s=128&d=identicon&r=PG", "display_name": "Mohammad AbuShady", "link": "https://stackoverflow.com/users/2149092/mohammad-abushady"}, "edited": false, "score": 1, "creation_date": 1438162153, "post_id": 31696403, "comment_id": 51332796, "body": "you have a double <code>if</code> in the first <code>return</code>"}], "tags": [], "owner": {"reputation": 47232, "user_id": 1772830, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/Qtoqg.jpg?s=128&g=1", "display_name": "Andrey Deineko", "link": "https://stackoverflow.com/users/1772830/andrey-deineko"}, "is_accepted": false, "score": 1, "last_activity_date": 1438162172, "last_edit_date": 1438162172, "creation_date": 1438162024, "answer_id": 31696403, "question_id": 31696091, "link": "https://stackoverflow.com/questions/31696091/rails-search-with-multiple-conditions/31696403#31696403", "title": "Rails Search with multiple Conditions", "body": "<p>You can guard clause over conditionals:</p>\n\n<pre><code>def events_results\n  return Event.order('event_date ASC').all if params[:query].blank?\n  return Event.where(\"name LIKE '%#{params[:query]}%'\").order('event_date ASC').all if host_type\n  return something_else if_some_other_codn_met\nend\n</code></pre>\n\n<p>This way you don't need to bother with <code>if else</code>/<code>case</code> statements and it looks cleaner (imo).</p>\n"}, {"tags": [], "owner": {"reputation": 5074, "user_id": 4207394, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/mmfTf.png?s=128&g=1", "display_name": "Deep", "link": "https://stackoverflow.com/users/4207394/deep"}, "is_accepted": false, "score": 1, "last_activity_date": 1438162219, "creation_date": 1438162219, "answer_id": 31696470, "question_id": 31696091, "link": "https://stackoverflow.com/questions/31696091/rails-search-with-multiple-conditions/31696470#31696470", "title": "Rails Search with multiple Conditions", "body": "<p>What you can do is create a conditional string first like this:</p>\n\n<pre><code>conditions = \"\"\nif params[:query].present?\n  conditions += \" name LIKE '%#{params[:query]}%'\"\nelsif params[:anything].present?\n  conditions += \" query\" #if you have OR condtion either the first parameter or this one\nend\nif params[:something_else].present?\n  conditions += \" AND query\"\nend\n@events_results = Event.where(conditions).order('event_date ASC').all\n</code></pre>\n\n<p>And also I will recommend to use something like <code>elasticsearch</code> or <code>solr</code> for this type of tasks.</p>\n\n<p>Hope this helps.</p>\n"}, {"comments": [{"owner": {"reputation": 50195, "user_id": 155196, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/ri3X9.jpg?s=128&g=1", "display_name": "Harsha M V", "link": "https://stackoverflow.com/users/155196/harsha-m-v"}, "edited": false, "score": 0, "creation_date": 1438162810, "post_id": 31696634, "comment_id": 51333240, "body": "thanks you. i think i have used something similar as u suggested. But looks like i am not able to do the search based on the related model with this method. have updated my question."}, {"owner": {"reputation": 34818, "user_id": 2149092, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/34986a72d47c42ae5685b37ba32d1e22?s=128&d=identicon&r=PG", "display_name": "Mohammad AbuShady", "link": "https://stackoverflow.com/users/2149092/mohammad-abushady"}, "reply_to_user": {"reputation": 50195, "user_id": 155196, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/ri3X9.jpg?s=128&g=1", "display_name": "Harsha M V", "link": "https://stackoverflow.com/users/155196/harsha-m-v"}, "edited": false, "score": 0, "creation_date": 1438162868, "post_id": 31696634, "comment_id": 51333274, "body": "you need to use <code>joins</code> not <code>includes</code>, i&#39;ve added that condition to my answer"}, {"owner": {"reputation": 50195, "user_id": 155196, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/ri3X9.jpg?s=128&g=1", "display_name": "Harsha M V", "link": "https://stackoverflow.com/users/155196/harsha-m-v"}, "edited": false, "score": 0, "creation_date": 1438162989, "post_id": 31696634, "comment_id": 51333342, "body": "Mysql2::Error: Column &#39;name&#39; in where clause is ambiguous: SELECT <code>events</code>.* FROM <code>events</code> INNER JOIN <code>hosts</code> ON <code>hosts</code>.<code>id</code> = <code>events</code>.<code>host_id</code> WHERE (name LIKE &#39;%menu%&#39;) AND (Host.host_type = &#39;1&#39;) ORDER BY event_date ASC"}, {"owner": {"reputation": 34818, "user_id": 2149092, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/34986a72d47c42ae5685b37ba32d1e22?s=128&d=identicon&r=PG", "display_name": "Mohammad AbuShady", "link": "https://stackoverflow.com/users/2149092/mohammad-abushady"}, "reply_to_user": {"reputation": 50195, "user_id": 155196, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/ri3X9.jpg?s=128&g=1", "display_name": "Harsha M V", "link": "https://stackoverflow.com/users/155196/harsha-m-v"}, "edited": false, "score": 0, "creation_date": 1438163039, "post_id": 31696634, "comment_id": 51333366, "body": "then you need to be more specific, <code>event_results.name like ..</code> will update my answer"}, {"owner": {"reputation": 34818, "user_id": 2149092, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/34986a72d47c42ae5685b37ba32d1e22?s=128&d=identicon&r=PG", "display_name": "Mohammad AbuShady", "link": "https://stackoverflow.com/users/2149092/mohammad-abushady"}, "reply_to_user": {"reputation": 50195, "user_id": 155196, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/ri3X9.jpg?s=128&g=1", "display_name": "Harsha M V", "link": "https://stackoverflow.com/users/155196/harsha-m-v"}, "edited": false, "score": 1, "creation_date": 1438163228, "post_id": 31696634, "comment_id": 51333475, "body": "when you pass a string to <code>where</code> it&#39;s passed to the db, so you can&#39;t use the class format, you need to use the actual table name, you could use the class if you want but it would be more complicated for this case."}], "tags": [], "owner": {"reputation": 34818, "user_id": 2149092, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/34986a72d47c42ae5685b37ba32d1e22?s=128&d=identicon&r=PG", "display_name": "Mohammad AbuShady", "link": "https://stackoverflow.com/users/2149092/mohammad-abushady"}, "is_accepted": true, "score": 2, "last_activity_date": 1438163144, "last_edit_date": 1438163144, "creation_date": 1438162664, "answer_id": 31696634, "question_id": 31696091, "link": "https://stackoverflow.com/questions/31696091/rails-search-with-multiple-conditions/31696634#31696634", "title": "Rails Search with multiple Conditions", "body": "<p>You could just create an initial query and chain on it while you go, from what I can see the <code>order</code> part is common and always present, so use it as the base query</p>\n\n<pre><code>@event_results = Event.order(event_date: :asc)\n@event_results = @event_results.where('event_results.name LIKE ?', \"%#{params[:query]}%\") if params[:query]\n@event_results = @event_results.joins(:host).where(host_type: params[:host_type]) if proper_condition\n@event_results = @event_results.more_methods if more_conditions\n#etc\n\n@event_results #the return\n</code></pre>\n\n<p>By default ruby will return the last statement, so you don't need to use <code>return</code>, unless the last statement returns something like <code>true/false</code> then you should just add a new line with the variable <code>@event_results</code></p>\n\n<blockquote>\n  <p><strong>NOTE</strong>: never use input directly from params into your query, you're allowing people to inject sql to your code, use the substitution\n  method so that <code>ActiveRecord</code> would sanitize the input for you.</p>\n  \n  <p><strong>Bad:</strong></p>\n\n<pre><code>where(\"name LIKE '%#{params[:query]}%'\")\n</code></pre>\n  \n  <p><strong>Good:</strong></p>\n\n<pre><code>where('name LIKE ?', \"%#{params[:query]}%\")\n</code></pre>\n</blockquote>\n"}, {"tags": [], "owner": {"reputation": 1305, "user_id": 623919, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/c7d2113d86e7a9b16e8cac6956096bf0?s=128&d=identicon&r=PG", "display_name": "Axel Tetzlaff", "link": "https://stackoverflow.com/users/623919/axel-tetzlaff"}, "is_accepted": false, "score": 1, "last_activity_date": 1438165282, "creation_date": 1438165282, "answer_id": 31697711, "question_id": 31696091, "link": "https://stackoverflow.com/questions/31696091/rails-search-with-multiple-conditions/31697711#31697711", "title": "Rails Search with multiple Conditions", "body": "<p>I've encountered the problem of having to create different searches based on query params as well and created a little gem to help me.</p>\n\n<p><a href=\"https://github.com/fortytools/forty_facets\" rel=\"nofollow\">https://github.com/fortytools/forty_facets</a></p>\n"}, {"comments": [{"owner": {"reputation": 50195, "user_id": 155196, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/ri3X9.jpg?s=128&g=1", "display_name": "Harsha M V", "link": "https://stackoverflow.com/users/155196/harsha-m-v"}, "edited": false, "score": 0, "creation_date": 1438167901, "post_id": 31697730, "comment_id": 51336506, "body": "yeah changed that to <code>host_type</code> when some one visits the Search page from the link Events i wanna display all the events thats why i was doing <code>.all</code>"}], "tags": [], "owner": {"reputation": 312, "user_id": 865168, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/U2zgb.jpg?s=128&g=1", "display_name": "CJW", "link": "https://stackoverflow.com/users/865168/cjw"}, "is_accepted": false, "score": 1, "last_activity_date": 1438165327, "creation_date": 1438165327, "answer_id": 31697730, "question_id": 31696091, "link": "https://stackoverflow.com/questions/31696091/rails-search-with-multiple-conditions/31697730#31697730", "title": "Rails Search with multiple Conditions", "body": "<p>In your edit should your second check for params[:query].present? be for params[:host_type]? </p>\n\n<p>Also in the case where you have a query string you are making a call to .all first then immediately filtering on a LIKE so you should consider refactoring this as it will be a performance issue because you wouldn't have needed to make the call to .all and it will result in an additional query. </p>\n"}], "owner": {"reputation": 50195, "user_id": 155196, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/ri3X9.jpg?s=128&g=1", "display_name": "Harsha M V", "link": "https://stackoverflow.com/users/155196/harsha-m-v"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 685, "favorite_count": 1, "accepted_answer_id": 31696634, "answer_count": 6, "score": 2, "last_activity_date": 1544093623, "creation_date": 1438161172, "last_edit_date": 1544093623, "question_id": 31696091, "link": "https://stackoverflow.com/questions/31696091/rails-search-with-multiple-conditions", "title": "Rails Search with multiple Conditions", "body": "<p>I am trying to search for results with the following conditions</p>\n\n<blockquote>\n  <p>Hosts has_many events</p>\n  \n  <p>hosts(id, name, host_type, ....) </p>\n  \n  <p>events(id, name, host_id, ....)</p>\n</blockquote>\n\n<ol>\n<li>Default Showing all Events results</li>\n<li>Showing results based on the <code>query</code> on Events</li>\n<li>Based on if <code>host_type</code> has been chosen based on related Model <code>Hosts</code></li>\n</ol>\n\n<p>Right now i am doing an <code>if else</code> statement but as the options grows it will become too many conditional code.</p>\n\n<pre><code>if params[:query].blank?\n      @events_results = Event.order('event_date ASC').all\n    else\n      @events_results = Event.where(\"name LIKE '%#{params[:query]}%'\").order('event_date ASC').all\n    end\n</code></pre>\n\n<p><strong>EDIT</strong></p>\n\n<p>Based on some research and the answers i have modified to the following</p>\n\n<pre><code>  def index\n\n    @events_results ||= find_events\n\n  end\n\n  private\n\n  def find_events\n    events = Event.order('event_date ASC').all\n    events = events.where(\"name LIKE '%#{params[:query]}%'\") if params[:query].present?\n    events = events.includes(:host).where(\"Host.host_type = ?\", params[:host_type]) if params[:query].present?\n    events\n  end\n</code></pre>\n\n<p><strong>Error:</strong></p>\n\n<blockquote>\n  <p>Mysql2::Error: Unknown column 'Host.host_type' in 'where clause':\n  SELECT <code>events</code>.* FROM <code>events</code> WHERE (name LIKE '%menu%') AND\n  (Host.host_type = '1') ORDER BY event_date ASC</p>\n</blockquote>\n"}, {"tags": ["ruby-on-rails", "ruby"], "answers": [{"comments": [{"owner": {"reputation": 57, "user_id": 2717657, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/1a8bb4fdc5bfa38d54b781a98a3aa3ba?s=128&d=identicon&r=PG&f=1", "display_name": "inffy", "link": "https://stackoverflow.com/users/2717657/inffy"}, "edited": false, "score": 0, "creation_date": 1438169852, "post_id": 31696762, "comment_id": 51337742, "body": "Hey, that worked! Tried sessions before, but was catched by small syntax mistakes, as I see now. Thank you.  PS: For those who will perform this task, further i replaced params in all GET requests with session variable. + I replaced my &#39;city selection&#39; to main layout, that force me to update my selection such as : &lt;%= link_to city.name, url_for(city: city.name), :current_city =&gt; params[:city], :action =&gt; &#39;home&#39;%&gt; . Hope this will help to someone else, &#39;cause it took me quite big time to handle."}], "tags": [], "owner": {"reputation": 951, "user_id": 4003753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/E8P02.jpg?s=128&g=1", "display_name": "dreamingblackcat", "link": "https://stackoverflow.com/users/4003753/dreamingblackcat"}, "is_accepted": true, "score": 1, "last_activity_date": 1438162960, "creation_date": 1438162960, "answer_id": 31696762, "question_id": 31695686, "link": "https://stackoverflow.com/questions/31695686/ruby-on-rails-filtering-page-result-by-multiple-params-and-save-parameters-to-th/31696762#31696762", "title": "Ruby on Rails filtering page result by multiple params and save parameters to the next page", "body": "<p>You can use <code>session</code>.</p>\n\n<pre><code>  if !params[:city].blank?\n    session[:current_city] = params[:city] \n    @city_id = City.find_by(name: params[:city]).id\n    @offers = Offer.where(city_id: @city_id).where(category_id: @category_id).order(\"created_at DESC\").paginate(page: params[:page], per_page: 4)\n  end\n\n  if !params[:category].blank?\n    session[:current_category] = params[:category]\n    @category_id = Category.find_by(name: params[:category]).id\n    @offers = Offer.where(category_id: @category_id).where(city_id: @city_id).order(\"created_at DESC\").paginate(page: params[:page], per_page: 4)\n  end \n</code></pre>\n\n<p>Then in the next controllers:</p>\n\n<pre><code>params[:city] = session[:current_city] unless params[:city].present?\nparams[:category] = session[:current_category] unless params[:city].present?\n</code></pre>\n\n<p>After that you can use the params[:city], params[:category] the same way</p>\n"}], "owner": {"reputation": 57, "user_id": 2717657, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/1a8bb4fdc5bfa38d54b781a98a3aa3ba?s=128&d=identicon&r=PG&f=1", "display_name": "inffy", "link": "https://stackoverflow.com/users/2717657/inffy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 287, "favorite_count": 3, "accepted_answer_id": 31696762, "answer_count": 1, "score": 1, "last_activity_date": 1438162960, "creation_date": 1438160031, "last_edit_date": 1438161394, "question_id": 31695686, "link": "https://stackoverflow.com/questions/31695686/ruby-on-rails-filtering-page-result-by-multiple-params-and-save-parameters-to-th", "title": "Ruby on Rails filtering page result by multiple params and save parameters to the next page", "body": "<p>Basically I have 4 controllers: one with products, one with categories for this products, one for managing cities, and one for distributing data to the front end (contains static pages, main logic is filtrating showing results).</p>\n\n<p>For now I have the aim to filter my products by city and by category in the same time. I've done basic solution with passing params to url and processing them in my controller.</p>\n\n<pre><code>/main/home.html.erb/\n&lt;%- City.all.each do |city|%&gt;\n    &lt;%= link_to city.name, url_for(category: params[:category], city: city.name)%&gt;\n&lt;% end %&gt;\n\n&lt;% Category.all.each do |category| %&gt;\n&lt;%= link_to category.name, root_path(category: category.name, city: params[:city]) %&gt;\n</code></pre>\n\n\n\n<p>And in the Main controller I have something like for Home action:</p>\n\n<pre><code>def home\n  @city = City.all\n  @offers = Offer.all\n  @category = Category.all\n\n  if !params[:city].blank? \n    @city_id = City.find_by(name: params[:city]).id\n    @offers = Offer.where(city_id: @city_id).where(category_id: @category_id).order(\"created_at DESC\").paginate(page: params[:page], per_page: 4)\n  end\n\n  if !params[:category].blank?\n    @category_id = Category.find_by(name: params[:category]).id\n    @offers = Offer.where(category_id: @category_id).where(city_id: @city_id).order(\"created_at DESC\").paginate(page: params[:page], per_page: 4)\n  end \nend\n</code></pre>\n\n<p>That's make filtering, but after I got redirected to another page, I have to pick up my city again. How to save it for the session?\nAnd may be there is more proper solution to handle this task?<br>\nWhat should I do to get this thing work ?</p>\n\n<p>Thank you in advance.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "activeadmin"], "answers": [{"tags": [], "owner": {"reputation": 635, "user_id": 2267779, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/XVJkU.jpg?s=128&g=1", "display_name": "Miguel Cunha", "link": "https://stackoverflow.com/users/2267779/miguel-cunha"}, "is_accepted": false, "score": 0, "last_activity_date": 1438163272, "creation_date": 1438163272, "answer_id": 31696890, "question_id": 31695125, "link": "https://stackoverflow.com/questions/31695125/rails-activeadmin-change-collection-by-param/31696890#31696890", "title": "Rails ActiveAdmin Change Collection By Param", "body": "<p>Try something like this:</p>\n\n<pre><code>div do\n  Review.where(reviews_id: resource).collect do |review|\n    link_to User.find_by(user_id_eq: user.id), admin_review_path(Person.find_by(user_id_eq: user.id))\n  end\nend\n</code></pre>\n"}], "owner": {"reputation": 5529, "user_id": 1032663, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/nQ6Rw.jpg?s=128&g=1", "display_name": "Joel_Blum", "link": "https://stackoverflow.com/users/1032663/joel-blum"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 50, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1438163272, "creation_date": 1438158361, "last_edit_date": 1438158696, "question_id": 31695125, "link": "https://stackoverflow.com/questions/31695125/rails-activeadmin-change-collection-by-param", "title": "Rails ActiveAdmin Change Collection By Param", "body": "<p>I'm working on a project that has 'users' and 'reviews' activeadmin resources:  In the 'users' tab when you show a user I need to have a link to the specific user's reviews . \nCurrently there's a sidebar that links to the reviews </p>\n\n<pre><code>#(user.rb)\ndiv do\n  link_to \"Reviews - #{user.reviews.count}\", admin_reviews_path(q: {user_id_eq: user.id})\nend\n</code></pre>\n\n<p>But this just leads to the reviews tab and doesn't show the specific user's reviews (the param seems to be meaningless). \nAny advice on how I can change the index method in reviews tab to render a different collection by the param?</p>\n\n<pre><code> #somehow make this action return all reviews that belong to a user if the param is there\n #(reviews.rb)\n\n  index do\n  selectable_column\n  column :reviewer\n  column :product\n   ...\n</code></pre>\n"}, {"tags": ["ruby", "testing", "rspec"], "answers": [{"comments": [{"owner": {"reputation": 4127, "user_id": 4231385, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d89a541a4609cafea3957e4cdfcca50f?s=128&d=identicon&r=PG&f=1", "display_name": "cremno", "link": "https://stackoverflow.com/users/4231385/cremno"}, "edited": false, "score": 3, "creation_date": 1438160129, "post_id": 31695297, "comment_id": 51331452, "body": "<code>%{a e i o u}</code> should&#39;ve been <code>%w{a e i o u}</code>, shouldn&#39;t it? <code>%{}</code> is an obscure way to create a string (including all space characters unlike <code>%w()</code>)."}, {"owner": {"reputation": 312231, "user_id": 2225682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4958f4712d94ab82fe55fa471308e4b5?s=128&d=identicon&r=PG", "display_name": "falsetru", "link": "https://stackoverflow.com/users/2225682/falsetru"}, "reply_to_user": {"reputation": 4127, "user_id": 4231385, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d89a541a4609cafea3957e4cdfcca50f?s=128&d=identicon&r=PG&f=1", "display_name": "cremno", "link": "https://stackoverflow.com/users/4231385/cremno"}, "edited": false, "score": 1, "creation_date": 1438160170, "post_id": 31695297, "comment_id": 51331485, "body": "@cremno, Thank you for pointing that out. I fixed the code accordingly."}], "tags": [], "owner": {"reputation": 312231, "user_id": 2225682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4958f4712d94ab82fe55fa471308e4b5?s=128&d=identicon&r=PG", "display_name": "falsetru", "link": "https://stackoverflow.com/users/2225682/falsetru"}, "is_accepted": true, "score": 5, "last_activity_date": 1438160156, "last_edit_date": 1438160156, "creation_date": 1438158880, "answer_id": 31695297, "question_id": 31695085, "link": "https://stackoverflow.com/questions/31695085/ruby-conditional-test/31695297#31695297", "title": "Ruby Conditional Test", "body": "<p><code>\"a\" || \"e\" || \"i\" || \"o\" || \"u\"</code> is evaluated to <code>\"a\"</code> because <code>\"a\"</code> is truth value. (not a <code>nil</code>, not a <code>false</code>):</p>\n\n<pre><code>irb(main):001:0&gt; (\"a\" || \"e\" || \"i\" || \"o\" || \"u\")\n=&gt; \"a\"\nirb(main):002:0&gt; \"a\" == (\"a\" || \"e\" || \"i\" || \"o\" || \"u\")\n=&gt; true\nirb(main):003:0&gt; \"e\" == (\"a\" || \"e\" || \"i\" || \"o\" || \"u\")\n=&gt; false\n</code></pre>\n\n<p>How about using <a href=\"http://ruby-doc.org/core/Array.html#method-i-include-3F\"><code>Array#include?</code></a> instead:</p>\n\n<pre><code>irb(main):001:0&gt; %w{a e i o u}.include? \"a\"\n=&gt; true\nirb(main):002:0&gt; %w{a e i o u}.include? \"e\"\n=&gt; true\n</code></pre>\n\n<p>or using <code>=~</code> (regular expression match):</p>\n\n<pre><code>irb(main):007:0&gt; \"e\" =~ /[aeiou]/\n=&gt; 0\n</code></pre>\n"}], "owner": {"reputation": 551, "user_id": 4613575, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/94ee57c5cea9f3b94b68b7e5cf76369e?s=128&d=identicon&r=PG&f=1", "display_name": "hackrnaut", "link": "https://stackoverflow.com/users/4613575/hackrnaut"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 70, "favorite_count": 0, "accepted_answer_id": 31695297, "answer_count": 1, "score": 1, "last_activity_date": 1438281749, "creation_date": 1438158274, "last_edit_date": 1438281749, "question_id": 31695085, "link": "https://stackoverflow.com/questions/31695085/ruby-conditional-test", "title": "Ruby Conditional Test", "body": "<p>I can't make my code pass this test:</p>\n\n<pre><code>it \"translates two words\" do\n    s = translate(\"eat pie\")\n    s.should == \"eatay iepay\"\n  end\n</code></pre>\n\n<p>I don't see the flaw in my logic, though it may be very brute force and there may be a simpler way of passing the test:</p>\n\n<pre><code>def translate(string)\n    string_array = string.split\n    string_length = string_array.size\n    i=0\n\n    while i &lt; string_length\n        word = string_array[i]\n        if word[0] == (\"a\" || \"e\" || \"i\" || \"o\" || \"u\")\n            word = word + \"ay\"\n            string_array[i] = word\n\n        elsif word[0] != ( \"a\" || \"e\" || \"i\" || \"o\" || \"u\" ) &amp;&amp; word[1] != ( \"a\" || \"e\" || \"i\" || \"o\" || \"u\" )\n            word_length = word.length-1\n            word = word[2..word_length]+word[0]+word[1]+\"ay\"\n            string_array[i] = word\n\n        elsif word[0] != ( \"a\" || \"e\" || \"i\" || \"o\" || \"u\" )\n            word_length = word.length-1\n            word = word[1..word_length]+word[0]+\"ay\"\n            string_array[i] = word\n        end\n\n        i += 1\n    end\n    return string_array.join(\" \")\nend\n</code></pre>\n\n<p>Here's the test failure message:</p>\n\n<p>Failures:</p>\n\n<pre><code> 1) #translate translates two words\n     Failure/Error: s.should == \"eatay iepay\"\n       expected: \"eatay iepay\"\n            got: \"ateay epiay\" (using ==)\n     # ./04_pig_latin/pig_latin_spec.rb:41:in `block (2 levels) in &lt;top (required)&gt;'\n</code></pre>\n\n<p>The additional code checking other conditions are for other tests that I already passed. Basically, now I'm checking a string with two words. </p>\n\n<p>Please let me know how I can make the code pass the test. Thank you in advance!</p>\n"}, {"tags": ["ruby", "rubygems"], "answers": [{"tags": [], "owner": {"reputation": 10611, "user_id": 973810, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/fc35612d4cb8ba65f31a6d028bcf138e?s=128&d=identicon&r=PG", "display_name": "Darth Egregious", "link": "https://stackoverflow.com/users/973810/darth-egregious"}, "is_accepted": false, "score": 1, "last_activity_date": 1439406648, "creation_date": 1439406648, "answer_id": 31973522, "question_id": 31694589, "link": "https://stackoverflow.com/questions/31694589/ruby-gem-sample-form/31973522#31973522", "title": "Ruby gem sample_form", "body": "<p>It looks like a simple spelling error. You want <code>:day</code>, not <code>:date</code>.</p>\n"}], "owner": {"reputation": 69, "user_id": 1865767, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c6c83ae6bdbf053198005364c670cbf3?s=128&d=identicon&r=PG", "display_name": "Ravi Kant", "link": "https://stackoverflow.com/users/1865767/ravi-kant"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 21, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1439406648, "creation_date": 1438156855, "last_edit_date": 1438331712, "question_id": 31694589, "link": "https://stackoverflow.com/questions/31694589/ruby-gem-sample-form", "title": "Ruby gem sample_form", "body": "<p>I am using Rails 4.1.6 &amp; Ruby 2.1.5</p>\n\n<p>I want drop-down for all date ie. 1st drop-down should be for Month, 2nd drop-down should be for Date &amp; Last drop-down will be for Year.</p>\n\n<p>M using <code>daterangepicker-bs3</code> &amp; <code>sample_form gem</code>.</p>\n\n<p>i written in <code>_form.hatml.haml</code></p>\n\n<pre><code>= f.input :date_of_birth,order: [:month,:year]\n</code></pre>\n\n<p>So now Month &amp; Year is coming in drop-down. I want date also in drop-down between of month &amp; year, ie. month, date, year format.</p>\n\n<p>For this I tried in same way:</p>\n\n<pre><code>= f.input :date_of_birth,order: [:month,:date,:year]\n</code></pre>\n\n<p>after putting date, it shows error </p>\n\n<blockquote>\n  <p>\"stack level too deep\"</p>\n</blockquote>\n\n<p>Can anyone help me? </p>\n"}, {"tags": ["ruby-on-rails", "ruby", "activerecord", "activeadmin"], "answers": [{"tags": [], "owner": {"reputation": 5714, "user_id": 2389501, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/23f6a708c04c660111117c4613592689?s=128&d=identicon&r=PG", "display_name": "Mateusz Urba\u0144ski", "link": "https://stackoverflow.com/users/2389501/mateusz-urba%c5%84ski"}, "is_accepted": true, "score": 12, "last_activity_date": 1584012927, "last_edit_date": 1584012927, "creation_date": 1438158494, "answer_id": 31695165, "question_id": 31694398, "link": "https://stackoverflow.com/questions/31694398/use-activerecord-scope-in-activeadmin-filter/31695165#31695165", "title": "Use ActiveRecord scope in ActiveAdmin filter", "body": "<p>Add to model:</p>\n\n<pre><code>  def self.ransackable_scopes(_auth_object = nil)\n    [:by_survey_name]\n  end\n</code></pre>\n\n<p>and then in resource:</p>\n\n<pre><code>  filter :by_survey_name, as: :string\n</code></pre>\n"}], "owner": {"reputation": 5714, "user_id": 2389501, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/23f6a708c04c660111117c4613592689?s=128&d=identicon&r=PG", "display_name": "Mateusz Urba\u0144ski", "link": "https://stackoverflow.com/users/2389501/mateusz-urba%c5%84ski"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2536, "favorite_count": 0, "accepted_answer_id": 31695165, "answer_count": 1, "score": 3, "last_activity_date": 1584012927, "creation_date": 1438156289, "question_id": 31694398, "link": "https://stackoverflow.com/questions/31694398/use-activerecord-scope-in-activeadmin-filter", "title": "Use ActiveRecord scope in ActiveAdmin filter", "body": "<p>In my rails project I have model :</p>\n\n<pre><code>class Panel &lt; ActiveRecord::Base\n  has_many :surveys\n\n  scope :by_survey_name, -&gt;(survey_name) {\n    joins(:surveys).where('surveys.survey_name LIKE (?)', \"%#{survey_name}%\")\n  }\nend\n</code></pre>\n\n<p>And the question is how can I use this scope in activeadmin fiter?</p>\n"}, {"tags": ["ruby", "instagram"], "answers": [{"tags": [], "owner": {"reputation": 3, "user_id": 484744, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/y2MyO.jpg?s=128&g=1", "display_name": "f00k", "link": "https://stackoverflow.com/users/484744/f00k"}, "is_accepted": false, "score": 0, "last_activity_date": 1438162391, "creation_date": 1438162391, "answer_id": 31696546, "question_id": 31694253, "link": "https://stackoverflow.com/questions/31694253/how-to-check-if-instagram-image-has-been-removed/31696546#31696546", "title": "How to check if Instagram image has been removed", "body": "<p>You might need to use the API. Please check the media endpoints of Instagram's API if it helps:</p>\n\n<p><a href=\"https://instagram.com/developer/endpoints/media/#get_media\" rel=\"nofollow\">https://instagram.com/developer/endpoints/media/#get_media</a></p>\n"}], "owner": {"reputation": 1077, "user_id": 1425596, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/888a706c6bd51bb4272e069b835f1f3f?s=128&d=identicon&r=PG", "display_name": "Silverfall05", "link": "https://stackoverflow.com/users/1425596/silverfall05"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 396, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1438164241, "creation_date": 1438155872, "question_id": 31694253, "link": "https://stackoverflow.com/questions/31694253/how-to-check-if-instagram-image-has-been-removed", "title": "How to check if Instagram image has been removed", "body": "<p>I've been trying to detect if Instagram image has been removed to hide those photos in my DB. </p>\n\n<p>Right now I'm storing Instagram image short codes. And accessing images with <code>\"https://instagram.com/p/#{shortcode}\"</code></p>\n\n<p>And if you access for example legit url with (Ruby):\n<code>open \"https://instagram.com/p/1\"</code> then it returns 200 OK,\non the other hand random not existing page throws exception 404.</p>\n\n<p>But sometimes it seems to throw 404 on legitimate page, thats why my code does things which it shouldn't do on them.</p>\n\n<pre><code>begin\n      link = \"https://instagram.com/p/#{submission.image}\"\n      submission.visible = true\n      open link, :allow_redirections =&gt; :all\nrescue OpenURI::HTTPError =&gt; e\n      if e.message.include? '404 NOT FOUND'\n        submission.visible = false\n      end\nend\n</code></pre>\n\n<p>Do you have any ideas?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "nested-attributes"], "answers": [{"tags": [], "owner": {"reputation": 47232, "user_id": 1772830, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/Qtoqg.jpg?s=128&g=1", "display_name": "Andrey Deineko", "link": "https://stackoverflow.com/users/1772830/andrey-deineko"}, "is_accepted": true, "score": 1, "last_activity_date": 1438155980, "creation_date": 1438155980, "answer_id": 31694291, "question_id": 31693870, "link": "https://stackoverflow.com/questions/31693870/attributes-in-nested-models/31694291#31694291", "title": "Attributes in Nested Models", "body": "<pre><code>&lt;% @trip.locations.each do |location| %&gt;\n  &lt;%= location.address %&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>This will iterate over all <code>@trip</code>'s locations and print them out.</p>\n\n<p>In Ruby you don't use for loops. Read about iterators in Ruby.</p>\n\n<p>To get first location from <code>@trip</code> you would do:</p>\n\n<pre><code>@trip.locations.first\n</code></pre>\n\n<p>To get last location:</p>\n\n<pre><code>@trip.locations.last\n</code></pre>\n\n<p>Calculate the distance between these two:</p>\n\n<pre><code>&lt;% @distance = Geocoder::Calculations.distance_between(@trip.locations.first, @trip.locations.last) %&gt;\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 32451, "user_id": 2516474, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a2179a340c0e84edc285d432211145d?s=128&d=identicon&r=PG", "display_name": "SteveTurczyn", "link": "https://stackoverflow.com/users/2516474/steveturczyn"}, "is_accepted": false, "score": 0, "last_activity_date": 1438157313, "creation_date": 1438157313, "answer_id": 31694750, "question_id": 31693870, "link": "https://stackoverflow.com/questions/31693870/attributes-in-nested-models/31694750#31694750", "title": "Attributes in Nested Models", "body": "<p>You can loop through the locations, tracking the last location so you have it for calculating distance with the current location.</p>\n\n<pre><code>&lt;% last_location_address = nil %&gt;\n&lt;% @trip.locations.each do |location| %&gt;\n  &lt;% if last_location_address\n    &lt;% distance = Geocoder::Calculations.distance_between(last_location_address, location.address) %&gt;\n    &lt;%= distance # this line outputs the distance %&gt;\n  &lt;% end %&gt;\n  &lt;% last_location_address = location.address %&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>But this is a lot of code for a view... I'd be tempted to do the calculations in the controller to create a distance array for the view.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user4865423"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 27, "favorite_count": 0, "accepted_answer_id": 31694291, "answer_count": 2, "score": 0, "last_activity_date": 1438157313, "creation_date": 1438154776, "question_id": 31693870, "link": "https://stackoverflow.com/questions/31693870/attributes-in-nested-models", "title": "Attributes in Nested Models", "body": "<p>I'm trying to get two attributes from:</p>\n\n<pre><code>&lt;% for location in @trip.locations %&gt;\n&lt;%= location.address %&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>and put them in the method to calculate distance between them:</p>\n\n<pre><code>&lt;% @distance = Geocoder::Calculations.distance_between(address1, address2) %&gt;\n</code></pre>\n\n<p>I was trying to use f.e @trip.locations.first(1) but I was receiving only the first letter of these two adresses and I couldn't fit in in method (wrong number of arguments - 1 for 2)</p>\n\n<p>I'd appreciate any help.</p>\n"}, {"tags": ["ruby", "squib"], "answers": [{"comments": [{"owner": {"reputation": 8426, "user_id": 172651, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/9d9de81cb27ce70435bdc6418ef7df1c?s=128&d=identicon&r=PG", "display_name": "Evolve", "link": "https://stackoverflow.com/users/172651/evolve"}, "edited": false, "score": 0, "creation_date": 1438178927, "post_id": 31700313, "comment_id": 51344352, "body": "So just to clarify I should 1. Download the font and install it as a system font (done) 2. Where do I put the &#39;text font: Fira Sans&#39;? In the layout I had copied from your example on the homepage and have &#39;font: FiraSans Regular, sans 72&#39; in my layout.yml under &#39;Title:&#39; and similar sections. Is this right, because it&#39;s not working. Can you outline exactly what code I need where, using your example code from the squib homepage as the starting point. Thx"}, {"owner": {"reputation": 270, "user_id": 1325339, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c76f91c37fd0a6386de232f58f585ab0?s=128&d=identicon&r=PG", "display_name": "Andy", "link": "https://stackoverflow.com/users/1325339/andy"}, "reply_to_user": {"reputation": 8426, "user_id": 172651, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/9d9de81cb27ce70435bdc6418ef7df1c?s=128&d=identicon&r=PG", "display_name": "Evolve", "link": "https://stackoverflow.com/users/172651/evolve"}, "edited": false, "score": 0, "creation_date": 1438181826, "post_id": 31700313, "comment_id": 51346666, "body": "require &#39;squib&#39;  Squib::Deck.new(cards: 2) do   background color: &#39;white&#39;   text str: %w(Hello World!), font: &#39;Serif Bold 42&#39;   save_png prefix: &#39;basic_&#39; end"}, {"owner": {"reputation": 270, "user_id": 1325339, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c76f91c37fd0a6386de232f58f585ab0?s=128&d=identicon&r=PG", "display_name": "Andy", "link": "https://stackoverflow.com/users/1325339/andy"}, "reply_to_user": {"reputation": 8426, "user_id": 172651, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/9d9de81cb27ce70435bdc6418ef7df1c?s=128&d=identicon&r=PG", "display_name": "Evolve", "link": "https://stackoverflow.com/users/172651/evolve"}, "edited": false, "score": 0, "creation_date": 1438181915, "post_id": 31700313, "comment_id": 51346741, "body": "Sorry - that last comment didn&#39;t format the way I meant it:. Here&#39;s a gist: <a href=\"https://gist.github.com/andymeneely/69b8d34c6b2951f9154f\" rel=\"nofollow noreferrer\">gist.github.com/andymeneely/69b8d34c6b2951f9154f</a>"}, {"owner": {"reputation": 270, "user_id": 1325339, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c76f91c37fd0a6386de232f58f585ab0?s=128&d=identicon&r=PG", "display_name": "Andy", "link": "https://stackoverflow.com/users/1325339/andy"}, "reply_to_user": {"reputation": 8426, "user_id": 172651, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/9d9de81cb27ce70435bdc6418ef7df1c?s=128&d=identicon&r=PG", "display_name": "Evolve", "link": "https://stackoverflow.com/users/172651/evolve"}, "edited": false, "score": 0, "creation_date": 1438257097, "post_id": 31700313, "comment_id": 51382318, "body": "Great!! Glad you got it."}, {"owner": {"reputation": 8426, "user_id": 172651, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/9d9de81cb27ce70435bdc6418ef7df1c?s=128&d=identicon&r=PG", "display_name": "Evolve", "link": "https://stackoverflow.com/users/172651/evolve"}, "edited": false, "score": 0, "creation_date": 1438303651, "post_id": 31700313, "comment_id": 51407801, "body": "I managed to get it working by moving my font call into deck.rb as you suggest. I also just deleted my font settings in layout.yml so there was no potential for conflict. Does this mean that specifying fonts in layout.yml does not work?"}, {"owner": {"reputation": 270, "user_id": 1325339, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c76f91c37fd0a6386de232f58f585ab0?s=128&d=identicon&r=PG", "display_name": "Andy", "link": "https://stackoverflow.com/users/1325339/andy"}, "reply_to_user": {"reputation": 8426, "user_id": 172651, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/9d9de81cb27ce70435bdc6418ef7df1c?s=128&d=identicon&r=PG", "display_name": "Evolve", "link": "https://stackoverflow.com/users/172651/evolve"}, "edited": false, "score": 0, "creation_date": 1438305164, "post_id": 31700313, "comment_id": 51408105, "body": "You are absolutely right - sorry about that, that&#39;s a bug. I would have totally caught it if I had been actually working on my games then Squib because that&#39;s how I usually do it. Fortunately, that behavior is gone in v0.7, which I&#39;m releasing soon."}], "tags": [], "owner": {"reputation": 270, "user_id": 1325339, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c76f91c37fd0a6386de232f58f585ab0?s=128&d=identicon&r=PG", "display_name": "Andy", "link": "https://stackoverflow.com/users/1325339/andy"}, "is_accepted": true, "score": 1, "last_activity_date": 1438172652, "creation_date": 1438172652, "answer_id": 31700313, "question_id": 31693861, "link": "https://stackoverflow.com/questions/31693861/how-to-change-the-font-in-squib/31700313#31700313", "title": "How to change the font in Squib", "body": "<p>At this point in time, Squib doesn't support loading fonts locally. You'll have to install the font on your system, and then do something like <code>text font: 'FiraSans'</code>. I generally keep my font files in my git repo just for portability.</p>\n\n<p>Loading local fonts has been discussed by the Pango team (what Squib uses for text), and they are making the process less painful as I understand it. <a href=\"http://mces.blogspot.com/2015/05/how-to-use-custom-application-fonts.html\" rel=\"nofollow\">http://mces.blogspot.com/2015/05/how-to-use-custom-application-fonts.html</a>. It will be a while until that translates to Ruby, as well, since cross-platform compatibility is hard when it comes to fonts. </p>\n\n<p>I've created a GitHub issue to track on this if you want to follow it: </p>\n\n<p><a href=\"https://github.com/andymeneely/squib/issues/105\" rel=\"nofollow\">https://github.com/andymeneely/squib/issues/105</a></p>\n"}], "owner": {"reputation": 8426, "user_id": 172651, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/9d9de81cb27ce70435bdc6418ef7df1c?s=128&d=identicon&r=PG", "display_name": "Evolve", "link": "https://stackoverflow.com/users/172651/evolve"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 159, "favorite_count": 0, "accepted_answer_id": 31700313, "answer_count": 1, "score": 1, "last_activity_date": 1438172652, "creation_date": 1438154742, "last_edit_date": 1438156787, "question_id": 31693861, "link": "https://stackoverflow.com/questions/31693861/how-to-change-the-font-in-squib", "title": "How to change the font in Squib", "body": "<p>I want to change the font in Squib.\nHow do I do this.</p>\n\n<p>There is a font folder and also I can see where I set the font in the layout, do I need to set it anywhere else.</p>\n\n<p>I'm wanting to use FiraSans-Regular.otf and FiraSans-Heavy.otf</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "unicorn", ".bash-profile", "god"], "answers": [{"tags": [], "owner": {"reputation": 53, "user_id": 1287329, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ce1824cd4083bb94039baaa1d8ef370?s=128&d=identicon&r=PG", "display_name": "mitsu", "link": "https://stackoverflow.com/users/1287329/mitsu"}, "is_accepted": true, "score": 0, "last_activity_date": 1438232183, "creation_date": 1438232183, "answer_id": 31715442, "question_id": 31693830, "link": "https://stackoverflow.com/questions/31693830/god-using-sudo-fails-to-find-the-environment-parameter-secret-key-base-in-the-b/31715442#31715442", "title": "God using sudo fails to find the environment parameter SECRET_KEY_BASE in the .bash_profile file", "body": "<p>I added this line into the <code>my_app.god</code></p>\n\n<pre><code>ENV[\"SECRET_KEY_BASE\"] = 'xxxxxxxxxxxxxxxxxxxxxxxx'\n</code></pre>\n\n<p>I know that this isn't a cool solution, but it works. And SECRET_KEY_BASE isn't included in a Git repository as source code.</p>\n"}], "owner": {"reputation": 53, "user_id": 1287329, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ce1824cd4083bb94039baaa1d8ef370?s=128&d=identicon&r=PG", "display_name": "mitsu", "link": "https://stackoverflow.com/users/1287329/mitsu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 102, "favorite_count": 0, "accepted_answer_id": 31715442, "answer_count": 1, "score": 0, "last_activity_date": 1438232183, "creation_date": 1438154660, "question_id": 31693830, "link": "https://stackoverflow.com/questions/31693830/god-using-sudo-fails-to-find-the-environment-parameter-secret-key-base-in-the-b", "title": "God using sudo fails to find the environment parameter SECRET_KEY_BASE in the .bash_profile file", "body": "<p>I added those rows to <code>/home/web/.bash_profile</code>. The web is the user of Rails app.</p>\n\n<pre><code>SECRET_KEY_BASE=xxxxxxxxxxxxxxxxxxxxx\nexport SECRET_KEY_BASE\n</code></pre>\n\n<p>I added this row into <code>/etc/sudoers</code>.</p>\n\n<pre><code>Defaults env_keep += \"SECRET_KEY_BASE\"\n</code></pre>\n\n<p>This command returns expected result.</p>\n\n<pre><code>sudo ruby -e 'puts ENV[\"SECRET_KEY_BASE\"]'\n</code></pre>\n\n<p>If I run Unicorn without God, it can find SECRET_KEY_BASE from environment, and performs normally.</p>\n\n<pre><code>bundle exec unicorn_rails -c config/unicorn.rb -E production -D\n</code></pre>\n\n<p>Running Unicorn using sudo without God performs normally, too.</p>\n\n<pre><code>sudo bundle exec unicorn_rails -c config/unicorn.rb -E production -D\n</code></pre>\n\n<p>But when I run Unicorn with God using sudo, it failed to find SECRET_KEY_BASE and becomes error.</p>\n\n<pre><code>sudo god start my_app\n</code></pre>\n\n<p>The start command in the my_app.god is this.</p>\n\n<pre><code>God.watch do |w|\n  w.start = \"cd #{rails_root} &amp;&amp; bundle exec unicorn_rails -c config/unicorn.rb -E #{rails_env} -D\"\n  w.uid = 'web'\n  w.gid = 'web'\n...\nend\n</code></pre>\n\n<p>It seems that the problem exists around God rather than .bash_profile and Unicorn. Besides what should I try?</p>\n"}, {"tags": ["ruby", "multithreading", "thread-safety", "mutex"], "answers": [{"tags": [], "owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "is_accepted": true, "score": 3, "last_activity_date": 1438160989, "creation_date": 1438160989, "answer_id": 31696021, "question_id": 31693711, "link": "https://stackoverflow.com/questions/31693711/ruby-mutex-synchronize-without-wait/31696021#31696021", "title": "Ruby Mutex Synchronize without wait", "body": "<p><code>synchronize</code> merely</p>\n\n<blockquote>\n  <p>Obtains a lock, runs the block, and releases the lock when the block completes.</p>\n</blockquote>\n\n<p>Here's Rubinius' <a href=\"https://github.com/rubinius/rubinius/blob/2.2/kernel/common/mutex.rb#L59-L66\" rel=\"nofollow\">implementation</a></p>\n\n<pre><code>class Mutex\n  def synchronize\n    lock\n    begin\n      yield\n    ensure\n      unlock\n    end\n  end\nend\n</code></pre>\n\n<p>You can easily adopt this to write your own <code>try_synchronize</code>:</p>\n\n<pre><code>class Mutex\n  def try_synchronize\n    return unless try_lock\n    begin\n      yield\n    ensure\n      unlock\n    end\n  end\nend\n</code></pre>\n\n<p>MRI throws an exception if no block is given, so you might want to add a:</p>\n\n<pre><code>raise ThreadError, 'must be called with a block' unless block_given?\n</code></pre>\n"}], "owner": {"reputation": 8894, "user_id": 150050, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/a3036a782fc6c728ec1eba30e7b73b34?s=128&d=identicon&r=PG", "display_name": "aaa90210", "link": "https://stackoverflow.com/users/150050/aaa90210"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 502, "favorite_count": 0, "accepted_answer_id": 31696021, "answer_count": 1, "score": 0, "last_activity_date": 1438160989, "creation_date": 1438154268, "question_id": 31693711, "link": "https://stackoverflow.com/questions/31693711/ruby-mutex-synchronize-without-wait", "title": "Ruby Mutex Synchronize without wait", "body": "<p><a href=\"http://ruby-doc.org/core-1.9.3/Mutex.html\" rel=\"nofollow\">http://ruby-doc.org/core-1.9.3/Mutex.html</a></p>\n\n<p>Is there a way for Mutex.Synchronize to return immediately rather than waiting to obtain the lock, if it is being held by another thread at the time?</p>\n\n<p>In other words, the same behavior as try_lock.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-4", "carrierwave"], "comments": [{"owner": {"reputation": 5074, "user_id": 4207394, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/mmfTf.png?s=128&g=1", "display_name": "Deep", "link": "https://stackoverflow.com/users/4207394/deep"}, "edited": false, "score": 0, "creation_date": 1438154882, "post_id": 31693433, "comment_id": 51328249, "body": "Just try removing <code>dependent: :destroy</code> from this: <code>belongs_to :event, dependent: :destroy</code> in <code>EventPicture</code> model."}], "answers": [{"comments": [{"owner": {"reputation": 37, "user_id": 4357927, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh6.googleusercontent.com/-_axLKmdrzPw/AAAAAAAAAAI/AAAAAAAAAFo/WO3VQHf0JxA/photo.jpg?sz=128", "display_name": "Farhan Haider", "link": "https://stackoverflow.com/users/4357927/farhan-haider"}, "edited": false, "score": 0, "creation_date": 1438156294, "post_id": 31693936, "comment_id": 51329161, "body": "Yes this was the issue, problem solved. Thank You very much"}], "tags": [], "owner": {"reputation": 149, "user_id": 4843054, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ITnvV.jpg?s=128&g=1", "display_name": "AlexanderRD", "link": "https://stackoverflow.com/users/4843054/alexanderrd"}, "is_accepted": false, "score": 1, "last_activity_date": 1438154979, "creation_date": 1438154979, "answer_id": 31693936, "question_id": 31693433, "link": "https://stackoverflow.com/questions/31693433/ruby-on-rails-carrierwave-cannot-delete-image/31693936#31693936", "title": "Ruby On Rails [Carrierwave]: Cannot delete image", "body": "<p>I believe your error lies with this line</p>\n\n<pre><code>belongs_to :event, dependent: :destroy\n</code></pre>\n\n<p>This is telling the EventPicture model to delete its parent model Event when it is deleted.</p>\n\n<p>Replace with</p>\n\n<pre><code>belongs_to :event\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 5074, "user_id": 4207394, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/mmfTf.png?s=128&g=1", "display_name": "Deep", "link": "https://stackoverflow.com/users/4207394/deep"}, "is_accepted": true, "score": 2, "last_activity_date": 1438155072, "creation_date": 1438155072, "answer_id": 31693966, "question_id": 31693433, "link": "https://stackoverflow.com/questions/31693433/ruby-on-rails-carrierwave-cannot-delete-image/31693966#31693966", "title": "Ruby On Rails [Carrierwave]: Cannot delete image", "body": "<p>In your <code>EventPicture</code> model you have <code>dependent: :destroy</code> on the association which means that when the picture will deleted the corresponding events too. So just edit the association and make it:</p>\n\n<pre><code>belongs_to :event\n</code></pre>\n\n<p>And you have dependent destroy on the <code>Event</code> model so when a event will be deleted the corresponding pictures too will get deleted which is correct.</p>\n\n<p>Hope this helps.</p>\n"}], "owner": {"reputation": 37, "user_id": 4357927, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh6.googleusercontent.com/-_axLKmdrzPw/AAAAAAAAAAI/AAAAAAAAAFo/WO3VQHf0JxA/photo.jpg?sz=128", "display_name": "Farhan Haider", "link": "https://stackoverflow.com/users/4357927/farhan-haider"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 853, "favorite_count": 1, "accepted_answer_id": 31693966, "answer_count": 2, "score": 0, "last_activity_date": 1438155072, "creation_date": 1438153443, "last_edit_date": 1438153893, "question_id": 31693433, "link": "https://stackoverflow.com/questions/31693433/ruby-on-rails-carrierwave-cannot-delete-image", "title": "Ruby On Rails [Carrierwave]: Cannot delete image", "body": "<p>I'm a newbie in rails and trying to implement image uploading to ftp with 'carrierwave-ftp' gem. For image uploading, I have two controllers. First one is 'events_controller' while the second one is 'events_pictures_controller'.</p>\n\n<p>Pictures are getting uploading to ftp. But the problem is that when I'm deleting a single picture, it is destroying the entire event. Please help!</p>\n\n<p>Here is my Events Model:</p>\n\n<pre><code>class Event &lt; ActiveRecord::Base\n  has_many :event_pictures, dependent: :destroy\n  accepts_nested_attributes_for :event_pictures, allow_destroy: true\n  validates_presence_of :name, :date\nend\n</code></pre>\n\n<p>Here is my EventPictures Model:</p>\n\n<pre><code>class EventPicture &lt; ActiveRecord::Base\n  mount_uploader :picture_title, EventPicturesUploader\n  validates_presence_of :picture_title\n  belongs_to :event, dependent: :destroy\nend\n</code></pre>\n\n<p>Events Controller:    </p>\n\n<pre><code>def index\n    @events = Event.all.order('date DESC')\nend  \n\ndef show\n    @event_pictures = @event.event_pictures.all\nend\n\ndef new\n    @event = Event.new\n    @event_picture = @event.event_pictures.build\nend\n\ndef edit\nend\n\ndef create\n    @event = Event.new(event_params)\n      respond_to do |format|\n        if @event.save\n          params[:event_pictures]['picture_title'].each do |a|\n            @event_picture = @event.event_pictures.create!(:picture_title =&gt; a, :event_id =&gt; @event.id)\n          end\n      format.html { redirect_to @event, notice: 'Event was successfully created.' }\n        else\n      format.html { render :new }\n    end\n  end\nend\n\ndef destroy\n    @event = Event.find params[:id]\n    @event.destroy\n    redirect_to events_url\nend\n\nprivate\n  def set_event\n      @event = Event.find(params[:id])\n  end\n\n  def event_params\n      params.require(:event).permit(:name, :date, event_pictures_attributes: [:id, :event_id, :picture_title])\n  end\n</code></pre>\n\n<p>This is the Destroy method in EventPictures Controller</p>\n\n<pre><code>def destroy\n    @event_picture = EventPicture.find params[:id]\n    @event_picture.destroy\n    redirect_to \"events_url\"\nend\n</code></pre>\n\n<p>Meanwhile in the events.show.html.erb, I have this:</p>\n\n<pre><code>&lt;% @event_pictures.each do |p| %&gt;    \n      &lt;%= link_to image_tag(p.picture_title_url, :class =&gt; 'event-img'), image_path(p.picture_title_url) %&gt;\n      &lt;%= link_to 'Delete', p, method: :delete, data: { confirm: \"Are you sure?\" } %&gt;\n&lt;% end %&gt;\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-4", "heroku", "require"], "comments": [{"owner": {"reputation": 26120, "user_id": 219883, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/c35b5b0f9e7cce48864f4f1545ead995?s=128&d=identicon&r=PG", "display_name": "Taryn East", "link": "https://stackoverflow.com/users/219883/taryn-east"}, "edited": false, "score": 2, "creation_date": 1438151239, "post_id": 31692736, "comment_id": 51326194, "body": "put it in Gemfile. &quot;require&quot; might not be necessary at all (they often include that in doco in case you are using plain ruby)... if it doesn&#39;t Just Work, than add your require to your application.rb (not your controller), in <code>config&#47;application.rb</code>"}, {"owner": {"reputation": 5286, "user_id": 455770, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/mMHwz.jpg?s=128&g=1", "display_name": "Rots", "link": "https://stackoverflow.com/users/455770/rots"}, "edited": false, "score": 0, "creation_date": 1438152189, "post_id": 31692736, "comment_id": 51326744, "body": "Heroku bundle-installs the gems based on the Gemfile. You can review the Heroku build log in the console (after you have run git push)."}, {"owner": {"reputation": 7430, "user_id": 659751, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/X4DC1.jpg?s=128&g=1", "display_name": "hellomello", "link": "https://stackoverflow.com/users/659751/hellomello"}, "reply_to_user": {"reputation": 26120, "user_id": 219883, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/c35b5b0f9e7cce48864f4f1545ead995?s=128&d=identicon&r=PG", "display_name": "Taryn East", "link": "https://stackoverflow.com/users/219883/taryn-east"}, "edited": false, "score": 0, "creation_date": 1438178619, "post_id": 31692736, "comment_id": 51344151, "body": "@TarynEast if not in controller, but Gareth, mentioned it can be?"}, {"owner": {"reputation": 26120, "user_id": 219883, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/c35b5b0f9e7cce48864f4f1545ead995?s=128&d=identicon&r=PG", "display_name": "Taryn East", "link": "https://stackoverflow.com/users/219883/taryn-east"}, "edited": false, "score": 0, "creation_date": 1438216583, "post_id": 31692736, "comment_id": 51364479, "body": "Ye s&quot;it can&quot;... but generally that kind of thing clutters up your controller/model etc. Generally requires go all in the one place. Often you don&#39;t even need them with a gem (you just put it in your Gemfile... and Gemfile requires it for you see: <a href=\"http://stackoverflow.com/questions/4800721/bundler-what-does-require-false-in-a-gemfile-mean\" title=\"bundler what does require false in a gemfile mean\">stackoverflow.com/questions/4800721/&hellip;</a>)"}], "answers": [{"comments": [{"owner": {"reputation": 7430, "user_id": 659751, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/X4DC1.jpg?s=128&g=1", "display_name": "hellomello", "link": "https://stackoverflow.com/users/659751/hellomello"}, "edited": false, "score": 0, "creation_date": 1438152092, "post_id": 31692837, "comment_id": 51326672, "body": "But would I put it in a view.html.erb file? Or would it be better if I call it through the <code>model.rb</code>? Or it doesn&#39;t matter? Just as long as wherever the <code>Barometer.new</code> would be called would be okay? Just trying to figure out best practice purposes"}, {"owner": {"reputation": 114711, "user_id": 31582, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/17f2a7263e27c4c5a2093ea8d63389d4?s=128&d=identicon&r=PG", "display_name": "Gareth", "link": "https://stackoverflow.com/users/31582/gareth"}, "reply_to_user": {"reputation": 7430, "user_id": 659751, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/X4DC1.jpg?s=128&g=1", "display_name": "hellomello", "link": "https://stackoverflow.com/users/659751/hellomello"}, "edited": false, "score": 0, "creation_date": 1438153232, "post_id": 31692837, "comment_id": 51327346, "body": "You probably don&#39;t want to doing anything that makes network calls in your views. If the barometer code relates to a specific model then you should probably put the code in there, otherwise it should be in your controller - or if that comes to more than a few lines of code, in another module which is <i>called</i> by your controller"}, {"owner": {"reputation": 7430, "user_id": 659751, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/X4DC1.jpg?s=128&g=1", "display_name": "hellomello", "link": "https://stackoverflow.com/users/659751/hellomello"}, "edited": false, "score": 0, "creation_date": 1438153304, "post_id": 31692837, "comment_id": 51327380, "body": "Cool, makes sense. Thanks for your help!"}], "tags": [], "owner": {"reputation": 114711, "user_id": 31582, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/17f2a7263e27c4c5a2093ea8d63389d4?s=128&d=identicon&r=PG", "display_name": "Gareth", "link": "https://stackoverflow.com/users/31582/gareth"}, "is_accepted": true, "score": 2, "last_activity_date": 1438151469, "creation_date": 1438151469, "answer_id": 31692837, "question_id": 31692736, "link": "https://stackoverflow.com/questions/31692736/ruby-on-rails-where-to-put-the-require-files/31692837#31692837", "title": "Ruby on Rails: where to put the &#39;require&#39; files?", "body": "<blockquote>\n  <p>I've always used gems and put them in the gemfile, but I think this is different...</p>\n</blockquote>\n\n<p>No, this is no different. Barometer is a <a href=\"https://rubygems.org/gems/barometer\" rel=\"nofollow\">Rubygem</a> and putting it in your Gemfile is exactly the way to use it.</p>\n\n<p>As with every library, your require should go in whichever file uses the code, for example the same file that the <code>Barometer.new</code> call is. You don't always <em>need</em> the <code>require</code> line depending on your Ruby environment, but it's always a good idea to get used to it</p>\n"}], "owner": {"reputation": 7430, "user_id": 659751, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/X4DC1.jpg?s=128&g=1", "display_name": "hellomello", "link": "https://stackoverflow.com/users/659751/hellomello"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2422, "favorite_count": 0, "accepted_answer_id": 31692837, "answer_count": 1, "score": 0, "last_activity_date": 1438151469, "creation_date": 1438151134, "question_id": 31692736, "link": "https://stackoverflow.com/questions/31692736/ruby-on-rails-where-to-put-the-require-files", "title": "Ruby on Rails: where to put the &#39;require&#39; files?", "body": "<p>I'm trying to use this <code>gem barometer</code> and in the <a href=\"https://github.com/attack/barometer\" rel=\"nofollow\">document</a> it says that it can be used right out of the box with using <code>require 'barometer'</code></p>\n\n<p>I've always used gems and put them in the <code>gemfile</code>, but I think this is different...</p>\n\n<p>Do I just download this entire repo, and copy all the files in the <code>lib</code> folder into my <code>vendor</code> folder? or maybe <code>public</code> folder? </p>\n\n<p>Where would you typically put these files? And where would you include the <code>require</code>? Should this be in the <strong>application controller</strong>? Or maybe in the helper? Sorry for this really noob question.</p>\n\n<p>I know in my local environment, I can just type in <code>gem install barometer</code> in my console, and not have to put in a <code>require</code>, but I don't think this will work in heroku, or production environment.</p>\n"}, {"tags": ["mysql", "ruby-on-rails", "ruby", "sinatra"], "comments": [{"owner": {"reputation": 3210, "user_id": 5089231, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zX0dy.jpg?s=128&g=1", "display_name": "Athar", "link": "https://stackoverflow.com/users/5089231/athar"}, "edited": false, "score": 0, "creation_date": 1438151031, "post_id": 31692641, "comment_id": 51326076, "body": "are there any call backs on the deletion of user.?"}, {"owner": {"reputation": 207, "user_id": 2039486, "user_type": "registered", "accept_rate": 24, "profile_image": "https://www.gravatar.com/avatar/0433b8361c39089e68aea3753d90a8ae?s=128&d=identicon&r=PG", "display_name": "joe", "link": "https://stackoverflow.com/users/2039486/joe"}, "reply_to_user": {"reputation": 3210, "user_id": 5089231, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zX0dy.jpg?s=128&g=1", "display_name": "Athar", "link": "https://stackoverflow.com/users/5089231/athar"}, "edited": false, "score": 0, "creation_date": 1438152082, "post_id": 31692641, "comment_id": 51326666, "body": "@Athar, no there are no call backs."}, {"owner": {"reputation": 3210, "user_id": 5089231, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zX0dy.jpg?s=128&g=1", "display_name": "Athar", "link": "https://stackoverflow.com/users/5089231/athar"}, "edited": false, "score": 0, "creation_date": 1438152948, "post_id": 31692641, "comment_id": 51327163, "body": "then answer given below is perfect."}], "answers": [{"comments": [{"owner": {"reputation": 207, "user_id": 2039486, "user_type": "registered", "accept_rate": 24, "profile_image": "https://www.gravatar.com/avatar/0433b8361c39089e68aea3753d90a8ae?s=128&d=identicon&r=PG", "display_name": "joe", "link": "https://stackoverflow.com/users/2039486/joe"}, "edited": false, "score": 0, "creation_date": 1438152049, "post_id": 31692674, "comment_id": 51326642, "body": "delete_all, will delete in one shot right. is it safe to use this for deleting millions of records?  Thanks for your valuable solution :)"}, {"owner": {"reputation": 47232, "user_id": 1772830, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/Qtoqg.jpg?s=128&g=1", "display_name": "Andrey Deineko", "link": "https://stackoverflow.com/users/1772830/andrey-deineko"}, "reply_to_user": {"reputation": 207, "user_id": 2039486, "user_type": "registered", "accept_rate": 24, "profile_image": "https://www.gravatar.com/avatar/0433b8361c39089e68aea3753d90a8ae?s=128&d=identicon&r=PG", "display_name": "joe", "link": "https://stackoverflow.com/users/2039486/joe"}, "edited": false, "score": 0, "creation_date": 1438152234, "post_id": 31692674, "comment_id": 51326780, "body": "If you don&#39;t have callbacks to fire while deleting - this is the best way to perform such operation. Deleting like his millions of records is as safe as to delete 10 records :)"}, {"owner": {"reputation": 207, "user_id": 2039486, "user_type": "registered", "accept_rate": 24, "profile_image": "https://www.gravatar.com/avatar/0433b8361c39089e68aea3753d90a8ae?s=128&d=identicon&r=PG", "display_name": "joe", "link": "https://stackoverflow.com/users/2039486/joe"}, "edited": false, "score": 0, "creation_date": 1438152289, "post_id": 31692674, "comment_id": 51326817, "body": "Ok, let me try with this. Thanks again :)"}], "tags": [], "owner": {"reputation": 47232, "user_id": 1772830, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/Qtoqg.jpg?s=128&g=1", "display_name": "Andrey Deineko", "link": "https://stackoverflow.com/users/1772830/andrey-deineko"}, "is_accepted": true, "score": 3, "last_activity_date": 1438150937, "creation_date": 1438150937, "answer_id": 31692674, "question_id": 31692641, "link": "https://stackoverflow.com/questions/31692641/find-each-in-ruby-increase-the-speed-of-query/31692674#31692674", "title": "find each in ruby increase the speed of query", "body": "<p><a href=\"http://apidock.com/rails/ActiveRecord/Base/delete_all/class\" rel=\"nofollow\"><code>delete_all</code></a> will do the job faster then you can think:</p>\n\n<pre><code>@expired_users.delete_all\n</code></pre>\n\n<p>Use <a href=\"http://apidock.com/rails/ActiveRecord/Base/destroy\" rel=\"nofollow\"><code>destroy</code></a> only if you want to execute all associated callback while deleting the object.</p>\n"}], "owner": {"reputation": 207, "user_id": 2039486, "user_type": "registered", "accept_rate": 24, "profile_image": "https://www.gravatar.com/avatar/0433b8361c39089e68aea3753d90a8ae?s=128&d=identicon&r=PG", "display_name": "joe", "link": "https://stackoverflow.com/users/2039486/joe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 112, "favorite_count": 1, "accepted_answer_id": 31692674, "answer_count": 1, "score": 0, "last_activity_date": 1438150937, "creation_date": 1438150838, "question_id": 31692641, "link": "https://stackoverflow.com/questions/31692641/find-each-in-ruby-increase-the-speed-of-query", "title": "find each in ruby increase the speed of query", "body": "<p>I wanted to delete around 5 million or more records daily from our database which are actually expired users.</p>\n\n<p>I have used \"find_each\" batch process to delete these records, but its taking 1 day to delete only 1 million records, so it will take 5 days to delete 5 million records :( which is too much time consuming. </p>\n\n<p>Is there any quick way to safe delete millions of records from database in ruby.</p>\n\n<p>here is my code :</p>\n\n<pre><code>now = Date.today\n@expired_users = ExportUser.where(\"status != ? and DTSysModified &gt;= ? and DTSysModified &lt;= ?\", \"Active\", Date.new(now.year, 04, 1),  Date.new(now.year, 04, -1))\n\n@expired_users.find_each(batch_size: 10000) do |user|\n  user.destroy!\nend\n</code></pre>\n"}, {"tags": ["sql", "ruby-on-rails", "ruby", "rails-activerecord"], "comments": [{"owner": {"reputation": 26120, "user_id": 219883, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/c35b5b0f9e7cce48864f4f1545ead995?s=128&d=identicon&r=PG", "display_name": "Taryn East", "link": "https://stackoverflow.com/users/219883/taryn-east"}, "edited": false, "score": 0, "creation_date": 1438152199, "post_id": 31692451, "comment_id": 51326748, "body": "No, this is a different question. The above is where we know exactly these two given columns match. This question asks if any two out of three possible columns match"}, {"owner": {"reputation": 132, "user_id": 4991554, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/m67GX.jpg?s=128&g=1", "display_name": "Md.Mostafizur Rahman Sahed", "link": "https://stackoverflow.com/users/4991554/md-mostafizur-rahman-sahed"}, "reply_to_user": {"reputation": 26120, "user_id": 219883, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/c35b5b0f9e7cce48864f4f1545ead995?s=128&d=identicon&r=PG", "display_name": "Taryn East", "link": "https://stackoverflow.com/users/219883/taryn-east"}, "edited": false, "score": 0, "creation_date": 1438153731, "post_id": 31692451, "comment_id": 51327602, "body": "@Taryn East: Unfortunately this solution does not solve my problem. Because I expect those customer who have at-least any three common attributes. Anyway, Thanks, for your comment."}, {"owner": {"reputation": 26120, "user_id": 219883, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/c35b5b0f9e7cce48864f4f1545ead995?s=128&d=identicon&r=PG", "display_name": "Taryn East", "link": "https://stackoverflow.com/users/219883/taryn-east"}, "edited": false, "score": 0, "creation_date": 1438153996, "post_id": 31692451, "comment_id": 51327746, "body": "i have not suggested a solution at all. I voted against closing and gave my reason for not voting-to-close-as-duplicate. My comment was for the guy who voted to close as duplicate, not for you - sorry - i don&#39;t have a solution."}], "answers": [{"tags": [], "owner": {"reputation": 951, "user_id": 4003753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/E8P02.jpg?s=128&g=1", "display_name": "dreamingblackcat", "link": "https://stackoverflow.com/users/4003753/dreamingblackcat"}, "is_accepted": true, "score": 0, "last_activity_date": 1438159606, "creation_date": 1438159606, "answer_id": 31695546, "question_id": 31692451, "link": "https://stackoverflow.com/questions/31692451/find-duplicated-record-for-any-3-common-attributes/31695546#31695546", "title": "Find Duplicated record for any 3 common attributes", "body": "<p>This is the best I can come up with so far. Also not an SQL solution.</p>\n\n<pre><code># Arrange a 3-items combination of columns, removed id and timestamps\ntriplets = Customer.column_names.reject {|column| column == \"id\" || column == \"created_at\" || column == \"updated_at\"}.combination(3).to_a\n\n#Group All records by same item values for each 3-items combination\nall = Customer.all\nres = triplets.map do|t| \n  all.to_a.group_by {|c| [ {t[0] =&gt; c.send(t[0].to_sym)}, { t[1] =&gt; c.send(t[1].to_sym) }, {t[2] =&gt; c.send(t[2].to_sym)} ]} \nend  \n# removed combinations with only 1 record\nfinal_result = res.map {|h1| h1.reject { |k, v| v.count &lt;= 1}}\n\n# There you have customer with 3 attributes common combinations\n</code></pre>\n"}], "owner": {"reputation": 132, "user_id": 4991554, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/m67GX.jpg?s=128&g=1", "display_name": "Md.Mostafizur Rahman Sahed", "link": "https://stackoverflow.com/users/4991554/md-mostafizur-rahman-sahed"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 97, "favorite_count": 1, "accepted_answer_id": 31695546, "answer_count": 1, "score": 5, "last_activity_date": 1438159606, "creation_date": 1438150171, "last_edit_date": 1438154055, "question_id": 31692451, "link": "https://stackoverflow.com/questions/31692451/find-duplicated-record-for-any-3-common-attributes", "title": "Find Duplicated record for any 3 common attributes", "body": "<p>In my RoR Project, there is a Customer model with 10 attributes. Now I want to find those customers that have at-least any three common attributes. How can I make this query efficiently?</p>\n\n<p>Probably it's a solution:</p>\n\n<pre><code>Customer.select([:first_name,:last_name,:language]).\n         group(:first_name,:last_name,:language).having(\"count(*) &gt; 1\")\n</code></pre>\n\n<p>But this solution required too many combination to check. Please help with a better solution. </p>\n\n<p>Thanks! In Advance.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "amazon-sns", "aws-sdk", "mpns"], "comments": [{"owner": {"reputation": 138098, "user_id": 1695906, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/638d2ec6b52f3db1583890be23d74cc6?s=128&d=identicon&r=PG", "display_name": "Michael - sqlbot", "link": "https://stackoverflow.com/users/1695906/michael-sqlbot"}, "edited": false, "score": 0, "creation_date": 1438181588, "post_id": 31692402, "comment_id": 51346481, "body": "<code>message_structure: &#39;json&#39;</code> does <i>not</i> mean &quot;my payload is JSON.&quot;  If you are setting that because your payload is JSON, don&#39;t do that."}, {"owner": {"reputation": 3013, "user_id": 1776627, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/QTCMu.jpg?s=128&g=1", "display_name": "Nitin Jain", "link": "https://stackoverflow.com/users/1776627/nitin-jain"}, "reply_to_user": {"reputation": 138098, "user_id": 1695906, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/638d2ec6b52f3db1583890be23d74cc6?s=128&d=identicon&r=PG", "display_name": "Michael - sqlbot", "link": "https://stackoverflow.com/users/1695906/michael-sqlbot"}, "edited": false, "score": 0, "creation_date": 1438320510, "post_id": 31692402, "comment_id": 51411809, "body": "@Michael-sqlbot i can not set it as string . In string case the toast will show  up all the information to the user. This information in notification need to show partially and other part will be used by the app internally"}], "answers": [{"comments": [{"owner": {"reputation": 3013, "user_id": 1776627, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/QTCMu.jpg?s=128&g=1", "display_name": "Nitin Jain", "link": "https://stackoverflow.com/users/1776627/nitin-jain"}, "edited": false, "score": 0, "creation_date": 1438320604, "post_id": 31720900, "comment_id": 51411836, "body": "yeah i figured out that too. But have one more issue that toast are not coming when app is closed if device is 8.1 or higher"}], "tags": [], "owner": {"reputation": 2681, "user_id": 3952680, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hmYFM.jpg?s=128&g=1", "display_name": "vzsg", "link": "https://stackoverflow.com/users/3952680/vzsg"}, "is_accepted": false, "score": 1, "last_activity_date": 1438250951, "creation_date": 1438250951, "answer_id": 31720900, "question_id": 31692402, "link": "https://stackoverflow.com/questions/31692402/send-json-payload-to-mpns-by-aws-sns/31720900#31720900", "title": "Send Json Payload to MPNS by AWS SNS", "body": "<p>I'm awfully unfamiliar with the Ruby language, but it seems to me that your call lacks message attributes, which are mandatory for JSON-based MPNS messages.</p>\n\n<p>The two attributes are as follows:</p>\n\n<p>For reference, the attributes are the following:</p>\n\n<ol>\n<li><p>Attribute name: <code>AWS.SNS.MOBILE.MPNS.Type</code><br>\nType: string<br>\nPossible values: <code>token</code> (for <em>tile</em> notifications), <code>toast</code> or <code>raw</code>   </p></li>\n<li><p>Attribute name: <code>AWS.SNS.MOBILE.MPNS.NotificationClass</code><br>\nType: string<br>\nPossible values: <code>realtime</code>*, <code>priority</code>, <code>regular</code>\n(realtime worked for me with the Java SDK)</p></li>\n</ol>\n\n<p>So your last line should look like this:</p>\n\n<pre><code>resp = SNS.publish(\n    target_arn: \"arn:aws:sns:usXXXb64\",\n    message: paylaod.to_json,\n    message_structure: 'json',\n    message_attributes: {\n        \"AWS.SNS.MOBILE.MPNS.Type\" =&gt; {\n            data_type: \"String\",\n            string_value: \"toast\"\n        },\n        \"AWS.SNS.MOBILE.MPNS.NotificationClass\" =&gt; {\n            data_type: \"String\",\n            string_value: \"realtime\"\n        }\n    })\n</code></pre>\n\n<hr>\n\n<p>Note that the <code>message_structure: 'json'</code> line is equally important.</p>\n"}], "owner": {"reputation": 3013, "user_id": 1776627, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/QTCMu.jpg?s=128&g=1", "display_name": "Nitin Jain", "link": "https://stackoverflow.com/users/1776627/nitin-jain"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 730, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1438250951, "creation_date": 1438150013, "question_id": 31692402, "link": "https://stackoverflow.com/questions/31692402/send-json-payload-to-mpns-by-aws-sns", "title": "Send Json Payload to MPNS by AWS SNS", "body": "<p>I want to send a json payload to Windows phone 7+ in push notification. I am using <strong>MPNS</strong>.\nI am using <strong>AWS SNS</strong> service for sending push notification. IF i am sending a String payload .Everything works for string payload. I got stuck with <strong>Json payload</strong>.</p>\n\n<pre><code>paylaod = {default: \"None\", MPNS:  \"&lt;?xml version=\\\"1.0\\\" encoding=\\\"utf-8\\\"?&gt;&lt;wp:Notification xmlns=\\\"WPNotification\\\"&gt;&lt;wp:Toast&gt;&lt;wp:Text1&gt;SNS Test Message&lt;/wp:Text1&gt;&lt;/wp:Toast&gt;&lt;/wp:Notification&gt;\"}\n\nresp = SNS.publish( target_arn: \"arn:aws:sns:usXXXb64\", message: paylaod.to_json,  message_structure: 'json')\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 1514, "user_id": 3749865, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c1873b0d2c86671bb1b3d44b53b48c09?s=128&d=identicon&r=PG", "display_name": "Christian Rolle", "link": "https://stackoverflow.com/users/3749865/christian-rolle"}, "edited": false, "score": 0, "creation_date": 1438151388, "post_id": 31691929, "comment_id": 51326273, "body": "First: your edges array will always contain at least 1 number of the nodes array, since you search with where(follower_id: user_ids). Furthermore you can also find the user_ids by: User.where(challenge_id: 1).pluck(&#39;id&#39;) or nicer (but with instantiation): Challenge.find(1).user_ids.map(&amp;:to_s) But also consider that ActuiveRecord#find raises an exception if the record couldn&#39;t be found. Btw. the ids should defintely be unique and the array itself is flat."}, {"owner": {"reputation": 1514, "user_id": 3749865, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c1873b0d2c86671bb1b3d44b53b48c09?s=128&d=identicon&r=PG", "display_name": "Christian Rolle", "link": "https://stackoverflow.com/users/3749865/christian-rolle"}, "edited": false, "score": 0, "creation_date": 1438151920, "post_id": 31691929, "comment_id": 51326560, "body": "Finally is there no defined reflection between User and Relationship, you can use and then a Challenge.has_many :relationships, through: users ?"}], "answers": [{"tags": [], "owner": {"reputation": 951, "user_id": 4003753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/E8P02.jpg?s=128&g=1", "display_name": "dreamingblackcat", "link": "https://stackoverflow.com/users/4003753/dreamingblackcat"}, "is_accepted": true, "score": 1, "last_activity_date": 1438156996, "last_edit_date": 1438156996, "creation_date": 1438150189, "answer_id": 31692454, "question_id": 31691929, "link": "https://stackoverflow.com/questions/31691929/conditional-removal-of-elements-from-an-array/31692454#31692454", "title": "Conditional removal of elements from an array", "body": "<p>What I understand is you want to remove dangling relationships ( edges ) where both or one of  which are no longer in the users table( nodes array ).</p>\n\n<p>Then this should do it:</p>\n\n<pre><code>result[\"edges\"].select! {|edge| result[\"nodes\"].include?(edge[0]) &amp;&amp; result[\"nodes\"].include?(edge[1]) }\n</code></pre>\n"}], "owner": {"reputation": 5922, "user_id": 3632206, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/70c95cfa616112abaa8c04a878c256ed?s=128&d=identicon&r=PG&f=1", "display_name": "Sebastian Zeki", "link": "https://stackoverflow.com/users/3632206/sebastian-zeki"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 70, "favorite_count": 0, "accepted_answer_id": 31692454, "answer_count": 1, "score": 0, "last_activity_date": 1438156996, "creation_date": 1438148102, "question_id": 31691929, "link": "https://stackoverflow.com/questions/31691929/conditional-removal-of-elements-from-an-array", "title": "Conditional removal of elements from an array", "body": "<p>I am trying to construct some JSON data using my newly acquired but incomplete ruby knowledge. It basically is part of a rails application where the database is 1 user to many relationships (fields follower_id and followed_id). The format of the JSON should be:</p>\n\n<pre><code>{\"nodes\":[\"1\",\"102\",\"10\",\"61\",\"6\",\"54\",\"29\",\"84\",\"82\"],\"edges\":[[\"1\",\"54\"],[\"10\",\"29\"],[\"61\",\"84\"],[\"1\",\"61\"],[\"10\",\"82\"]]}\n</code></pre>\n\n<p>I would like to remove any edge arrays where both or one of the numbers are not present in the nodes array. The real files are likely to be much larger than this so the most efficient way possible to do this would be great.</p>\n\n<p>My code is as follows:</p>\n\n<pre><code>def self.joinup(id)\n  c = Challenge.find(1)\n  result={}\n  user_ids  =  c.users.pluck(:id)\n  result[\"nodes\"] = user_ids.collect(&amp;:to_s).flatten.uniq\n  result[\"edges\"] = Relationship.where(follower_id: user_ids).map{|h| [h.follower_id.to_s, h.followed_id.to_s]}\n\n  #if elements of edges are not present in nodes then remove doublet\n  result[\"nodes\"] = result[\"nodes\"]|result[\"edges\"].flatten\n  result\n end\n end\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "postgresql", "activerecord"], "comments": [{"owner": {"reputation": 32131, "user_id": 2346461, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/i3xAf.jpg?s=128&g=1", "display_name": "Pavan", "link": "https://stackoverflow.com/users/2346461/pavan"}, "edited": false, "score": 0, "creation_date": 1438146414, "post_id": 31691509, "comment_id": 51324369, "body": "Try this <code>Listing.joins(:user).limit(100)</code>"}, {"owner": {"reputation": 3232, "user_id": 2689002, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/zIvab.jpg?s=128&g=1", "display_name": "Amit Sharma", "link": "https://stackoverflow.com/users/2689002/amit-sharma"}, "edited": false, "score": 0, "creation_date": 1438151754, "post_id": 31691509, "comment_id": 51326463, "body": "can you pls post example hash of your expected output"}, {"owner": {"reputation": 990, "user_id": 465081, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/e912cfc9d363bf599de81ef674cdc882?s=128&d=identicon&r=PG", "display_name": "Houen", "link": "https://stackoverflow.com/users/465081/houen"}, "edited": false, "score": 1, "creation_date": 1438162478, "post_id": 31691509, "comment_id": 51333005, "body": ".joins won&#39;t work. That will just scope it to only listings with users, not include the User"}], "answers": [{"tags": [], "owner": {"reputation": 446, "user_id": 3758617, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d95235c454982860393ca013e815af1b?s=128&d=identicon&r=PG&f=1", "display_name": "Eugene G", "link": "https://stackoverflow.com/users/3758617/eugene-g"}, "is_accepted": false, "score": 0, "last_activity_date": 1438164226, "last_edit_date": 1495541168, "creation_date": 1438164226, "answer_id": 31697265, "question_id": 31691509, "link": "https://stackoverflow.com/questions/31691509/rails-how-to-retrieve-all-model-objects-along-with-its-foreign-relation-model-w/31697265#31697265", "title": "Rails: How to retrieve all model objects along with its foreign relation model with ActiveRecord?", "body": "<p>A left outer join should do it.  It wouldn't return it as a subhash, but rather you'd get 100 hashes in your response, each one containing all the user and all the listing info.  </p>\n\n<p>info on how to do a left outer join in rails 4 here\n<a href=\"https://stackoverflow.com/questions/24358805/left-join-in-rails-4\">LEFT OUTER JOIN in Rails 4</a></p>\n\n<p>So in your case</p>\n\n<p><code>Listing.joins('LEFT OUTER JOIN users ON listing.user_id = users.id limit 100')</code></p>\n\n<p>again not 100% what you're looking for but it does get all the info in one query. </p>\n"}, {"comments": [{"owner": {"reputation": 14023, "user_id": 1545308, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/f029a60367f0dc043566adc3320c9db5?s=128&d=identicon&r=PG", "display_name": "etayluz", "link": "https://stackoverflow.com/users/1545308/etayluz"}, "edited": false, "score": 0, "creation_date": 1438181179, "post_id": 31697274, "comment_id": 51346151, "body": "I&#39;m seeing a 4x time performance with direct SQL call to postgres, which also renders the json internally with row_to_json(). Wondering if there&#39;s a way to get that with Rails/ActiveRecord, not sure if the serializer would do it?"}, {"owner": {"reputation": 990, "user_id": 465081, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/e912cfc9d363bf599de81ef674cdc882?s=128&d=identicon&r=PG", "display_name": "Houen", "link": "https://stackoverflow.com/users/465081/houen"}, "reply_to_user": {"reputation": 14023, "user_id": 1545308, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/f029a60367f0dc043566adc3320c9db5?s=128&d=identicon&r=PG", "display_name": "etayluz", "link": "https://stackoverflow.com/users/1545308/etayluz"}, "edited": false, "score": 0, "creation_date": 1438240756, "post_id": 31697274, "comment_id": 51372062, "body": "What are the actual numbers you are getting? Performance on a db call is only important if it is not much lower than other slowing factors. If you are going from 0.6ms to 2.4ms, the latter is fully acceptable, unless you are building a high-speed reply for S2S calls. If it is for a user-facing website, that change is marginal. However, that is quite the performance increase. The serializer gem will not help with that. It is purely for speeding up new development. A well-crafted, single SQL call will generally always be faster than Rails"}], "tags": [], "owner": {"reputation": 990, "user_id": 465081, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/e912cfc9d363bf599de81ef674cdc882?s=128&d=identicon&r=PG", "display_name": "Houen", "link": "https://stackoverflow.com/users/465081/houen"}, "is_accepted": false, "score": 1, "last_activity_date": 1438164250, "creation_date": 1438164250, "answer_id": 31697274, "question_id": 31691509, "link": "https://stackoverflow.com/questions/31691509/rails-how-to-retrieve-all-model-objects-along-with-its-foreign-relation-model-w/31697274#31697274", "title": "Rails: How to retrieve all model objects along with its foreign relation model with ActiveRecord?", "body": "<p>Why a single SQL call? Is it enough that we avoid N+1 loading?</p>\n\n<p>The time complexity is almost the same (O denotes a constant):</p>\n\n<p>Single SQL call: 1*O(n) \nTwo SQL calls: 2*O(n) </p>\n\n<p>Here, O is just a different constant. In terms of runtime complexity that is acceptable, since it is still O(n).</p>\n\n<p>With that as precondition:</p>\n\n<p>It sounds like what you want to do is <em>preload</em> the User association.\nYou can do that as such:</p>\n\n<pre><code>class Listing &lt; ActiveRecord::Base\n  belongs_to :user\n\n  def self.to_hash_with_user\n    relation = includes(:user)\n    relation.map{ |record|\n      hash = record.as_json\n      hash['user'] = record.user.as_json\n      hash\n    }     \n  end\nend\n</code></pre>\n\n<p>And now you can use it as such</p>\n\n<pre><code># Get some relation, e.g. Listing.limit(100)\n# Because of lazy loading, this will not do a db call yet\nlistings = Listing.limit(100)\nrender json: listings.to_hash_with_user.to_json\n</code></pre>\n\n<p>For more on preloading records: <a href=\"http://blog.arkency.com/2013/12/rails4-preloading/\" rel=\"nofollow\">http://blog.arkency.com/2013/12/rails4-preloading/</a></p>\n\n<p>And if you want to clean up the JSON you return, and have much better structure and flexibility, I highly recommend this gem: <a href=\"https://github.com/rails-api/active_model_serializers\" rel=\"nofollow\">https://github.com/rails-api/active_model_serializers</a></p>\n"}], "owner": {"reputation": 14023, "user_id": 1545308, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/f029a60367f0dc043566adc3320c9db5?s=128&d=identicon&r=PG", "display_name": "etayluz", "link": "https://stackoverflow.com/users/1545308/etayluz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 112, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1438164250, "creation_date": 1438145932, "last_edit_date": 1438147638, "question_id": 31691509, "link": "https://stackoverflow.com/questions/31691509/rails-how-to-retrieve-all-model-objects-along-with-its-foreign-relation-model-w", "title": "Rails: How to retrieve all model objects along with its foreign relation model with ActiveRecord?", "body": "<p>I have a model called Listing:</p>\n\n<pre><code>class Listing &lt; ActiveRecord::Base\n  belongs_to :user\nend\n</code></pre>\n\n<p>I want to retrieve 100 listings along with each listing's user as a sub-hash within the listing hash, all with a single SQL call using ActiveRecord. This is how I'm doing it now directly with PostgreSQL:</p>\n\n<pre><code>def listings\n  listings = ActiveRecord::Base.connection.execute(\"select row_to_json(t) as listing from (select *, row_to_json(users) as user from listings INNER JOIN users ON listings.user_id = users.id LIMIT 100) t\")\n  render json: {listings:listings,listing_count:Listing.count}\nend\n</code></pre>\n\n<p>No looping over listings to retrieve their user, this is very time consuming.\nThanks!</p>\n\n<p>EDIT</p>\n\n<p>I tried this as suggested but it is NOT returning the user:</p>\n\n<pre><code>  2.2.1 :012 &gt;  Listing.joins(:user).limit(1)\n      Listing Load (0.6ms)  SELECT  \"listings\".* FROM \"listings\" INNER JOIN \"users\" ON \"users\".\"id\" = \"listings\".\"user_id\" LIMIT 1\n     =&gt; #&lt;ActiveRecord::Relation [#&lt;Listing id: 1, user_id: 1, deleted: false, rent: \"$950\", deposit: \"$950\", availability: \"6/18/2015\", min_duration: \"11\", male_count: \"0\", female_count: \"1\", longitude: \"-73.9767700960917\", latitude: \"40.75831025967895\", location: \"Midtown Center\", comments: \"Sequi acidus utor sublime cito autus suasoria. Ips...\", photos: \"1.jpg, 2.jpg, 3.jpg\", cat: false, dog: false, doorman: true, large_room: true, apartment: true, house: false, garden: true, personal_bathroom: false, dog_friendly: true, cat_friendly: false, laundry: false, gym: true, elevator: true, renovated: true, furnished: false, smoking: true, smoke_free: false, air_conditioning: false, utilities_included: true, four_twenty_friendly: false, gay_friendly: false, vegan_friendly: false, vegetarian: true, kosher: false, girls_only: false, guys_only: true, created_at: \"2015-07-17 20:09:21\", updated_at: \"2015-07-17 20:09:21\"&gt;]&gt; \n</code></pre>\n"}, {"tags": ["ruby", "cucumber"], "comments": [{"owner": {"reputation": 1490, "user_id": 753705, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/3dc5b7c682d4dc91050904b494fcb1d6?s=128&d=identicon&r=PG", "display_name": "abhishek77in", "link": "https://stackoverflow.com/users/753705/abhishek77in"}, "edited": false, "score": 0, "creation_date": 1438138028, "post_id": 31690190, "comment_id": 51322254, "body": "Since your question doesn&#39;t have to involve Cucumber can you simplify it and ask ?"}, {"owner": {"reputation": 3, "user_id": 3741186, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2686dce7de4a5c3fe52ccdceb2ee931d?s=128&d=identicon&r=PG&f=1", "display_name": "Dugan23", "link": "https://stackoverflow.com/users/3741186/dugan23"}, "reply_to_user": {"reputation": 1739, "user_id": 2863439, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a7c95bb944bbbe597543ae8a88987995?s=128&d=identicon&r=PG&f=1", "display_name": "limekin", "link": "https://stackoverflow.com/users/2863439/limekin"}, "edited": false, "score": 0, "creation_date": 1438190746, "post_id": 31690190, "comment_id": 51352682, "body": "@limekin Answered the question. I&#39;m a little embarrassed that I overlooked that. That was definitely the issue. How can I give you points for answering the question?"}, {"owner": {"reputation": 1739, "user_id": 2863439, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a7c95bb944bbbe597543ae8a88987995?s=128&d=identicon&r=PG&f=1", "display_name": "limekin", "link": "https://stackoverflow.com/users/2863439/limekin"}, "edited": false, "score": 0, "creation_date": 1438226813, "post_id": 31690190, "comment_id": 51366899, "body": "Yeah I think I will move it to an answer. I just wanted to clarify, because I thought you might have <code>@job_family</code> defined somewhere else."}, {"owner": {"reputation": 3257, "user_id": 4341733, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0b1793f226cb3189da8bc9c6264d72b7?s=128&d=identicon&r=PG", "display_name": "diabolist", "link": "https://stackoverflow.com/users/4341733/diabolist"}, "edited": false, "score": 0, "creation_date": 1438433027, "post_id": 31690190, "comment_id": 51456414, "body": "Note that every time you use an <code>@variable</code> in a cucumber step definition you are creating a global variable that exists for the whole execution time of the scenario. At the very least <code>@job_family</code> should be job_family."}], "answers": [{"tags": [], "owner": {"reputation": 1739, "user_id": 2863439, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a7c95bb944bbbe597543ae8a88987995?s=128&d=identicon&r=PG&f=1", "display_name": "limekin", "link": "https://stackoverflow.com/users/2863439/limekin"}, "is_accepted": true, "score": 0, "last_activity_date": 1438226865, "creation_date": 1438226865, "answer_id": 31714725, "question_id": 31690190, "link": "https://stackoverflow.com/questions/31690190/rubys-find-method-wont-work-on-code-block-that-returns-an-array-gets-a-nilc/31714725#31714725", "title": "Ruby&#39;s `find` method won&#39;t work on code block that returns an array. Gets a NilClass error", "body": "<p>In the second version, you have avoided using @job_family inside the block, but still you are referring to it on the expect, which obviously would be nil unless you have defined it elsewhere</p>\n"}], "owner": {"reputation": 3, "user_id": 3741186, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2686dce7de4a5c3fe52ccdceb2ee931d?s=128&d=identicon&r=PG&f=1", "display_name": "Dugan23", "link": "https://stackoverflow.com/users/3741186/dugan23"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 92, "favorite_count": 0, "accepted_answer_id": 31714725, "answer_count": 1, "score": 0, "last_activity_date": 1438226865, "creation_date": 1438136412, "question_id": 31690190, "link": "https://stackoverflow.com/questions/31690190/rubys-find-method-wont-work-on-code-block-that-returns-an-array-gets-a-nilc", "title": "Ruby&#39;s `find` method won&#39;t work on code block that returns an array. Gets a NilClass error", "body": "<p>My question involves Ruby's <code>find</code> method and why it works in one situation but not in another. NOTE: I'm using this method in a Cucumber step definition written in Ruby.</p>\n\n<p>This code block works the way I want it to:</p>\n\n<pre><code>Then(/^I expect the bolt service children for CrossrefDepositsDaf to include only: IngestUpdateWorkflow$/) do\n  @boltworkflowservice ||= BoltWorkflowService.new\n  Watir::Wait.until(60) do\n    @job_family = @boltworkflowservice.get_workflows_job_family(@job_id).json\n    @job_family.find { |job| job['type'] == \"IngestUpdateWorkflow\" }\n  end\n  expect(@job_family.find{|job| job['type'] == \"IngestUpdateWorkflow\"}.nil?).to eq(false), \"IngestUpdateWorkflow child not found\"\nend\n</code></pre>\n\n<p>But I wanted to rewrite this code block to get rid of the instance variable and reduce the block by one line. I tried the following:</p>\n\n<pre><code>Then(/^I expect the bolt service children for CrossrefDepositsDaf to include only: IngestUpdateWorkflow$/) do\n  @boltworkflowservice ||= BoltWorkflowService.new\n  Watir::Wait.until(60) do\n    puts @boltworkflowservice.get_workflows_job_family(@job_id).json\n    @boltworkflowservice.get_workflows_job_family(@job_id).json.find {|job| job['type'] == \"IngestUpdateWorkflow\"}\n  end\n  expect(@job_family.find{|job| job['type'] == \"IngestUpdateWorkflow\"}.nil?).to eq(false), \"IngestUpdateWorkflow child not found\"\nend\n</code></pre>\n\n<p>I just added the <code>puts</code> to see what the code would return. According to the <code>puts</code>, it returns an array that contains three hash objects but I still get an error. Here is what I get when I try to run the second block:</p>\n\n<pre><code>[{\"id\"=&gt;914295, \"type\"=&gt;\"CrossrefDepositsDaf\", \"subType\"=&gt;\"\", \"parentId\"=&gt;0, \"state\"=&gt;\"SUCCESS\", \"subState\"=&gt;\"SUCCESS\", \"dataPointer\"=&gt;\"s3://sequoia-install/app-resources/test.cirrostratus.org/workflows/CrossrefDepositsDaf/2015/7/29/148c7ebc-3da4-4650-a22e-2e8962d448fc\", \"created\"=&gt;\"2015-07-29 01:58:14\", \"metadata\"=&gt;[]}, {\"id\"=&gt;914296, \"type\"=&gt;\"CrossRefDeposits\", \"subType\"=&gt;\"BoltCatDaf\", \"parentId\"=&gt;914295, \"state\"=&gt;\"SUCCESS\", \"subState\"=&gt;\"SUCCESS\", \"dataPointer\"=&gt;\"s3://sequoia-install/app-resources/test.cirrostratus.org/workflows/CrossRefDeposits/2015/7/29/3a703736-d4a2-456e-baa9-7bf2c0f4a0e2\", \"created\"=&gt;\"2015-07-29 01:58:17\", \"metadata\"=&gt;[]}, {\"id\"=&gt;914297, \"type\"=&gt;\"IngestUpdateWorkflow\", \"subType\"=&gt;\"CrossRefDeposits\", \"parentId\"=&gt;914296, \"state\"=&gt;\"SUCCESS\", \"subState\"=&gt;\"CREATED\", \"dataPointer\"=&gt;\"s3://sequoia-install/app-resources/test.cirrostratus.org/workflows/IngestUpdateWorkflow/2015/7/29/9282591b-f93c-49d6-b656-4afbd14156ef\", \"created\"=&gt;\"2015-07-29 01:58:23\", \"metadata\"=&gt;[]}]\n\nNoMethodError: undefined method `find' for nil:NilClass\n./features/step_definitions/catdaf_integration_crossref_deposits_steps.rb:42:in `/^I expect the bolt service children for CrossrefDepositsDaf to include only: IngestUpdateWorkflow$/'\nC:\\Users\\Dugan23\\workspace\\cloudy_clouds\\cucumber\\features\\content_management\\daf\\integration\\crossref_deposits.feature:11:in `And I expect the bolt service children for CrossrefDepositsDaf to include only: IngestUpdateWorkflow'\n1 scenario (1 failed)\n6 steps (1 failed, 5 passed)\n9m30.221s\n\nProcess finished with exit code 1\n</code></pre>\n\n<p>Can somebody please explain to me why the second block of code doesn't work? The <code>puts</code> shows that I should be feeding the <code>find</code> method an array so why does it say that I\"m trying to run the <code>find</code> method on a <code>nil:NilClass</code>. Thank you in advance for any and all of your help.</p>\n\n<p>NOTE: When I added a <code>puts</code> statement to the first block of code to print out <code>@job_family</code> it returned the same exact array as the second block of code. Does this mean that in the second block of code Ruby is trying to run the <code>find</code> method before evaluating the code before it? I tried to remedy this by adding parentheses as follows, but to no avail:</p>\n\n<pre><code>(@boltworkflowservice.get_workflows_job_family(@job_id).json).find {|job| job['type'] == \"IngestUpdateWorkflow\"}\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby"], "answers": [{"comments": [{"owner": {"reputation": 45, "user_id": 3028922, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/c02abb4c123a0df498c2f308457c7146?s=128&d=identicon&r=PG&f=1", "display_name": "ZSOR", "link": "https://stackoverflow.com/users/3028922/zsor"}, "edited": false, "score": 0, "creation_date": 1438172094, "post_id": 31690208, "comment_id": 51339322, "body": "Thank you so much! I know it had to be something simple since I have been able to do it before."}], "tags": [], "owner": {"reputation": 3614, "user_id": 1569930, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/7bc43a689388dd4697947ffe8f4c9dcd?s=128&d=identicon&r=PG", "display_name": "eirikir", "link": "https://stackoverflow.com/users/1569930/eirikir"}, "is_accepted": true, "score": 5, "last_activity_date": 1438136504, "creation_date": 1438136504, "answer_id": 31690208, "question_id": 31690179, "link": "https://stackoverflow.com/questions/31690179/show-all-the-table-entries-that-belong-to-a-specific-entry-in-rails/31690208#31690208", "title": "Show all the table entries that belong to a specific entry in Rails", "body": "<p>This is because you're using <code>&lt;%=</code> in the line with the each statement, which means the result is outputted to the HTML, instead of <code>&lt;%</code> which does not. The result of an <code>each</code> call is an enumerator object, which is the output you see after the title. The correct code would be:</p>\n\n<pre><code>&lt;% @sub.posts.each do |p|%&gt;\n  &lt;%= p.title %&gt;\n&lt;% end %&gt;\n</code></pre>\n"}], "owner": {"reputation": 45, "user_id": 3028922, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/c02abb4c123a0df498c2f308457c7146?s=128&d=identicon&r=PG&f=1", "display_name": "ZSOR", "link": "https://stackoverflow.com/users/3028922/zsor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 79, "favorite_count": 0, "accepted_answer_id": 31690208, "answer_count": 1, "score": 0, "last_activity_date": 1443032485, "creation_date": 1438136308, "last_edit_date": 1443032485, "question_id": 31690179, "link": "https://stackoverflow.com/questions/31690179/show-all-the-table-entries-that-belong-to-a-specific-entry-in-rails", "title": "Show all the table entries that belong to a specific entry in Rails", "body": "<p>I am working on a rails app and I have to models; Subs and Posts. Each post belongs to a sub, and a sub has many posts. In the Sub show view I want to list out all the titles of posts that it has.</p>\n\n<p>Currently I have</p>\n\n<pre><code>&lt;%= @sub.posts.each do |p|%&gt;\n  &lt;%= p.title %&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>But when I run that it shows:</p>\n\n<blockquote>\n  <p>Test [#Post id:2,  title: \"Test\", created_at: \"2015-07-29 01:49:58\",\n  updated_at: \"2015-07-29 01:49:58\", user_id: 1, sub_id: 1>]</p>\n</blockquote>\n\n<p>I want it to just show Test, instead all the whole table entry</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["ruby", "macos", "rbenv"], "answers": [{"comments": [{"owner": {"reputation": 6347, "user_id": 613703, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/7a530ba90b271e192e6bc9dbcce3e16e?s=128&d=identicon&r=PG", "display_name": "djt", "link": "https://stackoverflow.com/users/613703/djt"}, "edited": false, "score": 0, "creation_date": 1438135035, "post_id": 31689993, "comment_id": 51321561, "body": "I did try that already however the symlinked version is still executed."}, {"owner": {"reputation": 21553, "user_id": 434004, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/50a236e50d72e5e32f294d62dc57b5ba?s=128&d=identicon&r=PG", "display_name": "Graham Perks", "link": "https://stackoverflow.com/users/434004/graham-perks"}, "reply_to_user": {"reputation": 6347, "user_id": 613703, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/7a530ba90b271e192e6bc9dbcce3e16e?s=128&d=identicon&r=PG", "display_name": "djt", "link": "https://stackoverflow.com/users/613703/djt"}, "edited": false, "score": 0, "creation_date": 1438135060, "post_id": 31689993, "comment_id": 51321566, "body": "Start a new Terminal session, too. (I added a couple more items to configure your system.)"}, {"owner": {"reputation": 6347, "user_id": 613703, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/7a530ba90b271e192e6bc9dbcce3e16e?s=128&d=identicon&r=PG", "display_name": "djt", "link": "https://stackoverflow.com/users/613703/djt"}, "edited": false, "score": 1, "creation_date": 1438136430, "post_id": 31689993, "comment_id": 51321861, "body": "Your edit helped me figure it out.  In the Ruby instructions it said to add  <code>if which rbenv &gt; &#47;dev&#47;null; then eval &quot;$(rbenv init -)&quot;; fi</code> to my <code>.bash_profile</code>.  However, i&#39;m using ZSH!  So after adding it to my <code>.zshrc</code> everything is now working"}], "tags": [], "owner": {"reputation": 21553, "user_id": 434004, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/50a236e50d72e5e32f294d62dc57b5ba?s=128&d=identicon&r=PG", "display_name": "Graham Perks", "link": "https://stackoverflow.com/users/434004/graham-perks"}, "is_accepted": true, "score": 0, "last_activity_date": 1438135140, "last_edit_date": 1438135140, "creation_date": 1438134916, "answer_id": 31689993, "question_id": 31689985, "link": "https://stackoverflow.com/questions/31689985/osx-installing-ruby-with-rbenv/31689993#31689993", "title": "OSX Installing Ruby with rbenv", "body": "<p>Try <code>rbenv rehash</code>, which you should do after installing anything Ruby (or Gem) related.</p>\n\n<p>Have you added this to .bashrc (or similar for your set up)?</p>\n\n<pre><code>export RBENV_ROOT=/usr/local/var/rbenv\nif which rbenv &gt; /dev/null; then eval \"$(rbenv init -)\"; fi\n</code></pre>\n\n<p>and</p>\n\n<pre><code>PATH=/usr/local/bin:/usr/local/sbin:$PATH\n</code></pre>\n"}], "owner": {"reputation": 6347, "user_id": 613703, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/7a530ba90b271e192e6bc9dbcce3e16e?s=128&d=identicon&r=PG", "display_name": "djt", "link": "https://stackoverflow.com/users/613703/djt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 83, "favorite_count": 0, "accepted_answer_id": 31689993, "answer_count": 1, "score": 0, "last_activity_date": 1438135140, "creation_date": 1438134848, "question_id": 31689985, "link": "https://stackoverflow.com/questions/31689985/osx-installing-ruby-with-rbenv", "title": "OSX Installing Ruby with rbenv", "body": "<p>I have installed Ruby on OSX using <code>rbenv</code> following these instructions: <a href=\"https://gorails.com/setup/osx/10.9-mavericks\" rel=\"nofollow\">https://gorails.com/setup/osx/10.9-mavericks</a></p>\n\n<p>I installed 2.2.2 however, even after adding it as the global value in <code>rbenv</code> using <code>rbenv global 2.2.2</code>, the <code>ruby -v</code> command still returns <code>ruby 1.8.7</code>.</p>\n\n<p>Now, I know that in my <code>/usr/bin</code>, <code>ruby</code> is still symlinked to the default OSX version (1.8.7).  And I could change the symlink.  But I'm wondering what the best practice is here, and how <code>rbenv</code> is supposed to work in terms of multiple ruby versions?  </p>\n"}, {"tags": ["ruby", "shell", "pipe", "stdin"], "comments": [{"owner": {"reputation": 167912, "user_id": 240443, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/495d675e3bc42ed1dee469e2ce701f1b?s=128&d=identicon&r=PG", "display_name": "Amadan", "link": "https://stackoverflow.com/users/240443/amadan"}, "edited": false, "score": 0, "creation_date": 1438134388, "post_id": 31689694, "comment_id": 51321418, "body": "Yup, end of file makes it stop blocking and return <code>nil</code> every time. Same if you pipe <code>echo oneline</code> into it. Same if you redirect from a too-short file. When the end of the file is reached, <code>puts</code> returns immediately with <code>nil</code> to signify the fact. The default <code>STDIN</code> (without redirection) does not reach an end."}], "answers": [{"tags": [], "owner": {"reputation": 729, "user_id": 3069115, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9220d416e46ec9b73cab61afbb26798b?s=128&d=identicon&r=PG&f=1", "display_name": "Tim Tom", "link": "https://stackoverflow.com/users/3069115/tim-tom"}, "is_accepted": true, "score": 1, "last_activity_date": 1438136835, "last_edit_date": 1438136835, "creation_date": 1438135728, "answer_id": 31690104, "question_id": 31689694, "link": "https://stackoverflow.com/questions/31689694/ruby-stdin-blocking-vs-not-blocking/31690104#31690104", "title": "Ruby STDIN, blocking vs not blocking", "body": "<p>So the short answer is yes, you are getting an EOF from the pipe. Because the way echo works is that it's going to open the pipe for writing, write to it, then close (i.e. send EOF). Then a new call to echo will open it back up, read to it, and then close.</p>\n\n<p>If you had instead used a program that printed lines of a file after a 3 second sleep, you would see that your application would perform blocking waits until that one exits (at which point the never-ending EOFs would return).</p>\n\n<pre><code># slow_write.rb\nARGF.each do |line|\n  puts line\n  STDOUT.flush\n  sleep 3\nend\n</code></pre>\n\n<p>I should note that this behavior is not specific to Ruby. The C stdlio library has the exact same behavior and since most languages use C primitives as their basis they have the same behavior as well.</p>\n"}], "owner": {"reputation": 9917, "user_id": 1586221, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/96ab4c67eb62b315a8e7584f7dfd547a?s=128&d=identicon&r=PG", "display_name": "tompave", "link": "https://stackoverflow.com/users/1586221/tompave"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 430, "favorite_count": 0, "accepted_answer_id": 31690104, "answer_count": 1, "score": 0, "last_activity_date": 1438136835, "creation_date": 1438132560, "question_id": 31689694, "link": "https://stackoverflow.com/questions/31689694/ruby-stdin-blocking-vs-not-blocking", "title": "Ruby STDIN, blocking vs not blocking", "body": "<p>I'm trying to find some documentation on how <code>STDIN</code> is handled in Ruby.  </p>\n\n<p>I've experimented with this simple script:</p>\n\n<pre><code># test.rb\n\nloop do\n  puts \"stdin: #{$stdin.gets}\"\n  sleep 2\nend\n</code></pre>\n\n<p>That I've run from <strong>bash</strong> (on OS X) with:</p>\n\n<pre><code>$ ruby test.rb\n</code></pre>\n\n<p>As I expected, the call to <code>$stdin.gets</code> is blocking, and the loop waits for the next input. The 2 second sleep time even allows me to enter more lines in one go, and the loop correctly prints them in order, then stops again when STDIN is cleared:</p>\n\n<pre><code>$ ruby test.rb\na\nstdin: a\nb\nstdin: b\nc\nd\ne\nstdin: c\nstdin: d\nstdin: e\n</code></pre>\n\n<p>So far, all good. I was expecting this.  </p>\n\n<p>Then, I made a test with a pipe:</p>\n\n<pre><code>$ mkfifo my_pipe\n$ ruby test.rb &lt; my_pipe\n</code></pre>\n\n<p>And, in another shell:</p>\n\n<pre><code>$ echo \"Hello\" &gt; my_pipe\n</code></pre>\n\n<p>This time, it behaved a bit differently.<br>\nAt first it did wait, blocking the loop. But then, after the first input was passed through the pipe, it keept looping and printing empty strings:</p>\n\n<pre><code>$ ruby test.rb\nstdin: Hello\nstdin:\nstdin:\nstdin: Other input\nstdin:\n</code></pre>\n\n<p>So my question is: why the difference? Does it treat the pipe like an empty file? Where is this documented? The <a href=\"http://ruby-doc.org/core-2.2.2/IO.html#method-i-gets\" rel=\"nofollow\">docs</a> don't say anything about the blocking behaviour, but they do say that:</p>\n\n<blockquote>\n  <p>Returns nil if called at end of file.</p>\n</blockquote>\n\n<p>It's a start.</p>\n"}, {"tags": ["ruby", "initialization", "accumulate"], "answers": [{"tags": [], "owner": {"reputation": 2560, "user_id": 5112122, "user_type": "registered", "profile_image": "https://graph.facebook.com/10206053108358704/picture?type=large", "display_name": "Horacio", "link": "https://stackoverflow.com/users/5112122/horacio"}, "is_accepted": false, "score": 0, "last_activity_date": 1438133737, "last_edit_date": 1438133737, "creation_date": 1438132990, "answer_id": 31689760, "question_id": 31689685, "link": "https://stackoverflow.com/questions/31689685/in-ruby-should-i-use-control-flow-to-initialize-an-accumulator-inside-a-loop/31689760#31689760", "title": "In Ruby, should I use control flow to initialize an accumulator inside a loop?", "body": "<p>I like the second one. but if you are looking for a acumulator for .times method you could use </p>\n\n<pre><code>100.times do |accumulator|\n  p accumulator\nend\n</code></pre>\n\n<p>the only difference with yours examples is that you have an object attribute as accumulattor, so if you need that attibute for latter usage, you could do something like this</p>\n\n<pre><code>100.times do |c|\n  @accumulator = c\nend\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1515, "user_id": 633567, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b45355cfdc64d509b8cbfe2d5789ee94?s=128&d=identicon&r=PG", "display_name": "adzdavies", "link": "https://stackoverflow.com/users/633567/adzdavies"}, "is_accepted": true, "score": 2, "last_activity_date": 1438133128, "last_edit_date": 1438133128, "creation_date": 1438132997, "answer_id": 31689763, "question_id": 31689685, "link": "https://stackoverflow.com/questions/31689685/in-ruby-should-i-use-control-flow-to-initialize-an-accumulator-inside-a-loop/31689763#31689763", "title": "In Ruby, should I use control flow to initialize an accumulator inside a loop?", "body": "<p>To directly answer your question, I'd normally initialize outside the loop.</p>\n\n<p>However, I would say best practice is to use higher order functions in block form that negates the need for an explicit loop.</p>\n\n<pre><code>@accumulator = 100.times.reduce do |memo, element|\n  memo + element\nend\n</code></pre>\n\n<p>Or, in this case you could even use a symbol to specify the method as so:</p>\n\n<pre><code>@accumulator = 100.times.reduce(:+)\n</code></pre>\n\n<p>This applies the \"+\" method to each pair in turn.</p>\n\n<p><a href=\"http://ruby-doc.org/core-2.1.0/Enumerable.html#method-i-reduce\" rel=\"nofollow\">http://ruby-doc.org/core-2.1.0/Enumerable.html#method-i-reduce</a></p>\n"}], "owner": {"reputation": 13, "user_id": 5167260, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/897d1049ed0bbc1c55f1ad5b12be7933?s=128&d=identicon&r=PG&f=1", "display_name": "Dorsal6", "link": "https://stackoverflow.com/users/5167260/dorsal6"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 114, "favorite_count": 0, "accepted_answer_id": 31689763, "answer_count": 2, "score": 0, "last_activity_date": 1438133737, "creation_date": 1438132502, "question_id": 31689685, "link": "https://stackoverflow.com/questions/31689685/in-ruby-should-i-use-control-flow-to-initialize-an-accumulator-inside-a-loop", "title": "In Ruby, should I use control flow to initialize an accumulator inside a loop?", "body": "<p>Is it good practice to initialize an accumulator like this?</p>\n\n<pre><code>100.times do\n  @accumulator = (@accumulator || 0) + 1\nend\n</code></pre>\n\n<p>Or should I just initialize it outside the loop and do:</p>\n\n<pre><code>@accumulator = 0   \n100.times do\n  @accumulator += 1\nend\n</code></pre>\n"}, {"tags": ["javascript", "jquery", "ruby-on-rails", "ruby", "ajax"], "comments": [{"owner": {"reputation": 10605, "user_id": 2476755, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pXGb5.png?s=128&g=1", "display_name": "royhowie", "link": "https://stackoverflow.com/users/2476755/royhowie"}, "edited": false, "score": 0, "creation_date": 1438311350, "post_id": 31689639, "comment_id": 51409528, "body": "In the future, you should follow the <a href=\"https://github.com/airbnb/javascript\" rel=\"nofollow noreferrer\">airbnb javascript style guide</a>."}, {"owner": {"reputation": 193, "user_id": 1074849, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cbc7ddbcf11bf15fc111ba10b5d8cdc9?s=128&d=identicon&r=PG", "display_name": "Vasimkhan", "link": "https://stackoverflow.com/users/1074849/vasimkhan"}, "edited": false, "score": 0, "creation_date": 1438320816, "post_id": 31689639, "comment_id": 51411903, "body": "Do you want to check if &quot;.habit-check&quot; checkbox is checked or not when user is clicking &quot;link to&quot; button ?"}], "answers": [{"comments": [{"owner": {"reputation": 2578, "user_id": 4383667, "user_type": "registered", "accept_rate": 86, "profile_image": "https://lh3.googleusercontent.com/-0D7SldkahZc/AAAAAAAAAAI/AAAAAAAAAFk/V8nUZfLVtyk/photo.jpg?sz=128", "display_name": "AnthonyGalli.com", "link": "https://stackoverflow.com/users/4383667/anthonygalli-com"}, "edited": false, "score": 0, "creation_date": 1438359386, "post_id": 31740624, "comment_id": 51435086, "body": "Thank you Amit for going above and beyond with your awesome explanation! I updated my question with your code and with mine so that the link AND the checkbox work. It works perfectly now in my browser. I&#39;ll give you the bounty, but I was just wondering if you saw my edit as the most effective way to do this. Thanks again!"}], "tags": [], "owner": {"reputation": 3129, "user_id": 455826, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/aPD2c.jpg?s=128&g=1", "display_name": "AmitA", "link": "https://stackoverflow.com/users/455826/amita"}, "is_accepted": true, "score": 2, "last_activity_date": 1438440140, "last_edit_date": 1438440140, "creation_date": 1438328142, "answer_id": 31740624, "question_id": 31689639, "link": "https://stackoverflow.com/questions/31689639/how-to-make-the-selector-checked-work-with-link-to-too/31740624#31740624", "title": "How to make the selector &quot;:checked&quot; work with &quot;link_to&quot; too?", "body": "<p>It seems like <code>.habit-check</code> is no longer a checkbox, so your old code that handles the change event won't work.</p>\n\n<p>So I assume you want to make this work with the link <em>instead</em> of a checkbox.\nI also assume you're using Rails jquery-ujs (unobtrusive javascript with jQuery), which is the default nowadays. </p>\n\n<p>You don't need to manually trigger an Ajax request with jQuery when you specify <code>remote: true</code> on the link or on a form. The ujs framework does it for you. So doing things like <code>data(\"submit-url\")</code> to communicate between your markup and javascript code are unnecessary if the path is correctly defined in the <code>link_to</code> (which is your case). This is, again, the ujs framework's responsibility. </p>\n\n<p>So, when the user clicks on a link or submits a form that has <code>remote: true</code>, the ujs framework will communicate with the server, and you can simply handle in javascript one of the Ajax events defined here:\n<a href=\"https://github.com/rails/jquery-ujs/wiki/ajax\" rel=\"nofollow\">https://github.com/rails/jquery-ujs/wiki/ajax</a></p>\n\n<p>So in your case, doing this should work:</p>\n\n<pre><code>$(document).ready(function() {\n  $('.habit-check').on('ajax:success', function() { location.reload() })\n})\n</code></pre>\n\n<p>Or this (if there is a chance your <code>.habit-check</code> link will be rendered by Javascript, e.g. as a response to an Ajax call):</p>\n\n<pre><code>$(document).ready(function() {\n  $('body').on('ajax:success', '.habit-check', function() { location.reload() })\n})\n</code></pre>\n\n<p>Note: If you want to use the <code>ajax:success</code> event make sure your controller returns status 200. For whatever reason if the controller does <code>render text: 'hi'</code>, this won't work, so render a JSON back or simply <code>render nothing: true</code>.</p>\n\n<p><strong>UPDATE - WITH CHECKBOX</strong></p>\n\n<p>It seems like you'd like to call different controller actions based on the checkbox state. If this is the case, you can do it in javascript like you did, or follow my suggestion under \"Different Controller Actions\" below. If you're fine sending the checkbox state to one controller action and let the controller handle the \"if checked then..\", the code will be simpler:</p>\n\n<p>In ERB:</p>\n\n<pre><code>&lt;%= form_for @habit, remote: true, class: 'habit-form' do |f| %&gt;\n  &lt;%= f.check_box :check, class: 'habit-check' %&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>In Javascript:</p>\n\n<pre><code>$('.habit-check').on('change', function() { $('.habit-form').submit() })\n$('.habit-form').on('ajax:success', function() { location.reload() })\n</code></pre>\n\n<p>In the controller:</p>\n\n<pre><code>def update\n  habit = Habit.find(params[:id])\n  if params[:habit][:check] == '1'\n    # Do one thing\n  else\n    # Do another thing\n  end\n  render nothing: true\nend\n</code></pre>\n\n<p>Note that the code above makes the following assumptions:</p>\n\n<ul>\n<li><p>You have a class called <code>Habit</code>, which has an attribute called <code>check</code>.  If you don't want to have this check-box attribute as a db column, simply add it with <code>attr_accessor :check</code> in <code>Habit</code> class definition so that the <code>f.check_box :check</code> line works.</p></li>\n<li><p>The ERB template receives a <code>@habit</code> object of the class <code>Habit</code> that already exists in the db. In other words <code>@habit.new_record?</code> returns <code>false</code>. This would make the form communicate with the <code>update</code> action in the controller.</p></li>\n</ul>\n\n<p><strong>DIFFERENT CONTROLLER ACTIONS</strong></p>\n\n<p>If you want to call different controller actions based on the check box state while avoiding the <code>$.ajax</code> calls (which I personally think is cleaner), you can render two different forms and have the javascript select which one to submit.</p>\n\n<p>In ERB:</p>\n\n<pre><code>&lt;%= form_for @habit, url: destroy_habit_path, method: :delete, remote: true, class: 'destroy-form redirect-after-success' %&gt;\n&lt;%= form_for Habit.new, url: habits_path, method: :post remote: true, class: 'create-form redirect-after-success' %&gt;\n</code></pre>\n\n<p>In javascript:</p>\n\n<pre><code>$('.habit-check').on('change', function() { \n  var isChecked = $(this).is(':checked');\n  var formClass = isChecked ? '.create-form' : '.destroy-form';\n  $(formClass).submit() \n});\n$('.redirect-after-success').on('ajax:success', function() { location.reload() });\n</code></pre>\n\n<p>And note that you can also add the <code>redirect-after-success</code> class to your <code>.remove-check</code> link, so the javascript code above will support with no changes your link from our initial discussion.</p>\n"}], "owner": {"reputation": 2578, "user_id": 4383667, "user_type": "registered", "accept_rate": 86, "profile_image": "https://lh3.googleusercontent.com/-0D7SldkahZc/AAAAAAAAAAI/AAAAAAAAAFk/V8nUZfLVtyk/photo.jpg?sz=128", "display_name": "AnthonyGalli.com", "link": "https://stackoverflow.com/users/4383667/anthonygalli-com"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 157, "favorite_count": 1, "accepted_answer_id": 31740624, "answer_count": 1, "score": 1, "last_activity_date": 1438440140, "creation_date": 1438132094, "last_edit_date": 1438359218, "question_id": 31689639, "link": "https://stackoverflow.com/questions/31689639/how-to-make-the-selector-checked-work-with-link-to-too", "title": "How to make the selector &quot;:checked&quot; work with &quot;link_to&quot; too?", "body": "<p>When a user clicks this how can we automatically reload the page?</p>\n\n<pre><code>&lt;%= link_to '&lt;span class=\"glyphicon glyphicon-remove\"&gt;&lt;/span&gt;'.html_safe, habit_level_days_missed_index_path({ habit_id: habit, level_id: habit.current_habit_level.id }), remote: true, method: 'post', data: { confirm: 'You missed a committed day?' }, class: 'habit-check', id: 'remove_check' %&gt;\n</code></pre>\n\n<p><code>habit-check</code> triggers this:</p>\n\n<pre class=\"lang-js prettyprint-override\"><code>$(document).ready(function () {\n  $(\".habit-check\").change(function () {\n    var submitUrl = $(this).parents(\"p\").data(\"submit-url\");\n    var deleteUrl = $(this).parents(\"p\").data(\"delete-url\");\n\n    if ($(this).is(\":checked\")) { // We'd need to fix this line?\n       $.ajax({ url: submitUrl, method: \"POST\" }).done(location.reload)\n    } else {\n       $.ajax({ url: deleteUrl, method: \"DELETE\" }).done(location.reload)\n    }\n  })\n})\n</code></pre>\n\n<p>But this was designed to work when a checkbox was clicked. How can we get this to also work when a <code>link_to</code> button is clicked?</p>\n\n<p>I envisioned something like this <code>if($(this).is(\":checked &amp;&amp; :clicked\"))</code>, but I have little to no understanding of javascript, but I hope you get the idea :]</p>\n\n<h2>UPDATE</h2>\n\n<p>I tried all the selectors from this page <a href=\"https://api.jquery.com/category/selectors/\" rel=\"nofollow\">https://api.jquery.com/category/selectors/</a> and they didn't work so I either did it wrong or the solution is more than just fixing a line.</p>\n\n<h2>UPDATE AMIT</h2>\n\n<pre><code>$(document).ready(function() {\n  $('.remove-check').on('ajax:success', function() { location.reload() })\n  $(\".habit-check\").change(function() {\n    var submitUrl = $(this).parents(\"p\").data(\"submit-url\");\n    var deleteUrl = $(this).parents(\"p\").data(\"delete-url\");\n\n    if($(this).is(\":checked\"))\n    {\n       $.ajax(\n       {\n         url: submitUrl,\n         method: \"POST\"\n       })\n       .done(function () {\n         location.reload();\n       });\n    }\n    else\n    {\n       $.ajax(\n       {\n         url: deleteUrl,\n         method: \"DELETE\"\n       })\n       .done(function () {\n         location.reload();\n       });\n    }\n  });\n})\n</code></pre>\n"}, {"tags": ["ruby", "sinatra", "rack", "view-helpers"], "answers": [{"tags": [], "owner": {"reputation": 4981, "user_id": 705725, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/3oNDr.jpg?s=128&g=1", "display_name": "dsp_099", "link": "https://stackoverflow.com/users/705725/dsp-099"}, "is_accepted": false, "score": 1, "last_activity_date": 1438133826, "creation_date": 1438133826, "answer_id": 31689852, "question_id": 31689611, "link": "https://stackoverflow.com/questions/31689611/helpers-not-working-with-a-modular-sinatra-app/31689852#31689852", "title": "Helpers not working with a modular Sinatra app", "body": "<p>Well, looks like the answer is pretty simple.</p>\n\n<p>When including a module via <code>helpers()</code>, its methods become available simply as <code>method_name()</code> and not <code>ModuleName.method_name()</code>.</p>\n\n<p>So in this case, both in <code>Root</code> and the slim template, all I need to do is call <code>test()</code></p>\n"}, {"comments": [{"owner": {"reputation": 4998, "user_id": 1404425, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/wsCfz.jpg?s=128&g=1", "display_name": "Arman H", "link": "https://stackoverflow.com/users/1404425/arman-h"}, "edited": false, "score": 0, "creation_date": 1489372949, "post_id": 31689882, "comment_id": 72627780, "body": "Is there a way to achieve the opposite of this (for namespacing concerns), that is, to define a module such that its helper methods can be called with the module name and still have access to the request context and Sinatra&#39;s other helpers (e.g. <code>session</code>)? In OP&#39;s example, to be able to call <code>Utils.test</code> from a route, instead of plain <code>test()</code>?"}, {"owner": {"reputation": 74087, "user_id": 214790, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f878c8230342730990acd21f889301d4?s=128&d=identicon&r=PG", "display_name": "matt", "link": "https://stackoverflow.com/users/214790/matt"}, "reply_to_user": {"reputation": 4998, "user_id": 1404425, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/wsCfz.jpg?s=128&g=1", "display_name": "Arman H", "link": "https://stackoverflow.com/users/1404425/arman-h"}, "edited": false, "score": 0, "creation_date": 1489415365, "post_id": 31689882, "comment_id": 72647367, "body": "@ArmanH I saw your question and bounty about this. I don\u2019t think there\u2019s a clean way to do what you want. By using the name with the module the method is being run in a different context, but you need it to be in the same context to get the other helpers. (Of course, this being Ruby there may be some hacky way to get it to work)."}], "tags": [], "owner": {"reputation": 74087, "user_id": 214790, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f878c8230342730990acd21f889301d4?s=128&d=identicon&r=PG", "display_name": "matt", "link": "https://stackoverflow.com/users/214790/matt"}, "is_accepted": true, "score": 2, "last_activity_date": 1438134062, "creation_date": 1438134062, "answer_id": 31689882, "question_id": 31689611, "link": "https://stackoverflow.com/questions/31689611/helpers-not-working-with-a-modular-sinatra-app/31689882#31689882", "title": "Helpers not working with a modular Sinatra app", "body": "<p>Using a helpers module makes all the methods in it directly available to the code in the routes, without needing to prefix it with the module name.</p>\n\n<p>You can just do this:</p>\n\n<pre><code>get '/' do\n  puts test\n\n  # view() Defined directly in `Application`, runs slim\n  view :index\nend\n</code></pre>\n\n<p>The reason you are getting <code>private method `test' called for Utils:Module</code> rather than <code>undefined method `test' for Utils:Module</code> is because there already is a <a href=\"http://ruby-doc.org/core-2.2.2/Kernel.html#method-i-test\" rel=\"nofollow\"><code>test</code> method</a> in Kernel, which is therefore available as a private method on all classes.</p>\n"}], "owner": {"reputation": 4981, "user_id": 705725, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/3oNDr.jpg?s=128&g=1", "display_name": "dsp_099", "link": "https://stackoverflow.com/users/705725/dsp-099"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 723, "favorite_count": 0, "accepted_answer_id": 31689882, "answer_count": 2, "score": 0, "last_activity_date": 1438134062, "creation_date": 1438131919, "question_id": 31689611, "link": "https://stackoverflow.com/questions/31689611/helpers-not-working-with-a-modular-sinatra-app", "title": "Helpers not working with a modular Sinatra app", "body": "<p>I'm having some trouble getting <a href=\"http://www.sinatrarb.com/intro.html#Helpers\" rel=\"nofollow\">helpers</a> to work with a modular Sinatra app. I have a master controller and a bunch of others inheriting from it. So <code>/</code> maps to <code>Root</code>, <code>/auth</code> maps to <code>Auth</code>, etc.</p>\n\n<p>Main module:</p>\n\n<pre><code>require 'sinatra/base'\n# Lots of other requires\n\n# Helper\nmodule Utils\n  def test\n    puts \"Test helper\"\n    return 'test'\n  end\nend\n\n# Main app\nclass Application &lt; Sinatra::Base    \n  helpers Utils\n\n  # Lots of config\nend\n</code></pre>\n\n<p>\"Controllers\" inherit <code>Application</code>, like:</p>\n\n<pre><code>class Root &lt; Application\n\n  get '/' do\n    puts Utils # Exists\n    puts Utils.test # Breaks\n\n    # view() Defined directly in `Application`, runs slim\n    view :index\n  end\n\nend\n</code></pre>\n\n<p>This results in:</p>\n\n<blockquote>\n  <p>NoMethodError at /</p>\n  \n  <p>private method `test' called for Utils:Module</p>\n</blockquote>\n\n<p>A bit stumped. Any help?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-4"], "answers": [{"comments": [{"owner": {"reputation": 167912, "user_id": 240443, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/495d675e3bc42ed1dee469e2ce701f1b?s=128&d=identicon&r=PG", "display_name": "Amadan", "link": "https://stackoverflow.com/users/240443/amadan"}, "edited": false, "score": 0, "creation_date": 1438131849, "post_id": 31689584, "comment_id": 51320834, "body": "This is nice. Specific, but nice."}], "tags": [], "owner": {"reputation": 8117, "user_id": 1207687, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/cOUI4.jpg?s=128&g=1", "display_name": "Wes Foster", "link": "https://stackoverflow.com/users/1207687/wes-foster"}, "is_accepted": true, "score": 3, "last_activity_date": 1438131891, "last_edit_date": 1438131891, "creation_date": 1438131719, "answer_id": 31689584, "question_id": 31689564, "link": "https://stackoverflow.com/questions/31689564/ruby-on-rails-looping-through-records-but-dont-show-record-from-current-id/31689584#31689584", "title": "Ruby on Rails: looping through records, but don&#39;t show record from current id", "body": "<p>Using geocoder, you can simply do this:</p>\n\n<pre><code># controller\n@project = Project.friendly.find(params[:id])\n@nearby = @project.nearbys(50)\n\n# view\n&lt;% @nearby.each do |n| %&gt;\n  &lt;span&gt;&lt;%= n.title_name %&gt;&lt;/span&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>Notice the <code>nearbys</code> method. This finds <strong>other</strong> of the same object within the given distance (50 miles). In this case, it will find other <code>Project</code>s.</p>\n\n<p>This method is explained in more detail on the Geocoder docs page: <a href=\"https://github.com/alexreisner/geocoder\" rel=\"nofollow\">https://github.com/alexreisner/geocoder</a></p>\n"}, {"tags": [], "owner": {"reputation": 167912, "user_id": 240443, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/495d675e3bc42ed1dee469e2ce701f1b?s=128&d=identicon&r=PG", "display_name": "Amadan", "link": "https://stackoverflow.com/users/240443/amadan"}, "is_accepted": false, "score": 1, "last_activity_date": 1438131721, "creation_date": 1438131721, "answer_id": 31689585, "question_id": 31689564, "link": "https://stackoverflow.com/questions/31689564/ruby-on-rails-looping-through-records-but-dont-show-record-from-current-id/31689585#31689585", "title": "Ruby on Rails: looping through records, but don&#39;t show record from current id", "body": "<p>You can skip it, as a general solution.</p>\n\n<pre><code>&lt;% @nearby.each do |n| %&gt;\n  &lt;% next if n == @project %&gt;\n  &lt;span&gt;&lt;%= n.title_name %&gt;&lt;/span&gt;\n&lt;% end %&gt;\n</code></pre>\n"}], "owner": {"reputation": 7430, "user_id": 659751, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/X4DC1.jpg?s=128&g=1", "display_name": "hellomello", "link": "https://stackoverflow.com/users/659751/hellomello"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 70, "favorite_count": 1, "accepted_answer_id": 31689584, "answer_count": 2, "score": 2, "last_activity_date": 1438131891, "creation_date": 1438131549, "question_id": 31689564, "link": "https://stackoverflow.com/questions/31689564/ruby-on-rails-looping-through-records-but-dont-show-record-from-current-id", "title": "Ruby on Rails: looping through records, but don&#39;t show record from current id", "body": "<p>I'm able to search through nearby records based on latitude and longitude from geocoder gem, but how do I not show the record that I'm looking at now?</p>\n\n<p>If I'm in a project show with <code>localhost:3000/project/san-diego</code> (a location San Diego, US), and I do nearby search through </p>\n\n<pre><code># controller\n@project = Project.friendly.find(params[:id])\n@nearby = Project.near([@project.latitude, @project.longitude], 50, :order =&gt; 'distance')\n\n# view\n&lt;% @nearby.each do |n| %&gt;\n  &lt;span&gt;&lt;%= n.title_name %&gt;&lt;/span&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>How do I not display the current record, but all other records that are nearby?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "methods", "controller"], "comments": [{"owner": {"reputation": 7832, "user_id": 2497, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/25d33a294d8b03b0eec187cb1dc4d8d7?s=128&d=identicon&r=PG", "display_name": "Srdjan Pejic", "link": "https://stackoverflow.com/users/2497/srdjan-pejic"}, "edited": false, "score": 0, "creation_date": 1438131381, "post_id": 31689465, "comment_id": 51320724, "body": "Using <i>self</i> in a method definition makes it a class method. As such, Rally.add_manager will work, but I doubt this is what you intend."}, {"owner": {"reputation": 153, "user_id": 1432248, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e079ec5b28cfbdbb319b69230af28b4e?s=128&d=identicon&r=PG", "display_name": "Asitha De Silva", "link": "https://stackoverflow.com/users/1432248/asitha-de-silva"}, "reply_to_user": {"reputation": 7832, "user_id": 2497, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/25d33a294d8b03b0eec187cb1dc4d8d7?s=128&d=identicon&r=PG", "display_name": "Srdjan Pejic", "link": "https://stackoverflow.com/users/2497/srdjan-pejic"}, "edited": false, "score": 0, "creation_date": 1438131511, "post_id": 31689465, "comment_id": 51320749, "body": "@SrdjanPejic I see. It&#39;s weird that it still works in rails console then but not in the controller. So would the best solution be to move it as a private method in the controller?"}, {"owner": {"reputation": 7832, "user_id": 2497, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/25d33a294d8b03b0eec187cb1dc4d8d7?s=128&d=identicon&r=PG", "display_name": "Srdjan Pejic", "link": "https://stackoverflow.com/users/2497/srdjan-pejic"}, "edited": false, "score": 2, "creation_date": 1438131684, "post_id": 31689465, "comment_id": 51320795, "body": "No, just remove <i>self</i> from the method definition. Also, are you sure that <code>rally.users &lt;&lt; user</code> will fail if <code>user</code> is nil? If it doesn&#39;t, you&#39;re making a needless check."}, {"owner": {"reputation": 153, "user_id": 1432248, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e079ec5b28cfbdbb319b69230af28b4e?s=128&d=identicon&r=PG", "display_name": "Asitha De Silva", "link": "https://stackoverflow.com/users/1432248/asitha-de-silva"}, "reply_to_user": {"reputation": 7832, "user_id": 2497, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/25d33a294d8b03b0eec187cb1dc4d8d7?s=128&d=identicon&r=PG", "display_name": "Srdjan Pejic", "link": "https://stackoverflow.com/users/2497/srdjan-pejic"}, "edited": false, "score": 0, "creation_date": 1438132299, "post_id": 31689465, "comment_id": 51320938, "body": "@SrdjanPejic That worked! Thanks for the help. As for the check, I haven&#39;t added any yet. Just wanted to make sure I was able to process form properly before adding other bits."}], "answers": [{"tags": [], "owner": {"reputation": 84, "user_id": 4830631, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fIUrT.jpg?s=128&g=1", "display_name": "eezee", "link": "https://stackoverflow.com/users/4830631/eezee"}, "is_accepted": true, "score": 0, "last_activity_date": 1481911941, "creation_date": 1481911941, "answer_id": 41190127, "question_id": 31689465, "link": "https://stackoverflow.com/questions/31689465/calling-model-custom-method-in-controller/41190127#41190127", "title": "Calling model custom method in controller", "body": "<p>Change the class method:</p>\n\n<pre><code>def self.add_manager(params)\n</code></pre>\n\n<p>To an instance method:</p>\n\n<pre><code>def add_manager(params)\n</code></pre>\n\n<p>as @rally is an instance of your Rally class</p>\n\n<p><em>(answered in comments above - removing from unanswered list)</em></p>\n"}], "owner": {"reputation": 153, "user_id": 1432248, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e079ec5b28cfbdbb319b69230af28b4e?s=128&d=identicon&r=PG", "display_name": "Asitha De Silva", "link": "https://stackoverflow.com/users/1432248/asitha-de-silva"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 624, "favorite_count": 0, "accepted_answer_id": 41190127, "answer_count": 1, "score": 2, "last_activity_date": 1481911941, "creation_date": 1438130750, "question_id": 31689465, "link": "https://stackoverflow.com/questions/31689465/calling-model-custom-method-in-controller", "title": "Calling model custom method in controller", "body": "<p>I'm trying to call a custom method I created in my model, in my controller but when I submit my form that points to the controller action, I get the following error: </p>\n\n<blockquote>\n  <p>undefined method `add_manager' for #Rally:0x4c1fa90</p>\n</blockquote>\n\n<pre><code>def add_manager\n    if @rally.add_manager(manager_params)\n      format.html { redirect_to @rally, notice: 'Manager successfully added.' }\n      format.json { head :no_content }\n    else\n</code></pre>\n\n<p>Here is what I have in my code</p>\n\n<p><strong>rally.rb</strong></p>\n\n<pre><code>def self.add_manager(params)\n    user = User.where(:email =&gt; params[:email])\n    rally.users &lt;&lt; user\nend\n</code></pre>\n\n<p><strong>rallies_controller.rb</strong></p>\n\n<pre><code>  def add_manager\n    if @rally.add_manager(manager_params)\n      format.html { redirect_to @rally, notice: 'Manager successfully added.' }\n      format.json { head :no_content }\n    else\n      format.html { render action: 'edit' }\n      format.json { render json: @rally.errors, status: :unprocessable_entity }\n    end\n  end\n</code></pre>\n\n<p>Testing I've done so far:</p>\n\n<ul>\n<li>Check the @rally is set: works</li>\n<li>Checked listed methods available: add_manager was not listed</li>\n<li>Tested all commands in rails console: works</li>\n</ul>\n\n<p>Any idea what I'm doing wrong? </p>\n"}, {"tags": ["ruby", "proc"], "answers": [{"tags": [], "owner": {"reputation": 628, "user_id": 4255944, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/c75ab63b854066c9a244530676657025?s=128&d=identicon&r=PG&f=1", "display_name": "dsounded", "link": "https://stackoverflow.com/users/4255944/dsounded"}, "is_accepted": false, "score": 0, "last_activity_date": 1438182973, "creation_date": 1438182973, "answer_id": 31704524, "question_id": 31689373, "link": "https://stackoverflow.com/questions/31689373/is-it-possible-to-alter-the-code-inside-a-proc/31704524#31704524", "title": "Is it possible to alter the code inside a proc?", "body": "<p>You could provide these or similar methods by using method_missing(<a href=\"http://ruby-doc.org/core-2.1.0/BasicObject.html#method-i-method_missing\" rel=\"nofollow\">http://ruby-doc.org/core-2.1.0/BasicObject.html#method-i-method_missing</a>). Just take the method name like string, split it with '_' and make a couple of things you need. It's some kind of Builders' pattern implementation.</p>\n"}], "owner": {"reputation": 501, "user_id": 5065939, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/2ea2ad20076d69570c0d1ca3253761d6?s=128&d=identicon&r=PG&f=1", "display_name": "JayTarka", "link": "https://stackoverflow.com/users/5065939/jaytarka"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 37, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1438182973, "creation_date": 1438129968, "question_id": 31689373, "link": "https://stackoverflow.com/questions/31689373/is-it-possible-to-alter-the-code-inside-a-proc", "title": "Is it possible to alter the code inside a proc?", "body": "<p>to_source provided by the sourcify gem.</p>\n\n<p>I wonder how would one would create these methods?</p>\n\n<pre><code>hello = Proc.new{ 2.times{ puts 'hi' } }\nhello.to_source #=&gt; 2.times{ puts 'hi' }\nhello.call #=&gt; 'hi' 'hi'\nhello.change_hi_to_bye!\nhello.to_source #=&gt; 2.times{ puts 'bye' }\nhello.call #=&gt; 'bye' 'bye'\nhello.get_rid_of_block!\nhello.to_source #=&gt; 2.times\nhello.call #=&gt;\n</code></pre>\n\n<p>I'd be interested in the <code>get_rid_of_block!</code> method. Something generic that could strip all the blocks out of all the methods in a proc.</p>\n\n<p>I've had a breif look into <code>RubyVM::InstructionSequence.of(my_proc).to_a</code> with a view to altering the build sequence (thought there'd be a nice little <code>:attach_block</code> field I could delete, but unfortunately not that I could see.</p>\n"}, {"tags": ["ruby", "module", "packages"], "answers": [{"comments": [{"owner": {"reputation": 1922, "user_id": 4934984, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/8c959e6ff4a1b49733025dfa53bafcb6?s=128&d=identicon&r=PG", "display_name": "Tushortz", "link": "https://stackoverflow.com/users/4934984/tushortz"}, "edited": false, "score": 0, "creation_date": 1438214511, "post_id": 31689467, "comment_id": 51363960, "body": "from your bottom example can I use the Eventsim module in the three different files i mean. same module name in three different files"}, {"owner": {"reputation": 167912, "user_id": 240443, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/495d675e3bc42ed1dee469e2ce701f1b?s=128&d=identicon&r=PG", "display_name": "Amadan", "link": "https://stackoverflow.com/users/240443/amadan"}, "reply_to_user": {"reputation": 1922, "user_id": 4934984, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/8c959e6ff4a1b49733025dfa53bafcb6?s=128&d=identicon&r=PG", "display_name": "Tushortz", "link": "https://stackoverflow.com/users/4934984/tushortz"}, "edited": false, "score": 1, "creation_date": 1438216184, "post_id": 31689467, "comment_id": 51364387, "body": "Yup. Ruby has no problems reopening already defined classes or modules for further modification. You will need <code>module EventSims; module Discrete; ... end; end</code> or similar in each file; alternately, <code>module EventSims; end</code> in the top file (<code>eventsims.rb</code>), then you can use <code>module EventSims::Discrete; ... end</code> in individual files."}], "tags": [], "owner": {"reputation": 167912, "user_id": 240443, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/495d675e3bc42ed1dee469e2ce701f1b?s=128&d=identicon&r=PG", "display_name": "Amadan", "link": "https://stackoverflow.com/users/240443/amadan"}, "is_accepted": false, "score": 0, "last_activity_date": 1438131158, "last_edit_date": 1438131158, "creation_date": 1438130773, "answer_id": 31689467, "question_id": 31689295, "link": "https://stackoverflow.com/questions/31689295/ruby-module-structure-insight/31689467#31689467", "title": "ruby module structure insight", "body": "<p>Unlike some other languages, Ruby does not tie the filesystem names to module hierarchy. If you <em>want</em> to have <code>require \"eventsims\"</code> provide the module <code>Discrete</code>, you <em>can</em>. Whether or not it's a good idea, it is for you to decide - Ruby is not your Mum. There are two potential pitfalls:</p>\n\n<ul>\n<li>Gem users might get confused, and wonder how to use your gem</li>\n<li>Someone in some other gem also defines <code>Discrete</code> and you have a collision.</li>\n</ul>\n\n<p>A compromise between the two approaches (having a distinct namespace and having less to type) is to indeed have a top module <code>EventSims</code>, and for users to <code>include</code> it if they want to access the next level down directly:</p>\n\n<pre><code># safe usage\nrequire 'eventsims'\nEventSims::Discrete::Calculate.new\n\n# easy usage\nrequire 'eventsims'\ninclude EventSims\nDiscrete::Calculate.new\n\n# restricted easy usage\nrequire 'eventsims'\nmodule MyCode\n  include EventSims\n  Discrete::Calculate.new\nend\nEventSims::Discrete::Calculate.new\n</code></pre>\n\n<p>This way, you still have namespacing, and you can get rid of it when you know there is no collision in your code. Going the other way around (having no namespacing and trying to isolate the code when a collision <em>does</em> happen) is significantly more difficult.</p>\n"}], "owner": {"reputation": 1922, "user_id": 4934984, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/8c959e6ff4a1b49733025dfa53bafcb6?s=128&d=identicon&r=PG", "display_name": "Tushortz", "link": "https://stackoverflow.com/users/4934984/tushortz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 116, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1438131158, "creation_date": 1438129410, "question_id": 31689295, "link": "https://stackoverflow.com/questions/31689295/ruby-module-structure-insight", "title": "ruby module structure insight", "body": "<p>I'm new to Ruby and i'm making a Ruby package. \nstructure is: </p>\n\n<pre><code>eventsims (main folder)\n  |__lib\n     |__eventsims {subfolder)\n     |  |__discrete.rb\n     |  |__randgen.rb\n     |  |__simevent.rb\n     |  |version.rb\n     |__eventsims.rb\n</code></pre>\n\n<p>If i put all the codes in my three modules file (discrete, randgen and simevent) in the [\"Eventsims\" module inside the eventsims.rb file], it is easy but there would be up to 1000 lines of code which I don't want</p>\n\n<p>Now I have a \"require\" lines of code inside eventsim.rb that requires all these four files in the eventsim subfolder.</p>\n\n<p>I can use all the modules, no errors. \nfor example in the discrete.rb, a module called Discrete with a Calculate class having an expectval method:</p>\n\n<p>Is this how I would be able to use the package after installing it with Rubygems</p>\n\n<pre><code>require \"Eventsims\"\na = Discrete::Calculate.new([1,0,4,2], [0.2, 0.4, 0.6, 1.0])\na.expectval()\n</code></pre>\n\n<p>and if yes, is it sensible to have it that way because so many modules I've seen will have something like:</p>\n\n<pre><code>require \"eventsims\"\nEventsims::someclass.new\n</code></pre>\n\n<p>which in my case would be\n    require \"eventsims\"\n    Discrete::someclass.new</p>\n\n<p>I'm worried about the consistency of the required file and its namespacing. require <strong>eventsim</strong> and its different <strong>Discrete</strong></p>\n\n<p>Sorry the question is really long.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "forms", "ruby-on-rails-4"], "comments": [{"owner": {"reputation": 15583, "user_id": 177489, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/sv6zK.jpg?s=128&g=1", "display_name": "Mark Swardstrom", "link": "https://stackoverflow.com/users/177489/mark-swardstrom"}, "edited": false, "score": 0, "creation_date": 1438130488, "post_id": 31688862, "comment_id": 51320503, "body": "A note - with ActiveRecord, if you have created_at and updated_at in your db, you&#39;ll get create_date and last_modify for free.  In your migration do <code>t.timestamps</code>"}, {"owner": {"reputation": 5428, "user_id": 1938097, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/928c1abb5e28975cff71561ce3ed98d6?s=128&d=identicon&r=PG", "display_name": "Austio", "link": "https://stackoverflow.com/users/1938097/austio"}, "edited": false, "score": 0, "creation_date": 1438653187, "post_id": 31688862, "comment_id": 51526080, "body": "recip_ingredients_attributes -&gt; recipe_ingredients_attributes"}], "answers": [{"comments": [{"owner": {"reputation": 103, "user_id": 5167041, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/d2c852379fc293d9139f9b2d1cbc0419?s=128&d=identicon&r=PG&f=1", "display_name": "SL07", "link": "https://stackoverflow.com/users/5167041/sl07"}, "edited": false, "score": 0, "creation_date": 1438204158, "post_id": 31689297, "comment_id": 51360375, "body": "I changed everything to recipe_ingredients. Now i&#39;m getting: Unpermitted parameter: recipe_ingredients"}, {"owner": {"reputation": 5428, "user_id": 1938097, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/928c1abb5e28975cff71561ce3ed98d6?s=128&d=identicon&r=PG", "display_name": "Austio", "link": "https://stackoverflow.com/users/1938097/austio"}, "reply_to_user": {"reputation": 103, "user_id": 5167041, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/d2c852379fc293d9139f9b2d1cbc0419?s=128&d=identicon&r=PG&f=1", "display_name": "SL07", "link": "https://stackoverflow.com/users/5167041/sl07"}, "edited": false, "score": 0, "creation_date": 1438225082, "post_id": 31689297, "comment_id": 51366478, "body": "did you also change your recipe_params"}, {"owner": {"reputation": 103, "user_id": 5167041, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/d2c852379fc293d9139f9b2d1cbc0419?s=128&d=identicon&r=PG&f=1", "display_name": "SL07", "link": "https://stackoverflow.com/users/5167041/sl07"}, "edited": false, "score": 0, "creation_date": 1438296923, "post_id": 31689297, "comment_id": 51406077, "body": "I&#39;ve changed the recipe_params to:  <code>def recipe_params       params.require(:recipes).permit(:id, :product_type, :name, :steps, :note,          :create_date, :last_modify,          :recipe_ingredients_attributes=&gt; [:id, :recipe_id, :ingreident_name,              :amount, :unit])     end</code>"}, {"owner": {"reputation": 5428, "user_id": 1938097, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/928c1abb5e28975cff71561ce3ed98d6?s=128&d=identicon&r=PG", "display_name": "Austio", "link": "https://stackoverflow.com/users/1938097/austio"}, "reply_to_user": {"reputation": 103, "user_id": 5167041, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/d2c852379fc293d9139f9b2d1cbc0419?s=128&d=identicon&r=PG&f=1", "display_name": "SL07", "link": "https://stackoverflow.com/users/5167041/sl07"}, "edited": false, "score": 0, "creation_date": 1438347104, "post_id": 31689297, "comment_id": 51426759, "body": "could you do a puts from your controller for both params and recipe_params and then add them to your question"}, {"owner": {"reputation": 103, "user_id": 5167041, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/d2c852379fc293d9139f9b2d1cbc0419?s=128&d=identicon&r=PG&f=1", "display_name": "SL07", "link": "https://stackoverflow.com/users/5167041/sl07"}, "edited": false, "score": 0, "creation_date": 1438471202, "post_id": 31689297, "comment_id": 51466047, "body": "I rewrite my code for the embeded form. Now I&#39;m getting a different error message. I&#39;ve updated the question posted above. Thanks!"}], "tags": [], "owner": {"reputation": 5428, "user_id": 1938097, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/928c1abb5e28975cff71561ce3ed98d6?s=128&d=identicon&r=PG", "display_name": "Austio", "link": "https://stackoverflow.com/users/1938097/austio"}, "is_accepted": true, "score": 1, "last_activity_date": 1438146707, "last_edit_date": 1438146707, "creation_date": 1438129435, "answer_id": 31689297, "question_id": 31688862, "link": "https://stackoverflow.com/questions/31688862/rails-4-nested-form-param-is-missing-or-the-value-is-empty/31689297#31689297", "title": "Rails 4 Nested Form- param is missing or the value is empty:", "body": "<p>Looks like you come from javascript background.</p>\n\n<p><code>recipeIngredients</code> in all cases needs to be <code>recipe_ingredients</code></p>\n"}], "owner": {"reputation": 103, "user_id": 5167041, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/d2c852379fc293d9139f9b2d1cbc0419?s=128&d=identicon&r=PG&f=1", "display_name": "SL07", "link": "https://stackoverflow.com/users/5167041/sl07"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 172, "favorite_count": 0, "accepted_answer_id": 31689297, "answer_count": 1, "score": 1, "last_activity_date": 1438471804, "creation_date": 1438126386, "last_edit_date": 1438471804, "question_id": 31688862, "link": "https://stackoverflow.com/questions/31688862/rails-4-nested-form-param-is-missing-or-the-value-is-empty", "title": "Rails 4 Nested Form- param is missing or the value is empty:", "body": "<p>I'm trying to create a nested form in Rails 4. However, the nested attribute is not being saved to database. The error message that I am receiving is \"param is missing or the value is empty\". Based on the params output, I know that the following is wrong. </p>\n\n<pre><code>\"recipe_ingredients_attributes\"=&gt;{\"0\"=&gt;{\"ingreident_name\"=&gt;\"321\",\n     \"amount\"=&gt;\"1\",\n     \"unit\"=&gt;\"g\"}},\n</code></pre>\n\n<p>It should be as follow:</p>\n\n<pre><code>\"recipe_ingredients_attributes\"=&gt;{\"recipe_id\" =&gt; 1, ingreident_name\"=&gt;\"321\", \"amount\"=&gt;\"1\", \"unit\"=&gt;\"g\"},\n</code></pre>\n\n<p>Can someone please help me to solve this. Thanks.</p>\n\n<p>Note: recipe_ingredients does not have it own controller</p>\n\n<p>The following is the my code. </p>\n\n<p>Parameters Output:</p>\n\n<pre><code>{\"utf8\"=&gt;\"\u2713\",\n \"authenticity_token\"=&gt;\"GPN4rrurH+77Z7QbQZSlguJE/HJvUCVJzVkAtmgiL39jZ/ouzbh53K4PCwdaXopB3vn+8jA0gRfRcahqWfj9kw==\",\n \"recipe\"=&gt;{\"name\"=&gt;\"321\",\n \"product_type\"=&gt;\"Gelato\",\n \"description\"=&gt;\"321\",\n \"steps\"=&gt;\"321\",\n \"note\"=&gt;\"321\",\n \"recipe_ingredients_attributes\"=&gt;{\"0\"=&gt;{\"ingreident_name\"=&gt;\"321\",\n \"amount\"=&gt;\"1\",\n \"unit\"=&gt;\"g\"}},\n \"create_date\"=&gt;\"2015-08-01 16:10:08 -0700\",\n \"last_modify\"=&gt;\"2015-08-01 16:10:08 -0700\"},\n \"commit\"=&gt;\"create\"}\n</code></pre>\n\n<p>/schema.rb</p>\n\n<pre><code>create_table \"recipe_ingredients\", force: :cascade do |t|\n    t.integer \"recipe_id\",       limit: 4,   null: false\n    t.string  \"ingreident_name\", limit: 200, null: false\n    t.integer \"amount\",          limit: 4,   null: false\n    t.string  \"unit\",            limit: 45,  null: false\nend \n\ncreate_table \"recipes\", force: :cascade do |t|\n    t.string   \"product_type\", limit: 45,  null: false\n    t.string   \"name\",         limit: 45,  null: false\n    t.string   \"steps\",        limit: 500, null: false\n    t.string   \"note\",         limit: 500\n    t.date     \"create_date\",              null: false\n    t.datetime \"last_modify\",              null: false\nend\n</code></pre>\n\n<p>/models/recipe.rb</p>\n\n<pre><code>class Recipe &lt; ActiveRecord::Base\n    has_many :recipe_ingredients, :dependent =&gt; :destroy\n    accepts_nested_attributes_for :recipe_ingredients\nend\n</code></pre>\n\n<p>/models/recipe_ingredients.rb</p>\n\n<pre><code>class RecipeIngredient &lt; ActiveRecord::Base\n    belongs_to :recipe\nend\n</code></pre>\n\n<p>/recipe_controller.rb</p>\n\n<pre><code>class RecipeController &lt; ApplicationController\n\n  def index    #where the form is located\n     @test = Recipe.new\n     @test.recipe_ingredients.build  \n  end\n\n  def createRecipe\n    @recipe = Recipe.new(recipe_params)\n\n    if @recipe.save\n      redirect_to recipe_path  \n    else\n      render plain: 'plain text'\n    end\n  end\n\n  private\n\n    def recipe_params\n      params.require(:recipes).permit(:id, :product_type, :name, :steps, :note, \n        :create_date, :last_modify, \n        :recip_ingredients_attributes=&gt; [:recipe_id, :ingreident_name, \n            :amount, :unit])\n    end\n   end\nend\n</code></pre>\n\n<p>view for the form</p>\n\n<pre><code>&lt;%= form_for @test, :url =&gt; {:action =&gt; \"createRecipe\"}, :html =&gt; {:method =&gt; \"POST\"} do |f| %&gt;\n  Name\n  &lt;br/&gt;\n  &lt;%= f.text_field :name %&gt;\n  &lt;br/&gt;\n  Product Type\n  &lt;br/&gt;\n  &lt;%= f.text_field :product_type %&gt;\n  &lt;br/&gt;\n  Steps\n  &lt;br/&gt;\n  &lt;%= f.text_area :steps, :size =&gt; \"65x15\", :maxlength =&gt; \"5000\" %&gt;\n  &lt;br/&gt;\n  Notes\n  &lt;br/&gt;\n  &lt;%= f.text_area :note, :size =&gt; \"65x5\", :maxlength =&gt; \"5000\" %&gt;\n  &lt;br/&gt;\n  Ingridients\n  &lt;br/&gt;\n  &lt;%= f.fields_for :recipe_ingredients do |builder| %&gt;\n    &lt;%= builder.text_field :ingreident_name %&gt;\n    &lt;%= builder.text_field :amount %&gt;\n    &lt;%= builder.text_field :unit %&gt;\n  &lt;% end %&gt;\n  &lt;%= f.hidden_field :create_date, :value =&gt; Time.now %&gt;\n  &lt;%= f.hidden_field :last_modify, :value =&gt; Time.now %&gt;\n  &lt;%= f.submit \"create\" %&gt;\n&lt;% end %&gt;\n</code></pre>\n"}, {"tags": ["ruby"], "answers": [{"tags": [], "owner": {"reputation": 2560, "user_id": 5112122, "user_type": "registered", "profile_image": "https://graph.facebook.com/10206053108358704/picture?type=large", "display_name": "Horacio", "link": "https://stackoverflow.com/users/5112122/horacio"}, "is_accepted": true, "score": 3, "last_activity_date": 1438124653, "creation_date": 1438124653, "answer_id": 31688607, "question_id": 31688584, "link": "https://stackoverflow.com/questions/31688584/in-ruby-is-there-anything-like-using/31688607#31688607", "title": "In ruby, is there anything like using?", "body": "<p>If you want namespaces you could use ruby's modules <a href=\"http://ruby-doc.org/core-2.2.2/Module.html\" rel=\"nofollow\">here</a> you have documentation about that.</p>\n\n<p>And <a href=\"http://ruby-doc.com/docs/ProgrammingRuby/html/tut_modules.html\" rel=\"nofollow\">here</a> you'll find some examples to use as namespaces</p>\n"}], "owner": {"reputation": 21398, "user_id": 1136700, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/e484894210178f84679e4e35695ff8ac?s=128&d=identicon&r=PG", "display_name": "Adam Lee", "link": "https://stackoverflow.com/users/1136700/adam-lee"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 30, "favorite_count": 0, "accepted_answer_id": 31688607, "answer_count": 1, "score": -1, "last_activity_date": 1438124653, "creation_date": 1438124552, "question_id": 31688584, "link": "https://stackoverflow.com/questions/31688584/in-ruby-is-there-anything-like-using", "title": "In ruby, is there anything like using?", "body": "<p>Some class are defined using module to create namespace. I am wondering if Ruby has the mechanism like using to use the namespace?</p>\n\n<p>in CSharp, we could</p>\n\n<pre><code>using ****\n</code></pre>\n\n<p>How to do it in Ruby?</p>\n"}, {"tags": ["ruby", "arguments", "rake", "task", "filenames"], "comments": [{"owner": {"reputation": 6702, "user_id": 744436, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/3478efd1de1ba3c35784d870b77fae89?s=128&d=identicon&r=PG", "display_name": "ciembor", "link": "https://stackoverflow.com/users/744436/ciembor"}, "reply_to_user": {"reputation": 394580, "user_id": 479863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ArUCE.jpg?s=128&g=1", "display_name": "mu is too short", "link": "https://stackoverflow.com/users/479863/mu-is-too-short"}, "edited": false, "score": 0, "creation_date": 1438160540, "post_id": 31688376, "comment_id": 51331705, "body": "Passing file names given by functionality of CircleCI. It provides list of filenames in this format, I must take them as argument to my task and I can&#39;t preformat it."}], "owner": {"reputation": 6702, "user_id": 744436, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/3478efd1de1ba3c35784d870b77fae89?s=128&d=identicon&r=PG", "display_name": "ciembor", "link": "https://stackoverflow.com/users/744436/ciembor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 110, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1438123440, "creation_date": 1438123440, "question_id": 31688376, "link": "https://stackoverflow.com/questions/31688376/how-to-pass-space-separated-filenames-list-to-the-rake-task", "title": "How to pass space separated filenames list to the rake task?", "body": "<p>I need to pass filenames to my rake task as command line arguments and the format is specified, so I can't pass any comma separated array. It must looks like that:</p>\n\n<pre><code>file_1.coffee file_2.coffee file_3.coffee\n</code></pre>\n\n<p>How can I pass something like that to the rake task and read it? The list size isn't specified, it's dynamic.</p>\n"}, {"tags": ["ruby", "rvm"], "comments": [{"owner": {"reputation": 2569, "user_id": 514040, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/98bb1ee1a1f3d1297acf493776066086?s=128&d=identicon&r=PG", "display_name": "neuronaut", "link": "https://stackoverflow.com/users/514040/neuronaut"}, "edited": false, "score": 1, "creation_date": 1438123282, "post_id": 31688296, "comment_id": 51318398, "body": "I usually just put a file named <code>.ruby-version</code> in my project&#39;s root directory and in that file I put <code>1.9.3</code> (or whatever ruby version I want). Then any time I cd into that directory rvm will automatically change the ruby version for me. This is especially handy if you have multiple projects using different versions ruby."}], "owner": {"reputation": 1022, "user_id": 4190203, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/ab42486428f113dcac28a2b3c289b4f2?s=128&d=identicon&r=PG&f=1", "display_name": "Peter Black", "link": "https://stackoverflow.com/users/4190203/peter-black"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 28, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1438123002, "creation_date": 1438123002, "question_id": 31688296, "link": "https://stackoverflow.com/questions/31688296/why-does-rvm-default-use-1-9-3-not-set-1-9-3-as-default", "title": "why does &#39;rvm --default use 1.9.3&#39; not set 1.9.3 as default?", "body": "<p>I have a multi-user rvm installation that I setup using the instructions from: <a href=\"https://rvm.io/rvm/install\" rel=\"nofollow\">https://rvm.io/rvm/install</a> </p>\n\n<p>Every time I go to the root directory of my application and run:</p>\n\n<pre><code> rails s\n</code></pre>\n\n<p>The terminal complains with:</p>\n\n<pre><code> The program 'rails' can be found in the following packages:\n * ruby-railties-3.2\n * ruby-railties-4.0\n</code></pre>\n\n<p>To fix this, I run:</p>\n\n<pre><code> rvm use 1.9.3\n</code></pre>\n\n<p>or</p>\n\n<pre><code> rvm --default use 1.9.3\n</code></pre>\n\n<p>The default is never set. The next time I go to the root directory of my app or even during the same session and open up a new terminal window to run 'rails c' I have to 'rvm use 1.9.3'... What did I miss? This is the second time I have setup a multi-user installation of rvm and had this happen. Its gone from annoying to frustrating.</p>\n"}, {"tags": ["mysql", "ruby", "sequel"], "answers": [{"tags": [], "owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "is_accepted": true, "score": 1, "last_activity_date": 1438123459, "last_edit_date": 1438123459, "creation_date": 1438123058, "answer_id": 31688305, "question_id": 31688250, "link": "https://stackoverflow.com/questions/31688250/how-can-i-get-the-auto-increment-value-in-sequel/31688305#31688305", "title": "How can I get the AUTO_INCREMENT value in Sequel?", "body": "<p>If nothing else, Sequel makes it easy to send raw SQL:</p>\n\n<pre><code>DB[\"SELECT `AUTO_INCREMENT` FROM  INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA = 'DatabaseName' AND TABLE_NAME = 'TableName'\"]\n</code></pre>\n\n<p>From <a href=\"http://sequel.jeremyevans.net/rdoc/files/doc/cheat_sheet_rdoc.html#label-Using+raw+SQL\" rel=\"nofollow\">the documentation</a>:</p>\n\n<blockquote>\n  <p>Using raw SQL</p>\n\n<pre><code>DB.run \"CREATE TABLE users (name VARCHAR(255) NOT NULL, age INT(3) NOT NULL)\"\ndataset = DB[\"SELECT age FROM users WHERE name = ?\", name]\ndataset.map(:age)\nDB.fetch(\"SELECT name FROM users\") do |row|\n  p row[:name]\nend\n</code></pre>\n</blockquote>\n"}], "owner": {"reputation": 10064, "user_id": 1769276, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/ddbbe9a629cce4be0da2d0a7a3421370?s=128&d=identicon&r=PG", "display_name": "PressingOnAlways", "link": "https://stackoverflow.com/users/1769276/pressingonalways"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 248, "favorite_count": 0, "accepted_answer_id": 31688305, "answer_count": 1, "score": 0, "last_activity_date": 1438123459, "creation_date": 1438122726, "last_edit_date": 1438122941, "question_id": 31688250, "link": "https://stackoverflow.com/questions/31688250/how-can-i-get-the-auto-increment-value-in-sequel", "title": "How can I get the AUTO_INCREMENT value in Sequel?", "body": "<p>In MySQL, I can get the auto-increment value by:</p>\n\n<pre><code>SELECT `AUTO_INCREMENT`\nFROM  INFORMATION_SCHEMA.TABLES\nWHERE TABLE_SCHEMA = 'DatabaseName'\nAND   TABLE_NAME   = 'TableName';\n</code></pre>\n\n<p>How do I query this information in Sequel? When I tried <code>DB.run</code> and <code>DB.get</code>, it didn't seem to work.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-4", "rubygems", "cancancan"], "answers": [{"tags": [], "owner": {"reputation": 9572, "user_id": 2305826, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/xRwWw.png?s=128&g=1", "display_name": "MarsAtomic", "link": "https://stackoverflow.com/users/2305826/marsatomic"}, "is_accepted": false, "score": 0, "last_activity_date": 1438121798, "creation_date": 1438121798, "answer_id": 31688078, "question_id": 31687920, "link": "https://stackoverflow.com/questions/31687920/how-to-hide-checkboxes-for-user-authorization/31688078#31688078", "title": "How to hide checkboxes for user authorization", "body": "<p>Allowing users to set their own roles is probably a bad idea, even for non-privileged roles.</p>\n\n<p>Just guessing by context, you're working on a childcare application, where users can sign up as customers or as sitters. You should set up your checkboxes manually, rather than building them based on your <code>@roles</code> array list, or you can create a <code>@public_roles</code> array for use in your views that only includes non-admin roles.</p>\n\n<p>Finally, for some reason, you have a role called 'banned' which technically isn't a role -- it's a user state which should be dealt with separately.</p>\n"}, {"tags": [], "owner": {"reputation": 1756, "user_id": 295671, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/0fc94068a4be0dd57d34a223722f2690?s=128&d=identicon&r=PG", "display_name": "james246", "link": "https://stackoverflow.com/users/295671/james246"}, "is_accepted": false, "score": 0, "last_activity_date": 1438121825, "creation_date": 1438121825, "answer_id": 31688086, "question_id": 31687920, "link": "https://stackoverflow.com/questions/31687920/how-to-hide-checkboxes-for-user-authorization/31688086#31688086", "title": "How to hide checkboxes for user authorization", "body": "<p>In edit.html.erb replace <code>for role in User::ROLES</code> with <code>for role in %i[customer sitter]</code></p>\n\n<p>You should consider the possibility that a malicious user may also craft their own checkbox for one of the protected states (<code>admin</code> or <code>banned</code>). Make sure to build in protection to make sure users cannot set themselves to <code>admin</code> unless they are allowed to.</p>\n"}], "owner": {"reputation": 305, "user_id": 3736107, "user_type": "registered", "accept_rate": 27, "profile_image": "https://www.gravatar.com/avatar/4e2080e38942f425cd3a0cd32a676270?s=128&d=identicon&r=PG&f=1", "display_name": "achilles77", "link": "https://stackoverflow.com/users/3736107/achilles77"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 92, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1438121825, "creation_date": 1438121010, "question_id": 31687920, "link": "https://stackoverflow.com/questions/31687920/how-to-hide-checkboxes-for-user-authorization", "title": "How to hide checkboxes for user authorization", "body": "<p>Good day, I am using the CanCanCan gem, an authorization library for Ruby on Rails which restricts what resources a given user is allowed to access.  It is working however when users sign up, all of the options including 'admin' and 'banned' show up.  I want to hide those two checkboxes and leave 'customer' and 'sitter'.  How would I do that?</p>\n\n<p>user.rb</p>\n\n<pre><code>class User &lt; ActiveRecord::Base\n\n  ROLES = %i[admin sitter customer banned]\n\n  def roles=(roles)\n    roles = [*roles].map { |r| r.to_sym }\n    self.roles_mask = (roles &amp; ROLES).map { |r| 2**ROLES.index(r) }.inject(0, :+)\n  end\n\n  def roles\n    ROLES.reject do |r|\n      ((roles_mask.to_i || 0) &amp; 2**ROLES.index(r)).zero?\n    end\n  end\n\n  def has_role?(role)\n    roles.include?(role)\n  end\n</code></pre>\n\n<p>edit.html.erb</p>\n\n<pre><code>        &lt;% for role in User::ROLES %&gt;\n          &lt;%= check_box_tag \"user[roles][#{role}]\", role, @user.roles.include?(role), {:name =&gt; \"user[roles][]\"}%&gt;\n          &lt;%= label_tag \"user_roles_#{role}\", role.to_s.humanize %&gt;&lt;br /&gt;\n        &lt;% end %&gt;\n        &lt;%= hidden_field_tag \"user[roles][]\", \"\" %&gt;\n      &lt;/div&gt;\n      &lt;/div&gt;\n</code></pre>\n\n<p><a href=\"https://github.com/CanCanCommunity/cancancan\" rel=\"nofollow\">https://github.com/CanCanCommunity/cancancan</a></p>\n"}, {"tags": ["ruby", "nginx", "sinatra", "passenger"], "comments": [{"owner": {"reputation": 17872, "user_id": 20816, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/02f0ee0da223f90bb9996ef252e528c1?s=128&d=identicon&r=PG", "display_name": "Hongli", "link": "https://stackoverflow.com/users/20816/hongli"}, "edited": false, "score": 0, "creation_date": 1438172615, "post_id": 31687891, "comment_id": 51339654, "body": "Can you post relevant messages from the Nginx error log file?"}, {"owner": {"reputation": 365, "user_id": 1555301, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0702710f1b3f9025493cb3e30a800d14?s=128&d=identicon&r=PG", "display_name": "Korben Dallas", "link": "https://stackoverflow.com/users/1555301/korben-dallas"}, "reply_to_user": {"reputation": 17872, "user_id": 20816, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/02f0ee0da223f90bb9996ef252e528c1?s=128&d=identicon&r=PG", "display_name": "Hongli", "link": "https://stackoverflow.com/users/20816/hongli"}, "edited": false, "score": 0, "creation_date": 1438181869, "post_id": 31687891, "comment_id": 51346702, "body": "I&#39;ve added the error log info."}, {"owner": {"reputation": 365, "user_id": 1555301, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0702710f1b3f9025493cb3e30a800d14?s=128&d=identicon&r=PG", "display_name": "Korben Dallas", "link": "https://stackoverflow.com/users/1555301/korben-dallas"}, "reply_to_user": {"reputation": 17872, "user_id": 20816, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/02f0ee0da223f90bb9996ef252e528c1?s=128&d=identicon&r=PG", "display_name": "Hongli", "link": "https://stackoverflow.com/users/20816/hongli"}, "edited": false, "score": 0, "creation_date": 1438806048, "post_id": 31687891, "comment_id": 51605629, "body": "For any future viewers I finally got it working with nginx and unicorn as deatiled in the sinatra docs <a href=\"http://recipes.sinatrarb.com/p/deployment/nginx_proxied_to_unicorn\" rel=\"nofollow noreferrer\">here</a>"}], "answers": [{"comments": [{"owner": {"reputation": 365, "user_id": 1555301, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0702710f1b3f9025493cb3e30a800d14?s=128&d=identicon&r=PG", "display_name": "Korben Dallas", "link": "https://stackoverflow.com/users/1555301/korben-dallas"}, "edited": false, "score": 0, "creation_date": 1438287702, "post_id": 31713660, "comment_id": 51402041, "body": "Thanks for the reply but this guide is very similar to guide I used from Passenger documentation. I tried a few options to no avail and have finally given up. I&#39;m going to give Apache a run next and see if it will go more smoothly."}], "tags": [], "owner": {"reputation": 3396, "user_id": 2803660, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/97dcc39b47364ae9599cd685d96999cc?s=128&d=identicon&r=PG", "display_name": "MrHaze", "link": "https://stackoverflow.com/users/2803660/mrhaze"}, "is_accepted": false, "score": 0, "last_activity_date": 1438218458, "creation_date": 1438218458, "answer_id": 31713660, "question_id": 31687891, "link": "https://stackoverflow.com/questions/31687891/403-forbidden-on-nginx-passenger-sinatra/31713660#31713660", "title": "403 Forbidden on nginx + passenger + sinatra", "body": "<p>Try following this: <a href=\"https://www.digitalocean.com/community/tutorials/how-to-deploy-a-rails-app-with-passenger-and-nginx-on-ubuntu-14-04\" rel=\"nofollow\">https://www.digitalocean.com/community/tutorials/how-to-deploy-a-rails-app-with-passenger-and-nginx-on-ubuntu-14-04</a></p>\n\n<p>If you already have passenger configured, just skip that and work on the nginx configuration.</p>\n"}, {"tags": [], "owner": {"reputation": 686, "user_id": 2243033, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/79798816765c365100b9752317ecfe28?s=128&d=identicon&r=PG", "display_name": "Stewart Evans", "link": "https://stackoverflow.com/users/2243033/stewart-evans"}, "is_accepted": false, "score": 0, "last_activity_date": 1485515919, "creation_date": 1485515919, "answer_id": 41892770, "question_id": 31687891, "link": "https://stackoverflow.com/questions/31687891/403-forbidden-on-nginx-passenger-sinatra/41892770#41892770", "title": "403 Forbidden on nginx + passenger + sinatra", "body": "<p>I'm just beginning with Ruby|Sinatra|Passenger|Nginx and I had the same obscure problem.</p>\n\n<p>After a lot of hacking around the following configuration worked for me. It's probably not perfect but I hope it helps someone else get through this problem.</p>\n\n<p><strong>Folder Structure (755 www-data):</strong></p>\n\n<pre><code>--sinatra_test\n----public #added this blank dir\n----tmp    #added this blank dir\n----config.ru\n----SinatraTest.rb\n</code></pre>\n\n<p><strong>config.ru:</strong></p>\n\n<pre><code>require File.absolute_path(\"SinatraTest.rb\")\nrun SinatraTest\n</code></pre>\n\n<p><strong>SinatraTest.rb:</strong></p>\n\n<pre><code>require 'sinatra/base'\n\nclass SinatraTest &lt; Sinatra::Base\n    get '/' do\n      \"Hello World\"\n    end\nend\n</code></pre>\n\n<p><strong>Nginx .conf:</strong></p>\n\n<pre><code>user www-data;\nworker_processes auto;\npid /run/nginx.pid;\n\nevents {\n        worker_connections 768;\n        # multi_accept on;\n}\n\nhttp {\n\n        sendfile on;\n        tcp_nopush on;\n        tcp_nodelay on;\n        keepalive_timeout 65;\n        types_hash_max_size 2048;\n        # server_tokens off;\n\n        # server_names_hash_bucket_size 64;\n        # server_name_in_redirect off;\n\n        include /etc/nginx/mime.types;\n        default_type application/octet-stream;\n\n        ##\n        # SSL Settings\n        ##\n\n        ssl_protocols TLSv1 TLSv1.1 TLSv1.2; # Dropping SSLv3, ref: POODLE\n        ssl_prefer_server_ciphers on;\n\n        ##\n        # Logging Settings\n        ##\n\n        access_log /var/log/nginx/access.log;\n        error_log /var/log/nginx/error.log;\n\n        gzip on;\n        gzip_disable \"msie6\";\n\n        passenger_root /usr/lib/ruby/vendor_ruby/phusion_passenger/locations.ini;\n        passenger_ruby /home/myusername/.rvm/gems/ruby-2.4.0/wrappers/ruby;\n\n        server {\n                listen 80;\n                server_name myservername.com;\n\n                # Tell Nginx and Passenger where your app's 'public' directory is\n                root /home/myusername/sinatra_test/public;\n\n                passenger_enabled on;\n        }\n}\n</code></pre>\n"}], "owner": {"reputation": 365, "user_id": 1555301, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0702710f1b3f9025493cb3e30a800d14?s=128&d=identicon&r=PG", "display_name": "Korben Dallas", "link": "https://stackoverflow.com/users/1555301/korben-dallas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1134, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1485515919, "creation_date": 1438120885, "last_edit_date": 1438193979, "question_id": 31687891, "link": "https://stackoverflow.com/questions/31687891/403-forbidden-on-nginx-passenger-sinatra", "title": "403 Forbidden on nginx + passenger + sinatra", "body": "<p>I've looked through a ton of posts but I just can't get past this 403 Forbidden error. I have:</p>\n\n<ol>\n<li>Updated nginx user permissions on website folder</li>\n<li>Updated passenger_ruby to use RVM wrapper directory</li>\n<li>Confirmed passenger_root path with passenger-config --root</li>\n</ol>\n\n<p>I'm still getting a 403 and can't seem to find what I am missing.</p>\n\n<p>Here are my files below.</p>\n\n<p><strong>Folder Structure</strong> (755 www-data):</p>\n\n<pre><code>--website\n----app\n----public\n----tmp\n----views\n----config.ru\n</code></pre>\n\n<p><strong>config.ru</strong>:</p>\n\n<pre><code>require 'rubygems'\nrequire 'sinatra'\n\nset :environment, ENV['RACK_ENV'].to_sym\ndisable :run, :reload\n\nrequire File.expand_path '../app/main.rb', __FILE__\n\nrun Sinatra::Application\n</code></pre>\n\n<p><strong>Server .conf</strong>:</p>\n\n<pre><code>server {\n  listen 80;\n  server_name website.com;\n\n  root /www/website/public;   # &lt;--- be sure to point to 'public'!\n  passenger_enabled on;\n}\n</code></pre>\n\n<p><strong>Nginx .conf</strong>:</p>\n\n<pre><code>passenger_root /usr/lib/ruby/vendor_ruby/phusion_passenger/locations.ini;\npassenger_ruby /usr/local/rvm/wrappers/ruby-2.2.1/ruby;\n</code></pre>\n\n<p><strong>Example main.rb</strong>:</p>\n\n<pre><code> Require 'slim'\n get \"/\"\n     slim: index\n do\n</code></pre>\n\n<p><strong>Sites Error Log:</strong></p>\n\n<pre><code>2015/07/28 19:09:45 [error] 34000#0: *2 directory index of \"/www/website/public/\" is forbidden, client: 0.0.0.0, server: website.com, request: \"GET / HTTP/1.1\", host: \"website.com\"\n</code></pre>\n"}, {"tags": ["ruby", "faraday"], "comments": [{"owner": {"reputation": 510, "user_id": 314721, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/d1e461ee329ac8b02c537ac72ca6e4e4?s=128&d=identicon&r=PG&f=1", "display_name": "Riina", "link": "https://stackoverflow.com/users/314721/riina"}, "edited": false, "score": 0, "creation_date": 1438372093, "post_id": 31687623, "comment_id": 51441743, "body": "Bit confused as to how a question about problems installing ruby documentation is off-topic for a programming site... I&#39;m not asking anyone to recommend anything, I&#39;m asking why my ruby documentation seemed to not be working and thanks to the comments below I was able to sort my problem out..."}], "answers": [{"tags": [], "owner": {"reputation": 1756, "user_id": 295671, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/0fc94068a4be0dd57d34a223722f2690?s=128&d=identicon&r=PG", "display_name": "james246", "link": "https://stackoverflow.com/users/295671/james246"}, "is_accepted": false, "score": 1, "last_activity_date": 1438119898, "creation_date": 1438119898, "answer_id": 31687678, "question_id": 31687623, "link": "https://stackoverflow.com/questions/31687623/where-is-the-ruby-documentation-for-gems/31687678#31687678", "title": "Where is the ruby documentation for gems?", "body": "<p>Check out the <a href=\"https://rubygems.org/gems/pry-doc\" rel=\"nofollow\">pry-doc</a> extension for <code>pry</code>. </p>\n"}, {"comments": [{"owner": {"reputation": 510, "user_id": 314721, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/d1e461ee329ac8b02c537ac72ca6e4e4?s=128&d=identicon&r=PG&f=1", "display_name": "Riina", "link": "https://stackoverflow.com/users/314721/riina"}, "edited": false, "score": 0, "creation_date": 1438246491, "post_id": 31687753, "comment_id": 51375373, "body": "This was the problem, <code>gem: --no-ri --no-rdoc</code> was in my <code>~&#47;.gemrc</code>"}], "tags": [], "owner": {"reputation": 114711, "user_id": 31582, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/17f2a7263e27c4c5a2093ea8d63389d4?s=128&d=identicon&r=PG", "display_name": "Gareth", "link": "https://stackoverflow.com/users/31582/gareth"}, "is_accepted": true, "score": 1, "last_activity_date": 1438120264, "creation_date": 1438120264, "answer_id": 31687753, "question_id": 31687623, "link": "https://stackoverflow.com/questions/31687623/where-is-the-ruby-documentation-for-gems/31687753#31687753", "title": "Where is the ruby documentation for gems?", "body": "<p>If you install the gem using <code>gem install --ri faraday</code> then the ri documentation will be generated for you.</p>\n\n<p>This should be the default, but since Ri doc generation can take a while, a lot of people disable it by putting a line in <code>~/.gemrc</code> saying <code>gem: --no-ri --no-rdoc</code> (providing those options as defaults for the gem command).</p>\n\n<p>Even if that's the case you can override it on a case by case basis by adding that parameter when you install a gem</p>\n"}, {"tags": [], "owner": {"reputation": 2560, "user_id": 5112122, "user_type": "registered", "profile_image": "https://graph.facebook.com/10206053108358704/picture?type=large", "display_name": "Horacio", "link": "https://stackoverflow.com/users/5112122/horacio"}, "is_accepted": false, "score": 1, "last_activity_date": 1438123318, "last_edit_date": 1438123318, "creation_date": 1438121688, "answer_id": 31688051, "question_id": 31687623, "link": "https://stackoverflow.com/questions/31687623/where-is-the-ruby-documentation-for-gems/31688051#31688051", "title": "Where is the ruby documentation for gems?", "body": "<p>If you want to read that doc, You'll are able to run </p>\n\n<pre><code>gem server\n</code></pre>\n\n<p>That will create a webservice in you host on port 8808, that you will be able to access via browser.</p>\n\n<p>If you want to see where that info is located, run <em>gem env</em> you'll see all  paths into GEM PATHS section.</p>\n\n<p>gem env</p>\n\n<pre><code>RubyGems Environment:\n.......2.2.2/etc\n  - RUBYGEMS PLATFORMS:\n    .....\n  - GEM PATHS:\n     - /home/hbranciforte/.rvm/gems/ruby-2.2.2\n     - /home/hbranciforte/.rvm/gems/ruby-2.2.2@global\n  - GEM CONFIGURATION:\n     .....\n  - REMOTE SOURCES:\n     - https://rubygems.org/\n  - SHELL PATH:\n.....\n</code></pre>\n\n<p>and if you look at your GEM PATHS you will find a folder called doc.</p>\n\n<pre><code>hbranciforte@hbranciforte-MacBookPro:gems/ruby-2.2.2 $ cd /home/hbranciforte/.rvm/gems/ruby-2.2.2\nhbranciforte@hbranciforte-MacBookPro:gems/ruby-2.2.2 $ ls\nbin  build_info  cache  doc  environment  extensions  gems  specifications  wrappers\n</code></pre>\n\n<p>Sometimes (almost I usually do) run your project with bundle --path bundle/vendor</p>\n\n<p>That creates a folder bundle/vendor where it will store your gems and doesn't store doc (that makes bundler much faster than gem install)</p>\n"}], "owner": {"reputation": 510, "user_id": 314721, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/d1e461ee329ac8b02c537ac72ca6e4e4?s=128&d=identicon&r=PG&f=1", "display_name": "Riina", "link": "https://stackoverflow.com/users/314721/riina"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 166, "favorite_count": 0, "closed_date": 1438149292, "accepted_answer_id": 31687753, "answer_count": 3, "score": 0, "last_activity_date": 1438123318, "creation_date": 1438119665, "question_id": 31687623, "link": "https://stackoverflow.com/questions/31687623/where-is-the-ruby-documentation-for-gems", "closed_reason": "Not suitable for this site", "title": "Where is the ruby documentation for gems?", "body": "<p>In python in an interactive console like ipython i can just type ? and get documentation on pretty much any library or function.</p>\n\n<p>How do I do this in ruby? Whether I'm using pry or irb I can't find much useful documentation at all.</p>\n\n<p>I'm trying to use Faraday but typing ri Faraday doesn't give any documentation. Typing ri String gives documentation for String, but gems like faraday don't produce any documentation whatsoever.</p>\n\n<p>What am I doing wrong?</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 36058, "user_id": 1157054, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5c9d0ecbe3045579b72f96744c62735c?s=128&d=identicon&r=PG", "display_name": "Ajedi32", "link": "https://stackoverflow.com/users/1157054/ajedi32"}, "edited": false, "score": 0, "creation_date": 1438119080, "post_id": 31687361, "comment_id": 51316682, "body": "According to <code>t1 &lt;=&gt; t2</code>, t1 is somehow greater than t2. No idea how..."}], "answers": [{"comments": [{"owner": {"reputation": 152, "user_id": 738271, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/95a3d1d01cb5d23c6363c2037f9743d6?s=128&d=identicon&r=PG", "display_name": "djboardman", "link": "https://stackoverflow.com/users/738271/djboardman"}, "edited": false, "score": 0, "creation_date": 1438151395, "post_id": 31687634, "comment_id": 51326274, "body": "I don&#39;t think I&#39;m getting a changed timezone - I&#39;m getting +00:00 all the way through."}, {"owner": {"reputation": 3377, "user_id": 3438405, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8bacfe7cf1712f9858bebaf738438718?s=128&d=identicon&r=PG&f=1", "display_name": "The F", "link": "https://stackoverflow.com/users/3438405/the-f"}, "reply_to_user": {"reputation": 152, "user_id": 738271, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/95a3d1d01cb5d23c6363c2037f9743d6?s=128&d=identicon&r=PG", "display_name": "djboardman", "link": "https://stackoverflow.com/users/738271/djboardman"}, "edited": false, "score": 0, "creation_date": 1438151761, "post_id": 31687634, "comment_id": 51326470, "body": "Try passing 0 seconds as an additional parameter to t2 so both time objects are built the same way, as I did above. The equal comparison will return true as expected."}, {"owner": {"reputation": 152, "user_id": 738271, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/95a3d1d01cb5d23c6363c2037f9743d6?s=128&d=identicon&r=PG", "display_name": "djboardman", "link": "https://stackoverflow.com/users/738271/djboardman"}, "edited": false, "score": 0, "creation_date": 1438538111, "post_id": 31687634, "comment_id": 51479936, "body": "It&#39;s intentional to pass 30.1 as I want have a time with fractional seconds -  the parameter after seconds isn&#39;t subseconds, it&#39;s timezone offset."}], "tags": [], "owner": {"reputation": 3377, "user_id": 3438405, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8bacfe7cf1712f9858bebaf738438718?s=128&d=identicon&r=PG&f=1", "display_name": "The F", "link": "https://stackoverflow.com/users/3438405/the-f"}, "is_accepted": false, "score": 0, "last_activity_date": 1438154869, "last_edit_date": 1438154869, "creation_date": 1438119705, "answer_id": 31687634, "question_id": 31687361, "link": "https://stackoverflow.com/questions/31687361/two-equal-time-objects-are-not-equal-according-to/31687634#31687634", "title": "Two equal Time objects are not equal according to ==", "body": "<p>You are using different parameters for your Time objects</p>\n\n<pre><code>#irb\nt = Time.new(2007,01,15,11,15,30,0.1)\n=&gt; 2007-01-15 11:15:30 +0000\nt1 = t2 + 30\n=&gt; 2007-01-15 11:16:00 +0000\n</code></pre>\n\n<p>if you do not pass the minutes, on my system the timezone seems to change:</p>\n\n<pre><code>t2 = Time.new(2007,01,15,11,16,0.1)\n=&gt; 2007-01-15 11:16:00 +0100 # what happened here? '+0100'\n\nt1 == t2\n=&gt; false\n</code></pre>\n\n<p>Even if that is <em>not the case</em> for the op, it is interesting that this happens in my irb.\nBuilding the objects like so <code>Time.utc(2007,01,15,11,15,30,0.1)</code>, using an explicit time zone, returned exactly the behaviour you described.</p>\n\n<p>However, if you pass the <em>same amount of parameters</em> (0 minutes for t2) the comparison will return the expected result as you will probably not even run into the floating point problem described by joanbm.</p>\n\n<pre><code>t = Time.new(2007,01,15,11,15,30,0.1)\n=&gt; 2007-01-15 11:15:30 +0000 \n\nt1 = t + 30\n=&gt; 2007-01-15 11:16:00 +0000 \n\nt2 = Time.new(2007,01,15,11,16,0,0.1)\n=&gt; 2007-01-15 11:16:00 +0000 \n\nt1 == t2\n=&gt; true\n</code></pre>\n\n<p>If you print the times rational form you get:</p>\n\n<pre><code>t1.to_r\n=&gt; (42112611033072059383231283/36028797018963968) \nt2.to_r\n=&gt; (42112611033072059383231283/36028797018963968) \n</code></pre>\n\n<p>As <code>to_r</code> returns the time in seconds since the <a href=\"https://en.wikipedia.org/wiki/Epoch_%28reference_date%29\" rel=\"nofollow\">epoch</a> (or Unix Time), there is no reason for t1 and t2 not to be equal, as long as date, time and time zone match.</p>\n\n<p>Unfortunately I can not give a good explenation why this is the case.\nThis seems interesting though and I will come back when I find a reason for this behaviour.</p>\n\n<p><strong>Edit</strong></p>\n\n<p>This does not explain the timezone change, hence does not explain the problem, but your are missing a comma for <code>t</code> so you're actually passing 30.1 instead of 30 seconds. </p>\n\n<pre><code>t = Time.new(2007,01,15,11,15,30.1)\n</code></pre>\n\n<p>It probably should be</p>\n\n<pre><code>t = Time.new(2007,01,15,11,15,30,0.1)\n</code></pre>\n\n<p>However this does not cause your comparison to fail.</p>\n"}, {"comments": [{"owner": {"reputation": 3377, "user_id": 3438405, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8bacfe7cf1712f9858bebaf738438718?s=128&d=identicon&r=PG&f=1", "display_name": "The F", "link": "https://stackoverflow.com/users/3438405/the-f"}, "edited": false, "score": 1, "creation_date": 1438120448, "post_id": 31687656, "comment_id": 51317286, "body": "Actually timestamps are a common a source for mistakes when compared, especially using the <code>==</code> operator. t1 and t2 can and should be identical objects when built the same way. Somehow ruby seems to change the time zone, with the given parameters."}, {"owner": {"reputation": 6606, "user_id": 1586762, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/fb7415aea80a8fa64f7427086eedb6ee?s=128&d=identicon&r=PG", "display_name": "Vitalii Elenhaupt", "link": "https://stackoverflow.com/users/1586762/vitalii-elenhaupt"}, "reply_to_user": {"reputation": 3377, "user_id": 3438405, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8bacfe7cf1712f9858bebaf738438718?s=128&d=identicon&r=PG&f=1", "display_name": "The F", "link": "https://stackoverflow.com/users/3438405/the-f"}, "edited": false, "score": 0, "creation_date": 1438152408, "post_id": 31687656, "comment_id": 51326876, "body": "OPs timezone is the same for <code>t1</code> and <code>t2</code> (<code>+0000</code>)"}], "tags": [], "owner": {"reputation": 6606, "user_id": 1586762, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/fb7415aea80a8fa64f7427086eedb6ee?s=128&d=identicon&r=PG", "display_name": "Vitalii Elenhaupt", "link": "https://stackoverflow.com/users/1586762/vitalii-elenhaupt"}, "is_accepted": false, "score": 0, "last_activity_date": 1438119820, "creation_date": 1438119820, "answer_id": 31687656, "question_id": 31687361, "link": "https://stackoverflow.com/questions/31687361/two-equal-time-objects-are-not-equal-according-to/31687656#31687656", "title": "Two equal Time objects are not equal according to ==", "body": "<p>That happens because both times are still different. Here is a good illustration with <a href=\"http://ruby-doc.org/core/Time.html#method-i-to_r\" rel=\"nofollow\">Time#to_r</a>:</p>\n\n<pre><code>&gt;&gt; t1.to_r #=&gt; (164501373566169071275213/140737488355328)\n&gt;&gt; t2.to_r #=&gt; (42112351632939282246454477/36028797018963968)\n</code></pre>\n\n<p>If you don\u2019t care about milliseconds, you may compare timestamps using <code>to_i</code> method:</p>\n\n<pre><code>&gt;&gt; t1.to_i == t2.to_i # =&gt; true\n</code></pre>\n\n<p>or make a new <code>Time</code> object from timestamps:</p>\n\n<pre><code>&gt;&gt; Time.at(t1.to_i) == Time.at(t2.to_i) # =&gt; true\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 152, "user_id": 738271, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/95a3d1d01cb5d23c6363c2037f9743d6?s=128&d=identicon&r=PG", "display_name": "djboardman", "link": "https://stackoverflow.com/users/738271/djboardman"}, "edited": false, "score": 0, "creation_date": 1438152405, "post_id": 31689387, "comment_id": 51326872, "body": "Thanks, makes sense. My only question about you answer is that you say &quot;give both objects floating point numbers as UTC offsets&quot; but the 5th param in <code>Time.new</code> is seconds I think?"}], "tags": [], "owner": {"reputation": 633, "user_id": 5107759, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/33e659c0770221780a6fd21960909b6d?s=128&d=identicon&r=PG", "display_name": "joanbm", "link": "https://stackoverflow.com/users/5107759/joanbm"}, "is_accepted": false, "score": 4, "last_activity_date": 1438165590, "last_edit_date": 1438165590, "creation_date": 1438130098, "answer_id": 31689387, "question_id": 31687361, "link": "https://stackoverflow.com/questions/31687361/two-equal-time-objects-are-not-equal-according-to/31689387#31689387", "title": "Two equal Time objects are not equal according to ==", "body": "<p>This is the <a href=\"http://floating-point-gui.de/\" rel=\"nofollow\">notorious</a> problem with inaccurate representation of floating point numbers in computers, quite unrelated to Ruby or Time class implementation.</p>\n\n<p>You give to both objects floating numbers as seconds argument, and its (inaccurate) fractional part constructor stores as a rational number for its internal representation:</p>\n\n<pre><code>t = Time.new(2007,01,15,11,15,30.1)\nt.subsec    # (14073748835533/140737488355328)  &lt;- may vary on your system\nt.subsec.to_f    # 0.10000000000000142  &lt;- this is not equal to 0.1 !!\n</code></pre>\n\n<p>dtto for the 2nd time:</p>\n\n<pre><code>t2 = Time.new(2007,01,15,11,16,0.1)\nt2.subsec    # (3602879701896397/36028797018963968)\nt2.subsec.to_f  # 0.1 &lt;- there accidentally precision didn't get lost\n</code></pre>\n\n<p>Just use exact numerical types like <code>Rational</code> and you are done:</p>\n\n<pre><code>t = Time.new(2007,01,15,11,15,Rational('30.1'))\nt1 = t + 30\n\nt2=Time.new(2007,01,15,11,16,0.1r)  # alternate notation, see docs\n\nt1 == t2    # true\n</code></pre>\n\n<p>Or do a rough comparison with <code>Time#round</code> method applied on both sides.</p>\n"}], "owner": {"reputation": 152, "user_id": 738271, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/95a3d1d01cb5d23c6363c2037f9743d6?s=128&d=identicon&r=PG", "display_name": "djboardman", "link": "https://stackoverflow.com/users/738271/djboardman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 296, "favorite_count": 1, "answer_count": 3, "score": 5, "last_activity_date": 1438537815, "creation_date": 1438118581, "last_edit_date": 1438537815, "question_id": 31687361, "link": "https://stackoverflow.com/questions/31687361/two-equal-time-objects-are-not-equal-according-to", "title": "Two equal Time objects are not equal according to ==", "body": "<p>I've found some behaviour of <code>Time</code> in Ruby that I don't understand while writing some tests. Am I missing something or is this a genuine problem?</p>\n\n<p>I can reproduce the situation in irb as follows - first create a <code>Time</code> and add 30 seconds to it:</p>\n\n<pre><code>t = Time.new(2007,01,15,11,15,30.1)\n# =&gt; 2007-01-15 11:15:30 +0000 \nt1 = t + 30\n# =&gt; 2007-01-15 11:16:00 +0000 \n</code></pre>\n\n<p>Then create another time which should be equal to <code>t1</code>:</p>\n\n<pre><code>t2 = Time.new(2007,01,15,11,16,0.1)\n# =&gt; 2007-01-15 11:16:00 +0000\n</code></pre>\n\n<p>Now I'd expect <code>t1</code> and <code>t2</code> to be equal, but they aren't according to <code>==</code>. From the rough experiments I've done it seems like <code>==</code> works, except when the addition of seconds moves <code>t1</code> onto a new minute:</p>\n\n<pre><code>t1 == t2\n# =&gt; false \n</code></pre>\n\n<p>However if you call <code>to_f</code> on them then <code>==</code> does return <code>true</code>:</p>\n\n<pre><code>t1.to_f == t2.to_f\n# =&gt; true\n</code></pre>\n\n<p>Just to confirm that there aren't any nano seconds hanging around:</p>\n\n<pre><code>t1.nsec\n# =&gt; 100000000 \nt2.nsec\n# =&gt; 100000000\n</code></pre>\n\n<p>=== Added after answers from joanbm and Vitalii Elenhaupt (sorry to open this up again)</p>\n\n<p>joanbm and Vitalii Elenhaupt point out that <code>t1.to_r</code> and <code>t2.to_r</code> produce different results. </p>\n\n<p>But... according to the <a href=\"http://ruby-doc.org/core-2.2.0/Time.html\" rel=\"nofollow\">Ruby-Doc</a> <code>Time</code> within the normal range is stored as a 63 bit integer of the number of nano seconds since the epoch - which suggests that float-point issues shouldn't come into it.</p>\n\n<p>So... why if Time is stored as an integer, and <code>#to_f</code> and <code>#nsec</code> can produce the same result to 9 decimal places, can't <code>==</code> use this info to recognize the two times as equal? (Maybe Ruby uses <code>#to_r</code> in the equality test?).</p>\n\n<p>And... is it safe to assume that <code>t1.to_f == t2.to_f</code> will always give an accurate test of equality to 9 decimal places and is that the best way to compare <code>Time</code> objects?</p>\n"}, {"tags": ["ruby", "routing", "sinatra"], "comments": [{"owner": {"reputation": 1756, "user_id": 295671, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/0fc94068a4be0dd57d34a223722f2690?s=128&d=identicon&r=PG", "display_name": "james246", "link": "https://stackoverflow.com/users/295671/james246"}, "edited": false, "score": 0, "creation_date": 1438118826, "post_id": 31687164, "comment_id": 51316562, "body": "Does <code>redirect &#39;&#47;chat&#39;</code> yield the same result?"}, {"owner": {"reputation": 1756, "user_id": 295671, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/0fc94068a4be0dd57d34a223722f2690?s=128&d=identicon&r=PG", "display_name": "james246", "link": "https://stackoverflow.com/users/295671/james246"}, "edited": false, "score": 0, "creation_date": 1438119048, "post_id": 31687164, "comment_id": 51316668, "body": "Could you post any output you&#39;re getting from Sinatra in your terminal?"}, {"owner": {"reputation": 1297, "user_id": 5042431, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8VZqF.jpg?s=128&g=1", "display_name": "Charles", "link": "https://stackoverflow.com/users/5042431/charles"}, "edited": false, "score": 1, "creation_date": 1438119194, "post_id": 31687164, "comment_id": 51316726, "body": "Why not make your static pages <code>.html.erb</code> and stick them in the views folder? It works the same, since erb is basically html that you can put ruby in. Then you can do <code>erb :chat</code> instead of working with Files."}, {"owner": {"reputation": 4018, "user_id": 135673, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/42ee5885ec2ae8f7834b716a3a2b57c2?s=128&d=identicon&r=PG", "display_name": "froderik", "link": "https://stackoverflow.com/users/135673/froderik"}, "edited": false, "score": 0, "creation_date": 1438246709, "post_id": 31687164, "comment_id": 51375518, "body": "What are you using sinatra for if you only have static HTML?"}, {"owner": {"reputation": 667, "user_id": 3183046, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/b1hgB.jpg?s=128&g=1", "display_name": "Phobos", "link": "https://stackoverflow.com/users/3183046/phobos"}, "edited": false, "score": 0, "creation_date": 1438578741, "post_id": 31687164, "comment_id": 51489341, "body": "From what I&#39;m reading it seems that you&#39;re if statement is returning &quot;false&quot; and going into the else portion, skipping your redirect command."}], "owner": {"reputation": 86, "user_id": 2546500, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000532693370/picture?type=large", "display_name": "Martin Hristov", "link": "https://stackoverflow.com/users/2546500/martin-hristov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 247, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1438117861, "creation_date": 1438117861, "question_id": 31687164, "link": "https://stackoverflow.com/questions/31687164/sinatra-redirect-with-static-html-files", "title": "Sinatra redirect with static html files", "body": "<p>Ruby is new for me and I have a lame question.</p>\n\n<p>I am serving web app with Sinatra and I am using static html files for front-end part.</p>\n\n<p>Project structure:</p>\n\n<ul>\n<li>Project\n\n<ul>\n<li>models</li>\n<li>routes</li>\n<li>public\n\n<ul>\n<li>index.html</li>\n<li>chat.html</li>\n</ul></li>\n<li>app.rb</li>\n</ul></li>\n</ul>\n\n<p>And I want to call redirect to chat.html when user is logged in the index.html</p>\n\n<p>At the moment here is what I have:</p>\n\n<pre><code>   # some login stuff\n   if first_user_found  &amp;&amp; is_password_correct\n     redirect to '/chat'\n   else\n     #do another thing\n   end\n</code></pre>\n\n<p>and for for the /chat</p>\n\n<pre><code>get '/chat' do\n  File.read('public/chat.html')\nend\n</code></pre>\n\n<p>When I call localhost:4567/chat it load chat.html,\nbut when I try to login in the network tab /chat is called but no redirection is performed.</p>\n\n<p>Could you please help?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "json", "serialization", "delayed-job"], "answers": [{"comments": [{"owner": {"reputation": 605, "user_id": 1398515, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/5e66c923725405358c56acb9ab4f93a2?s=128&d=identicon&r=PG", "display_name": "Datt", "link": "https://stackoverflow.com/users/1398515/datt"}, "edited": false, "score": 0, "creation_date": 1438160445, "post_id": 31689354, "comment_id": 51331663, "body": "I had tried that as well, but still returning in <code>2015-07-21 16:01:33 UTC</code> this format only"}], "tags": [], "owner": {"reputation": 5250, "user_id": 5154683, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eae81933dce5ced9ec019414bbd4f0f4?s=128&d=identicon&r=PG&f=1", "display_name": "Robert Nubel", "link": "https://stackoverflow.com/users/5154683/robert-nubel"}, "is_accepted": false, "score": 0, "last_activity_date": 1438129840, "last_edit_date": 1495541173, "creation_date": 1438129840, "answer_id": 31689354, "question_id": 31687040, "link": "https://stackoverflow.com/questions/31687040/changing-datetime-formatting-while-deserilizing-in-rails-4/31689354#31689354", "title": "Changing datetime formatting while deserilizing in rails 4", "body": "<p>Overriding <code>to_json</code> only changes the behavior when the TimeWithZone instance is serialized into JSON; however, as you've perhaps noticed, DelayedJob serializes into YAML. You can just tell Rails to use a default date/time format everywhere, though, with the methods from <a href=\"https://stackoverflow.com/questions/17870762/changing-the-default-date-and-time-format-in-rails-4\">this thread</a>. For example, add a file named <code>config/initializers/datetime.rb</code> with the contents:</p>\n\n<pre><code>Time::DATE_FORMATS[:default] = \"%Y-%m-%d %H:%M:%S %z\" \n</code></pre>\n\n<p>Which will override the default format for every time a Time is converted to a string.</p>\n"}, {"tags": [], "owner": {"reputation": 605, "user_id": 1398515, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/5e66c923725405358c56acb9ab4f93a2?s=128&d=identicon&r=PG", "display_name": "Datt", "link": "https://stackoverflow.com/users/1398515/datt"}, "is_accepted": true, "score": 1, "last_activity_date": 1438165293, "creation_date": 1438165293, "answer_id": 31697715, "question_id": 31687040, "link": "https://stackoverflow.com/questions/31687040/changing-datetime-formatting-while-deserilizing-in-rails-4/31697715#31697715", "title": "Changing datetime formatting while deserilizing in rails 4", "body": "<p>I have solved this problem by overriding <code>TimeZoneCOnverter</code>.</p>\n\n<pre><code>module ActiveRecord\n  module AttributeMethods\n    module TimeZoneConversion\n      class TimeZoneConverter\n        def convert_time_to_time_zone(value)\n          if value.is_a?(Array)\n            value.map { |v| convert_time_to_time_zone(v) }\n          elsif value.acts_like?(:time)\n            # changed from value.in_time_zone to\n            value.to_time\n          else\n            value\n          end\n        end\n      end\n    end\n  end\nend\n</code></pre>\n\n<p><code>delayed_job</code> serializes the object's attributes by saving it's <code>type</code> and <code>value</code> \nfor time zone object type is <code>ActiveRecord::AttributeMethods::TimeZoneConversion::TimeZoneConverter</code> whose <code>deserialize</code> method calls <code>convert_time_to_time_zone(value)</code>, by overriding it I got format that I wanted.</p>\n"}, {"tags": [], "owner": {"reputation": 150, "user_id": 4479867, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-GHSihrH3XIY/AAAAAAAAAAI/AAAAAAAAAdM/fRqyZXDrXCs/photo.jpg?sz=128", "display_name": "Vitya Ivliiev", "link": "https://stackoverflow.com/users/4479867/vitya-ivliiev"}, "is_accepted": false, "score": 0, "last_activity_date": 1557129640, "creation_date": 1557129640, "answer_id": 56001064, "question_id": 31687040, "link": "https://stackoverflow.com/questions/31687040/changing-datetime-formatting-while-deserilizing-in-rails-4/56001064#56001064", "title": "Changing datetime formatting while deserilizing in rails 4", "body": "<p>The problem stems from an inconsistent overriding of as_json that only applies to instances of TimeWithZone but does not effect the as_json monkey patching of Time, Date, and DateTime.</p>\n\n<p>My tmp fix:</p>\n\n<pre><code># config/initializers/time_with_zone.rb\n\nmodule ActiveSupport\n  class TimeWithZone\n    def as_json(options = nil)\n      iso8601\n    end\n  end\nend\n</code></pre>\n"}], "owner": {"reputation": 605, "user_id": 1398515, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/5e66c923725405358c56acb9ab4f93a2?s=128&d=identicon&r=PG", "display_name": "Datt", "link": "https://stackoverflow.com/users/1398515/datt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1015, "favorite_count": 0, "accepted_answer_id": 31697715, "answer_count": 3, "score": 1, "last_activity_date": 1557129640, "creation_date": 1438117449, "last_edit_date": 1438164735, "question_id": 31687040, "link": "https://stackoverflow.com/questions/31687040/changing-datetime-formatting-while-deserilizing-in-rails-4", "title": "Changing datetime formatting while deserilizing in rails 4", "body": "<p>I'm using <code>rails 4</code>. I need to have a global datetime format to be set as <code>\"%Y-%m-%d %H:%M:%S %z\"</code> i.e. <code>2015-07-29 02:34:38 +0530</code>.\nI tried to override as_json method which works but when I'm using it with <code>delayed_job</code>, It's serializing object which converts datetime field into <code>2015-07-29 02:34:38 UTC</code>. </p>\n\n<pre><code>class ActiveSupport::TimeWithZone\n  def as_json(options = {})\n    strftime('%Y-%m-%d %H:%M:%S %z')\n  end\nend\n</code></pre>\n\n<p>Will it work if <code>serializable_hash</code> method overriden globally? If yes, how can I?</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 2, "creation_date": 1438116013, "post_id": 31686454, "comment_id": 51315082, "body": "why not <code>stuff = (ten_things.split(&#39; &#39;) + [&quot;Day&quot;, &quot;Night&quot;, &quot;Song&quot;, &quot;Frisbee&quot;, &quot;Corn&quot;, &quot;Banana&quot;, &quot;Girl&quot;, &quot;Boy&quot;]).first(10)</code> No loop needed at all. Obviously I have no idea what the rest of the code looks like."}, {"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 0, "creation_date": 1438117500, "post_id": 31686454, "comment_id": 51315905, "body": "This looks like an <a href=\"http://meta.stackexchange.com/questions/66377/what-is-the-xy-problem\">XY problem</a>. Why don&#39;t you tell us what you&#39;re trying to do overall, instead of asking us how to pop from one array and push onto another?"}, {"owner": {"reputation": 261375, "user_id": 174728, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/eRO75.jpg?s=128&g=1", "display_name": "John La Rooy", "link": "https://stackoverflow.com/users/174728/john-la-rooy"}, "edited": false, "score": 0, "creation_date": 1438117695, "post_id": 31686454, "comment_id": 51316009, "body": "Looks contrived - like a homework type question."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1438709265, "post_id": 31686454, "comment_id": 51556737, "body": "@engneersmnky, just because."}], "answers": [{"comments": [{"owner": {"reputation": 1297, "user_id": 5042431, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8VZqF.jpg?s=128&g=1", "display_name": "Charles", "link": "https://stackoverflow.com/users/5042431/charles"}, "reply_to_user": {"reputation": 91121, "user_id": 179125, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5594142dcc49a24b1902ec8059181f8d?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan Running", "link": "https://stackoverflow.com/users/179125/jordan-running"}, "edited": false, "score": 0, "creation_date": 1438116289, "post_id": 31686599, "comment_id": 51315213, "body": "Went ahead and wrote it with <code>for</code> just because."}, {"owner": {"reputation": 18773, "user_id": 91830, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2505b282d57c29be797dc35b245adb4c?s=128&d=identicon&r=PG", "display_name": "Philip Hallstrom", "link": "https://stackoverflow.com/users/91830/philip-hallstrom"}, "edited": false, "score": 0, "creation_date": 1438116305, "post_id": 31686599, "comment_id": 51315220, "body": "As long as you change that condition so it will exit if <code>more_stuff</code> is less than 10.  Otherwise that loop will never end."}, {"owner": {"reputation": 1297, "user_id": 5042431, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8VZqF.jpg?s=128&g=1", "display_name": "Charles", "link": "https://stackoverflow.com/users/5042431/charles"}, "edited": false, "score": 0, "creation_date": 1438116476, "post_id": 31686599, "comment_id": 51315331, "body": "It will, because it goes on a range from <code>stuff.length</code> to 10. Range does the job of a condition."}, {"owner": {"reputation": 18773, "user_id": 91830, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2505b282d57c29be797dc35b245adb4c?s=128&d=identicon&r=PG", "display_name": "Philip Hallstrom", "link": "https://stackoverflow.com/users/91830/philip-hallstrom"}, "reply_to_user": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1438116544, "post_id": 31686599, "comment_id": 51315370, "body": "@engineersmnky Sorry, I replied before he added the for loop and was referring to OP&#39;s original while loop."}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "reply_to_user": {"reputation": 18773, "user_id": 91830, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2505b282d57c29be797dc35b245adb4c?s=128&d=identicon&r=PG", "display_name": "Philip Hallstrom", "link": "https://stackoverflow.com/users/91830/philip-hallstrom"}, "edited": false, "score": 1, "creation_date": 1438116623, "post_id": 31686599, "comment_id": 51315422, "body": "@PhilipHallstrom understood comment removed. Looping still doesn&#39;t make sense to me in this case when we can just combine the arrays and take the first 10 items"}, {"owner": {"reputation": 18773, "user_id": 91830, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2505b282d57c29be797dc35b245adb4c?s=128&d=identicon&r=PG", "display_name": "Philip Hallstrom", "link": "https://stackoverflow.com/users/91830/philip-hallstrom"}, "reply_to_user": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1438116664, "post_id": 31686599, "comment_id": 51315441, "body": "@engineersmnky Agreed."}, {"owner": {"reputation": 1297, "user_id": 5042431, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8VZqF.jpg?s=128&g=1", "display_name": "Charles", "link": "https://stackoverflow.com/users/5042431/charles"}, "reply_to_user": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1438116677, "post_id": 31686599, "comment_id": 51315450, "body": "@engineersmnky yeah your way is better. Typical ruby with so many ways to do something."}], "tags": [], "owner": {"reputation": 1297, "user_id": 5042431, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8VZqF.jpg?s=128&g=1", "display_name": "Charles", "link": "https://stackoverflow.com/users/5042431/charles"}, "is_accepted": true, "score": 2, "last_activity_date": 1438116265, "last_edit_date": 1438116265, "creation_date": 1438115852, "answer_id": 31686599, "question_id": 31686454, "link": "https://stackoverflow.com/questions/31686454/how-do-i-convert-this-from-a-while-loop-into-a-for-loop/31686599#31686599", "title": "How do I convert this from a while loop into a for loop?", "body": "<p>I don't see why you would bother making it a <code>for</code> loop when a <code>while</code> or <code>until</code> loop is meant for it.</p>\n\n<p>However, this will work:</p>\n\n<pre><code>ten_things = \"Apples Oranges Crows Telephone Light Sugar\"\n\nputs \"Wait there are not 10 things in that list. Let's fix that.\"\n\nstuff = ten_things.split(' ')\nmore_stuff = [\"Day\", \"Night\", \"Song\", \"Frisbee\", \"Corn\", \"Banana\", \"Girl\", \"Boy\"]\n\n# using math to make sure there's 10 items\ni = stuff.length\nfor i in i...10\n    next_one = more_stuff.pop\n    puts \"Adding: #{next_one}\"\n    stuff.push(next_one)\n    puts \"There are #{stuff.length} items now.\"\nend\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 303, "user_id": 2628709, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ijfRG.jpg?s=128&g=1", "display_name": "pdcoxhead", "link": "https://stackoverflow.com/users/2628709/pdcoxhead"}, "is_accepted": false, "score": 2, "last_activity_date": 1438116380, "creation_date": 1438116380, "answer_id": 31686734, "question_id": 31686454, "link": "https://stackoverflow.com/questions/31686454/how-do-i-convert-this-from-a-while-loop-into-a-for-loop/31686734#31686734", "title": "How do I convert this from a while loop into a for loop?", "body": "<p>You can use</p>\n\n<pre><code>array_name.each { |item|\n    break if stuff.length &gt; 10\n    stuff.push(item)\n}\n</code></pre>\n"}], "owner": {"reputation": 15, "user_id": 4416093, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90bed092e34de814485b34ffebe8d444?s=128&d=identicon&r=PG&f=1", "display_name": "Puneet", "link": "https://stackoverflow.com/users/4416093/puneet"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 51, "favorite_count": 0, "accepted_answer_id": 31686599, "answer_count": 2, "score": -1, "last_activity_date": 1438116380, "creation_date": 1438115377, "last_edit_date": 1438116036, "question_id": 31686454, "link": "https://stackoverflow.com/questions/31686454/how-do-i-convert-this-from-a-while-loop-into-a-for-loop", "title": "How do I convert this from a while loop into a for loop?", "body": "<p>How would I make this <code>while</code> loop into a <code>for</code> loop?</p>\n\n<pre><code>ten_things = \"Apples Oranges Crows Telephone Light Sugar\"\nstuff = ten_things.split(' ')\nputs \"Wait there are not 10 things in that list. Let's fix that.\"\nmore_stuff = [\"Day\", \"Night\", \"Song\", \"Frisbee\", \"Corn\", \"Banana\", \"Girl\", \"Boy\"]\nwhile stuff.length != 10\n  next_one = more_stuff.pop\n  puts \"Adding: #{next_one}\"\n  stuff.push(next_one)\n  puts \"There are #{stuff.length} items now.\"\nend\n</code></pre>\n\n<p>I tried and got an infinite loop </p>\n"}, {"tags": ["ruby-on-rails", "ruby", "sorting", "jquery-ui-sortable", "reindex"], "comments": [{"owner": {"reputation": 45754, "user_id": 17410, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1022b779bdc1ddef7cd9d29abd70ed15?s=128&d=identicon&r=PG", "display_name": "zetetic", "link": "https://stackoverflow.com/users/17410/zetetic"}, "edited": false, "score": 0, "creation_date": 1438128033, "post_id": 31686430, "comment_id": 51319906, "body": "Why do you need to &quot;reindex&quot; the list at all? Why not retrieve it with an order clause?"}, {"owner": {"reputation": 53, "user_id": 535729, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/xabJK.jpg?s=128&g=1", "display_name": "Ian", "link": "https://stackoverflow.com/users/535729/ian"}, "reply_to_user": {"reputation": 45754, "user_id": 17410, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1022b779bdc1ddef7cd9d29abd70ed15?s=128&d=identicon&r=PG", "display_name": "zetetic", "link": "https://stackoverflow.com/users/17410/zetetic"}, "edited": false, "score": 0, "creation_date": 1438185824, "post_id": 31686430, "comment_id": 51349655, "body": "From a technical perspective I don&#39;t have to reindex it.  In the views I am retriving it with an order clause.  However, the user is able to see and edit the order numbers, so if the first item has order 1 and the second has order 23 and the third has number 55, then that might be confusing to some users."}, {"owner": {"reputation": 45754, "user_id": 17410, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1022b779bdc1ddef7cd9d29abd70ed15?s=128&d=identicon&r=PG", "display_name": "zetetic", "link": "https://stackoverflow.com/users/17410/zetetic"}, "edited": false, "score": 0, "creation_date": 1438193570, "post_id": 31686430, "comment_id": 51354329, "body": "Sorry I misunderstood. It seems to me that you don&#39;t actually need to display the actual position of an item, only its <i>relative</i> position. Perhaps you could have the view generate the sequence itself using <code>each_with_index</code>?"}], "owner": {"reputation": 53, "user_id": 535729, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/xabJK.jpg?s=128&g=1", "display_name": "Ian", "link": "https://stackoverflow.com/users/535729/ian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 37, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1438118621, "creation_date": 1438115317, "last_edit_date": 1438118621, "question_id": 31686430, "link": "https://stackoverflow.com/questions/31686430/best-way-to-reindex-objects-in-ruby-after-jquery-sortable", "title": "Best way to reindex objects in Ruby after jQuery.sortable()", "body": "<p>I have objects with a 'position' defined. I 'm moving one object (using jQuery Sortable), then I need to reindex the position of each object in that list (I want to keep them in order 0,1,2...n)</p>\n\n<p>Basically we have a ProductLine model that contains Products (using <a href=\"https://github.com/swanandp/acts_as_list\" rel=\"nofollow\">act_as_list</a> for convinience). </p>\n\n<p>First, swap the position of the previous object and the new object (the one we just dropped here):</p>\n\n<pre><code>def sort\n  @product = Product.find(params[:id])\n  if(params.has_key?(:next_id))\n    @next_product = Product.find(params[:next_id])\n  end\n  if(params.has_key?(:prev_id))\n    @prev_product = Product.find(params[:prev_id])\n  end\n\n  if @prev_product.blank?\n    @product.move_to_top\n  elsif @next_product.blank?\n    @product.move_to_bottom\n  else\n    @product.insert_at(@prev_product.position)\n  end\n\n  @product.save\n\n  reindex @product.product_line_id\n\n  render json: @products\nend\n</code></pre>\n\n<p>This is the reindex function that ensures they are sequential:</p>\n\n<pre><code>def reindex(product_line_id)\n  @products = Product.where(product_line_id: product_line_id).order(position: :asc)\n  @products.each_with_index { |p, index|\n    p.position = index\n    p.save\n  }\nend\n</code></pre>\n\n<p>I'm quite new to the Ruby language and I'm sure there are several cleaner, more efficent ways of doing this?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "postgresql"], "answers": [{"comments": [{"owner": {"reputation": 361, "user_id": 1215326, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/afbbc453894bf7e67db943700c592e89?s=128&d=identicon&r=PG", "display_name": "Rodney Wilson", "link": "https://stackoverflow.com/users/1215326/rodney-wilson"}, "edited": false, "score": 0, "creation_date": 1440449636, "post_id": 31686456, "comment_id": 52268224, "body": "Thank you for the reply. I&#39;m okay with not having the data but from here, do I need to do anything else to restore the DB?"}], "tags": [], "owner": {"reputation": 18773, "user_id": 91830, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2505b282d57c29be797dc35b245adb4c?s=128&d=identicon&r=PG", "display_name": "Philip Hallstrom", "link": "https://stackoverflow.com/users/91830/philip-hallstrom"}, "is_accepted": false, "score": 0, "last_activity_date": 1438115378, "creation_date": 1438115378, "answer_id": 31686456, "question_id": 31686424, "link": "https://stackoverflow.com/questions/31686424/rebuild-lost-database-in-ruby-on-rails-app/31686456#31686456", "title": "Rebuild lost database in Ruby on Rails app", "body": "<p><code>rake db:migrate</code> should give you back the table schema, but you don't get any of the data.</p>\n"}], "owner": {"reputation": 361, "user_id": 1215326, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/afbbc453894bf7e67db943700c592e89?s=128&d=identicon&r=PG", "display_name": "Rodney Wilson", "link": "https://stackoverflow.com/users/1215326/rodney-wilson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 73, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1438115378, "creation_date": 1438115289, "question_id": 31686424, "link": "https://stackoverflow.com/questions/31686424/rebuild-lost-database-in-ruby-on-rails-app", "title": "Rebuild lost database in Ruby on Rails app", "body": "<p>I have an existing ruby on rails app that was on a VPS. I pulled the app off the VPS but never got the database data backed up. I was looking through the source code and see that there is no <code>schema.rb</code> file but I do have all the migration files.</p>\n\n<p>My question is, will there be a way to rebuild the entire database the way it was before?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "exception-handling", "nullpointerexception", "rubygems"], "comments": [{"owner": {"reputation": 409, "user_id": 604624, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/05a3dc95a4a879a50b78376ee0a33717?s=128&d=identicon&r=PG", "display_name": "Justin Turner", "link": "https://stackoverflow.com/users/604624/justin-turner"}, "edited": false, "score": 0, "creation_date": 1438115030, "post_id": 31686298, "comment_id": 51314479, "body": "You should escape your query parameters."}, {"owner": {"reputation": 5713, "user_id": 846163, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/623857ee8390f91edba65fcac0d152ab?s=128&d=identicon&r=PG", "display_name": "sschmeck", "link": "https://stackoverflow.com/users/846163/sschmeck"}, "edited": false, "score": 1, "creation_date": 1438115503, "post_id": 31686298, "comment_id": 51314765, "body": "If you take the error flow you should wrap the <code>row[field]</code> expression. See e.g. <a href=\"http://phrogz.net/programmingruby/tut_exceptions.html\" rel=\"nofollow noreferrer\">phrogz.net/programmingruby/tut_exceptions.html</a>"}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1438117284, "post_id": 31686298, "comment_id": 51315800, "body": "why not just make sure to return an enumerable object (that is an object that responds to each) then there is no concern. Also right now if there are multiple rows you will only get the first one which seems wrong too but I am not sure what you are attempting to do."}], "answers": [{"tags": [], "owner": {"reputation": 633, "user_id": 5107759, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/33e659c0770221780a6fd21960909b6d?s=128&d=identicon&r=PG", "display_name": "joanbm", "link": "https://stackoverflow.com/users/5107759/joanbm"}, "is_accepted": false, "score": 0, "last_activity_date": 1438116560, "creation_date": 1438116560, "answer_id": 31686790, "question_id": 31686298, "link": "https://stackoverflow.com/questions/31686298/ruby-raise-exception-on-iterator/31686790#31686790", "title": "ruby raise exception on iterator", "body": "<p>You are passing a block to <code>Enumerator#each</code> which introduces a new scope, so you need to put <code>begin</code> as a start of exception block inside.</p>\n\n<p>If you also need handle exceptions of <code>@@connection.query</code>, just put <code>rescue</code> after <code>do-end</code> block of .each. <code>begin</code> is implicit at start of method's body.</p>\n"}, {"tags": [], "owner": {"reputation": 924, "user_id": 5156200, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/9532c8dc80ba03725a07b502ebef5af5?s=128&d=identicon&r=PG&f=1", "display_name": "Bruno E.", "link": "https://stackoverflow.com/users/5156200/bruno-e"}, "is_accepted": false, "score": 0, "last_activity_date": 1438117215, "last_edit_date": 1495535061, "creation_date": 1438117215, "answer_id": 31686982, "question_id": 31686298, "link": "https://stackoverflow.com/questions/31686298/ruby-raise-exception-on-iterator/31686982#31686982", "title": "ruby raise exception on iterator", "body": "<p>First, rescuing from Exception is always a bad idea, see <a href=\"https://stackoverflow.com/questions/10048173/why-is-it-bad-style-to-rescue-exception-e-in-ruby\">Why is it a bad style to `rescue Exception =&gt; e` in Ruby?</a> for details.</p>\n\n<p>Second a begin rescue block always has to have a closing end, else is only possible after an if before</p>\n\n<pre><code>begin\n  # ...\nrescue StandardError =&gt; e \n  # ...\nend\n</code></pre>\n\n<p>Third as already said by Justin Turner in the comment, just passing a value to the DB like that makes it prone to SQL injections. Is there any reason you don't use ActiveRecord but want direct DB access?</p>\n\n<p>Overall there are so many issues with this short piece of code, I would suggest to read <a href=\"http://guides.rubyonrails.org/\" rel=\"nofollow noreferrer\">http://guides.rubyonrails.org/</a> to better understand what is going on.</p>\n"}], "owner": {"reputation": 11, "user_id": 2809188, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ac6ce4acdb64a9a978f6ccf7c2b783b4?s=128&d=identicon&r=PG&f=1", "display_name": "Raj", "link": "https://stackoverflow.com/users/2809188/raj"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 129, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1438123085, "creation_date": 1438114843, "last_edit_date": 1438123085, "question_id": 31686298, "link": "https://stackoverflow.com/questions/31686298/ruby-raise-exception-on-iterator", "title": "ruby raise exception on iterator", "body": "<p>The following function might return a <code>null</code> value hence I want to use the exception flow. Can someone direct me to the correct way to do it because right now I am getting the error.</p>\n\n<blockquote>\n  <p>syntax error, unexpected keyword_else, expecting keyword_end else</p>\n</blockquote>\n\n<pre><code>def value_from_table1(field, key)\n    begin \n      @@connection.query(\"SELECT #{field} FROM table1 Where key = #{key}  \").each do |row|\n        rescue Exception=&gt;e\n          puts e\n        else \n          return row[field]\n        end\n    end\nend\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 3210, "user_id": 5089231, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zX0dy.jpg?s=128&g=1", "display_name": "Athar", "link": "https://stackoverflow.com/users/5089231/athar"}, "edited": false, "score": 1, "creation_date": 1438114312, "post_id": 31685983, "comment_id": 51314060, "body": "just out of curiosity, why you need to send level_id when you can use habit.current_level in the action."}, {"owner": {"reputation": 2578, "user_id": 4383667, "user_type": "registered", "accept_rate": 86, "profile_image": "https://lh3.googleusercontent.com/-0D7SldkahZc/AAAAAAAAAAI/AAAAAAAAAFk/V8nUZfLVtyk/photo.jpg?sz=128", "display_name": "AnthonyGalli.com", "link": "https://stackoverflow.com/users/4383667/anthonygalli-com"}, "reply_to_user": {"reputation": 3210, "user_id": 5089231, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zX0dy.jpg?s=128&g=1", "display_name": "Athar", "link": "https://stackoverflow.com/users/5089231/athar"}, "edited": false, "score": 0, "creation_date": 1438114483, "post_id": 31685983, "comment_id": 51314146, "body": "Like if I just do <code>habit_level_days_missed_index_path(habit.current_level)</code> @Athar? That would give the error <code>No route matches {:action=&gt;&quot;create&quot;, :controller=&gt;&quot;days_missed&quot;, :format=&gt;nil, :habit_id=&gt;5, :level_id=&gt;nil} missing required keys: [:level_id]</code>"}, {"owner": {"reputation": 3210, "user_id": 5089231, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zX0dy.jpg?s=128&g=1", "display_name": "Athar", "link": "https://stackoverflow.com/users/5089231/athar"}, "edited": false, "score": 0, "creation_date": 1438114630, "post_id": 31685983, "comment_id": 51314224, "body": "okay so you have made level_id compulsory to be passed to the create action.? i was talking about using like this <code>&lt;%= link_to &#39;&lt;span class=&quot;glyphicon glyphicon-remove&quot;&gt;&lt;&#47;span&gt;&#39;.html_safe, habit_level_days_missed_index_path(habit_id: habit, level_id), remote: true, method: &#39;post&#39;, class: &#39;habit-check&#39; %&gt; </code>"}, {"owner": {"reputation": 3210, "user_id": 5089231, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zX0dy.jpg?s=128&g=1", "display_name": "Athar", "link": "https://stackoverflow.com/users/5089231/athar"}, "edited": false, "score": 0, "creation_date": 1438114666, "post_id": 31685983, "comment_id": 51314250, "body": "and in the action. you can do something like this <code>level = habit.levels.where(id: habit.current_level)</code>"}, {"owner": {"reputation": 3210, "user_id": 5089231, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zX0dy.jpg?s=128&g=1", "display_name": "Athar", "link": "https://stackoverflow.com/users/5089231/athar"}, "edited": false, "score": 0, "creation_date": 1438114779, "post_id": 31685983, "comment_id": 51314318, "body": "according to the error i see. habit.current_level is 1 and there is no level for that habit with level_id 1."}, {"owner": {"reputation": 2578, "user_id": 4383667, "user_type": "registered", "accept_rate": 86, "profile_image": "https://lh3.googleusercontent.com/-0D7SldkahZc/AAAAAAAAAAI/AAAAAAAAAFk/V8nUZfLVtyk/photo.jpg?sz=128", "display_name": "AnthonyGalli.com", "link": "https://stackoverflow.com/users/4383667/anthonygalli-com"}, "reply_to_user": {"reputation": 3210, "user_id": 5089231, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zX0dy.jpg?s=128&g=1", "display_name": "Athar", "link": "https://stackoverflow.com/users/5089231/athar"}, "edited": false, "score": 0, "creation_date": 1438115067, "post_id": 31685983, "comment_id": 51314499, "body": "@Athar there is a level_id with 1."}, {"owner": {"reputation": 3210, "user_id": 5089231, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zX0dy.jpg?s=128&g=1", "display_name": "Athar", "link": "https://stackoverflow.com/users/5089231/athar"}, "edited": false, "score": 0, "creation_date": 1438115109, "post_id": 31685983, "comment_id": 51314532, "body": "is it assosiated with that habit as well.?"}, {"owner": {"reputation": 2578, "user_id": 4383667, "user_type": "registered", "accept_rate": 86, "profile_image": "https://lh3.googleusercontent.com/-0D7SldkahZc/AAAAAAAAAAI/AAAAAAAAAFk/V8nUZfLVtyk/photo.jpg?sz=128", "display_name": "AnthonyGalli.com", "link": "https://stackoverflow.com/users/4383667/anthonygalli-com"}, "reply_to_user": {"reputation": 3210, "user_id": 5089231, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zX0dy.jpg?s=128&g=1", "display_name": "Athar", "link": "https://stackoverflow.com/users/5089231/athar"}, "edited": false, "score": 0, "creation_date": 1438115130, "post_id": 31685983, "comment_id": 51314549, "body": "And for example this works <code>&lt;% habit.levels.each do |level| %&gt;              &lt;%= link_to &#39;&lt;span class=&quot;glyphicon glyphicon-remove&quot;&gt;&lt;&#47;span&gt;&#39;.html_safe, habit_level_days_missed_index_path({ habit_id: habit, level_id: level.id }), remote: true, method: &#39;post&#39;, class: &#39;habit-check&#39; %&gt;            &lt;% end %&gt;</code> but then the button is duplicated 5 times because of the looping. I just need one button to show that would affect the current level when clicked."}, {"owner": {"reputation": 3210, "user_id": 5089231, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zX0dy.jpg?s=128&g=1", "display_name": "Athar", "link": "https://stackoverflow.com/users/5089231/athar"}, "reply_to_user": {"reputation": 2578, "user_id": 4383667, "user_type": "registered", "accept_rate": 86, "profile_image": "https://lh3.googleusercontent.com/-0D7SldkahZc/AAAAAAAAAAI/AAAAAAAAAFk/V8nUZfLVtyk/photo.jpg?sz=128", "display_name": "AnthonyGalli.com", "link": "https://stackoverflow.com/users/4383667/anthonygalli-com"}, "edited": false, "score": 0, "creation_date": 1438115229, "post_id": 31685983, "comment_id": 51314615, "body": "Let us <a href=\"http://chat.stackoverflow.com/rooms/84506/discussion-between-athar-and-anthonygalli-com\">continue this discussion in chat</a>."}], "answers": [{"tags": [], "owner": {"reputation": 3210, "user_id": 5089231, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zX0dy.jpg?s=128&g=1", "display_name": "Athar", "link": "https://stackoverflow.com/users/5089231/athar"}, "is_accepted": true, "score": 1, "last_activity_date": 1438121193, "creation_date": 1438121193, "answer_id": 31687949, "question_id": 31685983, "link": "https://stackoverflow.com/questions/31685983/recordnotfound-couldnt-find-level-with-id/31687949#31687949", "title": "RecordNotFound: Couldn&#39;t find Level with &quot;id&quot;", "body": "<p>Add method <code>current_habit_level</code> in habit.rb which will use current_level and fetch level_id for that habit. So that when you click the link it will pass correct level is and it won't crash on searching</p>\n\n<pre><code>  def current_habit_level\n    self.levels.order(\"id asc\").limit(current_level).last\n end\n</code></pre>\n\n<p>Use this method to fetch level id in link</p>\n"}], "owner": {"reputation": 2578, "user_id": 4383667, "user_type": "registered", "accept_rate": 86, "profile_image": "https://lh3.googleusercontent.com/-0D7SldkahZc/AAAAAAAAAAI/AAAAAAAAAFk/V8nUZfLVtyk/photo.jpg?sz=128", "display_name": "AnthonyGalli.com", "link": "https://stackoverflow.com/users/4383667/anthonygalli-com"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 55, "favorite_count": 1, "accepted_answer_id": 31687949, "answer_count": 1, "score": 1, "last_activity_date": 1438121193, "creation_date": 1438113654, "last_edit_date": 1495535219, "question_id": 31685983, "link": "https://stackoverflow.com/questions/31685983/recordnotfound-couldnt-find-level-with-id", "title": "RecordNotFound: Couldn&#39;t find Level with &quot;id&quot;", "body": "<p>Having some trouble fixing this error:</p>\n\n<pre><code> ActiveRecord::RecordNotFound (Couldn't find Level with 'id'=1 [WHERE \"levels\".\"habit_id\" = ?]):\n  app/controllers/days_missed_controller.rb:9:in `create'\n</code></pre>\n\n<p>when clicking on this button:</p>\n\n<pre><code>&lt;%= link_to '&lt;span class=\"glyphicon glyphicon-remove\"&gt;&lt;/span&gt;'.html_safe, habit_level_days_missed_index_path({ habit_id: habit, level_id: habit.current_level }), remote: true, method: 'post', class: 'habit-check' %&gt;    #    habits/_habit.html.erb, which is rendered by &lt;%= render @habits %&gt; in pages/home.html.erb \n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/PROOW.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/PROOW.png\" alt=\"enter image description here\"></a></p>\n\n<p><strong>days_missed_controller</strong></p>\n\n<pre><code>  def create\n    habit = Habit.find(params[:habit_id])\n    habit.missed_days = habit.missed_days + 1\n    @habit.save!\n    level = habit.levels.find(params[:level_id])\n    level.missed_days = level.missed_days + 1\n    if level.missed_days == 3\n      level.missed_days = 0\n      level.days_lost += habit.calculate_days_lost + 2\n    end\n    level.save!\n    head :ok # this returns an empty response with a 200 success status code\n  end\n</code></pre>\n\n<p>Here's the <strong><a href=\"https://gist.github.com/RallyWithGalli/c66dee6dfb9ab5d338c2\" rel=\"nofollow noreferrer\">Gist</a></strong> of it.</p>\n\n<p>This question is coming off of @Pavan's <strong><a href=\"https://stackoverflow.com/questions/31665081/how-to-use-link-to-instead-of-checkbox-for-post\">answer</a></strong>. We couldn't figure out how to solve this error together so we'd greatly appreciate your input!</p>\n"}]