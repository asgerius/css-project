[{"tags": ["ruby", "loops"], "comments": [{"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1544046854, "post_id": 53641167, "comment_id": 94142191, "body": "Also <a href=\"https://ruby-doc.org/core-2.5.1/Enumerable.html#method-i-map\" rel=\"nofollow noreferrer\"><code>map</code></a> will return an <code>Array</code> based on the return value of the block so you could avoid <code>emails = []</code> and <code>emails.push(i)</code>"}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1544047593, "post_id": 53641167, "comment_id": 94142432, "body": "Do you want to generate 25 or 50 emails with the even numbers? Please answer by editing your question. Though not central to your question, the Ruby way of what you have is <code>arr = (1..50).map { |i| &quot;jean.dupont.%02d@email.fr&quot; %[i] }</code> and then doing any desired <code>put</code>sing after."}], "answers": [{"tags": [], "owner": {"reputation": 14139, "user_id": 1108, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/48OpQ.jpg?s=128&g=1", "display_name": "jerhinesmith", "link": "https://stackoverflow.com/users/1108/jerhinesmith"}, "is_accepted": true, "score": 5, "last_activity_date": 1544046416, "creation_date": 1544046416, "answer_id": 53641230, "question_id": 53641167, "link": "https://stackoverflow.com/questions/53641167/a-loop-containing-only-even-numbers/53641230#53641230", "title": "A loop containing only even numbers", "body": "<p>If you can change the range, then <code>step</code> would be your friend:</p>\n\n<pre><code>emails = []\n(2..50).step(2) do |i|\n  puts \"jean.dupont.%02d@email.fr\" %[i]\n  emails.push(i)\nend\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1477, "user_id": 262707, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6bf48ce51b35fa383042a3b22accdb99?s=128&d=identicon&r=PG", "display_name": "maro", "link": "https://stackoverflow.com/users/262707/maro"}, "is_accepted": false, "score": 1, "last_activity_date": 1544046730, "creation_date": 1544046730, "answer_id": 53641306, "question_id": 53641167, "link": "https://stackoverflow.com/questions/53641167/a-loop-containing-only-even-numbers/53641306#53641306", "title": "A loop containing only even numbers", "body": "<p>You can filter your range to only even numbers by using the <code>.select</code> method, changing <code>(1..50).each</code> into <code>(1..50).select(&amp;:even?).each</code>.</p>\n\n<p>If you can change the range, then jerhinesmith's answer is nice too.</p>\n"}, {"comments": [{"owner": {"reputation": 9030, "user_id": 5101476, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JCQrl.jpg?s=128&g=1", "display_name": "ice\u30c4", "link": "https://stackoverflow.com/users/5101476/ice%e3%83%84"}, "edited": false, "score": 1, "creation_date": 1544053629, "post_id": 53641366, "comment_id": 94144334, "body": "You can use <a href=\"http://ruby-doc.org/core-2.5.3/Integer.html#method-i-even-3F\" rel=\"nofollow noreferrer\"><code>Integer#even?</code></a> for your conditional."}], "tags": [], "owner": {"reputation": 27342, "user_id": 899344, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b510e9cb741e4f4e1aed1c4642f21066?s=128&d=identicon&r=PG", "display_name": "Conner", "link": "https://stackoverflow.com/users/899344/conner"}, "is_accepted": false, "score": 2, "last_activity_date": 1544046974, "creation_date": 1544046974, "answer_id": 53641366, "question_id": 53641167, "link": "https://stackoverflow.com/questions/53641167/a-loop-containing-only-even-numbers/53641366#53641366", "title": "A loop containing only even numbers", "body": "<p>The old school way (instructive for students):</p>\n\n<pre><code>emails = []\n(1..50).each do |i|\n  if i % 2 == 0\n    puts \"jean.dupont.%02d@email.fr\" %[i]\n    emails.push(i)\n  end\nend\n</code></pre>\n"}], "owner": {"reputation": 41, "user_id": 10645509, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eace4346bbf60729c3c09c17851e66ad?s=128&d=identicon&r=PG&f=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/10645509/alex"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 273, "favorite_count": 0, "accepted_answer_id": 53641230, "answer_count": 3, "score": 0, "last_activity_date": 1544071031, "creation_date": 1544046084, "last_edit_date": 1544071031, "question_id": 53641167, "link": "https://stackoverflow.com/questions/53641167/a-loop-containing-only-even-numbers", "title": "A loop containing only even numbers", "body": "<p>I am doing a task to generate an array of fake email addresses in a given format.</p>\n\n<p>I have managed to write a code that works for it. Here's what my code looks like:</p>\n\n<pre><code>emails = []\n(1..50).each do |i|\n  puts \"jean.dupont.%02d@email.fr\" %[i]\n  emails.push(i)\nend\n</code></pre>\n\n<p>This generates emails that look like this:</p>\n\n<pre><code>jean.dupont.01@email.fr\njean.dupont.02@email.fr\njean.dupont.03@email.fr\n...\njean.dupont.50@email.fr\n</code></pre>\n\n<p>I am doing another task to generate the same thing, but only containing even numbers.</p>\n\n<p>How can I add simple code to what I have, so it only gives even numbers?</p>\n"}, {"tags": ["ruby", "powershell"], "comments": [{"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 1, "creation_date": 1544043974, "post_id": 53640682, "comment_id": 94140952, "body": "what variations have you tried?"}, {"owner": {"reputation": 11, "user_id": 9366470, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1aa771f481bd7c93dc858c58087a8fb6?s=128&d=identicon&r=PG&f=1", "display_name": "wayne_agostino", "link": "https://stackoverflow.com/users/9366470/wayne-agostino"}, "reply_to_user": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1544045143, "post_id": 53640682, "comment_id": 94141497, "body": "This works, but it is super ugly."}, {"owner": {"reputation": 11, "user_id": 9366470, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1aa771f481bd7c93dc858c58087a8fb6?s=128&d=identicon&r=PG&f=1", "display_name": "wayne_agostino", "link": "https://stackoverflow.com/users/9366470/wayne-agostino"}, "reply_to_user": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1544045153, "post_id": 53640682, "comment_id": 94141504, "body": "a = Dir[&#39;D:/SQLInstaller/sql20*&#39;] b = a.to_s c = b.split(&#39;/&#39;)[2] d = c.chop e = d.chop puts a puts b puts c puts d puts e"}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1544046656, "post_id": 53640682, "comment_id": 94142120, "body": "Wow okay try <code>Dir[&#39;D:&#47;SQLInstaller&#47;sql20*&#39;].first.split(&quot;&#47;&quot;).last</code> ? or maybe <code>require &#39;pathname&#39;; Pathname.glob(&#39;D:&#47;SQLInstaller&#47;sql20*&#39;).first.basename.to_s</code>"}], "answers": [{"comments": [{"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1544151072, "post_id": 53643226, "comment_id": 94183229, "body": "<code>each_child</code> would be better since it doesn&#39;t generate an intermediate Array. Also <code>select{}.first</code> can be <code>detect</code>"}], "tags": [], "owner": {"reputation": 56, "user_id": 10744236, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/19ffbc3bfcbe5edcad28523b5c9ce1f8?s=128&d=identicon&r=PG&f=1", "display_name": "mardotio", "link": "https://stackoverflow.com/users/10744236/mardotio"}, "is_accepted": false, "score": 0, "last_activity_date": 1544059121, "creation_date": 1544059121, "answer_id": 53643226, "question_id": 53640682, "link": "https://stackoverflow.com/questions/53640682/what-is-the-ruby-equivalent-of-powershell-get-childitem-d-sqlinstaller-direct/53643226#53643226", "title": "What is the ruby equivalent of Powershell (Get-ChildItem D:\\SQLInstaller -Directory | ? {$_.Name -Like &quot;SQL20*&quot;}).Name", "body": "<p>If you want all subdirectories:</p>\n\n<pre><code>subdirectories = Dir.children('D:/SQLInstaller').select { |c| File.directory?(c) }\n</code></pre>\n\n<p>If you want only subdirectories that match SQL20.*:</p>\n\n<pre><code>matching = Dir.children('D:/SQLInstaller').select { |c| File.directory?(c) &amp;&amp; c =~ %r{SQL20.*} }\n</code></pre>\n\n<p>If you want only the first subdirectory that matches SQL20.*:</p>\n\n<pre><code>first_matching = Dir.children('D:/SQLInstaller').select { |c| File.directory?(c) &amp;&amp; c =~ %r{SQL20.*} }.first\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 9366470, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1aa771f481bd7c93dc858c58087a8fb6?s=128&d=identicon&r=PG&f=1", "display_name": "wayne_agostino", "link": "https://stackoverflow.com/users/9366470/wayne-agostino"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 35, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1544059121, "creation_date": 1544043715, "question_id": 53640682, "link": "https://stackoverflow.com/questions/53640682/what-is-the-ruby-equivalent-of-powershell-get-childitem-d-sqlinstaller-direct", "title": "What is the ruby equivalent of Powershell (Get-ChildItem D:\\SQLInstaller -Directory | ? {$_.Name -Like &quot;SQL20*&quot;}).Name", "body": "<p>There are four possible names that the subdirectory under D:\\SQLInstaller can have.</p>\n\n<p>I want to use ruby(chef) to return the name of the directory like SQL20* into a variable.</p>\n\n<p>I have tried various versions of Dir.entries and Dir.glob without any luck.</p>\n"}, {"tags": ["ruby", "rubygems", "metasploit"], "comments": [{"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1544040252, "post_id": 53639847, "comment_id": 94139269, "body": "have you tried running <code>gem install sysrandom</code> from a terminal?"}, {"owner": {"reputation": 27, "user_id": 9149368, "user_type": "registered", "profile_image": "https://graph.facebook.com/168248740573859/picture?type=large", "display_name": "Khaled Touahri", "link": "https://stackoverflow.com/users/9149368/khaled-touahri"}, "reply_to_user": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1544041619, "post_id": 53639847, "comment_id": 94139871, "body": "no actually, i&#39;ll try it thanks"}], "answers": [{"tags": [], "owner": {"reputation": 3201, "user_id": 2892779, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uvM8S.jpg?s=128&g=1", "display_name": "Jay Dorsey", "link": "https://stackoverflow.com/users/2892779/jay-dorsey"}, "is_accepted": true, "score": 0, "last_activity_date": 1544056497, "creation_date": 1544056497, "answer_id": 53642902, "question_id": 53639847, "link": "https://stackoverflow.com/questions/53639847/bundler-could-not-find-compatible-versions-for-gem-sysrandom/53642902#53642902", "title": "Bundler could not find compatible versions for gem &quot;sysrandom&quot;", "body": "<p>The version of metasploit you linked to doesn't appear to have been updated in a few years. It doesn't list <code>sysrandom</code> as a dependency in the Gemfile.</p>\n\n<p>There's a <a href=\"https://github.com/rapid7/metasploit-framework\" rel=\"nofollow noreferrer\">newer version</a> which does have sysrandom as a dependency, here: </p>\n\n<p><a href=\"https://github.com/rapid7/metasploit-framework/blob/master/metasploit-framework.gemspec#L106\" rel=\"nofollow noreferrer\">https://github.com/rapid7/metasploit-framework/blob/master/metasploit-framework.gemspec#L106</a></p>\n\n<p>I'm not sure why pentestbox is using such an old version, but I'm assuming the \"update\" actually updates to the rapid7 version of metasploit (because it's looking for sysrandom which only exists there).</p>\n\n<p>There are a few things you can try:</p>\n\n<ul>\n<li><code>bundle install</code> should install all the dependencies (without using the console tool built for pentestbox)</li>\n<li>Deleting the <code>Gemfile.lock</code> and running <code>bundle install</code>. I don't usually recommend this but if there seems to be a version mismatch somewhere and sometimes this resolves dependencies errors. You should be able to re-check this file out again (assuming it's versioned locally)</li>\n</ul>\n\n<p>If you can post the git commit hash of the metasploit version you've downloaded that might help provide additional suggestions for resolving.</p>\n"}], "owner": {"reputation": 27, "user_id": 9149368, "user_type": "registered", "profile_image": "https://graph.facebook.com/168248740573859/picture?type=large", "display_name": "Khaled Touahri", "link": "https://stackoverflow.com/users/9149368/khaled-touahri"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 632, "favorite_count": 0, "accepted_answer_id": 53642902, "answer_count": 1, "score": 0, "last_activity_date": 1544289445, "creation_date": 1544039875, "last_edit_date": 1544289445, "question_id": 53639847, "link": "https://stackoverflow.com/questions/53639847/bundler-could-not-find-compatible-versions-for-gem-sysrandom", "title": "Bundler could not find compatible versions for gem &quot;sysrandom&quot;", "body": "<p>After installing <a href=\"https://pentestbox.org\" rel=\"nofollow noreferrer\">PentestBox</a> for installing penetration testing tools on windows 10 It was working great but some of the tools was outdated like <a href=\"https://metasploit.com\" rel=\"nofollow noreferrer\">metasploit</a>, so I tried updating all using <a href=\"https://docs.pentestbox.org/update.html\" rel=\"nofollow noreferrer\">PentestBox Update Manager</a>, but after finishing the update msfconsole keeps giving me this error</p>\n\n<pre><code>Bundler could not find compatible versions for gem \"sysrandom\":\n  In Gemfile:\n    metasploit-framework x86-mingw32 was resolved to 5.0.0, which depends on sysrandom x86-mingw32\n\n  Could not find gem 'sysrandom', which is required by gem 'metasploit-framework', in any of the sources.\n</code></pre>\n\n<p>and i literally suck in ruby language on general so what should i do ? </p>\n"}, {"tags": ["ruby", "string"], "comments": [{"owner": {"reputation": 394580, "user_id": 479863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ArUCE.jpg?s=128&g=1", "display_name": "mu is too short", "link": "https://stackoverflow.com/users/479863/mu-is-too-short"}, "edited": false, "score": 2, "creation_date": 1544039048, "post_id": 53639385, "comment_id": 94138753, "body": "Executive summary: <code>\\&#39;</code> has a special meaning inside the second argument to <code>String#gsub</code> so you have to escape your escapes with <code>gsub(&quot;&#39;&quot;, &quot;\\\\\\\\&#39;&quot;)</code>. Don&#39;t feel bad about the duplicate, this behavior is a little obscure and hard to search for (except when you already know the answer)."}, {"owner": {"reputation": 1, "user_id": 10751283, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-EJZ8d47m4uQ/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-gyupW4kitlKIjeVCtT3mF0Zcwghg/mo/photo.jpg?sz=128", "display_name": "Ryan Daley", "link": "https://stackoverflow.com/users/10751283/ryan-daley"}, "reply_to_user": {"reputation": 394580, "user_id": 479863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ArUCE.jpg?s=128&g=1", "display_name": "mu is too short", "link": "https://stackoverflow.com/users/479863/mu-is-too-short"}, "edited": false, "score": 0, "creation_date": 1544039524, "post_id": 53639385, "comment_id": 94138950, "body": "This outputs <code>&quot;I\\\\&#39;m a teapot.&quot;</code>  I specifically need it to say <code>&quot;I\\&#39;m a teapot.&quot;</code> because I am passing to osascript which needs that specific format."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1544040295, "post_id": 53639385, "comment_id": 94139287, "body": "You can also <code>gsub(%q[&#39;], %q[\\\\&#39;])</code> to avoid oddball quoting issues."}, {"owner": {"reputation": 1, "user_id": 10751283, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-EJZ8d47m4uQ/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-gyupW4kitlKIjeVCtT3mF0Zcwghg/mo/photo.jpg?sz=128", "display_name": "Ryan Daley", "link": "https://stackoverflow.com/users/10751283/ryan-daley"}, "edited": false, "score": 0, "creation_date": 1544040508, "post_id": 53639385, "comment_id": 94139381, "body": "tadman, your solution outputs <code>&quot;Im a teapot.m a teapot.&quot;</code>  After reviewing multiple articles, I&#39;m starting to think that getting Ruby to output <code>&quot;I\\&#39;m a teapot.&quot;</code> is literally impossible."}, {"owner": {"reputation": 394580, "user_id": 479863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ArUCE.jpg?s=128&g=1", "display_name": "mu is too short", "link": "https://stackoverflow.com/users/479863/mu-is-too-short"}, "edited": false, "score": 1, "creation_date": 1544043320, "post_id": 53639385, "comment_id": 94140652, "body": "Use <code>puts</code> to see the real string, not <code>inspect</code> (which is what <code>irb</code> uses to show the value of the last expression)."}], "owner": {"reputation": 1, "user_id": 10751283, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-EJZ8d47m4uQ/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-gyupW4kitlKIjeVCtT3mF0Zcwghg/mo/photo.jpg?sz=128", "display_name": "Ryan Daley", "link": "https://stackoverflow.com/users/10751283/ryan-daley"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 28, "favorite_count": 0, "closed_date": 1544038901, "answer_count": 0, "score": 0, "last_activity_date": 1544037857, "creation_date": 1544037857, "question_id": 53639385, "link": "https://stackoverflow.com/questions/53639385/in-ruby-taking-an-and-turning-into", "closed_reason": "Duplicate", "title": "In Ruby, taking an &#39; and turning into \\&#39;", "body": "<p><code>message = \"I'm a teapot.\"</code></p>\n\n<p>I need this to output <code>\"I\\'m a teapot.\"</code></p>\n\n<p><code>message.gsub(\"'\",\"\\'\")</code> does not work, and I have not found any combinations that do work, such as <code>message.gsub(\"'\",\"\\\\\\'\")</code>  The only solution I have found is to replace the ' (apostrophe) with a ` (backtick).</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "macos", "updating"], "comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 1, "creation_date": 1544034789, "post_id": 53638628, "comment_id": 94136924, "body": "This depends on your operating system and your Ruby version manager. Are you using Homebrew, <code>rbenv</code> or <code>rvm</code>?"}, {"owner": {"reputation": 81, "user_id": 9458402, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "JSON K.", "link": "https://stackoverflow.com/users/9458402/json-k"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1544034979, "post_id": 53638628, "comment_id": 94137008, "body": "Using both rvm and Homebrew"}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1544035096, "post_id": 53638628, "comment_id": 94137051, "body": "<code>rvm list</code> shows what&#39;s installed and what&#39;s activated. If it keeps reverting it&#39;s possible your RVM installation isn&#39;t quite right and you need to <a href=\"https://rvm.io\" rel=\"nofollow noreferrer\">check the documentation</a>. Be sure you&#39;ve followed all the steps."}, {"owner": {"reputation": 81, "user_id": 9458402, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "JSON K.", "link": "https://stackoverflow.com/users/9458402/json-k"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1544035116, "post_id": 53638628, "comment_id": 94137059, "body": "Or like I&#39;ll have it installed, but it goes to 2.3.7 by default. Then I do &quot;rvm install ruby-2.5.3&quot; and it doesn&#39;t download anything new but then shows the version as 2.5.3"}, {"owner": {"reputation": 81, "user_id": 9458402, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "JSON K.", "link": "https://stackoverflow.com/users/9458402/json-k"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1544035162, "post_id": 53638628, "comment_id": 94137081, "body": "It shows this &quot;* ruby-2.3.7 [ x86_64 ]    ruby-2.4.2 [ x86_64 ]    ruby-2.4.4 [ x86_64 ] =&gt; ruby-2.5.3 [ x86_64 ]&quot; So I&#39;m guessing the * means that 2.3.7 is default"}], "answers": [{"comments": [{"owner": {"reputation": 81, "user_id": 9458402, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "JSON K.", "link": "https://stackoverflow.com/users/9458402/json-k"}, "edited": false, "score": 1, "creation_date": 1544035487, "post_id": 53638765, "comment_id": 94137232, "body": "Thanks, setting the default worked, and I was able to remove 2 of the 3 older rubies I had installed"}, {"owner": {"reputation": 6777, "user_id": 4853133, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/3GSSn.jpg?s=128&g=1", "display_name": "Quick learner", "link": "https://stackoverflow.com/users/4853133/quick-learner"}, "edited": false, "score": 0, "creation_date": 1614260664, "post_id": 53638765, "comment_id": 117335667, "body": "this worked for me, I installed higher version with rvm but it was showing old version , so after doing this , it is showing newer version"}], "tags": [], "owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "is_accepted": false, "score": 3, "last_activity_date": 1544035224, "creation_date": 1544035224, "answer_id": 53638765, "question_id": 53638628, "link": "https://stackoverflow.com/questions/53638628/how-to-keep-ruby-updated-on-mac/53638765#53638765", "title": "How To Keep Ruby Updated on Mac", "body": "<p>You need to pin the <a href=\"https://rvm.io/rubies/default\" rel=\"nofollow noreferrer\">default version</a>:</p>\n\n<pre><code>rvm use --default 2.5.3\n</code></pre>\n\n<p>Then check that's applied by opening a new shell:</p>\n\n<pre><code>rvm list\n</code></pre>\n\n<p>If it's not staying pinned it possible RVM isn't properly initialized in your shell. Check that the <code>.profile</code> or <code>.bash_profile</code> or <code>.bashrc</code> or whatever shell you're using has the right RVM environment setup at the bottom.</p>\n"}, {"tags": [], "owner": {"reputation": 5237, "user_id": 2325924, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/XSXrT.jpg?s=128&g=1", "display_name": "7urkm3n", "link": "https://stackoverflow.com/users/2325924/7urkm3n"}, "is_accepted": false, "score": 2, "last_activity_date": 1544035295, "creation_date": 1544035295, "answer_id": 53638779, "question_id": 53638628, "link": "https://stackoverflow.com/questions/53638628/how-to-keep-ruby-updated-on-mac/53638779#53638779", "title": "How To Keep Ruby Updated on Mac", "body": "<p>Suggesting to work with <code>rvm</code> or <code>rbenv</code></p>\n\n<p><code>rvm</code> - <a href=\"https://rvm.io/rvm/install\" rel=\"nofollow noreferrer\">rvm documentation</a></p>\n\n<p><strong>Installation:</strong></p>\n\n<p><code>RVM</code> - copy/paste to terminal the url below.</p>\n\n<p><code>\\curl -sSL https://get.rvm.io | bash -s stable --ruby</code></p>\n\n<p>Make sure to restart terminal after installing <code>RVM environment</code> has to be loaded. </p>\n\n<p><strong>Usage:</strong> </p>\n\n<p><code>rvm list</code> - see all installed or available ruby version in the machine.</p>\n\n<p><code>rvm install ruby-2.5.1</code> - installing ruby 2.5.1 version</p>\n\n<p><code>rvm use 2.5.1</code> - using specific version</p>\n\n<p><code>rvm use --default 2.5.1</code> - to make it default</p>\n"}], "owner": {"reputation": 81, "user_id": 9458402, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "JSON K.", "link": "https://stackoverflow.com/users/9458402/json-k"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 434, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1544035295, "creation_date": 1544034717, "last_edit_date": 1544034804, "question_id": 53638628, "link": "https://stackoverflow.com/questions/53638628/how-to-keep-ruby-updated-on-mac", "title": "How To Keep Ruby Updated on Mac", "body": "<p>I keep updating my Ruby to the newest version, and it somehow keeps reverting back to the old version I had installed, 2.3.7. I'm confused how or why this is happening? How can I keep it on the newest version on my computer?</p>\n"}, {"tags": ["ruby"], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 10588070, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLSyg.png?s=128&g=1", "display_name": "Ebonite6", "link": "https://stackoverflow.com/users/10588070/ebonite6"}, "edited": false, "score": 0, "creation_date": 1544034430, "post_id": 53638451, "comment_id": 94136754, "body": "I forgot to add my code my bad, I tried that but it gave a regexp error error: in `[ ] &#39;: no implicit conversion of Regexp into Integer (TypeError)"}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1544034756, "post_id": 53638451, "comment_id": 94136908, "body": "You could also do this with <code>f.each_line.map { ... }</code> surrounding that <code>map</code> call to minimize the code."}, {"owner": {"reputation": 3523, "user_id": 9043475, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FNxvn.jpg?s=128&g=1", "display_name": "Rajagopalan", "link": "https://stackoverflow.com/users/9043475/rajagopalan"}, "reply_to_user": {"reputation": 13, "user_id": 10588070, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLSyg.png?s=128&g=1", "display_name": "Ebonite6", "link": "https://stackoverflow.com/users/10588070/ebonite6"}, "edited": false, "score": 0, "creation_date": 1544035267, "post_id": 53638451, "comment_id": 94137132, "body": "@Ebonite6 Updated , check it now."}, {"owner": {"reputation": 13, "user_id": 10588070, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLSyg.png?s=128&g=1", "display_name": "Ebonite6", "link": "https://stackoverflow.com/users/10588070/ebonite6"}, "edited": false, "score": 0, "creation_date": 1544035417, "post_id": 53638451, "comment_id": 94137197, "body": "My bad, I was actually adding strings into the array so the error was on me. Thanks for the help!"}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 1, "creation_date": 1544041595, "post_id": 53638451, "comment_id": 94139855, "body": "Instead of a conditional <code>push</code>, consider using <code>select</code> to filter. In this case <code>grep</code> is even better since you can use a regular expression."}], "tags": [], "owner": {"reputation": 3523, "user_id": 9043475, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FNxvn.jpg?s=128&g=1", "display_name": "Rajagopalan", "link": "https://stackoverflow.com/users/9043475/rajagopalan"}, "is_accepted": true, "score": 4, "last_activity_date": 1544035238, "last_edit_date": 1544035238, "creation_date": 1544033916, "answer_id": 53638451, "question_id": 53638306, "link": "https://stackoverflow.com/questions/53638306/splitting-a-string-to-get-a-number/53638451#53638451", "title": "Splitting a string to get a number", "body": "<p>Let's assume your array is</p>\n\n<pre><code>a=[\"Score:5\",\"Score:10\",\"Score:11\"]\n</code></pre>\n\n<p>Code</p>\n\n<pre><code>p a.map{|x| x[/\\d+/].to_i}\n</code></pre>\n\n<p>output</p>\n\n<pre><code>[5, 10, 11]\n</code></pre>\n\n<p><strong>Update</strong></p>\n\n<p>I have taken your inner code and corrected it</p>\n\n<pre><code>if line.include? \"Score\"\n   array.push line[/\\d+/].to_i\nend\n</code></pre>\n\n<p>Or </p>\n\n<pre><code>array.push line[/\\d+/].to_i if line.include? \"Score\"\n</code></pre>\n\n<p>Now print the array, output contains only the score numbers.</p>\n"}, {"tags": [], "owner": {"reputation": 14139, "user_id": 1108, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/48OpQ.jpg?s=128&g=1", "display_name": "jerhinesmith", "link": "https://stackoverflow.com/users/1108/jerhinesmith"}, "is_accepted": false, "score": 2, "last_activity_date": 1544033932, "creation_date": 1544033932, "answer_id": 53638454, "question_id": 53638306, "link": "https://stackoverflow.com/questions/53638306/splitting-a-string-to-get-a-number/53638454#53638454", "title": "Splitting a string to get a number", "body": "<p>Could you just split on the <code>:</code> character? Something like this:</p>\n\n<pre><code>prefix, score = \"Score:5\".split(':')\n# =&gt; [\"Score\", \"5\"]\n</code></pre>\n\n<p>Then you could just do <code>score.to_i</code> if you need it to be an integer.</p>\n"}], "owner": {"reputation": 13, "user_id": 10588070, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLSyg.png?s=128&g=1", "display_name": "Ebonite6", "link": "https://stackoverflow.com/users/10588070/ebonite6"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 52, "favorite_count": 0, "accepted_answer_id": 53638451, "answer_count": 2, "score": 0, "last_activity_date": 1544071296, "creation_date": 1544033359, "last_edit_date": 1544071296, "question_id": 53638306, "link": "https://stackoverflow.com/questions/53638306/splitting-a-string-to-get-a-number", "title": "Splitting a string to get a number", "body": "<p>I want to grab a number from a list of scores e.g. <code>\"Score:5\"</code> or <code>\"Score:10\"</code>.</p>\n\n<p>I can't find a way to grab the number and turn it into an int so I can use it for an array. Any help?</p>\n\n<p>My code as follows looks for a score that contains a number</p>\n\n<pre><code>range = 0\narray = []\nDir[\"C:/Users/Cam/Desktop/warmup/Warmup_tally/*\"].each do |filename|\n  File.open(filename) do |f|\n    f.each_line do |line|\n      if line.include? \"Score\"\n        puts line.split(':')\n        range += 1\n        array.push(-0, \"#{line}\") \n      end\n    end\n  end\nend\n</code></pre>\n\n<p>but I want to only grab that number and put it inside <code>Array</code>.</p>\n"}, {"tags": ["ruby-on-rails", "arrays", "ruby"], "answers": [{"tags": [], "owner": {"reputation": 21521, "user_id": 78613, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/0fa1dc97175c4cc1ea4ecf506119961c?s=128&d=identicon&r=PG", "display_name": "Nick Veys", "link": "https://stackoverflow.com/users/78613/nick-veys"}, "is_accepted": true, "score": 0, "last_activity_date": 1544031269, "creation_date": 1544031269, "answer_id": 53637797, "question_id": 53637574, "link": "https://stackoverflow.com/questions/53637574/how-to-get-artistid-from-an-array-in-rails-and-redirect-using-artistid-as-a-para/53637797#53637797", "title": "how to get artistID from an array in rails and redirect using artistID as a param", "body": "<p>That first line isn't a valid array, also you're not doing any comparison's to find the ID.  In the first one you're assigning the <code>@artistID</code> variable to every artistID, which in the end leaves you with only the last one.  The other example you're copying all of the IDs into an array.  Take a look at this:</p>\n\n<pre><code>artists = [\n  {\"artistName\": \"Nirvana\", \"artistID\": \"0001\", \"album\": \"Nevermind\"},\n  {\"artistName\": \"Pearl Jam\", \"artistID\": \"0201\", \"album\": \"Ten\"},\n  {\"artistName\": \"Alice In Chains\", \"artistID\": \"1192\", \"format\": \"Sap\"}\n]\n\nfound_artist = artists.find do |artist|\n  artist[:artistName] == \"Nirvana\"\nend\n\nartistID = found_artist[:artistID]\nputs artistID\n</code></pre>\n\n<p>This prints \"0001\" for me.</p>\n"}], "owner": {"reputation": 13, "user_id": 10750637, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/122b3052f7253752fc467d35ced76ccd?s=128&d=identicon&r=PG&f=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/10750637/alex"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 20, "favorite_count": 0, "accepted_answer_id": 53637797, "answer_count": 1, "score": 0, "last_activity_date": 1544048245, "creation_date": 1544030352, "last_edit_date": 1544048245, "question_id": 53637574, "link": "https://stackoverflow.com/questions/53637574/how-to-get-artistid-from-an-array-in-rails-and-redirect-using-artistid-as-a-para", "title": "how to get artistID from an array in rails and redirect using artistID as a param", "body": "<p>I am new to rails and am making a test app but am having a bit of trouble with getting a key/value from an array.</p>\n\n<p>I want to search for an artist by artistName. Once a match has been found, I want to go to a bio page based on the artistID. The search by name works as expected but I am unable to then redirect using the artistID. Here is my code for artistID.    </p>\n\n<pre><code>@artists = [\"artists\": {\"artistName\": \"Nirvana\", \"artistID\": \"0001\", \"album\": \"Nevermind\"}, {\"artistName\": \"Pearl Jam\", \"artistID\": \"0201\", \"album\": \"Ten\"}, {\"artistName\": \"Alice In Chains\", \"artistID\": \"1192\", \"format\": \"Sap\"}}]\n\n@artists.each do |item|\n @artistID = item[:artistID]\nend\n</code></pre>\n\n<p>The result of @artistID is always the last artistID in the array. I have also tried this</p>\n\n<pre><code>@artistID = Array.new\n@artists.each do |item|\n @id = Hash.new\n @id = item[:artistID]\n@artistID &lt;&lt; @id\nend\n</code></pre>\n\n<p>This then returns all artistID's. Can anyone help me get the correct artistID for the artist?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "rubygems", "bundler"], "comments": [{"owner": {"reputation": 3201, "user_id": 2892779, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uvM8S.jpg?s=128&g=1", "display_name": "Jay Dorsey", "link": "https://stackoverflow.com/users/2892779/jay-dorsey"}, "edited": false, "score": 0, "creation_date": 1544057723, "post_id": 53637109, "comment_id": 94145365, "body": "While counter-intuitive, the answer by Holger is correct. Running <code>bundle update &lt;gem&gt;</code> will upgrade <i>or</i> downgrade that gem to the version specified in your Gemfile."}], "answers": [{"tags": [], "owner": {"reputation": 11, "user_id": 4810289, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/711435d77e29d852b1440c630ccffeee?s=128&d=identicon&r=PG&f=1", "display_name": "Bansen", "link": "https://stackoverflow.com/users/4810289/bansen"}, "is_accepted": false, "score": 1, "last_activity_date": 1544029986, "creation_date": 1544029986, "answer_id": 53637469, "question_id": 53637109, "link": "https://stackoverflow.com/questions/53637109/how-to-downgrande-a-gem-in-the-gemfile/53637469#53637469", "title": "How to downgrande a gem in the gemfile?", "body": "<p>First try to update the dependent gems. It could be that there are some broken dependencies to other gems if you are downgrading.</p>\n\n<p>Best practice:</p>\n\n<pre><code>bundle update sequel dependent_gemnames...\n</code></pre>\n\n<p>If you do not find out the dependent gems you can also try to update all your gems. But attention! This can cause unwanted side effects.</p>\n\n<pre><code>bundle update\n</code></pre>\n\n<p>And the last and ugliest option is to remove your Gemfile.lock and run</p>\n\n<pre><code>bundle install\n</code></pre>\n\n<p>This will rebuild your full Gem Stack and should be able to create a working Gemfile.lock</p>\n"}, {"tags": [], "owner": {"reputation": 45322, "user_id": 421705, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/581b1760881c962648f99d6040d41829?s=128&d=identicon&r=PG", "display_name": "Holger Just", "link": "https://stackoverflow.com/users/421705/holger-just"}, "is_accepted": true, "score": 3, "last_activity_date": 1544030536, "creation_date": 1544030536, "answer_id": 53637620, "question_id": 53637109, "link": "https://stackoverflow.com/questions/53637109/how-to-downgrande-a-gem-in-the-gemfile/53637620#53637620", "title": "How to downgrande a gem in the gemfile?", "body": "<p>You need to just call </p>\n\n<pre><code>bundle update sequel\n</code></pre>\n\n<p>without the <code>bundle exec</code> in front.</p>\n\n<p>The issue you experienced is caused by <code>bundle exec</code> evaluating your current <code>Gemfile</code> for executing the latter command first. Here, it finds the difference between the specified gems in the <code>Gemfile</code> and your current <code>Gemfile.lock</code> and bails out.</p>\n\n<p>In general, no bundle calls need to ever be prefixed with a <code>bundle exec</code>.</p>\n"}], "owner": {"reputation": 2159, "user_id": 4898937, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/iwgDT.jpg?s=128&g=1", "display_name": "ciaoben", "link": "https://stackoverflow.com/users/4898937/ciaoben"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 68, "favorite_count": 0, "accepted_answer_id": 53637620, "answer_count": 2, "score": 1, "last_activity_date": 1544030536, "creation_date": 1544028727, "question_id": 53637109, "link": "https://stackoverflow.com/questions/53637109/how-to-downgrande-a-gem-in-the-gemfile", "title": "How to downgrande a gem in the gemfile?", "body": "<p>I have this in my Gemfile.lock   </p>\n\n<pre><code> sequel (5.15.0)\n</code></pre>\n\n<p>I want to downgrade the gem version to the 4.39.0 so I go in my Gemfile and add a version next to the gem declaration:</p>\n\n<pre><code>gem 'sequel', '4.39.0'\n</code></pre>\n\n<p>and run <code>bundle exec bundle install</code></p>\n\n<p>But it gives me:</p>\n\n<pre><code>You have requested:\n  sequel = 4.39.0\n\nThe bundle currently has sequel locked at 5.15.0.\nTry running `bundle update sequel`\n\nIf you are updating multiple gems in your Gemfile at once,\ntry passing them all to `bundle update`\nRun `bundle install` to install missing gems\n</code></pre>\n\n<p>.\nSo I try to run <code>bundle exec bundle update sequel</code> but it returns me the same message. \nHow can I downgrade the gem?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "reactjs", "react-rails"], "comments": [{"owner": {"reputation": 3811, "user_id": 793330, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/432566b982c73ead26d886951ca7a05c?s=128&d=identicon&r=PG", "display_name": "engineerDave", "link": "https://stackoverflow.com/users/793330/engineerdave"}, "edited": false, "score": 0, "creation_date": 1544033793, "post_id": 53636425, "comment_id": 94136413, "body": "although you can do the count on the rails side, it might be more flexible to just pass the object itself which will call it&#39;s to_json method. Then you can do the opertions on the JS side, e.g. this.props.data.length vs @users.count"}], "answers": [{"tags": [], "owner": {"reputation": 2034, "user_id": 9897223, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O1Nan.png?s=128&g=1", "display_name": "Sumanth Madishetty", "link": "https://stackoverflow.com/users/9897223/sumanth-madishetty"}, "is_accepted": false, "score": 0, "last_activity_date": 1544029632, "creation_date": 1544029632, "answer_id": 53637377, "question_id": 53636425, "link": "https://stackoverflow.com/questions/53636425/creating-react-components-from-array-data/53637377#53637377", "title": "Creating react components from array data", "body": "<p>It is a good practice to have array of objects and iterate through that to return multiple similar components. you are using instance of user to get the count so it would be fine if you have them in controller</p>\n"}], "owner": {"reputation": 1583, "user_id": 5253108, "user_type": "registered", "accept_rate": 59, "profile_image": "https://i.stack.imgur.com/o5DQ1.jpg?s=128&g=1", "display_name": "Trenton Tyler", "link": "https://stackoverflow.com/users/5253108/trenton-tyler"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 132, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1544029632, "creation_date": 1544026478, "question_id": 53636425, "link": "https://stackoverflow.com/questions/53636425/creating-react-components-from-array-data", "title": "Creating react components from array data", "body": "<p>I am creating a fairly simple stats page for a dashboard in my rails application. I am using react-rails to create react components in my app and have one for a stat card. <a href=\"https://i.stack.imgur.com/U9sXC.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/U9sXC.png\" alt=\"enter image description here\"></a></p>\n\n<p>For these cards I have created a very simple react component</p>\n\n<pre><code>import React from \"react\";\nimport PropTypes from \"prop-types\";\nclass StatCard extends React.Component {\n  render() {\n    const { title, data } = this.props;\n    return (\n      &lt;React.Fragment&gt;\n        &lt;div className=\"card\"&gt;\n          &lt;div className=\"card-body\"&gt;\n            &lt;div className=\"row align-items-center\"&gt;\n              &lt;div className=\"col\"&gt;\n                &lt;h6 className=\"card-title text-uppercase text-muted mb-2\"&gt;\n                  {title}\n                &lt;/h6&gt;\n\n                &lt;span className=\"h2 mb-0\"&gt;{data}&lt;/span&gt;\n              &lt;/div&gt;\n              &lt;div className=\"col-auto\"&gt;\n                &lt;span className=\"h2 fe fe-briefcase text-muted mb-0\" /&gt;\n              &lt;/div&gt;\n            &lt;/div&gt;\n          &lt;/div&gt;\n        &lt;/div&gt;\n      &lt;/React.Fragment&gt;\n    );\n  }\n}\n\nStatCard.propTypes = {\n  title: PropTypes.string,\n  data: PropTypes.integer\n};\nexport default StatCard;\n</code></pre>\n\n<p>In my html page right now I have 4 different components listed by calling this 4 different types with different data and a different title.</p>\n\n<pre><code>&lt;%= react_component(\"StatCard\", {title: 'Total users', data: @users.count }) %&gt;\n</code></pre>\n\n<p>Would the best practice be to list an array of objects with this data listed and iterate over that and generate those components that way? If so, would this be data be best in the model or the controller? </p>\n\n<p>The data structure might look something like this.</p>\n\n<pre><code>data = [\n  { title: 'Total users', data: @users.count },\n  { title: 'Total questions', data: @questions.count }\n]\n</code></pre>\n"}, {"tags": ["ruby", "heroku", "jekyll"], "comments": [{"owner": {"reputation": 2256, "user_id": 4906586, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/wSTXo.jpg?s=128&g=1", "display_name": "Al-un", "link": "https://stackoverflow.com/users/4906586/al-un"}, "edited": false, "score": 0, "creation_date": 1544626877, "post_id": 53636033, "comment_id": 94343948, "body": "Cool that you found the error! Maybe you could close this question by writing a self-answer and mark your answer. It could also help other!"}], "answers": [{"tags": [], "owner": {"reputation": 53, "user_id": 6004845, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eec144fe8ee5c6cb547d84381dfb6d?s=128&d=identicon&r=PG&f=1", "display_name": "ge0rg", "link": "https://stackoverflow.com/users/6004845/ge0rg"}, "is_accepted": false, "score": 0, "last_activity_date": 1544717327, "creation_date": 1544717327, "answer_id": 53765860, "question_id": 53636033, "link": "https://stackoverflow.com/questions/53636033/assets-and-css-not-working-on-heroku-but-work-on-github-pages/53765860#53765860", "title": "Assets and CSS not working on Heroku, but work on github pages", "body": "<p>I solved the problem by adjusting the following in _config.yml:</p>\n\n<pre><code>baseurl: \"\"\nurl: \"https://hidden-escarpment-98567.herokuapp.com\"\n</code></pre>\n\n<p>so that Jekyll would be able to find main.css and all the assets.</p>\n"}], "owner": {"reputation": 53, "user_id": 6004845, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eec144fe8ee5c6cb547d84381dfb6d?s=128&d=identicon&r=PG&f=1", "display_name": "ge0rg", "link": "https://stackoverflow.com/users/6004845/ge0rg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 66, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1544717327, "creation_date": 1544025047, "last_edit_date": 1544031009, "question_id": 53636033, "link": "https://stackoverflow.com/questions/53636033/assets-and-css-not-working-on-heroku-but-work-on-github-pages", "title": "Assets and CSS not working on Heroku, but work on github pages", "body": "<p>I have built a website and have until now hosted it on github pages:\n<a href=\"https://ge00rg.github.io/website/\" rel=\"nofollow noreferrer\">https://ge00rg.github.io/website/</a>\nHere is the link to the repo in case you want to take a look at the files:\n<a href=\"https://github.com/ge00rg/website\" rel=\"nofollow noreferrer\">https://github.com/ge00rg/website</a></p>\n\n<p>Now I want to move it to heroku. The site does deploy, but does not get displayed correctly, as you can see here:\n<a href=\"https://hidden-escarpment-98567.herokuapp.com/\" rel=\"nofollow noreferrer\">https://hidden-escarpment-98567.herokuapp.com/</a></p>\n\n<p>It seems like the assets and CSS are somehow not linked correctly, but I can't figure out why.</p>\n\n<p>EDIT: Never mind, found the error. I just needed to configure the _config.yml differently and set</p>\n\n<pre><code>baseurl: \"\"\nurl: \"https://hidden-escarpment-98567.herokuapp.com\"\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "postgresql", "activerecord"], "comments": [{"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1544028064, "post_id": 53635819, "comment_id": 94133530, "body": "Maybe a trigram with an appropriate threshold could get you close? <a href=\"https://github.com/Casecommons/pg_search#threshold\" rel=\"nofollow noreferrer\">github.com/Casecommons/pg_search#threshold</a>"}, {"owner": {"reputation": 763, "user_id": 2679301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8b83c0e9fed62d90353b411bc48b0e0f?s=128&d=identicon&r=PG", "display_name": "Guillaume", "link": "https://stackoverflow.com/users/2679301/guillaume"}, "reply_to_user": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1544042246, "post_id": 53635819, "comment_id": 94140174, "body": "The problem with the threshold is I will have other movies I dont want because they dont really match with the query"}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1544042669, "post_id": 53635819, "comment_id": 94140349, "body": "It would be a balancing act for sure to determine exactly where you would want a returned movie and where you would not. Unfortunately there does not appear to be a full text wildcard search option. <a href=\"https://www.depesz.com/2011/02/19/waiting-for-9-1-faster-likeilike/\" rel=\"nofollow noreferrer\">depesz.com/2011/02/19/waiting-for-9-1-faster-likeilike</a>"}], "owner": {"reputation": 763, "user_id": 2679301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8b83c0e9fed62d90353b411bc48b0e0f?s=128&d=identicon&r=PG", "display_name": "Guillaume", "link": "https://stackoverflow.com/users/2679301/guillaume"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 117, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1544036546, "creation_date": 1544024392, "question_id": 53635819, "link": "https://stackoverflow.com/questions/53635819/only-matching-start-word-with-pgsearch-on-rails", "title": "Only matching start word with PgSearch on Rails", "body": "<p>My current scope <code>pg_search</code> scope looks like this </p>\n\n<pre><code>pg_search_scope :search_by_title, against: :original_title,\n                associated_against: { movie_translations: [:title] },\n                ignoring: :accents, using: { tsearch: { any_word: true, prefix: true } }\n</code></pre>\n\n<p>For now I\u2019m only able to find movies if the start_word matches with my query</p>\n\n<pre><code>Movie.create(original_title: \"Bohemian Rapsody\")\nMovie.search_by_title(\"bohe\")\n=&gt; [Movie id 1, original_title: \"Bohemian Rapsody\"]\nMovie.search_by_title(\"Rap\")\n=&gt; [Movie id 1, original_title: \"Bohemian Rapsody\"]\n</code></pre>\n\n<p>I would like to return the movies even if the word does not start with my query but for now it's return empty</p>\n\n<pre><code>Movie.search_by_title(\"hemian\")\n=&gt; []\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 2572, "user_id": 2862049, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffd65bc37e559c2c407f064f308828a4?s=128&d=identicon&r=PG&f=1", "display_name": "Lukas Baliak", "link": "https://stackoverflow.com/users/2862049/lukas-baliak"}, "edited": false, "score": 1, "creation_date": 1544024121, "post_id": 53635389, "comment_id": 94131158, "body": "Why use SQL in this case ? You can simply use <code>Client.find(1)</code>"}], "answers": [{"comments": [{"owner": {"reputation": 1217, "user_id": 10430642, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/p5jzL.jpg?s=128&g=1", "display_name": "Dimitrius Lachi", "link": "https://stackoverflow.com/users/10430642/dimitrius-lachi"}, "reply_to_user": {"reputation": 2572, "user_id": 2862049, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffd65bc37e559c2c407f064f308828a4?s=128&d=identicon&r=PG&f=1", "display_name": "Lukas Baliak", "link": "https://stackoverflow.com/users/2862049/lukas-baliak"}, "edited": false, "score": 1, "creation_date": 1544024099, "post_id": 53635490, "comment_id": 94131142, "body": "No, the returning is a SqlAdapter::Result. Suposing he using mysql, the result will be: <code>Mysql2::Result:0x00000004be4b60</code>"}], "tags": [], "owner": {"reputation": 1217, "user_id": 10430642, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/p5jzL.jpg?s=128&g=1", "display_name": "Dimitrius Lachi", "link": "https://stackoverflow.com/users/10430642/dimitrius-lachi"}, "is_accepted": false, "score": 0, "last_activity_date": 1544024050, "last_edit_date": 1544024050, "creation_date": 1544023334, "answer_id": 53635490, "question_id": 53635389, "link": "https://stackoverflow.com/questions/53635389/how-to-retrieve-column-data-from-ruby-object-returned-from-sql-query/53635490#53635490", "title": "How to retrieve column data from ruby object returned from sql query?", "body": "<p>You executing the method <code>.id</code> for a hash (the return of  <code>ActiveRecord::Base.connection.execute(sql)</code>), Hashes instances don't have this method.\nThis method will return for you a sql Result, you can access the client attriubutes executing:</p>\n\n<pre><code>records_array.first\n</code></pre>\n\n<p>This will return for you a array of attributes of the finded client:</p>\n\n<pre><code>[1, 'Client name', 'Client birthday']\n</code></pre>\n\n<p>I strongly recommend you to use a <code>.find</code> method from the class <code>Client</code> if you using <code>ActiveRecord</code> </p>\n"}, {"tags": [], "owner": {"reputation": 146, "user_id": 2210124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/880aa14dfcae3b1d1b65cc3814337225?s=128&d=identicon&r=PG", "display_name": "wcpaez", "link": "https://stackoverflow.com/users/2210124/wcpaez"}, "is_accepted": false, "score": 0, "last_activity_date": 1544023506, "creation_date": 1544023506, "answer_id": 53635554, "question_id": 53635389, "link": "https://stackoverflow.com/questions/53635389/how-to-retrieve-column-data-from-ruby-object-returned-from-sql-query/53635554#53635554", "title": "How to retrieve column data from ruby object returned from sql query?", "body": "<p>Always try to guess what method can help you. When you write <code>record_arrays.methods</code> it returns a list of available methods that can help you.  For example, <code>records_array.column_values(0)</code> it is going to return all values from the first column, in this case maybe the list of all client ids, another method is <code>records_array.values</code>. You can check what method can help you.</p>\n"}], "owner": {"reputation": 19, "user_id": 10707598, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a7513436291d6c1798fd86d390fa7522?s=128&d=identicon&r=PG&f=1", "display_name": "user10707598", "link": "https://stackoverflow.com/users/10707598/user10707598"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 536, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1544024050, "creation_date": 1544022968, "last_edit_date": 1544023338, "question_id": 53635389, "link": "https://stackoverflow.com/questions/53635389/how-to-retrieve-column-data-from-ruby-object-returned-from-sql-query", "title": "How to retrieve column data from ruby object returned from sql query?", "body": "<pre><code> sql = \"Select * from clients where id=1\"\n        records_array = ActiveRecord::Base.connection.execute(sql)\n       puts(records_array.id)\n</code></pre>\n\n<p>I get an error if even though the query should contain an object with an id</p>\n\n<p>NoMethodError (undefined method `id' for #):</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "sorting"], "comments": [{"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 1, "creation_date": 1544020788, "post_id": 53634636, "comment_id": 94128950, "body": "Those are not string keys, btw."}], "answers": [{"comments": [{"owner": {"reputation": 6039, "user_id": 2137458, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8cfca832ee746f3e3d9971148f52dc64?s=128&d=identicon&r=PG", "display_name": "NM Pennypacker", "link": "https://stackoverflow.com/users/2137458/nm-pennypacker"}, "edited": false, "score": 0, "creation_date": 1544020900, "post_id": 53634723, "comment_id": 94129012, "body": "This is a clean solution. +1"}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 1, "creation_date": 1544021072, "post_id": 53634723, "comment_id": 94129152, "body": "for compatibility purposes. Prior to ruby 2.5.0 (<code>Hash#slice</code>) you could use <code>priority.zip(hash.values_at(*priority)).to_h</code> or even older (ruby &lt; 2.1) <code>Hash[priority.zip(hash.values_at(*priority))]</code>"}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "reply_to_user": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1544021163, "post_id": 53634723, "comment_id": 94129213, "body": "@engineersmnky: this is tagged with [ruby-on-rails]. I think activesupport had Hash#slice for ages."}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 1, "creation_date": 1544021264, "post_id": 53634723, "comment_id": 94129284, "body": "@SergioTulentsev you are correct back to 3.0.0 (although the implementation leaves a bit to be desired IMO) and while tagged rails nothing in this question appears to be rails specific"}], "tags": [], "owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "is_accepted": true, "score": 7, "last_activity_date": 1544020741, "creation_date": 1544020741, "answer_id": 53634723, "question_id": 53634636, "link": "https://stackoverflow.com/questions/53634636/how-can-i-sort-ruby-hash-with-string-key-by-setting-priority-to-the-key-elements/53634723#53634723", "title": "How can I sort ruby hash with string key by setting priority to the key elements?", "body": "<p>If your priority array contains all of the hash keys, you don't need sorting. You can simply take the hash apart and construct a new one.</p>\n\n<pre><code>hash = {\n  red: { something: ''},\n  green: { something: '' },\n  yellow: { something: ''}\n}\n\npriority = %i[green yellow red]\n\nhash.slice(*priority)\n# =&gt; {:green=&gt;{:something=&gt;\"\"}, :yellow=&gt;{:something=&gt;\"\"}, :red=&gt;{:something=&gt;\"\"}}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 2, "creation_date": 1544025135, "post_id": 53635021, "comment_id": 94131771, "body": "You could also use the methods provided above e.g. <code>Hash#slice</code> in combination with <code>Hash#merge</code> like <code>h.slice(*p).merge(h) {|_,o,_| o}</code>. Also <code>Array#index</code> returns nil if the element does not exist so <code>p.index(k) || -1</code> removes the need for the ternary and the need to traverse the <code>Array</code> twice"}, {"owner": {"reputation": 18548, "user_id": 4082052, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GUNps.jpg?s=128&g=1", "display_name": "Sundeep", "link": "https://stackoverflow.com/users/4082052/sundeep"}, "reply_to_user": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1544026132, "post_id": 53635021, "comment_id": 94132379, "body": "@engineersmnky thanks a lot, <code>p.index(k) || -1</code> is good to know, I&#39;ve been using ternary like this in elsewhere too.. need to understand <code>slice+merge</code> though, also I feel that could be added to accepted answer..."}], "tags": [], "owner": {"reputation": 18548, "user_id": 4082052, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GUNps.jpg?s=128&g=1", "display_name": "Sundeep", "link": "https://stackoverflow.com/users/4082052/sundeep"}, "is_accepted": false, "score": 4, "last_activity_date": 1544025903, "last_edit_date": 1544025903, "creation_date": 1544021699, "answer_id": 53635021, "question_id": 53634636, "link": "https://stackoverflow.com/questions/53634636/how-can-i-sort-ruby-hash-with-string-key-by-setting-priority-to-the-key-elements/53635021#53635021", "title": "How can I sort ruby hash with string key by setting priority to the key elements?", "body": "<p>If there are keys in the hash not included in priority array:</p>\n\n<pre><code>&gt;&gt; h = {red: 512, green: 63, yellow: 99, foo: 42, baz: 'hi'}\n=&gt; {:red=&gt;512, :green=&gt;63, :yellow=&gt;99, :foo=&gt;42, :baz=&gt;\"hi\"}\n&gt;&gt; p = %i[green yellow red]\n=&gt; [:green, :yellow, :red]\n\n# this puts keys not in array at start\n# h.sort_by { |k, v| p.include?(k) ? p.index(k) : -1 }\n&gt;&gt; h.sort_by { |k, v| p.index(k) || -1 }\n=&gt; [[:foo, 42], [:baz, \"hi\"], [:green, 63], [:yellow, 99], [:red, 512]]\n\n# this puts keys not in array at end\n# h.sort_by { |k, v| p.include?(k) ? p.index(k) : p.size }\n&gt;&gt; h.sort_by { |k, v| p.index(k) || p.size }\n=&gt; [[:green, 63], [:yellow, 99], [:red, 512], [:foo, 42], [:baz, \"hi\"]]\n</code></pre>\n\n<p>Use <code>to_h</code> method on result to convert to <code>hash</code></p>\n"}, {"comments": [{"owner": {"reputation": 3523, "user_id": 9043475, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FNxvn.jpg?s=128&g=1", "display_name": "Rajagopalan", "link": "https://stackoverflow.com/users/9043475/rajagopalan"}, "reply_to_user": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1544082143, "post_id": 53635233, "comment_id": 94151678, "body": "@CarySwoveland Thank you very much. I want to give some credit to your answer, Can I undelete my question? Can you post this answer, I will accept it?"}, {"owner": {"reputation": 3523, "user_id": 9043475, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FNxvn.jpg?s=128&g=1", "display_name": "Rajagopalan", "link": "https://stackoverflow.com/users/9043475/rajagopalan"}, "reply_to_user": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1544082691, "post_id": 53635233, "comment_id": 94151930, "body": "@CarySwoveland Okay, thank you very much. I started getting downvotes so deleted my question actually. I would like to thank you for catching my question and answering here. Thanks."}, {"owner": {"reputation": 3523, "user_id": 9043475, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FNxvn.jpg?s=128&g=1", "display_name": "Rajagopalan", "link": "https://stackoverflow.com/users/9043475/rajagopalan"}, "reply_to_user": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1544084229, "post_id": 53635233, "comment_id": 94152602, "body": "@CarySwoveland Yes, copied. You can delete now."}], "tags": [], "owner": {"reputation": 3523, "user_id": 9043475, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FNxvn.jpg?s=128&g=1", "display_name": "Rajagopalan", "link": "https://stackoverflow.com/users/9043475/rajagopalan"}, "is_accepted": false, "score": 0, "last_activity_date": 1544022434, "creation_date": 1544022434, "answer_id": 53635233, "question_id": 53634636, "link": "https://stackoverflow.com/questions/53634636/how-can-i-sort-ruby-hash-with-string-key-by-setting-priority-to-the-key-elements/53635233#53635233", "title": "How can I sort ruby hash with string key by setting priority to the key elements?", "body": "<pre><code>hash = {\n    'red': { something: ''},\n    'green': { something: '' },\n    'yellow': { something: ''}\n}\n</code></pre>\n\n<p>Code</p>\n\n<pre><code>p ['green', 'yellow', 'red'].map{|value|[value.to_sym,hash[value.to_sym]]}.to_h\n</code></pre>\n\n<p>output</p>\n\n<pre><code>{:green=&gt;{:something=&gt;\"\"}, :yellow=&gt;{:something=&gt;\"\"}, :red=&gt;{:something=&gt;\"\"}}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 5060, "user_id": 10522579, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7GQ6a.jpg?s=128&g=1", "display_name": "ray", "link": "https://stackoverflow.com/users/10522579/ray"}, "is_accepted": false, "score": 0, "last_activity_date": 1544186761, "creation_date": 1544186761, "answer_id": 53669855, "question_id": 53634636, "link": "https://stackoverflow.com/questions/53634636/how-can-i-sort-ruby-hash-with-string-key-by-setting-priority-to-the-key-elements/53669855#53669855", "title": "How can I sort ruby hash with string key by setting priority to the key elements?", "body": "<p>Following will also work,</p>\n\n<pre><code>priority = %i(:green yellow red)\n\npriority.inject({}) { |m, v| m[v] = hash[v]; m }\n</code></pre>\n"}], "owner": {"reputation": 685, "user_id": 4899057, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-ocrp7ClEgE0/AAAAAAAAAAI/AAAAAAAAAGc/ZRb4SBwuPWw/photo.jpg?sz=128", "display_name": "Evan Ross", "link": "https://stackoverflow.com/users/4899057/evan-ross"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 243, "favorite_count": 0, "accepted_answer_id": 53634723, "answer_count": 4, "score": 1, "last_activity_date": 1544186761, "creation_date": 1544020435, "last_edit_date": 1544020805, "question_id": 53634636, "link": "https://stackoverflow.com/questions/53634636/how-can-i-sort-ruby-hash-with-string-key-by-setting-priority-to-the-key-elements", "title": "How can I sort ruby hash with string key by setting priority to the key elements?", "body": "<p>I have a hash with the following values:</p>\n\n<pre><code>hash = {\n  'red': { something: ''},\n  'green': { something: '' },\n  'yellow': { something: ''}\n}\n</code></pre>\n\n<p>What is the simplest way to do something like this:</p>\n\n<pre><code>hash.sort_by_key_with_priority(['green', 'yellow', 'red'])\n</code></pre>\n\n<p>And return:</p>\n\n<pre><code>hash = {\n  'green': { something: '' },\n  'yellow': { something: ''},\n  'red': { something: ''},\n}\n</code></pre>\n"}, {"tags": ["ruby", "amazon-web-services", "aws-lambda", "bundler"], "comments": [{"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 3, "creation_date": 1544021932, "post_id": 53634260, "comment_id": 94129753, "body": "well you bundled under 2.3.0 and are running under 2.5.0 this could be a good place to start"}], "answers": [{"tags": [], "owner": {"reputation": 497, "user_id": 3570772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3e1365aa0a88beddb903548f660a7cd3?s=128&d=identicon&r=PG", "display_name": "Casao", "link": "https://stackoverflow.com/users/3570772/casao"}, "is_accepted": false, "score": 13, "last_activity_date": 1544024411, "creation_date": 1544024411, "answer_id": 53635824, "question_id": 53634260, "link": "https://stackoverflow.com/questions/53634260/how-can-i-get-my-aws-lambda-to-access-gems-stored-in-vendor-bundle/53635824#53635824", "title": "How can I get my AWS Lambda to access gems stored in vendor/bundle?", "body": "<p>You need to make sure the version of Ruby you used locally to bundle matches the version used by Lambda. </p>\n\n<p>Your zip appears to have the gems installed in 2.3.0 but your stack trace lists 2.5.0. This mismatch means lambda runner can\u2019t find your gems. </p>\n"}, {"comments": [{"owner": {"reputation": 523, "user_id": 615138, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uzcMl.jpg?s=128&g=1", "display_name": "etagwerker", "link": "https://stackoverflow.com/users/615138/etagwerker"}, "edited": false, "score": 2, "creation_date": 1546747580, "post_id": 53698808, "comment_id": 94950862, "body": "I ran into a similar issue when trying to use a gem from GitHub (<code>master</code> branch). It seems that the path to my gem was not the same one, it was under: <code>.&#47;vendor&#47;bundle&#47;ruby&#47;2.5.0&#47;bundler&#47;gems&#47;</code>. That means that I had to tweak those two lines so that it looks like this: <code>load_paths = Dir[&quot;.&#47;vendor&#47;bundle&#47;ruby&#47;2.5.0&#47;bundler&#47;gems&#47;**&#47;lib&quot;]</code>. I don&#39;t know if it makes a difference: I was using <code>bundler</code> version 2.0.1."}, {"owner": {"reputation": 402, "user_id": 6068782, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e897e46b7089e645f40d3c1bb58894d?s=128&d=identicon&r=PG", "display_name": "Master of Ducks", "link": "https://stackoverflow.com/users/6068782/master-of-ducks"}, "edited": false, "score": 0, "creation_date": 1554911479, "post_id": 53698808, "comment_id": 97926695, "body": "I needed this <i>AND</i> the <code>2.3</code> -&gt; <code>2.5</code> answer."}, {"owner": {"reputation": 5213, "user_id": 677322, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e4c941f8a884c37a92a2a7084b3fca3d?s=128&d=identicon&r=PG", "display_name": "ryanjones", "link": "https://stackoverflow.com/users/677322/ryanjones"}, "edited": false, "score": 1, "creation_date": 1563042164, "post_id": 53698808, "comment_id": 100573860, "body": "For those looking for a simple example, you can find one here: <a href=\"https://github.com/ryanjones/ruby_lambda_layers\" rel=\"nofollow noreferrer\">github.com/ryanjones/ruby_lambda_layers</a>"}], "tags": [], "owner": {"reputation": 5213, "user_id": 677322, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e4c941f8a884c37a92a2a7084b3fca3d?s=128&d=identicon&r=PG", "display_name": "ryanjones", "link": "https://stackoverflow.com/users/677322/ryanjones"}, "is_accepted": false, "score": 16, "last_activity_date": 1544409569, "creation_date": 1544409569, "answer_id": 53698808, "question_id": 53634260, "link": "https://stackoverflow.com/questions/53634260/how-can-i-get-my-aws-lambda-to-access-gems-stored-in-vendor-bundle/53698808#53698808", "title": "How can I get my AWS Lambda to access gems stored in vendor/bundle?", "body": "<p>I ran into this same problem when building AWS Lambda Layers w/ Ruby. A quick and easy way to get this to work is to add all of the gem paths to Ruby's $LOAD_PATH in your AWS Lambda. IE:</p>\n\n<pre><code>load_paths = Dir[\"/opt/ruby/gems/2.5.0/**/lib\"]\n$LOAD_PATH.unshift(*load_paths)\n\nrequire 'webhook'\n</code></pre>\n\n<p>Replace <code>\"/opt/ruby/gems/2.5.0/**/lib\"</code> with <code>\"./vendor/bundle/ruby/2.3.0/gems/**/lib\"</code> in your case.</p>\n\n<p>When you do <code>require 'webhook'</code> it's going to go and look through all of the paths and come across <code>\"./vendor/bundle/ruby/2.3.0/gems/webhook-1.0.0/lib/webhook.rb\"</code> and add it into your AWS Lambda. <code>require</code> doesn't require a file extension.</p>\n\n<p>When we run rails through bundler it does a bunch of 'magic' for us including making sure that our $LOAD_PATH is pointing at the gems. Since AWS Lambdas don't use bundler, we need to do some of this 'magic' ourselves.</p>\n"}, {"tags": [], "owner": {"reputation": 1940, "user_id": 1880920, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HnZWe.jpg?s=128&g=1", "display_name": "Jonathan Vukovich-Tribouharet", "link": "https://stackoverflow.com/users/1880920/jonathan-vukovich-tribouharet"}, "is_accepted": false, "score": 2, "last_activity_date": 1581883923, "creation_date": 1581883923, "answer_id": 60252767, "question_id": 53634260, "link": "https://stackoverflow.com/questions/53634260/how-can-i-get-my-aws-lambda-to-access-gems-stored-in-vendor-bundle/60252767#60252767", "title": "How can I get my AWS Lambda to access gems stored in vendor/bundle?", "body": "<p>I think you should not change the GEM_PATH or having to set <code>$LOAD_PATH</code> in every lambda functions.\nThe \"best\" way is to do this little hack when you create the layer archive:</p>\n\n<pre><code>bundle install --path vendor/bundle\ncd vendor/bundle\nmkdir ruby/gems\nmv ruby/2.5.0 ruby/gems/\nzip -r layer.zip ruby/gems/2.5.0/\n</code></pre>\n"}], "owner": {"reputation": 1182, "user_id": 3217364, "user_type": "registered", "accept_rate": 72, "profile_image": "https://graph.facebook.com/1114080969/picture?type=large", "display_name": "Csteele5", "link": "https://stackoverflow.com/users/3217364/csteele5"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4819, "favorite_count": 4, "answer_count": 3, "score": 13, "last_activity_date": 1581883923, "creation_date": 1544019169, "question_id": 53634260, "link": "https://stackoverflow.com/questions/53634260/how-can-i-get-my-aws-lambda-to-access-gems-stored-in-vendor-bundle", "title": "How can I get my AWS Lambda to access gems stored in vendor/bundle?", "body": "<p>I'm writing a Lambda function in Ruby which will eventually send me some notifications in Slack via Webhook.  So what I have for my <code>lambda_function</code> file is </p>\n\n<pre><code>require 'json'\nrequire 'webhook'\n\ndef lambda_handler(event:, context:)\n    # TODO implement\n    { statusCode: 200, body: JSON.generate('Hello from Lambda!') }\n    Webhook.post('https://mywebhookurl', {message: 'test'})\nend\n</code></pre>\n\n<p>And the directory structure in my inline code editor looks like this:</p>\n\n<pre><code>Gemfile\nGemfile.lock\nlambda_function.rb\nvendor/\n  bundle/\n    ruby\n      2.3.0\n        gems/webhook\n</code></pre>\n\n<p>also under the <code>2.3.0</code> bath are several other folders including <code>build_info</code>,  <code>cache</code>, <code>doc</code> etc.  In order to get this code onto AWS Lambda, I'm running </p>\n\n<p><code>zip -r myLambda.zip *</code> to get everything into a zip file and uploaded to Lambda.</p>\n\n<p>However, when I finally go to run a basic test on the lambda, I get the following error:</p>\n\n<pre><code>{\n  \"errorMessage\": \"cannot load such file -- webhook\",\n  \"errorType\": \"Init&lt;LoadError&gt;\",\n  \"stackTrace\": [\n    \"/var/lang/lib/ruby/2.5.0/rubygems/core_ext/kernel_require.rb:59:in `require'\",\n    \"/var/lang/lib/ruby/2.5.0/rubygems/core_ext/kernel_require.rb:59:in `require'\",\n    \"/var/task/lambda_function.rb:2:in `&lt;top (required)&gt;'\",\n    \"/var/lang/lib/ruby/2.5.0/rubygems/core_ext/kernel_require.rb:59:in `require'\",\n    \"/var/lang/lib/ruby/2.5.0/rubygems/core_ext/kernel_require.rb:59:in `require'\"\n  ]\n}\n</code></pre>\n\n<p>There shouldn't be any more to this as the <a href=\"https://docs.aws.amazon.com/lambda/latest/dg/ruby-package.html#ruby-package-dependencies\" rel=\"noreferrer\">following tutorial</a> shows exactly how to set up what I have, but doesn't work.  Does anyone have success pulling gems from their gemfile in AWS Lambda?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "jenkins", "rspec", "jruby"], "comments": [{"owner": {"reputation": 1217, "user_id": 10430642, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/p5jzL.jpg?s=128&g=1", "display_name": "Dimitrius Lachi", "link": "https://stackoverflow.com/users/10430642/dimitrius-lachi"}, "edited": false, "score": 0, "creation_date": 1544022782, "post_id": 53634232, "comment_id": 94130315, "body": "Can you post your failed spec file? Seems to be a Jenkins config issue"}, {"owner": {"reputation": 3201, "user_id": 2892779, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uvM8S.jpg?s=128&g=1", "display_name": "Jay Dorsey", "link": "https://stackoverflow.com/users/2892779/jay-dorsey"}, "edited": false, "score": 0, "creation_date": 1544057870, "post_id": 53634232, "comment_id": 94145401, "body": "We need to know at a minimum what kind of spec, what error you see, and possibly what kind of gems you have configured for running your test suite. Configuration of database cleaner coupled with feature tests are one common cause of intermittent failing tests."}, {"owner": {"reputation": 2301, "user_id": 19317, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/47035e07012da3162b6e83650ee3abe0?s=128&d=identicon&r=PG", "display_name": "aridlehoover", "link": "https://stackoverflow.com/users/19317/aridlehoover"}, "edited": false, "score": 0, "creation_date": 1544084282, "post_id": 53634232, "comment_id": 94152624, "body": "By default, rspec runs tests in a specific order. But, Jenkins environments are often configured to run the tests in a random order. This can lead to situations like the one you described. Check your Jenkins configuration to see if it calls rspec with the <code>--order</code> option. If so, try running your specs locally with the same option. Or, just try running the tests with <code>rspec --order rand</code>."}], "owner": {"reputation": 31, "user_id": 2987435, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ceec6c2bdc31063f7671d49b66a08f10?s=128&d=identicon&r=PG&f=1", "display_name": "samuraijack", "link": "https://stackoverflow.com/users/2987435/samuraijack"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 33, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1544019046, "creation_date": 1544019046, "question_id": 53634232, "link": "https://stackoverflow.com/questions/53634232/rspec-api-controller-specs-running-with-zero-failures-on-local-server-cli-but-f", "title": "Rspec: API controller specs running with zero failures on local/server CLI but fails some tests in Jenkins CI", "body": "<p>I have a jenkins CI setup configured to run specs on each git push. When I run these specs with \"rspec\" on my local it works fine with zero failures, also I ran specs on the CLI of jenkins agent the specs ran with zero failures. But when the same specs run in jenkins CI, some cases fail. </p>\n\n<p>I have been trying to figure out the issue but have not found the real reason for this behavior yet.</p>\n\n<p>Can anyone please help with this issue? </p>\n"}, {"tags": ["ruby", "typhoeus"], "answers": [{"tags": [], "owner": {"reputation": 9567, "user_id": 1900722, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/nGsJr.jpg?s=128&g=1", "display_name": "anquegi", "link": "https://stackoverflow.com/users/1900722/anquegi"}, "is_accepted": false, "score": 2, "last_activity_date": 1544022617, "creation_date": 1544022617, "answer_id": 53635287, "question_id": 53633877, "link": "https://stackoverflow.com/questions/53633877/pass-an-array-in-typheus-as-url-param/53635287#53635287", "title": "Pass an array in Typheus as url param", "body": "<p>The problem was using an obsolete thyphoeus gem, this works on actual <a href=\"https://github.com/typhoeus/typhoeus/releases\" rel=\"nofollow noreferrer\">release</a>, and bigger that 1.0.0</p>\n"}], "owner": {"reputation": 9567, "user_id": 1900722, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/nGsJr.jpg?s=128&g=1", "display_name": "anquegi", "link": "https://stackoverflow.com/users/1900722/anquegi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 140, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1544022709, "creation_date": 1544017808, "last_edit_date": 1544022709, "question_id": 53633877, "link": "https://stackoverflow.com/questions/53633877/pass-an-array-in-typheus-as-url-param", "title": "Pass an array in Typheus as url param", "body": "<p>I'm using Typhoeus an want to send an array inside url params. </p>\n\n<p>pass this:</p>\n\n<pre><code>/event?groups[]=open-forum&amp;groups[]=armory-films\n</code></pre>\n\n<p>instead of this:</p>\n\n<pre><code>/event?groups[0]=open-forum&amp;groups[1]=armory-films\n</code></pre>\n\n<p>looking the issues it seem to it is possible thanks to a <a href=\"https://github.com/typhoeus/ethon/commit/548033a8557a48203b7d49f3f98812bd79bc05e4\" rel=\"nofollow noreferrer\">param inside ethon</a>:</p>\n\n<pre><code> params_encoding and takes :rack\n</code></pre>\n\n<p>But how to add that parameter to a typheus request when I add that</p>\n\n<pre><code>Typhoeus::Request.new(endpoint,\n                      method: :put,\n                      headers: HEADERS,\n                      params_encoding: :rack,\n                      params: {\n                        status: 'close',\n                        shutdown_on: I18n.l(closed_at, format: :es),\n                        affected_external_id: reference,\n                        fqdns:fqdns\n                      })\n</code></pre>\n\n<p>I get:</p>\n\n<pre><code>The option: params_encoding is invalid.\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "regex", "gsub"], "comments": [{"owner": {"reputation": 481662, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 1, "creation_date": 1544017517, "post_id": 53633649, "comment_id": 94126841, "body": "Check <a href=\"https://ideone.com/W7XPjo\" rel=\"nofollow noreferrer\">ideone.com/W7XPjo</a>"}, {"owner": {"reputation": 18548, "user_id": 4082052, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GUNps.jpg?s=128&g=1", "display_name": "Sundeep", "link": "https://stackoverflow.com/users/4082052/sundeep"}, "reply_to_user": {"reputation": 481662, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 2, "creation_date": 1544024973, "post_id": 53633649, "comment_id": 94131657, "body": "@WiktorStribi\u017cew if there are keys with overlap on right hand side, for ex: <code>e</code> and <code>er</code>, need to ensure the longer length key comes first... <code>Regexp.union(h.keys.sort_by { |w| -w.length })</code>"}], "answers": [{"comments": [{"owner": {"reputation": 18548, "user_id": 4082052, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GUNps.jpg?s=128&g=1", "display_name": "Sundeep", "link": "https://stackoverflow.com/users/4082052/sundeep"}, "edited": false, "score": 3, "creation_date": 1544022265, "post_id": 53633811, "comment_id": 94129981, "body": "<code>sub</code> and <code>gsub</code> also allow hash as replacement argument.. so you can use <code>s.gsub(&#47;(e|us|i)$&#47;, replacements)</code>"}, {"owner": {"reputation": 57, "user_id": 10192484, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-JvZCXCg8noI/AAAAAAAAAAI/AAAAAAAAAAs/vofhCY8M0MQ/photo.jpg?sz=128", "display_name": "Pandation", "link": "https://stackoverflow.com/users/10192484/pandation"}, "edited": false, "score": 0, "creation_date": 1544042237, "post_id": 53633811, "comment_id": 94140171, "body": "thanks. In what file that should be defined? I am working on HTML.SLIM, so the peace of code I shared is used in html.slim. Is there a way it can be configured soly in that html.slim file?"}, {"owner": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "edited": false, "score": 1, "creation_date": 1544082753, "post_id": 53633811, "comment_id": 94151960, "body": "I would define this in the model or in a helper as you should avoid placing complex logic in your views. This also makes it much easier to test."}, {"owner": {"reputation": 57, "user_id": 10192484, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-JvZCXCg8noI/AAAAAAAAAAI/AAAAAAAAAAs/vofhCY8M0MQ/photo.jpg?sz=128", "display_name": "Pandation", "link": "https://stackoverflow.com/users/10192484/pandation"}, "reply_to_user": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "edited": false, "score": 0, "creation_date": 1544103099, "post_id": 53633811, "comment_id": 94163300, "body": "@max @mrzasa still not getting it work for multiple records. What I have now in provider_helper.rb is:   <code>module ProvidersHelper    def replacements = {&#39;e&#39;=&gt;&#39;ai&#39;, &#39;us&#39;=&gt;&#39;mi&#39;, &#39;i&#39; =&gt; &#39;as&#39;}     [&#39;surname&#39;, &#39;surnamus&#39;, &#39;surnami&#39;].map do |s|     s.gsub(&#47;(e|us|i)$&#47;){|p| replacements[p] }   end end</code>    And then in html.slim - before I had <code>name: @provider_user.name,</code> now I am trying to use helper: <code>replacements(@provider_user.name),</code>  also the user names comes from the user input, so isnt this line makes putting user names in the code: <code>[\u2018surname&#39;, &#39;surnamus&#39;, &#39;surnami&#39;].map do |s|</code> ?"}, {"owner": {"reputation": 21613, "user_id": 580346, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/ba17945a06aac247b06548d5afe341e8?s=128&d=identicon&r=PG", "display_name": "mrzasa", "link": "https://stackoverflow.com/users/580346/mrzasa"}, "edited": false, "score": 1, "creation_date": 1544103202, "post_id": 53633811, "comment_id": 94163388, "body": "It&#39;s just an example, you need to replace the hardcoded strings with your real surnames"}, {"owner": {"reputation": 57, "user_id": 10192484, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-JvZCXCg8noI/AAAAAAAAAAI/AAAAAAAAAAs/vofhCY8M0MQ/photo.jpg?sz=128", "display_name": "Pandation", "link": "https://stackoverflow.com/users/10192484/pandation"}, "edited": false, "score": 0, "creation_date": 1544106210, "post_id": 53633811, "comment_id": 94165318, "body": "@mrzasa yes, but it is not known what surnames user will register with, I know only the endings (there are only few ending options like us, as, a that are used in the surnames of the language system will operate in ). So should I specify only endings? <code>[\u2018as&#39;, &#39;us&#39;, &#39;a&#39;].map do |s|</code> or should I leave it blank <code>[\u2018&#39;, &#39;&#39;, &#39;&#39;].map do |s|</code> ? Can you also suggest if I am using the helper wrongly in html.slim file?"}, {"owner": {"reputation": 21613, "user_id": 580346, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/ba17945a06aac247b06548d5afe341e8?s=128&d=identicon&r=PG", "display_name": "mrzasa", "link": "https://stackoverflow.com/users/580346/mrzasa"}, "edited": false, "score": 0, "creation_date": 1544106593, "post_id": 53633811, "comment_id": 94165598, "body": "You need to pass the surname entered by user. I cannot suggest you anything more withotu knowing the structure of your app. This seems to be another topic, you ask for this in another question."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 1, "creation_date": 1545894806, "post_id": 53633811, "comment_id": 94721482, "body": "It would be better to construct your regex from the hash <code>replacements</code>, so that if the latter changes you don&#39;t have to manually change your regex. Also, the use of <code>gsub</code> might be confusing to the reader considering that at most one string replacement will be performed. I suggest using <code>sub</code> instead."}], "tags": [], "owner": {"reputation": 21613, "user_id": 580346, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/ba17945a06aac247b06548d5afe341e8?s=128&d=identicon&r=PG", "display_name": "mrzasa", "link": "https://stackoverflow.com/users/580346/mrzasa"}, "is_accepted": true, "score": 4, "last_activity_date": 1544017617, "creation_date": 1544017617, "answer_id": 53633811, "question_id": 53633649, "link": "https://stackoverflow.com/questions/53633649/changing-text-based-on-the-final-letter-of-user-name-using-regular-expression/53633811#53633811", "title": "Changing text based on the final letter of user name using regular expression", "body": "<p>You can use <code>String#gsub</code> with block. <a href=\"https://ruby-doc.org/core-2.1.4/String.html#method-i-gsub\" rel=\"nofollow noreferrer\">Docs</a> say:</p>\n\n<blockquote>\n  <p>In the block form, the current match string is passed in as a parameter, and variables such as $1, $2, $`, $&amp;, and $' will be set appropriately. The value returned by the block will be substituted for the match on each call.</p>\n</blockquote>\n\n<p>So you can use a regex with concatenation of all substrings to be replaced and then replace it in the block, e.g. using a hash that maps matches to replacements.</p>\n\n<p>Full example:</p>\n\n<pre><code>replacements = {'e'=&gt;'ai', 'us'=&gt;'mi', 'i' =&gt; 'as'}\n['surname', 'surnamus', 'surnami'].map do |s| \n  s.gsub(/(e|us|i)$/){|p| replacements[p] }\nend\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "is_accepted": false, "score": 0, "last_activity_date": 1545894402, "creation_date": 1545894402, "answer_id": 53941071, "question_id": 53633649, "link": "https://stackoverflow.com/questions/53633649/changing-text-based-on-the-final-letter-of-user-name-using-regular-expression/53941071#53941071", "title": "Changing text based on the final letter of user name using regular expression", "body": "<p>@Sundeep makes an important observation in a comment on the question. If, for example, the substitutions were give by the following hash:</p>\n\n<pre><code>g = {'e'=&gt;'ai', 's'=&gt;'es', 'us'=&gt;'mi', 'i' =&gt; 'as'}\n  #=&gt; {\"e\"=&gt;\"ai\", \"s\"=&gt;\"es\", \"us\"=&gt;\"mi\", \"i\"=&gt;\"as\"}\n</code></pre>\n\n<p><code>'surnamus'</code> would be converted (incorrectly) to <code>'surnamues'</code> merely because <code>'s'=&gt;'es'</code> precedes <code>'us'=&gt;'mi'</code> in <code>g</code>. That situation may not exist at present, but it may be prudent to allow for it in future, particularly because it is so simple to do so:</p>\n\n<pre><code>h = g.sort_by { |k,_| -k.size }.to_h\n  #=&gt; {\"us\"=&gt;\"mi\", \"e\"=&gt;\"ai\", \"s\"=&gt;\"es\", \"i\"=&gt;\"as\"}\n\narr = ['surname', 'surnamus', 'surnami', 'surnamo']\n</code></pre>\n\n<p>The substitutions can be done using the form of <a href=\"http://ruby-doc.org/core-2.5.1/String.html#method-i-sub\" rel=\"nofollow noreferrer\">String@#sub</a> that employs a hash as its second argument.</p>\n\n<pre><code>r = /#{Regexp.union(h.keys)}\\z/\n  #=&gt; /(?-mix:us|e|s|i)\\z/i\narr.map { |s| s.sub(r,h) }\n  #=&gt; [\"surnamai\", \"surnammi\", \"surnamas\", \"surnamo\"]\n</code></pre>\n\n<p>See also <a href=\"http://ruby-doc.org/core-2.5.1/Regexp.html#method-c-union\" rel=\"nofollow noreferrer\">Regexp::union</a>.</p>\n\n<p>Incidentally, though key-insertion order has been guaranteed for hashes since Ruby v1.9, there is a continuing debate as to whether that property should be made use of in Ruby code, mainly because there was no concept of key order when hashes were first used in computer programs. This answer provides a good example of the benefit of exploiting key order.</p>\n"}], "owner": {"reputation": 57, "user_id": 10192484, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-JvZCXCg8noI/AAAAAAAAAAI/AAAAAAAAAAs/vofhCY8M0MQ/photo.jpg?sz=128", "display_name": "Pandation", "link": "https://stackoverflow.com/users/10192484/pandation"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 73, "favorite_count": 0, "accepted_answer_id": 53633811, "answer_count": 2, "score": 3, "last_activity_date": 1545894402, "creation_date": 1544017088, "last_edit_date": 1544017644, "question_id": 53633649, "link": "https://stackoverflow.com/questions/53633649/changing-text-based-on-the-final-letter-of-user-name-using-regular-expression", "title": "Changing text based on the final letter of user name using regular expression", "body": "<p>I am looking to change the ending of the user name based on the use case (in the language system will operate, names ends depending on how it is used). </p>\n\n<p>So need to define all endings of names and define the replacement for them.\nWas suggested to use .gsub regular expression to search and replace in a string: </p>\n\n<p><a href=\"https://stackoverflow.com/questions/53595868/changing-text-based-on-the-final-letter-of-user-name\">Changing text based on the final letter of user name</a></p>\n\n<pre><code>\"name surname\".gsub(/e\\b/, 'ai')\n</code></pre>\n\n<p>this will replace e with ai, so \"name surname = namai surnamai\". </p>\n\n<p>How can it be used for more options like: \"e = ai, us = mi, i = as\" on the same record?</p>\n\n<p>thanks</p>\n"}, {"tags": ["ruby", "rspec", "rubymine"], "comments": [{"owner": {"reputation": 3523, "user_id": 9043475, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FNxvn.jpg?s=128&g=1", "display_name": "Rajagopalan", "link": "https://stackoverflow.com/users/9043475/rajagopalan"}, "edited": false, "score": 0, "creation_date": 1544017912, "post_id": 53633629, "comment_id": 94127061, "body": "If someone answers your question, then fine, otherwise raise a bug to JetBrains."}, {"owner": {"reputation": 262, "user_id": 1990961, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/2313664b4d314170934871c928938765?s=128&d=identicon&r=PG", "display_name": "Jon Ekdahl", "link": "https://stackoverflow.com/users/1990961/jon-ekdahl"}, "edited": false, "score": 1, "creation_date": 1544559086, "post_id": 53633629, "comment_id": 94316997, "body": "This is the corresponding bug report: <a href=\"https://youtrack.jetbrains.com/issue/RUBY-23205\" rel=\"nofollow noreferrer\">youtrack.jetbrains.com/issue/RUBY-23205</a>. Add your vote if you want this."}], "answers": [{"comments": [{"owner": {"reputation": 343, "user_id": 682038, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f0d3e1cd54a505c5b2c73eb473ecbf25?s=128&d=identicon&r=PG", "display_name": "denBelg", "link": "https://stackoverflow.com/users/682038/denbelg"}, "edited": false, "score": 0, "creation_date": 1544081398, "post_id": 53643283, "comment_id": 94151382, "body": "Sadly enough, it didn&#39;t make any difference."}], "tags": [], "owner": {"reputation": 3201, "user_id": 2892779, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uvM8S.jpg?s=128&g=1", "display_name": "Jay Dorsey", "link": "https://stackoverflow.com/users/2892779/jay-dorsey"}, "is_accepted": false, "score": 0, "last_activity_date": 1544059589, "creation_date": 1544059589, "answer_id": 53643283, "question_id": 53633629, "link": "https://stackoverflow.com/questions/53633629/rubymine-doesnt-regonize-shared-context-variables/53643283#53643283", "title": "Rubymine doesn&#39;t regonize shared context variables", "body": "<p>You might try two things:</p>\n\n<p>Replacing your <code>require</code> with <code>require_relative \"shared_context\"</code> (with the relative path included if they're in different folders, no .rb extension necessary)</p>\n\n<p>Specifying <code>require \"./shared_context\"</code></p>\n"}], "owner": {"reputation": 343, "user_id": 682038, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f0d3e1cd54a505c5b2c73eb473ecbf25?s=128&d=identicon&r=PG", "display_name": "denBelg", "link": "https://stackoverflow.com/users/682038/denbelg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 109, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1544059589, "creation_date": 1544017036, "last_edit_date": 1544059397, "question_id": 53633629, "link": "https://stackoverflow.com/questions/53633629/rubymine-doesnt-regonize-shared-context-variables", "title": "Rubymine doesn&#39;t regonize shared context variables", "body": "<p>I have specs that use variables from a shared context. The set up looks something like this:</p>\n\n<p>shared_context.rb</p>\n\n<pre><code>RSpec.shared_context :handy_things do    \n    let(:handy_object)  { ... }\nend\n</code></pre>\n\n<p>test_spec.rb:</p>\n\n<pre><code>require 'shared_context.rb'\ndescribe 'Something happens' do\n  include_context :handy_things\n\n  before(:each) do\n    handy_object.option = true\n  end\n...\n</code></pre>\n\n<p>The <code>handy_object</code> from the context is not recognized by Rubymine. I get an inspection message 'Cannot find...'.\nThis is not the end of the world but it annoys me. </p>\n\n<p>Is there a way to let Rubymine know the variables of the shared context are accessible everywhere. Or as workaround to add my shared_context variables to some kind of dictionary so Rubymine doesn't flag it as unknown?</p>\n"}, {"tags": ["ruby", "curl", "rest-client"], "answers": [{"tags": [], "owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "is_accepted": true, "score": 0, "last_activity_date": 1544020563, "creation_date": 1544020563, "answer_id": 53634677, "question_id": 53633375, "link": "https://stackoverflow.com/questions/53633375/ruby-request-headers-but-also-a-tag-tag/53634677#53634677", "title": "Ruby request headers but also a ?tag=tag", "body": "<p>You are extremely close, right now this does not work for you because the <code>\"X-Consul-Token\" =&gt; 'AUTH_TOKEN'</code> is being seen as a url parameter and not a header. </p>\n\n<pre><code>req.url \n#=&gt; \"http://example.com?tag=tag&amp;X-Consul-Token=AUTH_TOKEN\"\nreq.headers \n#=&gt; {}\n</code></pre>\n\n<p>To fix this you just need to have params and the other header tags separated:  </p>\n\n<pre><code>req=  RestClient::Request.new(\n  method: :get, \n  url: 'http://example.com/', \n  timeout: 10, \n  headers: {params: {tag: 'tag'},\n           \"X-Consul-Token\" =&gt; 'AUTH_TOKEN'}) #notice outside of params\nreq.url\n#=&gt; \"http://example.com?tag=tag\"\nreq.headers \n#=&gt; {\"X-Consul-Token\"=&gt;\"AUTH_TOKEN\"}\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user9753902"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 20, "favorite_count": 0, "accepted_answer_id": 53634677, "answer_count": 1, "score": 0, "last_activity_date": 1544020563, "creation_date": 1544016206, "question_id": 53633375, "link": "https://stackoverflow.com/questions/53633375/ruby-request-headers-but-also-a-tag-tag", "title": "Ruby request headers but also a ?tag=tag", "body": "<p>I am trying to send an API call to consul using a ruby script and I have a command that should be close to what I need but I can't get the rest to work.</p>\n\n<pre><code>RestClient::Request.execute(method: :get, url: path, timeout: 10, headers: {params: {\"tag\": tag, \"X-Consul-Token\" =&gt; encode_auth_token}})\n</code></pre>\n\n<p>Pretty much I need the call to be like if I did </p>\n\n<p><code>curl --header \"X-Consul-Token: &lt;my token&gt;\" &lt;my path&gt;?tag=tag</code>  where the last tag in <code>?tag=tag</code> is a variable and the token is a variable too. </p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "answers": [{"comments": [{"owner": {"reputation": 53, "user_id": 9450512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16fa02b3bbc00c9733820765abef33c4?s=128&d=identicon&r=PG&f=1", "display_name": "H.Akca", "link": "https://stackoverflow.com/users/9450512/h-akca"}, "edited": false, "score": 0, "creation_date": 1544015357, "post_id": 53633052, "comment_id": 94125541, "body": "thanks for your reply i get this error message No route matches {:action=&gt;&quot;edit&quot;, :controller=&gt;&quot;comments&quot;, :id=&gt;nil, :post_id=&gt;&quot;4&quot;}, missing required keys: [:id]   for this line                   = link_to edit_post_comment_path(@post, comment) do                   %button.btn.btn-primary{:type =&gt; &quot;button&quot;} Primary"}], "tags": [], "owner": {"reputation": 48413, "user_id": 1279683, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1veuT.jpg?s=128&g=1", "display_name": "Marek Lipka", "link": "https://stackoverflow.com/users/1279683/marek-lipka"}, "is_accepted": true, "score": 1, "last_activity_date": 1544015203, "creation_date": 1544015203, "answer_id": 53633052, "question_id": 53632959, "link": "https://stackoverflow.com/questions/53632959/edit-path-for-rails-not-get-correct-url/53633052#53633052", "title": "Edit path for rails not get correct url", "body": "<p>You should pass two arguments into <code>edit_post_comment_path</code> method instead of passing an array, like this:</p>\n\n<pre><code>edit_post_comment_path(@post, comment)\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 53, "user_id": 9450512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16fa02b3bbc00c9733820765abef33c4?s=128&d=identicon&r=PG&f=1", "display_name": "H.Akca", "link": "https://stackoverflow.com/users/9450512/h-akca"}, "edited": false, "score": 0, "creation_date": 1544015687, "post_id": 53633095, "comment_id": 94125750, "body": "i get this message for link_to [:edit, @post, comment] do  undefined method `edit_post_comments_path&#39; for #&lt;#&lt;Class:0x00007f1a418b9c70&gt;:0x00007f1a448793c0&gt;  Did you mean?  edit_post_comment_path                edit_post_comment_url"}], "tags": [], "owner": {"reputation": 16407, "user_id": 157752, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Qgx5T.jpg?s=128&g=1", "display_name": "Thilo", "link": "https://stackoverflow.com/users/157752/thilo"}, "is_accepted": false, "score": 1, "last_activity_date": 1544015344, "creation_date": 1544015344, "answer_id": 53633095, "question_id": 53632959, "link": "https://stackoverflow.com/questions/53632959/edit-path-for-rails-not-get-correct-url/53633095#53633095", "title": "Edit path for rails not get correct url", "body": "<p>Instead of</p>\n\n<pre><code>link_to edit_post_comment_path([@post, comment]) do\n</code></pre>\n\n<p>try</p>\n\n<pre><code>link_to edit_post_comment_path(@post, comment) do\n</code></pre>\n\n<p>or alternatively</p>\n\n<pre><code>link_to [:edit, @post, comment] do\n</code></pre>\n\n<p>See <a href=\"https://guides.rubyonrails.org/routing.html#creating-paths-and-urls-from-objects\" rel=\"nofollow noreferrer\">https://guides.rubyonrails.org/routing.html#creating-paths-and-urls-from-objects</a></p>\n"}, {"tags": [], "owner": {"reputation": 449, "user_id": 10739704, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XmWze.jpg?s=128&g=1", "display_name": "nileshkumar", "link": "https://stackoverflow.com/users/10739704/nileshkumar"}, "is_accepted": false, "score": 0, "last_activity_date": 1544066571, "last_edit_date": 1544066571, "creation_date": 1544028319, "answer_id": 53636976, "question_id": 53632959, "link": "https://stackoverflow.com/questions/53632959/edit-path-for-rails-not-get-correct-url/53636976#53636976", "title": "Edit path for rails not get correct url", "body": "<blockquote>\n  <p>use before_action in <code>Comments Controller </code> for comments also</p>\n</blockquote>\n\n<pre><code>before_action :set_comment, only: [:show, :edit, :update, :destroy]\n.....\n.....\n\nprivate\n\ndef set_comment\n  @comment = @post.comments.find(params[:id])\nend\n</code></pre>\n\n<p>and then in views/comments/show.html.haml</p>\n\n<pre><code>edit_post_comment_path(@post, @comment)\n</code></pre>\n\n<p>give it a try...</p>\n"}], "owner": {"reputation": 53, "user_id": 9450512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16fa02b3bbc00c9733820765abef33c4?s=128&d=identicon&r=PG&f=1", "display_name": "H.Akca", "link": "https://stackoverflow.com/users/9450512/h-akca"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 340, "favorite_count": 0, "accepted_answer_id": 53633052, "answer_count": 3, "score": 1, "last_activity_date": 1544066571, "creation_date": 1544014876, "question_id": 53632959, "link": "https://stackoverflow.com/questions/53632959/edit-path-for-rails-not-get-correct-url", "title": "Edit path for rails not get correct url", "body": "<p>I have big problem with my rails app. I create advanced blog for my schoolwork</p>\n\n<p>i need to edit my comment, but my url return this '/posts/4%2F12/comments/4/edit' and not /posts/4/comments/12/edit</p>\n\n<p>if I type the URL myself correctly I have access to the modification form that works</p>\n\n<p>you can see my code here</p>\n\n<p>show.html.haml</p>\n\n<pre><code>.article\n  .container\n    .row\n      .col-lg-12\n        .cover-image{:style =&gt; \"background-image: url('#{@post.photo_url}');\"}\n        %h1.mt-4= @post.title\n\n        #{I18n.l(@post.created_at)}\n        %hr/\n\n        %p.lead= @post.content.html_safe\n        %hr/\n\n        .card.my-4\n          %h5.card-header Ajouter un commentaire :\n          .card-body\n            = render 'comments/form', comment: @post.comments.build\n\n        .media.mb-4\n          .media-body\n            - @post.comments.each do |comment|\n              %h5.mt-0= comment.content\n              %h5.mt-0= comment.user_name\n              %h2 Edit user\n              = link_to edit_post_comment_path([@post, comment]) do\n                %button.btn.btn-primary{:type =&gt; \"button\"} Primary\n              = link_to \"Delete Comment\", [@post, comment], method: :delete, data: { confirm: 'Are you sure?' }\n</code></pre>\n\n<p>comments_controller.rb</p>\n\n<pre><code>before_action :set_post, only: [:create]\n\ndef create\n  @comment = @post.comments.new(comment_params)\n  @comment.user_name = current_user.nickname\n  if @comment.save!\n    redirect_to @post\n  else\n    flash.now[:danger] = \"error\"\n  end\nend\n\ndef edit\n  @post = Post.find(params[:post_id])\nend\n\n\ndef destroy\n  @post = Post.find(params[:post_id])\n  @comment = @post.comments.find(params[:id])\n  @comment.destroy\n  redirect_to post_path(@post)\n end\n\n\nprivate\n\ndef comment_params\n  params[:comment].permit(:content, :post_id)\nend\n\ndef post_params\n  params.require(:comment).permit(:content)\nend\n\ndef set_post\n  @post = Post.find(params[:post_id])\nend\n</code></pre>\n\n<p>routes.rb</p>\n\n<pre><code>  resources :users, only: :show\n\n  resources :posts do\n    resources :comments\n  end\n\n  root 'home#index'\n\n  root :to =&gt; redirect(\"/users/sign_in\")\n</code></pre>\n"}, {"tags": ["ruby", "selenium", "selenium-webdriver", "capybara", "selenium-firefoxdriver"], "comments": [{"owner": {"reputation": 116545, "user_id": 7429447, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5a25589e600c8ae89717c14e51a6754b?s=128&d=identicon&r=PG&f=1", "display_name": "DebanjanB", "link": "https://stackoverflow.com/users/7429447/debanjanb"}, "edited": false, "score": 0, "creation_date": 1544017513, "post_id": 53632725, "comment_id": 94126839, "body": "GeckoDriver version?"}, {"owner": {"reputation": 4248, "user_id": 1036242, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/8602754aee7371a7cddb975d549a50d9?s=128&d=identicon&r=PG", "display_name": "Anand Chavan", "link": "https://stackoverflow.com/users/1036242/anand-chavan"}, "reply_to_user": {"reputation": 116545, "user_id": 7429447, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5a25589e600c8ae89717c14e51a6754b?s=128&d=identicon&r=PG&f=1", "display_name": "DebanjanB", "link": "https://stackoverflow.com/users/7429447/debanjanb"}, "edited": false, "score": 0, "creation_date": 1544019283, "post_id": 53632725, "comment_id": 94127880, "body": "Capybara::Selenium::Driver.new(app, browser: :firefox, profile: firefox_profile, marionette: false, http_client: client) =&gt; GeckoDriver is not used"}], "answers": [{"comments": [{"owner": {"reputation": 4248, "user_id": 1036242, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/8602754aee7371a7cddb975d549a50d9?s=128&d=identicon&r=PG", "display_name": "Anand Chavan", "link": "https://stackoverflow.com/users/1036242/anand-chavan"}, "edited": false, "score": 0, "creation_date": 1551437537, "post_id": 53637294, "comment_id": 96648898, "body": "Upgrade was the only solution, and it helped to resolve the issue."}], "tags": [], "owner": {"reputation": 42014, "user_id": 2709090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/238c2b7cde2c817fc9a5a2b8eaa2ffad?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Walpole", "link": "https://stackoverflow.com/users/2709090/thomas-walpole"}, "is_accepted": false, "score": 1, "last_activity_date": 1544029349, "creation_date": 1544029349, "answer_id": 53637294, "question_id": 53632725, "link": "https://stackoverflow.com/questions/53632725/unable-to-obtain-stable-firefox-connection-in-60-seconds-127-0-0-17055-seleni/53637294#53637294", "title": "Unable to obtain stable firefox connection in 60 seconds (127.0.0.1:7055) Selenium 3.6.0", "body": "<p>I know you said you don\u2019t want to be told to update your browser version, but the solution really is going to be putting in the time to update all of your testing gems. The version of every gem you\u2019ve mentioned is obsolete and there have been tons of stability and timing improvements to all the mentioned gems since.  </p>\n\n<p>Technically, you\u2019re actually running a version of Firefox that was never really supported by Selenium using the native Firefox driver since Selenium had moved on to focusing on WebDriver (geckodriver) by then. The real solution really is to update.</p>\n"}], "owner": {"reputation": 4248, "user_id": 1036242, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/8602754aee7371a7cddb975d549a50d9?s=128&d=identicon&r=PG", "display_name": "Anand Chavan", "link": "https://stackoverflow.com/users/1036242/anand-chavan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 45, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1544029349, "creation_date": 1544014114, "question_id": 53632725, "link": "https://stackoverflow.com/questions/53632725/unable-to-obtain-stable-firefox-connection-in-60-seconds-127-0-0-17055-seleni", "title": "Unable to obtain stable firefox connection in 60 seconds (127.0.0.1:7055) Selenium 3.6.0", "body": "<p>I am getting an Issue mentioned in subject, which is an intermittent one. However its making our CI CD pipelines unstable so thought to get some help from geeks available on this great platform.</p>\n\n<p>Since this is an intermittent issue, I don't wish to upgrade my browser version, mentioning it as this comes mostly as the suggestion.</p>\n\n<p>Here are details which may help you to identify the cause which I was not able to </p>\n\n<p>What libraries I use -</p>\n\n<pre><code>gem 'selenium-webdriver', '3.6.0'\ngem 'capybara', '2.18.0'\ngem 'site_prism', '2.11'\n</code></pre>\n\n<p>What browser I use -</p>\n\n<pre><code>Firefox - 52.8.0\n</code></pre>\n\n<p>Which OS I use -</p>\n\n<pre><code>RHEL7\n</code></pre>\n\n<p>How do I configure my driver -</p>\n\n<pre><code> firefox_profile = Selenium::WebDriver::Firefox::Profile.new\n  firefox_profile['browser.download.dir'] = '/tmp'\n  firefox_profile['browser.download.folderList'] = 2\n  # content-type of file that will be downloaded\n  firefox_profile['browser.helperApps.neverAsk.saveToDisk'] = 'application/json;application/octet-stream;application/csv;text/csv;application/zip;application/x-zip;application/x-zip-compressed;application/x-rpm;application/pdf;application/xml;application/x-x509-ca-cert'\n  firefox_profile['timeout'] = 480000\n  firefox_profile['pdfjs.disabled'] = true\n  firefox_profile['resynchronization_timeout'] = 90\n  firefox_profile['resynchronize '] = true\n  firefox_profile['dom.max_chrome_script_run_time'] = 0\n  firefox_profile['dom.max_script_run_time'] = 0\n\n  Capybara.default_selector = :css\n  Capybara.ignore_hidden_elements = true\n  reset_wait_time\n  Capybara.run_server = false\n  client = Selenium::WebDriver::Remote::Http::Default.new\n  client.timeout = 240\n\n  if ENV['LOCAL'] == 'true'\n    STDOUT.puts 'starting local run'\n    Capybara.default_driver = :firefox\n    Capybara.register_driver :firefox do |app|\n      begin\n        STDOUT.puts 'Attempting to create browser instance'\n        Capybara::Selenium::Driver.new(app, browser: :firefox, profile: firefox_profile, marionette: false, http_client: client)\n      rescue =&gt; e\n        STDOUT.puts 'Error: Failed Attempting to create browser instance'\n        STDOUT.puts e\n        STDOUT.puts e.backtrace\n      end\n    end\n\n    begin\n      page.driver.browser.manage.window.resize_to(1200, 1200)\n    rescue =&gt; e\n      STDOUT.puts 'Error: Failed resize browser'\n      STDOUT.puts e\n      STDOUT.puts e.backtrace\n    end\nend\n</code></pre>\n\n<p>Error Stack Trace -</p>\n\n<pre><code>starting local run\nAttempting to create browser instance\nError: Failed resize browser\nunable to obtain stable firefox connection in 60 seconds (127.0.0.1:7055)\n/home/rubyuser/.rvm/gems/ruby-2.5.1@web-automation/gems/selenium-webdriver-3.6.0/lib/selenium/webdriver/firefox/launcher.rb:89:in `connect_until_stable'\n/home/rubyuser/.rvm/gems/ruby-2.5.1@web-automation/gems/selenium-webdriver-3.6.0/lib/selenium/webdriver/firefox/launcher.rb:53:in `block in launch'\n/home/rubyuser/.rvm/gems/ruby-2.5.1@web-automation/gems/selenium-webdriver-3.6.0/lib/selenium/webdriver/common/socket_lock.rb:41:in `locked'\n/home/rubyuser/.rvm/gems/ruby-2.5.1@web-automation/gems/selenium-webdriver-3.6.0/lib/selenium/webdriver/firefox/launcher.rb:49:in `launch'\n/home/rubyuser/.rvm/gems/ruby-2.5.1@web-automation/gems/selenium-webdriver-3.6.0/lib/selenium/webdriver/firefox/legacy/driver.rb:47:in `initialize'\n/home/rubyuser/.rvm/gems/ruby-2.5.1@web-automation/gems/selenium-webdriver-3.6.0/lib/selenium/webdriver/firefox/driver.rb:35:in `new'\n/home/rubyuser/.rvm/gems/ruby-2.5.1@web-automation/gems/selenium-webdriver-3.6.0/lib/selenium/webdriver/firefox/driver.rb:35:in `new'\n/home/rubyuser/.rvm/gems/ruby-2.5.1@web-automation/gems/selenium-webdriver-3.6.0/lib/selenium/webdriver/common/driver.rb:54:in `for'\n/home/rubyuser/.rvm/gems/ruby-2.5.1@web-automation/gems/selenium-webdriver-3.6.0/lib/selenium/webdriver.rb:86:in `for'\n/home/rubyuser/.rvm/gems/ruby-2.5.1@web-automation/gems/capybara-2.18.0/lib/capybara/selenium/driver.rb:23:in `browser'\n/home/rubyuser/web-automation/cucumber/support/env.rb:63:in `block in &lt;top (required)&gt;'\n/home/rubyuser/.rvm/gems/ruby-2.5.1@web-automation/gems/cucumber-3.1.2/lib/cucumber/glue/invoke_in_world.rb:39:in `instance_exec'\n/home/rubyuser/.rvm/gems/ruby-2.5.1@web-automation/gems/cucumber-3.1.2/lib/cucumber/glue/invoke_in_world.rb:39:in `block in cucumber_instance_exec_in'\n/home/rubyuser/.rvm/gems/ruby-2.5.1@web-automation/gems/cucumber-3.1.2/lib/cucumber/glue/invoke_in_world.rb:54:in `cucumber_run_with_backtrace_filtering'\n/home/rubyuser/.rvm/gems/ruby-2.5.1@web-automation/gems/cucumber-3.1.2/lib/cucumber/glue/invoke_in_world.rb:27:in `cucumber_instance_exec_in'\n/home/rubyuser/.rvm/gems/ruby-2.5.1@web-automation/gems/cucumber-3.1.2/lib/cucumber/glue/hook.rb:21:in `invoke'\n/home/rubyuser/.rvm/gems/ruby-2.5.1@web-automation/gems/cucumber-3.1.2/lib/cucumber/runtime/before_hooks.rb:23:in `block (2 levels) in before_hooks'\n/home/rubyuser/.rvm/gems/ruby-2.5.1@web-automation/gems/cucumber-core-3.2.1/lib/cucumber/core/test/action.rb:24:in `execute'\n/home/rubyuser/.rvm/gems/ruby-2.5.1@web-automation/gems/cucumber-core-3.2.1/lib/cucumber/core/test/step.rb:32:in `execute'\n/home/rubyuser/.rvm/gems/ruby-2.5.1@web-automation/gems/cucumber-core-3.2.1/lib/cucumber/core/test/runner.rb:104:in `execute'\n/home/rubyuser/.rvm/gems/ruby-2.5.1@web-automation/gems/cucumber-core-3.2.1/lib/cucumber/core/test/runner.rb:51:in `execute'\n/home/rubyuser/.rvm/gems/ruby-2.5.1@web-automation/gems/cucumber-core-3.2.1/lib/cucumber/core/test/runner.rb:27:in `test_step'\n/home/rubyuser/.rvm/gems/ruby-2.5.1@web-automation/gems/cucumber-core-3.2.1/lib/cucumber/core/test/step.rb:17:in `describe_to'\n/home/rubyuser/.rvm/gems/ruby-2.5.1@web-automation/gems/cucumber-core-3.2.1/lib/cucumber/core/test/case.rb:28:in `block (3 levels) in describe_to'\n/home/rubyuser/.rvm/gems/ruby-2.5.1@web-automation/gems/cucumber-core-3.2.1/lib/cucumber/core/test/case.rb:27:in `each'\n/home/rubyuser/.rvm/gems/ruby-2.5.1@web-automation/gems/cucumber-core-3.2.1/lib/cucumber/core/test/case.rb:27:in `block (2 levels) in describe_to'\n/home/rubyuser/.rvm/gems/ruby-2.5.1@web-automation/gems/cucumber-3.1.2/lib/cucumber/filters/prepare_world.rb:22:in `block in test_case'\n/home/rubyuser/.rvm/gems/ruby-2.5.1@web-automation/gems/cucumber-core-3.2.1/lib/cucumber/core/test/around_hook.rb:17:in `execute'\n/home/rubyuser/.rvm/gems/ruby-2.5.1@web-automation/gems/cucumber-core-3.2.1/lib/cucumber/core/test/runner.rb:104:in `execute'\n/home/rubyuser/.rvm/gems/ruby-2.5.1@web-automation/gems/cucumber-core-3.2.1/lib/cucumber/core/test/runner.rb:51:in `execute'\n/home/rubyuser/.rvm/gems/ruby-2.5.1@web-automation/gems/cucumber-core-3.2.1/lib/cucumber/core/test/runner.rb:34:in `around_hook'\n/home/rubyuser/.rvm/gems/ruby-2.5.1@web-automation/gems/cucumber-core-3.2.1/lib/cucumber/core/test/around_hook.rb:12:in `describe_to'\n/home/rubyuser/.rvm/gems/ruby-2.5.1@web-automation/gems/cucumber-core-3.2.1/lib/cucumber/core/test/case.rb:120:in `block (2 levels) in compose_around_hooks'\n/home/rubyuser/.rvm/gems/ruby-2.5.1@web-automation/gems/cucumber-core-3.2.1/lib/cucumber/core/test/case.rb:121:in `compose_around_hooks'\n/home/rubyuser/.rvm/gems/ruby-2.5.1@web-automation/gems/cucumber-core-3.2.1/lib/cucumber/core/test/case.rb:26:in `block in describe_to'\n/home/rubyuser/.rvm/gems/ruby-2.5.1@web-automation/gems/cucumber-core-3.2.1/lib/cucumber/core/test/runner.rb:19:in `test_case'\n/home/rubyuser/.rvm/gems/ruby-2.5.1@web-automation/gems/cucumber-core-3.2.1/lib/cucumber/core/test/case.rb:25:in `describe_to'\n/home/rubyuser/.rvm/gems/ruby-2.5.1@web-automation/gems/cucumber-3.1.2/lib/cucumber/filters/prepare_world.rb:11:in `test_case'\n/home/rubyuser/.rvm/gems/ruby-2.5.1@web-automation/gems/cucumber-core-3.2.1/lib/cucumber/core/test/case.rb:25:in `describe_to'\n/home/rubyuser/.rvm/gems/ruby-2.5.1@web-automation/gems/cucumber-core-3.2.1/lib/cucumber/core/filter.rb:57:in `test_case'\n/home/rubyuser/.rvm/gems/ruby-2.5.1@web-automation/gems/cucumber-3.1.2/lib/cucumber/filters/retry.rb:18:in `test_case'\n/home/rubyuser/.rvm/gems/ruby-2.5.1@web-automation/gems/cucumber-core-3.2.1/lib/cucumber/core/test/case.rb:25:in `describe_to'\n/home/rubyuser/.rvm/gems/ruby-2.5.1@web-automation/gems/cucumber-3.1.2/lib/cucumber/filters/quit.rb:12:in `test_case'\n/home/rubyuser/.rvm/gems/ruby-2.5.1@web-automation/gems/cucumber-core-3.2.1/lib/cucumber/core/test/case.rb:25:in `describe_to'\n/home/rubyuser/.rvm/gems/ruby-2.5.1@web-automation/gems/cucumber-3.1.2/lib/cucumber/filters/broadcast_test_run_started_event.rb:21:in `block in done'\n/home/rubyuser/.rvm/gems/ruby-2.5.1@web-automation/gems/cucumber-3.1.2/lib/cucumber/filters/broadcast_test_run_started_event.rb:20:in `map'\n/home/rubyuser/.rvm/gems/ruby-2.5.1@web-automation/gems/cucumber-3.1.2/lib/cucumber/filters/broadcast_test_run_started_event.rb:20:in `done'\n/home/rubyuser/.rvm/gems/ruby-2.5.1@web-automation/gems/cucumber-core-3.2.1/lib/cucumber/core/filter.rb:62:in `done'\n/home/rubyuser/.rvm/gems/ruby-2.5.1@web-automation/gems/cucumber-core-3.2.1/lib/cucumber/core/filter.rb:62:in `done'\n/home/rubyuser/.rvm/gems/ruby-2.5.1@web-automation/gems/cucumber-core-3.2.1/lib/cucumber/core/filter.rb:62:in `done'\n/home/rubyuser/.rvm/gems/ruby-2.5.1@web-automation/gems/cucumber-core-3.2.1/lib/cucumber/core/filter.rb:62:in `done'\n/home/rubyuser/.rvm/gems/ruby-2.5.1@web-automation/gems/cucumber-core-3.2.1/lib/cucumber/core/filter.rb:62:in `done'\n/home/rubyuser/.rvm/gems/ruby-2.5.1@web-automation/gems/cucumber-core-3.2.1/lib/cucumber/core/test/filters/locations_filter.rb:20:in `done'\n/home/rubyuser/.rvm/gems/ruby-2.5.1@web-automation/gems/cucumber-core-3.2.1/lib/cucumber/core/filter.rb:62:in `done'\n/home/rubyuser/.rvm/gems/ruby-2.5.1@web-automation/gems/cucumber-core-3.2.1/lib/cucumber/core/test/filters/tag_filter.rb:18:in `done'\n/home/rubyuser/.rvm/gems/ruby-2.5.1@web-automation/gems/cucumber-core-3.2.1/lib/cucumber/core/compiler.rb:24:in `done'\n/home/rubyuser/.rvm/gems/ruby-2.5.1@web-automation/gems/cucumber-core-3.2.1/lib/cucumber/core/gherkin/parser.rb:39:in `done'\n/home/rubyuser/.rvm/gems/ruby-2.5.1@web-automation/gems/cucumber-core-3.2.1/lib/cucumber/core.rb:32:in `parse'\n/home/rubyuser/.rvm/gems/ruby-2.5.1@web-automation/gems/cucumber-core-3.2.1/lib/cucumber/core.rb:21:in `compile'\n/home/rubyuser/.rvm/gems/ruby-2.5.1@web-automation/gems/cucumber-3.1.2/lib/cucumber/runtime.rb:75:in `run!'\n/home/rubyuser/.rvm/gems/ruby-2.5.1@web-automation/gems/cucumber-3.1.2/lib/cucumber/cli/main.rb:34:in `execute!'\n/home/rubyuser/.rvm/gems/ruby-2.5.1@web-automation/gems/cucumber-3.1.2/lib/cucumber/cli/main.rb:13:in `execute'\n/home/rubyuser/.rvm/gems/ruby-2.5.1@web-automation/gems/cukeforker-2.1.1/lib/cukeforker/worker.rb:96:in `execute_cucumber'\n/home/rubyuser/.rvm/gems/ruby-2.5.1@web-automation/gems/cukeforker-2.1.1/lib/cukeforker/worker.rb:41:in `block in start'\n/home/rubyuser/.rvm/gems/ruby-2.5.1@web-automation/gems/cukeforker-2.1.1/lib/cukeforker/worker.rb:35:in `fork'\n/home/rubyuser/.rvm/gems/ruby-2.5.1@web-automation/gems/cukeforker-2.1.1/lib/cukeforker/worker.rb:35:in `start'\n/home/rubyuser/.rvm/gems/ruby-2.5.1@web-automation/gems/cukeforker-2.1.1/lib/cukeforker/worker_queue.rb:116:in `start'\n/home/rubyuser/.rvm/gems/ruby-2.5.1@web-automation/gems/cukeforker-2.1.1/lib/cukeforker/worker_queue.rb:53:in `fill'\n/home/rubyuser/.rvm/gems/ruby-2.5.1@web-automation/gems/cukeforker-2.1.1/lib/cukeforker/worker_queue.rb:35:in `process'\n/home/rubyuser/.rvm/gems/ruby-2.5.1@web-automation/gems/cukeforker-2.1.1/lib/cukeforker/runner.rb:120:in `process'\n/home/rubyuser/.rvm/gems/ruby-2.5.1@web-automation/gems/cukeforker-2.1.1/lib/cukeforker/runner.rb:100:in `run'\n/home/rubyuser/.rvm/gems/ruby-2.5.1@web-automation/gems/cukeforker-2.1.1/lib/cukeforker/runner.rb:40:in `run'\n/home/rubyuser/web-automation/cucumber/Rakefile:48:in `concurrent_test'\n/home/rubyuser/web-automation/cucumber/Rakefile:16:in `block in &lt;top (required)&gt;'\n/home/rubyuser/.rvm/rubies/ruby-2.5.1/lib/ruby/gems/2.5.0/gems/rake-12.3.0/lib/rake/task.rb:251:in `block in execute'\n/home/rubyuser/.rvm/rubies/ruby-2.5.1/lib/ruby/gems/2.5.0/gems/rake-12.3.0/lib/rake/task.rb:251:in `each'\n/home/rubyuser/.rvm/rubies/ruby-2.5.1/lib/ruby/gems/2.5.0/gems/rake-12.3.0/lib/rake/task.rb:251:in `execute'\n/home/rubyuser/.rvm/rubies/ruby-2.5.1/lib/ruby/gems/2.5.0/gems/rake-12.3.0/lib/rake/task.rb:195:in `block in invoke_with_call_chain'\n/home/rubyuser/.rvm/rubies/ruby-2.5.1/lib/ruby/2.5.0/monitor.rb:226:in `mon_synchronize'\n/home/rubyuser/.rvm/rubies/ruby-2.5.1/lib/ruby/gems/2.5.0/gems/rake-12.3.0/lib/rake/task.rb:188:in `invoke_with_call_chain'\n/home/rubyuser/.rvm/rubies/ruby-2.5.1/lib/ruby/gems/2.5.0/gems/rake-12.3.0/lib/rake/task.rb:181:in `invoke'\n/home/rubyuser/.rvm/rubies/ruby-2.5.1/lib/ruby/gems/2.5.0/gems/rake-12.3.0/lib/rake/application.rb:160:in `invoke_task'\n/home/rubyuser/.rvm/rubies/ruby-2.5.1/lib/ruby/gems/2.5.0/gems/rake-12.3.0/lib/rake/application.rb:116:in `block (2 levels) in top_level'\n/home/rubyuser/.rvm/rubies/ruby-2.5.1/lib/ruby/gems/2.5.0/gems/rake-12.3.0/lib/rake/application.rb:116:in `each'\n/home/rubyuser/.rvm/rubies/ruby-2.5.1/lib/ruby/gems/2.5.0/gems/rake-12.3.0/lib/rake/application.rb:116:in `block in top_level'\n/home/rubyuser/.rvm/rubies/ruby-2.5.1/lib/ruby/gems/2.5.0/gems/rake-12.3.0/lib/rake/application.rb:125:in `run_with_threads'\n/home/rubyuser/.rvm/rubies/ruby-2.5.1/lib/ruby/gems/2.5.0/gems/rake-12.3.0/lib/rake/application.rb:110:in `top_level'\n/home/rubyuser/.rvm/rubies/ruby-2.5.1/lib/ruby/gems/2.5.0/gems/rake-12.3.0/lib/rake/application.rb:83:in `block in run'\n/home/rubyuser/.rvm/rubies/ruby-2.5.1/lib/ruby/gems/2.5.0/gems/rake-12.3.0/lib/rake/application.rb:186:in `standard_exception_handling'\n/home/rubyuser/.rvm/rubies/ruby-2.5.1/lib/ruby/gems/2.5.0/gems/rake-12.3.0/lib/rake/application.rb:80:in `run'\n/home/rubyuser/.rvm/gems/ruby-2.5.1@global/gems/rake-12.3.0/exe/rake:27:in `&lt;top (required)&gt;'\n/home/rubyuser/.rvm/gems/ruby-2.5.1@global/bin/rake:23:in `load'\n/home/rubyuser/.rvm/gems/ruby-2.5.1@global/bin/rake:23:in `&lt;main&gt;'\n/home/rubyuser/.rvm/gems/ruby-2.5.1@web-automation/bin/ruby_executable_hooks:24:in `eval'\n/home/rubyuser/.rvm/gems/ruby-2.5.1@web-automation/bin/ruby_executable_hooks:24:in `&lt;main&gt;'\n</code></pre>\n"}, {"tags": ["ruby", "stripe-payments"], "answers": [{"tags": [], "owner": {"reputation": 6460, "user_id": 6320039, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/U4QjP.jpg?s=128&g=1", "display_name": "Ulysse BN", "link": "https://stackoverflow.com/users/6320039/ulysse-bn"}, "is_accepted": true, "score": 1, "last_activity_date": 1544033540, "creation_date": 1544033540, "answer_id": 53638353, "question_id": 53632235, "link": "https://stackoverflow.com/questions/53632235/how-to-upload-stripe-identity-document-from-s3-url-with-ruby/53638353#53638353", "title": "How to upload Stripe identity_document from S3 url with Ruby?", "body": "<p>Your usage of <code>File.new</code> seems a bit odd. You should take advantage of <a href=\"https://ruby-doc.org/core-2.4.4/IO.html#method-c-binwrite\" rel=\"nofollow noreferrer\"><code>IO.binwrite</code></a> instead:</p>\n\n<pre><code>IO.binwrite('img.jpg', open('https://picsum.photos/200').string)\n\ntoken = Stripe::FileUpload.create(\n    {\n        purpose: \"identity_document\",\n        file: File.new('img.jpg')\n    },\n    {\n        stripe_account: stripe_account_id\n    }\n)\n</code></pre>\n\n<p>Optionnally you could use <a href=\"https://ruby-doc.org/stdlib-2.5.3/libdoc/tempfile/rdoc/Tempfile.html\" rel=\"nofollow noreferrer\"><code>Tempfile</code></a> to ensure a unique filename.</p>\n"}], "owner": {"reputation": 129, "user_id": 6586613, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7rqbx.jpg?s=128&g=1", "display_name": "Hugo Barthelemy", "link": "https://stackoverflow.com/users/6586613/hugo-barthelemy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 81, "favorite_count": 0, "accepted_answer_id": 53638353, "answer_count": 1, "score": 1, "last_activity_date": 1544033540, "creation_date": 1544012571, "last_edit_date": 1544033264, "question_id": 53632235, "link": "https://stackoverflow.com/questions/53632235/how-to-upload-stripe-identity-document-from-s3-url-with-ruby", "title": "How to upload Stripe identity_document from S3 url with Ruby?", "body": "<p>I need to send an identity document to Stripe with <code>stripe-ruby</code> directly from an S3 URL like that:</p>\n\n<pre><code>picture_s3_url = \"https://s3-eu-west-1.amazonaws.com/bucket/uploads/foo.png\"\n\nfile = File.new(open(picture_s3_url))\n\ntoken = Stripe::FileUpload.create(\n    {\n        purpose: \"identity_document\",\n        file: file\n    },\n    {\n        stripe_account: stripe_account_id\n    }\n)\n</code></pre>\n\n<p>And if it's possible, without creating a local file.</p>\n\n<p>How may I achieve this?</p>\n"}, {"tags": ["ruby", "private", "implicit"], "answers": [{"tags": [], "owner": {"reputation": 32451, "user_id": 2516474, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a2179a340c0e84edc285d432211145d?s=128&d=identicon&r=PG", "display_name": "SteveTurczyn", "link": "https://stackoverflow.com/users/2516474/steveturczyn"}, "is_accepted": true, "score": 2, "last_activity_date": 1544014822, "creation_date": 1544014822, "answer_id": 53632944, "question_id": 53632207, "link": "https://stackoverflow.com/questions/53632207/implicit-receiver/53632944#53632944", "title": "Implicit receiver", "body": "<p>In the text you quote the \"not yourself\" means not in the same context (object) that the call was made.</p>\n\n<p>In this example of a private method...</p>\n\n<pre><code>class Foo\n  def bar\n    baz\n  end\n  private\n  def baz\n    'hello'\n  end\nend\n</code></pre>\n\n<p>If you do</p>\n\n<pre><code>Foo.new.baz\n</code></pre>\n\n<p>You get an error, because <code>baz</code> was called with an explicit receiver (the part before the dot... <code>Foo.new</code>)</p>\n\n<p>If you do </p>\n\n<pre><code>Foo.new.bar\n=&gt; \"hello\"\n</code></pre>\n\n<p>And that works because method <code>bar</code> called <code>baz</code> without a receiver.  It was able to call it without a receiver because <code>bar</code> (like <code>baz</code>) are both instance methods of the <code>Foo</code> object, so they have the same context (the same <code>self</code>). the <code>bar</code> method was calling <code>baz</code> on the same object that contains the <code>bar</code> method (i.e. \"itself\" or \"yourself\" if you think of yourself as sitting in the object as you write the object's methods).</p>\n\n<p>Now rewrite the class as...</p>\n\n<pre><code>class Foo\n  def bar\n    self.baz\n  end\n  private\n  def baz\n    'hello'\n  end\nend\n</code></pre>\n\n<p>And now you see that <code>bar</code> no longer works, since you privded the receiver <code>self</code> (an explicit receiver) on the call to <code>baz</code> within the method <code>bar</code>.  Technically the exact same functionality (no receiver is the same as self as receiver) , but Ruby implements private methods by disallowing explicit receivers, even <code>self</code>.  So, as stated, private methods can't be called with an explicit receiver.</p>\n\n<p>Every time you call a method on an object you are not calling that method on yourself (i.e. your context).</p>\n\n<pre><code>'george'.upcase\n=&gt; \"GEORGE\"\n</code></pre>\n\n<p>For <code>upcase</code> the explicit receiver is the part before the dot (the string object \"george\")</p>\n\n<p>If you did</p>\n\n<pre><code>upcase\n</code></pre>\n\n<p>without specifying a receiver, it assumes you want to run <code>upcase</code> in your context (<code>self</code>) which in IRB is main:Object.  That's why you get</p>\n\n<pre><code>NameError: undefined lcoal variable or method `upcase' for main:Object\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 96, "user_id": 7408598, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c6134d361550f3a22f21ae86e675382?s=128&d=identicon&r=PG&f=1", "display_name": "ItamarG", "link": "https://stackoverflow.com/users/7408598/itamarg"}, "is_accepted": false, "score": 1, "last_activity_date": 1544015609, "creation_date": 1544015609, "answer_id": 53633175, "question_id": 53632207, "link": "https://stackoverflow.com/questions/53632207/implicit-receiver/53633175#53633175", "title": "Implicit receiver", "body": "<p>Well, basically you are asking two questions.\nexplicit receiver/implicit receiver depends on how you call the method.\nhere's an example:</p>\n\n<pre><code>class MyClass\n    def method1\n        self.method2 # explicit reciever 'self'\n        method2 # we call the same method but we don't pass a reciever -&gt; implicit reciever\n    end\n\n    def method2\n        puts \"some text in here\"\n    end\nend\n\nmc_object = MyClass.new\nmc_object.method1 # explicit reciever 'mc'\n</code></pre>\n\n<p>this code will print \"some text in here\" twice, one time witht the explicit call and one without it.</p>\n\n<p>Now, private methods in ruby, are methods can only be called within the class itself, and when doing that you can only use implicit receiver.\nIn the next example we will add a new private method.</p>\n\n<pre><code>class MyClass\n    def method1\n        self.method2 # explicit reciever 'self'\n        method2 # we call the same method but we don't pass a reciever =&gt; implicit reciever\n\n        method3 # will work - implicit reciever\n        self.method3 # will not work! - private method `method3' Error\n    end\n\n    def method2\n        puts \"some text in here\"\n    end\n\n    private\n\n    def method3\n        puts \"this text is private!\"\n    end\nend\nmc_object = MyClass.new\nmc_object.method1 # explicit reciever 'mc'\nmc_object.method3 # will not work! - private method `method3' Error \n</code></pre>\n\n<p>So you can see that trying to access a private method with a receiver (prefix 'self') will cause error, and also trying to access that method outside of the class definition will also cause a private method error.</p>\n\n<p>hope it helps :)</p>\n"}, {"tags": [], "owner": {"reputation": 100, "user_id": 10463251, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ff958d5dc3d428d04f1cce2f80433712?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin W.", "link": "https://stackoverflow.com/users/10463251/kevin-w"}, "is_accepted": false, "score": 0, "last_activity_date": 1544024302, "creation_date": 1544024302, "answer_id": 53635802, "question_id": 53632207, "link": "https://stackoverflow.com/questions/53632207/implicit-receiver/53635802#53635802", "title": "Implicit receiver", "body": "<p>I'll answer your first question: </p>\n\n<blockquote>\n  <p>how private methods are used</p>\n</blockquote>\n\n<p>Private methods are most commonly used to provide methods for a class that are only accessible to other methods in the same class. These methods are for the class' internal use only and are not callable from outside.</p>\n"}], "owner": {"reputation": 31, "user_id": 10364107, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-z-HaAuoo5zA/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaPTAXNYiMZJX6XRRCUiu3z2z4_aQg/mo/photo.jpg?sz=128", "display_name": "himn", "link": "https://stackoverflow.com/users/10364107/himn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 144, "favorite_count": 1, "accepted_answer_id": 53632944, "answer_count": 3, "score": 1, "last_activity_date": 1544073172, "creation_date": 1544012443, "last_edit_date": 1544073172, "question_id": 53632207, "link": "https://stackoverflow.com/questions/53632207/implicit-receiver", "title": "Implicit receiver", "body": "<p>I am reading the book <em>Metaprogramming Ruby</em>, and trying to understand how private methods are used. It has this paragraph:</p>\n\n<blockquote>\n  <p>first, you need an explicit receiver to call a method on an object that is not\n  yourself, and second, private methods can be called only with an implicit receiver.</p>\n</blockquote>\n\n<p>Could anyone give me an example to illustrate this \"you need an explicit receiver to call a method on an object that is not yourself\"?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "pdf"], "answers": [{"comments": [{"owner": {"reputation": 57, "user_id": 10749227, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4cfd24ed84691ff5357a5dc5a38626ef?s=128&d=identicon&r=PG&f=1", "display_name": "DevCF", "link": "https://stackoverflow.com/users/10749227/devcf"}, "edited": false, "score": 0, "creation_date": 1544023150, "post_id": 53632478, "comment_id": 94130536, "body": "Thank you! I was on the right track so I&#39;m relieved I&#39;m not as much of an idiot as I thought :)"}], "tags": [], "owner": {"reputation": 5312, "user_id": 6535997, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/10156345016155058/picture?type=large", "display_name": "Mark", "link": "https://stackoverflow.com/users/6535997/mark"}, "is_accepted": false, "score": 0, "last_activity_date": 1544013271, "creation_date": 1544013271, "answer_id": 53632478, "question_id": 53632009, "link": "https://stackoverflow.com/questions/53632009/set-a-default-image-for-a-pdf-thumbnail-preview-in-ruby-on-rails/53632478#53632478", "title": "Set a default image for a PDF thumbnail preview in Ruby on Rails", "body": "<p>I think the easiest way is to create a 'thumbnail_image' method in your ApplicationHelper that takes the document as an argument:</p>\n\n<pre><code>def thumbnail_image(document)\n  if document.pdf?\n    path_to_default_thumbnail (i.e. app/assets/images/thumbnail.jpg)\n  else\n    document_preview_url(document.file)\n  end\nend\n</code></pre>\n\n<p>Then in your view:</p>\n\n<pre><code>&lt;%= link_to document.file.url, target: \"_blank\" do %&gt;\n  &lt;%= image_tag thumbnail_image(document.file) if document.file? %&gt;\n&lt;% end %&gt;\n</code></pre>\n"}], "owner": {"reputation": 57, "user_id": 10749227, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4cfd24ed84691ff5357a5dc5a38626ef?s=128&d=identicon&r=PG&f=1", "display_name": "DevCF", "link": "https://stackoverflow.com/users/10749227/devcf"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 607, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1544013271, "creation_date": 1544011780, "last_edit_date": 1544012154, "question_id": 53632009, "link": "https://stackoverflow.com/questions/53632009/set-a-default-image-for-a-pdf-thumbnail-preview-in-ruby-on-rails", "title": "Set a default image for a PDF thumbnail preview in Ruby on Rails", "body": "<p>I've been working on this for a while and done many Googles but can't seem to figure out where I'm going wrong. (I've this week taken over a 2-year old site so I'm still trying to find my way around which doesn't help).</p>\n\n<p>When a file is uploaded, a thumbnail preview image is created. For image files, this preview is created no problem, but for PDF's I want to set a default image as the thumbnail, instead of a preview of the PDF.</p>\n\n<p>In my DocumentUploader class I have the following which sets the image thumbnail (I've not included some bits that aren't relevant):</p>\n\n<pre><code>def convert_to_image(height, width)\n  image = MiniMagick::Image.open(current_path)\n  image.resize \"#{height}x#{width}\"\n  image.write(current_path)\nend\n\nversion :preview, if: :not_svg? do\n  process convert_to_image: [210, 297]\n  process convert: :jpg\n\n  def full_filename(for_file = model.file)\n    super.chomp(File.extname(super)) + \".jpg\"\n  end\nend\n\ndef not_svg?(new_file)\n  !new_file.content_type.start_with? \"image/svg+xml\"\n  !new_file.content_type.start_with? \"application/pdf\"\nend\n</code></pre>\n\n<p>Using this as a basis, I wrote the following for a PDF (again, the non-relevant parts excluded):</p>\n\n<pre><code>def set_default_pdf(height, width)\n  image = MiniMagick::Image.open(\"app/assets/images/pdf_placeholder.svg\")\n  image.resize \"#{height}x#{width}\"\n  image.write(\"app/assets/images/pdf_placeholder.svg\")\nend\n\nversion :preview, if: :pdf? do\n  process set_default_pdf: [210, 297]\n  process convert: :jpg\n\n  def full_filename(for_file = model.file)\n    super.chomp(File.extname(super)) + \".jpg\"\n  end\nend\n\ndef pdf?(new_file)\n  new_file.content_type.start_with? \"application/pdf\"\nend\n</code></pre>\n\n<p>My view has the following:</p>\n\n<pre><code>&lt;%= link_to document.file.url, target: \"_blank\" do %&gt;\n  &lt;%= image_tag document_preview_url(document.file) if document.file? %&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>So I've followed that to my DocumentPreviewHelper module which has the following:</p>\n\n<pre><code>def document_preview_url(file)\n  return file.preview.url(response_content_type: %( \"image/jpeg\" )) if file.preview.present?\n\n  file.url(response_content_type: %( \"image/svg+xml\"))\nend\n</code></pre>\n\n<p>With the comments: </p>\n\n<pre><code>  # Retrieve a preview thumbnail for a PDF with the correct content type set.\n  #\n  # Without overriding the content_type, the headers would return 'application/pdf'\n  # for the preview image, and all browsers except for Safari will show the image\n  # (regardless of the content type header). This fixes the preview thumbs for Safari.\n</code></pre>\n\n<p>I feel like this is where I should be making my changes, but from my (limited) knowledge it seems to me like the PDF previews should be showing, since they've been converted to jpg in DocumentUploader.</p>\n\n<p>I've tried various different tweaks and changes but the PDF previews just stay as broken links. What am I missing / where am I going wrong? I feel like this should be an easy fix but I'm just not seeing it and frustration is setting in. </p>\n"}, {"tags": ["ruby", "gitlab"], "comments": [{"owner": {"reputation": 155, "user_id": 294307, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d0d6d9f380e519db15b7c4f945b5c1fd?s=128&d=identicon&r=PG", "display_name": "yourcomputergenius", "link": "https://stackoverflow.com/users/294307/yourcomputergenius"}, "edited": false, "score": 0, "creation_date": 1544037845, "post_id": 53631252, "comment_id": 94138234, "body": "Did you recently change anything in your gitlab.rb? What version of GitLab are you running?"}, {"owner": {"reputation": 325, "user_id": 10370607, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Vvch8.jpg?s=128&g=1", "display_name": "L.885", "link": "https://stackoverflow.com/users/10370607/l-885"}, "reply_to_user": {"reputation": 155, "user_id": 294307, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d0d6d9f380e519db15b7c4f945b5c1fd?s=128&d=identicon&r=PG", "display_name": "yourcomputergenius", "link": "https://stackoverflow.com/users/294307/yourcomputergenius"}, "edited": false, "score": 0, "creation_date": 1544082778, "post_id": 53631252, "comment_id": 94151971, "body": "i didn&#39;t change anything in gitlab.rb but my server just recovered from kernel panick before. My SysAdmin just do fsck and everything suddenly doesn&#39;t work."}], "answers": [{"tags": [], "owner": {"reputation": 155, "user_id": 294307, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d0d6d9f380e519db15b7c4f945b5c1fd?s=128&d=identicon&r=PG", "display_name": "yourcomputergenius", "link": "https://stackoverflow.com/users/294307/yourcomputergenius"}, "is_accepted": false, "score": 0, "last_activity_date": 1544574058, "creation_date": 1544574058, "answer_id": 53734333, "question_id": 53631252, "link": "https://stackoverflow.com/questions/53631252/gitlab-reconfigure-error-cannot-load-such-file-syslog-logger/53734333#53734333", "title": "Gitlab Reconfigure error cannot load such file syslog-logger", "body": "<p>My guess is you have actual file system corruption in a file related to the <a href=\"https://ruby-doc.org/stdlib-2.0.0/libdoc/syslog/rdoc/Syslog/Logger.html\" rel=\"nofollow noreferrer\">Syslog:Logger</a>.</p>\n\n<p>You could step through those files and update or replace them, but honestly it would be easier to spin up another virtual server, re-install gitlab-ce from scratch, and restore from your previous (nightly?) backup.</p>\n"}], "owner": {"reputation": 325, "user_id": 10370607, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Vvch8.jpg?s=128&g=1", "display_name": "L.885", "link": "https://stackoverflow.com/users/10370607/l-885"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 97, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1544574058, "creation_date": 1544009234, "last_edit_date": 1544018320, "question_id": 53631252, "link": "https://stackoverflow.com/questions/53631252/gitlab-reconfigure-error-cannot-load-such-file-syslog-logger", "title": "Gitlab Reconfigure error cannot load such file syslog-logger", "body": "<p>I already tried to search on Google about my problem but still no luck. My server just got recovered and now I can't access Gitlab-CE. Every time I use command <code>gitlab-ctl reconfigure</code> the error happen. </p>\n\n<p>Here's the output of error:</p>\n\n<pre><code>    $ sudo gitlab-ctl reconfigure\n/opt/gitlab/embedded/lib/ruby/site_ruby/2.4.0/rubygems/core_ext/kernel_require.rb:59:in `require': cannot load such file -- syslog-logger (LoadError)\n    from /opt/gitlab/embedded/lib/ruby/site_ruby/2.4.0/rubygems/core_ext/kernel_require.rb:59:in `require'\n    from /opt/gitlab/embedded/lib/ruby/gems/2.4.0/gems/chef-13.6.4/lib/chef/log/syslog.rb:20:in `&lt;top (required)&gt;'\n    from /opt/gitlab/embedded/lib/ruby/site_ruby/2.4.0/rubygems/core_ext/kernel_require.rb:59:in `require'\n    from /opt/gitlab/embedded/lib/ruby/site_ruby/2.4.0/rubygems/core_ext/kernel_require.rb:59:in `require'\n    from /opt/gitlab/embedded/lib/ruby/gems/2.4.0/gems/chef-13.6.4/lib/chef/log.rb:24:in `&lt;top (required)&gt;'\n    from /opt/gitlab/embedded/lib/ruby/site_ruby/2.4.0/rubygems/core_ext/kernel_require.rb:59:in `require'\n    from /opt/gitlab/embedded/lib/ruby/site_ruby/2.4.0/rubygems/core_ext/kernel_require.rb:59:in `require'\n    from /opt/gitlab/embedded/lib/ruby/gems/2.4.0/gems/chef-13.6.4/lib/chef.rb:23:in `&lt;top (required)&gt;'\n    from /opt/gitlab/embedded/lib/ruby/site_ruby/2.4.0/rubygems/core_ext/kernel_require.rb:59:in `require'\n    from /opt/gitlab/embedded/lib/ruby/site_ruby/2.4.0/rubygems/core_ext/kernel_require.rb:59:in `require'\n    from /opt/gitlab/embedded/lib/ruby/gems/2.4.0/gems/chef-13.6.4/bin/chef-client:23:in `&lt;top (required)&gt;'\n    from /opt/gitlab/embedded/bin/chef-client:23:in `load'\n    from /opt/gitlab/embedded/bin/chef-client:23:in `&lt;main&gt;'\n</code></pre>\n"}, {"tags": ["ruby", "ubuntu", "nokogiri"], "comments": [{"owner": {"reputation": 47898, "user_id": 966023, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/917fcb4327159076f752c0c3c3fddfbb?s=128&d=identicon&r=PG", "display_name": "pguardiario", "link": "https://stackoverflow.com/users/966023/pguardiario"}, "edited": false, "score": 0, "creation_date": 1544050646, "post_id": 53630887, "comment_id": 94143472, "body": "It looks like you&#39;re missing ruby-dev, and maybe some others."}], "answers": [{"tags": [], "owner": {"reputation": 449, "user_id": 10739704, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XmWze.jpg?s=128&g=1", "display_name": "nileshkumar", "link": "https://stackoverflow.com/users/10739704/nileshkumar"}, "is_accepted": true, "score": 0, "last_activity_date": 1544023551, "creation_date": 1544023551, "answer_id": 53635572, "question_id": 53630887, "link": "https://stackoverflow.com/questions/53630887/failed-while-installing-nokogiri-on-ubuntu/53635572#53635572", "title": "Failed While Installing Nokogiri on Ubuntu", "body": "<p>Try installing Ruby 2.1.1 with rbenv and set it as default version in ubuntu:</p>\n\n<pre><code>    rbenv install 2.1.1\n    rbenv global 2.1.1\n</code></pre>\n\n<p>After installing ruby, install the following packages:</p>\n\n<pre><code>sudo apt-get install libxslt-dev libxml2-dev zlib1g-dev\n</code></pre>\n\n<p>And then install nokogiri:</p>\n\n<pre><code>sudo gem install nokogiri\n</code></pre>\n\n<p>This should do the trick...</p>\n"}], "owner": {"reputation": 15, "user_id": 10551487, "user_type": "registered", "profile_image": "https://graph.facebook.com/452863025236167/picture?type=large", "display_name": "Xyxga", "link": "https://stackoverflow.com/users/10551487/xyxga"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 764, "favorite_count": 0, "accepted_answer_id": 53635572, "answer_count": 1, "score": 0, "last_activity_date": 1544023551, "creation_date": 1544008081, "question_id": 53630887, "link": "https://stackoverflow.com/questions/53630887/failed-while-installing-nokogiri-on-ubuntu", "title": "Failed While Installing Nokogiri on Ubuntu", "body": "<p>I am trying to install nokogiri on Ubuntu Linux. I am running Ruby-2.1.1. I have installed.</p>\n\n<p>Output:</p>\n\n<pre><code>sudo gem install nokogiri\nBuilding native extensions. This could take a while...\nERROR:  Error installing nokogiri:\n    ERROR: Failed to build gem native extension.\n\n    current directory: /var/lib/gems/2.5.0/gems/nokogiri-1.8.5/ext/nokogiri\n/usr/bin/ruby2.5 -r ./siteconf20181205-6502-3n3u4g.rb extconf.rb\nmkmf.rb can't find header files for ruby at /usr/lib/ruby/include/ruby.h\n\nextconf failed, exit code 1\n\nGem files will remain installed in /var/lib/gems/2.5.0/gems/nokogiri-1.8.5 for inspection.\nResults logged to /var/lib/gems/2.5.0/extensions/x86_64-linux/2.5.0/nokogiri-1.8.5/gem_make.out\n</code></pre>\n\n<p>Can anyone explain what I am missing?</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1544007314, "post_id": 53630417, "comment_id": 94120703, "body": "Not a lazy enumerator, but you can use <code>break</code> with a value to exit an infinite loop, e.g. <code>0.step.each_with_object({a: 0}) { |i, acc| acc[:a] += i; break acc if i == 5 }</code>"}, {"owner": {"reputation": 792, "user_id": 1597707, "user_type": "registered", "accept_rate": 46, "profile_image": "https://i.stack.imgur.com/NQJTN.gif?s=128&g=1", "display_name": "Mike", "link": "https://stackoverflow.com/users/1597707/mike"}, "reply_to_user": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1544008262, "post_id": 53630417, "comment_id": 94121263, "body": "That&#39;s sort of workaround. Surprisingly execution time remained pretty much the same.."}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1544008947, "post_id": 53630417, "comment_id": 94121666, "body": "<i>&quot;condition relies on result that this very <code>each_with_object</code> function generates&quot;</i> \u2013 you should modify your example accordingly."}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1544017363, "post_id": 53630417, "comment_id": 94126751, "body": "&quot;Returns a lazy enumerator, whose methods map/collect, flat_map/collect_concat, select/find_all, reject, grep, #grep_v, zip, take, #take_while, drop, and #drop_while enumerate values only on an as-needed basis. However, if a block is given to zip, values are enumerated immediately.&quot; no mention of <code>each_with_object</code> having a lazy implementation which is most likely why your second example loops forever."}], "answers": [{"tags": [], "owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "is_accepted": true, "score": 1, "last_activity_date": 1544008576, "creation_date": 1544008576, "answer_id": 53631048, "question_id": 53630417, "link": "https://stackoverflow.com/questions/53630417/how-to-make-infinite-each-with-object-actually-lazy/53631048#53631048", "title": "How to make infinite each_with_object actually lazy?", "body": "<p><code>each_with_object</code> only returns an enumerator if you don't pass a block.</p>\n\n<p>Maybe you could create your own method:</p>\n\n<pre><code>class Enumerator::Lazy\n  def my_each_with_object(obj)\n    Lazy.new(self) do |yielder, *args|\n      yield *args, obj\n      yielder &lt;&lt; obj\n    end\n  end\nend\n\n(1..Float::INFINITY).lazy\n                    .my_each_with_object({a: 0}) { |i, acc| acc[:a] += i }\n                    .drop_while { |acc| acc[:a] &lt;= 10 }\n                    .first\n#=&gt; {:a=&gt;15}\n</code></pre>\n\n<p>I've used <code>acc[:a] &lt;= 10</code> as a condition because you said that it depends on the value calculated by <code>each_with_object</code>.</p>\n"}], "owner": {"reputation": 792, "user_id": 1597707, "user_type": "registered", "accept_rate": 46, "profile_image": "https://i.stack.imgur.com/NQJTN.gif?s=128&g=1", "display_name": "Mike", "link": "https://stackoverflow.com/users/1597707/mike"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 64, "favorite_count": 0, "accepted_answer_id": 53631048, "answer_count": 1, "score": 0, "last_activity_date": 1544008576, "creation_date": 1544006464, "question_id": 53630417, "link": "https://stackoverflow.com/questions/53630417/how-to-make-infinite-each-with-object-actually-lazy", "title": "How to make infinite each_with_object actually lazy?", "body": "<p><strong>tl;dr</strong></p>\n\n<p>I expect both of those lines to return <code>{:a =&gt; 10}</code></p>\n\n<pre><code>p (0..5).each_with_object({a: 0}) { |i, acc| acc[:a] += i}\np (0..Float::INFINITY).lazy.each_with_object({a: 0}) { |i, acc| acc[:a] += i}.first(5)\n</code></pre>\n\n<p>However, the second line loops forever. </p>\n\n<p><strong>Longer version</strong></p>\n\n<p>This example is of course simplified whilst the real problem is very similar. The idea is to run <code>each_with_object</code> body until certain condition is met, however this condition relies on result that this very <code>each_with_object</code> function generates over each iteration so the stop condition must come <em>after</em> <code>each_with_object</code>.</p>\n\n<p>The closest I could get was </p>\n\n<pre><code>p (0..Float::INFINITY).lazy.each_with_object({a: 0}).take_while{ |i, acc| acc[:a] += i}.first(5)\n</code></pre>\n\n<p>but the result is not exactly what I want as it returns the following</p>\n\n<pre><code>[[0, {:a=&gt;10}], [1, {:a=&gt;10}], [2, {:a=&gt;10}], [3, {:a=&gt;10}], [4, {:a=&gt;10}]]\n</code></pre>\n\n<p>which not only forces me to do <code>.last.last</code> but also makes the array grow immensely as I iterate many times (and also it stores 5 times the <code>{:a =&gt; 10}</code> instead of <code>{a:=&gt;0}, {a:=&gt;1}, {a:=&gt;3}, ...</code> which is also a mystery to me.</p>\n"}, {"tags": ["ruby", "macos", "jekyll"], "answers": [{"tags": [], "owner": {"reputation": 220, "user_id": 5291993, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/3be6ab83cb5ac668b2af4d697c1bbec6?s=128&d=identicon&r=PG&f=1", "display_name": "greystash", "link": "https://stackoverflow.com/users/5291993/greystash"}, "is_accepted": true, "score": 0, "last_activity_date": 1544005697, "creation_date": 1544005697, "answer_id": 53630170, "question_id": 53629311, "link": "https://stackoverflow.com/questions/53629311/updating-ruby-mac-os-10-6-8-snow-leopard/53630170#53630170", "title": "Updating Ruby Mac OS 10.6.8 Snow Leopard", "body": "<p>I'm not sure what actually fixed this but I ran the following commands after reading other posts and now have Jekyll 3.8.3 installed and ruby 2.5.3p105.</p>\n\n<p><code>sudo chown -R \"$USER\":admin /usr/local</code></p>\n\n<p><code>export PATH=/usr/local/bin:$PATH</code></p>\n\n<p><code>brew link --overwrite ruby --force</code></p>\n\n<p><code>gem install jekyll</code></p>\n"}, {"comments": [{"owner": {"reputation": 3201, "user_id": 2892779, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uvM8S.jpg?s=128&g=1", "display_name": "Jay Dorsey", "link": "https://stackoverflow.com/users/2892779/jay-dorsey"}, "reply_to_user": {"reputation": 220, "user_id": 5291993, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/3be6ab83cb5ac668b2af4d697c1bbec6?s=128&d=identicon&r=PG&f=1", "display_name": "greystash", "link": "https://stackoverflow.com/users/5291993/greystash"}, "edited": false, "score": 0, "creation_date": 1544535812, "post_id": 53632281, "comment_id": 94304108, "body": "I&#39;m not sure why, but a few people downvoted this response. If you can provide clarification I&#39;d appreciate it. It&#39;s as common knowledge to everyone to update their shell profile as it is to export the path in the first place (e.g. not so common)"}], "tags": [], "owner": {"reputation": 3201, "user_id": 2892779, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uvM8S.jpg?s=128&g=1", "display_name": "Jay Dorsey", "link": "https://stackoverflow.com/users/2892779/jay-dorsey"}, "is_accepted": false, "score": 1, "last_activity_date": 1544012681, "creation_date": 1544012681, "answer_id": 53632281, "question_id": 53629311, "link": "https://stackoverflow.com/questions/53629311/updating-ruby-mac-os-10-6-8-snow-leopard/53632281#53632281", "title": "Updating Ruby Mac OS 10.6.8 Snow Leopard", "body": "<p>You have (or had) a path issue. Before you did your follow up steps, if you had run <code>which ruby</code> you'd probably see it pointing to <code>/usr/bin/ruby</code> which is system ruby, not your homebrew ruby in <code>/usr/local/bin/ruby</code>.</p>\n\n<p>You still need to, if you haven't already, add your export command to your <code>~/.bash_profile</code> file to ensure your <code>PATH</code> gets updated for every terminal window you open.</p>\n"}], "owner": {"reputation": 220, "user_id": 5291993, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/3be6ab83cb5ac668b2af4d697c1bbec6?s=128&d=identicon&r=PG&f=1", "display_name": "greystash", "link": "https://stackoverflow.com/users/5291993/greystash"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 201, "favorite_count": 0, "accepted_answer_id": 53630170, "answer_count": 2, "score": 1, "last_activity_date": 1544012681, "creation_date": 1544003077, "question_id": 53629311, "link": "https://stackoverflow.com/questions/53629311/updating-ruby-mac-os-10-6-8-snow-leopard", "title": "Updating Ruby Mac OS 10.6.8 Snow Leopard", "body": "<p>I'm trying to install a more recent version of Ruby on Snow Leopard so I can install Jekyll. When trying to install any version of Jekyll I get an error saying that it requires liquid, which requires ruby v2+.</p>\n\n<p>If I try upgrade via rbenv I get the following when trying all versions:</p>\n\n<p><code>error: failed to download ruby-2.1.1.tar.bz2</code></p>\n\n<p><code>BUILD FAILED (OS X 10.6.8 using ruby-build 20181019)</code></p>\n\n<p>I've also installed Ruby manually from source but this isn't recognised by the system and I can't switch versions.\nIf i run <code>rbenv global</code> it only recognises the System version of Ruby.</p>\n\n<p>When I try <code>brew upgrade ruby</code> I get the following error:</p>\n\n<p><code>ruby 2.5.3_1 already installed</code></p>\n\n<p>If I try link to the new version with brew I get the following error:</p>\n\n<p><code>brew link --force --overwrite ruby@2.5.3_1</code></p>\n\n<p><code>Error: No such keg: /usr/local/Cellar/ruby@2.5.3_1</code></p>\n\n<p>RVM doesn't install so I'm not sure what to do next. Below are the details of the packages I have installed.</p>\n\n<p>Xcode 3.2.2 (I cant get an installer working for any higher versions of Xcode). The more recent versions hosted by Apple for Snow Leopard are corrupt when downloaded.</p>\n\n<p>rbenv 1.1.1</p>\n\n<p>brew 1.8.4</p>\n\n<p>ruby 1.8.7 (System)</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-3", "ruby-on-rails-4"], "comments": [{"owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 0, "creation_date": 1544002851, "post_id": 53629194, "comment_id": 94117976, "body": "You cannot concat a fixnum and a string."}, {"owner": {"reputation": 5312, "user_id": 6535997, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/10156345016155058/picture?type=large", "display_name": "Mark", "link": "https://stackoverflow.com/users/6535997/mark"}, "edited": false, "score": 0, "creation_date": 1544003044, "post_id": 53629194, "comment_id": 94118087, "body": "I think it&#39;s pretty clear what they meant..."}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "reply_to_user": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 1, "creation_date": 1544004039, "post_id": 53629194, "comment_id": 94118741, "body": "@sawa <code>&#39;are you sure&#39;.concat(63)</code> ;-)"}, {"owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "reply_to_user": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 1, "creation_date": 1544004800, "post_id": 53629194, "comment_id": 94119195, "body": "@Stefan Good point, but that fixnum is actually just describing a single-character string. The method name is ineeed <code>concat</code>, that it is not concatenation of a string with a fixnum. And also, it is concatenation of a string with a fixnum, not concatenation of a fixnum with a string."}, {"owner": {"reputation": 5060, "user_id": 10522579, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7GQ6a.jpg?s=128&g=1", "display_name": "ray", "link": "https://stackoverflow.com/users/10522579/ray"}, "edited": false, "score": 0, "creation_date": 1544167457, "post_id": 53629194, "comment_id": 94187584, "body": "Do you really know how erb tag works?"}], "answers": [{"tags": [], "owner": {"reputation": 27144, "user_id": 3857758, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/58c4295826435f049b7fc32b98c240f9?s=128&d=identicon&r=PG&f=1", "display_name": "Ursus", "link": "https://stackoverflow.com/users/3857758/ursus"}, "is_accepted": false, "score": 3, "last_activity_date": 1544003945, "last_edit_date": 1544003945, "creation_date": 1544003011, "answer_id": 53629291, "question_id": 53629194, "link": "https://stackoverflow.com/questions/53629194/how-to-concat-fixnum-and-string-in-rails/53629291#53629291", "title": "how to concat fixnum and string in rails?", "body": "<p>This way</p>\n\n<pre><code>\"activate\" + employee.id.to_s\n</code></pre>\n\n<p>works because you concatenate two strings</p>\n\n<p>or this one</p>\n\n<pre><code>\"activate#{employee.id}\"\n</code></pre>\n\n<p>interpolation calls <code>to_s</code> for the expression passed</p>\n"}, {"tags": [], "owner": {"reputation": 5060, "user_id": 10522579, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7GQ6a.jpg?s=128&g=1", "display_name": "ray", "link": "https://stackoverflow.com/users/10522579/ray"}, "is_accepted": false, "score": 0, "last_activity_date": 1544168324, "creation_date": 1544168324, "answer_id": 53665181, "question_id": 53629194, "link": "https://stackoverflow.com/questions/53629194/how-to-concat-fixnum-and-string-in-rails/53665181#53665181", "title": "how to concat fixnum and string in rails?", "body": "<p>First if you are providing collection, it must be <strong>plural</strong>, so use <code>@users</code> instead of <code>@user</code>. (Follow conventions for readability)</p>\n\n<pre><code> &lt;% @users.each do |user| %&gt;\n   &lt;td&gt;&lt;%=user.username%&gt;&lt;/td&gt;\n   &lt;td&gt;\n     &lt;%= link_to 'activate', activate_path(id: user.id), method: :patch, id: \"activate#{user.id}\" %&gt;\n   &lt;/td&gt;\n &lt;% end %&gt;\n</code></pre>\n"}], "owner": {"reputation": 57, "user_id": 10728400, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xxD9M.jpg?s=128&g=1", "display_name": "divya", "link": "https://stackoverflow.com/users/10728400/divya"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 92, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1544168324, "creation_date": 1544002710, "last_edit_date": 1544004164, "question_id": 53629194, "link": "https://stackoverflow.com/questions/53629194/how-to-concat-fixnum-and-string-in-rails", "title": "how to concat fixnum and string in rails?", "body": "<p>i want to contat my static id + looping primary key id</p>\n\n<pre><code> &lt;% @user.each do |employee| %&gt;\n   &lt;td&gt;&lt;%=employee.username%&gt;&lt;/td&gt;\n   &lt;td&gt;\n     &lt;%= link_to 'activate', activate_path(id: employee.id), method: :patch, id: \"activate\"+\"&lt;%=employee.id%&gt;\".to_s %&gt;\n   &lt;/td&gt;\n &lt;% end %&gt;\n</code></pre>\n\n<p>The <code>id: \"activate\"+\"&lt;%=employee.id%&gt;\".to_s</code> part isn't working.</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 1160, "user_id": 6949178, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-yW1nZs8m-_4/AAAAAAAAAAI/AAAAAAAAAIk/Je9U6NaDvuY/photo.jpg?sz=128", "display_name": "Stoogy", "link": "https://stackoverflow.com/users/6949178/stoogy"}, "edited": false, "score": 0, "creation_date": 1544004491, "post_id": 53629170, "comment_id": 94119015, "body": "Hello! Can you write the error message you have instead of giving the image?"}], "answers": [{"tags": [], "owner": {"reputation": 21613, "user_id": 580346, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/ba17945a06aac247b06548d5afe341e8?s=128&d=identicon&r=PG", "display_name": "mrzasa", "link": "https://stackoverflow.com/users/580346/mrzasa"}, "is_accepted": true, "score": 1, "last_activity_date": 1544002829, "creation_date": 1544002829, "answer_id": 53629230, "question_id": 53629170, "link": "https://stackoverflow.com/questions/53629170/how-to-run-this-ruby-file-that-needs-an-argument/53629230#53629230", "title": "How to run this ruby file that needs an argument?", "body": "<p>It's a script that can be run from cmd with</p>\n\n<pre><code>ruby convertST1.rb file.stl\n</code></pre>\n"}], "owner": {"reputation": 1100, "user_id": 10344668, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e11d46d645a5862db5b000ba480e78ab?s=128&d=identicon&r=PG&f=1", "display_name": "TerribleDog", "link": "https://stackoverflow.com/users/10344668/terribledog"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 29, "favorite_count": 0, "accepted_answer_id": 53629230, "answer_count": 1, "score": -1, "last_activity_date": 1544031273, "creation_date": 1544002614, "last_edit_date": 1544031273, "question_id": 53629170, "link": "https://stackoverflow.com/questions/53629170/how-to-run-this-ruby-file-that-needs-an-argument", "title": "How to run this ruby file that needs an argument?", "body": "<p>I just wanted this function to run and get the output, but I can't seem to make it run. </p>\n\n<p>I installed Interactive Ruby for this.</p>\n\n<p>This is the code:</p>\n\n<pre><code>class Float\ndef to_sn # to scientific notation\n\"%E\" % self\nend\n\ndef self.from_sn str # generate a float from scientific notation\n(\"%f\" % str).to_f\nend\nend\n\n# Pass in filename as only argument\nif ARGV.size != 1 \n puts \"Usage: ./converSTL.rb [stl filename]\"\n\n\n exit\nend\nbegin\n  original = File.new(ARGV[0], \"r\")\n\n  # Read first line - check binary or ASCII\n  tempLine = original.gets\n  if tempLine.include? \"solid\"\n    outFilename = ARGV[0].sub(/\\.stl/i, '-binary.stl')\n    puts \"#{ARGV[0]} is in ASCII format, converting to BINARY: #{outFilename}\"\n    outFile = File.new(outFilename, \"w\")\n    outFile.write(\"\\0\" * 80) # 80 bit header - ignored\n    outFile.write(\"FFFF\")   # 4 bit integer # of triangles - filled later\n    triCount = 0\n\n    while temp = original.gets\n      next if temp =~ /^\\s*$/ or temp.include? 'endsolid' # ignore whitespace\n      temp.sub! /facet normal/, ''\n      normal = temp.split(' ').map{ |num| Float.from_sn num }\n      triCount += 1\n      temp = original.gets # 'outer loop'\n\n      temp = original.gets\n      vertexA = temp.sub(/vertex/, '').split(' ').map{ |num| Float.from_sn num }\n      temp = original.gets\n      vertexB = temp.sub(/vertex/, '').split(' ').map{ |num| Float.from_sn num }\n      temp = original.gets\n      vertexC = temp.sub(/vertex/, '').split(' ').map{ |num| Float.from_sn num }\n\n      temp = original.gets # 'endsolid'\n      temp = original.gets # 'endfacet'\n\n      outFile.write(normal.pack(\"FFF\"))\n      outFile.write(vertexA.pack(\"FFF\"))\n      outFile.write(vertexB.pack(\"FFF\"))\n      outFile.write(vertexC.pack(\"FFF\"))\n      outFile.write(\"\\0\\0\")\n    end\n    outFile.seek(80, IO::SEEK_SET)\n    outFile.write([ triCount ].pack(\"V\"))\n    outFile.close\n\n  else\n    outFilename = ARGV[0].sub(/\\.stl/i, '-ascii.stl')\n    puts \"#{ARGV[0]} is in BINARY format, converting to ASCII: #{outFilename}\"\n    outFile = File.new(outFilename, \"w\")\n    outFile.write(\"solid \\n\")\n    original.seek(80, IO::SEEK_SET)\n    triCount = original.read(4).unpack('V')[0]\n    triCount.times do |triNdx|\n      normal = original.read(12).unpack('FFF')\n      vertexA = original.read(12).unpack('FFF')\n      vertexB = original.read(12).unpack('FFF')\n      vertexC = original.read(12).unpack('FFF')\n      original.seek(2, IO::SEEK_CUR)\n\n      outFile.write(\"  facet normal #{normal[0].to_sn} #{normal[1].to_sn} #{normal[2].to_sn}\\n\")\n      outFile.write(\"    outer loop\\n\")\n      outFile.write(\"      vertex #{vertexA[0].to_sn} #{vertexA[1].to_sn} #{vertexA[2].to_sn}\\n\")\n      outFile.write(\"      vertex #{vertexB[0].to_sn} #{vertexB[1].to_sn} #{vertexB[2].to_sn}\\n\")\n      outFile.write(\"      vertex #{vertexC[0].to_sn} #{vertexC[1].to_sn} #{vertexC[2].to_sn}\\n\")\n      outFile.write(\"    endloop\\n\")\n      outFile.write(\"  endfacet\\n\")\n    end\n\n    outFile.write(\"endsolid \\n\")\n    outFile.close\n  end\n  original.close\nrescue =&gt; error\n  puts \"Error: #{error}\"\nend\n</code></pre>\n\n<p>And everytime I try to run it, I get this error:</p>\n\n<p><a href=\"https://i.stack.imgur.com/BYgSO.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/BYgSO.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["ruby-on-rails", "ruby", "rspec"], "answers": [{"tags": [], "owner": {"reputation": 21613, "user_id": 580346, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/ba17945a06aac247b06548d5afe341e8?s=128&d=identicon&r=PG", "display_name": "mrzasa", "link": "https://stackoverflow.com/users/580346/mrzasa"}, "is_accepted": true, "score": 2, "last_activity_date": 1547096838, "last_edit_date": 1547096838, "creation_date": 1544001506, "answer_id": 53628835, "question_id": 53628688, "link": "https://stackoverflow.com/questions/53628688/model-validation-fails-in-rspec-when-i-add-custom-validation-in-model/53628835#53628835", "title": "Model Validation fails in RSpec when I add custom validation in model", "body": "<p>You get an error because <code>start_day</code> is <code>nil</code>. I would add guards to custom validtors:</p>\n\n<pre><code>def start_day_cant_be_past\n  return unless start_day\n\n  if start_day &lt; Date.today\n    errors.add(:start_day, 'can not be in the past')\n  end\nend\n\ndef end_day_cant_be_less_than_start_day\n  return unless end_day &amp;&amp; start_day\n\n  if end_day &lt; start_day\n    errors.add(:end_day, 'can not be less than start day')\n  end\nend\n</code></pre>\n\n<p>To test those custom validators, I'd write regular test examples, e.g.:</p>\n\n<pre><code>it 'is invalid with start day in the past' do\n  leave = Leave.new(start_day: 2.days.ago)\n  expect(leave).to be_invalid\n  expect(leave.errors[:start_day]).not_to be_empty\nend\n\nit 'is invalid with start day later than end day' do\n  leave = Leave.new(start_day: 2.days.ago, start_day: 5.days.ago)\n  expect(leave).to be_invalid\n  expect(leave.errors[:end_day]).not_to be_empty\nend\n</code></pre>\n"}], "owner": {"reputation": 181, "user_id": 5756014, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DiSqt.jpg?s=128&g=1", "display_name": "user5756014", "link": "https://stackoverflow.com/users/5756014/user5756014"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 140, "favorite_count": 0, "accepted_answer_id": 53628835, "answer_count": 1, "score": 1, "last_activity_date": 1603359547, "creation_date": 1544000979, "last_edit_date": 1603359547, "question_id": 53628688, "link": "https://stackoverflow.com/questions/53628688/model-validation-fails-in-rspec-when-i-add-custom-validation-in-model", "title": "Model Validation fails in RSpec when I add custom validation in model", "body": "<p>I have a model with two custom validation rules. When I remove these rules, RSpec for model validation passes. But adding those validation in model, RSpec can't pass which were previously passing. <strong>How can I solve this error</strong> and also <strong>how can I write RSpec for these custom validations?</strong></p>\n\n<p>My model file <code>leave.rb</code></p>\n\n<pre><code>class Leave &lt; ApplicationRecord\n  scope :sorted_asc, lambda { order(id: :asc) }\n  validates :start_day, :end_day,  :reason, :status, presence: true\n  validate :start_day_cant_be_past, :end_day_cant_be_less_than_start_day\n  enum category: { 'Sick': 0, 'Leave in Policy': 1, 'Out of Policy': 2 }\n\n  def start_day_cant_be_past\n    if start_day &lt; Date.today\n      errors.add(:start_day, 'can not be in the past')\n    end\n  end\n\n  def end_day_cant_be_less_than_start_day\n    if end_day &lt; start_day\n      errors.add(:end_day, 'can not be less than start day')\n    end\n  end\nend\n</code></pre>\n\n<p>My RSpec file for model <code>leave_spec.rb</code> </p>\n\n<pre><code>require 'rails_helper'\n\nRSpec.describe Leave, type: :model do\n  it { should define_enum_for(:category).with(['Sick', 'Leave in Policy', 'Out of Policy']) }\n  it { is_expected.to validate_presence_of(:start_day) }\n  it { is_expected.to validate_presence_of(:end_day) }\n  it { is_expected.to validate_presence_of(:reason) }\n  it { is_expected.to validate_presence_of(:status) }\nend\n</code></pre>\n\n<p>And the error I get is...</p>\n\n<pre><code>Leave should validate that :start_day cannot be empty/falsy\n     Failure/Error: if start_day &lt; Date.today\n\n     NoMethodError:\n       undefined method `&lt;' for nil:NilClass\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-4"], "answers": [{"comments": [{"owner": {"reputation": 1560, "user_id": 5614748, "user_type": "registered", "accept_rate": 68, "profile_image": "https://graph.facebook.com/10153324566173505/picture?type=large", "display_name": "Afolabi Olaoluwa Akinwumi", "link": "https://stackoverflow.com/users/5614748/afolabi-olaoluwa-akinwumi"}, "edited": false, "score": 0, "creation_date": 1544001536, "post_id": 53628679, "comment_id": 94117244, "body": "Its a logic in a rake task which is the <code>lib&#47;</code> path. Rake file cannot be dropped into <code>&#47;app&#47;models&#47;order.rb</code>. Seem I will have to take the other suggestion by making sure the method is available in <code>lib&#47;</code>"}, {"owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "reply_to_user": {"reputation": 1560, "user_id": 5614748, "user_type": "registered", "accept_rate": 68, "profile_image": "https://graph.facebook.com/10153324566173505/picture?type=large", "display_name": "Afolabi Olaoluwa Akinwumi", "link": "https://stackoverflow.com/users/5614748/afolabi-olaoluwa-akinwumi"}, "edited": false, "score": 0, "creation_date": 1544001679, "post_id": 53628679, "comment_id": 94117319, "body": "No, I am not mentioning the lib file. It&#39;s about the your <code>Member.rb</code> file."}, {"owner": {"reputation": 1560, "user_id": 5614748, "user_type": "registered", "accept_rate": 68, "profile_image": "https://graph.facebook.com/10153324566173505/picture?type=large", "display_name": "Afolabi Olaoluwa Akinwumi", "link": "https://stackoverflow.com/users/5614748/afolabi-olaoluwa-akinwumi"}, "edited": false, "score": 0, "creation_date": 1544003064, "post_id": 53628679, "comment_id": 94118105, "body": "So, you think a <code>before_action :liquidity_manager?</code> on member.rb will work?"}, {"owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "reply_to_user": {"reputation": 1560, "user_id": 5614748, "user_type": "registered", "accept_rate": 68, "profile_image": "https://graph.facebook.com/10153324566173505/picture?type=large", "display_name": "Afolabi Olaoluwa Akinwumi", "link": "https://stackoverflow.com/users/5614748/afolabi-olaoluwa-akinwumi"}, "edited": false, "score": 0, "creation_date": 1544003199, "post_id": 53628679, "comment_id": 94118201, "body": "You mean <code>Member.rb</code> instead of <code>member.rb</code>? If so, yes as long as you can get to that file."}, {"owner": {"reputation": 1560, "user_id": 5614748, "user_type": "registered", "accept_rate": 68, "profile_image": "https://graph.facebook.com/10153324566173505/picture?type=large", "display_name": "Afolabi Olaoluwa Akinwumi", "link": "https://stackoverflow.com/users/5614748/afolabi-olaoluwa-akinwumi"}, "edited": false, "score": 0, "creation_date": 1544003267, "post_id": 53628679, "comment_id": 94118237, "body": "Yes. Member.rb. Forgive my typo"}], "tags": [], "owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "is_accepted": false, "score": 1, "last_activity_date": 1544000951, "creation_date": 1544000951, "answer_id": 53628679, "question_id": 53628497, "link": "https://stackoverflow.com/questions/53628497/nomethoderror-undefined-method-liquidity-manager-for-order0x007fd9b7a4cf9/53628679#53628679", "title": "NoMethodError: undefined method `liquidity_manager?&#39; for #&lt;Order:0x007fd9b7a4cf98&gt;", "body": "<p>You defined <code>Order#liquidity_manager?</code> in <code>Member.rb</code>, which is not automatically loaded by Rails. You have to either explicitly load the file <code>Member.rb</code>, or rename that file to <code>/app/models/order.rb</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 1560, "user_id": 5614748, "user_type": "registered", "accept_rate": 68, "profile_image": "https://graph.facebook.com/10153324566173505/picture?type=large", "display_name": "Afolabi Olaoluwa Akinwumi", "link": "https://stackoverflow.com/users/5614748/afolabi-olaoluwa-akinwumi"}, "is_accepted": true, "score": 1, "last_activity_date": 1544007604, "creation_date": 1544007604, "answer_id": 53630740, "question_id": 53628497, "link": "https://stackoverflow.com/questions/53628497/nomethoderror-undefined-method-liquidity-manager-for-order0x007fd9b7a4cf9/53630740#53630740", "title": "NoMethodError: undefined method `liquidity_manager?&#39; for #&lt;Order:0x007fd9b7a4cf98&gt;", "body": "<p>So from the advise given to me by @sawa in the answer section, here is what I have done to make it work.</p>\n\n<pre><code>num_counts = (Order.count/10).ceil\nnum_counts.times do |i|\n  Order.all.offset(i*10).limit(10).find_each do |g|\n    if g.tags.blank? \n      if g.member.liquidity_manager? # So this easily gets to Member.rb to reference liquidity_manager? method.\n        g.tags = 'LM'\n        g.save!\n      else\n        g.tags = 'Customer'\n        g.save!\n      end\n    end\n  end\nend\n</code></pre>\n"}], "owner": {"reputation": 1560, "user_id": 5614748, "user_type": "registered", "accept_rate": 68, "profile_image": "https://graph.facebook.com/10153324566173505/picture?type=large", "display_name": "Afolabi Olaoluwa Akinwumi", "link": "https://stackoverflow.com/users/5614748/afolabi-olaoluwa-akinwumi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 24, "favorite_count": 0, "accepted_answer_id": 53630740, "answer_count": 2, "score": 0, "last_activity_date": 1544007604, "creation_date": 1544000302, "question_id": 53628497, "link": "https://stackoverflow.com/questions/53628497/nomethoderror-undefined-method-liquidity-manager-for-order0x007fd9b7a4cf9", "title": "NoMethodError: undefined method `liquidity_manager?&#39; for #&lt;Order:0x007fd9b7a4cf98&gt;", "body": "<p>My solution throws NoMethodError. This is what I have done below:</p>\n\n<p><strong>Order.rb</strong></p>\n\n<pre><code>class Order &lt; ActiveRecord::Base\n  belongs_to :member\nend\n</code></pre>\n\n<p><strong>Member.rb</strong></p>\n\n<pre><code>class Order &lt; ActiveRecord::Base\n  has_many :orders\n\n  def liquidity_manager?\n    @is_liquidity_manager ||= self.class.liquidity_managers.include?(self.email)\n  end\n\n  def liquidity_managers\n    ENV['LM_ACCOUNTS'].split(',')\n  end\nend\n</code></pre>\n\n<p><strong>rake task logic</strong></p>\n\n<p>The logic in <em>lib/update_order_tags.rake</em></p>\n\n<pre><code>num_counts = (Order.count/10).ceil\nnum_counts.times do |i|\n  Order.all.offset(i*10).limit(10).find_each do |g|\n    if g.tags.blank? # am saving on only the blank fields\n      if g.liquidity_manager? # The error is here\n        g.tags = 'LM'\n        g.save!\n      else\n        g.tags = 'Customer'\n        g.save!\n      end\n    end\n  end\nend\n</code></pre>\n\n<p>How do I reference the <code>liquidity_manager?</code> method to be useful for me in lib?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-4", "turbolinks"], "comments": [{"owner": {"reputation": 543, "user_id": 5758268, "user_type": "registered", "profile_image": "https://graph.facebook.com/620704168067839/picture?type=large", "display_name": "Patrick Barattin", "link": "https://stackoverflow.com/users/5758268/patrick-barattin"}, "edited": false, "score": 0, "creation_date": 1544037031, "post_id": 53627572, "comment_id": 94137899, "body": "I do not understand the problem, about double rendering or incorrect rendering?"}], "answers": [{"comments": [{"owner": {"reputation": 5144, "user_id": 5411461, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/RyJfN.jpg?s=128&g=1", "display_name": "Haseeb Ahmad", "link": "https://stackoverflow.com/users/5411461/haseeb-ahmad"}, "edited": false, "score": 0, "creation_date": 1544085219, "post_id": 53641779, "comment_id": 94153052, "body": "Meanz there is no solution of it by which I can avoid it"}], "tags": [], "owner": {"reputation": 3742, "user_id": 783009, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/8efefc827b7980fd8e39a04439d9295a?s=128&d=identicon&r=PG", "display_name": "Dom Christie", "link": "https://stackoverflow.com/users/783009/dom-christie"}, "is_accepted": false, "score": 2, "last_activity_date": 1544049141, "creation_date": 1544049141, "answer_id": 53641779, "question_id": 53627572, "link": "https://stackoverflow.com/questions/53627572/turbolinks-content-reload-load-pages-twice/53641779#53641779", "title": "Turbolinks content reload load pages twice", "body": "<p>This is the intended behaviour of the reload <code>turbolinks-visit-control</code>. When clicking a link, Turbolinks will request the page (hitting the action the first time). Then it will parse the response and notice the <code>turbolinks-visit-control</code> meta tag, and perform a full page reload (hitting the action the second time).</p>\n\n<p>You should only need to use <code>turbolinks-visit-control</code> when you are sure you want a full page load.</p>\n"}], "owner": {"reputation": 5144, "user_id": 5411461, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/RyJfN.jpg?s=128&g=1", "display_name": "Haseeb Ahmad", "link": "https://stackoverflow.com/users/5411461/haseeb-ahmad"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 397, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1561802525, "creation_date": 1543996444, "last_edit_date": 1561802525, "question_id": 53627572, "link": "https://stackoverflow.com/questions/53627572/turbolinks-content-reload-load-pages-twice", "title": "Turbolinks content reload load pages twice", "body": "<p>I am facing an issue in my site that there are multiple layouts, so when i move from one layout to another then I do</p>\n\n<pre><code>&lt;meta name=\"turbolinks-visit-control\" content=\"reload\"&gt;\n</code></pre>\n\n<p>but issue is that i load my page twice or hit action twice</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "activerecord"], "comments": [{"owner": {"reputation": 578, "user_id": 2824786, "user_type": "registered", "accept_rate": 21, "profile_image": "https://graph.facebook.com/100000177420532/picture?type=large", "display_name": "Qubaish Bhatti", "link": "https://stackoverflow.com/users/2824786/qubaish-bhatti"}, "edited": false, "score": 0, "creation_date": 1543996288, "post_id": 53627434, "comment_id": 94114782, "body": "Are you sure when the device.car = nil line runs it gets committed to database ?   It will only commit to database when you save the device otherwise it assigned nil value to device object but not in database."}, {"owner": {"reputation": 2210, "user_id": 4811651, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/ozvMA.jpg?s=128&g=1", "display_name": "Sean Magyar", "link": "https://stackoverflow.com/users/4811651/sean-magyar"}, "reply_to_user": {"reputation": 578, "user_id": 2824786, "user_type": "registered", "accept_rate": 21, "profile_image": "https://graph.facebook.com/100000177420532/picture?type=large", "display_name": "Qubaish Bhatti", "link": "https://stackoverflow.com/users/2824786/qubaish-bhatti"}, "edited": false, "score": 0, "creation_date": 1543996435, "post_id": 53627434, "comment_id": 94114837, "body": "I thought that would be the case as well. But I was running it in console and when I ran that line it got committed."}, {"owner": {"reputation": 578, "user_id": 2824786, "user_type": "registered", "accept_rate": 21, "profile_image": "https://graph.facebook.com/100000177420532/picture?type=large", "display_name": "Qubaish Bhatti", "link": "https://stackoverflow.com/users/2824786/qubaish-bhatti"}, "edited": false, "score": 0, "creation_date": 1543996612, "post_id": 53627434, "comment_id": 94114919, "body": "May be this answer will help you.   <a href=\"https://stackoverflow.com/questions/23499270/rails-3-has-one-association-unlink-associated-object-without-destroying-it\" title=\"rails 3 has one association unlink associated object without destroying it\">stackoverflow.com/questions/23499270/&hellip;</a>"}, {"owner": {"reputation": 159, "user_id": 9722060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fd6af43aa5acad3d7111cc6be4d835bb?s=128&d=identicon&r=PG&f=1", "display_name": "Stefan Rendevski", "link": "https://stackoverflow.com/users/9722060/stefan-rendevski"}, "edited": false, "score": 0, "creation_date": 1544009514, "post_id": 53627434, "comment_id": 94122024, "body": "<code>device.car = nil</code> gets committed to the database because of how <code>HasOneAssociation</code> implements the writer method <code>car=</code>. There is no way to unlink the association from <code>Device</code>, as the attribute that creates the link is located in <code>Car</code>."}], "answers": [{"tags": [], "owner": {"reputation": 126, "user_id": 1966273, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95f93e2a404fd77902bd95a45f487bb4?s=128&d=identicon&r=PG", "display_name": "lbhise", "link": "https://stackoverflow.com/users/1966273/lbhise"}, "is_accepted": false, "score": 1, "last_activity_date": 1544017345, "creation_date": 1544017345, "answer_id": 53633731, "question_id": 53627434, "link": "https://stackoverflow.com/questions/53627434/rails-preferred-way-of-setting-foreign-key-to-nil-on-child/53633731#53633731", "title": "Rails preferred way of setting foreign_key to nil on child", "body": "<p>After trying different ways I found below code to work as expected :</p>\n\n<pre><code>def disconnect_car_and_device(id:)\n  device = Device.find(id)\n\n  authorize(current_user, device)\n  car = device.car\n\n  if device.save &amp;&amp; car.update(device: nil)\n    { device: device, errors: [] }\n  else\n    { device: nil, errors: build_errors(device.errors) }\n  end\nend\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 6359, "user_id": 6143656, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/ee15a9ee7eb1213ec2702d1b30ee3c6f?s=128&d=identicon&r=PG", "display_name": "Roel", "link": "https://stackoverflow.com/users/6143656/roel"}, "edited": false, "score": 0, "creation_date": 1544019827, "post_id": 53634352, "comment_id": 94128234, "body": "Hi! It would always be better to leave an explanation to your answer."}], "tags": [], "owner": {"reputation": 11, "user_id": 6615064, "user_type": "registered", "profile_image": "https://graph.facebook.com/253325035052171/picture?type=large", "display_name": "Yuri Afanasyev", "link": "https://stackoverflow.com/users/6615064/yuri-afanasyev"}, "is_accepted": false, "score": 1, "last_activity_date": 1544019442, "creation_date": 1544019442, "answer_id": 53634352, "question_id": 53627434, "link": "https://stackoverflow.com/questions/53627434/rails-preferred-way-of-setting-foreign-key-to-nil-on-child/53634352#53634352", "title": "Rails preferred way of setting foreign_key to nil on child", "body": "<pre><code>def disconnect_car_and_device(id:)\n  device = Device.find(id)\n\n  authorize(current_user, device)\n\n  device.transaction do\n    device.car = nil\n\n    if device.save\n      { device: device, errors: [] }\n    else\n      raise ActiveRecord::Rollback\n      { device: nil, errors: build_errors(device.errors) }\n    end\n  end\nend\n</code></pre>\n"}], "owner": {"reputation": 2210, "user_id": 4811651, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/ozvMA.jpg?s=128&g=1", "display_name": "Sean Magyar", "link": "https://stackoverflow.com/users/4811651/sean-magyar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 60, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1544019442, "creation_date": 1543995819, "question_id": 53627434, "link": "https://stackoverflow.com/questions/53627434/rails-preferred-way-of-setting-foreign-key-to-nil-on-child", "title": "Rails preferred way of setting foreign_key to nil on child", "body": "<p>I have a <code>has_one</code> relationship with <code>Device</code> and <code>Car</code>.</p>\n\n<p>What's the preferred way with <code>ActiveRecord</code> for removing the child from the parent (setting the <code>device_id</code> nil on the <code>car</code> but NOT deleting the <code>car</code> itself)?</p>\n\n<p>When the <code>device.car = nil</code> line runs it gets committed immediately to the database. I want it to be committed only on save and return some useful error if it doesn't get saved.</p>\n\n<p>I know I could also try to lookup the <code>car</code>, set the <code>dongle_id</code> to <code>nil</code> and save that, but this action is rather about the <code>device</code> than the <code>car</code>.</p>\n\n<p>mutation:</p>\n\n<pre><code>def disconnect_car_and_device(id:)\n  device = Device.find(id)\n\n  authorize(current_user, device)\n\n  device.car = nil\n\n  if device.save\n    { device: device, errors: [] }\n  else\n    { device: nil, errors: build_errors(device.errors) }\n  end\nend\n</code></pre>\n\n<p>models:</p>\n\n<pre><code>class Device &lt; ApplicationRecord\n  has_one :car\nend\n\nclass Car &lt; ApplicationRecord\n  belongs_to :device\nend\n</code></pre>\n"}, {"tags": ["ruby", "rspec", "capybara", "rspec-rails"], "answers": [{"comments": [{"owner": {"reputation": 1668, "user_id": 1576822, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/FY9gu.jpg?s=128&g=1", "display_name": "Sergio Belevskij", "link": "https://stackoverflow.com/users/1576822/sergio-belevskij"}, "edited": false, "score": 0, "creation_date": 1617352455, "post_id": 53627304, "comment_id": 118285134, "body": "Move this test to your controller tests, then check the response.content_type, response.status, response.headers, response.body."}], "tags": [], "owner": {"reputation": 42014, "user_id": 2709090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/238c2b7cde2c817fc9a5a2b8eaa2ffad?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Walpole", "link": "https://stackoverflow.com/users/2709090/thomas-walpole"}, "is_accepted": true, "score": 5, "last_activity_date": 1543995274, "creation_date": 1543995274, "answer_id": 53627304, "question_id": 53626954, "link": "https://stackoverflow.com/questions/53626954/verify-the-response-code-of-the-page-with-capybara-and-selenium/53627304#53627304", "title": "Verify the response code of the page with Capybara and Selenium", "body": "<p>The Selenium driver doesn\u2019t support status_code because it\u2019s not really something you should be testing in a feature/system test. The idea of feature/system tests (which Capybara is aimed at) is to test from a users perspective. Since a user cares about what is shown in the browser thatts what should be tested for rather than the status code. If you still want to test for the status code it should be done in a request spec rather than a feature/system spec</p>\n"}], "owner": {"reputation": 51, "user_id": 8949092, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DDSRj.jpg?s=128&g=1", "display_name": "S.Kalra", "link": "https://stackoverflow.com/users/8949092/s-kalra"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 902, "favorite_count": 1, "accepted_answer_id": 53627304, "answer_count": 1, "score": 3, "last_activity_date": 1544760070, "creation_date": 1543993730, "last_edit_date": 1544760070, "question_id": 53626954, "link": "https://stackoverflow.com/questions/53626954/verify-the-response-code-of-the-page-with-capybara-and-selenium", "title": "Verify the response code of the page with Capybara and Selenium", "body": "<p>I'm trying to verify the response code of a page by using capybara. I used the expect statement as -</p>\n\n<pre><code>    expect(page.status_code).to eq(404)\n</code></pre>\n\n<p>I'm getting the error as - </p>\n\n<pre><code>    Capybara::NotSupportedByDriverError:\n    Capybara::Driver::Base#status_code\n</code></pre>\n\n<p>Might be status_code is not supported by Capybara. Is there any other way to verify the status/response code or I'm doing something wrong in the expect statement.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "yaml"], "comments": [{"owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 0, "creation_date": 1543991542, "post_id": 53626349, "comment_id": 94112687, "body": "The logic is not clear. What gives you <code>IN</code> and <code>page1</code> for the input <code>client-admin</code>?"}, {"owner": {"reputation": 21, "user_id": 5230700, "user_type": "registered", "profile_image": "https://graph.facebook.com/1570594266563152/picture?type=large", "display_name": "Akshat Uppal", "link": "https://stackoverflow.com/users/5230700/akshat-uppal"}, "reply_to_user": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 0, "creation_date": 1543991810, "post_id": 53626349, "comment_id": 94112797, "body": "the program will get input as the role such as sys-admin or editor-admin and my function has to return all the markets and desired pages for which the value is former."}, {"owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 1, "creation_date": 1543991968, "post_id": 53626349, "comment_id": 94112853, "body": "That is what can be easily guessed. And following that, why should it only return <code>IN</code> and <code>page1</code>, and not anything else that has <code>client-admin</code>?"}, {"owner": {"reputation": 21, "user_id": 5230700, "user_type": "registered", "profile_image": "https://graph.facebook.com/1570594266563152/picture?type=large", "display_name": "Akshat Uppal", "link": "https://stackoverflow.com/users/5230700/akshat-uppal"}, "reply_to_user": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 0, "creation_date": 1543993794, "post_id": 53626349, "comment_id": 94113607, "body": "it should return everything that has cient-admin. For example i am saying IN and page1."}], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 5230700, "user_type": "registered", "profile_image": "https://graph.facebook.com/1570594266563152/picture?type=large", "display_name": "Akshat Uppal", "link": "https://stackoverflow.com/users/5230700/akshat-uppal"}, "edited": false, "score": 0, "creation_date": 1544094714, "post_id": 53634079, "comment_id": 94158449, "body": "can you please give me the json output for the query"}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "reply_to_user": {"reputation": 21, "user_id": 5230700, "user_type": "registered", "profile_image": "https://graph.facebook.com/1570594266563152/picture?type=large", "display_name": "Akshat Uppal", "link": "https://stackoverflow.com/users/5230700/akshat-uppal"}, "edited": false, "score": 0, "creation_date": 1544104180, "post_id": 53634079, "comment_id": 94164005, "body": "@AkshatUppal not sure what JSON has to do with this question. Why are you converting YAML to JSON? Either way the JSON would be <code>&quot;{\\&quot;page1\\&quot;:[\\&quot;sys-admin\\&quot;,\\&quot;client-admin\\&quot;,\\&quot;editor-admin\\&quot;&zwnj;&#8203;],\\&quot;page2\\&quot;:[\\&quot;clien&zwnj;&#8203;t-admin\\&quot;]}&quot;</code>"}], "tags": [], "owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "is_accepted": true, "score": 0, "last_activity_date": 1544018474, "creation_date": 1544018474, "answer_id": 53634079, "question_id": 53626349, "link": "https://stackoverflow.com/questions/53626349/iterate-trough-yaml-file-in-ruby-and-fetching-the-required-data/53634079#53634079", "title": "Iterate trough yaml file in ruby and fetching the required data", "body": "<p>I would suggest re thinking the design of your YAML file to make this easier on yourself. Maybe something along the lines of </p>\n\n<pre><code>doc = &lt;&lt;Y\nmarket:\n  US:\n    prod:\n      page1: \n        - sys-admin \n        - client-admin \n        - editor-admin\n      page2: \n        - client-admin\n      page3: \n        - editor-admin\n        - sys-admin\nY\n</code></pre>\n\n<p>Then finding the correct pages is easy: </p>\n\n<pre><code>locale = 'US' \nenvironment = 'prod'\nuser_role = 'client-admin'\nh = YAML.load(doc).to_h\nh['market'][locale][environment].select do |page,roles| \n  roles.include?(user_role)\nend \n#=&gt; {\"page1\"=&gt;[\"sys-admin\", \"client-admin\", \"editor-admin\"], \n#    \"page2\"=&gt;[\"client-admin\"]}\n</code></pre>\n\n<p>Right now your environments are an <code>Array</code> of <code>Hash</code> objects which seems unnecessary as they could just be a <code>Hash</code> and your roles are actually a <code>String</code> (e.g. \"sys-admin, client-admin, editor-admin\") which could be come more difficult to maintain in the future and makes parsing a bit more cumbersome.</p>\n"}], "owner": {"reputation": 21, "user_id": 5230700, "user_type": "registered", "profile_image": "https://graph.facebook.com/1570594266563152/picture?type=large", "display_name": "Akshat Uppal", "link": "https://stackoverflow.com/users/5230700/akshat-uppal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 179, "favorite_count": 0, "accepted_answer_id": 53634079, "answer_count": 1, "score": -2, "last_activity_date": 1544018474, "creation_date": 1543991131, "question_id": 53626349, "link": "https://stackoverflow.com/questions/53626349/iterate-trough-yaml-file-in-ruby-and-fetching-the-required-data", "title": "Iterate trough yaml file in ruby and fetching the required data", "body": "<p>I have a yaml file with the following struture:</p>\n\n<pre><code>market:\n  US:\n    - prod:\n      - page1: sys-admin, client-admin, editor-admin\n      - page2: client-admin\n      - page3: editor-admin, sys-admin\n\n    - dev:\n      - page1: sys-admin, editor-admin\n      - page2: sys-admin, client-admin, editor-admin\n      - page3: sys-admin, client-admin, editor-admin\n\n  IN:\n    - prod:\n      - page1: sys-admin, client-admin\n      - page2: client-admin, editor-admin\n      - page3: editor-admin, sys-admin\n\n    - dev:\n      - page1: client-admin, editor-admin\n      - page2: sys-admin, client-admin, editor-admin\n      - page3: sys-admin, client-admin, editor-admin\n</code></pre>\n\n<p>Now I want a function which returns market name eg. <strong>IN</strong> and page eg. <strong>page1</strong> based on the roles eg. <strong>client-admin</strong>. How should I proceed? I am trying but not able to conclude and come to a proper output. \n<br>\nHelp me out, Guys ! \n<br>\nThanks in advance. :)</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "devise", "activeadmin"], "answers": [{"tags": [], "owner": {"reputation": 1852, "user_id": 2113461, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/371d7f69208d6659f37879b2851b5385?s=128&d=identicon&r=PG&f=1", "display_name": "Nicholas.V", "link": "https://stackoverflow.com/users/2113461/nicholas-v"}, "is_accepted": true, "score": 1, "last_activity_date": 1544145360, "last_edit_date": 1544145360, "creation_date": 1544000090, "answer_id": 53628437, "question_id": 53625874, "link": "https://stackoverflow.com/questions/53625874/devise-and-active-admin-using-a-single-model-error/53628437#53628437", "title": "Devise and Active Admin using a single model error", "body": "<p>You can configure Active Admin settings in <code>config/initializers/active_admin.rb</code>. See <a href=\"https://activeadmin.info/1-general-configuration.html#authentication\" rel=\"nofollow noreferrer\">Active Admin Authentication</a></p>\n\n<p>Specifically, you'll want to set: <code>config.authentication_method</code> and <code>config.current_user_method</code> to match the methods you are defining in your <code>ApplicationController</code>.</p>\n\n<p>Example:</p>\n\n<p>application_controller.rb</p>\n\n<pre><code>class ApplicationController &lt; ActionController::Base\n  protect_from_forgery with: :exception\n\n  protected\n\n  def authenticate_admin_user!\n    authenticate_user!\n    unless current_user.profile.role == 'super_admin'\n      flash[:alert] = \"Unauthorized Access!\"\n      redirect_to root_path\n    end\n  end\n\n  def current_admin_user\n    return unless current_user&amp;.profile.role == 'super_admin'\n    current_user\n  end\nend\n</code></pre>\n\n<p>config/initializers/active_admin.rb</p>\n\n<pre><code>config.authentication_method = :authenticate_admin_user!\nconfig.current_user_method = :current_admin_user\n</code></pre>\n\n<p>Alternatively, you could just authenticate current user and authorise admin views by role. See <a href=\"https://activeadmin.info/13-authorization-adapter.html\" rel=\"nofollow noreferrer\">Active Admin Authorization Adapter</a></p>\n"}], "owner": {"reputation": 75, "user_id": 10549885, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zmCkO.jpg?s=128&g=1", "display_name": "Pujan Soni", "link": "https://stackoverflow.com/users/10549885/pujan-soni"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 79, "favorite_count": 0, "accepted_answer_id": 53628437, "answer_count": 1, "score": 1, "last_activity_date": 1544145360, "creation_date": 1543988696, "question_id": 53625874, "link": "https://stackoverflow.com/questions/53625874/devise-and-active-admin-using-a-single-model-error", "title": "Devise and Active Admin using a single model error", "body": "<p>My application requires a single model for both Devise and Active Admin for the User and I want to distinguish the super admin, admin and user based on the role which is present in the Profile model and I followed <a href=\"http://dan.doezema.com/2012/02/how-to-implement-a-single-user-model-with-rails-activeadmin-and-devise/\" rel=\"nofollow noreferrer\">this link by dan doezema</a>. Please help me as I am new to the rails world and do not know what to do in this problem.\nI have deleted the admin user which was created by default. My user.rb file in the app/admin folder is:</p>\n\n<pre><code>    ActiveAdmin.register User do\n        form do |f|\n            f.inputs \"User Details\" do\n                f.input :email\n            end\n            f.buttons\n        end\n    end\n</code></pre>\n\n<p>Here I have used User because I want to use the User generated by the devise. My users.rb file in app/admin is:</p>\n\n<pre><code>    ActiveAdmin.register User do\n        permit_params :email\n        index do\n            selectable_column\n            id_column\n            column :email\n            column :current_sign_in_at\n            column :sign_in_count\n            column :created_at\n            actions\n        end\n        filter :email\n        filter :current_sign_in_at\n        filter :sign_in_count\n        filter :created_at\n        form do |f|\n            f.inputs do\n                f.input :email\n                end\n                f.actions\n            end\n        end\n</code></pre>\n\n<p>I did not change the dashboard.rb file in app/admin. The application_controller.rb file is:</p>\n\n<pre><code>    class ApplicationController &lt; ActionController::Base\n        protect_from_forgery with: :exception\n        def authenticate_admin_user!\n            authenticate_user!\n            unless current_user.profile.role == 'super_admin'\n                flash[:alert] = \"Unauthorized Access!\"\n                redirect_to root_path\n            end\n        end\n    end\n</code></pre>\n\n<p>I have removed the following route from the routes.rb file</p>\n\n<pre><code>    devise_for :admin_users, ActiveAdmin::Devise.config\n</code></pre>\n\n<p>I have also destroyed the AdminUser model</p>\n"}, {"tags": ["ruby", "symbols", "proc"], "comments": [{"owner": {"reputation": 394580, "user_id": 479863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ArUCE.jpg?s=128&g=1", "display_name": "mu is too short", "link": "https://stackoverflow.com/users/479863/mu-is-too-short"}, "edited": false, "score": 1, "creation_date": 1543989553, "post_id": 53625716, "comment_id": 94111969, "body": "Also: <a href=\"http://symbolhound.com/?q=ruby+%26%3A\" rel=\"nofollow noreferrer\">symbolhound.com/?q=ruby+%26%3A</a>"}, {"owner": {"reputation": 19, "user_id": 10373589, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/451d8b17435350f8bded5affa12bb319?s=128&d=identicon&r=PG", "display_name": "Tomasz Drgas", "link": "https://stackoverflow.com/users/10373589/tomasz-drgas"}, "reply_to_user": {"reputation": 394580, "user_id": 479863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ArUCE.jpg?s=128&g=1", "display_name": "mu is too short", "link": "https://stackoverflow.com/users/479863/mu-is-too-short"}, "edited": false, "score": 0, "creation_date": 1543990352, "post_id": 53625716, "comment_id": 94112246, "body": "Ok I found this:  &lt;br/&gt;    <code>class Symbol     def to_proc       Proc.new do |obj, *args|         obj.send self, *args       end     end   end</code>   this I guess why the second parameter from <b>|a, b|</b> was taken as an argument..  still feel anfamiliar with &amp;:symb but reading about that..  &lt;br/&gt; I did try to add  two spaces and &lt;br/&gt; to make line break.. when pressing enter automaticly addscomment.. don&#39;t know how to do it"}, {"owner": {"reputation": 19, "user_id": 10373589, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/451d8b17435350f8bded5affa12bb319?s=128&d=identicon&r=PG", "display_name": "Tomasz Drgas", "link": "https://stackoverflow.com/users/10373589/tomasz-drgas"}, "reply_to_user": {"reputation": 394580, "user_id": 479863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ArUCE.jpg?s=128&g=1", "display_name": "mu is too short", "link": "https://stackoverflow.com/users/479863/mu-is-too-short"}, "edited": false, "score": 0, "creation_date": 1544091305, "post_id": 53625716, "comment_id": 94156408, "body": "@mu is to short ..  I was reading the help about comments formating,   but nowhere I have seen anything  about you must press   Shift + Enter for linebreak   which I overuse now..   &lt;br/&gt;    maybe it depends on browser?  and still doesn&#39;t work"}], "answers": [{"comments": [{"owner": {"reputation": 19, "user_id": 10373589, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/451d8b17435350f8bded5affa12bb319?s=128&d=identicon&r=PG", "display_name": "Tomasz Drgas", "link": "https://stackoverflow.com/users/10373589/tomasz-drgas"}, "edited": false, "score": 0, "creation_date": 1543993832, "post_id": 53626093, "comment_id": 94113626, "body": "Thanks @emaillenin... how do you do line breakes .. when I do 2 spaces on the end and hit enter it adds a coment.."}, {"owner": {"reputation": 20644, "user_id": 184184, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f6a508697f9eca2680b12ddb85ba1319?s=128&d=identicon&r=PG", "display_name": "Lenin Raj Rajasekaran", "link": "https://stackoverflow.com/users/184184/lenin-raj-rajasekaran"}, "reply_to_user": {"reputation": 19, "user_id": 10373589, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/451d8b17435350f8bded5affa12bb319?s=128&d=identicon&r=PG", "display_name": "Tomasz Drgas", "link": "https://stackoverflow.com/users/10373589/tomasz-drgas"}, "edited": false, "score": 0, "creation_date": 1544001545, "post_id": 53626093, "comment_id": 94117248, "body": "@Tomasz use shift + enter"}, {"owner": {"reputation": 19, "user_id": 10373589, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/451d8b17435350f8bded5affa12bb319?s=128&d=identicon&r=PG", "display_name": "Tomasz Drgas", "link": "https://stackoverflow.com/users/10373589/tomasz-drgas"}, "edited": false, "score": 0, "creation_date": 1544091596, "post_id": 53626093, "comment_id": 94156577, "body": "one more time .. THANKS   I didn&#39;t see anything about Shift + Enter when reading about formating comments    but it work in the comment editing window only.. there is no linebreak after saving it   and   &lt;br/&gt;   doesn&#39;t help"}], "tags": [], "owner": {"reputation": 20644, "user_id": 184184, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f6a508697f9eca2680b12ddb85ba1319?s=128&d=identicon&r=PG", "display_name": "Lenin Raj Rajasekaran", "link": "https://stackoverflow.com/users/184184/lenin-raj-rajasekaran"}, "is_accepted": false, "score": 1, "last_activity_date": 1543989816, "creation_date": 1543989816, "answer_id": 53626093, "question_id": 53625716, "link": "https://stackoverflow.com/questions/53625716/what-does-the-symb-do/53626093#53626093", "title": "What does the `&amp;:symb` do?", "body": "<blockquote>\n  <p>If more than one parameter is passed to your block, the proc created by Symbol#to_proc uses the additional block parameters as parameters to the method call.</p>\n</blockquote>\n\n<p><a href=\"http://phrogz.net/symbol-to-proc-with-multiple-arguments\" rel=\"nofollow noreferrer\">http://phrogz.net/symbol-to-proc-with-multiple-arguments</a></p>\n\n<p>So, what's really happening is, <code>sort(&amp;:casecmp)</code> is converted to:</p>\n\n<pre><code>sort {|a,b| a.casecmp(b) }\n</code></pre>\n\n<p>because <code>sort</code> takes two parameters.</p>\n"}], "owner": {"reputation": 19, "user_id": 10373589, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/451d8b17435350f8bded5affa12bb319?s=128&d=identicon&r=PG", "display_name": "Tomasz Drgas", "link": "https://stackoverflow.com/users/10373589/tomasz-drgas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 53, "favorite_count": 0, "closed_date": 1543989535, "answer_count": 1, "score": 1, "last_activity_date": 1543990616, "creation_date": 1543987825, "last_edit_date": 1543990616, "question_id": 53625716, "link": "https://stackoverflow.com/questions/53625716/what-does-the-symb-do", "closed_reason": "Duplicate", "title": "What does the `&amp;:symb` do?", "body": "<p>I've seen an example of how to sort a string. To sort case insensitively:</p>\n\n<pre><code>str.chars.sort(&amp;:casecmp).join\n#=&gt; \"ginrSt\"\n</code></pre>\n\n<p>I'm curious about <code>(&amp;:casecmp)</code>. I found that for example:</p>\n\n<pre><code>arr.map(&amp;:name)\n</code></pre>\n\n<p>is shorthand for</p>\n\n<pre><code>arr.map(&amp;:name.to_proc)\n</code></pre>\n\n<p>which is same with</p>\n\n<pre><code>arr.map{|el| el.name}\n</code></pre>\n\n<p>I know the <code>&amp;</code> (ampersand) tries to convert symbol to proc, and pass it as a block to a method. I do not understand how this would work for <code>sort</code> method, which is supposed to compare two values. Would it be as follows?</p>\n\n<pre><code>str.chars.sort{|a, b| a.casecmp ;b.casecmp}.join\n</code></pre>\n\n<p>It wouldn't be helpful since <code>soft</code> needs a block to return an integer and <code>casecmp</code> needs an argument. (Or is it called parameter in that case?) To me, it looks more like this:</p>\n\n<pre><code>str.chars.sort{|a, b| a.casecmp(b)}.join\n</code></pre>\n\n<p>How does <code>&amp;:casecmp</code> know to take one of <code>|a, b|</code> as a caller and the other one as an argument? I wouldn't guess it that it is an option.</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 0, "creation_date": 1543991447, "post_id": 53625712, "comment_id": 94112659, "body": "You need a way to distinguish the two <code>PDF</code> modules. And that is not easy."}, {"owner": {"user_type": "does_not_exist", "display_name": "user9450045"}, "reply_to_user": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 0, "creation_date": 1543995350, "post_id": 53625712, "comment_id": 94114335, "body": "Can you give me an example/link of how to do it? At least I&#39;ll try."}, {"owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 0, "creation_date": 1543996654, "post_id": 53625712, "comment_id": 94114937, "body": "Please read my comment above."}, {"owner": {"reputation": 5449, "user_id": 681520, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/701baebf68d1d7faa9f9def6a24fe356?s=128&d=identicon&r=PG", "display_name": "Kimmo Lehto", "link": "https://stackoverflow.com/users/681520/kimmo-lehto"}, "edited": false, "score": 0, "creation_date": 1544000918, "post_id": 53625712, "comment_id": 94116919, "body": "I reported an issue about this to Origami <a href=\"https://github.com/gdelugre/origami/issues/52\" rel=\"nofollow noreferrer\">github.com/gdelugre/origami/issues/52</a>"}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user9450045"}, "edited": false, "score": 0, "creation_date": 1544002621, "post_id": 53627825, "comment_id": 94117852, "body": "&#180;undefined method &#39;read&#39; for PDF:Module (NoMethodError)&#180; Besides, it&#39;s exactly the same as the original code. Do you know any Ruby code (that are not gems) to count pages in a PDF?"}, {"owner": {"reputation": 5449, "user_id": 681520, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/701baebf68d1d7faa9f9def6a24fe356?s=128&d=identicon&r=PG", "display_name": "Kimmo Lehto", "link": "https://stackoverflow.com/users/681520/kimmo-lehto"}, "edited": false, "score": 0, "creation_date": 1544007228, "post_id": 53627825, "comment_id": 94120660, "body": "It&#39;s not exactly the same, the first example skips <code>include Origami</code> and uses it directly via <code>Origami::PDF.read</code> and the second one creates a <code>PDFReader</code> constant that points to the <code>PDF::Reader</code>, but as I said, it may sometimes work, apparently not in this case. <code>Origami::PDF.read(&#39;document.pdf&#39;).pages.size</code> will give you the page count using Origami only."}, {"owner": {"user_type": "does_not_exist", "display_name": "user9450045"}, "edited": false, "score": 0, "creation_date": 1544030867, "post_id": 53627825, "comment_id": 94135066, "body": "Origami and pdf-reader are used to count the pages of a pdf that I know, but in some pdf origami fails then I use pdf-reader and it works, I use begin and rescue. But both gems are slow and of course it gives errors as I have already shown, so I prefer to count the pages without using gems but I have not found any example of how to do it. I mean, I want to use pure Ruby."}], "tags": [], "owner": {"reputation": 5449, "user_id": 681520, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/701baebf68d1d7faa9f9def6a24fe356?s=128&d=identicon&r=PG", "display_name": "Kimmo Lehto", "link": "https://stackoverflow.com/users/681520/kimmo-lehto"}, "is_accepted": true, "score": 1, "last_activity_date": 1543997606, "creation_date": 1543997606, "answer_id": 53627825, "question_id": 53625712, "link": "https://stackoverflow.com/questions/53625712/how-to-distinguish-classes-with-the-same-name-defined-in-different-gems/53627825#53627825", "title": "How to distinguish classes with the same name defined in different Gems?", "body": "<p>In your specific example, the <code>include Origami</code> is unnecessary, I don't know why they added that example to their <code>README</code>.</p>\n\n<pre><code>require 'pdf/reader'\nrequire 'origami'\n\nPDF::Reader.new(dir) # (first gem)\nOrigami::PDF.read dir # (second gem)\n</code></pre>\n\n<p>Sometimes it may be possible to do something like:</p>\n\n<pre><code>require 'pdf/reader'\n\nPDFReader = PDF::Reader\n\nrequire 'origami'\ninclude Origami\n\nPDFReader.new(dir)\nPDF.read(dir)\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user9450045"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 136, "favorite_count": 0, "accepted_answer_id": 53627825, "answer_count": 1, "score": 1, "last_activity_date": 1543997606, "creation_date": 1543987811, "last_edit_date": 1543991124, "question_id": 53625712, "link": "https://stackoverflow.com/questions/53625712/how-to-distinguish-classes-with-the-same-name-defined-in-different-gems", "title": "How to distinguish classes with the same name defined in different Gems?", "body": "<p>I have two gems pdf-reader and origami. Each gem has a module called <code>PDF</code>. When I call them in the following order,</p>\n\n<pre><code># Importing first gem\nrequires 'pdf/reader'\n\n# Second gem\nrequires origami\ninclude Origami\n\nPDF::Reader.new(dir) # (first gem)\nPDF.read dir # (second gem) #&gt;&gt; undefined method 'read' for PDF:Module (NoMethodError)\n</code></pre>\n\n<p>the first gem has no problem, but when I get to the second one, I get a mistake alleging that <code>pdf</code> does not have the <code>read</code> method. But if I first import 'origami' and then 'pdf/reader', I get error:</p>\n\n<pre><code>PDF is not a module (TypeError)\n</code></pre>\n\n<p>Ruby gets confused on which gem I'm invoking.</p>\n\n<p>How can I specify that I'm talking about the specific first or second gem?</p>\n"}, {"tags": ["ruby", "regex"], "comments": [{"owner": {"reputation": 33687, "user_id": 9624435, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/h44B4.jpg?s=128&g=1", "display_name": "Code Maniac", "link": "https://stackoverflow.com/users/9624435/code-maniac"}, "edited": false, "score": 3, "creation_date": 1543986669, "post_id": 53625394, "comment_id": 94111109, "body": "i don&#39;t think there&#39;s any problem in doing it with regex as you already know a fixed pattern.And i think group you can make non-capturing if you just need to validate."}, {"owner": {"reputation": 117184, "user_id": 9473764, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/aGMXl.jpg?s=128&g=1", "display_name": "Nick", "link": "https://stackoverflow.com/users/9473764/nick"}, "edited": false, "score": 1, "creation_date": 1543986832, "post_id": 53625394, "comment_id": 94111152, "body": "In part 2 you mention &quot;Followed by another <code>-</code>&quot; but there isn&#39;t one in your sample data?"}, {"owner": {"reputation": 2133, "user_id": 5473450, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/7mHKn.png?s=128&g=1", "display_name": "RangerRanger", "link": "https://stackoverflow.com/users/5473450/rangerranger"}, "reply_to_user": {"reputation": 117184, "user_id": 9473764, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/aGMXl.jpg?s=128&g=1", "display_name": "Nick", "link": "https://stackoverflow.com/users/9473764/nick"}, "edited": false, "score": 0, "creation_date": 1543987000, "post_id": 53625394, "comment_id": 94111187, "body": "@Nick Good catch, thank you. Edited to remove that."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1543992289, "post_id": 53625394, "comment_id": 94112993, "body": "I almost never use <code>\\w</code> anymore, for three reasons: it matches underscores, which I generally don&#39;t want to do; it does not match accents in English words derived from other languages (e.g., &quot;blas&#233;&quot;) and it does not match letters of non-English alphabets. Instead, I use <code>[[:alpha:]]</code> or <code>\\p{Alnum}</code>. For additional information search <a href=\"http://ruby-doc.org/core-2.5.1/Regexp.html\" rel=\"nofollow noreferrer\">Regexp</a> for <i>POSIX</i> and <i><code>\\p{}</code> construct</i>."}], "answers": [{"comments": [{"owner": {"reputation": 33687, "user_id": 9624435, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/h44B4.jpg?s=128&g=1", "display_name": "Code Maniac", "link": "https://stackoverflow.com/users/9624435/code-maniac"}, "edited": false, "score": 1, "creation_date": 1543987191, "post_id": 53625532, "comment_id": 94111249, "body": "even i wrote the same regex since you already posted answer so i didn&#39;t.But even i wonder why down voted :o"}, {"owner": {"reputation": 2133, "user_id": 5473450, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/7mHKn.png?s=128&g=1", "display_name": "RangerRanger", "link": "https://stackoverflow.com/users/5473450/rangerranger"}, "edited": false, "score": 0, "creation_date": 1544017889, "post_id": 53625532, "comment_id": 94127045, "body": "@Nick Note sure about the downvote :/ I gave you a ^ to bring you back to 0 at least. Thank you for the help."}, {"owner": {"reputation": 117184, "user_id": 9473764, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/aGMXl.jpg?s=128&g=1", "display_name": "Nick", "link": "https://stackoverflow.com/users/9473764/nick"}, "reply_to_user": {"reputation": 2133, "user_id": 5473450, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/7mHKn.png?s=128&g=1", "display_name": "RangerRanger", "link": "https://stackoverflow.com/users/5473450/rangerranger"}, "edited": false, "score": 0, "creation_date": 1544049012, "post_id": 53625532, "comment_id": 94142916, "body": "@RangerRanger thanks for that. It&#39;s a pity no-one gave an explanation as I guess it would also be helpful for you to know why people think this is a bad answer."}], "tags": [], "owner": {"reputation": 117184, "user_id": 9473764, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/aGMXl.jpg?s=128&g=1", "display_name": "Nick", "link": "https://stackoverflow.com/users/9473764/nick"}, "is_accepted": true, "score": 1, "last_activity_date": 1543987327, "last_edit_date": 1543987327, "creation_date": 1543986676, "answer_id": 53625532, "question_id": 53625394, "link": "https://stackoverflow.com/questions/53625394/regular-expression-for-validating-long-complicated-dns-targets/53625532#53625532", "title": "Regular expression for validating long, complicated dns targets", "body": "<p>I think given your input data you have no choice but an ugly regex e.g.</p>\n\n<pre><code>^qwer-\\w{17}-\\w{8}\\.qwer-gfd-\\w{17}\\.ps-sdlk-\\w{1,2}\\.qwer\\.domain\\.com$\n</code></pre>\n\n<p>Note that I have used <code>\\w</code> as you did, however <code>\\w</code> also matches <code>_</code> as well as alphanumeric characters, so you may want to replace it with <code>[A-Za-z0-9]</code>. Also, <code>.</code> will match any character, so to specifically match a <code>.</code> you need <code>\\.</code> in your regex.</p>\n\n<p><a href=\"https://regex101.com/r/53qeFR/1\" rel=\"nofollow noreferrer\">Demo on regex101.com</a></p>\n"}, {"comments": [{"owner": {"reputation": 2133, "user_id": 5473450, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/7mHKn.png?s=128&g=1", "display_name": "RangerRanger", "link": "https://stackoverflow.com/users/5473450/rangerranger"}, "edited": false, "score": 0, "creation_date": 1544017912, "post_id": 53626334, "comment_id": 94127060, "body": "Thanks, I may just try decomposing the dns target as you&#39;ve suggested. It will make everything a bit longer but you&#39;re right about making the test more reliable."}], "tags": [], "owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "is_accepted": false, "score": 2, "last_activity_date": 1544047298, "last_edit_date": 1544047298, "creation_date": 1543991058, "answer_id": 53626334, "question_id": 53625394, "link": "https://stackoverflow.com/questions/53625394/regular-expression-for-validating-long-complicated-dns-targets/53626334#53626334", "title": "Regular expression for validating long, complicated dns targets", "body": "<p>Considering the complexity of testing longish regular expressions, and also the possibility--if not the probability--that changes will be needed in future, I would be inclined to split the string on hyphens and test each string in the resulting array.</p>\n\n<pre><code>PIECES = [['qwer'],\n          ['0123a4bcd567890e1'.size],\n          ['uuuuu3xx'.size, '.qwer'],\n          ['gfd'],\n          ['1e098765dcb4a3210'.size, '.ps'],\n          ['sdlk'],\n          [[1, 2], '.qwer.domain.com']].\n  map do |a|\n    Regexp.new(\n      a.each_with_object('\\A') do |o,s|\n        case o\n        when String\n          s &lt;&lt; o.gsub('.', '\\.')\n        when Integer\n          s &lt;&lt; \"\\\\p{Alnum}{#{o}}\"\n        else # array\n          s &lt;&lt; \"\\\\p{Alnum}{#{o.first},#{o.last}}\"\n        end\n      end &lt;&lt; '\\z')\n    end\n  #=&gt; [/\\Aqwer\\z/, /\\A\\p{Alnum}{17}\\z/, /\\A\\p{Alnum}{8}\\.qwer\\z/,\n  #    /\\Agfd\\z/, /\\A\\p{Alnum}{17}\\.ps\\z/, /\\Asdlk\\z/,\n  #    /\\A\\p{Alnum}{1,2}\\.qwer\\.domain\\.com\\z/]\n</code></pre>\n\n<p>Notice that I've used single quotes in most places to be able to write, for example, <code>'\\A'</code> rather than <code>\"\\\\A\"</code>. However, double quotes are needed for the two lines where interpolation is performed  (<code>#{o}</code>). I've also used strings from the example to determine the lengths of various runs of alphanumeric characters and have escaped periods and added anchors in simple code. I did that to both reduce the chance of counting errors and help readers of the code understand what is being done. Though the elements of <code>PIECES</code> (regular expressions) are here being used to test the string used to construct <code>PIECES</code> that is of course irrelevant, assuming, as we must, that all strings to be tested will have the same pattern.</p>\n\n<pre><code>def valid?(str)\n  arr = str.split('-')\n  return false unless arr.size == PIECES.size\n  arr.zip(PIECES).all? { |s,r| s.match? r }\nend\n</code></pre>\n\n<p>If <a href=\"http://ruby-doc.org/core-2.5.1/Enumerable.html#method-i-all-3F\" rel=\"nofollow noreferrer\">Enumerable#all?</a>'s block returns <em>false</em> <code>all?</code> immediately returns <code>false</code>. This is sometimes referred to as <em>short-circuiting</em> behaviour.</p>\n\n<p>For the string given in the example, <code>str</code>,</p>\n\n<pre><code>valid?(str)\n  #=&gt; true\n</code></pre>\n\n<p>Note the following intermediate calculation.</p>\n\n<pre><code>str.split('-').zip(PIECES)\n  #=&gt; [[\"qwer\", /\\Aqwer\\z/],\n  #    [\"0123a4bcd567890e1\", /\\A\\p{Alnum}{17}\\z/],\n  #    [\"uuuuu3xx.qwer\", /\\A\\p{Alnum}{8}\\.qwer\\z/],\n  #    [\"gfd\", /\\Agfd\\z/],\n  #    [\"1e098765dcb4a3210.ps\", /\\A\\p{Alnum}{17}\\.ps\\z/],\n  #    [\"sdlk\", /\\Asdlk\\z/],\n  #    [\"6.qwer.domain.com\", /\\A\\p{Alnum}{1,2}\\.qwer\\.domain\\.com\\z/]]\n</code></pre>\n\n<p>This may seem overkill (and I'm not certain it isn't), but it does facilitate debugging and testing and if, in future, the string pattern changes (within limits) it should be relatively easy to modify the matching test (by changing the array of arrays above from which <code>PIECES</code> is derived).</p>\n"}], "owner": {"reputation": 2133, "user_id": 5473450, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/7mHKn.png?s=128&g=1", "display_name": "RangerRanger", "link": "https://stackoverflow.com/users/5473450/rangerranger"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 55, "favorite_count": 0, "accepted_answer_id": 53625532, "answer_count": 2, "score": 1, "last_activity_date": 1544047298, "creation_date": 1543985698, "last_edit_date": 1543993447, "question_id": 53625394, "link": "https://stackoverflow.com/questions/53625394/regular-expression-for-validating-long-complicated-dns-targets", "title": "Regular expression for validating long, complicated dns targets", "body": "<p>The DNS entries i am trying to validate are quite long. Here's an example of what the structure might look like:</p>\n\n<blockquote>\n  <p>qwer-0123a4bcd567890e1-uuuuu3xx.qwer-gfd-1e098765dcb4a3210.ps-sdlk-6.qwer.domain.com</p>\n</blockquote>\n\n<p>These entries can be thought of as three distinct parts:</p>\n\n<ol>\n<li><p><code>qwer-0123a4bcd567890e1-uuuuu3xx.qwer-gfd-1e098765dcb4a3210.</code></p>\n\n<ul>\n<li>Always starts with <code>qwer-</code></li>\n<li>Followed by 17 alphanumerics, a <code>-</code>, 8 more alphanumerics</li>\n<li>Followed by <code>qwer-gfd-</code></li>\n<li>Followed by 17 more alphanumerics and a <code>.</code></li>\n</ul></li>\n<li><p><code>ps-sdlk-6</code></p>\n\n<ul>\n<li>Always starts with <code>ps-sdlk-</code></li>\n<li>Followed by <strong>either one or two</strong> alphanumeric. In this case it could be <code>ps-sdlk-6</code> or something like <code>ps-sdlk-6e</code></li>\n</ul></li>\n<li><p><code>.qwer.domain.com</code></p>\n\n<ul>\n<li>The domain target always ends with <code>.qwer.domain.com</code></li>\n</ul></li>\n</ol>\n\n<p>I've been hacking together a regex and came up with this monstrosity:</p>\n\n<p><code>qwer-[\\w]{17}-[\\w]{8}.qwer-gfd-[\\w]{17}.(.*)(qwer.domain.com)</code></p>\n\n<p>That solution is pretty hideous and it returns multiple match groups which doesn't give me much confidence in the accuracy. I'm using ruby 2.5 but non std lib stuff is difficult to import in this case.</p>\n\n<p>Is there a more sensible and complete/accurate regex to confirm the validity of these dns targets? Is there a better way to do this without regex?</p>\n"}, {"tags": ["ruby", "logging", "rubygems"], "answers": [{"comments": [{"owner": {"reputation": 369, "user_id": 525795, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69e8297645d592bc60a1bd52daea003c?s=128&d=identicon&r=PG", "display_name": "seanhussey", "link": "https://stackoverflow.com/users/525795/seanhussey"}, "edited": false, "score": 2, "creation_date": 1544209561, "post_id": 53633841, "comment_id": 94208585, "body": "The answer to my question is contained in your issue request. I recommend people follow that link to see the details. In short, nothing nefarious happened, but I think many people believe it was a questionable decision to yank the gem instead of publishing a new one (which has now been done with version 1.3.0)."}], "tags": [], "owner": {"reputation": 56, "user_id": 757773, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e00d99df68a5b69b954216088686907c?s=128&d=identicon&r=PG", "display_name": "Dom Barnes", "link": "https://stackoverflow.com/users/757773/dom-barnes"}, "is_accepted": true, "score": 4, "last_activity_date": 1544017706, "creation_date": 1544017706, "answer_id": 53633841, "question_id": 53625347, "link": "https://stackoverflow.com/questions/53625347/what-happened-to-version-1-2-8-of-the-logger-gem/53633841#53633841", "title": "What happened to version 1.2.8 of the logger gem?", "body": "<p>I just saw this too as I'm doing a clean deploy to my web host. I've raised an issue on the github repo <a href=\"https://github.com/nahi/logger/issues/3\" rel=\"nofollow noreferrer\">https://github.com/nahi/logger/issues/3</a></p>\n"}], "owner": {"reputation": 369, "user_id": 525795, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69e8297645d592bc60a1bd52daea003c?s=128&d=identicon&r=PG", "display_name": "seanhussey", "link": "https://stackoverflow.com/users/525795/seanhussey"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 820, "favorite_count": 0, "accepted_answer_id": 53633841, "answer_count": 1, "score": 5, "last_activity_date": 1547219686, "creation_date": 1543985301, "last_edit_date": 1544011660, "question_id": 53625347, "link": "https://stackoverflow.com/questions/53625347/what-happened-to-version-1-2-8-of-the-logger-gem", "title": "What happened to version 1.2.8 of the logger gem?", "body": "<p>The logger gem, which has been at version 1.2.8 for 7.5 years, was yanked from rubygems.org today and replaced with version 1.2.7:</p>\n\n<p><a href=\"https://rubygems.org/gems/logger/versions/1.2.8\" rel=\"noreferrer\">https://rubygems.org/gems/logger/versions/1.2.8</a></p>\n\n<p>This library was not a gem before 1.2.8. The gemspec was added on 2011-05-11:</p>\n\n<p><a href=\"https://github.com/nahi/logger/commit/af96ca8fbf9ca1a20812a222c27d5c1ccf5d297e\" rel=\"noreferrer\">https://github.com/nahi/logger/commit/af96ca8fbf9ca1a20812a222c27d5c1ccf5d297e</a></p>\n\n<p>There has never been an official release of a 1.2.7 version, as told by the release history on GitHub:</p>\n\n<p><a href=\"https://github.com/nahi/logger/releases\" rel=\"noreferrer\">https://github.com/nahi/logger/releases</a></p>\n\n<p>There have been no commits to this repo for more than 6 years. If a 1.2.7 version of the library was built as a gem, it was done so from a different source repo. I see no evidence that the nahi repo has been superseded by any other repo.</p>\n\n<p>Does anyone know what happened? At this point, we're going to set the source for this gem to the 1.2.8 release commit on GitHub until there's some official word on this.</p>\n\n<p>EDIT: My question isn't about whether or not the logger gem still needs to be maintained. If that were the case, why publish a new version yesterday? And why go backwards in version numbering? And why is there no record of these changes in the repo? There are big differences in what was marked (but not released) as 1.2.7 back in 2008 (and remember, 1.2.8 was published as a gem for the first time 3 years after that in 2011) and what was published yesterday as 1.2.7. We rely on a gem that requires this gem. Sure, we'll reevaluate whether or not that requirement is still true, but the circumstances around yanking 1.2.8 and replacing it with something that has no (established or announced) record of change is odd.</p>\n"}, {"tags": ["ruby"], "answers": [{"comments": [{"owner": {"reputation": 121, "user_id": 4858223, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/IFx6P.gif?s=128&g=1", "display_name": "MorboRe&#39;", "link": "https://stackoverflow.com/users/4858223/morbore"}, "edited": false, "score": 0, "creation_date": 1543983256, "post_id": 53625029, "comment_id": 94110226, "body": "is that thing in primitive way Regex?"}, {"owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "reply_to_user": {"reputation": 121, "user_id": 4858223, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/IFx6P.gif?s=128&g=1", "display_name": "MorboRe&#39;", "link": "https://stackoverflow.com/users/4858223/morbore"}, "edited": false, "score": 0, "creation_date": 1543983295, "post_id": 53625029, "comment_id": 94110233, "body": "If you mean regex, or Regexp, then yes. It passes a regex to the method <code>[]</code>."}], "tags": [], "owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "is_accepted": true, "score": 1, "last_activity_date": 1543983365, "last_edit_date": 1543983365, "creation_date": 1543982791, "answer_id": 53625029, "question_id": 53624914, "link": "https://stackoverflow.com/questions/53624914/how-to-get-the-calling-methods-name-at-runtime/53625029#53625029", "title": "How to get the calling method&#39;s name at runtime", "body": "<p>Yes. An old school way is to go like this:</p>\n\n<pre><code>def outer_method\n  called_method\nend\n\ndef called_method\n  puts caller.first[/(?&lt;=`).+(?=')/]\nend\n\nouter_method\n# &gt;&gt; outer_method\n</code></pre>\n\n<p>A more modern and robust way is to do:</p>\n\n<pre><code>def outer_method\n  called_method\nend\n\ndef called_method\n  puts caller_locations.first.label\nend\n\nouter_method\n# &gt;&gt; outer_method\n</code></pre>\n"}], "owner": {"reputation": 121, "user_id": 4858223, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/IFx6P.gif?s=128&g=1", "display_name": "MorboRe&#39;", "link": "https://stackoverflow.com/users/4858223/morbore"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 23, "favorite_count": 0, "accepted_answer_id": 53625029, "answer_count": 1, "score": 0, "last_activity_date": 1543983365, "creation_date": 1543981844, "last_edit_date": 1543982878, "question_id": 53624914, "link": "https://stackoverflow.com/questions/53624914/how-to-get-the-calling-methods-name-at-runtime", "title": "How to get the calling method&#39;s name at runtime", "body": "<p>I have:</p>\n\n<pre><code>def outer_method()\n  called_method()\nend\n\ndef called_method()\n  puts \"name of outer_method\"\nend\n</code></pre>\n\n<p>Is it possible for the <code>called_method</code> to get the name of the <code>outer_method</code> without assigning <code>__method__</code> in the <code>outer_method</code> and then using it as an argument of <code>called_method</code>?</p>\n"}, {"tags": ["ruby", "jekyll"], "comments": [{"owner": {"reputation": 4600, "user_id": 5961578, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/df7cbfdd2a92a7926af3bbb8648318aa?s=128&d=identicon&r=PG", "display_name": "moveson", "link": "https://stackoverflow.com/users/5961578/moveson"}, "edited": false, "score": 0, "creation_date": 1543981806, "post_id": 53624646, "comment_id": 94109894, "body": "Looks like your rbenv install didn&#39;t take, or you haven&#39;t switched into Ruby 2.5. What happens if you type <code>rbenv local</code> from the terminal?"}, {"owner": {"reputation": 1, "user_id": 9902483, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-wa_9mA-VWLE/AAAAAAAAAAI/AAAAAAAAAhU/Xp9dar3JrPg/photo.jpg?sz=128", "display_name": "Doyeop Lee", "link": "https://stackoverflow.com/users/9902483/doyeop-lee"}, "reply_to_user": {"reputation": 4600, "user_id": 5961578, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/df7cbfdd2a92a7926af3bbb8648318aa?s=128&d=identicon&r=PG", "display_name": "moveson", "link": "https://stackoverflow.com/users/5961578/moveson"}, "edited": false, "score": 0, "creation_date": 1543984464, "post_id": 53624646, "comment_id": 94110536, "body": "It works fine; it says 2.5.0"}, {"owner": {"reputation": 4600, "user_id": 5961578, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/df7cbfdd2a92a7926af3bbb8648318aa?s=128&d=identicon&r=PG", "display_name": "moveson", "link": "https://stackoverflow.com/users/5961578/moveson"}, "edited": false, "score": 0, "creation_date": 1543984612, "post_id": 53624646, "comment_id": 94110583, "body": "OK, try <code>ruby -v</code> from the terminal."}, {"owner": {"reputation": 1, "user_id": 9902483, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-wa_9mA-VWLE/AAAAAAAAAAI/AAAAAAAAAhU/Xp9dar3JrPg/photo.jpg?sz=128", "display_name": "Doyeop Lee", "link": "https://stackoverflow.com/users/9902483/doyeop-lee"}, "reply_to_user": {"reputation": 4600, "user_id": 5961578, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/df7cbfdd2a92a7926af3bbb8648318aa?s=128&d=identicon&r=PG", "display_name": "moveson", "link": "https://stackoverflow.com/users/5961578/moveson"}, "edited": false, "score": 0, "creation_date": 1543984836, "post_id": 53624646, "comment_id": 94110647, "body": "It says ruby 2.3.7p456 (2018-03-28 revision 63024) [universal.x86_64-darwin18]"}, {"owner": {"reputation": 4600, "user_id": 5961578, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/df7cbfdd2a92a7926af3bbb8648318aa?s=128&d=identicon&r=PG", "display_name": "moveson", "link": "https://stackoverflow.com/users/5961578/moveson"}, "edited": false, "score": 0, "creation_date": 1543984877, "post_id": 53624646, "comment_id": 94110658, "body": "Right. So your system doesn&#39;t know about the rbenv shims. Try restarting the terminal and then <code>ruby -v</code> again."}, {"owner": {"reputation": 1, "user_id": 9902483, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-wa_9mA-VWLE/AAAAAAAAAAI/AAAAAAAAAhU/Xp9dar3JrPg/photo.jpg?sz=128", "display_name": "Doyeop Lee", "link": "https://stackoverflow.com/users/9902483/doyeop-lee"}, "reply_to_user": {"reputation": 4600, "user_id": 5961578, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/df7cbfdd2a92a7926af3bbb8648318aa?s=128&d=identicon&r=PG", "display_name": "moveson", "link": "https://stackoverflow.com/users/5961578/moveson"}, "edited": false, "score": 0, "creation_date": 1543985114, "post_id": 53624646, "comment_id": 94110713, "body": "It still returns the same result; is there any way that I can make my computer know the &#39;rbenv shims&#39;?"}, {"owner": {"reputation": 4600, "user_id": 5961578, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/df7cbfdd2a92a7926af3bbb8648318aa?s=128&d=identicon&r=PG", "display_name": "moveson", "link": "https://stackoverflow.com/users/5961578/moveson"}, "edited": false, "score": 0, "creation_date": 1543985199, "post_id": 53624646, "comment_id": 94110728, "body": "Yep. Per the <a href=\"https://github.com/rbenv/rbenv#how-rbenv-hooks-into-your-shell\" rel=\"nofollow noreferrer\">docs</a>, run <code>rbenv init</code> then restart your terminal."}, {"owner": {"reputation": 1, "user_id": 9902483, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-wa_9mA-VWLE/AAAAAAAAAAI/AAAAAAAAAhU/Xp9dar3JrPg/photo.jpg?sz=128", "display_name": "Doyeop Lee", "link": "https://stackoverflow.com/users/9902483/doyeop-lee"}, "reply_to_user": {"reputation": 4600, "user_id": 5961578, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/df7cbfdd2a92a7926af3bbb8648318aa?s=128&d=identicon&r=PG", "display_name": "moveson", "link": "https://stackoverflow.com/users/5961578/moveson"}, "edited": false, "score": 0, "creation_date": 1543985454, "post_id": 53624646, "comment_id": 94110784, "body": "hmm..still the same"}, {"owner": {"reputation": 4600, "user_id": 5961578, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/df7cbfdd2a92a7926af3bbb8648318aa?s=128&d=identicon&r=PG", "display_name": "moveson", "link": "https://stackoverflow.com/users/5961578/moveson"}, "edited": false, "score": 0, "creation_date": 1543985664, "post_id": 53624646, "comment_id": 94110843, "body": "OK. Again, per the docs, you should use this script to diagnose the problem: <code>curl -fsSL https:&#47;&#47;github.com&#47;rbenv&#47;rbenv-installer&#47;raw&#47;master&#47;bin&#47;rben&zwnj;&#8203;v-doctor | bash</code>"}], "owner": {"reputation": 1, "user_id": 9902483, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-wa_9mA-VWLE/AAAAAAAAAAI/AAAAAAAAAhU/Xp9dar3JrPg/photo.jpg?sz=128", "display_name": "Doyeop Lee", "link": "https://stackoverflow.com/users/9902483/doyeop-lee"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 43, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1543980851, "creation_date": 1543979754, "last_edit_date": 1543980851, "question_id": 53624646, "link": "https://stackoverflow.com/questions/53624646/converting-a-pure-github-html-website-to-jekyll-terminal-errors", "title": "Converting a pure GitHub HTML website to Jekyll (Terminal Errors)", "body": "<p>My computer is a MacBook Pro with macOS Mojave. I am planning to serve my HTML webpages that already exist in GitHub repo with Jekyll.</p>\n\n<p>I installed Homebrew, then I installed Rbenv to use a newer version of Ruby b/c I can't use the System Ruby in Mac OS. I installed Ruby version 2.5.0 through Rbenv, and typed:</p>\n\n<pre><code>gem install bundler jekyll\n</code></pre>\n\n<p>and when the installation ended successfully, it said it downloaded 26 gems. I already have a local file and several HTML files that are already added committed and pushed to my GitHub repository, so I entered:</p>\n\n<pre><code>jekyll new (repository-name)\n</code></pre>\n\n<p>but the terminal returned this error message:</p>\n\n<pre><code>/Library/Ruby/Site/2.3.0/rubygems.rb:289:in `find_spec_for_exe': can't find gem jekyll (&gt;= 0.a) with executable jekyll (Gem::GemNotFoundException)\nfrom /Library/Ruby/Site/2.3.0/rubygems.rb:308:in `activate_bin_path'\nfrom /usr/local/bin/jekyll:23:in `&lt;main&gt;'\n</code></pre>\n\n<p>I don't understand the reason the terminal cannot find any gem w/ executable jekyll.</p>\n\n<p>What jekyll commands should I use to insert jekyll into my already-existing GitHub repository instead of making a new one?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "heroku"], "comments": [{"owner": {"reputation": 7032, "user_id": 1743174, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/9f871161f754442df697dce1cede77a5?s=128&d=identicon&r=PG&f=1", "display_name": "Dipak Gupta", "link": "https://stackoverflow.com/users/1743174/dipak-gupta"}, "edited": false, "score": 0, "creation_date": 1552036623, "post_id": 53623670, "comment_id": 96868354, "body": "You can downgrade heroku stack to solve this issue. Solution can be found here <a href=\"https://stackoverflow.com/questions/53354444/how-can-i-solve-this-trouble-to-deploy-a-rails-app-to-heroku?answertab=active#tab-top\" title=\"how can i solve this trouble to deploy a rails app to heroku\">stackoverflow.com/questions/53354444/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 1140, "user_id": 10643292, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Xwogc.jpg?s=128&g=1", "display_name": "Josh", "link": "https://stackoverflow.com/users/10643292/josh"}, "is_accepted": false, "score": 2, "last_activity_date": 1604448720, "last_edit_date": 1604448720, "creation_date": 1543972550, "answer_id": 53623778, "question_id": 53623670, "link": "https://stackoverflow.com/questions/53623670/cant-push-app-to-heroku-even-though-specified-ruby-version-matches-mine/53623778#53623778", "title": "can&#39;t push app to heroku, even though specified ruby version matches mine", "body": "<p>If you go to the link provided as part of the output you will see it has the following:</p>\n<blockquote>\n<p>2.3.8 : patchlevel 459, Rubygems : 2.5.2.3 (2.3 is not available on Heroku-18)</p>\n<p>Version 2.3.8 is not supported on Heroku-18</p>\n</blockquote>\n<p>Try upgrading your app to 2.4.5 or above.</p>\n"}, {"tags": [], "owner": {"reputation": 1682, "user_id": 6392696, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/09WDQ.jpg?s=128&g=1", "display_name": "nourza", "link": "https://stackoverflow.com/users/6392696/nourza"}, "is_accepted": false, "score": 0, "last_activity_date": 1561450841, "creation_date": 1561450841, "answer_id": 56749702, "question_id": 53623670, "link": "https://stackoverflow.com/questions/53623670/cant-push-app-to-heroku-even-though-specified-ruby-version-matches-mine/56749702#56749702", "title": "can&#39;t push app to heroku, even though specified ruby version matches mine", "body": "<p>Check the latest version of ruby in this link <a href=\"https://devcenter.heroku.com/articles/ruby-support#supported-runtimes\" rel=\"nofollow noreferrer\">https://devcenter.heroku.com/articles/ruby-support#supported-runtimes</a></p>\n\n<p>then run the latest one <code>rvm install ruby-2.4.6</code></p>\n\n<p>type <code>ruby -v</code> in the terminal, you should see ruby 2.4.6.</p>\n\n<p>If it still shows you ruby 2.0., run <code>rvm use ruby-2.4.6 --default</code>.</p>\n\n<p>This solve mine</p>\n"}], "owner": {"reputation": 1, "user_id": 10746981, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-uELxdLEzYKI/AAAAAAAAAAI/AAAAAAAALD8/Z4Ag5MlsHLI/photo.jpg?sz=128", "display_name": "kaenpe ", "link": "https://stackoverflow.com/users/10746981/kaenpe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 114, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1604448720, "creation_date": 1543971617, "last_edit_date": 1543971923, "question_id": 53623670, "link": "https://stackoverflow.com/questions/53623670/cant-push-app-to-heroku-even-though-specified-ruby-version-matches-mine", "title": "can&#39;t push app to heroku, even though specified ruby version matches mine", "body": "<blockquote>\n  <p>-----> Ruby app detected</p>\n  \n  <p>-----> Compiling Ruby/Rails</p>\n  \n  <p>Command: 'set -o pipefail; curl -L --fail --retry 5 --retry-delay 1 --connect-timeout 3 --max-time 30 <a href=\"https://s3-external-1.amazonaws.com/heroku-buildpack-ruby/heroku-18/ruby-2.3.8.tgz\" rel=\"nofollow noreferrer\">https://s3-external-1.amazonaws.com/heroku-buildpack-ruby/heroku-18/ruby-2.3.8.tgz</a>\n  -s -o - | tar zxf - ' failed on attempt 1 of 3.</p>\n  \n  <p>Command: 'set -o pipefail; curl -L --fail --retry 5 --retry-delay 1 --connect-timeout 3 --max-time 30 <a href=\"https://s3-external-1.amazonaws.com/heroku-buildpack-ruby/heroku-18/ruby-2.3.8.tgz\" rel=\"nofollow noreferrer\">https://s3-external-1.amazonaws.com/heroku-buildpack-ruby/heroku-18/ruby-2.3.8.tgz</a>\n  -s -o - | tar zxf - ' failed on attempt 2 of 3.</p>\n  \n  <p>!</p>\n  \n  <p>!     An error occurred while installing ruby-2.3.8</p>\n  \n  <p>!     </p>\n  \n  <p>!     This version of Ruby is not available on Heroku-18. The minimum\n  supported version</p>\n  \n  <p>!     of Ruby on the Heroku-18 stack can found at:</p>\n  \n  <p>!     </p>\n  \n  <p>!<br>\n  <a href=\"https://devcenter.heroku.com/articles/ruby-support#supported-runtimes\" rel=\"nofollow noreferrer\">https://devcenter.heroku.com/articles/ruby-support#supported-runtimes</a></p>\n  \n  <p>!</p>\n  \n  <p>!     Push rejected, failed to compile Ruby app.</p>\n  \n  <p>!     Push failed</p>\n</blockquote>\n\n<p>As you can see I'm using 2.3.8 ruby version, the one supported by Heroku, and I still can't push my app to it. what's the problem?</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "answers": [{"tags": [], "owner": {"reputation": 24560, "user_id": 4880924, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/d40e83be235d4f70428da0d42e12d427?s=128&d=identicon&r=PG&f=1", "display_name": "BKSpurgeon", "link": "https://stackoverflow.com/users/4880924/bkspurgeon"}, "is_accepted": false, "score": 0, "last_activity_date": 1544021660, "last_edit_date": 1544021660, "creation_date": 1543973900, "answer_id": 53623923, "question_id": 53623642, "link": "https://stackoverflow.com/questions/53623642/ruby-on-rails-displaying-a-user-names-on-a-new-page-controller/53623923#53623923", "title": "Ruby on Rails - Displaying a user names on a new page/controller", "body": "<h3>Choose a better name for your controller and instance variable</h3>\n\n<p>I'd be very careful with your naming scheme. Your controller action is called <code>users</code> however you are only displaying the information about the <code>current_user</code>. Your instances variable again is pluralized but it should be singular.</p>\n\n<p>It should be this:</p>\n\n<pre><code>&lt;%= @current_user.name %&gt;\n</code></pre>\n\n<p>And then this:</p>\n\n<pre><code>class InformationController &lt; ApplicationController\n  def users\n    @current_user = current_user # should work if you are using the devise gem\n  end\nend\n</code></pre>\n\n<h3>Notice Re: Limiting the Contagion of External Dependencies in your App</h3>\n\n<p>If you are using the <code>devise</code> gem, it has a very handy helper method called <code>current_user</code> exactly as you have specified. Set it to an instance variable as above and use the <code>@current_user</code> variable throughout your views. Why? For academic and theoretical reasons when beginning your rails programming career: devise is an external dependency - the gem might change how the <code>current_user</code> helper method works or operates, it might change it's name to something else. If and when that happens, you will want to limit any negative consequential effects to your rails app. The only change you will need to make will be in the controller to this line <code>@current_user  = current user # i.e. the devise helper method</code>, rather than in the views, which would be the case if you had used <code>current_user</code> all over the place. Granted, the changes of this happening are microscopic, but it's a decision you need to be aware of that you are making, rather than passively making it.</p>\n\n<p>Summary: use the devise gem (probably the most popular authentication gem out there) and it should be trivially easy.</p>\n"}, {"tags": [], "owner": {"reputation": 14213, "user_id": 398863, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4CNtJ.png?s=128&g=1", "display_name": "Amit Patel", "link": "https://stackoverflow.com/users/398863/amit-patel"}, "is_accepted": true, "score": 1, "last_activity_date": 1543974279, "creation_date": 1543974279, "answer_id": 53623977, "question_id": 53623642, "link": "https://stackoverflow.com/questions/53623642/ruby-on-rails-displaying-a-user-names-on-a-new-page-controller/53623977#53623977", "title": "Ruby on Rails - Displaying a user names on a new page/controller", "body": "<p>You want to display a list of users. For that first collect all users in <code>users</code> action of <code>InformationController</code> which now look like</p>\n\n<pre><code>class InformationController &lt; ApplicationController\n  def users\n    @users = User.all\n  end\nend\n</code></pre>\n\n<p>Now in <code>users.html.erb</code> you will have to loop through each user to display it in a  table</p>\n\n<pre><code>&lt;h1&gt;Information#users&lt;/h1&gt;\n&lt;table&gt;\n  &lt;tr&gt;\n    &lt;th&gt;Username&lt;/th&gt;\n  &lt;/tr&gt;\n  &lt;% @users.each do |user| %\n    &lt;tr&gt;\n      &lt;td&gt;&lt;%= user.name %&gt;&lt;/td&gt;\n    &lt;tr&gt;\n  &lt;% end %&gt;\n&lt;/table&gt;  \n</code></pre>\n"}], "owner": {"reputation": 299, "user_id": 9454269, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/0edb637e57ce3cad9745d80e6739b567?s=128&d=identicon&r=PG&f=1", "display_name": "KuroGane", "link": "https://stackoverflow.com/users/9454269/kurogane"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 96, "favorite_count": 0, "accepted_answer_id": 53623977, "answer_count": 2, "score": 0, "last_activity_date": 1544021660, "creation_date": 1543971351, "question_id": 53623642, "link": "https://stackoverflow.com/questions/53623642/ruby-on-rails-displaying-a-user-names-on-a-new-page-controller", "title": "Ruby on Rails - Displaying a user names on a new page/controller", "body": "<p><strong>QUESTION: How can I have a new page, with a new controller, display information from my database?</strong></p>\n\n<p>So I am creating a page that will display a list of users and their names in a table.</p>\n\n<p>I created this new page using:</p>\n\n<pre><code>rails generate controller Information users\n</code></pre>\n\n<p>And created the appropriate routes. Now, on the html.erb of this page (users.html.erb):</p>\n\n<p>I have:</p>\n\n<pre><code>&lt;h1&gt;Information#users&lt;/h1&gt;\n&lt;p&gt;Find me in app/views/information/users.html.erb&lt;/p&gt;\n</code></pre>\n\n<p>I want to do something like this in the page:</p>\n\n<pre><code>&lt;%= @users.name %&gt;\n</code></pre>\n\n<p>To display the users name.</p>\n\n<p>My controller is:</p>\n\n<pre><code>class InformationController &lt; ApplicationController\n  def users\n    @current_user = current_user\n  end\nend\n</code></pre>\n\n<p>And the users scheme database is:</p>\n\n<pre><code>  create_table \"users\", force: :cascade do |t|\n    t.string   \"email\",                  default: \"\", null: false\n    t.string   \"encrypted_password\",     default: \"\", null: false\n    t.string   \"phone_number\"\n    t.string   \"name\"\n  end\n</code></pre>\n\n<p>So what should I be doing to have the users.html.erb page display users information on this page?</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 21613, "user_id": 580346, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/ba17945a06aac247b06548d5afe341e8?s=128&d=identicon&r=PG", "display_name": "mrzasa", "link": "https://stackoverflow.com/users/580346/mrzasa"}, "edited": false, "score": 0, "creation_date": 1543995144, "post_id": 53623129, "comment_id": 94114221, "body": "What happens? Do you see an error?"}], "answers": [{"tags": [], "owner": {"reputation": 21613, "user_id": 580346, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/ba17945a06aac247b06548d5afe341e8?s=128&d=identicon&r=PG", "display_name": "mrzasa", "link": "https://stackoverflow.com/users/580346/mrzasa"}, "is_accepted": false, "score": 0, "last_activity_date": 1543968079, "creation_date": 1543968079, "answer_id": 53623213, "question_id": 53623129, "link": "https://stackoverflow.com/questions/53623129/passing-a-hash-as-an-argument-in-ruby/53623213#53623213", "title": "Passing a hash as an argument in Ruby", "body": "<p>You need to use symbols as hash keys when you access it:</p>\n\n<pre><code>def login_as(**hash)\n  mobile_number_textfield.send_keys(hash[:mobile_number])\n  password_textfield.send_keys(hash[:password])\n  next_button.click()\nend\n</code></pre>\n\n<p>Your code probably raises error in <code>mobile_number_textfield.send_keys(hash[:mobile_number])</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 1670, "user_id": 2140932, "user_type": "registered", "accept_rate": 19, "profile_image": "https://www.gravatar.com/avatar/ca88a8f0c7b45b934594eaf22d1dc55c?s=128&d=identicon&r=PG", "display_name": "Rafael C.", "link": "https://stackoverflow.com/users/2140932/rafael-c"}, "edited": false, "score": 0, "creation_date": 1544186793, "post_id": 53629268, "comment_id": 94197050, "body": "Thanks a lot Oli. I did something like this to work. I will post here my solution"}], "tags": [], "owner": {"reputation": 954, "user_id": 8838821, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Uzgur.png?s=128&g=1", "display_name": "Oli Crt", "link": "https://stackoverflow.com/users/8838821/oli-crt"}, "is_accepted": false, "score": 0, "last_activity_date": 1544002942, "creation_date": 1544002942, "answer_id": 53629268, "question_id": 53623129, "link": "https://stackoverflow.com/questions/53623129/passing-a-hash-as-an-argument-in-ruby/53629268#53629268", "title": "Passing a hash as an argument in Ruby", "body": "<p>You can do either of the following:</p>\n\n<pre><code>def login_as(mobile_number:, password:)\n  mobile_number_textfield.send_keys(mobile_number)\n  password_textfield.send_keys(password)\n  next_button.click()\nend\n\ndef login_as(hash)\n  mobile_number_textfield.send_keys(hash[:mobile_number])\n  password_textfield.send_keys(hash[:password])\n  next_button.click()\nend\n\nlogin_as({mobile_number: \"02980298098\", password: \"password\"})\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1670, "user_id": 2140932, "user_type": "registered", "accept_rate": 19, "profile_image": "https://www.gravatar.com/avatar/ca88a8f0c7b45b934594eaf22d1dc55c?s=128&d=identicon&r=PG", "display_name": "Rafael C.", "link": "https://stackoverflow.com/users/2140932/rafael-c"}, "is_accepted": true, "score": 0, "last_activity_date": 1544187456, "creation_date": 1544187456, "answer_id": 53670045, "question_id": 53623129, "link": "https://stackoverflow.com/questions/53623129/passing-a-hash-as-an-argument-in-ruby/53670045#53670045", "title": "Passing a hash as an argument in Ruby", "body": "<p>My solution to works:</p>\n\n<p>In my module I created a function only with a hash:</p>\n\n<p><strong>authentication.rb</strong></p>\n\n<pre><code>module Helpers\n  module Authentication\n    def sign_in_as\n      {\n        mobile_number: '123456789',\n        password: '123456'\n      }\n    end\n  end\nend\n</code></pre>\n\n<p>My <strong>spec_helper</strong> remains the same</p>\n\n<p><strong>spec_helper.rb</strong></p>\n\n<pre><code>require_relative './helpers/authentication'\n\n    RSpec.configure do |config|\n      config.include Helpers::Authentication\n    end\n</code></pre>\n\n<p>On my <strong>login_screen</strong> file, to each line that I want to send a hash value I added a symbol:</p>\n\n<p><strong>login_screen.rb</strong></p>\n\n<pre><code>  def login_as(**hash)\n    mobile_number_textfield.send_keys(hash[:mobile_number])\n    password_textfield.send_keys(hash[:password])\n    next_button.click()\n  end\n</code></pre>\n\n<p>In my <strong>login_spec</strong> file, I just called <code>sign_in_as</code> function (created in my module)</p>\n\n<p>Tip: In the spec file you don't need to require the module because the added line <code>config.include Helpers::Authentication</code> in the <strong>spec_helper</strong> file make this.</p>\n\n<p><strong>login_spec.rb</strong></p>\n\n<pre><code>RSpec.describe('Login') do\n  before(:all) do\n    puts \"something here\"\n  end\n\n  it('should login as founder') do \n    @login_screen.login_as(sign_in_as)\n  end\nend\n</code></pre>\n"}], "owner": {"reputation": 1670, "user_id": 2140932, "user_type": "registered", "accept_rate": 19, "profile_image": "https://www.gravatar.com/avatar/ca88a8f0c7b45b934594eaf22d1dc55c?s=128&d=identicon&r=PG", "display_name": "Rafael C.", "link": "https://stackoverflow.com/users/2140932/rafael-c"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 67, "favorite_count": 0, "accepted_answer_id": 53670045, "answer_count": 3, "score": 0, "last_activity_date": 1544187456, "creation_date": 1543967514, "last_edit_date": 1543997007, "question_id": 53623129, "link": "https://stackoverflow.com/questions/53623129/passing-a-hash-as-an-argument-in-ruby", "title": "Passing a hash as an argument in Ruby", "body": "<p>I am trying to implement a module that contains the data to be used in tests. Here is my module:</p>\n\n<p><strong>authentication.rb</strong></p>\n\n<pre><code>module Helpers\n  module Authentication\n    def sign_in_as\n      admin = {\n        mobile_number: \"123456789\",\n        password: \"123456\"\n      }\n    end\n  end\nend\n</code></pre>\n\n<p>The module is called in <code>spec_helper</code> file:</p>\n\n<p><strong>spec_helper.rb</strong></p>\n\n<pre><code>RSpec.configure do |config|\n  config.include Helpers::Authentication\nend\n</code></pre>\n\n<p>The file below is my method for receiving the login credentials:</p>\n\n<p><strong>login_screen.rb</strong></p>\n\n<pre><code>  def login_as(**hash)\n    mobile_number_textfield.send_keys(hash[mobile_number])\n    password_textfield.send_keys(hash[password])\n    next_button.click()\n  end\n</code></pre>\n\n<p>When I call the function from my module in my spec file, the credentials are not entered:</p>\n\n<p><strong>login_spec.rb</strong></p>\n\n<pre><code>RSpec.describe('Login') do\n  before(:all) do\n    puts \"something here\"\n  end\n\n  it('should login as founder') do \n    @login_screen.login_as(sign_in_as)\n  end\nend\n</code></pre>\n\n<p>How could I pass a hash to my login method?</p>\n"}, {"tags": ["ruby", "sinatra", "rack", "axlsx"], "answers": [{"tags": [], "owner": {"reputation": 527, "user_id": 9232623, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1ee218b4ed8393910be5a5c218025769?s=128&d=identicon&r=PG&f=1", "display_name": "ochero", "link": "https://stackoverflow.com/users/9232623/ochero"}, "is_accepted": false, "score": 1, "last_activity_date": 1543975832, "creation_date": 1543975832, "answer_id": 53624157, "question_id": 53623106, "link": "https://stackoverflow.com/questions/53623106/zero-bytes-sent-when-sending-axlsx-gem-generated-file-from-sinatra/53624157#53624157", "title": "Zero Bytes Sent When Sending Axlsx Gem Generated File From Sinatra", "body": "<p>It appears that the issue had everything to do with how <code>Axlsx::Package.new</code> was called, the helper functions were not available inside Axlsx, the following solution worked - online documentation said that the below content_type was better</p>\n\n<pre><code>get '/downloads' do\n  content_type :'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet'\n\n  p = Axlsx::Package.new\n  p.workbook.add_worksheet(name: 'Test') do |sheet|\n    sheet.add_row ['Hello world']\n  end\n  p.to_stream\nend\n</code></pre>\n"}], "owner": {"reputation": 527, "user_id": 9232623, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1ee218b4ed8393910be5a5c218025769?s=128&d=identicon&r=PG&f=1", "display_name": "ochero", "link": "https://stackoverflow.com/users/9232623/ochero"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 121, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1543975832, "creation_date": 1543967339, "question_id": 53623106, "link": "https://stackoverflow.com/questions/53623106/zero-bytes-sent-when-sending-axlsx-gem-generated-file-from-sinatra", "title": "Zero Bytes Sent When Sending Axlsx Gem Generated File From Sinatra", "body": "<p>Attempting to prompt a download window and stream an XLSX file using Ruby Sinatra and the AXLSX gem, my excel file serializes successfully to local file, so I know its a valid excel doc, but I need it to transfer content to the end user. There haven't been any docs online with examples of AXLS and Sinatra used together, only rails. Help is appreciated!</p>\n\n<pre><code>class Downloads &lt; Sinatra::Base\n  get '/downloads/report' do\n    ## ...\n    Axlsx::Package.new do |p|\n      p.workbook.add_worksheet(name: 'tab name') do |sheet|\n        ## ...\n      end\n      content_type 'application/xlsx'\n      attachment 'cost-code-dashboard.xlsx'\n      p.to_stream # unsuccessful\n      # p.to_stream.read # unsuccessful as well\n    end\n  end\nend\n</code></pre>\n\n<p>I have also tried the following snippet unsuccessfully</p>\n\n<pre><code>Axlsx::Package.new do |p|\n  ## ...\n  send_file p.to_stream.read, type: \"application/xlsx\", filename: \"cost-code-dashboard.xlsx\"\nend\n</code></pre>\n"}, {"tags": ["ruby", "sinatra", "partial-views", "erb"], "comments": [{"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1543967063, "post_id": 53621667, "comment_id": 94106524, "body": "Why does it matter? Does the page look wrong? Is the HTML malformed?"}, {"owner": {"reputation": 1653, "user_id": 1318874, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/0c89dbf404d7c6ac72954595c974e3d9?s=128&d=identicon&r=PG&f=1", "display_name": "Ilya Cherevkov", "link": "https://stackoverflow.com/users/1318874/ilya-cherevkov"}, "reply_to_user": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1543997256, "post_id": 53621667, "comment_id": 94115206, "body": "@TomLord Everything works as expected, except indention is not pretty. I guess I&#39;ll have to live with that"}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1544002450, "post_id": 53621667, "comment_id": 94117743, "body": "Does it even matter that the indentation isn&#39;t pretty? When you inspect anything in the browser, it auto-prettifies the HTML whitespace for you regardless."}, {"owner": {"reputation": 11068, "user_id": 335847, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/o0AC7.png?s=128&g=1", "display_name": "iain", "link": "https://stackoverflow.com/users/335847/iain"}, "edited": false, "score": 2, "creation_date": 1544187752, "post_id": 53621667, "comment_id": 94197496, "body": "I&#39;ve had similar problems with ERB in the past and found no way to properly fix it, <a href=\"https://stackoverflow.com/q/53167613/335847\">as have others</a>."}, {"owner": {"reputation": 1653, "user_id": 1318874, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/0c89dbf404d7c6ac72954595c974e3d9?s=128&d=identicon&r=PG&f=1", "display_name": "Ilya Cherevkov", "link": "https://stackoverflow.com/users/1318874/ilya-cherevkov"}, "reply_to_user": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1545129454, "post_id": 53621667, "comment_id": 94510646, "body": "@TomLord, maybe i&#39;m missing something, but my browsers don&#39;t auto-pretiffy anything"}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 1, "creation_date": 1545150310, "post_id": 53621667, "comment_id": 94522447, "body": "@icherevkov Right click --&gt; Inspect. Don&#39;t &quot;view page source&quot;."}, {"owner": {"reputation": 1653, "user_id": 1318874, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/0c89dbf404d7c6ac72954595c974e3d9?s=128&d=identicon&r=PG&f=1", "display_name": "Ilya Cherevkov", "link": "https://stackoverflow.com/users/1318874/ilya-cherevkov"}, "reply_to_user": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1547112322, "post_id": 53621667, "comment_id": 95082311, "body": "@TomLord yes, thanks. I never payed attention inspector actually prettifies html. although, my inner perfectionist is not satisfied"}], "owner": {"reputation": 1653, "user_id": 1318874, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/0c89dbf404d7c6ac72954595c974e3d9?s=128&d=identicon&r=PG&f=1", "display_name": "Ilya Cherevkov", "link": "https://stackoverflow.com/users/1318874/ilya-cherevkov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 116, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1544000967, "creation_date": 1543958849, "last_edit_date": 1544000967, "question_id": 53621667, "link": "https://stackoverflow.com/questions/53621667/ugly-indention-with-sinatra-erb-partials", "title": "Ugly indention with Sinatra ERB partials", "body": "<p>I have a problem in Sinatra with ERB templating engine. Partials are rendered with wrong indention.</p>\n\n<p>There is no custom helpers, or <a href=\"https://github.com/yb66/Sinatra-Partial\" rel=\"nofollow noreferrer\">sinatra-partial</a> gem, just vanilla Sinatra. Also have 'sinatra-contrib' installed, if it makes any difference.</p>\n\n<p>Editor is Sublime Text, and all files use spaces for indention. Sublime Text has <code>ensure_newline_at_eof_on_save</code> setting enabled (I tried to disable it, but it gives no difference).</p>\n\n<p><strong>Views structure</strong></p>\n\n<pre><code>views\n   |- layouts\n       |- application.erb\n   |- main\n       |- index.erb\n   |- partials\n       |- header.erb\n</code></pre>\n\n<p><strong>layouts/application.erb</strong></p>\n\n<pre><code>&lt;html&gt;\n  &lt;body&gt;\n    &lt;%= yield %&gt;\n  &lt;/body&gt;\n&lt;/html&gt;\n</code></pre>\n\n<p><strong>main/index.erb</strong></p>\n\n<pre><code>&lt;article&gt;\n  &lt;%= erb :'partials/header', layout: false %&gt;\n&lt;/article&gt;\n</code></pre>\n\n<p><strong>partials/header.erb</strong></p>\n\n<pre><code>&lt;header&gt;\n  &lt;h1&gt;Newsletter&lt;/h1&gt;\n&lt;/header&gt;\n</code></pre>\n\n<p>Renders HTML</p>\n\n<pre><code>&lt;html&gt;\n  &lt;body&gt;\n    &lt;article&gt;\n\n  &lt;header&gt;\n  &lt;h1&gt;Newsletter&lt;/h1&gt;\n&lt;/header&gt;\n\n&lt;/article&gt;\n\n  &lt;/body&gt;\n&lt;/html&gt;\n</code></pre>\n"}, {"tags": ["ruby", "loops", "syntax"], "comments": [{"owner": {"reputation": 9030, "user_id": 5101476, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JCQrl.jpg?s=128&g=1", "display_name": "ice\u30c4", "link": "https://stackoverflow.com/users/5101476/ice%e3%83%84"}, "edited": false, "score": 4, "creation_date": 1543957812, "post_id": 53621388, "comment_id": 94103327, "body": "1. The <code>Until</code> loop needs to be <code>until</code> 2. The <code>unless</code> conditional is missing an <code>end</code>."}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 2, "creation_date": 1543958364, "post_id": 53621388, "comment_id": 94103570, "body": "You need to put an <code>end</code> at the end."}, {"owner": {"reputation": 6462, "user_id": 3784008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/55ou4.jpg?s=128&g=1", "display_name": "anothermh", "link": "https://stackoverflow.com/users/3784008/anothermh"}, "edited": false, "score": 1, "creation_date": 1543964462, "post_id": 53621388, "comment_id": 94105838, "body": "An easy way to troubleshoot this type of problem when you&#39;re just getting started is to comment out every line, then uncomment one line or one block at a time until the error is triggered again."}], "answers": [{"comments": [{"owner": {"reputation": 17, "user_id": 10410998, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nrASJ.jpg?s=128&g=1", "display_name": "Mary B", "link": "https://stackoverflow.com/users/10410998/mary-b"}, "edited": false, "score": 0, "creation_date": 1544044243, "post_id": 53623883, "comment_id": 94141094, "body": "The until and last end were the problems, alright! Thank you. It runs perfectly now."}], "tags": [], "owner": {"reputation": 3201, "user_id": 2892779, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uvM8S.jpg?s=128&g=1", "display_name": "Jay Dorsey", "link": "https://stackoverflow.com/users/2892779/jay-dorsey"}, "is_accepted": false, "score": 1, "last_activity_date": 1543973467, "creation_date": 1543973467, "answer_id": 53623883, "question_id": 53621388, "link": "https://stackoverflow.com/questions/53621388/ruby-with-missing-end-or-extra-end/53623883#53623883", "title": "Ruby with missing end. Or extra end?", "body": "<p>As Tom Lord mentioned, you're missing an <code>end</code> at the end and the keyword <code>Until</code> should be all lowercase per Sagar Pandya. Your application, in it's entirety, should be as below.</p>\n\n<pre><code>puts \"Welcome to 'Get My Number!'\"\nprint \"What's your name? \"\n\ninput = gets\n\nname = input.chomp\n\nputs \"Welcome, #{name}!\"\n\n# Store a random number for the player to guess.\n\nputs \"I've got a random number between 1 and 100.\"\nputs \"Can you guess it?\"\ntarget = rand(100) + 1\n\n# Track how many guesses the player has made.\n\nnum_guesses = 0\n\n# Track whether player has guessed correctly.\n\nguessed_it = false\n\nuntil num_guesses == 10 || guessed_it\n\n  puts \"You've got #{10 - num_guesses} guesses left.\"\n  print \"Make a guess: \"\n  guess = gets.to_i\n\n  num_guesses += 1\n\n# Compare guess to target and print appropriate message.\n\n  if guess &lt; target\n    puts \"Oops. Your guess was LOW.\"\n  elsif guess &gt; target\n    puts \"Oops. Your guess was HIGH.\"\n  elsif guess == target\n    puts \"Good job, #{name}!\"\n    puts \"You guessed my number in #{num_guesses} guesses!\"\n    guessed_it = true\n  end\nend\n\n#If the player didn't guess in time, show the target number.\n\nunless guessed_it\n  puts \"Sorry. You didn't get my number. (It was #{target}.)\"\nend\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 17, "user_id": 10410998, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nrASJ.jpg?s=128&g=1", "display_name": "Mary B", "link": "https://stackoverflow.com/users/10410998/mary-b"}, "edited": false, "score": 0, "creation_date": 1544044307, "post_id": 53625726, "comment_id": 94141124, "body": "This seems much cleaner. The problem was the capitalized until and the missing end. I will probably use this case much more in the future, thank you."}], "tags": [], "owner": {"reputation": 392, "user_id": 9910110, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OTTsN.jpg?s=128&g=1", "display_name": "Sandra", "link": "https://stackoverflow.com/users/9910110/sandra"}, "is_accepted": false, "score": 3, "last_activity_date": 1543987886, "creation_date": 1543987886, "answer_id": 53625726, "question_id": 53621388, "link": "https://stackoverflow.com/questions/53621388/ruby-with-missing-end-or-extra-end/53625726#53625726", "title": "Ruby with missing end. Or extra end?", "body": "<p>I think problem is in <code>if</code> and <code>elsif</code> block. Change it to <code>case</code>. Also it\u2019s more clean and easy to understand.</p>\n\n<p>For example, in this way:</p>\n\n<pre><code>case \nwhen guess &lt; target then puts \"Oops. Your guess was LOW.\"\nwhen guess &gt; target then puts \"Oops. Your guess was HIGH.\"\nwhen guess == target then\n   puts \"Good job, #{name}!\"\n   puts \"You guessed my number in #{num_guesses} guesses!\"\n   guessed_it = true\nend\n</code></pre>\n\n<p>I hope it useful for you.</p>\n"}], "owner": {"reputation": 17, "user_id": 10410998, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nrASJ.jpg?s=128&g=1", "display_name": "Mary B", "link": "https://stackoverflow.com/users/10410998/mary-b"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 144, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1543987886, "creation_date": 1543957474, "question_id": 53621388, "link": "https://stackoverflow.com/questions/53621388/ruby-with-missing-end-or-extra-end", "title": "Ruby with missing end. Or extra end?", "body": "<p>I saw this one answered before, but I just can NOT find the missing END here. It's a simple Ruby program for learning. I went back and typed it exactly as they had it. Still getting the error. Where is the end missing????</p>\n\n<pre><code>puts \"Welcome to 'Get My Number!'\"\nprint \"What's your name? \"\n\ninput = gets\n\nname = input.chomp\n\nputs \"Welcome, #{name}!\"\n\n# Store a random number for the player to guess.\n\nputs \"I've got a random number between 1 and 100.\"\nputs \"Can you guess it?\"\ntarget = rand(100) + 1\n\n# Track how many guesses the player has made.\n\nnum_guesses = 0\n\n# Track whether player has guessed correctly.\n\nguessed_it = false\n\nUntil num_guesses == 10 || guessed_it\n\n  puts \"You've got #{10 - num_guesses} guesses left.\"\n  print \"Make a guess: \"\n  guess = gets.to_i\n\n  num_guesses += 1\n\n# Compare guess to target and print appropriate message.\n\n  if guess &lt; target\n    puts \"Oops. Your guess was LOW.\"\n  elsif guess &gt; target\n    puts \"Oops. Your guess was HIGH.\"\n  elsif guess == target\n    puts \"Good job, #{name}!\"\n    puts \"You guessed my number in #{num_guesses} guesses!\"\n    guessed_it = true\n  end\n\n end\n\n #If the player didn't guess in time, show the target number.\n\n unless guessed_it\n    puts \"Sorry. You didn't get my number. (It was #{target}.)\"\n</code></pre>\n"}, {"tags": ["ruby", "currying", "arity"], "answers": [{"tags": [], "owner": {"reputation": 394580, "user_id": 479863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ArUCE.jpg?s=128&g=1", "display_name": "mu is too short", "link": "https://stackoverflow.com/users/479863/mu-is-too-short"}, "is_accepted": true, "score": 3, "last_activity_date": 1544086268, "last_edit_date": 1544086268, "creation_date": 1543983850, "answer_id": 53625157, "question_id": 53620881, "link": "https://stackoverflow.com/questions/53620881/understanding-the-arity-parameter-of-the-method-proc-curry-in-ruby/53625157#53625157", "title": "Understanding the arity parameter of the method Proc.curry in Ruby", "body": "<p>Perhaps walking through a better example might help. Let us start with a simple proc:</p>\n\n<pre><code>p = proc { |a, b, c| \"a=#{a.inspect}, b=#{b.inspect}, c=#{c.inspect}\" }\np[1,2,3]\n# \"a=1, b=2, c=3\" \n</code></pre>\n\n<p>If we call <code>curry</code> without the <code>arity</code> argument then it is pretty clear what's going on:</p>\n\n<pre><code>p.curry          # evaluates to a proc\np.curry[1]       # and a different proc\np.curry[1][2]    # another different proc\np.curry[1][2][3] # \"a=1, b=2, c=3\" \np.curry[1,2]     # yet another proc, hooray for procs!\np.curry[1,2][3]  # \"a=1, b=2, c=3\"\np.curry[1,2,3]   # \"a=1, b=2, c=3\"\n</code></pre>\n\n<p>So <code>p.curry</code> gives us a succession of <code>Proc</code>s by supplying values for the arguments until we have enough to evaluate the original <code>Proc</code>. Now we start adding <code>arity</code> values:</p>\n\n<pre><code>p.curry(1)          # some proc\np.curry(1)[]        # some other proc,\np.curry(1)[1]       # \"a=1, b=nil, c=nil\" \np.curry(1)[1, 2]    # \"a=1, b=2, c=nil\" \np.curry(1)[1, 2, 3] # \"a=1, b=2, c=3\"\n\np.curry(2)          # a proc\np.curry(2)[]        # another proc\np.curry(2)[1]       # oh look, a proc, a lovely surprise\np.curry(2)[1][2]    # \"a=1, b=2, c=nil\" \np.curry(2)[1, 2]    # \"a=1, b=2, c=nil\" \np.curry(2)[1, 2, 3] # \"a=1, b=2, c=3\" \n</code></pre>\n\n<p>The <code>arity</code> argument is setting the effective arity of the curried proc; don't bother looking at the <em>real</em> arity \u2013 <code>p.curry.arity</code>, <code>p.curry(1).arity</code>, ... \u2013 since it will always be <code>-1</code> (i.e. variadic). The result is that <code>p.curry(1)</code> is sort of like</p>\n\n<pre><code>proc { |a| p[a] }.curry # \"change\" p's arity to 1 then curry\n</code></pre>\n\n<p>and <code>p.curry(2)</code> is sort of like:</p>\n\n<pre><code>proc { |a, b| p[a, b] }.curry # \"change\" p's arity to 2 then curry\n</code></pre>\n\n<p>etc. Keep in mind that just because a (non-lambda) proc has arity <code>n</code> doesn't mean that you have to call it with <code>n</code> arguments. A proc's arity is more of a suggestion than anything else.</p>\n\n<p>Of course, if you try this chicanery with a lambda then everything goes sideways because lambdas care very much about their arity:</p>\n\n<pre><code>\u03bb = -&gt;(a, b, c) {  \"a=#{a.inspect}, b=#{b.inspect}, c=#{c.inspect}\" }\n\n\u03bb[1]             # ArgumentError (wrong number of arguments (given 1, expected 3))\n\u03bb.curry[1]       # a lambda-proc\n\u03bb.curry[1][2][3] # \"a=1, b=2, c=3\" \n\u03bb.curry[1][2, 3] # \"a=1, b=2, c=3\" \n\n\u03bb.curry(1)       # ArgumentError (wrong number of arguments (given 1, expected 3))\n\u03bb.curry(2)       # ArgumentError (wrong number of arguments (given 2, expected 3))\n\u03bb.curry(3)       # a lambda-proc that's just like \u03bb.curry\n</code></pre>\n"}], "owner": {"reputation": 21084, "user_id": 170931, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/WA698.png?s=128&g=1", "display_name": "Just a learner", "link": "https://stackoverflow.com/users/170931/just-a-learner"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 418, "favorite_count": 0, "accepted_answer_id": 53625157, "answer_count": 1, "score": 3, "last_activity_date": 1544086268, "creation_date": 1543955170, "last_edit_date": 1592644375, "question_id": 53620881, "link": "https://stackoverflow.com/questions/53620881/understanding-the-arity-parameter-of-the-method-proc-curry-in-ruby", "title": "Understanding the arity parameter of the method Proc.curry in Ruby", "body": "<p>In the documentation of Ruby's <code>Proc.curry</code> method at <a href=\"https://ruby-doc.org/core-2.5.3/Proc.html#method-i-curry\" rel=\"nofollow noreferrer\">https://ruby-doc.org/core-2.5.3/Proc.html#method-i-curry</a>, it says:</p>\n<blockquote>\n<p>curry -&gt; a_proc</p>\n<p>curry(arity) -&gt; a_proc</p>\n<p>Returns a curried proc. If the optional arity argument is given, it determines the number of arguments. A curried proc receives some arguments. If a sufficient number of arguments are supplied, it passes the supplied arguments to the original proc and returns the result. Otherwise, returns another curried proc that takes the rest of arguments.</p>\n</blockquote>\n<p>I know <code>arity</code> means the number of arguments of a function. However, I'm not quite clear how it works here. Can anyone help to explain, please? I've read the examples on the doc, but still confused.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-5"], "answers": [{"comments": [{"owner": {"reputation": 5149, "user_id": 2708460, "user_type": "registered", "accept_rate": 32, "profile_image": "https://www.gravatar.com/avatar/78fb5597f10a8f25d2a69cbf70fd6ecd?s=128&d=identicon&r=PG&f=1", "display_name": "almo", "link": "https://stackoverflow.com/users/2708460/almo"}, "edited": false, "score": 0, "creation_date": 1543957109, "post_id": 53621009, "comment_id": 94102993, "body": "My DB needs to remain in UTC, Gems like Chartkick need UTC"}], "tags": [], "owner": {"reputation": 498, "user_id": 10384879, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-5HTxyDEG1Qo/AAAAAAAAAAI/AAAAAAAAAeQ/9iMyCvOw2A4/photo.jpg?sz=128", "display_name": "giri dharan", "link": "https://stackoverflow.com/users/10384879/giri-dharan"}, "is_accepted": false, "score": 0, "last_activity_date": 1543955747, "creation_date": 1543955747, "answer_id": 53621009, "question_id": 53620564, "link": "https://stackoverflow.com/questions/53620564/actionviewtemplateerror-database-and-ruby-have-inconsistent-time-zone-info/53621009#53621009", "title": "ActionView::Template::Error (Database and Ruby have inconsistent time zone info", "body": "<p>Add following line in your application.rb</p>\n\n<blockquote>\n  <p>config.time_zone = \"America/Sao_Paulo\"\n  config.active_record.default_timezone = :local</p>\n</blockquote>\n"}, {"tags": [], "owner": {"reputation": 336, "user_id": 295260, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2219610b3b66304feff3483bdefd6884?s=128&d=identicon&r=PG", "display_name": "johnsampson", "link": "https://stackoverflow.com/users/295260/johnsampson"}, "is_accepted": false, "score": 0, "last_activity_date": 1585690118, "creation_date": 1585690118, "answer_id": 60960172, "question_id": 53620564, "link": "https://stackoverflow.com/questions/53620564/actionviewtemplateerror-database-and-ruby-have-inconsistent-time-zone-info/60960172#60960172", "title": "ActionView::Template::Error (Database and Ruby have inconsistent time zone info", "body": "<p>I assume you're using the <a href=\"https://github.com/ankane/groupdate\" rel=\"nofollow noreferrer\">Groupdate</a> gem, no?  This likely started with the transition from standard to daylight time.  </p>\n\n<p>If this is the case, it appears this was resolved in the release of 5.0.0.  See the <a href=\"https://github.com/ankane/groupdate/blob/master/CHANGELOG.md\" rel=\"nofollow noreferrer\">CHANGELOG.md</a>.</p>\n\n<blockquote>\n  <p><code>Fixed inconsistent time zone info errors around DST with MySQL and PostgreSQL</code></p>\n</blockquote>\n\n<p>Note, it may require you to bump your ruby version.</p>\n"}], "owner": {"reputation": 5149, "user_id": 2708460, "user_type": "registered", "accept_rate": 32, "profile_image": "https://www.gravatar.com/avatar/78fb5597f10a8f25d2a69cbf70fd6ecd?s=128&d=identicon&r=PG&f=1", "display_name": "almo", "link": "https://stackoverflow.com/users/2708460/almo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 301, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1585690118, "creation_date": 1543953631, "question_id": 53620564, "link": "https://stackoverflow.com/questions/53620564/actionviewtemplateerror-database-and-ruby-have-inconsistent-time-zone-info", "title": "ActionView::Template::Error (Database and Ruby have inconsistent time zone info", "body": "<p>All of the sudden I get the following error in my Rails 5 app:</p>\n\n<pre><code>ActionView::Template::Error (Database and Ruby have inconsistent time zone info. Database returned 2018-10-31 23:00:00 -0300\n</code></pre>\n\n<p>In my config file I have set the TZ to:</p>\n\n<pre><code>config.time_zone = 'America/Sao_Paulo' \n</code></pre>\n\n<p>The database is in UTC. I don't think that I have changed something.\nWith this error I did not find any similar problems on Google.</p>\n"}, {"tags": ["ruby", "ruby-on-rails-3", "activeadmin", "formtastic"], "answers": [{"tags": [], "owner": {"reputation": 2560, "user_id": 153279, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/783f796db3d628f7c268326fb3323de8?s=128&d=identicon&r=PG", "display_name": "Piers C", "link": "https://stackoverflow.com/users/153279/piers-c"}, "is_accepted": true, "score": 0, "last_activity_date": 1544553765, "creation_date": 1544553765, "answer_id": 53730467, "question_id": 53619950, "link": "https://stackoverflow.com/questions/53619950/adding-custom-form-actions-in-activeadmin/53730467#53730467", "title": "Adding custom form actions in ActiveAdmin", "body": "<p><code>form</code> is an Arbre tag that maps directly to HTML, in which case <code>action</code> is an attribute, eg.</p>\n\n<pre><code>form(action: '/someroute', method: :patch) do ... end\n</code></pre>\n\n<p>If you want to embed a Rails or Formtastic form you would use <code>form_for</code> or <code>active_admin_form_for</code> respectively.</p>\n"}], "owner": {"reputation": 50, "user_id": 4780761, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-fKBof-K7IWw/AAAAAAAAAAI/AAAAAAAAAaU/MbThUrIht3k/photo.jpg?sz=128", "display_name": "C.J. Coffey", "link": "https://stackoverflow.com/users/4780761/c-j-coffey"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 952, "favorite_count": 0, "accepted_answer_id": 53730467, "answer_count": 1, "score": 0, "last_activity_date": 1544553765, "creation_date": 1543950933, "question_id": 53619950, "link": "https://stackoverflow.com/questions/53619950/adding-custom-form-actions-in-activeadmin", "title": "Adding custom form actions in ActiveAdmin", "body": "<p>I'm using ActiveAdmin to add google OAuth credentials to a record. The client ID and Client Secret are added via <code>record/1/edit</code>, and I use those to generate a link to allow access. This link appears in <code>record/view</code>. I am trynig to find a way for the Administrator to enter the code returned by google oauth into the portal so that I can use it to generate credentials. </p>\n\n<p>My current attempt looks something like this</p>\n\n<p><code>row \"Code from Google OAuth\" do\n        form do |f|\n          label \"Google Auth Code:\"\n          input :code, :label =&gt; \"Code\", :hint =&gt; \"Code returned by google auth\"\n          f.action :submit\n        end</code></p>\n\n<p>I get an \"undefined method: action\" error form this code. Any ideas on how to return user input as a parameter?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "rails-activestorage"], "comments": [{"owner": {"reputation": 131, "user_id": 9741270, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yK6TA.jpg?s=128&g=1", "display_name": "Clyde T", "link": "https://stackoverflow.com/users/9741270/clyde-t"}, "edited": false, "score": 0, "creation_date": 1543951460, "post_id": 53619905, "comment_id": 94100452, "body": "Do you look <a href=\"https://edgeguides.rubyonrails.org/active_storage_overview.html#attaching-files-to-records\" rel=\"nofollow noreferrer\">edgeguides.rubyonrails.org/&hellip;</a> ?"}, {"owner": {"reputation": 129, "user_id": 4092209, "user_type": "registered", "accept_rate": 60, "profile_image": "https://lh4.googleusercontent.com/-wO-Ict-PhDw/AAAAAAAAAAI/AAAAAAAAAxE/v1lbYcZ86wM/photo.jpg?sz=128", "display_name": "Alexis", "link": "https://stackoverflow.com/users/4092209/alexis"}, "reply_to_user": {"reputation": 131, "user_id": 9741270, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yK6TA.jpg?s=128&g=1", "display_name": "Clyde T", "link": "https://stackoverflow.com/users/9741270/clyde-t"}, "edited": false, "score": 0, "creation_date": 1543951613, "post_id": 53619905, "comment_id": 94100521, "body": "@ClydeT Yes, I haven&#39;t seen anything about that"}], "answers": [{"comments": [{"owner": {"reputation": 129, "user_id": 4092209, "user_type": "registered", "accept_rate": 60, "profile_image": "https://lh4.googleusercontent.com/-wO-Ict-PhDw/AAAAAAAAAAI/AAAAAAAAAxE/v1lbYcZ86wM/photo.jpg?sz=128", "display_name": "Alexis", "link": "https://stackoverflow.com/users/4092209/alexis"}, "edited": false, "score": 0, "creation_date": 1543954747, "post_id": 53620389, "comment_id": 94101962, "body": "Thanks, Yes I found this solution too and it seems to work ;)"}, {"owner": {"reputation": 1261, "user_id": 1072655, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1c38e4b0c87c8caec09fe6a441f3e35c?s=128&d=identicon&r=PG", "display_name": "tomb", "link": "https://stackoverflow.com/users/1072655/tomb"}, "edited": false, "score": 0, "creation_date": 1556053402, "post_id": 53620389, "comment_id": 98305177, "body": "I have the same problem, but I&#39;m using a joins.  Listings have many attachments. School.joins(:listing).where(&#39;beds &gt; ?&#39;,beds).  How do I eager load attachments in this case, or better yet, not load attachments at all?"}, {"owner": {"reputation": 3201, "user_id": 2892779, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uvM8S.jpg?s=128&g=1", "display_name": "Jay Dorsey", "link": "https://stackoverflow.com/users/2892779/jay-dorsey"}, "reply_to_user": {"reputation": 1261, "user_id": 1072655, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1c38e4b0c87c8caec09fe6a441f3e35c?s=128&d=identicon&r=PG", "display_name": "tomb", "link": "https://stackoverflow.com/users/1072655/tomb"}, "edited": false, "score": 1, "creation_date": 1556054291, "post_id": 53620389, "comment_id": 98305513, "body": "@tomb you might be able to use <code>Model.select()</code> to limit the fields that are included/presented (and not include the <code>with_attached...</code> syntax as well"}], "tags": [], "owner": {"reputation": 3201, "user_id": 2892779, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uvM8S.jpg?s=128&g=1", "display_name": "Jay Dorsey", "link": "https://stackoverflow.com/users/2892779/jay-dorsey"}, "is_accepted": false, "score": 3, "last_activity_date": 1543952877, "creation_date": 1543952877, "answer_id": 53620389, "question_id": 53619905, "link": "https://stackoverflow.com/questions/53619905/rails-activestorage-has-on-attached-has-many-attached-associations-is-load-by/53620389#53620389", "title": "Rails ActiveStorage - has_on_attached/has_many_attached associations is load by default", "body": "<p>You can use <code>Model.with_attached_images.find(:id)</code> to avoid the N+1</p>\n\n<p><a href=\"https://github.com/rails/rails/tree/master/activestorage#examples\" rel=\"nofollow noreferrer\">https://github.com/rails/rails/tree/master/activestorage#examples</a></p>\n\n<p>I'm not sure if you can disable eager loading the attachments, but the above should help clean up a little bit.</p>\n"}], "owner": {"reputation": 129, "user_id": 4092209, "user_type": "registered", "accept_rate": 60, "profile_image": "https://lh4.googleusercontent.com/-wO-Ict-PhDw/AAAAAAAAAAI/AAAAAAAAAxE/v1lbYcZ86wM/photo.jpg?sz=128", "display_name": "Alexis", "link": "https://stackoverflow.com/users/4092209/alexis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 669, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1543952877, "creation_date": 1543950737, "question_id": 53619905, "link": "https://stackoverflow.com/questions/53619905/rails-activestorage-has-on-attached-has-many-attached-associations-is-load-by", "title": "Rails ActiveStorage - has_on_attached/has_many_attached associations is load by default", "body": "<p>I got a problem with ActiveStorage, Currently I have <code>has_on_attached</code>and <code>has_many_attached</code> relation on my Model</p>\n\n<p>Every time I call my model it loads the relation as below: </p>\n\n<p><code>\n  ActiveStorage::Attachment Load (4.2ms)  SELECT  \"active_storage_attachments\".* FROM \"active_storage_attachments\" WHERE \"active_storage_attachments\".\"record_id\" = $1 AND \"active_storage_attachments\".\"record_type\" = $2 AND \"active_storage_attachments\".\"name\" = $3 LIMIT $4  [[\"record_id\", 4934], [\"record_type\", \"User\"], [\"name\", \"profile_picture\"], [\"LIMIT\", 1]]\n</code></p>\n\n<p><code>ActiveStorage::Attachment Exists (0.9ms)  SELECT  1 AS one FROM \"active_storage_attachments\" WHERE \"active_storage_attachments\".\"record_id\" = $1 AND \"active_storage_attachments\".\"record_type\" = $2 AND \"active_storage_attachments\".\"name\" = $3 LIMIT $4  [[\"record_id\", 4934], [\"record_type\", \"User\"], [\"name\", \"home_pictures\"], [\"LIMIT\", 1]]</code></p>\n\n<p>How can I disable this behaviour by default ?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "xml", "api", "nokogiri"], "answers": [{"tags": [], "owner": {"reputation": 14213, "user_id": 398863, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4CNtJ.png?s=128&g=1", "display_name": "Amit Patel", "link": "https://stackoverflow.com/users/398863/amit-patel"}, "is_accepted": true, "score": 0, "last_activity_date": 1543976583, "creation_date": 1543976583, "answer_id": 53624248, "question_id": 53619819, "link": "https://stackoverflow.com/questions/53619819/trying-to-output-information-from-xml-api-using-nokogiri/53624248#53624248", "title": "Trying to output information from xml api using nokogiri", "body": "<p>Your XML at <a href=\"http://api.irishrail.ie/realtime/realtime.asmx/getAllStationsXML\" rel=\"nofollow noreferrer\">http://api.irishrail.ie/realtime/realtime.asmx/getAllStationsXML</a> has <a href=\"https://en.wikipedia.org/wiki/XML_namespace\" rel=\"nofollow noreferrer\">namespace </a>(<em>I modified the xml to reflect what is returned by API</em>)</p>\n\n<p>You need to use namespace prefix in xpath notation to get it work.</p>\n\n<p>replace <code>@doc.xpath('//StationId')</code> with <code>@doc.xpath('//xmlns:StationId')</code> to fix it.</p>\n"}], "owner": {"reputation": 3, "user_id": 10745706, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f6061309b781240b9519436edb8c9350?s=128&d=identicon&r=PG&f=1", "display_name": "Willie", "link": "https://stackoverflow.com/users/10745706/willie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 34, "favorite_count": 0, "accepted_answer_id": 53624248, "answer_count": 1, "score": 0, "last_activity_date": 1543976583, "creation_date": 1543950385, "last_edit_date": 1543976449, "question_id": 53619819, "link": "https://stackoverflow.com/questions/53619819/trying-to-output-information-from-xml-api-using-nokogiri", "title": "Trying to output information from xml api using nokogiri", "body": "<p>I'm trying to output information to a web page taken from an XML transport api for a college project. I'm using ruby on rails and the nokogiri gem. I can take in the information but when I try to output it on the results page it is just blank. </p>\n\n<p>The below method for taking in the api information is in the relevant rails controller file. </p>\n\n<pre><code>def results\nrequire 'nokogiri'\n\n@doc = Nokogiri::XML(open(\"http://api.irishrail.ie/realtime/realtime.asmx/getAllStationsXML\"))\nend\n</code></pre>\n\n<p>I can see the xml information is being passed to the view. When I just put <code>&lt;%= @doc %&gt;</code> in the view it causes the information in xml format to print out on the page.</p>\n\n<p>However, I obviously need to format it correctly. I have the code below in the view and have also tried putting it in the controller method (minus the &lt;% %> notation) but it doesn't seem to work. </p>\n\n<pre><code>&lt;% @doc.xpath('//StationId').each do |station_element| %&gt;\n\n&lt;%= station_element.text %&gt;\n\n&lt;% end %&gt;\n</code></pre>\n\n<p>This is what the XML data looks like:</p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n&lt;ArrayOfObjStation xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\" xmlns=\"http://api.irishrail.ie/realtime/\"&gt;\n  &lt;objStation&gt;\n    &lt;StationDesc&gt;Belfast Central&lt;/StationDesc&gt;\n    &lt;StationAlias /&gt;\n    &lt;StationLatitude&gt;54.6123&lt;/StationLatitude&gt;\n    &lt;StationLongitude&gt;-5.91744&lt;/StationLongitude&gt;\n    &lt;StationCode&gt;BFSTC&lt;/StationCode&gt;\n    &lt;StationId&gt;228&lt;/StationId&gt;\n  &lt;/objStation&gt;\n  &lt;objStation&gt;\n    &lt;StationDesc&gt;Lisburn&lt;/StationDesc&gt;\n    &lt;StationAlias /&gt;\n    &lt;StationLatitude&gt;54.514&lt;/StationLatitude&gt;\n    &lt;StationLongitude&gt;-6.04327&lt;/StationLongitude&gt;\n    &lt;StationCode&gt;LBURN&lt;/StationCode&gt;\n    &lt;StationId&gt;238&lt;/StationId&gt;\n  &lt;/objStation&gt;\n&lt;/ArrayOfObjStation&gt;\n</code></pre>\n\n<p>I'd appreciate if someone could indicate what code I need to print out just certain parts of the xml data, thanks.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "applicationcontroller", "respond-with", "responders"], "comments": [{"owner": {"reputation": 17, "user_id": 4709821, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cde11bc6f9961136020b14c47a4d9456?s=128&d=identicon&r=PG&f=1", "display_name": "Im_Matt_Murdock", "link": "https://stackoverflow.com/users/4709821/im-matt-murdock"}, "edited": false, "score": 0, "creation_date": 1543953124, "post_id": 53619480, "comment_id": 94101252, "body": "Adding this method to the controller fixed the issue <code>def flash     {}   end</code>"}, {"owner": {"reputation": 17, "user_id": 4709821, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cde11bc6f9961136020b14c47a4d9456?s=128&d=identicon&r=PG&f=1", "display_name": "Im_Matt_Murdock", "link": "https://stackoverflow.com/users/4709821/im-matt-murdock"}, "edited": false, "score": 0, "creation_date": 1544051700, "post_id": 53619480, "comment_id": 94143817, "body": "The above gets the code to run, but I cannot render html now, only json"}], "owner": {"reputation": 17, "user_id": 4709821, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cde11bc6f9961136020b14c47a4d9456?s=128&d=identicon&r=PG&f=1", "display_name": "Im_Matt_Murdock", "link": "https://stackoverflow.com/users/4709821/im-matt-murdock"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 188, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1543948842, "creation_date": 1543948842, "question_id": 53619480, "link": "https://stackoverflow.com/questions/53619480/getting-undefined-method-flash-for-my-controllers-after-updating-rails-from", "title": "Getting &quot;undefined method `flash`&quot; for my controllers after updating Rails from 4.1 to 5.2 and added the responders gem", "body": "<p>I'm in the process of updating rails from 4.1 to 5.2\nI added the <code>responders</code> gem so respond_with is present.\nMy ApplicationController now looks like this:</p>\n\n<p><code>class ApplicationController &lt; ActionController::API\n  self.responder = ApplicationResponder\n  respond_to :html</code></p>\n\n<p>However, when I call <code>respond_with</code> I get this error:</p>\n\n<pre><code> NoMethodError: undefined method `flash' for #&lt;MyController&gt;\n</code></pre>\n\n<p>I noticed in the responders README that there is a flash responder, however I do not want to use that.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "join", "enums"], "owner": {"reputation": 331, "user_id": 7020299, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6lN5r.jpg?s=128&g=1", "display_name": "Misu", "link": "https://stackoverflow.com/users/7020299/misu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 39, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1543979961, "creation_date": 1543947847, "last_edit_date": 1543979961, "question_id": 53619246, "link": "https://stackoverflow.com/questions/53619246/is-there-any-way-to-type-cast-value-of-enum-column-in-a-joined-table", "title": "Is there any way to type cast value of enum column in a joined table?", "body": "<p>I have the following models:</p>\n\n<pre><code>class Conversation &lt; ApplicationRecord\n  enum status: [ :active, :archived ]\n  belongs_to :person\nend\n\nclass Person &lt; ApplicationRecord\n  has_many :conversations\nend\n</code></pre>\n\n<p>When I run the following query,</p>\n\n<pre><code>@people = Person\n  .select('`user`.`name`, `conversations`.`status` AS conversation_status')\n  .joins(:conversations)\n\n@people.map &amp;:conversation_status\n# =&gt; [1, 1, 0]\n</code></pre>\n\n<p>I get the values of <code>conversation_status</code> un-typecasted because the returned records are instances of the <code>Person</code> model, but the <code>enum</code> is defined on <code>Conversation</code>. I was wondering if there was a way to type cast an <code>enum</code> column's value manually. I can do the following to type cast the values:</p>\n\n<pre><code>@people.map do |person|\n  Conversation.statuses.find { |name, i| i == person.conversation_status }.first\nend\n# =&gt; ['archived', 'archived', 'active']\n</code></pre>\n\n<p>but it seems a bit awkward. Is there an official/rails/less awkward way of getting there?</p>\n\n<p>Digging into the source code, I found that there is an <code>ActiveRecord::Enum::EnumType</code> instance that can <code>deserialize</code> the value for me, but I  did not find any public way to fetch it.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "sql-injection"], "comments": [{"owner": {"reputation": 13442, "user_id": 3982562, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2a3c7aae1d762372cda697833c602ec8?s=128&d=identicon&r=PG", "display_name": "3limin4t0r", "link": "https://stackoverflow.com/users/3982562/3limin4t0r"}, "edited": false, "score": 0, "creation_date": 1543960855, "post_id": 53618774, "comment_id": 94104611, "body": "This won&#39;t solve your issue, but does make things more readable. When having large blocks of text consider using <a href=\"http://ruby-doc.org/core-2.5.3/doc/syntax/literals_rdoc.html#label-Here+Documents\" rel=\"nofollow noreferrer\">heredoc</a>. Some IDEs also adjust syntax highlighting based on the provided tag. In this case <code>&lt;&lt;~SQL</code> or <code>&lt;&lt;~&#39;SQL&#39;</code> if you don&#39;t want string interpolation."}], "answers": [{"tags": [], "owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "is_accepted": false, "score": 1, "last_activity_date": 1543958649, "last_edit_date": 1543958649, "creation_date": 1543946105, "answer_id": 53618834, "question_id": 53618774, "link": "https://stackoverflow.com/questions/53618774/ruby-on-rails-sql-injection-building-a-query/53618834#53618834", "title": "Ruby on Rails SQL Injection - Building a query", "body": "<p>You need to turn that into a placeholder value (<code>?</code>) and add the data as a separate argument. <a href=\"https://api.rubyonrails.org/classes/ActiveRecord/Querying.html#method-i-find_by_sql\" rel=\"nofollow noreferrer\"><code>find_by_sql</code></a> can take an array:</p>\n\n<pre><code>def get_structure\n   #build query\n   sql = %(SELECT...)\n   query = [ sql ]\n\n   if !params[:code].blank?\n     sql &lt;&lt; \" AND UPPER(pc.code) LIKE ?\"\n     query &lt;&lt; \"%#{params[:code].upcase}%\"\n   end\n\n   str = ProductStructure.find_by_sql(query)\nend\n</code></pre>\n\n<p>Note, use <code>&lt;&lt;</code> on String in preference to <code>+=</code> when you can as it avoids making a copy.</p>\n"}, {"comments": [{"owner": {"reputation": 13442, "user_id": 3982562, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2a3c7aae1d762372cda697833c602ec8?s=128&d=identicon&r=PG", "display_name": "3limin4t0r", "link": "https://stackoverflow.com/users/3982562/3limin4t0r"}, "edited": false, "score": 0, "creation_date": 1543959845, "post_id": 53620102, "comment_id": 94104216, "body": "I have a few questions/comments. 1) Don&#39;t you need to save the <code>query.where(...)</code> result (inside the <i>if</i> statement) back into the <code>query</code> variable? 2) I would instantiate the arel tables by simply calling <code>Model.arel_table</code> and in the case you need the alias <code>Model.arel_table.alias(&#39;name&#39;)</code>. 3) I would use <code>.outer_join(arel_table)</code> over <code>.join(arel_table, Arel::Nodes::OuterJoin)</code>."}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "reply_to_user": {"reputation": 13442, "user_id": 3982562, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2a3c7aae1d762372cda697833c602ec8?s=128&d=identicon&r=PG", "display_name": "3limin4t0r", "link": "https://stackoverflow.com/users/3982562/3limin4t0r"}, "edited": false, "score": 1, "creation_date": 1543961020, "post_id": 53620102, "comment_id": 94104670, "body": "@JohanWentholt 1) No. Arel&#39;s <a href=\"https://www.rubydoc.info/github/rails/arel/Arel/TreeManager#where-instance_method\" rel=\"nofollow noreferrer\">where</a> is mutating. 2) The code provided can be used with or without rails (<code>Arel</code> only) 3) Yes you could do this"}], "tags": [], "owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "is_accepted": true, "score": 4, "last_activity_date": 1543956867, "last_edit_date": 1543956867, "creation_date": 1543951632, "answer_id": 53620102, "question_id": 53618774, "link": "https://stackoverflow.com/questions/53618774/ruby-on-rails-sql-injection-building-a-query/53620102#53620102", "title": "Ruby on Rails SQL Injection - Building a query", "body": "<p>You could use <a href=\"https://www.rubydoc.info/github/rails/arel/Arel\" rel=\"nofollow noreferrer\"><code>Arel</code></a> which will escape for you, and is the underlying query builder for ActiveRecord/Rails. eg. </p>\n\n<pre><code>products = Arel::Table.new(\"products\")\nproducts2 = Arel::Table.new(\"products\", as: 'p')\nimported_structs = Arel::Table.new(\"imported_structures\")\nquery = products.project(\n  products[:id].as('product_id'),\n  products[:code],\n  products[:description], \n  products[:family], \n  products2[:code].as('father_code'),\n  products2[:description].as('father_description'),\n  products2[:family].as('father_family')).\n  join(imported_structs,Arel::Nodes::OuterJoin).\n    on(imported_structs[:product_id].eq(products[:id])).\n  join(products2,Arel::Nodes::OuterJoin).\n    on(products2[:id].eq(imported_structs[:product_father_id])).\n  where(products[:enable].eq(true).and(products2[:enable].eq(true)))\nif !params[:code].blank?\n  query.where(\n     Arel::Nodes::NamedFunction.new('UPPER',[products[:code]])\n       .matches(\"%#{params[:code].to_s.upcase}%\")\n  )\nend\n</code></pre>\n\n<p>SQL result: (with <code>params[:code] = \"' OR 1=1 --test\"</code>)</p>\n\n<pre><code>SELECT \n  [products].[id] AS product_id, \n  [products].[code], \n  [products].[description], \n  [products].[family], \n  [p].[code] AS father_code, \n  [p].[description] AS father_description, \n  [p].[family] AS father_family \nFROM \n  [products] \n  LEFT OUTER JOIN [imported_structures] ON [imported_structures].[product_id] = [products].[id] \n  LEFT OUTER JOIN [products] [p] ON [p].[id] = [imported_structures].[product_father_id] \nWHERE \n  [products].[enable] = true AND \n  [p].[enable] = true  AND \n  UPPER([products].[code]) LIKE N'%'' OR 1=1 --test%'\n</code></pre>\n\n<p>To use </p>\n\n<pre><code>ProductStructure.find_by_sql(query.to_sql)\n</code></pre>\n\n<p>I prefer <code>Arel</code>, when available, over <code>String</code> queries because:</p>\n\n<ul>\n<li>it supports escaping</li>\n<li>it leverages your existing connection adapter for sytnax (so it is portable if you change databases) </li>\n<li>it is built in code so statement order does not matter</li>\n<li>it is far more dynamic and maintainable</li>\n<li>it is natively supported by ActiveRecord</li>\n<li>you can build any complex query you can possibly imagine (including complex joins, CTEs, etc.) </li>\n<li>it is still very readable</li>\n</ul>\n"}], "owner": {"reputation": 59, "user_id": 8678117, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f857cf65ba14b28d1f0a2bcd58aa3d1e?s=128&d=identicon&r=PG&f=1", "display_name": "Victor Policastro", "link": "https://stackoverflow.com/users/8678117/victor-policastro"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 581, "favorite_count": 0, "accepted_answer_id": 53620102, "answer_count": 2, "score": 2, "last_activity_date": 1543958649, "creation_date": 1543945857, "question_id": 53618774, "link": "https://stackoverflow.com/questions/53618774/ruby-on-rails-sql-injection-building-a-query", "title": "Ruby on Rails SQL Injection - Building a query", "body": "<p>I'm resolving all the SQL Injections in a system and I've found something that I don't know how to treat.</p>\n\n<p>Can somebody help me?</p>\n\n<p>Here is my method</p>\n\n<pre><code>def get_structure()\n   #build query\n   sql = %(\n           SELECT pc.id AS \"product_id\", pc.code AS \"code\", pc.description AS \"description\", pc.family AS \"family\", \n                  p.code AS \"father_code\", p.description AS \"father_description\", \n                  p.family AS \"father_family\"\n           FROM products pc\n           LEFT JOIN imported_structures imp ON pc.id = imp.product_id\n           LEFT JOIN products p ON imp.product_father_id = p.id\n           WHERE pc.enable = true AND p.enable = true\n   )\n   #verify if there is any filter\n   if !params[:code].blank?\n     sql = sql + \" AND UPPER(pc.code) LIKE '%#{params[:code].upcase}%'\"\n   end\n   #many other parameters like the one above\n   #execute query\n   str = ProductStructure.find_by_sql(sql)\nend\n</code></pre>\n\n<p>Thank you!</p>\n"}, {"tags": ["ruby", "ruby-on-rails-5", "wkhtmltopdf", "wicked-pdf"], "answers": [{"tags": [], "owner": {"reputation": 11, "user_id": 7443518, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f597754ee05a6e6ab17b277b0e6d4f4c?s=128&d=identicon&r=PG&f=1", "display_name": "jtw", "link": "https://stackoverflow.com/users/7443518/jtw"}, "is_accepted": true, "score": 0, "last_activity_date": 1543967027, "creation_date": 1543967027, "answer_id": 53623060, "question_id": 53617454, "link": "https://stackoverflow.com/questions/53617454/using-wicked-pdf-save-as-pdf-including-user-supplied-data/53623060#53623060", "title": "Using wicked_pdf, save as pdf including user supplied data", "body": "<p>I was sending everything to the correct route, but none of the data was actually being passed. Instead, I needed to wrap everything in a form_tag and use a submit_tag.</p>\n\n<pre><code>&lt;%= form_tag(save_grade_sheet_result_path(@result), method: :post) %&gt;\n  &lt;div&gt;\n    &lt;h2&gt;PERSONNEL INFORMATION&lt;/h2&gt;\n    &lt;p&gt;Examiner's Name: &lt;%= text_field_tag :examiner_name, @examiner_name, class: \"inline\" %&gt;&lt;/p&gt;\n    &lt;p&gt;Exam Version:&lt;%= text_field_tag :exam_version, @exam_version, class: \"inline\" %&gt;&lt;/p&gt;\n  &lt;/div&gt;\n  &lt;%= submit_tag \"Create Grade Sheet\", class: \"btn btn-primary btn-lg\" %&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>And in my controller, I needed to grab the params passed in:</p>\n\n<pre><code>def save_grade_sheet\n  @result = Result.find(params[:id])\n  @examiner_name = params[:examiner_name]\n  @exam_version = params[:exam_version]\n  if current_user.admin?\n    # existing code\n  end\nend\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 7443518, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f597754ee05a6e6ab17b277b0e6d4f4c?s=128&d=identicon&r=PG&f=1", "display_name": "jtw", "link": "https://stackoverflow.com/users/7443518/jtw"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 173, "favorite_count": 0, "accepted_answer_id": 53623060, "answer_count": 1, "score": 0, "last_activity_date": 1543967027, "creation_date": 1543940948, "last_edit_date": 1543941263, "question_id": 53617454, "link": "https://stackoverflow.com/questions/53617454/using-wicked-pdf-save-as-pdf-including-user-supplied-data", "title": "Using wicked_pdf, save as pdf including user supplied data", "body": "<p>I have a template to be filled out by a user. My goal is to convert the template into a pdf (containing information supplied by the user) using wicked_pdf.</p>\n\n<p>Also, none of the user input is hitting the model/database. I simply need to convert the template to a pdf containing the user's data, nothing more.</p>\n\n<p>So far, I can convert the template to a pdf, save it and redirect back to my index view. However, none of the fields filled in by the user are saved; all fields that were containing input or values typed by the user are blank. It's simply saving a blank template. How can I convert a pdf and user supplied data to a pdf using wicked_pdf? </p>\n\n<pre><code># controller save method ---&gt;\ndef save_grade_sheet\n  @result = Result.find(params[:id])\n  if current_user.admin?\n    filename = \"#{@result.user.last_name}_grades.pdf\"      \n    save_path = \"#{Rails.root}/public/uploads/#{@result.user.last_name}/#{filename}\"\n    respond_to do |format|\n      pdf = render_to_string pdf: filename, \n                            template: \"/results/grade_sheet.html.erb\", \n                            encoding: \"UTF-8\", \n                            disposition: \"attachment\", \n                            save_to_file: save_path, \n                            save_only: true\n      File.open(save_path, \"wb\") do |file|\n        file &lt;&lt; pdf\n      end\n      flash[:notice] = \"#{filename} successfully saved\"\n      format.html { redirect_to results_path }\n    end\n  else\n    head :unauthorized\n  end\nend\n\n\n\n# sample template code\n&lt;div&gt;\n  &lt;div&gt;\n    &lt;h2&gt;PERSONNEL INFORMATION&lt;/h2&gt;\n    &lt;p&gt;Examinee's Name: &lt;%= @result.user.first_name %&gt; &lt;%= @result.user.last_name %&gt;&lt;/p&gt;\n    &lt;p&gt;Examiner's Name: &lt;input class=\"inline\" type=\"text\"&gt;&lt;/p&gt;\n  &lt;/div&gt;\n  &lt;div&gt;\n    &lt;p&gt;Exam Type: &lt;%= @result.test.upcase %&gt;&lt;/p&gt;\n    &lt;p&gt;Exam Version: &lt;input class=\"inline\" type=\"text\"&gt;&lt;/p&gt;\n    &lt;p&gt;Exam Date: &lt;%= @result.created_at.strftime(\"%m-%d-%y\") %&gt;&lt;/p&gt;\n  &lt;/div&gt;\n  &lt;%= button_to \"Create Grade Sheet\", save_grade_sheet_result_path(@result), data: { method: :post }, class: \"btn btn-primary btn-lg\"%&gt;\n&lt;/div&gt;\n</code></pre>\n"}, {"tags": ["ruby", "getstream-io"], "comments": [{"owner": {"reputation": 5312, "user_id": 6535997, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/10156345016155058/picture?type=large", "display_name": "Mark", "link": "https://stackoverflow.com/users/6535997/mark"}, "edited": false, "score": 0, "creation_date": 1543940338, "post_id": 53617097, "comment_id": 94095000, "body": "What are reactions? Have you set up a relationship between them and clients? Show us the code for both models please"}, {"owner": {"reputation": 16301, "user_id": 722, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/74I6i.png?s=128&g=1", "display_name": "Tim Sullivan", "link": "https://stackoverflow.com/users/722/tim-sullivan"}, "reply_to_user": {"reputation": 5312, "user_id": 6535997, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/10156345016155058/picture?type=large", "display_name": "Mark", "link": "https://stackoverflow.com/users/6535997/mark"}, "edited": false, "score": 0, "creation_date": 1543941372, "post_id": 53617097, "comment_id": 94095594, "body": "These are not models, they&#39;re GetStream.io items. This isn&#39;t about Rails, it&#39;s about the Stream API library."}, {"owner": {"reputation": 5312, "user_id": 6535997, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/10156345016155058/picture?type=large", "display_name": "Mark", "link": "https://stackoverflow.com/users/6535997/mark"}, "edited": false, "score": 0, "creation_date": 1543942045, "post_id": 53617097, "comment_id": 94095973, "body": "Whoops, my bad!"}, {"owner": {"reputation": 518, "user_id": 8905332, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-qSGD6IOatlQ/AAAAAAAAAAI/AAAAAAAAAOA/lcytjZkeivA/photo.jpg?sz=128", "display_name": "ldeld", "link": "https://stackoverflow.com/users/8905332/ldeld"}, "edited": false, "score": 0, "creation_date": 1543942133, "post_id": 53617097, "comment_id": 94096010, "body": "Stream::Client does not seem to have any method relating to reactions (check <code>client.methods - Object.new.methods</code>)... Maybe you can implement it yourself using <code>make_request</code> ?"}], "owner": {"reputation": 16301, "user_id": 722, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/74I6i.png?s=128&g=1", "display_name": "Tim Sullivan", "link": "https://stackoverflow.com/users/722/tim-sullivan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 76, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1543941427, "creation_date": 1543939935, "last_edit_date": 1543941427, "question_id": 53617097, "link": "https://stackoverflow.com/questions/53617097/accessing-getstream-io-reactions-from-ruby", "title": "Accessing GetStream.io Reactions from Ruby", "body": "<p>There is no documentation on the GetStream.io site for the Ruby client when it comes to reactions, but I tried <code>client.reactions.add('like', activity_id, user_id: user.id)</code> and it says there's no method <code>reactions</code> for Stream::Client.</p>\n\n<p>Help?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "sitemap", "sitemap-generator-gem"], "comments": [{"owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 0, "creation_date": 1543939754, "post_id": 53616651, "comment_id": 94094707, "body": "How do you run the sitemap generator? Do you run it in the correct environment on the server?"}, {"owner": {"reputation": 113, "user_id": 10075876, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-j7d3Chl5TZo/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7obE-kTGcNuqf5tWp6sQ3RBQUo5dA/mo/photo.jpg?sz=128", "display_name": "Sabrina", "link": "https://stackoverflow.com/users/10075876/sabrina"}, "reply_to_user": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 0, "creation_date": 1543950392, "post_id": 53616651, "comment_id": 94099966, "body": "rake sitemap:refresh"}, {"owner": {"reputation": 113, "user_id": 10075876, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-j7d3Chl5TZo/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7obE-kTGcNuqf5tWp6sQ3RBQUo5dA/mo/photo.jpg?sz=128", "display_name": "Sabrina", "link": "https://stackoverflow.com/users/10075876/sabrina"}, "reply_to_user": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 0, "creation_date": 1543950420, "post_id": 53616651, "comment_id": 94099974, "body": "I also did &quot;heroku run rake sitemap:refresh&quot; to run it on the server. Both has the same mistake. Does this answer your question? I am very unexperienced with sitemap"}], "owner": {"reputation": 113, "user_id": 10075876, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-j7d3Chl5TZo/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7obE-kTGcNuqf5tWp6sQ3RBQUo5dA/mo/photo.jpg?sz=128", "display_name": "Sabrina", "link": "https://stackoverflow.com/users/10075876/sabrina"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 148, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1543938480, "creation_date": 1543938480, "question_id": 53616651, "link": "https://stackoverflow.com/questions/53616651/rails-sitemap-generator-show-wrong-index", "title": "Rails sitemap generator show wrong index", "body": "<p>Having a hard time with sitemap_generator.</p>\n\n<p>Finally made it work but now it shows the wrong index of the vacancy pages that I created.</p>\n\n<p>It should include all the vacancies currently online: e.g.\n<a href=\"http://www.frankfurtstartupjobs.com/\" rel=\"nofollow noreferrer\">http://www.frankfurtstartupjobs.com/</a><strong>vacancies/179</strong></p>\n\n<p>But if you take a look what it actually includes in the sitemap file:</p>\n\n<p><a href=\"http://www.frankfurtstartupjobs.com/sitemap.xml.gz\" rel=\"nofollow noreferrer\">http://www.frankfurtstartupjobs.com/sitemap.xml.gz</a></p>\n\n<p>It shows vacancies that do not exist (the index is too high):\ne.g. it shows the vacancy:\n<a href=\"http://www.frankfurtstartupjobs.com/vacancies/\" rel=\"nofollow noreferrer\">http://www.frankfurtstartupjobs.com/vacancies/</a><strong>641</strong></p>\n\n<p>Here is my sitemap.rb file:</p>\n\n<pre><code># Set the host name for URL creation\nrequire 'rubygems'\nrequire 'sitemap_generator'\n\nSitemapGenerator::Sitemap.default_host = \"http://www.frankfurtstartupjobs.com\"\n\nSitemapGenerator::Sitemap.create do\n\n  Vacancy.find_each do |vacancy|\n    add vacancy_path(vacancy), :lastmod =&gt; vacancy.updated_at, :priority =&gt; 0.5\n  end\nend\n</code></pre>\n\n<p>I hope someone can take a look at it and tell me what I miss. Thank you in advance!</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "graphql"], "answers": [{"comments": [{"owner": {"reputation": 1332, "user_id": 4274008, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-wlGv1qIeYZ4/AAAAAAAAAAI/AAAAAAAAAF8/n9h_cnh6BO8/photo.jpg?sz=128", "display_name": "markmoxx", "link": "https://stackoverflow.com/users/4274008/markmoxx"}, "edited": false, "score": 0, "creation_date": 1543935715, "post_id": 53615489, "comment_id": 94092130, "body": "Does it not matter if the exclamation mark comes before or after the type then? Reading this document, all non-nullables are <b>followed</b> by it, not preceeded by it: <a href=\"http://graphql-ruby.org/type_definitions/non_nulls.html\" rel=\"nofollow noreferrer\">GraphQL Ruby - Non-Null Types</a> - whereas in <a href=\"https://www.rubydoc.info/github/rmosolgo/graphql-ruby/GraphQL/Field\" rel=\"nofollow noreferrer\">this documentation</a>, it is used to preceed the type, but without explanation...?"}, {"owner": {"reputation": 21613, "user_id": 580346, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/ba17945a06aac247b06548d5afe341e8?s=128&d=identicon&r=PG", "display_name": "mrzasa", "link": "https://stackoverflow.com/users/580346/mrzasa"}, "reply_to_user": {"reputation": 1332, "user_id": 4274008, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-wlGv1qIeYZ4/AAAAAAAAAAI/AAAAAAAAAF8/n9h_cnh6BO8/photo.jpg?sz=128", "display_name": "markmoxx", "link": "https://stackoverflow.com/users/4274008/markmoxx"}, "edited": false, "score": 1, "creation_date": 1543935868, "post_id": 53615489, "comment_id": 94092224, "body": "In Ruby graphql DSL it goes before the type because it&#39;s used a an overloaded operator then - <code>!(types.String)</code>. It&#39;s mapped to <code>types.String!</code> in graphql schema definition.  It <code>types.String!</code> were uses, it&#39;d be treated as a part of the type name: <code>String!</code>"}, {"owner": {"reputation": 1332, "user_id": 4274008, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-wlGv1qIeYZ4/AAAAAAAAAAI/AAAAAAAAAF8/n9h_cnh6BO8/photo.jpg?sz=128", "display_name": "markmoxx", "link": "https://stackoverflow.com/users/4274008/markmoxx"}, "edited": false, "score": 0, "creation_date": 1543936364, "post_id": 53615489, "comment_id": 94092531, "body": "Great, thanks! With your help, I found <a href=\"https://github.com/rmosolgo/graphql-ruby/blob/master/guides/schema/class_based_api.md\" rel=\"nofollow noreferrer\">this documentation</a> which states that it has now been removed to avoid ambiguity with the built-in logical operator."}, {"owner": {"reputation": 21613, "user_id": 580346, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/ba17945a06aac247b06548d5afe341e8?s=128&d=identicon&r=PG", "display_name": "mrzasa", "link": "https://stackoverflow.com/users/580346/mrzasa"}, "reply_to_user": {"reputation": 1332, "user_id": 4274008, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-wlGv1qIeYZ4/AAAAAAAAAAI/AAAAAAAAAF8/n9h_cnh6BO8/photo.jpg?sz=128", "display_name": "markmoxx", "link": "https://stackoverflow.com/users/4274008/markmoxx"}, "edited": false, "score": 0, "creation_date": 1543936549, "post_id": 53615489, "comment_id": 94092650, "body": "Sure you can! :)"}], "tags": [], "owner": {"reputation": 21613, "user_id": 580346, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/ba17945a06aac247b06548d5afe341e8?s=128&d=identicon&r=PG", "display_name": "mrzasa", "link": "https://stackoverflow.com/users/580346/mrzasa"}, "is_accepted": true, "score": 4, "last_activity_date": 1543934833, "creation_date": 1543934833, "answer_id": 53615489, "question_id": 53615284, "link": "https://stackoverflow.com/questions/53615284/what-is-the-purpose-of-exclamation-marks-in-field-definitions-for-graphql-types/53615489#53615489", "title": "What is the purpose of exclamation marks in field definitions for GraphQL types in Ruby?", "body": "<p>It's a mandatory (non-nullable) field. Implementation of:</p>\n\n<blockquote>\n  <p>String! means that the field is non-nullable, meaning that the GraphQL service promises to always give you a value when you query this field. In the type language, we'll represent those with an exclamation mark.</p>\n</blockquote>\n\n<p><a href=\"https://graphql.org/learn/schema/#object-types-and-fields\" rel=\"nofollow noreferrer\">https://graphql.org/learn/schema/#object-types-and-fields</a></p>\n\n<p>It seems it was replaced by keyword syntax:</p>\n\n<pre><code>field :handle, String, null: false\n</code></pre>\n\n<p><a href=\"http://graphql-ruby.org/type_definitions/objects.html\" rel=\"nofollow noreferrer\">http://graphql-ruby.org/type_definitions/objects.html</a></p>\n"}, {"tags": [], "owner": {"reputation": 41, "user_id": 3854517, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fd2e10369eb68c3fd8b01d3a2a985f0d?s=128&d=identicon&r=PG&f=1", "display_name": "user3854517", "link": "https://stackoverflow.com/users/3854517/user3854517"}, "is_accepted": false, "score": 1, "last_activity_date": 1543951497, "creation_date": 1543951497, "answer_id": 53620075, "question_id": 53615284, "link": "https://stackoverflow.com/questions/53615284/what-is-the-purpose-of-exclamation-marks-in-field-definitions-for-graphql-types/53620075#53620075", "title": "What is the purpose of exclamation marks in field definitions for GraphQL types in Ruby?", "body": "<p>\"!\" mark in GraphQL specifies that field is not nullable. In your example none of the fields id, url, description can be NULL.</p>\n\n<pre><code>field :id, !types.ID\nfield :url, !types.String\nfield :description, !types.String\n</code></pre>\n\n<p>It has slightly different meaning if used in lists. </p>\n\n<p>[Int]! : List can not be NULL. If you pass \"null\" that would be an error while \"[1, 2, null]\" is acceptable. \n[Int!] : Content of list can not be NULL. It will accept \"null\" list but \"[1, 2, null]\" would result in error. </p>\n"}], "owner": {"reputation": 1332, "user_id": 4274008, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-wlGv1qIeYZ4/AAAAAAAAAAI/AAAAAAAAAF8/n9h_cnh6BO8/photo.jpg?sz=128", "display_name": "markmoxx", "link": "https://stackoverflow.com/users/4274008/markmoxx"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 549, "favorite_count": 0, "accepted_answer_id": 53615489, "answer_count": 2, "score": 3, "last_activity_date": 1543951497, "creation_date": 1543934161, "question_id": 53615284, "link": "https://stackoverflow.com/questions/53615284/what-is-the-purpose-of-exclamation-marks-in-field-definitions-for-graphql-types", "title": "What is the purpose of exclamation marks in field definitions for GraphQL types in Ruby?", "body": "<p>I'm following <a href=\"https://www.howtographql.com/graphql-ruby/2-queries/\" rel=\"nofollow noreferrer\">this guide</a> to learn GraphQL with a Ruby backend, and in the section \"Query for Returning Links\", there is the following code:</p>\n\n<pre><code># defines a new GraphQL type\nTypes::LinkType = GraphQL::ObjectType.define do\n  # this type is named `Link`\n  name 'Link'\n\n  # it has the following fields\n  field :id, !types.ID\n  field :url, !types.String\n  field :description, !types.String\nend\n</code></pre>\n\n<p>I know that the exclamation mark is simply a 'not' operator, but can anybody explain its purpose here?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "nested-forms", "ruby-paranoia"], "comments": [{"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 1, "creation_date": 1543937206, "post_id": 53615250, "comment_id": 94093085, "body": "You can use the <code>with_deleted</code> scope to see all the associations however if you nullified the relationship then it won&#39;t matter because the relationship is now completely disconnected."}, {"owner": {"reputation": 53, "user_id": 10726910, "user_type": "registered", "profile_image": "https://graph.facebook.com/10156452787763564/picture?type=large", "display_name": "Raoul Gthr", "link": "https://stackoverflow.com/users/10726910/raoul-gthr"}, "reply_to_user": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1543938515, "post_id": 53615250, "comment_id": 94093899, "body": "Yes indeed your are right :p I am investigating this which goes in the same direction : <a href=\"https://github.com/rubysherpas/paranoia/issues/176\" rel=\"nofollow noreferrer\">github.com/rubysherpas/paranoia/issues/176</a>"}], "answers": [{"tags": [], "owner": {"reputation": 53, "user_id": 10726910, "user_type": "registered", "profile_image": "https://graph.facebook.com/10156452787763564/picture?type=large", "display_name": "Raoul Gthr", "link": "https://stackoverflow.com/users/10726910/raoul-gthr"}, "is_accepted": true, "score": 0, "last_activity_date": 1543943748, "creation_date": 1543943748, "answer_id": 53618277, "question_id": 53615250, "link": "https://stackoverflow.com/questions/53615250/soft-deleted-object-from-parent-model-not-accessible-in-my-child-model/53618277#53618277", "title": "Soft-deleted object from parent model not accessible in my child model", "body": "<p>Ok this issue has been resolved by defining resource as such in the models that was belonging to the Resource model. </p>\n\n<pre><code>  def resource\n    Resource.unscoped {super}\n  end\n</code></pre>\n\n<p>thanks to paranoia I can access my resources from my other models even if they have been deleted from the the Resource model. (No need to nullified the relationship)</p>\n\n<pre><code>Resource.unscoped {super}\n</code></pre>\n\n<p>it actually removes the \"WHERE (\"resources\".\"deleted_at\" NULL)\" you can observed in your consol which is pretty handy.</p>\n"}], "owner": {"reputation": 53, "user_id": 10726910, "user_type": "registered", "profile_image": "https://graph.facebook.com/10156452787763564/picture?type=large", "display_name": "Raoul Gthr", "link": "https://stackoverflow.com/users/10726910/raoul-gthr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 134, "favorite_count": 0, "accepted_answer_id": 53618277, "answer_count": 1, "score": 0, "last_activity_date": 1543943748, "creation_date": 1543934056, "last_edit_date": 1543940496, "question_id": 53615250, "link": "https://stackoverflow.com/questions/53615250/soft-deleted-object-from-parent-model-not-accessible-in-my-child-model", "title": "Soft-deleted object from parent model not accessible in my child model", "body": "<p>My user is allowed do delete some of the resources he has created himself but when he is destroying a resource, there is is problem because I have a model that called resourcequantity that depend on the resource model and I don't want to create a dependent destroy as it will impact the workgroups my user has already created (<em>workgroup is a model containing multiple resources through resource_quantities see below</em>). </p>\n\n<p>What I am trying to do is allowing my user to softly delete its resources while keeping the resource in the database to keep all documents unchanged even if some resources have been destroyed. </p>\n\n<p>I am currently using the paranoia gem and I have tried to implement  dependent: :nullify without big success. When using paranoia gem I got an NoMethodError for nill class as it will only look for the resources where deleted_at is null.</p>\n\n<p>I am a bit lost and don't really where to begin.</p>\n\n<p>Here are my three models</p>\n\n<pre><code>class Resource &lt; ApplicationRecord\nacts_as_paranoid\n\n  has_many :workgroups, through: :resource_quantities\n  has_many :resource_quantities, inverse_of: :resource, dependent: :nullify\n  accepts_nested_attributes_for :resource_quantities, allow_destroy: true\nend\n</code></pre>\n\n<hr>\n\n<pre><code>class ResourceQuantity &lt; ApplicationRecord\n\n  belongs_to :workgroup, optional: true, inverse_of: :resource_quantities\n  belongs_to :resource, optional: true, inverse_of: :resource_quantities\n  accepts_nested_attributes_for :resource, :allow_destroy =&gt; true\n\n  validates :workgroup, uniqueness: { scope: :resource }\nend\n</code></pre>\n\n<hr>\n\n<pre><code> class Workgroup &lt; ApplicationRecord\n     acts_as_paranoid\n\n   has_many :resource_quantities, inverse_of: :workgroup, dependent: :destroy\n   has_many :resources,  through: :resource_quantities, dependent: :nullify\n\n\n   accepts_nested_attributes_for :resource_quantities, allow_destroy: true\n   belongs_to :contractor\n\n   belongs_to :workgroup_library, optional: true\n   validates :name, presence: true\n end\n</code></pre>\n\n<p>Is it possible to do something like this where the resource would be softely deleted ?    </p>\n\n<pre><code>def total_cost_price\n     total_cost_price = 0\n     self.resource_quantities.each do |f|\n       total_cost_price += f.resource.purchase_price\n     end\n     total_cost_price.round(2)\n  end\n</code></pre>\n\n<p>I am not the best in ruby so if you have any advices please feel free to share. Thank you in advance</p>\n"}, {"tags": ["sql", "ruby-on-rails", "ruby"], "answers": [{"tags": [], "owner": {"reputation": 32451, "user_id": 2516474, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a2179a340c0e84edc285d432211145d?s=128&d=identicon&r=PG", "display_name": "SteveTurczyn", "link": "https://stackoverflow.com/users/2516474/steveturczyn"}, "is_accepted": true, "score": 2, "last_activity_date": 1543932485, "creation_date": 1543932485, "answer_id": 53614760, "question_id": 53614466, "link": "https://stackoverflow.com/questions/53614466/insert-query-is-wrong-on-rails/53614760#53614760", "title": "Insert Query is Wrong on Rails", "body": "<p>You don't do</p>\n\n<pre><code>@product = Product.new(params[:product_params])\n</code></pre>\n\n<p>You do</p>\n\n<pre><code>@product = Product.new(product_params)\n</code></pre>\n\n<p>The <code>product_params</code> is a method that returns the white-listed params entries.</p>\n"}, {"tags": [], "owner": {"reputation": 498, "user_id": 10384879, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-5HTxyDEG1Qo/AAAAAAAAAAI/AAAAAAAAAeQ/9iMyCvOw2A4/photo.jpg?sz=128", "display_name": "giri dharan", "link": "https://stackoverflow.com/users/10384879/giri-dharan"}, "is_accepted": false, "score": 0, "last_activity_date": 1543955045, "creation_date": 1543955045, "answer_id": 53620851, "question_id": 53614466, "link": "https://stackoverflow.com/questions/53614466/insert-query-is-wrong-on-rails/53620851#53620851", "title": "Insert Query is Wrong on Rails", "body": "<p>def create\n @product = Product.new(product_params) @product.save \nredirect_to @product \nend \nprivate \ndef product_params params.require(:product).permit(:title, :price)\n end</p>\n"}], "owner": {"reputation": 13, "user_id": 9311675, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b9f28b3298fc776af1919e849c84091?s=128&d=identicon&r=PG&f=1", "display_name": "John Doe", "link": "https://stackoverflow.com/users/9311675/john-doe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 70, "favorite_count": 0, "accepted_answer_id": 53614760, "answer_count": 2, "score": 1, "last_activity_date": 1543955045, "creation_date": 1543931495, "question_id": 53614466, "link": "https://stackoverflow.com/questions/53614466/insert-query-is-wrong-on-rails", "title": "Insert Query is Wrong on Rails", "body": "<p>So i am trying to learn Ruby on Rails and i tried to code simple product creation to database but rails only executes the insert query with only created_at and updated_at values. Here is my products_controller's create action ;</p>\n\n<pre><code>def create\n    @product = Product.new(params[:product_params])\n\n    @product.save\n    redirect_to @product\nend\n\nprivate \n    def product_params\n        params.require(:product).permit(:title, :price)\n    end\n</code></pre>\n\n<p>Here is my new.html.erb under products folder ;</p>\n\n<pre><code>&lt;%= form_with scope: :product ,url:products_path, local: true do |form| %&gt;\n&lt;p&gt;\n &lt;%= form.text_field :title %&gt;\n&lt;/p&gt;\n\n&lt;p&gt;\n  &lt;%= form.text_field :price %&gt;\n&lt;/p&gt;\n\n&lt;p&gt;\n&lt;%= form.submit %&gt;\n</code></pre>\n\n<p></p>\n    &lt;% end %></p>\n\n<p>And this is the SQL query executed by Rails looking to Rails Server</p>\n\n<blockquote>\n  <p>Started POST \"/products\" for 127.0.0.1 at 2018-12-04 16:44:52 +0300\n  Processing by ProductsController#create as HTML\n    Parameters: {\"utf8\"=>\"\u2713\", \"authenticity_token\"=>\"9Z4aFNpMv+uUPXx+LkHoOtYpWae/8tIOCQ3Jt47AFScp/vVHTWI+G4d6CjHqBz6t5L5UR57I7Gh7bUWog1Dqow==\", \"product\"=>{\"title\"=>\"brokoli\", \"price\"=>\"3434\"}, \"commit\"=>\"Save Product\"}\n     (0.2ms)  BEGIN\n    \u21b3 app/controllers/products_controller.rb:8\n    Product Create (0.3ms)  INSERT INTO <code>products</code> (<code>created_at</code>, <code>updated_at</code>) VALUES ('2018-12-04 13:44:52', '2018-12-04 13:44:52')\n    \u21b3 app/controllers/products_controller.rb:8\n     (5.4ms)  COMMIT\n    \u21b3 app/controllers/products_controller.rb:8\n  Redirected to <a href=\"http://localhost:3000/products/12\" rel=\"nofollow noreferrer\">http://localhost:3000/products/12</a>\n  Completed 302 Found in 25ms (ActiveRecord: 7.4ms)</p>\n</blockquote>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 6039, "user_id": 2137458, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8cfca832ee746f3e3d9971148f52dc64?s=128&d=identicon&r=PG", "display_name": "NM Pennypacker", "link": "https://stackoverflow.com/users/2137458/nm-pennypacker"}, "edited": false, "score": 3, "creation_date": 1543931730, "post_id": 53614465, "comment_id": 94089670, "body": "Taking the time to read this will save you lots of time and frustration. <a href=\"https://guides.rubyonrails.org/association_basics.html\" rel=\"nofollow noreferrer\">guides.rubyonrails.org/association_basics.html</a>"}, {"owner": {"reputation": 85, "user_id": 2127466, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/51deda4853df6f584aa06d9b726db9a8?s=128&d=identicon&r=PG", "display_name": "Cigol", "link": "https://stackoverflow.com/users/2127466/cigol"}, "reply_to_user": {"reputation": 6039, "user_id": 2137458, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8cfca832ee746f3e3d9971148f52dc64?s=128&d=identicon&r=PG", "display_name": "NM Pennypacker", "link": "https://stackoverflow.com/users/2137458/nm-pennypacker"}, "edited": false, "score": 0, "creation_date": 1543931972, "post_id": 53614465, "comment_id": 94089836, "body": "I appreciate that, but when you&#39;re already frustrated and scratching your head a nudge in the right direction can be a hell of a thing."}, {"owner": {"reputation": 5312, "user_id": 6535997, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/10156345016155058/picture?type=large", "display_name": "Mark", "link": "https://stackoverflow.com/users/6535997/mark"}, "edited": false, "score": 1, "creation_date": 1543932074, "post_id": 53614465, "comment_id": 94089906, "body": "It can be a bit daunting but reading through that really does help :P"}, {"owner": {"reputation": 85, "user_id": 2127466, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/51deda4853df6f584aa06d9b726db9a8?s=128&d=identicon&r=PG", "display_name": "Cigol", "link": "https://stackoverflow.com/users/2127466/cigol"}, "edited": false, "score": 0, "creation_date": 1544102846, "post_id": 53614465, "comment_id": 94163118, "body": "I&#39;ve come to the conclusion I need to use a has_many through association based on that guide. Is there any good tutorials that go into this a bit deeper as that&#39;s only surface level overview. I&#39;m able to add parts with a quantity column, and I can return the parts back from a manifest using @product.parts."}], "answers": [{"comments": [{"owner": {"reputation": 85, "user_id": 2127466, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/51deda4853df6f584aa06d9b726db9a8?s=128&d=identicon&r=PG", "display_name": "Cigol", "link": "https://stackoverflow.com/users/2127466/cigol"}, "edited": false, "score": 0, "creation_date": 1544102479, "post_id": 53614661, "comment_id": 94162881, "body": "This doesn&#39;t really answer my question unfortunately."}, {"owner": {"reputation": 5312, "user_id": 6535997, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/10156345016155058/picture?type=large", "display_name": "Mark", "link": "https://stackoverflow.com/users/6535997/mark"}, "reply_to_user": {"reputation": 85, "user_id": 2127466, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/51deda4853df6f584aa06d9b726db9a8?s=128&d=identicon&r=PG", "display_name": "Cigol", "link": "https://stackoverflow.com/users/2127466/cigol"}, "edited": false, "score": 1, "creation_date": 1544106129, "post_id": 53614661, "comment_id": 94165264, "body": "Sorry, which part didn&#39;t I answer?"}, {"owner": {"reputation": 5312, "user_id": 6535997, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/10156345016155058/picture?type=large", "display_name": "Mark", "link": "https://stackoverflow.com/users/6535997/mark"}, "reply_to_user": {"reputation": 85, "user_id": 2127466, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/51deda4853df6f584aa06d9b726db9a8?s=128&d=identicon&r=PG", "display_name": "Cigol", "link": "https://stackoverflow.com/users/2127466/cigol"}, "edited": false, "score": 1, "creation_date": 1544106166, "post_id": 53614661, "comment_id": 94165285, "body": "If you have 5 parts and want to assign them to the same product (which has an ID of say 4), then simply assign all 5 parts a &#39;product_id&#39; attribute of 5"}, {"owner": {"reputation": 85, "user_id": 2127466, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/51deda4853df6f584aa06d9b726db9a8?s=128&d=identicon&r=PG", "display_name": "Cigol", "link": "https://stackoverflow.com/users/2127466/cigol"}, "edited": false, "score": 0, "creation_date": 1544108088, "post_id": 53614661, "comment_id": 94166593, "body": "So, to clarify; the distinction between a product and a part isn&#39;t clear. You could sell a car part for example (an engine Part) on its own or as part of an assembly (Product) say. If I understand your suggestion correctly this can&#39;t take that into account or am I wrong? Apologies if I am."}, {"owner": {"reputation": 5312, "user_id": 6535997, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/10156345016155058/picture?type=large", "display_name": "Mark", "link": "https://stackoverflow.com/users/6535997/mark"}, "reply_to_user": {"reputation": 85, "user_id": 2127466, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/51deda4853df6f584aa06d9b726db9a8?s=128&d=identicon&r=PG", "display_name": "Cigol", "link": "https://stackoverflow.com/users/2127466/cigol"}, "edited": false, "score": 1, "creation_date": 1544108223, "post_id": 53614661, "comment_id": 94166695, "body": "A part has a product ID and a product doesn&#39;t. A part is assigned to a product (which product it belongs to) through the product_id it is assigned. I&#39;m not sure what you&#39;re trying to do that you&#39;re stuck with"}, {"owner": {"reputation": 85, "user_id": 2127466, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/51deda4853df6f584aa06d9b726db9a8?s=128&d=identicon&r=PG", "display_name": "Cigol", "link": "https://stackoverflow.com/users/2127466/cigol"}, "edited": false, "score": 0, "creation_date": 1544109320, "post_id": 53614661, "comment_id": 94167364, "body": "I&#39;m going to give this a go later tonight, my issue looking at it though is that if I wanted to assign parts I&#39;ve assigned to one car, I&#39;d have to keep recreating new copies of said parts. My idea was to have an inventory of parts that I could assign to products and the quantities of, as a way of determining stock/inventory etc needed. Appreciate the clarification though."}], "tags": [], "owner": {"reputation": 5312, "user_id": 6535997, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/10156345016155058/picture?type=large", "display_name": "Mark", "link": "https://stackoverflow.com/users/6535997/mark"}, "is_accepted": false, "score": 2, "last_activity_date": 1544108322, "last_edit_date": 1544108322, "creation_date": 1543932157, "answer_id": 53614661, "question_id": 53614465, "link": "https://stackoverflow.com/questions/53614465/rails-product-model-containing-one-or-more-part-item-model-references/53614661#53614661", "title": "Rails, Product model containing one or more Part item model references", "body": "<p>In your case, a car has many parts and a part belongs to one car. This can be setup as follows:</p>\n\n<pre><code>class Car &lt; ApplicationRecord\n  has_many :parts\nend\n\nclass Part &lt; ApplicationRecord\n  belongs_to :car\nend\n</code></pre>\n\n<p>This assumes that the Part model has a column called car_id, which is used to specify which car the part belongs to. You'll then be able to do:</p>\n\n<pre><code>car.parts\npart.car\n</code></pre>\n\n<p>EDIT:</p>\n\n<p>Say we have 5 parts:</p>\n\n<pre><code>part1 = Part.find(1)\npart2 = Part.find(2)\npart3 = Part.find(3)\npart4 = Part.find(4)\npart5 = Part.find(5)\n</code></pre>\n\n<p>And one product:</p>\n\n<pre><code>product1 = Product.find(1)\n</code></pre>\n\n<p>If I want to assign the parts to belong to the product, I would do:</p>\n\n<pre><code>part1.product_id = product1.id\npart1.save\n</code></pre>\n\n<p>I can do that to all 5 parts, which will assign them all to the parent product.</p>\n\n<p>If you want to see which parts belong to the product, you can do:</p>\n\n<pre><code>product1.parts\n</code></pre>\n\n<p>which will return</p>\n\n<pre><code>[part1, part2, part3, part4, part5]\n</code></pre>\n\n<p>As well as </p>\n\n<pre><code>part1.product\n</code></pre>\n\n<p>Which will return product1</p>\n"}, {"tags": [], "owner": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "is_accepted": true, "score": 1, "last_activity_date": 1544110789, "last_edit_date": 1544110789, "creation_date": 1544110007, "answer_id": 53654606, "question_id": 53614465, "link": "https://stackoverflow.com/questions/53614465/rails-product-model-containing-one-or-more-part-item-model-references/53654606#53654606", "title": "Rails, Product model containing one or more Part item model references", "body": "<p>To create a many to many assocation between Product and Part you need a join table:</p>\n\n<pre><code>class Product &lt; ApplicationRecord\n  has_many :product_parts\n  has_many :parts, through: :product_parts\nend\n\nclass Part &lt; ApplicationRecord\n  has_many :product_parts\n  has_many :products, through: :product_parts\nend\n\nclass ProductPart &lt; ApplicationRecord\n  belongs_to :product\n  belongs_to :part\nend\n</code></pre>\n\n<p>Here <code>product_parts</code> serves as the join table. You could for example attach four wheels to a car by:</p>\n\n<pre><code>car = Product.create(name: 'Car')\nwheel = Part.create(name: 'Wheel')\n4.times { car.parts &lt;&lt; wheel }\ncar.parts.count # =&gt; 4\ncar.parts\n# =&gt; #&lt;ActiveRecord::Associations::CollectionProxy [#&lt;Part id: 1, name: \"Wheel\", created_at: \"2018-12-06 15:12:18\", updated_at: \"2018-12-06 15:12:18\"&gt;, #&lt;Part id: 1, name: \"Wheel\", created_at: \"2018-12-06 15:12:18\", updated_at: \"2018-12-06 15:12:18\"&gt;, #&lt;Part id: 1, name: \"Wheel\", created_at: \"2018-12-06 15:12:18\", updated_at: \"2018-12-06 15:12:18\"&gt;, #&lt;Part id: 1, name: \"Wheel\", created_at: \"2018-12-06 15:12:18\", updated_at: \"2018-12-06 15:12:18\"&gt;]&gt;\n</code></pre>\n\n<p>This would create 4 rows in the <code>product_parts</code> table. Another way to solve this would be by adding a quantity column to the <code>product_parts</code> table.</p>\n\n<pre><code>car.product_parts.create(part: wheel, quantity: 4)\n</code></pre>\n\n<p>Adding \"metadata\" to the join model is only possible when its created explicitly. Note that this won't actually alter the count and length of the association like in the previous example. </p>\n\n<pre><code>car.parts.count # =&gt; 1 \ncar.parts\n# =&gt; #&lt;ActiveRecord::Associations::CollectionProxy [#&lt;Part id: 1, name: \"Wheel\", created_at: \"2018-12-06 15:12:18\", updated_at: \"2018-12-06 15:12:18\"&gt;]&gt;\n</code></pre>\n\n<p>Rather you have to use the join table records to get the quantity:</p>\n\n<pre><code>&lt;table&gt;\n  &lt;thead&gt;\n    &lt;tr&gt;\n      &lt;th&gt;Name&lt;/th&gt;\n      &lt;th&gt;Quantity&lt;/th&gt;\n    &lt;/tr&gt;\n  &lt;/thead&gt;\n  &lt;tbody&gt;\n    &lt;% @product.product_parts.each do |pp| %&gt;\n    &lt;tr&gt;\n      &lt;td&gt;&lt;%= pp.part.name %&gt;&lt;/td&gt;\n      &lt;td&gt;&lt;%= pp.quanty %&gt;&lt;/td&gt;\n    &lt;/tr&gt;\n    &lt;% end %&gt;\n  &lt;/tbody&gt;\n&lt;/table&gt;\n</code></pre>\n"}], "owner": {"reputation": 85, "user_id": 2127466, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/51deda4853df6f584aa06d9b726db9a8?s=128&d=identicon&r=PG", "display_name": "Cigol", "link": "https://stackoverflow.com/users/2127466/cigol"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 86, "favorite_count": 0, "accepted_answer_id": 53654606, "answer_count": 2, "score": 0, "last_activity_date": 1544110789, "creation_date": 1543931493, "question_id": 53614465, "link": "https://stackoverflow.com/questions/53614465/rails-product-model-containing-one-or-more-part-item-model-references", "title": "Rails, Product model containing one or more Part item model references", "body": "<p>Concerning a Product model that houses multiple Part items;</p>\n\n<p>...for example;</p>\n\n<pre><code>Product (Car)\n Part (Engine) x1\n part (Wheel) x4\n part (Chassis) x1\n</code></pre>\n\n<hr>\n\n<p>I'm trying to wrap my head around setting this up and some help would be appreciated. In my Product model I'm assuming I set up an: </p>\n\n<pre><code>has_many :parts\n</code></pre>\n\n<p>When I do this though I can only assign one part to each product and I can't specify a numerical value? How would you approach this problem?</p>\n"}, {"tags": ["mysql", "ruby", "sequel"], "comments": [{"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1544041605, "post_id": 53614431, "comment_id": 94139864, "body": "Maybe try <code>MyModel.db.dataset.call_sproc(:select, &#39;get_info&#39;, &#39;arg&#39;)</code>? <a href=\"https://github.com/jeremyevans/sequel/blob/master/lib/sequel/adapters/utils/stored_procedures.rb\" rel=\"nofollow noreferrer\">Sequel::Dataset::StoredProcedures</a>"}], "answers": [{"tags": [], "owner": {"reputation": 2159, "user_id": 4898937, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/iwgDT.jpg?s=128&g=1", "display_name": "ciaoben", "link": "https://stackoverflow.com/users/4898937/ciaoben"}, "is_accepted": true, "score": 0, "last_activity_date": 1544082718, "creation_date": 1544082718, "answer_id": 53646841, "question_id": 53614431, "link": "https://stackoverflow.com/questions/53614431/how-to-use-stored-procedures-with-sequel/53646841#53646841", "title": "How to use stored procedures with Sequel", "body": "<p>With the help of the creator of <code>Sequel</code> gem I come up with a solution, it appears that Sequel does not support this kind of return set, so the mysql2 driver must be used:</p>\n\n<pre><code>res = nil\nDomain.db.synchronize do |conn|\n  res = conn.query(\"CALL sp_panel_info('#{self.code}')\")\n\n  while conn.next_result\n    conn.store_result\n  end\nend\nrow = res.first\n</code></pre>\n\n<p>In this case I know for sure that my procedure will return one row so I only get the first one.</p>\n"}], "owner": {"reputation": 2159, "user_id": 4898937, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/iwgDT.jpg?s=128&g=1", "display_name": "ciaoben", "link": "https://stackoverflow.com/users/4898937/ciaoben"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 261, "favorite_count": 0, "accepted_answer_id": 53646841, "answer_count": 1, "score": 0, "last_activity_date": 1544082718, "creation_date": 1543931416, "last_edit_date": 1543945387, "question_id": 53614431, "link": "https://stackoverflow.com/questions/53614431/how-to-use-stored-procedures-with-sequel", "title": "How to use stored procedures with Sequel", "body": "<p>I am trying to use a store procedure from ruby, with Sequel gem; but it continues to throw me a Mysql2::Error: Commands out of sync; you can't run this command now\nafter running a stored procedure, can't find anything about multi statements query on the docs:</p>\n\n<pre><code>MyModel.db['CALL get_info(\"arg\")').first\n# =&gt; {col: val, col2: val}\nMyModel.db['CALL get_info(\"arg\")').first\n# =&gt; Sequel::DatabaseDisconnectError: Mysql2::Error: Commands out of sync; you can't run this command now\nfrom /usr/local/lib/ruby/gems/2.3.0/gems/mysql2-0.4.5/lib/mysql2/client.rb:120:in `_query'\n</code></pre>\n"}, {"tags": ["ruby", "google-sheets-api"], "answers": [{"comments": [{"owner": {"reputation": 10377, "user_id": 2832282, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/ZJ4WG.jpg?s=128&g=1", "display_name": "Cyril Duchon-Doris", "link": "https://stackoverflow.com/users/2832282/cyril-duchon-doris"}, "edited": false, "score": 0, "creation_date": 1544001541, "post_id": 53623000, "comment_id": 94117247, "body": "From what I understand, append will look for empty rows before adding, but since I am using a template, there may be already some data in there (eg columns with formulas, or sample data...) I will try to see if I can keep the &quot;source sheets&quot; clean and it is easy to append. Otherwise, propably a better solution would involve cleaning the template before and append all the data including the headers ?  (The template is useful because there are other sheets that will format the raw data entered by my backend)"}, {"owner": {"reputation": 100534, "user_id": 7108653, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LH2EI.png?s=128&g=1", "display_name": "Tanaike", "link": "https://stackoverflow.com/users/7108653/tanaike"}, "reply_to_user": {"reputation": 10377, "user_id": 2832282, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/ZJ4WG.jpg?s=128&g=1", "display_name": "Cyril Duchon-Doris", "link": "https://stackoverflow.com/users/2832282/cyril-duchon-doris"}, "edited": false, "score": 0, "creation_date": 1544048093, "post_id": 53623000, "comment_id": 94142599, "body": "@Cyril Duchon-Doris I&#39;m sorry for the inconvenience. At first, in order to understand correctly, I would like to confirm about your situation. In your question, at first, the sheet has 1000 rows and the columns from &quot;A&quot; to &quot;Z&quot;. For this sheet, when you added a column to &quot;AA&quot; using values.update, such error occurs. You want to add the column without the error. I could understand like this. If I misunderstand your situation, please tell me. I would like to modify it."}, {"owner": {"reputation": 10377, "user_id": 2832282, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/ZJ4WG.jpg?s=128&g=1", "display_name": "Cyril Duchon-Doris", "link": "https://stackoverflow.com/users/2832282/cyril-duchon-doris"}, "edited": false, "score": 0, "creation_date": 1544089381, "post_id": 53623000, "comment_id": 94155273, "body": "Sorry, my original post lacked explanation/a clear example. My problem lies in the number of columns rather than the number of lines. I&#39;m trying to replace much fewer than 1k lines, but more than 26 columns in one go, and the 26 column limit is the one causing the crash. When I open the google spreadsheet template, I see that I have added more than columns already, so the problem seems to really come from the update_spreadsheet_value method, which I need to use since I may need to replace existing data. But I will add a clear example in my post"}, {"owner": {"reputation": 100534, "user_id": 7108653, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LH2EI.png?s=128&g=1", "display_name": "Tanaike", "link": "https://stackoverflow.com/users/7108653/tanaike"}, "reply_to_user": {"reputation": 10377, "user_id": 2832282, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/ZJ4WG.jpg?s=128&g=1", "display_name": "Cyril Duchon-Doris", "link": "https://stackoverflow.com/users/2832282/cyril-duchon-doris"}, "edited": false, "score": 0, "creation_date": 1544134514, "post_id": 53623000, "comment_id": 94179246, "body": "@Cyril Duchon-Doris Thank you for replying. Can I ask you about your situation? 1. Do you want to copy the template sheet to a sheet in new spreadsheet? 2. What is the difference of &quot;(1)&quot; and &quot;(2)&quot;? What is &quot;for the first time&quot;? Unfortunately, I couldn&#39;t see the vision of what you want to do from your additional information yet. I think that this reason is due to my poor English skill. I&#39;m really sorry for this. So can you provide the input and output samples you want? By this, I would like to see the vision you want, and resolve your issue. If you cooperate to resolve the issue, I&#39;m glad."}, {"owner": {"reputation": 10377, "user_id": 2832282, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/ZJ4WG.jpg?s=128&g=1", "display_name": "Cyril Duchon-Doris", "link": "https://stackoverflow.com/users/2832282/cyril-duchon-doris"}, "edited": false, "score": 0, "creation_date": 1544139695, "post_id": 53623000, "comment_id": 94180960, "body": "Yeah it is also quite confusing, as there is little difference between &quot;spreadsheet&quot; (the file with ALL the tabs) and a &quot;sheet&quot; (a tab in the whole file). Basically by &quot;or the first time&quot;, I mean that I am actually calling <code>service.update_spreadsheet_value</code> multiple times in my app to fill all the spreadsheet; but then I am calling my app several times, so as to update the same values in the same cells. I will add an concrete example"}, {"owner": {"reputation": 100534, "user_id": 7108653, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LH2EI.png?s=128&g=1", "display_name": "Tanaike", "link": "https://stackoverflow.com/users/7108653/tanaike"}, "reply_to_user": {"reputation": 10377, "user_id": 2832282, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/ZJ4WG.jpg?s=128&g=1", "display_name": "Cyril Duchon-Doris", "link": "https://stackoverflow.com/users/2832282/cyril-duchon-doris"}, "edited": false, "score": 0, "creation_date": 1544140297, "post_id": 53623000, "comment_id": 94181108, "body": "@Cyril Duchon-Doris In your situation, you want to overwrite the values of template sheet to the existing cells in a sheet, and the values for overwriting include the outer columns of the existing sheet. Is my understanding correct? By the way, in order to think of the concrete solution of  your situation, can you provide the sample spreadsheet?"}, {"owner": {"reputation": 100534, "user_id": 7108653, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LH2EI.png?s=128&g=1", "display_name": "Tanaike", "link": "https://stackoverflow.com/users/7108653/tanaike"}, "reply_to_user": {"reputation": 10377, "user_id": 2832282, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/ZJ4WG.jpg?s=128&g=1", "display_name": "Cyril Duchon-Doris", "link": "https://stackoverflow.com/users/2832282/cyril-duchon-doris"}, "edited": false, "score": 0, "creation_date": 1544141536, "post_id": 53623000, "comment_id": 94181402, "body": "@Cyril Duchon-Doris 1st sample of Edit2 means 2 sheets of a template spreadsheet. 2nd one means new spreadsheet that the 2 sheets of template are copied. 3rd one means the 2 template sheets are updated. Is my understanding correct? What means is 4th one? And can I ask you about your issue from these situations?"}], "tags": [], "owner": {"reputation": 100534, "user_id": 7108653, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LH2EI.png?s=128&g=1", "display_name": "Tanaike", "link": "https://stackoverflow.com/users/7108653/tanaike"}, "is_accepted": false, "score": 6, "last_activity_date": 1543966502, "creation_date": 1543966502, "answer_id": 53623000, "question_id": 53614276, "link": "https://stackoverflow.com/questions/53614276/google-spreadsheet-api-returning-grid-limits-error/53623000#53623000", "title": "Google Spreadsheet API returning grid limits error", "body": "<p>How about using values.append? In my environment, I also experienced the same situation with you. In order to avoid this issue, I used values.append.</p>\n\n<p>Please modify as follows and try it again.</p>\n\n<h3>From:</h3>\n\n<pre><code>service.update_spreadsheet_value(\n</code></pre>\n\n<h3>To:</h3>\n\n<pre><code>service.append_spreadsheet_value(\n</code></pre>\n\n<h3>Reference:</h3>\n\n<ul>\n<li><a href=\"https://developers.google.com/sheets/api/reference/rest/v4/spreadsheets.values/append\" rel=\"noreferrer\">Method: spreadsheets.values.append</a></li>\n</ul>\n\n<p>If this was not the result you want, I'm sorry.</p>\n"}, {"tags": [], "owner": {"reputation": 46, "user_id": 12128398, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mB_4wpYF6HNlH2rs2Ac134ieE8WyuepB9Vd9K4J=k-s128", "display_name": "\u90b9\u6d2a\u5b66", "link": "https://stackoverflow.com/users/12128398/%e9%82%b9%e6%b4%aa%e5%ad%a6"}, "is_accepted": true, "score": 3, "last_activity_date": 1569554512, "creation_date": 1569554512, "answer_id": 58127398, "question_id": 53614276, "link": "https://stackoverflow.com/questions/53614276/google-spreadsheet-api-returning-grid-limits-error/58127398#58127398", "title": "Google Spreadsheet API returning grid limits error", "body": "<p>this because out of range.</p>\n\n<p>AA1 means column is AA, also means 27, so this start point AA1 not exist, that's why you met this error.</p>\n\n<p>you can try Z1, this should be ok.</p>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 15041852, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/3651a5f056bf782655f6b1b58469432e?s=128&d=identicon&r=PG", "display_name": "Andrea", "link": "https://stackoverflow.com/users/15041852/andrea"}, "is_accepted": false, "score": 1, "last_activity_date": 1611117635, "creation_date": 1611117635, "answer_id": 65803184, "question_id": 53614276, "link": "https://stackoverflow.com/questions/53614276/google-spreadsheet-api-returning-grid-limits-error/65803184#65803184", "title": "Google Spreadsheet API returning grid limits error", "body": "<p>It happened to me as well when I didn't have the empty columns (I removed all the empty columns from the spreadsheet). I simply added an empty one next to my last column and it works.</p>\n"}], "owner": {"reputation": 10377, "user_id": 2832282, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/ZJ4WG.jpg?s=128&g=1", "display_name": "Cyril Duchon-Doris", "link": "https://stackoverflow.com/users/2832282/cyril-duchon-doris"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2695, "favorite_count": 0, "accepted_answer_id": 58127398, "answer_count": 3, "score": 1, "last_activity_date": 1611117635, "creation_date": 1543930938, "last_edit_date": 1544140203, "question_id": 53614276, "link": "https://stackoverflow.com/questions/53614276/google-spreadsheet-api-returning-grid-limits-error", "title": "Google Spreadsheet API returning grid limits error", "body": "<p>I am trying to update a Google Sheet using the Ruby API (that is just a wrapper around the SheetsV4 API)</p>\n\n<p>I am running into the following error</p>\n\n<blockquote>\n  <p>Google::Apis::ClientError: badRequest: Range ('MySheet'!AA1) exceeds grid limits. Max rows: 1000, max columns: 26</p>\n</blockquote>\n\n<p>I have found references of this problem <a href=\"https://groups.google.com/forum/#!topic/google-spreadsheets-api/7fbHUmY3Tt4\" rel=\"nofollow noreferrer\">on the google forum</a>, however there did not seem to be a solution to the problem other that to use a different method to write to the spreadsheet.</p>\n\n<p>The thing is, I need to copy an existing spreadsheet template, and enter my raw data in various sheets. So far I have been using this code (where <code>service</code> is a client of the Ruby SheetsV4 API)</p>\n\n<pre><code>def write_table(values, sheet: 'Sheet1', column: 1, row: 1, range: nil, value_input_option: 'RAW')\n  google_range = begin\n    if range\n      \"#{sheet}!#{range}\"\n    elsif column &amp;&amp; row\n      \"#{sheet}!#{integer_to_A1_notation(column)}#{row}\"\n    end\n  end\n  value_range_object = ::Google::Apis::SheetsV4::ValueRange.new(\n    range: google_range, values: values\n  )\n  service.update_spreadsheet_value(spreadsheet_id,\n    google_range,\n    value_range_object,\n    value_input_option: value_input_option\n  )\nend\n</code></pre>\n\n<p>It was working quite well so far, but after adding more data to my extracts, I went over the 26th column, (columns <code>AA</code> onwards) and now I am getting the error.</p>\n\n<p>Is there some option to pass to <code>update_spreadsheet_value</code> so we can raise this limit ?</p>\n\n<p>Otherwise, what is the other way to write to the spreadsheet using append ?</p>\n\n<p>EDIT - A clear description of my scenario</p>\n\n<p>I have a template Google spreadsheet with 8 sheets(tabs), 4 of which are titled <code>RAW-XX</code> and this is where I try to update my data.</p>\n\n<p>At the beginning, those raw tabs only have headers on 30 columns (A1 --> AD1)\nMy code needs to be able to fill all the cells A2 --> AD42</p>\n\n<ul>\n<li>(1) for the first time</li>\n<li>(2) and my code needs to be able to re-run again to replace those values by fresh ones, without appending</li>\n</ul>\n\n<p>So basically I was thinking of using <code>update_spreadsheet_value</code> rather than <code>append_xx</code> because of the requirement (2). But becuase of this bug/limitation (unclear) in the API, this does not work. ALso important to note : I am not actually updating all those 30 columns in one go, but actually in several calls to the <code>update</code> method (with up to 10 columns each time)</p>\n\n<p>I've thought that\n- Maybe I am missing an option to send to the Google API to allow more than 26 columns in one go ?\n- Maybe this is actually an undocumented hard limitation of the <code>update</code> API\n- Maybe I can resort to deleting existing data + using append</p>\n\n<p>EDIT 2</p>\n\n<p>Suppose I have a template at version 1 with multiple sheets (Note that I am using <code>=xx</code> to indicate a formula, and <code>[empty]</code> to indicate there is nothing in the cell, and <code>1</code> to indicate the raw value \"1\" was supplied</p>\n\n<pre><code>Sheet1 - RAW\nRAW Number of foos | RAW Number of Bars |\n[empty]            | [empty]            |\n\nSheet2 - FORMATTED\nNumber of foos       | Number of Bars\n='Sheet1 - RAW'!A2   | ='Sheet1 - RAW'B2\n</code></pre>\n\n<p>Now I call my app \"for the first time\", this copies the existing template to a new file \"generated_spreadsheet\" and injects data in the RAW sheet. It turns out at this moment, my app says there is 1 foo and 0 bar</p>\n\n<pre><code>Sheet1 - RAW\nRAW Number of foos | RAW Number of Bars |\n1                  | 0                  |\n\nSheet2 - FORMATTED\nNumber of foos       | Number of Bars\n='Sheet1 - RAW'!A2   | ='Sheet1 - RAW'!B2\n</code></pre>\n\n<p>Maybe if I call my app later, maybe the template AND the data have changed in between, so I want to REPLACE everything in my \"generated_spreadsheet\"</p>\n\n<p>The new template has become in between</p>\n\n<pre><code>Sheet1 - RAW\nRAW Number of foos | RAW Number of Bars |\n[empty]            | [empty]            |\n\nSheet2 - FORMATTED\nNumber of foos       | Number of Bars     | All items\n='Sheet1 - RAW'!A2   | ='Sheet1 - RAW'!B2 | =A2 + B2\n</code></pre>\n\n<p>Suppose now my app says there is still 1 foo and the number of bars went from 0 to 2, I want to update the \"generated_spreadsheet\" so it looks like</p>\n\n<pre><code>Sheet1 - RAW\nRAW Number of foos | RAW Number of Bars |\n1                  | 3                  |\n\nSheet2 - FORMATTED\nNumber of foos       | Number of Bars     | All items\n='Sheet1 - RAW'!A2   | ='Sheet1 - RAW'!B2 | =A2 + B2\n</code></pre>\n"}, {"tags": ["ruby", "hash"], "comments": [{"owner": {"reputation": 5060, "user_id": 10522579, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7GQ6a.jpg?s=128&g=1", "display_name": "ray", "link": "https://stackoverflow.com/users/10522579/ray"}, "edited": false, "score": 0, "creation_date": 1543931809, "post_id": 53614261, "comment_id": 94089722, "body": "Tested, appeared strange, update if you get it in details."}, {"owner": {"reputation": 4300, "user_id": 313522, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/e6dd88ec54643689069f97f0d52398ca?s=128&d=identicon&r=PG", "display_name": "gorn", "link": "https://stackoverflow.com/users/313522/gorn"}, "reply_to_user": {"reputation": 5060, "user_id": 10522579, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7GQ6a.jpg?s=128&g=1", "display_name": "ray", "link": "https://stackoverflow.com/users/10522579/ray"}, "edited": false, "score": 0, "creation_date": 1543932222, "post_id": 53614261, "comment_id": 94090000, "body": "What details do you need? It is already strange ..."}, {"owner": {"reputation": 5060, "user_id": 10522579, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7GQ6a.jpg?s=128&g=1", "display_name": "ray", "link": "https://stackoverflow.com/users/10522579/ray"}, "edited": false, "score": 0, "creation_date": 1543932324, "post_id": 53614261, "comment_id": 94090078, "body": "clarification for above strange thing :)"}, {"owner": {"reputation": 4300, "user_id": 313522, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/e6dd88ec54643689069f97f0d52398ca?s=128&d=identicon&r=PG", "display_name": "gorn", "link": "https://stackoverflow.com/users/313522/gorn"}, "reply_to_user": {"reputation": 5060, "user_id": 10522579, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7GQ6a.jpg?s=128&g=1", "display_name": "ray", "link": "https://stackoverflow.com/users/10522579/ray"}, "edited": false, "score": 2, "creation_date": 1543932745, "post_id": 53614261, "comment_id": 94090332, "body": "Well I quess that it is what the answers are for ;)"}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 3, "creation_date": 1543932923, "post_id": 53614261, "comment_id": 94090434, "body": "The default value is just that a default return value when the key does not exist. It has nothing to do with key value assignment. @SergioTulentsev has shown you how to &quot;do it so it works&quot;"}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1543957126, "post_id": 53614261, "comment_id": 94103002, "body": "Another way that is commonly done: <code>h = {}; (h[&#39;a&#39;] ||= []) &lt;&lt; &#39;b&#39;; h #=&gt; {&#39;a&#39;=&gt;[&#39;b&#39;]}; (h[&#39;a&#39;] ||= []) &lt;&lt; &#39;c&#39;; h #=&gt; {&#39;a&#39;=&gt;[&#39;b&#39;, &#39;c&#39;])</code>. Initially <code>h.key(&#39;a&#39;) #=&gt; false</code>, so <code>(h[&#39;a&#39;] ||= []) &lt;&lt; &#39;b&#39; #=&gt; (h[&#39;a&#39;] = h[&#39;a] || []) &lt;&lt; &#39;b&#39; #=&gt; (h[&#39;a&#39;] = nil || []) &lt;&lt; &#39;b&#39; #=&gt; (h[&#39;a&#39;] = []) &lt;&lt; &#39;b&#39; #=&gt; h[&#39;a&#39;] &lt;&lt; &#39;b&#39;; h #=&gt; {&#39;a&#39;=&gt;[&#39;b&#39;]</code>."}, {"owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 0, "creation_date": 1543994840, "post_id": 53614261, "comment_id": 94114074, "body": "What does not work? How to do what?"}], "answers": [{"comments": [{"owner": {"reputation": 4300, "user_id": 313522, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/e6dd88ec54643689069f97f0d52398ca?s=128&d=identicon&r=PG", "display_name": "gorn", "link": "https://stackoverflow.com/users/313522/gorn"}, "edited": false, "score": 0, "creation_date": 1543931996, "post_id": 53614418, "comment_id": 94089850, "body": "I thought that <code>array &lt;&lt; x</code> is something like <code>array = array + [x]</code>"}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "reply_to_user": {"reputation": 4300, "user_id": 313522, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/e6dd88ec54643689069f97f0d52398ca?s=128&d=identicon&r=PG", "display_name": "gorn", "link": "https://stackoverflow.com/users/313522/gorn"}, "edited": false, "score": 0, "creation_date": 1543932034, "post_id": 53614418, "comment_id": 94089875, "body": "@gorn: no, it&#39;s not."}, {"owner": {"reputation": 4300, "user_id": 313522, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/e6dd88ec54643689069f97f0d52398ca?s=128&d=identicon&r=PG", "display_name": "gorn", "link": "https://stackoverflow.com/users/313522/gorn"}, "edited": false, "score": 0, "creation_date": 1543932557, "post_id": 53614418, "comment_id": 94090223, "body": "Well, obviously it is not, but according to documentation &lt;&lt; &quot;Pushes the given object on to the end of this array.&quot; So how it differs from <code>array = array + [x]</code> (which also places x as last element of array)."}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "reply_to_user": {"reputation": 4300, "user_id": 313522, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/e6dd88ec54643689069f97f0d52398ca?s=128&d=identicon&r=PG", "display_name": "gorn", "link": "https://stackoverflow.com/users/313522/gorn"}, "edited": false, "score": 0, "creation_date": 1543932842, "post_id": 53614418, "comment_id": 94090388, "body": "@gorn: &quot;which also places x as last element of array)&quot; - not quite. It creates a <b>new</b> array, rather than modifying the existing one in-place."}], "tags": [], "owner": {"reputation": 48413, "user_id": 1279683, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1veuT.jpg?s=128&g=1", "display_name": "Marek Lipka", "link": "https://stackoverflow.com/users/1279683/marek-lipka"}, "is_accepted": false, "score": 0, "last_activity_date": 1543931867, "last_edit_date": 1543931867, "creation_date": 1543931382, "answer_id": 53614418, "question_id": 53614261, "link": "https://stackoverflow.com/questions/53614261/interaction-between-hash-value-and-operator/53614418#53614418", "title": "Interaction between hash value and `&lt;&lt;` operator", "body": "<p>It's because you modify this specific object you passed as a default value. So:</p>\n\n<pre><code>h = Hash.new([])\nh['a'] &lt;&lt; 'b'\nh['a'] &lt;&lt; 'c'\nh['b'] # or h['a'] or h[:virtually_anything]\n# =&gt; [\"b\", \"c\"]\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 4300, "user_id": 313522, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/e6dd88ec54643689069f97f0d52398ca?s=128&d=identicon&r=PG", "display_name": "gorn", "link": "https://stackoverflow.com/users/313522/gorn"}, "edited": false, "score": 0, "creation_date": 1543931866, "post_id": 53614510, "comment_id": 94089769, "body": "Should not <code>array &lt;&lt; &#39;b&#39;</code> be identical to <code>array= [&#39;b&#39;]</code> on empty arrays?"}, {"owner": {"reputation": 4300, "user_id": 313522, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/e6dd88ec54643689069f97f0d52398ca?s=128&d=identicon&r=PG", "display_name": "gorn", "link": "https://stackoverflow.com/users/313522/gorn"}, "edited": false, "score": 0, "creation_date": 1543931935, "post_id": 53614510, "comment_id": 94089815, "body": "I.e. should not <code>h[&#39;a&#39;] &lt;&lt; &#39;b&#39;</code> behave like <code>h[&#39;a&#39;] = [&#39;b&#39;]</code> if <code>h[&#39;a&#39;]</code> is empty array?"}, {"owner": {"reputation": 48413, "user_id": 1279683, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1veuT.jpg?s=128&g=1", "display_name": "Marek Lipka", "link": "https://stackoverflow.com/users/1279683/marek-lipka"}, "edited": false, "score": 0, "creation_date": 1543931959, "post_id": 53614510, "comment_id": 94089827, "body": "No, there&#39;s no reason for it to behave this way. It&#39;s all about what object are you currently modifying. When you&#39;re doing <code>h[&#39;a&#39;] = [&#39;b&#39;]</code>, you&#39;re creating a new <code>Array</code> object and assign it to <code>&#39;a&#39;</code> key in <code>h</code> <code>Hash</code>."}, {"owner": {"reputation": 4300, "user_id": 313522, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/e6dd88ec54643689069f97f0d52398ca?s=128&d=identicon&r=PG", "display_name": "gorn", "link": "https://stackoverflow.com/users/313522/gorn"}, "edited": false, "score": 0, "creation_date": 1543932173, "post_id": 53614510, "comment_id": 94089969, "body": "If you look at  <a href=\"http://tpcg.io/UBS8FQ\" rel=\"nofollow noreferrer\">tpcg.io/UBS8FQ</a>  than you see the reason. For an empty array it behaves identically."}, {"owner": {"reputation": 4300, "user_id": 313522, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/e6dd88ec54643689069f97f0d52398ca?s=128&d=identicon&r=PG", "display_name": "gorn", "link": "https://stackoverflow.com/users/313522/gorn"}, "edited": false, "score": 0, "creation_date": 1543932317, "post_id": 53614510, "comment_id": 94090072, "body": "You say &quot;It&#39;s because h has no key &#39;a&#39;, you need to initialize it&quot; but is not the default value supposed to do that automagically?"}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "reply_to_user": {"reputation": 4300, "user_id": 313522, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/e6dd88ec54643689069f97f0d52398ca?s=128&d=identicon&r=PG", "display_name": "gorn", "link": "https://stackoverflow.com/users/313522/gorn"}, "edited": false, "score": 1, "creation_date": 1543932549, "post_id": 53614510, "comment_id": 94090217, "body": "@gorn: &quot;but is not the default value supposed to do that automagically?&quot; - one could argue that this would be a sensible approach. Alas, wording in Hash documentation is pretty unambiguous. &quot;Retrieves the value object corresponding to the key object. If not found, returns the default value&quot;"}, {"owner": {"reputation": 4300, "user_id": 313522, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/e6dd88ec54643689069f97f0d52398ca?s=128&d=identicon&r=PG", "display_name": "gorn", "link": "https://stackoverflow.com/users/313522/gorn"}, "edited": false, "score": 0, "creation_date": 1543932681, "post_id": 53614510, "comment_id": 94090292, "body": "If the <code>h[&#39;a&#39;] += [&#39;b&#39;]</code> would not work as well than I would not complain, but to me <code>array &lt;&lt; &#39;b&#39;</code> and <code>array += [&#39;b&#39;]</code> looks very identical"}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "reply_to_user": {"reputation": 4300, "user_id": 313522, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/e6dd88ec54643689069f97f0d52398ca?s=128&d=identicon&r=PG", "display_name": "gorn", "link": "https://stackoverflow.com/users/313522/gorn"}, "edited": false, "score": 1, "creation_date": 1543932761, "post_id": 53614510, "comment_id": 94090340, "body": "@gorn: well, that&#39;s your misunderstanding of how these two work. The latter <i>reassigns</i> array. That&#39;s the key difference."}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "reply_to_user": {"reputation": 4300, "user_id": 313522, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/e6dd88ec54643689069f97f0d52398ca?s=128&d=identicon&r=PG", "display_name": "gorn", "link": "https://stackoverflow.com/users/313522/gorn"}, "edited": false, "score": 0, "creation_date": 1543932961, "post_id": 53614510, "comment_id": 94090461, "body": "@gorn JFYI, you should <code>@mention</code> people to whom you&#39;re responding. Or they may never see your comments."}, {"owner": {"reputation": 9663, "user_id": 5239030, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/76JEw.png?s=128&g=1", "display_name": "iGian", "link": "https://stackoverflow.com/users/5239030/igian"}, "reply_to_user": {"reputation": 4300, "user_id": 313522, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/e6dd88ec54643689069f97f0d52398ca?s=128&d=identicon&r=PG", "display_name": "gorn", "link": "https://stackoverflow.com/users/313522/gorn"}, "edited": false, "score": 0, "creation_date": 1543933994, "post_id": 53614510, "comment_id": 94091113, "body": "@gorn, Sergio Tulentsev already gave a great explanation, I just added an edit to my post based on it."}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "reply_to_user": {"reputation": 4300, "user_id": 313522, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/e6dd88ec54643689069f97f0d52398ca?s=128&d=identicon&r=PG", "display_name": "gorn", "link": "https://stackoverflow.com/users/313522/gorn"}, "edited": false, "score": 0, "creation_date": 1543935822, "post_id": 53614510, "comment_id": 94092197, "body": "@gorn <code>h[&#39;a&#39;]</code> and <code>h[&#39;a&#39;]=</code> are two different methods. The <a href=\"http://ruby-doc.org/core-2.5.3/Hash.html#method-i-5B-5D\" rel=\"nofollow noreferrer\">former</a> returns the value for key <code>&#39;a&#39;</code> (which might be the default value) whereas the <a href=\"http://ruby-doc.org/core-2.5.3/Hash.html#method-i-5B-5D-3D\" rel=\"nofollow noreferrer\">latter</a> assigns a new value to key <code>&#39;a&#39;</code>. If you call <code>h[&#39;a&#39;] += [&#39;b&#39;]</code> it is equivalent to <code>h[&#39;a&#39;] = h[&#39;a&#39;] + [&#39;b&#39;]</code>, i.e. you retrieve the default value for <code>&#39;a&#39;</code> (empty array), concatenate <code>[&#39;b&#39;]</code> and assign the result to the key <code>&#39;a&#39;</code> (which then exists)."}], "tags": [], "owner": {"reputation": 9663, "user_id": 5239030, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/76JEw.png?s=128&g=1", "display_name": "iGian", "link": "https://stackoverflow.com/users/5239030/igian"}, "is_accepted": false, "score": 0, "last_activity_date": 1543933901, "last_edit_date": 1543933901, "creation_date": 1543931635, "answer_id": 53614510, "question_id": 53614261, "link": "https://stackoverflow.com/questions/53614261/interaction-between-hash-value-and-operator/53614510#53614510", "title": "Interaction between hash value and `&lt;&lt;` operator", "body": "<p>It's because <code>h</code> has no key <code>'a'</code>, you need to initialize it before or it's just a default value reset:</p>\n\n<pre><code>h = Hash.new([])\nh['a'] = ['b']\nh['a'] &lt;&lt; 'c'\n\nh['a'] #=&gt; [\"b\", \"c\"]\nh #=&gt; {\"a\"=&gt;[\"b\", \"c\"]}\n</code></pre>\n\n<p>This behave the same:</p>\n\n<pre><code>k = Hash.new\nk.default = []\n</code></pre>\n\n<p>While, as explained by Sergio Tulentsev, (<a href=\"https://stackoverflow.com/a/53614695/5239030\">https://stackoverflow.com/a/53614695/5239030</a>) this creates the key \"on the fly\", try this:</p>\n\n<pre><code>k = Hash.new {|h, k| puts \"Just created a new key: #{k}\"; h[k] = [] }\np k['a'] &lt;&lt; 'a'\np k['a'] &lt;&lt; 'a'\np k['b'] &lt;&lt; 'b'\np k\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 5060, "user_id": 10522579, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7GQ6a.jpg?s=128&g=1", "display_name": "ray", "link": "https://stackoverflow.com/users/10522579/ray"}, "edited": false, "score": 0, "creation_date": 1543932452, "post_id": 53614695, "comment_id": 94090154, "body": "but we passed <code>[]</code> as an argument for new not as a block code. Can you elaborate more?"}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "reply_to_user": {"reputation": 5060, "user_id": 10522579, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7GQ6a.jpg?s=128&g=1", "display_name": "ray", "link": "https://stackoverflow.com/users/10522579/ray"}, "edited": false, "score": 1, "creation_date": 1543932656, "post_id": 53614695, "comment_id": 94090275, "body": "@ray: yeah, that form of setting default value doesn&#39;t work as &quot;expected&quot; with mutable objects (array here)"}, {"owner": {"reputation": 4300, "user_id": 313522, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/e6dd88ec54643689069f97f0d52398ca?s=128&d=identicon&r=PG", "display_name": "gorn", "link": "https://stackoverflow.com/users/313522/gorn"}, "edited": false, "score": 0, "creation_date": 1543933721, "post_id": 53614695, "comment_id": 94090937, "body": "@SergioTulentsevI have elaborated the answer so it is more usefull for other people, please do corrections if you feel so inclined."}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 1, "creation_date": 1543934183, "post_id": 53614695, "comment_id": 94091228, "body": "The <a href=\"http://ruby-doc.org/core-2.5.3/Hash.html#method-c-new\" rel=\"nofollow noreferrer\">docs</a> explicitly state: <i>&quot;It is the block&#39;s responsibility to store the value in the hash if required.&quot;</i>"}, {"owner": {"reputation": 4300, "user_id": 313522, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/e6dd88ec54643689069f97f0d52398ca?s=128&d=identicon&r=PG", "display_name": "gorn", "link": "https://stackoverflow.com/users/313522/gorn"}, "reply_to_user": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1543937927, "post_id": 53614695, "comment_id": 94093559, "body": "@Stefan you are right, althought is seems to be more connected to the &quot;block&quot; style."}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "reply_to_user": {"reputation": 4300, "user_id": 313522, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/e6dd88ec54643689069f97f0d52398ca?s=128&d=identicon&r=PG", "display_name": "gorn", "link": "https://stackoverflow.com/users/313522/gorn"}, "edited": false, "score": 0, "creation_date": 1544002045, "post_id": 53614695, "comment_id": 94117523, "body": "@gorn the documentation for <code>Hash.new</code> gets more specific: with a positional argument, i.e. <code>Hash.new([])</code> you get a single default object. With a block argument, i.e. <code>Hash.new { [] }</code> you do get multiple copies, but they are not persisted. Only with <code>Hash.new { |h, k| h[k] = [] }</code> you get one copy per key. So yes, it is connected to the block style because a block is required to get this mechanism working. Without a block, the default value is simply returned and no keys are being set."}, {"owner": {"reputation": 5060, "user_id": 10522579, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7GQ6a.jpg?s=128&g=1", "display_name": "ray", "link": "https://stackoverflow.com/users/10522579/ray"}, "edited": false, "score": 0, "creation_date": 1544008346, "post_id": 53614695, "comment_id": 94121303, "body": "@SergioTulentsev It was tedious but I got it, thanks :)"}], "tags": [], "owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "is_accepted": true, "score": 7, "last_activity_date": 1543994991, "last_edit_date": 1543994991, "creation_date": 1543932256, "answer_id": 53614695, "question_id": 53614261, "link": "https://stackoverflow.com/questions/53614261/interaction-between-hash-value-and-operator/53614695#53614695", "title": "Interaction between hash value and `&lt;&lt;` operator", "body": "<p>The reason why your line didn't work is that <a href=\"https://ruby-doc.org/core-2.5.3/Hash.html\" rel=\"nofollow noreferrer\">Hash</a>, upon accessing a missing key, simply returns the default value (whatever you specified), without assigning it to the key. And since your default value is a complex mutable object (and it's the very same object that is returned every time), you get what you observed: all values are shoveled straight into the default value, bypassing the hash. This is probably the most common mistake with hashes and mutable default values.</p>\n\n<p>To do what you want, use the third form of Hash.new</p>\n\n<pre><code>new {|hash, key| block } \u2192 new_hash\n</code></pre>\n\n<p>like this, for example</p>\n\n<pre><code>h = Hash.new {|h, k| h[k] = [] }\n</code></pre>\n"}], "owner": {"reputation": 4300, "user_id": 313522, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/e6dd88ec54643689069f97f0d52398ca?s=128&d=identicon&r=PG", "display_name": "gorn", "link": "https://stackoverflow.com/users/313522/gorn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 70, "favorite_count": 0, "closed_date": 1610720775, "accepted_answer_id": 53614695, "answer_count": 3, "score": 2, "last_activity_date": 1557874641, "creation_date": 1543930900, "last_edit_date": 1557874641, "question_id": 53614261, "link": "https://stackoverflow.com/questions/53614261/interaction-between-hash-value-and-operator", "closed_reason": "Duplicate", "title": "Interaction between hash value and `&lt;&lt;` operator", "body": "<p>I expected:</p>\n\n<pre><code>h = Hash.new([])\nh['a'] &lt;&lt; 'b'\nh['a'] &lt;&lt; 'c'\nh # =&gt; {}\n</code></pre>\n\n<p>to give <code>{'a' =&gt; ['b','c']}</code>, not an empty hash. </p>\n\n<p>I also found out that the insert operation targets the default value, because after the code above it is euqal to <code>['b','c']</code>:</p>\n\n<pre><code>h.default # =&gt; ['b','c']\n</code></pre>\n\n<p>I am looking for an explanation on why it does not work and how to do it optimally so it works.</p>\n"}, {"tags": ["ruby", "sass", "rubygems", "gruntjs"], "comments": [{"owner": {"reputation": 4505, "user_id": 1051677, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/662f409b812848562fa7a07d1988b1c2?s=128&d=identicon&r=PG", "display_name": "Silviu Burcea", "link": "https://stackoverflow.com/users/1051677/silviu-burcea"}, "edited": false, "score": 0, "creation_date": 1589979332, "post_id": 53613736, "comment_id": 109506756, "body": "Does this answer your question? <a href=\"https://stackoverflow.com/questions/24269242/grunt-sass-dont-have-ruby-and-sass-installed\">Grunt sass don&#39;t have ruby and sass installed?</a>"}], "answers": [{"tags": [], "owner": {"reputation": 1217, "user_id": 10430642, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/p5jzL.jpg?s=128&g=1", "display_name": "Dimitrius Lachi", "link": "https://stackoverflow.com/users/10430642/dimitrius-lachi"}, "is_accepted": false, "score": 1, "last_activity_date": 1543929350, "creation_date": 1543929350, "answer_id": 53613848, "question_id": 53613736, "link": "https://stackoverflow.com/questions/53613736/cant-install-ruby-and-sass-gem-for-mac/53613848#53613848", "title": "Can&#39;t install Ruby and sass gem for Mac", "body": "<p>May for only  install it, you can use -n option: <code>sudo gem install -n /usr/local/bin sass</code></p>\n\n<p>But,i strongly recommends you to use a ruby manager, like RVM (<a href=\"https://rvm.io/rvm/install\" rel=\"nofollow noreferrer\">https://rvm.io/rvm/install</a>) supports MacOS, permits you to have multiple Ruby versions and keep all your gems organized by version.</p>\n"}, {"tags": [], "owner": {"reputation": 193, "user_id": 2787982, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/09a0b731704ecf66f4cd52f257679d26?s=128&d=identicon&r=PG", "display_name": "keyboard-warrior", "link": "https://stackoverflow.com/users/2787982/keyboard-warrior"}, "is_accepted": false, "score": 2, "last_activity_date": 1543943102, "creation_date": 1543943102, "answer_id": 53618102, "question_id": 53613736, "link": "https://stackoverflow.com/questions/53613736/cant-install-ruby-and-sass-gem-for-mac/53618102#53618102", "title": "Can&#39;t install Ruby and sass gem for Mac", "body": "<p>Have you installed the xcode dev tools yet? Try this first:</p>\n\n<pre><code>xcode-select --install\n</code></pre>\n\n<p>And then install Sass:</p>\n\n<pre><code>sudo gem install sass\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 10589667, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-761fYF4Xz4o/AAAAAAAAAAI/AAAAAAAABGY/_CNBz2CvTLM/photo.jpg?sz=128", "display_name": "kalinga udaya", "link": "https://stackoverflow.com/users/10589667/kalinga-udaya"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 427, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1589972681, "creation_date": 1543928956, "question_id": 53613736, "link": "https://stackoverflow.com/questions/53613736/cant-install-ruby-and-sass-gem-for-mac", "title": "Can&#39;t install Ruby and sass gem for Mac", "body": "<p>sudo gem install sass</p>\n\n<p>ERROR:  While executing gem ... (Gem::FilePermissionError)\n    You don't have write permissions for the /usr/bin directory.</p>\n\n<p><strong>therefore not working grunt watch</strong></p>\n\n<p>grunt watch\nRunning \"watch\" task\nWaiting...</p>\n\n<blockquote>\n  <blockquote>\n    <p>File \"scss/modules/_base.scss\" changed.\n    Running \"sass:dist\" (sass) task\n    /Library/Ruby/Site/2.3.0/rubygems.rb:289:in <code>find_spec_for_exe': can't find gem sass (&gt;= 0.a) with executable sass (Gem::GemNotFoundException)\n        from /Library/Ruby/Site/2.3.0/rubygems.rb:263:in</code>bin_path'\n        from /usr/local/bin/sass:22:in `'\n    Warning: Exited with error code 1 Use --force to continue.</p>\n  </blockquote>\n</blockquote>\n\n<p>Aborted due to warnings.\nCompleted in 1.020s at Tue Dec 04 2018 05:00:37 GMT-0800 (Pacific Standard Time) - Waiting...</p>\n"}, {"tags": ["sql", "ruby-on-rails", "ruby", "database"], "comments": [{"owner": {"reputation": 48413, "user_id": 1279683, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1veuT.jpg?s=128&g=1", "display_name": "Marek Lipka", "link": "https://stackoverflow.com/users/1279683/marek-lipka"}, "edited": false, "score": 1, "creation_date": 1543928354, "post_id": 53613432, "comment_id": 94087738, "body": "Don&#39;t put images of code/results in your question. It&#39;s impossible to copy or index properly in search engines."}], "answers": [{"tags": [], "owner": {"reputation": 48413, "user_id": 1279683, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1veuT.jpg?s=128&g=1", "display_name": "Marek Lipka", "link": "https://stackoverflow.com/users/1279683/marek-lipka"}, "is_accepted": true, "score": 9, "last_activity_date": 1543928645, "last_edit_date": 1543928645, "creation_date": 1543928298, "answer_id": 53613547, "question_id": 53613432, "link": "https://stackoverflow.com/questions/53613432/same-ruby-on-rails-query-returning-different-values/53613547#53613547", "title": "Same ruby on rails query returning different values", "body": "<p>In the first case, you call method <code>ceil</code> with an argument, which is <code>-200</code>, it's equivalent to:</p>\n\n<pre><code>(expression).ceil(-200)\n</code></pre>\n\n<p>The optional argument passed into <code>ceil</code> is responsible for precision.</p>\n\n<p>In the second, you call <code>ceil</code> without any arguments and substract <code>200</code> from its result, i.e. you call method <code>-</code> with argument <code>200</code> on its result, so it's equivalent to:</p>\n\n<pre><code>(expression).ceil.-(200)\n</code></pre>\n"}], "owner": {"reputation": 379, "user_id": 9240268, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JBSS5.jpg?s=128&g=1", "display_name": "bibsbarreto", "link": "https://stackoverflow.com/users/9240268/bibsbarreto"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 49, "favorite_count": 0, "accepted_answer_id": 53613547, "answer_count": 1, "score": 1, "last_activity_date": 1543928645, "creation_date": 1543927842, "question_id": 53613432, "link": "https://stackoverflow.com/questions/53613432/same-ruby-on-rails-query-returning-different-values", "title": "Same ruby on rails query returning different values", "body": "<p>Can someone explain me what is happening here?</p>\n\n<p><a href=\"https://i.stack.imgur.com/puKSS.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/puKSS.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["ruby-on-rails", "ruby", "mathjax", "pmml"], "comments": [{"owner": {"reputation": 1217, "user_id": 10430642, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/p5jzL.jpg?s=128&g=1", "display_name": "Dimitrius Lachi", "link": "https://stackoverflow.com/users/10430642/dimitrius-lachi"}, "edited": false, "score": 0, "creation_date": 1543927354, "post_id": 53613164, "comment_id": 94087193, "body": "Did you restarted the server?"}, {"owner": {"reputation": 65, "user_id": 9749097, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c3995f74020227617b95fc7cd1ee5a85?s=128&d=identicon&r=PG&f=1", "display_name": "luftgekuhltlover", "link": "https://stackoverflow.com/users/9749097/luftgekuhltlover"}, "reply_to_user": {"reputation": 1217, "user_id": 10430642, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/p5jzL.jpg?s=128&g=1", "display_name": "Dimitrius Lachi", "link": "https://stackoverflow.com/users/10430642/dimitrius-lachi"}, "edited": false, "score": 0, "creation_date": 1543927485, "post_id": 53613164, "comment_id": 94087270, "body": "@DimitriusLachi just realised that I haven&#39;t, so I did, and I edit my initial question. Thanks"}], "answers": [{"comments": [{"owner": {"reputation": 65, "user_id": 9749097, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c3995f74020227617b95fc7cd1ee5a85?s=128&d=identicon&r=PG&f=1", "display_name": "luftgekuhltlover", "link": "https://stackoverflow.com/users/9749097/luftgekuhltlover"}, "edited": false, "score": 0, "creation_date": 1543927362, "post_id": 53613250, "comment_id": 94087200, "body": "Just realised that I don&#39;t get the error anymore after restarting rails server, but I don&#39;t see any change, the math formulas are being shown the same as before"}], "tags": [], "owner": {"reputation": 357, "user_id": 9211857, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d7afb28e1b7699679e48fbe62caaac9?s=128&d=identicon&r=PG&f=1", "display_name": "Vijay Atmin", "link": "https://stackoverflow.com/users/9211857/vijay-atmin"}, "is_accepted": false, "score": 0, "last_activity_date": 1543927266, "creation_date": 1543927266, "answer_id": 53613250, "question_id": 53613164, "link": "https://stackoverflow.com/questions/53613164/added-mathjax-rails-to-load-mathml-in-chrome-but-not-working-properly/53613250#53613250", "title": "Added mathjax-rails to load mathml in chrome but not working properly", "body": "<p>You need to restart rails server after bundle install</p>\n"}], "owner": {"reputation": 65, "user_id": 9749097, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c3995f74020227617b95fc7cd1ee5a85?s=128&d=identicon&r=PG&f=1", "display_name": "luftgekuhltlover", "link": "https://stackoverflow.com/users/9749097/luftgekuhltlover"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 91, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1543928533, "creation_date": 1543926976, "last_edit_date": 1543928533, "question_id": 53613164, "link": "https://stackoverflow.com/questions/53613164/added-mathjax-rails-to-load-mathml-in-chrome-but-not-working-properly", "title": "Added mathjax-rails to load mathml in chrome but not working properly", "body": "<p>I found this git repo <a href=\"https://github.com/pmq20/mathjax-rails\" rel=\"nofollow noreferrer\">https://github.com/pmq20/mathjax-rails</a> and followed the steps to add Mathjax in my rails application. </p>\n\n<p>I added this line to the Gemfile:</p>\n\n<p><code>gem 'mathjax-rails'</code></p>\n\n<p>and then:</p>\n\n<p><code>$ bundle install</code></p>\n\n<p>added the following to <code>config/routes.rb</code> :</p>\n\n<p><code>mathjax 'mathjax'</code></p>\n\n<p>add the script tag inside app/views/layouts/application.html.erb:</p>\n\n<p><code>&lt;%= mathjax_tag %&gt;</code></p>\n\n<p>I also loaded this configuration file <code>Accessible-full.js</code>:</p>\n\n<p><code>&lt;%= mathjax_tag :config=&gt;'Accessible-full.js' %&gt;</code></p>\n\n<p>But looks like I need to also enable the CMML plugin in mathjax and I do not know how. Or I need to preprocess the mml to just deliver the pmml portion. Any help would be highly appreciated!</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 802, "user_id": 8728218, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/376ec53188ea3ec0271198a862516657?s=128&d=identicon&r=PG&f=1", "display_name": "Dyaniyal Wilson", "link": "https://stackoverflow.com/users/8728218/dyaniyal-wilson"}, "edited": false, "score": 0, "creation_date": 1543927170, "post_id": 53612721, "comment_id": 94087087, "body": "are u using an enum for role field?"}, {"owner": {"reputation": 1276, "user_id": 5399937, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ctCqj.png?s=128&g=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/5399937/tom"}, "edited": false, "score": 0, "creation_date": 1546441725, "post_id": 53612721, "comment_id": 94853915, "body": "Is your <code>role</code> field an Rails enum or boolean datatype?"}], "answers": [{"comments": [{"owner": {"reputation": 5060, "user_id": 10522579, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7GQ6a.jpg?s=128&g=1", "display_name": "ray", "link": "https://stackoverflow.com/users/10522579/ray"}, "edited": false, "score": 0, "creation_date": 1543928199, "post_id": 53612828, "comment_id": 94087653, "body": "I can see right one but I could not get  the point of adding method in model for one-liner code. You could check it as <code>current_user.role?</code> which returns false for 0. Perhaps you are going to call current_user method to call active_admin?"}], "tags": [], "owner": {"reputation": 5312, "user_id": 6535997, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/10156345016155058/picture?type=large", "display_name": "Mark", "link": "https://stackoverflow.com/users/6535997/mark"}, "is_accepted": false, "score": 3, "last_activity_date": 1543925953, "creation_date": 1543925953, "answer_id": 53612828, "question_id": 53612721, "link": "https://stackoverflow.com/questions/53612721/how-to-write-a-custom-function-in-a-model-in-ruby-on-rails/53612828#53612828", "title": "How to write a custom function in a model in ruby on rails?", "body": "<p>In your user.rb file:</p>\n\n<pre><code>class User &lt; ActiveRecord::Base\n  def active_admin?\n    role == 0\n  end\nend\n</code></pre>\n\n<p>In your view:</p>\n\n<pre><code>&lt;% if current_user.active_admin? %&gt;\n  &lt;%= render 'layouts/admin' %&gt;   \n&lt;% else %&gt;\n  &lt;%= render 'layouts/user' %&gt;\n&lt;% end %&gt;\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 5312, "user_id": 6535997, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/10156345016155058/picture?type=large", "display_name": "Mark", "link": "https://stackoverflow.com/users/6535997/mark"}, "edited": false, "score": 1, "creation_date": 1543928166, "post_id": 53612950, "comment_id": 94087636, "body": "This is probably nicer than mine to be fair"}], "tags": [], "owner": {"reputation": 5980, "user_id": 60131, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/axDcf.jpg?s=128&g=1", "display_name": "John Gallagher", "link": "https://stackoverflow.com/users/60131/john-gallagher"}, "is_accepted": false, "score": 2, "last_activity_date": 1543926265, "creation_date": 1543926265, "answer_id": 53612950, "question_id": 53612721, "link": "https://stackoverflow.com/questions/53612721/how-to-write-a-custom-function-in-a-model-in-ruby-on-rails/53612950#53612950", "title": "How to write a custom function in a model in ruby on rails?", "body": "<p>As Mark says, you can just check <code>role</code> for 0 or 1.</p>\n\n<p>Any column in your database will map directly to a method on the model.</p>\n\n<p>A couple of points:</p>\n\n<ul>\n<li>If you're using Rails 5 you'll need to inherit from <code>ApplicationRecord</code> rather than <code>ActiveRecord::Base</code>.</li>\n<li>In newer versions of Ruby you can use the <code>#zero?</code> method:</li>\n</ul>\n\n<pre class=\"lang-rb prettyprint-override\"><code>class User &lt; ApplicationRecord\n  def active_admin?\n    role.zero?\n  end\nend\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 802, "user_id": 8728218, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/376ec53188ea3ec0271198a862516657?s=128&d=identicon&r=PG&f=1", "display_name": "Dyaniyal Wilson", "link": "https://stackoverflow.com/users/8728218/dyaniyal-wilson"}, "is_accepted": false, "score": 1, "last_activity_date": 1543986628, "last_edit_date": 1543986628, "creation_date": 1543927788, "answer_id": 53613417, "question_id": 53612721, "link": "https://stackoverflow.com/questions/53612721/how-to-write-a-custom-function-in-a-model-in-ruby-on-rails/53613417#53613417", "title": "How to write a custom function in a model in ruby on rails?", "body": "<p>No need of adding a method for checking the roles, you can directly achieve this by below change. It will return true for anything other than 0. </p>\n\n<pre><code>&lt;% if current_user.role? %&gt;\n  &lt;%= render 'layouts/user' %&gt;        \n&lt;% else %&gt;\n  &lt;%= render 'layouts/admin' %&gt; \n&lt;% end %&gt;\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 947, "user_id": 7333505, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ade96347d4304c3c3e72b914f61d1792?s=128&d=identicon&r=PG&f=1", "display_name": "Ritesh Ranjan", "link": "https://stackoverflow.com/users/7333505/ritesh-ranjan"}, "is_accepted": false, "score": 1, "last_activity_date": 1544018070, "creation_date": 1544018070, "answer_id": 53633955, "question_id": 53612721, "link": "https://stackoverflow.com/questions/53612721/how-to-write-a-custom-function-in-a-model-in-ruby-on-rails/53633955#53633955", "title": "How to write a custom function in a model in ruby on rails?", "body": "<p>One way can be add an method on application controller as</p>\n\n<pre><code>  def after_sign_in_path_for(resource_or_scope)\n    if current_user.role==0\n      #your admin path\n    else\n      root_path\n    end\n  end\n\n\n  def authenticate_admin\n    unless (user_signed_in? and current_user.role !=0 )\n      redirect_to '/users/sign_in'\n    end\n  end\n</code></pre>\n\n<p>add to the required controller </p>\n\n<pre><code>  before_filter :authenticate_admin\n  layout 'admin'\n</code></pre>\n"}], "owner": {"reputation": 57, "user_id": 10728400, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xxD9M.jpg?s=128&g=1", "display_name": "divya", "link": "https://stackoverflow.com/users/10728400/divya"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 966, "favorite_count": 0, "answer_count": 4, "score": 0, "last_activity_date": 1546444249, "creation_date": 1543925567, "last_edit_date": 1546444249, "question_id": 53612721, "link": "https://stackoverflow.com/questions/53612721/how-to-write-a-custom-function-in-a-model-in-ruby-on-rails", "title": "How to write a custom function in a model in ruby on rails?", "body": "<p>I have a User model class I have created with Devise.</p>\n\n<p>I have a role field (admin=0, user=1) in my model.</p>\n\n<p>Screenshot of my database:</p>\n\n<p><img src=\"https://i.imgur.com/2Kr5Uuj.png\" alt=\"Screenshot of my database\"></p>\n\n<h2>HTML View</h2>\n\n<pre><code>&lt;% if current_user.active_admin? %&gt;\n  &lt;%= render 'layouts/admin' %&gt;   \n&lt;% else %&gt;\n  &lt;%= render 'layouts/user' %&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<h2>Model</h2>\n\n<pre><code>def active_admin?\n   #your logic here\nend\n</code></pre>\n\n<p>I want to login. If I am an admin check role is 0 render to layouts/admin else I am a user check role is 1 render to layouts/user.</p>\n\n<p>How do I write code in the model to do this?</p>\n"}, {"tags": ["arrays", "json", "ruby"], "comments": [{"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1543924795, "post_id": 53612408, "comment_id": 94085766, "body": "Well, your structure IS an array. And hashes can&#39;t have any duplicate keys (which is probably what you refer to as &quot;data loss&quot;). Post a bigger source array and exactly what hash you&#39;re hoping to convert it to."}, {"owner": {"reputation": 139, "user_id": 5581314, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/1f08692876a66df8a8fcb54d990ec22b?s=128&d=identicon&r=PG&f=1", "display_name": "Mikhah", "link": "https://stackoverflow.com/users/5581314/mikhah"}, "reply_to_user": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1543925428, "post_id": 53612408, "comment_id": 94086107, "body": "@SergioTulentsev well, source array is big, here is a json representation of it (truncated by Gist)- <a href=\"https://gist.github.com/M1khah/3337507e3ca1544e6098bc726bca90cb\" rel=\"nofollow noreferrer\">gist.github.com/M1khah/3337507e3ca1544e6098bc726bca90cb</a>"}, {"owner": {"reputation": 139, "user_id": 5581314, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/1f08692876a66df8a8fcb54d990ec22b?s=128&d=identicon&r=PG&f=1", "display_name": "Mikhah", "link": "https://stackoverflow.com/users/5581314/mikhah"}, "reply_to_user": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1543925561, "post_id": 53612408, "comment_id": 94086168, "body": "@SergioTulentsevand a desried Hash should be just a hash with hashes which are currently in an array"}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1543925634, "post_id": 53612408, "comment_id": 94086209, "body": "Post it too. As it is, I can&#39;t really tell what exactly you mean by &quot;just a hash with hashes&quot;"}, {"owner": {"reputation": 139, "user_id": 5581314, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/1f08692876a66df8a8fcb54d990ec22b?s=128&d=identicon&r=PG&f=1", "display_name": "Mikhah", "link": "https://stackoverflow.com/users/5581314/mikhah"}, "reply_to_user": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1543926088, "post_id": 53612408, "comment_id": 94086468, "body": "@SergioTulentsev I&#39;ve updated the answer to meet your requirements"}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 1, "creation_date": 1543927230, "post_id": 53612408, "comment_id": 94087117, "body": "Your desired result is not a valid ruby hash. As such, it&#39;s impossible to produce."}, {"owner": {"reputation": 139, "user_id": 5581314, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/1f08692876a66df8a8fcb54d990ec22b?s=128&d=identicon&r=PG&f=1", "display_name": "Mikhah", "link": "https://stackoverflow.com/users/5581314/mikhah"}, "reply_to_user": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1543927464, "post_id": 53612408, "comment_id": 94087251, "body": "@SergioTulentsev good point, ty. I&#39;ll think about possible workarounds"}], "owner": {"reputation": 139, "user_id": 5581314, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/1f08692876a66df8a8fcb54d990ec22b?s=128&d=identicon&r=PG&f=1", "display_name": "Mikhah", "link": "https://stackoverflow.com/users/5581314/mikhah"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 146, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1543926056, "creation_date": 1543924435, "last_edit_date": 1543926056, "question_id": 53612408, "link": "https://stackoverflow.com/questions/53612408/ruby-parse-json-file-with-nested-arrays-to-ruby-hash-without-data-loss", "title": "Ruby - parse JSON file with nested arrays to ruby hash without data loss", "body": "<p>I have a <code>file1.json</code> with structure like this :</p>\n\n<pre><code>[\n  {\n    \"uri\": \"features/hdp.feature\",\n    \"id\": \"as-a-user-i-want-to-use-house-detailed-page\",\n    \"keyword\": \"Feature\",\n    \"name\": \"As a user I want to use house detailed page\",\n    \"description\": \"\",\n    \"line\": 2,\n    \"tags\": [\n      {\n        \"name\": \"@hdp\",\n        \"line\": 1\n      }\n    ],\n    \"elements\": [\n      {\n</code></pre>\n\n<p>As you can see - it is an array with nested key:value pairs and other arrays. I need to convert it to ruby hash, but when I'm performing <code>JSON.parse(file1)</code> - it creates an array (<a href=\"http://prntscr.com/lqio6r\" rel=\"nofollow noreferrer\">http://prntscr.com/lqio6r</a>) with ruby hashes, arrays and so on. If I'm performing <code>JSON.parse(file1).reduce Hash.new, :merge or JSON.parse(file1).reduce Hash.new, :update)</code> - as one of the answers on StackOverflow supposed - the result hash losses about 60% of .json content. Can you please advice on how can I convert json file to ruby hash (without any data losses)?</p>\n\n<p>UPD - not truncated array - <a href=\"https://gist.githubusercontent.com/M1khah/3337507e3ca1544e6098bc726bca90cb/raw/c8262ad753bd0eebf1180e111acd016ffc07d1a5/gistfile1.txt\" rel=\"nofollow noreferrer\">https://gist.githubusercontent.com/M1khah/3337507e3ca1544e6098bc726bca90cb/raw/c8262ad753bd0eebf1180e111acd016ffc07d1a5/gistfile1.txt</a>\nHash with hashes - something like this instead of an array with nested hashes</p>\n\n<pre><code>{\n   {\n        \"uri\": \"features/hdp.feature\",\n        \"id\": \"as-a-user-i-want-to-use-house-detailed-page\",\n        \"keyword\": \"Feature\",\n        \"name\": \"As a user I want to use house detailed page\",\n        \"description\": \"\",\n        \"line\": 2,\n        \"tags\": [\n          {\n            \"name\": \"@hdp\",\n            \"line\": 1\n          }\n        ],\n        \"elements\": [\n          {\n    }\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "forms", "nested"], "answers": [{"tags": [], "owner": {"reputation": 1217, "user_id": 10430642, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/p5jzL.jpg?s=128&g=1", "display_name": "Dimitrius Lachi", "link": "https://stackoverflow.com/users/10430642/dimitrius-lachi"}, "is_accepted": false, "score": 4, "last_activity_date": 1548808697, "last_edit_date": 1548808697, "creation_date": 1543923577, "answer_id": 53612158, "question_id": 53611594, "link": "https://stackoverflow.com/questions/53611594/unpermitted-parameters-nested-forms/53612158#53612158", "title": "Unpermitted parameters: nested forms", "body": "<p>When you use nested attributes, you should use the <code>form.fields_for</code>, and if the model item_custom_inputs has attributes, you should permit in you controller: </p>\n\n<pre><code>def item_params\n   params.require(:item).permit(\n     ...,\n     item_custom_inputs_attributes: [:attr1, :attr2]\n  )\nend\n</code></pre>\n\n<p>A good example to understand nested forms can be founded in the following link: <a href=\"https://www.pluralsight.com/guides/ruby-on-rails-nested-attributes\" rel=\"nofollow noreferrer\">https://www.pluralsight.com/guides/ruby-on-rails-nested-attributes</a></p>\n"}], "owner": {"reputation": 5935, "user_id": 365860, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/PPe6C.jpg?s=128&g=1", "display_name": "Nezir", "link": "https://stackoverflow.com/users/365860/nezir"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 69, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1548808697, "creation_date": 1543921696, "question_id": 53611594, "link": "https://stackoverflow.com/questions/53611594/unpermitted-parameters-nested-forms", "title": "Unpermitted parameters: nested forms", "body": "<p>can somebody check my code below.</p>\n\n<p>I have a form with nested form and I am getting all the time the info about 'Unpermitted parameters:' as:</p>\n\n<pre><code>Unpermitted parameters: :item_custom_inputs_attributes, :item_custom_select_inputs_attributes, :item_custom_date_inputs_attributes\nUnpermitted parameters: :item_custom_inputs_attributes, :item_custom_select_inputs_attributes, :item_custom_date_inputs_attributes\nUnpermitted parameters: :item_custom_inputs_attributes, :item_custom_select_inputs_attributes, :item_custom_date_inputs_attributes\nUnpermitted parameters: :item_custom_inputs_attributes, :item_custom_select_inputs_attributes, :item_custom_date_inputs_attributes\n</code></pre>\n\n<p>Here are also params values in controller:</p>\n\n<pre><code>&lt;ActionController::Parameters {\"utf8\"=&gt;\"\u2713\", \"_method\"=&gt;\"patch\", \"authenticity_token\"=&gt;\"XV038rd3aC43ZGw18MZlTxlho3IdsUPJlD/azWfBKdDgakbY/rmRqeNTjRv4KAczi5LMcClZA41xav5HMYOnzw==\", \"account_show_update_button\"=&gt;\"true\", \"item\"=&gt;&lt;ActionController::Parameters {\"name\"=&gt;\"Bags &amp; Backpacks\", \"found_at_date\"=&gt;\"2018-11-27\", \"show_found_date\"=&gt;\"1\", \"found_at_time\"=&gt;\"10:33:22.000\", \"show_found_time\"=&gt;\"1\", \"expiration_date\"=&gt;\"2018-12-27\",\"item_storage_location_id\"=&gt;\"\", \"show_image\"=&gt;\"0\", \"category_id\"=&gt;\"3\", \"tag_list\"=&gt;\"\", \"description\"=&gt;\"\", \"internal_notes\"=&gt;\"\", \"item_custom_inputs_attributes\"=&gt;&lt;ActionController::Parameters {\"11\"=&gt;{\"data\"=&gt;\"text data eeeeeeeeeeee\"}, \"8\"=&gt;{\"data\"=&gt;\"\"}} permitted: false&gt;, \"item_custom_select_inputs_attributes\"=&gt;{\"7\"=&gt;{\"data\"=&gt;\"9\"}}, \"item_custom_date_inputs_attributes\"=&gt;{\"4\"=&gt;{\"data\"=&gt;\"\"}}} permitted: false&gt;, \"commit\"=&gt;\"Update\", \"q\"=&gt;{\"state_eq\"=&gt;\"queued\", \"view_type\"=&gt;\"list\"}, \"controller\"=&gt;\"items\", \"action\"=&gt;\"update\", \"venue_permalink\"=&gt;\"asgardia\", \"id\"=&gt;\"667\"} permitted: false&gt;\n</code></pre>\n\n<p>The controller permit for one of unpermitted parameters:</p>\n\n<pre><code>def item_params\n    params.require(:item).permit(\n      :name, :found_at_date, :found_at_time, :description, :internal_notes, :show_found_date, :show_found_time,\n      :show_image, :image, :category_id, :expiration_date, :claim_form, :location, :flagged, :archive_reason_id,\n      :tag_list, :item_storage_location_id, :is_active, item_custom_inputs_attributes: []\n    )\n\n      end\n</code></pre>\n\n<p>Models:</p>\n\n<pre><code>class Item &lt; ApplicationRecord\n  has_many :item_custom_inputs\n  accepts_nested_attributes_for :item_custom_inputs, allow_destroy: true\nend\n\nclass ItemCustomInput &lt; ApplicationRecord\n    belongs_to :item_custom_field\n    belongs_to :item\nend\n</code></pre>\n\n<p>The nested form fields:</p>\n\n<pre><code>&lt;% @venue.get_custom_logging_fields_without_section.each do |field| %&gt;\n    &lt;% field_type = field.class.name if field.present? %&gt;\n    &lt;div class=\"form-group\"&gt;\n        &lt;% if field_type == \"ItemCustomField\" %&gt;\n            &lt;label&gt;&lt;%= field.title if field.title.present? %&gt;&lt;/label&gt; \n            &lt;input type=\"text\" name=\"item[item_custom_inputs_attributes][&lt;%=field.id %&gt;][data]\", value= \"&lt;%= field.item_custom_input.data if field.item_custom_input.present? %&gt;\", id=\"item_item_custom_inputs_attributes_&lt;%= field.id %&gt;_data\", class=\"form-control\" /&gt;\n\n        &lt;% elsif field_type == \"ItemCustomDateField\" %&gt;\n            &lt;label&gt;&lt;%= field.title + \" DATE\" %&gt;&lt;/label&gt;\n            &lt;input type=\"date\" name=\"item[item_custom_date_inputs_attributes][&lt;%=field.id %&gt;][data]\", value= \"&lt;%= field.item_custom_date_input.data if field.item_custom_date_input.present? %&gt;\", id=\"item_item_custom_date_inputs_attributes_&lt;%= field.id %&gt;_data\", class=\"form-control\" /&gt;\n\n            &lt;label&gt;&lt;%= field.title + \" TIME\" %&gt;&lt;/label&gt;\n            &lt;input type=\"time\" name=\"item[item_custom_date_inputs_attributes][&lt;%= field.id %&gt;][data]\", class=\"form-control\", step: 1 /&gt;\n\n        &lt;% elsif field_type == \"ItemCustomSelectField\" %&gt;\n            &lt;label&gt;&lt;%= field.title if field.title.present? %&gt;&lt;/label&gt; \n            &lt;%= select_tag \"item[item_custom_select_inputs_attributes][#{field.id}][data]\", options_from_collection_for_select(field.item_custom_select_values, :id, :name), class: \"form-control\" %&gt;\n        &lt;% end %&gt;\n\n    &lt;/div&gt;\n&lt;% end %&gt; \n</code></pre>\n\n<p>Obviously I am missing something but cant find what. I tried with different combination in item_params permit format for \"<code>item_custom_inputs_attributes</code>\" but nothings works.</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 5060, "user_id": 10522579, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7GQ6a.jpg?s=128&g=1", "display_name": "ray", "link": "https://stackoverflow.com/users/10522579/ray"}, "edited": false, "score": 0, "creation_date": 1543922164, "post_id": 53611016, "comment_id": 94084287, "body": "How can you use <code>has_many-though</code> association for any model ? user has one rating and book has one rating, so obviously respective rating object will have one book and one user. So rest is you need to correct as per you OOAD implementation."}, {"owner": {"reputation": 1588, "user_id": 723334, "user_type": "registered", "accept_rate": 49, "profile_image": "https://i.stack.imgur.com/Yoz09.jpg?s=128&g=1", "display_name": "prajeesh", "link": "https://stackoverflow.com/users/723334/prajeesh"}, "reply_to_user": {"reputation": 5060, "user_id": 10522579, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7GQ6a.jpg?s=128&g=1", "display_name": "ray", "link": "https://stackoverflow.com/users/10522579/ray"}, "edited": false, "score": 0, "creation_date": 1543923357, "post_id": 53611016, "comment_id": 94084958, "body": "What should be the associations for this requirement?"}], "answers": [{"tags": [], "owner": {"reputation": 21613, "user_id": 580346, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/ba17945a06aac247b06548d5afe341e8?s=128&d=identicon&r=PG", "display_name": "mrzasa", "link": "https://stackoverflow.com/users/580346/mrzasa"}, "is_accepted": false, "score": 0, "last_activity_date": 1543920123, "creation_date": 1543920123, "answer_id": 53611104, "question_id": 53611016, "link": "https://stackoverflow.com/questions/53611016/rails-has-many-through-association-using-includes/53611104#53611104", "title": "Rails has many through association - Using includes", "body": "<p>Use <a href=\"https://guides.rubyonrails.org/active_record_querying.html#specifying-conditions-on-eager-loaded-associations\" rel=\"nofollow noreferrer\"><code>references</code> with <code>includes</code></a>. </p>\n\n<pre><code>  includes(:rating).references(:rating).where(\"ratings.book_id = ? and ratings.user_id = ?\", id, user_id).first\n</code></pre>\n\n<p>Worth reading:\n<a href=\"https://blog.arkency.com/2013/12/rails4-preloading/\" rel=\"nofollow noreferrer\">https://blog.arkency.com/2013/12/rails4-preloading/</a></p>\n"}, {"tags": [], "owner": {"reputation": 6018, "user_id": 3073313, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/d9a53be16eb996b521f1637d19005511?s=128&d=identicon&r=PG", "display_name": "Jay-Ar Polidario", "link": "https://stackoverflow.com/users/3073313/jay-ar-polidario"}, "is_accepted": false, "score": 2, "last_activity_date": 1543921973, "creation_date": 1543921973, "answer_id": 53611675, "question_id": 53611016, "link": "https://stackoverflow.com/questions/53611016/rails-has-many-through-association-using-includes/53611675#53611675", "title": "Rails has many through association - Using includes", "body": "<p>With either <code>includes</code> or <code>joins</code>, you can nest with a Hash for a finder method such as <code>find_by</code> or <code>where</code>:</p>\n\n<pre><code>Book.includes(:rating).find_by(ratings: { book_id: id, user_id: user_id }\n# or\nBook.includes(:rating).where(ratings: { book_id: id, user_id: user_id }.first\n\n# nested hash also works with `joins`, just for FYI\nBook.joins(:rating).where(ratings: { book_id: id, user_id: user_id }.first\n</code></pre>\n\n<h2>Trivia:</h2>\n\n<ul>\n<li><code>ratings:</code> in the above code should be the Table name (<code>ratings</code>) and not the association name (<code>rating</code>).</li>\n<li><p>The nested Hash can go deeper as you wish: i.e. :</p>\n\n<pre><code># say your `User` model `has_many :comments` having `:content` attribute\n\nBook.includes(rating: { user: :comments }).where(\n  ratings: { users: { comments: { content: 'HELLO WORLD' } } }\n)\n\n# or following also works (because there are no conflicts of association names in the query\nBook.includes(rating: { user: :comments }).where(\n  comments: { content: 'HELLO WORLD' }\n)\n</code></pre></li>\n</ul>\n"}], "owner": {"reputation": 1588, "user_id": 723334, "user_type": "registered", "accept_rate": 49, "profile_image": "https://i.stack.imgur.com/Yoz09.jpg?s=128&g=1", "display_name": "prajeesh", "link": "https://stackoverflow.com/users/723334/prajeesh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 52, "favorite_count": 0, "answer_count": 2, "score": -2, "last_activity_date": 1543921973, "creation_date": 1543919857, "question_id": 53611016, "link": "https://stackoverflow.com/questions/53611016/rails-has-many-through-association-using-includes", "title": "Rails has many through association - Using includes", "body": "<p>There are 3 tables - books, users, rating</p>\n\n<p>Book table contains title, id, description</p>\n\n<p>rating table contains - id, value, user_id, book_id</p>\n\n<p>The conditions to meet are as follows</p>\n\n<ul>\n<li>A book can have many ratings</li>\n<li><p>User can add many ratings</p></li>\n<li><p>User can add only one rating for a single book</p></li>\n</ul>\n\n<p>The associations are as follows</p>\n\n<p>book.rb</p>\n\n<pre><code>has_one :rating\nhas_many :users, through: :rating\n</code></pre>\n\n<p>rating.rb</p>\n\n<pre><code>belongs_to :book\nbelongs_to :user\n</code></pre>\n\n<p>user.rb</p>\n\n<pre><code> has_one :rating\n has_many :books, through: :rating\n</code></pre>\n\n<p>books_controller.rb</p>\n\n<pre><code>def show\n  @book = Book.fetch_record(params[:id], @current_user.id)\n  set_book if @book.blank?\n  json_response(@book)\nend\n</code></pre>\n\n<p>book.rb</p>\n\n<pre><code>    def self.fetch_record(id, user_id)\n      joins(:rating).where(\"ratings.book_id = ? and ratings.user_id = ?\", id, user_id).first\n    end\n</code></pre>\n\n<p>Currently i am using joins to fetch the details. </p>\n\n<p>How to achieve the same using includes ?? </p>\n\n<p>Any help would be appreciated.</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "answers": [{"comments": [{"owner": {"reputation": 152, "user_id": 8427339, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5c30927640251ca31a1ed01cf4eb412b?s=128&d=identicon&r=PG&f=1", "display_name": "Tashi Dendup", "link": "https://stackoverflow.com/users/8427339/tashi-dendup"}, "edited": false, "score": 0, "creation_date": 1543922456, "post_id": 53611240, "comment_id": 94084446, "body": "I am just validating the presence of, but I should not get <code>Module::DelegationError</code>. Actually I am just validating presence of <code>some_attribute</code> but I am getting error from <code>some_attribute1</code>, How is that related?"}, {"owner": {"reputation": 21613, "user_id": 580346, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/ba17945a06aac247b06548d5afe341e8?s=128&d=identicon&r=PG", "display_name": "mrzasa", "link": "https://stackoverflow.com/users/580346/mrzasa"}, "reply_to_user": {"reputation": 152, "user_id": 8427339, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5c30927640251ca31a1ed01cf4eb412b?s=128&d=identicon&r=PG&f=1", "display_name": "Tashi Dendup", "link": "https://stackoverflow.com/users/8427339/tashi-dendup"}, "edited": false, "score": 0, "creation_date": 1543922514, "post_id": 53611240, "comment_id": 94084467, "body": "You should. If you delegate it to other object and this object is <code>nil</code>, error should be raised."}, {"owner": {"reputation": 152, "user_id": 8427339, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5c30927640251ca31a1ed01cf4eb412b?s=128&d=identicon&r=PG&f=1", "display_name": "Tashi Dendup", "link": "https://stackoverflow.com/users/8427339/tashi-dendup"}, "edited": false, "score": 0, "creation_date": 1543922739, "post_id": 53611240, "comment_id": 94084603, "body": "Thats correct, but delegate and validation are happening on completely two different attributes."}, {"owner": {"reputation": 21613, "user_id": 580346, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/ba17945a06aac247b06548d5afe341e8?s=128&d=identicon&r=PG", "display_name": "mrzasa", "link": "https://stackoverflow.com/users/580346/mrzasa"}, "reply_to_user": {"reputation": 152, "user_id": 8427339, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5c30927640251ca31a1ed01cf4eb412b?s=128&d=identicon&r=PG&f=1", "display_name": "Tashi Dendup", "link": "https://stackoverflow.com/users/8427339/tashi-dendup"}, "edited": false, "score": 0, "creation_date": 1543923051, "post_id": 53611240, "comment_id": 94084786, "body": "Maybe you have another validation on <code>some_attribute1</code> and matcher calls <code>valid?</code> (not sure)."}, {"owner": {"reputation": 21613, "user_id": 580346, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/ba17945a06aac247b06548d5afe341e8?s=128&d=identicon&r=PG", "display_name": "mrzasa", "link": "https://stackoverflow.com/users/580346/mrzasa"}, "reply_to_user": {"reputation": 152, "user_id": 8427339, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5c30927640251ca31a1ed01cf4eb412b?s=128&d=identicon&r=PG&f=1", "display_name": "Tashi Dendup", "link": "https://stackoverflow.com/users/8427339/tashi-dendup"}, "edited": false, "score": 0, "creation_date": 1543923067, "post_id": 53611240, "comment_id": 94084796, "body": "Post full stacktrace, we&#39;ll see :)"}, {"owner": {"reputation": 152, "user_id": 8427339, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5c30927640251ca31a1ed01cf4eb412b?s=128&d=identicon&r=PG&f=1", "display_name": "Tashi Dendup", "link": "https://stackoverflow.com/users/8427339/tashi-dendup"}, "edited": false, "score": 0, "creation_date": 1543923386, "post_id": 53611240, "comment_id": 94084971, "body": "Finally I spotted the errors, I have a <code>before_validation</code> callback. That was triggering the delegation. Thanks for the help any way."}], "tags": [], "owner": {"reputation": 21613, "user_id": 580346, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/ba17945a06aac247b06548d5afe341e8?s=128&d=identicon&r=PG", "display_name": "mrzasa", "link": "https://stackoverflow.com/users/580346/mrzasa"}, "is_accepted": true, "score": 2, "last_activity_date": 1543920535, "creation_date": 1543920535, "answer_id": 53611240, "question_id": 53610935, "link": "https://stackoverflow.com/questions/53610935/rspec-model-testing-validate-presence-of-throws-moduledelegationerror/53611240#53611240", "title": "Rspec model testing &#39;validate_presence_of&#39; throws Module::DelegationError", "body": "<p>Just as the error says: <code>sub_order</code> is <code>nil</code> so method call cannot be delegated there. You have two options:</p>\n\n<ol>\n<li>Ensure that <code>sub_order</code> is not nil (e.g. by overriding the getter)</li>\n<li>Use <code>.delegate</code> with <code>:allow_nil</code> option</li>\n</ol>\n\n<blockquote>\n  <p><code>:allow_nil</code> - if set to true, prevents a <code>Module::DelegationError</code> from being raised</p>\n</blockquote>\n\n<p><a href=\"https://api.rubyonrails.org/classes/Module.html#method-i-delegate\" rel=\"nofollow noreferrer\">https://api.rubyonrails.org/classes/Module.html#method-i-delegate</a></p>\n"}], "owner": {"reputation": 152, "user_id": 8427339, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5c30927640251ca31a1ed01cf4eb412b?s=128&d=identicon&r=PG&f=1", "display_name": "Tashi Dendup", "link": "https://stackoverflow.com/users/8427339/tashi-dendup"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 180, "favorite_count": 1, "accepted_answer_id": 53611240, "answer_count": 1, "score": 0, "last_activity_date": 1543920632, "creation_date": 1543919611, "last_edit_date": 1543920632, "question_id": 53610935, "link": "https://stackoverflow.com/questions/53610935/rspec-model-testing-validate-presence-of-throws-moduledelegationerror", "title": "Rspec model testing &#39;validate_presence_of&#39; throws Module::DelegationError", "body": "<p>This is my specs</p>\n\n<pre><code>describe 'Do sth..' do\n  it { should validate_presence_of :some_attribute }    \nend\n</code></pre>\n\n<p>In my model I have\nBut I am getting </p>\n\n<pre><code>class Order &lt; ApplicationRecord\n  has_one :sub_order, inverse_of: :order, dependent: :destroy\n\n  validates_presence_of :some_attribute\n\n  delegate(\n    :some_attributes1,\n    to: :sub_order\n  )\nend\n</code></pre>\n\n<blockquote>\n  <p>Module::DelegationError:\n         Order#some_attributes1 delegated to sub_order.some_attributes1, but sub_order is nil: #\n</blockquote>\n\n<p>Can any help me please? \nThanks in advance!</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "rspec", "haversine"], "comments": [{"owner": {"reputation": 21613, "user_id": 580346, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/ba17945a06aac247b06548d5afe341e8?s=128&d=identicon&r=PG", "display_name": "mrzasa", "link": "https://stackoverflow.com/users/580346/mrzasa"}, "edited": false, "score": 0, "creation_date": 1543919662, "post_id": 53610865, "comment_id": 94082950, "body": "could you post full stacktrace?"}, {"owner": {"reputation": 21613, "user_id": 580346, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/ba17945a06aac247b06548d5afe341e8?s=128&d=identicon&r=PG", "display_name": "mrzasa", "link": "https://stackoverflow.com/users/580346/mrzasa"}, "edited": false, "score": 0, "creation_date": 1543919794, "post_id": 53610865, "comment_id": 94083027, "body": "What does <code>Store.current</code> return? Are you sure all the stores that are returned have lat/long set?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user9569059"}, "reply_to_user": {"reputation": 21613, "user_id": 580346, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/ba17945a06aac247b06548d5afe341e8?s=128&d=identicon&r=PG", "display_name": "mrzasa", "link": "https://stackoverflow.com/users/580346/mrzasa"}, "edited": false, "score": 0, "creation_date": 1543920334, "post_id": 53610865, "comment_id": 94083322, "body": "Thanks, you&#39;re right by default the project create on default store that doesn&#39;t have lat/long value, I&#39;ll fix that"}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user9569059"}, "edited": false, "score": 0, "creation_date": 1543922313, "post_id": 53611289, "comment_id": 94084365, "body": "good catch you&#39;re right, I fixed that now I got this error on  &quot;it &quot;should return an array of distances&quot; do       expect( response.body ).to have_node(distances)     end&quot;  I got this on my terminal :       Failure/Error: expect( response.body ).to have_node(@distances)        expected to have node called: &#39;[]&#39;. Got: &#39;{&quot;distances&quot;:&quot;[{\\&quot;name\\&quot;:\\&quot;Moulin EURL-533\\&quot;,\\&quot;value\\&quot;:0.78}]&quot;}&#39;"}, {"owner": {"reputation": 21613, "user_id": 580346, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/ba17945a06aac247b06548d5afe341e8?s=128&d=identicon&r=PG", "display_name": "mrzasa", "link": "https://stackoverflow.com/users/580346/mrzasa"}, "edited": false, "score": 0, "creation_date": 1543922569, "post_id": 53611289, "comment_id": 94084491, "body": "<code>distances</code> or <code>@distances</code> is empty"}, {"owner": {"user_type": "does_not_exist", "display_name": "user9569059"}, "edited": false, "score": 0, "creation_date": 1543922670, "post_id": 53611289, "comment_id": 94084549, "body": "this is a good result : Got: &#39;{&quot;distances&quot;:&quot;[{\\&quot;name\\&quot;:\\&quot;Moulin EURL-533\\&quot;,\\&quot;value\\&quot;:0.78}]&quot;}&#39; ----------- i want to test it if it&#39;s an array of hash ! can you help !"}], "tags": [], "owner": {"reputation": 21613, "user_id": 580346, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/ba17945a06aac247b06548d5afe341e8?s=128&d=identicon&r=PG", "display_name": "mrzasa", "link": "https://stackoverflow.com/users/580346/mrzasa"}, "is_accepted": false, "score": 0, "last_activity_date": 1543920710, "creation_date": 1543920710, "answer_id": 53611289, "question_id": 53610865, "link": "https://stackoverflow.com/questions/53610865/rspec-ruby-on-rails-haversine-gem-return-nil-value-when-write-unit-test/53611289#53611289", "title": "Rspec ruby on rails : Haversine gem return nil value when write unit test", "body": "<p>It seems that one of the stores have <code>nil</code> lat or long. Ensure that all stores returned from <code>Store.current</code> have initialized coordinates.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user9569059"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 45, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1543920710, "creation_date": 1543919423, "question_id": 53610865, "link": "https://stackoverflow.com/questions/53610865/rspec-ruby-on-rails-haversine-gem-return-nil-value-when-write-unit-test", "title": "Rspec ruby on rails : Haversine gem return nil value when write unit test", "body": "<p>I used Rspec to test a methode writen to mesure distance between to points with Haversine gem : </p>\n\n<pre><code># GET /api/v1/angular/sites/:id/distances\n  def stores_distances\n    site     = Site.find params[ :id ]\n    distances = Store.current.map do |store|\n      {\n        name: store.name,\n        value: Haversine.distance(\n                site.address.latitude,\n                site.address.longitude,\n                store.address.latitude,\n                store.address.longitude\n              ).round(2)\n      }\n    end\n\n    render json: {\n      distances: distances.to_json\n    }\n  end\n</code></pre>\n\n<p>I want to test 2 cases : if the method return a 200 status, return an array of distances.</p>\n\n<p>here what I did : </p>\n\n<pre><code>describe \" GET #stores_distances\" do\n    before :each do\n      @site_address   = create :address, latitude: 48.85837009999999, longitude: 2.2944813000000295\n      @store_address  = create :address, latitude: 48.8633604, longitude: 2.30189710000002\n      @site    = create :site, address: @site_address\n      @store   = create :store, address: @store_address\n\n      get :stores_distances, params: { id: @site.id }\n    end\n\n    it \"should return 200\" do\n      expect( response.status ).to be_ok\n    end\n\n    it \"should return an array of distances\" do\n      expect( response.body ).to have_node(distances)\n    end\nend\n</code></pre>\n\n<p>I got this error : </p>\n\n<blockquote>\n  <p>Api::V1::Angular::SitesController  GET #stores_distances should\n  return 200\n       Failure/Error:\n         value: Haversine.distance(\n                 site.address.latitude,\n                 site.address.longitude,\n                 store.address.latitude,\n                 store.address.longitude\n               ).round(2)</p>\n\n<pre><code> TypeError:\n   nil can't be coerced into Float\n</code></pre>\n</blockquote>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 3, "creation_date": 1543920135, "post_id": 53610273, "comment_id": 94083212, "body": "The block passed to <code>Enumerator.new</code> is executed when you call <code>next</code> for the first time. Execution is however paused each time <code>yielder.yield</code> is called, so <code>loop</code> doesn&#39;t keep running. Calling <code>next</code> from the outside effectively causes the internal <code>loop</code> to do one iteration."}], "answers": [{"tags": [], "owner": {"reputation": 167912, "user_id": 240443, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/495d675e3bc42ed1dee469e2ce701f1b?s=128&d=identicon&r=PG", "display_name": "Amadan", "link": "https://stackoverflow.com/users/240443/amadan"}, "is_accepted": false, "score": 4, "last_activity_date": 1543920641, "creation_date": 1543920641, "answer_id": 53611275, "question_id": 53610273, "link": "https://stackoverflow.com/questions/53610273/cant-understand-the-triagle-number-enumerator-yielder-yield/53611275#53611275", "title": "cant understand the triagle number enumerator yielder yield", "body": "<p><code>Enumerator::new</code> accepts a block. This block, when run, receives an <code>Enumerator::Yielder</code>, which has a method <code>#yield</code>.</p>\n\n<p>When the <code>Enumerator#next</code> is called, the block is executed, up to the first <code>Enumerator::Yielder#yield</code>. The execution is paused there; the value given to <code>yield</code> is the value that <code>next</code> returns. When you call <code>next</code> again on the same <code>Enumerator</code>, the execution is resumed, and proceeds until it encounters <code>yield</code> again.</p>\n\n<hr>\n\n<p>So in your case, <code>5.times</code> executes its block, intending to repeat it five times. <code>triangular_numbers.next</code> is called; this starts the execution of the block above. <code>number</code> and <code>count</code> are set to their values, and an infinite loop is started. <code>number</code> is set to <code>1</code>, <code>count</code> is set to <code>2</code>, and then we find <code>yielder.yield</code>. This pauses the execution of the block, and returns the control back to where <code>next</code> was called inside <code>5.times</code> loop. <code>next</code> returns <code>1</code>, because <code>yielder.yield</code> received <code>number</code> (<code>1</code>).</p>\n\n<p>Second time through the <code>5.times</code> loop, we want to print the next number. This stops the main execution line, and resumes the enumerator block from just after <code>yielder.yield</code>. The infinite loop continues; <code>number</code> is <code>3</code>, <code>count</code> is <code>3</code>, <code>yielder.yield</code> pauses the enumerator and resumes the main code. <code>next</code> gets <code>3</code>, which gets printed.</p>\n\n<p>Third, fourth and fifth time through the <code>5.times</code> loop are exactly the same.</p>\n\n<p>After five iterations, <code>5.times</code> loop ends, and the execution proceeds past it. The enumerator is paused, ready to give the next number in sequence, if you ever call <code>next</code> on it again (since it has an infinite loop), but you never do, and the program exits.</p>\n"}, {"tags": [], "owner": {"reputation": 1416, "user_id": 8656126, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a097761015b0c2b723f22eb4d239b3e6?s=128&d=identicon&r=PG&f=1", "display_name": "richflow", "link": "https://stackoverflow.com/users/8656126/richflow"}, "is_accepted": true, "score": 4, "last_activity_date": 1543921483, "last_edit_date": 1543921483, "creation_date": 1543921012, "answer_id": 53611380, "question_id": 53610273, "link": "https://stackoverflow.com/questions/53610273/cant-understand-the-triagle-number-enumerator-yielder-yield/53611380#53611380", "title": "cant understand the triagle number enumerator yielder yield", "body": "<p>An <a href=\"https://ruby-doc.org/core-2.5.3/Enumerator.html\" rel=\"nofollow noreferrer\">enumerator</a> is basically something that you can call <code>next</code> on and get something back. The <code>yielder</code> is the mechanism where it gives something back when <code>next</code> is called. Execution stops at the <code>yield</code> until the next call to <code>next</code>.</p>\n\n<p><strong>Farfetched analogy</strong></p>\n\n<p>You can think of an <code>enumerator</code> as a <strong>ticket machine</strong> like when you're waiting in line at a government office. When you press a button (<code>next</code>) it gives you a <strong>ticket</strong>. Inside the machine there's a <strong>chute</strong> where the ticket comes out. But the ticket machine is not constantly printing tickets. It waits for the button to be pressed before it prints the next ticket and puts it through the chute.</p>\n\n<p>In this case the analogous code would be:</p>\n\n<pre><code>ticket_machine = Enumerator.new do |chute|\n ticket = 0\n loop do\n    #print_ticket\n    chute.yield ticket #waits here until you hit the button\n    ticket += 1\n  end\n end\n5.times { print ticket_machine.next, \" \" } # gets 5 tickets\n</code></pre>\n\n<p>Your code sample is basically the same thing, but instead of issuing tickets, it's issuing triangular numbers. The <strong>chute</strong> is the <code>yielder</code> where the numbers get passed through.</p>\n\n<p>This is not the only way to use an enumerator, <a href=\"https://ruby-doc.org/core-2.5.3/Enumerator.html\" rel=\"nofollow noreferrer\">check the docs for more.</a></p>\n"}, {"comments": [{"owner": {"reputation": 167912, "user_id": 240443, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/495d675e3bc42ed1dee469e2ce701f1b?s=128&d=identicon&r=PG", "display_name": "Amadan", "link": "https://stackoverflow.com/users/240443/amadan"}, "edited": false, "score": 0, "creation_date": 1543926887, "post_id": 53611780, "comment_id": 94086938, "body": "&quot;(All Enumerators are implemented as &quot;Fibers&quot; on MRI)&quot; - nitpick, but not quite: both <code>Enumerator</code> and <code>Fiber</code> are implemented in C, a layer below Ruby classes; but they share a lot of the underlying C code (i.e. <code>enumerator.c</code> uses functions defined in <code>cont.c</code> (named after the now deprecated <code>callcc</code>, which is like grandfather to fibers, which now also houses the underlying fiber code)."}, {"owner": {"reputation": 688, "user_id": 202613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/89806d4eddb1df26f1d75240011afa9d?s=128&d=identicon&r=PG", "display_name": "Mereghost", "link": "https://stackoverflow.com/users/202613/mereghost"}, "reply_to_user": {"reputation": 167912, "user_id": 240443, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/495d675e3bc42ed1dee469e2ce701f1b?s=128&d=identicon&r=PG", "display_name": "Amadan", "link": "https://stackoverflow.com/users/240443/amadan"}, "edited": false, "score": 0, "creation_date": 1544030452, "post_id": 53611780, "comment_id": 94134870, "body": "True, but way too technical for the short post. =)"}], "tags": [], "owner": {"reputation": 688, "user_id": 202613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/89806d4eddb1df26f1d75240011afa9d?s=128&d=identicon&r=PG", "display_name": "Mereghost", "link": "https://stackoverflow.com/users/202613/mereghost"}, "is_accepted": false, "score": 0, "last_activity_date": 1543922272, "creation_date": 1543922272, "answer_id": 53611780, "question_id": 53610273, "link": "https://stackoverflow.com/questions/53610273/cant-understand-the-triagle-number-enumerator-yielder-yield/53611780#53611780", "title": "cant understand the triagle number enumerator yielder yield", "body": "<p>I'll try to explain what it does bit by bit, so you can try to wrap your head around it.</p>\n\n<pre><code>Enumerator.new do |yielder|\nend\n</code></pre>\n\n<p>So you instantiate an enumerator that will work over a variable called <code>yielder</code>.</p>\n\n<p>Inside its scope you set some local vars (that will be kept as the object is reused):</p>\n\n<pre><code> number = 0\n count = 1\n</code></pre>\n\n<p>And then you set a loop that increments <code>number</code> by <code>count</code> and <code>count</code> by <code>1</code> and then call yield over your argument passing <code>number</code> to it as an argument.</p>\n\n<pre><code>loop do\n  number += count\n  count += 1\n  yielder.yield number  \nend\n</code></pre>\n\n<p><code>5.times</code> repeats the block passed to it 5 times. The block </p>\n\n<pre><code>-&gt; { print triangular_numbers.next, \" \" }\n</code></pre>\n\n<p>calls <code>print</code> that takes <code>n</code> args and concatenates the parts to form a string, but does not append a newline.</p>\n\n<p>The first argument is our enumerator next interaction (<code>triangular_numbers.next</code>), which will compute the current number and call yield on the <code>Enumerator::Yielder</code> that's implicitly created handling the control back to the calling <code>Fiber</code> along with any args that got passed to it.</p>\n\n<p>(All Enumerators are implemented as \"Fibers\" on MRI)</p>\n\n<p>So that <code>yielder.yield</code> call is similar to a <code>Fiber.yield</code> call and will allow the  <code>5.times</code> loop to run and return the <code>number</code> 1.</p>\n"}, {"tags": [], "owner": {"reputation": 9663, "user_id": 5239030, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/76JEw.png?s=128&g=1", "display_name": "iGian", "link": "https://stackoverflow.com/users/5239030/igian"}, "is_accepted": false, "score": 0, "last_activity_date": 1543924643, "last_edit_date": 1543924643, "creation_date": 1543924079, "answer_id": 53612300, "question_id": 53610273, "link": "https://stackoverflow.com/questions/53610273/cant-understand-the-triagle-number-enumerator-yielder-yield/53612300#53612300", "title": "cant understand the triagle number enumerator yielder yield", "body": "<p>I'm adding a piece of code to the already clear explanation provided:</p>\n\n<pre><code>my_enum = Enumerator.new do |whatever_name_for_the_yielder|\n  n = 0\n  loop do\n    whatever_name_for_the_yielder.yield \"Return this: #{n}\"\n    n += 1\n  end\nend\n\nputs my_enum.next #=&gt; Return this: 0\nputs my_enum.next #=&gt; Return this: 1\nputs my_enum.next #=&gt; Return this: 2\n</code></pre>\n\n<p>When you provide an end to the iteration, it stops with an error:</p>\n\n<pre><code>my_enum2 = Enumerator.new do |whatever_name_for_the_yielder|\n  2.times do |n|\n    whatever_name_for_the_yielder.yield \"Return this: #{n}\"\n  end\n  puts \"Outside the loop\"\nend\n\nputs my_enum2.next #=&gt; Return this: 0\nputs my_enum2.next #=&gt; Return this: 1\nputs my_enum2.next #=&gt; Outside the loop\n#=&gt; ERROR: .....in `next': iteration reached an end (StopIteration)\n</code></pre>\n"}], "owner": {"reputation": 85, "user_id": 8668262, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3141cf94999c45c14debe36549bfc180?s=128&d=identicon&r=PG&f=1", "display_name": "amarjeet singh", "link": "https://stackoverflow.com/users/8668262/amarjeet-singh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 51, "favorite_count": 0, "accepted_answer_id": 53611380, "answer_count": 4, "score": 2, "last_activity_date": 1543924643, "creation_date": 1543917665, "question_id": 53610273, "link": "https://stackoverflow.com/questions/53610273/cant-understand-the-triagle-number-enumerator-yielder-yield", "title": "cant understand the triagle number enumerator yielder yield", "body": "<p>unable to understand this code how it works.</p>\n\n<pre><code>triangular_numbers = Enumerator.new do |yielder|\n number = 0\n count = 1\n loop do\n    number += count\n    count += 1\n    yielder.yield number  \n  end\n end\n5.times { print triangular_numbers.next, \" \" }\n</code></pre>\n\n<p>cant understand how <code>yielder</code> works for this block. how its <code>yield</code> work for <code>number</code> variable. how do loop runs 5 times. and how <code>triangular_number.next</code> works for the first time.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "rspec"], "answers": [{"tags": [], "owner": {"reputation": 21613, "user_id": 580346, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/ba17945a06aac247b06548d5afe341e8?s=128&d=identicon&r=PG", "display_name": "mrzasa", "link": "https://stackoverflow.com/users/580346/mrzasa"}, "is_accepted": true, "score": 4, "last_activity_date": 1543916680, "creation_date": 1543916680, "answer_id": 53609912, "question_id": 53609740, "link": "https://stackoverflow.com/questions/53609740/ruby-on-rails-randomly-failing-rspec-tests/53609912#53609912", "title": "Ruby on Rails - Randomly failing RSpec tests", "body": "<p>You should not call external APIs in your tests. There are several methods to avoid it:</p>\n\n<ol>\n<li><a href=\"https://github.com/vcr/vcr\" rel=\"nofollow noreferrer\">VCR gem</a> records API response in first call then then replies it from disk (that is fast and reliable).</li>\n<li>Mocking HTTP calls, e.g. with <a href=\"https://github.com/bblimke/webmock\" rel=\"nofollow noreferrer\">WebMock</a>. You need to write specify mocked request and write a response in your specs. It may help you improve test readability also it helps in testing edge cases.</li>\n<li>Wrap your service call in your class and replace it with an RSpec stub.</li>\n<li>Wrap your service call in your class that accepts adapters. An adapter is responsible for calling external service. In test env pass a test adapter with predetermined responses.</li>\n</ol>\n"}], "owner": {"reputation": 119, "user_id": 7738138, "user_type": "registered", "accept_rate": 55, "profile_image": "https://graph.facebook.com/1728017913892004/picture?type=large", "display_name": "JiaPing", "link": "https://stackoverflow.com/users/7738138/jiaping"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 100, "favorite_count": 1, "accepted_answer_id": 53609912, "answer_count": 1, "score": 2, "last_activity_date": 1543916680, "creation_date": 1543916161, "last_edit_date": 1543916466, "question_id": 53609740, "link": "https://stackoverflow.com/questions/53609740/ruby-on-rails-randomly-failing-rspec-tests", "title": "Ruby on Rails - Randomly failing RSpec tests", "body": "<p>Sorry for my stupid question.</p>\n\n<p>I added the external api to get response in order to check zipcode's validation.</p>\n\n<p>app/validators/zipcode_validator.rb</p>\n\n<pre><code>class ZipcodeValidator &lt; ActiveModel::Validator\n  def validate(record)\n    record.errors.add(:zipcode, :blank) if record.zipcode.blank?\n    record.errors.add(:zipcode, :not_found) if WmsService.wms_delivery_dates(record.zipcode).nil?\n  end \nend\n</code></pre>\n\n<p>It works fine in real but failed randomly and took more time when I run rspec.</p>\n\n<p>What's the good solution for this situation?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "bootstrap-datepicker"], "comments": [{"owner": {"reputation": 21613, "user_id": 580346, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/ba17945a06aac247b06548d5afe341e8?s=128&d=identicon&r=PG", "display_name": "mrzasa", "link": "https://stackoverflow.com/users/580346/mrzasa"}, "edited": false, "score": 0, "creation_date": 1543915632, "post_id": 53609489, "comment_id": 94080326, "body": "could you post a link to the datepicker you use?"}, {"owner": {"reputation": 1885, "user_id": 3018671, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/w0vV4.jpg?s=128&g=1", "display_name": "NicuVlad", "link": "https://stackoverflow.com/users/3018671/nicuvlad"}, "reply_to_user": {"reputation": 21613, "user_id": 580346, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/ba17945a06aac247b06548d5afe341e8?s=128&d=identicon&r=PG", "display_name": "mrzasa", "link": "https://stackoverflow.com/users/580346/mrzasa"}, "edited": false, "score": 0, "creation_date": 1543915856, "post_id": 53609489, "comment_id": 94080474, "body": "@mrzasa, I adapted the question"}], "answers": [{"comments": [{"owner": {"reputation": 1885, "user_id": 3018671, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/w0vV4.jpg?s=128&g=1", "display_name": "NicuVlad", "link": "https://stackoverflow.com/users/3018671/nicuvlad"}, "edited": false, "score": 0, "creation_date": 1543919112, "post_id": 53609796, "comment_id": 94082623, "body": "I managed to create the range but it still allows me to select an end date smaller than the start date"}, {"owner": {"reputation": 21613, "user_id": 580346, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/ba17945a06aac247b06548d5afe341e8?s=128&d=identicon&r=PG", "display_name": "mrzasa", "link": "https://stackoverflow.com/users/580346/mrzasa"}, "reply_to_user": {"reputation": 1885, "user_id": 3018671, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/w0vV4.jpg?s=128&g=1", "display_name": "NicuVlad", "link": "https://stackoverflow.com/users/3018671/nicuvlad"}, "edited": false, "score": 0, "creation_date": 1543919527, "post_id": 53609796, "comment_id": 94082878, "body": "I can&#39;t see any option for this, you probably have to write some simple JS."}, {"owner": {"reputation": 1885, "user_id": 3018671, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/w0vV4.jpg?s=128&g=1", "display_name": "NicuVlad", "link": "https://stackoverflow.com/users/3018671/nicuvlad"}, "edited": false, "score": 0, "creation_date": 1543919545, "post_id": 53609796, "comment_id": 94082884, "body": "Yes, I will do that."}], "tags": [], "owner": {"reputation": 21613, "user_id": 580346, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/ba17945a06aac247b06548d5afe341e8?s=128&d=identicon&r=PG", "display_name": "mrzasa", "link": "https://stackoverflow.com/users/580346/mrzasa"}, "is_accepted": false, "score": 1, "last_activity_date": 1543916360, "creation_date": 1543916360, "answer_id": 53609796, "question_id": 53609489, "link": "https://stackoverflow.com/questions/53609489/bootstrap-datepicker-for-ruby-disable-dates/53609796#53609796", "title": "Bootstrap datepicker for Ruby, disable dates", "body": "<p>You can use <a href=\"https://bootstrap-datepicker.readthedocs.io/en/stable/markup.html#daterange\" rel=\"nofollow noreferrer\"><code>date-range</code> option</a>, prob. like this:</p>\n\n<pre><code>&lt;div class=\"input-group input-daterange\"&gt;\n   &lt;!-- your start_date and end_date inputs go here --&gt;\n&lt;/div&gt;\n</code></pre>\n"}], "owner": {"reputation": 1885, "user_id": 3018671, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/w0vV4.jpg?s=128&g=1", "display_name": "NicuVlad", "link": "https://stackoverflow.com/users/3018671/nicuvlad"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 174, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1544081091, "creation_date": 1543915379, "last_edit_date": 1544081091, "question_id": 53609489, "link": "https://stackoverflow.com/questions/53609489/bootstrap-datepicker-for-ruby-disable-dates", "title": "Bootstrap datepicker for Ruby, disable dates", "body": "<p>I need to create 2 date inputs(start and end date) using Bootstrap datepicker for Ruby and it looks like this:</p>\n\n<pre><code>&lt;div class=\"form-group\"&gt;\n  &lt;%= label_tag :import_start_date, I18n.t('modal.form.start_date'), class: 'col-lg-3 control-label required' %&gt;\n  &lt;div class=\"col-lg-8\"&gt;\n    &lt;div class=\"bs-component\"&gt;\n\n      &lt;%= text_field_tag 'start_date',\n        Date.current.to_s,\n        class: 'form-control',\n        'data-provide' =&gt; 'datepicker',\n        'data-date-format' =&gt; 'yyyy-mm-dd',\n        placeholder: I18n.t('modal.form.start_date'),\n        autocomplete: 'off' %&gt;\n\n    &lt;/div&gt;\n  &lt;/div&gt;\n&lt;/div&gt;\n&lt;div class=\"row\" style=\"border: 0\"&gt;\n  &lt;div class=\"form-group\"&gt;\n    &lt;%= label_tag :import_end_date, I18n.t('modal.form.end_date'), class: 'col-lg-3 control-label required' %&gt;\n    &lt;div class=\"col-lg-8\"&gt;\n      &lt;div class=\"bs-component\"&gt;\n\n        &lt;%= text_field_tag 'end_date',\n          Date.current.to_s,\n          class: 'form-control',\n          'data-provide' =&gt; 'datepicker',\n          'data-date-format' =&gt; 'yyyy-mm-dd',\n          placeholder: I18n.t('modal.form.end_date'),\n          autocomplete: 'off'%&gt;\n\n      &lt;/div&gt;\n    &lt;/div&gt;\n  &lt;/div&gt;\n&lt;/div&gt;\n</code></pre>\n\n<p>Everything works, but I need to add some sort of validation so that the user can't select an \"end_date\" smaller than the \"start_date\" and vice versa. \nI searched the Internet and I found how to do it using Jquery. But I was wandering if there are some properties that I can use to avoid writing JavaScript code.</p>\n\n<p>Any ideas?</p>\n\n<p>The datepicker that I use:\n<a href=\"https://github.com/Nerian/bootstrap-datepicker-rails\" rel=\"nofollow noreferrer\">https://github.com/Nerian/bootstrap-datepicker-rails</a></p>\n"}, {"tags": ["ruby", "go", "ffi", "cgo"], "comments": [{"owner": {"reputation": 3542, "user_id": 5033611, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/47a91063fb01317639d57d5fc9c9d9c7?s=128&d=identicon&r=PG", "display_name": "ssemilla", "link": "https://stackoverflow.com/users/5033611/ssemilla"}, "edited": false, "score": 1, "creation_date": 1543921138, "post_id": 53608352, "comment_id": 94083734, "body": "<code>cstr</code> is already free&#39;d after <code>login()</code>. Try removing <code>defer C.free()</code> and manage the memory in Ruby."}], "answers": [{"tags": [], "owner": {"reputation": 3542, "user_id": 5033611, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/47a91063fb01317639d57d5fc9c9d9c7?s=128&d=identicon&r=PG", "display_name": "ssemilla", "link": "https://stackoverflow.com/users/5033611/ssemilla"}, "is_accepted": true, "score": 3, "last_activity_date": 1543938928, "creation_date": 1543938928, "answer_id": 53616785, "question_id": 53608352, "link": "https://stackoverflow.com/questions/53608352/how-to-return-string-from-function-to-ruby-with-cgo/53616785#53616785", "title": "How to return string from function to Ruby with CGO", "body": "<p>As stated in the comments, <code>cstr</code> gets free'd after control has been passed to Ruby. Here is a workaround where you explicitly manage the pointer in Ruby.</p>\n\n<pre><code>package main\n\n// #include &lt;stdlib.h&gt;\nimport \"C\"\nimport \"unsafe\"\n\n//export login\nfunc login(user *C.char) *C.char {\n    return C.CString(\"Hello from Go\")\n}\n\n//export logout\nfunc logout(c *C.char) {\n    C.free(unsafe.Pointer(c))\n}\n\nfunc main() {}\n</code></pre>\n\n<p>In Ruby:</p>\n\n<pre><code>require 'ffi'\n\nmodule GoLib\n  extend FFI::Library\n  ffi_lib './so.so'\n\n  attach_function :login, [:string], :strptr\n  attach_function :logout, [:pointer], :void\nend\n\ns, p = GoLib.login(\"User1\")\nputs s\np = FFI::AutoPointer.new(p, GoLib.method(:logout))\n</code></pre>\n\n<p>Note the use of <code>strptr</code> as demonstrated <a href=\"https://github.com/ffi/ffi/wiki/Pointers#fresh-strings\" rel=\"nofollow noreferrer\">here</a></p>\n"}], "owner": {"reputation": 512, "user_id": 2875733, "user_type": "registered", "accept_rate": 58, "profile_image": "https://graph.facebook.com/632666023/picture?type=large", "display_name": "Gavin Yap", "link": "https://stackoverflow.com/users/2875733/gavin-yap"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 241, "favorite_count": 0, "accepted_answer_id": 53616785, "answer_count": 1, "score": 0, "last_activity_date": 1543938928, "creation_date": 1543911042, "last_edit_date": 1543911529, "question_id": 53608352, "link": "https://stackoverflow.com/questions/53608352/how-to-return-string-from-function-to-ruby-with-cgo", "title": "How to return string from function to Ruby with CGO", "body": "<p>I have a function in Go:   </p>\n\n<pre><code>func login(user *C.char) *C.char {\n    cstr := C.CString(\"Hello World\")\n    defer C.free(unsafe.Pointer(cstr))\n    return cstr \n}\n</code></pre>\n\n<p>My ruby code as below</p>\n\n<pre><code>module GoLib\n  extend FFI::Library\n  ffi_lib './golib.so'\n\n  attach_function :login, [:string], :string\nend\n\nGoLib.login(\"User1\") #=&gt; \"p\\x9A\\xA0\\xDB\\x16V\"\n</code></pre>\n\n<p>it does not return as ruby string. How to I fix this? </p>\n"}, {"tags": ["ruby", "soap", "savon"], "answers": [{"tags": [], "owner": {"reputation": 2546, "user_id": 2603130, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/60f46755895fd7c8bfa4f39d527ba9a8?s=128&d=identicon&r=PG", "display_name": "radubogdan", "link": "https://stackoverflow.com/users/2603130/radubogdan"}, "is_accepted": false, "score": 0, "last_activity_date": 1545053700, "creation_date": 1545053700, "answer_id": 53816354, "question_id": 53608345, "link": "https://stackoverflow.com/questions/53608345/per-request-namespaces-in-savon-ruby-gem/53816354#53816354", "title": "Per request namespaces in savon ruby gem", "body": "<p>To answer my own question, I don't think savon can followup namespaces. However after digging in savon's code I realized I can hack around the problem since SOAP requests are not that vital for my application.</p>\n\n<p>Here is a nice solution to deal with multiple namespaces:</p>\n\n<pre><code>  def login_request\n    request = Savon::SOAPRequest.new(globals).build(\n      soap_action: :login,\n      cookies: locals[:cookies],\n      headers: locals[:headers]\n    )\n    request.headers['Content-Type'] = 'application/soap+xml'\n    request.url = @url\n    request.body = login_xml_string\n    HTTPI.post(request)\n  end\n\n\n  def globals\n    @_globals ||= Savon::GlobalOptions.new\n  end\n\n  def locals\n    @_locals ||= Savon::LocalOptions.new\n  end\n</code></pre>\n\n<p>Where <code>login_xml_string</code> is a method that returns a stringify SOAP envelope based on a <code>xml.erb</code> file. E.g.</p>\n\n<pre><code>def login_xml_string\n  @view_paths.render(file: 'app/views/path/to/file/login.xml.erb',\n    locals: { user_name: @username, password: @password, url: @url}\n  ).gsub(/\\n[\\s+]{0,}/, '')\nend\n</code></pre>\n\n<p>And <code>@view_paths</code> is set to  <code>ActionView::Base.new(ActionController::Base.view_paths, {})</code></p>\n\n<p>The same goes for the rest SOAP actions I need to call.</p>\n\n<p>I'm not saying this is the best approach but it made my life easier dealing with namespaces by passing them in locals.</p>\n"}], "owner": {"reputation": 2546, "user_id": 2603130, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/60f46755895fd7c8bfa4f39d527ba9a8?s=128&d=identicon&r=PG", "display_name": "radubogdan", "link": "https://stackoverflow.com/users/2603130/radubogdan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 97, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1545053700, "creation_date": 1543911007, "question_id": 53608345, "link": "https://stackoverflow.com/questions/53608345/per-request-namespaces-in-savon-ruby-gem", "title": "Per request namespaces in savon ruby gem", "body": "<p>I need to send a request like:</p>\n\n<pre><code>&lt;env:Envelope xmlns:env=\"http://www.w3.org/2003/05/soap-envelope\" xmlns:ns1=\"http://tempuri.org/\" xmlns:ns2=\"http://www.w3.org/2005/08/addressing\"&gt;\n   &lt;env:Header&gt;\n      &lt;ns2:Action&gt;http://tempuri.org/IDataImportService/Login&lt;/ns2:Action&gt;\n      &lt;ns2:To&gt;https://URLHERE.svc&lt;/ns2:To&gt;\n   &lt;/env:Header&gt;\n   &lt;env:Body&gt;\n      &lt;ns1:Login&gt;\n         &lt;ns1:userName&gt;USERNAME&lt;/ns1:userName&gt;\n         &lt;ns1:password&gt;PASSWORD&lt;/ns1:password&gt;\n      &lt;/ns1:Login&gt;\n   &lt;/env:Body&gt;\n&lt;/env:Envelope&gt;\n</code></pre>\n\n<p>To accomplish that I can hack around Savon.</p>\n\n<p>Now my understand is Savon is looking at the WSDL to figure out what namespace to add. There is a thing called <a href=\"http://savonrb.com/version2/globals.html\" rel=\"nofollow noreferrer\">element_form_default</a> which slightly does what I want in combination with <code>namespace_identifier</code> and manual patch of <code>soap_header</code> in <code>call</code> E.g.</p>\n\n<pre><code>client = Savon.client(\n  wsdl: 'https://urlhere.svc?wsdl',\n  log: true,\n  soap_version: 2,\n  pretty_print_xml: true,\n  log_level: :debug,\n  namespaces: {\n    'xmlns:ns1' =&gt; 'http://tempuri.org/',\n    'xmlns:ns2' =&gt; 'http://www.w3.org/2005/08/addressing'\n  },\n  namespace_identifier: 'ns1',\n  element_form_default: :qualified\n)\n\nclient.call(\n  :login,\n  message: {\n    'userName' =&gt; USERNAME,\n    'password' =&gt; PASSWORD,\n  },\n  soap_header: {\n    'ns2:Action' =&gt; 'http://tempuri.org/IDataImportService/Login',\n    'ns2:To' =&gt; 'https://urlhere.svc'\n  }\n)\n</code></pre>\n\n<p>I'll leave it like this if I didn't have to make another request with 3 different namespaces and pass the context of login... </p>\n\n<p>The questions I have are:</p>\n\n<ol>\n<li>Is there a way to avoid manual patching of those namespaces?</li>\n<li>Why is it working correctly in php with SOAP services? </li>\n</ol>\n\n<p>E.g. of what I need co accomplish in next request:</p>\n\n<pre><code>&lt;env:Envelope xmlns:env=\"http://www.w3.org/2003/05/soap-envelope\" xmlns:ns1=\"http://schemas.datacontract.org/2004/07/Common.DataContracts\" xmlns:ns2=\"http://tempuri.org/\" xmlns:ns3=\"http://www.w3.org/2005/08/addressing\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"&gt;\n   &lt;env:Header&gt;\n      &lt;ns3:Action&gt;http://tempuri.org/IDataImportService/CreateLead&lt;/ns3:Action&gt;\n      &lt;ns3:To&gt;https://URLHERE.svc&lt;/ns3:To&gt;\n   &lt;/env:Header&gt;\n   &lt;env:Body&gt;\n      &lt;ns2:CreateLead&gt;\n         &lt;ns2:autoItContext&gt;\n            &lt;ns1:AddressNamePrimary xsi:nil=\"true\" /&gt;\n            &lt;ns1:Addresshousenumber xsi:nil=\"true\" /&gt;\n            &lt;ns1:Addressstreet xsi:nil=\"true\" /&gt;\n         &lt;/ns2:autoItContext&gt;\n         &lt;ns2:companyId&gt;111&lt;/ns2:companyId&gt;\n         &lt;ns2:description&gt;&lt;/ns2:description&gt;\n         &lt;ns2:leadData&gt;\n            &lt;ns1:C_Address xsi:nil=\"true\" /&gt;\n            &lt;ns1:C_Address2 xsi:nil=\"true\" /&gt;\n            &lt;ns1:C_CellPhoneNumber xsi:nil=\"true\" /&gt;\n            &lt;ns1:C_City xsi:nil=\"true\" /&gt;\n            &lt;ns1:C_CprNumber1 xsi:nil=\"true\" /&gt;\n            &lt;ns1:C_CvrNumber xsi:nil=\"true\" /&gt;\n            &lt;ns1:C_Email&gt;email@email.com&lt;/ns1:C_Email&gt;\n         &lt;/ns2:leadData&gt;\n         &lt;ns2:checkForDuplicates&gt;false&lt;/ns2:checkForDuplicates&gt;\n         &lt;ns2:listId xsi:nil=\"true\" /&gt;\n      &lt;/ns2:CreateLead&gt;\n   &lt;/env:Body&gt;\n&lt;/env:Envelope&gt;\n</code></pre>\n"}, {"tags": ["ruby", "macos", "installation", "rubygems", "jekyll"], "owner": {"reputation": 43, "user_id": 9150131, "user_type": "registered", "profile_image": "https://graph.facebook.com/546822595685098/picture?type=large", "display_name": "Aniket Raj", "link": "https://stackoverflow.com/users/9150131/aniket-raj"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 189, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1543955495, "creation_date": 1543908587, "question_id": 53607775, "link": "https://stackoverflow.com/questions/53607775/jekyll-installation-on-macos-mojave-10-14", "title": "Jekyll installation on macOS Mojave 10.14", "body": "<p>Can anyone provide me the complete guide of installing jekyll in the latest macOS 10.14?</p>\n\n<p>As you might know that the directory is protected in macOS and returns error</p>\n\n<pre><code>While executing gem ... (Gem::FilePermissionError)\n    You don't have write permissions for the /Library/Ruby/Gems/2.3.0 directory.\n</code></pre>\n\n<p>I have tried all the methods available on internet like managing multiple versions of ruby using <code>rbenv</code> or exporting path <code>export PATH=\"/usr/local/opt/ruby/bin:$PATH\"</code> to the .bashrc file.`</p>\n\n<p>None of the methods seem to be working for me. Please provide step by step installation guide of <code>jekyll</code> on macOS.</p>\n"}, {"tags": ["ruby"], "answers": [{"comments": [{"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 3, "creation_date": 1543909623, "post_id": 53607850, "comment_id": 94077380, "body": "Alternatively <code>(acc &lt;&lt; 8) + byte</code>"}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 3, "creation_date": 1543910057, "post_id": 53607850, "comment_id": 94077551, "body": "Alternatively, <code>acc  &lt;&lt;  8  | byte</code>"}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "reply_to_user": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 2, "creation_date": 1543910169, "post_id": 53607850, "comment_id": 94077599, "body": "@CarySwoveland of course! You don&#39;t even need the parentheses when using <code>|</code>."}, {"owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 0, "creation_date": 1543910575, "post_id": 53607850, "comment_id": 94077753, "body": "Forget about my previous comment here."}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 3, "creation_date": 1543910616, "post_id": 53607850, "comment_id": 94077776, "body": "@sawa no worries, my attention span is like 5 seconds ^_^"}], "tags": [], "owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "is_accepted": true, "score": 5, "last_activity_date": 1543909381, "last_edit_date": 1543909381, "creation_date": 1543908905, "answer_id": 53607850, "question_id": 53607543, "link": "https://stackoverflow.com/questions/53607543/more-elegant-way-to-convert-4-bytes-to-32bit-integer/53607850#53607850", "title": "More elegant way to convert 4 bytes to 32bit integer", "body": "<p>If you have one byte, that would be the result as is. If you add one byte to the right side, that would make the original result move two positions to the left (which means multiplying by 0x100, or 16 ** 2 = 256), and add the new byte. You can repeat this as many times as there are bytes.</p>\n\n<pre><code>a.inject{|acc, byte| acc * 0x100 + byte}\n# =&gt; 1069568\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 3, "creation_date": 1543909637, "post_id": 53608012, "comment_id": 94077382, "body": "Less than 20 seconds ago I was reading this question and thinking this sounds like a <code>pack&#47;unpack</code> question, musing that it was too bad that Stefan was not on this. Then, bam, your answer appeared!"}], "tags": [], "owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "is_accepted": false, "score": 6, "last_activity_date": 1543909791, "last_edit_date": 1543909791, "creation_date": 1543909531, "answer_id": 53608012, "question_id": 53607543, "link": "https://stackoverflow.com/questions/53607543/more-elegant-way-to-convert-4-bytes-to-32bit-integer/53608012#53608012", "title": "More elegant way to convert 4 bytes to 32bit integer", "body": "<p>Using <a href=\"http://ruby-doc.org/core-2.5.3/Array.html#method-i-pack\" rel=\"nofollow noreferrer\"><code>pack</code></a> and <a href=\"http://ruby-doc.org/core-2.5.3/String.html#method-i-unpack1\" rel=\"nofollow noreferrer\"><code>unpack1</code></a>:</p>\n\n<pre><code>a = [0, 16, 82, 0]\n\na.pack('C4').unpack1('L&gt;')\n#=&gt; 1069568\n</code></pre>\n\n<p><code>C4</code> means 8-bit unsigned (4 times) and <code>L&gt;</code> means 32-bit unsigned (big endian).</p>\n\n<p>However, <code>pack</code> returns a binary string, so this is not string-free.</p>\n"}], "owner": {"reputation": 156, "user_id": 4090677, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/143f0ed80131aff38ee51b2384e313c0?s=128&d=identicon&r=PG", "display_name": "verm-luh", "link": "https://stackoverflow.com/users/4090677/verm-luh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 104, "favorite_count": 0, "accepted_answer_id": 53607850, "answer_count": 2, "score": 3, "last_activity_date": 1543909791, "creation_date": 1543907669, "last_edit_date": 1543908564, "question_id": 53607543, "link": "https://stackoverflow.com/questions/53607543/more-elegant-way-to-convert-4-bytes-to-32bit-integer", "title": "More elegant way to convert 4 bytes to 32bit integer", "body": "<p>I'm converting arrays consisting of four byte values to 32bit numbers by executing the following code:</p>\n\n<pre><code>a = [0, 16, 82, 0]\ni = a.map { |e| \"%02x\" % e }.join.to_i(16)\n# =&gt; 1069568\n</code></pre>\n\n<p>It works as intended, but I wonder if there's a more elegant way to perform this task. Maybe not utilizing strings.</p>\n"}, {"tags": ["android", "ruby", "localhost", "google-chrome-devtools", "progressive-web-apps"], "answers": [{"tags": [], "owner": {"reputation": 12076, "user_id": 5832311, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/t6jqn.jpg?s=128&g=1", "display_name": "abielita", "link": "https://stackoverflow.com/users/5832311/abielita"}, "is_accepted": false, "score": 0, "last_activity_date": 1543939215, "last_edit_date": 1592644375, "creation_date": 1543939215, "answer_id": 53616866, "question_id": 53607375, "link": "https://stackoverflow.com/questions/53607375/chrome-devtools-remote-debugging-does-not-display-connected-mobile-devices-chro/53616866#53616866", "title": "Chrome DevTools Remote Debugging Does Not Display Connected Mobile Devices&#39; chrome version", "body": "<p>You may want to check the workaround in this <a href=\"https://stackoverflow.com/questions/51519636/google-chrome-developer-tools-android-debugging-returns-http-1-1-404-not-found\">thread</a>.</p>\n<blockquote>\n<p>Solution was to access through chrome://inspect/#devices</p>\n<p>Then select the &quot;Fallback&quot; option.</p>\n<p>This is because the remote browser was newer than the client browser\u2026\u2026</p>\n</blockquote>\n<p>While the PC is connected to the device via USB with the app open, go to <code>chrome://inspect/#devices</code> on the PC. You should see the name of the app and an &quot;inspect fallback&quot; link</p>\n"}], "owner": {"reputation": 11, "user_id": 10696688, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ASIjxC1Jke0/AAAAAAAAAAI/AAAAAAAAAA4/9YsmI6FBvw8/photo.jpg?sz=128", "display_name": "Cold Trane", "link": "https://stackoverflow.com/users/10696688/cold-trane"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1702, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1562464455, "creation_date": 1543906945, "last_edit_date": 1562464455, "question_id": 53607375, "link": "https://stackoverflow.com/questions/53607375/chrome-devtools-remote-debugging-does-not-display-connected-mobile-devices-chro", "title": "Chrome DevTools Remote Debugging Does Not Display Connected Mobile Devices&#39; chrome version", "body": "<p>I'm trying to remotely debug through my ruby localhost through the chrome development tools, and although I have established a connection to the USB connected device, the chrome version of the mobile browser is not displaying. </p>\n\n<p>Without that I'm unable to debug. What could be missing? I have already installed the necessary drivers to make the PC to mobile connection</p>\n\n<p><a href=\"https://i.stack.imgur.com/NP5BH.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/NP5BH.png\" alt=\"Screen shot of my development tools\"></a></p>\n"}, {"tags": ["jquery", "ruby-on-rails", "ruby", "jquery-select2"], "answers": [{"tags": [], "owner": {"reputation": 1243, "user_id": 10476417, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/07b57114718c234f1f44a28f5396026e?s=128&d=identicon&r=PG&f=1", "display_name": "Abhishek Aravindan", "link": "https://stackoverflow.com/users/10476417/abhishek-aravindan"}, "is_accepted": true, "score": 2, "last_activity_date": 1543908661, "creation_date": 1543908661, "answer_id": 53607796, "question_id": 53606834, "link": "https://stackoverflow.com/questions/53606834/select2-not-working-without-reloading-the-page/53607796#53607796", "title": "Select2 not working without reloading the page", "body": "<p>Finally found out solution for my question,I think the answer will help somebody who faces the same problem at research time.\nInstead of listening to event <code>$(document).ready(function()</code> , listen to event for <code>$( document ).on('turbolinks:load', function()</code> because rails use turbolinks.\nso we we should modify the code as:</p>\n\n<pre><code>$( document ).on('turbolinks:load', function() {\n    $( \"#dropdown\" ).select2({\n        theme: \"bootstrap\"\n    });\n</code></pre>\n\n<p>Hope this will help for later same issue.</p>\n"}], "owner": {"reputation": 1243, "user_id": 10476417, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/07b57114718c234f1f44a28f5396026e?s=128&d=identicon&r=PG&f=1", "display_name": "Abhishek Aravindan", "link": "https://stackoverflow.com/users/10476417/abhishek-aravindan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 192, "favorite_count": 0, "accepted_answer_id": 53607796, "answer_count": 1, "score": 1, "last_activity_date": 1543908661, "creation_date": 1543904531, "last_edit_date": 1543907816, "question_id": 53606834, "link": "https://stackoverflow.com/questions/53606834/select2-not-working-without-reloading-the-page", "title": "Select2 not working without reloading the page", "body": "<p>I have a issue with the Jquery select2 in Rails\nI have a model work in which days is a dropdown menu and i want to input values using Select2 Jquery.</p>\n\n<p>below is days field _form.html.erb</p>\n\n<pre><code>  &lt;div class=\"field\"&gt;\n&lt;%= form.label :days %&gt;\n&lt;%= form.select :days, options_for_select($days), options = {:multiple =&gt; true}, :id =&gt; \"dropdown\" %&gt;\n</code></pre>\n\n<p></p>\n\n<p>application.js</p>\n\n<pre><code>//= require jquery\n//= require jquery_ujs\n//= require select2-full\n//= require activestorage\n//= require turbolinks\n//= require_tree .\n\n\n  $(document).ready(function(){\n\n    $( \"#dropdown\" ).select2({\n        theme: \"bootstrap\"\n    });\n });\n</code></pre>\n\n<p>The select2 works after reloading the the page, But not working if the page is redirected by link in navbar.</p>\n\n<p>the navbar code below:</p>\n\n<pre><code>&lt;nav&gt;\n &lt;div class=\"container\"&gt;\n  &lt;ul class=\"main-menu\"&gt;\n   &lt;li&gt;&lt;%= link_to \"Home\", root_path %&gt;&lt;/li&gt; \n   &lt;li&gt;&lt;%= link_to \"new work\", new_work_path %&gt;&lt;/li&gt; \n  &lt;/ul&gt;\n &lt;/div&gt;\n&lt;/nav&gt;\n</code></pre>\n\n<p>application.html.erb:</p>\n\n<pre><code>&lt;!DOCTYPE html&gt;\n &lt;html&gt;\n  &lt;head&gt;\n   &lt;title&gt;Stack1&lt;/title&gt;\n   &lt;%= csrf_meta_tags %&gt;\n   &lt;%= csp_meta_tag %&gt;\n   &lt;%= stylesheet_link_tag    'application', media: 'all', 'data-turbolinks-track': 'reload' %&gt;\n   &lt;%= javascript_include_tag 'application', 'data-turbolinks-track': 'reload' %&gt;\n  &lt;/head&gt;\n  &lt;body&gt;\n   &lt;%= render 'layouts/navbar' %&gt;\n   &lt;%= yield %&gt;\n  &lt;/body&gt;\n &lt;/html&gt;\n</code></pre>\n\n<p>the scenario is that user click new work in navbar and the new_work_path is displayed for input values, here the select2 not works, But after reloading the page the select2 works.</p>\n\n<p>Any help is appreciated.</p>\n"}, {"tags": ["javascript", "ruby-on-rails", "ruby", "coffeescript"], "comments": [{"owner": {"reputation": 394580, "user_id": 479863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ArUCE.jpg?s=128&g=1", "display_name": "mu is too short", "link": "https://stackoverflow.com/users/479863/mu-is-too-short"}, "edited": false, "score": 2, "creation_date": 1543909825, "post_id": 53606754, "comment_id": 94077459, "body": "Those code snippets aren&#39;t quite equivalent. The JavaScript one is defining a <i>global</i> <code>showFullscreen</code> function whereas the CoffeeScript one is creating a local <code>showFullscreen</code> function inside a scope wrapper. Perhaps you want to say <code>@showFullScreen = (event) -&gt; ...</code> or <code>window.showFullScreen = (event) -&gt; ...</code>. Or better, don&#39;t use an <code>onclick</code> attribute at all, create local functions and bind them to elements."}], "answers": [{"comments": [{"owner": {"reputation": 703, "user_id": 10268122, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bad16d3391f1131bd3996108eb400edc?s=128&d=identicon&r=PG&f=1", "display_name": "shashi verma", "link": "https://stackoverflow.com/users/10268122/shashi-verma"}, "edited": false, "score": 1, "creation_date": 1573630210, "post_id": 58753468, "comment_id": 103939655, "body": "Thanks for the reply bro, but I quit working on ror technology now."}, {"owner": {"reputation": 841, "user_id": 12294425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dxWNY.jpg?s=128&g=1", "display_name": "calebkm", "link": "https://stackoverflow.com/users/12294425/calebkm"}, "reply_to_user": {"reputation": 703, "user_id": 10268122, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bad16d3391f1131bd3996108eb400edc?s=128&d=identicon&r=PG&f=1", "display_name": "shashi verma", "link": "https://stackoverflow.com/users/10268122/shashi-verma"}, "edited": false, "score": 0, "creation_date": 1573660253, "post_id": 58753468, "comment_id": 103955734, "body": "Awww bummer @shashiverma! RoR is still my fav :-) If you think this answer was helpful anyway, could you mark is at the correct answer for future viewers? Out of curiosity, what tech are you working with now?"}, {"owner": {"reputation": 703, "user_id": 10268122, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bad16d3391f1131bd3996108eb400edc?s=128&d=identicon&r=PG&f=1", "display_name": "shashi verma", "link": "https://stackoverflow.com/users/10268122/shashi-verma"}, "edited": false, "score": 1, "creation_date": 1573703511, "post_id": 58753468, "comment_id": 103971410, "body": "sure why not, I have created an admin template in ror but I was always confused with pipelines, CoffeeScript, in which sequence we should import (or require) libraries. Now I am working on a javascript framework vuejs."}], "tags": [], "owner": {"reputation": 841, "user_id": 12294425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dxWNY.jpg?s=128&g=1", "display_name": "calebkm", "link": "https://stackoverflow.com/users/12294425/calebkm"}, "is_accepted": true, "score": 2, "last_activity_date": 1573145268, "creation_date": 1573145268, "answer_id": 58753468, "question_id": 53606754, "link": "https://stackoverflow.com/questions/53606754/coffeescript-how-to-convert-a-javascript-into-coffeescript-in-ruby-on-rails/58753468#58753468", "title": "Coffeescript - How to convert a javascript into coffeescript in ruby on rails?", "body": "<p>The issue you're running into is the different scoping between JS and CoffeeScript. To get your code working, you need to scope your function globally on <code>window</code> or the CoffeeScript shorthand <code>@</code>.</p>\n\n<p>From the <a href=\"https://coffeescript.org/#lexical-scope\" rel=\"nofollow noreferrer\">CoffeeScript docs</a>:</p>\n\n<blockquote>\n  <p>If you\u2019d like to create top-level variables for other scripts to use,\n  attach them as properties on <code>window</code>.</p>\n</blockquote>\n\n<p>Which for your function would look like:</p>\n\n<pre class=\"lang-coffee prettyprint-override\"><code># Using window\nwindow.showFullscreen = (event) -&gt;\n  elem = document.getElementById('card_' + event.id)\n  ...\n\n# Or using @\n@showFullscreen = (event) -&gt;\n  elem = document.getElementById('card_' + event.id)\n  ...\n</code></pre>\n\n<p>The CoffeeScript <code>@</code> is shorthand for <code>this</code> in JavaScript. So, in your example, because you're defining the function at the top level window scope <code>window == @</code>. Keep in mind that <em>within</em> your functions the scope will be different and <code>window != @</code>, and instead <code>@</code> will be scoped to whatever <code>this</code> is inside of your function. <a href=\"https://www.openmymind.net/2012/5/16/Ten-Features-I-Like-About-CoffeeScript\" rel=\"nofollow noreferrer\">This blog post has a nice explanation:</a></p>\n\n<blockquote>\n  <p>Speaking of <code>this</code>, CoffeeScript has a shortcut for it, the <code>@</code> symbol.\n  It's easy to write this off as meaningless syntactical sugar, but it\n  is useful. First, constructor parameters prefixed with <code>@</code> are converted\n  into properties:</p>\n  \n  <pre class=\"lang-coffee prettyprint-override\"><code> # CoffeeScript\n class User\n   constructor: (@id) -&gt;\n</code></pre>\n  \n  <pre class=\"lang-js prettyprint-override\"><code> // JavaScript\n function User(id) {\n   this.id = id;\n }\n</code></pre>\n  \n  <p>Beyond this though, it's a nice way to define class method:</p>\n  \n  <pre class=\"lang-coffee prettyprint-override\"><code> # CoffeeScript\n class User\n   constructor: (@id) -&gt;\n\n    @findById: (id) =&gt;\n    ...\n</code></pre>\n  \n  <pre class=\"lang-js prettyprint-override\"><code> // JavaScript\n function User(id) {\n   this.id = id;\n  }\n User.findById = function() {};\n</code></pre>\n  \n  <p>Neither <code>@</code> nor the fat arrow <code>=&gt;</code> mean that you don't have to worry about\n  the current meaning of <code>this</code> (or its alias <code>@</code>). They aren't silver\n  bullets, which isn't to say that they don't add value.</p>\n</blockquote>\n"}], "owner": {"reputation": 703, "user_id": 10268122, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bad16d3391f1131bd3996108eb400edc?s=128&d=identicon&r=PG&f=1", "display_name": "shashi verma", "link": "https://stackoverflow.com/users/10268122/shashi-verma"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 89, "favorite_count": 0, "accepted_answer_id": 58753468, "answer_count": 1, "score": 2, "last_activity_date": 1573145268, "creation_date": 1543904073, "question_id": 53606754, "link": "https://stackoverflow.com/questions/53606754/coffeescript-how-to-convert-a-javascript-into-coffeescript-in-ruby-on-rails", "title": "Coffeescript - How to convert a javascript into coffeescript in ruby on rails?", "body": "<p>I have a button in my views in <code>test.html.erb</code> as follows</p>\n\n<pre><code>&lt;button  id=\"Todo_full\" onclick=\"showFullscreen(this);\"&gt;Full size&lt;/button&gt;\n</code></pre>\n\n<p>and its javascript is as follows:</p>\n\n<pre><code>    function showFullscreen(event)\n    {\n    var elem = document.getElementById('card_' + event.id);\n\n        if (elem.requestFullscreen) {\n        return elem.requestFullscreen();\n        }\n        else if (elem.mozRequestFullScreen) \n        {\n\n        /* Firefox */\n        return elem.mozRequestFullScreen();\n        }\n    } \n</code></pre>\n\n<p>When I keep the javascript code at the below of the <code>test.html.erb</code> file it works fine. \nAnd when I convert this code into coffeescript through <a href=\"http://js2.coffee/\" rel=\"nofollow noreferrer\">http://js2.coffee/</a> and keep the code in <code>app/assets/javascript/test.coffee</code> which is as follows:</p>\n\n<pre><code>showFullscreen = (event) -&gt;\n  elem = document.getElementById('card_' + event.id)\n  if elem.requestFullscreen\n    return elem.requestFullscreen()\n  else if elem.mozRequestFullScreen\n\n    ### Firefox ###\n\n    return elem.mozRequestFullScreen()\n  return\n</code></pre>\n\n<p>It shows an error in console </p>\n\n<pre><code>Uncaught ReferenceError: showFullscreen is not defined\n    at HTMLButtonElement.onclick ((index):384)\n</code></pre>\n\n<p>Even when I use <code>window.onload = -&gt;</code> at the top of coffeescript's code I get the same error in console.</p>\n\n<p>Thank you</p>\n"}, {"tags": ["ruby", "chef-infra", "chef-recipe"], "comments": [{"owner": {"reputation": 20644, "user_id": 184184, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f6a508697f9eca2680b12ddb85ba1319?s=128&d=identicon&r=PG", "display_name": "Lenin Raj Rajasekaran", "link": "https://stackoverflow.com/users/184184/lenin-raj-rajasekaran"}, "edited": false, "score": 0, "creation_date": 1543904040, "post_id": 53606689, "comment_id": 94075200, "body": "<a href=\"https://www.rubydoc.info/github/opscode/chef/Chef%2FResource:not_if\" rel=\"nofollow noreferrer\">rubydoc.info/github/opscode/chef/Chef%2FResource:not_if</a>"}, {"owner": {"reputation": 1975, "user_id": 1948659, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/3f5d84934da81e6c660ba5099d0f0dbf?s=128&d=identicon&r=PG", "display_name": "Cacoon", "link": "https://stackoverflow.com/users/1948659/cacoon"}, "reply_to_user": {"reputation": 20644, "user_id": 184184, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f6a508697f9eca2680b12ddb85ba1319?s=128&d=identicon&r=PG", "display_name": "Lenin Raj Rajasekaran", "link": "https://stackoverflow.com/users/184184/lenin-raj-rajasekaran"}, "edited": false, "score": 0, "creation_date": 1543904660, "post_id": 53606689, "comment_id": 94075406, "body": "@emaillenin So itll only run if existing_usernames.include?(release_user) ?"}], "answers": [{"comments": [{"owner": {"reputation": 1975, "user_id": 1948659, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/3f5d84934da81e6c660ba5099d0f0dbf?s=128&d=identicon&r=PG", "display_name": "Cacoon", "link": "https://stackoverflow.com/users/1948659/cacoon"}, "edited": false, "score": 0, "creation_date": 1544567762, "post_id": 53726014, "comment_id": 94320593, "body": "So what would be an equivalent javascript or C# comparison of this statement?"}, {"owner": {"reputation": 6316, "user_id": 1184717, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/7f8710cd5754a79df5dc5cd3d5308da2?s=128&d=identicon&r=PG", "display_name": "Mr.", "link": "https://stackoverflow.com/users/1184717/mr"}, "reply_to_user": {"reputation": 1975, "user_id": 1948659, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/3f5d84934da81e6c660ba5099d0f0dbf?s=128&d=identicon&r=PG", "display_name": "Cacoon", "link": "https://stackoverflow.com/users/1948659/cacoon"}, "edited": false, "score": 0, "creation_date": 1544685977, "post_id": 53726014, "comment_id": 94365938, "body": "@Cacoon: please read -- <code>not_if</code> is a guard for <b>chef resource</b>. it has nothing to do with neither javascript, not c#."}, {"owner": {"reputation": 1975, "user_id": 1948659, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/3f5d84934da81e6c660ba5099d0f0dbf?s=128&d=identicon&r=PG", "display_name": "Cacoon", "link": "https://stackoverflow.com/users/1948659/cacoon"}, "edited": false, "score": 0, "creation_date": 1544686104, "post_id": 53726014, "comment_id": 94365994, "body": "I know it is and I e read the chef doc on it but I\u2019m still not clear if the code block I posted will run or not"}, {"owner": {"reputation": 6316, "user_id": 1184717, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/7f8710cd5754a79df5dc5cd3d5308da2?s=128&d=identicon&r=PG", "display_name": "Mr.", "link": "https://stackoverflow.com/users/1184717/mr"}, "reply_to_user": {"reputation": 1975, "user_id": 1948659, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/3f5d84934da81e6c660ba5099d0f0dbf?s=128&d=identicon&r=PG", "display_name": "Cacoon", "link": "https://stackoverflow.com/users/1948659/cacoon"}, "edited": false, "score": 0, "creation_date": 1544686540, "post_id": 53726014, "comment_id": 94366193, "body": "@Cacoon: you are not reading :), so once again -- the chef resource will be executed only if the guard is evaluated to <code>true</code>."}, {"owner": {"reputation": 1975, "user_id": 1948659, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/3f5d84934da81e6c660ba5099d0f0dbf?s=128&d=identicon&r=PG", "display_name": "Cacoon", "link": "https://stackoverflow.com/users/1948659/cacoon"}, "edited": false, "score": 0, "creation_date": 1544686641, "post_id": 53726014, "comment_id": 94366239, "body": "But there\u2019s nothing for the guard to check? I can understand not_if Boolean do"}], "tags": [], "owner": {"reputation": 6316, "user_id": 1184717, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/7f8710cd5754a79df5dc5cd3d5308da2?s=128&d=identicon&r=PG", "display_name": "Mr.", "link": "https://stackoverflow.com/users/1184717/mr"}, "is_accepted": false, "score": 0, "last_activity_date": 1544537673, "creation_date": 1544537673, "answer_id": 53726014, "question_id": 53606689, "link": "https://stackoverflow.com/questions/53606689/redundant-not-if/53726014#53726014", "title": "Redundant not_if?", "body": "<p><a href=\"https://docs.chef.io/resource_common.html#attributes\" rel=\"nofollow noreferrer\"><code>not_if</code> is a guard</a> for chef resource.</p>\n\n<blockquote>\n  <p><code>not_if</code>: Prevent a resource from executing when the condition returns true.</p>\n</blockquote>\n\n<p>so for you question, yes - it runs before chef resource is executed.</p>\n"}], "owner": {"reputation": 1975, "user_id": 1948659, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/3f5d84934da81e6c660ba5099d0f0dbf?s=128&d=identicon&r=PG", "display_name": "Cacoon", "link": "https://stackoverflow.com/users/1948659/cacoon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 29, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1544537673, "creation_date": 1543903789, "question_id": 53606689, "link": "https://stackoverflow.com/questions/53606689/redundant-not-if", "title": "Redundant not_if?", "body": "<p>I am taking over a project and we are working with chef automation and im going over the recipe setup and I am confused with this:</p>\n\n<pre><code>not_if do\n    existing_usernames = []\n    Etc.passwd {|user| existing_usernames &lt;&lt; user['name']}\n    existing_usernames.include?(release_user)\n  end\n</code></pre>\n\n<p>Does this not_if statement ever run? The file has other things that seem to not be in use commented out</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 5060, "user_id": 10522579, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7GQ6a.jpg?s=128&g=1", "display_name": "ray", "link": "https://stackoverflow.com/users/10522579/ray"}, "edited": false, "score": 0, "creation_date": 1543901487, "post_id": 53606124, "comment_id": 94074380, "body": "What about trying controller inheritance in some aspect?"}, {"owner": {"reputation": 64, "user_id": 10153854, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-LRqbI39UBmY/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7pxQ2OXd_tToyV4rF-JzqqDagauVQ/mo/photo.jpg?sz=128", "display_name": "dj-Yang", "link": "https://stackoverflow.com/users/10153854/dj-yang"}, "reply_to_user": {"reputation": 5060, "user_id": 10522579, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7GQ6a.jpg?s=128&g=1", "display_name": "ray", "link": "https://stackoverflow.com/users/10522579/ray"}, "edited": false, "score": 0, "creation_date": 1543902215, "post_id": 53606124, "comment_id": 94074616, "body": "did you say 1:N relations?"}, {"owner": {"reputation": 5060, "user_id": 10522579, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7GQ6a.jpg?s=128&g=1", "display_name": "ray", "link": "https://stackoverflow.com/users/10522579/ray"}, "edited": false, "score": 0, "creation_date": 1543902596, "post_id": 53606124, "comment_id": 94074746, "body": "I suggest as per his heading, But I could not get why it look for Management id if code is looking for Freemanagement id"}, {"owner": {"reputation": 64, "user_id": 10153854, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-LRqbI39UBmY/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7pxQ2OXd_tToyV4rF-JzqqDagauVQ/mo/photo.jpg?sz=128", "display_name": "dj-Yang", "link": "https://stackoverflow.com/users/10153854/dj-yang"}, "reply_to_user": {"reputation": 5060, "user_id": 10522579, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7GQ6a.jpg?s=128&g=1", "display_name": "ray", "link": "https://stackoverflow.com/users/10522579/ray"}, "edited": false, "score": 0, "creation_date": 1543902711, "post_id": 53606124, "comment_id": 94074798, "body": "how to get Freemanagement id ...?"}, {"owner": {"reputation": 5060, "user_id": 10522579, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7GQ6a.jpg?s=128&g=1", "display_name": "ray", "link": "https://stackoverflow.com/users/10522579/ray"}, "edited": false, "score": 0, "creation_date": 1543902965, "post_id": 53606124, "comment_id": 94074887, "body": "I am clear with your approach, if you provide links which goes same controller for all 3 models, you should pass parameter as type so you can distinguish which model you are choosing. And of course, link must go for id which is present in database otherwise you will get this error."}, {"owner": {"reputation": 64, "user_id": 10153854, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-LRqbI39UBmY/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7pxQ2OXd_tToyV4rF-JzqqDagauVQ/mo/photo.jpg?sz=128", "display_name": "dj-Yang", "link": "https://stackoverflow.com/users/10153854/dj-yang"}, "reply_to_user": {"reputation": 5060, "user_id": 10522579, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7GQ6a.jpg?s=128&g=1", "display_name": "ray", "link": "https://stackoverflow.com/users/10522579/ray"}, "edited": false, "score": 0, "creation_date": 1544006088, "post_id": 53606124, "comment_id": 94119948, "body": "thanks for your answer, @ray but i can&#39;t understand this issue..."}, {"owner": {"reputation": 5060, "user_id": 10522579, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7GQ6a.jpg?s=128&g=1", "display_name": "ray", "link": "https://stackoverflow.com/users/10522579/ray"}, "edited": false, "score": 0, "creation_date": 1544008172, "post_id": 53606124, "comment_id": 94121200, "body": "See you finding record by <code>freemanage = Freemanagement.find(params[:id])</code> So it depends on how your structure is for, example default scope or whether you have <code>Freemanagement &lt; Management</code>, by <b>STI</b>  Also check for default scope. Hoping id passed in url is present."}, {"owner": {"reputation": 64, "user_id": 10153854, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-LRqbI39UBmY/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7pxQ2OXd_tToyV4rF-JzqqDagauVQ/mo/photo.jpg?sz=128", "display_name": "dj-Yang", "link": "https://stackoverflow.com/users/10153854/dj-yang"}, "reply_to_user": {"reputation": 5060, "user_id": 10522579, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7GQ6a.jpg?s=128&g=1", "display_name": "ray", "link": "https://stackoverflow.com/users/10522579/ray"}, "edited": false, "score": 0, "creation_date": 1544013494, "post_id": 53606124, "comment_id": 94124416, "body": "but, Freemanagement model is not related with Management model. they, just use one controller."}, {"owner": {"reputation": 5060, "user_id": 10522579, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7GQ6a.jpg?s=128&g=1", "display_name": "ray", "link": "https://stackoverflow.com/users/10522579/ray"}, "edited": false, "score": 0, "creation_date": 1544018384, "post_id": 53606124, "comment_id": 94127329, "body": "So check error log properly, because you need to find where it is written <code>Management.find(params[:id])</code>, check log"}, {"owner": {"reputation": 64, "user_id": 10153854, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-LRqbI39UBmY/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7pxQ2OXd_tToyV4rF-JzqqDagauVQ/mo/photo.jpg?sz=128", "display_name": "dj-Yang", "link": "https://stackoverflow.com/users/10153854/dj-yang"}, "reply_to_user": {"reputation": 5060, "user_id": 10522579, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7GQ6a.jpg?s=128&g=1", "display_name": "ray", "link": "https://stackoverflow.com/users/10522579/ray"}, "edited": false, "score": 0, "creation_date": 1544092345, "post_id": 53606124, "comment_id": 94157055, "body": "if i forcibly added Management model, did&#39;t occur error...but why this happening?@ray"}], "owner": {"reputation": 64, "user_id": 10153854, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-LRqbI39UBmY/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7pxQ2OXd_tToyV4rF-JzqqDagauVQ/mo/photo.jpg?sz=128", "display_name": "dj-Yang", "link": "https://stackoverflow.com/users/10153854/dj-yang"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 75, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1543901347, "creation_date": 1543900741, "last_edit_date": 1543901347, "question_id": 53606124, "link": "https://stackoverflow.com/questions/53606124/how-to-use-multi-model-one-controller-in-rails", "title": "how to use multi model, one controller in rails", "body": "<p>I want to use three models in one controller\nif click  tag '\uc0ad\uc81c', I want to execute <code>free_destroy</code> action in management controller.</p>\n\n<p>When I click the link, this error page occurs:</p>\n\n<blockquote>\n  <p>ActiveRecord::RecordNotFound in ManagementsController#free_destroy</p>\n  \n  <p>and Couldn't find Management with id=1</p>\n</blockquote>\n\n<p>How can i fix it?\nWhy does this error occur?</p>\n\n<p>Please answer for me.</p>\n\n<p><strong>controller</strong></p>\n\n<pre><code>class ManagementsController &lt; ApplicationController\nload_and_authorize_resource param_method::params_management\ndef index\n @users = User.all\n @freemanages = Freemanagement.all\nend\n\ndef freepost_delete\n @freemanage = Freemanagement.new(params.require(:modal).permit(:content, :title_id))\n @freemanage.save()\n\n redirect_to :back\nend\n\ndef secret_delete\n # @secretmanage = Secretmanagement.new(params.require(:modal).permit(:content, :title_id))\n # @secretmanage.save()\n\n # redirect_to :back\nend\n\ndef show\n freemanage = Freemanagement.find(params[:id])\n\n redirect_to freemanagements_path(freemanage), method: :delete\nend\n\ndef free_destroy\n freemanage = Freemanagement.find(params[:id])\n freemanage.destroy()\n\n redirect_to freepost_path(freemanage.title_id), method: :delete\nend\n\ndef refuse_freepost\n freepost = Freepost.find(params[:remodal][:title_id])\n freemanages = Freemanagement.all\n freemanages.each do |freemanage|\n   if (freemanage.title_id.to_i != freepost.id)\n     next\n   else\n     freemanage.destroy()\n   end\n end\n redirect_to :back\nend\n\ndef  refuse_secretpost\nend\nend\n</code></pre>\n\n<p><strong>index.html</strong></p>\n\n<pre><code>&lt;head&gt;\n\n&lt;/head&gt;\n&lt;body&gt;\n &lt;header&gt;\n   &lt;!-- \uacf5\uc9c0\uc0ac\ud56d \uc791\uc131 \uae00 --&gt;\n   &lt;%= link_to '\uc775\uba85\uac9f', secretposts_path %&gt;\n   &lt;%= link_to '\uc790\uc720\uac9f', freeposts_path %&gt;\n   &lt;%= current_user.last_name + current_user.first_name %&gt;\n &lt;/header&gt;\n &lt;section&gt;\n   &lt;% @users.each do |user| %&gt;\n     &lt;%= user.uid %&gt;\n     &lt;%= user.first_name %&gt;\n     &lt;%= user.last_name %&gt;\n     &lt;%= user.roles_name%&gt;\n   &lt;% end %&gt;\n &lt;/section&gt;\n &lt;section&gt;\n   &lt;% @freemanages.each do |freemanage| %&gt;\n     &lt;%= link_to '\uac8c\uc2dc\uae00\ubcf4\uae30', freepost_path(freemanage.title_id) %&gt;\n     &lt;%= freemanage.content %&gt;\n     &lt;a href='/freemanagements/&lt;%= freemanage.id %&gt;/delete'&gt;\uc0ad\uc81c&lt;/a&gt;\n     &lt;br /&gt;\n   &lt;% end %&gt;\n &lt;/section&gt;\n &lt;section&gt;\n   &lt;!-- \uc775\uba85\uac8c\uc2dc\ud310 \uad00\ub828 \uac8c\uc2dc\uae00 \uc139\uc158 --&gt;\n &lt;/section&gt;\n &lt;script&gt;\n &lt;/script&gt;\n&lt;/body&gt;\n</code></pre>\n\n<p><strong>routes.rb</strong></p>\n\n<pre><code>Rails.application.routes.draw do\n# For details on the DSL available within this file, see http://guides.rubyonrails.org/routing.html\n\nroot 'homes#index'\n\nresources :freeposts do\n  resources :free_comments\nend\n\nresources :secretposts do\n  resources :secret_comments\nend\n\nresources :free_comments\nresources :secret_comments\n\nget '/managements' =&gt; 'managements#index'\nget '/freemanagements/:id' =&gt; 'managements#show'\npost '/freemanagements' =&gt; 'managements#freepost_delete'\nget '/freemanagements/:id/delete' =&gt; 'managements#free_destroy'\npost '/freemanagements/refuse' =&gt; 'managements#refuse_freepost'\npost '/secretmanagements' =&gt; 'managements#secretpost_delete'\n\nget 'login', to: redirect('/auth/google_oauth2'), as: 'login'\nget 'logout', to: 'sessions#destroy', as: 'logout'\nget 'auth/:provider/callback', to: 'sessions#create'\nget 'auth/failure', to: redirect('/')\n# get 'home', to: 'home#show'\n# get 'me', to: 'me#show', as: 'me'\nend\n</code></pre>\n"}, {"tags": ["ruby", "graphql", "graphql-ruby"], "comments": [{"owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 1, "creation_date": 1543898868, "post_id": 53605246, "comment_id": 94073745, "body": "Not sure how converting <code>&#39;zn-CN&#39;</code> into camel case gives <code>&#39;zh-cn&#39;</code>."}], "answers": [{"tags": [], "owner": {"reputation": 800, "user_id": 2357117, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/fe14d5dc3536d1c33d722c8387dfd991?s=128&d=identicon&r=PG", "display_name": "yskkin", "link": "https://stackoverflow.com/users/2357117/yskkin"}, "is_accepted": true, "score": 1, "last_activity_date": 1543904388, "creation_date": 1543904388, "answer_id": 53606807, "question_id": 53605246, "link": "https://stackoverflow.com/questions/53605246/how-can-i-override-the-camelcase-naming-convention-in-graphql-ruby/53606807#53606807", "title": "How can I override the camelCase naming convention in graphql-ruby?", "body": "<p><code>argument :'zh-CN', String, :required=&gt;false, :camelize =&gt; false</code> can dump schema you described.\nHowever, on GraphiQL, it gives errors:</p>\n\n<pre><code>Error: Names must match /^[_a-zA-Z][_a-zA-Z0-9]*$/ but \"zh-CN\" does not.\n    at assertValidName (http://localhost:3000/assets/graphiql/rails/graphiql-0.11.11.self-8e737fccee2b9e37d473d51a9032299b320e847f04671cb2030e717b0009b2c1.js?body=1:30302:11)\n    at http://localhost:3000/assets/graphiql/rails/graphiql-0.11.11.self-8e737fccee2b9e37d473d51a9032299b320e847f04671cb2030e717b0009b2c1.js?body=1:28613:44\n    at Array.forEach (&lt;anonymous&gt;)\n    at GraphQLInputObjectType._defineFieldMap (http://localhost:3000/assets/graphiql/rails/graphiql-0.11.11.self-8e737fccee2b9e37d473d51a9032299b320e847f04671cb2030e717b0009b2c1.js?body=1:28612:16)\n    at GraphQLInputObjectType.getFields (http://localhost:3000/assets/graphiql/rails/graphiql-0.11.11.self-8e737fccee2b9e37d473d51a9032299b320e847f04671cb2030e717b0009b2c1.js?body=1:28601:49)\n    at typeMapReducer (http://localhost:3000/assets/graphiql/rails/graphiql-0.11.11.self-8e737fccee2b9e37d473d51a9032299b320e847f04671cb2030e717b0009b2c1.js?body=1:29968:26)\n    at Array.reduce (&lt;anonymous&gt;)\n    at http://localhost:3000/assets/graphiql/rails/graphiql-0.11.11.self-8e737fccee2b9e37d473d51a9032299b320e847f04671cb2030e717b0009b2c1.js?body=1:29961:36\n    at Array.forEach (&lt;anonymous&gt;)\n    at typeMapReducer (http://localhost:3000/assets/graphiql/rails/graphiql-0.11.11.self-8e737fccee2b9e37d473d51a9032299b320e847f04671cb2030e717b0009b2c1.js?body=1:29954:27)\n</code></pre>\n\n<p>I feel it's better to use name like <code>zh_CN</code> with <code>camelize: false</code></p>\n"}], "owner": {"reputation": 4704, "user_id": 456295, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/771b4bd6867802849953b97b7e480b1b?s=128&d=identicon&r=PG", "display_name": "Luke Ehresman", "link": "https://stackoverflow.com/users/456295/luke-ehresman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 666, "favorite_count": 0, "accepted_answer_id": 53606807, "answer_count": 1, "score": 1, "last_activity_date": 1543904388, "creation_date": 1543893858, "question_id": 53605246, "link": "https://stackoverflow.com/questions/53605246/how-can-i-override-the-camelcase-naming-convention-in-graphql-ruby", "title": "How can I override the camelCase naming convention in graphql-ruby?", "body": "<p>I'm using the excellent graphql-ruby gem (<a href=\"http://graphql-ruby.org/\" rel=\"nofollow noreferrer\">http://graphql-ruby.org/</a>).  I have a data structure that stores i18n strings essentially as hashes:  <code>{'en': 'Hello', 'es': 'Hola'}</code>.  Works great under normal circumstances.</p>\n\n<p>However, we just added simplified and traditional Chinese with the language codes of 'zh-CN' and 'zh-TW'.  Due to graphql-ruby translating all input fields in camelCase, these are getting translated as 'zh-cn' and 'zh-tw'.</p>\n\n<p>This is what my input class looks like:</p>\n\n<pre><code>class CoreGql::InputTypes::I18nStringInput &lt; GraphQL::Schema::InputObject\n  graphql_name \"I18nStringInput\"\n\n  argument :en, String, :required=&gt;false\n  argument :es, String, :required=&gt;false\n  argument :de, String, :required=&gt;false\n  argument :fr, String, :required=&gt;false\n  argument :is, String, :required=&gt;false\n  argument :ja, String, :required=&gt;false\n  argument :nl, String, :required=&gt;false\n  argument 'zh-CN', String, :required=&gt;false\n  argument 'zh-TW', String, :required=&gt;false\nend\n</code></pre>\n\n<p>Is there a way to override the graphql-ruby naming convention for fields and/or arguments?  I want it to be 'zh-CN' and 'zh-TW' exactly.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "timezone", "utc"], "comments": [{"owner": {"reputation": 20644, "user_id": 184184, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f6a508697f9eca2680b12ddb85ba1319?s=128&d=identicon&r=PG", "display_name": "Lenin Raj Rajasekaran", "link": "https://stackoverflow.com/users/184184/lenin-raj-rajasekaran"}, "edited": false, "score": 0, "creation_date": 1543892095, "post_id": 53604767, "comment_id": 94072309, "body": "Based on the pics, I think the issue is that Javascript/FE is stripping or not using the timezone when displaying the event"}, {"owner": {"reputation": 6361, "user_id": 2097529, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/QnP8n.jpg?s=128&g=1", "display_name": "Kick Buttowski", "link": "https://stackoverflow.com/users/2097529/kick-buttowski"}, "reply_to_user": {"reputation": 20644, "user_id": 184184, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f6a508697f9eca2680b12ddb85ba1319?s=128&d=identicon&r=PG", "display_name": "Lenin Raj Rajasekaran", "link": "https://stackoverflow.com/users/184184/lenin-raj-rajasekaran"}, "edited": false, "score": 0, "creation_date": 1543892213, "post_id": 53604767, "comment_id": 94072340, "body": "in my rails console , each time, I get different result which is very confusing :/, I even shared my repo , and I am open to try anything to get something reliable"}, {"owner": {"reputation": 121, "user_id": 4858223, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/IFx6P.gif?s=128&g=1", "display_name": "MorboRe&#39;", "link": "https://stackoverflow.com/users/4858223/morbore"}, "edited": false, "score": 0, "creation_date": 1543895142, "post_id": 53604767, "comment_id": 94072941, "body": "you can set timezone at config/application.rb <a href=\"https://stackoverflow.com/questions/6118779/how-to-change-default-timezone-for-active-record-in-rails\" title=\"how to change default timezone for active record in rails\">stackoverflow.com/questions/6118779/&hellip;</a>"}, {"owner": {"reputation": 6361, "user_id": 2097529, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/QnP8n.jpg?s=128&g=1", "display_name": "Kick Buttowski", "link": "https://stackoverflow.com/users/2097529/kick-buttowski"}, "edited": false, "score": 0, "creation_date": 1543897438, "post_id": 53604767, "comment_id": 94073425, "body": "the whole point of having zone field inside signup form is avoiding to set up any specific local zone"}, {"owner": {"reputation": 1393, "user_id": 6206501, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JENfJ.jpg?s=128&g=1", "display_name": "Abhilash Reddy", "link": "https://stackoverflow.com/users/6206501/abhilash-reddy"}, "edited": false, "score": 0, "creation_date": 1543908222, "post_id": 53604767, "comment_id": 94076779, "body": "Are you storing time zone value in your db for every user?"}, {"owner": {"reputation": 1393, "user_id": 6206501, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JENfJ.jpg?s=128&g=1", "display_name": "Abhilash Reddy", "link": "https://stackoverflow.com/users/6206501/abhilash-reddy"}, "edited": false, "score": 0, "creation_date": 1543908269, "post_id": 53604767, "comment_id": 94076802, "body": "I mean for user1 timezone will be &#39;&#39;UTC&quot; and for another user it can be something else like that?"}, {"owner": {"reputation": 159, "user_id": 9722060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fd6af43aa5acad3d7111cc6be4d835bb?s=128&d=identicon&r=PG&f=1", "display_name": "Stefan Rendevski", "link": "https://stackoverflow.com/users/9722060/stefan-rendevski"}, "edited": false, "score": 0, "creation_date": 1543914510, "post_id": 53604767, "comment_id": 94079636, "body": "ActiveRecord persists timestamps in UTC, so <code>2018-12-01 01:56:53 +0900</code> will be persisted as <code>2018-11-30 16:56:53</code>, and taking <code>date(timestamp)</code> would return <code>2018-11-30</code>"}, {"owner": {"reputation": 6361, "user_id": 2097529, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/QnP8n.jpg?s=128&g=1", "display_name": "Kick Buttowski", "link": "https://stackoverflow.com/users/2097529/kick-buttowski"}, "reply_to_user": {"reputation": 1393, "user_id": 6206501, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JENfJ.jpg?s=128&g=1", "display_name": "Abhilash Reddy", "link": "https://stackoverflow.com/users/6206501/abhilash-reddy"}, "edited": false, "score": 0, "creation_date": 1543943138, "post_id": 53604767, "comment_id": 94096503, "body": "@AbhilashReddy all the users gonna have different timezones"}, {"owner": {"reputation": 6361, "user_id": 2097529, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/QnP8n.jpg?s=128&g=1", "display_name": "Kick Buttowski", "link": "https://stackoverflow.com/users/2097529/kick-buttowski"}, "reply_to_user": {"reputation": 159, "user_id": 9722060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fd6af43aa5acad3d7111cc6be4d835bb?s=128&d=identicon&r=PG&f=1", "display_name": "Stefan Rendevski", "link": "https://stackoverflow.com/users/9722060/stefan-rendevski"}, "edited": false, "score": 0, "creation_date": 1543943224, "post_id": 53604767, "comment_id": 94096544, "body": "@StefanRendevski that is a good point but my db either shows different behavior or your point is right? Idk it is very confusing to me"}, {"owner": {"reputation": 3807, "user_id": 2043592, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/zCbuL.jpg?s=128&g=1", "display_name": "xploshioOn", "link": "https://stackoverflow.com/users/2043592/xploshioon"}, "edited": false, "score": 0, "creation_date": 1543961070, "post_id": 53604767, "comment_id": 94104697, "body": "I am not sure  if I understand your problem, but if I understand good, have you tried changing the default value of created_at from a migration with change_column_default (so it&#39;s not generated on database level), and then specify it when you create a new <code>UserStock</code> with the specific timezone, something like <code>UserStock.create(created_at: Time.now.in_time_zone(&#39;London&#39;).to_time)</code>. then you can make the query like that too, changing the <code>date</code> to <code>date.in_time_zone...</code>. maybe it&#39;s no perfect for your case, but might lead you to the complete solution using <code>in_time_zone</code> when needed"}, {"owner": {"reputation": 6361, "user_id": 2097529, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/QnP8n.jpg?s=128&g=1", "display_name": "Kick Buttowski", "link": "https://stackoverflow.com/users/2097529/kick-buttowski"}, "reply_to_user": {"reputation": 3807, "user_id": 2043592, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/zCbuL.jpg?s=128&g=1", "display_name": "xploshioOn", "link": "https://stackoverflow.com/users/2043592/xploshioon"}, "edited": false, "score": 0, "creation_date": 1543961287, "post_id": 53604767, "comment_id": 94104773, "body": "@xploshioon thanks for the response.  I posted my repo as well if it helps"}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1543975147, "post_id": 53604767, "comment_id": 94108435, "body": "Time is time. When you display it is up to you. If you want to o query based on the time convert all queries to the server&#39;s time zone to ensure accuracy then display based on the User&#39;s timezone"}, {"owner": {"reputation": 6361, "user_id": 2097529, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/QnP8n.jpg?s=128&g=1", "display_name": "Kick Buttowski", "link": "https://stackoverflow.com/users/2097529/kick-buttowski"}, "edited": false, "score": 0, "creation_date": 1543978343, "post_id": 53604767, "comment_id": 94109156, "body": "yes please if you have any suggestion"}], "answers": [{"comments": [{"owner": {"reputation": 6361, "user_id": 2097529, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/QnP8n.jpg?s=128&g=1", "display_name": "Kick Buttowski", "link": "https://stackoverflow.com/users/2097529/kick-buttowski"}, "edited": false, "score": 0, "creation_date": 1543943323, "post_id": 53607902, "comment_id": 94096597, "body": "yes I did , but when I save record in db, it is being saved according to my current day not the current day of an user"}, {"owner": {"reputation": 6361, "user_id": 2097529, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/QnP8n.jpg?s=128&g=1", "display_name": "Kick Buttowski", "link": "https://stackoverflow.com/users/2097529/kick-buttowski"}, "edited": false, "score": 0, "creation_date": 1543943613, "post_id": 53607902, "comment_id": 94096755, "body": "I added my shcema if you want we can talk in linkedin to solve this issue"}], "tags": [], "owner": {"reputation": 1393, "user_id": 6206501, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JENfJ.jpg?s=128&g=1", "display_name": "Abhilash Reddy", "link": "https://stackoverflow.com/users/6206501/abhilash-reddy"}, "is_accepted": false, "score": 1, "last_activity_date": 1543909099, "creation_date": 1543909099, "answer_id": 53607902, "question_id": 53604767, "link": "https://stackoverflow.com/questions/53604767/activerecord-is-not-aware-of-timezones/53607902#53607902", "title": "ActiveRecord is not aware of timezones?", "body": "<p>Did you try the query by specifying the range? </p>\n\n<p>Because you're trying to find the <code>user_stocks</code> that are created on some date. But notice that <code>created_at</code> is a <code>datetime</code> object and I guess your <code>date</code> variable might be just a <code>date</code> object.  </p>\n\n<pre><code>def stock_by_date(date)\n  UserStock.where(created_at: date.midnight..date.end_of_day, user_id: current_user.id)\nend\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 3807, "user_id": 2043592, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/zCbuL.jpg?s=128&g=1", "display_name": "xploshioOn", "link": "https://stackoverflow.com/users/2043592/xploshioon"}, "is_accepted": true, "score": 1, "last_activity_date": 1543968684, "last_edit_date": 1543968684, "creation_date": 1543963677, "answer_id": 53622603, "question_id": 53604767, "link": "https://stackoverflow.com/questions/53604767/activerecord-is-not-aware-of-timezones/53622603#53622603", "title": "ActiveRecord is not aware of timezones?", "body": "<p>create a migration with this content to remove the default value to created_at, so it's not filled by default on database level.</p>\n\n<pre><code>change_column_default(:user_stocks, :created_at, nil)\n</code></pre>\n\n<p>after that, when you create a new UserStock, you need to specify the created_at value, and there you can specify the created_at with the date of the user, taking care of the timezone.</p>\n\n<pre><code>UserStock.create(created_at: Time.now.in_time_zone(user.time_zone).to_time...)\n</code></pre>\n\n<p>or you can just maybe add it to a callback on the model so it's automatic everytime you create a UserStock, it change the value</p>\n\n<pre><code>class UserStock &lt; ActiveRecord::Base\n  before_create :set_created_at\n\n  private\n    def set_created_at\n      self.created_at = time.now.in_time_zone(self.user.time_zone).to_time\n    end\nend\n</code></pre>\n\n<p>so everytime you create one, the value is correct. with that it may work as expected.</p>\n\n<p>Another option if you don't need it just for that specific model and use them for all the user interaction, you can create a before filter on the application controller to set the time zone dinamically, something like</p>\n\n<pre><code>class ApplicationController &lt; ActionController::Base\n  before_filter :set_time_zone\n\n  def set_time_zone(&amp;block)\n    time_zone = current_user.try(:time_zone) || 'UTC'\n    Time.use_zone(time_zone, &amp;block)\n  end\nend\n</code></pre>\n"}], "owner": {"reputation": 6361, "user_id": 2097529, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/QnP8n.jpg?s=128&g=1", "display_name": "Kick Buttowski", "link": "https://stackoverflow.com/users/2097529/kick-buttowski"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 213, "favorite_count": 0, "accepted_answer_id": 53622603, "answer_count": 2, "score": 4, "last_activity_date": 1543968684, "creation_date": 1543889694, "last_edit_date": 1543944237, "question_id": 53604767, "link": "https://stackoverflow.com/questions/53604767/activerecord-is-not-aware-of-timezones", "title": "ActiveRecord is not aware of timezones?", "body": "<p>I have one question regarding to time zone</p>\n\n<p>I have done the following yet, my activerecord is not still matching with my timezone when I do following query</p>\n\n<pre><code>def stock_by_date(date)\n   UserStock.where(\"date(created_at) = ? and user_id = ? \", date , current_user.id)\nend\n</code></pre>\n\n<p>I did the following in side my <code>application.rb</code></p>\n\n<pre><code>config.active_record.default_timezone = :utc\nconfig.active_record.time_zone_aware_attributes = true\nconfig.beginning_of_week = :sunday\nconfig.active_record.time_zone_aware_types = [:datetime, :time]\n</code></pre>\n\n<p>I added timezone field to my sign up method, and it shows the current day of timezone correctly, yet when I added a stock for the current day timezone, it shows up in either the previous day or next day of current daytime zone and when I added my stock, the timestamp is for a day before when I look at the rails console </p>\n\n<p>My <code>schema.rb</code></p>\n\n<pre><code>ActiveRecord::Schema.define(version: 2018_11_28_183416) do\n\n  create_table \"friendships\", force: :cascade do |t|\n    t.integer \"user_id\"\n    t.integer \"friend_id\"\n    t.datetime \"created_at\", null: false\n    t.datetime \"updated_at\", null: false\n    t.index [\"friend_id\"], name: \"index_friendships_on_friend_id\"\n    t.index [\"user_id\"], name: \"index_friendships_on_user_id\"\n  end\n\n  create_table \"notes\", force: :cascade do |t|\n    t.string \"content\"\n    t.datetime \"created_at\", null: false\n    t.datetime \"updated_at\", null: false\n    t.integer \"user_id\"\n    t.index [\"user_id\"], name: \"index_notes_on_user_id\"\n  end\n\n  create_table \"stocks\", force: :cascade do |t|\n    t.string \"ticker\"\n    t.string \"name\"\n    t.decimal \"last_price\"\n    t.datetime \"created_at\", null: false\n    t.datetime \"updated_at\", null: false\n  end\n\n  create_table \"user_stocks\", force: :cascade do |t|\n    t.integer \"user_id\"\n    t.integer \"stock_id\"\n    t.datetime \"created_at\", null: false\n    t.datetime \"updated_at\", null: false\n    t.index [\"stock_id\"], name: \"index_user_stocks_on_stock_id\"\n    t.index [\"user_id\"], name: \"index_user_stocks_on_user_id\"\n  end\n\n  create_table \"users\", force: :cascade do |t|\n    t.string \"email\", default: \"\", null: false\n    t.string \"encrypted_password\", default: \"\", null: false\n    t.string \"reset_password_token\"\n    t.datetime \"reset_password_sent_at\"\n    t.datetime \"remember_created_at\"\n    t.datetime \"created_at\", null: false\n    t.datetime \"updated_at\", null: false\n    t.string \"first_name\"\n    t.string \"last_name\"\n    t.string \"time_zone\", default: \"UTC\"\n    t.index [\"email\"], name: \"index_users_on_email\", unique: true\n    t.index [\"reset_password_token\"], name: \"index_users_on_reset_password_token\", unique: true\n  end\n\nend\n</code></pre>\n\n<p><strong>for example</strong>, <a href=\"https://i.stack.imgur.com/2HQtR.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/2HQtR.jpg\" alt=\"enter image description here\"></a>\n<a href=\"https://i.stack.imgur.com/zhBMm.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/zhBMm.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>How can I fix this issue?</p>\n\n<p><strong>Note</strong>: If more info is needed, please let me know </p>\n\n<p><strong>Note:</strong> for the matter of being concise this is my <a href=\"https://github.com/KickButtowski80/finance-tracker\" rel=\"nofollow noreferrer\">repo</a> </p>\n\n<p><strong>Note:</strong> my configuration does not show a reliable behavior at all and I am very confused :/ and I have the same issue for note of a current day</p>\n\n<p>----<strong>update</strong>-------------------</p>\n\n<p>In my rails console </p>\n\n<p><a href=\"https://i.stack.imgur.com/PDAnV.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/PDAnV.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1543895351, "post_id": 53604740, "comment_id": 94072985, "body": "Don&#39;t you mean it should look like <code>[{ 1=&gt;23 }, { 45=&gt;87 }]</code>, as symbol names cannot begin with a digit?"}, {"owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 0, "creation_date": 1543897636, "post_id": 53604740, "comment_id": 94073469, "body": "What you expect is invalid."}, {"owner": {"reputation": 13442, "user_id": 3982562, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2a3c7aae1d762372cda697833c602ec8?s=128&d=identicon&r=PG", "display_name": "3limin4t0r", "link": "https://stackoverflow.com/users/3982562/3limin4t0r"}, "edited": false, "score": 0, "creation_date": 1543938210, "post_id": 53604740, "comment_id": 94093722, "body": "A quick question, why do you want an array containing hashes that have only one key/value pair? It seems to me that <code>{ &#39;1&#39; =&gt; &#39;23&#39;, &#39;45&#39; =&gt; &#39;87&#39; }</code> (one hash without wrapped array) is a better result."}, {"owner": {"reputation": 73, "user_id": 10687200, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-2KnII724uNs/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-hdvEANsdT_ypF3h29yVZiAlyr6UA/mo/photo.jpg?sz=128", "display_name": "jose miliano", "link": "https://stackoverflow.com/users/10687200/jose-miliano"}, "edited": false, "score": 0, "creation_date": 1543938966, "post_id": 53604740, "comment_id": 94094198, "body": "The array of hash is not going to be just have 2 values, it could have 100 or 500 objects"}], "answers": [{"tags": [], "owner": {"reputation": 11786, "user_id": 437049, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/BPdPc.jpg?s=128&g=1", "display_name": "nicosantangelo", "link": "https://stackoverflow.com/users/437049/nicosantangelo"}, "is_accepted": true, "score": 0, "last_activity_date": 1543889954, "creation_date": 1543889954, "answer_id": 53604800, "question_id": 53604740, "link": "https://stackoverflow.com/questions/53604740/how-to-create-an-array-of-hashes-by-looping-over-array-of-objects/53604800#53604800", "title": "how to create an array of hashes by looping over array of objects", "body": "<p>Have you tried this?</p>\n\n<pre><code>def mapped_product(objects)\n    mapping = []\n    objects.each do |object|\n      mapping &lt;&lt; {\n        object.id =&gt; object.product_order_id # I'm using an `=&gt;` here\n      }\n    end\n    mapping # return the new mapping\nend\n</code></pre>\n\n<p>I've just changed the <code>:</code> on the hash for a <code>=&gt;</code> to \"make it dynamic\" and swapped the values of <code>id</code> and <code>product_order_id</code></p>\n\n<p>You can also use a <code>map</code> here:</p>\n\n<pre><code>def mapped_product(objects)\n    objects.map do |object|\n     {  object.id =&gt; object.product_order_id }\n    end\nend\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 9602, "user_id": 3607136, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/NRFso.jpg?s=128&g=1", "display_name": "Gagan Gami", "link": "https://stackoverflow.com/users/3607136/gagan-gami"}, "is_accepted": false, "score": 1, "last_activity_date": 1543905475, "creation_date": 1543905475, "answer_id": 53607013, "question_id": 53604740, "link": "https://stackoverflow.com/questions/53604740/how-to-create-an-array-of-hashes-by-looping-over-array-of-objects/53607013#53607013", "title": "how to create an array of hashes by looping over array of objects", "body": "<p>inline solution:</p>\n\n<pre><code>&gt; Hash[objects.map{|p| [p.id, p.product_order_id] }]\n# Output : [{ 1=&gt;23 }, { 45=&gt;87 }]\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 688, "user_id": 202613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/89806d4eddb1df26f1d75240011afa9d?s=128&d=identicon&r=PG", "display_name": "Mereghost", "link": "https://stackoverflow.com/users/202613/mereghost"}, "is_accepted": false, "score": 1, "last_activity_date": 1543922652, "creation_date": 1543922652, "answer_id": 53611894, "question_id": 53604740, "link": "https://stackoverflow.com/questions/53604740/how-to-create-an-array-of-hashes-by-looping-over-array-of-objects/53611894#53611894", "title": "how to create an array of hashes by looping over array of objects", "body": "<p>I'd usually implement it using an <code>each_with_object</code></p>\n\n<pre><code>objects.each_with_object({}) { |obj, acc| acc[obj.id] = obj.product_order_id }\n</code></pre>\n\n<p>Unless I reaaaly want to squeeze some performance, than I'd go with <a href=\"https://stackoverflow.com/a/53607013/202613\">Gagan's answer</a></p>\n"}], "owner": {"reputation": 73, "user_id": 10687200, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-2KnII724uNs/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-hdvEANsdT_ypF3h29yVZiAlyr6UA/mo/photo.jpg?sz=128", "display_name": "jose miliano", "link": "https://stackoverflow.com/users/10687200/jose-miliano"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 85, "favorite_count": 0, "accepted_answer_id": 53604800, "answer_count": 3, "score": 0, "last_activity_date": 1543938999, "creation_date": 1543889461, "last_edit_date": 1543938999, "question_id": 53604740, "link": "https://stackoverflow.com/questions/53604740/how-to-create-an-array-of-hashes-by-looping-over-array-of-objects", "title": "how to create an array of hashes by looping over array of objects", "body": "<p>I have following array of hash. I am trying to loop over it and build an array of hash of values of id and product_order_id.</p>\n\n<pre><code>objects = \n[\n  #&lt;Product: 0x00007ffd4a561108\n  @id=\"1\",\n  @product_id=\"2\",\n  @product_order_id=\"23\",\n  @description=\"abc\",\n  @status=\"abcde\",\n  @start_date=nil,\n  @end_date=nil&gt;,\n  #&lt;Product: 0x00007ffd4a560c80\n  @id=\"45\",\n  @product_id=\"22\",\n  @product_order_id=\"87\",\n  @description=\"ahef\",\n  @status=\"gesff\",\n  @start_date=nil,\n  @end_date=nil&gt;\n......more objects.....\n    ]\n</code></pre>\n\n<p>This is what it should look like</p>\n\n<pre><code>[{ \"1\": \"23\" }, { \"45\": \"87\" }] --&gt;its going to be uuid\n</code></pre>\n\n<p>I tried doing this but no luck</p>\n\n<pre><code>def mapped_product(objects)\n    mapping = []\n    objects.each do |object|\n      mapping &lt;&lt; {\n        object.product_order_id: object.id\n      }\n    end\nend\n</code></pre>\n\n<p>Any idea?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "routing", "link-to", "link-to-function"], "comments": [{"owner": {"reputation": 2412, "user_id": 1253504, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/1ba0b6bef219b34fa4f2d014046ff987?s=128&d=identicon&r=PG", "display_name": "kasperite", "link": "https://stackoverflow.com/users/1253504/kasperite"}, "edited": false, "score": 0, "creation_date": 1543884805, "post_id": 53604103, "comment_id": 94070625, "body": "would be helpful to see your <code>routes.rb</code>"}, {"owner": {"reputation": 821, "user_id": 9893391, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c74a86b767c4b02d4fab64419e1597b6?s=128&d=identicon&r=PG&f=1", "display_name": "Micromegas", "link": "https://stackoverflow.com/users/9893391/micromegas"}, "reply_to_user": {"reputation": 2412, "user_id": 1253504, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/1ba0b6bef219b34fa4f2d014046ff987?s=128&d=identicon&r=PG", "display_name": "kasperite", "link": "https://stackoverflow.com/users/1253504/kasperite"}, "edited": false, "score": 0, "creation_date": 1543885432, "post_id": 53604103, "comment_id": 94070748, "body": "of course, thank you, I edited my question with routes"}, {"owner": {"reputation": 20644, "user_id": 184184, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f6a508697f9eca2680b12ddb85ba1319?s=128&d=identicon&r=PG", "display_name": "Lenin Raj Rajasekaran", "link": "https://stackoverflow.com/users/184184/lenin-raj-rajasekaran"}, "edited": false, "score": 0, "creation_date": 1543886080, "post_id": 53604103, "comment_id": 94070920, "body": "have you tried <code>rake routes</code> to see the list of routes?"}], "answers": [{"comments": [{"owner": {"reputation": 821, "user_id": 9893391, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c74a86b767c4b02d4fab64419e1597b6?s=128&d=identicon&r=PG&f=1", "display_name": "Micromegas", "link": "https://stackoverflow.com/users/9893391/micromegas"}, "edited": false, "score": 0, "creation_date": 1543887565, "post_id": 53604303, "comment_id": 94071301, "body": "Thank you. Do you mean I provide it with a method in the controller that I send to the view?"}, {"owner": {"reputation": 940, "user_id": 5788024, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/13mIY.png?s=128&g=1", "display_name": "CaTs", "link": "https://stackoverflow.com/users/5788024/cats"}, "reply_to_user": {"reputation": 821, "user_id": 9893391, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c74a86b767c4b02d4fab64419e1597b6?s=128&d=identicon&r=PG&f=1", "display_name": "Micromegas", "link": "https://stackoverflow.com/users/9893391/micromegas"}, "edited": false, "score": 0, "creation_date": 1543888177, "post_id": 53604303, "comment_id": 94071424, "body": "However you provide it is up to you, just ensure that <code>@subject</code> has a value by the time you get to your <code>link_to</code>. Typically in a new action you would do something like <code>@subject = Subject.new</code> in the controller and then use the model in a form before posting it back."}, {"owner": {"reputation": 821, "user_id": 9893391, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c74a86b767c4b02d4fab64419e1597b6?s=128&d=identicon&r=PG&f=1", "display_name": "Micromegas", "link": "https://stackoverflow.com/users/9893391/micromegas"}, "edited": false, "score": 0, "creation_date": 1543889312, "post_id": 53604303, "comment_id": 94071661, "body": "Great! Thanks a lot!!"}], "tags": [], "owner": {"reputation": 940, "user_id": 5788024, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/13mIY.png?s=128&g=1", "display_name": "CaTs", "link": "https://stackoverflow.com/users/5788024/cats"}, "is_accepted": true, "score": 0, "last_activity_date": 1543886165, "creation_date": 1543886165, "answer_id": 53604303, "question_id": 53604103, "link": "https://stackoverflow.com/questions/53604103/how-to-use-link-to-in-an-admin-section-correctly-in-rails/53604303#53604303", "title": "How to use &quot;link_to&quot; in an Admin section correctly in Rails", "body": "<p>The link you are creating points to a route that requires a subject id. In the subjects view it works because Rails can find the <code>subject_id</code> in the <code>@subject</code>that you are passing to the path helper.</p>\n\n<p>When you copy and try to re-use the same link in your admin view, I expect that <code>@subject</code> is not assigned and so it cannot find the required <code>subject_id</code>. Provide your admin section view with the subject and it should work!</p>\n\n<p>Also if you want to get a clearer idea of routing, the <a href=\"https://guides.rubyonrails.org/routing.html#controller-namespaces-and-routing\" rel=\"nofollow noreferrer\">Rails docs</a> are pretty great.</p>\n"}], "owner": {"reputation": 821, "user_id": 9893391, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c74a86b767c4b02d4fab64419e1597b6?s=128&d=identicon&r=PG&f=1", "display_name": "Micromegas", "link": "https://stackoverflow.com/users/9893391/micromegas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 133, "favorite_count": 0, "accepted_answer_id": 53604303, "answer_count": 1, "score": 0, "last_activity_date": 1543886165, "creation_date": 1543884470, "last_edit_date": 1543885731, "question_id": 53604103, "link": "https://stackoverflow.com/questions/53604103/how-to-use-link-to-in-an-admin-section-correctly-in-rails", "title": "How to use &quot;link_to&quot; in an Admin section correctly in Rails", "body": "<p>So I have an app which has an admin section. The admin section has a challenges controller with an index method and a view index. </p>\n\n<p>I have also a challenges controller seperate from the admin folder. This controller has the whole CRUD. </p>\n\n<p>Every challenge belongs_to a subject. The controller subjects in the admin section has an index method and view. The controller subjects not in the admin section has the whole CRUD. </p>\n\n<p>Now, in the view of subjects (NOT the admin section), I can do something like: </p>\n\n<pre><code>&lt;%= link_to \"New Challenge\".html_safe, new_subject_challenge_path(@subject) %&gt;\n</code></pre>\n\n<p>I would like to do the same in the admin-section, but I can't really figure out how to do it. Copying the code throws me an error: </p>\n\n<pre><code>No route matches {:action=&gt;\"new\", :controller=&gt;\"challenges\", :subject_id=&gt;nil} missing required keys: [:subject_id]\n</code></pre>\n\n<p>But I was hoping I could do this without additional routes....</p>\n\n<p>It seems like it should be easy but I don't really know how to handle this. Any help would be very much appreciated... I hope I explained myself well enough.  </p>\n\n<p>The admin routes are used with a namespace: </p>\n\n<pre><code>namespace :admin do\n    resources :paths, only: [:index, :new, :create, :update, :edit]\n    resources :users, only: [:index, :new, :create, :show, :edit, :update] \n</code></pre>\n\n<p>end </p>\n\n<pre><code>  resources :challenges, except: [:index, :destroy] do\n    resources :solutions, only: [:create]\n   end\n\nresources :subjects\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "activerecord", "exception-handling", "notifications"], "comments": [{"owner": {"reputation": 6547, "user_id": 148824, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/7CmFa.jpg?s=128&g=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/148824/tom"}, "edited": false, "score": 0, "creation_date": 1544642302, "post_id": 53603133, "comment_id": 94352491, "body": "Sudharsanan Muralidharan has a good Medium post on &quot;modular error handling&quot; in Rails, but if you don&#39;t have control at the ApplicationController level I&#39;m not aware if a method <a href=\"https://medium.com/rails-ember-beyond/error-handling-in-rails-the-modular-way-9afcddd2fe1b\" rel=\"nofollow noreferrer\">medium.com/rails-ember-beyond/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 1502, "user_id": 13708583, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/f0eqr.jpg?s=128&g=1", "display_name": "Christian Bruckmayer", "link": "https://stackoverflow.com/users/13708583/christian-bruckmayer"}, "is_accepted": false, "score": 0, "last_activity_date": 1591797221, "creation_date": 1591797221, "answer_id": 62305353, "question_id": 53603133, "link": "https://stackoverflow.com/questions/53603133/subscribe-to-rails-exceptions-using-activesupportnotifications-subscribe/62305353#62305353", "title": "Subscribe to Rails Exceptions, using ActiveSupport::Notifications.subscribe", "body": "<p>Exceptions are not handled as ActiveSupport notifications, a full list can be found here <a href=\"https://guides.rubyonrails.org/active_support_instrumentation.html\" rel=\"nofollow noreferrer\">https://guides.rubyonrails.org/active_support_instrumentation.html</a>.</p>\n\n<p>However, you can hook into the <code>ActionController</code> in a railties.</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>module YourGem\n  module Rails\n    class Railtie &lt; ::Rails::Railtie\n        config.after_initialize do\n          ActiveSupport.on_load(:action_controller) do\n            rescue_from ActiveRecord::RecordNotFound, with: :record_not_found\n\n            private\n\n            def record_not_found(exception)\n              ActiveSupport::Notifications.instrument \"my.custom.event\", this: :data do\n                # do your custom stuff here\n              end\n            end\n          end\n       end\n    end\n  end\nend\n</code></pre>\n\n<p>With this approach you might not even need ActiveSupport Notifications and just execute your code in the rescue?</p>\n\n<p><a href=\"https://api.rubyonrails.org/classes/Rails/Railtie.html\" rel=\"nofollow noreferrer\">https://api.rubyonrails.org/classes/Rails/Railtie.html</a></p>\n"}], "owner": {"reputation": 529, "user_id": 1861693, "user_type": "registered", "accept_rate": 10, "profile_image": "https://www.gravatar.com/avatar/52042c33381aba0c98765850ae930af9?s=128&d=identicon&r=PG", "display_name": "Martin Sommer", "link": "https://stackoverflow.com/users/1861693/martin-sommer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 195, "favorite_count": 0, "answer_count": 1, "score": 7, "last_activity_date": 1591797221, "creation_date": 1543877394, "last_edit_date": 1544553255, "question_id": 53603133, "link": "https://stackoverflow.com/questions/53603133/subscribe-to-rails-exceptions-using-activesupportnotifications-subscribe", "title": "Subscribe to Rails Exceptions, using ActiveSupport::Notifications.subscribe", "body": "<p>I am exploring ActiveSupport::Notifications, and would like to subscribe to Rails Exceptions, such as the ActiveRecord::ActiveRecordError exception. Something like:</p>\n\n<pre><code>ActiveSupport::Notifications.subscribe /ActiveRecordError/ do |*args|\n\n  # More code here ...\n\nend\n</code></pre>\n\n<p>This subscription would exist in a 3rd party gem, so I don't have the flexibility to wrap my AcitveRecord calls with an \"in app\" begin/rescue/end. An underlying question, is are Exceptions considered and/or handled as events, that can be subscribed to?</p>\n"}, {"tags": ["arrays", "ruby", "loops"], "comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 1, "creation_date": 1543876679, "post_id": 53602986, "comment_id": 94068491, "body": "Do you want to find all the permutations of each element in the array? If so, hint: <a href=\"https://ruby-doc.org/core-2.5.0/Array.html#method-i-permutation\" rel=\"nofollow noreferrer\"><code>permutation</code></a>."}, {"owner": {"reputation": 185, "user_id": 10284901, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xuIJw.jpg?s=128&g=1", "display_name": "jeporcher", "link": "https://stackoverflow.com/users/10284901/jeporcher"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1543876751, "post_id": 53602986, "comment_id": 94068514, "body": "I am precisely trying to find a way to do this without <code>Array.permutation</code> because for larger numbers permutation is computationally very expensive."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1543876943, "post_id": 53602986, "comment_id": 94068577, "body": "Your approach here of randomly picking digits and testing for matches is going to be exponentially less efficient."}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 1, "creation_date": 1543877330, "post_id": 53602986, "comment_id": 94068708, "body": "You can <i>sort</i> the two lists, and then check if the sorted lists are equal."}, {"owner": {"reputation": 185, "user_id": 10284901, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xuIJw.jpg?s=128&g=1", "display_name": "jeporcher", "link": "https://stackoverflow.com/users/10284901/jeporcher"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1543877997, "post_id": 53602986, "comment_id": 94068923, "body": "@WillemVanOnsem This helped me immensely. Thanks!"}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1543888295, "post_id": 53602986, "comment_id": 94071448, "body": "@tadman, I edited the question. Please reconsider the hold."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 1, "creation_date": 1543888408, "post_id": 53602986, "comment_id": 94071474, "body": "jeporcher, I trust you will approve of my edit to your question. The fact that you accepted @Kache&#39;s answer gave me confidence that my understanding of the question is correct."}, {"owner": {"reputation": 185, "user_id": 10284901, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xuIJw.jpg?s=128&g=1", "display_name": "jeporcher", "link": "https://stackoverflow.com/users/10284901/jeporcher"}, "reply_to_user": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1543921223, "post_id": 53602986, "comment_id": 94083775, "body": "@CarySwoveland Thanks for the edit! And there&#39;s nothing sad about a postdoc in philosophy learning to code, trust me. I&#39;m enjoying myself a hell of a lot!"}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 2, "creation_date": 1543927993, "post_id": 53602986, "comment_id": 94087544, "body": "To avoid flagging it&#39;s usually best to express your question in terms of what input you have and what output you require in terms of actual Ruby code. The ambiguity here was if those arrays you&#39;re comparing to are generated, derived, or are instead given as input. When phrasing your question try and steer towards sketching it out as code, as an example with <code>def find_permutations(match, *list)</code> with a few demonstration calls, despite not having an implementation, would make your intent clear."}, {"owner": {"reputation": 185, "user_id": 10284901, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xuIJw.jpg?s=128&g=1", "display_name": "jeporcher", "link": "https://stackoverflow.com/users/10284901/jeporcher"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 1, "creation_date": 1543931383, "post_id": 53602986, "comment_id": 94089463, "body": "@tadman Thanks for your input. Will keep it in mind from now on."}], "answers": [{"comments": [{"owner": {"reputation": 185, "user_id": 10284901, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xuIJw.jpg?s=128&g=1", "display_name": "jeporcher", "link": "https://stackoverflow.com/users/10284901/jeporcher"}, "edited": false, "score": 0, "creation_date": 1543879040, "post_id": 53603245, "comment_id": 94069196, "body": "Thanks a lot for your thoughtful response. I got the desired results comparing the sorted arrays."}], "tags": [], "owner": {"reputation": 11603, "user_id": 234593, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/8e2ee1b00d372ad8f6ed5e87385ffef5?s=128&d=identicon&r=PG", "display_name": "Kache", "link": "https://stackoverflow.com/users/234593/kache"}, "is_accepted": true, "score": 2, "last_activity_date": 1543878443, "last_edit_date": 1543878443, "creation_date": 1543878034, "answer_id": 53603245, "question_id": 53602986, "link": "https://stackoverflow.com/questions/53602986/looping-to-find-out-which-array-has-the-same-digits-as-original-array-in-ruby/53603245#53603245", "title": "Looping to find out which array has the same digits as original array in Ruby", "body": "<p>assuming all the arrays are already in memory anyways, it's simplest just to do:</p>\n\n<pre><code>sorted_initial_arr = [1, 2, 3].sort\narr_list = [[2, 3, 1], [3, 1, 1], [3, 2, 2]]\n\narr_list.any? { |arr| arr.sort == sorted_initial_arr }\n</code></pre>\n\n<p>more \"conceptually\":</p>\n\n<pre><code># some function to do \"unordered equality\"\nunordered_equality_to_inital_arr = -&gt;(arr) { arr.sort == sorted_initial_arr }\n\n# apply that function across the array of arrays\narr_list.any?(&amp;unordered_equality_to_inital_arr)\n</code></pre>\n\n<p>The <code>unordered_equality_to_inital_arr</code> component could be implemented in several ways, e.g. using <code>permutation</code> as you mentioned, the differences being how they'd perform.</p>\n"}, {"comments": [{"owner": {"reputation": 185, "user_id": 10284901, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xuIJw.jpg?s=128&g=1", "display_name": "jeporcher", "link": "https://stackoverflow.com/users/10284901/jeporcher"}, "edited": false, "score": 0, "creation_date": 1543931497, "post_id": 53603829, "comment_id": 94089540, "body": "Outstanding! Thanks a lot for your considerate and thorough response."}], "tags": [], "owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "is_accepted": false, "score": 2, "last_activity_date": 1591736519, "last_edit_date": 1591736519, "creation_date": 1543882077, "answer_id": 53603829, "question_id": 53602986, "link": "https://stackoverflow.com/questions/53602986/looping-to-find-out-which-array-has-the-same-digits-as-original-array-in-ruby/53603829#53603829", "title": "Looping to find out which array has the same digits as original array in Ruby", "body": "<pre><code>arr = [[2, 3, 1, 3], [3, 1, 1, 3], [3, 2, 2, 1]]\ntarget = [1, 2, 3, 2].group_by(&amp;:itself)\n  #=&gt; {1=&gt;[1], 2=&gt;[2, 2], 3=&gt;[3]}\n\narr.any? { |a| a.group_by(&amp;:itself) == target }\n  #=&gt; true\n</code></pre>\n\n<p>Note </p>\n\n<pre><code>arr.map { |a| a.group_by(&amp;:itself) }\n  #=&gt; [{2=&gt;[2], 3=&gt;[3, 3], 1=&gt;[1]},\n  #    {3=&gt;[3, 3], 1=&gt;[1, 1]}, \n  #    {3=&gt;[3], 2=&gt;[2, 2], 1=&gt;[1]}]\n{1=&gt;[1], 2=&gt;[2, 2], 3=&gt;[3]} == {3=&gt;[3], 2=&gt;[2, 2], 1=&gt;[1]}\n  #=&gt; true\n</code></pre>\n\n<p>The use of <a href=\"http://ruby-doc.org/core-2.5.1/Enumerable.html#method-i-group_by\" rel=\"nofollow noreferrer\">Enumerable#group_by</a>, being a single-pass calculation (for each element of <code>arr</code>), is more efficient than sorting. In terms of computational complexity, <code>group_by</code> is almost O(<code>n</code>) (\"almost\" as hash lookups are almost O(<code>1</code>)), whereas <a href=\"http://ruby-doc.org/core-2.5.1/Array.html#method-i-sort\" rel=\"nofollow noreferrer\">Array#sort</a> (quicksort) is O(<code>n log n</code>), <code>n</code> being the size of an element of <code>arr</code>.</p>\n\n<p>An alternative is to use a <em>counting hash</em>:</p>\n\n<pre><code>target = [1, 2, 3, 2].each_with_object(Hash.new(0)) { |n,h| h[n] += 1 }\n  #=&gt; {1=&gt;1, 2=&gt;2, 3=&gt;1}\narr.any? { |a| a.each_with_object(Hash.new(0)) { |n,h| h[n] += 1 } == target }\n  #=&gt; true\n</code></pre>\n\n<p>which is also a single-pass operation.</p>\n\n<p>The following may be even faster, as the comparison of each element of <code>arr</code> with <code>target</code> terminates as soon as it can be concluded that there is no match in the counts. For example, if, as before,</p>\n\n<pre><code>target\n  #=&gt; {1=&gt;1, 2=&gt;2, 3=&gt;1}\n</code></pre>\n\n<p>and</p>\n\n<pre><code>a = [1, 1, 2, 3]\n</code></pre>\n\n<p>it will be concluded that the there is no match as soon as the second <code>1</code> in <code>a</code> is examined. The calculation is as follows.</p>\n\n<pre><code>arr.any? do |a|\n  t = target.dup\n  a.each do |n|\n    break false unless t.key?(n)\n    t[n] &gt; 1 ? (t[n] -= 1) : t.delete(n)\n  end &amp;&amp; t.empty?        \nend\n  #=&gt; true\n</code></pre>\n"}], "owner": {"reputation": 185, "user_id": 10284901, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xuIJw.jpg?s=128&g=1", "display_name": "jeporcher", "link": "https://stackoverflow.com/users/10284901/jeporcher"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 63, "favorite_count": 0, "closed_date": 1543883609, "accepted_answer_id": 53603245, "answer_count": 2, "score": 1, "last_activity_date": 1591736519, "creation_date": 1543876475, "last_edit_date": 1543889349, "question_id": 53602986, "link": "https://stackoverflow.com/questions/53602986/looping-to-find-out-which-array-has-the-same-digits-as-original-array-in-ruby", "closed_reason": "Needs more focus", "title": "Looping to find out which array has the same digits as original array in Ruby", "body": "<p>Given an \"initial array\" (say <code>[1, 2, 13]</code>) how can I implement a way to loop through an array of sub-arrays, all of which have the same size as the initial array (for example, <code>arr = [[2, 13, 1], [13, 1, 1], [13, 2, 2]]</code>) and find out if at least one sub-array has the same values as the values in the initial array, and the counts of each of those values is the same in both arrays?</p>\n\n<p>In the above example <code>[1, 2, 13]</code> and <code>[2, 13, 1]</code> both have one <code>1</code>, one <code>2</code> and one <code>13</code>, so <code>true</code> should be returned. If the first element of <code>arr</code> were instead, say, <code>[2, 1, 1]</code>, <code>false</code> should be returned as no element of <code>arr</code> has counts of its elements that are the same as the counts of the elements in the initial array.</p>\n"}, {"tags": ["ruby", "activerecord", "notifications", "instantiation", "activesupport"], "answers": [{"comments": [{"owner": {"reputation": 529, "user_id": 1861693, "user_type": "registered", "accept_rate": 10, "profile_image": "https://www.gravatar.com/avatar/52042c33381aba0c98765850ae930af9?s=128&d=identicon&r=PG", "display_name": "Martin Sommer", "link": "https://stackoverflow.com/users/1861693/martin-sommer"}, "edited": false, "score": 0, "creation_date": 1544748950, "post_id": 53739924, "comment_id": 94396112, "body": "Pavel, even though you said it could not be done, your two links headed me in the right direction. I am giving you the bounty ... Thanks!  ...  Oh, never say can&#39;t. :)"}, {"owner": {"reputation": 2487, "user_id": 8098012, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0cbdb5ca9b079de1c9700271166feead?s=128&d=identicon&r=PG", "display_name": "Pavel Mikhailyuk", "link": "https://stackoverflow.com/users/8098012/pavel-mikhailyuk"}, "reply_to_user": {"reputation": 529, "user_id": 1861693, "user_type": "registered", "accept_rate": 10, "profile_image": "https://www.gravatar.com/avatar/52042c33381aba0c98765850ae930af9?s=128&d=identicon&r=PG", "display_name": "Martin Sommer", "link": "https://stackoverflow.com/users/1861693/martin-sommer"}, "edited": false, "score": 0, "creation_date": 1544774028, "post_id": 53739924, "comment_id": 94402141, "body": "Thank you! Monkeypatching can do everything in Ruby :) I believe, <code>ActiveSupport::Notifications</code> was initially designed for simple logging and watching."}, {"owner": {"reputation": 529, "user_id": 1861693, "user_type": "registered", "accept_rate": 10, "profile_image": "https://www.gravatar.com/avatar/52042c33381aba0c98765850ae930af9?s=128&d=identicon&r=PG", "display_name": "Martin Sommer", "link": "https://stackoverflow.com/users/1861693/martin-sommer"}, "edited": false, "score": 0, "creation_date": 1544808832, "post_id": 53739924, "comment_id": 94420286, "body": "Yeah, I am not crazy about the term &quot;Monkeypatching&quot;, but I could not find a better way to change behavior of the ActiveRecord gem &quot;from my gem&quot;, and without adding code to the host app. If someone can demonstrate, I am more than happy to listen."}, {"owner": {"reputation": 2487, "user_id": 8098012, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0cbdb5ca9b079de1c9700271166feead?s=128&d=identicon&r=PG", "display_name": "Pavel Mikhailyuk", "link": "https://stackoverflow.com/users/8098012/pavel-mikhailyuk"}, "reply_to_user": {"reputation": 529, "user_id": 1861693, "user_type": "registered", "accept_rate": 10, "profile_image": "https://www.gravatar.com/avatar/52042c33381aba0c98765850ae930af9?s=128&d=identicon&r=PG", "display_name": "Martin Sommer", "link": "https://stackoverflow.com/users/1861693/martin-sommer"}, "edited": false, "score": 0, "creation_date": 1544809463, "post_id": 53739924, "comment_id": 94420541, "body": "I don&#39;t think that there is another way. Yep, we have to patch framework when it has no needed API from scratch."}, {"owner": {"reputation": 529, "user_id": 1861693, "user_type": "registered", "accept_rate": 10, "profile_image": "https://www.gravatar.com/avatar/52042c33381aba0c98765850ae930af9?s=128&d=identicon&r=PG", "display_name": "Martin Sommer", "link": "https://stackoverflow.com/users/1861693/martin-sommer"}, "edited": false, "score": 0, "creation_date": 1544832262, "post_id": 53739924, "comment_id": 94428303, "body": "Thanks Pavel, I created two pull requests on ActiveRecord. See above."}], "tags": [], "owner": {"reputation": 2487, "user_id": 8098012, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0cbdb5ca9b079de1c9700271166feead?s=128&d=identicon&r=PG", "display_name": "Pavel Mikhailyuk", "link": "https://stackoverflow.com/users/8098012/pavel-mikhailyuk"}, "is_accepted": false, "score": 1, "last_activity_date": 1544607094, "creation_date": 1544607094, "answer_id": 53739924, "question_id": 53602951, "link": "https://stackoverflow.com/questions/53602951/extend-the-activesupportnotifications-subscribe-instantiation-active-record-h/53739924#53739924", "title": "Extend the ActiveSupport::Notifications.subscribe, instantiation.active_record hook", "body": "<blockquote>\n  <p>Can this be done, and if so, how?</p>\n</blockquote>\n\n<p>I don't think so.</p>\n\n<p>Take a look at <a href=\"https://github.com/rails/rails/blob/d41ec8180d3df391e5fc0189f499d8689ca27e03/activerecord/lib/active_record/associations/join_dependency.rb#L105-L112\" rel=\"nofollow noreferrer\">this</a> and <a href=\"https://github.com/rails/rails/blob/89595aff8ee6d7dd05f84570a84aa9b4232a5207/activerecord/lib/active_record/querying.rb#L45-L52\" rel=\"nofollow noreferrer\">this</a> - in both cases <code>payload</code> is a Hash with only <code>record_count</code> and <code>class_name</code> options. No extra options than described in the guide.</p>\n"}, {"tags": [], "owner": {"reputation": 1276, "user_id": 5399937, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ctCqj.png?s=128&g=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/5399937/tom"}, "is_accepted": false, "score": 1, "last_activity_date": 1544666199, "last_edit_date": 1544666199, "creation_date": 1544652109, "answer_id": 53752046, "question_id": 53602951, "link": "https://stackoverflow.com/questions/53602951/extend-the-activesupportnotifications-subscribe-instantiation-active-record-h/53752046#53752046", "title": "Extend the ActiveSupport::Notifications.subscribe, instantiation.active_record hook", "body": "<p>You can create a <a href=\"https://guides.rubyonrails.org/active_support_instrumentation.html#creating-custom-events\" rel=\"nofollow noreferrer\">custom hook</a> with <code>::instrument</code>. You can then define a payload that has <code>status</code>, <code>result_set</code>, etc, and define their behavior in the block.</p>\n\n<p>You can find more robust documentation on <code>::instrument</code> and <code>::subscribe</code> <a href=\"https://api.rubyonrails.org/classes/ActiveSupport/Notifications.html\" rel=\"nofollow noreferrer\">here</a>.</p>\n\n<p>EDIT: I was looking into this more and came across <a href=\"https://stackoverflow.com/a/14374349/5399937\">this stack overflow question</a>.  It looks like the method <code>append_info_to_payload</code> is what you are looking for. It has been moved to a <a href=\"https://api.rubyonrails.org/classes/ActionController/Instrumentation.html#method-i-append_info_to_payload\" rel=\"nofollow noreferrer\">private method</a> is Rails 5. </p>\n\n<p>One last edit: If you are feeling brave the notification is used <a href=\"https://github.com/rails/rails/blob/d41ec8180d3df391e5fc0189f499d8689ca27e03/activerecord/lib/active_record/associations/join_dependency.rb#L112\" rel=\"nofollow noreferrer\">here</a> and <a href=\"https://github.com/rails/rails/blob/master/activerecord/lib/active_record/querying.rb#L52\" rel=\"nofollow noreferrer\">here</a> if you want to insert your extra payload directly \ud83d\ude36.</p>\n"}], "owner": {"reputation": 529, "user_id": 1861693, "user_type": "registered", "accept_rate": 10, "profile_image": "https://www.gravatar.com/avatar/52042c33381aba0c98765850ae930af9?s=128&d=identicon&r=PG", "display_name": "Martin Sommer", "link": "https://stackoverflow.com/users/1861693/martin-sommer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 357, "favorite_count": 0, "answer_count": 2, "score": 6, "last_activity_date": 1544832152, "creation_date": 1543876254, "last_edit_date": 1544832152, "question_id": 53602951, "link": "https://stackoverflow.com/questions/53602951/extend-the-activesupportnotifications-subscribe-instantiation-active-record-h", "title": "Extend the ActiveSupport::Notifications.subscribe, instantiation.active_record hook", "body": "<p>I am exploring <code>ActiveSupport::Notifications</code>, and would like more information about <code>'instantiation.active_record'</code>, than just the <code>:record_count</code> and <code>:class_name</code> <a href=\"https://guides.rubyonrails.org/active_support_instrumentation.html#instantiation-active-record\" rel=\"nofollow noreferrer\">[1]</a>. For example,</p>\n\n<pre><code>ActiveSupport::Notifications.subscribe /instantiation.active_record/ do |*args|\n\n  args.status #Database or ActiveRecord return status\n  args.result #The actual result set returned\n  args.etc .. #Any other info I can collect on the event\n\n  # Additional code ...\nend\n</code></pre>\n\n<p>Can this be done, and if so, how?</p>\n\n<p>Update:\nThanks to Tom and Pavel below. Part of the challenge, is that I am building a 3rd party gem, that will analyze all SQL returns of the host app, without requiring the modification of their code. Basically, plug it into the Gemfile, do a bundle, and away you go.</p>\n\n<p>I am considering <a href=\"https://stackoverflow.com/questions/2328984/rails-extending-activerecordbase\">extending ActiveRecord::Base</a>, and <a href=\"https://stackoverflow.com/questions/13633361/how-to-add-attribute-to-existing-notifications-payload/14374349#14374349\">using the method append_info_to_payload</a>, but thus far have neither working in a gem.</p>\n\n<p>As an example, I would like to overwrite the ActiveRecord::Querying find_by_sql() method's payload, to look like this:</p>\n\n<pre><code>payload = {\n  record_count: result_set.length,\n  class_name: name,\n  result_set: result_set\n}\n</code></pre>\n\n<p>In testing, and manually editing my local ActiveRecord gem, this delivers the complete result_set via ActiveSupport::Notifications pub/sub.</p>\n\n<p>Answer: So, the answer is to use the <code>class_eval</code> method, and overwrite the find_by_sql method in ActiveRecord::Querying:</p>\n\n<pre><code>ActiveRecord::Querying.class_eval do\n  def find_by_sql(sql, binds = [], preparable: nil, &amp;block)\n    result_set = connection.select_all(sanitize_sql(sql), \"#{name} Load\", binds, preparable: preparable)\n    column_types = result_set.column_types.dup\n    columns_hash.each_key { |k| column_types.delete k }\n    message_bus = ActiveSupport::Notifications.instrumenter\n\n    payload = {\n        record_count: result_set.length,\n        class_name: name,\n        result_set: result_set\n    }\n\n    message_bus.instrument(\"instantiation.active_record\", payload) do\n      result_set.map { |record| instantiate(record, column_types, &amp;block) }\n    end\n  end\nend\n</code></pre>\n\n<p>I added this to my gem's <code>initializer.rb</code> file.</p>\n\n<p>Final: I created two pull requests on ActiveRecord, to have the result_set pass forward in the payload for use in ActiveSupport::Notifications: <a href=\"https://github.com/rails/rails/pull/34712\" rel=\"nofollow noreferrer\">querying.rb</a> and <a href=\"https://github.com/rails/rails/pull/34713\" rel=\"nofollow noreferrer\">join_dependency.rb</a>.</p>\n"}, {"tags": ["arrays", "ruby"], "comments": [{"owner": {"reputation": 20644, "user_id": 184184, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f6a508697f9eca2680b12ddb85ba1319?s=128&d=identicon&r=PG", "display_name": "Lenin Raj Rajasekaran", "link": "https://stackoverflow.com/users/184184/lenin-raj-rajasekaran"}, "edited": false, "score": 1, "creation_date": 1543874857, "post_id": 53602643, "comment_id": 94067716, "body": "do you have an example input and output?"}, {"owner": {"reputation": 52685, "user_id": 980550, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/8emhY.jpg?s=128&g=1", "display_name": "lurker", "link": "https://stackoverflow.com/users/980550/lurker"}, "edited": false, "score": 0, "creation_date": 1543875284, "post_id": 53602643, "comment_id": 94067929, "body": "If you get your program working, you will have successfully written a C program using Ruby syntax. If you really want to learn Ruby, look at more Ruby examples and try to write it more Ruby-esque. :) Ruby <code>Array</code> has a <code>sort</code> method which can do a <code>yield</code> to a block for any pair of elements it wants to compare. Research that and think about adding a new method to <code>Array</code>, maybe called <code>odd_sort</code> that will <code>yield</code> to a block only when you need to for the odd pair checks."}, {"owner": {"reputation": 1, "user_id": 10166961, "user_type": "registered", "profile_image": "https://graph.facebook.com/2221398021208535/picture?type=large", "display_name": "Ricardo Lafontant", "link": "https://stackoverflow.com/users/10166961/ricardo-lafontant"}, "reply_to_user": {"reputation": 20644, "user_id": 184184, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f6a508697f9eca2680b12ddb85ba1319?s=128&d=identicon&r=PG", "display_name": "Lenin Raj Rajasekaran", "link": "https://stackoverflow.com/users/184184/lenin-raj-rajasekaran"}, "edited": false, "score": 0, "creation_date": 1543876741, "post_id": 53602643, "comment_id": 94068509, "body": "@emaillenin just added an example"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 10166961, "user_type": "registered", "profile_image": "https://graph.facebook.com/2221398021208535/picture?type=large", "display_name": "Ricardo Lafontant", "link": "https://stackoverflow.com/users/10166961/ricardo-lafontant"}, "edited": false, "score": 0, "creation_date": 1543879044, "post_id": 53603224, "comment_id": 94069202, "body": "thats what I&#39;m getting the desired output is: <code>[5, 7, 13, 8, 12, 17, 35, 37, 47,  64, 22, 47, 55]</code>"}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1543894156, "post_id": 53603224, "comment_id": 94072731, "body": "Your answer, after the edit, is the same as @steenslag&#39;s earlier answer."}, {"owner": {"reputation": 20644, "user_id": 184184, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f6a508697f9eca2680b12ddb85ba1319?s=128&d=identicon&r=PG", "display_name": "Lenin Raj Rajasekaran", "link": "https://stackoverflow.com/users/184184/lenin-raj-rajasekaran"}, "edited": false, "score": 0, "creation_date": 1543894862, "post_id": 53603224, "comment_id": 94072876, "body": "Yeah my original answer outputs <code>[5, 7, 35, 8, 12, 17, 37, 47, 47, 64, 22, 13, 55]</code> which was same as OP&#39;s output. I asked for example output in the comments but OP posted his actual output. I mistook that for expected output and added the answer."}], "tags": [], "owner": {"reputation": 20644, "user_id": 184184, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f6a508697f9eca2680b12ddb85ba1319?s=128&d=identicon&r=PG", "display_name": "Lenin Raj Rajasekaran", "link": "https://stackoverflow.com/users/184184/lenin-raj-rajasekaran"}, "is_accepted": false, "score": 0, "last_activity_date": 1543879554, "last_edit_date": 1543879554, "creation_date": 1543877911, "answer_id": 53603224, "question_id": 53602643, "link": "https://stackoverflow.com/questions/53602643/sort-odd-numbers-in-array-while-keeping-even-numbers-in-place/53603224#53603224", "title": "Sort odd numbers in array while keeping even numbers in place", "body": "<pre><code>source_array = [7, 5, 35, 8, 12, 17, 47, 47, 37, 64, 22, 55, 13]\nodd_sorted = source_array.select(&amp;:odd?).sort\n\nsource_array.map {|input| input.even? ? input : odd_sorted.shift }\n\n# [5, 7, 13, 8, 12, 17, 35, 37, 47, 64, 22, 47, 55]\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1543894076, "post_id": 53603414, "comment_id": 94072711, "body": "Nice and clean, and short! I prefer it to my solutions."}], "tags": [], "owner": {"reputation": 73209, "user_id": 290394, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/d7908f05c89e965f6bc5308ad6f41256?s=128&d=identicon&r=PG", "display_name": "steenslag", "link": "https://stackoverflow.com/users/290394/steenslag"}, "is_accepted": false, "score": 2, "last_activity_date": 1543879104, "creation_date": 1543879104, "answer_id": 53603414, "question_id": 53602643, "link": "https://stackoverflow.com/questions/53602643/sort-odd-numbers-in-array-while-keeping-even-numbers-in-place/53603414#53603414", "title": "Sort odd numbers in array while keeping even numbers in place", "body": "<p>You could try this approach:</p>\n\n<ul>\n<li>Create an array with all odds (leaving source_array intact).  Sort\nthis array. </li>\n<li>Consider source_array element by element. Is the\nelement even then leave it . If it is odd, then replace it with the\nfirst element on the sorted odds list. Remove the first element of the\nsorted list.</li>\n</ul>\n"}, {"comments": [{"owner": {"reputation": 1, "user_id": 10166961, "user_type": "registered", "profile_image": "https://graph.facebook.com/2221398021208535/picture?type=large", "display_name": "Ricardo Lafontant", "link": "https://stackoverflow.com/users/10166961/ricardo-lafontant"}, "edited": false, "score": 0, "creation_date": 1543893228, "post_id": 53604910, "comment_id": 94072525, "body": "Wow that did the trick. That was way simpler than I was making it out to be. Thanks!"}], "tags": [], "owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "is_accepted": true, "score": 0, "last_activity_date": 1543893767, "last_edit_date": 1543893767, "creation_date": 1543890981, "answer_id": 53604910, "question_id": 53602643, "link": "https://stackoverflow.com/questions/53602643/sort-odd-numbers-in-array-while-keeping-even-numbers-in-place/53604910#53604910", "title": "Sort odd numbers in array while keeping even numbers in place", "body": "<p>Here are a couple of ways to do that.</p>\n\n<pre><code>arr = [7, 5, 35, 8, 12, 17, 47, 47, 37, 64, 22, 55, 13]\n</code></pre>\n\n<p>Both begin with the following calculation</p>\n\n<pre><code>odd, even = arr.each_with_index.partition { |n,i| n.odd? }\n  #=&gt; [[[7, 0], [5, 1], [35, 2], [17, 5], [47, 6], [47, 7], [37, 8], [55, 11], [13, 12]],\n  #    [[8, 3], [12, 4], [64, 9], [22, 10]]]\nodd\n  #=&gt; [[7, 0], [5, 1], [35, 2], [17, 5], [47, 6], [47, 7], [37, 8], [55, 11], [13, 12]]\neven\n  #=&gt; [[8, 3], [12, 4], [64, 9], [22, 10]]\n</code></pre>\n\n<p>See <a href=\"http://ruby-doc.org/core-2.5.1/Enumerable.html#method-i-each_with_index\" rel=\"nofollow noreferrer\">Enumerable#each_with_index</a>, <a href=\"http://ruby-doc.org/core-2.5.1/Enumerable.html#method-i-partition\" rel=\"nofollow noreferrer\">Enumerable#partition</a> and <a href=\"http://ruby-doc.org/core-2.5.1/Integer.html#method-i-odd-3F\" rel=\"nofollow noreferrer\">Integer#odd?</a>.</p>\n\n<p><strong>#1</strong></p>\n\n<pre><code>   odd_val, odd_idx = odd.transpose\n     #=&gt; [[7, 5, 35, 17, 47, 47, 37, 55, 13],\n     #    [0, 1,  2,  5,  6,  7,  8, 11, 12]]\n   a = even.concat(odd_val.sort.zip(odd_idx))\n     #=&gt; [[8, 3], [12, 4], [64, 9], [22, 10], [5, 0], [7, 1], [13, 2],\n     #    [17, 5], [35, 6], [37, 7], [47, 8], [47, 11], [55, 12]]\n   h = a.map(&amp;:reverse).to_h\n     #=&gt; {3=&gt;8, 4=&gt;12, 9=&gt;64, 10=&gt;22, 0=&gt;5, 1=&gt;7, 2=&gt;13, 5=&gt;17, 6=&gt;35, 7=&gt;37,\n     #    8=&gt;47, 11=&gt;47, 12=&gt;55}\n   h.values_at(*0..arr.size-1)\n     #=&gt; [5, 7, 13, 8, 12, 17, 35, 37, 47, 64, 22, 47, 55]\n</code></pre>\n\n<p>Note:</p>\n\n<pre><code>odd_val.sort.zip(odd_idx)\n  #=&gt; [5, 7, 13, 17, 35, 37, 47, 47, 55].zip([0, 1,  2,  5,  6,  7,  8, 11, 12])\n  #=&gt; [[5, 0], [7, 1], [13, 2], [17, 5], [35, 6], [37, 7], [47, 8], [47, 11], [55, 12]]\n</code></pre>\n\n<p>See <a href=\"http://ruby-doc.org/core-2.5.1/Array.html#method-i-sort\" rel=\"nofollow noreferrer\">Array#sort</a>, <a href=\"http://ruby-doc.org/core-2.5.1/Array.html#method-i-zip\" rel=\"nofollow noreferrer\">Array#zip</a> and  <a href=\"http://ruby-doc.org/core-2.5.1/Hash.html#method-i-values_at\" rel=\"nofollow noreferrer\">Hash#values_at</a>.</p>\n\n<p><strong>#2</strong></p>\n\n<pre><code>a = odd.map(&amp;:first).sort\n  #=&gt; [5, 7, 13, 17, 35, 37, 47, 47, 55]\neven.each { |n,i| a.insert(i,n) }\na #=&gt; [5, 7, 13, 8, 12, 17, 35, 37, 47, 64, 22, 47, 55]\n</code></pre>\n\n<p>See <a href=\"http://ruby-doc.org/core-2.5.1/Array.html#method-i-insert\" rel=\"nofollow noreferrer\">Array#insert</a>.</p>\n"}], "owner": {"reputation": 1, "user_id": 10166961, "user_type": "registered", "profile_image": "https://graph.facebook.com/2221398021208535/picture?type=large", "display_name": "Ricardo Lafontant", "link": "https://stackoverflow.com/users/10166961/ricardo-lafontant"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 583, "favorite_count": 1, "accepted_answer_id": 53604910, "answer_count": 3, "score": -1, "last_activity_date": 1543898530, "creation_date": 1543874696, "last_edit_date": 1543898530, "question_id": 53602643, "link": "https://stackoverflow.com/questions/53602643/sort-odd-numbers-in-array-while-keeping-even-numbers-in-place", "title": "Sort odd numbers in array while keeping even numbers in place", "body": "<p>I'm working on a coding challenge to sort the odd elements of an array while keeping all even elements in their initial position.</p>\n\n<p>I can sort the odd elements in groups between even elements while leaving the evens alone, but I want them to be ordered throughout the array. Here is my code:</p>\n\n<pre><code>def sort_array source_array\n  return [] if source_array.empty?\n  a = source_array\n  n = a.length\n  loop do\n    swapped = false\n    (n - 1).times do |i|\n      if (a[i] &gt; a[i + 1]) &amp;&amp; a[i].odd? &amp;&amp; a[i + 1].odd?\n        a[i], a[i + 1] = a[i + 1], a[i]\n        swapped = true\n      end\n    end\n    break if not swapped\n  end\n  a\nend\n\nsource_array = [7, 5, 35, 8, 12, 17, 47, 47, 37, 64, 22, 55, 13]\np sort_array(source_array)\n# =&gt; [5, 7, 35, 8, 12, 17, 37, 47, 47, 64, 22, 13, 55]\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-5", "rails-migrations"], "comments": [{"owner": {"reputation": 2412, "user_id": 1253504, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/1ba0b6bef219b34fa4f2d014046ff987?s=128&d=identicon&r=PG", "display_name": "kasperite", "link": "https://stackoverflow.com/users/1253504/kasperite"}, "edited": false, "score": 0, "creation_date": 1543869784, "post_id": 53601466, "comment_id": 94065615, "body": "why using rake task here if your intention is to use migration?These <code>updates</code> can be part of migration themselves"}, {"owner": {"reputation": 147, "user_id": 6889551, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/151127b7cf7df34b62b2c7dc4b1be359?s=128&d=identicon&r=PG&f=1", "display_name": "Rana. Amir", "link": "https://stackoverflow.com/users/6889551/rana-amir"}, "reply_to_user": {"reputation": 2412, "user_id": 1253504, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/1ba0b6bef219b34fa4f2d014046ff987?s=128&d=identicon&r=PG", "display_name": "kasperite", "link": "https://stackoverflow.com/users/1253504/kasperite"}, "edited": false, "score": 0, "creation_date": 1543869864, "post_id": 53601466, "comment_id": 94065657, "body": "because this is a requirement of my client therefore I need this."}], "answers": [{"comments": [{"owner": {"reputation": 147, "user_id": 6889551, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/151127b7cf7df34b62b2c7dc4b1be359?s=128&d=identicon&r=PG&f=1", "display_name": "Rana. Amir", "link": "https://stackoverflow.com/users/6889551/rana-amir"}, "edited": false, "score": 0, "creation_date": 1543870302, "post_id": 53601560, "comment_id": 94065861, "body": "I&#39;m using PGSql could you please convert in to according to this?"}, {"owner": {"reputation": 3119, "user_id": 4842949, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-0agpj31wtZ8/AAAAAAAAAAI/AAAAAAAAAAA/mSolbNN-zIY/photo.jpg?sz=128", "display_name": "Joseph Cho", "link": "https://stackoverflow.com/users/4842949/joseph-cho"}, "reply_to_user": {"reputation": 147, "user_id": 6889551, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/151127b7cf7df34b62b2c7dc4b1be359?s=128&d=identicon&r=PG&f=1", "display_name": "Rana. Amir", "link": "https://stackoverflow.com/users/6889551/rana-amir"}, "edited": false, "score": 0, "creation_date": 1543870427, "post_id": 53601560, "comment_id": 94065918, "body": "Sure, I updated it. I don&#39;t know what your <code>logs</code> table is named so you may need to change it accordingly. Here is the reference I used: <a href=\"https://www.oreilly.com/library/view/practical-postgresql/9781449309770/ch04s05.html\" rel=\"nofollow noreferrer\">oreilly.com/library/view/practical-postgresql/9781449309770/&zwnj;&#8203;&hellip;</a>"}, {"owner": {"reputation": 147, "user_id": 6889551, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/151127b7cf7df34b62b2c7dc4b1be359?s=128&d=identicon&r=PG&f=1", "display_name": "Rana. Amir", "link": "https://stackoverflow.com/users/6889551/rana-amir"}, "edited": false, "score": 0, "creation_date": 1543871511, "post_id": 53601560, "comment_id": 94066370, "body": "run just remove table from SQL command. thanks it&#39;s working fine."}, {"owner": {"reputation": 5060, "user_id": 10522579, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7GQ6a.jpg?s=128&g=1", "display_name": "ray", "link": "https://stackoverflow.com/users/10522579/ray"}, "edited": false, "score": 0, "creation_date": 1543908927, "post_id": 53601560, "comment_id": 94077102, "body": "@JosephCho Up-voting for appropriate one. :)"}], "tags": [], "owner": {"reputation": 3119, "user_id": 4842949, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-0agpj31wtZ8/AAAAAAAAAAI/AAAAAAAAAAA/mSolbNN-zIY/photo.jpg?sz=128", "display_name": "Joseph Cho", "link": "https://stackoverflow.com/users/4842949/joseph-cho"}, "is_accepted": true, "score": 5, "last_activity_date": 1594736461, "last_edit_date": 1594736461, "creation_date": 1543869733, "answer_id": 53601560, "question_id": 53601466, "link": "https://stackoverflow.com/questions/53601466/how-to-run-rake-task-using-rails-migration/53601560#53601560", "title": "how to run rake task using rails migration", "body": "<p>Migrations are really just Ruby files following a convention, so if you want to run a rake task inside of them you can just call the Rake class.</p>\n<pre><code>class ExampleMigration &lt; ActiveRecord::Migration[5.0]\n  def change\n    Rake::Task['task_for_log'].invoke\n  end\nend\n</code></pre>\n<p>However, migration files should be used specifically to handle the database schema. I would rethink how you are approaching the problem for a better solution. For example, you could run a SQL statement that updates your log attributes instead of calling a rake task.</p>\n<pre><code>class ExampleMigration &lt; ActiveRecord::Migration[5.0]\n  def change\n    execute &lt;&lt;-SQL\n      UPDATE logs SET log_date = created_at WHERE log_date IS NULL\n    SQL\n  end\nend\n</code></pre>\n<p>References:</p>\n<ul>\n<li><a href=\"https://stackoverflow.com/questions/5641747/rails-how-to-run-rake-task\">Rails how to run rake task</a></li>\n<li><a href=\"https://edgeguides.rubyonrails.org/active_record_migrations.html\" rel=\"nofollow noreferrer\">https://edgeguides.rubyonrails.org/active_record_migrations.html</a></li>\n</ul>\n"}, {"comments": [{"owner": {"reputation": 147, "user_id": 6889551, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/151127b7cf7df34b62b2c7dc4b1be359?s=128&d=identicon&r=PG&f=1", "display_name": "Rana. Amir", "link": "https://stackoverflow.com/users/6889551/rana-amir"}, "edited": false, "score": 0, "creation_date": 1543871398, "post_id": 53601797, "comment_id": 94066335, "body": "but my client this approach is not good because we have to run this task by manual command therefore we have to make a migration file where this task run"}], "tags": [], "owner": {"reputation": 5237, "user_id": 2325924, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/XSXrT.jpg?s=128&g=1", "display_name": "7urkm3n", "link": "https://stackoverflow.com/users/2325924/7urkm3n"}, "is_accepted": false, "score": 1, "last_activity_date": 1543870845, "last_edit_date": 1592644375, "creation_date": 1543870845, "answer_id": 53601797, "question_id": 53601466, "link": "https://stackoverflow.com/questions/53601466/how-to-run-rake-task-using-rails-migration/53601797#53601797", "title": "how to run rake task using rails migration", "body": "<p>You can go as @joseph mention better solution! Or create custom task for it.</p>\n<h3>rake:</h3>\n<pre><code>rake cm:set_by_default_date_of_log\n</code></pre>\n<h3>task:</h3>\n<pre><code>#lib/tasks/cm.rake\n#custom_migration\nnamespace :cm do\n  desc &quot;This task set by default as current date for those logs where log_date is nil&quot;\n  task set_by_default_date_of_log: ['db:migrate'] do\n    Log.where(&quot;log_date IS NULL&quot;).each do |log|\n      log.update_attributes(log_date: log.created_at.to_date)\n    end\n  end\nend\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 3201, "user_id": 2892779, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uvM8S.jpg?s=128&g=1", "display_name": "Jay Dorsey", "link": "https://stackoverflow.com/users/2892779/jay-dorsey"}, "is_accepted": false, "score": 2, "last_activity_date": 1543874455, "last_edit_date": 1543874455, "creation_date": 1543873437, "answer_id": 53602363, "question_id": 53601466, "link": "https://stackoverflow.com/questions/53601466/how-to-run-rake-task-using-rails-migration/53602363#53602363", "title": "how to run rake task using rails migration", "body": "<p>If you want to run your task <em>after</em> you run <code>db:migrate</code> automatically, you can use <code>enhance</code>.</p>\n\n<pre><code>Rake::Task['db:migrate'].enhance do\n  # This task runs after every time you run `db:migrate`\n  Rake::Task['task_for_log:set_by_default_date_of_log'].invoke\nend\n</code></pre>\n\n<p>For a rails application, you can put this anywhere inside <code>lib/tasks</code> folder or put your task inline (inside of the <code>.enhance do</code> block)</p>\n"}], "owner": {"reputation": 147, "user_id": 6889551, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/151127b7cf7df34b62b2c7dc4b1be359?s=128&d=identicon&r=PG&f=1", "display_name": "Rana. Amir", "link": "https://stackoverflow.com/users/6889551/rana-amir"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2583, "favorite_count": 0, "accepted_answer_id": 53601560, "answer_count": 3, "score": 3, "last_activity_date": 1594736461, "creation_date": 1543869284, "question_id": 53601466, "link": "https://stackoverflow.com/questions/53601466/how-to-run-rake-task-using-rails-migration", "title": "how to run rake task using rails migration", "body": "<p>I want to run rake task using migration because we want when a user run <code>rails db:migrate</code> then this task will be run through migration.</p>\n\n<p>my rake task is:</p>\n\n<pre><code>namespace :task_for_log do\n\n  desc \"This task set by default as current date for those logs where log_date is nil\"\n  task set_by_default_date_of_log: :environment do\n    Log.where(\"log_date IS NULL\").each do |log|\n      log.update_attributes(log_date: log.created_at.to_date)\n    end\n  end\n\nend\n</code></pre>\n\n<p>please guide what will be migration that run this task, any body here who will be save my life??</p>\n"}, {"tags": ["ruby", "lambda", "syntax", "proc"], "comments": [{"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1543868651, "post_id": 53601053, "comment_id": 94065079, "body": "BTW, that <code>block_given?</code> check is a bit out of idiom. Since you <i>are</i> capturing the block in the proc <code>b</code> (and using <code>b.call</code>), it would be more consistent to do <code>unless b.nil?</code> or something like that."}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "reply_to_user": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 2, "creation_date": 1543870319, "post_id": 53601053, "comment_id": 94065869, "body": "In addition to what @SergioTulentsev mentioned if you were going to use the <code>block_given?</code> without the captured block (<code>&amp;b</code>) this would generally be written as <code>def test; yield 1 if block_given? end;</code>"}], "answers": [{"comments": [{"owner": {"reputation": 21084, "user_id": 170931, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/WA698.png?s=128&g=1", "display_name": "Just a learner", "link": "https://stackoverflow.com/users/170931/just-a-learner"}, "edited": false, "score": 0, "creation_date": 1543868167, "post_id": 53601176, "comment_id": 94064852, "body": "Thank you for the answer. Do you have any reference material that explains <code>&amp;</code>? I can&#39;t find it in the document."}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "reply_to_user": {"reputation": 21084, "user_id": 170931, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/WA698.png?s=128&g=1", "display_name": "Just a learner", "link": "https://stackoverflow.com/users/170931/just-a-learner"}, "edited": false, "score": 1, "creation_date": 1543868468, "post_id": 53601176, "comment_id": 94064992, "body": "I don&#39;t have links to an &quot;official&quot; page, but here&#39;s a blog post that looks helpful: <a href=\"https://medium.com/@sihui/proc-code-block-conversion-and-ampersand-in-ruby-35cf524eef55\" rel=\"nofollow noreferrer\">medium.com/@sihui/&hellip;</a>"}], "tags": [], "owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "is_accepted": true, "score": 3, "last_activity_date": 1543868023, "creation_date": 1543868023, "answer_id": 53601176, "question_id": 53601053, "link": "https://stackoverflow.com/questions/53601053/what-does-it-mean-by-prefixing-a-to-a-raw-proc-object-not-lambda-in-ruby/53601176#53601176", "title": "What does it mean by prefixing a &amp; to a raw proc object (not lambda) in Ruby?", "body": "<blockquote>\n  <p>What does <code>&amp;</code> do here?</p>\n</blockquote>\n\n<p>Exactly that, convert proc to a block.</p>\n\n<blockquote>\n  <p>I don't have a block. What I have is a raw proc object (not lambda)</p>\n</blockquote>\n\n<p>Do you perhaps think these (proc and lambda) are two completely different entities? They're not. They're almost the same thing. </p>\n\n<pre><code>proc {} # =&gt; #&lt;Proc:0x00007fe50882ecc8@-:1&gt;\n-&gt; {} # =&gt; #&lt;Proc:0x00007fe50882e840@-:2 (lambda)&gt;\n</code></pre>\n\n<p>Certainly the same thing as far as <code>&amp;</code> operator is concerned.</p>\n"}], "owner": {"reputation": 21084, "user_id": 170931, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/WA698.png?s=128&g=1", "display_name": "Just a learner", "link": "https://stackoverflow.com/users/170931/just-a-learner"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 42, "favorite_count": 0, "accepted_answer_id": 53601176, "answer_count": 1, "score": 0, "last_activity_date": 1543868023, "creation_date": 1543867389, "question_id": 53601053, "link": "https://stackoverflow.com/questions/53601053/what-does-it-mean-by-prefixing-a-to-a-raw-proc-object-not-lambda-in-ruby", "title": "What does it mean by prefixing a &amp; to a raw proc object (not lambda) in Ruby?", "body": "<p>I'm using Ruby 2.5 for testing. I have the following code. </p>\n\n<pre><code>p = proc {|e| puts e}\n\ndef test &amp;b\n    b.call 1 if block_given?\nend\n\ntest &amp;p\n</code></pre>\n\n<p>The output is:</p>\n\n<pre><code>1\n</code></pre>\n\n<p><code>&amp;b</code> will make the variable <code>b</code> catch the passed in block. But in the demo, I don't have a block. What I have is a raw proc object (not lambda). It seems <code>&amp;p</code> converts the proc object back to a block, just as I write <code>test {|e| puts e}</code>. Is this ture? What does <code>&amp;</code> do here?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "devise"], "answers": [{"comments": [{"owner": {"reputation": 27, "user_id": 10735674, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/414ca17d7299a6b1d18f728fcc74a4f5?s=128&d=identicon&r=PG&f=1", "display_name": "Djjhjuser10735674", "link": "https://stackoverflow.com/users/10735674/djjhjuser10735674"}, "edited": false, "score": 0, "creation_date": 1543868281, "post_id": 53601127, "comment_id": 94064901, "body": "im getting this error now . &quot;app/controllers/registrations_controller.rb:11: syntax error, unexpected keyword_else else ^&quot;"}, {"owner": {"reputation": 2412, "user_id": 1253504, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/1ba0b6bef219b34fa4f2d014046ff987?s=128&d=identicon&r=PG", "display_name": "kasperite", "link": "https://stackoverflow.com/users/1253504/kasperite"}, "reply_to_user": {"reputation": 27, "user_id": 10735674, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/414ca17d7299a6b1d18f728fcc74a4f5?s=128&d=identicon&r=PG&f=1", "display_name": "Djjhjuser10735674", "link": "https://stackoverflow.com/users/10735674/djjhjuser10735674"}, "edited": false, "score": 0, "creation_date": 1543869203, "post_id": 53601127, "comment_id": 94065352, "body": "Updated my answer. The answer wasn&#39;t a copy&amp;paste as you need to set destination path after registration. I put <code>root_path</code> for now but change it to what you need"}], "tags": [], "owner": {"reputation": 2412, "user_id": 1253504, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/1ba0b6bef219b34fa4f2d014046ff987?s=128&d=identicon&r=PG", "display_name": "kasperite", "link": "https://stackoverflow.com/users/1253504/kasperite"}, "is_accepted": true, "score": 1, "last_activity_date": 1543869087, "last_edit_date": 1543869087, "creation_date": 1543867750, "answer_id": 53601127, "question_id": 53600596, "link": "https://stackoverflow.com/questions/53600596/devise-register-and-login-rails/53601127#53601127", "title": "Devise register and login rails", "body": "<p>You need to override <code>Devise::RegistrationsController#create</code>. You can see how registration works <a href=\"https://github.com/plataformatec/devise/blob/acc45c5a44c45b252ccba65fd169a45af73ff369/app/controllers/devise/registrations_controller.rb#L24\" rel=\"nofollow noreferrer\">here</a></p>\n\n<p>First, create a custom controller subclass of Devise::RegistrationsController </p>\n\n<pre><code>class RegistrationController &lt; Devise::RegistrationsController\n  def create\n    build_resource(sign_up_params)\n\n    resource.save\n    yield resource if block_given?\n    if resource.persisted?\n      if resource.active_for_authentication?\n        set_flash_message! :notice, :signed_up\n        respond_with resource, location: root_path # Change this to whatever route your want\n      else\n        set_flash_message! :notice, :\"signed_up_but_#{resource.inactive_message}\"\n        expire_data_after_sign_in!\n        respond_with resource, location: after_inactive_sign_up_path_for(resource)\n      end\n    else\n      clean_up_passwords resource\n      set_minimum_password_length\n      respond_with resource\n    end\n  end \nend\n</code></pre>\n\n<p>Then tell devise to use custom controller:</p>\n\n<p><code>devise_for :users, :controllers =&gt; {:registrations =&gt; \"registrations\"}</code></p>\n\n<p>Assuming <code>User</code> is the model of course.</p>\n"}], "owner": {"reputation": 27, "user_id": 10735674, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/414ca17d7299a6b1d18f728fcc74a4f5?s=128&d=identicon&r=PG&f=1", "display_name": "Djjhjuser10735674", "link": "https://stackoverflow.com/users/10735674/djjhjuser10735674"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 71, "favorite_count": 0, "accepted_answer_id": 53601127, "answer_count": 1, "score": 0, "last_activity_date": 1543869087, "creation_date": 1543865407, "question_id": 53600596, "link": "https://stackoverflow.com/questions/53600596/devise-register-and-login-rails", "title": "Devise register and login rails", "body": "<p>By default with devise. After a user registers it automatically signs them in after sign up. Is there anyway to register a user and not auto sign them in and redirect to the login page?</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1543873449, "post_id": 53600473, "comment_id": 94067157, "body": "A quick way of doing that for one file is to use <a href=\"https://ruby-doc.org/core-2.5.3/Enumerable.html#method-i-grep\" rel=\"nofollow noreferrer\">Enumerable#grep</a>: <code>puts File.foreach(file_name).grep(&#47;\\bScore\\b&#47;)</code>. <code>\\b</code> is a <i>word break</i> which prevents words such as <code>&quot;Scoreboard&quot;</code> from being matched. This does have the disadvantage that it produces a temporary array, but since you are printing, rather than saving, lines, I assume the files are only modest in size. Regardless of your approach you should consider using <a href=\"http://ruby-doc.org/core-2.5.1/IO.html#method-c-foreach\" rel=\"nofollow noreferrer\">IO::foreach</a> for reading files line-by-line."}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 10588070, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLSyg.png?s=128&g=1", "display_name": "Ebonite6", "link": "https://stackoverflow.com/users/10588070/ebonite6"}, "edited": false, "score": 0, "creation_date": 1543865881, "post_id": 53600547, "comment_id": 94063765, "body": "I get an error message when I try that: &quot;test.rb:3:in <code>block (2 levels) in &lt;main&gt;&#39;: undefined local variable or method &quot;</code>f &quot; for main:Object (NameError)&quot; I&#39;m still learning about the File and Dir objects so I really dont know what to do D:"}], "tags": [], "owner": {"reputation": 27144, "user_id": 3857758, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/58c4295826435f049b7fc32b98c240f9?s=128&d=identicon&r=PG&f=1", "display_name": "Ursus", "link": "https://stackoverflow.com/users/3857758/ursus"}, "is_accepted": true, "score": 1, "last_activity_date": 1543865902, "last_edit_date": 1543865902, "creation_date": 1543865179, "answer_id": 53600547, "question_id": 53600473, "link": "https://stackoverflow.com/questions/53600473/reading-every-file-in-a-directory-for-a-keyword/53600547#53600547", "title": "Reading every file in a directory for a keyword", "body": "<p>Try this way. <a href=\"https://ruby-doc.org/core-2.4.0/Dir.html\" rel=\"nofollow noreferrer\">https://ruby-doc.org/core-2.4.0/Dir.html</a></p>\n\n<pre><code>Dir[\"C:/Users/Cam/Desktop/Warmup/*\"].each do |filename|\n  File.open(filename) do |f|\n    f.each_line do |line|\n      if line.include? \"Score\" \n        puts line\n      end\n    end\n  end\nend\n</code></pre>\n\n<p>You can even search in subdirectories</p>\n\n<pre><code>Dir[\"C:/Users/Cam/Desktop/Warmup/**/*\"]\n</code></pre>\n\n<p>or a particular pattern</p>\n\n<pre><code>Dir[\"C:/Users/Cam/Desktop/Warmup/*.txt\"]\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 10588070, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLSyg.png?s=128&g=1", "display_name": "Ebonite6", "link": "https://stackoverflow.com/users/10588070/ebonite6"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 34, "favorite_count": 0, "accepted_answer_id": 53600547, "answer_count": 1, "score": 0, "last_activity_date": 1543865902, "creation_date": 1543864868, "question_id": 53600473, "link": "https://stackoverflow.com/questions/53600473/reading-every-file-in-a-directory-for-a-keyword", "title": "Reading every file in a directory for a keyword", "body": "<p>Currently, I'm trying to learn how to read every file in a directory and look for a persific keyword such as \"score\" </p>\n\n<p>Heres what I've gotten so far</p>\n\n<pre><code>    File.open(\"C:/Users/Cam/Desktop/Warmup/Warmup_scores\", \"r\") do |f|\n  f.each_line do |line|\n    if line.include? \"Score\" \n        puts line\n    end\n  end\nend\n</code></pre>\n\n<p>This works for single files but trying to make it work for an entire directory is a little tricky, any help?</p>\n"}]