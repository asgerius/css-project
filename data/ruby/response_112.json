[{"tags": ["ruby", "ruby-on-rails-4", "update-attributes"], "comments": [{"owner": {"reputation": 1843, "user_id": 4067720, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a52c645614505bcaeb65a6c5199158c1?s=128&d=identicon&r=PG", "display_name": "Glyoko", "link": "https://stackoverflow.com/users/4067720/glyoko"}, "edited": false, "score": 0, "creation_date": 1488409409, "post_id": 42543745, "comment_id": 72223370, "body": "Can you give the full error, exactly as it appears? Also what exactly is <code>p</code> in this context?"}, {"owner": {"reputation": 32451, "user_id": 2516474, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a2179a340c0e84edc285d432211145d?s=128&d=identicon&r=PG", "display_name": "SteveTurczyn", "link": "https://stackoverflow.com/users/2516474/steveturczyn"}, "edited": false, "score": 0, "creation_date": 1488410243, "post_id": 42543745, "comment_id": 72223692, "body": "I&#39;d guess you have a record which has already got the p[:url] value in url OR the p[:urlmd5] value in urlmd5 but not both.  So first_or_initialize is not finding the combination of both, so is initializing a record with both but the uniqueness constraint still applies to one of the fields."}, {"owner": {"reputation": 32451, "user_id": 2516474, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a2179a340c0e84edc285d432211145d?s=128&d=identicon&r=PG", "display_name": "SteveTurczyn", "link": "https://stackoverflow.com/users/2516474/steveturczyn"}, "edited": false, "score": 0, "creation_date": 1488410450, "post_id": 42543745, "comment_id": 72223777, "body": "Could it be that you want uniqueness only on BOTH fields combined?  You&#39;ll need to change your validation.  <code>validates :urlmd5, presence: true, uniqueness: {scope: :url}</code> and the same for the inverse."}, {"owner": {"reputation": 178, "user_id": 4658926, "user_type": "registered", "accept_rate": 20, "profile_image": "https://graph.facebook.com/771302485/picture?type=large", "display_name": "Francisco Campa&#241;a", "link": "https://stackoverflow.com/users/4658926/francisco-campa%c3%b1a"}, "reply_to_user": {"reputation": 32451, "user_id": 2516474, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a2179a340c0e84edc285d432211145d?s=128&d=identicon&r=PG", "display_name": "SteveTurczyn", "link": "https://stackoverflow.com/users/2516474/steveturczyn"}, "edited": false, "score": 0, "creation_date": 1488412300, "post_id": 42543745, "comment_id": 72224420, "body": "@SteveTurczyn See my answer"}], "answers": [{"tags": [], "owner": {"reputation": 178, "user_id": 4658926, "user_type": "registered", "accept_rate": 20, "profile_image": "https://graph.facebook.com/771302485/picture?type=large", "display_name": "Francisco Campa&#241;a", "link": "https://stackoverflow.com/users/4658926/francisco-campa%c3%b1a"}, "is_accepted": false, "score": 0, "last_activity_date": 1488412203, "creation_date": 1488412203, "answer_id": 42544341, "question_id": 42543745, "link": "https://stackoverflow.com/questions/42543745/how-to-create-or-update-a-unique-and-present-validation/42544341#42544341", "title": "How to create_or_update a unique and present validation", "body": "<p>The problem was that I was I haven't passed unique values to first_or_initialize, so when new instance is created it failed due to a lack of uniqueness, presence or both.</p>\n\n<p>You need to pass unique values to first_or_initialize:</p>\n\n<pre><code>ParserUrl.where(urlmd5: p[:urlmd5]).\n    first_or_initialize(url: p[:url].to_s, urlmd5: p[:urlmd5]).\n    update_attributes!(user_id: item.user_id, parser_id: item.parser_id)\n</code></pre>\n\n<p>Another way in Rails 4:</p>\n\n<p>1) Only hit the DB one time:</p>\n\n<pre><code>ParserUrl.find_or_initialize_by(url: p[:url].to_s, urlmd5: p[:urlmd5]).\n    update_attributes!(user_id: item.user_id, parser_id: item.parser_id)\n</code></pre>\n\n<p>2) This will hit the DB two times (not desirable):</p>\n\n<pre><code>ParserUrl.find_or_create_by!(url: p[:url].to_s, urlmd5: p[:urlmd5]).\n    update_attributes!(user_id: item.user_id, parser_id: item.parser_id)\n</code></pre>\n"}], "owner": {"reputation": 178, "user_id": 4658926, "user_type": "registered", "accept_rate": 20, "profile_image": "https://graph.facebook.com/771302485/picture?type=large", "display_name": "Francisco Campa&#241;a", "link": "https://stackoverflow.com/users/4658926/francisco-campa%c3%b1a"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 228, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1488466428, "creation_date": 1488409106, "last_edit_date": 1488466428, "question_id": 42543745, "link": "https://stackoverflow.com/questions/42543745/how-to-create-or-update-a-unique-and-present-validation", "title": "How to create_or_update a unique and present validation", "body": "<p>Why I can't update attributes since I'm not updating a unique field?</p>\n\n<p>urlmd5 and url both has uniqueness validation:</p>\n\n<pre><code>validates :url, presence: true, uniqueness: true\nvalidates :urlmd5, presence: true, uniqueness: true\n</code></pre>\n\n<p>This Works:</p>\n\n<pre><code>    ParserUrl.where(urlmd5: p[:urlmd5]).first_or_initialize.update_attributes!(\n        user_id: item.user_id, parser_id: item.parser_id\n    )\n</code></pre>\n\n<p>This doesn't works:</p>\n\n<pre><code>    ParserUrl.where(url: p[:url], urlmd5:p[:urlmd5]).first_or_initialize.update_attributes!(\n        user_id: item.user_id, parser_id: item.parser_id\n    )\n\nI got error 'unable to update existing record'...\n</code></pre>\n\n<p>Is first_or_initialize.update_attributes! the correct way to handle this?</p>\n"}, {"tags": ["ruby", "puppet"], "answers": [{"comments": [{"owner": {"reputation": 19, "user_id": 7644137, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/faca87d01b8da8e84c1a86f266513305?s=128&d=identicon&r=PG&f=1", "display_name": "KevinZH", "link": "https://stackoverflow.com/users/7644137/kevinzh"}, "edited": false, "score": 0, "creation_date": 1488427209, "post_id": 42544141, "comment_id": 72228630, "body": "Hi John, thank you for your suggestion. I will check your suggestion of ENC . the reason I did not put &#39;include migration&#39; inside the node block is: I would like all other servers to get the puppetserver2 defined in top scope, except the  &#39;server1.domain2.com&#39;, so by putting &#39;include migrate&#39; in top scope , I don&#39;t need to put it in every other server&#39;s node block  one by sone"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "reply_to_user": {"reputation": 19, "user_id": 7644137, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/faca87d01b8da8e84c1a86f266513305?s=128&d=identicon&r=PG&f=1", "display_name": "KevinZH", "link": "https://stackoverflow.com/users/7644137/kevinzh"}, "edited": false, "score": 0, "creation_date": 1488463136, "post_id": 42544141, "comment_id": 72249146, "body": "@KevinZH, I urge you to avoid valuing convenience over sound design.  It is rarely a good idea to declare classes at top scope if you are also using node blocks or an ENC.  In any event, I think your best option is to rely on Hiera to set the correct value of your variable -- wherever it is that you need that value -- instead of setting it in one place and overriding it some place else.  The other options will work, but this sort of thing is Hiera&#39;s bread &amp; butter."}, {"owner": {"reputation": 12661, "user_id": 5343387, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/15a14cec3014822297a08ed6dfae2563?s=128&d=identicon&r=PG&f=1", "display_name": "Matt Schuchard", "link": "https://stackoverflow.com/users/5343387/matt-schuchard"}, "edited": false, "score": 0, "creation_date": 1488472280, "post_id": 42544141, "comment_id": 72255781, "body": "Yeah I can&#39;t really tell what the root cause is here, but the suggestion for a well-designed node classifier and how to do it (plus use of data) would probably fix it."}, {"owner": {"reputation": 19, "user_id": 7644137, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/faca87d01b8da8e84c1a86f266513305?s=128&d=identicon&r=PG&f=1", "display_name": "KevinZH", "link": "https://stackoverflow.com/users/7644137/kevinzh"}, "edited": false, "score": 0, "creation_date": 1488506731, "post_id": 42544141, "comment_id": 72272686, "body": "Thank you Jon and Matt for your suggestions. I will avoid declase classes at top scope and start to  check the Hiera methods"}], "tags": [], "owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "is_accepted": false, "score": 1, "last_activity_date": 1488411041, "creation_date": 1488411041, "answer_id": 42544141, "question_id": 42543720, "link": "https://stackoverflow.com/questions/42543720/puppet-variables-overriding-fails/42544141#42544141", "title": "puppet variables overriding fails", "body": "<p>When you <code>include</code> a class at top scope as you do, no node block is in scope during its evaluation.  That's a good reason to avoid such shenanigans.</p>\n\n<p>Put the <code>include</code> statement inside the node block, use an ENC to designate the class for inclusion, or maybe use <code>hiera_include()</code> inside your node block to include it indirectly.  Alternatively, use hiera at top scope to set the correct value for the <code>$puppetserver</code> variable, and thereby take variable shadowing out of the picture.</p>\n"}], "owner": {"reputation": 19, "user_id": 7644137, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/faca87d01b8da8e84c1a86f266513305?s=128&d=identicon&r=PG&f=1", "display_name": "KevinZH", "link": "https://stackoverflow.com/users/7644137/kevinzh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 182, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1488411041, "creation_date": 1488408991, "question_id": 42543720, "link": "https://stackoverflow.com/questions/42543720/puppet-variables-overriding-fails", "title": "puppet variables overriding fails", "body": "<p>I am a newbie on puppet and met some issues as subject, googled for some time but failed with an matched answer. Mys issues is as:</p>\n\n<p>I defined global variables $puppetserver in /etc/puppet/manifests/site.pp as below:</p>\n\n<pre><code>case $domain {\n/domain2/:{\n$puppetserver = \"puppetserver2\"\ninclude migrate\n}\ndefault:{\n$puppetserver = \"puppetserver3\"\n}\n}\n</code></pre>\n\n<p>in node definition of the servers in domain2 in manifests/labs/domain2/nodes.pp</p>\n\n<pre><code>   node 'server1.domain2.com' {\n    $puppetserver = \"puppetserver3\"\n    }\n</code></pre>\n\n<p>the migrate module is used for puppet migration, got from internet as below:</p>\n\n<p>in /etc/puppet/modules/migrate/manifests/config.pp</p>\n\n<pre><code>   class migrate::config  {\n  if $puppetserver == undef {\n    fail('You must define the targeted Puppet master to perform the migration')\n  } \n\n  augeas { 'puppet.conf.migrate':\n    context =&gt; '/files/etc/puppet/puppet.conf/main',\n    changes =&gt; [\n       \"set server $puppetserver\",\n    ]\n    }\n\n    } \n</code></pre>\n\n<p>Since the node 'server1.domain2.com' can match the domain2 setting in site.pp, so it applies the migrate module,what I expected is: it should get the 'puppetserver3' for $puppetserver defined in node block and then be updated in '/etc/puppet/puppet.conf' by the Augeas, but actual result is : it use 'puppetserver2' which was defined in site.pp. I cannot figure out why overriding is not working. Can you kindly help to check what's wrong?</p>\n\n<p>And as a test:</p>\n\n<p>When I tried to move the 'include migrate' module from site.pp to node 'server1.domain2.com' {} block of nodes.pp, it can work as expected.\nit seems some order when puppet applying manifests, but what I got is that local scope variables will always overrides the variables, is that correct?\nThanks a lot for your kindly help.</p>\n"}, {"tags": ["ruby", "activerecord"], "answers": [{"tags": [], "owner": {"reputation": 32451, "user_id": 2516474, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a2179a340c0e84edc285d432211145d?s=128&d=identicon&r=PG", "display_name": "SteveTurczyn", "link": "https://stackoverflow.com/users/2516474/steveturczyn"}, "is_accepted": false, "score": 0, "last_activity_date": 1488409499, "creation_date": 1488409499, "answer_id": 42543828, "question_id": 42543534, "link": "https://stackoverflow.com/questions/42543534/order-by-an-activerecord-model-property-through-a-has-many-relationship/42543828#42543828", "title": "Order by an ActiveRecord model property through a has_many relationship", "body": "<p>You can't do what you're describing since <code>current_status</code> as you've defined it is a model method, not a table attribute, so it can't be used in an ActiveRecord relation. But you can alias the has_many relation with a limit to only the first record.</p>\n\n<p>You could do it this way...</p>\n\n<pre><code>class Connection &lt; ApplicationRecord\n  has_many :connection_statuses, -&gt; { order(created_at: :desc) }\n  has_many :current_connections, -&gt; { order(created_at: :desc}.limit(1) }, class_name: 'ConnectionStatus'\n</code></pre>\n\n<p>that lets you do...</p>\n\n<pre><code>disconnected_items = Connection.join(:current_connections).where(\"connection_statuses.description = 'disconnected'\")\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 7644048, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/abe5c13ec84b5c39ef7d76d821f7b345?s=128&d=identicon&r=PG&f=1", "display_name": "Nate Taubitz", "link": "https://stackoverflow.com/users/7644048/nate-taubitz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 24, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1488409499, "creation_date": 1488408227, "question_id": 42543534, "link": "https://stackoverflow.com/questions/42543534/order-by-an-activerecord-model-property-through-a-has-many-relationship", "title": "Order by an ActiveRecord model property through a has_many relationship", "body": "<p>I have connections to things. The connection goes up and down. I want to keep a history of the status and know the connection's current status. I have a Connection model. The Connection has many ConnectionStatus. First I want to create a property on Connection that is the current status which also limits the columns from ConnectionStatus. I've done this so far:</p>\n\n<pre><code>class Connection &lt; ApplicationRecord\n  has_many :connection_statuses, -&gt; { order(created_at: :desc) }\n\n  def current_status\n    status = connection_statuses.first\n    status.nil? ? 'unknown' : status.description\n  end\nend\n</code></pre>\n\n<p>I do not know how to accomplish ordering by current_status. Here are a few desired usages to help explain</p>\n\n<pre><code>Connection.first.current_status == :disconnected\nConnection.where(:current_status =&gt; :disconnected)\nConnection.order('current_status desc') # or equivalent\nConnection.offset(10).limit(10).order('current_status desc') #pagination\n</code></pre>\n\n<p>This is a general concept that I am not grasping. Thanks for any help here!</p>\n"}, {"tags": ["ruby", "macos", "debugging", "installation", "jekyll"], "answers": [{"comments": [{"owner": {"reputation": 585, "user_id": 4305114, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/c86ea301f585cef75148bdb89db07779?s=128&d=identicon&r=PG&f=1", "display_name": "Constantin", "link": "https://stackoverflow.com/users/4305114/constantin"}, "edited": false, "score": 0, "creation_date": 1488459888, "post_id": 42549991, "comment_id": 72246800, "body": "I understand that these are alternative hosting solutions. I work with GitHub a lot and would like to host my Jekyll page there. I was hoping there is a relatively straightforward way to avoid the most common pitfalls when setting up Ruby and Jekyll locally. I&#39;m not afraid of the command line. I simply don&#39;t know any Ruby."}, {"owner": {"reputation": 9244, "user_id": 2397550, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/iAb8N.jpg?s=128&g=1", "display_name": "JoostS", "link": "https://stackoverflow.com/users/2397550/joosts"}, "reply_to_user": {"reputation": 585, "user_id": 4305114, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/c86ea301f585cef75148bdb89db07779?s=128&d=identicon&r=PG&f=1", "display_name": "Constantin", "link": "https://stackoverflow.com/users/4305114/constantin"}, "edited": false, "score": 0, "creation_date": 1488462592, "post_id": 42549991, "comment_id": 72248745, "body": "Please note that these are NOT alternative hosting solutions. You can still host on Github Pages and use git. These are ways to run Jekyll in the cloud, instead of trying to install Jekyll locally on your very expensive and bad performing Linux clone (just messing with you). Where you host is totally up to you. I am only trying to help you run Jekyll &#39;the easy way&#39;. The easy way is preinstalled (CloudCannon) or on Linux (Cloud9). Good luck!"}, {"owner": {"reputation": 585, "user_id": 4305114, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/c86ea301f585cef75148bdb89db07779?s=128&d=identicon&r=PG&f=1", "display_name": "Constantin", "link": "https://stackoverflow.com/users/4305114/constantin"}, "edited": false, "score": 0, "creation_date": 1488679015, "post_id": 42549991, "comment_id": 72337473, "body": "Understood. I followed the instructions on Jekyll Codex, but when CloudCannon pushes the site to GitHub, GitHub tries to compile it and fails. Any ideas how to fix this?"}, {"owner": {"reputation": 9244, "user_id": 2397550, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/iAb8N.jpg?s=128&g=1", "display_name": "JoostS", "link": "https://stackoverflow.com/users/2397550/joosts"}, "reply_to_user": {"reputation": 585, "user_id": 4305114, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/c86ea301f585cef75148bdb89db07779?s=128&d=identicon&r=PG&f=1", "display_name": "Constantin", "link": "https://stackoverflow.com/users/4305114/constantin"}, "edited": false, "score": 0, "creation_date": 1488743313, "post_id": 42549991, "comment_id": 72355262, "body": "Please ask a new question and put a link to your repo and the error message in it. Then I/we would love to look at it."}], "tags": [], "owner": {"reputation": 9244, "user_id": 2397550, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/iAb8N.jpg?s=128&g=1", "display_name": "JoostS", "link": "https://stackoverflow.com/users/2397550/joosts"}, "is_accepted": false, "score": 1, "last_activity_date": 1488442406, "creation_date": 1488442406, "answer_id": 42549991, "question_id": 42543419, "link": "https://stackoverflow.com/questions/42543419/how-to-set-up-ruby-installation-for-users-of-jekyll-who-dont-know-ruby/42549991#42549991", "title": "How to set up Ruby installation for users of Jekyll who don&#39;t know Ruby", "body": "<p>I have set up a website for people who want to use Jekyll without touching the command-line, called <a href=\"http://jekyllcodex.org\" rel=\"nofollow noreferrer\">Jekyll Codex</a>. You might want to check that out. </p>\n\n<p>Using <a href=\"http://cloudcannon.com/\" rel=\"nofollow noreferrer\">CloudCannon</a> will enable you to work on your Jekyll project from any machine in the world without installing ANYTHING. Note that CloudCannon has a free tier, but they are not very clear about that. </p>\n\n<p>Another option is to use <a href=\"https://c9.io/\" rel=\"nofollow noreferrer\">Cloud9</a>, which is also free. They have online/virtual Linux environments. You can also work from anywhere, but you need to install Jekyll yourself. This is a piece of cake on Linux. Note that this solution will give you much better build times than CloudCannon, but is more complex (on the bright-side: it will make you feel like a pro).</p>\n"}], "owner": {"reputation": 585, "user_id": 4305114, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/c86ea301f585cef75148bdb89db07779?s=128&d=identicon&r=PG&f=1", "display_name": "Constantin", "link": "https://stackoverflow.com/users/4305114/constantin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 81, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1488442406, "creation_date": 1488407679, "question_id": 42543419, "link": "https://stackoverflow.com/questions/42543419/how-to-set-up-ruby-installation-for-users-of-jekyll-who-dont-know-ruby", "title": "How to set up Ruby installation for users of Jekyll who don&#39;t know Ruby", "body": "<p>I'm using Jekyll for my <code>gh-pages</code>-based website, but I am not a Ruby developer. I have been trying for a while now to set up my Ruby installation in such a way that standard Jekyll operations \"just work\" without errors or warnings but I cannot seem to get it right.</p>\n\n<p>I did a fresh install of Ruby and Jekyll and yet I keep running into countless problems. As soon as one of them is fixed another appears, and so I think there must be something fundamentally wrong in the way I set things up. I used RVM to install Ruby to keep it separate from the system installation.</p>\n\n<p><code>which ruby</code> returns <code>/Users/user/.rvm/rubies/ruby-2.4.0/bin/ruby</code>\n<code>which Jekyll</code> returns <code>/Users/user/.rvm/gems/ruby-2.4.0/bin/jekyll\n</code></p>\n\n<p>Currently, I am fighting with <code>Gem::Ext::BuildError: ERROR: Failed to build gem native extension</code> following <code>bundle install</code>. This appears after `Installing yajl-ruby 1.2.1 with native extensions.</p>\n\n<p>However, rather than just a solution for this specific issue, I would like to know more generally what are the things one should pay attention to when using Ruby and Jekyll on a Mac, because just following the instructions on <code>jekyllrb.com</code> gives me the impression that this is highly highly problematic and error-prone (which I am sure is really just my mistake). Only about half of the Jekyll templates I have tried build at all (albeit always with some sort of warning of the type <code>Ignoring posix-spawn-0.3.13 because its extensions are not built.  Try: gem pristine posix-spawn --version 0.3.13</code>). The other half just fail altogether.</p>\n\n<p>I apologise if my question is a little helpless, but I really know nothing about the Ruby ecosystem; I just want to get Jekyll to work. Many thanks for any suggestions!</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "answers": [{"tags": [], "owner": {"reputation": 1761, "user_id": 3741320, "user_type": "registered", "profile_image": "https://graph.facebook.com/10222536/picture?type=large", "display_name": "James Milani", "link": "https://stackoverflow.com/users/3741320/james-milani"}, "is_accepted": true, "score": 2, "last_activity_date": 1488406399, "last_edit_date": 1488406399, "creation_date": 1488405977, "answer_id": 42543018, "question_id": 42542926, "link": "https://stackoverflow.com/questions/42542926/assign-variable-to-backup-if-first-condition-is-nil-ruby/42543018#42543018", "title": "Assign variable to backup if first condition is nil - ruby", "body": "<p><strong>EDIT:</strong></p>\n\n<p>I see now from the error that the problem isn't with your <code>||</code> operator, it's with your <code>rsvp.purchases.map(&amp;:coupon)</code> method chaining. It's not finding a <code>coupon</code> for one of the purchases.</p>\n\n<p>You can solve this by ensuring that purchases always have coupons with validations, or you can use the <code>.try</code> method from Rails.</p>\n\n<p><a href=\"http://apidock.com/rails/v4.2.7/Object/try\" rel=\"nofollow noreferrer\">Try method in Rails</a></p>\n\n<p><strong>Original</strong></p>\n\n<p>In Ruby, <code>nil</code> and <code>false</code> are the only things that are not truthy. So,\ncoupon will be equal to <code>rsvp.purchases.map(&amp;:coupon)</code> unless <code>rsvp.purchases.map(&amp;:coupon)</code> is equal to <code>nil</code> or <code>false</code>.</p>\n\n<p>Can you be more specific and give examples about the error(s) that you are receiving?</p>\n\n<p>Examples Below:</p>\n\n<pre><code>irb(main):019:0&gt; coupon = nil || 1\n=&gt; 1\nirb(main):020:0&gt; coupon = \"\" || 1\n=&gt; \"\"\nirb(main):021:0&gt; coupon = false || 1\n=&gt; 1\nirb(main):022:0&gt; coupon = 4 || 1\n=&gt; 4\nirb(main):023:0&gt; coupon = OpenStruct.new || 1\n=&gt; #&lt;OpenStruct&gt;\nirb(main):024:0&gt; coupon = false || OpenStruct.new\n=&gt; #&lt;OpenStruct&gt;\nirb(main):025:0&gt; coupon = nil || OpenStruct.new  \n=&gt; #&lt;OpenStruct&gt;\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 32451, "user_id": 2516474, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a2179a340c0e84edc285d432211145d?s=128&d=identicon&r=PG", "display_name": "SteveTurczyn", "link": "https://stackoverflow.com/users/2516474/steveturczyn"}, "is_accepted": false, "score": 2, "last_activity_date": 1488406259, "creation_date": 1488406259, "answer_id": 42543088, "question_id": 42542926, "link": "https://stackoverflow.com/questions/42542926/assign-variable-to-backup-if-first-condition-is-nil-ruby/42543088#42543088", "title": "Assign variable to backup if first condition is nil - ruby", "body": "<p>You can take the first element of the coupons array, or nil if there are no elements.</p>\n\n<p>(this assumes there's a many-to-one relationship between coupons and purchases)</p>\n\n<pre><code>coupon = rsvp.purchases.coupons.first || NullCoupon.new\n</code></pre>\n"}], "owner": {"reputation": 6503, "user_id": 5650878, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/xh7BI.png?s=128&g=1", "display_name": "Bitwise", "link": "https://stackoverflow.com/users/5650878/bitwise"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 165, "favorite_count": 0, "accepted_answer_id": 42543018, "answer_count": 2, "score": 1, "last_activity_date": 1488406755, "creation_date": 1488405615, "last_edit_date": 1488406076, "question_id": 42542926, "link": "https://stackoverflow.com/questions/42542926/assign-variable-to-backup-if-first-condition-is-nil-ruby", "title": "Assign variable to backup if first condition is nil - ruby", "body": "<p>I'm trying to set a variable with a value. But in some instances this value will not exist. In the scenario I want to set it to the Null Class I built. Here is what I'm working with:</p>\n\n<p><code>coupon = rsvp.purchases.map(&amp;:coupon) || NullCoupon.new</code></p>\n\n<p>With this line I'm trying to say - <code>if rsvp.purchases.coupons is nil assign coupon to NullCoupon.new</code>. I'm clearly doing something wrong but how can I achieve this?</p>\n\n<h2>Error</h2>\n\n<p><code>ActionView::Template::Error (undefined method \"coupon\" for #&lt;Purchase::ActiveRecord_Associations_CollectionProxy:0x007fadb410a478&gt;</code></p>\n"}, {"tags": ["ruby", "windows"], "answers": [{"tags": [], "owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "is_accepted": true, "score": 0, "last_activity_date": 1488442819, "creation_date": 1488442819, "answer_id": 42550119, "question_id": 42542896, "link": "https://stackoverflow.com/questions/42542896/replace-cr-lf-characters-with-cr-windows/42550119#42550119", "title": "replace CR LF characters with CR (windows)", "body": "<p>Use <a href=\"http://ruby-doc.org/core/IO.html#method-i-print\" rel=\"nofollow noreferrer\"><code>IO#print</code></a> instead of <a href=\"http://ruby-doc.org/core/IO.html#method-i-puts\" rel=\"nofollow noreferrer\"><code>IO#puts</code></a>.</p>\n"}], "owner": {"reputation": 4157, "user_id": 2115971, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/zkMcT.jpg?s=128&g=1", "display_name": "richbai90", "link": "https://stackoverflow.com/users/2115971/richbai90"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 38, "favorite_count": 0, "accepted_answer_id": 42550119, "answer_count": 1, "score": 0, "last_activity_date": 1488442819, "creation_date": 1488405473, "question_id": 42542896, "link": "https://stackoverflow.com/questions/42542896/replace-cr-lf-characters-with-cr-windows", "title": "replace CR LF characters with CR (windows)", "body": "<p>I have a ruby script that parses a file and is supposed to replace all CR-LF characters with CR.</p>\n\n<pre><code>def fixNewline(filename)\n  p \"scrubbing final xml\"\n  newFilename = filename.split('.')[0]\n  File.open(\"#{newFilename}.scrubbed.xml\", 'w') do |fo|\n    File.foreach(filename) do |li|\n      fo.puts li.gsub(/\\r\\n/, \"\\r\")\n    end\n  end\nend\n</code></pre>\n\n<p>Unfortunately when I look at the file in notepad++ I still see \\r\\n sequences. I think that this is because puts is adding a \\r\\n to the end of the line. Is there a way to prevent this behavior?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "forms", "heroku"], "answers": [{"tags": [], "owner": {"reputation": 5178, "user_id": 2577840, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/1520578334/picture?type=large", "display_name": "Micha\u0142 M\u0142o\u017aniak", "link": "https://stackoverflow.com/users/2577840/micha%c5%82-m%c5%82o%c5%baniak"}, "is_accepted": true, "score": 1, "last_activity_date": 1488582391, "creation_date": 1488582391, "answer_id": 42589938, "question_id": 42542344, "link": "https://stackoverflow.com/questions/42542344/rails-5-embed-a-register-interest-form-in-root-page/42589938#42589938", "title": "Rails 5 - embed a register interest form in root page", "body": "<p>The error <code>PG::UndefinedTable: ERROR:  relation \"leads\" does not exist</code> clearly says that your <code>leads</code> table does not exists. That's because you most likely forgot to run migrations on Heroku.</p>\n\n<p>To fix it run this command <code>heroku run rake db:migrate --app your_application_name</code>. Or drop <code>--app</code> part if you have only one application.</p>\n\n<p>Please be aware that Heroku does not automatically run your migrations when you deploy new code. You need to do it manually every time you add new migrations. If you want to automate this, there are many options. I think the easiest will be to add this buildpack <code>https://github.com/gunpowderlabs/buildpack-ruby-rake-deploy-tasks</code>.</p>\n\n<p>Here are the steps if you want to go with this options:</p>\n\n<pre><code>heroku buildpacks:add https://github.com/gunpowderlabs/buildpack-ruby-rake-deploy-tasks --app your_application_name\nheroku config:set DEPLOY_TASKS='db:migrate' --app your_application_name\n</code></pre>\n"}], "owner": {"reputation": 3634, "user_id": 2860931, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/968ddbc21b4695b3fba4665b69d231b5?s=128&d=identicon&r=PG&f=1", "display_name": "Mel", "link": "https://stackoverflow.com/users/2860931/mel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 54, "favorite_count": 0, "accepted_answer_id": 42589938, "answer_count": 1, "score": 0, "last_activity_date": 1488582391, "creation_date": 1488403508, "last_edit_date": 1495539968, "question_id": 42542344, "link": "https://stackoverflow.com/questions/42542344/rails-5-embed-a-register-interest-form-in-root-page", "title": "Rails 5 - embed a register interest form in root page", "body": "<p>I've made a scaffold in my Rails app called Leads. The table has 1 attribute, being :email. </p>\n\n<p>My objective is to render the form input field in the homepage.</p>\n\n<p>I have a HomeController, to which I've added this \"new\" method.</p>\n\n<pre><code>class HomeController &lt; ApplicationController\n\n  def new\n    @lead = Lead.new\n  end\n\nend\n</code></pre>\n\n<p>In the home/index view, I have:</p>\n\n<pre><code>        &lt;%= render 'leads/form', lead: @lead %&gt;\n</code></pre>\n\n<p>In the form partial I have:</p>\n\n<pre><code>    &lt;%= simple_form_for Lead.new do |f| %&gt;\n\n      &lt;%= f.input :email, :label =&gt; false, :placeholder =&gt; \"your email address\", input_html: { class: 'cform'  }   %&gt;\n\n\n    &lt;span style=\"float:right\"&gt;&lt;%= f.button :submit, 'Go', class: 'cformbutton' %&gt;&lt;/span&gt;\n\n&lt;% end %&gt;\n</code></pre>\n\n<p>I'm trying to follow the advice in <a href=\"https://stackoverflow.com/questions/29177803/embed-a-rails-form-partial-into-another-page\">this post</a> to get the form input field to show in the home index.</p>\n\n<p>I cant find a way to make it work.</p>\n\n<p>It works fine in the development environment but then when I push to heroku, I get an error that says:</p>\n\n<pre><code>FATAL -- : [a6e63810-1660-4e83-86d9-bfd6ae54b344] ActionView::Template::Error (PG::UndefinedTable: ERROR:  relation \"leads\" does not exist\n2017-03-01T21:19:11.541780+00:00 app[web.1]: F, [2017-03-01T21:19:11.541735 #4] FATAL -- : [a6e63810-1660-4e83-86d9-bfd6ae54b344]   \n2017-03-01T21:19:11.541824+00:00 app[web.1]: LINE 8:                WHERE a.attrelid = '\"leads\"'::regclass\n</code></pre>\n\n<p>My lead.rb has no associations on it. I don't understand why there need to be any associations. </p>\n\n<p>Can anyone see what I need to do in order to get this form to work in the production environment?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "performance", "activerecord"], "comments": [{"owner": {"reputation": 576, "user_id": 1415844, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MPbRo.png?s=128&g=1", "display_name": "Julia Will", "link": "https://stackoverflow.com/users/1415844/julia-will"}, "edited": false, "score": 2, "creation_date": 1488401119, "post_id": 42541386, "comment_id": 72219111, "body": "First, I would probably use Sidekiq or something similar, so you can run this task in the background in case you are doing this on a production server. Next you should find a way to reduce the number of queries to the database. You could collect the ids in chunks and then every 30 lines or so make one request with the collected ids."}, {"owner": {"reputation": 576, "user_id": 1415844, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MPbRo.png?s=128&g=1", "display_name": "Julia Will", "link": "https://stackoverflow.com/users/1415844/julia-will"}, "edited": false, "score": 1, "creation_date": 1488401422, "post_id": 42541386, "comment_id": 72219282, "body": "Oh, and probably try to use plain sql to delete them, as the destroy_all is loading the objects first. If there are no hooks on before or after destroy, I would definitely prefer that over the destroy."}, {"owner": {"reputation": 1414, "user_id": 3830618, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/100000364348363/picture?type=large", "display_name": "Jakub Kohout", "link": "https://stackoverflow.com/users/3830618/jakub-kohout"}, "reply_to_user": {"reputation": 576, "user_id": 1415844, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MPbRo.png?s=128&g=1", "display_name": "Julia Will", "link": "https://stackoverflow.com/users/1415844/julia-will"}, "edited": false, "score": 0, "creation_date": 1488402162, "post_id": 42541386, "comment_id": 72219765, "body": "but doesn&#39;t delete_all runs without any hooks and yet it&#39;s still so slow? I have been looking in resque and sidekiq and I will use it, but still that I feel that it takes really long for such a &quot;trivial&quot; task."}, {"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 0, "creation_date": 1488403202, "post_id": 42541386, "comment_id": 72220320, "body": "What happens if you get rid of the <code>open</code> and pass the filename directly to SmarterCSV?"}, {"owner": {"reputation": 1414, "user_id": 3830618, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/100000364348363/picture?type=large", "display_name": "Jakub Kohout", "link": "https://stackoverflow.com/users/3830618/jakub-kohout"}, "edited": false, "score": 0, "creation_date": 1488409148, "post_id": 42541386, "comment_id": 72223268, "body": "Reading the csv file is not the major performance problem, removing the data from DB is."}, {"owner": {"reputation": 9434, "user_id": 1248059, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8df5b863fd3beb500e7490ddfc0b47f?s=128&d=identicon&r=PG", "display_name": "Yaw Boakye", "link": "https://stackoverflow.com/users/1248059/yaw-boakye"}, "edited": false, "score": 0, "creation_date": 1488412118, "post_id": 42541386, "comment_id": 72224368, "body": "I agree that a straight <code>DELETE FROM table WHERE id IN ()</code> will do the trick. At least with that instruction you hand over the task to the database server, which is capable of handling the load. 2 questions: (1) why isn&#39;t the  standard cvs module a good fit for handling the file? (2) why do you keep the file open throughout the operation?"}], "answers": [{"comments": [{"owner": {"reputation": 1414, "user_id": 3830618, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/100000364348363/picture?type=large", "display_name": "Jakub Kohout", "link": "https://stackoverflow.com/users/3830618/jakub-kohout"}, "edited": false, "score": 0, "creation_date": 1488467801, "post_id": 42556297, "comment_id": 72252600, "body": "this seams like very creative way how to go about my problem and I&#39;m going to try it. Thank you."}], "tags": [], "owner": {"reputation": 10487, "user_id": 5708620, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4b0f8c70394b748ed7ec1a3a11a749b1?s=128&d=identicon&r=PG&f=1", "display_name": "Danny_ds", "link": "https://stackoverflow.com/users/5708620/danny-ds"}, "is_accepted": false, "score": 0, "last_activity_date": 1488459856, "creation_date": 1488459856, "answer_id": 42556297, "question_id": 42541386, "link": "https://stackoverflow.com/questions/42541386/slow-performance-when-deleting-huge-amount-of-rows/42556297#42556297", "title": "Slow performance when deleting huge amount of rows", "body": "<p>I don't know Ruby or the database you are using, but it looks like there are a lot of separate delete calls to the database.</p>\n\n<p>Here's what I would try to speed things up:</p>\n\n<p>First, make sure you have an index on id in both tables.</p>\n\n<p>In each table, create a field (boolean or small int) to mark a record for deletion. In your loop, instead of deleting, just set the deletion field to true (this should be fast if you have an index on id). And only at the end call delete once on each table (delete from table where the deletemarker is true).</p>\n"}], "owner": {"reputation": 1414, "user_id": 3830618, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/100000364348363/picture?type=large", "display_name": "Jakub Kohout", "link": "https://stackoverflow.com/users/3830618/jakub-kohout"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 359, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1488459856, "creation_date": 1488399948, "last_edit_date": 1592644375, "question_id": 42541386, "link": "https://stackoverflow.com/questions/42541386/slow-performance-when-deleting-huge-amount-of-rows", "title": "Slow performance when deleting huge amount of rows", "body": "<h2>The problem</h2>\n<p>I'm trying to parse huge CSV file (27mb) and delete big amount of rows, but running in performance issues.</p>\n<br>\n<h2>Specifications</h2>\n<ul>\n<li>rails version 4.2.0, Posgtres as db client</li>\n<li><strong>videos</strong> table has <strong>300000</strong> rows</li>\n<li><strong>categories_videos</strong> pivot table has <strong>885000</strong> rows</li>\n<li>To load the external csv file takes <strong>29097ms</strong></li>\n<li>External CSV file has <strong>3117000</strong> lines (1 deleted video id per line)</li>\n</ul>\n<br>\n<h2>The task</h2>\n<p>I have large CSV file <strong>27MB</strong> with the IDs of videos which were deleted and I have to go through this file and check if there are any videos in my database that would have matching ID and if they have delete them from my db.</p>\n<p><strong>1) roughly 126724ms (per chunk)</strong></p>\n<pre><code>file_location = 'http://my_external_source/file.csv';\nopen(file_location, 'r:utf-8') do |f| \n\n    data = SmarterCSV.process(f, { :headers_in_file =&gt; false, :user_provided_headers =&gt; [&quot;id&quot;], :chunk_size =&gt; 1000 }) do |chunk|\n        chunk = chunk.map{ |row| row[:id] }\n        Video.delete_all(:id =&gt; chunk)\n        VideoCategoryRelation.delete_all(:video_video_id =&gt; chunk)\n    end\n\nend\n</code></pre>\n<p><strong>2) roughly 90000ms (per chunk)</strong></p>\n<pre><code>file_location = 'http://my_external_source/file.csv';\nopen(file_location, 'r:utf-8') do |f| \n\n    data = SmarterCSV.process(f, { :headers_in_file =&gt; false, :user_provided_headers =&gt; [&quot;id&quot;], :chunk_size =&gt; 1000 }) do |chunk|\n        chunk = chunk.map{ |row| row[:id] }\n        Video.where(:video_id =&gt; chunk).destroy_all\n    end\n\nend\n</code></pre>\n<p>Is there any efficient way how to go through this that would note take hours?</p>\n"}, {"tags": ["ruby", "selenium", "cucumber"], "comments": [{"owner": {"reputation": 5134, "user_id": 1672197, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i8HkV.png?s=128&g=1", "display_name": "orde", "link": "https://stackoverflow.com/users/1672197/orde"}, "edited": false, "score": 0, "creation_date": 1488403373, "post_id": 42541377, "comment_id": 72220411, "body": "You&#39;re using <code>rspec</code>?  Are you requiring it correctly?"}, {"owner": {"reputation": 1, "user_id": 7643573, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56cff89a3d096dee0ec43e8807f3fdd1?s=128&d=identicon&r=PG&f=1", "display_name": "Kneeyee", "link": "https://stackoverflow.com/users/7643573/kneeyee"}, "reply_to_user": {"reputation": 5134, "user_id": 1672197, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i8HkV.png?s=128&g=1", "display_name": "orde", "link": "https://stackoverflow.com/users/1672197/orde"}, "edited": false, "score": 0, "creation_date": 1488443381, "post_id": 42541377, "comment_id": 72235723, "body": "I have the line <b>require &#39;rspec/expectations&#39;</b> in my env.rb file. Is that sufficient or should I be doing something else?"}, {"owner": {"reputation": 5134, "user_id": 1672197, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i8HkV.png?s=128&g=1", "display_name": "orde", "link": "https://stackoverflow.com/users/1672197/orde"}, "edited": false, "score": 0, "creation_date": 1488490126, "post_id": 42541377, "comment_id": 72266578, "body": "Hmmm...perhaps you should post your env.rb file.  Even better, try to provide the minimal but complete amount of code to reproduce the issue."}], "answers": [{"tags": [], "owner": {"reputation": 176, "user_id": 4902498, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VoZOB.jpg?s=128&g=1", "display_name": "Kaushal Rupani", "link": "https://stackoverflow.com/users/4902498/kaushal-rupani"}, "is_accepted": false, "score": 0, "last_activity_date": 1492670082, "creation_date": 1492670082, "answer_id": 43511925, "question_id": 42541377, "link": "https://stackoverflow.com/questions/42541377/unable-to-verify-expectations-in-a-ruby-class/43511925#43511925", "title": "Unable to verify expectations in a ruby class", "body": "<p>In order to use rspec expectations.</p>\n\n<p>Please do the following in your env.rb file  </p>\n\n<pre><code>require 'rspec'\ninclude RSpec::Matchers\n</code></pre>\n\n<p>This will solve your current problem  </p>\n\n<p>Comment for more information.  </p>\n\n<p>Hope it helps!!</p>\n"}], "owner": {"reputation": 1, "user_id": 7643573, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56cff89a3d096dee0ec43e8807f3fdd1?s=128&d=identicon&r=PG&f=1", "display_name": "Kneeyee", "link": "https://stackoverflow.com/users/7643573/kneeyee"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 41, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1492670082, "creation_date": 1488399917, "last_edit_date": 1488403407, "question_id": 42541377, "link": "https://stackoverflow.com/questions/42541377/unable-to-verify-expectations-in-a-ruby-class", "title": "Unable to verify expectations in a ruby class", "body": "<p>I have a Class definition as below:</p>\n\n<pre><code>def initialize(driver)\n    @driver = driver\nend\n\ndef verify_page(username)\n    wait = Selenium::WebDriver::Wait.new(:timeout =&gt; 10)\n    btnSettings = wait.until { @driver.find_element(:xpath =&gt; \"//a[@href='/UserManagement/MyAccount']\") }\n    expect(btnSettings.text).to eq('Portal Administrator' + ' -- ' + username)\n  end\nend\n</code></pre>\n\n<p>When I run the code that calls the 'verify' method of this class, I get the error:</p>\n\n<pre><code>undefined method `expect' for #&lt;PortalHomePage:0x00000003b1d188&gt;\n</code></pre>\n\n<p>How do i get past this problem?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-4"], "comments": [{"owner": {"reputation": 1598, "user_id": 2620080, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/seJJg.jpg?s=128&g=1", "display_name": "ScieCode", "link": "https://stackoverflow.com/users/2620080/sciecode"}, "edited": false, "score": 0, "creation_date": 1488402356, "post_id": 42541145, "comment_id": 72219849, "body": "try redirecting with <code>edit_profile_path(current_user.profile.id)</code> and see what happens."}, {"owner": {"reputation": 1225, "user_id": 5724342, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/d0fc4bbc261a7a2a233a196a0b655fd2?s=128&d=identicon&r=PG&f=1", "display_name": "Gurmukh Singh", "link": "https://stackoverflow.com/users/5724342/gurmukh-singh"}, "reply_to_user": {"reputation": 1598, "user_id": 2620080, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/seJJg.jpg?s=128&g=1", "display_name": "ScieCode", "link": "https://stackoverflow.com/users/2620080/sciecode"}, "edited": false, "score": 0, "creation_date": 1488405602, "post_id": 42541145, "comment_id": 72221656, "body": "Tried the above, getting this error <code>No route matches {:action=&gt;&quot;edit&quot;, :controller=&gt;&quot;profiles&quot;, :id=&gt;nil} missing required keys: [:id]</code>"}], "answers": [{"tags": [], "owner": {"reputation": 32451, "user_id": 2516474, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a2179a340c0e84edc285d432211145d?s=128&d=identicon&r=PG", "display_name": "SteveTurczyn", "link": "https://stackoverflow.com/users/2516474/steveturczyn"}, "is_accepted": true, "score": 1, "last_activity_date": 1488406949, "creation_date": 1488406949, "answer_id": 42543258, "question_id": 42541145, "link": "https://stackoverflow.com/questions/42541145/validate-presence-on-after-create/42543258#42543258", "title": "Validate presence on after_create", "body": "<p><code>build_profile</code> in <code>after_create</code> builds a profile but it doesn't persist it.  It's not created in the database.</p>\n\n<p>Better might be...</p>\n\n<pre><code>  def after_sign_up_path_for(resource)\n    new_profile_path\n  end\n</code></pre>\n\n<p>In your controller</p>\n\n<pre><code>def new\n  @profile = current_user.build_profile\n  ...\nend\n\ndef create\n  @profile = current_user.build_profile\n  if @profile.update_attributes(profile_params)\n    ...\n  end\n  ...\nend\n</code></pre>\n"}], "owner": {"reputation": 1225, "user_id": 5724342, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/d0fc4bbc261a7a2a233a196a0b655fd2?s=128&d=identicon&r=PG&f=1", "display_name": "Gurmukh Singh", "link": "https://stackoverflow.com/users/5724342/gurmukh-singh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 140, "favorite_count": 0, "accepted_answer_id": 42543258, "answer_count": 1, "score": 1, "last_activity_date": 1488406949, "creation_date": 1488399177, "question_id": 42541145, "link": "https://stackoverflow.com/questions/42541145/validate-presence-on-after-create", "title": "Validate presence on after_create", "body": "<p>I have a User model:</p>\n\n<pre><code>class User &lt; ApplicationRecord\n  # Include default devise modules. Others available are:\n  # :confirmable, :lockable, :timeoutable and :omniauthable\n  devise :database_authenticatable, :registerable,\n         :recoverable, :rememberable, :trackable, :validatable\n\n  has_one :profile, dependent: :destroy  \n  after_create :build_profile\nend\n</code></pre>\n\n<p>So when the user registers, there profile is created and they are redirected to the <code>edit_profile_page</code></p>\n\n<pre><code>class RegistrationsController &lt; Devise::RegistrationsController\n  protected\n\n  def after_sign_up_path_for(resource)\n    edit_profile_path(current_user)\n  end\n\nend\n</code></pre>\n\n<p>In my profile model I'm trying to set some validation</p>\n\n<pre><code>class Profile &lt; ApplicationRecord\n  belongs_to :user\n  ...\n  validates :name, presence: true\nend\n</code></pre>\n\n<p>Im also using the friendly_id gem</p>\n\n<p>profile_controller.rb</p>\n\n<pre><code>def set_profile\n  @profile = Profile.friendly.find(params[:id])\nend\n</code></pre>\n\n<p>The error I'm getting is when I register a new user is:</p>\n\n<pre><code>Couldn't find Profile with 'id'=6\n</code></pre>\n\n<p>This only happens when I try to apply the <code>validates :name, presence: true</code>, without this my application works fine. I need a way to validate the name after the user is registered, after the profile model is created.</p>\n\n<p>Im also getting the error at this line:</p>\n\n<pre><code>def set_profile\n  @profile = Profile.friendly.find(params[:id])\nend\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-3", "ruby-on-rails-4", "stripe-payments"], "answers": [{"comments": [{"owner": {"reputation": 983, "user_id": 1335411, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/663d5f078fa32a6f6e0e5f5877d166f4?s=128&d=identicon&r=PG", "display_name": "thenextmogul", "link": "https://stackoverflow.com/users/1335411/thenextmogul"}, "edited": false, "score": 0, "creation_date": 1488398932, "post_id": 42540985, "comment_id": 72217864, "body": "That did the job! Geez! Thanks!"}], "tags": [], "owner": {"reputation": 47232, "user_id": 1772830, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/Qtoqg.jpg?s=128&g=1", "display_name": "Andrey Deineko", "link": "https://stackoverflow.com/users/1772830/andrey-deineko"}, "is_accepted": true, "score": 3, "last_activity_date": 1488398631, "creation_date": 1488398631, "answer_id": 42540985, "question_id": 42540967, "link": "https://stackoverflow.com/questions/42540967/rounding-in-ruby-rails/42540985#42540985", "title": "Rounding in Ruby (Rails)", "body": "<p>You just need to pass a correct datatype into helper. </p>\n\n<p>Instead of feeding it <code>Integer</code> instance (<code>995 / 100</code> gives you integer <strong><code>9</code></strong>), pass a <code>Float</code> instance (<code>995 / 100.to_f</code>, which gives you <code>Float</code> <strong><code>9.95</code></strong>):</p>\n\n<pre><code>number_with_precision (995 / 100.to_f, precision: 2) # or 995 / 100.0\n#=&gt; 9.95\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 21, "user_id": 1604624, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qLsw2.png?s=128&g=1", "display_name": "Alexandre Cruz", "link": "https://stackoverflow.com/users/1604624/alexandre-cruz"}, "is_accepted": false, "score": 1, "last_activity_date": 1488398810, "creation_date": 1488398810, "answer_id": 42541035, "question_id": 42540967, "link": "https://stackoverflow.com/questions/42540967/rounding-in-ruby-rails/42541035#42541035", "title": "Rounding in Ruby (Rails)", "body": "<p>You can try to use <code>995 / 100.00</code> (Python also has this behavior).</p>\n\n<p>As you are using Integer / Integer => Integer.\nDoing a Integer / Float => Float.</p>\n"}], "owner": {"reputation": 983, "user_id": 1335411, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/663d5f078fa32a6f6e0e5f5877d166f4?s=128&d=identicon&r=PG", "display_name": "thenextmogul", "link": "https://stackoverflow.com/users/1335411/thenextmogul"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 50, "favorite_count": 0, "closed_date": 1488398922, "accepted_answer_id": 42540985, "answer_count": 2, "score": 0, "last_activity_date": 1488398810, "creation_date": 1488398559, "question_id": 42540967, "link": "https://stackoverflow.com/questions/42540967/rounding-in-ruby-rails", "closed_reason": "Duplicate", "title": "Rounding in Ruby (Rails)", "body": "<p>I don't know why this is so difficult, I am clearly using the wrong methods. But I am working with the Stripe API (everything works well) and I am trying to round a subscription amount to two decimal places. </p>\n\n<p>For example, Stripe forces me to use cents as the unit of currency. So if I have a 995 cents subscription, I clearly want it to show up as $9.95. But the method I am using (number_with_precision (995 / 100, :precision => 2) is giving me 9.00 instead of 9.95. Then I tried the \"round\" method and it too gives me 9.00.  </p>\n\n<p>I see a few rounding posts here on StackOverflow but I can't seem to find anything that solves my convert to dollars/cents then round to 2 decimal places issue. </p>\n\n<p>Any help on this would be appreciated. Thanks in advance for your time.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "csv", "import"], "comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1488397823, "post_id": 42540661, "comment_id": 72217207, "body": "You might have to rewrite your file before parsing it. Does your header row have any distinguishing characteristics that can help you find it?"}, {"owner": {"reputation": 233, "user_id": 5754845, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/3b8a0a203d05cc0b0e1122d10aa315ad?s=128&d=identicon&r=PG&f=1", "display_name": "bwatson30", "link": "https://stackoverflow.com/users/5754845/bwatson30"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1488397983, "post_id": 42540661, "comment_id": 72217292, "body": "It has distinguishing words like &quot;TALLY&quot; and &quot;SPIRIT Barcode&quot; among a few others that aren&#39;t anywhere else in the files"}, {"owner": {"reputation": 14010, "user_id": 3109182, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/a4b305f0077055b4fdcf715067775d5a?s=128&d=identicon&r=PG", "display_name": "Anthony", "link": "https://stackoverflow.com/users/3109182/anthony"}, "edited": false, "score": 0, "creation_date": 1488398032, "post_id": 42540661, "comment_id": 72217326, "body": "is the file small enough to be able to read entirely in memory?"}, {"owner": {"reputation": 233, "user_id": 5754845, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/3b8a0a203d05cc0b0e1122d10aa315ad?s=128&d=identicon&r=PG&f=1", "display_name": "bwatson30", "link": "https://stackoverflow.com/users/5754845/bwatson30"}, "edited": false, "score": 0, "creation_date": 1488398151, "post_id": 42540661, "comment_id": 72217409, "body": "typically &lt;500Kb, few dozen to few thousand lines"}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1488399186, "post_id": 42540661, "comment_id": 72218024, "body": "Find that line, shunt it to the top, feed the revised version to <code>CSV.parse</code>."}, {"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 0, "creation_date": 1488403531, "post_id": 42540661, "comment_id": 72220492, "body": "Your question isn&#39;t asked well. Please read &quot;<a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>&quot;. You need to provide a tiny example of the input CSV instead of expecting us to generate one to help you."}], "answers": [{"tags": [], "owner": {"reputation": 48049, "user_id": 6419007, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/CwqtX.jpg?s=128&g=1", "display_name": "Eric Duminil", "link": "https://stackoverflow.com/users/6419007/eric-duminil"}, "is_accepted": false, "score": 1, "last_activity_date": 1488403563, "creation_date": 1488403563, "answer_id": 42542353, "question_id": 42540661, "link": "https://stackoverflow.com/questions/42540661/header-not-in-row-1-csv-import-ruby-rails/42542353#42542353", "title": "Header not in Row 1 CSV Import Ruby Rails", "body": "<p>This code parses the file only once, reading it line by line and looking for <code>SPIRIT Barcode</code>.</p>\n\n<p>Once the line is found, it removes the newline, and splits it to get an array of header names.</p>\n\n<p><code>CSV.parse</code> can be called on the file directly. Since it has already been read until the header, it will start at the correct line :</p>\n\n<pre><code>require 'csv'\nsep = ';'\nFile.open('test.csv'){|file|\n header = file.find{|line| line.include?('SPIRIT Barcode')}.chomp.split(sep)\n CSV.parse(file, headers: header, col_sep: sep).each do |row|\n   p row\n end\n}\n</code></pre>\n\n<p>With <code>test.csv</code> as :</p>\n\n<pre><code>Ignore me\nIgnore me\nSPIRIT Barcode; B; C\n1; 2; 3\n4; 5; 6\n</code></pre>\n\n<p>It outputs :</p>\n\n<pre><code>#&lt;CSV::Row \"SPIRIT Barcode\":\"1\" \" B\":\" 2\" \" C\":\" 3\"&gt;\n#&lt;CSV::Row \"SPIRIT Barcode\":\"4\" \" B\":\" 5\" \" C\":\" 6\"&gt;\n</code></pre>\n\n<p>It shouldn't be hard to adapt it to your data.</p>\n"}, {"comments": [{"owner": {"reputation": 48049, "user_id": 6419007, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/CwqtX.jpg?s=128&g=1", "display_name": "Eric Duminil", "link": "https://stackoverflow.com/users/6419007/eric-duminil"}, "edited": false, "score": 0, "creation_date": 1488405108, "post_id": 42542444, "comment_id": 72221381, "body": "You don&#39;t use the header, do you?"}], "tags": [], "owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "is_accepted": false, "score": 0, "last_activity_date": 1488403933, "creation_date": 1488403933, "answer_id": 42542444, "question_id": 42540661, "link": "https://stackoverflow.com/questions/42540661/header-not-in-row-1-csv-import-ruby-rails/42542444#42542444", "title": "Header not in Row 1 CSV Import Ruby Rails", "body": "<p>This is untested, but it's the general idea for what you're trying to do:</p>\n\n<pre><code>require 'csv'\n\nheader_found = false\nFile.foreach('path/to/file.csv') do |li|\n  next unless header_found || li['SPIRIT Barcode']\n  header_found = true\n  # start processing CSV...\n  CSV.parse(li) do |row|\n    # use row here...\n  end\nend\n</code></pre>\n\n<p>You'll have to figure out what to do when the header is found if you want to keep track of the values.</p>\n"}], "owner": {"reputation": 233, "user_id": 5754845, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/3b8a0a203d05cc0b0e1122d10aa315ad?s=128&d=identicon&r=PG&f=1", "display_name": "bwatson30", "link": "https://stackoverflow.com/users/5754845/bwatson30"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 403, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1488403933, "creation_date": 1488397621, "last_edit_date": 1488403470, "question_id": 42540661, "link": "https://stackoverflow.com/questions/42540661/header-not-in-row-1-csv-import-ruby-rails", "title": "Header not in Row 1 CSV Import Ruby Rails", "body": "<p>I'm trying to import CSV files and the header row keeps moving around, sometimes it's in row 20, sometimes it's in 25, and so on, but the field 'SPIRIT Barcode' is always in the header and it's the only thing I'm interested in at this point. I'm saving it in \"barcode\".  </p>\n\n<p>How do I manipulate this to find the row 'SPIRIT Barcode' is in and use that as the header? (everything above the header can be ignored)</p>\n\n<pre><code>def self.import(file)\n @b = []\n CSV.foreach(file.path, headers: true) do |row|\n  entry = ZygReport.find_by(barcode: row['SPIRIT Barcode']) || new\n  entry.update({\n    :barcode =&gt; row['SPIRIT Barcode'],\n    })\n  entry.save!\n  @b &lt;&lt; [entry.barcode]\n end\nend\n</code></pre>\n\n<p>Ignore the <code>@b</code>, that's for another function.  </p>\n"}, {"tags": ["ruby-on-rails", "ruby", "activerecord"], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4187589"}, "is_accepted": false, "score": 1, "last_activity_date": 1488408928, "creation_date": 1488408928, "answer_id": 42543706, "question_id": 42540623, "link": "https://stackoverflow.com/questions/42540623/rails-virtually-update-attribute-on-record-call-for-through-tables/42543706#42543706", "title": "Rails: Virtually update attribute on record call for :through tables", "body": "<p>Not sure I understood your question, but you you can do this to get an object and change one of its attribute's value locally:</p>\n\n<pre><code>   @product =\n      Product.last.tap do |product|\n        product.cost = 100\n        product.readonly! # to ensure you won't persist this change\n      end\n</code></pre>\n"}], "owner": {"reputation": 719, "user_id": 2514481, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/891a3231a9ca01f1b2770e92885821ff?s=128&d=identicon&r=PG", "display_name": "Drakken Saer", "link": "https://stackoverflow.com/users/2514481/drakken-saer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 22, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1488408928, "creation_date": 1488397474, "question_id": 42540623, "link": "https://stackoverflow.com/questions/42540623/rails-virtually-update-attribute-on-record-call-for-through-tables", "title": "Rails: Virtually update attribute on record call for :through tables", "body": "<p>I want to know if it's possible to achieve something like this: <code>Product.last(cost: 100)</code></p>\n\n<p>Where it will return the product, but with a virtually updated cost attribute (so there is no change to the database).</p>\n\n<p>Here is the scenario, maybe someone can tell me a more elegant way of doing what I am trying to: I have three models, <code>Order</code>, <code>LineItem</code>, and <code>Product</code>. LineItem belongs_to Order and Order has_many LineItems. LineItem is polymorphic. Order has_many products through LineItems (but Product does not belong to LineItem or Order). Order.products &lt;&lt; Product.first works as I would expect, the line item is assigned the product and the order will save correctly. However.. Each line item in an order has a cost attribute that by default inherits from the cost of the product. I want to modify the cost attribute on LineItem without modifying it on Product (i.e. a Product has some sort of temporary discount on it that adjusts the price). Am I going about this in the best way? </p>\n"}, {"tags": ["arrays", "ruby", "file", "csv"], "comments": [{"owner": {"reputation": 14010, "user_id": 3109182, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/a4b305f0077055b4fdcf715067775d5a?s=128&d=identicon&r=PG", "display_name": "Anthony", "link": "https://stackoverflow.com/users/3109182/anthony"}, "edited": false, "score": 1, "creation_date": 1488398114, "post_id": 42540568, "comment_id": 72217382, "body": "What is the desired output?"}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 1, "creation_date": 1488399089, "post_id": 42540568, "comment_id": 72217964, "body": "<code>require &#39;csv&#39;</code> is redundant, the code below never uses CSV."}, {"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 0, "creation_date": 1488404044, "post_id": 42540568, "comment_id": 72220781, "body": "I don&#39;t see where you try to do a calculation. Show us your attempt. Or do you want us to write that for you?"}, {"owner": {"reputation": 1, "user_id": 3907932, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3e7046bd7ec7126e2ee9bfbca223056b?s=128&d=identicon&r=PG&f=1", "display_name": "user3907932", "link": "https://stackoverflow.com/users/3907932/user3907932"}, "edited": false, "score": 0, "creation_date": 1488405403, "post_id": 42540568, "comment_id": 72221559, "body": "The first step was to obtain a hash. Now i must calculate the points per match."}, {"owner": {"reputation": 1, "user_id": 3907932, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3e7046bd7ec7126e2ee9bfbca223056b?s=128&d=identicon&r=PG&f=1", "display_name": "user3907932", "link": "https://stackoverflow.com/users/3907932/user3907932"}, "edited": false, "score": 0, "creation_date": 1488406228, "post_id": 42540568, "comment_id": 72221929, "body": "1. Boca, 6 pts 2. River, 5 pts 3. San Lorenzo, 1 pt 3. Independiente, 1 pt 5. Grouches, 0 pts"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 3907932, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3e7046bd7ec7126e2ee9bfbca223056b?s=128&d=identicon&r=PG&f=1", "display_name": "user3907932", "link": "https://stackoverflow.com/users/3907932/user3907932"}, "edited": false, "score": 0, "creation_date": 1488399278, "post_id": 42540959, "comment_id": 72218078, "body": "undefined method `split&#39; for Array"}, {"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 0, "creation_date": 1488404087, "post_id": 42540959, "comment_id": 72220808, "body": "Please take the time to format the answer correctly for readability. Also, don&#39;t use links to images to display important information. Instead, copy that information into the answer. Links rot then break, and when they do that information is lost."}, {"owner": {"reputation": 1, "user_id": 3907932, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3e7046bd7ec7126e2ee9bfbca223056b?s=128&d=identicon&r=PG&f=1", "display_name": "user3907932", "link": "https://stackoverflow.com/users/3907932/user3907932"}, "edited": false, "score": 0, "creation_date": 1488405195, "post_id": 42540959, "comment_id": 72221429, "body": "#=&gt; [{&quot;player1&quot;=&gt;&quot;Boca&quot;, &quot;scope_p1&quot;=&gt;&quot;3&quot;, &quot;player2&quot;=&gt;&quot;River&quot;, &quot;score_p2&quot;=&gt;&quot;3&quot;}, {&quot;player1&quot;=&gt;&quot;Independiente&quot;, &quot;scope_p1&quot;=&gt;&quot;1&quot;, &quot;player2&quot;=&gt;&quot;San Lorenzo&quot;, &quot;score_p2&quot;=&gt;&quot;0&quot;}, {&quot;player1&quot;=&gt;&quot;Boca&quot;, &quot;scope_p1&quot;=&gt;&quot;1&quot;, &quot;player2&quot;=&gt;&quot;San Lorenzo&quot;, &quot;score_p2&quot;=&gt;&quot;1&quot;}, {&quot;player1&quot;=&gt;&quot;Independiente&quot;, &quot;scope_p1&quot;=&gt;&quot;3&quot;, &quot;player2&quot;=&gt;&quot;River&quot;, &quot;score_p2&quot;=&gt;&quot;1&quot;}, {&quot;player1&quot;=&gt;&quot;Boca&quot;, &quot;scope_p1&quot;=&gt;&quot;4&quot;, &quot;player2&quot;=&gt;&quot;Grouches&quot;, &quot;score_p2&quot;=&gt;&quot;0&quot;}]"}], "tags": [], "owner": {"reputation": 492, "user_id": 7165699, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-x_MpBBlHl8s/AAAAAAAAAAI/AAAAAAAABGc/dZSBZ1sRQwo/photo.jpg?sz=128", "display_name": "Alexander Taborda", "link": "https://stackoverflow.com/users/7165699/alexander-taborda"}, "is_accepted": true, "score": 0, "last_activity_date": 1488406406, "last_edit_date": 1488406406, "creation_date": 1488398540, "answer_id": 42540959, "question_id": 42540568, "link": "https://stackoverflow.com/questions/42540568/ruby-csv-readline-convert-to-hash/42540959#42540959", "title": "Ruby CSV.readline convert to hash", "body": "<pre><code>matches = []\n\nFile.readlines('data.txt').each do |line|\n\n  my_line = line.chomp.split(', ').map! { |l| l.split(/\\s+(?=\\d+$)/) }.flatten \n\n  matches &lt;&lt; [['player1', 'scope_p1', 'player2', 'score_p2'], my_line].transpose.to_h\n\nend\n\np matches\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/oSwDo.png\" rel=\"nofollow noreferrer\">Example Here</a></p>\n"}, {"comments": [{"owner": {"reputation": 1, "user_id": 3907932, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3e7046bd7ec7126e2ee9bfbca223056b?s=128&d=identicon&r=PG&f=1", "display_name": "user3907932", "link": "https://stackoverflow.com/users/3907932/user3907932"}, "edited": false, "score": 0, "creation_date": 1488400183, "post_id": 42541059, "comment_id": 72218594, "body": "#=&gt; Boca 3\u2014River 3  : Independiente 1\u2014San Lorenzo 0  : Boca 1\u2014San Lorenzo 1  : Independiente 3\u2014River 1  : Boca 4\u2014Grouches 0  :"}, {"owner": {"reputation": 1, "user_id": 3907932, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3e7046bd7ec7126e2ee9bfbca223056b?s=128&d=identicon&r=PG&f=1", "display_name": "user3907932", "link": "https://stackoverflow.com/users/3907932/user3907932"}, "edited": false, "score": 0, "creation_date": 1488400519, "post_id": 42541059, "comment_id": 72218779, "body": "line = line.map { |e| e.split(&quot;, &quot;)} =&gt; [[&quot;Boca 3&quot;, &quot;River 3\\n&quot;], [&quot;Independiente 1&quot;, &quot;San Lorenzo 0\\n&quot;], [&quot;Boca 1&quot;, &quot;San Lorenzo 1\\n&quot;], [&quot;Independiente 3&quot;, &quot;River 1\\n&quot;], [&quot;Boca 4&quot;, &quot;Grouches 0\\n&quot;]]"}], "tags": [], "owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "is_accepted": false, "score": 0, "last_activity_date": 1488398882, "creation_date": 1488398882, "answer_id": 42541059, "question_id": 42540568, "link": "https://stackoverflow.com/questions/42540568/ruby-csv-readline-convert-to-hash/42541059#42541059", "title": "Ruby CSV.readline convert to hash", "body": "<pre><code>File.readlines('data.txt')\n    .map { |e| e.split(\", \").map { |e| e.split(/\\s+(?=\\d+$)/) } }\n    .map { |((t1, s1), (t2, s2))| \"#{t1}\u2014#{t2} #{s1}:#{s2}\"  } \n#=&gt; [\n#  [0] \"Boca\u2014River 3:3\",\n#  [1] \"Independiente\u2014San Lorenzo 1:0\",\n#  [2] \"Boca\u2014San Lorenzo 1:1\",\n#  [3] \"Independiente\u2014River 3:1\",\n#  [4] \"Boca\u2014Grouches 4:0\"\n# ]\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 3907932, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3e7046bd7ec7126e2ee9bfbca223056b?s=128&d=identicon&r=PG&f=1", "display_name": "user3907932", "link": "https://stackoverflow.com/users/3907932/user3907932"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 126, "favorite_count": 0, "accepted_answer_id": 42540959, "answer_count": 2, "score": -4, "last_activity_date": 1488406406, "creation_date": 1488397306, "last_edit_date": 1488397498, "question_id": 42540568, "link": "https://stackoverflow.com/questions/42540568/ruby-csv-readline-convert-to-hash", "title": "Ruby CSV.readline convert to hash", "body": "<p>I have file of results of football matches</p>\n\n<pre><code>Boca 3, River 3\nIndependiente 1, San Lorenzo 0\nBoca 1, San Lorenzo 1\nIndependiente 3, River 1\nBoca 4, Grouches 0\n</code></pre>\n\n<p>I did:</p>\n\n<pre><code>require 'csv'\nmatches = []\nFile.readlines('data.txt').each do |line|\n    matches &lt;&lt; line.chomp\nend\nputs matches\n</code></pre>\n\n<p>And I need to calculate the result of each match</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "relationship"], "answers": [{"comments": [{"owner": {"reputation": 277, "user_id": 2503877, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/CfWn0.jpg?s=128&g=1", "display_name": "Nerzid", "link": "https://stackoverflow.com/users/2503877/nerzid"}, "edited": false, "score": 0, "creation_date": 1488428697, "post_id": 42543520, "comment_id": 72229109, "body": "Thank you, that works for question 1. What can I do about question 2?"}, {"owner": {"reputation": 32451, "user_id": 2516474, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a2179a340c0e84edc285d432211145d?s=128&d=identicon&r=PG", "display_name": "SteveTurczyn", "link": "https://stackoverflow.com/users/2516474/steveturczyn"}, "reply_to_user": {"reputation": 277, "user_id": 2503877, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/CfWn0.jpg?s=128&g=1", "display_name": "Nerzid", "link": "https://stackoverflow.com/users/2503877/nerzid"}, "edited": false, "score": 0, "creation_date": 1488472111, "post_id": 42543520, "comment_id": 72255656, "body": "I&#39;ve edited my answer to show how you can set the group_map status for this group to &#39;accepted&#39;"}], "tags": [], "owner": {"reputation": 32451, "user_id": 2516474, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a2179a340c0e84edc285d432211145d?s=128&d=identicon&r=PG", "display_name": "SteveTurczyn", "link": "https://stackoverflow.com/users/2516474/steveturczyn"}, "is_accepted": true, "score": 1, "last_activity_date": 1488472076, "last_edit_date": 1488472076, "creation_date": 1488408166, "answer_id": 42543520, "question_id": 42540409, "link": "https://stackoverflow.com/questions/42540409/different-relationships-with-the-same-model/42543520#42543520", "title": "Different Relationships with the same model", "body": "<p>The group / user owner relationship is a separate relationship than the through <code>GroupMap</code> relationship.  You need to specify it separately.</p>\n\n<pre><code>  def create\n    @group = current_user.groups.create(group_params)\n    @group.user = current_user\n\n    if @group.save\n      group_map = @group.group_maps.first\n      group_map.status = 'accepted'\n      group_map.save\n      redirect_to root_path\n    else\n      render 'new'\n    end\n  end\n</code></pre>\n"}], "owner": {"reputation": 277, "user_id": 2503877, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/CfWn0.jpg?s=128&g=1", "display_name": "Nerzid", "link": "https://stackoverflow.com/users/2503877/nerzid"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 32, "favorite_count": 0, "accepted_answer_id": 42543520, "answer_count": 1, "score": 0, "last_activity_date": 1488472076, "creation_date": 1488396749, "question_id": 42540409, "link": "https://stackoverflow.com/questions/42540409/different-relationships-with-the-same-model", "title": "Different Relationships with the same model", "body": "<p>I've 3 models; <strong>User</strong> , <strong>Group</strong> and <strong>GroupMap</strong>.</p>\n\n<p>Users can have multiple groups and groups have multiple users. This is n-m relationship and it is done via GroupMap. GroupMap also have status, and type so I need this model as well. This is the first relationship.</p>\n\n<p>A group can only have one owner which is user. this is 1-n relationship.</p>\n\n<p><strong>user.rb</strong></p>\n\n<pre><code>class User &lt; ApplicationRecord\n\n  has_many :group_maps\n  has_many :groups, :through =&gt; :group_maps\n</code></pre>\n\n<p><strong>group.rb</strong></p>\n\n<pre><code>class Group &lt; ApplicationRecord\n\n  belongs_to :user\n\n  has_many :group_maps\n  has_many :users, :through =&gt; :group_maps\n</code></pre>\n\n<p><strong>group_map.rb</strong></p>\n\n<pre><code>class GroupMap &lt; ApplicationRecord\n  belongs_to :group\n  belongs_to :user\n</code></pre>\n\n<p><strong>groups_controller.rb</strong></p>\n\n<pre><code>class GroupsController &lt; ApplicationController\n\n  def new\n    @group = Group.new\n  end\n\n  def create\n    @group = current_user.groups.create(group_params)\n\n    if @group.save\n      redirect_to root_path\n    else\n      render 'new'\n    end\n  end\n</code></pre>\n\n<p>Although I can create groups with this code there are 2 problems here;</p>\n\n<ol>\n<li>user_id in Group model which is to store owner of it is always nil although in GroupMap model it set's the user_id properly. </li>\n<li>In step 1, it is good to see owner in GroupMap too since its a member of that group too but its status is always nil. There are 3 type of status(waiting,accepted,reject). In this case, when a owner creates that group, its status with the group must be accepted as well.</li>\n</ol>\n\n<p><strong>log</strong></p>\n\n<pre><code>(0.0ms)  begin transaction\n  SQL (1.0ms)  INSERT INTO \"groups\" (\"name\") VALUES (?)  [[\"name\", \"Football lovers\"]]\n  SQL (0.5ms)  INSERT INTO \"group_maps\" (\"group_id\", \"user_id\", \"created_at\", \"updated_at\") VALUES (?, ?, ?, ?)  [[\"group_id\", 8], [\"user_id\", 4], [\"created_at\", 2017-03-01 19:03:55 UTC], [\"updated_at\", 2017-03-01 19:03:55 UTC]]\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "heroku", "environment-variables"], "answers": [{"comments": [{"owner": {"reputation": 889, "user_id": 4230755, "user_type": "registered", "accept_rate": 22, "profile_image": "https://www.gravatar.com/avatar/c155e4cbdfb70d17b60725b16270c662?s=128&d=identicon&r=PG&f=1", "display_name": "tx291", "link": "https://stackoverflow.com/users/4230755/tx291"}, "edited": false, "score": 0, "creation_date": 1488397213, "post_id": 42540466, "comment_id": 72216878, "body": "OK, thanks. Where would you set &#39;APPLICATION_HOST&#39; equal to my custom url, though? or are you saying put the url in those square brackets?"}, {"owner": {"reputation": 1342, "user_id": 1143549, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/45da1bf4376d6f184e41de57e03789b9?s=128&d=identicon&r=PG", "display_name": "Derek Wright", "link": "https://stackoverflow.com/users/1143549/derek-wright"}, "reply_to_user": {"reputation": 889, "user_id": 4230755, "user_type": "registered", "accept_rate": 22, "profile_image": "https://www.gravatar.com/avatar/c155e4cbdfb70d17b60725b16270c662?s=128&d=identicon&r=PG&f=1", "display_name": "tx291", "link": "https://stackoverflow.com/users/4230755/tx291"}, "edited": false, "score": 0, "creation_date": 1488397327, "post_id": 42540466, "comment_id": 72216939, "body": "That sets it to an environment variable so, as part of your deployment you could set an environment variable like: <code>export APPLICATION_HOST=&#39;app.example.com&#39;</code> OR if you want to be a bit more static about it, then you could get rid of <code>ENV[&#39;APPLICATION_HOST&#39;]</code> and substitute it for the name <code>&#39;app.example.com&#39;</code>"}, {"owner": {"reputation": 889, "user_id": 4230755, "user_type": "registered", "accept_rate": 22, "profile_image": "https://www.gravatar.com/avatar/c155e4cbdfb70d17b60725b16270c662?s=128&d=identicon&r=PG&f=1", "display_name": "tx291", "link": "https://stackoverflow.com/users/4230755/tx291"}, "edited": false, "score": 0, "creation_date": 1488397782, "post_id": 42540466, "comment_id": 72217176, "body": "OK-- thank you so much. I&#39;ll try this tonight after work! :)"}], "tags": [], "owner": {"reputation": 1342, "user_id": 1143549, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/45da1bf4376d6f184e41de57e03789b9?s=128&d=identicon&r=PG", "display_name": "Derek Wright", "link": "https://stackoverflow.com/users/1143549/derek-wright"}, "is_accepted": false, "score": 0, "last_activity_date": 1488396935, "creation_date": 1488396935, "answer_id": 42540466, "question_id": 42540279, "link": "https://stackoverflow.com/questions/42540279/setting-application-host-environment-variable-in-rails-app/42540466#42540466", "title": "Setting application host environment variable in Rails App", "body": "<p>Try adding <code>config.action_controller.default_url_options = { host: ENV['APPLICATION_HOST'] }</code> to <code>config/environments/production.rb</code> inside the <code>Rails.application.configure do</code> block.</p>\n"}, {"tags": [], "owner": {"reputation": 1279, "user_id": 673882, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/85dcf397fd82a451b15cc591d2e2ef4b?s=128&d=identicon&r=PG", "display_name": "Nathan Loyer", "link": "https://stackoverflow.com/users/673882/nathan-loyer"}, "is_accepted": false, "score": 0, "last_activity_date": 1489009512, "creation_date": 1489009512, "answer_id": 42682485, "question_id": 42540279, "link": "https://stackoverflow.com/questions/42540279/setting-application-host-environment-variable-in-rails-app/42682485#42682485", "title": "Setting application host environment variable in Rails App", "body": "<p>Another solution is to sign up for a free CloudFlare Web account and have them manage your DNS. You can edit your Nameserver settings on GoDaddy and replace with the urls given to you by CloudFlare. CloudFlare supports root CNAME flattening, so you can set up a proper yourdomain.com -> yourdomain.herokuapp.com and you'll never see the Heroku address.</p>\n\n<p><a href=\"https://devcenter.heroku.com/articles/custom-domains#add-a-custom-root-domain\" rel=\"nofollow noreferrer\">https://devcenter.heroku.com/articles/custom-domains#add-a-custom-root-domain</a></p>\n"}], "owner": {"reputation": 889, "user_id": 4230755, "user_type": "registered", "accept_rate": 22, "profile_image": "https://www.gravatar.com/avatar/c155e4cbdfb70d17b60725b16270c662?s=128&d=identicon&r=PG&f=1", "display_name": "tx291", "link": "https://stackoverflow.com/users/4230755/tx291"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1914, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1489009512, "creation_date": 1488396251, "question_id": 42540279, "link": "https://stackoverflow.com/questions/42540279/setting-application-host-environment-variable-in-rails-app", "title": "Setting application host environment variable in Rails App", "body": "<p>I have a Rails app that is hosted on heroku, being forwarded to from GoDaddy. My forwarding is working fine, but when you land on the app, the URL in the browser displays as my herokuapp URL, and I'm trying to change this.</p>\n\n<p>GoDaddy is horrible with heroku and doesn't give you a good way to do this, but I read that you can set your <code>APPLICATION_HOST</code> env variable to your custom url. I'm just not exactly sure how to do this, or where this goes-- is it in the <code>production.rb</code> file in <code>config/environments</code>? I'm new to this and could really use some help!!!</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 47232, "user_id": 1772830, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/Qtoqg.jpg?s=128&g=1", "display_name": "Andrey Deineko", "link": "https://stackoverflow.com/users/1772830/andrey-deineko"}, "edited": false, "score": 2, "creation_date": 1488395770, "post_id": 42540118, "comment_id": 72215964, "body": "you put 21st element into it using one of number of ways. What&#39;s the question?"}, {"owner": {"reputation": 9030, "user_id": 5101476, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JCQrl.jpg?s=128&g=1", "display_name": "ice\u30c4", "link": "https://stackoverflow.com/users/5101476/ice%e3%83%84"}, "edited": false, "score": 1, "creation_date": 1488396076, "post_id": 42540118, "comment_id": 72216171, "body": "When reducing the size of an array, how do you decide which element(s) to remove?"}], "answers": [{"tags": [], "owner": {"reputation": 33166, "user_id": 7509065, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Joseph Sible-Reinstate Monica", "link": "https://stackoverflow.com/users/7509065/joseph-sible-reinstate-monica"}, "is_accepted": true, "score": 3, "last_activity_date": 1488395838, "creation_date": 1488395838, "answer_id": 42540162, "question_id": 42540118, "link": "https://stackoverflow.com/questions/42540118/how-to-resize-an-array-in-ruby/42540162#42540162", "title": "How to Resize An Array in Ruby?", "body": "<p>Unlike languages such as C, in Ruby, you don't need to worry about sizing an array to hold its elements. Just set a 21st element like you'd set any other element.</p>\n"}, {"comments": [{"owner": {"reputation": 21, "user_id": 7643216, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f683a3a29812975a6d4a68476d0089c4?s=128&d=identicon&r=PG&f=1", "display_name": "Fatih Ate\u015f", "link": "https://stackoverflow.com/users/7643216/fatih-ate%c5%9f"}, "edited": false, "score": 0, "creation_date": 1488401061, "post_id": 42540199, "comment_id": 72219073, "body": "Thank you for your answer"}, {"owner": {"reputation": 27144, "user_id": 3857758, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/58c4295826435f049b7fc32b98c240f9?s=128&d=identicon&r=PG&f=1", "display_name": "Ursus", "link": "https://stackoverflow.com/users/3857758/ursus"}, "reply_to_user": {"reputation": 21, "user_id": 7643216, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f683a3a29812975a6d4a68476d0089c4?s=128&d=identicon&r=PG&f=1", "display_name": "Fatih Ate\u015f", "link": "https://stackoverflow.com/users/7643216/fatih-ate%c5%9f"}, "edited": false, "score": 0, "creation_date": 1488418089, "post_id": 42540199, "comment_id": 72226078, "body": "Hey, my pleasure :)"}], "tags": [], "owner": {"reputation": 27144, "user_id": 3857758, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/58c4295826435f049b7fc32b98c240f9?s=128&d=identicon&r=PG&f=1", "display_name": "Ursus", "link": "https://stackoverflow.com/users/3857758/ursus"}, "is_accepted": false, "score": 3, "last_activity_date": 1488395992, "creation_date": 1488395992, "answer_id": 42540199, "question_id": 42540118, "link": "https://stackoverflow.com/questions/42540118/how-to-resize-an-array-in-ruby/42540199#42540199", "title": "How to Resize An Array in Ruby?", "body": "<p>In ruby arrays are dynamic. You can start with an empty array and add elements in it when needed.</p>\n\n<pre><code>a = []\na.push('hello')\na.size #\u00a01\na.concat(['hi'])\na.count #\u00a02\na += ['bye']\na.length #\u00a03\na.unshift('morning')\na.size # 4\na[4] = 'end'\na.size # 5\na # [\"morning\", \"hello\", \"hi\", \"bye\", \"end\"] \n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 7022, "user_id": 7659995, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iZH7M.png?s=128&g=1", "display_name": "MD XF", "link": "https://stackoverflow.com/users/7659995/md-xf"}, "edited": false, "score": 0, "creation_date": 1488406914, "post_id": 42540209, "comment_id": 72222248, "body": "Possibly add some explanation to your answer? Code-only answers are typically unhelpful."}], "tags": [], "owner": {"reputation": 46, "user_id": 7643346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c194c21d1b8d83fecf7d5aba6fe7f4a?s=128&d=identicon&r=PG&f=1", "display_name": "Rob Johnson", "link": "https://stackoverflow.com/users/7643346/rob-johnson"}, "is_accepted": false, "score": 0, "last_activity_date": 1488396023, "creation_date": 1488396023, "answer_id": 42540209, "question_id": 42540118, "link": "https://stackoverflow.com/questions/42540118/how-to-resize-an-array-in-ruby/42540209#42540209", "title": "How to Resize An Array in Ruby?", "body": "<pre><code>array = [1,2]\narray.fill(3, -1, 3)  #=&gt; [1,3,3,3]\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 48049, "user_id": 6419007, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/CwqtX.jpg?s=128&g=1", "display_name": "Eric Duminil", "link": "https://stackoverflow.com/users/6419007/eric-duminil"}, "is_accepted": false, "score": 2, "last_activity_date": 1488396029, "creation_date": 1488396029, "answer_id": 42540212, "question_id": 42540118, "link": "https://stackoverflow.com/questions/42540118/how-to-resize-an-array-in-ruby/42540212#42540212", "title": "How to Resize An Array in Ruby?", "body": "<p>Just add any element at any index, and <code>nil</code> will be added where needed :</p>\n\n<pre><code>2.3.1 :001 &gt; l = [1,2,3]\n =&gt; [1, 2, 3] \n2.3.1 :002 &gt; l[20] = 21\n =&gt; 21 \n2.3.1 :003 &gt; l\n =&gt; [1, 2, 3, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, 21] \n2.3.1 :004 &gt; l.first(10)\n =&gt; [1, 2, 3, nil, nil, nil, nil, nil, nil, nil]\n</code></pre>\n\n<p>If you want to decrease the size, you actually create a new array out of the first <code>n</code> elements.</p>\n"}], "owner": {"reputation": 21, "user_id": 7643216, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f683a3a29812975a6d4a68476d0089c4?s=128&d=identicon&r=PG&f=1", "display_name": "Fatih Ate\u015f", "link": "https://stackoverflow.com/users/7643216/fatih-ate%c5%9f"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2529, "favorite_count": 0, "closed_date": 1488437784, "accepted_answer_id": 42540162, "answer_count": 4, "score": 0, "last_activity_date": 1488396029, "creation_date": 1488395702, "question_id": 42540118, "link": "https://stackoverflow.com/questions/42540118/how-to-resize-an-array-in-ruby", "closed_reason": "Needs details or clarity", "title": "How to Resize An Array in Ruby?", "body": "<p>How can I increase or decrase of an Array in Ruby?\n Example I have array sized of 20 and I want to 21th value in it.\n I searched but I didnt find I needed solution. Please I m waiting for your answers. \nThank you </p>\n"}, {"tags": ["ruby", "chef-infra", "chef-recipe"], "answers": [{"tags": [], "owner": {"reputation": 43208, "user_id": 78722, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cf611565f0b79abd0b3dc200ad867661?s=128&d=identicon&r=PG", "display_name": "coderanger", "link": "https://stackoverflow.com/users/78722/coderanger"}, "is_accepted": true, "score": 2, "last_activity_date": 1488397884, "creation_date": 1488397884, "answer_id": 42540750, "question_id": 42539661, "link": "https://stackoverflow.com/questions/42539661/is-there-a-better-way-to-delete-an-installer-after-installation-in-chef/42540750#42540750", "title": "Is there a better way to delete an installer after installation, in chef", "body": "<p>We generally recommend not deleting so you can use the file for idempotence checks, using a notification to run the package install if the remote file changes.</p>\n"}], "owner": {"reputation": 385, "user_id": 3318043, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/38b9a9589bc51426c7a77b972caccd9b?s=128&d=identicon&r=PG", "display_name": "srajappa", "link": "https://stackoverflow.com/users/3318043/srajappa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 22, "favorite_count": 0, "accepted_answer_id": 42540750, "answer_count": 1, "score": 0, "last_activity_date": 1488398173, "creation_date": 1488394216, "last_edit_date": 1488398173, "question_id": 42539661, "link": "https://stackoverflow.com/questions/42539661/is-there-a-better-way-to-delete-an-installer-after-installation-in-chef", "title": "Is there a better way to delete an installer after installation, in chef", "body": "<p>eg.</p>\n\n<pre><code>remote_file '/app/abc/' + '/app.rpm' do\n    source \"https://location.com/app.rpm\"\nend\npackage 'app.rpm' do\n    source '/app/abc/app.rpm'\nend\nfile '/app/abc/app.rpm' do\n    action :delete\nend\n</code></pre>\n\n<p>This is how I am currently deleting the rpm file. Is there a better way to write the code, without having to include the <code>file</code> resource again ? </p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-5"], "answers": [{"tags": [], "owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "is_accepted": false, "score": 0, "last_activity_date": 1488393415, "creation_date": 1488393415, "answer_id": 42539421, "question_id": 42539385, "link": "https://stackoverflow.com/questions/42539385/polymorphic-association-and-creating-a-table-for-it/42539421#42539421", "title": "polymorphic association and creating a table for it", "body": "<p>The polymorphic association only relates to the <code>_type</code> and <code>_id</code> pair of columns. Everything else is up to you.</p>\n\n<p>So yes, you can add additional metadata if you like.</p>\n"}], "owner": {"reputation": 221, "user_id": 7576294, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/25aed7e1acd0e452fe9b537d15cf0e5e?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin", "link": "https://stackoverflow.com/users/7576294/kevin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 37, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1488393415, "creation_date": 1488393298, "question_id": 42539385, "link": "https://stackoverflow.com/questions/42539385/polymorphic-association-and-creating-a-table-for-it", "title": "polymorphic association and creating a table for it", "body": "<p>Say I have this:</p>\n\n<pre><code>class Picture &lt; ApplicationRecord\n  belongs_to :imageable, polymorphic: true\nend\n\nclass Employee &lt; ApplicationRecord\n  has_many :pictures, as: :imageable\nend\n\nclass Product &lt; ApplicationRecord\n  has_many :pictures, as: :imageable\nend\n</code></pre>\n\n<p>Does this require me to define a table exactly in the following way?</p>\n\n<pre><code>class CreatePictures &lt; ActiveRecord::Migration[5.0]\n  def change\n    create_table :pictures do |t|\n      t.string  :name\n      t.integer :imageable_id\n      t.string  :imageable_type\n      t.timestamps\n    end\n\n    add_index :pictures, [:imageable_type, :imageable_id]\n  end\nend\n</code></pre>\n\n<p>Or may I define a bit differently, with different columns or types, for example, that is, in a way I see more efficient? Will the polymorphic association remain functioning?  </p>\n"}, {"tags": ["html", "ruby-on-rails", "ruby", "metadata"], "comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 1, "creation_date": 1488392499, "post_id": 42539089, "comment_id": 72214008, "body": "You want to parse the page you rendered and extract information from the DOM? That sounds super inefficient. Why not just design your layout to capture the <code>&lt;title&gt;</code> content for you?"}, {"owner": {"reputation": 8117, "user_id": 1207687, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/cOUI4.jpg?s=128&g=1", "display_name": "Wes Foster", "link": "https://stackoverflow.com/users/1207687/wes-foster"}, "edited": false, "score": 2, "creation_date": 1488392538, "post_id": 42539089, "comment_id": 72214035, "body": "The answer is &quot;Yes.&quot; If you want a more specific answer, ask a more specific question."}], "answers": [{"tags": [], "owner": {"reputation": 4150, "user_id": 7470620, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/49f3026fe13841e41d1805178eed9a3c?s=128&d=identicon&r=PG", "display_name": "eiko", "link": "https://stackoverflow.com/users/7470620/eiko"}, "is_accepted": true, "score": 0, "last_activity_date": 1488393945, "last_edit_date": 1495542310, "creation_date": 1488393945, "answer_id": 42539567, "question_id": 42539089, "link": "https://stackoverflow.com/questions/42539089/how-to-extract-my-own-page-title-using-rails/42539567#42539567", "title": "How to extract my own page title using Rails", "body": "<p>The title of a page is specified in its html; therefore it is impossible (ie impractical) to reference the title of a page directly from the page itself and use it to render more content to the page before serving it. You have two options:</p>\n\n<p>1) Use javascript to modify the page after it has been completely rendered. (Not recommended)</p>\n\n<p>2) Modify your rails application so that the title content is accessible anywhere in the view. (Recommended) <a href=\"https://stackoverflow.com/questions/3841323/rails-page-titles\">This stackoverflow answer</a> outlines an elegant way to create a title variable which can be used to set and access the title from anywhere in the view.</p>\n\n<p>Note that in rails, the default title for each page is just the name of your rails app, and it's hardcoded into layouts/application.html.erb. So there really isn't much for you to \"capture.\" If you want your pages to have unique titles, you need to program the back-end for that from scratch, as it were.</p>\n"}], "owner": {"reputation": 512, "user_id": 6952495, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/oEQEL.jpg?s=128&g=1", "display_name": "RyanQuey", "link": "https://stackoverflow.com/users/6952495/ryanquey"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 36, "favorite_count": 0, "closed_date": 1488744582, "accepted_answer_id": 42539567, "answer_count": 1, "score": -3, "last_activity_date": 1488393945, "creation_date": 1488392214, "question_id": 42539089, "link": "https://stackoverflow.com/questions/42539089/how-to-extract-my-own-page-title-using-rails", "closed_reason": "Needs more focus", "title": "How to extract my own page title using Rails", "body": "<p>I've seen multiple ways to extract metadata from other web pages, but is there a simple way to extract my own page title, description, etc? </p>\n\n<p>I want to store the metadata in a variable so that I can call to_query on it and put it in a link. </p>\n\n<p>Ideally, without using JavaScript.</p>\n"}, {"tags": ["ruby", "string", "ruby-on-rails-3", "binary-search-tree"], "comments": [{"owner": {"reputation": 807, "user_id": 2651076, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/3274dc805ba25f33023bee2a4d32d6d9?s=128&d=identicon&r=PG&f=1", "display_name": "Sinstein", "link": "https://stackoverflow.com/users/2651076/sinstein"}, "edited": false, "score": 0, "creation_date": 1488391509, "post_id": 42538835, "comment_id": 72213409, "body": "What is the error you are encountering? Could you share the stack trace or output of the program in contrast  to the expected output?"}, {"owner": {"reputation": 3, "user_id": 5830517, "user_type": "registered", "profile_image": "https://graph.facebook.com/1088828371150153/picture?type=large", "display_name": "Sajith Thomas", "link": "https://stackoverflow.com/users/5830517/sajith-thomas"}, "reply_to_user": {"reputation": 807, "user_id": 2651076, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/3274dc805ba25f33023bee2a4d32d6d9?s=128&d=identicon&r=PG&f=1", "display_name": "Sinstein", "link": "https://stackoverflow.com/users/2651076/sinstein"}, "edited": false, "score": 0, "creation_date": 1488391948, "post_id": 42538835, "comment_id": 72213674, "body": "My count for the number of arrays having string Bob is wrong. As you can see, only one array has Bob but output list count as 2."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 1, "creation_date": 1488393163, "post_id": 42538835, "comment_id": 72214424, "body": "Indentation here is a bit of a mess. Do try and keep your code as organized as possible when asking questions as clarity helps communicate intent."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1488393195, "post_id": 42538835, "comment_id": 72214448, "body": "You also <b>really</b> do not want to do this: <code>ObjectSpace.each_object(Tree)</code>."}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 5830517, "user_type": "registered", "profile_image": "https://graph.facebook.com/1088828371150153/picture?type=large", "display_name": "Sajith Thomas", "link": "https://stackoverflow.com/users/5830517/sajith-thomas"}, "edited": false, "score": 0, "creation_date": 1488428569, "post_id": 42544560, "comment_id": 72229068, "body": "Thanks for your answer @Cary . But I have some doubts. I need to carry out this search process for each and every line(string) present in around 1000+ files each having 20,00,000+ lines.  I tried to do a normal linear search but it takes a lot of time. So i was asked to use a binary search tree to cut short the time.  So, what algorithm does the  scan method in ruby use? or is there any efficient way in which i can get this thing done?"}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "reply_to_user": {"reputation": 3, "user_id": 5830517, "user_type": "registered", "profile_image": "https://graph.facebook.com/1088828371150153/picture?type=large", "display_name": "Sajith Thomas", "link": "https://stackoverflow.com/users/5830517/sajith-thomas"}, "edited": false, "score": 0, "creation_date": 1488433643, "post_id": 42544560, "comment_id": 72230872, "body": "Not knowing you were dealing with large files, I gulped each file into a string using <a href=\"http://ruby-doc.org/core-2.3.0/IO.html#method-i-read\" rel=\"nofollow noreferrer\">IO#read</a>. For files that big you would read the file line-by-line (using, say, <a href=\"http://ruby-doc.org/core-2.3.0/IO.html#method-c-foreach\" rel=\"nofollow noreferrer\">IO#for_each</a>). My code would change very little. You would apply <a href=\"http://ruby-doc.org/core-2.3.0/String.html#method-i-scan\" rel=\"nofollow noreferrer\">String#scan</a> to each line and sum those totals over all lines... (cont.)"}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "reply_to_user": {"reputation": 3, "user_id": 5830517, "user_type": "registered", "profile_image": "https://graph.facebook.com/1088828371150153/picture?type=large", "display_name": "Sajith Thomas", "link": "https://stackoverflow.com/users/5830517/sajith-thomas"}, "edited": false, "score": 0, "creation_date": 1488434173, "post_id": 42544560, "comment_id": 72231084, "body": "...My answer is for searching strings, not words or substrings of words (because that was not part of the question&#39;s spec). If you want words, you need to do things differently (e.g., use a regular expression with word boundaries). If, for example, you were searching for the word &quot;cat&quot;, but just searched for that string, &quot;catsup&quot;, &quot;catch&quot; and so on would be counted....(cont.)"}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "reply_to_user": {"reputation": 3, "user_id": 5830517, "user_type": "registered", "profile_image": "https://graph.facebook.com/1088828371150153/picture?type=large", "display_name": "Sajith Thomas", "link": "https://stackoverflow.com/users/5830517/sajith-thomas"}, "edited": false, "score": 0, "creation_date": 1488434248, "post_id": 42544560, "comment_id": 72231116, "body": "...If you are searching for a large number of individual words (not strings), it might make sense to extract all words from a file into an array, sort the array, and then search for the words using, say, <a href=\"http://ruby-doc.org/core-2.3.0/Array.html#method-i-bsearch\" rel=\"nofollow noreferrer\">Array#bsearch</a>. Perhaps that&#39;s what the person who suggested using a binary search tree had in mind. Consider also performing the task with a shell script, using Unix tools like grep, awk, grep, and so on. See <a href=\"http://unix.stackexchange.com/questions/113693/how-to-count-specific-strings-in-file\">this SO question</a>."}], "tags": [], "owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "is_accepted": false, "score": 0, "last_activity_date": 1488413430, "creation_date": 1488413430, "answer_id": 42544560, "question_id": 42538835, "link": "https://stackoverflow.com/questions/42538835/getting-count-of-strings-using-binary-search-tree-in-ruby/42544560#42544560", "title": "Getting count of strings using Binary Search Tree in Ruby", "body": "<p>The question seems clear from the first two paragraphs, but I can't understand how a binary search tree could be used to advantage. My solution is a straigtforward approach to obtaining the desired counts. </p>\n\n<p><strong>Code</strong></p>\n\n<pre><code>def get_counts(filenames, target)\n  filenames.each_with_object([0, 0]) do |fname, arr|\n    n = File.read(fname).scan(/#{target}/).size\n    next if n.zero?\n    arr[0] += n\n    arr[1] += 1\n  end\nend\n</code></pre>\n\n<p>where <code>files</code> is an array of filenames and <code>target</code> is the string we are searching for.</p>\n\n<p><strong>Example</strong></p>\n\n<p>Let's start by making 3 test files.</p>\n\n<pre><code>filenames  = ['file1', 'file2', 'file3']\ntext       = [\"Hoya, Bob. Your bro's name is Bob too. Eh?\",\n              \"I gotta go feed my cat\",\n              \"A girl named Bob?\"]\n\nfilenames.zip(text).each { |fname, str| File.write(fname, str) }\n</code></pre>\n\n<p>Confirm the files were written:</p>\n\n<pre><code>filenames.map { |fname| File.read(fname) }\n  #=&gt; [\"Hoya, Bob. Your bro's name is Bob too. Eh?\", \n  #    \"I gotta go feed my cat\",\n  #    \"A girl named Bob?\"]\n</code></pre>\n\n<p>Suppose we are looking for the string</p>\n\n<pre><code>target = 'Bob'\n</code></pre>\n\n<p>Then</p>\n\n<pre><code>tot, files = get_counts(filenames, target)\n  #=&gt; [3, 2] \ntot\n  #=&gt; 3 \nfiles\n  #=&gt; 2 \n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 5830517, "user_type": "registered", "profile_image": "https://graph.facebook.com/1088828371150153/picture?type=large", "display_name": "Sajith Thomas", "link": "https://stackoverflow.com/users/5830517/sajith-thomas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 149, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1488413430, "creation_date": 1488391312, "last_edit_date": 1488391779, "question_id": 42538835, "link": "https://stackoverflow.com/questions/42538835/getting-count-of-strings-using-binary-search-tree-in-ruby", "title": "Getting count of strings using Binary Search Tree in Ruby", "body": "<p>I want to get the count of various strings stored in different files. Actually I need two types of counts. For a string str, </p>\n\n<p>1.) Total no of occurrences of the string str throughout all the files.\n2.) Number of files having the string str. </p>\n\n<p>Below is my RUBY Code for it in which i have managed to get the total count.\nBut i can't get the file count. I have used arrays instead of files for simplicity(analogous to files) and an instance variable 'flag'.</p>\n\n<p>My concept is that if flag = 0, it means the string is encountered for the first time in the first array. So the filecount(or arraycount in this case) is incremented and flag is set to 1. So when the same string appears in the same array , flag is already set to 1 and nothing happens.\n<strong>When an array is over, all the flag values are set back to 0.</strong>(I think so)</p>\n\n<p>But something's not working as expected. Thanks in Advance..!</p>\n\n<pre><code>    class Tree\n  attr_accessor :left\n  attr_accessor :right\n  attr_accessor :data\n  attr_accessor :count\n  attr_accessor :flag\n  attr_accessor :howmanyfiles\n\n  def initialize(x=nil)\n   @left = nil\n   @right = nil\n   @data = x\n   @count = 1\n   @flag = 0\n   @howmanyfiles = 1\n  end\n\n\n  def search(x)\n      if self.data == x\n        self.count = self.count + 1\n        if self.flag == 0\n          self.howmanyfiles = self.howmanyfiles + 1\n        end\n       return \"#{self.data} found\" #self\n      else\n       ltree = left != nil ? left.search(x) : nil\n       return ltree if ltree != nil\n       rtree = right != nil ? right.search(x) : nil\n       return rtree if rtree != nil\n      end\n    nil\n  end\n\n\n  def insert(x)\n   list = []\n\n   if @data == nil\n    @data = x\n    self.flag = 1\n   elsif @left == nil\n    @left = Tree.new(x)\n    self.flag = 1\n   elsif @right == nil\n    @right = Tree.new(x)\n    self.flag = 1\n   else\n    list &lt;&lt; @left\n    list &lt;&lt; @right\n    loop do\n     node = list.shift\n     if node.left == nil\n      node.insert(x)\n      break\n     else\n      list &lt;&lt; node.left\n     end\n     if node.right == nil\n      node.insert(x)\n      break\n     else\n      list &lt;&lt; node.right\n     end\n    end\n   end\n\n\n\n  end\n\n  def traverse()\n   list = []\n   yield @data\n   list &lt;&lt; @left if @left != nil\n   list &lt;&lt; @right if @right != nil\n   loop do\n    break if list.empty?\n    node = list.shift\n    yield node.data\n    list &lt;&lt; node.left if node.left != nil\n    list &lt;&lt; node.right if node.right != nil\n   end\n  end\n\n\n\n\n\n\nend\n\n\n  items = [\"Amal\",\"Hai\", \"Bob\", \"Bob\", \"Cat\", \"Cat\", \"Amal\", \"Dog\", \"Rizu\", \"Zol\",\"Amal\"]\n\n  tree = Tree.new\n\n  items.each {|x|\n\n    if tree.search(x) == nil\n       tree.insert(x)\n     end}\n\n\n     ObjectSpace.each_object(Tree) do |obj|\n      obj.flag = 0\n     end\n\n     items1 = [\"Amal\",\"wet\", \"jjj\", \"Cat\"]\n     items1.each {|x|\n\n       if tree.search(x) == nil\n          tree.insert(x)\n        end}\n\n\n\n        ObjectSpace.each_object(Tree) do |obj|\n         obj.flag = 0\n        end\n\n        items2 = [\"aa\",\"Amal\", \"jjj\"]\n        items2.each {|x|\n\n          if tree.search(x) == nil\n             tree.insert(x)\n           end}\n\n     ObjectSpace.each_object(Tree) do |obj|\n    puts obj.data.to_s + \" \" + obj.count.to_s + \" \" + obj.howmanyfiles.to_s\n   end\n\n  tree.traverse {|x|  print \"#{x} \"}\n  print \"\\n\"\n</code></pre>\n\n<p>OUTPUT - in format of string         total_count        ArrayCount</p>\n\n<pre><code>aa 1 1\njjj 2 2\nwet 1 1\nZol 1 1\nRizu 1 1\nDog 1 1\nCat 3 2\nBob 2 2  &lt;--Bob is only present in first array but still output says 2.\nHai 1 1\nAmal 5 3\nAmal Hai Bob Cat Dog Rizu Zol wet jjj aa \n</code></pre>\n"}, {"tags": ["ruby", "datamapper"], "answers": [{"comments": [{"owner": {"reputation": 814, "user_id": 5479076, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/ebf84ecaf15f684b53f18b9313cd1325?s=128&d=identicon&r=PG&f=1", "display_name": "Orsay", "link": "https://stackoverflow.com/users/5479076/orsay"}, "edited": false, "score": 0, "creation_date": 1488540713, "post_id": 42539804, "comment_id": 72288114, "body": "Thanks @eiko for your answer. Actually I don&#39;t want <code>refund</code> to be required. but I try to remove <code>required: true</code> and I get this error : &quot;NOT NULL constraint failed: consultations.refund (DataObjects::IntegrityError)&quot;. Just to test I try to let <code>refund</code> attributes to <code>require: true</code> and set it  (<code>new_consultation.refund = &quot;no&quot; </code>), and then you&#39;re write because it&#39;s working! But I can I remove the <code>require: true</code> without having this error, do you know how can I fix that ?"}, {"owner": {"reputation": 4150, "user_id": 7470620, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/49f3026fe13841e41d1805178eed9a3c?s=128&d=identicon&r=PG", "display_name": "eiko", "link": "https://stackoverflow.com/users/7470620/eiko"}, "reply_to_user": {"reputation": 814, "user_id": 5479076, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/ebf84ecaf15f684b53f18b9313cd1325?s=128&d=identicon&r=PG&f=1", "display_name": "Orsay", "link": "https://stackoverflow.com/users/5479076/orsay"}, "edited": false, "score": 0, "creation_date": 1488560707, "post_id": 42539804, "comment_id": 72301619, "body": "@Orsay could you try specifically putting <code>require: false</code> to see if that works?"}, {"owner": {"reputation": 814, "user_id": 5479076, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/ebf84ecaf15f684b53f18b9313cd1325?s=128&d=identicon&r=PG&f=1", "display_name": "Orsay", "link": "https://stackoverflow.com/users/5479076/orsay"}, "edited": false, "score": 0, "creation_date": 1488622355, "post_id": 42539804, "comment_id": 72320683, "body": "If I put <code>require : false </code>and still setting it (<code>consultation.refund = &#39;no refund&#39;)</code>  it works. But if I don&#39;t set it I get <code>NOT NULL constraint failed: consultations.refund (DataObjects::IntegrityError)</code>"}], "tags": [], "owner": {"reputation": 4150, "user_id": 7470620, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/49f3026fe13841e41d1805178eed9a3c?s=128&d=identicon&r=PG", "display_name": "eiko", "link": "https://stackoverflow.com/users/7470620/eiko"}, "is_accepted": true, "score": 0, "last_activity_date": 1488394646, "creation_date": 1488394646, "answer_id": 42539804, "question_id": 42538748, "link": "https://stackoverflow.com/questions/42538748/why-datamapper-methods-doesnt-work/42539804#42539804", "title": "Why datamapper methods doesn&#39;t work?", "body": "<p><code>new_consultation.save</code> checks to see if your object is valid before saving. If the object is valid, it will save and return <code>true</code>; otherwise, it will not save and return `false.</p>\n\n<p>It looks like your object is invalid because you've specified:</p>\n\n<pre><code>property :refund, Text, required: true \n</code></pre>\n\n<p>If refund is required, you need to specify it or your object won't save.</p>\n\n<p>Note that <code>puts new_consultation.date</code> works because <code>date</code> is still stored in the local object, even when <code>save</code> fails and none of the data is saved to the database.</p>\n"}], "owner": {"reputation": 814, "user_id": 5479076, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/ebf84ecaf15f684b53f18b9313cd1325?s=128&d=identicon&r=PG&f=1", "display_name": "Orsay", "link": "https://stackoverflow.com/users/5479076/orsay"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 187, "favorite_count": 0, "accepted_answer_id": 42539804, "answer_count": 1, "score": 0, "last_activity_date": 1488394646, "creation_date": 1488391014, "question_id": 42538748, "link": "https://stackoverflow.com/questions/42538748/why-datamapper-methods-doesnt-work", "title": "Why datamapper methods doesn&#39;t work?", "body": "<p>I tried to access to my existing data thanks to Datamapper.\nBut it doesn't work. All the methods like <code>.first</code>, <code>.all</code>,... return nothing. <code>.update</code> return an <code>undefined method update for nil:NilClass (NoMethodError)</code>...</p>\n\n<p>I'm sure the database is not empty because this code return well the <code>new_consultation.date</code></p>\n\n<pre><code>new_consultation = Consultation.new\nnew_consultation.name = name_prestation\nnew_consultation.expense = expense_prestation\nnew_consultation.date = date_prestation.empty? ? Time.now.strftime(\"%d/%m/%Y\") : date_prestation \nnew_consultation.save\nputs new_consultation\nputs new_consultation.date\n</code></pre>\n\n<p>This is the whole code :</p>\n\n<pre><code>DataMapper.setup(:default, 'sqlite:medical_expenses.db')\nclass Consultation\n  include DataMapper::Resource\n\n  property :id, Serial\n  property :name, Text, required: true\n  property :expense, Text, required: true\n  property :date, Text, required: true\n  property :refund, Text, required: true \nend\nDataMapper.finalize()\nDataMapper.auto_upgrade!()\n\n# Enter and save new consultation\nputs 'Prestations ?'\nname_prestation = gets.chomp\nputs 'Montant ?' \nexpense_prestation = gets.chomp\nputs 'Date ? (par d\u00e9faut date du jour)'\ndate_prestation = gets.chomp\nprint \"D\u00e9pense enregistr\u00e9e\"\n\nnew_consultation = Consultation.new\nnew_consultation.name = name_prestation\nnew_consultation.expense = expense_prestation\nnew_consultation.date = date_prestation.empty? ? Time.now.strftime(\"%d/%m/%Y\") : date_prestation \nnew_consultation.save\nputs new_consultation\nputs new_consultation.date\n\nConsultation.first.update(refund: 'none')\nputs Consultation.first\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "activerecord", "rails-activerecord"], "answers": [{"comments": [{"owner": {"reputation": 4842, "user_id": 1493868, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/7a84611ec325ce3125ec56149b2cfcb6?s=128&d=identicon&r=PG", "display_name": "Tr\u1ea7n Kim D\u1ef1", "link": "https://stackoverflow.com/users/1493868/tr%e1%ba%a7n-kim-d%e1%bb%b1"}, "edited": false, "score": 0, "creation_date": 1488391160, "post_id": 42538694, "comment_id": 72213215, "body": "database has <code>time</code> datatype. that means time not only application datatype."}], "tags": [], "owner": {"reputation": 3997, "user_id": 3998420, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/55ea542584d3fd2a430c3d409bdafc95?s=128&d=identicon&r=PG&f=1", "display_name": "bkunzi01", "link": "https://stackoverflow.com/users/3998420/bkunzi01"}, "is_accepted": false, "score": -1, "last_activity_date": 1488390870, "creation_date": 1488390870, "answer_id": 42538694, "question_id": 42538468, "link": "https://stackoverflow.com/questions/42538468/rails-why-time-datatype-start-at-1-1-2000/42538694#42538694", "title": "Rails: why time datatype start at 1/1/2000", "body": "<p>The difference between formats stored in your DB have nothing to do with Rails and everything to do with your database.  Date or Time formats are only 'valid' within your application, not within the database -more simply they are only responsible for the way time objects are displayed to your users and will not affect the way data is stored.  Your best bet is to save the records as time objects and then use rails helpers to present the data to your users in a meaningful way with such methods as <code>strptime</code> etc.</p>\n"}, {"comments": [{"owner": {"reputation": 4842, "user_id": 1493868, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/7a84611ec325ce3125ec56149b2cfcb6?s=128&d=identicon&r=PG", "display_name": "Tr\u1ea7n Kim D\u1ef1", "link": "https://stackoverflow.com/users/1493868/tr%e1%ba%a7n-kim-d%e1%bb%b1"}, "edited": false, "score": 0, "creation_date": 1488393401, "post_id": 42539230, "comment_id": 72214556, "body": "thanks. why rails choose &quot;1/1/2000&quot; not a base time 1970 for example. Are there any reasons here. thanks."}, {"owner": {"reputation": 394580, "user_id": 479863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ArUCE.jpg?s=128&g=1", "display_name": "mu is too short", "link": "https://stackoverflow.com/users/479863/mu-is-too-short"}, "reply_to_user": {"reputation": 4842, "user_id": 1493868, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/7a84611ec325ce3125ec56149b2cfcb6?s=128&d=identicon&r=PG", "display_name": "Tr\u1ea7n Kim D\u1ef1", "link": "https://stackoverflow.com/users/1493868/tr%e1%ba%a7n-kim-d%e1%bb%b1"}, "edited": false, "score": 0, "creation_date": 1488394148, "post_id": 42539230, "comment_id": 72214952, "body": "Because most of the Rails devs weren&#39;t alive in 1970? Seriously though, there&#39;s probably no particular reason, they just needed a date and 2000-01-01 looked good."}], "tags": [], "owner": {"reputation": 394580, "user_id": 479863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ArUCE.jpg?s=128&g=1", "display_name": "mu is too short", "link": "https://stackoverflow.com/users/479863/mu-is-too-short"}, "is_accepted": true, "score": 3, "last_activity_date": 1488392727, "creation_date": 1488392727, "answer_id": 42539230, "question_id": 42538468, "link": "https://stackoverflow.com/questions/42538468/rails-why-time-datatype-start-at-1-1-2000/42539230#42539230", "title": "Rails: why time datatype start at 1/1/2000", "body": "<p>There is no time-of-day class in Ruby or Rails so ActiveRecord represents <code>time</code> columns with datetime/timestamp classes.</p>\n\n<p>If you look inside the database without any of the ActiveRecord, Rails, or Ruby noise in the way, you'll see an <code>HH:MM:SS</code> time-of-day value. But when ActiveRecord pulls a <code>time</code> out of the database, it sets the date component to 2000-01-01 because a datetime has to have a date and AR picks that one.</p>\n\n<p>Any time you work with a <code>start_hour</code> in Ruby you'll have to ignore the date component.</p>\n"}], "owner": {"reputation": 4842, "user_id": 1493868, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/7a84611ec325ce3125ec56149b2cfcb6?s=128&d=identicon&r=PG", "display_name": "Tr\u1ea7n Kim D\u1ef1", "link": "https://stackoverflow.com/users/1493868/tr%e1%ba%a7n-kim-d%e1%bb%b1"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 351, "favorite_count": 0, "accepted_answer_id": 42539230, "answer_count": 2, "score": 0, "last_activity_date": 1488392745, "creation_date": 1488390122, "last_edit_date": 1488392745, "question_id": 42538468, "link": "https://stackoverflow.com/questions/42538468/rails-why-time-datatype-start-at-1-1-2000", "title": "Rails: why time datatype start at 1/1/2000", "body": "<p>I have a column that I only want to store time (hour, minute, second). for example here is one migration:</p>\n\n<pre><code>add_column :products, :start_hour, :time\n</code></pre>\n\n<p>When I insert to database <code>start_hour</code> always start with <code>1/1/2000</code> for example: <code>2000-01-01 01:19:00 +0700</code>. Please explain for me why.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-5"], "comments": [{"owner": {"reputation": 16757, "user_id": 5654404, "user_type": "registered", "accept_rate": 23, "profile_image": "https://www.gravatar.com/avatar/746f3e19ba3d2c092e951129a114391a?s=128&d=identicon&r=PG&f=1", "display_name": "Sravan", "link": "https://stackoverflow.com/users/5654404/sravan"}, "edited": false, "score": 0, "creation_date": 1488447810, "post_id": 42538050, "comment_id": 72238684, "body": "<code>@user.create_profile</code> this line should be removed, <code>@user.build_profile</code> is enough"}], "answers": [{"comments": [{"owner": {"reputation": 508, "user_id": 4415920, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/crheD.jpg?s=128&g=1", "display_name": "The Gugaru", "link": "https://stackoverflow.com/users/4415920/the-gugaru"}, "edited": false, "score": 0, "creation_date": 1488403585, "post_id": 42538194, "comment_id": 72220511, "body": "Nope still not saving the data."}, {"owner": {"reputation": 508, "user_id": 4415920, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/crheD.jpg?s=128&g=1", "display_name": "The Gugaru", "link": "https://stackoverflow.com/users/4415920/the-gugaru"}, "edited": false, "score": 0, "creation_date": 1488406865, "post_id": 42538194, "comment_id": 72222223, "body": "When i change :profiles to :profile I end up with nothing displaying for the nested attributes. Adding email to the profile_atrributes: did not effect it either way."}, {"owner": {"reputation": 1269, "user_id": 5531936, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/zpdEy.jpg?s=128&g=1", "display_name": "Ren", "link": "https://stackoverflow.com/users/5531936/ren"}, "reply_to_user": {"reputation": 508, "user_id": 4415920, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/crheD.jpg?s=128&g=1", "display_name": "The Gugaru", "link": "https://stackoverflow.com/users/4415920/the-gugaru"}, "edited": false, "score": 0, "creation_date": 1488407355, "post_id": 42538194, "comment_id": 72222482, "body": "hm, maybe it&#39;s because you are not using the <code>@user</code> instance variable in your form_for helper:  <code>form_for(@user)</code>.  it&#39;s only a partial so i can&#39;t see the whole picture.  i could be mistaken"}, {"owner": {"reputation": 508, "user_id": 4415920, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/crheD.jpg?s=128&g=1", "display_name": "The Gugaru", "link": "https://stackoverflow.com/users/4415920/the-gugaru"}, "edited": false, "score": 0, "creation_date": 1488407582, "post_id": 42538194, "comment_id": 72222582, "body": "added the new view to my post"}, {"owner": {"reputation": 1269, "user_id": 5531936, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/zpdEy.jpg?s=128&g=1", "display_name": "Ren", "link": "https://stackoverflow.com/users/5531936/ren"}, "reply_to_user": {"reputation": 508, "user_id": 4415920, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/crheD.jpg?s=128&g=1", "display_name": "The Gugaru", "link": "https://stackoverflow.com/users/4415920/the-gugaru"}, "edited": false, "score": 1, "creation_date": 1488410065, "post_id": 42538194, "comment_id": 72223633, "body": "<code>@user.profile.build</code> should be <code>@user.build_profile</code> in your new action of the controller.  it&#39;s different syntax than <code>has_many</code>.  if that fixes it i&#39;ll update my answer"}, {"owner": {"reputation": 508, "user_id": 4415920, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/crheD.jpg?s=128&g=1", "display_name": "The Gugaru", "link": "https://stackoverflow.com/users/4415920/the-gugaru"}, "edited": false, "score": 0, "creation_date": 1488411195, "post_id": 42538194, "comment_id": 72224035, "body": "Nope same result. I had it that way once before from another post, just changed it and still did not work. This is super confusing LOL"}, {"owner": {"reputation": 1269, "user_id": 5531936, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/zpdEy.jpg?s=128&g=1", "display_name": "Ren", "link": "https://stackoverflow.com/users/5531936/ren"}, "reply_to_user": {"reputation": 508, "user_id": 4415920, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/crheD.jpg?s=128&g=1", "display_name": "The Gugaru", "link": "https://stackoverflow.com/users/4415920/the-gugaru"}, "edited": false, "score": 0, "creation_date": 1488412806, "post_id": 42538194, "comment_id": 72224565, "body": "agreed :)  Nested forms can be tricky.  I would check your server log to see what the parameters look like when you submit the form."}, {"owner": {"reputation": 508, "user_id": 4415920, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/crheD.jpg?s=128&g=1", "display_name": "The Gugaru", "link": "https://stackoverflow.com/users/4415920/the-gugaru"}, "edited": false, "score": 0, "creation_date": 1488426953, "post_id": 42538194, "comment_id": 72228564, "body": "Will do and will report my findings in a couple hours!"}, {"owner": {"reputation": 508, "user_id": 4415920, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/crheD.jpg?s=128&g=1", "display_name": "The Gugaru", "link": "https://stackoverflow.com/users/4415920/the-gugaru"}, "edited": false, "score": 0, "creation_date": 1488437378, "post_id": 42538194, "comment_id": 72232419, "body": "Added additional information to the bottom to show log and params debug. I also formatted the output for readability!"}, {"owner": {"reputation": 1269, "user_id": 5531936, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/zpdEy.jpg?s=128&g=1", "display_name": "Ren", "link": "https://stackoverflow.com/users/5531936/ren"}, "reply_to_user": {"reputation": 508, "user_id": 4415920, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/crheD.jpg?s=128&g=1", "display_name": "The Gugaru", "link": "https://stackoverflow.com/users/4415920/the-gugaru"}, "edited": false, "score": 0, "creation_date": 1488468653, "post_id": 42538194, "comment_id": 72253252, "body": "are you testing this in your edit view?  because you will need <code>@user.build_profile</code> there as well in your edit action.  That&#39;s why your form was not showing up.  Also, again, you need <code>f.fields_for :profile</code>, not :profiles."}, {"owner": {"reputation": 508, "user_id": 4415920, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/crheD.jpg?s=128&g=1", "display_name": "The Gugaru", "link": "https://stackoverflow.com/users/4415920/the-gugaru"}, "edited": false, "score": 0, "creation_date": 1488503459, "post_id": 42538194, "comment_id": 72271779, "body": "This is the answer that actually got it working. However the update screen was still working despite not having the <b>@user.build_profile</b> in the edit method like @Sraven suggested. I did however add it just in case. I now have the same issue with a one to many relationship that I am trying to solve and if I cannot I will create another post for it. Thanks!"}], "tags": [], "owner": {"reputation": 1269, "user_id": 5531936, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/zpdEy.jpg?s=128&g=1", "display_name": "Ren", "link": "https://stackoverflow.com/users/5531936/ren"}, "is_accepted": true, "score": 2, "last_activity_date": 1488468901, "last_edit_date": 1488468901, "creation_date": 1488389184, "answer_id": 42538194, "question_id": 42538050, "link": "https://stackoverflow.com/questions/42538050/rails-5-nested-form-attributes-not-saving/42538194#42538194", "title": "Rails 5 Nested Form Attributes not Saving", "body": "<p><code>:profile</code> is the name of your nested model, so in your user_params try <code>profile_attributes</code> instead:</p>\n\n<pre><code>def user_params\n  params.require(:user).permit(:username, :password, :user_type_id, profile_attributes: [:id, :first_name, :middle_name, :last_name, :email, :phone_number, :cell_number])\nend\n</code></pre>\n\n<p>Also it looks like you forgot <code>:email</code> in your nested profile params </p>\n\n<p>This line in your form:</p>\n\n<pre><code>&lt;%= f.fields_for :profiles do |client_profile| %&gt;\n</code></pre>\n\n<p>it should be:</p>\n\n<pre><code>&lt;%= f.fields_for :profile do |client_profile| %&gt;\n</code></pre>\n\n<p><code>User</code> <code>has_one</code> <code>profile</code>, so profile should be singular in your nested form.</p>\n\n<p>UPDATE:</p>\n\n<p>Both new and edit actions need to have an empty profile built in them in order for the nested form to appear:</p>\n\n<pre><code>def new\n  @user = User.new\n  @user.build_profile\nend\n\n# GET /users/1/edit\ndef edit\n  @user.build_profile\nend\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 16757, "user_id": 5654404, "user_type": "registered", "accept_rate": 23, "profile_image": "https://www.gravatar.com/avatar/746f3e19ba3d2c092e951129a114391a?s=128&d=identicon&r=PG&f=1", "display_name": "Sravan", "link": "https://stackoverflow.com/users/5654404/sravan"}, "edited": false, "score": 0, "creation_date": 1488461315, "post_id": 42551978, "comment_id": 72247743, "body": "@BetaZed Software Solutions, checked my answer?"}, {"owner": {"reputation": 508, "user_id": 4415920, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/crheD.jpg?s=128&g=1", "display_name": "The Gugaru", "link": "https://stackoverflow.com/users/4415920/the-gugaru"}, "edited": false, "score": 0, "creation_date": 1488503549, "post_id": 42551978, "comment_id": 72271811, "body": "This added some extra&#39;s however the addition to the edit method in the controller did not make a difference. It worked regardless whether <b>@user.build_profile</b> was in the edit method or not. I added it to be safe however it did not appear to effect things."}], "tags": [], "owner": {"reputation": 16757, "user_id": 5654404, "user_type": "registered", "accept_rate": 23, "profile_image": "https://www.gravatar.com/avatar/746f3e19ba3d2c092e951129a114391a?s=128&d=identicon&r=PG&f=1", "display_name": "Sravan", "link": "https://stackoverflow.com/users/5654404/sravan"}, "is_accepted": false, "score": 1, "last_activity_date": 1488448248, "creation_date": 1488448248, "answer_id": 42551978, "question_id": 42538050, "link": "https://stackoverflow.com/questions/42538050/rails-5-nested-form-attributes-not-saving/42551978#42551978", "title": "Rails 5 Nested Form Attributes not Saving", "body": "<p>You have few changes to make, some are already given in @Ren's answer,</p>\n\n<p><strong>1)</strong>  New action, <code>@user.create_profile</code> not needed.</p>\n\n<pre><code>def new\n    @user = User.new\n    @user.build_profile\nend\n</code></pre>\n\n<p><strong>2)</strong>  <code>&lt;%= form_for(user) do |f| %&gt;</code> should be, <strong><code>&lt;%= form_for @user do |f| %&gt;</code></strong></p>\n\n<p><strong>3)</strong>  <code>&lt;%= f.fields_for :profiles do |client_profile| %&gt;</code> should be, <strong><code>&lt;%= f.fields_for :profile do |client_profile| %&gt;</code></strong></p>\n\n<pre><code>&lt;%= form_for @user do |f| %&gt;\n    &lt;% if user.errors.any? %&gt;\n      &lt;div id=\"error_explanation\"&gt;\n            &lt;h2&gt;&lt;%= pluralize(user.errors.count, \"error\") %&gt; prohibited this user from being saved:&lt;/h2&gt;\n            &lt;ul&gt;\n                    &lt;% user.errors.full_messages.each do |message| %&gt;\n                    &lt;li&gt;&lt;%= message %&gt;&lt;/li&gt;\n                    &lt;% end %&gt;\n            &lt;/ul&gt;\n       &lt;/div&gt;\n    &lt;% end %&gt;\n\n    &lt;div class=\"field\"&gt;\n    &lt;%= f.label :username %&gt;\n    &lt;%= f.text_field :username %&gt;\n    &lt;/div&gt;\n\n    &lt;div class=\"field\"&gt;\n    &lt;%= f.label :password %&gt;\n    &lt;%= f.text_field :password %&gt;\n    &lt;/div&gt;\n\n    &lt;div class=\"field\"&gt;\n    &lt;% if params[:trainer] == \"true\" %&gt;\n    &lt;%= f.label :user_type_id %&gt;\n    &lt;%= f.text_field :user_type_id %&gt;\n    &lt;% else %&gt;\n    Nota trainer\n    &lt;% end %&gt;\n    &lt;/div&gt;\n    &lt;h2&gt;Account Profile&lt;/h2&gt;\n    &lt;%= f.fields_for :profile do |client_profile| %&gt;\n        &lt;%#= client_profile.inspect %&gt;\n        &lt;div&gt;\n            &lt;%= client_profile.label :first_name %&gt;\n            &lt;%= client_profile.text_field :first_name %&gt;\n        &lt;/div&gt;\n        &lt;div&gt;\n            &lt;%= client_profile.label :middle_name %&gt;\n            &lt;%= client_profile.text_field :middle_name %&gt;\n        &lt;/div&gt;\n        &lt;div&gt;\n            &lt;%= client_profile.label :last_name %&gt;\n            &lt;%= client_profile.text_field :last_names %&gt;\n        &lt;/div&gt;\n        &lt;div&gt;\n            &lt;%= client_profile.label :email %&gt;\n            &lt;%= client_profile.text_field :email %&gt;\n        &lt;/div&gt;\n        &lt;div&gt;\n            &lt;%= client_profile.label :phone_number %&gt;\n            &lt;%= client_profile.text_field :phone_number %&gt;\n        &lt;/div&gt;\n        &lt;div&gt;\n            &lt;%= client_profile.label :cell_phone %&gt;\n            &lt;%= client_profile.text_field :phone_number %&gt;\n        &lt;/div&gt;\n    &lt;% end %&gt;\n    &lt;div class=\"actions\"&gt;\n    &lt;%= f.submit %&gt;\n    &lt;/div&gt;\n&lt;% end %&gt;\n</code></pre>\n"}], "owner": {"reputation": 508, "user_id": 4415920, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/crheD.jpg?s=128&g=1", "display_name": "The Gugaru", "link": "https://stackoverflow.com/users/4415920/the-gugaru"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 607, "favorite_count": 1, "accepted_answer_id": 42538194, "answer_count": 2, "score": 0, "last_activity_date": 1488468901, "creation_date": 1488388727, "last_edit_date": 1488446952, "question_id": 42538050, "link": "https://stackoverflow.com/questions/42538050/rails-5-nested-form-attributes-not-saving", "title": "Rails 5 Nested Form Attributes not Saving", "body": "<p>Ok guys I have a User table that is related to a profile table, I believe I have done everything that I am suppose to do to get the nested form attributes to save however they do not save to the database. I have read the other posts and none seem to fit or the solutions do not work. To be clear I am using Rails 5 with MySQL on a Linux based system.\nI have included the relevant files below</p>\n\n<p><strong>Users Model</strong></p>\n\n<pre><code>class User &lt; ApplicationRecord\n  has_one :profile, inverse_of: :user\n  accepts_nested_attributes_for :profile, allow_destroy: true\nend\n</code></pre>\n\n<p><strong>Profiles Model</strong></p>\n\n<pre><code>   class UsersController &lt; ApplicationController\n  before_action :set_user, only: [:show, :edit, :update, :destroy]\n\n  # GET /users\n  # GET /users.json\n  def index\n    @users = User.all\n  end\n\n  # GET /users/1\n  # GET /users/1.json\n  def show\n  end\n\n  # GET /users/new\n  def new\n    @user = User.new\n    @user.create_profile\n    @user.build_profile\n  end\n\n  # GET /users/1/edit\n  def edit\n\n  end\n\n  # POST /users\n  # POST /users.json\n  def create\n    @user = User.new(user_params)\n\n    respond_to do |format|\n      if @user.save\n        format.html { redirect_to @user, notice: 'User was successfully created.' }\n        format.json { render :show, status: :created, location: @user }\n      else\n        format.html { render :new }\n        format.json { render json: @user.errors, status: :unprocessable_entity }\n      end\n    end\n  end\n\n  # PATCH/PUT /users/1\n  # PATCH/PUT /users/1.json\n  def update\n    respond_to do |format|\n      if @user.update(user_params)\n        format.html { redirect_to @user, notice: 'User was successfully updated.' }\n        format.json { render :show, status: :ok, location: @user }\n      else\n        format.html { render :edit }\n        format.json { render json: @user.errors, status: :unprocessable_entity }\n      end\n    end\n  end\n\n  # DELETE /users/1\n  # DELETE /users/1.json\n  def destroy\n    @user.destroy\n    respond_to do |format|\n      format.html { redirect_to users_url, notice: 'User was successfully destroyed.' }\n      format.json { head :no_content }\n    end\n  end\n\n  private\n    # Use callbacks to share common setup or constraints between actions.\n    def set_user\n      @user = User.find(params[:id])\n    end\n\n    # Never trust parameters from the scary internet, only allow the white list through.\n    def user_params\n      params.require(:user).permit(:username, :password, :user_type_id, profile_attributes: [:id, :user_id, :first_name, :middle_name, :last_name, :phone_number, :cell_number, :email])\n    end\nend\n</code></pre>\n\n<p><strong>Users Form Partial</strong></p>\n\n<pre><code>&lt;%= form_for(user) do |f| %&gt;\n      &lt;% if user.errors.any? %&gt;\n        &lt;div id=\"error_explanation\"&gt;\n          &lt;h2&gt;&lt;%= pluralize(user.errors.count, \"error\") %&gt; prohibited this user from being saved:&lt;/h2&gt;\n\n          &lt;ul&gt;\n          &lt;% user.errors.full_messages.each do |message| %&gt;\n            &lt;li&gt;&lt;%= message %&gt;&lt;/li&gt;\n          &lt;% end %&gt;\n          &lt;/ul&gt;\n        &lt;/div&gt;\n      &lt;% end %&gt;\n\n      &lt;div class=\"field\"&gt;\n        &lt;%= f.label :username %&gt;\n        &lt;%= f.text_field :username %&gt;\n      &lt;/div&gt;\n\n      &lt;div class=\"field\"&gt;\n        &lt;%= f.label :password %&gt;\n        &lt;%= f.text_field :password %&gt;\n      &lt;/div&gt;\n\n      &lt;div class=\"field\"&gt;\n        &lt;% if params[:trainer] == \"true\" %&gt;\n        &lt;%= f.label :user_type_id %&gt;\n        &lt;%= f.text_field :user_type_id %&gt;\n        &lt;% else %&gt;\n        Nota trainer\n        &lt;% end %&gt;\n      &lt;/div&gt;\n        &lt;h2&gt;Account Profile&lt;/h2&gt;\n        &lt;%= f.fields_for :profiles do |client_profile| %&gt;\n          &lt;%#= client_profile.inspect %&gt;\n            &lt;div&gt;\n              &lt;%= client_profile.label :first_name %&gt;\n              &lt;%= client_profile.text_field :first_name %&gt;\n            &lt;/div&gt;\n            &lt;div&gt;\n              &lt;%= client_profile.label :middle_name %&gt;\n              &lt;%= client_profile.text_field :middle_name %&gt;\n            &lt;/div&gt;\n            &lt;div&gt;\n              &lt;%= client_profile.label :last_name %&gt;\n              &lt;%= client_profile.text_field :last_names %&gt;\n            &lt;/div&gt;\n            &lt;div&gt;\n              &lt;%= client_profile.label :email %&gt;\n              &lt;%= client_profile.text_field :email %&gt;\n            &lt;/div&gt;\n            &lt;div&gt;\n              &lt;%= client_profile.label :phone_number %&gt;\n              &lt;%= client_profile.text_field :phone_number %&gt;\n            &lt;/div&gt;\n            &lt;div&gt;\n              &lt;%= client_profile.label :cell_phone %&gt;\n              &lt;%= client_profile.text_field :phone_number %&gt;\n            &lt;/div&gt;\n        &lt;% end %&gt;\n      &lt;div class=\"actions\"&gt;\n        &lt;%= f.submit %&gt;\n      &lt;/div&gt;\n    &lt;% end %&gt;\n</code></pre>\n\n<p><strong>New View</strong></p>\n\n<pre><code>New User\n\n    &lt;%= render 'form', user: @user %&gt;\n\n    &lt;%= link_to 'Back', users_path %&gt;\n</code></pre>\n\n<p><strong>Params Debug Output</strong></p>\n\n<pre><code>{\n\"utf8\"=&gt;\"\u2713\",\n\"_method\"=&gt;\"patch\", \n\"authenticity_token\"=&gt;\"oZwa3K5QJRKlWGf176/fOOmrANd07KUyXUJa8Ig9CtEq+OilF73R9CzWVXwE2+K/crSFfm5p3yaeW+u2KSEF7w==\",\n \"user\"=&gt;{\n           \"username\"=&gt;\"vitago\", \n           \"password\"=&gt;\"[FILTERED]\", \n           \"profiles\"=&gt;{\n                         \"first_name\"=&gt;\"John\", \n                         \"middle_name\"=&gt;\"B\", \n                         \"last_names\"=&gt;\"Doe\",            \n                         \"email\"=&gt;\"johnbdoe@gmail.com\", \n                         \"phone_number\"=&gt;\"1002223333\"\n                        }\n          },\n \"commit\"=&gt;\"Update User\",\n \"id\"=&gt;\"1\"}\n</code></pre>\n\n<p><strong>Log Output in development.log</strong></p>\n\n<pre><code>   Started PATCH \"/users/1\" for 192.168.0.31 at 2017-03-02 01:28:22 -0500\n    Cannot render console from 192.168.0.31! Allowed networks: 127.0.0.1, ::1, 127.0.0.0/127.255.255.255\n    Processing by UsersController#update as HTML\n      Parameters: {\n        \"utf8\"=&gt;\"\u2713\",      \n     \"authenticity_token\"=&gt;\"GRKhJuTuytcwr4ycCBi0KiFNkmRCstPAnaP0Z8UucWZFp5JdfmosqOvIQ7WpgYUN8yHvEcmMcmYOPLX1iDUwAA==\", \n        \"user\"=&gt;{\n        \"username\"=&gt;\"vitago\", \n        \"password\"=&gt;\"[FILTERED]\", \n        \"profiles\"=&gt;{\n            \"first_name\"=&gt;\"John\", \n            \"middle_name\"=&gt;\"B\", \n            \"last_names\"=&gt;\"Doe\", \n            \"email\"=&gt;\"johnbdoe@gmail.com\", \n            \"phone_number\"=&gt;\"1002223333\"\n         }\n    }, \n    \"commit\"=&gt;\"Update User\", \n    \"id\"=&gt;\"1\"\n}\n      User Load (0.5ms)  SELECT  `users`.* FROM `users` WHERE `users`.`id` = 1 LIMIT 1\n    Unpermitted parameter: profiles\n       (0.1ms)  BEGIN\n       (0.1ms)  COMMIT\n    Redirected to http://192.168.0.51:3000/users/1\n    Completed 302 Found in 7ms (ActiveRecord: 0.7ms)\n\n\n    Started GET \"/users/1\" for 192.168.0.31 at 2017-03-02 01:28:22 -0500\n    Cannot render console from 192.168.0.31! Allowed networks: 127.0.0.1, ::1, 127.0.0.0/127.255.255.255\n    Processing by UsersController#show as HTML\n      Parameters: {\"id\"=&gt;\"1\"}\n      User Load (0.6ms)  SELECT  `users`.* FROM `users` WHERE `users`.`id` = 1 LIMIT 1\n      Rendering users/show.html.erb within layouts/application\n      Rendered users/show.html.erb within layouts/application (1.4ms)\n    Completed 200 OK in 43ms (Views: 29.8ms | ActiveRecord: 0.6ms)\n\n\n    Started GET \"/users/1/edit\" for 192.168.0.31 at 2017-03-02 01:28:24 -0500\n    Cannot render console from 192.168.0.31! Allowed networks: 127.0.0.1, ::1, 127.0.0.0/127.255.255.255\n    Processing by UsersController#edit as HTML\n      Parameters: {\"id\"=&gt;\"1\"}\n      User Load (0.5ms)  SELECT  `users`.* FROM `users` WHERE `users`.`id` = 1 LIMIT 1\n      Rendering users/edit.html.erb within layouts/application\n      Rendered users/_form.html.erb (7.1ms)\n      Rendered users/edit.html.erb within layouts/application (12.5ms)\n    Completed 200 OK in 43ms (Views: 35.6ms | ActiveRecord: 0.5ms)\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "activerecord"], "comments": [{"owner": {"reputation": 19, "user_id": 6337901, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/2f06d079e0497d43e91d74684236d3a4?s=128&d=identicon&r=PG&f=1", "display_name": "user6337901", "link": "https://stackoverflow.com/users/6337901/user6337901"}, "edited": false, "score": 0, "creation_date": 1488391168, "post_id": 42538041, "comment_id": 72213219, "body": "I need to add the contact&#39;s program to program, that&#39;s all"}, {"owner": {"reputation": 67463, "user_id": 203130, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/1RE8c.jpg?s=128&g=1", "display_name": "coreyward", "link": "https://stackoverflow.com/users/203130/coreyward"}, "edited": false, "score": 0, "creation_date": 1488470309, "post_id": 42538041, "comment_id": 72254428, "body": "<code>Program</code> does not <code>has_many :programs</code>. If you want to simply persist \u201ccontact\u2019s program\u201d, just call <code>.save</code> on it."}], "answers": [{"comments": [{"owner": {"reputation": 19, "user_id": 6337901, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/2f06d079e0497d43e91d74684236d3a4?s=128&d=identicon&r=PG&f=1", "display_name": "user6337901", "link": "https://stackoverflow.com/users/6337901/user6337901"}, "edited": false, "score": 0, "creation_date": 1488389461, "post_id": 42538163, "comment_id": 72212177, "body": "programs &lt;&lt; contact.program #&lt;NameError: undefined local variable or method `programs&#39; for #&lt;ContactsController:0x007fc0b4362de8&gt;"}, {"owner": {"reputation": 19, "user_id": 6337901, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/2f06d079e0497d43e91d74684236d3a4?s=128&d=identicon&r=PG&f=1", "display_name": "user6337901", "link": "https://stackoverflow.com/users/6337901/user6337901"}, "edited": false, "score": 0, "creation_date": 1488389491, "post_id": 42538163, "comment_id": 72212195, "body": "program &lt;&lt; contact.program"}, {"owner": {"reputation": 19, "user_id": 6337901, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/2f06d079e0497d43e91d74684236d3a4?s=128&d=identicon&r=PG&f=1", "display_name": "user6337901", "link": "https://stackoverflow.com/users/6337901/user6337901"}, "edited": false, "score": 0, "creation_date": 1488389500, "post_id": 42538163, "comment_id": 72212201, "body": "#&lt;NameError: undefined local variable or method `program&#39; for #&lt;ContactsController:0x007fc0b4362de8&gt;"}, {"owner": {"reputation": 19, "user_id": 6337901, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/2f06d079e0497d43e91d74684236d3a4?s=128&d=identicon&r=PG&f=1", "display_name": "user6337901", "link": "https://stackoverflow.com/users/6337901/user6337901"}, "edited": false, "score": 0, "creation_date": 1488391000, "post_id": 42538163, "comment_id": 72213125, "body": "SORRY, ACTUALLY THIS ISN&#39;T WORKING"}, {"owner": {"reputation": 67463, "user_id": 203130, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/1RE8c.jpg?s=128&g=1", "display_name": "coreyward", "link": "https://stackoverflow.com/users/203130/coreyward"}, "reply_to_user": {"reputation": 19, "user_id": 6337901, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/2f06d079e0497d43e91d74684236d3a4?s=128&d=identicon&r=PG&f=1", "display_name": "user6337901", "link": "https://stackoverflow.com/users/6337901/user6337901"}, "edited": false, "score": 0, "creation_date": 1488393266, "post_id": 42538163, "comment_id": 72214480, "body": "@user6337901 Read more closely? Your comments are at odds with what I wrote. Also, you have to actually know Ruby to write it. It isn&#39;t magic. Variables don&#39;t just suddenly appear, you have to define them."}], "tags": [], "owner": {"reputation": 67463, "user_id": 203130, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/1RE8c.jpg?s=128&g=1", "display_name": "coreyward", "link": "https://stackoverflow.com/users/203130/coreyward"}, "is_accepted": false, "score": 1, "last_activity_date": 1488389074, "creation_date": 1488389074, "answer_id": 42538163, "question_id": 42538041, "link": "https://stackoverflow.com/questions/42538041/activerecord-shovel-operator/42538163#42538163", "title": "activerecord shovel operator &lt;&lt;", "body": "<p>You're contradicting yourself here:</p>\n\n<p><code>Program has_many contacts</code> vs <code>Programs &lt;&lt; Contact.program</code></p>\n\n<p>If you're trying to add a <code>Contact</code> to a particular program, you would be looking at adding the contact:</p>\n\n<pre><code>program.contacts &lt;&lt; contact\n</code></pre>\n\n<p>And if you're trying to set the program for the contact:</p>\n\n<pre><code>contact.program = program\n</code></pre>\n\n<p>What does not make sense, however, is to try to add something to \u201cprograms\u201d, which isn't a relationship. Nothing in this system as you've defined it <code>has_many :programs</code>, so <code>@programs.&lt;&lt;</code> cannot possibly act on a relationship. </p>\n"}, {"tags": [], "owner": {"reputation": 1751, "user_id": 156166, "user_type": "registered", "accept_rate": 0, "profile_image": "https://graph.facebook.com/663120570/picture?type=large", "display_name": "Rich Seviora", "link": "https://stackoverflow.com/users/156166/rich-seviora"}, "is_accepted": false, "score": 1, "last_activity_date": 1488404254, "creation_date": 1488404254, "answer_id": 42542546, "question_id": 42538041, "link": "https://stackoverflow.com/questions/42538041/activerecord-shovel-operator/42542546#42542546", "title": "activerecord shovel operator &lt;&lt;", "body": "<p>You're receiving this error because the <code>ActiveRecord::Relation</code> class is only a collection of results returned by an <code>ActiveRecord</code> query. You probably got it by running <code>Program.where</code> or a similar query. It is not an <code>ActiveRecord::Association</code> and therefore you cannot add more records to it. </p>\n\n<p>You must instead use the association returned by the parent object.</p>\n\n<p>Here's an example of what you're doing, vs what you should be doing:</p>\n\n<pre><code>class User &lt; ApplicationRecord\n    has_many :programs\nend\n\nclass Program &lt; ApplicationRecord\n    belongs_to :user\nend\n\nnew_program = Program.new\n\n# What you're attempting.\nprograms_where = Program.where(user_id: User.first) # Class is Program::ActiveRecord_Relation\nprograms_where &lt;&lt; new_program # Throws Error b/c &lt;&lt; is not available on ActiveRecord::Relation objects.\n\n# What you should be attempting.\nuser = User.first\nprograms_assoc = user.programs # Returns Programs::ActiveRecord_Associations_CollectionProxy\nprograms_assoc &lt;&lt; new_program # Returns Correctly\n</code></pre>\n\n<p>Note: It's not clear how <code>@programs</code> is defined. Is this answer does not work for you then please provide the complete controller code, as well as the other model you're using.</p>\n"}], "owner": {"reputation": 19, "user_id": 6337901, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/2f06d079e0497d43e91d74684236d3a4?s=128&d=identicon&r=PG&f=1", "display_name": "user6337901", "link": "https://stackoverflow.com/users/6337901/user6337901"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 905, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1488404254, "creation_date": 1488388699, "last_edit_date": 1488403235, "question_id": 42538041, "link": "https://stackoverflow.com/questions/42538041/activerecord-shovel-operator", "title": "activerecord shovel operator &lt;&lt;", "body": "<p>From inside edit action in the contacts controller have ...</p>\n\n<pre><code>@programs &lt;&lt; @contact.program\n</code></pre>\n\n<p>Which produces the following error:  </p>\n\n<pre class=\"lang-none prettyprint-override\"><code>NoMethodError - undefined method `&lt;&lt;' for Program::ActiveRecord_Relation\n</code></pre>\n\n<p>Contacts Model:</p>\n\n<pre><code>belongs_to :program\n</code></pre>\n\n<p>Program Model:</p>\n\n<pre><code>has_many :contacts\nvalidates :name, presence: true, uniqueness: true\n\n@programs.class\nProgram::ActiveRecord_Relation\n\n@contact.program.class\nProgram(id: integer, name: string, active: boolean, created_at: datetime, updated_at: datetime)\n</code></pre>\n\n<p>Question: Why does this operation fail?  Why can't the record get added to the record collection.  What is preventing the collection(ActiveRecord_Relation) from adding the record?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "imagemagick", "rmagick"], "comments": [{"owner": {"reputation": 16229, "user_id": 525478, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/3b6c0b47a0c430a0b141baee7ea845be?s=128&d=identicon&r=PG", "display_name": "Brad Werth", "link": "https://stackoverflow.com/users/525478/brad-werth"}, "edited": false, "score": 0, "creation_date": 1488389529, "post_id": 42537540, "comment_id": 72212223, "body": "Not an exact answer, but at our shop we&#39;ve completely replaced Rmagick with <a href=\"https://github.com/minimagick/minimagick\" rel=\"nofollow noreferrer\">MiniMagick</a>, mostly because RMagick is such a pita to install. IDK if it will install any better in your current situation, but it may be an option."}], "answers": [{"tags": [], "owner": {"reputation": 1167, "user_id": 4817370, "user_type": "registered", "accept_rate": 92, "profile_image": "https://lh5.googleusercontent.com/-1bUMePVT9q8/AAAAAAAAAAI/AAAAAAAAAB4/OPw09oGfIwI/photo.jpg?sz=128", "display_name": "Matthieu Raynaud de Fitte", "link": "https://stackoverflow.com/users/4817370/matthieu-raynaud-de-fitte"}, "is_accepted": false, "score": 1, "last_activity_date": 1488389968, "creation_date": 1488389968, "answer_id": 42538424, "question_id": 42537540, "link": "https://stackoverflow.com/questions/42537540/rmagick-imagemagick-installation/42538424#42538424", "title": "RMagick/ImageMagick installation", "body": "<p>Each distribution manages the Ruby gems it's own way, ex :<br />\nDebian requires the installation of libmagickwand-dev for this gem</p>\n\n<p>What you whant to look for is see if the gem requires additionnal dependencies or not on Mac ( had similar problems with bundle on Debian )</p>\n"}, {"tags": [], "owner": {"reputation": 426, "user_id": 5054505, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bc0f1e0ffd8e4f58acf3413bafd94dde?s=128&d=identicon&r=PG&f=1", "display_name": "Patrick", "link": "https://stackoverflow.com/users/5054505/patrick"}, "is_accepted": true, "score": 1, "last_activity_date": 1488770178, "last_edit_date": 1495540018, "creation_date": 1488769028, "answer_id": 42616827, "question_id": 42537540, "link": "https://stackoverflow.com/questions/42537540/rmagick-imagemagick-installation/42616827#42616827", "title": "RMagick/ImageMagick installation", "body": "<p>Thanks to Brad and Matthieu for your suggestions! MiniMagick does seem like a good solution, and Matthieu is definitely right about there being different dependencies from system to system; in my case I ended up giving up on trying to use ImageMagick 7 with RMagick, but I did get it to work with ImageMagick 6. Here's what worked for me:</p>\n\n<pre><code>brew remove imagemagick\nPKG_CONFIG_PATH=/usr/local/opt/imagemagick@6/lib/pkgconfig\nbrew install imagemagick@6\ngem install rmagick\n</code></pre>\n\n<p>Many thanks to this SE post: <a href=\"https://stackoverflow.com/a/41788501/5054505\">https://stackoverflow.com/a/41788501/5054505</a>\nFor the record, I am on OSX Yosemite</p>\n\n<p>Also, see this RMagick issue: <a href=\"https://github.com/rmagick/rmagick/issues/256\" rel=\"nofollow noreferrer\">https://github.com/rmagick/rmagick/issues/256</a>.\nHopefully this will be fixed soon, but for now it seems like reverting to version 6 is the popular approach.</p>\n"}], "owner": {"reputation": 426, "user_id": 5054505, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bc0f1e0ffd8e4f58acf3413bafd94dde?s=128&d=identicon&r=PG&f=1", "display_name": "Patrick", "link": "https://stackoverflow.com/users/5054505/patrick"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 750, "favorite_count": 0, "accepted_answer_id": 42616827, "answer_count": 2, "score": 0, "last_activity_date": 1488770178, "creation_date": 1488387208, "last_edit_date": 1488387479, "question_id": 42537540, "link": "https://stackoverflow.com/questions/42537540/rmagick-imagemagick-installation", "title": "RMagick/ImageMagick installation", "body": "<p>I am trying to install the rmagick gem. When I run \"gem install rmagick\" it gives me the following error:</p>\n\n<pre><code>In file included from rmagick.c:13:\n./rmagick.h:1210:51: error: unknown type name 'MagickPixelPacket'\nextern void   Color_to_MagickPixelPacket(Image *, MagickPixelPacket *, VALUE);\n</code></pre>\n\n<p>followed by a few similar complaints about missing methods and incorrect parameters(I can post the rest if they seem helpful).</p>\n\n<p>To me, this seems like a version problem, which makes sense because I had ImageMagick 6 installed as well as version 7, so I uninstalled version 6 but the problem persists.</p>\n\n<p>I also had to symlink the following for rmagick to find the required .h files, in case that's significant:</p>\n\n<pre><code>ln -s /usr/local/include/ImageMagick-7/MagickCore /usr/local/include/magick  \nln -s /usr/local/include/ImageMagick-7/MagickWand /usr/local/include/wand \n</code></pre>\n\n<p>I'm on a Macbook, installing things with brew. My current ImageMagick version is 7, but I'm suspicious of some leftover version 6 things causing problems.</p>\n\n<p>Any thoughts? I'm happy to give more information if necessary, but I can't think of anything else at the moment.</p>\n"}, {"tags": ["mysql", "ruby-on-rails", "ruby", "database"], "comments": [{"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 0, "creation_date": 1488391112, "post_id": 42537493, "comment_id": 72213189, "body": "Read the documentation about having Sequel show you the SQL it will emit. Typically you can put <code>.sql</code> at the end of the query but there are other ways too. Then compare that output to what the DBM documentation says an <code>AND</code> query should look like."}, {"owner": {"reputation": 573, "user_id": 3847021, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/534ddaa5b7bef2307bb9bbb1cb3a5569?s=128&d=identicon&r=PG&f=1", "display_name": "mjpablo23", "link": "https://stackoverflow.com/users/3847021/mjpablo23"}, "reply_to_user": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 0, "creation_date": 1488392335, "post_id": 42537493, "comment_id": 72213932, "body": "thanks, I didn&#39;t know you could do that."}], "answers": [{"comments": [{"owner": {"reputation": 573, "user_id": 3847021, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/534ddaa5b7bef2307bb9bbb1cb3a5569?s=128&d=identicon&r=PG&f=1", "display_name": "mjpablo23", "link": "https://stackoverflow.com/users/3847021/mjpablo23"}, "edited": false, "score": 0, "creation_date": 1488392361, "post_id": 42538824, "comment_id": 72213950, "body": "thanks, that worked.  I had to use devices.delete instead of delete_all"}, {"owner": {"reputation": 1302, "user_id": 1368977, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c79672007d59af69a05f2b5f6929b53f?s=128&d=identicon&r=PG", "display_name": "Marc Rohloff", "link": "https://stackoverflow.com/users/1368977/marc-rohloff"}, "edited": false, "score": 0, "creation_date": 1488394402, "post_id": 42538824, "comment_id": 72215133, "body": "It is not even necessary to chain them. You can use a single where with the hash syntax: <code>devices = Device.where(user_id: params[:user_id], reg_token: params[:reg_token])</code>"}], "tags": [], "owner": {"reputation": 4600, "user_id": 5961578, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/df7cbfdd2a92a7926af3bbb8648318aa?s=128&d=identicon&r=PG", "display_name": "moveson", "link": "https://stackoverflow.com/users/5961578/moveson"}, "is_accepted": true, "score": 0, "last_activity_date": 1488391282, "creation_date": 1488391282, "answer_id": 42538824, "question_id": 42537493, "link": "https://stackoverflow.com/questions/42537493/how-to-delete-row-from-ruby-sequel-table-based-on-two-conditions/42538824#42538824", "title": "How to delete row from Ruby Sequel table based on two conditions", "body": "<p>I would just chain the <code>where</code> clauses:</p>\n\n<pre><code>devices = Device.where(user_id: params[:user_id]).where(reg_token: params[:reg_token])\ndevices.delete_all\n</code></pre>\n"}], "owner": {"reputation": 573, "user_id": 3847021, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/534ddaa5b7bef2307bb9bbb1cb3a5569?s=128&d=identicon&r=PG&f=1", "display_name": "mjpablo23", "link": "https://stackoverflow.com/users/3847021/mjpablo23"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 639, "favorite_count": 0, "accepted_answer_id": 42538824, "answer_count": 1, "score": 0, "last_activity_date": 1488391282, "creation_date": 1488387080, "last_edit_date": 1488391007, "question_id": 42537493, "link": "https://stackoverflow.com/questions/42537493/how-to-delete-row-from-ruby-sequel-table-based-on-two-conditions", "title": "How to delete row from Ruby Sequel table based on two conditions", "body": "<p>I have a table (Device) that I am using Ruby to access.  I want to delete a row if it fulfills these two conditions:  </p>\n\n<pre><code>{:user_id =&gt; params[:user_id]}\n</code></pre>\n\n<p>and </p>\n\n<pre><code>{:reg_token =&gt; params[:reg_token]}\n</code></pre>\n\n<p>However, I'm not sure if I know how to use <code>AND</code> correctly.  I am trying to follow this guide:  </p>\n\n<p><a href=\"http://sequel.jeremyevans.net/rdoc/files/doc/dataset_filtering_rdoc.html\" rel=\"nofollow noreferrer\">http://sequel.jeremyevans.net/rdoc/files/doc/dataset_filtering_rdoc.html</a></p>\n\n<pre><code>if Device.where{Sequel.&amp;({:user_id =&gt; params[:user_id]}, {:reg_token =&gt; params[:reg_token]})}.count &gt; 0\n    # device = Device.where((:user_id =&gt; params[:user_id]) &amp; (:reg_token =&gt; params[:reg_token])).delete\n    device = Device.where{Sequel.&amp;({:user_id =&gt; params[:user_id]}, {:reg_token =&gt; params[:reg_token]})}.delete\nend\n</code></pre>\n"}, {"tags": ["ruby", "string", "ends-with"], "comments": [{"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 0, "creation_date": 1571342894, "post_id": 42537226, "comment_id": 103219726, "body": "What is <code>string_tokens</code>? We can assume a string, but for clarity it needs to be defined. When asking for help, we need to see working code showing what you tried. That helps us see any errors you&#39;re making and lets us fix/respond with answers that directly apply to your use. Please see &quot;<a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a>&quot; and the linked pages and &quot;<a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">mcve</a>&quot;"}], "answers": [{"comments": [{"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1488386746, "post_id": 42537271, "comment_id": 72210421, "body": "<code>CONST = %w|, - &amp;|.freeze</code>?"}, {"owner": {"reputation": 3914, "user_id": 4057366, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/uZ3e5.jpg?s=128&g=1", "display_name": "Alex Holubenko", "link": "https://stackoverflow.com/users/4057366/alex-holubenko"}, "edited": false, "score": 0, "creation_date": 1488403219, "post_id": 42537271, "comment_id": 72220327, "body": "very nice, real, +1"}], "tags": [], "owner": {"reputation": 47232, "user_id": 1772830, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/Qtoqg.jpg?s=128&g=1", "display_name": "Andrey Deineko", "link": "https://stackoverflow.com/users/1772830/andrey-deineko"}, "is_accepted": true, "score": 4, "last_activity_date": 1488391272, "last_edit_date": 1488391272, "creation_date": 1488386474, "answer_id": 42537271, "question_id": 42537226, "link": "https://stackoverflow.com/questions/42537226/how-to-see-if-a-string-ends-with-one-of-multiple-characters/42537271#42537271", "title": "How to see if a string ends with one of multiple characters", "body": "<p>Yes.</p>\n\n<pre><code>CONST = %w(, - &amp;).freeze\nstring_tokens[-1].end_with?(*CONST)\n</code></pre>\n\n<p>Usage:</p>\n\n<pre><code>'test,'.end_with?(*CONST)\n#=&gt; true\n'test&amp;'.end_with?(*CONST)\n#=&gt; true\n'test-'.end_with?(*CONST)\n#=&gt; true\n</code></pre>\n\n<p>You use <code>*</code> (splat operator) to pass multiple args to the <a href=\"https://ruby-doc.org/core-2.4.0/String.html#method-i-end_with-3F\" rel=\"nofollow noreferrer\"><code>String#end_with?</code></a>, because it accepts multiple.</p>\n"}, {"tags": [], "owner": {"reputation": 48049, "user_id": 6419007, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/CwqtX.jpg?s=128&g=1", "display_name": "Eric Duminil", "link": "https://stackoverflow.com/users/6419007/eric-duminil"}, "is_accepted": false, "score": 0, "last_activity_date": 1488391894, "creation_date": 1488391894, "answer_id": 42538991, "question_id": 42537226, "link": "https://stackoverflow.com/questions/42537226/how-to-see-if-a-string-ends-with-one-of-multiple-characters/42538991#42538991", "title": "How to see if a string ends with one of multiple characters", "body": "<p>You could also use a regex :</p>\n\n<pre><code>chars = %w(, - &amp;)\nENDS_WITH_CHAR = Regexp.new(\"[\"+chars.map{|s| Regexp.escape(s)}.join+']\\z')\n\"abc-\" =~ ENDS_WITH_CHAR\n# or with Ruby 2.4\n\"abc-\".match? ENDS_WITH_CHAR\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "is_accepted": false, "score": 0, "last_activity_date": 1488439175, "last_edit_date": 1488439175, "creation_date": 1488438789, "answer_id": 42548989, "question_id": 42537226, "link": "https://stackoverflow.com/questions/42537226/how-to-see-if-a-string-ends-with-one-of-multiple-characters/42548989#42548989", "title": "How to see if a string ends with one of multiple characters", "body": "<pre><code>str = 'hello-'\n\n',-&amp;'.include? str[-1]\n  #=&gt; true\n\n',$&amp;'.include? str[-1]\n  #=&gt; false\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user7055375"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1202, "favorite_count": 0, "accepted_answer_id": 42537271, "answer_count": 3, "score": 1, "last_activity_date": 1571343047, "creation_date": 1488386352, "last_edit_date": 1571343047, "question_id": 42537226, "link": "https://stackoverflow.com/questions/42537226/how-to-see-if-a-string-ends-with-one-of-multiple-characters", "title": "How to see if a string ends with one of multiple characters", "body": "<p>I have this statement:</p>\n\n<pre><code>string_tokens[-1].ends_with?(\",\") || string_tokens[-1].ends_with?(\"-\") || string_tokens[-1].ends_with?(\"&amp;\")\n</code></pre>\n\n<p>I would like to put all the tokens (<code>\",\"</code>, <code>\"-\"</code>, <code>\"&amp;\"</code>) into a constant and simplify the above to ask, \"does the string end with any of these characters\", but I'm not sure how to do that. </p>\n"}, {"tags": ["html", "ruby"], "comments": [{"owner": {"reputation": 14010, "user_id": 3109182, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/a4b305f0077055b4fdcf715067775d5a?s=128&d=identicon&r=PG", "display_name": "Anthony", "link": "https://stackoverflow.com/users/3109182/anthony"}, "edited": false, "score": 1, "creation_date": 1488386311, "post_id": 42537130, "comment_id": 72210110, "body": "would that be easier than having 3 files?  <code>header.html</code>, <code>product.html</code>, <code>footer.html</code> where 1 &amp; 3 are static and the second is what you generate?  The final output being a concatenation of those 3?"}, {"owner": {"reputation": 3, "user_id": 5549497, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-zKaXto6uZJk/AAAAAAAAAAI/AAAAAAAAAEE/KLm6FZj_9lQ/photo.jpg?sz=128", "display_name": "Pataty D", "link": "https://stackoverflow.com/users/5549497/pataty-d"}, "reply_to_user": {"reputation": 14010, "user_id": 3109182, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/a4b305f0077055b4fdcf715067775d5a?s=128&d=identicon&r=PG", "display_name": "Anthony", "link": "https://stackoverflow.com/users/3109182/anthony"}, "edited": false, "score": 0, "creation_date": 1488386669, "post_id": 42537130, "comment_id": 72210357, "body": "@Anthony Yes that would work actually. But how would you select everything in the main file Item_page.html to replace it with the concatenated 3 files?(I&#39;m a very young programmer with little knowledge, please forgive me if I ask a dumb question)"}, {"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 0, "creation_date": 1488391814, "post_id": 42537130, "comment_id": 72213607, "body": "This sounds like an <a href=\"http://meta.stackexchange.com/questions/66377/what-is-the-xy-problem\">XY Problem</a>. Your solution isn&#39;t very workable. Instead, it sounds like you need to step back and rethink the problem. Modifying existing HTML this way is error prone. A templating engine like HAML or ERB would make it easier, allowing you to programmatically insert content into the page as it&#39;s being generated."}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 5549497, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-zKaXto6uZJk/AAAAAAAAAAI/AAAAAAAAAEE/KLm6FZj_9lQ/photo.jpg?sz=128", "display_name": "Pataty D", "link": "https://stackoverflow.com/users/5549497/pataty-d"}, "edited": false, "score": 0, "creation_date": 1488470673, "post_id": 42537908, "comment_id": 72254679, "body": "This would work but what is the #####anchor##### that you use in 2? Does that select everything in the file?"}, {"owner": {"reputation": 1167, "user_id": 4817370, "user_type": "registered", "accept_rate": 92, "profile_image": "https://lh5.googleusercontent.com/-1bUMePVT9q8/AAAAAAAAAAI/AAAAAAAAAB4/OPw09oGfIwI/photo.jpg?sz=128", "display_name": "Matthieu Raynaud de Fitte", "link": "https://stackoverflow.com/users/4817370/matthieu-raynaud-de-fitte"}, "reply_to_user": {"reputation": 3, "user_id": 5549497, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-zKaXto6uZJk/AAAAAAAAAAI/AAAAAAAAAEE/KLm6FZj_9lQ/photo.jpg?sz=128", "display_name": "Pataty D", "link": "https://stackoverflow.com/users/5549497/pataty-d"}, "edited": false, "score": 0, "creation_date": 1488492475, "post_id": 42537908, "comment_id": 72267766, "body": "no, this is just a special combination of characters that you add and you know is unique ( you do not want gsub to replace multiple times or replace the wrong one ). it allows you to place the code you whant in the right place I use this method here : <a href=\"https://github.com/Hellfire01/MangaScrap/blob/master/templates/chapter_index_template.html\" rel=\"nofollow noreferrer\">link</a>"}], "tags": [], "owner": {"reputation": 1167, "user_id": 4817370, "user_type": "registered", "accept_rate": 92, "profile_image": "https://lh5.googleusercontent.com/-1bUMePVT9q8/AAAAAAAAAAI/AAAAAAAAAB4/OPw09oGfIwI/photo.jpg?sz=128", "display_name": "Matthieu Raynaud de Fitte", "link": "https://stackoverflow.com/users/4817370/matthieu-raynaud-de-fitte"}, "is_accepted": true, "score": 1, "last_activity_date": 1488391579, "last_edit_date": 1488391579, "creation_date": 1488388295, "answer_id": 42537908, "question_id": 42537130, "link": "https://stackoverflow.com/questions/42537130/how-to-append-to-a-specific-place-in-a-file-in-ruby/42537908#42537908", "title": "How to append to a specific place in a file in Ruby?", "body": "<p>If you can edit the HTML file, I see two possible answers:</p>\n\n<p>(Please note that in all cases I use a function called <code>add_all_elements</code> which is a function that just returns whatever you want placed in your file.)</p>\n\n<ol>\n<li><p>Cut your file in two, read the first half, add your elements and then read the second half. It should be something like this:</p>\n\n<pre><code>buffer = File.read(\"template_first_half.html\")\nbuffer += add_all_elements()\nbuffer += File.read(\"template_second_half.html\")\n</code></pre>\n\n<p>It is easy to use, but the HTML can be difficult to read.</p></li>\n<li><p>You can also add a reference in the file and use gsub to replace it:</p>\n\n<pre><code>buffer = File.read(\"template.html\")\nbuffer = buffer.gsub(\"#####anchor#####\", add_all_elements())\n</code></pre>\n\n<p>Also easier to use, it will require that you place a unique sub-string within the file.  The problem is that the reference must absolutely be unique within the file.  The advantage is that the HTML file remains easy to read.</p></li>\n</ol>\n\n<p>If you cannot edit the HTML file:</p>\n\n<pre><code>line_num = 0\nbuffer = ''\nbreak_point = 42\ntext.each_line do |line|\n  if line_num == break_point\n    buffer += add_all_elements()\n  end\n  buffer += line\n  line_num += 1\nend\n</code></pre>\n\n<p>Basically, you read the file line-by-line and place it into a buffer. When the line count reaches the required value (here, the variable <code>break_point</code> that I set at 42) you insert into the buffer all of the elements.</p>\n\n<p>The inconvenient is that if the file is edited, the breaking point must be re-set each time. You could also use a string as a break point to avoid most of that problem.</p>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 7644829, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c7c7bde2a2cee5663fb4e7790bfcd18?s=128&d=identicon&r=PG&f=1", "display_name": "Tony Francisco", "link": "https://stackoverflow.com/users/7644829/tony-francisco"}, "is_accepted": false, "score": 0, "last_activity_date": 1488464414, "creation_date": 1488464414, "answer_id": 42557902, "question_id": 42537130, "link": "https://stackoverflow.com/questions/42537130/how-to-append-to-a-specific-place-in-a-file-in-ruby/42557902#42557902", "title": "How to append to a specific place in a file in Ruby?", "body": "<p>You could do something like this:</p>\n\n<pre><code>file_to_update = File.read(\"item_page.html\")\nfile_to_update = file_to_update.sub(/(?&lt;=&lt;h2 class=\"title mt80\"&gt;Store&lt;\\/h2&gt;)/,file_text)\nFile.write(\"item_page.html\",file_to_update)\n</code></pre>\n\n<p>With this there's no need to create a new file for file_text.\nBasically whats happening is the second line here uses a lookbehind assertion to insert file_text into file_to_update after \"Store&lt;/h2>\". Then you just overwrite the contents of item_page.html with the updated string.</p>\n"}], "owner": {"reputation": 3, "user_id": 5549497, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-zKaXto6uZJk/AAAAAAAAAAI/AAAAAAAAAEE/KLm6FZj_9lQ/photo.jpg?sz=128", "display_name": "Pataty D", "link": "https://stackoverflow.com/users/5549497/pataty-d"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 103, "favorite_count": 0, "accepted_answer_id": 42537908, "answer_count": 2, "score": 0, "last_activity_date": 1488464414, "creation_date": 1488386081, "last_edit_date": 1488391693, "question_id": 42537130, "link": "https://stackoverflow.com/questions/42537130/how-to-append-to-a-specific-place-in-a-file-in-ruby", "title": "How to append to a specific place in a file in Ruby?", "body": "<p>I am trying to create a webpage to be able to sell things online, and have come up with an issue while creating a file to automatically create a new item. I am trying to use Ruby to temporarily take off the end of the file, append the correct line to the file, and put the end back. My code so far is</p>\n\n<pre><code>puts \"what is the item number?\"\nitem_num = gets.chomp\nputs \"what is item description?(not optional)\"\ndesc = gets.chomp\n\nfile_text = File.read(\"template.html\")\n\nfile_text = file_text.gsub(/Item#/, \"Item #{item_num.to_s}\")\nfile_text = file_text.gsub(/&lt;img class=\"item-image\" src=\"\"&gt;/, '&lt;img class=\"item-image\" src=\"' + item_num.to_s + '\"&gt;')\nfile_text = file_text.gsub(/Item-desc/, desc)\nputs file_text\n\nfile_create = File.new(item_num.to_s + \".html\", \"w\")\nfile_create.puts(file_text)\nfile_create.close\n\nitem_page_end = '\n\n                    &lt;/div&gt;\n                    &lt;div class=\"col-sm-12\"&gt;\n                        &lt;div class=\"headings\"&gt;\n                        &lt;/div&gt;\n                    &lt;/div&gt;\n                &lt;/div&gt;\n            &lt;/div&gt;\n        &lt;/div&gt;\n\n        &lt;div class=\"footer\" style=\"width=80%\"/&gt;\n        &lt;script src=\"../js/jquery-3.1.1.js\"&gt;&lt;/script&gt;\n        &lt;script src=\"../js/bootstrap.min.js\"&gt;&lt;/script&gt;\n        &lt;script src=\"../js/owl.carousel.min.js\"&gt;&lt;/script&gt;\n        &lt;script src=\"https://use.fontawesome.com/55b73bf748.js\"&gt;&lt;/script&gt;\n        &lt;script src=\"../js/jquery.magnific-popup.js\"&gt;&lt;/script&gt;\n        &lt;script src=\"../js/script.js\"&gt;&lt;/script&gt;\n    &lt;/body&gt;\n&lt;/html&gt;\n'\n\nfile_to_update = File.read(\"item_page.html\")\nfile_to_update = file_to_update.gsub(item_page_end, \"\")\nfile_to_update = File.open(\"item_page.html\", \"a+\")\nfile_to_update.puts( '&lt;p class=\"col-md-4\"&gt;&lt;img src=\"../images/' + item_num + '.jpg\" /&gt;Item' + item_num + '&lt;/p&gt;')\nfile_to_update.puts(item_page_end)\nsleep 10\n</code></pre>\n\n<p>The HTML file is:</p>\n\n<pre><code>&lt;!DOCTYPE html&gt;\n&lt;html lang=\"en\"&gt;\n    &lt;head&gt;\n        &lt;meta charset=\"utf-8\"&gt;\n        &lt;meta http-equiv=\"X-UA-Compatible\" content=\"IE=edge\"&gt;\n        &lt;meta name=\"viewport\" content=\"width=device-width, initial-scale=1\"&gt;\n\n        &lt;title&gt;SHS Metal | Store&lt;/title&gt;\n        &lt;link rel=\"shortcut icon\" type=\"image/x-icon\" href=\"../images/logo-icon.png\"/&gt;\n\n        &lt;link href=\"../css/bootstrap.min.css\" rel=\"stylesheet\"&gt;\n        &lt;link href=\"../css/bootstrap-theme.min.css\" rel=\"stylesheet\"&gt;\n\n        &lt;link href=\"../css/owl.carousel.css\" rel=\"stylesheet\"&gt;\n        &lt;link href=\"../css/owl.theme.default.min.css\" rel=\"stylesheet\"&gt;\n\n        &lt;link href=\"../css/magnific-popup.css\" rel=\"stylesheet\"&gt;\n\n        &lt;link href=\"../css/style.css\" rel=\"stylesheet\"&gt;\n\n\n        &lt;!--[if lt IE 9]&gt;\n        &lt;script src=\"https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js\"&gt;&lt;/script&gt;\n        &lt;script src=\"https://oss.maxcdn.com/respond/1.4.2/respond.min.js\"&gt;&lt;/script&gt;\n        &lt;![endif]--&gt;\n    &lt;/head&gt;\n    &lt;body&gt;\n        &lt;div class=\"main element\"&gt;\n            &lt;div class=\"container\"&gt;\n                &lt;div class=\"row\"&gt;\n                    &lt;div class=\"col-sm-12\"&gt;\n                        &lt;h2 class=\"title mt80\"&gt;Store&lt;/h2&gt;\n                    &lt;/div&gt;\n                    &lt;div class=\"col-sm-12\"&gt;\n                        &lt;div class=\"headings\"&gt;\n                        &lt;/div&gt;\n                    &lt;/div&gt;\n                &lt;/div&gt;\n            &lt;/div&gt;\n        &lt;/div&gt;\n\n        &lt;div class=\"footer\" style=\"width=80%\"/&gt;\n        &lt;script src=\"../js/jquery-3.1.1.js\"&gt;&lt;/script&gt;\n        &lt;script src=\"../js/bootstrap.min.js\"&gt;&lt;/script&gt;\n        &lt;script src=\"../js/owl.carousel.min.js\"&gt;&lt;/script&gt;\n        &lt;script src=\"https://use.fontawesome.com/55b73bf748.js\"&gt;&lt;/script&gt;\n        &lt;script src=\"../js/jquery.magnific-popup.js\"&gt;&lt;/script&gt;\n        &lt;script src=\"../js/script.js\"&gt;&lt;/script&gt;\n    &lt;/body&gt;\n&lt;/html&gt;\n</code></pre>\n\n<p>What ends up happening is that the program inserts the HTML line I want to add to the \"item_page.html\" file to the end and then adding the \"item_page_end\" string at the end. Does anyone know how to fix it put the HTML line in the Ruby program after</p>\n\n<pre><code>&lt;h2 class=\"title mt80\"&gt;Store&lt;/h2&gt;\n</code></pre>\n\n<p>Any other solution I have found is either for an array, a string or simply doesn't work.</p>\n"}, {"tags": ["arrays", "ruby", "string"], "answers": [{"tags": [], "owner": {"reputation": 31885, "user_id": 1008938, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/EOZbS.png?s=128&g=1", "display_name": "Linuxios", "link": "https://stackoverflow.com/users/1008938/linuxios"}, "is_accepted": true, "score": 4, "last_activity_date": 1488384675, "creation_date": 1488384675, "answer_id": 42536654, "question_id": 42536599, "link": "https://stackoverflow.com/questions/42536599/empty-array-using-scan-functrion-ruby/42536654#42536654", "title": "Empty array using scan functrion ruby", "body": "<p>Because regexes in Ruby are literal, not strings -- you have single quotes around your regex, so <code>scan</code> is searching for the literal string <code>/...../</code> rather than matches to the regex <code>/...../</code>. Try this instead:</p>\n\n<pre><code>my_string = \"0000000001000100\"\nstring_group = my_string.scan(/...../)\n</code></pre>\n\n<p>Which gives this:</p>\n\n<pre><code>[\"00000\", \"00001\", \"00010\"]\n</code></pre>\n"}], "owner": {"reputation": 2430, "user_id": 4363810, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/5bd274a5b50325215ab3e0ff837c8d8c?s=128&d=identicon&r=PG&f=1", "display_name": "mel", "link": "https://stackoverflow.com/users/4363810/mel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 40, "favorite_count": 0, "accepted_answer_id": 42536654, "answer_count": 1, "score": -1, "last_activity_date": 1488391987, "creation_date": 1488384513, "last_edit_date": 1488391987, "question_id": 42536599, "link": "https://stackoverflow.com/questions/42536599/empty-array-using-scan-functrion-ruby", "title": "Empty array using scan functrion ruby", "body": "<p>I'm just getting started in ruby and I have some trouble understanding the <code>scan</code> method:</p>\n\n<pre><code>my_string = \"0000000001000100\"\nstring_group = my_string.scan('/...../')\nputs string_group\nputs string_group.class\n</code></pre>\n\n<p>It displays that I've got an array but the array is empty. It can't come from my regex because I tested it and tried with another one:</p>\n\n<pre><code>'/[01]{5}/'\n</code></pre>\n\n<p>Why do I get an empty array?</p>\n"}, {"tags": ["ruby", "variables", "scope"], "answers": [{"tags": [], "owner": {"reputation": 31885, "user_id": 1008938, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/EOZbS.png?s=128&g=1", "display_name": "Linuxios", "link": "https://stackoverflow.com/users/1008938/linuxios"}, "is_accepted": false, "score": 5, "last_activity_date": 1488384525, "creation_date": 1488384525, "answer_id": 42536604, "question_id": 42536500, "link": "https://stackoverflow.com/questions/42536500/ruby-local-variable-scope/42536604#42536604", "title": "Ruby local variable scope", "body": "<p>There isn't much to say here except that local variables in Ruby are only accessible in the scope in which they are defined and any blocks (closures) defined in that scope that capture them. Since in Ruby, unlike some other dynamic languages, method are not closures, they do not capture local variables.</p>\n\n<p>If you tried, say, this:</p>\n\n<pre><code>irb(main):001:0&gt; a = 3\n=&gt; 3\nirb(main):002:0&gt; define_method(:testing) do\nirb(main):003:1*   puts a\nirb(main):004:1&gt; end\n=&gt; :testing\nirb(main):005:0&gt; testing\n3\n</code></pre>\n\n<p>It works, since the code is in a block instead of a method.</p>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 7644829, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c7c7bde2a2cee5663fb4e7790bfcd18?s=128&d=identicon&r=PG&f=1", "display_name": "Tony Francisco", "link": "https://stackoverflow.com/users/7644829/tony-francisco"}, "is_accepted": false, "score": 1, "last_activity_date": 1488423241, "creation_date": 1488423241, "answer_id": 42545990, "question_id": 42536500, "link": "https://stackoverflow.com/questions/42536500/ruby-local-variable-scope/42545990#42545990", "title": "Ruby local variable scope", "body": "<p>You could use instance variables. Any variable whose name begins with @ is an instance variable and is available anywhere in the class or method in which it is defined. For example, the variable @A defined within class B will be available to any methods in B.</p>\n"}, {"tags": [], "owner": {"reputation": 1036, "user_id": 5078051, "user_type": "registered", "accept_rate": 67, "profile_image": "https://graph.facebook.com/10203328378168774/picture?type=large", "display_name": "Hsiu Chuan Tsao", "link": "https://stackoverflow.com/users/5078051/hsiu-chuan-tsao"}, "is_accepted": false, "score": 0, "last_activity_date": 1488448413, "creation_date": 1488448413, "answer_id": 42552052, "question_id": 42536500, "link": "https://stackoverflow.com/questions/42536500/ruby-local-variable-scope/42552052#42552052", "title": "Ruby local variable scope", "body": "<pre><code>2.3.3 :007 &gt; def testing()\n2.3.3 :008?&gt;   [].push(\"test\")\n2.3.3 :009?&gt;   end\n =&gt; :testing\n2.3.3 :010 &gt; testing\n =&gt; [\"test\"]\n</code></pre>\n\n<p>You can't let local variables accessible by methods below them , you can use block like the answer by @Linuxios, or use the way that it easy work.</p>\n"}, {"tags": [], "owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "is_accepted": false, "score": 2, "last_activity_date": 1488450017, "creation_date": 1488450017, "answer_id": 42552684, "question_id": 42536500, "link": "https://stackoverflow.com/questions/42536500/ruby-local-variable-scope/42552684#42552684", "title": "Ruby local variable scope", "body": "<p>Defining a method in the <a href=\"https://banisterfiend.wordpress.com/2010/11/23/what-is-the-ruby-top-level/\" rel=\"nofollow noreferrer\">top-level</a> can be quite confusing. Let's wrap your code in a class instead:</p>\n\n<pre><code>class Foo\n  a = []\n\n  def testing\n    a &lt;&lt; 'test'\n  end\nend\n</code></pre>\n\n<p>(I've shortened <code>Array.new</code> to <code>[]</code> and <code>a.push(...)</code> to <code>a &lt;&lt; ...</code>)</p>\n\n<p><code>Foo#testing</code> can be called via:</p>\n\n<pre><code>foo = Foo.new\nfoo.testing\n#=&gt; undefined local variable or method `a'\n</code></pre>\n\n<p>Apparently, this doesn't work. The first <code>a</code> is a local variable in the scope of the <code>class</code> body, whereas the second <code>a</code> is a local variable within an instance method.</p>\n\n<p>Moving the variable initialization out of the class body into the <code>initialize</code> method doesn't work either, because local variables are not shared across methods:</p>\n\n<pre><code>class Foo\n  def initialize\n    a = []         # &lt;- one 'a'\n  end\n\n  def testing\n    a &lt;&lt; 'test'    # &lt;- another 'a'\n  end\nend\n</code></pre>\n\n<p>To get this working, you have to use an <em>instance variable</em>:</p>\n\n<pre><code>class Foo\n  def initialize\n    @a = []\n  end\n\n  def testing\n    @a &lt;&lt; 'test'\n  end\nend\n\nfoo = Foo.new\nfoo.testing\n#=&gt; [\"test\"]\n\nfoo.testing\n#=&gt; [\"test\", \"test\"]\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 7642370, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1705660e69f86467841b990457b24d80?s=128&d=identicon&r=PG&f=1", "display_name": "aaaaaa1234", "link": "https://stackoverflow.com/users/7642370/aaaaaa1234"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1634, "favorite_count": 0, "answer_count": 4, "score": 0, "last_activity_date": 1488450017, "creation_date": 1488384255, "question_id": 42536500, "link": "https://stackoverflow.com/questions/42536500/ruby-local-variable-scope", "title": "Ruby local variable scope", "body": "<p>I'm struggling with variable scope in ruby. I was under the impression that local variables were accessible by methods below them. Looking at the following code however I'm getting an undefined variable error.</p>\n\n<pre><code>a = Array.new\n\ndef testing()\n  a.push(\"test\")\nend\n\ntesting\n</code></pre>\n\n<p>Using global variables it works just fine, how can I avoid using global variables?</p>\n"}, {"tags": ["ruby", "flags", "optionparser"], "comments": [{"owner": {"reputation": 33085, "user_id": 2423164, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/Nxbnp.jpg?s=128&g=1", "display_name": "ndnenkov", "link": "https://stackoverflow.com/users/2423164/ndnenkov"}, "edited": false, "score": 3, "creation_date": 1488380743, "post_id": 42535169, "comment_id": 72205890, "body": "Wait, but why??"}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "reply_to_user": {"reputation": 33085, "user_id": 2423164, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/Nxbnp.jpg?s=128&g=1", "display_name": "ndnenkov", "link": "https://stackoverflow.com/users/2423164/ndnenkov"}, "edited": false, "score": 0, "creation_date": 1488381242, "post_id": 42535169, "comment_id": 72206293, "body": "@ndn user\u2019s behaviour analysis? :)"}, {"owner": {"reputation": 33085, "user_id": 2423164, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/Nxbnp.jpg?s=128&g=1", "display_name": "ndnenkov", "link": "https://stackoverflow.com/users/2423164/ndnenkov"}, "reply_to_user": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1488381300, "post_id": 42535169, "comment_id": 72206355, "body": "@mudasobwa, on a CLI? xd"}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 1, "creation_date": 1488381352, "post_id": 42535169, "comment_id": 72206391, "body": "Please do not format block params that way. The fact that ruby allows it does not mean you should scoff your code readers."}, {"owner": {"reputation": 1533, "user_id": 1800838, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/JJEuD.jpg?s=128&g=1", "display_name": "HippoMan", "link": "https://stackoverflow.com/users/1800838/hippoman"}, "edited": false, "score": 1, "creation_date": 1488382115, "post_id": 42535169, "comment_id": 72207009, "body": "Aside from the block formatting reminder, which I appreciate, can I assume that there is no way to do what I am asking, without a second opts.on block? I have my own idiosyncratic reasons for wanting to know this info :) ... but if it&#39;s not possible within the current implementation of OptionParser, I can live without it."}, {"owner": {"reputation": 33085, "user_id": 2423164, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/Nxbnp.jpg?s=128&g=1", "display_name": "ndnenkov", "link": "https://stackoverflow.com/users/2423164/ndnenkov"}, "edited": false, "score": 0, "creation_date": 1488382467, "post_id": 42535169, "comment_id": 72207277, "body": "It probably is possible if you read the source and do some stuff like access local variables from the binding of the caller, but it obviously shouldn&#39;t be done."}, {"owner": {"reputation": 14010, "user_id": 3109182, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/a4b305f0077055b4fdcf715067775d5a?s=128&d=identicon&r=PG", "display_name": "Anthony", "link": "https://stackoverflow.com/users/3109182/anthony"}, "edited": false, "score": 0, "creation_date": 1488394572, "post_id": 42535169, "comment_id": 72215237, "body": "the only other way I see is the read the <code>ARGV</code> before your parser."}], "answers": [{"comments": [{"owner": {"reputation": 1533, "user_id": 1800838, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/JJEuD.jpg?s=128&g=1", "display_name": "HippoMan", "link": "https://stackoverflow.com/users/1800838/hippoman"}, "edited": false, "score": 0, "creation_date": 1491054451, "post_id": 42541649, "comment_id": 73390441, "body": "Yes, I have been doing something similar to this. I see that getting the exact option flag is not possible. I have my own, idiosyncratic reasons for wanting to get the exact flag value, and so I have abandoned OptionParser for this particular application, and I simply parse the command-line arguments &quot;by hand&quot; (i.e., by traversing ARGV myself in this case)."}], "tags": [], "owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "is_accepted": true, "score": 0, "last_activity_date": 1488402014, "last_edit_date": 1488402014, "creation_date": 1488400916, "answer_id": 42541649, "question_id": 42535169, "link": "https://stackoverflow.com/questions/42535169/how-to-get-the-specified-option-flag-from-within-optionparser/42541649#42541649", "title": "How to get the specified option flag from within OptionParser", "body": "<p>I don't think you can get the flags being passed in when inside the <code>OptionParser.new</code> block. At that point it's too late. However, prior to OptionParser parsing the command-line, it's possible to look and see what's being passed in.</p>\n\n<p><code>ARGV</code> contains the raw command-line. For instance, if this is the command-line invocation for some code:</p>\n\n<pre><code>foo -i 1 -j 2\n</code></pre>\n\n<p>then <code>ARGV</code> will contain:</p>\n\n<pre><code>[\"-i\", \"1\", \"-j\", \"2\"]\n</code></pre>\n\n<p>and, then it becomes pretty easy to grab the flags:</p>\n\n<pre><code>ARGV.grep(/^-/) # =&gt; [\"-i\", \"-j\"]\n</code></pre>\n\n<p>There are other OptionParser-like tools for Ruby, and those might let you access the flags being used, but I can't think of a reason I'd ever care to. Looking at your code it seems like you're not understanding how to use OptionParser:</p>\n\n<pre><code>parser = OptionParser.new {                                                                                                 \n  |opts|                                                                                                                                                                                                                                     \n  opts.on('-f', '--file FILE', 'filename') {                                                                                            \n    |arg|                                                                                                                   \n    $filename = arg                                                                                                 \n    # Here I'd like to know whether '-f' or '--file' was entered\n    # on the command line.                                                                              \n  }\n  # ... etc. ...\n}\n</code></pre>\n\n<p>Instead of doing it that way, I'd write it:</p>\n\n<pre><code>options = {}\nOptionParser.new do |opts|                                                                                                                                                                                                                                     \n  opts.on('-f', '--file FILE', 'filename') { |arg| options[:filename] = arg }\nend.parse!\n\nif options[:filename]\n  puts 'exists' if File.exist?(options[:filename])\nend\n</code></pre>\n\n<p>Then, later in your code you can check in the <code>options</code> hash to see if either of the <code>-f</code> or <code>--file</code> options was given, and what the value was. That it was one or the other of <code>-f</code> or <code>--file</code> shouldn't ever matter. </p>\n\n<p>If it does then you need to differentiate between the two flags, instead of treating them as if they're aliases:</p>\n\n<pre><code>options = {}\nOptionParser.new do |opts|                                                                                                                                                                                                                                     \n  opts.on('-f', 'filename') { |arg| options[:f] = arg }\n  opts.on('--file FILE', 'filename') { |arg| options[:file] = arg }\nend.parse!\n\nif options[:file] || options[:f]\n  puts 'exists' if File.exist?(options[:file] || options[:f])\nend\n</code></pre>\n"}], "owner": {"reputation": 1533, "user_id": 1800838, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/JJEuD.jpg?s=128&g=1", "display_name": "HippoMan", "link": "https://stackoverflow.com/users/1800838/hippoman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 286, "favorite_count": 1, "accepted_answer_id": 42541649, "answer_count": 1, "score": 1, "last_activity_date": 1488402014, "creation_date": 1488380645, "last_edit_date": 1488392123, "question_id": 42535169, "link": "https://stackoverflow.com/questions/42535169/how-to-get-the-specified-option-flag-from-within-optionparser", "title": "How to get the specified option flag from within OptionParser", "body": "<p>I'd like to get the exact option flag that was specified on the command line from within Ruby's OptionParser.</p>\n\n<p>For example, suppose I have the following code:</p>\n\n<pre><code>parser = OptionParser.new {                                                                                                 \n  |opts|                                                                                                                                                                                                                                     \n  opts.on('-f', '--file FILE', 'filename') {                                                                                            \n    |arg|                                                                                                                   \n    $filename = arg                                                                                                 \n    # Here I'd like to know whether '-f' or '--file' was entered\n    # on the command line.                                                                              \n  }\n  # ... etc. ...\n}\n</code></pre>\n\n<p>I'd like to know whether the user happened to type '-f' or '--file' on the command line. Is this possible without writing two separate <code>opts.on</code> blocks?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "rspec", "rspec3"], "comments": [{"owner": {"reputation": 33085, "user_id": 2423164, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/Nxbnp.jpg?s=128&g=1", "display_name": "ndnenkov", "link": "https://stackoverflow.com/users/2423164/ndnenkov"}, "edited": false, "score": 0, "creation_date": 1488379470, "post_id": 42534608, "comment_id": 72204899, "body": "Can you add the contents of <code>examples.txt</code>?"}, {"owner": {"reputation": 55, "user_id": 7641891, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N9e9m.jpg?s=128&g=1", "display_name": "KSHMR", "link": "https://stackoverflow.com/users/7641891/kshmr"}, "reply_to_user": {"reputation": 33085, "user_id": 2423164, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/Nxbnp.jpg?s=128&g=1", "display_name": "ndnenkov", "link": "https://stackoverflow.com/users/2423164/ndnenkov"}, "edited": false, "score": 0, "creation_date": 1488379739, "post_id": 42534608, "comment_id": 72205127, "body": "@ndn Added an image link"}], "answers": [{"comments": [{"owner": {"reputation": 33085, "user_id": 2423164, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/Nxbnp.jpg?s=128&g=1", "display_name": "ndnenkov", "link": "https://stackoverflow.com/users/2423164/ndnenkov"}, "edited": false, "score": 0, "creation_date": 1488380512, "post_id": 42535120, "comment_id": 72205722, "body": "Yea, that would be a problem. When do you get this error? And if you do, how was the <code>examples.txt</code> file generated to begin with."}, {"owner": {"reputation": 55, "user_id": 7641891, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N9e9m.jpg?s=128&g=1", "display_name": "KSHMR", "link": "https://stackoverflow.com/users/7641891/kshmr"}, "reply_to_user": {"reputation": 33085, "user_id": 2423164, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/Nxbnp.jpg?s=128&g=1", "display_name": "ndnenkov", "link": "https://stackoverflow.com/users/2423164/ndnenkov"}, "edited": false, "score": 0, "creation_date": 1488380595, "post_id": 42535120, "comment_id": 72205776, "body": "@ndn I get this error in the coffee_spec.rb file. The file was created automatically after I ran it the first time."}, {"owner": {"reputation": 33085, "user_id": 2423164, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/Nxbnp.jpg?s=128&g=1", "display_name": "ndnenkov", "link": "https://stackoverflow.com/users/2423164/ndnenkov"}, "edited": false, "score": 0, "creation_date": 1488380642, "post_id": 42535120, "comment_id": 72205819, "body": "Do you still get it if you inline the rspec configuration in the spec file (for experimentation&#39;s sake)?"}, {"owner": {"reputation": 55, "user_id": 7641891, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N9e9m.jpg?s=128&g=1", "display_name": "KSHMR", "link": "https://stackoverflow.com/users/7641891/kshmr"}, "reply_to_user": {"reputation": 33085, "user_id": 2423164, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/Nxbnp.jpg?s=128&g=1", "display_name": "ndnenkov", "link": "https://stackoverflow.com/users/2423164/ndnenkov"}, "edited": false, "score": 0, "creation_date": 1488380749, "post_id": 42535120, "comment_id": 72205896, "body": "@ndn I am not sure what you mean, could you be more specific please :) ?"}, {"owner": {"reputation": 33085, "user_id": 2423164, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/Nxbnp.jpg?s=128&g=1", "display_name": "ndnenkov", "link": "https://stackoverflow.com/users/2423164/ndnenkov"}, "edited": false, "score": 0, "creation_date": 1488380788, "post_id": 42535120, "comment_id": 72205920, "body": "Take the <code>RSpec.configure do |c|   c.example_status_persistence_file_path = &quot;examples.txt&quot; end</code> stuff and put it in the spec file you are running."}, {"owner": {"reputation": 55, "user_id": 7641891, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N9e9m.jpg?s=128&g=1", "display_name": "KSHMR", "link": "https://stackoverflow.com/users/7641891/kshmr"}, "reply_to_user": {"reputation": 33085, "user_id": 2423164, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/Nxbnp.jpg?s=128&g=1", "display_name": "ndnenkov", "link": "https://stackoverflow.com/users/2423164/ndnenkov"}, "edited": false, "score": 0, "creation_date": 1488380945, "post_id": 42535120, "comment_id": 72206048, "body": "I already have that <code>RSpec.configure do |config|   config.example_status_persistence_file_path = &quot;spec&#47;examples.txt&quot; end</code>"}, {"owner": {"reputation": 33085, "user_id": 2423164, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/Nxbnp.jpg?s=128&g=1", "display_name": "ndnenkov", "link": "https://stackoverflow.com/users/2423164/ndnenkov"}, "edited": false, "score": 0, "creation_date": 1488381155, "post_id": 42535120, "comment_id": 72206213, "body": "It&#39;s very strange that this will run normally on the first run and fail when you apply the filter. Is this the exact error being printed?"}, {"owner": {"reputation": 55, "user_id": 7641891, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N9e9m.jpg?s=128&g=1", "display_name": "KSHMR", "link": "https://stackoverflow.com/users/7641891/kshmr"}, "reply_to_user": {"reputation": 33085, "user_id": 2423164, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/Nxbnp.jpg?s=128&g=1", "display_name": "ndnenkov", "link": "https://stackoverflow.com/users/2423164/ndnenkov"}, "edited": false, "score": 0, "creation_date": 1488381297, "post_id": 42535120, "comment_id": 72206352, "body": "@ndn Yes I use Ruby Mine and that is the error it shows when I hover over it with my mouse. In the documentation of RSpec it says: &quot;RSpec re-runs the formerly failing example and verifies that it passes. If we try this process once more, RSpec won\u2019t have any failing examples left to run.&quot; But even the first time it didn&#39;t run right, I also tried it with a new .txt file but same problem."}, {"owner": {"reputation": 33085, "user_id": 2423164, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/Nxbnp.jpg?s=128&g=1", "display_name": "ndnenkov", "link": "https://stackoverflow.com/users/2423164/ndnenkov"}, "edited": false, "score": 0, "creation_date": 1488381464, "post_id": 42535120, "comment_id": 72206485, "body": "Could you run it in from the console instead and share that? It does seem that for whatever reason it doesn&#39;t pick the configuration in some cases. That is why I asked to inline it and run for a specific file."}, {"owner": {"reputation": 55, "user_id": 7641891, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N9e9m.jpg?s=128&g=1", "display_name": "KSHMR", "link": "https://stackoverflow.com/users/7641891/kshmr"}, "reply_to_user": {"reputation": 33085, "user_id": 2423164, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/Nxbnp.jpg?s=128&g=1", "display_name": "ndnenkov", "link": "https://stackoverflow.com/users/2423164/ndnenkov"}, "edited": false, "score": 0, "creation_date": 1488381738, "post_id": 42535120, "comment_id": 72206721, "body": "So I ran it in the /spec directory, not sure if that is the right way but anyway this is the outcome in the cmd: <code>RSpec.configure do |config| &gt; c.example_status_persistence_file_path = &quot;examples.txt&quot; bash: RSpec.configure: command not found bash: config: command not found bash: c.example_status_persistence_file_path: command not found</code>"}, {"owner": {"reputation": 33085, "user_id": 2423164, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/Nxbnp.jpg?s=128&g=1", "display_name": "ndnenkov", "link": "https://stackoverflow.com/users/2423164/ndnenkov"}, "edited": false, "score": 0, "creation_date": 1488381859, "post_id": 42535120, "comment_id": 72206808, "body": "Lets say you have a spec called <code>cats_spec.rb</code>. Put the <code>RSpec.configure do |config| config.example_status_persistence_file_path = &quot;spec&#47;examples.txt&quot; end</code> spiel at the top of that spec and run in the console: <code>bundle exec rspec cats_spec.rb</code>."}, {"owner": {"reputation": 55, "user_id": 7641891, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N9e9m.jpg?s=128&g=1", "display_name": "KSHMR", "link": "https://stackoverflow.com/users/7641891/kshmr"}, "reply_to_user": {"reputation": 33085, "user_id": 2423164, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/Nxbnp.jpg?s=128&g=1", "display_name": "ndnenkov", "link": "https://stackoverflow.com/users/2423164/ndnenkov"}, "edited": false, "score": 0, "creation_date": 1488382172, "post_id": 42535120, "comment_id": 72207055, "body": "Not sure what I did but it worked! I deleted the examples.txt file and created a new one and now it works. I have no idea what the problem was because it stil says <code>Cannot find &#39;example_status_persistence_file_path=&#39;</code>. Thanks anyway for the help :)"}, {"owner": {"reputation": 1647, "user_id": 3462, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/967213c031e04954bf0957185a3cab53?s=128&d=identicon&r=PG", "display_name": "Erin Dees", "link": "https://stackoverflow.com/users/3462/erin-dees"}, "edited": false, "score": 0, "creation_date": 1488408779, "post_id": 42535120, "comment_id": 72223109, "body": "@EgonMeijers, could you paste the full contents of <code>coffee_spec.rb</code> here, or to <a href=\"https://gist.github.com\" rel=\"nofollow noreferrer\">gist.github.com</a>?"}, {"owner": {"reputation": 1647, "user_id": 3462, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/967213c031e04954bf0957185a3cab53?s=128&d=identicon&r=PG", "display_name": "Erin Dees", "link": "https://stackoverflow.com/users/3462/erin-dees"}, "edited": false, "score": 0, "creation_date": 1488478174, "post_id": 42535120, "comment_id": 72259626, "body": "@EgonMeijers, it looks like you found the solution; glad it&#39;s working now. Thanks for adding the code. I can confirm that it works with Ruby 2.4 and RSpec 3.6: <a href=\"https://gist.github.com/anonymous/8348d53d44011de04da64cca775be3e9\" rel=\"nofollow noreferrer\">gist.github.com/anonymous/8348d53d44011de04da64cca775be3e9</a>"}, {"owner": {"reputation": 55, "user_id": 7641891, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N9e9m.jpg?s=128&g=1", "display_name": "KSHMR", "link": "https://stackoverflow.com/users/7641891/kshmr"}, "reply_to_user": {"reputation": 1647, "user_id": 3462, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/967213c031e04954bf0957185a3cab53?s=128&d=identicon&r=PG", "display_name": "Erin Dees", "link": "https://stackoverflow.com/users/3462/erin-dees"}, "edited": false, "score": 0, "creation_date": 1488529280, "post_id": 42535120, "comment_id": 72280844, "body": "@undees thanks for trying yourself, I use both Ruby 2.4 and RSpec 3.6 as well :)"}], "tags": [], "owner": {"reputation": 55, "user_id": 7641891, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N9e9m.jpg?s=128&g=1", "display_name": "KSHMR", "link": "https://stackoverflow.com/users/7641891/kshmr"}, "is_accepted": false, "score": 0, "last_activity_date": 1488380494, "creation_date": 1488380494, "answer_id": 42535120, "question_id": 42534608, "link": "https://stackoverflow.com/questions/42534608/rspec-only-failures-wrong-output/42535120#42535120", "title": "RSpec --only-failures wrong output", "body": "<p>Maybe this is the problem?</p>\n\n<pre><code>config.example_status_persistence_file_path = 'spec/examples.txt'\n\nCannot find 'example_status_persistence_file_path='\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 55, "user_id": 7641891, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N9e9m.jpg?s=128&g=1", "display_name": "KSHMR", "link": "https://stackoverflow.com/users/7641891/kshmr"}, "is_accepted": false, "score": 0, "last_activity_date": 1488442449, "creation_date": 1488442449, "answer_id": 42550007, "question_id": 42534608, "link": "https://stackoverflow.com/questions/42534608/rspec-only-failures-wrong-output/42550007#42550007", "title": "RSpec --only-failures wrong output", "body": "<p><strong>Code coffee_spec.rb</strong></p>\n\n<pre><code>RSpec.configure do |config|\n  config.example_status_persistence_file_path = 'spec/examples.txt'\nend\n\nRSpec.describe 'A cup of coffee' do\n  let (:coffee) { Coffee.new }\n\n  it 'costs $1' do\n    expect(coffee.price).to eq(1.00)\n  end\n\n  context 'with milk' do\n    before { coffee.add :milk }\n\n    it 'costs $1.25' do\n      expect(coffee.price).to eq(1.25)\n    end\n  end\nend\n\nclass Coffee\n  def ingredients\n    @ingredients ||= []\n  end\n\n  def add(ingredient)\n    ingredients &lt;&lt; ingredient\n  end\n\n  def price\n    1.00\n  end\n\nend\n</code></pre>\n"}], "owner": {"reputation": 55, "user_id": 7641891, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N9e9m.jpg?s=128&g=1", "display_name": "KSHMR", "link": "https://stackoverflow.com/users/7641891/kshmr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 601, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1488442449, "creation_date": 1488379268, "last_edit_date": 1488379718, "question_id": 42534608, "link": "https://stackoverflow.com/questions/42534608/rspec-only-failures-wrong-output", "title": "RSpec --only-failures wrong output", "body": "<p>When I run RSpec it gives the following output:</p>\n\n<pre><code>$ rspec\n.F\n\nFailures:\n\n1) A cup of coffee with milk costs $1.25\n   Failure/Error: expect(coffee.price).to eq(1.25)\n\n   expected: 1.25\n        got: 1.0\n\n   (compared using ==)\n # ./spec/coffee_spec.rb:12:in `block (3 levels) in &lt;top (required)&gt;'\n\n Finished in 0.02668 seconds (files took 0.12828 seconds to load)\n 2 examples, 1 failure\n\n Failed examples:\n\n rspec ./spec/coffee_spec.rb:11 # A cup of coffee with milk costs $1.25\n</code></pre>\n\n<p>So when I run</p>\n\n<pre><code>$ rspec --only-failures\n</code></pre>\n\n<p>The output should be</p>\n\n<pre><code>Run options: include {:last_run_status=&gt;\"failed\"}\nF\n\u00ab truncated \u00bb\n1 example, 1 failure\nFailed examples:\nrspec ./spec/coffee_spec.rb:11 # A cup of coffee with milk costs $1.25\n</code></pre>\n\n<p>But instead of that I get this:</p>\n\n<pre><code>Run options: include {:last_run_status=&gt;\"failed\"}\n\nAll examples were filtered out\n\n\nFinished in 0.00158 seconds (files took 0.13118 seconds to load)\n0 examples, 0 failures\n</code></pre>\n\n<p>I already added this to the spec file \n<code>RSpec.configure do |c|\n  c.example_status_persistence_file_path = \"examples.txt\"\nend</code></p>\n\n<p>This is the output from the examples.txt:\n<a href=\"https://i.stack.imgur.com/IyFUs.png\" rel=\"nofollow noreferrer\">examples.txt</a></p>\n\n<p>Any idea what I did wrong?</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "answers": [{"tags": [], "owner": {"reputation": 47232, "user_id": 1772830, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/Qtoqg.jpg?s=128&g=1", "display_name": "Andrey Deineko", "link": "https://stackoverflow.com/users/1772830/andrey-deineko"}, "is_accepted": false, "score": 1, "last_activity_date": 1488375711, "creation_date": 1488375711, "answer_id": 42533340, "question_id": 42533271, "link": "https://stackoverflow.com/questions/42533271/how-to-translate-the-value-of-time-ago-in-words-func-to-my-language/42533340#42533340", "title": "How to translate the value of time_ago_in_words func to my language?", "body": "<p>If you look into <a href=\"http://api.rubyonrails.org/classes/ActionView/Helpers/DateHelper.html#method-i-distance_of_time_in_words\" rel=\"nofollow noreferrer\"><code>distance_of_time_in_words</code></a> method's docs, which uses under the hood of <a href=\"http://api.rubyonrails.org/classes/ActionView/Helpers/DateHelper.html#method-i-time_ago_in_words\" rel=\"nofollow noreferrer\"><code>time_ago_in_words</code></a>, you will see, that you can pass a <code>scope</code> option for custom translation lookup:</p>\n\n<blockquote>\n  <p>With the <code>scope</code> option, you can define a custom scope for Rails to look\n  up the translation.</p>\n  \n  <p>For example you can define the following in your locale (e.g. en.yml).</p>\n\n<pre><code>datetime:\n  distance_in_words:\n    short:\n      about_x_hours:\n        one: 'an hour'\n        other: '%{count} hours'\n</code></pre>\n  \n  <p>See github.com/svenfuchs/rails-i18n/blob/master/rails/locale/en.yml for\n  more examples.</p>\n  \n  <p>Which will then result in the following:</p>\n\n<pre><code>from_time = Time.now distance_of_time_in_words(from_time, from_time + 50.minutes, scope: 'datetime.distance_in_words.short')\n# =&gt; \"an hour\"\ndistance_of_time_in_words(from_time, from_time + 3.hours, scope: 'datetime.distance_in_words.short')\n# =&gt; \"3 hours\"\n</code></pre>\n</blockquote>\n"}], "owner": {"reputation": 27, "user_id": 5670731, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f88ace2b377975c1a66bc75540de4fb?s=128&d=identicon&r=PG&f=1", "display_name": "user5670731", "link": "https://stackoverflow.com/users/5670731/user5670731"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 277, "favorite_count": 0, "closed_date": 1488381932, "answer_count": 1, "score": 1, "last_activity_date": 1488375711, "creation_date": 1488375491, "question_id": 42533271, "link": "https://stackoverflow.com/questions/42533271/how-to-translate-the-value-of-time-ago-in-words-func-to-my-language", "closed_reason": "Duplicate", "title": "How to translate the value of time_ago_in_words func to my language?", "body": "<p>I made an Arabic Web-App using Ruby on Rails, how can i convert the result of time_ago_in_words function to Arabic Language?</p>\n\n<p>or should I write my own function?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-5"], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 4156744, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/146f080ecce4110ade81265c34cbe1ee?s=128&d=identicon&r=PG&f=1", "display_name": "Jonathan Mast", "link": "https://stackoverflow.com/users/4156744/jonathan-mast"}, "is_accepted": false, "score": 0, "last_activity_date": 1488376230, "creation_date": 1488376230, "answer_id": 42533530, "question_id": 42532979, "link": "https://stackoverflow.com/questions/42532979/enum-in-rails-5-for-polymorphic-associations-and-overriding-default-behaviour/42533530#42533530", "title": "enum in Rails 5 for polymorphic associations and overriding default behaviour", "body": "<p>I'm assuming <code>MyModel</code> and <code>MyModel2</code> are two possible types of a polymorphic association.</p>\n\n<ol>\n<li><p>Having the same attribute name with different behavior is what polymorphism is good at, I don't see any reason not to use it for this.</p></li>\n<li><p>Enum attributes can have their getters and setters overwritten just like any attribute.</p></li>\n</ol>\n\n<p>For example:</p>\n\n<pre><code># Return the status as uppercase\ndef my_status\n  super.upcase\nend\n\n# Save status as lowercase\ndef my_status=(new_status)\n  super(new_status.downcase)\nend\n</code></pre>\n\n<p>The special methods added by the enum macro can be overridden in the same way.</p>\n"}], "owner": {"reputation": 221, "user_id": 7576294, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/25aed7e1acd0e452fe9b537d15cf0e5e?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin", "link": "https://stackoverflow.com/users/7576294/kevin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 581, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1547707025, "creation_date": 1488374626, "last_edit_date": 1547707025, "question_id": 42532979, "link": "https://stackoverflow.com/questions/42532979/enum-in-rails-5-for-polymorphic-associations-and-overriding-default-behaviour", "title": "enum in Rails 5 for polymorphic associations and overriding default behaviour", "body": "<p>1) Can <code>enum</code> be used for polymorphic associations well?</p>\n\n<pre><code>class MyModel &lt; ActiveRecord::Base\n  enum my_status: [:a, :b, :c, :d]\nend\n\n\nclass MyModel2 &lt; ActiveRecord::Base\n  enum my_status: [:aa, :bb, :cc, :dd]\nend\n</code></pre>\n\n<p>Any downsides?</p>\n\n<p>2) Can I override getter or setter for enum and how?</p>\n"}, {"tags": ["html", "ruby-on-rails", "json", "ruby"], "comments": [{"owner": {"reputation": 5471, "user_id": 6019903, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/e7h7I.png?s=128&g=1", "display_name": "Brad", "link": "https://stackoverflow.com/users/6019903/brad"}, "edited": false, "score": 1, "creation_date": 1488374195, "post_id": 42532769, "comment_id": 72201207, "body": "<a href=\"http://stackoverflow.com/help/how-to-ask\">stackoverflow.com/help/how-to-ask</a>"}, {"owner": {"reputation": 1999, "user_id": 5922350, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/FvLWu.png?s=128&g=1", "display_name": "KNejad", "link": "https://stackoverflow.com/users/5922350/knejad"}, "reply_to_user": {"reputation": 5471, "user_id": 6019903, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/e7h7I.png?s=128&g=1", "display_name": "Brad", "link": "https://stackoverflow.com/users/6019903/brad"}, "edited": false, "score": 0, "creation_date": 1488375118, "post_id": 42532769, "comment_id": 72201878, "body": "Hi everyone, firstly I am sorry this question is not right for stack overflow. What I intended to do was answer my own question (see my answer below) so that other people with the same question as me could have a good example of how to solve this. Please could you advice me on how to rewrite my question keeping in mind the answer I posted? Also @AndreyDeineko I understand that JSON and HTML are 2 completely different things but there are cases (such as my own) where it would be necessary to convert 1 file format to another. I don&#39;t believe your comment was very productive."}, {"owner": {"user_type": "does_not_exist", "display_name": "user7600596"}, "edited": false, "score": 1, "creation_date": 1488375308, "post_id": 42532769, "comment_id": 72202004, "body": "@AndreyDeineko comments should ask for clarification or criticize in a constructive manner. If you find the question not good you can downvote it. Making comments like yours does not in any way help or contribute to the quality or user experience of the Stack Overflow community. It is just unnecessary."}, {"owner": {"reputation": 1999, "user_id": 5922350, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/FvLWu.png?s=128&g=1", "display_name": "KNejad", "link": "https://stackoverflow.com/users/5922350/knejad"}, "reply_to_user": {"reputation": 5471, "user_id": 6019903, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/e7h7I.png?s=128&g=1", "display_name": "Brad", "link": "https://stackoverflow.com/users/6019903/brad"}, "edited": false, "score": 0, "creation_date": 1488375559, "post_id": 42532769, "comment_id": 72202184, "body": "@Brad I have read this before and after reading it again I still do not see why my post is not a good question. (I am not disagreeing with you just trying to learn). I understand that in just a few minutes at least 7 people down voted it so there must be something wrong with it but I don&#39;t see what could you please help explain what is wrong?"}, {"owner": {"reputation": 12440, "user_id": 308731, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/eQxFn.jpg?s=128&g=1", "display_name": "Eyeslandic", "link": "https://stackoverflow.com/users/308731/eyeslandic"}, "edited": false, "score": 0, "creation_date": 1488375570, "post_id": 42532769, "comment_id": 72202199, "body": "@KNejad There is another site as part of the stackoverflow mansion called <a href=\"http://codereview.stackexchange.com/\">codereview.stackexchange.com</a>. I think your question would fit well in there"}, {"owner": {"reputation": 12440, "user_id": 308731, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/eQxFn.jpg?s=128&g=1", "display_name": "Eyeslandic", "link": "https://stackoverflow.com/users/308731/eyeslandic"}, "edited": false, "score": 0, "creation_date": 1488375684, "post_id": 42532769, "comment_id": 72202279, "body": "@KNejad The reason it is downvoted and will eventually be closed it that it&#39;s just too broad as it is, and also doesn&#39;t show any effort on your part. If you had included some part of your answer you would have gotten much better response, since the answer shows that you definitely know what you&#39;re doing"}, {"owner": {"reputation": 1999, "user_id": 5922350, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/FvLWu.png?s=128&g=1", "display_name": "KNejad", "link": "https://stackoverflow.com/users/5922350/knejad"}, "reply_to_user": {"reputation": 12440, "user_id": 308731, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/eQxFn.jpg?s=128&g=1", "display_name": "Eyeslandic", "link": "https://stackoverflow.com/users/308731/eyeslandic"}, "edited": false, "score": 0, "creation_date": 1488376142, "post_id": 42532769, "comment_id": 72202571, "body": "@Iceman Thanks for your reply. Firstly does the updated question work any better? Also I had 9 reputation before (which I know is very little) And now after this question I am back down to 1. Is there any way for me to regain this lost reputation? As I feel like it is unfair for me to lose all my reputation when I was just trying to help others who might have the same problem as I did."}, {"owner": {"reputation": 12440, "user_id": 308731, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/eQxFn.jpg?s=128&g=1", "display_name": "Eyeslandic", "link": "https://stackoverflow.com/users/308731/eyeslandic"}, "edited": false, "score": 0, "creation_date": 1488390620, "post_id": 42532769, "comment_id": 72212891, "body": "@KNejad If you&#39;re worried about your reputation points, which you really shouldn&#39;t everybody makes mistakes on this site when starting out, you can try deleting the question."}, {"owner": {"reputation": 1299, "user_id": 1130176, "user_type": "registered", "accept_rate": 32, "profile_image": "https://www.gravatar.com/avatar/3618314d500643b06b1b88c8671eb840?s=128&d=identicon&r=PG", "display_name": "user1130176", "link": "https://stackoverflow.com/users/1130176/user1130176"}, "edited": false, "score": 0, "creation_date": 1606903367, "post_id": 42532769, "comment_id": 115101438, "body": "thanks mods, you&#39;ve done it again, i found the exact question i wanted but you closed it. why do you do this?"}], "answers": [{"tags": [], "owner": {"reputation": 1999, "user_id": 5922350, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/FvLWu.png?s=128&g=1", "display_name": "KNejad", "link": "https://stackoverflow.com/users/5922350/knejad"}, "is_accepted": true, "score": 1, "last_activity_date": 1488374944, "creation_date": 1488374944, "answer_id": 42533086, "question_id": 42532769, "link": "https://stackoverflow.com/questions/42532769/how-can-i-convert-a-json-file-to-a-html-page-in-ruby-on-rails/42533086#42533086", "title": "How can I convert a JSON file to a html page in Ruby on Rails?", "body": "<p>I think this recursive function does a good job at converting the JSON file to a pretty html page.</p>\n\n<pre><code>def parse(hash, iteration=0 )\n    iteration += 1\n    output = \"\"\n    hash.each do |key, value|\n\n        if value.is_a?(Hash)\n            output += \"&lt;div class='entry' style='margin-left:#{iteration}em'&gt; &lt;span style='font-size:#{250 - iteration*20}%'&gt;#{key}: &lt;/span&gt;&lt;br&gt;\"\n            output += parse(value,iteration)\n            output += \"&lt;/div&gt;\"\n        elsif value.is_a?(Array)\n            output += \"&lt;div class='entry' style='margin-left:#{iteration}em'&gt; &lt;span style='font-size:#{250 - iteration*20}%'&gt;#{key}: &lt;/span&gt;&lt;br&gt;\"\n            value.each do |value|\n                if value.is_a?(String) then\n                    output += \"&lt;div style='margin-left:#{iteration}em'&gt;#{value} &lt;/div&gt;\"\n                else\n                    output += parse(value,iteration-1)\n                end\n            end\n            output += \"&lt;/div&gt;\"\n\n        else\n            output += \"&lt;div class='entry' style='margin-left:#{iteration}em'&gt; &lt;span style='font-weight: bold'&gt;#{key}: &lt;/span&gt;#{value}&lt;/div&gt;\"\n        end\n    end\n    return output\nend\n</code></pre>\n\n<p>Here is how it works. You pass it a hash Which you get by converting the JSON file to a hash:</p>\n\n<pre><code>    jsonFile = JSON.load(open(params[\"url\"] ))\n    @output = parse(jsonFile)\n</code></pre>\n\n<p>And the function checks each value in the hash and does 1 of 3 things:</p>\n\n<ol>\n<li>If it is an array outputs each array element on a new line</li>\n<li>If it is a string outputs the key and the value on the same line</li>\n<li>If it is another Hash calls the same function</li>\n</ol>\n\n<p>After this all you have to do it output the @output variable to the screen on the view file:</p>\n\n<pre><code>&lt;%= @output.html_safe %&gt;\n</code></pre>\n\n<p>What the iteration does is keep track of how many times the function has been called so that the output can be indented correctly</p>\n\n<p>I hope this helps anybody else who is trying to do the same thing.</p>\n"}], "owner": {"reputation": 1999, "user_id": 5922350, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/FvLWu.png?s=128&g=1", "display_name": "KNejad", "link": "https://stackoverflow.com/users/5922350/knejad"}, "delete_vote_count": 1, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 936, "favorite_count": 0, "closed_date": 1488374954, "accepted_answer_id": 42533086, "answer_count": 1, "score": -6, "last_activity_date": 1488375966, "creation_date": 1488374032, "last_edit_date": 1488375966, "question_id": 42532769, "link": "https://stackoverflow.com/questions/42532769/how-can-i-convert-a-json-file-to-a-html-page-in-ruby-on-rails", "closed_reason": "Needs details or clarity", "title": "How can I convert a JSON file to a html page in Ruby on Rails?", "body": "<p>I am writing a website which takes as a URL get parameter a link to a JSON file and converts it to a good looking html page (i.e. not a table). Part of this requires a recursive function to parse the JSON file. What I would like is the keys to look like html headers. Each value in an Array to be on a separate line and strings to have a bold key with the value being on the same line. Most importantly I would like the page to indent the content of the JSON file as you would expect a JSON file to be indented.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "postgresql", "date-range"], "comments": [{"owner": {"reputation": 671, "user_id": 3445936, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cd8z6.jpg?s=128&g=1", "display_name": "Rohit Lingayat", "link": "https://stackoverflow.com/users/3445936/rohit-lingayat"}, "edited": false, "score": 0, "creation_date": 1488375637, "post_id": 42532033, "comment_id": 72202243, "body": "What is the field type of <code>date_range</code> field. ?"}, {"owner": {"reputation": 694, "user_id": 4247633, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b489ee8b00fb53a9c49bef05f7b71120?s=128&d=identicon&r=PG", "display_name": "Deepak Kabbur", "link": "https://stackoverflow.com/users/4247633/deepak-kabbur"}, "reply_to_user": {"reputation": 671, "user_id": 3445936, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cd8z6.jpg?s=128&g=1", "display_name": "Rohit Lingayat", "link": "https://stackoverflow.com/users/3445936/rohit-lingayat"}, "edited": false, "score": 0, "creation_date": 1488376674, "post_id": 42532033, "comment_id": 72202935, "body": "field type is daterange."}], "answers": [{"comments": [{"owner": {"reputation": 631, "user_id": 4083475, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-n0LAYVXBidM/AAAAAAAAAAI/AAAAAAAAAIc/yOo7pS-h7wo/photo.jpg?sz=128", "display_name": "edruid", "link": "https://stackoverflow.com/users/4083475/edruid"}, "edited": false, "score": 0, "creation_date": 1488382966, "post_id": 42536025, "comment_id": 72207653, "body": "Sorry for not actually knowing the rails terminology :/"}], "tags": [], "owner": {"reputation": 631, "user_id": 4083475, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-n0LAYVXBidM/AAAAAAAAAAI/AAAAAAAAAIc/yOo7pS-h7wo/photo.jpg?sz=128", "display_name": "edruid", "link": "https://stackoverflow.com/users/4083475/edruid"}, "is_accepted": false, "score": 1, "last_activity_date": 1488382938, "creation_date": 1488382938, "answer_id": 42536025, "question_id": 42532033, "link": "https://stackoverflow.com/questions/42532033/saves-nil-for-daterange-for-same-date-rails-4-2-7/42536025#42536025", "title": "Saves nil for daterange for same date Rails 4.2.7", "body": "<p>Dateranges only operates on dates, that is your beginning of day and end of day will both be truncated to <code>today</code> which creates an empty range (which apparently is translated as <code>nil</code>)</p>\n\n<p>What you most likely mean is to use Date.today (inclusive) to Date.tomorrow (exclusive)</p>\n\n<p>If you actually want to store the times you should use a tsrange.</p>\n"}], "owner": {"reputation": 694, "user_id": 4247633, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b489ee8b00fb53a9c49bef05f7b71120?s=128&d=identicon&r=PG", "display_name": "Deepak Kabbur", "link": "https://stackoverflow.com/users/4247633/deepak-kabbur"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 58, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1488382938, "creation_date": 1488372083, "question_id": 42532033, "link": "https://stackoverflow.com/questions/42532033/saves-nil-for-daterange-for-same-date-rails-4-2-7", "title": "Saves nil for daterange for same date Rails 4.2.7", "body": "<p>I am using\nRails : 4.2.7 and\nPostgress : 9.3</p>\n\n<p>Migration</p>\n\n<pre><code>def change\n  create_table :category do |t|\n    t.float :price\n    t.daterange :date_range\n    t.timestamps null: false\n  end\nend\n</code></pre>\n\n<p>When I am trying to save date_range with same date</p>\n\n<pre><code>from = Date.today.beginning_of_day\nto = Date.today.end_of_day \n\nCategory.create(date_range: from..to)\n</code></pre>\n\n<p>saves <code>nil</code> for <code>date_range</code>.</p>\n\n<p>Its work perfectly if dates are different like</p>\n\n<pre><code>from = Date.yesterday.beginning_of_day\nto = Date.today.end_of_day\n</code></pre>\n\n<p>One solution is create separate columns from and to.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "activerecord", "devise"], "comments": [{"owner": {"reputation": 12965, "user_id": 2463570, "user_type": "registered", "accept_rate": 55, "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Rajarshi Das", "link": "https://stackoverflow.com/users/2463570/rajarshi-das"}, "edited": false, "score": 0, "creation_date": 1488366602, "post_id": 42530087, "comment_id": 72195944, "body": "it is your custom controller so Please post the controllers code"}, {"owner": {"reputation": 33, "user_id": 6838276, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-x6TbRxwTtrw/AAAAAAAAAAI/AAAAAAAACCs/aMoCXUfg0go/photo.jpg?sz=128", "display_name": "Joshua Waiswa", "link": "https://stackoverflow.com/users/6838276/joshua-waiswa"}, "reply_to_user": {"reputation": 12965, "user_id": 2463570, "user_type": "registered", "accept_rate": 55, "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Rajarshi Das", "link": "https://stackoverflow.com/users/2463570/rajarshi-das"}, "edited": false, "score": 0, "creation_date": 1488366648, "post_id": 42530087, "comment_id": 72195977, "body": "In the controller, am inheriting the Devise sessions Controller..So there is nothing in the controller really..     <code>class Businesses::SessionsController &lt; Devise::SessionsController     protected   def after_sign_in_path_for(resource)     business_dashboard_path   end   end</code>"}, {"owner": {"reputation": 12965, "user_id": 2463570, "user_type": "registered", "accept_rate": 55, "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Rajarshi Das", "link": "https://stackoverflow.com/users/2463570/rajarshi-das"}, "edited": false, "score": 0, "creation_date": 1488366780, "post_id": 42530087, "comment_id": 72196068, "body": "Please post the codes"}, {"owner": {"reputation": 12965, "user_id": 2463570, "user_type": "registered", "accept_rate": 55, "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Rajarshi Das", "link": "https://stackoverflow.com/users/2463570/rajarshi-das"}, "edited": false, "score": 0, "creation_date": 1488366807, "post_id": 42530087, "comment_id": 72196083, "body": "you need to permit the paramters"}, {"owner": {"reputation": 12965, "user_id": 2463570, "user_type": "registered", "accept_rate": 55, "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Rajarshi Das", "link": "https://stackoverflow.com/users/2463570/rajarshi-das"}, "edited": false, "score": 0, "creation_date": 1488367346, "post_id": 42530087, "comment_id": 72196444, "body": "in your views you using <code>:business</code> why is there any reason for chnage it the resource ?? also please follow <a href=\"http://stackoverflow.com/questions/16379554/strong-parameters-with-rails-and-devise\" title=\"strong parameters with rails and devise\">stackoverflow.com/questions/16379554/&hellip;</a>"}, {"owner": {"reputation": 33, "user_id": 6838276, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-x6TbRxwTtrw/AAAAAAAAAAI/AAAAAAAACCs/aMoCXUfg0go/photo.jpg?sz=128", "display_name": "Joshua Waiswa", "link": "https://stackoverflow.com/users/6838276/joshua-waiswa"}, "reply_to_user": {"reputation": 12965, "user_id": 2463570, "user_type": "registered", "accept_rate": 55, "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Rajarshi Das", "link": "https://stackoverflow.com/users/2463570/rajarshi-das"}, "edited": false, "score": 0, "creation_date": 1488367380, "post_id": 42530087, "comment_id": 72196462, "body": "Ok, after permitting the parameter, the unpermited parameters issue is done, but am still failing to sign in.."}, {"owner": {"reputation": 12965, "user_id": 2463570, "user_type": "registered", "accept_rate": 55, "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Rajarshi Das", "link": "https://stackoverflow.com/users/2463570/rajarshi-das"}, "edited": false, "score": 0, "creation_date": 1488367432, "post_id": 42530087, "comment_id": 72196495, "body": "what is your resource &#39;User or Business ?"}, {"owner": {"reputation": 33, "user_id": 6838276, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-x6TbRxwTtrw/AAAAAAAAAAI/AAAAAAAACCs/aMoCXUfg0go/photo.jpg?sz=128", "display_name": "Joshua Waiswa", "link": "https://stackoverflow.com/users/6838276/joshua-waiswa"}, "reply_to_user": {"reputation": 12965, "user_id": 2463570, "user_type": "registered", "accept_rate": 55, "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Rajarshi Das", "link": "https://stackoverflow.com/users/2463570/rajarshi-das"}, "edited": false, "score": 0, "creation_date": 1488367445, "post_id": 42530087, "comment_id": 72196508, "body": "Its a business model, added to devise"}, {"owner": {"reputation": 12965, "user_id": 2463570, "user_type": "registered", "accept_rate": 55, "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Rajarshi Das", "link": "https://stackoverflow.com/users/2463570/rajarshi-das"}, "edited": false, "score": 0, "creation_date": 1488367528, "post_id": 42530087, "comment_id": 72196568, "body": "then in rails console try <code>Business.where(email: &quot;jwaiswa7@gmail.com&quot;).try(:last).valid_password? &quot;your password&quot;</code> check it"}, {"owner": {"reputation": 33, "user_id": 6838276, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-x6TbRxwTtrw/AAAAAAAAAAI/AAAAAAAACCs/aMoCXUfg0go/photo.jpg?sz=128", "display_name": "Joshua Waiswa", "link": "https://stackoverflow.com/users/6838276/joshua-waiswa"}, "reply_to_user": {"reputation": 12965, "user_id": 2463570, "user_type": "registered", "accept_rate": 55, "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Rajarshi Das", "link": "https://stackoverflow.com/users/2463570/rajarshi-das"}, "edited": false, "score": 0, "creation_date": 1488367971, "post_id": 42530087, "comment_id": 72196888, "body": "I get a response true form the rails console..."}, {"owner": {"reputation": 33, "user_id": 6838276, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-x6TbRxwTtrw/AAAAAAAAAAI/AAAAAAAACCs/aMoCXUfg0go/photo.jpg?sz=128", "display_name": "Joshua Waiswa", "link": "https://stackoverflow.com/users/6838276/joshua-waiswa"}, "reply_to_user": {"reputation": 12965, "user_id": 2463570, "user_type": "registered", "accept_rate": 55, "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Rajarshi Das", "link": "https://stackoverflow.com/users/2463570/rajarshi-das"}, "edited": false, "score": 0, "creation_date": 1488370100, "post_id": 42530087, "comment_id": 72198300, "body": "Hi, all, I&#39;ve found the solution to the problem. Someone had changed the authentication_key form email to something else, So I was failing to sign in."}], "owner": {"reputation": 33, "user_id": 6838276, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-x6TbRxwTtrw/AAAAAAAAAAI/AAAAAAAACCs/aMoCXUfg0go/photo.jpg?sz=128", "display_name": "Joshua Waiswa", "link": "https://stackoverflow.com/users/6838276/joshua-waiswa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 964, "favorite_count": 1, "answer_count": 0, "score": 0, "last_activity_date": 1488366450, "creation_date": 1488366450, "question_id": 42530087, "link": "https://stackoverflow.com/questions/42530087/completed-401-unauthorized-in-1ms-activerecord-0-0ms-on-devise-sign-in-sessi", "title": "Completed 401 Unauthorized in 1ms (ActiveRecord: 0.0ms) on Devise sign in (sessions create)", "body": "<p>am relatively new to rails. Please forgive me if this is supposed to be obvious. </p>\n\n<p>Am failing to sign in into my account using devise, I keep getting the error invalid email or password,  but they are the ones I used while creating the account. The server doesn't seam to contact the model for information when I look at the logs. </p>\n\n<pre><code>    Processing by Businesses::SessionsController#create as HTML\n  Parameters: {\"utf8\"=&gt;\"\u2713\", \"authenticity_token\"=&gt;\"PGav1Ca1p0XvayyhzvzN8IVgtHboVhYSTOg2YodI/UUK0VvpdwlmkEUj43hCjEVxgQokocVVMelJxJqMbUc+Dg==\", \"business\"=&gt;{\"email\"=&gt;\"jwaiswa7@gmail.com\", \"password\"=&gt;\"[FILTERED]\"}, \"commit\"=&gt;\"Login\"}\nCompleted 401 Unauthorized in 1ms (ActiveRecord: 0.0ms)\n</code></pre>\n\n<p>That's the response i receive and when the view is being called again, I get the error unpermitted parameter email </p>\n\n<pre><code>Processing by Businesses::SessionsController#new as HTML\n  Parameters: {\"utf8\"=&gt;\"\u2713\", \"authenticity_token\"=&gt;\"PGav1Ca1p0XvayyhzvzN8IVgtHboVhYSTOg2YodI/UUK0VvpdwlmkEUj43hCjEVxgQokocVVMelJxJqMbUc+Dg==\", \"business\"=&gt;{\"email\"=&gt;\"jwaiswa7@gmail.com\", \"password\"=&gt;\"[FILTERED]\"}, \"commit\"=&gt;\"Login\"}\nUnpermitted parameter: email\n</code></pre>\n\n<p>Any help on how to go around this is highly appreciated. </p>\n"}, {"tags": ["ruby-on-rails", "ruby", "actionmailer"], "comments": [{"owner": {"reputation": 19261, "user_id": 4758119, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/F4dJY.jpg?s=128&g=1", "display_name": "Deepak Mahakale", "link": "https://stackoverflow.com/users/4758119/deepak-mahakale"}, "edited": false, "score": 0, "creation_date": 1488363977, "post_id": 42529044, "comment_id": 72194129, "body": "do you have this line <code>mail(to: @receiver, subject: @subject)</code> in mailer?"}, {"owner": {"reputation": 19261, "user_id": 4758119, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/F4dJY.jpg?s=128&g=1", "display_name": "Deepak Mahakale", "link": "https://stackoverflow.com/users/4758119/deepak-mahakale"}, "edited": false, "score": 0, "creation_date": 1488363993, "post_id": 42529044, "comment_id": 72194141, "body": "or you are running it directly on console"}, {"owner": {"reputation": 1812, "user_id": 4627335, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/kZFZA.jpg?s=128&g=1", "display_name": "ashvin", "link": "https://stackoverflow.com/users/4627335/ashvin"}, "edited": false, "score": 0, "creation_date": 1488364000, "post_id": 42529044, "comment_id": 72194143, "body": "Do you have mailer for this?"}, {"owner": {"reputation": 1059, "user_id": 3576036, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/f1fb048a732909f50ff2e2a267119640?s=128&d=identicon&r=PG&f=1", "display_name": "user3576036", "link": "https://stackoverflow.com/users/3576036/user3576036"}, "edited": false, "score": 0, "creation_date": 1488364124, "post_id": 42529044, "comment_id": 72194221, "body": "I&#39;m first trying to run it on console"}], "answers": [{"comments": [{"owner": {"reputation": 1059, "user_id": 3576036, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/f1fb048a732909f50ff2e2a267119640?s=128&d=identicon&r=PG&f=1", "display_name": "user3576036", "link": "https://stackoverflow.com/users/3576036/user3576036"}, "edited": false, "score": 0, "creation_date": 1488364226, "post_id": 42529258, "comment_id": 72194301, "body": "On rails console?"}, {"owner": {"reputation": 1812, "user_id": 4627335, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/kZFZA.jpg?s=128&g=1", "display_name": "ashvin", "link": "https://stackoverflow.com/users/4627335/ashvin"}, "reply_to_user": {"reputation": 1059, "user_id": 3576036, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/f1fb048a732909f50ff2e2a267119640?s=128&d=identicon&r=PG&f=1", "display_name": "user3576036", "link": "https://stackoverflow.com/users/3576036/user3576036"}, "edited": false, "score": 0, "creation_date": 1488364288, "post_id": 42529258, "comment_id": 72194347, "body": "Yes, run in <code>rails console</code>"}, {"owner": {"reputation": 1059, "user_id": 3576036, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/f1fb048a732909f50ff2e2a267119640?s=128&d=identicon&r=PG&f=1", "display_name": "user3576036", "link": "https://stackoverflow.com/users/3576036/user3576036"}, "edited": false, "score": 0, "creation_date": 1488365995, "post_id": 42529258, "comment_id": 72195554, "body": "Can I call this method in a controller where I actually need this function ?"}, {"owner": {"reputation": 1812, "user_id": 4627335, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/kZFZA.jpg?s=128&g=1", "display_name": "ashvin", "link": "https://stackoverflow.com/users/4627335/ashvin"}, "reply_to_user": {"reputation": 1059, "user_id": 3576036, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/f1fb048a732909f50ff2e2a267119640?s=128&d=identicon&r=PG&f=1", "display_name": "user3576036", "link": "https://stackoverflow.com/users/3576036/user3576036"}, "edited": false, "score": 0, "creation_date": 1488366065, "post_id": 42529258, "comment_id": 72195601, "body": "For that you have to create mailer."}, {"owner": {"reputation": 1812, "user_id": 4627335, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/kZFZA.jpg?s=128&g=1", "display_name": "ashvin", "link": "https://stackoverflow.com/users/4627335/ashvin"}, "reply_to_user": {"reputation": 1059, "user_id": 3576036, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/f1fb048a732909f50ff2e2a267119640?s=128&d=identicon&r=PG&f=1", "display_name": "user3576036", "link": "https://stackoverflow.com/users/3576036/user3576036"}, "edited": false, "score": 0, "creation_date": 1488366090, "post_id": 42529258, "comment_id": 72195624, "body": "Refer this link <a href=\"http://guides.rubyonrails.org/action_mailer_basics.html\" rel=\"nofollow noreferrer\">guides.rubyonrails.org/action_mailer_basics.html</a>"}], "tags": [], "owner": {"reputation": 1812, "user_id": 4627335, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/kZFZA.jpg?s=128&g=1", "display_name": "ashvin", "link": "https://stackoverflow.com/users/4627335/ashvin"}, "is_accepted": true, "score": 11, "last_activity_date": 1488364136, "creation_date": 1488364136, "answer_id": 42529258, "question_id": 42529044, "link": "https://stackoverflow.com/questions/42529044/nomethoderror-undefined-method-mail-for-mainobject-on-rails-console/42529258#42529258", "title": "NoMethodError: undefined method `mail&#39; for main:Object on rails console", "body": "<p>You can test mail using following way</p>\n\n<pre><code>ActionMailer::Base.mail(from: \"test@example.co\", to: @receiver, subject: @subject, body: \"Test\").deliver\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 865, "user_id": 674840, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9fadc01371e9e25eab561dc0ef3367c1?s=128&d=identicon&r=PG", "display_name": "kronn", "link": "https://stackoverflow.com/users/674840/kronn"}, "is_accepted": false, "score": 1, "last_activity_date": 1488365190, "creation_date": 1488365190, "answer_id": 42529628, "question_id": 42529044, "link": "https://stackoverflow.com/questions/42529044/nomethoderror-undefined-method-mail-for-mainobject-on-rails-console/42529628#42529628", "title": "NoMethodError: undefined method `mail&#39; for main:Object on rails console", "body": "<p>Rails sets up a lot of convenience so that you can e.g. send mails from the controller easily.</p>\n\n<p>In the console, you are not in the context of a controller, therefore you have not set this up already. The same would go for view-helpers.</p>\n\n<p>In order to use the mail-method, you need to tell Ruby where to look for it. </p>\n\n<p>It should be enough to send the mail like this:</p>\n\n<pre><code>ActionMailer::Base.mail(from: \"test@example.co\", to: @receiver, subject: @subject, body: \"Test\").deliver\n</code></pre>\n\n<p>Keep in mind that you can also use different <code>delivery_method</code>s, if you just want to test the mail-generation, but not yet the integration with your SMTP.</p>\n"}], "owner": {"reputation": 1059, "user_id": 3576036, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/f1fb048a732909f50ff2e2a267119640?s=128&d=identicon&r=PG&f=1", "display_name": "user3576036", "link": "https://stackoverflow.com/users/3576036/user3576036"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3238, "favorite_count": 0, "accepted_answer_id": 42529258, "answer_count": 2, "score": 3, "last_activity_date": 1488365190, "creation_date": 1488363624, "question_id": 42529044, "link": "https://stackoverflow.com/questions/42529044/nomethoderror-undefined-method-mail-for-mainobject-on-rails-console", "title": "NoMethodError: undefined method `mail&#39; for main:Object on rails console", "body": "<p>I am trying to test the working of mailer. Normally on rails I first test my code logic on console level and then once it is successful I put it into the real source code. I am trying to do the same while working on ApplicationMailer. I followed some other solution and first ran the following on rails console to first set up the ActionMailer</p>\n\n<pre><code>ActionMailer::Base.delivery_method = :smtp \nActionMailer::Base.smtp_settings = {\n  address: 'smtp.gmail.com', \n  port: 587, \n  domain: 'gmail.com',\n  authentication: 'plain', \n  enable_starttls_auto: true, \n  user_name: '***********',\n  password: '******'\n}\n</code></pre>\n\n<p>and then I ran my code:</p>\n\n<pre><code>y.include? x\n  if true\n    @receiver = Model.where(category_id: \"#{x}\").pluck(:email)\n    mail(to: @receiver, subject: @subject)\n  end\n</code></pre>\n\n<p>I'm getting the following error: </p>\n\n<pre><code>NoMethodError: undefined method `mail' for main:Object\n    from (irb):19\n</code></pre>\n\n<p>Could somebody please tell me how make this work on rails console?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "caching", "heroku", "memcached"], "owner": {"reputation": 1402, "user_id": 609489, "user_type": "registered", "accept_rate": 26, "profile_image": "https://www.gravatar.com/avatar/fef05b31d37c679848a1958c21e5c9a1?s=128&d=identicon&r=PG", "display_name": "lightsaber", "link": "https://stackoverflow.com/users/609489/lightsaber"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 148, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1488363372, "creation_date": 1488363372, "question_id": 42528945, "link": "https://stackoverflow.com/questions/42528945/rails-caching-action-caching-or-http-caching-or-both-how-to-invalidate-cache", "title": "Rails caching: Action caching or HTTP caching or Both? How to invalidate cache", "body": "<p>I'm using rails 4.2.7 and by default, there is no action caching or page caching, and it'll be running on Heroku which doesn't support page caching.  So, I'm using <a href=\"https://github.com/rails/actionpack-action_caching\" rel=\"nofollow noreferrer\">https://github.com/rails/actionpack-action_caching</a> gem for action caching.</p>\n\n<p>My question is how should I invalidate action caching? I'm using Memcached (memcachier) as cache store<br>\n 1. Should I use cache_sweepers(observers), which I think is not supported on rails 5 to clear cache<br>\n 2. Clear cache from controller action by using the expire_action method, but the content is added via rails_admin and a different controller which only contains the index and show actions serves the content to visitors. So, I have clear action from rails_admin or from the model if it's possible.<br>\n 3. <strong>Auto-expiring cache key like fragment cache</strong> Create unique key based on the various model object which will be shown on the page and their cache_key, this way key will auto expire when the object is changed, similar to how fragment cache works. I tend to use this approach by passing a hash as <code>cache_path</code></p>\n\n<p>I'm also using HTTP cache using <code>fresh_when</code> and CloudFlare as CDN, should I use proxy_cache using Memcached or I should not since I'm using CloudFlare and it'll be the repetition of the same. Do you recommend to only use this HTTP cache or use it with action_caching or only use action_caching?</p>\n"}, {"tags": ["ruby", "eventmachine", "em-http-request"], "comments": [{"owner": {"reputation": 30418, "user_id": 823617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DmWH1.png?s=128&g=1", "display_name": "Casper", "link": "https://stackoverflow.com/users/823617/casper"}, "edited": false, "score": 1, "creation_date": 1488359627, "post_id": 42526967, "comment_id": 72190934, "body": "Can&#39;t you just rescue the failed attempts and retry? Also, you are sure this is not some throttling issue on Amazon?"}, {"owner": {"reputation": 88, "user_id": 4218742, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/9a81b8f60bcdb73eab3b82a63fa6d900?s=128&d=identicon&r=PG&f=1", "display_name": "david", "link": "https://stackoverflow.com/users/4218742/david"}, "reply_to_user": {"reputation": 30418, "user_id": 823617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DmWH1.png?s=128&g=1", "display_name": "Casper", "link": "https://stackoverflow.com/users/823617/casper"}, "edited": false, "score": 0, "creation_date": 1488361020, "post_id": 42526967, "comment_id": 72191951, "body": "no its not a throttling issue . have confirmed it by hitting a dummy api those many times but the issue persists..seems like an issue with event machine"}, {"owner": {"reputation": 268, "user_id": 2338984, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/05ae3478316058f15a307e78b936822a?s=128&d=identicon&r=PG", "display_name": "sig", "link": "https://stackoverflow.com/users/2338984/sig"}, "edited": false, "score": 0, "creation_date": 1488362847, "post_id": 42526967, "comment_id": 72193268, "body": "perhaps amazon thinks its ddos attack? maybe their servers have some limitations for quantity of queries per minute or something like this. Try to use timeouts between your queries or proxy server."}, {"owner": {"reputation": 88, "user_id": 4218742, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/9a81b8f60bcdb73eab3b82a63fa6d900?s=128&d=identicon&r=PG&f=1", "display_name": "david", "link": "https://stackoverflow.com/users/4218742/david"}, "edited": false, "score": 0, "creation_date": 1488364415, "post_id": 42526967, "comment_id": 72194430, "body": "confirmed its not amazon...it happens with any request. I have even tried hitting <a href=\"https://jsonplaceholder.typicode.com\" rel=\"nofollow noreferrer\">jsonplaceholder.typicode.com</a>"}, {"owner": {"reputation": 30418, "user_id": 823617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DmWH1.png?s=128&g=1", "display_name": "Casper", "link": "https://stackoverflow.com/users/823617/casper"}, "edited": false, "score": 0, "creation_date": 1488372668, "post_id": 42526967, "comment_id": 72200128, "body": "Can you create a minimally working code sample that reproduces the issue?"}, {"owner": {"reputation": 88, "user_id": 4218742, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/9a81b8f60bcdb73eab3b82a63fa6d900?s=128&d=identicon&r=PG&f=1", "display_name": "david", "link": "https://stackoverflow.com/users/4218742/david"}, "edited": false, "score": 0, "creation_date": 1488376607, "post_id": 42526967, "comment_id": 72202889, "body": "have updated the question description with a sample code along with some new findings"}, {"owner": {"reputation": 30418, "user_id": 823617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DmWH1.png?s=128&g=1", "display_name": "Casper", "link": "https://stackoverflow.com/users/823617/casper"}, "edited": false, "score": 0, "creation_date": 1488384489, "post_id": 42526967, "comment_id": 72208796, "body": "Tried it on my machine also. No problems."}], "owner": {"reputation": 88, "user_id": 4218742, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/9a81b8f60bcdb73eab3b82a63fa6d900?s=128&d=identicon&r=PG&f=1", "display_name": "david", "link": "https://stackoverflow.com/users/4218742/david"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 138, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1488385269, "creation_date": 1488357743, "last_edit_date": 1488385269, "question_id": 42526967, "link": "https://stackoverflow.com/questions/42526967/is-there-a-solution-for-the-issue-with-multiple-http-calls-returning-connection", "title": "Is there a solution for the issue with multiple http calls returning &quot;connection closed by server&quot;?", "body": "<p>I am attempting to hit the Amazon api with api calls for a bunch of services across all the regions. Approx 200+ API calls.</p>\n\n<p>Using em-http-request to make the calls some complete while some fail with the error \"connection closed by server\"\nI have come across the closest resembling <a href=\"https://github.com/igrigorik/em-http-request/issues/286\" rel=\"nofollow noreferrer\">issue</a> to this </p>\n\n<pre><code>EventMachine.run {\n  150.times {\n    http = EventMachine::HttpRequest.\n             new(\"https://jsonplaceholder.typicode.com/posts\", :keepalive =&gt; false).get\n\n    http.errback  { p \"failed #{http.error}\" }\n    http.callback { p \"success\" }\n  }\n}\n</code></pre>\n\n<p>PS: Interestingly the same code works like a charm on an EC2 instance, but fails with this error \"connection closed by server\" only on my dev machine. Seems like some sort of network issue</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "answers": [{"tags": [], "owner": {"reputation": 172, "user_id": 3549038, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/cDCLQ.jpg?s=128&g=1", "display_name": "stopanko", "link": "https://stackoverflow.com/users/3549038/stopanko"}, "is_accepted": false, "score": 0, "last_activity_date": 1495623387, "creation_date": 1495623387, "answer_id": 44156347, "question_id": 42526841, "link": "https://stackoverflow.com/questions/42526841/require-cannot-load-such-file-rails-commands/44156347#44156347", "title": "`require&#39;: cannot load such file -- rails/commands", "body": "<p>I have gotten the same issue when i putted some gems to project folder to local connect and this gems was with git repos too. So i just removed .git folders from this gems and put theirs to project folder again. It was origin of same issue for me.    </p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 12020794, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9cbc4a1a7b76c00bb51203e5cf6dfbc5?s=128&d=identicon&r=PG&f=1", "display_name": "Sampurna", "link": "https://stackoverflow.com/users/12020794/sampurna"}, "is_accepted": false, "score": 0, "last_activity_date": 1578327513, "creation_date": 1578327513, "answer_id": 59615479, "question_id": 42526841, "link": "https://stackoverflow.com/questions/42526841/require-cannot-load-such-file-rails-commands/59615479#59615479", "title": "`require&#39;: cannot load such file -- rails/commands", "body": "<p>Add rails gem to your project. Or you can do gem install rails</p>\n"}], "owner": {"reputation": 4953, "user_id": 1867854, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/ea603ef86247c91331785befada5430b?s=128&d=identicon&r=PG&f=1", "display_name": "mitchkman", "link": "https://stackoverflow.com/users/1867854/mitchkman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 2713, "favorite_count": 0, "answer_count": 2, "score": 6, "last_activity_date": 1578327513, "creation_date": 1488357303, "question_id": 42526841, "link": "https://stackoverflow.com/questions/42526841/require-cannot-load-such-file-rails-commands", "title": "`require&#39;: cannot load such file -- rails/commands", "body": "<p>I'm new to Rails I just installed rails on MacOS Sierra from scratch using the following commands:</p>\n\n<pre><code>$ gpg --keyserver hkp://keys.gnupg.net --recv-keys 409B6B1796C275462A1703113804BB82D39DC0E3\n\\curl -sSL https://get.rvm.io | bash -s stable --ruby\n$ rvm -v\nrvm 1.29.1 (latest) by Michal Papis, Piotr Kuczynski, Wayne E. Seguin [https://rvm.io/]\n$ ruby -v\nruby 2.4.0p0 (2016-12-24 revision 57164) [x86_64-darwin16]\n$ gem install rails bundler\n$ bundler -v\nBundler version 1.14.5\n</code></pre>\n\n<p>But rails throws this error:</p>\n\n<pre><code>$ rails -v\nbin/rails:9:in `require': cannot load such file -- rails/commands (LoadError)\n    from bin/rails:9:in `&lt;main&gt;'\n</code></pre>\n\n<p>This is my PATH:</p>\n\n<pre><code>$ echo $PATH\n/usr/local/bin:/usr/bin:/bin:/usr/sbin:/sbin:/opt/X11/bin:/usr/local/go/bin\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "acts-as-taggable-on"], "comments": [{"owner": {"reputation": 2707, "user_id": 1540290, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/02f9d39d23f7ce35ec2cc4332ac1dafc?s=128&d=identicon&r=PG", "display_name": "Lukasz Muzyka", "link": "https://stackoverflow.com/users/1540290/lukasz-muzyka"}, "edited": false, "score": 0, "creation_date": 1488357043, "post_id": 42526569, "comment_id": 72189247, "body": "Not sure if I understand. Are you asking how to make links?"}, {"owner": {"reputation": 483, "user_id": 7474561, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc0cb51bd61ff4715e3bec92f79f5f46?s=128&d=identicon&r=PG&f=1", "display_name": "KcUS_unico", "link": "https://stackoverflow.com/users/7474561/kcus-unico"}, "edited": false, "score": 0, "creation_date": 1488358442, "post_id": 42526569, "comment_id": 72190156, "body": "for links you can use the link_to helper.....the gem says to make a link like this: &lt;%= link_to tag.name, { :action =&gt; :tag, :id =&gt; tag.name }, :class =&gt; css_class %&gt;"}, {"owner": {"reputation": 11, "user_id": 7547479, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8c1c043d99928d43ed874afbaf218d57?s=128&d=identicon&r=PG&f=1", "display_name": "tokyo.a", "link": "https://stackoverflow.com/users/7547479/tokyo-a"}, "edited": false, "score": 0, "creation_date": 1488358470, "post_id": 42526569, "comment_id": 72190178, "body": "yes. i want to make tag links."}, {"owner": {"reputation": 11, "user_id": 7547479, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8c1c043d99928d43ed874afbaf218d57?s=128&d=identicon&r=PG&f=1", "display_name": "tokyo.a", "link": "https://stackoverflow.com/users/7547479/tokyo-a"}, "edited": false, "score": 0, "creation_date": 1488358720, "post_id": 42526569, "comment_id": 72190328, "body": "i tried <code>&lt;%= link_to tag.name, { :action =&gt; :tag, :id =&gt; tag.name }, :class =&gt; css_class %&gt;</code> but <code>wrong number of arguments (0 for 1..4)</code>  error displayed."}, {"owner": {"reputation": 483, "user_id": 7474561, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc0cb51bd61ff4715e3bec92f79f5f46?s=128&d=identicon&r=PG&f=1", "display_name": "KcUS_unico", "link": "https://stackoverflow.com/users/7474561/kcus-unico"}, "edited": false, "score": 0, "creation_date": 1488359088, "post_id": 42526569, "comment_id": 72190589, "body": "Sorry, I created an answer, the comment has just been copied and does not necessarily work for your code, too."}, {"owner": {"reputation": 483, "user_id": 7474561, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc0cb51bd61ff4715e3bec92f79f5f46?s=128&d=identicon&r=PG&f=1", "display_name": "KcUS_unico", "link": "https://stackoverflow.com/users/7474561/kcus-unico"}, "edited": false, "score": 0, "creation_date": 1488359212, "post_id": 42526569, "comment_id": 72190680, "body": "If your post your controller method , too and tell us where you want to link_to what action we can help you a little bit better....it&#39;s not so clear now. thanks"}, {"owner": {"reputation": 11, "user_id": 7547479, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8c1c043d99928d43ed874afbaf218d57?s=128&d=identicon&r=PG&f=1", "display_name": "tokyo.a", "link": "https://stackoverflow.com/users/7547479/tokyo-a"}, "edited": false, "score": 0, "creation_date": 1488359832, "post_id": 42526569, "comment_id": 72191087, "body": "I want to link_to each tags#show."}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 7547479, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8c1c043d99928d43ed874afbaf218d57?s=128&d=identicon&r=PG&f=1", "display_name": "tokyo.a", "link": "https://stackoverflow.com/users/7547479/tokyo-a"}, "edited": false, "score": 0, "creation_date": 1488359482, "post_id": 42527419, "comment_id": 72190838, "body": "Thank you so much KcUS_unico.  i add two tags and then tried above code but <code>wrong number of arguments (1 for 2)</code> error displayed."}, {"owner": {"reputation": 483, "user_id": 7474561, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc0cb51bd61ff4715e3bec92f79f5f46?s=128&d=identicon&r=PG&f=1", "display_name": "KcUS_unico", "link": "https://stackoverflow.com/users/7474561/kcus-unico"}, "reply_to_user": {"reputation": 11, "user_id": 7547479, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8c1c043d99928d43ed874afbaf218d57?s=128&d=identicon&r=PG&f=1", "display_name": "tokyo.a", "link": "https://stackoverflow.com/users/7547479/tokyo-a"}, "edited": false, "score": 0, "creation_date": 1488360225, "post_id": 42527419, "comment_id": 72191368, "body": "try: &lt;% @post.tag_list.each do |tag| %&gt; &lt;%= link_to tag, tag %&gt; &lt;%end%&gt;"}, {"owner": {"reputation": 11, "user_id": 7547479, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8c1c043d99928d43ed874afbaf218d57?s=128&d=identicon&r=PG&f=1", "display_name": "tokyo.a", "link": "https://stackoverflow.com/users/7547479/tokyo-a"}, "edited": false, "score": 0, "creation_date": 1488360406, "post_id": 42527419, "comment_id": 72191495, "body": "this code looks work. but this link path to (.../posts/&quot;tag.name&quot;). i want to path to (.../tags/&quot;tag.name&quot;). Thank you so much KcUS_unico."}, {"owner": {"reputation": 483, "user_id": 7474561, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc0cb51bd61ff4715e3bec92f79f5f46?s=128&d=identicon&r=PG&f=1", "display_name": "KcUS_unico", "link": "https://stackoverflow.com/users/7474561/kcus-unico"}, "reply_to_user": {"reputation": 11, "user_id": 7547479, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8c1c043d99928d43ed874afbaf218d57?s=128&d=identicon&r=PG&f=1", "display_name": "tokyo.a", "link": "https://stackoverflow.com/users/7547479/tokyo-a"}, "edited": false, "score": 0, "creation_date": 1488360585, "post_id": 42527419, "comment_id": 72191647, "body": "Ya, you need than to have a route for this action in your routes.rb. Do you have that?"}, {"owner": {"reputation": 11, "user_id": 7547479, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8c1c043d99928d43ed874afbaf218d57?s=128&d=identicon&r=PG&f=1", "display_name": "tokyo.a", "link": "https://stackoverflow.com/users/7547479/tokyo-a"}, "edited": false, "score": 0, "creation_date": 1488360789, "post_id": 42527419, "comment_id": 72191793, "body": "thank you KcUS! i just update my <b>routes.rb</b> to above."}, {"owner": {"reputation": 483, "user_id": 7474561, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc0cb51bd61ff4715e3bec92f79f5f46?s=128&d=identicon&r=PG&f=1", "display_name": "KcUS_unico", "link": "https://stackoverflow.com/users/7474561/kcus-unico"}, "reply_to_user": {"reputation": 11, "user_id": 7547479, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8c1c043d99928d43ed874afbaf218d57?s=128&d=identicon&r=PG&f=1", "display_name": "tokyo.a", "link": "https://stackoverflow.com/users/7547479/tokyo-a"}, "edited": false, "score": 0, "creation_date": 1488360874, "post_id": 42527419, "comment_id": 72191853, "body": "Well, what you need is basically an &#39;index&#39; and or &#39;show&#39; action for all you tags. So when you want to link to all tags that exist you can try: &lt;%= @tags.map{|tag| link_to(tag.name,tag )}.join(&#39; , &#39;) %&gt; for this you need @tags = Tag.all in your controller action posts#show or whereever you put this"}, {"owner": {"reputation": 483, "user_id": 7474561, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc0cb51bd61ff4715e3bec92f79f5f46?s=128&d=identicon&r=PG&f=1", "display_name": "KcUS_unico", "link": "https://stackoverflow.com/users/7474561/kcus-unico"}, "reply_to_user": {"reputation": 11, "user_id": 7547479, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8c1c043d99928d43ed874afbaf218d57?s=128&d=identicon&r=PG&f=1", "display_name": "tokyo.a", "link": "https://stackoverflow.com/users/7547479/tokyo-a"}, "edited": false, "score": 0, "creation_date": 1488360975, "post_id": 42527419, "comment_id": 72191923, "body": "GREAT! within tags#index you can &lt;% tags.each do |tag| %&gt; &lt;%= link_to tag.name, tag %&gt;&lt;%end%&gt; which will lead you to the #show action of tags...but for this to work you also need a tags_controller and the two templates....."}, {"owner": {"reputation": 483, "user_id": 7474561, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc0cb51bd61ff4715e3bec92f79f5f46?s=128&d=identicon&r=PG&f=1", "display_name": "KcUS_unico", "link": "https://stackoverflow.com/users/7474561/kcus-unico"}, "reply_to_user": {"reputation": 11, "user_id": 7547479, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8c1c043d99928d43ed874afbaf218d57?s=128&d=identicon&r=PG&f=1", "display_name": "tokyo.a", "link": "https://stackoverflow.com/users/7547479/tokyo-a"}, "edited": false, "score": 0, "creation_date": 1488361171, "post_id": 42527419, "comment_id": 72192063, "body": "In general: you need to call @tags = Tags.all somewhere in your controllers. Than you can loop over tags which each...that can produce you a link of all your tags and if you want to link to tags#show the link must go to an action where you find that specific tag for instance tag = Tag.find(params[:id]). That&#39;s it."}, {"owner": {"reputation": 11, "user_id": 7547479, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8c1c043d99928d43ed874afbaf218d57?s=128&d=identicon&r=PG&f=1", "display_name": "tokyo.a", "link": "https://stackoverflow.com/users/7547479/tokyo-a"}, "edited": false, "score": 0, "creation_date": 1488361748, "post_id": 42527419, "comment_id": 72192468, "body": "finally how can i display link_to in show(post).  i can&#39;t understand what should i write in routes.rb after you said ** you need than to have a route for this action in your routes.rb.**"}, {"owner": {"reputation": 483, "user_id": 7474561, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc0cb51bd61ff4715e3bec92f79f5f46?s=128&d=identicon&r=PG&f=1", "display_name": "KcUS_unico", "link": "https://stackoverflow.com/users/7474561/kcus-unico"}, "reply_to_user": {"reputation": 11, "user_id": 7547479, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8c1c043d99928d43ed874afbaf218d57?s=128&d=identicon&r=PG&f=1", "display_name": "tokyo.a", "link": "https://stackoverflow.com/users/7547479/tokyo-a"}, "edited": false, "score": 0, "creation_date": 1488362200, "post_id": 42527419, "comment_id": 72192810, "body": "Well, I edited my answer a bit. To display all tags in your post#show view you need to initialize all tags in that controller action. So add this line : @tags = Tag.all for the each loop to work"}, {"owner": {"reputation": 11, "user_id": 7547479, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8c1c043d99928d43ed874afbaf218d57?s=128&d=identicon&r=PG&f=1", "display_name": "tokyo.a", "link": "https://stackoverflow.com/users/7547479/tokyo-a"}, "edited": false, "score": 0, "creation_date": 1488362989, "post_id": 42527419, "comment_id": 72193369, "body": "i gotcha. sorry my silly question. i actually wanna add tags by using mecab which separate post to each words. and then if some words match with tags in tag table. then return those or that words to show(post). and it is linked_to each tag#show"}, {"owner": {"reputation": 11, "user_id": 7547479, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8c1c043d99928d43ed874afbaf218d57?s=128&d=identicon&r=PG&f=1", "display_name": "tokyo.a", "link": "https://stackoverflow.com/users/7547479/tokyo-a"}, "edited": false, "score": 0, "creation_date": 1488363053, "post_id": 42527419, "comment_id": 72193422, "body": "so i don&#39;t want to display all tags in tag table. Just only tags which is related to post."}, {"owner": {"reputation": 11, "user_id": 7547479, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8c1c043d99928d43ed874afbaf218d57?s=128&d=identicon&r=PG&f=1", "display_name": "tokyo.a", "link": "https://stackoverflow.com/users/7547479/tokyo-a"}, "edited": false, "score": 0, "creation_date": 1488429993, "post_id": 42527419, "comment_id": 72229586, "body": "hi KcUS_unico. I still try to fix it. however this error show <code>wrong number of arguments (1 for 2)</code>.  now i rewrite <code>@tags = Tags.all </code> this code to <code>@tags = ActsAsTaggableOn::Tag.all</code>, because i use acts_as_taggable_on, so i cant designate like what you said.... thank you"}, {"owner": {"reputation": 483, "user_id": 7474561, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc0cb51bd61ff4715e3bec92f79f5f46?s=128&d=identicon&r=PG&f=1", "display_name": "KcUS_unico", "link": "https://stackoverflow.com/users/7474561/kcus-unico"}, "reply_to_user": {"reputation": 11, "user_id": 7547479, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8c1c043d99928d43ed874afbaf218d57?s=128&d=identicon&r=PG&f=1", "display_name": "tokyo.a", "link": "https://stackoverflow.com/users/7547479/tokyo-a"}, "edited": false, "score": 0, "creation_date": 1488439902, "post_id": 42527419, "comment_id": 72233698, "body": "Hey, I am not sure. I think you know the principe. You need the instances for TAGS and than you can make an each loop and create a link for every TAG. I unfortunately, don&#39;t have an exact answer for you now. Would like to help...but don&#39;t know exact answer. I think you can manage though."}, {"owner": {"reputation": 11, "user_id": 7547479, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8c1c043d99928d43ed874afbaf218d57?s=128&d=identicon&r=PG&f=1", "display_name": "tokyo.a", "link": "https://stackoverflow.com/users/7547479/tokyo-a"}, "edited": false, "score": 0, "creation_date": 1489305524, "post_id": 42527419, "comment_id": 72607162, "body": "hi KcUS_unico.I could display tag_links in post/show.html.erb. thank you. and then now i have new question, could you answer my question&gt;&lt;??? <a href=\"http://stackoverflow.com/questions/42745034/rails-display-post-tag-links-in-tags-show-html-erb-acts-as-taggable-on\" title=\"rails display post tag links in tags show html erb acts as taggable on\">stackoverflow.com/questions/42745034/&hellip;</a>"}], "tags": [], "owner": {"reputation": 483, "user_id": 7474561, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc0cb51bd61ff4715e3bec92f79f5f46?s=128&d=identicon&r=PG&f=1", "display_name": "KcUS_unico", "link": "https://stackoverflow.com/users/7474561/kcus-unico"}, "is_accepted": false, "score": 0, "last_activity_date": 1488440757, "last_edit_date": 1488440757, "creation_date": 1488359048, "answer_id": 42527419, "question_id": 42526569, "link": "https://stackoverflow.com/questions/42526569/display-tag-links-using-acts-as-taggable-on/42527419#42527419", "title": "Display tag links using acts_as_taggable_on", "body": "<p>It is not so sure what you are trying to achieve, and it might help if you post your controller , too. </p>\n\n<p>However, displaying links can be achieved in rails by using the link_to helper </p>\n\n<pre><code>&lt;% = link_to 'text', some_path %&gt;\n</code></pre>\n\n<p>Your target is to connect the link to your controller action where you handle the 'tags'\nThe gem you mentioned gives you another example of displaying links in views. This might work for your depending on your naming conventions in your controller.  </p>\n\n<pre><code>&lt;% tag_cloud(@tags) do |tag| %&gt;\n  &lt;%= link_to tag.name, { :action =&gt; :tag, :id =&gt; tag.name }, :class =&gt; 'css_class' %&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>In general: you need to call </p>\n\n<pre><code>@tags = Tags.all \n</code></pre>\n\n<p>somewhere in your controllers to get all entries for the tags. Than you can loop over tags which each...that can produce you a link of all your tags and if you want to link to tags#show the link must go to an action where you find that specific tag. For example this can be in that action: </p>\n\n<pre><code>@tag = Tag.find(params[:id])\n</code></pre>\n\n<p>. That's it.</p>\n\n<p>OK i edit once again. TRY: </p>\n\n<p>in you post controller#show you can show all tags for that post like so </p>\n\n<pre><code>@post.tags.each do |tag|\n&lt;%= link_to tag.name, tag %&gt;\n</code></pre>\n\n<p>this requires that your tag has attribute \"name\"</p>\n\n<p>in your post#index you can do </p>\n\n<pre><code>&lt;%@post.each do |post|%&gt;\n&lt;%post.tags.each do |tag|%&gt;\n&lt;%= link_to tag.name, tag %&gt;&lt;%end%&gt;&lt;%end%&gt;\n</code></pre>\n\n<p>if you just want all tags to be displayed without post etc. TRY: </p>\n\n<p>in your controller posts#index </p>\n\n<pre><code>@tags = Tag.all \n\n&lt;%@tags.each do |tag|%&gt;\n&lt;%= link_to tag.name, tag %&gt;&lt;%end%&gt;\n</code></pre>\n\n<p>In your current controller action posts#show you will only find the tags for that @post because all you do is finding the post by id. So you will only find tags for that post if the association is correct. </p>\n\n<p>That allows you to do <code>@post.tags.each do |tag|</code>...etc.\n<code>tag</code> than can be used for the link_to helper.<br>\nIf you use \n&lt;%= link_to tag.name, tag %> \nit will show you a link with the tag.name that links to that specific tag for each tag that belongs to the post. </p>\n"}], "owner": {"reputation": 11, "user_id": 7547479, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8c1c043d99928d43ed874afbaf218d57?s=128&d=identicon&r=PG&f=1", "display_name": "tokyo.a", "link": "https://stackoverflow.com/users/7547479/tokyo-a"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 198, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1488440757, "creation_date": 1488356455, "last_edit_date": 1488360746, "question_id": 42526569, "link": "https://stackoverflow.com/questions/42526569/display-tag-links-using-acts-as-taggable-on", "title": "Display tag links using acts_as_taggable_on", "body": "<p>I have a question about acts_as_taggable_on. I'm making a BBS and want to display link tags. However, my website can display only strings not links. So I want to put link to strings.</p>\n\n<p>I want to link_to each tags#show.</p>\n\n<p>Now some tags are saved in <code>Tag</code> table and this table have these column(id, name, created_count)</p>\n\n<p>This is my code:</p>\n\n<p><strong>post.rb</strong></p>\n\n<pre><code>def save_tags\n array = self.check_taggable_word(self.title)\n self.tag_list.add(array, parse: true)\nend\ndef tag_lists\n tag_lists = self.tag_list\nend\ndef check_taggable_word(text)\n ary = Array.new\n nm = Natto::MeCab.new\n nm.parse(text) do |n|\n   ary&lt;&lt;n.surface\n end\n tags = ActsAsTaggableOn::Tag.pluck(:name)\n return ary &amp; tags\nend\n</code></pre>\n\n<p><strong>show.html.erb (post)</strong></p>\n\n<pre><code>  Tag:\n  &lt;% @post.save_tags %&gt;\n  &lt;%= @post.tag_list %&gt;\n</code></pre>\n\n<p><strong>posts_controller.rb</strong></p>\n\n<pre><code>def show\n    @post = Post.find(params[:id])\n    @category = @post.category\nend\n</code></pre>\n\n<p><strong>routes.rb</strong></p>\n\n<pre><code>Rails.application.routes.draw do\n root 'static_pages#home'\n get '/about' =&gt; 'static_pages#about'\n get '/contact' =&gt; 'static_pages#contact'\n resources :categories do\n  resources :posts\n end\n resources :posts do\n  resources :comments\n end\n resources :tags, only: [:index, :show]\nend\n</code></pre>\n"}, {"tags": ["ruby", "refactoring"], "comments": [{"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1488358770, "post_id": 42525823, "comment_id": 72190355, "body": "What&#39;s with all the <code>**</code>&#39;s? You should only include valid Ruby code. (I expect that&#39;s the reason for the downvote.) Also, some readers, myself included, are annoyed when we have to scroll horizontally to read code. How about breaking lines so that&#39;s not needed?"}, {"owner": {"reputation": 6994, "user_id": 623266, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/aab060b3da7fa08ba0b531e2204c6469?s=128&d=identicon&r=PG", "display_name": "chell", "link": "https://stackoverflow.com/users/623266/chell"}, "reply_to_user": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1488360579, "post_id": 42525823, "comment_id": 72191642, "body": "I was trying to bold the items in the methods that were different using the tools provided here to help make it easier to see the differences. I will follow your advice and break the up so its not needed. Apologies."}, {"owner": {"reputation": 91, "user_id": 5620547, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a0392a102582956ebe6d8177270fda32?s=128&d=identicon&r=PG&f=1", "display_name": "harsha-sagar", "link": "https://stackoverflow.com/users/5620547/harsha-sagar"}, "edited": false, "score": 0, "creation_date": 1488369527, "post_id": 42525823, "comment_id": 72219810, "body": "You can keep common set of lines in a one method, The logic that varies can be wrapped as blocks/procs, can be passed as argument on invoking method"}, {"owner": {"reputation": 48049, "user_id": 6419007, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/CwqtX.jpg?s=128&g=1", "display_name": "Eric Duminil", "link": "https://stackoverflow.com/users/6419007/eric-duminil"}, "edited": false, "score": 0, "creation_date": 1488379622, "post_id": 42525823, "comment_id": 72205022, "body": "In which class are those methods defined?"}, {"owner": {"reputation": 6994, "user_id": 623266, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/aab060b3da7fa08ba0b531e2204c6469?s=128&d=identicon&r=PG", "display_name": "chell", "link": "https://stackoverflow.com/users/623266/chell"}, "edited": false, "score": 0, "creation_date": 1488418679, "post_id": 42525823, "comment_id": 72226212, "body": "These methods are defined in the Section class."}], "answers": [{"comments": [{"owner": {"reputation": 6994, "user_id": 623266, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/aab060b3da7fa08ba0b531e2204c6469?s=128&d=identicon&r=PG", "display_name": "chell", "link": "https://stackoverflow.com/users/623266/chell"}, "edited": false, "score": 0, "creation_date": 1488419787, "post_id": 42526135, "comment_id": 72226501, "body": "Thanks very much for your help with this I&#39;m learning a lot from this answer."}], "tags": [], "owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "is_accepted": true, "score": 4, "last_activity_date": 1488355018, "creation_date": 1488355018, "answer_id": 42526135, "question_id": 42525823, "link": "https://stackoverflow.com/questions/42525823/how-to-refactor-this-code-from-two-methods-down-to-one-method/42526135#42526135", "title": "How to refactor this code from two methods down to one method", "body": "<p>I counted three differences. So, these differences should be explicitly declared:</p>\n\n<pre><code>METHODS = {\n  prev: [:previous_element, %i|last last_character|],\n  next: [:next_element, %i|first first_character|]\n}.freeze\n</code></pre>\n\n<p>Now we just pass a parameter to the method:</p>\n\n<pre><code>def space_around_element?(start_element, prev_or_next = :prev)\n    element = start_element.public_send(METHODS[prev_or_next].first)\n    # same code\n    character = element\n               .text\n               .split(/(\\W)/)\n               .reject(&amp;:empty?)\n               .public_send(METHODS[prev_or_next].last.first)\n               .public_send(METHODS[prev_or_next].last.last) \\\n      unless element.nil? \n    # same code\n  end\n</code></pre>\n"}], "owner": {"reputation": 6994, "user_id": 623266, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/aab060b3da7fa08ba0b531e2204c6469?s=128&d=identicon&r=PG", "display_name": "chell", "link": "https://stackoverflow.com/users/623266/chell"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 66, "favorite_count": 0, "accepted_answer_id": 42526135, "answer_count": 1, "score": 0, "last_activity_date": 1488369527, "creation_date": 1488353864, "last_edit_date": 1488361041, "question_id": 42525823, "link": "https://stackoverflow.com/questions/42525823/how-to-refactor-this-code-from-two-methods-down-to-one-method", "title": "How to refactor this code from two methods down to one method", "body": "<p>I have the following two methods that are very similar:</p>\n\n<pre><code>            def space_before_element?(start_element)\n                element = start_element.previous_element\n                until element.nil? ||\n                (element.name == start_element.name || \"r\" &amp;&amp; !element.text.empty?)\n                  element = element.previous_element\n                end\n                character = element\n                           .text\n                           .split(/(\\W)/)\n                           .compact\n                           .reject(&amp;:empty?)\n                           .last\n                           .last_character \\\n                           unless element.nil? \n\n                element.nil? || \n                (character.punctuation? &amp;&amp; !character.hyphen? &amp;&amp; !character.apostrophe?) || \n                character.spaces? \n              end\n\n\n            def space_after_element?(start_element)\n                element = start_element.next_element\n                until element.nil? ||\n                (element.name == start_element.name || \"r\" &amp;&amp; !element.text.empty?)\n                  element = element.next_element\n                end\n                character = element\n                           .text\n                           .split(/(\\W)/)\n                           .compact\n                           .reject(&amp;:empty?)\n                           .last\n                           .first_character \\\n                           unless element.nil? \n\n                element.nil? || \n                (character.punctuation? &amp;&amp; !character.hyphen? &amp;&amp; !character.apostrophe?) || \n                character.spaces? \n              end\n</code></pre>\n\n<p>I can't seem to figure out how to make the necessary changes that would allow me to reduce this down to one method.</p>\n\n<p>Still getting my Ruby skills going.</p>\n\n<p>Any help appreciated.\nRuby 2.2.3</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 37256, "user_id": 736308, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/o5EqQ.jpg?s=128&g=1", "display_name": "cdarke", "link": "https://stackoverflow.com/users/736308/cdarke"}, "edited": false, "score": 0, "creation_date": 1488364052, "post_id": 42524607, "comment_id": 72194174, "body": "Please give an example of the text in <code>id_check.txt</code>."}, {"owner": {"reputation": 11, "user_id": 7607277, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0a4ffd800feaf95f9665e4123cf7649c?s=128&d=identicon&r=PG&f=1", "display_name": "buckind", "link": "https://stackoverflow.com/users/7607277/buckind"}, "reply_to_user": {"reputation": 37256, "user_id": 736308, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/o5EqQ.jpg?s=128&g=1", "display_name": "cdarke", "link": "https://stackoverflow.com/users/736308/cdarke"}, "edited": false, "score": 0, "creation_date": 1488441794, "post_id": 42524607, "comment_id": 72234764, "body": "@cdarke it&#39;s just a string with the post id... It can be something like: &quot;5tlyi2&quot;, &quot;5ta4t2&quot; without quotes, each on newlines."}], "owner": {"reputation": 11, "user_id": 7607277, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0a4ffd800feaf95f9665e4123cf7649c?s=128&d=identicon&r=PG&f=1", "display_name": "buckind", "link": "https://stackoverflow.com/users/7607277/buckind"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 31, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1488349259, "creation_date": 1488349259, "question_id": 42524607, "link": "https://stackoverflow.com/questions/42524607/reading-a-file-for-specific-word-is-not-working-as-intended", "title": "Reading a file for specific word is not working as intended", "body": "<p>I have a file where I save an id of a post of a page that I'm doing requests to and to avoid duplicates in each request I'm saving the post Id to the file and if the id is there I just want the <code>.each</code> loop to break. So far I've been using these methods with a regexp to be more specific, I was just using <code>.grep(\"/#{post[:id]}/\").size &gt; 0</code> and the same one but without <code>.size &gt; 0</code> and they were not working.</p>\n\n<p>Also used <code>IO.readlines</code> &lt; That's what I'm using right now.</p>\n\n<p><code>if File.readlines('id_check.txt').grep(\"/\\b#{post[:id]}\\b/\")</code> and</p>\n\n<p><code>if File.readlines('id_check.txt').grep(\"/\\b#{post[:id]}\\b/\").size &gt; 0</code> are not working.</p>\n\n<p>This is the code that I'm using:</p>\n\n<pre><code># CHECK IF POST ID IS IN TEXT FILE TO AVOID DUPLICATES\n  if IO.readlines('id_check.txt').grep(\"/\\b#{post[:id]}\\b/\").size &gt; 0\n    puts 'Photo already posted'\n    break\n  end\n\n  # WRITES ID OF POST IN TEXT FILE\n  File.open('id_check.txt', 'a') do |f|\n    f.write(\"#{post[:id]}\\n\")\n  end\n\n  # DOWNLOADS IMAGE\n  encapsulated_time = Time.now\n  agent.get(post[:preview][:images][0][:source][:url]).save(\"img/#{encapsulated_time}.jpg\")\n  puts encapsulated_time\n</code></pre>\n"}, {"tags": ["ruby", "rubygems", "versioning"], "answers": [{"tags": [], "owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "is_accepted": true, "score": 1, "last_activity_date": 1488349993, "creation_date": 1488349993, "answer_id": 42524776, "question_id": 42524338, "link": "https://stackoverflow.com/questions/42524338/what-does-the-version-of-a-ruby-gem-have-to-do-with-the-version-of-ruby-used-dur/42524776#42524776", "title": "What does the version of a ruby gem have to do with the version of ruby used during development?", "body": "<p>The ruby version specification is optional, and just used to help developers consume the gem easier. For example there are many 2.3 gems that don't have the <a href=\"http://guides.rubygems.org/specification-reference/#required_ruby_version\" rel=\"nofollow noreferrer\">required_ruby_version</a> set. If you try to run these on 1.9 you might get errors, but they won't explicitly say that the ruby version is wrong, so they'll be harder to debug.</p>\n\n<p>By the way, you can have 2.3 as system ruby - <code>sudo apt-get install ruby2.3</code></p>\n"}], "owner": {"reputation": 6391, "user_id": 2909897, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/LMSiW.jpg?s=128&g=1", "display_name": "mbigras", "link": "https://stackoverflow.com/users/2909897/mbigras"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 127, "favorite_count": 0, "accepted_answer_id": 42524776, "answer_count": 1, "score": -1, "last_activity_date": 1488349993, "creation_date": 1488348116, "question_id": 42524338, "link": "https://stackoverflow.com/questions/42524338/what-does-the-version-of-a-ruby-gem-have-to-do-with-the-version-of-ruby-used-dur", "title": "What does the version of a ruby gem have to do with the version of ruby used during development?", "body": "<p>I've been reading on <a href=\"http://guides.rubygems.org/patterns/#semantic-versioning\" rel=\"nofollow noreferrer\">rubygems.org</a> about leveraging the semantic versioning pattern for Ruby gems.</p>\n\n<p>For example, I might want to use some ruby gem named <code>library</code> that includes all minor updates starting from <code>v2.2</code> up to but not including <code>v3.0</code>. I can add it as a run-time dependency in my <code>gemspec</code> or my <code>Gemfile</code>:</p>\n\n<p>some_gem.gemspec:</p>\n\n<pre><code>spec.add_runtime_dependency 'library','~&gt; 2.2'\n</code></pre>\n\n<p>Gemfile:</p>\n\n<pre><code>gem 'library', '~&gt; 2.2'\n</code></pre>\n\n<p>I also know we can specify which version of ruby we'd like to use using a ruby version management like <a href=\"https://github.com/rbenv/rbenv\" rel=\"nofollow noreferrer\">rbenv</a>.</p>\n\n<p>For example, I've also set the local ruby version to <code>system</code> (on macOS) before with:</p>\n\n<pre><code>rbenv local system\n</code></pre>\n\n<p>Which generated a <code>.ruby-version</code> file in the project root.</p>\n\n<p>I'm confused about what the ruby version a gem author uses has to do with the gem version. Are they related? How, would a gem author manage the version of ruby? Do gem author publish gems for multiple ruby versions?</p>\n\n<p>For example, if an author uses <code>2.3.1</code> to build her gem does that mean someone with only <code>system</code> ruby would not be able to use it?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "activerecord"], "answers": [{"tags": [], "owner": {"reputation": 26, "user_id": 3651154, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mvAvR.jpg?s=128&g=1", "display_name": "Ankit Jain", "link": "https://stackoverflow.com/users/3651154/ankit-jain"}, "is_accepted": false, "score": 1, "last_activity_date": 1488348835, "last_edit_date": 1488348835, "creation_date": 1488347706, "answer_id": 42524250, "question_id": 42524142, "link": "https://stackoverflow.com/questions/42524142/how-to-fetch-attribute-values-from-a-first-or-last-record-in-rails/42524250#42524250", "title": "How to fetch attribute values from a &#39;first&#39; or &#39;last&#39; record in Rails?", "body": "<p>I think you can use:</p>\n\n<pre><code>Equipment.last.try(:category_id)\n</code></pre>\n\n<p>Because last will give you single record and try will prevent you from the exception if record is not found</p>\n"}, {"comments": [{"owner": {"reputation": 12629, "user_id": 4739257, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/MdhEs.jpg?s=128&g=1", "display_name": "Ilya", "link": "https://stackoverflow.com/users/4739257/ilya"}, "edited": false, "score": 0, "creation_date": 1488349706, "post_id": 42524640, "comment_id": 72185474, "body": "one note: if your <code>equipments</code> table is very lage, you&#39;ll fetch in memory a very large array with ids, which is inefficient."}, {"owner": {"reputation": 1023, "user_id": 5502552, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/644c1651396747050a2eb662305f03c8?s=128&d=identicon&r=PG&f=1", "display_name": "DroidNoob", "link": "https://stackoverflow.com/users/5502552/droidnoob"}, "reply_to_user": {"reputation": 12629, "user_id": 4739257, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/MdhEs.jpg?s=128&g=1", "display_name": "Ilya", "link": "https://stackoverflow.com/users/4739257/ilya"}, "edited": false, "score": 0, "creation_date": 1488350196, "post_id": 42524640, "comment_id": 72185689, "body": "Yeah just realized that"}], "tags": [], "owner": {"reputation": 1023, "user_id": 5502552, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/644c1651396747050a2eb662305f03c8?s=128&d=identicon&r=PG&f=1", "display_name": "DroidNoob", "link": "https://stackoverflow.com/users/5502552/droidnoob"}, "is_accepted": false, "score": 2, "last_activity_date": 1488349404, "creation_date": 1488349404, "answer_id": 42524640, "question_id": 42524142, "link": "https://stackoverflow.com/questions/42524142/how-to-fetch-attribute-values-from-a-first-or-last-record-in-rails/42524640#42524640", "title": "How to fetch attribute values from a &#39;first&#39; or &#39;last&#39; record in Rails?", "body": "<p>Your method was right. But you need to pluck <code>:category_id</code> first and then query the last.</p>\n\n<pre><code>Equipment.pluck(:category_id).last\n</code></pre>\n\n<p>This also works</p>\n\n<pre><code>Equipment.last.try(:category_id)\n</code></pre>\n"}], "owner": {"reputation": 1059, "user_id": 3576036, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/f1fb048a732909f50ff2e2a267119640?s=128&d=identicon&r=PG&f=1", "display_name": "user3576036", "link": "https://stackoverflow.com/users/3576036/user3576036"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 342, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1516886335, "creation_date": 1488347287, "last_edit_date": 1488358210, "question_id": 42524142, "link": "https://stackoverflow.com/questions/42524142/how-to-fetch-attribute-values-from-a-first-or-last-record-in-rails", "title": "How to fetch attribute values from a &#39;first&#39; or &#39;last&#39; record in Rails?", "body": "<p>I am trying to fetch a column value of last record in Activerecord,\nfrom following.</p>\n\n<pre><code>2.2.4 :025 &gt;   Equipment.last\n  Equipment Load (1.0ms)  SELECT  `equipment`.* FROM `equipment`  ORDER BY `equipment`.`id` DESC LIMIT 1\n =&gt; #&lt;Equipment id: 7, identifier: \"LID-0000007\", country_id: 99, state_id: 99, city_id: 99, listing_type: 3, title: \"Mix\", category_id: 1, sub_category_id: 2, manufacturer_id: 1, model: \"ds323\", serial_no: \"232\", year: 2011, condition: 4, other_condition: \"\", status: 4, other_status: \"\", price: #&lt;BigDecimal:3d1b1d8,'0.32323E5',9(18)&gt;, weight: nil, weight_units: nil, height: nil, height_units: nil, width: nil, width_units: nil, length: nil, length_units: nil, quantity_available: 1, name_plate_capactiy: nil, name_plate_capactiy_units: \"\", voltage: \"\", frequency: nil, phase: nil, current: \"\", current_units: nil, hours_worked: \"\", place_of_manufacturing: \"\", description: \"\", selling_status: 1, created_at: \"2017-02-28 10:15:43\", updated_at: \"2017-02-28 10:16:30\", user_id: 4, wanted_equipment_id: 5, is_read_after_active: false, slug: \"mix\"&gt; \n</code></pre>\n\n<p>I'm trying to fetch <code>category_id</code> of the last record.</p>\n\n<pre><code>Equipment.last.pluck(:category_id)\n</code></pre>\n\n<p>I think I am doing it wrong. Could somebody please tell me. How it is done?</p>\n"}, {"tags": ["ruby-on-rails", "json", "ruby", "ahoy"], "answers": [{"comments": [{"owner": {"reputation": 3234, "user_id": 994581, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/5ff79a62688297a354a41d772f20a547?s=128&d=identicon&r=PG", "display_name": "yellowreign", "link": "https://stackoverflow.com/users/994581/yellowreign"}, "edited": false, "score": 0, "creation_date": 1488349282, "post_id": 42524078, "comment_id": 72185301, "body": "Yes, I saw a post mentioning that.  When I tried that I received <code>PG::GroupingError: ERROR: column &quot;ahoy_events.id&quot; must appear in the GROUP BY clause or be used in an aggregate function</code>"}, {"owner": {"reputation": 736, "user_id": 5857450, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e8a57b69174426b5faea201c3f8e3ca4?s=128&d=identicon&r=PG&f=1", "display_name": "Jawad Khawaja", "link": "https://stackoverflow.com/users/5857450/jawad-khawaja"}, "reply_to_user": {"reputation": 3234, "user_id": 994581, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/5ff79a62688297a354a41d772f20a547?s=128&d=identicon&r=PG", "display_name": "yellowreign", "link": "https://stackoverflow.com/users/994581/yellowreign"}, "edited": false, "score": 0, "creation_date": 1488350278, "post_id": 42524078, "comment_id": 72185725, "body": "That is understandable. Check this link ( <a href=\"http://bernardoamc.github.io/sql/2015/05/04/group-by-non-aggregate-columns/\" rel=\"nofollow noreferrer\">bernardoamc.github.io/sql/2015/05/04/&hellip;</a> ) for details. You may want to modify your query as per your use case. However, in any case you will have to use <code>properties -&gt;&gt; &#39;id&#39;</code> if you plan to query on the jsonb column."}], "tags": [], "owner": {"reputation": 736, "user_id": 5857450, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e8a57b69174426b5faea201c3f8e3ca4?s=128&d=identicon&r=PG&f=1", "display_name": "Jawad Khawaja", "link": "https://stackoverflow.com/users/5857450/jawad-khawaja"}, "is_accepted": false, "score": 0, "last_activity_date": 1488347022, "creation_date": 1488347022, "answer_id": 42524078, "question_id": 42523267, "link": "https://stackoverflow.com/questions/42523267/rails-querying-a-json-field/42524078#42524078", "title": "Rails - Querying a JSON Field", "body": "<p>If you are using PostgreSQL, I believe that you would have to refer to json columns like this:\n<code>.group(\"properties -&gt;&gt; 'id'\")</code> </p>\n"}], "owner": {"reputation": 3234, "user_id": 994581, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/5ff79a62688297a354a41d772f20a547?s=128&d=identicon&r=PG", "display_name": "yellowreign", "link": "https://stackoverflow.com/users/994581/yellowreign"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 746, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1488347022, "creation_date": 1488342898, "question_id": 42523267, "link": "https://stackoverflow.com/questions/42523267/rails-querying-a-json-field", "title": "Rails - Querying a JSON Field", "body": "<p>In my Rails 5 app, I'm using the <a href=\"https://github.com/ankane/ahoy\" rel=\"nofollow noreferrer\">Ahoy gem</a> which uses a jsonb field (called <code>properties</code>) that I don't know how to query.</p>\n\n<p>A sample of the data in the <code>properties</code> field:</p>\n\n<pre><code>\"{\\\"id\\\":\\\"11\\\"}\"\n</code></pre>\n\n<p>What I'm trying to do is: </p>\n\n<ol>\n<li>Find the records created in the last seven days (using the <code>time</code> field)</li>\n<li>Group the records by the <code>id</code> in the <code>properties</code> field</li>\n<li>Order the records based on which <code>id</code> had the most records</li>\n</ol>\n\n<p>I tried this:</p>\n\n<pre><code>@foo = Ahoy::Event.where(name: \"Viewed Product\").where(time: 7.days.ago..Time.now).group(\"properties(id)\").order('COUNT(\"properties(id)\") DESC')\n</code></pre>\n\n<p>but I received the error, <code>PG::UndefinedColumn: ERROR:  column \"properties(id)\" doe not exist</code></p>\n\n<p>I found this <a href=\"https://github.com/ankane/ahoy/issues/198\" rel=\"nofollow noreferrer\">somewhat similar question</a> in the issues for the gem, so I tried breaking the query into parts:</p>\n\n<pre><code>@foo = Ahoy::Event.where(name: \"Viewed Product\").where(time: 7.days.ago..Time.now)\n@foo.group(\"properties REGEXP '[{,]\\\"id\\\"...).count\n</code></pre>\n\n<p>but then my IDE gives the error <code>unterminated string meets the end of file</code>.</p>\n\n<p>Can someone please help me determine what I'm doing wrong?</p>\n"}, {"tags": ["ruby", "objectid"], "answers": [{"tags": [], "owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "is_accepted": true, "score": 4, "last_activity_date": 1488358424, "last_edit_date": 1495540816, "creation_date": 1488358424, "answer_id": 42527198, "question_id": 42522964, "link": "https://stackoverflow.com/questions/42522964/why-do-ruby-object-ids-for-true-false-and-nil-seem-to-differ-in-windows-vs-ub/42527198#42527198", "title": "Why do Ruby object_ids for true, false, and nil seem to differ in Windows vs. Ubuntu?", "body": "<p>As <a href=\"https://stackoverflow.com/a/15526818/2988\">the accepted answer</a> on the <a href=\"https://stackoverflow.com/q/15506763/2988\">question you linked to</a> says, 0, 20, and 8 are the Object IDs that are used when using flonums on YARV.</p>\n\n<p>So, obviously, your Windows implementation is not using flonums. The most likely reason is that either you are not using YARV (e.g. using JRuby or Rubinius), or you <em>are</em> using YARV, but a 32 bit version.</p>\n\n<p>Note: Object IDs are a private internal implementation detail of the particular Ruby implementation. The version of Ruby you are using is completely irrelevant. What is relevant is which implementation you are using, which version, which commandline options, how you compiled it, what your environment is and so on. It has nothing to do with the language.</p>\n\n<p>Note also: you should never ever rely on the specific value of Object IDs. Object IDs guarantee two things, and only these two things:</p>\n\n<ol>\n<li>An object does not change its Object ID during its lifetime.</li>\n<li>No two objects have the same Object ID at the same time.</li>\n</ol>\n\n<p>Here are some things that are <em>not</em> guaranteed:</p>\n\n<ul>\n<li>It is not guaranteed that an object will have the same Object ID during different runs of the program.</li>\n<li>It is not guaranteed that an Object ID is unique during the runtime of the program, it may be re-used for different objects as long as those objects don't live at the same time.</li>\n<li>It is not guaranteed that the Object ID will follow a certain pattern, e.g. that it is always the memory address of the object (not true on JRuby, for example) or that it is always a specific value (not true for <code>nil</code> and <code>false</code>, as you have just discovered), or that it is always related to the object's value in some way (due to the specific way that YARV optimizes <code>Integer</code>s, the Object ID for small integers will always be 2n+1, but that is only true for small integers (where the definition of \"small\" depends on whether you run a 64 bit or 32 bit version of YARV) and it is only an implementation detail that may change at any moment without notice).</li>\n</ul>\n"}], "owner": {"reputation": 514, "user_id": 6856276, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/ecAKM.jpg?s=128&g=1", "display_name": "globewalldesk", "link": "https://stackoverflow.com/users/6856276/globewalldesk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 141, "favorite_count": 0, "accepted_answer_id": 42527198, "answer_count": 1, "score": 2, "last_activity_date": 1488358424, "creation_date": 1488341005, "last_edit_date": 1495542722, "question_id": 42522964, "link": "https://stackoverflow.com/questions/42522964/why-do-ruby-object-ids-for-true-false-and-nil-seem-to-differ-in-windows-vs-ub", "title": "Why do Ruby object_ids for true, false, and nil seem to differ in Windows vs. Ubuntu?", "body": "<p>In my Windows 10 system running Ruby 2.3.3, irb told me:</p>\n\n<pre><code>false.object_id\n=&gt; 0\ntrue.object_id\n=&gt; 2\nnil.object_id\n=&gt; 4\n</code></pre>\n\n<p>But then on c9.io, in Ubuntu 14.04.3, running Ruby 2.3.0, irb told me:</p>\n\n<pre><code>false.object_id\n=&gt; 0\ntrue.object_id\n=&gt; 20\nnil.object_id\n=&gt; 8\n</code></pre>\n\n<p>Not that this matters (who knows?), but why are these numbers different?</p>\n\n<p>Note: this is not quite the same question as <a href=\"https://stackoverflow.com/questions/15506763/why-was-the-object-id-for-true-and-nil-changed-in-ruby2-0\">this one</a>. They're both Ruby 2.3.</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 8645, "user_id": 368167, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c9596f533dcd61ecf75f150b0d9997b3?s=128&d=identicon&r=PG", "display_name": "Tamer Shlash", "link": "https://stackoverflow.com/users/368167/tamer-shlash"}, "edited": false, "score": 0, "creation_date": 1488341116, "post_id": 42522932, "comment_id": 72182509, "body": "Does it have to be a built-in method?"}, {"owner": {"reputation": 1, "user_id": 7638973, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95a5cd5f84509dfa3e67083a399ad5c7?s=128&d=identicon&r=PG&f=1", "display_name": "maddy", "link": "https://stackoverflow.com/users/7638973/maddy"}, "reply_to_user": {"reputation": 8645, "user_id": 368167, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c9596f533dcd61ecf75f150b0d9997b3?s=128&d=identicon&r=PG", "display_name": "Tamer Shlash", "link": "https://stackoverflow.com/users/368167/tamer-shlash"}, "edited": false, "score": 0, "creation_date": 1488341298, "post_id": 42522932, "comment_id": 72182570, "body": "Any kind of implementation would work. But hoping there would be some method similar to object.combination"}, {"owner": {"reputation": 9602, "user_id": 3607136, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/NRFso.jpg?s=128&g=1", "display_name": "Gagan Gami", "link": "https://stackoverflow.com/users/3607136/gagan-gami"}, "edited": false, "score": 0, "creation_date": 1488353069, "post_id": 42522932, "comment_id": 72187100, "body": "Have a look at <a href=\"http://apidock.com/ruby/Array/combination\" rel=\"nofollow noreferrer\">apidock.com/ruby/Array/combination</a>"}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 2, "creation_date": 1488357108, "post_id": 42522932, "comment_id": 72189294, "body": "These are <a href=\"https://en.wikipedia.org/wiki/Substring\" rel=\"nofollow noreferrer\">substrings</a>, not <a href=\"https://en.wikipedia.org/wiki/Combination\" rel=\"nofollow noreferrer\">combinations</a>."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 7638973, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95a5cd5f84509dfa3e67083a399ad5c7?s=128&d=identicon&r=PG&f=1", "display_name": "maddy", "link": "https://stackoverflow.com/users/7638973/maddy"}, "edited": false, "score": 0, "creation_date": 1488342208, "post_id": 42523072, "comment_id": 72182817, "body": "That worked, Thanks a lot!. I am new to Ruby...Can you please explain us the implementation."}, {"owner": {"reputation": 8645, "user_id": 368167, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c9596f533dcd61ecf75f150b0d9997b3?s=128&d=identicon&r=PG", "display_name": "Tamer Shlash", "link": "https://stackoverflow.com/users/368167/tamer-shlash"}, "reply_to_user": {"reputation": 1, "user_id": 7638973, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95a5cd5f84509dfa3e67083a399ad5c7?s=128&d=identicon&r=PG&f=1", "display_name": "maddy", "link": "https://stackoverflow.com/users/7638973/maddy"}, "edited": false, "score": 0, "creation_date": 1488343124, "post_id": 42523072, "comment_id": 72183065, "body": "@maddy updated, hope that helps. You need to read the descriptions of the linked methods to get a better idea on what&#39;s happening."}, {"owner": {"reputation": 9602, "user_id": 3607136, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/NRFso.jpg?s=128&g=1", "display_name": "Gagan Gami", "link": "https://stackoverflow.com/users/3607136/gagan-gami"}, "edited": false, "score": 0, "creation_date": 1488353308, "post_id": 42523072, "comment_id": 72187237, "body": "@TamerShlash : Instead of <code>Enumberable#each_cons</code> you can use <code>Array#combination</code> also"}, {"owner": {"reputation": 8645, "user_id": 368167, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c9596f533dcd61ecf75f150b0d9997b3?s=128&d=identicon&r=PG", "display_name": "Tamer Shlash", "link": "https://stackoverflow.com/users/368167/tamer-shlash"}, "reply_to_user": {"reputation": 9602, "user_id": 3607136, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/NRFso.jpg?s=128&g=1", "display_name": "Gagan Gami", "link": "https://stackoverflow.com/users/3607136/gagan-gami"}, "edited": false, "score": 0, "creation_date": 1488354341, "post_id": 42523072, "comment_id": 72187755, "body": "@GaganGami &quot;The implementation makes no guarantees about the order in which the combinations are yielded.&quot; does not work with the requirement &quot;preserving the order&quot;."}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 1, "creation_date": 1488357510, "post_id": 42523072, "comment_id": 72189579, "body": "<code>.map { ... }.flatten</code> \u2192 <code>.flat_map { ... }</code>"}], "tags": [], "owner": {"reputation": 8645, "user_id": 368167, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c9596f533dcd61ecf75f150b0d9997b3?s=128&d=identicon&r=PG", "display_name": "Tamer Shlash", "link": "https://stackoverflow.com/users/368167/tamer-shlash"}, "is_accepted": false, "score": 3, "last_activity_date": 1488343081, "last_edit_date": 1488343081, "creation_date": 1488341671, "answer_id": 42523072, "question_id": 42522932, "link": "https://stackoverflow.com/questions/42522932/ruby-string-array-combinations-preserving-order/42523072#42523072", "title": "Ruby string/array combinations preserving order", "body": "<p>Probably not the ideal implementation, but this works:</p>\n\n<pre><code>def combinations(str)\n  items = str.chars\n  (1..items.length).map { |i| items.each_cons(i).map(&amp;:join) }.flatten\nend\n</code></pre>\n\n<p>Also check <a href=\"https://ruby-doc.org/core-2.2.0/Enumerable.html#method-i-each_cons\" rel=\"nofollow noreferrer\"><code>Enumerable#each_cons</code></a>. You can also just add it to the String class like this:</p>\n\n<pre><code>class String\n  def combinations\n    items = self.chars\n    (1..items.length).map { |i| items.each_cons(i).map(&amp;:join) }.flatten\n  end\nend\n\n'abcd'.combinations\n</code></pre>\n\n<p>What is happening:</p>\n\n<ul>\n<li>We make the string an actual array of characters with <a href=\"https://ruby-doc.org/core-2.2.0/String.html#method-i-chars\" rel=\"nofollow noreferrer\"><code>String#chars</code></a>.</li>\n<li>Then for each number <code>i</code> between 1 to the length of the string:\n\n<ul>\n<li>Call <a href=\"https://ruby-doc.org/core-2.2.0/Enumerable.html#method-i-each_cons\" rel=\"nofollow noreferrer\"><code>Enumerable#each_cons</code></a> which basically returns the possible combinations of the length <code>i</code> as an array of characters too. So if <code>i</code> is 2, then the result of <code>items.each_cons(2)</code> will be <code>[ ['a', 'b'], ['b', 'c'], ['c', 'd'] ]</code></li>\n<li>The <code>.map(&amp;:join)</code> part is basically calling <a href=\"https://ruby-doc.org/core-2.2.0/Array.html#method-i-join\" rel=\"nofollow noreferrer\"><code>Array#join</code></a> on each of the elements of that array of arrays, so it becomes <code>['ab', 'bc', 'cd']</code></li>\n</ul></li>\n<li>The result of <code>(1..items.length).map { |i| items.each_cons(i).map(&amp;:join) }</code> is: <code>[ ['a', 'b', 'c', 'd'], ['ab', 'bc', 'cd'], ['abc', 'bcd'], ['abcd'] ]</code> which is an array of arrays. We call <a href=\"https://ruby-doc.org/core-2.2.0/Array.html#method-i-flatten\" rel=\"nofollow noreferrer\"><code>Array#flatten</code></a> on it to make it a simple array (read the flatten link for more).</li>\n</ul>\n"}, {"comments": [{"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 1, "creation_date": 1488358398, "post_id": 42523173, "comment_id": 72190127, "body": "Very clean solution. Although I&#39;d <code>yield</code> each substring instead of printing it, so you can call it via <code>all_combos(&#39;abcd&#39;) { |s| puts s }</code>."}], "tags": [], "owner": {"reputation": 174, "user_id": 6545206, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69f3160121870ed8cf33d58067d37341?s=128&d=identicon&r=PG", "display_name": "Chad K", "link": "https://stackoverflow.com/users/6545206/chad-k"}, "is_accepted": false, "score": 1, "last_activity_date": 1488342307, "creation_date": 1488342307, "answer_id": 42523173, "question_id": 42522932, "link": "https://stackoverflow.com/questions/42522932/ruby-string-array-combinations-preserving-order/42523173#42523173", "title": "Ruby string/array combinations preserving order", "body": "<p>There is no builtin function that does exactly what you're looking for.</p>\n\n<p>String#each_cons looks interesting as Tamer points out.</p>\n\n<p>Here's an alternate solution:</p>\n\n<pre><code>def all_combos(str)\n  1.upto(str.length) do |segment_length|\n    0.upto(str.length - segment_length) do |starting_point|\n      puts str[starting_point, segment_length]\n    end\n  end\nend\n\nall_combos(\"abcd\")\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1488372134, "post_id": 42530739, "comment_id": 72199738, "body": "<code>each_combination</code> might be a better name."}], "tags": [], "owner": {"reputation": 73209, "user_id": 290394, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/d7908f05c89e965f6bc5308ad6f41256?s=128&d=identicon&r=PG", "display_name": "steenslag", "link": "https://stackoverflow.com/users/290394/steenslag"}, "is_accepted": false, "score": 1, "last_activity_date": 1488368403, "creation_date": 1488368403, "answer_id": 42530739, "question_id": 42522932, "link": "https://stackoverflow.com/questions/42522932/ruby-string-array-combinations-preserving-order/42530739#42530739", "title": "Ruby string/array combinations preserving order", "body": "<p>The starting and ending indices of the sub-strings form a pattern of a <em>combination with repetition</em>, for which Ruby does have a built-in method.</p>\n\n<pre><code>class String\n  def all_combinations\n    idx = (0 ... self.size).to_a\n    idx.repeated_combination(2){|i,j| yield self[i..j]}\n  end\nend\n\n\"abcd\".all_combinations{|combo| puts combo}\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 7638973, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95a5cd5f84509dfa3e67083a399ad5c7?s=128&d=identicon&r=PG&f=1", "display_name": "maddy", "link": "https://stackoverflow.com/users/7638973/maddy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 335, "favorite_count": 0, "answer_count": 3, "score": -2, "last_activity_date": 1488368403, "creation_date": 1488340801, "last_edit_date": 1488340950, "question_id": 42522932, "link": "https://stackoverflow.com/questions/42522932/ruby-string-array-combinations-preserving-order", "title": "Ruby string/array combinations preserving order", "body": "<p>I want to find all the combinations of a string preserving the order . Is there any built in method in Ruby to achieve this?</p>\n\n<p>For example, <code>\"abcd\".all_combinations</code> should give the output:</p>\n\n<pre><code>a\nb\nc\nd\nab\nbc\ncd\nabc\nbcd\nabcd\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "enums", "activeadmin", "best-in-place"], "answers": [{"tags": [], "owner": {"reputation": 166, "user_id": 2770433, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JrXcp.jpg?s=128&g=1", "display_name": "andrewhaines", "link": "https://stackoverflow.com/users/2770433/andrewhaines"}, "is_accepted": false, "score": 1, "last_activity_date": 1493985954, "creation_date": 1493985954, "answer_id": 43804519, "question_id": 42522618, "link": "https://stackoverflow.com/questions/42522618/enum-in-dropdown-using-best-in-place-and-activeadmin/43804519#43804519", "title": "enum in dropdown using best_in_place and activeadmin", "body": "<p>I haven't worked with your exact setup, but doing the following helped to allow enum-driven select collections in my project using best_in_place:</p>\n\n<pre><code>best_in_place host, :platform, as: :select, collection: Host.platforms.keys.map { |w| [w, w] }\n</code></pre>\n\n<p>This sets the select value and dropdown item as identical. Or if you want to make it more readable you can do:</p>\n\n<pre><code>Host.platforms.keys.map { |w| [w, w.humanize] }\n</code></pre>\n\n<p>Hopefully that gets you somewhere!</p>\n"}], "owner": {"reputation": 531, "user_id": 4866880, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/8495e16cc4f435c66aad77cf7c77d557?s=128&d=identicon&r=PG&f=1", "display_name": "smanvi12", "link": "https://stackoverflow.com/users/4866880/smanvi12"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 493, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1493985954, "creation_date": 1488338795, "question_id": 42522618, "link": "https://stackoverflow.com/questions/42522618/enum-in-dropdown-using-best-in-place-and-activeadmin", "title": "enum in dropdown using best_in_place and activeadmin", "body": "<p>I am using best_in_place with active admin. And I can seem to get it to work in case of a dropdown of enums.</p>\n\n<p>The enums in use are : </p>\n\n<pre><code>enum day: [MONDAY.to_s, TUESDAY.to_s, WEDNESDAY.to_s, THURSDAY.to_s, FRIDAY.to_s, SATURDAY.to_s, SUNDAY.to_s]\n</code></pre>\n\n<p>each of the constants are just like :</p>\n\n<pre><code>MONDAY = \"monday\"\n</code></pre>\n\n<p>Im trying to use best_in_place on the columns :</p>\n\n<pre><code>column :day do |d|\n  best_in_place d, :day, as: :select, url: [:admin,d], collection: Order.days.enum_for(:each_with_index).collect{|k,index| [k[0], index]}\nend\n</code></pre>\n\n<p>This shows a list of 0, 1, 2, but works as expected. </p>\n\n<p>I have tried variations like :</p>\n\n<pre><code>Order.days\nOrder.days.keys\n</code></pre>\n\n<p>Order.days.keys gives a list of the days. But it does not pick up the already set one. eg. tuesday has been set previously, it shows it as empty. And does not set it either. </p>\n\n<p>I want the dropdown to work with the list of names of the days. Any help? </p>\n"}, {"tags": ["ruby-on-rails", "ruby", "mongodb", "segmentation-fault"], "answers": [{"tags": [], "owner": {"reputation": 594, "user_id": 5051165, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh3.googleusercontent.com/-GwtWi5OOBvs/AAAAAAAAAAI/AAAAAAAAfsg/kqASETNy-G4/photo.jpg?sz=128", "display_name": "Matt Welke", "link": "https://stackoverflow.com/users/5051165/matt-welke"}, "is_accepted": true, "score": 0, "last_activity_date": 1488864889, "creation_date": 1488864889, "answer_id": 42640941, "question_id": 42522423, "link": "https://stackoverflow.com/questions/42522423/segmentation-fault-with-rails-5-app-with-mongoid/42640941#42640941", "title": "Segmentation fault with Rails 5 app with Mongoid", "body": "<p>Solved. This is a bug affecting Ruby 2.4:</p>\n\n<p><a href=\"https://jira.mongodb.org/browse/RUBY-1202\" rel=\"nofollow noreferrer\">https://jira.mongodb.org/browse/RUBY-1202</a></p>\n"}], "owner": {"reputation": 594, "user_id": 5051165, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh3.googleusercontent.com/-GwtWi5OOBvs/AAAAAAAAAAI/AAAAAAAAfsg/kqASETNy-G4/photo.jpg?sz=128", "display_name": "Matt Welke", "link": "https://stackoverflow.com/users/5051165/matt-welke"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 226, "favorite_count": 0, "accepted_answer_id": 42640941, "answer_count": 1, "score": 0, "last_activity_date": 1488864889, "creation_date": 1488337422, "last_edit_date": 1488441358, "question_id": 42522423, "link": "https://stackoverflow.com/questions/42522423/segmentation-fault-with-rails-5-app-with-mongoid", "title": "Segmentation fault with Rails 5 app with Mongoid", "body": "<p>I'm getting a weird issue with Rails that I've never encountered before. I put a Rails 5 app using Mongoid onto Google Compute Engine to play with the platform and I was doing some load testing. I used siege and a custom script I made that sends a request, waits for a response, and then sends another request, looping forever. My script is available here: <a href=\"https://gist.github.com/welkie/bf3efa62bab2194d4b679c1f69957d2a\" rel=\"nofollow noreferrer\">https://gist.github.com/welkie/bf3efa62bab2194d4b679c1f69957d2a</a></p>\n\n<p>The siege test fails 1-4 out of 50 transactions consistently and my script gets back a 500 response after running for about 20-100 request response cycles. The debug logs for Rails have a segmentation fault. That massive error message is available here: <a href=\"https://gist.github.com/welkie/e200760852917c68cc9de650362618d3\" rel=\"nofollow noreferrer\">https://gist.github.com/welkie/e200760852917c68cc9de650362618d3</a></p>\n\n<p>I thought this was a memory or CPU issue so I tried a high CPU GCE instance but the issue persisted. Then I thought it was a GCP issue so I threw the same app onto AWS and I get the exact same behaviour.</p>\n\n<p>Has anybody encountered this before?</p>\n\n<p>Update:</p>\n\n<p>I've since performed a test on my local machine and I am not encountering this problem locally. I mimicked my setup, using Docker locally too. I only encountered it on AWS and GCP.</p>\n\n<p>Update:</p>\n\n<p>I've now also performed another test on GCP but this time without Docker and this time I'm not getting any segfaults. It's still using Puma. At this point the only combination I can pinpoint is using Puma with Docker on a cloud host.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "spree"], "answers": [{"comments": [{"owner": {"reputation": 17, "user_id": 5044920, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-eJE4ZaffNOs/AAAAAAAAAAI/AAAAAAAAAK8/N-cq47Ig3mc/photo.jpg?sz=128", "display_name": "Davi Pereira", "link": "https://stackoverflow.com/users/5044920/davi-pereira"}, "edited": false, "score": 0, "creation_date": 1488337168, "post_id": 42522289, "comment_id": 72181442, "body": "thanks for the help, i try change to your code but now  error is this  <code>Calculator is not a module (TypeError)</code>"}, {"owner": {"reputation": 101, "user_id": 2912314, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bfe15f9811530968ce4b73088c2de32f?s=128&d=identicon&r=PG&f=1", "display_name": "Manh Cuong", "link": "https://stackoverflow.com/users/2912314/manh-cuong"}, "reply_to_user": {"reputation": 17, "user_id": 5044920, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-eJE4ZaffNOs/AAAAAAAAAAI/AAAAAAAAAK8/N-cq47Ig3mc/photo.jpg?sz=128", "display_name": "Davi Pereira", "link": "https://stackoverflow.com/users/5044920/davi-pereira"}, "edited": false, "score": 0, "creation_date": 1488338309, "post_id": 42522289, "comment_id": 72181736, "body": "I&#39;m sorry, Spree already defined Calculator as a class. I edited the answer."}, {"owner": {"reputation": 17, "user_id": 5044920, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-eJE4ZaffNOs/AAAAAAAAAAI/AAAAAAAAAK8/N-cq47Ig3mc/photo.jpg?sz=128", "display_name": "Davi Pereira", "link": "https://stackoverflow.com/users/5044920/davi-pereira"}, "edited": false, "score": 0, "creation_date": 1488340237, "post_id": 42522289, "comment_id": 72182257, "body": "thanks one more time, i tryed to change the code and now the error is this   ``` undefined method `&lt;&lt;&#39; for nil:NilClass (NoMethodError) ```"}, {"owner": {"reputation": 17, "user_id": 5044920, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-eJE4ZaffNOs/AAAAAAAAAAI/AAAAAAAAAK8/N-cq47Ig3mc/photo.jpg?sz=128", "display_name": "Davi Pereira", "link": "https://stackoverflow.com/users/5044920/davi-pereira"}, "edited": false, "score": 0, "creation_date": 1488340735, "post_id": 42522289, "comment_id": 72182404, "body": "config/initializers/spree.rb:21:in <code>&lt;top (required)&gt;&#39;: undefined method </code>&lt;&lt;&#39; for nil:NilClass (NoMethodError) the stack trace is like the class return nill now =/"}, {"owner": {"reputation": 101, "user_id": 2912314, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bfe15f9811530968ce4b73088c2de32f?s=128&d=identicon&r=PG&f=1", "display_name": "Manh Cuong", "link": "https://stackoverflow.com/users/2912314/manh-cuong"}, "reply_to_user": {"reputation": 17, "user_id": 5044920, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-eJE4ZaffNOs/AAAAAAAAAAI/AAAAAAAAAK8/N-cq47Ig3mc/photo.jpg?sz=128", "display_name": "Davi Pereira", "link": "https://stackoverflow.com/users/5044920/davi-pereira"}, "edited": false, "score": 0, "creation_date": 1488341236, "post_id": 42522289, "comment_id": 72182545, "body": "What is the code in line 21? Could you please post the whole content of spree.rb?"}, {"owner": {"reputation": 17, "user_id": 5044920, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-eJE4ZaffNOs/AAAAAAAAAAI/AAAAAAAAAK8/N-cq47Ig3mc/photo.jpg?sz=128", "display_name": "Davi Pereira", "link": "https://stackoverflow.com/users/5044920/davi-pereira"}, "edited": false, "score": 0, "creation_date": 1488342006, "post_id": 42522289, "comment_id": 72182759, "body": "i edit my post with the whole content of spree.rb  and line 21 is   <code>config.spree.calculators.shipping_methods &lt;&lt; Spree::Calculator::Shipping::MyOwnCalculator</code>"}, {"owner": {"reputation": 101, "user_id": 2912314, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bfe15f9811530968ce4b73088c2de32f?s=128&d=identicon&r=PG&f=1", "display_name": "Manh Cuong", "link": "https://stackoverflow.com/users/2912314/manh-cuong"}, "reply_to_user": {"reputation": 17, "user_id": 5044920, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-eJE4ZaffNOs/AAAAAAAAAAI/AAAAAAAAAK8/N-cq47Ig3mc/photo.jpg?sz=128", "display_name": "Davi Pereira", "link": "https://stackoverflow.com/users/5044920/davi-pereira"}, "edited": false, "score": 0, "creation_date": 1488348042, "post_id": 42522289, "comment_id": 72184777, "body": "&quot;config.spree.calculators.shipping_methods&quot; is nil in by the time you use it. May be the tutorial is out of date. Look at the code of spree (<a href=\"https://github.com/spree/spree/blob/master/core/lib/spree/core/engine.rb\" rel=\"nofollow noreferrer\">github.com/spree/spree/blob/master/core/lib/spree/core/&hellip;</a>), I think calculator should be registered with initializer &quot;spree.register.calculators&quot; as in this gist (<a href=\"https://gist.github.com/wrburgess/4600383\" rel=\"nofollow noreferrer\">gist.github.com/wrburgess/4600383</a>)"}], "tags": [], "owner": {"reputation": 101, "user_id": 2912314, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bfe15f9811530968ce4b73088c2de32f?s=128&d=identicon&r=PG&f=1", "display_name": "Manh Cuong", "link": "https://stackoverflow.com/users/2912314/manh-cuong"}, "is_accepted": true, "score": 0, "last_activity_date": 1488338243, "last_edit_date": 1488338243, "creation_date": 1488336493, "answer_id": 42522289, "question_id": 42522017, "link": "https://stackoverflow.com/questions/42522017/error-when-create-a-new-calculator-on-spree-commerce-gem/42522289#42522289", "title": "Error when create a new Calculator on Spree Commerce gem", "body": "<p>Did you defined your class inside module like this:\n<code>\nmodule Spree\n module Calculator::Shipping\n   class MyOwnCalculator &lt; Spree::ShippingCalculator\n    ...\n   end\n  end\nend\n</code></p>\n"}], "owner": {"reputation": 17, "user_id": 5044920, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-eJE4ZaffNOs/AAAAAAAAAAI/AAAAAAAAAK8/N-cq47Ig3mc/photo.jpg?sz=128", "display_name": "Davi Pereira", "link": "https://stackoverflow.com/users/5044920/davi-pereira"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 202, "favorite_count": 0, "accepted_answer_id": 42522289, "answer_count": 1, "score": 0, "last_activity_date": 1488342053, "creation_date": 1488334596, "last_edit_date": 1488342053, "question_id": 42522017, "link": "https://stackoverflow.com/questions/42522017/error-when-create-a-new-calculator-on-spree-commerce-gem", "title": "Error when create a new Calculator on Spree Commerce gem", "body": "<p>I am learning rails and I like to learn by practicing trying to create something real.</p>\n\n<p>\u00a0I'm having some problems trying to create a new calculator to be used in the shipping area of \u200b\u200bspree commerce.</p>\n\n<p>Following this documentation tutorial.</p>\n\n<p><a href=\"http://guides.spreecommerce.org/developer/calculators.html#creating-a-new-calculator\" rel=\"nofollow noreferrer\">http://guides.spreecommerce.org/developer/calculators.html#creating-a-new-calculator</a></p>\n\n<p>Following the tutorial i created this class in this directory.</p>\n\n<pre><code>app/models/spree/calculator/shipping/my_own_calculator.rb\n</code></pre>\n\n<p>My class is this way</p>\n\n<pre><code>class MyOwnCalculator &lt; Spree::ShippingCalculator\n  def self.description\n    Spree.t(:shipping_flat_rate_per_order)\n  end\n\n  def compute_package(package)\n    self.preferred_amount\n  end\n\n  def available?(object)\n    object.currency == \"USD\"\n  end\nend\n</code></pre>\n\n<p>and my file <code>config/initializers/spree.rb</code></p>\n\n<pre><code># Configure Spree Preferences\n#\n# Note: Initializing preferences available within the Admin will overwrite any changes that were made through the user interface when you restart.\n#       If you would like users to be able to update a setting with the Admin it should NOT be set here.\n#\n# Note: If a preference is set here it will be stored within the cache &amp; database upon initialization.\n#       Just removing an entry from this initializer will not make the preference value go away.\n#       Instead you must either set a new value or remove entry, clear cache, and remove database entry.\n#\n# In order to initialize a setting do:\n# config.setting_name = 'new value'\nSpree.config do |config|\n  # Example:\n  # Uncomment to stop tracking inventory levels in the application\n  # config.track_inventory_levels = false\nend\n\nSpree.user_class = \"Spree::User\"\n\nconfig = Rails.application.config\nconfig.spree.calculators.shipping_methods &lt;&lt; Spree::Calculator::Shipping::MyOwnCalculator\n</code></pre>\n\n<p>the error is this: </p>\n\n<pre><code>Unable to autoload constant Spree::Calculator::Shipping::MyOwnCalculator, expected /home/davi/dev/attsalaoruby/app/models/spree/calculator/shipping/my_own_calculator.rb to define it (LoadError)\n</code></pre>\n\n<p>and my stack trace is this way </p>\n\n<pre><code>/.rvm/gems/ruby-2.3.0@5.0.0.1/gems/activesupport-5.0.1/lib/active_support/dependencies.rb:512:in `load_missing_constant': Unable to autoload constant Spree::Calculator::Shipping::MyOwnCalculator, expected /home/davi/dev/attsalaoruby/app/models/spree/calculator/shipping/my_own_calculator.rb to define it (LoadError)\n    from /home/davi/.rvm/gems/ruby-2.3.0@5.0.0.1/gems/activesupport-5.0.1/lib/active_support/dependencies.rb:203:in `const_missing'\n    from /home/davi/dev/attsalaoruby/config/initializers/spree.rb:21:in `&lt;top (required)&gt;'\n    from /home/davi/.rvm/gems/ruby-2.3.0@5.0.0.1/gems/activesupport-5.0.1/lib/active_support/dependencies.rb:287:in `load'\n    from /home/davi/.rvm/gems/ruby-2.3.0@5.0.0.1/gems/activesupport-5.0.1/lib/active_support/dependencies.rb:287:in `block in load'\n    from /home/davi/.rvm/gems/ruby-2.3.0@5.0.0.1/gems/activesupport-5.0.1/lib/active_support/dependencies.rb:259:in `load_dependency'\n    from /home/davi/.rvm/gems/ruby-2.3.0@5.0.0.1/gems/activesupport-5.0.1/lib/active_support/dependencies.rb:287:in `load'\n    from /home/davi/.rvm/gems/ruby-2.3.0@5.0.0.1/gems/railties-5.0.1/lib/rails/engine.rb:648:in `block in load_config_initializer'\n    from /home/davi/.rvm/gems/ruby-2.3.0@5.0.0.1/gems/activesupport-5.0.1/lib/active_support/notifications.rb:166:in `instrument'\n    from /home/davi/.rvm/gems/ruby-2.3.0@5.0.0.1/gems/railties-5.0.1/lib/rails/engine.rb:647:in `load_config_initializer'\n    from /home/davi/.rvm/gems/ruby-2.3.0@5.0.0.1/gems/railties-5.0.1/lib/rails/engine.rb:612:in `block (2 levels) in &lt;class:Engine&gt;'\n    from /home/davi/.rvm/gems/ruby-2.3.0@5.0.0.1/gems/railties-5.0.1/lib/rails/engine.rb:611:in `each'\n    from /home/davi/.rvm/gems/ruby-2.3.0@5.0.0.1/gems/railties-5.0.1/lib/rails/engine.rb:611:in `block in &lt;class:Engine&gt;'\n    from /home/davi/.rvm/gems/ruby-2.3.0@5.0.0.1/gems/railties-5.0.1/lib/rails/initializable.rb:30:in `instance_exec'\n    from /home/davi/.rvm/gems/ruby-2.3.0@5.0.0.1/gems/railties-5.0.1/lib/rails/initializable.rb:30:in `run'\n    from /home/davi/.rvm/gems/ruby-2.3.0@5.0.0.1/gems/railties-5.0.1/lib/rails/initializable.rb:55:in `block in run_initializers'\n    from /home/davi/.rvm/rubies/ruby-2.3.0/lib/ruby/2.3.0/tsort.rb:228:in `block in tsort_each'\n    from /home/davi/.rvm/rubies/ruby-2.3.0/lib/ruby/2.3.0/tsort.rb:350:in `block (2 levels) in each_strongly_connected_component'\n....\n</code></pre>\n"}, {"tags": ["ruby", "primes"], "comments": [{"owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 0, "creation_date": 1488339374, "post_id": 42522008, "comment_id": 72182018, "body": "Your code is far from checking for primes. It is only checking if a number is even or is divisible by its square root."}, {"owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 0, "creation_date": 1488339488, "post_id": 42522008, "comment_id": 72182047, "body": "Your sentences <code>&quot;What number ... the largest prime factor?&quot;</code> and <code>&quot;Number to ... the largest prime factor is ...&quot;</code> are ungrammatical. They should be <code>&quot;... the largest prime factor of ...&quot;</code>."}], "answers": [{"comments": [{"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 0, "creation_date": 1488358759, "post_id": 42522614, "comment_id": 72190351, "body": "There are 10 explicit and 1 implicit message sends, sending 8 (9) different messages, which will get dispatched to <i>at least</i> 8 (9) different methods in your code, possibly more. And that&#39;s counting only the message sends directly in your code, obviously any one of those methods will in turn call other methods which call other methods \u2026 and so on. &quot;Without methods&quot; is a bit of a stretch, I would say."}], "tags": [], "owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "is_accepted": false, "score": 1, "last_activity_date": 1488343814, "last_edit_date": 1488343814, "creation_date": 1488338781, "answer_id": 42522614, "question_id": 42522008, "link": "https://stackoverflow.com/questions/42522008/prime-numbers-without-definitions-and-classes-just-loops/42522614#42522614", "title": "Prime numbers without definitions and classes, just loops", "body": "<p>Here is a largest_primes script without using methods.</p>\n\n<pre><code>input = 100\nresult = 2.upto(input - 1).select do |test_num|\n  2.upto(test_num - 1).none? do |test_divider|\n    (test_num % test_divider).zero?\n  end\nend.max\n\nputs result\n# =&gt; 97\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 27, "user_id": 7580637, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dsX9a.jpg?s=128&g=1", "display_name": "Abhishek28", "link": "https://stackoverflow.com/users/7580637/abhishek28"}, "is_accepted": false, "score": 0, "last_activity_date": 1488364664, "creation_date": 1488364664, "answer_id": 42529444, "question_id": 42522008, "link": "https://stackoverflow.com/questions/42522008/prime-numbers-without-definitions-and-classes-just-loops/42529444#42529444", "title": "Prime numbers without definitions and classes, just loops", "body": "<p>Enter the highest range, upto you want to find highest prime no.</p>\n\n<pre><code>lastnum = 100\n(1..lastnum).reverse_each do |num|\n   if (2..num/2).none?{|i| num % i == 0}\n     puts num\n     break\n   end\nend\n</code></pre>\n\n<p>Here, we get highest range in <strong>lastnum</strong> var, we check for prime no. in descending order ( here 100 to 1 ) and divide that no. from 2 to half of that no. Whenever we get our first prime no. (highest) we stop our condition loop and return that highest prime number.</p>\n"}], "owner": {"reputation": 31, "user_id": 7601980, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/c5c55f4a3f976d5952c37c0417215e88?s=128&d=identicon&r=PG&f=1", "display_name": "balee1991", "link": "https://stackoverflow.com/users/7601980/balee1991"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 127, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1488364664, "creation_date": 1488334513, "last_edit_date": 1488339267, "question_id": 42522008, "link": "https://stackoverflow.com/questions/42522008/prime-numbers-without-definitions-and-classes-just-loops", "title": "Prime numbers without definitions and classes, just loops", "body": "<p>I am trying to input any number and check for prime numbers. I am trying to avoid classes and definitions. I am trying to use loops only. My code is listed below.</p>\n\n<pre><code>puts \"What number would you like to find the largest prime factor?: \"\nlastnum = gets.to_i\nputs \"Number to find the largest prime factor is #{lastnum}\"\nn = 2\nwhile (n &lt;= lastnum)\n  if n % 2 == 0\n    puts \"#{n} is not a prime\"\n  elsif n % Math.sqrt(n) == 0\n    puts \"#{n} is not a prime, sqrt rooted\"\n  else\n    puts \"#{n} is a prime\"\n  end\n  n += 1\nend\n</code></pre>\n\n<p>I get numbers such as <code>99</code> in my list of primes if I input <code>100</code>. Is there something I can add to or remove from my code? If there is an efficient way and I should get away from what I am doing, I shall consider that help as well.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "join", "activerecord", "where-clause"], "answers": [{"tags": [], "owner": {"reputation": 470, "user_id": 3727308, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/3a8b11c4319e25f04c5201a2e3e79d30?s=128&d=identicon&r=PG", "display_name": "ChaosFreak", "link": "https://stackoverflow.com/users/3727308/chaosfreak"}, "is_accepted": false, "score": 1, "last_activity_date": 1488334016, "creation_date": 1488334016, "answer_id": 42521939, "question_id": 42521885, "link": "https://stackoverflow.com/questions/42521885/where-clause-with-less-greater-than-after-a-join/42521939#42521939", "title": "Where Clause with Less/Greater than after a Join", "body": "<p>I thought I had tried this before, but apparently this syntax works:</p>\n\n<pre><code>u.likes.where(liked_type: \"Post\").joins(\"INNER JOIN posts ON posts.id = liked_id\").where(posts: {context_type:\"Group\"}).joins(\"INNER JOIN groups ON groups.id = posts.context_id\").where(\"groups.vote_deadline_at &lt;= ?\",Time.now)\n</code></pre>\n\n<p>I got exactly the results I expected.</p>\n"}, {"tags": [], "owner": {"reputation": 1302, "user_id": 1368977, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c79672007d59af69a05f2b5f6929b53f?s=128&d=identicon&r=PG", "display_name": "Marc Rohloff", "link": "https://stackoverflow.com/users/1368977/marc-rohloff"}, "is_accepted": false, "score": -2, "last_activity_date": 1488337228, "creation_date": 1488337228, "answer_id": 42522400, "question_id": 42521885, "link": "https://stackoverflow.com/questions/42521885/where-clause-with-less-greater-than-after-a-join/42522400#42522400", "title": "Where Clause with Less/Greater than after a Join", "body": "<p>The syntax should be:\n  <code>... .where(groups: [\"vote_deadline_at &lt;= ?\",Time.now] )</code></p>\n"}], "owner": {"reputation": 470, "user_id": 3727308, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/3a8b11c4319e25f04c5201a2e3e79d30?s=128&d=identicon&r=PG", "display_name": "ChaosFreak", "link": "https://stackoverflow.com/users/3727308/chaosfreak"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1375, "favorite_count": 1, "answer_count": 2, "score": 2, "last_activity_date": 1488475468, "creation_date": 1488333543, "last_edit_date": 1488475468, "question_id": 42521885, "link": "https://stackoverflow.com/questions/42521885/where-clause-with-less-greater-than-after-a-join", "title": "Where Clause with Less/Greater than after a Join", "body": "<p>I'm trying to combine a <code>joins</code> with a <code>where</code> clause but the <code>where</code> clause is not testing an equality, it is testing for greater than or equal.</p>\n\n<p>I know in a standard where clause, I can just do this:</p>\n\n<pre><code>Group.where(\"vote_deadline_at &lt;= ?\", Time.now)\n</code></pre>\n\n<p>to find all groups whose vote deadline is in the future.</p>\n\n<p>However, what if this comes after a <code>joins</code>, like this:</p>\n\n<pre><code>User.likes.where(liked_type: \"Post\").joins(\"INNER JOIN posts ON posts.id = liked_id\").where(posts: {context_type:\"Group\"}).joins(\"INNER JOIN groups ON groups.id = posts.context_id\").where(groups: {\"vote_deadline_at &lt;= ?\",Time.now})\n</code></pre>\n\n<p>Everything up to the final <code>where(groups: {\"vote_deadline_at &lt;= ?\",Time.now})</code> clause works fine. It returns an ActiveRecord collection of 186 rows. However, when I add the final <code>where</code> clause, I get the error:</p>\n\n<pre><code>SyntaxError: unexpected '}', expecting end-of-input\n...ote_deadline_at &lt;= ?\",Time.now})\n</code></pre>\n\n<p>Is there any way to further filter my results with a where clause that selects only rows where <code>groups.vote_deadline_at</code> is in the future (i.e. less than or equal to Time.now)?</p>\n"}, {"tags": ["ruby", "loops", "parallel-processing", "jruby", "celluloid"], "comments": [{"owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 0, "creation_date": 1488339110, "post_id": 42521853, "comment_id": 72181951, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/26579532/ruby-how-to-thread-across-cores-processors\">Ruby - how to thread across cores / processors</a>"}], "answers": [{"tags": [], "owner": {"reputation": 6423, "user_id": 468112, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/f4e90ce9fdf9e968587c7f9bec94721e?s=128&d=identicon&r=PG", "display_name": "Chris Mowforth", "link": "https://stackoverflow.com/users/468112/chris-mowforth"}, "is_accepted": false, "score": 0, "last_activity_date": 1490019487, "creation_date": 1490019487, "answer_id": 42905992, "question_id": 42521853, "link": "https://stackoverflow.com/questions/42521853/partition-a-loop-to-be-processed-on-different-cores-parallel/42905992#42905992", "title": "Partition a loop to be processed on different cores parallel", "body": "<p>If it weren't for the jRuby tag I'd be inclined to mark as a duplicate too ;)</p>\n\n<p>You don't state exactly what problem you're trying to solve but since your Ruby now has access to the Java standard lib, in Java 7+ you could use the <a href=\"https://docs.oracle.com/javase/tutorial/essential/concurrency/forkjoin.html\" rel=\"nofollow noreferrer\">Fork/Join</a> framework. Charles Nutter has written a nice JRuby <a href=\"https://github.com/headius/forkjoin.rb\" rel=\"nofollow noreferrer\">wrapper</a>.</p>\n"}], "owner": {"reputation": 133, "user_id": 5315883, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/1lioh.png?s=128&g=1", "display_name": "Grimbox", "link": "https://stackoverflow.com/users/5315883/grimbox"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 106, "favorite_count": 1, "answer_count": 1, "score": -1, "last_activity_date": 1490019487, "creation_date": 1488333304, "question_id": 42521853, "link": "https://stackoverflow.com/questions/42521853/partition-a-loop-to-be-processed-on-different-cores-parallel", "title": "Partition a loop to be processed on different cores parallel", "body": "<p>How can I accomplish a loop that will que it's iterations on the available CPU cores? So each iteration will be run in parallel and therefore finish faster? I'm trying to understand the gem Celluloid but if there is another gem that I could use don't hesitate to tell me!</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "model"], "comments": [{"owner": {"reputation": 2707, "user_id": 1540290, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/02f9d39d23f7ce35ec2cc4332ac1dafc?s=128&d=identicon&r=PG", "display_name": "Lukasz Muzyka", "link": "https://stackoverflow.com/users/1540290/lukasz-muzyka"}, "edited": false, "score": 0, "creation_date": 1488334392, "post_id": 42521782, "comment_id": 72180757, "body": "what database are you using ? Postgres/MySQL/ ... ?"}], "answers": [{"tags": [], "owner": {"reputation": 2707, "user_id": 1540290, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/02f9d39d23f7ce35ec2cc4332ac1dafc?s=128&d=identicon&r=PG", "display_name": "Lukasz Muzyka", "link": "https://stackoverflow.com/users/1540290/lukasz-muzyka"}, "is_accepted": false, "score": 0, "last_activity_date": 1488334463, "creation_date": 1488334463, "answer_id": 42522000, "question_id": 42521782, "link": "https://stackoverflow.com/questions/42521782/how-do-i-create-a-scope-for-an-array/42522000#42522000", "title": "How do I create a scope for an array?", "body": "<p>If you use Postgres you can use this approach: <a href=\"https://www.viget.com/articles/searching-serialized-fields-in-rails-using-postgres-arrays\" rel=\"nofollow noreferrer\">https://www.viget.com/articles/searching-serialized-fields-in-rails-using-postgres-arrays</a></p>\n"}, {"tags": [], "owner": {"reputation": 56, "user_id": 1571380, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MCAfC.jpg?s=128&g=1", "display_name": "allenlsy", "link": "https://stackoverflow.com/users/1571380/allenlsy"}, "is_accepted": false, "score": 0, "last_activity_date": 1488370070, "last_edit_date": 1488370070, "creation_date": 1488335042, "answer_id": 42522072, "question_id": 42521782, "link": "https://stackoverflow.com/questions/42521782/how-do-i-create-a-scope-for-an-array/42522072#42522072", "title": "How do I create a scope for an array?", "body": "<ol>\n<li>get the categories</li>\n<li>correct your where query</li>\n</ol>\n\n<p>Example:</p>\n\n<pre><code>has_many :categories\nscope :art, -&gt; { required = [Category.first]; where(categories: required) }\n</code></pre>\n\n<p>I assume that in your model, you have <code>categories</code> association. In this case, you can just use <code>categories: required</code> in your where query. <code>required</code> should be set to an array of categories which you wanted</p>\n"}, {"tags": [], "owner": {"reputation": 5312, "user_id": 6535997, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/10156345016155058/picture?type=large", "display_name": "Mark", "link": "https://stackoverflow.com/users/6535997/mark"}, "is_accepted": false, "score": 0, "last_activity_date": 1488370462, "creation_date": 1488370462, "answer_id": 42531447, "question_id": 42521782, "link": "https://stackoverflow.com/questions/42521782/how-do-i-create-a-scope-for-an-array/42531447#42531447", "title": "How do I create a scope for an array?", "body": "<p>You say that category_ids is an array of categories(I'm assuming category id's). Are you trying to return all records with a category ID that is in that array? If so you're looking for:</p>\n\n<pre><code>scope :art, -&gt; { where (:category_id =&gt; category_ids) }\n</code></pre>\n\n<p>Or with the new ruby syntax:</p>\n\n<pre><code>scope :art, -&gt; { where(category_id: category_ids) }\n</code></pre>\n\n<p>If I've misunderstood and you're looking for any record with a category ID of 1, then you're looking for:</p>\n\n<pre><code>scope :art, -&gt; { where(category_id: '1') }\n</code></pre>\n"}], "owner": {"reputation": 39, "user_id": 4383590, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/4bf9bc8586625c5efb7fdb41b9229adf?s=128&d=identicon&r=PG&f=1", "display_name": "CC Evans", "link": "https://stackoverflow.com/users/4383590/cc-evans"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 457, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1488370462, "creation_date": 1488332760, "last_edit_date": 1488362042, "question_id": 42521782, "link": "https://stackoverflow.com/questions/42521782/how-do-i-create-a-scope-for-an-array", "title": "How do I create a scope for an array?", "body": "<p>The following code gives an empty scope. <code>Category_ids</code> is an array of categories.</p>\n\n<pre><code>scope :art, -&gt;{ where(:category_ids =&gt; '1') }\n</code></pre>\n\n<p>How do I check to see if one of the categories exist in the array?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "database", "ruby-on-rails-4", "devise"], "comments": [{"owner": {"reputation": 708, "user_id": 3122676, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/8010ad2ee7c8b7a109b6679699c0b20e?s=128&d=identicon&r=PG&f=1", "display_name": "fossil", "link": "https://stackoverflow.com/users/3122676/fossil"}, "edited": false, "score": 0, "creation_date": 1488333014, "post_id": 42521693, "comment_id": 72180442, "body": "You should have done some research. Checkout the <code>apartment</code> gem at <a href=\"https://github.com/influitive/apartment\" rel=\"nofollow noreferrer\">github.com/influitive/apartment</a>"}, {"owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 0, "creation_date": 1488339352, "post_id": 42521693, "comment_id": 72182010, "body": "&quot;applying it to the whole system&quot; would be problematic if you have multiple users, some of who might not be logged in."}, {"owner": {"reputation": 335, "user_id": 6591321, "user_type": "registered", "accept_rate": 37, "profile_image": "https://www.gravatar.com/avatar/4e94cde60d4c12465d9110e7b02fa2d5?s=128&d=identicon&r=PG&f=1", "display_name": "LuisC", "link": "https://stackoverflow.com/users/6591321/luisc"}, "reply_to_user": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 0, "creation_date": 1488403476, "post_id": 42521693, "comment_id": 72220459, "body": "@maxple But only for registered users, would not be allowed entry if not registered"}], "answers": [{"tags": [], "owner": {"reputation": 1112, "user_id": 5892163, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4Tfz7.jpg?s=128&g=1", "display_name": "Hackman", "link": "https://stackoverflow.com/users/5892163/hackman"}, "is_accepted": false, "score": 0, "last_activity_date": 1499351657, "creation_date": 1499351657, "answer_id": 44951924, "question_id": 42521693, "link": "https://stackoverflow.com/questions/42521693/change-database-when-logging-in-with-devise/44951924#44951924", "title": "Change database when logging in with devise", "body": "<p>What you want to do is after sign in check in which database the user is, but therefore you need to connect to every database.</p>\n\n<p>What could be a solution is create a database with all users and a field to which database the user belongs to.\nThen after the sign in check which database to connect with.</p>\n"}], "owner": {"reputation": 335, "user_id": 6591321, "user_type": "registered", "accept_rate": 37, "profile_image": "https://www.gravatar.com/avatar/4e94cde60d4c12465d9110e7b02fa2d5?s=128&d=identicon&r=PG&f=1", "display_name": "LuisC", "link": "https://stackoverflow.com/users/6591321/luisc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 133, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1499351657, "creation_date": 1488332127, "question_id": 42521693, "link": "https://stackoverflow.com/questions/42521693/change-database-when-logging-in-with-devise", "title": "Change database when logging in with devise", "body": "<p>I am making an application in which the login screen the user can select a company in a selectbox and each company has a different database, at the moment of pressing the login button I want to change database depending Of the company and to log in the user must be in that database. I have been looking for a bit and it is possible to change the database by placing in the model <code>establish_connection (\"otherbase\")</code> but I do not know how to apply it to the whole system and at the beginning of session with devise</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 0, "creation_date": 1488333808, "post_id": 42521602, "comment_id": 72180626, "body": "I don&#39;t think it deserves a downvote."}], "answers": [{"comments": [{"owner": {"reputation": 91, "user_id": 5932573, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/2c6a9b4f790cd1cc91977ebc7ba17680?s=128&d=identicon&r=PG", "display_name": "J. M. Habibi", "link": "https://stackoverflow.com/users/5932573/j-m-habibi"}, "edited": false, "score": 0, "creation_date": 1488332832, "post_id": 42521628, "comment_id": 72180380, "body": "how would a beginner, such as myself, come to that conclusion though? What tells me it is invoking a function?"}, {"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 0, "creation_date": 1488333399, "post_id": 42521628, "comment_id": 72180542, "body": "You&#39;re going to have to keep reading and learning. Those things become clear as you learn."}, {"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 1, "creation_date": 1488358957, "post_id": 42521628, "comment_id": 72190497, "body": "This is <i>not</i> a function invocation. Ruby doesn&#39;t have functions. It is a message send."}, {"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "reply_to_user": {"reputation": 91, "user_id": 5932573, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/2c6a9b4f790cd1cc91977ebc7ba17680?s=128&d=identicon&r=PG", "display_name": "J. M. Habibi", "link": "https://stackoverflow.com/users/5932573/j-m-habibi"}, "edited": false, "score": 1, "creation_date": 1488359129, "post_id": 42521628, "comment_id": 72190621, "body": "@J.M.Habibi: It takes an argument. In Ruby, variables don&#39;t take arguments, only message sends do, so it can only be a message send, nothing else. That&#39;s just part of the basic syntax and semantics. You will have to learn at least the basics of the syntax and semantics in order to understand even the most basic code. Knowing that, for example, only message sends take arguments, and only method definitions and blocks have parameter lists, and that instance variables start with an <code>@</code> sign, and so on is part of that basic knowledge."}], "tags": [], "owner": {"reputation": 603, "user_id": 6016071, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bYAFA.jpg?s=128&g=1", "display_name": "JimmyNJ", "link": "https://stackoverflow.com/users/6016071/jimmynj"}, "is_accepted": false, "score": 1, "last_activity_date": 1488751615, "last_edit_date": 1488751615, "creation_date": 1488331502, "answer_id": 42521628, "question_id": 42521602, "link": "https://stackoverflow.com/questions/42521602/why-is-require-in-this-example-a-method-and-not-a-variable/42521628#42521628", "title": "Why is require in this example a method and not a variable?", "body": "<p>Because it invokes a Ruby message send, what is more commonly called a function in other languages. This particular 'function' loads an external piece of code referenced by the name 'net/http'.  Sometimes syntactical elements such as parenthesies are omitted as a syntactical convenience, so it may not look exactly like other functions or Ruby message sends.</p>\n\n<p>This description will not help you understand <em>why</em> this is the practice in Ruby because you need to learn a significant number of the syntactical patterns before realizing the intent of their design. Once you realize this design intent you have the answer to 'why' this syntax was chosen. Alternatively you could research the Ruby design discussions.</p>\n"}, {"tags": [], "owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "is_accepted": false, "score": 0, "last_activity_date": 1488333789, "creation_date": 1488333789, "answer_id": 42521912, "question_id": 42521602, "link": "https://stackoverflow.com/questions/42521602/why-is-require-in-this-example-a-method-and-not-a-variable/42521912#42521912", "title": "Why is require in this example a method and not a variable?", "body": "<p>The scope for a local variable is pretty much narrow. In case an expression is ambiguous between a local variable and a method, if you look within the current method body, class body, block, etc., and cannot find the local variable assignment, then it would be interpreted as a method.</p>\n"}, {"tags": [], "owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "is_accepted": false, "score": 0, "last_activity_date": 1488358898, "creation_date": 1488358898, "answer_id": 42527359, "question_id": 42521602, "link": "https://stackoverflow.com/questions/42521602/why-is-require-in-this-example-a-method-and-not-a-variable/42527359#42527359", "title": "Why is require in this example a method and not a variable?", "body": "<p>Because it takes an argument. In Ruby, only message sends have arguments.</p>\n"}, {"tags": [], "owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "is_accepted": false, "score": 1, "last_activity_date": 1488359905, "creation_date": 1488359905, "answer_id": 42527722, "question_id": 42521602, "link": "https://stackoverflow.com/questions/42521602/why-is-require-in-this-example-a-method-and-not-a-variable/42527722#42527722", "title": "Why is require in this example a method and not a variable?", "body": "<p>It can't be a variable, because there no such piece of language syntax that consists of a variable and a string literal separated by a space.</p>\n\n<p>Ergo, this must be a method call (message send).</p>\n"}], "owner": {"reputation": 91, "user_id": 5932573, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/2c6a9b4f790cd1cc91977ebc7ba17680?s=128&d=identicon&r=PG", "display_name": "J. M. Habibi", "link": "https://stackoverflow.com/users/5932573/j-m-habibi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 126, "favorite_count": 0, "answer_count": 4, "score": 0, "last_activity_date": 1488751615, "creation_date": 1488331342, "last_edit_date": 1488333639, "question_id": 42521602, "link": "https://stackoverflow.com/questions/42521602/why-is-require-in-this-example-a-method-and-not-a-variable", "title": "Why is require in this example a method and not a variable?", "body": "<p>I'm going through Why's Poignant Guide. I don't understand why 'require' in the first line is a method and not a variable:</p>\n\n<pre><code>require 'net/http'\nNet::HTTP.start( 'www.ruby-lang.org', 80 ) do |http|\n  print( http.get( '/en/about/license.txt' ).body )\nend\n</code></pre>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 0, "creation_date": 1488324314, "post_id": 42520499, "comment_id": 72178199, "body": "is <code>break i if complicated_predicate_of(i)</code> not what  your looking for? <code>break</code> can make the <code>loop</code> return a value, i.e. <code>(one  = loop { break 1}) == 1</code>"}, {"owner": {"reputation": 1887, "user_id": 4948732, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh4.googleusercontent.com/-ZnN3lJjklJg/AAAAAAAAAAI/AAAAAAAAAWE/zqGtDAyXfjo/photo.jpg?sz=128", "display_name": "thesecretmaster", "link": "https://stackoverflow.com/users/4948732/thesecretmaster"}, "edited": false, "score": 0, "creation_date": 1488327008, "post_id": 42520499, "comment_id": 72178939, "body": "Could you add some complete working code?"}, {"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 0, "creation_date": 1488359285, "post_id": 42520499, "comment_id": 72190730, "body": "I&#39;m curious why you think <code>loop.collect</code> should be a <code>SyntaxError</code>? It is calling <code>collect</code> on the return value of <code>loop</code>. Calling a method on the return value of another method call is perfectly legal syntactically. It is called &quot;method chaining&quot;."}, {"owner": {"reputation": 2481, "user_id": 1212000, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZPwGy.png?s=128&g=1", "display_name": "Raffael", "link": "https://stackoverflow.com/users/1212000/raffael"}, "edited": false, "score": 0, "creation_date": 1488406236, "post_id": 42520499, "comment_id": 72221934, "body": "Good question. Note that <code>break x</code> will cancel your iteration and <b>always</b> return <code>x</code> (or <code>nil</code>, if no <code>x</code> is given). It does not matter that you use <code>collect</code> which normally returns a collection."}], "answers": [{"comments": [{"owner": {"reputation": 48049, "user_id": 6419007, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/CwqtX.jpg?s=128&g=1", "display_name": "Eric Duminil", "link": "https://stackoverflow.com/users/6419007/eric-duminil"}, "edited": false, "score": 1, "creation_date": 1488405597, "post_id": 42521248, "comment_id": 72221654, "body": "I&#39;ve seen many good answers without any upvote during the last few days. Is it just an impression?"}], "tags": [], "owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "is_accepted": false, "score": 2, "last_activity_date": 1488328575, "creation_date": 1488328575, "answer_id": 42521248, "question_id": 42520499, "link": "https://stackoverflow.com/questions/42520499/how-can-i-collect-block-values-in-ruby-without-an-iterator/42521248#42521248", "title": "How can I collect block values in Ruby without an iterator?", "body": "<p>You could write</p>\n\n<pre><code>def complicated_predicate_of(i)\n  i &gt; 3\nend\n\n1.step.with_object([]) { |i,collection| complicated_predicate_of(i) ?\n  (break collection) : collection &lt;&lt; i }\n  #=&gt; [1, 2, 3]  \n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 48049, "user_id": 6419007, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/CwqtX.jpg?s=128&g=1", "display_name": "Eric Duminil", "link": "https://stackoverflow.com/users/6419007/eric-duminil"}, "edited": false, "score": 1, "creation_date": 1488405548, "post_id": 42542554, "comment_id": 72221627, "body": "It should be <code>1.step</code>. Good answer otherwise!"}, {"owner": {"reputation": 2481, "user_id": 1212000, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZPwGy.png?s=128&g=1", "display_name": "Raffael", "link": "https://stackoverflow.com/users/1212000/raffael"}, "reply_to_user": {"reputation": 48049, "user_id": 6419007, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/CwqtX.jpg?s=128&g=1", "display_name": "Eric Duminil", "link": "https://stackoverflow.com/users/6419007/eric-duminil"}, "edited": false, "score": 0, "creation_date": 1488406360, "post_id": 42542554, "comment_id": 72221994, "body": "Good catch. Corrected."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1488989129, "post_id": 42542554, "comment_id": 72476932, "body": "<code>take_while</code> is <i>perfecto</i>!"}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1488989868, "post_id": 42542554, "comment_id": 72477484, "body": "When yielding to a block one normally omits the proc argument, so <code>def numbers_until</code> is sufficient. Note that <code>block</code>is not referenced in your code. A proc is passed as an argument when you want to <code>call</code> it, possibly after it is passed to another method."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1488991001, "post_id": 42542554, "comment_id": 72478339, "body": "All you need for the method is <code>def numbers_until; 1.step.take_while { |i| yield(i) }; end</code>."}, {"owner": {"reputation": 2481, "user_id": 1212000, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZPwGy.png?s=128&g=1", "display_name": "Raffael", "link": "https://stackoverflow.com/users/1212000/raffael"}, "edited": false, "score": 0, "creation_date": 1489002903, "post_id": 42542554, "comment_id": 72485614, "body": "Yeah, Ruby does some things right. Its collections rock :) True, the proc argument can be omitted. However, in my experience it helps to state it explicitly in the method signature. Self explanatory method signatures help the reader (i.e. my future self) to understand the method without having to care about its implementation."}], "tags": [], "owner": {"reputation": 2481, "user_id": 1212000, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZPwGy.png?s=128&g=1", "display_name": "Raffael", "link": "https://stackoverflow.com/users/1212000/raffael"}, "is_accepted": true, "score": 3, "last_activity_date": 1488406384, "last_edit_date": 1488406384, "creation_date": 1488404275, "answer_id": 42542554, "question_id": 42520499, "link": "https://stackoverflow.com/questions/42520499/how-can-i-collect-block-values-in-ruby-without-an-iterator/42542554#42542554", "title": "How can I collect block values in Ruby without an iterator?", "body": "<p>You could write</p>\n\n<pre><code>collection = 1.step.take_while do |i| \n  i &lt;= 3 # this block needs to return *false* to stop the taking\nend\n</code></pre>\n\n<hr>\n\n<p>Whatever solution you choose in the end, remember that you can always opt to introduce a helper method with a self-explanatory name. Especially if you need to collect numbers like this in many places in your source code.</p>\n\n<p>Say you wanted to hide the intricate bowels of your solution above, then this could be your helper method:</p>\n\n<pre><code>def numbers_until(&amp;block)\n  i = 0\n  collection = []\n  loop do\n    i += 1\n    break if yield i\n    collection &lt;&lt; i\n  end\n  collection\nend\n\ncollection = numbers_until do |i|\n   i &gt; 3 # this block needs to return *true* to stop the taking\nend\n</code></pre>\n"}], "owner": {"reputation": 1325, "user_id": 4185992, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/ab32bf3dfb50b05847d3bfa410c03b9f?s=128&d=identicon&r=PG&f=1", "display_name": "Sasgorilla", "link": "https://stackoverflow.com/users/4185992/sasgorilla"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 105, "favorite_count": 0, "accepted_answer_id": 42542554, "answer_count": 2, "score": 2, "last_activity_date": 1488406384, "creation_date": 1488323634, "question_id": 42520499, "link": "https://stackoverflow.com/questions/42520499/how-can-i-collect-block-values-in-ruby-without-an-iterator", "title": "How can I collect block values in Ruby without an iterator?", "body": "<p>Here's some code:</p>\n\n<pre><code>i = 0\ncollection = []\nloop do\n  i += 1\n  break if complicated_predicate_of(i)\n  collection &lt;&lt; i\nend\ncollection\n</code></pre>\n\n<p>I don't know in advance how many times I'll need to iterate; that depends on <code>complicated_predicate_of(i)</code>. I could do something like <code>0.upto(Float::INFINITY).times.collect do ... end</code> but that's pretty ugly.</p>\n\n<p>I'd like to do this:</p>\n\n<pre><code>i = 0\ncollection = loop.collect do\n  i += 1\n  break if complicated_predicate_of(i)\n  i\nend\n</code></pre>\n\n<p>But, though it's not a syntax error for some reason, <code>loop.collect</code> doesn't seem to collect anything. (Neither does <code>loop.reduce</code>). <code>collection</code> is nil at the end of the statement.</p>\n\n<p>In other words, I want to collect the values of a <code>loop</code> statement without an explicit iterator. Is there some way to achieve this?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "activerecord", "activeadmin"], "comments": [{"owner": {"reputation": 1843, "user_id": 4067720, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a52c645614505bcaeb65a6c5199158c1?s=128&d=identicon&r=PG", "display_name": "Glyoko", "link": "https://stackoverflow.com/users/4067720/glyoko"}, "edited": false, "score": 0, "creation_date": 1488323615, "post_id": 42520412, "comment_id": 72177987, "body": "Can you show your routes file? Also, can you give us the full traceback of the error message and give us the output of <code>rake routes</code>? I suspect that the reason it&#39;s complaining about <code>wallets</code> not being defined (even though you never call <code>wallets</code> in the above code) is that some routing is making assumptions about how the relationships look."}, {"owner": {"reputation": 55, "user_id": 3145103, "user_type": "registered", "profile_image": "https://graph.facebook.com/83901519/picture?type=large", "display_name": "ttante", "link": "https://stackoverflow.com/users/3145103/ttante"}, "reply_to_user": {"reputation": 1843, "user_id": 4067720, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a52c645614505bcaeb65a6c5199158c1?s=128&d=identicon&r=PG", "display_name": "Glyoko", "link": "https://stackoverflow.com/users/4067720/glyoko"}, "edited": false, "score": 0, "creation_date": 1488324893, "post_id": 42520412, "comment_id": 72178346, "body": "Edited to address this comment^^"}, {"owner": {"reputation": 1843, "user_id": 4067720, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a52c645614505bcaeb65a6c5199158c1?s=128&d=identicon&r=PG", "display_name": "Glyoko", "link": "https://stackoverflow.com/users/4067720/glyoko"}, "edited": false, "score": 0, "creation_date": 1488327068, "post_id": 42520412, "comment_id": 72178956, "body": "Can you give the <i>full</i> backtrace for #2 (app and framework)? I expect it to be like 50 lines. And are there any calls in routes.rb to ActiveAdmin methods? If the answer below works then maybe this isn&#39;t necessary, but I might be able to give a better answer"}], "answers": [{"comments": [{"owner": {"reputation": 1843, "user_id": 4067720, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a52c645614505bcaeb65a6c5199158c1?s=128&d=identicon&r=PG", "display_name": "Glyoko", "link": "https://stackoverflow.com/users/4067720/glyoko"}, "edited": false, "score": 0, "creation_date": 1488326901, "post_id": 42520978, "comment_id": 72178915, "body": "This is actually a slight simplification of what&#39;s happening. I&#39;m not too familiar with ActiveAdmin, but it seems like something is assuming (perhaps in the framework, perhaps in your configuration?) that the nested resource is pluralistic. In pure rails, there is a way to have nested singular resources, but something seems to be precluding that here.  This is a relatively clean workaround however, and is probably acceptable for most purposes."}], "tags": [], "owner": {"reputation": 1843, "user_id": 4067720, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a52c645614505bcaeb65a6c5199158c1?s=128&d=identicon&r=PG", "display_name": "Glyoko", "link": "https://stackoverflow.com/users/4067720/glyoko"}, "is_accepted": false, "score": 0, "last_activity_date": 1488327163, "last_edit_date": 1488327163, "creation_date": 1488326803, "answer_id": 42520978, "question_id": 42520412, "link": "https://stackoverflow.com/questions/42520412/rails-activeadmin-has-one-and-belongs-to-causes-undefined-method-for-plural-re/42520978#42520978", "title": "Rails ActiveAdmin has_one and belongs_to causes &#39;Undefined Method for &lt;PLURAL_RESOURCE&gt;&#39;", "body": "<p>Even though your routes may not explicitly reference <code>wallet(s)</code>, there may be something there making assumptions about how records are related to each other.</p>\n\n<p>Look at the output of <code>rake routes</code>, in particular:</p>\n\n<pre><code>admin_user_wallet GET\n/admin/users/:user_id/wallets/:id(.:format) admin/wallets#show\n</code></pre>\n\n<p>When you call <code>admin_user_wallet_path(user, user.wallet.id)</code> it's matching the <code>/admin/users/:user_id/wallets/:id(.:format)</code> route. Notice how that expects both a user id and a wallet id in the path. This is a tip-off that something is off here, since if you have the user, there should be exactly one wallet associated with it. You shouldn't <em>need</em> to give both the user and wallet id.</p>\n\n<p>Since the wallet resource is nested under users, the page where you view the user's wallet is actually more of an index page than a show. If the wallet were an independent resource, then you could have a path like <code>/admin/wallets/:id</code> and things would work out fine.</p>\n\n<p>But since the wallet is a <em>subresource</em> of the user, you would ideally want a path like <code>/admin/users/:user_id/wallet</code>. There's no need to pass the wallet id, since you already have the user.</p>\n\n<hr>\n\n<p>tl;dr: Try changing the <code>show</code>s to <code>index</code>s and see where that gets you. e.g.</p>\n\n<pre><code>index do\n  div do\n    'hello'\n  end\nend\n\n# ...\n\naction_item :wallet, only: :index do\n  link_to('Wallet', admin_user_wallets_path(user))\nend\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1006, "user_id": 399632, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/9874698c0b00113a809ece12fc569402?s=128&d=identicon&r=PG", "display_name": "nitsujri", "link": "https://stackoverflow.com/users/399632/nitsujri"}, "edited": false, "score": 0, "creation_date": 1600947890, "post_id": 48157123, "comment_id": 113253673, "body": "Don&#39;t fake it, <code>single: true</code> is the answer"}], "tags": [], "owner": {"reputation": 167, "user_id": 5141057, "user_type": "registered", "accept_rate": 86, "profile_image": "https://graph.facebook.com/10205605394948061/picture?type=large", "display_name": "Raymond Ruiz-Veve", "link": "https://stackoverflow.com/users/5141057/raymond-ruiz-veve"}, "is_accepted": false, "score": 0, "last_activity_date": 1515440875, "creation_date": 1515440875, "answer_id": 48157123, "question_id": 42520412, "link": "https://stackoverflow.com/questions/42520412/rails-activeadmin-has-one-and-belongs-to-causes-undefined-method-for-plural-re/48157123#48157123", "title": "Rails ActiveAdmin has_one and belongs_to causes &#39;Undefined Method for &lt;PLURAL_RESOURCE&gt;&#39;", "body": "<p>Okay.. So I had this same exact issue. I had a belongs_to a parent where the parent had only a has_one to the child model..... Nothing seemed to work so I decided to fake it. I am not sure if this is the best way to do this but it worked. In the parent model, add a method:</p>\n\n<pre><code>class User &lt; ActiveRecord::Base\n   has_one :wallet\n   def wallets\n     Wallet.where(user_id: id)\n    end\n  end\n</code></pre>\n\n<p>The above code is a hotfix until I can find some other way to implement what I need.</p>\n"}, {"tags": [], "owner": {"reputation": 843, "user_id": 2705962, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d43e0615c7b33faefac277423391397e?s=128&d=identicon&r=PG&f=1", "display_name": "Semjon", "link": "https://stackoverflow.com/users/2705962/semjon"}, "is_accepted": false, "score": 4, "last_activity_date": 1562229164, "creation_date": 1562229164, "answer_id": 56883749, "question_id": 42520412, "link": "https://stackoverflow.com/questions/42520412/rails-activeadmin-has-one-and-belongs-to-causes-undefined-method-for-plural-re/56883749#56883749", "title": "Rails ActiveAdmin has_one and belongs_to causes &#39;Undefined Method for &lt;PLURAL_RESOURCE&gt;&#39;", "body": "<p><code>ActiveAdmin</code> uses <code>InheritedResources</code> gem internally, the <code>belongs_to</code> method ends up inside <code>InheritedResources</code>.</p>\n\n<p>Possible solution here</p>\n\n<pre><code>ActiveAdmin.register Wallet do\n  belongs_to :user, singleton: true\n  actions :all, except: :destroy\nend\n</code></pre>\n\n<p>The option <code>singleton: true</code> makes the <code>Wallet</code> a singular resource for the <code>User</code>.</p>\n\n<p>Probably, another option <code>optional: true</code> may be helpful if Wallet is not required for any <code>User</code> to present</p>\n"}], "owner": {"reputation": 55, "user_id": 3145103, "user_type": "registered", "profile_image": "https://graph.facebook.com/83901519/picture?type=large", "display_name": "ttante", "link": "https://stackoverflow.com/users/3145103/ttante"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1017, "favorite_count": 0, "answer_count": 3, "score": 2, "last_activity_date": 1562229164, "creation_date": 1488323130, "last_edit_date": 1488324858, "question_id": 42520412, "link": "https://stackoverflow.com/questions/42520412/rails-activeadmin-has-one-and-belongs-to-causes-undefined-method-for-plural-re", "title": "Rails ActiveAdmin has_one and belongs_to causes &#39;Undefined Method for &lt;PLURAL_RESOURCE&gt;&#39;", "body": "<p>In Rails, I have a 'User' model and a 'Wallet' model. A 'User' has_one wallet and each 'Wallet' belongs_to a 'User'. I made a 'Show' page in ActiveAdmin to view a User's Wallet. However, going to that page returns this error:</p>\n\n<pre><code>undefined method `wallets' for #&lt;User:0x007f...&gt;\n</code></pre>\n\n<p>HOWEVER, when I update the User model to 'has_many :wallets' instead of ':has_one wallet', everything works. Here is the relevant code from my models and ActiveAdmin code:</p>\n\n<p>Models:</p>\n\n<pre><code>class User &lt; ActiveRecord::Base\n  has_one :wallet, dependent: :destroy\nend\n\n\nclass Wallet &lt; ActiveRecord::Base\n  belongs_to :user\nend\n</code></pre>\n\n<p>ActiveAdmin:</p>\n\n<pre><code>ActiveAdmin.register Wallet do\n  belongs_to :user\n  actions :all, except: :destroy\n\n  show do\n    div do\n      'hello'\n    end\n  end\nend\n\nActiveAdmin.register User do\n  actions :all, except: :destroy\n  permit_params\n\n  action_item :wallet, only: :show do\n    link_to('Wallet', admin_user_wallet_path(user, user.wallet.id))\n  end\n\n  index do...\nend\n</code></pre>\n\n<p>Any ideas as to where I might have gone wrong?</p>\n\n<p><strong>Edit 1:</strong> updates to correct colon placement mistakes in description</p>\n\n<p><strong>Edit 2:</strong> </p>\n\n<p>in response to:</p>\n\n<blockquote>\n  <p>Can you show your routes file? Also, can you give us the full traceback of the error message and give us the output of rake routes? I suspect that the reason it's complaining about wallets not being defined (even though you never call wallets in the above code) is that some routing is making assumptions about how the relationships look. \u2013 Glyoko 4 mins ago </p>\n</blockquote>\n\n<ol>\n<li>My routes file contains no mention 'wallet' or 'wallets'.</li>\n<li><p>My stack error more specifically looks like this: </p>\n\n<p>activemodel (4.1.15) lib/active_model/attribute_methods.rb, line 435</p>\n\n<p>Let me know if you need more than that.</p></li>\n<li><p>Here's the related output from 'bin/rake routes': </p>\n\n<ul>\n<li><p>admin_user_wallets GET      /admin/users/:user_id/wallets(.:format)                        admin/wallets#index</p></li>\n<li><p>POST     /admin/users/:user_id/wallets(.:format)                        admin/wallets#create</p></li>\n<li><p>new_admin_user_wallet GET     /admin/users/:user_id/wallets/new(.:format)                 admin/wallets#new</p></li>\n<li>edit_admin_user_wallet GET       /admin/users/:user_id/wallets/:id/edit(.:format)               admin/wallets#edit</li>\n<li>admin_user_wallet GET<br>\n/admin/users/:user_id/wallets/:id(.:format)                    admin/wallets#show</li>\n<li>admin_user_wallet PATCH  /admin/users/:user_id/wallets/:id(.:format)                    admin/wallets#update</li>\n<li>admin_user_wallet PUT /admin/users/:user_id/wallets/:id(.:format)                    admin/wallets#update</li>\n</ul></li>\n</ol>\n"}, {"tags": ["ruby", "csv", "unique", "haversine"], "answers": [{"comments": [{"owner": {"reputation": 1217, "user_id": 1180008, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/FdMdK.jpg?s=128&g=1", "display_name": "Nubtacular", "link": "https://stackoverflow.com/users/1180008/nubtacular"}, "edited": false, "score": 0, "creation_date": 1488338956, "post_id": 42522282, "comment_id": 72181916, "body": "The main performance issue is just having a monster output CSV file. 3-4million records and trying to open that in excel is a nightmare (and large in file size, close to 0.5gb if not more). Then what I would do is insert all those rows into a MySQL table, and use MIN() on feet_to_fiber and group by address. Heading to bed here but will try your approach first thing in the morning."}, {"owner": {"reputation": 1302, "user_id": 1368977, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c79672007d59af69a05f2b5f6929b53f?s=128&d=identicon&r=PG", "display_name": "Marc Rohloff", "link": "https://stackoverflow.com/users/1368977/marc-rohloff"}, "reply_to_user": {"reputation": 1217, "user_id": 1180008, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/FdMdK.jpg?s=128&g=1", "display_name": "Nubtacular", "link": "https://stackoverflow.com/users/1180008/nubtacular"}, "edited": false, "score": 0, "creation_date": 1488383872, "post_id": 42522282, "comment_id": 72208353, "body": "Are you saying that you have 3 to 4 million customers? The length of the output file should not matter, though processing that many customers might. If you are trying to do further processing then it does sound like a Database would be a good idea though I would consider something like <code>Postgres</code> which has some extensions for handling geographic co-ordinates. I have also had success using ElasticSearch for this."}, {"owner": {"reputation": 1217, "user_id": 1180008, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/FdMdK.jpg?s=128&g=1", "display_name": "Nubtacular", "link": "https://stackoverflow.com/users/1180008/nubtacular"}, "edited": false, "score": 0, "creation_date": 1488384151, "post_id": 42522282, "comment_id": 72208574, "body": "The initial <code>swfl_1a_geocoded.csv</code> is ~10,000 customers. What&#39;s happening is that each customer in the aforementioned csv running through EVERY lat/long pair in the fiber, therefore returning multiple results in the output CSV. So, Jane Doe at XYZ address may have 150 output results under 5,280 feet. But I only care about the Jane Doe at XYZ which is the minimum of all those results under 5,280 feet. So I&#39;m trying to avoid outputting duplicate customers to the the output file, and do some unique-ness style validation via Ruby."}, {"owner": {"reputation": 1302, "user_id": 1368977, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c79672007d59af69a05f2b5f6929b53f?s=128&d=identicon&r=PG", "display_name": "Marc Rohloff", "link": "https://stackoverflow.com/users/1368977/marc-rohloff"}, "reply_to_user": {"reputation": 1217, "user_id": 1180008, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/FdMdK.jpg?s=128&g=1", "display_name": "Nubtacular", "link": "https://stackoverflow.com/users/1180008/nubtacular"}, "edited": false, "score": 0, "creation_date": 1488395658, "post_id": 42522282, "comment_id": 72215900, "body": "As I said in my point (2) I would put the customers loop on the outside. If the lat/long pairs are sorted you can then loop through a minimal set of them and find the one with the minimum distance using a variation of the standard minimum code."}], "tags": [], "owner": {"reputation": 1302, "user_id": 1368977, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c79672007d59af69a05f2b5f6929b53f?s=128&d=identicon&r=PG", "display_name": "Marc Rohloff", "link": "https://stackoverflow.com/users/1368977/marc-rohloff"}, "is_accepted": false, "score": 0, "last_activity_date": 1488336432, "creation_date": 1488336432, "answer_id": 42522282, "question_id": 42520236, "link": "https://stackoverflow.com/questions/42520236/ruby-checking-array-for-unique-values-and-also-returning-minimum-distance-have/42522282#42522282", "title": "Ruby: checking array for unique values and also returning minimum distance (haversine formula)", "body": "<p>First off, where are your performance issues? I'm going to assume its not in calculating <code>fib_coords</code> but in looping through the <code>customers</code>. There are a couple of changes I would make:</p>\n\n<p>1) I would not read the whole customers CSV file into memory in one go but loop through the <code>customers</code> CSV file using the <code>CSV::for_each</code> method. Loading the whole CSV file is probably using a fair bit of memory which could be better used for the <code>fib_coords</code> array. This means reversing the order of <code>customers</code> and <code>fib_coords</code> loops.</p>\n\n<p>2) Secondly, you can avoid searching the whole <code>fib_coords</code> array. If you sort by the first column so that it is in latitudinal order, calculate the minimum possible latitude (<code>customer.latitude - 5280ft</code>), find the first potential match in <code>fib_coords</code> using <code>bsearch</code> which is much faster than a linear search and loop through <code>fib_coords</code> from there until the latitude in <code>fib_coords</code> is out of range ( <code>&gt; customer.latitude + 5280ft</code>).</p>\n"}], "owner": {"reputation": 1217, "user_id": 1180008, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/FdMdK.jpg?s=128&g=1", "display_name": "Nubtacular", "link": "https://stackoverflow.com/users/1180008/nubtacular"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 128, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1488336432, "creation_date": 1488322344, "question_id": 42520236, "link": "https://stackoverflow.com/questions/42520236/ruby-checking-array-for-unique-values-and-also-returning-minimum-distance-have", "title": "Ruby: checking array for unique values and also returning minimum distance (haversine formula)", "body": "<p>Having a hard time wrap my head around this. </p>\n\n<p>I have two CSV's that make up a fiberoptic network: one for latitude, one for longitude. These were pulled from a KMZ file and both CSV's consist of 170k rows each due to the poorly built KMZ. </p>\n\n<p>I have a CSV of potential customers that I want to compare against the fiber network. If the minimum distance (calculated using the Haversine formula), is less than 5280 feet, it'll print that out to the output csv file.</p>\n\n<p>I've been with successful with this in the past when there aren't so many lat/long pairs: 20k in the past, but now we have 170k. The output csv file gets massive, as you can imagine: 3 million rows and counting.</p>\n\n<p>Then what I would have to do is do a check (generally using MySQL MIN() function, but I'm sure there's a better way) to return the minimum distance per address and group by address: since you really only care about the minimum distance, per address. You don't want multiple rows for each address. </p>\n\n<pre><code>require 'csv'\nrequire 'haversine'\n\n#this could be put into one file, works as is\nfib_lat = CSV.read(\"swfl_fiber_lat.csv\")\nfib_long = CSV.read(\"swfl_fiber_long.csv\")\n\n#use zip to read both arrays at the same time\nfib_coords = fib_lat.map(&amp;:last).zip(fib_long.map(&amp;:last))\n\n#multiple column CSV with customer data, headers turned on\ncustomers = CSV.read(\"swfl_1a_geocoded.csv\", headers:true)\n\nCSV.open('swfl-output-data-within-1mile.csv','w', :write_headers=&gt; true, :headers =&gt; ['First Name','Last Name','Latitude','Longitude','Feet to Fiber','Address','City','State','Zip','County','Company','Title Code Description','PrimarySIC6 Description','Business Status Code Description','Phone Number','Tollfree Phonenumber','EmployeeSize Location Description','Sales Volume Location Decode','Telecommunications Expense','Email Address']) do |csv_object|\n    fib_coords.each do |fib_lat, fib_long|\n        customers.each do |cust|       \n            if (Haversine.distance(cust[2].to_f, cust[3].to_f, fib_lat.to_f, fib_long.to_f).to_feet &lt; 5280)\n                data_out = [\"#{cust[0]},#{cust[1]},#{cust[2].to_f},#{cust[3].to_f}, #{Haversine.distance(cust[2].to_f, cust[3].to_f, fib_lat.to_f, fib_long.to_f).to_feet.round(2)},#{cust[5]},#{cust[6]},#{cust[7]},#{cust[8]},#{cust[9]},#{cust[10]},#{cust[11]},#{cust[12]},#{cust[13]},#{cust[14]},#{cust[15]},#{cust[16]},#{cust[17]},#{cust[18]}\"]            \n                csv_object &lt;&lt; data_out\n            end\n        end\n    end\nend \n</code></pre>\n\n<p>I'm trying to think of a way to return the customer (maybe using <code>.uniq</code> <code>arr#min</code> and only the minimum address per customer without shoving that into the output CSV. Then, if there is indeed a distance below 5,280 and an associated customer, only put that into the output CSV array. </p>\n\n<p>In regards to the psuedocode: if distance is the minimum per customer, make sure that customer value is unique, then shove that into the output CSV. Just not 100% on how to implement this in my flurry of loops.</p>\n\n<p>Any and all insight is appreciated.  </p>\n"}, {"tags": ["ruby", "interpolation"], "answers": [{"tags": [], "owner": {"reputation": 27144, "user_id": 3857758, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/58c4295826435f049b7fc32b98c240f9?s=128&d=identicon&r=PG&f=1", "display_name": "Ursus", "link": "https://stackoverflow.com/users/3857758/ursus"}, "is_accepted": false, "score": 1, "last_activity_date": 1488322531, "creation_date": 1488322531, "answer_id": 42520285, "question_id": 42520184, "link": "https://stackoverflow.com/questions/42520184/ruby-code-involving-interpolation-not-giving-the-result-i-want/42520285#42520285", "title": "Ruby code involving interpolation not giving the result I want", "body": "<p>You are simply storing a string and then printing it. Why do you expect that string turns into one of those d-something? \nAnyway, you could do something like    </p>\n\n<pre><code>puts \"Which dice would you like to roll?\"\nwhich_dice = gets.chomp.to_i\nif [4, 6, 8, 12, 20, 100].include? which_dice\n  number = rand(1..which_dice)\n  puts \"You rolled a #{number}!\"\nelse\n  puts \"This dice doesn't exist dude\"\nend\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 16229, "user_id": 525478, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/3b6c0b47a0c430a0b141baee7ea845be?s=128&d=identicon&r=PG", "display_name": "Brad Werth", "link": "https://stackoverflow.com/users/525478/brad-werth"}, "edited": false, "score": 0, "creation_date": 1488330426, "post_id": 42520298, "comment_id": 72179813, "body": "Be careful with an approach like this, though - <a href=\"https://stackoverflow.com/questions/5349624/how-to-call-methods-dynamically-based-on-their-name/26284769#26284769\" title=\"how to call methods dynamically based on their name\">stackoverflow.com/questions/5349624/&hellip;</a>"}, {"owner": {"reputation": 131, "user_id": 7604711, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a7d6d05052bb79667f3a116c71c11ae7?s=128&d=identicon&r=PG", "display_name": "Codextremist", "link": "https://stackoverflow.com/users/7604711/codextremist"}, "reply_to_user": {"reputation": 16229, "user_id": 525478, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/3b6c0b47a0c430a0b141baee7ea845be?s=128&d=identicon&r=PG", "display_name": "Brad Werth", "link": "https://stackoverflow.com/users/525478/brad-werth"}, "edited": false, "score": 0, "creation_date": 1488330980, "post_id": 42520298, "comment_id": 72179953, "body": "Sure @BradWerth ! But as a said, &quot;there are better ways to achieve it&quot;. I avoided making assumptions, and wanted only to solve it. Actually, I would say that this is the worst solution from the security perspective, however I could argue, that this solution is the only presented solution that produces the desired result without altering the remaining code. Also, the author didn&#39;t tell us the context where this code is running. Maybe he is just trying to solve a school problem, solving a online exercise or running in a environment where the input is controlled (maybe not typed by a human being)"}, {"owner": {"reputation": 16229, "user_id": 525478, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/3b6c0b47a0c430a0b141baee7ea845be?s=128&d=identicon&r=PG", "display_name": "Brad Werth", "link": "https://stackoverflow.com/users/525478/brad-werth"}, "edited": false, "score": 0, "creation_date": 1488331064, "post_id": 42520298, "comment_id": 72179972, "body": "I just wanted the OP to be aware of the ramifications of evaling user-provided input..."}], "tags": [], "owner": {"reputation": 131, "user_id": 7604711, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a7d6d05052bb79667f3a116c71c11ae7?s=128&d=identicon&r=PG", "display_name": "Codextremist", "link": "https://stackoverflow.com/users/7604711/codextremist"}, "is_accepted": false, "score": 0, "last_activity_date": 1488322564, "creation_date": 1488322564, "answer_id": 42520298, "question_id": 42520184, "link": "https://stackoverflow.com/questions/42520184/ruby-code-involving-interpolation-not-giving-the-result-i-want/42520298#42520298", "title": "Ruby code involving interpolation not giving the result I want", "body": "<p>Short answer to get your output using the same structure of your current script. </p>\n\n<pre><code>puts \"You rolled a #{instance_eval(which_dice)}\"\n</code></pre>\n\n<p>However, there a better ways to accomplish this by using different data structures for example.</p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 3120236, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3189cc1b6071c03a74acd6e08b5cb127?s=128&d=identicon&r=PG", "display_name": "bchaiken", "link": "https://stackoverflow.com/users/3120236/bchaiken"}, "is_accepted": false, "score": 0, "last_activity_date": 1488323124, "creation_date": 1488323124, "answer_id": 42520409, "question_id": 42520184, "link": "https://stackoverflow.com/questions/42520184/ruby-code-involving-interpolation-not-giving-the-result-i-want/42520409#42520409", "title": "Ruby code involving interpolation not giving the result I want", "body": "<p>So, the quick and dirty response is that you are currently only returning the user inputted text from 'gets.chomp'. You are doing nothing with the variables above. Try this:</p>\n\n<pre><code>d4 = rand (1..4)\nd6 = rand (1..6)\nd8 = rand (1..8)\nd12 = rand (1..12)\nd20 = rand (1..20)\npercent = rand (1..100)\n\nputs \"Which dice would you like to roll?\"\nwhich_dice = gets.chomp\n\ncase\n  when which_dice == 'd4'\n    amount = d4\n  when which_dice == 'd6'\n    amount = d6\n  when which_dice == 'd8'\n    amount = d8\n  when which_dice == 'd12'\n    amount = d12\n  when which_dice == 'd20'\n    amount = d20\n  when which_dice == 'percent'\n    amount = percent\nend\n\nputs \"You rolled a #{amount}!\"\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 21, "user_id": 7638384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/135b014e34120f36207fa7143b2ef3ce?s=128&d=identicon&r=PG&f=1", "display_name": "Will Keller", "link": "https://stackoverflow.com/users/7638384/will-keller"}, "reply_to_user": {"reputation": 16229, "user_id": 525478, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/3b6c0b47a0c430a0b141baee7ea845be?s=128&d=identicon&r=PG", "display_name": "Brad Werth", "link": "https://stackoverflow.com/users/525478/brad-werth"}, "edited": false, "score": 0, "creation_date": 1488333641, "post_id": 42521278, "comment_id": 72180588, "body": "Not sure I follow. I wasn&#39;t trying to redesign his code, just answer the question that he asked. I&#39;m new to StackOverflow, so I may be approaching this wrong?"}, {"owner": {"reputation": 21, "user_id": 7638384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/135b014e34120f36207fa7143b2ef3ce?s=128&d=identicon&r=PG&f=1", "display_name": "Will Keller", "link": "https://stackoverflow.com/users/7638384/will-keller"}, "reply_to_user": {"reputation": 16229, "user_id": 525478, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/3b6c0b47a0c430a0b141baee7ea845be?s=128&d=identicon&r=PG", "display_name": "Brad Werth", "link": "https://stackoverflow.com/users/525478/brad-werth"}, "edited": false, "score": 0, "creation_date": 1488406111, "post_id": 42521278, "comment_id": 72221864, "body": "But his question wasn&#39;t about to better do the task, it was about why his gets return wasn&#39;t accessing his variables. I changed his code the minimum amount to answer the question. But as I said, I&#39;m new here, so I&#39;ll keep my eyes open and learn the idioms."}], "tags": [], "owner": {"reputation": 21, "user_id": 7638384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/135b014e34120f36207fa7143b2ef3ce?s=128&d=identicon&r=PG&f=1", "display_name": "Will Keller", "link": "https://stackoverflow.com/users/7638384/will-keller"}, "is_accepted": false, "score": 1, "last_activity_date": 1488328805, "creation_date": 1488328805, "answer_id": 42521278, "question_id": 42520184, "link": "https://stackoverflow.com/questions/42520184/ruby-code-involving-interpolation-not-giving-the-result-i-want/42521278#42521278", "title": "Ruby code involving interpolation not giving the result I want", "body": "<p>You are capturing a string value in which_dice, <em>not</em> a variable name. An easy way to get around that is to put the random values in an hash, and then use the string value to reference them by name.</p>\n\n<pre><code>dice = {\n  \"d4\" =&gt;  rand(1..4),\n  \"d6\" =&gt;  rand(1..6),\n  \"d8\" =&gt;  rand(1..8),\n  \"d10\" =&gt;  rand(1..10),\n  \"d12\" =&gt;  rand(1..12),\n  \"d20\" =&gt;  rand(1..20)\n}\n\nputs \"which dice would you like to roll?\"\nwhich_dice = gets.chomp\n\nputs \"You rolled a #{dice[which_dice]}\"\n</code></pre>\n\n<p>You can also use this for better error handling.</p>\n\n<pre><code>which_dice = dice[gets.chomp] || \"non-existent die.\"\nputs \"You rolled a #{which_dice}\"\n</code></pre>\n\n<p>will show an error message if they try to roll a d7.</p>\n"}], "owner": {"reputation": 11, "user_id": 7637805, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/71c7058bf1498c883509ecd7a6134e38?s=128&d=identicon&r=PG&f=1", "display_name": "KennyP", "link": "https://stackoverflow.com/users/7637805/kennyp"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 66, "favorite_count": 0, "answer_count": 4, "score": 0, "last_activity_date": 1488328805, "creation_date": 1488322088, "question_id": 42520184, "link": "https://stackoverflow.com/questions/42520184/ruby-code-involving-interpolation-not-giving-the-result-i-want", "title": "Ruby code involving interpolation not giving the result I want", "body": "<p>First time programmer and I am confused as to why my ruby code is not giving the result I want. I wrote a simple program to simulate rolling different multi-sided dice.</p>\n\n<pre><code>d4 = rand (1..4)\nd6 = rand (1..6)\nd8 = rand (1..8)\nd12 = rand (1..12)\nd20 = rand (1..20)\npercent = rand (1..100)\n\nputs \"Which dice would you like to roll?\"\nwhich_dice = gets.chomp\n\nputs \"You rolled a #{which_dice}!\"\n</code></pre>\n\n<p>The first six lines define each dice to output a random number between 1 and the number of sides of the dice has. I then ask the user to input the dice they want rolled with the gets method and then out put the result with the last line.</p>\n\n<p>The problem is that when the last line is executed it puts out \"You rolled a (what ever the user inputs with the gets method as a string)!\". For example, when the user inputs d8 when prompted it would puts \"You rolled a d8!\" instead of the actually random between 1 and 8 that I want. How can I have it so it puts an actual random number?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "activerecord"], "comments": [{"owner": {"reputation": 1843, "user_id": 4067720, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a52c645614505bcaeb65a6c5199158c1?s=128&d=identicon&r=PG", "display_name": "Glyoko", "link": "https://stackoverflow.com/users/4067720/glyoko"}, "edited": false, "score": 1, "creation_date": 1488321636, "post_id": 42519573, "comment_id": 72177145, "body": "Note sure if this will fix it, but the problem may be related to the fact that your model is called <code>Object</code>. I strongly suggest that you rename it to something more descriptive of the data it holds. <code>Object</code> is the name of one of the most basic classes in ruby and if you use it as a model you might have some subtle namespace collisions and could see extremely weird behavior. I don&#39;t <i>think</i> this is related to your current problem, but it may be and you should change it nonetheless."}, {"owner": {"reputation": 691, "user_id": 4761914, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/xyiAo.jpg?s=128&g=1", "display_name": "Antonio", "link": "https://stackoverflow.com/users/4761914/antonio"}, "reply_to_user": {"reputation": 1843, "user_id": 4067720, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a52c645614505bcaeb65a6c5199158c1?s=128&d=identicon&r=PG", "display_name": "Glyoko", "link": "https://stackoverflow.com/users/4067720/glyoko"}, "edited": false, "score": 0, "creation_date": 1488322078, "post_id": 42519573, "comment_id": 72177341, "body": "That was done to obscure the data I&#39;m working on. It&#39;s not really called <code>Object</code>"}, {"owner": {"reputation": 1843, "user_id": 4067720, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a52c645614505bcaeb65a6c5199158c1?s=128&d=identicon&r=PG", "display_name": "Glyoko", "link": "https://stackoverflow.com/users/4067720/glyoko"}, "edited": false, "score": 1, "creation_date": 1488322307, "post_id": 42519573, "comment_id": 72177428, "body": "Well, nevermind then. I was actually wondering how you managed to get Object to inherit ActiveRecord::Base in the first place!"}], "answers": [{"comments": [{"owner": {"reputation": 1843, "user_id": 4067720, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a52c645614505bcaeb65a6c5199158c1?s=128&d=identicon&r=PG", "display_name": "Glyoko", "link": "https://stackoverflow.com/users/4067720/glyoko"}, "edited": false, "score": 0, "creation_date": 1488322310, "post_id": 42520056, "comment_id": 72177430, "body": "I think it&#39;s a quirk of SQL joins that allows duplicates to be returned in some cases. Your solution using distinct seems correct here."}], "tags": [], "owner": {"reputation": 691, "user_id": 4761914, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/xyiAo.jpg?s=128&g=1", "display_name": "Antonio", "link": "https://stackoverflow.com/users/4761914/antonio"}, "is_accepted": true, "score": 2, "last_activity_date": 1488321491, "creation_date": 1488321491, "answer_id": 42520056, "question_id": 42519573, "link": "https://stackoverflow.com/questions/42519573/rails-activerecord-query-with-an-array-of-objects-returns-multiple-duplicates-of/42520056#42520056", "title": "Rails Activerecord query with an array of objects returns multiple duplicates of objects", "body": "<p>Adding <code>.distinct</code> to the end of my query solved my issues and will omit duplicate records. </p>\n\n<p>My now working query is:</p>\n\n<p><code>@objects = Object.joins(:packages).where(\"packages.kind IN (?)\", packages).distinct</code></p>\n"}], "owner": {"reputation": 691, "user_id": 4761914, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/xyiAo.jpg?s=128&g=1", "display_name": "Antonio", "link": "https://stackoverflow.com/users/4761914/antonio"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 608, "favorite_count": 0, "accepted_answer_id": 42520056, "answer_count": 1, "score": 1, "last_activity_date": 1488321491, "creation_date": 1488319418, "last_edit_date": 1488320942, "question_id": 42519573, "link": "https://stackoverflow.com/questions/42519573/rails-activerecord-query-with-an-array-of-objects-returns-multiple-duplicates-of", "title": "Rails Activerecord query with an array of objects returns multiple duplicates of objects", "body": "<p>I have a series of checkboxes a user can use to find objects by the checked attributes. I want them to be able to select a number of attributes and then be shown a list of objects that contain <em>all</em> of those checked attributes.</p>\n\n<p>My code is partially working, except that if I check one attribute and I'm given a list and then I check another attribute, that was already displayed from the previous check, then I'm given another copy. Here is an image of what is happening. Notice that objects are being repeated.</p>\n\n<p><a href=\"https://i.stack.imgur.com/oIrqK.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/oIrqK.png\" alt=\"enter image description here\"></a></p>\n\n<p>Here is the code that goes with it:</p>\n\n<pre><code>&lt;div class=\"col-md-2\"&gt;\n    &lt;div class=\"dropdown package-dropdown\"&gt;\n      &lt;button class=\"btn btn-secondary dropdown-toggle\" type=\"button\" id=\"dropdownMenuButton\" data-toggle=\"dropdown\" aria-haspopup=\"true\" aria-expanded=\"false\"&gt;Attributes&lt;/button&gt;\n      &lt;ul class=\"dropdown-menu\" aria-labelledby=\"dropdownMenuButton\"&gt;\n        &lt;li&gt;&lt;a href=\"#\" class=\"small\" data-value=\"attr1\" tabIndex=\"-1\"&gt;&lt;input type=\"checkbox\"/&gt;attr1&lt;/a&gt;&lt;/li&gt;\n        &lt;li&gt;&lt;a href=\"#\" class=\"small\" data-value=\"attr2\" tabIndex=\"-1\"&gt;&lt;input type=\"checkbox\"/&gt;attr2&lt;/a&gt;&lt;/li&gt;\n        &lt;li&gt;&lt;a href=\"#\" class=\"small\" data-value=\"attr3\" tabIndex=\"-1\"&gt;&lt;input type=\"checkbox\"/&gt;attr3&lt;/a&gt;&lt;/li&gt;\n        &lt;li&gt;&lt;a href=\"#\" class=\"small\" data-value=\"attr4\" tabIndex=\"-1\"&gt;&lt;input type=\"checkbox\"/&gt;attr4&lt;/a&gt;&lt;/li&gt;\n        &lt;li&gt;&lt;a href=\"#\" class=\"small\" data-value=\"attr5\" tabIndex=\"-1\"&gt;&lt;input type=\"checkbox\"/&gt;attr5&lt;/a&gt;&lt;/li&gt;\n      &lt;/ul&gt;\n    &lt;/div&gt;\n&lt;/div&gt;\n\n&lt;!-- removed irrelevant code for brevity --&gt;\n\n  &lt;tbody id=\"hits\"&gt;\n    &lt;% @objects.each do |obj| %&gt;\n      &lt;tr&gt;\n        &lt;td&gt;&lt;%= link_to obj.title, obj_path(obj) %&gt;&lt;/td&gt;\n          &lt;td class=\"package-column\"&gt;\n          &lt;% if obj.packages.any? %&gt;\n            &lt;div&gt;\n            &lt;% obj.packages.each do |p| %&gt;\n              &lt;span&gt;&lt;%= image_tag \"needs-#{p.kind}\", :alt =&gt; \"#{p.kind}\", :class =&gt; \"foobar\" %&gt;&lt;/span&gt;\n            &lt;% end %&gt;\n            &lt;/div&gt;\n          &lt;% else %&gt;\n            &lt;div class=\"package-column\"&gt;&lt;span&gt;...&lt;/span&gt;&lt;/div&gt;\n        &lt;% end %&gt;\n        &lt;/td&gt;\n        &lt;td&gt;&lt;%= obj.capacity %&gt;&lt;/td&gt;\n        &lt;td&gt;&lt;%= obj.started_at.strftime('%A, %B %e, %Y at %l:%M %p') if obj.started_at? %&gt;&lt;/td&gt;\n      &lt;/tr&gt;\n    &lt;% end %&gt;\n    &lt;tr&gt;&lt;td colspan=\"4\" align=\"center\"&gt;&lt;%= link_to \"Load More\", objects_path, class: \"load-more\" %&gt;&lt;/td&gt;&lt;/tr&gt;\n  &lt;/tbody&gt;\n&lt;/table&gt;\n\nvar options = [];\n$('.dropdown-menu li a').on( 'click', function(event) {\n var $target = $( event.currentTarget ),\n     val = $target.attr( 'data-value' ),\n     $inp = $target.find( 'input' ),\n     idx;\n\n if ( ( idx = options.indexOf( val ) ) &gt; -1 ) {\n    options.splice( idx, 1 );\n    setTimeout( function() { $inp.prop( 'checked', false ) }, 0);\n } else {\n    options.push( val );\n    setTimeout( function() { $inp.prop( 'checked', true ) }, 0);\n }\n\n $( event.target ).blur();\n\n  console.log( options );\n  $.ajax({\n    url:  $(this).attr('href'),\n    type: \"GET\",\n    data: {\n      packages: options\n    },\n    dataType: \"script\"\n  })\n  return false;\n});\n</code></pre>\n\n<p>My controller where the active record query is.</p>\n\n<pre><code>def index\n  if params[:packages]\n    packages = params[:packages] # [\"attr1\", \"attr3\" etc..]\n    @objects = Object.joins(:packages).where(\"packages.kind IN (?)\", packages)\n  end\n\n  respond_to do |format|\n    format.html\n    format.js\n  end\nend\n</code></pre>\n\n<p>I am sure it's an Activerecord issue and not a display issue because if I inspect <code>@objects</code> I'm shown multiple copies of records like so:</p>\n\n<pre><code>[8] pry(#&lt;ObjectsController&gt;)&gt; @objects\n=&gt; [#&lt;Object:0x007f991cb1d6b0\n  id: 2,\n  uuid: \"1adede0e-8585-41a5-8c74-8de8eec6a141\",\n  name: \"andy-title1\",\n  title: \"Andy - Title1\",\n  started_at: Mon, 27 Mar 2017 13:00:24 PDT -07:00,\n  ended_at: Mon, 27 Mar 2017 18:00:24 PDT -07:00\n #&lt;Object:0x007f991cb1d548\n  id: 2,\n  uuid: \"1adede0e-8585-41a5-8c74-8de8eec6a141\",\n  name: \"andy-title1\",\n  title: \"Andy - Title1\",\n  started_at: Mon, 27 Mar 2017 13:00:24 PDT -07:00,\n  ended_at: Mon, 27 Mar 2017 18:00:24 PDT -07:00\n</code></pre>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 1, "creation_date": 1488321650, "post_id": 42519557, "comment_id": 72177149, "body": "If you like OpenStruct you&#39;ll love <a href=\"https://github.com/intridea/hashie\" rel=\"nofollow noreferrer\">Hashie</a>."}, {"owner": {"reputation": 1393, "user_id": 6206501, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JENfJ.jpg?s=128&g=1", "display_name": "Abhilash Reddy", "link": "https://stackoverflow.com/users/6206501/abhilash-reddy"}, "edited": false, "score": 0, "creation_date": 1539589928, "post_id": 42519557, "comment_id": 92541904, "body": "@donato I know this is an old question. But please check my answer here <a href=\"https://stackoverflow.com/questions/26809848/convert-hash-to-object/52745801#52745801\" title=\"convert hash to object\">stackoverflow.com/questions/26809848/convert-hash-to-object/&zwnj;&#8203;&hellip;</a> and let me know if that helps."}, {"owner": {"reputation": 1393, "user_id": 6206501, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JENfJ.jpg?s=128&g=1", "display_name": "Abhilash Reddy", "link": "https://stackoverflow.com/users/6206501/abhilash-reddy"}, "edited": false, "score": 0, "creation_date": 1539590145, "post_id": 42519557, "comment_id": 92542024, "body": "I&#39;ve created a PR  <a href=\"https://github.com/ruby/ostruct/pull/5\" rel=\"nofollow noreferrer\">github.com/ruby/ostruct/pull/5</a> for openstruct to include this in the library itself. Please support it if you think it will help others like you."}], "answers": [{"comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1488321525, "post_id": 42519685, "comment_id": 72177099, "body": "Messy, but functional. There&#39;s better ways though."}, {"owner": {"reputation": 1066, "user_id": 1449926, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0d203a22a644907b1352a7de11a4a73e?s=128&d=identicon&r=PG", "display_name": "Mikey T.K.", "link": "https://stackoverflow.com/users/1449926/mikey-t-k"}, "edited": false, "score": 1, "creation_date": 1522388550, "post_id": 42519685, "comment_id": 86145997, "body": "Dependencies? Openstruct and Json are part of the standard library."}, {"owner": {"reputation": 1719, "user_id": 634401, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/8d59c978430a1254eca78336f0272a61?s=128&d=identicon&r=PG", "display_name": "Tony Beninate", "link": "https://stackoverflow.com/users/634401/tony-beninate"}, "edited": false, "score": 0, "creation_date": 1532527064, "post_id": 42519685, "comment_id": 90010278, "body": "Nice, this seems to work well. One difference I encountered is I had to call <code>object.table.c.d</code>."}], "tags": [], "owner": {"reputation": 5850, "user_id": 4501354, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/1230cfcc7f68488ad19d0022cf7b1a93?s=128&d=identicon&r=PG&f=1", "display_name": "Donato", "link": "https://stackoverflow.com/users/4501354/donato"}, "is_accepted": false, "score": 26, "last_activity_date": 1488319914, "creation_date": 1488319914, "answer_id": 42519685, "question_id": 42519557, "link": "https://stackoverflow.com/questions/42519557/convert-hash-to-openstruct-recursively/42519685#42519685", "title": "Convert Hash to OpenStruct recursively", "body": "<p>I came up with this solution:</p>\n\n<pre><code>h = { a: 'a', b: 'b', c: { d: 'd', e: 'e'} }\njson = h.to_json\n=&gt; \"{\\\"a\\\":\\\"a\\\",\\\"b\\\":\\\"b\\\",\\\"c\\\":{\\\"d\\\":\\\"d\\\",\\\"e\\\":\\\"e\\\"}}\" \nobject = JSON.parse(json, object_class:OpenStruct)\nobject.c.d\n =&gt; \"d\" \n</code></pre>\n\n<p>So for this to work, I had to do an extra step: convert it to json.</p>\n"}, {"comments": [{"owner": {"reputation": 2659, "user_id": 2534479, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/2472926967c5dbb6e31895a660a472ce?s=128&d=identicon&r=PG", "display_name": "aldrien.h", "link": "https://stackoverflow.com/users/2534479/aldrien-h"}, "edited": false, "score": 1, "creation_date": 1535092948, "post_id": 42520668, "comment_id": 90946715, "body": "i used your answer and works well with hash, what about if having array value with hash inside e.g. { a: &#39;a&#39;, b: &#39;b&#39;, c: [{ d: &#39;d&#39;, e: &#39;e&#39;}] }, so I can do c.d =&gt; &#39;d&#39; Thanks :)"}, {"owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "reply_to_user": {"reputation": 2659, "user_id": 2534479, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/2472926967c5dbb6e31895a660a472ce?s=128&d=identicon&r=PG", "display_name": "aldrien.h", "link": "https://stackoverflow.com/users/2534479/aldrien-h"}, "edited": false, "score": 0, "creation_date": 1543342990, "post_id": 42520668, "comment_id": 93881407, "body": "@aldrien.h If you had <code>{c: [{d: &#39;d&#39;}]}</code> why would you want to use <code>c.d</code>? How would that work if you had multiple hashes in the array?"}, {"owner": {"reputation": 2659, "user_id": 2534479, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/2472926967c5dbb6e31895a660a472ce?s=128&d=identicon&r=PG", "display_name": "aldrien.h", "link": "https://stackoverflow.com/users/2534479/aldrien-h"}, "edited": false, "score": 0, "creation_date": 1543364842, "post_id": 42520668, "comment_id": 93890380, "body": "my mistake, i forgot to say, it inside a loop :)"}, {"owner": {"reputation": 318, "user_id": 49807, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/d654e843c62f59b15952cb1c5135f63a?s=128&d=identicon&r=PG", "display_name": "Ton\u010di D.", "link": "https://stackoverflow.com/users/49807/ton%c4%8di-d"}, "edited": false, "score": 1, "creation_date": 1547212566, "post_id": 42520668, "comment_id": 95125585, "body": "The <code>JSON.parse</code> answer is far more flexible and elegant."}, {"owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "reply_to_user": {"reputation": 318, "user_id": 49807, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/d654e843c62f59b15952cb1c5135f63a?s=128&d=identicon&r=PG", "display_name": "Ton\u010di D.", "link": "https://stackoverflow.com/users/49807/ton%c4%8di-d"}, "edited": false, "score": 1, "creation_date": 1547242110, "post_id": 42520668, "comment_id": 95139552, "body": "@Ton\u010diD. it&#39;s really not. The problem is that not everything can be converted to JSON and keep its same Ruby class. For example <code>JSON.parse({now: Time.now}.to_json)[&quot;now&quot;].class == String</code> ... The <code>Time.now</code> is no longer a <code>Time</code> object when you parse/unparse it."}, {"owner": {"reputation": 318, "user_id": 49807, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/d654e843c62f59b15952cb1c5135f63a?s=128&d=identicon&r=PG", "display_name": "Ton\u010di D.", "link": "https://stackoverflow.com/users/49807/ton%c4%8di-d"}, "edited": false, "score": 0, "creation_date": 1547462139, "post_id": 42520668, "comment_id": 95187920, "body": "@maxpleaner Agreed. I was biased towards what worked for my situation."}, {"owner": {"reputation": 494, "user_id": 625822, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/909658b0cd7be2f7dd812e5f3408c56c?s=128&d=identicon&r=PG", "display_name": "Medardas", "link": "https://stackoverflow.com/users/625822/medardas"}, "edited": false, "score": 1, "creation_date": 1582971646, "post_id": 42520668, "comment_id": 106965478, "body": "@maxpleaner adding this line below <code>memo[key] = ...</code> would take care of arrays:  <code>memo[key] = val.map { |v| v.is_a?(Hash) ? to_recursive_ostruct(v) : v } if val.is_a?(Array)</code>"}], "tags": [], "owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "is_accepted": true, "score": 18, "last_activity_date": 1547242595, "last_edit_date": 1547242595, "creation_date": 1488324808, "answer_id": 42520668, "question_id": 42519557, "link": "https://stackoverflow.com/questions/42519557/convert-hash-to-openstruct-recursively/42520668#42520668", "title": "Convert Hash to OpenStruct recursively", "body": "<p>personally I use the <code>recursive-open-struct</code> gem - it's then as simple as <code>RecursiveOpenStruct.new(&lt;nested_hash&gt;)</code></p>\n\n<p>But for the sake of recursion practice, I'll show you a fresh solution:</p>\n\n<pre><code>require 'ostruct'\n\ndef to_recursive_ostruct(hash)\n  OpenStruct.new(hash.each_with_object({}) do |(key, val), memo|\n    memo[key] = val.is_a?(Hash) ? to_recursive_ostruct(val) : val\n  end)\nend\n\nputs to_recursive_ostruct(a: { b: 1}).a.b\n# =&gt; 1\n</code></pre>\n\n<p><em>edit</em></p>\n\n<p>the reason this is better than the JSON-based solutions is because you can lose some data when you convert to JSON. For example if you convert a Time object to JSON and then parse it, it will be a string. There are many other examples of this:</p>\n\n<pre><code>class Foo; end\nJSON.parse({obj: Foo.new}.to_json)[\"obj\"]\n# =&gt; \"#&lt;Foo:0x00007fc8720198b0&gt;\"\n</code></pre>\n\n<p>yeah ... not super useful. You've completely lost your reference to the actual instance.</p>\n"}, {"comments": [{"owner": {"reputation": 2241, "user_id": 313736, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0e8ab03fa3d7df29c90a950f069aad62?s=128&d=identicon&r=PG", "display_name": "chris finne", "link": "https://stackoverflow.com/users/313736/chris-finne"}, "edited": false, "score": 6, "creation_date": 1516823674, "post_id": 45851976, "comment_id": 83852001, "body": "Been using Ruby for over 10 years and I&#39;m still surprised by its elegance."}, {"owner": {"reputation": 3638, "user_id": 1977104, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1fe5f45f44332caa3a105c05382c8e7b?s=128&d=identicon&r=PG", "display_name": "Wasif Hossain", "link": "https://stackoverflow.com/users/1977104/wasif-hossain"}, "edited": false, "score": 2, "creation_date": 1519904374, "post_id": 45851976, "comment_id": 85101928, "body": "Though it should work to solve the problem, but this process has some side-effects like it will change the default <code>Hash</code> behavior in all places in the project, which might create unforeseen issues in coming days. So I would rather go with max_pleaner or Donato   <code>JSON.parse(h.to_json, object_class: OpenStruct)</code>which seems to solve the issue in place without side-effects."}, {"owner": {"reputation": 4079, "user_id": 286286, "user_type": "registered", "accept_rate": 83, "profile_image": "https://graph.facebook.com/36818590/picture?type=large", "display_name": "Jack Kinsella", "link": "https://stackoverflow.com/users/286286/jack-kinsella"}, "edited": false, "score": 2, "creation_date": 1520191804, "post_id": 45851976, "comment_id": 85204261, "body": "FYI this only works with simple values. I had issues when I applied this  approach to more complex objects (e.g. BigDecimal or custom ActiveRecord objects)"}], "tags": [], "owner": {"reputation": 2390, "user_id": 4812050, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/hzLjT.jpg?s=128&g=1", "display_name": "Cruz Nunez", "link": "https://stackoverflow.com/users/4812050/cruz-nunez"}, "is_accepted": false, "score": 34, "last_activity_date": 1511951379, "last_edit_date": 1511951379, "creation_date": 1503541413, "answer_id": 45851976, "question_id": 42519557, "link": "https://stackoverflow.com/questions/42519557/convert-hash-to-openstruct-recursively/45851976#45851976", "title": "Convert Hash to OpenStruct recursively", "body": "<p>You can monkey-patch the <code>Hash</code> class</p>\n\n<pre><code>class Hash\n  def to_o\n    JSON.parse to_json, object_class: OpenStruct\n  end\nend\n</code></pre>\n\n<p>then you can say</p>\n\n<pre><code>h = { a: 'a', b: 'b', c: { d: 'd', e: 'e'} }\no = h.to_o\no.c.d # =&gt; 'd'\n</code></pre>\n\n<p>See <a href=\"https://coderwall.com/p/74rajw/convert-a-complex-nested-hash-to-an-object\" rel=\"noreferrer\">Convert a complex nested hash to an object</a>.</p>\n"}, {"comments": [{"owner": {"reputation": 314, "user_id": 4183903, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/603772609/picture?type=large", "display_name": "Christiano Matos", "link": "https://stackoverflow.com/users/4183903/christiano-matos"}, "edited": false, "score": 0, "creation_date": 1598809426, "post_id": 57262111, "comment_id": 112572024, "body": "as each_with_object is deprecated, for me this is the best solution"}], "tags": [], "owner": {"reputation": 19225, "user_id": 53926, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/4df1cfae6e8c7fbdb013818785318aa7?s=128&d=identicon&r=PG", "display_name": "Xavi", "link": "https://stackoverflow.com/users/53926/xavi"}, "is_accepted": false, "score": 4, "last_activity_date": 1564439393, "creation_date": 1564439393, "answer_id": 57262111, "question_id": 42519557, "link": "https://stackoverflow.com/questions/42519557/convert-hash-to-openstruct-recursively/57262111#57262111", "title": "Convert Hash to OpenStruct recursively", "body": "<p>Here's a recursive solution that avoids converting the hash to json:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>def to_o(obj)\n  if obj.is_a?(Hash)\n    return OpenStruct.new(obj.map{ |key, val| [ key, to_o(val) ] }.to_h)\n  elsif obj.is_a?(Array)\n    return obj.map{ |o| to_o(o) }\n  else # Assumed to be a primitive value\n    return obj\n  end\nend\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 2630849, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39e503fe0cfca3a666d1d6f9f2da8345?s=128&d=identicon&r=PG", "display_name": "AlexWayfer", "link": "https://stackoverflow.com/users/2630849/alexwayfer"}, "is_accepted": false, "score": 0, "last_activity_date": 1596629440, "creation_date": 1596629440, "answer_id": 63264908, "question_id": 42519557, "link": "https://stackoverflow.com/questions/42519557/convert-hash-to-openstruct-recursively/63264908#63264908", "title": "Convert Hash to OpenStruct recursively", "body": "<p>My solution, based on <a href=\"https://stackoverflow.com/a/42520668/2630849\">max pleaner's answer</a> and similar to <a href=\"https://stackoverflow.com/a/57262111/2630849\">Xavi's answer</a>:</p>\n<pre class=\"lang-ruby prettyprint-override\"><code>require 'ostruct'\n\ndef initialize_open_struct_deeply(value)\n  case value\n  when Hash\n    OpenStruct.new(value.transform_values { |hash_value| send __method__, hash_value })\n  when Array\n    value.map { |element| send __method__, element }\n  else\n    value\n  end\nend\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 69, "user_id": 3061390, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a7f896e3a66510222d9da935587f3c8e?s=128&d=identicon&r=PG&f=1", "display_name": "railsfanatic", "link": "https://stackoverflow.com/users/3061390/railsfanatic"}, "is_accepted": false, "score": 0, "last_activity_date": 1614200350, "creation_date": 1614200350, "answer_id": 66358755, "question_id": 42519557, "link": "https://stackoverflow.com/questions/42519557/convert-hash-to-openstruct-recursively/66358755#66358755", "title": "Convert Hash to OpenStruct recursively", "body": "<p>Here is one way to override the initializer so you can do <code>OpenStruct.new({ a: &quot;b&quot;, c: { d: &quot;e&quot;, f: [&quot;g&quot;, &quot;h&quot;, &quot;i&quot;] }})</code>.</p>\n<p>Further, this class is included when you <code>require 'json'</code>, so be sure to do this patch after the <code>require</code>.</p>\n<pre class=\"lang-rb prettyprint-override\"><code>class OpenStruct\n  def initialize(hash = nil)\n    @table = {}\n    if hash\n      hash.each_pair do |k, v|\n        self[k] = v.is_a?(Hash) ? OpenStruct.new(v) : v\n      end\n    end\n  end\n\n  def keys\n    @table.keys.map{|k| k.to_s}\n  end\nend\n</code></pre>\n"}], "owner": {"reputation": 5850, "user_id": 4501354, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/1230cfcc7f68488ad19d0022cf7b1a93?s=128&d=identicon&r=PG&f=1", "display_name": "Donato", "link": "https://stackoverflow.com/users/4501354/donato"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 11466, "favorite_count": 3, "accepted_answer_id": 42520668, "answer_count": 6, "score": 21, "last_activity_date": 1614200350, "creation_date": 1488319362, "question_id": 42519557, "link": "https://stackoverflow.com/questions/42519557/convert-hash-to-openstruct-recursively", "title": "Convert Hash to OpenStruct recursively", "body": "<p>Given I have this hash:</p>\n\n<pre><code> h = { a: 'a', b: 'b', c: { d: 'd', e: 'e'} }\n</code></pre>\n\n<p>And I convert to OpenStruct:</p>\n\n<pre><code>o = OpenStruct.new(h)\n =&gt; #&lt;OpenStruct a=\"a\", b=\"b\", c={:d=&gt;\"d\", :e=&gt;\"e\"}&gt; \no.a\n =&gt; \"a\" \no.b\n =&gt; \"b\" \no.c\n =&gt; {:d=&gt;\"d\", :e=&gt;\"e\"} \n2.1.2 :006 &gt; o.c.d\nNoMethodError: undefined method `d' for {:d=&gt;\"d\", :e=&gt;\"e\"}:Hash\n</code></pre>\n\n<p>I want all the nested keys to be methods as well. So I can access <code>d</code> as such:</p>\n\n<pre><code>o.c.d\n=&gt; \"d\"\n</code></pre>\n\n<p>How can I achieve this?</p>\n"}, {"tags": ["jquery", "ruby-on-rails", "ruby", "ajax"], "answers": [{"tags": [], "owner": {"reputation": 1670, "user_id": 6388521, "user_type": "registered", "accept_rate": 69, "profile_image": "https://lh4.googleusercontent.com/-VdFWPJVSpRc/AAAAAAAAAAI/AAAAAAAAAFo/vCc8QOz6v9Y/photo.jpg?sz=128", "display_name": "Ruslan", "link": "https://stackoverflow.com/users/6388521/ruslan"}, "is_accepted": false, "score": 3, "last_activity_date": 1488319130, "creation_date": 1488319130, "answer_id": 42519515, "question_id": 42519469, "link": "https://stackoverflow.com/questions/42519469/rails-ajax-request-not-processing-as-js-but/42519515#42519515", "title": "Rails AJAX request not processing as JS but */*", "body": "<p>try:</p>\n\n<p><code>dataType: 'script'</code></p>\n\n<p>that might work</p>\n"}, {"comments": [{"owner": {"reputation": 6076, "user_id": 4044009, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/42e57031eb7d02c47c9afaecfc878638?s=128&d=identicon&r=PG&f=1", "display_name": "Neil", "link": "https://stackoverflow.com/users/4044009/neil"}, "edited": false, "score": 0, "creation_date": 1488807809, "post_id": 42522998, "comment_id": 72382017, "body": "Same thing: the logs still say: <code>Processing by UsersController#change_food as *&#47;*</code>.  As before: it still works, it just says <code>*&#47;*</code> instead of <code>JS</code>."}], "tags": [], "owner": {"reputation": 1812, "user_id": 4627335, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/kZFZA.jpg?s=128&g=1", "display_name": "ashvin", "link": "https://stackoverflow.com/users/4627335/ashvin"}, "is_accepted": false, "score": 0, "last_activity_date": 1488341218, "creation_date": 1488341218, "answer_id": 42522998, "question_id": 42519469, "link": "https://stackoverflow.com/questions/42519469/rails-ajax-request-not-processing-as-js-but/42522998#42522998", "title": "Rails AJAX request not processing as JS but */*", "body": "<p>try</p>\n\n<pre><code>contentType: \"text/javascript\"\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1670, "user_id": 6388521, "user_type": "registered", "accept_rate": 69, "profile_image": "https://lh4.googleusercontent.com/-VdFWPJVSpRc/AAAAAAAAAAI/AAAAAAAAAFo/vCc8QOz6v9Y/photo.jpg?sz=128", "display_name": "Ruslan", "link": "https://stackoverflow.com/users/6388521/ruslan"}, "is_accepted": false, "score": 0, "last_activity_date": 1488379000, "creation_date": 1488379000, "answer_id": 42534497, "question_id": 42519469, "link": "https://stackoverflow.com/questions/42519469/rails-ajax-request-not-processing-as-js-but/42534497#42534497", "title": "Rails AJAX request not processing as JS but */*", "body": "<p>How about adding the headers?</p>\n\n<p><code>headers: {Accept: '*/*;q=0.5, text/javascript, application/javascript, application/ecmascript, application/x-ecmascript'}</code></p>\n"}, {"comments": [{"owner": {"reputation": 885, "user_id": 1412858, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aec6f11ae7c5da01ac16111c0ee71e6f?s=128&d=identicon&r=PG", "display_name": "Kalyan Raghu", "link": "https://stackoverflow.com/users/1412858/kalyan-raghu"}, "edited": false, "score": 0, "creation_date": 1600411134, "post_id": 42649148, "comment_id": 113084753, "body": "For Rails 5.2 with rails-ujs only <code>dataType</code> is working. Setting <code>contentType</code> is not working"}], "tags": [], "owner": {"reputation": 20458, "user_id": 122087, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/431c64e3e3fd0c892ad2a7e4150cf63e?s=128&d=identicon&r=PG", "display_name": "Paul A Jungwirth", "link": "https://stackoverflow.com/users/122087/paul-a-jungwirth"}, "is_accepted": true, "score": 4, "last_activity_date": 1488892010, "creation_date": 1488892010, "answer_id": 42649148, "question_id": 42519469, "link": "https://stackoverflow.com/questions/42519469/rails-ajax-request-not-processing-as-js-but/42649148#42649148", "title": "Rails AJAX request not processing as JS but */*", "body": "<p>The first problem is that keys in Javascript objects are case-sensitive, so <code>datatype</code> is not the same thing as <code>dataType</code>.</p>\n\n<p>Second, the <code>dataType</code> key is not the same as <code>contentType</code>, although if you leave off <code>contentType</code> jQuery will infer it from <code>dataType</code>. In your case you want <code>script</code>, not <code>application/js</code> (as @Ruslan also pointed out).</p>\n\n<p>Putting those together, you want:</p>\n\n<pre><code>$.ajax({\n  url: url,\n  type: \"GET\",\n  dataType: \"script\",\n  data: {food_type_id: $(this).val()}\n})\n</code></pre>\n\n<p>If that still doesn't work, I would look for places where you are globally setting <code>contentType</code>, e.g. by calling <code>$.ajaxSetup</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 6076, "user_id": 4044009, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/42e57031eb7d02c47c9afaecfc878638?s=128&d=identicon&r=PG&f=1", "display_name": "Neil", "link": "https://stackoverflow.com/users/4044009/neil"}, "edited": false, "score": 0, "creation_date": 1488930002, "post_id": 42650215, "comment_id": 72446722, "body": "Yes that was a typo, I will update my question. Thanks!  Your solution was the only one that worked for me!"}], "tags": [], "owner": {"reputation": 5382, "user_id": 7671538, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3506350bc4dd02281ad7f99e8e84715c?s=128&d=identicon&r=PG&f=1", "display_name": "gwcodes", "link": "https://stackoverflow.com/users/7671538/gwcodes"}, "is_accepted": false, "score": 1, "last_activity_date": 1488895001, "creation_date": 1488895001, "answer_id": 42650215, "question_id": 42519469, "link": "https://stackoverflow.com/questions/42519469/rails-ajax-request-not-processing-as-js-but/42650215#42650215", "title": "Rails AJAX request not processing as JS but */*", "body": "<p>Try appending <code>.js</code> to your <code>user_food_change_js_path</code>.</p>\n\n<p>Also - is <code>change_food_js.erb</code> a typo? I would have expected <code>change_food.js.erb</code> (dot instead of underscore)</p>\n"}], "owner": {"reputation": 6076, "user_id": 4044009, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/42e57031eb7d02c47c9afaecfc878638?s=128&d=identicon&r=PG&f=1", "display_name": "Neil", "link": "https://stackoverflow.com/users/4044009/neil"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1554, "favorite_count": 1, "accepted_answer_id": 42649148, "answer_count": 5, "score": 3, "last_activity_date": 1489156930, "creation_date": 1488318889, "last_edit_date": 1489156930, "question_id": 42519469, "link": "https://stackoverflow.com/questions/42519469/rails-ajax-request-not-processing-as-js-but", "title": "Rails AJAX request not processing as JS but */*", "body": "<p>My ajax request works, but I do not understand the server logs.  When I look at the server logs it says the following for the ajax request:</p>\n\n<pre><code>Processing by UsersController#change_food as */*\n</code></pre>\n\n<p>I do not know why it is saying <code>*/*</code>.  I would expect it to say <code>JS</code> like so:</p>\n\n<pre><code>Processing by UsersController#change_food as JS\n</code></pre>\n\n<p>Here is the entire flow of things. For this ajax request: I simply binded an event listener for when a select box changes, and then I submit an ajax request when the selection changes.  Here is that form field:</p>\n\n<pre><code># _form.html.erb\n&lt;div class=\"field\"&gt;\n  &lt;%= f.label :food_type_id %&gt;\n  &lt;%= f.collection_select :food_type_id, FoodType.all, :id, :name, {}, {data: {action: 'food_sel', food_change_js_url: \"#{user_food_change_js_path}\"}} %&gt;        \n&lt;/div&gt;\n</code></pre>\n\n<p>And here is the actual ajax request:</p>\n\n<pre><code># application.js\n$(document).on('turbolinks:load', function() {\n\n  $('[data-action=\"food_sel\"]').on('change', function(){\n    var url = $(this).data('food-change-js-url');\n\n    $.ajax({\n      url: url,\n      type: \"GET\",\n      datatype: \"application/js\",\n      data: {food_type_id: $(this).val()}\n    })\n\n  });\n\n});\n</code></pre>\n\n<p>Here is the relevant route:</p>\n\n<pre><code># routes.rb \nget 'user_food_change_js', to: 'users#change_food'\n</code></pre>\n\n<p>Which routes the ajax request to this controller:</p>\n\n<pre><code># users_controller.rb\ndef change_food\n  respond_to do |format|\n    format.js\n  end\nend\n</code></pre>\n\n<p>Which renders this view:</p>\n\n<pre><code># change_food.js.erb\nalert(\"hello world\");\n</code></pre>\n\n<p>I originally hoped that I could just put <code>remote: true</code> on the select box, and that then whenever the selection changes it would shoot an ajax request up to the server.  Unfortunately <code>remote: true</code> only works for a couple things: like for your <code>form_for</code>, your <code>form_tag</code>, your links, and your buttons.  I couldn't think of a cleaner why of sending an ajax request (via js) to the server when an event is triggered. </p>\n\n<p><strong>Question</strong>: I feel like I am doing something unconventional since the server log does not say it is processing by <code>JS</code> but instead <code>*/*</code>.  Is there a more conventional way to do this? One that will say it is processing by <code>JS</code>? </p>\n\n<hr>\n\n<p><strong>Update</strong></p>\n\n<p>Based on accepted answer: all I had to do was camelCase the <code>dataType</code> key and set it properly.  Everything else staying the same: it got it working:</p>\n\n<pre><code># application.js\n$(document).on('turbolinks:load', function() {\n\n  $('[data-action=\"food_sel\"]').on('change', function(){\n    var url = $(this).data('food-change-js-url');\n\n    $.ajax({\n      url: url,\n      type: \"GET\",\n      dataType: \"script\",\n      data: {food_type_id: $(this).val()}\n    })\n\n  });\n\n});\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "schedule"], "answers": [{"comments": [{"owner": {"reputation": 1843, "user_id": 4067720, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a52c645614505bcaeb65a6c5199158c1?s=128&d=identicon&r=PG", "display_name": "Glyoko", "link": "https://stackoverflow.com/users/4067720/glyoko"}, "edited": false, "score": 1, "creation_date": 1488322500, "post_id": 42519764, "comment_id": 72177503, "body": "Don&#39;t forget to add indices to any columns you&#39;ll be searching on. This probably means adding indices to account_id and both enums. Though this depends on the exact operations your app does."}, {"owner": {"reputation": 3288, "user_id": 5781737, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/86ad144d764093a50390bb9c6fe95b86?s=128&d=identicon&r=PG&f=1", "display_name": "Mark", "link": "https://stackoverflow.com/users/5781737/mark"}, "reply_to_user": {"reputation": 1843, "user_id": 4067720, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a52c645614505bcaeb65a6c5199158c1?s=128&d=identicon&r=PG", "display_name": "Glyoko", "link": "https://stackoverflow.com/users/4067720/glyoko"}, "edited": false, "score": 0, "creation_date": 1488322625, "post_id": 42519764, "comment_id": 72177563, "body": "good point @Glyoko I&#39;ve updated my answer to add an index on the column I recommended adding."}], "tags": [], "owner": {"reputation": 3288, "user_id": 5781737, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/86ad144d764093a50390bb9c6fe95b86?s=128&d=identicon&r=PG&f=1", "display_name": "Mark", "link": "https://stackoverflow.com/users/5781737/mark"}, "is_accepted": true, "score": 1, "last_activity_date": 1488322593, "last_edit_date": 1488322593, "creation_date": 1488320247, "answer_id": 42519764, "question_id": 42519415, "link": "https://stackoverflow.com/questions/42519415/allow-user-to-set-schedule-for-worker-to-complete-assignnment/42519764#42519764", "title": "Allow user to set schedule for worker to complete assignnment", "body": "<p>I think your approach is actually pretty good. That's what I would do. I would probably make the <code>frequency</code> an enumerated type to include only certain values like: 'hourly, daily, weekly, monthly, yearly,' etc. This is easily accomplished by adding the following line to your model class in assignment.rb:</p>\n\n<pre><code>enum frequency: [ :hourly, :daily, :weekly, :monthly, :yearly ]\n</code></pre>\n\n<p>The way you've defined <code>start_at</code> and <code>end_at</code> is fine. Whenever the user accesses their assignment, you simply need to perform a query on the assignment to determine if it is in progress, past due, or not yet open. </p>\n\n<p>Also, it looks like you're storing two boolean values called 'finished' and 'in_progress'. I would probably simplify those fields by creating another enumerated type called 'status' defined as follows:</p>\n\n<pre><code>enum status: [ :not_started, :in_progress, :finished ]\n</code></pre>\n\n<p>You'd need to remove the 'finished' and 'in_progress' columns from the table as well as add a field called 'title'. Create a migration file and paste the following code to modify the table:</p>\n\n<pre><code>def change\n  remove_column :assignments, :finished\n  remove_column :assignments, :in_progress\n  add_column :assignments, :status, :integer, default: 0\n\n  add_index :assignments, :status\nend\n</code></pre>\n\n<p>That's what I would do, but that's just my opinion :) You'll need to code up how to determine whether an assignment is in progress or not by comparing the start and end times. </p>\n"}], "owner": {"reputation": 6503, "user_id": 5650878, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/xh7BI.png?s=128&g=1", "display_name": "Bitwise", "link": "https://stackoverflow.com/users/5650878/bitwise"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 32, "favorite_count": 0, "accepted_answer_id": 42519764, "answer_count": 1, "score": 0, "last_activity_date": 1488322593, "creation_date": 1488318636, "question_id": 42519415, "link": "https://stackoverflow.com/questions/42519415/allow-user-to-set-schedule-for-worker-to-complete-assignnment", "title": "Allow user to set schedule for worker to complete assignnment", "body": "<p>I have an app that allows admins to create assignments and assign to workers on an account. This aspect works great but I'm trying to add a way for admins to set a schedule for when these assignments should be done. Things like how often(weekly, monthly, etc...) and how long the assignment should take (hours or mins). I started a little bit of this build out. Basically I set the attributes on assignment to include <code>start_at</code> <code>end_at</code> and <code>frequency</code>. I'm not sure what to do with these attributes though. Has anybody built a system like this before? What are good gems or libraries I could use to help with this? Here is my schema for assignments:</p>\n\n<h2>Schema:</h2>\n\n<pre><code>  create_table \"assignments\", force: :cascade do |t|\n    t.string   \"name\"\n    t.string   \"description\"\n    t.integer  \"account_id\"\n    t.datetime \"created_at\"\n    t.datetime \"updated_at\"\n    t.string   \"attachment\"\n    t.boolean  \"finished\",       default: false\n    t.integer  \"finished_count\"\n    t.boolean  \"in_progress\",    default: false\n    t.datetime \"start_at\"\n    t.datetime \"end_at\"\n    t.string   \"frequency\"\n  end\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "azure", "caching", "carrierwave"], "answers": [{"tags": [], "owner": {"reputation": 118, "user_id": 3835528, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9575aba55a9a2b99116b50737f8f1dd7?s=128&d=identicon&r=PG&f=1", "display_name": "JohnsWort", "link": "https://stackoverflow.com/users/3835528/johnswort"}, "is_accepted": true, "score": 1, "last_activity_date": 1488326113, "creation_date": 1488326113, "answer_id": 42520879, "question_id": 42519028, "link": "https://stackoverflow.com/questions/42519028/stop-carrierwave-from-caching-storage-information/42520879#42520879", "title": "Stop Carrierwave from Caching Storage Information", "body": "<p>Figured it out. Instead of assigning config attributes to CarrierWave assign them to the initialized uploader object.</p>\n\n<pre><code>def initialize(*)\n  super\n  self.azure_storage_account_name = account_name\n  self.azure_storage_access_key = storage_key\n  self.azure_container = model.container_name\nend\n</code></pre>\n"}], "owner": {"reputation": 118, "user_id": 3835528, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9575aba55a9a2b99116b50737f8f1dd7?s=128&d=identicon&r=PG&f=1", "display_name": "JohnsWort", "link": "https://stackoverflow.com/users/3835528/johnswort"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 235, "favorite_count": 0, "accepted_answer_id": 42520879, "answer_count": 1, "score": 0, "last_activity_date": 1488326113, "creation_date": 1488317157, "question_id": 42519028, "link": "https://stackoverflow.com/questions/42519028/stop-carrierwave-from-caching-storage-information", "title": "Stop Carrierwave from Caching Storage Information", "body": "<p>Carrierwave is caching Azure storage information and uploading files to the wrong containers.</p>\n\n<p>For example, if I upload an image to container \"a\" then I try to upload an image to container \"b\", it will still upload to container \"a\". I assume Carrierwave is caching the storage information somewhere instead of setting the container information each upload. How do I stop it from doing this?</p>\n\n<pre><code>class FileUploader &lt; CarrierWave::Uploader::Base\n\nstorage :azure\n\ndef initialize(*)\nsuper\n  CarrierWave.configure do |config|\n    config.azure_storage_account_name = account_name\n    config.azure_storage_access_key = storage_key\n    config.azure_container = model.container_name\n  end\nend\n</code></pre>\n\n<p>I also tried re-initializing the uploader for each upload but I still have the same problem.</p>\n\n<pre><code>uploader = FileUploader.new\nuploader.store!(file)\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 14010, "user_id": 3109182, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/a4b305f0077055b4fdcf715067775d5a?s=128&d=identicon&r=PG", "display_name": "Anthony", "link": "https://stackoverflow.com/users/3109182/anthony"}, "edited": false, "score": 0, "creation_date": 1488317105, "post_id": 42518761, "comment_id": 72174906, "body": "and the folder <code>au5</code> is empty?"}, {"owner": {"reputation": 4953, "user_id": 1867854, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/ea603ef86247c91331785befada5430b?s=128&d=identicon&r=PG&f=1", "display_name": "mitchkman", "link": "https://stackoverflow.com/users/1867854/mitchkman"}, "reply_to_user": {"reputation": 14010, "user_id": 3109182, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/a4b305f0077055b4fdcf715067775d5a?s=128&d=identicon&r=PG", "display_name": "Anthony", "link": "https://stackoverflow.com/users/3109182/anthony"}, "edited": false, "score": 0, "creation_date": 1488317147, "post_id": 42518761, "comment_id": 72174927, "body": "---Yes. I tried to add an empty Gemfile, didn&#39;t help either.--- See my next answer."}, {"owner": {"reputation": 14010, "user_id": 3109182, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/a4b305f0077055b4fdcf715067775d5a?s=128&d=identicon&r=PG", "display_name": "Anthony", "link": "https://stackoverflow.com/users/3109182/anthony"}, "edited": false, "score": 0, "creation_date": 1488317243, "post_id": 42518761, "comment_id": 72174975, "body": "It doesn&#39;t seem empty because rails is invoking <code>bin&#47;rails</code> (last line in your stacktrace)."}, {"owner": {"reputation": 4953, "user_id": 1867854, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/ea603ef86247c91331785befada5430b?s=128&d=identicon&r=PG&f=1", "display_name": "mitchkman", "link": "https://stackoverflow.com/users/1867854/mitchkman"}, "reply_to_user": {"reputation": 14010, "user_id": 3109182, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/a4b305f0077055b4fdcf715067775d5a?s=128&d=identicon&r=PG", "display_name": "Anthony", "link": "https://stackoverflow.com/users/3109182/anthony"}, "edited": false, "score": 0, "creation_date": 1488317343, "post_id": 42518761, "comment_id": 72175026, "body": "Yes, sorry, I was wrong. I have three files: .ruby-gemset, .ruby-version, Gemfile. There is no <code>bin</code> folder though."}, {"owner": {"reputation": 40466, "user_id": 33226, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/8f75007bcbcb8ba4daa408592e1c65ec?s=128&d=identicon&r=PG", "display_name": "Gavin Miller", "link": "https://stackoverflow.com/users/33226/gavin-miller"}, "edited": false, "score": 0, "creation_date": 1488329876, "post_id": 42518761, "comment_id": 72179679, "body": "Can you post the output of <code>gem env</code> and <code>bundle env</code> as well as <code>echo $BUNDLE_GEMFILE</code>?"}], "answers": [{"comments": [{"owner": {"reputation": 4953, "user_id": 1867854, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/ea603ef86247c91331785befada5430b?s=128&d=identicon&r=PG&f=1", "display_name": "mitchkman", "link": "https://stackoverflow.com/users/1867854/mitchkman"}, "edited": false, "score": 0, "creation_date": 1488317047, "post_id": 42518891, "comment_id": 72174872, "body": "Thank you for your answer. The issue still persists. See my edit."}], "tags": [], "owner": {"reputation": 1670, "user_id": 6388521, "user_type": "registered", "accept_rate": 69, "profile_image": "https://lh4.googleusercontent.com/-VdFWPJVSpRc/AAAAAAAAAAI/AAAAAAAAAFo/vCc8QOz6v9Y/photo.jpg?sz=128", "display_name": "Ruslan", "link": "https://stackoverflow.com/users/6388521/ruslan"}, "is_accepted": false, "score": 0, "last_activity_date": 1488316619, "creation_date": 1488316619, "answer_id": 42518891, "question_id": 42518761, "link": "https://stackoverflow.com/questions/42518761/rails-cannot-find-gemfile-when-trying-to-create-new-app/42518891#42518891", "title": "Rails cannot find Gemfile when trying to create new app", "body": "<p>have you tried creating an empty <code>Gemfile</code>?</p>\n\n<pre><code>touch Gemfile\necho \"source 'https://rubygems.org'\" &gt; Gemfile\n</code></pre>\n\n<p>Also make sure to install <code>bundler</code></p>\n\n<pre><code>gem install bundler\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 40466, "user_id": 33226, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/8f75007bcbcb8ba4daa408592e1c65ec?s=128&d=identicon&r=PG", "display_name": "Gavin Miller", "link": "https://stackoverflow.com/users/33226/gavin-miller"}, "edited": false, "score": 0, "creation_date": 1488330005, "post_id": 42521383, "comment_id": 72179710, "body": "There&#39;s no rehash for <code>rvm</code>"}], "tags": [], "owner": {"reputation": 21, "user_id": 7638384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/135b014e34120f36207fa7143b2ef3ce?s=128&d=identicon&r=PG&f=1", "display_name": "Will Keller", "link": "https://stackoverflow.com/users/7638384/will-keller"}, "is_accepted": false, "score": -1, "last_activity_date": 1488333692, "last_edit_date": 1488333692, "creation_date": 1488329761, "answer_id": 42521383, "question_id": 42518761, "link": "https://stackoverflow.com/questions/42518761/rails-cannot-find-gemfile-when-trying-to-create-new-app/42521383#42521383", "title": "Rails cannot find Gemfile when trying to create new app", "body": "<p>With rbenv, there is a rehash function that fixes (among other things) the paths associated with installed gems. When you install a gem that has executable scripts, rbenv can sometimes get confused and needs to have the environment refreshed.</p>\n\n<p>I don't know if rvm has a similar mechanism; I don't have it installed and a cursory google doesn't show anything. But you might want to start looking there. </p>\n\n<p>(and consider switching to rbenv, it seems to be far less quirky)</p>\n"}], "owner": {"reputation": 4953, "user_id": 1867854, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/ea603ef86247c91331785befada5430b?s=128&d=identicon&r=PG&f=1", "display_name": "mitchkman", "link": "https://stackoverflow.com/users/1867854/mitchkman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 401, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1488333692, "creation_date": 1488316141, "last_edit_date": 1488317386, "question_id": 42518761, "link": "https://stackoverflow.com/questions/42518761/rails-cannot-find-gemfile-when-trying-to-create-new-app", "title": "Rails cannot find Gemfile when trying to create new app", "body": "<p>I'm new to Rails and I try to create a new app (on MacOS). I've installed Ruby, Rails and bundler through rvm. </p>\n\n<pre><code>$ ruby -v\nruby 2.4.0p0 (2016-12-24 revision 57164) [x86_64-darwin16]\n$ gem -v\n2.6.10\n$ bundler -v\nBundler version 1.14.5\n</code></pre>\n\n<p>I try to create the app like this:</p>\n\n<pre><code>$ mkdir au5\n$ cd au5\n$ rvm use ruby-2.4.0@au5 --ruby-version --create\n$ gem install rails\n$ rails new au5\n/Users/user/.rvm/gems/ruby-2.4.0@au5/gems/bundler-1.14.5/lib/bundler/shared_helpers.rb:24:in `default_gemfile': Could not locate Gemfile (Bundler::GemfileNotFound)\n    from /Users/user/.rvm/gems/ruby-2.4.0@au5/gems/bundler-1.14.5/lib/bundler/shared_helpers.rb:29:in `default_lockfile'\n    from /Users/user/.rvm/gems/ruby-2.4.0@au5/gems/bundler-1.14.5/lib/bundler.rb:307:in `default_lockfile'\n    from /Users/user/bin/spring:10:in `&lt;top (required)&gt;'\n    from bin/rails:3:in `load'\n    from bin/rails:3:in `&lt;main&gt;'\n</code></pre>\n\n<p><strong>Edit 1:</strong>\nrails -v gives me:</p>\n\n<pre><code>$ gem install rails\nSuccessfully installed rails-5.0.1\nParsing documentation for rails-5.0.1\nDone installing documentation for rails after 0 seconds\n1 gem installed\n$ rails -v\n/Users/user/.rvm/gems/ruby-2.4.0@au5/gems/bundler-1.14.5/lib/bundler/shared_helpers.rb:24:in `default_gemfile': Could not locate Gemfile (Bundler::GemfileNotFound)\n    from /Users/user/.rvm/gems/ruby-2.4.0@au5/gems/bundler-1.14.5/lib/bundler/shared_helpers.rb:29:in `default_lockfile'\n    from /Users/user/.rvm/gems/ruby-2.4.0@au5/gems/bundler-1.14.5/lib/bundler.rb:307:in `default_lockfile'\n    from /Users/user/bin/spring:10:in `&lt;top (required)&gt;'\n    from bin/rails:3:in `load'\n    from bin/rails:3:in `&lt;main&gt;'\n</code></pre>\n\n<p><strong>Edit 2:</strong> Tried to create empty Gemfile:</p>\n\n<pre><code>$ touch Gemfile\n$ echo \"source 'https://rubygems.org'\" &gt; Gemfile\n$ gem install bundler\nSuccessfully installed bundler-1.14.5\nParsing documentation for bundler-1.14.5\nDone installing documentation for bundler after 3 seconds\n1 gem installed\n$ rails new au5\n/Users/user/.rvm/gems/ruby-2.4.0@au5/gems/bundler-1.14.5/lib/bundler/shared_helpers.rb:24:in `default_gemfile': Could not locate Gemfile (Bundler::GemfileNotFound)\n    from /Users/user/.rvm/gems/ruby-2.4.0@au5/gems/bundler-1.14.5/lib/bundler/shared_helpers.rb:29:in `default_lockfile'\n    from /Users/user/.rvm/gems/ruby-2.4.0@au5/gems/bundler-1.14.5/lib/bundler.rb:307:in `default_lockfile'\n    from /Users/user/bin/spring:10:in `&lt;top (required)&gt;'\n    from bin/rails:3:in `load'\n    from bin/rails:3:in `&lt;main&gt;'\n</code></pre>\n\n<p><strong>Edit 3:</strong> These are the files in my project folder:</p>\n\n<pre><code>$ ls -la\ntotal 24\ndrwxr-xr-x  5 user  1694527156  170 Feb 28 22:28 .\ndrwxr-xr-x  8 user  1694527156  272 Feb 28 22:26 ..\n-rw-r--r--  1 user  1694527156    4 Feb 28 22:26 .ruby-gemset\n-rw-r--r--  1 user  1694527156   11 Feb 28 22:26 .ruby-version\n-rw-r--r--  1 user  1694527156   30 Feb 28 22:28 Gemfile\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "scope", "pundit"], "comments": [{"owner": {"reputation": 9015, "user_id": 155826, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/55RCe.jpg?s=128&g=1", "display_name": "Ryan Crispin Heneise", "link": "https://stackoverflow.com/users/155826/ryan-crispin-heneise"}, "edited": false, "score": 0, "creation_date": 1488316155, "post_id": 42518442, "comment_id": 72174410, "body": "What is <code>@proposal</code> in the <code>matching_organization</code> method? Is that supposed to be <code>self</code>? There are no arguments on that method - where are <code>@proposal</code> and <code>@reviewer</code> coming from?"}], "answers": [{"tags": [], "owner": {"reputation": 9015, "user_id": 155826, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/55RCe.jpg?s=128&g=1", "display_name": "Ryan Crispin Heneise", "link": "https://stackoverflow.com/users/155826/ryan-crispin-heneise"}, "is_accepted": false, "score": 0, "last_activity_date": 1488316912, "creation_date": 1488316912, "answer_id": 42518963, "question_id": 42518442, "link": "https://stackoverflow.com/questions/42518442/rails-5-pundit-index-resolve-scope-method/42518963#42518963", "title": "Rails 5 - Pundit - index resolve scope method", "body": "<p>It's really difficult to tell from this code sample where it might be breaking down. My recommendation would be to set up a test scenario for each one of these scopes and for the <code>matching_organization</code> method. </p>\n\n<p>If you haven't already, create a test for each scope. </p>\n\n<pre><code>describe Proposal do\n  it 'matching_organisation should return the expected organization'\n    assert_equal @expected_org, @proposal.matching_organisation\n  end\n  describe 'scopes' do\n    test 'reviewable' do\n      assert_equal @expected, Proposal.reviewable\n    end\n    test 'for_reviewer' do\n      assert_equal @expected, Proposal.for_reviewer(@user)\n    end\n    # etc...\n  end\nend\n</code></pre>\n\n<p>Once you're sure your class scopes and methods are correct, you can create a policy test: </p>\n\n<pre><code># test/policies/proposal_policy_test.rb\ndescribe ProposalPolicy do\n  describe 'scope' do\n    it 'must include expected policy' do\n      policy_scope(Proposal).must_include(@expected_policy)\n    end\n    it 'wont include unexpected policy' do\n      policy_scope(Proposal).wont_include(@unexpected_policy)\n    end\n  end\nend\n</code></pre>\n\n<p>(examples shown using <a href=\"https://github.com/metaskills/minitest-spec-rails\" rel=\"nofollow noreferrer\">MiniTest::Spec</a> syntax)</p>\n"}], "owner": {"reputation": 3634, "user_id": 2860931, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/968ddbc21b4695b3fba4665b69d231b5?s=128&d=identicon&r=PG&f=1", "display_name": "Mel", "link": "https://stackoverflow.com/users/2860931/mel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 255, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1488316912, "creation_date": 1488314854, "last_edit_date": 1488316018, "question_id": 42518442, "link": "https://stackoverflow.com/questions/42518442/rails-5-pundit-index-resolve-scope-method", "title": "Rails 5 - Pundit - index resolve scope method", "body": "<p>I have been trying for 3 years to learn how to use pundit with my Rails app.</p>\n\n<p>I have a proposal model, that I'm trying to use to show an index of proposals based on a set of rules that I'm trying to define in a resolve method.</p>\n\n<p>My latest attempt is below.</p>\n\n<pre><code>class ProposalPolicy &lt; ApplicationPolicy\n\n\n  class Scope &lt; Scope\n\n    def resolve\n                      # find all proposals where the user created the proposal;\n      proposal_ids =  user.proposal_ids +\n                      # all where the user has the reviewing role at the creator's organistion - if the proposal is in scope 'reviewable'; and\n                      Proposal.reviewable.for_reviewer(user).pluck(:id) +\n                      # all where the proposal is openly published;\n                      Proposal.openly_published.pluck(:id) +\n                      # all where the user is invited;\n                      Proposal.published_to_invitees.invited(user).pluck(:id) +\n                      # all where the user is a counterparty and the proposal is published to counterparties\n                      Proposal.published_to_counterparties.counterparty(user).pluck(:id)\n      Proposal.where(id: proposal_ids)\n    end\n  end\n</code></pre>\n\n<p>In my proposal.rb, I have defined the scopes that I use in the above method:</p>\n\n<pre><code>class Proposal &lt; ApplicationRecord\n  scope :reviewable,  -&gt; { in_state(:under_review) }\n  scope :openly_published, -&gt; { in_state(:publish_openly) }\n  scope :for_reviewer, -&gt; (user){where(user.has_role?(:consents, @matching_organisation)) }\n  scope :published_to_invitees, -&gt; { in_state(:publish_to_invitees) }\n  scope :invited,     -&gt; (user){ where(invitee_id: user.id) }\n  scope :published_to_counterparties, -&gt; { in_state(:published_to_counterparties_only) }\n  scope :counterparty, -&gt; (user){ where( user_id: @eligible_user)}\n  scope :proponent,   -&gt;(user){ where(user_id: user.id) }\n\n  def matching_organisation\n    @proposal.user.organisation_id == @reviewer.organisation.id\n  end\nend\n</code></pre>\n\n<p>I don't get any errors when I try this, but it actually doesnt work. If I create a new proposal then I should be able to see that proposal in my index because I satisfy the first rule in my resolve method, but I get an empty index of results.</p>\n\n<p>Can anyone see where I'm going wrong with my attempts to write a resolve method that can take a number of criteria?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "rails-models"], "answers": [{"tags": [], "owner": {"reputation": 4243, "user_id": 4638378, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pGqPN.png?s=128&g=1", "display_name": "Brian", "link": "https://stackoverflow.com/users/4638378/brian"}, "is_accepted": false, "score": 0, "last_activity_date": 1488313605, "creation_date": 1488313605, "answer_id": 42518100, "question_id": 42517968, "link": "https://stackoverflow.com/questions/42517968/highest-rating-comment-in-rails/42518100#42518100", "title": "Highest rating comment in rails", "body": "<p>If your output looks something like <code>\"#&lt;Comment:0x007fb9ea9561d0&gt;\"</code>, then what you're seeing is the result of calling <code>to_s</code> on <code>@product.highest_rating_comment</code>. Basically you're seeing the text representation of the object's location in memory.</p>\n\n<p>What you probably want instead is the contents of the comment. Since you didn't provide your schema, I can't say what that field is called - perhaps <code>@product.highest_rating_comment.comment</code>? </p>\n"}, {"tags": [], "owner": {"reputation": 4538, "user_id": 809830, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bdd9801d2717096282258b192edc7793?s=128&d=identicon&r=PG", "display_name": "Alex Kojin", "link": "https://stackoverflow.com/users/809830/alex-kojin"}, "is_accepted": true, "score": 0, "last_activity_date": 1488314790, "creation_date": 1488314790, "answer_id": 42518427, "question_id": 42517968, "link": "https://stackoverflow.com/questions/42517968/highest-rating-comment-in-rails/42518427#42518427", "title": "Highest rating comment in rails", "body": "<p>It shows a result of <code>inspect</code> method. You need to output a value of a rating field. Add changes to the product show page:</p>\n\n<pre><code>#product show page\n&lt;%= @product.highest_rating_comment.try(:rating) %&gt;\n</code></pre>\n"}], "owner": {"reputation": 129, "user_id": 6495928, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/ibZTS.jpg?s=128&g=1", "display_name": "BoB", "link": "https://stackoverflow.com/users/6495928/bob"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 228, "favorite_count": 0, "accepted_answer_id": 42518427, "answer_count": 2, "score": 1, "last_activity_date": 1488314790, "creation_date": 1488313063, "question_id": 42517968, "link": "https://stackoverflow.com/questions/42517968/highest-rating-comment-in-rails", "title": "Highest rating comment in rails", "body": "<p>I'm trying to show the comment with the highest rating in the product show page but it shows # instead of the comment. Any ideas why?</p>\n\n<pre><code>#comment model\nclass Comment &lt; ApplicationRecord\n belongs_to :user\n belongs_to :product\n\n scope :rating_desc, -&gt; { order(rating: :desc) }\n scope :rating_asc, -&gt; { order(rating: :asc) }\nend\n\n#product model\nclass Product &lt; ApplicationRecord\n  has_many :orders\n  has_many :comments\n\n  def highest_rating_comment\n    comments.rating_desc.first\n  end\nend\n\n#product show page\n&lt;%= @product.highest_rating_comment %&gt;\n</code></pre>\n"}, {"tags": ["java", "ruby", "oop"], "comments": [{"owner": {"reputation": 14010, "user_id": 3109182, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/a4b305f0077055b4fdcf715067775d5a?s=128&d=identicon&r=PG", "display_name": "Anthony", "link": "https://stackoverflow.com/users/3109182/anthony"}, "edited": false, "score": 0, "creation_date": 1488313036, "post_id": 42517820, "comment_id": 72172782, "body": "<code>belongs_to</code> is a class method in ruby or in java a static method.  the method signature would look like <code>def self.belongs_to(arg1, arg2)</code>."}, {"owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 1, "creation_date": 1488313446, "post_id": 42517820, "comment_id": 72172999, "body": "worth mentioning that <code>belongs_to</code> is not in Ruby itself, it&#39;s in Rails (ActiveRecord, specifically), and it&#39;s probably worth checking <a href=\"http://guides.rubyonrails.org/association_basics.html#belongs-to-association-reference\" rel=\"nofollow noreferrer\">the guide</a> on that"}], "answers": [{"tags": [], "owner": {"reputation": 1670, "user_id": 6388521, "user_type": "registered", "accept_rate": 69, "profile_image": "https://lh4.googleusercontent.com/-VdFWPJVSpRc/AAAAAAAAAAI/AAAAAAAAAFo/vCc8QOz6v9Y/photo.jpg?sz=128", "display_name": "Ruslan", "link": "https://stackoverflow.com/users/6388521/ruslan"}, "is_accepted": false, "score": 1, "last_activity_date": 1488317172, "creation_date": 1488317172, "answer_id": 42519032, "question_id": 42517820, "link": "https://stackoverflow.com/questions/42517820/ruby-class-definition-explanation-for-a-java-developer/42519032#42519032", "title": "Ruby Class definition explanation for a java developer", "body": "<p><code>belongs_to</code> may seem like a very magical piece of ruby code, that connects your model to another, using SQL table associations. </p>\n\n<p>But all it does is takes in a few hash parameters, creating series of dynamic methods. </p>\n\n<p>Lets take  apart</p>\n\n<pre><code>belongs_to :sd_file, class_name: 'Test::TransportFile', foreign_key: 'reference_id'\n</code></pre>\n\n<p><code>belongs_to</code> - A methods to set up an association</p>\n\n<p><code>sd_file</code> - What method will be used to acess it:</p>\n\n<ul>\n<li><code>Test::Signature.first.sd_file</code></li>\n</ul>\n\n<p><code>class_name</code> - option to specify which ruby class to load. <code>sd_file</code> will point to <code>Test::TransportFile</code>. Usually this is done automatically by <code>rails</code> if everything adheres to conventions. But you can specify manually</p>\n\n<p><code>foreign_key</code> - Key in the table which ties the two records together. This is either in <code>Test::TransportFile</code> or in <code>Test::Signature</code> (I can't remember off the top of my head). And it will tie in with the <code>id</code> in another table.</p>\n"}, {"tags": [], "owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "is_accepted": true, "score": 3, "last_activity_date": 1488322718, "creation_date": 1488322718, "answer_id": 42520326, "question_id": 42517820, "link": "https://stackoverflow.com/questions/42517820/ruby-class-definition-explanation-for-a-java-developer/42520326#42520326", "title": "Ruby Class definition explanation for a java developer", "body": "<p>The key thing here is to realize that (almost) everything in Ruby is a script, (almost) everything in Ruby is a message send (\"virtual method call\" in Java-speak), and (almost) everything in Ruby is an object.</p>\n\n<p>In Java, the only executable code is inside method definitions. Everything else are just <em>declarations</em>, directives to the compiler to create some compiler-internal data structure. A class declaration isn't executed at runtime, it is interpreted at compile time by the compiler, which then generates the corresponding class structure, methods, fields, etc.</p>\n\n<p>Not so in Ruby. The content of a file is just a script that gets executed top to bottom. That's why you can, for example, have stuff like this:</p>\n\n<pre><code>if OS.windows?\n  class Foo\n  end\nelse\n  class Bar\n  end\nend\n</code></pre>\n\n<p>Likewise, the body of a module or class definition is just a script, which allows you to have stuff like this:</p>\n\n<pre><code>if OS.windows?\n  def foo\n  end\nelse\n  def bar\n  end\nend\n</code></pre>\n\n<p>So, as you can see, really almost everything is a script, in particular, the body of a class definition is just a script that gets executed from top to bottom, just like any other script.</p>\n\n<p>By the way, since the class definition is dynamically executed at runtime and not statically interpreted by the compiler, the same goes for the superclass definition in a class definition: it is, in fact, just an arbitrary Ruby expression that returns an object that is an instance of <a href=\"http://ruby-doc.org/core/Class.html\" rel=\"nofollow noreferrer\"><code>Class</code></a>, it doesn't necessarily have to be a static constant class, i.e. you can write something like this:</p>\n\n<pre><code>class Foo &lt; if rand &lt; 0.5 then String else Array end\nend\n# Yes, I am aware that this makes zero sense. Here is a more sensible example:\n\nclass Point &lt; Struct.new(:x, :y)\nend\n# `Struct` is a class whose `::new` method returns a class\n\nclass Search &lt; R '/search'\nend\n# This is an example from the Camping web microframework:\n# `Search` is a controller which is bound to the URI route `/search`\n</code></pre>\n\n<p>In case you are wondering: if a class definition is just a piece of code, does it return anything? And the answer is \"Yes, it does!\" In fact, <em>everything</em> in Ruby returns something, <em>everything</em> is an expression in Ruby. There are no statements. Only expressions. A class definition evaluates to the value of the last expression that is evaluated inside the class definition. Typically, the last expression that is evaluated inside a class definition is a method definition (yes, a method definition is an expression just like any other, and thus also has a return value), and a method definition evaluates to the name of the method being defined, expressed as a <a href=\"http://ruby-doc.org/core/Symbol.html\" rel=\"nofollow noreferrer\"><code>Symbol</code></a></p>\n\n<p>Also, almost everything is an object: there is a top-level global object which doesn't have a name but is usually called <code>main</code> (because that's what its <code>to_s</code> and <code>inspect</code> return). Everything you run at the top-level in a script happens with <code>self</code> (<code>this</code> in Java-speak) being bound to <code>main</code>. And classes are also objects, they are instances of the <code>Class</code> class. Within a class definition body, <code>self</code> is bound to the class that is being defined.</p>\n\n<p>Now, on to \"almost everything is a message send\": usually, whenever you see something being \"done\" in Ruby, it is the result of a message send: <code>1 + 2</code> is actually <code>1.+(2)</code>, <code>!false</code> is actually <code>false.!</code>, <code>foo.bar = baz</code> is actually <code>foo.bar=(baz)</code>, <code>ary[idx]</code> is actually <code>ary.[](idx)</code>, <code>ary[idx] = val</code> is actually <code>ary.[]=(idx, val)</code> and so on and so forth.</p>\n\n<p><a href=\"http://api.rubyonrails.org/classes/ActiveRecord/Associations/ClassMethods.html#method-i-belongs_to\" rel=\"nofollow noreferrer\"><code>belongs_to</code></a> is no different: it is actually a message send to <code>self</code>, which in the context of a class definition is the class being defined. In other words, it's just calling a \"class method\". (Note: there aren't really class methods in Ruby, every method is an instance method. As we have already established, classes are objects like any other object, so they can have instance methods like any other object, there is no need for a special \"class method\" or \"static method\" construct!)</p>\n\n<p>Let's start with an easier example:</p>\n\n<pre><code>class Foo\n  attr_reader :bar\nend\n</code></pre>\n\n<p>Again, <a href=\"http://ruby-doc.org/core/Module.html#method-i-attr_reader\" rel=\"nofollow noreferrer\"><code>attr_reader</code></a> is a message send to <code>self</code>, which is <code>Foo</code> in this case. <code>attr_reader</code> just generates an attribute reader (a \"getter\" in Java-speak). And it looks a bit like this (don't worry if you don't fully grasp Ruby Reflection yet, you should be able to follow along anyhow):</p>\n\n<pre><code>class Class # in reality, it is defined in `Module`, a superclass of `Class`\n  def attr_reader(name)\n    define_method(name) do\n      instance_variable_get(:\"@#{name}\")\n    end\n  end\nend\n</code></pre>\n\n<p>By the way: <code>def</code> is not a message send, it is a builtin keyword. But there is a corresponding method that can be used instead, which you see being used above: <a href=\"http://ruby-doc.org/core/Module.html#method-i-define_method\" rel=\"nofollow noreferrer\"><code>Module#define_method</code></a></p>\n\n<p>In fact, Ruby doesn't even have constructors! <a href=\"http://ruby-doc.org/core/Class.html#method-i-new\" rel=\"nofollow noreferrer\"><code>new</code></a> is just a \"class method\", and it looks pretty much like this:</p>\n\n<pre><code>class Class\n  def new(*args, &amp;block)\n    new_obj = allocate\n    new_obj.initialize(*args, &amp;block)\n    return new_obj\n  end\nend\n</code></pre>\n\n<p>There are a few subtleties here, such as <a href=\"http://ruby-doc.org/core/Module.html#method-i-private\" rel=\"nofollow noreferrer\"><code>initialize</code></a> being <code>private</code> by default, so that in reality we need to use reflection to circumvent access restrictions, but that's the gist of it.</p>\n\n<p>Oh, and since I just mentioned <a href=\"http://ruby-doc.org/core/Module.html#method-i-private\" rel=\"nofollow noreferrer\"><code>private</code></a>: that's a method, too, not a keyword that is interpreted as an instruction for the compiler.</p>\n\n<p>So, to recap, where do we stand: a class definition is just a piece of code, method definitions are just expressions that get executed. But since a class definition is just a piece of code, there can be arbitrary code in there, including message sends (\"method calls\" in Java-speak). <code>belongs_to</code> is just a message send (method call) to the class itself, i.e. the method is defined somewhere up in the inheritance chain of the class object itself (not to be confused with the inheritance chain of <em>instances</em> of the class!)</p>\n\n<p>But the really important takeaway is this: it is just a method call. Nothing scary. Nothing magical. Nothing special.</p>\n\n<p>Now, what does this method call <em>do</em>?</p>\n\n<p>It is part of a popular ORM library for Ruby called <a href=\"http://guides.rubyonrails.org/active_record_basics.html\" rel=\"nofollow noreferrer\"><em>ActiveRecord</em></a>, and it sets up an association between <code>self</code> (i.e. the class whose definition the call appears in) and another class whose name is provided as an argument (or to be more precise: since ActiveRecord relies a lot on conventions, the name of the class can be <em>derived</em> from the argument). From this association between Ruby classes, the ActiveRecord ORM will automatically deduce corresponding relations between the database tables backing those classes.</p>\n\n<p>Explaining how exactly that works would amount to writing a full tutorial on ActiveRecord, which a) is just too much for a Stack Overflow answer, and b) other people have already done much better than me. But I got the impression anyway that you didn't so much want to know how <code>belongs_to</code> works internally, but rather how a method call can appear in what your Java-trained mind is used to being just \"dead code\" that doesn't get executed. And the solution to that riddle is simply: it isn't dead code and it does get executed.</p>\n"}], "owner": {"reputation": 3468, "user_id": 1258669, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/1988d60d9df1a4aaecc77ffc49532a5a?s=128&d=identicon&r=PG", "display_name": "RanPaul", "link": "https://stackoverflow.com/users/1258669/ranpaul"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 59, "favorite_count": 0, "closed_date": 1575937329, "accepted_answer_id": 42520326, "answer_count": 2, "score": 0, "last_activity_date": 1488322718, "creation_date": 1488312560, "last_edit_date": 1488314584, "question_id": 42517820, "link": "https://stackoverflow.com/questions/42517820/ruby-class-definition-explanation-for-a-java-developer", "closed_reason": "Needs more focus", "title": "Ruby Class definition explanation for a java developer", "body": "<p>I am a java developer and am having hard time understanding this Ruby code, can someone please explain this code in java terms? I can understand the methods part (defs) but the belongs_to part is what confusing me</p>\n\n<pre><code>module Test\n\n  class Signature &lt; Base\n    belongs_to :recipient, :class_name =&gt; 'Test::UserInformation'\n    belongs_to :sd_file, :class_name =&gt; 'Test::TransportFile',\n                                         :foreign_key =&gt; 'reference_id'\n\n    def sd_status\n      sd_file.nil? ? nil : sd_file.Status\n    end\n\n    def sd_sent_on\n      sd_file.nil? ? nil : sd_file.sent\n    end\n\n    def sd_received_on\n      sd_file.nil? ? nil : sd_file.received\n    end\n\n    def self.find_information(options={})\n      unless (start_date = options.delete(:start_date)).blank? ||\n               (end_date   = options.delete(:end_date)).blank?\n          date_conditions = ' AND '                           +\n                            '(requested_at &gt; ?) AND ' +\n                            '(requested_at &lt; ?)'            \n      end\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-3", "devise"], "comments": [{"owner": {"reputation": 4348, "user_id": 3435610, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/IBOFX.jpg?s=128&g=1", "display_name": "Sara Tibbetts", "link": "https://stackoverflow.com/users/3435610/sara-tibbetts"}, "edited": false, "score": 0, "creation_date": 1488311551, "post_id": 42517446, "comment_id": 72171999, "body": "Please type out the error messages, do not include pictures."}, {"owner": {"reputation": 66, "user_id": 7637453, "user_type": "registered", "profile_image": "https://graph.facebook.com/1805883652770388/picture?type=large", "display_name": "Jo&#227;o Palma", "link": "https://stackoverflow.com/users/7637453/jo%c3%a3o-palma"}, "reply_to_user": {"reputation": 4348, "user_id": 3435610, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/IBOFX.jpg?s=128&g=1", "display_name": "Sara Tibbetts", "link": "https://stackoverflow.com/users/3435610/sara-tibbetts"}, "edited": false, "score": 0, "creation_date": 1488311712, "post_id": 42517446, "comment_id": 72172082, "body": "ok, I&#39;m sorry, working on it right now."}], "answers": [{"tags": [], "owner": {"reputation": 5799, "user_id": 7128479, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/hF0yx.jpg?s=128&g=1", "display_name": "grizzthedj", "link": "https://stackoverflow.com/users/7128479/grizzthedj"}, "is_accepted": false, "score": 0, "last_activity_date": 1488386148, "creation_date": 1488386148, "answer_id": 42537161, "question_id": 42517446, "link": "https://stackoverflow.com/questions/42517446/remove-users-from-database-ruby-on-rails-devise/42537161#42537161", "title": "Remove users from database (Ruby on Rails, Devise)", "body": "<p>The error indicates that there is no method named <code>destroy</code> in the  <code>RegistrationsController</code>. But in your post, you reference this controller as: <code>registration_controller</code> (i.e. with no \"s\")</p>\n\n<p>Perhaps you have defined your RegistrationController as singular, not plural?</p>\n"}], "owner": {"reputation": 66, "user_id": 7637453, "user_type": "registered", "profile_image": "https://graph.facebook.com/1805883652770388/picture?type=large", "display_name": "Jo&#227;o Palma", "link": "https://stackoverflow.com/users/7637453/jo%c3%a3o-palma"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 205, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1488386148, "creation_date": 1488311076, "last_edit_date": 1488311879, "question_id": 42517446, "link": "https://stackoverflow.com/questions/42517446/remove-users-from-database-ruby-on-rails-devise", "title": "Remove users from database (Ruby on Rails, Devise)", "body": "<p>I'm trying to create a button to remove users from the database.</p>\n\n<p>In the <strong>routes</strong> I have:</p>\n\n<pre><code>  devise_for :users, :controllers =&gt; { registrations: 'registrations' }\n  match 'users/:id' =&gt; 'registrations#destroy', :via =&gt; :delete, :as =&gt; :admin_destroy_user\n</code></pre>\n\n<p><strong>registration_controller</strong>:</p>\n\n<pre><code>def destroy\n    @user = User.find(params[:id])\n    if @user.destroy\n      redirect_to root_path\n    end\nend\n</code></pre>\n\n<p><strong>_backoffice.html.erb</strong> file:</p>\n\n<pre><code>&lt;%= button_to 'Delete', admin_destroy_user_path(user.id), :class =&gt; 'btn btn-danger btn-sm', :method =&gt; :delete, data: {:confirm =&gt; 'Tem a certeza que quer apagar este utilizador?'} %&gt;\n</code></pre>\n\n<p><strong>And this is the error I'm getting:</strong></p>\n\n<p>NoMethodError in RegistrationsController#destroy</p>\n\n<p>undefined method `name' for nil:NilClass</p>\n\n<pre><code>  def resource_name\n    devise_mapping.name\n  end\n  alias :scope_name :resource_name\n</code></pre>\n\n<p>Thanks for any help.</p>\n"}, {"tags": ["ruby"], "answers": [{"tags": [], "owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "is_accepted": true, "score": 4, "last_activity_date": 1488310089, "creation_date": 1488310089, "answer_id": 42517189, "question_id": 42517102, "link": "https://stackoverflow.com/questions/42517102/ruby-string-comparisons-match-vs-eql/42517189#42517189", "title": "ruby string comparisons .match vs .eql?", "body": "<p>As always, don't just use methods without reading their documentation. There can be important notes.</p>\n\n<p>Here's <a href=\"https://ruby-doc.org/core-2.4.0/String.html#method-i-eql-3F\" rel=\"nofollow noreferrer\"><code>eql?</code></a>:</p>\n\n<blockquote>\n  <p>Two strings are equal if they have the same length and content.</p>\n</blockquote>\n\n<p>Here's <a href=\"https://ruby-doc.org/core-2.4.0/String.html#method-i-match\" rel=\"nofollow noreferrer\"><code>match</code></a>:</p>\n\n<blockquote>\n  <p>Converts pattern to a Regexp (if it isn\u2019t already one), then invokes its match method on str. If the second parameter is present, it specifies the position in the string to begin the search.</p>\n</blockquote>\n\n<p>Note the part about <em>converting</em>. In a regular expression <code>(</code> and <code>)</code>, among other characters, have significant meaning. You can't use <code>match</code> arbitrarily here. It has a very specific function.</p>\n\n<p>You rarely see <code>.eql?</code> used in actual Ruby code, the convention is simply this:</p>\n\n<pre><code>text_from_page == error_text\n</code></pre>\n\n<p>The <code>eql?</code> method is primarily intended for internal use. It comes into play when doing comparisons, and when finding things in a container like an Array or Hash.</p>\n"}, {"tags": [], "owner": {"reputation": 103, "user_id": 7542899, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/18bced0c0df7a28538fda5195c104157?s=128&d=identicon&r=PG&f=1", "display_name": "Kapidis", "link": "https://stackoverflow.com/users/7542899/kapidis"}, "is_accepted": false, "score": 0, "last_activity_date": 1490136910, "creation_date": 1490136910, "answer_id": 42939711, "question_id": 42517102, "link": "https://stackoverflow.com/questions/42517102/ruby-string-comparisons-match-vs-eql/42939711#42939711", "title": "ruby string comparisons .match vs .eql?", "body": "<p>@tadman. Thank you. That solved my issue. The \".match\" compares the hash values where as the \".eql\" compares the stings.</p>\n"}], "owner": {"reputation": 103, "user_id": 7542899, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/18bced0c0df7a28538fda5195c104157?s=128&d=identicon&r=PG&f=1", "display_name": "Kapidis", "link": "https://stackoverflow.com/users/7542899/kapidis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 290, "favorite_count": 1, "accepted_answer_id": 42517189, "answer_count": 2, "score": 1, "last_activity_date": 1490136910, "creation_date": 1488309796, "question_id": 42517102, "link": "https://stackoverflow.com/questions/42517102/ruby-string-comparisons-match-vs-eql", "title": "ruby string comparisons .match vs .eql?", "body": "<p>When I used .match and .eql? for string comparison they gave different results </p>\n\n<pre><code>text_from_page = \"wrong length (should be 64 characters)\"\nerror_text = \"wrong length (should be 64 characters)\" \nif(text_from_page.eql? error_text)\n puts 'matched' \nelse\n  puts 'Not matched'\nend\n</code></pre>\n\n<p>The following comparison did not work</p>\n\n<pre><code>if(text_from_page.match error_text)\n puts 'matched' \nelse\n  puts 'Not matched'\nend\n</code></pre>\n\n<p>Does anyone know the reason for this?     </p>\n"}, {"tags": ["ruby", "ruby-on-rails-3", "rvm"], "answers": [{"tags": [], "owner": {"reputation": 45322, "user_id": 421705, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/581b1760881c962648f99d6040d41829?s=128&d=identicon&r=PG", "display_name": "Holger Just", "link": "https://stackoverflow.com/users/421705/holger-just"}, "is_accepted": true, "score": 0, "last_activity_date": 1488308942, "creation_date": 1488308942, "answer_id": 42516875, "question_id": 42516636, "link": "https://stackoverflow.com/questions/42516636/rvm-list-known-differs-between-develop-and-production/42516875#42516875", "title": "rvm list known differs between develop and production", "body": "<p>Each RVM version has a hardcoded list of known Ruby versions. If the list differs between installtions, it is generally caused by different RVM versions.</p>\n\n<p>Try to upgrade your RVM version to get the most up-to-date list. With current RVM versions, you can update RVM by running</p>\n\n<pre><code>rvm get latest\n</code></pre>\n"}], "owner": {"reputation": 2502, "user_id": 1016439, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/84184ddecf5e9bb8483f80e7ac2e5fe4?s=128&d=identicon&r=PG", "display_name": "Jepzen", "link": "https://stackoverflow.com/users/1016439/jepzen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 91, "favorite_count": 0, "accepted_answer_id": 42516875, "answer_count": 1, "score": 0, "last_activity_date": 1488308942, "creation_date": 1488308160, "question_id": 42516636, "link": "https://stackoverflow.com/questions/42516636/rvm-list-known-differs-between-develop-and-production", "title": "rvm list known differs between develop and production", "body": "<p>I was planing to upgrade my ruby version for a project. On 1.9.3 so was thinking it was good idea to do in steps. First step would be 2.0.0, I run <code>rvm list known</code> and get this</p>\n\n<pre><code>...\n[ruby-]1.9.3[-p551]\n[ruby-]2.0.0[-p648]\n[ruby-]2.1[.1 \n...\n</code></pre>\n\n<p>But when I run the same command on my production server I get</p>\n\n<pre><code>[ruby-]1.9.2[-p330]\n[ruby-]1.9.3[-p547]\n[ruby-]2.0.0-p481\n[ruby-]2.0.0[-p576]\n[ruby-]2.1.2\n</code></pre>\n\n<p>Why do these list differs ? Seems like it would be a good idea to use the same version on both dev and prod </p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 48049, "user_id": 6419007, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/CwqtX.jpg?s=128&g=1", "display_name": "Eric Duminil", "link": "https://stackoverflow.com/users/6419007/eric-duminil"}, "edited": false, "score": 0, "creation_date": 1488308246, "post_id": 42516635, "comment_id": 72170241, "body": "Is there ary restriction on <code>verb&#47;noun&#47;article</code> order?"}, {"owner": {"reputation": 48049, "user_id": 6419007, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/CwqtX.jpg?s=128&g=1", "display_name": "Eric Duminil", "link": "https://stackoverflow.com/users/6419007/eric-duminil"}, "edited": false, "score": 1, "creation_date": 1488308343, "post_id": 42516635, "comment_id": 72170295, "body": "Also, <code>I must have a verb, a noun, or at least 2 articles. </code> is ambiguous."}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 1, "creation_date": 1488308887, "post_id": 42516635, "comment_id": 72170621, "body": "The example values look quite cryptic. Is there a good reason not to use actual (or maybe fake but pronounceable) nouns, verbs, and articles?"}, {"owner": {"reputation": 15, "user_id": 6395212, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8c17de983fe40533c6554e54638e6448?s=128&d=identicon&r=PG&f=1", "display_name": "joshh45", "link": "https://stackoverflow.com/users/6395212/joshh45"}, "edited": false, "score": 0, "creation_date": 1488313788, "post_id": 42516635, "comment_id": 72173160, "body": "There is no restriction on order for a verb, noun, or article as long as the original order remains the same"}], "answers": [{"comments": [{"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 1, "creation_date": 1488321501, "post_id": 42517016, "comment_id": 72177089, "body": "Good solution, Eric. You might want to pare down <code>grammar</code> as an optimization before doing anything else: <code>str = &quot;abcdefg&quot;; gram = grammar.each_with_object({}) { |(k,v),h| h[k] = v.select { |s| str.include?(s) } } #=&gt; {:noun=&gt;[&quot;abcd&quot;, &quot;c&quot;, &quot;def&quot;, &quot;cde&quot;], :verb=&gt;[&quot;bc&quot;, &quot;fg&quot;, &quot;g&quot;, &quot;bcd&quot;], :article=&gt;[&quot;a&quot;, &quot;e&quot;]}</code>."}, {"owner": {"reputation": 48049, "user_id": 6419007, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/CwqtX.jpg?s=128&g=1", "display_name": "Eric Duminil", "link": "https://stackoverflow.com/users/6419007/eric-duminil"}, "reply_to_user": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1488322567, "post_id": 42517016, "comment_id": 72177538, "body": "Thanks, good idea. Given the OP code, I didn&#39;t want to invest too much time either."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1488353572, "post_id": 42517016, "comment_id": 72187358, "body": "I wrote another recursive solution, but it&#39;s nowhere near as nice as yours. Your solution will have some take-aways for me."}], "tags": [], "owner": {"reputation": 48049, "user_id": 6419007, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/CwqtX.jpg?s=128&g=1", "display_name": "Eric Duminil", "link": "https://stackoverflow.com/users/6419007/eric-duminil"}, "is_accepted": true, "score": 1, "last_activity_date": 1488309890, "last_edit_date": 1488309890, "creation_date": 1488309447, "answer_id": 42517016, "question_id": 42516635, "link": "https://stackoverflow.com/questions/42516635/ruby-creating-sentences-with-substrings-while-maintaining-order/42517016#42517016", "title": "Ruby creating sentences with substrings while maintaining order", "body": "<p>It is possible without Regex, but you'll have a hard time writing anything without recursion :</p>\n\n<pre><code>grammar = {\n  noun: [\"abcd\", \"c\", \"def\", \"h\", \"ij\", \"cde\"],\n  verb: [\"bc\", \"fg\", \"g\", \"hij\", \"bcd\"],\n  article:  [\"a\", \"ac\", \"e\"]}\n\ndef find_sentences(text, grammar, head = [], structure = [])\n  if text.empty?\n    if structure.include?(:verb) || structure.include?(:noun) || structure.count(:article) &gt; 2\n      puts \"Sentence found : \"\n      puts head.join(' ')\n      puts structure.join(' ')\n      puts\n    end\n  else\n    grammar.each do |type, words|\n      words.each do |word|\n        if text.start_with?(word)\n          find_sentences(text.slice(word.size..-1), grammar, head + [word], structure + [type])\n        end\n      end\n    end\n  end\nend\n\nfind_sentences(\"abcdefg\", grammar)\n</code></pre>\n\n<p>It outputs :</p>\n\n<pre><code>Sentence found :\nabcd e fg\nnoun article verb\n\nSentence found :\na bc def g\narticle verb noun verb\n\nSentence found :\na bcd e fg\narticle verb article verb\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 48049, "user_id": 6419007, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/CwqtX.jpg?s=128&g=1", "display_name": "Eric Duminil", "link": "https://stackoverflow.com/users/6419007/eric-duminil"}, "edited": false, "score": 0, "creation_date": 1488406699, "post_id": 42525393, "comment_id": 72222146, "body": "&quot;set&quot; is a noun and a verb, so your structure might not work."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "reply_to_user": {"reputation": 48049, "user_id": 6419007, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/CwqtX.jpg?s=128&g=1", "display_name": "Eric Duminil", "link": "https://stackoverflow.com/users/6419007/eric-duminil"}, "edited": false, "score": 1, "creation_date": 1488407725, "post_id": 42525393, "comment_id": 72222652, "body": "Eric, joshh45&#39;s language is called &quot;Bishna&quot;. One of it&#39;s characteristics (as in the example) is that every word is exactly one part of speech (similar to Umzergi). If the language were changed to permit a word to be more than one part of speech we could deal with that by merely modifying <code>grammar</code>: remove all but one instance of each word, with preference for the one remaining being noun or verb, then article."}], "tags": [], "owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "is_accepted": false, "score": 1, "last_activity_date": 1488353671, "last_edit_date": 1488353671, "creation_date": 1488352295, "answer_id": 42525393, "question_id": 42516635, "link": "https://stackoverflow.com/questions/42516635/ruby-creating-sentences-with-substrings-while-maintaining-order/42525393#42525393", "title": "Ruby creating sentences with substrings while maintaining order", "body": "<p>Here's another way of writing a recursive method.</p>\n\n<pre><code>def all_sentences(str, grammar)\n  gram = grammar.each_with_object({}) { |(k,v),h|\n    v.select { |s| str.include?(s) }.each { |s| h[s] = k } }\n  recurse(str, gram.keys, gram, '')\nend\n\ndef recurse(str, parts, gram, partial)\n  p = partial.delete(' ')\n  parts.each_with_object([]) do |part, arr|\n    combine = p + part\n    next unless str.start_with?(combine)\n    s = (partial + ' ' + part).lstrip\n    if combine.size == str.size\n      arr &lt;&lt; s if valid?(s, gram)\n    else\n      arr.concat(recurse(str, parts, gram, s))\n    end\n  end\nend\n\ndef valid?(candidate, gram)\n  arr = candidate.split\n  arr.any? { |s| [:noun, :verb].include?(gram[s]) } ||\n    arr.count { |s| gram[s] == :article } &gt; 1\nend\n</code></pre>\n\n<p><strong>Example</strong></p>\n\n<pre><code>grammar = {\n  noun: [\"abcd\", \"c\", \"def\", \"h\", \"ij\", \"cde\"],\n  verb: [\"bc\", \"fg\", \"g\", \"hij\", \"bcd\"],\n  article:  [\"a\", \"ac\", \"e\"]\n}\n\nstr = \"abcdefg\"\n\nall_sentences(str, grammar)\n  #=&gt; [\"abcd e fg\", \"a bc def g\", \"a bcd e fg\"]\n</code></pre>\n\n<p><strong>Note</strong></p>\n\n<p>For the example, the hash <code>gram</code> is computed as follows.</p>\n\n<pre><code>gram = grammar.each_with_object({}) { |(k,v),h|\n  v.select { |s| str.include?(s) }.each { |s| h[s] = k } }\n  #=&gt; {\"abcd\"=&gt;:noun, \"c\"=&gt;:noun, \"def\"=&gt;:noun, \"cde\"=&gt;:noun,\n  #    \"bc\"=&gt;:verb, \"fg\"=&gt;:verb, \"g\"=&gt;:verb, \"bcd\"=&gt;:verb,\n  #    \"a\"=&gt;:article, \"e\"=&gt;:article} \n</code></pre>\n\n<p>Notice that as well as mapping words into parts of speech, I have removed a few \"words\" that cannot be part of the \"sentence\" <code>str</code>.</p>\n\n<p>It strikes me that</p>\n\n<pre><code>words_to_pos = grammar.each_with_object({}) { |(k,v),h| v.each { |s| h[s] = k } }\n  #=&gt; {\"abcd\"=&gt;:noun, \"c\"=&gt;:noun, \"def\"=&gt;:noun, \"h\"=&gt;:noun, \"ij\"=&gt;:noun,\n  #    \"cde\"=&gt;:noun, \"bc\"=&gt;:verb, \"fg\"=&gt;:verb, \"g\"=&gt;:verb, \"hij\"=&gt;:verb,\n  #    \"bcd\"=&gt;:verb, \"a\"=&gt;:article, \"ac\"=&gt;:article, \"e\"=&gt;:article} \n</code></pre>\n\n<p>would have been a more convenient data structure than the original <code>grammar</code> (\"pos\" for \"part of speech\"). </p>\n"}, {"tags": [], "owner": {"reputation": 689, "user_id": 3442392, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aafaa8822c1eb7bfc68c47e50f83ad62?s=128&d=identicon&r=PG", "display_name": "aqfaridi", "link": "https://stackoverflow.com/users/3442392/aqfaridi"}, "is_accepted": false, "score": 0, "last_activity_date": 1493496163, "creation_date": 1493496163, "answer_id": 43699985, "question_id": 42516635, "link": "https://stackoverflow.com/questions/42516635/ruby-creating-sentences-with-substrings-while-maintaining-order/43699985#43699985", "title": "Ruby creating sentences with substrings while maintaining order", "body": "<p>solved using recursion and lambda in ruby : </p>\n\n<pre><code>@nouns = [\"abcd\", \"c\", \"def\", \"h\", \"ij\", \"cde\"]\n@verbs = [\"bc\", \"fg\", \"g\", \"hij\", \"bcd\"]\n@articles = [\"a\", \"ac\", \"e\"]\n@return_arr = []\ndef solve(idx, hash, ans = [])\n    # base case\n    if (idx &gt;= $str.length) and  ( hash['vs'] &gt;= 1) and (hash['ns'] &gt;= 1 or hash['as'] &gt;= 2)\n        @return_arr &lt;&lt; ans.join(\" \")\n        return\n    end\n    # define lamda to do common operation\n    execute = lambda do |var, i|\n        hash[var] += 1\n        ans &lt;&lt; $str[idx..i]\n        solve(i+1, hash, ans)\n        ans.pop\n        hash[var] -= 1\n    end\n    #check for nouns, verbs, articles\n    $str.each_char.with_index do |c,i|\n        next if i &lt; idx\n        execute.call('ns', i) if @nouns.include? $str[idx..i]\n        execute.call('vs', i) if @verbs.include? $str[idx..i]\n        execute.call('as', i)if @articles.include? $str[idx..i]\n    end\nend\n\n$str = gets.strip\nhash = Hash.new(0)\nsolve(0, hash)\np @return_arr\n</code></pre>\n\n<p>Input : <code>abcdefg</code></p>\n\n<p>Output : <code>[\"a bc def g\", \"a bcd e fg\", \"abcd e fg\"]</code></p>\n"}], "owner": {"reputation": 15, "user_id": 6395212, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8c17de983fe40533c6554e54638e6448?s=128&d=identicon&r=PG&f=1", "display_name": "joshh45", "link": "https://stackoverflow.com/users/6395212/joshh45"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 271, "favorite_count": 0, "accepted_answer_id": 42517016, "answer_count": 3, "score": 1, "last_activity_date": 1493496163, "creation_date": 1488308157, "question_id": 42516635, "link": "https://stackoverflow.com/questions/42516635/ruby-creating-sentences-with-substrings-while-maintaining-order", "title": "Ruby creating sentences with substrings while maintaining order", "body": "<p>I am currently working on a Ruby problem in which I am essentially creating my own language. Below (nouns, verbs, articles) can be thought as words. However, in order to create a valid sentence, I must have a verb, a noun, or at least 2 articles.   </p>\n\n<p>Nouns: \"abcd\", \"c\", \"def\", \"h\", \"ij, \"cde\"</p>\n\n<p>Verbs: \"bc\", \"fg\", \"g\", \"hij\", \"bcd\"</p>\n\n<p>Articles: \"a\", \"ac\", \"e\"</p>\n\n<p>So what I am trying to do is basically write a method that takes a string and returns all possible valid sentences (while keeping characters in the same order and inserting a space between the words) </p>\n\n<p>ex. input = <code>\"abcdefg\"</code> \nreturns the list </p>\n\n<pre><code>[ \"a bc def g\", \"a bcd e fg\", \"abcd e fg\"] \n</code></pre>\n\n<p>So I tried breaking down the problem and this is what I have so far</p>\n\n<pre><code>alpha = \"abcdefg\"\n\n\n\nnouns = [\"abcd\", \"c\", \"def\", \"h\", \"ij\", \"cde\"]\nverbs = [\"bc\", \"fg\", \"g\", \"hij\", \"bcd\"]\narticles = [\"a\", \"ac\", \"e\"]\n\nverbArray = [];\nnounArray = [];\narticleArray = [];\n\nnouns.each do |item|\n  if alpha.include?(item)\n    nounArray &lt;&lt; item\n  end\nend\n\nverbs.each do |item|\n  if alpha.include?(item)\n    verbArray &lt;&lt; item\n  end\nend\n\narticles.each do |item|\n  if alpha.include?(item)\n    articleArray &lt;&lt; item\n  end\nend\n\n\nputs nounArray.inspect =&gt; [\"abcd\", \"c\", \"def\", \"cde\"]\nputs verbArray.inspect =&gt; [\"bc\", \"fg\", \"g\", \"bcd\"]\nputs articleArray.inspect =&gt; [\"a\", \"e\"]\n</code></pre>\n\n<p>My thought process was that I first wanted to get all possible combinations for each of the words (nouns, verb, article). I am not sure if this is the most efficient way to approach this problem but beyond this step I was trying without much success to form ordered sentences.   </p>\n\n<p>I've been searching stacks and other websites for types of combinations/sorting techniques plus I am trying to avoid using regex at the moment. I would honestly appreciate any direction/feedback as how to continue my journey to solving this problem.Thank you for your time!</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ajax"], "comments": [{"owner": {"reputation": 1506, "user_id": 2831700, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/5e40a909ecdd6e94a32e120c0044ac9d?s=128&d=identicon&r=PG", "display_name": "IvRRimUm", "link": "https://stackoverflow.com/users/2831700/ivrrimum"}, "edited": false, "score": 0, "creation_date": 1488312951, "post_id": 42516614, "comment_id": 72172726, "body": "What does js console says when you try to submit the select?"}], "answers": [{"tags": [], "owner": {"reputation": 9015, "user_id": 155826, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/55RCe.jpg?s=128&g=1", "display_name": "Ryan Crispin Heneise", "link": "https://stackoverflow.com/users/155826/ryan-crispin-heneise"}, "is_accepted": true, "score": 3, "last_activity_date": 1488313238, "creation_date": 1488313238, "answer_id": 42518021, "question_id": 42516614, "link": "https://stackoverflow.com/questions/42516614/ajax-in-rails-remote-true-on-a-specific-form-field-not-submitting/42518021#42518021", "title": "ajax in rails: remote: true on a specific form field not submitting", "body": "<p>Rails' built-in form helpers allow you to use <code>remote: true</code> on the following helpers: <code>form_tag</code>, <code>form_for</code>, <code>link_to</code>, and <code>button_to</code>. Adding <code>remote: true</code> to a single field inside the form will have no effect. See <a href=\"http://edgeguides.rubyonrails.org/working_with_javascript_in_rails.html#built-in-helpers\" rel=\"nofollow noreferrer\">Working with Javascript in Rails</a>. </p>\n\n<p>You will need to bind a javascript function to the <code>food_type_id</code> select: </p>\n\n<pre><code>$('select#user_food_type_id').change(function() {\n  $.ajax({\n     url: '/food_types.json', // you could be fancy and set this in a data attribute.\n     success: function(response) {\n       // update your form with the response from your ajax request\n     }\n  });\n});\n</code></pre>\n"}], "owner": {"reputation": 6076, "user_id": 4044009, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/42e57031eb7d02c47c9afaecfc878638?s=128&d=identicon&r=PG&f=1", "display_name": "Neil", "link": "https://stackoverflow.com/users/4044009/neil"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1655, "favorite_count": 0, "accepted_answer_id": 42518021, "answer_count": 1, "score": 1, "last_activity_date": 1488313238, "creation_date": 1488308064, "question_id": 42516614, "link": "https://stackoverflow.com/questions/42516614/ajax-in-rails-remote-true-on-a-specific-form-field-not-submitting", "title": "ajax in rails: remote: true on a specific form field not submitting", "body": "<p>I know that you can submit a form in rails via an ajax request by simply supplying <code>remote: true</code>:</p>\n\n<pre><code>&lt;%= form_for(@user, remote: true) do %&gt;\n  ...\n&lt;% end %&gt;\n</code></pre>\n\n<p>Now: when the form submits: instead of an HTTP request it is an ajax request.</p>\n\n<p>What I want to do is submit a JS request (ajax request) <em>not for the entire form</em>, but for a specific field element, but it is not working. Specifically: the ajax request should fire off when the user makes a selection within the select box:</p>\n\n<pre><code>&lt;%= form_for(@user) do %&gt;\n\n  &lt;div class=\"field\"&gt;\n    &lt;%= f.label :food_type_id %&gt;\n    &lt;%= f.collection_select :food_type_id, FoodType.all, :id, :name, remote: true %&gt;        \n  &lt;/div&gt;\n\n  ...\n\n&lt;% end %&gt;\n</code></pre>\n\n<p>I would expect an AJAX request to be sent to the server since I provided the <code>remote: true</code> option on the field.  So: whenever the user makes a selection: an ajax request fires off.  However: nothing is happening.  </p>\n\n<p>What am I missing? I know that I could do it all myself: bind an event listener to the select box on the client side and fire off a request when the select box changes.  However: I thought <code>remote: true</code> can handle ajax requests for you, so there would be no need for me to do any custom-ajax-request building.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "http", "httprequest", "rest-client"], "comments": [{"owner": {"reputation": 3273, "user_id": 5021963, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/t7Qsr.png?s=128&g=1", "display_name": "Ed de Almeida", "link": "https://stackoverflow.com/users/5021963/ed-de-almeida"}, "reply_to_user": {"reputation": 14010, "user_id": 3109182, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/a4b305f0077055b4fdcf715067775d5a?s=128&d=identicon&r=PG", "display_name": "Anthony", "link": "https://stackoverflow.com/users/3109182/anthony"}, "edited": false, "score": 0, "creation_date": 1488309714, "post_id": 42515314, "comment_id": 72171039, "body": "Sure. I did that. With <code>{&#39;grant_type&#39; =&gt; &#39;client_credentials&#39;}</code> I get a <code>400 Bad Request</code>. If I do it with <code>{&#39;grant_type&#39; =&gt; &#39;client_credentials&#39;}.to_json</code> as I found in some references, I get a <code>415 Unsupported Media Type</code>..."}, {"owner": {"reputation": 3273, "user_id": 5021963, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/t7Qsr.png?s=128&g=1", "display_name": "Ed de Almeida", "link": "https://stackoverflow.com/users/5021963/ed-de-almeida"}, "reply_to_user": {"reputation": 14010, "user_id": 3109182, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/a4b305f0077055b4fdcf715067775d5a?s=128&d=identicon&r=PG", "display_name": "Anthony", "link": "https://stackoverflow.com/users/3109182/anthony"}, "edited": false, "score": 0, "creation_date": 1488310567, "post_id": 42515314, "comment_id": 72171544, "body": "Agreed, @Anthony. And this is why I am surprised it doesn&#39;t work. Don&#39;t really know what to do."}], "answers": [{"comments": [{"owner": {"reputation": 3273, "user_id": 5021963, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/t7Qsr.png?s=128&g=1", "display_name": "Ed de Almeida", "link": "https://stackoverflow.com/users/5021963/ed-de-almeida"}, "edited": false, "score": 0, "creation_date": 1488308157, "post_id": 42516612, "comment_id": 72170189, "body": "I know. But my project requires me to build this and I can&#39;t use an external gem. But thanks for your suggestion!"}], "tags": [], "owner": {"reputation": 1728, "user_id": 1200183, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0930e98b91bafa1cb67ee2b5e2ce0303?s=128&d=identicon&r=PG", "display_name": "SamHecquet", "link": "https://stackoverflow.com/users/1200183/samhecquet"}, "is_accepted": false, "score": 1, "last_activity_date": 1488308060, "creation_date": 1488308060, "answer_id": 42516612, "question_id": 42515314, "link": "https://stackoverflow.com/questions/42515314/spotify-web-api-basic-authorization/42516612#42516612", "title": "Spotify Web API: Basic authorization", "body": "<p>It's not exactly the answer you're looking for, but you should definitively take a look at this Ruby Library: <a href=\"https://github.com/guilhermesad/rspotify#rails--oauth\" rel=\"nofollow noreferrer\">rspotify</a>. Spotify Oauthentication is very easy to do with it.</p>\n"}, {"tags": [], "owner": {"reputation": 14010, "user_id": 3109182, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/a4b305f0077055b4fdcf715067775d5a?s=128&d=identicon&r=PG", "display_name": "Anthony", "link": "https://stackoverflow.com/users/3109182/anthony"}, "is_accepted": true, "score": 3, "last_activity_date": 1488311445, "last_edit_date": 1495540817, "creation_date": 1488310676, "answer_id": 42517344, "question_id": 42515314, "link": "https://stackoverflow.com/questions/42515314/spotify-web-api-basic-authorization/42517344#42517344", "title": "Spotify Web API: Basic authorization", "body": "<p>The issue is the way Base64 is encoding the string which includes newlines that most OAuth2 providers don't accept.  You can do this instead:</p>\n\n<pre><code>grant = Base64.encode64(\"#{client_id}:#{client_secret}\").delete(\"\\n\")\n\nresp = RestClient.post('https://accounts.spotify.com/api/token',\n                       {'grant_type' =&gt; 'client_credentials'},\n                       {\"Authorization\" =&gt; \"Basic #{grant}\"})\n</code></pre>\n\n<p>According to <a href=\"https://stackoverflow.com/a/2621023/3109182\">this</a> answer, new lines are added every 60 characters (that is news to me).  You can use another method that does not include newlines such as <code>strict_encode</code>...</p>\n\n<pre><code>grant = Base64.strict_encode64(\"#{client_id}:#{client_secret}\")\n</code></pre>\n"}], "owner": {"reputation": 3273, "user_id": 5021963, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/t7Qsr.png?s=128&g=1", "display_name": "Ed de Almeida", "link": "https://stackoverflow.com/users/5021963/ed-de-almeida"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1302, "favorite_count": 1, "accepted_answer_id": 42517344, "answer_count": 2, "score": 2, "last_activity_date": 1488311445, "creation_date": 1488303361, "last_edit_date": 1488304255, "question_id": 42515314, "link": "https://stackoverflow.com/questions/42515314/spotify-web-api-basic-authorization", "title": "Spotify Web API: Basic authorization", "body": "<p>I need to get an access token from <strong>Spotify Web API</strong>. Based on <a href=\"https://developer.spotify.com/web-api/authorization-guide/#client-credentials-flow\" rel=\"nofollow noreferrer\">this documentation</a> I wrote the following method:</p>\n\n<pre><code>def authorize\n  grant = Base64.encode64(\"#{SPOTIFY_KEY}:#{SPOTIFY_SECRET}\")\n  RestClient::Request.execute(\n    method: :post,\n    url: 'https://accounts.spotify.com/api/token',\n    params: {'grant_type' =&gt; 'client_credentials'},\n    headers: {\"Authorization\" =&gt; \"Basic #{grant}\",\"Accept\" =&gt; \"*/*; q=0.5, application/json\"}\n  )\nend\n</code></pre>\n\n<p>and the following RSpec test:</p>\n\n<pre><code>it 'authorize' do\n  obj = SpotifyIntegration.new\n  response = obj.authorize\n  myjson = JSON.parse(response.body)\n  expect(myjson.has_key?('access_token')).to be(true)\n  expect(myjson.has_key?('token_type')).to be(true)\n  expect(myjson['token_type']).to eq('bearer')\n  expect(myjson.has_key?('expires_in')).to be(true)\nend\n</code></pre>\n\n<p>It happens that when I run this test, generating this request (caught with RESTCLIENT_LOG=stdout)</p>\n\n<blockquote>\n  <p>RestClient.post \"<a href=\"https://accounts.spotify.com/api/token\" rel=\"nofollow noreferrer\">https://accounts.spotify.com/api/token</a>\", \"Accept\"=>\"<em>/</em>; q=0.5, application/json\", \"Accept-Encoding\"=>\"gzip, deflate\", \"Authorization\"=>\"Basic Y2NmNTI3ODVlZWI1NDVlODk0ZmM2ZTY3YTZhNDM0ZDA6YTQ5MjdlOGFmOWQy\\nNGE0OTgyZDRkODI1MmJhZjBkNTI=\\n\"</p>\n</blockquote>\n\n<p>I get</p>\n\n<blockquote>\n  <p>=> 400 BadRequest | application/json 131 bytes</p>\n</blockquote>\n\n<p>And it seems it is really a bad request, because I see no sign of the <code>grant_type =&gt; client_credentials</code>. The documentaions says this is mandadory <strong>as a request body parameter</strong>.</p>\n\n<p>I believe I am sending this the wrong way, but I don't know how to to it correctly.</p>\n\n<p>I tried to use <code>RestClient#post</code> instead of <code>RestClient::Request#execute</code>, doing this:</p>\n\n<pre><code>def authorize\n  grant = Base64.encode64(\"#{SPOTIFY_KEY}:#{SPOTIFY_SECRET}\")\n  RestClient.post 'https://accounts.spotify.com/api/token', {'grant_type' =&gt; 'client_credentials'}.to_json, {\"Authentication\" =&gt; \"Basic #{grant}\",content_type: :json, accept: :json}\nend\n</code></pre>\n\n<p>but then I got:</p>\n\n<blockquote>\n  <p>RestClient::UnsupportedMediaType:\n         415 Unsupported Media Type</p>\n</blockquote>\n\n<p>How may I send a request body parameter using <code>RestClient</code> gem? </p>\n"}, {"tags": ["javascript", "ruby-on-rails", "ruby", "csv"], "comments": [{"owner": {"reputation": 91121, "user_id": 179125, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5594142dcc49a24b1902ec8059181f8d?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan Running", "link": "https://stackoverflow.com/users/179125/jordan-running"}, "edited": false, "score": 1, "creation_date": 1488304321, "post_id": 42515249, "comment_id": 72168214, "body": "How often does the CSV file change? Unless it changes <i>constantly</i> then its pretty wasteful to have the browser process it on every request. Consider processing it once, on the server, whenever it changes and saving the result, then sending the pre-processed JSON to the browser instead."}, {"owner": {"reputation": 900, "user_id": 6060650, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/tIFN7.jpg?s=128&g=1", "display_name": "Hicham Zouarhi", "link": "https://stackoverflow.com/users/6060650/hicham-zouarhi"}, "reply_to_user": {"reputation": 91121, "user_id": 179125, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5594142dcc49a24b1902ec8059181f8d?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan Running", "link": "https://stackoverflow.com/users/179125/jordan-running"}, "edited": false, "score": 0, "creation_date": 1488305138, "post_id": 42515249, "comment_id": 72168675, "body": "@Jordan thanks, I&#39;m trying it"}], "answers": [{"comments": [{"owner": {"reputation": 900, "user_id": 6060650, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/tIFN7.jpg?s=128&g=1", "display_name": "Hicham Zouarhi", "link": "https://stackoverflow.com/users/6060650/hicham-zouarhi"}, "edited": false, "score": 0, "creation_date": 1488303409, "post_id": 42515306, "comment_id": 72167730, "body": "thanks, I forgot to mention that I don&#39;t want that csv file to be accessed from a url"}, {"owner": {"reputation": 148, "user_id": 1446863, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c41aba94a42dce2b0d34bcde14310d4c?s=128&d=identicon&r=PG", "display_name": "Maxime Alay-Eddine", "link": "https://stackoverflow.com/users/1446863/maxime-alay-eddine"}, "reply_to_user": {"reputation": 900, "user_id": 6060650, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/tIFN7.jpg?s=128&g=1", "display_name": "Hicham Zouarhi", "link": "https://stackoverflow.com/users/6060650/hicham-zouarhi"}, "edited": false, "score": 0, "creation_date": 1488303505, "post_id": 42515306, "comment_id": 72167786, "body": "It you don&#39;t want the CSV file to be accessible from a URL, then how do you want to pass it to your Ajax call? (do you mean that you don&#39;t want the file to be publicly accessible? or do you refuse the URL approach?)"}, {"owner": {"reputation": 900, "user_id": 6060650, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/tIFN7.jpg?s=128&g=1", "display_name": "Hicham Zouarhi", "link": "https://stackoverflow.com/users/6060650/hicham-zouarhi"}, "edited": false, "score": 0, "creation_date": 1488303924, "post_id": 42515306, "comment_id": 72167984, "body": "I don&#39;t want it to be publicly accessible, like localhost:3000/assets/mycsvfile.csv shouldn&#39;t be downloadable"}], "tags": [], "owner": {"reputation": 148, "user_id": 1446863, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c41aba94a42dce2b0d34bcde14310d4c?s=128&d=identicon&r=PG", "display_name": "Maxime Alay-Eddine", "link": "https://stackoverflow.com/users/1446863/maxime-alay-eddine"}, "is_accepted": false, "score": 1, "last_activity_date": 1488304338, "last_edit_date": 1488304338, "creation_date": 1488303345, "answer_id": 42515306, "question_id": 42515249, "link": "https://stackoverflow.com/questions/42515249/how-to-access-a-csv-file-in-rails/42515306#42515306", "title": "How to access a csv file in Rails", "body": "<p>Put the file <code>mycsvfile.csv</code> in the \"public\" directory of your Rails app.</p>\n\n<p>Then, you will be able to load it directly from a <code>YOURDOMAIN/mycsvfile.csv</code> request.</p>\n\n<p>EDIT:</p>\n\n<p>As you don't want to use public URL, you have either to use HTTP server auth or Rails Server to handle the file download.</p>\n\n<p>For the Rails app to handle the file download, use the <code>send_file</code> command.\nYou will be able to check proper users permissions in the controller before serving the static file.</p>\n\n<p>Example:</p>\n\n<pre><code>class ClientsController &lt; ApplicationController\n    # Stream a file that has already been generated and stored on disk.\n    def download_pdf\n        client = Client.find(params[:id])\n        send_file(\"#{Rails.root}/files/clients/#{client.id}.pdf\",\n          filename: \"#{client.name}.pdf\",\n          type: \"application/pdf\")\n    end\nend\n</code></pre>\n\n<p>Source: <a href=\"http://guides.rubyonrails.org/action_controller_overview.html#sending-files\" rel=\"nofollow noreferrer\">http://guides.rubyonrails.org/action_controller_overview.html#sending-files</a></p>\n"}], "owner": {"reputation": 900, "user_id": 6060650, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/tIFN7.jpg?s=128&g=1", "display_name": "Hicham Zouarhi", "link": "https://stackoverflow.com/users/6060650/hicham-zouarhi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 846, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1488304338, "creation_date": 1488303152, "question_id": 42515249, "link": "https://stackoverflow.com/questions/42515249/how-to-access-a-csv-file-in-rails", "title": "How to access a csv file in Rails", "body": "<p>I'm working on a Ruby on Rails app, where I need to load some data in csv format to a JS script to process.</p>\n\n<p>my csv file is in <code>app/assets</code> and my js file is <code>app/assets/javascripts</code> which I process in <code>assets.rb</code> using :</p>\n\n<pre><code>Rails.application.config.assets.precompile += %w( myscript.js ) \n</code></pre>\n\n<p>in `myscript.js I make an ajax call to the csv file :</p>\n\n<pre><code>$.ajax({\n    url: \"assets/mycsvfile.csv\",\n    async: true,\n    success: function (csvd) {\n        // processing csv data\n        },\n    error: function(e) {\n        var errorMsg = e? (e.status + ' ' + e.statusText) : \"\";\n        console.log(errorMsg);\n        },\n    dataType: \"text\"\n    });\n</code></pre>\n\n<p>I still get</p>\n\n<blockquote>\n  <p>404 file not found</p>\n</blockquote>\n\n<p>How can I load that csv file ?</p>\n\n<p>Thanks</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "answers": [{"tags": [], "owner": {"reputation": 18203, "user_id": 100731, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/056c32203f8017f075ac060069823b66?s=128&d=identicon&r=PG", "display_name": "phoet", "link": "https://stackoverflow.com/users/100731/phoet"}, "is_accepted": true, "score": 1, "last_activity_date": 1488310148, "creation_date": 1488310148, "answer_id": 42517204, "question_id": 42514802, "link": "https://stackoverflow.com/questions/42514802/accessing-more-than-default-parameters-to-from-subject-reply-to-for-rails-m/42517204#42517204", "title": "Accessing more than default parameters (to, from, subject, reply_to) for rails mail interceptor", "body": "<p>while i don't think that what you are doing there really makes sense, it is possible.</p>\n\n<p>in the interceptor you get an instance of <code>Mail::Message</code>. it has access to whatever you pass into the <code>mail</code> call.</p>\n\n<p>so in the example you provided it would be</p>\n\n<pre><code>mail[:community].value\n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 5078930, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/e94d8b943796f1a1ab5f3db235b2b2ed?s=128&d=identicon&r=PG&f=1", "display_name": "MapsBySteve", "link": "https://stackoverflow.com/users/5078930/mapsbysteve"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 160, "favorite_count": 0, "accepted_answer_id": 42517204, "answer_count": 1, "score": 0, "last_activity_date": 1488310148, "creation_date": 1488301779, "question_id": 42514802, "link": "https://stackoverflow.com/questions/42514802/accessing-more-than-default-parameters-to-from-subject-reply-to-for-rails-m", "title": "Accessing more than default parameters (to, from, subject, reply_to) for rails mail interceptor", "body": "<p>I have a method within a mailer called <code>notification_mailer.rb</code>:</p>\n\n<pre><code>def reminder_email\n    @community = @reminder.community\n    subject = \"random subject text\"\n    mail(from: address_for(support), reply_to: address_for(support), to: to_address, subject: subject)\nend\n</code></pre>\n\n<p>I am trying to use a mail interceptor <code>check_mail_settings.rb</code>:</p>\n\n<pre><code>class CheckMailSettings\n  def self.delivering_email(mail)   \n    if @community.status = \"mute\"\n      mail.perform_deliveries = false\n    end\n  end\nend\nActionMailer::Base.register_interceptor(CheckMailSettings)\n</code></pre>\n\n<p>But this interceptor does not actually have access to the <code>@community</code> variable.  I have tried passing it in the mail call in <code>notification_mailer.rb</code> like so </p>\n\n<pre><code>mail(community: @community, from: address_for(support).....)\n</code></pre>\n\n<p>and accessing it within the interceptor <code>check_mail_settings.rb</code> like this </p>\n\n<pre><code>mail.community \n</code></pre>\n\n<p>but that does not work either.</p>\n\n<p>Is there any way I can get access to this <code>@community</code> variable within the interceptor <code>check_mail_settings.rb</code> or will I need to do any conditionals involving <code>@community</code> within the <code>notification_mailer.rb</code> beforehand?</p>\n"}, {"tags": ["ruby", "postgresql", "pg"], "comments": [{"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 0, "creation_date": 1488303564, "post_id": 42514451, "comment_id": 72167814, "body": "I&#39;d highly recommend using <a href=\"http://sequel.jeremyevans.net\" rel=\"nofollow noreferrer\">Sequel</a> when talking to databases if you are not using Rails. It&#39;s a very good ORM that will make it much easier to generate queries or statements without needing to worry about the syntax. Pg forces you to write SQL specific to PostgreSQL. Sequel lets you use Ruby to generate the SQL and is DBM agnostic, <a href=\"http://sequel.jeremyevans.net/rdoc-adapters/index.html\" rel=\"nofollow noreferrer\">supporting many different DBMs</a>, and you only change your DSN to have it automatically generate equivalent queries for a different database type."}, {"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 0, "creation_date": 1488303734, "post_id": 42514451, "comment_id": 72167896, "body": "In Ruby it&#39;s idiomatic to not use parenthesis around the <code>require</code> parameter. Also <code>@material1</code> shows you don&#39;t understand variables and their scope with Ruby. I&#39;d recommend getting familiar with class, instance and local variables, and constants."}, {"owner": {"reputation": 445, "user_id": 6364117, "user_type": "registered", "accept_rate": 21, "profile_image": "https://www.gravatar.com/avatar/cfda5cdb466b307fb347e1d7a6f72a98?s=128&d=identicon&r=PG", "display_name": "godhar", "link": "https://stackoverflow.com/users/6364117/godhar"}, "reply_to_user": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 0, "creation_date": 1488304153, "post_id": 42514451, "comment_id": 72168113, "body": "Alright! Had a look, seems promising. I am ready to jump train with pg, I only want to model a database. I will use rails later to build the API. Sequel looks more user friendly. Thanks @The Tin Man"}, {"owner": {"reputation": 445, "user_id": 6364117, "user_type": "registered", "accept_rate": 21, "profile_image": "https://www.gravatar.com/avatar/cfda5cdb466b307fb347e1d7a6f72a98?s=128&d=identicon&r=PG", "display_name": "godhar", "link": "https://stackoverflow.com/users/6364117/godhar"}, "reply_to_user": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 0, "creation_date": 1488304294, "post_id": 42514451, "comment_id": 72168196, "body": "I admit that I am relatively new to this, but none of the things you mention will disrupt the SqlRunner."}, {"owner": {"reputation": 445, "user_id": 6364117, "user_type": "registered", "accept_rate": 21, "profile_image": "https://www.gravatar.com/avatar/cfda5cdb466b307fb347e1d7a6f72a98?s=128&d=identicon&r=PG", "display_name": "godhar", "link": "https://stackoverflow.com/users/6364117/godhar"}, "reply_to_user": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 0, "creation_date": 1488304405, "post_id": 42514451, "comment_id": 72168251, "body": "What you are referring to is the style, I was taught to put parenthesis there, so I do; out of habit."}, {"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 0, "creation_date": 1488307548, "post_id": 42514451, "comment_id": 72169900, "body": "While you might have been taught to, that wasn&#39;t the recommended standard, making your code non-idiomatic for the language. It&#39;s a good idea to read/adopt the Ruby style-guides and enable Rubocop in your editor. Failing to do so will definitely raise questions in code reviews."}, {"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 0, "creation_date": 1488307643, "post_id": 42514451, "comment_id": 72169949, "body": "Pg is great as a driver to talk to PostgreSQL, but writing SQL by hand isn&#39;t a good use of time when good ORMs are available. Sequel is very well maintained and the author uses Postgres for his database so Sequel supports it very well."}, {"owner": {"reputation": 445, "user_id": 6364117, "user_type": "registered", "accept_rate": 21, "profile_image": "https://www.gravatar.com/avatar/cfda5cdb466b307fb347e1d7a6f72a98?s=128&d=identicon&r=PG", "display_name": "godhar", "link": "https://stackoverflow.com/users/6364117/godhar"}, "reply_to_user": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 0, "creation_date": 1488308293, "post_id": 42514451, "comment_id": 72170264, "body": "Fair play. I don&#39;t want to freak any Rubyists out with my laid-back use of the language. As I said I am a new comer and only post on stackoverflow when I really need to. Rubocop? Sounds interesting. I need a Rubocop. I don&#39;t want bad reviews so a Rubocop I will acquire. Thanks for letting me know about sequel, I used the pg method at the school, but it is tedious and laborsome. They wanted to teach us the long and hard way, I suppose."}, {"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 0, "creation_date": 1488332665, "post_id": 42514451, "comment_id": 72180331, "body": "They wanted to teach you the low-level way so you learned SQL, which is fine but in production environments we don&#39;t like doing that. It wastes time and makes it harder to move from local development to test and production, especially when the DBM changes. Occasionally we still have to write native code but we can bottle-neck that to reduce the impact."}], "answers": [{"comments": [{"owner": {"reputation": 445, "user_id": 6364117, "user_type": "registered", "accept_rate": 21, "profile_image": "https://www.gravatar.com/avatar/cfda5cdb466b307fb347e1d7a6f72a98?s=128&d=identicon&r=PG", "display_name": "godhar", "link": "https://stackoverflow.com/users/6364117/godhar"}, "edited": false, "score": 0, "creation_date": 1488302730, "post_id": 42514699, "comment_id": 72167350, "body": "good shout @eiko, but I get the same error. Made the change, progress is progress."}], "tags": [], "owner": {"reputation": 4150, "user_id": 7470620, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/49f3026fe13841e41d1805178eed9a3c?s=128&d=identicon&r=PG", "display_name": "eiko", "link": "https://stackoverflow.com/users/7470620/eiko"}, "is_accepted": false, "score": 1, "last_activity_date": 1488301464, "creation_date": 1488301464, "answer_id": 42514699, "question_id": 42514451, "link": "https://stackoverflow.com/questions/42514451/how-to-insert-into-postgres-table-with-the-pg-gem/42514699#42514699", "title": "How to insert into Postgres table with the PG gem", "body": "<p>You should have quotes around your strings:</p>\n\n<pre><code>def save\n sql = \"INSERT INTO materials (product_name, guk_name, roll_width_in, roll_length_metres,\nlist_price, cost_per_sqm, cost_per_sqm_with_ink, factor_n, sell_per_sqm, rounded_sale_price)\nVALUES ('#{@product_name}', '#{@guk_name}', #{@roll_width_in}, #{@roll_length_metres}, #{@list_price}\n#{@cost_per_sqm}, #{@cost_per_sqm_with_ink}, #{@factor_n}, #{@sell_per_sqm}, #{@rounded_sale_price}\n) RETURNING *\"\n\n  data = SqlRunner.run(sql).first\n  @id = data['id']\nend\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1, "user_id": 3199018, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d906341ea2bd6ce778cb173238cdc256?s=128&d=identicon&r=PG", "display_name": "rafael.cote", "link": "https://stackoverflow.com/users/3199018/rafael-cote"}, "edited": false, "score": 0, "creation_date": 1488304606, "post_id": 42515501, "comment_id": 72168351, "body": "Line breaks in variable sql also is bad. Try without Line breaks.   sql = &quot;INSERT INTO materials (product_name, guk_name, roll_width_in, roll_length_metres, list_price, cost_per_sqm, cost_per_sqm_with_ink, factor_n, sell_per_sqm, rounded_sale_price) VALUES (&#39;#{@product_name}&#39;, &#39;#{@guk_name}&#39;, #{@roll_width_in}, #{@roll_length_metres}, #{@list_price}, #{@cost_per_sqm}, #{@cost_per_sqm_with_ink}, #{@factor_n}, #{@sell_per_sqm}, #{@rounded_sale_price} ) RETURNING *&quot;"}, {"owner": {"reputation": 445, "user_id": 6364117, "user_type": "registered", "accept_rate": 21, "profile_image": "https://www.gravatar.com/avatar/cfda5cdb466b307fb347e1d7a6f72a98?s=128&d=identicon&r=PG", "display_name": "godhar", "link": "https://stackoverflow.com/users/6364117/godhar"}, "edited": false, "score": 0, "creation_date": 1488304808, "post_id": 42515501, "comment_id": 72168475, "body": "Why is it bad @rafael.cote?"}, {"owner": {"reputation": 445, "user_id": 6364117, "user_type": "registered", "accept_rate": 21, "profile_image": "https://www.gravatar.com/avatar/cfda5cdb466b307fb347e1d7a6f72a98?s=128&d=identicon&r=PG", "display_name": "godhar", "link": "https://stackoverflow.com/users/6364117/godhar"}, "edited": false, "score": 0, "creation_date": 1488304991, "post_id": 42515501, "comment_id": 72168596, "body": "Anyway I am in the hot seat, the pry lid is open and I have a returned object hash. Thanks"}, {"owner": {"reputation": 1, "user_id": 3199018, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d906341ea2bd6ce778cb173238cdc256?s=128&d=identicon&r=PG", "display_name": "rafael.cote", "link": "https://stackoverflow.com/users/3199018/rafael-cote"}, "reply_to_user": {"reputation": 445, "user_id": 6364117, "user_type": "registered", "accept_rate": 21, "profile_image": "https://www.gravatar.com/avatar/cfda5cdb466b307fb347e1d7a6f72a98?s=128&d=identicon&r=PG", "display_name": "godhar", "link": "https://stackoverflow.com/users/6364117/godhar"}, "edited": false, "score": 0, "creation_date": 1488305569, "post_id": 42515501, "comment_id": 72168898, "body": "@godhar I thought the &quot;\\n&quot; would give an error when executed, but it worked for me."}, {"owner": {"reputation": 445, "user_id": 6364117, "user_type": "registered", "accept_rate": 21, "profile_image": "https://www.gravatar.com/avatar/cfda5cdb466b307fb347e1d7a6f72a98?s=128&d=identicon&r=PG", "display_name": "godhar", "link": "https://stackoverflow.com/users/6364117/godhar"}, "edited": false, "score": 0, "creation_date": 1488307461, "post_id": 42515501, "comment_id": 72169847, "body": "yeah I basically only had it this way so I could see it in the editor. Cheers @rafael.cote"}, {"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 0, "creation_date": 1488332824, "post_id": 42515501, "comment_id": 72180378, "body": "Be more specific. <i>WHERE</i> is the comma missing? Embedded line breaks in SQL are fine. Try it in the command-line some time."}, {"owner": {"reputation": 1, "user_id": 3199018, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d906341ea2bd6ce778cb173238cdc256?s=128&d=identicon&r=PG", "display_name": "rafael.cote", "link": "https://stackoverflow.com/users/3199018/rafael-cote"}, "reply_to_user": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 0, "creation_date": 1488395363, "post_id": 42515501, "comment_id": 72215727, "body": "@theTinMan add line with problem. I am started at stackoverflow."}], "tags": [], "owner": {"reputation": 1, "user_id": 3199018, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d906341ea2bd6ce778cb173238cdc256?s=128&d=identicon&r=PG", "display_name": "rafael.cote", "link": "https://stackoverflow.com/users/3199018/rafael-cote"}, "is_accepted": false, "score": 0, "last_activity_date": 1488482400, "last_edit_date": 1488482400, "creation_date": 1488304055, "answer_id": 42515501, "question_id": 42514451, "link": "https://stackoverflow.com/questions/42514451/how-to-insert-into-postgres-table-with-the-pg-gem/42515501#42515501", "title": "How to insert into Postgres table with the PG gem", "body": "<p>The problem is a missing comma at the end the line in the SQL:</p>\n\n<pre><code>VALUES ('#{@product_name}', '#{@guk_name}', #{@roll_width_in}, #{@roll_length_metres}, #{@list_price}\n</code></pre>\n"}], "owner": {"reputation": 445, "user_id": 6364117, "user_type": "registered", "accept_rate": 21, "profile_image": "https://www.gravatar.com/avatar/cfda5cdb466b307fb347e1d7a6f72a98?s=128&d=identicon&r=PG", "display_name": "godhar", "link": "https://stackoverflow.com/users/6364117/godhar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1259, "favorite_count": 0, "answer_count": 2, "score": 3, "last_activity_date": 1488482400, "creation_date": 1488300770, "last_edit_date": 1488303334, "question_id": 42514451, "link": "https://stackoverflow.com/questions/42514451/how-to-insert-into-postgres-table-with-the-pg-gem", "title": "How to insert into Postgres table with the PG gem", "body": "<p>I created three DB schemas with Postgres. The tables are definitely there, I used the shell with <code>\\dt</code> to see them.</p>\n\n<p>My SqlRunner is failing when trying to make an INSERT with my seeds.rb file. The terminal returns a PG::SyntaxError at or near \"11.18\". The previous line is also a float, so I don't know what's wrong. </p>\n\n<p>The model looks like:</p>\n\n<pre><code>require('pg')\nrequire('../project_giclee_db/sql_runner')\n\n\nclass Material\n\n  attr_reader :id, :product_name, :guk_name, :roll_width_in,  :roll_length_metres, :list_price, :cost_per_sqm,\n    :cost_per_sqm_with_ink, :factor_n, :sell_per_sqm, :rounded_sale_price\n\n\n  def initialize( options )\n    @id = options['id'].to_i\n    @product_name = options['product_name']\n    @guk_name = options['guk_name']\n    @roll_width_in = options['roll_width_in'].to_i\n    @roll_length_metres = options['roll_length_metres'].to_i\n    @list_price = options['list_price'].to_f\n    @cost_per_sqm = options['cost_per_sqm'].to_f\n    @cost_per_sqm_with_ink = options['cost_per_sqm_with_ink'].to_f\n    @factor_n = options['factor_n'].to_f\n    @sell_per_sqm = options['sell_per_sqm'].to_f\n    @rounded_sale_price = options['rounded_sale_price'].to_i\n\n  end\n\n\n  def save\n    sql = \"INSERT INTO materials (product_name, guk_name, roll_width_in, roll_length_metres,\n    list_price, cost_per_sqm, cost_per_sqm_with_ink, factor_n, sell_per_sqm, rounded_sale_price)\n    VALUES (#{@product_name}, #{@guk_name}, #{@roll_width_in}, #{@roll_length_metres}, #{@list_price}\n    #{@cost_per_sqm}, #{@cost_per_sqm_with_ink}, #{@factor_n}, #{@sell_per_sqm}, #{@rounded_sale_price}\n    ) RETURNING *\"\n\n    data = SqlRunner.run(sql).first\n    @id = data['id']\n  end\n\n\n  def self.delete_all\n    sql = \"DELETE FROM materials\"\n    SqlRunner.run(sql)\n  end\n\nend\n</code></pre>\n\n<p>Runner looks like:</p>\n\n<pre><code>require('pg')\n\nclass SqlRunner\n\n  def self.run(sql)\n    begin\n   db = PG.connect( {dbname: 'giclee_db', host: 'localhost'} )\n     result = db.exec(sql)\n    ensure\n    db.close\n  end\n   return result\n end\n\nend\n</code></pre>\n\n<p>Seed data looks like:</p>\n\n<pre><code>require('../models/materials')\nrequire('pry-byebug')\n\nMaterial.delete_all\n\n @material1 = Material.new( { 'product_name' =&gt; 'giclee_canvas',   'guk_name' =&gt; 'canvas',\n'roll_width_in' =&gt; 44, 'roll_length_metres' =&gt; 12, 'list_price' =&gt; 150.00,\n'cost_per_sqm' =&gt; 11.18, 'cost_per_sqm_with_ink' =&gt; 14.18, 'factor_n' =&gt; 11.00,\n'sell_per_sqm' =&gt; 156.03, 'rounded_sale_price' =&gt; 156\n} )\n\n\n@material1.save\n</code></pre>\n"}, {"tags": ["ruby", "solr", "sunspot"], "answers": [{"tags": [], "owner": {"reputation": 422, "user_id": 2156422, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a440a0e4ee4b05638865fc907bd4076?s=128&d=identicon&r=PG", "display_name": "sven.windisch", "link": "https://stackoverflow.com/users/2156422/sven-windisch"}, "is_accepted": true, "score": 1, "last_activity_date": 1488371130, "creation_date": 1488371130, "answer_id": 42531681, "question_id": 42513838, "link": "https://stackoverflow.com/questions/42513838/select-all-records-with-sunspot/42531681#42531681", "title": "Select all records with Sunspot", "body": "<p>If you really need to get all index entries at once, you can use a very large page size. The time to select all documents will not be that large, but it will cost a bit of time and space to transmit that complete dataset, obviously.</p>\n\n<p>There is one trap, though. When you hardwire your very large page size it's always possible for the index to grow larger than the page size you estimated in the first place. You can avoid this by querying the index for all documents while setting the page size to 0, parsing the <code>numFound</code> and then asking for a page sized <code>numFound + 1</code>.</p>\n"}], "owner": {"reputation": 334, "user_id": 1361039, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5fd0deec6a7c34656f2ace1827ca5c19?s=128&d=identicon&r=PG", "display_name": "henadzit", "link": "https://stackoverflow.com/users/1361039/henadzit"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 47, "favorite_count": 0, "accepted_answer_id": 42531681, "answer_count": 1, "score": 0, "last_activity_date": 1488371130, "creation_date": 1488298833, "question_id": 42513838, "link": "https://stackoverflow.com/questions/42513838/select-all-records-with-sunspot", "title": "Select all records with Sunspot", "body": "<p>Looks like Solr always paginates the results. What's the best approach to select all records at once with sunspot? I see two options</p>\n\n<ul>\n<li>set the page size to very large number</li>\n<li>use cursor-based pagination and a few requests</li>\n</ul>\n\n<p>The cursor-based pagination has its obvious drawbacks.</p>\n\n<p>Are there any potential issues with setting the page size to a large number?</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "rake", "delayed-job", "sunspot"], "answers": [{"comments": [{"owner": {"reputation": 10912, "user_id": 1681, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/dcc2d3a8038cd47219af0eebe0a8a78e?s=128&d=identicon&r=PG", "display_name": "Sixty4Bit", "link": "https://stackoverflow.com/users/1681/sixty4bit"}, "edited": false, "score": 0, "creation_date": 1488316115, "post_id": 42513660, "comment_id": 72174390, "body": "Good point about the models shouldn&#39;t care if they are in a rake or not. Normally I would agree, but in this case, we are migrating data in and don&#39;t need this one particular line to run because we will take care of it after the migration. This will only be done once. After successful deployment this code will be removed. However, we need this around in development until we actually deploy. <code>delayed_jobs = false</code> doesn&#39;t help. I am open to alternatives."}], "tags": [], "owner": {"reputation": 33085, "user_id": 2423164, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/Nxbnp.jpg?s=128&g=1", "display_name": "ndnenkov", "link": "https://stackoverflow.com/users/2423164/ndnenkov"}, "is_accepted": false, "score": 0, "last_activity_date": 1488298275, "creation_date": 1488298275, "answer_id": 42513660, "question_id": 42513330, "link": "https://stackoverflow.com/questions/42513330/do-something-in-a-rake-task-before-rails-models-are-loaded/42513660#42513660", "title": "Do something in a rake task before Rails models are loaded", "body": "<p>If your models care if you are using them from a rake task or not, you are doing something wrong. Instead you can add parameters to certain methods for example. In your specific use case, you can run jobs immediately instead. Put this at the start of your rake task:</p>\n\n<pre><code>Delayed::Worker.delay_jobs = false\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 10912, "user_id": 1681, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/dcc2d3a8038cd47219af0eebe0a8a78e?s=128&d=identicon&r=PG", "display_name": "Sixty4Bit", "link": "https://stackoverflow.com/users/1681/sixty4bit"}, "edited": false, "score": 0, "creation_date": 1488324669, "post_id": 42519205, "comment_id": 72178288, "body": "This looks like it will work! I gave it a try and seems to be working as expected. I used the ENV and it is being loaded and set before the models. Thanks!"}], "tags": [], "owner": {"reputation": 91121, "user_id": 179125, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5594142dcc49a24b1902ec8059181f8d?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan Running", "link": "https://stackoverflow.com/users/179125/jordan-running"}, "is_accepted": true, "score": 1, "last_activity_date": 1488318308, "last_edit_date": 1488318308, "creation_date": 1488317815, "answer_id": 42519205, "question_id": 42513330, "link": "https://stackoverflow.com/questions/42513330/do-something-in-a-rake-task-before-rails-models-are-loaded/42519205#42519205", "title": "Do something in a rake task before Rails models are loaded", "body": "<p>Just set something at the top of your <code>Rakefile</code>:</p>\n\n<pre><code>ENV['HELLO_RAKE'] = true\n\nrequire_relative 'config/application'\n\nRails.application.load_tasks\n</code></pre>\n\n<p>Instead of using <code>ENV</code> you could, if you wanted, set a constant, e.g. <code>HELLO_RAKE = true</code> and then check <code>defined?(HELLO_RAKE)</code>.</p>\n\n<p>An alternative is to just check if the running program is <code>rake</code>:</p>\n\n<pre><code>handle_asynchronously unless File.basename($0) == \"rake\"\n</code></pre>\n\n<p>A downside to both of these approaches is that they will be in effect any time you're using Rake, which will include other Rake tasks not related to migrations.</p>\n"}], "owner": {"reputation": 10912, "user_id": 1681, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/dcc2d3a8038cd47219af0eebe0a8a78e?s=128&d=identicon&r=PG", "display_name": "Sixty4Bit", "link": "https://stackoverflow.com/users/1681/sixty4bit"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 343, "favorite_count": 0, "accepted_answer_id": 42519205, "answer_count": 2, "score": 0, "last_activity_date": 1488318308, "creation_date": 1488297377, "last_edit_date": 1488317324, "question_id": 42513330, "link": "https://stackoverflow.com/questions/42513330/do-something-in-a-rake-task-before-rails-models-are-loaded", "title": "Do something in a rake task before Rails models are loaded", "body": "<p>I have a rake task that works with models. But I need to tell the models that they are being used from Rake instead of within the app. My best idea is to set an environment variable on the command line before running the rake task, but that requires everyone on the team to remember to use the environment variable. Specifically, I have an if statement to skip loading <code>Delayed::Job</code>'s <code>handle_asynchronously</code> while running the rake task.</p>\n\n<pre><code>class Thing &lt; ActiveRecord::Base\n  searchable do\n    string :title\n    text :title, :content\n  end\n  handle_asynchronously unless ENV['MIGRATINGDATA']\nend\n</code></pre>\n\n<p>When we run our migration task we do this:</p>\n\n<p><code>MIGRATINGDATA=true bundle exec rake project:migrate_data</code></p>\n\n<p>I'd like to get rid of the need for the special addition to the command line. Our migration code loads a fake Sunspot instance to turn off indexing while migrating the data. </p>\n"}, {"tags": ["ruby", "parsing", "case-when"], "answers": [{"comments": [{"owner": {"reputation": 63, "user_id": 7160598, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/436456193df6d6abf5e7becc05a94c42?s=128&d=identicon&r=PG&f=1", "display_name": "Misha1991", "link": "https://stackoverflow.com/users/7160598/misha1991"}, "edited": false, "score": 0, "creation_date": 1488336849, "post_id": 42513607, "comment_id": 72181377, "body": "Thank you for your solution!"}], "tags": [], "owner": {"reputation": 91121, "user_id": 179125, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5594142dcc49a24b1902ec8059181f8d?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan Running", "link": "https://stackoverflow.com/users/179125/jordan-running"}, "is_accepted": true, "score": 0, "last_activity_date": 1488298129, "creation_date": 1488298129, "answer_id": 42513607, "question_id": 42513224, "link": "https://stackoverflow.com/questions/42513224/multi-level-parsing-text/42513607#42513607", "title": "Multi-level parsing text", "body": "<p>The variables declared inside the <code>each</code> block do not persist between iterations. When the iteration ends, those variables disappear, which is why you're losing the previous <code>sub</code> value. To fix it, move the <code>sub</code> variable to the outer scope by initializing it before the <code>each</code>, just like you have with <code>current_head</code>:</p>\n\n<pre><code>current_head = \"\"\ncurrent_sub = \"\"\nres = []\n\nlines.each do |line|\n  case line\n  when /Head \\d+/\n    current_head = line\n  when /Subhead/\n    current_sub = line\n  when /\\w{1} 88/\n  num = line\n    res &lt;&lt; \"#{current_head}, #{current_sub}, #{num}\"\n  end\nend\n</code></pre>\n\n<p>See it on repl.it: <a href=\"https://repl.it/GBKn\" rel=\"nofollow noreferrer\">https://repl.it/GBKn</a></p>\n"}, {"comments": [{"owner": {"reputation": 63, "user_id": 7160598, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/436456193df6d6abf5e7becc05a94c42?s=128&d=identicon&r=PG&f=1", "display_name": "Misha1991", "link": "https://stackoverflow.com/users/7160598/misha1991"}, "edited": false, "score": 0, "creation_date": 1488336697, "post_id": 42516545, "comment_id": 72181328, "body": "Thank you for your solution! foreach is really convenient"}], "tags": [], "owner": {"reputation": 48049, "user_id": 6419007, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/CwqtX.jpg?s=128&g=1", "display_name": "Eric Duminil", "link": "https://stackoverflow.com/users/6419007/eric-duminil"}, "is_accepted": false, "score": 0, "last_activity_date": 1488307850, "creation_date": 1488307850, "answer_id": 42516545, "question_id": 42513224, "link": "https://stackoverflow.com/questions/42513224/multi-level-parsing-text/42516545#42516545", "title": "Multi-level parsing text", "body": "<p>If you want to keep variables between two iterations, you could use instance variables.</p>\n\n<p><code>File.foreach</code> is the recommended way of reading a file :</p>\n\n<pre><code>res = []\nFile.foreach(\"file.txt\") do |line|\n  line.chomp!\n  case line\n  when /Head \\d+/\n    @current_head = line\n  when /Sub(head|title)/\n    @sub = line\n  when /\\w 88/\n    num = line\n    res &lt;&lt; \"#{@current_head}, #{@sub}, #{num}\"\n  end\nend\nputs res\n</code></pre>\n"}], "owner": {"reputation": 63, "user_id": 7160598, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/436456193df6d6abf5e7becc05a94c42?s=128&d=identicon&r=PG&f=1", "display_name": "Misha1991", "link": "https://stackoverflow.com/users/7160598/misha1991"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 61, "favorite_count": 0, "accepted_answer_id": 42513607, "answer_count": 2, "score": 0, "last_activity_date": 1488307850, "creation_date": 1488297110, "last_edit_date": 1495541357, "question_id": 42513224, "link": "https://stackoverflow.com/questions/42513224/multi-level-parsing-text", "title": "Multi-level parsing text", "body": "<p>The last time I had a problem:\n<a href=\"https://stackoverflow.com/questions/40604745/parsing-and-structuring-of-a-text-file\">Parsing and structuring of a text file</a>\nNow I imagine complicated conditions.\nFor example. I had a text file with next contain:</p>\n\n<pre><code>Head 1\nSubhead 1\na 10\nb 14\nc 88\nSubhead 2\na 15\nb 16\nc 17\nd 88\nSubhead 3\na 55\nb 36\nc 87\nHead 4\nSubhead 1\nr 32\nt 55\ns 79\nr 22\nt 88\ny 53\no 78\np 90\nm 44\nHead 53\nSubtitle 1\ny 22\nb 33\nSubtitle 2\na 88\ng 43\nr 87\nHead 33\nSubhead 1 \nz 11\nd 66\nv 88\nb 69\nHead 32\nSubhead 1\nn 88\nm 89\nb 88\nSubhead 2\nb 88\nm 43\n</code></pre>\n\n<p>Now I need structure text to next plane. I want to get next data:</p>\n\n<pre><code>Head 1, Subhead 1, c 88\nHead 1, Subhead 2, d 88\nHead 4, Subhead 1, t 88\nHead 53, Subhead 2, a 88\nHead 33, Subhead 1, v 88\nHead 32, Subhead 1, n 88\nHead 32, Subhead 1, b 88\nHead 32, Subhead 2, b 88\n</code></pre>\n\n<p>That is, I want to get all the rows with 88 indicating the head and subhead.</p>\n\n<p>My actions:</p>\n\n<pre><code>lines = File.open(\"file.txt\").to_a\nlines.map!(&amp;:chomp) # remove line breaks\n\ncurrent_head = \"\"\nres = []\n\nlines.each do |line|\n  case line\n  when /Head \\d+/\n    current_head = line\n  when /Subhead/\n    sub = line\n  when /\\w{1} 88/\n  num = line\n    res &lt;&lt; \"#{current_head}, #{sub}, #{num}\"\n  end\nend\n\nputs res\n</code></pre>\n\n<p>When I use this method I get a string without NUM values.</p>\n\n<p>Whether to perform my task means \"case when\" possible?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "authentication"], "answers": [{"tags": [], "owner": {"reputation": 10214, "user_id": 1591, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6e0a92aa779bf439fe972b2b9b46a289?s=128&d=identicon&r=PG", "display_name": "Jim Deville", "link": "https://stackoverflow.com/users/1591/jim-deville"}, "is_accepted": true, "score": 4, "last_activity_date": 1488296505, "creation_date": 1488296505, "answer_id": 42512990, "question_id": 42512932, "link": "https://stackoverflow.com/questions/42512932/how-to-block-access-to-public-assets-from-url-in-ruby-on-rails/42512990#42512990", "title": "How to block access to public/assets from url in Ruby On Rails", "body": "<p>If you need them to be blocked, then it's better to move them to a different folder. The intention of that folder is to hold publicly accessible static files.</p>\n"}], "owner": {"reputation": 900, "user_id": 6060650, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/tIFN7.jpg?s=128&g=1", "display_name": "Hicham Zouarhi", "link": "https://stackoverflow.com/users/6060650/hicham-zouarhi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 222, "favorite_count": 0, "accepted_answer_id": 42512990, "answer_count": 1, "score": 0, "last_activity_date": 1488296505, "creation_date": 1488296361, "question_id": 42512932, "link": "https://stackoverflow.com/questions/42512932/how-to-block-access-to-public-assets-from-url-in-ruby-on-rails", "title": "How to block access to public/assets from url in Ruby On Rails", "body": "<p>I'm working on a Ruby On Rails app and I'm calling some js, css, images and csv files from public/assets.</p>\n\n<p>I added an authentication when accessing the page using these assets:</p>\n\n<pre><code>class MyPageController &lt; ApplicationController\n    before_action :authenticate\n\n    def index\n    end\n\n    def authenticate\n        authenticate_or_request_with_http_basic do |username, password|\n            username == 'login' &amp;&amp; password == 'password'\n        end\n    end\nend\n</code></pre>\n\n<p>and it works for this page but if I type <code>localhost:3000/assets/myFile.csv</code> I can access it and download it without being asked for authentication. </p>\n\n<p>Is there a way to add an authentication on that url or to block it ?</p>\n\n<p>Thanks </p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "answers": [{"comments": [{"owner": {"reputation": 9125, "user_id": 671422, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/85da2a1fa3e4017815ff5d3a3d70fabe?s=128&d=identicon&r=PG", "display_name": "Yule", "link": "https://stackoverflow.com/users/671422/yule"}, "edited": false, "score": 0, "creation_date": 1488302296, "post_id": 42512442, "comment_id": 72167090, "body": "Out of interest, how does <code>pagetitle=(&quot;some string&quot;)</code> behave?"}, {"owner": {"reputation": 47232, "user_id": 1772830, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/Qtoqg.jpg?s=128&g=1", "display_name": "Andrey Deineko", "link": "https://stackoverflow.com/users/1772830/andrey-deineko"}, "reply_to_user": {"reputation": 9125, "user_id": 671422, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/85da2a1fa3e4017815ff5d3a3d70fabe?s=128&d=identicon&r=PG", "display_name": "Yule", "link": "https://stackoverflow.com/users/671422/yule"}, "edited": false, "score": 0, "creation_date": 1488302377, "post_id": 42512442, "comment_id": 72167143, "body": "@Yule it is the same as <code>pagetitle=&quot;some string&quot;</code>, if that&#39;s what you&#39;re asking about"}, {"owner": {"reputation": 9125, "user_id": 671422, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/85da2a1fa3e4017815ff5d3a3d70fabe?s=128&d=identicon&r=PG", "display_name": "Yule", "link": "https://stackoverflow.com/users/671422/yule"}, "edited": false, "score": 0, "creation_date": 1488302793, "post_id": 42512442, "comment_id": 72167375, "body": "yep, that&#39;s all. Thanks."}, {"owner": {"reputation": 47232, "user_id": 1772830, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/Qtoqg.jpg?s=128&g=1", "display_name": "Andrey Deineko", "link": "https://stackoverflow.com/users/1772830/andrey-deineko"}, "reply_to_user": {"reputation": 9125, "user_id": 671422, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/85da2a1fa3e4017815ff5d3a3d70fabe?s=128&d=identicon&r=PG", "display_name": "Yule", "link": "https://stackoverflow.com/users/671422/yule"}, "edited": false, "score": 0, "creation_date": 1488302844, "post_id": 42512442, "comment_id": 72167408, "body": "@Yule no probs :)"}], "tags": [], "owner": {"reputation": 47232, "user_id": 1772830, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/Qtoqg.jpg?s=128&g=1", "display_name": "Andrey Deineko", "link": "https://stackoverflow.com/users/1772830/andrey-deineko"}, "is_accepted": true, "score": 4, "last_activity_date": 1488294923, "creation_date": 1488294923, "answer_id": 42512442, "question_id": 42512420, "link": "https://stackoverflow.com/questions/42512420/controller-setting-a-local-variable-instead-of-calling-setter/42512442#42512442", "title": "Controller setting a local variable instead of calling setter", "body": "<p>Yes, this is the intended behavior.</p>\n\n<p>You use <code>self.</code> to write the instance variable, otherwise Ruby just creates local variable.</p>\n"}], "owner": {"reputation": 3527, "user_id": 839049, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/32f0ff22cffa08484efbd119f460d101?s=128&d=identicon&r=PG", "display_name": "Nicos Karalis", "link": "https://stackoverflow.com/users/839049/nicos-karalis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 78, "favorite_count": 0, "accepted_answer_id": 42512442, "answer_count": 1, "score": 1, "last_activity_date": 1488294923, "creation_date": 1488294868, "question_id": 42512420, "link": "https://stackoverflow.com/questions/42512420/controller-setting-a-local-variable-instead-of-calling-setter", "title": "Controller setting a local variable instead of calling setter", "body": "<p>In my application, I have a method called <code>pagetitle=</code> which sets the page title and the helper method <code>pagetitle</code> which creates the page title based on the string provided (or absent).</p>\n\n<p>The <code>pagetitle=</code> is defined on the <code>ApplicationController</code> super class and the <code>pagetitle</code> is defined in the <code>ApplicationHelper</code> class.</p>\n\n<p>My problem is that whenever I call <code>pagetitle = \"Some string\"</code> the method is not called, rails prefers to create the local variable <code>pagetitle</code> instead of calling the method.</p>\n\n<p>If I call <code>self.pagetitle = \"Some string\"</code> then the method is called.</p>\n\n<p>Is this the intended behavior? What am I missing here?</p>\n\n<p>TL;DR: Why <code>pagetitle=</code> creates a local variable and <code>self.pagetitle=</code> calls my method</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "rails-activerecord", "view-helpers"], "comments": [{"owner": {"reputation": 483, "user_id": 7474561, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc0cb51bd61ff4715e3bec92f79f5f46?s=128&d=identicon&r=PG&f=1", "display_name": "KcUS_unico", "link": "https://stackoverflow.com/users/7474561/kcus-unico"}, "edited": false, "score": 0, "creation_date": 1488295256, "post_id": 42512367, "comment_id": 72162218, "body": "Yes, I just want to display all records as a link like with each.do |a|, =link_to a.name, a =&gt; but I want all links to be separated by an &#39;and&#39; EXCEPT the last link should not have an &#39;and&#39; after it"}], "answers": [{"comments": [{"owner": {"reputation": 483, "user_id": 7474561, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc0cb51bd61ff4715e3bec92f79f5f46?s=128&d=identicon&r=PG&f=1", "display_name": "KcUS_unico", "link": "https://stackoverflow.com/users/7474561/kcus-unico"}, "edited": false, "score": 0, "creation_date": 1488295121, "post_id": 42512421, "comment_id": 72162135, "body": "Thx. How do I prohibit that there will be an &#39;and &#39; after the last record? I mean when the .each loop ends I don&#39;t want an &#39;and &#39; at the end ... Do you understand? Thx!"}], "tags": [], "owner": {"reputation": 10214, "user_id": 1591, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6e0a92aa779bf439fe972b2b9b46a289?s=128&d=identicon&r=PG", "display_name": "Jim Deville", "link": "https://stackoverflow.com/users/1591/jim-deville"}, "is_accepted": false, "score": 0, "last_activity_date": 1488294872, "creation_date": 1488294872, "answer_id": 42512421, "question_id": 42512367, "link": "https://stackoverflow.com/questions/42512367/rails-map-method-with-link-to-helper-combined/42512421#42512421", "title": "Rails map method with link_to helper combined?", "body": "<p>The easiest way for what you are doing is to just add and after the <code>=link_to a.name, a</code>. Since you are only outputting the data in a template, and not saving it in a variable for reuse later, there is no need for a map</p>\n"}, {"comments": [{"owner": {"reputation": 483, "user_id": 7474561, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc0cb51bd61ff4715e3bec92f79f5f46?s=128&d=identicon&r=PG&f=1", "display_name": "KcUS_unico", "link": "https://stackoverflow.com/users/7474561/kcus-unico"}, "edited": false, "score": 0, "creation_date": 1488295961, "post_id": 42512730, "comment_id": 72162745, "body": "Nice! Works. I hope its not worst practice case. But your solution works very fine! Many thanks!!"}, {"owner": {"reputation": 27144, "user_id": 3857758, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/58c4295826435f049b7fc32b98c240f9?s=128&d=identicon&r=PG&f=1", "display_name": "Ursus", "link": "https://stackoverflow.com/users/3857758/ursus"}, "reply_to_user": {"reputation": 483, "user_id": 7474561, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc0cb51bd61ff4715e3bec92f79f5f46?s=128&d=identicon&r=PG&f=1", "display_name": "KcUS_unico", "link": "https://stackoverflow.com/users/7474561/kcus-unico"}, "edited": false, "score": 0, "creation_date": 1488296002, "post_id": 42512730, "comment_id": 72162774, "body": "My pleasure Sir ;)"}, {"owner": {"reputation": 27144, "user_id": 3857758, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/58c4295826435f049b7fc32b98c240f9?s=128&d=identicon&r=PG&f=1", "display_name": "Ursus", "link": "https://stackoverflow.com/users/3857758/ursus"}, "reply_to_user": {"reputation": 483, "user_id": 7474561, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc0cb51bd61ff4715e3bec92f79f5f46?s=128&d=identicon&r=PG&f=1", "display_name": "KcUS_unico", "link": "https://stackoverflow.com/users/7474561/kcus-unico"}, "edited": false, "score": 0, "creation_date": 1488296025, "post_id": 42512730, "comment_id": 72162790, "body": "Uh, sei italiano!"}, {"owner": {"reputation": 483, "user_id": 7474561, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc0cb51bd61ff4715e3bec92f79f5f46?s=128&d=identicon&r=PG&f=1", "display_name": "KcUS_unico", "link": "https://stackoverflow.com/users/7474561/kcus-unico"}, "edited": false, "score": 0, "creation_date": 1488296331, "post_id": 42512730, "comment_id": 72163026, "body": "Non sono italiano. Sono tedesco. Grazie lo stesso! ;-)"}], "tags": [], "owner": {"reputation": 27144, "user_id": 3857758, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/58c4295826435f049b7fc32b98c240f9?s=128&d=identicon&r=PG&f=1", "display_name": "Ursus", "link": "https://stackoverflow.com/users/3857758/ursus"}, "is_accepted": true, "score": 1, "last_activity_date": 1488296141, "last_edit_date": 1488296141, "creation_date": 1488295718, "answer_id": 42512730, "question_id": 42512367, "link": "https://stackoverflow.com/questions/42512367/rails-map-method-with-link-to-helper-combined/42512730#42512730", "title": "Rails map method with link_to helper combined?", "body": "<p>Try something like</p>\n\n<pre><code>= model.associations.map { |a| link_to(a.name, a) }.join(\"&amp;nbsp;and&amp;nbsp;\").html_safe\n</code></pre>\n\n<p>But, I'd divide the logic between action and view. In the action</p>\n\n<pre><code>@items = model.associations\n</code></pre>\n\n<p>In the view</p>\n\n<pre><code>= @items.map { |a| link_to(a.name, a) }.join(\"&amp;nbsp;and&amp;nbsp;\").html_safe\n</code></pre>\n"}], "owner": {"reputation": 483, "user_id": 7474561, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc0cb51bd61ff4715e3bec92f79f5f46?s=128&d=identicon&r=PG&f=1", "display_name": "KcUS_unico", "link": "https://stackoverflow.com/users/7474561/kcus-unico"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 296, "favorite_count": 0, "accepted_answer_id": 42512730, "answer_count": 2, "score": 0, "last_activity_date": 1488296141, "creation_date": 1488294734, "last_edit_date": 1488294933, "question_id": 42512367, "link": "https://stackoverflow.com/questions/42512367/rails-map-method-with-link-to-helper-combined", "title": "Rails map method with link_to helper combined?", "body": "<p>I have a model where I want all the records for the association , separated by 'and' and being displayed as a link ... So far I have a map or a link_to option in mind .... but I would like to combine both: </p>\n\n<p>My desired result is this: </p>\n\n<p><code>name</code> and <code>name2</code> and <code>name3</code> etc. each being displayed as a link. </p>\n\n<p>so </p>\n\n<p><a href=\"/name\">name...</a> and <a href=\"/name2\">name...</a></p>\n\n<p>The association works fine and gives me all entries if I do </p>\n\n<pre><code>= model.associations.map(&amp;:name).join(' and ') \n</code></pre>\n\n<p>But 'map' does not work as a link.\nIs it possible to somehow combine <code>map</code> and <code>link_to</code> ?</p>\n\n<p>For link_to I would use ..:</p>\n\n<pre><code>-model.associations.each do |a|\n  =link_to a.name, a\n</code></pre>\n\n<p>This obviously would not separate the association entries with an 'and'. \nAny tip is highly appreciated. Thanks. </p>\n"}, {"tags": ["ruby", "xpath", "rexml"], "comments": [{"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 0, "creation_date": 1488304156, "post_id": 42511659, "comment_id": 72168115, "body": "I&#39;d recommend using <a href=\"http://www.nokogiri.org\" rel=\"nofollow noreferrer\">Nokogiri</a> over REXML. While REXML comes with Ruby, Nokogiri is faster and is the defacto standard. It also supports using CSS selectors in addition to XPath, letting you choose whichever works better for a particular lookup."}], "answers": [{"tags": [], "owner": {"reputation": 46893, "user_id": 4549554, "user_type": "registered", "accept_rate": 59, "profile_image": "https://i.stack.imgur.com/Vxi1i.jpg?s=128&g=1", "display_name": "Andersson", "link": "https://stackoverflow.com/users/4549554/andersson"}, "is_accepted": false, "score": 0, "last_activity_date": 1488293934, "creation_date": 1488293934, "answer_id": 42512073, "question_id": 42511659, "link": "https://stackoverflow.com/questions/42511659/how-to-get-tags-that-dont-have-specific-ancestor-and-descendant-using-rexml/42512073#42512073", "title": "How to get tags that don&#39;t have specific ancestor and descendant using REXML", "body": "<p>Try to use below <code>XPath</code> expression:</p>\n\n<pre><code>//*[self::A[not(./B) and not(./parent::B)] or self::B]\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>'&lt;A&gt;abc&lt;/A&gt;'\n'&lt;B&gt;def\n    &lt;A&gt;foo&lt;/A&gt;\n    &lt;A&gt;hoge&lt;/A&gt;\n    &lt;A&gt;bar&lt;/A&gt;\n  &lt;/B&gt;'\n</code></pre>\n\n<p><code>self::A[not(./B) and not(./parent::B)]</code> means <code>A</code> that has no direct child or parent <code>B</code> element</p>\n"}], "owner": {"reputation": 9, "user_id": 7504322, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fb3293ad2dc887f07d51468017a41892?s=128&d=identicon&r=PG&f=1", "display_name": "user19701", "link": "https://stackoverflow.com/users/7504322/user19701"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 31, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1488304305, "creation_date": 1488292894, "last_edit_date": 1488304305, "question_id": 42511659, "link": "https://stackoverflow.com/questions/42511659/how-to-get-tags-that-dont-have-specific-ancestor-and-descendant-using-rexml", "title": "How to get tags that don&#39;t have specific ancestor and descendant using REXML", "body": "<p>I'd like to get A tags and the B tag from the following XML, but I want to remove the second A tag:</p>\n\n<pre><code>......many other tags.\n&lt;A&gt;abc&lt;/A&gt;\n&lt;A&gt;   &lt;&lt;==== I want to remove this A tag from result.\n  &lt;B&gt;def\n    &lt;A&gt;foo&lt;/A&gt;\n    &lt;A&gt;hoge&lt;/A&gt;\n    &lt;A&gt;bar&lt;/A&gt;\n  &lt;/B&gt;\n &lt;/A&gt;\n .......\n</code></pre>\n\n<p>I'm using this XPath:</p>\n\n<pre><code>//*[self::A[not(descendant::B) or self::B]]\n</code></pre>\n\n<p>However this XPath gets the inside A tags of B tag twice:</p>\n\n<pre><code> &lt;A&gt;abc&lt;/A&gt;\n   &lt;B&gt;def\n      &lt;A&gt;foo&lt;/A&gt;\n      &lt;A&gt;hoge&lt;/A&gt;\n      &lt;A&gt;bar&lt;/A&gt;\n   &lt;/B&gt;\n   &lt;A&gt;foo&lt;/A&gt;\n   &lt;A&gt;hoge&lt;/A&gt;\n   &lt;A&gt;bar&lt;/A&gt;\n</code></pre>\n\n<p>then, I wrote this Xpath, but it doesn't work:</p>\n\n<pre><code>//*[self::A[not(descendant::B or ancestor::B) or self::B]]\n</code></pre>\n\n<p>I want to get this result:</p>\n\n<pre><code> &lt;A&gt;abc&lt;/A&gt;\n   &lt;B&gt;def\n      &lt;A&gt;foo&lt;/A&gt;\n      &lt;A&gt;hoge&lt;/A&gt;\n      &lt;A&gt;bar&lt;/A&gt;\n   &lt;/B&gt;\n\n .......\n</code></pre>\n\n<p>How can I solve this?</p>\n"}, {"tags": ["sql", "ruby-on-rails", "ruby", "postgresql", "datetime"], "comments": [{"owner": {"reputation": 46235, "user_id": 3431869, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16b2315fa60f613de9565af031264f31?s=128&d=identicon&r=PG&f=1", "display_name": "Vamsi Prabhala", "link": "https://stackoverflow.com/users/3431869/vamsi-prabhala"}, "edited": false, "score": 1, "creation_date": 1488292938, "post_id": 42511632, "comment_id": 72160374, "body": "can you show the expected output as well?"}, {"owner": {"reputation": 2623, "user_id": 5739514, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/79f8410055f0114c31bde3ccc1d56178?s=128&d=identicon&r=PG", "display_name": "HashRocketSyntax", "link": "https://stackoverflow.com/users/5739514/hashrocketsyntax"}, "reply_to_user": {"reputation": 46235, "user_id": 3431869, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16b2315fa60f613de9565af031264f31?s=128&d=identicon&r=PG&f=1", "display_name": "Vamsi Prabhala", "link": "https://stackoverflow.com/users/3431869/vamsi-prabhala"}, "edited": false, "score": 0, "creation_date": 1488293538, "post_id": 42511632, "comment_id": 72160886, "body": "thank you. updated to show the expected."}], "answers": [{"tags": [], "owner": {"reputation": 46235, "user_id": 3431869, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16b2315fa60f613de9565af031264f31?s=128&d=identicon&r=PG&f=1", "display_name": "Vamsi Prabhala", "link": "https://stackoverflow.com/users/3431869/vamsi-prabhala"}, "is_accepted": false, "score": 1, "last_activity_date": 1488293243, "creation_date": 1488293243, "answer_id": 42511794, "question_id": 42511632, "link": "https://stackoverflow.com/questions/42511632/subtracting-two-rows-based-on-created-at-condition-in-rails/42511794#42511794", "title": "Subtracting two rows based on created_at: condition in Rails", "body": "<p>Assuming there are no null values in the count column, you can use <code>lag</code> to get the value on the previous row and subtract it from the current row's value to get the delta. For the first row of each group (ordered by created_at), the difference will be <code>null</code>. (You can use the default value of <code>0</code> if needed in <code>lag</code>)</p>\n\n<pre><code>select org,created_at,\ncumulative_donations_count - lag(cumulative_donations_count) over(partition by org order by created_at) as delta_from_prev_day\nfrom yourtable\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 2623, "user_id": 5739514, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/79f8410055f0114c31bde3ccc1d56178?s=128&d=identicon&r=PG", "display_name": "HashRocketSyntax", "link": "https://stackoverflow.com/users/5739514/hashrocketsyntax"}, "edited": false, "score": 0, "creation_date": 1488305551, "post_id": 42511796, "comment_id": 72168890, "body": "Thank you!  <code>lag(cumulative_donations_count, 1) over (partition by org_id ... where org_id = #{org_id};&quot;</code> got this to work in a way that I could dynamically account for different id&#39;s and the base case"}], "tags": [], "owner": {"reputation": 1106495, "user_id": 1144035, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e514b017977ebf742a418cac697d8996?s=128&d=identicon&r=PG", "display_name": "Gordon Linoff", "link": "https://stackoverflow.com/users/1144035/gordon-linoff"}, "is_accepted": true, "score": 2, "last_activity_date": 1488293253, "creation_date": 1488293253, "answer_id": 42511796, "question_id": 42511632, "link": "https://stackoverflow.com/questions/42511632/subtracting-two-rows-based-on-created-at-condition-in-rails/42511796#42511796", "title": "Subtracting two rows based on created_at: condition in Rails", "body": "<p>If I understand correctly, then you would use <code>lag()</code> in SQL:</p>\n\n<pre><code>select org, cumulative_donations_count, created_at,\n       (cumulative_donations_count - \n        lag(cumulative_donations_count, 1, 0) over (partition by GoodWill order by created_at)\n       ) as inc\nfrom t;\n</code></pre>\n\n<p>This uses the <a href=\"https://www.postgresql.org/docs/current/static/functions-window.html\" rel=\"nofollow noreferrer\">3-arg form</a> of <code>lag()</code>.  The second argument is the number of records to go back.  The third is the value for the first record (when there are no preceding records).</p>\n"}], "owner": {"reputation": 2623, "user_id": 5739514, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/79f8410055f0114c31bde3ccc1d56178?s=128&d=identicon&r=PG", "display_name": "HashRocketSyntax", "link": "https://stackoverflow.com/users/5739514/hashrocketsyntax"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 166, "favorite_count": 0, "accepted_answer_id": 42511796, "answer_count": 2, "score": 0, "last_activity_date": 1488293348, "creation_date": 1488292833, "last_edit_date": 1488293348, "question_id": 42511632, "link": "https://stackoverflow.com/questions/42511632/subtracting-two-rows-based-on-created-at-condition-in-rails", "title": "Subtracting two rows based on created_at: condition in Rails", "body": "<p>I currently have a graph that shows a cumulative total by day, but what I am really after is that day's marginal increase aka delta. How can this be done by query? Unfortunately, cumulative total is all that is available by API.</p>\n\n<p>Here is my table:</p>\n\n<pre><code>org:          cumulative_donations_count:    created_at:\nGoodwill      650                            2017-02-28 18:50:20.654996\nGoodwill      300                            2017-02-27 18:50:20.654996\nGoodwill      250                            2017-02-26 18:50:20.654996\nGoodwill      100                            2017-02-25 18:50:20.654996\n</code></pre>\n\n<p><em>Steps Taken</em> -- I started to iterate over a <code>self.where(org: goodwill).pluck(created_at:, donations_count:)</code> array by |date, value| in an attempt to compare the dates by their respective index value in the array, but our lead engineer wants it done purely by query. I also thought about adding a column to show the difference, but we want to run many different calculations on these values.</p>\n\n<p>There is a base case of <code>if &lt;= 1</code> for the number of records an org needs in order to be compared which should return nil. Obviously, the created_at: value will not be exactly 1 day behind in milliseconds.</p>\n\n<p>Arguably, there are similar questions to this, but the conditions of this example are simple enough to be useful to many readers.</p>\n\n<p><em>UPDATE</em> -- expected output</p>\n\n<p><code>[[2017-02-28, 350],[2017-02-27, 50], [2017-02-26, 150], [2017-02-25, nil]]</code></p>\n"}, {"tags": ["ruby-on-rails", "ruby", "rspec", "generator"], "comments": [{"owner": {"reputation": 14010, "user_id": 3109182, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/a4b305f0077055b4fdcf715067775d5a?s=128&d=identicon&r=PG", "display_name": "Anthony", "link": "https://stackoverflow.com/users/3109182/anthony"}, "edited": false, "score": 0, "creation_date": 1488292246, "post_id": 42511335, "comment_id": 72159898, "body": "You should be unit testing these and if you&#39;re just using <code>thor</code> like rails is, then there isn&#39;t a ton to do.  Show us a snip of your generator and I can show you."}, {"owner": {"reputation": 2315, "user_id": 1428109, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/VBHeU.jpg?s=128&g=1", "display_name": "deny7ko", "link": "https://stackoverflow.com/users/1428109/deny7ko"}, "reply_to_user": {"reputation": 14010, "user_id": 3109182, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/a4b305f0077055b4fdcf715067775d5a?s=128&d=identicon&r=PG", "display_name": "Anthony", "link": "https://stackoverflow.com/users/3109182/anthony"}, "edited": false, "score": 0, "creation_date": 1488292527, "post_id": 42511335, "comment_id": 72160099, "body": "@Anthony snippet is here - <a href=\"https://gist.github.com/denysmedynskyi/53bd5e87c9345a592e7dcf0131991236\" rel=\"nofollow noreferrer\">gist.github.com/denysmedynskyi/53bd5e87c9345a592e7dcf0131991&zwnj;&#8203;236</a>"}], "owner": {"reputation": 2315, "user_id": 1428109, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/VBHeU.jpg?s=128&g=1", "display_name": "deny7ko", "link": "https://stackoverflow.com/users/1428109/deny7ko"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 59, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1488292028, "creation_date": 1488292028, "question_id": 42511335, "link": "https://stackoverflow.com/questions/42511335/how-to-test-own-rails-generator", "title": "How to test own rails generator?", "body": "<p>I have written my generator and want to test it.</p>\n\n<p>What I tried:</p>\n\n<ul>\n<li><p>outdated gem, last update was in 2014 - <a href=\"https://github.com/stevehodgkiss/generator_spec\" rel=\"nofollow noreferrer\">https://github.com/stevehodgkiss/generator_spec</a></p></li>\n<li><p>write my own spec, but it seems generator is not run it test environment( <a href=\"https://gist.github.com/denysmedynskyi/53bd5e87c9345a592e7dcf0131991236\" rel=\"nofollow noreferrer\">generator</a>, <a href=\"https://gist.github.com/denysmedynskyi/70b1aca515a6af81bebe54c479cea706\" rel=\"nofollow noreferrer\">spec</a> ) It fails with error <code>No such file or directory @ rb_sysopen - app/pages/denys.rb</code></p></li>\n</ul>\n"}, {"tags": ["ruby-on-rails", "ruby", "routing", "rails-routing"], "comments": [{"owner": {"reputation": 1, "user_id": 7344636, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cc0c9d45aa9690a27ca89016c848e3ea?s=128&d=identicon&r=PG&f=1", "display_name": "Yoda", "link": "https://stackoverflow.com/users/7344636/yoda"}, "edited": false, "score": 0, "creation_date": 1488290705, "post_id": 42510769, "comment_id": 72158884, "body": "rails -v 4.1.10; ruby -v 2.1.5p273"}, {"owner": {"reputation": 2230, "user_id": 6337957, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c1177d893bf3115edf0119cf56e7220?s=128&d=identicon&r=PG", "display_name": "Greg Navis", "link": "https://stackoverflow.com/users/6337957/greg-navis"}, "edited": false, "score": 1, "creation_date": 1488290713, "post_id": 42510769, "comment_id": 72158892, "body": "The first error reads <code>{:action=&gt;&quot;&#47;&quot;, :controller=&gt;&quot;static_pages&quot;}</code>. Notice the action (i.e. the <i>method</i> defined in the controller) is <code>&#47;</code>. It seems your actions are named <code>home</code> and <code>help</code>. We&#39;ll be able to tell you more if you post your tests."}, {"owner": {"reputation": 346, "user_id": 2457435, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d998a18446f06a200a4e66460a82f6d1?s=128&d=identicon&r=PG", "display_name": "01010011 01000010", "link": "https://stackoverflow.com/users/2457435/01010011-01000010"}, "edited": false, "score": 0, "creation_date": 1488293941, "post_id": 42510769, "comment_id": 72161209, "body": "Are you able to go to the routes outside of the test? If you go to localhost:3000 do you get an error or does the page show up?"}, {"owner": {"reputation": 1, "user_id": 7344636, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cc0c9d45aa9690a27ca89016c848e3ea?s=128&d=identicon&r=PG&f=1", "display_name": "Yoda", "link": "https://stackoverflow.com/users/7344636/yoda"}, "edited": false, "score": 0, "creation_date": 1488294268, "post_id": 42510769, "comment_id": 72161465, "body": "the page works fine, the only thing is just the test fails"}, {"owner": {"reputation": 3307, "user_id": 2266827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/Frcc8.png?s=128&g=1", "display_name": "jeffdill2", "link": "https://stackoverflow.com/users/2266827/jeffdill2"}, "edited": false, "score": 0, "creation_date": 1488307011, "post_id": 42510769, "comment_id": 72169616, "body": "Please run <code>rake routes</code> in a terminal window and add the output to your question."}, {"owner": {"reputation": 1302, "user_id": 1368977, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c79672007d59af69a05f2b5f6929b53f?s=128&d=identicon&r=PG", "display_name": "Marc Rohloff", "link": "https://stackoverflow.com/users/1368977/marc-rohloff"}, "edited": false, "score": 0, "creation_date": 1488333901, "post_id": 42510769, "comment_id": 72180644, "body": "I believe that syntax changed with Rails 5. If you are using Rails 4 you need to use the old syntax: <code>get :home</code> and <code>get :help</code>"}, {"owner": {"reputation": 1, "user_id": 7344636, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cc0c9d45aa9690a27ca89016c848e3ea?s=128&d=identicon&r=PG&f=1", "display_name": "Yoda", "link": "https://stackoverflow.com/users/7344636/yoda"}, "edited": false, "score": 0, "creation_date": 1488450872, "post_id": 42510769, "comment_id": 72240793, "body": "yea...  after i change to :home &amp; :help.. the problem is solved. Thanks :)"}], "owner": {"reputation": 1, "user_id": 7344636, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cc0c9d45aa9690a27ca89016c848e3ea?s=128&d=identicon&r=PG&f=1", "display_name": "Yoda", "link": "https://stackoverflow.com/users/7344636/yoda"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 643, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1488307145, "creation_date": 1488290459, "last_edit_date": 1488307145, "question_id": 42510769, "link": "https://stackoverflow.com/questions/42510769/routing-error-no-route-matches-action-controller-static-pages", "title": "Routing error No route matches {:action=&gt;&quot;/&quot;, :controller=&gt;&quot;static_pages&quot;}", "body": "<p>i'm a ROR newbie who is going through the tutorial by Micheal Hartl. I have follow every steps of the tutorial and i'm stuck with the error regarding the routes. I have gone through all my codes and tried all the solution from google. Long story short i'm trying to get the test pass.</p>\n\n<p>Here is my routes.rb</p>\n\n<pre><code>Rails.application.routes.draw do\nroot 'static_pages#home'\nget '/help', to: 'static_pages#help'\nend`\n</code></pre>\n\n<p>Here is the error description</p>\n\n<blockquote>\n  <p>1)Error <br> StaticPagesControllerTest#test_should_get_home:\n  ActionController::UrlGenerationError: No route matches {:action=>\"/\", :controller=>\"static_pages\"} test/controllers/static_pages_controller_test.rb:10: in block in class:StaticPagesControllerTest'\n  <br> 2) Error <br> StaticPagesControllerTest#test_should_get_help:\n  ActionController::UrlGenerationError: No route matches {:action=>\"/help\", :controller=>\"static_pages\"}\n  test/controllers/static_pages_controller_test.rb:16:in `block in class:StaticPagesControllerTest'</p>\n</blockquote>\n\n<p>Here is how my rake routes looks like</p>\n\n<blockquote>\n  <p><br>root GET  /                  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;static_pages#home\n  <br>help GET  /help(.:format)&nbsp;&nbsp;&nbsp;&nbsp;    static_pages#help\n  <br>about GET  /about(.:format)&nbsp;&nbsp;&nbsp;&nbsp;   static_pages#about\n  <br>contact GET  /contact(.:format)&nbsp;&nbsp;&nbsp;&nbsp; static_pages#contact</p>\n</blockquote>\n\n<p>I have tried </p>\n\n<pre><code>root 'static_pages#home'\nget '/static_pages/help', to: 'static_pages#help'\n</code></pre>\n\n<p>or</p>\n\n<pre><code>root 'static_pages#home'\nmatch '/help',    :to =&gt; 'static_pages#help', via: [:get]\n</code></pre>\n\n<p>yet i still cannot solve the problem. I have been staring at this code and error for days. Please help.</p>\n\n<p>*Edit to include test</p>\n\n<pre><code>test \"should get home\" do\n  get root_path\n  assert_response :success\n  assert_select \"title\", \"Home | #{@base_title}\"\nend\n\ntest \"should get help\" do\n  get help_path\n  assert_response :success\n  assert_select \"title\", \"Help | #{@base_title}\"\nend\n</code></pre>\n"}, {"tags": ["ruby", "variable-assignment"], "answers": [{"comments": [{"owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 1, "creation_date": 1488289821, "post_id": 42510010, "comment_id": 72158234, "body": "For multiple values, <code>*</code> is enough. Or, to be explicit about the number of variables being thrown out, <code>_</code> has a special syntax such that it can be repeated in assignment. <code>x, _, _, _, z = [1, 2, 3, 4, 5]</code>."}, {"owner": {"reputation": 33085, "user_id": 2423164, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/Nxbnp.jpg?s=128&g=1", "display_name": "ndnenkov", "link": "https://stackoverflow.com/users/2423164/ndnenkov"}, "reply_to_user": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 0, "creation_date": 1488290268, "post_id": 42510010, "comment_id": 72158561, "body": "@sawa, good point on the single <code>*</code>. I will not edit my answer so that I don&#39;t obsolete AKovtunov&#39;s. As for the multiple <code>_</code>s - it depends more on what you are trying to say IMO. Are you trying to say that <code>z</code> is the last element or the 5th element?"}, {"owner": {"reputation": 48049, "user_id": 6419007, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/CwqtX.jpg?s=128&g=1", "display_name": "Eric Duminil", "link": "https://stackoverflow.com/users/6419007/eric-duminil"}, "reply_to_user": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 1, "creation_date": 1488290622, "post_id": 42510010, "comment_id": 72158816, "body": "@sawa: There&#39;s nothing special about <code>_</code> AFAIK. <code>x, y, y, y, z = [1, 2, 3, 4, 5]</code> is a valid but confusing syntax. <code>y</code> is set to <code>4</code>"}, {"owner": {"reputation": 33085, "user_id": 2423164, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/Nxbnp.jpg?s=128&g=1", "display_name": "ndnenkov", "link": "https://stackoverflow.com/users/2423164/ndnenkov"}, "reply_to_user": {"reputation": 48049, "user_id": 6419007, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/CwqtX.jpg?s=128&g=1", "display_name": "Eric Duminil", "link": "https://stackoverflow.com/users/6419007/eric-duminil"}, "edited": false, "score": 0, "creation_date": 1488290709, "post_id": 42510010, "comment_id": 72158889, "body": "@EricDuminil, underscored names are a little bit special. You can&#39;t define a method with repeating parameter names, unless they start with <code>_</code>. Same goes for block parameters. But indeed, not in this case."}, {"owner": {"reputation": 48049, "user_id": 6419007, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/CwqtX.jpg?s=128&g=1", "display_name": "Eric Duminil", "link": "https://stackoverflow.com/users/6419007/eric-duminil"}, "edited": false, "score": 1, "creation_date": 1488290939, "post_id": 42510010, "comment_id": 72159047, "body": "It&#39;s interesting to see how duplicate questions often bring many upvotes. I&#39;ve had a nice answer badge for &quot;3/2 is 1, not 1.5&quot; :). Anyway, you&#39;ll soon get your Ruby golden badge. ;)"}, {"owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "reply_to_user": {"reputation": 48049, "user_id": 6419007, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/CwqtX.jpg?s=128&g=1", "display_name": "Eric Duminil", "link": "https://stackoverflow.com/users/6419007/eric-duminil"}, "edited": false, "score": 0, "creation_date": 1488290957, "post_id": 42510010, "comment_id": 72159060, "body": "@EricDuminil Oops. You are right. Sorry about that. My knowledge must be outdated. I remember <code>_</code> used to be the only variable allowed to do that. Perhaps they changed it at some point."}, {"owner": {"reputation": 48049, "user_id": 6419007, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/CwqtX.jpg?s=128&g=1", "display_name": "Eric Duminil", "link": "https://stackoverflow.com/users/6419007/eric-duminil"}, "reply_to_user": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 0, "creation_date": 1488291125, "post_id": 42510010, "comment_id": 72159160, "body": "@sawa: No problem, I wasn&#39;t sure either and learned something. <code>a, a = 1</code> is a confusing way to set <code>a</code> to <code>nil</code> :)"}, {"owner": {"reputation": 33085, "user_id": 2423164, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/Nxbnp.jpg?s=128&g=1", "display_name": "ndnenkov", "link": "https://stackoverflow.com/users/2423164/ndnenkov"}, "reply_to_user": {"reputation": 48049, "user_id": 6419007, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/CwqtX.jpg?s=128&g=1", "display_name": "Eric Duminil", "link": "https://stackoverflow.com/users/6419007/eric-duminil"}, "edited": false, "score": 1, "creation_date": 1488291189, "post_id": 42510010, "comment_id": 72159196, "body": "@EricDuminil, don&#39;t know about duplicate questions, but very basic ones - indeed, it&#39;s frustrating. At least in the short term, the main indicator on how many upvotes a post will get is how many people are going to read and understand it. It&#39;s one of the downfalls of SO&#39;s gamification system. :/ Thanks anyway."}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1488295314, "post_id": 42510010, "comment_id": 72162259, "body": "Variables starting with <code>_</code> (including <code>_</code> itself) don&#39;t generate a &quot;unused variable&quot; warning."}], "tags": [], "owner": {"reputation": 33085, "user_id": 2423164, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/Nxbnp.jpg?s=128&g=1", "display_name": "ndnenkov", "link": "https://stackoverflow.com/users/2423164/ndnenkov"}, "is_accepted": true, "score": 10, "last_activity_date": 1488288345, "creation_date": 1488288345, "answer_id": 42510010, "question_id": 42509986, "link": "https://stackoverflow.com/questions/42509986/drop-value-in-parallel-assignment/42510010#42510010", "title": "Drop value in parallel assignment", "body": "<p>The idiomatic way to do that is to assign it to variable named underscore:</p>\n\n<pre><code>x, _, z = [1, 2, 3]\n</code></pre>\n\n<p>If there are multiple values that you want to drop, you can use splat:</p>\n\n<pre><code>x, *_, z = [1, 2, 3, 4, 5]\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 48049, "user_id": 6419007, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/CwqtX.jpg?s=128&g=1", "display_name": "Eric Duminil", "link": "https://stackoverflow.com/users/6419007/eric-duminil"}, "is_accepted": false, "score": 2, "last_activity_date": 1488288966, "last_edit_date": 1488288966, "creation_date": 1488288620, "answer_id": 42510131, "question_id": 42509986, "link": "https://stackoverflow.com/questions/42509986/drop-value-in-parallel-assignment/42510131#42510131", "title": "Drop value in parallel assignment", "body": "<p>As mentioned by @ndn, <code>_</code> is often used.</p>\n\n<p>It's okay to ignore it and to reassign over it, but <code>_</code> is still a variable in the namespace of the current scope :</p>\n\n<pre><code>l = [1, 2, 3]\n\nx, _, z = l\nputs _\n#=&gt; 2\n</code></pre>\n\n<p>If it bothers you, you could use :</p>\n\n<pre><code>x, z = l.values_at(0,-1)\n</code></pre>\n\n<p>It might be less readable though. <code>_</code> is also the proposed syntax if you launch <code>rubocop</code> on the script.</p>\n\n<p>Talking about readability, if you want to explain what the variable is, but still want to show that it won't be used afterwards, you could use :</p>\n\n<pre><code>x, _y, z = [1, 2, 3]\n# Do something with x and z. Ignore _y\n</code></pre>\n\n<p>It's also proposed by rubocop :</p>\n\n<pre><code>test.rb:2:4: W: Useless assignment to variable - y. Use _ or _y as a variable name to indicate that it won't be used.\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 1, "creation_date": 1488289960, "post_id": 42510477, "comment_id": 72158363, "body": "<code>*</code> implies that arbitrary number of variables are assigned here as a single array. If you specifically know that there is only single term, then <code>_</code> is more specific, and hence more preferable."}, {"owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 1, "creation_date": 1488290002, "post_id": 42510477, "comment_id": 72158389, "body": "&quot;<code>_</code> [is] usually used to return [the] last value, so it can be confusing to use it here.&quot;--What is your basis for this? As far as I know, that is wrong."}, {"owner": {"reputation": 47232, "user_id": 1772830, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/Qtoqg.jpg?s=128&g=1", "display_name": "Andrey Deineko", "link": "https://stackoverflow.com/users/1772830/andrey-deineko"}, "edited": false, "score": 2, "creation_date": 1488290308, "post_id": 42510477, "comment_id": 72158597, "body": "I also would like to know where <code>_ usually used to return last value</code> comes from"}, {"owner": {"reputation": 517, "user_id": 1656464, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2f0c052c0c862fa12503177a9d861bc9?s=128&d=identicon&r=PG", "display_name": "AKovtunov", "link": "https://stackoverflow.com/users/1656464/akovtunov"}, "reply_to_user": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 0, "creation_date": 1488290349, "post_id": 42510477, "comment_id": 72158637, "body": "@sawa @andrey-deineko I can&#39;t find any good documentation for underscore variable to prove my thoughts, but discussions like this <a href=\"http://stackoverflow.com/questions/9559561/where-and-how-is-the-underscore-variable-specified\" title=\"where and how is the underscore variable specified\">stackoverflow.com/questions/9559561/&hellip;</a> (beginning of the question) shows that a lot of people use underscore as a <code>last value</code>. Also it&#39;s described as a predefined value for the last value from ruby docs <a href=\"https://ruby-doc.org/docs/ruby-doc-bundle/Manual/man-1.4/variable.html#uscore\" rel=\"nofollow noreferrer\">ruby-doc.org/docs/ruby-doc-bundle/Manual/man-1.4/&hellip;</a>"}, {"owner": {"reputation": 48049, "user_id": 6419007, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/CwqtX.jpg?s=128&g=1", "display_name": "Eric Duminil", "link": "https://stackoverflow.com/users/6419007/eric-duminil"}, "edited": false, "score": 5, "creation_date": 1488290392, "post_id": 42510477, "comment_id": 72158664, "body": "<code>_</code> means the last value in IRB and PRY. It means &quot;ignore me&quot; in every ruby script, though. You can even use <code>__</code> for second to last in PRY."}, {"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 0, "creation_date": 1488304761, "post_id": 42510477, "comment_id": 72168446, "body": "Don&#39;t confuse a command in Pry or IRB with Ruby syntax. They&#39;re very different things."}, {"owner": {"reputation": 517, "user_id": 1656464, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2f0c052c0c862fa12503177a9d861bc9?s=128&d=identicon&r=PG", "display_name": "AKovtunov", "link": "https://stackoverflow.com/users/1656464/akovtunov"}, "reply_to_user": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 0, "creation_date": 1488316335, "post_id": 42510477, "comment_id": 72174526, "body": "@theTinMan I think ruby manual covers not only Pry\\IRB <a href=\"https://ruby-doc.org/docs/ruby-doc-bundle/Manual/man-1.4/variable.html#uscore\" rel=\"nofollow noreferrer\">ruby-doc.org/docs/ruby-doc-bundle/Manual/man-1.4/&hellip;</a> :)"}, {"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 1, "creation_date": 1488332282, "post_id": 42510477, "comment_id": 72180254, "body": "You appear to be confusing <code>$_</code> and <code>_</code>. They are not the same. <code>$_</code> is a global containing the last line read from the console or when reading a file line-by-line. <code>_</code> is a &quot;slush&quot; or &quot;blackhole&quot; variable we use when we mean to throw a value away. You are arguing a point that is being contradicted by experienced Ruby programmers."}], "tags": [], "owner": {"reputation": 517, "user_id": 1656464, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2f0c052c0c862fa12503177a9d861bc9?s=128&d=identicon&r=PG", "display_name": "AKovtunov", "link": "https://stackoverflow.com/users/1656464/akovtunov"}, "is_accepted": false, "score": -2, "last_activity_date": 1488289646, "creation_date": 1488289646, "answer_id": 42510477, "question_id": 42509986, "link": "https://stackoverflow.com/questions/42509986/drop-value-in-parallel-assignment/42510477#42510477", "title": "Drop value in parallel assignment", "body": "<p>I would prefer to improve @ndn answer and use only <code>*</code> symbol to drop values. \n<code>_</code> usually used to return last value, so it can be confusing to use it here.</p>\n\n<p>So you can use</p>\n\n<pre><code>x, *, z = [1, 2, 3]\n</code></pre>\n\n<p>as well as</p>\n\n<pre><code>x, *, y, z = [1, 2, 3, 4]\n</code></pre>\n\n<p>and it will still understand you and return the proper values for all the variables.</p>\n"}, {"tags": [], "owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "is_accepted": false, "score": 0, "last_activity_date": 1488310179, "last_edit_date": 1488310179, "creation_date": 1488301136, "answer_id": 42514580, "question_id": 42509986, "link": "https://stackoverflow.com/questions/42509986/drop-value-in-parallel-assignment/42514580#42514580", "title": "Drop value in parallel assignment", "body": "<p>meschi has asked whether it is possible, using parallel assignment, to assign some, but not all, elements of an array to variables.</p>\n\n<p>Firstly, it doesn't help to write</p>\n\n<pre><code>a, _, c = [1, true, 2]\n</code></pre>\n\n<p>since <code>_</code> is a variable:</p>\n\n<pre><code>_ #=&gt; true\n</code></pre>\n\n<p>(You won't get this result using IRB as IRB uses <code>_</code> for its own purposes.)</p>\n\n<p>If, in the above array, you only want to assign <code>1</code> and <code>true</code> to variables you can write</p>\n\n<pre><code>a, b, * = [1, true, 2]\na #=&gt; 1\nb #=&gt; true\n</code></pre>\n\n<p>If you only want to assign <code>1</code> and <code>2</code> to variables, you can write</p>\n\n<pre><code>a, *, b = [1, true, 2]\na #=&gt; 1\nb #=&gt; 2\n</code></pre>\n\n<p>If, for the array <code>[1, true, 2, 3]</code>, you wish to assign only <code>1</code> and <code>2</code> to variables, well, that's a problem. Evidently, as @Eric pointed out in a comment, you'd need to write</p>\n\n<pre><code>a, b, b, * = [1, true, 2, 3]\na #=&gt; 1\nb #=&gt; 2\n</code></pre>\n\n<p>This idea can of course be generalized:</p>\n\n<pre><code>a, b, b, b, c, c = [1, true, 2, 3, 4, 5]\na #=&gt; 1\nb #=&gt; 3\nc #=&gt; 5\n</code></pre>\n\n<p>Is this a good idea? That was not the question.</p>\n\n<p>The main concern may be creating a not-to-be-used variable and then inadvertently using it, as here:</p>\n\n<pre><code>a, _, b = [1, true, 2]\n...\nlaunch_missiles_now?(_)\n</code></pre>\n\n<p>If so, there are a few options. One is to simply wrap the expression in an method, thereby keeping the superfluous variables tightly-confined:</p>\n\n<pre><code>def get_a_and_b(arr)\n  a, _, b, _ = arr\n  [a, b]\nend\n\na, b = get_a_and_b [1, true, 2, 3]\n  #=&gt; [1, 2]\n</code></pre>\n\n<p>Another is to name unwanted variables to make it unlikely that they will referenced accidentally, for example:</p>\n\n<pre><code>a, _reference_this_variable_and_you_will_die, b = [1, true, 2] \n</code></pre>\n"}], "owner": {"reputation": 71, "user_id": 4917438, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pYm2d.png?s=128&g=1", "display_name": "meschi", "link": "https://stackoverflow.com/users/4917438/meschi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 133, "favorite_count": 0, "accepted_answer_id": 42510010, "answer_count": 4, "score": 1, "last_activity_date": 1488310179, "creation_date": 1488288286, "last_edit_date": 1488290074, "question_id": 42509986, "link": "https://stackoverflow.com/questions/42509986/drop-value-in-parallel-assignment", "title": "Drop value in parallel assignment", "body": "<p>Since parallel assignment like this can be done,</p>\n\n<pre><code>x, y, z = [1, 2, 3]\n</code></pre>\n\n<p>I wanted to know if one could drop for example the <code>y</code> value. Is there a way of doing parallel assignment without polluting the namespace of the current scope?</p>\n\n<p>I tried assigning to <code>nil</code>:</p>\n\n<pre><code>x, nil, z = [1, 2, 3]\n</code></pre>\n\n<p>but that does not work.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "activerecord", "form-for", "fields-for"], "answers": [{"tags": [], "owner": {"reputation": 21, "user_id": 7635172, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d8764809fc4443195aa337146adbcb14?s=128&d=identicon&r=PG&f=1", "display_name": "t.kengo", "link": "https://stackoverflow.com/users/7635172/t-kengo"}, "is_accepted": true, "score": 0, "last_activity_date": 1489110436, "creation_date": 1489110436, "answer_id": 42708735, "question_id": 42509712, "link": "https://stackoverflow.com/questions/42509712/rails-nested-form-create-multiple-child-records/42708735#42708735", "title": "Rails: nested form, create multiple child records", "body": "<p>One simple way to solve this problem is to use the nested_form gem.\n<a href=\"https://github.com/ryanb/nested_form\" rel=\"nofollow noreferrer\">https://github.com/ryanb/nested_form</a></p>\n\n<p>If you use it, you can add or remove nested_forms just by coding like below.</p>\n\n<pre><code>&lt;%= f.fields_for :tasks do |task_form| %&gt;\n  &lt;%= task_form.text_field :name %&gt;\n  &lt;%= task_form.link_to_remove \"Remove this task\" %&gt;\n&lt;% end %&gt;\n&lt;p&gt;&lt;%= f.link_to_add \"Add a task\", :tasks %&gt;&lt;/p&gt;\n</code></pre>\n\n<p>The gem's README is quite easy to understand so you should check that as well.</p>\n\n<p>Also, if you look at the wiki the gem provides, you can know how to customize your forms as you like.</p>\n"}], "owner": {"reputation": 21, "user_id": 7635172, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d8764809fc4443195aa337146adbcb14?s=128&d=identicon&r=PG&f=1", "display_name": "t.kengo", "link": "https://stackoverflow.com/users/7635172/t-kengo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1574, "favorite_count": 1, "accepted_answer_id": 42708735, "answer_count": 1, "score": 2, "last_activity_date": 1489473924, "creation_date": 1488287598, "last_edit_date": 1495540832, "question_id": 42509712, "link": "https://stackoverflow.com/questions/42509712/rails-nested-form-create-multiple-child-records", "title": "Rails: nested form, create multiple child records", "body": "<p>I'm trying to create a Group in SNS app which has several users.\nGroup has_many Users through Groups_users.</p>\n\n<p>Here I've got a form to create a group, and I want to add members(Groups_users) to the group at the same time.\nI succeeded in adding one member to the group at the same time I create a group, but I just can't add several members to the group.</p>\n\n<p>Here's my code:</p>\n\n<p>Models:</p>\n\n<p>group.rb</p>\n\n<pre><code>class Group &lt; ApplicationRecord\n  validates :name, presence: true, uniqueness: true\n  validates :owner_user_id, presence: true\n  has_many :groups_users, inverse_of: :group\n  has_many :users, through: :groups_users\n  accepts_nested_attributes_for :groups_users\n  has_many :group_posts\nend\n</code></pre>\n\n<p>groups_user.rb</p>\n\n<pre><code>class GroupsUser &lt; ApplicationRecord\n  belongs_to :group, inverse_of: :groups_users\n  belongs_to :user\n  validates :group, presence: true\n  validates :user_id, presence: true\nend\n</code></pre>\n\n<p>Controllers:</p>\n\n<p>groups_controller.rb</p>\n\n<pre><code>module Users\n  module Users\n    class GroupsController &lt; BaseController\n      def index\n        @group = Group.new\n        @group.groups_users.build\n        @groups = Group.all\n      end\n\n      def create\n        group = Group.new(group_params)\n        if group.save!\n          redirect_to users_groups_path, notice: 'a new group created!'\n        else\n          redirect_to users_groups_path, notice: 'The selected group name has already been taken.'\n        end\n      end\n\n      private\n\n        def group_params\n          params.require(:group).permit(:name, :owner_user_id, groups_users_attributes: [:user_id])\n        end\n    end\n  end\nend\n</code></pre>\n\n<p>Views:</p>\n\n<p>groups/index.html.slim</p>\n\n<pre><code>= form_for [:users, @group] do |f|\n  .field\n    = f.label :name, 'group name\uff1a'\n    = f.text_field :name, size: 15, maxlength: 20\n    = f.hidden_field :owner_user_id, value: current_user.id\n  .field\n    = f.fields_for :groups_users do |g|\n      = g.label :user_id, 'user name you want to add'\n      = g.select :user_id, options_for_select(current_user.mutual_followers.map { |user| [user.name, user.id] }), {  }, { multiple: true }\n\n  .actions\n    = f.submit\n</code></pre>\n\n<p>Note:</p>\n\n<ul>\n<li>If I delete   { multiple: true }   from the view file, it worked, but I want to add several members at the same time.</li>\n<li>I'm using devise gem so current_user is the user who's logged in.</li>\n<li>mutual_followers: user who you are following who also follows you (defined in my User.rb, but I don't want to make my question too long). </li>\n</ul>\n\n<p>I think my code doesn't work because I insert an array of user_ids as one user_id, but I don't know how to solve this problem.</p>\n\n<p>P.S. I found a similar question here: <a href=\"https://stackoverflow.com/questions/25101933/nested-simple-form-in-rails4-has-many-through-save-multiple-records\">Nested Simple Form in Rails4 - has many through, save multiple records</a></p>\n\n<p>However, I couldn't find out how to solve my problem as I'm not using simple_form, and I couldn't figure out how to make up for that difference in form_for.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "heroku", "rails-activejob"], "answers": [{"comments": [{"owner": {"reputation": 101, "user_id": 5247067, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/5389b405405386bd21d2598acb76b56f?s=128&d=identicon&r=PG", "display_name": "Enis D.", "link": "https://stackoverflow.com/users/5247067/enis-d"}, "edited": false, "score": 0, "creation_date": 1488289239, "post_id": 42509673, "comment_id": 72157776, "body": "Good idea. For active posts, other functions will be available like making a  payment etc.. I was thinking to keep both active and inactive posts in the same table, and differ them with a boolean value. But is it good enough for the performance view to do something like : current_user.posts.published? That will query thousands of posts and find the published one depending on the scope ?"}, {"owner": {"reputation": 1472, "user_id": 2567424, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/cf84c50fc86c32c8db69ad465fb58653?s=128&d=identicon&r=PG", "display_name": "rogelio", "link": "https://stackoverflow.com/users/2567424/rogelio"}, "edited": false, "score": 0, "creation_date": 1488289511, "post_id": 42509673, "comment_id": 72157999, "body": "what happens with inactive post? there is no way to identify them."}, {"owner": {"reputation": 736, "user_id": 5857450, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e8a57b69174426b5faea201c3f8e3ca4?s=128&d=identicon&r=PG&f=1", "display_name": "Jawad Khawaja", "link": "https://stackoverflow.com/users/5857450/jawad-khawaja"}, "reply_to_user": {"reputation": 101, "user_id": 5247067, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/5389b405405386bd21d2598acb76b56f?s=128&d=identicon&r=PG", "display_name": "Enis D.", "link": "https://stackoverflow.com/users/5247067/enis-d"}, "edited": false, "score": 0, "creation_date": 1488291219, "post_id": 42509673, "comment_id": 72159212, "body": "@EnisD. with the boolean column, you would still require a scope to fetch those records where the value is true. Also, with my method there is the added benefit of avoiding the need to set the boolean field in the database at specific times."}], "tags": [], "owner": {"reputation": 736, "user_id": 5857450, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e8a57b69174426b5faea201c3f8e3ca4?s=128&d=identicon&r=PG&f=1", "display_name": "Jawad Khawaja", "link": "https://stackoverflow.com/users/5857450/jawad-khawaja"}, "is_accepted": false, "score": 3, "last_activity_date": 1488289517, "last_edit_date": 1488289517, "creation_date": 1488287506, "answer_id": 42509673, "question_id": 42509403, "link": "https://stackoverflow.com/questions/42509403/making-posts-inactive-after-a-date-and-time/42509673#42509673", "title": "Making posts inactive after a date and time", "body": "<p>If you simply plan to fetch and display posts, rather than setting the boolean value, you could just add a scope to the model:</p>\n\n<pre><code>scope :published, -&gt; { where('publish_at &lt; ?', Time.now) }\n</code></pre>\n\n<p>And use like this <code>Post.published</code></p>\n\n<p>Let me know if this helps.</p>\n\n<p>Update 1:</p>\n\n<p>If you need to determine if a post is active or not, add a method to the model like this, </p>\n\n<pre><code>def active?\n    self.publish_at &lt; Time.now\nend \n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 101, "user_id": 5247067, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/5389b405405386bd21d2598acb76b56f?s=128&d=identicon&r=PG", "display_name": "Enis D.", "link": "https://stackoverflow.com/users/5247067/enis-d"}, "edited": false, "score": 0, "creation_date": 1488293411, "post_id": 42511038, "comment_id": 72160784, "body": "Option 1 seems more suitable now. I think I&#39;ll let user to specify an expiration date and time while he creates the post, and I&#39;ll write this to a field called expire_at. While I&#39;m listing the posts in the views, I can use this scopes. But still the same question, every user will create about 10 posts every week. 300 users will use the app, every month 12 000 posts will be created. And I&#39;ll never delete them until the user deletes the post himself. Is this way good enough from the performance point of view?"}, {"owner": {"reputation": 1472, "user_id": 2567424, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/cf84c50fc86c32c8db69ad465fb58653?s=128&d=identicon&r=PG", "display_name": "rogelio", "link": "https://stackoverflow.com/users/2567424/rogelio"}, "reply_to_user": {"reputation": 101, "user_id": 5247067, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/5389b405405386bd21d2598acb76b56f?s=128&d=identicon&r=PG", "display_name": "Enis D.", "link": "https://stackoverflow.com/users/5247067/enis-d"}, "edited": false, "score": 1, "creation_date": 1488294367, "post_id": 42511038, "comment_id": 72161541, "body": "It depends, if you have 1 million of posts you don&#39;t want to show all of them at once. In this case you would want to use pagination, filter, etc. In terms of databases most of them can store a lot of data without loose performance."}], "tags": [], "owner": {"reputation": 1472, "user_id": 2567424, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/cf84c50fc86c32c8db69ad465fb58653?s=128&d=identicon&r=PG", "display_name": "rogelio", "link": "https://stackoverflow.com/users/2567424/rogelio"}, "is_accepted": true, "score": 1, "last_activity_date": 1488291211, "creation_date": 1488291211, "answer_id": 42511038, "question_id": 42509403, "link": "https://stackoverflow.com/questions/42509403/making-posts-inactive-after-a-date-and-time/42511038#42511038", "title": "Making posts inactive after a date and time", "body": "<p>You can do some things:</p>\n\n<p><strong>Option 1:</strong></p>\n\n<p>Based in the @jawad-khawaja answer, I think a better approach is to use <code>expired_at</code> instead of <code>published_at</code> because for me, a publish date is a date when a post is available for people. This way the user can define an expiration date for his own post (not the same publish date).</p>\n\n<p>Here some example how to you can get active/inactive posts based on its expiration date</p>\n\n<pre><code># active posts\nscope :published, -&gt; { where('expired_at &gt; ?', Time.now) }\n\n# inactive posts\nscope :unpublished, -&gt; { where('expired_at &lt; ?', Time.now) }\n</code></pre>\n\n<p><strong>Option 2:</strong></p>\n\n<p>If you have an attribute <code>published</code> as boolean and you really need mark it automatically, the option is to use <a href=\"https://github.com/javan/whenever\" rel=\"nofollow noreferrer\">whenever gem</a></p>\n\n<p><strong>CONS</strong> for this option:</p>\n\n<ul>\n<li>You will have two attributes representing the same thing: <code>published</code> as boolean and <code>expiration_datetime</code> as datetime</li>\n<li>If the minimum unit for an expiration date is a minute, you need to check every minute if every <em>not-expired</em> post enter to the expired state. And you will have probably an overload for your server.</li>\n</ul>\n\n<p><strong>Conclusion:</strong></p>\n\n<p>My recommended way is to choose the option 1.</p>\n"}], "owner": {"reputation": 101, "user_id": 5247067, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/5389b405405386bd21d2598acb76b56f?s=128&d=identicon&r=PG", "display_name": "Enis D.", "link": "https://stackoverflow.com/users/5247067/enis-d"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 384, "favorite_count": 0, "accepted_answer_id": 42511038, "answer_count": 2, "score": 0, "last_activity_date": 1488291211, "creation_date": 1488286762, "question_id": 42509403, "link": "https://stackoverflow.com/questions/42509403/making-posts-inactive-after-a-date-and-time", "title": "Making posts inactive after a date and time", "body": "<p>I've to make posts inactive after a given date and time by the user who creates these posts. I've added a boolean field \"published\" to make a post active or unactive.</p>\n\n<p>If the post is active, every visitor will see the post. If it's inactive, the post will be seen in the user dashboard as inactive.</p>\n\n<p>For you guys what is the best way to make a post inactive after the given datetime passed? That should be automatic but I don't think the suitable way is using Active Job and ;</p>\n\n<ul>\n<li>Check all posts in the db if active,</li>\n<li>If active, compare the given datetime and current datetime</li>\n<li>If needed, make it inactive</li>\n</ul>\n\n<p>I'm using heroku, so that'll make my worker busy all the time.</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 2230, "user_id": 6337957, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c1177d893bf3115edf0119cf56e7220?s=128&d=identicon&r=PG", "display_name": "Greg Navis", "link": "https://stackoverflow.com/users/6337957/greg-navis"}, "edited": false, "score": 3, "creation_date": 1488290880, "post_id": 42509234, "comment_id": 72159007, "body": "My guess is that you call <code>dummy</code> which triggers <code>method_missing</code> which calls <code>logger</code> (which is <b>not</b> defined) which calls <code>method_missing</code> (for the call to <code>logger</code>) which calls <code>logger</code> ... Is this the whole source of the <code>Try</code> class?"}], "answers": [{"tags": [], "owner": {"reputation": 27144, "user_id": 3857758, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/58c4295826435f049b7fc32b98c240f9?s=128&d=identicon&r=PG&f=1", "display_name": "Ursus", "link": "https://stackoverflow.com/users/3857758/ursus"}, "is_accepted": true, "score": 2, "last_activity_date": 1488287985, "creation_date": 1488287985, "answer_id": 42509868, "question_id": 42509234, "link": "https://stackoverflow.com/questions/42509234/ruby-class-logger-does-not-work/42509868#42509868", "title": "Ruby Class logger does not work", "body": "<p>I'm assuming you are not in a rails app. Have you instantiated the <code>logger</code> instance?</p>\n\n<pre><code>require 'logger'\n\nlogger = Logger.new(STDOUT)\nlogger.level = Logger::WARN\n\nlogger.warn \"test\"\n</code></pre>\n"}], "owner": {"reputation": 67, "user_id": 6417824, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e04acbe8b138a7df1360f69659b91077?s=128&d=identicon&r=PG&f=1", "display_name": "test", "link": "https://stackoverflow.com/users/6417824/test"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 71, "favorite_count": 0, "accepted_answer_id": 42509868, "answer_count": 1, "score": 0, "last_activity_date": 1488543779, "creation_date": 1488286242, "last_edit_date": 1488543779, "question_id": 42509234, "link": "https://stackoverflow.com/questions/42509234/ruby-class-logger-does-not-work", "title": "Ruby Class logger does not work", "body": "<p>I am use logger class but I am getting error.</p>\n\n<p><strong>Code :-</strong></p>\n\n<pre><code>class Try\n  def method_missing(method_name, *args)\n    logger.warn \"I am try to call #{method_name} with these arguments #{args}\"\n    super\n  end\nend\nTry.new.dummy(1, \"my name is rosy.\")\n</code></pre>\n\n<p><strong>Getting error:-</strong></p>\n\n<pre><code>stack level too deep (SystemStackError)\n</code></pre>\n\n<p>Please tell us. How to solve this problem. </p>\n"}, {"tags": ["ruby", "websocket", "eventmachine"], "comments": [{"owner": {"reputation": 30418, "user_id": 823617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DmWH1.png?s=128&g=1", "display_name": "Casper", "link": "https://stackoverflow.com/users/823617/casper"}, "edited": false, "score": 0, "creation_date": 1488285236, "post_id": 42508643, "comment_id": 72155085, "body": "Why not <code>def setup_sockets(urls); EM.run { urls.each { ... } }; end</code>. Doesn&#39;t that work?"}, {"owner": {"reputation": 8220, "user_id": 2771889, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/c568088e59a0fe4e38016d2707f48fb4?s=128&d=identicon&r=PG&f=1", "display_name": "thisismydesign", "link": "https://stackoverflow.com/users/2771889/thisismydesign"}, "reply_to_user": {"reputation": 30418, "user_id": 823617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DmWH1.png?s=128&g=1", "display_name": "Casper", "link": "https://stackoverflow.com/users/823617/casper"}, "edited": false, "score": 0, "creation_date": 1488285451, "post_id": 42508643, "comment_id": 72155221, "body": "That could work. I didn&#39;t think about that as it&#39;s posibble that URLs change over time or new ones get added. With that approach I&#39;d have to restart the process and cannot make modifications on the fly."}], "answers": [{"tags": [], "owner": {"reputation": 30418, "user_id": 823617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DmWH1.png?s=128&g=1", "display_name": "Casper", "link": "https://stackoverflow.com/users/823617/casper"}, "is_accepted": true, "score": 2, "last_activity_date": 1488296370, "last_edit_date": 1488296370, "creation_date": 1488287275, "answer_id": 42509589, "question_id": 42508643, "link": "https://stackoverflow.com/questions/42508643/how-to-connect-to-multiple-websockets-with-ruby/42509589#42509589", "title": "How to connect to multiple WebSockets with Ruby?", "body": "<p>Here's one way to do it.</p>\n\n<p>First, you have to accept that the EM thread needs to be running. Without this thread you won't be able to process any current connections. So you just can't get around that. </p>\n\n<p>Then, in order to add new URLs to the EM thread you then need some way to communicate from the main thread to the EM thread, so you can tell it to launch a new connection. This can be done with <code>EventMachine::Channel</code>.</p>\n\n<p>So what we can build now is something like this:</p>\n\n<pre><code>@channel = EventMachine::Channel.new\n\nThread.new {\n  EventMachine.run {\n     @channel.subscribe { |url| \n       ws = Faye::...new(url)\n       ...\n    }\n  }\n}\n</code></pre>\n\n<p>Then in the main thread, any time you want to add a new URL to the event loop, you just use this:</p>\n\n<pre><code>def setup_socket(url)\n  @channel.push(url)\nend\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 16402, "user_id": 4025095, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/blJ4L.jpg?s=128&g=1", "display_name": "Myst", "link": "https://stackoverflow.com/users/4025095/myst"}, "is_accepted": false, "score": 0, "last_activity_date": 1488340485, "last_edit_date": 1488340485, "creation_date": 1488339000, "answer_id": 42522649, "question_id": 42508643, "link": "https://stackoverflow.com/questions/42508643/how-to-connect-to-multiple-websockets-with-ruby/42522649#42522649", "title": "How to connect to multiple WebSockets with Ruby?", "body": "<p>Here's another way to do it... Use Iodine's native websocket support (or the <a href=\"http://www.plezi.io\" rel=\"nofollow noreferrer\">Plezi framework</a>) instead of <code>em-websocket</code>... </p>\n\n<p>...I'm biased (I'm the author), but I think they make it a lot easier. Also, Plezi offers automatic scaling with Redis, so it's easy to grow.</p>\n\n<p>Here's an example using Plezi, where each Controller acts like a channel, with it's own URL and Websocket callback (although I think Plezi's Auto-Dispatch is easier than the lower level <code>on_message</code> callback). This code can be placed in a <code>config.ru</code> file:</p>\n\n<pre><code>require 'plezi'\n\n# Once controller / channel for all members of the \"Red\" group\nclass RedGroup\n  def index # HTTP index for the /red URL\n    \"return the RedGroup client using `:render`\".freeze\n  end\n  # handle websocket messages\n  def on_message data\n    # in this example, we'll send the data to all the members of the other group.\n    BlueGroup.broadcast :handle_message, data\n  end\n  # This is the method activated by the \"broadcast\" message\n  def handle_message data\n    write data # write the data to the client.\n  end\nend\n# the blue group controller / channel\nclass BlueGroup\n  def index # HTTP index for the /blue URL\n    \"return the BlueGroup client using `:render`\".freeze\n  end\n  # handle websocket messages\n  def on_message data\n    # in this example, we'll send the data to all the members of the other group.\n    RedGroup.broadcast :handle_message, data\n  end\n  # This is the method activated by the \"broadcast\" message\n  def handle_message data\n    write data\n  end\nend\n# the routes\nPlezi.route '/red', RedGroup\nPlezi.route '/blue', BlueGroup\n# Set the Rack application\nrun Plezi.app\n</code></pre>\n\n<p>P.S.</p>\n\n<p>I wrote this answer also because <code>em-websocket</code> might fail or hog resources in some cases. I'm not sure about the details, but it was noted both on the <a href=\"https://github.com/hashrocket/websocket-shootout/blob/master/results/round-02.md#ruby--eventmachine--mri\" rel=\"nofollow noreferrer\">websocket-shootout benchmark</a> and the <a href=\"https://github.com/anycable/anycable/blob/master/benchmarks/2017-02-12.md#ruby--eventmachine\" rel=\"nofollow noreferrer\">AnyCable Websocket Benchmarks</a>.</p>\n"}], "owner": {"reputation": 8220, "user_id": 2771889, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/c568088e59a0fe4e38016d2707f48fb4?s=128&d=identicon&r=PG&f=1", "display_name": "thisismydesign", "link": "https://stackoverflow.com/users/2771889/thisismydesign"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 954, "favorite_count": 1, "accepted_answer_id": 42509589, "answer_count": 2, "score": 2, "last_activity_date": 1488340485, "creation_date": 1488284457, "last_edit_date": 1495541828, "question_id": 42508643, "link": "https://stackoverflow.com/questions/42508643/how-to-connect-to-multiple-websockets-with-ruby", "title": "How to connect to multiple WebSockets with Ruby?", "body": "<p>Using <a href=\"https://github.com/faye/faye-websocket-ruby\" rel=\"nofollow noreferrer\">faye-websocket</a> and EventMachine the code looks very similar to faye-websocket's client example:</p>\n\n<pre><code>require 'faye/websocket'\nrequire 'eventmachine'\n\ndef setup_socket(url)\n    EM.run {\n      ws = Faye::WebSocket::Client.new(url)\n\n      ws.on :open do ... end\n\n      ws.on :message do ... end\n\n      ws.on :close do ... end\n    }\nend\n</code></pre>\n\n<p>I'd like to have multiple connections open parallely. I can't simply call <code>setup_socket</code> multiple times as the execution won't exit the <code>EM.run</code> clause. I've tried to run <code>setup_socket</code> multiple times in separate threads as:</p>\n\n<pre><code>urls.each do |url|\n    Thread.new { setup_socket(url) }\nend\n</code></pre>\n\n<p>But it doesn't seem to do anyhting as the <code>puts</code> statements don't reach the output.</p>\n\n<p>I'm not restricted to use faye-websocket but it seemed most people use this library. If possible I'd like to avoid multithreading. I'd also not like to lose the possiblity to make changes (e.g. add a new websocket) over time. Therefore moving the iteration of URLs inside the <code>EM.run</code> clause is not desired but instead starting multiple EMs would be more beneficial. I found an <a href=\"https://stackoverflow.com/questions/6158394/multiple-servers-in-a-single-eventmachine-reactor\">example for starting multiple servers via EM</a> in a very clean way. I'm looking for something similar.</p>\n\n<p><strong>How can I connect to multiple WebSockets at the same time?</strong></p>\n"}, {"tags": ["css", "ruby", "gulp", "gulp-sass", "gulp-ruby-sass"], "answers": [{"tags": [], "owner": {"reputation": 86, "user_id": 4797198, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/t9pTJ.jpg?s=128&g=1", "display_name": "Gary", "link": "https://stackoverflow.com/users/4797198/gary"}, "is_accepted": true, "score": 0, "last_activity_date": 1488308589, "creation_date": 1488308589, "answer_id": 42516765, "question_id": 42508240, "link": "https://stackoverflow.com/questions/42508240/error-in-using-gulp-foundation-sass-version/42516765#42516765", "title": "Error in using gulp + foundation (sass version)", "body": "<p>It might be that the string concatenation is not working correctly in the <code>scss_sources</code>.</p>\n\n<p>Try changing scss_sources to:</p>\n\n<pre><code>scss_sources = [\n     'node_modules/foundation-sites/scss',\n     'asstes/src/style/style.scss'\n];\n</code></pre>\n\n<p>And see does that work, if so it's the concatenation.</p>\n"}], "owner": {"reputation": 77, "user_id": 3990289, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/4uqqG.jpg?s=128&g=1", "display_name": "MEHRY\u0100R.S", "link": "https://stackoverflow.com/users/3990289/mehry%c4%80r-s"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 96, "favorite_count": 0, "accepted_answer_id": 42516765, "answer_count": 1, "score": 0, "last_activity_date": 1488308589, "creation_date": 1488283220, "last_edit_date": 1488284362, "question_id": 42508240, "link": "https://stackoverflow.com/questions/42508240/error-in-using-gulp-foundation-sass-version", "title": "Error in using gulp + foundation (sass version)", "body": "<p>I want to use gulp + Foundation 6 + browserify.\nwhen run gulp in cli i have this error in terminal</p>\n\n<pre><code>write ./scss.css/foundation.css\npath.js:7\nthrow new TypeError('Path must be a string. Received ' + inspect(path));\n^\n\nTypeError: Path must be a string. Received undefined\n    at assertPath (path.js:7:11)\n    at Object.join (path.js:1211:7)\n    at exports.replaceLocation (/Applications/MAMP/htdocs/Jober/node_modules/gulp-ruby-sass/lib/utils.js:32:14)\n    at /Applications/MAMP/htdocs/Jober/node_modules/gulp-ruby-sass/index.js:179:13\n    at FSReqWrap.readFileAfterClose [as oncomplete] (fs.js:416:3)\n</code></pre>\n\n<p>my gulpfile.js is:</p>\n\n<pre><code>var gulp        = require ('gulp'),\n    logger      = require ('gulp-util'),\n    concat      = require ('gulp-concat'),\n    minifyCSS   = require ('gulp-minify-css'),\n    compileSass = require ('gulp-ruby-sass');\n\nvar scss_sources,\n    input_address,\n    output_address;\n\n// Input and Output Address\n    input_address  = 'asstes/src/';\n    output_address = 'asstes/dist/';\n\n// Style Sources\n    scss_sources = [\n        'node_modules/foundation-sites/scss',\n        input_address + 'style/style.scss'];\n\n    gulp.task('styles', function(){\n        return compileSass(scss_sources, { style: 'expanded' })\n               .pipe(autoprefixer({\n                   browsers: ['last 2 versions', 'ie &gt;= 9', 'and_chr &gt;= 2.3'],\n                   cascade: false\n               }))\n               .pipe(minifyCSS())\n               .on('error', logger.log)\n               .pipe(gulp.dest(output_address + 'style'));\n    });\n\ngulp.task('watch', function(){\n    gulp.watch(input_address + 'style/pages/*.scss', ['styles']),\n});\n\ngulp.task('default', ['styles' , 'watch']);\n</code></pre>\n\n<p>my style.scss is:</p>\n\n<pre><code>//Modules\n@import 'foundation';\n\n//Pages\n@import 'pages/index';\n</code></pre>\n\n<p>and my folders structure is:</p>\n\n<pre><code>PROJECT FOLDER\n    |\n    |_assets\n    |    |_dist\n    |    |   |_img\n    |    |   |_js\n    |    |   |_style\n    |    |\n    |    |_src\n    |        |_img\n    |        |_js\n    |        |_style\n    |\n    |_node_modules\n    |        |_foundation-site\n    |\n    |_gulpfile.js\n</code></pre>\n\n<p>I'd used gulp-compass before gulp-ruby-sass but, had popular error: <code>Individual stylesheets must be in the sass directory</code>, therefore change plugin to gulp-ruby-sass.</p>\n\n<p>How can I fix it?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "cart"], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user7634937"}, "edited": false, "score": 0, "creation_date": 1488280847, "post_id": 42507290, "comment_id": 72152100, "body": "Anyway doesn&#39;t work, it gives error &quot;no implicit conversion of String into Integer&quot;"}, {"owner": {"reputation": 1479, "user_id": 2506819, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3b60435154915157dfd7ebfc04164930?s=128&d=identicon&r=PG", "display_name": "fanta", "link": "https://stackoverflow.com/users/2506819/fanta"}, "edited": false, "score": 0, "creation_date": 1488294357, "post_id": 42507290, "comment_id": 72161535, "body": "The error you&#39;re having now <code>Anyway doesn&#39;t work, it gives error &quot;no implicit conversion of String into Integer&quot;</code> is because the first time when you add <code>food_id</code> to your <b>session</b> is with <code>push</code>, that means <code>session[:cart][cafe_id]</code> is an array, and when you try to increase <code>quantity</code>, you&#39;re trying to access it as a hash with <code>session[:cart][cafe_id][food_id]</code>, that&#39;s why you&#39;re getting that error. But the reason I didn&#39;t write an answer is because <code>quantity</code> doesn&#39;t exist in the <code>food_id</code> Integer you&#39;re storing in the Session, for that you need an object with a <code>quantity</code> attribute in it."}], "tags": [], "owner": {"reputation": 1254, "user_id": 4576274, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F5Wnd.jpg?s=128&g=1", "display_name": "Pramod", "link": "https://stackoverflow.com/users/4576274/pramod"}, "is_accepted": false, "score": 0, "last_activity_date": 1488280589, "creation_date": 1488280589, "answer_id": 42507290, "question_id": 42507196, "link": "https://stackoverflow.com/questions/42507196/how-to-increase-quantity-in-cart-rails/42507290#42507290", "title": "How to increase quantity in cart Rails", "body": "<p>you should check <code>if session[:cart][cafe_id][food_id].present?</code> instead of <code>if session[:cart][food_id].present?</code></p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user7634937"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 323, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1488282137, "creation_date": 1488280318, "last_edit_date": 1488282137, "question_id": 42507196, "link": "https://stackoverflow.com/questions/42507196/how-to-increase-quantity-in-cart-rails", "title": "How to increase quantity in cart Rails", "body": "<p>I am doing cart for cafe, everything works fine except increasing quantity. When I add a food to cart...it just dublicating the same food...instead of increase the quantity. I want to make the solution that will check...If the food already in cart...instead of adding it will just increase the quantity. Below is my controller that adds food to cart. Any help will be appreciated</p>\n\n<pre><code>def add_to_cart\n  add_to_session(params[:cafe], params[:food])\n  redirect_to about_cafe_path(Cafe.find(params[:cafe]))\nend\n\ndef show_cart\n  @cart = session[:cart]\nend\n\ndef clear_cart\n  session[:cart] = {}\n  redirect_to show_cart_path\nend\n\ndef remove\n  destroy_food(params[:cafe], params[:food])\n  redirect_to :back\nend\n\nprivate\n\ndef add_to_session(cafe_id, food_id)\n  if session[:cart][food_id].present?\n    session[:cart][cafe_id][food_id].quantity += 1\n  else\n    session[:cart][cafe_id].push food_id\n  end\nend\n\ndef destroy_food(cafe_id, food_id)\n  session[:cart][cafe_id].delete food_id\nend\n</code></pre>\n"}, {"tags": ["ruby", "join", "activerecord"], "comments": [{"owner": {"reputation": 47232, "user_id": 1772830, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/Qtoqg.jpg?s=128&g=1", "display_name": "Andrey Deineko", "link": "https://stackoverflow.com/users/1772830/andrey-deineko"}, "edited": false, "score": 0, "creation_date": 1488279550, "post_id": 42506887, "comment_id": 72151264, "body": "what error it gives you?"}, {"owner": {"reputation": 3, "user_id": 7588081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/818401e248a319e3c4b6b334b0dba691?s=128&d=identicon&r=PG&f=1", "display_name": "driphekitr", "link": "https://stackoverflow.com/users/7588081/driphekitr"}, "reply_to_user": {"reputation": 47232, "user_id": 1772830, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/Qtoqg.jpg?s=128&g=1", "display_name": "Andrey Deineko", "link": "https://stackoverflow.com/users/1772830/andrey-deineko"}, "edited": false, "score": 0, "creation_date": 1488279707, "post_id": 42506887, "comment_id": 72151347, "body": "@AndreyDeineko I added the error."}, {"owner": {"reputation": 47232, "user_id": 1772830, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/Qtoqg.jpg?s=128&g=1", "display_name": "Andrey Deineko", "link": "https://stackoverflow.com/users/1772830/andrey-deineko"}, "edited": false, "score": 0, "creation_date": 1488279751, "post_id": 42506887, "comment_id": 72151383, "body": "the error comes from <code>get_list</code>, because <code>Check.select(Check.attribute_names - [&#39;checkdata&#39;]).joins(:model)</code> is valid."}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 7588081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/818401e248a319e3c4b6b334b0dba691?s=128&d=identicon&r=PG&f=1", "display_name": "driphekitr", "link": "https://stackoverflow.com/users/7588081/driphekitr"}, "edited": false, "score": 0, "creation_date": 1488284972, "post_id": 42508006, "comment_id": 72154891, "body": "This helped me get a bit further. Now I get <code>ERROR -- : SQLite3::SQLException: wrong number of arguments to function COUNT()</code> but I guess I can solve this as theres a column less? I&#39;m very new to ruby so it&#39;ll take time. Thanks for now."}, {"owner": {"reputation": 38092, "user_id": 18706, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/cabf735ce7b8b4471ef46ea54f71832d?s=128&d=identicon&r=PG", "display_name": "mahemoff", "link": "https://stackoverflow.com/users/18706/mahemoff"}, "reply_to_user": {"reputation": 3, "user_id": 7588081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/818401e248a319e3c4b6b334b0dba691?s=128&d=identicon&r=PG&f=1", "display_name": "driphekitr", "link": "https://stackoverflow.com/users/7588081/driphekitr"}, "edited": false, "score": 0, "creation_date": 1488290606, "post_id": 42508006, "comment_id": 72158807, "body": "Actually, try my update with <code>*cols</code>. select() expects a variable-length list of args, not a single array arg."}], "tags": [], "owner": {"reputation": 38092, "user_id": 18706, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/cabf735ce7b8b4471ef46ea54f71832d?s=128&d=identicon&r=PG", "display_name": "mahemoff", "link": "https://stackoverflow.com/users/18706/mahemoff"}, "is_accepted": true, "score": 0, "last_activity_date": 1488290566, "last_edit_date": 1488290566, "creation_date": 1488282596, "answer_id": 42508006, "question_id": 42506887, "link": "https://stackoverflow.com/questions/42506887/ruby-exclude-a-column-with-activerecord/42508006#42508006", "title": "Ruby - exclude a column with activerecord", "body": "<p>It looks like a conflict with the join table as they both have <code>id</code> columns. Try this:</p>\n\n<pre><code>cols = (Check.attribute_names - ['checkdata']).map { |attrib| \"checks.#{attrib}\" }\nret = Check.select(*cols).joins(:model).get_list ...\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 7588081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/818401e248a319e3c4b6b334b0dba691?s=128&d=identicon&r=PG&f=1", "display_name": "driphekitr", "link": "https://stackoverflow.com/users/7588081/driphekitr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 73, "favorite_count": 0, "accepted_answer_id": 42508006, "answer_count": 1, "score": 0, "last_activity_date": 1488290566, "creation_date": 1488279481, "last_edit_date": 1488279681, "question_id": 42506887, "link": "https://stackoverflow.com/questions/42506887/ruby-exclude-a-column-with-activerecord", "title": "Ruby - exclude a column with activerecord", "body": "<p>I want to exclude a column (called checkdata) in my Check table.</p>\n\n<p>Right now my code looks like this:</p>\n\n<pre><code>ret = Check.joins(:model).get_list do |q|\n  // some code\nend\n</code></pre>\n\n<p>I tried the following which I found as I was searching for a solution, but it gives me an error:</p>\n\n<pre><code>ret = Check.select(Check.attribute_names - ['checkdata']).joins(:model).get_list do |q|\n  // some code\nend\n</code></pre>\n\n<p>Error:</p>\n\n<pre><code>E, [2017-02-28T10:45:05.154053 #10874] ERROR -- : SQLite3::SQLException: ambiguous column name: id: SELECT COUNT(id, unit_id, model_id, checktype_id, comment, scheduled, dueby, started, finished, status, metadata, created_at, updated_at, created_by, updated_by) FROM \"checks\" INNER JOIN \"models\" ON \"models\".\"id\" = \"checks\".\"model_id\" WHERE \"checks\".\"status\" = 20 2017-02-28 10:45:05 - ActiveRecord::StatementInvalid - SQLite3::SQLException: ambiguous column name: id: SELECT COUNT(id, unit_id, model_id, checktype_id, comment, scheduled, dueby, started, finished, status, metadata, created_at, updated_at, created_by, updated_by) FROM \"checks\" INNER JOIN \"models\" ON \"models\".\"id\" = \"checks\".\"model_id\" WHERE \"checks\".\"status\" = 20:\n        /Library/Ruby/Gems/2.0.0/gems/sqlite3-1.3.13/lib/sqlite3/database.rb:91:in `initialize'\n        /Library/Ruby/Gems/2.0.0/gems/sqlite3-1.3.13/lib/sqlite3/database.rb:91:in `new'\n        /Library/Ruby/Gems/2.0.0/gems/sqlite3-1.3.13/lib/sqlite3/database.rb:91:in `prepare'\n        /Library/Ruby/Gems/2.0.0/gems/activerecord-4.1.16/lib/active_record/connection_adapters/sqlite3_adapter.rb:301:in `block in exec_query'\n        /Library/Ruby/Gems/2.0.0/gems/activerecord-4.1.16/lib/active_record/connection_adapters/abstract_adapter.rb:378:in `block in log'\n        /Library/Ruby/Gems/2.0.0/gems/activesupport-4.1.16/lib/active_support/notifications/instrumenter.rb:20:in `instrument'\n        /Library/Ruby/Gems/2.0.0/gems/activerecord-4.1.16/lib/active_record/connection_adapters/abstract_adapter.rb:372:in `log'\n        /Library/Ruby/Gems/2.0.0/gems/activerecord-4.1.16/lib/active_record/connection_adapters/sqlite3_adapter.rb:298:in `exec_query'\n        /Library/Ruby/Gems/2.0.0/gems/activerecord-4.1.16/lib/active_record/connection_adapters/sqlite3_adapter.rb:510:in `select'\n        /Library/Ruby/Gems/2.0.0/gems/activerecord-4.1.16/lib/active_record/connection_adapters/abstract/database_statements.rb:24:in `select_all'\n        /Library/Ruby/Gems/2.0.0/gems/activerecord-4.1.16/lib/active_record/connection_adapters/abstract/query_cache.rb:70:in `select_all'\n        /Library/Ruby/Gems/2.0.0/gems/activerecord-4.1.16/lib/active_record/relation/calculations.rb:265:in `execute_simple_calculation'\n        /Library/Ruby/Gems/2.0.0/gems/activerecord-4.1.16/lib/active_record/relation/calculations.rb:227:in `perform_calculation'\n        /Library/Ruby/Gems/2.0.0/gems/activerecord-4.1.16/lib/active_record/relation/calculations.rb:119:in `calculate'\n        /Library/Ruby/Gems/2.0.0/gems/activerecord-4.1.16/lib/active_record/relation/calculations.rb:34:in `count'\n        /Users/ndinatale/leanlogic-qa-prototype/server/lib/models_base.rb:135:in `get_list'\n        /Library/Ruby/Gems/2.0.0/gems/activerecord-4.1.16/lib/active_record/relation/delegation.rb:94:in `public_send'\n        /Library/Ruby/Gems/2.0.0/gems/activerecord-4.1.16/lib/active_record/relation/delegation.rb:94:in `block in method_missing'\n        /Library/Ruby/Gems/2.0.0/gems/activerecord-4.1.16/lib/active_record/relation.rb:292:in `scoping'\n        /Library/Ruby/Gems/2.0.0/gems/activerecord-4.1.16/lib/active_record/relation/delegation.rb:94:in `method_missing'\n        /Users/ndinatale/leanlogic-qa-prototype/server/lib/routes_dashboard.rb:110:in `dashboard_type_CPCH'\n        /Users/ndinatale/leanlogic-qa-prototype/server/routes/02_rest_misc.rb:175:in `call'\n        /Users/ndinatale/leanlogic-qa-prototype/server/routes/02_rest_misc.rb:175:in `block in &lt;top (required)&gt;'\n        /Library/Ruby/Gems/2.0.0/gems/sinatra-1.4.8/lib/sinatra/base.rb:1611:in `call'\n        /Library/Ruby/Gems/2.0.0/gems/sinatra-1.4.8/lib/sinatra/base.rb:1611:in `block in compile!'\n        /Library/Ruby/Gems/2.0.0/gems/sinatra-1.4.8/lib/sinatra/base.rb:975:in `[]'\n        /Library/Ruby/Gems/2.0.0/gems/sinatra-1.4.8/lib/sinatra/base.rb:975:in `block (3 levels) in route!'\n        /Library/Ruby/Gems/2.0.0/gems/sinatra-1.4.8/lib/sinatra/base.rb:994:in `route_eval'\n        /Library/Ruby/Gems/2.0.0/gems/sinatra-1.4.8/lib/sinatra/base.rb:975:in `block (2 levels) in route!'\n        /Library/Ruby/Gems/2.0.0/gems/sinatra-1.4.8/lib/sinatra/base.rb:1015:in `block in process_route'\n        /Library/Ruby/Gems/2.0.0/gems/sinatra-1.4.8/lib/sinatra/base.rb:1013:in `catch'\n        /Library/Ruby/Gems/2.0.0/gems/sinatra-1.4.8/lib/sinatra/base.rb:1013:in `process_route'\n        /Library/Ruby/Gems/2.0.0/gems/sinatra-1.4.8/lib/sinatra/base.rb:973:in `block in route!'\n        /Library/Ruby/Gems/2.0.0/gems/sinatra-1.4.8/lib/sinatra/base.rb:972:in `each'\n        /Library/Ruby/Gems/2.0.0/gems/sinatra-1.4.8/lib/sinatra/base.rb:972:in `route!'\n        /Library/Ruby/Gems/2.0.0/gems/sinatra-1.4.8/lib/sinatra/base.rb:1085:in `block in dispatch!'\n        /Library/Ruby/Gems/2.0.0/gems/sinatra-1.4.8/lib/sinatra/base.rb:1067:in `block in invoke'\n        /Library/Ruby/Gems/2.0.0/gems/sinatra-1.4.8/lib/sinatra/base.rb:1067:in `catch'\n        /Library/Ruby/Gems/2.0.0/gems/sinatra-1.4.8/lib/sinatra/base.rb:1067:in `invoke'\n        /Library/Ruby/Gems/2.0.0/gems/sinatra-1.4.8/lib/sinatra/base.rb:1082:in `dispatch!'\n        /Library/Ruby/Gems/2.0.0/gems/sinatra-1.4.8/lib/sinatra/base.rb:907:in `block in call!'\n        /Library/Ruby/Gems/2.0.0/gems/sinatra-1.4.8/lib/sinatra/base.rb:1067:in `block in invoke'\n        /Library/Ruby/Gems/2.0.0/gems/sinatra-1.4.8/lib/sinatra/base.rb:1067:in `catch'\n        /Library/Ruby/Gems/2.0.0/gems/sinatra-1.4.8/lib/sinatra/base.rb:1067:in `invoke'\n        /Library/Ruby/Gems/2.0.0/gems/sinatra-1.4.8/lib/sinatra/base.rb:907:in `call!'\n        /Library/Ruby/Gems/2.0.0/gems/sinatra-1.4.8/lib/sinatra/base.rb:895:in `call'\n        /Library/Ruby/Gems/2.0.0/gems/rack-1.6.5/lib/rack/session/abstract/id.rb:225:in `context'\n        /Library/Ruby/Gems/2.0.0/gems/rack-1.6.5/lib/rack/session/abstract/id.rb:220:in `call'\n        /Library/Ruby/Gems/2.0.0/gems/activerecord-4.1.16/lib/active_record/connection_adapters/abstract/connection_pool.rb:621:in `call'\n        /Library/Ruby/Gems/2.0.0/gems/rack-protection-1.5.3/lib/rack/protection/xss_header.rb:18:in `call'\n        /Library/Ruby/Gems/2.0.0/gems/rack-protection-1.5.3/lib/rack/protection/path_traversal.rb:16:in `call'\n        /Library/Ruby/Gems/2.0.0/gems/rack-protection-1.5.3/lib/rack/protection/json_csrf.rb:18:in `call'\n        /Library/Ruby/Gems/2.0.0/gems/rack-protection-1.5.3/lib/rack/protection/base.rb:49:in `call'\n        /Library/Ruby/Gems/2.0.0/gems/rack-protection-1.5.3/lib/rack/protection/base.rb:49:in `call'\n        /Library/Ruby/Gems/2.0.0/gems/rack-protection-1.5.3/lib/rack/protection/frame_options.rb:31:in `call'\n        /Library/Ruby/Gems/2.0.0/gems/rack-1.6.5/lib/rack/nulllogger.rb:9:in `call'\n        /Library/Ruby/Gems/2.0.0/gems/rack-1.6.5/lib/rack/head.rb:13:in `call'\n        /Library/Ruby/Gems/2.0.0/gems/rack-1.6.5/lib/rack/methodoverride.rb:22:in `call'\n        /Library/Ruby/Gems/2.0.0/gems/sinatra-1.4.8/lib/sinatra/show_exceptions.rb:25:in `call'\n        /Library/Ruby/Gems/2.0.0/gems/sinatra-1.4.8/lib/sinatra/base.rb:182:in `call'\n        /Library/Ruby/Gems/2.0.0/gems/sinatra-1.4.8/lib/sinatra/base.rb:2013:in `call'\n        /Library/Ruby/Gems/2.0.0/gems/sinatra-1.4.8/lib/sinatra/base.rb:1487:in `block in call'\n        /Library/Ruby/Gems/2.0.0/gems/sinatra-1.4.8/lib/sinatra/base.rb:1785:in `synchronize'\n        /Library/Ruby/Gems/2.0.0/gems/sinatra-1.4.8/lib/sinatra/base.rb:1785:in `synchronize'\n        /Library/Ruby/Gems/2.0.0/gems/sinatra-1.4.8/lib/sinatra/base.rb:1487:in `call'\n        /Library/Ruby/Gems/2.0.0/gems/puma-3.7.0/lib/puma/configuration.rb:226:in `call'\n        /Library/Ruby/Gems/2.0.0/gems/puma-3.7.0/lib/puma/server.rb:578:in `handle_request'\n        /Library/Ruby/Gems/2.0.0/gems/puma-3.7.0/lib/puma/server.rb:415:in `process_client'\n        /Library/Ruby/Gems/2.0.0/gems/puma-3.7.0/lib/puma/server.rb:275:in `block in run'\n        /Library/Ruby/Gems/2.0.0/gems/puma-3.7.0/lib/puma/thread_pool.rb:120:in `call'\n        /Library/Ruby/Gems/2.0.0/gems/puma-3.7.0/lib/puma/thread_pool.rb:120:in `block in spawn_thread'\n</code></pre>\n\n<p>Can someone help me with this? Thank you.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "activerecord", "transactions", "activesupport"], "comments": [{"owner": {"reputation": 346, "user_id": 2457435, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d998a18446f06a200a4e66460a82f6d1?s=128&d=identicon&r=PG", "display_name": "01010011 01000010", "link": "https://stackoverflow.com/users/2457435/01010011-01000010"}, "edited": false, "score": 0, "creation_date": 1488294232, "post_id": 42505547, "comment_id": 72161436, "body": "Can I ask why you don&#39;t want to add them to the model? That is the rails thing to do, and I don&#39;t think it&#39;s possible to do what you are proposing. However, we can probably find a way to work around whatever reason you have for not wanting to touch the models."}, {"owner": {"reputation": 1136, "user_id": 5215927, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/w06Fv.jpg?s=128&g=1", "display_name": "mr_sudaca", "link": "https://stackoverflow.com/users/5215927/mr-sudaca"}, "edited": false, "score": 0, "creation_date": 1488298546, "post_id": 42505547, "comment_id": 72164701, "body": "you can wrap the transaction in a <code>begin</code> <code>rescue</code> block, and put the after_commit call right after the transaction. If the transaction fails, the block will be rescued and the callback won&#39;t be called."}], "answers": [{"tags": [], "owner": {"reputation": 3591, "user_id": 338859, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/d0e95abdd0aed671ebd0920c16d393d4?s=128&d=identicon&r=PG", "display_name": "Envek", "link": "https://stackoverflow.com/users/338859/envek"}, "is_accepted": false, "score": 0, "last_activity_date": 1521402026, "creation_date": 1521402026, "answer_id": 49352127, "question_id": 42505547, "link": "https://stackoverflow.com/questions/42505547/is-there-a-way-to-set-after-commit-callbacks-to-a-specific-activerecord-transact/49352127#49352127", "title": "is there a way to set after_commit callbacks to a specific ActiveRecord transaction", "body": "<p>Please take a look at these gems:</p>\n\n<ul>\n<li><a href=\"https://travis-ci.org/Envek/after_commit_everywhere\" rel=\"nofollow noreferrer\">after_commit_everywhere</a> (disclaimer: I'm the author)</li>\n<li><a href=\"https://github.com/instructure/after_transaction_commit\" rel=\"nofollow noreferrer\">after_transaction_commit</a></li>\n</ul>\n"}], "owner": {"reputation": 69, "user_id": 2618716, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/37b12e8d5b5beaa008b972dc7b110b99?s=128&d=identicon&r=PG", "display_name": "felipebatista", "link": "https://stackoverflow.com/users/2618716/felipebatista"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 886, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1521402026, "creation_date": 1488275954, "question_id": 42505547, "link": "https://stackoverflow.com/questions/42505547/is-there-a-way-to-set-after-commit-callbacks-to-a-specific-activerecord-transact", "title": "is there a way to set after_commit callbacks to a specific ActiveRecord transaction", "body": "<p>I am creating a ActiveRecord transaction this way</p>\n\n<pre><code>ActiveRecord::Base.transaction do\n  MyModel.create!(name: \"value\")\n  OtherModel.create!(name: \"value\")\nend\n</code></pre>\n\n<p>I'd want to set a specific <code>after_commit</code> callback to this transaction. I don't want to attach it to any one of the models because I don't it to be executed every time I create one of these separately.</p>\n\n<p>I cannot simply write some code in the end of the <code>transaction</code> block either, because maybe the real transaction is created outside of this code (I am not setting the <code>require_new</code> option to <code>true</code>)</p>\n\n<p>Is there any way to set callbacks to a specific transaction instance?</p>\n\n<p>thank you very much</p>\n"}]