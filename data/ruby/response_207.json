[{"tags": ["ruby", "ruby-on-rails-5", "rails-activerecord"], "comments": [{"owner": {"reputation": 14010, "user_id": 3109182, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/a4b305f0077055b4fdcf715067775d5a?s=128&d=identicon&r=PG", "display_name": "Anthony", "link": "https://stackoverflow.com/users/3109182/anthony"}, "edited": false, "score": 0, "creation_date": 1545865633, "post_id": 53937984, "comment_id": 94716127, "body": "do you want to support that many places?  that seems really high unless a machine is asking for it?"}, {"owner": {"reputation": 3201, "user_id": 2892779, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uvM8S.jpg?s=128&g=1", "display_name": "Jay Dorsey", "link": "https://stackoverflow.com/users/2892779/jay-dorsey"}, "edited": false, "score": 0, "creation_date": 1545868792, "post_id": 53937984, "comment_id": 94716688, "body": "Have you tried <code>places.find_each</code> instead of <code>places.each</code> yet? Good article here: <a href=\"https://rubyinrails.com/2017/11/16/use-find-each-instead-of-all-each-in-rails/\" rel=\"nofollow noreferrer\">rubyinrails.com/2017/11/16/&hellip;</a> Also, what else are you doing with all this (e.g. is this in a view)"}, {"owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 0, "creation_date": 1545894679, "post_id": 53937984, "comment_id": 94721421, "body": "How does <code>within_radius_of</code> look like? How is <code>people</code> defined? Are you really still using Rails 3?"}, {"owner": {"reputation": 2166, "user_id": 219222, "user_type": "registered", "accept_rate": 27, "profile_image": "https://www.gravatar.com/avatar/1dd1d4bde5b46b4c90efeadea3a96a75?s=128&d=identicon&r=PG", "display_name": "riley", "link": "https://stackoverflow.com/users/219222/riley"}, "reply_to_user": {"reputation": 14010, "user_id": 3109182, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/a4b305f0077055b4fdcf715067775d5a?s=128&d=identicon&r=PG", "display_name": "Anthony", "link": "https://stackoverflow.com/users/3109182/anthony"}, "edited": false, "score": 0, "creation_date": 1545940378, "post_id": 53937984, "comment_id": 94738872, "body": "@Anthony yes I need to support this in some way for the business requirements"}, {"owner": {"reputation": 2166, "user_id": 219222, "user_type": "registered", "accept_rate": 27, "profile_image": "https://www.gravatar.com/avatar/1dd1d4bde5b46b4c90efeadea3a96a75?s=128&d=identicon&r=PG", "display_name": "riley", "link": "https://stackoverflow.com/users/219222/riley"}, "reply_to_user": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 0, "creation_date": 1545941158, "post_id": 53937984, "comment_id": 94739114, "body": "@spickermann added <code>within_radius_of</code> scope.  On Rails 5.0.7.1"}, {"owner": {"reputation": 2166, "user_id": 219222, "user_type": "registered", "accept_rate": 27, "profile_image": "https://www.gravatar.com/avatar/1dd1d4bde5b46b4c90efeadea3a96a75?s=128&d=identicon&r=PG", "display_name": "riley", "link": "https://stackoverflow.com/users/219222/riley"}, "reply_to_user": {"reputation": 3201, "user_id": 2892779, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uvM8S.jpg?s=128&g=1", "display_name": "Jay Dorsey", "link": "https://stackoverflow.com/users/2892779/jay-dorsey"}, "edited": false, "score": 0, "creation_date": 1545941881, "post_id": 53937984, "comment_id": 94739340, "body": "@JayDorsey I don&#39;t believe this is a memory issue which <code>find_each</code> would fix, but will try that.  I don&#39;t use this in the view; after the query new records are created for each person that matches any of the places."}, {"owner": {"reputation": 4600, "user_id": 5961578, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/df7cbfdd2a92a7926af3bbb8648318aa?s=128&d=identicon&r=PG", "display_name": "moveson", "link": "https://stackoverflow.com/users/5961578/moveson"}, "edited": false, "score": 0, "creation_date": 1545945189, "post_id": 53937984, "comment_id": 94740408, "body": "Increasing your stack size is almost certainly not the right answer. You can probably construct the SQL using a custom method. What does the SQL look like if you are working with, say, three places?"}, {"owner": {"reputation": 2166, "user_id": 219222, "user_type": "registered", "accept_rate": 27, "profile_image": "https://www.gravatar.com/avatar/1dd1d4bde5b46b4c90efeadea3a96a75?s=128&d=identicon&r=PG", "display_name": "riley", "link": "https://stackoverflow.com/users/219222/riley"}, "reply_to_user": {"reputation": 4600, "user_id": 5961578, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/df7cbfdd2a92a7926af3bbb8648318aa?s=128&d=identicon&r=PG", "display_name": "moveson", "link": "https://stackoverflow.com/users/5961578/moveson"}, "edited": false, "score": 0, "creation_date": 1546021199, "post_id": 53937984, "comment_id": 94763047, "body": "@moveson  what implications are there to increasing the stack size?  I have seen others with similar issues do this to fix it."}, {"owner": {"reputation": 4600, "user_id": 5961578, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/df7cbfdd2a92a7926af3bbb8648318aa?s=128&d=identicon&r=PG", "display_name": "moveson", "link": "https://stackoverflow.com/users/5961578/moveson"}, "edited": false, "score": 0, "creation_date": 1546032499, "post_id": 53937984, "comment_id": 94766688, "body": "@riley The problem with solving this problem by increasing stack size is that you will have the same problem again when you increase the number of places again. There is a simple way to construct the required SQL without using a recursive method. I&#39;ll help you do that if you&#39;ll show me what the current SQL query looks like on a small scale, with just two or three places."}, {"owner": {"reputation": 2166, "user_id": 219222, "user_type": "registered", "accept_rate": 27, "profile_image": "https://www.gravatar.com/avatar/1dd1d4bde5b46b4c90efeadea3a96a75?s=128&d=identicon&r=PG", "display_name": "riley", "link": "https://stackoverflow.com/users/219222/riley"}, "reply_to_user": {"reputation": 4600, "user_id": 5961578, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/df7cbfdd2a92a7926af3bbb8648318aa?s=128&d=identicon&r=PG", "display_name": "moveson", "link": "https://stackoverflow.com/users/5961578/moveson"}, "edited": false, "score": 0, "creation_date": 1546067545, "post_id": 53937984, "comment_id": 94772658, "body": "@moveson yes that would be an issue, however this is admin entered data and we will never go above the current amount.  If you can suggest a way to break down the query it would probably be a better solution.  You can see the current query in the details, it is using arel to <code>or</code> multiple queries of <code>where(earth_box(lat, lon, radius)).where(earth_distance_less_than(lat, lon, radius))</code> which just generate postgresql <code>earth_box</code> and <code>earth_distance</code> queries."}, {"owner": {"reputation": 2166, "user_id": 219222, "user_type": "registered", "accept_rate": 27, "profile_image": "https://www.gravatar.com/avatar/1dd1d4bde5b46b4c90efeadea3a96a75?s=128&d=identicon&r=PG", "display_name": "riley", "link": "https://stackoverflow.com/users/219222/riley"}, "edited": false, "score": 0, "creation_date": 1546068126, "post_id": 53937984, "comment_id": 94772745, "body": "<code>find_each</code> did not fix the issue.  Setting the stack size to 4mb does fix it, although probably not optimal"}, {"owner": {"reputation": 4600, "user_id": 5961578, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/df7cbfdd2a92a7926af3bbb8648318aa?s=128&d=identicon&r=PG", "display_name": "moveson", "link": "https://stackoverflow.com/users/5961578/moveson"}, "edited": false, "score": 0, "creation_date": 1546175066, "post_id": 53937984, "comment_id": 94793147, "body": "@riley I agree setting the stack larger is not optimal. I can see the ActiveRecord query in your question; no need to repeat it. I&#39;m asking you to put up the raw SQL that is generated by your ActiveRecord query. If you check your server logs you&#39;ll see it there. Of course the SQL will be very long if you show what is produced by 600 recursions, so please set number of places to 2 or 3, run a query, check the server logs, find the SQL, and copy/paste it into your question."}], "owner": {"reputation": 2166, "user_id": 219222, "user_type": "registered", "accept_rate": 27, "profile_image": "https://www.gravatar.com/avatar/1dd1d4bde5b46b4c90efeadea3a96a75?s=128&d=identicon&r=PG", "display_name": "riley", "link": "https://stackoverflow.com/users/219222/riley"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 66, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1546067661, "creation_date": 1545864763, "last_edit_date": 1546067661, "question_id": 53937984, "link": "https://stackoverflow.com/questions/53937984/how-to-fix-a-systemstackerror-stack-level-too-deep-error-with-a-large-amount", "title": "How to fix a &#39;SystemStackError: stack level too deep&#39; error with a large amount of ActiveRecord conditions", "body": "<p>I have an ActiveRecord query which iteratively adds or conditions to a search:</p>\n\n<pre><code>places.each do |place|\n  people = people.or(People.within_radius_of(place.latitude, place.longitude, place.radius).select(:id))\nend\n\nscope :within_radius_of, -&gt;(lat = nil, lon = nil, radius = 100_000) {\n  where(earth_box(lat, lon, radius)).where(earth_distance_less_than(lat, lon, radius)) if lat.present? &amp;&amp; lon.present?\n}\n</code></pre>\n\n<p><code>earth_box</code> and <code>earth_distance_less_than</code> are just functions to generate postgresql sql for <code>earth_box</code> and <code>earth_distance</code> queries.</p>\n\n<p>This works without issue with our original max target of 100 places, but 600 places were added to a search and I get the stack level too deep issue.</p>\n\n<p>What are the implications of increasing the stack size?  Default is 1MB, for example what issues might occur if I set it to 8MB or more?</p>\n\n<p>Can this query be rewritten to avoid the error?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-5", "amazon-elastic-beanstalk"], "comments": [{"owner": {"reputation": 5237, "user_id": 2325924, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/XSXrT.jpg?s=128&g=1", "display_name": "7urkm3n", "link": "https://stackoverflow.com/users/2325924/7urkm3n"}, "edited": false, "score": 0, "creation_date": 1545864327, "post_id": 53937817, "comment_id": 94715867, "body": "what exactly log you are getting while deploying process ?  also, can u goto eb dashboard and logs get last 100lines of logs."}, {"owner": {"reputation": 2960, "user_id": 7426461, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/Ldwxy.jpg?s=128&g=1", "display_name": "Cannon Moyer", "link": "https://stackoverflow.com/users/7426461/cannon-moyer"}, "reply_to_user": {"reputation": 5237, "user_id": 2325924, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/XSXrT.jpg?s=128&g=1", "display_name": "7urkm3n", "link": "https://stackoverflow.com/users/2325924/7urkm3n"}, "edited": false, "score": 0, "creation_date": 1545864858, "post_id": 53937817, "comment_id": 94715971, "body": "@7urkm3n That&#39;s the exact error that is in puma.log file. The dashboard says nothing more than a status of <code>Warning</code> for my overall instance health and a status of <code>Degraded</code> for my single instance status. I get a 504 Gateway Timeout error when trying to access the site from the browser."}, {"owner": {"reputation": 5237, "user_id": 2325924, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/XSXrT.jpg?s=128&g=1", "display_name": "7urkm3n", "link": "https://stackoverflow.com/users/2325924/7urkm3n"}, "edited": false, "score": 0, "creation_date": 1545865308, "post_id": 53937817, "comment_id": 94716049, "body": "No, you have to goto EB  dashboard/logs and get last log. Its supposed tobe different than this as i remember. And i dnt know what&#39;s <code>psych.rb</code> line <code>line 83</code>. Make sure running production app in localhost 1st."}, {"owner": {"reputation": 2960, "user_id": 7426461, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/Ldwxy.jpg?s=128&g=1", "display_name": "Cannon Moyer", "link": "https://stackoverflow.com/users/7426461/cannon-moyer"}, "reply_to_user": {"reputation": 5237, "user_id": 2325924, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/XSXrT.jpg?s=128&g=1", "display_name": "7urkm3n", "link": "https://stackoverflow.com/users/2325924/7urkm3n"}, "edited": false, "score": 0, "creation_date": 1545865370, "post_id": 53937817, "comment_id": 94716062, "body": "Yep, that&#39;s where this error came from &quot;EB dashboard/logs and get last log&quot;. Btw I have this app running on a Heroku server but I am moving to AWS for pricing purposes. @7urkm3n"}, {"owner": {"reputation": 6462, "user_id": 3784008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/55ou4.jpg?s=128&g=1", "display_name": "anothermh", "link": "https://stackoverflow.com/users/3784008/anothermh"}, "edited": false, "score": 0, "creation_date": 1545869052, "post_id": 53937817, "comment_id": 94716731, "body": "Please correctly format your stack trace by using a <a href=\"https://stackoverflow.com/help/formatting\">code block</a> and not inline code."}, {"owner": {"reputation": 1584, "user_id": 1753903, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5bb8d7b970212f0d2e14a9f4ed53dd9?s=128&d=identicon&r=PG", "display_name": "littleforest", "link": "https://stackoverflow.com/users/1753903/littleforest"}, "edited": false, "score": 0, "creation_date": 1546103902, "post_id": 53937817, "comment_id": 94780956, "body": "What is on line 96 of your <code>config&#47;environments&#47;production.rb</code> file?"}], "answers": [{"tags": [], "owner": {"reputation": 1860, "user_id": 1368534, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/d31056821ec09f3b00e43ee70ebec444?s=128&d=identicon&r=PG", "display_name": "mdegis", "link": "https://stackoverflow.com/users/1368534/mdegis"}, "is_accepted": false, "score": 0, "last_activity_date": 1545905821, "creation_date": 1545905821, "answer_id": 53943338, "question_id": 53937817, "link": "https://stackoverflow.com/questions/53937817/error-deploying-on-elastic-beanstalk-rails/53943338#53943338", "title": "Error Deploying on Elastic Beanstalk - Rails", "body": "<p>If you have any .json manifest files under <code>app/shared/assets</code> try to delete them.</p>\n\n<p>Also this error may accrue because of bad YAML file. You can check this via running this little script (in your Rails root directory) that finds all *.yml files recursively in all sub-directories and tests the file.</p>\n\n<pre><code>require 'yaml'\n\nd = Dir[\"./**/*.yml\"]\nd.each do |file|\n  begin\n    puts \"checking : #{file}\"\n    f =  YAML.load_file(file)\n  rescue StandardError\n    puts \"failed to read #{file}: #{$!}\"\n  end\nend\n</code></pre>\n"}], "owner": {"reputation": 2960, "user_id": 7426461, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/Ldwxy.jpg?s=128&g=1", "display_name": "Cannon Moyer", "link": "https://stackoverflow.com/users/7426461/cannon-moyer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 668, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1545922130, "creation_date": 1545863303, "last_edit_date": 1545922130, "question_id": 53937817, "link": "https://stackoverflow.com/questions/53937817/error-deploying-on-elastic-beanstalk-rails", "title": "Error Deploying on Elastic Beanstalk - Rails", "body": "<p>I'm trying to deploy a custom project on Elastic Beanstalk but I'm getting the following error in my puma.log file when puma is started. I'm not sure how to fix this. I assume it might be with my <code>yaml</code> parser but I'm not entirely sure how to update that using EB. Any help would be appreciated.</p>\n\n<pre><code>=== puma startup: 2018-12-26 22:06:02 +0000 ===\n/opt/rubies/ruby-2.5.3/lib/ruby/2.5.0/psych.rb:402:in 'parse': (&lt;unknown&gt;): did not find expected alphabetic or numeric character while scanning an alias at line 83 column 22 (Psych::SyntaxError)\nfrom /opt/rubies/ruby-2.5.3/lib/ruby/2.5.0/psych.rb:402:in 'parse_stream'\nfrom /opt/rubies/ruby-2.5.3/lib/ruby/2.5.0/psych.rb:350:in 'parse'\nfrom /opt/rubies/ruby-2.5.3/lib/ruby/2.5.0/psych.rb:263:in 'load'\nfrom /opt/rubies/ruby-2.5.3/lib/ruby/gems/2.5.0/gems/railties-5.1.6.1/lib/rails/secrets.rb:27:in 'block in parse'\nfrom /opt/rubies/ruby-2.5.3/lib/ruby/gems/2.5.0/gems/railties-5.1.6.1/lib/rails/secrets.rb:24:in 'each'\nfrom /opt/rubies/ruby-2.5.3/lib/ruby/gems/2.5.0/gems/railties-5.1.6.1/lib/rails/secrets.rb:24:in 'each_with_object'\nfrom /opt/rubies/ruby-2.5.3/lib/ruby/gems/2.5.0/gems/railties-5.1.6.1/lib/rails/secrets.rb:24:in 'parse'\nfrom /opt/rubies/ruby-2.5.3/lib/ruby/gems/2.5.0/gems/railties-5.1.6.1/lib/rails/application.rb:391:in 'secrets'\nfrom /var/app/current/config/environments/production.rb:96:in 'block in &lt;top (required)&gt;'\nfrom /opt/rubies/ruby-2.5.3/lib/ruby/gems/2.5.0/gems/railties-5.1.6.1/lib/rails/railtie.rb:211:in 'instance_eval'\nfrom /opt/rubies/ruby-2.5.3/lib/ruby/gems/2.5.0/gems/railties-5.1.6.1/lib/rails/railtie.rb:211:in 'configure'\nfrom /var/app/current/config/environments/production.rb:1:in '&lt;top (required)&gt;'\nfrom /opt/rubies/ruby-2.5.3/lib/ruby/gems/2.5.0/gems/activesupport-5.1.6.1/lib/active_support/dependencies.rb:292:in 'require'\nfrom /opt/rubies/ruby-2.5.3/lib/ruby/gems/2.5.0/gems/activesupport-5.1.6.1/lib/active_support/dependencies.rb:292:in 'block in require'\nfrom /opt/rubies/ruby-2.5.3/lib/ruby/gems/2.5.0/gems/activesupport-5.1.6.1/lib/active_support/dependencies.rb:258:in 'load_dependency'\nfrom /opt/rubies/ruby-2.5.3/lib/ruby/gems/2.5.0/gems/activesupport-5.1.6.1/lib/active_support/dependencies.rb:292:in 'require'\nfrom /opt/rubies/ruby-2.5.3/lib/ruby/gems/2.5.0/gems/railties-5.1.6.1/lib/rails/engine.rb:600:in 'block (2 levels) in &lt;class:Engine&gt;'\nfrom /opt/rubies/ruby-2.5.3/lib/ruby/gems/2.5.0/gems/railties-5.1.6.1/lib/rails/engine.rb:599:in 'each'\nfrom /opt/rubies/ruby-2.5.3/lib/ruby/gems/2.5.0/gems/railties-5.1.6.1/lib/rails/engine.rb:599:in 'block in &lt;class:Engine&gt;'\nfrom /opt/rubies/ruby-2.5.3/lib/ruby/gems/2.5.0/gems/railties-5.1.6.1/lib/rails/initializable.rb:30:in 'instance_exec'\nfrom /opt/rubies/ruby-2.5.3/lib/ruby/gems/2.5.0/gems/railties-5.1.6.1/lib/rails/initializable.rb:30:in 'run'\nfrom /opt/rubies/ruby-2.5.3/lib/ruby/gems/2.5.0/gems/railties-5.1.6.1/lib/rails/initializable.rb:59:in 'block in run_initializers'\nfrom /opt/rubies/ruby-2.5.3/lib/ruby/2.5.0/tsort.rb:228:in 'block in tsort_each'\nfrom /opt/rubies/ruby-2.5.3/lib/ruby/2.5.0/tsort.rb:350:in 'block (2 levels) in each_strongly_connected_component'\nfrom /opt/rubies/ruby-2.5.3/lib/ruby/2.5.0/tsort.rb:422:in 'block (2 levels) in each_strongly_connected_component_from'\nfrom /opt/rubies/ruby-2.5.3/lib/ruby/2.5.0/tsort.rb:431:in 'each_strongly_connected_component_from'\nfrom /opt/rubies/ruby-2.5.3/lib/ruby/2.5.0/tsort.rb:421:in 'block in each_strongly_connected_component_from'\nfrom /opt/rubies/ruby-2.5.3/lib/ruby/gems/2.5.0/gems/railties-5.1.6.1/lib/rails/initializable.rb:48:in 'each'\nfrom /opt/rubies/ruby-2.5.3/lib/ruby/gems/2.5.0/gems/railties-5.1.6.1/lib/rails/initializable.rb:48:in 'tsort_each_child'\nfrom /opt/rubies/ruby-2.5.3/lib/ruby/2.5.0/tsort.rb:415:in 'call'\nfrom /opt/rubies/ruby-2.5.3/lib/ruby/2.5.0/tsort.rb:415:in 'each_strongly_connected_component_from'\nfrom /opt/rubies/ruby-2.5.3/lib/ruby/2.5.0/tsort.rb:349:in 'block in each_strongly_connected_component'\nfrom /opt/rubies/ruby-2.5.3/lib/ruby/2.5.0/tsort.rb:347:in 'each'\nfrom /opt/rubies/ruby-2.5.3/lib/ruby/2.5.0/tsort.rb:347:in 'call'\nfrom /opt/rubies/ruby-2.5.3/lib/ruby/2.5.0/tsort.rb:347:in 'each_strongly_connected_component'\nfrom /opt/rubies/ruby-2.5.3/lib/ruby/2.5.0/tsort.rb:226:in 'tsort_each'\nfrom /opt/rubies/ruby-2.5.3/lib/ruby/2.5.0/tsort.rb:205:in 'tsort_each'\nfrom /opt/rubies/ruby-2.5.3/lib/ruby/gems/2.5.0/gems/railties-5.1.6.1/lib/rails/initializable.rb:58:in 'run_initializers'\nfrom /opt/rubies/ruby-2.5.3/lib/ruby/gems/2.5.0/gems/railties-5.1.6.1/lib/rails/application.rb:353:in 'initialize!'\nfrom /var/app/current/config/environment.rb:5:in '&lt;top (required)&gt;'\nfrom config.ru:3:in 'require_relative'\nfrom config.ru:3:in 'block in &lt;main&gt;'\nfrom /opt/rubies/ruby-2.5.3/lib/ruby/gems/2.5.0/gems/rack-2.0.6/lib/rack/builder.rb:55:in 'instance_eval'\nfrom /opt/rubies/ruby-2.5.3/lib/ruby/gems/2.5.0/gems/rack-2.0.6/lib/rack/builder.rb:55:in 'initialize'\nfrom config.ru:in 'new'\nfrom config.ru:in '&lt;main&gt;'\nfrom /opt/rubies/ruby-2.5.3/lib/ruby/gems/2.5.0/gems/rack-2.0.6/lib/rack/builder.rb:49:in 'eval'\nfrom /opt/rubies/ruby-2.5.3/lib/ruby/gems/2.5.0/gems/rack-2.0.6/lib/rack/builder.rb:49:in 'new_from_string'\nfrom /opt/rubies/ruby-2.5.3/lib/ruby/gems/2.5.0/gems/rack-2.0.6/lib/rack/builder.rb:40:in 'parse_file'\nfrom /opt/rubies/ruby-2.5.3/lib/ruby/gems/2.5.0/gems/puma-3.12.0/lib/puma/configuration.rb:318:in 'load_rackup'\nfrom /opt/rubies/ruby-2.5.3/lib/ruby/gems/2.5.0/gems/puma-3.12.0/lib/puma/configuration.rb:243:in 'app'\nfrom /opt/rubies/ruby-2.5.3/lib/ruby/gems/2.5.0/gems/puma-3.12.0/lib/puma/runner.rb:155:in 'app'\nfrom /opt/rubies/ruby-2.5.3/lib/ruby/gems/2.5.0/gems/puma-3.12.0/lib/puma/runner.rb:162:in 'start_server'\nfrom /opt/rubies/ruby-2.5.3/lib/ruby/gems/2.5.0/gems/puma-3.12.0/lib/puma/cluster.rb:273:in 'worker'\nfrom /opt/rubies/ruby-2.5.3/lib/ruby/gems/2.5.0/gems/puma-3.12.0/lib/puma/cluster.rb:137:in 'block (2 levels) in spawn_workers'\nfrom /opt/rubies/ruby-2.5.3/lib/ruby/gems/2.5.0/gems/puma-3.12.0/lib/puma/cluster.rb:137:in 'fork'\nfrom /opt/rubies/ruby-2.5.3/lib/ruby/gems/2.5.0/gems/puma-3.12.0/lib/puma/cluster.rb:137:in 'block in spawn_workers'\nfrom /opt/rubies/ruby-2.5.3/lib/ruby/gems/2.5.0/gems/puma-3.12.0/lib/puma/cluster.rb:133:in 'times'\nfrom /opt/rubies/ruby-2.5.3/lib/ruby/gems/2.5.0/gems/puma-3.12.0/lib/puma/cluster.rb:133:in 'spawn_workers'\nfrom /opt/rubies/ruby-2.5.3/lib/ruby/gems/2.5.0/gems/puma-3.12.0/lib/puma/cluster.rb:466:in 'run'\nfrom /opt/rubies/ruby-2.5.3/lib/ruby/gems/2.5.0/gems/puma-3.12.0/lib/puma/launcher.rb:184:in 'run'\nfrom /opt/rubies/ruby-2.5.3/lib/ruby/gems/2.5.0/gems/puma-3.12.0/lib/puma/cli.rb:78:in 'run'\nfrom /opt/rubies/ruby-2.5.3/lib/ruby/gems/2.5.0/gems/puma-3.12.0/bin/puma:10:in '&lt;top (required)&gt;'\nfrom /opt/rubies/ruby-2.5.3/bin/puma:23:in 'load'\nfrom /opt/rubies/ruby-2.5.3/bin/puma:23:in '&lt;top (required)&gt;'\nfrom /opt/rubies/ruby-2.5.3/lib/ruby/site_ruby/2.5.0/bundler/cli/exec.rb:74:in 'load'\nfrom /opt/rubies/ruby-2.5.3/lib/ruby/site_ruby/2.5.0/bundler/cli/exec.rb:74:in 'kernel_load'\nfrom /opt/rubies/ruby-2.5.3/lib/ruby/site_ruby/2.5.0/bundler/cli/exec.rb:28:in 'run'\nfrom /opt/rubies/ruby-2.5.3/lib/ruby/site_ruby/2.5.0/bundler/cli.rb:424:in 'exec'\nfrom /opt/rubies/ruby-2.5.3/lib/ruby/site_ruby/2.5.0/bundler/vendor/thor/lib/thor/command.rb:27:in 'run'\nfrom /opt/rubies/ruby-2.5.3/lib/ruby/site_ruby/2.5.0/bundler/vendor/thor/lib/thor/invocation.rb:126:in 'invoke_command'\nfrom /opt/rubies/ruby-2.5.3/lib/ruby/site_ruby/2.5.0/bundler/vendor/thor/lib/thor.rb:387:in 'dispatch'\nfrom /opt/rubies/ruby-2.5.3/lib/ruby/site_ruby/2.5.0/bundler/cli.rb:27:in 'dispatch'\nfrom /opt/rubies/ruby-2.5.3/lib/ruby/site_ruby/2.5.0/bundler/vendor/thor/lib/thor/base.rb:466:in 'start'\nfrom /opt/rubies/ruby-2.5.3/lib/ruby/site_ruby/2.5.0/bundler/cli.rb:18:in 'start'\nfrom /opt/rubies/ruby-2.5.3/lib/ruby/gems/2.5.0/gems/bundler-1.16.2/exe/bundle:30:in 'block in &lt;top (required)&gt;'\nfrom /opt/rubies/ruby-2.5.3/lib/ruby/site_ruby/2.5.0/bundler/friendly_errors.rb:124:in 'with_friendly_errors'\nfrom /opt/rubies/ruby-2.5.3/lib/ruby/gems/2.5.0/gems/bundler-1.16.2/exe/bundle:22:in '&lt;top (required)&gt;'\nfrom /opt/rubies/ruby-2.5.3/bin/bundle:23:in 'load'\nfrom /opt/rubies/ruby-2.5.3/bin/bundle:23:in '&lt;main&gt;'\n</code></pre>\n\n<p>I reviewed the logs again today to make sure I hadn't missed anything and I did see another reference to the same error in a different log file but it still tells me very little. </p>\n\n<pre><code>-------------------------------------\n/var/log/eb-commandprocessor.log\n-------------------------------------\n++ [[ -z /opt/rubies/ruby-2.5.3 ]]\n++ shift\n++ chruby_use /opt/rubies/ruby-2.5.3 ''\n++ [[ ! -x /opt/rubies/ruby-2.5.3/bin/ruby ]]\n++ [[ -n '' ]]\n++ export RUBY_ROOT=/opt/rubies/ruby-2.5.3\n++ RUBY_ROOT=/opt/rubies/ruby-2.5.3\n++ export RUBYOPT=\n++ RUBYOPT=\n++ export PATH=/opt/rubies/ruby-2.5.3/bin:/opt/elasticbeanstalk/lib/ruby/bin:/usr/local/sbin:/usr/local/bin:/usr/bin:/usr/sbin:/sbin:/bin\n++ PATH=/opt/rubies/ruby-2.5.3/bin:/opt/elasticbeanstalk/lib/ruby/bin:/usr/local/sbin:/usr/local/bin:/usr/bin:/usr/sbin:/sbin:/bin\n+++ /opt/rubies/ruby-2.5.3/bin/ruby -\n++ eval 'export RUBY_ENGINE=ruby;\nexport RUBY_VERSION=2.5.3;\nexport GEM_ROOT=\"/opt/rubies/ruby-2.5.3/lib/ruby/gems/2.5.0\";'\n+++ export RUBY_ENGINE=ruby\n+++ RUBY_ENGINE=ruby\n+++ export RUBY_VERSION=2.5.3\n+++ RUBY_VERSION=2.5.3\n+++ export GEM_ROOT=/opt/rubies/ruby-2.5.3/lib/ruby/gems/2.5.0\n+++ GEM_ROOT=/opt/rubies/ruby-2.5.3/lib/ruby/gems/2.5.0\n++ ((  0 != 0  ))\n+ cd /var/app/ondeck\n+ su -s /bin/bash -c 'bundle exec /opt/elasticbeanstalk/support/scripts/check-for-rake-task.rb assets:precompile' webapp\n`/home/webapp` is not a directory.\nBundler will use `/tmp/bundler/home/webapp' as your home directory temporarily.\n+ '[' false == true ']'\n+ su -s /bin/bash -c 'bundle exec rake assets:precompile' webapp\n`/home/webapp` is not a directory.\nBundler will use `/tmp/bundler/home/webapp' as your home directory temporarily.\nrake aborted!\nPsych::SyntaxError: (&lt;unknown&gt;): did not find expected alphabetic or numeric character while scanning an alias at line 83 column 22\n/var/app/ondeck/config/environments/production.rb:96:in `block in &lt;top (required)&gt;'\n/var/app/ondeck/config/environments/production.rb:1:in `&lt;top (required)&gt;'\n/var/app/ondeck/config/environment.rb:5:in `&lt;top (required)&gt;'\n/opt/rubies/ruby-2.5.3/bin/bundle:23:in `load'\n/opt/rubies/ruby-2.5.3/bin/bundle:23:in `&lt;main&gt;'\nTasks: TOP =&gt; environment\n(See full trace by running task with --trace) (Executor::NonZeroExitStatus)\n</code></pre>\n"}, {"tags": ["ruby", "ruby-on-rails-4", "selenium-webdriver"], "comments": [{"owner": {"reputation": 6462, "user_id": 3784008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/55ou4.jpg?s=128&g=1", "display_name": "anothermh", "link": "https://stackoverflow.com/users/3784008/anothermh"}, "edited": false, "score": 0, "creation_date": 1545859964, "post_id": 53937308, "comment_id": 94714770, "body": "Please do not post images of code. <a href=\"https://meta.stackoverflow.com/a/285557/3784008\">Images of code are not appropriate on StackOverflow</a>. You have access to the plaintext; please copy and paste the code into your question."}, {"owner": {"reputation": 1, "user_id": 8050080, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb11f829cbdf336165ebea54e4726c3d?s=128&d=identicon&r=PG&f=1", "display_name": "peckalo", "link": "https://stackoverflow.com/users/8050080/peckalo"}, "reply_to_user": {"reputation": 6462, "user_id": 3784008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/55ou4.jpg?s=128&g=1", "display_name": "anothermh", "link": "https://stackoverflow.com/users/3784008/anothermh"}, "edited": false, "score": 0, "creation_date": 1545861114, "post_id": 53937308, "comment_id": 94715129, "body": "thanks:-)question was corrected"}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 8050080, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb11f829cbdf336165ebea54e4726c3d?s=128&d=identicon&r=PG&f=1", "display_name": "peckalo", "link": "https://stackoverflow.com/users/8050080/peckalo"}, "is_accepted": false, "score": 0, "last_activity_date": 1546452121, "creation_date": 1546452121, "answer_id": 54011055, "question_id": 53937308, "link": "https://stackoverflow.com/questions/53937308/how-to-click-on-link-using-selenium-in-ruby-on-rails/54011055#54011055", "title": "How to click on link using Selenium in Ruby on Rails?", "body": "<p>I have found the correct answer for it:</p>\n\n<pre>wait.until { @browser_def.find_elements(css: 'a[href$=\"/reports\"] div.clickable').first}.click()</pre>\n"}], "owner": {"reputation": 1, "user_id": 8050080, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb11f829cbdf336165ebea54e4726c3d?s=128&d=identicon&r=PG&f=1", "display_name": "peckalo", "link": "https://stackoverflow.com/users/8050080/peckalo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 142, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1546452121, "creation_date": 1545859344, "last_edit_date": 1545861050, "question_id": 53937308, "link": "https://stackoverflow.com/questions/53937308/how-to-click-on-link-using-selenium-in-ruby-on-rails", "title": "How to click on link using Selenium in Ruby on Rails?", "body": "<p>HTML code:\n</p>\n\n<pre><code>  &lt;div class=\"card-body\"&gt;\n\n    &lt;div class=\"row align-items-center mb-4\"&gt;\n      &lt;div class=\"col\"&gt;\n        &lt;h1&gt;Data and Tools&lt;/h1&gt;\n      &lt;/div&gt;\n    &lt;/div&gt;\n\n      &lt;a href=\"/reports\"&gt;\n        &lt;div class=\"row my-4 align-items-center clickable\"&gt;\n          &lt;div class=\"col my-3\"&gt;\n            &lt;span class=\"semi-bold\"&gt;Reports&lt;/span&gt;\n            &lt;div class=\"stamp-md\"&gt;\n              Create, run and schedule reports.\n            &lt;/div&gt;\n          &lt;/div&gt;\n          &lt;div class=\"col-1 text-right\"&gt;\n            &lt;i class=\"fas fa-chevron-right gray-light small\"&gt;&lt;/i&gt;\n          &lt;/div&gt;\n        &lt;/div&gt;\n      &lt;/a&gt;\n      &lt;hr class=\"inner-divider\"&gt;\n</code></pre>\n\n<p>Ruby code:</p>\n\n<pre>wait.until { @browser_def.find_element(css: \".card-body > a\")}.attribute(\"href\").text(\"Reports\").click()</pre>\n\n<p>How can I click link which stands for 'Reports'?</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "answers": [{"comments": [{"owner": {"reputation": 1618, "user_id": 7281091, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LeIC6.jpg?s=128&g=1", "display_name": "sameera lakshitha", "link": "https://stackoverflow.com/users/7281091/sameera-lakshitha"}, "edited": false, "score": 0, "creation_date": 1545857187, "post_id": 53936852, "comment_id": 94713967, "body": "It&#39;s helped me. Thanks a lot."}, {"owner": {"reputation": 167912, "user_id": 240443, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/495d675e3bc42ed1dee469e2ce701f1b?s=128&d=identicon&r=PG", "display_name": "Amadan", "link": "https://stackoverflow.com/users/240443/amadan"}, "edited": false, "score": 0, "creation_date": 1545883219, "post_id": 53936852, "comment_id": 94718720, "body": "While Ruby gets the time from the server it is running on, the server itself can either be counting from the last time it got set, just like a regular clock (and just like a regular clock, it can start going fast or lagging behind, or even get reset if its battery gets drained), or it could be getting synchronised with the several super-precise reference clocks around the world using NTP (Network Time Protocol), if it is set up on the server."}], "tags": [], "owner": {"reputation": 56502, "user_id": 271475, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b00f41e5f2a69734051f2a78f4f3785?s=128&d=identicon&r=PG", "display_name": "Chris Heald", "link": "https://stackoverflow.com/users/271475/chris-heald"}, "is_accepted": true, "score": 0, "last_activity_date": 1545856303, "creation_date": 1545856303, "answer_id": 53936852, "question_id": 53936813, "link": "https://stackoverflow.com/questions/53936813/where-ruby-get-date-time-from/53936852#53936852", "title": "Where Ruby get date, time from?", "body": "<p><a href=\"https://ruby-doc.org/core-2.2.0/Time.html#method-c-new\" rel=\"nofollow noreferrer\">https://ruby-doc.org/core-2.2.0/Time.html#method-c-new</a></p>\n\n<p>Unless given a time during initialization of a Time instance, Ruby uses the type from the system it is running on.</p>\n\n<p>If you want the current time on a user's device in a Rails project, you'll need to capture it with Javascript and pass it back to your Rails application.</p>\n"}], "owner": {"reputation": 1618, "user_id": 7281091, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LeIC6.jpg?s=128&g=1", "display_name": "sameera lakshitha", "link": "https://stackoverflow.com/users/7281091/sameera-lakshitha"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 178, "favorite_count": 0, "accepted_answer_id": 53936852, "answer_count": 1, "score": -1, "last_activity_date": 1569074271, "creation_date": 1545856063, "last_edit_date": 1569074271, "question_id": 53936813, "link": "https://stackoverflow.com/questions/53936813/where-ruby-get-date-time-from", "title": "Where Ruby get date, time from?", "body": "<p>I am working in ruby, I have an object containing today's date, time from DB and only want time truncating the date. I can get,</p>\n\n<pre><code>DateTime.now.strftime(\"%H:%M\")\n</code></pre>\n\n<p>I'm curious about where Ruby get date and time from? From internet, device or browser?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "devise-token-auth"], "answers": [{"tags": [], "owner": {"reputation": 71, "user_id": 9481404, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-ZzfX_BGjBbc/AAAAAAAAAAI/AAAAAAAAANQ/GKth3iQ9iaY/photo.jpg?sz=128", "display_name": "iseitz", "link": "https://stackoverflow.com/users/9481404/iseitz"}, "is_accepted": false, "score": 0, "last_activity_date": 1555584412, "creation_date": 1555584412, "answer_id": 55744418, "question_id": 53936770, "link": "https://stackoverflow.com/questions/53936770/cant-figure-out-how-to-update-users-with-devise-token-auth-gem/55744418#55744418", "title": "Can&#39;t figure out how to update users with devise_token_auth gem", "body": "<p>Looks like the user does not get saved somehow. I would try adding <code>:create</code> to the <code>resource :profile, only: [:show, :create]</code> in routes.rb. I am just learning RoR an Devise so I can't say that it is a 100% cure but worth a try. Following the same logic, you can add the <code>:edit</code> and <code>:destroy</code> actions to edit/delete profile/user. </p>\n"}], "owner": {"reputation": 525, "user_id": 5738801, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/c553a41f99cffb2fde3625ab070da256?s=128&d=identicon&r=PG", "display_name": "ngust", "link": "https://stackoverflow.com/users/5738801/ngust"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 616, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1555584412, "creation_date": 1545855809, "question_id": 53936770, "link": "https://stackoverflow.com/questions/53936770/cant-figure-out-how-to-update-users-with-devise-token-auth-gem", "title": "Can&#39;t figure out how to update users with devise_token_auth gem", "body": "<p>I'm working on a rails API that is meant to work with a VUE frontend.  This is my first time working with rails as an API only.</p>\n\n<p>I'm familiar with using devise for user authentication in other rails apps.</p>\n\n<p>Our sign in works, same with logout.  I can't figure out how to edit and delete users though.</p>\n\n<p>My rake routes shows this:</p>\n\n<pre><code>        new_api_user_session GET      /api/v1/auth/sign_in(.:format)                            devise_token_auth/sessions#new\n            api_user_session POST     /api/v1/auth/sign_in(.:format)                            devise_token_auth/sessions#create\n    destroy_api_user_session DELETE   /api/v1/auth/sign_out(.:format)                           devise_token_auth/sessions#destroy\n       new_api_user_password GET      /api/v1/auth/password/new(.:format)                       devise_token_auth/passwords#new\n      edit_api_user_password GET      /api/v1/auth/password/edit(.:format)                      devise_token_auth/passwords#edit\n           api_user_password PATCH    /api/v1/auth/password(.:format)                           devise_token_auth/passwords#update\ncancel_api_user_registration GET      /api/v1/auth/cancel(.:format)                             devise_token_auth/registrations#cancel\n   new_api_user_registration GET      /api/v1/auth/sign_up(.:format)                            devise_token_auth/registrations#new\n  edit_api_user_registration GET      /api/v1/auth/edit(.:format)                               devise_token_auth/registrations#edit\n       api_user_registration PATCH    /api/v1/auth(.:format)                                    devise_token_auth/registrations#update\n</code></pre>\n\n<p>My routes.rb is like so:</p>\n\n<pre><code>Rails.application.routes.draw do\n\n  root 'home#index'\n\n  namespace :api do\n    scope :v1 do\n      resource :profile, only: [:show]\n      mount_devise_token_auth_for \"User\", at: 'auth'\n\n     ## other code\n    end\n  end\n\nend\n</code></pre>\n\n<p>I'm testing the api using CURL.  The following command can successfully log in:</p>\n\n<pre><code>curl -X POST -v -H 'Content-Type: application/json' http://localhost:3000/api/v1/auth/sign_in -d '{\"email\": \"test@example.com\", \"password\": \"password\"}'\n</code></pre>\n\n<p>That works OK.</p>\n\n<p>The route for updating a user should be <a href=\"http://localhost:3000/api/v1/auth/\" rel=\"nofollow noreferrer\">http://localhost:3000/api/v1/auth/</a></p>\n\n<p>The sign in gives me the client and access-token values.  When I pop those into the following curl command I expect the user to update.  The attribute that I'm trying to update is \"sortOrder\".</p>\n\n<pre><code>curl -X PATCH -v -H 'Content-Type: application/json' -H 'access-token: XUbhcAgWlVnARf9Ps4rjR' -H 'client: Lxg5us7MpUyAuM5xQGNuqg'  -H 'uid: test@example.com' http://localhost:3000/api/v1/auth/ -d '{\"sortOrder\": \"DESC\"}'\n</code></pre>\n\n<p>From that command, my rails log shows:</p>\n\n<pre><code>Started PATCH \"/api/v1/auth/\" for 127.0.0.1 at 2018-12-26 12:10:53 -0800\nProcessing by DeviseTokenAuth::RegistrationsController#update as */*\n  Parameters: {\"sortOrder\"=&gt;\"DESC\", \"registration\"=&gt;{\"sortOrder\"=&gt;\"DESC\"}}\n  User Load (0.6ms)  SELECT  `users`.* FROM `users` WHERE `users`.`uid` = 'test@example.com' LIMIT 1\nUnpermitted parameter: registration\nCompleted 404 Not Found in 101ms (Views: 0.3ms | ActiveRecord: 0.6ms)\n</code></pre>\n\n<p>The output from the curl command is:</p>\n\n<pre><code>*   Trying 127.0.0.1...\n* Connected to localhost (127.0.0.1) port 3000 (#0)\n&gt; PATCH /api/v1/auth/ HTTP/1.1\n&gt; Host: localhost:3000\n&gt; User-Agent: curl/7.47.0\n&gt; Accept: */*\n&gt; Content-Type: application/json\n&gt; access-token: XUbhcAgWlVnARf9Ps4rjR\n&gt; client: Lxg5us7MpUyAuM5xQGNuqg\n&gt; uid: test@example.com\n&gt; Content-Length: 50\n&gt; \n* upload completely sent off: 50 out of 50 bytes\n&lt; HTTP/1.1 404 Not Found\n&lt; X-Frame-Options: SAMEORIGIN\n&lt; X-XSS-Protection: 1; mode=block\n&lt; X-Content-Type-Options: nosniff\n&lt; Content-Type: application/json; charset=utf-8\n&lt; Cache-Control: no-cache\n&lt; X-Request-Id: 1e5e61f6-1226-43dc-b8b3-30a576b0c03a\n&lt; X-Runtime: 0.104965\n&lt; Vary: Origin\n&lt; Transfer-Encoding: chunked\n&lt; \n* Connection #0 to host localhost left intact\n{\"success\":false,\"errors\":[\"User not found.\"],\"status\":\"error\"}\n</code></pre>\n\n<p>I'm not sure what I'm missing here.  With this devise set up I don't have access to the devise/registrations controller. I could probably create my own but this should work.  I haven't been able to find documentation for the devise_token_auth gem that addresses user updates and delete.</p>\n\n<p>The result that I'm getting seems to be \"user not found\".  I've tried several ways to get the user UID, email and id in the request but nothing seems to work.  Has anyone experienced this before?</p>\n"}, {"tags": ["ruby", "qt", "homebrew"], "comments": [{"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1545849202, "post_id": 53935730, "comment_id": 94711644, "body": "Looks like you <code>sha256</code> is incorrect."}, {"owner": {"reputation": 9249, "user_id": 118125, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/617e5dd459d1527261644fb4adf3a41f?s=128&d=identicon&r=PG", "display_name": "Martin Delille", "link": "https://stackoverflow.com/users/118125/martin-delille"}, "reply_to_user": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1545904136, "post_id": 53935730, "comment_id": 94724584, "body": "It should be correct because if I remove it it complains about the <code>sha256</code> as expected."}, {"owner": {"reputation": 14471, "user_id": 735926, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/6b5fa39f5bc4b397eb7e55766eecd8c4?s=128&d=identicon&r=PG", "display_name": "bfontaine", "link": "https://stackoverflow.com/users/735926/bfontaine"}, "edited": false, "score": 1, "creation_date": 1546866961, "post_id": 53935730, "comment_id": 94983114, "body": "Please don\u2019t use the <a href=\"https://stackoverflow.com/questions/tagged/brew\">brew</a> tag for Homebrew-related question. I edited your question to use the proper tag."}], "answers": [{"tags": [], "owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "is_accepted": true, "score": 1, "last_activity_date": 1545867059, "last_edit_date": 1545867059, "creation_date": 1545852620, "answer_id": 53936315, "question_id": 53935730, "link": "https://stackoverflow.com/questions/53935730/undefined-method-cmd-when-installing-a-custom-brew-formula/53936315#53936315", "title": "undefined method `cmd&#39; when installing a custom brew formula", "body": "<p>This is a combination of two issues:</p>\n\n<ol>\n<li>There is an error in your formula.</li>\n<li>Homebrew's error reporting was accidentally broken three days ago.</li>\n</ol>\n\n<p>So, Homebrew tries to report the error in your formula, but then runs into a bug in its own error reporting.</p>\n\n<p>It seems that your SHA-256 checksum is not matching. Therefore, Homebrew tries to report the error, but then runs into <a href=\"https://github.com/Homebrew/brew/issues/5443\" rel=\"nofollow noreferrer\">this bug</a> which was <a href=\"https://github.com/Homebrew/brew/commit/b7d84f2d9e6b0c44c712dab7987ee3244f80062a#diff-043c6ff4bb5eb7aa62bf74651a88cabfR205\" rel=\"nofollow noreferrer\">introduced three days before you wrote your question</a> and <a href=\"https://github.com/Homebrew/brew/pull/5444\" rel=\"nofollow noreferrer\">was fixed three hours after</a>.</p>\n\n<p>To fix this, </p>\n\n<ol>\n<li>You need to fix the error in your formula (correct the SHA-256 checksum, or figure out why the checksum does not match the downloaded file)</li>\n<li>Wait until the bug is fixed and update Homebrew, to get proper error reporting back.</li>\n</ol>\n"}], "owner": {"reputation": 9249, "user_id": 118125, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/617e5dd459d1527261644fb4adf3a41f?s=128&d=identicon&r=PG", "display_name": "Martin Delille", "link": "https://stackoverflow.com/users/118125/martin-delille"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 55, "favorite_count": 0, "accepted_answer_id": 53936315, "answer_count": 1, "score": 1, "last_activity_date": 1546866930, "creation_date": 1545849009, "last_edit_date": 1546866930, "question_id": 53935730, "link": "https://stackoverflow.com/questions/53935730/undefined-method-cmd-when-installing-a-custom-brew-formula", "title": "undefined method `cmd&#39; when installing a custom brew formula", "body": "<p>I am creating a <a href=\"https://brew.sh\" rel=\"nofollow noreferrer\">Homebrew</a> formula:</p>\n\n<pre><code>class Pouet &lt; Formula\n  desc \"A basic command line application written with Qt\"\n  homepage \"https://github.com/MartinDelille/pouet\"\n  url \"https://github.com/MartinDelille/pouet\"\n  version \"0.1\"\n  sha256 \"d4222bde4c798bc4d7f0a5566079d9095d4e4996bc53fe8fc76e63325aa0e71c\"\n  depends_on \"qt\" # =&gt; :build\n\n  def install\n    system \"qmake\", \"pouet.pro\"\n    system \"make\"\n    bin.install \"pouet\"\n  end\n\n  test do\n    system \"#{bin}/pouet\"\n  end\nend\n</code></pre>\n\n<p>Unfortunately, I have the following error when trying to install it:</p>\n\n<pre><code>$ brew install pouet\n==&gt; Installing pouet from martindelille/tap\n==&gt; Downloading https://github.com/MartinDelille/pouet\nAlready downloaded: /Users/martin/Library/Caches/Homebrew/downloads/e2994828582a29cbbcc10eac093db7f4c95aab2139f30033de5ed3ed3a3f4ab9--pouet\n/usr/local/Homebrew/Library/Homebrew/build.rb:206:in `rescue in &lt;main&gt;': undefined method `cmd' for #&lt;ChecksumMismatchError:0x00007fcad2a0cae0&gt; (NoMethodError)\n    from /usr/local/Homebrew/Library/Homebrew/build.rb:183:in `&lt;main&gt;'\nError: Failure while executing; `/usr/bin/sandbox-exec -f /private/tmp/homebrew20181226-5110-o03zk0.sb nice /System/Library/Frameworks/Ruby.framework/Versions/2.3/usr/bin/ruby -W0 -I /usr/local/Homebrew/Library/Homebrew/vendor/bundle-standalone/bundler/../ruby/2.3.0/gems/ruby-macho-2.1.0/lib:/usr/local/Homebrew/Library/Homebrew/vendor/bundle-standalone/bundler/../ruby/2.3.0/gems/rubocop-rspec-1.30.1/lib:/usr/local/Homebrew/Library/Homebrew/vendor/bundle-standalone/bundler/../ruby/2.3.0/gems/rubocop-0.61.1/lib:/usr/local/Homebrew/Library/Homebrew/vendor/bundle-standalone/bundler/../ruby/2.3.0/gems/unicode-display_width-1.4.0/lib:/usr/local/Homebrew/Library/Homebrew/vendor/bundle-standalone/bundler/../ruby/2.3.0/gems/ruby-progressbar-1.10.0/lib:/usr/local/Homebrew/Library/Homebrew/vendor/bundle-standalone/bundler/../ruby/2.3.0/gems/rainbow-3.0.0/lib:/usr/local/Homebrew/Library/Homebrew/vendor/bundle-standalone/bundler/../ruby/2.3.0/gems/powerpack-0.1.2/lib:/usr/local/Homebrew/Library/Homebrew/vendor/bundle-standalone/bundler/../ruby/2.3.0/gems/plist-3.4.0/lib:/usr/local/Homebrew/Library/Homebrew/vendor/bundle-standalone/bundler/../ruby/2.3.0/gems/parser-2.5.3.0/lib:/usr/local/Homebrew/Library/Homebrew/vendor/bundle-standalone/bundler/../ruby/2.3.0/gems/parallel-1.12.1/lib:/usr/local/Homebrew/Library/Homebrew/vendor/bundle-standalone/bundler/../ruby/2.3.0/gems/jaro_winkler-1.5.1/lib:/usr/local/Homebrew/Library/Homebrew/vendor/bundle-standalone/bundler/../ruby/2.3.0/extensions/universal-darwin-18/2.3.0/jaro_winkler-1.5.1:/usr/local/Homebrew/Library/Homebrew/vendor/bundle-standalone/bundler/:/usr/local/Homebrew/Library/Homebrew/vendor/bundle-standalone/bundler/../ruby/2.3.0/gems/backports-3.11.4/lib:/usr/local/Homebrew/Library/Homebrew/vendor/bundle-standalone/bundler/../ruby/2.3.0/gems/ast-2.4.0/lib:/usr/local/Homebrew/Library/Homebrew/vendor/bundle-standalone/bundler/../ruby/2.3.0/gems/activesupport-5.2.2/lib:/usr/local/Homebrew/Library/Homebrew/vendor/bundle-standalone/bundler/../ruby/2.3.0/gems/tzinfo-1.2.5/lib:/usr/local/Homebrew/Library/Homebrew/vendor/bundle-standalone/bundler/../ruby/2.3.0/gems/thread_safe-0.3.6/lib:/usr/local/Homebrew/Library/Homebrew/vendor/bundle-standalone/bundler/../ruby/2.3.0/gems/minitest-5.11.3/lib:/usr/local/Homebrew/Library/Homebrew/vendor/bundle-standalone/bundler/../ruby/2.3.0/gems/i18n-1.3.0/lib:/usr/local/Homebrew/Library/Homebrew/vendor/bundle-standalone/bundler/../ruby/2.3.0/gems/concurrent-ruby-1.1.4/lib:/Library/Ruby/Gems/2.3.0/gems/did_you_mean-1.0.0/lib:/Library/Ruby/Site/2.3.0:/Library/Ruby/Site/2.3.0/x86_64-darwin17:/Library/Ruby/Site/2.3.0/universal-darwin17:/Library/Ruby/Site:/System/Library/Frameworks/Ruby.framework/Versions/2.3/usr/lib/ruby/vendor_ruby/2.3.0:/System/Library/Frameworks/Ruby.framework/Versions/2.3/usr/lib/ruby/vendor_ruby/2.3.0/x86_64-darwin17:/System/Library/Frameworks/Ruby.framework/Versions/2.3/usr/lib/ruby/vendor_ruby/2.3.0/universal-darwin17:/System/Library/Frameworks/Ruby.framework/Versions/2.3/usr/lib/ruby/vendor_ruby:/System/Library/Frameworks/Ruby.framework/Versions/2.3/usr/lib/ruby/2.3.0:/System/Library/Frameworks/Ruby.framework/Versions/2.3/usr/lib/ruby/2.3.0/x86_64-darwin17:/System/Library/Frameworks/Ruby.framework/Versions/2.3/usr/lib/ruby/2.3.0/universal-darwin17:/usr/local/Homebrew/Library/Homebrew -- /usr/local/Homebrew/Library/Homebrew/build.rb /usr/local/Homebrew/Library/Taps/martindelille/homebrew-tap/pouet.rb` exited with 1.\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "postgresql"], "answers": [{"tags": [], "owner": {"reputation": 5437, "user_id": 1257094, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/Ob6MH.jpg?s=128&g=1", "display_name": "milgner", "link": "https://stackoverflow.com/users/1257094/milgner"}, "is_accepted": true, "score": 1, "last_activity_date": 1545851278, "creation_date": 1545851278, "answer_id": 53936119, "question_id": 53935672, "link": "https://stackoverflow.com/questions/53935672/rails-scan-activerecord-for-attribute-change/53936119#53936119", "title": "Rails scan ActiveRecord for attribute change", "body": "<p>Here's two ideas that should get you started. For all approaches I suggest encapsulating the business logic for creating a new match in a service object, to avoid the cluttering of the model you already mentioned.</p>\n\n<ul>\n<li><p>immediately after persisting, store the match' id in Redis using a pre-defined TTL. For example using a key in the form <code>matches:open:1234</code>. Whenever you need a list of open matches, just query the keys under <code>matches:open:*</code> and you can use those to do a targeted query on your ActiveRecord DB. Expiration will be completely out of your hair. You can also easily \"touch\" a record if you want to keep the match open for a bit longer. Just pay attention to your database transactions and the possibility of rollbacks: you don't want to write invalid database ids into Redis :)</p></li>\n<li><p>when creating the match, also enqueue a job (either via ActiveJob or a more specific framework like Sidekiq) that retrieves the record and checks whether it has been accepted in the meantime. You can optimize this by using something like <code>where(id: match_id, accepted_at: nil).first</code> and if <code>nil</code> is being returned, you can assume that the match has been accepted in the meantime without having to instantiate the record. If you need functionality to keep a match open for longer than the initial delay, you'll need to search for and cancel the already-enqueued job and enqueue a new one.</p></li>\n</ul>\n\n<p>As for periodically querying all pending matches in a recurring job, it makes protection against race conditions a bit harder with regards to row level locks and also is much harder to scale, so I personally would advise against it.</p>\n"}], "owner": {"reputation": 1583, "user_id": 5253108, "user_type": "registered", "accept_rate": 59, "profile_image": "https://i.stack.imgur.com/o5DQ1.jpg?s=128&g=1", "display_name": "Trenton Tyler", "link": "https://stackoverflow.com/users/5253108/trenton-tyler"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 38, "favorite_count": 0, "accepted_answer_id": 53936119, "answer_count": 1, "score": 0, "last_activity_date": 1545851278, "creation_date": 1545848659, "question_id": 53935672, "link": "https://stackoverflow.com/questions/53935672/rails-scan-activerecord-for-attribute-change", "title": "Rails scan ActiveRecord for attribute change", "body": "<p>I am creating a matchmaking system in my rails application where users can post matches for a certain time. If the time the match is posted for is reached without being accepted I need to void that match by setting its active flag to false.</p>\n\n<p>What would be the best approach for this? I have read bad things about cluttering up models with too many callbacks, and am not sure if ActiveModel Dirty is the best solution here. Does anybody have a suggestion that goes along with best practices and does not require a ton of DB queries? </p>\n"}, {"tags": ["ruby-on-rails", "ruby", "string", "parameters"], "comments": [{"owner": {"reputation": 6462, "user_id": 3784008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/55ou4.jpg?s=128&g=1", "display_name": "anothermh", "link": "https://stackoverflow.com/users/3784008/anothermh"}, "edited": false, "score": 2, "creation_date": 1545868701, "post_id": 53935487, "comment_id": 94716672, "body": "You&#39;re trying to use a <a href=\"https://github.com/smiller/strip_params\" rel=\"nofollow noreferrer\">gem</a> made seven years ago, four years before <a href=\"https://www.ruby-lang.org/en/news/2015/12/25/ruby-2-3-0-released/\" rel=\"nofollow noreferrer\">Ruby 2.3.0</a> was released. I would not recommend you use an ancient gem that never got beyond v0.0.1 with a straightforward incompatibility with the version of Ruby you&#39;re using."}, {"owner": {"reputation": 4956, "user_id": 108000, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/ca0b18ec9e11dc777b2b8084fe5d5f90?s=128&d=identicon&r=PG", "display_name": "Sam Kong", "link": "https://stackoverflow.com/users/108000/sam-kong"}, "reply_to_user": {"reputation": 6462, "user_id": 3784008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/55ou4.jpg?s=128&g=1", "display_name": "anothermh", "link": "https://stackoverflow.com/users/3784008/anothermh"}, "edited": false, "score": 0, "creation_date": 1545947131, "post_id": 53935487, "comment_id": 94740980, "body": "It turned out that routes.rb caused the problem. { format: &#39;json&#39; } has a string literal which goes into the params and thus causes the error. I changed it into { format: +&#39;json&#39; } and it solved the problem."}], "owner": {"reputation": 4956, "user_id": 108000, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/ca0b18ec9e11dc777b2b8084fe5d5f90?s=128&d=identicon&r=PG", "display_name": "Sam Kong", "link": "https://stackoverflow.com/users/108000/sam-kong"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 490, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1545847432, "creation_date": 1545847432, "question_id": 53935487, "link": "https://stackoverflow.com/questions/53935487/in-rails-frozen-string-literal-true-directive-conflicts-with-stripparams", "title": "In Rails, # frozen_string_literal: true directive conflicts with StripParams", "body": "<p>Using magic_frozen_string_literal, I added # frozen_string_literal: true to all files in app, config and lib/tasks folder and it's subfolders in my Rails 4.2 app. However, StripParams gem causes an error - \"can't modify frozen String\".</p>\n\n<p>I removed # frozen_string_literal: true from application_controller.rb but still got the same error.</p>\n\n<p>How can I make an exception so that StripParams gem works? Here's the code from the gem. v.strip! is the issue.</p>\n\n<pre><code>module StripParams\n  def self.all!(params)\n    params.each do |k, v|\n      if v.respond_to? :strip!\n        v.strip!\n      elsif v.respond_to? :each_pair\n        all!(v)\n      end\n    end\n    params\n  end\nend\n</code></pre>\n"}, {"tags": ["ruby", "linux", "windows", "rake", "nls-lang"], "comments": [{"owner": {"reputation": 6462, "user_id": 3784008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/55ou4.jpg?s=128&g=1", "display_name": "anothermh", "link": "https://stackoverflow.com/users/3784008/anothermh"}, "edited": false, "score": 0, "creation_date": 1545868907, "post_id": 53935262, "comment_id": 94716707, "body": "Please fix your first code example as it is invalid syntax. Please be clear and specific about what operating system is having problems (specify what operating system is attempting to write the files). If you&#39;re trying to write these files on Windows, and if you are trying to replace invalid characters with <code>?</code> then <a href=\"https://stackoverflow.com/q/1976007/3784008\">that will fail</a>."}], "owner": {"reputation": 136, "user_id": 3164387, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hjaEk.jpg?s=128&g=1", "display_name": "Sudhir", "link": "https://stackoverflow.com/users/3164387/sudhir"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 214, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1545845931, "creation_date": 1545845931, "question_id": 53935262, "link": "https://stackoverflow.com/questions/53935262/nls-lang-american-america-utf8-issue-with-ruby-rake", "title": "NLS_LANG = &#39;AMERICAN_AMERICA.UTF8 issue with Ruby rake", "body": "<p>I am using ruby 2.5 and supporting for foreign chars I am using..</p>\n\n<pre><code>NLS_LANG'] ||= 'AMERICAN_AMERICA.UTF8 \n</code></pre>\n\n<p>In ROR application. \nBut facing issue with special chars in file name.</p>\n\n<p>Here is the Problem statement.</p>\n\n<ol>\n<li>Generating the files using ruby rake </li>\n<li>Files are getting generated on Linux server</li>\n<li>Files are having special chars and those looking fine in linux server.</li>\n<li>Now I am fetching these files from Window server using scp command,</li>\n</ol>\n\n<p>but When I see these reports in Window server, foreign chars are not supported in file names.</p>\n\n<p>Any suggestion on This.</p>\n\n<p>I have tried below options:-</p>\n\n<pre><code>file_name = file_name.encode(\"ISO-8859-1\")\nfile_name = file_name.encode(\"UTF-8\")\n\nIconv.conv('Windows-1252', 'UTF-8', file_name)\n\n\nfile_name.encode!(\"windows-1252\", :invalid =&gt; :replace, :undef =&gt; :replace, :replace =&gt; \"?\")\n</code></pre>\n\n<p>I am not sure about this issue is server level or application level.</p>\n\n<p>Help will be appreciated.   </p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 6462, "user_id": 3784008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/55ou4.jpg?s=128&g=1", "display_name": "anothermh", "link": "https://stackoverflow.com/users/3784008/anothermh"}, "edited": false, "score": 0, "creation_date": 1545869641, "post_id": 53935149, "comment_id": 94716815, "body": "<code>FileUtils.rm</code> <a href=\"https://ruby-doc.org/stdlib-2.4.1/libdoc/fileutils/rdoc/FileUtils.html#method-c-rm\" rel=\"nofollow noreferrer\">does not operate on directories</a>. You said <code>FileUtils.remove_dir</code> doesn&#39;t work either but did not specify the error you receive for that method. So troubleshoot it; is it really a directory, not a soft/hardlink? Is it returned by <code>Dir.foreach(path) { |f| puts f if Dir.exist?(f) }</code>?"}, {"owner": {"reputation": 6375, "user_id": 6826164, "user_type": "registered", "accept_rate": 39, "profile_image": "https://lh6.googleusercontent.com/-CKThqFqe5Eo/AAAAAAAAAAI/AAAAAAAAP10/ih0uh1YgT_I/photo.jpg?sz=128", "display_name": "Jonathan Tuzman", "link": "https://stackoverflow.com/users/6826164/jonathan-tuzman"}, "reply_to_user": {"reputation": 6462, "user_id": 3784008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/55ou4.jpg?s=128&g=1", "display_name": "anothermh", "link": "https://stackoverflow.com/users/3784008/anothermh"}, "edited": false, "score": 0, "creation_date": 1545940475, "post_id": 53935149, "comment_id": 94738897, "body": "Hm for some reason <code>FileUtils.remove_dir</code> just worked. Not sure what I did differently this time (or rather what I did definitely wrong last time). Thanks."}], "owner": {"reputation": 6375, "user_id": 6826164, "user_type": "registered", "accept_rate": 39, "profile_image": "https://lh6.googleusercontent.com/-CKThqFqe5Eo/AAAAAAAAAAI/AAAAAAAAP10/ih0uh1YgT_I/photo.jpg?sz=128", "display_name": "Jonathan Tuzman", "link": "https://stackoverflow.com/users/6826164/jonathan-tuzman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 147, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1545845195, "creation_date": 1545845195, "question_id": 53935149, "link": "https://stackoverflow.com/questions/53935149/cant-delete-a-folder-or-file-with-fileutils-rm-because-of-unlink-internal", "title": "Can&#39;t delete a folder or file with FileUtils.rm because of @unlink_internal", "body": "<p>Running <code>FileUtils.rm(a_folder)</code> is giving me the error: </p>\n\n<p><code>Errno::ENOENT: No such file or directory @ unlink_internal - a_folder</code></p>\n\n<p><code>a_folder</code> is definitely valid, I actually got there through </p>\n\n<pre><code>Dir.foreach(path) do |f|\n  if f != '.' &amp;&amp; f != '..' \n    FileUtils.rm(f)\n  end\nend\n</code></pre>\n\n<p>Same problem for <code>rm_rf</code> and <code>remove_dir</code>.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "cron", "whenever", "ice-cube"], "comments": [{"owner": {"reputation": 1276, "user_id": 5399937, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ctCqj.png?s=128&g=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/5399937/tom"}, "edited": false, "score": 0, "creation_date": 1545844534, "post_id": 53934758, "comment_id": 94710171, "body": "Are you able to access and use the rails console to set the jobs? or do you have to update the database directly and have the gem detect the change?"}, {"owner": {"reputation": 53, "user_id": 6506317, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/06313e5061208f9204946353cecfe7f4?s=128&d=identicon&r=PG&f=1", "display_name": "walt3rwhite", "link": "https://stackoverflow.com/users/6506317/walt3rwhite"}, "reply_to_user": {"reputation": 1276, "user_id": 5399937, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ctCqj.png?s=128&g=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/5399937/tom"}, "edited": false, "score": 0, "creation_date": 1545847779, "post_id": 53934758, "comment_id": 94711149, "body": "@Tom let&#39;s say I have a rule which needs to be triggered at some time. So what I want is that I could add a rule in a rule table, add a trigger in the trigger table to execute the rule at 6 pm daily. The gem automatically detects the new trigger and start scheduling it daily."}], "answers": [{"tags": [], "owner": {"reputation": 5519, "user_id": 938947, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f611b152b4fa9fe2a05f4ee9b84fdcb7?s=128&d=identicon&r=PG", "display_name": "widjajayd", "link": "https://stackoverflow.com/users/938947/widjajayd"}, "is_accepted": false, "score": 0, "last_activity_date": 1545844432, "creation_date": 1545844432, "answer_id": 53935020, "question_id": 53934758, "link": "https://stackoverflow.com/questions/53934758/scheduling-tasks-by-reading-time-of-execution-from-database-instead-of-code/53935020#53935020", "title": "Scheduling tasks by reading time of execution from database instead of code", "body": "<p>I think you can use <a href=\"https://github.com/plashchynski/crono\" rel=\"nofollow noreferrer\">crone gem</a>\nthis is purely writing in ruby, you do not need to set cron job like whenever gem.\nbut how it work is cron in linux</p>\n\n<p>installation steps:</p>\n\n<pre><code>gem 'crono'\nrails generate crono:install\nrake db:migrate # to install it's table\n</code></pre>\n\n<p>you can merge with active job</p>\n\n<pre><code>class TestJob # This is not an Active Job job, but pretty legal Crono job.\n  def perform(*args)\n    # put you scheduled code here\n    # Comments.deleted.clean_up...\n  end\nend\n</code></pre>\n\n<p>and do the scheduling as follow (no need to set from OS / cron)</p>\n\n<pre><code># config/cronotab.rb\nCrono.perform(TestJob).every 2.days, at: {hour: 15, min: 30}\nCrono.perform(TestJob).every 1.week, on: :monday, at: \"15:30\"\n</code></pre>\n"}], "owner": {"reputation": 53, "user_id": 6506317, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/06313e5061208f9204946353cecfe7f4?s=128&d=identicon&r=PG&f=1", "display_name": "walt3rwhite", "link": "https://stackoverflow.com/users/6506317/walt3rwhite"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 68, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1545915107, "creation_date": 1545842830, "last_edit_date": 1545915107, "question_id": 53934758, "link": "https://stackoverflow.com/questions/53934758/scheduling-tasks-by-reading-time-of-execution-from-database-instead-of-code", "title": "Scheduling tasks by reading time of execution from database instead of code", "body": "<p>I am looking for a flow in ruby through which I can run a task daily on some particular times. I want to add a new task in some table, specify the time in some column and the task should be scheduled daily since the row has been added to the table. I know the gem 'whenever' is used for scheduling but it would require a code deployment whenever I need to specify the time in schedule.rb. Is it even possible what I want to do?</p>\n"}, {"tags": ["python", "ruby", "chef-infra", "configuration-management"], "comments": [{"owner": {"reputation": 1231, "user_id": 2230115, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/sGX51.png?s=128&g=1", "display_name": "iCodeSometime", "link": "https://stackoverflow.com/users/2230115/icodesometime"}, "edited": false, "score": 0, "creation_date": 1545842424, "post_id": 53934497, "comment_id": 94709503, "body": "Sounds like you&#39;re looking for this. I&#39;d imagine you can just set the download url based on the platform  <a href=\"https://docs.chef.io/dsl_recipe.html#platform\" rel=\"nofollow noreferrer\">docs.chef.io/dsl_recipe.html#platform</a>"}, {"owner": {"reputation": 11490, "user_id": 3317808, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/6c8272382fcd9841919bc1f8709d25a0?s=128&d=identicon&r=PG&f=1", "display_name": "overexchange", "link": "https://stackoverflow.com/users/3317808/overexchange"}, "reply_to_user": {"reputation": 1231, "user_id": 2230115, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/sGX51.png?s=128&g=1", "display_name": "iCodeSometime", "link": "https://stackoverflow.com/users/2230115/icodesometime"}, "edited": false, "score": 0, "creation_date": 1545844415, "post_id": 53934497, "comment_id": 94710140, "body": "@kennycoc we are doing something similar in python...<code>if platform?(&#39;windows&#39;)</code> which we want to avoid.."}, {"owner": {"reputation": 1231, "user_id": 2230115, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/sGX51.png?s=128&g=1", "display_name": "iCodeSometime", "link": "https://stackoverflow.com/users/2230115/icodesometime"}, "edited": false, "score": 0, "creation_date": 1545845561, "post_id": 53934497, "comment_id": 94710526, "body": "as far as I can tell, there&#39;s no PDF Reader recipe.. But even if there was, it would just be switching on the platform regardless.. it&#39;s not like there&#39;s a platform independent installer.   Best case, if you&#39;re just trying to avoid the conditional, you could host the installers on your own server, and do something like <code>url = &quot;https:&#47;&#47;servername&#47;pdfReader&#47;#{node[&#39;platform&#39;]}&quot;</code>"}], "answers": [{"tags": [], "owner": {"reputation": 4026, "user_id": 182811, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/96b3b4a6c0c2288b29164f36cd4fbfb7?s=128&d=identicon&r=PG", "display_name": "David M", "link": "https://stackoverflow.com/users/182811/david-m"}, "is_accepted": false, "score": 1, "last_activity_date": 1545851400, "creation_date": 1545851400, "answer_id": 53936142, "question_id": 53934497, "link": "https://stackoverflow.com/questions/53934497/to-install-pdf-reader-on-windows-and-linux-chef/53936142#53936142", "title": "To install pdf reader on Windows and Linux - Chef", "body": "<p>Something has to be platform-aware in what you\u2019re doing, because it is necessarily true that there\u2019s a different installer for each platform. If you really want to go the Chef route, then use the <code>supports</code> keyword in your cookbook\u2019s metadata.rb: <a href=\"https://docs.chef.io/config_rb_metadata.html\" rel=\"nofollow noreferrer\">https://docs.chef.io/config_rb_metadata.html</a>, so that your cookbook only tries to install on specific platforms. If you add platforms to your cookbook, it would be very friendly of you to contribute it to supermarket.chef.io, because as kennycoc pointed out, there isn\u2019t one there now.</p>\n"}], "owner": {"reputation": 11490, "user_id": 3317808, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/6c8272382fcd9841919bc1f8709d25a0?s=128&d=identicon&r=PG&f=1", "display_name": "overexchange", "link": "https://stackoverflow.com/users/3317808/overexchange"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 43, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1545870530, "creation_date": 1545841163, "last_edit_date": 1545870530, "question_id": 53934497, "link": "https://stackoverflow.com/questions/53934497/to-install-pdf-reader-on-windows-and-linux-chef", "title": "To install pdf reader on Windows and Linux - Chef", "body": "<p>For config mgmt, we first moved from Shell scripting to Python scripting, for the purpose of smooth transition in supporting any new platform(OS), with minimum code changes. Python code uses <code>popen()</code> to execute commands based on OS. </p>\n\n<p>As we use python for installation &amp; configuration of applications, but python does not provide platform independent approach for install/config. </p>\n\n<p>For platform independence, we want to go for Chef</p>\n\n<p>There are twenty nodes(10 windows &amp; 10 Linux), to install pdf reader.</p>\n\n<p>Can a Chef cookbook recipe be platform independent to install pdf reader on any OS? </p>\n\n<p>or</p>\n\n<p>Do we need to write recipe per platform?</p>\n"}, {"tags": ["c", "ruby", "gtk3", "cairo"], "answers": [{"tags": [], "owner": {"reputation": 7642, "user_id": 436275, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a72a51d31e40d541a9786e0243678029?s=128&d=identicon&r=PG", "display_name": "Uli Schlachter", "link": "https://stackoverflow.com/users/436275/uli-schlachter"}, "is_accepted": true, "score": 1, "last_activity_date": 1545905181, "creation_date": 1545905181, "answer_id": 53943201, "question_id": 53934276, "link": "https://stackoverflow.com/questions/53934276/stroke-alignment-in-cairo/53943201#53943201", "title": "Stroke alignment in Cairo", "body": "<p>No, there is no such method built-in.</p>\n\n<p>One could likely approximate this with a temporary surface that is later used as a mask. For example, to do \"outside\", you first fill a temporary surface with \"transparent\", then stroke with twice your desired line width some \"opaque\", and finally fill the shape with \"transparent\" to get rid of the inner part of the line width. The resulting surface can then be used as a mask.</p>\n\n<p>\"Inside\" would be similar, but with an extra trick: Again, transparent surface and stroke with twice the line width. Now the outside part of this stroke needs to be removed. For this, one needs a path with a winding rule of even-odd. Add a surface-sized rectangle to this path inverts the path, thus allowing to remove everything outside via a fill.\nFor a non-zero winding rule... I do not have any immediate ideas (well, another temporary surface that is then inverted via a full-surface-paint with operator SUBTRACT?).</p>\n"}], "owner": {"reputation": 9435, "user_id": 2626000, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/j8GY0.jpg?s=128&g=1", "display_name": "Aaron Christiansen", "link": "https://stackoverflow.com/users/2626000/aaron-christiansen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 279, "favorite_count": 0, "accepted_answer_id": 53943201, "answer_count": 1, "score": 1, "last_activity_date": 1545905181, "creation_date": 1545839992, "last_edit_date": 1545840397, "question_id": 53934276, "link": "https://stackoverflow.com/questions/53934276/stroke-alignment-in-cairo", "title": "Stroke alignment in Cairo", "body": "<p>Many graphics packages allow the user to select where they would like to draw the border of a region around a shape; either along the inside, outside or centre of the shape. For example, this shows the same square with the border drawn along the centre, inside and outside respectively:</p>\n\n<p><a href=\"https://i.stack.imgur.com/u0hNL.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/u0hNL.png\" alt=\"enter image description here\"></a></p>\n\n<p>I could scale the path up/down based on the stroke's width, but I wanted to check if there was built-in support for this first.</p>\n\n<p>I'm using Ruby, but if there's a C method for this, it's likely available in the Ruby bindings as well.</p>\n\n<p>Is there a method to draw a stroke around the outside or inside of a path, rather than along the centre, in Cairo?</p>\n"}, {"tags": ["ruby", "virtual-machine", "interpreter"], "comments": [{"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 1, "creation_date": 1545851623, "post_id": 53932171, "comment_id": 94712421, "body": "I am assuming that by &quot;CRuby&quot;, you mean YARV, since that is the only one which has a release numbered 2.3.8, 2.5.3, or 2.6.0. (CRuby is not very descriptive, since e.g. MRI, YARV, MRuby, and tinyrb are written in C.) Interestingly, with YARV 2.6.0 on macOS 10.13, I get 2 threads w/o JIT and 3 with. MacOS&#39;s <code>ps</code> doesn&#39;t have the <code>nlwp</code> keyword, so I am assuming you use a different OS, maybe that plays a role."}], "answers": [{"comments": [{"owner": {"reputation": 189, "user_id": 4352712, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/h58Q5.png?s=128&g=1", "display_name": "aonemd", "link": "https://stackoverflow.com/users/4352712/aonemd"}, "edited": false, "score": 0, "creation_date": 1545828149, "post_id": 53932235, "comment_id": 94704873, "body": "I don&#39;t think this is accurate. If I tried to explicitly count the number of threads my program is using by counting the number of directories under <code>&#47;proc&#47;PID&#47;task</code>, I get two directories/threads as well. The other process, the grep process, is not interfering here as far as I know."}, {"owner": {"reputation": 2640, "user_id": 5195699, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f85291bb71f55981b1d412f1efcb7603?s=128&d=identicon&r=PG&f=1", "display_name": "R_Kapp", "link": "https://stackoverflow.com/users/5195699/r-kapp"}, "reply_to_user": {"reputation": 189, "user_id": 4352712, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/h58Q5.png?s=128&g=1", "display_name": "aonemd", "link": "https://stackoverflow.com/users/4352712/aonemd"}, "edited": false, "score": 2, "creation_date": 1545835096, "post_id": 53932235, "comment_id": 94707138, "body": "@aonemd: I don&#39;t know enough to comment about <code>&#47;proc&#47;PID&#47;task</code> (which also wasn&#39;t included in the original question...), but as far as <code>ps</code> is concerned, this answer is exactly correct. <code>ps</code> will return one process for the actual ruby process, and another for the <code>grep ruby</code> command."}, {"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 1, "creation_date": 1545835160, "post_id": 53932235, "comment_id": 94707161, "body": "\u2026 which is what <code>pgrep</code> is for."}], "tags": [], "owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "is_accepted": false, "score": 3, "last_activity_date": 1545827933, "creation_date": 1545827933, "answer_id": 53932235, "question_id": 53932171, "link": "https://stackoverflow.com/questions/53932171/why-does-a-ruby-program-process-spawn-more-than-one-thread/53932235#53932235", "title": "Why does a Ruby program/process spawn more than one thread?", "body": "<p>Among the two that you have counted, one process is the running ruby process indeed. The other is your <code>grep ruby</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 0, "creation_date": 1545838425, "post_id": 53933605, "comment_id": 94708179, "body": "Ruby 2.6, yeah."}, {"owner": {"reputation": 189, "user_id": 4352712, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/h58Q5.png?s=128&g=1", "display_name": "aonemd", "link": "https://stackoverflow.com/users/4352712/aonemd"}, "edited": false, "score": 0, "creation_date": 1545848437, "post_id": 53933605, "comment_id": 94711366, "body": "I&#39;m using CRuby 2.5.3. Also tried it on CRuby 2.3.8. I edited the question."}], "tags": [], "owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "is_accepted": false, "score": 4, "last_activity_date": 1545844160, "last_edit_date": 1545844160, "creation_date": 1545835857, "answer_id": 53933605, "question_id": 53932171, "link": "https://stackoverflow.com/questions/53932171/why-does-a-ruby-program-process-spawn-more-than-one-thread/53933605#53933605", "title": "Why does a Ruby program/process spawn more than one thread?", "body": "<p>You didn't say which Ruby implementation you are using, so we can only guess:</p>\n\n<ul>\n<li>Some Ruby implementations use a separate thread for I/O.</li>\n<li>Some Ruby implementations have a concurrent garbage collector, i.e. a garbage collector that runs alongside the mutator in a separate thread.</li>\n<li>Some Ruby implementations have a parallel garbage collector, i.e. a garbage collector that uses multiple threads.</li>\n<li>Some Ruby implementations have a concurrent parallel garbage collector, i.e. a garbage collector that runs alongside the mutator in multiple separate threads.</li>\n<li>Some Ruby implementations have a concurrent JIT compiler, i.e. a JIT compiler that runs alongside the interpreter in a separate thread.</li>\n<li>Some Ruby implementations have a parallel JIT compiler, i.e. a JIT compiler that uses multiple threads.</li>\n<li>Some Ruby implementations have a concurrent parallel JIT compiler, i.e. a JIT compiler that runs alongside the interpreter in multiple separate threads.</li>\n<li>Some Ruby implementations implement concurrency using multiple message-passing VMs, i.e. they run one VM instance per CPU core in separate threads, and implement Ruby threads, fibers, etc. by passing them between those VMs.</li>\n<li>Some Ruby implementations implement tracing and statistics using a separate thread.</li>\n<li>Some Ruby implementations may themselves run on top of another runtime, which may do any one of the things mentioned above.</li>\n</ul>\n\n<p>And there's probably a lot of other reasons as well.</p>\n\n<p>For example, YARV 2.6 will use 2 threads (engine and I/O) when running without the JIT and three (plus JIT) when running with the JIT.</p>\n"}], "owner": {"reputation": 189, "user_id": 4352712, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/h58Q5.png?s=128&g=1", "display_name": "aonemd", "link": "https://stackoverflow.com/users/4352712/aonemd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 196, "favorite_count": 1, "answer_count": 2, "score": 2, "last_activity_date": 1545852814, "creation_date": 1545827551, "last_edit_date": 1545852814, "question_id": 53932171, "link": "https://stackoverflow.com/questions/53932171/why-does-a-ruby-program-process-spawn-more-than-one-thread", "title": "Why does a Ruby program/process spawn more than one thread?", "body": "<p>As the title says, why does a Ruby program or process spawn more than one thread?</p>\n\n<p>For example, If I ran a simple program such as this one:</p>\n\n<pre><code>ruby -e 'while true; end'\n</code></pre>\n\n<p>and then tried to count the number of threads this program is using, by running:</p>\n\n<pre><code>ps -o nlwp `echo $(ps aux | pgrep ruby)`\n</code></pre>\n\n<p>I get the output:</p>\n\n<blockquote>\n  <p>NLWP</p>\n  \n  <p>2</p>\n</blockquote>\n\n<p>which means the process is using two threads.</p>\n\n<p>I'm using CRuby/YARV 2.5.3 on Linux. I also tried this with 2.3.8, and got the same outcome.</p>\n\n<p><strong>Edit</strong></p>\n\n<p>With Ruby 2.6.0, it seems it only runs a single thread. However, when I enable the JIT using the <code>--jit</code> option, it spawns two threads.</p>\n"}, {"tags": ["ruby", "string"], "comments": [{"owner": {"reputation": 481662, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 1, "creation_date": 1545826019, "post_id": 53931881, "comment_id": 94704106, "body": "Maybe <code>.gsub(&#39;\\\\\\\\&#39;, &#39;\\\\&#39;)</code>? See <a href=\"https://ideone.com/RXaX6M\" rel=\"nofollow noreferrer\">ideone.com/RXaX6M</a>"}, {"owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 0, "creation_date": 1545826437, "post_id": 53931881, "comment_id": 94704255, "body": "Your desired output is not a valid string literal. The final quote is escaped, and the string&#39;s quote is not closed."}, {"owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 0, "creation_date": 1545826525, "post_id": 53931881, "comment_id": 94704291, "body": "It is also not clear what you mean by your attempts with three listed outputs. What does each version mean?"}, {"owner": {"reputation": 179, "user_id": 7781443, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/3754645e9fa3f3cc8578b0bb58dd0eb3?s=128&d=identicon&r=PG&f=1", "display_name": "ikebastuz", "link": "https://stackoverflow.com/users/7781443/ikebastuz"}, "edited": false, "score": 0, "creation_date": 1545827021, "post_id": 53931881, "comment_id": 94704462, "body": "The thing that ideone (etc.) not printing all backslashes. Your .gsub(&#39;\\\\\\\\&#39;, &#39;\\\\&#39;) makes \\\\\\\\ -&gt; \\ (just one)"}, {"owner": {"reputation": 179, "user_id": 7781443, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/3754645e9fa3f3cc8578b0bb58dd0eb3?s=128&d=identicon&r=PG&f=1", "display_name": "ikebastuz", "link": "https://stackoverflow.com/users/7781443/ikebastuz"}, "edited": false, "score": 0, "creation_date": 1545827063, "post_id": 53931881, "comment_id": 94704478, "body": "I just pasted part of long string and cuted it somewhere for example. Yeah, it might be not valid, just did it to show."}, {"owner": {"reputation": 481662, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 0, "creation_date": 1545835547, "post_id": 53931881, "comment_id": 94707260, "body": "You are mistaken about what you have and what you are doing. <code>body = &#39;\\\\u001F\\\\x8B\\\\b\\\\u00003g#\\\\\\\\\\\\u0002\\\\&#39;</code> is actually a <code>\\u001F\\x8B\\b\\u00003g#\\\\\\u0002\\</code>  string. When you use <code>.gsub(&#39;\\\\\\\\&#39;, &#39;\\\\&#39;)</code> you replace each <code>\\\\</code> with <code>\\</code>, so the result is as expected, <code>\\u001F\\x8B\\b\\u00003g#\\\\u0002\\</code>. If you really have double backslashes, you would have defined it as a heredoc, see <a href=\"https://ideone.com/oUD07V\" rel=\"nofollow noreferrer\">ideone.com/oUD07V</a>"}], "answers": [{"tags": [], "owner": {"reputation": 1231, "user_id": 2230115, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/sGX51.png?s=128&g=1", "display_name": "iCodeSometime", "link": "https://stackoverflow.com/users/2230115/icodesometime"}, "is_accepted": false, "score": 2, "last_activity_date": 1545841913, "creation_date": 1545841913, "answer_id": 53934611, "question_id": 53931881, "link": "https://stackoverflow.com/questions/53931881/replace-backslashes-in-string/53934611#53934611", "title": "Replace backslashes in string", "body": "<p>Likely what's happening, is you're printing the string with <code>p</code> or using <code>inspect</code>, and printing the string normally, will give you what you're expecting.</p>\n\n<pre><code>body = '\\\\u001F\\\\x8B\\\\b\\\\u00003g#\\\\\\\\\\\\u0002\\\\'\np body #&gt; \"\\\\u001F\\\\x8B\\\\b\\\\u00003g#\\\\\\\\\\\\u0002\\\\\"\nputs body.inspect #&gt; \"\\\\u001F\\\\x8B\\\\b\\\\u00003g#\\\\\\\\\\\\u0002\\\\\"\nputs body #&gt; \\u001F\\x8B\\b\\u00003g#\\\\\\u0002\\\n</code></pre>\n\n<p>If you're using IRB, simply typing the variable name calls inspect automatically, e.g.</p>\n\n<pre><code>irb(main):001:0&gt; body = '\\\\u001F\\\\x8B\\\\b\\\\u00003g#\\\\\\\\\\\\u0002\\\\'\nirb(main):002:0&gt; body\n=&gt; \"\\\\u001F\\\\x8B\\\\b\\\\u00003g#\\\\\\\\\\\\u0002\\\\\"\n</code></pre>\n\n<p>In other words, the string likely already is formated how you're wanting, you're just not seeing it without inspection info.</p>\n"}, {"tags": [], "owner": {"reputation": 43, "user_id": 10829266, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-PxBxSaeqHcg/AAAAAAAAAAI/AAAAAAAAADI/6ZJAGQpo_xE/photo.jpg?sz=128", "display_name": "nimesh", "link": "https://stackoverflow.com/users/10829266/nimesh"}, "is_accepted": false, "score": 1, "last_activity_date": 1545890944, "creation_date": 1545890944, "answer_id": 53940469, "question_id": 53931881, "link": "https://stackoverflow.com/questions/53931881/replace-backslashes-in-string/53940469#53940469", "title": "Replace backslashes in string", "body": "<p>Your output string is not valid. I think what you are looking for is:</p>\n\n<pre><code>body.squeeze(\"\\\\\")\n</code></pre>\n\n<p><a href=\"https://apidock.com/ruby/String/squeeze\" rel=\"nofollow noreferrer\">Squeeze</a> replaces the occurrence of multiple consecutive characters into a single character and returns a new string.</p>\n"}, {"tags": [], "owner": {"reputation": 179, "user_id": 7781443, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/3754645e9fa3f3cc8578b0bb58dd0eb3?s=128&d=identicon&r=PG&f=1", "display_name": "ikebastuz", "link": "https://stackoverflow.com/users/7781443/ikebastuz"}, "is_accepted": true, "score": 0, "last_activity_date": 1545917778, "creation_date": 1545917778, "answer_id": 53945989, "question_id": 53931881, "link": "https://stackoverflow.com/questions/53931881/replace-backslashes-in-string/53945989#53945989", "title": "Replace backslashes in string", "body": "<p>I wrapped this text into eval and it returned exactly what I wanted. Yeah, it\u2019s not secure, but there are no solutions found so far</p>\n\n<pre><code>eval(\"\\\"#{body}\\\"\")\n</code></pre>\n"}], "owner": {"reputation": 179, "user_id": 7781443, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/3754645e9fa3f3cc8578b0bb58dd0eb3?s=128&d=identicon&r=PG&f=1", "display_name": "ikebastuz", "link": "https://stackoverflow.com/users/7781443/ikebastuz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 70, "favorite_count": 0, "accepted_answer_id": 53945989, "answer_count": 3, "score": -4, "last_activity_date": 1545917778, "creation_date": 1545825941, "last_edit_date": 1545826385, "question_id": 53931881, "link": "https://stackoverflow.com/questions/53931881/replace-backslashes-in-string", "title": "Replace backslashes in string", "body": "<p>I need to halve all backslashes.</p>\n\n<pre><code>body = '\\\\u001F\\\\x8B\\\\b\\\\u00003g#\\\\\\\\\\\\u0002\\\\'\n</code></pre>\n\n<p>I need output like this:</p>\n\n<pre><code>'\\u001F\\x8B\\b\\u00003g#\\\\\\u0002\\'\n</code></pre>\n\n<p>I tried this:</p>\n\n<pre><code>body.gsub(\"\\\\\\\\\\\\\", \"\\\\\")\n\\\\ -&gt; \\ (ok)\n\\\\\\\\ -&gt; \\\\ (ok)\n\\\\\\\\\\\\ &gt; \\ (not ok)\n</code></pre>\n\n<p>I've read that ruby somehow parses string twice, maybe its somehow connected with my undesired output. Any ideas?</p>\n"}, {"tags": ["ruby", "mediarecorder-api"], "comments": [{"owner": {"reputation": 2721, "user_id": 813988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90ca064d407f1d135134813a45b6c2e8?s=128&d=identicon&r=PG", "display_name": "Octavian Naicu", "link": "https://stackoverflow.com/users/813988/octavian-naicu"}, "edited": false, "score": 0, "creation_date": 1548763584, "post_id": 53931358, "comment_id": 95651018, "body": "Can constantly reproduce it with Chrome? Can you reproduce it with Firefox?"}], "answers": [{"tags": [], "owner": {"reputation": 2721, "user_id": 813988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90ca064d407f1d135134813a45b6c2e8?s=128&d=identicon&r=PG", "display_name": "Octavian Naicu", "link": "https://stackoverflow.com/users/813988/octavian-naicu"}, "is_accepted": false, "score": 0, "last_activity_date": 1548763537, "creation_date": 1548763537, "answer_id": 54420675, "question_id": 53931358, "link": "https://stackoverflow.com/questions/53931358/im-recording-speech-using-mediarecorder-api-why-are-chunks-smaller-than-the-ac/54420675#54420675", "title": "I&#39;m recording speech using MediaRecorder API, why are chunks smaller than the actual size?", "body": "<p>It is a longshot but try removing any browser level processing that might be done on audio with these constraints:</p>\n\n<ul>\n<li>echoCancellation:false</li>\n<li>autoGainControl:false</li>\n<li>noiseSuppression:false</li>\n</ul>\n"}], "owner": {"reputation": 377, "user_id": 2050755, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/1ad025f9d6859f8f9cc19966d3868eea?s=128&d=identicon&r=PG", "display_name": "Rajesh Naik", "link": "https://stackoverflow.com/users/2050755/rajesh-naik"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 432, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1548763537, "creation_date": 1545823175, "last_edit_date": 1545829788, "question_id": 53931358, "link": "https://stackoverflow.com/questions/53931358/im-recording-speech-using-mediarecorder-api-why-are-chunks-smaller-than-the-ac", "title": "I&#39;m recording speech using MediaRecorder API, why are chunks smaller than the actual size?", "body": "<p>I have an issue with MediaRecorder API (<a href=\"https://www.w3.org/TR/mediastream-recording/#mediarecorder-api\" rel=\"nofollow noreferrer\">https://www.w3.org/TR/mediastream-recording/#mediarecorder-api</a>).</p>\n\n<p>I'm using it to record the speech from the web page using Chrome, and save it as chunks. I need to be able to play it while and after it is recorded, so it's important to keep those chunks.</p>\n\n<p>Here is the code which is recording data:</p>\n\n<pre><code>navigator.mediaDevices.getUserMedia({ audio: true, video: false }).then(function(stream) {\n\n  recorder = new MediaRecorder(stream, { mimeType: 'audio/webm; codecs=\"opus\"' })\n\n  var previous_timecode = null\n\n  recorder.ondataavailable = function(e) {\n\n    duration = previous_timecode ? e.timecode - previous_timecode : null\n    previous_timecode = e.timecode\n\n    // Read blob from `e.data`, decode64 and send to sever;\n    // Additionally send the duration calculated from the events;\n    // Duration of first chunk is calculated in a different way.\n  }\n\n  recorder.start(1000)\n\n})\n</code></pre>\n\n<p>The issue actually happened only once, but still it is quite a scary one. The problem was that during 7 minutes of recording i got only 5 minutes of audio. Analyzing the chunks gave me the following input - at some point, the chunks became much smaller then they were expected to be - the data was emitted every second, but the duration of the chunks was arround 400-700ms.</p>\n\n<p>The audio was correct, it did not have any gaps, it just came with a growing delay. At some points the duration of chunk was growing a bit - up 4.8sec in a chunk, but still the total delay grew up to ~2 min.</p>\n\n<p>In the CSV attached <a href=\"https://transfer.sh/stgnW/1.csv\" rel=\"nofollow noreferrer\">https://transfer.sh/stgnW/1.csv</a>  you can see the durations of each chunk calculated with ffmpeg (size audio file containing first n chunks minus the size of file containing first n-1 chunks) and also the durations calculated by e.timecode values.</p>\n\n<p>It looks like some throttling issue - is there something like that in chrome? How could i fix my code to make sure it's not throttled that way?</p>\n"}, {"tags": ["ruby", "database", "activerecord-import"], "comments": [{"owner": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "edited": false, "score": 0, "creation_date": 1545823064, "post_id": 53931196, "comment_id": 94703131, "body": "can&#39;t you use one of <code>on_duplicate_key</code> methods?  <a href=\"https://github.com/zdennis/activerecord-import#duplicate-key-update\" rel=\"nofollow noreferrer\">github.com/zdennis/activerecord-import#duplicate-key-update</a>"}, {"owner": {"reputation": 694, "user_id": 6481767, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/881dc5adac4bec55f445d812f2e32505?s=128&d=identicon&r=PG&f=1", "display_name": "Aaditya Maheshwari", "link": "https://stackoverflow.com/users/6481767/aaditya-maheshwari"}, "edited": false, "score": 0, "creation_date": 1545841739, "post_id": 53931196, "comment_id": 94709245, "body": "What do you mean by refresh a large db? The model or both model &amp; data? Have you looked into the <code>reload</code> method? I am guessing you are gonna keep on using the same data feed to update the data in which case you can also <code>drop</code> <code>create</code> <code>migrate</code> and <code>seed</code> every time or <code>.reload</code> should work too."}, {"owner": {"reputation": 395, "user_id": 10809793, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o3V2X.jpg?s=128&g=1", "display_name": "arnaudjnn", "link": "https://stackoverflow.com/users/10809793/arnaudjnn"}, "edited": false, "score": 0, "creation_date": 1545907393, "post_id": 53931196, "comment_id": 94726015, "body": "It mean that when the url from is refresh by Awin it refresh my db delete/update/add without interact with unchanged ones. Can you details the reload method?"}], "answers": [{"tags": [], "owner": {"reputation": 694, "user_id": 6481767, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/881dc5adac4bec55f445d812f2e32505?s=128&d=identicon&r=PG&f=1", "display_name": "Aaditya Maheshwari", "link": "https://stackoverflow.com/users/6481767/aaditya-maheshwari"}, "is_accepted": false, "score": 0, "last_activity_date": 1545842354, "last_edit_date": 1545842354, "creation_date": 1545841576, "answer_id": 53934553, "question_id": 53931196, "link": "https://stackoverflow.com/questions/53931196/how-to-refresh-a-large-database/53934553#53934553", "title": "How to refresh a large database?", "body": "<p>Probably use some methods like the following to keep checking the last_updated or last_modified header field in your rake task.</p>\n\n<pre><code>def get_date\n  date = CSV.foreach('CSV_raw.csv', :headers =&gt; false).first { |r| puts r}\n  $last_modified = Date.parse(date.compact[1]) # if last_updated is first row of CSV or use your http req header\nend\n\nrun_once = ARGV.length &gt; 0 # to run once &amp; test if it works; not sure if rake taks accept args.\nif not run_once\n  puts \"Daemon Mode\"\nend\n\nif not File.read('last_update.txt').empty?\n  date_in_file = Date.parse(File.read('last_update.txt'))\nelse\n  date_in_file = Date.parse('2001-02-03')\nend\nif $last_modified &gt; date_in_file\n  \"your db updating method\"\nend\nunless run_once\n  sleep UPDATE_INTERVAL # whatever value you want for the interval to be\nend\nend until run_once\n</code></pre>\n"}], "owner": {"reputation": 395, "user_id": 10809793, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o3V2X.jpg?s=128&g=1", "display_name": "arnaudjnn", "link": "https://stackoverflow.com/users/10809793/arnaudjnn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 44, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1545842354, "creation_date": 1545822307, "question_id": 53931196, "link": "https://stackoverflow.com/questions/53931196/how-to-refresh-a-large-database", "title": "How to refresh a large database?", "body": "<p>I built a rake task to donwload a zip from Awin datafeed and import it to my product model via activerecord-import.</p>\n\n<pre><code>require 'zip'\nrequire 'httparty'\nrequire 'active_record'\nrequire 'activerecord-import'\n\nnamespace :affiliate_datafeed do\n    desc \"Import products data from Awin\"\n    task import_product_awin: :environment do\n        url = \"https://productdata.awin.com\"\n        dir = \"db/affiliate_datafeed/awin.zip\"\n\n        File.open(dir, \"wb\") do |f| \n            f.write HTTParty.get(url).body\n        end\n\n        zip_file = Zip::File.open(dir)\n        entry = zip_file.glob('*.csv').first\n        csv_text = entry.get_input_stream.read\n        products = []\n\n        CSV.parse(csv_text, :headers=&gt;true).each do |row|\n            products &lt;&lt; Product.new(row.to_h)\n        end\n        Product.import(products)\n  end\nend\n</code></pre>\n\n<p>How to update the product db only if the product doesn't exist or if there is a new date in the last_updated field? What is the best way to refresh a large db?</p>\n"}, {"tags": ["ruby-on-rails", "json", "ruby"], "answers": [{"tags": [], "owner": {"reputation": 27144, "user_id": 3857758, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/58c4295826435f049b7fc32b98c240f9?s=128&d=identicon&r=PG&f=1", "display_name": "Ursus", "link": "https://stackoverflow.com/users/3857758/ursus"}, "is_accepted": true, "score": 5, "last_activity_date": 1545860874, "last_edit_date": 1545860874, "creation_date": 1545821283, "answer_id": 53930984, "question_id": 53930956, "link": "https://stackoverflow.com/questions/53930956/how-to-separate-keys-and-values-in-json-result/53930984#53930984", "title": "How to separate keys and values in JSON result", "body": "<p>You need to map each item into an object</p>\n\n<pre><code>@countries =  CountryStateSelect.countries_collection.map do |name, code|\n  Hash[:key, code, :value, name]\nend\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "is_accepted": false, "score": 1, "last_activity_date": 1545821568, "creation_date": 1545821568, "answer_id": 53931048, "question_id": 53930956, "link": "https://stackoverflow.com/questions/53930956/how-to-separate-keys-and-values-in-json-result/53931048#53931048", "title": "How to separate keys and values in JSON result", "body": "<p>Just convert your arrays to hashes:</p>\n\n<pre><code>h = _ # your input data given\n\nh[:countries].map!{|a| {value: a[0], key: a[1]} }\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "edited": false, "score": 0, "creation_date": 1545822670, "post_id": 53931104, "comment_id": 94703005, "body": "why do we need 2 calls to map for this case?"}], "tags": [], "owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "is_accepted": false, "score": 1, "last_activity_date": 1545821852, "creation_date": 1545821852, "answer_id": 53931104, "question_id": 53930956, "link": "https://stackoverflow.com/questions/53930956/how-to-separate-keys-and-values-in-json-result/53931104#53931104", "title": "How to separate keys and values in JSON result", "body": "<pre><code>input = {\n  \"countries\": [\n    [\"Andorra\", \"AD\"],\n    [\"United Arab Emirates\", \"AE\"]        \n  ]\n} \n\ninput.\n  transform_values do |vals|\n    vals.map(&amp;%i[value key].method(:zip)).map(&amp;:to_h)\n  end\n\n#\u21d2\u00a0{\n#   :countries =&gt; [\n#     [0] {\n#         :key =&gt; \"AD\",\n#       :value =&gt; \"Andorra\"\n#     },\n#     [1] {\n#         :key =&gt; \"AE\",\n#       :value =&gt; \"United Arab Emirates\"\n#     }\n#   ]\n# }\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 236, "user_id": 4391072, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jf0ro.png?s=128&g=1", "display_name": "Ni3", "link": "https://stackoverflow.com/users/4391072/ni3"}, "is_accepted": false, "score": 1, "last_activity_date": 1545845826, "creation_date": 1545845826, "answer_id": 53935246, "question_id": 53930956, "link": "https://stackoverflow.com/questions/53930956/how-to-separate-keys-and-values-in-json-result/53935246#53935246", "title": "How to separate keys and values in JSON result", "body": "<p><strong>Using collect method:</strong></p>\n\n<pre><code>countries = CountryStateSelect.countries_collection.collect do |country, code|\n    { key: code, value: country }\nend\n</code></pre>\n"}], "owner": {"reputation": 950, "user_id": 4993517, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/cc7c669cf8ed5e60e7443150e3a5b513?s=128&d=identicon&r=PG&f=1", "display_name": "SreRoR", "link": "https://stackoverflow.com/users/4993517/sreror"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 269, "favorite_count": 0, "accepted_answer_id": 53930984, "answer_count": 4, "score": 0, "last_activity_date": 1545860874, "creation_date": 1545821116, "last_edit_date": 1545821731, "question_id": 53930956, "link": "https://stackoverflow.com/questions/53930956/how-to-separate-keys-and-values-in-json-result", "title": "How to separate keys and values in JSON result", "body": "<p>I get the following array as JSON from an API when I call a country list:</p>\n\n<pre><code>{\n\"countries\": [\n    [\n        \"Andorra\",\n        \"AD\"\n    ],\n    [\n        \"United Arab Emirates\",\n        \"AE\"\n    ],\n    [\n        \"Afghanistan\",\n        \"AF\"\n    ],\n    [\n        \"Antigua and Barbuda\",\n        \"AG\"\n    ],\n    [\n        \"Anguilla\",\n        \"AI\"\n    ],\n    [\n        \"Albania\",\n        \"AL\"\n    ],\n    [\n        \"Armenia\",\n        \"AM\"\n]]}\n</code></pre>\n\n<p>This is my controller:</p>\n\n<pre><code>def find_countries\n    @countries =  CountryStateSelect.countries_collection\n    render :json=&gt;{ :countries=&gt; @countries }\n  end\n</code></pre>\n\n<p>I want to separate this country list array like this.</p>\n\n<pre><code>{\n    \"countries\": [\n        [\n            value:\"Andorra\",\n            key: \"AD\"\n        ],\n        [\n           value: \"United Arab Emirates\",\n            key:\"AE\"\n        ],\n        [\n           value: \"Afghanistan\",\n            key:\"AF\"\n        ],\n        [\n            value:\"Antigua and Barbuda\",\n            key:\"AG\"\n        ]\n        ]}\n</code></pre>\n\n<p>I cannot identify the value and the key. How can I separate this JSON response as above?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "activerecord"], "comments": [{"owner": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "edited": false, "score": 1, "creation_date": 1545820430, "post_id": 53930719, "comment_id": 94702199, "body": "What&#39;s <code>location</code>?"}, {"owner": {"reputation": 45, "user_id": 6195060, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-vfBEIuteuWs/AAAAAAAAAAI/AAAAAAAAAJY/7q8j1V0CW70/photo.jpg?sz=128", "display_name": "Abhishek N", "link": "https://stackoverflow.com/users/6195060/abhishek-n"}, "reply_to_user": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "edited": false, "score": 0, "creation_date": 1545821735, "post_id": 53930719, "comment_id": 94702654, "body": "location is a different object."}, {"owner": {"reputation": 6462, "user_id": 3784008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/55ou4.jpg?s=128&g=1", "display_name": "anothermh", "link": "https://stackoverflow.com/users/3784008/anothermh"}, "edited": false, "score": 0, "creation_date": 1545869740, "post_id": 53930719, "comment_id": 94716831, "body": "Please properly indent code samples when posting a question."}], "answers": [{"comments": [{"owner": {"reputation": 45, "user_id": 6195060, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-vfBEIuteuWs/AAAAAAAAAAI/AAAAAAAAAJY/7q8j1V0CW70/photo.jpg?sz=128", "display_name": "Abhishek N", "link": "https://stackoverflow.com/users/6195060/abhishek-n"}, "edited": false, "score": 0, "creation_date": 1545820449, "post_id": 53930778, "comment_id": 94702204, "body": "Thanks for the answer. yeah added includes but I am asking about query on member."}, {"owner": {"reputation": 1275, "user_id": 2903313, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ce1623b00b100930ac65e69a8069cd28?s=128&d=identicon&r=PG", "display_name": "Roc Khalil", "link": "https://stackoverflow.com/users/2903313/roc-khalil"}, "reply_to_user": {"reputation": 45, "user_id": 6195060, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-vfBEIuteuWs/AAAAAAAAAAI/AAAAAAAAAJY/7q8j1V0CW70/photo.jpg?sz=128", "display_name": "Abhishek N", "link": "https://stackoverflow.com/users/6195060/abhishek-n"}, "edited": false, "score": 0, "creation_date": 1545820648, "post_id": 53930778, "comment_id": 94702288, "body": "okay; so now you&#39;ve loaded the members in the memory, the <code>find_by_id</code> will reload that user so you should remove it. you need to do: <code>locations = []</code> <code>members.each { |member| locations &lt;&lt; member.location }</code>; this will load the locations from the memory instead of the database - or simple: <code>locations = members.map(&amp;:location)</code>"}, {"owner": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "edited": false, "score": 0, "creation_date": 1545820937, "post_id": 53930778, "comment_id": 94702388, "body": "I guess <code>map(&amp;:location)</code> is the worst you can do."}, {"owner": {"reputation": 1275, "user_id": 2903313, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ce1623b00b100930ac65e69a8069cd28?s=128&d=identicon&r=PG", "display_name": "Roc Khalil", "link": "https://stackoverflow.com/users/2903313/roc-khalil"}, "reply_to_user": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "edited": false, "score": 0, "creation_date": 1545821115, "post_id": 53930778, "comment_id": 94702448, "body": "@SebastianPalma and why is that ?"}, {"owner": {"reputation": 45, "user_id": 6195060, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-vfBEIuteuWs/AAAAAAAAAAI/AAAAAAAAAJY/7q8j1V0CW70/photo.jpg?sz=128", "display_name": "Abhishek N", "link": "https://stackoverflow.com/users/6195060/abhishek-n"}, "edited": false, "score": 0, "creation_date": 1545821215, "post_id": 53930778, "comment_id": 94702480, "body": "Updated the question. Cannot use iterator on member as mentioned in question."}, {"owner": {"reputation": 1275, "user_id": 2903313, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ce1623b00b100930ac65e69a8069cd28?s=128&d=identicon&r=PG", "display_name": "Roc Khalil", "link": "https://stackoverflow.com/users/2903313/roc-khalil"}, "reply_to_user": {"reputation": 45, "user_id": 6195060, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-vfBEIuteuWs/AAAAAAAAAAI/AAAAAAAAAJY/7q8j1V0CW70/photo.jpg?sz=128", "display_name": "Abhishek N", "link": "https://stackoverflow.com/users/6195060/abhishek-n"}, "edited": false, "score": 0, "creation_date": 1545821255, "post_id": 53930778, "comment_id": 94702488, "body": "@AbhishekNicchanametla your code makes no sense to be honest; can you post the models + relationships so we can help you ?"}, {"owner": {"reputation": 45, "user_id": 6195060, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-vfBEIuteuWs/AAAAAAAAAAI/AAAAAAAAAJY/7q8j1V0CW70/photo.jpg?sz=128", "display_name": "Abhishek N", "link": "https://stackoverflow.com/users/6195060/abhishek-n"}, "edited": false, "score": 0, "creation_date": 1545821440, "post_id": 53930778, "comment_id": 94702550, "body": "Ok. Member has many locations through profile answers. And also Member has many users. I need the mapping of user and location. i.e I need for given users what is the location."}, {"owner": {"reputation": 1275, "user_id": 2903313, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ce1623b00b100930ac65e69a8069cd28?s=128&d=identicon&r=PG", "display_name": "Roc Khalil", "link": "https://stackoverflow.com/users/2903313/roc-khalil"}, "edited": false, "score": 0, "creation_date": 1545821831, "post_id": 53930778, "comment_id": 94702687, "body": "OK. Maybe you can do something like that: <code>User.includes(members: :locations).each { |user| user.member.location }</code>; if your relationships are correct, this should work :-)"}, {"owner": {"reputation": 45, "user_id": 6195060, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-vfBEIuteuWs/AAAAAAAAAAI/AAAAAAAAAJY/7q8j1V0CW70/photo.jpg?sz=128", "display_name": "Abhishek N", "link": "https://stackoverflow.com/users/6195060/abhishek-n"}, "edited": false, "score": 0, "creation_date": 1545822080, "post_id": 53930778, "comment_id": 94702774, "body": "Tried it already but the number of records of users and members is huge. Also, the size of each record of member is also big. Sio performance is bad as we are loading lot of unnecessary data."}, {"owner": {"reputation": 1275, "user_id": 2903313, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ce1623b00b100930ac65e69a8069cd28?s=128&d=identicon&r=PG", "display_name": "Roc Khalil", "link": "https://stackoverflow.com/users/2903313/roc-khalil"}, "edited": false, "score": 0, "creation_date": 1545822498, "post_id": 53930778, "comment_id": 94702933, "body": "Then paginate the data, get the users for specific members only; not sure what you really need here, but this is something that you can start from."}, {"owner": {"reputation": 45, "user_id": 6195060, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-vfBEIuteuWs/AAAAAAAAAAI/AAAAAAAAAJY/7q8j1V0CW70/photo.jpg?sz=128", "display_name": "Abhishek N", "link": "https://stackoverflow.com/users/6195060/abhishek-n"}, "edited": false, "score": 0, "creation_date": 1545822746, "post_id": 53930778, "comment_id": 94703034, "body": "Member.all.includes(:locations).select(:id).map{|m| [m.id, m.location]}.to_h  This query is taking the least time as we are getting rid of unwanted data at sql level itself and creating active record object with only id."}], "tags": [], "owner": {"reputation": 1275, "user_id": 2903313, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ce1623b00b100930ac65e69a8069cd28?s=128&d=identicon&r=PG", "display_name": "Roc Khalil", "link": "https://stackoverflow.com/users/2903313/roc-khalil"}, "is_accepted": false, "score": -1, "last_activity_date": 1545820210, "creation_date": 1545820210, "answer_id": 53930778, "question_id": 53930719, "link": "https://stackoverflow.com/questions/53930719/multiple-queries-in-active-record/53930778#53930778", "title": "Multiple queries in active record", "body": "<p>If the <code>location</code> is a model, you should use includes; <code>includes</code> will run a query to get your initial <code>model</code>'s data and the included models</p>\n\n<pre><code>program = Program.first\nids = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]\nmembers = Members.includes(:locations).where(id: ids)\n</code></pre>\n\n<p>Now when you get the first members, calling its location will be read from the memory.</p>\n\n<p>If the <code>location</code> is a column and you want to load all members, you can do:</p>\n\n<pre><code>program = Program.first\nids = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]\nmembers = Members.where(id: ids)\nlocations = members.pluck(:location)\n</code></pre>\n\n<p>And finally, if you don't want to use the members, you can do:</p>\n\n<pre><code>program = Program.first\nids = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]\nlocations = Members.where(id: ids).pluck(:location)\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 45, "user_id": 6195060, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-vfBEIuteuWs/AAAAAAAAAAI/AAAAAAAAAJY/7q8j1V0CW70/photo.jpg?sz=128", "display_name": "Abhishek N", "link": "https://stackoverflow.com/users/6195060/abhishek-n"}, "edited": false, "score": 0, "creation_date": 1545821142, "post_id": 53930897, "comment_id": 94702458, "body": "thanks for the answer. updated the question. the question is why multiple member queries."}], "tags": [], "owner": {"reputation": 5060, "user_id": 10522579, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7GQ6a.jpg?s=128&g=1", "display_name": "ray", "link": "https://stackoverflow.com/users/10522579/ray"}, "is_accepted": false, "score": 0, "last_activity_date": 1545822504, "last_edit_date": 1545822504, "creation_date": 1545820841, "answer_id": 53930897, "question_id": 53930719, "link": "https://stackoverflow.com/questions/53930719/multiple-queries-in-active-record/53930897#53930897", "title": "Multiple queries in active record", "body": "<p>By your code, it is supposed that you have model <code>Location</code> with table name 'profile_answers' table.</p>\n\n<p>Member has many profile_answers &amp; has many locations through profile_answers .</p>\n\n<p>Then,</p>\n\n<pre><code>members = Members.includes(profile_answers: :locations).where(id: ids)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "is_accepted": false, "score": 0, "last_activity_date": 1545821320, "creation_date": 1545821320, "answer_id": 53930989, "question_id": 53930719, "link": "https://stackoverflow.com/questions/53930719/multiple-queries-in-active-record/53930989#53930989", "title": "Multiple queries in active record", "body": "<p><code>members</code> is a scope. <code>members.find_by</code> executes a query on scope. Hence an <code>N+1</code>.</p>\n\n<p>You want instead:</p>\n\n<pre><code>members =\n  Member.\n    where(id: ids).\n    includes(:locations).\n    to_a # greedy load\n\nputs members.map(&amp;:location) # or whatever\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 45, "user_id": 6195060, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-vfBEIuteuWs/AAAAAAAAAAI/AAAAAAAAAJY/7q8j1V0CW70/photo.jpg?sz=128", "display_name": "Abhishek N", "link": "https://stackoverflow.com/users/6195060/abhishek-n"}, "edited": false, "score": 0, "creation_date": 1545821841, "post_id": 53931019, "comment_id": 94702690, "body": "Thanks for the answer. Yeah the member count is huge."}, {"owner": {"reputation": 2735, "user_id": 7006199, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kFqCJ.jpg?s=128&g=1", "display_name": "Nimish Gupta", "link": "https://stackoverflow.com/users/7006199/nimish-gupta"}, "reply_to_user": {"reputation": 45, "user_id": 6195060, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-vfBEIuteuWs/AAAAAAAAAAI/AAAAAAAAAJY/7q8j1V0CW70/photo.jpg?sz=128", "display_name": "Abhishek N", "link": "https://stackoverflow.com/users/6195060/abhishek-n"}, "edited": false, "score": 0, "creation_date": 1545821927, "post_id": 53931019, "comment_id": 94702718, "body": "what would be count?"}, {"owner": {"reputation": 45, "user_id": 6195060, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-vfBEIuteuWs/AAAAAAAAAAI/AAAAAAAAAJY/7q8j1V0CW70/photo.jpg?sz=128", "display_name": "Abhishek N", "link": "https://stackoverflow.com/users/6195060/abhishek-n"}, "edited": false, "score": 0, "creation_date": 1545822294, "post_id": 53931019, "comment_id": 94702856, "body": "50k users 30k memebrs"}, {"owner": {"reputation": 2735, "user_id": 7006199, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kFqCJ.jpg?s=128&g=1", "display_name": "Nimish Gupta", "link": "https://stackoverflow.com/users/7006199/nimish-gupta"}, "reply_to_user": {"reputation": 45, "user_id": 6195060, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-vfBEIuteuWs/AAAAAAAAAAI/AAAAAAAAAJY/7q8j1V0CW70/photo.jpg?sz=128", "display_name": "Abhishek N", "link": "https://stackoverflow.com/users/6195060/abhishek-n"}, "edited": false, "score": 0, "creation_date": 1545824545, "post_id": 53931019, "comment_id": 94703612, "body": "it won&#39;t compromise much if members are 30k"}], "tags": [], "owner": {"reputation": 2735, "user_id": 7006199, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kFqCJ.jpg?s=128&g=1", "display_name": "Nimish Gupta", "link": "https://stackoverflow.com/users/7006199/nimish-gupta"}, "is_accepted": true, "score": 1, "last_activity_date": 1545821473, "creation_date": 1545821473, "answer_id": 53931019, "question_id": 53930719, "link": "https://stackoverflow.com/questions/53930719/multiple-queries-in-active-record/53931019#53931019", "title": "Multiple queries in active record", "body": "<p>Your code would be firing a query for each  <code>Member</code> load because of the line</p>\n\n<pre><code>members.find_by(id: ids[i]).location\n</code></pre>\n\n<p>Here you have explicitly used <code>find_by</code> which is firing a query for each member also for location.</p>\n\n<p>If reducing the query is priority then you may make use of ruby here</p>\n\n<pre><code>def c\n  ids = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]\n  users = User.all\n  members = Member.where(id: ids).includes(:locations)\n  user_id_to_member_id_mapping = {} # Not empty. hash that gives member_id for each userid  \n  users.each do |user|\n   puts members.find { |m| m.id == user_id_to_member_id_mapping[user.id] }&amp;.location\nend\n</code></pre>\n\n<p>Please note this would impact your performance if the Members count is very high.</p>\n"}], "owner": {"reputation": 45, "user_id": 6195060, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-vfBEIuteuWs/AAAAAAAAAAI/AAAAAAAAAJY/7q8j1V0CW70/photo.jpg?sz=128", "display_name": "Abhishek N", "link": "https://stackoverflow.com/users/6195060/abhishek-n"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 74, "favorite_count": 0, "accepted_answer_id": 53931019, "answer_count": 4, "score": -3, "last_activity_date": 1555667032, "creation_date": 1545819898, "last_edit_date": 1555667032, "question_id": 53930719, "link": "https://stackoverflow.com/questions/53930719/multiple-queries-in-active-record", "title": "Multiple queries in active record", "body": "<p>If I run this query in rails console,</p>\n\n<pre><code>def c\n  ids = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]\n  users = User.all\n  members = Member.where(id: ids).includes(:locations)\n  user_id_to_member_id_mapping = {} # Not empty. hash that gives member_id for each userid  \n  users.each do |user|\n    puts members.find_by(id: user_id_to_member_id_mapping[user.id]).location\n  end\nend\n</code></pre>\n\n<p>multiple queries (Member object queries) are fired (one for each value of <code>i</code>). Are the members already in memory (<code>members</code> variable)? How can I get the data needed above to make a single query?</p>\n\n<pre><code>Member Load (0.2ms)  SELECT  `members`.* FROM `members` WHERE `members`.`id` IN (1, 2, 3, 4, 5, 6, 7, 8, 9, 10) AND `members`.`id` = 1 LIMIT 1\n  ProfileAnswer Load (0.4ms)  SELECT `profile_answers`.* FROM `profile_answers` WHERE `profile_answers`.`member_id` = 1\n  Member Load (0.4ms)  SELECT  `members`.* FROM `members` WHERE `members`.`id` IN (1, 2, 3, 4, 5, 6, 7, 8, 9, 10) AND `members`.`id` = 2 LIMIT 1\n  ProfileAnswer Load (0.2ms)  SELECT `profile_answers`.* FROM `profile_answers` WHERE `profile_answers`.`member_id` = 2\n  Member Load (0.2ms)  SELECT  `members`.* FROM `members` WHERE `members`.`id` IN (1, 2, 3, 4, 5, 6, 7, 8, 9, 10) AND `members`.`id` = 3 LIMIT 1\n  ProfileAnswer Load (0.2ms)  SELECT `profile_answers`.* FROM `profile_answers` WHERE `profile_answers`.`member_id` = 3\n  Member Load (0.2ms)  SELECT  `members`.* FROM `members` WHERE `members`.`id` IN (1, 2, 3, 4, 5, 6, 7, 8, 9, 10) AND `members`.`id` = 4 LIMIT 1\n  ProfileAnswer Load (0.2ms)  SELECT `profile_answers`.* FROM `profile_answers` WHERE `profile_answers`.`member_id` = 4\n  Member Load (0.2ms)  SELECT  `members`.* FROM `members` WHERE `members`.`id` IN (1, 2, 3, 4, 5, 6, 7, 8, 9, 10) AND `members`.`id` = 5 LIMIT 1\n  ProfileAnswer Load (0.2ms)  SELECT `profile_answers`.* FROM `profile_answers` WHERE `profile_answers`.`member_id` = 5\n  Member Load (0.4ms)  SELECT  `members`.* FROM `members` WHERE `members`.`id` IN (1, 2, 3, 4, 5, 6, 7, 8, 9, 10) AND `members`.`id` = 6 LIMIT 1\n</code></pre>\n\n<p>I can't use <code>member.each</code> as the iterator is on a different condition.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "activerecord"], "comments": [{"owner": {"reputation": 814, "user_id": 5479076, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/ebf84ecaf15f684b53f18b9313cd1325?s=128&d=identicon&r=PG&f=1", "display_name": "Orsay", "link": "https://stackoverflow.com/users/5479076/orsay"}, "reply_to_user": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 0, "creation_date": 1545826334, "post_id": 53930337, "comment_id": 94704215, "body": "@sawa Yes sorry, I didn&#39;t set the title properly"}], "answers": [{"tags": [], "owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "is_accepted": true, "score": 1, "last_activity_date": 1545818528, "creation_date": 1545818528, "answer_id": 53930421, "question_id": 53930337, "link": "https://stackoverflow.com/questions/53930337/why-do-i-get-undefined-method-default-scoped/53930421#53930421", "title": "Why do I get undefined method `default_scoped?&#39;?", "body": "<p>Here:</p>\n\n<pre><code>scope :obseques, -&gt; {\n  joins(:produit).\n    merge(produit_id: Produit.obseque.map(&amp;:id)) # \u21d0 HERE\n}\n</code></pre>\n\n<p>You are passing a hash parameter to <code>merge</code>. You should join the scopes instead:</p>\n\n<pre><code>scope :obseques, -&gt; {\n  joins(:produit).\n    where(produit_id: Produit.obseque.map(&amp;:id))\n}\n</code></pre>\n"}], "owner": {"reputation": 814, "user_id": 5479076, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/ebf84ecaf15f684b53f18b9313cd1325?s=128&d=identicon&r=PG&f=1", "display_name": "Orsay", "link": "https://stackoverflow.com/users/5479076/orsay"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 182, "favorite_count": 0, "accepted_answer_id": 53930421, "answer_count": 1, "score": 0, "last_activity_date": 1545826303, "creation_date": 1545817994, "last_edit_date": 1545826303, "question_id": 53930337, "link": "https://stackoverflow.com/questions/53930337/why-do-i-get-undefined-method-default-scoped", "title": "Why do I get undefined method `default_scoped?&#39;?", "body": "<p>Starting from the object contract I would like to get all contract which get a product related to object <code>obseque</code></p>\n\n<p>So I created a scope : </p>\n\n<p><strong>produit.rb</strong></p>\n\n<pre><code>def self.named_scope_obseque_method\n where(:code_reference =&gt; Produit::PRODUIT_REF_OB)\nend\n\nscope(:obseque, proc { named_scope_obseque_method })\n</code></pre>\n\n<p><strong>contrat.rb</strong></p>\n\n<pre><code>scope :obseques, -&gt; {joins(:produit).merge(produit_id: Produit.obseque.map(&amp;:id))}\n</code></pre>\n\n<p>And calling <code>Contrat.obseques</code> should return all contract which has a <code>product</code> related to <code>obseque</code></p>\n\n<p>But I get : </p>\n\n<blockquote>\n  <blockquote>\n    <p>NoMethodError: undefined method <code>default_scoped?' for {:produit_id=&gt;[3]}:Hash\n    from /usr/local/bundle/gems/activerecord-3.2.15/lib/active_record/relation/spawn_methods.rb:11:in</code>merge'</p>\n  </blockquote>\n</blockquote>\n\n<hr>\n\n<p><strong>schema.rb</strong></p>\n\n<pre><code>  create_table \"produits\", :force =&gt; true do |t|\n    t.string \"initiales\",      :limit =&gt; 2\n    t.string \"code_reference\", :limit =&gt; 100\n  end\n\n  create_table \"obseques\", :force =&gt; true do |t|\n    t.string  \"nom\"\n    t.integer \"produit_id\"\n  end\n\n  create_table \"contrats\", :force =&gt; true do |t|\n    ...\n    t.integer  \"produit_id\"\n    ...\n  end\n</code></pre>\n\n<p><strong>Produit.rb</strong></p>\n\n<pre><code> has_one :obseque, :class_name =&gt; \"Obseque\", :foreign_key =&gt; \"produit_id\"\n has_many :contrats, :class_name =&gt; \"Contrat\", :foreign_key =&gt; \"produit_id\"\n</code></pre>\n\n<p><strong>contrat.rb</strong></p>\n\n<pre><code>  belongs_to :produit, :class_name =&gt; \"Produit\", :foreign_key =&gt; \"produit_id\"\n</code></pre>\n\n<p><strong>obseque.rb</strong></p>\n\n<pre><code>  belongs_to :produit, :class_name =&gt; \"Produit\", :foreign_key =&gt; \"produit_id\"\n</code></pre>\n"}, {"tags": ["ruby", "minitest", "webmock"], "comments": [{"owner": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "edited": false, "score": 0, "creation_date": 1545820090, "post_id": 53930141, "comment_id": 94702093, "body": "what is the purpose of this test?"}, {"owner": {"reputation": 195, "user_id": 7125235, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/29f17b4979ae1fda0c75e53599edf2b0?s=128&d=identicon&r=PG&f=1", "display_name": "sparkstar", "link": "https://stackoverflow.com/users/7125235/sparkstar"}, "reply_to_user": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "edited": false, "score": 0, "creation_date": 1545820309, "post_id": 53930141, "comment_id": 94702163, "body": "The error message is displayed on a error logging page. I have defined custom error messages for different scenarios but without making actual calls how do I replicate them for tests?"}, {"owner": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "edited": false, "score": 0, "creation_date": 1545820990, "post_id": 53930141, "comment_id": 94702401, "body": "Have a look at this article <a href=\"https://semaphoreci.com/community/tutorials/mocking-in-ruby-with-minitest\" rel=\"nofollow noreferrer\">semaphoreci.com/community/tutorials/&hellip;</a>"}], "owner": {"reputation": 195, "user_id": 7125235, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/29f17b4979ae1fda0c75e53599edf2b0?s=128&d=identicon&r=PG&f=1", "display_name": "sparkstar", "link": "https://stackoverflow.com/users/7125235/sparkstar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 77, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1545824672, "creation_date": 1545817040, "last_edit_date": 1545824672, "question_id": 53930141, "link": "https://stackoverflow.com/questions/53930141/how-to-test-a-function-called-within-a-thread-in-ruby-using-minitest", "title": "How to test a function called within a thread in ruby using minitest?", "body": "<p>The function fetch_details is called within the thread. It has a post request which raises the CustomError in case of failure. I need to test the \nCustomError without actually making the actual post request.   </p>\n\n<pre><code>Thread.new {\n      begin\n        details = fetch_details(a, b)\n        param1, param2 = parse_details(details, b)\n        post_result(\"Success\", url)\n      rescue CustomError =&gt; e  \n        post_result(e.message, url)\n      end\n    }\n</code></pre>\n\n<p>How do I stub the post request inside the fetch_details function to raise the Custom Error?</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 0, "creation_date": 1545812979, "post_id": 53929345, "comment_id": 94699674, "body": "I don&#39;t need any help."}], "answers": [{"comments": [{"owner": {"reputation": 19, "user_id": 10427533, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-94IWqhH1K7M/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DWaFiUwt8NzcJGJtxAPqwuk9xGKmw/mo/photo.jpg?sz=128", "display_name": "Adarsh KL", "link": "https://stackoverflow.com/users/10427533/adarsh-kl"}, "edited": false, "score": 0, "creation_date": 1545819436, "post_id": 53929409, "comment_id": 94701866, "body": "config.action_controller.asset_host = &#39;<a href=\"http://localhost:3000\" rel=\"nofollow noreferrer\">localhost:3000</a>&#39; I&#39;m add this code in  /config/environments/.rb but getting = undefined local variable or method `config&#39; for main:Object (NameError)"}], "tags": [], "owner": {"reputation": 30101, "user_id": 783412, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/895a112c66d93cefcd06d2cf371219e6?s=128&d=identicon&r=PG", "display_name": "hd1", "link": "https://stackoverflow.com/users/783412/hd1"}, "is_accepted": false, "score": 0, "last_activity_date": 1545822462, "last_edit_date": 1545822462, "creation_date": 1545812802, "answer_id": 53929409, "question_id": 53929345, "link": "https://stackoverflow.com/questions/53929345/how-can-i-get-complete-absolute-url-for-paperclip-attachment/53929409#53929409", "title": "How can I get complete absolute URL for paperclip attachment?", "body": "<p>According to this <a href=\"https://github.com/thoughtbot/paperclip/issues/584#issuecomment-1985865\" rel=\"nofollow noreferrer\">github issue</a>, it is cleaner to use ActionController::Base.asset_host so it would result the helper:</p>\n\n<pre><code>  def add_host_prefix(url)\n    URI.join(ActionController::Base.asset_host, url)\n  end\n</code></pre>\n\n<p>This supposes you have  the following in every /config/environments/<em>environment</em>.rb file:</p>\n\n<pre><code>Appname::Application.configure do\n\n  # ....\n\n  config.action_controller.asset_host = 'http://localhost:3000' # Locally\n\n  # ....\n\nend\n</code></pre>\n\n<p>Hope it helps</p>\n"}, {"comments": [{"owner": {"reputation": 5060, "user_id": 10522579, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7GQ6a.jpg?s=128&g=1", "display_name": "ray", "link": "https://stackoverflow.com/users/10522579/ray"}, "reply_to_user": {"reputation": 19, "user_id": 10427533, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-94IWqhH1K7M/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DWaFiUwt8NzcJGJtxAPqwuk9xGKmw/mo/photo.jpg?sz=128", "display_name": "Adarsh KL", "link": "https://stackoverflow.com/users/10427533/adarsh-kl"}, "edited": false, "score": 0, "creation_date": 1545819761, "post_id": 53929416, "comment_id": 94701992, "body": "What url do you get by <code>item_image_abs_url</code> ?"}, {"owner": {"reputation": 19, "user_id": 10427533, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-94IWqhH1K7M/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DWaFiUwt8NzcJGJtxAPqwuk9xGKmw/mo/photo.jpg?sz=128", "display_name": "Adarsh KL", "link": "https://stackoverflow.com/users/10427533/adarsh-kl"}, "edited": false, "score": 0, "creation_date": 1545820203, "post_id": 53929416, "comment_id": 94702121, "body": "has you say i add your code config/development.rb = APP_URL = &#39;<a href=\"http://localhost:3000\" rel=\"nofollow noreferrer\">localhost:3000</a>&#39; and also test.rb and production.rb def item_image_abs_url     &quot;#{APP_URL}item_image.url(:original)}&quot; end but noting working is in same condition has i show above json data.."}, {"owner": {"reputation": 5060, "user_id": 10522579, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7GQ6a.jpg?s=128&g=1", "display_name": "ray", "link": "https://stackoverflow.com/users/10522579/ray"}, "reply_to_user": {"reputation": 19, "user_id": 10427533, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-94IWqhH1K7M/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DWaFiUwt8NzcJGJtxAPqwuk9xGKmw/mo/photo.jpg?sz=128", "display_name": "Adarsh KL", "link": "https://stackoverflow.com/users/10427533/adarsh-kl"}, "edited": false, "score": 0, "creation_date": 1545820819, "post_id": 53929416, "comment_id": 94702349, "body": "check in rails console by @image.item_image_url and tell what string you get"}, {"owner": {"reputation": 19, "user_id": 10427533, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-94IWqhH1K7M/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DWaFiUwt8NzcJGJtxAPqwuk9xGKmw/mo/photo.jpg?sz=128", "display_name": "Adarsh KL", "link": "https://stackoverflow.com/users/10427533/adarsh-kl"}, "edited": false, "score": 0, "creation_date": 1545821505, "post_id": 53929416, "comment_id": 94702573, "body": "for @image.item_image_url =                                                                      (undefined method <code>item_image_url&#39; for nil:NilClass)..for image.item_image_url =                                                    (undefined method </code>item_image_url&#39; for #&lt;Image::ActiveRecord_Relation:0x000055665ee042b8&gt;)"}, {"owner": {"reputation": 19, "user_id": 10427533, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-94IWqhH1K7M/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DWaFiUwt8NzcJGJtxAPqwuk9xGKmw/mo/photo.jpg?sz=128", "display_name": "Adarsh KL", "link": "https://stackoverflow.com/users/10427533/adarsh-kl"}, "edited": false, "score": 0, "creation_date": 1545821703, "post_id": 53929416, "comment_id": 94702643, "body": "for image = Image.first =&lt;Image id: 1, title: &quot;Pasta&quot;, filename: &quot;Burger.&quot;, item_image_file_name: &quot;images_(4).jpeg&quot;, item_image_content_type: &quot;image/jpeg&quot;, item_image_file_size: 12944, item_image_updated_at: &quot;2018-12-26 07:03:52&quot;, updated_at: &quot;2018-12-26 07:03:52&quot;, created_at: &quot;2018-12-26 07:03:52&quot;&gt;"}, {"owner": {"reputation": 19, "user_id": 10427533, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-94IWqhH1K7M/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DWaFiUwt8NzcJGJtxAPqwuk9xGKmw/mo/photo.jpg?sz=128", "display_name": "Adarsh KL", "link": "https://stackoverflow.com/users/10427533/adarsh-kl"}, "edited": false, "score": 0, "creation_date": 1545822748, "post_id": 53929416, "comment_id": 94703036, "body": "irb(main):001:0&gt; image = Image.first   Image Load (0.3ms)  SELECT  &quot;images&quot;.* FROM &quot;images&quot; ORDER BY &quot;images&quot;.&quot;id&quot; ASC LIMIT ?  [[&quot;LIMIT&quot;, 1]] =&gt; #&lt;Image id: 1, title: &quot;Pancakes.&quot;, filename: &quot;Pancakes.&quot;, item_image_file_name: &quot;download_(5).jpeg&quot;, item_image_content_type: &quot;image/jpeg&quot;, item_image_file_size: 13323, item_image_updated_at: &quot;2018-12-26 11:08:53&quot;, updated_at: &quot;2018-12-26 11:08:53&quot;, created_at: &quot;2018-12-26 11:08:53&quot;&gt; irb(main):002:0&gt; image.item_image.url =&gt; &quot;/system/images/item_images/000/000/001/original/download_%2&zwnj;&#8203;85%29.jpeg?154582253&zwnj;&#8203;3&quot; irb(main):003:0&gt;  show same ans."}, {"owner": {"reputation": 5060, "user_id": 10522579, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7GQ6a.jpg?s=128&g=1", "display_name": "ray", "link": "https://stackoverflow.com/users/10522579/ray"}, "reply_to_user": {"reputation": 19, "user_id": 10427533, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-94IWqhH1K7M/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DWaFiUwt8NzcJGJtxAPqwuk9xGKmw/mo/photo.jpg?sz=128", "display_name": "Adarsh KL", "link": "https://stackoverflow.com/users/10427533/adarsh-kl"}, "edited": false, "score": 0, "creation_date": 1545822865, "post_id": 53929416, "comment_id": 94703072, "body": "So add <code>APP_URL</code> in <code>developement.rb</code> restart console &amp;  try in console <code>&quot;#{APP_URL}#{image.item_image.url}&quot;</code>"}], "tags": [], "owner": {"reputation": 5060, "user_id": 10522579, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7GQ6a.jpg?s=128&g=1", "display_name": "ray", "link": "https://stackoverflow.com/users/10522579/ray"}, "is_accepted": false, "score": 0, "last_activity_date": 1545822131, "last_edit_date": 1545822131, "creation_date": 1545812882, "answer_id": 53929416, "question_id": 53929345, "link": "https://stackoverflow.com/questions/53929345/how-can-i-get-complete-absolute-url-for-paperclip-attachment/53929416#53929416", "title": "How can I get complete absolute URL for paperclip attachment?", "body": "<p>Define constant <code>APP_URL</code> in <code>config/development.rb</code> as,</p>\n\n<pre><code>APP_URL = 'http://localhost:3000'\n</code></pre>\n\n<p>For <code>test.rb</code> &amp; <code>production.rb</code>, You have to set as per your domain environment set up.</p>\n\n<p>And get it as,</p>\n\n<pre><code>def item_image_abs_url\n    \"#{APP_URL}#{item_image.url(:original)}\"\nend\n</code></pre>\n\n<p>Check following url you get in rails console,</p>\n\n<pre><code>image = Image.first\nimage.item_image.url\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2471, "user_id": 8063597, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/41fe33a379a7894b9246569a6e0396aa?s=128&d=identicon&r=PG&f=1", "display_name": "Rohan", "link": "https://stackoverflow.com/users/8063597/rohan"}, "is_accepted": false, "score": 0, "last_activity_date": 1545826871, "creation_date": 1545826871, "answer_id": 53932053, "question_id": 53929345, "link": "https://stackoverflow.com/questions/53929345/how-can-i-get-complete-absolute-url-for-paperclip-attachment/53932053#53932053", "title": "How can I get complete absolute URL for paperclip attachment?", "body": "<p>As per the description mentioned in the post it seems like you haven't specified the asset host in specific environment file.</p>\n\n<p>Appropriate way as defined in the above mentioned answer as well is to define asset hosts in the relevant config/environments/{environment} file:\nwhere the environment mentioned in the above line signifies development.rb, production.rb and test.rb(others as well if you have defined a custom environment)</p>\n\n<pre><code>onfig.action_controller.asset_host = \"http://localhost:3000\"\n</code></pre>\n\n<p>If you want to access it in views then use below mentioned code:</p>\n\n<pre><code>asset_url(model.attachment.url(:style))\n</code></pre>\n\n<p>If you want to access it rails console then use below mentioned code</p>\n\n<pre><code>helper.asset_url(model.attachment.url(:style))\n</code></pre>\n\n<p>If you want to use it in a model then use below mentioned code:</p>\n\n<pre><code>ApplicationController.helpers.asset_url(model.attachment.url(:style))\n</code></pre>\n\n<p>Hope it helps!!</p>\n"}], "owner": {"reputation": 19, "user_id": 10427533, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-94IWqhH1K7M/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DWaFiUwt8NzcJGJtxAPqwuk9xGKmw/mo/photo.jpg?sz=128", "display_name": "Adarsh KL", "link": "https://stackoverflow.com/users/10427533/adarsh-kl"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 369, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1545826871, "creation_date": 1545812415, "last_edit_date": 1545812533, "question_id": 53929345, "link": "https://stackoverflow.com/questions/53929345/how-can-i-get-complete-absolute-url-for-paperclip-attachment", "title": "How can I get complete absolute URL for paperclip attachment?", "body": "<p>I'm working on JSON data, I want to display complete image url with localhost name\nbut I'm getting half item_image_url..</p>\n\n<p>\"item_image_url\": \"/system/images/item_images/000/000/001/original/images_%284%29.jpeg?1545807832\"</p>\n\n<pre><code>{\n        \"id\": 1,\n        \"title\": \"Pasta\",\n        \"filename\": \"Burger.\",\n        \"item_image_file_name\": \"images_(4).jpeg\",\n        \"item_image_content_type\": \"image/jpeg\",\n        \"item_image_file_size\": 12944,\n        \"item_image_updated_at\": \"2018-12-26T07:03:52.284Z\",\n        \"updated_at\": \"2018-12-26T07:03:52.355Z\",\n        \"created_at\": \"2018-12-26T07:03:52.355Z\",\n        \"item_image_url\": \"/system/images/item_images/000/000/001/original/images_%284%29.jpeg?1545807832\"\n    }\n</code></pre>\n\n<p>how can i get this complete ulr like this\n <a href=\"http://localhost:3000/system/images/item_images/000/000/001/original/images_%284%29.jpeg?1545807832\" rel=\"nofollow noreferrer\">http://localhost:3000/system/images/item_images/000/000/001/original/images_%284%29.jpeg?1545807832</a></p>\n\n<p>in controller </p>\n\n<pre><code>class V1::ImagesController &lt; ApplicationController\n\n    skip_before_action :verify_authenticity_token\n\n    def index\n\n         @images = Image.all\n\n\n         render :json =&gt; @images.to_json(:methods =&gt; [:item_image_url])\n    end\n\n    def show\n        image = Image.find(params[:id])\n        render json: {status: 'success', data:image},status: :ok\n    end\n\n\n    def create\n         image = Image.new(image_params)\n        if  image.save\n            render json: {status: 'success', data:image},status: :ok    \n        else\n            render json: {status: 'error', message:'image not saved', data:image.errors},status: :unprocessable_entity  \n        end \n    end\n\n\n    def destroy\n        image = Image.find(params[:id])\n        image.destory\n        render json: {status: 'success', data:image},status: :ok    \n    end\n\n    private def image_params\n\n        params.permit(:item_image_url,:title,:filename)\n\n    end\n\nend\n</code></pre>\n\n<p>in model </p>\n\n<pre><code>class Image &lt; ApplicationRecord\n\n    has_attached_file :item_image, styles: { medium: \"300x300&gt;\", thumb: \"100x100&gt;\" }, default_url: \"/images/:style/missing.png\"\n    validates_attachment_content_type :item_image, content_type: /\\Aimage\\/.*\\z/\n\n\n    def item_image_url\n        self.item_image.url(:original)\n    end\n\nend\n</code></pre>\n\n<p>Pleas need help..</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "actioncable"], "comments": [{"owner": {"reputation": 6361, "user_id": 2097529, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/QnP8n.jpg?s=128&g=1", "display_name": "Kick Buttowski", "link": "https://stackoverflow.com/users/2097529/kick-buttowski"}, "edited": false, "score": 0, "creation_date": 1545812986, "post_id": 53929219, "comment_id": 94699676, "body": "see <a href=\"https://github.com/jrpolidario/live_record\" rel=\"nofollow noreferrer\">github.com/jrpolidario/live_record</a> if it helps"}, {"owner": {"reputation": 1704, "user_id": 3076240, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7aecba75e7673597442c574d786cec2f?s=128&d=identicon&r=PG&f=1", "display_name": "Jon", "link": "https://stackoverflow.com/users/3076240/jon"}, "edited": false, "score": 0, "creation_date": 1545858566, "post_id": 53929219, "comment_id": 94714372, "body": "Hello,  you would not open up a channel for each row of your table, You just broadcast to the channel for the page after each set is updated.    With ActionCable you can get back an object(s) in JSON.  you can then use javascript to loop through that list and update your UI (based on id, or other unique bit of information). Or you can get back a json response containing HTML and replace the row. Here are some good guides for action cable <a href=\"https://guides.rubyonrails.org/action_cable_overview.html\" rel=\"nofollow noreferrer\">guides.rubyonrails.org/action_cable_overview.html</a>, <a href=\"https://blog.heroku.com/real_time_rails_implementing_websockets_in_rails_5_with_action_cable\" rel=\"nofollow noreferrer\">blog.heroku.com/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 171, "user_id": 10034431, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mPDRY.jpg?s=128&g=1", "display_name": "Ivan Raszl", "link": "https://stackoverflow.com/users/10034431/ivan-raszl"}, "edited": false, "score": 0, "creation_date": 1545919877, "post_id": 53945437, "comment_id": 94731182, "body": "Both Guadam&#39;s answer and Kick&#39;s answers worked. Thank you!"}], "tags": [], "owner": {"reputation": 962, "user_id": 6895607, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/BMhRG.jpg?s=128&g=1", "display_name": "Gaudam Thiyagarajan", "link": "https://stackoverflow.com/users/6895607/gaudam-thiyagarajan"}, "is_accepted": true, "score": 1, "last_activity_date": 1545915164, "creation_date": 1545915164, "answer_id": 53945437, "question_id": 53929219, "link": "https://stackoverflow.com/questions/53929219/what-are-the-best-practices-of-updating-multiple-divs-with-actioncable-in-ruby-o/53945437#53945437", "title": "What are the best practices of updating multiple divs with ActionCable in Ruby on Rails?", "body": "<p>Definitely You can do so. And you don't have to open channel for each row. Just use the job id whose status has been changed and id corresponding row in table with same id. </p>\n\n<pre><code>ActionCable.server.broadcast \"job_status_update\", job_id: 'xxxxx', status: 'complete'\n</code></pre>\n\n<h1>.html</h1>\n\n<pre><code>&lt;table&gt;\n  &lt;% jobs.each do |job|%&gt;\n   &lt;tr&gt;\n     &lt;td id=\"&lt;%= job_id %&gt;\"&gt;\n     &lt;%= job.status %&gt;\n     &lt;/td&gt;\n   &lt;/tr&gt;\n &lt;% end %&gt;\n&lt;/table&gt;\n</code></pre>\n\n<h1>.coffee</h1>\n\n<pre><code>App.chatChannel = App.cable.subscriptions.create { channel: \"JobChannel\" },\n   received: (data) -&gt;\n     $(data.job_id).innerText(data.status)\n</code></pre>\n"}], "owner": {"reputation": 171, "user_id": 10034431, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mPDRY.jpg?s=128&g=1", "display_name": "Ivan Raszl", "link": "https://stackoverflow.com/users/10034431/ivan-raszl"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 207, "favorite_count": 0, "accepted_answer_id": 53945437, "answer_count": 1, "score": 3, "last_activity_date": 1545915164, "creation_date": 1545811559, "last_edit_date": 1545812361, "question_id": 53929219, "link": "https://stackoverflow.com/questions/53929219/what-are-the-best-practices-of-updating-multiple-divs-with-actioncable-in-ruby-o", "title": "What are the best practices of updating multiple divs with ActionCable in Ruby on Rails?", "body": "<p>I have a Ruby on Rails site. One of the index pages has a table with multiple rows. I also have a background job that does certain operations on each row, which takes about 5-10 seconds each.</p>\n\n<p>I would like to update the status for each row from 'Processing...' to 'Done' when the processing in the background job has completed.</p>\n\n<p>I was thinking to use Action Cable to do the update, but to date I only used Action Cable to update only one element on a page, never multiple elements.</p>\n\n<p>I was wondering what the correct way is to set-up my code to update the status in each row. Do I have to open a channel for each row separately?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "devise"], "comments": [{"owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 0, "creation_date": 1545808630, "post_id": 53928663, "comment_id": 94698403, "body": "Are you sure you want your app to show a broken English message &quot;You password is changed successfully[&quot;]?"}, {"owner": {"reputation": 462, "user_id": 1842105, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/1454e7a058e7e0ff535879e5745f74e5?s=128&d=identicon&r=PG", "display_name": "Sasha Stadnik", "link": "https://stackoverflow.com/users/1842105/sasha-stadnik"}, "edited": false, "score": 0, "creation_date": 1545817945, "post_id": 53928663, "comment_id": 94701302, "body": "Copy this file <a href=\"https://github.com/plataformatec/devise/blob/master/config/locales/en.yml\" rel=\"nofollow noreferrer\">en.yml</a> into your <code>config&#47;locales</code> and rename it to <code>devise.en.yml</code> after that change this key <code>passwords: -&gt; updated</code> in your <code>devise.en.yml</code>"}], "answers": [{"comments": [{"owner": {"reputation": 75, "user_id": 10549885, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zmCkO.jpg?s=128&g=1", "display_name": "Pujan Soni", "link": "https://stackoverflow.com/users/10549885/pujan-soni"}, "edited": false, "score": 0, "creation_date": 1545809543, "post_id": 53928809, "comment_id": 94698690, "body": "I didn&#39;t understand, can you explain or provide a link for reference?"}, {"owner": {"reputation": 5060, "user_id": 10522579, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7GQ6a.jpg?s=128&g=1", "display_name": "ray", "link": "https://stackoverflow.com/users/10522579/ray"}, "reply_to_user": {"reputation": 75, "user_id": 10549885, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zmCkO.jpg?s=128&g=1", "display_name": "Pujan Soni", "link": "https://stackoverflow.com/users/10549885/pujan-soni"}, "edited": false, "score": 0, "creation_date": 1545809736, "post_id": 53928809, "comment_id": 94698741, "body": "We can override devise flash messages, but structure must be followed, <a href=\"https://stackoverflow.com/q/20782770/10522579\">stackoverflow.com/q/20782770/10522579</a>"}, {"owner": {"reputation": 5060, "user_id": 10522579, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7GQ6a.jpg?s=128&g=1", "display_name": "ray", "link": "https://stackoverflow.com/users/10522579/ray"}, "reply_to_user": {"reputation": 75, "user_id": 10549885, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zmCkO.jpg?s=128&g=1", "display_name": "Pujan Soni", "link": "https://stackoverflow.com/users/10549885/pujan-soni"}, "edited": false, "score": 0, "creation_date": 1545809800, "post_id": 53928809, "comment_id": 94698759, "body": "I do not know which <code>devise</code> and <code>ruby</code> version you are using. Your devise.en.yml structure depends on which devise version you are using."}], "tags": [], "owner": {"reputation": 5060, "user_id": 10522579, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7GQ6a.jpg?s=128&g=1", "display_name": "ray", "link": "https://stackoverflow.com/users/10522579/ray"}, "is_accepted": false, "score": 1, "last_activity_date": 1545809171, "creation_date": 1545809171, "answer_id": 53928809, "question_id": 53928663, "link": "https://stackoverflow.com/questions/53928663/change-flash-message-on-devise-password-change/53928809#53928809", "title": "Change flash message on devise password change", "body": "<p>You can create your own <code>config/devise.en.yml</code></p>\n\n<p>update flash messages by taking reference from <code>/home/&lt;username&gt;/.rvm/gems/&lt;ruby-version&gt;/gems/devise-&lt;version-installed&gt;/config/locales/en.yml</code></p>\n\n<p>If you do not want to show flash message / remove it, just provide key with blank value.</p>\n"}], "owner": {"reputation": 75, "user_id": 10549885, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zmCkO.jpg?s=128&g=1", "display_name": "Pujan Soni", "link": "https://stackoverflow.com/users/10549885/pujan-soni"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 231, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1545809171, "creation_date": 1545808311, "question_id": 53928663, "link": "https://stackoverflow.com/questions/53928663/change-flash-message-on-devise-password-change", "title": "Change flash message on devise password change", "body": "<p>I am changing my password and the flash message is showing \"You are already signed in.\" and I want to show \"You password is changed successfully.</p>\n\n<p>I have searched what to do and one recommendation was to use i8n but I am looking for an alternate solution</p>\n\n<p>My edit.html.erb is given as:</p>\n\n<pre><code>&lt;%= form_for(resource, as: resource_name, url: registration_path(resource_name), html: { method: :put, id:'edit-pwd-profile' }) do |f| %&gt;\n        &lt;%= devise_error_messages! %&gt;\n\n        &lt;div class=\"form-group\"&gt;\n            &lt;%= f.label :current_password %&gt;\n            &lt;%= f.password_field :current_password, autocomplete: \"current-password\", class: \"form-control\" %&gt;\n        &lt;/div&gt;\n\n        &lt;div class=\"form-group\"&gt;\n            &lt;%= f.label :password %&gt;\n            &lt;%= f.password_field :password, autocomplete: \"new-password\", class: \"form-control\" %&gt;\n        &lt;/div&gt;\n\n        &lt;div class=\"form-group\"&gt;\n            &lt;%= f.label :password_confirmation %&gt;&lt;br /&gt;\n            &lt;%= f.password_field :password_confirmation, autocomplete: \"new-password\" , class: \"form-control\"%&gt;\n        &lt;/div&gt;\n\n        &lt;div class=\"actions form-group\"&gt;\n            &lt;%= f.submit \"Update\", class: 'btn btn-primary' %&gt;\n        &lt;/div&gt;\n    &lt;% end %&gt;\n</code></pre>\n\n<p>I expect \"Your password is changed successfully\"\nActual output is \"You are already signed in.\"</p>\n"}, {"tags": ["ruby", "pointers", "winapi", "x509certificate", "cryptoapi"], "comments": [{"owner": {"reputation": 9407, "user_id": 3997611, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5a853b68fa6a8c75f7490deb6ffdc639?s=128&d=identicon&r=PG", "display_name": "Crypt32", "link": "https://stackoverflow.com/users/3997611/crypt32"}, "edited": false, "score": 0, "creation_date": 1545809847, "post_id": 53928214, "comment_id": 94698771, "body": "And what is not working?"}, {"owner": {"reputation": 43, "user_id": 10829266, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-PxBxSaeqHcg/AAAAAAAAAAI/AAAAAAAAADI/6ZJAGQpo_xE/photo.jpg?sz=128", "display_name": "nimesh", "link": "https://stackoverflow.com/users/10829266/nimesh"}, "reply_to_user": {"reputation": 9407, "user_id": 3997611, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5a853b68fa6a8c75f7490deb6ffdc639?s=128&d=identicon&r=PG", "display_name": "Crypt32", "link": "https://stackoverflow.com/users/3997611/crypt32"}, "edited": false, "score": 0, "creation_date": 1545819434, "post_id": 53928214, "comment_id": 94701865, "body": "I&#39;m not getting a loaded <code>pcert_context </code>. It&#39;s value is coming as null."}, {"owner": {"reputation": 43, "user_id": 10829266, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-PxBxSaeqHcg/AAAAAAAAAAI/AAAAAAAAADI/6ZJAGQpo_xE/photo.jpg?sz=128", "display_name": "nimesh", "link": "https://stackoverflow.com/users/10829266/nimesh"}, "reply_to_user": {"reputation": 9407, "user_id": 3997611, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5a853b68fa6a8c75f7490deb6ffdc639?s=128&d=identicon&r=PG", "display_name": "Crypt32", "link": "https://stackoverflow.com/users/3997611/crypt32"}, "edited": false, "score": 0, "creation_date": 1545819529, "post_id": 53928214, "comment_id": 94701909, "body": "Like when I&#39;d try with other search options, like search by a valid issuer name, <code>pcert_context</code> gets loaded with an address. I think I&#39;m not passing <code>CRYPT_HASH_BLOB</code> in it&#39;s valid format."}], "answers": [{"comments": [{"owner": {"reputation": 43, "user_id": 10829266, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-PxBxSaeqHcg/AAAAAAAAAAI/AAAAAAAAADI/6ZJAGQpo_xE/photo.jpg?sz=128", "display_name": "nimesh", "link": "https://stackoverflow.com/users/10829266/nimesh"}, "edited": false, "score": 0, "creation_date": 1545825554, "post_id": 53931549, "comment_id": 94703961, "body": "Thank you. Your assumption is correct. First, the spaces have been discarded and then we are passing that string to the constructor. <code>arr</code> is a byte array, and <code>buffer3</code> contains a pointer to this byte array, which we are assigning to <code>:pbData</code>. I&#39;ve followed the similar things as per the googled suggestions, and tried and tested <code>method3</code> but still not getting the output :("}, {"owner": {"reputation": 9407, "user_id": 3997611, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5a853b68fa6a8c75f7490deb6ffdc639?s=128&d=identicon&r=PG", "display_name": "Crypt32", "link": "https://stackoverflow.com/users/3997611/crypt32"}, "reply_to_user": {"reputation": 43, "user_id": 10829266, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-PxBxSaeqHcg/AAAAAAAAAAI/AAAAAAAAADI/6ZJAGQpo_xE/photo.jpg?sz=128", "display_name": "nimesh", "link": "https://stackoverflow.com/users/10829266/nimesh"}, "edited": false, "score": 0, "creation_date": 1545825635, "post_id": 53931549, "comment_id": 94703984, "body": "Did you try my version of method 3? It is a bit different than your one."}, {"owner": {"reputation": 9407, "user_id": 3997611, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5a853b68fa6a8c75f7490deb6ffdc639?s=128&d=identicon&r=PG", "display_name": "Crypt32", "link": "https://stackoverflow.com/users/3997611/crypt32"}, "reply_to_user": {"reputation": 43, "user_id": 10829266, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-PxBxSaeqHcg/AAAAAAAAAAI/AAAAAAAAADI/6ZJAGQpo_xE/photo.jpg?sz=128", "display_name": "nimesh", "link": "https://stackoverflow.com/users/10829266/nimesh"}, "edited": false, "score": 0, "creation_date": 1545826283, "post_id": 53931549, "comment_id": 94704198, "body": "I&#39;m glad that it working. Then you can mark my response as answer."}, {"owner": {"reputation": 43, "user_id": 10829266, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-PxBxSaeqHcg/AAAAAAAAAAI/AAAAAAAAADI/6ZJAGQpo_xE/photo.jpg?sz=128", "display_name": "nimesh", "link": "https://stackoverflow.com/users/10829266/nimesh"}, "edited": false, "score": 0, "creation_date": 1545828222, "post_id": 53931549, "comment_id": 94704903, "body": "Done. Thanks again :)"}], "tags": [], "owner": {"reputation": 9407, "user_id": 3997611, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5a853b68fa6a8c75f7490deb6ffdc639?s=128&d=identicon&r=PG", "display_name": "Crypt32", "link": "https://stackoverflow.com/users/3997611/crypt32"}, "is_accepted": true, "score": 0, "last_activity_date": 1545824202, "creation_date": 1545824202, "answer_id": 53931549, "question_id": 53928214, "link": "https://stackoverflow.com/questions/53928214/unable-to-create-a-valid-crypt-hash-blob-in-ruby/53931549#53931549", "title": "Unable to create a valid CRYPT_HASH_BLOB in ruby", "body": "<p>I'm not familiar with Ruby at all, but I can make some assumptions. Correct me if I'm wrong.</p>\n\n<p>You are converting source thumbprint (SHA1 value) to a string without spaces between octets:</p>\n\n<pre><code>thumbprint ||= \"1D F4 AB B6 13 F2 12 27 1C 04 F8 52 9D DE 38 E4 B7 24 2E 6C\" # Assume this is a valid thumbprint in Root\nthumbprint.gsub!(/[^A-Za-z0-9]/, \"\") # Discard WhiteSpaces\n</code></pre>\n\n<p>This will result something like this: <code>1DF4ABB613F212271C04F8529DDE38E4B7242E6C</code> and then you pass this string into <code>CRYPT_HASH_BLOB</code> constructor in this line:</p>\n\n<pre><code>pcert_context = CertFindCertificateInStore(certstore_handler, ENCODING_TYPE, 0, CERT_FIND_SHA1_HASH, CRYPT_HASH_BLOB.new(thumbprint), nil)\n</code></pre>\n\n<p>In the <code>CRYPT_HASH_BLOB.initialize(str)</code> you unpack the utf8 string to a byte array. First method is incorrect, because you treat input string as raw char array. Instead, it is a hex-encoded byte array, thus <code>arr = [str].pack('H*').unpack('C*')</code> line must be involved. At least, google suggests that this line will convert a series of octets to a corresponding byte array. So, method 3 is just fine with the exception that you must allocate <strong>*byte*</strong> array (not integer array) and write chars instead of ints. The correct constructor code should look like this:</p>\n\n<pre><code>def initialize(str)\n    super(nil)\n    if str\n        # Converting thumbpring string into a byte array\n        arr = [str].pack('H*').unpack('C*')\n\n        # Method 3: Using Byte Array with FFI::MemoryPointer\n        buffer3 = FFI::MemoryPointer.new(:char, arr.size) # Create the pointer to the array\n        buffer3.write_array_of_char(arr) # Fill the memory location with data\n        self[:pbData] = buffer3\n        self[:cbData] = arr.size\n    end\nend\n</code></pre>\n\n<p>I believe, this will do the work.</p>\n"}], "owner": {"reputation": 43, "user_id": 10829266, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-PxBxSaeqHcg/AAAAAAAAAAI/AAAAAAAAADI/6ZJAGQpo_xE/photo.jpg?sz=128", "display_name": "nimesh", "link": "https://stackoverflow.com/users/10829266/nimesh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 139, "favorite_count": 0, "accepted_answer_id": 53931549, "answer_count": 1, "score": 1, "last_activity_date": 1545824202, "creation_date": 1545805557, "last_edit_date": 1545807830, "question_id": 53928214, "link": "https://stackoverflow.com/questions/53928214/unable-to-create-a-valid-crypt-hash-blob-in-ruby", "title": "Unable to create a valid CRYPT_HASH_BLOB in ruby", "body": "<p>I'm using Crypto API in Ruby to find a windows certificate using it's Thumbprint. For that I'm using <a href=\"https://docs.microsoft.com/en-us/windows/desktop/api/wincrypt/nf-wincrypt-certfindcertificateinstore\" rel=\"nofollow noreferrer\">CertFindCertificateInStore</a> function which requires a <a href=\"https://msdn.microsoft.com/en-us/7a06eae5-96d8-4ece-98cb-cf0710d2ddbd\" rel=\"nofollow noreferrer\">CRYPT_HASH_BLOB</a> structure.</p>\n\n<p>I'm dealing with pointers by using <code>FFI::MemoryPointer</code>. Have tried various approaches to create this struct but none of them seems to be working.</p>\n\n<p>Can someone please take a look and provide me suggestions.</p>\n\n<p>Here is the complete code for the reference:</p>\n\n<pre><code>    require \"ffi\"\n\n    module LibC\n      extend FFI::Library\n      ffi_lib FFI::Library::LIBC\n\n      # memory allocators\n      attach_function :malloc, [:size_t], :pointer\n      attach_function :calloc, [:size_t], :pointer\n      attach_function :free, [:pointer], :void\n    end\n\n    module Crypto\n      extend LibC\n      extend FFI::Library\n      ffi_lib \"Crypt32\"\n\n      HCERTSTORE               = FFI::TypeDefs[:pointer]\n      HCRYPTPROV_LEGACY        = FFI::TypeDefs[:pointer]\n      PCCERT_CONTEXT           = FFI::TypeDefs[:pointer]\n      DWORD                    = FFI::TypeDefs[:uint32]\n      BLOB                     = FFI::TypeDefs[:ulong]\n      LPCTSTR                  = FFI::TypeDefs[:pointer]\n      BOOL                     = FFI::TypeDefs[:bool]\n      LPVOID                   = FFI::TypeDefs[:pointer]\n\n      class CRYPT_HASH_BLOB &lt; FFI::Struct\n        layout :cbData, DWORD, # Count, in bytes, of data\n               :pbData, :pointer # Pointer to data buffer\n\n        def initialize(str)\n          super(nil)\n          if str\n            # Method 1: Simply using thumbprint string\n            buffer1 = LibC.malloc str.size\n            buffer1.write_string str\n            self[:pbData] = buffer1\n            self[:cbData] = str.size\n\n            # Converting thumbpring string into a byte array\n            # arr = [str].pack('H*').unpack('C*')\n\n            # Method 2: Using Byte Array  with LibC\n            # buffer2 = LibC.malloc(arr.first.size * arr.size) # Create the pointer to the array\n            # buffer2.write_array_of_uint32 arr                # Fill the memory location with data\n            # self[:pbData] = buffer2\n            # self[:cbData] = arr.size\n\n            # # Method 3: Using Byte Array with FFI::MemoryPointer\n            # buffer3 = FFI::MemoryPointer.new :uint32, arr.size # Create the pointer to the array\n            # buffer3.put_array_of_uint32 0, arr                 # Fill the memory location with data\n            # self[:pbData] = buffer3\n            # self[:cbData] = arr.size\n          end\n        end\n      end\n\n      attach_function :CertOpenStore, [DWORD, DWORD, HCRYPTPROV_LEGACY, DWORD, LPCTSTR], HCERTSTORE\n      attach_function :CertCloseStore, [HCERTSTORE, DWORD], BOOL\n      attach_function :CertFindCertificateInStore, [HCERTSTORE, DWORD, DWORD, DWORD, LPVOID, PCCERT_CONTEXT], PCCERT_CONTEXT\n      attach_function :CertFreeCertificateContext, [PCCERT_CONTEXT], BOOL\n    =begin\n      PCCERT_CONTEXT CertFindCertificateInStore(\n        HCERTSTORE     hCertStore,\n        DWORD          dwCertEncodingType,\n        DWORD          dwFindFlags,\n        DWORD          dwFindType,\n        const void     *pvFindPara,\n        PCCERT_CONTEXT pPrevCertContext\n      );\n    =end\n    end\n\n    class CertificateHandler\n      include Crypto\n      CERT_STORE_PROV_SYSTEM = 10\n      CERT_SYSTEM_STORE_LOCAL_MACHINE = 0x00020000\n      X509_ASN_ENCODING = 0x00000001\n      PKCS_7_ASN_ENCODING = 0x00010000\n      ENCODING_TYPE = X509_ASN_ENCODING | PKCS_7_ASN_ENCODING\n      CERT_CLOSE_STORE_FORCE_FLAG = 1\n\n      CERT_COMPARE_SHA1_HASH = 1\n      CERT_COMPARE_SHIFT = 16\n      CERT_FIND_SHA1_HASH = CERT_COMPARE_SHA1_HASH &lt;&lt; CERT_COMPARE_SHIFT\n\n      def self.finalize(certstore_handler)\n        proc { certstore_handler.to_s }\n      end\n\n      def add_finalizer(certstore_handler)\n        ObjectSpace.define_finalizer(self, self.class.finalize(certstore_handler))\n      end\n\n      def remove_finalizer\n        ObjectSpace.undefine_finalizer(self)\n      end\n\n      def utf8_to_wide(ustring)\n        # ensure it is actually UTF-8\n        # Ruby likes to mark binary data as ASCII-8BIT\n        ustring = (ustring + \"\").force_encoding(\"UTF-8\") if ustring.respond_to?(:force_encoding) &amp;&amp; ustring.encoding.name != \"UTF-8\"\n\n        # ensure we have the double-null termination Windows Wide likes\n        ustring += \"\\000\\000\" if ustring.length == 0 || ustring[-1].chr != \"\\000\"\n\n        # encode it all as UTF-16LE AKA Windows Wide Character AKA Windows Unicode\n        ustring = ustring.encode(\"UTF-16LE\") if ustring.respond_to?(:encode)\n        ustring\n      end\n\n      def cert_find_by_thumbprint(thumbprint = nil)\n        store_name = \"Root\"\n        thumbprint ||= \"1D F4 AB B6 13 F2 12 27 1C 04 F8 52 9D DE 38 E4 B7 24 2E 6C\" # Assume this is a valid thumbprint in Root\n        thumbprint.gsub!(/[^A-Za-z0-9]/, \"\") # Discard WhiteSpaces\n\n        certstore_handler = CertOpenStore(CERT_STORE_PROV_SYSTEM, 0, nil,\n          CERT_SYSTEM_STORE_LOCAL_MACHINE, utf8_to_wide(store_name))\n        add_finalizer(certstore_handler)\n\n        pcert_context = CertFindCertificateInStore(certstore_handler, ENCODING_TYPE, 0, CERT_FIND_SHA1_HASH, CRYPT_HASH_BLOB.new(thumbprint), nil)\n\n        puts \"Certificate Found = #{!pcert_context.null?}\" # It should be true\n\n        CertFreeCertificateContext(pcert_context)\n        closed = CertCloseStore(@certstore_handler, CERT_CLOSE_STORE_FORCE_FLAG)\n        remove_finalizer\n      end\n    end\n\n    CertificateHandler.new.cert_find_by_thumbprint\n</code></pre>\n"}, {"tags": ["javascript", "ruby-on-rails", "ruby", "ajax", "post"], "comments": [{"owner": {"reputation": 5669, "user_id": 7429104, "user_type": "registered", "accept_rate": 20, "profile_image": "https://i.stack.imgur.com/TZAPt.jpg?s=128&g=1", "display_name": "Aman", "link": "https://stackoverflow.com/users/7429104/aman"}, "edited": false, "score": 0, "creation_date": 1545803778, "post_id": 53927887, "comment_id": 94697156, "body": "Hi @martin, I can&#39;t see the ajax request to be fired on on click button instead it&#39;s been fired on <code>$(document).ready(function(){......})</code> ?"}, {"owner": {"reputation": 604, "user_id": 6365949, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/1Hn9j.jpg?s=128&g=1", "display_name": "Martin", "link": "https://stackoverflow.com/users/6365949/martin"}, "reply_to_user": {"reputation": 5669, "user_id": 7429104, "user_type": "registered", "accept_rate": 20, "profile_image": "https://i.stack.imgur.com/TZAPt.jpg?s=128&g=1", "display_name": "Aman", "link": "https://stackoverflow.com/users/7429104/aman"}, "edited": false, "score": 0, "creation_date": 1545804361, "post_id": 53927887, "comment_id": 94697296, "body": "sorry my question was missing that code, i fixed it. I know the js function works because whenever i click the button i get &quot;inside js click listener&quot; in console"}, {"owner": {"reputation": 1276, "user_id": 5399937, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ctCqj.png?s=128&g=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/5399937/tom"}, "edited": false, "score": 0, "creation_date": 1545810968, "post_id": 53927887, "comment_id": 94699100, "body": "<code>remote:true</code> should be <code>data-remote = &quot;true&quot;</code>. I don&#39;t think this is the crutch of the issue though."}], "answers": [{"tags": [], "owner": {"reputation": 5669, "user_id": 7429104, "user_type": "registered", "accept_rate": 20, "profile_image": "https://i.stack.imgur.com/TZAPt.jpg?s=128&g=1", "display_name": "Aman", "link": "https://stackoverflow.com/users/7429104/aman"}, "is_accepted": true, "score": 0, "last_activity_date": 1545886318, "last_edit_date": 1545886318, "creation_date": 1545804924, "answer_id": 53928121, "question_id": 53927887, "link": "https://stackoverflow.com/questions/53927887/ajax-post-request-controller-handling/53928121#53928121", "title": "ajax post request controller handling", "body": "<p>1=> Index.html.erb</p>\n\n<pre><code>&lt;!-- this line should be in application.html.erb \n  &lt;%#= javascript_include_tag \"application\" %&gt;\n--&gt;\n&lt;h1&gt;Welcome to my website#index&lt;/h1&gt;\n\n&lt;input class=\"className\" id=\"button_to_be_clicked\" type=\"button\" value=\"Click Me!\" id=\"my_button\"/&gt;\n\n&lt;ul id=\"ulID\"&gt;\n &lt;div class = 'want_to_change'&gt;This should change when button is pressd.&lt;/div&gt;\n&lt;/ul&gt;\n\n   &lt;script type=\"text/javascript\"&gt;\n     $('#button_to_be_clicked').on('click', function(){\n      // ajax request \n       $.ajax({\n         url: \"/superman\",\n         type: \"POST\",\n         data : {\n           value1: \"hello\",\n           value2: \"hello2\"            \n         },\n         dataType: \"script\",\n      });        \n     })\n   &lt;/script&gt;\n</code></pre>\n\n<p>2 => routes.rb</p>\n\n<pre><code>Rails.application.routes.draw do\n  root 'welcome#index'\n\n  post '/superman', to: 'welcome#superman'\n\n  resources :test do\n    collection do\n      get 'test'\n    end\n  end\nend\n</code></pre>\n\n<p>3 => welcome_controller.rb</p>\n\n<pre><code>class WelcomeController &lt; ApplicationController\n  def index\n  end\n\n  def superman\n    value1 = params[:value1]\n    value1 = params[:value2]\n    render plain: \"OK\"\n  end\n\nend\n</code></pre>\n\n<p>3 => superman.js.erb</p>\n\n<pre><code>$('.want_to_change').html(\"Text to be changed on ajax request.\")\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 648, "user_id": 7617067, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GFENc.jpg?s=128&g=1", "display_name": "Mohammad Shahnawaz", "link": "https://stackoverflow.com/users/7617067/mohammad-shahnawaz"}, "is_accepted": false, "score": 0, "last_activity_date": 1545808104, "creation_date": 1545808104, "answer_id": 53928620, "question_id": 53927887, "link": "https://stackoverflow.com/questions/53927887/ajax-post-request-controller-handling/53928620#53928620", "title": "ajax post request controller handling", "body": "<p>You can perform ajax request by using the gem <strong>remotipart</strong>\nYou simple need to add the gem</p>\n\n<pre><code>gem 'remotipart', github: 'mshibuya/remotipart', ref: '88d9a7'\n</code></pre>\n\n<p>Then you need to do some simple changes in the form</p>\n\n<pre><code>&lt;%= form_for @document, :html =&gt; { :multipart =&gt; true, :id =&gt; \"create-document-form\" }, :remote =&gt; true do |document_form| %&gt;\n  &lt;%= document_form.file_field :file_upload, class: \"custom-file-input\" %&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>For example i am using the above form for posting the new document throgh ajax\nSo in the controller It will directly come</p>\n\n<pre><code>def create\n  @document = Document.new(document_params)\n  respond_to do |format|\n    if @document.save\n      data = {visible_for_client: @document.visible_for_client, file_name: file_name.to_json, description: @document.description, file_path: file_url}.to_json\n      format.js { render :js =&gt; \"append_document(#{data});\" }\n    else\n      format.json { render json: { errors: @document.errors.full_messages }, status: 422 }\n    end\n  end\nend\n</code></pre>\n\n<p>So i wil call the js method from the controller and pass my message data and message throgh that method.</p>\n\n<pre><code>function append_document(data){\n  console.log(\"Document created successfully.\")\n}\n</code></pre>\n"}], "owner": {"reputation": 604, "user_id": 6365949, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/1Hn9j.jpg?s=128&g=1", "display_name": "Martin", "link": "https://stackoverflow.com/users/6365949/martin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 73, "favorite_count": 0, "accepted_answer_id": 53928121, "answer_count": 2, "score": 0, "last_activity_date": 1545886318, "creation_date": 1545803000, "last_edit_date": 1545804318, "question_id": 53927887, "link": "https://stackoverflow.com/questions/53927887/ajax-post-request-controller-handling", "title": "ajax post request controller handling", "body": "<p>I'm trying to get a simple ajax post request working, so that when I click a button on my html page, a javascript event listener is called, which makes an ajax post request, which returns some text. I'm trying to get it to work so that the success function in my ajax request prints out the received text, but am having trouble completing this and think it's because of how my controller.rb file is handling the request. So far I have:</p>\n\n<p><strong>index.html.erb</strong></p>\n\n<pre><code>&lt;%= javascript_include_tag \"application\" %&gt;\n\n&lt;h1&gt;Welcome to my website#index&lt;/h1&gt;\n\n&lt;input class=\"className\" id=\"idName\" type=\"button\" value=\"Click Me!\" id=\"my_button\" remote:true/&gt;\n\n&lt;ul id=\"ulID\"&gt;\n &lt;div class = 'wantToChange'&gt;This should change when button is pressd.&lt;/div&gt;\n&lt;/ul&gt;\n</code></pre>\n\n<p><strong>application.js</strong></p>\n\n<pre><code>$(document).ready(function(){\n    $('.className').on('click', function(){\n        console.log(\"inside js click listener\");\n\n       $.post('superman', { field1: \"hello\", field2 : \"hello2\"}, \n       function(returnedData){\n            console.log(returnedData);\n       });\n\n    });\n});\n</code></pre>\n\n<p><strong>welcome_controller.rb</strong></p>\n\n<pre><code>class WelcomeController &lt; ApplicationController\n  def index\n  end\n\n  def superman\n    some_parameter = params[:some_parameter]\n    #do something with some_parameter and return the results\n    render plain: \"OK\"\n  end\n\nend\n</code></pre>\n\n<p><strong>routes.rb</strong></p>\n\n<pre><code>Rails.application.routes.draw do\n  get 'welcome/index'\n\n  resources :test do\n    collection do\n      get 'test'\n    end\n  end\n\n  root 'welcome#index'\nend\n</code></pre>\n\n<p>But running this just produces the following error when I click on the button:\n    POST <a href=\"http://localhost:3000/superman\" rel=\"nofollow noreferrer\">http://localhost:3000/superman</a> 404 (Not Found)\nWhich makes me think my controller file is not set up correctly to receive this 'superman' route? Any help is much appreciated, thanks. </p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 1, "creation_date": 1545795173, "post_id": 53926716, "comment_id": 94695811, "body": "Suppose the strings are <code>&quot;A Hello: The cat is&quot;</code> and <code>&quot;A Good Bye: The dog is&quot;</code>. What is your desired return value? I don&#39;t understand whether you want to return just one common string (and if so, which one, if there are several--the longest?) or all common strings (which presumably would be all common words). Please clarify by editing your question."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1545797072, "post_id": 53926716, "comment_id": 94696013, "body": "In your edit why isn&#39;t <code>&quot; a test message&quot;</code> and/or <code>&quot; This is &quot;</code> removed from both strings?"}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 2, "creation_date": 1545806951, "post_id": 53926716, "comment_id": 94697967, "body": "It now appears you are just removing the common bits at the ends of both strings. Is that correct? Also, are the matches to be case sensitive?"}], "answers": [{"tags": [], "owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "is_accepted": true, "score": 3, "last_activity_date": 1545793555, "creation_date": 1545793555, "answer_id": 53927040, "question_id": 53926716, "link": "https://stackoverflow.com/questions/53926716/remove-duplicate-substrings-from-two-strings/53927040#53927040", "title": "Remove duplicate substrings from two strings", "body": "<p>First you have to find the longest common substring, then subtract it. To find the longest common substring you need to know all substrings:</p>\n\n<pre><code>def substrings(string)\n  (0..string.length-1).flat_map do |i|\n    (1..string.length-i).flat_map do |j|\n      string[i,j]\n    end\n  end\nend\n</code></pre>\n\n<p>This is done by starting at index 0 and taking a full-length substring, then a length-1 substring, and so on before moving to index 1 and repeating iteratively.</p>\n\n<p>This returns them in a fairly arbitrary order, though it's trivial to sort by length. The next step is to see which of these matches <code>all?</code> items given:</p>\n\n<pre><code>def lcs(*list)\n  list = list.sort_by(&amp;:length)\n  subs = substrings(list.first).sort_by(&amp;:length).reverse\n\n  subs.find do |str|\n    list.all? do |entry|\n      entry.include?(str)\n    end\n  end\nend\n</code></pre>\n\n<p>Here the shortest entry (sort order <code>first</code>) is selected because it will necessarily contain the longest common string.</p>\n\n<p>That gets you the substring you want to delete, so you can apply that:</p>\n\n<pre><code>def uniqueify(*list)\n  list_lcs = lcs(*list)\n\n  list.map do |entry|\n    entry.sub(list_lcs, '')\n  end\nend\n</code></pre>\n\n<p>Which then works:</p>\n\n<pre><code>a = \"Hello World: This is a test message\"\nb = \"Good Bye: This is a test message\"\n\nlcs(a,b)\n# =&gt; \": This is a test message\"\n\nuniqueify(a,b)\n# =&gt; [\"Hello World\", \"Good Bye\"]\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1545799513, "post_id": 53927453, "comment_id": 94696363, "body": "<code>str2.match?(&#47;#{s1}&#47;i)</code> is dangerous, since regexp interpolation will treat control symbols unescaped (try e.g. <code>str = &quot;\\\\1&quot;; &#47;#{str}&#47;</code>). Better use <code>str2.include?(s1.downcase)</code>."}, {"owner": {"reputation": 167912, "user_id": 240443, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/495d675e3bc42ed1dee469e2ce701f1b?s=128&d=identicon&r=PG", "display_name": "Amadan", "link": "https://stackoverflow.com/users/240443/amadan"}, "edited": false, "score": 0, "creation_date": 1545799842, "post_id": 53927453, "comment_id": 94696406, "body": "or <code>&#47;#{Regexp.escape(s1)}&#47;i</code>"}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1545806616, "post_id": 53927453, "comment_id": 94697880, "body": "...@Amadan. I&#39;ve incorporated both of your suggestions."}], "tags": [], "owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "is_accepted": false, "score": 0, "last_activity_date": 1545889882, "last_edit_date": 1545889882, "creation_date": 1545798891, "answer_id": 53927453, "question_id": 53926716, "link": "https://stackoverflow.com/questions/53926716/remove-duplicate-substrings-from-two-strings/53927453#53927453", "title": "Remove duplicate substrings from two strings", "body": "<p>If the objective is simply to remove common characters at the ends of both strings we could write:</p>\n\n<pre><code>def remove_common_ending(str1, str2)\n  return [\"\", \"\"] if str1 == str2\n  n = [str1.size, str2.size].min\n  return [str1, str2] if n.zero?\n  i = (1..n).find { |i| str1[-i].downcase != str2[-i].downcase }\n  [str1[0..-i], str2[0..-i]]\nend\n\nremove_common_ending(str1, str2)\n  #=&gt; [\"Hello World\", \"Good Bye\"] \n</code></pre>\n\n<p>Another possible interpretation is that the longest common substring is to be removed from both strings. What follows is one way to do that. My approach is similar to @tadman's, except I start with the length of the longest possible common substring, then progressively shorten that length until a substring is found that appears in both strings. That way there's no need to look for shorter matching substrings.</p>\n\n<pre><code>def longest_common_substring(str1, str2)\n  return '' if str1.empty? || str2.empty?\n  s1, s2 = str1.downcase, str2.downcase\n  (s1, s2 = s2, s1) if s2.size &lt; s1.size\n  sz1 = s1.size\n  sz1.downto(1) do |len|\n    puts \"Checking #{sz1-len+1} substrings of length #{len}...\"\n    (0..sz1-len).each do |i|\n      s = s1[i, len]\n      return s if s2.include?(s)\n    end\n  end \nend    \n</code></pre>\n\n<p>I've added a <code>puts</code> statement to show what calculations are being performed. Note that I search the longer string (<code>str1</code>) for substrings of the shorter string (<code>str2</code>).</p>\n\n<pre><code>str1 = \"Hello World: This is a test message\"\nstr2 = \"Good Bye: This is a test message\"  \n\ns = longest_common_substring(str1, str2)    \nChecking 1 substrings of length 32...\nChecking 2 substrings of length 31...\nChecking 3 substrings of length 30...\nChecking 4 substrings of length 29...\nChecking 5 substrings of length 28...\nChecking 6 substrings of length 27...\nChecking 7 substrings of length 26...\nChecking 8 substrings of length 25...\nChecking 9 substrings of length 24...\n  #=&gt; \": This is a test message\"\n\nr = /#{Regexp.escape(s)}/i\n  #=&gt; /:\\ this\\ is\\ a\\ test\\ message/i\nstr1.sub(r,'') #=&gt; \"Hello World\"\nstr2.sub(r,'') #=&gt; \"Good Bye\"\n</code></pre>\n\n<p>As seen, the number of substrings of the shorter string (<code>str2</code>) that were checked before the longest common substring was found was <code>(1+10)*10/2-1 #=&gt; 54</code>. </p>\n"}, {"tags": [], "owner": {"reputation": 167912, "user_id": 240443, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/495d675e3bc42ed1dee469e2ce701f1b?s=128&d=identicon&r=PG", "display_name": "Amadan", "link": "https://stackoverflow.com/users/240443/amadan"}, "is_accepted": false, "score": 1, "last_activity_date": 1545799689, "creation_date": 1545799689, "answer_id": 53927531, "question_id": 53926716, "link": "https://stackoverflow.com/questions/53926716/remove-duplicate-substrings-from-two-strings/53927531#53927531", "title": "Remove duplicate substrings from two strings", "body": "<p>Google has a wonderful library called <code>diff_match_patch</code>, which makes character-based diffs of two strings in a superfast manner, and - there is a gem for Ruby!</p>\n\n<pre><code>require 'diff_match_patch'\nlongest = DiffMatchPatch.new.diff_main(a, b).    # find diffs\n    select { |type, text| type == :equal }.      # select only equal pieces\n    map(&amp;:last).                                 # get just text\n    max_by(&amp;:length)                             # find the longest one\na[longest] = ''                                  # delete this piece from a\nb[longest] = ''                                  #               and from b\n\nputs a\n# =&gt; Hello world\nputs b\n# =&gt; Good bye\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 9663, "user_id": 5239030, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/76JEw.png?s=128&g=1", "display_name": "iGian", "link": "https://stackoverflow.com/users/5239030/igian"}, "is_accepted": false, "score": 0, "last_activity_date": 1545816424, "creation_date": 1545816424, "answer_id": 53930018, "question_id": 53926716, "link": "https://stackoverflow.com/questions/53926716/remove-duplicate-substrings-from-two-strings/53930018#53930018", "title": "Remove duplicate substrings from two strings", "body": "<p>Considering to remove only the trail matching substring, using arrays, I came up with this solution:</p>\n\n<pre><code>a = \"Hello World: This is a test message\"\nb = \"Good Bye: This is a test message\"\n# a = \"Zoo is awesome. Hello World: This is not a test message\"\n# b = \"Zoo is not awesome. Good Bye: This is a test message\"\n\na_ary = a.split(/\\b/)\nb_ary = b.split(/\\b/)\n\nzipped = a_ary.reverse.zip(b_ary.reverse)\ndropped = zipped.drop_while { |(a,b)| a == b }\n\ndropped.reverse.transpose.map{|w| w.join('')}\n#=&gt; [\"Hello World\", \"Good Bye\"]\n#=&gt; [\"Zoo is awesome. Hello World: This is not\", \"Zoo is not awesome. Good Bye: This is\"]\n</code></pre>\n\n<p>One liner:</p>\n\n<pre><code>a.split(/\\b/).reverse.zip(b.split(/\\b/).reverse).drop_while { |(a,b)| a == b }.reverse.transpose.map{|w| w.join('')}\n</code></pre>\n"}], "owner": {"reputation": 359, "user_id": 5937038, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/50fcb410cc1ce14fd893cc43aec859f7?s=128&d=identicon&r=PG", "display_name": "Melvin", "link": "https://stackoverflow.com/users/5937038/melvin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 343, "favorite_count": 0, "accepted_answer_id": 53927040, "answer_count": 4, "score": 2, "last_activity_date": 1545889882, "creation_date": 1545788352, "last_edit_date": 1545803171, "question_id": 53926716, "link": "https://stackoverflow.com/questions/53926716/remove-duplicate-substrings-from-two-strings", "title": "Remove duplicate substrings from two strings", "body": "<p>I am writing a script to remove the longest duplicate substrings from two strings. There are two strings: <code>a</code> and <code>b</code>:</p>\n\n<pre><code>a = \"Hello World: This is a test message\"\nb = \"Good Bye: This is a test message\"\n</code></pre>\n\n<p>Since there are duplicates: <code>: This is a test message</code>, they are removed from both strings. I am trying to achieve the output below:</p>\n\n<pre><code>\"Hello World\"\n\"Good Bye\"\n</code></pre>\n\n<p>Another example is:</p>\n\n<pre><code>a = \"Zoo is awesome. Hello World: This is not a test message\"\nb = \"Zoo is not awesome. Good Bye: This is a test message\"\n</code></pre>\n\n<p>with expected output: </p>\n\n<pre><code>\"Zoo is awesome. Hello World: This is not\"\n\"Zoo is not awesome. Good Bye: This is\"\n</code></pre>\n\n<p>I was thinking to split the strings into arrays of substrings and subtract two arrays to get the unique substring. Please advise if there is a better way of doing it.</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1545766264, "post_id": 53925031, "comment_id": 94691738, "body": "For consistency try and steer towards using the <code>x: :y</code> notation for hash options. This one line of code uses both the new style and the old style with &quot;fat arrow&quot; <code>=&gt;</code>."}, {"owner": {"reputation": 57, "user_id": 10387989, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-L-OQAZfcKTE/AAAAAAAAAAI/AAAAAAAAAA8/EvRiikg-sms/photo.jpg?sz=128", "display_name": "Trs MTV", "link": "https://stackoverflow.com/users/10387989/trs-mtv"}, "edited": false, "score": 0, "creation_date": 1545766295, "post_id": 53925031, "comment_id": 94691749, "body": "<code>&lt;% if mnd.data == mnd.data[i + 2] %&gt;</code> - yep try? but don`t work"}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1545766339, "post_id": 53925031, "comment_id": 94691761, "body": "In your C code you do <code>i + 1</code> but in Ruby you do <code>i + 2</code>. Why the difference? Remember you can&#39;t do <code>i + 1</code> if <code>i == @monday.length</code> because that&#39;ll walk off the end of the array."}, {"owner": {"reputation": 57, "user_id": 10387989, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-L-OQAZfcKTE/AAAAAAAAAAI/AAAAAAAAAA8/EvRiikg-sms/photo.jpg?sz=128", "display_name": "Trs MTV", "link": "https://stackoverflow.com/users/10387989/trs-mtv"}, "edited": false, "score": 0, "creation_date": 1545766459, "post_id": 53925031, "comment_id": 94691781, "body": "tadman =&gt; I don`t understand, pls explain"}, {"owner": {"reputation": 1493, "user_id": 2236470, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/J8hqM.jpg?s=128&g=1", "display_name": "Paul Byrne", "link": "https://stackoverflow.com/users/2236470/paul-byrne"}, "edited": false, "score": 0, "creation_date": 1545815621, "post_id": 53925031, "comment_id": 94700453, "body": "The equivalent of your C example would be <code>@monday.each_with_index { |mnd, i| mnd == @monday[i + 1] }</code> ... Remember that the each iterator yields only one element at a time, but you still have access to the named array. Of course, other answers here point to a more Ruby-ish approach."}], "answers": [{"comments": [{"owner": {"reputation": 57, "user_id": 10387989, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-L-OQAZfcKTE/AAAAAAAAAAI/AAAAAAAAAA8/EvRiikg-sms/photo.jpg?sz=128", "display_name": "Trs MTV", "link": "https://stackoverflow.com/users/10387989/trs-mtv"}, "edited": false, "score": 1, "creation_date": 1545766772, "post_id": 53925123, "comment_id": 94691848, "body": "<code>&lt;% @monday.each_cons(2) do |mnd, i| %&gt;   &lt;% if mnd.data == i.data] %&gt;    </code> -  this is my final and working code, ty community"}], "tags": [], "owner": {"reputation": 405, "user_id": 4543085, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fL4LJ.jpg?s=128&g=1", "display_name": "Shira Elitzur", "link": "https://stackoverflow.com/users/4543085/shira-elitzur"}, "is_accepted": true, "score": 6, "last_activity_date": 1545766377, "creation_date": 1545766377, "answer_id": 53925123, "question_id": 53925031, "link": "https://stackoverflow.com/questions/53925031/next-iteration-in-each-loop/53925123#53925123", "title": "Next iteration in `each` loop", "body": "<p>If you want to iterate an array and have access to more than one item in each iteration you can use <a href=\"http://ruby-doc.org/core-2.3.1/Enumerable.html#method-i-each_cons\" rel=\"noreferrer\">each_cons</a></p>\n\n<pre><code>arr = [1,2,3,4,5,6,7,8]\narr.each_cons(2){|a,b| \n   puts \"#{a} : #{b}\"\n}\n# 1 : 2\n# 2 : 3\n# 3 : 4\n# 4 : 5\n# 5 : 6\n# 6 : 7\n# 7 : 8\n</code></pre>\n\n<p>Using each_cons you can easily compare two (or more) consecutive items of an array.</p>\n"}, {"tags": [], "owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "is_accepted": false, "score": 4, "last_activity_date": 1545774077, "creation_date": 1545774077, "answer_id": 53925801, "question_id": 53925031, "link": "https://stackoverflow.com/questions/53925031/next-iteration-in-each-loop/53925801#53925801", "title": "Next iteration in `each` loop", "body": "<pre><code>arr = [1,2,3,4,5,6,7,8]\n\nenum = arr.to_enum\n  #=&gt; #&lt;Enumerator: [1, 2, 3, 4, 5, 6, 7, 8]:each&gt;    \nloop { puts \"%d : %d\" % [enum.next, enum.peek] }\n1 : 2\n2 : 3\n3 : 4\n4 : 5\n5 : 6\n6 : 7\n7 : 8\n</code></pre>\n\n<p>See <a href=\"http://ruby-doc.org/core-2.5.1/Object.html#method-i-to_enum\" rel=\"nofollow noreferrer\">Kernel#to_enum</a><sup>1</sup>, <a href=\"http://ruby-doc.org/core-2.5.1/Kernel.html#method-i-loop\" rel=\"nofollow noreferrer\">Kernel#loop</a>, <a href=\"http://ruby-doc.org/core-2.5.1/Enumerator.html#method-i-next\" rel=\"nofollow noreferrer\">Enumerator#next</a> and <a href=\"http://ruby-doc.org/core-2.5.1/Enumerator.html#method-i-peek\" rel=\"nofollow noreferrer\">Enumerator#peek</a>. <code>peek</code> raises a <code>StopIteration</code> exception when it is executed after the last element of <code>arr</code> has been generated. <code>loop</code> handles that exception by breaking out of the loop.</p>\n\n<p><sup>1. As to why this <code>Kernel</code> instance method is documented as an <code>Object</code> instance method, please see the second paragraph at the docs for <a href=\"http://ruby-doc.org/core-2.5.1/Object.html\" rel=\"nofollow noreferrer\">Object</a>.</sup></p>\n"}, {"tags": [], "owner": {"reputation": 5060, "user_id": 10522579, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7GQ6a.jpg?s=128&g=1", "display_name": "ray", "link": "https://stackoverflow.com/users/10522579/ray"}, "is_accepted": false, "score": 0, "last_activity_date": 1545804457, "creation_date": 1545804457, "answer_id": 53928057, "question_id": 53925031, "link": "https://stackoverflow.com/questions/53925031/next-iteration-in-each-loop/53928057#53928057", "title": "Next iteration in `each` loop", "body": "<p>What if you could go with following changes,</p>\n\n<pre><code>-  &lt;% if mnd.data == mnd.data[i + 1] %&gt;\n+  &lt;% if @monday[i+1] != nil &amp;&amp; mnd.data == @monday[i+1].data %&gt;\n</code></pre>\n\n<p>Or simply,</p>\n\n<pre><code>-  &lt;% if mnd.data == mnd.data[i + 1] %&gt;\n+  &lt;% if mnd.data == @monday[i+1].try(:data) %&gt;\n</code></pre>\n"}], "owner": {"reputation": 57, "user_id": 10387989, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-L-OQAZfcKTE/AAAAAAAAAAI/AAAAAAAAAA8/EvRiikg-sms/photo.jpg?sz=128", "display_name": "Trs MTV", "link": "https://stackoverflow.com/users/10387989/trs-mtv"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 130, "favorite_count": 0, "accepted_answer_id": 53925123, "answer_count": 3, "score": 1, "last_activity_date": 1545804607, "creation_date": 1545765479, "last_edit_date": 1545804607, "question_id": 53925031, "link": "https://stackoverflow.com/questions/53925031/next-iteration-in-each-loop", "title": "Next iteration in `each` loop", "body": "<p>I have a collection:</p>\n\n<pre><code>@monday = HomeTask.where(:class_room =&gt; current_user.class_room, :day =&gt; '\u041f\u043e\u043d\u0435\u0434\u0456\u043b\u043e\u043a').order(created_at: :desc)\n</code></pre>\n\n<p>The <code>@monday</code> variable contains data from the database. In view, I show all dates from the collection:</p>\n\n<pre><code>&lt;% @monday.each_with_index do |mnd, i| %&gt;\n  &lt;% if mnd.data == mnd.data[i + 1] %&gt;\n    &lt;%= link_to 'nice' %&gt;\n  &lt;% else %&gt;\n    &lt;%= link_to 'ohhh...' %&gt;\n  &lt;% end %&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>Within <code>if</code> body, I want to refer to the next element. But it does not work. In C++, to refer to the next element in the first iteration, it would be coded like this:</p>\n\n<pre><code>if(array[i] == array[i+1])\n</code></pre>\n\n<p>How do I use <code>each</code> in Ruby?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "notifications"], "comments": [{"owner": {"reputation": 4216, "user_id": 9269043, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a2763bcfa8917a365c88f8639494de7?s=128&d=identicon&r=PG", "display_name": "Vasilisa", "link": "https://stackoverflow.com/users/9269043/vasilisa"}, "edited": false, "score": 0, "creation_date": 1545763991, "post_id": 53924633, "comment_id": 94691240, "body": "Maybe you should use <code>@service_order = ServiceOrder.find(params[:request][:service_order_id])</code>? How you are creating requests? Add the form for it, please"}, {"owner": {"reputation": 7, "user_id": 8502602, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-wk__T8zontw/AAAAAAAAAAI/AAAAAAAAANw/79eaQxtWWA0/photo.jpg?sz=128", "display_name": "Belal Kamara", "link": "https://stackoverflow.com/users/8502602/belal-kamara"}, "reply_to_user": {"reputation": 4216, "user_id": 9269043, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a2763bcfa8917a365c88f8639494de7?s=128&d=identicon&r=PG", "display_name": "Vasilisa", "link": "https://stackoverflow.com/users/9269043/vasilisa"}, "edited": false, "score": 0, "creation_date": 1545772676, "post_id": 53924633, "comment_id": 94692870, "body": "Now its giving this error <code>NoMethodError (undefined method </code>users&#39; for nil:NilClass)` .  I will add my _form page"}], "answers": [{"tags": [], "owner": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "is_accepted": false, "score": 0, "last_activity_date": 1545783199, "creation_date": 1545783199, "answer_id": 53926451, "question_id": 53924633, "link": "https://stackoverflow.com/questions/53924633/ruby-couldnt-find-serviceorder-with-id/53926451#53926451", "title": "Ruby Couldn&#39;t find ServiceOrder with &#39;id&#39;=", "body": "<p>To route to <a href=\"https://guides.rubyonrails.org/routing.html#nested-resources\" rel=\"nofollow noreferrer\">nested resources</a> you should pass an array.</p>\n\n<pre><code>form_for( [@service_order, @request])\nredirect_to([@service_order, @request])\n # ... etc\n</code></pre>\n\n<p>This is equivalent to calling <code>service_order_requests_path(service_order_id: @service_order.to_param)</code>. You can also use the <code>shallow: true</code> option to avoid nesting the member routes.</p>\n"}], "owner": {"reputation": 7, "user_id": 8502602, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-wk__T8zontw/AAAAAAAAAAI/AAAAAAAAANw/79eaQxtWWA0/photo.jpg?sz=128", "display_name": "Belal Kamara", "link": "https://stackoverflow.com/users/8502602/belal-kamara"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 42, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1545783199, "creation_date": 1545761798, "last_edit_date": 1545772833, "question_id": 53924633, "link": "https://stackoverflow.com/questions/53924633/ruby-couldnt-find-serviceorder-with-id", "title": "Ruby Couldn&#39;t find ServiceOrder with &#39;id&#39;=", "body": "<p>I'm setting up a in-app notification to show all the notifications that the user has however I am getting an can't find ID error. I am following this guide here <a href=\"https://www.youtube.com/watch?v=KOs8f8TnwZs\" rel=\"nofollow noreferrer\">https://www.youtube.com/watch?v=KOs8f8TnwZs</a>. \nI want to give notifications every time a Service Order gets a new Request associated with it.\nDo you know what could be causing this?</p>\n\n<p>I have tried going into my routes and adding something like this:</p>\n\n<pre><code> resources :service_orders do\n   resources :requests\n end\n</code></pre>\n\n<p>But it didnt work, and it just made the requests route not work. </p>\n\n<p>The code that I newly added is:</p>\n\n<pre><code>(@service_order.users.uniq - [current_user]).each do |user|\n      Notification.create(recipient: user, actor: current_user, action: \"posted\", notifiable: @request)\n end\n</code></pre>\n\n<p>And thats whats causing the error, <code>@service_order</code> isn't being found for some weird reason. </p>\n\n<p>My Request Controller is:    </p>\n\n<pre><code>class RequestsController &lt; ApplicationController\n  before_action :set_request, only: [:show, :edit, :update, :destroy]\n  before_action :old_request, only: [:show, :index, :update]\n  before_action :set_so\n\n\n  def index\n    if logged_in?(:site_admin)\n      @request = Request.all\n    elsif logged_in?(:itp_user)\n      @request = Request.pending.requests_by current_user\n    else\n      @request = Request.pending.so_user_request current_user.service_orders\n    end\n  end\n\n\n  def new\n    @request = Request.new\n  end\n\n\n  def create\n\n    @request = current_user.requests.new(request_params)\n    authorize @request\n\n    respond_to do |format|\n      if @request.save\n\n        (@service_order.users.uniq - [current_user]).each do |user|\n      Notification.create(recipient: user, actor: current_user, action: \"posted\", notifiable: @request)\n    end\n\n    format.html { redirect_to @service_order, notice: 'Your request has been sent' }\n  else\n    format.html { redirect_to @request, :flash =&gt; { :error =&gt; @request.errors.full_messages.join(', ') } }\n      end\n    end\n  end\n\n\n  def show\n    authorize @request\n  end\n\n  def edit\n    authorize @request\n  end\n\n\n  def update\n    authorize @request\n\n    if @request.update(request_params)\n      redirect_to requests_path, notice: 'Your request was created successfully'\n    else\n      render :edit\n    end\n  end\n\n\n  def destroy\n    authorize @request\n\n    @request.destroy\n    redirect_to requests_path, notice: 'Your request was deleted successfully'\n  end\n\n\n  private\n\n  def request_params\n    params.require(:request).permit(:available_date, \n                                :message, \n                                :charge_range, \n                                :status, \n                                :heading,\n                                :service_order_id,\n                                :user_id\n                                )\n  end\n\n  def set_request \n    @request = Request.find(params[:id])\n  end\n\n  def old_request\n    Request.where('created_at &lt;= :fifteen_days', fifteen_days: Time.now - 15.days).where(status: \"pending\").destroy_all\n  end\n\n  def set_so \n    @service_order = ServiceOrder.find(params[:service_order_id])\n  end\n\nend\n</code></pre>\n\n<p>My routes.rb:</p>\n\n<pre><code>Rails.application.routes.draw do\n  resources :request_logs\n\n  namespace :admin do\n    resources :users\n    resources :issue_types\n    resources :requests\n    resources :service_orders\n\n    root to: \"users#index\"\n  end\n\n  resources :conversations do\n    resources :messages\n  end\n\n  resources :requests\n  devise_for :users, path: '', path_names: { sign_in: 'login', sign_out: 'logout', sign_up: 'register' }\n\n  resources :service_orders, except: [:show] do\n    member do\n      get :toggle_status\n    end\n  end\n\n  get 'user-landing', to: 'user_landing#index'\n\n  get 'service_order/:id', to: 'service_orders#show', as: 'service_order_show'\n\n  get 'contact', to: 'pages#contact'\n\n  root to: 'pages#home'\n\nend\n</code></pre>\n\n<p>Request Form View:</p>\n\n<pre><code>&lt;%= form_for :request, url: requests_path do |f| %&gt;\n\n &lt;% if @request.errors.any? %&gt;\n   &lt;div id=\"error_explanation\"&gt;\n     &lt;h2&gt;&lt;%= pluralize(@request.errors.count, \"error\") %&gt; prohibited this request from being sent:&lt;/h2&gt;\n\n     &lt;ul&gt;\n     &lt;% @request.errors.full_messages.each do |message| %&gt;\n       &lt;li&gt;&lt;%= message %&gt;&lt;/li&gt;\n     &lt;% end %&gt;\n    &lt;/ul&gt;\n   &lt;/div&gt;\n &lt;% end %&gt;\n\n   &lt;div class=\"form-group\"&gt;\n    &lt;h4&gt;Subject:&lt;/h4&gt;\n    &lt;em&gt;&lt;%= f.text_area :heading, class: \"form-control\" %&gt;&lt;/em&gt;\n   &lt;/div&gt;\n\n   &lt;div class=\"form-group\"&gt;\n     &lt;h4&gt;Message:&lt;/h4&gt;\n     &lt;em&gt;&lt;%= f.text_area :message, class: \"form-control\" %&gt;&lt;/em&gt;\n   &lt;/div&gt;\n\n   &lt;div class=\"form-group\"&gt;\n     &lt;h4&gt;Issue Charge Range:&lt;/h4&gt;\n     &lt;em&gt;&lt;%= f.number_field :charge_range, class: \"form-control\" %&gt;&lt;/em&gt;\n   &lt;/div&gt;\n\n   &lt;div class=\"form-group\"&gt;\n     &lt;h4&gt;Soonest Available Date:&lt;/h4&gt;\n     &lt;em&gt;&lt;%= f.date_field :available_date, class: \"form-control\" %&gt;&lt;/em&gt;\n   &lt;/div&gt;\n\n   &lt;%= f.hidden_field :user_id, :value =&gt; current_user.id %&gt;\n   &lt;%= f.hidden_field :service_order_id, :value =&gt; @service_orders.id %&gt;\n\n   &lt;div&gt;\n     &lt;%= f.submit 'Send Service Request', class: 'btn btn-primary btn-block' %&gt;\n   &lt;/div&gt;\n &lt;% end %&gt;\n</code></pre>\n"}, {"tags": ["arrays", "ruby"], "comments": [{"owner": {"reputation": 9663, "user_id": 5239030, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/76JEw.png?s=128&g=1", "display_name": "iGian", "link": "https://stackoverflow.com/users/5239030/igian"}, "edited": false, "score": 1, "creation_date": 1545752224, "post_id": 53923628, "comment_id": 94688989, "body": "Convert the integer into string: <code>i.to_s</code>"}], "answers": [{"tags": [], "owner": {"reputation": 4179, "user_id": 1293013, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/9oztA.jpg?s=128&g=1", "display_name": "r\u0251\u02d0d\u0292\u0251", "link": "https://stackoverflow.com/users/1293013/r%c9%91%cb%90d%ca%92%c9%91"}, "is_accepted": true, "score": 1, "last_activity_date": 1545752844, "last_edit_date": 1545752844, "creation_date": 1545752418, "answer_id": 53923704, "question_id": 53923628, "link": "https://stackoverflow.com/questions/53923628/iterating-an-array-in-ruby-and-adding-a-string-after-a-number/53923704#53923704", "title": "Iterating an array in Ruby and adding a string after a number", "body": "<h2>Method 1: Using <code>to_s</code></h2>\n\n<p>You can use <code>to_s</code> to convert integer to string. </p>\n\n<pre><code>nums = Array[1, 2, 3, 4, 5]\n\nfor i in nums\n    puts i.to_s + \" Carrots\"\nend\n</code></pre>\n\n<p>output:</p>\n\n<pre><code>1 Carrots\n2 Carrots\n3 Carrots\n4 Carrots\n5 Carrots\n</code></pre>\n\n<h2>Method 2: Using String Interpolations</h2>\n\n<pre><code>nums = Array[1, 2, 3, 4, 5]\n\nfor i in nums\n    puts \"#{i}  Carrots\"\nend\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>1  Carrots\n2  Carrots\n3  Carrots\n4  Carrots\n5  Carrots\n</code></pre>\n\n<p>Hope it helps.</p>\n"}, {"tags": [], "owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "is_accepted": false, "score": 1, "last_activity_date": 1545753943, "creation_date": 1545753943, "answer_id": 53923840, "question_id": 53923628, "link": "https://stackoverflow.com/questions/53923628/iterating-an-array-in-ruby-and-adding-a-string-after-a-number/53923840#53923840", "title": "Iterating an array in Ruby and adding a string after a number", "body": "<p>Just out of curiosity:</p>\n\n<pre><code>puts [1, 2, 3, 4, 5].product([\" Carrots\"]).map(&amp;:join)\n#\u21d2 1 Carrots\n#  2 Carrots\n#  3 Carrots\n#  4 Carrots\n#  5 Carrots\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1686, "user_id": 7264341, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Oz5dfb6ASr8/AAAAAAAAAAI/AAAAAAAAAC8/33rQJBMPZZI/photo.jpg?sz=128", "display_name": "Javier Men&#233;ndez Rizo", "link": "https://stackoverflow.com/users/7264341/javier-men%c3%a9ndez-rizo"}, "is_accepted": false, "score": 0, "last_activity_date": 1545920246, "last_edit_date": 1545920246, "creation_date": 1545919833, "answer_id": 53946429, "question_id": 53923628, "link": "https://stackoverflow.com/questions/53923628/iterating-an-array-in-ruby-and-adding-a-string-after-a-number/53946429#53946429", "title": "Iterating an array in Ruby and adding a string after a number", "body": "<p>You can convert the number using the method to_s and concatenate with +, or use interpolation, but looping with <strong>for</strong> doesn't feels like the ruby way</p>\n\n<p><strong>Using iterators</strong> </p>\n\n<pre><code>nums = [1, 2, 3, 4]\n\nnums.each do |num|\n  puts num.to_s + ' Carrots'\nend\n\nnums.each do |num|\n  puts \"#{num} Carrots\"\nend\n</code></pre>\n\n<p><strong>Note:</strong> Use simple quotes if interpolation is not going to be used</p>\n\n<p><strong>More elegant one line solution</strong></p>\n\n<pre><code>puts nums.map {|num| num.to_s + ' Carrots'}\n\nputs nums.map {|num| \"#{num} Carrots\"}\n</code></pre>\n"}], "owner": {"reputation": 225, "user_id": 10832299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39f826ce33780bdf09906adc2ae8ad8f?s=128&d=identicon&r=PG&f=1", "display_name": "robinmanz", "link": "https://stackoverflow.com/users/10832299/robinmanz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 736, "favorite_count": 0, "accepted_answer_id": 53923704, "answer_count": 3, "score": 0, "last_activity_date": 1545920246, "creation_date": 1545751736, "last_edit_date": 1545753693, "question_id": 53923628, "link": "https://stackoverflow.com/questions/53923628/iterating-an-array-in-ruby-and-adding-a-string-after-a-number", "title": "Iterating an array in Ruby and adding a string after a number", "body": "<p>How can I iterate through an array of numbers, and add a string to the output in each iteration? I'm using \"puts\" to display the number.</p>\n\n<p>The array</p>\n\n<pre><code>nums = Array[1, 2, 3, 4, 5]\n</code></pre>\n\n<p>Iterating the array</p>\n\n<pre><code>for i in nums\n    puts i + \" Carrots\"\nend\n</code></pre>\n\n<p>I'm getting this response</p>\n\n<pre><code>test.rb:40:in `+': String can't be coerced into Integer (TypeError)String can't be coerced into Integer (TypeError)String can't be coerced into Integer (TypeError)\n</code></pre>\n"}, {"tags": ["ruby", "fork", "minitest"], "answers": [{"tags": [], "owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "is_accepted": true, "score": 2, "last_activity_date": 1545749913, "last_edit_date": 1545749913, "creation_date": 1545749769, "answer_id": 53923413, "question_id": 53923343, "link": "https://stackoverflow.com/questions/53923343/why-fork-exits-with-non-zero-in-minitest-test/53923413#53923413", "title": "Why fork exits with non-zero in Minitest test?", "body": "<p><a href=\"https://github.com/seattlerb/minitest/issues/467\" rel=\"nofollow noreferrer\">https://github.com/seattlerb/minitest/issues/467</a></p>\n\n<blockquote>\n  <p>The problem is that <code>fork</code> duplicates the <code>at_exit</code> handlers of the parent process. Minitest uses <code>at_exit</code> to run the tests so you're hitting up against that. From the fork doco: \"The child process can exit using <code>Kernel.exit!</code> to avoid running any <code>at_exit</code> functions.\" </p>\n</blockquote>\n"}], "owner": {"reputation": 93455, "user_id": 187141, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/f9e28dc83496320c87c55b3cf988ab60?s=128&d=identicon&r=PG", "display_name": "yegor256", "link": "https://stackoverflow.com/users/187141/yegor256"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 112, "favorite_count": 0, "accepted_answer_id": 53923413, "answer_count": 1, "score": 2, "last_activity_date": 1545749913, "creation_date": 1545749180, "question_id": 53923343, "link": "https://stackoverflow.com/questions/53923343/why-fork-exits-with-non-zero-in-minitest-test", "title": "Why fork exits with non-zero in Minitest test?", "body": "<p>This is the code:</p>\n\n<pre><code>require 'minitest/autorun'\nclass Foo &lt; Minitest::Test\n  def test_foo\n    Process.fork do\n      exit(0)\n    end\n    p Process.waitall\n  end\nend\n</code></pre>\n\n<p>This is the output:</p>\n\n<pre><code>$ ruby a.rb\nRun options: --seed 40445\n\n# Running:\n\n[[41827, #&lt;Process::Status: pid 41827 exit 1&gt;]]\n.\n\nFinished in 0.016218s, 61.6599 runs/s, 0.0000 assertions/s.\n1 runs, 0 assertions, 0 failures, 0 errors, 0 skips\n</code></pre>\n\n<p>Why exit code is not zero?</p>\n\n<p>The same code without Minitest works just fine:</p>\n\n<pre><code>Process.fork do\n  exit(0)\nend\np Process.waitall\n</code></pre>\n\n<p>What's wrong?</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1545745783, "post_id": 53922952, "comment_id": 94687614, "body": "Do you have frozen string magic comment on top of your file?"}, {"owner": {"reputation": 312, "user_id": 7657817, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/2d821950016dcd8156cc8022cfb04205?s=128&d=identicon&r=PG", "display_name": "Merkelst", "link": "https://stackoverflow.com/users/7657817/merkelst"}, "reply_to_user": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1545745814, "post_id": 53922952, "comment_id": 94687620, "body": "@SergioTulentsev, no, I doesn&#39;t have this comment =)"}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1545745986, "post_id": 53922952, "comment_id": 94687658, "body": "Must be it&#39;s enabled for entire ruby vm? Take a look at this, sounds familiar? <a href=\"https://github.com/railslove/rack-tracker/issues/105\" rel=\"nofollow noreferrer\">github.com/railslove/rack-tracker/issues/105</a>"}, {"owner": {"reputation": 312, "user_id": 7657817, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/2d821950016dcd8156cc8022cfb04205?s=128&d=identicon&r=PG", "display_name": "Merkelst", "link": "https://stackoverflow.com/users/7657817/merkelst"}, "reply_to_user": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1545746201, "post_id": 53922952, "comment_id": 94687706, "body": "@SergioTulentsev, yes, I tried this, but doesn&#39;t help=("}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1545746228, "post_id": 53922952, "comment_id": 94687710, "body": "Interesting, I have never used this form of <code>gsub</code>. Why not block form and return modified copy?"}], "answers": [{"comments": [{"owner": {"reputation": 312, "user_id": 7657817, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/2d821950016dcd8156cc8022cfb04205?s=128&d=identicon&r=PG", "display_name": "Merkelst", "link": "https://stackoverflow.com/users/7657817/merkelst"}, "edited": false, "score": 0, "creation_date": 1545747103, "post_id": 53923038, "comment_id": 94687904, "body": "Thank you so much!"}], "tags": [], "owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "is_accepted": true, "score": 1, "last_activity_date": 1545747814, "last_edit_date": 1545747814, "creation_date": 1545746403, "answer_id": 53923038, "question_id": 53922952, "link": "https://stackoverflow.com/questions/53922952/runtimeerror-string-modified-when-i-try-gsub-incoming-string-inside-each/53923038#53923038", "title": "&quot;RuntimeError: string modified&quot; when I try gsub! incoming string inside each", "body": "<p>For whatever reason that string refuses to be modified. While we haven't yet figured out why, here's how you can sidestep the issue: don't modify the string in-place, return a new string.</p>\n\n<pre><code>def validate_url(string)\n  string.gsub(/((http|https):\\/\\/.*?)(\\s|$|\\n|\\Z|\\t|\\r|&lt;.)/) do |link|\n    if link.ascii_only?\n      \"&lt;a href=\\\"#{link}\\\"&gt;#{link}&lt;/a&gt;\"\n    else\n      \"&lt;b&gt;[NON-LATIN LETTERS: #{link}]&lt;/b&gt;\"\n    end\n  end\nend\n</code></pre>\n\n<p>Then</p>\n\n<pre><code>clean = validate_url(string)\n</code></pre>\n"}], "owner": {"reputation": 312, "user_id": 7657817, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/2d821950016dcd8156cc8022cfb04205?s=128&d=identicon&r=PG", "display_name": "Merkelst", "link": "https://stackoverflow.com/users/7657817/merkelst"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 75, "favorite_count": 0, "accepted_answer_id": 53923038, "answer_count": 1, "score": 0, "last_activity_date": 1545805519, "creation_date": 1545745560, "last_edit_date": 1545805519, "question_id": 53922952, "link": "https://stackoverflow.com/questions/53922952/runtimeerror-string-modified-when-i-try-gsub-incoming-string-inside-each", "title": "&quot;RuntimeError: string modified&quot; when I try gsub! incoming string inside each", "body": "<p>My method gets strings with some urls. Urls can have ascii only symbols or any another:</p>\n\n<pre><code>\"\u0442\u0435\u0441\u0442 non-latin url http://url.c\u043em and test only-latin url https://url.com\"\n</code></pre>\n\n<p>I want to parse my incoming strings, and then change all matches in the original string as follows:</p>\n\n<pre><code>\"\u0442\u0435\u0441\u0442 non-url &lt;b&gt;[NON-LATIN LETTERS: http://url.c\u043em]&lt;/b&gt; and test only-latin url &lt;a href=\"https://url.com\"&gt;https://url.com&lt;/a&gt;\"\n</code></pre>\n\n<p>and pass it to the next method.</p>\n\n<p>I used <code>each</code> with <code>gsub!</code>:</p>\n\n<pre><code>def validate_url(string)\n  validate_url = string.gsub(/((http|https):\\/\\/.*?)(\\s|$|\\n|\\Z|\\t|\\r|&lt;.)/)\n\n  validate_url.each do |link|\n    if link.ascii_only?\n      string.gsub!(link, \"&lt;a href=\\\"#{link}\\\"&gt;#{link}&lt;/a&gt;\")\n    else\n      string.gsub!(link, \"&lt;b&gt;[NON-LATIN LETTERS: #{link}]&lt;/b&gt;\")\n    end\n  end\nend\n</code></pre>\n\n<p>I see <code>RuntimeError: string modified</code> error and don't understand why and how to fix that.</p>\n"}, {"tags": ["ruby", "time", "location"], "comments": [{"owner": {"reputation": 167912, "user_id": 240443, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/495d675e3bc42ed1dee469e2ce701f1b?s=128&d=identicon&r=PG", "display_name": "Amadan", "link": "https://stackoverflow.com/users/240443/amadan"}, "edited": false, "score": 1, "creation_date": 1545800957, "post_id": 53922945, "comment_id": 94696581, "body": "&quot;I don&#39;t want to use geolocation.&quot; - then asking the user is your only hope."}], "answers": [{"comments": [{"owner": {"reputation": 449, "user_id": 10739704, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XmWze.jpg?s=128&g=1", "display_name": "nileshkumar", "link": "https://stackoverflow.com/users/10739704/nileshkumar"}, "edited": false, "score": 0, "creation_date": 1545755212, "post_id": 53923107, "comment_id": 94689589, "body": "Time.now.zone will also give you the same result."}], "tags": [], "owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "is_accepted": true, "score": 0, "last_activity_date": 1545747053, "creation_date": 1545747053, "answer_id": 53923107, "question_id": 53922945, "link": "https://stackoverflow.com/questions/53922945/is-there-a-built-in-way-to-get-the-country-name-in-ruby/53923107#53923107", "title": "Is there a built in way to get the country name in Ruby?", "body": "<p>Obviously, you cannot get the country name from a time instance because time zones do not map to countries.</p>\n\n<p>However, from a time instance, you can get the time zone, and by using <code>Time.new</code>, you can access the current system time.</p>\n\n<pre><code>Time.new.zone\n# =&gt; \"JST\"\n</code></pre>\n"}], "owner": {"reputation": 1341, "user_id": 11089758, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XQ5gw.jpg?s=128&g=1", "display_name": "S.Goswami", "link": "https://stackoverflow.com/users/11089758/s-goswami"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 43, "favorite_count": 0, "accepted_answer_id": 53923107, "answer_count": 1, "score": 0, "last_activity_date": 1545747426, "creation_date": 1545745513, "last_edit_date": 1545747426, "question_id": 53922945, "link": "https://stackoverflow.com/questions/53922945/is-there-a-built-in-way-to-get-the-country-name-in-ruby", "title": "Is there a built in way to get the country name in Ruby?", "body": "<p>Creating a weather app. Using Apixu. If I can get the country name, the user doesn't have to provide it. So I want the program to fetch the default system country in a manner we use the <code>Time</code> class for fetching the system time.</p>\n\n<p>I don't want to use geolocation. Also <code>TZInfo</code> isn't what I am looking for. I need a built-in way to get the country name (may be from time zone?).</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 2890, "user_id": 1237117, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/H7dfY.jpg?s=128&g=1", "display_name": "mridula", "link": "https://stackoverflow.com/users/1237117/mridula"}, "edited": false, "score": 0, "creation_date": 1545750534, "post_id": 53922601, "comment_id": 94688643, "body": "You want your Item JSON to have <code>image_url</code>. But in your code, one item can have many images. So which <code>image_url</code> do you want in the Item JSON?"}], "answers": [{"tags": [], "owner": {"reputation": 236, "user_id": 4391072, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jf0ro.png?s=128&g=1", "display_name": "Ni3", "link": "https://stackoverflow.com/users/4391072/ni3"}, "is_accepted": false, "score": 1, "last_activity_date": 1545854082, "last_edit_date": 1545854082, "creation_date": 1545853745, "answer_id": 53936475, "question_id": 53922601, "link": "https://stackoverflow.com/questions/53922601/how-can-i-get-paperclip-image-url-in-item-json-data/53936475#53936475", "title": "How can I get paperclip image url in item json data?", "body": "<p>According to provided association i.e. item has_many images and images belongs_to item, then the reference for items table primary_key should be in image table instead of images table primary_key in items table.</p>\n\n<p><strong>Find all images of an item using active record association:</strong></p>\n\n<pre><code>@item = Item.find_by(id: params[:id])\n@images = @item&amp;.images\n</code></pre>\n\n<p>Instead of returning json from action, return it from jbuilder view. Iterate images array to find and return respective image path under item object.</p>\n\n<p><a href=\"https://github.com/rails/jbuilder\" rel=\"nofollow noreferrer\">https://github.com/rails/jbuilder</a></p>\n"}], "owner": {"reputation": 19, "user_id": 10427533, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-94IWqhH1K7M/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DWaFiUwt8NzcJGJtxAPqwuk9xGKmw/mo/photo.jpg?sz=128", "display_name": "Adarsh KL", "link": "https://stackoverflow.com/users/10427533/adarsh-kl"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 44, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1545854082, "creation_date": 1545742739, "last_edit_date": 1545745236, "question_id": 53922601, "link": "https://stackoverflow.com/questions/53922601/how-can-i-get-paperclip-image-url-in-item-json-data", "title": "How can I get paperclip image url in item json data?", "body": "<p>i am going to dispaly json data, i have two model 1) item, 2)image, for image model i attachment peperclip gem.\nin place of \"image_id\":6,in json data i want to display image url </p>\n\n<p>in controller\nitems_controller.rb</p>\n\n<pre><code>class V1::ItemsController &lt; ApplicationController\n\n    skip_before_action :verify_authenticity_token\n\n    def index\n        items = Item.all\n        render json: { status: 'success', data: items, status: :ok}\n\n\n\n    end\n\n\n    def show\n        item = Item.find(params[:id])\n        render json: {status: 'success', data:item, status: :ok}\n    end\n\n\n    private def image_params\n       params.permit(:name,:price,:category_id,:image_id,:short_description,:long_description,:is_active,:preparation_time,:serves,:calorie_count,:meal_type_id,:cuisine_id,:spicy_level ,:is_new,:is_bestseller)\n    end\n\nend \n</code></pre>\n\n<p>in images_controller.rb</p>\n\n<pre><code>class V1::ImagesController &lt; ApplicationController\n\n    skip_before_action :verify_authenticity_token\n\n\n\n    def show\n        image = Image.find(params[:id])\n        render json: {status: 'success', data:image},status: :ok\n    end\n\n\n    def create\n        image = Image.new(image_params)\n        if image.save\n            render json: {status: 'success', data:image},status: :ok    \n        else\n            render json: {status: 'error', message:'image not saved', data:image.errors},status: :unprocessable_entity  \n        end \n    end\n\n\n    def destroy\n        image = Image.find(params[:id])\n        image.destory\n        render json: {status: 'success', data:image},status: :ok    \n    end\n\n    private def image_params\n        params.permit(:item_image,:title,:filename)\n    end\n\nend\n</code></pre>\n\n<p>model</p>\n\n<p>item.rb</p>\n\n<pre><code>class Item &lt; ApplicationRecord\n\n    has_many :images, dependent: :destroy\n\nend\n</code></pre>\n\n<p>image.rb</p>\n\n<pre><code> class Image &lt; ApplicationRecord\n\n    has_attached_file :item_image, styles: { medium: \"300x300&gt;\", thumb: \"100x100&gt;\" }, default_url: \"/images/:style/missing.png\"\n    validates_attachment_content_type :item_image, content_type: /\\Aimage\\/.*\\z/\n\n    belongs_to :item\nend\n</code></pre>\n\n<p>now i am getting json output for item </p>\n\n<pre><code>  {\n            \"id\": 1,\n            \"name\": \"Bruschette with Tomato\",\n            \"price\": 0,\n            \"category_id\": 10,\n            \"image_id\": 6,\n            \"short_description\": \"ut error\",\n            \"long_description\": \"placeat sit quasi dolorum quia vel consequatur\",\n            \"is_active\": true,\n            \"preparation_time\": \"2018-12-25 19:30:09 +0530\",\n            \"serves\": 1545640612,\n            \"calorie_count\": 465,\n            \"meal_type_id\": 4,\n            \"cuisine_id\": 5,\n            \"spicy_level\": 1,\n            \"is_new\": false,\n            \"is_bestseller\": false,\n            \"updated_at\": \"2018-12-25T07:10:16.144Z\",\n            \"created_at\": \"2018-12-25T07:10:16.144Z\"\n        }\n</code></pre>\n\n<p>. but in place of \"image_id\":6,i want to display image url how can i\n    do, pls need help......</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "metaprogramming", "ruby-on-rails-plugins"], "answers": [{"comments": [{"owner": {"reputation": 341, "user_id": 8208791, "user_type": "registered", "profile_image": "https://graph.facebook.com/10154392642776710/picture?type=large", "display_name": "Rui Freitas", "link": "https://stackoverflow.com/users/8208791/rui-freitas"}, "edited": false, "score": 0, "creation_date": 1545741705, "post_id": 53922220, "comment_id": 94686763, "body": "Thanks for your answer! It seems to work with the Railstie, but I need to reference/use my module by name first so that it works. Do you need to run some sort of initializer with this approach?"}, {"owner": {"reputation": 6018, "user_id": 3073313, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/d9a53be16eb996b521f1637d19005511?s=128&d=identicon&r=PG", "display_name": "Jay-Ar Polidario", "link": "https://stackoverflow.com/users/3073313/jay-ar-polidario"}, "reply_to_user": {"reputation": 341, "user_id": 8208791, "user_type": "registered", "profile_image": "https://graph.facebook.com/10154392642776710/picture?type=large", "display_name": "Rui Freitas", "link": "https://stackoverflow.com/users/8208791/rui-freitas"}, "edited": false, "score": 0, "creation_date": 1545741986, "post_id": 53922220, "comment_id": 94686812, "body": "Yes, if you&#39;re changing lib/foo.rb file to make use of Railstie, I&#39;ll update my answer. And yes, you can either create your own initializer file or make use of <code>config.after_initialize do |app|</code>"}, {"owner": {"reputation": 6018, "user_id": 3073313, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/d9a53be16eb996b521f1637d19005511?s=128&d=identicon&r=PG", "display_name": "Jay-Ar Polidario", "link": "https://stackoverflow.com/users/3073313/jay-ar-polidario"}, "reply_to_user": {"reputation": 341, "user_id": 8208791, "user_type": "registered", "profile_image": "https://graph.facebook.com/10154392642776710/picture?type=large", "display_name": "Rui Freitas", "link": "https://stackoverflow.com/users/8208791/rui-freitas"}, "edited": false, "score": 0, "creation_date": 1545742473, "post_id": 53922220, "comment_id": 94686900, "body": "I just updated my answer to make use of Railstie. Untested, but I think this should already work :)"}, {"owner": {"reputation": 341, "user_id": 8208791, "user_type": "registered", "profile_image": "https://graph.facebook.com/10154392642776710/picture?type=large", "display_name": "Rui Freitas", "link": "https://stackoverflow.com/users/8208791/rui-freitas"}, "edited": false, "score": 0, "creation_date": 1545743195, "post_id": 53922220, "comment_id": 94687044, "body": "Thanks, worked like a charm! I extracted the lib code to a gem and it worked without having to run any initializer, but simply requiring Foo::Railstie where the models are loaded with the code you provided."}, {"owner": {"reputation": 6018, "user_id": 3073313, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/d9a53be16eb996b521f1637d19005511?s=128&d=identicon&r=PG", "display_name": "Jay-Ar Polidario", "link": "https://stackoverflow.com/users/3073313/jay-ar-polidario"}, "reply_to_user": {"reputation": 341, "user_id": 8208791, "user_type": "registered", "profile_image": "https://graph.facebook.com/10154392642776710/picture?type=large", "display_name": "Rui Freitas", "link": "https://stackoverflow.com/users/8208791/rui-freitas"}, "edited": false, "score": 0, "creation_date": 1545743329, "post_id": 53922220, "comment_id": 94687072, "body": "No problem! :))"}], "tags": [], "owner": {"reputation": 6018, "user_id": 3073313, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/d9a53be16eb996b521f1637d19005511?s=128&d=identicon&r=PG", "display_name": "Jay-Ar Polidario", "link": "https://stackoverflow.com/users/3073313/jay-ar-polidario"}, "is_accepted": false, "score": 1, "last_activity_date": 1545784536, "last_edit_date": 1545784536, "creation_date": 1545739447, "answer_id": 53922220, "question_id": 53921698, "link": "https://stackoverflow.com/questions/53921698/best-approach-to-mark-specific-rails-models-to-be-used-in-a-module/53922220#53922220", "title": "Best approach to mark specific Rails Models to be used in a module", "body": "<p>I had a <a href=\"https://github.com/jrpolidario/quickery/blob/master/lib/quickery/railtie.rb\" rel=\"nofollow noreferrer\">similar problem before in my gem</a>.</p>\n\n<p>I ended up loading <strong>ONLY</strong> model files (which is the minimum of my requirement same as yours because the DSL code is there like your <code>acts_as_foo</code>), and not immediately eager loading all Rails-related files using <code>Rails.application.eager_load!</code>.</p>\n\n<pre><code># lib/foo.rb\nmodule Foo\n  class &lt;&lt; self\n    attr_accessor :models\n  end\n\n  self.models = []\n\n  class Engine &lt; Rails::Engine\n    initializer 'foo.eager_load_models' do |app|\n      unless app.config.eager_load\n        models_load_path = File.join(Rails.root, 'app', 'models')\n\n        # copied from https://apidock.com/rails/Rails/Engine/eager_load%21/class\n        matcher = /\\A#{Regexp.escape(models_load_path.to_s)}\\/(.*)\\.rb\\Z/\n        Dir.glob(\"#{models_load_path}/**/*.rb\").sort.each do |file|\n          app.require_dependency file.sub(matcher, '\\1')\n        end\n      end\n    end\n  end\n\n  module Model\n    def acts_as_foo\n      Foo.models &lt;&lt; self\n    end\n  end\nend\n\nActiveSupport.on_load(:active_record) do\n  extend Foo::Model\nend\n</code></pre>\n"}], "owner": {"reputation": 341, "user_id": 8208791, "user_type": "registered", "profile_image": "https://graph.facebook.com/10154392642776710/picture?type=large", "display_name": "Rui Freitas", "link": "https://stackoverflow.com/users/8208791/rui-freitas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 95, "favorite_count": 1, "answer_count": 1, "score": 2, "last_activity_date": 1545784536, "creation_date": 1545735464, "question_id": 53921698, "link": "https://stackoverflow.com/questions/53921698/best-approach-to-mark-specific-rails-models-to-be-used-in-a-module", "title": "Best approach to mark specific Rails Models to be used in a module", "body": "<p>I am trying to write a lib plugin/extension to perform an action where I need to know which Models have been marked for use with this plugin.</p>\n\n<p>Currently, I am marking the models in the fashion of <code>acts_as_something</code> method which is added to each Model intended to be used with the plugin.</p>\n\n<p>The main file of the plugin looks like this</p>\n\n<pre><code># lib/foo.rb\nmodule Foo\n  class &lt;&lt; self\n    attr_accessor :models\n  end\n  self.models = []\n\n  module Model\n    def acts_as_foo\n      Foo.models &lt;&lt; self\n    end\nend\n\nActiveSupport.on_load(:active_record) do\n  extend Foo::Model\nend\n</code></pre>\n\n<p>The intended use is to then call in a controller <code>Foo.perform</code>, which needs to know the marked models in order to carry out the intended action, the idea being getting the list of models from <code>Foo.models</code>.</p>\n\n<p>It works as intended if when <code>config.eager_load</code> is set to true in <code>development.rb</code> , otherwise the files of the models have not been used/loaded yet and therefore <code>Foo.models</code> is an empty Array.</p>\n\n<p>My goal is to be able to add more models to Foo without having to change Foo's code like this.</p>\n\n<pre><code>#app/models/bar.rb\nclass Bar &lt; ApplicationRecord\n  acts_as_foo\nend\n</code></pre>\n\n<p>Any ideas on the best way to implement this?</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 167912, "user_id": 240443, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/495d675e3bc42ed1dee469e2ce701f1b?s=128&d=identicon&r=PG", "display_name": "Amadan", "link": "https://stackoverflow.com/users/240443/amadan"}, "edited": false, "score": 1, "creation_date": 1545734522, "post_id": 53921522, "comment_id": 94685024, "body": "Possible duplicate: <a href=\"https://stackoverflow.com/questions/51060596/ld-library-not-found-for-lstdc-6\">ld: library not found for -lstdc++.6</a>. tl;dr: This library was deprecated in XCode 8, removed in XCode 10."}, {"owner": {"reputation": 614, "user_id": 645915, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/ZJ0Av.jpg?s=128&g=1", "display_name": "Wanderer", "link": "https://stackoverflow.com/users/645915/wanderer"}, "edited": false, "score": 0, "creation_date": 1545913107, "post_id": 53921522, "comment_id": 94728493, "body": "did you try running <code>xcode-select --install</code>?"}], "owner": {"reputation": 301, "user_id": 5280153, "user_type": "registered", "accept_rate": 27, "profile_image": "https://www.gravatar.com/avatar/60a3a14c5bf84b6ba464d5c7962057b4?s=128&d=identicon&r=PG&f=1", "display_name": "Pavan Vasan", "link": "https://stackoverflow.com/users/5280153/pavan-vasan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1245, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1545734084, "creation_date": 1545734084, "question_id": 53921522, "link": "https://stackoverflow.com/questions/53921522/unable-to-install-particular-version-of-mini-racer-gem", "title": "unable to install particular version of mini_racer gem", "body": "<p>I am trying to set up my local environment for a particular repository when I came across this error.</p>\n\n<pre><code>An error occurred while installing mini_racer (0.1.15), and Bundler cannot continue.\nMake sure that `gem install mini_racer -v '0.1.15' --source 'https://rubygems.org/'` succeeds before bundling.\n</code></pre>\n\n<p>My local machine is a macOS X (Mojave). I installed ruby 2.1.5, updated the bundler and ran <code>bundle install</code></p>\n\n<p>This is the error in detail:-</p>\n\n<pre><code>Gem::Ext::BuildError: ERROR: Failed to build gem native extension.\n\ncurrent directory: /Users/pavan7vasan/.rvm/gems/ruby-2.1.5/gems/mini_racer-0.1.15/ext/mini_racer_extension\n/Users/pavan7vasan/.rvm/rubies/ruby-2.1.5/bin/ruby -r ./siteconf20181225-93631-97fmbf.rb extconf.rb\nchecking for main() in -lpthread... yes\nchecking for main() in -lobjc... yes\ncreating Makefile\n\ncurrent directory: /Users/pavan7vasan/.rvm/gems/ruby-2.1.5/gems/mini_racer-0.1.15/ext/mini_racer_extension\nmake \"DESTDIR=\" clean\n\ncurrent directory: /Users/pavan7vasan/.rvm/gems/ruby-2.1.5/gems/mini_racer-0.1.15/ext/mini_racer_extension\nmake \"DESTDIR=\"\ncompiling mini_racer_extension.cc\nclang: warning: argument unused during compilation: '-rdynamic' [-Wunused-command-line-argument]\nIn file included from mini_racer_extension.cc:2:\nIn file included from /Users/pavan7vasan/.rvm/rubies/ruby-2.1.5/include/ruby-2.1.0/ruby.h:33:\nIn file included from /Users/pavan7vasan/.rvm/rubies/ruby-2.1.5/include/ruby-2.1.0/ruby/ruby.h:1694:\n/Users/pavan7vasan/.rvm/rubies/ruby-2.1.5/include/ruby-2.1.0/ruby/intern.h:47:19: warning: 'register' storage class specifier is deprecated and incompatible with C++17\n[-Wdeprecated-register]\nvoid rb_mem_clear(register VALUE*, register long);\n              ^~~~~~~~~\n/Users/pavan7vasan/.rvm/rubies/ruby-2.1.5/include/ruby-2.1.0/ruby/intern.h:47:36: warning: 'register' storage class specifier is deprecated and incompatible with C++17\n[-Wdeprecated-register]\nvoid rb_mem_clear(register VALUE*, register long);\n                               ^~~~~~~~~\n2 warnings generated.\nlinking shared-object mini_racer_extension.bundle\nclang: warning: libstdc++ is deprecated; move to libc++ [-Wdeprecated]\nld: library not found for -lstdc++\nclang: error: linker command failed with exit code 1 (use -v to see invocation)\nmake: *** [mini_racer_extension.bundle] Error 1\n\nmake failed, exit code 2\n\nGem files will remain installed in /Users/pavan7vasan/.rvm/gems/ruby-2.1.5/gems/mini_racer-0.1.15 for inspection.\nResults logged to /Users/pavan7vasan/.rvm/gems/ruby-2.1.5/extensions/x86_64-darwin-18/2.1.0/mini_racer-0.1.15/gem_make.out\n\nAn error occurred while installing mini_racer (0.1.15), and Bundler cannot continue.\nMake sure that `gem install mini_racer -v '0.1.15' --source 'https://rubygems.org/'` succeeds before bundling.\n\nIn Gemfile:\n  mini_racer\n</code></pre>\n\n<p>I researched the problem based on a relevant link: <a href=\"https://github.com/discourse/mini_racer/issues/104\" rel=\"nofollow noreferrer\">https://github.com/discourse/mini_racer/issues/104</a>\nand based on a couple of stack overflow posts, I uninstalled the libv8 gem and then tried to <code>gem install mini_racer</code>. Unfortunately, it did not work\nEven reinstalling ruby again did not have any effect. How can I resolve this problem?</p>\n\n<p>This stack overflow post is for a problem similar to mine<a href=\"https://stackoverflow.com/questions/52264369/error-occurred-while-installing-mini-racer-0-2-0\">similar post</a>, and it says that setting up a different version is probably the best, not quite sure which is the best version for ruby (2.1.5) and rails (3.2.xx)</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "google-cloud-vision"], "comments": [{"owner": {"reputation": 63, "user_id": 9995312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/669c7458e0030cca52d7900f84accd5c?s=128&d=identicon&r=PG&f=1", "display_name": "S.cll", "link": "https://stackoverflow.com/users/9995312/s-cll"}, "reply_to_user": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 0, "creation_date": 1545732187, "post_id": 53921024, "comment_id": 94684573, "body": "don&#39;t know why I got this error   &#39;uninitialized constant Google::Cloud::Vision::ImageAnnotator&#39;"}], "answers": [{"comments": [{"owner": {"reputation": 63, "user_id": 9995312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/669c7458e0030cca52d7900f84accd5c?s=128&d=identicon&r=PG&f=1", "display_name": "S.cll", "link": "https://stackoverflow.com/users/9995312/s-cll"}, "edited": false, "score": 0, "creation_date": 1545731021, "post_id": 53921087, "comment_id": 94684321, "body": "Yes. I finished running this label detection Quickstart  [<a href=\"https://cloud.google.com/vision/docs/quickstart-client-libraries?hl=zh-tw]\" rel=\"nofollow noreferrer\">cloud.google.com/vision/docs/&hellip;</a>                                                           pretty sure authentication is set properly"}, {"owner": {"reputation": 116, "user_id": 9418233, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-D_K-MuV3YRw/AAAAAAAAAAI/AAAAAAAAABU/FXkIhd0LcGs/photo.jpg?sz=128", "display_name": "Upendra Chahar", "link": "https://stackoverflow.com/users/9418233/upendra-chahar"}, "reply_to_user": {"reputation": 63, "user_id": 9995312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/669c7458e0030cca52d7900f84accd5c?s=128&d=identicon&r=PG&f=1", "display_name": "S.cll", "link": "https://stackoverflow.com/users/9995312/s-cll"}, "edited": false, "score": 0, "creation_date": 1545731525, "post_id": 53921087, "comment_id": 94684432, "body": "did u create any project into google storage console and start the billing for that one"}, {"owner": {"reputation": 63, "user_id": 9995312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/669c7458e0030cca52d7900f84accd5c?s=128&d=identicon&r=PG&f=1", "display_name": "S.cll", "link": "https://stackoverflow.com/users/9995312/s-cll"}, "edited": false, "score": 0, "creation_date": 1545732169, "post_id": 53921087, "comment_id": 94684571, "body": "Yes. I&#39;ve start it."}], "tags": [], "owner": {"reputation": 116, "user_id": 9418233, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-D_K-MuV3YRw/AAAAAAAAAAI/AAAAAAAAABU/FXkIhd0LcGs/photo.jpg?sz=128", "display_name": "Upendra Chahar", "link": "https://stackoverflow.com/users/9418233/upendra-chahar"}, "is_accepted": false, "score": 0, "last_activity_date": 1545730538, "creation_date": 1545730538, "answer_id": 53921087, "question_id": 53921024, "link": "https://stackoverflow.com/questions/53921024/uninitialized-constant-googlecloudvisionimageannotator/53921087#53921087", "title": "uninitialized constant Google::Cloud::Vision::ImageAnnotator", "body": "<p>Did you added google-cloud-ruby gem in your Gemfile and other google related authentication details into your ruby project.</p>\n"}, {"tags": [], "owner": {"reputation": 63, "user_id": 9995312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/669c7458e0030cca52d7900f84accd5c?s=128&d=identicon&r=PG&f=1", "display_name": "S.cll", "link": "https://stackoverflow.com/users/9995312/s-cll"}, "is_accepted": true, "score": 0, "last_activity_date": 1545795348, "creation_date": 1545795348, "answer_id": 53927178, "question_id": 53921024, "link": "https://stackoverflow.com/questions/53921024/uninitialized-constant-googlecloudvisionimageannotator/53927178#53927178", "title": "uninitialized constant Google::Cloud::Vision::ImageAnnotator", "body": "<p>It turns out that the error was caused because I haven't use the latest version of gcloud-vision(0.32.x)</p>\n\n<p>the way to do what I wanna do in gcloud-vision(0.31.0) is </p>\n\n<pre><code>image = vision.image \"path/to/face.jpg\"\n\nface = image.face\n</code></pre>\n\n<p>instead of using  class</p>\n\n<blockquote>\n  <p>Google::Cloud::Vision::ImageAnnotator</p>\n</blockquote>\n"}], "owner": {"reputation": 63, "user_id": 9995312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/669c7458e0030cca52d7900f84accd5c?s=128&d=identicon&r=PG&f=1", "display_name": "S.cll", "link": "https://stackoverflow.com/users/9995312/s-cll"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 421, "favorite_count": 0, "accepted_answer_id": 53927178, "answer_count": 2, "score": -1, "last_activity_date": 1545795348, "creation_date": 1545729953, "last_edit_date": 1545795136, "question_id": 53921024, "link": "https://stackoverflow.com/questions/53921024/uninitialized-constant-googlecloudvisionimageannotator", "title": "uninitialized constant Google::Cloud::Vision::ImageAnnotator", "body": "<p>Running this example\n <a href=\"https://cloud.google.com/vision/docs/face-tutorial?hl=zh-tw\" rel=\"nofollow noreferrer\">https://cloud.google.com/vision/docs/face-tutorial?hl=zh-tw</a></p>\n\n<p>by rails on 'google-cloud-vision', '~> 0.31.0'</p>\n\n<p>got the error </p>\n\n<blockquote>\n  <p>uninitialized constant Google::Cloud::Vision::ImageAnnotator</p>\n</blockquote>\n\n<p>here's the code</p>\n\n<pre><code>require \"google/cloud/vision\"\n\n\nproject_id = 'xxxxxx'\n\n\nvision = Google::Cloud::Vision.new project: project_id\n\n\nimage_annotator = Google::Cloud::Vision::ImageAnnotator.new\n</code></pre>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 28753, "user_id": 1138192, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4ed67a4983ab0568593e133930430941?s=128&d=identicon&r=PG", "display_name": "Always Sunny", "link": "https://stackoverflow.com/users/1138192/always-sunny"}, "edited": false, "score": 0, "creation_date": 1545730096, "post_id": 53920938, "comment_id": 94684138, "body": "more cleaner version with lookahead and look behind <code>(?&lt;=\\.com\\&#47;)([a-zA-Z0-9]+)(?=\\&#47;)</code>"}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1545730324, "post_id": 53920938, "comment_id": 94684179, "body": "<code>(?&lt;=twitter\\.com\\&#47;)[^\\&#47;]+</code>."}], "answers": [{"comments": [{"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1545730413, "post_id": 53921007, "comment_id": 94684200, "body": "<code>[^\\&#47;]+</code> for the real match is faster and safer against e.g. tomorrow\u2019s twitter decision to allow non-latin alphabet symbols for names."}, {"owner": {"reputation": 28753, "user_id": 1138192, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4ed67a4983ab0568593e133930430941?s=128&d=identicon&r=PG", "display_name": "Always Sunny", "link": "https://stackoverflow.com/users/1138192/always-sunny"}, "reply_to_user": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1545730485, "post_id": 53921007, "comment_id": 94684214, "body": "@AlekseiMatiushkin agreed sir and added on the <b>Edited</b> section"}, {"owner": {"reputation": 1263, "user_id": 10221813, "user_type": "registered", "profile_image": "https://graph.facebook.com/10160530708235447/picture?type=large", "display_name": "uno", "link": "https://stackoverflow.com/users/10221813/uno"}, "edited": false, "score": 0, "creation_date": 1545806458, "post_id": 53921007, "comment_id": 94697837, "body": "Do i need to create a method for this? And I tried your edited version and I getthis error: &quot;syntax error, unexpected &#39;=&#39;, expecting &#39;)&#39;&quot;, &quot;unknown regexp options - rdr&quot;, &quot;unmatched close parenthesis: /]+)&quot;.... while using... &quot; @order_twitter_tag = @order.twitter_link.sub((?&lt;=twitter\\.com\\/)[^\\/]+) &quot;"}], "tags": [], "owner": {"reputation": 28753, "user_id": 1138192, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4ed67a4983ab0568593e133930430941?s=128&d=identicon&r=PG", "display_name": "Always Sunny", "link": "https://stackoverflow.com/users/1138192/always-sunny"}, "is_accepted": false, "score": 0, "last_activity_date": 1545730417, "last_edit_date": 1545730417, "creation_date": 1545729821, "answer_id": 53921007, "question_id": 53920938, "link": "https://stackoverflow.com/questions/53920938/extract-part-of-a-url-in-specific-format/53921007#53921007", "title": "Extract part of a URL in specific format", "body": "<p>I can not write ruby but this is what I get from the auto-generated code from regex101.com site with <a href=\"https://regex101.com/r/h1iODS/3/\" rel=\"nofollow noreferrer\">my regex</a> <code>(?&lt;=\\.com\\/)([a-zA-Z0-9]+)(?=\\/)</code> using <strong>look-behind</strong> and <strong>look-behind</strong> approach. It just grabs the string part that has <code>.com/</code> before and <code>/</code> after it.</p>\n\n<pre><code>re = /(?&lt;=\\.com\\/)([a-zA-Z0-9]+)(?=\\/)/m\nstr = '-https://twitter.com/TwitterDev/status/850006245121695744 \n\n -http://twitter.com/TwitterDev/status/850006245121695744 \n\n -twitter.com/TwitterDev/status/850006245121695744 \n\n -https://www.twitter.com/TwitterDev/status/850006245121695744 \n\n -http://www.twitter.com/TwitterDev/status/850006245121695744 \n\n -www.twitter.com/TwitterDev/status/850006245121695744 \n\n -m.twitter.com/TwitterDev/status/850006245121695744 '\n\n# Print the match result\nstr.scan(re) do |match|\n    puts match.to_s\nend\n</code></pre>\n\n<p><strong>EDITED:</strong>  Cleanest and Fastest way using <code>(?&lt;=twitter\\.com\\/)[^\\/]+</code></p>\n"}, {"comments": [{"owner": {"reputation": 1263, "user_id": 10221813, "user_type": "registered", "profile_image": "https://graph.facebook.com/10160530708235447/picture?type=large", "display_name": "uno", "link": "https://stackoverflow.com/users/10221813/uno"}, "edited": false, "score": 0, "creation_date": 1545806238, "post_id": 53921315, "comment_id": 94697772, "body": "How would i write this onto something like this in my controller: @order_twitter_tag = @order.twitter_link.#regex_goes_here ? - i Tried &quot;@order_twitter_tag = @order.twitter_link.map{|url| url.split(&quot;.com/&quot;, 2).last.split(&quot;/&quot;, 2).first}&quot; but it gives me &quot;no method map...&quot; - but the string does exist so i&#39;m not sure why it gives an error"}, {"owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "reply_to_user": {"reputation": 1263, "user_id": 10221813, "user_type": "registered", "profile_image": "https://graph.facebook.com/10160530708235447/picture?type=large", "display_name": "uno", "link": "https://stackoverflow.com/users/10221813/uno"}, "edited": false, "score": 0, "creation_date": 1545806482, "post_id": 53921315, "comment_id": 94697843, "body": "@uno Your <code>@order.twitter_link</code> is something other than an array, most likely <code>nil</code>."}, {"owner": {"reputation": 1263, "user_id": 10221813, "user_type": "registered", "profile_image": "https://graph.facebook.com/10160530708235447/picture?type=large", "display_name": "uno", "link": "https://stackoverflow.com/users/10221813/uno"}, "edited": false, "score": 0, "creation_date": 1545806527, "post_id": 53921315, "comment_id": 94697854, "body": "Yes, it&#39;s not an array, its just one string.  Does that change things? How should i set it up just for one url being entered?"}, {"owner": {"reputation": 1263, "user_id": 10221813, "user_type": "registered", "profile_image": "https://graph.facebook.com/10160530708235447/picture?type=large", "display_name": "uno", "link": "https://stackoverflow.com/users/10221813/uno"}, "edited": false, "score": 0, "creation_date": 1545806903, "post_id": 53921315, "comment_id": 94697954, "body": "NVM, I&#39;m an idiot.  I think I got it - will do more more testing real quick - thanks"}], "tags": [], "owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "is_accepted": true, "score": 0, "last_activity_date": 1545732412, "creation_date": 1545732412, "answer_id": 53921315, "question_id": 53920938, "link": "https://stackoverflow.com/questions/53920938/extract-part-of-a-url-in-specific-format/53921315#53921315", "title": "Extract part of a URL in specific format", "body": "<p>Following the exact specification that you mentioned.</p>\n\n<pre><code>urls.map{|url| url.split(\".com/\", 2).last.split(\"/\", 2).first}\n# =&gt; [\"TwitterDev\", \"TwitterDev\", \"TwitterDev\", \"TwitterDev\", \"TwitterDev\", \"TwitterDev\", \"TwitterDev\"]\n</code></pre>\n"}], "owner": {"reputation": 1263, "user_id": 10221813, "user_type": "registered", "profile_image": "https://graph.facebook.com/10160530708235447/picture?type=large", "display_name": "uno", "link": "https://stackoverflow.com/users/10221813/uno"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 39, "favorite_count": 0, "accepted_answer_id": 53921315, "answer_count": 2, "score": -2, "last_activity_date": 1545732412, "creation_date": 1545729195, "last_edit_date": 1545732095, "question_id": 53920938, "link": "https://stackoverflow.com/questions/53920938/extract-part-of-a-url-in-specific-format", "title": "Extract part of a URL in specific format", "body": "<p>I have twitter URLs that may take the following formats:</p>\n\n<pre><code>urls = [\n  \"https://twitter.com/TwitterDev/status/850006245121695744\",\n  \"http://twitter.com/TwitterDev/status/850006245121695744\",\n  \"twitter.com/TwitterDev/status/850006245121695744\",\n  \"https://www.twitter.com/TwitterDev/status/850006245121695744\",\n  \"http://www.twitter.com/TwitterDev/status/850006245121695744\",\n  \"www.twitter.com/TwitterDev/status/850006245121695744\",\n  \"m.twitter.com/TwitterDev/status/850006245121695744\",\n]\n</code></pre>\n\n<p>I want to get the username <code>\"TwitterDev\"</code> from any of the above. How can I get the words/numbers/charectors [sic] after <code>\".com/\"</code> up to the next <code>\"/\"</code>?</p>\n"}, {"tags": ["ruby", "ruby-on-rails-5", "sidekiq", "rails-activestorage"], "comments": [{"owner": {"reputation": 1612, "user_id": 1146473, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/798f66c6c7e53703e2a30ff911b0e884?s=128&d=identicon&r=PG", "display_name": "ekampp", "link": "https://stackoverflow.com/users/1146473/ekampp"}, "edited": false, "score": 0, "creation_date": 1545780397, "post_id": 53918750, "comment_id": 94694040, "body": "How are you handling database cleaning between tests? Are you running parallel tests on the same dataset? This could be from the database being cleaned while the tests are running."}, {"owner": {"reputation": 4422, "user_id": 1202525, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ccc5db30edf02524aa2a0fb17d154bf8?s=128&d=identicon&r=PG", "display_name": "TomDunning", "link": "https://stackoverflow.com/users/1202525/tomdunning"}, "reply_to_user": {"reputation": 1612, "user_id": 1146473, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/798f66c6c7e53703e2a30ff911b0e884?s=128&d=identicon&r=PG", "display_name": "ekampp", "link": "https://stackoverflow.com/users/1146473/ekampp"}, "edited": false, "score": 0, "creation_date": 1545910173, "post_id": 53918750, "comment_id": 94727298, "body": "I&#39;ve not configured any parallel tests (additional gems are required to get rspec to do this) and <code>use_transactional_fixtures = true</code>. Any other ideas?"}, {"owner": {"reputation": 1612, "user_id": 1146473, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/798f66c6c7e53703e2a30ff911b0e884?s=128&d=identicon&r=PG", "display_name": "ekampp", "link": "https://stackoverflow.com/users/1146473/ekampp"}, "edited": false, "score": 0, "creation_date": 1546132844, "post_id": 53918750, "comment_id": 94786993, "body": "Yes, I&#39;m aware that there are additional Gems required to set up parallel testing. But since you didn&#39;t supply your Gemfile, how should I have known you hadn&#39;t?   If you feel annoyed by me trying to help, I will make a note of avoiding to do so in the future."}, {"owner": {"reputation": 4422, "user_id": 1202525, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ccc5db30edf02524aa2a0fb17d154bf8?s=128&d=identicon&r=PG", "display_name": "TomDunning", "link": "https://stackoverflow.com/users/1202525/tomdunning"}, "reply_to_user": {"reputation": 1612, "user_id": 1146473, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/798f66c6c7e53703e2a30ff911b0e884?s=128&d=identicon&r=PG", "display_name": "ekampp", "link": "https://stackoverflow.com/users/1146473/ekampp"}, "edited": false, "score": 0, "creation_date": 1546132959, "post_id": 53918750, "comment_id": 94787011, "body": "Hi @EmilKampp, not sure why you thought I was criticising you, I certainly didn&#39;t mean to. Perhaps I was a bit matter-of-fact, apologies."}], "answers": [{"tags": [], "owner": {"reputation": 4422, "user_id": 1202525, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ccc5db30edf02524aa2a0fb17d154bf8?s=128&d=identicon&r=PG", "display_name": "TomDunning", "link": "https://stackoverflow.com/users/1202525/tomdunning"}, "is_accepted": true, "score": 0, "last_activity_date": 1546131234, "creation_date": 1546131234, "answer_id": 53974502, "question_id": 53918750, "link": "https://stackoverflow.com/questions/53918750/activestorage-intermittently-returning-couldnt-find-activestorageblob-with/53974502#53974502", "title": "ActiveStorage intermittently returning &quot;Couldn&#39;t find ActiveStorage::Blob with &#39;id&#39;&quot;", "body": "<p>I'd previously added <code>ActiveJob::Base.queue_adapter = :test</code> to my <code>rails_helper.rb</code> so it should have worked. However, adding that line into the particular test seemed to resolve the issue.</p>\n\n<pre><code>it 'queues the processing of the material' do\n  post :create, params: { material: valid_attributes }, session: valid_session\n\n  expect(ProcessMaterialJob).to(\n    have_been_enqueued.with(material_id: Material.last.id, video_filepath: Material.last.video_filepath)\n  )\nend\n</code></pre>\n"}], "owner": {"reputation": 4422, "user_id": 1202525, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ccc5db30edf02524aa2a0fb17d154bf8?s=128&d=identicon&r=PG", "display_name": "TomDunning", "link": "https://stackoverflow.com/users/1202525/tomdunning"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1126, "favorite_count": 0, "accepted_answer_id": 53974502, "answer_count": 1, "score": 3, "last_activity_date": 1546131234, "creation_date": 1545701664, "question_id": 53918750, "link": "https://stackoverflow.com/questions/53918750/activestorage-intermittently-returning-couldnt-find-activestorageblob-with", "title": "ActiveStorage intermittently returning &quot;Couldn&#39;t find ActiveStorage::Blob with &#39;id&#39;&quot;", "body": "<p>I have a simple controller spec, which is supposed to check the processing for a new Material is queued when the item is created.</p>\n\n<p>materials_controller_spec.rb (#create):</p>\n\n<pre><code>  it 'queues the processing of the material' do\n    post :create, params: { material: valid_attributes }, session: valid_session\n\n    expect(ProcessMaterialJob).to(\n      have_been_enqueued.with(material_id: Material.last.id, video_filepath: Material.last.video_filepath)\n    )\n  end\n</code></pre>\n\n<p>When run in isolation it's fine, but when I run the whole suite with <code>rspec .</code> I get the following error:</p>\n\n<pre><code> ActiveJob::DeserializationError:\n   Error while trying to deserialize arguments: Couldn't find ActiveStorage::Blob with 'id'=418\n # ./spec/controllers/materials_controller_spec.rb:81:in `block (4 levels) in &lt;top (required)&gt;'\n # ------------------\n # --- Caused by: ---\n # ActiveRecord::RecordNotFound:\n #   Couldn't find ActiveStorage::Blob with 'id'=418\n #   ./spec/controllers/materials_controller_spec.rb:81:in `block (4 levels) in &lt;top (required)&gt;'\n</code></pre>\n\n<p>There have been a couple of points where I've not been convinced the attachment has been fully uploaded before the next page has rendered. I am concerned this could mean an issue with the file uploads. I followed the guide on <a href=\"https://edgeguides.rubyonrails.org/active_storage_overview.html#direct-uploads\" rel=\"nofollow noreferrer\">direct uploads</a> but I still see no progress indicator when uploading the video files, which are quite large.</p>\n\n<p>My questions are:</p>\n\n<ol>\n<li>What is causing the strange <code>Couldn't find ActiveStorage::Blob\nwith 'id'=418</code> issue?</li>\n<li>How can I debug the file upload if that's where the issue is?</li>\n</ol>\n\n<p>Thanks in advance!</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 299, "user_id": 9454269, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/0edb637e57ce3cad9745d80e6739b567?s=128&d=identicon&r=PG&f=1", "display_name": "KuroGane", "link": "https://stackoverflow.com/users/9454269/kurogane"}, "reply_to_user": {"reputation": 394580, "user_id": 479863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ArUCE.jpg?s=128&g=1", "display_name": "mu is too short", "link": "https://stackoverflow.com/users/479863/mu-is-too-short"}, "edited": false, "score": 0, "creation_date": 1545704341, "post_id": 53918673, "comment_id": 94680439, "body": "Hi mu, yes something like that. I&#39;ll update my view now, I forgot to add that line in."}, {"owner": {"reputation": 6207, "user_id": 5117953, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/Ca0RW.jpg?s=128&g=1", "display_name": "Vishal", "link": "https://stackoverflow.com/users/5117953/vishal"}, "edited": false, "score": 0, "creation_date": 1545711326, "post_id": 53918673, "comment_id": 94681079, "body": "@JamesWu i think you got your answer. right ?"}, {"owner": {"reputation": 299, "user_id": 9454269, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/0edb637e57ce3cad9745d80e6739b567?s=128&d=identicon&r=PG&f=1", "display_name": "KuroGane", "link": "https://stackoverflow.com/users/9454269/kurogane"}, "edited": false, "score": 0, "creation_date": 1545777931, "post_id": 53918673, "comment_id": 94693679, "body": "Hi Vishal, thanks for the reply. The answer above showed what I should be doing, but I&#39;m confused about how to actually implement it.  If I type it in as:      <code>&lt;% @users_age.each do |age, n| %&gt;     &lt;% end %&gt;</code>  It is nil value. I&#39;m not too sure what I should be writing here."}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1545778370, "post_id": 53918673, "comment_id": 94693755, "body": "By the way, it is not related to activerecord in any way. You get a hash from activerecord/database, their job is done."}], "answers": [{"comments": [{"owner": {"reputation": 299, "user_id": 9454269, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/0edb637e57ce3cad9745d80e6739b567?s=128&d=identicon&r=PG&f=1", "display_name": "KuroGane", "link": "https://stackoverflow.com/users/9454269/kurogane"}, "edited": false, "score": 0, "creation_date": 1545778834, "post_id": 53926115, "comment_id": 94693823, "body": "Thank you very much for the help Sergio. I wouldn&#39;t have been able to figure out how to get that answer!"}], "tags": [], "owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "is_accepted": true, "score": 1, "last_activity_date": 1545778503, "creation_date": 1545778503, "answer_id": 53926115, "question_id": 53918673, "link": "https://stackoverflow.com/questions/53918673/how-can-i-change-the-output-of-a-user-groupage-count-for-example/53926115#53926115", "title": "How can I change the output of a &quot;User.group(:age).count, for example?", "body": "<blockquote>\n  <p>this is what I attempted: </p>\n\n<pre><code>  &lt;% @users.each do |user, n| %&gt;\n      &lt;tr&gt;\n          &lt;td&gt; &lt;%= user.age %&gt; &lt;/td&gt;\n      &lt;/tr&gt;\n  &lt;% end %&gt;\n</code></pre>\n</blockquote>\n\n<p>Your header contains two columns, but for rows you emit only one column. Emit the second one too (and actually use that hash you have computed in the controller)</p>\n\n<pre><code>  &lt;% @users_age.each do |age, n| %&gt;\n      &lt;tr&gt;\n          &lt;td&gt; &lt;%= age %&gt; &lt;/td&gt;\n          &lt;td&gt; &lt;%= n %&gt; &lt;/td&gt;\n      &lt;/tr&gt;\n  &lt;% end %&gt;\n</code></pre>\n"}], "owner": {"reputation": 299, "user_id": 9454269, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/0edb637e57ce3cad9745d80e6739b567?s=128&d=identicon&r=PG&f=1", "display_name": "KuroGane", "link": "https://stackoverflow.com/users/9454269/kurogane"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 43, "favorite_count": 0, "accepted_answer_id": 53926115, "answer_count": 1, "score": -3, "last_activity_date": 1545778503, "creation_date": 1545700400, "last_edit_date": 1545778129, "question_id": 53918673, "link": "https://stackoverflow.com/questions/53918673/how-can-i-change-the-output-of-a-user-groupage-count-for-example", "title": "How can I change the output of a &quot;User.group(:age).count, for example?", "body": "<p><strong>EDIT</strong></p>\n\n<p>This is what I have attempted:</p>\n\n<pre><code>&lt;table&gt;\n&lt;thead&gt;\n    &lt;tr&gt;\n        &lt;th&gt; Age &lt;/th&gt;\n        &lt;th&gt; Count &lt;/th&gt;\n    &lt;/tr&gt;\n&lt;/thead&gt;\n&lt;tbody&gt;\n  &lt;tbody&gt;\n      &lt;% @users.each do |user, n| %&gt;\n          &lt;tr&gt;\n              &lt;td&gt; &lt;%= user.age %&gt; &lt;/td&gt;\n          &lt;/tr&gt;\n      &lt;% end %&gt;\n  &lt;/tbody&gt;\n&lt;/table&gt;\n</code></pre>\n\n<p>The output in the view is just:</p>\n\n<pre><code>Age    Count\n45\n21\n33\n33\n45\n33\n</code></pre>\n\n<p>How can I put this into a table as described below, where it essentially combines equal values together and provides a count for how much of it is in the database?</p>\n\n<p><strong>Question: How can I change the output of an active query record in my view?</strong></p>\n\n<p>I'm trying to create a \"statistics page\" for my app, and everything is going swimmingly but I wanted to try and reformat the output of a piece of code. </p>\n\n<p>Basically, users can type in their age, and this is recorded. The view displays how many users are of what age. </p>\n\n<p>So, this is the code I have so far:</p>\n\n<pre><code>Users controller: \n@users_age = User.group(:age).count\n\nUsers view: \nAge: &lt;%= @users_age %&gt; #which produces (below line)\nAge: {\"21\"=&gt;1, \"33\"=&gt;3, \"45\" =&gt; 2}\n</code></pre>\n\n<p>I want to try and change this output, to something like:</p>\n\n<pre><code>Age: [21 : 1, 33 : 3, 45 : 2]\n</code></pre>\n\n<p>Or</p>\n\n<pre><code>+-----+-------+\n| Age | Count |\n+-----+-------+\n|  21 |     1 |\n|  33 |     3 |\n|  45 |     2 |\n+-----+-------+\n</code></pre>\n\n<p>Is it possible to change this output? I wanted to do this because once there is enough data generated, it would become too much of a hassle changing the above format to what I need (essentially chuck it into an excel sheet and make graphs). Actually, is it possible to put this output into a HTML table, too? </p>\n\n<p>Thank you</p>\n"}, {"tags": ["ruby", "rubygems", "bundler"], "comments": [{"owner": {"reputation": 6462, "user_id": 3784008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/55ou4.jpg?s=128&g=1", "display_name": "anothermh", "link": "https://stackoverflow.com/users/3784008/anothermh"}, "edited": false, "score": 1, "creation_date": 1545696236, "post_id": 53918146, "comment_id": 94679685, "body": "Install RVM with <code>\\curl -sSL https:&#47;&#47;get.rvm.io | bash -s stable</code>; install Ruby with <code>rvm install 2.5.3</code>. <a href=\"https://robots.thoughtbot.com/psa-do-not-use-system-ruby\" rel=\"nofollow noreferrer\">Don&#39;t</a> <a href=\"https://chrisherring.co/posts/why-you-shouldn-t-use-the-system-ruby\" rel=\"nofollow noreferrer\">use</a> <a href=\"http://billpatrianakos.me/blog/2014/05/15/never-use-system-ruby-ever/\" rel=\"nofollow noreferrer\">system Ruby</a>."}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "reply_to_user": {"reputation": 6462, "user_id": 3784008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/55ou4.jpg?s=128&g=1", "display_name": "anothermh", "link": "https://stackoverflow.com/users/3784008/anothermh"}, "edited": false, "score": 1, "creation_date": 1545711918, "post_id": 53918146, "comment_id": 94681156, "body": "While you\u2019d better use any of ruby version manager, like suggested by @anothermh, you might fix the issue with <code>chown -R `whoami` &#47;usr&#47;local&#47;lib&#47;site_ruby</code>."}], "answers": [{"tags": [], "owner": {"reputation": 3201, "user_id": 2892779, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uvM8S.jpg?s=128&g=1", "display_name": "Jay Dorsey", "link": "https://stackoverflow.com/users/2892779/jay-dorsey"}, "is_accepted": true, "score": 5, "last_activity_date": 1545865789, "creation_date": 1545865789, "answer_id": 53938102, "question_id": 53918146, "link": "https://stackoverflow.com/questions/53918146/ruby-gem-command-fails-with-permission-denied-rb-sysopen/53938102#53938102", "title": "Ruby &quot;gem&quot; command fails with Permission denied @ rb_sysopen", "body": "<p>You get this error when you run without sudo because you're using what some people refer to as \"system\" ruby on your computer; it's the default ruby that ships with macOS. If you run <code>which ruby</code> it will most likely point to <code>/usr/bin/ruby</code> (if you haven't installed <code>rvm</code>, <code>rbenv</code>, or another ruby version manager.</p>\n\n<p>By default, system ruby (which includes the system <code>gem</code> and <code>bundler</code> commmands) points to a file location which requires <code>sudo</code> to install to.</p>\n\n<p>I recommend you don't run sudo to install gems; instead install a ruby version manager such as <a href=\"https://rvm.io/\" rel=\"noreferrer\">rvm</a> (the most popular), <a href=\"https://github.com/rbenv/rbenv\" rel=\"noreferrer\">rbenv</a> (also a popular choice), or <a href=\"https://github.com/asdf-vm/asdf\" rel=\"noreferrer\">asdf</a> (my preferred version manager because it manages more than just ruby, if you want to)</p>\n\n<p>Once you install a ruby version manager per the instructions you should be able to install a more recent version of ruby (system ruby is 2.3.7, the most recent is 2.6.0). The version manager will also setup sane paths for your <code>gem</code> and <code>bundle</code> commands, pointing to paths where you have write privileges without using <code>sudo</code></p>\n\n<p>A ruby version manager is highly recommended because it won't interfere with any system dependencies which might rely on the system ruby version, and a version manager allows you to install multiple versions of ruby and switch between them for different projects.</p>\n"}], "owner": {"reputation": 10031, "user_id": 1737817, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/tJBhZ.jpg?s=128&g=1", "display_name": "Nikunj Banka", "link": "https://stackoverflow.com/users/1737817/nikunj-banka"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3543, "favorite_count": 2, "accepted_answer_id": 53938102, "answer_count": 1, "score": 2, "last_activity_date": 1545865789, "creation_date": 1545691190, "question_id": 53918146, "link": "https://stackoverflow.com/questions/53918146/ruby-gem-command-fails-with-permission-denied-rb-sysopen", "title": "Ruby &quot;gem&quot; command fails with Permission denied @ rb_sysopen", "body": "<p>Something seems to be broken with my \"gem\" command. Here's what I get on running \"gem\"</p>\n\n<blockquote>\n  <p>/usr/local/lib/site_ruby/2.3.0/rubygems/stub_specification.rb:114:in\n  <code>initialize': Permission denied @ rb_sysopen -\n  /var/lib/gems/2.3.0/specifications/unicode-display_width-1.4.1.gemspec\n  (Errno::EACCES)   from\n  /usr/local/lib/site_ruby/2.3.0/rubygems/stub_specification.rb:114:in\n  </code>open'    from\n  /usr/local/lib/site_ruby/2.3.0/rubygems/stub_specification.rb:114:in\n  <code>data'    from\n  /usr/local/lib/site_ruby/2.3.0/rubygems/stub_specification.rb:204:in\n  </code>valid?'  from\n  /usr/local/lib/site_ruby/2.3.0/rubygems/specification.rb:774:in\n  <code>select'  from\n  /usr/local/lib/site_ruby/2.3.0/rubygems/specification.rb:774:in\n  </code>gemspec_stubs_in'    from\n  /usr/local/lib/site_ruby/2.3.0/rubygems/specification.rb:798:in <code>block\n  in map_stubs'     from\n  /usr/local/lib/site_ruby/2.3.0/rubygems/specification.rb:795:in</code>each'\n    from /usr/local/lib/site_ruby/2.3.0/rubygems/specification.rb:795:in\n  <code>flat_map'    from\n  /usr/local/lib/site_ruby/2.3.0/rubygems/specification.rb:795:in\n  </code>map_stubs'   from\n  /usr/local/lib/site_ruby/2.3.0/rubygems/specification.rb:788:in\n  <code>installed_stubs'     from\n  /usr/local/lib/site_ruby/2.3.0/rubygems/specification.rb:826:in\n  </code>stubs'   from\n  /usr/local/lib/site_ruby/2.3.0/rubygems/specification.rb:747:in <code>_all'\n    from /usr/local/lib/site_ruby/2.3.0/rubygems/specification.rb:1131:in\n  </code>latest_specs'    from /usr/local/lib/site_ruby/2.3.0/rubygems.rb:546:in\n  <code>find_latest_files'   from\n  /usr/local/lib/site_ruby/2.3.0/rubygems.rb:1111:in</code>load_plugins'\n    from /usr/local/lib/site_ruby/2.3.0/rubygems/gem_runner.rb:86:in\n  <code>&lt;top (required)&gt;'    from\n  /usr/local/lib/site_ruby/2.3.0/rubygems/core_ext/kernel_require.rb:54:in\n  </code>require'     from\n  /usr/local/lib/site_ruby/2.3.0/rubygems/core_ext/kernel_require.rb:54:in\n  <code>require'     from /usr/bin/gem:9:in</code>'</p>\n</blockquote>\n\n<p>However the command runs fine if I do \"sudo gem\". </p>\n\n<p>The bigger problem is that I am not able to use \"bundle\" to install new gems(e.g., fastlane). Note that I am using \"bundle update\" to install a gem via a Gemfile. And that <strong>fails with the exact same stack trace</strong> as the one posted above. </p>\n\n<p>How can I fix this issue? Thanks!</p>\n"}, {"tags": ["ruby", "heroku"], "comments": [{"owner": {"reputation": 9971, "user_id": 8255744, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de22299534b5a8ed244ee8ff4aa6c481?s=128&d=identicon&r=PG&f=1", "display_name": "Simple Lime", "link": "https://stackoverflow.com/users/8255744/simple-lime"}, "edited": false, "score": 2, "creation_date": 1545695377, "post_id": 53917790, "comment_id": 94679563, "body": "&quot;ActionView::MissingTemplate (Missing template user_mailer/welcome ...&quot;, does that file actually exist?"}, {"owner": {"reputation": 21, "user_id": 9939428, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6a7ec893773c7be2dcd8b6f8310dca98?s=128&d=identicon&r=PG&f=1", "display_name": "PonU86", "link": "https://stackoverflow.com/users/9939428/ponu86"}, "reply_to_user": {"reputation": 9971, "user_id": 8255744, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de22299534b5a8ed244ee8ff4aa6c481?s=128&d=identicon&r=PG&f=1", "display_name": "Simple Lime", "link": "https://stackoverflow.com/users/8255744/simple-lime"}, "edited": false, "score": 0, "creation_date": 1545754739, "post_id": 53917790, "comment_id": 94689489, "body": "I figured out the problem for user mailer.  But I am still stuck on the UserRegistrationController"}], "owner": {"reputation": 21, "user_id": 9939428, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6a7ec893773c7be2dcd8b6f8310dca98?s=128&d=identicon&r=PG&f=1", "display_name": "PonU86", "link": "https://stackoverflow.com/users/9939428/ponu86"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 70, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1545687951, "creation_date": 1545686839, "last_edit_date": 1545687951, "question_id": 53917790, "link": "https://stackoverflow.com/questions/53917790/my-website-sign-up-page-is-not-loading-correctly", "title": "My website sign-up page is not loading correctly", "body": "<p>When a new user signs up on my website, it comes back </p>\n\n<blockquote>\n  <p>We're sorry, but something went wrong.  </p>\n</blockquote>\n\n<p>But if you then sign in using that same user it works.  I am thinking something is wrong with my sign-up page set up, but I cannot seem to figure out why it does not work.</p>\n\n<p>I ran heroku logs and these are the errors I get.</p>\n\n<pre><code>Error in 186ms (ActiveRecord: 6.4ms)\n2018-12-24T20:39:15.626963+00:00 app[web.1]: F, [2018-12-24T20:39:15.626869 #4] FATAL -- : [3aaa57fe-9a15-468b-9371-313e8153d9bc]\n2018-12-24T20:39:15.627057+00:00 app[web.1]: F, [2018-12-24T20:39:15.626998 #4] FATAL -- : [3aaa57fe-9a15-468b-9371-313e8153d9bc] ActionView::MissingTemplate (Missing template user_mailer/welcome with \"mailer\". Searched in:\n2018-12-24T20:39:15.627061+00:00 app[web.1]: * \"user_mailer\"\n2018-12-24T20:39:15.627063+00:00 app[web.1]: ):\n2018-12-24T20:39:15.627143+00:00 app[web.1]: F, [2018-12-24T20:39:15.627089 #4] FATAL -- : [3aaa57fe-9a15-468b-9371-313e8153d9bc]\n2018-12-24T20:39:15.627246+00:00 app[web.1]: F, [2018-12-24T20:39:15.627182 #4] FATAL -- : [3aaa57fe-9a15-468b-9371-313e8153d9bc] app/mailers/user_mailer.rb:13:in `welcome'\n2018-12-24T20:39:15.627249+00:00 app[web.1]: [3aaa57fe-9a15-468b-9371-313e8153d9bc] app/controllers/user.registrations.controller.rb:5:in `create'\n2018-12-24T20:39:15.627862+00:00 heroku[router]: at=info method=POST path=\"/users\" host=building-together.herokuapp.com request_id=3aaa57fe-9a15-468b-9371-313e8153d9bc fwd=\"75.187.204.211\" dyno=web.1 connect=0ms service=191ms status=500 bytes=1827 protocol=https\n</code></pre>\n\n<p>This first code is the user.mailer.rb:13 FATAL</p>\n\n<pre><code>class UserMailer &lt; ApplicationMailer\n  default from: \"from@example.com\"\n\n  def contact_form(email, name, message)\n    @message = message\n      mail(from: email,\n            to: 'hostetlerp@gmail.com',\n            subject: \"A new contact form message from #{name}\")\n  end\n\n  def welcome(user)\n    @appname = \"Bike Shop\"\n    mail(to: user.email,      (This is the line 13 FATAL)\n          subject: \"Welcome to #{@appname}!\")\n  end\n\n  def thank_you\n    @name = params[:name]\n    @email = params[:email]\n    @message = params[:message]\n    UserMailer.contact_form(@email, @name, @message).deliver_now\n  end\nend\n</code></pre>\n\n<p>This is the second FATAL user.registrations.controller.rb:5</p>\n\n<pre><code>class UserRegistrationsController &lt; Devise::RegistrationsController\n  def create\n    super\n    if @user.persisted?\n      UserMailer.welcome(@user).deliever_now  (This is the line 5 FATAL)\n    end\n  end\nend\n</code></pre>\n\n<p>I cannot seem to figure out what I am missing here.  In the code for the course it all looks the same, but the page is not working.  </p>\n\n<p>Please help</p>\n"}, {"tags": ["ruby", "shrine"], "answers": [{"tags": [], "owner": {"reputation": 3669, "user_id": 3678689, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/eadd310b0e2a59fe38c4ffbdb2884dfd?s=128&d=identicon&r=PG", "display_name": "Jan Klimo", "link": "https://stackoverflow.com/users/3678689/jan-klimo"}, "is_accepted": true, "score": 3, "last_activity_date": 1545745317, "creation_date": 1545745317, "answer_id": 53922920, "question_id": 53916740, "link": "https://stackoverflow.com/questions/53916740/extracting-image-dimensions-in-the-background-with-shrine/53922920#53922920", "title": "Extracting image dimensions in the background with Shrine", "body": "<p>The way I got this to work is by making use of <code>:refresh_metadata</code> plugin, instead of <code>:restore_cached_data</code> which I used originally. Thanks to Janko for <a href=\"https://groups.google.com/d/msg/ruby-shrine/663aCkkEPIg/J1nWBHxJCwAJ\" rel=\"nofollow noreferrer\">pointing me</a> in the right direction.</p>\n\n<p>Reading into the source code provided some useful insights. <code>:store_dimensions</code> plugin by itself doesn't extract dimensions - it <a href=\"https://github.com/shrinerb/shrine/blob/267fdd413898ca90eec242a71684f906f2d1d1bf/lib/shrine/plugins/store_dimensions.rb#L104\" rel=\"nofollow noreferrer\">adds</a> width and height to the metadata hash so that when Shrine's base class <a href=\"https://github.com/shrinerb/shrine/blob/267fdd413898ca90eec242a71684f906f2d1d1bf/lib/shrine.rb#L327\" rel=\"nofollow noreferrer\">requests metadata</a>, they get extracted too.</p>\n\n<p>By using <code>:restore_cached_data</code>, this was being done on every assignment. <code>:restore_cached_data</code> <a href=\"https://github.com/shrinerb/shrine/blob/267fdd413898ca90eec242a71684f906f2d1d1bf/lib/shrine/plugins/restore_cached_data.rb#L24\" rel=\"nofollow noreferrer\">uses</a> <code>:refresh_metadata</code> internally so we can use that knowledge to only call it when the file is promoted to the store.</p>\n\n<p>I have <code>:backgrounding</code> and <code>:store_dimensions</code> set up in the initializer so the final uploader can be simplified to this:</p>\n\n<pre><code>class ImageUploader &lt; Shrine\n  plugin :refresh_metadata\n  plugin :processing\n\n  process(:store) do |io, context|\n    io.refresh_metadata!(context)\n    io\n  end\nend\n</code></pre>\n\n<p>This way persisting data we get from Uppy is super fast and we let the background job extract dimensions when the file is promoted to the store, so they can be used later.</p>\n\n<p>Finally, should you have questions related to Shrine, I highly recommend its dedicated <a href=\"https://groups.google.com/forum/?#!forum/ruby-shrine\" rel=\"nofollow noreferrer\">Google Group</a>. Kudos to Janko for not only creating an amazing piece of software (seriously, go read the source), but also for his dedication to supporting the community.</p>\n"}], "owner": {"reputation": 3669, "user_id": 3678689, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/eadd310b0e2a59fe38c4ffbdb2884dfd?s=128&d=identicon&r=PG", "display_name": "Jan Klimo", "link": "https://stackoverflow.com/users/3678689/jan-klimo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 180, "favorite_count": 1, "accepted_answer_id": 53922920, "answer_count": 1, "score": 2, "last_activity_date": 1545745317, "creation_date": 1545676293, "question_id": 53916740, "link": "https://stackoverflow.com/questions/53916740/extracting-image-dimensions-in-the-background-with-shrine", "title": "Extracting image dimensions in the background with Shrine", "body": "<p>I have set up direct uploads to S3 with Shrine. This works great. Among others, I have the following plugins enabled:</p>\n\n<pre><code>Shrine.plugin :backgrounding\nShrine.plugin :store_dimensions \nShrine.plugin :restore_cached_data\n</code></pre>\n\n<p>Correct me if I'm wrong but image dimensions extraction appears to be done synchronously. If I let the user bulk upload images via Uppy and then persist them all, this seems to be taking a long time.</p>\n\n<p>What I'd like to do is perform image dimensions extraction asynchronously - I don't need the dimensions available for the cached file. If possible, I'd like to do that in the background when the file gets promoted to the store. Is there a way to do it?</p>\n"}, {"tags": ["ruby", "encryption", "openssl", "pkcs#5", "kdf"], "comments": [{"owner": {"reputation": 93, "user_id": 4636976, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/26JeV.png?s=128&g=1", "display_name": "mightymatth", "link": "https://stackoverflow.com/users/4636976/mightymatth"}, "reply_to_user": {"reputation": 3791, "user_id": 1820553, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-NZb6uZzo4Gg/AAAAAAAAAAI/AAAAAAAAAo0/xTr6RvgMTRw/photo.jpg?sz=128", "display_name": "kelalaka", "link": "https://stackoverflow.com/users/1820553/kelalaka"}, "edited": false, "score": 0, "creation_date": 1545677574, "post_id": 53916294, "comment_id": 94676488, "body": "@kelalaka excuse me, I&#39;ve pasted wrong line of code when I was trying out. Still doesn&#39;t work with <code>-base64</code>. Thanks for pointing this out."}, {"owner": {"reputation": 3791, "user_id": 1820553, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-NZb6uZzo4Gg/AAAAAAAAAAI/AAAAAAAAAo0/xTr6RvgMTRw/photo.jpg?sz=128", "display_name": "kelalaka", "link": "https://stackoverflow.com/users/1820553/kelalaka"}, "edited": false, "score": 1, "creation_date": 1545678192, "post_id": 53916294, "comment_id": 94676649, "body": "next problem, <a href=\"https://www.openssl.org/docs/manmaster/man1/openssl-enc.html\" rel=\"nofollow noreferrer\">PBKDF2</a> you use -md but in your code, you generate form PBKDF2. You must use the same parameters, too"}, {"owner": {"reputation": 93, "user_id": 4636976, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/26JeV.png?s=128&g=1", "display_name": "mightymatth", "link": "https://stackoverflow.com/users/4636976/mightymatth"}, "reply_to_user": {"reputation": 3791, "user_id": 1820553, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-NZb6uZzo4Gg/AAAAAAAAAAI/AAAAAAAAAo0/xTr6RvgMTRw/photo.jpg?sz=128", "display_name": "kelalaka", "link": "https://stackoverflow.com/users/1820553/kelalaka"}, "edited": false, "score": 0, "creation_date": 1545679016, "post_id": 53916294, "comment_id": 94676842, "body": "@kelalaka another silly wrong attempt. thanks. Still doesn&#39;t work."}, {"owner": {"reputation": 3791, "user_id": 1820553, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-NZb6uZzo4Gg/AAAAAAAAAAI/AAAAAAAAAo0/xTr6RvgMTRw/photo.jpg?sz=128", "display_name": "kelalaka", "link": "https://stackoverflow.com/users/1820553/kelalaka"}, "edited": false, "score": 0, "creation_date": 1545679061, "post_id": 53916294, "comment_id": 94676849, "body": "are you sure you are using the same parameters? you should post it, too."}, {"owner": {"reputation": 93, "user_id": 4636976, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/26JeV.png?s=128&g=1", "display_name": "mightymatth", "link": "https://stackoverflow.com/users/4636976/mightymatth"}, "reply_to_user": {"reputation": 3791, "user_id": 1820553, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-NZb6uZzo4Gg/AAAAAAAAAAI/AAAAAAAAAo0/xTr6RvgMTRw/photo.jpg?sz=128", "display_name": "kelalaka", "link": "https://stackoverflow.com/users/1820553/kelalaka"}, "edited": false, "score": 0, "creation_date": 1545679282, "post_id": 53916294, "comment_id": 94676905, "body": "@kelalaka which parameters exactly? I think that you can reproduce it just by copy pasting it in terminal. I run it on macOS, ruby 2.4.1, system openssl (libressl) 2.7.7"}, {"owner": {"reputation": 3791, "user_id": 1820553, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-NZb6uZzo4Gg/AAAAAAAAAAI/AAAAAAAAAo0/xTr6RvgMTRw/photo.jpg?sz=128", "display_name": "kelalaka", "link": "https://stackoverflow.com/users/1820553/kelalaka"}, "edited": false, "score": 0, "creation_date": 1545680517, "post_id": 53916294, "comment_id": 94677174, "body": "The keygen part must be matched. libressl doesn&#39;t support PBKDF2, as I can see. Change the Ruby part to match."}, {"owner": {"reputation": 93, "user_id": 4636976, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/26JeV.png?s=128&g=1", "display_name": "mightymatth", "link": "https://stackoverflow.com/users/4636976/mightymatth"}, "reply_to_user": {"reputation": 3791, "user_id": 1820553, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-NZb6uZzo4Gg/AAAAAAAAAAI/AAAAAAAAAo0/xTr6RvgMTRw/photo.jpg?sz=128", "display_name": "kelalaka", "link": "https://stackoverflow.com/users/1820553/kelalaka"}, "edited": false, "score": 0, "creation_date": 1545689705, "post_id": 53916294, "comment_id": 94678873, "body": "Let us <a href=\"https://chat.stackoverflow.com/rooms/185742/discussion-between-niflheim-and-kelalaka\">continue this discussion in chat</a>."}], "owner": {"reputation": 93, "user_id": 4636976, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/26JeV.png?s=128&g=1", "display_name": "mightymatth", "link": "https://stackoverflow.com/users/4636976/mightymatth"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 869, "favorite_count": 0, "answer_count": 0, "score": 3, "last_activity_date": 1545679349, "creation_date": 1545672863, "last_edit_date": 1545679349, "question_id": 53916294, "link": "https://stackoverflow.com/questions/53916294/aes-256-cbc-encrypt-with-ruby-with-openssl-not-working", "title": "AES 256 CBC encrypt with Ruby with OpenSSL not working", "body": "<p>I'm trying to encrypt data with OpenSSL library in Ruby using passphrase.\nRuby code looks like this:</p>\n\n<pre><code>require('openssl')\nrequire('base64')\n\ncipher = OpenSSL::Cipher.new ('AES-256-CBC')\ncipher.encrypt\ncipher.iv = iv = cipher.random_iv\n\npwd = 'topsecret'\nsalt = OpenSSL::Random.random_bytes 8\niter = 10000\nkey_len = cipher.key_len\ndigest = OpenSSL::Digest::SHA256.new\n\nkey = OpenSSL::PKCS5.pbkdf2_hmac(pwd, salt, iter, key_len, digest)\ncipher.key = key\n\nputs \"salt=#{salt.unpack('H*')[0]}\"\nputs \"key=#{key.unpack('H*')[0]}\"\nputs \"iv=#{iv.unpack('H*')[0]}\"\n\nencrypted = cipher.update 'my data to encrypt'\nencrypted &lt;&lt; cipher.final\n\nputs \"encrypted=#{Base64.strict_encode64(encrypted)}\"\n\n# it returns:\n# salt=1332e5603cbc018a\n# key=11a168cf01556a5ee3e22e049f0e65d3adcd75f39e32c7d19aec32a0ccb40d93\n# iv=35a08f2d3e719abbee78a0f4fe47c938\n# encrypted=E3Ag6cRL2R+xytgw01i6tKSFpV7s7bKoiiWvPA1FYxM=\n</code></pre>\n\n<p>Unfortunately, when I try to decrypt this, I get error <code>bad magic number</code>:</p>\n\n<pre><code>$ echo \"E3Ag6cRL2R+xytgw01i6tKSFpV7s7bKoiiWvPA1FYxM=\" | openssl enc -aes-256-cbc -base64 -d -p -pass pass:topsecret\nbad magic number\n</code></pre>\n\n<p>However, when I try this in terminal by running <code>openssl enc</code> command, it works:</p>\n\n<pre><code>$ echo 'my data' | openssl enc -aes-256-cbc -base64 -p -pass pass:topsecret                            \nsalt=8135837A305553F2\nkey=8B4373ABD786BAC107F4112640E95E920C77C017FCEC18E1BD919CED42F0298E\niv =910637CE50FADF27D944B7A8DD239E6D\nU2FsdGVkX1+BNYN6MFVT8oWa5P/oxZFwzMk1DRCSSGg=\n\n$ echo \"U2FsdGVkX1+BNYN6MFVT8oWa5P/oxZFwzMk1DRCSSGg=\" | openssl enc - aes-256-cbc -d -p -base64 -pass pass:topsecret\nsalt=8135837A305553F2\nkey=8B4373ABD786BAC107F4112640E95E920C77C017FCEC18E1BD919CED42F0298E\niv =910637CE50FADF27D944B7A8DD239E6D\nmy data\n</code></pre>\n\n<p>I think I tried every possible combination of generating key/IV from passphrase but I get error every time. Is anyone able to spot where is the problem with this way? I've spent entire day on this.</p>\n"}, {"tags": ["ruby", "sorting"], "comments": [{"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 3, "creation_date": 1545680291, "post_id": 53915892, "comment_id": 94677130, "body": "Two small suggestion: when you give an example express all inputs as Ruby objects. Here that would be <code>[&quot;1:5&quot;, &quot;11:36&quot;, &quot;2:1&quot;, &quot;2:14&quot;, &quot;2:8&quot;]</code>. It&#39;s not unusual to see questions down-voted when inputs are not valid Ruby objects. Secondly, it&#39;s helpful to attach a variable to each of those objects: <code>arr = [&quot;1:5&quot;, &quot;11:36&quot;, &quot;2:1&quot;, &quot;2:14&quot;, &quot;2:8&quot;]</code>. That way, we can refer to those variables in answers and comments without having to define them."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 1, "creation_date": 1545680989, "post_id": 53915892, "comment_id": 94677262, "body": "Expressing inputs as I suggested has the side-benefit of allowing readers to cut-and-paste when they are preparing answers."}, {"owner": {"reputation": 690, "user_id": 1150092, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/c67edf44b78eeb7b878d3354cfc25a05?s=128&d=identicon&r=PG", "display_name": "ryanpitts1", "link": "https://stackoverflow.com/users/1150092/ryanpitts1"}, "reply_to_user": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1545696469, "post_id": 53915892, "comment_id": 94679712, "body": "@CarySwoveland thanks for the suggestion. You&#39;re absolutely right. :)"}, {"owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 0, "creation_date": 1545714142, "post_id": 53915892, "comment_id": 94681394, "body": "@ryanpitts1 If you think so, you should edit your question and follow the suggestions."}], "answers": [{"tags": [], "owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "is_accepted": true, "score": 9, "last_activity_date": 1545670425, "creation_date": 1545670425, "answer_id": 53915920, "question_id": 53915892, "link": "https://stackoverflow.com/questions/53915892/sort-numbers-with-colons/53915920#53915920", "title": "Sort numbers with colons", "body": "<p>Use <a href=\"https://ruby-doc.org/core/Enumerable.html#method-i-sort_by\" rel=\"noreferrer\"><code>Enumerable#sort_by</code></a></p>\n\n<pre><code>input = %w|1:5 11:36 2:1 2:14 2:8|\ninput.sort_by { |e| e.split(':').map(&amp;:to_i) }\n#\u21d2 [\"1:5\", \"2:1\", \"2:8\", \"2:14\", \"11:36\"]\n</code></pre>\n\n<p><code>map(&amp;:to_i)</code> part is needed to make integers out of strings, because <code>11 &gt; 2</code> but <code>\"11\" &lt; \"2\"</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "is_accepted": false, "score": 6, "last_activity_date": 1545678122, "creation_date": 1545678122, "answer_id": 53916926, "question_id": 53915892, "link": "https://stackoverflow.com/questions/53915892/sort-numbers-with-colons/53916926#53916926", "title": "Sort numbers with colons", "body": "<pre><code>arr = %w| 1:5 11:36 2:1 2:14 2:8 |\n  #=&gt; [\"1:5\", \"11:36\", \"2:1\", \"2:14\", \"2:8\"]\n\narr.sort_by { |s| Gem::Version.new(s.tr(':', '.')) }\n  #=&gt; [\"1:5\", \"2:1\", \"2:8\", \"2:14\", \"11:36\"]\n</code></pre>\n\n<p>See <a href=\"http://ruby-doc.org/core-2.5.1/Enumerable.html#method-i-sort_by\" rel=\"noreferrer\">Enumerable#sort_by</a>, <a href=\"http://ruby-doc.org/core-2.5.1/String.html#method-i-tr\" rel=\"noreferrer\">String#tr</a> and <a href=\"http://ruby-doc.org/stdlib-2.5.3/libdoc/rubygems/rdoc/Gem/Version.html#method-c-new\" rel=\"noreferrer\">Gem::Version::new</a>. The latter is part of the standard Ruby library.</p>\n"}], "owner": {"reputation": 690, "user_id": 1150092, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/c67edf44b78eeb7b878d3354cfc25a05?s=128&d=identicon&r=PG", "display_name": "ryanpitts1", "link": "https://stackoverflow.com/users/1150092/ryanpitts1"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 127, "favorite_count": 1, "accepted_answer_id": 53915920, "answer_count": 2, "score": 3, "last_activity_date": 1545714085, "creation_date": 1545670157, "last_edit_date": 1545714085, "question_id": 53915892, "link": "https://stackoverflow.com/questions/53915892/sort-numbers-with-colons", "title": "Sort numbers with colons", "body": "<p>I have a list of Bible verses, times, or some other strings with numbers and colons. I would like those sorted into this:</p>\n\n<pre><code>1:5\n2:1\n2:8\n2:14\n11:36\n</code></pre>\n\n<p>How would I sort those numbers?</p>\n\n<p>I assume I have to parse the string, separate on colon, and then sort. What I tried gives me things like this:</p>\n\n<pre><code>1:5\n11:36\n2:1\n2:14\n2:8\n</code></pre>\n"}, {"tags": ["ruby", "github", "pull-request"], "comments": [{"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 1, "creation_date": 1545666165, "post_id": 53915170, "comment_id": 94673667, "body": "<code>=~ #{change}</code> is read as <code>=~</code> because <code>#</code> starts an inline comment. You probably wanted <code>=~ change</code> there instead."}, {"owner": {"reputation": 2689, "user_id": 1465536, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/ece89259291e233fba34091b8c9d80b4?s=128&d=identicon&r=PG", "display_name": "iOSAppDev", "link": "https://stackoverflow.com/users/1465536/iosappdev"}, "reply_to_user": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1545666734, "post_id": 53915170, "comment_id": 94673845, "body": "@AlekseiMatiushkin If I removed # then it gives me below error <code>[!] Invalid Dangerfile file: type mismatch: String given. </code>"}, {"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 0, "creation_date": 1545728807, "post_id": 53915170, "comment_id": 94683864, "body": "You should start using a better editor. Even the extremely simplistic, naive, stupid syntax highlighting of <a href=\"https://stackoverflow.com\">Stack Overflow</a> already clearly shows your problem!"}], "answers": [{"comments": [{"owner": {"reputation": 2689, "user_id": 1465536, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/ece89259291e233fba34091b8c9d80b4?s=128&d=identicon&r=PG", "display_name": "iOSAppDev", "link": "https://stackoverflow.com/users/1465536/iosappdev"}, "edited": false, "score": 0, "creation_date": 1545667740, "post_id": 53915450, "comment_id": 94674168, "body": "Thank you @Aleksei Matiushkin for your help. Using <code>Regexp.new(change)</code> worked perfectly :)"}, {"owner": {"reputation": 2689, "user_id": 1465536, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/ece89259291e233fba34091b8c9d80b4?s=128&d=identicon&r=PG", "display_name": "iOSAppDev", "link": "https://stackoverflow.com/users/1465536/iosappdev"}, "edited": false, "score": 0, "creation_date": 1545669447, "post_id": 53915450, "comment_id": 94674577, "body": "If one the file has not changed in my PR then <code>git.diff_for_file(file).patch =~ Regexp.new(change)</code> throws error as <code>[!] Invalid Dangerfile file: undefined method patch for nil:NilClass.</code> Can we make it optional by checking if diff has the file then only call the patch method? Otherwise I need to switch my function instead of using rubyish way"}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "reply_to_user": {"reputation": 2689, "user_id": 1465536, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/ece89259291e233fba34091b8c9d80b4?s=128&d=identicon&r=PG", "display_name": "iOSAppDev", "link": "https://stackoverflow.com/users/1465536/iosappdev"}, "edited": false, "score": 0, "creation_date": 1545669624, "post_id": 53915450, "comment_id": 94674615, "body": "Updated the answer."}, {"owner": {"reputation": 2689, "user_id": 1465536, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/ece89259291e233fba34091b8c9d80b4?s=128&d=identicon&r=PG", "display_name": "iOSAppDev", "link": "https://stackoverflow.com/users/1465536/iosappdev"}, "edited": false, "score": 0, "creation_date": 1545669854, "post_id": 53915450, "comment_id": 94674665, "body": "Does break will update the value of <code>does_contain_required_changes</code> to <code>false</code> in this case?"}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "reply_to_user": {"reputation": 2689, "user_id": 1465536, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/ece89259291e233fba34091b8c9d80b4?s=128&d=identicon&r=PG", "display_name": "iOSAppDev", "link": "https://stackoverflow.com/users/1465536/iosappdev"}, "edited": false, "score": 1, "creation_date": 1545670007, "post_id": 53915450, "comment_id": 94674700, "body": "Sure. <code>break false</code> does immediately exit the iteration returning <code>false</code>."}, {"owner": {"reputation": 2689, "user_id": 1465536, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/ece89259291e233fba34091b8c9d80b4?s=128&d=identicon&r=PG", "display_name": "iOSAppDev", "link": "https://stackoverflow.com/users/1465536/iosappdev"}, "edited": false, "score": 0, "creation_date": 1545670564, "post_id": 53915450, "comment_id": 94674812, "body": "It worked perfectly now. Just wondering whether we can return the <code>file</code> along with <code>false</code> so that I can use it <code>warn</code> message? Does ruby supports tuples?"}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "reply_to_user": {"reputation": 2689, "user_id": 1465536, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/ece89259291e233fba34091b8c9d80b4?s=128&d=identicon&r=PG", "display_name": "iOSAppDev", "link": "https://stackoverflow.com/users/1465536/iosappdev"}, "edited": false, "score": 0, "creation_date": 1545670857, "post_id": 53915450, "comment_id": 94674894, "body": "Ruby does support tuples, but if you need a file name it\u2019d be easier to return a problematic file name back and assume <code>nil</code> means \u201call good.\u201d See the update."}, {"owner": {"reputation": 2689, "user_id": 1465536, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/ece89259291e233fba34091b8c9d80b4?s=128&d=identicon&r=PG", "display_name": "iOSAppDev", "link": "https://stackoverflow.com/users/1465536/iosappdev"}, "edited": false, "score": 0, "creation_date": 1545671300, "post_id": 53915450, "comment_id": 94674999, "body": "Does <code>problematic_file</code> contain single file if <code>change</code> is not present in single file or multiple files when <code>change</code> is not present in multiple files? This will help us give meaningful warning message so that developer can make <code>change</code> in all files in one go? Also can I return <code>problematic_file</code> along with <code>does_contain_required_changes</code> on last line because this is reusable function?"}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "reply_to_user": {"reputation": 2689, "user_id": 1465536, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/ece89259291e233fba34091b8c9d80b4?s=128&d=identicon&r=PG", "display_name": "iOSAppDev", "link": "https://stackoverflow.com/users/1465536/iosappdev"}, "edited": false, "score": 1, "creation_date": 1545671765, "post_id": 53915450, "comment_id": 94675102, "body": "To get all the files use select instead of detect and check if the outcome is empty instead of checking whether it is nil."}, {"owner": {"reputation": 2689, "user_id": 1465536, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/ece89259291e233fba34091b8c9d80b4?s=128&d=identicon&r=PG", "display_name": "iOSAppDev", "link": "https://stackoverflow.com/users/1465536/iosappdev"}, "edited": false, "score": 1, "creation_date": 1545673269, "post_id": 53915450, "comment_id": 94675443, "body": "It worked by using <code>select</code> &amp; checking against <code>empty</code>. Thank you very much for your help :)"}], "tags": [], "owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "is_accepted": true, "score": 1, "last_activity_date": 1545670809, "last_edit_date": 1545670809, "creation_date": 1545666867, "answer_id": 53915450, "question_id": 53915170, "link": "https://stackoverflow.com/questions/53915170/ruby-void-value-expression-while-using-if-else-with-break/53915450#53915450", "title": "Ruby: void value expression while using if else with break", "body": "<p><code>=~ #{change}</code> is read as just <code>=~</code> because <code>#</code> starts an inline comment. <code>=~</code> expects a regular expression on one of sides. To fix the issue, change the line below:</p>\n\n<pre><code>patch_contains_change = diff.patch =~ #{change}\n</code></pre>\n\n<p>to:</p>\n\n<pre><code>patch_contains_change = diff.patch =~ Regexp.new(change)\n</code></pre>\n\n<p>This assumes you are passing a string as <code>change</code>.</p>\n\n<hr>\n\n<p>Also, this would be <em>more or less</em> rubyish way to accomplish the task:</p>\n\n<pre><code>def modified_files_contains_change(files, change)\n  does_contain_required_changes =\n    files.all? do |file|\n      message \"diff in #{file}\"\n      # break will immediately exit the `all?` unless diff is present\n      break false unless diff = git.diff_for_file(file) \n      diff.patch =~ Regexp.new(change)\n    end\n\n  message \"Does contain changes in all files =&gt; #{does_contain_required_changes}\"\n  does_contain_required_changes\nend\n</code></pre>\n\n<hr>\n\n<p>To return a file where we found an issue:</p>\n\n<pre><code>def modified_files_contains_change(files, change)\n  problematic_file =\n    files.detect do |file|\n      message \"diff in #{file}\"\n      (diff = git.diff_for_file(file)).nil? || diff.patch !~ Regexp.new(change)\n    end\n\n  does_contain_required_changes = problematic_file.nil?\n  if does_contain_required_changes\n    message \"All good!\"\n  else\n    message \"We have issues with file #{problematic_file}\"\n  end\n  does_contain_required_changes\nend\n</code></pre>\n"}], "owner": {"reputation": 2689, "user_id": 1465536, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/ece89259291e233fba34091b8c9d80b4?s=128&d=identicon&r=PG", "display_name": "iOSAppDev", "link": "https://stackoverflow.com/users/1465536/iosappdev"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 217, "favorite_count": 0, "accepted_answer_id": 53915450, "answer_count": 1, "score": 0, "last_activity_date": 1545670809, "creation_date": 1545664981, "last_edit_date": 1545667227, "question_id": 53915170, "link": "https://stackoverflow.com/questions/53915170/ruby-void-value-expression-while-using-if-else-with-break", "title": "Ruby: void value expression while using if else with break", "body": "<p>I am new to Ruby language. I am working on integrating the <a href=\"https://github.com/danger/danger\" rel=\"nofollow noreferrer\">Danger</a> to add checks on GitHub PR. One of the use case is to check if modified files in my PR contains particular change. I have added below code in DangerFile </p>\n\n<pre><code>filesArray = [\"Resources/Config.plist\", \"Resources/Deployment.plist\"]\n\ndef modified_files_contains_change(files, change)\n    does_contain_required_changes = false\n    for file in files do\n        message \"diff in #{file}\"\n        diff = git.diff_for_file(file)\n        patch_contains_change = diff.patch =~ #{change}\n        if diff &amp;&amp; patch_contains_change\n            does_contain_required_changes = true\n        else\n            does_contain_required_changes = false\n            break\n        end\n    end\n    message \"Does contain changes in all files =&gt; #{does_contain_required_changes}\"\n    does_contain_required_changes\nend\n\nif modified_files_contains_change(files, change)\n   warn \"Some useful warning message goes here\"\nend\n</code></pre>\n\n<p>While running this on my CI, I am getting below error</p>\n\n<pre><code>[!] Invalid `Dangerfile` file: void value expression. \n\n #  from Dangerfile:33\n #  -------------------------------------------\n #              does_contain_required_changes = false\n &gt;              break\n #          end\n #      end\n #  -------------------------------------------\n</code></pre>\n\n<p>I tried searching but didn't understand the what's going wrong. Can someone please help me understand what is the exact issue? Thanks in advance.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "amazon-web-services", "amazon-s3", "paperclip"], "comments": [{"owner": {"reputation": 6039, "user_id": 2137458, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8cfca832ee746f3e3d9971148f52dc64?s=128&d=identicon&r=PG", "display_name": "NM Pennypacker", "link": "https://stackoverflow.com/users/2137458/nm-pennypacker"}, "edited": false, "score": 0, "creation_date": 1545662757, "post_id": 53914756, "comment_id": 94672770, "body": "Do you see any errors in your browser console? Might be a http/https issue."}, {"owner": {"reputation": 555, "user_id": 3491653, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4a181bf47a17fe43bf62ff3778525bfa?s=128&d=identicon&r=PG&f=1", "display_name": "i_use_the_internet", "link": "https://stackoverflow.com/users/3491653/i-use-the-internet"}, "reply_to_user": {"reputation": 6039, "user_id": 2137458, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8cfca832ee746f3e3d9971148f52dc64?s=128&d=identicon&r=PG", "display_name": "NM Pennypacker", "link": "https://stackoverflow.com/users/2137458/nm-pennypacker"}, "edited": false, "score": 0, "creation_date": 1545662969, "post_id": 53914756, "comment_id": 94672832, "body": "@NMPennypacker Damn you were right!. I see an error on the console: Content Security Policy: The page\u2019s settings blocked the loading of a resource at <a href=\"http://bucketname-images.s3.us-east-2.amazonaws.com/posts/images/000/000/016/square_editedimage_.png?1545616391\" rel=\"nofollow noreferrer\">bucketname-images.s3.us-east-2.amazonaws.com/posts/images/00&zwnj;&#8203;0/&hellip;</a> (\u201cimg-src\u201d)."}], "answers": [{"comments": [{"owner": {"reputation": 555, "user_id": 3491653, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4a181bf47a17fe43bf62ff3778525bfa?s=128&d=identicon&r=PG&f=1", "display_name": "i_use_the_internet", "link": "https://stackoverflow.com/users/3491653/i-use-the-internet"}, "edited": false, "score": 0, "creation_date": 1545664592, "post_id": 53914983, "comment_id": 94673284, "body": "This worked! I edited <code>config&#47;initializers&#47;content_security_policy.rb</code> and changed <code>img_src :self, :https, :data</code> to <code>img_src :self, :http, :data</code>. I totally missed that this whole time"}, {"owner": {"reputation": 2151, "user_id": 10068463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c3df811097b7fb8fef67238aad1151ca?s=128&d=identicon&r=PG&f=1", "display_name": "Nate", "link": "https://stackoverflow.com/users/10068463/nate"}, "reply_to_user": {"reputation": 555, "user_id": 3491653, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4a181bf47a17fe43bf62ff3778525bfa?s=128&d=identicon&r=PG&f=1", "display_name": "i_use_the_internet", "link": "https://stackoverflow.com/users/3491653/i-use-the-internet"}, "edited": false, "score": 2, "creation_date": 1545664856, "post_id": 53914983, "comment_id": 94673356, "body": "@i_use_the_internet, just make sure that you use https in production."}], "tags": [], "owner": {"reputation": 6039, "user_id": 2137458, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8cfca832ee746f3e3d9971148f52dc64?s=128&d=identicon&r=PG", "display_name": "NM Pennypacker", "link": "https://stackoverflow.com/users/2137458/nm-pennypacker"}, "is_accepted": true, "score": 1, "last_activity_date": 1545663994, "last_edit_date": 1545663994, "creation_date": 1545663662, "answer_id": 53914983, "question_id": 53914756, "link": "https://stackoverflow.com/questions/53914756/rails-5-2-1-images-on-view-not-showing-up-using-paperclip-with-aws-even-though-i/53914983#53914983", "title": "Rails 5.2.1 Images on View not showing up using Paperclip with AWS even though it displays the correct URL in src", "body": "<p>If you're running your site in <code>https</code>, you'll need to make sure that your S3 links are also served via <code>https</code> in order to avoid the <code>Content Security Policy error</code>. This answer should get you where you need to be in order to configure your image links to serve over <code>https</code>. <a href=\"https://stackoverflow.com/questions/7897710/is-it-possible-to-configure-paperclip-to-produce-https-urls\">Is it possible to configure Paperclip to produce HTTPS urls?</a></p>\n\n<p>The short answer is to use the <code>s3_protocol</code> option:</p>\n\n<p><code>s3_protocol: :https</code>, or in your case <code>s3_protocol: :http</code></p>\n\n<p><a href=\"https://www.rubydoc.info/github/thoughtbot/paperclip/master/Paperclip/Storage/S3\" rel=\"nofollow noreferrer\">https://www.rubydoc.info/github/thoughtbot/paperclip/master/Paperclip/Storage/S3</a></p>\n"}], "owner": {"reputation": 555, "user_id": 3491653, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4a181bf47a17fe43bf62ff3778525bfa?s=128&d=identicon&r=PG&f=1", "display_name": "i_use_the_internet", "link": "https://stackoverflow.com/users/3491653/i-use-the-internet"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 55, "favorite_count": 0, "accepted_answer_id": 53914983, "answer_count": 1, "score": 1, "last_activity_date": 1545663994, "creation_date": 1545662248, "last_edit_date": 1545663074, "question_id": 53914756, "link": "https://stackoverflow.com/questions/53914756/rails-5-2-1-images-on-view-not-showing-up-using-paperclip-with-aws-even-though-i", "title": "Rails 5.2.1 Images on View not showing up using Paperclip with AWS even though it displays the correct URL in src", "body": "<p>This might just be a simple, obvious fix, although I have read similar questions and attempted solutions, I can't seem to figure it out.</p>\n\n<p>I have a Post model which contains an image. When I upload the image, it successfully uploads to AWS but the post does not display it when I view that post. </p>\n\n<p>My S3 bucket policy has been set so everyone can view.</p>\n\n<p>I have my AWS Paperclip settings in my <code>config/environments/production.rb</code> file as:</p>\n\n<pre><code> [...]\n  config.paperclip_defaults = {\n    storage: :s3,\n    s3_credentials: {\n      bucket: Rails.application.credentials.dig(:aws, :bucket_name), \n      access_key_id: Rails.application.credentials.dig(:aws, :access_key_id), \n      secret_access_key: Rails.application.credentials.dig(:aws,\n      :secret_access_key), \n      s3_region: Rails.application.credentials.dig(:aws, :region),\n      s3_storage_class: :reduced_redundancy\n    }\n  }\n</code></pre>\n\n<p>Here is my Post model: </p>\n\n<pre><code>class Post &lt; ApplicationRecord\n    belongs_to :user\n    has_many :comments, dependent: :destroy\n    has_many :likes, dependent: :destroy\n    has_many :dislikes, dependent: :destroy\n    attr_accessor :uploaded_image_for_io_adapters, :file_name, :top_text, :bot_text\n\n\n    has_attached_file :image, styles: {   \n        square: \"250x250#\",\n        large:  \"500x550!\"\n    }, \n    :convert_options =&gt; {\n      :medium =&gt; \"-quality 100 -strip\"\n    }, \n    default_url: \"/images/:style/missing.png\"\n  validates_attachment_content_type :image, content_type: /\\Aimage\\/.*\\z/\n  validates_attachment :image, presence: true\n  validates_presence_of :poster\n    validates_presence_of :description\n    validates :user, presence: true\n    validates :user_id, presence: true\nend\n</code></pre>\n\n<p>My <code>app/views/posts/show.html.erb</code></p>\n\n<pre><code>&lt;div class=\"container\"&gt;\n  &lt;center&gt;&lt;table border=\"0\" style=\"max-width: 500px;\"&gt;\n    &lt;tr&gt;\n      &lt;td colspan=\"2\"&gt;&lt;%= image_tag @post.image.url(:large) %&gt;&lt;/td&gt;\n    &lt;/tr&gt;\n    &lt;tr&gt;\n      &lt;td colspan=\"2\"&gt;&lt;h3 class=\"text-left\"&gt;&lt;%= @post.description %&gt;&lt;/h3&gt;&lt;/td&gt;\n    &lt;/tr&gt;\n    &lt;tr valign=\"top\"&gt;\n      &lt;td&gt;\n    &lt;p&gt;Posted by: &lt;%= @post.poster %&gt;&lt;/p&gt;\n    &lt;p&gt;&lt;small class=\"text-muted\"&gt;&lt;%= @post.created_at %&gt;&lt;/small&gt;&lt;/p&gt;\n      &lt;/td&gt;\n      &lt;td&gt;&lt;p class=\"text-right\"&gt;\n        &lt;div class=\"voting\" style=\"text-align:center;\" id=\"voting-div\"&gt;\n            &lt;%= render partial: 'posts/likes', locals: {post: @post}  %&gt;\n            &lt;%= render partial: 'posts/dislikes', locals: {post: @post}  %&gt;\n            &lt;%= render partial: 'posts/post_score', locals: {post: @post}  %&gt;\n        &lt;/div&gt;\n      &lt;/p&gt;&lt;/td&gt;\n    &lt;/tr&gt;\n    &lt;tr&gt;\n      &lt;td colspan=\"2\"&gt;&lt;p&gt;&lt;a href=\"#\" class=\"glyphicon glyphicon-flag\"&gt; Flag as inappropriate&lt;/a&gt;&lt;/p&gt;&lt;/td&gt;\n    &lt;/tr&gt;\n  &lt;/table&gt;&lt;/center&gt;\n  &lt;%= link_to 'Back', url_for(:back) %&gt;\n&lt;/div&gt;\n</code></pre>\n\n<p>Here is the interesting part. On the post page where the image is not displayed, when I <code>View Page source</code>, I see under image source:\n<code>&lt;td colspan=\"2\"&gt;&lt;img src=\"//bucketname-images.s3.us-east-2.amazonaws.com/posts/images/000/000/016/large/_editedimage_.png?1545616391\"/&gt;&lt;/td&gt;</code> as in the screenshot<a href=\"https://i.stack.imgur.com/jnrrs.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/jnrrs.png\" alt=\"page source displaying image\"></a></p>\n\n<p>When I <code>Copy Link Location</code> and paste, the URL is <code>http://bucketname-images.s3.us-east-2.amazonaws.com/posts/images/000/000/016/large/_editedimage_.png?1545616391</code>. This URL displays the uploaded image on every computer I try which makes me suspect that the problem is coming from my view. I appreciate any pointers</p>\n\n<h2>EDIT</h2>\n\n<p>When I check the console I see the following error:</p>\n\n<blockquote>\n  <p>Content Security Policy: The page\u2019s settings blocked the loading of a\n  resource at\n  <a href=\"http://bucketname-images.s3.us-east-2.amazonaws.com/posts/images/000/000/016/square_editedimage_.png?1545616391\" rel=\"nofollow noreferrer\">http://bucketname-images.s3.us-east-2.amazonaws.com/posts/images/000/000/016/square_editedimage_.png?1545616391</a>\n  (\u201cimg-src\u201d).</p>\n</blockquote>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 3201, "user_id": 2892779, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uvM8S.jpg?s=128&g=1", "display_name": "Jay Dorsey", "link": "https://stackoverflow.com/users/2892779/jay-dorsey"}, "edited": false, "score": 0, "creation_date": 1545662842, "post_id": 53914545, "comment_id": 94672795, "body": "Does this error, or just not work? If it generates an error can you share details? Can you provide the view in your post also, and a sample of what the URL looks like in the browser after you click on the sort link (post search, the one that isn&#39;t linking)"}, {"owner": {"user_type": "does_not_exist", "display_name": "user10829318"}, "reply_to_user": {"reputation": 3201, "user_id": 2892779, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uvM8S.jpg?s=128&g=1", "display_name": "Jay Dorsey", "link": "https://stackoverflow.com/users/2892779/jay-dorsey"}, "edited": false, "score": 0, "creation_date": 1545663884, "post_id": 53914545, "comment_id": 94673112, "body": "Processing by TrucksController#index as JSON   Parameters: {&quot;page&quot;=&gt;&quot;1&quot;, &quot;sort_by&quot;=&gt;&quot;name&quot;, &quot;direction&quot;=&gt;&quot;asc&quot;, &quot;q&quot;=&gt;&quot;bmw&quot;} ...Completed 200 OK in 18ms (Views: 5.6ms | ActiveRecord: 3.2ms) It&#39;s API side."}], "owner": {"user_type": "does_not_exist", "display_name": "user10829318"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 32, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1545662259, "creation_date": 1545660974, "last_edit_date": 1545662259, "question_id": 53914545, "link": "https://stackoverflow.com/questions/53914545/pg-search-scope-not-sort-as-desc-or-asc", "title": "pg_search_scope not sort as desc or asc", "body": "<p>I have a little problem. And don't know how to fix it.</p>\n\n<p>I want that after filtering by pg_search_scope happens, I can sort by ascending and descending when clicked.\nIf I try sort without search, all works fine, but if I used a search(looks in if params[:q].present? at trucks_controller) it's not work :(</p>\n\n<h1>model/truck.rb</h1>\n\n<pre><code>class Truck &lt; ApplicationRecord\n  include PgSearch\n\n  pg_search_scope :search,\n              against: [:name],\n              using: {\n                tsearch: {\n                  prefix: true,\n                  any_word: true\n                }\n              }\n\n #Associations\n  belongs_to :company\n  has_many :crews\n\n  #Validations\n  validates_presence_of :name, :company\n  validates_uniqueness_of :name, scope: [:company]\nend\n</code></pre>\n\n<h1>trucks_controller.rb</h1>\n\n<pre><code>class TrucksController &lt; ApplicationController\n  before_action :load_truck, only: [:update, :destroy, :show]\n  before_action :load_search_trucks, only: :index\n\n  def index\n    paginate json: @trucks, status: :ok, per_page: 10\n  end\n\n  private\n\n  def load_search_trucks\n    if params[:q].present?\n      @trucks = current_company.trucks.search(params[:q]).order_by(params[:sort_by], params[:direction])\n    else\n      @trucks = current_company.trucks.order_by(params[:sort_by], params[:direction])\n    end\n  end\nend\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "wicked-pdf"], "answers": [{"tags": [], "owner": {"reputation": 5935, "user_id": 365860, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/PPe6C.jpg?s=128&g=1", "display_name": "Nezir", "link": "https://stackoverflow.com/users/365860/nezir"}, "is_accepted": false, "score": 0, "last_activity_date": 1545662392, "creation_date": 1545662392, "answer_id": 53914779, "question_id": 53914333, "link": "https://stackoverflow.com/questions/53914333/wicked-pdf-error-pdf-could-not-be-generated-command-error-fatal-expect-3-arg/53914779#53914779", "title": "Wicked_pdf Error: PDF could not be generated! Command Error: FATAL: expect 3 arguments and got: 5", "body": "<p>So,  finally I managed to fix this issue by <code>commenting out</code> the whole content of initialize <code>wicked_pdf.rb</code> file.\nAnd adding to a project <code>gem 'wkhtmltopdf-binary'</code>. So now adding  more arguments to respond_to block works well.</p>\n"}], "owner": {"reputation": 5935, "user_id": 365860, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/PPe6C.jpg?s=128&g=1", "display_name": "Nezir", "link": "https://stackoverflow.com/users/365860/nezir"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 432, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1545662392, "creation_date": 1545659650, "question_id": 53914333, "link": "https://stackoverflow.com/questions/53914333/wicked-pdf-error-pdf-could-not-be-generated-command-error-fatal-expect-3-arg", "title": "Wicked_pdf Error: PDF could not be generated! Command Error: FATAL: expect 3 arguments and got: 5", "body": "<p>Hi I am really pissed of with this gem.</p>\n\n<p>I have a controller action with regular respond block:</p>\n\n<pre><code>respond_to do |format|\n  format.html\n  format.pdf do\n    render pdf: \"Print\",\n    template: \"claims/print.html.erb\"\n    layout: \"print_claim.pdf\"\n  end\nend\n</code></pre>\n\n<p>and this works well, however, now I need to use different page size for some specific pdf like envelop.  So i am trying to add the next values to wicked_pdf.config in initialize folder or here in respond_to block like:</p>\n\n<pre><code>respond_to do |format|\n  format.html\n  format.pdf do\n    render pdf: \"Print\",\n    template: \"claims/print.html.erb\"\n    layout: \"print_claim.pdf\",\n    page_size: 'Letter',\n    page_width: '10in',\n    page_height: '6in'\n\n  end\nend\n</code></pre>\n\n<p>or in initialize file like:</p>\n\n<pre><code>WickedPdf.config = {\n  page_size: 'Letter',\n  page_height: '10in',\n  page_width: '10in', \n  exe_path: File.join(Rails.root,\"bin\",\"wkhtmltopdf-to-chrome\")\n}\n</code></pre>\n\n<p>but this returns me error like:</p>\n\n<pre><code>Failed to execute: [\"/bin/wkhtmltopdf-to-chrome\", \"-q\", \"--page-size\", \"A6\", \"file:////tmp/wicked_pdf20181224-5644-m4s0rw.html\", \"/tmp/wicked_pdf_generated_file20181224-5644-3t6s75.pdf\"] Error: PDF could not be generated! Command Error: FATAL: expect 3 arguments and got: 5\n</code></pre>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 1725, "user_id": 4738391, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/nCUGI.jpg?s=128&g=1", "display_name": "Zia Ul Rehman Mughal", "link": "https://stackoverflow.com/users/4738391/zia-ul-rehman-mughal"}, "edited": false, "score": 0, "creation_date": 1545654996, "post_id": 53913532, "comment_id": 94670436, "body": "I think you have multiple type of memory refs in string and want to remove them, please confirm. If so i think you can use some kind of regex and i can help you build that."}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1545655078, "post_id": 53913532, "comment_id": 94670460, "body": "What is the exact input? What is the desired output? What have you tried?"}, {"owner": {"reputation": 3705, "user_id": 8551976, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oxgdN.jpg?s=128&g=1", "display_name": "asimhashmi", "link": "https://stackoverflow.com/users/8551976/asimhashmi"}, "edited": false, "score": 1, "creation_date": 1545655120, "post_id": 53913532, "comment_id": 94670471, "body": "Yeah, there can be multiple memory references"}, {"owner": {"reputation": 3705, "user_id": 8551976, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oxgdN.jpg?s=128&g=1", "display_name": "asimhashmi", "link": "https://stackoverflow.com/users/8551976/asimhashmi"}, "reply_to_user": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1545655576, "post_id": 53913532, "comment_id": 94670608, "body": "@AlekseiMatiushkin as mentioned in question, input are string. I want to replace these refs with SOMETHING. And i am still thinking what to try"}], "answers": [{"comments": [{"owner": {"reputation": 3705, "user_id": 8551976, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oxgdN.jpg?s=128&g=1", "display_name": "asimhashmi", "link": "https://stackoverflow.com/users/8551976/asimhashmi"}, "edited": false, "score": 0, "creation_date": 1545655712, "post_id": 53913593, "comment_id": 94670651, "body": "Hmm, sounds good. Will try and update here"}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1545656190, "post_id": 53913593, "comment_id": 94670791, "body": "<code>[A-Z]</code>? Radix <code>36</code>?"}, {"owner": {"reputation": 4739, "user_id": 5403468, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZJ8BE.jpg?s=128&g=1", "display_name": "Tiw", "link": "https://stackoverflow.com/users/5403468/tiw"}, "edited": false, "score": 1, "creation_date": 1545658267, "post_id": 53913593, "comment_id": 94671437, "body": "Fyi: 0x means following are hex number, there won&#39;t be other <code>nx</code> prefix."}, {"owner": {"reputation": 1725, "user_id": 4738391, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/nCUGI.jpg?s=128&g=1", "display_name": "Zia Ul Rehman Mughal", "link": "https://stackoverflow.com/users/4738391/zia-ul-rehman-mughal"}, "reply_to_user": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1545671006, "post_id": 53913593, "comment_id": 94674923, "body": "@AlekseiMatiushkin didn&#39;t get your point. Can you elaborate"}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1545671116, "post_id": 53913593, "comment_id": 94674952, "body": "<code>0x00007f98f03c84e0</code> is a memory pointer, the hexadecimal number, radix 16. It can be effectively matched with <code>&#47;0x[\\da-f]{16}&#47;</code>, or, to support different memory models, with <code>&#47;0x[\\da-f]{8,}(?=&gt;)&#47;</code>."}, {"owner": {"reputation": 1725, "user_id": 4738391, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/nCUGI.jpg?s=128&g=1", "display_name": "Zia Ul Rehman Mughal", "link": "https://stackoverflow.com/users/4738391/zia-ul-rehman-mughal"}, "reply_to_user": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1545673500, "post_id": 53913593, "comment_id": 94675504, "body": "@AlekseiMatiushkin nice, you can suggest an edit in my question or if you want to post new answer. I just threw whatever i could think of and it worked, but yours is optimal i agree"}], "tags": [], "owner": {"reputation": 1725, "user_id": 4738391, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/nCUGI.jpg?s=128&g=1", "display_name": "Zia Ul Rehman Mughal", "link": "https://stackoverflow.com/users/4738391/zia-ul-rehman-mughal"}, "is_accepted": true, "score": 2, "last_activity_date": 1545655220, "creation_date": 1545655220, "answer_id": 53913593, "question_id": 53913532, "link": "https://stackoverflow.com/questions/53913532/replacing-memory-references-addresses-from-a-string-containing-classnamemem-re/53913593#53913593", "title": "Replacing memory references/addresses from a string containing &lt;ClassName:MEM_REF&gt; type parts", "body": "<p>Try following regex in ruby console, should work: <code>/:[0-9]x[0-9A-Za-z]*(?=&gt;)/</code>.</p>\n\n<p>And to mask these refs with anything else, try <code>input_string.gsub!(/:[0-9]x[0-9A-Za-z]*(?=&gt;)/, \"REPLACE_TEXT\")</code></p>\n"}], "owner": {"reputation": 3705, "user_id": 8551976, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oxgdN.jpg?s=128&g=1", "display_name": "asimhashmi", "link": "https://stackoverflow.com/users/8551976/asimhashmi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 83, "favorite_count": 1, "closed_date": 1545697170, "accepted_answer_id": 53913593, "answer_count": 1, "score": -4, "last_activity_date": 1558647538, "creation_date": 1545654823, "last_edit_date": 1558647538, "question_id": 53913532, "link": "https://stackoverflow.com/questions/53913532/replacing-memory-references-addresses-from-a-string-containing-classnamemem-re", "closed_reason": "Needs details or clarity", "title": "Replacing memory references/addresses from a string containing &lt;ClassName:MEM_REF&gt; type parts", "body": "<p>I have strings like:</p>\n\n<p><code>NoMethodError: undefined method 'sort_by!' for #&lt;Hash:0x00007f98f03c84e0&gt;</code></p>\n\n<p>These strings <strong>can</strong> contain n number of such parts: <code>&lt;Hash:0x00007f98f03c84e0&gt;</code>. </p>\n\n<p>Here, <strong><code>0x00007f98f03c84e0</code> is just a placeholder of memory reference. And also <code>Hash</code> is type of object of which this memory reference is.</strong> There is no need to discuss how these strings got formed but in the end i have strings which can have anything like <code>&lt;ClassName:MEM_REF&gt;</code> and i have to replace <code>MEM_REF</code> part.</p>\n\n<p>Going back to my original example, I want to remove this memory ref part  <code>0x00007f98f03c84e0</code> with any string of my liking. Again, <code>0x00007f98f03c84e0</code> is an example, it will be any arbitrary memory address.</p>\n\n<p>Looking for an elegant way of doing this in ruby.</p>\n"}, {"tags": ["javascript", "jquery", "ruby-on-rails", "ruby", "rubygems"], "comments": [{"owner": {"reputation": 38307, "user_id": 2057388, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ceef8c04f66cd0e2bd360ef6abc14a81?s=128&d=identicon&r=PG", "display_name": "\u0417\u0435\u043b\u0451\u043d\u044b\u0439", "link": "https://stackoverflow.com/users/2057388/%d0%97%d0%b5%d0%bb%d1%91%d0%bd%d1%8b%d0%b9"}, "edited": false, "score": 1, "creation_date": 1545648483, "post_id": 53911936, "comment_id": 94668465, "body": "It is not a comment, it is requre statement."}], "answers": [{"tags": [], "owner": {"reputation": 16396, "user_id": 2564298, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/BhG1x.jpg?s=128&g=1", "display_name": "Rajdeep Singh", "link": "https://stackoverflow.com/users/2564298/rajdeep-singh"}, "is_accepted": false, "score": 1, "last_activity_date": 1545668494, "last_edit_date": 1545668494, "creation_date": 1545648988, "answer_id": 53912488, "question_id": 53911936, "link": "https://stackoverflow.com/questions/53911936/how-uncommenting-jquery-results-in-working-of-rails-server/53912488#53912488", "title": "How uncommenting jquery results in working of rails server?", "body": "<p><code>//</code> is a comment but <code>//=</code> is not, <code>//= require jquery</code> includes the <code>jquery</code> library.</p>\n\n<p>More info here - <a href=\"https://guides.rubyonrails.org/asset_pipeline.html#search-paths\" rel=\"nofollow noreferrer\">https://guides.rubyonrails.org/asset_pipeline.html#search-paths</a></p>\n"}], "owner": {"reputation": 25, "user_id": 10828349, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7458d3d94a99624608e2c81f004ba9e5?s=128&d=identicon&r=PG&f=1", "display_name": "Venkat", "link": "https://stackoverflow.com/users/10828349/venkat"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 176, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1545668494, "creation_date": 1545645932, "question_id": 53911936, "link": "https://stackoverflow.com/questions/53911936/how-uncommenting-jquery-results-in-working-of-rails-server", "title": "How uncommenting jquery results in working of rails server?", "body": "<p>I created a new rails controller $ bin/rails generate controller welcome index\nModified my View <h1>Hello, Rails!</h1>\nwhen I restarted my rails server, I faced the below issue.</p>\n\n<pre><code>Sprockets::FileNotFound in Welcome#index\nShowing /home/venkata/Downloads/app/app/views/layouts/application.html.erb where line #5 raised:\ncouldn't find file 'jquery' with type 'application/javascript'\nChecked in these paths: \n  /home/venkata/Downloads/app/app/assets/images\n  /home/venkata/Downloads/app/app/assets/javascripts\n  /home/venkata/Downloads/app/app/assets/stylesheets\n  /home/venkata/Downloads/app/vendor/assets/javascripts\n  /home/venkata/Downloads/app/vendor/assets/stylesheets\nExtracted source (around line #13):\n11\n12\n13\n14\n15\n16\n// about supported directives.\n//\n//= require jquery\n//= require jquery_ujs\n//= require turbolinks\n//= require_tree .\nRails.root: /home/venkata/Downloads/app\n</code></pre>\n\n<p><strong>Now when I uncomment the =require jquery in app/assets/javascripts</strong> and restarted the server, got the expected output. wondering How this happens by uncommenting that particular line?</p>\n"}, {"tags": ["ruby", "ruby-on-rails-4", "rails-activerecord", "delayed-job"], "comments": [{"owner": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "edited": false, "score": 0, "creation_date": 1545651120, "post_id": 53911773, "comment_id": 94669291, "body": "You already answered your own question. A worker runs as a separate process and in a production environment, often multi-threaded instances of your workers.  So you will need to pass simple references to objects. Best to pass strings only, but you can pass a changes params hash.  See posted answer."}], "answers": [{"comments": [{"owner": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "edited": false, "score": 0, "creation_date": 1545653874, "post_id": 53912810, "comment_id": 94670089, "body": "Updated 1st argument to pass the class name as a string correctly."}], "tags": [], "owner": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "is_accepted": true, "score": 0, "last_activity_date": 1545653853, "last_edit_date": 1545653853, "creation_date": 1545650675, "answer_id": 53912810, "question_id": 53911773, "link": "https://stackoverflow.com/questions/53911773/is-it-possible-to-preserve-tracked-changes-in-model-passed-to-a-delayed-job/53912810#53912810", "title": "Is it possible to preserve tracked changes in model passed to a delayed job?", "body": "<p>Never send model objects to workers, just send id's. You will need to pass the changes hash. The worker won't be able to preserve the changes created by the object instance. So yes, you'll need to pass the changes to your worker.</p>\n\n<pre><code>class MyModel &lt; ActiveRecord::Base\n  after_save :perform_async_job\n\n  def perform_async_job\n    # Here, \"self.changes\" contains the changes\n    Delayed::Job.enqeue(AsyncJobPerformer.new(self.class.name, self.id, self.changes), ...)\n  end\nend\n\nclass AsyncJobPerformer\n  def initialize(model_name, model_id, params)\n    changes = params\n    @model = model_name.constantize.find(model_id)\n    #handle changes here with @model.update(changes) or a seperate method if need.\n  end\n\n  def perform\n    # Here, \"@model.changes\" is empty\n  end\nend\n</code></pre>\n"}], "owner": {"reputation": 457, "user_id": 2883956, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/487c480f4e9b9f386089f66d281997ee?s=128&d=identicon&r=PG&f=1", "display_name": "Johan Hirsch", "link": "https://stackoverflow.com/users/2883956/johan-hirsch"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 25, "favorite_count": 0, "accepted_answer_id": 53912810, "answer_count": 1, "score": 0, "last_activity_date": 1545653853, "creation_date": 1545645015, "question_id": 53911773, "link": "https://stackoverflow.com/questions/53911773/is-it-possible-to-preserve-tracked-changes-in-model-passed-to-a-delayed-job", "title": "Is it possible to preserve tracked changes in model passed to a delayed job?", "body": "<p>I wish to perform some expensive operation when my model changes, so I do it asynchronously in a delayed job. Inside this job, I need to be able to tell what exactly the changes were, so I'm passing my changed model as a parameter to the delayed job.</p>\n\n<p>Now, it seems that delayed-job fetches a new (pristine) version of the model from the database when the job starts running, which does not have the tracked changes that I need.  </p>\n\n<pre><code>class MyModel &lt; ActiveRecord::Base\n    after_save :perform_async_job\n\n    def perform_async_job\n        # Here, \"self.changes\" contains the changes\n        Delayed::Job.enqeue(AsyncJobPerformer.new(self), ...)\n    end\nend\n\nclass AsyncJobPerformer\n    def initialize(model)\n        @model = model\n    end\n\n    def perform\n        # Here, \"@model.changes\" is empty\n    end\nend\n</code></pre>\n\n<p>I can, of course, pass just the <code>changes</code> hash, and not the model itself, but it would make the delayed job code much more complex, as it needs to use the model instance anyway (so I'll need to fetch it and use both the model and the changes as separate objects).</p>\n\n<p>Is there some way to pass the model to the delayed job while preserving the tracked changes?</p>\n"}, {"tags": ["ruby", "gtk3", "cairo"], "answers": [{"comments": [{"owner": {"reputation": 806, "user_id": 5700094, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/22f13f4051e545c917d53ca127a8d3d8?s=128&d=identicon&r=PG&f=1", "display_name": "Chris K", "link": "https://stackoverflow.com/users/5700094/chris-k"}, "edited": false, "score": 1, "creation_date": 1554391772, "post_id": 53911608, "comment_id": 97744082, "body": "If someone (like me) wants to know: in the C API this is the function <code>cairo_new_path</code> listed in the documentation for paths not context."}], "tags": [], "owner": {"reputation": 9435, "user_id": 2626000, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/j8GY0.jpg?s=128&g=1", "display_name": "Aaron Christiansen", "link": "https://stackoverflow.com/users/2626000/aaron-christiansen"}, "is_accepted": true, "score": 1, "last_activity_date": 1545644197, "creation_date": 1545644197, "answer_id": 53911608, "question_id": 53911575, "link": "https://stackoverflow.com/questions/53911575/clear-the-current-path-in-cairo/53911608#53911608", "title": "Clear the current path in Cairo", "body": "<p>I had a look over <code>Cairo::Context#methods</code> and found <code>#new_path</code>, which does just what I'm after. So you can do:</p>\n\n<pre><code>rectangle_data.each do |rectangle_datum|\n    context.rectangle(*rectangle_datum.rectangle)\n    fill_data.each do |fill_datum|\n        context.set_source_rgba(*fill_datum.color)\n        context.fill_preserve\n    end\n    context.new_path\nend\n</code></pre>\n"}], "owner": {"reputation": 9435, "user_id": 2626000, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/j8GY0.jpg?s=128&g=1", "display_name": "Aaron Christiansen", "link": "https://stackoverflow.com/users/2626000/aaron-christiansen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 237, "favorite_count": 0, "accepted_answer_id": 53911608, "answer_count": 1, "score": 1, "last_activity_date": 1545644197, "creation_date": 1545643965, "question_id": 53911575, "link": "https://stackoverflow.com/questions/53911575/clear-the-current-path-in-cairo", "title": "Clear the current path in Cairo", "body": "<p>In some Ruby code which uses Cairo, I need to draw a number of fills over a single path. This is part of a graphics application, where multiple fills may be stacked on top of each other using different blend modes.</p>\n\n<p>Each fill is drawn using <code>fill_preserve</code> to preserve the path so that the next fill can occur over the same path without retracing it. This is done somewhat like so:</p>\n\n<pre><code>rectangle_data.each do |rectangle_datum|\n    context.rectangle(*rectangle_datum.rectangle)\n    fill_data.each do |fill_datum|\n        context.set_source_rgba(*fill_datum.color)\n        context.fill_preserve\n    end\nend\n</code></pre>\n\n<p>The problem is that this leaves the path even after all fills have taken place, which means that individual shapes are just drawn as one huge filled shape.</p>\n\n<p>To solve this, I'd simply need to clear the current path manually, but I can't figure out how to do this. I've had a look through the documentation for <code>Cairo::Context</code> through Google Translate but I can't find it. (The docs are in Japanese!) </p>\n\n<p>How can I manually clear a Cairo context's current path?</p>\n"}, {"tags": ["ruby", "selenium", "rspec", "capybara"], "answers": [{"tags": [], "owner": {"reputation": 2301, "user_id": 19317, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/47035e07012da3162b6e83650ee3abe0?s=128&d=identicon&r=PG", "display_name": "aridlehoover", "link": "https://stackoverflow.com/users/19317/aridlehoover"}, "is_accepted": true, "score": 3, "last_activity_date": 1551082486, "last_edit_date": 1592644375, "creation_date": 1545644803, "answer_id": 53911729, "question_id": 53910753, "link": "https://stackoverflow.com/questions/53910753/verify-text-of-a-particular-css-value-using-capybara-selenium/53911729#53911729", "title": "Verify text of a particular css value using capybara + selenium", "body": "<p>From the Capybara repo: <a href=\"https://github.com/teamcapybara/capybara#using-capybara-with-rspec\" rel=\"nofollow noreferrer\">https://github.com/teamcapybara/capybara#using-capybara-with-rspec</a></p>\n<blockquote>\n<p>...Capybara matchers are also supported in view specs:</p>\n<pre><code>RSpec.describe &quot;todos/show.html.erb&quot;, type: :view do\n  it &quot;displays the todo title&quot; do\n    assign :todo, Todo.new(title: &quot;Buy milk&quot;)\n    render\n\n    expect(rendered).to have_css(&quot;header h1&quot;, text: &quot;Buy milk&quot;)\n  end\nend\n</code></pre>\n</blockquote>\n<p>Given your HTML, try this:</p>\n<pre><code>expect(rendered).to have_css(\n  'td[data-role=&quot;Company Name&quot;]', text: 'ABC Constructions'\n)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 42014, "user_id": 2709090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/238c2b7cde2c817fc9a5a2b8eaa2ffad?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Walpole", "link": "https://stackoverflow.com/users/2709090/thomas-walpole"}, "is_accepted": false, "score": 2, "last_activity_date": 1545683329, "creation_date": 1545683329, "answer_id": 53917449, "question_id": 53910753, "link": "https://stackoverflow.com/questions/53910753/verify-text-of-a-particular-css-value-using-capybara-selenium/53917449#53917449", "title": "Verify text of a particular css value using capybara + selenium", "body": "<p>If you're trying to do it in a view spec then the answer by aridlehoover would be correct.  Howver, in a feature/system spec (where you would normally be using selenium with capybara) then it would be</p>\n\n<pre><code>expect(page).to have_css('td[data-role=\"Company Name\"]', text: 'ABC Constructions')\n</code></pre>\n\n<p>Note that that the text option will (by default) match substrings (contains rather than equals) so it would also match on an element that had the text contents of 'ABC Constructions Company'.  If you want to exactly match 'ABC Constructions' then you can do</p>\n\n<pre><code>expect(page).to have_css('td[data-role=\"Company Name\"]', text: 'ABC Constructions', exact_text: true)\n</code></pre>\n\n<p>or more succinctly</p>\n\n<pre><code>expect(page).to have_css('td[data-role=\"Company Name\"]', exact_text: 'ABC Constructions')\n</code></pre>\n"}], "owner": {"reputation": 51, "user_id": 8949092, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DDSRj.jpg?s=128&g=1", "display_name": "S.Kalra", "link": "https://stackoverflow.com/users/8949092/s-kalra"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 98, "favorite_count": 1, "accepted_answer_id": 53911729, "answer_count": 2, "score": -2, "last_activity_date": 1551082486, "creation_date": 1545638578, "question_id": 53910753, "link": "https://stackoverflow.com/questions/53910753/verify-text-of-a-particular-css-value-using-capybara-selenium", "title": "Verify text of a particular css value using capybara + selenium", "body": "<p>I'm to verify the text of a particular css value.</p>\n\n<p>HTML is as - </p>\n\n<pre><code>    &lt;table class=\"resp_card_table company-dashboard\"&gt;\n     &lt;thead&gt;...&lt;/thead&gt;\n     &lt;tbody&gt;\n      &lt;tr ng-repeat=\"company in company | filter:searchString\" class=\"ng-scope\"&gt;\n       &lt;td data-label=\"Company Name\" class=\"ng-binding\"&gt;ABC Constructions&lt;/td&gt;\n      &lt;/tr&gt;\n     &lt;/tbody&gt;\n    &lt;/table&gt;\n</code></pre>\n\n<p>I'm to verify \"Company Name\" to have text \"ABC Constructions\"</p>\n\n<p>How can I do this using expect statement?</p>\n"}, {"tags": ["ruby", "active-directory", "ruby-2.1", "netldap"], "comments": [{"owner": {"reputation": 6462, "user_id": 3784008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/55ou4.jpg?s=128&g=1", "display_name": "anothermh", "link": "https://stackoverflow.com/users/3784008/anothermh"}, "edited": false, "score": 0, "creation_date": 1545634741, "post_id": 53909726, "comment_id": 94664582, "body": "Did <a href=\"https://stackoverflow.com/a/53891350/3784008\">my answer</a> the other day on your substantially similar question not give you means to determine this?"}], "answers": [{"tags": [], "owner": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "is_accepted": false, "score": 0, "last_activity_date": 1545655723, "last_edit_date": 1545655723, "creation_date": 1545653717, "answer_id": 53913335, "question_id": 53909726, "link": "https://stackoverflow.com/questions/53909726/is-there-a-way-to-print-the-exact-command-being-sent-to-ldap-server-by-ruby-net/53913335#53913335", "title": "Is there a way to print the exact command being sent to LDAP server by ruby-net-ldap?", "body": "<p>My guess is that your attribute string is not being escaped properly. Perhaps try using single quotes and pass the exact string of the names. But do you need <code>//</code> ?</p>\n\n<p>If you just do:</p>\n\n<pre><code>puts \"CN=TestAMS\\\\,Henry,OU=Flemington,OU=NJ Region 4,OU=Agents,DC=nj,DC=tri,DC=nrt\"\n</code></pre>\n\n<p>it will output:</p>\n\n<pre><code>CN=TestAMS\\,Henry,OU=Flemington,OU=NJ Region 4,OU=Agents,DC=nj,DC=tri,DC=nrt\n</code></pre>\n\n<p>So you may wanna get rid of the <code>\\</code> or if that's valid, to the target object you're string to rename, then leave it. In ruby you should only use double quotes when you need string interpolation.</p>\n\n<pre><code>@net_ldap.rename(\n  olddn:'CN=TestAMS,Henry,OU=Flemington,OU=NJ Region 4,OU=Agents,DC=nj,DC=tri,DC=nrt',\n  newrdn:'CN=TestAMS,Henry',\n  delete_attributes:true,\n  new_superior:'OU=Terminated Accounts,OU=No Sync,DC=nj,DC=tri,DC=nrt'\n)\n</code></pre>\n\n<p>But I'm not sure if LDAP allows hashes or slashes as attributes.</p>\n\n<p>UPDATE: ruby net/ldap is just a ruby implementation but from your terminal see:</p>\n\n<pre><code>man ldap\n#/name to search for name and we find:\n\n# Distinguished  names  (DN)  (and relative distinguished names (RDN) to be passed to the LDAP routines should conform to\n   RFC 4514 UTF-8 string representation.\n</code></pre>\n\n<p>So for more info see <a href=\"https://datatracker.ietf.org/doc/rfc4514/\" rel=\"nofollow noreferrer\">https://datatracker.ietf.org/doc/rfc4514/</a></p>\n\n<p>From the looks of this get rid of backslashes and hashtags which I did in my example. But also for more details of which strings need to be escaped, see <a href=\"https://ldap.com/ldap-dns-and-rdns/\" rel=\"nofollow noreferrer\">https://ldap.com/ldap-dns-and-rdns/</a></p>\n"}], "owner": {"reputation": 1690, "user_id": 2620860, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/vPUTw.png?s=128&g=1", "display_name": "Rayhan Muktader", "link": "https://stackoverflow.com/users/2620860/rayhan-muktader"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 35, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1545655723, "creation_date": 1545631318, "question_id": 53909726, "link": "https://stackoverflow.com/questions/53909726/is-there-a-way-to-print-the-exact-command-being-sent-to-ldap-server-by-ruby-net", "title": "Is there a way to print the exact command being sent to LDAP server by ruby-net-ldap?", "body": "<p>The following code to move an account to another OU is failing:</p>\n\n<pre><code>@net_ldap.rename(\n  olddn:\"CN=TestAMS\\\\,Henry,OU=Flemington,OU=NJ Region 4,OU=Agents,DC=nj,DC=tri,DC=nrt\",\n  newrdn:\"CN=#TestAMS,Henry\",\n  delete_attributes:true,\n  new_superior:\"OU=Terminated Accounts,OU=No Sync,DC=nj,DC=tri,DC=nrt\"\n)\n</code></pre>\n\n<p>I am getting the following error:</p>\n\n<pre><code>#&lt;OpenStruct code=64, error_message=\"00000057: LdapErr: DSID-0C090B07, comment: Error in attribute conversion operation, data 0, v1db1\\x00\", matched_dn=\"\", message=\"Naming Violation\"&gt;\n</code></pre>\n\n<p>Is there a way to print out the actual command that is being sent to the LDAP server so I can debug the issue? </p>\n"}, {"tags": ["ruby", "each", "ternary-operator", "collect"], "comments": [{"owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 0, "creation_date": 1545639232, "post_id": 53909400, "comment_id": 94665722, "body": "Why do you want to add a <code>&quot;s&quot;</code> to these words? And why do you want to skip the second word on the list? This feels like a xy problem to me. Do you aim to pluralize the words? And did you realize the there is not &quot;feets&quot;? Please elaborate on this. Because the rule for pluralization are more complex, what if you had words like &quot;octopus&quot; or &quot;person&quot; in the list?"}, {"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 1, "creation_date": 1545728950, "post_id": 53909400, "comment_id": 94683900, "body": "Can you explain why you need to do this in 1 line? By the way, this is absolutely trivial, since linebreaks are optional in Ruby. Just take your 9 lines of code and remove the linebreaks, then you have 1 line of code."}], "answers": [{"tags": [], "owner": {"reputation": 4739, "user_id": 5403468, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZJ8BE.jpg?s=128&g=1", "display_name": "Tiw", "link": "https://stackoverflow.com/users/5403468/tiw"}, "is_accepted": false, "score": 1, "last_activity_date": 1545643216, "last_edit_date": 1545643216, "creation_date": 1545628963, "answer_id": 53909439, "question_id": 53909400, "link": "https://stackoverflow.com/questions/53909400/add-s-to-the-end-of-each-word-in-an-array-except-for-the-2nd-element-in-the-gi/53909439#53909439", "title": "Add &quot;s&quot; to the end of each word in an array except for the 2nd element in the given array, only using one line of code", "body": "<pre><code>[\"hand\", \"feet\", \"knee\", \"table\"].map.with_index{|v,i| i==1 ? v : v + 's'}\n#=&gt; [\"hands\", \"feet\", \"knees\", \"tables\"]\n</code></pre>\n\n<p><code>map.with_index</code> helps.<br>\nBasically <code>map.with_index</code> equals to <code>each_with_index.collect</code>.<br>\n<code>each</code> with <code>collect</code>(same as <code>map</code>) is superfluous.</p>\n\n<p>If you want to mutate original array, you can change <code>+</code> to <code>&lt;&lt;</code>, but not recommended.</p>\n"}, {"tags": [], "owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "is_accepted": true, "score": 4, "last_activity_date": 1545638153, "last_edit_date": 1545638153, "creation_date": 1545630316, "answer_id": 53909600, "question_id": 53909400, "link": "https://stackoverflow.com/questions/53909400/add-s-to-the-end-of-each-word-in-an-array-except-for-the-2nd-element-in-the-gi/53909600#53909600", "title": "Add &quot;s&quot; to the end of each word in an array except for the 2nd element in the given array, only using one line of code", "body": "<p>You should clearly distinguish methods <em>mutating</em> the receiver (the variable they are called on) vs <em>pure</em> methods having no side effects. Also, you should care about what the method returns if you are to use the result of the method.</p>\n\n<p>Here the method for all indices (but <code>1</code>) returns <code>\"s\"</code> because it is what the block returns:</p>\n\n<pre><code>foo = \"bar\"\nfoo[foo.length] = \"s\"\n#\u21d2 \"s\"\n</code></pre>\n\n<p>If you\u2019ll check your <em>mutated</em> array afterward, you\u2019ll see it was successfully modified to what you wanted.</p>\n\n<pre><code>input = %w[hand feet knee table]\ndef add_s(input)\n  input.each_with_index.map do |element, index|\n    index == 1 ? element : element[element.length] = \"s\"\n  end\n  input # \u21d0 HERE :: return the mutated object\nend\n#\u21d2 [\"hands\", \"feet\", \"knees\", \"tables\"]\n</code></pre>\n\n<p>or even easier, do not <em>map</em>, just iterate and mutate:</p>\n\n<pre><code>input = %w[hand feet knee table]\ndef add_s(input)\n  input.each_with_index do |element, index|\n    element[element.length] = \"s\" unless index == 1\n  end\nend\n</code></pre>\n\n<hr>\n\n<p>Instead of mutating the array inplace, the preferred solution would be to return a modified version. For that you should <em>return</em> new values from a block:</p>\n\n<pre><code>def add_s(input)\n  input.each_with_index.map do |element, index|\n    index == 1 ? element : element + \"s\"\n  end\nend\n#\u21d2 [\"hands\", \"feet\", \"knees\", \"tables\"]\n</code></pre>\n\n<hr>\n\n<p>If I were given such a task, I would maintain a list of elements to be skipped as well since sooner or later there will be more than one:</p>\n\n<pre><code>input = %w[hand feet knee scissors table]\nto_skip = [1, 3]\ndef add_s(input)\n  input.each_with_index.map do |element, index|\n    next element if to_skip.include?(index)\n    element + \"s\"\n  end\nend\n#\u21d2 [\"hands\", \"feet\", \"knees\", \"scissors\", \"tables\"]\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1545638223, "post_id": 53909773, "comment_id": 94665462, "body": "There is no <code>active_support</code> in Ruby core."}, {"owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 1, "creation_date": 1545639021, "post_id": 53909773, "comment_id": 94665661, "body": "ActiveSupport&#39;s <a href=\"https://www.rubydoc.info/gems/activesupport/String:pluralize\" rel=\"nofollow noreferrer\">pluralize method</a> does not simply add a <code>&quot;s&quot;</code> to the end of a string."}], "tags": [], "owner": {"reputation": 802, "user_id": 8728218, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/376ec53188ea3ec0271198a862516657?s=128&d=identicon&r=PG&f=1", "display_name": "Dyaniyal Wilson", "link": "https://stackoverflow.com/users/8728218/dyaniyal-wilson"}, "is_accepted": false, "score": -2, "last_activity_date": 1545631631, "creation_date": 1545631631, "answer_id": 53909773, "question_id": 53909400, "link": "https://stackoverflow.com/questions/53909400/add-s-to-the-end-of-each-word-in-an-array-except-for-the-2nd-element-in-the-gi/53909773#53909773", "title": "Add &quot;s&quot; to the end of each word in an array except for the 2nd element in the given array, only using one line of code", "body": "<p>It's easy to achieve this using 'active_support'</p>\n\n<pre><code>arr = [\"hand\", \"feet\", \"knee\", \"table\"]\n\n2.0.0-p648 :023 &gt; require 'active_support/inflector'\n =&gt; true\n\narr.map { |a| arr.index(a) == 1 ? a : a.pluralize }\n =&gt; [\"hands\", \"feet\", \"knees\", \"tables\"]\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 5060, "user_id": 10522579, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7GQ6a.jpg?s=128&g=1", "display_name": "ray", "link": "https://stackoverflow.com/users/10522579/ray"}, "is_accepted": false, "score": 0, "last_activity_date": 1545643981, "creation_date": 1545643981, "answer_id": 53911580, "question_id": 53909400, "link": "https://stackoverflow.com/questions/53909400/add-s-to-the-end-of-each-word-in-an-array-except-for-the-2nd-element-in-the-gi/53911580#53911580", "title": "Add &quot;s&quot; to the end of each word in an array except for the 2nd element in the given array, only using one line of code", "body": "<p>I suggest following to achieve as per provided words,</p>\n\n<pre><code>arr = ['apple', 'knee', 'crab', 'jails']\narr.each_with_index.map { |x,i| i == 1  ? x : x + 's' }\n=&gt; [\"apples\", \"knee\", \"crabs\", \"jailss\"]\n</code></pre>\n\n<p>but to avoid unwanted extra 's' at the end of the strings,</p>\n\n<pre><code>arr = ['apple', 'knee', 'crab', 'jails']\narr.each_with_index.map { |x,i| i == 1 || x[-1] == 's' ? x : x + 's' }\n=&gt; [\"apples\", \"knee\", \"crabs\", \"jails\"]\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "is_accepted": false, "score": 0, "last_activity_date": 1545729311, "creation_date": 1545729311, "answer_id": 53920953, "question_id": 53909400, "link": "https://stackoverflow.com/questions/53909400/add-s-to-the-end-of-each-word-in-an-array-except-for-the-2nd-element-in-the-gi/53920953#53920953", "title": "Add &quot;s&quot; to the end of each word in an array except for the 2nd element in the given array, only using one line of code", "body": "<p>Linebreaks in Ruby are completely optional, they can always be replaced by a keyword, a semicolon, or sometimes removed altogether. Therefore, it is always trivially possible to write any Ruby program, no matter how complex, in one line.</p>\n\n<p>Here's your code in one line:</p>\n\n<pre><code>def add_s(array) array.each_with_index.collect do |element, index| if index == 1 then element else element[element.length] = \"s\"; element end end end\n</code></pre>\n\n<p>However, I am not entirely sure why you want that code on one line, because your original version is much more readable.</p>\n"}], "owner": {"reputation": 13, "user_id": 10827822, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/38cbefaea1b2658b5c1a2b564af64245?s=128&d=identicon&r=PG&f=1", "display_name": "BavarianRhino", "link": "https://stackoverflow.com/users/10827822/bavarianrhino"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 408, "favorite_count": 0, "accepted_answer_id": 53909600, "answer_count": 5, "score": 1, "last_activity_date": 1545729311, "creation_date": 1545628550, "question_id": 53909400, "link": "https://stackoverflow.com/questions/53909400/add-s-to-the-end-of-each-word-in-an-array-except-for-the-2nd-element-in-the-gi", "title": "Add &quot;s&quot; to the end of each word in an array except for the 2nd element in the given array, only using one line of code", "body": "<p>I have an array of single word strings, and I would like to add an 's' to the end of each single word strings except for the 2nd string(element) in the array. I can easily accomplish this using 9 lines of code, but would prefer to do it with 3 lines of code.</p>\n\n<p>Here's my working code using 9 lines.</p>\n\n<pre><code>def add_s(array)\n    array.each_with_index.collect do |element, index|\n        if index == 1\n            element\n        else element[element.length] = \"s\"\n            element\n        end\n    end\nend\n</code></pre>\n\n<p>Here's my broken code while only trying to use 3 lines.</p>\n\n<pre><code>def add_s(array)\n    array.each_with_index.map {|element, index| index == 1 ? element : element[element.length] = \"s\"}\nend\n</code></pre>\n\n<p>Above will return...</p>\n\n<pre><code>array = [\"hand\", \"feet\", \"knee\", \"table\"]\nadd_s(array) =&gt; [\"s\", \"feet\", \"s\", \"s\"]\n</code></pre>\n\n<p>I'm trying to get...</p>\n\n<pre><code>array = [\"hand\", \"feet\", \"knee\", \"table\"]\nadd_s(array) =&gt; [\"hands\", \"feet\", \"knees\", \"tables\"]\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-5"], "comments": [{"owner": {"reputation": 7420, "user_id": 1081668, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/DdH12.png?s=128&g=1", "display_name": "Thanh", "link": "https://stackoverflow.com/users/1081668/thanh"}, "edited": false, "score": 0, "creation_date": 1545626888, "post_id": 53909059, "comment_id": 94663026, "body": "Can you show your <code>show.html.erb</code> code? By the way, <code>commentable.comments.new</code> should be <code>commentable.comments.build</code>"}, {"owner": {"reputation": 6361, "user_id": 2097529, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/QnP8n.jpg?s=128&g=1", "display_name": "Kick Buttowski", "link": "https://stackoverflow.com/users/2097529/kick-buttowski"}, "reply_to_user": {"reputation": 7420, "user_id": 1081668, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/DdH12.png?s=128&g=1", "display_name": "Thanh", "link": "https://stackoverflow.com/users/1081668/thanh"}, "edited": false, "score": 0, "creation_date": 1545627062, "post_id": 53909059, "comment_id": 94663058, "body": "thanks for the response. I tested with the build and get the same result. and I posted whole code for show page. <b>Is build alias of new?</b> so they should be the same, should not they?"}, {"owner": {"reputation": 7420, "user_id": 1081668, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/DdH12.png?s=128&g=1", "display_name": "Thanh", "link": "https://stackoverflow.com/users/1081668/thanh"}, "edited": false, "score": 0, "creation_date": 1545627361, "post_id": 53909059, "comment_id": 94663103, "body": "why do you need to put <code>&lt;%= @article.comments.inspect %&gt;</code> in your form? You can remove it if you don&#39;t want to see <code>#&lt;ActiveRecord...</code>"}, {"owner": {"reputation": 6361, "user_id": 2097529, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/QnP8n.jpg?s=128&g=1", "display_name": "Kick Buttowski", "link": "https://stackoverflow.com/users/2097529/kick-buttowski"}, "reply_to_user": {"reputation": 7420, "user_id": 1081668, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/DdH12.png?s=128&g=1", "display_name": "Thanh", "link": "https://stackoverflow.com/users/1081668/thanh"}, "edited": false, "score": 0, "creation_date": 1545627414, "post_id": 53909059, "comment_id": 94663114, "body": "It is for debugging purposes. when I solve the issue, I will delete it."}, {"owner": {"reputation": 1327, "user_id": 4650675, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SiYJE.jpg?s=128&g=1", "display_name": "Niraj Kaushal", "link": "https://stackoverflow.com/users/4650675/niraj-kaushal"}, "edited": false, "score": 0, "creation_date": 1545627632, "post_id": 53909059, "comment_id": 94663135, "body": "@KickButtowski could you share controller&#39;s code"}, {"owner": {"reputation": 7420, "user_id": 1081668, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/DdH12.png?s=128&g=1", "display_name": "Thanh", "link": "https://stackoverflow.com/users/1081668/thanh"}, "edited": false, "score": 0, "creation_date": 1545627641, "post_id": 53909059, "comment_id": 94663137, "body": "so I still don&#39;t understand what your problem is? I think <code>#&lt;ActiveRecord...</code> is from <code>commentable.comments.build</code> because it is a new comment of current article with id <code>1</code>."}, {"owner": {"reputation": 7420, "user_id": 1081668, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/DdH12.png?s=128&g=1", "display_name": "Thanh", "link": "https://stackoverflow.com/users/1081668/thanh"}, "edited": false, "score": 0, "creation_date": 1545627805, "post_id": 53909059, "comment_id": 94663166, "body": "<code>#&lt;Comment id: nil</code>... it is clearly just a new comment object and not stored in database yet."}, {"owner": {"reputation": 6361, "user_id": 2097529, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/QnP8n.jpg?s=128&g=1", "display_name": "Kick Buttowski", "link": "https://stackoverflow.com/users/2097529/kick-buttowski"}, "edited": false, "score": 0, "creation_date": 1545627916, "post_id": 53909059, "comment_id": 94663183, "body": "why is it shown in the view?"}, {"owner": {"reputation": 7420, "user_id": 1081668, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/DdH12.png?s=128&g=1", "display_name": "Thanh", "link": "https://stackoverflow.com/users/1081668/thanh"}, "edited": false, "score": 0, "creation_date": 1545627989, "post_id": 53909059, "comment_id": 94663193, "body": "I guess because you have <code>&lt;%= @article.comments.inspect %&gt;</code>. Is it shown in the view if you remove that code?"}, {"owner": {"reputation": 6361, "user_id": 2097529, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/QnP8n.jpg?s=128&g=1", "display_name": "Kick Buttowski", "link": "https://stackoverflow.com/users/2097529/kick-buttowski"}, "edited": false, "score": 0, "creation_date": 1545628064, "post_id": 53909059, "comment_id": 94663210, "body": "it is gonne be the same. they are different entities. we better chat somewhere"}, {"owner": {"reputation": 6361, "user_id": 2097529, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/QnP8n.jpg?s=128&g=1", "display_name": "Kick Buttowski", "link": "https://stackoverflow.com/users/2097529/kick-buttowski"}, "reply_to_user": {"reputation": 1327, "user_id": 4650675, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SiYJE.jpg?s=128&g=1", "display_name": "Niraj Kaushal", "link": "https://stackoverflow.com/users/4650675/niraj-kaushal"}, "edited": false, "score": 0, "creation_date": 1545629106, "post_id": 53909059, "comment_id": 94663372, "body": "@NirajKaushal sorry I missed your comment. done"}, {"owner": {"reputation": 7420, "user_id": 1081668, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/DdH12.png?s=128&g=1", "display_name": "Thanh", "link": "https://stackoverflow.com/users/1081668/thanh"}, "reply_to_user": {"reputation": 6361, "user_id": 2097529, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/QnP8n.jpg?s=128&g=1", "display_name": "Kick Buttowski", "link": "https://stackoverflow.com/users/2097529/kick-buttowski"}, "edited": false, "score": 0, "creation_date": 1545631043, "post_id": 53909059, "comment_id": 94663760, "body": "Let us <a href=\"https://chat.stackoverflow.com/rooms/185703/discussion-between-thanh-and-kick-buttowski\">continue this discussion in chat</a>."}], "answers": [{"comments": [{"owner": {"reputation": 6361, "user_id": 2097529, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/QnP8n.jpg?s=128&g=1", "display_name": "Kick Buttowski", "link": "https://stackoverflow.com/users/2097529/kick-buttowski"}, "edited": false, "score": 0, "creation_date": 1545677122, "post_id": 53914494, "comment_id": 94676385, "body": "if the comment is not being saved in db why is it even shown?"}, {"owner": {"reputation": 6018, "user_id": 3073313, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/d9a53be16eb996b521f1637d19005511?s=128&d=identicon&r=PG", "display_name": "Jay-Ar Polidario", "link": "https://stackoverflow.com/users/3073313/jay-ar-polidario"}, "reply_to_user": {"reputation": 6361, "user_id": 2097529, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/QnP8n.jpg?s=128&g=1", "display_name": "Kick Buttowski", "link": "https://stackoverflow.com/users/2097529/kick-buttowski"}, "edited": false, "score": 0, "creation_date": 1545677717, "post_id": 53914494, "comment_id": 94676527, "body": "@KickButtowski if you notice my explanation code above, it&#39;s being shown because you &quot;built&quot; a comment of which is rendered into the view in your <code>.each</code> loop. Using <code>comments.build</code> will build an instance of <code>Comment</code> into the array (in-memory). This is by design. You could think of build as if something like the following: <code>article.comments &lt;&lt; Comment.new</code> (except that it&#39;s still in-memory)"}], "tags": [], "owner": {"reputation": 6018, "user_id": 3073313, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/d9a53be16eb996b521f1637d19005511?s=128&d=identicon&r=PG", "display_name": "Jay-Ar Polidario", "link": "https://stackoverflow.com/users/3073313/jay-ar-polidario"}, "is_accepted": true, "score": 2, "last_activity_date": 1545661281, "last_edit_date": 1545661281, "creation_date": 1545660632, "answer_id": 53914494, "question_id": 53909059, "link": "https://stackoverflow.com/questions/53909059/form-with-produces-first-record-as-nil/53914494#53914494", "title": "form_with produces first record as nil", "body": "<p>From my understanding, you</p>\n\n<h2>Expect:</h2>\n\n<ul>\n<li>in your <code>articles#show</code> page to not show the empty <code>by _________</code> <code>&lt;div&gt;</code> HTML because the <code>comment</code> is still built (still in-memory), and not yet saved (not yet in DB).</li>\n</ul>\n\n<h2>Solution 1:</h2>\n\n<p><strong>app/views/articles/show.html.erb</strong></p>\n\n<pre><code>...\n&lt;div class=\"col-xs-8 col-xs-offset-2\"&gt; \n  &lt;div id=\"comments\"&gt;&lt;/div&gt;\n    &lt;% @article.comments.each do |c| %&gt;\n      &lt;!-- ADD THIS LINE --&gt;\n      &lt;% if c.persisted? %&gt;\n        &lt;div class=\"well\"&gt;           \n          &lt;%= c.content %&gt;   by \n          &lt;%= c.commenter %&gt;           \n        &lt;/div&gt;\n      &lt;% end %&gt;\n    &lt;%end%&gt;\n  &lt;div id=\"comments\"&gt;&lt;/div&gt;\n&lt;/div&gt;\n...\n</code></pre>\n\n<h2>Solution 2 (better but still is a workaround):</h2>\n\n<p><strong>app/views/comments/_form.html.erb</strong></p>\n\n<pre><code>&lt;%= form_with  model:[commentable, Comment.new(commentable: commentable)], :html =&gt; {class: \"form-horizontal\", role:\"form\"} , local: true do |form| %&gt;\n</code></pre>\n\n<h2>Explanation:</h2>\n\n<ul>\n<li><p>The reason the page is displaying an empty <code>by _________</code> <code>&lt;div&gt;</code> is that because you \"built\" a new <code>comment</code> before <code>.each</code> is called. Because they are sharing same memory space, the <code>build</code> basically also adds it to the array in-memory. See the following:</p>\n\n<pre><code># rails console\narticle = Article.create!\ncomment1 = Comment.create!(commentable: article)\n# from here, comment1 is then saved already in the DB\n\n# now let's see what happens when you use \"build\" or \"new\"\n# They have differences, it seem: for details: https://stackoverflow.com/questions/1253426/what-is-the-difference-between-build-and-new-on-rails/1253462\n\n# redefine (to simulate your @article = Article.find(params[:id])\narticle = Article.find(article.id)\ncomment2 = article.comments.build\n\nputs article.comments.count\n# SQL: Select count(*) FROM ...\n# =&gt; 1\n\nputs article.comments.size\n# =&gt; 2\n\n# notice how `count` and `size` are different. `count` value is \"DB-based\" while `size` is \"memory-based\". This is because `count` is an `ActiveRecord` method while `size` is a delegated `Array` method.\n\n# now let's simulate your actual problem in the view, where you were looping...\narticle.comments.each do |comment|\n  puts comment\nend\n# =&gt; &lt;Comment id: 1&gt;\n# =&gt; &lt;Comment id: nil&gt;\n\n# notice that you got 2 comments:\n#  one is that which is already persisted in DB\n#  and the other is the \"built\" one\n\n# the behaviour above is to be expected because `.each` is a delegated `Array` method \n# which is agnostic to where its items come from (DB or not)\n</code></pre></li>\n</ul>\n\n<p>This is the reason why in your page, the \"built\" comment is shown in the page because you are calling</p>\n\n<p><code>&lt;%= render partial: 'comments/form', :locals =&gt; {commentable:   @article} %&gt;</code>\n... which calls <code>commentable.comments.build</code></p>\n\n<p><strong>BEFORE</strong> the <code>&lt;% \"article.comments.each do |c| %&gt;</code></p>\n\n<p>If this is not clear enough yet, try putting</p>\n\n<p><code>&lt;%= render partial: 'comments/form', :locals =&gt; {commentable:   @article} %&gt;</code></p>\n\n<p>... which calls <code>commentable.comments.build</code></p>\n\n<p><strong>AFTER</strong> the <code>&lt;% \"article.comments.each do |c| %&gt; ... &lt;% end %&gt;</code>\n... and the <code>by _________</code> <code>&lt;div&gt;</code> should already not show up.</p>\n"}], "owner": {"reputation": 6361, "user_id": 2097529, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/QnP8n.jpg?s=128&g=1", "display_name": "Kick Buttowski", "link": "https://stackoverflow.com/users/2097529/kick-buttowski"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 81, "favorite_count": 0, "accepted_answer_id": 53914494, "answer_count": 1, "score": 0, "last_activity_date": 1545661281, "creation_date": 1545624088, "last_edit_date": 1545629155, "question_id": 53909059, "link": "https://stackoverflow.com/questions/53909059/form-with-produces-first-record-as-nil", "title": "form_with produces first record as nil", "body": "<p>comment controller</p>\n\n<pre><code>class CommentsController &lt; ApplicationController\n  before_action :load_commentable\n  before_action :checked_logged_in, only: [ :create]\n\n  def new\n    @comment = @commentabl.comments.new\n  end\n\n  def create\n    @comment = @commentable.comments.new(comment_params) \n    @comment.user_id = current_user.id\n    @comment.commenter = current_user.username\n\n\n    if @comment.blank? || @comment.save\n      flash[:success] = \"Commented was created\"\n       ActionCable.server.broadcast 'comment_channel',\n        commenter: current_user.username,\n        comment: @comment.content\n      redirect_to @commentable\n    else       \n       flash[:danger]  = render_to_string(:partial =&gt; 'shared/error_form_messaging',\n                                          :locals =&gt; {obj: @comment}, \n                                          format: :html)\n       redirect_to @commentable   \n    end\n  end\nprivate\n\n  def comment_params\n      params.require(:comment).permit(:content, :commenter, :user_id)\n  end\n  def load_commentable\n    resource, id = request.path.split('/')[1,2]\n    @commentable = resource.singularize.classify.constantize.find(id)\n  end\n\n  def checked_logged_in\n    unless logged_in?\n      flash[:danger] = 'please log in to be able to comment'\n      redirect_to login_path\n    end\n  end\n\nend\n</code></pre>\n\n<p>my form for creating a comment:</p>\n\n<pre><code>&lt;%= form_with  model:[commentable, commentable.comments.new], :html =&gt; {class: \"form-horizontal\", role:\"form\"} , local: true do |form| %&gt;\n\n&lt;div class=\"form-group\"&gt;\n    &lt;div class=\"control-label col-sm-2\"&gt;\n         &lt;%= form.label :content, 'Comment' %&gt;\n    &lt;/div&gt;\n    &lt;div class=\"col-sm-8\"&gt;\n         &lt;%= form.text_field :content , class: 'form-control', placeholder: \"enter your comment here\", autofocus: true %&gt;\n    &lt;/div&gt;\n&lt;/div&gt;\n&lt;div class=\"form-group\"&gt;\n    &lt;div class=\"col-sm-offset-2 col-sm-10\"&gt;\n        &lt;%= form.submit 'Comment' , class: ' btn btn-primary' %&gt; \n    &lt;/div&gt;\n&lt;/div&gt;              \n&lt;% end %&gt;   \n</code></pre>\n\n<p>the form is called in <code>show.html.erb</code></p>\n\n<pre><code>&lt;h2 class=\"text-center\"&gt;\n    Title: &lt;%= @article.title %&gt;\n&lt;/h2&gt;\n&lt;div class=\"well col-xs-8 col-xs-offset-2\"&gt;\n    &lt;div id=\"user-info-showpage\" align=\"center\"&gt;\n        Created by: &lt;%= render 'shared/user-info', obj: @article.user %&gt;    \n    &lt;/div&gt;    \n    &lt;h4 class=\"text-center\"&gt;\n        &lt;strong&gt;Description:&lt;/strong&gt;         \n    &lt;/h4&gt;\n    &lt;hr /&gt;\n    &lt;%= simple_format(@article.description) %&gt;\n    &lt;% if @article.categories.any? %&gt;\n        &lt;p&gt;Categories: &lt;%= render @article.categories %&gt;&lt;/p&gt;      \n     &lt;% end %&gt;\n        &lt;div class=\"article-actions\"&gt;  \n            &lt;% if logged_in? &amp;&amp; (current_user == @article.user || current_user.admin?) %&gt;\n                 &lt;%= link_to \"Delete\", article_path(@article), method: :delete, \n                 data: {confirm: \"Are you sure you want to delete the article?\"}, \n                 class: 'btn btn-xs btn-danger' %&gt;\n                 &lt;%= link_to \"Edit\", edit_article_path(@article), class: 'btn btn-xs btn-success'%&gt;\n            &lt;%end%&gt; \n            &lt;%= link_to \"View All Articles\", articles_path  , class: 'btn btn-xs btn-primary'%&gt; \n        &lt;/div&gt; \n&lt;/div&gt; \n&lt;% if logged_in? %&gt;\n    &lt;div class=\"col-xs-8 col-xs-offset-2\"&gt;\n        &lt;%#= render partial: 'comments/form', :locals =&gt; {commentable:   @article} %&gt;   \n    &lt;/div&gt;\n&lt;%end%&gt; \n\n&lt;div class=\"col-xs-8 col-xs-offset-2\"&gt; \n     &lt;div id=\"comments\"&gt;&lt;/div&gt;\n     &lt;%= @article.comments.inspect %&gt;\n        &lt;% @article.comments.each do |c| %&gt;     \n            &lt;div class=\"well\"&gt;           \n                    &lt;%= c.content %&gt;   by \n                    &lt;%= c.commenter %&gt;           \n            &lt;/div&gt;\n        &lt;%end%&gt;\n\n     &lt;div id=\"comments\"&gt;&lt;/div&gt;\n&lt;/div&gt;\n</code></pre>\n\n<p>my result is in view is <a href=\"https://i.stack.imgur.com/NeMZS.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/NeMZS.png\" alt=\"enter image description here\"></a></p>\n\n<p>Please if more info needed, ask me so I can provide </p>\n\n<p>Note: <strong>I am not sure this empty record is owing to commentable.comments to be nil or I miss something</strong> </p>\n\n<p>I commented render form in show page and now the empty record is gone, so my issue  must be related to form_with </p>\n\n<p><a href=\"https://i.stack.imgur.com/MRaUb.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/MRaUb.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["ruby-on-rails", "ruby", "postgresql", "for-loop"], "comments": [{"owner": {"reputation": 20644, "user_id": 184184, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f6a508697f9eca2680b12ddb85ba1319?s=128&d=identicon&r=PG", "display_name": "Lenin Raj Rajasekaran", "link": "https://stackoverflow.com/users/184184/lenin-raj-rajasekaran"}, "edited": false, "score": 0, "creation_date": 1545623141, "post_id": 53908970, "comment_id": 94662496, "body": "show full controller code"}], "answers": [{"comments": [{"owner": {"reputation": 27, "user_id": 8451201, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KI9cF.jpg?s=128&g=1", "display_name": "Birivera", "link": "https://stackoverflow.com/users/8451201/birivera"}, "edited": false, "score": 0, "creation_date": 1545624264, "post_id": 53909057, "comment_id": 94662628, "body": "It worked. Thanks. What does de &#39;=&#39; do in this context?"}], "tags": [], "owner": {"reputation": 2890, "user_id": 1237117, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/H7dfY.jpg?s=128&g=1", "display_name": "mridula", "link": "https://stackoverflow.com/users/1237117/mridula"}, "is_accepted": true, "score": 0, "last_activity_date": 1545657147, "last_edit_date": 1545657147, "creation_date": 1545624079, "answer_id": 53909057, "question_id": 53908970, "link": "https://stackoverflow.com/questions/53908970/ruby-on-rails-incorrectly-dumps-all-the-postgresql-table-content/53909057#53909057", "title": "Ruby on rails incorrectly dumps all the postgresql table content", "body": "<p>Remove the <code>=</code> sign from your <strong>posts/index.html.erb</strong>:</p>\n\n<pre><code>&lt;% @post.each do |post| %&gt;\n</code></pre>\n\n<p>instead of </p>\n\n<pre><code>&lt;%= @post.each do |post| %&gt;\n</code></pre>\n\n<p><code>&lt;%= ... %&gt;</code> will evaluate the statement/block and print the result. <code>&lt;% ... %&gt;</code> will only evaluate and not print it. For example -</p>\n\n<p><code>&lt;%= a = 5 %&gt;</code> will assign and print '5' on the page.</p>\n\n<p><code>&lt;% a = 5 %&gt;</code> will only assign '5' to the local variable <code>a</code> but not print it.</p>\n"}], "owner": {"reputation": 27, "user_id": 8451201, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KI9cF.jpg?s=128&g=1", "display_name": "Birivera", "link": "https://stackoverflow.com/users/8451201/birivera"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 45, "favorite_count": 0, "accepted_answer_id": 53909057, "answer_count": 1, "score": 0, "last_activity_date": 1545657147, "creation_date": 1545622846, "last_edit_date": 1545623586, "question_id": 53908970, "link": "https://stackoverflow.com/questions/53908970/ruby-on-rails-incorrectly-dumps-all-the-postgresql-table-content", "title": "Ruby on rails incorrectly dumps all the postgresql table content", "body": "<p>I'm realatively new to ruby on rails and im really having problems with a simple for-loop.</p>\n\n<p>I'm doing this:</p>\n\n<p>Inside <strong>posts_controller.rb</strong></p>\n\n<pre><code>@post = Post.all.order(\"created_at DESC\")\n</code></pre>\n\n<p>Inside <strong>posts/index.html.erb</strong> (the view related to the controller)</p>\n\n<pre><code>&lt;%= @post.each do |post| %&gt;\n\n  &lt;%= link_to post.title, post %&gt;\n  &lt;br&gt;\"Published \"\n  &lt;%= time_ago_in_words(post.created_at) %&gt;\n  &lt;br&gt;by user.email\n  &lt;%= post.user.email %&gt;\n\n  &lt;br&gt;&lt;br&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>But the output is (I copied just the important part)</p>\n\n<pre><code>primer pst de ET \n\"Published \" 1 day \nby user.email cacaca@gmail.com \n\nprimer post de cocina \n\"Published \" 1 day \nby user.email cacaca@gmail.com \n\n[#&lt;Post id: 14, title: \"La tercera es la vencida\", content: \"&lt;p&gt;&lt;span style=\\\"color:#ffffff;\\\"&gt;&lt;span style=\\\"backg...\", created_at: \"2018-12-23 03:07:41\", updated_at: \"2018-12-23 03:07:41\", user_id: 1, category: \"rangos de aventurero\", thumbnail: \"img2\", status: \"pending\"&gt;, #&lt;Post id: 13, title: \"segundo post con status\", content: \"&lt;p&gt;&lt;span style=\\\"color:#2ecc71;\\\"&gt;ahora &amp;acute;si qu...\", created_at: \"2018-12-23 03:05:32\", updated_at: \"2018-12-23 03:05:32\", user_id: 1, category: \"Endless Tower\", thumbnail: nil, status: nil&gt;, #&lt;Post id: 12, title: \"Segundo post COCINA\", content: \"&lt;p&gt;Esto es el primer post COCINA con im&amp;aacute;gen...\", created_at: \"2018-12-23 02:53:06\", updated_at: \"2018-12-23 02:53:06\", user_id: 1, category: \"Cocina\", thumbnail: nil, status: nil&gt;, #&lt;Post id: 11, title: \"primer post con status\", content: \"gtgtrhtgr\", created_at: \"2018-12-23 02:31:51\", updated_at: \"2018-12-23 02:31:51\", user_id: 1, category: \"\", thumbnail: nil, status: nil&gt;, #&lt;Post id: 10, title: \"primer post econom\u00eda\", content: \"f3rggg ecoooooo\", created_at: \"2018-12-23 02:19:42\", updated_at: \"2018-12-23 02:19:42\", user_id: 1, category: \"Econom\u00eda\", thumbnail: nil, status: nil&gt;, #&lt;Post id: 9, title: \"primer pst de ET\", content: \"ET SE HACE UNA VEZ A LA SEMAN\", created_at: \"2018-12-23 02:17:04\", updated_at: \"2018-12-23 02:17:04\", user_id: 1, category: \"Endless Tower\", thumbnail: nil, status: nil&gt;, #&lt;Post id: 8, title: \"primer post de cocina\", content: \"wfowrffmweew COCINAAAAAA\", created_at: \"2018-12-23 02:00:39\", updated_at: \"2018-12-23 02:00:39\", user_id: 1, category: \"Cocina\", thumbnail: nil, status: nil&gt;] \nAQU\u00cd TERMINA EL RENDER INDIVIDUAL\n</code></pre>\n\n<p>So it dumps all the database content at the end and I realy don't know why.</p>\n\n<p>I clearly don't want the user to see the table content but I don't know whats wrong with the code above.</p>\n\n<p>I know it's probably a very basic question, but i can't find the answer yet. Please help me.</p>\n\n<p>Thanks for yor help :)</p>\n\n<p>EDIT: here is the full controller code</p>\n\n<pre><code>class PostsController &lt; ApplicationController\n\n  # La siguiente l\u00ednea establece que se llamar\u00e1 al m\u00e9todo &lt;find_post&gt;\n  # antes de llamar a los m\u00e9todos &lt;show&gt;, &lt;edit&gt;, &lt;update&gt;, &lt;destroy&gt;\n  before_action :find_post, only: [:show, :edit, :update, :destroy]\n  before_action :stablish_categories_and_thumbnail\n\n  def index\n    @post = Post.all.order(\"created_at DESC\")\n  end\n\n  def show\n  end\n\n  def new\n    @post = current_user.posts.build\n  end\n\n  def create\n    @post = current_user.posts.build(post_params)\n    if @post.save\n      redirect_to @post\n    else\n      render 'new'\n    end\n  end\n\n  def edit\n  end\n\n  def update\n    if @post.update(post_params)\n      redirect_to @post\n    else\n      render 'edit'\n    end\n  end\n\n  def destroy\n    @post.destroy\n    redirect_to root_path\n  end\n\n  private\n  def post_params\n    params.require(:post).permit(:title, :content, :category, :status, :thumbnail)\n  end\n\n  def find_post\n    @post = Post.find(params[:id])\n  end\n\n  def stablish_categories_and_thumbnail\n    # Esto es lo que hay que ir rellenando luego con las categor\u00edas finales\n    @categories = ['Cocina',\n                   'Endless Tower',\n                   'Econom\u00eda',\n                   'rangos de aventurero']\n\n    @thumbnails_list = ['img1', 'img2', 'img3', 'img4']\n  end\n\nend\n</code></pre>\n"}, {"tags": ["ruby", "multidimensional-array"], "comments": [{"owner": {"reputation": 2890, "user_id": 1237117, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/H7dfY.jpg?s=128&g=1", "display_name": "mridula", "link": "https://stackoverflow.com/users/1237117/mridula"}, "edited": false, "score": 0, "creation_date": 1545625026, "post_id": 53908811, "comment_id": 94662716, "body": "is your array always going to be 2-dimensional?"}, {"owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 0, "creation_date": 1545714681, "post_id": 53908811, "comment_id": 94681464, "body": "When do you replace with <code>&#39;X&#39;</code>, and when with <code>&#39;x&#39;</code>? It is not clear at all."}], "answers": [{"tags": [], "owner": {"reputation": 5519, "user_id": 938947, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f611b152b4fa9fe2a05f4ee9b84fdcb7?s=128&d=identicon&r=PG", "display_name": "widjajayd", "link": "https://stackoverflow.com/users/938947/widjajayd"}, "is_accepted": true, "score": 0, "last_activity_date": 1545624813, "creation_date": 1545624813, "answer_id": 53909116, "question_id": 53908811, "link": "https://stackoverflow.com/questions/53908811/how-to-replace-integers-in-multidimensional-arrays-with-strings/53909116#53909116", "title": "How to replace integers in multidimensional arrays with strings", "body": "<p>this is how you can loop through array multidimensional, from your sample is array two dimension(x,y)\nI replaced array name with arr1</p>\n\n<pre><code>n = 0\narr1 = [[\"a\",\"b\",\"c\", \"d\"]] +\n[[\" \"]+[n,n+1,n+2].map{ |n| n + 1 }] + \n[[\" \"]+[n+3,n+4,n+5].map { |n| n + 1 }]\n\n# this is how you replace\narr1.each_with_index do |x, xi|\n  x.each_with_index do |y, yi|\n    if y.is_a? Integer\n      x[yi] = 'X'\n    end\n  end\nend\n\n# this is how you check the result\narr1.each_with_index do |x, xi|\n  x.each_with_index do |y, yi|\n    puts \"element [#{xi}, #{yi}] is #{y}\"\n  end\nend\n</code></pre>\n\n<p>and this is the output</p>\n\n<pre><code>element [0, 0] is a\nelement [0, 1] is b\nelement [0, 2] is c\nelement [0, 3] is d\nelement [1, 0] is\nelement [1, 1] is X\nelement [1, 2] is X\nelement [1, 3] is X\nelement [2, 0] is\nelement [2, 1] is X\nelement [2, 2] is X\nelement [2, 3] is X\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 802, "user_id": 8728218, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/376ec53188ea3ec0271198a862516657?s=128&d=identicon&r=PG&f=1", "display_name": "Dyaniyal Wilson", "link": "https://stackoverflow.com/users/8728218/dyaniyal-wilson"}, "is_accepted": false, "score": 0, "last_activity_date": 1545657775, "creation_date": 1545657775, "answer_id": 53914044, "question_id": 53908811, "link": "https://stackoverflow.com/questions/53908811/how-to-replace-integers-in-multidimensional-arrays-with-strings/53914044#53914044", "title": "How to replace integers in multidimensional arrays with strings", "body": "<p>This will replace all integers to 'X' and return the required array.</p>\n\n<pre><code>n = 0\nArray = [[\"a\",\"b\",\"c\", \"d\"]] +\n[[\" \"]+[n,n+1,n+2].map{ |n| n + 1 }] + \n[[\" \"]+[n+3,n+4,n+5].map { |n| n + 1 }]\n\n\nArray.map { |a| a.map! { |b| (b.is_a? Integer) ? 'X' : b } }\n</code></pre>\n"}], "owner": {"reputation": 87, "user_id": 10258382, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1bd8a1920f2922dc226f06eebd388473?s=128&d=identicon&r=PG&f=1", "display_name": "Jay", "link": "https://stackoverflow.com/users/10258382/jay"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 59, "favorite_count": 0, "accepted_answer_id": 53909116, "answer_count": 2, "score": -2, "last_activity_date": 1545714577, "creation_date": 1545621053, "last_edit_date": 1545714577, "question_id": 53908811, "link": "https://stackoverflow.com/questions/53908811/how-to-replace-integers-in-multidimensional-arrays-with-strings", "title": "How to replace integers in multidimensional arrays with strings", "body": "<p>I am generating a table in PDF format. There is a multidimensional array of integers and strings, and I have inputs. If the array's values are equal to the inputs, I replace the values with <code>'O'</code>, otherwise with <code>'X'</code>. I would like to replace the other values with <code>'x'</code>. I want to print:</p>\n\n<pre><code>[a][b][c][d]\n\n[ ][O][X][X]\n\n[ ][X][X][X]\n</code></pre>\n\n<p>Anybody help? My code is:</p>\n\n<pre><code>n = 0\nArray = [[\"a\",\"b\",\"c\", \"d\"]] +\n[[\" \"]+[n,n+1,n+2].map{ |n| n + 1 }] + \n[[\" \"]+[n+3,n+4,n+5].map { |n| n + 1 }]\n\nArray.collect! do |i| \n    if i.include?(1) #assume, input is 1\n        i[i.index(1)] = 'X'; i\n    else\n        i\n    end\nend\n</code></pre>\n\n<p>Results:</p>\n\n<pre><code>[a][b][c][d]\n\n[ ][X][2][3]\n\n[ ][4][5][6]\n</code></pre>\n"}, {"tags": ["ruby", "range", "irb", "argument-error"], "answers": [{"comments": [{"owner": {"reputation": 155, "user_id": 10611267, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a3caf805e19826b6593450921fe23ccf?s=128&d=identicon&r=PG&f=1", "display_name": "foo", "link": "https://stackoverflow.com/users/10611267/foo"}, "edited": false, "score": 0, "creation_date": 1545619746, "post_id": 53908698, "comment_id": 94662084, "body": "works now.  BUT if input is  <code>integer n</code> is it not an integer by definition?( IE regex /d+/ would pick up [0-9])"}, {"owner": {"reputation": 2151, "user_id": 10068463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c3df811097b7fb8fef67238aad1151ca?s=128&d=identicon&r=PG&f=1", "display_name": "Nate", "link": "https://stackoverflow.com/users/10068463/nate"}, "reply_to_user": {"reputation": 155, "user_id": 10611267, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a3caf805e19826b6593450921fe23ccf?s=128&d=identicon&r=PG&f=1", "display_name": "foo", "link": "https://stackoverflow.com/users/10611267/foo"}, "edited": false, "score": 1, "creation_date": 1545619995, "post_id": 53908698, "comment_id": 94662112, "body": "Nope. <code>gets</code> always returns a string. There\u2019s a big difference between \u201c5\u201d and 5. It may help you to try out <code>puts gets.class</code> and then <code>puts gets.to_i.class</code>. Be sure to type the exact same input both times. You\u2019ll see that the first one outputs <code>String</code>, and the second puts either <code>Integer</code> or <code>Fixnum</code> depending on your ruby version (Fixnum as been deprecated in favor of Integer)."}, {"owner": {"reputation": 2151, "user_id": 10068463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c3df811097b7fb8fef67238aad1151ca?s=128&d=identicon&r=PG&f=1", "display_name": "Nate", "link": "https://stackoverflow.com/users/10068463/nate"}, "reply_to_user": {"reputation": 155, "user_id": 10611267, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a3caf805e19826b6593450921fe23ccf?s=128&d=identicon&r=PG&f=1", "display_name": "foo", "link": "https://stackoverflow.com/users/10611267/foo"}, "edited": false, "score": 0, "creation_date": 1545620173, "post_id": 53908698, "comment_id": 94662134, "body": "Another thing you may want to try is ditching the gets for a second and doing <code>AddMe(5)</code> and then <code>AddMe(&#39;5&#39;)</code>. You\u2019ll find that the first one works fine, and the second errors the exact same ArgumentError as before. Hopefully that\u2019ll help you understand what\u2019s going on more."}, {"owner": {"reputation": 155, "user_id": 10611267, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a3caf805e19826b6593450921fe23ccf?s=128&d=identicon&r=PG&f=1", "display_name": "foo", "link": "https://stackoverflow.com/users/10611267/foo"}, "edited": false, "score": 0, "creation_date": 1545622914, "post_id": 53908698, "comment_id": 94662458, "body": "u r right. <code>gets.class i</code> returns <code>String</code> in irb. Never tried it before.  <code>Fixnum</code> for<code>gets.to_i.class</code> perhaps I should update irb from v 0.9.6"}, {"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 0, "creation_date": 1545643724, "post_id": 53908698, "comment_id": 94667012, "body": "There is no need to update IRb. That will not change anything. <code>gets</code> will <i>always</i> return a string. That&#39;s what it does. That&#39;s what the documentation says. Guess what the <code>s</code> in <code>gets</code> stands for?"}, {"owner": {"reputation": 2151, "user_id": 10068463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c3df811097b7fb8fef67238aad1151ca?s=128&d=identicon&r=PG&f=1", "display_name": "Nate", "link": "https://stackoverflow.com/users/10068463/nate"}, "edited": false, "score": 0, "creation_date": 1545666427, "post_id": 53908698, "comment_id": 94673753, "body": "Right. This is not an IRB issue. This is just how Ruby works. <code>gets</code> always returns a string. If you need it to be something else (like a number), you\u2019ll have to convert the value."}], "tags": [], "owner": {"reputation": 2151, "user_id": 10068463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c3df811097b7fb8fef67238aad1151ca?s=128&d=identicon&r=PG&f=1", "display_name": "Nate", "link": "https://stackoverflow.com/users/10068463/nate"}, "is_accepted": true, "score": 2, "last_activity_date": 1545619374, "creation_date": 1545619374, "answer_id": 53908698, "question_id": 53908665, "link": "https://stackoverflow.com/questions/53908665/bad-value-in-range-argument-error-regarding-range-construction-in-ruby/53908698#53908698", "title": "bad value in range argument error - regarding range construction in ruby", "body": "<p><code>gets</code> returns a string. You need to do <code>gets.to_i</code>, in order to turn the input into a number for your numeric range. Right now you\u2019re trying to make a range where the start is the number 1 and the end is some string, and that is raising an <code>ArgumentError</code>.</p>\n\n<p>Also as an aside, ruby convention would tell you that your function should be named <code>add_me</code>. Ruby uses snake case, and anything that starts with a capital letter is typically assumed to be a class or constant (constant being all caps).</p>\n"}], "owner": {"reputation": 155, "user_id": 10611267, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a3caf805e19826b6593450921fe23ccf?s=128&d=identicon&r=PG&f=1", "display_name": "foo", "link": "https://stackoverflow.com/users/10611267/foo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 254, "favorite_count": 0, "accepted_answer_id": 53908698, "answer_count": 1, "score": 0, "last_activity_date": 1545620092, "creation_date": 1545618916, "last_edit_date": 1545620092, "question_id": 53908665, "link": "https://stackoverflow.com/questions/53908665/bad-value-in-range-argument-error-regarding-range-construction-in-ruby", "title": "bad value in range argument error - regarding range construction in ruby", "body": "<p>I wrote the following snippet.  </p>\n\n<pre><code>def add_me(num)\n    result = 0\n    (1..num).each { |i| result += i}\n    result\nend\nputs add_me(STDIN.gets)\n</code></pre>\n\n<p>I received an argument error <code>list_sum.rb:6:in 'AddMe': bad value for range (ArgumentError)</code>  the line # corresponds to line # in my editor.</p>\n\n<p>I also experimented with things like <code>foo = (1..num).to_a</code>.  But still receive the same error.  What is going on?  Ruby version 2.3.3.  What am I missing?  I should be able to use variables in ranges, no?</p>\n"}, {"tags": ["ruby", "methods"], "comments": [{"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 2, "creation_date": 1545611445, "post_id": 53908170, "comment_id": 94660979, "body": "This smells like an <a href=\"https://meta.stackexchange.com/questions/66377/what-is-the-xy-problem/66378#66378\">X-Y-problem</a> to me. It is not possible to give a more detailed answer than a simple &quot;No&quot; to your question &quot;is there any way I can handle this&quot; without you telling us what &quot;this&quot; is."}], "answers": [{"comments": [{"owner": {"reputation": 4866, "user_id": 6603195, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-nZGPkfcc0EE/AAAAAAAAAAI/AAAAAAAAAoE/op-TBiFRNzg/photo.jpg?sz=128", "display_name": "Marcin Ko\u0142odziej", "link": "https://stackoverflow.com/users/6603195/marcin-ko%c5%82odziej"}, "edited": false, "score": 1, "creation_date": 1545611551, "post_id": 53908199, "comment_id": 94660997, "body": "That being said, if the object was mutable, you could simply pass it to the method you created and mutate it. Won&#39;t work with integers in Ruby though."}, {"owner": {"reputation": 27, "user_id": 9609610, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b29b5e0d2a9cfb507ac6ce5cc85cddb?s=128&d=identicon&r=PG&f=1", "display_name": "N.S.Genez", "link": "https://stackoverflow.com/users/9609610/n-s-genez"}, "edited": false, "score": 0, "creation_date": 1545611827, "post_id": 53908199, "comment_id": 94661030, "body": "so if i use <b>@a</b> instead of <b>a</b> this problem is totally removed, is it?"}, {"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "reply_to_user": {"reputation": 4866, "user_id": 6603195, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-nZGPkfcc0EE/AAAAAAAAAAI/AAAAAAAAAoE/op-TBiFRNzg/photo.jpg?sz=128", "display_name": "Marcin Ko\u0142odziej", "link": "https://stackoverflow.com/users/6603195/marcin-ko%c5%82odziej"}, "edited": false, "score": 1, "creation_date": 1545644019, "post_id": 53908199, "comment_id": 94667097, "body": "@MarcinKo\u0142odziej: Mutating the referenced object is something completely different from mutating the reference to the object. Since the OP hasn&#39;t told us what the actual problem is they want to solve, it is pretty much impossible to tell whether or not that would solve the problem. Also, <code>+=</code> will <i>always</i> re-bind the variable, no matter what the referenced object is, and all common implementations of <code>+</code> in the core libraries, standard libraries, and most third-party libraries are pure."}, {"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 1, "creation_date": 1545644075, "post_id": 53908199, "comment_id": 94667108, "body": "Whether or not using <code>@a</code> instead of <code>a</code> &quot;totally removes the problem&quot; depends on what &quot;the problem&quot; is that you are trying to solve, which you still haven&#39;t told us. Instance variables have totally different scope and semantics from local variables, so doing this will significantly change the semantics of your program, which may or may not be what you want."}, {"owner": {"reputation": 4866, "user_id": 6603195, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-nZGPkfcc0EE/AAAAAAAAAAI/AAAAAAAAAoE/op-TBiFRNzg/photo.jpg?sz=128", "display_name": "Marcin Ko\u0142odziej", "link": "https://stackoverflow.com/users/6603195/marcin-ko%c5%82odziej"}, "edited": false, "score": 0, "creation_date": 1545647334, "post_id": 53908199, "comment_id": 94668128, "body": "@J&#246;rgWMittag which all comes down to &quot;we don&#39;t know what OP wanted to achieve&quot;. Is mutating an object &quot;changing a variable&quot;? &#175;\\_(\u30c4)_/&#175;"}, {"owner": {"reputation": 27, "user_id": 9609610, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b29b5e0d2a9cfb507ac6ce5cc85cddb?s=128&d=identicon&r=PG&f=1", "display_name": "N.S.Genez", "link": "https://stackoverflow.com/users/9609610/n-s-genez"}, "edited": false, "score": 0, "creation_date": 1545740721, "post_id": 53908199, "comment_id": 94686521, "body": "Sorry about my language mistakes. I&#39;m not exactly mastered in this language and I look at the dictionary a lot of times :). Anyway, I&#39;m creating an <code>a</code> variable and giving it a value. Then I create a few methods and these methods process using the <code>a</code> variable. Then, using an if/else statement, I call any method according to the condition. However, when I run the program and the method doesn&#39;t recognize the variable <code>a</code> I get <code>for nil:NilClass (NoMethodError)</code> error. To resolve this problem, I need to convert the variable <code>a</code> to global, or is there any more useful solution?"}], "tags": [], "owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "is_accepted": false, "score": 0, "last_activity_date": 1545611281, "creation_date": 1545611281, "answer_id": 53908199, "question_id": 53908170, "link": "https://stackoverflow.com/questions/53908170/how-to-get-and-change-a-variables-value-from-outside-a-method/53908199#53908199", "title": "How to get and change a variable&#39;s value from outside a method?", "body": "<p>No, there is no way to change a local variable in a different scope. That's why local variables are called \"local\" variables: because they are local to the scope they are defined in. Your two <code>a</code>s are two completely different local variables in two completely different scopes that have nothing to do with each other.</p>\n"}, {"tags": [], "owner": {"reputation": 392, "user_id": 9910110, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OTTsN.jpg?s=128&g=1", "display_name": "Sandra", "link": "https://stackoverflow.com/users/9910110/sandra"}, "is_accepted": true, "score": 1, "last_activity_date": 1545629762, "creation_date": 1545629762, "answer_id": 53909531, "question_id": 53908170, "link": "https://stackoverflow.com/questions/53908170/how-to-get-and-change-a-variables-value-from-outside-a-method/53909531#53909531", "title": "How to get and change a variable&#39;s value from outside a method?", "body": "<p>Effectively, <code>a</code> is not defined in <code>increase</code>. </p>\n\n<p>Try this:</p>\n\n<pre><code>a = 0\n\ndef increase1(a)\n   a +=1\n   puts a\nend\n\nincrease1(a)\n</code></pre>\n\n<p>I hope it useful for you. :)</p>\n"}], "owner": {"reputation": 27, "user_id": 9609610, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b29b5e0d2a9cfb507ac6ce5cc85cddb?s=128&d=identicon&r=PG&f=1", "display_name": "N.S.Genez", "link": "https://stackoverflow.com/users/9609610/n-s-genez"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 132, "favorite_count": 0, "accepted_answer_id": 53909531, "answer_count": 2, "score": 0, "last_activity_date": 1545714945, "creation_date": 1545610911, "last_edit_date": 1545714945, "question_id": 53908170, "link": "https://stackoverflow.com/questions/53908170/how-to-get-and-change-a-variables-value-from-outside-a-method", "title": "How to get and change a variable&#39;s value from outside a method?", "body": "<p>I want to change an a variable by creating a method. An example is:</p>\n\n<pre><code>a = 0\n\ndef increase1\n  a += 1\n  puts a\nend\n\nincrease1\n</code></pre>\n\n<p>When run this code, I get <code>undefined method `+' for nil:NilClass (NoMethodError)</code> error. I guess the variable <code>a</code> can't read <code>increase1</code> method, and <code>a</code> becomes <code>nil</code>. Is there any way to handle this?</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "answers": [{"tags": [], "owner": {"reputation": 5519, "user_id": 938947, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f611b152b4fa9fe2a05f4ee9b84fdcb7?s=128&d=identicon&r=PG", "display_name": "widjajayd", "link": "https://stackoverflow.com/users/938947/widjajayd"}, "is_accepted": false, "score": 1, "last_activity_date": 1545591751, "creation_date": 1545591751, "answer_id": 53906379, "question_id": 53906077, "link": "https://stackoverflow.com/questions/53906077/notifications-ruby-on-rails/53906379#53906379", "title": "Notifications ruby on rails", "body": "<p>I changed your title span with link_to sample, so if the title clicked then it will go to notification show page</p>\n\n<pre><code>&lt;% if @notifications.count &gt; 0 %&gt;\n  &lt;ul&gt;\n    &lt;% @notifications.each do |notification| %&gt;\n      &lt;li&gt;\n        &lt;%= link_to &lt;span class=\"notification-title\"&gt;&lt;%= notification.title %&gt;&lt;/span&gt;, notification_path(notification)  %&gt;\n        &lt;span class=\"notification-message\"&gt;&lt;%= notification.message %&gt;&lt;/span&gt;\n        &lt;span class=\"notification-time\"&gt;&lt;%= notification.created_at.strftime(\"%B %e at %l:%m%P\") %&gt;&lt;/span&gt;\n      &lt;/li&gt;\n    &lt;% end %&gt;\n  &lt;/ul&gt;\n  &lt;div class=\"notifications-preview-footer\"&gt;\n    &lt;%= link_to \"See All\", notifications_path %&gt;\n  &lt;/div&gt;\n&lt;% else %&gt;\n  &lt;ul&gt;\n    &lt;li&gt;No Notifications&lt;/li&gt;\n  &lt;/ul&gt;\n&lt;% end %&gt;\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 320, "user_id": 6501234, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8e980b8b7894381f8d85eb060b7b0cbf?s=128&d=identicon&r=PG", "display_name": "Corey Gibson", "link": "https://stackoverflow.com/users/6501234/corey-gibson"}, "is_accepted": false, "score": 0, "last_activity_date": 1545599882, "creation_date": 1545599882, "answer_id": 53907240, "question_id": 53906077, "link": "https://stackoverflow.com/questions/53906077/notifications-ruby-on-rails/53907240#53907240", "title": "Notifications ruby on rails", "body": "<p>A lot of unknowns here, first you routes.rb file needs to have the routes defined to allow this say maybe </p>\n\n<pre><code># config/routes.rb\n\nresources: notifications\n</code></pre>\n\n<p>Then in you need to define the controller actions for a view maybe show/edit?</p>\n\n<pre><code> # notifications_controller.rb\n\n class NotificationsController &lt; ApplicationController\n\n   def show\n     @notification = Notification.find(params[:id])\n   end\n end\n</code></pre>\n\n<p>Then you could modify you view like above to allow a link to each notification</p>\n\n<pre><code>&lt;% @notifications.each do |notification| %&gt;\n  &lt;li&gt;\n    &lt;%= link_to &lt;span class=\"notification-title\"&gt;&lt;%= notification.title %&gt;&lt;/span&gt;, notification_path(notification)  %&gt;\n    &lt;span class=\"notification-message\"&gt;&lt;%= notification.message %&gt;&lt;/span&gt;\n    &lt;span class=\"notification-time\"&gt;&lt;%= notification.created_at.strftime(\"%B %e at %l:%m%P\") %&gt;&lt;/span&gt;\n  &lt;/li&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>This may get you what you're looking for.</p>\n"}], "owner": {"reputation": 27, "user_id": 10735674, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/414ca17d7299a6b1d18f728fcc74a4f5?s=128&d=identicon&r=PG&f=1", "display_name": "Djjhjuser10735674", "link": "https://stackoverflow.com/users/10735674/djjhjuser10735674"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 49, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1545599882, "creation_date": 1545589413, "question_id": 53906077, "link": "https://stackoverflow.com/questions/53906077/notifications-ruby-on-rails", "title": "Notifications ruby on rails", "body": "<p>Currently I have a notification system when a patients fills out a form they request a signature from a doctor. The doctor gets notified successfully. But what I am looking for is when the doctor gets the notification they can click on it (link_to) and be redirected automatically to the form. </p>\n\n<pre><code>&lt;% if @notifications.count &gt; 0 %&gt;\n  &lt;ul&gt;\n    &lt;% @notifications.each do |notification| %&gt;\n      &lt;li&gt;\n        &lt;span class=\"notification-title\"&gt;&lt;%= notification.title %&gt;&lt;/span&gt;\n        &lt;span class=\"notification-message\"&gt;&lt;%= notification.message %&gt;&lt;/span&gt;\n        &lt;span class=\"notification-time\"&gt;&lt;%= notification.created_at.strftime(\"%B %e at %l:%m%P\") %&gt;&lt;/span&gt;\n      &lt;/li&gt;\n    &lt;% end %&gt;\n  &lt;/ul&gt;\n  &lt;div class=\"notifications-preview-footer\"&gt;\n    &lt;%= link_to \"See All\", notifications_path %&gt;\n  &lt;/div&gt;\n&lt;% else %&gt;\n  &lt;ul&gt;\n    &lt;li&gt;No Notifications&lt;/li&gt;\n  &lt;/ul&gt;\n&lt;% end %&gt;\n</code></pre>\n"}, {"tags": ["json", "ruby", "linux", "bash", "shell"], "comments": [{"owner": {"reputation": 3649, "user_id": 10404329, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/489c51b790b37922d4e80d59b9873cec?s=128&d=identicon&r=PG", "display_name": "Corion", "link": "https://stackoverflow.com/users/10404329/corion"}, "edited": false, "score": 0, "creation_date": 1545589148, "post_id": 53906007, "comment_id": 94656593, "body": "What is the list of shell characters you want to escape? I think the easy approach would be to just escape these ( <code>\\$|&amp;&#39;</code> ), as they will always appear within a double quoted string (because it&#39;s JSON). Otherwise, you will have to make the replacement only within double-quotes, which is hard."}], "answers": [{"tags": [], "owner": {"reputation": 100768, "user_id": 1899640, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/47374ccb28e4b0d2454b64f7b975bc66?s=128&d=identicon&r=PG", "display_name": "that other guy", "link": "https://stackoverflow.com/users/1899640/that-other-guy"}, "is_accepted": true, "score": 4, "last_activity_date": 1545591650, "creation_date": 1545591650, "answer_id": 53906372, "question_id": 53906007, "link": "https://stackoverflow.com/questions/53906007/make-a-string-both-valid-json-and-shell-escaped/53906372#53906372", "title": "Make a string both valid JSON and shell escaped", "body": "<p>Shells are for humans, not for machines. Having a machine produce shell commands is a code smell indicating that you're automating at the wrong layer. </p>\n\n<p>Skip the shell, and just run your program with the required arguments:</p>\n\n<pre><code>data = [[\"305\", \"John Smith\", \"Amy Smith`\", \"10/11/2008\", \"Medical\", {\"page_count\"=&gt;4}]]\njson_str = data.to_json\nOpen3.popen3(\"node\", \"myscript.js\", json_str) do |stdin, stdout, stderr, wait_thr|\n  output = [stdout.read, stderr.read]\nend \n</code></pre>\n\n<p>Since there is no shell involved, there's no human silliness like escaping to care about.</p>\n"}], "owner": {"reputation": 5850, "user_id": 4501354, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/1230cfcc7f68488ad19d0022cf7b1a93?s=128&d=identicon&r=PG&f=1", "display_name": "Donato", "link": "https://stackoverflow.com/users/4501354/donato"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 142, "favorite_count": 0, "accepted_answer_id": 53906372, "answer_count": 1, "score": 1, "last_activity_date": 1545591650, "creation_date": 1545588808, "question_id": 53906007, "link": "https://stackoverflow.com/questions/53906007/make-a-string-both-valid-json-and-shell-escaped", "title": "Make a string both valid JSON and shell escaped", "body": "<p>I have an array which I want to convert to a JSON string. One of the elements has a backtick. This would cause an error when I try to run the command in the shell:</p>\n\n<pre><code>data = [[\"305\", \"John Smith\", \"Amy Smith`\", \"10/11/2008\", \"Medical\", {\"page_count\"=&gt;4}]]\njson_str = data.to_json.gsub('\"','\\\"')\ncmd = \"node myscript.js #{json_str}\"\nOpen3.popen3(cmd) do |stdin, stdout, stderr, wait_thr|\n  output = [stdout.read, stderr.read]\nend \n\nError retrieving data: sh: 1: Syntax error: EOF in backquote substitution\n</code></pre>\n\n<p>An obvious solution is to escape the backtick:</p>\n\n<pre><code>json_str = data.to_json.gsub('\"','\\\"').gsub('`','\\\\\\`')\n</code></pre>\n\n<p>But I want to escape all special shell characters that could raise an isuse. Ruby's shellescape escapes a string so that it can be safely used in a Bourne shell command line. Here's an example:</p>\n\n<pre><code>argv = \"It's better to give than to receive\".shellescape\nargv #=&gt; \"It\\\\'s\\\\ better\\\\ to\\\\ give\\\\ than\\\\ to\\\\ receive\"\n</code></pre>\n\n<p>But look what happens when I apply it to JSON string:</p>\n\n<pre><code>data = [[\"305\", \"John Smith\", \"Amy Smith`\", \"10/11/2008\", \"Medical\", {\"page_count\"=&gt;4}]]\ndata = data.to_json\n =&gt; \"[[\\\"305\\\",\\\"John Smith\\\",\\\"Amy Smith`\\\",\\\"10/11/2008\\\",\\\"Medical\\\",{\\\"page_count\\\":4}]]\"\ndata = data.to_json.shellescape\n</code></pre>\n\n<p>=> \"\\\\\"\\\\\\\\\"\\[\\[\\\\\\\\\\\\\\\\\"305\\\\\\\\\\\\\\\\\",\\\\\\\\\\\\\\\\\"John\\ Smith\\\\\\\\\\\\\\\\\",\\\\\\\\\\\\\\\\\"Amy\\ Smith\\`\\\\\\\\\\\\\\\\\",\\\\\\\\\\\\\\\\\"10/11/2008\\\\\\\\\\\\\\\\\",\\\\\\\\\\\\\\\\\"Medical\\\\\\\\\\\\\\\\\",\\{\\\\\\\\\\\\\\\\\"page_count\\\\\\\\\\\\\\\\\":4\\}\\]\\]\\\\\\\\\"\\\\\"\"</p>\n\n<p>Clearly, this would raise an error like:</p>\n\n<pre><code>SyntaxError: Unexpected token \\ in JSON at position 0\n</code></pre>\n\n<p>What happens is that shellescape will also escape spaces, since the shell requires spaces to be escaped. But having spaces is valid and necessary JSON. So how could I escape shell characters that would cause an error in my command without it breaking the JSON?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "god"], "answers": [{"tags": [], "owner": {"reputation": 702, "user_id": 4000293, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/976ba675f6c7be8be7c327d1adf91fee?s=128&d=identicon&r=PG&f=1", "display_name": "sloneorzeszki", "link": "https://stackoverflow.com/users/4000293/sloneorzeszki"}, "is_accepted": false, "score": -1, "last_activity_date": 1545597880, "creation_date": 1545597880, "answer_id": 53907033, "question_id": 53905869, "link": "https://stackoverflow.com/questions/53905869/not-able-to-execute-god-commands/53907033#53907033", "title": "Not able to execute god commands", "body": "<p>Are you installing it through the Gemfile? Seems like a bundler related issue.</p>\n"}], "owner": {"reputation": 579, "user_id": 4543241, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/gj0t4.jpg?s=128&g=1", "display_name": "Manish Nagdewani", "link": "https://stackoverflow.com/users/4543241/manish-nagdewani"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 39, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1545597880, "creation_date": 1545587559, "question_id": 53905869, "link": "https://stackoverflow.com/questions/53905869/not-able-to-execute-god-commands", "title": "Not able to execute god commands", "body": "<p>I have setup <code>god</code> configuration at /<code>etc/init.d/god</code>.And installed gem god successfully when trying to get status of <code>god</code> using <code>god status</code> getting this issue.</p>\n\n<pre><code>find_spec_for_exe': can't find gem god (&gt;= 0.a) with executable god (Gem::GemNotFoundException)\n</code></pre>\n"}, {"tags": ["arrays", "ruby", "hashmap"], "answers": [{"comments": [{"owner": {"reputation": 9030, "user_id": 5101476, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JCQrl.jpg?s=128&g=1", "display_name": "ice\u30c4", "link": "https://stackoverflow.com/users/5101476/ice%e3%83%84"}, "edited": false, "score": 0, "creation_date": 1545588600, "post_id": 53905763, "comment_id": 94656452, "body": "Where does the <code>3</code> come from?"}, {"owner": {"reputation": 5060, "user_id": 10522579, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7GQ6a.jpg?s=128&g=1", "display_name": "ray", "link": "https://stackoverflow.com/users/10522579/ray"}, "reply_to_user": {"reputation": 9030, "user_id": 5101476, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JCQrl.jpg?s=128&g=1", "display_name": "ice\u30c4", "link": "https://stackoverflow.com/users/5101476/ice%e3%83%84"}, "edited": false, "score": 0, "creation_date": 1545588995, "post_id": 53905763, "comment_id": 94656552, "body": "For his case, 3 is taken by inspecting <code>list</code>. He can take it dynamically from <code>list</code> by some required logic. If needed, I will provide it also :)"}], "tags": [], "owner": {"reputation": 5060, "user_id": 10522579, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7GQ6a.jpg?s=128&g=1", "display_name": "ray", "link": "https://stackoverflow.com/users/10522579/ray"}, "is_accepted": false, "score": 2, "last_activity_date": 1545586655, "creation_date": 1545586655, "answer_id": 53905763, "question_id": 53905674, "link": "https://stackoverflow.com/questions/53905674/convert-hash-to-array-of-hashes/53905763#53905763", "title": "Convert hash to array of hashes", "body": "<p>Try following code,</p>\n\n<pre><code>arr = []\n3.times { |x| arr[x] = {}; list.each { |k,v| arr[x][k] = v[x] } }\narr.inspect\n</code></pre>\n\n<p>Output will be</p>\n\n<pre><code>=&gt; [{:letter=&gt;\"a\", :number=&gt;\"one\", :fruit=&gt;\"apple\", :car=&gt;\"vw\", :state=&gt;\"la\", :color=&gt;\"red\", :tree=&gt;\"oak\", :animal=&gt;\"cat\", :clothes=&gt;\"tie\"}, {:letter=&gt;\"b\", :number=&gt;\"two\", :fruit=&gt;\"pear\", :car=&gt;\"mb\", :state=&gt;\"ny\", :color=&gt;\"white\", :tree=&gt;\"pine\", :animal=&gt;\"dog\", :clothes=&gt;\"sock\"}, {:letter=&gt;\"c\", :number=&gt;\"three\", :fruit=&gt;\"kiwi\", :car=&gt;\"bmw\", :state=&gt;\"fl\", :color=&gt;\"black\", :tree=&gt;\"maple\", :animal=&gt;\"rat\", :clothes=&gt;\"glove\"}]\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 9030, "user_id": 5101476, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JCQrl.jpg?s=128&g=1", "display_name": "ice\u30c4", "link": "https://stackoverflow.com/users/5101476/ice%e3%83%84"}, "edited": false, "score": 1, "creation_date": 1545588377, "post_id": 53905877, "comment_id": 94656406, "body": "Similarly <code>keys = list.keys; list.values.transpose.map { |v| [keys, v].transpose.to_h }</code>"}, {"owner": {"reputation": 4866, "user_id": 6603195, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-nZGPkfcc0EE/AAAAAAAAAAI/AAAAAAAAAoE/op-TBiFRNzg/photo.jpg?sz=128", "display_name": "Marcin Ko\u0142odziej", "link": "https://stackoverflow.com/users/6603195/marcin-ko%c5%82odziej"}, "reply_to_user": {"reputation": 9030, "user_id": 5101476, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JCQrl.jpg?s=128&g=1", "display_name": "ice\u30c4", "link": "https://stackoverflow.com/users/5101476/ice%e3%83%84"}, "edited": false, "score": 0, "creation_date": 1545589260, "post_id": 53905877, "comment_id": 94656621, "body": "Not similarly, more like, why wouldn&#39;t I just map the values... :p I&#39;ll update, thanks"}], "tags": [], "owner": {"reputation": 4866, "user_id": 6603195, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-nZGPkfcc0EE/AAAAAAAAAAI/AAAAAAAAAoE/op-TBiFRNzg/photo.jpg?sz=128", "display_name": "Marcin Ko\u0142odziej", "link": "https://stackoverflow.com/users/6603195/marcin-ko%c5%82odziej"}, "is_accepted": true, "score": 4, "last_activity_date": 1545589318, "last_edit_date": 1545589318, "creation_date": 1545587651, "answer_id": 53905877, "question_id": 53905674, "link": "https://stackoverflow.com/questions/53905674/convert-hash-to-array-of-hashes/53905877#53905877", "title": "Convert hash to array of hashes", "body": "<p>Leveraging <a href=\"https://ruby-doc.org/core-2.5.3/Array.html#method-i-transpose\" rel=\"nofollow noreferrer\">Array#transpose</a> and <a href=\"https://ruby-doc.org/core-2.5.3/Array.html#method-i-to_h\" rel=\"nofollow noreferrer\">Array#to_h</a></p>\n\n<pre><code>keys = list.keys\nlist.values.transpose.map { |v| keys.zip(v).to_h }\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 9030, "user_id": 5101476, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JCQrl.jpg?s=128&g=1", "display_name": "ice\u30c4", "link": "https://stackoverflow.com/users/5101476/ice%e3%83%84"}, "edited": false, "score": 1, "creation_date": 1545589167, "post_id": 53906019, "comment_id": 94656597, "body": "1. <code>map</code> is more idiomatic than <code>collect</code> 2. <code>each_pair</code> is superfluous."}], "tags": [], "owner": {"reputation": 4739, "user_id": 5403468, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZJ8BE.jpg?s=128&g=1", "display_name": "Tiw", "link": "https://stackoverflow.com/users/5403468/tiw"}, "is_accepted": false, "score": 3, "last_activity_date": 1545591763, "last_edit_date": 1545591763, "creation_date": 1545588872, "answer_id": 53906019, "question_id": 53905674, "link": "https://stackoverflow.com/questions/53905674/convert-hash-to-array-of-hashes/53906019#53906019", "title": "Convert hash to array of hashes", "body": "<p>All in one:</p>\n\n<pre><code>list.map{|k,v| [k].product(v)}.transpose.map(&amp;:to_h)\n</code></pre>\n\n<p>The idea is to use each key product its values, map out, transpose, then convert to hash by <code>to_h</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1545589854, "post_id": 53906093, "comment_id": 94656772, "body": "This is similar to @Marcin&#39;s answer. The main difference is that I used <a href=\"http://ruby-doc.org/core-2.5.1/Array.html#method-i-product\" rel=\"nofollow noreferrer\">Array#product</a> and used <a href=\"http://ruby-doc.org/core-2.5.1/Array.html#method-i-transpose\" rel=\"nofollow noreferrer\">Array#transpose</a> rather than <a href=\"http://ruby-doc.org/core-2.5.1/Enumerable.html#method-i-zip\" rel=\"nofollow noreferrer\">Enumerable#zip</a>, the latter being yin and yang."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "reply_to_user": {"reputation": 3902, "user_id": 10608621, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d59df09a85d05117c63706f66811b70c?s=128&d=identicon&r=PG", "display_name": "mechnicov", "link": "https://stackoverflow.com/users/10608621/mechnicov"}, "edited": false, "score": 0, "creation_date": 1545673421, "post_id": 53906093, "comment_id": 94675485, "body": "@mechnicov, thanks for the compliment and also for mentioning the problem with the mixed-up lists. I fixed that."}], "tags": [], "owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "is_accepted": false, "score": 8, "last_activity_date": 1545673346, "last_edit_date": 1545673346, "creation_date": 1545589508, "answer_id": 53906093, "question_id": 53905674, "link": "https://stackoverflow.com/questions/53905674/convert-hash-to-array-of-hashes/53906093#53906093", "title": "Convert hash to array of hashes", "body": "<pre><code>[list.keys].product(list.values.transpose).map { |a| a.transpose.to_h }\n   #=&gt; [{:letter=&gt;\"a\", :number=&gt;\"one\", :fruit=&gt;\"apple\", :car=&gt;\"vw\", \n   #     :state=&gt;\"la\", :color=&gt;\"red\", :tree=&gt;\"oak\", :animal=&gt;\"cat\",\n   #     :clothes=&gt;\"tie\"},\n   #    {:letter=&gt;\"b\", :number=&gt;\"two\", :fruit=&gt;\"pear\", :car=&gt;\"mb\",\n   #     :state=&gt;\"ny\", :color=&gt;\"white\", :tree=&gt;\"pine\", :animal=&gt;\"dog\",\n   #     :clothes=&gt;\"sock\"},\n   #    {:letter=&gt;\"c\", :number=&gt;\"three\", :fruit=&gt;\"kiwi\", :car=&gt;\"bmw\",\n   #     :state=&gt;\"fl\", :color=&gt;\"black\", :tree=&gt;\"maple\", :animal=&gt;\"rat\", \n   #     :clothes=&gt;\"glove\"}]\n</code></pre>\n\n<p>Suppose <code>list</code> were defined as follows.</p>\n\n<pre><code>list = {\n  letter:  ['a',     'b'   ],\n  number:  ['one',   'two' ],\n  fruit:   ['apple', 'pear'],\n  car:     ['vw',    'mb'  ]\n}\n</code></pre>\n\n<p>The steps would be as follows.</p>\n\n<pre><code>b = [list.keys]\n  #=&gt; [[:letter, :number, :fruit, :car]]\nc = list.values\n  #=&gt; [[\"a\", \"b\"], [\"one\", \"two\"], [\"apple\", \"pear\"], [\"vw\", \"mb\"]]\nd = c.transpose\n  #=&gt; [[\"a\", \"one\", \"apple\", \"vw\"],\n  #    [\"b\", \"two\", \"pear\",  \"mb\"]]\ne = b.product(d)\n  #=&gt; [[[:letter, :number, :fruit, :car], [\"a\", \"one\", \"apple\", \"vw\"]],\n  #    [[:letter, :number, :fruit, :car], [\"b\", \"two\", \"pear\",  \"mb\"]]]\ne.map { |a| a.transpose.to_h }\n  #=&gt; [{:letter=&gt;\"a\", :number=&gt;\"one\", :fruit=&gt;\"apple\", :car=&gt;\"vw\"},\n  #    {:letter=&gt;\"b\", :number=&gt;\"two\", :fruit=&gt;\"pear\",  :car=&gt;\"mb\"}]\n</code></pre>\n\n<p>Let's look at the last step more closely. <code>map</code> passes the first element of <code>e</code> to the block and sets the block variable <code>a</code> to its value:</p>\n\n<pre><code>a = e.first\n  #=&gt; [[:letter, :number,  :fruit,  :car],\n  #    [\"a\",     \"one\",    \"apple\", \"vw\"]]\n</code></pre>\n\n<p>The block calculation is as follows.</p>\n\n<pre><code>f = a.transpose\n  #=&gt; [[:letter, \"a\"], [:number, \"one\"], [:fruit, \"apple\"], [:car,   \"vw\"]]\nf.to_h\n  #=&gt; {:letter=&gt;\"a\", :number=&gt;\"one\", :fruit=&gt;\"apple\", :car=&gt;\"vw\"}\n</code></pre>\n\n<p>The remaining calculations for <code>e.map { |a| a.transpose.to_h }</code> are similar.</p>\n"}, {"tags": [], "owner": {"reputation": 9663, "user_id": 5239030, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/76JEw.png?s=128&g=1", "display_name": "iGian", "link": "https://stackoverflow.com/users/5239030/igian"}, "is_accepted": false, "score": 0, "last_activity_date": 1545596626, "creation_date": 1545596626, "answer_id": 53906911, "question_id": 53905674, "link": "https://stackoverflow.com/questions/53905674/convert-hash-to-array-of-hashes/53906911#53906911", "title": "Convert hash to array of hashes", "body": "<p>Just to play with <a href=\"https://ruby-doc.org/core-2.5.1/Enumerable.html#method-i-each_with_object\" rel=\"nofollow noreferrer\"><code>Enumerable#each_with_object</code></a>:</p>\n\n<pre><code>list.values.transpose.each_with_object([]) { |v, a| a &lt;&lt; v.each_with_index.with_object({}) { |(vv, i), h| h[list.keys[i]] = vv } }\n</code></pre>\n"}], "owner": {"reputation": 3902, "user_id": 10608621, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d59df09a85d05117c63706f66811b70c?s=128&d=identicon&r=PG", "display_name": "mechnicov", "link": "https://stackoverflow.com/users/10608621/mechnicov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1526, "favorite_count": 0, "accepted_answer_id": 53905877, "answer_count": 5, "score": 2, "last_activity_date": 1545673346, "creation_date": 1545586063, "question_id": 53905674, "link": "https://stackoverflow.com/questions/53905674/convert-hash-to-array-of-hashes", "title": "Convert hash to array of hashes", "body": "<p>I have hash, all its values are arrays, like this:</p>\n\n<pre><code>list = { letter:  ['a', 'b', 'c'],\n         number:  ['one', 'two', 'three'],\n         fruit:   ['apple', 'pear', 'kiwi'],\n         car:     ['vw', 'mb', 'bmw'],\n         state:   ['la', 'ny', 'fl'],\n         color:   ['red', 'white', 'black'],\n         tree:    ['oak', 'pine', 'maple'],\n         animal:  ['cat', 'dog', 'rat'],\n         clothes: ['tie', 'sock', 'glove'] }\n</code></pre>\n\n<p>In fact this hash could have more keys and values could be larger, but always sizes of every value are the same (in this case - three).</p>\n\n<p>I want to convert this hash to array of hashes.</p>\n\n<p>Each hash will have all keys of origin hash and respective value.</p>\n\n<p>So finally I want to have:</p>\n\n<pre><code>list = [\n  { letter: 'a', number: 'one', fruit: 'apple', car: 'vw', state: 'la',\n    color: 'red', tree: 'oak', animal: 'cat', clothes: 'tie' },\n\n  { letter: 'b', number: 'two', fruit: 'pear', car: 'mb', state: 'ny',\n    color: 'white', tree: 'pine', animal: 'dog', clothes: 'sock' },\n\n  { letter: 'c', number: 'three', fruit: 'kiwi', car: 'bmw', state: 'fl',\n    color: 'black', tree: 'elm', animal: 'rat', clothes: 'glove' }\n]\n</code></pre>\n\n<p>What's the best way to do it?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "omniauth"], "owner": {"reputation": 238, "user_id": 3759717, "user_type": "registered", "accept_rate": 33, "profile_image": "https://graph.facebook.com/747648733/picture?type=large", "display_name": "Itai Soudry", "link": "https://stackoverflow.com/users/3759717/itai-soudry"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 435, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1545585474, "creation_date": 1545585474, "question_id": 53905620, "link": "https://stackoverflow.com/questions/53905620/custom-omniauth-authentication-failure-csrf-detected", "title": "Custom Omniauth &#39;Authentication failure! csrf_detected&#39;", "body": "<p>I'm trying to create a custom Omniauth for <a href=\"https://dev.smartrecruiters.com\" rel=\"nofollow noreferrer\">Smartrecruiters API</a> OAuth 2.0</p>\n\n<p>omniauth.rb</p>\n\n<pre><code>module OmniAuth\n  module Strategies   \n   class SmartRecruiters &lt; OmniAuth::Strategies::OAuth2\n    option :name, 'smart_recruiters'\n    option :client_options, {\n      site: 'https://www.smartrecruiters.com',\n      authorize_url: '/identity/oauth/allow',\n    }\n\n    def request_phase\n     super\n    end\n\n    def authorize_params\n      super.tap do |params|\n        %w[scope client_options].each do |v|\n          if request.params[v]\n            params[v.to_sym] = request.params[v]\n          end\n        end\n      end\n    end\n  end\nend\n</code></pre>\n\n<p>and outside the module (in the same file):</p>\n\n<pre><code>Rails.application.config.middleware.use OmniAuth::Builder do\n  provider :smart_recruiters, {client_id}, {client_secret},\n           scope: {scope},\n           :setup =&gt; lambda {|env|\n             site = \"https://www.smartrecruiters.com/identity/oauth/allow\"\n             env['omniauth.strategy'].options[:client_options].site = site\n           }\nend\n</code></pre>\n\n<p>routes.rb</p>\n\n<pre><code> match 'auth/:provider/callback', to: 'integrations#create', via: [:get,:post]\n</code></pre>\n\n<p>I'm getting this response:</p>\n\n<pre><code>ERROR (smart_recruiters) Authentication failure! csrf_detected: OmniAuth::Strategies::OAuth2::CallbackError, csrf_detected | CSRF detected\nERROR (smart_recruiters) Authentication failure! invalid_credentials: OmniAuth::Strategies::OAuth2::CallbackError, csrf_detected | CSRF detected\nFATAL\n</code></pre>\n\n<p>I read about disabling the CSRF using:\n    skip_before_action :verify_authenticity_token, only: :create\nin my controller, but it didn't change anything.</p>\n\n<p>I'm using Rails 4.2.8 and Ruby 2.4.5p335.</p>\n\n<p>Any suggestions?</p>\n\n<p>Thanks</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "graphql", "graphql-subscriptions", "graphql-ruby"], "answers": [{"comments": [{"owner": {"reputation": 2422, "user_id": 657626, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/HTge6.jpg?s=128&g=1", "display_name": "Dario Barrionuevo", "link": "https://stackoverflow.com/users/657626/dario-barrionuevo"}, "edited": false, "score": 0, "creation_date": 1612981126, "post_id": 56765107, "comment_id": 116938027, "body": "Hi David, this was useful but I&#39;ve noticed something. Following the example, if I subscribe N different consumers to newMessage, N queries will be triggered to send exactly the same data. This is very inefficient. Did you come across the same situation?"}, {"owner": {"reputation": 2689, "user_id": 1322878, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/CZH7u.jpg?s=128&g=1", "display_name": "David Liaw", "link": "https://stackoverflow.com/users/1322878/david-liaw"}, "reply_to_user": {"reputation": 2422, "user_id": 657626, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/HTge6.jpg?s=128&g=1", "display_name": "Dario Barrionuevo", "link": "https://stackoverflow.com/users/657626/dario-barrionuevo"}, "edited": false, "score": 0, "creation_date": 1614652948, "post_id": 56765107, "comment_id": 117444745, "body": "@DarioBarrionuevo hi, honestly this didn&#39;t really pan out for me so I just switched everything to using push notifications instead. Turned out a bit easier since I only needed to support push rather than both push and sockets. To answer your question though, you could modify your AC channel to cache the query rather than execute a new one."}, {"owner": {"reputation": 2422, "user_id": 657626, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/HTge6.jpg?s=128&g=1", "display_name": "Dario Barrionuevo", "link": "https://stackoverflow.com/users/657626/dario-barrionuevo"}, "edited": false, "score": 0, "creation_date": 1614870222, "post_id": 56765107, "comment_id": 117522323, "body": "I asked this to the gem developer, and duplicated queries are the expected behavior for this setup. GraphQL Broadcasts must be used instead."}], "tags": [], "owner": {"reputation": 2689, "user_id": 1322878, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/CZH7u.jpg?s=128&g=1", "display_name": "David Liaw", "link": "https://stackoverflow.com/users/1322878/david-liaw"}, "is_accepted": false, "score": 4, "last_activity_date": 1561522717, "creation_date": 1561522717, "answer_id": 56765107, "question_id": 53905139, "link": "https://stackoverflow.com/questions/53905139/unable-to-understand-graphql-subscriptions-using-actioncable-with-graphql-ruby-g/56765107#56765107", "title": "Unable to understand GraphQL Subscriptions using ActionCable with graphql-ruby gem", "body": "<p>Not sure if you've solved your problem already but for anyone that has trouble understanding how GraphQL works with ActionCable. I've set up an example repository and will try update the docs to be better.</p>\n\n<p><a href=\"https://github.com/bidluo/GraphQL-ActionCableSubscriptions\" rel=\"nofollow noreferrer\">https://github.com/bidluo/GraphQL-ActionCableSubscriptions</a></p>\n\n<p>To answer your question, execute is like any other ActionCable action when sending messages so to call it you would do the following where data contains everything and query is really the only bit of GraphQL.</p>\n\n<pre><code>{\n   \"command\":\"message\",\n   \"identifier\":\"{\\\"channel\\\":\\\"GraphqlChannel\\\"}\",\n   \"data\":\"{ \\\"query\\\": \\\"subscription { newMessage { content } }\\\", \\\"variables\\\": null, \\\"action\\\": \\\"execute\\\" }\"\n}\n</code></pre>\n\n<p>But you'd need to make sure you're subscribed to the channel first:</p>\n\n<pre><code>{\n   \"command\":\"subscribe\",\n   \"identifier\":\"{\\\"channel\\\":\\\"GraphqlChannel\\\"}\"\n}\n</code></pre>\n"}], "owner": {"reputation": 171, "user_id": 3992679, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/57af477c88ccebd4eb767b7d55f23d96?s=128&d=identicon&r=PG", "display_name": "Shriram Balakrishnan", "link": "https://stackoverflow.com/users/3992679/shriram-balakrishnan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 631, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1561522717, "creation_date": 1545581523, "question_id": 53905139, "link": "https://stackoverflow.com/questions/53905139/unable-to-understand-graphql-subscriptions-using-actioncable-with-graphql-ruby-g", "title": "Unable to understand GraphQL Subscriptions using ActionCable with graphql-ruby gem", "body": "<p>I am trying to implement GraphQL Subscriptions using ActionCable with <code>graphql-ruby</code> gem. </p>\n\n<p>I figured out from this <a href=\"http://graphql-ruby.org/api-doc/1.8.11/GraphQL/Subscriptions/ActionCableSubscriptions\" rel=\"nofollow noreferrer\">link</a> that GraphQL channel needs to be created to which clients needs to subscribe. Normally, in ActionCable, we will <code>stream_from</code> required channel in the <code>subscribed</code> action. But, the example in the link specifies a <code>execute</code> method with parameter. When will this method be executed?</p>\n\n<p>Also, the <a href=\"http://graphql-ruby.org/subscriptions/action_cable_implementation.html\" rel=\"nofollow noreferrer\">doc</a> states <code>See Apollo Client or Relay Modern</code> for client usage. Is it a must to use any one of these or can I use coffeescript to subscribe and update UI?</p>\n"}, {"tags": ["ruby", "string"], "answers": [{"tags": [], "owner": {"reputation": 4272, "user_id": 501266, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/iDtAx.jpg?s=128&g=1", "display_name": "Keith Bennett", "link": "https://stackoverflow.com/users/501266/keith-bennett"}, "is_accepted": false, "score": 3, "last_activity_date": 1545579562, "creation_date": 1545579562, "answer_id": 53904922, "question_id": 53904921, "link": "https://stackoverflow.com/questions/53904921/what-do-to-with-string-when-one-needs-a-method-name-to-call/53904922#53904922", "title": "What do to with String#[] when one needs a method name to call?", "body": "<p>In this case, one has to \"trick\" it into doing the right thing by using a method call that would normally be redundant. Here are some ways to do that:</p>\n\n<pre><code>ls -l | rb -l 'self[0..10]'\nls -l | rb -l 'to_s[0..10]'\nls -l | rb -l 'send :[], 0..10'\nls -l | rb -l 'public_send :[], 0..10'\n</code></pre>\n\n<p>Probably the clearest and most natural way to do this is to use <code>self</code>, shown in the first example.</p>\n"}, {"tags": [], "owner": {"reputation": 73209, "user_id": 290394, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/d7908f05c89e965f6bc5308ad6f41256?s=128&d=identicon&r=PG", "display_name": "steenslag", "link": "https://stackoverflow.com/users/290394/steenslag"}, "is_accepted": true, "score": 2, "last_activity_date": 1545582941, "creation_date": 1545582941, "answer_id": 53905282, "question_id": 53904921, "link": "https://stackoverflow.com/questions/53904921/what-do-to-with-string-when-one-needs-a-method-name-to-call/53905282#53905282", "title": "What do to with String#[] when one needs a method name to call?", "body": "<p>The <code>[]</code> method has an alias which does not need workarounds: <a href=\"https://ruby-doc.org/core-2.4.0/String.html#method-i-slice\" rel=\"nofollow noreferrer\">slice</a></p>\n"}], "owner": {"reputation": 4272, "user_id": 501266, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/iDtAx.jpg?s=128&g=1", "display_name": "Keith Bennett", "link": "https://stackoverflow.com/users/501266/keith-bennett"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 37, "favorite_count": 0, "accepted_answer_id": 53905282, "answer_count": 2, "score": 0, "last_activity_date": 1545582941, "creation_date": 1545579562, "last_edit_date": 1545580115, "question_id": 53904921, "link": "https://stackoverflow.com/questions/53904921/what-do-to-with-string-when-one-needs-a-method-name-to-call", "title": "What do to with String#[] when one needs a method name to call?", "body": "<p><code>String#[]</code> is a very useful method, but is sometimes not possible to use, specifically, for code passed to <code>instance_eval</code>.  For example, using the great <code>rb</code> tool (at <a href=\"https://github.com/thisredone/rb\" rel=\"nofollow noreferrer\">https://github.com/thisredone/rb</a>), if I want to pipe the output of <code>ls -l</code> to get the permissions only (admittedly most likely useless, but illustrative of my point) I can do so like this:</p>\n\n<pre><code>$ ls -l | rb -l 'split.first'\n-rw-r--r--\n</code></pre>\n\n<p>...but if I want to do the same with <code>[]</code> it doesn't work:</p>\n\n<pre><code>$ ls -l | rb -l '[0..10]'\n0..10\n# ...\n</code></pre>\n\n<p>How can I use the <code>[]</code> operator (method) in cases like this?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "strong-parameters"], "comments": [{"owner": {"reputation": 2274, "user_id": 7390929, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/WPB1g.jpg?s=128&g=1", "display_name": "Lucas Andrade", "link": "https://stackoverflow.com/users/7390929/lucas-andrade"}, "edited": false, "score": 0, "creation_date": 1545575123, "post_id": 53903913, "comment_id": 94653372, "body": "You should explain more why you need a default value in your controller, because the best/easy way to set default value to a param with rails is on model"}, {"owner": {"reputation": 121, "user_id": 10819455, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ddea3330ff781a7ddf26cf609f52c70?s=128&d=identicon&r=PG&f=1", "display_name": "Zogimu", "link": "https://stackoverflow.com/users/10819455/zogimu"}, "reply_to_user": {"reputation": 2274, "user_id": 7390929, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/WPB1g.jpg?s=128&g=1", "display_name": "Lucas Andrade", "link": "https://stackoverflow.com/users/7390929/lucas-andrade"}, "edited": false, "score": 0, "creation_date": 1545575456, "post_id": 53903913, "comment_id": 94653441, "body": "I explained it in the main post. I want to add last_updated_by information automatically."}], "answers": [{"comments": [{"owner": {"reputation": 13442, "user_id": 3982562, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2a3c7aae1d762372cda697833c602ec8?s=128&d=identicon&r=PG", "display_name": "3limin4t0r", "link": "https://stackoverflow.com/users/3982562/3limin4t0r"}, "edited": false, "score": 0, "creation_date": 1545574146, "post_id": 53904056, "comment_id": 94653147, "body": "Keep in mind that this doesn&#39;t set a default value. If a value is already present in the params it is overwritten. Use the <code>||=</code> assignment operator instead."}, {"owner": {"reputation": 121, "user_id": 10819455, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ddea3330ff781a7ddf26cf609f52c70?s=128&d=identicon&r=PG&f=1", "display_name": "Zogimu", "link": "https://stackoverflow.com/users/10819455/zogimu"}, "edited": false, "score": 0, "creation_date": 1545575176, "post_id": 53904056, "comment_id": 94653386, "body": "Appreciated for answers but i am getting the error &quot;undefined method `name&#39; for :current_user:Symbol&quot;."}, {"owner": {"reputation": 121, "user_id": 10819455, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ddea3330ff781a7ddf26cf609f52c70?s=128&d=identicon&r=PG&f=1", "display_name": "Zogimu", "link": "https://stackoverflow.com/users/10819455/zogimu"}, "edited": false, "score": 0, "creation_date": 1545575371, "post_id": 53904056, "comment_id": 94653420, "body": "Okay i changed   params[:customer][:last_updated_by] = params.dig(:customer, :name) to   params[:customer][:last_updated_by] = current_user.name and it worked. But i am still curious why i can&#39;t define it in the permitted_params directly."}, {"owner": {"reputation": 13442, "user_id": 3982562, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2a3c7aae1d762372cda697833c602ec8?s=128&d=identicon&r=PG", "display_name": "3limin4t0r", "link": "https://stackoverflow.com/users/3982562/3limin4t0r"}, "edited": false, "score": 0, "creation_date": 1545575695, "post_id": 53904056, "comment_id": 94653495, "body": "The answer still doesn&#39;t set a default this way. If you provide the <code>?customer[last_updated_by]=Some+Name</code> parameter it will be overwritten by the <i>set_last_updated_by_param</i> method.  The reason that no default is set when using permit is simply because the <a href=\"https://api.rubyonrails.org/classes/ActionController/Parameters.html#method-i-permit\" rel=\"nofollow noreferrer\"><i>permit</i></a> method doesn&#39;t allow you to set defaults."}, {"owner": {"reputation": 1276, "user_id": 5399937, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ctCqj.png?s=128&g=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/5399937/tom"}, "reply_to_user": {"reputation": 13442, "user_id": 3982562, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2a3c7aae1d762372cda697833c602ec8?s=128&d=identicon&r=PG", "display_name": "3limin4t0r", "link": "https://stackoverflow.com/users/3982562/3limin4t0r"}, "edited": false, "score": 0, "creation_date": 1545580945, "post_id": 53904056, "comment_id": 94654669, "body": "@JohanWentholt Default values for permitted params can be set via <a href=\"https://api.rubyonrails.org/classes/ActionController/Parameters.html#method-i-with_defaults\" rel=\"nofollow noreferrer\">.with_defaults</a>"}, {"owner": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "edited": false, "score": 0, "creation_date": 1545594038, "post_id": 53904056, "comment_id": 94657724, "body": "<code>with_defaults</code> seems to be the best way. Go ahead for it."}], "tags": [], "owner": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "is_accepted": true, "score": 1, "last_activity_date": 1545964369, "last_edit_date": 1545964369, "creation_date": 1545572058, "answer_id": 53904056, "question_id": 53903913, "link": "https://stackoverflow.com/questions/53903913/how-can-i-set-the-default-values-of-controller-parameters/53904056#53904056", "title": "How can i set the default values of controller parameters?", "body": "<p>If you need the <code>last_updated_by</code> param to go within the customer_params (customer hash key for <code>ActionController::Parameters</code>), then:</p>\n\n<pre><code>before_action :set_last_updated_by_param, only: :create\n\nprivate\n\ndef set_last_updated_by_param\n  params[:customer][:last_updated_by] = params.dig(:customer, :name)\nend\n</code></pre>\n\n<p>The before_action callback adds the new key <code>last_updated_by</code> on the <code>customer</code> params only before the create action is executed.</p>\n\n<p>Notice, no need to modify the customer_params to permit it.</p>\n\n<hr>\n\n<p>As showed by @JohanWentholt, <code>with_defaults</code> seems to be the best way. Go for it.</p>\n\n<p>Waiting the OP chooses the correct answer.</p>\n"}, {"comments": [{"owner": {"reputation": 1276, "user_id": 5399937, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ctCqj.png?s=128&g=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/5399937/tom"}, "edited": false, "score": 1, "creation_date": 1545578843, "post_id": 53904452, "comment_id": 94654219, "body": "<code>params[:last_updated_by] = params[:last_updated_by].blank? ? &#39;Default value&#39; : params[:last_updated_by]</code> can be written as <code>params[:last_updated_by] ||=  &#39;Default value&#39; </code>  Nothing wrong with either version, just giving an alternative."}], "tags": [], "owner": {"reputation": 2274, "user_id": 7390929, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/WPB1g.jpg?s=128&g=1", "display_name": "Lucas Andrade", "link": "https://stackoverflow.com/users/7390929/lucas-andrade"}, "is_accepted": false, "score": 1, "last_activity_date": 1545575643, "creation_date": 1545575643, "answer_id": 53904452, "question_id": 53903913, "link": "https://stackoverflow.com/questions/53903913/how-can-i-set-the-default-values-of-controller-parameters/53904452#53904452", "title": "How can i set the default values of controller parameters?", "body": "<p>If you need a default value only if <code>params[:last_updated_by]</code> is not present in the body of your request, you can try:</p>\n\n<pre><code>def create\n  params[:last_updated_by] = params[:last_updated_by].blank? ? 'Default value' : params[:last_updated_by]\n  Customer.new(params)\n  # finish your controller method\nend\n\ndef customer_params\n  params.require(:customer).permit(:name, :last_updated_by)\nend\n</code></pre>\n\n<p>Now if you need to set a default value on every create and update if <code>last_updated_by</code> is nil, you should do this on Customer model:</p>\n\n<pre><code>after_save :set_last_updated_by\n\ndef set_last_updated_by\n  self.last_updated_by = self.last_updated_by.blank? ? 'Default value' : self.last_updated_by\nend\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 13442, "user_id": 3982562, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2a3c7aae1d762372cda697833c602ec8?s=128&d=identicon&r=PG", "display_name": "3limin4t0r", "link": "https://stackoverflow.com/users/3982562/3limin4t0r"}, "is_accepted": false, "score": 6, "last_activity_date": 1545577648, "last_edit_date": 1545577648, "creation_date": 1545576371, "answer_id": 53904546, "question_id": 53903913, "link": "https://stackoverflow.com/questions/53903913/how-can-i-set-the-default-values-of-controller-parameters/53904546#53904546", "title": "How can i set the default values of controller parameters?", "body": "<p>Since you're asking about setting a default value I suggest using <a href=\"https://api.rubyonrails.org/classes/ActionController/Parameters.html#method-i-with_defaults\" rel=\"noreferrer\"><em>ActionController::Parameters#with_defaults</em></a> method, which is simply an (more expressive) alias for <a href=\"https://api.rubyonrails.org/classes/ActionController/Parameters.html#method-i-reverse_merge\" rel=\"noreferrer\"><em>ActionController::Parameters#reverse_merge</em></a>.</p>\n\n<pre><code>def customer_params\n  params\n    .require(:customer)\n    .permit(:name, :last_updated_by)\n    .with_defaults(last_updated_by: current_user.name)\nend\n</code></pre>\n\n<p>Reverse merge does the same thing as the normal merge, the only difference is what happens on conflicting keys. The normal merge uses the value of the provided hash, whereas the reverse merge prefers the value of the original hash over the value of the provided hash.</p>\n"}, {"tags": [], "owner": {"reputation": 303, "user_id": 9479253, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cd34f4996365a59ad414df6950d6d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ashok Damaniya", "link": "https://stackoverflow.com/users/9479253/ashok-damaniya"}, "is_accepted": false, "score": 1, "last_activity_date": 1545716957, "creation_date": 1545716957, "answer_id": 53919672, "question_id": 53903913, "link": "https://stackoverflow.com/questions/53903913/how-can-i-set-the-default-values-of-controller-parameters/53919672#53919672", "title": "How can i set the default values of controller parameters?", "body": "<p>As method params.permit method is used to filter the parameter you want to create the object with, you can use any of the solution given above, but if you want to modify params in def customer_params then i would like to modify your 2nd solution</p>\n\n<pre><code>def customer_params\n  params[:customer][:last_updated_by] = current_user.name \n  params.require(:customer).permit(:name, :last_updated_by)\nend\n</code></pre>\n"}], "owner": {"reputation": 121, "user_id": 10819455, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ddea3330ff781a7ddf26cf609f52c70?s=128&d=identicon&r=PG&f=1", "display_name": "Zogimu", "link": "https://stackoverflow.com/users/10819455/zogimu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3259, "favorite_count": 0, "accepted_answer_id": 53904056, "answer_count": 4, "score": 4, "last_activity_date": 1545964369, "creation_date": 1545570882, "last_edit_date": 1545580493, "question_id": 53903913, "link": "https://stackoverflow.com/questions/53903913/how-can-i-set-the-default-values-of-controller-parameters", "title": "How can i set the default values of controller parameters?", "body": "<p>I have a customers table on my database and a column named as \"last_updated_by\" . I want to add current users name as a plain text in this field.</p>\n\n<p>I got devise installed on my app so it gives me the current_user parameter.I tried to add current_user.name to the customers_controllers permitted parameters but it did not worked.</p>\n\n<pre><code>1-\ndef customer_params\nparams.require(:customer).permit(:name, :last_updated_by=&gt;current_user.name)\nend\n\n2-\ndef customer_params\n  params[:last_updated_by] = current_user.name\n  params.require(:customer).permit(:name, :last_updated_by)\nend\n\n3-\ndef customer_params\n  last_updated_by = current_user.name\n  params.require(:customer).permit(:name, :last_updated_by=&gt;current_user.name)\nend\n</code></pre>\n\n<p>How can i set some default values in controller.</p>\n"}, {"tags": ["ruby", "vagrant", "vagrantfile"], "comments": [{"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 1, "creation_date": 1545554287, "post_id": 53902164, "comment_id": 94649508, "body": "Seems like <code>node[:ports].each</code> fails on the last <code>NODE</code> since the latter does not have a key <code>:ports</code>. Adding <code>:ports =&gt; {}</code> to it might fix the issue."}, {"owner": {"reputation": 15078, "user_id": 5705247, "user_type": "registered", "accept_rate": 27, "profile_image": "https://www.gravatar.com/avatar/88c1dad0896d0282a281412df83ad196?s=128&d=identicon&r=PG&f=1", "display_name": "Tuomas Toivonen", "link": "https://stackoverflow.com/users/5705247/tuomas-toivonen"}, "reply_to_user": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1545554433, "post_id": 53902164, "comment_id": 94649529, "body": "Oh well... Now that&#39;s so obvious."}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 1, "creation_date": 1545554515, "post_id": 53902164, "comment_id": 94649550, "body": "You\u2019d better run / test the code (whatever possible) in the ruby REPL or like before putting it into vagrant to get better error messages."}], "owner": {"reputation": 15078, "user_id": 5705247, "user_type": "registered", "accept_rate": 27, "profile_image": "https://www.gravatar.com/avatar/88c1dad0896d0282a281412df83ad196?s=128&d=identicon&r=PG&f=1", "display_name": "Tuomas Toivonen", "link": "https://stackoverflow.com/users/5705247/tuomas-toivonen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 152, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1545552896, "creation_date": 1545552896, "question_id": 53902164, "link": "https://stackoverflow.com/questions/53902164/vagrantfile-ruby-error-what-is-wrong-here", "title": "Vagrantfile Ruby error, what is wrong here", "body": "<p>I'm building a simple multi-machine Vagrant environment. I have the following Vagrantfile</p>\n\n<pre><code>OS=\"centos/7\"\n\n\nPORTS_N1={ 8180 =&gt; 80,\n       5156 =&gt; 5556,\n       4143 =&gt; 443,\n       9101 =&gt; 9001,\n       9102 =&gt; 9002,\n       9103 =&gt; 9003 }\n\nPORTS_N2={ 8280 =&gt; 80,\n       5256 =&gt; 5556,\n       4243 =&gt; 443,\n       9201 =&gt; 9001,\n       9202 =&gt; 9002,\n       9203 =&gt; 9003 }\n\nPORTS_N3={ 8380 =&gt; 80,\n       5356 =&gt; 5556,\n       4343 =&gt; 443,\n       9301 =&gt; 9001,\n       9302 =&gt; 9002,\n       9303 =&gt; 9003 }\n\nNODES=[{ :name =&gt; \"k8s-n1\", :ports =&gt; PORTS_N1, :id =&gt; \"01\" },\n       { :name =&gt; \"k8s-n2\", :ports =&gt; PORTS_N2, :id =&gt; \"02\" },\n       { :name =&gt; \"k8s-n3\", :ports =&gt; PORTS_N3, :id =&gt; \"03\" },\n       { :name =&gt; \"ansible-controller\", :id =&gt; \"11\" }]\n\nSHELL_SCRIPT = &lt;&lt;-END\n  sudo mv /etc/hosts /etc/hosts.original || true\n  sudo mv hosts /etc/hosts\n  chmod 0600 /home/vagrant/.ssh/id_rsa\n  yum update\n  yum install -y tree\n  echo \"$(date)\" &gt; /provisioned_at\nEND\n\nVagrant.configure(\"2\") do |config|\n\n\n  config.ssh.insert_key = false\n\n  NODES.each do |node|\n    config.vm.define node[:name] do |cfg|\n      cfg.vm.box = OS\n      cfg.vm.network \"private_network\", ip: \"10.0.0.1#{node[:id]}\"\n      node[:ports].each do |port_host, port_guest|\n        cfg.vm.network \"forwarded_port\", guest: port_guest, host: port_host\n      end\n\n      if node[:name] == \"ansible-controller\"\n        cfg.vm.provision \"ansible_local\" do |ansible|\n          ansible.playbook = \"ansible/site.yml\"\n      ansible.verbose = true\n      ansible.install = true\n      ansible.limit = \"all\"\n      ansible.inventory_path = \"ansible/hosts\"\n    end\n      end\n    end\n  end\n\n\n  config.vm.provision \"file\", source: \"~/.vagrant.d/insecure_private_key\", destination: \"/home/vagrant/.ssh/id_rsa\"\n  config.vm.provision \"file\", source: \"shell/hosts\", destination: \"hosts\"\n  config.vm.provision \"shell\", inline: SHELL_SCRIPT\n\nend\n</code></pre>\n\n<p>However, <code>vagrant up</code> spills out the following error</p>\n\n<pre><code>There was an error loading a Vagrantfile. The file being loaded\nand the error message are shown below. This is usually caused by\nan invalid or undefined variable.\n\nPath: C\nLine number: 0\nMessage: undefined method `each'\n</code></pre>\n\n<p>Being relatively new to Ruby and how Vagrant parses the script, why doesn't the <code>ports</code> property contain <code>each</code> method, even thought the property points to a <code>Hash</code> instance?</p>\n"}, {"tags": ["ruby", "bundler", "minitest"], "answers": [{"comments": [{"owner": {"reputation": 1232, "user_id": 948073, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/05cb19ad33c2a2919e936f60f4009d97?s=128&d=identicon&r=PG", "display_name": "Lori", "link": "https://stackoverflow.com/users/948073/lori"}, "edited": false, "score": 0, "creation_date": 1545576448, "post_id": 53901728, "comment_id": 94653668, "body": "(facepalm) looks like I walked headlong into one of the hazards of translating pseudocode to code! Thanks."}], "tags": [], "owner": {"reputation": 20644, "user_id": 184184, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f6a508697f9eca2680b12ddb85ba1319?s=128&d=identicon&r=PG", "display_name": "Lenin Raj Rajasekaran", "link": "https://stackoverflow.com/users/184184/lenin-raj-rajasekaran"}, "is_accepted": true, "score": 1, "last_activity_date": 1545547106, "creation_date": 1545547106, "answer_id": 53901728, "question_id": 53901360, "link": "https://stackoverflow.com/questions/53901360/minitest-sometimes-terminating-prematurely-with-netither-completion-nor-error-me/53901728#53901728", "title": "Minitest sometimes terminating prematurely with netither completion nor error message", "body": "<p>Use <code>break</code> instead of <code>exit</code>:</p>\n\n<pre><code>break if error &lt; tolerance\n</code></pre>\n\n<p><code>break</code> exits just the do loop.</p>\n\n<p><code>exit</code> exits the program itself not giving a chance for minitest to fail the test</p>\n"}], "owner": {"reputation": 1232, "user_id": 948073, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/05cb19ad33c2a2919e936f60f4009d97?s=128&d=identicon&r=PG", "display_name": "Lori", "link": "https://stackoverflow.com/users/948073/lori"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 24, "favorite_count": 0, "accepted_answer_id": 53901728, "answer_count": 1, "score": 0, "last_activity_date": 1545547106, "creation_date": 1545541856, "question_id": 53901360, "link": "https://stackoverflow.com/questions/53901360/minitest-sometimes-terminating-prematurely-with-netither-completion-nor-error-me", "title": "Minitest sometimes terminating prematurely with netither completion nor error message", "body": "<p>I have a test file, <code>ipca_test.rb</code>:</p>\n\n<pre><code>require \"test_helper\"\nrequire \"matrix\" # Does needing to include this here mean I'm doing something wrong?\n\nclass IpcaTest &lt; Minitest::Test\n  def test_that_it_has_a_version_number\n    refute_nil ::Ipca::VERSION\n  end\n\n  def test_it_does_something_useful\n    refute false\n  end\n\n  def test_on_a_random_matrix\n    p = rand(3..10)\n    n = rand(20..50)\n    m = Matrix.build(n, p) {|_, _| rand(-10.0..10.0)}\n    pca = Ipca::Pca.new(m)\n    eigenvalue, r = pca.first_principal_component\n    puts \"eigenvalue: #{eigenvalue}, r: #{r}\"\n    assert eigenvalue.kind_of? Numeric\n    assert_equal Vector, r.class\n  end\nend\n</code></pre>\n\n<p>The program I'm trying to test is <code>ipca.rb</code>:</p>\n\n<pre><code>require \"ipca/version\"\n\nmodule Ipca\n  class Error &lt; StandardError; end\n\n  class Pca\n    def initialize data\n      @data = data.class == Matrix ? data : Matrix.rows(data)\n    end\n\n    # see https://en.wikipedia.org/wiki/Principal_component_analysis#Iterative_computation\n    def first_principal_component(c = 100, tolerance = 0.001) # not sure whether defaults are apropos\n      p = @data.column_vectors.count\n      r = Vector.elements(Array.new(p) {|_| rand}).normalize\n      eigenvalue = nil\n      c.times do\n        s = Vector.zero(p)\n        @data.row_vectors.each do |x|\n          s += x.dot(r)*x\n        end\n        eigenvalue = r.dot(s) # ?\n        error = (eigenvalue*r-s).norm\n        r = s.normalize\n        exit if error &lt; tolerance\n      end\n      return [eigenvalue, r]\n    end\n  end\nend\n</code></pre>\n\n<p>(<a href=\"https://gitlab.com/n8chz/ipca\" rel=\"nofollow noreferrer\">Git repo of entire tree</a>)</p>\n\n<p>Sometimes the test is successful, but much more often the test never gets to \"Finished\". In these cases there are zero or more dots representing (I assume) successful assertions. I'm guessing that the tests runs are being halted by some kind of timeout somewhere in my bundle, and that this times out intermittently because the input data for the test is of varying size. But if it's a timeout issue why is there not a message to that effect? Here is a series of test runs:</p>\n\n<blockquote>\n  <p>josie@josie-Inspiron-580:/var/www/html/ruby/ipca$ ruby -Itest\n  test/ipca_test.rb Run options: --seed 44059</p>\n  \n  <p># Running:</p>\n  \n  <p>..josie@josie-Inspiron-580:/var/www/html/ruby/ipca$ ruby -Itest\n  test/ipca_test.rb Run options: --seed 57681</p>\n  \n  <p># Running:</p>\n  \n  <p>.josie@josie-Inspiron-580:/var/www/html/ruby/ipca$ ruby -Itest\n  test/ipca_test.rb Run options: --seed 57222</p>\n  \n  <p># Running:</p>\n  \n  <p>..josie@josie-Inspiron-580:/var/www/html/ruby/ipca$ ruby -Itest\n  test/ipca_test.rb Run options: --seed 7474</p>\n  \n  <p># Running:</p>\n  \n  <p>..josie@josie-Inspiron-580:/var/www/html/ruby/ipca$ ruby -Itest\n  test/ipca_test.rb Run options: --seed 1938</p>\n  \n  <p># Running:</p>\n  \n  <p>..josie@josie-Inspiron-580:/var/www/html/ruby/ipca$ ruby -Itest\n  test/ipca_test.rb Run options: --seed 61325</p>\n  \n  <p># Running:</p>\n  \n  <p>..eigenvalue: 2027.687580111128, r: Vector[0.03288542301229099,\n  -0.09533529249551115, 0.3033273986606458, 0.07951734565050736, 0.3575555246291426, 0.41614419068773545, 0.4928822662304588, 0.28785088479078025, 0.5144766379975693] .</p>\n  \n  <p>Finished in 0.037173s, 80.7047 runs/s, 107.6063 assertions/s.</p>\n  \n  <p>3 runs, 4 assertions, 0 failures, 0 errors, 0 skips\n  josie@josie-Inspiron-580:/var/www/html/ruby/ipca$</p>\n</blockquote>\n"}, {"tags": ["ruby-on-rails", "ruby", "routes"], "answers": [{"comments": [{"owner": {"reputation": 1079, "user_id": 3182184, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/UAty8.jpg?s=128&g=1", "display_name": "Aarvy", "link": "https://stackoverflow.com/users/3182184/aarvy"}, "edited": false, "score": 0, "creation_date": 1545589338, "post_id": 53901310, "comment_id": 94656642, "body": "and how do we add params in this?"}, {"owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "reply_to_user": {"reputation": 1079, "user_id": 3182184, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/UAty8.jpg?s=128&g=1", "display_name": "Aarvy", "link": "https://stackoverflow.com/users/3182184/aarvy"}, "edited": false, "score": 0, "creation_date": 1545595728, "post_id": 53901310, "comment_id": 94658141, "body": "i&#39;m not sure you can"}], "tags": [], "owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "is_accepted": true, "score": 0, "last_activity_date": 1545541055, "creation_date": 1545541055, "answer_id": 53901310, "question_id": 53901080, "link": "https://stackoverflow.com/questions/53901080/how-to-conventionally-map-controller-actions-to-routes-in-rails/53901310#53901310", "title": "How to conventionally map controller actions to routes in rails?", "body": "<p>like so:</p>\n\n<pre><code>controller \"pages\" do \n    get :dashboard\nend\n</code></pre>\n\n<p>this will route /dashboard to <code>Pages#dashboard</code> which you can verify with <code>bundle exec rake routes | grep dashboard</code></p>\n"}], "owner": {"reputation": 1079, "user_id": 3182184, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/UAty8.jpg?s=128&g=1", "display_name": "Aarvy", "link": "https://stackoverflow.com/users/3182184/aarvy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 63, "favorite_count": 1, "accepted_answer_id": 53901310, "answer_count": 1, "score": 1, "last_activity_date": 1545541055, "creation_date": 1545537176, "question_id": 53901080, "link": "https://stackoverflow.com/questions/53901080/how-to-conventionally-map-controller-actions-to-routes-in-rails", "title": "How to conventionally map controller actions to routes in rails?", "body": "<p>I have rails 5.1 application and have some set of routes under <code>controller do</code> block.  </p>\n\n<pre><code>controller \"pages\" do \n    get \"/dashboard\", action: \"dashboard\"\n    get \"/guide\", action: \"guide\"\n    get '/welcome/:email', action: \"welcome\"\n    get '/guest/:email', action: 'guest'\n    get '/settings', action: \"settings\"\nend\n</code></pre>\n\n<p>As you can see all routes name are actually mapping to same named action. I am looking for any possibility to DRY it up. Something similar to this. </p>\n\n<pre><code>controller \"pages\" do \n    get \"/dashboard\"\n    get \"/guide\"\n    get '/welcome/:email'\n    get '/guest/:email'\n    get '/settings'\nend\n</code></pre>\n\n<p>Please consider that I want the routes as <code>/dashboard</code> and not <code>/pages/dashboard</code> which is the reason of not using the conventional routes i.e <code>get /pages/dashboard</code> generated by scaffold.</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 6462, "user_id": 3784008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/55ou4.jpg?s=128&g=1", "display_name": "anothermh", "link": "https://stackoverflow.com/users/3784008/anothermh"}, "edited": false, "score": 0, "creation_date": 1545531106, "post_id": 53900666, "comment_id": 94646864, "body": "I&#39;ve read this multiple times and I&#39;m really struggling to understand your example and what your goal is. I also don&#39;t see anything you&#39;ve done to try to solve this on your own. I recommend you take a step back, rethink the problem, and explain it as clearly as you can, keeping in mind <a href=\"https://stackoverflow.com/help/how-to-ask\">how to ask a good question</a>."}, {"owner": {"reputation": 167, "user_id": 8469240, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/10155793383973694/picture?type=large", "display_name": "Mason SB", "link": "https://stackoverflow.com/users/8469240/mason-sb"}, "reply_to_user": {"reputation": 6462, "user_id": 3784008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/55ou4.jpg?s=128&g=1", "display_name": "anothermh", "link": "https://stackoverflow.com/users/3784008/anothermh"}, "edited": false, "score": 0, "creation_date": 1545531943, "post_id": 53900666, "comment_id": 94646966, "body": "@anothermh I appreciate the feedback and i tried very hard to be clear about this. I have read over the how to ask a good question in the past. My attempts haven&#39;t gotten anywhere besides breaking down the key and value.. To be more helpful [2,b,c] [4,b,c][1,c,d] so i would want to add the first and second array together and get [6,b,c][1,c,d]"}, {"owner": {"reputation": 6462, "user_id": 3784008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/55ou4.jpg?s=128&g=1", "display_name": "anothermh", "link": "https://stackoverflow.com/users/3784008/anothermh"}, "edited": false, "score": 0, "creation_date": 1545535491, "post_id": 53900666, "comment_id": 94647323, "body": "I have done my best to clean up your question based on my understanding of it and have left an answer below. Feel free to revert my edits if they don&#39;t align with what your actual question is."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1545551937, "post_id": 53900666, "comment_id": 94649132, "body": "When you give an example it&#39;s helpful to assign a variable to all input values. Here that might be <code>h = { &quot;0&quot; =&gt; ...}</code>. That way, readers can refer to those variables in comments and answers without having to define them."}, {"owner": {"reputation": 167, "user_id": 8469240, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/10155793383973694/picture?type=large", "display_name": "Mason SB", "link": "https://stackoverflow.com/users/8469240/mason-sb"}, "reply_to_user": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1545552781, "post_id": 53900666, "comment_id": 94649281, "body": "@CarySwoveland the person who commented before you edited this post for me because the way I was trying to explain it before was unorganized. I did have value there though lol"}, {"owner": {"reputation": 5060, "user_id": 10522579, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7GQ6a.jpg?s=128&g=1", "display_name": "ray", "link": "https://stackoverflow.com/users/10522579/ray"}, "edited": false, "score": 0, "creation_date": 1545632570, "post_id": 53900666, "comment_id": 94664066, "body": "Have a look on answer I provided, it is simplest one."}], "answers": [{"comments": [{"owner": {"reputation": 167, "user_id": 8469240, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/10155793383973694/picture?type=large", "display_name": "Mason SB", "link": "https://stackoverflow.com/users/8469240/mason-sb"}, "edited": false, "score": 0, "creation_date": 1545535421, "post_id": 53900941, "comment_id": 94647311, "body": "Thank you so much for the reply so much! Hope that made sense to you. I appreciate your response. I am testing it out now!"}, {"owner": {"reputation": 166, "user_id": 8328969, "user_type": "registered", "profile_image": "https://graph.facebook.com/1348325781931523/picture?type=large", "display_name": "Muhammad Awais", "link": "https://stackoverflow.com/users/8328969/muhammad-awais"}, "reply_to_user": {"reputation": 167, "user_id": 8469240, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/10155793383973694/picture?type=large", "display_name": "Mason SB", "link": "https://stackoverflow.com/users/8469240/mason-sb"}, "edited": false, "score": 0, "creation_date": 1545535582, "post_id": 53900941, "comment_id": 94647335, "body": "Glad to help. Please test the edited version because I wasn&#39;t converting string to int before."}], "tags": [], "owner": {"reputation": 166, "user_id": 8328969, "user_type": "registered", "profile_image": "https://graph.facebook.com/1348325781931523/picture?type=large", "display_name": "Muhammad Awais", "link": "https://stackoverflow.com/users/8328969/muhammad-awais"}, "is_accepted": false, "score": 2, "last_activity_date": 1545535361, "last_edit_date": 1545535361, "creation_date": 1545534839, "answer_id": 53900941, "question_id": 53900666, "link": "https://stackoverflow.com/questions/53900666/sum-of-duplicate-values-with-multiple-values-in-hash/53900941#53900941", "title": "Sum of duplicate values with multiple values in hash", "body": "<p>I am not a ruby developer so I can't suggest any best practices but simple algorithm that comes in my mind after reading this, is to create a new hash and check if array values are in it or not, if not then append new value like this.</p>\n\n<pre><code>h = {\n  \"0\" =&gt; [\"1\", \"true\", \"21\"],\n  \"1\" =&gt; [\"2\", \"true\", \"21\"],\n  \"2\" =&gt; [\"3\", \"false\", \"21\"],\n  \"3\" =&gt; [\"4\", \"true\", \"22\"],\n  \"4\" =&gt; [\"5\", \"true\", \"22\"],\n  \"5\" =&gt; [\"6\", \"true\", \"22\"],\n  \"6\" =&gt; [\"7\", \"false\", \"21\"]\n}\n\nnew_h = {}\nh.each do |key, val|\n  x1 = val.at(1)\n  x2 = val.at(2)\n  found = false\n  new_h.each do |key1, val2|\n    y1 = val2.at(1)\n    y2 = val2.at(2)\n    if x1 === y1 &amp;&amp; x2 === y2\n      found = true\n      arr = [val2.at(0).to_i + val.at(0).to_i, x1, x2]\n      new_h[key1] = arr\n    end\n  end\n  if !found\n    new_h[new_h.length] = val\n  end\n  if new_h.empty?\n    new_h[key] = val\n  end\nend\n\nputs \"#{new_h}\"\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 167, "user_id": 8469240, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/10155793383973694/picture?type=large", "display_name": "Mason SB", "link": "https://stackoverflow.com/users/8469240/mason-sb"}, "edited": false, "score": 0, "creation_date": 1545545094, "post_id": 53900956, "comment_id": 94648221, "body": "Thank you for taking the time to do this and answer this question. It really helps knowing different approaches to answering these questions"}], "tags": [], "owner": {"reputation": 6462, "user_id": 3784008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/55ou4.jpg?s=128&g=1", "display_name": "anothermh", "link": "https://stackoverflow.com/users/3784008/anothermh"}, "is_accepted": false, "score": 0, "last_activity_date": 1545535039, "creation_date": 1545535039, "answer_id": 53900956, "question_id": 53900666, "link": "https://stackoverflow.com/questions/53900666/sum-of-duplicate-values-with-multiple-values-in-hash/53900956#53900956", "title": "Sum of duplicate values with multiple values in hash", "body": "<p>This should answer your question, despite being a very long way of solving it. I'm sure there are shortcuts to solve it more easily but you requested a clear explanation of what's happening and I hope that this guides you through how to solve it.</p>\n\n<pre><code># Start with a hash\nhash = {\n  \"0\" =&gt; [\"1\", \"true\", \"21\"],\n  \"1\" =&gt; [\"2\", \"true\", \"21\"],\n  \"2\" =&gt; [\"3\", \"false\", \"21\"],\n  \"3\" =&gt; [\"4\", \"true\", \"22\"],\n  \"4\" =&gt; [\"5\", \"true\", \"22\"],\n  \"5\" =&gt; [\"6\", \"true\", \"22\"],\n  \"6\" =&gt; [\"7\", \"false\", \"21\"]\n}\n\n# Extract just the values from the hash into an array\nvalues = hash.values\n\nadded_values = values.map do |array|\n  # Find all arrays that match this array's values at indices [1] and [2]\n  matching = values.select { |a| a[1] == array[1] &amp;&amp; a[2] == array[2] }\n  sum = 0\n  # Add the values at index 0 from each matching array\n  matching.each { |match| sum += match[0].to_i }\n  # Return a new array with these values\n  [sum.to_s, array[1], array[2]]\nend\n\n# Reject any duplicative arrays\nadded_values.uniq!\n\n# Convert the array back to a hash\nadded_values.each_with_index.each_with_object({}) { |(array, index), hash| hash[index] = array }\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 167, "user_id": 8469240, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/10155793383973694/picture?type=large", "display_name": "Mason SB", "link": "https://stackoverflow.com/users/8469240/mason-sb"}, "edited": false, "score": 0, "creation_date": 1545545056, "post_id": 53901183, "comment_id": 94648218, "body": "Thanks for much for doing this. I am trying to be able to think of this stuff on my own eventually! Thanks for taking the time to answer"}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "reply_to_user": {"reputation": 167, "user_id": 8469240, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/10155793383973694/picture?type=large", "display_name": "Mason SB", "link": "https://stackoverflow.com/users/8469240/mason-sb"}, "edited": false, "score": 0, "creation_date": 1545549605, "post_id": 53901183, "comment_id": 94648808, "body": "I think you can learn a lot about both Ruby and the <i>Ruby-way</i> by trying to see how much of my code you can understand. I&#39;ve provided quite a bit of detail for each step of the calculations as well as links to documentation for the methods I&#39;ve used. You won&#39;t understand everything but I think you may even learn a little by osmosis from the parts that remain a mystery. Note that I&#39;ve written this not just for you, but also for others who are a few weeks or months ahead of you in their quest to become proficient in the language."}, {"owner": {"reputation": 167, "user_id": 8469240, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/10155793383973694/picture?type=large", "display_name": "Mason SB", "link": "https://stackoverflow.com/users/8469240/mason-sb"}, "edited": false, "score": 0, "creation_date": 1545552816, "post_id": 53901183, "comment_id": 94649286, "body": "Thank you for the detail in this, I am going through this line by line trying to break it down. I appreciate the time"}], "tags": [], "owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "is_accepted": true, "score": 2, "last_activity_date": 1545550444, "last_edit_date": 1545550444, "creation_date": 1545539025, "answer_id": 53901183, "question_id": 53900666, "link": "https://stackoverflow.com/questions/53900666/sum-of-duplicate-values-with-multiple-values-in-hash/53901183#53901183", "title": "Sum of duplicate values with multiple values in hash", "body": "<p><strong>Code</strong></p>\n\n<pre><code>def group_em(h)    \n  h.group_by { |_,v| v.drop(1) }.\n    transform_values do |a|\n      a.transpose.\n        last.\n        map(&amp;:first).\n        sum(&amp;:to_i).\n        to_s\n    end.\n    each_with_index.\n    with_object({}) { |((a,v),i),g| g[i] = [v,*a] }\nend\n</code></pre>\n\n<p><strong>Example</strong></p>\n\n<pre><code>h = {\n  \"0\" =&gt; [\"1\", \"true\",  \"21\"],\n  \"1\" =&gt; [\"2\", \"true\",  \"21\"],\n  \"2\" =&gt; [\"3\", \"false\", \"21\"],\n  \"3\" =&gt; [\"4\", \"true\",  \"22\"],\n  \"4\" =&gt; [\"5\", \"true\",  \"22\"],\n  \"5\" =&gt; [\"6\", \"true\",  \"22\"],\n  \"6\" =&gt; [\"7\", \"false\", \"21\"]\n}\n\ngroup_em(h)\n  #=&gt; {0=&gt;[\"3\",  \"true\",  \"21\"],\n  #    1=&gt;[\"10\", \"false\", \"21\"],\n  #    2=&gt;[\"15\", \"true\",  \"22\"]}\n</code></pre>\n\n<p><strong>Explanation</strong></p>\n\n<p><em>The major steps</em></p>\n\n<p>For the hash <code>h</code> above the major steps are as follows.</p>\n\n<pre><code>p = h.group_by { |_,v| v.drop(1) }\n  #=&gt; {[\"true\",  \"21\"]=&gt;[[\"0\", [\"1\", \"true\",  \"21\"]],\n  #                      [\"1\", [\"2\", \"true\",  \"21\"]]],\n  #    [\"false\", \"21\"]=&gt;[[\"2\", [\"3\", \"false\", \"21\"]],\n  #                      [\"6\", [\"7\", \"false\", \"21\"]]],\n  #    [\"true\",  \"22\"]=&gt;[[\"3\", [\"4\", \"true\",  \"22\"]],\n  #                      [\"4\", [\"5\", \"true\",  \"22\"]],\n  #                      [\"5\", [\"6\", \"true\",  \"22\"]]]}\nq = p.transform_values do |a|\n      a.transpose.\n        last.\n        map(&amp;:first).\n        sum(&amp;:to_i).\n        to_s\n    end\n  #=&gt; {[\"true\", \"21\"]=&gt;\"3\", [\"false\", \"21\"]=&gt;\"10\", [\"true\", \"22\"]=&gt;\"15\"}\nenum0 = q.each_with_index\n  #=&gt; #&lt;Enumerator: {[\"true\", \"21\"]=&gt;\"3\", [\"false\", \"21\"]=&gt;\"10\",\n  #     [\"true\", \"22\"]=&gt;\"15\"}:each_with_index&gt;\nenum1 = enum0.with_object({})\n  #=&gt; #&lt;Enumerator: #&lt;Enumerator: {[\"true\", \"21\"]=&gt;\"3\", [\"false\", \"21\"]=&gt;\"10\",\n  #     [\"true\", \"22\"]=&gt;\"15\"}:each_with_index&gt;:with_object({})&gt;\nenum1.each { |((a,v),i),g| g[i] = [v,*a] }\n  #=&gt; {0=&gt;[\"3\", \"true\", \"21\"],\n  #    1=&gt;[\"10\", \"false\", \"21\"],\n  #    2=&gt;[\"15\", \"true\", \"22\"]}\n</code></pre>\n\n<p>We can see the values that will be generated and passed to the block by by the enumerator <code>enum1</code> by converting it to an array:</p>\n\n<pre><code>enum1.to_a\n  #=&gt; [[[[[\"true\", \"21\"], \"3\"], 0], []],\n  #    [[[[\"false\", \"21\"], \"10\"], 1], []],\n  #    [[[[\"true\", \"22\"], \"15\"], 2], []]]\n</code></pre>\n\n<p>If you compare the return value for <code>enum0</code> with that of <code>enum1</code> you can think of the latter as a <em>compound enumerator</em>, though Ruby does not employ that term.</p>\n\n<p><em>Details of <code>Hash#transform_values</code></em></p>\n\n<p>Now let's look more closely at the calculation of <code>q</code>. The first value of <code>p</code> is passed to the block by <a href=\"http://ruby-doc.org/core-2.5.1/Hash.html#method-i-transform_values\" rel=\"nofollow noreferrer\">Hash#transform_values</a> (which made its debut in MRI 2.4) and becomes the value of the block variable <code>a</code>:</p>\n\n<pre><code>a = p.first.last\n  #=&gt; [[\"0\", [\"1\", \"true\", \"21\"]], [\"1\", [\"2\", \"true\", \"21\"]]]\n</code></pre>\n\n<p>The block calculations are as follows.</p>\n\n<pre><code>b = a.transpose\n  #=&gt; [[\"0\", \"1\"], [[\"1\", \"true\", \"21\"], [\"2\", \"true\", \"21\"]]]\nc = b.last\n  #=&gt; [[\"1\", \"true\", \"21\"], [\"2\", \"true\", \"21\"]]\nd = c.map(&amp;:first) # ~same as c.map { |a| a.first }\n  #=&gt; [\"1\", \"2\"] \ne = e.sum(&amp;:to_i)  # ~same as e.sum { |s| s.to_i }\n  #=&gt; 3\ne.to_s\n  #=&gt; \"3\"\n</code></pre>\n\n<p>We see that the value <code>a</code> has been transformed to <code>\"3\"</code>. The remaining calculations to compute <code>q</code> are similar.</p>\n\n<p><em>Documentation links</em></p>\n\n<p>You can find documentation for the methods I've used at the following links for classes <a href=\"http://ruby-doc.org/core-2.5.1/Array.html\" rel=\"nofollow noreferrer\">Array</a> (<code>drop</code>, <code>transpose</code>, <code>last</code>, <code>first</code> and <code>sum</code>), <a href=\"http://ruby-doc.org/core-2.5.1/Integer.html\" rel=\"nofollow noreferrer\">Integer</a> (<code>to_s</code>), <a href=\"http://ruby-doc.org/core-2.5.1/String.html\" rel=\"nofollow noreferrer\">String</a> (<code>to_i</code>) and <a href=\"http://ruby-doc.org/core-2.5.1/Enumerator.html\" rel=\"nofollow noreferrer\">Enumerator</a> (<code>with_object</code> and <code>next</code>), and the module <a href=\"http://ruby-doc.org/core-2.5.1/Enumerable.html\" rel=\"nofollow noreferrer\">Enumerable</a> (<code>group_by</code>, <code>map</code> and <code>each_with_index</code>).</p>\n\n<p><em>Decomposition of nested objects</em></p>\n\n<p>There is one more tricky-bit I would like to mention. That is the line</p>\n\n<pre><code>enum1.each { |((a,v),i),g| g[i] = [v,*a] }\n</code></pre>\n\n<p>I've written the block variables in such a way to decompose the values that are generated by the enumerator <code>enum1</code> and passed to the block. I'm sure that it must look quite imposing for a newbie, but it's not so bad if you take step-by-step, as I will explain.</p>\n\n<p>Firstly, suppose I had a single block variable <code>r</code> (<code>enum1.each { |r|...}</code>). The first value is generated and passed to the block, assigning a value to <code>r</code>:</p>\n\n<pre><code>r = enum1.next\n  #=&gt; [[[[\"true\", \"21\"], \"3\"], 0], []]\n</code></pre>\n\n<p>We could then execute the following statement in the block to decompose (of <em>disambiguate</em>) <code>r</code> as follows:</p>\n\n<pre><code>((a,v),i),g = r\n  #=&gt; [[[[\"true\", \"21\"], \"3\"], 0], []]\n</code></pre>\n\n<p>producing the following assignments:</p>\n\n<pre><code>a #=&gt; [\"true\", \"21\"]\nv #=&gt; \"3\"\ni #=&gt; 0\ng #=&gt; []\n</code></pre>\n\n<p>It is equivalent, and simpler, to replace <code>|r|</code> in the block with <code>|((a,v),i),g|</code>.</p>\n\n<p>If you study the locations of the brackets in the nested array produced by <code>enum1.next</code> you will see how I determined where I needed parentheses when writing the block variables. This decomposition of nested arrays and other objects is a very convenient and powerful feature or Ruby, one that is much underused.</p>\n"}, {"tags": [], "owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "is_accepted": false, "score": 1, "last_activity_date": 1545539526, "creation_date": 1545539526, "answer_id": 53901212, "question_id": 53900666, "link": "https://stackoverflow.com/questions/53900666/sum-of-duplicate-values-with-multiple-values-in-hash/53901212#53901212", "title": "Sum of duplicate values with multiple values in hash", "body": "<p>Just out of curiosity.</p>\n\n<pre><code>input.\n  values.\n  map { |i, *rest| [rest, i.to_i] }.\n  group_by(&amp;:shift).\n  map do |*key, values|\n    [values.flatten.sum.to_s, *key.flatten]\n  end\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 5060, "user_id": 10522579, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7GQ6a.jpg?s=128&g=1", "display_name": "ray", "link": "https://stackoverflow.com/users/10522579/ray"}, "is_accepted": false, "score": 0, "last_activity_date": 1545588818, "creation_date": 1545588818, "answer_id": 53906009, "question_id": 53900666, "link": "https://stackoverflow.com/questions/53900666/sum-of-duplicate-values-with-multiple-values-in-hash/53906009#53906009", "title": "Sum of duplicate values with multiple values in hash", "body": "<p><strong>Hash</strong> and <strong>Array</strong> have most powerful in-built functions in ruby.</p>\n\n<pre><code>z = h.group_by { |k,v| v[1..2] }.keep_if { |k,v| v.length &gt; 1 }\nval = z.map { |k,v| [v.map { |x| x[1] }.map(&amp;:first).map(&amp;:to_i).inject(:+).to_s, k[0], k[1]] }\nval.each_with_index.inject({}) { |m,(x,i)| m[i] = x; m }\n\n=&gt; {0 =&gt;[\"3\", \"true\", \"21\"], 1 =&gt;[\"10\", \"false\", \"21\"], 2 =&gt;[\"15\", \"true\", \"22\"]}\n</code></pre>\n\n<p>If you know these functions then you do not need complex implementation ever. <em>Happy learning :)</em></p>\n"}, {"tags": [], "owner": {"reputation": 441, "user_id": 3275798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/z5Ypg.jpg?s=128&g=1", "display_name": "cavin kwon", "link": "https://stackoverflow.com/users/3275798/cavin-kwon"}, "is_accepted": false, "score": 1, "last_activity_date": 1545617761, "last_edit_date": 1545617761, "creation_date": 1545617308, "answer_id": 53908548, "question_id": 53900666, "link": "https://stackoverflow.com/questions/53900666/sum-of-duplicate-values-with-multiple-values-in-hash/53908548#53908548", "title": "Sum of duplicate values with multiple values in hash", "body": "<p>references : <a href=\"http://ruby-doc.org/core-2.5.1/Enumerable.html#method-i-group_by\" rel=\"nofollow noreferrer\">Enumerable#group_by</a>, <a href=\"http://ruby-doc.org/core-2.5.1/Enumerator.html#method-i-with_index\" rel=\"nofollow noreferrer\">Enumerator#with_index</a>, <a href=\"http://ruby-doc.org/core-2.5.1/Array.html#method-i-to_h\" rel=\"nofollow noreferrer\">Array#to_h</a></p>\n\n<pre><code>key_sum = -&gt;(group) { group.sum { |key, _| key.to_i }.to_s }\ngiven_hash.values.group_by { |_, *rest| rest }. \n  map.with_index { |(key, group), idx| [idx, [key_sum.call(group), *key]] }.to_h\n#=&gt; {0=&gt;[\"3\", \"true\", \"21\"], 1=&gt;[\"10\", \"false\", \"21\"], 2=&gt;[\"15\", \"true\", \"22\"]}\n</code></pre>\n\n<ul>\n<li><p>group by  </p>\n\n<pre><code>given_hash.values.group_by { |_, *rest| rest }\n#=&gt; { [\"true\", \"21\"] =&gt; [[\"1\", \"true\", \"21\"], [\"2\", \"true\", \"21\"]]...\n</code></pre></li>\n<li><p>key_sum function</p>\n\n<pre><code>key_sum = -&gt;(group) { group.sum { |key, _| key.to_i }.to_s }\nkey_sum.call([[\"1\", \"true\", \"21\"], [\"2\", \"true\", \"21\"]]) #=&gt; '3'\n</code></pre></li>\n<li><p>to_h</p>\n\n<pre><code>[[0, [\"3\", \"true\", \"21\"]], [1, [\"10\", \"false\", \"21\"]], [2, [\"15\", \"true\", \"22\"]]].to_h\n#=&gt; {0=&gt;[\"3\", \"true\", \"21\"], 1=&gt;[\"10\", \"false\", \"21\"], 2=&gt;[\"15\", \"true\", \"22\"]}\n</code></pre></li>\n</ul>\n"}, {"tags": [], "owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "is_accepted": false, "score": 0, "last_activity_date": 1545719296, "creation_date": 1545719296, "answer_id": 53919904, "question_id": 53900666, "link": "https://stackoverflow.com/questions/53900666/sum-of-duplicate-values-with-multiple-values-in-hash/53919904#53919904", "title": "Sum of duplicate values with multiple values in hash", "body": "<pre><code>h\n.values\n.group_by{|_, *a| a}\n.map\n.with_index{|(k, a), i| [i, [a.inject(0){|acc, (n, *)| acc + n.to_i}.to_s, *k]]}\n.to_h\n# =&gt; {0=&gt;[\"3\", \"true\", \"21\"], 1=&gt;[\"10\", \"false\", \"21\"], 2=&gt;[\"15\", \"true\", \"22\"]}\n</code></pre>\n"}], "owner": {"reputation": 167, "user_id": 8469240, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/10155793383973694/picture?type=large", "display_name": "Mason SB", "link": "https://stackoverflow.com/users/8469240/mason-sb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 174, "favorite_count": 0, "accepted_answer_id": 53901183, "answer_count": 7, "score": 1, "last_activity_date": 1545719296, "creation_date": 1545530521, "last_edit_date": 1545719225, "question_id": 53900666, "link": "https://stackoverflow.com/questions/53900666/sum-of-duplicate-values-with-multiple-values-in-hash", "title": "Sum of duplicate values with multiple values in hash", "body": "<p>Given a hash that looks like the following:</p>\n\n<pre><code>h = {\n  \"0\" =&gt; [\"1\", \"true\", \"21\"],\n  \"1\" =&gt; [\"2\", \"true\", \"21\"],\n  \"2\" =&gt; [\"3\", \"false\", \"21\"],\n  \"3\" =&gt; [\"4\", \"true\", \"22\"],\n  \"4\" =&gt; [\"5\", \"true\", \"22\"],\n  \"5\" =&gt; [\"6\", \"true\", \"22\"],\n  \"6\" =&gt; [\"7\", \"false\", \"21\"]\n}\n</code></pre>\n\n<p>I want to find the sum of elements at position <code>0</code> across arrays that have the same elements at indices <code>1</code> and <code>2</code>, and return a hash like the following:</p>\n\n<pre><code>{\n  0 =&gt; [\"3\", \"true\", \"21\"],\n  1 =&gt; [\"10\", \"false\", \"21\"],\n  2 =&gt; [\"15\", \"true\", \"22\"]\n}\n</code></pre>\n\n<p>Since there are two arrays with indices <code>1</code> and <code>2</code> having values <code>\"true\"</code> and <code>\"21\"</code>, I want to sum the integer values of index <code>0</code> for those two arrays, for example.</p>\n\n<p>How can I convert the example hash at the top of this question to the resultant hash below it?</p>\n"}, {"tags": ["ruby", "httparty"], "comments": [{"owner": {"reputation": 6462, "user_id": 3784008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/55ou4.jpg?s=128&g=1", "display_name": "anothermh", "link": "https://stackoverflow.com/users/3784008/anothermh"}, "edited": false, "score": 1, "creation_date": 1545524620, "post_id": 53900294, "comment_id": 94646121, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/7627419/how-to-use-basic-authentication-with-httparty-in-a-rails-app\">How to use basic authentication with httparty in a Rails app?</a>"}, {"owner": {"reputation": 172, "user_id": 1893604, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/b4b551e2494b42e80aaacb6f573b0bd2?s=128&d=identicon&r=PG", "display_name": "Aaron Mills", "link": "https://stackoverflow.com/users/1893604/aaron-mills"}, "reply_to_user": {"reputation": 6462, "user_id": 3784008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/55ou4.jpg?s=128&g=1", "display_name": "anothermh", "link": "https://stackoverflow.com/users/3784008/anothermh"}, "edited": false, "score": 0, "creation_date": 1545524962, "post_id": 53900294, "comment_id": 94646165, "body": "It&#39;s not a duplicate"}, {"owner": {"reputation": 4593, "user_id": 7965720, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/67f871a6402211c6c5c4f0e931fe8e7d?s=128&d=identicon&r=PG", "display_name": "Juan", "link": "https://stackoverflow.com/users/7965720/juan"}, "edited": false, "score": 0, "creation_date": 1545526379, "post_id": 53900294, "comment_id": 94646368, "body": "Just to be sure, by BASE64ENCODEDUSERNAMEANDPASSWORD you mean Base64 of USER:PASSWORD right? (colon included)."}, {"owner": {"reputation": 6462, "user_id": 3784008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/55ou4.jpg?s=128&g=1", "display_name": "anothermh", "link": "https://stackoverflow.com/users/3784008/anothermh"}, "edited": false, "score": 0, "creation_date": 1545529371, "post_id": 53900294, "comment_id": 94646678, "body": "How is it not a duplicate? You\u2019re using basic auth with net http and you want to know how to use basic auth with httparty. The error message the <i>server</i> returns even tells you to use basic auth."}, {"owner": {"reputation": 172, "user_id": 1893604, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/b4b551e2494b42e80aaacb6f573b0bd2?s=128&d=identicon&r=PG", "display_name": "Aaron Mills", "link": "https://stackoverflow.com/users/1893604/aaron-mills"}, "edited": false, "score": 0, "creation_date": 1545945317, "post_id": 53900294, "comment_id": 94740447, "body": "I tried using basic auth, but it requires a string, you can see a similar comment on the other one with someone else also stuck using a string"}], "answers": [{"comments": [{"owner": {"reputation": 172, "user_id": 1893604, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/b4b551e2494b42e80aaacb6f573b0bd2?s=128&d=identicon&r=PG", "display_name": "Aaron Mills", "link": "https://stackoverflow.com/users/1893604/aaron-mills"}, "edited": false, "score": 0, "creation_date": 1545945706, "post_id": 53902985, "comment_id": 94740555, "body": "When I do that I get back the error: HTTP Status 401 - An Authentication object was not found in the SecurityContext"}], "tags": [], "owner": {"reputation": 7, "user_id": 2261829, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2077a47eaf40e927167f933beb42c420?s=128&d=identicon&r=PG", "display_name": "ran", "link": "https://stackoverflow.com/users/2261829/ran"}, "is_accepted": false, "score": 0, "last_activity_date": 1545562442, "creation_date": 1545562442, "answer_id": 53902985, "question_id": 53900294, "link": "https://stackoverflow.com/questions/53900294/how-to-use-httparty-instead-of-net-http-or-curl/53902985#53902985", "title": "How to use httparty instead of net/http or curl", "body": "<p>Have you tried the following?</p>\n\n<pre><code>response = HTTParty.get('https://APIURLHERE', headers: { \"Authorization:\" =&gt; \"BASE64ENCODEDUSERNAMEANDPASSWORD\", \"Content-Type\" =&gt; \"application/json\" })\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 172, "user_id": 1893604, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/b4b551e2494b42e80aaacb6f573b0bd2?s=128&d=identicon&r=PG", "display_name": "Aaron Mills", "link": "https://stackoverflow.com/users/1893604/aaron-mills"}, "is_accepted": false, "score": 0, "last_activity_date": 1545946206, "creation_date": 1545946206, "answer_id": 53951071, "question_id": 53900294, "link": "https://stackoverflow.com/questions/53900294/how-to-use-httparty-instead-of-net-http-or-curl/53951071#53951071", "title": "How to use httparty instead of net/http or curl", "body": "<p>Ok I made a simple mistake somewhere along the way because the original solution from the similar post worked... Dont know how it didnt work 50 times last time I was working on this but it was clearly an error on my part somewhere. </p>\n"}], "owner": {"reputation": 172, "user_id": 1893604, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/b4b551e2494b42e80aaacb6f573b0bd2?s=128&d=identicon&r=PG", "display_name": "Aaron Mills", "link": "https://stackoverflow.com/users/1893604/aaron-mills"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 624, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1545946206, "creation_date": 1545524512, "last_edit_date": 1545524830, "question_id": 53900294, "link": "https://stackoverflow.com/questions/53900294/how-to-use-httparty-instead-of-net-http-or-curl", "title": "How to use httparty instead of net/http or curl", "body": "<p>I have a curl request which works</p>\n\n<pre><code>curl -X GET -k 'https://APIADDRESSHERE' -u 'USERNAME:PASSWORD' -H 'Content-Type: application/json'\n</code></pre>\n\n<p>I can also get this working in ruby:</p>\n\n<pre><code>require 'net/http'\nrequire 'uri'\nrequire 'openssl'\n\nuri = URI.parse(\"https://APIADDRESSHERE\")\nrequest = Net::HTTP::Get.new(uri)\nrequest.basic_auth(\"USERNAME\", \"PASSWORD\")\nrequest.content_type = \"application/json\"\n\nreq_options = {\n  use_ssl: uri.scheme == \"https\",\n  verify_mode: OpenSSL::SSL::VERIFY_NONE,\n}\n\nresponse = Net::HTTP.start(uri.hostname, uri.port, req_options) do |http|\n  http.request(request)\nend\n</code></pre>\n\n<p>However when I try this with httparty I keep getting a 401 error saying:</p>\n\n<p>An Authentication object was not found in the SecurityContext This request requires HTTP authentication.</p>\n\n<p>I have tried a lot of variations of the following but I'm stuck. </p>\n\n<pre><code>response = HTTParty.get('https://APIURLHERE', {\"headers\": { \"Authorization:\" =&gt; \"BASE64ENCODEDUSERNAMEANDPASSWORD\", \"Content-Type\" =&gt; \"application/json\" }})\n</code></pre>\n"}, {"tags": ["arrays", "ruby", "hash"], "comments": [{"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 1, "creation_date": 1545517230, "post_id": 53899669, "comment_id": 94644899, "body": "<code>p two_sum(array, x).to_a</code>"}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1545519920, "post_id": 53899669, "comment_id": 94645398, "body": "I think you mean &quot;array&quot;, not &quot;set&quot;. See <a href=\"https://ruby-doc.org/stdlib-2.5.3/libdoc/set/rdoc/Set.html\" rel=\"nofollow noreferrer\">Set</a>. Also, to check whether a hash <code>h</code> has a key <code>k</code>, it&#39;s best to write <code>h.hey?(k)</code> (or the alias <code>h.has_hey?(k)</code>), just in case <code>h</code> has a key <code>nil</code>."}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "reply_to_user": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1545520079, "post_id": 53899669, "comment_id": 94645425, "body": "@CarySwoveland <code>key?</code> :)"}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "reply_to_user": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1545520868, "post_id": 53899669, "comment_id": 94645564, "body": "Hey, @Sergio, these old eyes seem to have some trouble reading the tiny font on my phone in low light. Also, this demonstrates one of the pitfalls of cutting-and-pasting."}, {"owner": {"reputation": 133, "user_id": 5219792, "user_type": "registered", "profile_image": "https://graph.facebook.com/10207554199792913/picture?type=large", "display_name": "Alfatah Kader", "link": "https://stackoverflow.com/users/5219792/alfatah-kader"}, "reply_to_user": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1545520934, "post_id": 53899669, "comment_id": 94645574, "body": "@SergioTulentsev, I had been aware of .to_a but that gives me the keys and values in vertical line for each."}, {"owner": {"reputation": 133, "user_id": 5219792, "user_type": "registered", "profile_image": "https://graph.facebook.com/10207554199792913/picture?type=large", "display_name": "Alfatah Kader", "link": "https://stackoverflow.com/users/5219792/alfatah-kader"}, "reply_to_user": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1545521088, "post_id": 53899669, "comment_id": 94645597, "body": "@CarySwoveland, yes, array. My attempt to get them in array has been futile so far. Even with .to_a the output is vertical presentation, not as an array."}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1545521275, "post_id": 53899669, "comment_id": 94645635, "body": "@AlfatahKader: &quot;that gives me the keys and values in vertical line&quot; - no, it doesn&#39;t. Try my line exactly as is."}, {"owner": {"reputation": 133, "user_id": 5219792, "user_type": "registered", "profile_image": "https://graph.facebook.com/10207554199792913/picture?type=large", "display_name": "Alfatah Kader", "link": "https://stackoverflow.com/users/5219792/alfatah-kader"}, "reply_to_user": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 1, "creation_date": 1545521806, "post_id": 53899669, "comment_id": 94645724, "body": "@SergioTulentsev, DOPE! Me being a newbie, I didn&#39;t see the difference between &quot;p&quot; vs &quot;puts&quot; . Yep, it works.   The work around otherwise that I figured is:  two_sum(array, x).each do |k, v| puts &quot;[#{k}, #{v}]&quot;"}, {"owner": {"reputation": 6462, "user_id": 3784008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/55ou4.jpg?s=128&g=1", "display_name": "anothermh", "link": "https://stackoverflow.com/users/3784008/anothermh"}, "edited": false, "score": 1, "creation_date": 1545522053, "post_id": 53899669, "comment_id": 94645762, "body": "@AlfatahKader I&#39;ve done my best to correct your indentation and line breaks but you should make an effort to do this on your own in future questions. The harder your code is to read and decipher the less likely you are to get meaningful answers."}, {"owner": {"reputation": 133, "user_id": 5219792, "user_type": "registered", "profile_image": "https://graph.facebook.com/10207554199792913/picture?type=large", "display_name": "Alfatah Kader", "link": "https://stackoverflow.com/users/5219792/alfatah-kader"}, "reply_to_user": {"reputation": 6462, "user_id": 3784008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/55ou4.jpg?s=128&g=1", "display_name": "anothermh", "link": "https://stackoverflow.com/users/3784008/anothermh"}, "edited": false, "score": 1, "creation_date": 1545522251, "post_id": 53899669, "comment_id": 94645792, "body": "@anothermh, will do; I haven&#39;t figured out yet the conventional standard; just plunged into Ruby; will lookup some reading on this. thanks"}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 2, "creation_date": 1545522462, "post_id": 53899669, "comment_id": 94645821, "body": "@AlfatahKader: I&#39;ll just leave this here: <a href=\"https://github.com/rubocop-hq/ruby-style-guide\" rel=\"nofollow noreferrer\">github.com/rubocop-hq/ruby-style-guide</a>"}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 1, "creation_date": 1545523358, "post_id": 53899669, "comment_id": 94645942, "body": "Just a word on formatting code. When it&#39;s within a sentence surround it with <code>backticks</code> (like so, with no spaces between the backtick and the code). In the body, indent 4 or more spaces. The easiest way to do that is to write your code with the only indenting the usual 2 spaces within <code>do...end</code> blocks, <code>if...elsif.,.end</code> and so on. Then select all your code and click on the symbol <code>{}</code>, That will indent all your code 4 spaces"}, {"owner": {"reputation": 133, "user_id": 5219792, "user_type": "registered", "profile_image": "https://graph.facebook.com/10207554199792913/picture?type=large", "display_name": "Alfatah Kader", "link": "https://stackoverflow.com/users/5219792/alfatah-kader"}, "reply_to_user": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 0, "creation_date": 1545853598, "post_id": 53899669, "comment_id": 94712974, "body": "@sawa - your edit lacks clarity and coherency in implicit English language usage for layman&#39;s understanding. Leaving out key word &quot;Ruby&quot; from the question is a fatal mistake that would render false positives for others asking similar question for a different program. If a certain key word or technical term is absent or incorrectly used, please comment.The end user&#39;s search experience is very important. You also edited out some tags. Please, again, I know you mean well, but let me correct myself and just comment the advice to me. I sincerely appreciate your help."}, {"owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 0, "creation_date": 1545909544, "post_id": 53899669, "comment_id": 94727017, "body": "@AlfatahKader The fact that it is a Ruby question is supposed to be expressed by the keyword. No need to duplicate that in the title. &quot;Ruby: &quot; is so often seen, and is so often corrected. It is an incorrect way to &quot;tag&quot; a question. You need not, and should not do that."}], "answers": [{"comments": [{"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 2, "creation_date": 1545524336, "post_id": 53900206, "comment_id": 94646091, "body": "It&#39;s best, imo, to put the credit in a comment, to keep the answer clean. For a simple line of code like this there&#39;s no need for the buttons to run or copy the code. It&#39;s just clutter, considering how simple it is for the reader to run or copy the code. Instead just add &quot;prints&quot; and then on the next line, indented 4 spaces <code>[[1, 4], [2, 3]]</code>,  Lastly, surround <code>puts</code>, <code>p</code> and <code>to_a</code> with backticks, rather than quotes (and terminate that sentence with a period). btw, don&#39;t forget there&#39;s an &quot;edit&quot; button on the question (to change &quot;set&quot; to &quot;array&quot;, for example)."}], "tags": [], "owner": {"reputation": 133, "user_id": 5219792, "user_type": "registered", "profile_image": "https://graph.facebook.com/10207554199792913/picture?type=large", "display_name": "Alfatah Kader", "link": "https://stackoverflow.com/users/5219792/alfatah-kader"}, "is_accepted": false, "score": 0, "last_activity_date": 1545524556, "last_edit_date": 1545524556, "creation_date": 1545523340, "answer_id": 53900206, "question_id": 53899669, "link": "https://stackoverflow.com/questions/53899669/ruby-how-to-show-hash-keys-and-values-as-an-array/53900206#53900206", "title": "Ruby: how to show hash keys and values as an array", "body": "<p>Credit: @SergioTulentsev</p>\n\n<p>A correction was needed in final line to:</p>\n\n<pre><code>p two_sum(array, x).to_a\n</code></pre>\n\n<p>Instead of \"puts\", \"p\" and suffix .to_a solved the issue</p>\n"}], "owner": {"reputation": 133, "user_id": 5219792, "user_type": "registered", "profile_image": "https://graph.facebook.com/10207554199792913/picture?type=large", "display_name": "Alfatah Kader", "link": "https://stackoverflow.com/users/5219792/alfatah-kader"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 101, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1545852790, "creation_date": 1545517039, "last_edit_date": 1545852790, "question_id": 53899669, "link": "https://stackoverflow.com/questions/53899669/ruby-how-to-show-hash-keys-and-values-as-an-array", "title": "Ruby: how to show hash keys and values as an array", "body": "<p>I want to display my answer hash keys and values as an array (in normal English, we call it a 'set of answers'; not to be confused with programming term 'set' which is different). So, instead of <code>{a =&gt; 12} {b =&gt; 10}</code>, I can show <code>[a, 12] [b, 10]</code>.</p>\n\n<p>I know how to print/return the values, but I want to show the keys for the corresponding values as well.</p>\n\n<p>I am checking a bunch of numbers in an array to see which of them add up to a number I am looking for. For example: ([1, 2, 3, 4, 5], 6). I can get the function to do all the operations and give me the result. But I want the result to be displayed as an array of answers (or in English, 'a set of answers'), not just as hash. So, for the above example, the answer would look like: <code>[1, 5] [2,4]</code>.</p>\n\n<pre><code>array = [1, 2, 3, 4]\nx = 5\n\ndef two_sum(array, x)\n  set_nums = {}\n  array.each do |y|\n    difference = x - y\n    if set_nums[difference]\n      return set_nums\n    end\n    set_nums[y] = difference\n  end\n  return 'unable to find pairs'\nend\nputs two_sum(array, x)\n</code></pre>\n\n<p>I want to get <code>[1, 4], [2, 3]</code></p>\n\n<p>Actual now: <code>{1=&gt;4, 2=&gt;3}</code></p>\n"}, {"tags": ["ruby-on-rails", "json", "ruby", "gson", "json-deserialization"], "comments": [{"owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 1, "creation_date": 1545514039, "post_id": 53899249, "comment_id": 94644279, "body": "What is wrong with <a href=\"https://ruby-doc.org/stdlib-2.5.2/libdoc/json/rdoc/JSON.html#module-JSON-label-Parsing+JSON\" rel=\"nofollow noreferrer\"><code>JSON.parse</code></a>?"}, {"owner": {"reputation": 1322, "user_id": 783893, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/f322671354ed6a6b1135e6c69d9edd8a?s=128&d=identicon&r=PG", "display_name": "Vineel", "link": "https://stackoverflow.com/users/783893/vineel"}, "reply_to_user": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 2, "creation_date": 1545514385, "post_id": 53899249, "comment_id": 94644353, "body": "You will get an HashMap from JSON Parse, not the custom/domain object representation ASFAIK. @spickermann"}, {"owner": {"reputation": 4688, "user_id": 6241184, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/1022848011119215/picture?type=large", "display_name": "Vinicius Brasil", "link": "https://stackoverflow.com/users/6241184/vinicius-brasil"}, "edited": false, "score": 0, "creation_date": 1545514771, "post_id": 53899249, "comment_id": 94644449, "body": "@Vineel Rubists deal differently with objects. Do you really need a &quot;custom/domain&quot; object representation?"}, {"owner": {"reputation": 1322, "user_id": 783893, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/f322671354ed6a6b1135e6c69d9edd8a?s=128&d=identicon&r=PG", "display_name": "Vineel", "link": "https://stackoverflow.com/users/783893/vineel"}, "reply_to_user": {"reputation": 4688, "user_id": 6241184, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/1022848011119215/picture?type=large", "display_name": "Vinicius Brasil", "link": "https://stackoverflow.com/users/6241184/vinicius-brasil"}, "edited": false, "score": 0, "creation_date": 1545514939, "post_id": 53899249, "comment_id": 94644474, "body": "@vnbrs what makes you think that we never need &quot;domain&quot; object back from JSON String ? Isn&#39;t there such an  utility in Ruby?"}, {"owner": {"reputation": 4688, "user_id": 6241184, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/1022848011119215/picture?type=large", "display_name": "Vinicius Brasil", "link": "https://stackoverflow.com/users/6241184/vinicius-brasil"}, "edited": false, "score": 0, "creation_date": 1545515150, "post_id": 53899249, "comment_id": 94644506, "body": "@Vineel the fact Ruby is not Java in terms of data typing (dynamic + strong typing) =). Btw, I did NOT say that we never need &quot;domain&quot;."}, {"owner": {"reputation": 6462, "user_id": 3784008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/55ou4.jpg?s=128&g=1", "display_name": "anothermh", "link": "https://stackoverflow.com/users/3784008/anothermh"}, "reply_to_user": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 0, "creation_date": 1545521728, "post_id": 53899249, "comment_id": 94645711, "body": "I still don&#39;t see a reason why <code>JSON.parse</code> doesn&#39;t answer this question, as @spickermann said."}, {"owner": {"reputation": 1322, "user_id": 783893, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/f322671354ed6a6b1135e6c69d9edd8a?s=128&d=identicon&r=PG", "display_name": "Vineel", "link": "https://stackoverflow.com/users/783893/vineel"}, "edited": false, "score": 0, "creation_date": 1545529028, "post_id": 53899249, "comment_id": 94646640, "body": "I was wondering if we can mention that we want it to be De-serialized it to a certain type of object."}], "answers": [{"comments": [{"owner": {"reputation": 2151, "user_id": 10068463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c3df811097b7fb8fef67238aad1151ca?s=128&d=identicon&r=PG&f=1", "display_name": "Nate", "link": "https://stackoverflow.com/users/10068463/nate"}, "edited": false, "score": 3, "creation_date": 1545514451, "post_id": 53899416, "comment_id": 94644373, "body": "Note: depending on how much performance matters to you, OpenStruct WILL slow you down over just using a Hash, or using a class or Struct. You may want to benchmark things at some point."}, {"owner": {"reputation": 1322, "user_id": 783893, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/f322671354ed6a6b1135e6c69d9edd8a?s=128&d=identicon&r=PG", "display_name": "Vineel", "link": "https://stackoverflow.com/users/783893/vineel"}, "edited": false, "score": 0, "creation_date": 1545514648, "post_id": 53899416, "comment_id": 94644419, "body": "@vnbrs Upon opening the link, this is what I see. &quot;Maintenance of Ruby 2.0.0 ended on February 24, 2016.&quot;"}, {"owner": {"reputation": 6462, "user_id": 3784008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/55ou4.jpg?s=128&g=1", "display_name": "anothermh", "link": "https://stackoverflow.com/users/3784008/anothermh"}, "edited": false, "score": 1, "creation_date": 1545530030, "post_id": 53899416, "comment_id": 94646740, "body": "I would use <a href=\"https://github.com/intridea/hashie\" rel=\"nofollow noreferrer\">hashie</a> before this. I\u2019ve literally never seen someone use OpenStruct in production code anywhere, ever."}, {"owner": {"reputation": 4688, "user_id": 6241184, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/1022848011119215/picture?type=large", "display_name": "Vinicius Brasil", "link": "https://stackoverflow.com/users/6241184/vinicius-brasil"}, "edited": false, "score": 0, "creation_date": 1545530358, "post_id": 53899416, "comment_id": 94646773, "body": "Well, if you use Rails, you use OpenStruct, as Rails uses it in some parts of Active Storage, if I can recall correctly. Ruby plain Struct may be an alternative. It doesn&#39;t have this deep recursion OpenStruct has."}], "tags": [], "owner": {"reputation": 4688, "user_id": 6241184, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/1022848011119215/picture?type=large", "display_name": "Vinicius Brasil", "link": "https://stackoverflow.com/users/6241184/vinicius-brasil"}, "is_accepted": false, "score": 6, "last_activity_date": 1545514877, "last_edit_date": 1545514877, "creation_date": 1545514091, "answer_id": 53899416, "question_id": 53899249, "link": "https://stackoverflow.com/questions/53899249/json-deserialization-in-ruby/53899416#53899416", "title": "JSON Deserialization in Ruby", "body": "<p>You can convert it into a Hash using the JSON module:</p>\n\n<pre><code>require 'json'\n\nhash = JSON.parse('{\"age\":18, \"name\":\"Vinicius\"}')\nhash[\"age\"]\n=&gt; 18\n</code></pre>\n\n<p>If you want to convert it to a \"structured\" object, you can use OpenStruct:</p>\n\n<pre><code>require 'json'\nrequire 'ostruct'\n\nperson = JSON.parse('{\"age\":18, \"name\":\"Vinicius\"}', object_class: OpenStruct)\nperson.name\n=&gt; \"Vinicius\"\n</code></pre>\n\n<blockquote>\n  <p>An OpenStruct is a data structure, similar to a Hash, that allows the definition of arbitrary attributes with their accompanying values. This is accomplished by using Ruby's metaprogramming to define methods on the class itself. <a href=\"https://ruby-doc.org/stdlib-2.5.3/libdoc/ostruct/rdoc/OpenStruct.html\" rel=\"noreferrer\">(docs)</a></p>\n</blockquote>\n\n<p>OpenStruct may help you if you don't always know the JSON keys, as it dynamically creates an object.</p>\n"}, {"tags": [], "owner": {"reputation": 1377, "user_id": 3011280, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/mkyAT.jpg?s=128&g=1", "display_name": "Oshan Wisumperuma", "link": "https://stackoverflow.com/users/3011280/oshan-wisumperuma"}, "is_accepted": true, "score": 4, "last_activity_date": 1587654214, "last_edit_date": 1587654214, "creation_date": 1549176792, "answer_id": 54500640, "question_id": 53899249, "link": "https://stackoverflow.com/questions/53899249/json-deserialization-in-ruby/54500640#54500640", "title": "JSON Deserialization in Ruby", "body": "<p><a href=\"http://jsonapi-rb.org/guides/deserialization/deserializing.html\" rel=\"nofollow noreferrer\">jsonapi-rb</a></p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>    DeserializablePost.call(json_hash)\n</code></pre>\n\n<p><a href=\"https://github.com/trailblazer/roar#introduction\" rel=\"nofollow noreferrer\">roar</a></p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>    song = Song.new(title: \"Medicine Balls\")\n    SongRepresenter.new(song).from_json('{\"title\":\"Linoleum\"}')\n    song.title #=&gt; Linoleum\n</code></pre>\n\n<p><a href=\"https://github.com/Netflix/fast_jsonapi\" rel=\"nofollow noreferrer\">Netflix - fast_jsonapi</a></p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>    json_string = MovieSerializer.new(movie).serialized_json\n</code></pre>\n"}], "owner": {"reputation": 1322, "user_id": 783893, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/f322671354ed6a6b1135e6c69d9edd8a?s=128&d=identicon&r=PG", "display_name": "Vineel", "link": "https://stackoverflow.com/users/783893/vineel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3283, "favorite_count": 1, "accepted_answer_id": 54500640, "answer_count": 2, "score": 5, "last_activity_date": 1587654214, "creation_date": 1545512329, "question_id": 53899249, "link": "https://stackoverflow.com/questions/53899249/json-deserialization-in-ruby", "title": "JSON Deserialization in Ruby", "body": "<p>Is there a JSON Deserialization equivalent of Java's  Google JSON in Ruby. With-out the necessity of defining any custom serializer or deserializer for each class, one can write a one-line code to convert JSON string into custom Java class as shown here under. </p>\n\n<p><strong><code>Address address=gson.fromJson(addressJsonStringForm, Address.class);</code></strong></p>\n\n<p>To accomplish this , one need-not put any annotations/interfaces in Address class nor write separate Deserializer utility  for every class that we need to deserialize. This  makes it very easy to deserialize/serialize classes from third party libraries. There are quite a lot of options on whether to serialize nulls / include /exclude certain attributes etc. I 'm looking for such a versatile JSON from and to custom object serialization/deserialization utility in Ruby. I 'm new to Ruby.</p>\n\n<p><strong>Reference:</strong> </p>\n\n<p><a href=\"https://dzone.com/articles/deserializing-json-java-object\" rel=\"noreferrer\">https://dzone.com/articles/deserializing-json-java-object</a></p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "edited": false, "score": 0, "creation_date": 1545505875, "post_id": 53898512, "comment_id": 94642623, "body": "Did you notice there&#39;s a missing <code>end</code> keyword in the code you added?"}, {"owner": {"reputation": 6462, "user_id": 3784008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/55ou4.jpg?s=128&g=1", "display_name": "anothermh", "link": "https://stackoverflow.com/users/3784008/anothermh"}, "edited": false, "score": 2, "creation_date": 1545507154, "post_id": 53898512, "comment_id": 94642900, "body": "I have edited your code sample to add indentation and add the missing <code>end</code>. It&#39;s really important that when you post a question on stackoverflow that your code sample be an <a href=\"https://stackoverflow.com/help/mcve\">MCVE</a> -- that includes indentation. It doesn&#39;t make sense to make it harder for people to read your code. Remember that you&#39;re asking volunteers for help."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 1, "creation_date": 1545518212, "post_id": 53898512, "comment_id": 94645096, "body": "If you don&#39;t want simply <code>[11, 22, 33, 44, 55, 66, 77, 66, 55, 44].count(55) #=&gt; 2</code> you need to clarify the question."}], "answers": [{"comments": [{"owner": {"reputation": 6462, "user_id": 3784008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/55ou4.jpg?s=128&g=1", "display_name": "anothermh", "link": "https://stackoverflow.com/users/3784008/anothermh"}, "edited": false, "score": 0, "creation_date": 1545507458, "post_id": 53898587, "comment_id": 94642976, "body": "This is wrong; it returns 2 and <code>nil</code> and the final return value is <code>nil</code>. Run your answer in IRB; you&#39;ll see <code>=&gt; nil</code>."}, {"owner": {"reputation": 449, "user_id": 10739704, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XmWze.jpg?s=128&g=1", "display_name": "nileshkumar", "link": "https://stackoverflow.com/users/10739704/nileshkumar"}, "reply_to_user": {"reputation": 6462, "user_id": 3784008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/55ou4.jpg?s=128&g=1", "display_name": "anothermh", "link": "https://stackoverflow.com/users/3784008/anothermh"}, "edited": false, "score": 0, "creation_date": 1545651025, "post_id": 53898587, "comment_id": 94669264, "body": "@anothermh: Please read @cholis&#39;s question carefully. He is getting 2 and nil at same time as an output. You can try the same code with <code>puts virus([11, 22, 33, 44, 55, 66, 77, 66, 55, 44])</code> at line <a href=\"https://ruby.github.io/TryRuby/\" rel=\"nofollow noreferrer\">ruby.github.io/TryRuby</a>  It will return nil in the next line but  it wont return nil along with 2 at a time. Before down-voting, please verify correctly from  your end..  you can run the code here also:   <a href=\"http://rubyfiddle.com/riddles/ebc5d\" rel=\"nofollow noreferrer\">rubyfiddle.com/riddles/ebc5d</a>"}, {"owner": {"reputation": 6462, "user_id": 3784008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/55ou4.jpg?s=128&g=1", "display_name": "anothermh", "link": "https://stackoverflow.com/users/3784008/anothermh"}, "edited": false, "score": 0, "creation_date": 1545674882, "post_id": 53898587, "comment_id": 94675836, "body": "Have you not run this yourself? The <b>return value</b> of both the <code>p</code> and <code>puts</code> versions you&#39;ve shown is <code>nil</code>, but in your answer you say &quot;<i>It will <b>return</b> 2</i>&quot;. You are wrong and this answer is wrong. Try running the <a href=\"https://stackoverflow.com/a/53898597/3784008\">upvoted answer</a>, which is correct."}], "tags": [], "owner": {"reputation": 449, "user_id": 10739704, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XmWze.jpg?s=128&g=1", "display_name": "nileshkumar", "link": "https://stackoverflow.com/users/10739704/nileshkumar"}, "is_accepted": false, "score": -1, "last_activity_date": 1545654263, "last_edit_date": 1545654263, "creation_date": 1545505801, "answer_id": 53898587, "question_id": 53898512, "link": "https://stackoverflow.com/questions/53898512/how-to-print-out-the-number-of-times-a-certain-number-appears-in-an-array/53898587#53898587", "title": "How to print out the number of times a certain number appears in an array", "body": "<p>Instead of <code>p virus([11, 22, 33, 44, 55, 66, 77, 66, 55, 44])</code>\ntry puts:</p>\n\n<pre><code>def virus(array)\n  index = 0\n  array.length.times do\n    if array[index] % 5\n      puts 2\n      break\n    end\n    index = index + 1\n  end\nend\nputs virus([11, 22, 33, 44, 55, 66, 77, 66, 55, 44])\n</code></pre>\n\n<p>It will return 2 only...</p>\n"}, {"tags": [], "owner": {"reputation": 9663, "user_id": 5239030, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/76JEw.png?s=128&g=1", "display_name": "iGian", "link": "https://stackoverflow.com/users/5239030/igian"}, "is_accepted": false, "score": 2, "last_activity_date": 1545508717, "last_edit_date": 1545508717, "creation_date": 1545505850, "answer_id": 53898597, "question_id": 53898512, "link": "https://stackoverflow.com/questions/53898512/how-to-print-out-the-number-of-times-a-certain-number-appears-in-an-array/53898597#53898597", "title": "How to print out the number of times a certain number appears in an array", "body": "<p>This could be a fix for your code, since you have <code>p 2</code> to print 2 instead of a counter:</p>\n\n<pre><code>def virus(array)\n  index = 0\n  count = 0\n  array.length.times do\n    if array[index]%5 == 0\n      count +=1\n    end\n    index = index + 1\n  end\n  return count\nend\n</code></pre>\n\n<p>You need to add a <code>count</code> variable to be increased if the element is divisible by 5 (<code>if array[index]%5 == 0</code>) or maybe you need to check if element equals 55..</p>\n\n<p>There is no need to break, or you are missing some elements to count. Also the <code>break</code> returns <code>nil</code>, that's why it is printed out.</p>\n\n<p>Finally you need to return the count.</p>\n\n<p>Building a custom loop is a useful way to learn, but I also suggest you take a look at <a href=\"https://ruby-doc.org/core-2.5.0/Enumerable.html#method-i-count\" rel=\"nofollow noreferrer\">https://ruby-doc.org/core-2.5.0/Enumerable.html#method-i-count</a>, just to use Ruby build in methods:</p>\n\n<pre><code>array = [11, 22, 33, 44, 55, 66, 77, 66, 55, 44]\narray.count { |e| e % 5 == 0 } #=&gt; 2\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "is_accepted": false, "score": 0, "last_activity_date": 1545720193, "creation_date": 1545720193, "answer_id": 53919974, "question_id": 53898512, "link": "https://stackoverflow.com/questions/53898512/how-to-print-out-the-number-of-times-a-certain-number-appears-in-an-array/53919974#53919974", "title": "How to print out the number of times a certain number appears in an array", "body": "<pre><code>[11, 22, 33, 44, 55, 66, 77, 66, 55, 44].count(55)\n# =&gt; 2\n</code></pre>\n"}], "owner": {"reputation": 31, "user_id": 10791576, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ee1e2152140d00f4823ebce187b53afd?s=128&d=identicon&r=PG&f=1", "display_name": "Cholis", "link": "https://stackoverflow.com/users/10791576/cholis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 86, "favorite_count": 0, "answer_count": 3, "score": -1, "last_activity_date": 1545720193, "creation_date": 1545505327, "last_edit_date": 1545720142, "question_id": 53898512, "link": "https://stackoverflow.com/questions/53898512/how-to-print-out-the-number-of-times-a-certain-number-appears-in-an-array", "title": "How to print out the number of times a certain number appears in an array", "body": "<p>I am trying to get the number of times <code>55</code> appears in an array.</p>\n\n<p>I tried using a condition to state that if the number is % by 5, to print 2. I also incorporated a break. This is what I have:</p>\n\n<pre><code>def virus(array)\n  index = 0\n  array.length.times do\n    if array[index] % 5\n      p 2\n      break\n    end\n    index = index + 1\n  end\nend\n\np virus([11, 22, 33, 44, 55, 66, 77, 66, 55, 44])\n</code></pre>\n\n<p>My output is supposed to be 2, but I get <code>2</code> and <code>nil</code>.</p>\n"}, {"tags": ["ruby", "http", "sinatra"], "comments": [{"owner": {"reputation": 308, "user_id": 6023124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7718cf4e9d16e02962fd942988ccc9b1?s=128&d=identicon&r=PG&f=1", "display_name": "rcrews", "link": "https://stackoverflow.com/users/6023124/rcrews"}, "edited": false, "score": 0, "creation_date": 1545506199, "post_id": 53897729, "comment_id": 94642703, "body": "Hmm... Turns out that last bit is a red herring. No one is surprised the Accept header is set correctly by curl. It would be helpful to see the (incorrect?) Request headers from the <code>.request(req)</code> commands in the <code>Net::HTTP.start</code> blocks and compare them to the (correct) request headers from <code>Net::HTTP.get_response(uri)</code>."}], "answers": [{"tags": [], "owner": {"reputation": 308, "user_id": 6023124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7718cf4e9d16e02962fd942988ccc9b1?s=128&d=identicon&r=PG&f=1", "display_name": "rcrews", "link": "https://stackoverflow.com/users/6023124/rcrews"}, "is_accepted": true, "score": 0, "last_activity_date": 1545531134, "creation_date": 1545531134, "answer_id": 53900698, "question_id": 53897729, "link": "https://stackoverflow.com/questions/53897729/sending-custom-http-headers-with-ruby/53900698#53900698", "title": "Sending custom HTTP headers with Ruby", "body": "<p>Finally figured it out. When setting up an HTTP request, using the 'https' scheme does not automatically enable TLS/SSL. You must do this explicitly before the request starts. Here's my updated version:</p>\n\n<pre><code>#!/usr/bin/env ruby -w\n# frozen_string_literal: true\n\nrequire 'fileutils'\nrequire 'net/http'\nrequire 'time'\n\ncached_response = 'index.html'                                     # Added\nFileUtils.touch cached_response unless File.exist? cached_response # Added\nuri = URI(\"https://www.apple.com/#{cached_response}\")              # Changed\nfile = File.stat cached_response\n\nreq = Net::HTTP::Get.new(uri)\nreq['If-Modified-Since'] = file.mtime.rfc2822\n\nhttp = Net::HTTP.new(uri.hostname, uri.port)                       # Added\nhttp.use_ssl = uri.scheme == 'https'                               # Added\nres = http.start { |h| h.request(req) }                            # Changed\n\nif res.is_a?(Net::HTTPSuccess)\n  File.open cached_response, 'w' do |io|\n    io.write res.body\n  end\nend\n</code></pre>\n"}], "owner": {"reputation": 308, "user_id": 6023124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7718cf4e9d16e02962fd942988ccc9b1?s=128&d=identicon&r=PG&f=1", "display_name": "rcrews", "link": "https://stackoverflow.com/users/6023124/rcrews"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 133, "favorite_count": 0, "accepted_answer_id": 53900698, "answer_count": 1, "score": 1, "last_activity_date": 1545598661, "creation_date": 1545498666, "last_edit_date": 1545598661, "question_id": 53897729, "link": "https://stackoverflow.com/questions/53897729/sending-custom-http-headers-with-ruby", "title": "Sending custom HTTP headers with Ruby", "body": "<p>I want to send custom headers along with an HTTP request.\nI created the following based on the example at <a href=\"http://ruby-doc.org/stdlib-2.5.3/libdoc/net/http/rdoc/Net/HTTP.html#class-Net::HTTP-label-Setting+Headers\" rel=\"nofollow noreferrer\">ruby-doc, Net::HTTP, Setting Headers</a> but my version fails with \"Connection reset by peer\":</p>\n\n<pre><code>#!/usr/bin/env ruby -w\nrequire 'fileutils'\nrequire 'net/http'\nrequire 'time'\n\ncached_response = 'index.html'                                       # Added\nFileUtils.touch(cached_response) unless File.exist?(cached_response) # Added\nuri = URI(\"https://www.apple.com/#{cached_response}\")                # Changed\nfile = File.stat cached_response\n\nreq = Net::HTTP::Get.new(uri)\nreq['If-Modified-Since'] = file.mtime.rfc2822\n\nres = Net::HTTP.start(uri.hostname, uri.port) {|http|\n  http.request(req)\n}\n\nopen cached_response, 'w' do |io|\n  io.write res.body\nend if res.is_a?(Net::HTTPSuccess)\n</code></pre>\n\n<p>However, sending without the custom header works fine:</p>\n\n<pre><code>#!/usr/bin/env ruby -w\nrequire 'fileutils'\nrequire 'net/http'\nrequire 'time'\n\ncached_response = 'index.html'\nuri = URI(\"https://www.apple.com/#{cached_response}\")\nFileUtils.touch(cached_response) unless File.exist?(cached_response)\nfile = File.stat cached_response\n\nreq = Net::HTTP::Get.new(uri)                                        # Ignored\nreq['If-Modified-Since'] = file.mtime.rfc2822                        # Ignored\n\nres = Net::HTTP.get_response(uri)                                    # Changed\n\nopen cached_response, 'w' do |io|\n  io.write res.body\nend if res.is_a?(Net::HTTPSuccess)\n</code></pre>\n\n<p>Can someone explain why my implementation of the example Ruby code doesn't work?</p>\n\n<p>I added similar code to a couple Sinatra routes:</p>\n\n<pre><code>get '/test1' do\n  uri = URI('https://www.apple.com/index.html')\n  req = Net::HTTP::Get.new(uri)\n  req['Accept'] = request.env['HTTP_ACCEPT']\n  res = Net::HTTP.start(uri.hostname, uri.port) { |h| h.request(req) }\n  headers = res.to_hash\n  headers.delete('transfer-encoding')\n  [res.code.to_i, headers, res.body]\nend\n</code></pre>\n\n<p>then</p>\n\n<pre><code>get '/test2' do\n  uri = URI('https://www.apple.com/index.html')\n  res = Net::HTTP.get_response(uri)\n  headers = res.to_hash\n  headers.delete('transfer-encoding')\n  [res.code.to_i, headers, res.body]\nend\n</code></pre>\n\n<p>With /test1, I get</p>\n\n<pre><code>curl -iv 'http://localhost:9292/test1'\n*   Trying ::1...\n* TCP_NODELAY set\n* Connected to localhost (::1) port 9292 (#0)\n&gt; GET /test1 HTTP/1.1\n&gt; Host: localhost:9292\n&gt; User-Agent: curl/7.54.0\n&gt; Accept: */*\n&gt; \n&lt; HTTP/1.1 500 Internal Server Error \nHTTP/1.1 500 Internal Server Error \n&lt; Content-Type: text/plain\nContent-Type: text/plain\n&lt; Content-Length: 5582\nContent-Length: 5582\n&lt; Server: WEBrick/1.4.2 (Ruby/2.5.0/2018-12-06)\nServer: WEBrick/1.4.2 (Ruby/2.5.0/2018-12-06)\n&lt; Date: Sat, 22 Dec 2018 16:51:03 GMT\nDate: Sat, 22 Dec 2018 16:51:03 GMT\n&lt; Connection: Keep-Alive\nConnection: Keep-Alive\n\n&lt; \nEOFError: end of file reached\n    ...\n* Connection #0 to host localhost left intact\n</code></pre>\n\n<p>With /test2, I get</p>\n\n<pre><code>curl -iv 'http://localhost:9292/test2'\n*   Trying ::1...\n* TCP_NODELAY set\n* Connected to localhost (::1) port 9292 (#0)\n&gt; GET /test2 HTTP/1.1\n&gt; Host: localhost:9292\n&gt; User-Agent: curl/7.54.0\n&gt; Accept: */*\n&gt; \n&lt; HTTP/1.1 200 OK \nHTTP/1.1 200 OK \n...\n&lt;etc. HTML written to console&gt;\n</code></pre>\n\n<p>Looks like the request headers are identical. Same four lines.</p>\n\n<p>If I add the Accept header to the curl command, the request Accept header changes as expected for both, and both return the same results as before (/test1: 500; /test2: 200)</p>\n\n<pre><code>curl -iv -H 'Accept: application/json' 'http://localhost:9292/test2'\n...\n&gt; GET /test2 HTTP/1.1\n&gt; Host: localhost:9292\n&gt; User-Agent: curl/7.54.0\n&gt; Accept: application/json\n</code></pre>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 16237, "user_id": 2166798, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/417356917295f5176d2a3e7c21d8f9e8?s=128&d=identicon&r=PG", "display_name": "pjs", "link": "https://stackoverflow.com/users/2166798/pjs"}, "edited": false, "score": 0, "creation_date": 1545495991, "post_id": 53897305, "comment_id": 94640307, "body": "Be careful with indentation.  Any modern text/programmer&#39;s editor will help you out, and it&#39;s important--not for the computer, but for human readers."}, {"owner": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "edited": false, "score": 1, "creation_date": 1545496980, "post_id": 53897305, "comment_id": 94640536, "body": "<code>(1..14).map { |i| (i * 2.50) + 3 }</code>"}], "answers": [{"comments": [{"owner": {"reputation": 4739, "user_id": 5403468, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZJ8BE.jpg?s=128&g=1", "display_name": "Tiw", "link": "https://stackoverflow.com/users/5403468/tiw"}, "reply_to_user": {"reputation": 5, "user_id": 10592885, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-emgF5nkiezA/AAAAAAAAAAI/AAAAAAAAAAA/ABtNlbCfcOGTOcQjNq2AyXeJvhPSJ1g3mQ/mo/photo.jpg?sz=128", "display_name": "Nicol&#225;s Pojmaevich", "link": "https://stackoverflow.com/users/10592885/nicol%c3%a1s-pojmaevich"}, "edited": false, "score": 0, "creation_date": 1545495967, "post_id": 53897339, "comment_id": 94640296, "body": "@Nicol&#225;sPojmaevich  Sure thing :)"}, {"owner": {"reputation": 3523, "user_id": 9043475, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FNxvn.jpg?s=128&g=1", "display_name": "Rajagopalan", "link": "https://stackoverflow.com/users/9043475/rajagopalan"}, "reply_to_user": {"reputation": 5, "user_id": 10592885, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-emgF5nkiezA/AAAAAAAAAAI/AAAAAAAAAAA/ABtNlbCfcOGTOcQjNq2AyXeJvhPSJ1g3mQ/mo/photo.jpg?sz=128", "display_name": "Nicol&#225;s Pojmaevich", "link": "https://stackoverflow.com/users/10592885/nicol%c3%a1s-pojmaevich"}, "edited": false, "score": 0, "creation_date": 1545498002, "post_id": 53897339, "comment_id": 94640776, "body": "@Nicol&#225;sPojmaevich accept the answer if he answers your question. There is a tic below downvote button which you need to click, it would turn out to be green immediately after your click."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1545503891, "post_id": 53897339, "comment_id": 94642204, "body": "The block variable <code>i</code> is not used so there is no reason to include it. <code>puts &quot;#{x}&quot;</code> can be simplified to <code>puts x</code>. I suggest you simplify to <code>base_times.times { puts x += 2.50 }</code>,"}], "tags": [], "owner": {"reputation": 4739, "user_id": 5403468, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZJ8BE.jpg?s=128&g=1", "display_name": "Tiw", "link": "https://stackoverflow.com/users/5403468/tiw"}, "is_accepted": true, "score": 0, "last_activity_date": 1545495680, "creation_date": 1545495680, "answer_id": 53897339, "question_id": 53897305, "link": "https://stackoverflow.com/questions/53897305/add-a-number-through-out-a-loop/53897339#53897339", "title": "Add a number through out a loop", "body": "<p>It's because of variable scope, you should move x definition out:</p>\n\n<pre><code>base_times=14\nx=3\nbase_times.times do |i|\n    x += 2.50\n    puts \"#{x}\"\nend\n</code></pre>\n\n<p>Also there's syntactic sugar for <code>x = x +</code>, <code>+=</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "is_accepted": false, "score": 0, "last_activity_date": 1545515352, "creation_date": 1545515352, "answer_id": 53899522, "question_id": 53897305, "link": "https://stackoverflow.com/questions/53897305/add-a-number-through-out-a-loop/53899522#53899522", "title": "Add a number through out a loop", "body": "<pre><code>start      = 3\nincrement  = 2.5\nbase_times = 6\n\nenum = (start+increment).step(by: increment)\nbase_times.times { puts enum.next }\n</code></pre>\n\n<p>prints</p>\n\n<pre><code>3.0\n5.5\n8.0\n10.5\n13.0\n15.5\n</code></pre>\n\n<p>See <a href=\"http://ruby-doc.org/core-2.5.1/Numeric.html#method-i-step\" rel=\"nofollow noreferrer\">Numeric#step</a>.</p>\n"}], "owner": {"reputation": 5, "user_id": 10592885, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-emgF5nkiezA/AAAAAAAAAAI/AAAAAAAAAAA/ABtNlbCfcOGTOcQjNq2AyXeJvhPSJ1g3mQ/mo/photo.jpg?sz=128", "display_name": "Nicol&#225;s Pojmaevich", "link": "https://stackoverflow.com/users/10592885/nicol%c3%a1s-pojmaevich"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 58, "favorite_count": 0, "accepted_answer_id": 53897339, "answer_count": 2, "score": -4, "last_activity_date": 1545720425, "creation_date": 1545495378, "last_edit_date": 1545720425, "question_id": 53897305, "link": "https://stackoverflow.com/questions/53897305/add-a-number-through-out-a-loop", "title": "Add a number through out a loop", "body": "<p>I want to iterate 14 times, and add 2.50 to <code>x</code> each time, so the variables change as:</p>\n\n<pre><code>i = 0, x = 5.5\ni = 1, x = 8\ni = 2, x = 10.5\ni = 3, x = 13\n...\n</code></pre>\n\n<p>I did:</p>\n\n<pre><code>base_times = 14\nbase_times.times do |i|\n  x = 3\n  x = x + 2.50\n  puts \"#{x}\"\nend\n</code></pre>\n"}, {"tags": ["ruby", "module", "polymorphism"], "comments": [{"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1545494373, "post_id": 53897123, "comment_id": 94639887, "body": "Ruby does support this, and the code you&#39;ve written should already work. Did you try running it?"}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1545494722, "post_id": 53897123, "comment_id": 94639990, "body": "When you include/inherit from a module/class, ruby places it in the ancestor chain. You can see this by running: <code>self.class.ancestors</code>. Then, every time you call a method, ruby searches through the ancestor chain to find a matching definition. In this case, if you correctly include the <code>Override</code> module, it will be placed <i>before</i> <code>ActiveRecord::Base</code> in the ancestor chain - thereby taking precedence in its method definition. And calling <code>super</code> will still work exact as you&#39;ve written it."}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 1, "creation_date": 1545495079, "post_id": 53897123, "comment_id": 94640076, "body": "To be clear, I can&#39;t say for sure whether the the <i>exact</i> code you&#39;ve written will work, because you haven&#39;t provided a complete code sample. If it doesn&#39;t work, please provide a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> -- because you must only be making a small mistake."}, {"owner": {"reputation": 1299, "user_id": 1130176, "user_type": "registered", "accept_rate": 32, "profile_image": "https://www.gravatar.com/avatar/3618314d500643b06b1b88c8671eb840?s=128&d=identicon&r=PG", "display_name": "user1130176", "link": "https://stackoverflow.com/users/1130176/user1130176"}, "reply_to_user": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1545497599, "post_id": 53897123, "comment_id": 94640688, "body": "I did try this code, and it&#39;s executing both my find and the default find.  Let me write up an example."}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 1, "creation_date": 1545499720, "post_id": 53897123, "comment_id": 94641183, "body": "<code>MyClass.prepend(Override)</code> would work. Also remove all <code>include Override</code> from everywhere."}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1545522372, "post_id": 53897123, "comment_id": 94645809, "body": "Prepend would also work, but there&#39;s no need to do that here."}], "owner": {"reputation": 1299, "user_id": 1130176, "user_type": "registered", "accept_rate": 32, "profile_image": "https://www.gravatar.com/avatar/3618314d500643b06b1b88c8671eb840?s=128&d=identicon&r=PG", "display_name": "user1130176", "link": "https://stackoverflow.com/users/1130176/user1130176"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 82, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1545493948, "creation_date": 1545493948, "question_id": 53897123, "link": "https://stackoverflow.com/questions/53897123/override-instance-method-in-ruby-with-module-instead-of-inheritance", "title": "override instance method in Ruby with module instead of inheritance", "body": "<p>I'm trying to implement a method that overrides an ActiveRecord method (find) but then can also access the original find method.  I'd like to do this without inheritance, using a module.  So what I'm looking for is something like this:</p>\n\n<pre><code>module Override\n    def find args\n        if some_condition\n            do_something\n        else\n            super args # i realize this is not a \"super\" but this is the functionality i seek\n        end\n...\n</code></pre>\n\n<p>and then in my ActiveRecord inherited class</p>\n\n<pre><code>include Override\n\n... # and then business as usual\nMyClass.find(id)\n</code></pre>\n\n<p>Is this possible?  The intent is to have a simple plugin that will enhance the ActiveRecord find method (with cache and other stuff), but the motivation is not my question, I want to know if Ruby supports such an idea.  The benefit of this is that I would not have to build a subclass to sit in between Rails and my class for every single class I wish to enhance with custom find behavior.</p>\n\n<p>Thanks for any help,\nKevin</p>\n"}, {"tags": ["arrays", "ruby"], "answers": [{"comments": [{"owner": {"reputation": 19, "user_id": 10823432, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/96a3eb7845f5318040be557ae1b48abb?s=128&d=identicon&r=PG&f=1", "display_name": "BenBenFaster", "link": "https://stackoverflow.com/users/10823432/benbenfaster"}, "edited": false, "score": 0, "creation_date": 1545513036, "post_id": 53896242, "comment_id": 94644066, "body": "Using target.dup helped in the &quot;checker&quot;. It ran correctly and gave the same output as in Terminal. Thank you"}], "tags": [], "owner": {"reputation": 32451, "user_id": 2516474, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a2179a340c0e84edc285d432211145d?s=128&d=identicon&r=PG", "display_name": "SteveTurczyn", "link": "https://stackoverflow.com/users/2516474/steveturczyn"}, "is_accepted": false, "score": 0, "last_activity_date": 1545486976, "creation_date": 1545486976, "answer_id": 53896242, "question_id": 53896019, "link": "https://stackoverflow.com/questions/53896019/merge-every-n-items-in-an-array/53896242#53896242", "title": "Merge every n items in an array", "body": "<p>I'm not sure what code wars is doing but it may be that it's running your method more than once.  One of the things that your code does is mutate the array <code>target</code> so if you do..</p>\n\n<pre><code>numbers = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]\nletters = ['a', 'b', 'c', 'd']\nmerge_every(numbers, letters, 3)\n=&gt; [1, 2, 3, 'a', 4, 5, 6, 'b', 7, 8, 9, 'c', 10]\n</code></pre>\n\n<p>But then if you check <code>numbers</code> you'll see they're changed...</p>\n\n<pre><code>p numbers\n=&gt; [1, 2, 3, 'a', 4, 5, 6, 'b', 7, 8, 9, 'c', 10]\n</code></pre>\n\n<p>So your numbers array is changed, and every time you run <code>merge_every</code> with the same input object you get a different result (and mutate the <code>numbers</code> array again)</p>\n\n<p>You could try ensuring you run your code on a duplicate (copy) of the array instead of the array itself... an array that looks the same but is a different object. That way when the code mutates <code>target</code> the original input arry is unchanged.</p>\n\n<pre><code>def merge_every(target, source, count=4)\n  target = target.dup\n  ...\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 19, "user_id": 10823432, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/96a3eb7845f5318040be557ae1b48abb?s=128&d=identicon&r=PG&f=1", "display_name": "BenBenFaster", "link": "https://stackoverflow.com/users/10823432/benbenfaster"}, "edited": false, "score": 1, "creation_date": 1545513123, "post_id": 53896441, "comment_id": 94644082, "body": "This helped a lot with refining my code. Thank you. There were a few methods here unknown to me, but I have researched them and combined them with my previous code to produce my final answer.  <code>code</code> def merge_every(target, source, count=4) \tif target.count == 0 || source.count == 0 || count &lt;= 0   \t\ttarget   \telse   \t\ttotal_in_final_array = target.count + target.count / count   \t\ttarget.count % count == 0 ? total_in_final_array -= 1 : total_in_final_array   \t\ttarget.each_slice(count).zip(source).flatten.compact.take(&zwnj;&#8203;total_in_final_array&zwnj;&#8203;)    \tend   end"}], "tags": [], "owner": {"reputation": 9663, "user_id": 5239030, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/76JEw.png?s=128&g=1", "display_name": "iGian", "link": "https://stackoverflow.com/users/5239030/igian"}, "is_accepted": false, "score": 0, "last_activity_date": 1545488578, "creation_date": 1545488578, "answer_id": 53896441, "question_id": 53896019, "link": "https://stackoverflow.com/questions/53896019/merge-every-n-items-in-an-array/53896441#53896441", "title": "Merge every n items in an array", "body": "<p>This is an option using built in features <a href=\"https://ruby-doc.org/core-2.5.0/Enumerable.html#method-i-each_slice\" rel=\"nofollow noreferrer\"><code>Enumerable#each_slice</code></a>, maybe you can test also in codewar to see if there is some issue:</p>\n\n<pre><code>n = 3\nevent_ids.each_slice(n).zip(featured_event_ids).flatten.compact\n#=&gt; [1, 2, 3, \"a\", 4, 5, 6, \"b\", 7]\n</code></pre>\n\n<p>Checking how it works maybe can provide an hint.\nIt is required to add a condition to avoid this result, for example with <code>n=6</code>:</p>\n\n<pre><code>#=&gt; [1, 2, 3, 4, 5, 6, \"a\", 7, \"b\"]\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "is_accepted": false, "score": 0, "last_activity_date": 1545528609, "last_edit_date": 1545528609, "creation_date": 1545527432, "answer_id": 53900475, "question_id": 53896019, "link": "https://stackoverflow.com/questions/53896019/merge-every-n-items-in-an-array/53900475#53900475", "title": "Merge every n items in an array", "body": "<p>If your code passes your tests, but not CodeWar's, the most likely explanation is that your tests are incorrect or, more likely, incomplete.</p>\n\n<p>Here is one Ruby-like way to perform the insertions.</p>\n\n<pre><code>def insert_em(arr, insertions, after_every = 4)\n  return arr if after_every &lt;= 0\n  enum_arr = arr.to_enum\n  isize = insertions.size\n  arr.size.times.with_object([]) do |i,a|\n    a &lt;&lt; enum_arr.next\n    a &lt;&lt; insertions[i/after_every] if\n      i &lt;= after_every*isize &amp;&amp; ((i+1) % after_every).zero?\n  end\nend\n\narr = (1..10).to_a\n\ninsert_em(arr, [:a, :b, :c],  -1)\n  #=&gt; [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]\ninsert_em(arr, [:a, :b, :c],  0)\n  #=&gt; [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]\ninsert_em(arr, [:a, :b, :c],  1)\n  #=&gt; [1, :a, 2, :b, 3, :c, 4, 5, 6, 7, 8, 9, 10]\ninsert_em(arr, [:a, :b, :c],  2)\n  #=&gt; [1, 2, :a, 3, 4, :b, 5, 6, :c, 7, 8, 9, 10]\ninsert_em(arr, [:a, :b, :c],  4)\n  #=&gt; [1, 2, 3, 4, :a, 5, 6, 7, 8, :b, 9, 10]\ninsert_em(arr, [:a, :b, :c],  5)\n  #=&gt; [1, 2, 3, 4, 5, :a, 6, 7, 8, 9, 10, :b]\ninsert_em(arr, [:a, :b, :c], 11)\n  #=&gt; [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]\ninsert_em(arr, [])\n  #=&gt; [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]\ninsert_em([], [:a, :b, :c])\n  #=&gt; []\ninsert_em([], [])\n  #=&gt; []\n</code></pre>\n"}], "owner": {"reputation": 19, "user_id": 10823432, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/96a3eb7845f5318040be557ae1b48abb?s=128&d=identicon&r=PG&f=1", "display_name": "BenBenFaster", "link": "https://stackoverflow.com/users/10823432/benbenfaster"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 115, "favorite_count": 0, "answer_count": 3, "score": 1, "last_activity_date": 1545720820, "creation_date": 1545485096, "last_edit_date": 1545720820, "question_id": 53896019, "link": "https://stackoverflow.com/questions/53896019/merge-every-n-items-in-an-array", "title": "Merge every n items in an array", "body": "<p>I'm trying to solve the following Ruby puzzle on CodeWars:</p>\n\n<blockquote>\n  <p>Write a function called <code>merge_every</code> that accepts 3 arguments: 2 arrays\n  and a number which indicates the amount of items to insert the second\n  arrays items into the first. The third argument is optional and should\n  default to <code>4</code>.</p>\n  \n  <p>Think of it as you have an array of normal events and array of\n  featured events, and you want to merge the two to result in an array\n  of events with a featured one showing up every, say, 3 items.</p>\n\n<pre><code>event_ids = [1, 2, 3, 4, 5, 6, 7]\nfeatured_event_ids = [10, 11]\nmerge_every(event_ids, featured_event_ids, 3)\n# =&gt; [1, 2, 3, 10, 4, 5, 6, 11, 7]\n</code></pre>\n  \n  <p>If the first array should complete before the second, the rest of the\n  second is dropped. Whereas, if the second runs out before the first,\n  the entirety of the first array should be preserved. Should count be 0\n  or less, no items should be inserted and if the target array is empty,\n  than an empty array should be returned.</p>\n  \n  <p>More Examples</p>\n\n<pre><code>numbers = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]\nletters = ['a', 'b', 'c', 'd']\nmerge_every(numbers, letters)\n# =&gt; [1, 2, 3, 4, 'a', 5, 6, 7, 8, 'b', 9, 10]\n\nmerge_every(letters, numbers)\n# =&gt; ['a', 'b', 'c', 'd']\n\nmerge_every(letters, numbers, 2)\n# =&gt; ['a', 'b', 1, 'c', 'd']\n</code></pre>\n</blockquote>\n\n<p>My Solution is:</p>\n\n<pre><code>def merge_every(target, source, count=4)\n\n  count == 0 ? number_of_source_in_target = 0 : number_of_source_in_target = target.count / count\n  insertion_number = count\n  source_number = 0\n\n    if insertion_number == 0 || source.count == 0 || number_of_source_in_target &lt;= 1\n        target\n    elsif target.count % insertion_number == 0\n      number_of_source_in_target -= 1\n      while source_number &lt; number_of_source_in_target &amp;&amp; source_number &lt; source.count do\n        modulo_0_return = target.insert(insertion_number, source[source_number])\n        insertion_number += (count + 1)\n        source_number += 1\n      end\n      modulo_0_return\n    else\n      while source_number &lt; number_of_source_in_target &amp;&amp; source_number &lt; source.count do\n          modulo_numbers_return = target.insert(insertion_number, source[source_number])\n          insertion_number += (count + 1)\n          source_number += 1\n      end\n      modulo_numbers_return\n    end\nend\n\nnumbers = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]\nletters = ['a', 'b', 'c', 'd']\nprint merge_every(numbers, letters, 3)\n</code></pre>\n\n<p>When I run my code on my computer I get the correct answer, but on the CodeWars website, their checker gives a different output. The differences occur with:</p>\n\n<pre><code>merge_every(numbers, letters, 3)\n# My Terminal: [1, 2, 3, 'a', 4, 5, 6, 'b', 7, 8, 9, 'c', 10]\n# CodeWars \"checker\": [1, 2, 3, \"a\", 4, \"a\", 5, \"b\", 6, 7, 8, \"c\", \"b\", 9, 10]\n\nmerge_every(numbers, letters, 1)\n# My Terminal: [1, 'a', 2, 'b', 3, 'c', 4, 'd', 5, 6, 7, 8, 9, 10]\n# CodeWars \"checker\": [1, \"a\", 2, \"b\", 3, \"c\", \"a\", \"d\", 4, \"a\", 5, \"b\", 6, 7, 8, \"c\", \"b\", 9, 10]\n</code></pre>\n\n<p>I can't figure out why. Can anyone help me figure out this discrepancy?</p>\n"}, {"tags": ["ruby"], "answers": [{"comments": [{"owner": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "edited": false, "score": 1, "creation_date": 1545484416, "post_id": 53895849, "comment_id": 94637645, "body": "You have a lot of other ways in <a href=\"https://stackoverflow.com/questions/191329/correct-way-to-populate-an-array-with-a-range-in-ruby/6587096\">older answers</a>. I guess isn&#39;t necessary to create a new question for that."}, {"owner": {"reputation": 2890, "user_id": 1237117, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/H7dfY.jpg?s=128&g=1", "display_name": "mridula", "link": "https://stackoverflow.com/users/1237117/mridula"}, "edited": false, "score": 0, "creation_date": 1545492015, "post_id": 53895849, "comment_id": 94639282, "body": "This won&#39;t return an array. It will just print the nos."}], "tags": [], "owner": {"reputation": 5786, "user_id": 172202, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/8c1438ad2257a6015eaa97ffc496c862?s=128&d=identicon&r=PG", "display_name": "Abe", "link": "https://stackoverflow.com/users/172202/abe"}, "is_accepted": false, "score": 0, "last_activity_date": 1545483473, "creation_date": 1545483473, "answer_id": 53895849, "question_id": 53895824, "link": "https://stackoverflow.com/questions/53895824/rails-convert-number-to-array/53895849#53895849", "title": "Rails - Convert number to array", "body": "<p><a href=\"https://apidock.com/ruby/Integer/times\" rel=\"nofollow noreferrer\">https://apidock.com/ruby/Integer/times</a> pointed me to a solution</p>\n\n<p><code>\npages = 5\n(1..pages).each { |n| puts n }\n</code></p>\n"}, {"tags": [], "owner": {"reputation": 2890, "user_id": 1237117, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/H7dfY.jpg?s=128&g=1", "display_name": "mridula", "link": "https://stackoverflow.com/users/1237117/mridula"}, "is_accepted": false, "score": 3, "last_activity_date": 1545483808, "creation_date": 1545483808, "answer_id": 53895886, "question_id": 53895824, "link": "https://stackoverflow.com/questions/53895824/rails-convert-number-to-array/53895886#53895886", "title": "Rails - Convert number to array", "body": "<pre><code>pages = 5\narray_of_numbers = (1..pages).to_a\n</code></pre>\n\n<p><code>(1..pages)</code> will give you a <a href=\"https://ruby-doc.org/core-2.2.0/Range.html\" rel=\"nofollow noreferrer\">Range</a> object and <code>to_a</code> will convert it into an array.</p>\n"}], "owner": {"reputation": 5786, "user_id": 172202, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/8c1438ad2257a6015eaa97ffc496c862?s=128&d=identicon&r=PG", "display_name": "Abe", "link": "https://stackoverflow.com/users/172202/abe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 268, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1545757437, "creation_date": 1545483244, "last_edit_date": 1545490691, "question_id": 53895824, "link": "https://stackoverflow.com/questions/53895824/rails-convert-number-to-array", "title": "Rails - Convert number to array", "body": "<p>Let's say I have a number 5</p>\n\n<p>How would I convert this to an array <code>[1, 2, 3, 4, 5]</code>?</p>\n\n<p>The application here is I have an instance variable @pages and I want to create a pagination view.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "datetime", "time"], "answers": [{"tags": [], "owner": {"reputation": 702, "user_id": 4000293, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/976ba675f6c7be8be7c327d1adf91fee?s=128&d=identicon&r=PG&f=1", "display_name": "sloneorzeszki", "link": "https://stackoverflow.com/users/4000293/sloneorzeszki"}, "is_accepted": true, "score": 1, "last_activity_date": 1545480118, "last_edit_date": 1545480118, "creation_date": 1545478740, "answer_id": 53895311, "question_id": 53895262, "link": "https://stackoverflow.com/questions/53895262/time-module-in-rails/53895311#53895311", "title": "Time module in Rails", "body": "<p>Time is not taken from user's machine, but rather from the server you run your website on. So you have nothing to worry about. On a side note: it's better to use Time.current instead of Time.now as it also considers the timezones.</p>\n"}], "owner": {"reputation": 35, "user_id": 6023757, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1cf5bd6bfacc8baa247da466794a8773?s=128&d=identicon&r=PG&f=1", "display_name": "Progger", "link": "https://stackoverflow.com/users/6023757/progger"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 32, "favorite_count": 0, "accepted_answer_id": 53895311, "answer_count": 1, "score": -1, "last_activity_date": 1545480118, "creation_date": 1545478245, "question_id": 53895262, "link": "https://stackoverflow.com/questions/53895262/time-module-in-rails", "title": "Time module in Rails", "body": "<p>I'm trying to create an app and I have a question about Time in rails.\nMy app has two models, a user and a post.\nI want to limit the user to only create one post per day. \nI did a validation on Time.now but I'm not sure if it's the right thing to do because a user might change the date on his machine and bypass the validation. </p>\n\n<p>How do I proceed ?</p>\n"}, {"tags": ["ruby", "regex", "string"], "comments": [{"owner": {"reputation": 381813, "user_id": 1863229, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/4sh1l.png?s=128&g=1", "display_name": "Tim Biegeleisen", "link": "https://stackoverflow.com/users/1863229/tim-biegeleisen"}, "edited": false, "score": 0, "creation_date": 1545473994, "post_id": 53894714, "comment_id": 94635539, "body": "Lookarounds won&#39;t work so well here."}, {"owner": {"reputation": 14802, "user_id": 649006, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/30f02cca8b01ab9e60490075b0447ecb?s=128&d=identicon&r=PG", "display_name": "nzifnab", "link": "https://stackoverflow.com/users/649006/nzifnab"}, "reply_to_user": {"reputation": 381813, "user_id": 1863229, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/4sh1l.png?s=128&g=1", "display_name": "Tim Biegeleisen", "link": "https://stackoverflow.com/users/1863229/tim-biegeleisen"}, "edited": false, "score": 0, "creation_date": 1545474129, "post_id": 53894714, "comment_id": 94635562, "body": "I&#39;m somewhat curious about the two close votes here. My question seems pretty concise and clear, what, might I ask, is &quot;too broad&quot; about it? It&#39;s quite a specific question."}, {"owner": {"reputation": 381813, "user_id": 1863229, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/4sh1l.png?s=128&g=1", "display_name": "Tim Biegeleisen", "link": "https://stackoverflow.com/users/1863229/tim-biegeleisen"}, "edited": false, "score": 0, "creation_date": 1545475165, "post_id": 53894714, "comment_id": 94635780, "body": "Regex might not be the best tool for this job.  I might look into using a parser.  The problem here is that the text is not regular, and you don&#39;t know how many words to consume until you have gone over the limit, and backtracked."}, {"owner": {"reputation": 25573, "user_id": 676874, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/c8e67ec01dc3e7c402255ff26785863f?s=128&d=identicon&r=PG", "display_name": "knut", "link": "https://stackoverflow.com/users/676874/knut"}, "edited": false, "score": 0, "creation_date": 1558964874, "post_id": 53894714, "comment_id": 99262252, "body": "See also <a href=\"https://stackoverflow.com/questions/7548968/format-output-to-40-characters-long-per-line/\" title=\"format output to 40 characters long per line\">stackoverflow.com/questions/7548968/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 14802, "user_id": 649006, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/30f02cca8b01ab9e60490075b0447ecb?s=128&d=identicon&r=PG", "display_name": "nzifnab", "link": "https://stackoverflow.com/users/649006/nzifnab"}, "is_accepted": false, "score": 1, "last_activity_date": 1545480147, "creation_date": 1545480147, "answer_id": 53895476, "question_id": 53894714, "link": "https://stackoverflow.com/questions/53894714/insert-newline-only-at-word-breaks-such-that-no-line-exceeds-80-chars/53895476#53895476", "title": "Insert newline ONLY at word breaks such that no line exceeds 80 chars", "body": "<p>I ended up going w/ the word-traversal route:</p>\n\n<pre><code>def wordwrap(content, line_length)\n  words = content.scan(/(?:\\A|\\s)[^\\s]*/)\n  remaining = line_length\n  words.each do |word|\n    if word.length &gt; remaining\n      word.gsub!(/^\\s/, \"\")\n      remaining = line_length - word.length\n      word.insert(0, \"\\n\")\n    else\n      if word =~ /^\\n/\n        remaining = line_length - word.length - 1\n      else\n        remaining -= word.length\n      end\n    end\n  end\n\n  words.join\nend\n</code></pre>\n\n<p>This inserts newlines before words that would otherwise cause the line to exceed <code>line_length</code> characters.</p>\n\n<p>It's a little messier than I was hoping for, but it gets the job done.</p>\n"}, {"comments": [{"owner": {"reputation": 14802, "user_id": 649006, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/30f02cca8b01ab9e60490075b0447ecb?s=128&d=identicon&r=PG", "display_name": "nzifnab", "link": "https://stackoverflow.com/users/649006/nzifnab"}, "edited": false, "score": 0, "creation_date": 1545852503, "post_id": 53922450, "comment_id": 94712692, "body": "This looks promising. I&#39;m doing christmas breaky things right now but I&#39;ll give this a whirl in my project when I get back to it and see how it stacks up :) One of the comments in that apidock page says that it might consume multiple newlines, but this regex is a little different than the <code>collect</code> that&#39;s in the source there. I&#39;ll play with it and let you know :)"}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1571791378, "post_id": 53922450, "comment_id": 103355079, "body": "nzifnab, sawa&#39;s still waiting... If any of the answers have been helpful please consider selecting one."}], "tags": [], "owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "is_accepted": false, "score": 2, "last_activity_date": 1545741383, "creation_date": 1545741383, "answer_id": 53922450, "question_id": 53894714, "link": "https://stackoverflow.com/questions/53894714/insert-newline-only-at-word-breaks-such-that-no-line-exceeds-80-chars/53922450#53922450", "title": "Insert newline ONLY at word breaks such that no line exceeds 80 chars", "body": "<p>The Rails way:</p>\n\n<pre><code>puts content.gsub(/(.{1,10})(?:\\s+|$)/, \"\\\\1\\n\")\n# &gt;&gt;this is\n# &gt;&gt;some\n# &gt;&gt;content\n# &gt;&gt;with words\n# &gt;&gt;and stuff\n# &gt;&gt;and here\n# &gt;&gt;is another\n# &gt;&gt;line\n# &gt;&gt;things\n</code></pre>\n\n<p>Cf. <a href=\"https://apidock.com/rails/ActionView/Helpers/TextHelper/word_wrap\" rel=\"nofollow noreferrer\">https://apidock.com/rails/ActionView/Helpers/TextHelper/word_wrap</a></p>\n"}, {"tags": [], "owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "is_accepted": false, "score": 0, "last_activity_date": 1571791258, "creation_date": 1571791258, "answer_id": 58513964, "question_id": 53894714, "link": "https://stackoverflow.com/questions/53894714/insert-newline-only-at-word-breaks-such-that-no-line-exceeds-80-chars/58513964#58513964", "title": "Insert newline ONLY at word breaks such that no line exceeds 80 chars", "body": "<pre><code>r = /.{,80}[\\n ]/ \n</code></pre>\n\n<h1><p></p></h1>\n\n<pre><code>puts content.gsub(r) { |s| s[0..-2] &lt;&lt; \"\\n\" }\n</code></pre>\n\n<p>displays the following:</p>\n\n<pre><code>Mittens the cat ate a salad on Friday morning. He's a cat, so I'm not really\nsure why he was eating a salad, but that's what he was doing. Do cats normally\nlike salad? It wasn't salmon-flavored or anything crazy like that.\n\nI can think of three reasons why a cat might eat salad:\n1. The cat is insane.\n2. The cat likes mice, and just last week we noticed that a mice was eating some\nsalad, so maybe the cat decided to shortcut the food chain and eat a salad\ninstead of getting the nutrients of the salad from the consumption of the mouse.\n3. Cats are weird.\n</code></pre>\n\n<p>The regular expression matches up to 80 characters followed by a newline or space. Regardless of whether that the last character matched is a space or newline, the last character is replaced by a newline in the block.</p>\n\n<p>For this to work the string may not have multiple spaces in a row and the string must end with a newline character (i.e., <code>\"...weird.\\n\"</code>). If those conditions may not hold a simple preprocessing step may be warranted:</p>\n\n<pre><code>mod_content = content.squeeze(' ').chomp &lt;&lt; \"\\n\"\n</code></pre>\n"}], "owner": {"reputation": 14802, "user_id": 649006, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/30f02cca8b01ab9e60490075b0447ecb?s=128&d=identicon&r=PG", "display_name": "nzifnab", "link": "https://stackoverflow.com/users/649006/nzifnab"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 61, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1571791258, "creation_date": 1545473197, "last_edit_date": 1545474714, "question_id": 53894714, "link": "https://stackoverflow.com/questions/53894714/insert-newline-only-at-word-breaks-such-that-no-line-exceeds-80-chars", "title": "Insert newline ONLY at word breaks such that no line exceeds 80 chars", "body": "<p>I have various blocks of text of variable length that may or may not already have several line breaks in them. I want to take each line of this text, and insert additional newlines but ONLY at word-breaks (spaces) so that no line exceeds 80 chars. They can be under 80, but I want them as close to 80 characters as possible without going over, and without chopping a word in half.</p>\n\n<p>Here's what some sample content might look like:</p>\n\n<pre><code>\"\"\"\nMittens the cat ate a salad on Friday morning. He's a cat, so I'm not really sure why he was eating a salad, but that's what he was doing. Do cats normally like salad? It wasn't salmon-flavored or anything crazy like that.\n\nI can think of three reasons why a cat might eat salad:\n1. The cat is insane\n2. The cat likes mice, and just last week we noticed that a mice was eating some salad, so maybe the cat decided to shortcut the food chain and eat a salad instead of getting the nutrients of the salad from the consumption of the mouse.\n3. Cats are weird.\n\"\"\"\n</code></pre>\n\n<p>And after running the newline-inserter, it would come out like this:</p>\n\n<pre><code>\"\"\"\nMittens the cat ate a salad on Friday morning. He's a cat, so I'm not really\nsure why he was eating a salad, but that's what he was doing. Do cats normally\nlike salad? It wasn't salmon-flavored or anything crazy like that.\n\nI can think of three reasons why a cat might eat salad:\n1. The cat is insane\n2. The cat likes mice, and just last week we noticed that a mice was eating some\nsalad, so maybe the cat decided to shortcut the food chain and eat a salad\ninstead of getting the nutrients of the salad from the consumption of the mouse.\n3. Cats are weird.\n\"\"\"\n</code></pre>\n\n<p>I found several questions solving the (frankly trivial) problem of adding a newline at exactly N characters. I know that I can split on space and <em>count</em> the characters and backtrack to add a newline if a line exceeds 80 characters, but that's tedious and not quite the \"elegant\" solution I'm looking for ;p</p>\n\n<p>I'll go that route if I can't figure out a better way, though.... I guess.</p>\n\n<p>My gut tells me there's a good solution for this using regex and look-aheads/look-behinds.</p>\n\n<p>This is what I have so far:</p>\n\n<pre><code>content = \"\"\"\nthis is some content with words and stuff\nand here is another line things\n\"\"\"\ncontent = content.gsub(%r{(.{10}) }, \"\\\\1\\n\")\nputs content\n</code></pre>\n\n<p>Which outputs:</p>\n\n<pre><code>this is some\ncontent with\nwords and stuff\nand here is\nanother line\nthings\n</code></pre>\n\n<p>But it's letting the lines go barely <em>above</em> 10 chars, instead of barely below it.</p>\n"}, {"tags": ["ruby", "postgresql", "rubygems", "sinatra", "windows-subsystem-for-linux"], "comments": [{"owner": {"reputation": 6462, "user_id": 3784008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/55ou4.jpg?s=128&g=1", "display_name": "anothermh", "link": "https://stackoverflow.com/users/3784008/anothermh"}, "edited": false, "score": 0, "creation_date": 1545520820, "post_id": 53894630, "comment_id": 94645556, "body": "What <code>require</code> lines exist in <code>main.rb</code>? What tutorial are you following?"}, {"owner": {"reputation": 139, "user_id": 10809113, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-6At-0l8lnSc/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-g9X6dY7bVguQPi1yhCXLM6iYHudA/mo/photo.jpg?sz=128", "display_name": "JHero23", "link": "https://stackoverflow.com/users/10809113/jhero23"}, "reply_to_user": {"reputation": 6462, "user_id": 3784008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/55ou4.jpg?s=128&g=1", "display_name": "anothermh", "link": "https://stackoverflow.com/users/3784008/anothermh"}, "edited": false, "score": 0, "creation_date": 1545521093, "post_id": 53894630, "comment_id": 94645598, "body": "require &quot;sinatra&quot; require &quot;sinatra/contrib&quot; if development? require &#39;sinatra/flash&#39; require &quot;pony&quot; require &quot;slim&quot; require &quot;sass&quot; require &quot;./song&quot; require &#39;./sinatra/auth&#39; require &#39;v8&#39; require &#39;coffee-script&#39;  I&#39;m following the jumpstart sinatra book."}, {"owner": {"reputation": 6462, "user_id": 3784008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/55ou4.jpg?s=128&g=1", "display_name": "anothermh", "link": "https://stackoverflow.com/users/3784008/anothermh"}, "edited": false, "score": 0, "creation_date": 1545521461, "post_id": 53894630, "comment_id": 94645669, "body": "That&#39;s quite difficult to read so you should move that information into your question. What happens if you add <code>require &#39;dm-postgres-adapter&#39;</code>?"}, {"owner": {"reputation": 139, "user_id": 10809113, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-6At-0l8lnSc/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-g9X6dY7bVguQPi1yhCXLM6iYHudA/mo/photo.jpg?sz=128", "display_name": "JHero23", "link": "https://stackoverflow.com/users/10809113/jhero23"}, "reply_to_user": {"reputation": 6462, "user_id": 3784008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/55ou4.jpg?s=128&g=1", "display_name": "anothermh", "link": "https://stackoverflow.com/users/3784008/anothermh"}, "edited": false, "score": 0, "creation_date": 1545522312, "post_id": 53894630, "comment_id": 94645801, "body": "same error, just that this time the error is in the require section."}, {"owner": {"reputation": 6462, "user_id": 3784008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/55ou4.jpg?s=128&g=1", "display_name": "anothermh", "link": "https://stackoverflow.com/users/3784008/anothermh"}, "edited": false, "score": 0, "creation_date": 1545524434, "post_id": 53894630, "comment_id": 94646100, "body": "Not sure, I&#39;d suggest going through the guide you&#39;re using with a fine toothed comb and make sure you&#39;re following every step exactly in order."}], "answers": [{"comments": [{"owner": {"reputation": 139, "user_id": 10809113, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-6At-0l8lnSc/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-g9X6dY7bVguQPi1yhCXLM6iYHudA/mo/photo.jpg?sz=128", "display_name": "JHero23", "link": "https://stackoverflow.com/users/10809113/jhero23"}, "edited": false, "score": 0, "creation_date": 1559184352, "post_id": 55929226, "comment_id": 99344289, "body": "T_T .....THANK YOU, I&#39;VE BEEN STRUGGLING WITH THAT FOR OVER ALMOST A YEAR NOW, and it worked"}], "tags": [], "owner": {"reputation": 180, "user_id": 8659405, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ICOCH.gif?s=128&g=1", "display_name": "J.R. Bob Dobbs", "link": "https://stackoverflow.com/users/8659405/j-r-bob-dobbs"}, "is_accepted": true, "score": 0, "last_activity_date": 1556661903, "creation_date": 1556661903, "answer_id": 55929226, "question_id": 53894630, "link": "https://stackoverflow.com/questions/53894630/loaderror-cannot-find-dm-postgres-adapter-when-using-heroku-run-console/55929226#55929226", "title": "LoadError cannot find dm-postgres-adapter when using Heroku Run Console", "body": "<p>I was getting the same errors. Don't ignore the Warnings from Heroku when you push to heroku.</p>\n\n<p>If you're using Git (which you probably are) you'll need to first remove the .bundle/ folder via the command line:</p>\n\n<p>git rm --cached -r .bundle/</p>\n\n<p>Then you'll need to add a .gitignore file in the main directory with \".bundle/\" in the body of the file</p>\n\n<p>Commit it all to git and/or github.\nPush to Heroku. (no more nasty warning RE the .bundle/ folder)</p>\n\n<p>Then run your heroku run console command and pick up with the Jumpstart tutorial again. </p>\n"}], "owner": {"reputation": 139, "user_id": 10809113, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-6At-0l8lnSc/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-g9X6dY7bVguQPi1yhCXLM6iYHudA/mo/photo.jpg?sz=128", "display_name": "JHero23", "link": "https://stackoverflow.com/users/10809113/jhero23"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 120, "favorite_count": 0, "accepted_answer_id": 55929226, "answer_count": 1, "score": 0, "last_activity_date": 1556661903, "creation_date": 1545472251, "question_id": 53894630, "link": "https://stackoverflow.com/questions/53894630/loaderror-cannot-find-dm-postgres-adapter-when-using-heroku-run-console", "title": "LoadError cannot find dm-postgres-adapter when using Heroku Run Console", "body": "<p>I am on WSL, working on Ruby on Sinatra web application training, when I require the './main' on heroku run console command, I get LoadError and it can't require 'dm-postgres-adapter.</p>\n\n<p>I have been following a tutorial, using WSL, I installed Ruby along with its dependencies, so far all the gems I've installed were successful. But when I push to heroku and when I run the 'heroku run console' command, and I type in 'require \"./main\"' I get a LoadError, telling me...</p>\n\n<pre>joelg@SurfacePro3:~/RubyProgs/SinatraExcercise$ heroku run console<br>\nRunning console on \u2b22 sinatra-project-jg... up, run.2550 (Free)<br>\nirb(main):001:0> require './main'<br>\nWARNING: If you plan to load any of ActiveSupport's core extensions to Hash, be\nsure to do so *before* loading Sinatra::Application or Sinatra::Base. If not,\nyou may disregard this warning.\nLoadError: cannot load such file -- dm-postgres-adapter\n        from /app/vendor/bundle/ruby/2.4.0/gems/dm-core-1.2.1/lib/dm-core/adapters.rb:163:in `require'\n        from /app/vendor/bundle/ruby/2.4.0/gems/dm-core-1.2.1/lib/dm-core/adapters.rb:163:in `load_adapter'\n        from /app/vendor/bundle/ruby/2.4.0/gems/dm-core-1.2.1/lib/dm-core/adapters.rb:133:in `adapter_class'\n        from /app/vendor/bundle/ruby/2.4.0/gems/dm-core-1.2.1/lib/dm-core/adapters.rb:13:in `new'\n        from /app/vendor/bundle/ruby/2.4.0/gems/dm-core-1.2.1/lib/dm-core.rb:230:in `setup'\n        from /app/main.rb:21:in `block in '\n        from /app/vendor/bundle/ruby/2.4.0/gems/sinatra-2.0.4/lib/sinatra/base.rb:1426:in `configure'\n        from /app/vendor/bundle/ruby/2.4.0/gems/sinatra-2.0.4/lib/sinatra/base.rb:1925:in `block (2 levels) in delegate'\n        from /app/main.rb:20:in `'\n        from (irb):1:in `require'\n        from (irb):1\n        from /app/bin/irb:15:in `'\nirb(main):002:0>\n</pre>\n\n<p>When I ran it said that dm-postgres-adapter is not required, but it is I have it loaded on my Gemfile.</p>\n"}, {"tags": ["ruby"], "answers": [{"tags": [], "owner": {"reputation": 230, "user_id": 1486234, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/945e89ebc5ab747e075d67c0058ee26f?s=128&d=identicon&r=PG", "display_name": "giglemad", "link": "https://stackoverflow.com/users/1486234/giglemad"}, "is_accepted": false, "score": 0, "last_activity_date": 1545480693, "creation_date": 1545480693, "answer_id": 53895539, "question_id": 53893724, "link": "https://stackoverflow.com/questions/53893724/how-to-require-local-library-mysql2-in-ruby-project/53895539#53895539", "title": "How to require local library mysql2 in ruby project", "body": "<p>Using options is not enough : you need to configure bundler so it can remember it. Here is what the <a href=\"https://bundler.io/v1.17/man/bundle-config.1.html#REMEMBERING-OPTIONS\" rel=\"nofollow noreferrer\">documentation</a> says : </p>\n\n<pre><code>Flags passed to bundle install or the Bundler runtime, such as --path foo or \n--without production, are not remembered between commands. If these options \nmust be remembered, they must be set using bundle config (e.g., bundle config \npath foo).\n</code></pre>\n\n<p>Until you do that, bundler is going to ignore the local installation that you did and still try to fetch gems like it does usually i.e. not in the <code>vendor/bundle</code> path. Hence the failure</p>\n"}], "owner": {"reputation": 51, "user_id": 8070579, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9f8b848080ebd37cd3a81c5729cb4ebf?s=128&d=identicon&r=PG&f=1", "display_name": "sdas199421", "link": "https://stackoverflow.com/users/8070579/sdas199421"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 96, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1545480693, "creation_date": 1545462213, "question_id": 53893724, "link": "https://stackoverflow.com/questions/53893724/how-to-require-local-library-mysql2-in-ruby-project", "title": "How to require local library mysql2 in ruby project", "body": "<p>I have used bundler \"bundle install --path vendor/bundle\" to install my gem mysql2 in my project.</p>\n\n<p>My Gemfile was like this </p>\n\n<pre><code>source 'https://rubygems.org'\ngem 'mysql2', '~&gt; 0.3.20'\n</code></pre>\n\n<p>Now i want to require this gem in my ruby script but it is not working. Always shows \"no such file mysql2\".</p>\n\n<p>My code is like this</p>\n\n<pre><code>require 'json'\n    load_paths = Dir.pwd + \"/vendor/bundle/ruby/2.5.0/gems/\"\n    $LOAD_PATH.unshift(*load_paths)\n    require 'mysql2'\n\ndef lambda_handler(event:, context:)\n    # # TODO implement\n    @db_host  = \"host\"\n    @db_user  = \"user\"\n    @db_pass  = \"pass\"\n    @db_name = \"db\"\n\n    client = Mysql2::Client.new(:host =&gt; @db_host, :username =&gt; @db_user, :password =&gt; @db_pass, :database =&gt; @db_name)\n    @cdr_result = client.query(\"SELECT count(*) from table_name\")\n    puts @cdr_result\n    { statusCode: 200, body: JSON.generate('Hello from Lambda!') }\n\n end\n</code></pre>\n\n<p>error is comming like this</p>\n\n<pre><code>Traceback (most recent call last):\n        2: from replaceFile.rb:4:in `&lt;main&gt;'\n        1: from /home/vagrant/.rvm/rubies/ruby-2.5.0/lib/ruby/2.5.0/rubygems/core_ext/kernel_require.rb:59:in `require'\n/home/vagrant/.rvm/rubies/ruby-2.5.0/lib/ruby/2.5.0/rubygems/core_ext/kernel_require.rb:59:in `require': cannot load such file -- mysql2 (LoadError)\n</code></pre>\n\n<p>I am using ruby version = ruby 2.5.0p0 (2017-12-25 revision 61468) [x86_64-linux]</p>\n"}, {"tags": ["ruby"], "answers": [{"comments": [{"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1545453677, "post_id": 53893000, "comment_id": 94632621, "body": "<code>arr + arr.map { |e, *rest| [e + 2, *rest] }</code>"}, {"owner": {"reputation": 5, "user_id": 10592885, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-emgF5nkiezA/AAAAAAAAAAI/AAAAAAAAAAA/ABtNlbCfcOGTOcQjNq2AyXeJvhPSJ1g3mQ/mo/photo.jpg?sz=128", "display_name": "Nicol&#225;s Pojmaevich", "link": "https://stackoverflow.com/users/10592885/nicol%c3%a1s-pojmaevich"}, "edited": false, "score": 0, "creation_date": 1545495563, "post_id": 53893000, "comment_id": 94640204, "body": "Hi thanks for the comments, I solved it using the api inside sketchup, I need it to work with vectors, of course where talking about x,y,z points my mistake....thanks for all your help anyway....."}], "tags": [], "owner": {"reputation": 2496, "user_id": 3046905, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/692eb06201cbed91c3c6a9cf11ed0511?s=128&d=identicon&r=PG", "display_name": "Ilya Konyukhov", "link": "https://stackoverflow.com/users/3046905/ilya-konyukhov"}, "is_accepted": false, "score": 0, "last_activity_date": 1545452256, "creation_date": 1545452256, "answer_id": 53893000, "question_id": 53892924, "link": "https://stackoverflow.com/questions/53892924/displace-an-element-in-array-by-sum/53893000#53893000", "title": "displace an element in array by sum", "body": "<p>Like this?</p>\n\n<pre><code>arr = [[2.99213, 0, 0], [2.93025, 0.0031909, 0], [2.86903, 0.0127298, 0], [2.80912, 0.0285154, 0]]\narr + arr.map { |k| [k[0]+2] + k[1..-1] }\n\n# =&gt; [[2.99213, 0, 0], [2.93025, 0.0031909, 0], [2.86903, 0.0127298, 0], [2.80912, 0.0285154, 0], [4.9921299999999995, 0, 0], [4.93025, 0.0031909, 0], [4.86903, 0.0127298, 0], [4.80912, 0.0285154, 0]] \n</code></pre>\n"}], "owner": {"reputation": 5, "user_id": 10592885, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-emgF5nkiezA/AAAAAAAAAAI/AAAAAAAAAAA/ABtNlbCfcOGTOcQjNq2AyXeJvhPSJ1g3mQ/mo/photo.jpg?sz=128", "display_name": "Nicol&#225;s Pojmaevich", "link": "https://stackoverflow.com/users/10592885/nicol%c3%a1s-pojmaevich"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 55, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1545464464, "creation_date": 1545450954, "last_edit_date": 1545452860, "question_id": 53892924, "link": "https://stackoverflow.com/questions/53892924/displace-an-element-in-array-by-sum", "title": "displace an element in array by sum", "body": "<p>I am trying to displace an array by adding a value to every element and then adding those new values to the array (array are x,y,z > sketchup) example:</p>\n\n<pre><code>arr = [[2.99213, 0, 0],\n       [2.93025, 0.0031909, 0],\n       [2.86903, 0.0127298, 0],\n       [2.80912, 0.0285154, 0]]\n</code></pre>\n\n<p>Adding <strong>2</strong> to every first element to get this:</p>\n\n<pre><code>arr = [[4.99213, 0, 0],\n       [4.93025, 0.0031909, 0],\n       [4.86903, 0.0127298, 0],\n       [4.80912, 0.0285154, 0]]\n</code></pre>\n\n<p>finally, adding the two arrays:</p>\n\n<pre><code>arr = [[2.99213, 0, 0],\n       [2.93025, 0.0031909, 0],\n       [2.86903, 0.0127298, 0],\n       [2.80912, 0.0285154, 0],\n       [4.99213, 0, 0],\n       [4.93025, 0.0031909, 0],\n       [4.86903, 0.0127298, 0],\n       [4.80912, 0.0285154, 0]]\n</code></pre>\n"}, {"tags": ["ruby", "sorting", "hash", "hashmap", "find-occurrences"], "answers": [{"comments": [{"owner": {"reputation": 133, "user_id": 5219792, "user_type": "registered", "profile_image": "https://graph.facebook.com/10207554199792913/picture?type=large", "display_name": "Alfatah Kader", "link": "https://stackoverflow.com/users/5219792/alfatah-kader"}, "edited": false, "score": 0, "creation_date": 1545442705, "post_id": 53892372, "comment_id": 94631490, "body": "Opps, its giving me a count for white (blank space). Nope, wait. Fixed it. I went back and reduced space in .gsub(/\\W/,&quot;  &quot;) to (/\\W/,&quot;&quot;) and that did the trick. Thanks!"}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1545446465, "post_id": 53892372, "comment_id": 94631879, "body": "You could replace <code>split(&#39;&#39;)</code> with <code>chars</code> or, better, <code>each_char</code>, which returns an enumerator.."}], "tags": [], "owner": {"reputation": 4348, "user_id": 3435610, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/IBOFX.jpg?s=128&g=1", "display_name": "Sara Tibbetts", "link": "https://stackoverflow.com/users/3435610/sara-tibbetts"}, "is_accepted": true, "score": 3, "last_activity_date": 1545442224, "last_edit_date": 1545442224, "creation_date": 1545441785, "answer_id": 53892372, "question_id": 53892365, "link": "https://stackoverflow.com/questions/53892365/how-do-i-sort-hash-based-on-frequency-of-occurrences-in-ruby-is-there-a-better/53892372#53892372", "title": "How do I sort hash based on frequency of occurrences in Ruby? Is there a better way than what I have?", "body": "<p>You need to ensure that you are splitting by an empty string: </p>\n\n<pre><code>w = string.gsub(/\\W/,\" \").split(\"\")\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 133, "user_id": 5219792, "user_type": "registered", "profile_image": "https://graph.facebook.com/10207554199792913/picture?type=large", "display_name": "Alfatah Kader", "link": "https://stackoverflow.com/users/5219792/alfatah-kader"}, "edited": false, "score": 0, "creation_date": 1545516066, "post_id": 53892513, "comment_id": 94644671, "body": "This really helps me understand well. Thanks! I am still a newbie and use terms too liberally (i.e. &#39;character&#39; vs &#39;letter&#39;). But working on this to be more cautious."}], "tags": [], "owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "is_accepted": false, "score": 0, "last_activity_date": 1545449541, "last_edit_date": 1545449541, "creation_date": 1545444306, "answer_id": 53892513, "question_id": 53892365, "link": "https://stackoverflow.com/questions/53892365/how-do-i-sort-hash-based-on-frequency-of-occurrences-in-ruby-is-there-a-better/53892513#53892513", "title": "How do I sort hash based on frequency of occurrences in Ruby? Is there a better way than what I have?", "body": "<p>I assume the count of each letter is case-independent.</p>\n\n<pre><code>str = \"Apple, Banana, Time, Time, Time, Banana Apple, Time.\"\n</code></pre>\n\n<p>You said you to sort by \"the number of occurrences a character\" (not a \"letter\", for example). You could do that as follows.</p>\n\n<pre><code>h = str.downcase.\n        each_char.\n        each_with_object(Hash.new(0)) { |c,h| h[c] += 1 }.\n        sort_by { |_,v| -v }.\n        to_h\n  #=&gt; {\"a\"=&gt;8, \" \"=&gt;7, \"e\"=&gt;6, \",\"=&gt;6, \"i\"=&gt;4, \"t\"=&gt;4, \"m\"=&gt;4, \"p\"=&gt;4,\n  #    \"n\"=&gt;4, \"b\"=&gt;2, \"l\"=&gt;2, \".\"=&gt;1}\n</code></pre>\n\n<p>If only the counts of letters is desired there is one more step:</p>\n\n<pre><code>h.select { |k,_| k.match?(/[a-z]/i) } \n  #=&gt; {\"a\"=&gt;8, \"e\"=&gt;6, \"i\"=&gt;4, \"t\"=&gt;4, \"m\"=&gt;4, \"p\"=&gt;4, \"n\"=&gt;4, \"b\"=&gt;2, \"l\"=&gt;2}\n</code></pre>\n\n<p>This last step could of course be chained to the calculation of <code>h</code> above.</p>\n\n<p>The steps are as follows.</p>\n\n<pre><code>a = str.downcase\n  #=&gt; \"apple, banana, time, time, time, banana apple, time.\"\nb = a.each_char\n  #=&gt; #&lt;Enumerator: \"apple, banana, time, time, time, banana apple,\n  #                  time.\":each_char&gt;\n</code></pre>\n\n<p>We can see the elements the enumerator <code>c</code> will generate and pass to the block by converting it to an array.</p>\n\n<pre><code>b.to_a\n  #=&gt; [\"a\", \"p\", \"p\", \"l\", \"e\", \",\", \" \", \"b\", \"a\", \"n\", \"a\", \"n\",\n  #    \"a\", \",\", \" \", \"t\", \"i\", \"m\", \"e\", \",\", \" \", \"t\", \"i\", \"m\",\n  #    \"e\", \",\", \" \", \"t\", \"i\", \"m\", \"e\", \",\", \" \", \"b\", \"a\", \"n\",\n  #    \"a\", \"n\", \"a\", \" \", \"a\", \"p\", \"p\", \"l\", \"e\", \",\", \" \", \"t\",\n  #    \"i\", \"m\", \"e\", \".\"]\n</code></pre>\n\n<p>Continuing,</p>\n\n<pre><code>c = b.each_with_object(Hash.new(0)) { |c,h| h[c] += 1 }\n  #=&gt; {\"a\"=&gt;8, \"p\"=&gt;4, \"l\"=&gt;2, \"e\"=&gt;6, \",\"=&gt;6, \" \"=&gt;7, \"b\"=&gt;2,\n  #    \"n\"=&gt;4, \"t\"=&gt;4, \"i\"=&gt;4, \"m\"=&gt;4, \".\"=&gt;1}\nd = c.sort_by { |_,v| -v }\n  #=&gt; [[\"a\", 8], [\" \", 7], [\"e\", 6], [\",\", 6], [\"i\", 4], [\"t\", 4],\n  #    [\"m\", 4], [\"p\", 4], [\"n\", 4], [\"b\", 2], [\"l\", 2], [\".\", 1]]\ne = d.to_h\n  #=&gt; {\"a\"=&gt;8, \" \"=&gt;7, \"e\"=&gt;6, \",\"=&gt;6, \"i\"=&gt;4, \"t\"=&gt;4, \"m\"=&gt;4,\n  #    \"p\"=&gt;4, \"n\"=&gt;4, \"b\"=&gt;2, \"l\"=&gt;2, \".\"=&gt;1}\ne.select { |k,_| k.match?(/[a-z]/i) }\n  #=&gt; {\"a\"=&gt;8, \"e\"=&gt;6, \"i\"=&gt;4, \"t\"=&gt;4, \"m\"=&gt;4, \"p\"=&gt;4, \"n\"=&gt;4,\n  #    \"b\"=&gt;2, \"l\"=&gt;2}\n</code></pre>\n\n<p>The last step can be omitted if the calculation of <code>a</code> were changed to the following.</p>\n\n<pre><code>a = str.downcase.gsub(/[^a-z]/i, '')\n  #=&gt; \"applebananatimetimetimebananaappletime\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 802, "user_id": 8728218, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/376ec53188ea3ec0271198a862516657?s=128&d=identicon&r=PG&f=1", "display_name": "Dyaniyal Wilson", "link": "https://stackoverflow.com/users/8728218/dyaniyal-wilson"}, "is_accepted": false, "score": 0, "last_activity_date": 1545463254, "creation_date": 1545463254, "answer_id": 53893814, "question_id": 53892365, "link": "https://stackoverflow.com/questions/53892365/how-do-i-sort-hash-based-on-frequency-of-occurrences-in-ruby-is-there-a-better/53893814#53893814", "title": "How do I sort hash based on frequency of occurrences in Ruby? Is there a better way than what I have?", "body": "<p>Try using gsub in below fashion.</p>\n\n<pre><code>string = \"Apple, Banana, Time, Time, Time, Banana Apple, Time.\"\n\ndef cw(string)\n  a = string.gsub(/[aA]/).count\n  b = string.gsub(/[bB]/).count\n  Hash['A', a, 'B', b]\nend\n\ncw(string)\n  =&gt; {\"A\"=&gt;8, \"B\"=&gt;2}\n</code></pre>\n"}], "owner": {"reputation": 133, "user_id": 5219792, "user_type": "registered", "profile_image": "https://graph.facebook.com/10207554199792913/picture?type=large", "display_name": "Alfatah Kader", "link": "https://stackoverflow.com/users/5219792/alfatah-kader"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 213, "favorite_count": 0, "accepted_answer_id": 53892372, "answer_count": 3, "score": 0, "last_activity_date": 1545463254, "creation_date": 1545441630, "question_id": 53892365, "link": "https://stackoverflow.com/questions/53892365/how-do-i-sort-hash-based-on-frequency-of-occurrences-in-ruby-is-there-a-better", "title": "How do I sort hash based on frequency of occurrences in Ruby? Is there a better way than what I have?", "body": "<p>I am trying to write a method that takes in a string and outputs the number of occurrences a character shows up in a Hash in descending order. </p>\n\n<p>I can do this for each of the words. I need to do this for each of the character. </p>\n\n<pre><code>string = \"Apple, Banana, Time, Time, Time, Banana Apple, Time.\"\n\ndef cw(string)\n  w = string.gsub(/\\W/,\" \").split\n  freq = \n  Hash[w.group_by { |x| x }.map { |k, vs| [k, vs.length] }.sort_by { |k, length| -length }]\n   return freq\n end\n puts cw(string)\n</code></pre>\n\n<p>Expecting: A => 8; B => 2; ..etc.</p>\n\n<p>Actual:  {\"Time\"=>4, \"Apple\"=>2, \"Banana\"=>2}</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 2663, "user_id": 46682, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/b8d4bc05db03a745368281dc3ce1deac?s=128&d=identicon&r=PG", "display_name": "Dom", "link": "https://stackoverflow.com/users/46682/dom"}, "edited": false, "score": 0, "creation_date": 1545440830, "post_id": 53892035, "comment_id": 94631303, "body": "Welcome to SO - see my answer below."}, {"owner": {"reputation": 2151, "user_id": 10068463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c3df811097b7fb8fef67238aad1151ca?s=128&d=identicon&r=PG&f=1", "display_name": "Nate", "link": "https://stackoverflow.com/users/10068463/nate"}, "edited": false, "score": 1, "creation_date": 1545459800, "post_id": 53892035, "comment_id": 94633346, "body": "Quick performance thing: use <code>gsub!</code> instead of <code>gsub</code> whenever possible. Your code creates a ton of unnecessary strings, because <code>gsub</code> makes a new string, where <code>gsub!</code> modifies an existing string. So if you remove the <code>clean_text = </code> from most of your lines and add a <code>!</code> to 6 method calls, you can save yourself 6 string allocations."}], "answers": [{"tags": [], "owner": {"reputation": 2663, "user_id": 46682, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/b8d4bc05db03a745368281dc3ce1deac?s=128&d=identicon&r=PG", "display_name": "Dom", "link": "https://stackoverflow.com/users/46682/dom"}, "is_accepted": true, "score": 1, "last_activity_date": 1545440756, "last_edit_date": 1545440756, "creation_date": 1545439224, "answer_id": 53892197, "question_id": 53892035, "link": "https://stackoverflow.com/questions/53892035/undefined-method-gsub-possible-issue-with-variables/53892197#53892197", "title": "undefined method `gsub&#39;, possible issue with variables", "body": "<p><code>poem</code> holds the results of a <code>scan</code>, which returns an <code>Array</code>, not a <code>String</code>.</p>\n\n<p>You can see docs here: <a href=\"https://ruby-doc.org/core-2.2.0/String.html#method-i-scan\" rel=\"nofollow noreferrer\">https://ruby-doc.org/core-2.2.0/String.html#method-i-scan</a></p>\n\n<p><code>gsub</code> can't be called on an <code>Array</code>. You could <code>map</code> over the <code>Array</code> and call <code>gsub</code> on each element.</p>\n\n<p>If your scan results contain groups you will need to <code>map</code> over each element of the initial <code>map</code>, it will contain an <code>Array</code> of <code>Array</code>s.</p>\n\n<p>Also, if there are no matches, you will still receive an empty <code>Array</code>.</p>\n"}], "owner": {"reputation": 45, "user_id": 10821945, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f638f9eda0bd542bc5f4f0529766dae4?s=128&d=identicon&r=PG&f=1", "display_name": "benjfriedrich", "link": "https://stackoverflow.com/users/10821945/benjfriedrich"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 122, "favorite_count": 0, "accepted_answer_id": 53892197, "answer_count": 1, "score": 0, "last_activity_date": 1545450391, "creation_date": 1545436978, "last_edit_date": 1545450391, "question_id": 53892035, "link": "https://stackoverflow.com/questions/53892035/undefined-method-gsub-possible-issue-with-variables", "title": "undefined method `gsub&#39;, possible issue with variables", "body": "<p>I am trying to take an input text file and insert html tags in it in a particular way. The first part of the file needs to be formatted in a different way than the second part, so what I'm trying to do is:</p>\n\n<ol>\n<li>Import the file</li>\n<li>Clean up the file</li>\n<li>Split the file into 2 parts</li>\n<li>Format part 1</li>\n<li>Format part 2</li>\n<li>Recombine parts 1&amp;2 into new file</li>\n</ol>\n\n<p>Basically I've been able to accomplish steps 1-3 &amp; 6, but when I add in step 4, I'm having issues</p>\n\n<p>Here's my code so far:</p>\n\n<pre><code>file_names = ['ex_poem.txt']\n\nfile_names.each do |file_name|\n  text = File.read(file_name)\n\n  #clean the text\n  # remove extra returns\n  clean_text = text.gsub(/\\n(\\n)+/, \"\\n\\n\")\n\n  # remove spaces from ends of lines\n  clean_text = clean_text.gsub(/ +\\n/, \"\\n\")\n\n  # remove spaces blank lines\n  clean_text = clean_text.gsub(/(?&lt;=\\n) +/, \"\")\n\n  # remove returns at start of doc\n  clean_text = clean_text.gsub(/\\A\\n*/, \"\")\n\n  # remove returns at end of doc\n  clean_text = clean_text.gsub(/\\n*\\Z/, \"\")\n\n  # parse out poem section\n  poem = clean_text.scan(/[\\s\\S]*(?=\\n\\n@@@)/)\n  poem = poem.gsub(/\\A|(?&lt;=\\n)+(?!\\n)+(?!\\Z)/,\"&lt;p class=\\\"poetry-line\\\"&gt;\")\n  #  poem = poem.gsub(/\\n\\n/, \"\\n\\n\\n\\n\\n\")\n\n  # parse out notes section\n  notes = clean_text.scan(/(?&lt;=@@@\\n\\n)[\\s\\S]*/)\n\n  puts clean_text\n  puts poem\n  puts notes  \nend\n</code></pre>\n\n<p>This puts out the following error: </p>\n\n<pre><code>poemify.2.rb:22:in `block in &lt;main&gt;': undefined method `gsub' for #&lt;Array:0x00007f94b104c2c8&gt; (NoMethodError)\n  from poemify.2.rb:3:in `each'\n  from poemify.2.rb:3:in `&lt;main&gt;'\n</code></pre>\n\n<p>but if I comment the line </p>\n\n<pre><code>poem = poem.gsub(/\\A|(?&lt;=\\n)+(?!\\n)+(?!\\Z)/,\"&lt;p class=\\\"poetry-line\\\"&gt;\")\n</code></pre>\n\n<p>then the script runs fine. This confuses me, because I use <code>.gsub</code> earlier in the script with my <code>clean_text</code> variable and it works fine, but when I use it with the <code>poem</code> variable it doesn't work. But <code>puts poem</code> actually works fine when the offending line is commented out.</p>\n\n<p>I suspect that I don't understand something very basic with the way I need to initialize variables or something, but I'm stuck.</p>\n\n<p><strong>UPDATE:</strong></p>\n\n<p>After being shown how <code>.scan</code> was turning <code>poem</code> into an array, I reworked the regex so that I could use <code>.gsub</code>, so <code>poem</code> and <code>notes</code> would be a string, and I could keep working with <code>.gsub</code> in a way that I understand:</p>\n\n<p><code>poem = clean_text.gsub(/\\n(?=@@@\\n\\n)[\\s\\S]*/, \"\")</code></p>\n\n<p><code>notes = clean_text.gsub(/[\\s\\S]*(?&lt;=\\n\\n@@@\\n\\n)/, \"\")</code></p>\n"}, {"tags": ["ruby", "github-api", "httparty"], "answers": [{"tags": [], "owner": {"reputation": 6462, "user_id": 3784008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/55ou4.jpg?s=128&g=1", "display_name": "anothermh", "link": "https://stackoverflow.com/users/3784008/anothermh"}, "is_accepted": true, "score": 7, "last_activity_date": 1545439737, "creation_date": 1545439737, "answer_id": 53892237, "question_id": 53891933, "link": "https://stackoverflow.com/questions/53891933/httparty-post-is-sending-a-get/53892237#53892237", "title": "HTTParty POST is sending a GET", "body": "<p>Change your request to use HTTPS, not HTTP:</p>\n\n<pre><code>https://api.github.com/repos/my_github/my_repo/issues/1/comments\n</code></pre>\n\n<p>instead of:</p>\n\n<pre><code>http://api.github.com/repos/my_github/my_repo/issues/1/comments\n</code></pre>\n\n<p>and you get:</p>\n\n<pre><code>response.request\n=&gt; #&lt;HTTParty::Request:0x00007ffdb81c7e48 @changed_hosts=false, @credentials_sent=false, @http_method=Net::HTTP::Post ...\n</code></pre>\n\n<p>as well as:</p>\n\n<pre><code>response.code\n=&gt; 201\n</code></pre>\n"}], "owner": {"reputation": 567, "user_id": 2368407, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/edc670f9e70e97126ba5f4cb4e58ddd1?s=128&d=identicon&r=PG&f=1", "display_name": "NoobException", "link": "https://stackoverflow.com/users/2368407/noobexception"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 408, "favorite_count": 0, "accepted_answer_id": 53892237, "answer_count": 1, "score": 5, "last_activity_date": 1545439737, "creation_date": 1545435819, "last_edit_date": 1545438371, "question_id": 53891933, "link": "https://stackoverflow.com/questions/53891933/httparty-post-is-sending-a-get", "title": "HTTParty POST is sending a GET", "body": "<p>I'm hitting Github's v3 rest <a href=\"https://developer.github.com/v3/issues/comments/#create-a-comment\" rel=\"noreferrer\">api</a>, I'm making a POST request attempting to create a comment on a test PR. I'm getting back a 200 response, and upon inspecting the request, it was sent as a GET, not a POST:</p>\n\n<pre><code>response = HTTParty.post(\n    \"http://api.github.com/repos/my_github/my_repo/issues/1/comments\",\n    body: { body: \"works\" }.to_json,\n    headers: {\n      \"Authorization\": \"Bearer #{ENV['GITHUB_TOKEN']}\",\n      \"Content-Type\": \"application/json\",\n      \"User-Agent\": ENV[\"GITHUB_USER_AGENT\"]\n    }\n)\n\nresponse.request\n=&gt; #&lt;HTTParty::Request:0x007fdd45a42688\n @http_method=Net::HTTP::Get,\n @last_response=#&lt;Net::HTTPOK 200 OK readbody=true&gt;,\n @last_uri=#&lt;URI::HTTPS https://api.github.com/repos/my_github/my_repo/issues/1/comments&gt;,\n @options=\n  {:limit=&gt;4,\n   :assume_utf16_is_big_endian=&gt;true,\n   :default_params=&gt;{},\n   :follow_redirects=&gt;true,\n   :parser=&gt;HTTParty::Parser,\n   :uri_adapter=&gt;URI,\n   :connection_adapter=&gt;HTTParty::ConnectionAdapter,\n   :body=&gt;{:body=&gt;\"works\"},\n   :headers=&gt;\n    {:Authorization=&gt;\"Bearer my_token\",\n     :Accept=&gt;\"application/vnd.github.machine-man-preview+json\",\n     :\"Content-Type\"=&gt;\"application/json\",\n     :\"User-Agent\"=&gt;\"me\"}},\n @path=#&lt;URI::HTTPS https://api.github.com/repos/my_github/my_repo/issues/1/comments&gt;,\n</code></pre>\n\n<p>The response body is a list of all the comments on that PR, which is the GET request to that same url. I have no idea why it's not sending a POST. Any help is appreciated.</p>\n"}, {"tags": ["ruby", "rubygems"], "comments": [{"owner": {"reputation": 6462, "user_id": 3784008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/55ou4.jpg?s=128&g=1", "display_name": "anothermh", "link": "https://stackoverflow.com/users/3784008/anothermh"}, "edited": false, "score": 0, "creation_date": 1545440680, "post_id": 53891910, "comment_id": 94631282, "body": "I have edited your post for you to convert the output to a code block. I recommend that you read <a href=\"https://stackoverflow.com/help/formatting\">https://stackoverflow.com/help/formatting</a> for future posts or updates, because properly formatting your examples are a crucial part of getting a response on stackoverflow."}, {"owner": {"reputation": 201, "user_id": 8986356, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EDKyk.jpg?s=128&g=1", "display_name": "Gen", "link": "https://stackoverflow.com/users/8986356/gen"}, "reply_to_user": {"reputation": 6462, "user_id": 3784008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/55ou4.jpg?s=128&g=1", "display_name": "anothermh", "link": "https://stackoverflow.com/users/3784008/anothermh"}, "edited": false, "score": 0, "creation_date": 1545490411, "post_id": 53891910, "comment_id": 94638899, "body": "Thank you anothermh! It&#39;s my second time to post my question and I appreciate your link for formatting things"}], "answers": [{"tags": [], "owner": {"reputation": 6462, "user_id": 3784008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/55ou4.jpg?s=128&g=1", "display_name": "anothermh", "link": "https://stackoverflow.com/users/3784008/anothermh"}, "is_accepted": false, "score": 0, "last_activity_date": 1545503188, "creation_date": 1545503188, "answer_id": 53898269, "question_id": 53891910, "link": "https://stackoverflow.com/questions/53891910/gem-install-jekyll-failure/53898269#53898269", "title": "gem install jekyll failure", "body": "<p>Open the file <code>C:/tools/ruby25/lib/ruby/2.5.0/win32/registry.rb</code> in a text editor. Locate the line that begins with <code>LOCALE = Encoding</code>. Change this line from whatever it is to <code>LOCALE = Encoding::UTF_8</code>, save the file, and then retry your <code>gem install jekyll</code> operation.</p>\n\n<p>There is a substantially similar <a href=\"https://stackoverflow.com/q/27325245/3784008\">question</a> here already and <a href=\"https://bugs.ruby-lang.org/issues/10300\" rel=\"nofollow noreferrer\">some</a> <a href=\"https://bugs.ruby-lang.org/issues/13831\" rel=\"nofollow noreferrer\">bugs</a> on the Ruby tracker but they are not easily discovered.</p>\n\n<p>If this solution doesn't work then try running the command <code>chcp 1256</code> or <code>chcp 1252</code> in your <code>cmd.exe</code> window. This will change the code page in use and may also resolve this issue.</p>\n"}], "owner": {"reputation": 201, "user_id": 8986356, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EDKyk.jpg?s=128&g=1", "display_name": "Gen", "link": "https://stackoverflow.com/users/8986356/gen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 138, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1545503188, "creation_date": 1545435526, "last_edit_date": 1545440617, "question_id": 53891910, "link": "https://stackoverflow.com/questions/53891910/gem-install-jekyll-failure", "title": "gem install jekyll failure", "body": "<p>I am installing Jekyll via gem. After I install the Ruby following this instruction <a href=\"https://learn.cloudcannon.com/jekyll/install-jekyll-on-windows/\" rel=\"nofollow noreferrer\">https://learn.cloudcannon.com/jekyll/install-jekyll-on-windows/</a> and  type the \"gem install jekyll\" in cmd, I get the error below:</p>\n\n<pre><code>C:\\Windows\\system32&gt;gem install jekyll\nTraceback (most recent call last):\n    15: from &lt;internal:gem_prelude&gt;:2:in `&lt;internal:gem_prelude&gt;'\n    14: from &lt;internal:gem_prelude&gt;:2:in `require'\n    13: from C:/tools/ruby25/lib/ruby/2.5.0/rubygems.rb:1388:in `&lt;top (required)&gt;'\n    12: from C:/tools/ruby25/lib/ruby/2.5.0/rubygems.rb:1388:in `require'\n    11: from C:/tools/ruby25/lib/ruby/2.5.0/rubygems/defaults/operating_system.rb:3:in `&lt;top (required)&gt;'\n    10: from C:/tools/ruby25/lib/ruby/site_ruby/2.5.0/ruby_installer/runtime/singleton.rb:27:in `enable_dll_search_paths'\n     9: from C:/tools/ruby25/lib/ruby/site_ruby/2.5.0/ruby_installer/runtime/msys2_installation.rb:96:in `enable_dll_search_paths'\n     8: from C:/tools/ruby25/lib/ruby/site_ruby/2.5.0/ruby_installer/runtime/msys2_installation.rb:86:in `mingw_bin_path'\n     7: from C:/tools/ruby25/lib/ruby/site_ruby/2.5.0/ruby_installer/runtime/msys2_installation.rb:73:in `msys_path'\n     6: from C:/tools/ruby25/lib/ruby/site_ruby/2.5.0/ruby_installer/runtime/msys2_installation.rb:48:in `iterate_msys_paths'\n     5: from C:/tools/ruby25/lib/ruby/2.5.0/win32/registry.rb:542:in `open'\n     4: from C:/tools/ruby25/lib/ruby/2.5.0/win32/registry.rb:435:in `open'\n     3: from C:/tools/ruby25/lib/ruby/site_ruby/2.5.0/ruby_installer/runtime/msys2_installation.rb:49:in `block in iterate_msys_paths'\n     2: from C:/tools/ruby25/lib/ruby/2.5.0/win32/registry.rb:611:in `each_key'\n     1: from C:/tools/ruby25/lib/ruby/2.5.0/win32/registry.rb:910:in `export_string'\nC:/tools/ruby25/lib/ruby/2.5.0/win32/registry.rb:910:in `encode': U+7F51 to IBM437 in conversion from UTF-16LE to UTF-8 to IBM437 (Encoding::UndefinedConversionError)\n</code></pre>\n\n<p>The steps I followed are below: </p>\n\n<pre><code>@powershell -NoProfile -ExecutionPolicy Bypass -Command \"iex ((new-object net.webclient).DownloadString('https://chocolatey.org/install.ps1'))\" &amp;&amp; SET PATH=%PATH%;%ALLUSERSPROFILE%\\chocolatey\\bin\n\nchoco install ruby -y\n\ngem install jekyll\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "postgresql", "activerecord"], "answers": [{"comments": [{"owner": {"reputation": 409, "user_id": 8863925, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e99b5af75de208cba57edda978af54df?s=128&d=identicon&r=PG&f=1", "display_name": "Selim Alawwa", "link": "https://stackoverflow.com/users/8863925/selim-alawwa"}, "edited": false, "score": 0, "creation_date": 1545512659, "post_id": 53895634, "comment_id": 94644005, "body": "I am sorry but I can&#39;t get you. What I need is from a Variant object v with kind = &#39;sized&#39;, I want to call v.main_variant, to get select from Variant where variant.id = v.parent_id, why does the above code add all the other conditions?"}], "tags": [], "owner": {"reputation": 230, "user_id": 1486234, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/945e89ebc5ab747e075d67c0058ee26f?s=128&d=identicon&r=PG", "display_name": "giglemad", "link": "https://stackoverflow.com/users/1486234/giglemad"}, "is_accepted": false, "score": 0, "last_activity_date": 1545481582, "last_edit_date": 1592644375, "creation_date": 1545481582, "answer_id": 53895634, "question_id": 53891238, "link": "https://stackoverflow.com/questions/53891238/rails-associations-self-joins-fail-to-find-the-belong-to-object-on-after-creat/53895634#53895634", "title": "Rails Associations, Self Joins, fail to find the belong_to object on after_create callback", "body": "<p>Extract from the rails way which is based on the rails documentation :</p>\n<blockquote>\n<p>7.4.1.13 foreign_key: column_name Overrides the convention-based foreign key column name that would normally be used in the SQL\nstatement that loads the association. Normally it would be the owning\nrecord\u2019s class name with _id appended to it.</p>\n<p>7.4.1.15 primary_key: column_name Specifies a surrogate key to use instead of the owning record\u2019s primary key, whose value should be used\nwhen querying to fill the association collection.</p>\n</blockquote>\n<p>What you did seems to tell Active Record how to bend its convention to retrieve a given <code>Variant</code> its owned associations but not how to retrieve a given <code>Variant</code> its owning association.</p>\n"}], "owner": {"reputation": 409, "user_id": 8863925, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e99b5af75de208cba57edda978af54df?s=128&d=identicon&r=PG&f=1", "display_name": "Selim Alawwa", "link": "https://stackoverflow.com/users/8863925/selim-alawwa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 95, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1545481582, "creation_date": 1545429714, "last_edit_date": 1545438965, "question_id": 53891238, "link": "https://stackoverflow.com/questions/53891238/rails-associations-self-joins-fail-to-find-the-belong-to-object-on-after-creat", "title": "Rails Associations, Self Joins, fail to find the belong_to object on after_create callback", "body": "<p>I have a <code>has_many</code> and <code>belongs_to</code> relationship within the same model.</p>\n\n<p>From the belongs to object, Rails generate a wrong SQL to find the parent.</p>\n\n<p>My model is as follow: </p>\n\n<pre><code>class Variant &lt; ApplicationRecord\n  enum kind: %i[main sized]\n  has_many :sized_variants, -&gt; { where kind: 'sized' }, :class_name =&gt; \"Variant\", :dependent =&gt; :destroy, :foreign_key =&gt; \"parent_id\"\n  belongs_to :main_variant, -&gt; { where kind: 'main' }, :class_name =&gt; \"Variant\", optional: true, :foreign_key =&gt; \"parent_id\"\n  after_create :validate_main_variant\n\n  def validate_main_variant\n    if sized? &amp;&amp; self.main_variant.nil?\n      errors.add(:variant, 'main variant not found')\n      throw :abort\n    end\n  end\n</code></pre>\n\n<p>In <code>after_create</code> of sized variant, when calling <code>self.main_variant</code> Rails generates the below SQL to find <code>main_variant</code> (foreign key parent_id) instead of just find by parent_id.</p>\n\n<p>What is the mistake or possible solution here?</p>\n\n<pre><code>Variant Load (1.2ms)\nSELECT  \"variants\".*\nFROM \"variants\"\nWHERE \"variants\".\"product_id\" = $1\nAND \"variants\".\"color_id\" = $2\nAND \"variants\".\"size_id\" = $3\nAND \"variants\".\"parent_id\" = $4\nAND \"variants\".\"id\" = $5\nAND \"variants\".\"kind\" = $6\nLIMIT $7\n[[\"product_id\", 20], [\"color_id\", 1], [\"size_id\", 1], [\"parent_id\", 44], [\"id\", 44], [\"kind\", 0], [\"LIMIT\", 1]]\n</code></pre>\n\n<p>I am using Rails 5.1.6.</p>\n"}, {"tags": ["ruby", "active-directory", "ruby-1.9", "netldap"], "answers": [{"comments": [{"owner": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "edited": false, "score": 1, "creation_date": 1545655484, "post_id": 53891350, "comment_id": 94670584, "body": "<code>step</code> here would raise the same error the OP got in the first place. What he really needs is the specs on LDAP itself and proper strings to pass to it&#39;s commands."}, {"owner": {"reputation": 6462, "user_id": 3784008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/55ou4.jpg?s=128&g=1", "display_name": "anothermh", "link": "https://stackoverflow.com/users/3784008/anothermh"}, "reply_to_user": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "edited": false, "score": 0, "creation_date": 1545674275, "post_id": 53891350, "comment_id": 94675695, "body": "@lacostenycoder He specifically asked \u201cHow do I debug why this isn&#39;t working?\u201d I explained a technique for debugging. He didn\u2019t ask \u201cWhy isn\u2019t this working?\u201d"}], "tags": [], "owner": {"reputation": 6462, "user_id": 3784008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/55ou4.jpg?s=128&g=1", "display_name": "anothermh", "link": "https://stackoverflow.com/users/3784008/anothermh"}, "is_accepted": false, "score": 1, "last_activity_date": 1545430521, "creation_date": 1545430521, "answer_id": 53891350, "question_id": 53891073, "link": "https://stackoverflow.com/questions/53891073/how-do-i-debug-ruby-ldap-when-a-method-only-returns-false/53891350#53891350", "title": "How do I debug ruby-ldap when a method only returns false?", "body": "<p>Well, one approach might be to add <a href=\"https://github.com/pry/pry\" rel=\"nofollow noreferrer\">pry</a> and <a href=\"https://github.com/deivid-rodriguez/pry-byebug\" rel=\"nofollow noreferrer\">pry-byebug</a> to your application. Modify your code to include <code>binding.pry</code> then run your application:</p>\n\n<pre><code>Frame number: 0/0\n\nFrom: ./test.rb @ line 1 :\n\n =&gt; 1: binding.pry\n    2: secure_ldap.rename(\n    3:   olddn: self.dn,\n    4:   newrdn: \"CN=#{self.cn}\",\n    5:   delete_attributes: true,\n    6:   new_superior: \"#{ou}\"\n\n=&gt; \n</code></pre>\n\n<p>Now use <a href=\"https://github.com/deivid-rodriguez/pry-byebug#commands\" rel=\"nofollow noreferrer\"><code>step</code></a> to step through the execution line by line. It will allow you to step into the <a href=\"https://github.com/ruby-ldap/ruby-net-ldap/blob/9daa954061c2a071345bd18d462db5af8acfe8a0/lib/net/ldap/connection.rb#L649-L667\" rel=\"nofollow noreferrer\"><code>rename</code> method</a> call inside of net-ldap, and for example inspect the local variables within that method call.</p>\n"}, {"tags": [], "owner": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "is_accepted": false, "score": 0, "last_activity_date": 1545655645, "creation_date": 1545655645, "answer_id": 53913665, "question_id": 53891073, "link": "https://stackoverflow.com/questions/53891073/how-do-i-debug-ruby-ldap-when-a-method-only-returns-false/53913665#53913665", "title": "How do I debug ruby-ldap when a method only returns false?", "body": "<p>The error is not a ruby error.  When dealing with ruby standard lib interfaces to system programs such as LDAP, refer to it's own documentation source. </p>\n\n<p>In your case you're probably looking for <a href=\"https://ldap.com/ldap-dns-and-rdns/\" rel=\"nofollow noreferrer\">https://ldap.com/ldap-dns-and-rdns/</a> which explains strings to use and which ones need to be escaped.</p>\n"}], "owner": {"reputation": 1690, "user_id": 2620860, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/vPUTw.png?s=128&g=1", "display_name": "Rayhan Muktader", "link": "https://stackoverflow.com/users/2620860/rayhan-muktader"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 108, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1545655645, "creation_date": 1545428449, "question_id": 53891073, "link": "https://stackoverflow.com/questions/53891073/how-do-i-debug-ruby-ldap-when-a-method-only-returns-false", "title": "How do I debug ruby-ldap when a method only returns false?", "body": "<p>My goal is to move an account to another OU. My understanding is that the following code should do the job. However, it returns <code>false</code>. There is no error, warning or exceptions. How do I debug why this isn't working?</p>\n\n<pre><code>secure_ldap.rename(\n    olddn: self.dn, \n    newrdn: \"CN=#{self.cn}\", \n    delete_attributes: true, \n    new_superior: \"#{ou}\"\n  )\n</code></pre>\n"}, {"tags": ["arrays", "ruby", "conditional", "raiserror", "raiseerror"], "comments": [{"owner": {"reputation": 4348, "user_id": 3435610, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/IBOFX.jpg?s=128&g=1", "display_name": "Sara Tibbetts", "link": "https://stackoverflow.com/users/3435610/sara-tibbetts"}, "edited": false, "score": 0, "creation_date": 1545424511, "post_id": 53890486, "comment_id": 94628050, "body": "It looks like you are not checking if <i>all</i> bikes are broken, try making a method that checks for this and use that in the guard condition"}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1545427888, "post_id": 53890486, "comment_id": 94628962, "body": "<code>@bikes.each { |bike| return bike if bike.broken? }</code> this will return the <code>bike</code> from the method if a bike is broken and if none of them are broken it will push the full list of bikes into the not_working array."}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 1, "creation_date": 1545428213, "post_id": 53890486, "comment_id": 94629038, "body": "I think what you are looking for is <code>@bikes.all?(&amp;:broken?)</code> which will check to see if all the bikes are broken"}, {"owner": {"reputation": 89, "user_id": 6495617, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/679377a86dfa655f688a3b38dbb82912?s=128&d=identicon&r=PG&f=1", "display_name": "Bart_Judge", "link": "https://stackoverflow.com/users/6495617/bart-judge"}, "reply_to_user": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1545465254, "post_id": 53890486, "comment_id": 94634087, "body": "@engineersmnky Thanks, that&#39;s exactly what I&#39;m looking for. I&#39;m a novice with Ruby, is :broken? being called as a symbol as it&#39;s a method?"}], "answers": [{"comments": [{"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 1, "creation_date": 1545493664, "post_id": 53895768, "comment_id": 94639724, "body": "<code>release_working_bikes</code> is going to be an issue since <code>working_bikes</code> is a collection. Also <code>select {!}</code> is usually <code>reject</code>"}, {"owner": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "reply_to_user": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1545567632, "post_id": 53895768, "comment_id": 94651777, "body": "@engineersmnky good catch on <code>release_working_bikes</code>, fixed that and of course <code>.reject</code> is better, thanks."}], "tags": [], "owner": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "is_accepted": false, "score": 1, "last_activity_date": 1545567364, "last_edit_date": 1545567364, "creation_date": 1545482677, "answer_id": 53895768, "question_id": 53890486, "link": "https://stackoverflow.com/questions/53890486/ruby-fail-statement-guard-condition-returning-nil/53895768#53895768", "title": "Ruby - Fail statement/Guard Condition returning nil", "body": "<p>As already pointed out in comments, you're trying to check if all bikes are broken, so why not name your method <code>all_bikes_broken?</code> . See comments in code.</p>\n\n<pre><code>require_relative 'bike'\nclass DockingStation\n  DEFAULT_CAPACITY = 20\n  attr_reader :capacity, :bikes\n\n  def initialize(capacity = DEFAULT_CAPACITY)\n    @bikes = []\n    @capacity = capacity\n\n  end\n\n  def release_bike\n    fail 'No bikes available' if empty?\n    fail 'No working bikes available' unless all_bikes_broken?\n    release_working_bikes\n\n  end\n\n  def dock(bike)\n    fail 'Docking Station Full' if full?\n    @bikes &lt;&lt; bike\n  end\n\n  private\n\n  def working_bikes\n    #this will select only bikes which are NOT broken\n    @bikes.reject{ |bike| bike.broken? }\n  end\n\n  def all_bikes_broken?\n    #this is shorthand for @bikes.all?{ |bike| bike.broken? }\n    #it says send  :broken? method to each instance of bike.\n    #.all? returns true only if all instances return true, otherwise false.\n    @bikes.all?(&amp;:broken?)\n  end\n\n  def release_working_bikes\n    bike = working_bikes\n    @bikes.delete(working_bikes.first)\n    #or you could do .last but order probably doesn't matter here.\n  end\n\n  def full?\n    @bikes.count &gt;= @capacity\n  end\n\n  def empty?\n    @bikes.empty?\n  end\n\nend\n\n\nclass Bike\n  attr_accessor :broken\n\n  def initialize\n    @broken = false\n  end\n\n  def working?\n    @working\n  end\n\n  def report_broken\n    @broken = true\n  end\n\n  def broken?\n    @broken\n  end\n\nend\n</code></pre>\n"}], "owner": {"reputation": 89, "user_id": 6495617, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/679377a86dfa655f688a3b38dbb82912?s=128&d=identicon&r=PG&f=1", "display_name": "Bart_Judge", "link": "https://stackoverflow.com/users/6495617/bart-judge"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 165, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1545567364, "creation_date": 1545424234, "question_id": 53890486, "link": "https://stackoverflow.com/questions/53890486/ruby-fail-statement-guard-condition-returning-nil", "title": "Ruby - Fail statement/Guard Condition returning nil", "body": "<p>I'm trying to improve the <code>release_bike</code> method.\nI have gone into irb, and the first guard condition works, and the release_working_bikes work, but the second guard condition keeps on return nil in irb, even when I run a feature test and know that there is only a broken bike available.</p>\n\n<p>Is there something wrong with the way I'm phrasing my second fail line, or is there a flaw in <code>broken_bikes</code> ?</p>\n\n<p>The <code>release_bike</code> method should work as follows;\nif there are no bikes in the docking station, then there should be a warning saying - <code>No bikes available</code>\nif there are bikes in the docking station, but they are <strong>ALL</strong> broken, then there should be a warning saying - <code>No working bikes available</code>\nif  there are some working bikes, then <code>release_bike</code> should release one of the workign bikes.</p>\n\n<p>Below are the two classes, that are involved;</p>\n\n<pre><code>require_relative 'bike'\nclass DockingStation\n  DEFAULT_CAPACITY = 20\n  attr_reader :capacity, :bikes\n\n  def initialize(capacity = DEFAULT_CAPACITY)\n    @bikes = []\n    @capacity = capacity\n\n  end\n\n  def release_bike\n    fail 'No bikes available' if empty?\n    fail 'No working bikes available' unless broken_bikes\n    release_working_bikes\n\n  end\n\n  def dock(bike)\n    fail 'Docking Station Full' if full?\n    @bikes &lt;&lt; bike\n  end\n\n  private\n\n  def working_bikes\n    @bikes.each { |bike| return bike unless bike.broken? }\n  end\n\n  def broken_bikes\n    not_working = []\n    not_working &lt;&lt; @bikes.each { |bike| return bike if bike.broken? }\n    not_working.empty?\n  end\n\n  def release_working_bikes\n    bike = working_bikes\n    @bikes.delete(bike)\n  end\n\n  def full?\n    @bikes.count &gt;= @capacity\n  end\n\n  def empty?\n    @bikes.empty?\n  end\n\nend\n\n\n\nclass Bike\n  attr_accessor :broken\n\n  def initialize\n    @broken = false\n  end\n\n  def working?\n    @working\n  end\n\n  def report_broken\n    @broken = true\n  end\n\n  def broken?\n    @broken\n  end\n\nend\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "scope", "authorization", "pundit"], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 10821605, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f6fa469e2abdd9ede1ad032fb5f486d9?s=128&d=identicon&r=PG&f=1", "display_name": "g2n", "link": "https://stackoverflow.com/users/10821605/g2n"}, "edited": false, "score": 0, "creation_date": 1545430553, "post_id": 53891166, "comment_id": 94629542, "body": "Doesn&#39;t make a difference, I had tried that. See my second edit."}], "tags": [], "owner": {"reputation": 2541, "user_id": 1162683, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8e05cd764cc2ecba1884b309e9dd5df5?s=128&d=identicon&r=PG", "display_name": "penner", "link": "https://stackoverflow.com/users/1162683/penner"}, "is_accepted": false, "score": 0, "last_activity_date": 1545429081, "creation_date": 1545429081, "answer_id": 53891166, "question_id": 53890188, "link": "https://stackoverflow.com/questions/53890188/invalid-constructor-error-for-pundit-policy-scopes-when-using-or-logical-union/53891166#53891166", "title": "Invalid Constructor Error for Pundit Policy Scopes when using OR (logical union) queries", "body": "<p>The only potential issue I see here is that you are calling scope twice. Worth a try...</p>\n\n<pre><code>scope.joins(:group_editors).where(group_editors: { editor_id: user.id }).or(scope.where(owner_id: user.id))\n</code></pre>\n\n<p>Could this be rewritten like this</p>\n\n<pre><code>scope.joins(:group_editors).where(group_editors: { editor_id: user.id }).or(Group.where(owner_id: user.id))\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2709, "user_id": 650711, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/6276db3f126cef8682f9374f75734acc?s=128&d=identicon&r=PG", "display_name": "Linus", "link": "https://stackoverflow.com/users/650711/linus"}, "is_accepted": false, "score": 0, "last_activity_date": 1545431475, "creation_date": 1545431475, "answer_id": 53891487, "question_id": 53890188, "link": "https://stackoverflow.com/questions/53890188/invalid-constructor-error-for-pundit-policy-scopes-when-using-or-logical-union/53891487#53891487", "title": "Invalid Constructor Error for Pundit Policy Scopes when using OR (logical union) queries", "body": "<p>This issue has been fixed in master and will be part of the next release. </p>\n"}], "owner": {"reputation": 21, "user_id": 10821605, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f6fa469e2abdd9ede1ad032fb5f486d9?s=128&d=identicon&r=PG&f=1", "display_name": "g2n", "link": "https://stackoverflow.com/users/10821605/g2n"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 762, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1545431475, "creation_date": 1545422288, "last_edit_date": 1545423916, "question_id": 53890188, "link": "https://stackoverflow.com/questions/53890188/invalid-constructor-error-for-pundit-policy-scopes-when-using-or-logical-union", "title": "Invalid Constructor Error for Pundit Policy Scopes when using OR (logical union) queries", "body": "<p>I'm seeing this kind of error:</p>\n\n<pre><code>Invalid #&lt;GroupPolicy::Scope&gt; constructor is called\n</code></pre>\n\n<p>but it's very strange because removing the <a href=\"https://guides.rubyonrails.org/active_record_querying.html#or-conditions\" rel=\"nofollow noreferrer\">or()</a> method seems to bypass the error - but I need this method to find Groups that belong to a particular user AND find Groups that a particular person can edit, and return that set to the index page. The user in this case is a PORO populated with employee data from an AREST service. I don't think I'm using the method incorrectly because the error thrown is related to Pundit.</p>\n\n<p>Application Policy:</p>\n\n<pre><code>class ApplicationPolicy\n  attr_reader :context, :record\n\n  def initialize(context, record)\n    @context = context\n    @record = record\n  end\n\n  delegate :user, to: :context\n  delegate :cookies, to: :context\n\n  ...\n\n  class Scope\n    attr_reader :context, :scope\n\n    def initialize(context, scope)\n      @context = context\n      @scope = scope\n    end\n\n    delegate :user, to: :context\n    delegate :cookies, to: :context\n\n    def resolve\n      scope.all\n    end\n  end\nend\n</code></pre>\n\n<p>Group Policy:</p>\n\n<pre><code>class GroupPolicy &lt; ApplicationPolicy\n  ...\n\n  class Scope &lt; Scope\n    def resolve\n      if user.admin?\n        super\n      else\n        scope.joins(:group_editors).where(group_editors: { editor_id: user.id })\n        # the above line works, but it doesn't work when I try:\n        # scope.joins(:group_editors).where(group_editors: { editor_id: user.id }).or(scope.where(owner_id: user.id))\n        # both queries succeed individually if I print them each on a new line\n      end\n    end\n  end\nend\n</code></pre>\n\n<p>Group Model:</p>\n\n<pre><code>class Group &lt; ApplicationRecord\n  has_many :roles\n  has_many :group_editors\n  has_many :contents\nend\n</code></pre>\n\n<p>Editors Model:</p>\n\n<pre><code>class GroupEditor &lt; ApplicationRecord\n  belongs_to :group\nend\n</code></pre>\n\n<p>Groups Controller (index):</p>\n\n<pre><code>def index\n  @groups = policy_scope(Group)\n  redirect_to group_path @groups.first if @groups.count == 1\nend\n</code></pre>\n\n<p>Pundit User (uses additional context because we read cookies when doing auth sometimes):</p>\n\n<pre><code>def pundit_user\n  UserContext.new(current_user, cookies)\nend\n\nclass UserContext\n  attr_reader :user, :cookies\n\n  def initialize(user, cookies)\n    @user = user\n    @cookies = cookies\n  end\nend\n</code></pre>\n\n<p><strong>Edit #1</strong></p>\n\n<p>This seems to work - but why?</p>\n\n<pre><code>scope.joins(:group_editors).where('owner_id = ? OR group_editors.editor_id = ?', user.id, user.id)\n</code></pre>\n\n<p><strong>Edit #2</strong></p>\n\n<p>The real error is</p>\n\n<pre><code>Relation passed to #or must be structurally compatible. Incompatible values: [:joins]\n</code></pre>\n\n<p>which is unfortunate. Pundit throws a misleading error.</p>\n"}, {"tags": ["ruby", "postgresql", "csv"], "answers": [{"tags": [], "owner": {"reputation": 9663, "user_id": 5239030, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/76JEw.png?s=128&g=1", "display_name": "iGian", "link": "https://stackoverflow.com/users/5239030/igian"}, "is_accepted": true, "score": 0, "last_activity_date": 1545430626, "last_edit_date": 1545430626, "creation_date": 1545429790, "answer_id": 53891247, "question_id": 53890026, "link": "https://stackoverflow.com/questions/53890026/how-to-fix-headers-in-csv-file-with-ruby-then-copy-to-postgresql-database/53891247#53891247", "title": "How to fix headers in csv file with Ruby then copy to postgresql database?", "body": "<p>Maybe you can consider to fix headers rewriting the file, change the first line:</p>\n\n<pre><code>lines = File.readlines('test.csv')\nnew_header = lines[0].chomp.split(',').map{ |w| w.gsub(' ', '_')}.join(',')\nlines[0] = new_header &lt;&lt; $/\nFile.open('test.csv', 'w') { |f| f.write(lines.join) }\n</code></pre>\n\n<p>If you don't want to overwrite the file, just change the name of the output file.</p>\n\n<p>(Stolen here: <a href=\"https://stackoverflow.com/a/35958805\">https://stackoverflow.com/a/35958805</a>)</p>\n\n<p>Then probably you don't need to read file with the <code>csv</code> library, to pass a string to the process, try just:</p>\n\n<pre><code>testfile = File.read('test.csv')\np testfile.class #=&gt; String\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 8538706, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/18f0ddf301314e29a1e45e0811c6483a?s=128&d=identicon&r=PG&f=1", "display_name": "mikibok", "link": "https://stackoverflow.com/users/8538706/mikibok"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 152, "favorite_count": 0, "accepted_answer_id": 53891247, "answer_count": 1, "score": 0, "last_activity_date": 1545430626, "creation_date": 1545421445, "question_id": 53890026, "link": "https://stackoverflow.com/questions/53890026/how-to-fix-headers-in-csv-file-with-ruby-then-copy-to-postgresql-database", "title": "How to fix headers in csv file with Ruby then copy to postgresql database?", "body": "<p>I want to import a CSV file into a PostgreSQL table with Ruby. I wish to do it automatically (with a task) because new files with the same structure will be imported monthly. It it first copied to a temporary table, in this case \"test\", and afterwards inserted into another table.</p>\n\n<p>Here is what I want to do:</p>\n\n<ul>\n<li>Some of the headers of the CSV file contain whitespace, and I wish to replace them with an underscore so I don't have to deal with those later. For example, \"col 1\" needs to become \"col_1\".</li>\n<li>Some of the columns in the CSV file are useless and I don't wish to copy them in the database. For example, out of \"col_1\", \"col_2\" and \"col_3\", I only want to copy \"col_1\" and \"col_3\".</li>\n</ul>\n\n<p>Here is the CSV content I'm working with:</p>\n\n<pre><code>col 1,col 2,col 3\nr1c1,r1c2,r1c3\nr2c1,r2c2,r2c3\n</code></pre>\n\n<p>From searching on stackoverflow and other places, this is the following code that I got.</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>task :insert_charge [:file] =&gt; :environment do |task,args|\n  require 'csv'\n  testfile = CSV.read(args[:file],\n    :headers =&gt; true,\n    :converters =&gt; :all,\n    :header_converters =&gt; lambda { |h| h.gsub(' ', '_') }\n  )\n\n   ActiveRecord::Base.connection.execute(\"\n    drop table if exists test;\n    create table test (\n      id serial primary key,\n      col_1 varchar(4),\n      col_3 varchar(4)\n    );\n  \")\n\n  conn = PG::Connection.open(\n    :user =&gt; Rails.configuration.database_configuration[\"development\"][\"username\"],\n    :dbname =&gt; Rails.configuration.database_configuration[\"development\"][\"database\"],\n    :password =&gt; Rails.configuration.database_configuration[\"development\"][\"password\"]\n  )\n\n  conn.copy_data \"copy test (col_1, col_3)\n    from stdin csv header delimiter ',' null as '' encoding 'utf-8'\" do\n    conn.put_copy_data testfile\n  end\nend\n</code></pre>\n\n<p>I am successfully able to change the whitespace in the headers with an underscore. However, this changes the CSV into Table mode, which then cannot be copied in the database. How can I modify the headers and then copy the CSV into the database?</p>\n\n<p>This is the error that I get when I do <code>rake insert_charge [d:\\\\test.csv]</code>:\n<strong>TypeError: wrong argument type CSV::Table (expected String)</strong></p>\n\n<p>Please take in consideration that I'm a real Ruby beginner. I've seen questions similar to mine, but no answers that I works for my problem.</p>\n\n<p>Thanks for your help!</p>\n"}, {"tags": ["ruby", "encryption"], "comments": [{"owner": {"reputation": 3791, "user_id": 1820553, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-NZb6uZzo4Gg/AAAAAAAAAAI/AAAAAAAAAo0/xTr6RvgMTRw/photo.jpg?sz=128", "display_name": "kelalaka", "link": "https://stackoverflow.com/users/1820553/kelalaka"}, "edited": false, "score": 1, "creation_date": 1545417325, "post_id": 53889365, "comment_id": 94625535, "body": "RijndaelManaged is not standard. Rijndael was selected as AES and made standard. There is no 256-bit block size in AES as in Rijndael. It is better to change 256-bit block size to the standard AES."}, {"owner": {"reputation": 564, "user_id": 9911698, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HiA9x.jpg?s=128&g=1", "display_name": "Gabriel", "link": "https://stackoverflow.com/users/9911698/gabriel"}, "reply_to_user": {"reputation": 3791, "user_id": 1820553, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-NZb6uZzo4Gg/AAAAAAAAAAI/AAAAAAAAAo0/xTr6RvgMTRw/photo.jpg?sz=128", "display_name": "kelalaka", "link": "https://stackoverflow.com/users/1820553/kelalaka"}, "edited": false, "score": 0, "creation_date": 1545417549, "post_id": 53889365, "comment_id": 94625637, "body": "I see. For some reason the third-party service I am trying to use wants it to be a Rijndael implementation with a block size of 256 bits. I&#39;m not experience with this but are there implementations of Rijndael that can use a 256-bit block size?"}, {"owner": {"reputation": 3791, "user_id": 1820553, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-NZb6uZzo4Gg/AAAAAAAAAAI/AAAAAAAAAo0/xTr6RvgMTRw/photo.jpg?sz=128", "display_name": "kelalaka", "link": "https://stackoverflow.com/users/1820553/kelalaka"}, "edited": false, "score": 1, "creation_date": 1545418160, "post_id": 53889365, "comment_id": 94625868, "body": "This site <a href=\"http://crypt.rubyforge.org/rijndael.html\" rel=\"nofollow noreferrer\">crypt.rubyforge.org/rijndael.html</a> (currently down) claimed that it has. may be you can find somewhere its versions?"}, {"owner": {"reputation": 564, "user_id": 9911698, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HiA9x.jpg?s=128&g=1", "display_name": "Gabriel", "link": "https://stackoverflow.com/users/9911698/gabriel"}, "reply_to_user": {"reputation": 3791, "user_id": 1820553, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-NZb6uZzo4Gg/AAAAAAAAAAI/AAAAAAAAAo0/xTr6RvgMTRw/photo.jpg?sz=128", "display_name": "kelalaka", "link": "https://stackoverflow.com/users/1820553/kelalaka"}, "edited": false, "score": 0, "creation_date": 1545418319, "post_id": 53889365, "comment_id": 94625925, "body": "Thanks for that. i did try it but it only has a CBC implementation. Haven&#39;t had much luck searching for a ruby implementation of it. Thanks for your help but I&#39;m starting to feel like i may have to implement it myself"}, {"owner": {"reputation": 3791, "user_id": 1820553, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-NZb6uZzo4Gg/AAAAAAAAAAI/AAAAAAAAAo0/xTr6RvgMTRw/photo.jpg?sz=128", "display_name": "kelalaka", "link": "https://stackoverflow.com/users/1820553/kelalaka"}, "edited": false, "score": 1, "creation_date": 1545418421, "post_id": 53889365, "comment_id": 94625966, "body": "And, I should say that ECB is insecure, prefer AES-GCM since it is an authenticated encryption. If you really need ECB, it is not hard to change a CBC code into ECB code."}, {"owner": {"reputation": 564, "user_id": 9911698, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HiA9x.jpg?s=128&g=1", "display_name": "Gabriel", "link": "https://stackoverflow.com/users/9911698/gabriel"}, "reply_to_user": {"reputation": 3791, "user_id": 1820553, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-NZb6uZzo4Gg/AAAAAAAAAAI/AAAAAAAAAo0/xTr6RvgMTRw/photo.jpg?sz=128", "display_name": "kelalaka", "link": "https://stackoverflow.com/users/1820553/kelalaka"}, "edited": false, "score": 0, "creation_date": 1545418476, "post_id": 53889365, "comment_id": 94625982, "body": "Yeah I&#39;ve been reading about ECB&#39;s insecurity a lot. I think the third party I&#39;m using just hasn&#39;t updated their encryption methods yet. I&#39;m not quite sure why. I&#39;ll look into changing the CBC code to ECB code! Thanks for your help. You&#39;ve been super helpful!"}, {"owner": {"reputation": 79299, "user_id": 589259, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/vJbKg.jpg?s=128&g=1", "display_name": "Maarten Bodewes", "link": "https://stackoverflow.com/users/589259/maarten-bodewes"}, "edited": false, "score": 0, "creation_date": 1545656554, "post_id": 53889365, "comment_id": 94670896, "body": "You can just call the CBC code for each block with a zero IV. Simply pad the last block of plaintext yourself with zero bytes. Note that there are two ways of zero padding: one that doesn&#39;t pad if the plaintext is already block-aligned and one that does. You may want to test the C# code with a single block of plaintext to see which one it is, I&#39;m not sure out of the top of my head."}, {"owner": {"reputation": 44559, "user_id": 411022, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9905bf9a7b8d5a587c1bdff07ef2e801?s=128&d=identicon&r=PG", "display_name": "Ilmari Karonen", "link": "https://stackoverflow.com/users/411022/ilmari-karonen"}, "edited": false, "score": 0, "creation_date": 1546210663, "post_id": 53889365, "comment_id": 94801663, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/23745059/decrypting-php-mcrypt-rijndael-256-in-ruby\">Decrypting PHP MCRYPT_RIJNDAEL_256 in Ruby</a>"}], "answers": [{"tags": [], "owner": {"reputation": 564, "user_id": 9911698, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HiA9x.jpg?s=128&g=1", "display_name": "Gabriel", "link": "https://stackoverflow.com/users/9911698/gabriel"}, "is_accepted": true, "score": 0, "last_activity_date": 1547166971, "creation_date": 1547166971, "answer_id": 54138857, "question_id": 53889365, "link": "https://stackoverflow.com/questions/53889365/ruby-equivalent-of-rijndaelmanaged/54138857#54138857", "title": "Ruby equivalent of RijndaelManaged", "body": "<p>I think the only gem in existence that could accomplish this task for me turned out to be the <a href=\"https://github.com/kingpong/ruby-mcrypt\" rel=\"nofollow noreferrer\">ruby-mcrypt</a> gem. For any future generations who are in need of a library to encrypt some lesser used and potentially unsafe encryption technique.</p>\n"}], "owner": {"reputation": 564, "user_id": 9911698, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HiA9x.jpg?s=128&g=1", "display_name": "Gabriel", "link": "https://stackoverflow.com/users/9911698/gabriel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 153, "favorite_count": 1, "accepted_answer_id": 54138857, "answer_count": 1, "score": 3, "last_activity_date": 1547166971, "creation_date": 1545417122, "last_edit_date": 1546453726, "question_id": 53889365, "link": "https://stackoverflow.com/questions/53889365/ruby-equivalent-of-rijndaelmanaged", "title": "Ruby equivalent of RijndaelManaged", "body": "<p>I am trying to encrypt using Rijndael 256-bit block size, 256-bit key size, ECB mode and zero's for padding.</p>\n\n<p>I was trying to use OpenSSL::Cipher::AES.new(256, :ECB) but I cannot for the life of me get the correct result I am looking for. </p>\n\n<p>I have a solution in C# but I'm having trouble getting the Ruby equivalent for it. </p>\n\n<p>In the C# code RijndaelManaged is used for encryption and what I'm having trouble with in particular is RijndaelManaged is ok taking in a byte array for the key and the object to be encrypted. I can't find a Ruby library that will do the same for me. OpenSSL::Cipher::AES will only take in strings.</p>\n\n<p>Is there anything similar like this in Ruby? Google has failed me in finding anything and I'm not an encryption guru by any means. Any help or just point me in the right direction would be amazing. I just cannot figure out for the life of me. I have a related SO question to this if anyone wants to take a look. The answer is perfect I just cannot translate it to Ruby.</p>\n\n<p>This question isn't a duplicate. I mean it is similar to the question it is listed as a duplicate of however the answer doesn't help me at all. The answer they link to is a library that uses :cbc but I need :ecb mode for the Rijndael encryption. I agree though the questions are very similar. Just the answer doesn't help me hence me asking this question.</p>\n"}, {"tags": ["ruby", "hash"], "comments": [{"owner": {"reputation": 37414, "user_id": 204883, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba29060be0758fa6537ff3d768a91757?s=128&d=identicon&r=PG", "display_name": "Arkku", "link": "https://stackoverflow.com/users/204883/arkku"}, "edited": false, "score": 1, "creation_date": 1545416562, "post_id": 53889161, "comment_id": 94625247, "body": "<code>months.keys</code> is an <code>Array</code> of keys, and arrays must be subscripted by integers."}], "answers": [{"tags": [], "owner": {"reputation": 27144, "user_id": 3857758, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/58c4295826435f049b7fc32b98c240f9?s=128&d=identicon&r=PG&f=1", "display_name": "Ursus", "link": "https://stackoverflow.com/users/3857758/ursus"}, "is_accepted": true, "score": 1, "last_activity_date": 1545416012, "creation_date": 1545416012, "answer_id": 53889184, "question_id": 53889161, "link": "https://stackoverflow.com/questions/53889161/no-implicit-conversion-of-string-into-integer-error-when-trying-to-get-value-f/53889184#53889184", "title": "`no implicit conversion of String into Integer` error when trying to get value from hash", "body": "<p>What you're looking for is just</p>\n\n<pre><code>months[\"1\"]\n</code></pre>\n\n<p>Why are you using <code>keys</code> method? That returns all the keys as an array. And therefore you can access that just with numbers. That's what the error is saying.</p>\n"}], "owner": {"reputation": 693, "user_id": 4086794, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/f35dcbd75a6c6509156cc3f908a413d8?s=128&d=identicon&r=PG&f=1", "display_name": "Chuchoo", "link": "https://stackoverflow.com/users/4086794/chuchoo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 44, "favorite_count": 0, "accepted_answer_id": 53889184, "answer_count": 1, "score": 0, "last_activity_date": 1545416012, "creation_date": 1545415896, "question_id": 53889161, "link": "https://stackoverflow.com/questions/53889161/no-implicit-conversion-of-string-into-integer-error-when-trying-to-get-value-f", "title": "`no implicit conversion of String into Integer` error when trying to get value from hash", "body": "<p>I am trying to get Value in a hash using its Key just like below. </p>\n\n<pre><code>#!/usr/bin/ruby\n\n$, = \", \"\nmonths = Hash.new( \"month\" )\nmonths = {\"1\" =&gt; \"January\", \"2\" =&gt; \"February\"}\n\nkeys = months.keys[\"1\"]\nputs \"#{keys}\"\n</code></pre>\n\n<p>I get following error</p>\n\n<pre><code>main.rb:7:in `[]': no implicit conversion of String into Integer (TypeError)\n    from main.rb:7:in `&lt;main&gt;'\n</code></pre>\n\n<p>Why am I getting above error?</p>\n"}, {"tags": ["jquery", "ruby-on-rails", "ruby", "ajax"], "comments": [{"owner": {"reputation": 277, "user_id": 4846915, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3580ebf1b572e7a33aba61b0ffd024d?s=128&d=identicon&r=PG&f=1", "display_name": "F.E.A", "link": "https://stackoverflow.com/users/4846915/f-e-a"}, "edited": false, "score": 0, "creation_date": 1545415746, "post_id": 53888826, "comment_id": 94624966, "body": "Does the same error occur when you open the link in the new tab/window with javascript?"}, {"owner": {"reputation": 8823, "user_id": 976691, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/93eaf3f1f6df27205641701fca8bd233?s=128&d=identicon&r=PG", "display_name": "Tintin81", "link": "https://stackoverflow.com/users/976691/tintin81"}, "reply_to_user": {"reputation": 277, "user_id": 4846915, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3580ebf1b572e7a33aba61b0ffd024d?s=128&d=identicon&r=PG&f=1", "display_name": "F.E.A", "link": "https://stackoverflow.com/users/4846915/f-e-a"}, "edited": false, "score": 1, "creation_date": 1545417455, "post_id": 53888826, "comment_id": 94625598, "body": "Yes, tried that already"}], "answers": [{"comments": [{"owner": {"reputation": 8823, "user_id": 976691, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/93eaf3f1f6df27205641701fca8bd233?s=128&d=identicon&r=PG", "display_name": "Tintin81", "link": "https://stackoverflow.com/users/976691/tintin81"}, "edited": false, "score": 0, "creation_date": 1545417546, "post_id": 53889178, "comment_id": 94625636, "body": "Hi and thanks but that&#39;s actually what my code looks like already. I just wanted to keep things simple, so I didn&#39;t include it in my original post. Just added it above."}, {"owner": {"reputation": 1686, "user_id": 7264341, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Oz5dfb6ASr8/AAAAAAAAAAI/AAAAAAAAAC8/33rQJBMPZZI/photo.jpg?sz=128", "display_name": "Javier Men&#233;ndez Rizo", "link": "https://stackoverflow.com/users/7264341/javier-men%c3%a9ndez-rizo"}, "reply_to_user": {"reputation": 8823, "user_id": 976691, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/93eaf3f1f6df27205641701fca8bd233?s=128&d=identicon&r=PG", "display_name": "Tintin81", "link": "https://stackoverflow.com/users/976691/tintin81"}, "edited": false, "score": 0, "creation_date": 1545417960, "post_id": 53889178, "comment_id": 94625792, "body": "Can you put some info about your routes?"}, {"owner": {"reputation": 8823, "user_id": 976691, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/93eaf3f1f6df27205641701fca8bd233?s=128&d=identicon&r=PG", "display_name": "Tintin81", "link": "https://stackoverflow.com/users/976691/tintin81"}, "edited": false, "score": 0, "creation_date": 1545421981, "post_id": 53889178, "comment_id": 94627159, "body": "It&#39;s just a RESTful controller named <code>InvoicesController</code>. So the only route concerned here is the <code>invoices_path</code> I guess."}, {"owner": {"reputation": 1686, "user_id": 7264341, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Oz5dfb6ASr8/AAAAAAAAAAI/AAAAAAAAAC8/33rQJBMPZZI/photo.jpg?sz=128", "display_name": "Javier Men&#233;ndez Rizo", "link": "https://stackoverflow.com/users/7264341/javier-men%c3%a9ndez-rizo"}, "reply_to_user": {"reputation": 8823, "user_id": 976691, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/93eaf3f1f6df27205641701fca8bd233?s=128&d=identicon&r=PG", "display_name": "Tintin81", "link": "https://stackoverflow.com/users/976691/tintin81"}, "edited": false, "score": 1, "creation_date": 1545426424, "post_id": 53889178, "comment_id": 94628628, "body": "The problem seems to be on the client side, look at this: <a href=\"https://stackoverflow.com/questions/1066452/easiest-way-to-open-a-download-window-without-navigating-away-from-the-page\" title=\"easiest way to open a download window without navigating away from the page\">stackoverflow.com/questions/1066452/&hellip;</a> you could create the link on your onchange function or put a hidden link on your html"}], "tags": [], "owner": {"reputation": 1686, "user_id": 7264341, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Oz5dfb6ASr8/AAAAAAAAAAI/AAAAAAAAAC8/33rQJBMPZZI/photo.jpg?sz=128", "display_name": "Javier Men&#233;ndez Rizo", "link": "https://stackoverflow.com/users/7264341/javier-men%c3%a9ndez-rizo"}, "is_accepted": false, "score": 1, "last_activity_date": 1545415985, "creation_date": 1545415985, "answer_id": 53889178, "question_id": 53888826, "link": "https://stackoverflow.com/questions/53888826/how-to-download-files-through-select-options-with-rails-and-jquery/53889178#53889178", "title": "How to download files through select options with Rails and jQuery?", "body": "<p>Maybe you could consider use send_data for downloads like this:</p>\n\n<pre><code>  def index\n    @invoices = Invoice.all\n    respond_to do |format|\n      format.csv { send_data(invoices_file(:csv), filename: 'invoices.csv', disposition: 'attachment') }\n      format.xlsx { send_data(invoices_file(:xlsx), filename: 'invoices.xlsx', disposition: 'attachment') }\n      format.xml { send_data(invoices_file(:xml), filename: 'invoices.xml', disposition: 'attachment') }\n    end\n  end\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 8823, "user_id": 976691, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/93eaf3f1f6df27205641701fca8bd233?s=128&d=identicon&r=PG", "display_name": "Tintin81", "link": "https://stackoverflow.com/users/976691/tintin81"}, "is_accepted": false, "score": 0, "last_activity_date": 1545471774, "creation_date": 1545471774, "answer_id": 53894583, "question_id": 53888826, "link": "https://stackoverflow.com/questions/53888826/how-to-download-files-through-select-options-with-rails-and-jquery/53894583#53894583", "title": "How to download files through select options with Rails and jQuery?", "body": "<p>OK, I wasn't able to remove the errors but I realised that they were not due to the fact that I was using select boxes but occurred whenever I tried to download from <code>invoices_path</code>. The errors can be removed by adding <code>:download =&gt; :download</code> to the download links. So I switched from select boxes to links and now the errors are gone. <a href=\"https://stackoverflow.com/questions/6587393/resource-interpreted-as-document-but-transferred-with-mime-type-application-zip\">This other question here on SO helped me a lot</a>.</p>\n"}], "owner": {"reputation": 8823, "user_id": 976691, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/93eaf3f1f6df27205641701fca8bd233?s=128&d=identicon&r=PG", "display_name": "Tintin81", "link": "https://stackoverflow.com/users/976691/tintin81"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 120, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1545471774, "creation_date": 1545413970, "last_edit_date": 1545417502, "question_id": 53888826, "link": "https://stackoverflow.com/questions/53888826/how-to-download-files-through-select-options-with-rails-and-jquery", "title": "How to download files through select options with Rails and jQuery?", "body": "<p>I am trying to build a form in my Rails app where the user can select a file extension from a select box and then the selected file gets downloaded.</p>\n\n<hr>\n\n<p><strong>Form:</strong></p>\n\n<pre><code>select_tag :data_export, options_for_select(format_options)\n</code></pre>\n\n<hr>\n\n<p><strong>Form helper:</strong></p>\n\n<pre><code>def format_options\n  options = []\n  options &lt;&lt; [\"Please select...\", nil]\n  %w(csv xml xlsx).each do |format|\n    options &lt;&lt; [ format.upcase, invoices_path(:format =&gt; format) ]\n  end\n  options\nend\n</code></pre>\n\n<hr>\n\n<p><strong>Controller action:</strong></p>\n\n<pre><code>def index\n  @invoices = Invoice.all\n  respond_to do |format|\n    format.csv {  send_data(invoices_file(:csv),  filename: 'invoices.csv',  disposition: 'attachment') }\n    format.xlsx { send_data(invoices_file(:xlsx), filename: 'invoices.xlsx', disposition: 'attachment') }\n    format.xml {  send_data(invoices_file(:xml),  filename: 'invoices.xml',  disposition: 'attachment') }\n  end\nend\n</code></pre>\n\n<hr>\n\n<p><strong>jQuery:</strong></p>\n\n<pre><code>$('#data_export').on('change', function() {\n  var url = $(this).val();\n  if (url) {\n    location = url;\n  }\n});\n</code></pre>\n\n<hr>\n\n<p>The code works and the selected file gets downloaded. But it also throws (minor) errors in Chrome and Safari such as:</p>\n\n<blockquote>\n  <p>Resource interpreted as Document but transferred with MIME type\n  text/csv</p>\n</blockquote>\n\n<p>Is there an alternative to the approach above, possibly using Ajax?</p>\n\n<p>Thanks for any help.</p>\n"}, {"tags": ["ruby", "chef-infra"], "comments": [{"owner": {"reputation": 1275, "user_id": 2903313, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ce1623b00b100930ac65e69a8069cd28?s=128&d=identicon&r=PG", "display_name": "Roc Khalil", "link": "https://stackoverflow.com/users/2903313/roc-khalil"}, "edited": false, "score": 2, "creation_date": 1545405836, "post_id": 53887167, "comment_id": 94620975, "body": "Very easy, when you use <code>&#39;</code> the <code>string</code> isn&#39;t interpolated; you&#39;ll need to use <code>&quot;</code> instead. Try doing: <code>cookbook_file &quot;&#47;etc&#47;systemd&#47;system&#47;#{f}&quot; do</code> and it should work"}, {"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 0, "creation_date": 1545410423, "post_id": 53887167, "comment_id": 94622937, "body": "&quot;Does not work&quot; is not a precise enough error description for us to help you. <i>What</i> doesn&#39;t work? <i>How</i> doesn&#39;t it work? What trouble do you have with your code? Do you get an error message? What is the error message? Is the result you are getting not the result you are expecting? What result do you expect and why, what is the result you are getting and how do the two differ? Is the behavior you are observing not the desired behavior? What is the desired behavior and why, what is the observed behavior, and in what way do they differ?"}, {"owner": {"reputation": 2262, "user_id": 709166, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/Z1pDC.png?s=128&g=1", "display_name": "Josh", "link": "https://stackoverflow.com/users/709166/josh"}, "reply_to_user": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 0, "creation_date": 1545412091, "post_id": 53887167, "comment_id": 94623629, "body": "@J&#246;rgWMittag are you having a bad day? It&#39;s Christmas. I&#39;ve updated my question with some clarity. I&#39;ve already accepted an answer so some people understood but yes its difficult to search later. It was myself not being familiar with Ruby but it&#39;s been cleared up."}], "answers": [{"tags": [], "owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "is_accepted": true, "score": 4, "last_activity_date": 1545407242, "creation_date": 1545407242, "answer_id": 53887523, "question_id": 53887167, "link": "https://stackoverflow.com/questions/53887167/why-does-cookbook-file-resource-in-this-ruby-each-loop-not-actually-copy-files-i/53887523#53887523", "title": "Why does cookbook_file resource in this Ruby each loop not actually copy files in Chef recipe?", "body": "<p>In ruby, single-quoted strings are read literally, whereas double-quoted strings interpolate \"special characters\" (with backs-slashes), and inner variables.</p>\n\n<p>For example:</p>\n\n<pre><code>[1] pry(main)&gt; world = \"earth\"\n[2] pry(main)&gt; puts 'hello #{world}\\ntesting 123'\nhello #{world}\\ntesting 123\n[3] pry(main)&gt; puts \"hello #{world}\\ntesting 123\"\nhello earth\ntesting 123\n</code></pre>\n\n<p>Since you used a single-quoted string, it's being treated as literally <code>/etc/systemd/system/#{f}</code>. By using double-quotes, you can interpolate the variable - such as <code>/etc/systemd/system/airflow-webserver.service</code>.</p>\n"}], "owner": {"reputation": 2262, "user_id": 709166, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/Z1pDC.png?s=128&g=1", "display_name": "Josh", "link": "https://stackoverflow.com/users/709166/josh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 72, "favorite_count": 0, "accepted_answer_id": 53887523, "answer_count": 1, "score": -1, "last_activity_date": 1545411983, "creation_date": 1545405678, "last_edit_date": 1545411983, "question_id": 53887167, "link": "https://stackoverflow.com/questions/53887167/why-does-cookbook-file-resource-in-this-ruby-each-loop-not-actually-copy-files-i", "title": "Why does cookbook_file resource in this Ruby each loop not actually copy files in Chef recipe?", "body": "<p>I've been using Ruby/Chef for about 8 hours now :) so hopefully this is something simple.</p>\n\n<p>Why is it that this loop does not work in my Chef recipe? But if I perform these separately it functions as desired (placing cookbook repo files on the server chef recipe is executed on)?</p>\n\n<p>Does not place service files in /etc/systemd/system/</p>\n\n<pre><code>[\"airflow.service\", \"airflow-webserver.service\", \"airflow-scheduler.service\"].each do |f|        \n    cookbook_file '/etc/systemd/system/#{f}' do\n        action :create\n        source f\n    end\nend\n</code></pre>\n\n<p>Properly places files /etc/systemd/system/</p>\n\n<pre><code>cookbook_file '/etc/systemd/system/airflow.service' do\n        action :create\n        source 'airflow.service'\nend\n\ncookbook_file '/etc/systemd/system/airflow-scheduler.service' do\n    action :create\n    source 'airflow-scheduler.service'\nend\n\ncookbook_file '/etc/systemd/system/airflow-webserver.service' do\n    action :create\n    source 'airflow-webserver.service'\nend\n</code></pre>\n"}]