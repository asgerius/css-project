[{"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-3", "ruby-on-rails-4"], "comments": [{"owner": {"reputation": 1479, "user_id": 2506819, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3b60435154915157dfd7ebfc04164930?s=128&d=identicon&r=PG", "display_name": "fanta", "link": "https://stackoverflow.com/users/2506819/fanta"}, "edited": false, "score": 0, "creation_date": 1559772731, "post_id": 56468633, "comment_id": 99528849, "body": "you&#39;re first calling <code>update_pos</code>, that&#39;s why it changes the values."}, {"owner": {"reputation": 3, "user_id": 11606337, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-kKjB6QVimZg/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdH08HsMi0wfAGw9_rHMcBDq7mU5w/mo/photo.jpg?sz=128", "display_name": "Zelears", "link": "https://stackoverflow.com/users/11606337/zelears"}, "reply_to_user": {"reputation": 1479, "user_id": 2506819, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3b60435154915157dfd7ebfc04164930?s=128&d=identicon&r=PG", "display_name": "fanta", "link": "https://stackoverflow.com/users/2506819/fanta"}, "edited": false, "score": 0, "creation_date": 1559772866, "post_id": 56468633, "comment_id": 99528894, "body": "<code>update_pos</code> sets value of <code>@notes_before</code> to [[0, 0], [0, 1]] so it have to be before"}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 11606337, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-kKjB6QVimZg/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdH08HsMi0wfAGw9_rHMcBDq7mU5w/mo/photo.jpg?sz=128", "display_name": "Zelears", "link": "https://stackoverflow.com/users/11606337/zelears"}, "edited": false, "score": 1, "creation_date": 1559773449, "post_id": 56468785, "comment_id": 99529053, "body": "Thank you thats exacly what I was looking for."}], "tags": [], "owner": {"reputation": 2694, "user_id": 3956205, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42aff84cfa87f92797cb54bdea6d0c20?s=128&d=identicon&r=PG", "display_name": "BTL", "link": "https://stackoverflow.com/users/3956205/btl"}, "is_accepted": true, "score": 1, "last_activity_date": 1559773202, "creation_date": 1559773202, "answer_id": 56468785, "question_id": 56468633, "link": "https://stackoverflow.com/questions/56468633/problem-with-value-that-change-for-some-reason/56468785#56468785", "title": "Problem with Value That change for some reason", "body": "<p>You are copying the array by reference and not by value. So when the first array changes, the second one changes too because they share the same reference.</p>\n\n<p>What you can do to avoid this problem is : </p>\n\n<pre><code>class Slider\n  attr_accessor :position\n  def initialize(position)\n    @position = position\n    @notes_before = Array.new\n  end\n\n  def move\n    @position.each do |note|\n      note[0] +=1\n    end\n    print @notes_before\n  end\n\n  def update_pos\n    @notes_before = @position.map(&amp;:clone)\n    print @notes_before\n  end\nend\n\na=Slider.new([[0,0],[0,1]])\na.update_pos\na.move\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 11606337, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-kKjB6QVimZg/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdH08HsMi0wfAGw9_rHMcBDq7mU5w/mo/photo.jpg?sz=128", "display_name": "Zelears", "link": "https://stackoverflow.com/users/11606337/zelears"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 22, "favorite_count": 0, "accepted_answer_id": 56468785, "answer_count": 1, "score": 0, "last_activity_date": 1559773202, "creation_date": 1559772195, "question_id": 56468633, "link": "https://stackoverflow.com/questions/56468633/problem-with-value-that-change-for-some-reason", "title": "Problem with Value That change for some reason", "body": "<p>Just run this code in console.\nProblem is @notes_before change value after calling method \"a.move\" for some reasons.\nHow to fix it and why it happen ? </p>\n\n<pre><code>class Slider\n  attr_accessor :position\n  def initialize(position)\n    @position = position\n    @notes_before = Array.new\n  end\n\n  def move\n    @position.each do |note|\n      note[0] +=1\n    end\n    print @notes_before\n  end\n\n  def update_pos\n    @position.each do |notes|\n      @notes_before &lt;&lt; notes\n    end\n    print @notes_before\n  end\nend\n\na=Slider.new([[0,0],[0,1]])\na.update_pos\na.move\n</code></pre>\n\n<p>I expect output of @notes_before to be [[0, 0], [0, 1]] after calling a.move but the actual output is [[1, 0], [1, 1]]</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 3, "creation_date": 1559770698, "post_id": 56468184, "comment_id": 99528182, "body": "Which is line number 168 (the one reported in the error)? It says there is an uninitialised constant <code>C</code>, but nothing in the code above seems to reference anything called <code>C</code>?"}, {"owner": {"reputation": 91121, "user_id": 179125, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5594142dcc49a24b1902ec8059181f8d?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan Running", "link": "https://stackoverflow.com/users/179125/jordan-running"}, "edited": false, "score": 0, "creation_date": 1559771846, "post_id": 56468184, "comment_id": 99528591, "body": "What&#39;s the value of <code>item</code> when the error is raised? It sounds like its value is <code>&quot;C&quot;</code> (or some string that contains <code>C</code>) and <code>eval(&quot;C&quot;, binding)</code> is raising an error because there&#39;s no constant accessible from <code>binding</code> named <code>C</code>. What&#39;s the expected behavior here?"}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1559772022, "post_id": 56468184, "comment_id": 99528648, "body": "<b>WARNING</b>: <code>eval</code> is a huge liability, can cause catastrophic problems, and should be avoided whenever possible. Can you explain what purpose it serves here? In Ruby you can usually do something else that&#39;s way less dangerous to achieve the same result."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1559778129, "post_id": 56468184, "comment_id": 99529981, "body": "In Ruby comments begin with the character <code>&quot;#&quot;</code>, not <code>&quot;&#47;&#47;&quot;</code>. If you added <code>&quot;&#47;&#47;&quot;</code> as part of the description (but didn&#39;t run it with that), you should change them to <code>&quot;#&quot;</code> to avoid the confusion."}], "owner": {"reputation": 11, "user_id": 3609049, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4e2cf0e87564ed5593b788d881752c67?s=128&d=identicon&r=PG&f=1", "display_name": "user3609049", "link": "https://stackoverflow.com/users/3609049/user3609049"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 49, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1559822730, "creation_date": 1559769699, "last_edit_date": 1559822730, "question_id": 56468184, "link": "https://stackoverflow.com/questions/56468184/getting-uninitialized-constant-error-in-ruby-program-why-cant-i-format-a-numb", "title": "Getting Uninitialized Constant Error in Ruby Program - why can&#39;t I format a number?", "body": "<p>This field</p>\n\n<pre><code>  def format_to_two_dec(stringfield)\n    \"%.2f\" % stringfield # -&gt; CRASHES\n    stringfield #--&gt; OKAY - returns a string such as 900\n  end\n</code></pre>\n\n<p>This code calls a record with a field called total in it. </p>\n\n<pre><code> return_method =\n  proc do |the_self_ref|\n    the_record = the_self_ref.peek_next_db_record.select do |an_elem|\n      an_elem[:crectype] == '0004'\n    end\n    the_self_ref.format_to_two_dec(the_record[0][:total])\n  end\n</code></pre>\n\n<p>What I'm trying to do is to format the number to have two decimals and ALWAYS two decimals (so 900.00).</p>\n\n<p>The error I get is:</p>\n\n<p>//Scripts/create_835_record.rb:168:in `block (2 levels) in eval_x12_commands': uninitialized constant Create835Records::C (NameError)</p>\n\n<p>The format of the record is:</p>\n\n<pre><code>record0004_format =\n  {\n    ctotal_charge: 15,\n    cdiscount: 15,\n    cineligible: 15,\n    cpended: 15,\n    callowed: 15,\n    cdeductible: 15,\n    ccopay: 15,\n    ccoinsurance: 15,\n    cbalance: 15,\n    cother_carrier: 15,\n    cpayment: 15,\n    cpatient_responsibility: 15,\n    primarypayment: 15,\n    excess: 15,\n    noncovered: 15\n  }\n\n def eval_x12_commands\n    @list_of_segments_in_file.each do |a_cmd|\n      array_to_eval = a_cmd.split('|')\n      list_of_evaled = []\n      array_to_eval.each do |item|\n        **list_of_evaled &lt;&lt; eval(item, binding)** //this line\n      end\n      the_method = @the_builder_for835.method(list_of_evaled[0])\n      begin\n        the_method.call(*list_of_evaled[1..-1])\n      rescue\n        puts \"Eval Exception\\n\"\n      end\n    end\n</code></pre>\n\n<p>I hope this will be enough - the program is a bit big, but I can post more if I need to.</p>\n"}, {"tags": ["ruby", "selenium-webdriver"], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user7277590"}, "edited": false, "score": 0, "creation_date": 1559833969, "post_id": 56470900, "comment_id": 99551365, "body": "In order to use the other options of the support class, would I write Selenium::WebDriver::Support::Select.first_selected_option()&zwnj;&#8203;?"}, {"owner": {"reputation": 5134, "user_id": 1672197, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i8HkV.png?s=128&g=1", "display_name": "orde", "link": "https://stackoverflow.com/users/1672197/orde"}, "edited": false, "score": 0, "creation_date": 1559859696, "post_id": 56470900, "comment_id": 99561627, "body": "You can select individual options in the dropdown via <code>select_by</code>."}, {"owner": {"reputation": 3523, "user_id": 9043475, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FNxvn.jpg?s=128&g=1", "display_name": "Rajagopalan", "link": "https://stackoverflow.com/users/9043475/rajagopalan"}, "edited": false, "score": 0, "creation_date": 1559870250, "post_id": 56470900, "comment_id": 99563480, "body": "@Herbert H. Please accept this answer if it answers your question. Give the credit to the people those who are answering your questions."}], "tags": [], "owner": {"reputation": 5134, "user_id": 1672197, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i8HkV.png?s=128&g=1", "display_name": "orde", "link": "https://stackoverflow.com/users/1672197/orde"}, "is_accepted": true, "score": 0, "last_activity_date": 1559795334, "creation_date": 1559795334, "answer_id": 56470900, "question_id": 56467982, "link": "https://stackoverflow.com/questions/56467982/iterating-through-the-options-of-a-drop-down/56470900#56470900", "title": "Iterating through the options of a drop down", "body": "<p>The ruby bindings for <code>selenium-webdriver</code> have a <a href=\"https://seleniumhq.github.io/selenium/docs/api/rb/Selenium/WebDriver/Support/Select.html\" rel=\"nofollow noreferrer\">Select</a> class for manipulating select lists.  </p>\n\n<p>Here's a contrived example that locates a select_list element, passed the element to a Select object, and prints the text of each option in the list.  YMMV...</p>\n\n<pre><code>require \"selenium-webdriver\"\n\ndriver = Selenium::WebDriver.for :firefox\ndriver.navigate.to \"https://www.seleniumeasy.com/test/basic-select-dropdown-demo.html\"\n\nelement = driver.find_element(id: 'select-demo')\n\nselect_list = Selenium::WebDriver::Support::Select.new(element)\nselect_list.options.each { |option| puts option.text}\n\n#=&gt; Please select\n#=&gt; Sunday\n#=&gt; Monday\n#=&gt; Tues\n...\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user7277590"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 82, "favorite_count": 0, "accepted_answer_id": 56470900, "answer_count": 1, "score": 1, "last_activity_date": 1559795334, "creation_date": 1559768614, "question_id": 56467982, "link": "https://stackoverflow.com/questions/56467982/iterating-through-the-options-of-a-drop-down", "title": "Iterating through the options of a drop down", "body": "<p>I'm using Selenium in Ruby ( a language that I am currently learning) and I have a drop down menu that I want to iterate though, select each option, do some stuff, and then move onto the next option.</p>\n\n<p>I have looked at several answers that are somewhat similar. Only one Stack Overflow question had to similar idea in mind as mine but it's in Python and I just don't know the syntax for Ruby. </p>\n\n<p>I have read through the documentation for Ruby and haven't found anything that does anything similar to the Python way. </p>\n\n<p>Essentially what I want to do is:</p>\n\n<pre><code>   select first option\n        click a button\n        navigate to a different page\n        download a csv\n        return back to the previous page\n\n   select second option\n        do the same thing\netc...until all the options are done\n</code></pre>\n\n<p>Is this possible? I can figure out returning to the previous page and clicking the csv option but I would like some help on the syntax part.</p>\n\n<p>Thank you</p>\n"}, {"tags": ["ruby", "ruby-on-rails-3", "web-scraping", "mechanize"], "answers": [{"tags": [], "owner": {"reputation": 47898, "user_id": 966023, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/917fcb4327159076f752c0c3c3fddfbb?s=128&d=identicon&r=PG", "display_name": "pguardiario", "link": "https://stackoverflow.com/users/966023/pguardiario"}, "is_accepted": false, "score": 0, "last_activity_date": 1559777164, "creation_date": 1559777164, "answer_id": 56469257, "question_id": 56467669, "link": "https://stackoverflow.com/questions/56467669/how-to-click-a-apparently-form-less-button-link-using-mechanize-to-show-more/56469257#56469257", "title": "How to click a (apparently) form-less button/ link using mechanize to &#39;Show More&#39; on web page", "body": "<p>If that's a link you could do:</p>\n\n<pre><code>next_page = page.link_with(text: 'Show More').click\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 3995, "user_id": 2037537, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/f13d953be3af2552aaa1ddfa0a05fa46?s=128&d=identicon&r=PG", "display_name": "Roland Studer", "link": "https://stackoverflow.com/users/2037537/roland-studer"}, "is_accepted": false, "score": 0, "last_activity_date": 1559783573, "creation_date": 1559783573, "answer_id": 56469816, "question_id": 56467669, "link": "https://stackoverflow.com/questions/56467669/how-to-click-a-apparently-form-less-button-link-using-mechanize-to-show-more/56469816#56469816", "title": "How to click a (apparently) form-less button/ link using mechanize to &#39;Show More&#39; on web page", "body": "<p>Probably the load more button triggers some javascript. Mechanize does not support javascript. </p>\n\n<p>So you probably can\u2018t do this with mechanize. You will need another tool like WATIR or Selenium. </p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 11606035, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-_Y6YW_EQ414/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfuzpR8efdqSo-YxZhwKu_EZhtLGA/mo/photo.jpg?sz=128", "display_name": "Jon Langkammer", "link": "https://stackoverflow.com/users/11606035/jon-langkammer"}, "is_accepted": false, "score": 0, "last_activity_date": 1559879787, "creation_date": 1559879787, "answer_id": 56487760, "question_id": 56467669, "link": "https://stackoverflow.com/questions/56467669/how-to-click-a-apparently-form-less-button-link-using-mechanize-to-show-more/56487760#56487760", "title": "How to click a (apparently) form-less button/ link using mechanize to &#39;Show More&#39; on web page", "body": "<p>Mr. Studer is correct, Mechanize is not able to click the button in question in this case. I was able to get around this by viewing the network request that was triggered due to button press. I copied this request as cURL and used ruby methods to simulate further button presses, yielding the data I wanted. </p>\n\n<p>Thank you Mr. Studer.</p>\n"}], "owner": {"reputation": 1, "user_id": 11606035, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-_Y6YW_EQ414/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfuzpR8efdqSo-YxZhwKu_EZhtLGA/mo/photo.jpg?sz=128", "display_name": "Jon Langkammer", "link": "https://stackoverflow.com/users/11606035/jon-langkammer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 293, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1559879787, "creation_date": 1559767049, "question_id": 56467669, "link": "https://stackoverflow.com/questions/56467669/how-to-click-a-apparently-form-less-button-link-using-mechanize-to-show-more", "title": "How to click a (apparently) form-less button/ link using mechanize to &#39;Show More&#39; on web page", "body": "<p>I would like to load more data onto the page I'm visiting by clicking the 'Show More' button, which is at the bottom of the page. </p>\n\n<p>Mechanize is showing me this button as a link (see below).</p>\n\n<p>From the research I've done, I should be able to click this button with the code listed below. However, when I view the list of divs that I'm hoping will be longer, I see the count is the same as before, which to me means something isn't working as expected. </p>\n\n<p>On another thread, I saw that buttons can sometimes be 'disguised' as part of forms. I looked at the page and it has three forms. However I do not believe any of these forms are associated with this button because the button does not have any fields associated with it. </p>\n\n<p>When I do invoke the click method below, it does look like the click was successful (I can see some sort of reload in terminal) but .children.count does not change. </p>\n\n<pre><code>#assume I already did mechanize.get(url) and I'm on the site.\n#I also did a mechanize.page.links.find to get the show more button\n\nmechanize = Mechanize.new \nshowMore = #&lt;Mechanize::Page::Link \"Show More\" \"#\"&gt;\npageWithMore = mechanize.click(showMore)\n\n# check children of div to see if count is longer\nmechanize.page.css('div.results-container').children.count\n# repeatedly returns 51 after 'click' invoke \n</code></pre>\n\n<p>I expect the .children.count to be closer to 100 after invoking the click method and then ~150 after invoking a second time.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-5"], "answers": [{"comments": [{"owner": {"reputation": 934, "user_id": 3663124, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/dd2b3438ed3252dce5c184b4eace56ba?s=128&d=identicon&r=PG&f=1", "display_name": "fedest", "link": "https://stackoverflow.com/users/3663124/fedest"}, "edited": false, "score": 0, "creation_date": 1567007385, "post_id": 57691636, "comment_id": 101836407, "body": "I think that&#39;s what I ended up doing and for what I remembered it worked"}], "tags": [], "owner": {"reputation": 1, "user_id": 11988970, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/e95d423b985d94dee839dbcd6ae3ebb2?s=128&d=identicon&r=PG", "display_name": "user11988970", "link": "https://stackoverflow.com/users/11988970/user11988970"}, "is_accepted": false, "score": 0, "last_activity_date": 1566992966, "last_edit_date": 1566992966, "creation_date": 1566992614, "answer_id": 57691636, "question_id": 56467077, "link": "https://stackoverflow.com/questions/56467077/output-error-loaderror-cannot-load-such-file-enc-trans-single-byte/57691636#57691636", "title": "output error: #&lt;LoadError: cannot load such file -- enc/trans/single_byte&gt;", "body": "<p>I also faced same problem with ruby with rbenv to version 2.5.1. after reinstall ruby with rbenv to make readline to use libreadline.</p>\n\n<pre><code>(pry) output error: #&lt;LoadError: cannot load such file -- enc/trans/single_byte&gt;\n</code></pre>\n\n<p>It's stack trace</p>\n\n<pre><code>/Users/user-name/.rbenv/versions/2.5.1/lib/ruby/gems/2.5.0/gems/coderay-1.1.2/lib/coderay/scanners/scanner.rb:93:in `encode'\n/Users/user-name/.rbenv/versions/2.5.1/lib/ruby/gems/2.5.0/gems/coderay-1.1.2/lib/coderay/scanners/scanner.rb:93:in `encode_with_encoding'\n/Users/user-name/.rbenv/versions/2.5.1/lib/ruby/gems/2.5.0/gems/coderay-1.1.2/lib/coderay/scanners/scanner.rb:57:in `normalize'\n/Users/user-name/.rbenv/versions/2.5.1/lib/ruby/gems/2.5.0/gems/coderay-1.1.2/lib/coderay/scanners/scanner.rb:132:in `initialize'\n/Users/user-name/.rbenv/versions/2.5.1/lib/ruby/gems/2.5.0/gems/coderay-1.1.2/lib/coderay/encoders/encoder.rb:72:in `new'\n/Users/user-name/.rbenv/versions/2.5.1/lib/ruby/gems/2.5.0/gems/coderay-1.1.2/lib/coderay/encoders/encoder.rb:72:in `encode'\n</code></pre>\n\n<p>In my case, to restart pc was the solution. Usually to reboot shell is the way to reflect changes, but I need to restart pc at that time.</p>\n"}], "owner": {"reputation": 934, "user_id": 3663124, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/dd2b3438ed3252dce5c184b4eace56ba?s=128&d=identicon&r=PG&f=1", "display_name": "fedest", "link": "https://stackoverflow.com/users/3663124/fedest"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 209, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1566992966, "creation_date": 1559764148, "question_id": 56467077, "link": "https://stackoverflow.com/questions/56467077/output-error-loaderror-cannot-load-such-file-enc-trans-single-byte", "title": "output error: #&lt;LoadError: cannot load such file -- enc/trans/single_byte&gt;", "body": "<p>I've reinstalled ruby with rbenv to version 2.4.2, after installation I want to run the rails console but every action I perform that uses any module defined in my code results in this error:</p>\n\n<pre><code>(pry) output error: #&lt;LoadError: cannot load such file -- enc/trans/single_byte&gt;\n</code></pre>\n\n<p>And a pretty long trace that is like this:</p>\n\n<pre><code>/Users/user/.rbenv/versions/2.4.2/lib/ruby/gems/2.4.0/gems/coderay-1.1.2/lib/coderay/scanners/scanner.rb:93:in `encode'\n/Users/user/.rbenv/versions/2.4.2/lib/ruby/gems/2.4.0/gems/coderay-1.1.2/lib/coderay/scanners/scanner.rb:93:in `encode_with_encoding'\n/Users/user/.rbenv/versions/2.4.2/lib/ruby/gems/2.4.0/gems/coderay-1.1.2/lib/coderay/scanners/scanner.rb:57:in `normalize'\n/Users/user/.rbenv/versions/2.4.2/lib/ruby/gems/2.4.0/gems/coderay-1.1.2/lib/coderay/scanners/scanner.rb:132:in `initialize'\n/Users/user/.rbenv/versions/2.4.2/lib/ruby/gems/2.4.0/gems/coderay-1.1.2/lib/coderay/encoders/encoder.rb:72:in `new'\n/Users/user/.rbenv/versions/2.4.2/lib/ruby/gems/2.4.0/gems/coderay-1.1.2/lib/coderay/encoders/encoder.rb:72:in `encode'\n/Users/user/.rbenv/versions/2.4.2/lib/ruby/gems/2.4.0/gems/coderay-1.1.2/lib/coderay.rb:197:in `encode'\n/Users/user/.rbenv/versions/2.4.2/lib/ruby/gems/2.4.0/gems/coderay-1.1.2/lib/coderay/tokens_proxy.rb:23:in `encode'\n/Users/user/.rbenv/versions/2.4.2/lib/ruby/gems/2.4.0/gems/coderay-1.1.2/lib/coderay/tokens_proxy.rb:32:in `method_missing'\n/Users/user/.rbenv/versions/2.4.2/lib/ruby/gems/2.4.0/gems/pry-0.11.0/lib/pry/color_printer.rb:29:in `text'\n/Users/user/.rbenv/versions/2.4.2/lib/ruby/2.4.0/pp.rb:315:in `pretty_print'\n(...)\n/Users/user/.rbenv/versions/2.4.2/lib/ruby/gems/2.4.0/gems/spring-2.0.2/lib/spring/application/boot.rb:19:in `&lt;top (required)&gt;'\n/Users/user/.rbenv/versions/2.4.2/lib/ruby/2.4.0/rubygems/core_ext/kernel_require.rb:55:in `require'\n/Users/user/.rbenv/versions/2.4.2/lib/ruby/2.4.0/rubygems/core_ext/kernel_require.rb:55:in `require'\n-e:1:in `&lt;main&gt;'\n</code></pre>\n\n<p>I've found this answer <a href=\"https://stackoverflow.com/a/13400402/3663124\">https://stackoverflow.com/a/13400402/3663124</a> and yes, I have yml files with non ASCII chars, but they've never been a problem before.</p>\n\n<p>Here's the rbenv install log:</p>\n\n<pre><code>$ rbenv install 2.4.2\nruby-build: use openssl from homebrew\nDownloading ruby-2.4.2.tar.bz2...\n-&gt; https://cache.ruby-lang.org/pub/ruby/2.4/ruby-2.4.2.tar.bz2\nInstalling ruby-2.4.2...\nruby-build: use readline from homebrew\nInstalled ruby-2.4.2 to /Users/user/.rbenv/versions/2.4.2\n</code></pre>\n"}, {"tags": ["ruby", "ruby-2.2"], "comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1559763384, "post_id": 56466898, "comment_id": 99525280, "body": "Does <code>inherited</code> kick in before or after the subclass has been created?"}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1559810330, "post_id": 56466898, "comment_id": 99538166, "body": "Fun fact: the built-in <a href=\"http://ruby-doc.org/core-2.6.3/Module.html#method-i-name\" rel=\"nofollow noreferrer\"><code>name</code></a> method would return <code>&quot;B&quot;</code> in either case (because constant assignment happens before the callback when using the <code>class</code> keyword)."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1559811896, "post_id": 56466898, "comment_id": 99538935, "body": "Add the line <code>puts &quot;cat&quot;</code> right after <code>class B &lt; A</code> and see when it&#39;s displayed."}], "answers": [{"comments": [{"owner": {"reputation": 76630, "user_id": 6946, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/766dcbbf898a4b10cfc1b34f70076f2a?s=128&d=identicon&r=PG", "display_name": "Anurag Uniyal", "link": "https://stackoverflow.com/users/6946/anurag-uniyal"}, "edited": false, "score": 0, "creation_date": 1559767905, "post_id": 56467224, "comment_id": 99527177, "body": "there seems to be a need for post_inherited method, otherwise if I have to process  class by some user defined values it becomes cumbersome."}, {"owner": {"reputation": 1306, "user_id": 8008340, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/15JhO.jpg?s=128&g=1", "display_name": "Konstantin Strukov", "link": "https://stackoverflow.com/users/8008340/konstantin-strukov"}, "reply_to_user": {"reputation": 76630, "user_id": 6946, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/766dcbbf898a4b10cfc1b34f70076f2a?s=128&d=identicon&r=PG", "display_name": "Anurag Uniyal", "link": "https://stackoverflow.com/users/6946/anurag-uniyal"}, "edited": false, "score": 0, "creation_date": 1559768959, "post_id": 56467224, "comment_id": 99527543, "body": "What do you want to do with imaginary <code>post_inherited</code> that cannot be done via class (re)opening and common Ruby idioms?"}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "reply_to_user": {"reputation": 76630, "user_id": 6946, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/766dcbbf898a4b10cfc1b34f70076f2a?s=128&d=identicon&r=PG", "display_name": "Anurag Uniyal", "link": "https://stackoverflow.com/users/6946/anurag-uniyal"}, "edited": false, "score": 0, "creation_date": 1559775862, "post_id": 56467224, "comment_id": 99529555, "body": "@AnuragUniyal, that would require a determination of when the construction of the inherited class is completed, which may be problematic. Moreover, considering that while the child is being constructed it could modify the parent or create a sibling. I&#39;m not sure what the implications of such actions might be for a <code>post_inherited</code> method. I expect the main reason for <code>inherited</code> is build a list of instances."}, {"owner": {"reputation": 76630, "user_id": 6946, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/766dcbbf898a4b10cfc1b34f70076f2a?s=128&d=identicon&r=PG", "display_name": "Anurag Uniyal", "link": "https://stackoverflow.com/users/6946/anurag-uniyal"}, "edited": false, "score": 0, "creation_date": 1559795739, "post_id": 56467224, "comment_id": 99532802, "body": "@KonstantinStrukov it can be done with inherited but not elegant, e.g. how do you make a hash of <code>{name =&gt; subclass}</code>"}, {"owner": {"reputation": 1306, "user_id": 8008340, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/15JhO.jpg?s=128&g=1", "display_name": "Konstantin Strukov", "link": "https://stackoverflow.com/users/8008340/konstantin-strukov"}, "reply_to_user": {"reputation": 76630, "user_id": 6946, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/766dcbbf898a4b10cfc1b34f70076f2a?s=128&d=identicon&r=PG", "display_name": "Anurag Uniyal", "link": "https://stackoverflow.com/users/6946/anurag-uniyal"}, "edited": false, "score": 1, "creation_date": 1559803810, "post_id": 56467224, "comment_id": 99535112, "body": "@AnuragUniyal you can build just a list of descendants using <code>inherited</code> and then build the hash on demand... Or you can use the same approach as Rais does for the <code>.descendants</code> method which doesn&#39;t use hooks at all (ObjectSpace is used instead)"}], "tags": [], "owner": {"reputation": 1306, "user_id": 8008340, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/15JhO.jpg?s=128&g=1", "display_name": "Konstantin Strukov", "link": "https://stackoverflow.com/users/8008340/konstantin-strukov"}, "is_accepted": true, "score": 3, "last_activity_date": 1559769941, "last_edit_date": 1559769941, "creation_date": 1559764928, "answer_id": 56467224, "question_id": 56466898, "link": "https://stackoverflow.com/questions/56466898/why-base-class-method-is-being-called-inside-inherited/56467224#56467224", "title": "Why base class method is being called inside inherited?", "body": "<p>No magic here. </p>\n\n<p>When you declare <code>B</code> the things happen in the following order (roughly speaking):</p>\n\n<ol>\n<li><p><code>B</code> (an instance of <code>Class</code>) is created (which inherits everything from <code>A</code>). At this moment it doesn't have anything specific.</p></li>\n<li><p><code>A.inherited</code> hook is invoked.</p></li>\n<li><p><code>B</code> class is opened and processed. Only at this point, it gets its own properties and methods (except the ones that could be created inside the hook).</p></li>\n</ol>\n\n<p>So, when (2) happens the only <code>name</code> that is available for <code>B</code> is the one defined in <code>A</code>.</p>\n\n<p>This is very easy to check using the following code:</p>\n\n<pre><code>class A\n  def self.name \n    \"a\"\n  end\n\n  def self.inherited(subclass)\n    puts \"B own methods, point 1: #{subclass.methods(false).join(', ')}\"\n  end\nend\n\nclass B &lt; A\n  puts \"B own methods, point 2: #{self.methods(false).join(', ')}\"\n\n  def self.name \n    \"b\"\n  end\n\n  puts \"B own methods, point 3: #{self.methods(false).join(', ')}\"\nend\n\n# B own methods, point 1: \n# B own methods, point 2: \n# B own methods, point 3: name\n</code></pre>\n\n<p>Everything is clear now, right?</p>\n"}], "owner": {"reputation": 76630, "user_id": 6946, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/766dcbbf898a4b10cfc1b34f70076f2a?s=128&d=identicon&r=PG", "display_name": "Anurag Uniyal", "link": "https://stackoverflow.com/users/6946/anurag-uniyal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 71, "favorite_count": 0, "accepted_answer_id": 56467224, "answer_count": 1, "score": 2, "last_activity_date": 1559769941, "creation_date": 1559763253, "question_id": 56466898, "link": "https://stackoverflow.com/questions/56466898/why-base-class-method-is-being-called-inside-inherited", "title": "Why base class method is being called inside inherited?", "body": "<p>In <code>self.inherited</code> method of base class, subclass is passed, calling subclass's <code>name</code> method instead calls base class method. Though same thing works If same method is called on same class elsewhere</p>\n\n<pre><code>class A\n def self.name \n  \"a\"\n end\n\n def self.inherited(subclass)\n  puts B.hash\n  puts B.name\n end\nend\n\nclass B &lt; A\n def self.name \n  \"b\"\n end\nend\n\nputs B.hash\nputs B.name\n</code></pre>\n\n<p>output:</p>\n\n<pre><code>1428955046062147697\na\n1428955046062147697\nb\n</code></pre>\n"}, {"tags": ["ruby", "variables", "azure-devops"], "comments": [{"owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 0, "creation_date": 1559762393, "post_id": 56466598, "comment_id": 99524896, "body": "How do you pass the variable to the program?"}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1559762401, "post_id": 56466598, "comment_id": 99524898, "body": "Maybe you need to escape this somehow, like <code>&amp;amp;</code>, or you&#39;re receiving it via a URL and you forgot to escape it there."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1559762452, "post_id": 56466598, "comment_id": 99524916, "body": "<b>WARNING</b>: Can&#39;t not mention that logging plain-text passwords is a <a href=\"https://www.adweek.com/digital/twitter-corrected-a-bug-that-caused-passwords-to-be-stored-in-plain-text/\" rel=\"nofollow noreferrer\"><b>spectacularly bad idea</b></a>."}, {"owner": {"reputation": 23460, "user_id": 7409220, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Bhmli.jpg?s=128&g=1", "display_name": "Shayki Abramczyk", "link": "https://stackoverflow.com/users/7409220/shayki-abramczyk"}, "edited": false, "score": 0, "creation_date": 1559800492, "post_id": 56466598, "comment_id": 99533944, "body": "Look like the second option that you tried it&#39;s the most close, maybe after you get the password try to remove the <code>&quot; &quot;</code> from the string."}], "answers": [{"tags": [], "owner": {"reputation": 12652, "user_id": 11508192, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/irXPM.png?s=128&g=1", "display_name": "Hugh Lin - MSFT", "link": "https://stackoverflow.com/users/11508192/hugh-lin-msft"}, "is_accepted": false, "score": 0, "last_activity_date": 1559815953, "creation_date": 1559815953, "answer_id": 56475437, "question_id": 56466598, "link": "https://stackoverflow.com/questions/56466598/azure-devops-release-ruby-script-everything-is-cut-after-in-a-secret-variab/56475437#56475437", "title": "Azure DevOps Release - Ruby script: everything is cut after &amp; in a secret variable", "body": "<p>I don't have a ruby script here, but I use powershell to pass variable with the &amp; symbol to a ps1 script, get an error, and prompt according to the error message: the ampersand (&amp;) character is not allowed. The &amp; operator is reserved for future use. You can try to wrap an ampersand in double quotation marks (\"&amp;\") to pass it as part of a string. Hope this helps.</p>\n"}], "owner": {"reputation": 733, "user_id": 5354727, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Ufo0p.png?s=128&g=1", "display_name": "TiredOfProgramming", "link": "https://stackoverflow.com/users/5354727/tiredofprogramming"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 108, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1559815953, "creation_date": 1559761663, "last_edit_date": 1559764998, "question_id": 56466598, "link": "https://stackoverflow.com/questions/56466598/azure-devops-release-ruby-script-everything-is-cut-after-in-a-secret-variab", "title": "Azure DevOps Release - Ruby script: everything is cut after &amp; in a secret variable", "body": "<p>It seems like my problem is very close to the one described <a href=\"https://developercommunity.visualstudio.com/content/problem/498097/azure-devops-variable-secret-password-with-special.html\" rel=\"nofollow noreferrer\">here</a></p>\n\n<p>I have <code>Azure DevOps</code> release definition with the predefined secret variable (not secret in the screenshot below to better illustrate the problem)</p>\n\n<p><a href=\"https://i.stack.imgur.com/cL5Ee.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/cL5Ee.png\" alt=\"Azure DevOps variable\"></a></p>\n\n<p>In the release definition there is Ruby script that reads this variable, but for some strange reason only Smith is taken and everything after that is cut, hence my release keeps failing</p>\n\n<p><strong>Ruby script example</strong>\n<a href=\"https://i.stack.imgur.com/H4VdN.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/H4VdN.png\" alt=\"enter image description here\"></a></p>\n\n<p><strong>Azure DevOps Log example</strong>\n<a href=\"https://i.stack.imgur.com/CFjj9.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/CFjj9.png\" alt=\"enter image description here\"></a></p>\n\n<p>My biggest suspicion is this is something to do with ampersand special character <code>&amp;</code></p>\n\n<p>Has anyone else faced similar situation before? </p>\n\n<p><em>Updating question due to most recent comments</em></p>\n\n<p>I don't pass passwords in clear text. Here, it is done as an example. I always pass it as secret variable\n<a href=\"https://i.stack.imgur.com/Xk3wu.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Xk3wu.png\" alt=\"enter image description here\"></a></p>\n\n<p>Then this secret variable is passed to the script as an argument\n<a href=\"https://i.stack.imgur.com/iXYrF.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/iXYrF.png\" alt=\"enter image description here\"></a></p>\n\n<p>What I've tried so far</p>\n\n<ol>\n<li>This <a href=\"https://i.stack.imgur.com/w6dzj.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/w6dzj.png\" alt=\"enter image description here\"></a> leads to this\n<a href=\"https://i.stack.imgur.com/700Ue.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/700Ue.png\" alt=\"enter image description here\"></a></li>\n</ol>\n\n<hr>\n\n<ol start=\"2\">\n<li><p>This <a href=\"https://i.stack.imgur.com/4btAd.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/4btAd.png\" alt=\"enter image description here\"></a> leads to this <a href=\"https://i.stack.imgur.com/re5T0.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/re5T0.png\" alt=\"enter image description here\"></a></p>\n\n<hr></li>\n<li><p>This <a href=\"https://i.stack.imgur.com/1iIi4.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/1iIi4.png\" alt=\"enter image description here\"></a> leads to this <a href=\"https://i.stack.imgur.com/QGwAv.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/QGwAv.png\" alt=\"enter image description here\"></a></p></li>\n</ol>\n\n<hr>\n"}, {"tags": ["ruby", "squib"], "answers": [{"comments": [{"owner": {"reputation": 15, "user_id": 7742290, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/81719428b02a603c78bd39217fa42061?s=128&d=identicon&r=PG&f=1", "display_name": "tbsp", "link": "https://stackoverflow.com/users/7742290/tbsp"}, "edited": false, "score": 0, "creation_date": 1559835963, "post_id": 56479018, "comment_id": 99552463, "body": "Will do. Thanks Andy!"}], "tags": [], "owner": {"reputation": 270, "user_id": 1325339, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c76f91c37fd0a6386de232f58f585ab0?s=128&d=identicon&r=PG", "display_name": "Andy", "link": "https://stackoverflow.com/users/1325339/andy"}, "is_accepted": true, "score": 0, "last_activity_date": 1559828949, "creation_date": 1559828949, "answer_id": 56479018, "question_id": 56466182, "link": "https://stackoverflow.com/questions/56466182/how-to-embed-semi-transparent-images-in-squib-text-properly/56479018#56479018", "title": "How to embed semi-transparent images in Squib text properly", "body": "<p>This sounds like a bug - can you file it over at our issue tracker? <a href=\"https://github.com/andymeneely/squib/issues\" rel=\"nofollow noreferrer\">https://github.com/andymeneely/squib/issues</a></p>\n\n<p>If you could also upload a PNG to that issue that causes this problem that'd be great too.</p>\n\n<p>Semi-transparent images are natively supported, so they get rendered the same way. Squib doesn't handle them any differently. The embed.png and png methods call the same thing, so I'm not sure what's going on here. I'd be happy to investigate.</p>\n\n<p>Full disclosure: I'm the Squib dev.</p>\n"}], "owner": {"reputation": 15, "user_id": 7742290, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/81719428b02a603c78bd39217fa42061?s=128&d=identicon&r=PG&f=1", "display_name": "tbsp", "link": "https://stackoverflow.com/users/7742290/tbsp"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 30, "favorite_count": 0, "accepted_answer_id": 56479018, "answer_count": 1, "score": 0, "last_activity_date": 1560791752, "creation_date": 1559759656, "last_edit_date": 1560791752, "question_id": 56466182, "link": "https://stackoverflow.com/questions/56466182/how-to-embed-semi-transparent-images-in-squib-text-properly", "title": "How to embed semi-transparent images in Squib text properly", "body": "<p>I'm trying to use semi-transparent inline (embedded) png images with the Squib text method. The semi-transparent portions of the images end up rendering much darker than when the image is placed by itself with the 'png' method.</p>\n\n<p>I've tried different blend modes, but none of them yield the desired results.</p>\n\n<pre><code>require 'squib'\n\nSquib::Deck.new cards: 1 do\n  background color: 'white'\n\n  # This image renders as expected\n  png file: 'semi-transparent.png', x: 100, y: 100\n\n  # The semi-transparent portions of this image render much darker than expected\n  text(str: ':circle:', x: 200, y: 100) do |embed|\n    embed.png key: ':circle:', file: 'semi-transparent.png'\n  end\n\n  save_png\nend\n</code></pre>\n\n<p>This is an example of the output: <a href=\"https://imgur.com/3wrXiBz\" rel=\"nofollow noreferrer\">https://imgur.com/3wrXiBz</a></p>\n\n<p>Any tips on how I can get the embedded image to match the standalone one would be great.</p>\n\n<hr>\n\n<p>I've opened a bug for this issue here: <a href=\"https://github.com/andymeneely/squib/issues/278\" rel=\"nofollow noreferrer\">https://github.com/andymeneely/squib/issues/278</a></p>\n\n<p>I'm currently remapping my embed tokens to single-character strings with the following function to work around the issue:</p>\n\n<pre><code>def remapTokens(x)\n mapping = {':circle:' =&gt; '@', ':square:' =&gt; '#', ':triangle:' =&gt; '^'}\n mapping.each { |k,v| x.gsub!(k,v) }\n return x\nend\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 13756, "user_id": 567762, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/908c9abc72ab86111a153b11cb584f26?s=128&d=identicon&r=PG", "display_name": "Jared Beck", "link": "https://stackoverflow.com/users/567762/jared-beck"}, "edited": false, "score": 0, "creation_date": 1559759037, "post_id": 56465733, "comment_id": 99523454, "body": "Would this question be more clear if you renamed the <code>dealerships.dealership_id</code> column to <code>remote_id</code>?"}], "answers": [{"tags": [], "owner": {"reputation": 1319, "user_id": 5060959, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/2d7af66fc79160e5872515869fad813c?s=128&d=identicon&r=PG&f=1", "display_name": "thedudecodes", "link": "https://stackoverflow.com/users/5060959/thedudecodes"}, "is_accepted": false, "score": 0, "last_activity_date": 1559759195, "creation_date": 1559759195, "answer_id": 56466095, "question_id": 56465733, "link": "https://stackoverflow.com/questions/56465733/how-to-write-belongs-to-association-when-the-foreign-key-can-refer-to-either-of/56466095#56466095", "title": "How to write belongs_to association when the foreign key can refer to either of two different columns?", "body": "<p>By default, create_table will create a primary key called id. You can change the name of the primary key with the :primary_key option (don\u2019t forget to update the corresponding model) or, if you don\u2019t want a primary key at all, you can pass the option id: false.</p>\n\n<p>For creating primary key other than ID you can use the following.</p>\n\n<pre><code>class CreateContentUnits &lt; ActiveRecord::Migration\n  def change\n    create_table :content_units, primary_key: :guoid do |t|\n      t.boolean :active, default: false\n    end\n  end\nend\n</code></pre>\n\n<p>So now <code>guoid</code> will be used as primary key and now you can use your API <code>ID</code> as id in the model</p>\n"}, {"tags": [], "owner": {"reputation": 13756, "user_id": 567762, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/908c9abc72ab86111a153b11cb584f26?s=128&d=identicon&r=PG", "display_name": "Jared Beck", "link": "https://stackoverflow.com/users/567762/jared-beck"}, "is_accepted": true, "score": 1, "last_activity_date": 1559761879, "creation_date": 1559761879, "answer_id": 56466645, "question_id": 56465733, "link": "https://stackoverflow.com/questions/56465733/how-to-write-belongs-to-association-when-the-foreign-key-can-refer-to-either-of/56466645#56466645", "title": "How to write belongs_to association when the foreign key can refer to either of two different columns?", "body": "<blockquote>\n  <p><code>cars.dealership_id</code> can either refer to <code>dealerships.id</code> or <code>dealerships.remote_id</code>.</p>\n</blockquote>\n\n<p>I'd suggest this design is problematic, and I'd recommend changing your database design as follows:</p>\n\n<pre class=\"lang-sql prettyprint-override\"><code>alter table cars\nadd constraint fk_cars_dealerships\nforeign key (dealership_id)\nreferences dealerships (id)\non update cascade\non delete restrict\n;\n</code></pre>\n\n<p>With this change, the association becomes clear.</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>belongs_to :dealership\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 10377293, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/569f3473df685891ddb46c4211a7eb9d?s=128&d=identicon&r=PG", "display_name": "Trrllhrr", "link": "https://stackoverflow.com/users/10377293/trrllhrr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 44, "favorite_count": 0, "accepted_answer_id": 56466645, "answer_count": 2, "score": 1, "last_activity_date": 1559761879, "creation_date": 1559757483, "last_edit_date": 1559761494, "question_id": 56465733, "link": "https://stackoverflow.com/questions/56465733/how-to-write-belongs-to-association-when-the-foreign-key-can-refer-to-either-of", "title": "How to write belongs_to association when the foreign key can refer to either of two different columns?", "body": "<p><code>cars.dealership_id</code> can either refer to <code>dealerships.id</code> or <code>dealerships.remote_id</code>. How should I write my associations?</p>\n\n<p><strong>SCHEMA</strong></p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>create_table \"cars\", id: :serial, force: :cascade do |t|\n    t.string \"name\", limit: 255, null: false\n    t.integer \"dealership_id\", null: false\nend\n\ncreate_table \"dealerships\", id: :serial, force: :cascade do |t|\n  t.string \"name\", limit: 255, null: false\n  t.integer \"remote_id\", null: true\nend\n</code></pre>\n\n<p><strong>MODEL</strong></p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>class Car &lt; ::ApplicationRecord\n  belongs_to :dealership,\n    class_name: '::Dealership',\n    foreign_key: :dealership_id,\n    primary_key: :remote_id\n\n  belongs_to :dealership,\n    class_name: '::Dealership',\n    foreign_key: :dealership_id,\n    primary_key: :id\nend\n</code></pre>\n"}, {"tags": ["html", "css", "ruby-on-rails", "ruby", "bootstrap-4"], "answers": [{"comments": [{"owner": {"reputation": 45, "user_id": 11467874, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Zouoo.png?s=128&g=1", "display_name": "Portabello", "link": "https://stackoverflow.com/users/11467874/portabello"}, "edited": false, "score": 0, "creation_date": 1559837734, "post_id": 56466929, "comment_id": 99553299, "body": "playing around with this some more, but this seems to resolve the issue. Thank you very much for your response!"}], "tags": [], "owner": {"reputation": 482, "user_id": 7310570, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7fe642580f7d3ea75824495d6df570a1?s=128&d=identicon&r=PG&f=1", "display_name": "Kielstra", "link": "https://stackoverflow.com/users/7310570/kielstra"}, "is_accepted": true, "score": 1, "last_activity_date": 1559763432, "creation_date": 1559763432, "answer_id": 56466929, "question_id": 56465716, "link": "https://stackoverflow.com/questions/56465716/responsive-form-in-bootstrap/56466929#56466929", "title": "Responsive Form in Bootstrap", "body": "<p>Bootstrap includes a <a href=\"https://getbootstrap.com/docs/4.0/layout/grid/#grid-options\" rel=\"nofollow noreferrer\">grid system</a>. Maybe you can use this to define the width of the search field. </p>\n\n<p>The grid system divides the width into 12 columns. So you could use for example: </p>\n\n<pre class=\"lang-html prettyprint-override\"><code>.col-sm-12 .col-lg-4\n</code></pre>\n\n<p>You can play around with the values.</p>\n"}, {"comments": [{"owner": {"reputation": 45, "user_id": 11467874, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Zouoo.png?s=128&g=1", "display_name": "Portabello", "link": "https://stackoverflow.com/users/11467874/portabello"}, "edited": false, "score": 0, "creation_date": 1559837871, "post_id": 56470035, "comment_id": 99553357, "body": "Yes, I have added this in the &lt;head&gt; section. Parts of the app are responsive just the search bar isnt. Was able to resolve this issue though. Thanks for the response!"}], "tags": [], "owner": {"reputation": 71, "user_id": 11606561, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-kv3T9ucmpOs/AAAAAAAAAAI/AAAAAAAACEo/kyTw6lrys2o/photo.jpg?sz=128", "display_name": "Thomas M.", "link": "https://stackoverflow.com/users/11606561/thomas-m"}, "is_accepted": false, "score": 2, "last_activity_date": 1559786049, "creation_date": 1559786049, "answer_id": 56470035, "question_id": 56465716, "link": "https://stackoverflow.com/questions/56465716/responsive-form-in-bootstrap/56470035#56470035", "title": "Responsive Form in Bootstrap", "body": "<p>I'll ask the dumb question...  do you have the following in your &lt; head > section?</p>\n\n<pre class=\"lang-html prettyprint-override\"><code>&lt;meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\"&gt;\n</code></pre>\n\n<p>without it, Bootstrap won't be responsive.</p>\n"}], "owner": {"reputation": 45, "user_id": 11467874, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Zouoo.png?s=128&g=1", "display_name": "Portabello", "link": "https://stackoverflow.com/users/11467874/portabello"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 121, "favorite_count": 1, "accepted_answer_id": 56466929, "answer_count": 2, "score": 0, "last_activity_date": 1559786049, "creation_date": 1559757394, "question_id": 56465716, "link": "https://stackoverflow.com/questions/56465716/responsive-form-in-bootstrap", "title": "Responsive Form in Bootstrap", "body": "<p>I am learning Bootstrap and am trying to implement it within a Ruby on Rails projects I have. I am using the bootstrap navbar and am trying to integrate that with rails. I have a search bar that I am trying to make responsive. I want the width of the search form to fill up the available space, and shrink/grow as the screen size changes. The navbar in bootstrap already has a lot of CSS styles applied to it and I feel like trying to add a feature like this to an existing navbar is difficult. </p>\n\n<p>Here is the code for my form...</p>\n\n<p>application.html.erb</p>\n\n<pre><code>&lt;nav class=\"navbar navbar-default navbar-fixed-top\" style=\"background-color: #228822;\"&gt;\n  &lt;div class=\"container-fluid\"&gt;\n    &lt;div class=\"navbar-header\"&gt;\n      &lt;button type=\"button\" class=\"navbar-toggle collapsed\" data-toggle=\"collapse\" data-target=\"#bs-example-navbar-collapse-1\" aria-expanded=\"false\"&gt;\n        &lt;span class=\"sr-only\"&gt;Toggle navigation&lt;/span&gt;\n        &lt;span class=\"icon-bar\"&gt;&lt;/span&gt;\n        &lt;span class=\"icon-bar\"&gt;&lt;/span&gt;\n        &lt;span class=\"icon-bar\"&gt;&lt;/span&gt;\n      &lt;/button&gt;\n      &lt;!-- overriding to HTTP GET because turbolinks causes issues with pagination infinite scroll --&gt;\n      &lt;%=link_to \"The Pragmatic Bookshelf\", store_index_path, :class =&gt; \"navbar-brand\", method: :get, style: \"color:#bbffbb\" %&gt;\n    &lt;/div&gt;\n    &lt;!-- Collect the nav links, forms, and other content for toggling --&gt;\n    &lt;div class=\"collapse navbar-collapse\" id=\"bs-example-navbar-collapse-1\"&gt;\n      &lt;ul class=\"nav navbar-nav\"&gt;\n        &lt;li&gt;&lt;%= link_to t('.questions'), store_index_path, style: \"color:#bbffbb\" %&gt;&lt;/li&gt;\n        &lt;li&gt;&lt;%= link_to t('.news'), store_index_path, style: \"color:#bbffbb\" %&gt;&lt;/li&gt;\n        &lt;li&gt;&lt;%= link_to t('.contact'), store_index_path, style: \"color:#bbffbb\" %&gt;&lt;/li&gt;\n      &lt;/ul&gt;\n      &lt;form class=\"navbar-form navbar-left\"&gt;\n        &lt;div id=\"search_bar\" &gt;\n          &lt;%= form_tag(store_index_path, method: :get) do %&gt;\n            &lt;div class=\"search_bar_text\"&gt;\n              &lt;%= text_field_tag :search, '', id: 'search_bar_text' %&gt;\n            &lt;/div&gt;\n            &lt;div class=\"search_bar_image\"&gt;\n                &lt;%= image_submit_tag 'search.png', id: 'search_bar_image'%&gt;\n            &lt;/div&gt;\n          &lt;% end %&gt;\n        &lt;/div&gt;\n      &lt;/form&gt;\n      &lt;ul class=\"nav navbar-nav navbar-right\"&gt;\n        &lt;li class=\"dropdown\"&gt;\n          &lt;a href=\"#\" class=\"dropdown-toggle\" data-toggle=\"dropdown\" role=\"button\" aria-haspopup=\"true\" aria-expanded=\"false\" style=\"color:#bbffbb;\"&gt;Admin &lt;span class=\"caret\"&gt;&lt;/span&gt;&lt;/a&gt;\n          &lt;ul class=\"dropdown-menu\"&gt;\n            &lt;% if session[:user_id] %&gt;\n              &lt;li&gt;&lt;%= link_to \"Orders\", orders_path%&gt;&lt;/li&gt;\n              &lt;li role=\"separator\" class=\"divider\"&gt;&lt;/li&gt;\n              &lt;li&gt;&lt;%= link_to \"Products\", products_path%&gt;&lt;/li&gt;\n              &lt;li role=\"separator\" class=\"divider\"&gt;&lt;/li&gt;\n              &lt;li&gt;&lt;%= link_to \"Users\", users_path%&gt;&lt;/li&gt;\n              &lt;li role=\"separator\" class=\"divider\"&gt;&lt;/li&gt;\n              &lt;li&gt;&lt;%= link_to \"Logout\", logout_path, method: :delete%&gt;&lt;/li&gt;\n            &lt;% else %&gt;\n              &lt;li&gt;&lt;%= link_to \"Login\", login_path%&gt;&lt;/li&gt;\n            &lt;% end %&gt;\n          &lt;/ul&gt;\n        &lt;/li&gt;\n        &lt;li class=\"dropdown\"&gt;\n          &lt;a href=\"#\" class=\"dropdown-toggle\" data-toggle=\"dropdown\" role=\"button\" aria-haspopup=\"true\" aria-expanded=\"false\" style=\"color:#bbffbb;\"&gt;Language &lt;span class=\"caret\"&gt;&lt;/span&gt;&lt;/a&gt;\n          &lt;ul class=\"dropdown-menu\"&gt;\n            &lt;% LANGUAGES.each do |language|%&gt;\n              &lt;li&gt;&lt;a href=\"\"&gt;&lt;%= link_to language[0].to_s, store_index_url(locale: language[1]) %&gt;&lt;/a&gt;&lt;/li&gt;\n            &lt;% end %&gt;\n          &lt;/ul&gt;\n        &lt;/li&gt;\n      &lt;/ul&gt;\n\n    &lt;/div&gt;&lt;!-- /.navbar-collapse --&gt;\n  &lt;/div&gt;&lt;!-- /.container-fluid --&gt;\n&lt;/nav&gt;\n</code></pre>\n\n<p>I got most of this code from an example in the bootstrap documentation and have been implementing some erb into it to integrate it with my Rails project. The form class=\"navbar-form navbar-left\" is where the search bar starts. The behavior I want is for this to fill up the remaining space between the unordered lists to the right and left and adjust its size based on the current screen size. </p>\n\n<p>I have experimented with display flex and flex-grow, floating, &amp; overflow. Cant seem to get anything working. I wont include my CSS file since its only some font/color changes, most of the CSS is from bootstrap anyways.</p>\n\n<p>Any help/guidance is appreciated :)</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 1319, "user_id": 5060959, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/2d7af66fc79160e5872515869fad813c?s=128&d=identicon&r=PG&f=1", "display_name": "thedudecodes", "link": "https://stackoverflow.com/users/5060959/thedudecodes"}, "edited": false, "score": 0, "creation_date": 1559755437, "post_id": 56465184, "comment_id": 99522078, "body": "try assets precompile on heroku"}, {"owner": {"reputation": 43, "user_id": 10358805, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-3gnreRZBAS8/AAAAAAAAAAI/AAAAAAAAARw/a8UiIpMnVcU/photo.jpg?sz=128", "display_name": "\u0422\u0430\u0440\u0430\u0441 \u041c\u0430\u0442\u0456\u0457\u0432", "link": "https://stackoverflow.com/users/10358805/%d0%a2%d0%b0%d1%80%d0%b0%d1%81-%d0%9c%d0%b0%d1%82%d1%96%d1%97%d0%b2"}, "reply_to_user": {"reputation": 1319, "user_id": 5060959, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/2d7af66fc79160e5872515869fad813c?s=128&d=identicon&r=PG&f=1", "display_name": "thedudecodes", "link": "https://stackoverflow.com/users/5060959/thedudecodes"}, "edited": false, "score": 0, "creation_date": 1559755718, "post_id": 56465184, "comment_id": 99522188, "body": "I tried to run, but nothing changed"}, {"owner": {"reputation": 1319, "user_id": 5060959, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/2d7af66fc79160e5872515869fad813c?s=128&d=identicon&r=PG&f=1", "display_name": "thedudecodes", "link": "https://stackoverflow.com/users/5060959/thedudecodes"}, "edited": false, "score": 0, "creation_date": 1559755809, "post_id": 56465184, "comment_id": 99522224, "body": "check any error in the console log. and try restarting your server"}, {"owner": {"reputation": 43, "user_id": 10358805, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-3gnreRZBAS8/AAAAAAAAAAI/AAAAAAAAARw/a8UiIpMnVcU/photo.jpg?sz=128", "display_name": "\u0422\u0430\u0440\u0430\u0441 \u041c\u0430\u0442\u0456\u0457\u0432", "link": "https://stackoverflow.com/users/10358805/%d0%a2%d0%b0%d1%80%d0%b0%d1%81-%d0%9c%d0%b0%d1%82%d1%96%d1%97%d0%b2"}, "reply_to_user": {"reputation": 1319, "user_id": 5060959, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/2d7af66fc79160e5872515869fad813c?s=128&d=identicon&r=PG&f=1", "display_name": "thedudecodes", "link": "https://stackoverflow.com/users/5060959/thedudecodes"}, "edited": false, "score": 0, "creation_date": 1559755927, "post_id": 56465184, "comment_id": 99522260, "body": "There are no problems, neither in the heroku logs nor in the browser console."}], "answers": [{"comments": [{"owner": {"reputation": 43, "user_id": 10358805, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-3gnreRZBAS8/AAAAAAAAAAI/AAAAAAAAARw/a8UiIpMnVcU/photo.jpg?sz=128", "display_name": "\u0422\u0430\u0440\u0430\u0441 \u041c\u0430\u0442\u0456\u0457\u0432", "link": "https://stackoverflow.com/users/10358805/%d0%a2%d0%b0%d1%80%d0%b0%d1%81-%d0%9c%d0%b0%d1%82%d1%96%d1%97%d0%b2"}, "edited": false, "score": 1, "creation_date": 1559756244, "post_id": 56465344, "comment_id": 99522392, "body": "TY but i use like: <code>&quot;heroku run RAILS_ENV=production bundle exec rake assets:precompile&quot;</code> and it worked"}], "tags": [], "owner": {"reputation": 1319, "user_id": 5060959, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/2d7af66fc79160e5872515869fad813c?s=128&d=identicon&r=PG&f=1", "display_name": "thedudecodes", "link": "https://stackoverflow.com/users/5060959/thedudecodes"}, "is_accepted": true, "score": 1, "last_activity_date": 1559755703, "creation_date": 1559755703, "answer_id": 56465344, "question_id": 56465184, "link": "https://stackoverflow.com/questions/56465184/after-deploy-rails-on-heroku-doest-work-js-and-css/56465344#56465344", "title": "After deploy rails on Heroku Does`t work js and css", "body": "<p>There are two ways you can use the asset pipeline on Heroku.</p>\n\n<ol>\n<li>Compiling assets locally.</li>\n<li>Compiling assets during slug compilation.</li>\n</ol>\n\n<p>To compile your assets locally, run the assets:precompile task locally on your app. Make sure to use the production environment so that the production version of your assets are generated.</p>\n\n<pre><code>RAILS_ENV=production bundle exec rake assets:precompile\n</code></pre>\n\n<p>A public/assets directory will be created</p>\n\n<pre><code>git add public/assets\ngit commit -m \"vendor compiled assets\"\n</code></pre>\n\n<p>For more ref use this link <a href=\"https://devcenter.heroku.com/articles/rails-asset-pipeline\" rel=\"nofollow noreferrer\">enter link description here</a></p>\n"}], "owner": {"reputation": 43, "user_id": 10358805, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-3gnreRZBAS8/AAAAAAAAAAI/AAAAAAAAARw/a8UiIpMnVcU/photo.jpg?sz=128", "display_name": "\u0422\u0430\u0440\u0430\u0441 \u041c\u0430\u0442\u0456\u0457\u0432", "link": "https://stackoverflow.com/users/10358805/%d0%a2%d0%b0%d1%80%d0%b0%d1%81-%d0%9c%d0%b0%d1%82%d1%96%d1%97%d0%b2"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 33, "favorite_count": 1, "accepted_answer_id": 56465344, "answer_count": 1, "score": 0, "last_activity_date": 1559755703, "creation_date": 1559755000, "question_id": 56465184, "link": "https://stackoverflow.com/questions/56465184/after-deploy-rails-on-heroku-doest-work-js-and-css", "title": "After deploy rails on Heroku Does`t work js and css", "body": "<p>After deploy on heroku does not work js (jquery). But on locale  machine all well.</p>\n\n<p>I have file (push_notification.js) with js in javascripts directory.</p>\n\n<pre><code>$((function(){\n  $(\"#dv\").attr('class', 'animated fadeInDown delay-0s')\n  setTimeout(function () {\n      $(\"#dv\").attr('class', 'hidden')\n  }, 6000)\n}));\n</code></pre>\n\n<p>On heroku it does not work. </p>\n\n<p>My application.js</p>\n\n<pre><code>//= require_self\n//= require jquery\n//= require jquery.turbolinks\n//= require rails-ujs\n\n//= require push_notification\n//= require admin_panel\n//= require_tree .\n</code></pre>\n\n<p>Pls prompt me, solution this problem</p>\n"}, {"tags": ["sql", "regex", "ruby", "logstash"], "comments": [{"owner": {"reputation": 82895, "user_id": 372239, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/2twLb.jpg?s=128&g=1", "display_name": "Toto", "link": "https://stackoverflow.com/users/372239/toto"}, "edited": false, "score": 1, "creation_date": 1559753218, "post_id": 56464781, "comment_id": 99521168, "body": "What have you tried? What didn&#39;t work? What did you get? What did you expect? What doesn&#39;t work with your code and where is it?"}, {"owner": {"reputation": 663, "user_id": 2348536, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/8cfa3012a8bc1590698f1b9126b2ff93?s=128&d=identicon&r=PG", "display_name": "beirtipol", "link": "https://stackoverflow.com/users/2348536/beirtipol"}, "reply_to_user": {"reputation": 82895, "user_id": 372239, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/2twLb.jpg?s=128&g=1", "display_name": "Toto", "link": "https://stackoverflow.com/users/372239/toto"}, "edited": false, "score": 0, "creation_date": 1559828561, "post_id": 56464781, "comment_id": 99548212, "body": "I have tried researching the best way to approach the problem, but unfortunately by queries for methods of editing SQL query strings have returned results on SQL syntax itself rather than how to interpret it, hence I&#39;m reaching out here."}, {"owner": {"reputation": 82895, "user_id": 372239, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/2twLb.jpg?s=128&g=1", "display_name": "Toto", "link": "https://stackoverflow.com/users/372239/toto"}, "edited": false, "score": 0, "creation_date": 1559832110, "post_id": 56464781, "comment_id": 99550312, "body": "Have a try with: <a href=\"https://regex101.com/r/poJSBf/1\" rel=\"nofollow noreferrer\">demo</a>. I&#39;m not sure ruby supports <code>\\K</code> but there&#39;re other ways to do the job. This regex replace every <code>id = numerics</code> with <code>id = ?</code> within SQL <code>select * from ...</code>, if you have other cases, please, edit your question and add more tests cases and expected result."}], "answers": [{"tags": [], "owner": {"reputation": 656, "user_id": 5053019, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b93a6a90dfb5b9e3b253c9f318ab5a5b?s=128&d=identicon&r=PG", "display_name": "Flavio Francisco", "link": "https://stackoverflow.com/users/5053019/flavio-francisco"}, "is_accepted": false, "score": 0, "last_activity_date": 1559922462, "last_edit_date": 1559922462, "creation_date": 1559806946, "answer_id": 56472977, "question_id": 56464781, "link": "https://stackoverflow.com/questions/56464781/remove-parameters-from-sql-query-in-with-regex-logstash/56472977#56472977", "title": "Remove parameters from SQL Query in with Regex / LogStash", "body": "<p>I am not a logstash/ruby developer/user, but in terms of regular expression you may try this one:</p>\n\n<blockquote>\n  <p>(=\\s\\W\\w+\\W|=\\s\\d+)</p>\n</blockquote>\n\n<p>You can test this <a href=\"https://regex101.com/r/c4IHzl/1\" rel=\"nofollow noreferrer\">here</a></p>\n\n<pre><code>SELECT * FROM Table1 WHERE Column1 = 1\nSELECT * FROM Table1 WHERE Column1 = 'abc'\nSELECT * FROM Table1 WHERE (Column1 = 'abc' OR Column2 = 1)\nSELECT * FROM Table1 WHERE (Column1 = 'abc' AND Column2 = 1) OR Column2 = 'zxy'\nSELECT * FROM Table1 WHERE (Column1 = 'abc' AND Column2 = 1) OR Column2 = 'zxy' AND \nColumn3 = 2\nSELECT * FROM Table1 WHERE Column1 = 1 AND Column2 = 2\n</code></pre>\n\n<p><strong>Expected Results:</strong></p>\n\n<pre><code>Match 1\nFull match  = 1\nGroup 1.    = 1\n\nMatch 2\nFull match  = 'abc'\nGroup 1.    = 'abc'\n\nMatch 3\nFull match  = 'abc'\nGroup 1.    = 'abc'\n\nMatch 4\nFull match  = 1\nGroup 1.    = 1\n\nMatch 5\nFull match  = 'abc'\nGroup 1.    = 'abc'\n\nMatch 6\nFull match  = 1\nGroup 1.    = 1\n\nMatch 7\nFull match  = 'zxy'\nGroup 1.    = 'zxy'\n\nMatch 8\nFull match  = 'abc'\nGroup 1.    = 'abc'\n\nMatch 9\nFull match  = 1\nGroup 1.    = 1\n\nMatch 10\nFull match  = 'zxy'\nGroup 1.    = 'zxy'\n\nMatch 11\nFull match  = 2\nGroup 1.    = 2\n\nMatch 12\nFull match  = 1\nGroup 1.    = 1\n\nMatch 13\nFull match  = 2\nGroup 1.    = 2\n</code></pre>\n\n<p>Based on these results you can create a function to replace the value of '= 2' to '= ?'.</p>\n\n<p>Hope that it at least gives you a starting point.</p>\n"}], "owner": {"reputation": 663, "user_id": 2348536, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/8cfa3012a8bc1590698f1b9126b2ff93?s=128&d=identicon&r=PG", "display_name": "beirtipol", "link": "https://stackoverflow.com/users/2348536/beirtipol"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 76, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1559922462, "creation_date": 1559753102, "last_edit_date": 1559828851, "question_id": 56464781, "link": "https://stackoverflow.com/questions/56464781/remove-parameters-from-sql-query-in-with-regex-logstash", "title": "Remove parameters from SQL Query in with Regex / LogStash", "body": "<p>A 3rd party system I use logs all SQL queries along with rowcount &amp; response time which I then send to Logstash/Elastic to calculate metrics. As this system doesn't use bind variables, and there are 10's of millions of queries a day, I need to be able to rollup the data, which I can't do if the majority of queries are unique. I need a way to replace the SQL query parameters with '?' as Oracle would do via Cursor Sharing.</p>\n\n<p>i.e.</p>\n\n<p>replace </p>\n\n<pre><code>'SELECT * FROM table_name WHERE id = 123'\n</code></pre>\n\n<p>with</p>\n\n<pre><code>'SELECT * FROM table_name WHERE id = ?'\n</code></pre>\n\n<p>I have access to Ruby scripting magic in Logstash, but unfortunately all of the google results for 'sql regex' or similar return results of how to use regular expressions in SQL, not the other way round. Before I go crafting a regular expression parser, I thought I would check in here to see if others have tried to solve a similar problem.</p>\n\n<p>FYI, have looked at implementing a solution using a Ruby SQL AST library such as <a href=\"https://github.com/lfittl/pg_query\" rel=\"nofollow noreferrer\">https://github.com/lfittl/pg_query</a> but plugging Ruby libraries in to Logstash becomes more of a problem of writing a custom Filter plugin to do the work, which may be the answer, but i'm hoping I'm missing something obvious.</p>\n"}, {"tags": ["ruby"], "answers": [{"comments": [{"owner": {"reputation": 1341, "user_id": 11089758, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XQ5gw.jpg?s=128&g=1", "display_name": "S.Goswami", "link": "https://stackoverflow.com/users/11089758/s-goswami"}, "edited": false, "score": 0, "creation_date": 1559751865, "post_id": 56464459, "comment_id": 99520517, "body": "So, for example, Hash() is Kernel.Hash(), Array() is Kernel.Array(), but Set is a constant!! Oh Set[] is a method!"}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "reply_to_user": {"reputation": 1341, "user_id": 11089758, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XQ5gw.jpg?s=128&g=1", "display_name": "S.Goswami", "link": "https://stackoverflow.com/users/11089758/s-goswami"}, "edited": false, "score": 0, "creation_date": 1559751879, "post_id": 56464459, "comment_id": 99520526, "body": "@S.Goswami: yes, updating."}, {"owner": {"reputation": 1341, "user_id": 11089758, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XQ5gw.jpg?s=128&g=1", "display_name": "S.Goswami", "link": "https://stackoverflow.com/users/11089758/s-goswami"}, "edited": false, "score": 0, "creation_date": 1559751945, "post_id": 56464459, "comment_id": 99520559, "body": "Thanks, but you can&#39;t define a method with []. <code>def X[] end</code> will raise an error. So, what&#39;s going on?"}], "tags": [], "owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "is_accepted": false, "score": 5, "last_activity_date": 1559751992, "last_edit_date": 1559751992, "creation_date": 1559751763, "answer_id": 56464459, "question_id": 56464410, "link": "https://stackoverflow.com/questions/56464410/how-to-pass-arguments-directy-to-a-class-without-calling-new-method/56464459#56464459", "title": "How to pass arguments directy to a class without calling new method?", "body": "<blockquote>\n  <p>So, how can I define a class that can accept arguments without calling the initialize method?</p>\n</blockquote>\n\n<p>You can't. In your examples, <a href=\"https://ruby-doc.org/core-2.6.3/Kernel.html#method-i-Hash\" rel=\"nofollow noreferrer\">Hash</a> and <a href=\"https://ruby-doc.org/core-2.6.3/Kernel.html#method-i-Array\" rel=\"nofollow noreferrer\">Array</a> are actually methods. </p>\n\n<p>And example with <code>Set</code> uses <a href=\"https://ruby-doc.org/stdlib-2.6.3/libdoc/set/rdoc/Set.html#method-c-5B-5D\" rel=\"nofollow noreferrer\">Set::[]</a>, naturally. And so it's not any different from any other class method that returns you instances of that class. For instance, <code>User::create</code> (or what-have-you). </p>\n"}, {"tags": [], "owner": {"reputation": 1341, "user_id": 11089758, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XQ5gw.jpg?s=128&g=1", "display_name": "S.Goswami", "link": "https://stackoverflow.com/users/11089758/s-goswami"}, "is_accepted": true, "score": 1, "last_activity_date": 1559833633, "last_edit_date": 1559833633, "creation_date": 1559755591, "answer_id": 56465316, "question_id": 56464410, "link": "https://stackoverflow.com/questions/56464410/how-to-pass-arguments-directy-to-a-class-without-calling-new-method/56465316#56465316", "title": "How to pass arguments directy to a class without calling new method?", "body": "<blockquote>\n  <p>In Ruby a Hash can be created by:</p>\n  \n  <p>Hash(a: 5, b: 6)</p>\n</blockquote>\n\n<p>Hash() is actually a method of the Kernel module:</p>\n\n<pre><code>p defined?(Hash())           # =&gt; \"method\"\np defined?(Kernel.Hash())    # =&gt; \"method\"\n</code></pre>\n\n<p>But without parentheses, Hash, Array, String, etc. all are just classes:</p>\n\n<pre><code>defined?(Hash)     # =&gt; \"constant\"\ndefined?(Array)    # =&gt; \"constant\"\n</code></pre>\n\n<p>In Ruby 2.6.3, the same goes for Arrays(), Complex(), Float(), Hash(), Integer(), Rational(), String(), and URI() - they all are methods.</p>\n\n<p>But <code>Set</code> is a class:</p>\n\n<pre><code>require 'set'\n\np defined?(Set)    # =&gt; \"constant\"\np set = Set[1,2,3] # =&gt; #&lt;Set: {1, 2, 3}&gt;\np set.to_a         # =&gt; [1, 2, 3]\n</code></pre>\n\n<p>So, Set[1,2,3] is actually calling the [] method of Set. It looks kind of like this:</p>\n\n<pre><code>class Something\n    def initialize(*a)\n        @hash = {}\n        a.each { |v| @hash.store(v, nil) }\n    end\n\n    def self.[](*a) new(*a) end\n\n    define_method(:to_a) { @hash.keys }\n\n    define_method(:inspect) { \"#&lt;#{self.class}: {#{@hash.keys.to_s[1..-2]}}&gt;\" }\n    alias :to_s :inspect\nend\n\np defined?(Something)                                   # =&gt; \"constant\"\np set = Something[1,2,3]                                # =&gt; #&lt;Something: {1, 2, 3}&gt;\np set1 = Something[[1, 2, 3], 2, 2, 3, 4, {4 =&gt; :a}, 5] # =&gt; #&lt;Something: {[1, 2, 3], 2, 3, 4, {4=&gt;:a}, 5}&gt;\n\np set.to_a                                              # =&gt; [1, 2, 3]\np set1.to_a                                             # =&gt; [[1, 2, 3], 2, 3, 4, [4, 4], 5]\n\n</code></pre>\n\n<p>Back to the question:</p>\n\n<blockquote>\n  <p>So, how can I define a class that can accept arguments without calling\n  the initialize method?</p>\n</blockquote>\n\n<p>I don't think it's possible!</p>\n"}], "owner": {"reputation": 1341, "user_id": 11089758, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XQ5gw.jpg?s=128&g=1", "display_name": "S.Goswami", "link": "https://stackoverflow.com/users/11089758/s-goswami"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 51, "favorite_count": 0, "accepted_answer_id": 56465316, "answer_count": 2, "score": 2, "last_activity_date": 1559833633, "creation_date": 1559751571, "question_id": 56464410, "link": "https://stackoverflow.com/questions/56464410/how-to-pass-arguments-directy-to-a-class-without-calling-new-method", "title": "How to pass arguments directy to a class without calling new method?", "body": "<p>In Ruby a Hash can be created by:</p>\n\n<pre><code>Hash(a: 5, b: 6)\n</code></pre>\n\n<p>An Array can be created like this:</p>\n\n<pre><code>Array(100)\n</code></pre>\n\n<p>Sets can be created with the code:</p>\n\n<pre><code>require 'set'\nSet[1,2,3]\n</code></pre>\n\n<p>So, how can I define a class that can accept arguments without calling the initialize method?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "debugging", "visual-studio-code", "bundler"], "answers": [{"comments": [{"owner": {"reputation": 17551, "user_id": 1182464, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/e569ac49e984e3a55ee167b14c11cf41?s=128&d=identicon&r=PG", "display_name": "estani", "link": "https://stackoverflow.com/users/1182464/estani"}, "edited": false, "score": 0, "creation_date": 1560012383, "post_id": 56464373, "comment_id": 99603832, "body": "thanks for the info. But this behaves as expected, bundle exec adds one path line (so the search path is broader not narrower). And yet the file is not found... which makes me think, that it is found but somehow not accepted... any idea?"}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "reply_to_user": {"reputation": 17551, "user_id": 1182464, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/e569ac49e984e3a55ee167b14c11cf41?s=128&d=identicon&r=PG", "display_name": "estani", "link": "https://stackoverflow.com/users/1182464/estani"}, "edited": false, "score": 0, "creation_date": 1560186398, "post_id": 56464373, "comment_id": 99644651, "body": "If it&#39;s not in the <code>Gemfile</code> then it might skip it. Add it to your <code>Gemfile</code> if you want to use it with Bundler."}], "tags": [], "owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "is_accepted": false, "score": 0, "last_activity_date": 1559751438, "creation_date": 1559751438, "answer_id": 56464373, "question_id": 56464226, "link": "https://stackoverflow.com/questions/56464226/should-bundle-exec-find-a-global-gem/56464373#56464373", "title": "should bundle exec find a global gem?", "body": "<p><code>bundle exec</code> does a number of things, primarily changing the Gem environment, but most importantly it alters your search <code>PATH</code> for executables.</p>\n\n<p>Many, like <code>ls</code> which exist outside of Ruby will still be present, but gem executables may be knocked out if not included in the <code>Gemfile</code>.</p>\n\n<p>Check with:</p>\n\n<pre><code>bundle exec gem env\n</code></pre>\n\n<p>And compare with:</p>\n\n<pre><code>gem env\n</code></pre>\n\n<p>You'll see a number of changes in the \"SHELL PATH\" section.</p>\n"}], "owner": {"reputation": 17551, "user_id": 1182464, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/e569ac49e984e3a55ee167b14c11cf41?s=128&d=identicon&r=PG", "display_name": "estani", "link": "https://stackoverflow.com/users/1182464/estani"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 420, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1560012751, "creation_date": 1559750791, "last_edit_date": 1560012751, "question_id": 56464226, "link": "https://stackoverflow.com/questions/56464226/should-bundle-exec-find-a-global-gem", "title": "should bundle exec find a global gem?", "body": "<p>visual studio code launch configuration (not terrible important) tries to start rdebug-ide via</p>\n\n<pre><code>bundle exec rdebug-ide\n</code></pre>\n\n<p>This works only if I add the gems to the Gemfile.</p>\n\n<p>Is bundle exec supposed to only find binaries included in the Gemfiles or should those installed globally, e.g. <code>gem install rdebug-ide</code>, also be accessible from bundle exec?</p>\n\n<p>So this works:</p>\n\n<pre><code>&gt; rdebug-ide\nUsing ruby-debug-base 0.2.2 ...\n</code></pre>\n\n<p>but this doesn't</p>\n\n<pre><code>&gt; bundle exec rdebug-ide\nGem::Exception: can't find executable rdebug-ide for gem ruby-debug-ide. ruby-debug-ide is not currently included in the bundle, perhaps you meant to add it to your Gemfile?\n</code></pre>\n\n<p>and even this works!</p>\n\n<pre><code>&gt; bundle exec ls\nGemfile app ...\n</code></pre>\n\n<p>Extra info: I'm using rbenv, perhaps that affects bundler behavior somehow</p>\n\n<p><strong>UPDATE</strong></p>\n\n<p>@tadman pointed out that bundle exec is altering the path. But as I would have expected it seems to be extending it, not removing anything</p>\n\n<pre><code>$ diff &lt;(gem env) &lt;(bundle exec gem env)\n24a25\n&gt;      - /Users/eng/.rbenv/versions/2.5.3/lib/ruby/gems/2.5.0/bin\n\n$ which rdebug-ide\n/Users/eng/.rbenv/shims/rdebug-ide\n\n$ bundle exec rdebug-ide\nbundler: failed to load command: rdebug-ide \n(/Users/eng/.rbenv/versions/2.5.3/bin/rdebug-ide)\nGem::Exception: can't find executable rdebug-ide for gem ruby-debug-ide. ruby-debug-ide is not currently included in the bundle, perhaps you meant to add it to your Gemfile?\n</code></pre>\n\n<p>furthermore the path is in there:</p>\n\n<pre><code> $ bundle exec gem env | grep $(dirname $(which rdebug-ide))\n - /Users/eng/.rbenv/shims\n</code></pre>\n\n<p>I'm tending to think that <code>rbenv</code> is somehow messing things up.</p>\n"}, {"tags": ["ruby", "memory-leaks", "ruby-2.4"], "comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1559751089, "post_id": 56464215, "comment_id": 99520137, "body": "2.4.4 might have bugs, so does this persist on 2.6.3?"}, {"owner": {"reputation": 5234, "user_id": 79079, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/27fd295ebb207dcbfd231a6dbab29f74?s=128&d=identicon&r=PG", "display_name": "mltsy", "link": "https://stackoverflow.com/users/79079/mltsy"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1559753870, "post_id": 56464215, "comment_id": 99521389, "body": "Looks like the same problem is there, although, if I use MemoryProfiler there is no memory &quot;retained&quot; ... updating post...."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1559753998, "post_id": 56464215, "comment_id": 99521441, "body": "The garbage collector only kicks in when it thinks it needs to. Maybe it&#39;s not considering those allocations serious enough to clean up."}], "answers": [{"comments": [{"owner": {"reputation": 5234, "user_id": 79079, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/27fd295ebb207dcbfd231a6dbab29f74?s=128&d=identicon&r=PG", "display_name": "mltsy", "link": "https://stackoverflow.com/users/79079/mltsy"}, "edited": false, "score": 1, "creation_date": 1559927139, "post_id": 56474046, "comment_id": 99586210, "body": "So... I understand that Ruby doesn&#39;t release memory to the OS, but that doesn&#39;t explain why running <code>100.times { &#47;#{STR}&#47;i }</code> over and over continues to utilize more and more memory, right?  Even after the first interpolation, the interpolated string is discarded, which should free up enough memory for the second one.  Or at least before more memory is allocated from the OS, Ruby should free up all those old unused slots, making space for the next <code>100.times</code>, right??  But running it over and over consumes more and more and more memory, which is what doesn&#39;t make sense to me...?"}], "tags": [], "owner": {"reputation": 1306, "user_id": 8008340, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/15JhO.jpg?s=128&g=1", "display_name": "Konstantin Strukov", "link": "https://stackoverflow.com/users/8008340/konstantin-strukov"}, "is_accepted": false, "score": 1, "last_activity_date": 1559811112, "creation_date": 1559811112, "answer_id": 56474046, "question_id": 56464215, "link": "https://stackoverflow.com/questions/56464215/does-rubys-regexp-interpolation-leak-memory/56474046#56474046", "title": "Does Ruby&#39;s Regexp interpolation leak memory?", "body": "<p>GC does kill unused objects and frees memory for the Ruby process, but the Ruby process <em>never releases this memory to OS</em>. But this is <em>not</em> the same as a memory leak (because under normal circumstances at some point Ruby process has enough memory allocated and doesn't grow any more - very roughly speaking). Memory leaks happen <em>when GC cannot release memory</em> (due to bugs, bad code, etc) and Ruby process has to borrow more and more memory. </p>\n\n<p>This is not the case with your code - it does not contain memory leaks, but it <em>does</em> contain an efficiency problem.</p>\n\n<p>What happens when you do <code>100.times { /#{STR}/i }</code> is that you</p>\n\n<ol>\n<li><p>Create 100 very long strings (when interpolating the constant within the pattern literal)...</p></li>\n<li><p>... and then create 100 regexp from these strings.</p></li>\n</ol>\n\n<p>All this requires unnecessary allocations making Ruby process use more memory (and degrading performance too - GC is quite expensive). Changing the class definition into</p>\n\n<pre><code>class Leak\n  PAT = /\"RANDOM|STUFF|HERE|UNTIL|YOU|GET|TIRED|OF|TYPING|AND|ARE|SATISFIED|THAT|IT|WILL|LEAK|ENOUGH|MEMORY|TO|NOTICE\"*100/i\n\n  def test\n    100.times { PAT }\n  end\nend\n</code></pre>\n\n<p>(e.g. memoize not the string itself but the pattern created from it as a constant and then reuse it) reduces the memory allocations during the same <code>test</code> call by both <code>String</code> and <code>Regexp</code> class in order of magnitude (according to the <code>memory_profiler</code>s report). </p>\n"}, {"tags": [], "owner": {"reputation": 5234, "user_id": 79079, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/27fd295ebb207dcbfd231a6dbab29f74?s=128&d=identicon&r=PG", "display_name": "mltsy", "link": "https://stackoverflow.com/users/79079/mltsy"}, "is_accepted": true, "score": 1, "last_activity_date": 1560786008, "creation_date": 1560786008, "answer_id": 56634651, "question_id": 56464215, "link": "https://stackoverflow.com/questions/56464215/does-rubys-regexp-interpolation-leak-memory/56634651#56634651", "title": "Does Ruby&#39;s Regexp interpolation leak memory?", "body": "<p>It was a memory leak!</p>\n\n<p><a href=\"https://bugs.ruby-lang.org/issues/15916\" rel=\"nofollow noreferrer\">https://bugs.ruby-lang.org/issues/15916</a></p>\n\n<p>Should be fixed in one of the next releases of Ruby (2.6.4 or 2.6.5?)</p>\n"}], "owner": {"reputation": 5234, "user_id": 79079, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/27fd295ebb207dcbfd231a6dbab29f74?s=128&d=identicon&r=PG", "display_name": "mltsy", "link": "https://stackoverflow.com/users/79079/mltsy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 153, "favorite_count": 0, "accepted_answer_id": 56634651, "answer_count": 2, "score": 0, "last_activity_date": 1560786008, "creation_date": 1559750760, "last_edit_date": 1560208392, "question_id": 56464215, "link": "https://stackoverflow.com/questions/56464215/does-rubys-regexp-interpolation-leak-memory", "title": "Does Ruby&#39;s Regexp interpolation leak memory?", "body": "<p>I've got code that is leaking memory in a Sinatra app on Ruby 2.4.4, and I can sort of reproduce it in irb, although it's not totally stable, and I'm wondering if others have this same problem.  It happens when interpolating a large string inside a regular expression literal:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>class Leak\n  STR = \"RANDOM|STUFF|HERE|UNTIL|YOU|GET|TIRED|OF|TYPING|AND|ARE|SATISFIED|THAT|IT|WILL|LEAK|ENOUGH|MEMORY|TO|NOTICE\"*100\n\n  def test\n    100.times { /#{STR}/i }\n  end\nend\n\nt = Leak.new\nt.test # If I run this a few times, it will start leaking about 5MB each time\n</code></pre>\n\n<p>Now, if I run <code>GC.start</code> after this, it will usually clean up about the last 5MB (or however much it's been using), and then <code>t.test</code> will only use a few KB, then almost a MB, then a couple MB, then back to 5MB each time, and once again, <code>GC.start</code> will only collect the last 5.</p>\n\n<p>An alternate way to get the same result without a memory leak is to replace <code>/#{STR}/i</code> with <code>RegExp.new(STR, true)</code>.  That seems to work fine for me.</p>\n\n<p>Is this a legitimate memory leak in Ruby or am I doing something wrong?</p>\n\n<p><strong>UPDATE:</strong>\nOkay, maybe I'm misreading this.  I was looking at the memory usage of the docker container after running <code>GC.start</code>, which would sometimes go down, but since Ruby doesn't always release memory it's not using, I guess it could just be that Ruby <em>uses</em> this memory, and then, even though it's not being retained, it's still not releasing the memory back to the OS.  Using the MemoryProfiler gem I see that total_retained, even after running it several times is 0.</p>\n\n<p>The root problem here was we had containers crashing, theoretically due to memory usage, but perhaps it's not a memory leak, but just a lack of sufficient memory to allow Ruby to consume what it wants?  Are there settings for the GC to help it decide when it's time to clean up before Ruby runs out of memory and crashes?</p>\n\n<p><strong>UPDATE 2:</strong> This still doesn't make sense though - because why would Ruby continue allocating more and more memory just from running the same process over and over (why wouldn't it use the memory previously allocated)?  From what I understand, the GC is designed to run at least once before allocating more memory from the OS, so why is Ruby just allocating more and more memory when I run this several times?</p>\n\n<p><strong>UPDATE 3:</strong> In my isolated test, Ruby does seem to approach a limit where it stops allocating additional memory no matter how many times I run the test (seems to usually be around 120MB), but in my production code, I haven't hit such a limit yet (it goes up past 500MB without slowing down - possibly because there are more instances of this kind of memory usage scattered around the class).  There may be a limit to how much memory it would use, but it seems to be manyfold higher than one would expect to be required to run this code (which really only uses a dozen or so MB for a single run)</p>\n\n<p><strong>Update 4:</strong> I've narrowed down the test case to something that really leaks!  Reading a multibyte character from a file was the key to reproducing the real problem:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>str = \"String that doesn't fit into a single RVALUE, with a multibyte char:\" + 160.chr(Encoding::UTF_8)\nFile.write('weirdstring.txt', str)\n\nclass Leak\n  PATTERN = File.read(\"weirdstring.txt\").freeze\n\n  def test\n    10000.times { /#{PATTERN}/i }\n  end\nend\n\nt = Leak.new\n\nloop do\n  print \"Running... \"\n\n  t.test\n\n\n  # If this doesn't work on your system, just comment these lines out and watch the memory usage of the process with top or something\n  mem = %x[echo 0 $(awk '/Private/ {print \"+\", $2}' /proc/`pidof ruby`/smaps) | bc].chomp.to_i\n  puts \"process memory: #{mem}\"\nend\n</code></pre>\n\n<p>So... this is a real leak, right?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "spring", "overriding", "monkeypatching"], "answers": [{"tags": [], "owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "is_accepted": true, "score": 2, "last_activity_date": 1559749409, "creation_date": 1559749409, "answer_id": 56463856, "question_id": 56463745, "link": "https://stackoverflow.com/questions/56463745/how-to-override-one-method-from-rails-framework/56463856#56463856", "title": "How to override one method from Rails Framework?", "body": "<p>Since this is Ruby you can just do it by putting that exact code in something like <code>config/initializers/active_storage_read_image.rb</code>:</p>\n\n<pre><code>module ActiveStorage\n  class Analyzer::ImageAnalyzer &lt; Analyzer\n  private\n    def read_image\n      # My implementation here\n    end\n  end\nend\n</code></pre>\n\n<p>You may want to add a reminder test in there like this:</p>\n\n<pre><code>if (Rails.version.starts_with?('6.1'))\n  Rails.logger.warning(\"This patch may not be required in Rails 6.1\")\nend\n</code></pre>\n"}], "owner": {"reputation": 2503, "user_id": 1348593, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/abaf929fee8bb15c2d096c0be90e75e6?s=128&d=identicon&r=PG&f=1", "display_name": "Nicolas Maloeuvre", "link": "https://stackoverflow.com/users/1348593/nicolas-maloeuvre"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 81, "favorite_count": 0, "accepted_answer_id": 56463856, "answer_count": 1, "score": 1, "last_activity_date": 1559749409, "creation_date": 1559749015, "question_id": 56463745, "link": "https://stackoverflow.com/questions/56463745/how-to-override-one-method-from-rails-framework", "title": "How to override one method from Rails Framework?", "body": "<p>How to override a method in Rails?</p>\n\n<p>To be more specific, I am on 6.0.0.rc1, and I want this commit, but it will be available only on 6.1 : <a href=\"https://github.com/rails/rails/pull/36072/files\" rel=\"nofollow noreferrer\">https://github.com/rails/rails/pull/36072/files</a></p>\n\n<p>I want to override the private method <code>def read_image</code> from</p>\n\n<pre><code>module ActiveStorage\n  class Analyzer::ImageAnalyzer &lt; Analyzer\n    private\n      def read_image\n</code></pre>\n\n<p>How would you do it, in which Rails folder?</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 152277, "user_id": 438992, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/QouOz.jpg?s=128&g=1", "display_name": "Dave Newton", "link": "https://stackoverflow.com/users/438992/dave-newton"}, "edited": false, "score": 0, "creation_date": 1559748468, "post_id": 56463476, "comment_id": 99518675, "body": "You explicitly have both <code>false</code> and <code>nil</code> values? If so you&#39;re stuck with doing something like this instead of <code>compact</code>. If you have active support you might be able to use <code>blank?</code>"}, {"owner": {"reputation": 39282, "user_id": 336920, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/6e2dbeb23d3fc6552a6e26800ed63289?s=128&d=identicon&r=PG", "display_name": "B Seven", "link": "https://stackoverflow.com/users/336920/b-seven"}, "reply_to_user": {"reputation": 152277, "user_id": 438992, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/QouOz.jpg?s=128&g=1", "display_name": "Dave Newton", "link": "https://stackoverflow.com/users/438992/dave-newton"}, "edited": false, "score": 0, "creation_date": 1559748527, "post_id": 56463476, "comment_id": 99518723, "body": "Yes, I do......"}], "answers": [{"comments": [{"owner": {"reputation": 39282, "user_id": 336920, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/6e2dbeb23d3fc6552a6e26800ed63289?s=128&d=identicon&r=PG", "display_name": "B Seven", "link": "https://stackoverflow.com/users/336920/b-seven"}, "edited": false, "score": 0, "creation_date": 1559748664, "post_id": 56463564, "comment_id": 99518816, "body": "Iterating over array with AR call: <code>deleted = foos.map{|f| f.delete if ...}</code>. Then remove skips and failures."}], "tags": [], "owner": {"reputation": 67463, "user_id": 203130, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/1RE8c.jpg?s=128&g=1", "display_name": "coreyward", "link": "https://stackoverflow.com/users/203130/coreyward"}, "is_accepted": false, "score": 1, "last_activity_date": 1559748449, "creation_date": 1559748449, "answer_id": 56463564, "question_id": 56463476, "link": "https://stackoverflow.com/questions/56463476/what-is-an-idiomatic-way-to-remove-false-and-nil-from-an-array-in-ruby/56463564#56463564", "title": "What is an idiomatic way to remove false and nil from an Array in Ruby?", "body": "<p>There's <code>Array#compact</code>, but that'll only remove <code>nil</code> values, or <code>reject</code> if you want to be more explicit about what you're doing here, but otherwise your suggestion is pretty idiomatic.</p>\n"}, {"comments": [{"owner": {"reputation": 152277, "user_id": 438992, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/QouOz.jpg?s=128&g=1", "display_name": "Dave Newton", "link": "https://stackoverflow.com/users/438992/dave-newton"}, "edited": false, "score": 0, "creation_date": 1559749038, "post_id": 56463709, "comment_id": 99519049, "body": "Oh I didn&#39;t even know that existed :/"}, {"owner": {"reputation": 39282, "user_id": 336920, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/6e2dbeb23d3fc6552a6e26800ed63289?s=128&d=identicon&r=PG", "display_name": "B Seven", "link": "https://stackoverflow.com/users/336920/b-seven"}, "edited": false, "score": 0, "creation_date": 1559749616, "post_id": 56463709, "comment_id": 99519370, "body": "Yes, that&#39;s what I was looking for! <code>ary.select(&amp;:itself)</code>"}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 2, "creation_date": 1559767328, "post_id": 56463709, "comment_id": 99526941, "body": "I started my answer after you posted and posted my answer after you had revised yours to include the content of my answer, but did not notice your edit until now. I&#39;ve therefore deleted my answer."}], "tags": [], "owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "is_accepted": true, "score": 7, "last_activity_date": 1559749050, "last_edit_date": 1559749050, "creation_date": 1559748939, "answer_id": 56463709, "question_id": 56463476, "link": "https://stackoverflow.com/questions/56463476/what-is-an-idiomatic-way-to-remove-false-and-nil-from-an-array-in-ruby/56463709#56463709", "title": "What is an idiomatic way to remove false and nil from an Array in Ruby?", "body": "<p>You can just delete the values you don't like:</p>\n\n<pre><code>ary - [ nil, false ]\n</code></pre>\n\n<p>In Ruby 2.2 you can also do this to remove <em>falsey</em> values:</p>\n\n<pre><code>ary.select(&amp;:itself)\n</code></pre>\n\n<p>Though that's not really shorter.</p>\n\n<p>You can also do:</p>\n\n<pre><code>ary.delete(nil)\nary.delete(false)\n</code></pre>\n\n<p>Which does in-place modification.</p>\n"}], "owner": {"reputation": 39282, "user_id": 336920, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/6e2dbeb23d3fc6552a6e26800ed63289?s=128&d=identicon&r=PG", "display_name": "B Seven", "link": "https://stackoverflow.com/users/336920/b-seven"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 139, "favorite_count": 0, "accepted_answer_id": 56463709, "answer_count": 2, "score": 1, "last_activity_date": 1559749178, "creation_date": 1559748134, "question_id": 56463476, "link": "https://stackoverflow.com/questions/56463476/what-is-an-idiomatic-way-to-remove-false-and-nil-from-an-array-in-ruby", "title": "What is an idiomatic way to remove false and nil from an Array in Ruby?", "body": "<p>I came up with</p>\n\n<pre><code>ary.select{|v| v}\n</code></pre>\n\n<p>But is there something better?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "static-pages", "high-voltage"], "answers": [{"comments": [{"owner": {"reputation": 31, "user_id": 11335427, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-UY_zOEK5h1Y/AAAAAAAAAAI/AAAAAAAATbw/mWqy30DqrIs/photo.jpg?sz=128", "display_name": "Edi Junior", "link": "https://stackoverflow.com/users/11335427/edi-junior"}, "edited": false, "score": 1, "creation_date": 1559749711, "post_id": 56463458, "comment_id": 99519435, "body": "Thanks a lot! I&#39;ll remember to always read the docs completely. Also had to reinitialize the server to see the changes..."}], "tags": [], "owner": {"reputation": 627, "user_id": 10895713, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GTs8n.jpg?s=128&g=1", "display_name": "Max Vinicius", "link": "https://stackoverflow.com/users/10895713/max-vinicius"}, "is_accepted": true, "score": 0, "last_activity_date": 1559748463, "last_edit_date": 1559748463, "creation_date": 1559748051, "answer_id": 56463458, "question_id": 56463117, "link": "https://stackoverflow.com/questions/56463117/how-can-i-set-a-static-page-high-voltage-as-root-in-rails/56463458#56463458", "title": "How can I set a static page (high_voltage) as root in Rails?", "body": "<p>You can configure the root route to a High Voltage page like this:</p>\n\n<pre><code># config/initializers/high_voltage.rb\n\nHighVoltage.configure do |config|\n  config.home_page = 'home'\nend\n</code></pre>\n\n<p>Which will render the page from <code>app/views/pages/home.html.erb</code> when the '/' route of the site is accessed.</p>\n\n<p>Note: High Voltage also creates a search engine friendly 301 redirect. Any attempt to access the path '/home' will be redirected to '/'.</p>\n\n<p>Source: <a href=\"https://github.com/thoughtbot/high_voltage#specifying-a-root-path\" rel=\"nofollow noreferrer\">https://github.com/thoughtbot/high_voltage#specifying-a-root-path</a></p>\n"}], "owner": {"reputation": 31, "user_id": 11335427, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-UY_zOEK5h1Y/AAAAAAAAAAI/AAAAAAAATbw/mWqy30DqrIs/photo.jpg?sz=128", "display_name": "Edi Junior", "link": "https://stackoverflow.com/users/11335427/edi-junior"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 201, "favorite_count": 0, "accepted_answer_id": 56463458, "answer_count": 1, "score": 1, "last_activity_date": 1559748463, "creation_date": 1559746794, "question_id": 56463117, "link": "https://stackoverflow.com/questions/56463117/how-can-i-set-a-static-page-high-voltage-as-root-in-rails", "title": "How can I set a static page (high_voltage) as root in Rails?", "body": "<p>I used gem high_voltage to get static pages and it worked, but now I want to define one of them as root.\nWhat should I write in Routes.rb since I don't have a controller?</p>\n"}, {"tags": ["ruby", "jekyll"], "comments": [{"owner": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "edited": false, "score": 0, "creation_date": 1559741726, "post_id": 56461242, "comment_id": 99514713, "body": "did you answer your own question?  If so you may want to add your solution as an answer."}, {"owner": {"reputation": 43, "user_id": 7648814, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/K9uq1.jpg?s=128&g=1", "display_name": "arturdeluca", "link": "https://stackoverflow.com/users/7648814/arturdeluca"}, "reply_to_user": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "edited": false, "score": 0, "creation_date": 1559744184, "post_id": 56461242, "comment_id": 99516218, "body": "No, I just wanted to point out more specifically how the error shows up. I still intend to use the elif and else clause"}, {"owner": {"reputation": 1814, "user_id": 1449386, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a70caff438923dbf6fbb8e229e23f57f?s=128&d=identicon&r=PG", "display_name": "Frank L&#228;mmer", "link": "https://stackoverflow.com/users/1449386/frank-l%c3%a4mmer"}, "edited": false, "score": 0, "creation_date": 1577009806, "post_id": 56461242, "comment_id": 105069745, "body": "I am having the same problem. My markup looks similar. Which Jekyll version are you using?"}], "owner": {"reputation": 43, "user_id": 7648814, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/K9uq1.jpg?s=128&g=1", "display_name": "arturdeluca", "link": "https://stackoverflow.com/users/7648814/arturdeluca"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 130, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1559741444, "creation_date": 1559740433, "last_edit_date": 1559741444, "question_id": 56461242, "link": "https://stackoverflow.com/questions/56461242/jekyll-error-undefined-method-ancestors-for-nilnilclass", "title": "Jekyll error: undefined method ancestors for nil:NilClass", "body": "<p>My post template in jekyll renders a presentation either of Google slides or of a jupyter notebook html. For this purpose, I use the markdown structure shown below:</p>\n\n<pre><code>---\nlayout: post\ntitle: title\ndate: 2018-10-28 00:00:00 -0500\ncategories: category\nauthor: author\nmedium: jupyter\nlink: [//]: # (Here I insert the presentation url)\nlang: en\n---\n\n&lt;div&gt;\n    {% if page.medium == 'jupyter' %}\n        {% include jupyter.html link=page.link %}\n    {% elsif page.medium == 'gslides' %}\n        {% include gslides.html link=page.link %}\n    {% else %}\n        {% include nodata.html %}\n    {% endif %}\n&lt;/div&gt;\n\n</code></pre>\n\n<p>This generates the desired result. However, during the bundle creation, jekyll outputs this error for each post file:</p>\n\n<pre><code>Error: A Liquid tag in the excerpt of ./file.markdown couldn't be parsed.\nError: could not read file ./file.markdown: undefined method `ancestors' for nil:NilClass\n</code></pre>\n\n<p>I have already looked for any syntax errors along with this and other files, and all seems to be ok. Does someone has gone through a similar problem?</p>\n\n<p>EDIT: I've taken the elif and the else clause of the statement, only then the problem ceases.</p>\n"}, {"tags": ["json", "ruby", "jekyll", "control-characters"], "comments": [{"owner": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "edited": false, "score": 0, "creation_date": 1559743833, "post_id": 56461122, "comment_id": 99516012, "body": "<code>[{&#39;foo&#39;: &#39;bar&#39;}]</code> is not valid json. You can verify this by pasting your JSON into <a href=\"https://jsonlint.com/\" rel=\"nofollow noreferrer\">jsonlint.com</a>.  What do you mean by &quot;I cannot properly access the data&quot;? How are you trying to access the file data?"}, {"owner": {"reputation": 330, "user_id": 9244337, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/15d587365f94387e44f4f569915918d1?s=128&d=identicon&r=PG&f=1", "display_name": "jbowman", "link": "https://stackoverflow.com/users/9244337/jbowman"}, "reply_to_user": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "edited": false, "score": 0, "creation_date": 1559746453, "post_id": 56461122, "comment_id": 99517532, "body": "I have pasted my JSON into jsonlint.com and it is valid. I will edit the PO with a clearer sample of data."}, {"owner": {"reputation": 330, "user_id": 9244337, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/15d587365f94387e44f4f569915918d1?s=128&d=identicon&r=PG&f=1", "display_name": "jbowman", "link": "https://stackoverflow.com/users/9244337/jbowman"}, "reply_to_user": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "edited": false, "score": 0, "creation_date": 1559746811, "post_id": 56461122, "comment_id": 99517738, "body": "By accessing the data I mean via Jekyll&#39;s liquid language i.e. <code>{{ site.data.products }}</code>"}, {"owner": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "edited": false, "score": 0, "creation_date": 1559748069, "post_id": 56461122, "comment_id": 99518488, "body": "please post full back trace errors"}, {"owner": {"reputation": 330, "user_id": 9244337, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/15d587365f94387e44f4f569915918d1?s=128&d=identicon&r=PG&f=1", "display_name": "jbowman", "link": "https://stackoverflow.com/users/9244337/jbowman"}, "reply_to_user": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "edited": false, "score": 0, "creation_date": 1559749353, "post_id": 56461122, "comment_id": 99519226, "body": "I ran <code>bundle exec jekyll serve --trace</code> and posted results. Hope that&#39;s what you meant."}, {"owner": {"reputation": 330, "user_id": 9244337, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/15d587365f94387e44f4f569915918d1?s=128&d=identicon&r=PG&f=1", "display_name": "jbowman", "link": "https://stackoverflow.com/users/9244337/jbowman"}, "reply_to_user": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "edited": false, "score": 1, "creation_date": 1559750125, "post_id": 56461122, "comment_id": 99519668, "body": "@lacostenycoder I don&#39;t know why but it seems to have something to do with the number of results in the response. If I run the plugin as <code>current_page &lt;= 4</code> with 50 results per page then the site builds successfully. Same with <code>current_page &lt;= 2</code> with 100 results per page. So, the build is unsuccessful if more than 200 items are returned from the request."}], "answers": [{"comments": [{"owner": {"reputation": 330, "user_id": 9244337, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/15d587365f94387e44f4f569915918d1?s=128&d=identicon&r=PG&f=1", "display_name": "jbowman", "link": "https://stackoverflow.com/users/9244337/jbowman"}, "edited": false, "score": 0, "creation_date": 1559757223, "post_id": 56462053, "comment_id": 99522727, "body": "the <code>.to_json</code> method results in the same error, but I will try again with the forked Jekyll version"}], "tags": [], "owner": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "is_accepted": false, "score": 0, "last_activity_date": 1559751536, "last_edit_date": 1559751536, "creation_date": 1559743208, "answer_id": 56462053, "question_id": 56461122, "link": "https://stackoverflow.com/questions/56461122/jekyll-build-error-control-characters-not-allowed-in-json-file/56462053#56462053", "title": "jekyll build error: &#39;control characters not allowed&#39; in JSON file", "body": "<p>It seems like a <code>JSON.parse</code> error\nI don't think you want or need <code>pretty</code> format on the file. Maybe try just this:</p>\n\n<pre><code>File.open(\"./_data/products.json\", \"w\") { |file| \n  file.write product_array.to_json\n}\n</code></pre>\n\n<p>But your error seems like it might be related to <a href=\"https://github.com/jekyll/jekyll/issues/504\" rel=\"nofollow noreferrer\">this issue</a> so maybe have a look at the fork posted in the issue to see if it helps.</p>\n"}, {"tags": [], "owner": {"reputation": 3289, "user_id": 721631, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/2ed58126d0a452448d14f002391e3a1c?s=128&d=identicon&r=PG", "display_name": "snowangel", "link": "https://stackoverflow.com/users/721631/snowangel"}, "is_accepted": true, "score": 1, "last_activity_date": 1570986851, "creation_date": 1570986851, "answer_id": 58365932, "question_id": 56461122, "link": "https://stackoverflow.com/questions/56461122/jekyll-build-error-control-characters-not-allowed-in-json-file/58365932#58365932", "title": "jekyll build error: &#39;control characters not allowed&#39; in JSON file", "body": "<p>I'm on the team that maintains the API you're calling, and had the same error. It is to do with non-ASCII characters being included in the response. You can sanitize them like this: </p>\n\n<pre><code>problematic_string.encode(Encoding.find('ASCII'), encoding_options)\n</code></pre>\n\n<p>where <code>encoding_options</code> are</p>\n\n<pre><code>  def encoding_options\n    {\n      :invalid           =&gt; :replace,  # Replace invalid byte sequences\n      :undef             =&gt; :replace,  # Replace anything not defined in ASCII\n      :replace           =&gt; '',        # Use a blank for those replacements\n      :universal_newline =&gt; true       # Always break lines with \\n\n    }\n  end\n</code></pre>\n\n<p>source: <a href=\"https://stackoverflow.com/questions/1268289/how-to-get-rid-of-non-ascii-characters-in-ruby\">How to get rid of non-ascii characters in ruby</a> </p>\n\n<p>The <code>problematic_string</code> will likely be a long text such as a review, production blurb or other descriptive text. </p>\n"}], "owner": {"reputation": 330, "user_id": 9244337, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/15d587365f94387e44f4f569915918d1?s=128&d=identicon&r=PG&f=1", "display_name": "jbowman", "link": "https://stackoverflow.com/users/9244337/jbowman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 179, "favorite_count": 0, "accepted_answer_id": 58365932, "answer_count": 2, "score": 1, "last_activity_date": 1570986851, "creation_date": 1559739946, "last_edit_date": 1559749323, "question_id": 56461122, "link": "https://stackoverflow.com/questions/56461122/jekyll-build-error-control-characters-not-allowed-in-json-file", "title": "jekyll build error: &#39;control characters not allowed&#39; in JSON file", "body": "<p>I've written a plugin which writes JSON output to a file in the _data directory:</p>\n\n<pre><code>while current_page &lt;= total_pages do\n\n  url = 'https://web.consonance.app/api/v2/products.json'\n  query = {\n    'page' =&gt; \"#{current_page}\",\n    'q[publishing_status_eq]' =&gt; '04' \n  }\n  headers = {\n    Authorization: \"Token token=**************************\"\n  }\n  request = HTTParty.get(url, query: query, headers: headers)\n\n  hash = JSON.parse(request.body)\n\n  hash['products'].each do |item|\n    product_array.push(item)\n  end\n\n  current_page += 1\n\nend\n\n# open products.json in data dir and write array output converted from hash back to JSON\n\nFile.open(\"./_data/products.json\", \"w\") { |file| \n  file.puts JSON.pretty_generate(product_array)\n}\n</code></pre>\n\n<p>which puts the desired output as a JSON array in the _data directory with the following format:</p>\n\n<pre><code>[\n  {\n    \"id\": 100,\n    \"work_id\": 50,\n    \"full_title\": \"Title #1\"\n  },\n  {\n    \"id\": 101,\n    \"work_id\": 51,\n    \"full_title\": \"Title #2\"\n  }\n]\n</code></pre>\n\n<p>When I try to build my site, I get the error:</p>\n\n<pre><code>jekyll 3.8.5 | Error:  (/Users/jamiebowman/Documents/web dev/jekyll/press/_data/products.json): control characters are not allowed at line 1 column 1\n</code></pre>\n\n<p>When I remove the square brackets at the beginning and the end of the JSON file, then the site builds, but I cannot properly access the data without it being an array.</p>\n\n<p>What are control characters in this context and why are they stopping the site from building?</p>\n\n<p>Traceback errors</p>\n\n<pre><code>Traceback (most recent call last):\n        30: from /Users/jamiebowman/.rvm/gems/ruby-2.6.3/bin/ruby_executable_hooks:24:in `&lt;main&gt;'\n        29: from /Users/jamiebowman/.rvm/gems/ruby-2.6.3/bin/ruby_executable_hooks:24:in `eval'\n        28: from /Users/jamiebowman/.rvm/gems/ruby-2.6.3/bin/jekyll:23:in `&lt;main&gt;'\n        27: from /Users/jamiebowman/.rvm/gems/ruby-2.6.3/bin/jekyll:23:in `load'\n        26: from /Users/jamiebowman/.rvm/gems/ruby-2.6.3/gems/jekyll-3.8.5/exe/jekyll:15:in `&lt;top (required)&gt;'\n        25: from /Users/jamiebowman/.rvm/gems/ruby-2.6.3/gems/mercenary-0.3.6/lib/mercenary.rb:19:in `program'\n        24: from /Users/jamiebowman/.rvm/gems/ruby-2.6.3/gems/mercenary-0.3.6/lib/mercenary/program.rb:42:in `go'\n        23: from /Users/jamiebowman/.rvm/gems/ruby-2.6.3/gems/mercenary-0.3.6/lib/mercenary/command.rb:220:in `execute'\n        22: from /Users/jamiebowman/.rvm/gems/ruby-2.6.3/gems/mercenary-0.3.6/lib/mercenary/command.rb:220:in `each'\n        21: from /Users/jamiebowman/.rvm/gems/ruby-2.6.3/gems/mercenary-0.3.6/lib/mercenary/command.rb:220:in `block in execute'\n        20: from /Users/jamiebowman/.rvm/gems/ruby-2.6.3/gems/jekyll-3.8.5/lib/jekyll/commands/serve.rb:75:in `block (2 levels) in init_with_program'\n        19: from /Users/jamiebowman/.rvm/gems/ruby-2.6.3/gems/jekyll-3.8.5/lib/jekyll/commands/serve.rb:93:in `start'\n        18: from /Users/jamiebowman/.rvm/gems/ruby-2.6.3/gems/jekyll-3.8.5/lib/jekyll/commands/serve.rb:93:in `each'\n        17: from /Users/jamiebowman/.rvm/gems/ruby-2.6.3/gems/jekyll-3.8.5/lib/jekyll/commands/serve.rb:93:in `block in start'\n        16: from /Users/jamiebowman/.rvm/gems/ruby-2.6.3/gems/jekyll-livereload-0.2.2/lib/jekyll-livereload/build.rb:30:in `process'\n        15: from /Users/jamiebowman/.rvm/gems/ruby-2.6.3/gems/jekyll-3.8.5/lib/jekyll/commands/build.rb:36:in `process'\n        14: from /Users/jamiebowman/.rvm/gems/ruby-2.6.3/gems/jekyll-3.8.5/lib/jekyll/commands/build.rb:65:in `build'\n        13: from /Users/jamiebowman/.rvm/gems/ruby-2.6.3/gems/jekyll-3.8.5/lib/jekyll/command.rb:28:in `process_site'\n        12: from /Users/jamiebowman/.rvm/gems/ruby-2.6.3/gems/jekyll-3.8.5/lib/jekyll/site.rb:69:in `process'\n        11: from /Users/jamiebowman/.rvm/gems/ruby-2.6.3/gems/jekyll-3.8.5/lib/jekyll/site.rb:164:in `read'\n        10: from /Users/jamiebowman/.rvm/gems/ruby-2.6.3/gems/jekyll-3.8.5/lib/jekyll/reader.rb:18:in `read'\n         9: from /Users/jamiebowman/.rvm/gems/ruby-2.6.3/gems/jekyll-3.8.5/lib/jekyll/readers/data_reader.rb:20:in `read'\n         8: from /Users/jamiebowman/.rvm/gems/ruby-2.6.3/gems/jekyll-3.8.5/lib/jekyll/readers/data_reader.rb:38:in `read_data_to'\n         7: from /Users/jamiebowman/.rvm/gems/ruby-2.6.3/gems/jekyll-3.8.5/lib/jekyll/readers/data_reader.rb:38:in `each'\n         6: from /Users/jamiebowman/.rvm/gems/ruby-2.6.3/gems/jekyll-3.8.5/lib/jekyll/readers/data_reader.rb:46:in `block in read_data_to'\n         5: from /Users/jamiebowman/.rvm/gems/ruby-2.6.3/gems/jekyll-3.8.5/lib/jekyll/readers/data_reader.rb:68:in `read_data_file'\n         4: from /Users/jamiebowman/.rvm/gems/ruby-2.6.3/gems/safe_yaml-1.0.5/lib/safe_yaml/load.rb:157:in `load_file'\n         3: from /Users/jamiebowman/.rvm/gems/ruby-2.6.3/gems/safe_yaml-1.0.5/lib/safe_yaml/load.rb:157:in `open'\n         2: from /Users/jamiebowman/.rvm/gems/ruby-2.6.3/gems/safe_yaml-1.0.5/lib/safe_yaml/load.rb:157:in `block in load_file'\n         1: from /Users/jamiebowman/.rvm/gems/ruby-2.6.3/gems/safe_yaml-1.0.5/lib/safe_yaml/load.rb:143:in `load'\n/Users/jamiebowman/.rvm/gems/ruby-2.6.3/gems/safe_yaml-1.0.5/lib/safe_yaml/load.rb:143:in `parse': (/Users/jamiebowman/Documents/web dev/jekyll/press/_data/products.json): control characters are not allowed at line 1 column 1 (Psych::SyntaxError)\n</code></pre>\n"}, {"tags": ["arrays", "ruby", "algorithm"], "comments": [{"owner": {"reputation": 3318, "user_id": 1715255, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/052089e1ebdb07dabb8745fdc82b844f?s=128&d=identicon&r=PG&f=1", "display_name": "hotfix", "link": "https://stackoverflow.com/users/1715255/hotfix"}, "edited": false, "score": 0, "creation_date": 1559738687, "post_id": 56460707, "comment_id": 99512899, "body": "what will happen if the last element is not Zero? should it be multiplicated also?"}, {"owner": {"reputation": 2627, "user_id": 1119043, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/f7141e066d691d7f18765c1ea6389b18?s=128&d=identicon&r=PG", "display_name": "belgoros", "link": "https://stackoverflow.com/users/1119043/belgoros"}, "reply_to_user": {"reputation": 3318, "user_id": 1715255, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/052089e1ebdb07dabb8745fdc82b844f?s=128&d=identicon&r=PG&f=1", "display_name": "hotfix", "link": "https://stackoverflow.com/users/1715255/hotfix"}, "edited": false, "score": 0, "creation_date": 1559738730, "post_id": 56460707, "comment_id": 99512920, "body": "Nope, only every second element should be multiplied, that&#39;s why I tried to use <code>each_slice(2)</code>."}], "answers": [{"comments": [{"owner": {"reputation": 2627, "user_id": 1119043, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/f7141e066d691d7f18765c1ea6389b18?s=128&d=identicon&r=PG", "display_name": "belgoros", "link": "https://stackoverflow.com/users/1119043/belgoros"}, "edited": false, "score": 0, "creation_date": 1559739144, "post_id": 56460857, "comment_id": 99513176, "body": "I&#39;ve already had this solution using <code>with_index</code>and my mentor advised to not use it. Thank you."}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "reply_to_user": {"reputation": 2627, "user_id": 1119043, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/f7141e066d691d7f18765c1ea6389b18?s=128&d=identicon&r=PG", "display_name": "belgoros", "link": "https://stackoverflow.com/users/1119043/belgoros"}, "edited": false, "score": 0, "creation_date": 1559739228, "post_id": 56460857, "comment_id": 99513228, "body": "@belgoros: I&#39;d like to hear the reasoning behind that."}, {"owner": {"reputation": 2627, "user_id": 1119043, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/f7141e066d691d7f18765c1ea6389b18?s=128&d=identicon&r=PG", "display_name": "belgoros", "link": "https://stackoverflow.com/users/1119043/belgoros"}, "edited": false, "score": 0, "creation_date": 1559739392, "post_id": 56460857, "comment_id": 99513334, "body": "<code>Using indexing for side effects (I used even&#47;odd or what you used is the same) is a smell.</code>"}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "reply_to_user": {"reputation": 2627, "user_id": 1119043, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/f7141e066d691d7f18765c1ea6389b18?s=128&d=identicon&r=PG", "display_name": "belgoros", "link": "https://stackoverflow.com/users/1119043/belgoros"}, "edited": false, "score": 0, "creation_date": 1559739603, "post_id": 56460857, "comment_id": 99513466, "body": "@belgoros: that&#39;s weird, because there are no side effects here (or your mentor has &quot;non-standard&quot; definition for this term). Given the problem statement (&quot;multiply every second element&quot;), this code is adequate for the task. Certainly looks better/simpler than jumping through hoops like <code>each_slice</code>. IMHO, obviously."}, {"owner": {"reputation": 2597, "user_id": 3032364, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zN0X3.jpg?s=128&g=1", "display_name": "Gsk", "link": "https://stackoverflow.com/users/3032364/gsk"}, "reply_to_user": {"reputation": 2627, "user_id": 1119043, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/f7141e066d691d7f18765c1ea6389b18?s=128&d=identicon&r=PG", "display_name": "belgoros", "link": "https://stackoverflow.com/users/1119043/belgoros"}, "edited": false, "score": 0, "creation_date": 1559739767, "post_id": 56460857, "comment_id": 99513568, "body": "@belgoros you can find a workaround, but this solution is the correct one. If there&#39;s a valid reason to avoid this, you (and we) deserve a clear explanation on why is that, and not an unsourced axiom."}, {"owner": {"reputation": 2627, "user_id": 1119043, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/f7141e066d691d7f18765c1ea6389b18?s=128&d=identicon&r=PG", "display_name": "belgoros", "link": "https://stackoverflow.com/users/1119043/belgoros"}, "edited": false, "score": 0, "creation_date": 1559739822, "post_id": 56460857, "comment_id": 99513601, "body": "@Sergio Tulentsev: may be it&#39;s because I didn&#39;t describe the task completely saying just that a condition could be applied to the second element in the sliced array. In short, I have to multiply it by 2, then if the result is greater than 9 then subtract 9 from the product. See <a href=\"https://en.wikipedia.org/wiki/Luhn_algorithm\" rel=\"nofollow noreferrer\">Luhn algorithm</a> for more details."}, {"owner": {"reputation": 2627, "user_id": 1119043, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/f7141e066d691d7f18765c1ea6389b18?s=128&d=identicon&r=PG", "display_name": "belgoros", "link": "https://stackoverflow.com/users/1119043/belgoros"}, "reply_to_user": {"reputation": 2597, "user_id": 3032364, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zN0X3.jpg?s=128&g=1", "display_name": "Gsk", "link": "https://stackoverflow.com/users/3032364/gsk"}, "edited": false, "score": 0, "creation_date": 1559739911, "post_id": 56460857, "comment_id": 99513658, "body": "@Gsk, sure, both solutions worked for me, thank you, guys!"}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "reply_to_user": {"reputation": 2627, "user_id": 1119043, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/f7141e066d691d7f18765c1ea6389b18?s=128&d=identicon&r=PG", "display_name": "belgoros", "link": "https://stackoverflow.com/users/1119043/belgoros"}, "edited": false, "score": 0, "creation_date": 1559739914, "post_id": 56460857, "comment_id": 99513662, "body": "@belgoros: in this case, this addition to requirements is inconsequential."}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1559740334, "post_id": 56460857, "comment_id": 99513902, "body": "&quot;See Luhn algorithm for more details&quot; - is this from exercism?"}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "reply_to_user": {"reputation": 2627, "user_id": 1119043, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/f7141e066d691d7f18765c1ea6389b18?s=128&d=identicon&r=PG", "display_name": "belgoros", "link": "https://stackoverflow.com/users/1119043/belgoros"}, "edited": false, "score": 0, "creation_date": 1559740517, "post_id": 56460857, "comment_id": 99514004, "body": "@belgoros: I myself haven&#39;t done this exercise for the ruby track. Let&#39;s see if it&#39;s available to me. :)"}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "reply_to_user": {"reputation": 2627, "user_id": 1119043, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/f7141e066d691d7f18765c1ea6389b18?s=128&d=identicon&r=PG", "display_name": "belgoros", "link": "https://stackoverflow.com/users/1119043/belgoros"}, "edited": false, "score": 0, "creation_date": 1564001143, "post_id": 56460857, "comment_id": 100891659, "body": "@belgoros here&#39;s what I ended up with :) <a href=\"https://exercism.io/tracks/ruby/exercises/luhn/solutions/3b02e9882f68451cb667f29840c8fac0\" rel=\"nofollow noreferrer\">exercism.io/tracks/ruby/exercises/luhn/solutions/&hellip;</a>"}], "tags": [], "owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "is_accepted": false, "score": 2, "last_activity_date": 1564001581, "last_edit_date": 1564001581, "creation_date": 1559739073, "answer_id": 56460857, "question_id": 56460707, "link": "https://stackoverflow.com/questions/56460707/ruby-how-to-slice-an-array-and-sum-its-elements-on-a-condition/56460857#56460857", "title": "Ruby - how to slice an array and sum its elements on a condition", "body": "<p>Here's a way to do exactly that, \"multiply every second element and then sum all\"</p>\n\n<pre><code>input =  [6, 8, 2, 4, 4, 4, 5, 5, 0]\n\ninput.map.with_index{|elem, idx| idx.odd? ? elem * 2 : elem} # =&gt; [6, 16, 2, 8, 4, 8, 5, 10, 0]\n     .sum # =&gt; 59\n</code></pre>\n\n<p>A slight variation of this, not using the index (which <em>might</em> placate the reviewer):</p>\n\n<pre><code>input.zip([false, true].cycle).\n      sum {|elem, is_second| is_second ? elem * 2 : elem}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 1, "creation_date": 1559740568, "post_id": 56461217, "comment_id": 99514033, "body": "I was going to add this to my answer, but since it was your answer that made me think of this, here, you can have it: <code>input.zip([false, true].cycle).map {|elem, is_second| is_second ? elem * 2 : elem}.sum</code>"}, {"owner": {"reputation": 1040, "user_id": 9758920, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5397a7b84da492865cb4443b7389b0f6?s=128&d=identicon&r=PG&f=1", "display_name": "claasic", "link": "https://stackoverflow.com/users/9758920/claasic"}, "reply_to_user": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1559740688, "post_id": 56461217, "comment_id": 99514102, "body": "Thank you a lot! Please add it to your answer for better visibility though!"}], "tags": [], "owner": {"reputation": 1040, "user_id": 9758920, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5397a7b84da492865cb4443b7389b0f6?s=128&d=identicon&r=PG&f=1", "display_name": "claasic", "link": "https://stackoverflow.com/users/9758920/claasic"}, "is_accepted": false, "score": 0, "last_activity_date": 1559740336, "creation_date": 1559740336, "answer_id": 56461217, "question_id": 56460707, "link": "https://stackoverflow.com/questions/56460707/ruby-how-to-slice-an-array-and-sum-its-elements-on-a-condition/56461217#56461217", "title": "Ruby - how to slice an array and sum its elements on a condition", "body": "<pre><code>bool = true \ninput.map do |e| \n    bool ^= true\n    bool ? e * 2 : e\nend.sum\n</code></pre>\n\n<p>I like @Sergio Tulentsev answer better and this answer may not use the index but still another variable for side effects.</p>\n\n<p>What I want to know is whether there is a way to give map() a boolean on its way? I've seen something like that in some other language.</p>\n"}, {"tags": [], "owner": {"reputation": 330, "user_id": 5466412, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UijsH.jpg?s=128&g=1", "display_name": "aqwan", "link": "https://stackoverflow.com/users/5466412/aqwan"}, "is_accepted": false, "score": 0, "last_activity_date": 1559742449, "last_edit_date": 1559742449, "creation_date": 1559742139, "answer_id": 56461720, "question_id": 56460707, "link": "https://stackoverflow.com/questions/56460707/ruby-how-to-slice-an-array-and-sum-its-elements-on-a-condition/56461720#56461720", "title": "Ruby - how to slice an array and sum its elements on a condition", "body": "<p>just for fun, sticking with each_slice </p>\n\n<pre><code>input.each_slice(2).map { |s| s[1] ? [s[0], s[1] * 2] : s[0] }.flatten\n\n# =&gt; [6, 16, 2, 8, 4, 8, 5, 10, 0] \n\ninput.each_slice(2).map { |s| s[1] ? [s[0], s[1] * 2] : s[0] }.flatten.sum\n# =&gt; 59\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 8462, "user_id": 405865, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e29f04f339715955060858e0e65e1311?s=128&d=identicon&r=PG", "display_name": "fphilipe", "link": "https://stackoverflow.com/users/405865/fphilipe"}, "is_accepted": false, "score": 1, "last_activity_date": 1559744882, "last_edit_date": 1559744882, "creation_date": 1559744230, "answer_id": 56462374, "question_id": 56460707, "link": "https://stackoverflow.com/questions/56460707/ruby-how-to-slice-an-array-and-sum-its-elements-on-a-condition/56462374#56462374", "title": "Ruby - how to slice an array and sum its elements on a condition", "body": "<p>To throw in another option:</p>\n\n<pre><code>input\n  .zip([1, 2].cycle)\n  .map { |a| a.inject(:*) }\n  .sum\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 2627, "user_id": 1119043, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/f7141e066d691d7f18765c1ea6389b18?s=128&d=identicon&r=PG", "display_name": "belgoros", "link": "https://stackoverflow.com/users/1119043/belgoros"}, "edited": false, "score": 1, "creation_date": 1559747353, "post_id": 56463184, "comment_id": 99518103, "body": "This could be shorter with: <code>input.each_slice(2).sum { |a, b| a + 2* (b || 0) }</code>."}, {"owner": {"reputation": 9663, "user_id": 5239030, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/76JEw.png?s=128&g=1", "display_name": "iGian", "link": "https://stackoverflow.com/users/5239030/igian"}, "reply_to_user": {"reputation": 2627, "user_id": 1119043, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/f7141e066d691d7f18765c1ea6389b18?s=128&d=identicon&r=PG", "display_name": "belgoros", "link": "https://stackoverflow.com/users/1119043/belgoros"}, "edited": false, "score": 0, "creation_date": 1559750906, "post_id": 56463184, "comment_id": 99520056, "body": "@belgoros, thanks I often forget that <code>sum</code> takes a block. Edited."}], "tags": [], "owner": {"reputation": 9663, "user_id": 5239030, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/76JEw.png?s=128&g=1", "display_name": "iGian", "link": "https://stackoverflow.com/users/5239030/igian"}, "is_accepted": false, "score": 2, "last_activity_date": 1559750863, "last_edit_date": 1559750863, "creation_date": 1559747060, "answer_id": 56463184, "question_id": 56460707, "link": "https://stackoverflow.com/questions/56460707/ruby-how-to-slice-an-array-and-sum-its-elements-on-a-condition/56463184#56463184", "title": "Ruby - how to slice an array and sum its elements on a condition", "body": "<p>Yet another option using <a href=\"https://ruby-doc.org/core-2.6.3/Enumerable.html#method-i-each_slice\" rel=\"nofollow noreferrer\">Enumerable#each_slice</a> and <a href=\"https://ruby-doc.org/core-2.6.3/Enumerable.html#method-i-sum\" rel=\"nofollow noreferrer\">Enumerable#sum</a>, which takes a block:</p>\n\n<pre><code>input.each_slice(2).sum { |a, b| a + 2* (b || 0) }\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 73209, "user_id": 290394, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/d7908f05c89e965f6bc5308ad6f41256?s=128&d=identicon&r=PG", "display_name": "steenslag", "link": "https://stackoverflow.com/users/290394/steenslag"}, "edited": false, "score": 0, "creation_date": 1559763059, "post_id": 56463591, "comment_id": 99525167, "body": "Last 2 lines of method perhaps: <code>digit %= 9</code> or just <code>digit % 9</code>"}, {"owner": {"reputation": 2627, "user_id": 1119043, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/f7141e066d691d7f18765c1ea6389b18?s=128&d=identicon&r=PG", "display_name": "belgoros", "link": "https://stackoverflow.com/users/1119043/belgoros"}, "reply_to_user": {"reputation": 73209, "user_id": 290394, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/d7908f05c89e965f6bc5308ad6f41256?s=128&d=identicon&r=PG", "display_name": "steenslag", "link": "https://stackoverflow.com/users/290394/steenslag"}, "edited": false, "score": 0, "creation_date": 1559768136, "post_id": 56463591, "comment_id": 99527250, "body": "I updated the code, - we could set a default value to <code>0</code> for the <code>last</code> variable."}, {"owner": {"reputation": 2627, "user_id": 1119043, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/f7141e066d691d7f18765c1ea6389b18?s=128&d=identicon&r=PG", "display_name": "belgoros", "link": "https://stackoverflow.com/users/1119043/belgoros"}, "reply_to_user": {"reputation": 73209, "user_id": 290394, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/d7908f05c89e965f6bc5308ad6f41256?s=128&d=identicon&r=PG", "display_name": "steenslag", "link": "https://stackoverflow.com/users/290394/steenslag"}, "edited": false, "score": 0, "creation_date": 1559768313, "post_id": 56463591, "comment_id": 99527307, "body": "@steenslag: I don&#39;t think so.  If the result of this doubling operation is greater than 9 (e.g., 8 &#215; 2 = 16), then add the digits of the result (e.g., 16: 1 + 6 = 7, 18: 1 + 8 = 9) or, alternatively, the same final result can be found by subtracting 9 from that result (e.g., 16: 16 \u2212 9 = 7, 18: 18 \u2212 9 = 9)."}, {"owner": {"reputation": 73209, "user_id": 290394, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/d7908f05c89e965f6bc5308ad6f41256?s=128&d=identicon&r=PG", "display_name": "steenslag", "link": "https://stackoverflow.com/users/290394/steenslag"}, "edited": false, "score": 0, "creation_date": 1559769493, "post_id": 56463591, "comment_id": 99527751, "body": "Oh I missed it was luhn exercise. <code>digit.digits.sum</code> might be an alternative."}], "tags": [], "owner": {"reputation": 2627, "user_id": 1119043, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/f7141e066d691d7f18765c1ea6389b18?s=128&d=identicon&r=PG", "display_name": "belgoros", "link": "https://stackoverflow.com/users/1119043/belgoros"}, "is_accepted": false, "score": 1, "last_activity_date": 1559768087, "last_edit_date": 1559768087, "creation_date": 1559748552, "answer_id": 56463591, "question_id": 56460707, "link": "https://stackoverflow.com/questions/56460707/ruby-how-to-slice-an-array-and-sum-its-elements-on-a-condition/56463591#56463591", "title": "Ruby - how to slice an array and sum its elements on a condition", "body": "<p>The solution I came to is the improved version of @iGian's one:</p>\n\n<pre><code>digits = [6, 8, 2, 4, 4, 4, 5, 5, 0]\ndigits.each_slice(2).sum { |first, last=0| first + my_custom_function(last) }\n\ndef my_custom_function(digit)\n  digit *= 2\n  digit -= 9 if digit &gt; 9\n  digit\nend\n</code></pre>\n\n<p>Hope this helps.</p>\n"}], "owner": {"reputation": 2627, "user_id": 1119043, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/f7141e066d691d7f18765c1ea6389b18?s=128&d=identicon&r=PG", "display_name": "belgoros", "link": "https://stackoverflow.com/users/1119043/belgoros"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 197, "favorite_count": 0, "answer_count": 6, "score": 0, "last_activity_date": 1564001581, "creation_date": 1559738519, "last_edit_date": 1559745939, "question_id": 56460707, "link": "https://stackoverflow.com/questions/56460707/ruby-how-to-slice-an-array-and-sum-its-elements-on-a-condition", "title": "Ruby - how to slice an array and sum its elements on a condition", "body": "<p>I can't find a way to achieve the following:</p>\n\n<ul>\n<li>given an array of Integers</li>\n<li>multiply every second number</li>\n<li>sum all the integers</li>\n</ul>\n\n<p>I tried to use <code>Enumerble#each_slice</code> but still no idea on how to call <code>Array#sum</code> on a modified array sliced part:</p>\n\n<pre><code>input =  [6, 8, 2, 4, 4, 4, 5, 5, 0]\ninput.each_slice(2) {|slice| p slice }\n#=&gt; \n[6, 8]\n[2, 4]\n[4, 4]\n[5, 5]\n[0]\n</code></pre>\n\n<p>Now I'd like to multiply every last element in every pair (a <a href=\"https://en.wikipedia.org/wiki/Luhn_algorithm\" rel=\"nofollow noreferrer\">condition</a> could be applied before multiplication):</p>\n\n<pre><code>[6, 8] =&gt; 8 *2\n[2, 4] =&gt; 4 *2\n[4, 4] =&gt; 4 *2\n[5, 5] =&gt; 5 *2\n[0]\n</code></pre>\n\n<p>and sum all the numbers of the initial array with its every second number multiplied:</p>\n\n<pre><code>[6, 16, 2, 8, 4, 8, 5, 10, 0].sum\n</code></pre>\n\n<p>Any idea?\nThank you.</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 2694, "user_id": 3956205, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42aff84cfa87f92797cb54bdea6d0c20?s=128&d=identicon&r=PG", "display_name": "BTL", "link": "https://stackoverflow.com/users/3956205/btl"}, "edited": false, "score": 0, "creation_date": 1559727299, "post_id": 56457809, "comment_id": 99507559, "body": "Can you show us the code of the <code>&#47;Users&#47;Code&#47;Ruby&#47;musicapp&#47;db&#47;migrate&#47;20190605091214_add_quan&zwnj;&#8203;tity_to_line_items.r&zwnj;&#8203;b</code> file ?"}, {"owner": {"reputation": 105, "user_id": 11539591, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/15f70196f5d8b372232969cea4f7ae28?s=128&d=identicon&r=PG&f=1", "display_name": "developing", "link": "https://stackoverflow.com/users/11539591/developing"}, "reply_to_user": {"reputation": 2694, "user_id": 3956205, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42aff84cfa87f92797cb54bdea6d0c20?s=128&d=identicon&r=PG", "display_name": "BTL", "link": "https://stackoverflow.com/users/3956205/btl"}, "edited": false, "score": 0, "creation_date": 1559727502, "post_id": 56457809, "comment_id": 99507668, "body": "@BTL sure! nps, I&#39;ve updated it."}, {"owner": {"reputation": 1543, "user_id": 5801853, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/e1b0fbad41fb9e1ee84161ebff1ddbbc?s=128&d=identicon&r=PG", "display_name": "yzalavin", "link": "https://stackoverflow.com/users/5801853/yzalavin"}, "edited": false, "score": 0, "creation_date": 1559727600, "post_id": 56457809, "comment_id": 99507712, "body": "Remove the comma after <code>:integer</code>."}], "answers": [{"comments": [{"owner": {"reputation": 1175, "user_id": 2861567, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GRa02.jpg?s=128&g=1", "display_name": "quyetdc", "link": "https://stackoverflow.com/users/2861567/quyetdc"}, "edited": false, "score": 2, "creation_date": 1559728258, "post_id": 56458037, "comment_id": 99508033, "body": "should be <code>line_items</code>, not <code>addresses</code>"}], "tags": [], "owner": {"reputation": 2694, "user_id": 3956205, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42aff84cfa87f92797cb54bdea6d0c20?s=128&d=identicon&r=PG", "display_name": "BTL", "link": "https://stackoverflow.com/users/3956205/btl"}, "is_accepted": true, "score": 3, "last_activity_date": 1559728268, "last_edit_date": 1559728268, "creation_date": 1559727914, "answer_id": 56458037, "question_id": 56457809, "link": "https://stackoverflow.com/questions/56457809/rails-syntax-error-when-add-column-to-model/56458037#56458037", "title": "rails syntax error when add column to model", "body": "<p>If I understand correctly what you want to achieve is this : </p>\n\n<pre><code>class AddQuantityToLineItems &lt; ActiveRecord::Migration[5.2]\n  def change\n    add_column :line_items, :quantity, :integer, default: 1\n  end\nend\n\n</code></pre>\n\n<p>There are 2 mistakes in your migration script : </p>\n\n<ul>\n<li>You can not put comma (<code>,</code>)</li>\n<li>Default migration generator does not handle default values, You have to  manually update the migration.</li>\n</ul>\n\n<p>So the migration script should only be <code>rails g migration add_quantity_to_line_items quantity:integer</code></p>\n"}], "owner": {"reputation": 105, "user_id": 11539591, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/15f70196f5d8b372232969cea4f7ae28?s=128&d=identicon&r=PG&f=1", "display_name": "developing", "link": "https://stackoverflow.com/users/11539591/developing"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 70, "favorite_count": 0, "accepted_answer_id": 56458037, "answer_count": 1, "score": 1, "last_activity_date": 1559746383, "creation_date": 1559726997, "last_edit_date": 1559746383, "question_id": 56457809, "link": "https://stackoverflow.com/questions/56457809/rails-syntax-error-when-add-column-to-model", "title": "rails syntax error when add column to model", "body": "<p>I am trying to build a music app with rails where I encountered error, just wondering does anyone know what it means?</p>\n\n<p>when I did</p>\n\n<pre><code>rails g migration add_quantity_to_line_items quantity:integer, default: 1\nrails db:migrate\n</code></pre>\n\n<p>which threw back</p>\n\n<pre><code>rails aborted!\nSyntaxError: /Users/Code/Ruby/musicapp/db/migrate/20190605091214_add_quantity_to_line_items.rb:4: syntax error, unexpected tSYMBEG, expecting do or '{' or '('\n    add_column :line_items, :default, :string\n               ^\n/Users/mrswordsmith/Code/Ruby/musicapp/db/migrate/20190605091214_add_quantity_to_line_items.rb:5: syntax error, unexpected tINTEGER, expecting tSTRING_CONTENT or tSTRING_DBEG or tSTRING_DVAR or tSTRING_END\n    add_column :line_items, :1, :string\n</code></pre>\n\n<pre><code>class AddQuantityToLineItems &lt; ActiveRecord::Migration[5.2]\n  def change\n    add_column :line_items, :quantity, :integer,\n    add_column :line_items, :default, :string\n    add_column :line_items, :1, :string\n  end\nend\n</code></pre>\n"}, {"tags": ["ruby", "recursion"], "answers": [{"tags": [], "owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "is_accepted": false, "score": 1, "last_activity_date": 1559724773, "creation_date": 1559724773, "answer_id": 56457190, "question_id": 56457020, "link": "https://stackoverflow.com/questions/56457020/ruby-how-do-i-remove-nil-empty-values-from-a-nested-hash-and-why-arent-my-atte/56457190#56457190", "title": "Ruby: How do I remove nil/empty values from a nested hash and why aren&#39;t my attempts doing so?", "body": "<p>The trick would be to recursively compact nested hashes and then to eliminate empty values.</p>\n\n<pre><code>compact = -&gt;(hash) { \n  hash.is_a?(Hash) ?\n    hash.map { |k, v| [k, compact.(v)] }.\n         to_h.\n         delete_if { |_, v| v.nil? || v.respond_to?(:empty?) &amp;&amp; v.empty? } :\n    hash \n}\ncompact.(input)\n#\u21d2 {:b=&gt;\"b\", :d=&gt;{:dd=&gt;\"dd\", :ff=&gt;\"ff\"}}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 1, "creation_date": 1559725257, "post_id": 56457272, "comment_id": 99506573, "body": "<code>value.class == Hash</code> should be <code>value.class &lt;= Hash</code> or better <code>value.is_a?(Hash)</code>, otherwise the code would fail on any <code>Hash</code> descendant, like <code>Hashie::Mash</code>. Also, first immediate <code>compact</code> is redundant, just use <code>v.nil? || v.empty?</code> in <code>reject</code>."}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 1, "creation_date": 1559731760, "post_id": 56457272, "comment_id": 99509570, "body": "<i>&quot;Is this &#39;tail-end&#39; recursion?&quot;</i> \u2013 no, because <code>deep_compact</code> is not the last expression in your method."}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 1, "creation_date": 1559736095, "post_id": 56457272, "comment_id": 99511532, "body": "<i>\u201cIs this &#39;tail-end&#39; recursion?\u201d</i> \u2014 it does matter much actually because MRI has TCO off by default (though one might turn it on.)"}], "tags": [], "owner": {"reputation": 1880, "user_id": 3574603, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/71a7b92124991652bf4dd64a9c50a9ca?s=128&d=identicon&r=PG&f=1", "display_name": "user3574603", "link": "https://stackoverflow.com/users/3574603/user3574603"}, "is_accepted": false, "score": 1, "last_activity_date": 1559725053, "creation_date": 1559725053, "answer_id": 56457272, "question_id": 56457020, "link": "https://stackoverflow.com/questions/56457020/ruby-how-do-i-remove-nil-empty-values-from-a-nested-hash-and-why-arent-my-atte/56457272#56457272", "title": "Ruby: How do I remove nil/empty values from a nested hash and why aren&#39;t my attempts doing so?", "body": "<p>I discovered that by placing my recursive function call at the end of the block got me most of the way there. (Is this 'tail-end' recursion?)</p>\n\n<p>I also call <code>reject</code> on the hash returned by <code>transform_values</code> to removed any empty pairs.</p>\n\n<p>This achieves what I wanted:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>def deep_compact(hash)\n  hash.compact.transform_values do |value|\n    next value unless value.class == Hash\n    deep_compact(value)\n  end.reject { |_k, v| v.empty? }\nend\n</code></pre>\n\n<pre class=\"lang-sh prettyprint-override\"><code>&gt; h\n=&gt; {:a=&gt;nil, :b=&gt;\"b\", :c=&gt;nil, :d=&gt;{:dd=&gt;\"dd\", :ee=&gt;nil, :ff=&gt;\"ff\"}, :e=&gt;{:gg=&gt;nil, :hh=&gt;nil}}\n&gt; deep_compact h\n=&gt; {:b=&gt;\"b\", :d=&gt;{:dd=&gt;\"dd\", :ff=&gt;\"ff\"}}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 9663, "user_id": 5239030, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/76JEw.png?s=128&g=1", "display_name": "iGian", "link": "https://stackoverflow.com/users/5239030/igian"}, "is_accepted": false, "score": 1, "last_activity_date": 1559730374, "creation_date": 1559730374, "answer_id": 56458673, "question_id": 56457020, "link": "https://stackoverflow.com/questions/56457020/ruby-how-do-i-remove-nil-empty-values-from-a-nested-hash-and-why-arent-my-atte/56458673#56458673", "title": "Ruby: How do I remove nil/empty values from a nested hash and why aren&#39;t my attempts doing so?", "body": "<p>Other option using <a href=\"https://ruby-doc.org/core-2.6.3/Hash.html#method-i-reject-21\" rel=\"nofollow noreferrer\">Hash#reject!</a>, it changes the original Hash:</p>\n\n<pre><code>def deep_compact(h)\n  h.each { |_, v| deep_compact(v) if v.is_a? Hash }.reject! { |_, v| v.nil? || v.empty? }\nend\n\ndeep_compact(h)\n#=&gt; {:b=&gt;\"b\", :d=&gt;{:dd=&gt;\"dd\", :ff=&gt;\"ff\"}}\n</code></pre>\n"}], "owner": {"reputation": 1880, "user_id": 3574603, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/71a7b92124991652bf4dd64a9c50a9ca?s=128&d=identicon&r=PG&f=1", "display_name": "user3574603", "link": "https://stackoverflow.com/users/3574603/user3574603"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 179, "favorite_count": 0, "answer_count": 3, "score": 1, "last_activity_date": 1559730374, "creation_date": 1559724143, "question_id": 56457020, "link": "https://stackoverflow.com/questions/56457020/ruby-how-do-i-remove-nil-empty-values-from-a-nested-hash-and-why-arent-my-atte", "title": "Ruby: How do I remove nil/empty values from a nested hash and why aren&#39;t my attempts doing so?", "body": "<p>I'm trying to write a method that removes all keys in a nested hash that point to nil recursively.</p>\n\n<p>For example:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>{:a=&gt;nil, :b=&gt;\"b\", :c=&gt;nil, :d=&gt;{:dd=&gt;\"dd\", :ee=&gt;nil, :ff=&gt;\"ff\"}, :e=&gt;{:gg=&gt;nil, :hh=&gt;nil}}\n</code></pre>\n\n<p>becomes:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>{:b=&gt;\"b\", :d=&gt;{:dd=&gt;\"dd\", :ff=&gt;\"ff\"}}\n</code></pre>\n\n<p>I'm not having much luck though.</p>\n\n<p>My most recent attempt looks like:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>def deep_compact(hash)\n  hash.reject do |key, value|\n    deep_compact(value) if value.class == Hash\n    next true if value.nil? || value.empty?\n  end\nend\n</code></pre>\n\n<p>Here I want to iterate over each key value pair in the hash. If the value is a hash, I want to do the same for that hash. I want to reject the pair if the value is nil or empty. Otherwise, I want to keep it.</p>\n\n<p>The result isn't what I want:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>#=&gt; {:b=&gt;\"b\", :d=&gt;{:dd=&gt;\"dd\", :ee=&gt;nil, :ff=&gt;\"ff\"}, :e=&gt;{:gg=&gt;nil, :hh=&gt;nil}}\n</code></pre>\n\n<p>I have also tried:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>def deep_compact(hash)\n  hash.compact.transform_values do |value|\n    deep_compact(value) if value.class == Hash\n    value\n  end\nend\n</code></pre>\n\n<p>Again, I get the same result:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>#=&gt; {:b=&gt;\"b\", :d=&gt;{:dd=&gt;\"dd\", :ee=&gt;nil, :ff=&gt;\"ff\"}, :e=&gt;{:gg=&gt;nil, :hh=&gt;nil}}\n</code></pre>\n\n<p>This leaves me to believe that either I've missed something or my understanding of recursion is wrong.</p>\n\n<p>Are any of my attempts close? What do I need to do to ensure I get the result I want: <code>{:b=&gt;\"b\", :d=&gt;{:dd=&gt;\"dd\", :ff=&gt;\"ff\"}}</code>?</p>\n"}, {"tags": ["mysql", "ruby-on-rails", "ruby"], "answers": [{"tags": [], "owner": {"reputation": 1175, "user_id": 2861567, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GRa02.jpg?s=128&g=1", "display_name": "quyetdc", "link": "https://stackoverflow.com/users/2861567/quyetdc"}, "is_accepted": true, "score": 2, "last_activity_date": 1559722702, "creation_date": 1559722702, "answer_id": 56456638, "question_id": 56456584, "link": "https://stackoverflow.com/questions/56456584/query-data-that-match-string-by-two-columns/56456638#56456638", "title": "Query data that match string by two columns", "body": "<p>If you're using <code>mysql</code>, you can use <code>CONCAT</code> to join <code>category</code> and <code>name</code>, then, make a <code>LIKE</code> query as normal</p>\n\n<pre><code>Product.where(\"LOWER(CONCAT(name, ' ', category)) LIKE :query OR LOWER(CONCAT(category, ' ', name)) LIKE :query\", query: \"%#{params[:query].downcase}%\")\n</code></pre>\n\n<p>With this query, both of the cases: <code>Dell, Computer, Dell Computer or Computer Dell</code> can be found</p>\n"}, {"comments": [{"owner": {"reputation": 2738, "user_id": 747114, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/111517710867e6e4ad41e4f7784f9799?s=128&d=identicon&r=PG", "display_name": "rlarcombe", "link": "https://stackoverflow.com/users/747114/rlarcombe"}, "edited": false, "score": 0, "creation_date": 1559723537, "post_id": 56456811, "comment_id": 99505670, "body": "I forgot that you need to surround each keyword with %, for ilike to work in the way you need it to."}, {"owner": {"reputation": 1175, "user_id": 2861567, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GRa02.jpg?s=128&g=1", "display_name": "quyetdc", "link": "https://stackoverflow.com/users/2861567/quyetdc"}, "edited": false, "score": 0, "creation_date": 1559724931, "post_id": 56456811, "comment_id": 99506399, "body": "Agree that Searchkick and Ransack is powerful and should do the job"}], "tags": [], "owner": {"reputation": 2738, "user_id": 747114, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/111517710867e6e4ad41e4f7784f9799?s=128&d=identicon&r=PG", "display_name": "rlarcombe", "link": "https://stackoverflow.com/users/747114/rlarcombe"}, "is_accepted": false, "score": 0, "last_activity_date": 1559723393, "creation_date": 1559723393, "answer_id": 56456811, "question_id": 56456584, "link": "https://stackoverflow.com/questions/56456584/query-data-that-match-string-by-two-columns/56456811#56456811", "title": "Query data that match string by two columns", "body": "<p>Full text search is really what you need for your use case.</p>\n\n<p>You might consider using Elasticsearch which is dead easy to set up with the <a href=\"https://github.com/ankane/searchkick\" rel=\"nofollow noreferrer\">Searchkick gem</a>.</p>\n\n<p>Another option for more complex searching, that wouldn't require a seperate search index, would be the <a href=\"https://github.com/activerecord-hackery/ransack\" rel=\"nofollow noreferrer\">Ransack gem</a>.</p>\n\n<p>But to answer your specific question, I suggest defining a class method in your product model, that converts the search term to an array of strings, and then performs the look up, something like:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>def self.by_name_or_category(search)\n\n  return None unless search.present?\n\n  keywords = search.split(' ').map {|k| \"%#{k}%\" }\n\n  where('name ilike any ( array[?] )', keywords)\n    .or(Product.where('category ilike any ( array[?] )', keywords))\n\nend\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user11581234"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 57, "favorite_count": 1, "accepted_answer_id": 56456638, "answer_count": 2, "score": 2, "last_activity_date": 1559723393, "creation_date": 1559722474, "question_id": 56456584, "link": "https://stackoverflow.com/questions/56456584/query-data-that-match-string-by-two-columns", "title": "Query data that match string by two columns", "body": "<p>Assume that I have products table with two columns <code>category</code> and <code>name</code>. \nNow user can find <code>product</code> by <code>category</code> or <code>name</code> or both of <code>category</code> and <code>name</code></p>\n\n<p>For example, a <code>product</code> has <code>category</code> computer and <code>name</code> Dell. User enter in search box \"Computer\", \"Dell\" or \"Dell computer\" or \"computer Dell\", both can return that <code>product</code></p>\n\n<p>Any idea about <code>Activerecord</code> query for this?</p>\n"}, {"tags": ["ruby", "rspec", "mocking", "double"], "comments": [{"owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 1, "creation_date": 1559718396, "post_id": 56455454, "comment_id": 99503531, "body": "Perhaps it is just me, but at the moment I see no reason the mock an <code>account</code> in a <code>statement_spec</code> because the statement in your example has no association to an account. In an <code>account_spec</code> it might make sense to mock <code>Statement</code> or you simply can assign <code>nil</code> \u2013 that depends on the method you try to test. Can you please add an example of the method that you actually want to test and how the test should look like?"}, {"owner": {"reputation": 351, "user_id": 11196706, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f06fbb48577defe7d7b222b6a05a98f?s=128&d=identicon&r=PG&f=1", "display_name": "juemura7", "link": "https://stackoverflow.com/users/11196706/juemura7"}, "reply_to_user": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 0, "creation_date": 1559721878, "post_id": 56455454, "comment_id": 99504894, "body": "Thanks so much for your reply! I think you&#39;re probably right! I have updated my post with the method and the test as it is currently."}, {"owner": {"reputation": 5312, "user_id": 6535997, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/10156345016155058/picture?type=large", "display_name": "Mark", "link": "https://stackoverflow.com/users/6535997/mark"}, "edited": false, "score": 0, "creation_date": 1559722232, "post_id": 56455454, "comment_id": 99505057, "body": "<a href=\"https://semaphoreci.com/community/tutorials/mocking-with-rspec-doubles-and-expectations\" rel=\"nofollow noreferrer\">semaphoreci.com/community/tutorials/&hellip;</a> should help you figure out what you should and shouldn&#39;t use doubles for"}], "answers": [{"tags": [], "owner": {"reputation": 13378, "user_id": 1430810, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/v669u.jpg?s=128&g=1", "display_name": "arieljuod", "link": "https://stackoverflow.com/users/1430810/arieljuod"}, "is_accepted": false, "score": 0, "last_activity_date": 1559790591, "creation_date": 1559790591, "answer_id": 56470448, "question_id": 56455454, "link": "https://stackoverflow.com/questions/56455454/how-do-i-mock-a-class-with-initialized-methods-using-rspec/56470448#56470448", "title": "How do I mock a class with initialized methods using Rspec?", "body": "<p>Your test does much more than it says it does. It only expect the string to hace certain format but it does extra work. I would test different things:</p>\n\n<p>your statement_spec.rb</p>\n\n<pre><code>describe '.format' do\n  it 'returns the statement as a table' do\n    statement = Statement.new\n    statement.display = [15.00, 0, 15.00]\n    expect(statement.format).to eq Date.today.strftime('%d/%m/%Y') + ' || 15.00 ||  || 15.00'\n  end\nend\n</code></pre>\n\n<p>and on your account spec (I don't know your actual code, it's just to give you the idea of splitting the specs)</p>\n\n<pre><code>describe 'it sets statement display values' do\n  account = Account.new\n  account.deposit(15.00)\n  expect(account.statement.display).to include 15.00\nend\n</code></pre>\n\n<p>Now the statement spec does not care about accounts, and the account spec related to de statement has a real statement to work with.</p>\n"}], "owner": {"reputation": 351, "user_id": 11196706, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f06fbb48577defe7d7b222b6a05a98f?s=128&d=identicon&r=PG&f=1", "display_name": "juemura7", "link": "https://stackoverflow.com/users/11196706/juemura7"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 104, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1559790591, "creation_date": 1559717329, "last_edit_date": 1559721855, "question_id": 56455454, "link": "https://stackoverflow.com/questions/56455454/how-do-i-mock-a-class-with-initialized-methods-using-rspec", "title": "How do I mock a class with initialized methods using Rspec?", "body": "<p>I am trying to practice using doubles and mocking in my Rspec tests in order to isolate my dependencies. At the moment I am making a simple banking program that has 2 classes - an Account class, responsible for the transaction logic such as updating balance, crediting, debiting etc. I also have a Statement class, responsible for formatting a bank statement based on the account transaction history. </p>\n\n<p>My Account class is initialized as follows: </p>\n\n<pre><code>def initialize(statement = Statement.new)\n    @balance = 0.00\n    @credit = ''\n    @debit = ''\n    @date = Date.today.strftime('%d/%m/%Y')\n    @transaction = []\n    @statement = statement\nend\n</code></pre>\n\n<p>My Statement class is iniitalized as follows: </p>\n\n<pre><code>  def initialize\n    @display = []\n  end\n</code></pre>\n\n<p>(The display array is an array of transaction arrays, which are all the transactions that have occurred in that particular account). </p>\n\n<p>In my statement_spec.rb file, I want to use a double of the Account class. How do I set up an Account double that already has a Statement with a full display? At the moment I have:</p>\n\n<p><code>account = double(Account.new(statement = statement))</code> but I want to make sure that the display has transactions in them so I can test the Statement class methods with an a fake, functioning account? </p>\n\n<p>Sorry if I haven't explained that very clearly. Struggling to get my head around mocking so any help is really appreciated! Thanks :) </p>\n\n<p>UPDATE: \nThe method I am testing is this:</p>\n\n<pre><code>  def format\n    puts 'date || credit || debit || balance'\n    @display.map do |transaction|\n      return @display.join(' || ')\n    end\n  end\n</code></pre>\n\n<p>And the current test is this:</p>\n\n<pre><code>  describe '#format' do\n    it 'prints the statement as a table' do\n      account = Account.new\n      account.deposit(15.00)\n      account.complete_transaction\n      expect(account.statement.format).to eq Date.today.strftime('%d/%m/%Y') + ' || 15.00 ||  || 15.00'\n    end\n  end\n</code></pre>\n"}, {"tags": ["ruby", "macos", "rubygems", "jekyll"], "answers": [{"comments": [{"owner": {"reputation": 599, "user_id": 1290063, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/7059df85ce4c16bd9efb64dd9c40d431?s=128&d=identicon&r=PG", "display_name": "Nielsen Rechia", "link": "https://stackoverflow.com/users/1290063/nielsen-rechia"}, "edited": false, "score": 0, "creation_date": 1567477419, "post_id": 56517485, "comment_id": 101964349, "body": "I have Command Line Tools installed but is not in Developer folder... There is another location for that?"}, {"owner": {"reputation": 77, "user_id": 7011593, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TJ1LY.jpg?s=128&g=1", "display_name": "chengxcv5", "link": "https://stackoverflow.com/users/7011593/chengxcv5"}, "reply_to_user": {"reputation": 599, "user_id": 1290063, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/7059df85ce4c16bd9efb64dd9c40d431?s=128&d=identicon&r=PG", "display_name": "Nielsen Rechia", "link": "https://stackoverflow.com/users/1290063/nielsen-rechia"}, "edited": false, "score": 0, "creation_date": 1568596904, "post_id": 56517485, "comment_id": 102311537, "body": "first check if command line tool installed use <code>&#47;usr&#47;bin&#47;xcodebuild -version</code>\uff0cthen if yes use grep to findout where is location"}], "tags": [], "owner": {"reputation": 77, "user_id": 7011593, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TJ1LY.jpg?s=128&g=1", "display_name": "chengxcv5", "link": "https://stackoverflow.com/users/7011593/chengxcv5"}, "is_accepted": false, "score": 0, "last_activity_date": 1568597337, "last_edit_date": 1568597337, "creation_date": 1560106428, "answer_id": 56517485, "question_id": 56455315, "link": "https://stackoverflow.com/questions/56455315/i-am-unable-to-install-jekyll-on-macos-high-sierra-bundle-install-stops-on-ffi/56517485#56517485", "title": "I am unable to install Jekyll on macOs High Sierra. bundle install stops on ffi make error", "body": "<ul>\n<li>try this </li>\n</ul>\n\n<pre><code>$ open /Library/Developer/CommandLineTools/Packages/\n</code></pre>\n\n<ul>\n<li>then run package </li>\n</ul>\n\n<pre><code>macOS_SDK_headers_for_macOS_10.14.pkg\n</code></pre>\n\n<p>the answer is reference here<a href=\"https://blog.driftingruby.com/updated-to-mojave/\" rel=\"nofollow noreferrer\">enter link description here</a>,\nif this work please give me a vote thanks</p>\n"}], "owner": {"reputation": 98, "user_id": 8327251, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtydf.jpg?s=128&g=1", "display_name": "Nikhil Bansal", "link": "https://stackoverflow.com/users/8327251/nikhil-bansal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 460, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1568597337, "creation_date": 1559716542, "last_edit_date": 1559726039, "question_id": 56455315, "link": "https://stackoverflow.com/questions/56455315/i-am-unable-to-install-jekyll-on-macos-high-sierra-bundle-install-stops-on-ffi", "title": "I am unable to install Jekyll on macOs High Sierra. bundle install stops on ffi make error", "body": "<p>I am trying to install Jekyll on macOs and the <code>bundle install</code> command fails while install the <code>ffi</code> gem. Below is the error.</p>\n\n<pre><code>/bin/sh ./libtool  --tag=CC   --mode=link xcrun clang  -arch i386  -Wall -fexceptions -no-undefined\n-version-info `grep -v '^#'\n/private/var/folders/l7/th5yr79s4q91ln9ycpx4ht5h0000gn/T/bundler20190605-84487-xz6vrpffi-1.11.1/gems/ffi-1.11.1/ext/ffi_c/libffi/libtool-version`\n'-arch' 'i386'  -arch i386 -o libffi.la -rpath /usr/local/lib src/prep_cif.lo src/types.lo src/raw_api.lo\nsrc/java_raw_api.lo src/closures.lo  src/x86/ffi.lo src/x86/sysv.lo\nlibtool: link:  xcrun clang -dynamiclib  -o .libs/libffi.7.dylib  src/.libs/prep_cif.o src/.libs/types.o\nsrc/.libs/raw_api.o src/.libs/java_raw_api.o src/.libs/closures.o src/x86/.libs/ffi.o src/x86/.libs/sysv.o   \n-arch i386 -arch i386 -arch i386   -install_name  /usr/local/lib/libffi.7.dylib -compatibility_version 9\n-current_version 9.0 -Wl,-single_module\nld: warning: The i386 architecture is deprecated for macOS (remove from the Xcode build setting: ARCHS)\nUndefined symbols for architecture i386:\n  \"___x86.get_pc_thunk.bx\", referenced from:\n      _ffi_call_i386 in sysv.o\n      _ffi_closure_raw_SYSV in sysv.o\n      _ffi_closure_raw_THISCALL in sysv.o\n  \"___x86.get_pc_thunk.dx\", referenced from:\n      _ffi_closure_i386 in sysv.o\n      _ffi_closure_STDCALL in sysv.o\nld: symbol(s) not found for architecture i386\nclang: error: linker command failed with exit code 1 (use -v to see invocation)\nmake[3]: *** [libffi.la] Error 1\nmake[2]: *** [all-recursive] Error 1\nmake[1]: *** [all] Error 2\nmake: ***\n[\"/private/var/folders/l7/th5yr79s4q91ln9ycpx4ht5h0000gn/T/bundler20190605-84487-xz6vrpffi-1.11.1/gems/ffi-1.11.1/ext/ffi_c\"/libffi-i386/.libs/libffi_convenience.a]\nError 2\n\nmake failed, exit code 2\n\nGem files will remain installed in\n/var/folders/l7/th5yr79s4q91ln9ycpx4ht5h0000gn/T/bundler20190605-84487-xz6vrpffi-1.11.1/gems/ffi-1.11.1 for\ninspection.\nResults logged to\n/var/folders/l7/th5yr79s4q91ln9ycpx4ht5h0000gn/T/bundler20190605-84487-xz6vrpffi-1.11.1/extensions/universal-darwin-17/2.3.0/ffi-1.11.1/gem_make.out\n\nAn error occurred while installing ffi (1.11.1), and Bundler cannot continue.\nMake sure that `gem install ffi -v '1.11.1' --source 'https://rubygems.org/'` succeeds before bundling.\n\nIn Gemfile:\n  github-pages was resolved to 198, which depends on\n    github-pages-health-check was resolved to 1.16.1, which depends on\n      typhoeus was resolved to 1.3.1, which depends on\n        ethon was resolved to 0.12.0, which depends on\n          ffi\n\n</code></pre>\n"}, {"tags": ["ruby", "ruby-on-rails-3", "static", "backend"], "comments": [{"owner": {"reputation": 334, "user_id": 2606111, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FUdFG.jpg?s=128&g=1", "display_name": "Mahys116", "link": "https://stackoverflow.com/users/2606111/mahys116"}, "edited": false, "score": 0, "creation_date": 1559691034, "post_id": 56452307, "comment_id": 99498091, "body": "Do you saw Service Objects pattern? I think this is what you say. And ruby community already use it."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 1, "creation_date": 1559691962, "post_id": 56452307, "comment_id": 99498258, "body": "Kahne, your question is a good one and very well-written. Unfortunately, it will probably be closed as being off-topic for SO (too broad). See SO&#39;s <a href=\"https://stackoverflow.com/help\">help</a> page. (Don&#39;t feel bad.) Your question, &quot;When is it a good idea to define a static ruby class?&quot; is really mute, because there is no way to do that."}, {"owner": {"reputation": 1, "user_id": 11579539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/791d3456d37801466499c66cc562de72?s=128&d=identicon&r=PG&f=1", "display_name": "Kahne Raja", "link": "https://stackoverflow.com/users/11579539/kahne-raja"}, "edited": false, "score": 0, "creation_date": 1559692215, "post_id": 56452307, "comment_id": 99498314, "body": "thanks for the head up! yes. it is broad. i&#39;m really looking for a list of governing principles around when to &#39;go static&#39; and when NOT to &#39;go static&#39;."}, {"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 0, "creation_date": 1559810238, "post_id": 56452307, "comment_id": 99538120, "body": "Your question is unclear. What is a &quot;static class&quot;? There is no such thing as a &quot;static class&quot; in Ruby. In fact, there is almost nothing &quot;static&quot; at all in Ruby, almost everything is dynamically dispatched."}, {"owner": {"reputation": 1, "user_id": 11579539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/791d3456d37801466499c66cc562de72?s=128&d=identicon&r=PG&f=1", "display_name": "Kahne Raja", "link": "https://stackoverflow.com/users/11579539/kahne-raja"}, "edited": false, "score": 0, "creation_date": 1559909818, "post_id": 56452307, "comment_id": 99577010, "body": "For the sake of this discussion. A \u201cstatic class\u201d in Ruby is a class that is not initialized. When does it pay to write in a \u201cfunctional\u201d way in Ruby? In this sense, how it is actully dispatches at run time seems like an orthogonal concern. I\u2019m focusing on \u201cdesign\u201d optimization."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 11579539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/791d3456d37801466499c66cc562de72?s=128&d=identicon&r=PG&f=1", "display_name": "Kahne Raja", "link": "https://stackoverflow.com/users/11579539/kahne-raja"}, "edited": false, "score": 0, "creation_date": 1559732100, "post_id": 56454141, "comment_id": 99509715, "body": "Thanks Jonah. That is on point. I guess I\u2019m hunting down thoughts on a how to build rails apps with a mix of both OO and Functional code. Some things we choose to initialize because they are shared or maintain state (like models) and some things we choose to make static because they are pure logic. I\u2019m also stilling puzzling over this notion of \u201cidiomatic\u201d in the face of these deeper clean code concerns."}, {"owner": {"reputation": 1, "user_id": 11579539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/791d3456d37801466499c66cc562de72?s=128&d=identicon&r=PG&f=1", "display_name": "Kahne Raja", "link": "https://stackoverflow.com/users/11579539/kahne-raja"}, "edited": false, "score": 0, "creation_date": 1559732413, "post_id": 56454141, "comment_id": 99509840, "body": "Will def check out dry-rb too. Thanks."}], "tags": [], "owner": {"reputation": 14450, "user_id": 438615, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/Dseeq.jpg?s=128&g=1", "display_name": "Jonah", "link": "https://stackoverflow.com/users/438615/jonah"}, "is_accepted": false, "score": 2, "last_activity_date": 1559707681, "creation_date": 1559707681, "answer_id": 56454141, "question_id": 56452307, "link": "https://stackoverflow.com/questions/56452307/when-is-it-a-good-idea-to-define-a-static-ruby-class/56454141#56454141", "title": "When is it a good idea to define a static ruby class?", "body": "<p>What you are saying is that you want to use classes as nothing more than namespaces for pure functions.</p>\n\n<p>There's nothing wrong with this, and you <em>can</em> use ruby this way, but you'll be going against the grain of the language in many ways.  This is a much longer discussion.</p>\n\n<p>Also, I wouldn't frame this as static vs instantiated.  You're really asking about a pure functional vs an OO approach.  And finally, don't equate OO with \"mutation.\"  You can use immutable value objects in ruby, and I recommend them.  You might want to check out the dry-rb ecosystem for a disciplined approach that advocates pure functional concepts in a way that is harmonious with ruby's natural support for objects. </p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 11579539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/791d3456d37801466499c66cc562de72?s=128&d=identicon&r=PG&f=1", "display_name": "Kahne Raja", "link": "https://stackoverflow.com/users/11579539/kahne-raja"}, "is_accepted": false, "score": 0, "last_activity_date": 1559742242, "creation_date": 1559742242, "answer_id": 56461755, "question_id": 56452307, "link": "https://stackoverflow.com/questions/56452307/when-is-it-a-good-idea-to-define-a-static-ruby-class/56461755#56461755", "title": "When is it a good idea to define a static ruby class?", "body": "<p>Another answer copied from a colleague [CH].</p>\n\n<p>I always like to benchmark some of these decisions:</p>\n\n<pre><code>require 'benchmark'\n\nclass ClassMethod\n  def self.do_work\n    1_000_000 * 1_000_000\n  end\nend\n\nclass InstanceMethod\n  def do_work\n    1_000_000 * 1_000_000\n  end\nend\n\nclass InstanceMethodHiddenByClassMethod\n  def self.do_work\n    new.do_work\n  end\n\n  def do_work\n    1_000_000 * 1_000_000\n  end\nend\n\niterations = 10_000_000\n\nBenchmark.bm do |x|\n  x.report(\"class method\") do\n    iterations.times do\n      ClassMethod.do_work\n    end\n  end\n\n  x.report(\"instance method\") do\n    iterations.times do\n      InstanceMethod.new.do_work\n    end\n  end\n\n  x.report(\"class hiding instance pattern\") do\n    iterations.times do\n      InstanceMethodHiddenByClassMethod.do_work\n    end\n  end\nend\n</code></pre>\n\n<p>Results</p>\n\n<pre><code>user                           system     total      real\nclass method                   0.520000   0.010000   0.530000 (  0.531997)\ninstance method                1.130000   0.000000   1.130000 (  1.131185)\nclass hiding instance pattern  1.270000   0.010000   1.280000 (  1.282921)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 11579539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/791d3456d37801466499c66cc562de72?s=128&d=identicon&r=PG&f=1", "display_name": "Kahne Raja", "link": "https://stackoverflow.com/users/11579539/kahne-raja"}, "is_accepted": false, "score": 0, "last_activity_date": 1559742816, "last_edit_date": 1559742816, "creation_date": 1559742470, "answer_id": 56461827, "question_id": 56452307, "link": "https://stackoverflow.com/questions/56452307/when-is-it-a-good-idea-to-define-a-static-ruby-class/56461827#56461827", "title": "When is it a good idea to define a static ruby class?", "body": "<p>Hmm. Governing principles?</p>\n\n<p>When to write a static ruby class:</p>\n\n<ul>\n<li>when it's there to encapsulate a simple piece of logic with few inputs. things like \"serializing a model\" or making a \"business decision\" with a single param.</li>\n<li>when memory management scale is a critical concern.</li>\n</ul>\n\n<p>When to write a ruby class that is intended to be initialize:</p>\n\n<ul>\n<li>when it requires persistence. (e.g. active record models)</li>\n<li>when it's common piece of code (with multiple parameters) that is often injection.</li>\n<li>when it's 'orchestration or routing' logic with injected dependencies.</li>\n</ul>\n\n<p>Whatever the case. It seems important to me that teams get together and outline what recurring patterns are intended to be static or instantiated across their dependency graph.</p>\n"}], "owner": {"reputation": 1, "user_id": 11579539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/791d3456d37801466499c66cc562de72?s=128&d=identicon&r=PG&f=1", "display_name": "Kahne Raja", "link": "https://stackoverflow.com/users/11579539/kahne-raja"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 277, "favorite_count": 0, "answer_count": 3, "score": -1, "last_activity_date": 1559742816, "creation_date": 1559688760, "last_edit_date": 1559695519, "question_id": 56452307, "link": "https://stackoverflow.com/questions/56452307/when-is-it-a-good-idea-to-define-a-static-ruby-class", "title": "When is it a good idea to define a static ruby class?", "body": "<p>Are there some governing rules around when it makes sense to define a static class as opposed to a class that is instantiated?</p>\n\n<p>Still puzzling over idiomatic ruby initialization vs static class definition.</p>\n\n<p>From what I've found.</p>\n\n<p>Static classes seem very effective.</p>\n\n<ol>\n<li>ruby is both a functional and object orientated language. it\u2019s very possible to write both styles. a functional style is super useful for \u2018functional\u2019 things.</li>\n<li>i regularly observe classes going from static to instantiated and then very quickly bloating. \u201cnow we have all this stuff.. why not do more?!\u201c. i see instantiated classes have a natural tendency to unfortunately take expanding responsibilities.</li>\n<li>i see that when a class transitions from static to instantiated we arrive at less unit testing confidence, given things at run time might change in regards to memory allocation / assignment (as in, someone could accidentally get in between instantiation and call).</li>\n<li>i find that static classes are easier to read because we don\u2019t have to juggle potential state change considerations. less mutation = less complexity.</li>\n</ol>\n\n<p>For me. The big issues are:</p>\n\n<ol>\n<li>Classes doing more than one thing.</li>\n<li>Instability in patterns across large old ruby code bases. </li>\n</ol>\n\n<p>To address these 2 concerns, I\u2019m thinking a static approach (where possible) seems to put a healthy amount of pressure on the code to adhere to SOLID principles.</p>\n\n<p>Static</p>\n\n<pre><code>Serializer.transform(fruit:)\n</code></pre>\n\n<p>Instantiated</p>\n\n<pre><code>Serializer.new(fruit:).transform\n</code></pre>\n\n<p>What drives you to go static in ruby?</p>\n"}, {"tags": ["mysql", "sql", "ruby-on-rails", "ruby", "activerecord"], "answers": [{"tags": [], "owner": {"reputation": 627, "user_id": 10895713, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GTs8n.jpg?s=128&g=1", "display_name": "Max Vinicius", "link": "https://stackoverflow.com/users/10895713/max-vinicius"}, "is_accepted": true, "score": 1, "last_activity_date": 1559688788, "last_edit_date": 1559688788, "creation_date": 1559687445, "answer_id": 56452130, "question_id": 56452028, "link": "https://stackoverflow.com/questions/56452028/how-to-write-a-query-to-compare-current-date-to-created-at-timestamps-in-databas/56452130#56452130", "title": "How to write a query to compare current date to created_at timestamps in database?", "body": "<p>Try this:</p>\n\n<pre><code>&lt;% if @user.created_at &gt; 5.days.ago.beginning_of_day %&gt;\n  &lt;span&gt;New User!&lt;/span&gt;\n&lt;% end%&gt;\n</code></pre>\n\n<p>Or you can use:</p>\n\n<pre><code>&lt;%= time_ago_in_words(@user.created_at) %&gt;\n</code></pre>\n\n<p>Source: <a href=\"https://apidock.com/rails/ActionView/Helpers/DateHelper/time_ago_in_words\" rel=\"nofollow noreferrer\">https://apidock.com/rails/ActionView/Helpers/DateHelper/time_ago_in_words</a></p>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user11581234"}, "is_accepted": false, "score": 0, "last_activity_date": 1559723752, "creation_date": 1559723752, "answer_id": 56456908, "question_id": 56452028, "link": "https://stackoverflow.com/questions/56452028/how-to-write-a-query-to-compare-current-date-to-created-at-timestamps-in-databas/56456908#56456908", "title": "How to write a query to compare current date to created_at timestamps in database?", "body": "<p>It's straightforward in Ruby</p>\n\n<p><code>@user.created_at &gt; Time.now</code></p>\n"}], "owner": {"reputation": 61, "user_id": 11599519, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f2b606478e2f9d68ef58fee1c93c062f?s=128&d=identicon&r=PG&f=1", "display_name": "Shakered", "link": "https://stackoverflow.com/users/11599519/shakered"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 55, "favorite_count": 0, "accepted_answer_id": 56452130, "answer_count": 2, "score": 0, "last_activity_date": 1559723752, "creation_date": 1559686661, "last_edit_date": 1559687130, "question_id": 56452028, "link": "https://stackoverflow.com/questions/56452028/how-to-write-a-query-to-compare-current-date-to-created-at-timestamps-in-databas", "title": "How to write a query to compare current date to created_at timestamps in database?", "body": "<p>I would like to write a query to compare created_at timestamp with my current date in Ruby on Rails using ActiveRecord and I don't quite know how do it yet </p>\n\n<p>Date is stored like this -> created_at: 2019-06-03 03:30:40</p>\n"}, {"tags": ["ruby", "oauth-2.0", "token", "hydra"], "comments": [{"owner": {"reputation": 11, "user_id": 11601291, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0afb7e2d32cc0dfad09ee274c81cf122?s=128&d=identicon&r=PG&f=1", "display_name": "quackduck", "link": "https://stackoverflow.com/users/11601291/quackduck"}, "edited": false, "score": 1, "creation_date": 1559774536, "post_id": 56451878, "comment_id": 99529302, "body": "Fixed.  Hydra uses Bcrypt to encode your clients password in the Postgres DB.  I bcrypt&#39;d my &#39;secret&#39; manually and overwrote the existing one in the Postgres DB.   Ta da.. it works now.   The only think I can think of is that I made a mistake when creating the client to begin with and now that I&#39;m looking at my code... Yup.. I did.    In any case, what you have above is a &#39;working&#39; example of a Ruby Oauth2 client talking with a Hydra Oauth2 server &amp; consent/login service.   There were some considerations on the docker networking side.  Make sure all containers are bound to the local host."}, {"owner": {"reputation": 4141, "user_id": 171809, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/2dcb83d8b5232e23cebc4dc3832e0b82?s=128&d=identicon&r=PG", "display_name": "Ben Orozco", "link": "https://stackoverflow.com/users/171809/ben-orozco"}, "edited": false, "score": 0, "creation_date": 1588275326, "post_id": 56451878, "comment_id": 108844300, "body": "Hey, do you happen to know any Ruby, Omniauth or similar working implementation with ORY Hydra? Thx!"}], "owner": {"reputation": 11, "user_id": 11601291, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0afb7e2d32cc0dfad09ee274c81cf122?s=128&d=identicon&r=PG&f=1", "display_name": "quackduck", "link": "https://stackoverflow.com/users/11601291/quackduck"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 476, "favorite_count": 1, "answer_count": 0, "score": 1, "last_activity_date": 1559774692, "creation_date": 1559685632, "last_edit_date": 1559774692, "question_id": 56451878, "link": "https://stackoverflow.com/questions/56451878/ruby-oauth2-0-client-secret-post-not-working-with-ory-hydra", "title": "Ruby Oauth2.0: client_secret_post not working with ory hydra", "body": "<p>I am trying to get a Ruby Oauth2.0 client talking with the Ory Hydra docker-compose 5 minute demo.   I am stuck on the client app's authentication code exchange for the token.   LOG is below.   Looks like the main problem is the following \"hashedPassword is not the hash of the given password\".</p>\n\n<p>DEBUG LOG FROM HYDRA SERVER</p>\n\n<pre><code>\ntime=\"2019-06-04T21:32:09Z\" level=info msg=\"started handling request\" method=POST remote=\"172.19.0.2:35482\" request=/oauth2/token\nhydra_1\n\ntime=\"2019-06-04T21:32:09Z\" level=error msg=\"An error occurred\" debug=\"crypto/bcrypt: hashedPassword is not the hash of the given password\" description=\"Client authentication failed (e.g., unknown client, no client authentication included, or unsupported authentication method)\" error=invalid_client\nhydra_1\n\ntime=\"2019-06-04T21:32:09Z\" level=info msg=\"completed handling request\" measure#hydra/public: http://127.0.0.1:4444/.latency=92931900 method=POST remote=\"172.19.0.2:35482\" request=/oauth2/token status=401 text_status=Unauthorized took=92.9319ms\n</code></pre>\n\n<p>I've read up <a href=\"https://stackoverflow.com/questions/54529838/ruby-oauth2-0-client-credential-type-has-unsupported-client-authentication-meth\">here</a> and it would appear this 'is' possible.</p>\n\n<p>Here is how I register my client 'test-app9' in hydra:</p>\n\n<pre><code>docker-compose -f quickstart.yml exec hydra hydra clients create --endpoint http://127.0.0.1:4445 --id test-app9 --secret secret--skip-tls-verify --grant-types authorization_code,refresh_token,client_credentials,implicit --response-types token,code,id_token --scope profile --callbacks http://127.0.0.1:8088/auth/callback --token-endpoint-auth-method client_secret_post -g client_credentials \n</code></pre>\n\n<p>I can indeed see the client appearing in the postgres DB from the docker-compose demo.  The password 'secret' is hashed in the DB.</p>\n\n<p>Here is my single Sinatra file acting as the Oauth2.0 client:</p>\n\n<pre><code>require 'rubygems'\nrequire 'sinatra'\nrequire 'oauth2'\nrequire 'json'\n\nOpenSSL::SSL::VERIFY_PEER = OpenSSL::SSL::VERIFY_NONE\n\n# If you add your authentication in the header then use ~Sclient_secret_basic~T\n# If you add your authentication details in the post use ~Sclient_secret_post~T\n\ndef client\n  OAuth2::Client.new('test-app9',\n                     'secret',\n#                     'c2VjcmV0',\n                     :site =&gt; \"http://127.0.0.1:4445\",\n                     :logger =&gt; Logger.new('example.log'),\n                     :authorize_url =&gt; \"http://127.0.0.1:4444/oauth2/auth\",\n                     :token_url =&gt; \"http://hydra:4444/oauth2/token\")\nend\n\nset :root, File.dirname(__FILE__)\nset :views, Proc.new { File.join(root, \"views\") }\nset :run, true\nset :port, 80\n\nget \"/\" do\n  erb :index\nend\n\nget '/auth' do\n  authorization_url = client.auth_code.authorize_url(:redirect_uri =&gt; redirect_uri, :response_type =&gt; \"code\", :scope =&gt; \"profile\", :state =&gt; \"pqrst1234\")\n  puts \"Redirecting to URL: #{authorization_url.inspect}\"\n  redirect authorization_url\nend\n\nget '/auth/callback' do\n  begin\n    access_token = client.auth_code.get_token(params[:code], :redirect_uri =&gt; redirect_uri, :client_id =&gt; \"test-app9\", :client_secret =&gt; 'secret', :headers =&gt; {'Authorization' =&gt; 'basic_auth_header', 'client_id' =&gt; 'test-app9', 'client_secret' =&gt; 'c2VjcmV0'} )\n    api_url = \"/me.json\"\n    me = JSON.parse(access_token.get(api_url).body)\n    erb \"&lt;p&gt;Your data:\\n#{me.inspect}&lt;/p&gt;\"\n  rescue OAuth2::Error =&gt; e\n    erb %(&lt;p&gt;Wassup #{$!}&lt;/p&gt;&lt;p&gt;&lt;a href=\"/auth\"&gt;Retry&lt;/a&gt;&lt;/p&gt;)\n  end\nend\n\nget '/auth/failure' do\n  erb \"&lt;h1&gt;Authentication Failed:&lt;/h1&gt;&lt;h3&gt;message:&lt;h3&gt; &lt;pre&gt;#{params}&lt;/pre&gt;\"\nend\n\ndef redirect_uri(path = '/auth/callback', query = nil)\n  uri = URI.parse(request.url)\n  uri.path  = path\n  uri.query = query\n  uri.to_s\nend\n\n__END__\n</code></pre>\n\n<p>So some interesting notes:</p>\n\n<ol>\n<li><p>It apparently does not matter what secret I initiate the OAuth2 client with.  I can use 'secret' or the base64 encoded 'c2VjcmV0' string.   Either way I get up to the token exchange portion.</p></li>\n<li><p>I was shotgunning this and ended up putting the client_id and the client_secret in what I believe is the proper way to set in the headers as well as the body.</p></li>\n</ol>\n\n<p>I have tried many variations of this.   Can't seem to get the correct syntax that the <a href=\"https://stackoverflow.com/questions/54529838/ruby-oauth2-0-client-credential-type-has-unsupported-client-authentication-meth\">author of this</a> apparently succeeded with OR I'm hitting a bug (doubtful).</p>\n\n<p>Anyone able to help here?</p>\n\n<p>UPDATE\nFixed this myself.  Problem was syntax issue when creating my client 'app'.  This is the corrected version.</p>\n\n<pre><code>docker-compose -f quickstart.yml exec hydra hydra clients create --endpoint http://127.0.0.1:4445 --id test-app10 --secret secret --skip-tls-verify --grant-types authorization_code,refresh_token,client_credentials,implicit --response-types token,code,id_token --scope profile --callbacks http://127.0.0.1:8088/auth/callback --token-endpoint-auth-method client_secret_post -g client_credentials\n</code></pre>\n"}, {"tags": ["javascript", "ruby-on-rails", "ruby", "reactjs"], "comments": [{"owner": {"reputation": 1165, "user_id": 6945452, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/98f194d5802eb275d75a6c1af397534a?s=128&d=identicon&r=PG", "display_name": "Kamal Pandey", "link": "https://stackoverflow.com/users/6945452/kamal-pandey"}, "edited": false, "score": 0, "creation_date": 1559708506, "post_id": 56451709, "comment_id": 99500994, "body": "could you show the result of <code>console.log(result)</code> so that it will be easy to debug."}], "answers": [{"comments": [{"owner": {"reputation": 103, "user_id": 8062293, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e81a9452db8120a5005dbf819c262e70?s=128&d=identicon&r=PG&f=1", "display_name": "Danks", "link": "https://stackoverflow.com/users/8062293/danks"}, "edited": false, "score": 0, "creation_date": 1559749231, "post_id": 56454329, "comment_id": 99519167, "body": "quyetdc that&#39;s it, thank you very much for your answer!"}], "tags": [], "owner": {"reputation": 1175, "user_id": 2861567, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GRa02.jpg?s=128&g=1", "display_name": "quyetdc", "link": "https://stackoverflow.com/users/2861567/quyetdc"}, "is_accepted": true, "score": 3, "last_activity_date": 1559709563, "creation_date": 1559709563, "answer_id": 56454329, "question_id": 56451709, "link": "https://stackoverflow.com/questions/56451709/get-rails-associated-objects-with-react/56454329#56454329", "title": "Get rails associated objects with React", "body": "<p>It is because your returned data does not include user information. In your ajax call response, you cannot query as if you are in rails controller.</p>\n\n<p>In your case, you should return user information together with post in your controller action.</p>\n\n<pre><code>post = Post.find(params[:id])\nuser = post.user\npost = post.as_json\npost[:user] = user.as_json\n\nrender json: { post: post }\n</code></pre>\n\n<p>If you need users information for multiple posts, you can use eager loading in your rails controller action</p>\n\n<pre><code>@posts = Post.includes(:user).all.map do |post|\n           post_json = post.as_json\n           post_json[:user] = post.user.as_json\n           post_json\n         end\n\nrender json: { posts: @posts }\n\n</code></pre>\n"}], "owner": {"reputation": 103, "user_id": 8062293, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e81a9452db8120a5005dbf819c262e70?s=128&d=identicon&r=PG&f=1", "display_name": "Danks", "link": "https://stackoverflow.com/users/8062293/danks"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 130, "favorite_count": 1, "accepted_answer_id": 56454329, "answer_count": 1, "score": 0, "last_activity_date": 1559709563, "creation_date": 1559684414, "last_edit_date": 1559684545, "question_id": 56451709, "link": "https://stackoverflow.com/questions/56451709/get-rails-associated-objects-with-react", "title": "Get rails associated objects with React", "body": "<p>After setup a simple post associated user model with rails i'd like to get the post owner avatar  with react but all that i get this error:</p>\n\n<blockquote>\n  <p>TypeError: Cannot read property 'username''avatar' etc.. of undefined</p>\n</blockquote>\n\n<p>I've tried to get the associated post user on fetching the post</p>\n\n<pre><code>async getPost() {\n    // this.setState({showProgress: true})\n\nlet {\n  match: { params }\n} = this.props;\n\nconst response = await axios\n  .get(`/posts/${params.id}`, {\n    headers: {\n      Accept: \"application/json\",\n      \"Content-Type\": \"application/json\"\n    },\n    credentials: \"same-origin\"\n  })\n\n  .then(result =&gt; {\n    this.setState({\n      title: result.data.post.title,\n      user: result.data.post.user.username,\n      user: result.data.post.user,\n\n     url: result.data.post.user.avatar.post.url\n    });\n  })\n  .catch(error =&gt; {\n    console.error(error);\n  });\n\n\n}\n</code></pre>\n\n<p>but Still showing error on the log and the user that is filled with the post is the user_id</p>\n\n<p>So, someone has any hint to spare about this?</p>\n"}, {"tags": ["ruby", "prometheus", "fluentd"], "comments": [{"owner": {"reputation": 3320, "user_id": 3480808, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bbca64f49de22131b4b51fddfa8a7df4?s=128&d=identicon&r=PG", "display_name": "Michael Doubez", "link": "https://stackoverflow.com/users/3480808/michael-doubez"}, "edited": false, "score": 0, "creation_date": 1559764383, "post_id": 56451603, "comment_id": 99525675, "body": "Isn&#39;t there an option to have a window (time or number of data point) for the summary ?"}, {"owner": {"reputation": 3320, "user_id": 3480808, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bbca64f49de22131b4b51fddfa8a7df4?s=128&d=identicon&r=PG", "display_name": "Michael Doubez", "link": "https://stackoverflow.com/users/3480808/michael-doubez"}, "edited": false, "score": 0, "creation_date": 1559852923, "post_id": 56451603, "comment_id": 99559573, "body": "This seems to be a limitation of prometheus client ruby implementation. See <a href=\"https://github.com/prometheus/client_ruby/issues/12\" rel=\"nofollow noreferrer\">this issue</a>"}], "owner": {"reputation": 2229, "user_id": 3081519, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/e712d26a7a4f4df188be626eb520c88f?s=128&d=identicon&r=PG&f=1", "display_name": "user3081519", "link": "https://stackoverflow.com/users/3081519/user3081519"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 111, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1559683789, "creation_date": 1559683789, "question_id": 56451603, "link": "https://stackoverflow.com/questions/56451603/prometheus-summaries-do-not-refresh-their-values", "title": "Prometheus Summaries Do Not Refresh Their Values", "body": "<p>I have a fluentd running with the prometheus <a href=\"https://github.com/fluent/fluent-plugin-prometheus\" rel=\"nofollow noreferrer\">plugin</a>.</p>\n\n<p>It collects logs, parses them, extracts latencies and displays them on <code>/metrics</code> endpoint as advertised + sends the original logs to my aggregation system.</p>\n\n<p>However, I've noticed that some latencies don't refresh their values:</p>\n\n<pre><code>web_latencies_summary{response_code=\"408\",quantile=\"0.5\"} 60.0\nweb_latencies_summary{response_code=\"408\",quantile=\"0.9\"} 60.496\nweb_latencies_summary{response_code=\"408\",quantile=\"0.99\"} 60.496\nweb_latencies_summary_sum{response_code=\"408\"} 421.597\nweb_latencies_summary_count{response_code=\"408\"} 7\n</code></pre>\n\n<p>I check the logs and I haven't had any 408's for over 24hrs, but the <code>/metrics</code> endpoint still displays the values above. This obviously throws my metrics off by a lot. </p>\n\n<p>What could be going wrong? I believe most of the prometheus clients replace the value with NaN when there was nothing for a while. It does not happen in this case. </p>\n\n<p>Any advice is appreciated.</p>\n"}, {"tags": ["ruby", "pry"], "comments": [{"owner": {"reputation": 392, "user_id": 7044855, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b8853c5bb96a922687efac6e58c25bf0?s=128&d=identicon&r=PG", "display_name": "prieber", "link": "https://stackoverflow.com/users/7044855/prieber"}, "edited": false, "score": 0, "creation_date": 1559682524, "post_id": 56451198, "comment_id": 99496083, "body": "I&#39;m not familiar with this error but found a couple things on google: <a href=\"https://github.com/fog/fog/issues/397\" rel=\"nofollow noreferrer\">fog</a>, <a href=\"https://stackoverflow.com/questions/10391298/error-non-absolute-home-via-netssh\">net::ssh</a>.  Would suggest printing contents of <code>ENV[&#39;HOME&#39;]</code> or <code>echo $HOME</code>."}, {"owner": {"reputation": 2958, "user_id": 3597730, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/d76b8f632aeb1d920d79d7dd5ab63097?s=128&d=identicon&r=PG", "display_name": "ruby_newbie", "link": "https://stackoverflow.com/users/3597730/ruby-newbie"}, "edited": false, "score": 0, "creation_date": 1559682625, "post_id": 56451198, "comment_id": 99496118, "body": "Can you post the full stack trace?"}, {"owner": {"reputation": 6462, "user_id": 3784008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/55ou4.jpg?s=128&g=1", "display_name": "anothermh", "link": "https://stackoverflow.com/users/3784008/anothermh"}, "edited": false, "score": 1, "creation_date": 1559684450, "post_id": 56451198, "comment_id": 99496632, "body": "<a href=\"https://github.com/pry/pry/issues/477\" rel=\"nofollow noreferrer\">github.com/pry/pry/issues/477</a>"}, {"owner": {"reputation": 15501, "user_id": 664833, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/814bed2c4c2d0e69ec65a28a166c01b7?s=128&d=identicon&r=PG", "display_name": "user664833", "link": "https://stackoverflow.com/users/664833/user664833"}, "edited": false, "score": 0, "creation_date": 1559686699, "post_id": 56451198, "comment_id": 99497248, "body": "Thanks, I saw <i>fog</i>, <i>net:ssh</i>, <i>pry/issues/477</i>. <code>ENV[&#39;HOME&#39;]</code> is <code>localhost:3000</code>. I added the stack trace."}, {"owner": {"reputation": 15501, "user_id": 664833, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/814bed2c4c2d0e69ec65a28a166c01b7?s=128&d=identicon&r=PG", "display_name": "user664833", "link": "https://stackoverflow.com/users/664833/user664833"}, "edited": false, "score": 0, "creation_date": 1559715547, "post_id": 56451198, "comment_id": 99502548, "body": "Updated question with additional info."}, {"owner": {"reputation": 15501, "user_id": 664833, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/814bed2c4c2d0e69ec65a28a166c01b7?s=128&d=identicon&r=PG", "display_name": "user664833", "link": "https://stackoverflow.com/users/664833/user664833"}, "edited": false, "score": 0, "creation_date": 1559715950, "post_id": 56451198, "comment_id": 99502666, "body": "Figured out the problem - added answer. Let me know if I should delete this question."}], "answers": [{"tags": [], "owner": {"reputation": 15501, "user_id": 664833, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/814bed2c4c2d0e69ec65a28a166c01b7?s=128&d=identicon&r=PG", "display_name": "user664833", "link": "https://stackoverflow.com/users/664833/user664833"}, "is_accepted": false, "score": 0, "last_activity_date": 1559770984, "last_edit_date": 1559770984, "creation_date": 1559715801, "answer_id": 56455180, "question_id": 56451198, "link": "https://stackoverflow.com/questions/56451198/binding-pry-causing-argumenterror-non-absolute-home/56455180#56455180", "title": "`binding.pry` causing `ArgumentError: non-absolute home`", "body": "<p><code>ENV['HOME']</code> was overridden.</p>\n\n<p>Someone added <code>ENV['HOME']='localhost:3000'</code> to our app environment variables. Bad!</p>\n\n<p>Sorry to have wasted everyone's time!</p>\n"}], "owner": {"reputation": 15501, "user_id": 664833, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/814bed2c4c2d0e69ec65a28a166c01b7?s=128&d=identicon&r=PG", "display_name": "user664833", "link": "https://stackoverflow.com/users/664833/user664833"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 285, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1559770984, "creation_date": 1559681550, "last_edit_date": 1592644375, "question_id": 56451198, "link": "https://stackoverflow.com/questions/56451198/binding-pry-causing-argumenterror-non-absolute-home", "title": "`binding.pry` causing `ArgumentError: non-absolute home`", "body": "<p>Under what condition might <a href=\"https://github.com/pry/pry\" rel=\"nofollow noreferrer\">pry</a> fail with this error?</p>\n<pre><code>ArgumentError: non-absolute home\n</code></pre>\n<p><strong>code at failure point:</strong></p>\n<pre><code>puts &quot;ENV['HOME']: #{ENV['HOME']}&quot;\nbinding.pry\n</code></pre>\n<p><strong>stack trace:</strong></p>\n<pre><code>ENV['HOME']: localhost:3000                                                     \nrake aborted!                                                                   \nArgumentError: non-absolute home                                                \n/Users/bart_simpson/.rvm/gems/ruby-2.5.1@kewl_project/gems/pry-0.12.2/lib/pry/pry_class.rb:105:in `expand_path'\n/Users/bart_simpson/.rvm/gems/ruby-2.5.1@kewl_project/gems/pry-0.12.2/lib/pry/pry_class.rb:105:in `real_path_to'\n/Users/bart_simpson/.rvm/gems/ruby-2.5.1@kewl_project/gems/pry-0.12.2/lib/pry/pry_class.rb:100:in `block in rc_files_to_load'\n/Users/bart_simpson/.rvm/gems/ruby-2.5.1@kewl_project/gems/pry-0.12.2/lib/pry/pry_class.rb:100:in `map'\n/Users/bart_simpson/.rvm/gems/ruby-2.5.1@kewl_project/gems/pry-0.12.2/lib/pry/pry_class.rb:100:in `rc_files_to_load'\n/Users/bart_simpson/.rvm/gems/ruby-2.5.1@kewl_project/gems/pry-0.12.2/lib/pry/pry_class.rb:88:in `load_rc_files'\n/Users/bart_simpson/.rvm/gems/ruby-2.5.1@kewl_project/gems/pry-0.12.2/lib/pry/pry_class.rb:148:in `initial_session_setup'\n/Users/bart_simpson/.rvm/gems/ruby-2.5.1@kewl_project/gems/pry-0.12.2/lib/pry/pry_class.rb:184:in `start'\n/Users/bart_simpson/.rvm/gems/ruby-2.5.1@kewl_project/gems/pry-0.12.2/lib/pry/core_extensions.rb:43:in `pry'\n/Users/bart_simpson/Projects/kewl_project/kewl_project/lib/tasks/kewl_project_tasks_helper.rb:104:in `block in import_energy_storage_facilities_from_state_task2'\n/Users/bart_simpson/.rvm/rubies/ruby-2.5.1/lib/ruby/2.5.0/csv.rb:1764:in `each' \n/Users/bart_simpson/.rvm/rubies/ruby-2.5.1/lib/ruby/2.5.0/csv.rb:1142:in `block in foreach'\n/Users/bart_simpson/.rvm/rubies/ruby-2.5.1/lib/ruby/2.5.0/csv.rb:1289:in `open' \n/Users/bart_simpson/.rvm/rubies/ruby-2.5.1/lib/ruby/2.5.0/csv.rb:1141:in `foreach'\n/Users/bart_simpson/Projects/kewl_project/kewl_project/lib/tasks/kewl_project_tasks_helper.rb:100:in `import_energy_storage_facilities_from_state_task2'\n/Users/bart_simpson/Projects/kewl_project/kewl_project/lib/tasks/kewl_project_tasks_helper.rb:69:in `import_energy_storage_facilities_via_state_task'\n/Users/bart_simpson/Projects/kewl_project/kewl_project/lib/tasks/kewl_project.rake:215:in `block (2 levels) in &lt;main&gt;'\n/Users/bart_simpson/.rvm/gems/ruby-2.5.1@kewl_project/gems/rake-12.3.2/lib/rake/task.rb:273:in `block in execute'\n/Users/bart_simpson/.rvm/gems/ruby-2.5.1@kewl_project/gems/rake-12.3.2/lib/rake/task.rb:273:in `each'\n/Users/bart_simpson/.rvm/gems/ruby-2.5.1@kewl_project/gems/rake-12.3.2/lib/rake/task.rb:273:in `execute'\n/Users/bart_simpson/.rvm/gems/ruby-2.5.1@kewl_project/gems/rake-12.3.2/lib/rake/task.rb:214:in `block in invoke_with_call_chain'\n/Users/bart_simpson/.rvm/rubies/ruby-2.5.1/lib/ruby/2.5.0/monitor.rb:226:in `mon_synchronize'\n/Users/bart_simpson/.rvm/gems/ruby-2.5.1@kewl_project/gems/rake-12.3.2/lib/rake/task.rb:194:in `invoke_with_call_chain'\n/Users/bart_simpson/.rvm/gems/ruby-2.5.1@kewl_project/gems/rake-12.3.2/lib/rake/task.rb:183:in `invoke'\n/Users/bart_simpson/.rvm/gems/ruby-2.5.1@kewl_project/gems/rake-12.3.2/lib/rake/application.rb:160:in `invoke_task'\n/Users/bart_simpson/.rvm/gems/ruby-2.5.1@kewl_project/gems/rake-12.3.2/lib/rake/application.rb:116:in `block (2 levels) in top_level'\n/Users/bart_simpson/.rvm/gems/ruby-2.5.1@kewl_project/gems/rake-12.3.2/lib/rake/application.rb:116:in `each'\n/Users/bart_simpson/.rvm/gems/ruby-2.5.1@kewl_project/gems/rake-12.3.2/lib/rake/application.rb:116:in `block in top_level'\n/Users/bart_simpson/.rvm/gems/ruby-2.5.1@kewl_project/gems/rake-12.3.2/lib/rake/application.rb:125:in `run_with_threads'\n/Users/bart_simpson/.rvm/gems/ruby-2.5.1@kewl_project/gems/rake-12.3.2/lib/rake/application.rb:110:in `top_level'\n/Users/bart_simpson/.rvm/gems/ruby-2.5.1@kewl_project/gems/rake-12.3.2/lib/rake/application.rb:83:in `block in run'\n/Users/bart_simpson/.rvm/gems/ruby-2.5.1@kewl_project/gems/rake-12.3.2/lib/rake/application.rb:186:in `standard_exception_handling'\n/Users/bart_simpson/.rvm/gems/ruby-2.5.1@kewl_project/gems/rake-12.3.2/lib/rake/application.rb:80:in `run'\n/Users/bart_simpson/.rvm/gems/ruby-2.5.1@kewl_project/gems/rake-12.3.2/exe/rake:27:in `&lt;top (required)&gt;'\n/Users/bart_simpson/.rvm/gems/ruby-2.5.1@kewl_project/bin/rake:23:in `load'     \n/Users/bart_simpson/.rvm/gems/ruby-2.5.1@kewl_project/bin/rake:23:in `&lt;main&gt;'   \n/Users/bart_simpson/.rvm/gems/ruby-2.5.1@kewl_project/bin/ruby_executable_hooks:24:in `eval'\n/Users/bart_simpson/.rvm/gems/ruby-2.5.1@kewl_project/bin/ruby_executable_hooks:24:in `&lt;main&gt;'\nTasks: TOP =&gt; kewl_project:import_energy_storage_facilities                     \n</code></pre>\n<hr />\n<h1>UPDATE</h1>\n<p>I found that if I issue <code>binding.pry</code> immediately after <code>require 'pry'</code> at the top of the module (i.e. not within a method but outside any method scope), then it works and <code>ENV['HOME']</code> is what we would expect:</p>\n<pre><code>/Users/bart_simpson\n</code></pre>\n<p>So now the question is: where does <code>ENV['HOME']</code> get changed to <code>localhost:3000</code>??</p>\n"}, {"tags": ["ruby", "selenium-webdriver", "capybara"], "answers": [{"tags": [], "owner": {"reputation": 42014, "user_id": 2709090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/238c2b7cde2c817fc9a5a2b8eaa2ffad?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Walpole", "link": "https://stackoverflow.com/users/2709090/thomas-walpole"}, "is_accepted": true, "score": 1, "last_activity_date": 1559680396, "creation_date": 1559680396, "answer_id": 56450972, "question_id": 56450718, "link": "https://stackoverflow.com/questions/56450718/how-to-locate-element-illegal-selector-error-capybara/56450972#56450972", "title": "How to locate element? Illegal selector error (Capybara)", "body": "<p><code>find</code> takes a selector type (defaults to :css), a locator, and then options - and returns a single matching element. In your code  </p>\n\n<pre><code>americanas = page.find($name).text\namericanas.click\n</code></pre>\n\n<p>You are not passing a selector type to <code>find</code> so it's assumed to be :css, but then you're passing a random string of text (I assume it's a string but it has no quotes around it in your code though?) which isn't a valid CSS selector - hence the error. After that you're calling <code>text</code> on the result of <code>find</code> which (if your find was correct) would get the text from the element (as a string) and then you call <code>click</code> on the string which doesn't make any sense since <code>click</code> is only supported on elements.  I think what you're trying to do is</p>\n\n<pre><code>page.find('h1', text: $name).click\n</code></pre>\n\n<p>but even that is going to fail because you have <code>$name = \"box for all the boys i've loved\"</code> but the contents of the h1 are \"Box Book - For All The Boys I've Loved\" which doesn't match in contents or case. You could use a case insensitive regexp by doing something like</p>\n\n<pre><code>page.find('h1', text: /for all the boys i've loved/i).click \n</code></pre>\n\n<p>but it all depends on what you're actually trying to do.</p>\n\n<p>Then, assuming your table has more than one table row your expectation would probably need to be something like</p>\n\n<pre><code>expect(page).to have_selector('tr', text: $author)\n</code></pre>\n\n<p>Note: Based on the questions you've been asking it really seems like you could benefit from reading the Capybara docs and a few ruby tutorials.</p>\n"}], "owner": {"reputation": 60, "user_id": 10802314, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-4snMgcSZjWo/AAAAAAAAAAI/AAAAAAAANxM/1lc6gCj10mc/photo.jpg?sz=128", "display_name": "holyonline", "link": "https://stackoverflow.com/users/10802314/holyonline"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 447, "favorite_count": 0, "accepted_answer_id": 56450972, "answer_count": 1, "score": 0, "last_activity_date": 1559680396, "creation_date": 1559679165, "question_id": 56450718, "link": "https://stackoverflow.com/questions/56450718/how-to-locate-element-illegal-selector-error-capybara", "title": "How to locate element? Illegal selector error (Capybara)", "body": "<p>I'm trying to use a page.find to locate a element using a text variable (both elements don't complete entirely), but when I tried to use the locator, I got the error: invalid selector: An invalid or illegal selector was specified . </p>\n\n<p>I don't know if the method is wrong or the the problem is the html element.</p>\n\n<p>it 'test1' do \n        visit '<a href=\"https://www.americanas.com.br/\" rel=\"nofollow noreferrer\">https://www.americanas.com.br/</a>'</p>\n\n<pre><code>    $name = box for all the boys i've loved\n    $author = Jenny Han\n\n    fill_in 'h_search-input',   with: $isbn\n    click_button 'h_search-btn'\n\n    americanas = page.find($name).text      # &lt;- here is the error\n    americanas.click\n\n    expect(find('table tbody tr')).to have_content $author\nend\n</code></pre>\n\n<p>HTML elements: </p>\n\n<p><code>&lt;h1 class=\"TitleUI-sc-1m3ayw0-16 cvOkHP TitleH1-c6mv26-0 VyqrE\" icon=\"[object Object]\"&gt;Box Book - For All The Boys I've Loved&lt;/h1&gt;</code></p>\n\n<p>and</p>\n\n<p><code>&lt;tr class=\"table-content__Tr-sc-6kkk7q-3 jFIPzA\"&gt;&lt;td class=\"table-content__Td-sc-6kkk7q-5 bPPRTT\"&gt;&lt;span class=\"text__TextUI-sc-1hrwx40-0 cKQvNJ\"&gt;Author&lt;/span&gt;&lt;/td&gt;&lt;td class=\"table-content__Td-sc-6kkk7q-5 bPPRTT\"&gt;&lt;span class=\"text__TextUI-sc-1hrwx40-0 cKQvNJ\"&gt;Jenny Han&lt;/span&gt;&lt;/td&gt;&lt;/tr&gt;</code></p>\n\n<p>What I got:</p>\n\n<pre><code> 1) test test1\n Failure/Error: americanas = page.find($name).text\n\n Selenium::WebDriver::Error::InvalidSelectorError:\n   invalid selector: An invalid or illegal selector was specified\n     (Session info: chrome=74.0.3729.169)\n     (Driver info: chromedriver=74.0.3729.6 (255758eccf3d244491b8a1317aa76e1ce10d57e9-refs/branch-heads/3729@{#29}),platform=Windows NT 6.1.7601 SP1 x86_64)\n # ./spec/teste_spec.rb:30:in `block (2 levels) in &lt;top (required)&gt;'\n</code></pre>\n\n<p>Thanks for your time!</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 6462, "user_id": 3784008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/55ou4.jpg?s=128&g=1", "display_name": "anothermh", "link": "https://stackoverflow.com/users/3784008/anothermh"}, "edited": false, "score": 2, "creation_date": 1559678307, "post_id": 56450280, "comment_id": 99494345, "body": "Please do not post images of plaintext. Images of plaintext are not appropriate on stackoverflow."}], "answers": [{"tags": [], "owner": {"reputation": 27144, "user_id": 3857758, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/58c4295826435f049b7fc32b98c240f9?s=128&d=identicon&r=PG&f=1", "display_name": "Ursus", "link": "https://stackoverflow.com/users/3857758/ursus"}, "is_accepted": false, "score": 0, "last_activity_date": 1559678262, "creation_date": 1559678262, "answer_id": 56450524, "question_id": 56450280, "link": "https://stackoverflow.com/questions/56450280/routes-on-server-dont-display-properly/56450524#56450524", "title": "routes on server don&#39;t display properly", "body": "<p>Because you have <code>kind_words</code>, not <code>kindwords</code>. Try go to <code>api/v1/sibilings/2/kind_words</code></p>\n\n<p>You can even change that part of the path for that resource like this </p>\n\n<pre><code>resources :kind_words, path: :kindwords\n</code></pre>\n\n<p>and try that same path you were using</p>\n"}], "owner": {"reputation": 105, "user_id": 8000626, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6eb9824e3e59a0dd6055fcd6586c9a2a?s=128&d=identicon&r=PG&f=1", "display_name": "user8000626", "link": "https://stackoverflow.com/users/8000626/user8000626"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 26, "favorite_count": 0, "answer_count": 1, "score": -3, "last_activity_date": 1559679099, "creation_date": 1559677104, "last_edit_date": 1559679099, "question_id": 56450280, "link": "https://stackoverflow.com/questions/56450280/routes-on-server-dont-display-properly", "title": "routes on server don&#39;t display properly", "body": "<p>I have models that belong to a \"parent\" model.\nin the console, the relationship works fine,\nbut when trying to display in the browser it fails</p>\n\n<pre><code>Rails.application.routes.draw do\n  namespace :api  do\n    namespace :v1   do\n\n      resources :parents do\n        resources :siblings, :path =&gt; \"children\"\n      end\n\n      resources :siblings do\n        resources :milestones\n      end\n\n      resources :siblings do\n        resources :kind_words\n      end\n\n      resources :siblings do\n        resources  :nice_deeds\n      end\n\n    end\n  end\nend\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/jjIOk.png\" rel=\"nofollow noreferrer\">https://i.stack.imgur.com/jjIOk.png</a></p>\n"}, {"tags": ["ruby", "docx", "wicked-pdf"], "comments": [{"owner": {"reputation": 392, "user_id": 7044855, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b8853c5bb96a922687efac6e58c25bf0?s=128&d=identicon&r=PG", "display_name": "prieber", "link": "https://stackoverflow.com/users/7044855/prieber"}, "edited": false, "score": 0, "creation_date": 1559677321, "post_id": 56450113, "comment_id": 99493926, "body": "I&#39;m not familiar with <code>WickedPdf</code> but with <code>prawn</code> you have to convert each XML node to a format it understands so styles are applied properly."}, {"owner": {"reputation": 334, "user_id": 2606111, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FUdFG.jpg?s=128&g=1", "display_name": "Mahys116", "link": "https://stackoverflow.com/users/2606111/mahys116"}, "edited": false, "score": 0, "creation_date": 1559678277, "post_id": 56450113, "comment_id": 99494336, "body": "You can remove &quot;\\n&quot; symbols by doc.to_html.gsub(&#39;\\n&#39;,&#39;&#39;).  Also, looks like WickedPDF doesn&#39;t load default settings. So write something like  WickedPdf.new.pdf_from_string(doc.to_html.gsub(&#39;\\n&#39;,&#39;&#39;), {orientation: &#39;Portrait&#39;, page_size: &#39;A4&#39;}). All options you can find on gem&#39;s github page"}, {"owner": {"reputation": 17497, "user_id": 23915, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b5e935da7b67c03dd56f385b031f485c?s=128&d=identicon&r=PG", "display_name": "Unixmonkey", "link": "https://stackoverflow.com/users/23915/unixmonkey"}, "edited": false, "score": 0, "creation_date": 1559678592, "post_id": 56450113, "comment_id": 99494460, "body": "Any way you could link us to the <code>testing.docx</code> file?"}, {"owner": {"reputation": 2221, "user_id": 5921203, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/lczFa.jpg?s=128&g=1", "display_name": "Steven Aguilar", "link": "https://stackoverflow.com/users/5921203/steven-aguilar"}, "reply_to_user": {"reputation": 17497, "user_id": 23915, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b5e935da7b67c03dd56f385b031f485c?s=128&d=identicon&r=PG", "display_name": "Unixmonkey", "link": "https://stackoverflow.com/users/23915/unixmonkey"}, "edited": false, "score": 1, "creation_date": 1559678910, "post_id": 56450113, "comment_id": 99494604, "body": "@Unixmonkey Here is a link to the file. <a href=\"https://www.dropbox.com/s/f1klwguv4r9iyje/testing.docx?dl=0\" rel=\"nofollow noreferrer\">dropbox.com/s/f1klwguv4r9iyje/testing.docx?dl=0</a>"}, {"owner": {"reputation": 334, "user_id": 2606111, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FUdFG.jpg?s=128&g=1", "display_name": "Mahys116", "link": "https://stackoverflow.com/users/2606111/mahys116"}, "edited": false, "score": 1, "creation_date": 1559679660, "post_id": 56450113, "comment_id": 99494897, "body": "I got this result <a href=\"https://www.dropbox.com/s/0av6ay96245j1hl/testing.pdf?dl=0\" rel=\"nofollow noreferrer\">dropbox.com/s/0av6ay96245j1hl/testing.pdf?dl=0</a> for: doc = Docx::Document.open(&#39;testing.docx&#39;); File.open(&quot;testing.pdf&quot;, &#39;wb&#39;){|f| f&lt;&lt; WickedPdf.new.pdf_from_string(doc.to_html.gsub(&#39;\\n&#39;,&#39;&#39;)) } Also, docx doesn&#39;t parse font color."}, {"owner": {"reputation": 17497, "user_id": 23915, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b5e935da7b67c03dd56f385b031f485c?s=128&d=identicon&r=PG", "display_name": "Unixmonkey", "link": "https://stackoverflow.com/users/23915/unixmonkey"}, "edited": false, "score": 0, "creation_date": 1559684604, "post_id": 56450113, "comment_id": 99496669, "body": "It doesn&#39;t seem like the <code>docx</code> gem is doing a very good job of converting to HTML for this purpose. You can get content, and font sizing, but not enough structure or styling to recreate your source document. You might want to look into alternatives."}], "owner": {"reputation": 2221, "user_id": 5921203, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/lczFa.jpg?s=128&g=1", "display_name": "Steven Aguilar", "link": "https://stackoverflow.com/users/5921203/steven-aguilar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 318, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1559679363, "creation_date": 1559676147, "last_edit_date": 1559679363, "question_id": 56450113, "link": "https://stackoverflow.com/questions/56450113/font-size-convert-docx-into-pdf-in-ruby-using-wickedpdf-and-docx", "title": "font-size: Convert docx into pdf in ruby using WickedPdf and docx", "body": "<p>I'm currently trying to convert a word document into HTML using the <a href=\"https://github.com/mileszs/wicked_pdf\" rel=\"nofollow noreferrer\">WickedPdf</a> and <a href=\"https://github.com/chrahunt/docx\" rel=\"nofollow noreferrer\">docx</a> gems. By using the two gems I have been able to convert the Word Document into PDF but the outcome is not what I expected.\n<a href=\"https://i.stack.imgur.com/96nNd.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/96nNd.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>From the attached image you can see the difference from the original word document to the one generated by converting the word document into HTML and then into PDF.</p>\n\n<pre><code> doc = Docx::Document.open('testing.docx') \n pdf &lt;&lt; WickedPdf.new.pdf_from_string(doc.to_html) # or to_s\n File.open(\"testing.pdf\", 'wb') do |f|\n   f &lt;&lt; pdf\n end\n</code></pre>\n\n<p>When using <code>to_html</code> I get the results as shown in the image below.\n<a href=\"https://i.stack.imgur.com/yL8x0.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/yL8x0.png\" alt=\"enter image description here\"></a></p>\n\n<p>How can I format this so the outcome is better? Are there any suggestions on how to use WickedPDF? </p>\n\n<p>I would like to use the HTML format to convert into PDF to be able to read elements such as tables.</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 690, "user_id": 4807892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a27c4610432efdb0b9ba0224b7892a10?s=128&d=identicon&r=PG&f=1", "display_name": "Hula_Zell", "link": "https://stackoverflow.com/users/4807892/hula-zell"}, "edited": false, "score": 3, "creation_date": 1559684678, "post_id": 56450060, "comment_id": 99496692, "body": "Have you tried <code>gem install bundler -v 1.17.3</code>"}, {"owner": {"reputation": 34222, "user_id": 881559, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/K8wbX.png?s=128&g=1", "display_name": "Abram", "link": "https://stackoverflow.com/users/881559/abram"}, "reply_to_user": {"reputation": 690, "user_id": 4807892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a27c4610432efdb0b9ba0224b7892a10?s=128&d=identicon&r=PG&f=1", "display_name": "Hula_Zell", "link": "https://stackoverflow.com/users/4807892/hula-zell"}, "edited": false, "score": 1, "creation_date": 1559697013, "post_id": 56450060, "comment_id": 99499097, "body": "Silly solution, but I just put <code>BUNDLED WITH 2.0.1</code> in my gemfile.lock and now I don&#39;t get any more errors."}, {"owner": {"reputation": 131, "user_id": 7800866, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4mUfY.jpg?s=128&g=1", "display_name": "v2lrf", "link": "https://stackoverflow.com/users/7800866/v2lrf"}, "edited": false, "score": 0, "creation_date": 1593279424, "post_id": 56450060, "comment_id": 110726389, "body": "I was wondering how to fix it, in my case if someone wants to reproduce the error pattern ... Let&#39;s say that I have updated my rails project to the newest version and just before I have updated the ruby version too of the rails app project. And at this moment I had a message that invited me to install new bundler and I did it. Then I decided for some reasons to downgrade to the previous ruby version. Once the downgrade have been done I had the same warning message. I have finally fixed the issue  by rm the gem lock and build it again..."}], "answers": [{"tags": [], "owner": {"reputation": 8933, "user_id": 1243247, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/af81b55e4f9bd063e59e2a4e54bb5496?s=128&d=identicon&r=PG", "display_name": "Jo&#227;o Pimentel Ferreira", "link": "https://stackoverflow.com/users/1243247/jo%c3%a3o-pimentel-ferreira"}, "is_accepted": false, "score": 0, "last_activity_date": 1604788349, "creation_date": 1604788349, "answer_id": 64733063, "question_id": 56450060, "link": "https://stackoverflow.com/questions/56450060/how-to-fix-warning-the-running-version-of-bundler-is-older-than-the-version-th/64733063#64733063", "title": "How to fix &quot;Warning: the running version of Bundler is older than the version that created the lockfile&quot;", "body": "<p>Just uninstall and install again the required version in the warning, in your case it is requiring version 1.17.3</p>\n<pre><code>gem uninstall bundler\ngem install bundler -v 1.17.3\n</code></pre>\n"}], "owner": {"reputation": 34222, "user_id": 881559, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/K8wbX.png?s=128&g=1", "display_name": "Abram", "link": "https://stackoverflow.com/users/881559/abram"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1482, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1604788349, "creation_date": 1559675906, "question_id": 56450060, "link": "https://stackoverflow.com/questions/56450060/how-to-fix-warning-the-running-version-of-bundler-is-older-than-the-version-th", "title": "How to fix &quot;Warning: the running version of Bundler is older than the version that created the lockfile&quot;", "body": "<p>I have tried multiple times to uninstall bundler and reinstall bundler, and somehow, I keep seeing this error:</p>\n\n<pre><code>\u279c  gem uninstall bundler\nRemove executables:\n  bundler\n\nin addition to the gem? [Yn]  y\nRemoving bundler\nSuccessfully uninstalled bundler-2.0.1\n\n\u279c  gem install bundler\nFetching: bundler-2.0.1.gem (100%)\nSuccessfully installed bundler-2.0.1\n1 gem installed\n\n\u279c  bundle\nWarning: the running version of Bundler (1.16.6) is older than the version that created the lockfile (1.17.3). We suggest you upgrade to the latest version of Bundler by running `gem install bundler`.\n</code></pre>\n"}, {"tags": ["json", "ruby", "get", "jekyll", "httparty"], "comments": [{"owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 0, "creation_date": 1559675827, "post_id": 56449619, "comment_id": 99493376, "body": "Pagination algorithm is pretty simple ... if the result length is equal to the limit, you go on to the next page. In your case it&#39;s just a loop where you increment the &#39;current_page&#39; parameter"}, {"owner": {"reputation": 13442, "user_id": 3982562, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2a3c7aae1d762372cda697833c602ec8?s=128&d=identicon&r=PG", "display_name": "3limin4t0r", "link": "https://stackoverflow.com/users/3982562/3limin4t0r"}, "edited": false, "score": 0, "creation_date": 1559676672, "post_id": 56449619, "comment_id": 99493685, "body": "^ aka <code>&quot;https:&#47;&#47;demo.consonance.app&#47;api&#47;v2&#47;products.json?page=2&quot;</code> You could also provide a <code>page_size</code> which might allow you to up the maximum products returned. Iterating through the pages faster, although it could be the case that 50 is the max."}, {"owner": {"reputation": 330, "user_id": 9244337, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/15d587365f94387e44f4f569915918d1?s=128&d=identicon&r=PG&f=1", "display_name": "jbowman", "link": "https://stackoverflow.com/users/9244337/jbowman"}, "edited": false, "score": 0, "creation_date": 1559740238, "post_id": 56449619, "comment_id": 99513843, "body": "500 is the max but there would still be an extra page to deal with. I will put it in as a query parameter though if it will speed up the request."}], "answers": [{"tags": [], "owner": {"reputation": 330, "user_id": 9244337, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/15d587365f94387e44f4f569915918d1?s=128&d=identicon&r=PG&f=1", "display_name": "jbowman", "link": "https://stackoverflow.com/users/9244337/jbowman"}, "is_accepted": true, "score": 1, "last_activity_date": 1559740169, "creation_date": 1559740169, "answer_id": 56461178, "question_id": 56449619, "link": "https://stackoverflow.com/questions/56449619/how-to-deal-with-pagination-when-making-api-request-using-httparty-rubygem/56461178#56461178", "title": "how to deal with pagination when making api request using httparty rubygem", "body": "<p>Using <code>current_page</code> and <code>total_pages</code> as conditions, I looped through the pages of the response and assigned all products to an array:</p>\n\n<pre><code>while current_page &lt;= total_pages do\n\n  url = 'https://web.consonance.app/api/v2/products.json'\n  query = {\n    'page' =&gt; \"#{current_page}\",\n  }\n  request = HTTParty.get(url, query: query)\n\n  hash = JSON.parse(request.body)\n\n  hash['products'].each do |item|\n    product_array.push(item)\n  end\n\n  current_page += 1\n\nend\n</code></pre>\n"}], "owner": {"reputation": 330, "user_id": 9244337, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/15d587365f94387e44f4f569915918d1?s=128&d=identicon&r=PG&f=1", "display_name": "jbowman", "link": "https://stackoverflow.com/users/9244337/jbowman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 689, "favorite_count": 0, "accepted_answer_id": 56461178, "answer_count": 1, "score": 1, "last_activity_date": 1559740169, "creation_date": 1559673864, "question_id": 56449619, "link": "https://stackoverflow.com/questions/56449619/how-to-deal-with-pagination-when-making-api-request-using-httparty-rubygem", "title": "how to deal with pagination when making api request using httparty rubygem", "body": "<p>I'm trying to write a plugin for my Jekyll site which writes a sorted JSON response to a data file, but I'm having trouble dealing with the limit of items in the response. The basic response looks like this:</p>\n\n<pre><code>{\n  \"current_page\": 1,\n  \"per_page\": 50,\n  \"total_pages\": 19,\n  \"url\": \"https://web.consonance.app/api/v2/products.json\",\n  \"products\": [\n    {\n      ...\n      \"pub_date\": \"2017-05-01\"\n      ...\n    },\n    ...\n  ]\n}\n</code></pre>\n\n<p>where <code>products</code> is an array of books that I want to sort by the date they were published (<code>pub_date</code>). There is no <code>next_page</code> url, only the <code>current_page</code> and <code>total_pages</code>. My plugin is very basic. It uses <code>httparty</code> to make the API request, then sorts the response as a hash by <code>pub_date</code>.  So far, it looks like this:</p>\n\n<pre><code>require 'rubygems'\nrequire 'httparty'\nrequire 'json'\n\n# http request to api\n\nurl = 'https://web.consonance.app/api/v2/products.json'\nquery = {\n}\nheaders = {\n  Authorization: \"Token token=**************\"\n}\nresponse = HTTParty.get(url, query: query, headers: headers)\n\n# convert response to hash array\n\nhash = JSON.parse(response.body)\n\n# reverse sort product in products by date published\n\nhash_sorted = hash['products'].sort_by! { |o| o['pub_date'] }.reverse!\n\n# open _data file and write json response\n\nFile.open(\"./_data/products.json\", \"w\") { |file| \n  file.puts JSON.pretty_generate(hash_sorted)\n}\n</code></pre>\n\n<p>which gives me a JSON response of the first 50 items reverse sorted by <code>pub_date</code>. My question is:</p>\n\n<blockquote>\n  <p>How do I get the most recently published book (<code>product</code>) from the entire array, not just the first 50 results?</p>\n</blockquote>\n\n<p>I have tried increasing the limit per page to its maximum, which is 500 items, but the total number of books spans more than one page, so I still have a pagination issue.</p>\n\n<p>The available parameters for the request are documented <a href=\"https://www.consonance.app/docs/product-api/\" rel=\"nofollow noreferrer\">here</a>.</p>\n\n<p>NB \u2013 I'm using <code>httparty</code> because I found it easy to make the request, but I am open to using other gems/methods. I've only just started learning Ruby, so please bear with me.</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 3201, "user_id": 2892779, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uvM8S.jpg?s=128&g=1", "display_name": "Jay Dorsey", "link": "https://stackoverflow.com/users/2892779/jay-dorsey"}, "edited": false, "score": 2, "creation_date": 1559671778, "post_id": 56449129, "comment_id": 99491767, "body": "I think you want something closer to <code>workflow.public_send(&quot;can_#{incoming_status}?&quot;)</code> for your <code>if</code> statement. For what&#39;s inside the if, it would follow a similar pattern <code>workflow.public_send(incoming_status)</code>"}, {"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 0, "creation_date": 1559679666, "post_id": 56449129, "comment_id": 99494901, "body": "&quot;it should work because I have a method <code>workflow.can_queue</code>?&quot; Do you really have a method with <i>that exact name</i>? Including the dot?"}], "answers": [{"comments": [{"owner": {"reputation": 851, "user_id": 7034540, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209364272256116/picture?type=large", "display_name": "aRtoo", "link": "https://stackoverflow.com/users/7034540/artoo"}, "edited": false, "score": 0, "creation_date": 1559672720, "post_id": 56449265, "comment_id": 99492107, "body": "thank you sir. It worked. can you tell me the security risk on this one? or maybe a link? read few blogs but doesnt address the security risk behind it. they said its just a security risk. I know this is like hte <code>eval</code> on javascript that runs a script on the fly. just wondering if there are other deep reasons. thank you again."}, {"owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "reply_to_user": {"reputation": 851, "user_id": 7034540, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209364272256116/picture?type=large", "display_name": "aRtoo", "link": "https://stackoverflow.com/users/7034540/artoo"}, "edited": false, "score": 1, "creation_date": 1559674136, "post_id": 56449265, "comment_id": 99492667, "body": "@artoo I updated my answer to address your question regarding security."}, {"owner": {"reputation": 851, "user_id": 7034540, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209364272256116/picture?type=large", "display_name": "aRtoo", "link": "https://stackoverflow.com/users/7034540/artoo"}, "edited": false, "score": 0, "creation_date": 1559674796, "post_id": 56449265, "comment_id": 99492962, "body": "thank you sir. appreciate it. I was thinking of refactoring this but its hard not to use either. I have not whitelisted any method too. I might do that. thank you again."}], "tags": [], "owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "is_accepted": true, "score": 4, "last_activity_date": 1559674107, "last_edit_date": 1559674107, "creation_date": 1559671894, "answer_id": 56449265, "question_id": 56449129, "link": "https://stackoverflow.com/questions/56449129/execute-a-dynamic-method-using-eval-or-public-send/56449265#56449265", "title": "execute a dynamic method using eval or public_send", "body": "<p>Working with <code>public_send</code> you can change the relevant lines to:</p>\n\n<pre><code>if workflow.public_send(\"can_#{incoming_status}?\")\n  # update status\n  workflow.public_send(incoming_status.to_s)\n    # ...\n</code></pre>\n\n<p><strong>A note about security and risks</strong></p>\n\n<p><code>workflow.public_send(\"can_#{xyz}?\")</code> can only call methods on <code>workflow</code> that are <code>public</code> and which start with the prefix <code>can_</code> and end with <code>?</code>. That is probably only a small number of methods and you can easily decide if you want to allow all those methods.</p>\n\n<p><code>workflow.public_send(\"#{incoming_status'})</code> is different because it allows all public methods on <code>workflow</code> \u2013 even <code>destroy</code>. That means using this without the <code>\"can_#{incoming_status}?\"</code> is probably a bad idea. Or you should at least first check if <code>incoming_status</code> is in a whitelist of allowed methods.</p>\n\n<p><code>eval</code> is the worst because it will evaluate the whole string without any context (e.q. an object like <code>workflow</code>). Imaging you have <code>eval(\"workflow.#{incoming_status}\")</code> without to check first if <code>incoming_status</code> is actually allowed. If someone then sends an <code>incoming_status</code> like this <code>\"to_s; system('xyz')\"</code>then <code>xyz</code> could be everything \u2013 like commands to send a hidden file via email, to install a backdoor or to delete some files.</p>\n"}], "owner": {"reputation": 851, "user_id": 7034540, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209364272256116/picture?type=large", "display_name": "aRtoo", "link": "https://stackoverflow.com/users/7034540/artoo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 137, "favorite_count": 0, "accepted_answer_id": 56449265, "answer_count": 1, "score": 0, "last_activity_date": 1559674107, "creation_date": 1559671162, "question_id": 56449129, "link": "https://stackoverflow.com/questions/56449129/execute-a-dynamic-method-using-eval-or-public-send", "title": "execute a dynamic method using eval or public_send", "body": "<p>I have these code that executes a dynamic method. I'm using <code>eval</code> here to execute it but what I wanted to do is changed it to <code>public_send</code> because I was told so and its much safer.</p>\n\n<p>current code: </p>\n\n<pre><code>  # update workstep logic here.\n        incoming_status = params[params[:name]]\n\n        # grab workflow, this is current data, use this to compare status to in comming status\n        workflow = get_workorder_product_workstep(params[:workflow_id])\n\n        # check current status if its pending allow to update\n        # security concern EVAL!\n\n        if eval(\"workflow.can_#{incoming_status}?\")\n          # update status\n          eval(\"workflow.#{incoming_status}\")\n          # updated attribute handled_by\n          workflow.update_attributes(handled_by_id: @curr_user.id)\n          workflow.save\n        else\n          flash[:notice] = 'Action not allowed'\n        end\n</code></pre>\n\n<p>the <code>eval</code> here is the concern. how can I changed this to <code>public_send</code></p>\n\n<p>Heres What I did.</p>\n\n<p><code>public_send(\"workflow.can_#{incoming_status}?\")</code></p>\n\n<p><code>public_send(\"#{workflow}.can_#{incoming_status}?\")</code></p>\n\n<p>both of them doesn't work. gives me an error of no method. The first public error returns this <code>undefined method workflow.can_queue? for #&lt;Spree::Admin::WorkordersController:0x00007ff71c8e6f00&gt;</code> </p>\n\n<p>but it should work because I have a method <code>workflow.can_queue?</code></p>\n\n<p>the second error on  public is this\n<code>undefined method #&lt;Spree::WorkorderProductWorkstep:0x00007ff765663550&gt;.can_queue? for #&lt;Spree::Admin::WorkordersController:0x00007ff76597f798&gt;</code></p>\n\n<p>I think for the second <code>workflow</code> is being evaluated separately?? im not sure.</p>\n"}, {"tags": ["javascript", "ruby", "ajax", "ruby-on-rails-5", "cocoon-gem"], "comments": [{"owner": {"reputation": 48004, "user_id": 216513, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/30a45c64b2ef288f7ec098c5fb353a22?s=128&d=identicon&r=PG", "display_name": "nathanvda", "link": "https://stackoverflow.com/users/216513/nathanvda"}, "edited": false, "score": 0, "creation_date": 1559725408, "post_id": 56448868, "comment_id": 99506637, "body": "Can you show the view code of the nested items? Please bear in mind that if you have repeating html id&#39;s in a form, only the first id will be actually saved. Could you not more easily use a class <code>.drop_down_product</code> instead? Why do you need an id?"}, {"owner": {"reputation": 1, "user_id": 9302451, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XWm05.jpg?s=128&g=1", "display_name": "Carlos Lima", "link": "https://stackoverflow.com/users/9302451/carlos-lima"}, "reply_to_user": {"reputation": 48004, "user_id": 216513, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/30a45c64b2ef288f7ec098c5fb353a22?s=128&d=identicon&r=PG", "display_name": "nathanvda", "link": "https://stackoverflow.com/users/216513/nathanvda"}, "edited": false, "score": 0, "creation_date": 1559937876, "post_id": 56448868, "comment_id": 99590415, "body": "I edited my question, I thank you if you can help me"}, {"owner": {"reputation": 48004, "user_id": 216513, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/30a45c64b2ef288f7ec098c5fb353a22?s=128&d=identicon&r=PG", "display_name": "nathanvda", "link": "https://stackoverflow.com/users/216513/nathanvda"}, "edited": false, "score": 0, "creation_date": 1561496824, "post_id": 56448868, "comment_id": 100081310, "body": "Thank you for the elaboration. However, could you still explain <i>why</i> you think you need the id? Because in most cases we can avoid the need? One cannot attach a handler to a unique id anyway, so I am a bit confused."}], "owner": {"reputation": 1, "user_id": 9302451, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XWm05.jpg?s=128&g=1", "display_name": "Carlos Lima", "link": "https://stackoverflow.com/users/9302451/carlos-lima"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 56, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1559937816, "creation_date": 1559669972, "last_edit_date": 1559937816, "question_id": 56448868, "link": "https://stackoverflow.com/questions/56448868/callbacks-of-cocoon-gem-in-form-construction-action-view-update", "title": "Callbacks of cocoon gem in form construction action view update", "body": "<p>When creating a form using a cocoon gem, when inserting a new cocoon, I can detect an action by calling the \"cocoon: after insert\" callback.</p>\n\n<p>And I use this to replace the element of my id to make use of another javascript function to calculate the percentage in the other field, entered by the user.</p>\n\n<p>But when I reopen the form using the update action, the cocoons are redefined. And this does not cause the callback \"cocoon: after insert\". to reset the id's, how it works when inserting one by one</p>\n\n<p>I wanted to know if there is a way to capture the callbacks when returning the form for editing. So I can detect this and redraw the new ID again</p>\n\n<p>I use this code in \"form.html.erb\" to replace the id when it creates new instances of the cocoon</p>\n\n<pre><code>var i = 0;\n$(document).on('cocoon:after-insert', function (e) {\n    i++;\n    var id_drop_down_product = 'id_drop_down_product' + i;\n    $(this).find(\"#id_drop_down_product\").attr('id', id_drop_down_product);\n});\n</code></pre>\n\n<p>I thought it would work, in building the form for editing</p>\n\n<hr>\n\n<p>Here is my code that calls the cocoons, where everything is working too</p>\n\n<pre><code>&lt;div class=\"form-group\"&gt;\n  &lt;%= form.fields_for :pedido_produtos do |builder| %&gt;\n    &lt;% render partial: \"shared/pedido_produto_fields\", locals: {f: builder} %&gt;\n  &lt;% end %&gt;\n  &lt;%= link_to_add_association('Produto', form, :pedido_produtos, class: \"btn btn-outline-success\") %&gt;\n&lt;/div&gt;\n\n\n&lt;div class=\"nested-fields\"&gt;\n  &lt;div class=\"order_product\"&gt;\n    &lt;div class=\"form-group col-md-12\"&gt;\n      &lt;%= f.collection_select(:product_id, Product.all, :id, :nome, {:prompt =&gt; \"Selecione um Product\"}, {:class =&gt; 'form-control', onchange: \"searchProduct($(this).val(),this.id);\", id: \"dropselectProduct\", :required =&gt; true}) %&gt;\n      &lt;%= f.text_field :quantity, class: \"form-control\", id: \"quantityproducty\", :required =&gt; true, onchange: \"update_discount($(this).val(),this.id);\" %&gt;\n      &lt;%= f.text_field(:porcent, class: \"form-control\", id: \"porcent\", readonly: true) %&gt;\n    &lt;/div&gt;\n    &lt;%= link_to_remove_association('Del.', f, class: \"btn btn-outline-danger\") %&gt;\n  &lt;/div&gt;\n&lt;/div&gt;\n</code></pre>\n\n<p>in the view, I have a field, to get the value of the product and the value of the percentage field, (which was selected by the user) and calculate the percentage of the new value of the product.</p>\n\n<p>but in this view, you can insert multiple products, and perform this action.</p>\n\n<p>Picture view example:\n<a href=\"https://ibb.co/s3Z43yk\" rel=\"nofollow noreferrer\">https://ibb.co/s3Z43yk</a></p>\n"}, {"tags": ["ruby", "vim", "indentation"], "comments": [{"owner": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "edited": false, "score": 0, "creation_date": 1559670792, "post_id": 56448436, "comment_id": 99491387, "body": "I think you mean when calling a method passing options hash for this style?"}, {"owner": {"reputation": 33, "user_id": 6121792, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3df1977a50515d0d42157c2bd4bc2d16?s=128&d=identicon&r=PG&f=1", "display_name": "Leonardo", "link": "https://stackoverflow.com/users/6121792/leonardo"}, "reply_to_user": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "edited": false, "score": 0, "creation_date": 1559674095, "post_id": 56448436, "comment_id": 99492653, "body": "Yes, that&#39;s what I meant"}], "answers": [{"comments": [{"owner": {"reputation": 33, "user_id": 6121792, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3df1977a50515d0d42157c2bd4bc2d16?s=128&d=identicon&r=PG&f=1", "display_name": "Leonardo", "link": "https://stackoverflow.com/users/6121792/leonardo"}, "edited": false, "score": 0, "creation_date": 1559674374, "post_id": 56449291, "comment_id": 99492780, "body": "I appreciate you taking the time. You&#39;re right. It does work with parentheses. But the problem that I&#39;m having is with methods that are part of Rails internal DSL, like <code>validates</code>."}, {"owner": {"reputation": 33, "user_id": 6121792, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3df1977a50515d0d42157c2bd4bc2d16?s=128&d=identicon&r=PG&f=1", "display_name": "Leonardo", "link": "https://stackoverflow.com/users/6121792/leonardo"}, "edited": false, "score": 0, "creation_date": 1559674429, "post_id": 56449291, "comment_id": 99492803, "body": "I like to omit the parentheses in these cases."}, {"owner": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "reply_to_user": {"reputation": 33, "user_id": 6121792, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3df1977a50515d0d42157c2bd4bc2d16?s=128&d=identicon&r=PG&f=1", "display_name": "Leonardo", "link": "https://stackoverflow.com/users/6121792/leonardo"}, "edited": false, "score": 0, "creation_date": 1559681021, "post_id": 56449291, "comment_id": 99495479, "body": "I don&#39;t think there&#39;s a simple way then. The style guide does not recommend omitting parens when passing options hash args. Perhaps your issue is one of the reasons.  <a href=\"https://github.com/rubocop-hq/ruby-style-guide#no-braces-options-hash\" rel=\"nofollow noreferrer\">github.com/rubocop-hq/ruby-style-guide#no-braces-options-has&zwnj;&#8203;h</a>"}, {"owner": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "reply_to_user": {"reputation": 33, "user_id": 6121792, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3df1977a50515d0d42157c2bd4bc2d16?s=128&d=identicon&r=PG&f=1", "display_name": "Leonardo", "link": "https://stackoverflow.com/users/6121792/leonardo"}, "edited": false, "score": 0, "creation_date": 1559681214, "post_id": 56449291, "comment_id": 99495568, "body": "But perhaps post a better example in your question?  Otherwise, I would recommend using the parens especially when passing options hash argument as a multi-line style."}], "tags": [], "owner": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "is_accepted": false, "score": 0, "last_activity_date": 1559672046, "creation_date": 1559672046, "answer_id": 56449291, "question_id": 56448436, "link": "https://stackoverflow.com/questions/56448436/how-to-align-the-elements-of-a-ruby-method-call-on-vim/56449291#56449291", "title": "How to align the elements of a ruby method call on Vim", "body": "<p>These plugins should work as expected.  However, you should not need to line break arguments passed to a method.  You define them like this.</p>\n\n<pre><code>def my_method(arg1, arg2, arg3)\n  #do stuff\nend\n</code></pre>\n\n<p>Or you can omit the parens in the method definition:</p>\n\n<pre><code>def my_method arg1, ar2, arg3\n  #do stuff\nend\n</code></pre>\n\n<p>For a method which takes an options hash:</p>\n\n<pre><code>def my_method(opt={})\n  #do stuff\nend\n</code></pre>\n\n<p>And to call the above you can do</p>\n\n<pre><code>my_method(foo: 'foo', bar: 'bar')\n</code></pre>\n\n<p>But if you typed this, <code>gg=G</code> should fix it correctly:</p>\n\n<pre><code>my_method(\nfoo: 'foo',\n    bar: 'bary\n    )\n</code></pre>\n\n<p>Using <code>gg=G</code> should change it to:</p>\n\n<pre><code>my_method(\n  foo: 'foo',\n  bar: 'bar'\n)\n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 6121792, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3df1977a50515d0d42157c2bd4bc2d16?s=128&d=identicon&r=PG&f=1", "display_name": "Leonardo", "link": "https://stackoverflow.com/users/6121792/leonardo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 70, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1559672046, "creation_date": 1559667983, "last_edit_date": 1559668246, "question_id": 56448436, "link": "https://stackoverflow.com/questions/56448436/how-to-align-the-elements-of-a-ruby-method-call-on-vim", "title": "How to align the elements of a ruby method call on Vim", "body": "<p>According to the <a href=\"https://github.com/rubocop-hq/ruby-style-guide#user-content-no-double-indent\" rel=\"nofollow noreferrer\">ruby-style-guide</a>, this is the preferable way to align the elements of a method call:</p>\n\n<pre><code>method :arg1,\n       :arg2,\n       :arg3\n</code></pre>\n\n<p>However, this is what I got when I try to indent the whole file using <code>gg=G</code>:</p>\n\n<pre><code>method :arg1,\n  :arg2,\n  :arg3\n</code></pre>\n\n<p>I'm currently using <a href=\"https://github.com/vim-ruby/vim-ruby\" rel=\"nofollow noreferrer\">vim-ruby</a> and <a href=\"https://github.com/tpope/vim-rails\" rel=\"nofollow noreferrer\">vim-rails</a> plugins.</p>\n\n<p>Is it possible to get vim indentation to work like the style guide suggests?</p>\n"}, {"tags": ["ruby", "dynamic"], "answers": [{"tags": [], "owner": {"reputation": 1051, "user_id": 178348, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a4a060b077b8d0da6429d11aba4c62be?s=128&d=identicon&r=PG", "display_name": "Zolt&#225;n Sz\u0151cs", "link": "https://stackoverflow.com/users/178348/zolt%c3%a1n-sz%c5%91cs"}, "is_accepted": true, "score": 1, "last_activity_date": 1559666734, "creation_date": 1559666734, "answer_id": 56448166, "question_id": 56448099, "link": "https://stackoverflow.com/questions/56448099/problem-setting-dynamic-hash-name-using-eval-in-ruby/56448166#56448166", "title": "Problem setting dynamic hash name using Eval in Ruby", "body": "<p>I think using <code>eval</code> here is superflous, what you probably want is string substitution:</p>\n\n<p><code>gates[\"gate#{inputx}_#{inputy}\"] = Gate.new(in1, in2)</code></p>\n\n<p>Using <code>eval(\"gate#{inputx}_#{inputy}\")</code> first substitutes the string, then performs the <code>eval</code> on said string: <code>eval(\"gate3_4\")</code>, which is why it complains that the variable is missing, because you are executing this ruby sentence <code>gate3_4</code>.</p>\n"}], "owner": {"reputation": 63, "user_id": 10665476, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5c4f7dbb56d9dcd2f72ff0a82ab21956?s=128&d=identicon&r=PG&f=1", "display_name": "Wesley Lance", "link": "https://stackoverflow.com/users/10665476/wesley-lance"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 17, "favorite_count": 0, "accepted_answer_id": 56448166, "answer_count": 1, "score": 0, "last_activity_date": 1559666734, "creation_date": 1559666502, "question_id": 56448099, "link": "https://stackoverflow.com/questions/56448099/problem-setting-dynamic-hash-name-using-eval-in-ruby", "title": "Problem setting dynamic hash name using Eval in Ruby", "body": "<p>I have this line of code to set a hash key to an xy coordinate pair and set its value to a class instance: </p>\n\n<pre><code>gates[eval(\"gate#{inputx}_#{inputy}\")] = Gate.new(in1, in2)\n</code></pre>\n\n<p>However, I get an undefined variable error when I run. If I set inputx and inputy to 3 and 4 respectively, I get this:</p>\n\n<pre><code>undefined local variable or method `gate3_4' for main:Object (NameError)\n</code></pre>\n\n<p>What is causing this?</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "answers": [{"comments": [{"owner": {"reputation": 15, "user_id": 11267636, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d1e27a2252c7644d006787823497d5cf?s=128&d=identicon&r=PG&f=1", "display_name": "antoine", "link": "https://stackoverflow.com/users/11267636/antoine"}, "edited": false, "score": 0, "creation_date": 1559662196, "post_id": 56446849, "comment_id": 99487477, "body": "Ok it&#39;s not working but I don&#39;t have the error anymore thanks :)"}], "tags": [], "owner": {"reputation": 16587, "user_id": 177053, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3f6c516626d381a1ea383cedd1799486?s=128&d=identicon&r=PG", "display_name": "Vasfed", "link": "https://stackoverflow.com/users/177053/vasfed"}, "is_accepted": false, "score": 0, "last_activity_date": 1559661644, "creation_date": 1559661644, "answer_id": 56446849, "question_id": 56446551, "link": "https://stackoverflow.com/questions/56446551/nameerror-uninitialized-constant-contactcontroller/56446849#56446849", "title": "NameError - uninitialized constant ContactController", "body": "<p>Spot the difference - <code>ContactController</code> vs <code>ContactsController</code> (one plural, other is not)</p>\n\n<p>If you have your routes set up this way so that controller has singular name - rename it (and the file) to match, or change routes.</p>\n"}], "owner": {"reputation": 15, "user_id": 11267636, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d1e27a2252c7644d006787823497d5cf?s=128&d=identicon&r=PG&f=1", "display_name": "antoine", "link": "https://stackoverflow.com/users/11267636/antoine"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 306, "favorite_count": 0, "answer_count": 1, "score": -3, "last_activity_date": 1559661644, "creation_date": 1559660628, "last_edit_date": 1559661468, "question_id": 56446551, "link": "https://stackoverflow.com/questions/56446551/nameerror-uninitialized-constant-contactcontroller", "title": "NameError - uninitialized constant ContactController", "body": "<p>I am trying to create a contact form to allow the user to contact the owner of the website but I got an error I can't get rid of ... </p>\n\n<p>I got this error in my console :</p>\n\n<blockquote>\n  <p>NameError - uninitialized constant ContactController:\n  Started POST \"/__better_errors/e029756238b49ce0/variables\" for ... </p>\n</blockquote>\n\n<p>And this error in the local page : </p>\n\n<blockquote>\n  <p>NameError at /contact.html\n  uninitialized constant ContactController</p>\n</blockquote>\n\n<pre><code>raise(e) unless e.name == const_name\n            # If the constant was actually loaded, something else went wrong?\n            raise(e) if from_mod.const_defined?(const_name)\n            CoreExt::ActiveSupport.without_bootsnap_cache { super }\n          end\n</code></pre>\n\n<p>with a highlight on <code>CoreExt::ActiveSupport.without_bootsnap_cache { super }</code></p>\n\n<p>I put that in my contacts_controller.rb :</p>\n\n<pre><code>class ContactsController &lt; ApplicationController\n    def new\n        @contact = Contact.new\n    end\n\n    def create\n        @contact = Contact.new params[:contact]\n\n        if @contact.valid?\n          ContactMailer.contact_form(@contact).deliver_now\n          redirect_to contact_path, flash: {success: t(:\"create.message_has_been_sent\")}\n        else\n          render :new\n        end\n    end\nend\n</code></pre>\n\n<p>I have that in my contact_mailer.rb : </p>\n\n<pre><code>class ContactMailer &lt; ApplicationMailer\n    layout 'mailer'\n\n    def contact_form(contact)\n      @contact = contact\n      @to = \"zigzago@protonmail.com\"\n\n      mail(to: @to, subject: \"Nouveau contact depuis le site\") do |format|\n        format.html\n      end\n    end\nend\n</code></pre>\n"}, {"tags": ["ruby", "manageiq"], "answers": [{"tags": [], "owner": {"reputation": 24, "user_id": 12095247, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-5yCNQ7hbiTs/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rc8Q23hzjjJWsSgxIyoWDahSPwgDw/photo.jpg?sz=128", "display_name": "Nikhil Patne", "link": "https://stackoverflow.com/users/12095247/nikhil-patne"}, "is_accepted": true, "score": 0, "last_activity_date": 1575524708, "creation_date": 1575524708, "answer_id": 59188967, "question_id": 56446549, "link": "https://stackoverflow.com/questions/56446549/how-to-remove-disk-from-vm-in-cloudforms-using-custom-button/59188967#59188967", "title": "How to remove disk from VM in Cloudforms, using custom Button?", "body": "<p>Hello I Have Successfully Remove Disk from VM in Cloudforms with Your Code</p>\n\n<p>But There is one minor thing I have changed</p>\n\n<p>you are using <strong>disk_name = \"#{vm}_#{disk_choice}\"</strong>   as a disk name in order to delete Disk. But This is not like that.</p>\n\n<p>You have to mention Datastore for that disk in <em>disk_name</em> then it will be work fine</p>\n\n<p>you can try with following code</p>\n\n<pre><code>disk_name = \"[your_datastore_name] #{vm}/#{vm}_#{disk_choice}.vmdk\"\n</code></pre>\n\n<p>This works fine with me..!!</p>\n\n<p>One more thing you can consider i.e <strong>Delete Backing</strong></p>\n\n<p>Delete Backing => OFF [Default] It will Just Detach your Disk from VM but not completely removed</p>\n\n<p>so you have to turn on your Delete Backing so that it can completely remove disk from storage Domain as well</p>\n\n<p><strong>Delete Backing => ON</strong></p>\n\n<p>you can explore <a href=\"https://bugzilla.redhat.com/show_bug.cgi?id=1392979\" rel=\"nofollow noreferrer\">here</a></p>\n\n<p>Thank you..!!</p>\n"}], "owner": {"reputation": 13, "user_id": 11290117, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-LJEXaRHg4ac/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfxCvHZsb8TgArNDThkZnjH7NCCzw/mo/photo.jpg?sz=128", "display_name": "dodge2451", "link": "https://stackoverflow.com/users/11290117/dodge2451"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 116, "favorite_count": 0, "accepted_answer_id": 59188967, "answer_count": 1, "score": 1, "last_activity_date": 1575524708, "creation_date": 1559660623, "question_id": 56446549, "link": "https://stackoverflow.com/questions/56446549/how-to-remove-disk-from-vm-in-cloudforms-using-custom-button", "title": "How to remove disk from VM in Cloudforms, using custom Button?", "body": "<p>Currently, I'm Setting up a custom button in Cloudforms to allow for the removal of a drive from a Virtual Machine that has been provisioned using Cloudforms(hooked into ansible)</p>\n\n<p>I've been looking at this a little while and after some digging discovered the following <a href=\"https://github.com/ManageIQ/manageiq-automation_engine/blob/master/lib/miq_automation_engine/service_models/miq_ae_service_manageiq-providers-vmware-infra_manager-vm.rb\" rel=\"nofollow noreferrer\">https://github.com/ManageIQ/manageiq-automation_engine/blob/master/lib/miq_automation_engine/service_models/miq_ae_service_manageiq-providers-vmware-infra_manager-vm.rb</a> </p>\n\n<p>More specifically:</p>\n\n<pre><code>def remove_disk(disk_name, options = {})\n  sync_or_async_ems_operation(options[:sync], \"remove_disk\", [disk_name, options])\nend\n</code></pre>\n\n<p>I've assumed two things, that this would probably take the vmdk name and would work the same as \"add_disk\" (vm.add_disk(\"[#{vm.storage_name}]\", size * 1024, :sync => true)).</p>\n\n<p>I AM AWARE that you can edit disks using the built-in functionality of CLoudforms via the provided configuration button, however, due to customer requirements we needed to edit the HAML files to remove some functionality. Redoing the HAML on every update of CloudForms is rather counterproductive. Creating our own custom dialogs provides us with the customization we needed.</p>\n\n<pre><code># Get vm object\nvm = $evm.root['vm']\nraise \"Missing $evm.root['vm'] object\" unless vm\n\n  def log(level, message)\n    @method = 'Remove_Disk'\n    $evm.log(level, \"#{@method} - #{message}\")\n  end\n\n$evm.create_notification(:audience =&gt; 'user', :level =&gt; :success, :message =&gt; \"Lifecycle action 'Remove Disk' Initiated\")\nlog(:info, \"Started LCA to remove disk on vm: &lt;#{vm}&gt;\")\n\n# Remove disk from the VM\n  disk_choice = $evm.root['dialog_availabledisks'].to_i\n  if disk_choice.zero?\n    disk_name = \"#{vm}\"\n    $evm.create_notification(:audience =&gt; 'user', :level =&gt; :failure, :message =&gt; \"Lifecycle action 'Remove Disk' Failed, OS Drive cannot be removed.\")\n    log(:error, \"C: Drive cannot be deleted\")\n    exit MIQ_ABORT\n  else\n    disk_name = \"#{vm}_#{disk_choice}\"\n  end\n\n  log(:info, \"Removing disk:&lt;#{disk_name}&gt; from #{vm}\")\n\n\n begin\n      vm.remove_disk(disk_name, :sync =&gt; true)\n    rescue =&gt; e\n      log(:error, \"e: #{e}\")\n      log(:error, \"e.inspect: #{e.inspect}\")\n      log(:error,\"[#{e}]\\n#{e.backtrace.join(\"\\n\")}\")\n      log(:error, \"e.message: #{e.message}\")\n end\n\nexit MIQ_OK\n\n</code></pre>\n\n<p>My code runs through without any errors, however, does not actually do anything, the disk selected is not removed from the VM. Fairly sure I am just missing something obvious(Or my assumptions are incorrect), any ideas?</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 252, "user_id": 5364211, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ixqyo.jpg?s=128&g=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/5364211/tom"}, "edited": false, "score": 0, "creation_date": 1559659941, "post_id": 56446315, "comment_id": 99486184, "body": "Sounds like you want to use some kind of multi-map structure rather than an array, where the Country is the key and the names the values"}], "answers": [{"comments": [{"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1559666867, "post_id": 56446717, "comment_id": 99489784, "body": "It looks like you switched from the name <code>unique_names</code> to <code>mapped_names</code>, but didn&#39;t change all occurrences of the former. No reply needed. I&#39;ll delete this comment when you&#39;ve seen it."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1559667111, "post_id": 56446717, "comment_id": 99489903, "body": "It looks like <a href=\"https://blog.saeloun.com/2019/03/03/ruby-2-7-enumerable-tally.html\" rel=\"nofollow noreferrer\">Enumerable#tally</a> will be quite useful."}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "reply_to_user": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1559669954, "post_id": 56446717, "comment_id": 99491064, "body": "@CarySwoveland <a href=\"https://stackoverflow.com/a/48053739/1954610\">Yep, I agree</a>"}], "tags": [], "owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "is_accepted": false, "score": 3, "last_activity_date": 1559661192, "creation_date": 1559661192, "answer_id": 56446717, "question_id": 56446315, "link": "https://stackoverflow.com/questions/56446315/how-to-find-the-number-of-unique-occurrences-for-an-array-in-ruby/56446717#56446717", "title": "How to find the number of unique occurrences for an Array in Ruby", "body": "<p>The problem, really, is that you're storing this data as an array of strings. This is a poor choice of data structure, as it makes manipulation much harder.</p>\n\n<p>Suppose, for example, we first convert this data into a <code>Hash</code>, which maps each country to the list of names:</p>\n\n<pre><code>data = ['England John', 'England Ben', 'USA Paul', 'England John']\n\nmapped_names = {}\n\ndata.each do |item|\n  country, name = item.split\n  mapped_names[country] ||= []\n  mapped_names[country] &lt;&lt; name\nend\n</code></pre>\n\n<p>Now, obtaining the count is quite easy:</p>\n\n<pre><code>mapped_name_counts = unique_names.transform_values { |names| names.uniq.count }\n</code></pre>\n\n<p>The resulting variables are:</p>\n\n<pre><code>mapped_names # =&gt; {\"England\"=&gt;[\"John\", \"Ben\", \"John\"], \"USA\"=&gt;[\"Paul\"]}\nmapped_name_counts # =&gt; {\"England\"=&gt;2, \"USA\"=&gt;1}\n</code></pre>\n\n<p>And if using ruby version 2.7 (not yet released!!), that last line of code could even be simplified to:</p>\n\n<pre><code>mapped_name_counts = unique_names.tally(&amp;:uniq)\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 33085, "user_id": 2423164, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/Nxbnp.jpg?s=128&g=1", "display_name": "ndnenkov", "link": "https://stackoverflow.com/users/2423164/ndnenkov"}, "edited": false, "score": 0, "creation_date": 1559662269, "post_id": 56446822, "comment_id": 99487523, "body": "Note that <code>transform_values</code> is an ActiveSupport method. If you&#39;re not using rails, you can replace it with <code>map { |country, occurrences| [country, occurences.count] }.to_h</code>."}, {"owner": {"reputation": 9663, "user_id": 5239030, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/76JEw.png?s=128&g=1", "display_name": "iGian", "link": "https://stackoverflow.com/users/5239030/igian"}, "reply_to_user": {"reputation": 33085, "user_id": 2423164, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/Nxbnp.jpg?s=128&g=1", "display_name": "ndnenkov", "link": "https://stackoverflow.com/users/2423164/ndnenkov"}, "edited": false, "score": 0, "creation_date": 1559664627, "post_id": 56446822, "comment_id": 99488702, "body": "@ndnenkov, <code>transform_values</code> is pure Ruby: <a href=\"https://ruby-doc.org/core-2.6.3/Hash.html#method-i-transform_values\" rel=\"nofollow noreferrer\">ruby-doc.org/core-2.6.3/Hash.html#method-i-transform_values</a>, but for older Ruby your option is ok."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1559664642, "post_id": 56446822, "comment_id": 99488712, "body": "ndnenkov and @pascalbetz, <a href=\"http://ruby-doc.org/core-2.5.1/Hash.html#method-i-transform_values\" rel=\"nofollow noreferrer\">Hash#transform_values</a> (and <code>transform_values!</code>, <code>transform_keys</code> and <code>transform_keys!</code>) made it&#39;s debut in Ruby v2.4."}, {"owner": {"reputation": 41, "user_id": 11066917, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6e78d1bafc32d3a28b176f87e6c816fd?s=128&d=identicon&r=PG&f=1", "display_name": "Ben Williams", "link": "https://stackoverflow.com/users/11066917/ben-williams"}, "edited": false, "score": 0, "creation_date": 1559738086, "post_id": 56446822, "comment_id": 99512549, "body": "@iGian Thank you for your reply. Please could you explain what the different parts do? I&#39;m especially confused by the <code>{ |e| e.split.first }</code> bit, and the <code>transform_values(&amp;:count)</code> bit"}, {"owner": {"reputation": 9663, "user_id": 5239030, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/76JEw.png?s=128&g=1", "display_name": "iGian", "link": "https://stackoverflow.com/users/5239030/igian"}, "reply_to_user": {"reputation": 41, "user_id": 11066917, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6e78d1bafc32d3a28b176f87e6c816fd?s=128&d=identicon&r=PG&f=1", "display_name": "Ben Williams", "link": "https://stackoverflow.com/users/11066917/ben-williams"}, "edited": false, "score": 0, "creation_date": 1559743029, "post_id": 56446822, "comment_id": 99515558, "body": "@BenWilliams I&#39;d suggest you run the code step by step: <code>ary.uniq</code>, then <code>ary.uniq.group_by { |e| e.split.first }</code> and so on. <code>|e|</code> is the variable that contains the string which is splitted into an array of which we take the first element: <code>&quot;a b&quot;.split.first</code> returns <code>&quot;a&quot;</code>, which is the value used for grouping. For <code>transform_values</code>, please see the comments above."}], "tags": [], "owner": {"reputation": 9663, "user_id": 5239030, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/76JEw.png?s=128&g=1", "display_name": "iGian", "link": "https://stackoverflow.com/users/5239030/igian"}, "is_accepted": false, "score": 4, "last_activity_date": 1559661540, "creation_date": 1559661540, "answer_id": 56446822, "question_id": 56446315, "link": "https://stackoverflow.com/questions/56446315/how-to-find-the-number-of-unique-occurrences-for-an-array-in-ruby/56446822#56446822", "title": "How to find the number of unique occurrences for an Array in Ruby", "body": "<p>One liner option:</p>\n\n<pre><code>ary.uniq.group_by { |e| e.split.first }.transform_values(&amp;:count)\n#=&gt; {\"England\"=&gt;2, \"USA\"=&gt;1}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 7224, "user_id": 448934, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TXtux.jpg?s=128&g=1", "display_name": "Pascal", "link": "https://stackoverflow.com/users/448934/pascal"}, "is_accepted": false, "score": 0, "last_activity_date": 1559665164, "last_edit_date": 1559665164, "creation_date": 1559662312, "answer_id": 56447033, "question_id": 56446315, "link": "https://stackoverflow.com/questions/56446315/how-to-find-the-number-of-unique-occurrences-for-an-array-in-ruby/56447033#56447033", "title": "How to find the number of unique occurrences for an Array in Ruby", "body": "<p>A bit more verbose than the other solutions but does not use  <code>transform_values</code>from ActiveSupport.</p>\n\n<pre><code>require \"set\"\n\ndata = [\"England John\", \"England Ben\", \"USA Paul\", \"England John\", \"Switzerland Pascal\"]\n\nnames_per_country = data.each_with_object({}) do |country_and_name, accu|\n  country, name = country_and_name.split(\" \")\n  country_data = accu[country] ||= Set.new\n  country_data &lt;&lt; name\nend\n\nnames_per_country.each do |country, names|\n  puts \"#{country} has #{names.size} unique name(s)\"\nend\n\n# =&gt; England has 2 unique names\n# =&gt; USA has 1 unique names\n# =&gt; Switzerland has 1 unique names\n</code></pre>\n\n<p>This solution first transforms the array to a <code>Hash</code> structure, where the <em>key</em> is the country name and the <em>value</em> is a <code>Set</code>.\nI've chosen <code>Set</code> because it does take care of the <em>unique</em> part of your question automatically (a <code>Set</code> can not contain duplicates).</p>\n\n<p>After that you can find the number of unique names per country by checking the <code>size</code> of the <code>Set</code>. \nYou can also find the names (the elements of the <code>Set</code> if required)</p>\n"}, {"tags": [], "owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "is_accepted": false, "score": 0, "last_activity_date": 1559666217, "last_edit_date": 1559666217, "creation_date": 1559665576, "answer_id": 56447876, "question_id": 56446315, "link": "https://stackoverflow.com/questions/56446315/how-to-find-the-number-of-unique-occurrences-for-an-array-in-ruby/56447876#56447876", "title": "How to find the number of unique occurrences for an Array in Ruby", "body": "<pre><code>arr = ['England John', 'England Ben', 'USA Paul', 'England John']\n</code></pre>\n\n<h1><p></p></h1>\n\n<pre><code>arr.uniq.each_with_object(Hash.new(0)) { |s,h| h[s[/\\S+/]] += 1 }\n  #=&gt; {\"England\"=&gt;2, \"USA\"=&gt;1}\n</code></pre>\n\n<p>This requires two passes through the array (<code>arr.uniq</code> being the first). To make only a single pass one could do the following.</p>\n\n<pre><code>require 'set'\n\nuniques = Set.new\narr.each_with_object(Hash.new(0)) { |s,h| h[s[/\\S+/]] += 1 if uniques.add?(s) }\n  #=&gt; {\"England\"=&gt;2, \"USA\"=&gt;1}\n</code></pre>\n\n<p>See the form of <a href=\"http://ruby-doc.org/core-2.5.1/Hash.html#method-c-new\" rel=\"nofollow noreferrer\">Hash::new</a> that takes an argument (called the <em>default value</em>), and also <a href=\"http://ruby-doc.org/stdlib-2.5.1/libdoc/set/rdoc/Set.html#method-i-add-3F\" rel=\"nofollow noreferrer\">Set#add?</a>.</p>\n\n<p>It's not clear to me which of the two calculations would generally be faster.</p>\n"}], "owner": {"reputation": 41, "user_id": 11066917, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6e78d1bafc32d3a28b176f87e6c816fd?s=128&d=identicon&r=PG&f=1", "display_name": "Ben Williams", "link": "https://stackoverflow.com/users/11066917/ben-williams"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 108, "favorite_count": 0, "answer_count": 4, "score": 0, "last_activity_date": 1559719654, "creation_date": 1559659780, "last_edit_date": 1559659975, "question_id": 56446315, "link": "https://stackoverflow.com/questions/56446315/how-to-find-the-number-of-unique-occurrences-for-an-array-in-ruby", "title": "How to find the number of unique occurrences for an Array in Ruby", "body": "<p>I have an array, containing <code>n</code> amount of elements. Each element contains two words.</p>\n\n<p>This makes the array look like this: <code>['England John', 'England Ben', 'USA Paul', 'England John']</code></p>\n\n<p>I want to find the number of unique names for each country. For example, <code>England</code> would have 2 unique names as <code>John</code> exists two times. </p>\n\n<p>So far I have split the array into two arrays, one containing the countries such as <code>['England', 'Usa', ...]</code> and the other containing names <code>['John', 'Paul', ...]</code>, however I'm unsure of where to go from here</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "haml"], "answers": [{"tags": [], "owner": {"reputation": 16587, "user_id": 177053, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3f6c516626d381a1ea383cedd1799486?s=128&d=identicon&r=PG", "display_name": "Vasfed", "link": "https://stackoverflow.com/users/177053/vasfed"}, "is_accepted": true, "score": 0, "last_activity_date": 1559659589, "creation_date": 1559659589, "answer_id": 56446251, "question_id": 56446088, "link": "https://stackoverflow.com/questions/56446088/how-to-convert-a-tag-to-link-to/56446251#56446251", "title": "How to convert %a tag to link_to", "body": "<p>When there's no <code>href</code> - you can pass <code>nil</code> there:</p>\n\n<pre><code>= link_to nil, class: 'dropdown-toggle nav-link',\n  type: :button,\n  aria:{ expanded: false, haspopup: true},\n  data: { behavior: \"notifications-link\",  toggle: :dropdown} do\n  %i.fa.fa-bell\n  - # and so on\n</code></pre>\n\n<p>but for places where it's actually not a link - there' no much sense in making it a <code>link_to</code></p>\n"}, {"tags": [], "owner": {"reputation": 1012, "user_id": 10347572, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iottG.jpg?s=128&g=1", "display_name": "escanxr", "link": "https://stackoverflow.com/users/10347572/escanxr"}, "is_accepted": false, "score": 0, "last_activity_date": 1559660911, "last_edit_date": 1559660911, "creation_date": 1559659593, "answer_id": 56446253, "question_id": 56446088, "link": "https://stackoverflow.com/questions/56446088/how-to-convert-a-tag-to-link-to/56446253#56446253", "title": "How to convert %a tag to link_to", "body": "<pre><code>= link_to nil, type: :button,\n  class: 'dropdown-toggle nav-link',\n  aria: { expanded: false, haspopup: true },\n  data: { behavior: 'notifications-link', toggle: 'dropdown' } do\n\n  %i.fa.fa-bell\n  %span{\"data-behavior\" =&gt; \"unread-count\"}\n</code></pre>\n\n<p>Should be ok with this code</p>\n"}], "owner": {"reputation": 7, "user_id": 11578325, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-LIioUcEpL9I/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rePRM-4zhU-lF5wfe5ZkK_oBaJ61w/mo/photo.jpg?sz=128", "display_name": "Kobe Beau Alcober", "link": "https://stackoverflow.com/users/11578325/kobe-beau-alcober"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 40, "favorite_count": 0, "accepted_answer_id": 56446251, "answer_count": 2, "score": 0, "last_activity_date": 1581308599, "creation_date": 1559658981, "last_edit_date": 1581308599, "question_id": 56446088, "link": "https://stackoverflow.com/questions/56446088/how-to-convert-a-tag-to-link-to", "title": "How to convert %a tag to link_to", "body": "<p>I have a Rails application that has a simple notification system. Many people are part of this project and sadly we didn't stick to a standard coding convention. There are some weird problems happening in certain situations and I found out that these occur because they were linked to using <code>%a</code> instead of <code>link_to</code>.</p>\n\n<p>I then embarked on a journey of changing each <code>%a</code> to <code>link_to</code> and have already converted the simple stuff and then this boggled me:</p>\n\n<pre><code>.dropdown{\"data-behavior\" =&gt; \"notifications\"}\n  %a.dropdown-toggle.nav-link{\"aria-expanded\" =&gt; \"false\", \"aria-haspopup\" =&gt; \"true\", \"data-behavior\" =&gt; \"notifications-link\", \"data-toggle\" =&gt; \"dropdown\", :type =&gt; \"button\"}\n    %i.fa.fa-bell\n    %span{\"data-behavior\" =&gt; \"unread-count\"}\n  .dropdown-menu.dropdown-menu-right{\"aria-labelledby\" =&gt; \"dropdownMenuButton\", \"data-behavior\" =&gt; \"notification-items\"}\n</code></pre>\n\n<p>How do I convert this to a <code>link_to</code>?</p>\n"}, {"tags": ["ruby-on-rails", "json", "ruby", "ajax", "ruby-on-rails-5"], "comments": [{"owner": {"reputation": 6039, "user_id": 2137458, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8cfca832ee746f3e3d9971148f52dc64?s=128&d=identicon&r=PG", "display_name": "NM Pennypacker", "link": "https://stackoverflow.com/users/2137458/nm-pennypacker"}, "edited": false, "score": 0, "creation_date": 1559660551, "post_id": 56446081, "comment_id": 99486544, "body": "What do you see when you add <code>console.log(data);</code>?"}, {"owner": {"reputation": 61, "user_id": 11599519, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f2b606478e2f9d68ef58fee1c93c062f?s=128&d=identicon&r=PG&f=1", "display_name": "Shakered", "link": "https://stackoverflow.com/users/11599519/shakered"}, "reply_to_user": {"reputation": 6039, "user_id": 2137458, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8cfca832ee746f3e3d9971148f52dc64?s=128&d=identicon&r=PG", "display_name": "NM Pennypacker", "link": "https://stackoverflow.com/users/2137458/nm-pennypacker"}, "edited": false, "score": 0, "creation_date": 1559661363, "post_id": 56446081, "comment_id": 99487018, "body": "Something like {readyState: 4, getResponseHeader: \u0192, getAllResponseHeaders: \u0192, setRequestHeader: \u0192, overrideMimeType: \u0192, \u2026} with a lot of methods and responseJSON and responseText"}, {"owner": {"reputation": 6039, "user_id": 2137458, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8cfca832ee746f3e3d9971148f52dc64?s=128&d=identicon&r=PG", "display_name": "NM Pennypacker", "link": "https://stackoverflow.com/users/2137458/nm-pennypacker"}, "edited": false, "score": 0, "creation_date": 1559661553, "post_id": 56446081, "comment_id": 99487127, "body": "How about <code>console.log(data[&#39;follow&#39;]);</code>?"}, {"owner": {"reputation": 61, "user_id": 11599519, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f2b606478e2f9d68ef58fee1c93c062f?s=128&d=identicon&r=PG&f=1", "display_name": "Shakered", "link": "https://stackoverflow.com/users/11599519/shakered"}, "reply_to_user": {"reputation": 6039, "user_id": 2137458, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8cfca832ee746f3e3d9971148f52dc64?s=128&d=identicon&r=PG", "display_name": "NM Pennypacker", "link": "https://stackoverflow.com/users/2137458/nm-pennypacker"}, "edited": false, "score": 0, "creation_date": 1559662225, "post_id": 56446081, "comment_id": 99487495, "body": "it says undefined :)"}, {"owner": {"reputation": 6039, "user_id": 2137458, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8cfca832ee746f3e3d9971148f52dc64?s=128&d=identicon&r=PG", "display_name": "NM Pennypacker", "link": "https://stackoverflow.com/users/2137458/nm-pennypacker"}, "edited": false, "score": 0, "creation_date": 1559662290, "post_id": 56446081, "comment_id": 99487538, "body": "Well, there you go. Not sure if that gets you any closer to solving the problem, but you might start there :)"}, {"owner": {"reputation": 61, "user_id": 11599519, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f2b606478e2f9d68ef58fee1c93c062f?s=128&d=identicon&r=PG&f=1", "display_name": "Shakered", "link": "https://stackoverflow.com/users/11599519/shakered"}, "reply_to_user": {"reputation": 6039, "user_id": 2137458, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8cfca832ee746f3e3d9971148f52dc64?s=128&d=identicon&r=PG", "display_name": "NM Pennypacker", "link": "https://stackoverflow.com/users/2137458/nm-pennypacker"}, "edited": false, "score": 0, "creation_date": 1559664811, "post_id": 56446081, "comment_id": 99488773, "body": "Penny! The problem was with .bind method :) I switched to .on and now it works ;)"}], "answers": [{"tags": [], "owner": {"reputation": 6039, "user_id": 2137458, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8cfca832ee746f3e3d9971148f52dc64?s=128&d=identicon&r=PG", "display_name": "NM Pennypacker", "link": "https://stackoverflow.com/users/2137458/nm-pennypacker"}, "is_accepted": true, "score": 0, "last_activity_date": 1559668085, "creation_date": 1559668085, "answer_id": 56448458, "question_id": 56446081, "link": "https://stackoverflow.com/questions/56446081/cant-access-data-inside-ajax-jquery-function-after-rendering-partial-in-rails/56448458#56448458", "title": "Can&#39;t access data inside Ajax jquery function after rendering partial in Rails", "body": "<p>You might start by debugging your <code>data</code> object in the console:\n<code>console.log('data: ', data);</code> should be returning the data that you need. If not, something is wrong with the response or the method.</p>\n\n<p>Just posting this as an answer in case anyone else has a similar problem. The problem is that you need to change your AJAX listener function from <code>.bind()</code> to <code>.on()</code>.</p>\n\n<p>So in your case:</p>\n\n<pre><code>$('#unfollow').on('ajax:complete', function(xhr, data){\n  $(this).replaceWith(data.follow);\n});\n</code></pre>\n"}], "owner": {"reputation": 61, "user_id": 11599519, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f2b606478e2f9d68ef58fee1c93c062f?s=128&d=identicon&r=PG&f=1", "display_name": "Shakered", "link": "https://stackoverflow.com/users/11599519/shakered"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 27, "favorite_count": 0, "accepted_answer_id": 56448458, "answer_count": 1, "score": 0, "last_activity_date": 1559668085, "creation_date": 1559658953, "question_id": 56446081, "link": "https://stackoverflow.com/questions/56446081/cant-access-data-inside-ajax-jquery-function-after-rendering-partial-in-rails", "title": "Can&#39;t access data inside Ajax jquery function after rendering partial in Rails", "body": "<p>The problem is I can't access data fetched in Ajax correctly I need to access data by data.responseJSONfrom.follow and I would like to do it by data.follow</p>\n\n<pre><code>def create\n follow = current_user.user_followings.new(following_id:params[:following_id])\n status = follow.save\n render json: {follow: status ? render_to_string(partial: 'users/follow', locals:{follow: follow, id_to_follow: follow.following_id }) : ''},\n             status: status ? :ok : :unprocessable_entity\n  end\n</code></pre>\n\n<pre><code>$('#unfollow').bind('ajax:complete', function(xhr, data){\n      $(this).replaceWith(data.follow);\n });\n\n</code></pre>\n\n<p>data.follow is unresolved variable</p>\n"}, {"tags": ["ruby", "selenium-webdriver", "watir"], "answers": [{"comments": [{"owner": {"reputation": 1702, "user_id": 880797, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/bace3dcc4a83523d93399ab2bd1f3728?s=128&d=identicon&r=PG", "display_name": "Andrey", "link": "https://stackoverflow.com/users/880797/andrey"}, "edited": false, "score": 0, "creation_date": 1559662312, "post_id": 56446525, "comment_id": 99487551, "body": "Thank you very much for the great explaination."}, {"owner": {"reputation": 697, "user_id": 1836306, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a3b6c2d0b2bafdb9ad9cdf782873204d?s=128&d=identicon&r=PG", "display_name": "Jeff Nyman", "link": "https://stackoverflow.com/users/1836306/jeff-nyman"}, "edited": false, "score": 1, "creation_date": 1582388159, "post_id": 56446525, "comment_id": 106763899, "body": "I&#39;m a bit late to this but this no longer seems to work. I locked my Selenium gem at 3.141.0 and confirmed that it is the version that is running. I&#39;m on the most recent Chrome. And I get the exact same series of messages reported in the original question."}, {"owner": {"reputation": 3480, "user_id": 4072371, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/112e615d8c60908294e30848d9556186?s=128&d=identicon&r=PG", "display_name": "titusfortner", "link": "https://stackoverflow.com/users/4072371/titusfortner"}, "reply_to_user": {"reputation": 697, "user_id": 1836306, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a3b6c2d0b2bafdb9ad9cdf782873204d?s=128&d=identicon&r=PG", "display_name": "Jeff Nyman", "link": "https://stackoverflow.com/users/1836306/jeff-nyman"}, "edited": false, "score": 0, "creation_date": 1582573425, "post_id": 56446525, "comment_id": 106816721, "body": "@JeffNyman the latest version of Selenium should work as expected right now"}, {"owner": {"reputation": 697, "user_id": 1836306, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a3b6c2d0b2bafdb9ad9cdf782873204d?s=128&d=identicon&r=PG", "display_name": "Jeff Nyman", "link": "https://stackoverflow.com/users/1836306/jeff-nyman"}, "edited": false, "score": 0, "creation_date": 1582662183, "post_id": 56446525, "comment_id": 106852866, "body": "@titusfortner I&#39;m using <code>selenium-webdriver 3.142.7</code> (appears to be the latest) and I&#39;m still getting those deprecation messages. But now I&#39;m wondering if it&#39;s due to one of other libraries I&#39;m using. I&#39;m using <code>webdrivers 4.2.0</code> and <code>watir 6.16.5</code>. Unless by &quot;latest version of Selenium&quot; you are referring to moving to one of the 4.x alpha versions?"}, {"owner": {"reputation": 3480, "user_id": 4072371, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/112e615d8c60908294e30848d9556186?s=128&d=identicon&r=PG", "display_name": "titusfortner", "link": "https://stackoverflow.com/users/4072371/titusfortner"}, "edited": false, "score": 0, "creation_date": 1583319927, "post_id": 56446525, "comment_id": 107073665, "body": "no, I haven&#39;t had a chance to look at Watir in a while. I&#39;ll check it out."}], "tags": [], "owner": {"reputation": 3480, "user_id": 4072371, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/112e615d8c60908294e30848d9556186?s=128&d=identicon&r=PG", "display_name": "titusfortner", "link": "https://stackoverflow.com/users/4072371/titusfortner"}, "is_accepted": true, "score": 11, "last_activity_date": 1559668801, "last_edit_date": 1559668801, "creation_date": 1559660522, "answer_id": 56446525, "question_id": 56445641, "link": "https://stackoverflow.com/questions/56445641/ruby-watir-selenium-webdriver-depricated-warning/56446525#56446525", "title": "Ruby Watir Selenium WebDriver depricated warning", "body": "<p>TL/DR:</p>\n\n<ol>\n<li>Ignore them, you're not doing anything wrong.</li>\n<li>Upgrade to Chrome v75+</li>\n<li>Downgrade to Selenium 3.141.0 for now</li>\n</ol>\n\n<p>Selenium used to be implemented with JSON Wire Protocol, which detailed the driver endpoints and the formatting of the payload the endpoints expected, etc. Unfortunately, each browser driver implementation had its own interesting edge cases and peculiarities which made cross browser testing more challenging. Selenium developers and browser vendors got together to agree on a w3c standard for these interactions so that everything can be done in a way that works for all of the browsers. This standard was released in 2018 as a <a href=\"https://w3c.github.io/webdriver/\" rel=\"noreferrer\">w3c recommendation</a>. Google is the last browser vendor to turn on w3c compliance mode by default, and <a href=\"https://groups.google.com/forum/#!topic/chromedriver-users/16mrmqKMbS8\" rel=\"noreferrer\">this will happen in Chrome v75</a> (which is getting released today).</p>\n\n<p>Selenium 3.142 is the last version of Selenium before Selenium 4. Selenium 4 is going to remove support for the legacy protocol entirely. As such, the Ruby Selenium team decided to throw warnings in the code for anything that won't work in Selenium 4. Because Chrome &lt; 75 does not comply with w3c by default, it will not work with Selenium 4 by default, so Selenium is throwing a warning. Note that this is an error as a result of the response from the driver, so there is nothing to change in your code to avoid this.</p>\n"}], "owner": {"reputation": 1702, "user_id": 880797, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/bace3dcc4a83523d93399ab2bd1f3728?s=128&d=identicon&r=PG", "display_name": "Andrey", "link": "https://stackoverflow.com/users/880797/andrey"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2411, "favorite_count": 0, "accepted_answer_id": 56446525, "answer_count": 1, "score": 4, "last_activity_date": 1563282410, "creation_date": 1559657305, "last_edit_date": 1563282410, "question_id": 56445641, "link": "https://stackoverflow.com/questions/56445641/ruby-watir-selenium-webdriver-depricated-warning", "title": "Ruby Watir Selenium WebDriver depricated warning", "body": "<p>I am trying to make Ruby Watir script to run on a new server.<br>\nI have a working script on the old server:</p>\n\n<pre><code>#!/bin/ruby\nrequire 'rubygems'\nrequire 'watir'\nrequire 'date'\nrequire 'headless'\nrequire 'fileutils'\nrequire 'uri'\nrequire 'logger'\n\nheadless = Headless.new(autopick: true, reuse: false, destroy_at_exit: true).start\noptions = Selenium::WebDriver::Chrome::Options.new\noptions.add_preference(:download, prefs)\noptions.add_argument('--ignore-certificate-errors')\noptions.add_argument('--disable-popup-blocking')\noptions.add_argument('--disable-translate')\n\nb = Watir::Browser.new(:chrome, options: options)\nb.goto 'someurl.com'\nb.div(:id =&gt; 'IFRAME1').iframe.body.div(:id =&gt; 'DIVID1').div(class: ['Test1', 'Test2']).link(:id =&gt; 'DIVID2').click #getting warning here\n</code></pre>\n\n<p>The warning I am getting is the following:</p>\n\n<blockquote>\n  <p>WARN Selenium [DEPRECATION]\n  Selenium::WebDriver::Error::ElementNotVisibleError is deprecated. Use\n  Selenium::WebDriver::Error::ElementNotInteractableError (ensure the\n  driver supports W3C WebDriver specification) instead.</p>\n</blockquote>\n\n<p>Current server versions:</p>\n\n<blockquote>\n  <p>headless (2.3.1, 2.2.0)</p>\n  \n  <p>selenium-webdriver (3.4.4)</p>\n  \n  <p>watir (6.6.3)</p>\n</blockquote>\n\n<p>New server versions:</p>\n\n<blockquote>\n  <p>headless (2.3.1)</p>\n  \n  <p>selenium-webdriver (3.142.3, 3.142.0)</p>\n  \n  <p>watir (6.16.5)</p>\n</blockquote>\n\n<p>I have a feeling that the issue is with version mismatch, but I cannot pinpoint it.</p>\n\n<p>So far I was not able to find any solution.</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 308, "user_id": 2218094, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/PnUld.jpg?s=128&g=1", "display_name": "SgtPepper", "link": "https://stackoverflow.com/users/2218094/sgtpepper"}, "edited": false, "score": 0, "creation_date": 1559659878, "post_id": 56445437, "comment_id": 99486145, "body": "Did you take a look at this <a href=\"https://stackoverflow.com/questions/42376213/rails-before-update-callback-with-nested-attributes\" title=\"rails before update callback with nested attributes\">stackoverflow.com/questions/42376213/&hellip;</a>  Have you tried using <code>before_update</code> or <code>before_validation</code> callbacks? <a href=\"https://api.rubyonrails.org/classes/ActiveRecord/Callbacks.html\" rel=\"nofollow noreferrer\">api.rubyonrails.org/classes/ActiveRecord/Callbacks.html</a>  Also you can try calling <code>valid?</code> before updating your object, if the object is invalid the update action is never called so you can render your errors."}, {"owner": {"reputation": 1012, "user_id": 10347572, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iottG.jpg?s=128&g=1", "display_name": "escanxr", "link": "https://stackoverflow.com/users/10347572/escanxr"}, "reply_to_user": {"reputation": 308, "user_id": 2218094, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/PnUld.jpg?s=128&g=1", "display_name": "SgtPepper", "link": "https://stackoverflow.com/users/2218094/sgtpepper"}, "edited": false, "score": 0, "creation_date": 1559660477, "post_id": 56445437, "comment_id": 99486494, "body": "Hi @SgtPepper, thanks for your answer. I tried to validate the <code>order</code> but it&#39;s valid, because <code>validate</code> method doesn&#39;t perform a validation for the nested attributes. I could add <code>validates_associated :texts</code> but every texts will be rejected if only one is invalid. I would like to use a callback, but I don&#39;t what is the best way to get the nested attributes and remove the hash if the text built with these attributes is invalid"}, {"owner": {"reputation": 189, "user_id": 1537116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/tYzuU.png?s=128&g=1", "display_name": "Shireesha Parampalli", "link": "https://stackoverflow.com/users/1537116/shireesha-parampalli"}, "edited": false, "score": 0, "creation_date": 1559661243, "post_id": 56445437, "comment_id": 99486933, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/42376213/rails-before-update-callback-with-nested-attributes\">Rails before_update callback with nested attributes</a>"}], "owner": {"reputation": 1012, "user_id": 10347572, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iottG.jpg?s=128&g=1", "display_name": "escanxr", "link": "https://stackoverflow.com/users/10347572/escanxr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 81, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1559662998, "creation_date": 1559656569, "last_edit_date": 1559662998, "question_id": 56445437, "link": "https://stackoverflow.com/questions/56445437/reject-if-errors-added", "title": "Reject_if + errors added", "body": "<p>I have a model <code>Order</code> that could has many <code>texts</code>.</p>\n\n<p>A text can have an activestorage attachment, and I validate this attachment with <code>active_storage_validations</code> gem.</p>\n\n<p>I want to save valid texts and reject invalid texts, so I'm using <code>reject_if</code> option on the <code>accepts_nested_attributes_for</code>... but I want to keep errors then render the form if a text has been rejected.</p>\n\n<p>This is my code:</p>\n\n<pre><code>class Order &lt; ApplicationRecord\n  has_many :texts, dependent: :destroy, validate: false\n  accepts_nested_attributes_for :texts, allow_destroy: true, reject_if: :invalid_text?\n\n  def invalid_text?(attributes)\n    text = Text.new(attributes.tap { |att| att.delete(:_destroy) })\n    return if text.valid?\n\n    text.errors.full_messages.each do |msg|\n      errors.add(:base, msg)\n    end\n  end\nend\n</code></pre>\n\n<p>Then in my controller:</p>\n\n<pre><code>def update\n  if @order.update(order_params)\n    @order.update!(creation_step: 'instructions')\n    check_if_documents(@order, params[:file_upload_method])\n\n    Text.counter_culture_fix_counts\n    jump_to(:instructions)\n  else\n    flash.now.alert = @order.errors.full_messages.join('. ') if @order.errors.messages.any?\n    render(:show)\n  end\nend\n</code></pre>\n\n<p>The problem is that <code>reject_if</code> is called after <code>@order.update</code> so there's never errors.</p>\n\n<p>How can I validate the nested attributes before the parent update, while having access to activestorage attributes?</p>\n\n<p>If i'm doing a <code>before_validation</code> callback, ActiveStorage attributes are not accessible with <code>nested_attributes_options</code> method...</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "rollbar"], "answers": [{"comments": [{"owner": {"reputation": 1285, "user_id": 10443890, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de817ef35c4a2bdd0501efbdc6d9a338?s=128&d=identicon&r=PG&f=1", "display_name": "mr_muscle", "link": "https://stackoverflow.com/users/10443890/mr-muscle"}, "edited": false, "score": 0, "creation_date": 1559654604, "post_id": 56444536, "comment_id": 99483152, "body": "Hm looking good but I think instead of <code>StandardError</code> it should be <code>ActiveModel::ValidationError</code> (because I want to rescue from validation) and something more to skip AASM error (don&#39;t know what exactly, error that it was not possible to move to the new state - can&#39;t find how to do so)."}, {"owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "reply_to_user": {"reputation": 1285, "user_id": 10443890, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de817ef35c4a2bdd0501efbdc6d9a338?s=128&d=identicon&r=PG&f=1", "display_name": "mr_muscle", "link": "https://stackoverflow.com/users/10443890/mr-muscle"}, "edited": false, "score": 1, "creation_date": 1559655402, "post_id": 56444536, "comment_id": 99483638, "body": "@mr_muscle I updated my answer with more the precise error types."}], "tags": [], "owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "is_accepted": true, "score": 2, "last_activity_date": 1559655381, "last_edit_date": 1559655381, "creation_date": 1559653554, "answer_id": 56444536, "question_id": 56443861, "link": "https://stackoverflow.com/questions/56443861/rails-rescue-specific-error-and-send-to-rollbar/56444536#56444536", "title": "Rails rescue specific error and send to rollbar", "body": "<p>I am not sure if Ruby is understanding this kind of block structure. I would rewrite it as:</p>\n\n<pre><code>def call\n  all_to_expire.each do |offer|\n    begin\n      offer.expire!(actor: self)\n    rescue AASM::InvalidTransition, ActiveModel::ValidationError =&gt; e\n      Rollbar.error(e)\n    end\n  end\nend\n</code></pre>\n"}], "owner": {"reputation": 1285, "user_id": 10443890, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de817ef35c4a2bdd0501efbdc6d9a338?s=128&d=identicon&r=PG&f=1", "display_name": "mr_muscle", "link": "https://stackoverflow.com/users/10443890/mr-muscle"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 92, "favorite_count": 0, "accepted_answer_id": 56444536, "answer_count": 1, "score": 0, "last_activity_date": 1559655381, "creation_date": 1559651128, "question_id": 56443861, "link": "https://stackoverflow.com/questions/56443861/rails-rescue-specific-error-and-send-to-rollbar", "title": "Rails rescue specific error and send to rollbar", "body": "<p>In my call method I want to expire all offers but, to do so, I have catch two specific errors (validations and possible AASM) and rescue from them. Both of them should be sended to Rollbar.</p>\n\n<pre><code>def call\n  all_to_expire.each do |offer|\n    offer.expire!(actor: self)\n  rescue StandardError =&gt; e\n    Rollbar.error(e)\n  end\nend\n</code></pre>\n\n<p>Method above doesn't seem to work</p>\n"}, {"tags": ["ruby", "hyperlink", "conditional-statements", "haml", "conditional-operator"], "comments": [{"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 1, "creation_date": 1560643907, "post_id": 56443631, "comment_id": 99804519, "body": "I&#39;d recommend not using <code>?:</code>-based logic and syntax. Instead, keep the code clean and simple and a little more verbose and use regular <code>if&#47;then&#47;else</code> in the Haml. In general we disapprove of using <code>?:</code> syntax in Ruby because it&#39;s not as clear what&#39;s happening; The logic of something easily gets lost making it easy for errors and bugs to creep in."}], "answers": [{"tags": [], "owner": {"reputation": 2198, "user_id": 3842598, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/468955b0edcf30e61a2937cb8b754a1a?s=128&d=identicon&r=PG&f=1", "display_name": "Christian", "link": "https://stackoverflow.com/users/3842598/christian"}, "is_accepted": false, "score": 0, "last_activity_date": 1566511076, "creation_date": 1566511076, "answer_id": 57617502, "question_id": 56443631, "link": "https://stackoverflow.com/questions/56443631/how-to-use-nested-ternary-operator-in-link-to-in-rails-view/57617502#57617502", "title": "How to use nested ternary operator in link_to in rails view?", "body": "<p>My solution would be something similar to</p>\n\n<pre><code>= link_to task_count\n</code></pre>\n\n<p>Where task_count is a (helper) method which contains the logic.</p>\n\n<p>Options below:</p>\n\n<p>1) Syntax for normal if, elsif, else statements:</p>\n\n<pre><code>if cond1\n  stmt1\nelsif cond2\n  stmt2\nelseif cond3\n  stmt3\nelse\n  stmt4\nend\n</code></pre>\n\n<p>Syntax for case when statement (my prefered and in my opinion most readable way):</p>\n\n<pre><code>case not_done_task.count\nwhen 0\n  'No Task'\nwhen 1\n  '1 Task'\nwhen &gt; 1\n  \"#{Not_done_task.count} Tasks\"\nend\n</code></pre>\n\n<p>Syntax for nested ternary operators (for completeness):</p>\n\n<pre><code>cond1 ? stmt1 : (cond2 ? stmt2 : (cond3 ? stmt3 : stmt4)))\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 37, "user_id": 5772471, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4fd87fec1a52ba566e5a7ad050415757?s=128&d=identicon&r=PG&f=1", "display_name": "Queenie Peng", "link": "https://stackoverflow.com/users/5772471/queenie-peng"}, "is_accepted": false, "score": 1, "last_activity_date": 1592424802, "creation_date": 1592424802, "answer_id": 62437608, "question_id": 56443631, "link": "https://stackoverflow.com/questions/56443631/how-to-use-nested-ternary-operator-in-link-to-in-rails-view/62437608#62437608", "title": "How to use nested ternary operator in link_to in rails view?", "body": "<p>Here's the solution. However it will make the code hard to read. Ternary operator is better with only two options.</p>\n\n<pre><code>&lt;%= link_to (not_done_task.size == 0 ? \"No task\" : (not_done_task.size == 1 ? \"1 task\" : not_done_task.size + \"tasks to do\")) %&gt;\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 11476323, "user_type": "registered", "profile_image": "https://graph.facebook.com/2280911428891182/picture?type=large", "display_name": "Martin Bourdeau", "link": "https://stackoverflow.com/users/11476323/martin-bourdeau"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 352, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1592424802, "creation_date": 1559650266, "last_edit_date": 1581308607, "question_id": 56443631, "link": "https://stackoverflow.com/questions/56443631/how-to-use-nested-ternary-operator-in-link-to-in-rails-view", "title": "How to use nested ternary operator in link_to in rails view?", "body": "<p>I have a Haml line I want to edit to add a condition that if there is only on <code>not_done_task</code> as follows:</p>\n\n<p>From this (this line is correct):</p>\n\n<pre><code>= link_to \"#{not_done_task.count == 0 ? \"No\" : not_done_task.count} Tasks To Do\"\n</code></pre>\n\n<p>To this (this line is not correctly written):</p>\n\n<pre><code>= link_to \"#{not_done_task.count == 0 ? \"No task\", not_done_task.count == 1 ? \"1 Task\", not_done_task.count &gt; 1 ? \"not_done_task.count Tasks\"} to do\"\n</code></pre>\n\n<p>I expect that the <code>link_to</code> section recognize three different cases:</p>\n\n<pre><code>(if count == 0, if count == 1 ans if count &gt; 1)\n</code></pre>\n\n<p>but my synthax is not correct.</p>\n"}, {"tags": ["ruby", "ruby-on-rails-5", "railstutorial.org"], "comments": [{"owner": {"reputation": 5312, "user_id": 6535997, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/10156345016155058/picture?type=large", "display_name": "Mark", "link": "https://stackoverflow.com/users/6535997/mark"}, "edited": false, "score": 1, "creation_date": 1559650148, "post_id": 56443517, "comment_id": 99480609, "body": "Have a look at the HTML that is coming out of your app. Search for a link to a /login path (there won&#39;t be one there), then figure out why it&#39;s not there"}, {"owner": {"reputation": 5312, "user_id": 6535997, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/10156345016155058/picture?type=large", "display_name": "Mark", "link": "https://stackoverflow.com/users/6535997/mark"}, "edited": false, "score": 0, "creation_date": 1559650158, "post_id": 56443517, "comment_id": 99480614, "body": "Most likely a typo when making the link I&#39;d imagine"}, {"owner": {"reputation": 71, "user_id": 1753441, "user_type": "registered", "accept_rate": 20, "profile_image": "https://lh6.googleusercontent.com/-rsLyCE2fMM4/AAAAAAAAAAI/AAAAAAAAACI/sNJ9SIOvtXw/photo.jpg?sz=128", "display_name": "Ben", "link": "https://stackoverflow.com/users/1753441/ben"}, "reply_to_user": {"reputation": 5312, "user_id": 6535997, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/10156345016155058/picture?type=large", "display_name": "Mark", "link": "https://stackoverflow.com/users/6535997/mark"}, "edited": false, "score": 0, "creation_date": 1559650325, "post_id": 56443517, "comment_id": 99480716, "body": "Sounds like an idea, let me get to it. Thanks."}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1559650404, "post_id": 56443517, "comment_id": 99480753, "body": "...Or maybe the link is an absolute URL, not a relative URL. Or maybe there&#39;s a link to <code>&#47;signup</code> (or similar) rather than <code>&#47;login</code>. Or maybe the logout functionality doesn&#39;t actually work. Or maybe you&#39;ve landed on a different page, with neither a login nor a logout link. Either way, to debug the problem, take a look at the HTML of the page."}, {"owner": {"reputation": 71, "user_id": 1753441, "user_type": "registered", "accept_rate": 20, "profile_image": "https://lh6.googleusercontent.com/-rsLyCE2fMM4/AAAAAAAAAAI/AAAAAAAAACI/sNJ9SIOvtXw/photo.jpg?sz=128", "display_name": "Ben", "link": "https://stackoverflow.com/users/1753441/ben"}, "reply_to_user": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1559650655, "post_id": 56443517, "comment_id": 99480889, "body": "Thanks @TomLord and Mark . So like you suggested Mark I looked at the HTML in the header.html.erb to confirm that indeed that there is a login_path.  Sure enough the link had a stub and was not redirecting to login_path."}, {"owner": {"reputation": 71, "user_id": 1753441, "user_type": "registered", "accept_rate": 20, "profile_image": "https://lh6.googleusercontent.com/-rsLyCE2fMM4/AAAAAAAAAAI/AAAAAAAAACI/sNJ9SIOvtXw/photo.jpg?sz=128", "display_name": "Ben", "link": "https://stackoverflow.com/users/1753441/ben"}, "edited": false, "score": 1, "creation_date": 1559650788, "post_id": 56443517, "comment_id": 99480974, "body": "But I now need to check the tutorial and confirm whether I missed a step, or Mhartl did the assertion before filling in the Login Path. Thanks again you both have helped me learn something valuable about debugging, In addition to checking whether I have written the test correctly, I should look also look at the code of what is being tested whether model or view. Thanks again."}], "owner": {"reputation": 71, "user_id": 1753441, "user_type": "registered", "accept_rate": 20, "profile_image": "https://lh6.googleusercontent.com/-rsLyCE2fMM4/AAAAAAAAAAI/AAAAAAAAACI/sNJ9SIOvtXw/photo.jpg?sz=128", "display_name": "Ben", "link": "https://stackoverflow.com/users/1753441/ben"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 45, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1559649820, "creation_date": 1559649820, "question_id": 56443517, "link": "https://stackoverflow.com/questions/56443517/why-is-an-integration-test-failing-with-test-error-failing-to-assert-login-pat", "title": "Why is an integration test failing with &quot;Test Error failing to assert \u201clogin_path\u201d", "body": "<p>I am following MHartl tutorial and I have an integration test that fails yet the two other assertions based on the same page are passing. </p>\n\n<p>The code I have is </p>\n\n<pre><code> test \"login with valid information followed by logout\" do\n    get login_path\n    post login_path, params: { session: { email:    @user.email,\n                                          password: 'password' } }\n    assert is_logged_in?\n    assert_redirected_to @user\n    follow_redirect!\n    assert_template 'users/show'\n    assert_select \"a[href=?]\", login_path, count: 0\n    assert_select \"a[href=?]\", logout_path\n    assert_select \"a[href=?]\", user_path(@user)\n    delete logout_path\n    assert_not is_logged_in?\n    assert_redirected_to root_url\n    follow_redirect!\n    assert_select \"a[href=?]\", login_path\n    assert_select \"a[href=?]\", logout_path,      count: 0\n    assert_select \"a[href=?]\", user_path(@user), count: 0\n  end\n</code></pre>\n\n<p>The one assertion not working is </p>\n\n<p><code>assert_select \"a[href=?]\", login_path</code></p>\n\n<p>which raises the error </p>\n\n<p><code>Expected at least 1 element matching \"a[href=\"/login\"]\", found 0</code></p>\n\n<p>However, the last two assertions are passing as expected.</p>\n\n<pre><code>assert_select \"a[href=?]\", logout_path,      count: 0\nassert_select \"a[href=?]\", user_path(@user), count: 0\n</code></pre>\n\n<p>So if all three assertions test whether the logout redirects to the  homepage, why are the two passing while the test for <em>login_path</em> is failing? </p>\n"}, {"tags": ["ruby-on-rails", "ruby", "cron", "whenever", "rails-activejob"], "answers": [{"tags": [], "owner": {"reputation": 16587, "user_id": 177053, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3f6c516626d381a1ea383cedd1799486?s=128&d=identicon&r=PG", "display_name": "Vasfed", "link": "https://stackoverflow.com/users/177053/vasfed"}, "is_accepted": true, "score": 1, "last_activity_date": 1559656340, "creation_date": 1559656340, "answer_id": 56445378, "question_id": 56443311, "link": "https://stackoverflow.com/questions/56443311/calling-active-job-using-whenever-gem/56445378#56445378", "title": "Calling Active Job Using Whenever Gem", "body": "<p>First make sure cron runner is working at all - in cron environment is different, because there's no shell session. For example - if you're using RVM - you need ruby binstubs and may be full path to <code>bundle</code> command.\nThen try manually running cron command that was generated (see <code>crontab -l</code> for user that you're running whenever under)</p>\n\n<p>Also spinning up rails every minute just to enqueue a job - is not very optimal, you can use <code>sidekiq-scheduler</code> (if you're using sidekiq) or other ruby scheduler to do so</p>\n"}], "owner": {"reputation": 3465, "user_id": 5946118, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/CbjEl.jpg?s=128&g=1", "display_name": "Rajkaran Mishra", "link": "https://stackoverflow.com/users/5946118/rajkaran-mishra"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 204, "favorite_count": 0, "accepted_answer_id": 56445378, "answer_count": 1, "score": 0, "last_activity_date": 1559656412, "creation_date": 1559648993, "last_edit_date": 1559656412, "question_id": 56443311, "link": "https://stackoverflow.com/questions/56443311/calling-active-job-using-whenever-gem", "title": "Calling Active Job Using Whenever Gem", "body": "<p>Here is an active job:</p>\n\n<pre><code># app/jobs/upload_evidence_job.rb\n\nclass UploadEvidenceJob &lt; ApplicationJob\n  queue_as :default\n\n  def perform(*args)\n    UploadRequest.pull_messages\n    ...\n  end\nend\n</code></pre>\n\n<p>Here is my whenever config file:</p>\n\n<pre><code>set :output, \"log/cron_log.log\"\nenv :PATH, ENV['PATH']\n\nevery 1.minutes do\n  runner 'UploadEvidenceJob.perform_later'\nend\n</code></pre>\n\n<p>I am running the following command to write in cron which is working fine.</p>\n\n<p><code>$ whenever --update-crontab --set environment=development</code></p>\n\n<p>The issue is the job is not getting called from the cron, whereas it is working from the rails console.</p>\n\n<p>I think the active jobs are not getting loaded in case of cron, do I need to <code>require</code> it somewhere?</p>\n"}, {"tags": ["ruby", "aws-sdk", "aws-sdk-ruby"], "answers": [{"comments": [{"owner": {"reputation": 40, "user_id": 5777725, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh3.googleusercontent.com/-kSjPahzC7qE/AAAAAAAAAAI/AAAAAAAAAqg/FjjZx7SGHgs/photo.jpg?sz=128", "display_name": "Prashant Shete", "link": "https://stackoverflow.com/users/5777725/prashant-shete"}, "edited": false, "score": 0, "creation_date": 1560234344, "post_id": 56446505, "comment_id": 99657338, "body": "I realized it later, Thanks!"}], "tags": [], "owner": {"reputation": 1306, "user_id": 8008340, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/15JhO.jpg?s=128&g=1", "display_name": "Konstantin Strukov", "link": "https://stackoverflow.com/users/8008340/konstantin-strukov"}, "is_accepted": true, "score": 0, "last_activity_date": 1559660460, "creation_date": 1559660460, "answer_id": 56446505, "question_id": 56442856, "link": "https://stackoverflow.com/questions/56442856/aws-sdk-ruby-v3-not-giving-the-iam-policy-in-proper-json-format/56446505#56446505", "title": "aws-sdk-ruby v3 not giving the iam policy in proper json format", "body": "<p>It's always useful to read the API documentation, especially when it doesn't fail but returns something unexpected. Did you see this?</p>\n\n<blockquote>\n  <p>...Policies returned by this API are URL-encoded compliant with RFC 3986. You can use a URL decoding method to convert the policy back to plain JSON text... (<a href=\"https://docs.aws.amazon.com/sdkforruby/api/Aws/IAM/Client.html#get_role_policy-instance_method\" rel=\"nofollow noreferrer\">source</a>)</p>\n</blockquote>\n\n<p><code>URI.decode</code> on your result gives the proper JSON you're looking for...</p>\n"}], "owner": {"reputation": 40, "user_id": 5777725, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh3.googleusercontent.com/-kSjPahzC7qE/AAAAAAAAAAI/AAAAAAAAAqg/FjjZx7SGHgs/photo.jpg?sz=128", "display_name": "Prashant Shete", "link": "https://stackoverflow.com/users/5777725/prashant-shete"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 101, "favorite_count": 0, "accepted_answer_id": 56446505, "answer_count": 1, "score": 0, "last_activity_date": 1559660460, "creation_date": 1559647252, "question_id": 56442856, "link": "https://stackoverflow.com/questions/56442856/aws-sdk-ruby-v3-not-giving-the-iam-policy-in-proper-json-format", "title": "aws-sdk-ruby v3 not giving the iam policy in proper json format", "body": "<p>I want to retrieve the policy document associated with the iam role and policy using aws-sdk and ruby. Using aws cli, I am getting the proper output but using aws sdk and ruby getting encrypted json output.</p>\n\n<p>aws iam get-role-policy --role-name=ddp-lambda-s3-ec2 --policy-name=ddp-assumerole-solutionsdev-talos</p>\n\n<pre><code>require 'aws-sdk'\nrole_name = \"ddp-lambda-s3-ec2\"\niamclient = Aws::IAM::Client.new()\n\n\nresp = iamclient.get_role_policy({\n  role_name: role_name, # required\n  policy_name: \"ddp-assumerole-solutionsdev-talos\", # required\n})\n\nputs resp.policy_document\n</code></pre>\n\n<p>Using aws cli getting proper output:</p>\n\n<pre><code>$ aws iam get-role-policy --role-name=ddp-lambda-s3-ec2 --policy-name=ddp-assumerole-solutionsdev-talos\n{\n    \"RoleName\": \"ddp-lambda-s3-ec2\",\n    \"PolicyDocument\": {\n        \"Version\": \"2012-10-17\",\n        \"Statement\": {\n            \"Action\": \"sts:AssumeRole\",\n            \"Resource\": \"arn:aws:iam::443233333122:role/ddp_talos_role\",\n            \"Effect\": \"Allow\"\n        }\n    },\n    \"PolicyName\": \"ddp-assumerole-solutionsdev-talos\"\n}\n</code></pre>\n\n<p>But when I run above code I get following output:</p>\n\n<pre><code>$ ruby iam.rb\n%7B%0D%0A%20%20%20%20%22Version%22%3A%20%222012-10-17%22%2C%0D%0A%20%20%20%20%22Statement%22%3A%20%7B%0D%0A%20%20%20%20%20%20%20%20%22Effect%22%3A%20%22Allow%22%2C%0D%0A%20%20%20%20%20%20%20%20%22Action%22%3A%20%22sts%3AAssumeRole%22%2C%0D%0A%20%20%20%20%20%20%20%20%22Resource%22%3A%20%22arn%3Aaws%3Aiam%3A%3A443299236587%3Arole%2Fddp_talos_role%22%0D%0A%20%20%20%20%7D%0D%0A%7D%0D%0A\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "devise", "ruby-on-rails-5"], "comments": [{"owner": {"reputation": 6039, "user_id": 2137458, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8cfca832ee746f3e3d9971148f52dc64?s=128&d=identicon&r=PG", "display_name": "NM Pennypacker", "link": "https://stackoverflow.com/users/2137458/nm-pennypacker"}, "edited": false, "score": 0, "creation_date": 1559649027, "post_id": 56442709, "comment_id": 99479959, "body": "So you&#39;re redirecting to the root path after the user is updated? Did you make sure to put your root routes at the bottom of your routes file? Can you post the relevant routes as well as any controller overrides that you may have created?"}], "answers": [{"tags": [], "owner": {"reputation": 1012, "user_id": 10347572, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iottG.jpg?s=128&g=1", "display_name": "escanxr", "link": "https://stackoverflow.com/users/10347572/escanxr"}, "is_accepted": false, "score": 0, "last_activity_date": 1559651563, "last_edit_date": 1559651563, "creation_date": 1559651246, "answer_id": 56443889, "question_id": 56442709, "link": "https://stackoverflow.com/questions/56442709/several-redirects-after-user-update-with-devise/56443889#56443889", "title": "Several redirects after user update with devise", "body": "<p>It seems like your <code>root_path</code> is <code>/users/sign_in</code>, and when the user updates his account, you redirect him to the root... but the user is already signed in so he can't access to the <code>new_user_session_pah</code>. The fallback default location configured in Devise is the user's profile, so he's redirected to this route.</p>\n\n<p>Have you configured an authenticated root?\n<a href=\"https://github.com/plataformatec/devise/wiki/How-To:-Define-a-different-root-route-for-logged-in-out-users\" rel=\"nofollow noreferrer\">https://github.com/plataformatec/devise/wiki/How-To:-Define-a-different-root-route-for-logged-in-out-users</a></p>\n\n<p>It should fix your problem (:</p>\n"}, {"tags": [], "owner": {"reputation": 29, "user_id": 10066312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1ea7a02cf2c43157df9836d5d5fe6124?s=128&d=identicon&r=PG&f=1", "display_name": "treefoc", "link": "https://stackoverflow.com/users/10066312/treefoc"}, "is_accepted": true, "score": 0, "last_activity_date": 1559740238, "last_edit_date": 1559740238, "creation_date": 1559739456, "answer_id": 56460983, "question_id": 56442709, "link": "https://stackoverflow.com/questions/56442709/several-redirects-after-user-update-with-devise/56460983#56460983", "title": "Several redirects after user update with devise", "body": "<p>I managed to solve it by adding a method to <code>RegistrationController</code> as follows:</p>\n\n<pre><code>def after_update_path_for(resource)\n  user_path(current_user)\nend\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 29, "user_id": 10066312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1ea7a02cf2c43157df9836d5d5fe6124?s=128&d=identicon&r=PG&f=1", "display_name": "treefoc", "link": "https://stackoverflow.com/users/10066312/treefoc"}, "edited": false, "score": 0, "creation_date": 1559838489, "post_id": 56472695, "comment_id": 99553637, "body": "Thank you, I just found out about the method after_update_path_for yesterday"}], "tags": [], "owner": {"reputation": 1175, "user_id": 2861567, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GRa02.jpg?s=128&g=1", "display_name": "quyetdc", "link": "https://stackoverflow.com/users/2861567/quyetdc"}, "is_accepted": false, "score": 0, "last_activity_date": 1559805828, "creation_date": 1559805828, "answer_id": 56472695, "question_id": 56442709, "link": "https://stackoverflow.com/questions/56442709/several-redirects-after-user-update-with-devise/56472695#56472695", "title": "Several redirects after user update with devise", "body": "<p>That is, after updating user, Rails goes to root_path, that is <code>sessions#new</code>. But user's already logged in, so rails router redirects you to <code>users#show</code></p>\n\n<p>Why don't you set <code>root \"home#index\"</code> (or sth like that) </p>\n\n<pre><code>Rails.application.routes.draw do\n  devise_for :users\n\n  authenticated :user do\n    root 'secret#index', as: :authenticated_root\n  end\n\n  root \"home#index\"\nend\n</code></pre>\n\n<p>and then, in your <code>application_controller.rb</code> you can just require users to login before using your page</p>\n\n<pre><code>class ApplicationController &lt; ActionController::Base\n  protect_from_forgery with: :exception\n  before_action :authenticate_user!\nend\n</code></pre>\n\n<p>If you want to redirect user to <code>users#show</code> after update, you can override the <code>after_update_path_for</code></p>\n\n<pre><code>class User::RegistrationsController &lt; Devise::RegistrationsController\n\n  protected\n\n  def after_update_path_for(resource)\n    user_path(resource)\n  end\nend\n</code></pre>\n"}], "owner": {"reputation": 29, "user_id": 10066312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1ea7a02cf2c43157df9836d5d5fe6124?s=128&d=identicon&r=PG&f=1", "display_name": "treefoc", "link": "https://stackoverflow.com/users/10066312/treefoc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 156, "favorite_count": 0, "accepted_answer_id": 56460983, "answer_count": 3, "score": 0, "last_activity_date": 1559805828, "creation_date": 1559646663, "last_edit_date": 1559657499, "question_id": 56442709, "link": "https://stackoverflow.com/questions/56442709/several-redirects-after-user-update-with-devise", "title": "Several redirects after user update with devise", "body": "<p>I'm trying to create a rails 5 applications with devise that's supposed to act like a social network, so every user has a profile. \nAfter updating the user instead of going back to the profile, the server redirects to localhost, then there is a message <code>Filter chain halted as :require_no_authentication rendered or redirected</code> and only then the user profile is loaded.\nAlso on the profile a message is shown \"You are already signed in\".\nMy goal is to erase those redirects.</p>\n\n<ol>\n<li>I tried to change the redirect in a custom <code>RegistrationController</code> but then it said there are too many redirects so I could't just replace it.</li>\n<li>I tried to have different roots for authenticated and unauthenticated users in <code>routes.rb</code> but it didn't change the behaviour</li>\n<li>I tried to get behind the <code>:require no authentication</code> but I'm actually not quite sure I understood it correctly and also it didn't change anything.</li>\n<li>The <code>after_sign_in_path_for</code> is set to the user profile</li>\n</ol>\n\n<p>This is the server output:</p>\n\n<pre><code>Started PUT \"/users\" for 127.0.0.1 at 2019-06-04 12:13:37 +0200\nProcessing by Users::RegistrationsController#update as HTML\n  Parameters: {\"email\"=&gt;\"asdf@asdf.de\", \"password\"=&gt;\"[FILTERED]\", \"password_confirmat\nion\"=&gt;\"[FILTERED]\", \"current_password\"=&gt;\"[FILTERED]\"}, \"commit\"=&gt;\"Update\"}\nUser Load (0.8ms)  SELECT  `users`.* FROM `users` WHERE `users`.`id` = 1 ORDER BY `users`.`id` ASC LIMIT 1\nUser Load (0.6ms)  SELECT  `users`.* FROM `users` WHERE `users`.`id` = 1 LIMIT\n 1\n   (0.3ms)  BEGIN\n   (0.4ms)  COMMIT\nRedirected to http://localhost:3000/\nCompleted 302 Found in 295ms (ActiveRecord: 2.1ms)\n\n\nStarted GET \"/\" for 127.0.0.1 at 2019-06-04 12:13:37 +0200\nProcessing by Users::SessionsController#new as HTML\n  User Load (0.7ms)  SELECT  `users`.* FROM `users` WHERE `users`.`id` = 1 ORDER\n BY `users`.`id` ASC LIMIT 1\nRedirected to http://localhost:3000/users/1\nFilter chain halted as :require_no_authentication rendered or redirected\nCompleted 302 Found in 15ms (ActiveRecord: 0.7ms)\n\n\nStarted GET \"/users/1\" for 127.0.0.1 at 2019-06-04 12:13:37 +0200\nProcessing by UsersController#show as HTML\n  Parameters: {\"id\"=&gt;\"1\"}\n  User Load (0.6ms)  SELECT  `users`.* FROM `users` WHERE `users`.`id` = 1 ORDER\n BY `users`.`id` ASC LIMIT 1\n  User Load (0.5ms)  SELECT  `users`.* FROM `users` WHERE `users`.`id` = 1 LIMIT\n 1\n  Rendering users/show.html.erb within layouts/application\n  Rendered users/show.html.erb within layouts/application (1.1ms)\n  Rendered shared/_navbar.html.erb (0.7ms)\nCompleted 200 OK in 162ms (Views: 145.3ms | ActiveRecord: 1.1ms)\n</code></pre>\n\n<p>Also why does the user get signed in again after updating? Is it correct behaviour? \nI cannot seem to fathom where the redirect to localhost ist happening and intervene. Any help would be appreciated.</p>\n\n<p><strong>Edit 1</strong></p>\n\n<p>So, to clarify. I tried to use an <code>authenticated_root</code> but then I get the errormessage <code>Couldn't find User without an ID</code>.</p>\n\n<pre><code>devise_scope :user do\n\nauthenticated :user do\n    root to: 'users#show', as: :authenticated_root\n  end\n  root to: 'users/sessions#new'\nend\n</code></pre>\n\n<p>Also I can't manage to change the redirecting from to root to the user profile. So the <code>RegistrationController</code> is unchanged. I would like to say in the update method or somewhere else \"after updating go to user profile\".</p>\n"}, {"tags": ["ruby", "database", "ubuntu", "docker-compose", "cucumber"], "comments": [{"owner": {"reputation": 966, "user_id": 6384607, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/dc77165b05cef4d2d4f6ed65d6bf9b21?s=128&d=identicon&r=PG&f=1", "display_name": "t s", "link": "https://stackoverflow.com/users/6384607/t-s"}, "edited": false, "score": 1, "creation_date": 1559646559, "post_id": 56442605, "comment_id": 99478670, "body": "Are you using <code>database_cleaner</code> ?"}, {"owner": {"reputation": 25, "user_id": 5985153, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh6.googleusercontent.com/-ALBsS8tbSsg/AAAAAAAAAAI/AAAAAAAAF6k/stVNx16Jd-s/photo.jpg?sz=128", "display_name": "geoko93", "link": "https://stackoverflow.com/users/5985153/geoko93"}, "reply_to_user": {"reputation": 966, "user_id": 6384607, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/dc77165b05cef4d2d4f6ed65d6bf9b21?s=128&d=identicon&r=PG&f=1", "display_name": "t s", "link": "https://stackoverflow.com/users/6384607/t-s"}, "edited": false, "score": 0, "creation_date": 1559646914, "post_id": 56442605, "comment_id": 99478836, "body": "I have it installed but I don&#39;t use it when running the feature files"}, {"owner": {"reputation": 966, "user_id": 6384607, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/dc77165b05cef4d2d4f6ed65d6bf9b21?s=128&d=identicon&r=PG&f=1", "display_name": "t s", "link": "https://stackoverflow.com/users/6384607/t-s"}, "edited": false, "score": 0, "creation_date": 1559647601, "post_id": 56442605, "comment_id": 99479199, "body": "Can you share the configurations for database_cleaner ? how do you set it"}, {"owner": {"reputation": 25, "user_id": 5985153, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh6.googleusercontent.com/-ALBsS8tbSsg/AAAAAAAAAAI/AAAAAAAAF6k/stVNx16Jd-s/photo.jpg?sz=128", "display_name": "geoko93", "link": "https://stackoverflow.com/users/5985153/geoko93"}, "reply_to_user": {"reputation": 966, "user_id": 6384607, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/dc77165b05cef4d2d4f6ed65d6bf9b21?s=128&d=identicon&r=PG&f=1", "display_name": "t s", "link": "https://stackoverflow.com/users/6384607/t-s"}, "edited": false, "score": 0, "creation_date": 1559652952, "post_id": 56442605, "comment_id": 99482197, "body": "I&#39;m using it to configure rspec      <code>RSpec.configure do |config|     config.include Test::DatabaseHelpers, type: :db     config.before(type: :db) do         DatabaseCleaner.strategy = :transaction         DatabaseCleaner.start     end      config.append_after(type: :db) do         DatabaseCleaner.clean     end      config.around(type: :db) do |example|         DatabaseCleaner.cleaning do               Api::Current.configure do |current|               end               Api::Container.start(:current_context)               example.run               end         end     end</code>"}], "owner": {"reputation": 25, "user_id": 5985153, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh6.googleusercontent.com/-ALBsS8tbSsg/AAAAAAAAAAI/AAAAAAAAF6k/stVNx16Jd-s/photo.jpg?sz=128", "display_name": "geoko93", "link": "https://stackoverflow.com/users/5985153/geoko93"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 42, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1559646286, "creation_date": 1559646286, "question_id": 56442605, "link": "https://stackoverflow.com/questions/56442605/running-a-cucumber-test-in-a-docker-machine-breaks-my-test-database", "title": "Running a cucumber test in a docker machine breaks my test database", "body": "<p>When I run a cucumber test in a docker machine via</p>\n\n<pre><code>docker-compose run api bundle exec cucumber features/v1/test.feature\n</code></pre>\n\n<p>The test succeeds but when I run the rspec tests after that there is no more data in the test database and I have to populate it again.</p>\n\n<p>I've tried this several times to check and this happens every time I run a cucumber test. I am working in Ubuntu and I have a postgresql database.</p>\n\n<p>Does running a cucumber test makes a 'reset' of the docker environment in any way?</p>\n"}, {"tags": ["ruby", "cucumber", "rubymine", "parallel-testing"], "comments": [{"owner": {"reputation": 1311, "user_id": 4676887, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QI0oc.jpg?s=128&g=1", "display_name": "Olivia", "link": "https://stackoverflow.com/users/4676887/olivia"}, "edited": false, "score": 0, "creation_date": 1559763254, "post_id": 56441888, "comment_id": 99525229, "body": "Have you tried creating a Gem command Run configuration? <a href=\"https://www.jetbrains.com/help/ruby/run-debug-configuration-gem-command.html\" rel=\"nofollow noreferrer\">jetbrains.com/help/ruby/&hellip;</a>"}, {"owner": {"reputation": 113, "user_id": 5515405, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/501fc6caa97c9da7749f0fd68d4784b2?s=128&d=identicon&r=PG", "display_name": "Brayw", "link": "https://stackoverflow.com/users/5515405/brayw"}, "reply_to_user": {"reputation": 1311, "user_id": 4676887, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QI0oc.jpg?s=128&g=1", "display_name": "Olivia", "link": "https://stackoverflow.com/users/4676887/olivia"}, "edited": false, "score": 0, "creation_date": 1559813682, "post_id": 56441888, "comment_id": 99539882, "body": "@Olivia I&#39;m not sure I understand you, I don&#39;t want to create a gem so I&#39;m not sure how this would help me"}, {"owner": {"reputation": 1311, "user_id": 4676887, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QI0oc.jpg?s=128&g=1", "display_name": "Olivia", "link": "https://stackoverflow.com/users/4676887/olivia"}, "edited": false, "score": 0, "creation_date": 1559851170, "post_id": 56441888, "comment_id": 99558850, "body": "it&#39;s not about creating a gem but about creating a run configuration for executing a custom (parallel_tests for example) Ruby gem."}, {"owner": {"reputation": 113, "user_id": 5515405, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/501fc6caa97c9da7749f0fd68d4784b2?s=128&d=identicon&r=PG", "display_name": "Brayw", "link": "https://stackoverflow.com/users/5515405/brayw"}, "reply_to_user": {"reputation": 1311, "user_id": 4676887, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QI0oc.jpg?s=128&g=1", "display_name": "Olivia", "link": "https://stackoverflow.com/users/4676887/olivia"}, "edited": false, "score": 0, "creation_date": 1559893065, "post_id": 56441888, "comment_id": 99568846, "body": "Oh, I had misunderstood the purpose of that run config, I&#39;ll take another look. Thank you for your help"}, {"owner": {"reputation": 113, "user_id": 5515405, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/501fc6caa97c9da7749f0fd68d4784b2?s=128&d=identicon&r=PG", "display_name": "Brayw", "link": "https://stackoverflow.com/users/5515405/brayw"}, "reply_to_user": {"reputation": 1311, "user_id": 4676887, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QI0oc.jpg?s=128&g=1", "display_name": "Olivia", "link": "https://stackoverflow.com/users/4676887/olivia"}, "edited": false, "score": 0, "creation_date": 1559898552, "post_id": 56441888, "comment_id": 99571515, "body": "@Olivia Rubymine complains that I need to specify the gem executable, but I&#39;m not 100% sure on what the configuration is expecting (I&#39;ve put the gem name as parallel_tests, with an argument specifying the features directory and the bundle exec option selected, not sure if this is correct however)"}, {"owner": {"reputation": 1311, "user_id": 4676887, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QI0oc.jpg?s=128&g=1", "display_name": "Olivia", "link": "https://stackoverflow.com/users/4676887/olivia"}, "edited": false, "score": 0, "creation_date": 1560455019, "post_id": 56441888, "comment_id": 99753016, "body": "In case this gem has been added to the Gemfile RubyMine will propose to complete its name and executable in the corresponding fields."}], "owner": {"reputation": 113, "user_id": 5515405, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/501fc6caa97c9da7749f0fd68d4784b2?s=128&d=identicon&r=PG", "display_name": "Brayw", "link": "https://stackoverflow.com/users/5515405/brayw"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 245, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1559643450, "creation_date": 1559643450, "question_id": 56441888, "link": "https://stackoverflow.com/questions/56441888/how-to-run-cucumber-tests-in-parallel-using-rubymine", "title": "How to run cucumber tests in parallel using Rubymine", "body": "<p>I cannot work out how to run tests in parallel in Rubymine. I'm using the parallel_tests gem, which I can get to work from the terminal but cannot work out how to get it working using Rubymines interface. I want to do this so that I can use Rubymines tools to ease test running and debuging</p>\n\n<p>I've got a super simple example project, with the following step definition:</p>\n\n<pre><code>Then /^I run test (.*) for feature (.*)$/ do |test, feature|\n  delay = 1 + rand(5)\n  puts \"Running Feature #{feature} Test #{test}. Next output in #{delay} seconds\"\n  sleep delay\nend\n</code></pre>\n\n<p>This is called by two different features, each one identifies which feature is calling it and increments 'test' by 1. The purpose of this is simply to help me see that the code is being executed at the same time. When run from the terminal I get the following output, which is more or less as expected:</p>\n\n<pre><code>Feature: First feature\n\nFeature: Second feature\n\n  Scenario: First scenario          # features/feature_two.feature:3\n    Then I run test 1 for feature 2 # features/step_definitions/parallel_test_steps.rb:1\n      Running Feature 2 Test 1. Next output in 3 seconds\n  Scenario: First scenario          # features/feature_one.feature:3\n    Then I run test 1 for feature 1 # features/step_definitions/parallel_test_steps.rb:1\n      Running Feature 1 Test 1. Next output in 5 seconds\n    Then I run test 2 for feature 2 # features/step_definitions/parallel_test_steps.rb:1\n      Running Feature 2 Test 2. Next output in 3 seconds\n    Then I run test 2 for feature 1 # features/step_definitions/parallel_test_steps.rb:1\n      Running Feature 1 Test 2. Next output in 4 seconds\n\n...\n</code></pre>\n\n<p>However, I'm having trouble getting this to work in Rubymine. To get the aforementioned result the command used is <code>bundle exec parallel_cucumber features/</code>, I cannot work out how to set up a run configuration which performs this. I'm aware of the \"Run the script in context of the bundle (bundle exec)\" option, however this just prepends \"bundle exec\" before the regular run command, which does not behave as desired.</p>\n"}, {"tags": ["ruby", "algorithm", "intersection"], "comments": [{"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1559647991, "post_id": 56441863, "comment_id": 99479407, "body": "Not sure if I understand the problem and your example. What do you mean by <i>&quot;using the maximum number of elements&quot;</i>? Can you explain it in a different way?"}, {"owner": {"reputation": 1040, "user_id": 9758920, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5397a7b84da492865cb4443b7389b0f6?s=128&d=identicon&r=PG&f=1", "display_name": "claasic", "link": "https://stackoverflow.com/users/9758920/claasic"}, "edited": false, "score": 0, "creation_date": 1559648909, "post_id": 56441863, "comment_id": 99479893, "body": "To me it seems like elements are the inner arrays in this case. So he is looking for the intersection with the highest number of involved arrays. See the red one in this example: <a href=\"https://i.imgur.com/bxLBqf3.png\" rel=\"nofollow noreferrer\">i.imgur.com/bxLBqf3.png</a>"}], "answers": [{"tags": [], "owner": {"reputation": 9663, "user_id": 5239030, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/76JEw.png?s=128&g=1", "display_name": "iGian", "link": "https://stackoverflow.com/users/5239030/igian"}, "is_accepted": false, "score": 0, "last_activity_date": 1559655617, "last_edit_date": 1559655617, "creation_date": 1559650646, "answer_id": 56443737, "question_id": 56441863, "link": "https://stackoverflow.com/questions/56441863/find-a-non-empty-intersection-using-the-maximum-number-of-elements-in-a-bidimens/56443737#56443737", "title": "Find a non empty intersection using the maximum number of elements in a bidimensional array", "body": "<p>Brute force, using permutations:</p>\n\n<pre><code>keys.combination(2).map { |a, b| a &amp; b }.max_by(&amp;:size)\n#=&gt; [:parent_ref, :kind]\n</code></pre>\n\n<p>Finding the elements used, also brute force:</p>\n\n<pre><code>res = [:parent_ref, :kind]\nkeys.select { |e| e.sort &amp; res.sort == res.sort }\n#=&gt; [[:parent_ref, :kind], [:kind, :parent_ref, :reference], [:parent_ref, :kind, :status]]\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2670, "user_id": 3826387, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f0bc3e39607231181fa257d9b280247a?s=128&d=identicon&r=PG&f=1", "display_name": "RobertBaron", "link": "https://stackoverflow.com/users/3826387/robertbaron"}, "is_accepted": false, "score": 0, "last_activity_date": 1559653763, "creation_date": 1559653763, "answer_id": 56444599, "question_id": 56441863, "link": "https://stackoverflow.com/questions/56441863/find-a-non-empty-intersection-using-the-maximum-number-of-elements-in-a-bidimens/56444599#56444599", "title": "Find a non empty intersection using the maximum number of elements in a bidimensional array", "body": "<p>Suppose the bidimensional array is an array of strings where each string is an array of characters.\nSuppose we have the strings:</p>\n\n<pre><code>CDB\nBC\nCBA\nFDE\nEDBC\n</code></pre>\n\n<p>First sort every string in increasing order.</p>\n\n<pre><code>BCD\nBC\nABC\nDEF\nBCDE\n</code></pre>\n\n<p>Then sort the strings.</p>\n\n<pre><code>ABC\nBC\nBCD\nBCDE\nDEF\n</code></pre>\n\n<p>For each element, find the one that appears in the longest sequence of consecutive strings. In our example, it would be B and C. Their consecutive strings is the largest number of strings that have a non-empty intersection.</p>\n"}, {"comments": [{"owner": {"reputation": 2285, "user_id": 4620141, "user_type": "registered", "accept_rate": 52, "profile_image": "https://graph.facebook.com/10152601898256854/picture?type=large", "display_name": "David Geismar", "link": "https://stackoverflow.com/users/4620141/david-geismar"}, "edited": false, "score": 0, "creation_date": 1559728005, "post_id": 56445534, "comment_id": 99507912, "body": "I think you are missing some intersections here : say you have <code>b=&gt;[2,3,4]</code> and <code>c=&gt;[2,3,4,5]</code> this solution will miss <code>[2,3,4] =&gt; [:b, :c]</code>"}, {"owner": {"reputation": 48049, "user_id": 6419007, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/CwqtX.jpg?s=128&g=1", "display_name": "Eric Duminil", "link": "https://stackoverflow.com/users/6419007/eric-duminil"}, "reply_to_user": {"reputation": 2285, "user_id": 4620141, "user_type": "registered", "accept_rate": 52, "profile_image": "https://graph.facebook.com/10152601898256854/picture?type=large", "display_name": "David Geismar", "link": "https://stackoverflow.com/users/4620141/david-geismar"}, "edited": false, "score": 0, "creation_date": 1559748414, "post_id": 56445534, "comment_id": 99518647, "body": "@DavidGeismar: It seems you&#39;re right. It finds the intersection with the most subsets, not with the most elements."}], "tags": [], "owner": {"reputation": 48049, "user_id": 6419007, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/CwqtX.jpg?s=128&g=1", "display_name": "Eric Duminil", "link": "https://stackoverflow.com/users/6419007/eric-duminil"}, "is_accepted": false, "score": 0, "last_activity_date": 1559656910, "creation_date": 1559656910, "answer_id": 56445534, "question_id": 56441863, "link": "https://stackoverflow.com/questions/56441863/find-a-non-empty-intersection-using-the-maximum-number-of-elements-in-a-bidimens/56445534#56445534", "title": "Find a non empty intersection using the maximum number of elements in a bidimensional array", "body": "<p>I believe your question is linked to <a href=\"https://stackoverflow.com/q/26028124/6419007\">this one</a>, with this <a href=\"https://stackoverflow.com/a/26028865/6419007\">answer</a> being relevant.</p>\n\n<p>You can translate your input to shorter names for readability:</p>\n\n<pre><code>matrix = [[:a], [:b, :c], [:c, :b, :a], [:b, :c, :d]]\n</code></pre>\n\n<p>You can iterate over the values, and keep a Hash containing all the sets each value is in:</p>\n\n<pre><code>matrix.each.with_index(1) do |row, i|\n  row.each do |value|\n    grouped_values[value] &lt;&lt; i\n  end\nend\n\np grouped_values\n# =&gt; {:a=&gt;[1, 3], :b=&gt;[2, 3, 4], :c=&gt;[2, 3, 4], :d=&gt;[4]}\n</code></pre>\n\n<p>So <code>:a</code> is present in sets 1 and 3, <code>b</code> in sets 2, 3 and 4...</p>\n\n<p>You can then group the sets together:</p>\n\n<pre><code>grouped_sets = Hash.new{|h, k| h[k] = []}\n\ngrouped_values.each do |value, sets|\n  grouped_sets[sets] &lt;&lt; value if sets.size &gt; 1\nend\n\np grouped_sets\n# =&gt; {[1, 3]=&gt;[:a], [2, 3, 4]=&gt;[:b, :c]}\n</code></pre>\n\n<p>So the intersection of sets 1 and 3 is <code>[:a]</code>, and the intersection of sets 2, 3, and 4 is <code>[:b, :c]</code>.</p>\n\n<p>Finally, you can either pick the intersection with the most sets or with the most elements.</p>\n"}, {"tags": [], "owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "is_accepted": false, "score": 0, "last_activity_date": 1559673478, "last_edit_date": 1559673478, "creation_date": 1559670919, "answer_id": 56449080, "question_id": 56441863, "link": "https://stackoverflow.com/questions/56441863/find-a-non-empty-intersection-using-the-maximum-number-of-elements-in-a-bidimens/56449080#56449080", "title": "Find a non empty intersection using the maximum number of elements in a bidimensional array", "body": "<pre><code>arr = [\n  [:reference],\n  [:parent_ref, :kind],\n  [:kind, :parent_ref, :reference],\n  [:parent_ref, :kind],\n  [:parent_ref, :kind, :status],\n  [:kind, :parent_ref, :kind]\n]\n</code></pre>\n\n<p>Note that I've modified <code>keys</code> given in the example to include two types of duplicates.</p>\n\n<pre><code>require 'set'\n\nh = arr.each_with_object(Hash.new { |h,k| h[k] = [] }) { |a,h| h[a.to_set] &lt;&lt; a }\n  #=&gt; {#&lt;Set: {:reference}&gt;=&gt;[[:reference]],\n  #    #&lt;Set: {:parent_ref, :kind}&gt;=&gt;[[:parent_ref, :kind],\n  #             [:parent_ref, :kind], [:kind, :parent_ref, :kind]],\n  #    #&lt;Set: {:kind, :parent_ref, :reference}&gt;=&gt;[[:kind, :parent_ref, :reference]],\n  #    #&lt;Set: {:parent_ref, :kind, :status}&gt;=&gt;[[:parent_ref, :kind, :status]]} \ng = h.each_key.with_object({}) do |k,g|\n  g[k] = h[k].dup\n  h.each { |kk,v| g[k].concat(v) if k &lt; kk }\nend \n  #=&gt; {#&lt;Set: {:reference}&gt;=&gt;[[:reference], [:kind, :parent_ref, :reference]],\n  #    #&lt;Set: {:parent_ref, :kind}&gt;=&gt;[[:parent_ref, :kind], [:parent_ref, :kind],\n  #             [:kind, :parent_ref, :kind], [:kind, :parent_ref, :reference],\n  #             [:parent_ref, :kind, :status]],\n  #    #&lt;Set: {:kind, :parent_ref, :reference}&gt;=&gt;[[:kind, :parent_ref, :reference]],\n  #    #&lt;Set: {:parent_ref, :kind, :status}&gt;=&gt;[[:parent_ref, :kind, :status]]} \na = g.max_by { |k,v| v.size }\n  #=&gt; [#&lt;Set: {:parent_ref, :kind}&gt;, [[:parent_ref, :kind], [:parent_ref, :kind],\n  #     [:kind, :parent_ref, :kind], [:kind, :parent_ref, :reference],\n  #     [:parent_ref, :kind, :status]]] \n[a.last.first, a.last.drop(1)]\n  #=&gt; [[:parent_ref, :kind], [[:parent_ref, :kind], [:kind, :parent_ref, :kind],\n  #    [:kind, :parent_ref, :reference], [:parent_ref, :kind, :status]]]\n</code></pre>\n\n<p>This shows the array <code>[:parent_ref, :kind]</code>, when converted to a set, is a subset of the following other elements of <code>array</code> after being converted to sets:</p>\n\n<pre><code>[[:parent_ref, :kind], [:kind, :parent_ref, :kind],\n [:kind, :parent_ref, :reference], [:parent_ref, :kind, :status]]\n</code></pre>\n\n<p>and that no other element of <code>arr</code> (after all elements of <code>arr</code> are converted to sets) has a greater number of supersets.</p>\n\n<p>Note that, if desired, the calculations of <code>g</code> and <code>a</code> can be chained.</p>\n\n<p>See <a href=\"http://ruby-doc.org/stdlib-2.5.1/libdoc/set/rdoc/Set.html#method-i-3C\" rel=\"nofollow noreferrer\">Set#&lt;</a>.</p>\n\n<p>If neither <code>arr</code> nor any element of <code>arr</code> may contain duplicates, the calculations are of course simplified.</p>\n\n<pre><code>arr = [\n  [:reference],\n  [:parent_ref, :kind],\n  [:kind, :parent_ref, :reference],\n  [:parent_ref, :kind, :status]\n]\n</code></pre>\n\n<h1><p></p></h1>\n\n<pre><code>require 'set'\n\nsets = arr.map(&amp;:to_set)\n  #=&gt; [#&lt;Set: {:reference}&gt;, #&lt;Set: {:parent_ref, :kind}&gt;,\n  #    #&lt;Set: {:kind, :parent_ref, :reference}&gt;, #&lt;Set: {:parent_ref, :kind, :status}&gt;]\nh = sets.each_with_object(Hash.new { |h,k| h[k] = [] }) { |s,h|\n       sets.each { |ss| h[s] &lt;&lt; ss if s &lt; ss } }\n  #=&gt; {#&lt;Set: {:reference}&gt;=&gt;[#&lt;Set: {:kind, :parent_ref, :reference}&gt;],\n  #    #&lt;Set: {:parent_ref, :kind}&gt;=&gt;[#&lt;Set: {:kind, :parent_ref, :reference}&gt;,\n  #    #&lt;Set: {:parent_ref, :kind, :status}&gt;]}\nk, v = h.max_by { |_,v| v.size }\n  #=&gt; [#&lt;Set: {:parent_ref, :kind}&gt;,\n  #     [#&lt;Set: {:kind, :parent_ref, :reference}&gt;, #&lt;Set: {:parent_ref, :kind, :status}&gt;]]\n[k.to_a, v.map(&amp;:to_a)]\n  #=&gt; [[:parent_ref, :kind],\n  #    [[:kind, :parent_ref, :reference], [:parent_ref, :kind, :status]]] \n</code></pre>\n"}], "owner": {"reputation": 2285, "user_id": 4620141, "user_type": "registered", "accept_rate": 52, "profile_image": "https://graph.facebook.com/10152601898256854/picture?type=large", "display_name": "David Geismar", "link": "https://stackoverflow.com/users/4620141/david-geismar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 135, "favorite_count": 0, "answer_count": 4, "score": 3, "last_activity_date": 1559673478, "creation_date": 1559643344, "last_edit_date": 1559643910, "question_id": 56441863, "link": "https://stackoverflow.com/questions/56441863/find-a-non-empty-intersection-using-the-maximum-number-of-elements-in-a-bidimens", "title": "Find a non empty intersection using the maximum number of elements in a bidimensional array", "body": "<p>I have a bidimensional array :</p>\n\n<pre><code>   keys = [[:reference],\n     [:parent_ref, :kind],\n     [:kind, :parent_ref, :reference],\n     [:parent_ref, :kind, :status]]\n</code></pre>\n\n<p>Let's say I want the intersection of all those arrays. I can do :</p>\n\n<pre><code>keys.reduce{|arr, acc| arr &amp; acc}\n</code></pre>\n\n<p>which will result in [] because there is no universal common key.\nNow let's say I want to find a \"non empty intersection\" using the maximum number of elements in the array.\nFor instance the intersection using this \"method\" would be [:parent_ref, :kind] because it is the intersection of </p>\n\n<pre><code>[[:parent_ref, :kind],\n         [:kind, :parent_ref, :reference],\n         [:parent_ref, :kind, :status]]\n</code></pre>\n\n<p>We just have to put <code>[:reference]</code> aside.</p>\n\n<p>How would you approach/create such an algorithm.</p>\n"}, {"tags": ["html", "sql", "ruby"], "comments": [{"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1559643223, "post_id": 56441465, "comment_id": 99476938, "body": "<b>Never ever store currency as floats.</b>"}], "answers": [{"tags": [], "owner": {"reputation": 5312, "user_id": 6535997, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/10156345016155058/picture?type=large", "display_name": "Mark", "link": "https://stackoverflow.com/users/6535997/mark"}, "is_accepted": true, "score": 0, "last_activity_date": 1559643563, "creation_date": 1559643563, "answer_id": 56441916, "question_id": 56441465, "link": "https://stackoverflow.com/questions/56441465/how-to-return-a-ruby-float-with-2-decimal-places-when-displaying-currency/56441916#56441916", "title": "How to return a Ruby float with 2 decimal places when displaying currency", "body": "<p>Beyond the very valid comment of not storing currency as floats, you are where you are, so to display the number with 2 decimal places you need to use <a href=\"http://ruby-doc.org/core-2.0.0/Kernel.html#method-i-sprintf\" rel=\"nofollow noreferrer\">http://ruby-doc.org/core-2.0.0/Kernel.html#method-i-sprintf</a></p>\n\n<pre><code>[1] pry(main)&gt; sprintf('%.2f', 2)\n=&gt; \"2.00\"\n[2] pry(main)&gt; sprintf('%.2f', 2.569)\n=&gt; \"2.57\"\n[3] pry(main)&gt; sprintf('%.2f', 2.56)\n=&gt; \"2.56\"\n[4] pry(main)&gt; sprintf('%.2f', 2.56666666)\n=&gt; \"2.57\"\n</code></pre>\n\n<p>So in your code:</p>\n\n<pre><code>class Transaction\n\n  attr_accessor :amount, :merchant_id, :tag_id, :transaction_date\n  attr_reader :id\n\n  def initialize(options)\n    @id = options['id'].to_i if options['id']\n    @amount = sprintf('%.2f', options['amount'].to_f)\n    @merchant_id = options['merchant_id'].to_i if options['merchant_id']\n    @tag_id = options['tag_id'].to_i if options['tag_id']\n    @transaction_date = options['transaction_date'] if options['transaction_date']\n  end\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 11511199, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-U74uzBZUMO0/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3re_Pz42qTIa3l5loQ26N9thkN_9DQ/mo/photo.jpg?sz=128", "display_name": "Peter Sullivan", "link": "https://stackoverflow.com/users/11511199/peter-sullivan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 53, "favorite_count": 0, "accepted_answer_id": 56441916, "answer_count": 1, "score": 0, "last_activity_date": 1559643563, "creation_date": 1559641788, "last_edit_date": 1559641824, "question_id": 56441465, "link": "https://stackoverflow.com/questions/56441465/how-to-return-a-ruby-float-with-2-decimal-places-when-displaying-currency", "title": "How to return a Ruby float with 2 decimal places when displaying currency", "body": "<p>I have an SQL database storing prices passed in from floats in a Ruby Class that I then need to subsequently display in an HTML/erb file. My problem is that price that is 10.00 or 10.20 returns as 10.0 or 10.2, this then displays incorrectly in HTML. I need the prices to remain as floats in Ruby as they are being used for calculations... is there an obvious way to return these prices at 2 decimal places?</p>\n\n<p>I've attempted to store them differently in my SQL database and I believe I could try to convert the float to a string and split it on the decimal point then loop over the second element in that array and add another zero if a single digit, then put the array back together as a string - but I'm struggling to get this to work...</p>\n\n<p>My Ruby class is set up like so:</p>\n\n<pre><code>class Transaction\n\n  attr_accessor :amount, :merchant_id, :tag_id, :transaction_date\n  attr_reader :id\n\n  def initialize(options)\n\n    @id = options['id'].to_i if options['id']\n    @amount = options['amount'].to_f\n    @merchant_id = options['merchant_id'].to_i if options['merchant_id']\n    @tag_id = options['tag_id'].to_i if options['tag_id']\n    @transaction_date = options['transaction_date'] if options['transaction_date']\n\n  end\n</code></pre>\n\n<p>The SQL table likewise:</p>\n\n<pre><code>CREATE TABLE transactions(\n  id SERIAL8 PRIMARY KEY,\n  amount DECIMAL(10,2),\n  transaction_date DATE,\n  merchant_id INT8 REFERENCES merchants(id) ON DELETE CASCADE,\n  tag_id INT8 REFERENCES tags(id) ON DELETE CASCADE\n);\n</code></pre>\n\n<p>When I run my debugger on the array of values I return everything is displaying as a float as per how I've defined it in my class...</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 5669, "user_id": 7429104, "user_type": "registered", "accept_rate": 20, "profile_image": "https://i.stack.imgur.com/TZAPt.jpg?s=128&g=1", "display_name": "Aman", "link": "https://stackoverflow.com/users/7429104/aman"}, "edited": false, "score": 1, "creation_date": 1559632857, "post_id": 56438953, "comment_id": 99471792, "body": "Just delete <code>Gemfile.lock</code> and run <code>bundle install</code> again, probably it may help you."}, {"owner": {"reputation": 943, "user_id": 3861062, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/100003054720441/picture?type=large", "display_name": "Sungpah Lee", "link": "https://stackoverflow.com/users/3861062/sungpah-lee"}, "reply_to_user": {"reputation": 5669, "user_id": 7429104, "user_type": "registered", "accept_rate": 20, "profile_image": "https://i.stack.imgur.com/TZAPt.jpg?s=128&g=1", "display_name": "Aman", "link": "https://stackoverflow.com/users/7429104/aman"}, "edited": false, "score": 0, "creation_date": 1559633135, "post_id": 56438953, "comment_id": 99471947, "body": "Hi as I commented above, it didn&#39;t work out, same message appeared.:("}, {"owner": {"reputation": 5074, "user_id": 4207394, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/mmfTf.png?s=128&g=1", "display_name": "Deep", "link": "https://stackoverflow.com/users/4207394/deep"}, "edited": false, "score": 0, "creation_date": 1559636940, "post_id": 56438953, "comment_id": 99473630, "body": "Try running <code>bundle update</code> once, also if you have mentioned the gem version for any of gems above then remove it from the gemfile."}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1559642337, "post_id": 56438953, "comment_id": 99476504, "body": "This is really bad advice... Trying to upgrade a complex old rails application by &quot;removing all version constraints, deleting <code>Gemfile.lock</code>, and running <code>bundle update</code>&quot; will like introduce a huge number of errors. Sure, it will install the gems, but it&#39;s more than likely that the application won&#39;t actually run."}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 1, "creation_date": 1559642426, "post_id": 56438953, "comment_id": 99476542, "body": "@SungpahLee Revert back to the working version of your application. Upgrade <i>one</i> thing at a time. Ensure that it still works, each step of the way. It seems to me that you&#39;ve been trying to upgrade many things in one go, and - in doing so - you&#39;ve edited the <code>Gemfile</code> to specify a higher version of the <code>faraday</code> which is incompatible with your other libraries."}], "answers": [{"tags": [], "owner": {"reputation": 334, "user_id": 2606111, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FUdFG.jpg?s=128&g=1", "display_name": "Mahys116", "link": "https://stackoverflow.com/users/2606111/mahys116"}, "is_accepted": false, "score": 0, "last_activity_date": 1559647732, "creation_date": 1559647732, "answer_id": 56442974, "question_id": 56438953, "link": "https://stackoverflow.com/questions/56438953/bundler-could-not-find-compatible-versions-for-gem-faraday-upgrading-rails-fr/56442974#56442974", "title": "Bundler could not find compatible versions for gem &quot;faraday&quot;: Upgrading rails from 4.2 to 5.2.3", "body": "<p>As I see you have 2 problems with gem dependencies:</p>\n\n<p>1) You use faraday (~> 0.11.0), but twilio-ruby 5.23.1 need faraday (~> 0.9). So you need downgrade your faraday version to (~> 0.9)</p>\n\n<p>2) You use coffee-rails (~> 4.1.0) which depends on railties (>= 4.0.0, &lt; 5.0). But rails 5.2.3 use railties (5.2.3). So you need upgrade your coffee-rails to (~> 5.0.0) </p>\n\n<p>By other words, in Gemfile you need change lines:</p>\n\n<pre><code>faraday (~&gt; 0.11.0)\ncoffee-rails (~&gt; 4.1.0)\n</code></pre>\n\n<p>To:</p>\n\n<pre><code>faraday (~&gt; 0.9)\ncoffee-rails (~&gt; 5.0.0)\n</code></pre>\n"}], "owner": {"reputation": 943, "user_id": 3861062, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/100003054720441/picture?type=large", "display_name": "Sungpah Lee", "link": "https://stackoverflow.com/users/3861062/sungpah-lee"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 770, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1559647732, "creation_date": 1559632059, "question_id": 56438953, "link": "https://stackoverflow.com/questions/56438953/bundler-could-not-find-compatible-versions-for-gem-faraday-upgrading-rails-fr", "title": "Bundler could not find compatible versions for gem &quot;faraday&quot;: Upgrading rails from 4.2 to 5.2.3", "body": "<p>I'm trying to upgrade my rails 4.2 project to 5.2.3. </p>\n\n<p>When executing bundle update rails, I got an following error.</p>\n\n<p>Bundler could not find compatible versions for gem \"faraday\":\n  In Gemfile:\n    faraday (~> 0.11.0)</p>\n\n<pre><code>faraday_middleware was resolved to 0.13.1, which depends on\n  faraday (&gt;= 0.7.4, &lt; 1.0)\n\noauth2 (~&gt; 1.3.1) was resolved to 1.3.1, which depends on\n  faraday (&gt;= 0.8, &lt; 0.12)\n\nsentry-raven was resolved to 2.9.0, which depends on\n  faraday (&gt;= 0.7.6, &lt; 1.0)\n\ntwilio-ruby was resolved to 5.23.1, which depends on\n  faraday (~&gt; 0.9)\n</code></pre>\n\n<p>Bundler could not find compatible versions for gem \"railties\":\n  In Gemfile:\n    coffee-rails (~> 4.1.0) was resolved to 4.1.0, which depends on\n      railties (>= 4.0.0, &lt; 5.0)</p>\n\n<pre><code>devise was resolved to 4.6.2, which depends on\n  railties (&gt;= 4.1.0, &lt; 6.0)\n\nfactory_bot_rails was resolved to 5.0.2, which depends on\n  railties (&gt;= 4.2.0)\n\nrails (= 5.2.3) was resolved to 5.2.3, which depends on\n  railties (= 5.2.3)\n\nrails-i18n was resolved to 5.1.3, which depends on\n  railties (&gt;= 5.0, &lt; 6)\n\nrspec-rails (~&gt; 3.5, &gt;= 3.5.2) was resolved to 3.8.2, which depends on\n  railties (&gt;= 3.0)\n\nsass-rails (~&gt; 5.0) was resolved to 5.0.7, which depends on\n  railties (&gt;= 4.0.0, &lt; 6)\n\nweb-console (~&gt; 2.0) was resolved to 2.3.0, which depends on\n  railties (&gt;= 4.0)\n</code></pre>\n\n<p>According to references, I deleted Gemfile.lock and ran bundle install but same error occurred.</p>\n\n<p>It seems two gems are not compatible somehow with the current libraries. Do you have any suggestions how to safely upgrade rails project to 5.2.3?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "postgresql"], "comments": [{"owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 0, "creation_date": 1559637767, "post_id": 56438467, "comment_id": 99473986, "body": "Are you sure that your index covers all needed columns? How does your query look like, how does the index look like?"}], "answers": [{"comments": [{"owner": {"reputation": 843, "user_id": 728226, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/7840ff7b45650a9687e8b599461c4269?s=128&d=identicon&r=PG", "display_name": "Jau L", "link": "https://stackoverflow.com/users/728226/jau-l"}, "edited": false, "score": 0, "creation_date": 1559666763, "post_id": 56439367, "comment_id": 99489741, "body": "interesting, I did not know about sidekiq, I will give a shot. thanks"}, {"owner": {"reputation": 843, "user_id": 728226, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/7840ff7b45650a9687e8b599461c4269?s=128&d=identicon&r=PG", "display_name": "Jau L", "link": "https://stackoverflow.com/users/728226/jau-l"}, "edited": false, "score": 0, "creation_date": 1559716418, "post_id": 56439367, "comment_id": 99502817, "body": "how to handle dependent queries in sidekiq. like for example, adding a new name record and getting the id of that record, and use that record id for the next insertion as foreign id?"}], "tags": [], "owner": {"reputation": 5060, "user_id": 10522579, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7GQ6a.jpg?s=128&g=1", "display_name": "ray", "link": "https://stackoverflow.com/users/10522579/ray"}, "is_accepted": true, "score": 2, "last_activity_date": 1559633724, "creation_date": 1559633724, "answer_id": 56439367, "question_id": 56438467, "link": "https://stackoverflow.com/questions/56438467/rails-find-or-create-by-is-slow-when-database-contains-100k-records/56439367#56439367", "title": "rails find_or_create_by is slow when database contains 100k records", "body": "<p><code>find_or_create_by</code> is nothing but simply <code>where</code> query with <code>limit 1</code> and if result is <code>NULL</code> it will fire <code>insert</code> query to return new object.</p>\n\n<p>If you have added indexing properly to columns then it will be faster as much as it is supposed to be.</p>\n\n<p>But for large database you described, I will suggest you to run such operations in background using <a href=\"https://github.com/mperham/sidekiq\" rel=\"nofollow noreferrer\">sidekiq</a>  </p>\n"}], "owner": {"reputation": 843, "user_id": 728226, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/7840ff7b45650a9687e8b599461c4269?s=128&d=identicon&r=PG", "display_name": "Jau L", "link": "https://stackoverflow.com/users/728226/jau-l"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 121, "favorite_count": 0, "accepted_answer_id": 56439367, "answer_count": 1, "score": 0, "last_activity_date": 1559633724, "creation_date": 1559629788, "question_id": 56438467, "link": "https://stackoverflow.com/questions/56438467/rails-find-or-create-by-is-slow-when-database-contains-100k-records", "title": "rails find_or_create_by is slow when database contains 100k records", "body": "<p>I noticed that <code>find_or_create_by</code> in rails slowing data ingestion, although I have an index set on the <code>SELECT</code> fields. any suggestions on how to speed this up?  I'm using postgres</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "answers": [{"comments": [{"owner": {"reputation": 5060, "user_id": 10522579, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7GQ6a.jpg?s=128&g=1", "display_name": "ray", "link": "https://stackoverflow.com/users/10522579/ray"}, "edited": false, "score": 0, "creation_date": 1559632784, "post_id": 56438786, "comment_id": 99471760, "body": "This is temporary solution, I will prefer to to explain him how to pass <code>store_id</code> in link to <code>new</code> action so we can set <code>@store</code> and in <code>form_for</code> we can pass <code>f.hidden_field :store_id, @store.id</code> for create action."}, {"owner": {"reputation": 1, "user_id": 6837984, "user_type": "registered", "profile_image": "https://graph.facebook.com/1412956412049585/picture?type=large", "display_name": "Nam Tran", "link": "https://stackoverflow.com/users/6837984/nam-tran"}, "edited": false, "score": 0, "creation_date": 1559633512, "post_id": 56438786, "comment_id": 99472110, "body": "Yes, I try to pass store_id. How can I do that? &lt;%= form_with(model: product, local: true) do |form| %&gt;       &lt;%= form.hidden_field :store_id, @store.id %&gt; &lt;% end%&gt;  But then I got error: undefined method `id&#39;"}, {"owner": {"reputation": 1175, "user_id": 2861567, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GRa02.jpg?s=128&g=1", "display_name": "quyetdc", "link": "https://stackoverflow.com/users/2861567/quyetdc"}, "edited": false, "score": 0, "creation_date": 1559635687, "post_id": 56438786, "comment_id": 99473089, "body": "I edited my answer to include the example of how to add <code>store_id</code> to your product form"}], "tags": [], "owner": {"reputation": 1175, "user_id": 2861567, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GRa02.jpg?s=128&g=1", "display_name": "quyetdc", "link": "https://stackoverflow.com/users/2861567/quyetdc"}, "is_accepted": false, "score": 0, "last_activity_date": 1559635659, "last_edit_date": 1559635659, "creation_date": 1559631299, "answer_id": 56438786, "question_id": 56438438, "link": "https://stackoverflow.com/questions/56438438/one-to-many-to-many-one-user-has-many-store-one-store-has-many-products/56438786#56438786", "title": "One to Many To Many: One user has many store. One store has many products", "body": "<p>From Rails 5, <code>belongs_to</code> requires the association object to be present. If your <code>product</code> object does not have a valid <code>store_id</code> (<code>nil</code> or inexistent store object), that <code>product</code> object will not be valid.</p>\n\n<p>You can bypass this by allowing the association to be optional</p>\n\n<pre><code>class Product &lt; ApplicationRecord\n  belongs_to :store, optional: true\nend\n</code></pre>\n\n<p>Or, you should allow <code>store_id</code> as permitted parameter in your <code>products_controller</code> and pass it when you create a new product</p>\n\n<pre><code># below code I assume that your store table has a column called 'store_name'\n\n&lt;%= form_for @product do |f| %&gt;\n  &lt;%= f.collection_select :store_id, current_user.stores, :id, :store_name, prompt: 'Please select the store of this product' %&gt;\n  &lt;%= f.submit %&gt;\n&lt;% end %&gt;\n\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 6837984, "user_type": "registered", "profile_image": "https://graph.facebook.com/1412956412049585/picture?type=large", "display_name": "Nam Tran", "link": "https://stackoverflow.com/users/6837984/nam-tran"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 44, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1559635659, "creation_date": 1559629641, "question_id": 56438438, "link": "https://stackoverflow.com/questions/56438438/one-to-many-to-many-one-user-has-many-store-one-store-has-many-products", "title": "One to Many To Many: One user has many store. One store has many products", "body": "<p>I'm learning ROR. Trying to build this model: one user can have many store each store can have many product. I've been able to create store linking to its owner but I'm stuck at doing the same for product.</p>\n\n<p>store.rb</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>class Store &lt; ApplicationRecord\n  belongs_to :user\n  has_many :products, :foreign_key =&gt; :store_id\nend\n</code></pre>\n\n<p>product.rb</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>class Product &lt; ApplicationRecord\n  belongs_to :store\nend\n</code></pre>\n\n<p>products_controller.rb</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>class ProductsController &lt; ApplicationController\n  before_action :set_product, only: [:show, :edit, :update, :destroy]\n\n  # GET /products\n  # GET /products.json\n  def index\n    @products = Product.all\n  end\n\n  # GET /products/1\n  # GET /products/1.json\n  def show\n  end\n\n  # GET /products/new\n  def new\n  end\n\n  # GET /products/1/edit\n  def edit\n  end\n\n  # POST /products\n  # POST /products.json\n  def create\n    @product = Product.new(product_params)\n    respond_to do |format|\n      if @product.save\n        format.html { redirect_to @product, notice: 'Product was successfully created.' }\n        format.json { render :show, status: :created, location: @product }\n      else\n        format.html { render :new }\n        format.json { render json: @product.errors, status: :unprocessable_entity }\n      end\n    end\n  end\n\n  # PATCH/PUT /products/1\n  # PATCH/PUT /products/1.json\n  def update\n    respond_to do |format|\n      if @product.update(product_params)\n        format.html { redirect_to @product, notice: 'Product was successfully updated.' }\n        format.json { render :show, status: :ok, location: @product }\n      else\n        format.html { render :edit }\n        format.json { render json: @product.errors, status: :unprocessable_entity }\n      end\n    end\n  end\n\n  # DELETE /products/1\n  # DELETE /products/1.json\n  def destroy\n    @product.destroy\n    respond_to do |format|\n      format.html { redirect_to products_url, notice: 'Product was successfully destroyed.' }\n      format.json { head :no_content }\n    end\n  end\n\n  private\n    # Use callbacks to share common setup or constraints between actions.\n    def set_product\n      @product = Product.find(params[:id])\n    end\n\n    # Never trust parameters from the scary internet, only allow the white list through.\n    def product_params\n      params.require(:product).permit(:product_name, :product_price, :product_description, :product_tag, :sku_code)\n    end\nend\n</code></pre>\n\n<p>stores_controller.rb</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>class StoresController &lt; ApplicationController\n  before_action :set_store, only: [:show, :edit, :update, :destroy]\n\n  # GET /stores\n  # GET /stores.json\n  def index\n    @stores = Store.all\n  end\n\n  # GET /stores/1\n  # GET /stores/1.json\n  def show\n    @products = Product.all\n  end\n\n  # GET /stores/new\n  def new\n    @store = Store.new\n  end\n\n  # GET /stores/1/edit\n  def edit\n  end\n\n\n  # POST /stores\n  # POST /stores.json\n  def create\n    @store = Store.new(store_params)\n    @store.user_id = current_user.id\n    respond_to do |format|\n      if @store.save\n        format.html { redirect_to @store, notice: 'Store was successfully created.' }\n        format.json { render :show, status: :created, location: @store }\n      else\n        format.html { render :new }\n        format.json { render json: @store.errors, status: :unprocessable_entity }\n      end\n    end\n  end\n\n  # PATCH/PUT /stores/1\n  # PATCH/PUT /stores/1.json\n  def update\n    respond_to do |format|\n      if @store.update(store_params)\n        format.html { redirect_to @store, notice: 'Store was successfully updated.' }\n        format.json { render :show, status: :ok, location: @store }\n      else\n        format.html { render :edit }\n        format.json { render json: @store.errors, status: :unprocessable_entity }\n      end\n    end\n  end\n\n  # DELETE /stores/1\n  # DELETE /stores/1.json\n  def destroy\n    @store.destroy\n    respond_to do |format|\n      format.html { redirect_to stores_url, notice: 'Store was successfully destroyed.' }\n      format.json { head :no_content }\n    end\n  end\n\n  private\n    # Use callbacks to share common setup or constraints between actions.\n    def set_store\n      @store = Store.find(params[:id])\n    end\n\n    # Never trust parameters from the scary internet, only allow the white list through.\n    def store_params\n      params.require(:store).permit(:store_name, :store_description)\n    end\nend\n</code></pre>\n\n<p>I expect when creating a product, it will get the store_id immediately. I'm keep getting \"store must exist\" message</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "pagination", "ruby-on-rails-5"], "answers": [{"comments": [{"owner": {"reputation": 843, "user_id": 728226, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/7840ff7b45650a9687e8b599461c4269?s=128&d=identicon&r=PG", "display_name": "Jau L", "link": "https://stackoverflow.com/users/728226/jau-l"}, "edited": false, "score": 0, "creation_date": 1559666606, "post_id": 56438550, "comment_id": 99489659, "body": "thank you but im still getting this error <code>PG::GroupingError: ERROR:  aggregate function calls cannot be nested LINE 1: SELECT COUNT(count(physicians.id)) AS count_count</code>"}], "tags": [], "owner": {"reputation": 5669, "user_id": 7429104, "user_type": "registered", "accept_rate": 20, "profile_image": "https://i.stack.imgur.com/TZAPt.jpg?s=128&g=1", "display_name": "Aman", "link": "https://stackoverflow.com/users/7429104/aman"}, "is_accepted": false, "score": 0, "last_activity_date": 1559633003, "last_edit_date": 1559633003, "creation_date": 1559630229, "answer_id": 56438550, "question_id": 56438434, "link": "https://stackoverflow.com/questions/56438434/has-many-through-associations-find-count-of-physician-id/56438550#56438550", "title": "has_many through associations find count of physician.id", "body": "<p>While using an attribute on a model it should be in the plural for in query\ni.e <code>physicians.id</code> instead of <code>physician.id</code></p>\n\n<pre><code>patients_count = Patient.joins(:physicians)\n                            #.includes(:physicians)\n                            .group('patients.id')\n                            .select(\"count(physicians.id) as count\")\n                            .paginate(page: params[:page], per_page: 25)\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 843, "user_id": 728226, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/7840ff7b45650a9687e8b599461c4269?s=128&d=identicon&r=PG", "display_name": "Jau L", "link": "https://stackoverflow.com/users/728226/jau-l"}, "edited": false, "score": 0, "creation_date": 1559666667, "post_id": 56439140, "comment_id": 99489690, "body": "thanks, still getting the same error <code>PG::GroupingError: ERROR: aggregate function calls cannot be nested LINE 1: SELECT COUNT(count(physicians.id)) AS count_count</code>"}, {"owner": {"reputation": 1175, "user_id": 2861567, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GRa02.jpg?s=128&g=1", "display_name": "quyetdc", "link": "https://stackoverflow.com/users/2861567/quyetdc"}, "reply_to_user": {"reputation": 843, "user_id": 728226, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/7840ff7b45650a9687e8b599461c4269?s=128&d=identicon&r=PG", "display_name": "Jau L", "link": "https://stackoverflow.com/users/728226/jau-l"}, "edited": false, "score": 0, "creation_date": 1559674784, "post_id": 56439140, "comment_id": 99492955, "body": "Hi, I tested with <code>rails 5.2.3</code>, gem <code>pg 1.1.4</code>, <code>PostgreSQL 10</code>, ` will_paginate (3.1.7)` and it works. Are you sure you are applying correct SQL query? I have no idea why u generated <code>SELECT COUNT(count(pysicians.id))</code>, duplicated <code>COUNT</code> and <code>count</code>"}, {"owner": {"reputation": 843, "user_id": 728226, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/7840ff7b45650a9687e8b599461c4269?s=128&d=identicon&r=PG", "display_name": "Jau L", "link": "https://stackoverflow.com/users/728226/jau-l"}, "edited": false, "score": 0, "creation_date": 1559692339, "post_id": 56439140, "comment_id": 99498342, "body": "this is really weird, I have the same exact versions, I have this also <code>render json: patient, meta: pagination(patient), adapter: :json</code>"}], "tags": [], "owner": {"reputation": 1175, "user_id": 2861567, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GRa02.jpg?s=128&g=1", "display_name": "quyetdc", "link": "https://stackoverflow.com/users/2861567/quyetdc"}, "is_accepted": false, "score": 0, "last_activity_date": 1559632750, "creation_date": 1559632750, "answer_id": 56439140, "question_id": 56438434, "link": "https://stackoverflow.com/questions/56438434/has-many-through-associations-find-count-of-physician-id/56439140#56439140", "title": "has_many through associations find count of physician.id", "body": "<p>You have misspelling error in your query. Also, I think we don't need <code>includes</code> in this case. You're forcing to join twice</p>\n\n<pre><code>patients_count = Patient.joins(:physicians).select('count(physicians.id) as count').group('patients.id').paginate(page: params[:page], per_page: 25) \n\n</code></pre>\n"}], "owner": {"reputation": 843, "user_id": 728226, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/7840ff7b45650a9687e8b599461c4269?s=128&d=identicon&r=PG", "display_name": "Jau L", "link": "https://stackoverflow.com/users/728226/jau-l"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 32, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1559633003, "creation_date": 1559629626, "question_id": 56438434, "link": "https://stackoverflow.com/questions/56438434/has-many-through-associations-find-count-of-physician-id", "title": "has_many through associations find count of physician.id", "body": "<p>I'm trying to get the count(physician.id) but I'm getting errors in rails.</p>\n\n<pre><code>class Physician &lt; ApplicationRecord\n has_many :appointments\n has_many :patients, through: :appointments\nend\n\nclass Appointment &lt; ApplicationRecord\n belongs_to :physician\n belongs_to :patient\nend\n\nclass Patient &lt; ApplicationRecord\n has_many :appointments\n has_many :physicians, through: :appointments\nend\n</code></pre>\n\n<p>and what I'm doing here is:</p>\n\n<pre><code>patients_count = Patient.joins(:physicians).includes(:physicians).select('count(physician.id) as count').group('patients.id').paginate(page: params[:page], per_page: 25) \n</code></pre>\n\n<p>I'm getting this error, <code>\"PG::SyntaxError: ERROR:  syntax error at or near \"as\"\nLINE 1: ...CT COUNT(DISTINCT count(physician.id) as count)\"</code></p>\n\n<p>not sure if pagination is causing this issue, how to solve it?</p>\n"}, {"tags": ["ruby", "youtube-api"], "answers": [{"comments": [{"owner": {"reputation": 7544, "user_id": 73046, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/pWrkh.jpg?s=128&g=1", "display_name": "James Moore", "link": "https://stackoverflow.com/users/73046/james-moore"}, "edited": false, "score": 0, "creation_date": 1559744099, "post_id": 56438253, "comment_id": 99516168, "body": "There was some cut-and-paste going on in that sample; normally we do write with the newer syntax."}], "tags": [], "owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "is_accepted": true, "score": 1, "last_activity_date": 1559628838, "creation_date": 1559628838, "answer_id": 56438253, "question_id": 56437578, "link": "https://stackoverflow.com/questions/56437578/using-the-youtube-api-how-do-you-upload-a-private-video-in-ruby/56438253#56438253", "title": "Using the youtube api, how do you upload a private video in ruby?", "body": "<p>The <code>google-api-client</code> gem expects underscore keys and then internally <a href=\"https://github.com/googleapis/google-api-ruby-client/blob/b2eff01c7fd2c90292a094fbdfee3000beff87ad/generated/google/apis/youtube_v3/representations.rb#L1586\" rel=\"nofollow noreferrer\">translates <code>privacy_status</code> to <code>privacyStatus</code></a>. </p>\n\n<p>That said, just change your code to:</p>\n\n<pre><code>body = {\n  :snippet =&gt; {\n    :title =&gt; 'file upload',\n    :category_id =&gt; 29,\n    :description =&gt; 'description of first file upload'\n  },\n  :status =&gt; {\n    :privacy_status =&gt;'private'\n  }\n}\n</code></pre>\n\n<p>Btw, you might want to consider using the \"new\" hash syntax which is less verbose:</p>\n\n<pre><code>body = {\n  snippet: {\n   title: 'file upload',\n   category_id: 29,\n   description: 'description of first file upload'\n  },\n  status: {\n    privacy_status: 'private'\n  }\n}\n</code></pre>\n"}], "owner": {"reputation": 7544, "user_id": 73046, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/pWrkh.jpg?s=128&g=1", "display_name": "James Moore", "link": "https://stackoverflow.com/users/73046/james-moore"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 44, "favorite_count": 0, "accepted_answer_id": 56438253, "answer_count": 1, "score": 0, "last_activity_date": 1559628838, "creation_date": 1559624328, "question_id": 56437578, "link": "https://stackoverflow.com/questions/56437578/using-the-youtube-api-how-do-you-upload-a-private-video-in-ruby", "title": "Using the youtube api, how do you upload a private video in ruby?", "body": "<p>I can upload a video to YouTube using the Ruby api.  The problem is that I've asked for visibility => private, and the video is uploaded as public.  Other fields (title, description) are set correctly.  What am I missing?</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>    body = {\n      :snippet =&gt; {\n       :title =&gt; 'file upload',\n       :category_id =&gt; 29,\n       :description =&gt; 'description of first file upload'\n      },\n      :status =&gt; {\n        :privacyStatus =&gt; \"private\"\n      },\n   }\n    puts \"body: \", body \n    r = youtube.insert_video('snippet,status', body, upload_source: fname, content_type:'video/mp4') do |result, err|\n      puts \"result: \", result\n      puts \"err: \", err\n    end\n</code></pre>\n\n<p>Using google-api-client (0.30.0)</p>\n"}, {"tags": ["ruby", "amazon-web-services", "amazon-s3", "aws-sdk"], "comments": [{"owner": {"reputation": 162605, "user_id": 174777, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6PnNW.jpg?s=128&g=1", "display_name": "John Rotenstein", "link": "https://stackoverflow.com/users/174777/john-rotenstein"}, "edited": false, "score": 0, "creation_date": 1559633543, "post_id": 56437374, "comment_id": 99472121, "body": "The error is <code>Access Denied</code>. This indicates that either the object does not exist, or it is not publicly accessible. What makes you think that it should be publicly accessible via that URL? Is there a Bucket Policy on the bucket? Does it work if you put the URL in your web browser?"}, {"owner": {"reputation": 11, "user_id": 11596929, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/83917365c7eefd36e49e70a4fad15b56?s=128&d=identicon&r=PG&f=1", "display_name": "Thirupathi", "link": "https://stackoverflow.com/users/11596929/thirupathi"}, "reply_to_user": {"reputation": 162605, "user_id": 174777, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6PnNW.jpg?s=128&g=1", "display_name": "John Rotenstein", "link": "https://stackoverflow.com/users/174777/john-rotenstein"}, "edited": false, "score": 0, "creation_date": 1559639677, "post_id": 56437374, "comment_id": 99475037, "body": "Hi Thank for you time now i am getting error like  The request signature we calculated does not match the signature you provided. Check your key and signing method. can you plese tell me how to encode hamc using Base64 i am new bee i dont know anything about AWS."}, {"owner": {"reputation": 162605, "user_id": 174777, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6PnNW.jpg?s=128&g=1", "display_name": "John Rotenstein", "link": "https://stackoverflow.com/users/174777/john-rotenstein"}, "edited": false, "score": 0, "creation_date": 1559703246, "post_id": 56437374, "comment_id": 99500119, "body": "What do you mean by &quot;generate preview url&quot;? Are you wanting to make a Pre-Signed URL? I would recommend using the <a href=\"https://docs.aws.amazon.com/sdk-for-ruby\" rel=\"nofollow noreferrer\">AWS SDK for Ruby</a>. It has an in-built <a href=\"https://docs.aws.amazon.com/sdkforruby/api/Aws/S3/Presigner.html\" rel=\"nofollow noreferrer\">Class: Aws::S3::Presigner</a> that can do it in one command."}, {"owner": {"reputation": 11, "user_id": 11596929, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/83917365c7eefd36e49e70a4fad15b56?s=128&d=identicon&r=PG&f=1", "display_name": "Thirupathi", "link": "https://stackoverflow.com/users/11596929/thirupathi"}, "reply_to_user": {"reputation": 162605, "user_id": 174777, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6PnNW.jpg?s=128&g=1", "display_name": "John Rotenstein", "link": "https://stackoverflow.com/users/174777/john-rotenstein"}, "edited": false, "score": 0, "creation_date": 1559707693, "post_id": 56437374, "comment_id": 99500854, "body": "I uploaded pdf file to s3 bucket. How can i preview them in browser with out downloading?"}, {"owner": {"reputation": 11, "user_id": 11596929, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/83917365c7eefd36e49e70a4fad15b56?s=128&d=identicon&r=PG&f=1", "display_name": "Thirupathi", "link": "https://stackoverflow.com/users/11596929/thirupathi"}, "reply_to_user": {"reputation": 162605, "user_id": 174777, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6PnNW.jpg?s=128&g=1", "display_name": "John Rotenstein", "link": "https://stackoverflow.com/users/174777/john-rotenstein"}, "edited": false, "score": 0, "creation_date": 1559707825, "post_id": 56437374, "comment_id": 99500876, "body": "signer = Aws::S3::Presigner.new this line throwing error like undefined method `match&#39; for nil:NilClass"}, {"owner": {"reputation": 162605, "user_id": 174777, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6PnNW.jpg?s=128&g=1", "display_name": "John Rotenstein", "link": "https://stackoverflow.com/users/174777/john-rotenstein"}, "edited": false, "score": 0, "creation_date": 1559709415, "post_id": 56437374, "comment_id": 99501155, "body": "Are you wanting to access the file via a URL, or in the S3 management console? If you access it via a URL, are you okay with the entire world being able to access the object (&quot;public&quot;), or do you want to keep the object private but allow certain people to access it?"}, {"owner": {"reputation": 11, "user_id": 11596929, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/83917365c7eefd36e49e70a4fad15b56?s=128&d=identicon&r=PG&f=1", "display_name": "Thirupathi", "link": "https://stackoverflow.com/users/11596929/thirupathi"}, "reply_to_user": {"reputation": 162605, "user_id": 174777, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6PnNW.jpg?s=128&g=1", "display_name": "John Rotenstein", "link": "https://stackoverflow.com/users/174777/john-rotenstein"}, "edited": false, "score": 0, "creation_date": 1559709924, "post_id": 56437374, "comment_id": 99501268, "body": "Yes i wanted to access the file via url. am ok with public access please suggest me in this i am new bee to aws."}, {"owner": {"reputation": 11, "user_id": 11596929, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/83917365c7eefd36e49e70a4fad15b56?s=128&d=identicon&r=PG&f=1", "display_name": "Thirupathi", "link": "https://stackoverflow.com/users/11596929/thirupathi"}, "reply_to_user": {"reputation": 162605, "user_id": 174777, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6PnNW.jpg?s=128&g=1", "display_name": "John Rotenstein", "link": "https://stackoverflow.com/users/174777/john-rotenstein"}, "edited": false, "score": 0, "creation_date": 1559710021, "post_id": 56437374, "comment_id": 99501293, "body": "And suggest me to keep the object private but allow certain people to access it? in this also"}, {"owner": {"reputation": 162605, "user_id": 174777, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6PnNW.jpg?s=128&g=1", "display_name": "John Rotenstein", "link": "https://stackoverflow.com/users/174777/john-rotenstein"}, "edited": false, "score": 0, "creation_date": 1559710223, "post_id": 56437374, "comment_id": 99501336, "body": "See: <a href=\"https://stackoverflow.com/a/56333367/174777\">How to protect some files/objects in public bucket?</a>"}, {"owner": {"reputation": 11, "user_id": 11596929, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/83917365c7eefd36e49e70a4fad15b56?s=128&d=identicon&r=PG&f=1", "display_name": "Thirupathi", "link": "https://stackoverflow.com/users/11596929/thirupathi"}, "reply_to_user": {"reputation": 162605, "user_id": 174777, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6PnNW.jpg?s=128&g=1", "display_name": "John Rotenstein", "link": "https://stackoverflow.com/users/174777/john-rotenstein"}, "edited": false, "score": 0, "creation_date": 1559725851, "post_id": 56437374, "comment_id": 99506873, "body": "I make the policy as public but when i hit  <a href=\"https://debtcleans-local.s3.amazonaws.com/users/2/debts/7/nanipkl.pdf\" rel=\"nofollow noreferrer\">debtcleans-local.s3.amazonaws.com/users/2/debts/7/nanipkl.pd&zwnj;&#8203;f</a> this url is getting download instead of preview"}, {"owner": {"reputation": 162605, "user_id": 174777, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6PnNW.jpg?s=128&g=1", "display_name": "John Rotenstein", "link": "https://stackoverflow.com/users/174777/john-rotenstein"}, "edited": false, "score": 0, "creation_date": 1559781150, "post_id": 56437374, "comment_id": 99530424, "body": "Ah! So by &quot;preview&quot; you mean &quot;show it in the browser&quot;! It has to do with the <code>Content-Type</code> set on the object. See <a href=\"https://stackoverflow.com/a/30025072/174777\">Uploading PDF to Amazon S3 and display in-browser</a> and <a href=\"https://stackoverflow.com/a/39832482/174777\">PDFs in Amazon S3 don&#39;t open in Chrome for view</a>"}], "owner": {"reputation": 11, "user_id": 11596929, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/83917365c7eefd36e49e70a4fad15b56?s=128&d=identicon&r=PG&f=1", "display_name": "Thirupathi", "link": "https://stackoverflow.com/users/11596929/thirupathi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 437, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1559652723, "creation_date": 1559622625, "last_edit_date": 1559652723, "question_id": 56437374, "link": "https://stackoverflow.com/questions/56437374/how-to-generate-preview-url-for-file-that-stored-in-s3-bucket", "title": "How to generate preview url for file that stored in s3 bucket?", "body": "<p>Can anyone help me to generate preview url for the file in s3 bucket?\nThese are the things i tried </p>\n\n<pre><code>digest = OpenSSL::Digest::Digest.new('sha1')\nexpire_date = Time.now.utc.to_i + (2*24*60*60)\nS3_BUCKET = \"test-local\"\nS3_SECRET_ACCESS_KEY =  BW::Config.aws_access_key\npath = \"users/2/debts/7/sample.pdf\"\ncan_string = \"GET\\n\\n\\n#{expire_date}\\n/#{S3_BUCKET}/#{path}\"\nhmac = OpenSSL::HMAC.digest(digest, S3_SECRET_ACCESS_KEY, can_string)\nsignature = URI.escape(Base64.encode64(hmac).strip)\n\"https://#{S3_BUCKET}.s3.amazonaws.com/#{path}?AWSAccessKeyId=#{S3_SECRET_ACCESS_KEY}&amp;Expires=#{expire_date}&amp;Signature=#{signature}\"\n</code></pre>\n\n<p>With this code i am getting error like </p>\n\n<pre><code>  &lt;Error&gt;\n  &lt;Code&gt;SignatureDoesNotMatch&lt;/Code&gt;\n  &lt;Message&gt;\n     The request signature we calculated does not match the signature you provided. Check your key and signing method.\n &lt;/Message&gt;\n &lt;AWSAccessKeyId&gt;AKIAIWURLFHOWDXB53YQ&lt;/AWSAccessKeyId&gt;\n &lt;StringToSign&gt;\n GET 1559811251 /debtcleanse-local/users/2/debts/7/sample.pdf\n &lt;/StringToSign&gt;\n&lt;SignatureProvided&gt;u04282G45mP5qZ0Xze4QEWVtsUk=&lt;/SignatureProvided&gt;\n&lt;StringToSignBytes&gt;47 45 54 0a 0a 0a 31 35 35 39 38 31 31 32 35 31 0a 2f 64 65 62 74 63 6c 65 61 6e 73 65 2d 6c 6f 63 61 6c 2f 75 73 65 72 73 2f 32 2f 64 65 62 74 73 2f 37 2f 73 61 6d 70 6c 65 2e 70 64 66\n &lt;/StringToSignBytes&gt;\n &lt;RequestId&gt;FCE6C8D7705167E9&lt;/RequestId&gt;\n&lt;HostId&gt;voXKpRtvMXy4jZ5tOJnm/K8WelEclBEix7NdCulBFEKXJczF5dSqscqkTBoqz3GAHBbdZZoMypQ=\n&lt;/HostId&gt;\n&lt;/Error&gt;\n</code></pre>\n"}, {"tags": ["ruby", "string", "path", "truncate"], "comments": [{"owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 0, "creation_date": 1559622488, "post_id": 56437286, "comment_id": 99468436, "body": "What if the first and the last segment is longer than the maximum length? What rule should win? The max length or that the start and the end of the path should always be visible?"}, {"owner": {"reputation": 1567, "user_id": 1526214, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/c1d625c61edde5e62b4b1b3d6179fd80?s=128&d=identicon&r=PG", "display_name": "Sod Almighty", "link": "https://stackoverflow.com/users/1526214/sod-almighty"}, "reply_to_user": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 0, "creation_date": 1559622562, "post_id": 56437286, "comment_id": 99468465, "body": "Good question. I guess the last segment would be more important than the first; and the length would be most important."}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1559639179, "post_id": 56437286, "comment_id": 99474746, "body": "Why does it become <code>a&#47;very&#47;lo...&#47;screen&#47;easily</code> and not <code>a&#47;very&#47;long&#47;...reen&#47;easily</code> (i.e. simply cut in half) \u2013 what are the rules for selecting the <i>&quot;unimportant parts&quot;</i>?"}, {"owner": {"reputation": 1567, "user_id": 1526214, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/c1d625c61edde5e62b4b1b3d6179fd80?s=128&d=identicon&r=PG", "display_name": "Sod Almighty", "link": "https://stackoverflow.com/users/1526214/sod-almighty"}, "edited": false, "score": 0, "creation_date": 1559744251, "post_id": 56437286, "comment_id": 99516244, "body": "It was merely an example, I didn&#39;t specifically count the characters. It could well be either of those. Perhaps I should have been more specific."}], "answers": [{"comments": [{"owner": {"reputation": 1567, "user_id": 1526214, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/c1d625c61edde5e62b4b1b3d6179fd80?s=128&d=identicon&r=PG", "display_name": "Sod Almighty", "link": "https://stackoverflow.com/users/1526214/sod-almighty"}, "edited": false, "score": 0, "creation_date": 1559624607, "post_id": 56437558, "comment_id": 99468945, "body": "Nice. That&#39;s pretty damn simple. And while there are potential improvements that could be made (such as ensuring that ellipses only happen directly before or after a path separator unless there&#39;s insufficient space to do so), it probably wouldn&#39;t be worth the extra effort to implement. Thanks, I&#39;ll give this one a try in my program."}, {"owner": {"reputation": 1854, "user_id": 669745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9a4b0416684de65970e4d1b4da1bb290?s=128&d=identicon&r=PG", "display_name": "Panic", "link": "https://stackoverflow.com/users/669745/panic"}, "edited": false, "score": 0, "creation_date": 1559625690, "post_id": 56437558, "comment_id": 99469207, "body": "If <code>length</code> is odd you are hiding one extra char"}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "reply_to_user": {"reputation": 1854, "user_id": 669745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9a4b0416684de65970e4d1b4da1bb290?s=128&d=identicon&r=PG", "display_name": "Panic", "link": "https://stackoverflow.com/users/669745/panic"}, "edited": false, "score": 0, "creation_date": 1559626139, "post_id": 56437558, "comment_id": 99469338, "body": "@Panic that\u2019s why I preamble it with \u201csomewhat like that.\u201d The accurate implementation depends on many factors and custom wishes; the above is the barebone only."}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "reply_to_user": {"reputation": 1567, "user_id": 1526214, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/c1d625c61edde5e62b4b1b3d6179fd80?s=128&d=identicon&r=PG", "display_name": "Sod Almighty", "link": "https://stackoverflow.com/users/1526214/sod-almighty"}, "edited": false, "score": 0, "creation_date": 1559626245, "post_id": 56437558, "comment_id": 99469362, "body": "@SodAlmighty if you want to split on path separators, you might want to <code>path.split($&#47;)</code> and then <code>take_while</code> from both the beginning and the end until the total length is near the desired one."}, {"owner": {"reputation": 1567, "user_id": 1526214, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/c1d625c61edde5e62b4b1b3d6179fd80?s=128&d=identicon&r=PG", "display_name": "Sod Almighty", "link": "https://stackoverflow.com/users/1526214/sod-almighty"}, "edited": false, "score": 0, "creation_date": 1559627786, "post_id": 56437558, "comment_id": 99469822, "body": "@AlekseiMatiushkin Good idea."}], "tags": [], "owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "is_accepted": true, "score": 1, "last_activity_date": 1559624135, "creation_date": 1559624135, "answer_id": 56437558, "question_id": 56437286, "link": "https://stackoverflow.com/questions/56437286/how-to-shorten-file-paths-using-ellipses-in-ruby/56437558#56437558", "title": "How to shorten file paths using ellipses in Ruby?", "body": "<p>Somewhat like this:</p>\n\n<pre><code>shortener = -&gt;(path, length) {\n  l = length / 2 - 1\n  [path[0...l], path[-l..-1]].join('..')\n}\nshortener.(path, 10)\n#\u21d2 \"a/ve..sily\"\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 48049, "user_id": 6419007, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/CwqtX.jpg?s=128&g=1", "display_name": "Eric Duminil", "link": "https://stackoverflow.com/users/6419007/eric-duminil"}, "edited": false, "score": 0, "creation_date": 1559631924, "post_id": 56438756, "comment_id": 99471371, "body": "It looks a bit like Fortran but the output looks really nice."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "reply_to_user": {"reputation": 48049, "user_id": 6419007, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/CwqtX.jpg?s=128&g=1", "display_name": "Eric Duminil", "link": "https://stackoverflow.com/users/6419007/eric-duminil"}, "edited": false, "score": 0, "creation_date": 1559632266, "post_id": 56438756, "comment_id": 99471530, "body": "@Eric, Fortran II or IV?  I cannot disagree.  Perhaps I should have broken the string into an array, worked on that and the joined, but I generally like to work on strings without doing that."}, {"owner": {"reputation": 1567, "user_id": 1526214, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/c1d625c61edde5e62b4b1b3d6179fd80?s=128&d=identicon&r=PG", "display_name": "Sod Almighty", "link": "https://stackoverflow.com/users/1526214/sod-almighty"}, "edited": false, "score": 0, "creation_date": 1559744392, "post_id": 56438756, "comment_id": 99516328, "body": "Very nice. Shame it replaces the entire segment with ellipses, instead of truncating the segment, but a nice piece of code nonetheless."}, {"owner": {"reputation": 1567, "user_id": 1526214, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/c1d625c61edde5e62b4b1b3d6179fd80?s=128&d=identicon&r=PG", "display_name": "Sod Almighty", "link": "https://stackoverflow.com/users/1526214/sod-almighty"}, "edited": false, "score": 0, "creation_date": 1559744480, "post_id": 56438756, "comment_id": 99516380, "body": "I&#39;m toying with the idea of repeatedly chopping the last segment and the first segment off a path until insufficient length remains, then concatenating the remainder, truncating it, and adding ellipses. I will have to give that a try."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1559749705, "post_id": 56438756, "comment_id": 99519427, "body": "Sod, regarding your first comment, I see I misread the question. It&#39;s <i>much</i> easier if one need not break on entire segments."}, {"owner": {"reputation": 1567, "user_id": 1526214, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/c1d625c61edde5e62b4b1b3d6179fd80?s=128&d=identicon&r=PG", "display_name": "Sod Almighty", "link": "https://stackoverflow.com/users/1526214/sod-almighty"}, "edited": false, "score": 0, "creation_date": 1559780861, "post_id": 56438756, "comment_id": 99530385, "body": "I was thinking it&#39;d be best if it truncated on only one end of a segment (i.e. /something.../ rather than /something...something/) but it&#39;s really not worth the effort at this point. Plus, I now realise that this would create the false impression that no segments had been entirely omitted, which wouldn&#39;t always be the case. These solutions will do fine. Yours was very detailed and I thank you for taking the time."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1559782387, "post_id": 56438756, "comment_id": 99530599, "body": "Your comment &quot;I&#39;m toying with the idea...&quot; prompted me to return to my initial answer with improvements I had incorporated in later versions. It still doesn&#39;t meet your requirement of not necessarily breaking on segments. I&#39;ve made all these changes just out of curiousity."}], "tags": [], "owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "is_accepted": false, "score": 2, "last_activity_date": 1559782103, "last_edit_date": 1559782103, "creation_date": 1559631136, "answer_id": 56438756, "question_id": 56437286, "link": "https://stackoverflow.com/questions/56437286/how-to-shorten-file-paths-using-ellipses-in-ruby/56438756#56438756", "title": "How to shorten file paths using ellipses in Ruby?", "body": "<p>I've used left and right pointers (<code>lt_ptr</code> and <code>rt_ptr</code>) to build that two portions of the string that are to be retained and separated by an ellipsis.</p>\n\n<p>I begin by reducing the right pointer to the last forward slash, then increase the left pointer to the first forward slash, then reduce the right pointer to the next-to-last forward slash, and so on until further movements of the pointer would make the string containing the ellipsis longer than the maximum permissible length. </p>\n\n<p><strong>Code</strong></p>\n\n<pre><code>def shorten_string(str, max_len, ellipsis = '...')\n  return str if str.size &lt;= max_len\n  max_len -= ellipsis.size\n  ops = [{ index: :index, ptr: 0, chg: 1 },\n         { index: :rindex, ptr: str.size-1, chg: -1 } ].cycle\n  op = ops.next\n  success = true\n  loop do\n    op = ops.next\n    ptr = str.public_send(op[:index], '/', op[:ptr] + op[:chg] )\n    lptr = ptr\n    rptr = ops.peek[:ptr]\n    lptr, rptr = rptr, lptr if op[:index] == :rindex\n    if lptr + 1 + str.size - rptr &lt;= max_len\n      op[:ptr] = ptr\n    else\n      break unless success\n      success = false\n    end        \n  end\n  op = ops.next if op[:index] == :rindex\n  \"%s%s%s\" % [str[0..op[:ptr]], ellipsis, str[ops.peek[:ptr]..-1]]\nend\n</code></pre>\n\n<p><strong>Examples</strong></p>\n\n<pre><code>str = 'a/very/long/path/with/too/many/characters/to/fit/on/my/screen/easily'\n</code></pre>\n\n<h1><p></p></h1>\n\n<pre><code>shorten_string(str, 40)\n  #=&gt; \"a/very/long/path/.../on/my/screen/easily\" (length: 40)\nshorten_string(str, 30)\n  #=&gt; \"a/very/.../on/my/screen/easily\"           (length: 30)\nshorten_string(str, 20)\n  #=&gt; \"a/.../screen/easily\"                      (length: 19) \n</code></pre>\n\n<p>It is of course coincidence that, in the first two examples, the length of the resulting string (with the ellipsis) was exactly equal to the maximum length, <code>max_length</code>. Notice that in the second example there are 4 forward slashes after the ellipsis and only 2 before. That's because after <code>\"/my\"</code> was added only 3 more characters could be added, not enough for <code>\"long/\"</code> (which follows <code>\"very/\"</code>), but enough for <code>\"/on\"</code>.</p>\n\n<p><strong>Explanation</strong></p>\n\n<p>This uses the forms of <a href=\"http://ruby-doc.org/core-2.5.1/String.html#method-i-index\" rel=\"nofollow noreferrer\">String#index</a> and [String#rindex](<a href=\"http://ruby-doc.org/core-\" rel=\"nofollow noreferrer\">http://ruby-doc.org/core-</a> \n2.5.1/String.html#method-i-rindex) that employ a second argument.</p>\n\n<p>To better understand the calculations that are being performed, I suggest running the code against an example, after salting the code with <code>puts</code> statements. An example of the modified method follows.</p>\n\n<pre><code>def shorten_string(str, max_len, ellipsis = '...')\n  return str if str.size &lt;= max_len\n  max_len -= ellipsis.size\n  puts \"str.size=#{str.size}\"                                   #!!!!\n  ops = [{ index: :index, ptr: 0, chg: 1 },\n         { index: :rindex, ptr: str.size-1, chg: -1 } ].cycle\n  op = ops.next\n  success = true\n  loop do\n    op = ops.next\n    puts \"\\nop=#{op}, ops.peek=#{ops.peek}\"                     #!!!!\n    ptr = str.public_send(op[:index], '/', op[:ptr] + op[:chg] )\n    lptr = ptr\n    rptr = ops.peek[:ptr]\n    puts \"ptr=#{ptr}, lptr=#{lptr}, rptr=#{rptr}\"               #!!!!\n    lptr, rptr = rptr, lptr if op[:index] == :rindex\n    puts \"after possible flip, lptr=#{lptr}, rptr=#{rptr}\"      #!!!!\n    puts \"lptr + 1 + str.size - rptr = #{lptr+1+str.size-rptr}\" #!!!!\n    if lptr + 1 + str.size - rptr &lt;= max_len\n      op[:ptr] = ptr\n      puts \"after lptr+1+str.size-rptr &lt;= max_len, op=#{op}\"    #!!!!\n    else\n      break unless success\n      success = false\n    end        \n  end\n  puts \"after loop op=#{op}, ops.peek=#{ops.peek}\"              #!!!!\n  op = ops.next if op[:index] == :rindex\n  \"%s%s%s\" % [str[0..op[:ptr]], ellipsis, str[ops.peek[:ptr]..-1]]\nend\n</code></pre>\n"}], "owner": {"reputation": 1567, "user_id": 1526214, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/c1d625c61edde5e62b4b1b3d6179fd80?s=128&d=identicon&r=PG", "display_name": "Sod Almighty", "link": "https://stackoverflow.com/users/1526214/sod-almighty"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 125, "favorite_count": 0, "accepted_answer_id": 56437558, "answer_count": 2, "score": 0, "last_activity_date": 1559782103, "creation_date": 1559621966, "question_id": 56437286, "link": "https://stackoverflow.com/questions/56437286/how-to-shorten-file-paths-using-ellipses-in-ruby", "title": "How to shorten file paths using ellipses in Ruby?", "body": "<p>In Ruby (not Rails), is there a straightforward way to take a long file path and replace unimportant parts of it with ellipses, to make it shorter for display?</p>\n\n<p>For example:</p>\n\n<blockquote>\n  <p>a/very/long/path/with/plenty/of/characters/that/won't/fit/on/my/screen/easily</p>\n</blockquote>\n\n<p>Becomes something like:</p>\n\n<blockquote>\n  <p>a/very/lo.../screen/easily</p>\n</blockquote>\n\n<p>I need to be able to specify the maximum length; and the start and end of the path should always be visible.</p>\n\n<p>I could probably figure out a solution if I bang my head against it for long enough, but perhaps someone knows a way?</p>\n"}, {"tags": ["javascript", "ruby-on-rails", "ruby", "haml"], "comments": [{"owner": {"reputation": 5669, "user_id": 7429104, "user_type": "registered", "accept_rate": 20, "profile_image": "https://i.stack.imgur.com/TZAPt.jpg?s=128&g=1", "display_name": "Aman", "link": "https://stackoverflow.com/users/7429104/aman"}, "edited": false, "score": 0, "creation_date": 1559620189, "post_id": 56437070, "comment_id": 99468045, "body": "Are you using jquery?"}, {"owner": {"reputation": 7, "user_id": 11578325, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-LIioUcEpL9I/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rePRM-4zhU-lF5wfe5ZkK_oBaJ61w/mo/photo.jpg?sz=128", "display_name": "Kobe Beau Alcober", "link": "https://stackoverflow.com/users/11578325/kobe-beau-alcober"}, "reply_to_user": {"reputation": 5669, "user_id": 7429104, "user_type": "registered", "accept_rate": 20, "profile_image": "https://i.stack.imgur.com/TZAPt.jpg?s=128&g=1", "display_name": "Aman", "link": "https://stackoverflow.com/users/7429104/aman"}, "edited": false, "score": 0, "creation_date": 1559620975, "post_id": 56437070, "comment_id": 99468188, "body": "@Gabbar I do have <code>%script{:src =&gt; &quot;&#47;assets&#47;js&#47;vendor&#47;jquery-2.1.4.min.js&quot;}</code> in the same haml file"}, {"owner": {"reputation": 5669, "user_id": 7429104, "user_type": "registered", "accept_rate": 20, "profile_image": "https://i.stack.imgur.com/TZAPt.jpg?s=128&g=1", "display_name": "Aman", "link": "https://stackoverflow.com/users/7429104/aman"}, "edited": false, "score": 0, "creation_date": 1559621012, "post_id": 56437070, "comment_id": 99468195, "body": "That would be easy syntax with jquery."}, {"owner": {"reputation": 7, "user_id": 11578325, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-LIioUcEpL9I/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rePRM-4zhU-lF5wfe5ZkK_oBaJ61w/mo/photo.jpg?sz=128", "display_name": "Kobe Beau Alcober", "link": "https://stackoverflow.com/users/11578325/kobe-beau-alcober"}, "reply_to_user": {"reputation": 5669, "user_id": 7429104, "user_type": "registered", "accept_rate": 20, "profile_image": "https://i.stack.imgur.com/TZAPt.jpg?s=128&g=1", "display_name": "Aman", "link": "https://stackoverflow.com/users/7429104/aman"}, "edited": false, "score": 0, "creation_date": 1559621210, "post_id": 56437070, "comment_id": 99468223, "body": "@Gabbar How? Do you know a jquery function to do that? or do you have a code?"}, {"owner": {"reputation": 5669, "user_id": 7429104, "user_type": "registered", "accept_rate": 20, "profile_image": "https://i.stack.imgur.com/TZAPt.jpg?s=128&g=1", "display_name": "Aman", "link": "https://stackoverflow.com/users/7429104/aman"}, "edited": false, "score": 0, "creation_date": 1559621600, "post_id": 56437070, "comment_id": 99468288, "body": "@Have given answer in both ways using javascript and jquery please have a look."}, {"owner": {"reputation": 7, "user_id": 11578325, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-LIioUcEpL9I/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rePRM-4zhU-lF5wfe5ZkK_oBaJ61w/mo/photo.jpg?sz=128", "display_name": "Kobe Beau Alcober", "link": "https://stackoverflow.com/users/11578325/kobe-beau-alcober"}, "reply_to_user": {"reputation": 5669, "user_id": 7429104, "user_type": "registered", "accept_rate": 20, "profile_image": "https://i.stack.imgur.com/TZAPt.jpg?s=128&g=1", "display_name": "Aman", "link": "https://stackoverflow.com/users/7429104/aman"}, "edited": false, "score": 0, "creation_date": 1559626672, "post_id": 56437070, "comment_id": 99469498, "body": "@Gabbar Thank you very much this was very helpful although copy pasting it doesn&#39;t work instantly because my <code>RejectionReason</code> was in a model and without a value it therefore always returned nil but a few edits and its now working"}, {"owner": {"reputation": 5669, "user_id": 7429104, "user_type": "registered", "accept_rate": 20, "profile_image": "https://i.stack.imgur.com/TZAPt.jpg?s=128&g=1", "display_name": "Aman", "link": "https://stackoverflow.com/users/7429104/aman"}, "edited": false, "score": 0, "creation_date": 1559626747, "post_id": 56437070, "comment_id": 99469524, "body": "Glad to know that :)"}], "answers": [{"tags": [], "owner": {"reputation": 5669, "user_id": 7429104, "user_type": "registered", "accept_rate": 20, "profile_image": "https://i.stack.imgur.com/TZAPt.jpg?s=128&g=1", "display_name": "Aman", "link": "https://stackoverflow.com/users/7429104/aman"}, "is_accepted": true, "score": 0, "last_activity_date": 1560644262, "last_edit_date": 1560644262, "creation_date": 1559621103, "answer_id": 56437201, "question_id": 56437070, "link": "https://stackoverflow.com/questions/56437070/how-to-get-the-value-of-a-textarea-and-pass-it-to-a-link-to/56437201#56437201", "title": "How to get the value of a textarea and pass it to a link_to", "body": "<p>On document ready get value of <code>RejectionReason</code> from <code>textarea</code></p>\n\n<p>Using JavaScript syntax:</p>\n\n<pre><code>:javascript\n  if (document.readyState === 'complete') {\n    var rejectReason = document.getElementById(\"RejectionReason\").value;\n    var currentRejectJobPath = document.getElementById(\"reject-job-link\").href;\n    var jobPathWithReason = currentRejectJobPath + \"?reason=\" + rejectReason;\n    document.getElementById(\"reject-job-link\").href=jobPathWithReason;\n  }\n</code></pre>\n\n<p>Using jQuery syntax:</p>\n\n<pre><code>:javascript\n  $( document ).ready(function() {\n    var rejectReason = $(\"#RejectionReason\").val();\n    var currentRejectJobPath = $(\"#reject-job-link\").attr('href');\n    var jobPathWithReason = currentRejectJobPath + \"?reason=\" + rejectReason;\n    $(\"#reject-job-link\").attr('href', jobPathWithReason)\n  }\n</code></pre>\n\n<p>Add a <code>id</code> on the link and remove the <code>reason</code> parameter which will be passed using JavaScript:</p>\n\n<pre><code>= link_to (reject_job_order_path(@job_order), method: :get, class: 'btn btn-danger', id: 'reject-job-link') do\n  %i.fa.fa-thumbs-down\n    Reject\n</code></pre>\n"}], "owner": {"reputation": 7, "user_id": 11578325, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-LIioUcEpL9I/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rePRM-4zhU-lF5wfe5ZkK_oBaJ61w/mo/photo.jpg?sz=128", "display_name": "Kobe Beau Alcober", "link": "https://stackoverflow.com/users/11578325/kobe-beau-alcober"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 107, "favorite_count": 0, "accepted_answer_id": 56437201, "answer_count": 1, "score": 0, "last_activity_date": 1560644262, "creation_date": 1559619808, "last_edit_date": 1560644151, "question_id": 56437070, "link": "https://stackoverflow.com/questions/56437070/how-to-get-the-value-of-a-textarea-and-pass-it-to-a-link-to", "title": "How to get the value of a textarea and pass it to a link_to", "body": "<p>I'm trying to get the value from a textarea in my Haml file:</p>\n\n<pre><code>%p.text-left\n  Please provide reason for rejection.\n%textarea#RejectionReason.form-control{:rows =&gt; \"3\"}\n</code></pre>\n\n<p>I have the JavaScript to handle this:</p>\n\n<pre><code>:javascript\n  function myFunction() {\n    var x = document.getElementById(\"RejectionReason\").value;\n  }\n</code></pre>\n\n<p>The problem is how do I call <code>myFunction()</code> such that my <code>link_to</code> first runs the function and the result is placed to the variable <code>myreason</code>? </p>\n\n<pre><code>= link_to (reject_job_order_path(@job_order, :reason =&gt; myreason), method: :get, class: 'btn btn-danger') do\n  %i.fa.fa-thumbs-down\n    Reject\n</code></pre>\n\n<p>This is all inside a modal if that helps, and all of these are in the same <code>show.html.haml</code>.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "rubygems"], "answers": [{"comments": [{"owner": {"reputation": 848, "user_id": 11249670, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f29532e75e13b5f3b631012229f22829?s=128&d=identicon&r=PG&f=1", "display_name": "reesaspieces", "link": "https://stackoverflow.com/users/11249670/reesaspieces"}, "edited": false, "score": 0, "creation_date": 1559626392, "post_id": 56437539, "comment_id": 99469410, "body": "Thank you so much for walking me through it. I&#39;d never used a gem in an unconventional way like this, so it was tricky. Based on your explanation, I tried making this command class inherit from <code>ActionController::Base</code> (like this: <code>Authentication::LoginCommand &lt; ActionController::Base</code>) but this hacky way didn&#39;t work, as it returned this error: <code>NoMethodError Exception: undefined method &#39;parameters&#39; for nil:NilClass</code>. Starting to feel like it may be safer to use this method in the controller as originally intended."}, {"owner": {"reputation": 18856, "user_id": 1359650, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/dffc4318ac93e728a26c8e8b51b4eb37?s=128&d=identicon&r=PG", "display_name": "jvillian", "link": "https://stackoverflow.com/users/1359650/jvillian"}, "reply_to_user": {"reputation": 848, "user_id": 11249670, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f29532e75e13b5f3b631012229f22829?s=128&d=identicon&r=PG&f=1", "display_name": "reesaspieces", "link": "https://stackoverflow.com/users/11249670/reesaspieces"}, "edited": false, "score": 0, "creation_date": 1559627283, "post_id": 56437539, "comment_id": 99469681, "body": "Yeah, it could be tricky. Remember that controllers are always used as instances. So, minimally, you&#39;d probably need to use an instance of <code>Authentication::LoginCommand</code>. But, I would guess that you&#39;ll end up with other errors. Might be easier, as you say, to use the method in the controller as originally intended. (Although, it could be a good learning exercise to get your PORO working as you&#39;re describing.)"}], "tags": [], "owner": {"reputation": 18856, "user_id": 1359650, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/dffc4318ac93e728a26c8e8b51b4eb37?s=128&d=identicon&r=PG", "display_name": "jvillian", "link": "https://stackoverflow.com/users/1359650/jvillian"}, "is_accepted": true, "score": 0, "last_activity_date": 1559661346, "last_edit_date": 1559661346, "creation_date": 1559623984, "answer_id": 56437539, "question_id": 56437053, "link": "https://stackoverflow.com/questions/56437053/ruby-gem-method-only-available-in-controller-if-so-how-to-make-it-available-in/56437539#56437539", "title": "Ruby gem method only available in controller? If so, how to make it available in other files?", "body": "<blockquote>\n  <p>I was under the impression that a gem's methods can be accessed anywhere in the Rails app once it's been installed with bundler. </p>\n</blockquote>\n\n<p>That would be an incorrect impression. </p>\n\n<p>As you can see, <code>Sorcery::Engine</code> causes <code>ActionController::Base</code> to include methods defined in <code>Sorcery::Controller</code>, here:</p>\n\n<pre><code>require 'sorcery'\nrequire 'rails'\n\nmodule Sorcery\n  # The Sorcery engine takes care of extending ActiveRecord (if used) and ActionController,\n  # With the plugin logic.\n  class Engine &lt; Rails::Engine\n    config.sorcery = ::Sorcery::Controller::Config\n\n    initializer 'extend Controller with sorcery' do\n      # TODO: Should this include a modified version of the helper methods?\n      if defined?(ActionController::API)\n        ActionController::API.send(:include, Sorcery::Controller)\n      end\n\n      if defined?(ActionController::Base)\n        ActionController::Base.send(:include, Sorcery::Controller)\n        ActionController::Base.helper_method :current_user\n        ActionController::Base.helper_method :logged_in?\n      end\n    end\n  end\nend\n</code></pre>\n\n<p><code>Sorcer::Controller</code> in turn, includes a series of submodules:</p>\n\n<pre><code>module Sorcery\n  module Controller\n    def self.included(klass)\n      klass.class_eval do\n        include InstanceMethods\n        Config.submodules.each do |mod|\n          # FIXME: Is there a cleaner way to handle missing submodules?\n          # rubocop:disable Lint/HandleExceptions\n          begin\n            include Submodules.const_get(mod.to_s.split('_').map(&amp;:capitalize).join)\n          rescue NameError\n            # don't stop on a missing submodule.\n          end\n          # rubocop:enable Lint/HandleExceptions\n        end\n      end\n      Config.update!\n      Config.configure!\n    end\n\n    ...\n  end\nend\n</code></pre>\n\n<p>One of these submodules is <code>Sourcery::Controller::Submodules::External</code> which, when included, also includes <code>Sourcery::Controller::Submodules::External::InstanceMethods</code>, here:</p>\n\n<pre><code>module Sorcery\n  module Controller\n    module Submodules\n      # This submodule helps you login users from external auth providers such as Twitter.\n      # This is the controller part which handles the http requests and tokens passed between the app and the @provider.\n      module External\n        def self.included(base)\n          base.send(:include, InstanceMethods)\n          ...\n        end\n      end\n    end\n  end\nend\n</code></pre>\n\n<p>And, <code>InstanceMethods</code> contains the method <code>login_from</code>, here:</p>\n\n<pre><code>module Sorcery\n  module Controller\n    module Submodules\n      # This submodule helps you login users from external auth providers such as Twitter.\n      # This is the controller part which handles the http requests and tokens passed between the app and the @provider.\n      module External\n        def self.included(base)\n          base.send(:include, InstanceMethods)\n\n        module InstanceMethods\n          protected\n\n          ...\n\n          # tries to login the user from provider's callback\n          def login_from(provider_name, should_remember = false)\n            sorcery_fetch_user_hash provider_name\n\n            return unless (user = user_class.load_from_provider(provider_name, @user_hash[:uid].to_s))\n\n            # we found the user.\n            # clear the session\n            return_to_url = session[:return_to_url]\n            reset_sorcery_session\n            session[:return_to_url] = return_to_url\n\n            # sign in the user\n            auto_login(user, should_remember)\n            after_login!(user)\n\n            # return the user\n            user\n          end\n\n          ...\n        end\n      end\n    end\n  end\nend\n</code></pre>\n\n<p>Soooo, that's a long way of saying that <code>login_from</code> is defined as a protected instance method on classes that inherit from <code>ActionController::Base</code> and is not defined as an instance method on classes that DO NOT inherit from <code>ActionController::Base</code> which is why you're getting the <code>NoMethodError</code>. </p>\n\n<blockquote>\n  <p>Is there some way I could require the gem to run the code below in the command file instead of the controller?</p>\n</blockquote>\n\n<p>Maybe. Maybe not. As you can see, <code>login_from</code> is using other <code>sorcery</code> methods and methods inherited from <code>ActionController::Base</code>. So, you would need to make sure all of those methods are available in <code>Authentication::LoginCommand</code> in order for <code>login_from</code> to behave appropriately.</p>\n"}], "owner": {"reputation": 848, "user_id": 11249670, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f29532e75e13b5f3b631012229f22829?s=128&d=identicon&r=PG&f=1", "display_name": "reesaspieces", "link": "https://stackoverflow.com/users/11249670/reesaspieces"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 172, "favorite_count": 0, "accepted_answer_id": 56437539, "answer_count": 1, "score": 0, "last_activity_date": 1559661346, "creation_date": 1559619661, "question_id": 56437053, "link": "https://stackoverflow.com/questions/56437053/ruby-gem-method-only-available-in-controller-if-so-how-to-make-it-available-in", "title": "Ruby gem method only available in controller? If so, how to make it available in other files?", "body": "<p>I was under the impression that a gem's methods can be accessed anywhere in the Rails app once it's been installed with bundler. But is this not the case? I'm confused because a method accessible in the <code>controller</code> isn't recognised when moved outside the file. \nIs there some way I could require the gem to run the code below in the <code>command</code> file instead of the <code>controller</code>?</p>\n\n<p>I'm using an authentication gem called <a href=\"https://github.com/Sorcery/sorcery\" rel=\"nofollow noreferrer\"><code>sorcery</code></a> to implement an OAuth login system. There are some <a href=\"https://github.com/Sorcery/sorcery#external\" rel=\"nofollow noreferrer\">methods</a> like <code>login_from(provider)</code> that the gem provides, which can be accessed from my controller just fine.</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code># app/controllers/oauths_controller.rb\nclass OauthsController &lt; ApplicationController\n  skip_before_action :require_login\n\n  def callback\n    provider = params[:provider]\n    if @user = login_from(provider)\n    # method continues\n  end\n</code></pre>\n\n<p>However, we're trying to take a command-query separation approach in our app, so I tried moving this process containing <code>login_from(provider)</code> method to a different file called <code>app/commands/authentication/login_command.rb</code>. This resulted in the method not being recognised:</p>\n\n<pre><code>NoMethodError (undefined method 'login_from' for #&lt;Authentication::LoginCommand:&gt;)\n</code></pre>\n\n<p>Thanks in advance.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "autoload"], "comments": [{"owner": {"reputation": 2125, "user_id": 1446543, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/934816c610f53abdab5f26510478bc24?s=128&d=identicon&r=PG", "display_name": "ForeverZer0", "link": "https://stackoverflow.com/users/1446543/foreverzer0"}, "edited": false, "score": 0, "creation_date": 1559616788, "post_id": 56436188, "comment_id": 99467477, "body": "Not familiar with any languages that enforce this behavior."}, {"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 0, "creation_date": 1559626547, "post_id": 56436188, "comment_id": 99469460, "body": "Your question is unclear. Why would Ruby <code>raise</code> a <code>NameError</code> in this case? The only reason it could <code>raise</code> a <code>NameError</code> is if <code>Class#table_name</code> doesn&#39;t exist."}], "answers": [{"tags": [], "owner": {"reputation": 1231, "user_id": 2230115, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/sGX51.png?s=128&g=1", "display_name": "iCodeSometime", "link": "https://stackoverflow.com/users/2230115/icodesometime"}, "is_accepted": false, "score": 0, "last_activity_date": 1559611004, "creation_date": 1559611004, "answer_id": 56436229, "question_id": 56436188, "link": "https://stackoverflow.com/questions/56436188/why-does-ruby-not-throw-an-error-in-an-instance-where-the-class-name-and-file-na/56436229#56436229", "title": "Why does Ruby not throw an error in an instance where the class name and file name of the class are mismatched?", "body": "<p>This answer might sound like a cop out, but it doesn't throw an error because Ruby doesn't care even the slightest what your filenames are called.</p>\n\n<p>e.g. in file <code>asdfasdf.no_rb_ending_here</code> we can have</p>\n\n<pre><code>#!/usr/bin/env ruby\nmodule Something\n  class Test\n    def test\n      puts 'test'\n    end\n  end\nend\nclass SomethingElse\n  def otherThings\n    puts 'haha'\n  end\nend\n</code></pre>\n\n<p>Then to make things even weirder, I can have a separate file that modifies (monkey patches) the classes defined in that file.\nin <code>more_stuff.rb</code></p>\n\n<pre><code>#!/usr/bin/env ruby\nrequire_relative 'asdfasdf.no_rb_ending_here'\nmodule Something\n  class Test\n    def test2\n      test()\n      puts '2'\n    end\n  end\nend\nclass SomethingElse\n  def moreThings\n    otherThings()\n    puts 'MOAR'\n  end\nend\n\nSomething::Test.new.test2()\n# test\n# 2\nSomethingElse.new.moreThings()\n# haha\n# MOAR\n</code></pre>\n\n<p>Ruby is pretty cool - you don't get errors for things that don't NEED to cause an error.</p>\n"}, {"tags": [], "owner": {"reputation": 2019, "user_id": 9595653, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-jNAfm9c6bRo/AAAAAAAAAAI/AAAAAAAAABA/2JGGWk6fJl8/photo.jpg?sz=128", "display_name": "Clara", "link": "https://stackoverflow.com/users/9595653/clara"}, "is_accepted": false, "score": 0, "last_activity_date": 1559624274, "creation_date": 1559624274, "answer_id": 56437573, "question_id": 56436188, "link": "https://stackoverflow.com/questions/56436188/why-does-ruby-not-throw-an-error-in-an-instance-where-the-class-name-and-file-na/56437573#56437573", "title": "Why does Ruby not throw an error in an instance where the class name and file name of the class are mismatched?", "body": "<p>The name error, or uninitialized constant error only appears in Rails. The reason for that is, that active record (which is also a general design pattern) is mapping the tables in the database with the models (or with objects in general).\nActive Record can only make that connection via the naming conventions for files and the classes.\nAs mentioned in the other answer, pure ruby doesn't need to comply with these conventions. However, it is a general rule to name the files like the classes they contain to have better organised code.</p>\n"}], "owner": {"reputation": 29, "user_id": 8876896, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b8b8e33d9a082b23cbee3a98eca35124?s=128&d=identicon&r=PG&f=1", "display_name": "agita", "link": "https://stackoverflow.com/users/8876896/agita"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 414, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1559624274, "creation_date": 1559610464, "question_id": 56436188, "link": "https://stackoverflow.com/questions/56436188/why-does-ruby-not-throw-an-error-in-an-instance-where-the-class-name-and-file-na", "title": "Why does Ruby not throw an error in an instance where the class name and file name of the class are mismatched?", "body": "<p>Why isn't the Ruby interpreter throwing a NameError in this instance here?</p>\n\n<pre><code>class OrangeTurtle\n   self.table_name = 'turtles'\nend\n</code></pre>\n\n<p>Filename: orange_turtles.rb</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "model-view-controller", "activerecord", "database-design"], "comments": [{"owner": {"reputation": 2345, "user_id": 4988918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/x1BRI.png?s=128&g=1", "display_name": "Mark Merritt", "link": "https://stackoverflow.com/users/4988918/mark-merritt"}, "edited": false, "score": 0, "creation_date": 1559610470, "post_id": 56436074, "comment_id": 99466451, "body": "You know your requirements better than anyone...but I&#39;m having trouble differentiating a <code>Work</code> from a <code>Submission</code>. I&#39;d say get rid of one or the other, which will simplify your models. Maybe a submission is more of an action taken on a <code>Work</code> object"}, {"owner": {"reputation": 5669, "user_id": 7429104, "user_type": "registered", "accept_rate": 20, "profile_image": "https://i.stack.imgur.com/TZAPt.jpg?s=128&g=1", "display_name": "Aman", "link": "https://stackoverflow.com/users/7429104/aman"}, "edited": false, "score": 0, "creation_date": 1559619743, "post_id": 56436074, "comment_id": 99467961, "body": "@izy May i know what have you tried so far?"}, {"owner": {"reputation": 35, "user_id": 10247020, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dc07b1e4585217f8d2656e2bb7f936d8?s=128&d=identicon&r=PG&f=1", "display_name": "yzi0148", "link": "https://stackoverflow.com/users/10247020/yzi0148"}, "edited": false, "score": 0, "creation_date": 1559619881, "post_id": 56436074, "comment_id": 99467989, "body": "I&#39;m currently trying out Mark&#39;s suggestion and removing <code>Submission</code> and instead adding a column so that I know if the <code>Work</code> is created by a teacher or created by a student. I&#39;m thinking of making <a href=\"https://stackoverflow.com/questions/6097288/how-can-i-do-self-reference-with-ruby-on-rails\"><code>Work</code> a self referential model</a>   I&#39;ve also tried a nested form using the Cocoon gem. <code>Submission</code> accepted attributes for <code>answers</code> and <code>questions</code>. <code>Work</code> also accepted attributes for questions. <code>Question</code> accepts attributes for <code>answers</code>"}, {"owner": {"reputation": 5669, "user_id": 7429104, "user_type": "registered", "accept_rate": 20, "profile_image": "https://i.stack.imgur.com/TZAPt.jpg?s=128&g=1", "display_name": "Aman", "link": "https://stackoverflow.com/users/7429104/aman"}, "edited": false, "score": 0, "creation_date": 1559622452, "post_id": 56436074, "comment_id": 99468428, "body": "@izy Question is not clear, can you show the form by which you want to pass parent_id, that may be helpful to figure out."}], "owner": {"reputation": 35, "user_id": 10247020, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dc07b1e4585217f8d2656e2bb7f936d8?s=128&d=identicon&r=PG&f=1", "display_name": "yzi0148", "link": "https://stackoverflow.com/users/10247020/yzi0148"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 60, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1559609015, "creation_date": 1559609015, "question_id": 56436074, "link": "https://stackoverflow.com/questions/56436074/how-to-pass-in-parent-id-into-nested-attribute-when-parent-model-hasnt-been-cre", "title": "How to pass in parent ID into nested attribute when parent model hasn&#39;t been created?", "body": "<p>I have a schoolwork platform that allow:\n- users to create a homework assignment (<code>Work</code>) or quiz (<code>Work</code> that has <code>Questions</code>)\n- users to submit assignments (<code>Submission</code>)</p>\n\n<p>A given assignment or <code>work</code>, it can have many <code>submissions</code>. A <code>work</code> may also have many <code>questions</code>. A <code>question</code> can have many <code>answers</code>, either canonical <code>answers</code> (set by the teacher) or non-canonical <code>answers</code> (submitted by students).</p>\n\n<p>When a student submits an assignment (creates a <code>Submission</code> for a given <code>Work</code>), they should see the questions relating to the work and be able to create non-canonical <code>answers</code>. A student should not be able to change any attributes of a <code>question</code>. </p>\n\n<p><strong>Problem</strong>: I'm thinking of using a nested form to model the above behavior, but am having some trouble populating the correct fields. I need to be able to relate an answer back to the submission it came from. However, at the moment I submit the form and call <code>Submission.new</code> / <code>Submission.create</code>, the submission doesn't have an ID yet and so I cannot populate the <code>answers_attribute</code> with the <code>submission_id</code>. </p>\n\n<p><strong>Question</strong>:</p>\n\n<ol>\n<li>How can I fix the nested form to correctly populate <code>submission_id</code> for the answer?</li>\n<li>Is there another way I can go about this to accomplish the same thing?</li>\n<li>Is there a simpler way to design the relationships than what I have now?</li>\n</ol>\n\n<h3>Code</h3>\n\n<pre><code>class Work &lt; ApplicationRecord\n\n  has_many :submissions\n  has_many :questions # Allow for quizzes\n  has_many :answers, through: :questions\n  accepts_nested_attributes_for :questions, reject_if: :all_blank, allow_destroy: true\n\n  validates :name, presence: true, allow_nil: false\n\n\nend\n\n# == Schema Information\n#\n# Table name: works\n#\n#  id               :bigint(8)        not null, primary key\n#  description      :text\n#  due_date         :datetime\n#  grades_published :boolean          default(FALSE)\n#  name             :string\n#  points           :float            default(1.0)\n#  published        :boolean\n#  submittable      :boolean          default(TRUE)\n#  url              :string\n#  created_at       :datetime         not null\n#  updated_at       :datetime         not null\n#  category_id      :integer\n#  course_id        :integer\n#\n\n</code></pre>\n\n<pre><code>class Submission &lt; ApplicationRecord\n  belongs_to :work\n  belongs_to :enrollment\n  has_one :grade\n  has_many :questions, through: :works\n  has_many :answers, through: :questions\n\n  accepts_nested_attributes_for :questions, reject_if: :all_blank, allow_destroy: true\n  accepts_nested_attributes_for :answers, reject_if: :all_blank, allow_destroy: true\n\n  validates_uniqueness_of :work_id, scope: :enrollment_id, message: \" has already been submitted\"\n\nend\n\n# == Schema Information\n#\n# Table name: submissions\n#\n#  id            :bigint(8)        not null, primary key\n#  enrollment_id :integer\n#  work_id       :integer\n#  title         :string\n#  content       :text\n#  created_at    :datetime         not null\n#  updated_at    :datetime         not null\n#\n\n</code></pre>\n\n<pre><code>class Question &lt; ApplicationRecord\n  belongs_to :work\n  has_many :answers, inverse_of: :question\n  accepts_nested_attributes_for :answers, reject_if: :all_blank, allow_destroy: true\n\n  validates :value, presence: true, allow_nil: false\nend\n\n# == Schema Information\n#\n# Table name: questions\n#\n#  id         :bigint(8)        not null, primary key\n#  value      :string\n#  created_at :datetime         not null\n#  updated_at :datetime         not null\n#  work_id    :bigint(8)\n#\n# Indexes\n#\n#  index_questions_on_work_id  (work_id)\n#\n</code></pre>\n\n<pre><code>class Answer &lt; ApplicationRecord\n  belongs_to :question, inverse_of: :answers\n  # belongs_to :work, through: :questions\n  # belongs_to :submission, through: :works\n\n  validates :question_id, :presence =&gt; true\n  validates :value, presence: true, allow_nil: false\nend\n\n# == Schema Information\n#\n# Table name: answers\n#\n#  id            :bigint(8)        not null, primary key\n#  is_canon      :boolean          default(FALSE)\n#  is_correct    :boolean          default(FALSE)\n#  value         :string\n#  created_at    :datetime         not null\n#  updated_at    :datetime         not null\n#  question_id   :bigint(8)\n#  submission_id :bigint(8)\n#\n# Indexes\n#\n#  index_answers_on_question_id    (question_id)\n#  index_answers_on_submission_id  (submission_id)\n#\n# Foreign Keys\n#\n#  fk_rails_...  (question_id =&gt; questions.id)\n#  fk_rails_...  (submission_id =&gt; submissions.id)\n#\n</code></pre>\n\n<p>Help is very much appreciated. Thank you!!</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 1, "creation_date": 1559610468, "post_id": 56436018, "comment_id": 99466450, "body": "You&#39;re saying <code>the_player = @player[input.to_i - 1]  </code> but where is defined <code>@player</code>?"}, {"owner": {"reputation": 18079, "user_id": 503402, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/873ad707fb34aac8fbdfbfec676e02e9?s=128&d=identicon&r=PG", "display_name": "Max", "link": "https://stackoverflow.com/users/503402/max"}, "edited": false, "score": 0, "creation_date": 1559612721, "post_id": 56436018, "comment_id": 99466817, "body": "It looks like you should be reading from <code>Player.all</code> instead of <code>@player</code>"}, {"owner": {"reputation": 1, "user_id": 11596350, "user_type": "registered", "profile_image": "https://graph.facebook.com/10156878775663429/picture?type=large", "display_name": "Thisforbliss", "link": "https://stackoverflow.com/users/11596350/thisforbliss"}, "edited": false, "score": 0, "creation_date": 1559678330, "post_id": 56436018, "comment_id": 99494354, "body": "Thank you, that worked. I thought @player was being used from my Player Class as a relationship..."}], "owner": {"reputation": 1, "user_id": 11596350, "user_type": "registered", "profile_image": "https://graph.facebook.com/10156878775663429/picture?type=large", "display_name": "Thisforbliss", "link": "https://stackoverflow.com/users/11596350/thisforbliss"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 23, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1559608436, "creation_date": 1559608436, "question_id": 56436018, "link": "https://stackoverflow.com/questions/56436018/having-trouble-interpolating-user-input-into-another-method", "title": "Having trouble interpolating user input into another method", "body": "<p>Im scraping data from espn.com of all golden state warriors players and want to show each attribute of every player. Such as their height position, salary and college. Once I give the user the ability to pick the player they would like to know more about. I would like puts out that information for the user to see but I see an error in the process.</p>\n\n<p>This is the code I have written.</p>\n\n<pre><code>\n  attr_accessor :player, :continue\n\n  def intialize\n   @continue = true \n  end\n\n  def call \n    start \n    #skips over while loop\n    #while @continue\n    list_players\n    menu\n    show_player if @continue == true &amp;&amp; @player != nil\n  #end\n    goodbye\n  end\n\n  def start\n   puts \"Welcome to the Golden State Roster 'The Home Of The Splash Brothers'\"\n  end\n\n  def goodbye\n    puts \"See you next time for any players updates!\"\n  end\n\n  def list_players\n    Player.all.clear\n    Scraper.scrape_page\n    Player.all.each.with_index(1) do |player, index|\n      puts \"#{index}. #{player.name}\"\n    end\n  end\n\n  def menu\n    input = \"\"\n    while input != \"exit\"\n    puts \"Choose any player you wish by the 'number', type 'list' to reshow list or type 'exit' when finished.\"\n    input = gets.strip.downcase\n      if input.to_i &gt; 0                      \n        the_player = @player[input.to_i - 1]  \n\n      puts \"#{the_player.name} plays #{the_player.position} for the Golden State Warriors. He is #{the_player.age} years old and #{the_player.height} tall. He comes in weighing #{the_player.weight}. #{the_player.name} graduated from #{the_player.college} and makes honest living of #{the_player.salary} dollars per year.\"\n        \"Select another player by typing 'yes' or press 'exit' when you're ready to leave.\"\n\n        binding.pry\n      elsif input == \"exit\"\n        @continue = false\n      # elsif input.to_i.between?(1, Player.all.length)\n      #   @player = Player.all[input.to_i - 1]\n      elsif input == \"list\"\n      list_players\n      else\n        puts \"Error, Choose any player you wish by the number or type 'exit' when finished.\"\n\n      end\n    end\n  end  ```\n\nIt breaks at \"the_player\"\n\n```This is the error\n\n```Welcome to the Golden State Roster 'The Home Of The Splash Brothers'\n1. Jordan Bell\n2. Andrew Bogut\n3. Quinn Cook\n4. DeMarcus Cousins\n5. Stephen Curry\n6. Marcus Derrickson\n7. Kevin Durant\n8. Jacob Evans\n9. Draymond Green\n10. Andre Iguodala\n11. Jonas Jerebko\n12. Damian Jones\n13. Damion Lee\n14. Shaun Livingston\n15. Kevon Looney\n16. Alfonzo McKinnie\n17. Klay Thompson\nChoose any player you wish by the 'number', type 'list' to reshow list or type 'exit' when finished.\n4\nTraceback (most recent call last):\n        2: from ./bin/ballers:6:in `&lt;main&gt;'\n        1: from /home/Thisforbliss/Development/project/lib/project/cli.rb:17:in`call'\n/home/Thisforbliss/Development/project/lib/project/cli.rb:45:in `menu': undefined method `[]' for nil:NilClass (NoMethodError)```\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "timezone"], "answers": [{"comments": [{"owner": {"reputation": 1188, "user_id": 6939854, "user_type": "registered", "accept_rate": 35, "profile_image": "https://graph.facebook.com/10207653979453662/picture?type=large", "display_name": "Blue", "link": "https://stackoverflow.com/users/6939854/blue"}, "edited": false, "score": 0, "creation_date": 1559608498, "post_id": 56436007, "comment_id": 99466151, "body": "That gives me a string does it not?  I need class Time"}, {"owner": {"reputation": 1231, "user_id": 2230115, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/sGX51.png?s=128&g=1", "display_name": "iCodeSometime", "link": "https://stackoverflow.com/users/2230115/icodesometime"}, "reply_to_user": {"reputation": 1188, "user_id": 6939854, "user_type": "registered", "accept_rate": 35, "profile_image": "https://graph.facebook.com/10207653979453662/picture?type=large", "display_name": "Blue", "link": "https://stackoverflow.com/users/6939854/blue"}, "edited": false, "score": 3, "creation_date": 1559608893, "post_id": 56436007, "comment_id": 99466196, "body": "@Blue the time itself does not have a display format.  Also, this answer will always say that it is in CDT, even when it is not."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 1, "creation_date": 1559609970, "post_id": 56436007, "comment_id": 99466368, "body": "<code>Time</code> is not a format, it&#39;s a class that encapsulates a value. If you want it formatted you want a string."}, {"owner": {"reputation": 1188, "user_id": 6939854, "user_type": "registered", "accept_rate": 35, "profile_image": "https://graph.facebook.com/10207653979453662/picture?type=large", "display_name": "Blue", "link": "https://stackoverflow.com/users/6939854/blue"}, "edited": false, "score": 1, "creation_date": 1559610378, "post_id": 56436007, "comment_id": 99466432, "body": "Thank you, the update was exactly what I looking for."}, {"owner": {"reputation": 1188, "user_id": 6939854, "user_type": "registered", "accept_rate": 35, "profile_image": "https://graph.facebook.com/10207653979453662/picture?type=large", "display_name": "Blue", "link": "https://stackoverflow.com/users/6939854/blue"}, "reply_to_user": {"reputation": 1231, "user_id": 2230115, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/sGX51.png?s=128&g=1", "display_name": "iCodeSometime", "link": "https://stackoverflow.com/users/2230115/icodesometime"}, "edited": false, "score": 1, "creation_date": 1559610475, "post_id": 56436007, "comment_id": 99466452, "body": "@iCodeSometime The edit was exactly what I was looking for, I don&#39;t know if you consider that a format but incase you run into someone asking a question similar to mine there are multiple ways to display Time"}], "tags": [], "owner": {"reputation": 627, "user_id": 10895713, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GTs8n.jpg?s=128&g=1", "display_name": "Max Vinicius", "link": "https://stackoverflow.com/users/10895713/max-vinicius"}, "is_accepted": true, "score": 4, "last_activity_date": 1559609840, "last_edit_date": 1559609840, "creation_date": 1559608345, "answer_id": 56436007, "question_id": 56435939, "link": "https://stackoverflow.com/questions/56435939/how-to-set-time-zone-in-rails/56436007#56436007", "title": "How to set time zone in Rails?", "body": "<p>Try this:</p>\n\n<pre><code># application.rb\n\nclass Application &lt; Rails::Application\n  config.time_zone = 'Eastern Time (US &amp; Canada)'\nend\n\nTime.zone      # =&gt; #&lt;ActiveSupport::TimeZone:0x514834...&gt;\nTime.zone.name # =&gt; \"Eastern Time (US &amp; Canada)\"\nTime.zone.now  # =&gt; Sun, 18 May 2008 14:30:44 EDT -04:00\n</code></pre>\n\n<p>Source: <a href=\"https://api.rubyonrails.org/classes/ActiveSupport/TimeZone.html\" rel=\"nofollow noreferrer\">https://api.rubyonrails.org/classes/ActiveSupport/TimeZone.html</a></p>\n"}], "owner": {"reputation": 1188, "user_id": 6939854, "user_type": "registered", "accept_rate": 35, "profile_image": "https://graph.facebook.com/10207653979453662/picture?type=large", "display_name": "Blue", "link": "https://stackoverflow.com/users/6939854/blue"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 91, "favorite_count": 0, "accepted_answer_id": 56436007, "answer_count": 1, "score": 1, "last_activity_date": 1559637905, "creation_date": 1559607448, "last_edit_date": 1559637905, "question_id": 56435939, "link": "https://stackoverflow.com/questions/56435939/how-to-set-time-zone-in-rails", "title": "How to set time zone in Rails?", "body": "<p>I'm working in rails and I am trying to figure out how to set the time zone so <code>Time.now</code> gives me</p>\n\n<pre><code>Mon, 03 Jun 2019 19:08:13 CDT -05:00\n</code></pre>\n"}, {"tags": ["jquery", "ruby-on-rails", "ruby", "bootstrap-4"], "answers": [{"comments": [{"owner": {"reputation": 325, "user_id": 10711461, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-x09vFeGc87g/AAAAAAAAAAI/AAAAAAAAHsA/63IliGHyj28/photo.jpg?sz=128", "display_name": "Stas Chehovskih", "link": "https://stackoverflow.com/users/10711461/stas-chehovskih"}, "edited": false, "score": 0, "creation_date": 1559604935, "post_id": 56435642, "comment_id": 99465633, "body": "didn&#39;t help(( i"}, {"owner": {"reputation": 2345, "user_id": 4988918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/x1BRI.png?s=128&g=1", "display_name": "Mark Merritt", "link": "https://stackoverflow.com/users/4988918/mark-merritt"}, "reply_to_user": {"reputation": 325, "user_id": 10711461, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-x09vFeGc87g/AAAAAAAAAAI/AAAAAAAAHsA/63IliGHyj28/photo.jpg?sz=128", "display_name": "Stas Chehovskih", "link": "https://stackoverflow.com/users/10711461/stas-chehovskih"}, "edited": false, "score": 0, "creation_date": 1559605409, "post_id": 56435642, "comment_id": 99465701, "body": "This issue may have something to do with using <code>import</code> instead of <code>require</code> in <code>application.js</code>"}], "tags": [], "owner": {"reputation": 2345, "user_id": 4988918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/x1BRI.png?s=128&g=1", "display_name": "Mark Merritt", "link": "https://stackoverflow.com/users/4988918/mark-merritt"}, "is_accepted": false, "score": 1, "last_activity_date": 1559604093, "creation_date": 1559604093, "answer_id": 56435642, "question_id": 56435447, "link": "https://stackoverflow.com/questions/56435447/do-not-connected-bootstrap-4-and-jquery-in-ruby-on-rails-6/56435642#56435642", "title": "Do not connected Bootstrap 4 and jQuery in Ruby on Rails 6", "body": "<p>I see a few potential issues...</p>\n\n<ol>\n<li><p>In <code>config/webpack/environment.js</code>...<code>JQuery: 'JQuery'</code> should be <code>JQuery: 'jquery'</code> to match the library name. </p></li>\n<li><p>In <code>app/javascript/packs/application.js</code> you have... </p>\n\n<p><code>import './stylesheets/application.scss'</code> </p>\n\n<p>This should be one level up, so try moving it to a new directory...</p>\n\n<p><code>app/javascript/stylesheets/application.scss</code>  </p>\n\n<p>and changing it to </p>\n\n<p><code>import  '../stylesheets/application.scss'</code></p></li>\n</ol>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 11968231, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/811bc7bb8a0244f76270db322de0a6fc?s=128&d=identicon&r=PG", "display_name": "Vadim", "link": "https://stackoverflow.com/users/11968231/vadim"}, "is_accepted": false, "score": 1, "last_activity_date": 1566579229, "last_edit_date": 1566579229, "creation_date": 1566572752, "answer_id": 57628859, "question_id": 56435447, "link": "https://stackoverflow.com/questions/56435447/do-not-connected-bootstrap-4-and-jquery-in-ruby-on-rails-6/57628859#57628859", "title": "Do not connected Bootstrap 4 and jQuery in Ruby on Rails 6", "body": "<p>You should check out <a href=\"https://www.botreetechnologies.com/blog/introducing-jquery-in-rails-6-using-webpacker\" rel=\"nofollow noreferrer\">this tutorial as an example</a>.</p>\n\n<p><code>config/webpack/environment.js</code>\nshould like like this:</p>\n\n<pre><code>const webpack = require('webpack')\nenvironment.plugins.append(\n  'Provide',\n  new webpack.ProvidePlugin({\n    $: 'jquery/src/jquery',\n    jQuery: 'jquery/src/jquery',\n    Popper: ['popper.js', 'default']\n  })\n)\n</code></pre>\n\n<p>After updating your configuration, restart the server.</p>\n"}], "owner": {"reputation": 325, "user_id": 10711461, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-x09vFeGc87g/AAAAAAAAAAI/AAAAAAAAHsA/63IliGHyj28/photo.jpg?sz=128", "display_name": "Stas Chehovskih", "link": "https://stackoverflow.com/users/10711461/stas-chehovskih"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 973, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1566579229, "creation_date": 1559602373, "last_edit_date": 1559604788, "question_id": 56435447, "link": "https://stackoverflow.com/questions/56435447/do-not-connected-bootstrap-4-and-jquery-in-ruby-on-rails-6", "title": "Do not connected Bootstrap 4 and jQuery in Ruby on Rails 6", "body": "<p>Installed Bootstrap 4 and jQuery, In DevTools errors <a href=\"https://i.stack.imgur.com/JmRwu.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/JmRwu.png\" alt=\"enter image description here\"></a></p>\n\n<p>Stages install:</p>\n\n<p>1 - Executed the console command  <code>yarn add bootstrap@4.3.1 jquery popper.js</code></p>\n\n<p>2 - Added in file config / webpack / environment.js</p>\n\n<pre><code>const {environment} = require ('@ rails / webpacker')\n\nconst webpack = \u0442\u0440\u0435\u0431\u0443\u0435\u0442\u0441\u044f ('webpack')\nenvironment.plugins.append ('\u041e\u0431\u0435\u0441\u043f\u0435\u0447\u0438\u0442\u044c', \u043d\u043e\u0432\u044b\u0439 webpack.ProvidePlugin ({\n  $: 'jquery',\n  JQuery: 'jquery',\n  Popper: ['popper.js', 'default']\n}))\n\nmodule.exports = environment\n</code></pre>\n\n<p>3 - Added in file  app / javascript / packs / application.js</p>\n\n<pre><code>import  'bootstrap' \nimport  '../stylesheets/application.scss'\n</code></pre>\n\n<p>4 - Created folder app/javascript/packs/stylesheets and created file application.scss, write in it <code>@import '~bootstrap/scss/bootstrap';</code></p>\n\n<p>After starting the server, in the developer panel the errors presented above</p>\n\n<p>Used rails 6, ruby 2.6.3, windows 10 </p>\n\n<p>My gemfile:</p>\n\n<pre><code>source 'https://rubygems.org'\ngit_source(:github) { |repo| \"https://github.com/#{repo}.git\" }\n\nruby '2.6.3'\n\n# Bundle edge Rails instead: gem 'rails', github: 'rails/rails'\ngem 'rails', '~&gt; 6.0.0.rc1'\n# Use sqlite3 as the database for Active Record\ngem 'sqlite3', '~&gt; 1.4'\n# Use Puma as the app server\ngem 'puma', '~&gt; 3.11'\n# Use SCSS for stylesheets\ngem 'sass-rails', '~&gt; 5'\n# Transpile app-like JavaScript. Read more: https://github.com/rails/webpacker\ngem 'webpacker', '~&gt; 4.0'\n# Turbolinks makes navigating your web application faster. Read more: https://github.com/turbolinks/turbolinks\ngem 'turbolinks', '~&gt; 5'\n# Build JSON APIs with ease. Read more: https://github.com/rails/jbuilder\ngem 'jbuilder', '~&gt; 2.5'\n# Use Redis adapter to run Action Cable in production\n# gem 'redis', '~&gt; 4.0'\n# Use Active Model has_secure_password\n# gem 'bcrypt', '~&gt; 3.1.7'\n\n# Use Active Storage variant\n# gem 'image_processing', '~&gt; 1.2'\n\n# Reduces boot times through caching; required in config/boot.rb\ngem 'bootsnap', '&gt;= 1.4.2', require: false\n\ngroup :development, :test do\n  # Call 'byebug' anywhere in the code to stop execution and get a debugger console\n  gem 'byebug', platforms: [:mri, :mingw, :x64_mingw]\n\nend\n\ngroup :development do\n  # Access an interactive console on exception pages or by calling 'console' anywhere in the code.\n  gem 'web-console', '&gt;= 3.3.0'\n  gem 'listen', '&gt;= 3.0.5', '&lt; 3.2'\n  # Spring speeds up development by keeping your application running in the background. Read more: https://github.com/rails/spring\n  gem 'spring'\n  gem 'spring-watcher-listen', '~&gt; 2.0.0'\nend\n\ngroup :test do\n  # Adds support for Capybara system testing and selenium driver\n  gem 'capybara', '&gt;= 2.15'\n  gem 'selenium-webdriver'\n  # Easy installation and use of web drivers to run system tests with browsers\n  gem 'webdrivers'\nend\n\n# Windows does not include zoneinfo files, so bundle the tzinfo-data gem\ngem 'tzinfo-data', platforms: [:mingw, :mswin, :x64_mingw, :jruby]\n</code></pre>\n"}, {"tags": ["ruby", "file"], "comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1559600847, "post_id": 56435139, "comment_id": 99464783, "body": "Take a stab at solving this problem. Hint: <code>$stdin.each_line do |line|</code> and go from there."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1559601090, "post_id": 56435139, "comment_id": 99464853, "body": "I assume that <code>&quot;+\\n&quot;</code> is not necessarily the last line of the file. Correct? Is it a particularly large file? The usual way is to open an (empty) &quot;output&quot; file for writing, and read the &quot;input&quot; file a line at a time. If the line does not contain the plus sign, write it to the output file; if is does contain the plus sign, write the 3 specified lines and a line with the plus sign to the output file and then carry on as before. After the last line of the input file has been read and processed, close both files, delete the input file and rename the output file to the name of the input file."}, {"owner": {"reputation": 16237, "user_id": 2166798, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/417356917295f5176d2a3e7c21d8f9e8?s=128&d=identicon&r=PG", "display_name": "pjs", "link": "https://stackoverflow.com/users/2166798/pjs"}, "edited": false, "score": 0, "creation_date": 1559601887, "post_id": 56435139, "comment_id": 99465009, "body": "Can you clarify your question?  I have no idea if what you&#39;re showing is supposed to be input to your program, output on the console, file contents, or what..."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1559612827, "post_id": 56435139, "comment_id": 99466840, "body": "Members are here to help, but their enthusiasm wanes when askers do not respond to comments that ask for clarification of the question."}], "answers": [{"comments": [{"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1559609991, "post_id": 56436031, "comment_id": 99466370, "body": "If you&#39;re going to read the entire file into memory, you might consider just gulping it into a string, replacing &#39;&#39;+&#39;` with the desired string and writing the result to a new file: <code>File.write(outfile, File.read(infile).sub(&#39;+&#39;, ...))</code>."}, {"owner": {"reputation": 1231, "user_id": 2230115, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/sGX51.png?s=128&g=1", "display_name": "iCodeSometime", "link": "https://stackoverflow.com/users/2230115/icodesometime"}, "reply_to_user": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1559610281, "post_id": 56436031, "comment_id": 99466414, "body": "@CarySwoveland that would work, but assumes that there can not be plus signs mixed in with the normal content, and only allows one plus sign.  Doing it procedurally allows him to keep a separate counter or something if he needs to know how many plus signs he&#39;s processed."}, {"owner": {"reputation": 1, "user_id": 10469674, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b5c05d38b35b3e42193808100515d1f1?s=128&d=identicon&r=PG&f=1", "display_name": "Thechemistcoder", "link": "https://stackoverflow.com/users/10469674/thechemistcoder"}, "edited": false, "score": 0, "creation_date": 1559671408, "post_id": 56436031, "comment_id": 99491648, "body": "I have ran into one error. I need it to skip all lines until the plus sign, then, starting at the line after the plus sign, write three lines, then on the next replace the plus sign"}], "tags": [], "owner": {"reputation": 1231, "user_id": 2230115, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/sGX51.png?s=128&g=1", "display_name": "iCodeSometime", "link": "https://stackoverflow.com/users/2230115/icodesometime"}, "is_accepted": true, "score": 0, "last_activity_date": 1559608623, "creation_date": 1559608623, "answer_id": 56436031, "question_id": 56435139, "link": "https://stackoverflow.com/questions/56435139/how-would-i-make-a-program-that-only-prints-to-lines-in-a-file-after-it-reads-a/56436031#56436031", "title": "How would I make a program that only prints to lines in a file after it reads a &quot;+&quot; sign in the file", "body": "<p>You could do something like this:</p>\n\n<pre><code>new_contents = ''\nFile.open('file_name').each do |line|\n  new_contents &lt;&lt; line unless /^\\+/.match line\n  ## Handle the plus sign here. Add whatever content you want\nend\nFile.write('file_name', new_contents)\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 10469674, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b5c05d38b35b3e42193808100515d1f1?s=128&d=identicon&r=PG&f=1", "display_name": "Thechemistcoder", "link": "https://stackoverflow.com/users/10469674/thechemistcoder"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 45, "favorite_count": 0, "closed_date": 1559653353, "accepted_answer_id": 56436031, "answer_count": 1, "score": -3, "last_activity_date": 1559608623, "creation_date": 1559599829, "question_id": 56435139, "link": "https://stackoverflow.com/questions/56435139/how-would-i-make-a-program-that-only-prints-to-lines-in-a-file-after-it-reads-a", "closed_reason": "Needs more focus", "title": "How would I make a program that only prints to lines in a file after it reads a &quot;+&quot; sign in the file", "body": "<p>I need my program to store a lot of login information for different users. I can not get it, however, when it is writing, to only write to the lines after the \"+\" sign.</p>\n\n<p>So, I need it to skip until it see's the plus sign in the file, then, on the next three lines, put data in the file, then on the fourth line put the plus sign, and remove it from it's original location.</p>\n\n<p>I have tried absolutely everything that involves that part of the code.</p>\n\n<p>It needs to work like this </p>\n\n<p>Run #1</p>\n\n<pre><code>bla\nbla\nbla\n+\n</code></pre>\n\n<p>Run #2</p>\n\n<pre><code>bla\nbla\nbla\n\nbla\nbla\nbla\n+\n\n\nI want this thing to finally work.\n</code></pre>\n"}, {"tags": ["ruby", "selenium-webdriver", "capybara"], "comments": [{"owner": {"reputation": 42014, "user_id": 2709090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/238c2b7cde2c817fc9a5a2b8eaa2ffad?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Walpole", "link": "https://stackoverflow.com/users/2709090/thomas-walpole"}, "edited": false, "score": 1, "creation_date": 1559599580, "post_id": 56435053, "comment_id": 99464413, "body": "Generally you want to fill a text field with a string so <code>name = &quot;129923823184&quot;</code> - other than that what you&#39;re doing is exactly correct (assuming <code>text_field</code> matches the name, id, placeholder, or associated label text of the text field.  If it&#39;s not working for you edit your question and provide the exact error you&#39;re getting, along with the html of the element you&#39;re trying to fill in."}, {"owner": {"reputation": 60, "user_id": 10802314, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-4snMgcSZjWo/AAAAAAAAAAI/AAAAAAAANxM/1lc6gCj10mc/photo.jpg?sz=128", "display_name": "holyonline", "link": "https://stackoverflow.com/users/10802314/holyonline"}, "reply_to_user": {"reputation": 42014, "user_id": 2709090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/238c2b7cde2c817fc9a5a2b8eaa2ffad?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Walpole", "link": "https://stackoverflow.com/users/2709090/thomas-walpole"}, "edited": false, "score": 0, "creation_date": 1559620211, "post_id": 56435053, "comment_id": 99468053, "body": "Omg, so the method is correct? I&#39;m shocked hahahahaha. Well, I edit and post the entire code. Thanks again Thomas!"}], "answers": [{"comments": [{"owner": {"reputation": 60, "user_id": 10802314, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-4snMgcSZjWo/AAAAAAAAAAI/AAAAAAAANxM/1lc6gCj10mc/photo.jpg?sz=128", "display_name": "holyonline", "link": "https://stackoverflow.com/users/10802314/holyonline"}, "edited": false, "score": 0, "creation_date": 1559652872, "post_id": 56437821, "comment_id": 99482151, "body": "Thanks for ur hints and thanks for that scope link! It worked! I just learning by myself so it&#39;s kinda hard sometimes hahahahaah"}], "tags": [], "owner": {"reputation": 42014, "user_id": 2709090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/238c2b7cde2c817fc9a5a2b8eaa2ffad?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Walpole", "link": "https://stackoverflow.com/users/2709090/thomas-walpole"}, "is_accepted": true, "score": 0, "last_activity_date": 1559626169, "creation_date": 1559626169, "answer_id": 56437821, "question_id": 56435053, "link": "https://stackoverflow.com/questions/56435053/using-text-variable-to-fill-text-field-how/56437821#56437821", "title": "Using text variable to fill text field, how?", "body": "<p>Tests are isolated from one another, and are also separate methods. You can't assign a local variable in one method and access it in another because they're not the same scope - <a href=\"https://www.sitepoint.com/understanding-scope-in-ruby/\" rel=\"nofollow noreferrer\">https://www.sitepoint.com/understanding-scope-in-ruby/</a>.  You can however access instance variables from before blocks (because they're assigned on the test instance).  You either need to get the value inside the test block where you use it or if you want that value in multiple tests you can use a <code>before(:each)</code> or <code>before(:all)</code> depending on whether you want it calculated for every test or just once (the just once is generally not a great idea because it can lead to test coupling if the value is changed inside a test)</p>\n\n<pre><code>describe 'test' do\n  before(:each) do\n    visit 'https://www.submarino.com.br/'\n\n    livro = page.first('img[alt~=\"Livro\"]').click\n\n    nome = page.find('#product-name-default').text\n    puts nome\n\n    autor = find('table tbody tr', text: 'Autor').text\n    puts autor\n\n    @isbn = find('table tbody tr', text: 'ISBN-13').text\n    puts @isbn\n  end\n\n  it 'teste1' do \n    visit 'https://www.americanas.com.br/'\n\n    fill_in 'h_search-input',   with: @isbn\n    click_button 'h_search-btn'\n    # Add whatever expectation you are testing for here\n  end\n\n  it 'teste2' do \n    visit 'https://www.amazon.com.br/'\n\n    ... # do something using @isbn\n  end\nend\n</code></pre>\n"}], "owner": {"reputation": 60, "user_id": 10802314, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-4snMgcSZjWo/AAAAAAAAAAI/AAAAAAAANxM/1lc6gCj10mc/photo.jpg?sz=128", "display_name": "holyonline", "link": "https://stackoverflow.com/users/10802314/holyonline"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 121, "favorite_count": 0, "closed_date": 1559651516, "accepted_answer_id": 56437821, "answer_count": 1, "score": 0, "last_activity_date": 1559665025, "creation_date": 1559599220, "last_edit_date": 1559665025, "question_id": 56435053, "link": "https://stackoverflow.com/questions/56435053/using-text-variable-to-fill-text-field-how", "closed_reason": "Not suitable for this site", "title": "Using text variable to fill text field, how?", "body": "<p>I'm trying to use a variable to fill a text field. It's possible to do this with Capybara? Edit: Now with code and failure too, sorry guys.</p>\n\n<pre><code>  describe 'test' do\n\nit 'test0' do\n    visit 'https://www.submarino.com.br/'\n\n    livro = page.first('img[alt~=\"Livro\"]').click\n\n    nome = page.find('#product-name-default').text\n    puts nome\n\n    autor = find('table tbody tr', text: 'Autor').text\n    puts autor\n\n    isbn = find('table tbody tr', text: 'ISBN-13').text\n    puts isbn\n\nend\n\nit 'teste1' do \n    visit 'https://www.americanas.com.br/'\n\n    fill_in 'h_search-input',   with: isbn  **# &lt;- here is the error**\n    click_button 'h_search-btn'\n\nend\n\nit 'teste2' do \n    visit 'https://www.amazon.com.br/'\nend\nend\n</code></pre>\n\n<p>HTML element</p>\n\n<pre><code>&lt;input id=\"h_search-input\" class=\"src-input\" type=\"text\" name=\"conteudo\" placeholder=\"tem tuuudo, pode procurar :)\" autocomplete=\"off\" tabindex=\"2\" value=\"\"&gt;\n</code></pre>\n\n<p>Failure get:</p>\n\n<pre><code>Failures:\n\n1) teste teste1\n Failure/Error: fill_in 'h_search-input',   with: isbn\n\n NameError:\n   undefined local variable or method `isbn' for #&lt;RSpec::ExampleGroups::Teste \"teste1\" (./spec/teste_spec.rb:23)&gt;\n # ./spec/teste_spec.rb:27:in `block (2 levels) in &lt;top (required)&gt;'\n</code></pre>\n\n<p>Thanks for your time!</p>\n"}, {"tags": ["ruby", "shell", "concurrency", "fork"], "comments": [{"owner": {"reputation": 51929, "user_id": 1084774, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/13403db744d8aa130bb317576cc1df30?s=128&d=identicon&r=PG", "display_name": "PSkocik", "link": "https://stackoverflow.com/users/1084774/pskocik"}, "edited": false, "score": 0, "creation_date": 1559593457, "post_id": 56433965, "comment_id": 99462430, "body": "<code>Ctrl+C</code> should be equivalent to a <code>SIGINT</code> kill of the foreground process group. I&#39;d try <code>Process.kill &#39;INT&#39;, -@pgid</code>."}, {"owner": {"reputation": 1231, "user_id": 2230115, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/sGX51.png?s=128&g=1", "display_name": "iCodeSometime", "link": "https://stackoverflow.com/users/2230115/icodesometime"}, "edited": false, "score": 0, "creation_date": 1559598497, "post_id": 56433965, "comment_id": 99464114, "body": "Does <code>kill -INT &lt;pid&gt;</code> work from bash? Once you start it from the ruby script"}], "owner": {"reputation": 772, "user_id": 825421, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/a7829960ae6e33e8aac0af44251b0877?s=128&d=identicon&r=PG", "display_name": "Jedidiah Hurt", "link": "https://stackoverflow.com/users/825421/jedidiah-hurt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 104, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1559593262, "creation_date": 1559592826, "last_edit_date": 1559593262, "question_id": 56433965, "link": "https://stackoverflow.com/questions/56433965/simulate-ctrlc-press-send-sigint-to-child-process", "title": "Simulate ctrl+c press / send &#39;SIGINT&#39; to child process", "body": "<p>What's wrong with this code? I am trying to send a <code>SIGINT</code> to the child process to allow <code>gst-launch-1.0</code> to exit gracefully once recording is done:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>@pid = fork {\n  exec(\"gst-launch-1.0 -e v4l2src device=/dev/video0 ! videoconvert ! vaapih264enc rate-control=vbr bitrate=10000 quality-level=4 keyframe-period=30 num-slices=1 refs=1 max-bframes=2 ! queue ! mux. alsasrc ! audio/x-raw,width=16,depth=16,rate=44100,channel=1 ! audioconvert ! audioresample ! voaacenc ! aacparse ! queue ! mp4mux name=mux ! filesink location='/tmp/test-010.mp4' sync=false\")\n}\nsleep 5\nputs 'Killing child process and waiting...'\nProcess.kill 'INT', @pid\nProcess.wait\n</code></pre>\n\n<p>As you can see, I issue <code>Process.kill 'INT', @pid</code>, which, as far as I know, should be the same as pressing <code>ctrl+c</code> when running the <code>gst-launch-1.0</code> command (or any CLI command) directly.</p>\n\n<p>But the output from the Ruby script is thus:</p>\n\n<pre><code>Setting pipeline to PAUSED ...\nPipeline is live and does not need PREROLL ...\nGot context from element 'vaapiencodeh264-0': gst.vaapi.Display=context, gst.vaapi.Display=(GstVaapiDisplay)\"\\(GstVaapiDisplayGLX\\)\\ vaapidisplayglx0\";\nSetting pipeline to PLAYING ...\nNew clock: GstAudioSrcClock\nRedistribute latency...\nKilling child process and waiting...\n</code></pre>\n\n<p>And the script just hangs. Basically, it appears that the <code>Process.kill</code> call is not doing anything, or at least the signal isn't reaching the child process. What's wrong with my code?</p>\n\n<p>For reference, here is what happens when I do run the <code>gst-launch-1.0</code> command directly from the CLI and press <code>ctrl+c</code> after a bit:</p>\n\n<pre><code>gst-launch-1.0 -e v4l2src device=/dev/video0 ! videoconvert ! vaapih264enc rate-control=vbr bitrate=10000 quality-level=4 keyframe-period=30 num-slices=1 refs=1 max-bframes=2 ! mp4mux name=mux ! filesink location=test-006.mp4 sync=false\nSetting pipeline to PAUSED ...\nPipeline is live and does not need PREROLL ...\nGot context from element 'vaapiencodeh264-0': gst.vaapi.Display=context, gst.vaapi.Display=(GstVaapiDisplay)\"\\(GstVaapiDisplayGLX\\)\\ vaapidisplayglx0\";\nSetting pipeline to PLAYING ...\nNew clock: GstSystemClock\n</code></pre>\n\n<p>And the capture is now in progress.</p>\n\n<p>I press <code>ctrl+c</code> when I'm ready to end the capture, and the output looks like this:</p>\n\n<pre><code>^Chandling interrupt.\nInterrupt: Stopping pipeline ...\nEOS on shutdown enabled -- Forcing EOS on the pipeline\nWaiting for EOS...\nGot EOS from element \"pipeline0\".\nEOS received - stopping pipeline...\nExecution ended after 0:00:08.524849001\nSetting pipeline to PAUSED ...\nSetting pipeline to READY ...\nSetting pipeline to NULL ...\nFreeing pipeline ...\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "authentication", "devise", "registration"], "comments": [{"owner": {"reputation": 2345, "user_id": 4988918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/x1BRI.png?s=128&g=1", "display_name": "Mark Merritt", "link": "https://stackoverflow.com/users/4988918/mark-merritt"}, "edited": false, "score": 1, "creation_date": 1559592531, "post_id": 56433607, "comment_id": 99462115, "body": "Did you set it as a <code>before_action</code> in <code>application_controller</code>? i.e. <code>before_action :find_all_tags</code>"}, {"owner": {"reputation": 31, "user_id": 9980298, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b1f0dbd1a03fd921f4c8c32ec81ff0a3?s=128&d=identicon&r=PG&f=1", "display_name": "ogAndrew", "link": "https://stackoverflow.com/users/9980298/ogandrew"}, "reply_to_user": {"reputation": 2345, "user_id": 4988918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/x1BRI.png?s=128&g=1", "display_name": "Mark Merritt", "link": "https://stackoverflow.com/users/4988918/mark-merritt"}, "edited": false, "score": 0, "creation_date": 1559593904, "post_id": 56433607, "comment_id": 99462627, "body": "haha, that was the issue.  Can&#39;t believe I didn&#39;t see that.  Thanks!"}], "owner": {"reputation": 31, "user_id": 9980298, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b1f0dbd1a03fd921f4c8c32ec81ff0a3?s=128&d=identicon&r=PG&f=1", "display_name": "ogAndrew", "link": "https://stackoverflow.com/users/9980298/ogandrew"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 33, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1559591812, "creation_date": 1559590911, "question_id": 56433607, "link": "https://stackoverflow.com/questions/56433607/devise-gem-nomethoderror", "title": "Devise gem NoMethodError", "body": "<p>I'm trying to implement Devise into my project, but after doing all the installation steps for devise when I try to visit the endpoint users/sign_up I get the error: </p>\n\n<p>NoMethodError in Devise::Registrations#new</p>\n\n<pre><code>    &lt;%= link_to \"View All\", tags_path, class: \"item\" %&gt;\n    &lt;% @tags.each do |tag| %&gt;\n      &lt;%= link_to tag.name, tag_path(tag), class: \"item\" %&gt;\n    &lt;% end %&gt;\n    &lt;%= link_to \"Create New\", new_tag_path, class: \"item\" %&gt;\n</code></pre>\n\n<p>I tried adding a method to my application controller to bring my tag model access global, but that hasn't solved the nilClass issue still. I'm using rails 5.2, devise 4.2</p>\n\n<p>This bit of code that is making rails act up lives on my navbar, which I have living in the application.html.erb file.  I made a global tags method in my application controller to solve this, but to no avail. </p>\n\n<pre><code>\n  def find_all_tags\n        @tags = Tag.all\n    end\nend\n</code></pre>\n"}, {"tags": ["ruby", "email", "imap", "multipart"], "answers": [{"tags": [], "owner": {"reputation": 51, "user_id": 10131405, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/219e9d4b07480ad01d68aaf4ec7ee865?s=128&d=identicon&r=PG&f=1", "display_name": "Hans", "link": "https://stackoverflow.com/users/10131405/hans"}, "is_accepted": false, "score": 0, "last_activity_date": 1587672170, "creation_date": 1587672170, "answer_id": 61395996, "question_id": 56433582, "link": "https://stackoverflow.com/questions/56433582/ruby-imap-multipart-fetch/61395996#61395996", "title": "Ruby Imap Multipart Fetch", "body": "<p>You would be better off asking for the specific part number in a follow-on <code>fetch &lt;msgno&gt; body[&lt;partnum&gt;]</code> imap request.  This returns the actual mime part and not just the body text with the MIME encodings.</p>\n\n<p>Eg, I use the following loop to retreive messages into <code>mime_parts</code> (assume <code>@imap</code> is your already established imap client):</p>\n\n<pre><code>  new_msgs = @imap.uid_search('UNSEEN')\n  puts \"Found #{new_msgs.size} new messages\"\n  new_msgs.each do |msg_uid|\n    msgs = @imap.uid_fetch(msg_uid, ['BODY', 'FLAGS', 'ENVELOPE'])\n    raise \"unexpected number of messages, count=#{msgs.size}\" if msgs.size &gt; 1\n    @imap.uid_store(msg_uid, '+FLAGS', [:Seen]).inspect\n    msg = msgs.first\n    body = msg.attr['BODY']\n    if body.media_type.eql?('MULTIPART')\n      mime_parts = []\n      body.parts.each.with_index do |part, idx|\n        body_part = \"BODY[#{idx+1}]\"\n        fetch_part = @imap.uid_fetch(msg_uid, body_part)\n        mime_parts &lt;&lt; part.to_h.merge!({content: fetch_part.first.attr[body_part]})\n      end\n    else\n      fetch_text = @imap.uid_fetch(msg_uid, 'BODY[TEXT]')\n      mime_parts = [{\n          media_type: 'TEXT', subtype: 'PLAIN',\n          content: fetch_text.first.attr['BODY[TEXT]']\n        }]\n    end\n  end\n</code></pre>\n\n<p>You can then iterate over your mime_parts and do whatever you please with them.</p>\n"}], "owner": {"reputation": 1, "user_id": 11091589, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-lY8K-7iNats/AAAAAAAAAAI/AAAAAAAAAk8/eLUHEz-LKUo/photo.jpg?sz=128", "display_name": "Alexander Varej&#227;o", "link": "https://stackoverflow.com/users/11091589/alexander-varej%c3%a3o"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 109, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1587672170, "creation_date": 1559590788, "last_edit_date": 1559591279, "question_id": 56433582, "link": "https://stackoverflow.com/questions/56433582/ruby-imap-multipart-fetch", "title": "Ruby Imap Multipart Fetch", "body": "<p>I trying use the Ruby IMAP library (\"net/imap\") to get email. I get messages with html and text plain but I need the text plain only ...</p>\n\n<p>My Code Is ...</p>\n\n<pre><code>imap = Net::IMAP.new('XXX')\n\nimap.authenticate('LOGIN', 'USER', \"PASS\") imap.examine('INBOX') \n\nimap.search(['UNSEEN']).each do |message_id| \n\n  body = imap.fetch(message_id,'BODY[TEXT]')[0].attr['BODY[TEXT]'] \n\n  puts body \n\nend\n</code></pre>\n\n<p>Here I get</p>\n\n<blockquote>\n  <p>--57887f32df9433962df2d01c44487353c74c0f6d2b9721d30fc189fadae2 Content-Type: text/plain; charset=UTF-8</p>\n  \n  <p>Summary: XXX description: XXX.</p>\n  \n  <p>--57887f32df9433962df2d01c44487353c74c0f6d2b9721d30fc189fadae2--</p>\n</blockquote>\n\n<p>But I need just</p>\n\n<blockquote>\n  <p>Summary: XXX description: XXX.</p>\n</blockquote>\n\n<p>How could I get it without require \"mail\"</p>\n\n<p>Regards</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "heroku", "bundler", "ruby-on-rails-6"], "comments": [{"owner": {"reputation": 91778, "user_id": 354577, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/dI6cA.jpg?s=128&g=1", "display_name": "Chris", "link": "https://stackoverflow.com/users/354577/chris"}, "edited": false, "score": 0, "creation_date": 1559605514, "post_id": 56433384, "comment_id": 99465713, "body": "I guess you know that Rails 6 hasn&#39;t been released yet (and therefore Rails 6.0 doesn&#39;t actually exist)?"}], "answers": [{"tags": [], "owner": {"reputation": 815, "user_id": 4803880, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/zf4gI.png?s=128&g=1", "display_name": "thiebo", "link": "https://stackoverflow.com/users/4803880/thiebo"}, "is_accepted": false, "score": 1, "last_activity_date": 1559630040, "creation_date": 1559630040, "answer_id": 56438515, "question_id": 56433384, "link": "https://stackoverflow.com/questions/56433384/rails-6-deploy-to-heroku-using-bundler-2-but-still-craches/56438515#56438515", "title": "Rails 6 deploy to Heroku, using bundler 2, but still craches", "body": "<p>Got great support from Heroku on this. I needed to change the name of <code>procfile</code> (all lower case) to <code>Procfile</code> with capital C. </p>\n\n<p>In addition to the link I gave in my question, have a look here too : </p>\n\n<p><a href=\"https://devcenter.heroku.com/articles/bundler-version#known-upgrade-issues\" rel=\"nofollow noreferrer\">https://devcenter.heroku.com/articles/bundler-version#known-upgrade-issues</a></p>\n\n<p>Hope this helps,</p>\n"}], "owner": {"reputation": 815, "user_id": 4803880, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/zf4gI.png?s=128&g=1", "display_name": "thiebo", "link": "https://stackoverflow.com/users/4803880/thiebo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 200, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1559630040, "creation_date": 1559589701, "last_edit_date": 1559597651, "question_id": 56433384, "link": "https://stackoverflow.com/questions/56433384/rails-6-deploy-to-heroku-using-bundler-2-but-still-craches", "title": "Rails 6 deploy to Heroku, using bundler 2, but still craches", "body": "<p>I updated from Rails 5.2 to Rails 6.0. The upgrade issues on heroku are known:</p>\n\n<p><a href=\"https://devcenter.heroku.com/articles/bundler-version#known-upgrade-issues\" rel=\"nofollow noreferrer\">heroku docs</a></p>\n\n<p>Upon deploy:</p>\n\n<pre><code>remote: -----&gt; Using Ruby version: ruby-2.6.1\nremote: -----&gt; Installing dependencies using bundler 2.0.1\n</code></pre>\n\n<p>In <code>Gemfile.lock</code>: (of course I also updated bundler locally)</p>\n\n<pre><code>bundler (2.0.1)\n</code></pre>\n\n<p>in <code>procfile</code></p>\n\n<pre><code>web: bundle exec bin/rails server -p $PORT -e $RAILS_ENV\n</code></pre>\n\n<p>Deleted Gemfile.lock and rerun <code>bundle update</code> and redeployed to heroku, but still getting this error, <em>where it says I'm using ruby 2.6.0 : problem is probably here, but don't know how to correct it :</em></p>\n\n<pre><code>2019-06-03T19:04:00.924967+00:00 app[web.1]: /app/vendor/bundle/ruby/2.6.0/gems/bundler-2.0.1/lib/bundler/lockfile_parser.rb:108:in `warn_for_outdated_bundler_version': You must use Bundler 2 or greater with this lockfile. (Bundler::LockfileError)\n</code></pre>\n\n<p>In the deploy messages also:</p>\n\n<pre><code>2019-06-03T19:04:00.925009+00:00 app[web.1]: from /app/config/boot.rb:3:in `&lt;top (required)&gt;'\n</code></pre>\n\n<p>Heroku indicates: <a href=\"https://devcenter.heroku.com/changelog-items/1563\" rel=\"nofollow noreferrer\">https://devcenter.heroku.com/changelog-items/1563</a></p>\n\n<p>and in my <code>Gemfile.lock</code> I have:</p>\n\n<pre><code>RUBY VERSION\n   ruby 2.6.1p33\n\nBUNDLED WITH\n   2.0.1\n</code></pre>\n\n<p>Still, the app crashed on heroku. </p>\n"}, {"tags": ["ruby", "syntax"], "answers": [{"comments": [{"owner": {"reputation": 152277, "user_id": 438992, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/QouOz.jpg?s=128&g=1", "display_name": "Dave Newton", "link": "https://stackoverflow.com/users/438992/dave-newton"}, "edited": false, "score": 0, "creation_date": 1559587640, "post_id": 56432946, "comment_id": 99460325, "body": "Yup, <code>(x\\n - 100)</code> will be parsed as two expressions, hence returning the last."}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "reply_to_user": {"reputation": 152277, "user_id": 438992, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/QouOz.jpg?s=128&g=1", "display_name": "Dave Newton", "link": "https://stackoverflow.com/users/438992/dave-newton"}, "edited": false, "score": 0, "creation_date": 1559588193, "post_id": 56432946, "comment_id": 99460550, "body": "@DaveNewton Since <code>-</code> is simply a method call the <code>Object</code> represented by <code>x</code>, we can correct this by explicitly making a method call via <code>(x\\n .-(100) )</code> Same applies to tadman&#39;s final note."}, {"owner": {"reputation": 152277, "user_id": 438992, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/QouOz.jpg?s=128&g=1", "display_name": "Dave Newton", "link": "https://stackoverflow.com/users/438992/dave-newton"}, "reply_to_user": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1559589198, "post_id": 56432946, "comment_id": 99460870, "body": "@engineersmnky <i>Could</i> ;)"}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "reply_to_user": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1559598337, "post_id": 56432946, "comment_id": 99464069, "body": "@engineersmnky Pretty sure <a href=\"https://www.github.com/rubocop-hq/rubocop\" rel=\"nofollow noreferrer\">Rubocop</a> will bash down your door and tell you to step away from the keyboard if you do that."}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 1, "creation_date": 1559599348, "post_id": 56432946, "comment_id": 99464352, "body": "@tadman pretty sure if I wanted to be told how to use whitespace I&#39;d use python \ud83d\ude04"}], "tags": [], "owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "is_accepted": true, "score": 8, "last_activity_date": 1559587789, "last_edit_date": 1559587789, "creation_date": 1559587599, "answer_id": 56432946, "question_id": 56432834, "link": "https://stackoverflow.com/questions/56432834/how-important-is-whitespace-inside-parens-in-ruby/56432946#56432946", "title": "How important is whitespace inside parens in Ruby?", "body": "<p>It's an unusual case here but I believe what you're seeing is Ruby interpreting that as several <em>consecutive statements</em> and not a single statement. As in it sees that as:</p>\n\n<pre><code>x    # Statement 1\n-100 # Statement 2\n</code></pre>\n\n<p>Where the result of that block of code is <code>-100</code>.</p>\n\n<p>In the case of <code>zot</code> you've expressed your intent to continue that line on the next by having a dangling <code>-</code> binary operator:</p>\n\n<pre><code>x - # Statement 1\n100 # Statement 1 (cont)\n</code></pre>\n\n<p>It's worth noting that you can't do this when making method calls:</p>\n\n<pre><code>zot(x\n -100  # Syntax error\n)\n</code></pre>\n\n<p>As in that case the argument syntax rules are a lot more strict. Inside a free-form <code>(...)</code> structure you have considerably more latitude.</p>\n"}, {"tags": [], "owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "is_accepted": false, "score": 4, "last_activity_date": 1559589260, "creation_date": 1559589260, "answer_id": 56433296, "question_id": 56432834, "link": "https://stackoverflow.com/questions/56432834/how-important-is-whitespace-inside-parens-in-ruby/56433296#56433296", "title": "How important is whitespace inside parens in Ruby?", "body": "<p>In Ruby, there are two possible expression separators: semicolon <code>;</code> and newline.</p>\n\n<p>So, </p>\n\n<pre><code>a\nb\n</code></pre>\n\n<p>is the same as </p>\n\n<pre><code>a; b\n</code></pre>\n\n<p>Which means that </p>\n\n<pre><code>a\n- b\n</code></pre>\n\n<p>is the same as </p>\n\n<pre><code>a; - b\n</code></pre>\n\n<p>which is the same as </p>\n\n<pre><code>a; b.-@()\n</code></pre>\n\n<p>Of course, you expected it to be equivalent to </p>\n\n<pre><code>a - b\n</code></pre>\n\n<p>which is the same as </p>\n\n<pre><code>a.-(b)\n</code></pre>\n\n<p>The point is: each of those two interpretations is equally valid. The language designer has to choose one of those two interpretations, and in this case, they chose the first one. Neither of the two is more \"right\" or more \"correct\".</p>\n\n<p>If they had chosen the second interpretation, then you wouldn't have asked this question, but someone else would have asked the opposite one.</p>\n"}], "owner": {"reputation": 52286, "user_id": 850781, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/pwfBo.jpg?s=128&g=1", "display_name": "sds", "link": "https://stackoverflow.com/users/850781/sds"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 58, "favorite_count": 0, "accepted_answer_id": 56432946, "answer_count": 2, "score": 2, "last_activity_date": 1559589260, "creation_date": 1559587132, "question_id": 56432834, "link": "https://stackoverflow.com/questions/56432834/how-important-is-whitespace-inside-parens-in-ruby", "title": "How important is whitespace inside parens in Ruby?", "body": "<p>I just discovered that whitespace inside parens can matter in Ruby in an unexpected way:\nHere are 3 functions which look semantically identical to me:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>def foo(x)\n     return {\n      :a =&gt; (x - 100),\n    }\nend\n\ndef bar(x)\n     return {\n       :a =&gt; (x\n              - 100),\n    }\nend\n\ndef zot(x)\n     return {\n       :a =&gt; (x -\n              100),\n    }\nend\n</code></pre>\n\n<p>However, <code>foo(10)</code> and <code>zot(10)</code> return <code>{:a=&gt;-90}</code> (as I expected) while <code>bar(10)</code> returns <code>{:a=&gt;-100}</code> (to my dismay and disappointment).</p>\n\n<p>What am I missing here?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "sidekiq", "rails-activestorage"], "owner": {"reputation": 41, "user_id": 1402605, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b73bdea8d84fdbd14a8a86d995dfe5bc?s=128&d=identicon&r=PG&f=1", "display_name": "m10i", "link": "https://stackoverflow.com/users/1402605/m10i"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 480, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1559582913, "creation_date": 1559582913, "question_id": 56432011, "link": "https://stackoverflow.com/questions/56432011/activestorageblob-how-to-make-sure-that-analyzed-metadata-always-has-width", "title": "ActiveStorage::Blob: How to make sure that `analyzed` metadata always has &quot;width&quot;/&quot;height&quot; attributes?", "body": "<h3>Steps to reproduce</h3>\n\n<p>Create a model with an Active Storage (S3) image attachment (a .png in my case). Using the default <code>active_storage_analysis</code></p>\n\n<h3>Expected behavior</h3>\n\n<p>Since all I did was call the <code>analyze</code> method (which I assume is what's being called the first time around when an attachment is made), I expect it to originally have the width/height attributes.</p>\n\n<h3>Actual behavior</h3>\n\n<p>The Blob metadata is missing its width/height attributes:</p>\n\n<pre><code>#&lt;ActiveStorage::Blob:0x00007fb934129130\n id: \"d6d6922a-646f-446f-8656-b1301ca5ba59\",\n key: \"dm46dnva9crgu9k1r9y4bwmhz3oi\",\n filename: \"Cheddah_icon-60@3x.png\",\n content_type: \"image/png\",\n metadata: {\"identified\"=&gt;true, \"analyzed\"=&gt;true},\n byte_size: 3559,\n checksum: \"x+EHSQeB6l3Kvb+8SCMzxg==\",\n created_at: Mon, 03 Jun 2019 14:56:13 UTC +00:00&gt;\n</code></pre>\n\n<p>I then manually analyze the Blob by invoking the <code>analyze</code> method on it. It now has the width/height:</p>\n\n<pre><code>#&lt;ActiveStorage::Blob:0x00007fb934129130\n id: \"d6d6922a-646f-446f-8656-b1301ca5ba59\",\n key: \"dm46dnva9crgu9k1r9y4bwmhz3oi\",\n filename: \"Cheddah_icon-60@3x.png\",\n content_type: \"image/png\",\n metadata: {\"identified\"=&gt;true, \"analyzed\"=&gt;true, \"width\"=&gt;180, \"height\"=&gt;180},\n byte_size: 3559,\n checksum: \"x+EHSQeB6l3Kvb+8SCMzxg==\",\n created_at: Mon, 03 Jun 2019 14:56:13 UTC +00:00&gt;\n</code></pre>\n\n<h3>System configuration</h3>\n\n<p><strong>Rails version</strong>: 6.0.0.rc1</p>\n\n<p><strong>Ruby version</strong>: 2.6.2p47 (2019-03-13 revision 67232)</p>\n\n<h3>Extra info</h3>\n\n<ul>\n<li>I'm using Sidekiq <code>v5.2.7</code></li>\n<li>(not sure if relevant) my Variant Processor is VIPS:</li>\n</ul>\n\n<pre><code>image_processing (1.9.0)\n      mini_magick (&gt;= 4.9.3, &lt; 5)\n      ruby-vips (&gt;= 2.0.13, &lt; 3)\n</code></pre>\n\n<p>I'm aware that I can just create background jobs to do this every time the model is saved, but according to all the documentation I've been able to find, I shouldn't need to do this manually right?</p>\n\n<p>Thank you for your help</p>\n"}, {"tags": ["ruby", "rspec", "mocking"], "comments": [{"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1559579995, "post_id": 56431332, "comment_id": 99457265, "body": "seems like <code>mocha</code> since you are using <code>mock</code>. Also what is <code>any_instance_of</code>? I do not see an expectation here and &quot;no joy&quot; is not very explanatory as to the issue so this question is somewhat confusing."}, {"owner": {"reputation": 2100, "user_id": 247806, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/f170caf69a98078819d91ddf2f17f2f9?s=128&d=identicon&r=PG", "display_name": "Justin Leveck", "link": "https://stackoverflow.com/users/247806/justin-leveck"}, "edited": false, "score": 0, "creation_date": 1559625186, "post_id": 56431332, "comment_id": 99469090, "body": "This answer might be helpful to you <a href=\"https://stackoverflow.com/a/33130513/247806\">stackoverflow.com/a/33130513/247806</a>"}], "owner": {"reputation": 23, "user_id": 2475306, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/db41f879b148b50b8c66a9fb8268d283?s=128&d=identicon&r=PG", "display_name": "user2475306", "link": "https://stackoverflow.com/users/2475306/user2475306"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 36, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1559579683, "creation_date": 1559579683, "question_id": 56431332, "link": "https://stackoverflow.com/questions/56431332/how-do-you-mock-more-than-two-times-in-rspec", "title": "How do you mock more than two times in rspec?", "body": "<p>Within an any_instance_of block, for example:</p>\n\n<pre><code>any_instance_of Tenancy do |tenancy|\n   mock(Tenancy).update_checkout_booking.twice\nend\n</code></pre>\n\n<p>how could I test that it runs three or more times? Using .never, .once, and .twice all work fine.</p>\n\n<p>But to test three times I've tried .thrice, .exactly(3).times, and no joy.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "google-cloud-platform", "ruby-on-rails-6"], "answers": [{"comments": [{"owner": {"reputation": 7768, "user_id": 1213273, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/cf372446eb8bcca32373052e4dda2164?s=128&d=identicon&r=PG", "display_name": "Severin", "link": "https://stackoverflow.com/users/1213273/severin"}, "edited": false, "score": 0, "creation_date": 1559592890, "post_id": 56431142, "comment_id": 99462225, "body": "Thank you for the link :+1:"}], "tags": [], "owner": {"reputation": 5312, "user_id": 6535997, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/10156345016155058/picture?type=large", "display_name": "Mark", "link": "https://stackoverflow.com/users/6535997/mark"}, "is_accepted": true, "score": 0, "last_activity_date": 1559578848, "creation_date": 1559578848, "answer_id": 56431142, "question_id": 56430757, "link": "https://stackoverflow.com/questions/56430757/run-rails-c-on-gcloud-instace-with-appengine-gem/56431142#56431142", "title": "Run `rails c` on GCloud instace with appengine gem", "body": "<p>There's a few steps involved:</p>\n\n<p><a href=\"https://gist.github.com/kyptin/e5da270a54abafac2fbfcd9b52cafb61\" rel=\"nofollow noreferrer\">https://gist.github.com/kyptin/e5da270a54abafac2fbfcd9b52cafb61</a></p>\n\n<blockquote>\n  <p>If you're running a Rails app in Google App Engine's flexible environment, it takes a bit of setup to get to a rails console attached to your deployed environment. I wanted to document the steps for my own reference and also as an aid to others.</p>\n  \n  <p>Open the Google App Engine -> instances section of the Google Cloud Platform (GCP) console.</p>\n  \n  <p>Select the \"SSH\" drop-down for a running instance. (Which instance? Both of my instances are in the same cluster, and both are running Rails, so it didn't matter for me. YMMV.) You have a choice about how to connect via ssh.</p>\n  \n  <p>Choose \"Open in browser window\" to open a web-based SSH session, which is convenient but potentially awkward.</p>\n  \n  <p>Choose \"View gcloud command\" to view and copy a gcloud command that you can use from a terminal, which lets you use your favorite terminal app but may require the extra steps of installing the gcloud command and authenticating the gcloud command with GCP.</p>\n  \n  <p>When you're in the SSH session of your choice, run sudo docker ps to see what docker containers are presently running.</p>\n  \n  <p>Identify the container of your app. Here's what my output looked like (abbreviated for easier reading). My app's container was the first one.</p>\n  \n  <p>jeff@aef-default-425eaf...hvj:~$ sudo docker ps\n  CONTAINER ID   IMAGE                                       COMMAND                  NAMES\n  38e......552   us.gcr.io/my-project/appengine/default...   \"/bin/sh -c 'exec bun\"   gaeapp\n  8c0......0ab   gcr.io/google_appengine/cloud-sql-proxy     \"/cloud_sql_proxy -di\"   focused_lalande\n  855......f92   gcr.io/google_appengine/api-proxy           \"/proxy\"                 api\n  7ce......0ce   gcr.io/google_appengine/nginx-proxy         \"/var/lib/nginx/bin/s\"   nginx_proxy\n  25f......bb8   gcr.io/google_appengine/fluentd-logger      \"/opt/google-fluentd/\"   fluentd_logger\n  Note the container name of your app (gaeapp in my case), and run container_exec  bash.</p>\n  \n  <p>Add ruby and node to your environment: export PATH=$PATH:/rbenv/versions/2.3.4/bin:/rbenv/bin:/nodejs/bin</p>\n  \n  <p>cd /app to get to your application code.</p>\n  \n  <p>Add any necessary environment variables that your Rails application expects to your environment. For example: export DATABASE_URL='...'</p>\n  \n  <p>If you don't know what your app needs, you can view the full environment of the app with cat app.yaml.</p>\n  \n  <p>bin/rails console production to start a Rails console in the Rails production environment.</p>\n</blockquote>\n"}], "owner": {"reputation": 7768, "user_id": 1213273, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/cf372446eb8bcca32373052e4dda2164?s=128&d=identicon&r=PG", "display_name": "Severin", "link": "https://stackoverflow.com/users/1213273/severin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 195, "favorite_count": 0, "accepted_answer_id": 56431142, "answer_count": 1, "score": 0, "last_activity_date": 1559578848, "creation_date": 1559577306, "question_id": 56430757, "link": "https://stackoverflow.com/questions/56430757/run-rails-c-on-gcloud-instace-with-appengine-gem", "title": "Run `rails c` on GCloud instace with appengine gem", "body": "<p>I have a Rails 6.0.0.rc1 application (with the appengine gem install) that I deployed to GCP. Is there a way to log into a remote rails console on the instance that runs the application? I tried this:</p>\n\n<pre><code>bundle exec rake appengine:exec -- bundle exec rails c\n</code></pre>\n\n<p>which gives the following output:</p>\n\n<pre><code>...\n---------- EXECUTE COMMAND ----------\nbundle exec rails c\nLoading production environment (Rails 6.0.0.rc1)\nSwitch to inspect mode.\n...\n</code></pre>\n\n<p>so apparently it executed the command, but closes the connection right after.</p>\n\n<p>Is there an easy way to do this?</p>\n\n<p>As reference: On Heroku this would simply be:</p>\n\n<pre><code>heroku run rails c --app my-application\n</code></pre>\n"}, {"tags": ["ruby", "multidimensional-array", "filter", "duplicates"], "answers": [{"comments": [{"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1559576636, "post_id": 56430110, "comment_id": 99455675, "body": "What if we have <code>1_000</code> arrays? :)"}], "tags": [], "owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "is_accepted": false, "score": 3, "last_activity_date": 1559574587, "creation_date": 1559574587, "answer_id": 56430110, "question_id": 56429704, "link": "https://stackoverflow.com/questions/56429704/2d-array-how-to-remove-duplicate-values-but-keep-the-sub-arrays-separated/56430110#56430110", "title": "2D array - How to remove duplicate values but keep the sub arrays separated", "body": "<p>I think you are looking for: </p>\n\n<pre><code>new_array = [a, b - a, c - b - a, d - c - b - a ]\n#=&gt; [[1,2,3,4], [5], [6], [7]]\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 1, "creation_date": 1559582942, "post_id": 56430571, "comment_id": 99458536, "body": "mudsie, you&#39;ve made the implicit assumption that <code>arr.first</code> contains no duplicates. While the OP&#39;s example contains no duplicates, the specification is mute about that."}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "reply_to_user": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 1, "creation_date": 1559584436, "post_id": 56430571, "comment_id": 99459152, "body": "@CarySwoveland true that. <code>reduce(arr.pop.uniq) { ... } </code> would fix the issue."}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "reply_to_user": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1559623405, "post_id": 56430571, "comment_id": 99468655, "body": "<code>unshift</code>, of course. Correct version: <code>arr.dup.tap { |a| break a.reduce(a.unshift.uniq) { |acc, e| acc &lt;&lt; e - acc.flatten } }</code>."}], "tags": [], "owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "is_accepted": true, "score": 8, "last_activity_date": 1559576507, "creation_date": 1559576507, "answer_id": 56430571, "question_id": 56429704, "link": "https://stackoverflow.com/questions/56429704/2d-array-how-to-remove-duplicate-values-but-keep-the-sub-arrays-separated/56430571#56430571", "title": "2D array - How to remove duplicate values but keep the sub arrays separated", "body": "<p>The most generic approach would be:</p>\n\n<pre><code>[[1,2,3,4], [2,3,4,5], [3,4,5,6], [4,5,6,7]].\n  each_with_object([]) { |a, acc| acc &lt;&lt; a - acc.flatten } \n#\u21d2 [[1, 2, 3, 4], [5], [6], [7]]\n</code></pre>\n\n<p>or</p>\n\n<pre><code>[[1,2,3,4], [2,3,4,5], [3,4,5,6], [4,5,6,7]].\n  reduce([]) { |acc, a| acc &lt;&lt; a - acc.flatten }\n#\u21d2 [[1, 2, 3, 4], [5], [6], [7]]\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "is_accepted": false, "score": 1, "last_activity_date": 1559582730, "creation_date": 1559582730, "answer_id": 56431972, "question_id": 56429704, "link": "https://stackoverflow.com/questions/56429704/2d-array-how-to-remove-duplicate-values-but-keep-the-sub-arrays-separated/56431972#56431972", "title": "2D array - How to remove duplicate values but keep the sub arrays separated", "body": "<pre><code>require 'set'\n\ndef doit(arr)\n  s = Set.new\n  arr.map { |a| a.select { |e| s.add?(e) } }\nend\n</code></pre>\n\n<h1><p></p></h1>\n\n<pre><code>doit [[1,2,3,4], [2,3,4,5], [3,4,5,6], [4,5,6,7]]\n  #=&gt; [[1, 2, 3, 4], [5], [6], [7]] \ndoit [[1,2,2,3,4], [2,3,4,5,3], [3,4,5,6], [4,5,6,7]]\n  #=&gt; [[1, 2, 3, 4], [5], [6], [7]]\n</code></pre>\n\n<p>See <a href=\"http://ruby-doc.org/stdlib-2.5.1/libdoc/set/rdoc/Set.html#method-i-add-3F\" rel=\"nofollow noreferrer\">Set#add?</a>. This should be quite efficient as set lookups are very fast.</p>\n"}, {"tags": [], "owner": {"reputation": 9663, "user_id": 5239030, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/76JEw.png?s=128&g=1", "display_name": "iGian", "link": "https://stackoverflow.com/users/5239030/igian"}, "is_accepted": false, "score": 0, "last_activity_date": 1559595695, "creation_date": 1559595695, "answer_id": 56434489, "question_id": 56429704, "link": "https://stackoverflow.com/questions/56429704/2d-array-how-to-remove-duplicate-values-but-keep-the-sub-arrays-separated/56434489#56434489", "title": "2D array - How to remove duplicate values but keep the sub arrays separated", "body": "<p>I did not make many tests, but is seems to work:</p>\n\n<pre><code>newarray = [[1,2,3,4], [2,3,4,5], [3,4,5,6], [4,5,6,7]]\n\nnewarray.map.with_index { |e, i| (e - newarray.reverse[newarray.size - i..].flatten).uniq }\n#=&gt; [[1, 2, 3, 4], [5], [6], [7]]\n</code></pre>\n\n<p>Or, to avoid reversing at each loop:</p>\n\n<pre><code>newarray.reverse.then{ |ary| newarray.map.with_index { |e, i| (e - ary[newarray.size - i..].flatten).uniq } }\n</code></pre>\n"}], "owner": {"reputation": 47, "user_id": 8115335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d42ff71d9ca5de7b3adcf9292a8ebc36?s=128&d=identicon&r=PG&f=1", "display_name": "ZeeZee", "link": "https://stackoverflow.com/users/8115335/zeezee"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 73, "favorite_count": 0, "accepted_answer_id": 56430571, "answer_count": 4, "score": 4, "last_activity_date": 1559595695, "creation_date": 1559573065, "last_edit_date": 1559576405, "question_id": 56429704, "link": "https://stackoverflow.com/questions/56429704/2d-array-how-to-remove-duplicate-values-but-keep-the-sub-arrays-separated", "title": "2D array - How to remove duplicate values but keep the sub arrays separated", "body": "<p>I want to remove duplicates from my 2d array but I need to keep sub-arrays separately.</p>\n\n<p>Arrays: </p>\n\n<pre><code>a = [1,2,3,4]\nb = [2,3,4,5]\nc = [3,4,5,6]\nd = [4,5,6,7]\n\nnewarray = [[1,2,3,4], [2,3,4,5], [3,4,5,6], [4,5,6,7]]\n</code></pre>\n\n<p>want to get the following result:</p>\n\n<pre><code>newarraynoduplicates = [[1,2,3,4], [5], [6], [7]]\n</code></pre>\n\n<p>I have tried the following things</p>\n\n<pre><code>[a|b|c|d] =&gt; [[1, 2, 3, 4, 5, 6, 7]]\n[a|b|c|d] =&gt;  [1, 2, 3, 4, 5, 6, 7]\n</code></pre>\n\n<p>also tried</p>\n\n<pre><code>newarray.uniq! =&gt; nil!\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "heroku"], "comments": [{"owner": {"reputation": 6039, "user_id": 2137458, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8cfca832ee746f3e3d9971148f52dc64?s=128&d=identicon&r=PG", "display_name": "NM Pennypacker", "link": "https://stackoverflow.com/users/2137458/nm-pennypacker"}, "edited": false, "score": 2, "creation_date": 1559568805, "post_id": 56428093, "comment_id": 99451371, "body": "You might start debugging in your <code>config&#47;environment</code> files. If it&#39;s environment specific, you might have some configuration that&#39;s causing it. Hard to say more without knowing more about your app"}, {"owner": {"reputation": 11, "user_id": 7261001, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-sh2fCm94T6A/AAAAAAAAAAI/AAAAAAAAvB8/uXkcmdmQigg/photo.jpg?sz=128", "display_name": "Jamie Green", "link": "https://stackoverflow.com/users/7261001/jamie-green"}, "reply_to_user": {"reputation": 6039, "user_id": 2137458, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8cfca832ee746f3e3d9971148f52dc64?s=128&d=identicon&r=PG", "display_name": "NM Pennypacker", "link": "https://stackoverflow.com/users/2137458/nm-pennypacker"}, "edited": false, "score": 1, "creation_date": 1559569889, "post_id": 56428093, "comment_id": 99451970, "body": "Thank you very much. I apologise for the stupid question, but how would you go about debugging the env files? I have googled the config options that are different in development and production, but none seem applicable to this issue."}, {"owner": {"reputation": 1306, "user_id": 8008340, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/15JhO.jpg?s=128&g=1", "display_name": "Konstantin Strukov", "link": "https://stackoverflow.com/users/8008340/konstantin-strukov"}, "edited": false, "score": 2, "creation_date": 1559574503, "post_id": 56428093, "comment_id": 99454550, "body": "Probably this is because <code>@blog.main</code> is an escaped HTML fragment itself. You need to unescape it before rendering if you want <code>raw</code> to do the job. Try <code>raw(CGI.unescape_html(@blog.main))</code> etc. Sometimes CGI behaves strange (I remember mystic TypeError on ordinary strings), in this case, there are several gems that can help (htmlentities, nokogiri to name a few...)"}], "owner": {"reputation": 11, "user_id": 7261001, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-sh2fCm94T6A/AAAAAAAAAAI/AAAAAAAAvB8/uXkcmdmQigg/photo.jpg?sz=128", "display_name": "Jamie Green", "link": "https://stackoverflow.com/users/7261001/jamie-green"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 99, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1559569575, "creation_date": 1559567344, "question_id": 56428093, "link": "https://stackoverflow.com/questions/56428093/html-safe-works-locally-but-not-in-production", "title": "html_safe works locally but not in production", "body": "<p>I am using html_safe which should allow embedded Instagram posts (and other styling) on our blog. This works completely fine locally, but doesn't work on production (heroku). </p>\n\n<p>I have also tried \"raw\", and that doesn't seem to work either. I have the same problem with some unrelated code (not working on production, works locally). </p>\n\n<p>Here is the line:</p>\n\n<pre><code>&lt;%= @document_renderer.render(@blog.main).html_safe %&gt;\n\n</code></pre>\n\n<p>Expected result is that Instagram embed (and other styling) should work, instead I just see raw html (you can see a full page with unprocessed html here: <a href=\"https://achefstour.com/blog/the-last-of-the-hong-kongs-dai-pai-dong\" rel=\"nofollow noreferrer\">https://achefstour.com/blog/the-last-of-the-hong-kongs-dai-pai-dong</a>)</p>\n\n<p>So, I am not sure if this is a Heroku problem, or something else I am missing. How can I start to debug this?</p>\n\n<p>Thank you in advance for any suggestions.</p>\n"}, {"tags": ["ruby", "amazon-web-services", "loops", "pagination", "token"], "answers": [{"tags": [], "owner": {"reputation": 1306, "user_id": 8008340, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/15JhO.jpg?s=128&g=1", "display_name": "Konstantin Strukov", "link": "https://stackoverflow.com/users/8008340/konstantin-strukov"}, "is_accepted": false, "score": 0, "last_activity_date": 1559593616, "last_edit_date": 1559593616, "creation_date": 1559572944, "answer_id": 56429665, "question_id": 56426752, "link": "https://stackoverflow.com/questions/56426752/how-do-i-put-back-an-output-token-in-a-loop-ruby-pagination/56429665#56429665", "title": "How do I put back an output token in a loop - Ruby Pagination?", "body": "<p>Not sure if I understand your problem properly because the task looks quite straightforward for me according to your own description:</p>\n\n<ol>\n<li><p>Fetch the response, iterate over the data and process them somehow</p></li>\n<li><p>If the response contains <code>next_token</code> repeat (1) using the next_token provided</p></li>\n<li><p>Exit otherwise.</p></li>\n</ol>\n\n<p>Assuming the last page response has nil as next_token (I didn't find an exact answer in the SDK docs so it's better to check this assumption first) something like the following could work:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>require 'aws-sdk'\n\nQUERY = &lt;&lt;~\n  SELECT\n    resourceId\n  WHERE\n    resourceType = 'AWS::EC2::Instance'\nQUERY\n\nconfigservice = Aws::ConfigService::Client.new(region: 'eu-west-1')\n\nnext_token = nil\n\nloop do\n  response = configservice.select_resource_config({\n    limit: 100,\n    expression: QUERY,\n    next_token: next_token\n  }.compact)\n\n  response.results.each { ... } # do something with the results\n\n  break if response.next_token.nil?\n  next_token = response.next_token\nend\n</code></pre>\n\n<p>P.S. I don't understand how</p>\n\n<pre><code>get_ec2.each do |response|\n  puts response.map(&amp;:next_token)\nend\n</code></pre>\n\n<p>could work in your example taking into account that the response is <a href=\"https://github.com/aws/aws-sdk-ruby/blob/master/gems/aws-sdk-configservice/lib/aws-sdk-configservice/types.rb#L4421\" rel=\"nofollow noreferrer\">just a struct</a>, so its' <code>#each</code> simply iterates over structs' fields (and none of them responds to next_token). Does it really work?</p>\n"}, {"tags": [], "owner": {"reputation": 13, "user_id": 11567686, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-iQNdrwsqGhQ/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcoaPSUsB8yiIBuXrxESfmdFXdITg/mo/photo.jpg?sz=128", "display_name": "Jay", "link": "https://stackoverflow.com/users/11567686/jay"}, "is_accepted": false, "score": 0, "last_activity_date": 1559649174, "creation_date": 1559649174, "answer_id": 56443356, "question_id": 56426752, "link": "https://stackoverflow.com/questions/56426752/how-do-i-put-back-an-output-token-in-a-loop-ruby-pagination/56443356#56443356", "title": "How do I put back an output token in a loop - Ruby Pagination?", "body": "<p>Konstantin Strukov - thank you for your help. I've worked out what I needed to do from your example. </p>\n\n<pre><code>require 'aws-sdk'\nrequire 'json'\n\nQUERY = \"\n  SELECT\n    resourceId,\n    tags\n  WHERE\n    resourceType = 'AWS::EC2::Instance'\"\n\nconfigservice = Aws::ConfigService::Client.new(region: 'eu-west-1')\n\nnext_token = nil\n\nloop do\n  response = configservice.select_resource_config({\n    limit: 100,\n    expression: QUERY,\n    next_token: next_token\n  }.compact)\n\n    response.results.each {|i| puts JSON.parse(i, symbolize_names: true)}\n\n  break if response.next_token.nil?\n  next_token = response.next_token\nend\n\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 11567686, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-iQNdrwsqGhQ/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcoaPSUsB8yiIBuXrxESfmdFXdITg/mo/photo.jpg?sz=128", "display_name": "Jay", "link": "https://stackoverflow.com/users/11567686/jay"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 129, "favorite_count": 1, "answer_count": 2, "score": 0, "last_activity_date": 1559649174, "creation_date": 1559562576, "last_edit_date": 1559635855, "question_id": 56426752, "link": "https://stackoverflow.com/questions/56426752/how-do-i-put-back-an-output-token-in-a-loop-ruby-pagination", "title": "How do I put back an output token in a loop - Ruby Pagination?", "body": "<p>I am using AWS config services to query some data. The results are paginated and a token is provided for the next page of responses. How do I reuse it to for so I can run it once?</p>\n\n<p>example - <a href=\"https://docs.aws.amazon.com/sdk-for-ruby/v3/developer-guide/paging-responses.html\" rel=\"nofollow noreferrer\">https://docs.aws.amazon.com/sdk-for-ruby/v3/developer-guide/paging-responses.html</a></p>\n\n<pre><code>require 'aws-sdk'\nrequire 'json'\n\nQUERY = \"\n  SELECT\n    resourceId\n  WHERE\n    resourceType = 'AWS::EC2::Instance'\"\n\nconfigservice = Aws::ConfigService::Client.new(region: 'eu-west-1')\n\nnext_token = nil\n\nloop do\n  response = configservice.select_resource_config({\n    limit: 100,\n    expression: QUERY,\n    next_token: next_token\n  }.compact)\n\n    response.results.each { puts response[:results].map { |i| JSON.parse(i, symbolize_names: true) } }\n\n  break if response.next_token.nil?\n  next_token = response.next_token\nend\n</code></pre>\n\n<p>edit - thank Konstantin Strukov. This is what I've done now. it kind of works but seems to just repeat the same page multiple times rather than going to next. Any ideas?</p>\n"}, {"tags": ["ruby", "rubygems", "documentation", "rvm"], "answers": [{"tags": [], "owner": {"reputation": 154, "user_id": 5257528, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/efHbB.jpg?s=128&g=1", "display_name": "Irfan Ahmad", "link": "https://stackoverflow.com/users/5257528/irfan-ahmad"}, "is_accepted": true, "score": 3, "last_activity_date": 1559562850, "creation_date": 1559562850, "answer_id": 56426816, "question_id": 56426605, "link": "https://stackoverflow.com/questions/56426605/ruby-global-no-document-with-rvm/56426816#56426816", "title": "Ruby - global &quot;--no-document&quot; with RVM", "body": "<p>run below command on linux/unix/mac </p>\n\n<pre><code>echo 'gem: --no-document' &gt;&gt; ~/.gemrc\n</code></pre>\n\n<p>and then install any gem (even with rvm) and it should work</p>\n"}], "owner": {"reputation": 4472, "user_id": 3667264, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/woXWA.jpg?s=128&g=1", "display_name": "Richard Topchii", "link": "https://stackoverflow.com/users/3667264/richard-topchii"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 439, "favorite_count": 0, "accepted_answer_id": 56426816, "answer_count": 1, "score": 2, "last_activity_date": 1559562850, "creation_date": 1559562108, "question_id": 56426605, "link": "https://stackoverflow.com/questions/56426605/ruby-global-no-document-with-rvm", "title": "Ruby - global &quot;--no-document&quot; with RVM", "body": "<p><strong>Without RVM:</strong></p>\n\n<ol>\n<li>I've added <code>gem: --no-rdoc --no-ri</code> line to the <code>.gemrc</code> file in my home directory</li>\n<li>When I run <code>sudo gem install gemX</code> the ruby gem is installed without the lines \"parsing documentation for gemX\" in the output</li>\n</ol>\n\n<p><strong>Wiht RVM:</strong></p>\n\n<ol>\n<li>The same line added to the same file</li>\n<li>Lines \"parsing documentation for gemX\" are still being printed out in the terminal</li>\n</ol>\n\n<p><strong>Question:</strong></p>\n\n<p>How can I disable parsing the documentation when installing ruby gems while running ruby using RVM?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "postgresql", "ruby-on-rails-5", "rounding"], "comments": [{"owner": {"reputation": 45322, "user_id": 421705, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/581b1760881c962648f99d6040d41829?s=128&d=identicon&r=PG", "display_name": "Holger Just", "link": "https://stackoverflow.com/users/421705/holger-just"}, "edited": false, "score": 2, "creation_date": 1559561136, "post_id": 56425897, "comment_id": 99447295, "body": "What exactly is your question?"}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 1, "creation_date": 1559561157, "post_id": 56425897, "comment_id": 99447300, "body": "The floating point value <code>80500.01</code> is an approximation. It&#39;s actual value is <code>80500.009999999994761310517787933349609375</code>. So if you say it is being saved as <code>80500.00999999999</code>, it seems right. Try to use a decimal value instead, i.e. <a href=\"http://ruby-doc.org/stdlib-2.6.3/libdoc/bigdecimal/rdoc/BigDecimal.html\" rel=\"nofollow noreferrer\"><code>BigDecimal</code></a>."}, {"owner": {"reputation": 7, "user_id": 4524745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/44683b8afb9ba472402084faab0ea5ba?s=128&d=identicon&r=PG&f=1", "display_name": "erum sanwari", "link": "https://stackoverflow.com/users/4524745/erum-sanwari"}, "reply_to_user": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1559562123, "post_id": 56425897, "comment_id": 99447784, "body": "@Stefan But how do you justify two different behaviors for two numbers? .round() is rounding off 65535.00999 to 65535.01, but not 65536.00999"}, {"owner": {"reputation": 3995, "user_id": 2037537, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/f13d953be3af2552aaa1ddfa0a05fa46?s=128&d=identicon&r=PG", "display_name": "Roland Studer", "link": "https://stackoverflow.com/users/2037537/roland-studer"}, "edited": false, "score": 0, "creation_date": 1559563397, "post_id": 56425897, "comment_id": 99448484, "body": "Can you post the controller action, where the amount should be rounded and saved?"}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1559569456, "post_id": 56425897, "comment_id": 99451742, "body": "@erumsanwari maybe I don&#39;t understand your problem. What values do you current have (in Ruby/Rails and in Postgres) and what are your expected values?"}, {"owner": {"reputation": 7, "user_id": 4524745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/44683b8afb9ba472402084faab0ea5ba?s=128&d=identicon&r=PG&f=1", "display_name": "erum sanwari", "link": "https://stackoverflow.com/users/4524745/erum-sanwari"}, "reply_to_user": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1559802113, "post_id": 56425897, "comment_id": 99534457, "body": "@Stefan I have edited my question. I suppose this could be helpful. Thanks."}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1559803977, "post_id": 56425897, "comment_id": 99535185, "body": "@erumsanwari what&#39;s the value you have / want in your model and what&#39;s the value you have / want in your database?"}, {"owner": {"reputation": 7, "user_id": 4524745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/44683b8afb9ba472402084faab0ea5ba?s=128&d=identicon&r=PG&f=1", "display_name": "erum sanwari", "link": "https://stackoverflow.com/users/4524745/erum-sanwari"}, "reply_to_user": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1559805134, "post_id": 56425897, "comment_id": 99535706, "body": "@Stefan I am getting the value from user. Now if I get value as 80500.00999999999 , then it should store the value as 80500.01 in database, which, I am not able to do with round(2)."}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1559805697, "post_id": 56425897, "comment_id": 99535958, "body": "@erumsanwari as said in my first comment, the <i>float</i> value <code>80500.01</code> (which is returned by <code>round</code>) is an approximation used for convenience. Its actual value (which is usually not shown to you) is <code>80500.009999999994761310517787933349609375</code> and that&#39;s what is being saved to your database. This is simply the way floats work. If you want a class that can represent decimal values exactly, use <code>BigDecimal</code>."}], "answers": [{"comments": [{"owner": {"reputation": 5060, "user_id": 10522579, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7GQ6a.jpg?s=128&g=1", "display_name": "ray", "link": "https://stackoverflow.com/users/10522579/ray"}, "reply_to_user": {"reputation": 7, "user_id": 4524745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/44683b8afb9ba472402084faab0ea5ba?s=128&d=identicon&r=PG&f=1", "display_name": "erum sanwari", "link": "https://stackoverflow.com/users/4524745/erum-sanwari"}, "edited": false, "score": 0, "creation_date": 1559563192, "post_id": 56426125, "comment_id": 99448368, "body": "@erumsanwari what is your database field and model name"}, {"owner": {"reputation": 13442, "user_id": 3982562, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2a3c7aae1d762372cda697833c602ec8?s=128&d=identicon&r=PG", "display_name": "3limin4t0r", "link": "https://stackoverflow.com/users/3982562/3limin4t0r"}, "edited": false, "score": 2, "creation_date": 1559566665, "post_id": 56426125, "comment_id": 99450165, "body": "This would result in an endless loop. You should use <code>super</code> to pass the value to the original setter. <code>super(amt.to_f.round(2))</code>"}, {"owner": {"reputation": 5060, "user_id": 10522579, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7GQ6a.jpg?s=128&g=1", "display_name": "ray", "link": "https://stackoverflow.com/users/10522579/ray"}, "reply_to_user": {"reputation": 13442, "user_id": 3982562, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2a3c7aae1d762372cda697833c602ec8?s=128&d=identicon&r=PG", "display_name": "3limin4t0r", "link": "https://stackoverflow.com/users/3982562/3limin4t0r"}, "edited": false, "score": 0, "creation_date": 1559567512, "post_id": 56426125, "comment_id": 99450636, "body": "@3limin4t0r surprised by your comment, elaborate please."}, {"owner": {"reputation": 13442, "user_id": 3982562, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2a3c7aae1d762372cda697833c602ec8?s=128&d=identicon&r=PG", "display_name": "3limin4t0r", "link": "https://stackoverflow.com/users/3982562/3limin4t0r"}, "edited": false, "score": 1, "creation_date": 1559570348, "post_id": 56426125, "comment_id": 99452240, "body": "@ray I&#39;ve created an <a href=\"https://gist.github.com/3limin4t0r/9b27e0cfd3b8b6eba8c5c6df8570a81c\" rel=\"nofollow noreferrer\">example</a>, have a look. I hope this clears things up."}, {"owner": {"reputation": 5060, "user_id": 10522579, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7GQ6a.jpg?s=128&g=1", "display_name": "ray", "link": "https://stackoverflow.com/users/10522579/ray"}, "reply_to_user": {"reputation": 13442, "user_id": 3982562, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2a3c7aae1d762372cda697833c602ec8?s=128&d=identicon&r=PG", "display_name": "3limin4t0r", "link": "https://stackoverflow.com/users/3982562/3limin4t0r"}, "edited": false, "score": 0, "creation_date": 1559570781, "post_id": 56426125, "comment_id": 99452462, "body": "@3limin4t0r thanks I can say you saved me! Also got <a href=\"https://stackoverflow.com/a/10465235/10522579\">this</a>"}, {"owner": {"reputation": 7, "user_id": 4524745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/44683b8afb9ba472402084faab0ea5ba?s=128&d=identicon&r=PG&f=1", "display_name": "erum sanwari", "link": "https://stackoverflow.com/users/4524745/erum-sanwari"}, "reply_to_user": {"reputation": 13442, "user_id": 3982562, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2a3c7aae1d762372cda697833c602ec8?s=128&d=identicon&r=PG", "display_name": "3limin4t0r", "link": "https://stackoverflow.com/users/3982562/3limin4t0r"}, "edited": false, "score": 0, "creation_date": 1559802199, "post_id": 56426125, "comment_id": 99534481, "body": "@3limin4t0r I have edited my question to be more explanatory. Your solution, however isn&#39;t still helping me so I suppose now you could explain it properly..."}], "tags": [], "owner": {"reputation": 5060, "user_id": 10522579, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7GQ6a.jpg?s=128&g=1", "display_name": "ray", "link": "https://stackoverflow.com/users/10522579/ray"}, "is_accepted": false, "score": 2, "last_activity_date": 1559570670, "last_edit_date": 1559570670, "creation_date": 1559560218, "answer_id": 56426125, "question_id": 56425897, "link": "https://stackoverflow.com/questions/56425897/ruby-round-function-rounding-off-the-values-but-storing-the-original-value-o/56426125#56426125", "title": "Ruby .round() function rounding off the values, but storing the original value only in database", "body": "<p>I will suggest you to put following setter as instance method for db attribute <code>amount</code> inside model,</p>\n\n<pre><code>def amount=(amt)\n  super(amt.to_f.round(2))\nend\n</code></pre>\n\n<p>It will save updated value of amount inside you database as per your need.</p>\n"}, {"comments": [{"owner": {"reputation": 7, "user_id": 4524745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/44683b8afb9ba472402084faab0ea5ba?s=128&d=identicon&r=PG&f=1", "display_name": "erum sanwari", "link": "https://stackoverflow.com/users/4524745/erum-sanwari"}, "edited": false, "score": 0, "creation_date": 1559802255, "post_id": 56426934, "comment_id": 99534500, "body": "Sorry I am not looking for this."}, {"owner": {"reputation": 48049, "user_id": 6419007, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/CwqtX.jpg?s=128&g=1", "display_name": "Eric Duminil", "link": "https://stackoverflow.com/users/6419007/eric-duminil"}, "reply_to_user": {"reputation": 7, "user_id": 4524745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/44683b8afb9ba472402084faab0ea5ba?s=128&d=identicon&r=PG&f=1", "display_name": "erum sanwari", "link": "https://stackoverflow.com/users/4524745/erum-sanwari"}, "edited": false, "score": 0, "creation_date": 1559804006, "post_id": 56426934, "comment_id": 99535204, "body": "@erumsanwari: As you wish. It&#39;s been tested and proved to be a better solution than floats for thousands of financial apps, though."}], "tags": [], "owner": {"reputation": 48049, "user_id": 6419007, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/CwqtX.jpg?s=128&g=1", "display_name": "Eric Duminil", "link": "https://stackoverflow.com/users/6419007/eric-duminil"}, "is_accepted": false, "score": 0, "last_activity_date": 1559563222, "creation_date": 1559563222, "answer_id": 56426934, "question_id": 56425897, "link": "https://stackoverflow.com/questions/56425897/ruby-round-function-rounding-off-the-values-but-storing-the-original-value-o/56426934#56426934", "title": "Ruby .round() function rounding off the values, but storing the original value only in database", "body": "<p>The usual method to solve the <a href=\"https://docs.oracle.com/cd/E19957-01/806-3568/ncg_goldberg.html\" rel=\"nofollow noreferrer\">problems related to floats</a> is to store cents as integers instead of dollars as floats.</p>\n\n<p>You calculate and store everything as cents, and only need to convert to dollars for display purposes, by dividing by 100.0.</p>\n"}], "owner": {"reputation": 7, "user_id": 4524745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/44683b8afb9ba472402084faab0ea5ba?s=128&d=identicon&r=PG&f=1", "display_name": "erum sanwari", "link": "https://stackoverflow.com/users/4524745/erum-sanwari"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 210, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1559801976, "creation_date": 1559559377, "last_edit_date": 1559801976, "question_id": 56425897, "link": "https://stackoverflow.com/questions/56425897/ruby-round-function-rounding-off-the-values-but-storing-the-original-value-o", "title": "Ruby .round() function rounding off the values, but storing the original value only in database", "body": "<p>I am trying to round off the amounts i get to 2 decimal places. I have the amount attribute as a decimal field with precision 32 and scale 16.</p>\n\n<p>I have tried doing amount.round(2)</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>def amount(amt)\n  amt.to_f.round(2)\nend\n</code></pre>\n\n<p>Let's say <code>amt = 80500.00999999999</code>. When printing this in rails logs, I get <code>80500.01</code>. But when saving, it saves <code>80500.00999999999</code> in database. \nAlso I've noted that if I do <code>65535.00999</code> (or smaller values), its rounding off and saving correctly to 65535.01. On the other hand, if am using the <code>amount= 65536.00999</code> (or greater values), it saves the amount as it is in database without rounding. I took these numbers particularly since <code>65535</code> is the upper limit of unsigned <code>smallInt</code> in Postgres, and somehow am getting these results.</p>\n\n<p>EDIT:</p>\n\n<p>I have a Transaction model which has an attribute called amount. I have another file:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code># app/operations/txn.rb\n\ndef create_txn\n  @transaction = Transaction.new(transaction_params)\n  @transaction.save\nend\n\ndef transaction_params\n{\n  .\n  .\n  .\n  amount: dest_amount,\n  .\n  .\n  .\n}\nend\n\ndef dest_amount\n  #logic\nend\n\n</code></pre>\n"}, {"tags": ["ruby", "sinatra"], "comments": [{"owner": {"reputation": 27144, "user_id": 3857758, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/58c4295826435f049b7fc32b98c240f9?s=128&d=identicon&r=PG&f=1", "display_name": "Ursus", "link": "https://stackoverflow.com/users/3857758/ursus"}, "edited": false, "score": 0, "creation_date": 1559559002, "post_id": 56425751, "comment_id": 99446246, "body": "Which version of ruby you&#39;re using?"}, {"owner": {"reputation": 15911, "user_id": 445908, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/MwXTa.jpg?s=128&g=1", "display_name": "Siwei", "link": "https://stackoverflow.com/users/445908/siwei"}, "reply_to_user": {"reputation": 27144, "user_id": 3857758, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/58c4295826435f049b7fc32b98c240f9?s=128&d=identicon&r=PG&f=1", "display_name": "Ursus", "link": "https://stackoverflow.com/users/3857758/ursus"}, "edited": false, "score": 0, "creation_date": 1559559068, "post_id": 56425751, "comment_id": 99446270, "body": "my ruby version is  2.3.8"}, {"owner": {"reputation": 1107, "user_id": 154365, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/f37c48311aba3b010c65cc01459784be?s=128&d=identicon&r=PG", "display_name": "Jimmy MG Lim", "link": "https://stackoverflow.com/users/154365/jimmy-mg-lim"}, "edited": false, "score": 0, "creation_date": 1592126142, "post_id": 56425751, "comment_id": 110307567, "body": "fyi .. there is sinatra contrib with json example - <a href=\"http://sinatrarb.com/contrib/json.html\" rel=\"nofollow noreferrer\">sinatrarb.com/contrib/json.html</a> .. the syntax is <code>json :foo =&gt; bar</code>"}], "answers": [{"comments": [{"owner": {"reputation": 15911, "user_id": 445908, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/MwXTa.jpg?s=128&g=1", "display_name": "Siwei", "link": "https://stackoverflow.com/users/445908/siwei"}, "edited": false, "score": 0, "creation_date": 1559559228, "post_id": 56425793, "comment_id": 99446339, "body": "OK, thanks a lot! for me, I would prefer the Rails way. I really don&#39;t want to write the out most &quot;(&quot; and &quot;)&quot;.   :-)"}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1559579081, "post_id": 56425793, "comment_id": 99456857, "body": "You may want to try <code>json(...)</code> to make it clear it&#39;s not a block. As in: <code>json(item1: { ... }, ...)</code> where the first layer of <code>{ .... }</code> braces can be omitted."}], "tags": [], "owner": {"reputation": 167912, "user_id": 240443, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/495d675e3bc42ed1dee469e2ce701f1b?s=128&d=identicon&r=PG", "display_name": "Amadan", "link": "https://stackoverflow.com/users/240443/amadan"}, "is_accepted": false, "score": 8, "last_activity_date": 1559559327, "last_edit_date": 1559559327, "creation_date": 1559559020, "answer_id": 56425793, "question_id": 56425751, "link": "https://stackoverflow.com/questions/56425751/in-sinatra-how-to-render-json/56425793#56425793", "title": "In Sinatra, how to render json?", "body": "<p>Because the latter case assumes you're calling <code>json</code> method with a block, and <code>foo: 'bar'</code> is an invalid statement. I.e.</p>\n\n<pre><code>json { foo: 'bar' }\n</code></pre>\n\n<p>is parsed in (almost) the same way as</p>\n\n<pre><code>json do\n  foo: 'bar'\nend\n</code></pre>\n\n<p>which is nonsense. (\"almost\" because the priority of braces and <code>do...end</code> differ a bit; not that it matters in this case.)</p>\n\n<p>The former case assumes <code>foo: 'bar'</code> is a named argument, and is converted into a <code>Hash</code>. <code>json({ foo: 'bar' })</code> would make it explicit that you're passing a <code>Hash</code>, and not writing a block. Thus, the following is the correct syntax for what you are trying to write:</p>\n\n<pre><code>get '/initialize' do\n  json({ \n       item1: { \n           item2: {\n               item3: 'ok'\n           }\n       } \n  })\nend \n</code></pre>\n\n<p>You can also use the keyword approach (though I find it's less readable):</p>\n\n<pre><code>get '/initialize' do\n  json item1: { \n           item2: {\n               item3: 'ok'\n           }\n       }\nend \n</code></pre>\n"}], "owner": {"reputation": 15911, "user_id": 445908, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/MwXTa.jpg?s=128&g=1", "display_name": "Siwei", "link": "https://stackoverflow.com/users/445908/siwei"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 870, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1559570126, "creation_date": 1559558884, "last_edit_date": 1559570126, "question_id": 56425751, "link": "https://stackoverflow.com/questions/56425751/in-sinatra-how-to-render-json", "title": "In Sinatra, how to render json?", "body": "<p>I find it very weird that this is OK:</p>\n\n<pre><code>  get '/initialize' do\n    # ok \n    json foo: 'bar'\n  end \n</code></pre>\n\n<p>Yet this causes an error:</p>\n\n<pre><code>  get '/initialize' do\n    json { foo: 'bar' }   # error! \n  end \n</code></pre>\n\n<blockquote>\n  <p>syntax error, unexpected ':', expecting '}' (SyntaxError)</p>\n</blockquote>\n\n<p>Why? </p>\n\n<p>How can I write the code like :</p>\n\n<pre><code>  get '/initialize' do\n    json { \n         item1: { \n             item2: {\n                 item3: 'ok'\n             }\n         } \n    }\n\n  end \n</code></pre>\n"}, {"tags": ["ruby", "sinatra"], "comments": [{"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 1, "creation_date": 1559546378, "post_id": 56422645, "comment_id": 99440248, "body": "You run modular app in production env. And classic in what, development? Also, different servers are used, I think (thin vs puma?)"}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1559546996, "post_id": 56422645, "comment_id": 99440508, "body": "In other words, If you&#39;re going to compare fruits, compare apples to apples, not apples to oranges."}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "reply_to_user": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1559548763, "post_id": 56422645, "comment_id": 99441284, "body": "@SergioTulentsev on bare echo test everything under 10K is equally shitty btw :) here is a benchmark for 1M map value lookup response with <code>cowboy</code> + <code>plug</code> <a href=\"https://hexdocs.pm/camarero/camarero.html#benchmarks\" rel=\"nofollow noreferrer\">hexdocs.pm/camarero/camarero.html#benchmarks</a> \u2192 35K/sec approx."}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1559550952, "post_id": 56422645, "comment_id": 99442213, "body": "Remove rackup from the equation. Without it, the two ways behave the same (on my machine)"}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "reply_to_user": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1559551158, "post_id": 56422645, "comment_id": 99442300, "body": "@AlekseiMatiushkin: oh, I agree, if you want a fast lightweight service, ruby is not the best language. At least, MRI. Didn&#39;t try JVM&#39;s JIT magic, maybe it does work wonders."}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 1, "creation_date": 1559552208, "post_id": 56422645, "comment_id": 99442774, "body": "&quot;I don&#39;t trust theory, I trust the benchmarks&quot; - you shouldn&#39;t, if you&#39;re doing them wrong, like here. Doing correct benchmarks (which includes, among other things, isolating <i>just</i> the variable part and nothing else) is a skill of its own."}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "reply_to_user": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1559553047, "post_id": 56422645, "comment_id": 99443182, "body": "@AlekseiMatiushkin: hm, go&#39;s stock webserver does only 20k RPS on my machine. Guess erlang VM really is best for writing echo servers :)"}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 1, "creation_date": 1559553513, "post_id": 56422645, "comment_id": 99443422, "body": "Erlang VM is the best to write <i>any</i> concurrent software btw."}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "reply_to_user": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1559553733, "post_id": 56422645, "comment_id": 99443534, "body": "@AlekseiMatiushkin: except when you have a non-trivial workload and you need high performance, it seems. FWIW, erlang/elixir solutions failed <i>miserably</i> at last year&#39;s <a href=\"https://highloadcup.ru/en/\" rel=\"nofollow noreferrer\">highloadcup</a>. Reliability seems to be unquestionable, though, so there&#39;s that."}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "reply_to_user": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1559554029, "post_id": 56422645, "comment_id": 99443704, "body": "@SergioTulentsev yeah, the artificial task performed by people at contest proves the decades of success wrong. No doubt."}, {"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 0, "creation_date": 1560723771, "post_id": 56422645, "comment_id": 99818958, "body": "Please don&#39;t put &quot;problem solved&quot; information into your question. That&#39;s not the SO way. Instead, select the appropriate answer as the solution if there is one. If there&#39;s not the feel free to create an answer and select it as the solution once SO releases its timeout. FYI, SO is like an online encyclopedia of questions and answers, it&#39;s not like a message board. &quot;<a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a>&quot; and the linked pages will help explain."}], "answers": [{"comments": [{"owner": {"reputation": 15911, "user_id": 445908, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/MwXTa.jpg?s=128&g=1", "display_name": "Siwei", "link": "https://stackoverflow.com/users/445908/siwei"}, "edited": false, "score": 0, "creation_date": 1559549871, "post_id": 56422985, "comment_id": 99441780, "body": "I don&#39;t think so. I just echo a very short fixed String, no database , no loop, and no thread waiting. the benchmark should not be so different."}, {"owner": {"reputation": 15911, "user_id": 445908, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/MwXTa.jpg?s=128&g=1", "display_name": "Siwei", "link": "https://stackoverflow.com/users/445908/siwei"}, "edited": false, "score": 0, "creation_date": 1559550435, "post_id": 56422985, "comment_id": 99442026, "body": "I posted this question also to the sinatra github issues list. I totally agreed about your point on the &quot;concurrency models between thin and puma&quot;. I just curious that it&#39;s OK if they are 20% performance difference, but should not almost 100% difference."}, {"owner": {"reputation": 1306, "user_id": 8008340, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/15JhO.jpg?s=128&g=1", "display_name": "Konstantin Strukov", "link": "https://stackoverflow.com/users/8008340/konstantin-strukov"}, "reply_to_user": {"reputation": 15911, "user_id": 445908, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/MwXTa.jpg?s=128&g=1", "display_name": "Siwei", "link": "https://stackoverflow.com/users/445908/siwei"}, "edited": false, "score": 0, "creation_date": 1559552968, "post_id": 56422985, "comment_id": 99443142, "body": "@SiweiShen\u7533\u601d\u7ef4 now the figures are even more controversial... But I agree: looks like my naive &quot;it&#39;s just because of the different servers used&quot; is not a valid answer :)"}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 2, "creation_date": 1559553237, "post_id": 56422985, "comment_id": 99443289, "body": "@KonstantinStrukov: rackup is the culprit, looks like. :) Looks like a server issue from my end. So we weren&#39;t entirely off."}], "tags": [], "owner": {"reputation": 1306, "user_id": 8008340, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/15JhO.jpg?s=128&g=1", "display_name": "Konstantin Strukov", "link": "https://stackoverflow.com/users/8008340/konstantin-strukov"}, "is_accepted": false, "score": 2, "last_activity_date": 1559547586, "creation_date": 1559547586, "answer_id": 56422985, "question_id": 56422645, "link": "https://stackoverflow.com/questions/56422645/performance-of-classic-sinatra-and-modular-sinatra-am-i-doing-wrong/56422985#56422985", "title": "Performance of classic sinatra and modular sinatra? am I doing wrong?", "body": "<p>Your benchmark is incorrect.</p>\n\n<p>According to the snippets you posted, in the first case you use Thin as a server and in the second it's Puma.</p>\n\n<p>These servers implement absolutely different concurrency models: as far as I remember it is a single-threaded event loop for the former and multiple threads for the latter. As a result, Thin performs better for light non-blocking tasks while Puma beats it in the scenarios with relatively heavy computations or blocking ones.</p>\n\n<p>Your dummy example just better fits to the Thin's model and this causes the difference... Modular Sinatra should be absolutely fine, just compare apples to apples :)</p>\n"}, {"tags": [], "owner": {"reputation": 15911, "user_id": 445908, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/MwXTa.jpg?s=128&g=1", "display_name": "Siwei", "link": "https://stackoverflow.com/users/445908/siwei"}, "is_accepted": true, "score": 1, "last_activity_date": 1561030820, "creation_date": 1561030820, "answer_id": 56685188, "question_id": 56422645, "link": "https://stackoverflow.com/questions/56422645/performance-of-classic-sinatra-and-modular-sinatra-am-i-doing-wrong/56685188#56685188", "title": "Performance of classic sinatra and modular sinatra? am I doing wrong?", "body": "<p>OK, I found the root cause, and with The Tin Man's suggestion, I post my answer here. </p>\n\n<p>The problem is the \"web server\" , but not the \"framework\"</p>\n\n<p>The different way I started the server makes the different result .</p>\n\n<pre><code># this gives 2800 req/s in a production server, server based on thin\n$ bundle exec thin start -R config.ru -e production    \n\n# this gives 1600 req/s in the same server, server based on Rack( seems that)\n$ bundle exec rackup config.ru -s thin\nso the ways of starting sinatra:\n</code></pre>\n\n<ul>\n<li>wrong: $ ruby main.rb (based on rack?)</li>\n<li>wrong: $ rackup config.ru (based on rack)</li>\n<li>wrong: $ rackup config.ru -s thin ( event based on rack)</li>\n<li>correct: $ thin start -R config.ru -e production</li>\n</ul>\n"}], "owner": {"reputation": 15911, "user_id": 445908, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/MwXTa.jpg?s=128&g=1", "display_name": "Siwei", "link": "https://stackoverflow.com/users/445908/siwei"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 241, "favorite_count": 1, "accepted_answer_id": 56685188, "answer_count": 2, "score": 3, "last_activity_date": 1561030820, "creation_date": 1559545997, "last_edit_date": 1559554814, "question_id": 56422645, "link": "https://stackoverflow.com/questions/56422645/performance-of-classic-sinatra-and-modular-sinatra-am-i-doing-wrong", "title": "Performance of classic sinatra and modular sinatra? am I doing wrong?", "body": "<p>UPDATED:  OK, problem solved. </p>\n\n<p>The different way I started the server makes the different result . </p>\n\n<pre><code># this gives 2800 req/s in a production server, server based on thin\n$ bundle exec thin start -R config.ru -e production    \n\n# this gives 1600 req/s in the same server, server based on Rack( seems that)\n$ bundle exec rackup config.ru -s thin\n</code></pre>\n\n<p>so the ways of starting sinatra: </p>\n\n<ol>\n<li>wrong:  $ ruby main.rb (based on rack?)</li>\n<li>wrong:  $ rackup config.ru (based on rack) </li>\n<li>wrong:  $ rackup config.ru -s thin ( event based on rack) </li>\n<li>correct: $ thin start -R config.ru -e production </li>\n</ol>\n\n<p>-------------------  Original question --------------------</p>\n\n<p>Today I am coding Sinatra for an API application, and found that: </p>\n\n<ol>\n<li><p>Classic sinatra code can process :</p>\n\n<p>1.1 1800 request/s, with thin as the server.</p>\n\n<p>1.2 2000 request/s, with puma as the server.</p></li>\n<li><p>Modular sinatra code can only process:</p>\n\n<p>2.1 1100 requests/s, with thin as the server</p>\n\n<p>2.2 800 requests/s , with puma as the server.</p></li>\n</ol>\n\n<p>How to reproduce this: </p>\n\n<h1>classic sinatra</h1>\n\n<pre><code># test_classic_sinatra.rb\nrequire 'sinatra'\nget '/' do\n  'hihihi'\nend\n</code></pre>\n\n<p>run : </p>\n\n<pre><code>siwei $ ruby test.rb \n== Sinatra (v2.0.5) has taken the stage on 4567 for development with backup from Thin\nThin web server (v1.7.2 codename Bachmanity)\nMaximum connections set to 1024\nListening on localhost:4567, CTRL+C to stop\n\n</code></pre>\n\n<p>test: </p>\n\n<p><code>$ ab -n 1000 -c 100 http://localhost:4567/</code></p>\n\n<p>and got result:  </p>\n\n<pre><code>Concurrency Level:      100\nTime taken for tests:   0.530 seconds\nComplete requests:      1000\nFailed requests:        0\nTotal transferred:      211000 bytes\nHTML transferred:       6000 bytes\nRequests per second:    1885.43 [#/sec] (mean)\nTime per request:       53.038 [ms] (mean)\nTime per request:       0.530 [ms] (mean, across all concurrent requests)\nTransfer rate:          388.50 [Kbytes/sec] received\n\n</code></pre>\n\n<h1>Modular sinatra:</h1>\n\n<pre><code># config.ru\nrequire 'sinatra/base'\n\nclass App &lt; Sinatra::Application\n  set :environment, :production\n  get '/' do\n    'hihihi'\n  end\nend\n\nrun App\n\n</code></pre>\n\n<h2>with thin as server</h2>\n\n<p>run: </p>\n\n<pre><code>$ rackup config.ru -s thin\nThin web server (v1.7.2 codename Bachmanity)\nMaximum connections set to 1024\nListening on localhost:9292, CTRL+C to stop\n</code></pre>\n\n<p>test:</p>\n\n<pre><code>Concurrency Level:      100\nTime taken for tests:   0.931 seconds\nComplete requests:      1000\nFailed requests:        0\nTotal transferred:      211000 bytes\nHTML transferred:       6000 bytes\nRequests per second:    1073.58 [#/sec] (mean)\nTime per request:       93.146 [ms] (mean)\nTime per request:       0.931 [ms] (mean, across all concurrent requests)\nTransfer rate:          221.22 [Kbytes/sec] received\n</code></pre>\n\n<h2>with puma as server</h2>\n\n<p>run: </p>\n\n<pre><code>siwei$ rackup config.ru \nPuma starting in single mode...\n* Version 3.11.4 (ruby 2.3.8-p459), codename: Love Song\n* Min threads: 0, max threads: 16\n* Environment: development\n* Listening on tcp://localhost:9292\nUse Ctrl-C to stop\n</code></pre>\n\n<p>test: </p>\n\n<p><code>$ab -n 1000 -c 100 http://localhost:9292/</code></p>\n\n<p>got result: </p>\n\n<pre><code>Concurrency Level:      100\nTime taken for tests:   1.266 seconds\nComplete requests:      1000\nFailed requests:        0\nTotal transferred:      178000 bytes\nHTML transferred:       6000 bytes\nRequests per second:    789.62 [#/sec] (mean)\nTime per request:       126.643 [ms] (mean)\nTime per request:       1.266 [ms] (mean, across all concurrent requests)\nTransfer rate:          137.26 [Kbytes/sec] received\n\n</code></pre>\n\n<p>Before deciding to use Sinatra, I read many posts about \"sinatra, grape and rails api\", and I ran test agaist these frameworks, and finally decide to use Sinatra. </p>\n\n<p>But now , I found Modular Sinatra seems not so good as expected. Could someone give me a clue about how to use \"Classic Sinatra\" or \"Modular Sinatra\" ? </p>\n\n<p>If I don't use Modular Sinatra, how to write code for big applications? </p>\n\n<p>thanks a lot! </p>\n"}, {"tags": ["ruby-on-rails", "ruby", "rspec", "routing"], "answers": [{"tags": [], "owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "is_accepted": true, "score": 1, "last_activity_date": 1559545788, "creation_date": 1559545788, "answer_id": 56422592, "question_id": 56422523, "link": "https://stackoverflow.com/questions/56422523/how-do-i-change-the-default-controller-in-rspec/56422592#56422592", "title": "How do I change the default controller in Rspec?", "body": "<p>In controller specs you talk only to controller under test. If you need other controllers to create a few prerequisite objects first - create them directly in the db. If you need authenticated user - set <code>session[:user_id]</code> directly (or however it is your authentication works). See <a href=\"https://stackoverflow.com/a/10121980/125816\">this answer</a>, for example.</p>\n\n<p>What you attempted to do is called a \"feature spec\" (or \"integration spec\"). It's a different type of spec and you should write some of those as well.</p>\n"}], "owner": {"reputation": 485, "user_id": 7399323, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/64e3a4116517813a2042aed29f841ede?s=128&d=identicon&r=PG&f=1", "display_name": "evans", "link": "https://stackoverflow.com/users/7399323/evans"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 75, "favorite_count": 0, "accepted_answer_id": 56422592, "answer_count": 1, "score": 0, "last_activity_date": 1559545788, "creation_date": 1559545477, "question_id": 56422523, "link": "https://stackoverflow.com/questions/56422523/how-do-i-change-the-default-controller-in-rspec", "title": "How do I change the default controller in Rspec?", "body": "<p>I need authentication to pass the test successfully.</p>\n\n<pre><code>describe PostsController do\n  let(:user) { create(:user) }\n  describe 'POST #create' do\n    let(:create_post) { post :create, params: { post: attributes_for(:post) } }\n\n    before do\n      post sessions_path, params: { login: user.email, password: user.password }\n    end\n\n    context 'with valid attributes' do\n      it 'return OK' do\n        create_post\n        expect(response).to have_http_status(200)\n      end\n  end\nend\n</code></pre>\n\n<p><code>post session_path</code> - this does not work and generates an error: </p>\n\n<pre><code>No route matches {:action=&gt;\"/sessions\", :controller=&gt;\"posts\", :login=&gt;\"jack@example.com\", :password=&gt;\"qwerty\"}\n</code></pre>\n\n<p>How do I change default PostsController to SessionsController in the <code>before</code> block? </p>\n"}, {"tags": ["ruby-on-rails", "ruby", "routes", "nested-routes"], "comments": [{"owner": {"reputation": 5644, "user_id": 9908141, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/seDql.jpg?s=128&g=1", "display_name": "Imran Ahmad", "link": "https://stackoverflow.com/users/9908141/imran-ahmad"}, "edited": false, "score": 1, "creation_date": 1559535211, "post_id": 56420913, "comment_id": 99437212, "body": "Take <code>resources :assignments</code> out of member block and do check again"}], "answers": [{"comments": [{"owner": {"reputation": 1079, "user_id": 3182184, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/UAty8.jpg?s=128&g=1", "display_name": "Aarvy", "link": "https://stackoverflow.com/users/3182184/aarvy"}, "edited": false, "score": 0, "creation_date": 1559554705, "post_id": 56421079, "comment_id": 99444112, "body": "I was following this documentation, i am afraid they have put wrong info here. <a href=\"https://guides.rubyonrails.org/v3.2.2/routing.html#nested-resources\" rel=\"nofollow noreferrer\">guides.rubyonrails.org/v3.2.2/routing.html#nested-resources</a>    check the tables under nested-resources section. they have used same <code>:id</code> twice in edit route."}, {"owner": {"reputation": 5644, "user_id": 9908141, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/seDql.jpg?s=128&g=1", "display_name": "Imran Ahmad", "link": "https://stackoverflow.com/users/9908141/imran-ahmad"}, "reply_to_user": {"reputation": 1079, "user_id": 3182184, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/UAty8.jpg?s=128&g=1", "display_name": "Aarvy", "link": "https://stackoverflow.com/users/3182184/aarvy"}, "edited": false, "score": 0, "creation_date": 1559623244, "post_id": 56421079, "comment_id": 99468612, "body": "It has been fixed now."}, {"owner": {"reputation": 5644, "user_id": 9908141, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/seDql.jpg?s=128&g=1", "display_name": "Imran Ahmad", "link": "https://stackoverflow.com/users/9908141/imran-ahmad"}, "reply_to_user": {"reputation": 1079, "user_id": 3182184, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/UAty8.jpg?s=128&g=1", "display_name": "Aarvy", "link": "https://stackoverflow.com/users/3182184/aarvy"}, "edited": false, "score": 0, "creation_date": 1559623416, "post_id": 56421079, "comment_id": 99468659, "body": "The issue is not there in the current version of doc but 3.2.2."}], "tags": [], "owner": {"reputation": 5644, "user_id": 9908141, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/seDql.jpg?s=128&g=1", "display_name": "Imran Ahmad", "link": "https://stackoverflow.com/users/9908141/imran-ahmad"}, "is_accepted": true, "score": 1, "last_activity_date": 1559561915, "last_edit_date": 1559561915, "creation_date": 1559535458, "answer_id": 56421079, "question_id": 56420913, "link": "https://stackoverflow.com/questions/56420913/alias-name-for-nested-resources-rails-routes/56421079#56421079", "title": "Alias name for nested resources rails routes", "body": "<p>The desired path route can be achieved by taking <code>resources :assignments</code> out of the member block.</p>\n\n<pre><code>resources :batch_classes do\n  resources :assignments\n  member do \n    #...\n  end\nend\n</code></pre>\n\n<p>Going through <a href=\"https://guides.rubyonrails.org/routing.html\" rel=\"nofollow noreferrer\">this</a> document is highly recommended for correct implementation.</p>\n"}, {"tags": [], "owner": {"reputation": 1175, "user_id": 2861567, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GRa02.jpg?s=128&g=1", "display_name": "quyetdc", "link": "https://stackoverflow.com/users/2861567/quyetdc"}, "is_accepted": false, "score": 2, "last_activity_date": 1559557574, "creation_date": 1559557574, "answer_id": 56425410, "question_id": 56420913, "link": "https://stackoverflow.com/questions/56420913/alias-name-for-nested-resources-rails-routes/56425410#56425410", "title": "Alias name for nested resources rails routes", "body": "<p>You can have nested routes by just putting nested resource inside parent resources.</p>\n\n<pre><code>resources :batch_classes do\n  resources :assignments\nend\n</code></pre>\n\n<p>Then, you surely will have a route called <code>edit_batch_class_assignment_path</code> and \nyou can pass in instances as <code>edit_batch_class_assignment_path(@batch_class, @assignment)</code></p>\n"}], "owner": {"reputation": 1079, "user_id": 3182184, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/UAty8.jpg?s=128&g=1", "display_name": "Aarvy", "link": "https://stackoverflow.com/users/3182184/aarvy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 289, "favorite_count": 0, "accepted_answer_id": 56421079, "answer_count": 2, "score": 0, "last_activity_date": 1559561915, "creation_date": 1559533646, "last_edit_date": 1559535848, "question_id": 56420913, "link": "https://stackoverflow.com/questions/56420913/alias-name-for-nested-resources-rails-routes", "title": "Alias name for nested resources rails routes", "body": "<p>I have batch_class model, and under that articles, assignments resources are there. The routes.rb look like this.   </p>\n\n<pre><code>resources :batch_classes do\n  member do \n    resources :articles, except: [:index] \n    resources :assignments\n end\n</code></pre>\n\n<p>end</p>\n\n<p>The problem is I am not getting desired URL route. \nMy <code>rake routes</code> for edit <code>assignments</code> shows this.  </p>\n\n<pre><code>/batch_classes/:id/assignments/:id/edit(.:format)\n</code></pre>\n\n<p>with alias name of edit_assignment_path. However, my expected route is </p>\n\n<pre><code>/batch_classes/:batch_class_id/assignments/:id/edit(.:format).\n</code></pre>\n\n<p>Please help. </p>\n"}, {"tags": ["ruby", "tdd"], "comments": [{"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1559532913, "post_id": 56420576, "comment_id": 99436798, "body": "You haven&#39;t defined the class <code>Vampire</code>, for which <code>thirsty?</code> and <code>drink</code> are presumably instance methods. The class also needs an <code>initialize</code> method. Why <code>===</code> rather than <code>==</code> in <code>drink</code>?"}, {"owner": {"reputation": 974, "user_id": 10719564, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/389a0f44307d1c137d141f7d7025c009?s=128&d=identicon&r=PG&f=1", "display_name": "mph85", "link": "https://stackoverflow.com/users/10719564/mph85"}, "reply_to_user": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1559534507, "post_id": 56420576, "comment_id": 99437078, "body": "oh i didn&#39;t include the rest of the code, but I did define a class <code>Vampire</code> and an <code>initialize</code> method that has <code>instance variables</code> of <code>name</code> and <code>pet</code>"}, {"owner": {"reputation": 974, "user_id": 10719564, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/389a0f44307d1c137d141f7d7025c009?s=128&d=identicon&r=PG&f=1", "display_name": "mph85", "link": "https://stackoverflow.com/users/10719564/mph85"}, "reply_to_user": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1559534543, "post_id": 56420576, "comment_id": 99437082, "body": "It&#39;s just a personal preference to use <code>===</code> over <code>==</code>"}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 1, "creation_date": 1559539927, "post_id": 56420576, "comment_id": 99438157, "body": "Your example code should be complete enough for readers to run it and/or modified code without having to guess how gaps are to be filled in. I suggest you edit. Incidentally, I just happened to see your comments that reply to my earlier comment. For me to be notified by SO you need to include @username."}, {"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 1, "creation_date": 1559543869, "post_id": 56420576, "comment_id": 99439286, "body": "&quot;It&#39;s just a personal preference to use <code>===</code> over <code>==</code>&quot; \u2013 Huh? The two mean completely different things, the question of &quot;preference&quot; doesn&#39;t even apply."}, {"owner": {"reputation": 974, "user_id": 10719564, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/389a0f44307d1c137d141f7d7025c009?s=128&d=identicon&r=PG&f=1", "display_name": "mph85", "link": "https://stackoverflow.com/users/10719564/mph85"}, "reply_to_user": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 0, "creation_date": 1559545550, "post_id": 56420576, "comment_id": 99439927, "body": "@J&#246;rgWMittag i just read up on ruby equality operators and it seems that it&#39;s different from javascript. Is <code>===</code> only used in case statements?"}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1559555502, "post_id": 56420576, "comment_id": 99444506, "body": "@mph85 <code>===</code> is the method called by <a href=\"http://ruby-doc.org/core-2.6.3/doc/syntax/control_expressions_rdoc.html#label-case+Expression\" rel=\"nofollow noreferrer\"><code>case</code></a>, hence &quot;case equality&quot;. You rarely call it explicitly."}, {"owner": {"reputation": 974, "user_id": 10719564, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/389a0f44307d1c137d141f7d7025c009?s=128&d=identicon&r=PG&f=1", "display_name": "mph85", "link": "https://stackoverflow.com/users/10719564/mph85"}, "reply_to_user": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1559585015, "post_id": 56420576, "comment_id": 99459370, "body": "@Stefan case would the ruby equivalent to Javascript&#39;s switch statements?"}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1559624691, "post_id": 56420576, "comment_id": 99468969, "body": "@mph85 yes, with a few differences."}, {"owner": {"reputation": 974, "user_id": 10719564, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/389a0f44307d1c137d141f7d7025c009?s=128&d=identicon&r=PG&f=1", "display_name": "mph85", "link": "https://stackoverflow.com/users/10719564/mph85"}, "reply_to_user": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1559627500, "post_id": 56420576, "comment_id": 99469745, "body": "@Stefan so you&#39;re saying that in Javascript you can do things like compare if <code>1 === &#39;1&#39; (false)</code>, but you can&#39;t do <code>1 === &#39;1&#39;</code> in ruby unless this was in a case statement?"}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1559630305, "post_id": 56420576, "comment_id": 99470697, "body": "@mph85 no no no. JavaScript&#39;s <code>===</code> and Ruby&#39;s implementations for <code>===</code> are very different. In Ruby each class can implement its own <code>===</code> to provide meaningful behavior when used as a &quot;pattern&quot; in a <code>case</code> expression. For example, <a href=\"http://ruby-doc.org/core-2.6.3/Range.html#method-i-3D-3D-3D\" rel=\"nofollow noreferrer\"><code>Range#===</code></a> returns <code>true</code> if the argument is an element of the range. This allows you to write <code>case 1</code> and match it via <code>when 0..2</code>. Internally, <code>(0..2) === 1</code> is called, which returns <code>true</code>."}, {"owner": {"reputation": 974, "user_id": 10719564, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/389a0f44307d1c137d141f7d7025c009?s=128&d=identicon&r=PG&f=1", "display_name": "mph85", "link": "https://stackoverflow.com/users/10719564/mph85"}, "reply_to_user": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1559633332, "post_id": 56420576, "comment_id": 99472031, "body": "@Stefan so in my example above, I was questioned about my use of <code>===</code>, what&#39;s wrong there?"}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "reply_to_user": {"reputation": 974, "user_id": 10719564, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/389a0f44307d1c137d141f7d7025c009?s=128&d=identicon&r=PG&f=1", "display_name": "mph85", "link": "https://stackoverflow.com/users/10719564/mph85"}, "edited": false, "score": 0, "creation_date": 1559633362, "post_id": 56420576, "comment_id": 99472049, "body": "Let us <a href=\"https://chat.stackoverflow.com/rooms/194415/discussion-between-stefan-and-mph85\">continue this discussion in chat</a>."}], "answers": [{"comments": [{"owner": {"reputation": 974, "user_id": 10719564, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/389a0f44307d1c137d141f7d7025c009?s=128&d=identicon&r=PG&f=1", "display_name": "mph85", "link": "https://stackoverflow.com/users/10719564/mph85"}, "edited": false, "score": 0, "creation_date": 1559535660, "post_id": 56420912, "comment_id": 99437306, "body": "hm i tried the <code>alias_method</code> and it gave me <code>alias_method: undefined method </code>thirsty&#39; for class <code>Vampire&#39; (NameError)</code>"}, {"owner": {"reputation": 974, "user_id": 10719564, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/389a0f44307d1c137d141f7d7025c009?s=128&d=identicon&r=PG&f=1", "display_name": "mph85", "link": "https://stackoverflow.com/users/10719564/mph85"}, "edited": false, "score": 0, "creation_date": 1559535747, "post_id": 56420912, "comment_id": 99437327, "body": "how would i solve this if i just keep the <code>def thirsty?</code> method"}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "reply_to_user": {"reputation": 974, "user_id": 10719564, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/389a0f44307d1c137d141f7d7025c009?s=128&d=identicon&r=PG&f=1", "display_name": "mph85", "link": "https://stackoverflow.com/users/10719564/mph85"}, "edited": false, "score": 2, "creation_date": 1559556171, "post_id": 56420912, "comment_id": 99444846, "body": "@mph85 it should probably be <code>attr_reader :name, :thirsty</code>. But you can also implement it as a stand-alone method yourself: <code>def thirsty? ; @thirsty ; end</code> (semicolon = newline). It merely returns the value of <code>@thirsty</code>, i.e. either <code>true</code> or <code>false</code>."}, {"owner": {"reputation": 3201, "user_id": 2892779, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uvM8S.jpg?s=128&g=1", "display_name": "Jay Dorsey", "link": "https://stackoverflow.com/users/2892779/jay-dorsey"}, "reply_to_user": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1559566884, "post_id": 56420912, "comment_id": 99450296, "body": "@Stefan is correct, I copy/pasted a typo. If you update the reader as noted, it should work. I updated my answer to add it as a reader"}, {"owner": {"reputation": 3201, "user_id": 2892779, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uvM8S.jpg?s=128&g=1", "display_name": "Jay Dorsey", "link": "https://stackoverflow.com/users/2892779/jay-dorsey"}, "edited": false, "score": 0, "creation_date": 1560044136, "post_id": 56420912, "comment_id": 99609453, "body": "I edited this to remove the attr_reader/alias based on feedback from a follow up question. It wasn&#39;t necessary and looking back on it I don&#39;t even know why I had the alias and the attr_reader to begin with."}], "tags": [], "owner": {"reputation": 3201, "user_id": 2892779, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uvM8S.jpg?s=128&g=1", "display_name": "Jay Dorsey", "link": "https://stackoverflow.com/users/2892779/jay-dorsey"}, "is_accepted": true, "score": 1, "last_activity_date": 1560044016, "last_edit_date": 1560044016, "creation_date": 1559533630, "answer_id": 56420912, "question_id": 56420576, "link": "https://stackoverflow.com/questions/56420576/ruby-making-test-pass/56420912#56420912", "title": "Ruby - Making test pass", "body": "<p>You're missing a couple things, most importantly some kind of writer method that allows you to store that fact that <code>@thirsty</code> is getting updated inside of your <code>drink</code> method call</p>\n\n<p>There's a couple different ways to do this but I've shown one below with a few notes:</p>\n\n<pre><code>require 'test/unit'\n\nclass Vampire\n  def initialize(name)\n    @name = name\n    @thirsty = true # true by default\n  end\n\n  def drink\n    @thirsty = false # updates @thirsty for the respective instance\n  end\n\n  def thirsty?\n    @thirsty\n  end\nend\n\nclass VampireTests &lt; Test::Unit::TestCase\n  def test_it_is_thirsty_by_default\n    vampire = Vampire.new(\"Count von Count\")\n    assert vampire.thirsty?\n  end\n\n  def test_it_is_not_thirsty_after_drinking\n    vampire = Vampire.new(\"Elizabeth Bathory\")\n    vampire.drink\n    refute vampire.thirsty?\n  end\nend\n</code></pre>\n"}], "owner": {"reputation": 974, "user_id": 10719564, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/389a0f44307d1c137d141f7d7025c009?s=128&d=identicon&r=PG&f=1", "display_name": "mph85", "link": "https://stackoverflow.com/users/10719564/mph85"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 98, "favorite_count": 0, "accepted_answer_id": 56420912, "answer_count": 1, "score": 1, "last_activity_date": 1560044016, "creation_date": 1559529712, "last_edit_date": 1559530304, "question_id": 56420576, "link": "https://stackoverflow.com/questions/56420576/ruby-making-test-pass", "title": "Ruby - Making test pass", "body": "<p>I'm trying to make this test pass and am not sure how to go about making this pass.</p>\n\n<p><strong>TEST</strong></p>\n\n<pre><code>def test_it_is_thirsty_by_default\n  vampire = Vampire.new(\"Count von Count\")\n  assert vampire.thirsty?\nend\n\ndef test_it_is_not_thirsty_after_drinking\n  vampire = Vampire.new(\"Elizabeth Bathory\")\n  vampire.drink\n  refute vampire.thirsty?\nend\n</code></pre>\n\n<p><strong>CODE</strong></p>\n\n<pre><code>def thirsty?\n  true\nend\n\ndef drink\n  thirsty? === false\nend\n</code></pre>\n\n<p>It is giving a failure message on the last test:</p>\n\n<p><code>Failed refutation, no message given</code></p>\n\n<p>What am I missing? My thought is that initially, the vampire is thirsty(true) and then defined a method that would then make the vampire not thirsty(false).</p>\n\n<p><strong>EDIT</strong></p>\n\n<p>Even if I reassign the drink method to:</p>\n\n<p><code>thirsty? = false</code></p>\n\n<p>I get a syntax error pointing to the <code>=</code> sign. </p>\n"}, {"tags": ["ruby-on-rails", "ruby", "shopify", "shopify-app", "shopify-activemerchant"], "comments": [{"owner": {"reputation": 8203, "user_id": 210841, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/5adbe9e20522d6a177e76b223b6750ed?s=128&d=identicon&r=PG", "display_name": "David Lazar", "link": "https://stackoverflow.com/users/210841/david-lazar"}, "edited": false, "score": 0, "creation_date": 1559574194, "post_id": 56420451, "comment_id": 99454386, "body": "There is a pretty high probability that your current_user is jack all nothing. Otherwise, that code would work. Investigate that. You provided no details on your data, so lets assume you never checked any of it for validity."}, {"owner": {"reputation": 1263, "user_id": 10221813, "user_type": "registered", "profile_image": "https://graph.facebook.com/10160530708235447/picture?type=large", "display_name": "uno", "link": "https://stackoverflow.com/users/10221813/uno"}, "reply_to_user": {"reputation": 8203, "user_id": 210841, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/5adbe9e20522d6a177e76b223b6750ed?s=128&d=identicon&r=PG", "display_name": "David Lazar", "link": "https://stackoverflow.com/users/210841/david-lazar"}, "edited": false, "score": 0, "creation_date": 1559590352, "post_id": 56420451, "comment_id": 99461289, "body": "By jack all nothing, what do you mean exactly? I tested the associations in the console and they appear.   I guess ill try by hard coding the records and see what happpens... But when i sign in through the email, it still redirects me to enter the shopify domain, then it works.  I&#39;m about to test if the webhooks are working to make sure it&#39;s still connected that way.  I noticed when i log out of the devise sessions, it kills the shopify session as well and disconnects it."}, {"owner": {"reputation": 8203, "user_id": 210841, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/5adbe9e20522d6a177e76b223b6750ed?s=128&d=identicon&r=PG", "display_name": "David Lazar", "link": "https://stackoverflow.com/users/210841/david-lazar"}, "edited": false, "score": 0, "creation_date": 1559593301, "post_id": 56420451, "comment_id": 99462373, "body": "You are juggling a lot of code you never wrote, expecting it to just work. At some point you need to debug a simple thing. If for example you login some user in your Rails App, and that is failing, then debug. Are you finding a Shop? No? Then current_user does not exist for a shop. What is current_user? You get it?  Anyway, your question is not really a question. What is your actual real question?"}, {"owner": {"reputation": 1263, "user_id": 10221813, "user_type": "registered", "profile_image": "https://graph.facebook.com/10160530708235447/picture?type=large", "display_name": "uno", "link": "https://stackoverflow.com/users/10221813/uno"}, "reply_to_user": {"reputation": 8203, "user_id": 210841, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/5adbe9e20522d6a177e76b223b6750ed?s=128&d=identicon&r=PG", "display_name": "David Lazar", "link": "https://stackoverflow.com/users/210841/david-lazar"}, "edited": false, "score": 0, "creation_date": 1559613071, "post_id": 56420451, "comment_id": 99466866, "body": "It seems the new way to do things is by doing <code>session = ShopifyAPI::Session.new(domain: shop.shopify_domain, token: shop.shopify_token, api_version: &#39;2019-04&#39;)</code> but this gives me error : <code>NoMethodError (undefined method &quot;strip&quot; for #&lt;Hash:0x000055b6d43b93a0&gt;)</code> from here: <a href=\"https://github.com/Shopify/shopify_api/blob/master/lib/shopify_api/session.rb\" rel=\"nofollow noreferrer\">github.com/Shopify/shopify_api/blob/master/lib/shopify_api/&hellip;</a>"}, {"owner": {"reputation": 1263, "user_id": 10221813, "user_type": "registered", "profile_image": "https://graph.facebook.com/10160530708235447/picture?type=large", "display_name": "uno", "link": "https://stackoverflow.com/users/10221813/uno"}, "reply_to_user": {"reputation": 8203, "user_id": 210841, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/5adbe9e20522d6a177e76b223b6750ed?s=128&d=identicon&r=PG", "display_name": "David Lazar", "link": "https://stackoverflow.com/users/210841/david-lazar"}, "edited": false, "score": 0, "creation_date": 1559613155, "post_id": 56420451, "comment_id": 99466876, "body": "I also tried coding the domain and token directly into the session and it still would give the same error"}, {"owner": {"reputation": 1263, "user_id": 10221813, "user_type": "registered", "profile_image": "https://graph.facebook.com/10160530708235447/picture?type=large", "display_name": "uno", "link": "https://stackoverflow.com/users/10221813/uno"}, "reply_to_user": {"reputation": 8203, "user_id": 210841, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/5adbe9e20522d6a177e76b223b6750ed?s=128&d=identicon&r=PG", "display_name": "David Lazar", "link": "https://stackoverflow.com/users/210841/david-lazar"}, "edited": false, "score": 0, "creation_date": 1559616500, "post_id": 56420451, "comment_id": 99467427, "body": "While signing in with a user that doesn&#39;t have a Shop attached i get <code>ShopifyAPI::Base::InvalidSessionError (Session cannot be nil)</code> ..."}], "owner": {"reputation": 1263, "user_id": 10221813, "user_type": "registered", "profile_image": "https://graph.facebook.com/10160530708235447/picture?type=large", "display_name": "uno", "link": "https://stackoverflow.com/users/10221813/uno"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 325, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1559528497, "creation_date": 1559528497, "question_id": 56420451, "link": "https://stackoverflow.com/questions/56420451/starting-a-new-shopify-session-from-shopify-token-and-shopify-domain", "title": "Starting a new shopify session from shopify_token and shopify_domain?", "body": "<p>I have a user_id attached to the Store model for a Shopify App.  I want to be able to have a user login with their user account to have the shopify session start instead of using needing to open the app from their app section of their store. This is a standalone app btw.</p>\n\n<p>I have tried this for when users sign in:</p>\n\n<pre><code>if Shop.find_by(user_id: current_user)\n  shop = Shop.find_by(user_id: current_user)\n  shop = ShopifyAPI::Session.new(shop.shopify_domain, shop.shopify_token)\n  ShopifyAPI::Base.activate_session(shop)\nend\n</code></pre>\n\n<p>and:</p>\n\n<pre><code>if Shop.find_by(user_id: current_user)\n  shop = Shop.find_by(user_id: current_user)\n  shop = ShopifyApp::SessionRepository.retrieve(shop.id)\n  ShopifyAPI::Base.activate_session(shop)\nend\n</code></pre>\n\n<p>I tried this in my session create method and as a after_action callback for the create method in the sessions controller... </p>\n\n<p>Is there something I am doing wrong?</p>\n\n<p>I tested this in console to make sure all of the assocations were correct.  The token and shopify_domain are all there attached to the user</p>\n"}, {"tags": ["jquery", "ruby-on-rails", "ruby", "routing", "actioncable"], "comments": [{"owner": {"reputation": 4690, "user_id": 1937435, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/YyN37.jpg?s=128&g=1", "display_name": "Josh Brody", "link": "https://stackoverflow.com/users/1937435/josh-brody"}, "edited": false, "score": 0, "creation_date": 1559527109, "post_id": 56420273, "comment_id": 99435956, "body": "you&#39;re looking for a <code>patch</code> or  <code>put</code> request  which corresponds to your <code>update</code> action on your controller."}], "answers": [{"comments": [{"owner": {"reputation": 13378, "user_id": 1430810, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/v669u.jpg?s=128&g=1", "display_name": "arieljuod", "link": "https://stackoverflow.com/users/1430810/arieljuod"}, "reply_to_user": {"reputation": 61, "user_id": 4909802, "user_type": "registered", "accept_rate": 17, "profile_image": "https://graph.facebook.com/10152953311950318/picture?type=large", "display_name": "Misanthropos", "link": "https://stackoverflow.com/users/4909802/misanthropos"}, "edited": false, "score": 0, "creation_date": 1559528273, "post_id": 56420340, "comment_id": 99436074, "body": "Is the callback of the event being called? add a <code>debugger;</code> line inside it. You can use <code>stopEverything(e)</code> instead of <code>e.preventDefault()</code> just to try. Also, you shouldn&#39;t need to <code>return false</code> to stop rails-ujs ajax event."}, {"owner": {"reputation": 61, "user_id": 4909802, "user_type": "registered", "accept_rate": 17, "profile_image": "https://graph.facebook.com/10152953311950318/picture?type=large", "display_name": "Misanthropos", "link": "https://stackoverflow.com/users/4909802/misanthropos"}, "edited": false, "score": 0, "creation_date": 1559530521, "post_id": 56420340, "comment_id": 99436432, "body": "I checked it in the inspect console: <code>$(&#39;#new_comment&#39;)</code> Returns <code>jQuery.fn.init\u00a0[form#new_comment.new_comment]</code>  <code>$(&#39;new_comment&#39;) .val()</code> returns <code>&quot;&quot;</code>"}], "tags": [], "owner": {"reputation": 13378, "user_id": 1430810, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/v669u.jpg?s=128&g=1", "display_name": "arieljuod", "link": "https://stackoverflow.com/users/1430810/arieljuod"}, "is_accepted": false, "score": 0, "last_activity_date": 1559527258, "creation_date": 1559527258, "answer_id": 56420340, "question_id": 56420273, "link": "https://stackoverflow.com/questions/56420273/actioncontrollerroutingerror-no-route-matches-post-blogs-my-blog-post-1/56420340#56420340", "title": "ActionController::RoutingError (No route matches [POST] &quot;/blogs/my-blog-post-1&quot;) when using ActionCable channel", "body": "<p>It looks like you are trying to stop the form submission but you are not doing it the way it's supossed when using rails <code>form_with</code> helper, it renders a remote form by default so you need to stop the rails special events.</p>\n\n<p>Check the guide on how to stop a rails' remote event <a href=\"https://guides.rubyonrails.org/working_with_javascript_in_rails.html#stoppable-events\" rel=\"nofollow noreferrer\">https://guides.rubyonrails.org/working_with_javascript_in_rails.html#stoppable-events</a></p>\n\n<p>You need to listen for the <code>ajax:before</code> event, not the <code>submit</code> event.</p>\n\n<p>So, change <code>$('#new_comment').submit (e) ...</code> with <code>$('#new_comment').on 'ajax:before', (e) ...</code></p>\n"}], "owner": {"reputation": 61, "user_id": 4909802, "user_type": "registered", "accept_rate": 17, "profile_image": "https://graph.facebook.com/10152953311950318/picture?type=large", "display_name": "Misanthropos", "link": "https://stackoverflow.com/users/4909802/misanthropos"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 360, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1559532380, "creation_date": 1559526554, "last_edit_date": 1559532380, "question_id": 56420273, "link": "https://stackoverflow.com/questions/56420273/actioncontrollerroutingerror-no-route-matches-post-blogs-my-blog-post-1", "title": "ActionController::RoutingError (No route matches [POST] &quot;/blogs/my-blog-post-1&quot;) when using ActionCable channel", "body": "<p>This is an application I started developing as part of a code-along that was produced by <a href=\"https://www.devcamp.com\" rel=\"nofollow noreferrer\">DevCamp</a> While it has been great at helping me understand Rails 5 better, it is a little out of date in some places and I have had some really interesting times debugging things that have changed since its release.</p>\n\n<p>I am at a step where I attempt to set up a blog with comments wired through ActionCable so they update live without refreshing the page. When I post them I receive an error and, of course, the page doesn't update the way I would like.</p>\n\n<p><code>ActionController::RoutingError (No route matches [POST] \"/blogs/my-blog-post-1\")</code></p>\n\n<p>Here is what I know I've changed to implement this. I'm fairly familiar with Ruby and Rails, but I am new to Javascript and its libraries. Any help you could provide would be much appreciated (<a href=\"https://github.com/InsomniaNoir/portfolio-app/tree/action-cable\" rel=\"nofollow noreferrer\">view github repo branch here</a>)</p>\n\n<p>routes.rb</p>\n\n<pre><code>Rails.application.routes.draw do\n  devise_for :users, path: '', path_names: { sign_in: 'login', sign_out: 'logout', sign_up: 'register' }\n  resources :folios, except: [:show] do\n    put :sort, on: :collection\n  end\n\n  get 'folio/:id', to: 'folios#show', as: 'folio_show'\n\n  get 'about-me', to: 'pages#about'\n  get 'contact', to: 'pages#contact'\n\n  resources :blogs do\n    member do\n      get :toggle_status\n    end\n  end\n\n  mount ActionCable.server =&gt; '/cable'\n\n  root to: 'pages#home'\nend\n</code></pre>\n\n<p>Blogs Channel</p>\n\n<pre><code>class BlogsChannel &lt; ApplicationCable::Channel\n  def subscribed\n    stream_from \"blogs_#{params['blog_id']}_channel\"\n  end\n\n  def unsubscribed\n  end\n\n  def send_comment(data)\n    current_user.comments.create!(content: data['comment'], blog_id: data['blog_id'])\n  end\nend\n</code></pre>\n\n<p>connection.rb</p>\n\n<pre><code>module ApplicationCable\n  class Connection &lt; ActionCable::Connection::Base\n    identified_by :current_user\n\n    def guest_user\n      guest = GuestUser.new\n      guest.id = guest.object_id\n      guest.name = \"Guest User\"\n      guest.first_name = \"Guest\"\n      guest.last_name = \"User\"\n      guest.email = 'guest@guestuser.com'\n      guest = GuestUser.new\n      guest = GuestUser.new\n      guest = GuestUser.new\n      guest = GuestUser.new\n      guest\n    end\n\n    def connect\n      self.current_user = find_verified_user || guest_user\n      logger.add_tags 'ActionCable', current_user.email\n      logger.add_tags 'ActionCable', current_user.id\n    end\n\n    protected\n\n    def find_verified_user\n      if verified_user = env['warden'].user\n        verified_user\n      end\n    end\n\n  end\nend\n</code></pre>\n\n<p>blogs.coffee (now in the proper file directory)</p>\n\n<pre><code>jQuery(document).on 'turbolinks:load', -&gt;\n  comments = $('#comments')\n  if comments.length &gt; 0\n    App.global_chat = App.cable.subscriptions.create {\n      channel: \"BlogsChannel\"\n      blog_id: comments.data('blog-id')\n    },\n    connected: -&gt;\n    disconnected: -&gt;\n    received: (data) -&gt;\n      comments.append data['comment']\n    send_comment: (comment, blog_id) -&gt;\n      @perform 'send_comment', comment: comment, blog_id: blog_id\n  $('#new_comment').on 'ajax:before', (e) -&gt;\n    $this = $(this)\n    textarea = $this.find('#comment_content')\n    if $.trim(textarea.val()).length &gt; 1\n      App.global_chat.send_comment textarea.val(),\n      comments.data('blog-id')\n      textarea.val('')\n    e.preventDefault()\n    return false\n</code></pre>\n\n<p>Compiled JS from coffeescript</p>\n\n<pre><code>var comments;\n\ncomments = $('#comments');\n\nif (comments.length &gt; 0) {\n  App.global_chat = App.cable.subscriptions.create({\n    channel: \"BlogsChannel\",\n    blog_id: comments.data('blog-id')\n  }, {\n    connected: function() {},\n    disconnected: function() {},\n    received: function(data) {\n      return comments.append(data['comment']);\n    },\n    send_comment: function(comment, blog_id) {\n      return this.perform('send_comment', {\n        comment: comment,\n        blog_id: blog_id\n      });\n    }\n  });\n}\n\n$('#new_comment').on('ajax:before', function(e) {\n  var $this, textarea;\n  $this = $(this);\n  textarea = $this.find('#comment_content');\n  if ($.trim(textarea.val()).length &gt; 1) {\n    App.global_chat.send_comment(textarea.val(), comments.data('blog-id'));\n    textarea.val('');\n  }\n  e.preventDefault();\n  return false;\n});\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "module"], "answers": [{"tags": [], "owner": {"reputation": 14450, "user_id": 438615, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/Dseeq.jpg?s=128&g=1", "display_name": "Jonah", "link": "https://stackoverflow.com/users/438615/jonah"}, "is_accepted": true, "score": 1, "last_activity_date": 1559524208, "creation_date": 1559524208, "answer_id": 56420119, "question_id": 56419649, "link": "https://stackoverflow.com/questions/56419649/rails-module-name-vs-module-name-and-modules-being-splitted-between-several-fi/56420119#56420119", "title": "Rails ::module_name vs module_name and modules being splitted between several files", "body": "<blockquote>\n  <p>Both ways work, so what's the difference? Also, I've seen cases where a module is split in several files, for example:</p>\n</blockquote>\n\n<p><code>::</code> allows you to target root level scopes.  By default ruby searches up the current scope tree that you're in.  I know that sounds vague, but an example will make this clear:</p>\n\n<pre><code>module A\n  module B\n    def self.test\n      A::C.test\n      D::B.test\n      ::D::B.test\n    end\n  end\n\n  module C\n    def self.test\n      p \"calling A::C\"\n    end\n  end\n\n  module D\n    module B\n      def self.test\n        p \"calling A::D::B\"\n      end\n    end\n  end\nend\n\nmodule D\n  module B\n    def self.test\n      p \"calling D::B\"\n    end\n  end\nend\n\nA::B::test\n</code></pre>\n\n<p>This will print:</p>\n\n<pre><code>\"calling A::C\"\n\"calling A::D::B\"\n\"calling D::B\"\n</code></pre>\n\n<blockquote>\n  <p>Is there any difference (besides the obvious... which is smaller files) between both options?</p>\n</blockquote>\n\n<p>Both of those will work the same.  Typically, in ruby, you do one class definition per file, with the file named after the class.  So you'll more often see the two file version, and I'd recommend that for style, but it doesn't matter.</p>\n"}], "owner": {"reputation": 1812, "user_id": 4305712, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/YMMqA.png?s=128&g=1", "display_name": "Patricio Sard", "link": "https://stackoverflow.com/users/4305712/patricio-sard"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 793, "favorite_count": 0, "accepted_answer_id": 56420119, "answer_count": 1, "score": 1, "last_activity_date": 1559524208, "creation_date": 1559517167, "question_id": 56419649, "link": "https://stackoverflow.com/questions/56419649/rails-module-name-vs-module-name-and-modules-being-splitted-between-several-fi", "title": "Rails ::module_name vs module_name and modules being splitted between several files", "body": "<p>Let's say I have a parser module (<code>parser.rb</code>) inside <code>app/lib</code>:</p>\n\n<pre><code>module Parsers\n    class XMLParser\n        def self.parse\n            \"Parsing XML....\"\n        end\n    end\n\n    class TXTParser\n        def self.parse\n            \"Parsing TXT....\"\n        end\n    end\nend\n</code></pre>\n\n<p>I've seen some people calling the classes like this:</p>\n\n<pre><code>@parse_xml = ::Parsers::XMLParser.parse\n@parse_txt = ::Parsers::TXTParser.parse\n</code></pre>\n\n<p>Instead of:</p>\n\n<pre><code>@parse_xml = Parsers::XMLParser.parse\n@parse_txt = Parsers::TXTParser.parse\n</code></pre>\n\n<p>Both ways work, so what's the difference? Also, I've seen cases where a module is split in several files, for example:</p>\n\n<p>Inside <code>app/lib/parsers/xml_parser.rb</code>:</p>\n\n<pre><code>module Parsers\n    class XMLParser\n        def self.parse\n            \"Parsing XML....\"\n        end\n    end\nend\n</code></pre>\n\n<p>And inside <code>app/lib/parsers/txt_parser.rb</code>:</p>\n\n<pre><code>module Parsers\n    class TXTParser\n        def self.parse\n            \"Parsing XML....\"\n        end\n    end\nend\n</code></pre>\n\n<p>Is there any difference (besides the obvious... which is smaller files) between both options?</p>\n"}, {"tags": ["ruby", "erb"], "comments": [{"owner": {"reputation": 14450, "user_id": 438615, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/Dseeq.jpg?s=128&g=1", "display_name": "Jonah", "link": "https://stackoverflow.com/users/438615/jonah"}, "edited": false, "score": 2, "creation_date": 1559523002, "post_id": 56419514, "comment_id": 99435510, "body": "You have a syntax error in your code snippet: <code>if mapping.nil? ? original_value : mapping</code>.  Looks like you just need to delete the <code>if</code> since the ternary <i>is</i> the if logic."}], "answers": [{"tags": [], "owner": {"reputation": 1306, "user_id": 8008340, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/15JhO.jpg?s=128&g=1", "display_name": "Konstantin Strukov", "link": "https://stackoverflow.com/users/8008340/konstantin-strukov"}, "is_accepted": true, "score": 3, "last_activity_date": 1559552508, "last_edit_date": 1559552508, "creation_date": 1559550530, "answer_id": 56423630, "question_id": 56419514, "link": "https://stackoverflow.com/questions/56419514/trouble-reading-and-binding-yml-data-in-ruby/56423630#56423630", "title": "Trouble reading and binding yml data in ruby", "body": "<p>There are several problems in your code:</p>\n\n<ol>\n<li>YAML example looks broken. The proper one should looks like:</li>\n</ol>\n\n<pre><code>common:\n  substitute:\n    foo: fee\n</code></pre>\n\n<ol start=\"2\">\n<li><p>You're trying to fetch <code>common</code> key in <code>common = data[:common]</code> using a symbol as a key, but it should be a string (<code>data[\"common\"]</code>). Also, I'd say it's a bad idea to spilt fetching logic into two pieces - first extract \"common\" outside of <code>substitute_when_needed</code> and then <code>dig</code> into it inside.</p></li>\n<li><p><code>if</code> statement is broken. It should be either proper <code>if</code> or proper ternary operator.</p></li>\n</ol>\n\n<p>Fixing all this gives us something like (I've just replaced a file with StringIO for convenience - to make the snippet executable as is):</p>\n\n<pre><code>yaml = StringIO.new(&lt;&lt;~DATA)\n  common:\n    substitute:\n      foo: fee\nDATA\n\ndef substitute_if_needed(data, original_value)\n  mapping = data.dig(\"common\", \"substitute\", original_value)\n  mapping.nil? ? original_value : mapping\nend\n\ndata = YAML.load(yaml)\n\nsubstitute_if_needed(data, \"foo\") # =&gt; \"fee\"\nsubstitute_if_needed(data, \"bar\") # =&gt; \"bar\"\n</code></pre>\n"}], "owner": {"reputation": 1608, "user_id": 1758023, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/8867b4c763d9995de34ec14bfb9fbdab?s=128&d=identicon&r=PG", "display_name": "Mark", "link": "https://stackoverflow.com/users/1758023/mark"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 52, "favorite_count": 0, "accepted_answer_id": 56423630, "answer_count": 1, "score": 0, "last_activity_date": 1559552508, "creation_date": 1559515736, "question_id": 56419514, "link": "https://stackoverflow.com/questions/56419514/trouble-reading-and-binding-yml-data-in-ruby", "title": "Trouble reading and binding yml data in ruby", "body": "<p>I have a yaml file that includes the following:</p>\n\n<pre><code>:common\n  :substitue\n    :foo: fee\n</code></pre>\n\n<p>I read this data like:</p>\n\n<pre><code>data = YAML.load(erb_data[File.basename(__FILE__, '.*')].result(binding))\n\ncommon = data[:common]\n\ndef substitute_if_needed(original_value)\n    mapping = common.dig(:substitue, original_value)\n    if mapping.nil? ? original_value : mapping\nend\n</code></pre>\n\n<p>Unfortunately, this doesn't do the substitution that I want. I want to call <code>substitute_if_needed('foo')</code> and get 'fee' back. I also want to call <code>substitute_if_needed('bar')</code> and get 'bar' back.</p>\n\n<p>How can I do this?</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 0, "creation_date": 1559515328, "post_id": 56419043, "comment_id": 99434480, "body": "Your code has a lot of issues. Why don&#39;t you start by making a working function that <i>doesnt</i> account for caps .. from that point it&#39;s easy to add this extra bit of functionality just by using upcase or downcase when you compare the sentence word to the curse word"}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1559546077, "post_id": 56419043, "comment_id": 99440130, "body": "<i>&quot;capitalization is relevant&quot;</i> \u2013 I&#39;d say it&#39;s irrelevant. Seems to depend on your point of view ;-)"}], "answers": [{"tags": [], "owner": {"reputation": 39, "user_id": 11570390, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-YCpYNjpVkYU/AAAAAAAAAAI/AAAAAAAAAGU/IGapoP6neDM/photo.jpg?sz=128", "display_name": "Joe Horn", "link": "https://stackoverflow.com/users/11570390/joe-horn"}, "is_accepted": false, "score": 0, "last_activity_date": 1559527982, "creation_date": 1559527982, "answer_id": 56420399, "question_id": 56419043, "link": "https://stackoverflow.com/questions/56419043/parsing-an-array-to-find-individual-word-capitalization-is-relevant/56420399#56420399", "title": "Parsing an array to find individual word, capitalization is relevant", "body": "<p>Here is what I ended up with, maybe there's a better way to do it, so if so please let me know. I was caught up with the lowercase, upcase, first character upcase, when I should have just got a pen and pencil and worked through it.</p>\n\n<pre><code>\ndef get_stared(word)\n  vowels = \"aeiou\"\n  result = \"\"\n\n  word.each_char do |char|\n    if vowels.include?(char.downcase)\n      result += \"*\"\n    else\n      result += char\n    end\n  end\n  result\nend\n\ndef censor(sentence, curse_words)\n\n  words = sentence.split(\" \")\n\n  new_words = words.map do |word|\n    if curse_words.include?(word.downcase)\n      get_stared(word)\n    else\n      word\n    end\n\n  end\nnew_words.join(\" \")\nend\n\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 14450, "user_id": 438615, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/Dseeq.jpg?s=128&g=1", "display_name": "Jonah", "link": "https://stackoverflow.com/users/438615/jonah"}, "is_accepted": false, "score": 0, "last_activity_date": 1559530642, "creation_date": 1559530642, "answer_id": 56420648, "question_id": 56419043, "link": "https://stackoverflow.com/questions/56419043/parsing-an-array-to-find-individual-word-capitalization-is-relevant/56420648#56420648", "title": "Parsing an array to find individual word, capitalization is relevant", "body": "<p>If you take advantage of ruby's builtins, this can be done more elegantly:</p>\n\n<pre><code>def censor(sentence, curse)\n  curse_re = Regexp.new(Regexp.union(curse).source, 'i')\n  sentence.split(' ').map do |word|\n    curse_re.match(word) ? word.gsub(/[aeiou]/i, '*') : word\n  end.join(' ')\nend\n</code></pre>\n\n<p>This works for both your test cases: <a href=\"https://tio.run/##VY/NasMwEITveopFF0klKPdC6KVtcqrBdU8hFMfa2gqJ1uiHtJB3dySnofS0szvzDaxP@59pMvgFHbpAXgZ0EV2HC@iSD6gY3MSnR1hBjT1@j9rhWf7K5Cw5ecvqQMkXVFhRwHuXDuPRRilAKH1qRzAElzN5c8mZv/psxW6QxVDwBGXqPqS9XG5btJR2S5ubH4SCx9nMMDqjD2TdXM3yxhgbUwz3Z/iawgCm9Q5s5AvY8j4fsuDlVmYYiCLfqf/Y@@ajgWbzAq919dbAc1XVM22IfA5P0xU\" rel=\"nofollow noreferrer\" title=\"Ruby \u2013 Try It Online\">Try it online!</a></p>\n\n<p>The <code>i</code> flag makes the vowels ignore case, and the <code>curse_re</code> will match any of the curse words, also ignoring case.</p>\n\n<p>For future reference, you'll get better responses for this kind of question on the <a href=\"https://codereview.stackexchange.com/\">SE codereview site</a>.</p>\n"}, {"tags": [], "owner": {"reputation": 616, "user_id": 7922428, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vINFX.png?s=128&g=1", "display_name": "Bman70", "link": "https://stackoverflow.com/users/7922428/bman70"}, "is_accepted": false, "score": 0, "last_activity_date": 1559535472, "last_edit_date": 1559535472, "creation_date": 1559531146, "answer_id": 56420679, "question_id": 56419043, "link": "https://stackoverflow.com/questions/56419043/parsing-an-array-to-find-individual-word-capitalization-is-relevant/56420679#56420679", "title": "Parsing an array to find individual word, capitalization is relevant", "body": "<p>Probably a ton of ways to do this, that's what's fun about coding. Here's one way if you want to use regex. The vowel substitution is case insensitive so it takes care of that issue: </p>\n\n<pre><code>sentence = \"Darn, DARN! I forgot my pizza. SHOOT, flip this!\" \nbwords = %w(darn shoot flip) #cuss words to censor\ncensored = [] #array for the result\n\nwords = sentence.split(\" \")\n\nfor word in words\nword = word.gsub(/[aeiou]/i, \"*\") if bwords.include? word.downcase.gsub(/[^a-z0-9\\s]/, '')\ncensored.push(word) #put censored word in new array\nend\n\nputs censored.join(' ')\n</code></pre>\n\n<p>Outputs: </p>\n\n<p><code>D*rn, D*RN! I forgot my pizza. SH**T, fl*p this!</code></p>\n"}, {"tags": [], "owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "is_accepted": false, "score": 1, "last_activity_date": 1559567820, "last_edit_date": 1559567820, "creation_date": 1559532347, "answer_id": 56420784, "question_id": 56419043, "link": "https://stackoverflow.com/questions/56419043/parsing-an-array-to-find-individual-word-capitalization-is-relevant/56420784#56420784", "title": "Parsing an array to find individual word, capitalization is relevant", "body": "<p>There is no need to break the string into words, edit each word and then join them back together to form a new string.</p>\n\n<pre><code>def censor(sentence, coarse_words)\n   sentence.gsub(/\\p{L}+/) { |word|\n     coarse_words.include?(word.downcase) ? word.gsub(/[aeiou]/i, '*') : word }\nend\n</code></pre>\n\n<h1><p></p></h1>\n\n<pre><code>censor \"Gosh darn it\", [\"gosh\", \"darn\", \"shoot\"]\n  #=&gt; \"G*sh d*rn it\"\ncensor \"SHUT THE FRONT DOOR AFTER YOUR ARE OUTDOORS\", [\"door\"]\n  #=&gt; \"SHUT THE FRONT D**R AFTER YOUR ARE OUTDOORS\"\n</code></pre>\n\n<p>For readers unfamiliar with <code>\\p{L}</code>, search <a href=\"http://ruby-doc.org/core-2.5.1/Regexp.html\" rel=\"nofollow noreferrer\">Regexp</a> for it. It's the same as <code>\\p{Alpha}</code> and <code>[[:alpha:]]</code>, which are documented in the same file.</p>\n\n<p>If there were a large amount of text to be filtered, it would be more efficient to create a set of coarse words:</p>\n\n<pre><code>require 'set'\n\ndef censor(sentence, coarse_words)\n    coarse_words_set = coarse_words.to_set\n    sentence.gsub(/\\p{L}+/) { |word|\n      coarse_words_set.include?(word.downcase) ? word.gsub(/[aeiou]/i, '*') : word }\nend\n</code></pre>\n\n<p>If, in addition, the list of coarse words were static, one might make the set of coarse words a constant:</p>\n\n<pre><code>require 'set'\nCOARSE_WORDS = [\"gosh\", \"darn\", \"shoot\"].to_set\n\ndef censor(sentence)\n    sentence.gsub(/\\p{L}+/) { |word|\n      COARSE_WORDS.include?(word.downcase) ? word.gsub(/[aeiou]/i, '*') : word }\nend\n</code></pre>\n"}], "owner": {"reputation": 39, "user_id": 11570390, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-YCpYNjpVkYU/AAAAAAAAAAI/AAAAAAAAAGU/IGapoP6neDM/photo.jpg?sz=128", "display_name": "Joe Horn", "link": "https://stackoverflow.com/users/11570390/joe-horn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 65, "favorite_count": 0, "answer_count": 4, "score": 1, "last_activity_date": 1559567820, "creation_date": 1559510628, "last_edit_date": 1559529117, "question_id": 56419043, "link": "https://stackoverflow.com/questions/56419043/parsing-an-array-to-find-individual-word-capitalization-is-relevant", "title": "Parsing an array to find individual word, capitalization is relevant", "body": "<p>Below is the exercise I\u2019m working on.</p>\n\n<p>Should return the sentence where every curse word has it's vowels replaced with '*'\" do</p>\n\n<p>Example #1 censor(\"Gosh darn it\", [\"gosh\", \"darn\", \"shoot\"]) =>(\"G*sh d*rn it\")</p>\n\n<p>Example #2 censor(\"SHUT THE FRONT DOOR\", [\"door\"]) =>(\"SHUT THE FRONT D**R\")</p>\n\n<p>Where I\u2019m stumped is how to account for the caps. I originally started to loop through each word, but can\u2019t figure out the best way to use something like .include to check if that word was in the array.</p>\n\n<p>I started with the below</p>\n\n<pre><code> def censor(sentence, curse)\n    vowels = \"aeiouAEIOU\"\n    result = \"\"\n    words = sentence.split(' ')\n\n    new_curse = curse.join(\",\")\n    p new_curse.downcase\n    p words\n\n    words.each.with_index do ???\n            if word.casecmp?()\n                word.each_char do |char|\n                    if vowels.include?(char)\n                        result &lt;&lt; \"*\"\n                    else\n                        result &lt;&lt; char\n                    end\n                end\n            else \n                 result &lt;&lt; word \n            end\n\n     end\n    return result\nend\n</code></pre>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 13359, "user_id": 1779477, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/f62e1d28063f41fd9728d811fea3a84c?s=128&d=identicon&r=PG&f=1", "display_name": "idmean", "link": "https://stackoverflow.com/users/1779477/idmean"}, "edited": false, "score": 0, "creation_date": 1559509052, "post_id": 56418809, "comment_id": 99433419, "body": "<code>file.each do |line|</code> gives you each line as a string. <code>line.gsub</code> returns a new string."}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 1, "creation_date": 1559517261, "post_id": 56418809, "comment_id": 99434755, "body": "Your code above is trying to delete <b>every</b> line in the file. If that&#39;s really the aim, then why not just... delete the file?"}, {"owner": {"reputation": 1, "user_id": 11588171, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000909118756/picture?type=large", "display_name": "Paulo Ferraz", "link": "https://stackoverflow.com/users/11588171/paulo-ferraz"}, "reply_to_user": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1559597764, "post_id": 56418809, "comment_id": 99463910, "body": "@TomLord I don&#39;t want to delete the entire file because i need processone line at a time."}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1559638988, "post_id": 56418809, "comment_id": 99474634, "body": "Is there a reason you cannot just process one line at a time <i>and then</i> delete the file? Unless you need the ability to &quot;pause, and pick up where you left off&quot; (but not have the ability to rerun the whole process), this could be a simpler implementation."}, {"owner": {"reputation": 1, "user_id": 11588171, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000909118756/picture?type=large", "display_name": "Paulo Ferraz", "link": "https://stackoverflow.com/users/11588171/paulo-ferraz"}, "edited": false, "score": 0, "creation_date": 1559657806, "post_id": 56418809, "comment_id": 99485001, "body": "It&#39;s one huge IPs list. I get the next IP and perform a security scanning on it. At end i need remove this IP from list because if script crashes, i can restart it from the next IP and don&#39;t repeat the previous."}, {"owner": {"reputation": 1, "user_id": 11588171, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000909118756/picture?type=large", "display_name": "Paulo Ferraz", "link": "https://stackoverflow.com/users/11588171/paulo-ferraz"}, "reply_to_user": {"reputation": 13359, "user_id": 1779477, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/f62e1d28063f41fd9728d811fea3a84c?s=128&d=identicon&r=PG&f=1", "display_name": "idmean", "link": "https://stackoverflow.com/users/1779477/idmean"}, "edited": false, "score": 0, "creation_date": 1559658300, "post_id": 56418809, "comment_id": 99485254, "body": "@idmean i understanded that this only get the next line from file and format it, without change this file. That&#39;s it? In this case i would need open a file stream and operate on his file descriptor directly. How can this be done in ruby?"}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 11588171, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000909118756/picture?type=large", "display_name": "Paulo Ferraz", "link": "https://stackoverflow.com/users/11588171/paulo-ferraz"}, "is_accepted": true, "score": 0, "last_activity_date": 1560030650, "creation_date": 1560030650, "answer_id": 56510362, "question_id": 56418809, "link": "https://stackoverflow.com/questions/56418809/how-to-delete-lines-from-file-without-create-a-temporary-file-in-ruby/56510362#56510362", "title": "How to delete lines from file without create a temporary file in ruby?", "body": "<p>i found the solution on another forum. \n[<a href=\"https://www.ruby-forum.com/t/delete-first-line-of-a-text-file/134316/4]\" rel=\"nofollow noreferrer\">https://www.ruby-forum.com/t/delete-first-line-of-a-text-file/134316/4]</a>\nIt only needed to change the focus: </p>\n\n<pre><code>[ paulosgf /home/paulosgf/hack/metasploit ] $ cat teste.txt \njohn\ndoe\nfoo\nbar\n[ paulosgf /home/paulosgf/hack/metasploit ] $ cat delFirst.rb \n#!/usr/bin/ruby\n\npath = '/home/paulosgf/hack/metasploit/teste.txt'\nremains=''\nline=''\neach=''\n\nFile.foreach(path) { |each|\nFile.open(path, 'r') {|file| line=file.gets; remains=file.read}\nputs(\"#{line}\")\nFile.open(path, 'w+') {|file| file.write(remains)}\n}\n[ paulosgf /home/paulosgf/hack/metasploit ] $ ./delFirst.rb \njohn\ndoe\nfoo\nbar\n[ paulosgf /home/paulosgf/hack/metasploit ] $ cat teste.txt \n[ paulosgf /home/paulosgf/hack/metasploit ] $ \n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 11588171, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000909118756/picture?type=large", "display_name": "Paulo Ferraz", "link": "https://stackoverflow.com/users/11588171/paulo-ferraz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 51, "favorite_count": 0, "accepted_answer_id": 56510362, "answer_count": 1, "score": -3, "last_activity_date": 1560030650, "creation_date": 1559508096, "question_id": 56418809, "link": "https://stackoverflow.com/questions/56418809/how-to-delete-lines-from-file-without-create-a-temporary-file-in-ruby", "title": "How to delete lines from file without create a temporary file in ruby?", "body": "<p>I need delete line of a file sequentially with ruby, but without success. </p>\n\n<p>If i open the file with w+ flag, it gets completely empty, and if i open with r+ flag, nothing happens.\nI even tried do it with by sed's system command, without results too.\nWhat's wrong?</p>\n\n<pre><code>$ cat teste.txt \nfoo\nbar\n\n- This is by ruby way:\n$ cat ruby.rb \n#!/usr/bin/ruby\n\npath = '/home/paulosgf/hack/metasploit/teste.txt'\nFile.open(path, 'r+') do |file|\n    file.each do |line|\n        puts(line)\n        line.gsub(/^.$\\n/, '')\n    end\nfile.close()\nend\n\n$ ./ruby.rb \nfoo\nbar\n\n$ cat teste.txt (nothing happens)\nfoo\nbar\n\n- This is by sed way:\n$ cat sed.rb \n#!/usr/bin/ruby\n\npath = '/home/paulosgf/hack/metasploit/teste.txt'\nFile.open(path, 'r+') do |file|\n    file.each do |line|\n        puts(line)\n        system(\"sed -i\", \"/#{line}/d #{path}\")\n    end\nfile.close()\nend\n\n$ ./sed.rb \nfoo\nbar\n\n$ cat teste.txt \nfoo\nbar\n</code></pre>\n\n<p>I need get the next line, run some processing and delete these line at end, but all lines remains on file yet.</p>\n"}, {"tags": ["ruby", "class", "oop", "object"], "answers": [{"tags": [], "owner": {"reputation": 126343, "user_id": 14660, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/e55e0ec3c00f834d78fbdddeaa36e308?s=128&d=identicon&r=PG", "display_name": "Schwern", "link": "https://stackoverflow.com/users/14660/schwern"}, "is_accepted": true, "score": 0, "last_activity_date": 1559505350, "creation_date": 1559505350, "answer_id": 56418505, "question_id": 56418363, "link": "https://stackoverflow.com/questions/56418363/why-will-this-not-iterate-through-the-file-like-i-want-it-to/56418505#56418505", "title": "Why will this not iterate through the file like I want it to?", "body": "<p><code>input = gets.chomp</code> removes the newline off the input, but <code>f.each_line</code> does not. So <code>input == \"#{line}\"</code> is comparing, for example, <code>\"1234\"</code> with <code>\"1234\\n\"</code>.</p>\n\n<p>Chomp the line as well.</p>\n\n<pre><code>    input = gets.chomp\n    File.open(\"Cards.RBC\", \"r\") do |f|\n        f.each_line do |line|\n            line.chomp!\n            if input == line\n                @card_id = line\n                @found == true\n            elsif @found == true\n                @balance = line.to_i\n            end\n        end\n    end\n</code></pre>\n\n<p>You can debug this sort of thing by printing the values with <code>p</code>. This will show them as quoted strings and show any special characters including newlines.</p>\n\n<pre><code>p line\np input\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 10469674, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b5c05d38b35b3e42193808100515d1f1?s=128&d=identicon&r=PG&f=1", "display_name": "Thechemistcoder", "link": "https://stackoverflow.com/users/10469674/thechemistcoder"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 35, "favorite_count": 0, "accepted_answer_id": 56418505, "answer_count": 1, "score": 0, "last_activity_date": 1559688693, "creation_date": 1559504280, "last_edit_date": 1559688693, "question_id": 56418363, "link": "https://stackoverflow.com/questions/56418363/why-will-this-not-iterate-through-the-file-like-i-want-it-to", "title": "Why will this not iterate through the file like I want it to?", "body": "<p>It will just output two blank lines to the screen when it should be printing the card id and the balance</p>\n\n<p>I have completely re-written the code.\nI have fiddled with that code for an hour</p>\n\n<pre><code>class RBC\n\n    def initialize\n\n        @args = [\"Create a new card\"]\n        @functions = [\"create_rbc\"]\n\n        puts \"Do you have an RBC ID yet? Yes(0) No(1)\"\n\n        hasrbc = gets.chomp.to_i\n\n        if hasrbc == 1 \n\n            @balance = 5\n            create_rbc\n\n        else\n\n            login\n\n        end\n\n    end\n\n    def create_rbc\n\n    puts \"\\nGenerating your rbc\\n\\n\"\n        puts \"\\nWelcome to your Ruby Binary Card(RBC)!\\n\\n\"\n        puts \"Your RBC will keep track of your RubyCredits(RC).\\n\"\n        puts \"You will get paid RC for work apps, and pay for game apps.\\n\"\n        puts \"If you lose track of your RBC ID, you can get a new one.\\n\"\n        puts \"Doing this, however, will reset your balance to the default of $5\\n\\n\"\n        puts \"What is your name? Do first last\\n\"\n\n        @fullname = gets.chomp\n        @card_name = get_name_codec(@fullname)\n        @card_cipher = \"#{rand(1..9)}#{rand(1..9)}#{rand(1..9)}#{rand(1..9)}#{rand(1..9)}#{rand(1..9)}#{rand(1..9)}#{rand(1..9)}#{rand(1..9)}#{rand(1..9)}\"\n\n        @card_id = \"#{@card_name} - #{@card_cipher}\"\n        instance_variable_set(\"@Id#{@card_cipher}\", @balance)\n\n        puts \"Write down your RBC ID: #{@card_id}\"\n        file = File.open(\"Cards.rbc\", \"w\")\n            file.puts @card_id\n            file.puts @balance\n        end\n\n    end\n\n    def get_name_codec(name)\n\n        names = name.split(\" \")\n\n        fname = names[0]\n        lname = names[1]\n\n        fchar = fname.split(//)\n        fcodec = \"#{fchar[0]}#{fchar[1]}\"\n\n        name_codec = \"#{fcodec}#{lname}\"\n\n        return name_codec\n\n    end\n\n    def login\n        @found = false\n        puts \"What is your RBC Id\"\n        input = gets.chomp\n        File.open(\"Cards.RBC\", \"r\") do |f|\n            f.each_line do |line|\n\n                if input == \"#{line}\"\n                    @card_id = line.to_s\n                    @found == true\n                elsif @found == true\n                    @balance = line.to_i\n                end\n\n\n            end\n\n        end\n\n        puts \"#{@card_id}#{@balance}\"\nend\n\nRBC.new\n\n</code></pre>\n\n<p>Then the Cards.RBC</p>\n\n<pre><code>\nTiLan - 1122632527\n5\n\n</code></pre>\n\n<p>I want it to print the balance and card Id.\nIt should give me my card id and then the balance like this:\n0000...etc\n5</p>\n"}, {"tags": ["ruby-on-rails", "json", "ruby", "haml"], "comments": [{"owner": {"reputation": 3995, "user_id": 2037537, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/f13d953be3af2552aaa1ddfa0a05fa46?s=128&d=identicon&r=PG", "display_name": "Roland Studer", "link": "https://stackoverflow.com/users/2037537/roland-studer"}, "edited": false, "score": 1, "creation_date": 1559515443, "post_id": 56417639, "comment_id": 99434503, "body": "If possible you should use another route like <code>posts_as_json</code>, but if you really have no way around the requirement, you can do it with the anser below."}], "answers": [{"comments": [{"owner": {"reputation": 174, "user_id": 2009496, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a16d2b3c03f572a407cb34bf0c419a83?s=128&d=identicon&r=PG", "display_name": "Eric Newman", "link": "https://stackoverflow.com/users/2009496/eric-newman"}, "edited": false, "score": 0, "creation_date": 1559519771, "post_id": 56419417, "comment_id": 99435080, "body": "Thanks, I&#39;ll look into this. For the time being I&#39;m just going to pass a query param for filtering since that feels much more natural. If there are complaints I&#39;ll reiterate with this and see what happens."}], "tags": [], "owner": {"reputation": 3995, "user_id": 2037537, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/f13d953be3af2552aaa1ddfa0a05fa46?s=128&d=identicon&r=PG", "display_name": "Roland Studer", "link": "https://stackoverflow.com/users/2037537/roland-studer"}, "is_accepted": true, "score": 3, "last_activity_date": 1559515328, "last_edit_date": 1559515328, "creation_date": 1559514785, "answer_id": 56419417, "question_id": 56417639, "link": "https://stackoverflow.com/questions/56417639/rails-haml-view-rendering-raw-html/56419417#56419417", "title": "Rails HAML View Rendering Raw HTML", "body": "<p>The problem is that if you request a <code>.json</code> format, rails will automatically try to send it as a response with the corresponding MIME type <code>application/json</code>.</p>\n\n<p>Now the browser gets a response that he thinks should be a JSON so it renders it as text.</p>\n\n<p>You can override the MIME type for your render method:</p>\n\n<pre><code>render content_type: content_type: \"text/html\"\n</code></pre>\n\n<p>Or if you want to serve both request from the same controller action, you can do it with the <code>respond_to</code>-method:</p>\n\n<pre><code>def index\n  @posts = Post.all\n  respond_to do |format|\n    format.html { render }\n    format.json { render 'index_as_json.html', content_type: \"text/html\" }\n  end\nend\n</code></pre>\n"}], "owner": {"reputation": 174, "user_id": 2009496, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a16d2b3c03f572a407cb34bf0c419a83?s=128&d=identicon&r=PG", "display_name": "Eric Newman", "link": "https://stackoverflow.com/users/2009496/eric-newman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 205, "favorite_count": 0, "accepted_answer_id": 56419417, "answer_count": 1, "score": 0, "last_activity_date": 1581308617, "creation_date": 1559498666, "last_edit_date": 1581308617, "question_id": 56417639, "link": "https://stackoverflow.com/questions/56417639/rails-haml-view-rendering-raw-html", "title": "Rails HAML View Rendering Raw HTML", "body": "<p>I'm trying to render a simple view using HAML that shows a collection of JSON objects with a header above. The route I'm using is <code>get 'posts.json', to: 'posts#posts_as_json'</code>. This renders the below view.</p>\n\n<h3>posts_as_json.haml</h3>\n\n<pre><code>%h1 Posts As JSON\n%div.gutter-spacing\n  =raw(@posts)\n</code></pre>\n\n<p>The problem I'm running into is that the page will render raw HTML tags as well as the JSON itself. I've been trying to figure out what the issue is and based on some experimentation I think it's directly tied to using <code>.json</code> in my routing. If I remove that it seems to render the HTML as expected. Update: This is definitely the root of the <a href=\"https://stackoverflow.com/questions/35194434/is-adding-json-to-the-end-of-a-url-required-for-a-default-rails-resource-to-res\">issue</a></p>\n\n<p>Using the route <code>'posts.json'</code> is a requirement of my project, but I need to be able to search the parsed JSON as well which I have previously solved with a simple HTML text input tied to a javascript function. How can I use this endpoint while still rendering HTML alongside the JSON data?</p>\n"}]