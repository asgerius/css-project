[{"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 18856, "user_id": 1359650, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/dffc4318ac93e728a26c8e8b51b4eb37?s=128&d=identicon&r=PG", "display_name": "jvillian", "link": "https://stackoverflow.com/users/1359650/jvillian"}, "edited": false, "score": 0, "creation_date": 1473293037, "post_id": 39380422, "comment_id": 66089169, "body": "Will <code>User</code> always have <i>exactly</i> the same data elements in <i>every</i> application, or will <code>User</code> sometimes need to have additional data elements in a host application?"}, {"owner": {"reputation": 2138, "user_id": 907299, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/u4p0j.jpg?s=128&g=1", "display_name": "Theo Scholiadis", "link": "https://stackoverflow.com/users/907299/theo-scholiadis"}, "reply_to_user": {"reputation": 18856, "user_id": 1359650, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/dffc4318ac93e728a26c8e8b51b4eb37?s=128&d=identicon&r=PG", "display_name": "jvillian", "link": "https://stackoverflow.com/users/1359650/jvillian"}, "edited": false, "score": 0, "creation_date": 1473348951, "post_id": 39380422, "comment_id": 66116169, "body": "The core <code>User</code> will not change (i.e. it will always have user rights, username, etc.) but relationships might change. Also, each user will have customisable fields for each module (e.g. enable help, how many minutes to refresh, etc.)"}], "answers": [{"comments": [{"owner": {"reputation": 2138, "user_id": 907299, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/u4p0j.jpg?s=128&g=1", "display_name": "Theo Scholiadis", "link": "https://stackoverflow.com/users/907299/theo-scholiadis"}, "edited": false, "score": 0, "creation_date": 1473349055, "post_id": 39380699, "comment_id": 66116251, "body": "This makes sense. Are <code>embiggen</code> and <code>self.bigness</code> the names I should use, or are is this an example? Also, in your example, is User in the Main App or in a gem of its own (which is what I want)?"}, {"owner": {"reputation": 25150, "user_id": 383888, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Kd57u.jpg?s=128&g=1", "display_name": "Mori", "link": "https://stackoverflow.com/users/383888/mori"}, "reply_to_user": {"reputation": 2138, "user_id": 907299, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/u4p0j.jpg?s=128&g=1", "display_name": "Theo Scholiadis", "link": "https://stackoverflow.com/users/907299/theo-scholiadis"}, "edited": false, "score": 1, "creation_date": 1473351451, "post_id": 39380699, "comment_id": 66117694, "body": "@TheoScholiadis, they&#39;re purely examples. You can initially define User in the main app or in a gem, your choice."}, {"owner": {"reputation": 2138, "user_id": 907299, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/u4p0j.jpg?s=128&g=1", "display_name": "Theo Scholiadis", "link": "https://stackoverflow.com/users/907299/theo-scholiadis"}, "edited": false, "score": 0, "creation_date": 1473411014, "post_id": 39380699, "comment_id": 66139840, "body": "Oh ok. I just understood what you meant. I have always been including my extensions in the Engine Module by doing something like <code>class Engine::User</code> or <code>module Engine class User end end</code>. Thank you. This clarifies matters. Simpler than I thought."}], "tags": [], "owner": {"reputation": 25150, "user_id": 383888, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Kd57u.jpg?s=128&g=1", "display_name": "Mori", "link": "https://stackoverflow.com/users/383888/mori"}, "is_accepted": true, "score": 2, "last_activity_date": 1473293194, "creation_date": 1473293194, "answer_id": 39380699, "question_id": 39380422, "link": "https://stackoverflow.com/questions/39380422/advice-on-modular-design-in-rails-app/39380699#39380699", "title": "Advice on Modular Design in Rails App", "body": "<p>Rails engines have the option of an isolated namespace, which works as you describe with <code>AddressBook:User.contacts</code>, but it isn't always best to use it. Without it you can define a User model in the app and in each engine, extend that model as needed. E.g. in the app:</p>\n\n<pre><code>class User &lt; ActiveRecord::Base\n  def embiggen\n    self.bigness *= 2\n  end\nend\n</code></pre>\n\n<p>... and in the engine:</p>\n\n<pre><code>class User\n  has_many :contacts\nend\n</code></pre>\n\n<p>Then you always call <code>User</code> and don't have to add an <code>Engine::User</code> prefix. </p>\n"}], "owner": {"reputation": 2138, "user_id": 907299, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/u4p0j.jpg?s=128&g=1", "display_name": "Theo Scholiadis", "link": "https://stackoverflow.com/users/907299/theo-scholiadis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 251, "favorite_count": 1, "accepted_answer_id": 39380699, "answer_count": 1, "score": 0, "last_activity_date": 1473293194, "creation_date": 1473290784, "question_id": 39380422, "link": "https://stackoverflow.com/questions/39380422/advice-on-modular-design-in-rails-app", "title": "Advice on Modular Design in Rails App", "body": "<p>I have an app that will have 3 modules, each created in its own Engine, namely:</p>\n\n<ol>\n<li>Administration</li>\n<li>Address Book</li>\n<li>Calendar</li>\n</ol>\n\n<p>In the Administration module, an admin user will be able to add, edit and delete other users. Each of these users will also have some generic functionality, like a log of all their actions on the app, and user rights per module.</p>\n\n<p>In the Address Book module a user will have many Contacts. In the Calendar module a user will have many Events.</p>\n\n<p>I would like to create the a separate User gem/module that is shared across all Engines, but I'm not sure how to deal with the relationships/models that are specific to each Engine. I have thought of extending the User module in each Engine, to include the specific relationships, but then I need to call its method using the Engine's User model instead of the Main App's User model (e.g. I have to do <code>AddressBook::User.contacts</code> instead of just <code>User.contacts</code>).</p>\n\n<p>Is this my only option or am I missing something fundamental?</p>\n\n<p>Any advice around this would be appreciated.</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 9030, "user_id": 5101476, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JCQrl.jpg?s=128&g=1", "display_name": "ice\u30c4", "link": "https://stackoverflow.com/users/5101476/ice%e3%83%84"}, "edited": false, "score": 1, "creation_date": 1473289405, "post_id": 39380215, "comment_id": 66088328, "body": "Both these snippets give an error. What is your desired output for each snippet?"}, {"owner": {"reputation": 6687, "user_id": 6496010, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/4d564ef7fd53e4e76e5e520945dcc4c1?s=128&d=identicon&r=PG", "display_name": "davidhu", "link": "https://stackoverflow.com/users/6496010/davidhu"}, "edited": false, "score": 1, "creation_date": 1473289549, "post_id": 39380215, "comment_id": 66088360, "body": "you need to use <code>()</code> instead of <code>[]</code> for the <code>slice</code> method. If you change that, both snippets return <code>H</code> as the result."}, {"owner": {"reputation": 148, "user_id": 6027690, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1b5d496f11c23fba9753b1de5692276e?s=128&d=identicon&r=PG&f=1", "display_name": "Striker", "link": "https://stackoverflow.com/users/6027690/striker"}, "reply_to_user": {"reputation": 9030, "user_id": 5101476, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JCQrl.jpg?s=128&g=1", "display_name": "ice\u30c4", "link": "https://stackoverflow.com/users/5101476/ice%e3%83%84"}, "edited": false, "score": 0, "creation_date": 1473289705, "post_id": 39380215, "comment_id": 66088407, "body": "@sagarpandya82 Sorry, the first snippet is supposed to give an error - it&#39;s just wrong. The second is supposed to save the eighth letter of the alphabet to letter_7, so letter_7 = &quot;H&quot;."}, {"owner": {"reputation": 148, "user_id": 6027690, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1b5d496f11c23fba9753b1de5692276e?s=128&d=identicon&r=PG&f=1", "display_name": "Striker", "link": "https://stackoverflow.com/users/6027690/striker"}, "reply_to_user": {"reputation": 6687, "user_id": 6496010, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/4d564ef7fd53e4e76e5e520945dcc4c1?s=128&d=identicon&r=PG", "display_name": "davidhu", "link": "https://stackoverflow.com/users/6496010/davidhu"}, "edited": false, "score": 0, "creation_date": 1473289877, "post_id": 39380215, "comment_id": 66088454, "body": "@davidhu2000 Thank you!"}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 1, "creation_date": 1473290489, "post_id": 39380215, "comment_id": 66088614, "body": "Your tag &quot;rubygems&quot; is not relevant to your question (even if someone suggests you use a particular gem, which I think is doubtful), so you should remove it. Many members use tags to filter questions that they want to see (or don&#39;t want to see), so it&#39;s important that they be appropriate. Just &quot;ruby&quot; is fine."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 4, "creation_date": 1473290734, "post_id": 39380215, "comment_id": 66088667, "body": "In future I suggest you hold off choosing an answer so quickly. A quick selection may discourage other answers and may short-circuit others who are still preparing answers. The point is that there&#39;s no rush, just don&#39;t forget. I suggest waiting at least a couple of hours. Many here wait much longer. When you have time read over the <a href=\"http://stackoverflow.com/help\">SO faq</a>."}, {"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "reply_to_user": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 1, "creation_date": 1473291235, "post_id": 39380215, "comment_id": 66088751, "body": "I recommend waiting 24 hours, which gives the user&#39;s around the world a chance to chime in. Also, there are a number of excellent users who only get on every couple days. As @CarySwoveland says, picking quickly doesn&#39;t help you and it discourages better answers that might take a while. I&#39;d also recommend reading &quot;<a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a>&quot; and the linked pages, especially <a href=\"http://catb.org/esr/faqs/smart-questions.html\" rel=\"nofollow noreferrer\">catb.org/esr/faqs/smart-questions.html</a>"}, {"owner": {"reputation": 148, "user_id": 6027690, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1b5d496f11c23fba9753b1de5692276e?s=128&d=identicon&r=PG&f=1", "display_name": "Striker", "link": "https://stackoverflow.com/users/6027690/striker"}, "edited": false, "score": 0, "creation_date": 1473292164, "post_id": 39380215, "comment_id": 66088991, "body": "Fair enough. Apologies, I&#39;ll be sure to hold off on my next post."}], "answers": [{"tags": [], "owner": {"reputation": 6687, "user_id": 6496010, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/4d564ef7fd53e4e76e5e520945dcc4c1?s=128&d=identicon&r=PG", "display_name": "davidhu", "link": "https://stackoverflow.com/users/6496010/davidhu"}, "is_accepted": true, "score": 2, "last_activity_date": 1473289912, "creation_date": 1473289912, "answer_id": 39380313, "question_id": 39380215, "link": "https://stackoverflow.com/questions/39380215/how-to-make-a-number-argument-a-variable/39380313#39380313", "title": "How to make a number argument a variable?", "body": "<p>So your issue come from the fact that you are using the <code>slice</code> method without any arguments. You can not use <code>[]</code> with the <code>slice</code> method. To make this work, you need to change <code>[]</code> to <code>()</code></p>\n\n<pre><code>letter_7 = alphabet.slice(7..7)\n</code></pre>\n\n<p>This will actually return <code>H</code> as the result, because arrays index start at 0, so to get the 7th letter, you will need to slice at index 6. </p>\n\n<pre><code>letter_7 = alphabet.slice(6..6) #=&gt; 'G'\n</code></pre>\n\n<p>Or, you can just use the <code>[]</code> method on the string itself.</p>\n\n<pre><code>letter_7 = alphabet[6] #=&gt; 'G'\n</code></pre>\n\n<p>Of course, you can replace the index values with variables, as long as the variables are set to integers. </p>\n\n<pre><code>a = 6\n\nletter_7 = alphabet[a] #=&gt; 'G'\n</code></pre>\n"}], "owner": {"reputation": 148, "user_id": 6027690, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1b5d496f11c23fba9753b1de5692276e?s=128&d=identicon&r=PG&f=1", "display_name": "Striker", "link": "https://stackoverflow.com/users/6027690/striker"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 38, "favorite_count": 0, "accepted_answer_id": 39380313, "answer_count": 1, "score": -1, "last_activity_date": 1473291182, "creation_date": 1473289177, "last_edit_date": 1473291182, "question_id": 39380215, "link": "https://stackoverflow.com/questions/39380215/how-to-make-a-number-argument-a-variable", "title": "How to make a number argument a variable?", "body": "<p>How do I make a number argument a variable?</p>\n\n<p>For example:</p>\n\n<p>Snippet 1:</p>\n\n<pre><code>a=1\na_7 = a+6\nalphabet = \"ABCDEFGHIJKLMNOPQRSTUVQXYZ\"\nletter_7 = alphabet.slice[a_7..a_7]\n</code></pre>\n\n<p>Snippet 2:</p>\n\n<pre><code>alphabet = \"ABCDEFGHIJKLMNOPQRSTUVQXYZ\"\nletter_7 = alphabet.slice[7..7]\n</code></pre>\n\n<p>I would like to make snippet 1 have the same outcome as snippet 2, with a variable as the arguments within <code>slice</code> action. Is there a way to do this?</p>\n"}, {"tags": ["ruby", "haml", "erb", "syntactic-sugar"], "answers": [{"tags": [], "owner": {"reputation": 1513, "user_id": 1334750, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/0vTHg.png?s=128&g=1", "display_name": "Pawe\u0142 Duda", "link": "https://stackoverflow.com/users/1334750/pawe%c5%82-duda"}, "is_accepted": false, "score": 3, "last_activity_date": 1473290658, "creation_date": 1473290658, "answer_id": 39380401, "question_id": 39380147, "link": "https://stackoverflow.com/questions/39380147/ruby-evaluate-one-ruby-function-or-another-using-the-same-do-block/39380401#39380401", "title": "Ruby, evaluate one ruby function or another using the same DO block", "body": "<p>You seem to be looking for #send</p>\n\n<pre><code>- is_a = @thing.is_a?\n= f.send(is_a ? :method_a : :method_b, arg_1) do |block_arg|\n  (...) \n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 6802567, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e6ee3f95d832552d8b27ec8bb6eea366?s=128&d=identicon&r=PG&f=1", "display_name": "Jay&#39;z coding habit", "link": "https://stackoverflow.com/users/6802567/jayz-coding-habit"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 46, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1473290658, "creation_date": 1473288696, "question_id": 39380147, "link": "https://stackoverflow.com/questions/39380147/ruby-evaluate-one-ruby-function-or-another-using-the-same-do-block", "title": "Ruby, evaluate one ruby function or another using the same DO block", "body": "<p>In ERB or HAML, I need to be able to evaluate one function, or a different one, based on the output of a conditional, while using the same HTML block for either one.</p>\n\n<p>In HAML, it would like something like this:</p>\n\n<pre><code>- is_a = @thing.is_a?\n= (is_a ? f.method_a : f.method_b) arg_1, |block_arg1| do\n  #thing\n    .blah\n    .inner-thing\n      = block_arg1.some_method\n</code></pre>\n\n<p>Notice how, on line 2 of my pseudocode, I am trying to evaluate either one function, or the other, based upon a conditional.  But I need pass the same arguments to either, especially since I don't want to have to re-type the DO block.</p>\n\n<p>Maybe I could avoid that problem (\"I don't want to re-type...\") by making that DO block a named function?  How does one turn a HAML or ERB block into a named Ruby function?</p>\n\n<p>I'm using Ruby-on-Rails 4.  Not that it matters; this looks like more of a ruby syntax question than a framework question.</p>\n"}, {"tags": ["ruby", "jekyll", "windows-7-x64", "github-pages"], "comments": [{"owner": {"reputation": 7055, "user_id": 2350083, "user_type": "registered", "accept_rate": 37, "profile_image": "https://i.stack.imgur.com/ekgg9.png?s=128&g=1", "display_name": "Jon", "link": "https://stackoverflow.com/users/2350083/jon"}, "edited": false, "score": 0, "creation_date": 1473286578, "post_id": 39379673, "comment_id": 66087486, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/17936340/unresolved-specs-during-gemspecification-reset\">Unresolved specs during Gem::Specification.reset:</a>"}], "answers": [{"tags": [], "owner": {"reputation": 1895, "user_id": 5477561, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a8da372e79dbb466c65a7f8a9b934b7?s=128&d=identicon&r=PG", "display_name": "Ross", "link": "https://stackoverflow.com/users/5477561/ross"}, "is_accepted": false, "score": 0, "last_activity_date": 1473292914, "creation_date": 1473292914, "answer_id": 39380673, "question_id": 39379673, "link": "https://stackoverflow.com/questions/39379673/trouble-installing-jekyll-on-windows-7/39380673#39380673", "title": "Trouble Installing Jekyll on Windows 7", "body": "<p>From Jekyll 3, the suggested way to run Jekyll is through the Bundler (<a href=\"http://bundler.io/\" rel=\"nofollow\">http://bundler.io/</a>). This solves a lot of Gem-related headaches and versioning issues. Rather than running with <code>jekyll build</code>, try the following commands from <a href=\"http://jekyllrb.com/\" rel=\"nofollow\">http://jekyllrb.com/</a>:</p>\n\n<p>Install your dependencies (only necessary initially or after you add a plugin):</p>\n\n<pre><code>bundle install\n</code></pre>\n\n<p>Run jekyll with those dependencies:</p>\n\n<pre><code>bundle exec jekyll serve\n</code></pre>\n\n<p>I'm not sure if this will solve your problem, but it'd be a good start.</p>\n"}], "owner": {"reputation": 1, "user_id": 6806609, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-3KwcxgQ9ovs/AAAAAAAAAAI/AAAAAAAAElg/qS3f1AwFpqc/photo.jpg?sz=128", "display_name": "Mac Kiser", "link": "https://stackoverflow.com/users/6806609/mac-kiser"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 68, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1473292914, "creation_date": 1473285703, "question_id": 39379673, "link": "https://stackoverflow.com/questions/39379673/trouble-installing-jekyll-on-windows-7", "title": "Trouble Installing Jekyll on Windows 7", "body": "<p>I am trying to install Jekyll on my windows 7 desktop and I keep getting this error in cmd. Anyone know what could be causing this?</p>\n\n<p>Thanks!</p>\n\n<pre><code>C:\\Users\\Mac\\Documents\\Github\\mackiser.github.io&gt;jekyll build\nWARN: Unresolved specs during Gem::Specification.reset:\n  rouge (~&gt; 1.7)\n  ffi (&gt;= 0.5.0)\nWARN: Clearing out unresolved specs.\nPlease report a bug if this causes problems.\nC:/tools/ruby23/lib/ruby/gems/2.3.0/gems/bundler-         1.12.5/lib/bundler/spec_set.rb:\n95:in `block in materialize': Could not find listen-3.0.6 in any of the sources\n(Bundler::GemNotFound)\n    from C:/tools/ruby23/lib/ruby/gems/2.3.0/gems/bundler-1.12.5/lib/bundler\n/spec_set.rb:88:in `map!'\n    from C:/tools/ruby23/lib/ruby/gems/2.3.0/gems/bundler-1.12.5/lib/bundler\n/spec_set.rb:88:in `materialize'\n    from C:/tools/ruby23/lib/ruby/gems/2.3.0/gems/bundler-1.12.5/lib/bundler\n/definition.rb:140:in `specs'\n    from C:/tools/ruby23/lib/ruby/gems/2.3.0/gems/bundler-1.12.5/lib/bundler\n/definition.rb:185:in `specs_for'\n    from C:/tools/ruby23/lib/ruby/gems/2.3.0/gems/bundler-1.12.5/lib/bundler\n/definition.rb:174:in `requested_specs'\n    from C:/tools/ruby23/lib/ruby/gems/2.3.0/gems/bundler-1.12.5/lib/bundler\n/environment.rb:19:in `requested_specs'\n    from C:/tools/ruby23/lib/ruby/gems/2.3.0/gems/bundler-1.12.5/lib/bundler\n/runtime.rb:14:in `setup'\n    from C:/tools/ruby23/lib/ruby/gems/2.3.0/gems/bundler-1.12.5/lib/bundler\n.rb:95:in `setup'\n    from C:/tools/ruby23/lib/ruby/gems/2.3.0/gems/jekyll-3.2.1/lib/jekyll/pl\nugin_manager.rb:36:in `require_from_bundler'\n    from C:/tools/ruby23/lib/ruby/gems/2.3.0/gems/jekyll-3.2.1/exe/jekyll:9:\nin `&lt;top (required)&gt;'\n    from C:/tools/ruby23/bin/jekyll:23:in `load'\n    from C:/tools/ruby23/bin/jekyll:23:in `&lt;main&gt;'\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "postgresql"], "comments": [{"owner": {"reputation": 9572, "user_id": 2305826, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/xRwWw.png?s=128&g=1", "display_name": "MarsAtomic", "link": "https://stackoverflow.com/users/2305826/marsatomic"}, "edited": false, "score": 2, "creation_date": 1473286023, "post_id": 39379639, "comment_id": 66087311, "body": "Start a psql session and check pg_users table to see what users you have. If I recall, installing PG the way you did doesn&#39;t create the default postgres user that your app is expecting."}, {"owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 0, "creation_date": 1473287369, "post_id": 39379639, "comment_id": 66087729, "body": "i always look at <a href=\"https://www.digitalocean.com/community/tutorials/how-to-install-and-use-postgresql-on-ubuntu-14-04\" rel=\"nofollow noreferrer\">this tutorial</a> when installing postgres"}, {"owner": {"reputation": 19261, "user_id": 4758119, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/F4dJY.jpg?s=128&g=1", "display_name": "Deepak Mahakale", "link": "https://stackoverflow.com/users/4758119/deepak-mahakale"}, "edited": false, "score": 0, "creation_date": 1473304052, "post_id": 39379639, "comment_id": 66091515, "body": "Add password in database yml"}], "answers": [{"tags": [], "owner": {"reputation": 496, "user_id": 5537203, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/88445e66d439bb5df0fdf9876049cbdc?s=128&d=identicon&r=PG&f=1", "display_name": "pk-n", "link": "https://stackoverflow.com/users/5537203/pk-n"}, "is_accepted": false, "score": 0, "last_activity_date": 1473311067, "creation_date": 1473311067, "answer_id": 39382936, "question_id": 39379639, "link": "https://stackoverflow.com/questions/39379639/rails-5-issues-with-postgres-sql-password/39382936#39382936", "title": "Rails 5 issues with Postgres SQL password", "body": "<p>This is what i did.\n1) In pgsql create a new user ,give him a password, create a database with same name as of user, give user permission to create new databases.\n2) then in database.yml file</p>\n\n<pre><code>development:\n  &lt;&lt;: *default\n  database: appname_development #this will come by default if you specify to pg while creating app\n  username: user\n  password: password\n  pool: 5\n  host: localhost\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 6675907, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-KtkAh3jLkN4/AAAAAAAAAAI/AAAAAAAACgc/8SINQ89Lag0/photo.jpg?sz=128", "display_name": "johnmc", "link": "https://stackoverflow.com/users/6675907/johnmc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 340, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1473311067, "creation_date": 1473285547, "question_id": 39379639, "link": "https://stackoverflow.com/questions/39379639/rails-5-issues-with-postgres-sql-password", "title": "Rails 5 issues with Postgres SQL password", "body": "<p>I am building an application using Rails 5.0.0 set up with a Postgres database.</p>\n\n<p>When I try to run any rake commands, I get the following error:</p>\n\n<pre><code>rake aborted!\nPG::ConnectionBad: fe_sendauth: no password supplied}\n</code></pre>\n\n<p>I've looked all over Stack Overflow to no avail on fixing the issue.</p>\n\n<p>Here is my pg_hba.conf file:</p>\n\n<pre><code># TYPE  DATABASE        USER            ADDRESS                 METHOD\n\n# \"local\" is for Unix domain socket connections only\nlocal   all             all                                     trust\n# IPv4 local connections:\nhost    all             all             127.0.0.1/32            trust\n# IPv6 local connections:\nhost    all             all             ::1/128                 trust\n# Allow replication connections from localhost, by a user with the\n# replication privilege.\n#local   replication     John                                trust\n#host    replication     John        127.0.0.1/32            trust\n#host    replication     John        ::1/128                 trust\n</code></pre>\n\n<p>Here is my database.yml file for development:</p>\n\n<pre><code>development:\n &lt;&lt;: *default\n database: in-the-paint_development\n\n # The specified database role being used to connect to postgres.\n # To create additional roles in postgres see `$ createuser --help`.\n # When left blank, postgres will use the default role. This is\n # the same name as the operating system user that initialized the database.\n # username: in-the-paint\n\n # The password associated with the postgres role (username).\n # password:\n\n # Connect on a TCP socket. Omitted by default since the client uses a\n # domain socket that doesn't need configuration. Windows does not have\n # domain sockets, so uncomment these lines.\n # host: localhost\n\n # The TCP port the server listens on. Defaults to 5432.\n # If your server runs on a different port number, change accordingly.\n # port: 5432\n\n # Schema search path. The server defaults to $user,public\n #schema_search_path: myapp,sharedapp,public\n\n # Minimum log levels, in increasing order:\n #   debug5, debug4, debug3, debug2, debug1,\n #   log, notice, warning, error, fatal, and panic\n # Defaults to warning.\n #min_messages: notice\n</code></pre>\n\n<p>Finally, I used the following commands to install postgres:</p>\n\n<pre><code>brew install postgres\nmkdir -p $HOME/Library/LaunchAgents\nln -sfv /usr/local/opt/postgresql/*.plist ~/Library/LaunchAgents\nlaunchctl load ~/Library/LaunchAgents/homebrew.mxcl.postgresql.plist\n</code></pre>\n\n<p>The big issue is that I was never prompted to provide a password when setting up Postgres, so I don't know what to provide in my database.yml. Leaving a blank (\"\") space does not fix the issue.</p>\n\n<p>Do you know of anything I can fix in this code provided or commands I can run to help remedy this issue?</p>\n"}, {"tags": ["ruby", "threadpool", "jruby", "celluloid"], "answers": [{"tags": [], "owner": {"reputation": 1798, "user_id": 2636454, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/FyyQr.png?s=128&g=1", "display_name": "GDP2", "link": "https://stackoverflow.com/users/2636454/gdp2"}, "is_accepted": true, "score": 4, "last_activity_date": 1473298672, "creation_date": 1473298672, "answer_id": 39381340, "question_id": 39379387, "link": "https://stackoverflow.com/questions/39379387/attempting-to-use-pools-crashes-celluloid/39381340#39381340", "title": "Attempting to use pools crashes Celluloid", "body": "<p>It seems that others have run into this issue before: <a href=\"https://github.com/celluloid/celluloid-pool/issues/10\" rel=\"nofollow\">https://github.com/celluloid/celluloid-pool/issues/10</a>. I guess it has something to do with <code>Celluloid.services</code> being deprecated and not working in newer versions of Celluloid, so using <code>require 'celluloid/current'</code> rather than just <code>require 'celluloid'</code> seems to do the trick.</p>\n"}], "owner": {"reputation": 1798, "user_id": 2636454, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/FyyQr.png?s=128&g=1", "display_name": "GDP2", "link": "https://stackoverflow.com/users/2636454/gdp2"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 486, "favorite_count": 0, "accepted_answer_id": 39381340, "answer_count": 1, "score": 4, "last_activity_date": 1473298672, "creation_date": 1473284208, "question_id": 39379387, "link": "https://stackoverflow.com/questions/39379387/attempting-to-use-pools-crashes-celluloid", "title": "Attempting to use pools crashes Celluloid", "body": "<p>I'm trying to use pools in a project of mine that uses Celluloid. However, whenever I invoke the <code>pool</code> method on a class which <code>include</code>s Celluloid (thus receiving methods from <code>Celluloid::ClassMethods</code>) I consistently get the error:</p>\n\n<pre><code>NoMethodError: undefined method `services' for Celluloid:Module\n     router at /Users/my_username/.rvm/gems/jruby-9.0.5.0/gems/celluloid-supervision-0.20.6/lib/celluloid/supervision/deprecate/supervise.rb:54\n  supervise at /Users/my_username/.rvm/gems/jruby-9.0.5.0/gems/celluloid-supervision-0.20.6/lib/celluloid/supervision/deprecate/supervise.rb:6\n       pool at /Users/my_username/.rvm/gems/jruby-9.0.5.0/gems/celluloid-pool-0.20.5/lib/celluloid/supervision/container/behavior/pool.rb:13\n      &lt;top&gt; at celluloid_pool_test.rb:14\n</code></pre>\n\n<p>Specifically, this part seems to be the problem:</p>\n\n<blockquote>\n  <p>NoMethodError: undefined method `services' for Celluloid:Module</p>\n</blockquote>\n\n<p>It tells me that the offending line is <code>/Users/my_username/.rvm/gems/jruby-9.0.5.0/gems/celluloid-supervision-0.20.6/lib/celluloid/supervision/deprecate/supervise.rb:54</code>. It turns out that line holds the code for the <code>Celluloid::Supervision.router</code> method:</p>\n\n<pre><code>def router(*_args)\n  # TODO: Actually route, based on :branch, if present; or else:\n  Celluloid.services ### this line is what causes the error\nend\n</code></pre>\n\n<p>To make sure that the issue wasn't with my particular project, I grabbed a code sample from <a href=\"https://www.sitepoint.com/an-introduction-to-celluloid-part-ii/\" rel=\"nofollow\">this article</a> which utilizes pools and tried to run it:</p>\n\n<pre><code>require 'celluloid'\nrequire 'mathn'\n\nclass PrimeWorker\n  include Celluloid\n\n  def prime(number)\n    if number.prime?\n      puts number\n    end\n  end  \nend\n\npool = PrimeWorker.pool\n\n(2..1000).to_a.map do |i|\n  pool.prime! i\nend\n\nsleep 100\n</code></pre>\n\n<p>It failed with the exact same error as my project:</p>\n\n<p>Finally, I ran a dead simple piece of code in IRB to see if <code>pool</code> is what triggers the error about <code>services</code>:</p>\n\n<pre><code>class Foo\n  include Celluloid\nend\nFoo.pool\n</code></pre>\n\n<p>Sure enough, I got the exact same error. It seems that there is a bug in Celluloid or that I'm not loading a dependency properly. However, I did <code>require 'celluloid/supervision'</code> in my attempts at solving this, to no avail. Am I doing something wrong on my end or is this a bug in Celluloid?</p>\n"}, {"tags": ["ruby-on-rails", "json", "ruby", "hash"], "answers": [{"comments": [{"owner": {"reputation": 326, "user_id": 4954795, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/9d5a6a4729a786805054a118296d8bc5?s=128&d=identicon&r=PG&f=1", "display_name": "teresa", "link": "https://stackoverflow.com/users/4954795/teresa"}, "edited": false, "score": 0, "creation_date": 1473290924, "post_id": 39379343, "comment_id": 66088694, "body": "Thank you for your explanation, they both work really well. With the <code>fetch</code>, I was able to see which entries had <code>&#39;No venue&#39;</code>. One question, is it possible to add the <code>&#39;No venue&#39;</code> message to this <code>@result.select { |r| r.present? &amp;&amp; r.has_key?(&#39;venue&#39;) }.each do |i|</code> ?"}], "tags": [], "owner": {"reputation": 32682, "user_id": 120518, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/edf1077f9152b361937f12707e3af891?s=128&d=identicon&r=PG", "display_name": "Shadwell", "link": "https://stackoverflow.com/users/120518/shadwell"}, "is_accepted": true, "score": 1, "last_activity_date": 1473284029, "creation_date": 1473284029, "answer_id": 39379343, "question_id": 39379219, "link": "https://stackoverflow.com/questions/39379219/rails-how-to-display-hash-from-json-request/39379343#39379343", "title": "Rails how to display hash from JSON request", "body": "<p>Looks like you are on the right track; it's just that there's a result in there that is either nil or that doesn't have a venue within it.</p>\n\n<p>How you approach the problem depends on what you want to do those situations. </p>\n\n<p>You could filter the results to exclude results without a venue. It would be more efficient to do this as part of your query but you could just do:</p>\n\n<pre><code>@result.select { |r| r.present? &amp;&amp; r.has_key?('venue') }.each do |i|\n</code></pre>\n\n<p>Alternatively you could output \"no venue\" or somesuch if the venue is missing. I tend to use <a href=\"https://ruby-doc.org/core/Hash.html#method-i-fetch\" rel=\"nofollow\"><code>fetch</code></a> in situations like this. You can try to fetch the value from the hash but return a default if the key isn't in the hash. So, in your case, you could do:</p>\n\n<pre><code>&lt;%= i.fetch('venue', {}).fetch('name', 'No venue') %&gt;\n</code></pre>\n\n<p>This looks for the venue hash in the result but returns an empty hash if it isn't there. The second <code>fetch</code> then tries to retrieve the name from that hash and again returns <code>'No venue'</code> if it couldn't find it.</p>\n"}, {"comments": [{"owner": {"reputation": 326, "user_id": 4954795, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/9d5a6a4729a786805054a118296d8bc5?s=128&d=identicon&r=PG&f=1", "display_name": "teresa", "link": "https://stackoverflow.com/users/4954795/teresa"}, "edited": false, "score": 0, "creation_date": 1473289760, "post_id": 39379355, "comment_id": 66088419, "body": "Thanks for the reply. I tried <code>&lt;% @result.each do |i| %&gt;   &lt;%= i.has_key? &quot;venue&quot; ? i[&quot;venue&quot;][&quot;name&quot;] : &#39;Location unspecified&#39; %&gt; &lt;br &#47;&gt; &lt;% end %&gt; </code> and still got <code>undefined method </code>[]&#39; for nil:NilClass` error. But I do understand now that the <code>venue</code> might be missing for some of the <code>results</code> hence the error."}, {"owner": {"reputation": 9369, "user_id": 3724716, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/db6186238a22752875cea1841a19d769?s=128&d=identicon&r=PG", "display_name": "Arun Kumar Mohan", "link": "https://stackoverflow.com/users/3724716/arun-kumar-mohan"}, "reply_to_user": {"reputation": 326, "user_id": 4954795, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/9d5a6a4729a786805054a118296d8bc5?s=128&d=identicon&r=PG&f=1", "display_name": "teresa", "link": "https://stackoverflow.com/users/4954795/teresa"}, "edited": false, "score": 0, "creation_date": 1473289827, "post_id": 39379355, "comment_id": 66088439, "body": "@tshckr Thats strange. Are you able to display <code>i[&quot;venue&quot;]</code>?"}, {"owner": {"reputation": 326, "user_id": 4954795, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/9d5a6a4729a786805054a118296d8bc5?s=128&d=identicon&r=PG&f=1", "display_name": "teresa", "link": "https://stackoverflow.com/users/4954795/teresa"}, "edited": false, "score": 0, "creation_date": 1473290063, "post_id": 39379355, "comment_id": 66088500, "body": "Yup, that seems to work, but I get newline randomly which I think that&#39;s where the <code>venue</code> field may be <code>nil</code>? I edited my question above to add more lines to what was returned from <code>i[&quot;venue&quot;]</code>"}, {"owner": {"reputation": 9369, "user_id": 3724716, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/db6186238a22752875cea1841a19d769?s=128&d=identicon&r=PG", "display_name": "Arun Kumar Mohan", "link": "https://stackoverflow.com/users/3724716/arun-kumar-mohan"}, "reply_to_user": {"reputation": 326, "user_id": 4954795, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/9d5a6a4729a786805054a118296d8bc5?s=128&d=identicon&r=PG&f=1", "display_name": "teresa", "link": "https://stackoverflow.com/users/4954795/teresa"}, "edited": false, "score": 0, "creation_date": 1473291566, "post_id": 39379355, "comment_id": 66088833, "body": "@tshckr I have updated my answer. Let me know if it helps!"}, {"owner": {"reputation": 326, "user_id": 4954795, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/9d5a6a4729a786805054a118296d8bc5?s=128&d=identicon&r=PG&f=1", "display_name": "teresa", "link": "https://stackoverflow.com/users/4954795/teresa"}, "edited": false, "score": 0, "creation_date": 1473461752, "post_id": 39379355, "comment_id": 66166456, "body": "Sorry, I tried it but received the same <code>nil</code> error. These answers provided from Shadwell: <code>@result.select { |r| r.present? &amp;&amp; r.has_key?(&#39;venue&#39;) }.each do |i|</code> and <code>&lt;%= i.fetch(&#39;venue&#39;, {}).fetch(&#39;name&#39;, &#39;No venue&#39;) %&gt;</code> did work. But I am not trying to ignore the results with no <code>venue</code> I want to display them as well except with a &quot;TBD&quot;. Thank you for your feedback."}, {"owner": {"reputation": 9369, "user_id": 3724716, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/db6186238a22752875cea1841a19d769?s=128&d=identicon&r=PG", "display_name": "Arun Kumar Mohan", "link": "https://stackoverflow.com/users/3724716/arun-kumar-mohan"}, "reply_to_user": {"reputation": 326, "user_id": 4954795, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/9d5a6a4729a786805054a118296d8bc5?s=128&d=identicon&r=PG&f=1", "display_name": "teresa", "link": "https://stackoverflow.com/users/4954795/teresa"}, "edited": false, "score": 0, "creation_date": 1473462421, "post_id": 39379355, "comment_id": 66166594, "body": "@tshckr, thanks for trying my solution. I think you misinterpreted my answer. My code only rejects objects which are nil and not objects which don&#39;t have a <code>venue</code> field. Remember you saw newlines when you tried to display objects in the array? Thats because one of the objects was <code>nil</code>. This is necessary because <code>obj.has_key? &quot;venue&quot;</code> can only be done  if <code>obj</code> is not <code>nil</code>. Thanks again!"}], "tags": [], "owner": {"reputation": 9369, "user_id": 3724716, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/db6186238a22752875cea1841a19d769?s=128&d=identicon&r=PG", "display_name": "Arun Kumar Mohan", "link": "https://stackoverflow.com/users/3724716/arun-kumar-mohan"}, "is_accepted": false, "score": 2, "last_activity_date": 1473462389, "last_edit_date": 1473462389, "creation_date": 1473284074, "answer_id": 39379355, "question_id": 39379219, "link": "https://stackoverflow.com/questions/39379219/rails-how-to-display-hash-from-json-request/39379355#39379355", "title": "Rails how to display hash from JSON request", "body": "<p>Are you sure that every object in the <code>results</code> array has a <code>venue</code> field? </p>\n\n<p>Before trying to access the <code>venue</code> field, make sure to see if the object actually exists. In your controller, add this</p>\n\n<pre><code>@result = @api_response[\"results\"].reject {|obj| obj.nil?}\n</code></pre>\n\n<p>This will remove any object in the array which is <code>nil</code>.</p>\n\n<p>What if the object exists but the field <code>venue</code> doesn't?</p>\n\n<pre><code>&lt;% @result.each do |i| %&gt;\n  &lt;%= i.has_key? \"venue\" ? i[\"venue\"][\"name\"] : 'Location unspecified' %&gt; &lt;br /&gt;\n&lt;% end %&gt; \n</code></pre>\n\n<p>If this looks messy, you could also move it to a helper method like</p>\n\n<pre><code>def venue_name(obj)\n  obj.has_key? \"venue\" ? obj[\"venue\"][\"name\"] : 'Location unspecified'\nend\n</code></pre>\n\n<p>And then make use of it in the view.</p>\n\n<pre><code> &lt;% @result.each do |i| %&gt;\n  &lt;%= venue_name(i) %&gt; &lt;br/&gt;\n &lt;% end %&gt; \n</code></pre>\n"}], "owner": {"reputation": 326, "user_id": 4954795, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/9d5a6a4729a786805054a118296d8bc5?s=128&d=identicon&r=PG&f=1", "display_name": "teresa", "link": "https://stackoverflow.com/users/4954795/teresa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 394, "favorite_count": 0, "accepted_answer_id": 39379343, "answer_count": 2, "score": 2, "last_activity_date": 1473462389, "creation_date": 1473283440, "last_edit_date": 1495535350, "question_id": 39379219, "link": "https://stackoverflow.com/questions/39379219/rails-how-to-display-hash-from-json-request", "title": "Rails how to display hash from JSON request", "body": "<p>I'm trying to display the inner levels of the hash from my JSON request. </p>\n\n<p>This is the return from JSON request: </p>\n\n<pre><code>{\n    \"results\": [\n    {\n    \"utc_offset\": -25200000,\n    \"venue\": {\n      \"zip\": \"94305\",\n      \"country\": \"us\",\n      \"localized_country_name\": \"USA\",\n      \"city\": \"Stanford\",\n      \"address_1\": \"750 Escondido Road\",\n      \"name\": \"Ray's - Graduate Community Center\",\n      \"lon\": -122.158386,\n      \"id\": 5612552,\n      \"state\": \"CA\",\n      \"lat\": 37.423393,\n      \"repinned\": false\n    },\n    \"status\": \"upcoming\"\n    },\n    {\n    \"utc_offset\": -25200000,\n    \"venue\": {\n      \"zip\": \"94306\",\n      \"country\": \"us\",\n      \"localized_country_name\": \"USA\",\n      \"city\": \"Palo Alto\",\n      \"address_1\": \"25 Churchill Ave\",\n      \"name\": \"Palo Alto High School\",\n      \"lon\": -122.154121,\n      \"id\": 1566333,\n      \"state\": \"CA\",\n      \"lat\": 37.433186,\n      \"repinned\": false\n    },\n    \"status\": \"upcoming\"\n    },\n    {\n    \"utc_offset\": -25200000,\n    \"venue\": {\n      \"zip\": \"94306\",\n      \"country\": \"us\",\n      \"localized_country_name\": \"USA\",\n      \"city\": \"Palo Alto\",\n      \"address_1\": \"25 Churchill Ave\",\n      \"name\": \"Palo Alto High School\",\n      \"lon\": -122.154121,\n      \"id\": 1566333,\n      \"state\": \"CA\",\n      \"lat\": 37.433186,\n      \"repinned\": false\n    },\n    \"status\": \"upcoming\"\n    }\n    ]\n    }\n}\n</code></pre>\n\n<p>I've referred to: <a href=\"https://stackoverflow.com/questions/26666913/how-to-use-json-data-returned-by-api-call-in-rails-4\">How to use JSON data returned by API call in Rails 4</a>, <a href=\"https://stackoverflow.com/questions/9106717/how-to-get-a-second-level-field-from-json-file-using-ruby\">How to get a second level field from json file using ruby</a>, <a href=\"https://stackoverflow.com/questions/19549098/why-do-i-get-no-implicit-conversion-of-string-into-integer-typeerror\">Why do I get &quot;no implicit conversion of String into Integer (TypeError)&quot;?</a>,  <a href=\"https://stackoverflow.com/questions/28245039/how-to-access-json-in-rails\">How to access JSON in Rails?</a> </p>\n\n<p>Which helped me get to this point, I can display the inner levels of the hash if I specify the array index using <code>@result = @api_response[\"results\"][0][\"venue\"][\"name\"]</code> which returns <code>\"Ray's - Graduate Community Center\"</code>. This is what I am trying to display, but I wanted to display the name for all the venue on the list and not just the name at index [0]. But I'm not sure how to iterate through the index.  </p>\n\n<p>I can also display the hashed results by using <code>@result = @api_response[\"results\"]</code> and iterate through using:  </p>\n\n<pre><code>&lt;% @result.each do |i| %&gt;\n  &lt;%= i[\"venue\"] %&gt;\n&lt;% end %&gt; \n</code></pre>\n\n<p>Which returns: </p>\n\n<pre><code>{\"zip\"=&gt;\"94305\", \"country\"=&gt;\"us\", \"localized_country_name\"=&gt;\"USA\", \"city\"=&gt;\"Stanford\", \"address_1\"=&gt;\"750 Escondido Road\", \"name\"=&gt;\"Ray's - Graduate Community Center\", \"lon\"=&gt;-122.158386, \"id\"=&gt;5612552, \"state\"=&gt;\"CA\", \"lat\"=&gt;37.423393, \"repinned\"=&gt;false} \n{\"zip\"=&gt;\"94305\", \"country\"=&gt;\"us\", \"localized_country_name\"=&gt;\"USA\", \"city\"=&gt;\"Stanford\", \"address_1\"=&gt;\"750 Escondido Road\", \"name\"=&gt;\"Ray's - Graduate Community Center\", \"lon\"=&gt;-122.158386, \"id\"=&gt;5612552, \"state\"=&gt;\"CA\", \"lat\"=&gt;37.423393, \"repinned\"=&gt;false} \n{\"zip\"=&gt;\"94306\", \"country\"=&gt;\"us\", \"localized_country_name\"=&gt;\"USA\", \"city\"=&gt;\"Palo Alto\", \"address_1\"=&gt;\"25 Churchill Ave\", \"name\"=&gt;\"Palo Alto High School\", \"lon\"=&gt;-122.154121, \"id\"=&gt;1566333, \"state\"=&gt;\"CA\", \"lat\"=&gt;37.433186, \"repinned\"=&gt;false} \n{\"zip\"=&gt;\"94306\", \"country\"=&gt;\"us\", \"localized_country_name\"=&gt;\"USA\", \"city\"=&gt;\"Palo Alto\", \"address_1\"=&gt;\"25 Churchill Ave\", \"name\"=&gt;\"Palo Alto High School\", \"lon\"=&gt;-122.154121, \"id\"=&gt;1566333, \"state\"=&gt;\"CA\", \"lat\"=&gt;37.433186, \"repinned\"=&gt;false} \n\n{\"zip\"=&gt;\"94306\", \"country\"=&gt;\"us\", \"localized_country_name\"=&gt;\"USA\", \"city\"=&gt;\"Palo Alto\", \"address_1\"=&gt;\"25 Churchill Ave\", \"name\"=&gt;\"Palo Alto High School\", \"lon\"=&gt;-122.154121, \"id\"=&gt;1566333, \"state\"=&gt;\"CA\", \"lat\"=&gt;37.433186, \"repinned\"=&gt;false} \n{\"zip\"=&gt;\"94306\", \"country\"=&gt;\"us\", \"localized_country_name\"=&gt;\"USA\", \"city\"=&gt;\"Palo Alto\", \"address_1\"=&gt;\"25 Churchill Ave\", \"name\"=&gt;\"Palo Alto High School\", \"lon\"=&gt;-122.154121, \"id\"=&gt;1566333, \"state\"=&gt;\"CA\", \"lat\"=&gt;37.433186, \"repinned\"=&gt;false} \n</code></pre>\n\n<p>But when I try using this: </p>\n\n<pre><code>&lt;% @result.each do |i| %&gt;\n  &lt;%= i[\"venue\"][\"name\"] %&gt; &lt;br /&gt;\n&lt;% end %&gt; \n</code></pre>\n\n<p>I get a <code>undefined method</code>[]' for nil:NilClass` error, it does not let me access the \"name\" inside of \"venue\" which I am trying to display. </p>\n\n<p>Am I on the right track? Is there a better way to display the inner levels of the hash? Any feedback would help. Thanks!</p>\n"}, {"tags": ["ruby", "heroku", "pg"], "comments": [{"owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 0, "creation_date": 1473296105, "post_id": 39378618, "comment_id": 66089763, "body": "have you tried installing <code>ffi</code>? That&#39;s what the error suggests"}], "answers": [{"tags": [], "owner": {"reputation": 857, "user_id": 1139720, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/156b6eb777de00400e9aa659fd519c89?s=128&d=identicon&r=PG", "display_name": "Balage1551", "link": "https://stackoverflow.com/users/1139720/balage1551"}, "is_accepted": false, "score": 0, "last_activity_date": 1473316589, "creation_date": 1473316589, "answer_id": 39384076, "question_id": 39378618, "link": "https://stackoverflow.com/questions/39378618/heroku-ruby-error-after-pgpull/39384076#39384076", "title": "Heroku ruby error after pg:pull", "body": "<p>Thanks all the suggestions and answered!</p>\n\n<p>It turned to be a simple broken release from Heroku Toolbelt. They rolled it back and I reinstalled Heroku. It solved the problem.</p>\n"}], "owner": {"reputation": 857, "user_id": 1139720, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/156b6eb777de00400e9aa659fd519c89?s=128&d=identicon&r=PG", "display_name": "Balage1551", "link": "https://stackoverflow.com/users/1139720/balage1551"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 67, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1473316589, "creation_date": 1473280721, "question_id": 39378618, "link": "https://stackoverflow.com/questions/39378618/heroku-ruby-error-after-pgpull", "title": "Heroku ruby error after pg:pull", "body": "<p>I used heroku quite without any problems for months. </p>\n\n<p>Today I tried to make a local database to separate the server side one from development. I followed the tutorial, installed PG, then used the heroku pg:pull command. It seemed to do something (and it did: created a new database locally, but without the schema and tables -- maybe because I use a named schema, not the default one?).</p>\n\n<p>After the pg:pull it terminated, I was not able to start any heroku commands anymore. I get:</p>\n\n<pre><code>&gt; heroku local web -f Procfile.windows &lt;nul\nC:/Program Files (x86)/Heroku/ruby-2.1.7/lib/ruby/2.1.0/rubygems/core_ext/kernel_require.rb:55:in `require': cannot load such file -- ffi (LoadError)\n    from C:/Program Files (x86)/Heroku/ruby-2.1.7/lib/ruby/2.1.0/rubygems/core_ext/kernel_require.rb:55:in `require'\n    from C:/Program Files (x86)/Heroku/vendor/gems/rest-client-1.8.0/lib/restclient/windows/root_certs.rb:2:in `&lt;top (required)&gt;'\n    from C:/Program Files (x86)/Heroku/vendor/gems/rest-client-1.8.0/lib/restclient/windows.rb:7:in `require_relative'\n    from C:/Program Files (x86)/Heroku/vendor/gems/rest-client-1.8.0/lib/restclient/windows.rb:7:in `&lt;top (required)&gt;'\n    from C:/Program Files (x86)/Heroku/ruby-2.1.7/lib/ruby/2.1.0/rubygems/core_ext/kernel_require.rb:55:in `require'\n    from C:/Program Files (x86)/Heroku/ruby-2.1.7/lib/ruby/2.1.0/rubygems/core_ext/kernel_require.rb:55:in `require'\n    from C:/Program Files (x86)/Heroku/vendor/gems/rest-client-1.8.0/lib/restclient.rb:16:in `&lt;top (required)&gt;'\n    from C:/Program Files (x86)/Heroku/ruby-2.1.7/lib/ruby/2.1.0/rubygems/core_ext/kernel_require.rb:55:in `require'\n    from C:/Program Files (x86)/Heroku/ruby-2.1.7/lib/ruby/2.1.0/rubygems/core_ext/kernel_require.rb:55:in `require'\n    from C:/Program Files (x86)/Heroku/vendor/gems/rest-client-1.8.0/lib/rest_client.rb:2:in `&lt;top (required)&gt;'\n    from C:/Program Files (x86)/Heroku/ruby-2.1.7/lib/ruby/2.1.0/rubygems/core_ext/kernel_require.rb:55:in `require'\n    from C:/Program Files (x86)/Heroku/ruby-2.1.7/lib/ruby/2.1.0/rubygems/core_ext/kernel_require.rb:55:in `require'\n    from C:/Program Files (x86)/Heroku/lib/heroku/command.rb:8:in `&lt;top (required)&gt;'\n    from C:/Program Files (x86)/Heroku/ruby-2.1.7/lib/ruby/2.1.0/rubygems/core_ext/kernel_require.rb:55:in `require'\n    from C:/Program Files (x86)/Heroku/ruby-2.1.7/lib/ruby/2.1.0/rubygems/core_ext/kernel_require.rb:55:in `require'\n    from C:/Program Files (x86)/Heroku/lib/heroku/client.rb:4:in `&lt;top (required)&gt;'\n    from C:/Program Files (x86)/Heroku/ruby-2.1.7/lib/ruby/2.1.0/rubygems/core_ext/kernel_require.rb:55:in `require'\n    from C:/Program Files (x86)/Heroku/ruby-2.1.7/lib/ruby/2.1.0/rubygems/core_ext/kernel_require.rb:55:in `require'\n    from C:/Program Files (x86)/Heroku/lib/heroku/auth.rb:3:in `&lt;top (required)&gt;'\n    from C:/Program Files (x86)/Heroku/ruby-2.1.7/lib/ruby/2.1.0/rubygems/core_ext/kernel_require.rb:55:in `require'\n    from C:/Program Files (x86)/Heroku/ruby-2.1.7/lib/ruby/2.1.0/rubygems/core_ext/kernel_require.rb:55:in `require'\n    from C:/Program Files (x86)/Heroku/lib/heroku/analytics.rb:1:in `&lt;top (required)&gt;'\n    from C:/Program Files (x86)/Heroku/ruby-2.1.7/lib/ruby/2.1.0/rubygems/core_ext/kernel_require.rb:55:in `require'\n    from C:/Program Files (x86)/Heroku/ruby-2.1.7/lib/ruby/2.1.0/rubygems/core_ext/kernel_require.rb:55:in `require'\n    from C:/Program Files (x86)/Heroku/lib/heroku/cli.rb:13:in `&lt;top (required)&gt;'\n    from C:/Program Files (x86)/Heroku/ruby-2.1.7/lib/ruby/2.1.0/rubygems/core_ext/kernel_require.rb:55:in `require'\n    from C:/Program Files (x86)/Heroku/ruby-2.1.7/lib/ruby/2.1.0/rubygems/core_ext/kernel_require.rb:55:in `require'\n    from C:/Program Files (x86)/Heroku/bin/heroku:27:in `&lt;main&gt;'\n</code></pre>\n\n<p>I tried to reinstall heroku toolbelt, but with no result.</p>\n\n<p>I am using Windows.</p>\n\n<p>Does anyone have any idea how to fix it?</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 9030, "user_id": 5101476, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JCQrl.jpg?s=128&g=1", "display_name": "ice\u30c4", "link": "https://stackoverflow.com/users/5101476/ice%e3%83%84"}, "edited": false, "score": 0, "creation_date": 1473282559, "post_id": 39378574, "comment_id": 66086015, "body": "Would <code>next_numb(15)</code> return <code>15</code> or <code>21</code>?"}, {"owner": {"reputation": 6687, "user_id": 6496010, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/4d564ef7fd53e4e76e5e520945dcc4c1?s=128&d=identicon&r=PG", "display_name": "davidhu", "link": "https://stackoverflow.com/users/6496010/davidhu"}, "edited": false, "score": 0, "creation_date": 1473283154, "post_id": 39378574, "comment_id": 66086267, "body": "it will be <code>21</code>, since OP&#39;s looking for the next number."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1473291164, "post_id": 39378574, "comment_id": 66088742, "body": "I don&#39;t think I&#39;ve seen that abbreviation for the word &quot;number&quot;."}], "answers": [{"comments": [{"owner": {"reputation": 1481, "user_id": 6457247, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/47868d53bb9dff22de781935666b5031?s=128&d=identicon&r=PG&f=1", "display_name": "AltBrian", "link": "https://stackoverflow.com/users/6457247/altbrian"}, "edited": false, "score": 0, "creation_date": 1473282247, "post_id": 39378835, "comment_id": 66085851, "body": "so the method would read <code>def next_numb(n)  x = n + 3  if x % 2 == 1 &amp;&amp; x % 3 == 0 &amp;&amp;  x.to_s.split(&#47;&#47;).uniq == x.to_s.split(&#47;&#47;) return x  end end</code>"}, {"owner": {"reputation": 6687, "user_id": 6496010, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/4d564ef7fd53e4e76e5e520945dcc4c1?s=128&d=identicon&r=PG", "display_name": "davidhu", "link": "https://stackoverflow.com/users/6496010/davidhu"}, "reply_to_user": {"reputation": 1481, "user_id": 6457247, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/47868d53bb9dff22de781935666b5031?s=128&d=identicon&r=PG&f=1", "display_name": "AltBrian", "link": "https://stackoverflow.com/users/6457247/altbrian"}, "edited": false, "score": 0, "creation_date": 1473282372, "post_id": 39378835, "comment_id": 66085908, "body": "yeah, but like i said, i would suggest putting that last part in a method, for readability."}, {"owner": {"reputation": 9030, "user_id": 5101476, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JCQrl.jpg?s=128&g=1", "display_name": "ice\u30c4", "link": "https://stackoverflow.com/users/5101476/ice%e3%83%84"}, "edited": false, "score": 0, "creation_date": 1473282831, "post_id": 39378835, "comment_id": 66086144, "body": "<code>next_numb 125 #=&gt; nil</code>"}, {"owner": {"reputation": 1481, "user_id": 6457247, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/47868d53bb9dff22de781935666b5031?s=128&d=identicon&r=PG&f=1", "display_name": "AltBrian", "link": "https://stackoverflow.com/users/6457247/altbrian"}, "edited": false, "score": 0, "creation_date": 1473283261, "post_id": 39378835, "comment_id": 66086311, "body": "Thanks davidhu2000 . I will try that. Not sure if I need the <code>x = n + 3</code> . If I put 13 in the method it should return 15 like 12. So will need to try and work that out.  Thanks for your help."}, {"owner": {"reputation": 9030, "user_id": 5101476, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JCQrl.jpg?s=128&g=1", "display_name": "ice\u30c4", "link": "https://stackoverflow.com/users/5101476/ice%e3%83%84"}, "edited": false, "score": 0, "creation_date": 1473283832, "post_id": 39378835, "comment_id": 66086511, "body": "I believe you can use <code>split</code> instead of <code>split(&#39;&#39;)</code> or even better use <code>chars</code>."}, {"owner": {"reputation": 6687, "user_id": 6496010, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/4d564ef7fd53e4e76e5e520945dcc4c1?s=128&d=identicon&r=PG", "display_name": "davidhu", "link": "https://stackoverflow.com/users/6496010/davidhu"}, "edited": false, "score": 0, "creation_date": 1473284261, "post_id": 39378835, "comment_id": 66086665, "body": "the default delimiter for <code>split</code> is white space, so you need the <code>(&#39;&#39;)</code> part, but <code>chars</code> will work"}, {"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 1, "creation_date": 1473288155, "post_id": 39378835, "comment_id": 66087970, "body": "Please avoid using &quot;edit&quot; or &quot;update&quot; tags in your questions or answers. Instead, add the additional content where it would have been if it&#39;d been there originally. We can see what changed if we need to."}], "tags": [], "owner": {"reputation": 6687, "user_id": 6496010, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/4d564ef7fd53e4e76e5e520945dcc4c1?s=128&d=identicon&r=PG", "display_name": "davidhu", "link": "https://stackoverflow.com/users/6496010/davidhu"}, "is_accepted": true, "score": 1, "last_activity_date": 1473288087, "last_edit_date": 1473288087, "creation_date": 1473281663, "answer_id": 39378835, "question_id": 39378574, "link": "https://stackoverflow.com/questions/39378574/how-to-get-a-number-higher-than-a-given-value/39378835#39378835", "title": "How to get a number higher than a given value", "body": "<p>To test if the number only has unique values, you can do this:</p>\n\n<pre><code>num.to_s.split('').uniq == num.to_s.split('')\n</code></pre>\n\n<p>You are splitting each number into its individual digits, as strings, and then running <code>uniq</code> to remove duplicates, and, if that is the same as the array without <code>uniq</code>, then you have a number with non-duplicate digits. </p>\n\n<p>If you add this to your <code>if</code> statement, it will get pretty long, so I suggest you wrap this in a method that returns <code>true</code> or <code>false</code>:</p>\n\n<pre><code>def unique_digits?(num)\n  num.to_s.split('').uniq == num.to_s.split('')\nend\n</code></pre>\n\n<p>Your <code>if</code> statement will be:</p>\n\n<pre><code>def next_numb(n)\n  x = n + 3\n  if x % 2 == 1 &amp;&amp; x % 3 == 0 &amp;&amp; unique_digits?(x)\n    return x\n  end\nend\n</code></pre>\n\n<p>I noticed something else about your code, it will only add 3 to <code>n</code> and checks if the number meets all of the conditions, if so, it will return the number, and if not, it will return <code>nil</code>. </p>\n\n<p>If you have an input of <code>15</code>, your function will return <code>nil</code>, because <code>18</code> is not odd. The right number to return is <code>21</code>, so you will need a loop:</p>\n\n<pre><code>def next_numb(n)\n  x = n + 1\n  until x % 2 == 1 &amp;&amp; x % 3 == 0 &amp;&amp; unique_digits?(x)\n    x += 1\n  end\n  x\nend\n\ndef unique_digits?(num)\n  num.to_s.split('').uniq == num.to_s.split('')\nend\n\nnext_numb(13)  #=&gt; 15\nnext_numb(15)  #=&gt; 21\nnext_numb(125) #=&gt; 129\n</code></pre>\n"}], "owner": {"reputation": 1481, "user_id": 6457247, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/47868d53bb9dff22de781935666b5031?s=128&d=identicon&r=PG&f=1", "display_name": "AltBrian", "link": "https://stackoverflow.com/users/6457247/altbrian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 55, "favorite_count": 0, "accepted_answer_id": 39378835, "answer_count": 1, "score": 0, "last_activity_date": 1473288087, "creation_date": 1473280541, "last_edit_date": 1473287964, "question_id": 39378574, "link": "https://stackoverflow.com/questions/39378574/how-to-get-a-number-higher-than-a-given-value", "title": "How to get a number higher than a given value", "body": "<p>I'm  trying to write a function that receives a value, <code>val</code> and outputs the smallest higher number than the given value. This number belongs to a set of positive integers that have the following properties: Their digits occur only once, they are odd and they are multiple of three.</p>\n\n<p>This is the code that I have written so far:</p>\n\n<pre><code>def next_numb(n)\n\n  x = n + 3\n  if x % 2 == 1 &amp;&amp; x % 3 == 0\n    return x\n  end\nend\n</code></pre>\n\n<p>How can I test for unique numbers?  Also, if I enter 12 the answer is 15 and the same is for 13.</p>\n"}, {"tags": ["arrays", "ruby"], "answers": [{"comments": [{"owner": {"reputation": 2393, "user_id": 5252715, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/173d75348dae4a3a945234ac0a528e37?s=128&d=identicon&r=PG", "display_name": "malexanders", "link": "https://stackoverflow.com/users/5252715/malexanders"}, "edited": false, "score": 1, "creation_date": 1473280762, "post_id": 39378589, "comment_id": 66085170, "body": "great suggestion, however, for a = [1,2,3,4,4]. a.delete(a.max) returns 4. And both 4&#39;s are removed from the array. Not quite what I&#39;m after. It would be great if it returned a single 4 and a single 4 was remove from the array. Then it would be perfect."}, {"owner": {"reputation": 1037, "user_id": 3366016, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4721c96622c2e1798f6cfece8a0f52f?s=128&d=identicon&r=PG&f=1", "display_name": "user3366016", "link": "https://stackoverflow.com/users/3366016/user3366016"}, "reply_to_user": {"reputation": 2393, "user_id": 5252715, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/173d75348dae4a3a945234ac0a528e37?s=128&d=identicon&r=PG", "display_name": "malexanders", "link": "https://stackoverflow.com/users/5252715/malexanders"}, "edited": false, "score": 0, "creation_date": 1473281177, "post_id": 39378589, "comment_id": 66085359, "body": "@matthewalexander, good call.  I&#39;ve updated to handle that.  It should work as it deletes by index, not by value."}, {"owner": {"reputation": 2393, "user_id": 5252715, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/173d75348dae4a3a945234ac0a528e37?s=128&d=identicon&r=PG", "display_name": "malexanders", "link": "https://stackoverflow.com/users/5252715/malexanders"}, "edited": false, "score": 0, "creation_date": 1473281369, "post_id": 39378589, "comment_id": 66085458, "body": "Try your second solution on the return array [1,2,3,4] you will find it fails because there is nothing at index 4. delete_at requires that you pass in the index of the value you want to delete. We are getting closer!"}, {"owner": {"reputation": 6687, "user_id": 6496010, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/4d564ef7fd53e4e76e5e520945dcc4c1?s=128&d=identicon&r=PG", "display_name": "davidhu", "link": "https://stackoverflow.com/users/6496010/davidhu"}, "edited": false, "score": 2, "creation_date": 1473281466, "post_id": 39378589, "comment_id": 66085510, "body": "you can do <code>a.delete_at(a.index(a.max))</code>"}, {"owner": {"reputation": 1037, "user_id": 3366016, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4721c96622c2e1798f6cfece8a0f52f?s=128&d=identicon&r=PG&f=1", "display_name": "user3366016", "link": "https://stackoverflow.com/users/3366016/user3366016"}, "reply_to_user": {"reputation": 6687, "user_id": 6496010, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/4d564ef7fd53e4e76e5e520945dcc4c1?s=128&d=identicon&r=PG", "display_name": "davidhu", "link": "https://stackoverflow.com/users/6496010/davidhu"}, "edited": false, "score": 0, "creation_date": 1473281781, "post_id": 39378589, "comment_id": 66085654, "body": "Thanks @davidhu2000, I was just cooking that up.  It feels a bit dirty though. <code>a.delete_at(a.index(a.max))</code>.  Updating answer.  I do like using the max and delete methods as they are easy to read but sort.pop may be a good way to go to. Might have some adverse side-effects potentially?"}, {"owner": {"reputation": 6687, "user_id": 6496010, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/4d564ef7fd53e4e76e5e520945dcc4c1?s=128&d=identicon&r=PG", "display_name": "davidhu", "link": "https://stackoverflow.com/users/6496010/davidhu"}, "edited": false, "score": 0, "creation_date": 1473281859, "post_id": 39378589, "comment_id": 66085692, "body": "if you use <code>pop</code> method, then return value is the value that is removed from the array, and not the array itself."}, {"owner": {"reputation": 2393, "user_id": 5252715, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/173d75348dae4a3a945234ac0a528e37?s=128&d=identicon&r=PG", "display_name": "malexanders", "link": "https://stackoverflow.com/users/5252715/malexanders"}, "edited": false, "score": 0, "creation_date": 1473282013, "post_id": 39378589, "comment_id": 66085758, "body": "delete_at also returns the value that has been removed from the array"}, {"owner": {"reputation": 1037, "user_id": 3366016, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4721c96622c2e1798f6cfece8a0f52f?s=128&d=identicon&r=PG&f=1", "display_name": "user3366016", "link": "https://stackoverflow.com/users/3366016/user3366016"}, "reply_to_user": {"reputation": 6687, "user_id": 6496010, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/4d564ef7fd53e4e76e5e520945dcc4c1?s=128&d=identicon&r=PG", "display_name": "davidhu", "link": "https://stackoverflow.com/users/6496010/davidhu"}, "edited": false, "score": 0, "creation_date": 1473282048, "post_id": 39378589, "comment_id": 66085774, "body": "@davidhu2000 but if you use <code>sort!</code> it sorts in place. At least it works in my console."}, {"owner": {"reputation": 6687, "user_id": 6496010, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/4d564ef7fd53e4e76e5e520945dcc4c1?s=128&d=identicon&r=PG", "display_name": "davidhu", "link": "https://stackoverflow.com/users/6496010/davidhu"}, "edited": false, "score": 0, "creation_date": 1473282606, "post_id": 39378589, "comment_id": 66086033, "body": "the return value of the <code>pop</code> method is still the number that is removed, i think OP wants to return the adjusted array, you can do <code>a = a.sort[0..-2]</code>"}], "tags": [], "owner": {"reputation": 1037, "user_id": 3366016, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4721c96622c2e1798f6cfece8a0f52f?s=128&d=identicon&r=PG&f=1", "display_name": "user3366016", "link": "https://stackoverflow.com/users/3366016/user3366016"}, "is_accepted": true, "score": 7, "last_activity_date": 1473285736, "last_edit_date": 1473285736, "creation_date": 1473280615, "answer_id": 39378589, "question_id": 39378543, "link": "https://stackoverflow.com/questions/39378543/how-to-find-return-and-remove-the-maximum-value-from-an-array-in-ruby/39378589#39378589", "title": "How to find, return and remove the maximum value from an array in Ruby?", "body": "<p>You could do something like this.</p>\n\n<pre><code>a = [1,2,3,4]\na.delete(a.max)\n=&gt; 4\na =&gt; [1, 2, 3]\n</code></pre>\n\n<p>To delete a single instance if there are duplicates you could use something like (As per the comments, use a.index(a.max) to get the index of the max value)</p>\n\n<pre><code>a = [1, 2, 3, 4, 4]\na.delete_at(a.index(a.max))\n=&gt; 4\na =&gt; [1, 2, 3, 4]\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 2393, "user_id": 5252715, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/173d75348dae4a3a945234ac0a528e37?s=128&d=identicon&r=PG", "display_name": "malexanders", "link": "https://stackoverflow.com/users/5252715/malexanders"}, "edited": false, "score": 0, "creation_date": 1473281517, "post_id": 39378752, "comment_id": 66085535, "body": "Great suggestion - is it necessary to do a sort? Is this more efficient than the answer I posted?"}, {"owner": {"reputation": 9030, "user_id": 5101476, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JCQrl.jpg?s=128&g=1", "display_name": "ice\u30c4", "link": "https://stackoverflow.com/users/5101476/ice%e3%83%84"}, "reply_to_user": {"reputation": 2393, "user_id": 5252715, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/173d75348dae4a3a945234ac0a528e37?s=128&d=identicon&r=PG", "display_name": "malexanders", "link": "https://stackoverflow.com/users/5252715/malexanders"}, "edited": false, "score": 2, "creation_date": 1473281706, "post_id": 39378752, "comment_id": 66085614, "body": "<code>sort!</code> ensures you&#39;re <code>pop</code>ing a max value, so I&#39;d say leave it, unless you know for sure your array is already sorted in which case you can just use <code>pop</code>. For efficiency, I guess you&#39;ll have to run some benchmarks...:)"}], "tags": [], "owner": {"reputation": 9030, "user_id": 5101476, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JCQrl.jpg?s=128&g=1", "display_name": "ice\u30c4", "link": "https://stackoverflow.com/users/5101476/ice%e3%83%84"}, "is_accepted": false, "score": 2, "last_activity_date": 1473281278, "creation_date": 1473281278, "answer_id": 39378752, "question_id": 39378543, "link": "https://stackoverflow.com/questions/39378543/how-to-find-return-and-remove-the-maximum-value-from-an-array-in-ruby/39378752#39378752", "title": "How to find, return and remove the maximum value from an array in Ruby?", "body": "<p>This should do the trick:</p>\n\n<pre><code>a.sort!.pop #=&gt; 4\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2393, "user_id": 5252715, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/173d75348dae4a3a945234ac0a528e37?s=128&d=identicon&r=PG", "display_name": "malexanders", "link": "https://stackoverflow.com/users/5252715/malexanders"}, "is_accepted": false, "score": 0, "last_activity_date": 1473281463, "creation_date": 1473281463, "answer_id": 39378795, "question_id": 39378543, "link": "https://stackoverflow.com/questions/39378543/how-to-find-return-and-remove-the-maximum-value-from-an-array-in-ruby/39378795#39378795", "title": "How to find, return and remove the maximum value from an array in Ruby?", "body": "<p>This works:</p>\n\n<pre><code>a.delete_at(a.index(a.max))\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "is_accepted": false, "score": 4, "last_activity_date": 1473289117, "last_edit_date": 1473289117, "creation_date": 1473288802, "answer_id": 39380163, "question_id": 39378543, "link": "https://stackoverflow.com/questions/39378543/how-to-find-return-and-remove-the-maximum-value-from-an-array-in-ruby/39380163#39380163", "title": "How to find, return and remove the maximum value from an array in Ruby?", "body": "<p>Benchmarks:</p>\n\n<pre><code>require 'fruity'\n\nARY = (0..99).to_a.shuffle\n\ncompare do\n  matthewalexander { a = ARY.dup; a.delete_at(a.index(a.max)) }\n  sagarpandya82    { a = ARY.dup; a.sort!.pop                 }\nend\n\n# &gt;&gt; Running each test 512 times. Test will take about 1 second.\n# &gt;&gt; sagarpandya82 is faster than matthewalexander by 10.000000000000009% \u00b1 10.0%\n</code></pre>\n\n<p>Increasing the size of ARY will change the results:</p>\n\n<pre><code>ARY = (0..999_999).to_a.shuffle\n\ncompare do\n  matthewalexander { a = ARY.dup; a.delete_at(a.index(a.max)) }\n  sagarpandya82    { a = ARY.dup; a.sort!.pop                 }\nend\n\n# &gt;&gt; Running each test once. Test will take about 5 seconds.\n# &gt;&gt; matthewalexander is faster than sagarpandya82 by 3x \u00b1 0.1\n</code></pre>\n\n<p>Use the appropriate approach for your given needs. If you don't know the size of the array I'd recommend assuming your data will grow since they're so close with small arrays.</p>\n"}], "owner": {"reputation": 2393, "user_id": 5252715, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/173d75348dae4a3a945234ac0a528e37?s=128&d=identicon&r=PG", "display_name": "malexanders", "link": "https://stackoverflow.com/users/5252715/malexanders"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3185, "favorite_count": 0, "accepted_answer_id": 39378589, "answer_count": 4, "score": 3, "last_activity_date": 1473289117, "creation_date": 1473280395, "last_edit_date": 1473288972, "question_id": 39378543, "link": "https://stackoverflow.com/questions/39378543/how-to-find-return-and-remove-the-maximum-value-from-an-array-in-ruby", "title": "How to find, return and remove the maximum value from an array in Ruby?", "body": "<p>I would like to find the max value in an array of integers, return that value, and remove it from the array. Is there a built in function for this? </p>\n\n<p>For <code>a = [1,2,3,4]</code>, I can easily do this <code>a.max</code> which returns <code>4</code>. However, <code>a[....]</code> remains unchanged.</p>\n"}, {"tags": ["ruby"], "answers": [{"tags": [], "owner": {"reputation": 91121, "user_id": 179125, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5594142dcc49a24b1902ec8059181f8d?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan Running", "link": "https://stackoverflow.com/users/179125/jordan-running"}, "is_accepted": true, "score": 4, "last_activity_date": 1473280237, "last_edit_date": 1473280237, "creation_date": 1473279144, "answer_id": 39378261, "question_id": 39378109, "link": "https://stackoverflow.com/questions/39378109/requiring-a-file-within-a-method/39378261#39378261", "title": "requiring a file within a method", "body": "<p>\"Copy\" is the wrong word here. <code>require</code> does not copy anything. It reads the source code in the given file and executes that code in Ruby's global (\"<code>main</code>\") context (unless the file has already been <code>require</code>d; then it does nothing and returns <code>false</code>). To quote <a href=\"https://ruby-doc.org/core-2.3.1/Kernel.html#method-i-require\" rel=\"nofollow\">the docs</a> (emphasis mine):</p>\n\n<blockquote>\n  <p>Any constants or globals within the loaded source file will be available <em>in the calling program\u2019s global namespace</em>.</p>\n</blockquote>\n\n<p><code>require</code> does not behave differently inside a method call, or inside a module, or anywhere else, than it does at the top of a file.</p>\n\n<p>When you see <code>require</code> inside a method call the reason is usually that the module is only needed in a particular scenario, and loading it before that scenario occurs would be wasteful (because, for example, the module takes a long time to load or accesses, during loading, resources that are only available in that scenario\u2014think different database drivers or OSes). It does not mean that the module is being loaded \"into\" the method or the surrounding code, because that's not what <code>require</code> does.</p>\n\n<p>To demonstrate, suppose we have a module like this:</p>\n\n<pre><code># baby_module.rb\nmodule BabyModule\n  NAME = \"Baby\"\nend\n</code></pre>\n\n<p>And suppose we run the following program:</p>\n\n<pre><code>module TheCorner\n  def self.load_baby_module\n    require File.expand_path(\"baby_module\", __dir__)\n  end\nend\n\nTheCorner.load_baby_module\n\nif defined?(TheCorner::BabyModule)\n  puts \"#{TheCorner::BabyModule::NAME} is in TheCorner\"\nelsif defined?(BabyModule)\n  puts \"Nobody puts #{BabyModule::NAME} in TheCorner\"\nend\n</code></pre>\n\n<p>As you have perhaps already guessed, this program's output will be:</p>\n\n<blockquote>\n  <p>Nobody puts Baby in TheCorner</p>\n</blockquote>\n"}, {"tags": [], "owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "is_accepted": false, "score": 1, "last_activity_date": 1473293263, "creation_date": 1473293263, "answer_id": 39380713, "question_id": 39378109, "link": "https://stackoverflow.com/questions/39378109/requiring-a-file-within-a-method/39380713#39380713", "title": "requiring a file within a method", "body": "<blockquote>\n  <p>So what is <code>require</code> doing that does not cause the syntax error?</p>\n</blockquote>\n\n<p>Simple: it runs the file.</p>\n"}], "owner": {"reputation": 5850, "user_id": 4501354, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/1230cfcc7f68488ad19d0022cf7b1a93?s=128&d=identicon&r=PG&f=1", "display_name": "Donato", "link": "https://stackoverflow.com/users/4501354/donato"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 618, "favorite_count": 0, "accepted_answer_id": 39378261, "answer_count": 2, "score": 1, "last_activity_date": 1473293263, "creation_date": 1473278442, "question_id": 39378109, "link": "https://stackoverflow.com/questions/39378109/requiring-a-file-within-a-method", "title": "requiring a file within a method", "body": "<p>I was looking at the contents of the Ransack ruby gem. Basically, it calls a method called <code>require_constants</code>. And that method itself requires a file:</p>\n\n<pre><code># ransack.rb\nrequire 'ransack/adapters'\nRansack::Adapters.object_mapper.require_constants\n\n# adapters.rb\nmodule Ransack\n  module Adapters\n\n    def self.object_mapper\n      @object_mapper ||= instantiate_object_mapper\n    end\n\n    def self.instantiate_object_mapper\n      if defined?(::ActiveRecord::Base)\n        ActiveRecordAdapter.new\n      elsif defined?(::Mongoid)\n        MongoidAdapter.new\n      end\n    end\n\n    class ActiveRecordAdapter\n      def require_constants\n        require 'ransack/adapters/active_record/ransack/constants'\n      end\n      ...\n\n# constants.rb\nmodule Ransack\n  module Constants\n</code></pre>\n\n<p>The first <code>require</code> copies the content of adapters.rb in ransack.rb, I believe. Hence, we can then reference <code>Ransack::Adapters</code> without an undefined error. </p>\n\n<p>However, when we call <code>require_constants</code>, it appears to copy the contents of <code>Ransack::Constants</code> into the method definition of <code>require_constants</code>.</p>\n\n<p>I find that kind of confusing. We are copying a module inside of a method. What benefit do we get of copying a module inside of a method, rather than just doing it like the other <code>require</code>? Second, I know the module is not a local variable, but I couldn't even define a module in the console when I tried it:</p>\n\n<pre><code>class A\n  def a\n    module B end\n  end\nend\nSyntaxError: (irb):14: module definition in method body\n</code></pre>\n\n<p>So what is <code>require</code> doing that does not cause the syntax error?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "mongodb", "mongoid", "mongoid5"], "answers": [{"tags": [], "owner": {"reputation": 2251, "user_id": 3755300, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/YK1TX.jpg?s=128&g=1", "display_name": "vdj4y", "link": "https://stackoverflow.com/users/3755300/vdj4y"}, "is_accepted": false, "score": 0, "last_activity_date": 1473281923, "last_edit_date": 1473281923, "creation_date": 1473279616, "answer_id": 39378365, "question_id": 39378071, "link": "https://stackoverflow.com/questions/39378071/what-is-a-good-way-to-update-or-initialize-with-in-mongoid/39378365#39378365", "title": "What is a good way to `update_or_initialize_with` in Mongoid?", "body": "<p>I am not familiar with ruby. But I think I understand the problem. Your schema might looks like this.</p>\n\n<pre><code>user = {\n   _id : user1234,\n   address: address789\n} \n\naddress = {\n   _id: address789,\n   street_name: \"\"\n   user: user1234\n}\n\n//in mongodb(javascript), you can get/update address of user this way\nu = User.find({_id: user1234})\nu.address //address789\ndb.address.update({user: u.address}, {street_name: \"new_street name\"})\n\n//but since the address has not been created, the variable u does not even have property address.\nu.address = undefined\n</code></pre>\n\n<p>Perhaps you can try to just create and attached it manually like this:</p>\n\n<pre><code> #create an address document, to get _id of this address\n address = address.insert({street_name: \"something\"}); \n\n #link or attached it to u.address\n u.update({address: address._id})\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 680, "user_id": 4573574, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e884033aa0468fd3ef37c8efc618e12?s=128&d=identicon&r=PG&f=1", "display_name": "Shiyason", "link": "https://stackoverflow.com/users/4573574/shiyason"}, "reply_to_user": {"reputation": 39282, "user_id": 336920, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/6e2dbeb23d3fc6552a6e26800ed63289?s=128&d=identicon&r=PG", "display_name": "B Seven", "link": "https://stackoverflow.com/users/336920/b-seven"}, "edited": false, "score": 0, "creation_date": 1473285380, "post_id": 39378919, "comment_id": 66087079, "body": "Because you will match against that key to either <code>update</code> if found or <code>insert</code> if not found. If you don&#39;t have a unique or sparse index, you can still update the first matching document or update all matching documents with the <code>{ multi: true }</code> flag.  Please see edit #2."}], "tags": [], "owner": {"reputation": 680, "user_id": 4573574, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e884033aa0468fd3ef37c8efc618e12?s=128&d=identicon&r=PG&f=1", "display_name": "Shiyason", "link": "https://stackoverflow.com/users/4573574/shiyason"}, "is_accepted": false, "score": 0, "last_activity_date": 1473285594, "last_edit_date": 1473285594, "creation_date": 1473282007, "answer_id": 39378919, "question_id": 39378071, "link": "https://stackoverflow.com/questions/39378071/what-is-a-good-way-to-update-or-initialize-with-in-mongoid/39378919#39378919", "title": "What is a good way to `update_or_initialize_with` in Mongoid?", "body": "<p>I had this problem recently. There is a built in way but it differs from active records' <code>#find_or_initialize_by</code> or <code>#find_or_create_by</code> method.</p>\n\n<p>In my case, I needed to bulk insert records and update or create if not found, but I believe the same technique can be used even if you are not bulk inserting.</p>\n\n<pre><code># returns an array of query hashes:\ndef update_command(users)\n  updates = []\n  users.each do |user|\n    updates &lt;&lt; { 'q' =&gt; {'user_id' =&gt; user._id},\n                 'u' =&gt; {'address' =&gt; 'address'},\n                 'multi' =&gt; false,\n                 'upsert' =&gt; true }\n  end\n  { update: Address.collection_name.to_s, updates: updates, ordered: false }\nend\n\ndef bulk_update(users)\n  client = Mongoid.default_client\n  command = bulk_command(users)\n  client.command command\n  client.close\nend\n</code></pre>\n\n<p>since your not bulk updating, assuming you have a foreign key field called <code>user_id</code> in your Address collection. You might be able to:</p>\n\n<pre><code>Address.collection.update({ 'q' =&gt; {'user_id' =&gt; user._id},\n                            'u' =&gt; {'address' =&gt; 'address'},\n                            'multi' =&gt; false,\n                            'upsert' =&gt; true }\n</code></pre>\n\n<p>which will match against the <code>user_id</code>, update the given fields when found (<code>address</code> in this case) or create a new one when not found.</p>\n\n<p>For this to work, there is 1 last crucial step though.\nYou must add an index to your Address collection with a special flag.</p>\n\n<p>The field you are querying on (<code>user_id</code> in this case)\nmust be indexed with a flag of either <code>{ unique: true }</code> \nor <code>{ sparse: true }</code>. the <code>unique</code> flag will raise an error\nif you have 2 or more nil <code>user_id</code> fields. The <code>sparse</code> option wont.\nUse that if you think you may have nil values.</p>\n\n<p>access your mongo db through the terminal</p>\n\n<ol>\n<li><code>show dbs</code></li>\n<li><code>use your_db_name</code>\ncheck if the addresses collection already has the index you are looking for</li>\n<li><code>db.addresses.getIndexes()</code>\nif it already has an index on user_id, you may want to remove it\n<code>db.addresses.dropIndex( { user_id: 1} )</code>\nand create  it again with the following flag:</li>\n<li><code>db.addresses.createIndex( { user_id: 1}, { sparse: true } )</code></li>\n</ol>\n\n<p><a href=\"https://docs.mongodb.com/manual/reference/method/db.collection.update/\" rel=\"nofollow\">https://docs.mongodb.com/manual/reference/method/db.collection.update/</a></p>\n\n<p>EDIT #1</p>\n\n<p>There seems to have changes in Mongoid 5.. instead of <code>User.collection.update</code> you can use <code>User.collection.update_one</code></p>\n\n<p><a href=\"https://docs.mongodb.com/manual/reference/method/db.collection.updateOne/\" rel=\"nofollow\">https://docs.mongodb.com/manual/reference/method/db.collection.updateOne/</a></p>\n\n<p>The docs show you need a <code>filter</code> rather than a <code>query</code> as first argument but they seem to be the same..</p>\n\n<pre><code>Address.collection.update_one( { user_id: user_id },\n  '$set' =&gt; { \"address\": 'the_address', upsert: true} )\n</code></pre>\n\n<p>PS:\nIf you only write <code>{ \"address\": 'the_address' }</code> as your update clause without including an <code>update operator</code> such as <code>$set</code>, the whole document will get overwritten rather than updating just the <code>address</code> field.</p>\n\n<p>EDIT#2</p>\n\n<p>About why you may want to index with <code>unique</code> or <code>sparse</code></p>\n\n<p>If you look at the <code>upsert</code> section in the link bellow, you will see:</p>\n\n<blockquote>\n  <p>To avoid multiple upserts, ensure that the filter fields are uniquely\n  indexed.</p>\n</blockquote>\n\n<p><a href=\"https://docs.mongodb.com/manual/reference/method/db.collection.updateOne/\" rel=\"nofollow\">https://docs.mongodb.com/manual/reference/method/db.collection.updateOne/</a></p>\n"}], "owner": {"reputation": 39282, "user_id": 336920, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/6e2dbeb23d3fc6552a6e26800ed63289?s=128&d=identicon&r=PG", "display_name": "B Seven", "link": "https://stackoverflow.com/users/336920/b-seven"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 613, "favorite_count": 1, "answer_count": 2, "score": 0, "last_activity_date": 1473285594, "creation_date": 1473278259, "last_edit_date": 1473278719, "question_id": 39378071, "link": "https://stackoverflow.com/questions/39378071/what-is-a-good-way-to-update-or-initialize-with-in-mongoid", "title": "What is a good way to `update_or_initialize_with` in Mongoid?", "body": "<p>Each user has one address.</p>\n\n<pre><code>class User\n  include Mongoid::Document\n\n  has_one :address\nend\n\nclass Address\n  include Mongoid::Document\n\n  belongs_to :user\n\n  field :street_name, type:String\nend\n\nu = User.find(...)\nu.address.update(street_name: 'Main St')\n</code></pre>\n\n<p>If we have a User without an Address, this will fail.</p>\n\n<p>So, is there a good (built-in) way to do <code>u.address.update_or_initialize_with</code>?</p>\n\n<p>Mongoid 5</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 9030, "user_id": 5101476, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JCQrl.jpg?s=128&g=1", "display_name": "ice\u30c4", "link": "https://stackoverflow.com/users/5101476/ice%e3%83%84"}, "edited": false, "score": 0, "creation_date": 1473277219, "post_id": 39377796, "comment_id": 66083618, "body": "<code>@var1</code> is visible in all methods within the same class."}, {"owner": {"reputation": 87, "user_id": 5777126, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/abc39f616d4a5c3ae787aa383b4897ec?s=128&d=identicon&r=PG&f=1", "display_name": "Pending", "link": "https://stackoverflow.com/users/5777126/pending"}, "reply_to_user": {"reputation": 9030, "user_id": 5101476, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JCQrl.jpg?s=128&g=1", "display_name": "ice\u30c4", "link": "https://stackoverflow.com/users/5101476/ice%e3%83%84"}, "edited": false, "score": 0, "creation_date": 1473277273, "post_id": 39377796, "comment_id": 66083643, "body": "Yes but it&#39;s var2 that I need to create"}, {"owner": {"reputation": 48635, "user_id": 6742, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/xPawo.png?s=128&g=1", "display_name": "David Aldridge", "link": "https://stackoverflow.com/users/6742/david-aldridge"}, "edited": false, "score": 0, "creation_date": 1473277746, "post_id": 39377796, "comment_id": 66083847, "body": "If you want a value var2 defined as var1 + var1, it would make more sense to me to define a method called var2 which simply returns var1 + var1"}, {"owner": {"reputation": 87, "user_id": 5777126, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/abc39f616d4a5c3ae787aa383b4897ec?s=128&d=identicon&r=PG&f=1", "display_name": "Pending", "link": "https://stackoverflow.com/users/5777126/pending"}, "edited": false, "score": 0, "creation_date": 1473278654, "post_id": 39377796, "comment_id": 66084249, "body": "Thanks for all the answers everybody.I got it.I was bogged down on gettting a second variable in method_b to display that I didn&#39;t realize I could just call method_a in the display method to get the value I needed."}], "answers": [{"tags": [], "owner": {"reputation": 3914, "user_id": 4057366, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/uZ3e5.jpg?s=128&g=1", "display_name": "Alex Holubenko", "link": "https://stackoverflow.com/users/4057366/alex-holubenko"}, "is_accepted": true, "score": 2, "last_activity_date": 1473277668, "last_edit_date": 1473277668, "creation_date": 1473277273, "answer_id": 39377867, "question_id": 39377796, "link": "https://stackoverflow.com/questions/39377796/how-do-i-get-the-value-from-one-method-into-another-method-in-the-same-class/39377867#39377867", "title": "How do I get the value from one method into another method in the same class?", "body": "<pre><code>def method_a\n  @var2 = @var1 + @var1 # or: @var2 = @var1*2\nend\n\ndef method_b\n  puts \"#{@var1}, #{@var2}\"\nend\n</code></pre>\n\n<p>or someth like it:</p>\n\n<pre><code>class Foo\n  def initialize var1\n    @var1 = var1\n    @var2 = method_a #or change this string to call method_a, so just: method_a and this return @var2 = @var1*2\n  end\n  def method_a\n    @var1*2 #and there you should use variable @var2 = @var1 + @var1 (or @var1*2)\n  end\n  def method_b\n    p \"#{@var1}, #{@var2}\"\n  end\nend\n\n\n#=&gt; boo = Foo.new(1)\n#=&gt; boo.method_b\n#=&gt; 1, 2\n</code></pre>\n"}], "owner": {"reputation": 87, "user_id": 5777126, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/abc39f616d4a5c3ae787aa383b4897ec?s=128&d=identicon&r=PG&f=1", "display_name": "Pending", "link": "https://stackoverflow.com/users/5777126/pending"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1199, "favorite_count": 0, "accepted_answer_id": 39377867, "answer_count": 1, "score": 0, "last_activity_date": 1473277767, "creation_date": 1473277039, "last_edit_date": 1473277767, "question_id": 39377796, "link": "https://stackoverflow.com/questions/39377796/how-do-i-get-the-value-from-one-method-into-another-method-in-the-same-class", "title": "How do I get the value from one method into another method in the same class?", "body": "<p>How can I get the value from one method into another method in the same class so I can use it?</p>\n\n<p>Example:</p>\n\n<pre><code>def initialize var1\n  @var1 = var1\nend\n\ndef method_a var2\n  #Here how can I use var1 to add it to var1 to make a var2\n  var2 = var1 + var1?\nend\n\ndef method_b\n  #display\n  \"#{@var1}, \"#{var2}\"\nend \n</code></pre>\n\n<p>So I'd be making a second variable in <code>method_a</code> that was not initialized and then display it in <code>method_b</code>.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "database", "model-view-controller"], "comments": [{"owner": {"reputation": 48635, "user_id": 6742, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/xPawo.png?s=128&g=1", "display_name": "David Aldridge", "link": "https://stackoverflow.com/users/6742/david-aldridge"}, "edited": false, "score": 0, "creation_date": 1473278941, "post_id": 39377609, "comment_id": 66084398, "body": "I wonder if a Form object is what you could use: <a href=\"http://stratus3d.com/blog/2015/04/04/extensible-rails-4-form-object-design/\" rel=\"nofollow noreferrer\">stratus3d.com/blog/2015/04/04/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 461, "user_id": 2989437, "user_type": "registered", "accept_rate": 82, "profile_image": "https://graph.facebook.com/609288379/picture?type=large", "display_name": "Ian Ellis", "link": "https://stackoverflow.com/users/2989437/ian-ellis"}, "edited": false, "score": 0, "creation_date": 1473280225, "post_id": 39378183, "comment_id": 66084965, "body": "This looks like what I should be doing... when does after_save get called? Subject can have Enrolled as a blank value for an amount of time, and then have it changed to 1 at any time in the future. I found an after_update function, perhaps that what I should use?"}, {"owner": {"reputation": 1513, "user_id": 1334750, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/0vTHg.png?s=128&g=1", "display_name": "Pawe\u0142 Duda", "link": "https://stackoverflow.com/users/1334750/pawe%c5%82-duda"}, "reply_to_user": {"reputation": 461, "user_id": 2989437, "user_type": "registered", "accept_rate": 82, "profile_image": "https://graph.facebook.com/609288379/picture?type=large", "display_name": "Ian Ellis", "link": "https://stackoverflow.com/users/2989437/ian-ellis"}, "edited": false, "score": 0, "creation_date": 1473281068, "post_id": 39378183, "comment_id": 66085310, "body": "Actually, I think that in the after_commit callback will be more suitable for your use case: <a href=\"http://apidock.com/rails/ActiveRecord/Transactions/ClassMethods/after_commit\" rel=\"nofollow noreferrer\">apidock.com/rails/ActiveRecord/Transactions/ClassMethods/&hellip;</a> I have updated the code with how to make sure it gets executed both on create and update."}, {"owner": {"reputation": 461, "user_id": 2989437, "user_type": "registered", "accept_rate": 82, "profile_image": "https://graph.facebook.com/609288379/picture?type=large", "display_name": "Ian Ellis", "link": "https://stackoverflow.com/users/2989437/ian-ellis"}, "edited": false, "score": 0, "creation_date": 1473281264, "post_id": 39378183, "comment_id": 66085411, "body": "I see. I&#39;m marking your answer as the correct one, I think it&#39;s got me on the right path. One more question though, should this go in the model or controller? I thought the model was for database things such as this, but :create and :update are controller features. Thank you for the help!"}], "tags": [], "owner": {"reputation": 1513, "user_id": 1334750, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/0vTHg.png?s=128&g=1", "display_name": "Pawe\u0142 Duda", "link": "https://stackoverflow.com/users/1334750/pawe%c5%82-duda"}, "is_accepted": true, "score": 1, "last_activity_date": 1473281798, "last_edit_date": 1473281798, "creation_date": 1473278758, "answer_id": 39378183, "question_id": 39377609, "link": "https://stackoverflow.com/questions/39377609/ruby-on-rails-creating-a-link-based-on-new-database-entry/39378183#39378183", "title": "Ruby on Rails: Creating a link based on new database entry", "body": "<p>Not quite sure how your domain and code looks like, but to answer this question: 'How do I create records automatically, based on a value in a table?', it seems that you could use ActiveRecord callbacks, like this:</p>\n\n<pre><code>class Subject &lt; ActiveRecord::Base\n  after_commit :create_baseline_if_enrolled, on: [:create, :update]\n\n  private\n\n  def create_baseline_if_enrolled\n    return unless enrolled?\n\n    # enrolled? == true, you may create these models here\n  end\nend\n</code></pre>\n\n<p>To answer your question:\nIt depends :) This is just one possible solution. Another one would be to put such a custom logic in your SubjectsController and call it directly from the #create, #update methods. Both approaches have pros and cons. For example, abusing callbacks (anywhere) makes code less readable and harder to debug. On the other hand, putting such logic in controllers puts a burden on you that you have to remember about calling it if you happen to be editing subjects in other places (but is more explicit). Whichever way you choose, remember not to make your classes too fat, for example try to use service object pattern to separate such custom logic as soon as you feel like it is getting out of hand. :) And don't forget about tests - when things go wrong, tests make refactoring easier.</p>\n"}], "owner": {"reputation": 461, "user_id": 2989437, "user_type": "registered", "accept_rate": 82, "profile_image": "https://graph.facebook.com/609288379/picture?type=large", "display_name": "Ian Ellis", "link": "https://stackoverflow.com/users/2989437/ian-ellis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 110, "favorite_count": 0, "accepted_answer_id": 39378183, "answer_count": 1, "score": 1, "last_activity_date": 1473281798, "creation_date": 1473276109, "question_id": 39377609, "link": "https://stackoverflow.com/questions/39377609/ruby-on-rails-creating-a-link-based-on-new-database-entry", "title": "Ruby on Rails: Creating a link based on new database entry", "body": "<p>I'm in the process of updating a website I made almost 2 years ago. It was my first real website and I made some mistakes (some more serious that others).</p>\n\n<p>What apparently is one of my biggest is making database calls from the view.</p>\n\n<p>I'm <em>pretty damn sure</em> there is a better way to do this:</p>\n\n<p><strong>Use Case:</strong> </p>\n\n<ol>\n<li>Someone fills out a form for a new subject, populating the Subject table, and they have been marked \"enrolled\", Subject.enrolled = 1</li>\n<li>Based on that, I now need to create a record in 5 other tables (such as Baseline)</li>\n<li><p>Downhill from here, here is my method</p>\n\n<ul>\n<li><p>Determine if the record exist based on subject_id from Subject (sub)</p>\n\n<pre><code>&lt;$ if Baseline.where(subject_id: sub.subject_id).first != nil $&gt;\n</code></pre></li>\n<li><p>If it does not exist, create the record, (otherwise display the link)</p>\n\n<pre><code>&lt;%= Baseline.create(subject_id: sub.subject_id) %&gt;\n</code></pre></li>\n</ul></li>\n<li><p>This all happens in the view, and creates a front-end table with links to each record in the process. So I'm creating records based on for-loop logic...</p></li>\n</ol>\n\n<p><strong>Question:</strong>\nSo I'm looking for direction. I don't want to guess how to do this - I'm pretty sure the model/controller should do this - I want to learn how to do it correctly. How do I create records automatically, based on a value in a table?</p>\n\n<p>Thank you for your time.</p>\n"}, {"tags": ["ruby", "unit-testing", "mocking", "rr"], "answers": [{"tags": [], "owner": {"reputation": 39282, "user_id": 336920, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/6e2dbeb23d3fc6552a6e26800ed63289?s=128&d=identicon&r=PG", "display_name": "B Seven", "link": "https://stackoverflow.com/users/336920/b-seven"}, "is_accepted": false, "score": 1, "last_activity_date": 1473294329, "creation_date": 1473294329, "answer_id": 39380847, "question_id": 39376872, "link": "https://stackoverflow.com/questions/39376872/ruby-rr-how-to-stub-mock-built-in-variables-like/39380847#39380847", "title": "ruby rr: How to stub/mock built-in variables like $?", "body": "<p>I'm not sure which mocking framework you are using, but in RSpec:</p>\n\n<pre><code>allow_any_instance_of(Process::Status).to receive(:exitstatus).and_return(0)\n</code></pre>\n"}], "owner": {"reputation": 12342, "user_id": 496289, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/MBIsC.jpg?s=128&g=1", "display_name": "Kashyap", "link": "https://stackoverflow.com/users/496289/kashyap"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 322, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1473295172, "creation_date": 1473272995, "last_edit_date": 1473295172, "question_id": 39376872, "link": "https://stackoverflow.com/questions/39376872/ruby-rr-how-to-stub-mock-built-in-variables-like", "title": "ruby rr: How to stub/mock built-in variables like $?", "body": "<p>While writing a unit test for following:</p>\n\n<pre><code>def foo()\n  popen_response = \"\"\n  IO.popen(@packaging_cmd, :err=&gt;[:child, :out]) {|io| popen_response = io.read }\n  rc = $?\n  @log.debug{\"Response from IO.popen() : #{popen_response}. rc: '#{rc}'\"}\n  if rc.exitstatus != 0\n    @log.error{\"Packaging failed. rc: '#{rc}'\"}\n    raise PackagingError.new(\"Packaging failed. rc: '#{rc}'\")\n  end\nend\n</code></pre>\n\n<p>I'm stuck because I don't know how to mock/stub what <code>$?</code> evaluates to. I can hack around by creating a function that returns <code>$?</code> and mock that function or tinker with teh command passed to <code>IO.popen()</code>, but I wonder if there is any official way in RR that I can use.</p>\n\n<p>I'm using <code>rr</code> with stock <code>Test::Unit::TestCase</code></p>\n\n<pre><code>require 'test/unit'\nrequire 'rr'\n</code></pre>\n"}, {"tags": ["css", "ruby-on-rails", "ruby", "sass"], "answers": [{"comments": [{"owner": {"reputation": 11562, "user_id": 1016536, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/sk0Hl.png?s=128&g=1", "display_name": "TheLegend", "link": "https://stackoverflow.com/users/1016536/thelegend"}, "edited": false, "score": 1, "creation_date": 1473344846, "post_id": 39382045, "comment_id": 66113246, "body": "Hey bud, Thanks for coming back to me; since my <code>style.css</code> imports all the helpers though with <code>@import &#39;shared&#47;variables&#39;;</code> being the first one. Dose that not load the <code>variables</code> into the style sheet and thus make it avalible to all the other files loaded in as well?"}], "tags": [], "owner": {"reputation": 19261, "user_id": 4758119, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/F4dJY.jpg?s=128&g=1", "display_name": "Deepak Mahakale", "link": "https://stackoverflow.com/users/4758119/deepak-mahakale"}, "is_accepted": false, "score": 0, "last_activity_date": 1473304607, "creation_date": 1473304607, "answer_id": 39382045, "question_id": 39376806, "link": "https://stackoverflow.com/questions/39376806/rails-5-sasssyntaxerror-cannot-precompile-assets/39382045#39382045", "title": "Rails 5, Sass::SyntaxError cannot precompile assets", "body": "<p>You are using <code>$color-dark</code> variable in <code>app/assets/stylesheets/helpers/_content.scss:3</code> which is not defined </p>\n\n<p>You need to import it in <code>_content.scss</code> </p>\n\n<pre><code>@import 'shared/variables'\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 26, "user_id": 2660606, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/761a2bea8551e1acb7f4c86f1da1b88d?s=128&d=identicon&r=PG", "display_name": "Rohit Tiwari", "link": "https://stackoverflow.com/users/2660606/rohit-tiwari"}, "is_accepted": false, "score": 0, "last_activity_date": 1498927479, "creation_date": 1498927479, "answer_id": 44863279, "question_id": 39376806, "link": "https://stackoverflow.com/questions/39376806/rails-5-sasssyntaxerror-cannot-precompile-assets/44863279#44863279", "title": "Rails 5, Sass::SyntaxError cannot precompile assets", "body": "<p>You have to remove </p>\n\n<pre><code>= require_tree .\n</code></pre>\n\n<p>from</p>\n\n<pre><code>/*\n*\n*= require_tree .\n*= require font-awesome\n*= require style\n*= require_self\n*/\n</code></pre>\n\n<p>present in  app/assets/stylesheets/application.scss because the asset pipeline goes on to compile each file present in stylesheet directory, resulting in need for having the <code>@import</code> directive for including variables partial which is default behaviour of sass. But you can prevent that if you do the said above.</p>\n"}], "owner": {"reputation": 11562, "user_id": 1016536, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/sk0Hl.png?s=128&g=1", "display_name": "TheLegend", "link": "https://stackoverflow.com/users/1016536/thelegend"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 616, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1498927479, "creation_date": 1473272665, "last_edit_date": 1473343048, "question_id": 39376806, "link": "https://stackoverflow.com/questions/39376806/rails-5-sasssyntaxerror-cannot-precompile-assets", "title": "Rails 5, Sass::SyntaxError cannot precompile assets", "body": "<p>I have started a new project (<code>Rails 5.0.0.1</code> &amp;&amp; <code>ruby 2.3.1p112</code> ) and can't seem to get the assets to precompile. My current structure looks like this. </p>\n\n<p>app/assets/config/manifest.js</p>\n\n<pre><code>//= link_tree ../images\n//= link_directory ../javascripts .js\n//= link_directory ../stylesheets .css\n</code></pre>\n\n<p>app/assets/stylesheets/application.scss</p>\n\n<pre><code>*\n*= require_tree .\n*= require font-awesome\n*= require style\n*= require_self\n*/\n</code></pre>\n\n<p>app/assets/stylesheets/style.scss</p>\n\n<pre><code>@import \"bootstrap-sprockets\";\n@import \"bootstrap\";\n\n// shared styling\n@import 'shared/variables';\n@import 'shared/content';\n...\n...\n</code></pre>\n\n<p>app/views/layout/application.html.haml</p>\n\n<pre><code>...\n= stylesheet_link_tag 'application', media: 'all', 'data-turbolinks-track': 'reload'\n...\n</code></pre>\n\n<p>inside my app/assets/stylesheets/helpers/_varibles.scss file I have set some varibles</p>\n\n<pre><code>$font-family-standard: 'Arial', sans-serif;\n$font-family-default: 'Open Sans', 'Arial', sans-serif;\n\n$color-primary: #ff7e5b;\n$color-gray: #898989;\n$color-dark: #292c33;\n$color-darker: #3f4248;\n</code></pre>\n\n<p>But when I run rails server / try running <code>bundle exec rake assets:precompile</code> I get this: </p>\n\n<pre><code>be rake assets:precompile\nrake aborted!\nSass::SyntaxError: Undefined variable: \"$color-dark\".\n/Users/Nexus/Personal/Projects/Rubyfuza/rubyfuza/app/assets/stylesheets/helpers/_content.scss:3\n/Users/Nexus/.rbenv/versions/2.3.1/bin/bundle:23:in `load'\n/Users/Nexus/.rbenv/versions/2.3.1/bin/bundle:23:in `&lt;main&gt;'\nTasks: TOP =&gt; assets:precompile\n(See full trace by running task with --trace)\n</code></pre>\n\n<p>I have no idea what is going on here. Any help will be much appreciated. </p>\n"}, {"tags": ["ruby", "hash"], "comments": [{"owner": {"reputation": 1720, "user_id": 6471733, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/be4e96b247d3862d042b84490a62d42e?s=128&d=identicon&r=PG", "display_name": "Muntasir Alam", "link": "https://stackoverflow.com/users/6471733/muntasir-alam"}, "edited": false, "score": 0, "creation_date": 1473273971, "post_id": 39376744, "comment_id": 66082074, "body": "The answers below are good. If you want to count all vowels by the way you can try something like <code>str.scan(&#47;[aeoui]&#47;).count</code>"}, {"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 0, "creation_date": 1473289200, "post_id": 39376744, "comment_id": 66088267, "body": "So &quot;everywhere&quot; is three places and they&#39;re all in Stack Overflow?"}, {"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 0, "creation_date": 1473289672, "post_id": 39376744, "comment_id": 66088396, "body": "<code>str.scan(&#47;[aeoui]&#47;).count # =&gt; 11</code>. I don&#39;t think that&#39;s what the OP wants."}], "answers": [{"comments": [{"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 1, "creation_date": 1473276664, "post_id": 39376944, "comment_id": 66083354, "body": "This is somewhat inefficient as <code>count</code> traverses the string once for each vowel, rather than just once."}, {"owner": {"reputation": 47232, "user_id": 1772830, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/Qtoqg.jpg?s=128&g=1", "display_name": "Andrey Deineko", "link": "https://stackoverflow.com/users/1772830/andrey-deineko"}, "reply_to_user": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1473325628, "post_id": 39376944, "comment_id": 66100308, "body": "@CarySwoveland from the <a href=\"http://stackoverflow.com/a/39380281/1772830\">the Tin Man&#39;s answer</a> we can see, that my answer holds the fastest along with seph&#39;s one :) But indeed you&#39;re right about traversing each time"}], "tags": [], "owner": {"reputation": 47232, "user_id": 1772830, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/Qtoqg.jpg?s=128&g=1", "display_name": "Andrey Deineko", "link": "https://stackoverflow.com/users/1772830/andrey-deineko"}, "is_accepted": false, "score": 3, "last_activity_date": 1473273313, "creation_date": 1473273313, "answer_id": 39376944, "question_id": 39376744, "link": "https://stackoverflow.com/questions/39376744/how-to-make-a-hash-of-all-vowels-in-a-string/39376944#39376944", "title": "How to make a hash of all vowels in a string?", "body": "<p>Consider such solution:</p>\n\n<pre><code>str    = 'make stackoverflow great again'\nvowels = %w(a e o u i)\nvowels.each_with_object({}) {|vowel, hash| hash[vowel] = str.count(vowel) }\n#=&gt; {\"a\"=&gt;5, \"e\"=&gt;3, \"o\"=&gt;2, \"u\"=&gt;0, \"i\"=&gt;1}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 47232, "user_id": 1772830, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/Qtoqg.jpg?s=128&g=1", "display_name": "Andrey Deineko", "link": "https://stackoverflow.com/users/1772830/andrey-deineko"}, "edited": false, "score": 0, "creation_date": 1473273615, "post_id": 39377015, "comment_id": 66081905, "body": "this won&#39;t return the desired result ;) you&#39;ll need to add <code>inject({}, :merge)</code> to be compliant with what OP wants"}, {"owner": {"reputation": 47232, "user_id": 1772830, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/Qtoqg.jpg?s=128&g=1", "display_name": "Andrey Deineko", "link": "https://stackoverflow.com/users/1772830/andrey-deineko"}, "edited": false, "score": 0, "creation_date": 1473273848, "post_id": 39377015, "comment_id": 66082014, "body": "with <code>inject</code>/<code>reduce</code> you do not need to do <code>&amp;:merge</code>, it can be simply <code>:merge</code> :)"}, {"owner": {"reputation": 5730, "user_id": 667987, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8c00249587cb5aa0ceb5765dc811faa7?s=128&d=identicon&r=PG", "display_name": "seph", "link": "https://stackoverflow.com/users/667987/seph"}, "edited": false, "score": 0, "creation_date": 1473274098, "post_id": 39377015, "comment_id": 66082129, "body": "You could do it like this: <code>%w(a e o u i).map { |v| [v, str.count(v)] }.to_h</code>"}, {"owner": {"reputation": 6119, "user_id": 165753, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/w6iBN.jpg?s=128&g=1", "display_name": "dimid", "link": "https://stackoverflow.com/users/165753/dimid"}, "reply_to_user": {"reputation": 5730, "user_id": 667987, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8c00249587cb5aa0ceb5765dc811faa7?s=128&d=identicon&r=PG", "display_name": "seph", "link": "https://stackoverflow.com/users/667987/seph"}, "edited": false, "score": 0, "creation_date": 1473274381, "post_id": 39377015, "comment_id": 66082250, "body": "@seph I actually think your version is better, you should post it as an answer"}, {"owner": {"reputation": 5730, "user_id": 667987, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8c00249587cb5aa0ceb5765dc811faa7?s=128&d=identicon&r=PG", "display_name": "seph", "link": "https://stackoverflow.com/users/667987/seph"}, "edited": false, "score": 0, "creation_date": 1473274519, "post_id": 39377015, "comment_id": 66082310, "body": "Will do. Thank you."}, {"owner": {"reputation": 47232, "user_id": 1772830, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/Qtoqg.jpg?s=128&g=1", "display_name": "Andrey Deineko", "link": "https://stackoverflow.com/users/1772830/andrey-deineko"}, "reply_to_user": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1473275594, "post_id": 39377015, "comment_id": 66082825, "body": "@CarySwoveland yep, that is what I said when it was <code>&amp;:merge</code> :) Check out revisions"}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1473276102, "post_id": 39377015, "comment_id": 66083079, "body": "@Andrew, sorry, &#39;twas a dyslexia moment."}], "tags": [], "owner": {"reputation": 6119, "user_id": 165753, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/w6iBN.jpg?s=128&g=1", "display_name": "dimid", "link": "https://stackoverflow.com/users/165753/dimid"}, "is_accepted": false, "score": 3, "last_activity_date": 1473274010, "last_edit_date": 1473274010, "creation_date": 1473273557, "answer_id": 39377015, "question_id": 39376744, "link": "https://stackoverflow.com/questions/39376744/how-to-make-a-hash-of-all-vowels-in-a-string/39377015#39377015", "title": "How to make a hash of all vowels in a string?", "body": "<pre><code>%w(a e o u i).map{ |v| {v =&gt; str.count(v)} }.reduce(:merge)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 5730, "user_id": 667987, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8c00249587cb5aa0ceb5765dc811faa7?s=128&d=identicon&r=PG", "display_name": "seph", "link": "https://stackoverflow.com/users/667987/seph"}, "is_accepted": false, "score": 2, "last_activity_date": 1473274538, "creation_date": 1473274538, "answer_id": 39377264, "question_id": 39376744, "link": "https://stackoverflow.com/questions/39376744/how-to-make-a-hash-of-all-vowels-in-a-string/39377264#39377264", "title": "How to make a hash of all vowels in a string?", "body": "<pre><code>str = \"make stackoverflow great again\"\nvowels = %w{a e i o u}\n\nvowels.map { |v| [v, str.count(v)] }.to_h\n#&gt; {\"a\"=&gt;5, \"e\"=&gt;3, \"i\"=&gt;1, \"o\"=&gt;2, \"u\"=&gt;0}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "is_accepted": false, "score": 2, "last_activity_date": 1473278000, "last_edit_date": 1473278000, "creation_date": 1473276002, "answer_id": 39377582, "question_id": 39376744, "link": "https://stackoverflow.com/questions/39376744/how-to-make-a-hash-of-all-vowels-in-a-string/39377582#39377582", "title": "How to make a hash of all vowels in a string?", "body": "<p>I would use a <em>counting hash</em> so that the characters of the string are only traversed once. See <a href=\"http://ruby-doc.org/core-2.3.0/Hash.html#method-c-new\" rel=\"nofollow\">Hash::new</a>. </p>\n\n<pre><code>VOWELS = \"aeiou\"\n\nh = str.each_char.with_object(Hash.new(0)) { |c,h| h[c] += 1 if VOWELS.include?(c) }\n  #=&gt; {\"a\"=&gt;5, \"e\"=&gt;3, \"o\"=&gt;2, \"i\"=&gt;1}\n</code></pre>\n\n<p>Note that <code>h[\"u\"] #=&gt; 0</code>.</p>\n\n<p>If the string is large, you should be able to speed this up by putting the vowels in a set (and making no other changes).</p>\n\n<pre><code>require 'set'\n\nVOWELS = \"aeiou\".each_char.to_set\n  #=&gt; #&lt;Set: {\"a\", \"e\", \"i\", \"o\", \"u\"}&gt;\n</code></pre>\n\n<p>Better would be to remove the consonents from the string at the onset, as @Anthony has done.</p>\n"}, {"comments": [{"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 2, "creation_date": 1473277729, "post_id": 39377720, "comment_id": 66083841, "body": "Removing the consonents at the beginning is a good idea. Two small suggestions: 1) use <code>each_char</code> rather than <code>chars</code>, to avoid the creation of an intermediate array; and 2) use <code>each_with_object</code> rather than <code>inject</code> to get rid of that pesky <code>; hash</code>."}, {"owner": {"reputation": 4275, "user_id": 5739288, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/mRf6m.jpg?s=128&g=1", "display_name": "Iggy", "link": "https://stackoverflow.com/users/5739288/iggy"}, "edited": false, "score": 0, "creation_date": 1473287504, "post_id": 39377720, "comment_id": 66087781, "body": "@Anthony if it is not too much, would you mind briefly explaining why it is an O(n) solution? I am also learning about big oh and would like to know the differences in actual code. Thanks!"}, {"owner": {"reputation": 4275, "user_id": 5739288, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/mRf6m.jpg?s=128&g=1", "display_name": "Iggy", "link": "https://stackoverflow.com/users/5739288/iggy"}, "edited": false, "score": 0, "creation_date": 1473355577, "post_id": 39377720, "comment_id": 66119752, "body": "Thanks!! I saw that it has been edited. Much appreciate it! Read through it and it makes a lot of sense, too!"}, {"owner": {"reputation": 73209, "user_id": 290394, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/d7908f05c89e965f6bc5308ad6f41256?s=128&d=identicon&r=PG", "display_name": "steenslag", "link": "https://stackoverflow.com/users/290394/steenslag"}, "edited": false, "score": 0, "creation_date": 1473373614, "post_id": 39377720, "comment_id": 66128262, "body": "I prefer  <code>str.delete(&quot;^aeiou&quot;)</code> over  <code>str.gsub(&#47;[^aeiou]&#47;, &quot;&quot;)</code> ."}], "tags": [], "owner": {"reputation": 14010, "user_id": 3109182, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/a4b305f0077055b4fdcf715067775d5a?s=128&d=identicon&r=PG", "display_name": "Anthony", "link": "https://stackoverflow.com/users/3109182/anthony"}, "is_accepted": true, "score": 3, "last_activity_date": 1473296815, "last_edit_date": 1495540979, "creation_date": 1473276659, "answer_id": 39377720, "question_id": 39376744, "link": "https://stackoverflow.com/questions/39376744/how-to-make-a-hash-of-all-vowels-in-a-string/39377720#39377720", "title": "How to make a hash of all vowels in a string?", "body": "<p>I'm just going to include an O(n) solution since the prior are all O(n^2).</p>\n\n<pre><code>str.gsub(/[^aeiou]/, \"\").each_char.each_with_object(Hash.new(0)) { |vowel, hash| hash[vowel] += 1 }\n=&gt; {\"a\"=&gt;5, \"e\"=&gt;3, \"o\"=&gt;2, \"i\"=&gt;1}\n</code></pre>\n\n<p>Determining the Big O notation of this isn't perfect, so bear with me.</p>\n\n<p>Step 1 - O(n)</p>\n\n<pre><code>str.gsub(/[^aeiou]/, \"\")\n=&gt; \"aeaoeoeaaai\"\n</code></pre>\n\n<p>This step loops through the string characters and removes consonants.  I did my best to try and find the actual runtime of gsub but without doing my own benchmarks I can't <em>really</em> be sure.  I found <a href=\"https://stackoverflow.com/a/20173648/3109182\">this</a> when originally writing my answer but it is also not ironclad.  <code>gsub</code> should find all indexes that match the expression and return those values as a new string.</p>\n\n<p>Step 2 - O(n)</p>\n\n<pre><code>each_char\n</code></pre>\n\n<p>Simply takes the string returned and returns an Enumerator.  Depending on the language, turning a string into an array of strings/chars has at worst a runtime of the length of the string (hence O(n)).  With ruby, returning an Enumerator is actually lazily evaluated so you could argue here we're in O(1).</p>\n\n<p>Step 3 - O(n)</p>\n\n<pre><code>each_with_object(Hash.new(0)) { |vowel, hash| hash[vowel] += 1 }\n</code></pre>\n\n<p>There are multiple sub-steps here:</p>\n\n<p>Step 3a - Instantiate a new Hash object O(1) who's default value is 0.</p>\n\n<p>Step 3b - Assign/find the key (vowel) in the hash - average O(1), worst case O(n)</p>\n\n<p>Step 3c - Increment that value by 1 - O(1) </p>\n\n<p>Step 3d - Loop through each letter - O(n)</p>\n\n<p>So that means from our 3 steps we have O(n) + O(n) + O(n) which is really O(3n) but Big O states we can drop constants like 3 in this instance, so it just becomes O(n).</p>\n\n<p>I myself am also still learning Big O so this explanation could likely use some community input. </p>\n"}, {"comments": [{"owner": {"reputation": 14010, "user_id": 3109182, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/a4b305f0077055b4fdcf715067775d5a?s=128&d=identicon&r=PG", "display_name": "Anthony", "link": "https://stackoverflow.com/users/3109182/anthony"}, "edited": false, "score": 0, "creation_date": 1473297118, "post_id": 39380281, "comment_id": 66089969, "body": "does fruity vary the size of <code>str</code> at all?  I&#39;d be curious how the length of <code>str</code> impacts performance of the below solutions.  Thanks for putting that all together!"}, {"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "reply_to_user": {"reputation": 14010, "user_id": 3109182, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/a4b305f0077055b4fdcf715067775d5a?s=128&d=identicon&r=PG", "display_name": "Anthony", "link": "https://stackoverflow.com/users/3109182/anthony"}, "edited": false, "score": 1, "creation_date": 1473368965, "post_id": 39380281, "comment_id": 66126508, "body": "No, Fruity makes no changes. Why would it do that? The length of the string makes a difference because there are more potential character candidates to consider as the string grows. The algorithms that reduce the string before processing, or that efficiently use the built-in C-based methods, will be fastest at that point."}], "tags": [], "owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "is_accepted": false, "score": 2, "last_activity_date": 1473369279, "last_edit_date": 1473369279, "creation_date": 1473289578, "answer_id": 39380281, "question_id": 39376744, "link": "https://stackoverflow.com/questions/39376744/how-to-make-a-hash-of-all-vowels-in-a-string/39380281#39380281", "title": "How to make a hash of all vowels in a string?", "body": "<p>I'd do it something like this:</p>\n\n<pre><code>str = \"make stackoverflow great again\"\n\nstr.scan(/[aeiou]/).each_with_object(Hash.new{ |h, k| h[k] = 0}) { |v, h| h[v] += 1 }\n# =&gt; {\"a\"=&gt;5, \"e\"=&gt;3, \"o\"=&gt;2, \"i\"=&gt;1}\n</code></pre>\n\n<p>But, just for fun, here's a benchmark:</p>\n\n<pre><code>require 'fruity'\nrequire 'set'\n\nstr = \"make stackoverflow great again\"\nvowels = 'aeiou'\nvowels_set = vowels.each_char.to_set\nvowels_ary = vowels.chars\nvowels_regex = /[aeiou]/\nvowels_not_regex = /[^aeiou]/\n\ncompare do\n  ttm      { str.scan(vowels_regex).each_with_object(Hash.new{ |h, k| h[k] = 0}) { |v, h| h[v] += 1 } }\n  Andrey_Deineko { vowels_ary.each_with_object({}) {|vowel, hash| hash[vowel] = str.count(vowel) } }\n  Anthony  { str.gsub(vowels_not_regex, \"\").each_char.each_with_object(Hash.new(0)) { |vowel, hash| hash[vowel] += 1 } }\n  dimid    { vowels_ary.map{ |v| {v =&gt; str.count(v)} }.reduce(:merge) }\n  cary_str { str.each_char.with_object(Hash.new(0)) { |c,h| h[c] += 1 if vowels.include?(c) } }\n  cary_set { str.each_char.with_object(Hash.new(0)) { |c,h| h[c] += 1 if vowels_set.include?(c) } }\n  seph     { vowels_ary.map { |v| [v, str.count(v)] }.to_h }\nend\n\n# &gt;&gt; Running each test 2048 times. Test will take about 3 seconds.\n# &gt;&gt; Andrey_Deineko is similar to seph\n# &gt;&gt; seph is faster than cary_str by 4x \u00b1 1.0 (results differ: {\"a\"=&gt;5, \"e\"=&gt;3, \"i\"=&gt;1, \"o\"=&gt;2, \"u\"=&gt;0} vs {\"a\"=&gt;5, \"e\"=&gt;3, \"o\"=&gt;2, \"i\"=&gt;1})\n# &gt;&gt; cary_str is similar to dimid (results differ: {\"a\"=&gt;5, \"e\"=&gt;3, \"o\"=&gt;2, \"i\"=&gt;1} vs {\"a\"=&gt;5, \"e\"=&gt;3, \"i\"=&gt;1, \"o\"=&gt;2, \"u\"=&gt;0})\n# &gt;&gt; dimid is similar to ttm (results differ: {\"a\"=&gt;5, \"e\"=&gt;3, \"i\"=&gt;1, \"o\"=&gt;2, \"u\"=&gt;0} vs {\"a\"=&gt;5, \"e\"=&gt;3, \"o\"=&gt;2, \"i\"=&gt;1})\n# &gt;&gt; ttm is similar to cary_set\n# &gt;&gt; cary_set is similar to Anthony\n</code></pre>\n\n<hr>\n\n<blockquote>\n  <p>I'd be curious how the length of str impacts performance of the below solutions.</p>\n</blockquote>\n\n<p>First, ahem, the code is right there. Copy it, paste it into your editor, change the string and experiment, right?</p>\n\n<p>By changing the size of the initial <code>str</code> to 100x longer:</p>\n\n<pre><code>str = \"make stackoverflow great again\" * 100\n</code></pre>\n\n<p>the results change to:</p>\n\n<pre><code># &gt;&gt; Running each test 512 times. Test will take about 29 seconds.\n# &gt;&gt; Andrey_Deineko is similar to seph\n# &gt;&gt; seph is faster than dimid by 2x \u00b1 0.1\n# &gt;&gt; dimid is faster than ttm by 55x \u00b1 10.0 (results differ: {\"a\"=&gt;500, \"e\"=&gt;300, \"i\"=&gt;100, \"o\"=&gt;200, \"u\"=&gt;0} vs {\"a\"=&gt;500, \"e\"=&gt;300, \"o\"=&gt;200, \"i\"=&gt;100})\n# &gt;&gt; ttm is faster than Anthony by 30.000000000000004% \u00b1 10.0%\n# &gt;&gt; Anthony is faster than cary_str by 10.000000000000009% \u00b1 10.0%\n# &gt;&gt; cary_str is similar to cary_set\n</code></pre>\n"}], "owner": {"reputation": 4275, "user_id": 5739288, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/mRf6m.jpg?s=128&g=1", "display_name": "Iggy", "link": "https://stackoverflow.com/users/5739288/iggy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 393, "favorite_count": 0, "accepted_answer_id": 39377720, "answer_count": 6, "score": 3, "last_activity_date": 1473369279, "creation_date": 1473272420, "last_edit_date": 1495535350, "question_id": 39376744, "link": "https://stackoverflow.com/questions/39376744/how-to-make-a-hash-of-all-vowels-in-a-string", "title": "How to make a hash of all vowels in a string?", "body": "<p>I have googled it everywhere (<a href=\"https://stackoverflow.com/questions/26769800/trying-to-find-vowels-of-a-string-using-ruby-while-loops\">here</a>, <a href=\"https://stackoverflow.com/questions/24835078/searching-for-vowels-in-ruby\">here</a>, <a href=\"https://stackoverflow.com/questions/24298481/regular-expression-in-ruby-to-get-all-vowels-in-string\">here</a>) but strangely I could not find it. </p>\n\n<p>I have a string, <code>str = \"make stackoverflow great again\"</code>. How can I make a hash of all the vowel occurrences in that string? <code>{\"a\"=&gt;5, \"e\"=&gt;3, \"i\"=&gt;1, \"o\"=&gt;2, \"u\"=&gt;0}</code></p>\n\n<p>Right now I have the most obtuse, least-ruby-like method:</p>\n\n<pre><code>def count_vowels(string)\n  list = {}\n  a = string.count(\"a\")\n  e = string.count(\"e\")\n  i = string.count(\"i\")\n  o = string.count(\"o\")\n  u = string.count(\"u\")\n\n  list[\"a\"] = a\n  list[\"e\"] = e\n  list[\"i\"] = i\n  list[\"o\"] = o\n  list[\"u\"] = u\n\n  list\nend\n</code></pre>\n\n<p>What is the most ruby-esque way to make a hash of all the vowels in any given string?</p>\n"}, {"tags": ["ruby", "security", "password-generator"], "comments": [{"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 0, "creation_date": 1473272482, "post_id": 39376428, "comment_id": 66081411, "body": "What has your research told you? Currently your question is asking us to recommend solutions or pages. Please read &quot;<a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a>&quot; including the linked pages."}], "answers": [{"comments": [{"owner": {"reputation": 1481, "user_id": 1103530, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/5880ea2fb9d6f65e608a59b9cb7615a4?s=128&d=identicon&r=PG", "display_name": "Jimbali", "link": "https://stackoverflow.com/users/1103530/jimbali"}, "edited": false, "score": 0, "creation_date": 1605708283, "post_id": 39376753, "comment_id": 114733790, "body": "This will generate strings with a special character only 46.875% of the time. There is a 2/64 chance that the character will be a <code>+</code> or a <code>&#47;</code>, which multiplied by 15 is 0.46875."}], "tags": [], "owner": {"reputation": 3467, "user_id": 906511, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/61286bced0ae2da15261439d1bb62297?s=128&d=identicon&r=PG", "display_name": "lcguida", "link": "https://stackoverflow.com/users/906511/lcguida"}, "is_accepted": true, "score": 10, "last_activity_date": 1473272476, "creation_date": 1473272476, "answer_id": 39376753, "question_id": 39376428, "link": "https://stackoverflow.com/questions/39376428/secure-password-generation-with-random-chars/39376753#39376753", "title": "Secure Password Generation With Random Chars", "body": "<p>You can use SecureRandom (<a href=\"http://ruby-doc.org/stdlib-2.3.0/libdoc/securerandom/rdoc/SecureRandom.html\" rel=\"noreferrer\">docs</a>):</p>\n\n<pre><code>require 'securerandom'\n\npassword = SecureRandom.base64(15)\n# =&gt; \"vkVuWvPUWSMcZf9nn/dO\"\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 12542, "user_id": 156746, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/8TsPx.jpg?s=128&g=1", "display_name": "DiegoSalazar", "link": "https://stackoverflow.com/users/156746/diegosalazar"}, "is_accepted": false, "score": 13, "last_activity_date": 1473279701, "last_edit_date": 1473279701, "creation_date": 1473272527, "answer_id": 39376775, "question_id": 39376428, "link": "https://stackoverflow.com/questions/39376428/secure-password-generation-with-random-chars/39376775#39376775", "title": "Secure Password Generation With Random Chars", "body": "<p>Ruby comes with just such a module <code>SecureRandom</code>. You can generate random strings:</p>\n\n<pre><code>require \"securerandom\"\n\nSecureRandom.hex 1 # =&gt; \"e1\"\nSecureRandom.hex 2 # =&gt; \"dcdd\"\nSecureRandom.hex 3 # =&gt; \"93edc6\"\nSecureRandom.hex 5 # =&gt; \"01bf5657ce\"\nSecureRandom.hex 8 # =&gt; \"3cc72f70146ea286\"\n\nSecureRandom.base64 2  # =&gt; \"d5M=\"\nSecureRandom.base64 3  # =&gt; \"EJ1K\"\nSecureRandom.base64 5  # =&gt; \"pEeGO68=\"\nSecureRandom.base64 8  # =&gt; \"muRa+tO0RqU=\"\nSecureRandom.base64 13 # =&gt; \"1f8y7xsvaCEw0hwkjg==\"\n</code></pre>\n\n<p>There is now a cryptographically secure version of the above called <a href=\"https://github.com/cryptosphere/sysrandom\" rel=\"noreferrer\">SysRandom</a> which some people <a href=\"https://news.ycombinator.com/item?id=12440807\" rel=\"noreferrer\">are recommending</a>.</p>\n\n<p>With the gem <code>simple-password-gen</code> You can also generate <a href=\"https://github.com/dmke/simple-password-gen\" rel=\"noreferrer\">random and pronounceable passwords</a>:</p>\n\n<pre><code>require \"simple-password-gen\"\n\nPassword.random 8 # =&gt; \"#TFJ)Vtz3\"\nPassword.pronounceable 13 # =&gt; \"vingastusystaqu\"\n</code></pre>\n\n<p>Finally, and just for fun (I recommend SysRandom), I wrote a small gem a while back to <a href=\"https://github.com/DiegoSalazar/monkey_string#random-string-generator\" rel=\"noreferrer\">generate random strings based on template strings</a>. Although it doesn't include special chars, it would be a trivial addition. Feel free to submit an issue for it if it interests you.</p>\n"}, {"tags": [], "owner": {"reputation": 32, "user_id": 2546667, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Av62R.jpg?s=128&g=1", "display_name": "Mario Ruiz", "link": "https://stackoverflow.com/users/2546667/mario-ruiz"}, "is_accepted": false, "score": -1, "last_activity_date": 1544094241, "creation_date": 1544094241, "answer_id": 53649993, "question_id": 39376428, "link": "https://stackoverflow.com/questions/39376428/secure-password-generation-with-random-chars/53649993#53649993", "title": "Secure Password Generation With Random Chars", "body": "<p>The easiest way is by using the string_pattern gem <a href=\"https://github.com/MarioRuiz/string_pattern\" rel=\"nofollow noreferrer\">https://github.com/MarioRuiz/string_pattern</a></p>\n\n<p>This will generate 1000 unique strings from 6 to 20 characters including letters, and force to include special characters and numbers</p>\n\n<pre><code>require 'string_pattern'\n1000.times {\n    puts :\"6-20:L/$N/&amp;\".gen \n}\n</code></pre>\n"}], "owner": {"reputation": 1266, "user_id": 2977636, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/9f51b0e43d761ea1c8d8d0f498783462?s=128&d=identicon&r=PG&f=1", "display_name": "user2977636", "link": "https://stackoverflow.com/users/2977636/user2977636"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 7419, "favorite_count": 1, "accepted_answer_id": 39376753, "answer_count": 3, "score": 5, "last_activity_date": 1544094241, "creation_date": 1473270935, "question_id": 39376428, "link": "https://stackoverflow.com/questions/39376428/secure-password-generation-with-random-chars", "title": "Secure Password Generation With Random Chars", "body": "<p>I am trying to generate a random password that contains special chars using ruby. I would like to know if there is a standard for generating such passwords. I have considered using a weighted probability distribution and assigning weights such that there is a higher probability of picking special chars from , but I am not sure if this is a widely-accepted standard. </p>\n"}, {"tags": ["javascript", "ruby", "watir", "acceptance-testing", "user-acceptance-testing"], "comments": [{"owner": {"reputation": 12542, "user_id": 156746, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/8TsPx.jpg?s=128&g=1", "display_name": "DiegoSalazar", "link": "https://stackoverflow.com/users/156746/diegosalazar"}, "edited": false, "score": 0, "creation_date": 1473270921, "post_id": 39376244, "comment_id": 66080694, "body": "Please post the stacktrace of your error."}, {"owner": {"reputation": 182, "user_id": 3311540, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/a94dda9b6a99727e2b031456f6d8ed81?s=128&d=identicon&r=PG&f=1", "display_name": "ascendantofrain", "link": "https://stackoverflow.com/users/3311540/ascendantofrain"}, "reply_to_user": {"reputation": 12542, "user_id": 156746, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/8TsPx.jpg?s=128&g=1", "display_name": "DiegoSalazar", "link": "https://stackoverflow.com/users/156746/diegosalazar"}, "edited": false, "score": 0, "creation_date": 1473271571, "post_id": 39376244, "comment_id": 66081005, "body": "Stack trace posted to original post."}, {"owner": {"reputation": 3480, "user_id": 4072371, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/112e615d8c60908294e30848d9556186?s=128&d=identicon&r=PG", "display_name": "titusfortner", "link": "https://stackoverflow.com/users/4072371/titusfortner"}, "edited": false, "score": 0, "creation_date": 1473272502, "post_id": 39376244, "comment_id": 66081416, "body": "and I absolutely love Rubymine&#39;s debugger for working with UI tests."}, {"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 0, "creation_date": 1473272878, "post_id": 39376244, "comment_id": 66081581, "body": "Be careful using <code>$</code> globals. They strongly suggest you don&#39;t understand how variable scoping works. You should rarely, if ever, use them."}, {"owner": {"reputation": 182, "user_id": 3311540, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/a94dda9b6a99727e2b031456f6d8ed81?s=128&d=identicon&r=PG&f=1", "display_name": "ascendantofrain", "link": "https://stackoverflow.com/users/3311540/ascendantofrain"}, "edited": false, "score": 0, "creation_date": 1473274015, "post_id": 39376244, "comment_id": 66082090, "body": "Thanks for that heads up.  As I said, I&#39;m learning so thanks for pointing that out."}, {"owner": {"reputation": 182, "user_id": 3311540, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/a94dda9b6a99727e2b031456f6d8ed81?s=128&d=identicon&r=PG&f=1", "display_name": "ascendantofrain", "link": "https://stackoverflow.com/users/3311540/ascendantofrain"}, "edited": false, "score": 0, "creation_date": 1473344945, "post_id": 39376244, "comment_id": 66113326, "body": "So it looks like the div collection remains intact after the page refresh but the view.text reference bombs.  Any ideas?"}, {"owner": {"reputation": 3480, "user_id": 4072371, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/112e615d8c60908294e30848d9556186?s=128&d=identicon&r=PG", "display_name": "titusfortner", "link": "https://stackoverflow.com/users/4072371/titusfortner"}, "edited": false, "score": 0, "creation_date": 1473360677, "post_id": 39376244, "comment_id": 66122389, "body": "The collection holds references to objects that are no longer on the page. Please refer to my answer below, and let me know if you have any additional questions."}], "answers": [{"tags": [], "owner": {"reputation": 3480, "user_id": 4072371, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/112e615d8c60908294e30848d9556186?s=128&d=identicon&r=PG", "display_name": "titusfortner", "link": "https://stackoverflow.com/users/4072371/titusfortner"}, "is_accepted": false, "score": 0, "last_activity_date": 1473272435, "last_edit_date": 1495540302, "creation_date": 1473272435, "answer_id": 39376746, "question_id": 39376244, "link": "https://stackoverflow.com/questions/39376244/ruby-global-variables-after-refreshing-browser/39376746#39376746", "title": "Ruby Global Variables After Refreshing Browser", "body": "<p>The answer is pretty much what I put here: <a href=\"https://stackoverflow.com/a/39332788/4072371\">https://stackoverflow.com/a/39332788/4072371</a></p>\n\n<p>Use index instead of iterating over a collection</p>\n"}, {"tags": [], "owner": {"reputation": 5134, "user_id": 1672197, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i8HkV.png?s=128&g=1", "display_name": "orde", "link": "https://stackoverflow.com/users/1672197/orde"}, "is_accepted": false, "score": 0, "last_activity_date": 1473383304, "creation_date": 1473383304, "answer_id": 39402371, "question_id": 39376244, "link": "https://stackoverflow.com/questions/39376244/ruby-global-variables-after-refreshing-browser/39402371#39402371", "title": "Ruby Global Variables After Refreshing Browser", "body": "<p>Here's an example that demonstrates the issue (which--to give credit where credit is due--titusfortner identified):</p>\n\n<pre><code>require 'watir-webdriver'\nb = Watir::Browser.new :chrome\nb.goto('http://www.iana.org/domains/reserved')\n\nfirst_link_from_divs = b.div(id: \"sidebar_left\").links.first\nfirst_link_from_divs.text                                       #=&gt; Overview\nfirst_link_from_divs.exists?                                    #=&gt; true\n\njust_a_link = b.link(text: \"Overview\")\njust_a_link.text                                                #=&gt; Overview\njust_a_link.exists?                                             #=&gt; true\n\nb.refresh\nfirst_link_from_divs.exists?                                    #=&gt; false\njust_a_link.exists?                                             #=&gt; true  \n</code></pre>\n"}], "owner": {"reputation": 182, "user_id": 3311540, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/a94dda9b6a99727e2b031456f6d8ed81?s=128&d=identicon&r=PG&f=1", "display_name": "ascendantofrain", "link": "https://stackoverflow.com/users/3311540/ascendantofrain"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 129, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1473383304, "creation_date": 1473270237, "last_edit_date": 1473271557, "question_id": 39376244, "link": "https://stackoverflow.com/questions/39376244/ruby-global-variables-after-refreshing-browser", "title": "Ruby Global Variables After Refreshing Browser", "body": "<p>I am very new to Ruby and developing scripts with Watir for acceptance testing and I am stuck in a rut that I'm not even sure is possible to get out of.</p>\n\n<p>I have a small script that runs that basically looks at a dropdown list, stores all of the dropdown items into a global variable which I then iterate over and run some other functions.</p>\n\n<p>The issue occurs when I try to refresh the browser after running all of the functions for each dropdown item which then tries to iterate to the next dropdown item and execute the same functions until all dropdown items are complete.</p>\n\n<pre><code>$browser = Watir::Browser.new :chrome\n$wait = Watir::Wait\n\ndef wait_while_loading(what)\n    lightbox = $browser.div(:class , 'lightbox')\n\n    begin\n        # Capture load start\n        start = Time.now\n\n        $wait.until { lightbox.present? }\n        $wait.until { !lightbox.present? }\n\n        # Capture load end\n        finish = Time.now\n        load_time = (finish - start).to_s\n    rescue =&gt; e\n        print e.backtrace.join(\"\\n\")\n        #log_error('Failed while loading ' + what + '.')\n    end \nend\n\ndef cycle_all_views\n    $views = []\n    $current_view\n\n    $view_dropdown = $browser.div(:id, 'views-dropdown') \n\n    $views = $browser.div(:class, 'dropdown-views').div(:class, 'dropdown-menu--footer').ul(:class, 'dropdown-menu').divs(:class, 'dropdown-menu-item')\n\n    start_on_view = 10\n\n    begin\n        $views.drop(start_on_view).each_with_index do |view, i|     \n            $view_dropdown.click\n\n            $current_view = view.text\n            index = i.to_s\n            safe_name = sanitize($current_view)\n\n            view.click\n            wait_while_loading($current_view)\n\n            $browser.refresh\n            wait_while_loading('Refreshing Page...')\n        end\n    rescue =&gt; e\n        #log_error('Failed to load view ' + $current_view)\n    end\nend\n</code></pre>\n\n<p>After triggering the <code>$browser.refresh</code>, clicking on the <code>$views_dropdown</code> after iterating to the next <code>view</code>, I am greeted with an error stating <code>no implicit conversion of nil into String</code> assuming when trying to do <code>$current_view = view.text</code>.  Do I lose all assignments to variables after the page refresh?  If so, is there a way to keep them?</p>\n\n<p>If anyone could also point me to a better way of debugging my Watir scripts, I would love to know of any way to make my life easier.</p>\n\n<p>Stack trace returns this:</p>\n\n<pre><code>C:/Ruby23/lib/ruby/gems/2.3.0/gems/watir-webdriver-0.9.3/lib/watir-webdriver/ele\nments/element.rb:536:in `assert_element_found'\nC:/Ruby23/lib/ruby/gems/2.3.0/gems/watir-webdriver-0.9.3/lib/watir-webdriver/ele\nments/element.rb:524:in `ensure_not_stale'\nC:/Ruby23/lib/ruby/gems/2.3.0/gems/watir-webdriver-0.9.3/lib/watir-webdriver/ele\nments/element.rb:503:in `assert_exists'\nC:/Ruby23/lib/ruby/gems/2.3.0/gems/watir-webdriver-0.9.3/lib/watir-webdriver/ele\nments/element.rb:81:in `text'\nmain.rb:55:in `block in cycle_all_views'\nmain.rb:52:in `each'\nmain.rb:52:in `each_with_index'\nmain.rb:52:in `cycle_all_views'\nmain.rb:122:in `block in &lt;main&gt;'\nmain.rb:112:in `each'\nmain.rb:112:in `&lt;main&gt;'Failed to load view First View\n</code></pre>\n"}, {"tags": ["ruby", "postgresql", "sequel"], "comments": [{"owner": {"reputation": 12542, "user_id": 156746, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/8TsPx.jpg?s=128&g=1", "display_name": "DiegoSalazar", "link": "https://stackoverflow.com/users/156746/diegosalazar"}, "edited": false, "score": 0, "creation_date": 1473271245, "post_id": 39375806, "comment_id": 66080853, "body": "I always eager load in batches (of say 1000 at a time). Pagination makes it easy to to do batches <a href=\"https://github.com/chanks/sequel-seek-pagination\" rel=\"nofollow noreferrer\">github.com/chanks/sequel-seek-pagination</a>"}, {"owner": {"reputation": 7565, "user_id": 1021515, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/Z9QcP.jpg?s=128&g=1", "display_name": "mwp", "link": "https://stackoverflow.com/users/1021515/mwp"}, "edited": false, "score": 0, "creation_date": 1473298089, "post_id": 39375806, "comment_id": 66090181, "body": "Are you loading or unloading records?"}, {"owner": {"reputation": 6088, "user_id": 1983072, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/974c4e106b996fff51c25171e439b7b8?s=128&d=identicon&r=PG", "display_name": "bbozo", "link": "https://stackoverflow.com/users/1983072/bbozo"}, "reply_to_user": {"reputation": 12542, "user_id": 156746, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/8TsPx.jpg?s=128&g=1", "display_name": "DiegoSalazar", "link": "https://stackoverflow.com/users/156746/diegosalazar"}, "edited": false, "score": 0, "creation_date": 1473761458, "post_id": 39375806, "comment_id": 66254889, "body": "@diego.greyrobot I expanded the OP with the extensions list used by my code, are you sure that the <code>sequel-seek-pagination</code> actually performs the eager load when postgres + common adapters are used? Unless you are monitoring the SQL logs you would not notice that something broke here, the &quot;joined&quot; records would simply be lazy loaded?"}, {"owner": {"reputation": 6088, "user_id": 1983072, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/974c4e106b996fff51c25171e439b7b8?s=128&d=identicon&r=PG", "display_name": "bbozo", "link": "https://stackoverflow.com/users/1983072/bbozo"}, "reply_to_user": {"reputation": 7565, "user_id": 1021515, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/Z9QcP.jpg?s=128&g=1", "display_name": "mwp", "link": "https://stackoverflow.com/users/1021515/mwp"}, "edited": false, "score": 0, "creation_date": 1473761490, "post_id": 39375806, "comment_id": 66254906, "body": "@mwp, what do you mean exactly? :) I&#39;m writing an export script if that helps :)"}], "owner": {"reputation": 6088, "user_id": 1983072, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/974c4e106b996fff51c25171e439b7b8?s=128&d=identicon&r=PG", "display_name": "bbozo", "link": "https://stackoverflow.com/users/1983072/bbozo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 165, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1473761324, "creation_date": 1473268593, "last_edit_date": 1473761324, "question_id": 39375806, "link": "https://stackoverflow.com/questions/39375806/iterating-through-a-lot-of-records-using-sequel-with-an-eager-loaded-associatio", "title": "Iterating through a lot of records using Sequel, with an eager-loaded association", "body": "<p>Basically... How to do it?</p>\n\n<p>Yes, the docs say that <code>each</code> does not make sense with <code>eager</code>, but that sentence only makes sense when records are loaded one by one - not in bulks of 1000 typically where skipping N+1 queries really has a big impact.</p>\n\n<p>I use postgres with following extensions:</p>\n\n<pre><code>Sequel.extension :core_extensions\nSequel.extension :pg_json\nSequel.extension :pg_json_ops\n\nDB.extension(:pagination)\n\nSequel::Model.plugin :timestamps, update_on_create: true\n</code></pre>\n\n<p>if I try <code>use_cursor.each</code> then the eager loading is not used.</p>\n\n<p>If I try pagination and <code>each_page</code> the eager loading is also not used.</p>\n\n<p>If I try just <code>all.each</code> then eager loading kicks in, so I know I got the <code>eager</code> call right.</p>\n\n<p>What do you do?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-4", "controller", "rubygems"], "answers": [{"comments": [{"owner": {"reputation": 159, "user_id": 6789165, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/2390e9333ab37c397ce2b94840de5864?s=128&d=identicon&r=PG&f=1", "display_name": "Gugubaight", "link": "https://stackoverflow.com/users/6789165/gugubaight"}, "edited": false, "score": 0, "creation_date": 1473310819, "post_id": 39376697, "comment_id": 66092991, "body": "I&#39;ve got a working solution. Your answer helped me out!"}, {"owner": {"reputation": 159, "user_id": 6789165, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/2390e9333ab37c397ce2b94840de5864?s=128&d=identicon&r=PG&f=1", "display_name": "Gugubaight", "link": "https://stackoverflow.com/users/6789165/gugubaight"}, "edited": false, "score": 0, "creation_date": 1473311374, "post_id": 39376697, "comment_id": 66093147, "body": "Weird thing is, though: if I add <code>elsif searchtags none</code> to <code>self.search</code> the Argument error (0 for 1) appears again..."}, {"owner": {"reputation": 159, "user_id": 6789165, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/2390e9333ab37c397ce2b94840de5864?s=128&d=identicon&r=PG&f=1", "display_name": "Gugubaight", "link": "https://stackoverflow.com/users/6789165/gugubaight"}, "edited": false, "score": 0, "creation_date": 1473330809, "post_id": 39376697, "comment_id": 66103572, "body": "I posted this as a question here: <a href=\"http://stackoverflow.com/questions/39388648/rails-4-error-argumenterror-wrong-number-of-arguments\" title=\"rails 4 error argumenterror wrong number of arguments\">stackoverflow.com/questions/39388648/&hellip;</a>"}], "tags": [], "owner": {"reputation": 95, "user_id": 6797298, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FXCBi.jpg?s=128&g=1", "display_name": "Abuzhan", "link": "https://stackoverflow.com/users/6797298/abuzhan"}, "is_accepted": true, "score": 2, "last_activity_date": 1473272182, "last_edit_date": 1495542819, "creation_date": 1473272182, "answer_id": 39376697, "question_id": 39375497, "link": "https://stackoverflow.com/questions/39375497/rails-4-search-engine-multiple-params/39376697#39376697", "title": "Rails 4 Search Engine: Multiple Params", "body": "<p>I am not quite sure, but I've seen the same problems here before. The reason was incomatiability of the versions of 'acts_as_taggable_on' gem with the rails version. I wanted to add this as a comment to your post, but unfortunately, it is still not permitted for my account. You may find solutions here <a href=\"https://stackoverflow.com/questions/36029576/agged-withparamsskill-argumenterror-wrong-number-of-arguments-given-2-ex\">agged_with(params[:skill]) ArgumentError: wrong number of arguments (given 2, expected 1)</a></p>\n"}], "owner": {"reputation": 159, "user_id": 6789165, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/2390e9333ab37c397ce2b94840de5864?s=128&d=identicon&r=PG&f=1", "display_name": "Gugubaight", "link": "https://stackoverflow.com/users/6789165/gugubaight"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 65, "favorite_count": 0, "accepted_answer_id": 39376697, "answer_count": 1, "score": 0, "last_activity_date": 1473311296, "creation_date": 1473267217, "last_edit_date": 1473311296, "question_id": 39375497, "link": "https://stackoverflow.com/questions/39375497/rails-4-search-engine-multiple-params", "title": "Rails 4 Search Engine: Multiple Params", "body": "<p>I'm fairly new to rails and at the moment coding my first app.<br> I created a search for the usernames of my users, but since then I've added a tagging system (using 'acts_as_taggable_on' gem), which I now want to implement in the search functionality.</p>\n\n<p>I've tried it several times now, but always got an Argument error (either 0 for 1 or 2 for 1).</p>\n\n<p>That is how you target the user objects with the tag params:</p>\n\n<pre><code># Find users with any of the specified tags:\nUser.tagged_with([\"awesome\", \"cool\"], :any =&gt; true, :wild =&gt; true)\n</code></pre>\n\n<p>User Model</p>\n\n<pre><code>acts_as_ordered_taggable\n# Search \ndef self.search(search)\n  if search\n    where([\"username LIKE ?\", \"%#{search}%\"])\n  else\n    all\n  end\nend\n# Search Tags\ndef self.searchtags(searchtags)\n  if searchtags\n    tagged_with([\"#{searchtags}\"], :any =&gt; true, :wild =&gt; true)\n  else\n    none\n  end\nend\n</code></pre>\n\n<p>Users Controller</p>\n\n<pre><code>def index\n  @users = User.search(params[:search])\n  @tagged_users = User.searchtags(params[:searchtags]\nend\n</code></pre>\n\n<p>User Index View</p>\n\n<pre><code>= form_tag users_path, :method =&gt; 'get' do\n    = text_field_tag :search, params[:search]\n    = submit_tag \"Search\"\n= form_tag users_path, :method =&gt; 'get' do\n    = text_field_tag :searchtags, params[:searchtags]\n    = submit_tag \"Search Tags\"\n\n- @users.each do |user|\n    = image_tag gravatar_for user if user.use_gravatar == true\n    = image_tag user.avatar_filename.url if user.use_gravatar == false\n    %h2= link_to user.username, user\n    %p= link_to \"Favorite\", userfavorite_user_path(user, type: \"favorite\"), method: :get\n    %p= link_to \"Unfavorite\", userfavorite_user_path(user, type: \"unfavorite\"), method: :get\n    %p= user.tag_list\n\n- @tagged_users.each do |user|\n    = image_tag gravatar_for user if user.use_gravatar == true\n    = image_tag user.avatar_filename.url if user.use_gravatar == false\n    %h2= link_to user.username, user\n    %p= link_to \"Favorite\", userfavorite_user_path(user, type: \"favorite\"), method: :get\n    %p= link_to \"Unfavorite\", userfavorite_user_path(user, type: \"unfavorite\"), method: :get\n    %p= user.tag_list\n</code></pre>\n\n<p>Hope someone can help me by finding a solution, thanks.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "regex"], "comments": [{"owner": {"reputation": 31885, "user_id": 1008938, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/EOZbS.png?s=128&g=1", "display_name": "Linuxios", "link": "https://stackoverflow.com/users/1008938/linuxios"}, "edited": false, "score": 0, "creation_date": 1473265800, "post_id": 39375109, "comment_id": 66078158, "body": "Oof. Is that webservice actually returning <i>JavaScript code</i>? Let me look a little closer..."}, {"owner": {"reputation": 5296, "user_id": 418066, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/38yuw.png?s=128&g=1", "display_name": "Biffen", "link": "https://stackoverflow.com/users/418066/biffen"}, "edited": false, "score": 4, "creation_date": 1473265890, "post_id": 39375109, "comment_id": 66078195, "body": "Is that <a href=\"https://en.wikipedia.org/wiki/JSONP\" rel=\"nofollow noreferrer\">JSONP</a>?"}, {"owner": {"reputation": 31885, "user_id": 1008938, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/EOZbS.png?s=128&g=1", "display_name": "Linuxios", "link": "https://stackoverflow.com/users/1008938/linuxios"}, "reply_to_user": {"reputation": 5296, "user_id": 418066, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/38yuw.png?s=128&g=1", "display_name": "Biffen", "link": "https://stackoverflow.com/users/418066/biffen"}, "edited": false, "score": 0, "creation_date": 1473266050, "post_id": 39375109, "comment_id": 66078262, "body": "@Biffen: Now that you mention it, probably."}, {"owner": {"reputation": 31885, "user_id": 1008938, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/EOZbS.png?s=128&g=1", "display_name": "Linuxios", "link": "https://stackoverflow.com/users/1008938/linuxios"}, "edited": false, "score": 1, "creation_date": 1473266242, "post_id": 39375109, "comment_id": 66078359, "body": "For best results, you might then want to use a Ruby JavaScript parser: <a href=\"http://stackoverflow.com/questions/4940171/parsing-javascript-using-ruby-code\" title=\"parsing javascript using ruby code\">stackoverflow.com/questions/4940171/&hellip;</a>. It&#39;s a little heavy, but won&#39;t get tripped up over things a regex might."}, {"owner": {"reputation": 24729, "user_id": 2564200, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/a92dfcc9fcac72dabd4b1eefa0b5106e?s=128&d=identicon&r=PG&f=1", "display_name": "Santhosh", "link": "https://stackoverflow.com/users/2564200/santhosh"}, "edited": false, "score": 0, "creation_date": 1473266415, "post_id": 39375109, "comment_id": 66078441, "body": "R is not equal to &quot;laptop bag&quot;"}], "answers": [{"comments": [{"owner": {"reputation": 1723, "user_id": 836087, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/63a6802d9ab4d43d4610c9df01c0092c?s=128&d=identicon&r=PG&f=1", "display_name": "user836087", "link": "https://stackoverflow.com/users/836087/user836087"}, "edited": false, "score": 0, "creation_date": 1473355127, "post_id": 39375382, "comment_id": 66119539, "body": "This actually doesn&#39;t work for all cases, could you review?"}, {"owner": {"reputation": 1723, "user_id": 836087, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/63a6802d9ab4d43d4610c9df01c0092c?s=128&d=identicon&r=PG&f=1", "display_name": "user836087", "link": "https://stackoverflow.com/users/836087/user836087"}, "edited": false, "score": 0, "creation_date": 1473355961, "post_id": 39375382, "comment_id": 66119942, "body": "I added some details to the question, please take a look"}, {"owner": {"reputation": 1723, "user_id": 836087, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/63a6802d9ab4d43d4610c9df01c0092c?s=128&d=identicon&r=PG&f=1", "display_name": "user836087", "link": "https://stackoverflow.com/users/836087/user836087"}, "edited": false, "score": 0, "creation_date": 1473357765, "post_id": 39375382, "comment_id": 66120884, "body": "the actual string has all these back slashes"}], "tags": [], "owner": {"reputation": 24729, "user_id": 2564200, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/a92dfcc9fcac72dabd4b1eefa0b5106e?s=128&d=identicon&r=PG&f=1", "display_name": "Santhosh", "link": "https://stackoverflow.com/users/2564200/santhosh"}, "is_accepted": true, "score": 2, "last_activity_date": 1473266775, "creation_date": 1473266775, "answer_id": 39375382, "question_id": 39375109, "link": "https://stackoverflow.com/questions/39375109/parse-unpleasant-string-in-ruby-to-derive-a-condition/39375382#39375382", "title": "Parse unpleasant string in ruby to derive a condition", "body": "<p>The parameter passed to <code>partialResult</code> method should be valid json. You can use regex, to extract that string.</p>\n\n<pre><code>require 'json'\nhsh = JSON.parse str.scan(/partialResult\\((.*)\\)/)[0][0]\n#=&gt; {\"Q\"=&gt;\"laptop bag\", \"R\"=&gt;[[\"laptop bag\", [[\"Electronics\", 3944]]], \"laptop bags for 15.6 inch laptops\", \"laptop bags for women\", \"laptop bag 15.6\", \"laptop bags for 17.3 in laptops\", \"rolling laptop bag\", \"laptop bag with wheels\", \"laptop bag 17\\\"\"]} \n</code></pre>\n\n<p>To check for a common string</p>\n\n<pre><code>hsh[\"R\"].flatten &amp;&amp; hsh[\"Q\"].flatten\n#=&gt; \"laptop bag\" \n</code></pre>\n"}], "owner": {"reputation": 1723, "user_id": 836087, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/63a6802d9ab4d43d4610c9df01c0092c?s=128&d=identicon&r=PG&f=1", "display_name": "user836087", "link": "https://stackoverflow.com/users/836087/user836087"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 67, "favorite_count": 0, "accepted_answer_id": 39375382, "answer_count": 1, "score": 0, "last_activity_date": 1473360977, "creation_date": 1473265690, "last_edit_date": 1473360977, "question_id": 39375109, "link": "https://stackoverflow.com/questions/39375109/parse-unpleasant-string-in-ruby-to-derive-a-condition", "title": "Parse unpleasant string in ruby to derive a condition", "body": "<p>I have a response string that gets returned from a webservice that isn't JSON exactly, nor any other kind of hashable object, I can serialize.\nI'm new to regex so I'm trying to learn how I can extract the needed pieces for my ruby code.</p>\n\n<p>The string is so horrendous, I'm not sure how to go about comparing the two. I don't know much regex so that's also a hindrance. Thank you in advance for any help you can provide.</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 31885, "user_id": 1008938, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/EOZbS.png?s=128&g=1", "display_name": "Linuxios", "link": "https://stackoverflow.com/users/1008938/linuxios"}, "reply_to_user": {"reputation": 3774, "user_id": 1995757, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/e810cba26af3b02e1ca207cc440edb3a?s=128&d=identicon&r=PG", "display_name": "etusm", "link": "https://stackoverflow.com/users/1995757/etusm"}, "edited": false, "score": 0, "creation_date": 1473265638, "post_id": 39374807, "comment_id": 66078056, "body": "@etusm: What problem do you see with that?"}, {"owner": {"reputation": 31885, "user_id": 1008938, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/EOZbS.png?s=128&g=1", "display_name": "Linuxios", "link": "https://stackoverflow.com/users/1008938/linuxios"}, "edited": false, "score": 0, "creation_date": 1473265718, "post_id": 39374807, "comment_id": 66078110, "body": "You&#39;re using a different set of possible choices for the player and the computer -- is that intentional?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user6796341"}, "reply_to_user": {"reputation": 31885, "user_id": 1008938, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/EOZbS.png?s=128&g=1", "display_name": "Linuxios", "link": "https://stackoverflow.com/users/1008938/linuxios"}, "edited": false, "score": 0, "creation_date": 1473266851, "post_id": 39374807, "comment_id": 66078681, "body": "@Linuxios: Fixed it."}, {"owner": {"reputation": 31885, "user_id": 1008938, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/EOZbS.png?s=128&g=1", "display_name": "Linuxios", "link": "https://stackoverflow.com/users/1008938/linuxios"}, "edited": false, "score": 0, "creation_date": 1473266895, "post_id": 39374807, "comment_id": 66078706, "body": "@JohnCarter: And is it still broken?"}, {"owner": {"reputation": 9369, "user_id": 3724716, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/db6186238a22752875cea1841a19d769?s=128&d=identicon&r=PG", "display_name": "Arun Kumar Mohan", "link": "https://stackoverflow.com/users/3724716/arun-kumar-mohan"}, "edited": false, "score": 0, "creation_date": 1473270116, "post_id": 39374807, "comment_id": 66080301, "body": "@JohnCarter Please fix the bugs in the code that you&#39;ve posted here. And your code is working fine for me(after fixing minor bugs). Maybe try hardcoding the value of <code>computer_choice</code> to see if its working."}], "answers": [{"comments": [{"owner": {"reputation": 31885, "user_id": 1008938, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/EOZbS.png?s=128&g=1", "display_name": "Linuxios", "link": "https://stackoverflow.com/users/1008938/linuxios"}, "edited": false, "score": 0, "creation_date": 1473265622, "post_id": 39374864, "comment_id": 66078049, "body": "I&#39;m not sure how this solves the problem -- all you did was change the parameter names."}], "tags": [], "owner": {"reputation": 1, "user_id": 4279017, "user_type": "registered", "accept_rate": 38, "profile_image": "https://graph.facebook.com/100006600795570/picture?type=large", "display_name": "Kimberly Wright", "link": "https://stackoverflow.com/users/4279017/kimberly-wright"}, "is_accepted": false, "score": -2, "last_activity_date": 1473264840, "creation_date": 1473264840, "answer_id": 39374864, "question_id": 39374807, "link": "https://stackoverflow.com/questions/39374807/ruby-skips-if-statements/39374864#39374864", "title": "Ruby skips if statements", "body": "<p>Have you tried fixing your code a bit:</p>\n\n<pre><code>def test?(player, computer)\n  (player== 'rock' &amp;&amp; computer== VALID_CHOICES['sc']) ||\n  (player== 'paper' &amp;&amp; computer== VALID_CHOICES['r']) ||\n  (player== 'scissors' &amp;&amp; computer== VALID_CHOICES['sc']) ||\n  (player== 'paper' &amp;&amp; computer== VALID_CHOICES['sp'])\nend \n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 9125, "user_id": 671422, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/85da2a1fa3e4017815ff5d3a3d70fabe?s=128&d=identicon&r=PG", "display_name": "Yule", "link": "https://stackoverflow.com/users/671422/yule"}, "is_accepted": false, "score": 3, "last_activity_date": 1473265711, "creation_date": 1473265711, "answer_id": 39375118, "question_id": 39374807, "link": "https://stackoverflow.com/questions/39374807/ruby-skips-if-statements/39375118#39375118", "title": "Ruby skips if statements", "body": "<p>You're getting the user's input and testing it against 'rock', 'paper' and 'scissors', however you've stated that the user is entering 'l', 'p', and 'sc' so test will never evaluate to true</p>\n\n<p>As an example, saving this as rps.rb and running:</p>\n\n<pre><code>&gt; ruby rps.rb \nEnter a key: \nrock\nYou won!\nYou chose: rock, computer choose: light\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user6796341"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 53, "favorite_count": 1, "answer_count": 2, "score": 0, "last_activity_date": 1473266769, "creation_date": 1473264675, "last_edit_date": 1473266769, "question_id": 39374807, "link": "https://stackoverflow.com/questions/39374807/ruby-skips-if-statements", "title": "Ruby skips if statements", "body": "<p>I have a ruby program here w/c consists of hashes. Basically when the user enters l or p or sc it will check if the computer generated key matches the criteria on the first variable w/c is the player or the user. If it matches the criteria it will return you won. But if it's not it will return you loose. otherwise if it's the same it will print a tie.</p>\n\n<pre><code>MY_CHOICES = { \n 'l' =&gt; 'light',\n 'p' =&gt; 'paper', \n 'sc' =&gt; 'scan',\n}\n\ndef test?(first, second)\n  (first == 'p' &amp;&amp; second == MY_CHOICES ['l']) ||\n  (first == 'l' &amp;&amp; second == MY_CHOICES ['p']) ||\n  (first == 'sc' &amp;&amp; second == MY_CHOICES ['sc']) ||\n  (first == 'l' &amp;&amp; second == MY_CHOICES ['l'])\nend \n\ndef print_results(player, computer)\n  if test?(player, computer)\n    puts(\"You won!\")\n  elsif test?(computer, player)\n    puts(\"Computer won! You loose!\")\n  else\n    puts(\"It's a tie!\")\n  end\nend\n\nputs \"Enter a key: \"\nchoice = gets().chomp()\ncomputer_choice = MY_CHOICES.values.sample\nprint_results(choice, computer_choice)\nputs(\"You chose: #{choice}, computer choose: #{computer_choice}\"\n</code></pre>\n\n<p>With the codes above, my code is skipping the codes and always prints \"It's a tie\" I don't what I am missing here. Any idea?</p>\n"}, {"tags": ["ruby", "regex"], "answers": [{"comments": [{"owner": {"reputation": 775, "user_id": 4259146, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/md4P7.jpg?s=128&g=1", "display_name": "samz_manu", "link": "https://stackoverflow.com/users/4259146/samz-manu"}, "edited": false, "score": 0, "creation_date": 1473264551, "post_id": 39374507, "comment_id": 66077450, "body": "Thanks! Question: I tried to iterate through it using mtch.each {|x| puts x} but got hit with the .each not defined error. Why is that? Is a for loop the only way to iterate through it then?"}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "reply_to_user": {"reputation": 775, "user_id": 4259146, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/md4P7.jpg?s=128&g=1", "display_name": "samz_manu", "link": "https://stackoverflow.com/users/4259146/samz-manu"}, "edited": false, "score": 0, "creation_date": 1473264735, "post_id": 39374507, "comment_id": 66077558, "body": "You must be kidding: <code>mtch.captures.each { |e| print e } #\u21d2 hel</code>. The glitch is somewhere else."}, {"owner": {"reputation": 775, "user_id": 4259146, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/md4P7.jpg?s=128&g=1", "display_name": "samz_manu", "link": "https://stackoverflow.com/users/4259146/samz-manu"}, "edited": false, "score": 0, "creation_date": 1473264803, "post_id": 39374507, "comment_id": 66077596, "body": "Oh I&#39;m dumb. Didn&#39;t put captures. -_-"}], "tags": [], "owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "is_accepted": true, "score": 3, "last_activity_date": 1473264694, "last_edit_date": 1473264694, "creation_date": 1473263786, "answer_id": 39374507, "question_id": 39374380, "link": "https://stackoverflow.com/questions/39374380/count-capture-groups-ruby/39374507#39374507", "title": "Count capture groups ruby", "body": "<p>One might use <a href=\"https://ruby-doc.org/core-2.3.0/MatchData.html#method-i-captures\" rel=\"nofollow\"><code>MatchData#captures</code></a>:</p>\n\n<pre><code>\u25b6 mtch = /(\\w)(\\w)(\\w)/.match 'hello'\n#\u21d2 #&lt;MatchData \"hel\" 1:\"h\" 2:\"e\" 3:\"l\"&gt;\n\u25b6 mtch.captures\n#\u21d2 [\n#  [0] \"h\",\n#  [1] \"e\",\n#  [2] \"l\"\n# ]\n</code></pre>\n\n<p>Also note, that you actually capture <em>a first digit in a sequence</em> only. To capture all of them, move <code>+</code> inside parentheses:</p>\n\n<pre><code>#           \u21d3\n/^cost:\\s(\\d+)\\sitems:\\s.../\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1473280179, "post_id": 39375327, "comment_id": 66084947, "body": "What is a &quot;non-deterministic split&quot;?"}, {"owner": {"reputation": 260, "user_id": 6562308, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MhM9s.gif?s=128&g=1", "display_name": "Jon Malachowski", "link": "https://stackoverflow.com/users/6562308/jon-malachowski"}, "reply_to_user": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1473773691, "post_id": 39375327, "comment_id": 66262144, "body": "Poor wording perhaps. I mean that I use Ruby&#39;s Regex object when I have to match something that has a known amount of capture groups.  But when I want to match a list of things where I don&#39;t know how many items I have, then I use Scan."}], "tags": [], "owner": {"reputation": 260, "user_id": 6562308, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MhM9s.gif?s=128&g=1", "display_name": "Jon Malachowski", "link": "https://stackoverflow.com/users/6562308/jon-malachowski"}, "is_accepted": false, "score": 0, "last_activity_date": 1473266545, "creation_date": 1473266545, "answer_id": 39375327, "question_id": 39374380, "link": "https://stackoverflow.com/questions/39374380/count-capture-groups-ruby/39375327#39375327", "title": "Count capture groups ruby", "body": "<p>Consider using the scan method if you think you have non-deterministic split with a regex: <a href=\"http://ruby-doc.org/core-2.2.0/String.html#method-i-scan\" rel=\"nofollow\">http://ruby-doc.org/core-2.2.0/String.html#method-i-scan</a></p>\n"}], "owner": {"reputation": 775, "user_id": 4259146, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/md4P7.jpg?s=128&g=1", "display_name": "samz_manu", "link": "https://stackoverflow.com/users/4259146/samz-manu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 328, "favorite_count": 0, "accepted_answer_id": 39374507, "answer_count": 2, "score": 0, "last_activity_date": 1473266545, "creation_date": 1473263449, "question_id": 39374380, "link": "https://stackoverflow.com/questions/39374380/count-capture-groups-ruby", "title": "Count capture groups ruby", "body": "<p>I have a regex in my ruby script with a couple of capture groups. Here's a snippet of it: <code>/^cost:\\s(\\d)+\\sitems:\\s</code>\nAnd I'm capturing the digit that comes right after cost. I have more capture groups later on but I don't know how many will get captured. Depends on the input text file. I know the way to access capture groups is with:</p>\n\n<pre><code>$1, $2 etc etc\n</code></pre>\n\n<p>But I don't know how many get captured. Is there a way to find out the number of groups that were captured and iterate through it maybe?</p>\n\n<p>Thanks</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-4", "inheritance"], "answers": [{"comments": [{"owner": {"reputation": 2081, "user_id": 1939604, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/5D7DV.jpg?s=128&g=1", "display_name": "Simon Ninon", "link": "https://stackoverflow.com/users/1939604/simon-ninon"}, "edited": false, "score": 0, "creation_date": 1473267704, "post_id": 39375534, "comment_id": 66079139, "body": "Excellent, exactly what I was looking for! Thank you!"}], "tags": [], "owner": {"reputation": 5962, "user_id": 115159, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/ac02a81e50f368f6d5c7a14b99ce2469?s=128&d=identicon&r=PG", "display_name": "Dharam Gollapudi", "link": "https://stackoverflow.com/users/115159/dharam-gollapudi"}, "is_accepted": true, "score": 2, "last_activity_date": 1473267336, "creation_date": 1473267336, "answer_id": 39375534, "question_id": 39374366, "link": "https://stackoverflow.com/questions/39374366/ruby-share-class-variable-inheritance/39375534#39375534", "title": "ruby: share class variable inheritance", "body": "<p>Try the following:</p>\n\n<pre><code>module M\n  def self.included(base)\n    base.extend ClassMethods\n    base.instance_eval do\n      cattr_accessor :toto, instance_writer: false, instance_reader: false do \n        {}\n      end          \n    end  \n  end\n\n  module ClassMethods\n    # class methods \n  end\nend\n\n\nclass A\n  include M\nend\n\nclass B &lt; A\nend\n\nputs A.toto\nputs B.toto\nputs A.toto = 12\nputs B.toto\n\n# {}\n# {}\n# 12\n# 12\n</code></pre>\n"}], "owner": {"reputation": 2081, "user_id": 1939604, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/5D7DV.jpg?s=128&g=1", "display_name": "Simon Ninon", "link": "https://stackoverflow.com/users/1939604/simon-ninon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 54, "favorite_count": 0, "accepted_answer_id": 39375534, "answer_count": 1, "score": 0, "last_activity_date": 1473267336, "creation_date": 1473263403, "question_id": 39374366, "link": "https://stackoverflow.com/questions/39374366/ruby-share-class-variable-inheritance", "title": "ruby: share class variable inheritance", "body": "<p>In my Rails application, I got a concern which is included within a base class. The base class is then inherited.</p>\n\n<p>The included module defines a class variable for which I'd like to have the same value whether or not I'm in the base class or child class.</p>\n\n<p>The code looks like something similar:</p>\n\n<pre><code>module M\n\n  def self.included(base)\n    base.extend ClassMethods\n  end\n\n  module ClassMethods\n\n    attr_accessor :lol\n\n    def toto\n      @lol ||= {}\n    end\n\n    def toto=(val)\n      @lol = val\n    end\n\n  end\n\nend\n\n\nclass A\n  include M\nend\n\nclass B &lt; A\nend\n\nputs A::toto\nputs B::toto\nputs A::toto = 12\nputs B::toto\n</code></pre>\n\n<p>I'm actually using concerns, but the behavior is the same.</p>\n\n<p>This code prints</p>\n\n<pre><code>{}\n{}\n12\n{}\n</code></pre>\n\n<p>while I'd like</p>\n\n<pre><code>{}\n{}\n12\n12\n</code></pre>\n\n<p>Is there any wa to achieve that?\nI've tried different combination of attr_accessor / cattr_accessor, but nothing worked.</p>\n"}, {"tags": ["arrays", "ruby", "sorting"], "comments": [{"owner": {"reputation": 636, "user_id": 1253311, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/21acab710c6e17104c2af7bf8390a9d5?s=128&d=identicon&r=PG", "display_name": "Matt", "link": "https://stackoverflow.com/users/1253311/matt"}, "edited": false, "score": 0, "creation_date": 1473263475, "post_id": 39374243, "comment_id": 66076754, "body": "What does your implementation of <code>a_beat_b</code> look like? What do you mean when you say you &quot;couldn&#39;t get the code right&quot;?"}, {"owner": {"reputation": 65, "user_id": 6466698, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/a2ccn.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/6466698/andre"}, "reply_to_user": {"reputation": 636, "user_id": 1253311, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/21acab710c6e17104c2af7bf8390a9d5?s=128&d=identicon&r=PG", "display_name": "Matt", "link": "https://stackoverflow.com/users/1253311/matt"}, "edited": false, "score": 0, "creation_date": 1473263635, "post_id": 39374243, "comment_id": 66076860, "body": "<code>a_beat_b</code> works like a <code>&lt;=&gt;</code>, returns 1 if team A has beat B this tournament. 0 if a draw, and -1 if B won. The code for <code>Array.sort</code> was like this, <code>teams.sort ( |a,b| [a.points, a.goals_dif, a.goals] &lt;=&gt; [b.points, b.goals_dif, b.goals])</code> Didn&#39;t know where to put my function. Will edit it in."}, {"owner": {"reputation": 208794, "user_id": 229044, "user_type": "moderator", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/591426cbbacd4025d920467bad356911?s=128&d=identicon&r=PG&f=1", "display_name": "meagar", "link": "https://stackoverflow.com/users/229044/meagar"}, "edited": false, "score": 0, "creation_date": 1473263636, "post_id": 39374243, "comment_id": 66076863, "body": "<code>Array#sort</code> is the right answer. You should check whether the arrays are identical and then conditionally use <code>a_beat_b</code> to to perform the more expensive comparison. Without seeing <i>how</i> you tried to implement <code>Array#sort</code>, we can&#39;t really help you."}, {"owner": {"reputation": 65, "user_id": 6466698, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/a2ccn.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/6466698/andre"}, "edited": false, "score": 0, "creation_date": 1473263898, "post_id": 39374243, "comment_id": 66077031, "body": "I&#39;ve edited it in, not sure how to write the sort one to use my function."}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1473264094, "post_id": 39374243, "comment_id": 66077187, "body": "Regarding the slowness: are <code>points</code>, <code>goals_dif</code> and <code>goals</code> expensive methods?"}, {"owner": {"reputation": 65, "user_id": 6466698, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/a2ccn.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/6466698/andre"}, "edited": false, "score": 0, "creation_date": 1473264289, "post_id": 39374243, "comment_id": 66077293, "body": "They just sum 2 simple queries, pretty fast, though all the DB access is bound to slow it down if they&#39;re called a lot."}], "answers": [{"comments": [{"owner": {"reputation": 65, "user_id": 6466698, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/a2ccn.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/6466698/andre"}, "edited": false, "score": 0, "creation_date": 1473264933, "post_id": 39374639, "comment_id": 66077678, "body": "That result.zero? thing looks great! This code definitely works, but that sort is still much slower than sort_by, it takes over 5 seconds compared to about 1. If this is the only possible way, I&#39;ll accept the answer."}], "tags": [], "owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "is_accepted": false, "score": 2, "last_activity_date": 1473264158, "creation_date": 1473264158, "answer_id": 39374639, "question_id": 39374243, "link": "https://stackoverflow.com/questions/39374243/ruby-array-sort-2-different-ways/39374639#39374639", "title": "Ruby Array Sort 2 different ways", "body": "<p>Implementation of <code>sort</code> with <code>a_beats_b</code> included:</p>\n\n<pre><code>teams.sort do |a, b|\n  result = [a.points, a.goals_dif, a.goals] &lt;=&gt; [b.points, b.goals_dif, b.goals]\n  result.zero? ? a_beats_b(a, b) : result\nend\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 65, "user_id": 6466698, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/a2ccn.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/6466698/andre"}, "edited": false, "score": 0, "creation_date": 1473285458, "post_id": 39376361, "comment_id": 66087115, "body": "Wow, I really have to study what you did there. I already knew about the difference between the sort functions, but there&#39;s a lot of awesomeness here. Either way, this is the answer. Thanks!"}], "tags": [], "owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "is_accepted": true, "score": 3, "last_activity_date": 1473322532, "last_edit_date": 1473322532, "creation_date": 1473270724, "answer_id": 39376361, "question_id": 39374243, "link": "https://stackoverflow.com/questions/39374243/ruby-array-sort-2-different-ways/39376361#39376361", "title": "Ruby Array Sort 2 different ways", "body": "<blockquote>\n  <p>I tried using <code>Array.sort</code>, but it's extremely slow compared to <code>sort_by</code> for those first few</p>\n</blockquote>\n\n<p>This is because <code>sort</code> calls the given block several times. Here's an example to show what's going on under the hood: (sorting <code>\"apple\"</code>, <code>\"pear\"</code> and <code>\"fig\"</code> by length)</p>\n\n<pre><code>def length(str)\n  puts \"calculating #{str.inspect}.length\"\n  str.length\nend\n\narray = %w{apple pear fig}\narray.sort { |a, b| length(a) &lt;=&gt; length(b) }\n#=&gt; [\"fig\", \"pear\", \"apple\"]\n</code></pre>\n\n<p>Output from our <code>length</code> method:</p>\n\n<pre><code>calculating \"apple\".length\ncalculating \"pear\".length\ncalculating \"apple\".length\ncalculating \"fig\".length\ncalculating \"pear\".length\ncalculating \"fig\".length\n</code></pre>\n\n<p>As you can see, <code>length</code> is called multiple times during the sort. Imagine that these are database queries.</p>\n\n<p><code>sort_by</code> on the other hand calls the block once for each element, building an internal mapping:</p>\n\n<pre><code>array.sort_by { |a| length(a) }\n#=&gt; [\"fig\", \"pear\", \"apple\"]\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>calculating \"apple\".length\ncalculating \"pear\".length\ncalculating \"fig\".length\n</code></pre>\n\n<p>For expensive operations (like database queries), this is much faster. But it's also less flexible \u2013 you can't dynamically compare <code>a</code> and <code>b</code> any more.</p>\n\n<p>You can however store the results of your (expensive) operation, for example by using a hash: (this is called <a href=\"https://en.wikipedia.org/wiki/Memoization\" rel=\"nofollow\">memoization</a>)</p>\n\n<pre><code>hash = Hash.new { |h, k| h[k] = length(k) }\n</code></pre>\n\n<p>And use the hash within <code>sort</code>:</p>\n\n<pre><code>array.sort { |a, b| hash[a] &lt;=&gt; hash[b] }\n# calculating \"apple\".length\n# calculating \"pear\".length\n# calculating \"fig\".length\n#=&gt; [\"fig\", \"pear\", \"apple\"]\n</code></pre>\n\n<p>After the sort, our hash looks like this:</p>\n\n<pre><code>hash #=&gt; {\"apple\"=&gt;5, \"pear\"=&gt;4, \"fig\"=&gt;3}\n</code></pre>\n\n<p>Applied to your code, something like this should work:</p>\n\n<pre><code>hash = Hash.new { |h, k| h[k] = [k.points, k.goal_dif, k.goals] }\nteams.sort { |a, b| hash[a] == hash[b] ? a_beats_b(a, b) : hash[a] &lt;=&gt; hash[b] }\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "is_accepted": false, "score": 2, "last_activity_date": 1473289992, "creation_date": 1473289992, "answer_id": 39380323, "question_id": 39374243, "link": "https://stackoverflow.com/questions/39374243/ruby-array-sort-2-different-ways/39380323#39380323", "title": "Ruby Array Sort 2 different ways", "body": "<p>Here's another approach that, while somewhat complex, has been designed for efficiency. The method uses the following steps.</p>\n\n<ul>\n<li>Convert each <code>Team</code> instance to to an array containing the instance and the three-element array on which the inexpensive sort is to be done.</li>\n<li>Use <a href=\"http://ruby-doc.org/core-2.3.0/Enumerable.html#method-i-sort_by\" rel=\"nofollow\">Enumerable#sort_by</a> to sort the arrays by the three-element arrays.</li>\n<li>Use <a href=\"http://ruby-doc.org/core-2.3.0/Enumerable.html#method-i-chunk\" rel=\"nofollow\">Enumerable#chunk</a> to group the two-element arrays that have equal three-element arrays.</li>\n<li>Map each chunked array element to the <code>Team</code> instance in the two-element array.  </li>\n<li>Use <a href=\"http://ruby-doc.org/core-2.3.0/Enumerable.html#method-i-flat_map\" rel=\"nofollow\">Enumerable#flat_map</a> to map each chunked group of <code>Team</code> instances after it has been sorted by the method <code>a_beat_b(a, b)</code> (unless the group contains only one team, of course).  </li>\n</ul>\n\n<p><strong>Code</strong></p>\n\n<pre><code>def sort_em(teams)\n  teams.map { |t| [t, [t.points, t.goal_dif, t.goals]] }.\n        sort_by(&amp;:last).\n        chunk(&amp;:last).\n        map { |_,tied_teams| tied_teams.map(&amp;:first) }.\n        flat_map { |tied_teams| (tied_teams.size == 1) ?\n          tied_teams.first : tied_teams.sort { |a,b| a_beat_b(a, b) } }\nend\n</code></pre>\n\n<p><strong>Example</strong></p>\n\n<pre><code>class Team\n  attr_reader :name, :points, :goal_dif, :goals\n  def initialize(name, points, goal_dif, goals)\n    @name, @points, @goal_dif, @goals = name, points, goal_dif, goals\n  end\nend\n\nteams = [Team.new(\"bluebirds\", 233, 25, 130),\n         Team.new(\"eagles\",    233, 18, 105),\n         Team.new(\"jays\",      233, 25, 130),\n         Team.new(\"owls\",      160, 12, 105),\n         Team.new(\"sparrows\",  233, 18, 105)\n        ]\n  #=&gt; [#&lt;Team:0x007ff2f900e5a8 @name=\"bluebirds\", @points=233, @goal_dif=25, @goals=130&gt;,\n  #    #&lt;Team:0x007ff2f900e530 @name=\"eagles\", @points=233, @goal_dif=18, @goals=105&gt;,\n  #    #&lt;Team:0x007ff2f900e4b8 @name=\"jays\", @points=233, @goal_dif=25, @goals=130&gt;,\n  #    #&lt;Team:0x007ff2f900e440 @name=\"owls\", @points=160, @goal_dif=12, @goals=105&gt;,\n  #    #&lt;Team:0x007ff2f900e3c8 @name=\"sparrows\", @points=233, @goal_dif=18, @goals=105&gt;]\n\ndef a_beat_b(a, b)\n  a.name.size &lt;=&gt; b.name.size\nend\n\nsort_em(teams)\n  #=&gt; [#&lt;Team:0x007ff2fa845630 @name=\"owls\", @points=160, @goal_dif=12, @goals=105&gt;,\n  #    #&lt;Team:0x007ff2fa845720 @name=\"eagles\", @points=233, @goal_dif=18, @goals=105&gt;,\n  #    #&lt;Team:0x007ff2fa8455b8 @name=\"sparrows\", @points=233, @goal_dif=18, @goals=105&gt;,\n  #    #&lt;Team:0x007ff2fa8456a8 @name=\"jays\", @points=233, @goal_dif=25, @goals=130&gt;,\n  #    #&lt;Team:0x007ff2fa8457e8 @name=\"bluebirds\", @points=233, @goal_dif=25, @goals=130&gt;]\n</code></pre>\n\n<p><strong>Explanation</strong></p>\n\n<p>The steps are as follows.</p>\n\n<pre><code>a = teams.map { |t| [t, [t.points, t.goal_dif, t.goals]] }\n  #=&gt; [[#&lt;Team:0x007ff2fa8457e8 @name=\"bluebirds\", @points=233, @goal_dif=25, @goals=130&gt;,\n  #     [233, 25, 130]],\n  #    [#&lt;Team:0x007ff2fa845720 @name=\"eagles\", @points=233, @goal_dif=18, @goals=105&gt;,\n  #     [233, 18, 105]],\n  #    [#&lt;Team:0x007ff2fa8456a8 @name=\"jays\", @points=233, @goal_dif=25, @goals=130&gt;,\n  #     [233, 25, 130]],\n  #    [#&lt;Team:0x007ff2fa845630 @name=\"owls\", @points=160, @goal_dif=12, @goals=105&gt;,\n  #     [160, 12, 105]],\n  #    [#&lt;Team:0x007ff2fa8455b8 @name=\"sparrows\", @points=233, @goal_dif=18, @goals=105&gt;,\n  #     [233, 18, 105]]] \nb = a.sort_by(&amp;:last)\n  #=&gt; [[#&lt;Team:0x007ff2fa845630 @name=\"owls\", @points=160, @goal_dif=12, @goals=105&gt;,\n  #    [160, 12, 105]],\n  #   [#&lt;Team:0x007ff2fa845720 @name=\"eagles\", @points=233, @goal_dif=18, @goals=105&gt;,\n  #    [233, 18, 105]],\n  #   [#&lt;Team:0x007ff2fa8455b8 @name=\"sparrows\", @points=233, @goal_dif=18, @goals=105&gt;,\n  #    [233, 18, 105]],\n  #   [#&lt;Team:0x007ff2fa8457e8 @name=\"bluebirds\", @points=233, @goal_dif=25, @goals=130&gt;,\n  #    [233, 25, 130]],\n  #   [#&lt;Team:0x007ff2fa8456a8 @name=\"jays\", @points=233, @goal_dif=25, @goals=130&gt;,\n  #    [233, 25, 130]]\n  #   ] \nc = b.chunk(&amp;:last)\n  #=&gt; #&lt;Enumerator: #&lt;Enumerator::Generator:0x007ff2fa81dc20&gt;:each&gt; \n</code></pre>\n\n<p>To see what values are generated by the enumerator <code>c</code> we can convert it to an array.</p>\n\n<pre><code>c.to_a \n  #=&gt; [[[160, 12, 105],\n  #     [[#&lt;Team:0x007ff2fa845630 @name=\"owls\",@points=160,@goal_dif=12,@goals=105&gt;,\n  #       [160, 12, 105]\n  #      ]\n  #     ]\n  #    ],\n  #    [[233, 18, 105],\n  #     [[#&lt;Team:0x007ff2fa845720 @name=\"eagles\",@points=233,@goal_dif=18,@goals=105&gt;,\n  #       [233, 18, 105]\n  #      ],\n  #     [#&lt;Team:0x007ff2fa8455b8 @name=\"sparrows\",@points=233,@goal_dif=18,@goals=105&gt;,\n  #       [233, 18, 105]\n  #     ]\n  #    ],\n  #    [[233, 25, 130],\n  #     [[#&lt;Team:0x007ff2fa8457e8 @name=\"bluebirds\",@points=233,@goal_dif=25,@goals=130&gt;,\n  #       [233, 25, 130]\n  #      ],\n  #      [#&lt;Team:0x007ff2fa8456a8 @name=\"jays\", @points=233,@goal_dif=25,@goals=130&gt;,\n  #       [233, 25, 130]\n  #      ]\n  #     ]\n  #    ]\n  #   ]\n</code></pre>\n\n<p></p>\n\n<pre><code>d = c.map { |_,tied_teams| tied_teams.map(&amp;:first) }\n  #=&gt; [[#&lt;Team:0x007ff2fa845630 @name=\"owls\", @points=160, @goal_dif=12, @goals=105&gt;],\n  #    [#&lt;Team:0x007ff2fa845720 @name=\"eagles\", @points=233, @goal_dif=18, @goals=105&gt;,\n  #     #&lt;Team:0x007ff2fa8455b8 @name=\"sparrows\", @points=233, @goal_dif=18, @goals=105&gt;\n  #    ],\n  #    [#&lt;Team:0x007ff2fa8457e8 @name=\"bluebirds\", @points=233, @goal_dif=25, @goals=130&gt;,\n  #     #&lt;Team:0x007ff2fa8456a8 @name=\"jays\", @points=233, @goal_dif=25, @goals=130&gt;\n  #    ]\n  #   ] \nd.flat_map { |tied_teams| (tied_teams.size == 1) ?\n  tied_teams.first : tied_teams.sort { |a,b| a_beat_b(a, b) } }\n  #=&gt; [#&lt;Team:0x007ff2fa845630 @name=\"owls\", @points=160, @goal_dif=12, @goals=105&gt;,\n  #    #&lt;Team:0x007ff2fa845720 @name=\"eagles\", @points=233, @goal_dif=18, @goals=105&gt;,\n  #    #&lt;Team:0x007ff2fa8455b8 @name=\"sparrows\", @points=233, @goal_dif=18, @goals=105&gt;,\n  #    #&lt;Team:0x007ff2fa8456a8 @name=\"jays\", @points=233, @goal_dif=25, @goals=130&gt;,\n  #    #&lt;Team:0x007ff2fa8457e8 @name=\"bluebirds\", @points=233, @goal_dif=25, @goals=130&gt;\n  #   ] \n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 11718, "user_id": 1827631, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/I24JN.png?s=128&g=1", "display_name": "hirolau", "link": "https://stackoverflow.com/users/1827631/hirolau"}, "is_accepted": false, "score": 0, "last_activity_date": 1473323476, "creation_date": 1473323476, "answer_id": 39386156, "question_id": 39374243, "link": "https://stackoverflow.com/questions/39374243/ruby-array-sort-2-different-ways/39386156#39386156", "title": "Ruby Array Sort 2 different ways", "body": "<p>Depending on the size and const of the sorting function this might be an approach:</p>\n\n<pre><code># First group the teams by standard sort:\ngroups = teams.group_by{|a| [a.points, a.goals_dif, a.goals] }\n\n# For each group that has ties. Run the slow sorter on them:\ngroups.each{ |_,val| val.sort!{|teamA,teamB| a_beat_b(teamA, teamB)} if val.size &gt; 1 }\n\n# Finally run sort on the keys of the group by:\ngroups.sort.flat_map(&amp;:last)\n</code></pre>\n"}], "owner": {"reputation": 65, "user_id": 6466698, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/a2ccn.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/6466698/andre"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 134, "favorite_count": 1, "accepted_answer_id": 39376361, "answer_count": 4, "score": 5, "last_activity_date": 1473323476, "creation_date": 1473263031, "last_edit_date": 1473265750, "question_id": 39374243, "link": "https://stackoverflow.com/questions/39374243/ruby-array-sort-2-different-ways", "title": "Ruby Array Sort 2 different ways", "body": "<p>I have an array of objects that I'm trying to sort by multiple criteria. Most of the comparisons are just by doing <code>&lt;=&gt;</code> on their hashes, so using <code>sort_by</code> is very fast, but one of them is more complex.</p>\n\n<p>The array is of soccer teams, and it's currently being sorted like this:</p>\n\n<pre><code>teams.sort_by { |item| [item.points, item.goal_dif, item.goals] }\n</code></pre>\n\n<p>However, in case at last 2 teams have identical values on those 3 fields, I want the tiebreaker to be a function that I made, <code>a_beat_b(teamA, teamB)</code>.</p>\n\n<p>I tried using <code>Array.sort</code>, but it's extremely slow compared to <code>sort_by</code> for those first few... My implementation was like this:</p>\n\n<p><code>teams.sort ( |a,b| [a.points, a.goals_dif, a.goals] &lt;=&gt; [b.points, b.goals_dif, b.goals])</code><br>\nIt was very slow compared to sort_by. The functions for points, goals_dif and goals require some simple queries, but it gets bogged down if it has to do hundreds.</p>\n\n<p>I'm not very good at Ruby, so not sure where to put my <code>a_beats_b</code> in there. (It returns 1, 0 or -1 if A beat, drew or lost to B, repsectively)</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 38307, "user_id": 2057388, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ceef8c04f66cd0e2bd360ef6abc14a81?s=128&d=identicon&r=PG", "display_name": "\u0417\u0435\u043b\u0451\u043d\u044b\u0439", "link": "https://stackoverflow.com/users/2057388/%d0%97%d0%b5%d0%bb%d1%91%d0%bd%d1%8b%d0%b9"}, "edited": false, "score": 0, "creation_date": 1473262947, "post_id": 39374154, "comment_id": 66076443, "body": "According to your path <code>&#47;field_data&#47;index&#47;12</code> the id <code>12</code> should be in <code>params</code> have you seen it?"}], "answers": [{"comments": [{"owner": {"reputation": 38307, "user_id": 2057388, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ceef8c04f66cd0e2bd360ef6abc14a81?s=128&d=identicon&r=PG", "display_name": "\u0417\u0435\u043b\u0451\u043d\u044b\u0439", "link": "https://stackoverflow.com/users/2057388/%d0%97%d0%b5%d0%bb%d1%91%d0%bd%d1%8b%d0%b9"}, "edited": false, "score": 0, "creation_date": 1473263082, "post_id": 39374234, "comment_id": 66076516, "body": "I assume <code>&#47;field_data&#47;:key_id</code> not <code>&#47;field_data&#47;index&#47;:key_id</code>, OP edit the question since."}, {"owner": {"reputation": 313, "user_id": 6525065, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/eccf7c6b499cb49febded630ea17e466?s=128&d=identicon&r=PG&f=1", "display_name": "lilixiaocc", "link": "https://stackoverflow.com/users/6525065/lilixiaocc"}, "edited": false, "score": 0, "creation_date": 1473263491, "post_id": 39374234, "comment_id": 66076762, "body": "sorry for the confusion, thank you for the comment.  this works perfectly, only need to change a little bit, in routes  <code>to: &quot;field_data#index&quot;</code>  I realized that <b>data</b> is plural of <b>datum</b> when I do the project,"}, {"owner": {"reputation": 9878, "user_id": 3315785, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/YsMo6.jpg?s=128&g=1", "display_name": "j-dexx", "link": "https://stackoverflow.com/users/3315785/j-dexx"}, "reply_to_user": {"reputation": 38307, "user_id": 2057388, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ceef8c04f66cd0e2bd360ef6abc14a81?s=128&d=identicon&r=PG", "display_name": "\u0417\u0435\u043b\u0451\u043d\u044b\u0439", "link": "https://stackoverflow.com/users/2057388/%d0%97%d0%b5%d0%bb%d1%91%d0%bd%d1%8b%d0%b9"}, "edited": false, "score": 0, "creation_date": 1473319180, "post_id": 39374234, "comment_id": 66096624, "body": "@\u0417\u0435\u043b\u0451\u043d\u044b\u0439 if that were the case I would just use a normal resources route and use the show action personally."}], "tags": [], "owner": {"reputation": 9878, "user_id": 3315785, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/YsMo6.jpg?s=128&g=1", "display_name": "j-dexx", "link": "https://stackoverflow.com/users/3315785/j-dexx"}, "is_accepted": false, "score": 4, "last_activity_date": 1473263005, "creation_date": 1473263005, "answer_id": 39374234, "question_id": 39374154, "link": "https://stackoverflow.com/questions/39374154/how-to-pass-an-id-in-url-to-controller-rails/39374234#39374234", "title": "How to pass an id in URL to controller? Rails", "body": "<p>routes</p>\n\n<pre><code>get \"/field_data/index/:key_id\", to: \"field_datas#index\"\n</code></pre>\n\n<p>controller</p>\n\n<pre><code>def index \n  @field_data = FieldDatum.select('field_content').where(key_id: params[:key_id])\nend\n</code></pre>\n"}], "owner": {"reputation": 313, "user_id": 6525065, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/eccf7c6b499cb49febded630ea17e466?s=128&d=identicon&r=PG&f=1", "display_name": "lilixiaocc", "link": "https://stackoverflow.com/users/6525065/lilixiaocc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 872, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1473263005, "creation_date": 1473262771, "last_edit_date": 1473262992, "question_id": 39374154, "link": "https://stackoverflow.com/questions/39374154/how-to-pass-an-id-in-url-to-controller-rails", "title": "How to pass an id in URL to controller? Rails", "body": "<p>I want to deal with some data rows with same <code>key_id</code>. I want them to get select by using an id in URL, so I will have <code>/field_data/index/12</code> and 12 here means the <code>key_id</code>. </p>\n\n<p>I can manually do it in the controller by hardcoding the <code>key_id</code></p>\n\n<pre><code>def index \n    @key_id = 12\n    @field_data = FieldDatum.select('field_content').where(\"key_id = ?\", @key_id)\nend\n</code></pre>\n\n<p>and my URL is very general: <code>/field_data</code></p>\n\n<p>So how to make it be able to get the id in URL?</p>\n"}, {"tags": ["ruby", "capybara"], "comments": [{"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1473262981, "post_id": 39374143, "comment_id": 66076458, "body": "Don&#39;t assign the result of <code>visit</code> to <code>page</code>. Just call <code>visit &quot;...&quot;</code> without <code>page = </code>."}, {"owner": {"reputation": 426, "user_id": 6075414, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/88da80c1fa9924757e7c07475d56e6de?s=128&d=identicon&r=PG", "display_name": "NeyLive", "link": "https://stackoverflow.com/users/6075414/neylive"}, "reply_to_user": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1473264455, "post_id": 39374143, "comment_id": 66077393, "body": "I still get the error <code>Capybara::ElementNotFound: Unable to find field &quot;#txtQty&quot;</code>"}], "answers": [{"comments": [{"owner": {"reputation": 426, "user_id": 6075414, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/88da80c1fa9924757e7c07475d56e6de?s=128&d=identicon&r=PG", "display_name": "NeyLive", "link": "https://stackoverflow.com/users/6075414/neylive"}, "edited": false, "score": 0, "creation_date": 1473269373, "post_id": 39375429, "comment_id": 66079969, "body": "Thanks for your answer, it&#39;s much clearer than the Capybara docs. I have implemented your suggestions, but am getting <code>NoMethodError: undefined method &#39;expect&#39;</code> Isn&#39;t expect an RSpec method?"}, {"owner": {"reputation": 42014, "user_id": 2709090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/238c2b7cde2c817fc9a5a2b8eaa2ffad?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Walpole", "link": "https://stackoverflow.com/users/2709090/thomas-walpole"}, "reply_to_user": {"reputation": 426, "user_id": 6075414, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/88da80c1fa9924757e7c07475d56e6de?s=128&d=identicon&r=PG", "display_name": "NeyLive", "link": "https://stackoverflow.com/users/6075414/neylive"}, "edited": false, "score": 0, "creation_date": 1473269512, "post_id": 39375429, "comment_id": 66080028, "body": "@NeyLive Whoops - yes it is -- I&#39;ve updated the answer to not use RSpec"}, {"owner": {"reputation": 426, "user_id": 6075414, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/88da80c1fa9924757e7c07475d56e6de?s=128&d=identicon&r=PG", "display_name": "NeyLive", "link": "https://stackoverflow.com/users/6075414/neylive"}, "edited": false, "score": 0, "creation_date": 1473339606, "post_id": 39375429, "comment_id": 66109311, "body": "Thank you! That sorted it!"}], "tags": [], "owner": {"reputation": 42014, "user_id": 2709090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/238c2b7cde2c817fc9a5a2b8eaa2ffad?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Walpole", "link": "https://stackoverflow.com/users/2709090/thomas-walpole"}, "is_accepted": true, "score": 1, "last_activity_date": 1473269493, "last_edit_date": 1473269493, "creation_date": 1473266940, "answer_id": 39375429, "question_id": 39374143, "link": "https://stackoverflow.com/questions/39374143/capybara-find-field-has-selector-not-working/39375429#39375429", "title": "Capybara find_field &amp; has_selector not working", "body": "<p>You have a couple of issues in your code</p>\n\n<ol>\n<li><p>page is just an alias for Capybara.current_session.  If you assign to it you're creating a local variable and it's no longer a session</p></li>\n<li><p>find_field takes a locator - <a href=\"http://www.rubydoc.info/gems/capybara/Capybara/Node/Finders#find_field-instance_method\" rel=\"nofollow\">http://www.rubydoc.info/gems/capybara/Capybara/Node/Finders#find_field-instance_method</a> - which will be matched against the id, name, or label text. It does not take a CSS selector</p></li>\n</ol>\n\n<p>Your code should be</p>\n\n<pre><code>page.visit \"http://www.my-url-here.com\"   \nnext if page.has_selector?('#divOutStock')\npage.find_field('txtQty').set('9999')\n</code></pre>\n\n<p>and you could rewrite the last line as</p>\n\n<pre><code>page.fill_in('txtQty', with: '9999')\n</code></pre>\n\n<p>Also you should note that (if using a JS capable driver) <code>has_selector?</code> will wait up to Capybara.default_max_wait_time for the #divOutStock to appear.  If it's not usually going to be there and you want to speed things up a bit you could do something like</p>\n\n<pre><code>page.visit \"http://www.my-url-here.com\"   \npage.assert_text('Something always on page once loaded') #ensure/wait until page is loaded\nnext if page.has_selector?('#divOutStock', wait: 0) # check for existence and don't retry\npage.fill_in('txtQty', with: '9999')\n</code></pre>\n"}], "owner": {"reputation": 426, "user_id": 6075414, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/88da80c1fa9924757e7c07475d56e6de?s=128&d=identicon&r=PG", "display_name": "NeyLive", "link": "https://stackoverflow.com/users/6075414/neylive"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 308, "favorite_count": 0, "accepted_answer_id": 39375429, "answer_count": 1, "score": 0, "last_activity_date": 1473269493, "creation_date": 1473262753, "question_id": 39374143, "link": "https://stackoverflow.com/questions/39374143/capybara-find-field-has-selector-not-working", "title": "Capybara find_field &amp; has_selector not working", "body": "<p>I am using Capybara and getting errors from the finders 'find_field' &amp; 'has_selector'.</p>\n\n<p>I have tried using them like this:</p>\n\n<pre><code>page = visit \"http://www.my-url-here.com\"   \nnext if page.has_selector?('#divOutStock')\npage.find_field('#txtQty').set('9999')\n</code></pre>\n\n<p>has_selector returns the error: \"NoMethodError: undefined method `has_selector?' for {\"status\"=>\"success\"}:Hash\"</p>\n\n<p>find_field cannot find the field. (It is present on the page and is not a hidden field.)</p>\n\n<p>I have also tried using fill_in to set the field value, that doesn't work either.</p>\n\n<p>How can I get this to work with Capybara?</p>\n"}, {"tags": ["ruby", "authlogic"], "comments": [{"owner": {"reputation": 13756, "user_id": 567762, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/908c9abc72ab86111a153b11cb584f26?s=128&d=identicon&r=PG", "display_name": "Jared Beck", "link": "https://stackoverflow.com/users/567762/jared-beck"}, "edited": false, "score": 0, "creation_date": 1473262340, "post_id": 39373886, "comment_id": 66076015, "body": "Check out <code>lib&#47;authlogic&#47;test_case.rb</code> which uses a mock controller."}], "owner": {"reputation": 318, "user_id": 49807, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/d654e843c62f59b15952cb1c5135f63a?s=128&d=identicon&r=PG", "display_name": "Ton\u010di D.", "link": "https://stackoverflow.com/users/49807/ton%c4%8di-d"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 32, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1473261936, "creation_date": 1473261936, "question_id": 39373886, "link": "https://stackoverflow.com/questions/39373886/using-authlogic-in-a-non-rails-environment", "title": "Using Authlogic in a non-Rails environment", "body": "<p>What would be the best way to use Authlogic in a non-Rails environment? In other words, how to validate credentials from within a Ruby script?</p>\n\n<p>When run from console, <code>self</code> refers to a \"main\" <code>Object</code>, hence Authlogic initialization is pointless:</p>\n\n<pre><code>2.3.1 :009 &gt; Authlogic::Session::Base.controller = Authlogic::ControllerAdapters::RailsAdapter.new(self)\n</code></pre>\n\n<p>It expects to be initialized with a controller, because it needs <code>request</code> and <code>ip</code> and probably other stuff. This is very strange to see, because <code>UserSession</code> is a model and should not be coupled with a controller.</p>\n\n<p>Any suggestions on how to validate credentials?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "factory-bot", "timecop"], "answers": [{"comments": [{"owner": {"reputation": 14010, "user_id": 3109182, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/a4b305f0077055b4fdcf715067775d5a?s=128&d=identicon&r=PG", "display_name": "Anthony", "link": "https://stackoverflow.com/users/3109182/anthony"}, "edited": false, "score": 1, "creation_date": 1473266695, "post_id": 39375304, "comment_id": 66078590, "body": "yep - was just going to say something similar.  It&#39;s more that <code>Date.today.year</code> is evaluated upon initialization than at runtime which is the issue."}, {"owner": {"reputation": 6076, "user_id": 4044009, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/42e57031eb7d02c47c9afaecfc878638?s=128&d=identicon&r=PG&f=1", "display_name": "Neil", "link": "https://stackoverflow.com/users/4044009/neil"}, "reply_to_user": {"reputation": 14010, "user_id": 3109182, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/a4b305f0077055b4fdcf715067775d5a?s=128&d=identicon&r=PG", "display_name": "Anthony", "link": "https://stackoverflow.com/users/3109182/anthony"}, "edited": false, "score": 0, "creation_date": 1473266750, "post_id": 39375304, "comment_id": 66078616, "body": "@Anthony thanks for the correction.  I&#39;ll change that to be more precise."}], "tags": [], "owner": {"reputation": 6076, "user_id": 4044009, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/42e57031eb7d02c47c9afaecfc878638?s=128&d=identicon&r=PG&f=1", "display_name": "Neil", "link": "https://stackoverflow.com/users/4044009/neil"}, "is_accepted": true, "score": 2, "last_activity_date": 1473266875, "last_edit_date": 1473266875, "creation_date": 1473266473, "answer_id": 39375304, "question_id": 39373472, "link": "https://stackoverflow.com/questions/39373472/timecop-with-factory-girl-factory-not-sequencing-date-attribute-as-expected/39375304#39375304", "title": "Timecop with Factory_girl: factory not sequencing date attribute as expected", "body": "<p>The issue was with the second argument I was passing into the <code>sequence</code> method. That argument is static/evaluated at initialization.  It is not dynamic, so <code>timecop</code> did not have the chance to stub out the date before that second argument is evaluated.</p>\n\n<pre><code>trait(:sequenced_end_date) {sequence(:end_date, Date.today.year + 1)  {|n| Date.new(n, 9, 30) }}\n</code></pre>\n\n<p>That <code>Date.today.year</code> part of the second argument being passed into the <code>sequence</code> method is static and evaluated at initialization.  It is not dynamic and is already evaluated before the method is even called. </p>\n\n<p>I simply needed to change those methods to the following:  </p>\n\n<pre><code>trait(:sequenced_year_start_date) {sequence(:start_date)  {|n| Date.new(Date.today.year, 10, 1) }}\ntrait(:sequenced_year_end_date)   {sequence(:end_date)    {|n| Date.new(Date.today.year + n, 9, 30) }}\n</code></pre>\n\n<p>Now it works as expected and returns the following:</p>\n\n<pre><code>Today's frozen date thanks to Timecop: 01/01/2010\nSequenced Date: 09/30/2011\n</code></pre>\n\n<p>Blocks are dynamic, so calling <code>Date.today.year + n</code> within the block gives timecop the chance to first stub out <code>Date</code> before this block is executed. </p>\n"}], "owner": {"reputation": 6076, "user_id": 4044009, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/42e57031eb7d02c47c9afaecfc878638?s=128&d=identicon&r=PG&f=1", "display_name": "Neil", "link": "https://stackoverflow.com/users/4044009/neil"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 499, "favorite_count": 0, "accepted_answer_id": 39375304, "answer_count": 1, "score": 2, "last_activity_date": 1473266875, "creation_date": 1473260800, "question_id": 39373472, "link": "https://stackoverflow.com/questions/39373472/timecop-with-factory-girl-factory-not-sequencing-date-attribute-as-expected", "title": "Timecop with Factory_girl: factory not sequencing date attribute as expected", "body": "<p>I am using the <a href=\"https://rubygems.org/gems/timecop\" rel=\"nofollow\">timecop</a> gem in order to stub out dates.  I am also using <a href=\"https://rubygems.org/gems/factory_girl_rails\" rel=\"nofollow\">factory_girl</a> in order to make creating objects for my specs easier.</p>\n\n<p>Here is my factory:</p>\n\n<pre><code>FactoryGirl.define do\n  factory :fiscal_year do\n    start_date  {Date.today}\n    end_date    {Date.today + 1.day}\n\n    trait(:sequenced_start_date) {sequence(:start_date, Date.today.year)  {|n| Date.new(n, 10, 1) }}\n    trait(:sequenced_end_date)   {sequence(:end_date,   Date.today.year + 1)  {|n| Date.new(n, 9, 30) }}\n\n\n    factory :sequenced_fiscal_year, parent: :fiscal_year,\n            traits: [:sequenced_start_date, :sequenced_end_date]\n  end\nend\n</code></pre>\n\n<p>Assume that today's <strong>actual</strong> date is 09/07/2016.</p>\n\n<p>Here is my spec:</p>\n\n<pre><code>RSpec.describe FiscalYear, type: :model do\n  before(:example) do\n    Timecop.freeze(Time.local(2010))\n  end\n  after do\n    Timecop.return\n  end\n\n  describe \"fake spec to show unexpected sequence behavior\" do\n    it \"tests something\" do\n      puts \"Today's frozen date thanks to Timecop: #{Date.today}\"\n      fiscal_year = create(:sequenced_fiscal_year)\n      puts \"Sequenced Date: #{fiscal_year.end_date}\"\n    end\n  end\nend\n</code></pre>\n\n<p>When the spec is run here is the output:</p>\n\n<pre><code>Today's frozen date thanks to Timecop: 01/01/2010\nSequenced Date: 09/30/2017\n</code></pre>\n\n<p>In the first output line: Timecop works as expected when I call <code>Date.today</code>.  It has successfully frozen the time and returns that frozen time.</p>\n\n<p>However: the second line does not work as expected.  It is clearly using the system <code>Date</code> as opposed to Timecop's frozen <code>Date</code>.  The sequenced <code>end_date</code> should sequentially add +1 year to the currently frozen Date.  Therefore: I expect the <code>end_date</code> here to be <code>09/30/2011</code>, as opposed to <code>09/30/2017</code>.  </p>\n\n<p>How can I make it so that the sequenced <code>end_date</code> attribute goes off of Timecop's <code>Date</code> as opposed to the system's <code>Date</code>?</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 2958, "user_id": 3597730, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/d76b8f632aeb1d920d79d7dd5ab63097?s=128&d=identicon&r=PG", "display_name": "ruby_newbie", "link": "https://stackoverflow.com/users/3597730/ruby-newbie"}, "edited": false, "score": 0, "creation_date": 1473260831, "post_id": 39373391, "comment_id": 66075020, "body": "Where are you setting @time_opened?  I don&#39;t think this is the best approach for what you are trying to accomplish but I don&#39;t think you are ever setting a value for @time_opened"}], "answers": [{"comments": [{"owner": {"reputation": 45322, "user_id": 421705, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/581b1760881c962648f99d6040d41829?s=128&d=identicon&r=PG", "display_name": "Holger Just", "link": "https://stackoverflow.com/users/421705/holger-just"}, "edited": false, "score": 0, "creation_date": 1473263176, "post_id": 39373479, "comment_id": 66076578, "body": "You could also use class variables. These are kept between requests but are still not shared between different application server processes. A more common solution is to use a logging system or at least add/update a database record on each visit."}, {"owner": {"reputation": 208794, "user_id": 229044, "user_type": "moderator", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/591426cbbacd4025d920467bad356911?s=128&d=identicon&r=PG&f=1", "display_name": "meagar", "link": "https://stackoverflow.com/users/229044/meagar"}, "reply_to_user": {"reputation": 45322, "user_id": 421705, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/581b1760881c962648f99d6040d41829?s=128&d=identicon&r=PG", "display_name": "Holger Just", "link": "https://stackoverflow.com/users/421705/holger-just"}, "edited": false, "score": 0, "creation_date": 1473263262, "post_id": 39373479, "comment_id": 66076635, "body": "@HolgerJust You <i>could</i>, but you absolutely shouldn&#39;t, so it&#39;s really not worth mentioning."}], "tags": [], "owner": {"reputation": 208794, "user_id": 229044, "user_type": "moderator", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/591426cbbacd4025d920467bad356911?s=128&d=identicon&r=PG&f=1", "display_name": "meagar", "link": "https://stackoverflow.com/users/229044/meagar"}, "is_accepted": true, "score": 7, "last_activity_date": 1473263060, "last_edit_date": 1473263060, "creation_date": 1473260829, "answer_id": 39373479, "question_id": 39373391, "link": "https://stackoverflow.com/questions/39373391/ruby-instance-variables-nil/39373479#39373479", "title": "Ruby instance variables nil", "body": "<p>You can't share state across requests using instance variables. Your controller instance is completely destroyed at the end of each request, and a new instance of your controller is created the next time a request is routed to one of its actions.</p>\n\n<p>If you want to persist data, you need to either use <a href=\"http://guides.rubyonrails.org/action_controller_overview.html#session\" rel=\"noreferrer\"><code>session</code></a> or send the data to the client and persist it via <code>&lt;input type=\"hidden\"&gt;</code> fields, so it can be sent back with the subsequent request.</p>\n"}], "owner": {"reputation": 1076, "user_id": 5775965, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/98506e548d87020608ab5264f3d57703?s=128&d=identicon&r=PG&f=1", "display_name": "genghiskhan", "link": "https://stackoverflow.com/users/5775965/genghiskhan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 204, "favorite_count": 0, "accepted_answer_id": 39373479, "answer_count": 1, "score": 0, "last_activity_date": 1473263060, "creation_date": 1473260561, "question_id": 39373391, "link": "https://stackoverflow.com/questions/39373391/ruby-instance-variables-nil", "title": "Ruby instance variables nil", "body": "<p>I'm attempting to measure the amount of time spent on a page. I am trying to store the opening and closing times in instance variable of the controller; however, they either don't initialize or are nil. Here is my code:</p>\n\n<pre><code>def table\n    @numbers = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16]\n    if @time_opened.nil?\n        @time_opened = 1\n        @open_time = 0.0\n        @close_time = 0.0\n    else\n        @time_opened += 1\n    end\n\n    if @open_time &gt; 0.0\n        @close_time = Time.now\n    end\n\n    @visit = Visit.new({number: @number, time_spent: @close_time - @open_time})\n    @visit.save\nend\n\ndef show\n    url = request.url\n    @number = url[url.rindex('/')+1..-1]\n    @title = @number\n\n    @open_time = Time.now\nend\n</code></pre>\n\n<p>Show is called every time the page who's time I want to measure is displayed. When I check the visit data, number is nil and time_spent is 0.0.</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1473259781, "post_id": 39372951, "comment_id": 66074208, "body": "So... You need to write some logic using the <code>params</code> which were supplied by the user? What <code>params</code> are you collecting? What do you want to do with them?"}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1473259847, "post_id": 39372951, "comment_id": 66074260, "body": "I have never tried <code>write_xlsx</code> but based on the fact that you want some portion of a model to export I would highly recommend  <a href=\"https://github.com/randym/axlsx\" rel=\"nofollow noreferrer\"><code>axlsx</code></a> and <a href=\"https://github.com/straydogstudio/axlsx_rails\" rel=\"nofollow noreferrer\"><code>axlsx_rails</code></a> which implements a method called <code>acts_as_axlsx</code> and it will just take a <code>ActiveRecord::Relation</code> (meaning you can use query methods to filter) and output a xlsx from this."}, {"owner": {"reputation": 835, "user_id": 4920854, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/nKogO.png?s=128&g=1", "display_name": "Jonny Rimek", "link": "https://stackoverflow.com/users/4920854/jonny-rimek"}, "reply_to_user": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1473259911, "post_id": 39372951, "comment_id": 66074326, "body": "@TomLord it&#39;s not about the filtering itself, I can&#39;t even create the file. My step is to simulate a dynamic file but for now the content would be static. I just don&#39;t want to create the file on the server, send it to the customer and delete it afterwards"}, {"owner": {"reputation": 835, "user_id": 4920854, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/nKogO.png?s=128&g=1", "display_name": "Jonny Rimek", "link": "https://stackoverflow.com/users/4920854/jonny-rimek"}, "reply_to_user": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1473261586, "post_id": 39372951, "comment_id": 66075519, "body": "@engineersmnky I found that one later, prob gonna switch. thx"}], "answers": [{"tags": [], "owner": {"reputation": 11, "user_id": 8903368, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/13b7106aa344b74b44dd7c2d6b16e62a?s=128&d=identicon&r=PG&f=1", "display_name": "nakamura", "link": "https://stackoverflow.com/users/8903368/nakamura"}, "is_accepted": false, "score": 1, "last_activity_date": 1510102498, "creation_date": 1510102498, "answer_id": 47169843, "question_id": 39372951, "link": "https://stackoverflow.com/questions/39372951/creating-a-dynamic-xlsx-with-the-write-xlsx-gem/47169843#47169843", "title": "Creating a dynamic xlsx with the write_xlsx gem", "body": "<p>To save 'export.xlsx' to disk, you should use Workbook#close.\nsee generate_xlsx method below.</p>\n\n<pre><code>def generate_xlsx\n  workbook = WriteXLSX.new('export.xlsx')\n\n  worksheet = workbook.add_worksheet\n\n  worksheet.write(0, 0, 'status')\n  worksheet.write(0, 1, 'date')\n  worksheet.write(0, 2, 'customer')\n\n  workbook.close   # &lt;- Workbook#close\nend\n</code></pre>\n\n<p>you can read documents at <a href=\"http://cxn03651.github.io/write_xlsx/index.html\" rel=\"nofollow noreferrer\">http://cxn03651.github.io/write_xlsx/index.html</a>.</p>\n\n<p>enjoy!</p>\n"}], "owner": {"reputation": 835, "user_id": 4920854, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/nKogO.png?s=128&g=1", "display_name": "Jonny Rimek", "link": "https://stackoverflow.com/users/4920854/jonny-rimek"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1028, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1510102498, "creation_date": 1473259376, "last_edit_date": 1473259785, "question_id": 39372951, "link": "https://stackoverflow.com/questions/39372951/creating-a-dynamic-xlsx-with-the-write-xlsx-gem", "title": "Creating a dynamic xlsx with the write_xlsx gem", "body": "<p>I want to export a part of my db for the user as a .xlsx</p>\n\n<p>I managed to create a static file and let the user download it, but that's not really the point.</p>\n\n<p>The user should select the filter he wants and as a result the file should be created and downloaded directly through the browser.</p>\n\n<p>my code looks something like this:</p>\n\n<p>controller</p>\n\n<pre><code>def download_pdf\n  send_data generate_pdf,\n            type: \"application/xlsx\"\nend\n\nprivate\n\ndef generate_pdf\n  workbook = WriteXLSX.new('export.xlsx')\n\n  worksheet = workbook.add_worksheet\n\n  worksheet.write(0, 0, 'status')\n  worksheet.write(0, 1, 'date')\n  worksheet.write(0, 2, 'customer')\n\n  workbook\nend\n</code></pre>\n\n<p>the result would be a file and the content is just the name of the object</p>\n\n<pre><code>#&lt;WriteXLSX:0x007fd9cf8aa290&gt;\n</code></pre>\n\n<p>I'm not sure if this is something write_xlsx specific or if I'm missing something obvious here.</p>\n"}, {"tags": ["ruby", "puppet"], "comments": [{"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1473341254, "post_id": 39372667, "comment_id": 66110534, "body": "@MattSchuchard explains the error message in his answer, but I can&#39;t help thinking that the error must be a symptom of a different problem.  After all, what sense would it make to call the <code>member()</code> function and ignore the result?  This sort of thing is one of the reasons that we tend to request a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>."}], "answers": [{"comments": [{"owner": {"reputation": 611, "user_id": 3614014, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/bc796ccce3417a6bee8c9036e76dcfb7?s=128&d=identicon&r=PG&f=1", "display_name": "user3614014", "link": "https://stackoverflow.com/users/3614014/user3614014"}, "edited": false, "score": 0, "creation_date": 1473634352, "post_id": 39372907, "comment_id": 66205112, "body": "Thanks this really helps a lot!"}], "tags": [], "owner": {"reputation": 12661, "user_id": 5343387, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/15a14cec3014822297a08ed6dfae2563?s=128&d=identicon&r=PG&f=1", "display_name": "Matt Schuchard", "link": "https://stackoverflow.com/users/5343387/matt-schuchard"}, "is_accepted": true, "score": 2, "last_activity_date": 1473259230, "creation_date": 1473259230, "answer_id": 39372907, "question_id": 39372667, "link": "https://stackoverflow.com/questions/39372667/puppet-stdlib-member-function-not-working/39372907#39372907", "title": "puppet stdlib &#39;member&quot; function not working", "body": "<p>Looking at the stdlib documentation for member, we see that member is an rvalue. This means in this context that you need to have its output assigned. This is what the error message of <code>must be the value of a statement</code> is hinting at. Note a helpful wikipedia article on l-values and r-values <a href=\"https://en.wikipedia.org/wiki/Value_(computer_science)#lrvalue\" rel=\"nofollow\">https://en.wikipedia.org/wiki/Value_(computer_science)#lrvalue</a>.</p>\n\n<p>Your code will work, for example, if you assign the output of <code>member(['FOO','BAR'], $myvariable)</code> to a variable or a resource attribute.</p>\n\n<p>For example:</p>\n\n<pre><code>$myvariable = 'FOO'\n$variable = member(['FOO','BAR'], $myvariable)\nnotify { $variable: }\n</code></pre>\n\n<p>will result in a notify 'true' during compilation.</p>\n"}], "owner": {"reputation": 611, "user_id": 3614014, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/bc796ccce3417a6bee8c9036e76dcfb7?s=128&d=identicon&r=PG&f=1", "display_name": "user3614014", "link": "https://stackoverflow.com/users/3614014/user3614014"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 253, "favorite_count": 0, "accepted_answer_id": 39372907, "answer_count": 1, "score": 1, "last_activity_date": 1473259230, "creation_date": 1473258566, "question_id": 39372667, "link": "https://stackoverflow.com/questions/39372667/puppet-stdlib-member-function-not-working", "title": "puppet stdlib &#39;member&quot; function not working", "body": "<p>Trying to use the member function of the puppet stdlib module:</p>\n\n<p>effectively:</p>\n\n<pre><code>$myvariable = 'FOO'\n</code></pre>\n\n<p>then when using the member function:</p>\n\n<pre><code>member(['FOO','BAR'], $myvariable)\n</code></pre>\n\n<p>I keep getting the error message:</p>\n\n<pre><code>Error: Could not retrieve catalog from remote server: Error 400 on SERVER: Function 'member' must be the value of a statement at /etc/puppet/modules/mymodule/manifests/init.pp:###  \n</code></pre>\n"}, {"tags": ["ruby", "linux", "process"], "answers": [{"tags": [], "owner": {"reputation": 2361, "user_id": 5809597, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d43b1c037d08a423aeb6ee10fc922437?s=128&d=identicon&r=PG&f=1", "display_name": "Jorge Bellon", "link": "https://stackoverflow.com/users/5809597/jorge-bellon"}, "is_accepted": false, "score": 0, "last_activity_date": 1473261771, "creation_date": 1473261771, "answer_id": 39373824, "question_id": 39372425, "link": "https://stackoverflow.com/questions/39372425/how-can-a-process-be-killed-with-all-its-childern/39373824#39373824", "title": "how can a process be killed with all its childern", "body": "<p>Using either <code>ps xf</code> or <code>pstree</code>, you can dynamically see running processes hierarchy.</p>\n\n<p>I've used <a href=\"http://linux.die.net/man/1/strace\" rel=\"nofollow\">strace</a> to track which was the behaviour of those programs. It turned that they are checking the contents of <code>/proc/$pid/stat</code> and <code>/proc/$pid/status</code>, which give them information of who the process's parent is.</p>\n\n<p>Probably, you will have to look for the processes whose Parent PID is equal to the PID you got (or that process's PPID).</p>\n"}], "owner": {"reputation": 21, "user_id": 6805148, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6ab73e6535d200a7e9cd3b00ff16d06c?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel Akua", "link": "https://stackoverflow.com/users/6805148/daniel-akua"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 100, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1473261771, "creation_date": 1473257978, "question_id": 39372425, "link": "https://stackoverflow.com/questions/39372425/how-can-a-process-be-killed-with-all-its-childern", "title": "how can a process be killed with all its childern", "body": "<p>I have a situation where one xterm runs another xterm which runs a process.\nI would like to set some kind of watchdog and kill all those windows in case of a stuck process.</p>\n\n<p>I'm using Ruby to do this. When the first xterm is opened I get it's PID, and later when a SIGTERM is sent to it, only the first xterm window dies, but not the second.</p>\n\n<p>It can be easily reproduced in irb:</p>\n\n<pre><code>irb(main):002:0&gt; cmd = \"xterm -e xterm -e sleep 1000\"\n=&gt; \"xterm -e xterm -e sleep 1000\"\nirb(main):003:0&gt; pid = Process.spawn(cmd)\n=&gt; 669\nirb(main):004:0&gt; Process.kill(15, 669)\n=&gt; 1\n</code></pre>\n\n<p>This leaves the second xterm window open. How can all the process chain be killed?</p>\n\n<p>Thanks</p>\n"}, {"tags": ["ruby", "chef-infra"], "answers": [{"tags": [], "owner": {"reputation": 43208, "user_id": 78722, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cf611565f0b79abd0b3dc200ad867661?s=128&d=identicon&r=PG", "display_name": "coderanger", "link": "https://stackoverflow.com/users/78722/coderanger"}, "is_accepted": false, "score": 0, "last_activity_date": 1473261496, "creation_date": 1473261496, "answer_id": 39373736, "question_id": 39372198, "link": "https://stackoverflow.com/questions/39372198/a-recipe-condition-that-will-run-only-if-a-recipe-from-a-specific-cookbook-is-no/39373736#39373736", "title": "a recipe condition that will run only if a recipe from a specific cookbook is not present", "body": "<p>This is a very weird request and there is a very high chance you are doing something you shouldn't but: <code>node[\"recipes\"].any? {|r| r.start_with?(\"frenchblog\") }</code></p>\n"}, {"tags": [], "owner": {"reputation": 15030, "user_id": 3627607, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd5fd623c0fdd0c93a2535cf6293ec5d?s=128&d=identicon&r=PG", "display_name": "Tensibai", "link": "https://stackoverflow.com/users/3627607/tensibai"}, "is_accepted": false, "score": 0, "last_activity_date": 1473261626, "creation_date": 1473261626, "answer_id": 39373776, "question_id": 39372198, "link": "https://stackoverflow.com/questions/39372198/a-recipe-condition-that-will-run-only-if-a-recipe-from-a-specific-cookbook-is-no/39373776#39373776", "title": "a recipe condition that will run only if a recipe from a specific cookbook is not present", "body": "<p>The <code>node.run_list</code> method return an array, you can use all ruby function to filter it and check presence.</p>\n\n<p>Something along the line of this should do:</p>\n\n<pre><code>node.run_list.select { |entry| entry[/frenchblog::/] }.length == 0\n</code></pre>\n\n<p>This sounds like something very strange to do and it's probably brittle at the end of the day.</p>\n"}], "owner": {"reputation": 1794, "user_id": 1463751, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/089f887e5f22d434203d42308a4baab9?s=128&d=identicon&r=PG", "display_name": "Tom Klino", "link": "https://stackoverflow.com/users/1463751/tom-klino"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 37, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1473261626, "creation_date": 1473257395, "question_id": 39372198, "link": "https://stackoverflow.com/questions/39372198/a-recipe-condition-that-will-run-only-if-a-recipe-from-a-specific-cookbook-is-no", "title": "a recipe condition that will run only if a recipe from a specific cookbook is not present", "body": "<p>I want to have a condition block in my recipe that will be true if there is no recipe from a cookbook named \"frenchblog\" in that node's runlist.</p>\n\n<p>I have found the following <a href=\"https://gist.github.com/kwilczynski/c271f251ea7f48ba99b3\" rel=\"nofollow\">link</a>: that suggests to use <code>node.run_list.recipe?(\"frenchblog::default\")</code>. Only that this will work for specific recipes and not the entire cookbook, and I can't find a way to match is against a regex (like <code>/frenchblog/</code>) because it's not a string and I can't convert it to one.</p>\n\n<p>How can I test for the presence of a recipe from a cookbook within a recipe's code? Anyway to convert the objects in <code>node.run_list</code> to strings so I can match them to a regex?</p>\n"}, {"tags": ["ruby", "validation", "ruby-on-rails-4", "checkbox", "devise"], "comments": [{"owner": {"reputation": 318, "user_id": 2959090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ecab5392ceea34c60ad3d723617d127a?s=128&d=identicon&r=PG&f=1", "display_name": "siopao", "link": "https://stackoverflow.com/users/2959090/siopao"}, "edited": false, "score": 0, "creation_date": 1473273075, "post_id": 39372170, "comment_id": 66081689, "body": "Could you post the params and also the checkbox elements when checked.  e.g.     &lt;input name=&quot;post[validated]&quot; type=&quot;hidden&quot; value=&quot;0&quot; /&gt;     &lt;input checked=&quot;checked&quot; type=&quot;checkbox&quot; id=&quot;post_validated&quot; name=&quot;post[validated]&quot; value=&quot;1&quot; /&gt;"}, {"owner": {"reputation": 33, "user_id": 3206996, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/h5Oqg.jpg?s=128&g=1", "display_name": "Tekyy", "link": "https://stackoverflow.com/users/3206996/tekyy"}, "reply_to_user": {"reputation": 318, "user_id": 2959090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ecab5392ceea34c60ad3d723617d127a?s=128&d=identicon&r=PG&f=1", "display_name": "siopao", "link": "https://stackoverflow.com/users/2959090/siopao"}, "edited": false, "score": 0, "creation_date": 1473322726, "post_id": 39372170, "comment_id": 66098618, "body": "I&#39;m not sure if that&#39;s what you were asking for (sorry for being a boring noob :D) &lt;label for=&quot;user_admin&quot;&gt;&lt;input name=&quot;user[admin]&quot; type=&quot;hidden&quot; value=&quot;0&quot; /&gt;&lt;input type=&quot;checkbox&quot; value=&quot;1&quot; name=&quot;user[admin]&quot; id=&quot;user_admin&quot; /&gt; Admin&lt;/label&gt;"}], "answers": [{"tags": [], "owner": {"reputation": 6968, "user_id": 5490505, "user_type": "registered", "accept_rate": 88, "profile_image": "https://lh4.googleusercontent.com/-6-yKyG1ZZUI/AAAAAAAAAAI/AAAAAAAAABA/5a7UfitqO5Y/photo.jpg?sz=128", "display_name": "John", "link": "https://stackoverflow.com/users/5490505/john"}, "is_accepted": false, "score": 0, "last_activity_date": 1473577941, "creation_date": 1473577941, "answer_id": 39433718, "question_id": 39372170, "link": "https://stackoverflow.com/questions/39372170/checkbox-returns-false-when-checked-instead-of-true-rails-4-2/39433718#39433718", "title": "Checkbox returns false when checked instead of true - Rails 4.2", "body": "<p>I don't see the place in your code where you make use of the <code>:admin</code> checkbox value, but I'm guessing that perhaps you simply ask if that param is <code>true</code> or not, like so?</p>\n\n<pre><code>if params[:user][:admin] == true\n  do this...\nelse\n  do this...\nend\n</code></pre>\n\n<p>The problem with this is that the submitted checkbox value is, by default, a <code>\"1\"</code> if checked (note that it is of type <code>string</code>). A text string of any value is not equal to the boolean value of <code>true</code> or <code>false</code>.</p>\n\n<p>You could update your code to something like:</p>\n\n<pre><code>if params[:user][:admin] == \"1\"\n  do this...\nelse\n  do this...\nend\n</code></pre>\n\n<p>Rails always receives submitted params as <code>string</code> values</p>\n"}, {"comments": [{"owner": {"reputation": 33, "user_id": 3206996, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/h5Oqg.jpg?s=128&g=1", "display_name": "Tekyy", "link": "https://stackoverflow.com/users/3206996/tekyy"}, "edited": false, "score": 0, "creation_date": 1474013021, "post_id": 39433923, "comment_id": 66368060, "body": "Sorry for the delay guys and thanks for your answers ! Looks like I actually mispelled every single parmeters in my params...."}], "tags": [], "owner": {"reputation": 79161, "user_id": 1064226, "user_type": "registered", "profile_image": "https://graph.facebook.com/36912842/picture?type=large", "display_name": "Frederick Cheung", "link": "https://stackoverflow.com/users/1064226/frederick-cheung"}, "is_accepted": true, "score": 0, "last_activity_date": 1473579826, "creation_date": 1473579826, "answer_id": 39433923, "question_id": 39372170, "link": "https://stackoverflow.com/questions/39372170/checkbox-returns-false-when-checked-instead-of-true-rails-4-2/39433923#39433923", "title": "Checkbox returns false when checked instead of true - Rails 4.2", "body": "<p>The key bit is right at the end:</p>\n\n<pre><code># Never trust parameters from the scary internet, only allow the white list through.\ndef user_params\n  params.fetch(:user, {})\nend\n</code></pre>\n\n<p>The whitelist (second argument) is empty so all the parameters are ignored. If you looked at your log file you would see a warning about parameters being ignored (you can configure this to raise an exception). </p>\n\n<p>It isn't clear if the controller being used is your UsersController or devise's registration controller - you've show the view for one but the controller code for the other.</p>\n\n<p>If you are using devise's registration controller, then <code>UsersController</code> may not be relevant - you would normally use a before filter to run something like this</p>\n\n<pre><code>devise_parameter_sanitizer.permit(:sign_up, keys: [:admin, ...])\n</code></pre>\n\n<p>to change devise's default list of permitted fields.</p>\n"}], "owner": {"reputation": 33, "user_id": 3206996, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/h5Oqg.jpg?s=128&g=1", "display_name": "Tekyy", "link": "https://stackoverflow.com/users/3206996/tekyy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 627, "favorite_count": 0, "accepted_answer_id": 39433923, "answer_count": 2, "score": 1, "last_activity_date": 1473579826, "creation_date": 1473257317, "question_id": 39372170, "link": "https://stackoverflow.com/questions/39372170/checkbox-returns-false-when-checked-instead-of-true-rails-4-2", "title": "Checkbox returns false when checked instead of true - Rails 4.2", "body": "<p><br>\nSo I am trying to build an e-commerce website for a school project with Ruby on Rails, using Devise for the users.\nI am still learning this language on my own, and i encoutered a problem.</p>\n\n<p>I've got this view generated by devise in : <strong>views/devise/registrations/new.html.erb</strong> </p>\n\n<pre><code>&lt;%= bootstrap_form_for(resource, as: resource_name, url: registration_path(resource_name)) do |f| %&gt;\n  &lt;%= devise_error_messages! %&gt;\n\n  &lt;div class=\"field\"&gt;\n    &lt;%= f.text_field :prenom, autofocus: true %&gt;\n &lt;/div&gt;\n\n&lt;div class=\"field\"&gt;\n  &lt;%= f.text_field :nom, autofocus: true %&gt;\n&lt;/div&gt;\n\n&lt;div class=\"field\"&gt;\n  &lt;%= f.text_field :adresse, autofocus: true %&gt;\n&lt;/div&gt;  \n\n&lt;div class=\"field\"&gt;\n  &lt;%= f.number_field :cp, autofocus: true %&gt;\n&lt;/div&gt;\n\n&lt;div class=\"field\"&gt;\n  &lt;%= f.email_field :email, autofocus: true, placeholder: \"Ex: votre@mail.com\" %&gt;\n&lt;/div&gt;\n\n&lt;div class=\"field\"&gt;\n  &lt;% if @validatable %&gt;\n    &lt;%= f.password_field :password, autocomplete: \"off\", placeholder: \"8 caract\u00e8res minimum\" %&gt;\n  &lt;% end %&gt;\n&lt;/div&gt;\n\n&lt;div class=\"field\"&gt;\n  &lt;%= f.password_field :password_confirmation, autocomplete: \"off\" %&gt;\n&lt;/div&gt;\n\n&lt;div class=\"field\"&gt;\n  &lt;%= f.check_box :admin %&gt;\n&lt;/div&gt;\n\n&lt;div class=\"actions\"&gt;\n  &lt;%= f.submit \"Sign up\" %&gt;\n&lt;/div&gt;\n</code></pre>\n\n  \n\n<p>I know I shouldn't give an admin field in my form but this is just for testing purposes. \nSo when I check the checkbox and submit this form, it returns false.\nI have no idea why. Any help, explanations, is much appreciated. </p>\n\n<p>My <strong>user_controller</strong> if needed :</p>\n\n<pre><code>class UsersController &lt; ApplicationController\n  before_action :set_user, only: [:show, :edit, :update, :destroy]\n\n  # Fais appel \u00e0 la m\u00e9thode permettant de restreindre l'acc\u00e8s uniquement aux admins\n  # before_filter :authorize_admin, only: :index\n\n  # GET /users\n  # GET /users.json\n  def index\n    @users = User.all\n  end\n\n  # GET /users/1\n  # GET /users/1.json\n  def show\n    @user = User.find(params[:id])\n  end\n\n  # GET /users/new\n  def new\n    @user = User.new\n  end\n\n # GET /users/1/edit\n def edit\n end\n\n # POST /users\n # POST /users.json\n def create\n   @user = User.new(user_params)\n\n   respond_to do |format|\n     if @user.save\n       format.html { redirect_to @user, notice: 'User was successfully created.' }\n       format.json { render :show, status: :created, location: @user }\n    else\n      format.html { render :new }\n      format.json { render json: @user.errors, status: :unprocessable_entity }\n    end\n  end\nend\n\n# PATCH/PUT /users/1\n# PATCH/PUT /users/1.json\ndef update\n  respond_to do |format|\n    if @user.update(user_params)\n      format.html { redirect_to @user, notice: 'User was successfully updated.' }\n      format.json { render :show, status: :ok, location: @user }\n    else\n      format.html { render :edit }\n      format.json { render json: @user.errors, status: :unprocessable_entity }\n    end\n  end\nend\n\n# DELETE /users/1\n# DELETE /users/1.json\ndef destroy\n  @user.destroy\n  respond_to do |format|\n    format.html { redirect_to users_url, notice: 'User was successfully destroyed.' }\n    format.json { head :no_content }\n  end\nend\n\nprivate\n# Use callbacks to share common setup or constraints between actions.\ndef set_user\n  @user = User.find(params[:id])\nend\n\n# Never trust parameters from the scary internet, only allow the white list through.\ndef user_params\n  params.fetch(:user, {})\nend\nend\n</code></pre>\n"}, {"tags": ["javascript", "jquery", "html", "ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 2770, "user_id": 1042201, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/ada99cff697111a404292dbeff3d4313?s=128&d=identicon&r=PG", "display_name": "Kumar", "link": "https://stackoverflow.com/users/1042201/kumar"}, "edited": false, "score": 0, "creation_date": 1473256755, "post_id": 39371906, "comment_id": 66071817, "body": "You want to refresh it in a certain interval? Or you want to refresh the div with a button but without refreshing the page(asynchronously)?"}, {"owner": {"reputation": 583, "user_id": 6800202, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/1j2dr.jpg?s=128&g=1", "display_name": "Alexandre", "link": "https://stackoverflow.com/users/6800202/alexandre"}, "reply_to_user": {"reputation": 2770, "user_id": 1042201, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/ada99cff697111a404292dbeff3d4313?s=128&d=identicon&r=PG", "display_name": "Kumar", "link": "https://stackoverflow.com/users/1042201/kumar"}, "edited": false, "score": 0, "creation_date": 1473257033, "post_id": 39371906, "comment_id": 66072016, "body": "I need to refresh div every 2 seconds if it is possible. I was also asking myself if it wasn&#39;t too heavy for the database to refresh it every 2 seconds"}, {"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 0, "creation_date": 1473274331, "post_id": 39371906, "comment_id": 66082223, "body": "Welcome to Stack Overflow. We don&#39;t care about your expertise or primary language, we want well thought-out questions. If you have difficulty with English we&#39;ll help make the question more understandable. I&#39;d highly recommend reading the linked pages in &quot;<a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a>&quot;, especially <a href=\"http://catb.org/esr/faqs/smart-questions.html\" rel=\"nofollow noreferrer\">catb.org/esr/faqs/smart-questions.html</a>. It&#39;s long but has really good tips on how to ask in the future."}], "answers": [{"comments": [{"owner": {"reputation": 583, "user_id": 6800202, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/1j2dr.jpg?s=128&g=1", "display_name": "Alexandre", "link": "https://stackoverflow.com/users/6800202/alexandre"}, "edited": false, "score": 0, "creation_date": 1473257104, "post_id": 39371974, "comment_id": 66072066, "body": "The problem is i have @requests in my controller and the display in my view. I need to fuse it in a single view ?"}, {"owner": {"reputation": 6295, "user_id": 118803, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6534d583d8b442b3be4f608a3c45b5b9?s=128&d=identicon&r=PG", "display_name": "Joshua Smith", "link": "https://stackoverflow.com/users/118803/joshua-smith"}, "reply_to_user": {"reputation": 583, "user_id": 6800202, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/1j2dr.jpg?s=128&g=1", "display_name": "Alexandre", "link": "https://stackoverflow.com/users/6800202/alexandre"}, "edited": false, "score": 0, "creation_date": 1473257289, "post_id": 39371974, "comment_id": 66072186, "body": "I would convert the whole thing to an ajax call and do the updates in javascript rather than the rails view"}], "tags": [], "owner": {"reputation": 6295, "user_id": 118803, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6534d583d8b442b3be4f608a3c45b5b9?s=128&d=identicon&r=PG", "display_name": "Joshua Smith", "link": "https://stackoverflow.com/users/118803/joshua-smith"}, "is_accepted": true, "score": 1, "last_activity_date": 1473274502, "last_edit_date": 1473274502, "creation_date": 1473256783, "answer_id": 39371974, "question_id": 39371906, "link": "https://stackoverflow.com/questions/39371906/how-to-auto-refresh-a-div/39371974#39371974", "title": "How to auto-refresh a div", "body": "<p>There is a function in JavaScript named <code>setInterval</code> that lets you schedule a function to be executed every time interval.</p>\n\n<p><a href=\"http://www.w3schools.com/js/js_timing.asp\" rel=\"nofollow\">http://www.w3schools.com/js/js_timing.asp</a></p>\n\n<pre><code>setInterval(function() { \n  console.log(\"Hi There\");\n  }, 1000);\n</code></pre>\n"}], "owner": {"reputation": 583, "user_id": 6800202, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/1j2dr.jpg?s=128&g=1", "display_name": "Alexandre", "link": "https://stackoverflow.com/users/6800202/alexandre"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 770, "favorite_count": 0, "accepted_answer_id": 39371974, "answer_count": 1, "score": 0, "last_activity_date": 1473274502, "creation_date": 1473256571, "last_edit_date": 1473274184, "question_id": 39371906, "link": "https://stackoverflow.com/questions/39371906/how-to-auto-refresh-a-div", "title": "How to auto-refresh a div", "body": "<p>I have a controller and a view with a div : </p>\n\n<pre><code>def show\n  @requests = events.get_requests\nend\n</code></pre>\n\n<p><code>get_requests</code> returns all the requests in the database with a select, which I output in a div in my view:</p>\n\n<pre><code>&lt;div class=\"party-block\" id=\"requests\"&gt;\n  &lt;h4&gt;&lt;%= t '.requests' %&gt;&lt;/h4&gt;\n  &lt;input type=\"button\" value=\"&lt;%= t '.refresh' %&gt;\" onClick=\"window.location.reload()\" class=\"btn-sm btn-info\"&gt;\n  &lt;% @requests.each do |r| %&gt;\n    &lt;span class=\"request\"&gt;\n      ...\n</code></pre>\n\n<p>In this div I print all requests with other things.</p>\n\n<p>I want to automatically refresh this div with a JavaScript/jQuery function. For the moment I use a button to refresh but do I need to re-execute the code in my controller?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "session", "devise", "session-variables"], "comments": [{"owner": {"reputation": 121, "user_id": 5332839, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-W124KKtHHPQ/AAAAAAAAAAI/AAAAAAAAABk/eKg3XVGBfww/photo.jpg?sz=128", "display_name": "Uysim Ty", "link": "https://stackoverflow.com/users/5332839/uysim-ty"}, "edited": false, "score": 0, "creation_date": 1602834342, "post_id": 39371515, "comment_id": 113850604, "body": "So you have solution for this yet?"}], "answers": [{"tags": [], "owner": {"reputation": 3590, "user_id": 1494245, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a50a2dcc33b58918f27664b7646d92b7?s=128&d=identicon&r=PG", "display_name": "Sean Huber", "link": "https://stackoverflow.com/users/1494245/sean-huber"}, "is_accepted": false, "score": 0, "last_activity_date": 1473256864, "creation_date": 1473256864, "answer_id": 39372004, "question_id": 39371515, "link": "https://stackoverflow.com/questions/39371515/rails-session-variable-doesnt-get-set-until-page-reload/39372004#39372004", "title": "Rails session variable doesn&#39;t get set until page reload", "body": "<p>You need to override Devise' <code>SessionsController.new</code> action to accomplish this.  Make sure you have something like this defined in <code>config/routes.rb</code>:</p>\n\n<pre><code>Rails.application.routes.draw do\n  ...\n  devise_for :users, controllers: {sessions: 'sessions'}\n  ...\nend\n</code></pre>\n\n<p>And then in <code>app/controllers/sessions_controller.rb</code>:</p>\n\n<pre><code>class SessionsController &lt; Devise::SessionsController\n  def new\n    super do |resource|\n      session[:my_session_variable] = 'hello world'\n    end\n  end\nend\n</code></pre>\n"}], "owner": {"reputation": 53, "user_id": 2996782, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/51SX8.png?s=128&g=1", "display_name": "digitalEyes", "link": "https://stackoverflow.com/users/2996782/digitaleyes"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 491, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1473256864, "creation_date": 1473255613, "last_edit_date": 1473256237, "question_id": 39371515, "link": "https://stackoverflow.com/questions/39371515/rails-session-variable-doesnt-get-set-until-page-reload", "title": "Rails session variable doesn&#39;t get set until page reload", "body": "<p>I have a session variable that I want to set when a user hits the devise login page. Unfortunately it doesn't take effect after I get redirected. Instead, I have to refresh the page and then I see the new variable.</p>\n\n<p>I have tried a few things:</p>\n\n<p>First I tried just setting the session variable\n<code>session[:theme] = theme</code></p>\n\n<p>Then I tried deleting the old key and setting a new key:</p>\n\n<pre><code>case theme\n  when 'theme1'\n    session.delete(:theme2)\n    session[:theme1] = true\n  else\n    session.delete(:theme1)\n    session[:theme2] = true\n  end\n</code></pre>\n\n<p>Both of these require a page refresh after I am redirected to the login form. My server logs are showing that the session variable is being picked up but the browser just doesn't seem to want to change it until I reload.</p>\n\n<p>Any help is greatly appreciated.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "api", "shopify"], "answers": [{"tags": [], "owner": {"reputation": 23, "user_id": 5421363, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab6d40c99ee6a1c131212cbb33d6c222?s=128&d=identicon&r=PG&f=1", "display_name": "Joe", "link": "https://stackoverflow.com/users/5421363/joe"}, "is_accepted": false, "score": 0, "last_activity_date": 1473255405, "creation_date": 1473255405, "answer_id": 39371432, "question_id": 39371138, "link": "https://stackoverflow.com/questions/39371138/updating-receipt-comments-on-a-shopify-order-using-shopifyapifulfillment/39371432#39371432", "title": "Updating &quot;Receipt&quot; comments on a Shopify Order using ShopifyAPI::Fulfillment", "body": "<p>You should save the receipt </p>\n\n<pre><code>joe = fulfill.receipt\njoe.response_status = \"Accepted\"\njoe.response_comment = \"Your order was received by Yo Mama\"\njoe.save\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 19261, "user_id": 4758119, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/F4dJY.jpg?s=128&g=1", "display_name": "Deepak Mahakale", "link": "https://stackoverflow.com/users/4758119/deepak-mahakale"}, "is_accepted": false, "score": 0, "last_activity_date": 1473255498, "creation_date": 1473255498, "answer_id": 39371469, "question_id": 39371138, "link": "https://stackoverflow.com/questions/39371138/updating-receipt-comments-on-a-shopify-order-using-shopifyapifulfillment/39371469#39371469", "title": "Updating &quot;Receipt&quot; comments on a Shopify Order using ShopifyAPI::Fulfillment", "body": "<p>You are changing the values of <code>Receipt</code> and saving <code>Fulfillment</code></p>\n\n<p>replace</p>\n\n<pre><code>fulfill.save\n</code></pre>\n\n<p>with</p>\n\n<pre><code>joe.save\n</code></pre>\n"}], "owner": {"reputation": 2168, "user_id": 4386626, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/f2c9512ee4dac8ccbbf45fc2cf1a8046?s=128&d=identicon&r=PG&f=1", "display_name": "ToddT", "link": "https://stackoverflow.com/users/4386626/toddt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 58, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1473255498, "creation_date": 1473254641, "question_id": 39371138, "link": "https://stackoverflow.com/questions/39371138/updating-receipt-comments-on-a-shopify-order-using-shopifyapifulfillment", "title": "Updating &quot;Receipt&quot; comments on a Shopify Order using ShopifyAPI::Fulfillment", "body": "<p>I'm trying to update the <code>Receipt</code> attribute of an order using ShopifyAPI::Fulfillment</p>\n\n<p>I'm doing this:</p>\n\n<pre><code>fulfill = ShopifyAPI::Fulfillment.find(351144XXXX, :params =&gt; \n{:order_id =&gt;  426199XXXX})\njoe = fulfill.receipt\njoe.response_status = \"Accepted\"\njoe.response_comment = \"Your order was received by Yo Mama\"\nfulfill.save\n</code></pre>\n\n<p>It saves it, but the order doesn't keep the save.. Not sure what I'm doing wrong, if anything.</p>\n"}, {"tags": ["javascript", "ruby", "regex"], "comments": [{"owner": {"reputation": 184244, "user_id": 14104, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/otetW.jpg?s=128&g=1", "display_name": "epascarello", "link": "https://stackoverflow.com/users/14104/epascarello"}, "edited": false, "score": 9, "creation_date": 1473253507, "post_id": 39370700, "comment_id": 66069452, "body": "Why are you matching HTML with a regular expression? <a href=\"http://stackoverflow.com/questions/590747/using-regular-expressions-to-parse-html-why-not\" title=\"using regular expressions to parse html why not\">stackoverflow.com/questions/590747/&hellip;</a>"}, {"owner": {"reputation": 47165, "user_id": 5053002, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab6a9edfd2614014563162586c1b0697?s=128&d=identicon&r=PG", "display_name": "Jaromanda X", "link": "https://stackoverflow.com/users/5053002/jaromanda-x"}, "edited": false, "score": 6, "creation_date": 1473253510, "post_id": 39370700, "comment_id": 66069457, "body": "I urge you to read <a href=\"http://stackoverflow.com/questions/1732348/regex-match-open-tags-except-xhtml-self-contained-tags/1732454#1732454\" title=\"regex match open tags except xhtml self contained tags\">stackoverflow.com/questions/1732348/&hellip;</a> before it&#39;s too late"}, {"owner": {"reputation": 2624, "user_id": 989920, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/01e16ed8a3bc3246278001359f7a0257?s=128&d=identicon&r=PG", "display_name": "evolutionxbox", "link": "https://stackoverflow.com/users/989920/evolutionxbox"}, "edited": false, "score": 0, "creation_date": 1473253606, "post_id": 39370700, "comment_id": 66069525, "body": "Please may someone edit this?"}, {"owner": {"reputation": 15560, "user_id": 709439, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/19b5c7e6c2772d88adcbd928daddc170?s=128&d=identicon&r=PG", "display_name": "MarcoS", "link": "https://stackoverflow.com/users/709439/marcos"}, "edited": false, "score": 2, "creation_date": 1473253668, "post_id": 39370700, "comment_id": 66069576, "body": "Please, PLEASE: do not use regexps to parse HTML! (see <a href=\"http://stackoverflow.com/a/1732454/709439\">stackoverflow.com/a/1732454/709439</a> :-)"}, {"owner": {"reputation": 1, "user_id": 4750165, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-ieyZW47zF1Q/AAAAAAAAAAI/AAAAAAAAAEM/UY5jUED1b54/photo.jpg?sz=128", "display_name": "MohanL", "link": "https://stackoverflow.com/users/4750165/mohanl"}, "reply_to_user": {"reputation": 184244, "user_id": 14104, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/otetW.jpg?s=128&g=1", "display_name": "epascarello", "link": "https://stackoverflow.com/users/14104/epascarello"}, "edited": false, "score": 0, "creation_date": 1473254185, "post_id": 39370700, "comment_id": 66069941, "body": "@epascarello this is not actually html, it is not from a webpage, this is is just a plain string."}, {"owner": {"reputation": 184244, "user_id": 14104, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/otetW.jpg?s=128&g=1", "display_name": "epascarello", "link": "https://stackoverflow.com/users/14104/epascarello"}, "edited": false, "score": 0, "creation_date": 1473254233, "post_id": 39370700, "comment_id": 66069974, "body": "So you tagged it with JavaScript so you can make it into DOM and query it...Regular expression is not ideal here.  And you really do not need to repeat the same thing 4 times."}, {"owner": {"reputation": 28426, "user_id": 791010, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/LRxuE.png?s=128&g=1", "display_name": "James Thorpe", "link": "https://stackoverflow.com/users/791010/james-thorpe"}, "edited": false, "score": 0, "creation_date": 1473254295, "post_id": 39370700, "comment_id": 66070015, "body": "It may be a plain string, but it still contains what very much looks like HTML - use an HTML parser.  If you&#39;re in a browser environment, you have one readily available."}, {"owner": {"reputation": 1, "user_id": 4750165, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-ieyZW47zF1Q/AAAAAAAAAAI/AAAAAAAAAEM/UY5jUED1b54/photo.jpg?sz=128", "display_name": "MohanL", "link": "https://stackoverflow.com/users/4750165/mohanl"}, "reply_to_user": {"reputation": 184244, "user_id": 14104, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/otetW.jpg?s=128&g=1", "display_name": "epascarello", "link": "https://stackoverflow.com/users/14104/epascarello"}, "edited": false, "score": 0, "creation_date": 1473254578, "post_id": 39370700, "comment_id": 66070242, "body": "@epascarello, anyways, could I do it in a ruby environment /"}, {"owner": {"reputation": 1, "user_id": 4750165, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-ieyZW47zF1Q/AAAAAAAAAAI/AAAAAAAAAEM/UY5jUED1b54/photo.jpg?sz=128", "display_name": "MohanL", "link": "https://stackoverflow.com/users/4750165/mohanl"}, "reply_to_user": {"reputation": 28426, "user_id": 791010, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/LRxuE.png?s=128&g=1", "display_name": "James Thorpe", "link": "https://stackoverflow.com/users/791010/james-thorpe"}, "edited": false, "score": 0, "creation_date": 1473254609, "post_id": 39370700, "comment_id": 66070260, "body": "@JamesThorpe actually, this is under a ruby environment"}, {"owner": {"reputation": 28426, "user_id": 791010, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/LRxuE.png?s=128&g=1", "display_name": "James Thorpe", "link": "https://stackoverflow.com/users/791010/james-thorpe"}, "edited": false, "score": 0, "creation_date": 1473254634, "post_id": 39370700, "comment_id": 66070275, "body": "Great.  A quick search indicates that there are <a href=\"http://www.nokogiri.org/\" rel=\"nofollow noreferrer\">dom parsers</a> available for Ruby too."}, {"owner": {"reputation": 41522, "user_id": 1359668, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Xtsl4.jpg?s=128&g=1", "display_name": "Steven Doggart", "link": "https://stackoverflow.com/users/1359668/steven-doggart"}, "edited": false, "score": 0, "creation_date": 1473254717, "post_id": 39370700, "comment_id": 66070318, "body": "The simplest solution is to make the pattern lazy (not greedy) by adding a <code>?</code> after the star (e.g. <code>\\&lt;span question_number=(?:\\&quot;)*(\\d*)(?:\\&quot;)*&gt;(.*?)&lt;\\&#47;span&gt;</code>, but that wouldn&#39;t be terribly efficient.  To do it properly, regex is not a good solution.  As others have said, use an HTML parser to load it into a DOM and then read it that way."}, {"owner": {"reputation": 1, "user_id": 4750165, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-ieyZW47zF1Q/AAAAAAAAAAI/AAAAAAAAAEM/UY5jUED1b54/photo.jpg?sz=128", "display_name": "MohanL", "link": "https://stackoverflow.com/users/4750165/mohanl"}, "reply_to_user": {"reputation": 41522, "user_id": 1359668, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Xtsl4.jpg?s=128&g=1", "display_name": "Steven Doggart", "link": "https://stackoverflow.com/users/1359668/steven-doggart"}, "edited": false, "score": 0, "creation_date": 1473255180, "post_id": 39370700, "comment_id": 66070641, "body": "@StevenDoggart wow, that is exactly what I am looking for. Though it is not taht efficient, but I guess comparing to the dom operation, would that be better ? if not, is there any ways I could test out the speed ?"}, {"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 2, "creation_date": 1473255510, "post_id": 39370700, "comment_id": 66070869, "body": "It is considered impolite to change your question in such a way as to invalidate other people&#39;s hard work. In this particular case, multiple people had already put in significant work to solve your problem in JavaScript when you all of a sudden changed your mind and now want a Ruby solution instead. It would be more polite to ask a separate question about Ruby rather than throwing all the hard work away that people have already put into your JavaScript problem."}, {"owner": {"reputation": 1, "user_id": 4750165, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-ieyZW47zF1Q/AAAAAAAAAAI/AAAAAAAAAEM/UY5jUED1b54/photo.jpg?sz=128", "display_name": "MohanL", "link": "https://stackoverflow.com/users/4750165/mohanl"}, "reply_to_user": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 0, "creation_date": 1473256362, "post_id": 39370700, "comment_id": 66071508, "body": "@J&#246;rgWMittag my bad"}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1473256656, "post_id": 39370700, "comment_id": 66071738, "body": "@MohanL J&#246;rg W Mittag&#39;s comment also applies to your follow-up question (&quot;Update3&quot;). Please post a separate question regarding the benchmark."}, {"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 1, "creation_date": 1473274643, "post_id": 39370700, "comment_id": 66082376, "body": "Please do not use &quot;edit&quot; or &quot;update&quot; tags in your question (or answers) as it results in text that is hard to read. Instead, merge the changes into the text as if they were there originally. We can see what changed if we need to. Also, please read the formatting help which helps us understand what you are asking. The easier it is for us to read, the more quickly and accurately we can help you."}], "answers": [{"comments": [{"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 0, "creation_date": 1473255337, "post_id": 39371212, "comment_id": 66070741, "body": "Note: the OP removed the <a href=\"https://stackoverflow.com/questions/tagged/javascript\">javascript</a> tag and added the <a href=\"https://stackoverflow.com/questions/tagged/ruby\">ruby</a> tag about 10 minutes before you posted your answer (so presumably while you were writing it). Unfortunately, this invalidates your answer."}, {"owner": {"reputation": 1, "user_id": 4750165, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-ieyZW47zF1Q/AAAAAAAAAAI/AAAAAAAAAEM/UY5jUED1b54/photo.jpg?sz=128", "display_name": "MohanL", "link": "https://stackoverflow.com/users/4750165/mohanl"}, "edited": false, "score": 0, "creation_date": 1473256120, "post_id": 39371212, "comment_id": 66071315, "body": "Hi, thank you for your work, so I understand how to do the dom operation, but like do you know to test the speed between using regex and dom operation ?"}, {"owner": {"reputation": 564, "user_id": 6730421, "user_type": "registered", "profile_image": "https://graph.facebook.com/1748493875421937/picture?type=large", "display_name": "Adam Whateverson", "link": "https://stackoverflow.com/users/6730421/adam-whateverson"}, "reply_to_user": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 0, "creation_date": 1473928094, "post_id": 39371212, "comment_id": 66329239, "body": "I do not know the difference in speed between regex and dom operation on the specific code you are parsing. I also don&#39;t know how many times you intend to perform the operation. Sorry I can&#39;t be of any further help.  @J&#246;rgWMittag - Thanks for the head&#39;s up! Yes that&#39;s exactly what has happened! grrr :)"}], "tags": [], "owner": {"reputation": 564, "user_id": 6730421, "user_type": "registered", "profile_image": "https://graph.facebook.com/1748493875421937/picture?type=large", "display_name": "Adam Whateverson", "link": "https://stackoverflow.com/users/6730421/adam-whateverson"}, "is_accepted": false, "score": 0, "last_activity_date": 1473959357, "last_edit_date": 1473959357, "creation_date": 1473254843, "answer_id": 39371212, "question_id": 39370700, "link": "https://stackoverflow.com/questions/39370700/looking-for-a-better-regex-solution/39371212#39371212", "title": "looking for a better regex solution", "body": "<p>I've looked at this problem as if there was a string involved - not a DOM environment. At the end of the day it's &lt; and > that suddenly make it HTML. If you are in control of that string and you understand what it will contain and the boundaries of it then there are many solutions to a problem if it's specific to your needs.</p>\n\n<p>Anyway, if you are looking for an answer and you know all of your questions absolutely live inside a <code>&lt;span&gt;</code> with an attribute of \"question_number\" then I guess you could do something like this. No Regex.</p>\n\n<p>This is a simple version demonstrating how you could extract the information from a HTML string. For simplicity I've stuck it inside a textarea so you can see it actually working. You could copy this code and run it.</p>\n\n<p>However, in reality you will probably want to get the innerHTML value of a container that you know contains all of the <code>&lt;span&gt;</code> tags.</p>\n\n<p>I know there would be a number of different ways of solving this as many suggested but this is an answer to your specific need.</p>\n\n<pre><code>&lt;html&gt;&lt;body&gt;\n    &lt;textarea id='htmlstring'&gt;\n        &lt;div&gt;Random HTML Before&lt;/div&gt;\n        &lt;span question_number=\"18\"&gt;blah blah blah 1&lt;/span&gt;\n        &lt;span question_number=\"19\"&gt;blah blah blah 1&lt;/span&gt;\n        &lt;span question_number=\"21\"&gt;blah blah blah 1&lt;/span&gt;\n        &lt;span question_number=\"22\"&gt;blah blah blah 1&lt;/span&gt;\n        &lt;div&gt;Random HTML After&lt;/div&gt;\n    &lt;/textarea&gt;\n    &lt;script type=\"text/javascript\"&gt;\n        var t = document.getElementById('htmlstring');\n        var q = t.value.split(\"&lt;span question_number=\");\n        q.shift();\n        for(var i in q){\n            var d = q[i].split(\"&lt;/span&gt;\")[0];\n            d = d.replace(\"\\\"&gt;\",\"|\");\n            d = d.replace(\"\\\"\",\"\");\n            d = d.split(\"|\");\n            alert(\"num=\"+d[0]+\" val=\"+d[1]);\n        }\n    &lt;/script&gt;\n&lt;/body&gt;&lt;/html&gt;\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1, "user_id": 4750165, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-ieyZW47zF1Q/AAAAAAAAAAI/AAAAAAAAAEM/UY5jUED1b54/photo.jpg?sz=128", "display_name": "MohanL", "link": "https://stackoverflow.com/users/4750165/mohanl"}, "edited": false, "score": 0, "creation_date": 1473256181, "post_id": 39371378, "comment_id": 66071355, "body": "Thank you so much"}], "tags": [], "owner": {"reputation": 8018, "user_id": 2064981, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/74e3e392c752c4c9acb4ca4fb8f7af65?s=128&d=identicon&r=PG&f=1", "display_name": "SamWhan", "link": "https://stackoverflow.com/users/2064981/samwhan"}, "is_accepted": true, "score": 1, "last_activity_date": 1473255649, "last_edit_date": 1473255649, "creation_date": 1473255292, "answer_id": 39371378, "question_id": 39370700, "link": "https://stackoverflow.com/questions/39370700/looking-for-a-better-regex-solution/39371378#39371378", "title": "looking for a better regex solution", "body": "<p>If it really isn't HTML (hmm?) you could do it with</p>\n\n<pre><code>&lt;span question_number=\"(\\d+)\"&gt;(.*?)&lt;\\/span&gt;\n</code></pre>\n\n<p><a href=\"https://regex101.com/r/iH3uE5/2\" rel=\"nofollow\">See it here at regex101</a>.</p>\n\n<p>The problem with your original regex is that it's <em>greedy</em>. The part <code>(.*)</code> will match as many characters it can, making sure the remaining <code>&lt;\\/span&gt;</code> still can be matched. So it finds the first <code>&lt;span...</code> and matches up to the <strong>last</strong> <code>&lt;/span&gt;</code>. My attempt at a solution is non-greedy (The <code>?</code> in <code>(.*?)</code>), thus just matching to the first <code>&lt;/span&gt;</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 1, "user_id": 4750165, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-ieyZW47zF1Q/AAAAAAAAAAI/AAAAAAAAAEM/UY5jUED1b54/photo.jpg?sz=128", "display_name": "MohanL", "link": "https://stackoverflow.com/users/4750165/mohanl"}, "edited": false, "score": 0, "creation_date": 1473256029, "post_id": 39371594, "comment_id": 66071244, "body": "Thanks a lot. this is awesome."}], "tags": [], "owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "is_accepted": false, "score": 3, "last_activity_date": 1473256134, "last_edit_date": 1473256134, "creation_date": 1473255849, "answer_id": 39371594, "question_id": 39370700, "link": "https://stackoverflow.com/questions/39370700/looking-for-a-better-regex-solution/39371594#39371594", "title": "looking for a better regex solution", "body": "<p>Although you are not parsing an entire HTML document, your input obviously contains HTML elements.</p>\n\n<p>In either case, <a href=\"http://www.nokogiri.org\" rel=\"nofollow\">Nokogiri</a> is the library of choice:</p>\n\n<pre><code>require 'nokogiri'\n\ninput = '&lt;span question_number=\"18\"&gt; blah blah blah 1&lt;/span&gt;&lt;span question_number=\"19\"&gt; blah blah blah 2&lt;/span&gt;'\n\ndoc = Nokogiri::HTML.fragment(input)\ndoc.css('span').map { |s| [s[:question_number], s.text] }\n#=&gt; [[\"18\", \" blah blah blah 1\"], [\"19\", \" blah blah blah 2\"]]\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "is_accepted": false, "score": 1, "last_activity_date": 1473256640, "creation_date": 1473256640, "answer_id": 39371921, "question_id": 39370700, "link": "https://stackoverflow.com/questions/39370700/looking-for-a-better-regex-solution/39371921#39371921", "title": "looking for a better regex solution", "body": "<p>Even though you insist that this isn't HTML, it sure looks and smells like it, and it can, in fact, easily be parsed by an HTML parser:</p>\n\n<pre><code>require 'nokogiri'\n\ndoc = Nokogiri::HTML.fragment &lt;&lt;~'HTML'\n  &lt;span question_number=\"54\"&gt;often graces doorways tied into ropes called&lt;/span&gt; \n  &lt;span question_number=\"54\"&gt;often graces doorways tied into ropes called &lt;i&gt;ristras&lt;/i&gt;.&lt;/span&gt;\nHTML\n\ndoc.xpath('span').map {|span| next span[:question_number].to_i, span.text }\n#=&gt; [[54, \"often graces doorways tied into ropes called\"], [54, \"often graces doorways tied into ropes called ristras.\"]]\n</code></pre>\n\n<p>It is not quite clear to me why you insist on not using an HTML parser for something that is <em>obviously</em> HTML.</p>\n"}], "owner": {"reputation": 1, "user_id": 4750165, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-ieyZW47zF1Q/AAAAAAAAAAI/AAAAAAAAAEM/UY5jUED1b54/photo.jpg?sz=128", "display_name": "MohanL", "link": "https://stackoverflow.com/users/4750165/mohanl"}, "delete_vote_count": 1, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 90, "favorite_count": 0, "closed_date": 1473280423, "accepted_answer_id": 39371378, "answer_count": 4, "score": -4, "last_activity_date": 1473959357, "creation_date": 1473253404, "last_edit_date": 1473256137, "question_id": 39370700, "link": "https://stackoverflow.com/questions/39370700/looking-for-a-better-regex-solution", "closed_reason": "Duplicate", "title": "looking for a better regex solution", "body": "<p>my input is:  <br>\n<code>&lt;span question_number=\"18\"&gt; blah blah blah 1&lt;/span&gt;&lt;span question_number=\"19\"&gt; blah blah blah 2&lt;/span&gt;</code></p>\n\n<p>and I want my regex to match this \n<code>&lt;span question_number=\"somenumber\"&gt;xxxx&lt;/span&gt;</code> pattern <br>\nand the desired output is 1.somenumber 2.xxxx</p>\n\n<p>I wrote a naive solution which could cover <br>\n<code>&lt;span question_number=\"18\"&gt; blah blah blah 1&lt;/span&gt;</code> <br>\n<code>&lt;span question_number=\"19\"&gt; blah blah blah 2&lt;/span&gt;</code><br>\nnotice: they are on different lines <br>\nthe output is : <code>18</code>, <code>blah blah blah 1</code> and <code>19</code>,<code>blah blah blah 2</code> <br></p>\n\n<p>but when the input is <code>&lt;span question_number=\"18\"&gt; blah blah blah 1&lt;/span&gt;&lt;span question_number=\"19\"&gt; blah blah blah 2&lt;/span&gt;</code><br>\nwhich is on the same line</p>\n\n<p>my output is <code>18</code>,  <code>blah blah blah 1&lt;/span&gt;&lt;span question_number=\"19\"&gt; blah blah blah 2</code></p>\n\n<p>how could I bypass this problem?</p>\n\n<p>Update: \nregex: <code>/\\&lt;span question_number=(?:\\\")*(\\d*)(?:\\\")*&gt;(.*)&lt;\\/span&gt;/ig</code></p>\n\n<p>testinput: <br>\ncase1 -> two lines of code <br>\n<code>&lt;span question_number=\"54\"&gt;often graces doorways tied into ropes called&lt;/span&gt;</code> <br>\n<code>&lt;span question_number=\"54\"&gt;often graces doorways tied into ropes called &lt;i&gt;ristras&lt;/i&gt;.&lt;/span&gt;</code><br>\n           case2 -> one line of code <br>\n<code>&lt;span question_number=\"54\"&gt;often graces doorways tied into ropes called&lt;/span&gt;&lt;span question_number=\"54\"&gt;often graces doorways tied into ropes called &lt;i&gt;ristras&lt;/i&gt;.&lt;/span&gt;</code></p>\n\n<p>Update2: <br>\nThis is not a dom , it is just a plain text that I want to process.</p>\n\n<p>Update3:\nso my problem about Regex is solved, now I have a question about comparing the proessing speed between regex or dom operation ? how could implement such a test ? </p>\n"}, {"tags": ["ruby", "postgresql", "sequel"], "comments": [{"owner": {"reputation": 7565, "user_id": 1021515, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/Z9QcP.jpg?s=128&g=1", "display_name": "mwp", "link": "https://stackoverflow.com/users/1021515/mwp"}, "edited": false, "score": 0, "creation_date": 1473298153, "post_id": 39370683, "comment_id": 66090190, "body": "What results did you get, and what results did you expect?"}, {"owner": {"reputation": 169, "user_id": 2257815, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/11a984c29c66bcb3300609a318a17327?s=128&d=identicon&r=PG", "display_name": "Esseme", "link": "https://stackoverflow.com/users/2257815/esseme"}, "reply_to_user": {"reputation": 7565, "user_id": 1021515, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/Z9QcP.jpg?s=128&g=1", "display_name": "mwp", "link": "https://stackoverflow.com/users/1021515/mwp"}, "edited": false, "score": 0, "creation_date": 1473321539, "post_id": 39370683, "comment_id": 66097994, "body": "I expected to insert the data into the DB. I check for evidence of the insert by querying the DB separately. The insert didn&#39;t happen"}], "answers": [{"tags": [], "owner": {"reputation": 169, "user_id": 2257815, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/11a984c29c66bcb3300609a318a17327?s=128&d=identicon&r=PG", "display_name": "Esseme", "link": "https://stackoverflow.com/users/2257815/esseme"}, "is_accepted": true, "score": 1, "last_activity_date": 1475715358, "last_edit_date": 1475715358, "creation_date": 1473766341, "answer_id": 39468975, "question_id": 39370683, "link": "https://stackoverflow.com/questions/39370683/insert-into-db-using-sequel/39468975#39468975", "title": "Insert Into DB using Sequel", "body": "<p>Simply following the code below worked for me:</p>\n\n<pre><code>connection = Sequel.connect('postgres://admin:admin@localhost:5432/test_tcp')\ncards = connection.from(:cards)\ncards.insert(id: 1, card_number: \"13668389\", phone_number: \"256700000000\", uuid: \"9014\", created_at: '2016-09-07 11:11:31', updated_at: '2016-09-07 11:11:31')\nconnection.close\n</code></pre>\n\n<p>Changing the values for <code>:created_at</code> and <code>:updated_at</code> to store time stamps without time zones did the trick.</p>\n\n<p>It is weird how Sequel wouldn't output an error to warn about this.</p>\n"}], "owner": {"reputation": 169, "user_id": 2257815, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/11a984c29c66bcb3300609a318a17327?s=128&d=identicon&r=PG", "display_name": "Esseme", "link": "https://stackoverflow.com/users/2257815/esseme"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 478, "favorite_count": 0, "accepted_answer_id": 39468975, "answer_count": 1, "score": 0, "last_activity_date": 1475715358, "creation_date": 1473253358, "last_edit_date": 1475715301, "question_id": 39370683, "link": "https://stackoverflow.com/questions/39370683/insert-into-db-using-sequel", "title": "Insert Into DB using Sequel", "body": "<p>I want to insert some data into a Postgres DB using Sequel.  I have pursued two approaches, none has yielded the results I want.</p>\n\n<p>My first approach was \"<a href=\"http://sequel.jeremyevans.net/rdoc/files/doc/querying_rdoc.html\" rel=\"nofollow\">Querying in Sequel</a>\":</p>\n\n<pre><code>connection = Sequel.connect('postgres://admin:admin@localhost:5432/test_tcp')    \ninsert_values = connection[\"INSERT INTO cards (:card_number, :phone_number, :uuid, :created_at, :updated_at) VALUES (?)\", '766877868', '256700000000', '9043', '2016-09-07 11:11:31 +0300', '2016-09-07 11:11:31 +0300']\ninsert_values.insert\nconnection.close\n</code></pre>\n\n<p>My second approach was \"<a href=\"https://github.com/jeremyevans/sequel#inserting-records\" rel=\"nofollow\">Inserting Records</a>\":</p>\n\n<pre><code>connection = Sequel.connect('postgres://admin:admin@localhost:5432/test_tcp')\ncards = connection.from(:cards)\ncards.insert(:id =&gt; 1, :card_number =&gt; \"13668389\", :phone_number =&gt; \"256700000000\", :uuid =&gt; \"9014\", :created_at =&gt; '2016-09-07 11:11:31 +0300', :updated_at =&gt; '2016-09-07 11:11:31 +0300')\nconnection.close\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 2, "creation_date": 1473253405, "post_id": 39370629, "comment_id": 66069387, "body": "I suggest creating a third model, <code>Media</code>, which will link to either image or video. It will also handle timestamps and will be easy to paginate/sort."}, {"owner": {"reputation": 546, "user_id": 6361142, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/QmtlI.jpg?s=128&g=1", "display_name": "Bad Hombre", "link": "https://stackoverflow.com/users/6361142/bad-hombre"}, "reply_to_user": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1473254271, "post_id": 39370629, "comment_id": 66070002, "body": "Are you able to show an example, only if you can since I&#39;m a beginner in rails. Thanks either way!"}], "answers": [{"comments": [{"owner": {"reputation": 31720, "user_id": 178150, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/a1316bd8fca88bc14165b9673e480b13?s=128&d=identicon&r=PG", "display_name": "numbers1311407", "link": "https://stackoverflow.com/users/178150/numbers1311407"}, "edited": false, "score": 3, "creation_date": 1473256292, "post_id": 39371470, "comment_id": 66071453, "body": "This is good but it could be refined by making the <code>belongs_to</code> polymorphic, so instead of belonging to either an <code>image</code> or <code>video</code> you belong to a <code>file</code> which can be of any type.  Another possibility would be to use inheritance and make <code>Video</code> and <code>Image</code> both subclasses of <code>Media</code>."}, {"owner": {"reputation": 33, "user_id": 5456838, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-J2vjupQ2pNo/AAAAAAAAAAI/AAAAAAAAABc/pe6hYA9PBrs/photo.jpg?sz=128", "display_name": "Anastasiia Tulentseva", "link": "https://stackoverflow.com/users/5456838/anastasiia-tulentseva"}, "reply_to_user": {"reputation": 31720, "user_id": 178150, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/a1316bd8fca88bc14165b9673e480b13?s=128&d=identicon&r=PG", "display_name": "numbers1311407", "link": "https://stackoverflow.com/users/178150/numbers1311407"}, "edited": false, "score": 0, "creation_date": 1473257944, "post_id": 39371470, "comment_id": 66072675, "body": "@numbers1311407: good points, thanks. This is the simplest one, though, I think. As a beginner, Hipady has a lot to worry about. At this stage, making things work is more important than making things right. :)"}], "tags": [], "owner": {"reputation": 33, "user_id": 5456838, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-J2vjupQ2pNo/AAAAAAAAAAI/AAAAAAAAABc/pe6hYA9PBrs/photo.jpg?sz=128", "display_name": "Anastasiia Tulentseva", "link": "https://stackoverflow.com/users/5456838/anastasiia-tulentseva"}, "is_accepted": false, "score": 1, "last_activity_date": 1473255509, "creation_date": 1473255509, "answer_id": 39371470, "question_id": 39370629, "link": "https://stackoverflow.com/questions/39370629/ruby-on-rails-if-i-have-2-models-can-i-sort-them-both-at-once/39371470#39371470", "title": "ruby on rails - if I have 2 models can I sort them both at once?", "body": "<p>I am going to take the torch here. :) What Sergio means is something like this:</p>\n\n<pre><code>class Media &lt; ActiveRecord::Base\n  belongs_to :image\n  belongs_to :video\nend\n</code></pre>\n\n<p>Then you can sort/filter/paginate it easily</p>\n\n<pre><code>@media = Media.where('created_at &gt; ?', 2.days.ago).order(:id)\n</code></pre>\n\n<p>Just don't forget to create a corresponding media record when you add a new image/video</p>\n\n<pre><code>image = ...\nMedia.create(image: image)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 15106, "user_id": 1117851, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/9FMVK.jpg?s=128&g=1", "display_name": "itsnikolay", "link": "https://stackoverflow.com/users/1117851/itsnikolay"}, "is_accepted": false, "score": 0, "last_activity_date": 1473260165, "creation_date": 1473260165, "answer_id": 39373239, "question_id": 39370629, "link": "https://stackoverflow.com/questions/39370629/ruby-on-rails-if-i-have-2-models-can-i-sort-them-both-at-once/39373239#39373239", "title": "ruby on rails - if I have 2 models can I sort them both at once?", "body": "<p>You can achieve this with <code>UNION</code> sql function:</p>\n\n<pre><code>ActiveRecord::Base.connection.execute('\n  (\n  SELECT images.id, images.created_at, 'Image' as type\n  FROM images\n  ) UNION ALL (\n  SELECT videos.id, videos.created_at, 'Video' as type\n  FROM videos\n  )\n  ORDER BY created_at\n')\n</code></pre>\n\n<p>If you need addition fields you can simply add them (but for both selects)</p>\n"}], "owner": {"reputation": 546, "user_id": 6361142, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/QmtlI.jpg?s=128&g=1", "display_name": "Bad Hombre", "link": "https://stackoverflow.com/users/6361142/bad-hombre"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 63, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1473260165, "creation_date": 1473253200, "question_id": 39370629, "link": "https://stackoverflow.com/questions/39370629/ruby-on-rails-if-i-have-2-models-can-i-sort-them-both-at-once", "title": "ruby on rails - if I have 2 models can I sort them both at once?", "body": "<p>Let's say I have an Image model and a Video model how can I display them both in index by date</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-4", "url", "controller"], "answers": [{"comments": [{"owner": {"reputation": 369, "user_id": 3997439, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/L7TFV.png?s=128&g=1", "display_name": "plombix", "link": "https://stackoverflow.com/users/3997439/plombix"}, "edited": false, "score": 0, "creation_date": 1473254322, "post_id": 39370966, "comment_id": 66070040, "body": "AND create a route in config/route.rb to redirect &#39;search_path&#39; to your method."}], "tags": [], "owner": {"reputation": 19261, "user_id": 4758119, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/F4dJY.jpg?s=128&g=1", "display_name": "Deepak Mahakale", "link": "https://stackoverflow.com/users/4758119/deepak-mahakale"}, "is_accepted": true, "score": 2, "last_activity_date": 1473254190, "creation_date": 1473254190, "answer_id": 39370966, "question_id": 39370578, "link": "https://stackoverflow.com/questions/39370578/rails-4-how-to-prevent-jumping-to-index/39370966#39370966", "title": "Rails 4: How to prevent jumping to index", "body": "<p>Change the <code>tools_path</code> to <code>search_path</code> in your view</p>\n\n<pre><code>= form_tag search_path, :method =&gt; 'get' do\n  = text_field_tag :search, params[:search]\n  = submit_tag \"Search\"\n</code></pre>\n\n<p>I will also suggest changing the method to <code>POST</code> as its form submission</p>\n"}], "owner": {"reputation": 159, "user_id": 6789165, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/2390e9333ab37c397ce2b94840de5864?s=128&d=identicon&r=PG&f=1", "display_name": "Gugubaight", "link": "https://stackoverflow.com/users/6789165/gugubaight"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 41, "favorite_count": 0, "accepted_answer_id": 39370966, "answer_count": 1, "score": 0, "last_activity_date": 1473255946, "creation_date": 1473253011, "last_edit_date": 1473255946, "question_id": 39370578, "link": "https://stackoverflow.com/questions/39370578/rails-4-how-to-prevent-jumping-to-index", "title": "Rails 4: How to prevent jumping to index", "body": "<p><br></p>\n\n<p>I am fairly new to rails and currently coding my first app.<br>\nI created a search for the name of my tools model. It's passing the params correctly but constantly (jumps/redirects/passes the params) to the index of my model. How can I <strong>direct</strong> it <strong>to the tools#search site</strong> (site with the search form)?</p>\n\n<p>A URL overview:</p>\n\n<pre><code>http://localhost:3000/search # Start\nhttp://localhost:3000/tools?utf8=%E2%9C%93&amp;search=&amp;commit=Search # Directed to\nhttp://localhost:3000/search?utf8=%E2%9C%93&amp;search=&amp;commit=Search # Where it should direct to\n</code></pre>\n\n<p>A code overview:</p>\n\n<p><em>Routes</em></p>\n\n<pre><code>get '/search' =&gt; 'tools#search'\n</code></pre>\n\n<p><em>Tool Model</em></p>\n\n<pre><code># Search \ndef self.search(search)\n  if search\n    where([\"title LIKE ?\", \"#{search}\"])\n  else\n    all\n  end\nend\n</code></pre>\n\n<p><em>Tools Controller</em></p>\n\n<pre><code>def search\n  @tools = Tool.search(params[:search]).order(\"created_at DESC\")\nend\n</code></pre>\n\n<p><em>Search View (app/views/tools/search.html.haml)</em></p>\n\n<pre><code>= form_tag search_path, :method =&gt; 'post' do\n    = text_field_tag :search, params[:search]\n    = submit_tag \"Search\"\n\n- @tools.each do |tool|\n    = image_tag tool.cover_filename.url\n    %h2= link_to tool.title, tool\n    %p= tool.subtitle\n    %p= link_to tool.user.try(:username), '/users/'+tool.user_id.to_s\n    %p= tool.impressionist_count\n    %p= link_to tool.get_upvotes.size, like_tool_path(tool), method: :get\n    %p= link_to \"Favorite\", favorite_tool_path(tool, type: \"favorite\"), method: :get\n    %p= link_to \"Unfavorite\", favorite_tool_path(tool, type: \"unfavorite\"), method: :get\n    %p= link_to \"Edit\", edit_tool_path(tool)\n    %p= link_to 'http://ocubit.com/tools/'+tool.id.to_s\n    %p= time_ago_in_words(tool.created_at)\n</code></pre>\n\n<p>Thanks for all helpful replies, appreciated!</p>\n"}, {"tags": ["ruby", "floating-point", "number-formatting"], "comments": [{"owner": {"reputation": 702, "user_id": 2813483, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/a806405fb6823e63f56544a44d1323b1?s=128&d=identicon&r=PG&f=1", "display_name": "tessie", "link": "https://stackoverflow.com/users/2813483/tessie"}, "edited": false, "score": 0, "creation_date": 1473251646, "post_id": 39369973, "comment_id": 66068035, "body": "Float(&quot;2,50&quot;) rescue nil gives nil not 2,5"}, {"owner": {"reputation": 1907, "user_id": 1902570, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/110a426ea70c739aa926efef57ab8428?s=128&d=identicon&r=PG", "display_name": "Leo", "link": "https://stackoverflow.com/users/1902570/leo"}, "reply_to_user": {"reputation": 702, "user_id": 2813483, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/a806405fb6823e63f56544a44d1323b1?s=128&d=identicon&r=PG&f=1", "display_name": "tessie", "link": "https://stackoverflow.com/users/2813483/tessie"}, "edited": false, "score": 0, "creation_date": 1473251785, "post_id": 39369973, "comment_id": 66068123, "body": "i edited the question, its legit now"}, {"owner": {"reputation": 3740, "user_id": 1053938, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/59b4bb22f374b4224067923e11524a24?s=128&d=identicon&r=PG", "display_name": "jonhopkins", "link": "https://stackoverflow.com/users/1053938/jonhopkins"}, "edited": false, "score": 0, "creation_date": 1473252365, "post_id": 39369973, "comment_id": 66068559, "body": "As far as I can tell, you seem to be looking for <code>printf(&quot;%.2f&quot;, theFloat)</code>. The 0 at the end is there (<code>2.5 == 2.50 == 2.500000000</code>), I guess it&#39;s just not being displayed if you print out the plain float value."}, {"owner": {"reputation": 702, "user_id": 2813483, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/a806405fb6823e63f56544a44d1323b1?s=128&d=identicon&r=PG&f=1", "display_name": "tessie", "link": "https://stackoverflow.com/users/2813483/tessie"}, "edited": false, "score": 0, "creation_date": 1473252698, "post_id": 39369973, "comment_id": 66068809, "body": "Float(&quot;2.5&quot;).to_f rescue nil"}, {"owner": {"reputation": 41082, "user_id": 82592, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/e1b105626dd9cfd15e543af82e470fd7?s=128&d=identicon&r=PG", "display_name": "Mladen Jablanovi\u0107", "link": "https://stackoverflow.com/users/82592/mladen-jablanovi%c4%87"}, "edited": false, "score": 3, "creation_date": 1473252870, "post_id": 39369973, "comment_id": 66068963, "body": "From the mathematical standpoint, 2.5 and 2.50 are the same number. If you care about the trailing zero, perhaps you don&#39;t need Float at all. Why are you converting to Float to begin with?"}, {"owner": {"reputation": 1907, "user_id": 1902570, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/110a426ea70c739aa926efef57ab8428?s=128&d=identicon&r=PG", "display_name": "Leo", "link": "https://stackoverflow.com/users/1902570/leo"}, "edited": false, "score": 0, "creation_date": 1473253134, "post_id": 39369973, "comment_id": 66069185, "body": "i need this value to eventually become number i can perform math operations on. and i need the trailing 0 for displaying purposes"}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 1, "creation_date": 1473253304, "post_id": 39369973, "comment_id": 66069303, "body": "@Leo &quot;displaying purposes&quot; means formatting which belongs in your view.  <a href=\"http://api.rubyonrails.org/classes/ActiveSupport/NumberHelper.html\" rel=\"nofollow noreferrer\"><code>ActiveSupport::NumberHelper</code></a> provides several helper methods."}, {"owner": {"reputation": 11741, "user_id": 1934428, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/072774c5d4204a1c2385560e6114a887?s=128&d=identicon&r=PG", "display_name": "user1934428", "link": "https://stackoverflow.com/users/1934428/user1934428"}, "edited": false, "score": 0, "creation_date": 1473253343, "post_id": 39369973, "comment_id": 66069331, "body": "@Leo: There are no &quot;hidden / unhidden&quot; zeroes in a Float. <code>2.5 == 2.50</code> evaluates to <code>true</code>.  If you want to &quot;remember&quot;, how the string representation of the value had been before, you simply have to keep the string around as well."}], "answers": [{"tags": [], "owner": {"reputation": 679, "user_id": 193811, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/661d51c45a74e6884171ca715b9b1cd7?s=128&d=identicon&r=PG", "display_name": "William Daniel", "link": "https://stackoverflow.com/users/193811/william-daniel"}, "is_accepted": true, "score": 2, "last_activity_date": 1473253732, "creation_date": 1473253732, "answer_id": 39370803, "question_id": 39369973, "link": "https://stackoverflow.com/questions/39369973/float-with-unnecessary-digits/39370803#39370803", "title": "Float with &#39;unnecessary&#39; digits", "body": "<p>In short, the answer is no, given the question, as any Float, when examined, will use Float's <code>to_s</code> function, eliciting an answer without trailing zeroes.</p>\n\n<p>Float will always give you a numeric value that can be interpreted any way you wish, though. In your example, you <em>will</em> get a float value (given a string that is a parsable float). What you are asking then, is how to display that value <em>with</em> trailing zeroes. To do that, you will be turning the float value back into a string.</p>\n\n<p>Easiest way to accomplish that is to use the format given by one of your respondents, namely</p>\n\n<pre><code>string_var = \"2.50\"\nfloat_value = Float(string_var) rescue nil # 2.5\nwith_trailing_zeroes = \"%0.2f\" % float_value # '2.50'\n</code></pre>\n"}], "owner": {"reputation": 1907, "user_id": 1902570, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/110a426ea70c739aa926efef57ab8428?s=128&d=identicon&r=PG", "display_name": "Leo", "link": "https://stackoverflow.com/users/1902570/leo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 54, "favorite_count": 0, "accepted_answer_id": 39370803, "answer_count": 1, "score": 0, "last_activity_date": 1473253732, "creation_date": 1473251259, "last_edit_date": 1473252921, "question_id": 39369973, "link": "https://stackoverflow.com/questions/39369973/float-with-unnecessary-digits", "title": "Float with &#39;unnecessary&#39; digits", "body": "<p>I need to make a number out of the string. to do that i use well known maneuver looking something like this:</p>\n\n<pre><code>Float(string_var) rescue nil\n</code></pre>\n\n<p>This works nicely, however I do have a tiny, little problem. If a string is <code>\"2.50\"</code>, variable I get is <code>2.5</code>. Is it even possible to create Float object with 'unnecessary' 0 digit at the end? can I literally translate <code>\"2.50\"</code> into <code>2.50</code> ?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "microservices"], "answers": [{"comments": [{"owner": {"reputation": 214, "user_id": 2620759, "user_type": "registered", "accept_rate": 64, "profile_image": "https://graph.facebook.com/100000922537898/picture?type=large", "display_name": "NowNick", "link": "https://stackoverflow.com/users/2620759/nownick"}, "edited": false, "score": 0, "creation_date": 1473327167, "post_id": 39370040, "comment_id": 66101231, "body": "Cool. Just checked out the RubyMine tool and it generated a UML diagram of our code. Thanks buddy!"}], "tags": [], "owner": {"reputation": 1185, "user_id": 2099148, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d451ee2c3307e3419d6a3b2cc2d2c31d?s=128&d=identicon&r=PG", "display_name": "M_G", "link": "https://stackoverflow.com/users/2099148/m-g"}, "is_accepted": true, "score": 1, "last_activity_date": 1473251478, "creation_date": 1473251478, "answer_id": 39370040, "question_id": 39369856, "link": "https://stackoverflow.com/questions/39369856/tool-for-slicing-app-into-microservices/39370040#39370040", "title": "Tool for slicing app into microservices", "body": "<p>You could start using the model dependency diagram from RubyMine: <a href=\"https://www.jetbrains.com/help/ruby/2016.2/viewing-model-dependency-diagram.html\" rel=\"nofollow\">https://www.jetbrains.com/help/ruby/2016.2/viewing-model-dependency-diagram.html</a></p>\n\n<p>Another tool which includes controller dependencies is <a href=\"https://github.com/preston/railroady\" rel=\"nofollow\">https://github.com/preston/railroady</a></p>\n"}], "owner": {"reputation": 214, "user_id": 2620759, "user_type": "registered", "accept_rate": 64, "profile_image": "https://graph.facebook.com/100000922537898/picture?type=large", "display_name": "NowNick", "link": "https://stackoverflow.com/users/2620759/nownick"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 44, "favorite_count": 0, "accepted_answer_id": 39370040, "answer_count": 1, "score": 0, "last_activity_date": 1473251478, "creation_date": 1473250902, "question_id": 39369856, "link": "https://stackoverflow.com/questions/39369856/tool-for-slicing-app-into-microservices", "title": "Tool for slicing app into microservices", "body": "<p>We've refactored our code a bit and I feel that we could separate some parts of our app into microservices. However it would be helpful to use a tool that would show me a graph of references between parts (directories) of our app.</p>\n\n<p>Our app is in Ruby on Rails.</p>\n\n<p>I know that I won't get 100% coverage of coupling between modules since ruby is a dynamic language... any graph would be useful though.</p>\n"}, {"tags": ["javascript", "jquery", "html", "ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 30794, "user_id": 1906356, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-nOR-lGSM4OQ/AAAAAAAAAAI/AAAAAAAAAKc/JK3VzYOOB-I/photo.jpg?sz=128", "display_name": "madalinivascu", "link": "https://stackoverflow.com/users/1906356/madalinivascu"}, "edited": false, "score": 0, "creation_date": 1473249423, "post_id": 39369244, "comment_id": 66066422, "body": "what is this  <code>page:load</code> event? ,never heard of it"}, {"owner": {"reputation": 738, "user_id": 3521315, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/w55jb.jpg?s=128&g=1", "display_name": "Mike.Whitehead", "link": "https://stackoverflow.com/users/3521315/mike-whitehead"}, "reply_to_user": {"reputation": 30794, "user_id": 1906356, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-nOR-lGSM4OQ/AAAAAAAAAAI/AAAAAAAAAKc/JK3VzYOOB-I/photo.jpg?sz=128", "display_name": "madalinivascu", "link": "https://stackoverflow.com/users/1906356/madalinivascu"}, "edited": false, "score": 0, "creation_date": 1473253110, "post_id": 39369244, "comment_id": 66069164, "body": "That relates to the stripe payment process."}], "answers": [{"comments": [{"owner": {"reputation": 738, "user_id": 3521315, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/w55jb.jpg?s=128&g=1", "display_name": "Mike.Whitehead", "link": "https://stackoverflow.com/users/3521315/mike-whitehead"}, "edited": false, "score": 0, "creation_date": 1473256491, "post_id": 39370401, "comment_id": 66071612, "body": "Thanks, but when I try this the event price is assumed as zero. I obviously need the initial event price to reflect the actual price for the event."}, {"owner": {"reputation": 2256, "user_id": 2241124, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/bc5006fe57f3543b66290035bb9ef0c7?s=128&d=identicon&r=PG", "display_name": "seancdavis", "link": "https://stackoverflow.com/users/2241124/seancdavis"}, "reply_to_user": {"reputation": 738, "user_id": 3521315, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/w55jb.jpg?s=128&g=1", "display_name": "Mike.Whitehead", "link": "https://stackoverflow.com/users/3521315/mike-whitehead"}, "edited": false, "score": 0, "creation_date": 1473259827, "post_id": 39370401, "comment_id": 66074240, "body": "Definitely. When you find <code>@event</code> in your <code>new</code> action, <code>@event.price</code> should be already set. Added a few details to the answer."}, {"owner": {"reputation": 738, "user_id": 3521315, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/w55jb.jpg?s=128&g=1", "display_name": "Mike.Whitehead", "link": "https://stackoverflow.com/users/3521315/mike-whitehead"}, "edited": false, "score": 0, "creation_date": 1473333204, "post_id": 39370401, "comment_id": 66104997, "body": "Do I need to add something in the booking model to reflect the quantity? I&#39;ve included the booking model in the question above which reflects my attempts to work out a total_amount method using Ruby. Does this need to come out now?"}, {"owner": {"reputation": 738, "user_id": 3521315, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/w55jb.jpg?s=128&g=1", "display_name": "Mike.Whitehead", "link": "https://stackoverflow.com/users/3521315/mike-whitehead"}, "edited": false, "score": 0, "creation_date": 1473334553, "post_id": 39370401, "comment_id": 66105804, "body": "None of the above is working. I&#39;m still getting 0.0 as a starter point rather than the event price (for one space) and when adding quantity its not changing at all."}, {"owner": {"reputation": 738, "user_id": 3521315, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/w55jb.jpg?s=128&g=1", "display_name": "Mike.Whitehead", "link": "https://stackoverflow.com/users/3521315/mike-whitehead"}, "edited": false, "score": 0, "creation_date": 1473335084, "post_id": 39370401, "comment_id": 66106109, "body": "I&#39;m not sure if I&#39;m being silly here (I&#39;m a real novice at javascript) but when I look at your fiddle and add quantity the total amount doesn&#39;t change - it stays at &#163;10."}], "tags": [], "owner": {"reputation": 2256, "user_id": 2241124, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/bc5006fe57f3543b66290035bb9ef0c7?s=128&d=identicon&r=PG", "display_name": "seancdavis", "link": "https://stackoverflow.com/users/2241124/seancdavis"}, "is_accepted": false, "score": 0, "last_activity_date": 1473259805, "last_edit_date": 1473259805, "creation_date": 1473252556, "answer_id": 39370401, "question_id": 39369244, "link": "https://stackoverflow.com/questions/39369244/javascript-jquery-price-calculation/39370401#39370401", "title": "Javascript / jQuery - Price calculation", "body": "<p>As you suggest, one approach is to use JavaScript to calculate the total.</p>\n\n<p>You could change this snippet of your view:</p>\n\n<pre><code>&lt;p&gt;\n  Confirm number of spaces you wish to book here:\n  &lt;input type=\"number\" placeholder=\"1\"  min=\"1\" value=\"1\"&gt;\n&lt;/p&gt;\n&lt;p&gt;Total Amount   \u00a3&lt;%= @event.price %&gt;&lt;/p&gt;\n</code></pre>\n\n<p>to make it easier to target with jQuery and to provide a reference to the price per space. For example:</p>\n\n<pre><code>&lt;div class=\"calculate-total\"&gt;\n  &lt;p&gt;\n    Confirm number of spaces you wish to book here:\n    &lt;input type=\"number\" placeholder=\"1\"  min=\"1\" value=\"1\"&gt;\n  &lt;/p&gt;\n  &lt;p&gt;\n    Total Amount\n    \u00a3&lt;span class=\"total\" data-unit-cost=\"&lt;%= @event.price %&gt;\"&gt;0&lt;/span&gt;\n  &lt;/p&gt;\n&lt;/div&gt;\n</code></pre>\n\n<p>Using JavaScript, you can listen for a <code>keyup</code> event on the input field and perform the calculation.</p>\n\n<pre><code>$('.calculate-total input').on('keyup', calculateBookingPrice);\n\nfunction calculateBookingPrice() {\n  var unitCost = parseFloat($('.calculate-total .total').data('unit-cost')),\n      numSpaces = parseInt($('.calculate-total .num-spaces').val()),\n      total = (numSpaces * unitCost).toFixed(2);\n\n  if (isNaN(total)) {\n    total = 0;\n  }\n\n  $('.calculate-total span.total').text(total);\n}\n</code></pre>\n\n<p>Having the function separated from the event listener means you could also call it when the page loads so that you have a starting value.</p>\n\n<p><a href=\"https://jsfiddle.net/seancdavis/3vn2qbn8/2/\" rel=\"nofollow\">Here's a fiddle</a> to demonstrate (it assumes <code>@event.price</code> is 10).</p>\n\n<p><strong>UPDATE</strong></p>\n\n<p>The key here is that <code>@event.price</code> should return the unit price of a booking. Your <em>new</em> action can be as simple as this:</p>\n\n<pre><code>def new\n  # Find the event for the booking.\n  @event = Event.find(params[:event_id])\n  # @event.price should return the unit cost of a booking.\n\n  # Don't need to set attributes here -- you can add them in create.\n  @booking = @event.bookings.new\nend\n</code></pre>\n\n<p>Also note that if you want to store <code>quantity</code> and/or <code>total_amount</code> on your <code>@booking</code> object, you should move the fields inside your form (<code>simple_form_for</code>) and adjust the markup so they are submitted as part of the booking. something like this:</p>\n\n<pre><code>&lt;%= simple_form_for [@event, @booking], id: \"new_booking\" do |form| %&gt;\n  &lt;%= f.input :quantity %&gt;\n  &lt;%= f.input :total_amount %&gt;\n  ...\n</code></pre>\n\n<p>And adjust your JavaScript to target these inputs (instead of the <code>input</code> and <code>span</code> in my original post).</p>\n"}], "owner": {"reputation": 738, "user_id": 3521315, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/w55jb.jpg?s=128&g=1", "display_name": "Mike.Whitehead", "link": "https://stackoverflow.com/users/3521315/mike-whitehead"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 812, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1473333299, "creation_date": 1473249260, "last_edit_date": 1473333299, "question_id": 39369244, "link": "https://stackoverflow.com/questions/39369244/javascript-jquery-price-calculation", "title": "Javascript / jQuery - Price calculation", "body": "<p>I'm building an events app using Ruby on Rails. At the moment a user who wishes to book onto an event can only book and pay for one space at a time. I need to offer the facility for them to book multiple spaces and pay the appropriate price - so 5 spaces for \u00a310 each = \u00a350 to pay etc. \nI've looked for appropriate solutions in RoR to sort this but I'm hitting a brick wall. \nHowever, I believe I've perhaps approached this the wrong way and that a solution using javascript or jQuery is the best way forward. \nI'm very much a novice at both and need some assistance in achieving this objective.</p>\n\n<p>Here's my payment/booking page - </p>\n\n<p><a href=\"https://i.stack.imgur.com/7R9yN.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/7R9yN.png\" alt=\"Booking page\"></a></p>\n\n<p>I want a User to be able to place the number of spaces in the first text area and for the price (total amount) to change accordingly.</p>\n\n<p>Here's my other relevant code -</p>\n\n<p><strong>booking.rb</strong> -</p>\n\n<pre><code>class Booking &lt; ActiveRecord::Base\n\n    belongs_to :event\n    belongs_to :user\n\n    def total_amount\n\n        #quantity.to_i * @price_currency.to_money\n        quantity.to_i * strip_currency(event.price)\n    end\n\n    private\n\n        def strip_currency(amount = '')\n            amount.to_s.gsub(/[^\\D\\.]/, '').to_f\n        end\n\n\n\nend\n</code></pre>\n\n<p><strong>bookings_controller.rb</strong></p>\n\n<pre><code>class BookingsController &lt; ApplicationController\n\n    before_action :authenticate_user!\n\n    def new\n        # booking form\n        # I need to find the event that we're making a booking on\n        @event = Event.find(params[:event_id])\n        # and because the event \"has_many :bookings\"\n        @booking = @event.bookings.new(quantity: params[:quantity])\n        # which person is booking the event?\n        @booking.user = current_user\n        #@booking.quantity = @booking.quantity\n        @total_amount = @booking.quantity.to_f * @event.price.to_f\n    end\n\n    def create\n        # actually process the booking\n        @event = Event.find(params[:event_id])\n        @booking = @event.bookings.new(booking_params)\n        @booking.user = current_user\n        @price = price\n        @quantity = quantity\n        #@total_amount = @booking.quantity.to_f * @event.price.to_f\n\n        Booking.transaction do\n\n            @event.reload\n            if @event.bookings.count &gt; @event.number_of_spaces\n            flash[:warning] = \"Sorry, this event is fully booked.\"\n            raise ActiveRecord::Rollback, \"event is fully booked\"\n            end \n        end\n\n        if @booking.save\n\n            # CHARGE THE USER WHO'S BOOKED\n            # #{} == puts a variable into a string\n            Stripe::Charge.create(amount: @event.price_pennies, currency: \"gbp\",\n                card: @booking.stripe_token, description: \"Booking number #{@booking.id}\")\n\n            flash[:success] = \"Your place on our event has been booked\"\n            redirect_to event_path(@event)\n        else\n            flash[:error] = \"Payment unsuccessful\"\n            render \"new\"\n        end\n\n        if @event.is_free?\n\n            @booking.save!\n            flash[:success] = \"Your place on our event has been booked\"\n            redirect_to event_path(@event)\n        end\n    end\n\n    #def total_amount\n        #@total_amount = @booking.quantity * @event.price\n    #end\n\n    private\n\n      def booking_params\n        params.require(:booking).permit(:stripe_token, :quantity)\n      end\n\nend\n</code></pre>\n\n<p><strong>bookings.new.html.erb</strong></p>\n\n<pre><code>&lt;div class=\"col-md-6 col-md-offset-3\" id=\"eventshow\"&gt;\n  &lt;div class=\"row\"&gt;\n    &lt;div class=\"panel panel-default\"&gt;\n        &lt;div class=\"panel-heading\"&gt;\n            &lt;h2&gt;Confirm Your Booking&lt;/h2&gt;\n        &lt;/div&gt;\n\n            &lt;div class=\"panel-body\"&gt;    \n                &lt;p&gt;Confirm number of spaces you wish to book here:\n                  &lt;input type=\"number\" placeholder=\"1\"  min=\"1\" value=\"1\"&gt;&lt;/p&gt;\n                &lt;p&gt;Total Amount   \u00a3&lt;%= @event.price %&gt;&lt;/p&gt;\n                &lt;%= simple_form_for [@event, @booking], id: \"new_booking\" do |form| %&gt;\n\n\n\n                 &lt;span class=\"payment-errors\"&gt;&lt;/span&gt;\n\n                &lt;div class=\"form-row\"&gt;\n                    &lt;label&gt;\n                      &lt;span&gt;Card Number&lt;/span&gt;\n                      &lt;input type=\"text\" size=\"20\" data-stripe=\"number\"/&gt;\n                    &lt;/label&gt;\n                &lt;/div&gt;\n\n                &lt;div class=\"form-row\"&gt;\n                  &lt;label&gt;\n                  &lt;span&gt;CVC&lt;/span&gt;\n                  &lt;input type=\"text\" size=\"4\" data-stripe=\"cvc\"/&gt;\n                  &lt;/label&gt;\n                &lt;/div&gt;\n\n                &lt;div class=\"form-row\"&gt;\n                    &lt;label&gt;\n                        &lt;span&gt;Expiration (MM/YYYY)&lt;/span&gt;\n                        &lt;input type=\"text\" size=\"2\" data-stripe=\"exp-month\"/&gt;\n                    &lt;/label&gt;\n                    &lt;span&gt; / &lt;/span&gt;\n                    &lt;input type=\"text\" size=\"4\" data-stripe=\"exp-year\"/&gt;\n                &lt;/div&gt;\n            &lt;/div&gt;\n            &lt;div class=\"panel-footer\"&gt;    \n\n               &lt;%= form.button :submit %&gt;\n\n\n            &lt;/div&gt; \n\n&lt;% end %&gt;\n&lt;% end %&gt;\n\n      &lt;/div&gt;\n  &lt;/div&gt;\n&lt;/div&gt;    \n\n&lt;script type=\"text/javascript\" src=\"https://js.stripe.com/v2/\"&gt;&lt;/script&gt;\n\n&lt;script type=\"text/javascript\"&gt;\n  Stripe.setPublishableKey('&lt;%= STRIPE_PUBLIC_KEY %&gt;');\n  var stripeResponseHandler = function(status, response) {\n    var $form = $('#new_booking');\n\n    if (response.error) {\n    // Show the errors on the form\n    $form.find('.payment-errors').text(response.error.message);\n    $form.find('input[type=submit]').prop('disabled', false);\n    } else {\n    // token contains id, last4, and card type\n    var token = response.id;\n    // Insert the token into the form so it gets submitted to the server\n    $form.append($('&lt;input type=\"hidden\" name=\"booking[stripe_token]\"     /&gt;').val(token));\n    // and submit\n    $form.get(0).submit();\n    }\n  };\n\n  // jQuery(function($)  { - changed to the line below\n  $(document).on(\"ready page:load\", function () {\n\n    $('#new_booking').submit(function(event) {\n      var $form = $(this);\n\n      // Disable the submit button to prevent repeated clicks\n      $form.find('input[type=submit]').prop('disabled', true);\n\n      Stripe.card.createToken($form, stripeResponseHandler);\n\n      // Prevent the form from submitting with the default action\n      return false;\n    });\n  });\n&lt;/script&gt;\n</code></pre>\n\n<p>One aspect of building this site which I didn't appreciate is how difficult and complex it can be to deal with money when using RoR. A few of the suggestions I've received stated I should be using the monetize gem (I'm not, I'm using money-rails) and this coupled with some model method/MVC magic would achieve this. However, I think I'd prefer this route if the right solution can be found.              </p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 1, "creation_date": 1473248881, "post_id": 39368909, "comment_id": 66066052, "body": "Do you just want to check the syntax or also the values, e.g. would you consider <code>2016-02-30</code> a valid date?"}, {"owner": {"reputation": 38307, "user_id": 2057388, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ceef8c04f66cd0e2bd360ef6abc14a81?s=128&d=identicon&r=PG", "display_name": "\u0417\u0435\u043b\u0451\u043d\u044b\u0439", "link": "https://stackoverflow.com/users/2057388/%d0%97%d0%b5%d0%bb%d1%91%d0%bd%d1%8b%d0%b9"}, "edited": false, "score": 0, "creation_date": 1473249389, "post_id": 39368909, "comment_id": 66066398, "body": "How about a regexp validation <code>&#39;2016-01-01&#39;.match(&#47;\\d{4}-\\d{2}-\\d{2}&#47;) =&gt; nil or MatchData</code>. ?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user6801385"}, "reply_to_user": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1473252047, "post_id": 39368909, "comment_id": 66068334, "body": "@Stefan i want to check if 2016-02-30 in the valid format of %Y-%m-%d"}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 1, "creation_date": 1473252899, "post_id": 39368909, "comment_id": 66068989, "body": "@user6801385 well, it depends. On the one hand, each individual value is valid: <code>2016</code> is a valid year, <code>02</code> is a valid month, and <code>30</code> is a valid day. But on the other hand, <a href=\"https://en.wikipedia.org/wiki/February_30\" rel=\"nofollow noreferrer\">February 30</a> is not a valid date and you can&#39;t parse <code>2016-02-30</code> using <code>%Y-%m-%d</code>. Please clarify your requirements."}], "answers": [{"comments": [{"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 1, "creation_date": 1473250629, "post_id": 39369104, "comment_id": 66067313, "body": "Note that <code>strptime</code> allows extraneous characters, e.g. <code>valid_date?(&#39;2016-01-01 foo-bar&#39;)</code> would return <code>true</code>."}, {"owner": {"user_type": "does_not_exist", "display_name": "user6801385"}, "edited": false, "score": 0, "creation_date": 1473251496, "post_id": 39369104, "comment_id": 66067922, "body": "@spickermann thank you, do you know why when I am passing &#39;2016-01-01&#39; I get &quot;date is not valid&quot; ?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user6801385"}, "edited": false, "score": 0, "creation_date": 1473251912, "post_id": 39369104, "comment_id": 66068237, "body": "both <code>valid_date?(&#39;2016-01-01&#39;) and valid_date?(&#39;2016-01-32&#39;)</code> return date is not valid"}, {"owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 0, "creation_date": 1473252000, "post_id": 39369104, "comment_id": 66068306, "body": "Did you copy the whole method from my answer, including all parentheses and the <code>require &#39;date&#39;</code>?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user6801385"}, "edited": false, "score": 0, "creation_date": 1473252254, "post_id": 39369104, "comment_id": 66068475, "body": "ok, i think i have a problem with my script, just a sec, im checking, thank u"}, {"owner": {"user_type": "does_not_exist", "display_name": "user6801385"}, "edited": false, "score": 0, "creation_date": 1473252415, "post_id": 39369104, "comment_id": 66068602, "body": "ok so im passing the date from aws ec2 tag like this  <code>tag_expiration = Facter::Util::Resolution.exec(&quot;ec2-describe-tags --region #{region} --filter \\&quot;resource-id=#{instance.id}\\&quot; --filter key=Expiration | cut -f 5&quot;)</code> , the result of my tag is <code>01-01-2016</code>, and this one return valid when im passing it to the method <code>valid_date?(tag_expiration)</code> do you know why ?"}, {"owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 0, "creation_date": 1473252820, "post_id": 39369104, "comment_id": 66068921, "body": "If your tag looks like <code>01-01-2016</code> then you should not try to parse it with <code>&#39;%Y-%m-%d&#39;</code>. Perhaps <code>&#39;%d-%m-%Y&#39;</code> would be more appropriate?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user6801385"}, "edited": false, "score": 0, "creation_date": 1473253129, "post_id": 39369104, "comment_id": 66069180, "body": "i checked it again, <code>valid_date?(&#39;01-01-2016&#39;) return &#39;date is valid&#39;</code>, <code>valid_date?(&#39;2016-01-01&#39;) return date is valid</code> and <code>valid_date?(&#39;2016-01-32&#39;) return date is not valid</code>"}, {"owner": {"user_type": "does_not_exist", "display_name": "user6801385"}, "edited": false, "score": 0, "creation_date": 1473253252, "post_id": 39369104, "comment_id": 66069273, "body": "I wanted to make sure that if that date is not in the format of <code>2016-01-30</code> or <code>yyyy-month-day</code> it will return date is not valid"}, {"owner": {"user_type": "does_not_exist", "display_name": "user6801385"}, "edited": false, "score": 0, "creation_date": 1473253290, "post_id": 39369104, "comment_id": 66069293, "body": "I checked <code>01-01-2016</code> because I wanted to see if its works"}, {"owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 0, "creation_date": 1473253499, "post_id": 39369104, "comment_id": 66069443, "body": "I updated my answer to address that issue. Now it checks both the format and if it is a valid date."}, {"owner": {"user_type": "does_not_exist", "display_name": "user6801385"}, "edited": false, "score": 0, "creation_date": 1473253816, "post_id": 39369104, "comment_id": 66069678, "body": "cool !!! it works, last question how I can do the same this but add into it that also the string &quot;never&quot; is a valid date ?"}], "tags": [], "owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "is_accepted": true, "score": 6, "last_activity_date": 1530441597, "last_edit_date": 1530441597, "creation_date": 1473248879, "answer_id": 39369104, "question_id": 39368909, "link": "https://stackoverflow.com/questions/39368909/ruby-date-format-validation/39369104#39369104", "title": "Ruby date format validation", "body": "<p>It seems like you are not only interested in the format of the string but also if the string represents a valid date (for example <code>2016-01-32</code> is invalid):</p>\n\n<pre><code>require 'date'\n\ndef validate_date(string)\n  format_ok = string.match(/\\d{4}-\\d{2}-\\d{2}/)\n  parseable = Date.strptime(string, '%Y-%m-%d') rescue false\n\n  if string == 'never' || format_ok &amp;&amp; parseable\n    puts \"date is valid\"\n  else\n    puts \"date is not valid\"\n  end\nend\n\nvalidate_date('2016-01-01')\n#=&gt; \"date is valid\"\n\nvalidate_date('2016-01-32')\n#=&gt; \"date is not valid\"\n\nvalidate_date('01-01-2016')\n#=&gt; \"date is not valid\"\n\nvalidate_date('never')\n#=&gt; \"date is valid\"\n\nvalidate_date('today')\n#=&gt; \"date is not valid\"\n</code></pre>\n\n<p>Or (would return <code>true</code> or <code>false</code>):</p>\n\n<pre><code>require 'date'\n\ndef valid_date?(string)\n  return true if string == 'never'\n\n  !!(string.match(/\\d{4}-\\d{2}-\\d{2}/) &amp;&amp; Date.strptime(string, '%Y-%m-%d'))\nrescue ArgumentError\n  false\nend\n\nvalid_date?('2016-01-01')\n#=&gt; true\n\nvalid_date?('2016-01-32')\n#=&gt; false\n\nvalid_date?('01-01-2016')\n#=&gt; false\n\nvalid_date?('never')\n#=&gt; true\n\nvalid_date?('today')\n#=&gt; false\n</code></pre>\n\n<p>Note: <code>Date.strptime</code> raises an exception for invalid dates, therefore the <code>rescue false</code> to return <code>false</code> in such a case.</p>\n"}, {"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user6801385"}, "edited": false, "score": 0, "creation_date": 1473251978, "post_id": 39369121, "comment_id": 66068295, "body": "thank you, I saw that you and @spickermann answered on the same time, I really appreciate this, but somehow it doesn&#39;t work, I comment above."}, {"owner": {"user_type": "does_not_exist", "display_name": "user6801385"}, "edited": false, "score": 0, "creation_date": 1473253604, "post_id": 39369121, "comment_id": 66069524, "body": "<code>01-01-2016</code> return true, and this is not what I need :/"}], "tags": [], "owner": {"reputation": 2044, "user_id": 820501, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/SDYBl.jpg?s=128&g=1", "display_name": "ShockwaveNN", "link": "https://stackoverflow.com/users/820501/shockwavenn"}, "is_accepted": false, "score": 1, "last_activity_date": 1473248931, "creation_date": 1473248931, "answer_id": 39369121, "question_id": 39368909, "link": "https://stackoverflow.com/questions/39368909/ruby-date-format-validation/39369121#39369121", "title": "Ruby date format validation", "body": "<pre><code>require 'date'\n\ndef date_valid?(date)\n  format = '%Y-%m-%d'\n  DateTime.strptime(date, format)\n  true\nrescue ArgumentError\n  false\nend\n\np date_valid?('2016-01-01') # true\np date_valid?('2016-25-10') # false\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 252, "user_id": 4498918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3UOpE.jpg?s=128&g=1", "display_name": "bunufi", "link": "https://stackoverflow.com/users/4498918/bunufi"}, "is_accepted": false, "score": 6, "last_activity_date": 1511774126, "creation_date": 1511774126, "answer_id": 47507320, "question_id": 39368909, "link": "https://stackoverflow.com/questions/39368909/ruby-date-format-validation/47507320#47507320", "title": "Ruby date format validation", "body": "<p>Since the context of the question was not strictly specified I will add one possible solution in the context of Rails. I have found <code>iso8601</code> method to be useful, which would check if a string is a valid iso8601 date and would raise exception if it is not. \n<a href=\"http://api.rubyonrails.org/classes/ActiveSupport/TimeZone.html#method-i-iso8601\" rel=\"noreferrer\">http://api.rubyonrails.org/classes/ActiveSupport/TimeZone.html#method-i-iso8601</a></p>\n\n<pre><code>def validate_date(date)\n  Date.iso8601(date.to_s)\n  return true\nrescue ArgumentError\n  false\n  # although, in my case I felt that logging this error and raising exception was a better approach, since we are forwarding this to the user of our API.\n  # log_and_raise_error(\"Given argument is not a valid ISO8601 date: '#{date}'\")\nend\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user6801385"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 7956, "favorite_count": 1, "accepted_answer_id": 39369104, "answer_count": 3, "score": 3, "last_activity_date": 1530441597, "creation_date": 1473248366, "last_edit_date": 1473257218, "question_id": 39368909, "link": "https://stackoverflow.com/questions/39368909/ruby-date-format-validation", "title": "Ruby date format validation", "body": "<p>How I can verify that the date '2016-01-01' is in the right format (%Y-%m-%d).</p>\n\n<p>For example I want to get <code>true</code> or <code>false</code> if the date is in the right format.</p>\n\n<p>pseudo code:</p>\n\n<pre><code>if ('2016-01-01' == (%Y-%m-%d))\n    puts date is valid\nelse\n    puts date is not valid\nend\n</code></pre>\n\n<p>Please help,</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["ruby", "chef-infra", "recipe", "databags"], "answers": [{"comments": [{"owner": {"reputation": 85, "user_id": 3595630, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba5c994e9d6f92a2dbe76b1ecbb58300?s=128&d=identicon&r=PG&f=1", "display_name": "Rajan", "link": "https://stackoverflow.com/users/3595630/rajan"}, "edited": false, "score": 0, "creation_date": 1473420238, "post_id": 39372134, "comment_id": 66145128, "body": "Cheers mate! I&#39;ll give it a shot."}, {"owner": {"reputation": 944, "user_id": 3963970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WC8zU.jpg?s=128&g=1", "display_name": "Mrigesh Priyadarshi", "link": "https://stackoverflow.com/users/3963970/mrigesh-priyadarshi"}, "reply_to_user": {"reputation": 85, "user_id": 3595630, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba5c994e9d6f92a2dbe76b1ecbb58300?s=128&d=identicon&r=PG&f=1", "display_name": "Rajan", "link": "https://stackoverflow.com/users/3595630/rajan"}, "edited": false, "score": 0, "creation_date": 1474876824, "post_id": 39372134, "comment_id": 66693510, "body": "@Rajan - Did that helped?"}], "tags": [], "owner": {"reputation": 944, "user_id": 3963970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WC8zU.jpg?s=128&g=1", "display_name": "Mrigesh Priyadarshi", "link": "https://stackoverflow.com/users/3963970/mrigesh-priyadarshi"}, "is_accepted": true, "score": 0, "last_activity_date": 1473464932, "last_edit_date": 1473464932, "creation_date": 1473257232, "answer_id": 39372134, "question_id": 39368742, "link": "https://stackoverflow.com/questions/39368742/using-databag-in-chef-recipe/39372134#39372134", "title": "Using databag in CHEF recipe", "body": "<p>Can put filter for the object type of the values:-</p>\n\n<pre><code>users_databag_item = data_bag_item('mongodb', 'users')\nusers_databag_item.values.each do | values |\n    log \"db.createUser( { user: '#{values['id']}', pwd: '#{values['password']}', roles: [ { role: '#{values['role']}', db: '#{values['db']}' } ] } )\" if !values.is_a? (String)\nend\n</code></pre>\n\n<p>or</p>\n\n<pre><code>users_databag_item = data_bag_item('mongodb', 'users')\nusers_databag_item.each_pair do | id, values |\n    log \"db.createUser( { user: '#{values['id']}', pwd: '#{values['password']}', roles: [ { role: '#{values['role']}', db: '#{values['db']}' } ] } )\" if !id.eql? \"id\"\nend\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 85, "user_id": 3595630, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba5c994e9d6f92a2dbe76b1ecbb58300?s=128&d=identicon&r=PG&f=1", "display_name": "Rajan", "link": "https://stackoverflow.com/users/3595630/rajan"}, "is_accepted": false, "score": 0, "last_activity_date": 1475132403, "creation_date": 1475132403, "answer_id": 39763494, "question_id": 39368742, "link": "https://stackoverflow.com/questions/39368742/using-databag-in-chef-recipe/39763494#39763494", "title": "Using databag in CHEF recipe", "body": "<p>Yes it did work. In the end I have managed to fix it in another way.</p>\n"}], "owner": {"reputation": 85, "user_id": 3595630, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba5c994e9d6f92a2dbe76b1ecbb58300?s=128&d=identicon&r=PG&f=1", "display_name": "Rajan", "link": "https://stackoverflow.com/users/3595630/rajan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 288, "favorite_count": 0, "accepted_answer_id": 39372134, "answer_count": 2, "score": 0, "last_activity_date": 1475132403, "creation_date": 1473247828, "last_edit_date": 1473256458, "question_id": 39368742, "link": "https://stackoverflow.com/questions/39368742/using-databag-in-chef-recipe", "title": "Using databag in CHEF recipe", "body": "<p>I have been struggling for over a week to solve this issue. Is there anyone who can help me out solving this.</p>\n\n<p>I have a databag mongo, the contents of the databag is:</p>\n\n<pre><code>{ \"firstuser\": {\n\"id\": \"firstuser\",\n\"password\": \"123\",\n\"db\": \"mydb\",\n\"role\": \"readWrite\"\n},\n\"seconduser\": {\n\"id\": \"seconduser\",\n\"password\": \"123\",\n\"db\": \"mydb\",\n\"role\": \"readWrite\"\n},\n\"thirduser\": {\n\"id\": \"thirduser\",\n\"password\": \"123\",\n\"db\": \"mydb\",\n\"role\": \"read\"\n},\n\"id\": \"users\"\n}\n</code></pre>\n\n<p>I want to loop through the databag, in order to create users in MongoDB. This is what I have come up with (and a lot more fruitless attempts)</p>\n\n<pre><code>users_databag_item = data_bag_item('mongodb', 'users')\nusers_databag_item.each_pair do | user, values |\nlog \"db.createUser( { user: '#{values['id']}', pwd: '#{values['password']}', roles: [ { role: '#{values['role']}', db: '#{values['db']}' } ] } )\"\nend\n</code></pre>\n\n<p>The output of the script above is;</p>\n\n<ol>\n<li>log[printing the records: db.createUser( { user: 'firstuser', pwd: '123', roles: [ { role: 'read', db: 'mydb' } ] } ) ] action write</li>\n<li>log[printing the records: db.createUser( { user: 'seconduser', pwd: '123', roles: [ { role: 'read', db: 'mydb' } ] } ) ] action write </li>\n<li>log[printing the records: db.createUser( { user: 'thirduser', pwd: '123', roles: [ { role: 'read', db: 'mydb' } ] } ) ] action write</li>\n<li>log[printing the records: db.createUser( { user: '', pwd: '', roles: [ { role: '', db: '' } ] } ) ] action write</li>\n</ol>\n\n<p>Have a look at row 4, it contains an empty record. It seems that the loop also uses (\"id\": \"users\"). Is there a way to filter out this entry?</p>\n\n<p>To prove this I have added \"id\": \"users\", \"password\": \"123\" which resulted in 2 extra empty records.</p>\n\n<p>So, I need to filter out: (\"id\": \"users\"). How can I achieve this?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-3", "ruby-on-rails-4", "model-view-controller"], "comments": [{"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1473246009, "post_id": 39368051, "comment_id": 66064143, "body": "request params are available via <code>params</code> method from within a controller action. <code>params[:username]</code>, etc."}, {"owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 0, "creation_date": 1473246080, "post_id": 39368051, "comment_id": 66064201, "body": "Validate against what? Do you have a method to validate it? Or do you just want to know how to read the params send to the controller? You find them in <code>params[:username]</code> and <code>params[:password]</code>."}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1473246114, "post_id": 39368051, "comment_id": 66064225, "body": "Although for implementing authentication, you should take a battle-tested solution rather than rolling your own. For example, <code>devise</code> is a very popular choice."}, {"owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 0, "creation_date": 1473246507, "post_id": 39368051, "comment_id": 66064470, "body": "What is wrong with Rails&#39; <code>has_secure_password</code>?"}], "answers": [{"tags": [], "owner": {"reputation": 4265, "user_id": 4601088, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/bN143.jpg?s=128&g=1", "display_name": "Bart\u0142omiej G\u0142adys", "link": "https://stackoverflow.com/users/4601088/bart%c5%82omiej-g%c5%82adys"}, "is_accepted": true, "score": 0, "last_activity_date": 1473246017, "creation_date": 1473246017, "answer_id": 39368102, "question_id": 39368051, "link": "https://stackoverflow.com/questions/39368051/handling-parameters-in-rails/39368102#39368102", "title": "Handling Parameters in Rails", "body": "<p>something like this:</p>\n\n<pre><code>if params[:username].present? &amp;&amp; params[:password].present? \n  #do something\nend\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1246, "user_id": 2262005, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/5535295c69d23b872494f6b137badf4d?s=128&d=identicon&r=PG", "display_name": "AndolaSoft Inc", "link": "https://stackoverflow.com/users/2262005/andolasoft-inc"}, "is_accepted": false, "score": 1, "last_activity_date": 1473257227, "creation_date": 1473257227, "answer_id": 39372133, "question_id": 39368051, "link": "https://stackoverflow.com/questions/39368051/handling-parameters-in-rails/39372133#39372133", "title": "Handling Parameters in Rails", "body": "<p>You can get the <strong>\"username\"</strong> and <strong>\"password\"</strong> parameters from <strong>params[:username]</strong> and <strong>params[:password]</strong>.</p>\n\n<p>For easy and secure authentication process you can use <strong><em>\"devise\"</em></strong> gem which is widely used for authentication. It's easy to configure and provides the login and signup view pages by default. </p>\n\n<p>URL to follow <a href=\"https://github.com/plataformatec/devise\" rel=\"nofollow\">https://github.com/plataformatec/devise</a></p>\n"}], "owner": {"reputation": 6463, "user_id": 5063789, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/57dfee355833ddc59127fc6a0584b908?s=128&d=identicon&r=PG&f=1", "display_name": "mohangraj", "link": "https://stackoverflow.com/users/5063789/mohangraj"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 48, "favorite_count": 0, "accepted_answer_id": 39368102, "answer_count": 2, "score": 1, "last_activity_date": 1473257227, "creation_date": 1473245873, "question_id": 39368051, "link": "https://stackoverflow.com/questions/39368051/handling-parameters-in-rails", "title": "Handling Parameters in Rails", "body": "<p>How to validate parameter passed to the controller from view. The following is my view file.</p>\n\n<p>index.html.erb:</p>\n\n<pre><code>&lt;html&gt;\n&lt;body&gt;\n    &lt;center&gt; &lt;h1&gt; Login form &lt;/h1&gt; &lt;/center&gt;\n    &lt;form action='/login/auth' method='GET'&gt;\n        Name: &lt;input type=\"text\" name=\"username\" width=20&gt;\n        Password: &lt;input type=\"password\" name=\"password\" width=20&gt;\n        &lt;input type=\"submit\" value=\"login\"&gt;\n    &lt;/form&gt;\n&lt;/body&gt;\n&lt;/html&gt;\n</code></pre>\n\n<p>The above is the view file rendered in client side when the client calls '/login' controller. So, once the value is filled and\npress the submit button, the datas are passed to '/login/auth' action. With in auth method how to handle the data which is passed from\nclient side. My controller file is,</p>\n\n<p>login_controller.rb:</p>\n\n<pre><code>ass LoginController &lt; ApplicationController\n  def auth\n\n  end\nend\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 1578, "user_id": 4662836, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wjRFz.jpg?s=128&g=1", "display_name": "zajonc", "link": "https://stackoverflow.com/users/4662836/zajonc"}, "edited": false, "score": 0, "creation_date": 1473246068, "post_id": 39367925, "comment_id": 66064193, "body": "It&#39;s better to update your question instead of using comment."}, {"owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 0, "creation_date": 1473246144, "post_id": 39367925, "comment_id": 66064252, "body": "Did you run <code>bundle install</code> in your production environment too?"}, {"owner": {"reputation": 19261, "user_id": 4758119, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/F4dJY.jpg?s=128&g=1", "display_name": "Deepak Mahakale", "link": "https://stackoverflow.com/users/4758119/deepak-mahakale"}, "edited": false, "score": 0, "creation_date": 1473252137, "post_id": 39367925, "comment_id": 66068394, "body": "paste contents of <code>Gemfile</code>"}, {"owner": {"reputation": 3, "user_id": 6634477, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65939dcd9d0e084ef893faab8b4e6e10?s=128&d=identicon&r=PG&f=1", "display_name": "gremr", "link": "https://stackoverflow.com/users/6634477/gremr"}, "reply_to_user": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 0, "creation_date": 1473324101, "post_id": 39367925, "comment_id": 66099397, "body": "@spickermann I did bundle install"}], "owner": {"reputation": 3, "user_id": 6634477, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65939dcd9d0e084ef893faab8b4e6e10?s=128&d=identicon&r=PG&f=1", "display_name": "gremr", "link": "https://stackoverflow.com/users/6634477/gremr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 285, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1473327791, "creation_date": 1473245525, "last_edit_date": 1473327791, "question_id": 39367925, "link": "https://stackoverflow.com/questions/39367925/undefined-local-variable-or-method-acts-as-nested-set", "title": "undefined local variable or method `acts_as_nested_set&#39;", "body": "<p>I am currently using Rails 4.2.5 for my project. In my gemfile, the way I install is :\ngem 'awesome_nested_set'</p>\n\n<p>Even though I install successfully, the problem is happened in the server. \nError: \nundefined local variable or method `acts_as_nested_set'</p>\n\n<p>only at production environment. </p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code>source 'https://rubygems.org'\r\n\r\n\r\n# Bundle edge Rails instead: gem 'rails', github: 'rails/rails'\r\ngem 'rails', '4.2.5'\r\n\r\n\r\n# Use sqlite3 as the database for Active Record\r\ngem 'mysql2', '0.3.18'\r\n# Use SCSS for stylesheets\r\ngem 'sass-rails', '~&gt; 5.0'\r\n# Use Uglifier as compressor for JavaScript assets\r\ngem 'uglifier', '&gt;= 1.3.0'\r\n# Use CoffeeScript for .coffee assets and views\r\ngem 'coffee-rails', '~&gt; 4.1.0'\r\n# See https://github.com/rails/execjs#readme for more supported runtimes\r\n\r\n# gem 'therubyracer', platforms: :ruby\r\ngem 'therubyracer', platforms: :ruby\r\n# Use jquery as the JavaScript library\r\ngem 'jquery-rails'\r\n# Turbolinks makes following links in your web application faster. Read more: https://github.com/rails/turbolinks\r\n#gem 'turbolinks'\r\ngem 'awesome_nested_set', '3.0.2'\r\n\r\n\r\ngem 'jquery-turbolinks'\r\n# Build JSON APIs with ease. Read more: https://github.com/rails/jbuilder\r\ngem 'jbuilder', '~&gt; 2.0'\r\n# bundle exec rake doc:rails generates the API under doc/api.\r\ngem 'sdoc', '~&gt; 0.4.0', group: :doc\r\n\r\n# Use ActiveModel has_secure_password\r\n# gem 'bcrypt', '~&gt; 3.1.7'\r\ngem 'bcrypt', '~&gt; 3.1.7'\r\n\r\ngem 'devise'\r\n\r\ngem 'rails_admin'\r\n\r\n\r\ngem 'rb-readline'\r\ngem 'unicorn'\r\n\r\ngem 'capistrano', '&gt;= 3'\r\ngem 'capistrano-bundler'\r\ngem 'capistrano-rbenv', github: \"capistrano/rbenv\"\r\ngem 'capistrano-rails'\r\n\r\ngem 'omniauth'\r\ngem 'omniauth-facebook'\r\n\r\ngem 'omniauth-oauth2', '~&gt; 1.3.1'\r\n# Use Unicorn as the app server\r\n# gem 'unicorn'\r\ngem 'wicked'\r\ngem 'kaminari'\r\ngem \"simple_calendar\", \"~&gt; 2.0\"\r\ngem 'bootstrap-sass'\r\ngem 'chosen-rails'\r\ngem 'mailboxer'\r\ngem 'webpay'\r\ngem 'unicorn'\r\ngem 'gretel'\r\ngem 'sitemap_generator'\r\ngem 'stripe'\r\ngem 'carrierwave'\r\ngem 'rmagick'\r\ngem 'i18n_generators'\r\n\r\n# Use Capistrano for deployment\r\n# gem 'capistrano-rails', group: :development\r\n\r\ngroup :development, :test do\r\n  # Call 'byebug' anywhere in the code to stop execution and get a debugger console\r\n  gem 'byebug'\r\n  gem 'pry-rails'\r\nend\r\n\r\ngroup :development do\r\n  # Access an IRB console on exception pages or by using &lt;%= console %&gt; in views\r\n  gem 'web-console', '~&gt; 2.0'\r\n\r\n  # Spring speeds up development by keeping your application running in the background. Read more: https://github.com/rails/spring\r\n  # gem 'spring'\r\n\r\nend</code></pre>\r\n</div>\r\n</div>\r\n</p>\n\n<p>[]# bundle show 'awesome_nested_set'\n/usr/local/rbenv/versions/2.2.2/lib/ruby/gems/2.2.0/gems/awesome_nested_set-3.1.1</p>\n\n<p>It's in there..!</p>\n"}, {"tags": ["mysql", "ruby-on-rails", "ruby", "nginx", "apdex"], "answers": [{"comments": [{"owner": {"reputation": 1047, "user_id": 2936733, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/eaecbfee79e2b901ccfc23d4d77ac50e?s=128&d=identicon&r=PG&f=1", "display_name": "\u5b59\u609f\u7a7a", "link": "https://stackoverflow.com/users/2936733/%e5%ad%99%e6%82%9f%e7%a9%ba"}, "edited": false, "score": 0, "creation_date": 1473255891, "post_id": 39371030, "comment_id": 66071133, "body": "You mean,  adding more physical servers is not a good solution, Even in my case that the 4 CPUs are High CPU Usage ? I haven&#39;t n+1 query problem. Memcached is running."}, {"owner": {"reputation": 1002, "user_id": 5479988, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Z_oUVK4Wkuo/AAAAAAAAAAI/AAAAAAAAABA/vn2BD49K67M/photo.jpg?sz=128", "display_name": "Jim Van Fleet", "link": "https://stackoverflow.com/users/5479988/jim-van-fleet"}, "reply_to_user": {"reputation": 1047, "user_id": 2936733, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/eaecbfee79e2b901ccfc23d4d77ac50e?s=128&d=identicon&r=PG&f=1", "display_name": "\u5b59\u609f\u7a7a", "link": "https://stackoverflow.com/users/2936733/%e5%ad%99%e6%82%9f%e7%a9%ba"}, "edited": false, "score": 0, "creation_date": 1473256711, "post_id": 39371030, "comment_id": 66071775, "body": "The high CPU usage is worth looking into-- is there a test suite you can run where you can turn on time profiling?  That can indicate which parts of the app need to be sped up.  There are limits to what can be done operationally to speed a slow app.  Also, is every page low Apdex or just a few?"}, {"owner": {"reputation": 1047, "user_id": 2936733, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/eaecbfee79e2b901ccfc23d4d77ac50e?s=128&d=identicon&r=PG&f=1", "display_name": "\u5b59\u609f\u7a7a", "link": "https://stackoverflow.com/users/2936733/%e5%ad%99%e6%82%9f%e7%a9%ba"}, "edited": false, "score": 0, "creation_date": 1473259684, "post_id": 39371030, "comment_id": 66074129, "body": "Thank you for your answer, I choose New Relic to monitor my app. When there are 168 rpm, every page is slowdown. But at 3h, there are no-visitors, my app is fast."}], "tags": [], "owner": {"reputation": 1002, "user_id": 5479988, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Z_oUVK4Wkuo/AAAAAAAAAAI/AAAAAAAAABA/vn2BD49K67M/photo.jpg?sz=128", "display_name": "Jim Van Fleet", "link": "https://stackoverflow.com/users/5479988/jim-van-fleet"}, "is_accepted": false, "score": 1, "last_activity_date": 1473254364, "creation_date": 1473254364, "answer_id": 39371030, "question_id": 39367858, "link": "https://stackoverflow.com/questions/39367858/scalability-of-web-application-with-nginx-and-two-physical-linux-servers/39371030#39371030", "title": "Scalability of web application with nginx and two physical linux servers", "body": "<p>Adding more physical servers or hosts will only affect your Apdex score if the response time is caused primarily by queue time, which happens but is relatively rare in Rails production workloads.</p>\n\n<p>The most common place for Rails apps to spend time is in I/O with its database.  Check query counts for N+1 explosions, check slow query logs either in NewRelic or your DB itself to see if adding indexes can help.  Investigate using some caching if the performance hit is limited to some small number of pages.</p>\n\n<p>It's also very common for the home page to be quite slow, but other pages are OK.  See if your Apdex score is being primarily influenced by a few bad pages rather than overall application slowness.</p>\n"}], "owner": {"reputation": 1047, "user_id": 2936733, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/eaecbfee79e2b901ccfc23d4d77ac50e?s=128&d=identicon&r=PG&f=1", "display_name": "\u5b59\u609f\u7a7a", "link": "https://stackoverflow.com/users/2936733/%e5%ad%99%e6%82%9f%e7%a9%ba"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 92, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1513688269, "creation_date": 1473245332, "last_edit_date": 1513688269, "question_id": 39367858, "link": "https://stackoverflow.com/questions/39367858/scalability-of-web-application-with-nginx-and-two-physical-linux-servers", "title": "Scalability of web application with nginx and two physical linux servers", "body": "<p>My web application ruby on rails is getting more and more throughput. \nWith New Relic, i got  Apdex score &lt; 0.7 </p>\n\n<p>My app is running on my Debian server(ex: ip pulic is 123.235.23.16) with Nginx and THIN. The codes and database mysql is all in this server.</p>\n\n<p>My app has 3 app instances which are created by THIN (0.0.0.0:3000, 0.0.0.0:3001, 0.0.0.0:3002). And In Nginx http config, i use Load balancing methods:</p>\n\n<pre><code>upstream myapp1 {\n        server 127.0.0.1:3000;\n        server 127.0.0.1:3001;\n        server 127.0.0.1:3002;\n    }\n\nserver {\n        listen 80;\n        ...\n        location / {\n            proxy_pass http://myapp1;\n        }\n        ...\n    }\n</code></pre>\n\n<p>I want to know if I add another Debian server (ex: ip pulic is 123.235.23.17) to help the first server to hundle throughputs, Which server should be configured as nginx load balaancing server ? How to hundle mysql database io with two different servers and different app instances ? mysql remote ? </p>\n"}, {"tags": ["ruby-on-rails", "ruby", "routing"], "answers": [{"tags": [], "owner": {"reputation": 4265, "user_id": 4601088, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/bN143.jpg?s=128&g=1", "display_name": "Bart\u0142omiej G\u0142adys", "link": "https://stackoverflow.com/users/4601088/bart%c5%82omiej-g%c5%82adys"}, "is_accepted": true, "score": 2, "last_activity_date": 1473243919, "creation_date": 1473243919, "answer_id": 39367343, "question_id": 39367253, "link": "https://stackoverflow.com/questions/39367253/cant-generate-show-path/39367343#39367343", "title": "can&#39;t generate show path", "body": "<p>try this:</p>\n\n<pre><code>link_to list.name, admin_mass_scan_list_path(list)\n</code></pre>\n"}], "owner": {"reputation": 184, "user_id": 1107909, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/82acc8439b76594615c5f78124a488dd?s=128&d=identicon&r=PG", "display_name": "enjaku", "link": "https://stackoverflow.com/users/1107909/enjaku"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 24, "favorite_count": 0, "accepted_answer_id": 39367343, "answer_count": 1, "score": 0, "last_activity_date": 1473243919, "creation_date": 1473243652, "question_id": 39367253, "link": "https://stackoverflow.com/questions/39367253/cant-generate-show-path", "title": "can&#39;t generate show path", "body": "<p>I have a controller:</p>\n\n<pre><code>class Admin::MassScanListsController &lt; ApplicationController\n  def index\n    @mass_scan_lists = MassScanList.all\n  end\n\n  def show\n\n  end\nend\n</code></pre>\n\n<p>an appropriate simple model <code>MassScanList</code> and a view, where I want to list all my MassScanLists with links to show their content:</p>\n\n<pre><code>- if @mass_scan_lists.present?  \n  - @mass_scan_lists.each do |list|\n    tr\n      td= list.id\n      td= link_to list.name, list\n      td= list.enabled\n</code></pre>\n\n<p>I get an error <code>undefined method 'mass_scan_list_path'</code> which is I suppose I can understand, it must be <code>admin_mass_scan_list_path</code>, because my controller is <code>Admin::MassScanListsController</code> and not <code>MassScanListsController</code>. Bot how can I generate a show path in my case?</p>\n\n<p>P.S.\nIn my <code>routes.rb</code> I have:</p>\n\n<pre><code>constraints admins_constraint do\n  namespace 'admin' do\n    resources :mass_scan_lists, only: [:index, :show]\n  end\nend\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "rubygems", "bundler", "activesupport"], "answers": [{"tags": [], "owner": {"reputation": 1985, "user_id": 1629709, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/ykH7V.png?s=128&g=1", "display_name": "Sebastian", "link": "https://stackoverflow.com/users/1629709/sebastian"}, "is_accepted": true, "score": 1, "last_activity_date": 1473241579, "creation_date": 1473241579, "answer_id": 39366528, "question_id": 39366188, "link": "https://stackoverflow.com/questions/39366188/force-bundler-to-install-gems-supported-by-the-local-ruby-version/39366528#39366528", "title": "Force Bundler to install gems supported by the local Ruby version", "body": "<p>Apparently the new version of Bundler will do this for you automatically.\nI found <a href=\"https://github.com/bundler/bundler-features/issues/120#issuecomment-214514847\" rel=\"nofollow\">this comment</a> from Andr\u00e9 Arko that mentions this is already included in the latest RC version.</p>\n\n<p>I specified <code>Ruby '2.0'</code> in my Gemfile, installed Bundler with <code>gem install bundler --pre</code> (it installed bundler-1.13.0.rc.2) and <code>bundle install</code> successfully installed activesupport 4.2.7.1.</p>\n\n<p>With Bundler 1.12.5 I was getting the following error:</p>\n\n<pre><code>An error occurred while installing activesupport (5.0.0.1), and Bundler cannot continue.\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1985, "user_id": 1629709, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/ykH7V.png?s=128&g=1", "display_name": "Sebastian", "link": "https://stackoverflow.com/users/1629709/sebastian"}, "edited": false, "score": 0, "creation_date": 1473426269, "post_id": 39407275, "comment_id": 66148753, "body": "This is a gem dependency, so it must be put in the gemspec."}], "tags": [], "owner": {"reputation": 3381, "user_id": 220679, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a5c165ffc801b46ddff8851d5b49bf3e?s=128&d=identicon&r=PG", "display_name": "Ginty", "link": "https://stackoverflow.com/users/220679/ginty"}, "is_accepted": false, "score": 0, "last_activity_date": 1473410234, "creation_date": 1473410234, "answer_id": 39407275, "question_id": 39366188, "link": "https://stackoverflow.com/questions/39366188/force-bundler-to-install-gems-supported-by-the-local-ruby-version/39407275#39407275", "title": "Force Bundler to install gems supported by the local Ruby version", "body": "<p>Note that while a bit more manual, you can also include logic in your Gemfiles:</p>\n\n<pre><code>if RUBY_VERSION &lt;  \"2.2.2\"\n  gem \"activesupport\", \"4.2.7.1\"\nelse\n  gem \"activesupport\", \"5.0.0.1\"  \nend\n</code></pre>\n"}], "owner": {"reputation": 1985, "user_id": 1629709, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/ykH7V.png?s=128&g=1", "display_name": "Sebastian", "link": "https://stackoverflow.com/users/1629709/sebastian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 457, "favorite_count": 0, "accepted_answer_id": 39366528, "answer_count": 2, "score": 2, "last_activity_date": 1473410234, "creation_date": 1473240620, "question_id": 39366188, "link": "https://stackoverflow.com/questions/39366188/force-bundler-to-install-gems-supported-by-the-local-ruby-version", "title": "Force Bundler to install gems supported by the local Ruby version", "body": "<p>Is there a way of installing the latest supported version of a dependency without specifying it?</p>\n\n<p>I'm having issues with the <a href=\"https://rubygems.org/gems/activesupport/versions/5.0.0\" rel=\"nofollow\">activesupport</a> gem. The latest version (5.0.0.1) supports Ruby >= 2.2.2. If I'm specifying that I require the gem like this <code>'~&gt; 4.2'</code> Bundler will try to install version 5 even if I'm on Ruby 2.0. Specifying the exact version <code>4.2.7.1</code> or setting a maximum <code>'~&gt; 4.2', '&lt; 5'</code> works, except when using the gem with Rails 5. </p>\n\n<p>Is there a way to manage gem versions based on the current Ruby version?</p>\n"}, {"tags": ["ruby"], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user6796341"}, "edited": false, "score": 0, "creation_date": 1473240375, "post_id": 39366064, "comment_id": 66060566, "body": "Can  you explain further?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user6796341"}, "edited": false, "score": 0, "creation_date": 1473240386, "post_id": 39366064, "comment_id": 66060573, "body": "How does that .zip works? and how does it works on the puts."}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "reply_to_user": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 0, "creation_date": 1473240427, "post_id": 39366064, "comment_id": 66060599, "body": "<a href=\"https://ruby-doc.org/core-2.3.0/Array.html#method-i-zip\" rel=\"nofollow noreferrer\">ruby-doc.org/core-2.3.0/Array.html#method-i-zip</a> or use the simplified version by @spickermann"}], "tags": [], "owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "is_accepted": true, "score": 1, "last_activity_date": 1473240391, "last_edit_date": 1473240391, "creation_date": 1473240294, "answer_id": 39366064, "question_id": 39365909, "link": "https://stackoverflow.com/questions/39365909/label-ruby-one-letter/39366064#39366064", "title": "Label Ruby One letter", "body": "<pre><code>MY_CHOICES = {\n  'l' =&gt; 'lego',\n  'v' =&gt; 'violin',\n  'x' =&gt; 'xray'\n}\n\nprint \"Choose one: #{MY_CHOICES.values.join(', ')} \"\nchoice = gets.chomp\n\nif MY_CHOICES[choice]\n  puts \"#{MY_CHOICES[choice]} chosen\"\nelse\n  puts \"That is not included there.\"\nend\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user6796341"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 33, "favorite_count": 1, "accepted_answer_id": 39366064, "answer_count": 1, "score": 1, "last_activity_date": 1473240391, "creation_date": 1473239882, "question_id": 39365909, "link": "https://stackoverflow.com/questions/39365909/label-ruby-one-letter", "title": "Label Ruby One letter", "body": "<p>I am trying to figure this out. I am working on a ruby code where in I want to label each array item where in users can just type 1 letter such as l for lego and so on and it will accept that and validates/check that on the code inside the array.</p>\n\n<pre><code>MY_CHOICES = %w(lego violin xray)\n\nl = \"lego\"\nv = \"violin\"\nx = \"xray\"\n\nprint \"Choose one: #{MY_CHOICES.join(', ')} \"\nchoice = gets.chomp\n\nif MY_CHOICES.include?(choice)\n  break\nelse\n  puts \"That is not included there.\"\nend\n</code></pre>\n\n<p>Any idea how to do it? Sorry newbie here.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "rubygems", "passenger"], "comments": [{"owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 0, "creation_date": 1473239330, "post_id": 39365665, "comment_id": 66059925, "body": "Just to confirm: Are you really trying to run Rails <code>2.3.9</code> on Ruby <code>1.8.7</code>?"}, {"owner": {"reputation": 4722, "user_id": 1117987, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/64253180009f7c2638e8b2228bab7397?s=128&d=identicon&r=PG", "display_name": "lock", "link": "https://stackoverflow.com/users/1117987/lock"}, "reply_to_user": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 0, "creation_date": 1473239463, "post_id": 39365665, "comment_id": 66060007, "body": "@spickermann - Yes, that&#39;s right."}, {"owner": {"reputation": 19261, "user_id": 4758119, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/F4dJY.jpg?s=128&g=1", "display_name": "Deepak Mahakale", "link": "https://stackoverflow.com/users/4758119/deepak-mahakale"}, "edited": false, "score": 0, "creation_date": 1473239671, "post_id": 39365665, "comment_id": 66060126, "body": "something wrong with <code>rubygems</code> version <a href=\"http://stackoverflow.com/questions/15349869/undefined-method-source-index-for-gemmodule-nomethoderror\" title=\"undefined method source index for gemmodule nomethoderror\">stackoverflow.com/questions/15349869/&hellip;</a>"}, {"owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 0, "creation_date": 1473240112, "post_id": 39365665, "comment_id": 66060394, "body": "Both version are outdated and unmaintained for more than 3 years. Rails 2.3 has known security issues that will not be fixed anymore. Furthermore current gems will not run with Ruby 1.8.7 anymore. I suggest to start updating your application to current versions of Rails and Ruby with a high priority."}, {"owner": {"reputation": 4722, "user_id": 1117987, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/64253180009f7c2638e8b2228bab7397?s=128&d=identicon&r=PG", "display_name": "lock", "link": "https://stackoverflow.com/users/1117987/lock"}, "reply_to_user": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 0, "creation_date": 1473240401, "post_id": 39365665, "comment_id": 66060584, "body": "@spickermann - I know but I need to first run the application so that I can upgrade it. I can&#39;t directly run the application with latest version or Ruby. I first have to get it running in 1.8.7 and then I can try to upgrade."}], "answers": [{"tags": [], "owner": {"reputation": 19261, "user_id": 4758119, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/F4dJY.jpg?s=128&g=1", "display_name": "Deepak Mahakale", "link": "https://stackoverflow.com/users/4758119/deepak-mahakale"}, "is_accepted": true, "score": 1, "last_activity_date": 1473239780, "last_edit_date": 1495541319, "creation_date": 1473239780, "answer_id": 39365867, "question_id": 39365665, "link": "https://stackoverflow.com/questions/39365665/rails-server-503-service-unavailable-error/39365867#39365867", "title": "Rails server 503 Service Unavailable Error", "body": "<p>You need to downgrade the <code>rubygems</code> version</p>\n\n<pre><code>gem update --system 1.8.25\n</code></pre>\n\n<p>refer solution to the same problem <a href=\"https://stackoverflow.com/a/15351437/4758119\">here</a></p>\n"}], "owner": {"reputation": 4722, "user_id": 1117987, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/64253180009f7c2638e8b2228bab7397?s=128&d=identicon&r=PG", "display_name": "lock", "link": "https://stackoverflow.com/users/1117987/lock"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3038, "favorite_count": 0, "accepted_answer_id": 39365867, "answer_count": 1, "score": 0, "last_activity_date": 1473239780, "creation_date": 1473239185, "last_edit_date": 1473239623, "question_id": 39365665, "link": "https://stackoverflow.com/questions/39365665/rails-server-503-service-unavailable-error", "title": "Rails server 503 Service Unavailable Error", "body": "<p>when I start my rails server using <code>ruby script/server</code> command, I am getting the following response</p>\n\n<pre><code>=&gt; Booting WEBrick\n=&gt; Rails 2.3.9 application starting on http://0.0.0.0:3000\n/home/ubuntu/.rvm/gems/ruby-1.8.7-p374@gemset1/gems/rails-2.3.9/lib/rails/gem_dependency.rb:21:in `add_frozen_gem_path': undefined method `source_index' for Gem:Module (NoMethodError)\n        from /home/ubuntu/.rvm/gems/ruby-1.8.7-p374@gemset1/gems/rails-2.3.9/lib/initializer.rb:298:in `add_gem_load_paths'\n        from /home/ubuntu/.rvm/gems/ruby-1.8.7-p374@gemset1/gems/rails-2.3.9/lib/initializer.rb:132:in `process'\n        from /home/ubuntu/.rvm/gems/ruby-1.8.7-p374@gemset1/gems/rails-2.3.9/lib/initializer.rb:113:in `send'\n        from /home/ubuntu/.rvm/gems/ruby-1.8.7-p374@gemset1/gems/rails-2.3.9/lib/initializer.rb:113:in `run'\n        from /home/ubuntu/apps/moogle/config/environment.rb:13\n        from /home/ubuntu/.rvm/gems/ruby-1.8.7-p374@gemset1/gems/activesupport-2.3.9/lib/active_support/dependencies.rb:182:in `require'\n        from /home/ubuntu/.rvm/gems/ruby-1.8.7-p374@gemset1/gems/activesupport-2.3.9/lib/active_support/dependencies.rb:182:in `require'\n        from /home/ubuntu/.rvm/gems/ruby-1.8.7-p374@gemset1/gems/activesupport-2.3.9/lib/active_support/dependencies.rb:547:in `new_constants_in'\n        from /home/ubuntu/.rvm/gems/ruby-1.8.7-p374@gemset1/gems/activesupport-2.3.9/lib/active_support/dependencies.rb:182:in `require'\n        from /home/ubuntu/.rvm/gems/ruby-1.8.7-p374@gemset1/gems/rails-2.3.9/lib/commands/server.rb:84\n        from script/server:3:in `require'\n        from script/server:3\n</code></pre>\n\n<p>I am using ProxyPreseve like</p>\n\n<pre><code>&lt;VirtualHost *:80&gt;\n ProxyPreserveHost On\n    ProxyPass / http://0.0.0.0:3000/\n    ProxyPassReverse / http://0.0.0.0:3000/\n    ServerName localhost\n&lt;/VirtualHost&gt;\n</code></pre>\n\n<p>And I am getting 503 Service Unavailable Error. Can anyone tell me whats wrong in my application?</p>\n\n<p>Rails version: 2.3.9\nRuby version: 1.8.7-p374\nBundle version: 1.12.5\nGem version: 2.0.17</p>\n"}, {"tags": ["arrays", "ruby", "flatten"], "comments": [{"owner": {"reputation": 3580, "user_id": 1680728, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/844cd73e8700d810d7cc207cba7da3bd?s=128&d=identicon&r=PG&f=1", "display_name": "Felix", "link": "https://stackoverflow.com/users/1680728/felix"}, "edited": false, "score": 1, "creation_date": 1473239715, "post_id": 39365373, "comment_id": 66060152, "body": "If you know that you need/have triples (arrays of size 3), I&#39;d go with a solution that does not answer your question :) and <code>flatten</code> then slice."}, {"owner": {"reputation": 4450, "user_id": 837638, "user_type": "registered", "accept_rate": 11, "profile_image": "https://www.gravatar.com/avatar/32d80da41830a6e6c1bb3eb977537e3e?s=128&d=identicon&r=PG", "display_name": "coorasse", "link": "https://stackoverflow.com/users/837638/coorasse"}, "reply_to_user": {"reputation": 3580, "user_id": 1680728, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/844cd73e8700d810d7cc207cba7da3bd?s=128&d=identicon&r=PG&f=1", "display_name": "Felix", "link": "https://stackoverflow.com/users/1680728/felix"}, "edited": false, "score": 0, "creation_date": 1473241189, "post_id": 39365373, "comment_id": 66061104, "body": "No, the number of elements inside each array is not fixed, and also the number of arrays and subarrays"}], "answers": [{"comments": [{"owner": {"reputation": 4450, "user_id": 837638, "user_type": "registered", "accept_rate": 11, "profile_image": "https://www.gravatar.com/avatar/32d80da41830a6e6c1bb3eb977537e3e?s=128&d=identicon&r=PG", "display_name": "coorasse", "link": "https://stackoverflow.com/users/837638/coorasse"}, "edited": false, "score": 0, "creation_date": 1473239414, "post_id": 39365590, "comment_id": 66059971, "body": "Looking forward for something more elegant but your solution is working nicely."}], "tags": [], "owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "is_accepted": true, "score": 6, "last_activity_date": 1473239005, "creation_date": 1473239005, "answer_id": 39365590, "question_id": 39365373, "link": "https://stackoverflow.com/questions/39365373/how-to-flatten-subarrays-in-ruby/39365590#39365590", "title": "How to flatten subarrays in Ruby?", "body": "<pre><code>a.each_with_object([]) do |e, memo|\n  e == e.flatten ? memo &lt;&lt; e : e.each { |e| memo &lt;&lt; e }\nend\n#\u21d2\u00a0[['a', 'b', 'c'], ['d', 'e', 'f'], ['g', 'h', 'i'], ['l', 'm', 'n']]\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 4450, "user_id": 837638, "user_type": "registered", "accept_rate": 11, "profile_image": "https://www.gravatar.com/avatar/32d80da41830a6e6c1bb3eb977537e3e?s=128&d=identicon&r=PG", "display_name": "coorasse", "link": "https://stackoverflow.com/users/837638/coorasse"}, "edited": false, "score": 1, "creation_date": 1473241331, "post_id": 39365905, "comment_id": 66061201, "body": "<code>a.flat_map { |e| e.flatten == e ? [e] : e }</code> also works"}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1473241455, "post_id": 39365905, "comment_id": 66061277, "body": "<code>Array#flat?</code> would be quite handy here."}, {"owner": {"reputation": 12629, "user_id": 4739257, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/MdhEs.jpg?s=128&g=1", "display_name": "Ilya", "link": "https://stackoverflow.com/users/4739257/ilya"}, "reply_to_user": {"reputation": 4450, "user_id": 837638, "user_type": "registered", "accept_rate": 11, "profile_image": "https://www.gravatar.com/avatar/32d80da41830a6e6c1bb3eb977537e3e?s=128&d=identicon&r=PG", "display_name": "coorasse", "link": "https://stackoverflow.com/users/837638/coorasse"}, "edited": false, "score": 1, "creation_date": 1473242605, "post_id": 39365905, "comment_id": 66061945, "body": "@coorasse, it is more efficient to check just first element instead of transform all array and then check"}, {"owner": {"reputation": 12629, "user_id": 4739257, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/MdhEs.jpg?s=128&g=1", "display_name": "Ilya", "link": "https://stackoverflow.com/users/4739257/ilya"}, "reply_to_user": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1473242876, "post_id": 39365905, "comment_id": 66062114, "body": "@Stefan, can you give a link on this method docs? I could not find it."}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1473242958, "post_id": 39365905, "comment_id": 66062169, "body": "Oh, it doesn&#39;t exist. I wanted to say that such a method would be useful."}], "tags": [], "owner": {"reputation": 12629, "user_id": 4739257, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/MdhEs.jpg?s=128&g=1", "display_name": "Ilya", "link": "https://stackoverflow.com/users/4739257/ilya"}, "is_accepted": false, "score": 4, "last_activity_date": 1473239874, "creation_date": 1473239874, "answer_id": 39365905, "question_id": 39365373, "link": "https://stackoverflow.com/questions/39365373/how-to-flatten-subarrays-in-ruby/39365905#39365905", "title": "How to flatten subarrays in Ruby?", "body": "<p>Other solution:</p>\n\n<pre><code>a.flat_map { |e| e[0].is_a?(Array) ? e : [e] }\n#=&gt; [[\"a\", \"b\", \"c\"], [\"d\", \"e\", \"f\"], [\"g\", \"h\", \"i\"], [\"l\", \"m\", \"n\"]]\n</code></pre>\n"}], "owner": {"reputation": 4450, "user_id": 837638, "user_type": "registered", "accept_rate": 11, "profile_image": "https://www.gravatar.com/avatar/32d80da41830a6e6c1bb3eb977537e3e?s=128&d=identicon&r=PG", "display_name": "coorasse", "link": "https://stackoverflow.com/users/837638/coorasse"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 144, "favorite_count": 0, "accepted_answer_id": 39365590, "answer_count": 2, "score": 4, "last_activity_date": 1473239874, "creation_date": 1473238403, "question_id": 39365373, "link": "https://stackoverflow.com/questions/39365373/how-to-flatten-subarrays-in-ruby", "title": "How to flatten subarrays in Ruby?", "body": "<p>I have the following structure</p>\n\n<pre><code>a = [['a', 'b', 'c'], ['d', 'e', 'f'], [['g', 'h', 'i'], ['l', 'm', 'n']]]\n</code></pre>\n\n<p>and I want to obtain the following:</p>\n\n<pre><code>[['a', 'b', 'c'], ['d', 'e', 'f'], ['g', 'h', 'i'], ['l', 'm', 'n']]\n</code></pre>\n\n<p>I've tried the following:</p>\n\n<pre><code>a.flatten =&gt; ['a', 'b', 'c', 'd', 'e', 'f', 'g', 'h', 'i', 'l', 'm', 'n']\n\na.flatten(1) =&gt; ['a', 'b', 'c', 'd', 'e', 'f', ['g', 'h', 'i'], ['l', 'm', 'n']]\n</code></pre>\n\n<p>the solution I found, for now, is to change the initial structure to this format:</p>\n\n<pre><code>b = [[['a', 'b', 'c']], [['d', 'e', 'f']], [['g', 'h', 'i'], ['l', 'm', 'n']]]\n</code></pre>\n\n<p>and then call </p>\n\n<pre><code>b.flatten(1) =&gt; [['a', 'b', 'c'], ['d', 'e', 'f'], ['g', 'h', 'i'], ['l', 'm', 'n']]\n</code></pre>\n\n<p>but I could do this only because I was able to change how <code>a</code> was built. My question remains: how to obtain my desired result starting from <code>a</code>?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-4", "rspec", "rubygems"], "comments": [{"owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 0, "creation_date": 1473238464, "post_id": 39365333, "comment_id": 66059364, "body": "Did you try to do what the warning message tells you to do?"}, {"owner": {"reputation": 95, "user_id": 3166642, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/971dd3066d2ec6e47910271f2826a5bd?s=128&d=identicon&r=PG&f=1", "display_name": "user3166642", "link": "https://stackoverflow.com/users/3166642/user3166642"}, "reply_to_user": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 0, "creation_date": 1473238942, "post_id": 39365333, "comment_id": 66059690, "body": "I added gem &#39;minitest&#39; in my GemFile"}, {"owner": {"reputation": 95, "user_id": 3166642, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/971dd3066d2ec6e47910271f2826a5bd?s=128&d=identicon&r=PG&f=1", "display_name": "user3166642", "link": "https://stackoverflow.com/users/3166642/user3166642"}, "reply_to_user": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 0, "creation_date": 1473239099, "post_id": 39365333, "comment_id": 66059769, "body": "My rspec_helper.rb contains &quot;require &#39;rspec/autorun&#39; &quot; Do I need to change that also?"}, {"owner": {"reputation": 79161, "user_id": 1064226, "user_type": "registered", "profile_image": "https://graph.facebook.com/36912842/picture?type=large", "display_name": "Frederick Cheung", "link": "https://stackoverflow.com/users/1064226/frederick-cheung"}, "edited": false, "score": 0, "creation_date": 1473240115, "post_id": 39365333, "comment_id": 66060397, "body": "That&#39;s just a warning - you don&#39;t need minitest explicitly  in your Gemfile. Is something in your app requiring a file from minitest?"}, {"owner": {"reputation": 95, "user_id": 3166642, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/971dd3066d2ec6e47910271f2826a5bd?s=128&d=identicon&r=PG&f=1", "display_name": "user3166642", "link": "https://stackoverflow.com/users/3166642/user3166642"}, "edited": false, "score": 0, "creation_date": 1473240497, "post_id": 39365333, "comment_id": 66060641, "body": "No.Things were working fine when I was running my app in Rails 4.1 this is happening while upgrading to Rails 4.2"}], "answers": [{"tags": [], "owner": {"reputation": 3629, "user_id": 379639, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/4fa63505dd4dd4691b87d30508b1bfd3?s=128&d=identicon&r=PG", "display_name": "Xavier Shay", "link": "https://stackoverflow.com/users/379639/xavier-shay"}, "is_accepted": false, "score": 0, "last_activity_date": 1473524731, "creation_date": 1473524731, "answer_id": 39428158, "question_id": 39365333, "link": "https://stackoverflow.com/questions/39365333/rspec-failing-while-upgrading-rubygem-rails-to-4-2-x/39428158#39428158", "title": "Rspec failing while upgrading RubyGem-rails to 4.2.x", "body": "<p><code>require \"rspec/autorun\"</code> was deprecated in RSpec 3, so is not the solution to your problem. You should remove it. You should also remove <code>minitest</code> from your <code>Gemfile</code>. It's likely being pulled in by a dependency, having you explicitly specify it won't change anything.</p>\n\n<p><code>minitest</code> and <code>rspec</code> are two separate libraries. The warning is not coming from <code>rspec</code>. I'm guessing you're just seeing it when you run your test suite. My best guess is that one of your test libraries is loading minitest some how. It's a big hammer, but you can try installing all your gems to a local cache <code>bundle install --vendor</code> and then grepping for minitest: <code>grep minitest/autorun -R .</code> to try and locate.</p>\n"}], "owner": {"reputation": 95, "user_id": 3166642, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/971dd3066d2ec6e47910271f2826a5bd?s=128&d=identicon&r=PG&f=1", "display_name": "user3166642", "link": "https://stackoverflow.com/users/3166642/user3166642"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 28, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1473524731, "creation_date": 1473238300, "last_edit_date": 1592644375, "question_id": 39365333, "link": "https://stackoverflow.com/questions/39365333/rspec-failing-while-upgrading-rubygem-rails-to-4-2-x", "title": "Rspec failing while upgrading RubyGem-rails to 4.2.x", "body": "<p>I am upgrading <code>rails</code> from 4.1 to 4.2.x. I am facing multiple issues while upgrading it. As of now <code>rspec</code> is failing with following error :</p>\n<blockquote>\n<p>Warning: you should require 'minitest/autorun' instead.</p>\n<p>Warning: or add 'gem &quot;minitest&quot;' before 'require &quot;minitest/autorun&quot;'</p>\n</blockquote>\n<p>I have also added <code>minitest</code> in my Gemfile.</p>\n<p>Can you please help me in figuring out on how this can be removed?</p>\n<p><strong>Update:</strong></p>\n<p>My <code>rspec_helper.rb</code> has <code>require 'rspec/autorun'</code>. I replaced it with <code>require 'minitest/autorun'</code>. I still run into same error.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "heroku", "spree"], "comments": [{"owner": {"reputation": 1574, "user_id": 5519062, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/VjBcP.jpg?s=128&g=1", "display_name": "Vo Kim Nguyen", "link": "https://stackoverflow.com/users/5519062/vo-kim-nguyen"}, "reply_to_user": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 0, "creation_date": 1473238568, "post_id": 39365043, "comment_id": 66059431, "body": "It is 0 worker, and 1 dyno Hobby."}, {"owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 0, "creation_date": 1473239204, "post_id": 39365043, "comment_id": 66059844, "body": "What server do you use (e.g. unicorn, puma, webrick)? How is that server configured?"}, {"owner": {"reputation": 1574, "user_id": 5519062, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/VjBcP.jpg?s=128&g=1", "display_name": "Vo Kim Nguyen", "link": "https://stackoverflow.com/users/5519062/vo-kim-nguyen"}, "reply_to_user": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 0, "creation_date": 1473240429, "post_id": 39365043, "comment_id": 66060602, "body": "I dont know, I just created app on Heroku. But I got this on Web Console web bundle exec unicorn -p $PORT -c ./config/unicorn.rb  worker bundle exec rake qc:work  Is that mean unicorn ?"}, {"owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 0, "creation_date": 1473240607, "post_id": 39365043, "comment_id": 66060726, "body": "Yes, that mean you are running a <code>unicorn</code> server. Can you please add the content of your  <code>config&#47;unicorn.rb</code> file to your question?"}, {"owner": {"reputation": 1574, "user_id": 5519062, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/VjBcP.jpg?s=128&g=1", "display_name": "Vo Kim Nguyen", "link": "https://stackoverflow.com/users/5519062/vo-kim-nguyen"}, "reply_to_user": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 0, "creation_date": 1473240882, "post_id": 39365043, "comment_id": 66060903, "body": "worker_processes Integer(ENV[&quot;WEB_CONCURRENCY&quot;] || 2) timeout 30 preload_app true  before_fork do |server, worker|   Signal.trap &#39;TERM&#39; do     puts &#39;Unicorn master intercepting TERM and sending myself QUIT instead&#39;     Process.kill &#39;QUIT&#39;, Process.pid   end    defined?(ActiveRecord::Base) and     ActiveRecord::Base.connection.disconnect! end after_fork do |server, worker|   Signal.trap &#39;TERM&#39; do     puts &#39;Unicorn worker intercepting TERM and doing nothing. Wait for master to send QUIT&#39;   end   defined?(ActiveRecord::Base) and     ActiveRecord::Base.establish_connection end"}, {"owner": {"reputation": 1574, "user_id": 5519062, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/VjBcP.jpg?s=128&g=1", "display_name": "Vo Kim Nguyen", "link": "https://stackoverflow.com/users/5519062/vo-kim-nguyen"}, "reply_to_user": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 0, "creation_date": 1473240915, "post_id": 39365043, "comment_id": 66060929, "body": "God, it not break line"}], "answers": [{"tags": [], "owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "is_accepted": true, "score": 2, "last_activity_date": 1473241165, "creation_date": 1473241165, "answer_id": 39366394, "question_id": 39365043, "link": "https://stackoverflow.com/questions/39365043/high-memory-usage-on-heroku-rubyonrail-app/39366394#39366394", "title": "High Memory Usage on Heroku RubyOnRail App", "body": "<p>From the <a href=\"http://guides.spreecommerce.org/developer/heroku.html\" rel=\"nofollow\">docs</a>:</p>\n\n<blockquote>\n  <p>We have found that the 1X and 2X dynos do not perform at a production-ready efficiency for a Spree store. Although some stores will work fine on the 2X dynos, if you\u2019re having speed problems we recommend running on the PX (\u201cperformance\u201d) dynos only.</p>\n</blockquote>\n\n<p>That said: A Heroku Hobby dyno has only 512MB what is below the hardware requirements of this application. They recommend running PX dynos that have at least 2.5GB RAM.</p>\n"}], "owner": {"reputation": 1574, "user_id": 5519062, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/VjBcP.jpg?s=128&g=1", "display_name": "Vo Kim Nguyen", "link": "https://stackoverflow.com/users/5519062/vo-kim-nguyen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 255, "favorite_count": 0, "accepted_answer_id": 39366394, "answer_count": 1, "score": 0, "last_activity_date": 1473241165, "creation_date": 1473237411, "question_id": 39365043, "link": "https://stackoverflow.com/questions/39365043/high-memory-usage-on-heroku-rubyonrail-app", "title": "High Memory Usage on Heroku RubyOnRail App", "body": "<p>I'm using Heroku to deploy my RubyOnRail app, and use Spree CMS\nLike in pic, I got very high Memory Usage, but very low requests/min. Dont know what happen here. Someone can give me a suggest please ?</p>\n\n<p><a href=\"https://i.stack.imgur.com/7uDOH.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/7uDOH.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["ruby-on-rails", "ruby", "web", "file-upload", "paperclip"], "answers": [{"comments": [{"owner": {"reputation": 123, "user_id": 5533638, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/8bac36b1c0c38a48b12739203d97e1e0?s=128&d=identicon&r=PG&f=1", "display_name": "Lolo", "link": "https://stackoverflow.com/users/5533638/lolo"}, "edited": false, "score": 0, "creation_date": 1473237443, "post_id": 39364920, "comment_id": 66058769, "body": "Thank you for your answer, but this leads to the same error."}, {"owner": {"reputation": 4265, "user_id": 4601088, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/bN143.jpg?s=128&g=1", "display_name": "Bart\u0142omiej G\u0142adys", "link": "https://stackoverflow.com/users/4601088/bart%c5%82omiej-g%c5%82adys"}, "reply_to_user": {"reputation": 123, "user_id": 5533638, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/8bac36b1c0c38a48b12739203d97e1e0?s=128&d=identicon&r=PG&f=1", "display_name": "Lolo", "link": "https://stackoverflow.com/users/5533638/lolo"}, "edited": false, "score": 0, "creation_date": 1473237506, "post_id": 39364920, "comment_id": 66058807, "body": "Can you show also code from your <code>TestRunController </code> ?"}, {"owner": {"reputation": 123, "user_id": 5533638, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/8bac36b1c0c38a48b12739203d97e1e0?s=128&d=identicon&r=PG&f=1", "display_name": "Lolo", "link": "https://stackoverflow.com/users/5533638/lolo"}, "edited": false, "score": 0, "creation_date": 1473237851, "post_id": 39364920, "comment_id": 66059004, "body": "I&#39;ve added it to the question. Only the create method and the private methods should be relevant, as the error occurs while creating a test run."}], "tags": [], "owner": {"reputation": 4265, "user_id": 4601088, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/bN143.jpg?s=128&g=1", "display_name": "Bart\u0142omiej G\u0142adys", "link": "https://stackoverflow.com/users/4601088/bart%c5%82omiej-g%c5%82adys"}, "is_accepted": true, "score": 1, "last_activity_date": 1473238069, "last_edit_date": 1473238069, "creation_date": 1473237074, "answer_id": 39364920, "question_id": 39364809, "link": "https://stackoverflow.com/questions/39364809/ruby-on-rails-paperclip-nohandleerror/39364920#39364920", "title": "Ruby on Rails - Paperclip - NoHandleError", "body": "<p>run migration:</p>\n\n<pre><code>rails generate paperclip attachment attachment\n</code></pre>\n\n<p>in your view:</p>\n\n<pre><code>&lt;%= fields_for :attachment do |field| %&gt;\n    &lt;%= field.file_field :attachment %&gt;&lt;br /&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>your <code>attachment_params</code></p>\n\n<pre><code>def attachment_params\n  params.require(:attachment).permit(:name, :user_id, :attachable_id, :attachable_type, :attachment)\nend\n</code></pre>\n\n<p>your method <code>create</code></p>\n\n<pre><code>def create\n\n  @test_run = TestRun.new(test_run_params)\n\n  attachment = Attachment.create(attachment_params)\n\n  render text: @test_run.attachments.first.inspect\nend\n</code></pre>\n\n<p>you must also included in this controller method <code>attachment_params</code></p>\n"}], "owner": {"reputation": 123, "user_id": 5533638, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/8bac36b1c0c38a48b12739203d97e1e0?s=128&d=identicon&r=PG&f=1", "display_name": "Lolo", "link": "https://stackoverflow.com/users/5533638/lolo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 134, "favorite_count": 0, "accepted_answer_id": 39364920, "answer_count": 1, "score": 0, "last_activity_date": 1473238069, "creation_date": 1473236719, "last_edit_date": 1473237775, "question_id": 39364809, "link": "https://stackoverflow.com/questions/39364809/ruby-on-rails-paperclip-nohandleerror", "title": "Ruby on Rails - Paperclip - NoHandleError", "body": "<p><br>\nI got an error while setting up a polymorphic file upload with the paperclip gem on Ruby on Rails.<br>\nIn the following, I will show you the relevant code parts.<br></p>\n\n<p>I've set up a _form partial:</p>\n\n<pre><code>&lt;%= form_for(@test_run, :html =&gt; { :multipart =&gt; true }) do |f| %&gt;\n&lt;div class=\"row\"&gt;\n  &lt;div class=\"large-6 columns\"&gt;\n\n    &lt;%= fields_for :attachment do |attachment_fields| %&gt;\n        &lt;%= attachment_fields.file_field :attachment %&gt;&lt;br /&gt;\n    &lt;% end %&gt;\n\n    &lt;%= f.label :name %&gt;\n    &lt;%= f.text_field :name %&gt;\n\n    &lt;%= f.submit t('buttons.general.save'), :class =&gt; \"button slim\", data: {disable_with: \"#{t('buttons.general.disable')}\"}, :alt =&gt; t('buttons.general.save'),:title =&gt; t('buttons.general.save') %&gt;\n  &lt;/div&gt;\n&lt;/div&gt;\n</code></pre>\n\n\n\n<p>My attachment model contains the file validation:</p>\n\n<pre><code>class Attachment &lt; ActiveRecord::Base\n  belongs_to :attachable, :polymorphic =&gt; :true\n\n  has_attached_file :attachment\n  validates_attachment_content_type :attachment, content_type: /\\A(image|application)\\/.*\\z/\nend\n</code></pre>\n\n<p>In the attachment controller I whitelist the following parameters:</p>\n\n<pre><code>def attachment_params\n  params.require(:attachment).permit(:name, :user_id, :attachable_id, :attachable_type, :attachedfile)\nend\n</code></pre>\n\n<p>The attachment should be attached to a test run. Here is the test run model:</p>\n\n<pre><code>class TestRun &lt; ActiveRecord::Base\n  belongs_to :test_object\n\n  has_many :attachments, :as =&gt; :attachable\n\n  accepts_nested_attributes_for :attachments\nend\n</code></pre>\n\n<p>The create method and the private methods of the test runs controller could be relevant, too:</p>\n\n<pre><code>def create\n  @test_run = TestRun.new(test_run_params)\n\n  attachment = Attachment.create(:attachable_id =&gt; @test_run_id, :attachment =&gt; params[:attachment])\n\n  render text: @test_run.attachments.first.inspect\nend\n\nprivate\n  # Use callbacks to share common setup or constraints between actions.\n  def set_test_run\n    @test_run = TestRun.find(params[:id])\n  end\n\n  # Never trust parameters from the scary internet, only allow the white list through.\n  def test_run_params\n    params.require(:test_run).permit(:name, :test_object_id, :attachment, :start_time, :end_time, :test_demands, :allowed_bug_types, :max_testers, :test_language, :postprocessing_time, :test_standards, :target_tester, :target_devices)\n  end\n</code></pre>\n\n<p>To give you a completely overview, here is the attachment migration file:</p>\n\n<pre><code>class CreateAttachments &lt; ActiveRecord::Migration\n  def change\n    create_table :attachments do |t|\n      t.string :name\n      t.integer :user_id\n      t.integer :attachable_id\n      t.string :attachable_type\n\n      t.timestamps null: false\n    end\n  end\nend\n</code></pre>\n\n<p>Now, when I run this, fill out the form and select a valid file and submit the form after this, I receive the following error:<br><br>\n<strong>Paperclip::AdapterRegistry::NoHandlerError in TestRunsController#create</strong><br>\nOk, somehow, stackoverflow shrinks the error message, so I put it on <a href=\"http://pastebin.com/c0tjsMCL\" rel=\"nofollow\">pastebin</a>.</p>\n\n<p>If hope, someone of you could help me, as I am on this point since days of researching for bugs.<br>\nThank you!</p>\n"}, {"tags": ["javascript", "ruby-on-rails", "ruby", "ruby-on-rails-3", "undefined"], "answers": [{"tags": [], "owner": {"reputation": 27144, "user_id": 3857758, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/58c4295826435f049b7fc32b98c240f9?s=128&d=identicon&r=PG&f=1", "display_name": "Ursus", "link": "https://stackoverflow.com/users/3857758/ursus"}, "is_accepted": false, "score": 0, "last_activity_date": 1473233935, "creation_date": 1473233935, "answer_id": 39363945, "question_id": 39363875, "link": "https://stackoverflow.com/questions/39363875/undefined-method-map-for-idsymbol/39363945#39363945", "title": "undefined method `map&#39; for :id:Symbol", "body": "<p>Third parameter of <code>collection_select</code> has to be a collection (to populate the select), not a symbol.</p>\n\n<p><a href=\"http://apidock.com/rails/ActionView/Helpers/FormOptionsHelper/collection_select\" rel=\"nofollow\">http://apidock.com/rails/ActionView/Helpers/FormOptionsHelper/collection_select</a></p>\n"}, {"comments": [{"owner": {"reputation": 2578, "user_id": 4383667, "user_type": "registered", "accept_rate": 86, "profile_image": "https://lh3.googleusercontent.com/-0D7SldkahZc/AAAAAAAAAAI/AAAAAAAAAFk/V8nUZfLVtyk/photo.jpg?sz=128", "display_name": "AnthonyGalli.com", "link": "https://stackoverflow.com/users/4383667/anthonygalli-com"}, "edited": false, "score": 0, "creation_date": 1473234910, "post_id": 39364033, "comment_id": 66057229, "body": "Thank you! I changed <code>:duel</code> to <code>:dueler</code> because <code>:dueler</code> has the column <code>challenge_id</code>. This removed the error, but I&#39;m still struggling with my larger goal over at this question if you&#39;re willing to assist: <a href=\"http://stackoverflow.com/questions/39349262/how-to-only-show-dropdown-options-for-user/39350351#39350351\" title=\"how to only show dropdown options for user\">stackoverflow.com/questions/39349262/&hellip;</a> :)"}], "tags": [], "owner": {"reputation": 19261, "user_id": 4758119, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/F4dJY.jpg?s=128&g=1", "display_name": "Deepak Mahakale", "link": "https://stackoverflow.com/users/4758119/deepak-mahakale"}, "is_accepted": true, "score": 1, "last_activity_date": 1473234222, "creation_date": 1473234222, "answer_id": 39364033, "question_id": 39363875, "link": "https://stackoverflow.com/questions/39363875/undefined-method-map-for-idsymbol/39364033#39364033", "title": "undefined method `map&#39; for :id:Symbol", "body": "<p>Change this to:</p>\n\n<pre><code>&lt;%= collection_select(:duel, :challenge_id, challenges, :id, :full_challenge, include_blank: true) %&gt;\n</code></pre>\n\n<p>Refer <a href=\"http://apidock.com/rails/ActionView/Helpers/FormOptionsHelper/collection_select\" rel=\"nofollow\"><code>collection_select</code></a></p>\n"}], "owner": {"reputation": 2578, "user_id": 4383667, "user_type": "registered", "accept_rate": 86, "profile_image": "https://lh3.googleusercontent.com/-0D7SldkahZc/AAAAAAAAAAI/AAAAAAAAAFk/V8nUZfLVtyk/photo.jpg?sz=128", "display_name": "AnthonyGalli.com", "link": "https://stackoverflow.com/users/4383667/anthonygalli-com"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 560, "favorite_count": 0, "accepted_answer_id": 39364033, "answer_count": 2, "score": 0, "last_activity_date": 1473234222, "creation_date": 1473233694, "question_id": 39363875, "link": "https://stackoverflow.com/questions/39363875/undefined-method-map-for-idsymbol", "title": "undefined method `map&#39; for :id:Symbol", "body": "<pre><code>ActionView::Template::Error (undefined method `map' for :id:Symbol):\n    1: &lt;div id=\"dropdown-no-2\"&gt;\n    2:    &lt;%= collection_select 'challenge_id', challenges, :id, :full_challenge, include_blank: true %&gt;.\n    3: &lt;/div&gt;\n</code></pre>\n\n<p>How can I solve this error so that only the challenges for that respective user are listed?</p>\n\n<p><strong>duels/_dueler_fields.html.erb</strong></p>\n\n<pre><code>&lt;%= f.select :user_id, User.order(:name).map { |user| [user.full_name, user.id] }, include_blank: true, id: \"change-challenge-options\" %&gt;\n\n  will\n\n&lt;%= render :partial =&gt; 'user_challenges', locals: {challenges: Challenge.order(:created_at)} %&gt;\n\n&lt;script&gt;\n$( \"#change-challenge-options\" ).change(function() {\n     $.ajax({\n        type: \"GET\",\n        url: '&lt;%= user_challenges_path %&gt;',\n        data: {name: $('#change-challenge-options').prop('value')}\n     });\n});\n&lt;/script&gt;\n</code></pre>\n\n<p><strong>duels/_user_challenges.html.erb</strong></p>\n\n<pre><code>&lt;div id=\"dropdown-no-2\"&gt;\n   &lt;%= collection_select(':challenge_id', challenges, :id, :full_challenge, include_blank: true) %&gt;.\n&lt;/div&gt;\n</code></pre>\n\n<p><strong>duels/user_challenges.html.erb</strong></p>\n\n<pre><code>$(\"#dropdown-no-2\").html('&lt;%=j render :partial =&gt; \"user_challenges\", locals: {challenges: @challenges} %&gt;'); \n</code></pre>\n\n<p><strong>duels_controller.rb</strong></p>\n\n<pre><code>  def user_challenges\n    @user = User.find(params[:id])\n    @challenges = @user.challenges.order(:created_at)\n  end\n\n  def new\n    @duel = Duel.new\n    @duel.duelers &lt;&lt; Dueler.new(user_id: current_user.id, user_name: current_user.name, user_last_name: current_user.last_name)\n    respond_with(@duel)\n   end\n</code></pre>\n\n<p><strong>routes.rb</strong></p>\n\n<pre><code>get 'duels/user_challenges', :to =&gt; 'duels#user_challenges', as: 'user_challenges'\n</code></pre>\n"}, {"tags": ["ruby", "unit-testing"], "comments": [{"owner": {"reputation": 24970, "user_id": 73673, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/H81Fx.jpg?s=128&g=1", "display_name": "berkes", "link": "https://stackoverflow.com/users/73673/berkes"}, "edited": false, "score": 0, "creation_date": 1473233325, "post_id": 39363679, "comment_id": 66056338, "body": "Just to be sure: How is the result different from the de-facto standard <a href=\"https://github.com/relevance/rcov\" rel=\"nofollow noreferrer\">rcov</a> or <a href=\"https://github.com/colszowka/simplecov\" rel=\"nofollow noreferrer\">simplecov</a> ? This in case you were not aware of them and was looking in the wrong direction."}, {"owner": {"reputation": 3525, "user_id": 517529, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c2a5bc0633a2eef9274744bd273063a4?s=128&d=identicon&r=PG", "display_name": "hakunin", "link": "https://stackoverflow.com/users/517529/hakunin"}, "reply_to_user": {"reputation": 24970, "user_id": 73673, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/H81Fx.jpg?s=128&g=1", "display_name": "berkes", "link": "https://stackoverflow.com/users/73673/berkes"}, "edited": false, "score": 0, "creation_date": 1473234338, "post_id": 39363679, "comment_id": 66056898, "body": "I am aware of those. Coverage tests don&#39;t change your code to find things that don&#39;t affect tests."}], "answers": [{"tags": [], "owner": {"reputation": 3525, "user_id": 517529, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c2a5bc0633a2eef9274744bd273063a4?s=128&d=identicon&r=PG", "display_name": "hakunin", "link": "https://stackoverflow.com/users/517529/hakunin"}, "is_accepted": false, "score": 1, "last_activity_date": 1473234431, "creation_date": 1473234431, "answer_id": 39364101, "question_id": 39363679, "link": "https://stackoverflow.com/questions/39363679/test-coverage-gem-for-ruby-that-checks-lines-are-actually-covered/39364101#39364101", "title": "Test coverage gem for ruby that checks lines are actually covered", "body": "<p>Found it, its called <strong>Mutation testing</strong>:</p>\n\n<blockquote>\n  <p>Mutation testing is not an alternative to line coverage. While line coverage asks \u201cwhat percentage of our code is run by our tests,\u201d mutation testing asks \u201cwhat code can I change without breaking your tests?\u201d Mutation testing tools answer this question by applying and testing small modifications to your application.</p>\n</blockquote>\n\n<p>Article:\n<a href=\"https://blog.blockscore.com/how-to-write-better-code-using-mutation-testing/\" rel=\"nofollow\">https://blog.blockscore.com/how-to-write-better-code-using-mutation-testing/</a></p>\n\n<p>RailsConf talk: <a href=\"http://confreaks.tv/videos/railsconf2014-mutation-testing-with-mutant\" rel=\"nofollow\">http://confreaks.tv/videos/railsconf2014-mutation-testing-with-mutant</a></p>\n"}], "owner": {"reputation": 3525, "user_id": 517529, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c2a5bc0633a2eef9274744bd273063a4?s=128&d=identicon&r=PG", "display_name": "hakunin", "link": "https://stackoverflow.com/users/517529/hakunin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 61, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1473234431, "creation_date": 1473233080, "question_id": 39363679, "link": "https://stackoverflow.com/questions/39363679/test-coverage-gem-for-ruby-that-checks-lines-are-actually-covered", "title": "Test coverage gem for ruby that checks lines are actually covered", "body": "<p>I used a tool that would help me improve test coverage by checking that the lines of the file that I am testing actually mattered to the spec.</p>\n\n<p>It was done by disabling each line in the tested file and seeing if any tests failed. If no tests failed after a line was disabled, it was considered not covered.</p>\n\n<p>I can't seem to find it today, maybe it was in a different language. Any ideas?</p>\n"}, {"tags": ["ruby", "activerecord", "concurrency", "thread-safety"], "answers": [{"comments": [{"owner": {"reputation": 2160, "user_id": 351756, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/5bc950c9dbdedd419d0421a895162cda?s=128&d=identicon&r=PG", "display_name": "Remo", "link": "https://stackoverflow.com/users/351756/remo"}, "edited": false, "score": 0, "creation_date": 1473237162, "post_id": 39364871, "comment_id": 66058589, "body": "Thanks for your insights. Since the cache involves a whole tree structure, handling a rollback there would practically mean to re-implement  a db-like transaction handling for the cache as well. Just invalidating the cache and reloading it later would also be a solution, but very complicated for a tree structure. Is there no go-to solution for these kinds of problems?"}, {"owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "reply_to_user": {"reputation": 2160, "user_id": 351756, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/5bc950c9dbdedd419d0421a895162cda?s=128&d=identicon&r=PG", "display_name": "Remo", "link": "https://stackoverflow.com/users/351756/remo"}, "edited": false, "score": 1, "creation_date": 1473237770, "post_id": 39364871, "comment_id": 66058963, "body": "How often to the records change? How often do you read the records? How complex is the structure in the cache? Perhaps it might be possible to optimize your database schema for reading instead of relying on caching for reading?"}, {"owner": {"reputation": 2160, "user_id": 351756, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/5bc950c9dbdedd419d0421a895162cda?s=128&d=identicon&r=PG", "display_name": "Remo", "link": "https://stackoverflow.com/users/351756/remo"}, "edited": false, "score": 0, "creation_date": 1473240313, "post_id": 39364871, "comment_id": 66060529, "body": "The records can change quite often and it&#39;s a tree structure of 50-100k records, so I think it&#39;s not an option reading this (on every request) without caching. The query is a nested query which takes about 1.4 seconds and I don&#39;t see much potential for optimization there."}], "tags": [], "owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "is_accepted": false, "score": 2, "last_activity_date": 1473237456, "last_edit_date": 1473237456, "creation_date": 1473236913, "answer_id": 39364871, "question_id": 39363650, "link": "https://stackoverflow.com/questions/39363650/ensure-consistency-when-caching-data-in-after-commit-hooks/39364871#39364871", "title": "Ensure consistency when caching data in after_commit hooks", "body": "<p>You are right about this problem.</p>\n\n<p>There is a <code>after_save</code> callback that runs within the same transaction. You might want to use that one instead of the <code>after_commit</code> hook that run after the transaction.</p>\n\n<p>But than you will need to deal with a rolled back transaction yourself.</p>\n\n<p>Or you might want to write your caching method in a way that does not depend on a specific instance. But instead caches the latest version that is found in the database by reloading the record from the database first.</p>\n\n<p>But even than: Multithreaded systems are hard to keep in sync. And you cannot even ensure if the first or the second update send to your cache would be stored, because the caching system might be multi-threaded too.</p>\n\n<p>You might want to read about <a href=\"https://en.wikipedia.org/wiki/Consistency_model\" rel=\"nofollow\">different consistency models</a>.</p>\n"}, {"tags": [], "owner": {"reputation": 2160, "user_id": 351756, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/5bc950c9dbdedd419d0421a895162cda?s=128&d=identicon&r=PG", "display_name": "Remo", "link": "https://stackoverflow.com/users/351756/remo"}, "is_accepted": true, "score": 1, "last_activity_date": 1474969305, "creation_date": 1474969305, "answer_id": 39721297, "question_id": 39363650, "link": "https://stackoverflow.com/questions/39363650/ensure-consistency-when-caching-data-in-after-commit-hooks/39721297#39721297", "title": "Ensure consistency when caching data in after_commit hooks", "body": "<p>The solution we came up with is to lock the cache for read / write <code>before_commit</code> and unlock it in the <code>after_commit</code>. This seems to do the trick.</p>\n"}], "owner": {"reputation": 2160, "user_id": 351756, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/5bc950c9dbdedd419d0421a895162cda?s=128&d=identicon&r=PG", "display_name": "Remo", "link": "https://stackoverflow.com/users/351756/remo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 53, "favorite_count": 0, "accepted_answer_id": 39721297, "answer_count": 2, "score": 1, "last_activity_date": 1474969305, "creation_date": 1473232968, "question_id": 39363650, "link": "https://stackoverflow.com/questions/39363650/ensure-consistency-when-caching-data-in-after-commit-hooks", "title": "Ensure consistency when caching data in after_commit hooks", "body": "<p>For a specific database table, we need an in-memory cache of this data that is always in-sync with the database. My current attempt is to write the changes to the cache in an <code>after_commit</code> hook - this way we make sure not to write any changes to the cache that could get reverted later.</p>\n\n<p>However, this strategy is vulnerable to the following scenario:</p>\n\n<ol>\n<li>Thread A locks and updates record, stores value <code>1</code></li>\n<li>Thread A commits the change</li>\n<li>Thread B locks and updates record, stores value <code>2</code></li>\n<li>Thread B commits the change</li>\n<li>Thread B runs the <code>after_commit</code> hook, so the cache now has value <code>2</code></li>\n<li>Thread A runs the <code>after_commit</code> hook, so the cache now has value <code>1</code> but should have value <code>2</code></li>\n</ol>\n\n<p>Am I right about this problem and how would one solve this?</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "answers": [{"comments": [{"owner": {"reputation": 5137, "user_id": 2540962, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/48af49c847595b610847f291ce116c68?s=128&d=identicon&r=PG&f=1", "display_name": "Jeremy Lynch", "link": "https://stackoverflow.com/users/2540962/jeremy-lynch"}, "edited": false, "score": 0, "creation_date": 1473231423, "post_id": 39363089, "comment_id": 66055243, "body": "I am getting the error <code>undefined method &#39;html_safe&#39; for 1:Fixnum</code>"}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 1, "creation_date": 1473231595, "post_id": 39363089, "comment_id": 66055360, "body": "yield is the same as <code>block.call</code>"}, {"owner": {"reputation": 2375, "user_id": 6151945, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/FeM2V.jpg?s=128&g=1", "display_name": "lei liu", "link": "https://stackoverflow.com/users/6151945/lei-liu"}, "edited": false, "score": 0, "creation_date": 1473231643, "post_id": 39363089, "comment_id": 66055389, "body": "how did you invoke the method?"}], "tags": [], "owner": {"reputation": 2375, "user_id": 6151945, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/FeM2V.jpg?s=128&g=1", "display_name": "lei liu", "link": "https://stackoverflow.com/users/6151945/lei-liu"}, "is_accepted": false, "score": 1, "last_activity_date": 1473231333, "creation_date": 1473231333, "answer_id": 39363089, "question_id": 39363014, "link": "https://stackoverflow.com/questions/39363014/using-block-to-pass-html-to-method/39363089#39363089", "title": "Using &amp;block to pass html to method", "body": "<p>use yield:</p>\n\n<pre><code>def new_button(link)\n  link_to link do\n      yield.html_safe if block_given?\n  end\nend\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1473231736, "post_id": 39363216, "comment_id": 66055434, "body": "<code>html_safe</code> is lost :)"}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "reply_to_user": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1473231866, "post_id": 39363216, "comment_id": 66055497, "body": "Ah, that is true. In this case, I find the question unclear. :)"}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1473232268, "post_id": 39363216, "comment_id": 66055713, "body": "<code>link_to &#39;&#47;&#39;, &amp;-&gt; { block.call.html_safe }</code>?"}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 1, "creation_date": 1473235302, "post_id": 39363216, "comment_id": 66057467, "body": "Leaving out <code>html_safe</code> is perfectly fine. <code>button</code> should not be responsible for marking the string as safe."}], "tags": [], "owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "is_accepted": false, "score": 3, "last_activity_date": 1473231661, "creation_date": 1473231661, "answer_id": 39363216, "question_id": 39363014, "link": "https://stackoverflow.com/questions/39363014/using-block-to-pass-html-to-method/39363216#39363216", "title": "Using &amp;block to pass html to method", "body": "<p>So, you just want to pass the block on to link_to? Do this.</p>\n\n<pre><code>def button(&amp;block)\n  link_to '/', &amp;block\nend\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "is_accepted": false, "score": 2, "last_activity_date": 1473232193, "creation_date": 1473232193, "answer_id": 39363379, "question_id": 39363014, "link": "https://stackoverflow.com/questions/39363014/using-block-to-pass-html-to-method/39363379#39363379", "title": "Using &amp;block to pass html to method", "body": "<p>You are likely messing things up. What you are trying to achieve is easily achievable without any <code>yield</code> magic, with plain old good method parameter:</p>\n\n<pre><code>def button html\n  link_to '/', html.html_safe\nend\n\nbutton '&lt;div&gt;html content&lt;/div&gt;'\n</code></pre>\n\n<p>If one wants to yield a value from a block, do something with it and pass it further, one might:</p>\n\n<pre><code>def button\n  raise unless block_given?\n  \u03bb = Proc.new\n  link_to '/', &amp;-&gt; { \u03bb.call.html_safe }\nend\n\nbutton { '&lt;div&gt;html content&lt;/div&gt;' }\n</code></pre>\n"}], "owner": {"reputation": 5137, "user_id": 2540962, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/48af49c847595b610847f291ce116c68?s=128&d=identicon&r=PG&f=1", "display_name": "Jeremy Lynch", "link": "https://stackoverflow.com/users/2540962/jeremy-lynch"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 474, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1473232193, "creation_date": 1473231069, "last_edit_date": 1473231450, "question_id": 39363014, "link": "https://stackoverflow.com/questions/39363014/using-block-to-pass-html-to-method", "title": "Using &amp;block to pass html to method", "body": "<p>How can I pass a block to a method. For example: </p>\n\n<pre><code># in the view\nbutton(link) do\n  '&lt;div&gt;html content&lt;/div&gt;'\nend\n\ndef button(&amp;block)\n  block\nend\n</code></pre>\n\n<p>I have the following code which is working: </p>\n\n<pre><code># in helper file\ndef button(&amp;block)\n  link_to '/' do\n      block.call.html_safe\n  end\nend\n\n\n# in the view\nbutton {'&lt;div&gt;html content&lt;/div&gt;'}\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "default-scope"], "comments": [{"owner": {"reputation": 4265, "user_id": 4601088, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/bN143.jpg?s=128&g=1", "display_name": "Bart\u0142omiej G\u0142adys", "link": "https://stackoverflow.com/users/4601088/bart%c5%82omiej-g%c5%82adys"}, "edited": false, "score": 0, "creation_date": 1473231250, "post_id": 39363012, "comment_id": 66055127, "body": "role is class variable or what ?"}, {"owner": {"reputation": 230, "user_id": 989512, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/f3aa6d51920d47e4c13e347cc2de32f4?s=128&d=identicon&r=PG", "display_name": "srikant", "link": "https://stackoverflow.com/users/989512/srikant"}, "reply_to_user": {"reputation": 4265, "user_id": 4601088, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/bN143.jpg?s=128&g=1", "display_name": "Bart\u0142omiej G\u0142adys", "link": "https://stackoverflow.com/users/4601088/bart%c5%82omiej-g%c5%82adys"}, "edited": false, "score": 0, "creation_date": 1473231514, "post_id": 39363012, "comment_id": 66055297, "body": "consider role as an attribute of logged in user"}, {"owner": {"reputation": 2131, "user_id": 3475678, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/230e565cac4491b28134bb92bfc28a70?s=128&d=identicon&r=PG&f=1", "display_name": "Aleksey", "link": "https://stackoverflow.com/users/3475678/aleksey"}, "edited": false, "score": 1, "creation_date": 1473231587, "post_id": 39363012, "comment_id": 66055353, "body": "It seems like very bad pattern. What about gems such as CanCan?"}, {"owner": {"reputation": 445, "user_id": 5026941, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/IMpEg.jpg?s=128&g=1", "display_name": "BIlal Khan", "link": "https://stackoverflow.com/users/5026941/bilal-khan"}, "edited": false, "score": 0, "creation_date": 1473231872, "post_id": 39363012, "comment_id": 66055501, "body": "Use a scope instead of it and pass a role parameter to it."}, {"owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 0, "creation_date": 1473232994, "post_id": 39363012, "comment_id": 66056119, "body": "Ruby on Rails reached its end of life-cycle with the release of <a href=\"http://weblog.rubyonrails.org/2016/6/30/Rails-5-0-final/\" rel=\"nofollow noreferrer\">Rails 5.0</a> on June 30th, 2016. Updating to a maintained version (4.2.x or 5.0.x at the moment) is highly recommended."}], "answers": [{"comments": [{"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1473232372, "post_id": 39363234, "comment_id": 66055786, "body": "Consider using <code>case role</code> over messy <code>if</code>s spaghetty. BTW, you have a typo in <code>elsif</code>."}, {"owner": {"reputation": 47232, "user_id": 1772830, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/Qtoqg.jpg?s=128&g=1", "display_name": "Andrey Deineko", "link": "https://stackoverflow.com/users/1772830/andrey-deineko"}, "reply_to_user": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1473232418, "post_id": 39363234, "comment_id": 66055810, "body": "@mudasobwa yep, thought about <code>case role</code>, but just copied what author had in OP."}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1473232685, "post_id": 39363234, "comment_id": 66055958, "body": "Also, dynamically evaluated <code>lambda</code> differs from static implementation by OP."}, {"owner": {"reputation": 230, "user_id": 989512, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/f3aa6d51920d47e4c13e347cc2de32f4?s=128&d=identicon&r=PG", "display_name": "srikant", "link": "https://stackoverflow.com/users/989512/srikant"}, "edited": false, "score": 0, "creation_date": 1473271246, "post_id": 39363234, "comment_id": 66080854, "body": "decided to use scope as Andrey suggested. yes on Rails 3.2.x, it is a legacy application, cost of migrating to newer version of Rails is high, but it is in pipeline."}, {"owner": {"reputation": 47232, "user_id": 1772830, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/Qtoqg.jpg?s=128&g=1", "display_name": "Andrey Deineko", "link": "https://stackoverflow.com/users/1772830/andrey-deineko"}, "reply_to_user": {"reputation": 230, "user_id": 989512, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/f3aa6d51920d47e4c13e347cc2de32f4?s=128&d=identicon&r=PG", "display_name": "srikant", "link": "https://stackoverflow.com/users/989512/srikant"}, "edited": false, "score": 0, "creation_date": 1475391820, "post_id": 39363234, "comment_id": 66919917, "body": "@srikant please make sure to check the checkmark on the left near the answer if it answers your question"}, {"owner": {"reputation": 3219, "user_id": 2202674, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/NYHNX.jpg?s=128&g=1", "display_name": "Greg Blass", "link": "https://stackoverflow.com/users/2202674/greg-blass"}, "edited": false, "score": 1, "creation_date": 1521148196, "post_id": 39363234, "comment_id": 85620655, "body": "Plus one for &#39;Nothing is impossible in programming.&#39; I tell my clients this all the time."}], "tags": [], "owner": {"reputation": 47232, "user_id": 1772830, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/Qtoqg.jpg?s=128&g=1", "display_name": "Andrey Deineko", "link": "https://stackoverflow.com/users/1772830/andrey-deineko"}, "is_accepted": true, "score": 2, "last_activity_date": 1473232635, "last_edit_date": 1473232635, "creation_date": 1473231745, "answer_id": 39363234, "question_id": 39363012, "link": "https://stackoverflow.com/questions/39363012/is-it-possible-to-have-conditional-default-scope-in-rails/39363234#39363234", "title": "is it possible to have conditional default scope in rails?", "body": "<p>Nothing is impossible in programming.</p>\n\n<p>Using <code>default_scope</code> is a bad idea in general (lots of articles are written on the topic).</p>\n\n<p>If you insist on using current user's atribute you can pass it as an argument to scope:</p>\n\n<pre><code>scope :based_on_role, lambda { |role|\n  if role == 'xyz'\n    where(is_active: false)\n  elsif role == 'abc'\n    where(is_active: true)\n  end\n}\n</code></pre>\n\n<p>And then use it as follows:</p>\n\n<pre><code>Model.based_on_role(current_user.role)\n</code></pre>\n\n<p>Sidenote: Rails 3.2.x - seriously?...</p>\n"}, {"comments": [{"owner": {"reputation": 47232, "user_id": 1772830, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/Qtoqg.jpg?s=128&g=1", "display_name": "Andrey Deineko", "link": "https://stackoverflow.com/users/1772830/andrey-deineko"}, "edited": false, "score": 0, "creation_date": 1473232900, "post_id": 39363447, "comment_id": 66056071, "body": "I think it will just throw <code>undefined variable or method &#39;role&#39; for Model</code>"}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "reply_to_user": {"reputation": 47232, "user_id": 1772830, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/Qtoqg.jpg?s=128&g=1", "display_name": "Andrey Deineko", "link": "https://stackoverflow.com/users/1772830/andrey-deineko"}, "edited": false, "score": 0, "creation_date": 1473233161, "post_id": 39363447, "comment_id": 66056230, "body": "Once again, as I have said in the comment to your answer, there is a significant difference between static and dynamic clauses. This one is static, it\u2019s evaluated in model\u2019s context once."}], "tags": [], "owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "is_accepted": false, "score": 1, "last_activity_date": 1473232405, "creation_date": 1473232405, "answer_id": 39363447, "question_id": 39363012, "link": "https://stackoverflow.com/questions/39363012/is-it-possible-to-have-conditional-default-scope-in-rails/39363447#39363447", "title": "is it possible to have conditional default scope in rails?", "body": "<pre><code>default_scope where(\n  case role\n  when 'xyz' then { is_active: false }\n  when 'abc' then { is_active: true }\n  else '1 = 1'\n  end\n)\n</code></pre>\n\n<p>Also, please read the answer by Andrey Deineko, specifically the part about default scopes usage.</p>\n"}], "owner": {"reputation": 230, "user_id": 989512, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/f3aa6d51920d47e4c13e347cc2de32f4?s=128&d=identicon&r=PG", "display_name": "srikant", "link": "https://stackoverflow.com/users/989512/srikant"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1507, "favorite_count": 1, "accepted_answer_id": 39363234, "answer_count": 2, "score": 0, "last_activity_date": 1473232635, "creation_date": 1473231064, "last_edit_date": 1473232482, "question_id": 39363012, "link": "https://stackoverflow.com/questions/39363012/is-it-possible-to-have-conditional-default-scope-in-rails", "title": "is it possible to have conditional default scope in rails?", "body": "<p>I am on rails 3.2.21, ruby version is 2.0</p>\n\n<p>My requirement is to have role based conditional default scope for a particular model. eg</p>\n\n<p>consider role variable as an attribute of logged in user</p>\n\n<pre><code>if role == 'xyz'\n  default_scope where(is_active: false)\nelsif role == 'abc'\n   default_scope where(is_active: true)\nend\n</code></pre>\n"}, {"tags": ["ruby", "return-value", "irb", "puts"], "comments": [{"owner": {"reputation": 3090, "user_id": 4454732, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh3.googleusercontent.com/-8OrTJkCtkn4/AAAAAAAAAAI/AAAAAAAAA4s/7jp2lrThK2k/photo.jpg?sz=128", "display_name": "David Hempy", "link": "https://stackoverflow.com/users/4454732/david-hempy"}, "edited": false, "score": 1, "creation_date": 1523285921, "post_id": 39362740, "comment_id": 86485847, "body": "irb prints out the return value of each command you type. Kind of like an interactive debugger. When a script is run, it does not output anything, unless told to with <code>puts</code> or similar."}], "answers": [{"comments": [{"owner": {"reputation": 2415, "user_id": 5225057, "user_type": "registered", "accept_rate": 94, "profile_image": "https://lh4.googleusercontent.com/-BQOs6bXTlFc/AAAAAAAAAAI/AAAAAAAAAT8/-aYe7hZBGyI/photo.jpg?sz=128", "display_name": "Mr. Kennedy", "link": "https://stackoverflow.com/users/5225057/mr-kennedy"}, "edited": false, "score": 0, "creation_date": 1473231054, "post_id": 39362812, "comment_id": 66055015, "body": "Interesting... will have to get familiar with begin, looks very useful. Of note, when I use the explicit <code>puts</code> in the irb conditional, I get the &#39;is true&#39; printed along with another line of <code>=&gt; nil</code>"}, {"owner": {"reputation": 3381, "user_id": 220679, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a5c165ffc801b46ddff8851d5b49bf3e?s=128&d=identicon&r=PG", "display_name": "Ginty", "link": "https://stackoverflow.com/users/220679/ginty"}, "reply_to_user": {"reputation": 2415, "user_id": 5225057, "user_type": "registered", "accept_rate": 94, "profile_image": "https://lh4.googleusercontent.com/-BQOs6bXTlFc/AAAAAAAAAAI/AAAAAAAAAT8/-aYe7hZBGyI/photo.jpg?sz=128", "display_name": "Mr. Kennedy", "link": "https://stackoverflow.com/users/5225057/mr-kennedy"}, "edited": false, "score": 1, "creation_date": 1473231224, "post_id": 39362812, "comment_id": 66055111, "body": "Ah yes, sorry about that, you are seeing the return value of the puts operation which is nil. I&#39;ve edited my answer appropriately."}, {"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 1, "creation_date": 1473231287, "post_id": 39362812, "comment_id": 66055149, "body": "That&#39;s because <a href=\"http://ruby-doc.org/core/Kernel.html#method-i-puts\" rel=\"nofollow noreferrer\"><code>Kernel#puts</code> returns <code>nil</code>, as stated in the documentation</a>."}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 1, "creation_date": 1473231435, "post_id": 39362812, "comment_id": 66055250, "body": "@Ginty: you don&#39;t need <code>begin</code> here. You can just do <code>val = if true ...</code>"}, {"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 1, "creation_date": 1473231438, "post_id": 39362812, "comment_id": 66055254, "body": "What&#39;s the purpose of the <code>begin</code> block? You don&#39;t have any exceptions, you don&#39;t have multiple expressions, what do you need it for?"}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "reply_to_user": {"reputation": 2415, "user_id": 5225057, "user_type": "registered", "accept_rate": 94, "profile_image": "https://lh4.googleusercontent.com/-BQOs6bXTlFc/AAAAAAAAAAI/AAAAAAAAAT8/-aYe7hZBGyI/photo.jpg?sz=128", "display_name": "Mr. Kennedy", "link": "https://stackoverflow.com/users/5225057/mr-kennedy"}, "edited": false, "score": 1, "creation_date": 1473231493, "post_id": 39362812, "comment_id": 66055286, "body": "@Mr.Kennedy: &quot;I get the &#39;is true&#39; printed along with another line of =&gt; nil&quot;. Of course. One is return value, the other - side-effect."}, {"owner": {"reputation": 2415, "user_id": 5225057, "user_type": "registered", "accept_rate": 94, "profile_image": "https://lh4.googleusercontent.com/-BQOs6bXTlFc/AAAAAAAAAAI/AAAAAAAAAT8/-aYe7hZBGyI/photo.jpg?sz=128", "display_name": "Mr. Kennedy", "link": "https://stackoverflow.com/users/5225057/mr-kennedy"}, "reply_to_user": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 0, "creation_date": 1473231760, "post_id": 39362812, "comment_id": 66055448, "body": "@J&#246;rgWMittag - excellent resource, I have much to learn about the Kernel and Ruby innards. Thank you."}, {"owner": {"reputation": 2415, "user_id": 5225057, "user_type": "registered", "accept_rate": 94, "profile_image": "https://lh4.googleusercontent.com/-BQOs6bXTlFc/AAAAAAAAAAI/AAAAAAAAAT8/-aYe7hZBGyI/photo.jpg?sz=128", "display_name": "Mr. Kennedy", "link": "https://stackoverflow.com/users/5225057/mr-kennedy"}, "reply_to_user": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1473233005, "post_id": 39362812, "comment_id": 66056127, "body": "@SergioTulentsev so in the instance of &quot;true_3&quot;, Ruby is printing the string without an explicit call to the <code>puts</code> method in the function... Hmmm... I see that &quot;truthiness.class&quot; identifies a String... so essentially truthiness returns-- no, &quot;evaluates&quot; to a String value and then the call to &quot;puts truthiness&quot;... Okay... I&#39;m starting to understand... :P"}, {"owner": {"reputation": 2415, "user_id": 5225057, "user_type": "registered", "accept_rate": 94, "profile_image": "https://lh4.googleusercontent.com/-BQOs6bXTlFc/AAAAAAAAAAI/AAAAAAAAAT8/-aYe7hZBGyI/photo.jpg?sz=128", "display_name": "Mr. Kennedy", "link": "https://stackoverflow.com/users/5225057/mr-kennedy"}, "edited": false, "score": 0, "creation_date": 1473233150, "post_id": 39362812, "comment_id": 66056220, "body": "@Ginty is irb showing the &quot;return&quot; value, or would it be more correct to say that irb is displaying the conditionals evaluation?"}, {"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "reply_to_user": {"reputation": 2415, "user_id": 5225057, "user_type": "registered", "accept_rate": 94, "profile_image": "https://lh4.googleusercontent.com/-BQOs6bXTlFc/AAAAAAAAAAI/AAAAAAAAAT8/-aYe7hZBGyI/photo.jpg?sz=128", "display_name": "Mr. Kennedy", "link": "https://stackoverflow.com/users/5225057/mr-kennedy"}, "edited": false, "score": 3, "creation_date": 1473233850, "post_id": 39362812, "comment_id": 66056635, "body": "@Mr.Kennedy: IRb is a REPL - a Read Eval Print Loop. It Reads what you type into it, Evaluates the code, Prints out its value, then Loops back to the beginning (i.e. Reads the next expression). So, yes, it is printing the result of evaluating the expression. This is commonly shortened to saying &quot;return value&quot;, although strictly speaking there is no method call and thus no <code>return</code>. (More precisely: IRb is printing the result of calling the <a href=\"http://ruby-doc.org/core/Object.html#method-i-inspect\" rel=\"nofollow noreferrer\"><code>inspect</code></a> method on the object that is the value of evaluating the expression.)"}, {"owner": {"reputation": 2415, "user_id": 5225057, "user_type": "registered", "accept_rate": 94, "profile_image": "https://lh4.googleusercontent.com/-BQOs6bXTlFc/AAAAAAAAAAI/AAAAAAAAAT8/-aYe7hZBGyI/photo.jpg?sz=128", "display_name": "Mr. Kennedy", "link": "https://stackoverflow.com/users/5225057/mr-kennedy"}, "reply_to_user": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 0, "creation_date": 1473234031, "post_id": 39362812, "comment_id": 66056727, "body": "@J&#246;rgWMittag your explanation helps enormously. Much obliged!"}], "tags": [], "owner": {"reputation": 3381, "user_id": 220679, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a5c165ffc801b46ddff8851d5b49bf3e?s=128&d=identicon&r=PG", "display_name": "Ginty", "link": "https://stackoverflow.com/users/220679/ginty"}, "is_accepted": true, "score": 4, "last_activity_date": 1473231530, "last_edit_date": 1473231530, "creation_date": 1473230474, "answer_id": 39362812, "question_id": 39362740, "link": "https://stackoverflow.com/questions/39362740/what-condition-is-my-ruby-conditional-in/39362812#39362812", "title": "What condition is my Ruby conditional in?", "body": "<p>The IRB output here is showing the return value of the operation, which is not necessarily what is printed to STDOUT (i.e. the terminal) during execution.</p>\n\n<p>Your script is just throwing the return value away, you would have to do this:</p>\n\n<pre><code>val = if true\n        'is true_1'\n      else\n        'is false'\n      end\n\nputs val\n</code></pre>\n"}], "owner": {"reputation": 2415, "user_id": 5225057, "user_type": "registered", "accept_rate": 94, "profile_image": "https://lh4.googleusercontent.com/-BQOs6bXTlFc/AAAAAAAAAAI/AAAAAAAAAT8/-aYe7hZBGyI/photo.jpg?sz=128", "display_name": "Mr. Kennedy", "link": "https://stackoverflow.com/users/5225057/mr-kennedy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 672, "favorite_count": 0, "accepted_answer_id": 39362812, "answer_count": 1, "score": 2, "last_activity_date": 1473233381, "creation_date": 1473230271, "last_edit_date": 1491982285, "question_id": 39362740, "link": "https://stackoverflow.com/questions/39362740/what-condition-is-my-ruby-conditional-in", "title": "What condition is my Ruby conditional in?", "body": "<p>The following conditional syntax displays the string 'is true' in irb without using <code>puts</code></p>\n\n<pre><code>irb(main):001:0&gt; if true\nirb(main):002:1&gt;   'is true'\nirb(main):003:1&gt; else\nirb(main):004:1*   'is false'\nirb(main):005:1&gt; end\n=&gt; \"is true\"\n</code></pre>\n\n<p>...yet when I invoke the same syntax in a script and run it from the command line, it gets ignored. Why?</p>\n\n<pre><code># Odd behaviour:\nputs \"Why do only two of the three conditionals print?\"\n\n# This doesn't put anything to screen:\nif true\n  'is true_1'\nelse\n  'is false'\nend\n\nputs \"Seriously, why? Or better yet: how?\"\n\n# But this does:\nif true\n  puts 'is true_2'\nelse\n  puts 'is false'\nend\n\n# And this works without \"puts\":\ndef truthiness\n  if 1.send(:==, 1)\n    'is true_3'\n  else\n    'is false'\n  end\nend\n\nputs truthiness\nputs \"Weird.\"\n</code></pre>\n\n<p>When I run this as a script, it displays:</p>\n\n<pre><code>\"Why do only two of the three conditionals print?\nSeriously, why? Or better yet: how?\nis true_2\nis true_3\nWeird.\"\n</code></pre>\n\n<p>FWIW, I am following along with Sandi Metz's talk \"Nothing is Something\"\n<a href=\"https://youtu.be/zc9OvLzS9mU\" rel=\"nofollow noreferrer\">https://youtu.be/zc9OvLzS9mU</a>\n...and listening to this:\n<a href=\"https://youtu.be/AULOC--qUOI\" rel=\"nofollow noreferrer\">https://youtu.be/AULOC--qUOI</a> \nApologies as I am new to Ruby and trying to wrap my head around how it does what it does.<br>\nEDIT:\nUseful resources:<br>\n<a href=\"http://ruby-doc.org/core-2.3.1/Kernel.html#method-i-puts\" rel=\"nofollow noreferrer\">http://ruby-doc.org/core-2.3.1/Kernel.html#method-i-puts</a><br>\n<a href=\"https://softwareengineering.stackexchange.com/questions/150824/is-the-puts-function-of-ruby-a-method-of-an-object\">https://softwareengineering.stackexchange.com/questions/150824/is-the-puts-function-of-ruby-a-method-of-an-object</a></p>\n"}, {"tags": ["ruby-on-rails", "ruby", "activerecord"], "answers": [{"comments": [{"owner": {"reputation": 48635, "user_id": 6742, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/xPawo.png?s=128&g=1", "display_name": "David Aldridge", "link": "https://stackoverflow.com/users/6742/david-aldridge"}, "edited": false, "score": 0, "creation_date": 1473233956, "post_id": 39362569, "comment_id": 66056690, "body": "As spickermann says, where returns a set of records. That could be zero, one, or many. Find is the correct ActiveRecord method."}, {"owner": {"reputation": 1538, "user_id": 655650, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/maO3T.jpg?s=128&g=1", "display_name": "Tass", "link": "https://stackoverflow.com/users/655650/tass"}, "edited": false, "score": 0, "creation_date": 1473276745, "post_id": 39362569, "comment_id": 66083389, "body": "At the beginning of your response, you have &quot;NB&quot; in bold. What does that mean?"}], "tags": [], "owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "is_accepted": false, "score": 1, "last_activity_date": 1473234418, "last_edit_date": 1473234418, "creation_date": 1473229582, "answer_id": 39362569, "question_id": 39362536, "link": "https://stackoverflow.com/questions/39362536/rubys-where-vs-detect/39362569#39362569", "title": "Ruby&#39;s .where vs. detect", "body": "<p><strong>NB</strong> <em>One should use <code>ActiveRecord#find</code> in this particular case, please refer to the answer by @spickermann instead.</em></p>\n\n<p><code>User.where</code> is executed on DB level, returning one record.</p>\n\n<p><code>User.all.detect</code> will return <em>all the records</em> to the application, and only then iterate through <em>on ruby level</em>.</p>\n\n<p>That said, one <strong>must</strong> use <code>where</code>. The former is resistant to an amount of records, there might be billions and the execution time / memory consumption would be nearly the same (<code>O(1)</code>.) The latter might even fail on billions of records.</p>\n"}, {"comments": [{"owner": {"reputation": 48635, "user_id": 6742, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/xPawo.png?s=128&g=1", "display_name": "David Aldridge", "link": "https://stackoverflow.com/users/6742/david-aldridge"}, "edited": false, "score": 0, "creation_date": 1473233884, "post_id": 39363858, "comment_id": 66056650, "body": "I suppose that technically speaking User.where(id: 1) returns an ActiveRecord collection proxy? But spot on for find being the correct method."}, {"owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "reply_to_user": {"reputation": 48635, "user_id": 6742, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/xPawo.png?s=128&g=1", "display_name": "David Aldridge", "link": "https://stackoverflow.com/users/6742/david-aldridge"}, "edited": false, "score": 0, "creation_date": 1473234218, "post_id": 39363858, "comment_id": 66056823, "body": "@DavidAldridge: You are right <code>where</code> returns a ActiveRecord Relation (not an array). In this example that doesn&#39;t make a huge difference, but in other examples it might be important to be more precise."}, {"owner": {"reputation": 8519, "user_id": 3581788, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/ghs5V.jpg?s=128&g=1", "display_name": "Sylar", "link": "https://stackoverflow.com/users/3581788/sylar"}, "edited": false, "score": 0, "creation_date": 1473235228, "post_id": 39363858, "comment_id": 66057416, "body": "So what if it&#39;s not just the <code>id</code> Im after? That&#39;s why I use <code>.where</code> in the example."}, {"owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "reply_to_user": {"reputation": 8519, "user_id": 3581788, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/ghs5V.jpg?s=128&g=1", "display_name": "Sylar", "link": "https://stackoverflow.com/users/3581788/sylar"}, "edited": false, "score": 0, "creation_date": 1473236623, "post_id": 39363858, "comment_id": 66058259, "body": "@Sylar: The <code>find</code> version only work when you are using the primary key. The <code>find_by</code> should be used when you are only interested in <i>one</i> (the first matchin) record (<code>find_by</code> is a short cut for <code>where(...).first</code>). <code>where</code> will always be faster that <code>all.detect</code> for multiple records. Don&#39;t forget to add an index when you query tables on columns other than the <code>id</code> on a regular base."}, {"owner": {"reputation": 8519, "user_id": 3581788, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/ghs5V.jpg?s=128&g=1", "display_name": "Sylar", "link": "https://stackoverflow.com/users/3581788/sylar"}, "edited": false, "score": 0, "creation_date": 1473236784, "post_id": 39363858, "comment_id": 66058355, "body": "Great. So <code>find_by</code> for email would be faster than  <code>where</code>? Email would be unique."}, {"owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 1, "creation_date": 1473237541, "post_id": 39363858, "comment_id": 66058826, "body": "Yes, <code>find_by(email: ...)</code> would be the fastest solution when emails are unique in your database. Please ensure to add an uniq index to your database column and do not only rely on Rails uniqueness validations."}], "tags": [], "owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "is_accepted": true, "score": 6, "last_activity_date": 1574327119, "last_edit_date": 1574327119, "creation_date": 1473233649, "answer_id": 39363858, "question_id": 39362536, "link": "https://stackoverflow.com/questions/39362536/rubys-where-vs-detect/39363858#39363858", "title": "Ruby&#39;s .where vs. detect", "body": "<p>In this example </p>\n\n<pre><code>User.find(1)        # or\nUser.find_by(id: 1)\n</code></pre>\n\n<p>will be the fastest solutions. Because both queries tell the database to return exactly one record with a matching <code>id</code>. As soon as the database finds a matching record, it doesn't look further but returns that one record immediately.</p>\n\n<p>Whereas</p>\n\n<pre><code>User.where(id: 1)\n</code></pre>\n\n<p>would return an array of objects matching the condition. That means: After a matching record was found the database would continue looking for other records to match the query and therefore always scan the whole database table. In this case \u2013 since <code>id</code> is very likely a column with unique values \u2013 it would return an array with only one instance.</p>\n\n<p>In opposite to</p>\n\n<pre><code>User.all.detect { |u| u.id == 1 }\n</code></pre>\n\n<p>that would load all users from the database. This will result in loading thousands of users into memory, building ActiveRecord instances, iterating over that array and then throwing away all records that do not match the condition. This will be very slow compared to just loading matching records from the database.</p>\n\n<p>Database management systems are optimized to run selection queries and you can improve their ability to do so by designing a useful schema and adding appropriate indexes. Every record loaded from the database will need to be translated into an instance of ActiveRecord and will consume memory - both operations are not for free. Therefore the rule of thumb should be: Whenever possible run queries directly in the database instead of in Ruby. </p>\n"}, {"comments": [{"owner": {"reputation": 8519, "user_id": 3581788, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/ghs5V.jpg?s=128&g=1", "display_name": "Sylar", "link": "https://stackoverflow.com/users/3581788/sylar"}, "edited": false, "score": 0, "creation_date": 1574343268, "post_id": 58974082, "comment_id": 104205454, "body": "Hi and thanks for your support. This question was 3 years ago. Are you sure <code>find_by_&lt;x&gt;</code> was implemented then?"}], "tags": [], "owner": {"reputation": 1074, "user_id": 776109, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/a69a9eca8e330212b33125e133bda0fb?s=128&d=identicon&r=PG", "display_name": "Sprachprofi", "link": "https://stackoverflow.com/users/776109/sprachprofi"}, "is_accepted": false, "score": 0, "last_activity_date": 1574336225, "creation_date": 1574336225, "answer_id": 58974082, "question_id": 39362536, "link": "https://stackoverflow.com/questions/39362536/rubys-where-vs-detect/58974082#58974082", "title": "Ruby&#39;s .where vs. detect", "body": "<p><strong>Here's a general guide:</strong></p>\n\n<p>Use <code>.find(id)</code> whenever you are looking for a unique record. You can use something like <code>.find_by_email(email)</code> or <code>.find_by_name(name)</code> or similar (these finders methods are automatically generated) when searching non-ID fields, as long as there is only one record with that particular value. </p>\n\n<p>Use <code>.where(...).limit(1)</code> if your query is too complex for a .find_by query or you need to use ordering but you are still certain that you only want one record to be returned.</p>\n\n<p>Use <code>.where(...)</code> when retrieving multiple records.</p>\n\n<p>Use <code>.detect</code> only if you cannot avoid it. Typical use cases for .detect are on non-ActiveRecord enumerables, or when you have a set of records but are unable to write the matching condition in SQL (e.g. if it involves a complex function). As <code>.detect</code> is the slowest, make sure that before calling <code>.detect</code> you have used SQL to narrow down the query as much as possible. Ditto for <code>.any?</code> and other <a href=\"https://ruby-doc.org/core-2.6.5/Enumerable.html\" rel=\"nofollow noreferrer\">enumerable methods</a>. Just because they are available for ActiveRecord objects doesn't mean that they are a good idea to use ;)</p>\n"}], "owner": {"reputation": 8519, "user_id": 3581788, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/ghs5V.jpg?s=128&g=1", "display_name": "Sylar", "link": "https://stackoverflow.com/users/3581788/sylar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3528, "favorite_count": 0, "accepted_answer_id": 39363858, "answer_count": 3, "score": 4, "last_activity_date": 1574336225, "creation_date": 1473229448, "last_edit_date": 1495540304, "question_id": 39362536, "link": "https://stackoverflow.com/questions/39362536/rubys-where-vs-detect", "title": "Ruby&#39;s .where vs. detect", "body": "<p>I'm looking for a method that is faster and uses less server processing. In my application, I can use both <code>.where</code> and <code>.detect</code>:</p>\n\n<p><strong>Where:</strong></p>\n\n<pre><code>User.where(id: 1)\n# User Load (0.5ms)\n</code></pre>\n\n<p><strong>Detect:</strong></p>\n\n<pre><code>User.all.detect{ |u| u.id == 1 }\n# User Load (0.7ms). Sometimes increases more than .where\n</code></pre>\n\n<p>I understand that <code>.detect</code> <a href=\"https://stackoverflow.com/questions/2986852/ruby-detect-method\">returns the first item in the list for which the block returns TRUE</a> but how does it compares with <code>.where</code> if I have thousands of Users?</p>\n\n<p>Edited for clarity.</p>\n\n<p><code>.where</code> is used in this example because I may not query for the <code>id</code> alone. What if I have a table column called \"name\"?</p>\n"}, {"tags": ["arrays", "ruby", "string", "numbers", "comparison"], "comments": [{"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 0, "creation_date": 1473233669, "post_id": 39361601, "comment_id": 66056524, "body": "Your question is unclear. You repeatedly ask about arrays, but there isn&#39;t a single array in your entire code."}], "answers": [{"tags": [], "owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "is_accepted": false, "score": 1, "last_activity_date": 1473227277, "last_edit_date": 1473227277, "creation_date": 1473226072, "answer_id": 39361794, "question_id": 39361601, "link": "https://stackoverflow.com/questions/39361601/ruby-checking-one-array-string-against-another-array-string-for-similarities/39361794#39361794", "title": "Ruby Checking one array string against another array string for similarities", "body": "<p>I understand we are given two non-negative numbers, <code>n</code> and <code>m</code>, and wish to determine if <code>n</code> and <code>m</code> have the same number of digits, and among the pairs of correspond digits of the two numbers, whether exactly one pair of digits differs by exactly one and all other pairs are equal. For example, <code>124</code> and <code>134</code> are \"one off\", but <code>124</code> and <code>12</code> and <code>124</code> and <code>135</code> are not. </p>\n\n<p>You could do the following.</p>\n\n<pre><code>def one_off?(n,m)\n  nstr, mstr = n.to_s, m.to_s\n  return false unless nstr+mstr =~ /\\A\\d+\\z/ &amp;&amp; nstr.size == mstr.size\n  nstr.each_char.zip(mstr.chars).reduce(0) { |tot, (ns, ms)|\n    tot + (ns.to_i - ms.to_i).abs } == 1\nend\n\none_off?(1234, 1233) #=&gt; true \none_off?(124, 134)   #=&gt; true \none_off?(124, 124)   #=&gt; false \none_off?(124, 135)   #=&gt; false \none_off?(124, 1245)  #=&gt; false \none_off?(124, -12)   #=&gt; false \n</code></pre>\n\n<p>See <a href=\"http://ruby-doc.org/core-2.3.0/Enumerable.html#method-i-zip\" rel=\"nofollow\">Enumerable#zip</a> and <a href=\"http://ruby-doc.org/core-2.3.0/Enumerable.html#method-i-reduce\" rel=\"nofollow\">Enumerable#reduce</a> (aka <code>inject</code>).</p>\n"}, {"comments": [{"owner": {"reputation": 298, "user_id": 6196389, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/b16e6130113046b62d3eef5495d044a2?s=128&d=identicon&r=PG&f=1", "display_name": "Mike", "link": "https://stackoverflow.com/users/6196389/mike"}, "edited": false, "score": 0, "creation_date": 1473371887, "post_id": 39362922, "comment_id": 66127659, "body": "sorry, i meant any number.  So 1234 could be 2234 or 1224 and it would hopefully return true."}], "tags": [], "owner": {"reputation": 71199, "user_id": 1301972, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/T5G7N.jpg?s=128&g=1", "display_name": "Todd A. Jacobs", "link": "https://stackoverflow.com/users/1301972/todd-a-jacobs"}, "is_accepted": false, "score": 1, "last_activity_date": 1473230814, "creation_date": 1473230814, "answer_id": 39362922, "question_id": 39361601, "link": "https://stackoverflow.com/questions/39361601/ruby-checking-one-array-string-against-another-array-string-for-similarities/39362922#39362922", "title": "Ruby Checking one array string against another array string for similarities", "body": "<h2>Using Integer Comparisons</h2>\n\n<p>There's some ambiguity in your fixture data and in the definition of what you mean by \"off by one.\" Assuming that you mean an integer that can be +1 or -1 from the target integer, then you may want to do a comparison of Integers rather than indexing into a String. For example:</p>\n\n<pre><code>def off_by_one? winner, mine\n  winner.succ == mine or winner.pred == mine ? true : false\nend\n\noff_by_one? 1234, 1234\n#=&gt; false\n\noff_by_one? 1234, 1233\n#=&gt; true\n\noff_by_one? 1234, 1235 \n#=&gt; true\n\noff_by_one? 1234, 1254\n#=&gt; false\n</code></pre>\n\n<p>This will work even in boundary conditions where the length of the integers don't match. For example:</p>\n\n<pre><code>off_by_one? 1000, 999\n#=&gt; true\n</code></pre>\n\n<p>Of course, if your business rules are more complex then you may need a different solution.</p>\n"}], "owner": {"reputation": 298, "user_id": 6196389, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/b16e6130113046b62d3eef5495d044a2?s=128&d=identicon&r=PG&f=1", "display_name": "Mike", "link": "https://stackoverflow.com/users/6196389/mike"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 51, "favorite_count": 1, "answer_count": 2, "score": 0, "last_activity_date": 1498770811, "creation_date": 1473224913, "last_edit_date": 1498770811, "question_id": 39361601, "link": "https://stackoverflow.com/questions/39361601/ruby-checking-one-array-string-against-another-array-string-for-similarities", "title": "Ruby Checking one array string against another array string for similarities", "body": "<p>The goal is to check if it is one off.  If, for instance, the <strong>winning ticket is 1234</strong>, and <strong>my ticket is 1233</strong>, or <b>2234</b>, or <b>1334</b> that should pass as true, as the ticket is one off.  Non regex involved please as this was for beginners.</p>\n\n<p>If it is exact, then it fails.  If it is more than one number off, it fails.  This is what I have so far.</p>\n\n<p>Here is my function:</p>\n\n<pre><code>require \"minitest/autorun\"\nrequire_relative \"offbyone.rb\"\n\nclass TestLottoFunction &lt; Minitest::Test\n\ndef test_a_matching_ticket_returns_false\n        my_ticket = \"1234\"\n        winning_tickets = \"1234\"\n        assert_equal(false, off(my_ticket, winning_tickets))\n    end\n\ndef test_a_one_off_ticket\n    my_ticket = \"1234\"\n    winning_tickets = \"1235\"\n    assert_equal(true, off(my_ticket, winning_tickets)) \nend\n\nend\n</code></pre>\n\n<p>I tried to spell it out in a more complicated way of what my goal was exactly, seeing if that would work, and it didn't.  I got the same error message, telling me it is line 9 and 15, telling me that the function is expecting either true or false, and it is receiving nil.  This is the code that I have.</p>\n\n<pre><code>def off(my_ticket, winning_tickets)\n    i = 0\n    c = 0\n\n4.times do\n\n    if winning_tickets[0][i] == my_ticket[0][i]\n        c+=1\n    end\n\n    i+=1\n\n    end\nif c==3\n    true\nend\nend\n</code></pre>\n\n<p>I just changed  </p>\n\n<pre><code> if winning_tickets[i] == my_tickets [i]\n</code></pre>\n\n<p>to include </p>\n\n<pre><code>winning_tickets[0][i] == my_tickets [0][i] \n</code></pre>\n\n<p>and it got rid of one error, but created a new one.  </p>\n\n<p>If I don't include the [0][i], I get an error message saying that I have 2 errors, both on the assert_equal lines, both saying they are receiving <strong>nil</strong> instead of true or false.  </p>\n\n<p>If I add the [0][i] to both lines, I get 1 error, saying my error was in the matching ticket, saying it was expecting true and received false.  </p>\n\n<p>Any help with this?  </p>\n\n<p>I am actually curious as to why I am receiving nil.  Where in the array am I going wrong to get nil.  Please point out my mistakes.</p>\n"}, {"tags": ["ruby", "methods", "operators"], "answers": [{"tags": [], "owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "is_accepted": true, "score": 0, "last_activity_date": 1473228162, "creation_date": 1473228162, "answer_id": 39362233, "question_id": 39361422, "link": "https://stackoverflow.com/questions/39361422/ruby-operationin-where-method/39362233#39362233", "title": "ruby operationin where method", "body": "<p>The logical disjunction should be done in the query, that said, on DB level, not on ruby one:</p>\n\n<pre><code>def self.search_by(search_term)\n  where(\n    \"LOWER(first_name) LIKE :search_term OR LOWER(last_name) LIKE :search_term\",\n    search_term: \"%#{search_term.downcase}%\"\n  )\nend\n</code></pre>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6536560"}, "is_accepted": false, "score": 0, "last_activity_date": 1473229295, "creation_date": 1473229295, "answer_id": 39362504, "question_id": 39361422, "link": "https://stackoverflow.com/questions/39361422/ruby-operationin-where-method/39362504#39362504", "title": "ruby operationin where method", "body": "<p>Try this:</p>\n\n<p>def self.search_by(search_term)</p>\n\n<pre><code>    where(\"first_name LIKE ? OR last_name LIKE ? \", \"%#{params[:search_term]}%\", \"%#{params[:search_term]}%\")\n</code></pre>\n\n<p>end</p>\n"}], "owner": {"reputation": 1682, "user_id": 6392696, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/09WDQ.jpg?s=128&g=1", "display_name": "nourza", "link": "https://stackoverflow.com/users/6392696/nourza"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 31, "favorite_count": 0, "accepted_answer_id": 39362233, "answer_count": 2, "score": 0, "last_activity_date": 1473229295, "creation_date": 1473223833, "question_id": 39361422, "link": "https://stackoverflow.com/questions/39361422/ruby-operationin-where-method", "title": "ruby operationin where method", "body": "<p>I have this code so what I am trying to do is if I typed the first name or the last name in the search it will result any of first or last</p>\n\n<pre><code>   def self.search_by(search_term)\n           where([\"LOWER(first_name) LIKE :search_term\", \n                  {search_term: \"%#{search_term.downcase}%\" } ]\n                ) || where([\"LOWER(last_name) LIKE :search_term\", \n                  {search_term: \"%#{search_term.downcase}%\" } ]\n   end\n\n\n&lt;%= form_for \"\", url: members_path, class: \"navbar-form navbar-left\", role: \"search\", method: :get do %&gt;\n            &lt;div id=\"tfheader\"&gt;\n              &lt;%= text_field_tag :search, @search_term  ,id: \"search\",class: \"tftextinput\", size: \"21\", maxlength: \"120\" %&gt;\n              &lt;input type=\"submit\" value=\"Search\" class=\"tfbutton\"&gt;\n              &lt;div class=\"tfclear\"&gt;&lt;/div&gt;\n            &lt;/div&gt;\n          &lt;% end %&gt;\n</code></pre>\n\n<p>Ex:</p>\n\n<ul>\n<li>First_name    Last_name</li>\n<li>John          Smeth</li>\n<li>Salma         Hayek</li>\n</ul>\n\n<p>if I type in the text area john it will give me the whole row or if I typed hayek it also give me the whole row</p>\n"}, {"tags": ["ruby"], "answers": [{"comments": [{"owner": {"reputation": 2415, "user_id": 5225057, "user_type": "registered", "accept_rate": 94, "profile_image": "https://lh4.googleusercontent.com/-BQOs6bXTlFc/AAAAAAAAAAI/AAAAAAAAAT8/-aYe7hZBGyI/photo.jpg?sz=128", "display_name": "Mr. Kennedy", "link": "https://stackoverflow.com/users/5225057/mr-kennedy"}, "edited": false, "score": 0, "creation_date": 1473230014, "post_id": 39362253, "comment_id": 66054426, "body": "Yeah, Ruby seems kinda awesome like that. So, to print a big block of text such that it only displays one screensworth of text per prompt (like long man pages), the text is formatted per the current console window size using <code>$stdout.winsize</code> ? When I <code>require &quot;io&#47;console&quot;</code> I get &quot;bad file descriptor&quot; from <code>$stdin.winsize</code> in the irb, but stdout displays my current size."}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "reply_to_user": {"reputation": 2415, "user_id": 5225057, "user_type": "registered", "accept_rate": 94, "profile_image": "https://lh4.googleusercontent.com/-BQOs6bXTlFc/AAAAAAAAAAI/AAAAAAAAAT8/-aYe7hZBGyI/photo.jpg?sz=128", "display_name": "Mr. Kennedy", "link": "https://stackoverflow.com/users/5225057/mr-kennedy"}, "edited": false, "score": 1, "creation_date": 1473230893, "post_id": 39362253, "comment_id": 66054921, "body": "Please see an update. If I understood the question properly, using internal OS commands should suffice. If not, one should implement the pagination himself."}, {"owner": {"reputation": 2415, "user_id": 5225057, "user_type": "registered", "accept_rate": 94, "profile_image": "https://lh4.googleusercontent.com/-BQOs6bXTlFc/AAAAAAAAAAI/AAAAAAAAAT8/-aYe7hZBGyI/photo.jpg?sz=128", "display_name": "Mr. Kennedy", "link": "https://stackoverflow.com/users/5225057/mr-kennedy"}, "edited": false, "score": 0, "creation_date": 1473231182, "post_id": 39362253, "comment_id": 66055091, "body": "excellent word: pagination. Sometimes just correctly describing the idea helps a lot!"}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "reply_to_user": {"reputation": 2415, "user_id": 5225057, "user_type": "registered", "accept_rate": 94, "profile_image": "https://lh4.googleusercontent.com/-BQOs6bXTlFc/AAAAAAAAAAI/AAAAAAAAAT8/-aYe7hZBGyI/photo.jpg?sz=128", "display_name": "Mr. Kennedy", "link": "https://stackoverflow.com/users/5225057/mr-kennedy"}, "edited": false, "score": 1, "creation_date": 1473231540, "post_id": 39362253, "comment_id": 66055316, "body": "That\u2019s why we all have a yellow rubber duck on the table to discuss ideas with :)"}, {"owner": {"reputation": 2415, "user_id": 5225057, "user_type": "registered", "accept_rate": 94, "profile_image": "https://lh4.googleusercontent.com/-BQOs6bXTlFc/AAAAAAAAAAI/AAAAAAAAAT8/-aYe7hZBGyI/photo.jpg?sz=128", "display_name": "Mr. Kennedy", "link": "https://stackoverflow.com/users/5225057/mr-kennedy"}, "edited": false, "score": 0, "creation_date": 1473233265, "post_id": 39362253, "comment_id": 66056301, "body": "Heh. ::quack:: :)"}, {"owner": {"reputation": 2415, "user_id": 5225057, "user_type": "registered", "accept_rate": 94, "profile_image": "https://lh4.googleusercontent.com/-BQOs6bXTlFc/AAAAAAAAAAI/AAAAAAAAAT8/-aYe7hZBGyI/photo.jpg?sz=128", "display_name": "Mr. Kennedy", "link": "https://stackoverflow.com/users/5225057/mr-kennedy"}, "edited": false, "score": 0, "creation_date": 1473754988, "post_id": 39362253, "comment_id": 66251064, "body": "ah, yes... in this instance, I can just invoke my text program with <code>ruby script.rb | more</code> nicely. . . Still speaking with my duck to see what type of programming I can muster to make long text things quack out a screen at a time."}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "reply_to_user": {"reputation": 2415, "user_id": 5225057, "user_type": "registered", "accept_rate": 94, "profile_image": "https://lh4.googleusercontent.com/-BQOs6bXTlFc/AAAAAAAAAAI/AAAAAAAAAT8/-aYe7hZBGyI/photo.jpg?sz=128", "display_name": "Mr. Kennedy", "link": "https://stackoverflow.com/users/5225057/mr-kennedy"}, "edited": false, "score": 1, "creation_date": 1473757384, "post_id": 39362253, "comment_id": 66252434, "body": "Yes, you could if and only there is only one long text sheet to be paginated. But as you have to display smth., then ask user for an input and then display anything again, just piping to <code>more</code> won\u2019t work."}, {"owner": {"reputation": 2415, "user_id": 5225057, "user_type": "registered", "accept_rate": 94, "profile_image": "https://lh4.googleusercontent.com/-BQOs6bXTlFc/AAAAAAAAAAI/AAAAAAAAAT8/-aYe7hZBGyI/photo.jpg?sz=128", "display_name": "Mr. Kennedy", "link": "https://stackoverflow.com/users/5225057/mr-kennedy"}, "edited": false, "score": 0, "creation_date": 1473801506, "post_id": 39362253, "comment_id": 66277419, "body": "Noted that when I tried piping to <code>more</code> a similarly &quot;bloggy&quot; script which also takes $ARGV...  I think there&#39;s a way to accommodate any relative window size and pagination, but it&#39;ll take a little more constructing. Your comments have been very helpful - thank you!"}], "tags": [], "owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "is_accepted": true, "score": 1, "last_activity_date": 1473230851, "last_edit_date": 1473230851, "creation_date": 1473228259, "answer_id": 39362253, "question_id": 39361317, "link": "https://stackoverflow.com/questions/39361317/how-to-make-long-blocks-of-text-display-one-screen-at-a-time/39362253#39362253", "title": "How to make long blocks of text display one screen at a time?", "body": "<p>Whether you expect something to be needed in Ruby, it\u2019s usually already implemented <a href=\"https://ruby-doc.org/stdlib-2.3.0/libdoc/io/console/rdoc/IO.html#method-i-winsize\" rel=\"nofollow\"><code>IO#winsize</code></a>:</p>\n\n<pre><code>\u25b6 $stdin.winsize\n#\u21d2 [ 105, 172 ]\n</code></pre>\n\n<hr>\n\n<p>Whether you are on *nix machine, I would go with using <code>more</code>/<code>less</code> commands to perform this task:</p>\n\n<pre><code>\u25b6 text = \"very long text\"\n\u25b6 system &lt;&lt;CMD\n\u25b7 echo '#{text.gsub(\"'\", \"\u2019\")}' | less\n\u25b7 CMD\n</code></pre>\n"}], "owner": {"reputation": 2415, "user_id": 5225057, "user_type": "registered", "accept_rate": 94, "profile_image": "https://lh4.googleusercontent.com/-BQOs6bXTlFc/AAAAAAAAAAI/AAAAAAAAAT8/-aYe7hZBGyI/photo.jpg?sz=128", "display_name": "Mr. Kennedy", "link": "https://stackoverflow.com/users/5225057/mr-kennedy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 42, "favorite_count": 0, "accepted_answer_id": 39362253, "answer_count": 1, "score": 0, "last_activity_date": 1473230851, "creation_date": 1473223163, "question_id": 39361317, "link": "https://stackoverflow.com/questions/39361317/how-to-make-long-blocks-of-text-display-one-screen-at-a-time", "title": "How to make long blocks of text display one screen at a time?", "body": "<p>Like how the man pages prompt your for <code>--more--</code> - is there a way to do this in Ruby?</p>\n\n<p>Maybe something with \"pretty_print\" or \"awesome_print\"? Or would it involve getting information about the terminal window size, a la: <a href=\"https://gist.github.com/acook/4190037\" rel=\"nofollow\">https://gist.github.com/acook/4190037</a></p>\n\n<pre><code># via http://www.megasolutions.net/ruby/Getting-the-size-of-the-terminal-in-a-portable-way-26006.aspx\nTIOCGWINSZ = 0x40087468 \n\ndef get_winsize\n  str = [0, 0, 0, 0].pack('SSSS') \n  if STDIN.ioctl(TIOCGWINSZ, str) &gt;= 0 \n    rows, cols, xpixels, ypixels = str.unpack(\"SSSS\") \n    p rows, cols, xpixels, ypixels \n  else \n    puts \"Unable to get window size\" \n  end \nend\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby"], "answers": [{"comments": [{"owner": {"reputation": 3691, "user_id": 3732906, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/d83d53cbd84d7427ebfd45190b9ded9d?s=128&d=identicon&r=PG&f=1", "display_name": "Coda Chang", "link": "https://stackoverflow.com/users/3732906/coda-chang"}, "edited": false, "score": 0, "creation_date": 1473227673, "post_id": 39361276, "comment_id": 66053328, "body": "I&#39;m not sure about you said <code>Letting arr equal the array of hashes (the first array above), we can do the following.</code> Does it mean <code>arr = data</code>?"}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "reply_to_user": {"reputation": 3691, "user_id": 3732906, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/d83d53cbd84d7427ebfd45190b9ded9d?s=128&d=identicon&r=PG&f=1", "display_name": "Coda Chang", "link": "https://stackoverflow.com/users/3732906/coda-chang"}, "edited": false, "score": 0, "creation_date": 1473227902, "post_id": 39361276, "comment_id": 66053427, "body": "If the variable <code>data</code> holds that array, yes. When you give an example it&#39;s helpful to assign a variable to each input object (e.g., <code>data = [{ :publisher=&gt;...]</code>). That way, readers can refer to those variable (here just <code>data</code>) in comments and answers without having to define them. You might edit your question to do that."}, {"owner": {"reputation": 3691, "user_id": 3732906, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/d83d53cbd84d7427ebfd45190b9ded9d?s=128&d=identicon&r=PG&f=1", "display_name": "Coda Chang", "link": "https://stackoverflow.com/users/3732906/coda-chang"}, "edited": false, "score": 0, "creation_date": 1473228297, "post_id": 39361276, "comment_id": 66053577, "body": "I did define the variable name <code>data = []</code>, and put <code>hash</code> into it in my question, did you mean this?"}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "reply_to_user": {"reputation": 3691, "user_id": 3732906, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/d83d53cbd84d7427ebfd45190b9ded9d?s=128&d=identicon&r=PG&f=1", "display_name": "Coda Chang", "link": "https://stackoverflow.com/users/3732906/coda-chang"}, "edited": false, "score": 0, "creation_date": 1473230434, "post_id": 39361276, "comment_id": 66054639, "body": "I see. My mistake."}, {"owner": {"reputation": 3691, "user_id": 3732906, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/d83d53cbd84d7427ebfd45190b9ded9d?s=128&d=identicon&r=PG&f=1", "display_name": "Coda Chang", "link": "https://stackoverflow.com/users/3732906/coda-chang"}, "edited": false, "score": 0, "creation_date": 1473232085, "post_id": 39361276, "comment_id": 66055622, "body": "Thanks, it&#39;s very useful for me!"}], "tags": [], "owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "is_accepted": true, "score": 2, "last_activity_date": 1473235551, "last_edit_date": 1473235551, "creation_date": 1473222942, "answer_id": 39361276, "question_id": 39360885, "link": "https://stackoverflow.com/questions/39360885/rails-hash-combine-by-their-value/39361276#39361276", "title": "Rails hash combine by their value", "body": "<p><strong>Code</strong></p>\n\n<pre><code>def group_em(data)\n  data.group_by { |h| [h[:publisher], h[:subject], h[:volume]] }.\n       map do |k,v|\n         h = { publisher: k[0], subject: k[1], volume: k[2] }\n         h.update(chapters: v.each_with_object([]) { |f,a|\n           a &lt;&lt; f[:chapter] }.flatten)\n       end\nend\n</code></pre>\n\n<p><strong>Example</strong></p>\n\n<p>Let <code>data</code> equal the array of hashes (the first array above).</p>\n\n<pre><code>group_em(data)\n  #=&gt; [{:publisher=&gt;{:id=&gt;96, :name=&gt;\"P1\"},\n  #     :subject=&gt;{:id=&gt;233, :name=&gt;\"S1\"},\n  #     :volume=&gt;{:id=&gt;1136, :name=&gt;\"V1\"},\n  #     :chapters=&gt;[{:id=&gt;16155, :name=&gt;\"C1\"}, {:id=&gt;16158, :name=&gt;\"C2\"}]\n  #    } \n  #   ] \n</code></pre>\n\n<p>Here <code>data</code> contains only two hashes and those hashes have the same values for the keys <code>:publisher</code>, <code>:subject</code> and <code>:volume</code>. This code allows the array to have any number of hashes, and will group them by an array of the values of those three keys, producing one hash for each of those groups. Moreover, the values of the key <code>:chapters</code> are arrays containing a single hash, but this code permits that array to contain multiple hashes. (If that array will always have exactly one hash, consider making the value of <code>:chapters</code> the hash itself rather than an array containing that hash.)</p>\n\n<p><strong>Explanation</strong></p>\n\n<p>See <a href=\"http://ruby-doc.org/core-2.3.0/Enumerable.html#method-i-group_by\" rel=\"nofollow\">Enumerable#group_by</a> and <a href=\"http://ruby-doc.org/core-2.3.0/Hash.html#method-i-update\" rel=\"nofollow\">Hash#update</a> (aka <code>Hash#merge!</code>).</p>\n\n<p>The steps are as follows.</p>\n\n<pre><code>h = data.group_by { |h| [h[:publisher], h[:subject], h[:volume]] }\n  #=&gt; {\n  #    [{:id=&gt;96, :name=&gt;\"P1\"},\n  #     {:id=&gt;233, :name=&gt;\"S1\"},\n  #     {:id=&gt;1136, :name=&gt;\"V1\"}\n  #    ]=&gt;[{:publisher=&gt;{:id=&gt;96, :name=&gt;\"P1\"},\n  #         :subject=&gt;{:id=&gt;233, :name=&gt;\"S1\"},\n  #         :volume=&gt;{:id=&gt;1136, :name=&gt;\"V1\"},\n  #         :chapter=&gt;[{:id=&gt;16155, :name=&gt;\"C1\"}]\n  #        },\n  #        {:publisher=&gt;{:id=&gt;96, :name=&gt;\"P1\"},\n  #         :subject=&gt;{:id=&gt;233, :name=&gt;\"S1\"},\n  #         :volume=&gt;{:id=&gt;1136, :name=&gt;\"V1\"},\n  #         :chapter=&gt;[{:id=&gt;16158, :name=&gt;\"C2\"}]\n  #        }\n  #       ]\n  #   } \n</code></pre>\n\n<p>The first key-value pair is passed to <code>map</code>'s block and the block variables are assigned.</p>\n\n<pre><code>k,v = h.first\n  #=&gt; [[{:id=&gt;96, :name=&gt;\"P1\"}, {:id=&gt;233, :name=&gt;\"S1\"}, {:id=&gt;1136, :name=&gt;\"V1\"}],\n  #   [{:publisher=&gt;{:id=&gt;96, :name=&gt;\"P1\"}, :subject=&gt;{:id=&gt;233, :name=&gt;\"S1\"},\n  #     :volume=&gt;{:id=&gt;1136, :name=&gt;\"V1\"}, :chapter=&gt;[{:id=&gt;16155, :name=&gt;\"C1\"}]},\n  #    {:publisher=&gt;{:id=&gt;96, :name=&gt;\"P1\"}, :subject=&gt;{:id=&gt;233, :name=&gt;\"S1\"},\n  #     :volume=&gt;{:id=&gt;1136, :name=&gt;\"V1\"}, :chapter=&gt;[{:id=&gt;16158, :name=&gt;\"C2\"}]}]]\nk #=&gt; [{:id=&gt;96, :name=&gt;\"P1\"}, {:id=&gt;233, :name=&gt;\"S1\"}, {:id=&gt;1136, :name=&gt;\"V1\"}]\nv #=&gt; [{:publisher=&gt;{:id=&gt;96, :name=&gt;\"P1\"},\n  #     :subject=&gt;{:id=&gt;233, :name=&gt;\"S1\"},\n  #     :volume=&gt;{:id=&gt;1136, :name=&gt;\"V1\"},\n  #     :chapter=&gt;[{:id=&gt;16155, :name=&gt;\"C1\"}]},\n  #    {:publisher=&gt;{:id=&gt;96, :name=&gt;\"P1\"},\n  #     :subject=&gt;{:id=&gt;233, :name=&gt;\"S1\"},\n  #     :volume=&gt;{:id=&gt;1136, :name=&gt;\"V1\"},\n  #     :chapter=&gt;[{:id=&gt;16158, :name=&gt;\"C2\"}]}] \n</code></pre>\n\n<p>and the block calculation is performed.</p>\n\n<pre><code>h = { publisher: k[0], subject: k[1], volume: k[2] }\n  #=&gt; {:publisher=&gt;{:id=&gt;96, :name=&gt;\"P1\"},\n  #    :subject=&gt;{:id=&gt;233, :name=&gt;\"S1\"},\n  #    :volume=&gt;{:id=&gt;1136, :name=&gt;\"V1\"}\n  #   } \na = v.each_with_object([]) { |f,a| a &lt;&lt; f[:chapter] }\n  #=&gt; [[{:id=&gt;16155, :name=&gt;\"C1\"}], [{:id=&gt;16158, :name=&gt;\"C2\"}]] \nb = a.flatten\n  #=&gt; [{:id=&gt;16155, :name=&gt;\"C1\"}, {:id=&gt;16158, :name=&gt;\"C2\"}]\nh.update(chapters: b)\n  #=&gt; {:publisher=&gt;{:id=&gt;96, :name=&gt;\"P1\"},\n  #    :subject=&gt;{:id=&gt;233, :name=&gt;\"S1\"},\n  #    :volume=&gt;{:id=&gt;1136, :name=&gt;\"V1\"},\n  #    :chapters=&gt;[{:id=&gt;16155, :name=&gt;\"C1\"}, {:id=&gt;16158, :name=&gt;\"C2\"}]\n  #   } \n</code></pre>\n\n<p><a href=\"http://ruby-doc.org/core-2.3.0/Hash.html#method-i-merge\" rel=\"nofollow\">Hash#merge</a> could be used in place of <code>Hash#update</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 2375, "user_id": 6151945, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/FeM2V.jpg?s=128&g=1", "display_name": "lei liu", "link": "https://stackoverflow.com/users/6151945/lei-liu"}, "reply_to_user": {"reputation": 3691, "user_id": 3732906, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/d83d53cbd84d7427ebfd45190b9ded9d?s=128&d=identicon&r=PG&f=1", "display_name": "Coda Chang", "link": "https://stackoverflow.com/users/3732906/coda-chang"}, "edited": false, "score": 0, "creation_date": 1473232464, "post_id": 39362950, "comment_id": 66055831, "body": "At the last line, result = data.values, it becomes a array."}, {"owner": {"reputation": 3691, "user_id": 3732906, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/d83d53cbd84d7427ebfd45190b9ded9d?s=128&d=identicon&r=PG&f=1", "display_name": "Coda Chang", "link": "https://stackoverflow.com/users/3732906/coda-chang"}, "edited": false, "score": 0, "creation_date": 1473232513, "post_id": 39362950, "comment_id": 66055864, "body": "Oh, I miss it, it&#39;s really amazing approach!"}], "tags": [], "owner": {"reputation": 2375, "user_id": 6151945, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/FeM2V.jpg?s=128&g=1", "display_name": "lei liu", "link": "https://stackoverflow.com/users/6151945/lei-liu"}, "is_accepted": false, "score": 1, "last_activity_date": 1473230874, "creation_date": 1473230874, "answer_id": 39362950, "question_id": 39360885, "link": "https://stackoverflow.com/questions/39360885/rails-hash-combine-by-their-value/39362950#39362950", "title": "Rails hash combine by their value", "body": "<p>How about:</p>\n\n<pre><code>    data = {}\n\n    question_set.questions.each do |q|\n      key = \"#{q.publisher.id}:#{q.book_volume.subject.id}:#{q.book_volume_id}\"\n      if data[key].present?\n        data[key][:chapter] &lt;&lt; {id: q.section_id, name: q.section.name}\n      else\n        data[key] = {publisher: {id: q.publisher.id, name: q.publisher.name}, subject: {id: q.book_volume.subject.id, name: q.book_volume.subject.name}, volume: {id: q.book_volume_id, name: q.book_volume.name}, chapter: [{id: q.section_id, name: q.section.name}]}  \n      end\n    end\n\n    result = data.values\n</code></pre>\n\n<p>use the combination of publisher'id, subject'id and volume'id as a unique key to combine your data.</p>\n"}], "owner": {"reputation": 3691, "user_id": 3732906, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/d83d53cbd84d7427ebfd45190b9ded9d?s=128&d=identicon&r=PG&f=1", "display_name": "Coda Chang", "link": "https://stackoverflow.com/users/3732906/coda-chang"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 70, "favorite_count": 0, "accepted_answer_id": 39361276, "answer_count": 2, "score": 1, "last_activity_date": 1473235551, "creation_date": 1473219822, "last_edit_date": 1473228081, "question_id": 39360885, "link": "https://stackoverflow.com/questions/39360885/rails-hash-combine-by-their-value", "title": "Rails hash combine by their value", "body": "<p>I have a <code>questions</code> list, and I need to separate them. The relationship is </p>\n\n<pre><code>Question_set has_many questions\nBookVolume has_many questions\nSubject has_many  book_volumes\nPublisher has_many subjects\nSection has_many :questions\n</code></pre>\n\n<p>Now I only put <code>questions</code> and their relative model <code>id</code>, <code>name</code> into <code>hash</code> inside an <code>array</code>.</p>\n\n<pre><code>data = []\nquestion_set.questions.each do |q|\n    data &lt;&lt; {publisher: {id: q.publisher.id, name: q.publisher.name}, subject: {id: q.book_volume.subject.id, name: q.book_volume.subject.name}, volume: {id: q.book_volume_id, name: q.book_volume.name}, chapter: [{id: q.section_id, name: q.section.name}]}  \nend\n</code></pre>\n\n<p>Therefore, the <code>data</code> basically will be</p>\n\n<pre><code>&gt;&gt;data\n\n[\n    {\n        :publisher =&gt; {\n              :id =&gt; 96,\n            :name =&gt; \"P1\"\n        },\n          :subject =&gt; {\n              :id =&gt; 233,\n            :name =&gt; \"S1\"\n        },\n           :volume =&gt; {\n              :id =&gt; 1136,\n            :name =&gt; \"V1\"\n        },\n          :chapter =&gt; [\n            {\n                  :id =&gt; 16155,\n                :name =&gt; \"C1\"\n            }\n        ]\n    },\n       {\n        :publisher =&gt; {\n              :id =&gt; 96,\n            :name =&gt; \"P1\"\n        },\n          :subject =&gt; {\n              :id =&gt; 233,\n            :name =&gt; \"S1\"\n        },\n           :volume =&gt; {\n              :id =&gt; 1136,\n            :name =&gt; \"V1\"\n        },\n          :chapter =&gt; [\n            {\n                  :id =&gt; 16158,\n                :name =&gt; \"C2\"\n            }\n        ]\n    }\n]\n</code></pre>\n\n<p>However, I want the <code>chapter</code> to be combined if they got the same <code>publisher</code>, <code>subject</code> and <code>volume</code>\nSo, in this case, it will be</p>\n\n<pre><code>&gt;&gt;data \n\n[\n    {\n        :publisher =&gt; {\n              :id =&gt; 96,\n            :name =&gt; \"P1\"\n        },\n          :subject =&gt; {\n              :id =&gt; 233,\n            :name =&gt; \"S1\"\n        },\n           :volume =&gt; {\n              :id =&gt; 1136,\n            :name =&gt; \"V1\"\n        },\n          :chapter =&gt; [\n            {\n                  :id =&gt; 16155,\n                :name =&gt; \"C2\"\n            },\n            {\n                  :id =&gt; 16158,\n                :name =&gt; \"C2\"\n            }\n        ]\n    }\n]\n</code></pre>\n"}, {"tags": ["ruby", "syntax", "generator"], "answers": [{"tags": [], "owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "is_accepted": false, "score": 2, "last_activity_date": 1473219917, "creation_date": 1473219917, "answer_id": 39360898, "question_id": 39360763, "link": "https://stackoverflow.com/questions/39360763/how-to-write-a-generator-in-ruby/39360898#39360898", "title": "How to write a generator in Ruby?", "body": "<p>It's very similar:</p>\n\n<pre><code>def integer\n  Enumerator.new do |y|\n    n = 0\n    loop do\n      y &lt;&lt; n\n      n += 1\n    end\n  end\nend\n</code></pre>\n\n<p>That can be used like this:</p>\n\n<pre><code>integer.take(20).inject(&amp;:+)\n# =&gt; 190\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 71199, "user_id": 1301972, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/T5G7N.jpg?s=128&g=1", "display_name": "Todd A. Jacobs", "link": "https://stackoverflow.com/users/1301972/todd-a-jacobs"}, "is_accepted": false, "score": 1, "last_activity_date": 1473227213, "creation_date": 1473227213, "answer_id": 39362009, "question_id": 39360763, "link": "https://stackoverflow.com/questions/39360763/how-to-write-a-generator-in-ruby/39362009#39362009", "title": "How to write a generator in Ruby?", "body": "<p>You want a <em>lazy enumerator</em>. In Ruby 2.3.1 (and at least as far back as Ruby 2.2.0), you can make one yourself by mixing in <a href=\"http://ruby-doc.org/core-2.3.1/Enumerator/Lazy.html\" rel=\"nofollow\">Enumerator::Lazy</a>.</p>\n\n<p>However, if all you want is an infinite stream of integers, you could just use a Range object. For example:</p>\n\n<pre><code>(1 .. Float::INFINITY).take 10\n#=&gt; [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]\n</code></pre>\n"}], "owner": {"reputation": 2362, "user_id": 1459901, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Uc6uH.jpg?s=128&g=1", "display_name": "Cisplatin", "link": "https://stackoverflow.com/users/1459901/cisplatin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1201, "favorite_count": 0, "closed_date": 1473228512, "answer_count": 2, "score": 0, "last_activity_date": 1473227213, "creation_date": 1473218731, "last_edit_date": 1473218778, "question_id": 39360763, "link": "https://stackoverflow.com/questions/39360763/how-to-write-a-generator-in-ruby", "closed_reason": "Duplicate", "title": "How to write a generator in Ruby?", "body": "<p>In Python, we can write something like this to generate all positive integers:</p>\n\n<pre><code>def integer():\n  count = 0\n  while True:\n    count += 1\n    yield count\n</code></pre>\n\n<p>Is there a way to write a similar generator in Ruby?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ajax", "acts-as-votable"], "answers": [{"tags": [], "owner": {"reputation": 119, "user_id": 3713090, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/01481154e9219ff8b367a44dcca5f8ca?s=128&d=identicon&r=PG", "display_name": "rcrusoe", "link": "https://stackoverflow.com/users/3713090/rcrusoe"}, "is_accepted": false, "score": 0, "last_activity_date": 1473234552, "last_edit_date": 1473234552, "creation_date": 1473216252, "answer_id": 39360484, "question_id": 39360163, "link": "https://stackoverflow.com/questions/39360163/rails-ajax-not-responding-when-respond-to-wrapped-in-if-statement/39360484#39360484", "title": "Rails - ajax not responding when respond_to wrapped in if statement", "body": "<p>Got it working. Unsurprisingly, I was making it too complicated. This works:</p>\n\n<pre><code>def like\n  @resource = Resource.find(params[:id])\n  @resource.liked_by current_user\n  respond_to do |format|\n    if session[:return_to] != nil\n      format.html { redirect_to(resources_path) }\n    end\n    format.html\n    format.js\n  end\nend\n</code></pre>\n"}], "owner": {"reputation": 119, "user_id": 3713090, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/01481154e9219ff8b367a44dcca5f8ca?s=128&d=identicon&r=PG", "display_name": "rcrusoe", "link": "https://stackoverflow.com/users/3713090/rcrusoe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 73, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1473234552, "creation_date": 1473213346, "question_id": 39360163, "link": "https://stackoverflow.com/questions/39360163/rails-ajax-not-responding-when-respond-to-wrapped-in-if-statement", "title": "Rails - ajax not responding when respond_to wrapped in if statement", "body": "<p><strong>Background:</strong> I'm using the acts_as_votable gem to log likes on a <code>Resource</code> model. I am working on splitting the behavior of the like button to accommodate (a) users who are signed in and (b) users who are not signed in.</p>\n\n<p><strong>before/after actions in the resource controller</strong></p>\n\n<pre><code>before_action :set_resource, only: [:show, :edit, :update, :destroy]\nbefore_action :save_original_path, only: [:like]\nbefore_action :require_signin!, only: [:like]\nafter_action :clear_original_path, only: [:like]\n</code></pre>\n\n<p>If the user is not signed in, and they click the like button, I store their original path --> force them to sign in --> return to their original path (liking the resource) --> and redirect them back to the resource index.</p>\n\n<p>If the user is signed in, ajax is simply used to record the vote and refresh the page.</p>\n\n<p><strong><code>like</code> action in resources_controller.rb</strong></p>\n\n<pre><code>def like\n  @resource = Resource.find(params[:id])\n  @resource.liked_by current_user\n  if session[:return_to] != nil\n    redirect_to resources_path\n  else\n    respond_to do |format|\n      format.html\n      format.js\n    end\n  end\nend\n</code></pre>\n\n<p>Something funky is happening with the if statement in the like action above. The redirect_to resources_path flow is working perfectly for users who are not signed in. The respond_to ajax call, however, is not refreshing the page. </p>\n\n<p>If I move the respond_to call out of the if statement and delete the if statement, then it works just fine.</p>\n\n<p>Any ideas?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "rspec"], "comments": [{"owner": {"reputation": 685, "user_id": 2868284, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/76f42be013abf833273224eb4eaef29c?s=128&d=identicon&r=PG", "display_name": "cenouro", "link": "https://stackoverflow.com/users/2868284/cenouro"}, "edited": false, "score": 0, "creation_date": 1473213215, "post_id": 39359944, "comment_id": 66049834, "body": "Have you taken a look at <code>config&#47;database.yml</code> and <code>db&#47;schema.rb</code>?"}, {"owner": {"reputation": 607, "user_id": 6785635, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/b3f4f269a077d438fb5a9a9297726095?s=128&d=identicon&r=PG&f=1", "display_name": "s_zhang", "link": "https://stackoverflow.com/users/6785635/s-zhang"}, "reply_to_user": {"reputation": 685, "user_id": 2868284, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/76f42be013abf833273224eb4eaef29c?s=128&d=identicon&r=PG", "display_name": "cenouro", "link": "https://stackoverflow.com/users/2868284/cenouro"}, "edited": false, "score": 0, "creation_date": 1473213725, "post_id": 39359944, "comment_id": 66049927, "body": "@cenouro Yes, after I add the app2&#39;s test database in config/database.yml and tables in db/schema.rb, the result was the same. I will add that information in the question."}, {"owner": {"reputation": 685, "user_id": 2868284, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/76f42be013abf833273224eb4eaef29c?s=128&d=identicon&r=PG", "display_name": "cenouro", "link": "https://stackoverflow.com/users/2868284/cenouro"}, "edited": false, "score": 0, "creation_date": 1473221087, "post_id": 39359944, "comment_id": 66051343, "body": "<code>schema.rb</code> should be a snapshot of your database definition after the migrations have run. In addition to modifinyg the file, you probably will have to run <code>rake db:schema:load</code> to apply the changes. Be ware that this is not recommended and will erase data on your databases."}, {"owner": {"reputation": 607, "user_id": 6785635, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/b3f4f269a077d438fb5a9a9297726095?s=128&d=identicon&r=PG&f=1", "display_name": "s_zhang", "link": "https://stackoverflow.com/users/6785635/s-zhang"}, "reply_to_user": {"reputation": 685, "user_id": 2868284, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/76f42be013abf833273224eb4eaef29c?s=128&d=identicon&r=PG", "display_name": "cenouro", "link": "https://stackoverflow.com/users/2868284/cenouro"}, "edited": false, "score": 0, "creation_date": 1473224789, "post_id": 39359944, "comment_id": 66052320, "body": "@cenouro Thank you for your answer. I want to know if it is possible to do that use rspec and the addition schemas in the schema.rb. If I use Jenkins to do CI, I can do nothing such as <code>rake db:schema:load</code>."}, {"owner": {"reputation": 685, "user_id": 2868284, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/76f42be013abf833273224eb4eaef29c?s=128&d=identicon&r=PG", "display_name": "cenouro", "link": "https://stackoverflow.com/users/2868284/cenouro"}, "edited": false, "score": 0, "creation_date": 1473228928, "post_id": 39359944, "comment_id": 66053889, "body": "It may be possible, but I think it will not be something productive. Your system(s) seems overly complex. Try redesigning them to be easy to test. Even if you decide to separete them in multiple services, you can test each one in isolation."}, {"owner": {"reputation": 607, "user_id": 6785635, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/b3f4f269a077d438fb5a9a9297726095?s=128&d=identicon&r=PG&f=1", "display_name": "s_zhang", "link": "https://stackoverflow.com/users/6785635/s-zhang"}, "reply_to_user": {"reputation": 685, "user_id": 2868284, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/76f42be013abf833273224eb4eaef29c?s=128&d=identicon&r=PG", "display_name": "cenouro", "link": "https://stackoverflow.com/users/2868284/cenouro"}, "edited": false, "score": 0, "creation_date": 1473230821, "post_id": 39359944, "comment_id": 66054862, "body": "@cenouro Thank you very much. I run this in app2: <code>rake db:migrate RAILS_ENV=test</code>. Then I can test in app1."}], "owner": {"reputation": 607, "user_id": 6785635, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/b3f4f269a077d438fb5a9a9297726095?s=128&d=identicon&r=PG&f=1", "display_name": "s_zhang", "link": "https://stackoverflow.com/users/6785635/s-zhang"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 343, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1473213962, "creation_date": 1473211208, "last_edit_date": 1473213962, "question_id": 39359944, "link": "https://stackoverflow.com/questions/39359944/how-to-test-multi-databases-with-rspec", "title": "How to test multi databases with rspec?", "body": "<p>This is a rails project. I want to use rspec to test multi operation with different databases.\nThis project name is app1. The test database is test_database1. I want to use another database in another project.\nThat project name is app2. The test database is test_database2.\nI have tried to add the database2 create_table schema to app1 project. And I used factory_girl to generate test data use \n<code>factory :product, :class =&gt; App2::Product do</code>. However, when I run the rspec test, it showed me:</p>\n\n<pre><code>Failure/Error: let(:app2_products) { create(:product) }\n\nActiveRecord::StatementInvalid:\n  Mysql2::Error: Table 'app2_test.products' doesn't exist: SHOW FULL FIELDS FROM `products`\n# ./spec/my_spec.rb:4:in `block (2 levels) in &lt;top (required)&gt;'\n# ./spec/my_spec.rb:12:in `block (3 levels) in &lt;top (required)&gt;'\n# ------------------\n# --- Caused by: ---\n# Mysql2::Error:\n#   Table 'app2_test.products' doesn't exist\n#   ./spec/my_spec.rb:4:in `block (2 levels) in &lt;top (required)&gt;'\n</code></pre>\n\n<p>How to create database2 of app2 in app1 when using spec?</p>\n\n<hr>\n\n<h2>Edit1</h2>\n\n<p>I added app2's test database in config/database.yml:</p>\n\n<pre><code>app2_test:\n  &lt;&lt;: *app2_default\n  database: app2_test\n</code></pre>\n\n<p>I also added create table schema about app2 to app1's db/schema.rb</p>\n\n<pre><code>create_table \"products\", force: :cascade do |t|\n  t.string \"name\"\nend\n</code></pre>\n\n<p>But the result was the same.</p>\n"}, {"tags": ["ruby", "lambda", "syntax", "functional-programming"], "answers": [{"comments": [{"owner": {"reputation": 167912, "user_id": 240443, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/495d675e3bc42ed1dee469e2ce701f1b?s=128&d=identicon&r=PG", "display_name": "Amadan", "link": "https://stackoverflow.com/users/240443/amadan"}, "edited": false, "score": 1, "creation_date": 1473209659, "post_id": 39359758, "comment_id": 66049237, "body": "You could also write <code>lambda do |x| if x.even? then x else 0 end end</code>. Many options in Ruby; scrub your brain clean of TIOOWTDI :P"}], "tags": [], "owner": {"reputation": 13378, "user_id": 1430810, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/v669u.jpg?s=128&g=1", "display_name": "arieljuod", "link": "https://stackoverflow.com/users/1430810/arieljuod"}, "is_accepted": false, "score": 2, "last_activity_date": 1473209348, "creation_date": 1473209348, "answer_id": 39359758, "question_id": 39359745, "link": "https://stackoverflow.com/questions/39359745/how-to-write-a-conditional-lambda-in-ruby/39359758#39359758", "title": "How to write a conditional lambda in Ruby?", "body": "<p>Ruby's ternary operator has this syntax</p>\n\n<pre><code>x % 2 == 0 ? x : 0\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "is_accepted": true, "score": 4, "last_activity_date": 1473210421, "creation_date": 1473210421, "answer_id": 39359864, "question_id": 39359745, "link": "https://stackoverflow.com/questions/39359745/how-to-write-a-conditional-lambda-in-ruby/39359864#39359864", "title": "How to write a conditional lambda in Ruby?", "body": "<p>You have several options here to express this. The long-form is this:</p>\n\n<pre><code>if (x % 2 == 0)\n  x\nelse\n  0\nend\n</code></pre>\n\n<p>Note that a trailing <code>if</code> or <code>unless</code> cannot have a secondary condition like <code>else</code>. You need to use the full form.</p>\n\n<p>If you want a short version, you use the <em>ternary operator</em>:</p>\n\n<pre><code>(x % 2 == 0) ? x : 0\n</code></pre>\n\n<p>What you could also do is this:</p>\n\n<pre><code>(x % 2 == 0) and x or 0\n</code></pre>\n\n<p>As others have observed there's a method called <a href=\"https://ruby-doc.org/core-2.3.1/Fixnum.html#method-i-even-3F\" rel=\"nofollow\"><code>even?</code></a> which does the modulo for you, so that can collapse this further:</p>\n\n<pre><code>x.even? ? x : 0\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "is_accepted": false, "score": 1, "last_activity_date": 1473219900, "creation_date": 1473219900, "answer_id": 39360895, "question_id": 39359745, "link": "https://stackoverflow.com/questions/39359745/how-to-write-a-conditional-lambda-in-ruby/39360895#39360895", "title": "How to write a conditional lambda in Ruby?", "body": "<p>You don't even need a conditional.</p>\n\n<pre><code>p = -&gt;(x) { x*(1-x%2) }\n\np.call(4) #=&gt; 4\np.call(5) #=&gt; 0\n</code></pre>\n\n<p>Note procs can be called in multiple ways:  </p>\n\n<pre><code>p[4]       #=&gt; 4\np.(4)      #=&gt; 4\np.yield(4) #=&gt; 4\np === 4    #=&gt; 4\np(4)       #=&gt; 4\n</code></pre>\n\n<p>The last of these may be archaic.</p>\n"}, {"tags": [], "owner": {"reputation": 11741, "user_id": 1934428, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/072774c5d4204a1c2385560e6114a887?s=128&d=identicon&r=PG", "display_name": "user1934428", "link": "https://stackoverflow.com/users/1934428/user1934428"}, "is_accepted": false, "score": 1, "last_activity_date": 1473228014, "creation_date": 1473228014, "answer_id": 39362196, "question_id": 39359745, "link": "https://stackoverflow.com/questions/39359745/how-to-write-a-conditional-lambda-in-ruby/39362196#39362196", "title": "How to write a conditional lambda in Ruby?", "body": "<p>Wrong syntax. You can write it like this:</p>\n\n<pre><code>even = -&gt; (x) {if x % 2 == 0; x; else; 0; end}\n</code></pre>\n\n<p>However, for such one-liners, it is more common to use the ternary ?: operator, as other have suggested in this thread.</p>\n"}, {"tags": [], "owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "is_accepted": false, "score": 0, "last_activity_date": 1473233446, "creation_date": 1473233446, "answer_id": 39363795, "question_id": 39359745, "link": "https://stackoverflow.com/questions/39359745/how-to-write-a-conditional-lambda-in-ruby/39363795#39363795", "title": "How to write a conditional lambda in Ruby?", "body": "<p>Your syntax is wrong:</p>\n\n<ul>\n<li>The <em>then</em>-block comes after the condition, not before it.</li>\n<li>The <em>then</em>-block is separated from the condition by the <code>then</code> keyword, a semicolon, or a newline.</li>\n<li>The conditional expression is terminated with an <code>end</code> keyword.</li>\n</ul>\n\n<p>So, any of the following is valid:</p>\n\n<pre><code># idiomatic:\nif x % 2 == 0 then x else 0 end\n\n# idiomatic:\nif x % 2 == 0\n  x\nelse\n  0\nend\n\n# non-idiomatic:\nif x % 2 == 0; x else 0 end\n\n# non-idiomatic:\nif x % 2 == 0 then\n  x\nelse\n  0\nend\n\n# non-idiomatic:\nif x % 2 == 0\n  x else 0 end\n\n# \u2026 and many other non-idiomatic variations\n</code></pre>\n\n<p>Ruby also has a conditional operator:</p>\n\n<pre><code>x % 2 ? x : 0\n</code></pre>\n\n<p>But I personally find it ugly and unreadable. It also has different precedence than the conditional expression, which may be surprising to some. (Witness the myriad of variations of the same question about the conditional operator here on StackOverflow.) And it is completely unnecessary: in C, where <code>if</code> is a conditional statement, the conditional operator is required because it is an expression. In Ruby, everything is an expression anyway, there are no statements, so of course <code>if</code> is an expression, too.</p>\n"}], "owner": {"reputation": 2362, "user_id": 1459901, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Uc6uH.jpg?s=128&g=1", "display_name": "Cisplatin", "link": "https://stackoverflow.com/users/1459901/cisplatin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1720, "favorite_count": 0, "accepted_answer_id": 39359864, "answer_count": 5, "score": 1, "last_activity_date": 1473233446, "creation_date": 1473209207, "question_id": 39359745, "link": "https://stackoverflow.com/questions/39359745/how-to-write-a-conditional-lambda-in-ruby", "title": "How to write a conditional lambda in Ruby?", "body": "<p>I'd like to write a conditional lambda in Ruby. The Python equivalent of what I'd like to write is:</p>\n\n<pre><code>even = (lambda x: x if x % 2 == 0 else 0)\n</code></pre>\n\n<p>My attempt to write this in Ruby looks like:</p>\n\n<pre><code>even = -&gt; (x) {x if x % 2 == 0 else 0}\n</code></pre>\n\n<p>Unfortunately, that does not work. Is there any way to fix this?</p>\n"}, {"tags": ["arrays", "ruby", "multidimensional-array"], "comments": [{"owner": {"reputation": 9786, "user_id": 485864, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f34b46a9a4723bdbc6e1fdcf71b08517?s=128&d=identicon&r=PG", "display_name": "vgoff", "link": "https://stackoverflow.com/users/485864/vgoff"}, "edited": false, "score": 1, "creation_date": 1473206716, "post_id": 39359468, "comment_id": 66048653, "body": "What have you tried so far? <a href=\"http://stackoverflow.com/questions/1538789/how-to-sum-array-of-numbers-in-ruby?rq=1\">&quot;How to sum array of numbers in Ruby?&quot;</a> may be helpful, with a little <code>flatten</code> action."}, {"owner": {"reputation": 594, "user_id": 2991331, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/a697526edb47067115f3467a11ab1121?s=128&d=identicon&r=PG&f=1", "display_name": "slopeofhope", "link": "https://stackoverflow.com/users/2991331/slopeofhope"}, "edited": false, "score": 0, "creation_date": 1473208234, "post_id": 39359468, "comment_id": 66048978, "body": "I would use reduce function for this sort of thing because you wanna get a single value at the end. Read up on reduce function which is a must know when it comes funxtional programming."}], "answers": [{"tags": [], "owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "is_accepted": true, "score": 0, "last_activity_date": 1473207067, "creation_date": 1473207067, "answer_id": 39359530, "question_id": 39359468, "link": "https://stackoverflow.com/questions/39359468/how-to-find-the-sum-of-a-multidimensional-array/39359530#39359530", "title": "How to find the sum of a multidimensional array", "body": "<p>Could be as simple as this:</p>\n\n<pre><code>stairs.flatten.inject(0, &amp;:+)\n</code></pre>\n"}], "owner": {"reputation": 167, "user_id": 6758433, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/10154048264753472/picture?type=large", "display_name": "Jack Kelly", "link": "https://stackoverflow.com/users/6758433/jack-kelly"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 168, "favorite_count": 0, "closed_date": 1473207071, "accepted_answer_id": 39359530, "answer_count": 1, "score": 0, "last_activity_date": 1473207067, "creation_date": 1473206581, "last_edit_date": 1473206829, "question_id": 39359468, "link": "https://stackoverflow.com/questions/39359468/how-to-find-the-sum-of-a-multidimensional-array", "closed_reason": "Duplicate", "title": "How to find the sum of a multidimensional array", "body": "<p>I've been looking for the answer to this. Maybe I haven't looked hard enough. This question has stumped me.</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>stairs = [[sunday],[monday],[tuesday],[wednesday],[thursday],[friday],[saturday]]\n\nsunday = [6737, 7244, 5776, 9826, 7057, 9247, 5842, 5484, 6543, 5153, 6832, 8274, 7148, 6152, 5940, 8040, 9174, 7555, 7682, 5252, 8793, 8837, 7320, 8478, 6063, 5751, 9716, 5085, 7315, 7859, 6628, 5425, 6331, 7097, 6249, 8381, 5936, 8496, 6934, 8347, 7036, 6421, 6510, 5821, 8602, 5312, 7836, 8032, 9871, 5990, 6309, 7825]\n</code></pre>\n\n<p>each day has their own set of values. How do I find the sum of all the values within the array? I apologize if this has already been asked. I am a beginner and I'm finding it difficult just searching for answers to my questions. </p>\n"}, {"tags": ["ruby-on-rails", "ruby", "activerecord"], "comments": [{"owner": {"reputation": 1344, "user_id": 1150876, "user_type": "registered", "accept_rate": 31, "profile_image": "https://www.gravatar.com/avatar/84bdd2a52f2f327c8397a25d2182ec60?s=128&d=identicon&r=PG&f=1", "display_name": "Guy Dubrovski", "link": "https://stackoverflow.com/users/1150876/guy-dubrovski"}, "edited": false, "score": 2, "creation_date": 1474355813, "post_id": 39359361, "comment_id": 66485148, "body": "Can you attach the SQL log for both of these calls?"}, {"owner": {"reputation": 48635, "user_id": 6742, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/xPawo.png?s=128&g=1", "display_name": "David Aldridge", "link": "https://stackoverflow.com/users/6742/david-aldridge"}, "edited": false, "score": 1, "creation_date": 1474878678, "post_id": 39359361, "comment_id": 66694513, "body": "This is not necessarily relevant, and is really just anecdotal, but personally I&#39;ve become very disenchanted with applying orders, and in some cases where clauses, on associations. The order by does not get applied in some cases, on &quot;has_many through&quot; if memory serves, and I&#39;ve found too many cases where I had to revert to a simple association in order to get eager loading to work the way I wanted. So in your case I would have a simple avatars association, and then an instance method to provide a sorted list."}, {"owner": {"reputation": 3785, "user_id": 839925, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dfa54eccd89d7c0d2225e0ca279c1191?s=128&d=identicon&r=PG", "display_name": "Alexandre Angelim", "link": "https://stackoverflow.com/users/839925/alexandre-angelim"}, "edited": false, "score": 1, "creation_date": 1475367204, "post_id": 39359361, "comment_id": 66916541, "body": "That&#39;s an interesting problem. Excellent question! I just think it&#39;d be better to rephrase the title after confirming the cause. Ignoring scopes when pre-caching with <code>:includes</code> seems like a bug."}], "answers": [{"comments": [{"owner": {"reputation": 1335, "user_id": 2248638, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6e4a873186ddd8d431004b6f82dbb721?s=128&d=identicon&r=PG", "display_name": "skensell", "link": "https://stackoverflow.com/users/2248638/skensell"}, "edited": false, "score": 0, "creation_date": 1473240126, "post_id": 39362959, "comment_id": 66060405, "body": "The <code>user</code> returned from <code>first</code> is the same in both cases. It&#39;s just the <code>avatar</code>s which are in the wrong order."}], "tags": [], "owner": {"reputation": 2294, "user_id": 2245697, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/931e42fa59a041551b7f63e703ea909a?s=128&d=identicon&r=PG&f=1", "display_name": "Tan", "link": "https://stackoverflow.com/users/2245697/tan"}, "is_accepted": false, "score": 1, "last_activity_date": 1473230907, "creation_date": 1473230907, "answer_id": 39362959, "question_id": 39359361, "link": "https://stackoverflow.com/questions/39359361/rails-ignores-association-scope-when-pre-caching-with-includes/39362959#39362959", "title": "Rails ignores association scope when pre-caching with includes", "body": "<p>Because those things are different</p>\n\n<pre><code># returns a user which has smallest id (@users are ordered by id)\n@users.first # User::ActiveRecord_Relation#first\n\n# is different to\n# returns a first user which fetched from database (@users are unordered)\n@users.to_a.first # Array#first\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1335, "user_id": 2248638, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6e4a873186ddd8d431004b6f82dbb721?s=128&d=identicon&r=PG", "display_name": "skensell", "link": "https://stackoverflow.com/users/2248638/skensell"}, "edited": false, "score": 0, "creation_date": 1474741723, "post_id": 39662534, "comment_id": 66659547, "body": "But you&#39;re talking about an ordering on <code>User</code> while the ordering in question is that of the has_many association <code>avatars</code>, which at the beginning of the question I showed is supposed to be ordered by <code>sort_order</code> and <code>created_at</code> (because of the scope)."}, {"owner": {"reputation": 4875, "user_id": 3098330, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/7GLfA.jpg?s=128&g=1", "display_name": "Gupta", "link": "https://stackoverflow.com/users/3098330/gupta"}, "reply_to_user": {"reputation": 1335, "user_id": 2248638, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6e4a873186ddd8d431004b6f82dbb721?s=128&d=identicon&r=PG", "display_name": "skensell", "link": "https://stackoverflow.com/users/2248638/skensell"}, "edited": false, "score": 0, "creation_date": 1474746127, "post_id": 39662534, "comment_id": 66660851, "body": "At first It fetch the records by using <code>scope</code> and later on order by <code>updated_at</code> (on using <code>#to_a</code>)."}, {"owner": {"reputation": 1335, "user_id": 2248638, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6e4a873186ddd8d431004b6f82dbb721?s=128&d=identicon&r=PG", "display_name": "skensell", "link": "https://stackoverflow.com/users/2248638/skensell"}, "edited": false, "score": 0, "creation_date": 1474837367, "post_id": 39662534, "comment_id": 66682880, "body": "I&#39;m still not convinced. Here&#39;s a counter-example: <code>&gt;&gt; User.where(id: 945).to_a.first.avatars[0..2].map(&amp;:id)   User Load (6.0ms)  SELECT &quot;users&quot;.* FROM &quot;users&quot;  WHERE &quot;users&quot;.&quot;id&quot; = 945   Avatar Load (0.2ms)  SELECT &quot;avatars&quot;.* FROM &quot;avatars&quot;  WHERE &quot;avatars&quot;.&quot;user_id&quot; = $1  ORDER BY &quot;avatars&quot;.&quot;sort_order&quot; ASC, &quot;avatars&quot;.&quot;created_at&quot; ASC  [[&quot;user_id&quot;, 945]] =&gt; [2748, 2749, 2751]</code>  which is the correct ordering (you can see it explicitly ordering). However, by your logic these would be sorted by updated_at, which is not the case."}, {"owner": {"reputation": 1335, "user_id": 2248638, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6e4a873186ddd8d431004b6f82dbb721?s=128&d=identicon&r=PG", "display_name": "skensell", "link": "https://stackoverflow.com/users/2248638/skensell"}, "edited": false, "score": 0, "creation_date": 1474837529, "post_id": 39662534, "comment_id": 66682926, "body": "I mentioned that the includes/references has to be the issue, but I didn&#39;t explain why. The example in the previous comment shows that without the includes(industries...)...references(industries), everythign works fine.  I didn&#39;t want to do this, but I will probably make an example application and share it."}, {"owner": {"reputation": 1335, "user_id": 2248638, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6e4a873186ddd8d431004b6f82dbb721?s=128&d=identicon&r=PG", "display_name": "skensell", "link": "https://stackoverflow.com/users/2248638/skensell"}, "edited": false, "score": 0, "creation_date": 1474843506, "post_id": 39662534, "comment_id": 66684294, "body": "I&#39;ve added a sample app. Please check it out and let me know what I&#39;m not understanding."}], "tags": [], "owner": {"reputation": 4875, "user_id": 3098330, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/7GLfA.jpg?s=128&g=1", "display_name": "Gupta", "link": "https://stackoverflow.com/users/3098330/gupta"}, "is_accepted": false, "score": 4, "last_activity_date": 1474737585, "last_edit_date": 1474737585, "creation_date": 1474638772, "answer_id": 39662534, "question_id": 39359361, "link": "https://stackoverflow.com/questions/39359361/rails-ignores-association-scope-when-pre-caching-with-includes/39662534#39662534", "title": "Rails ignores association scope when pre-caching with includes", "body": "<pre><code>@users.first.avatars[0..2].map(&amp;:id)\n# =&gt; [2546, 2547, 2548]\n\n@users.to_a.first.avatars[0..2].map(&amp;:id)\n# =&gt; [2548, 2546, 2547]\n</code></pre>\n\n<blockquote>\n  <ul>\n  <li>What is going on here?</li>\n  </ul>\n</blockquote>\n\n<p>There is nothing wrong. </p>\n\n<p>As per the <a href=\"http://guides.rubyonrails.org/active_record_querying.html#retrieving-a-single-object\" rel=\"noreferrer\">Guide Retrieving a Single Object Section: 1.1.3 <strong>#first</strong></a> </p>\n\n<blockquote>\n  <p>The first method finds the first record ordered by primary key\n  (default)</p>\n</blockquote>\n\n<pre><code>SELECT * FROM clients ORDER BY clients.id ASC LIMIT 1\n</code></pre>\n\n<p>And the next methods which return as a collection <code>@users.to_a</code> <strong>order by</strong> <code>updated_at</code> </p>\n\n<p>Hope this help you!</p>\n"}, {"comments": [{"owner": {"reputation": 1335, "user_id": 2248638, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6e4a873186ddd8d431004b6f82dbb721?s=128&d=identicon&r=PG", "display_name": "skensell", "link": "https://stackoverflow.com/users/2248638/skensell"}, "edited": false, "score": 0, "creation_date": 1474883766, "post_id": 39698858, "comment_id": 66697788, "body": "If you&#39;re right, then it&#39;s a bug in rails.  The whole point of the <code>includes</code> is to preload the <code>avatars</code>. Preloading works fine without the filter on <code>industries</code>. So the question is &quot;Why does the filter on industries mess up the preloading?&quot;."}, {"owner": {"reputation": 994, "user_id": 1634212, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7401d4ff8cf377861b6364af6573297b?s=128&d=identicon&r=PG", "display_name": "xuanduc987", "link": "https://stackoverflow.com/users/1634212/xuanduc987"}, "reply_to_user": {"reputation": 1335, "user_id": 2248638, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6e4a873186ddd8d431004b6f82dbb721?s=128&d=identicon&r=PG", "display_name": "skensell", "link": "https://stackoverflow.com/users/2248638/skensell"}, "edited": false, "score": 1, "creation_date": 1474891773, "post_id": 39698858, "comment_id": 66703008, "body": "The thing is, I don&#39;t think rails could construct a SQL statement for user model preloading avatars while keeping correct order in this association scope. I don&#39;t think I could manually write a SQL statement like that either.  To workaround, I propose define a <code>sorted</code> scope on <code>Avatar</code> model, <code>scope :sorted, -&gt;{order...}</code> and call <code>Users.where(...).second.avatars.sorted</code>"}], "tags": [], "owner": {"reputation": 994, "user_id": 1634212, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7401d4ff8cf377861b6364af6573297b?s=128&d=identicon&r=PG", "display_name": "xuanduc987", "link": "https://stackoverflow.com/users/1634212/xuanduc987"}, "is_accepted": false, "score": 1, "last_activity_date": 1474881197, "creation_date": 1474881197, "answer_id": 39698858, "question_id": 39359361, "link": "https://stackoverflow.com/questions/39359361/rails-ignores-association-scope-when-pre-caching-with-includes/39698858#39698858", "title": "Rails ignores association scope when pre-caching with includes", "body": "<p>IMHO, when you preloading, the order information in <code>avatars</code> association relation scope can't be used (because the \"objects\" to return are <code>User</code>, not <code>Avatar</code>). From SQL log, we can see that it's just join query without order on <code>avatars</code> fields.</p>\n\n<p>In the case you don't use <code>.to_a</code>, the returned array is in ascending order, just so happened to be the correct order.</p>\n"}, {"comments": [{"owner": {"reputation": 1335, "user_id": 2248638, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6e4a873186ddd8d431004b6f82dbb721?s=128&d=identicon&r=PG", "display_name": "skensell", "link": "https://stackoverflow.com/users/2248638/skensell"}, "edited": false, "score": 0, "creation_date": 1475483884, "post_id": 39812577, "comment_id": 66944847, "body": "The <code>includes(:avatars)</code> is only part of the problem. <code>User.includes(:avatars).first.avatars.pluck(:id) # =&gt; [1, 3, 2] the correct order</code>. It&#39;s the industries filter which is messing with something."}, {"owner": {"reputation": 1335, "user_id": 2248638, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6e4a873186ddd8d431004b6f82dbb721?s=128&d=identicon&r=PG", "display_name": "skensell", "link": "https://stackoverflow.com/users/2248638/skensell"}, "edited": false, "score": 0, "creation_date": 1475484507, "post_id": 39812577, "comment_id": 66945192, "body": "Also, I think ordering by <code>avatars.sort_order asc</code> would tamper with the order of <code>User</code> instead of the ordering of <code>Avatar</code>."}, {"owner": {"reputation": 1335, "user_id": 2248638, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6e4a873186ddd8d431004b6f82dbb721?s=128&d=identicon&r=PG", "display_name": "skensell", "link": "https://stackoverflow.com/users/2248638/skensell"}, "edited": false, "score": 0, "creation_date": 1475486692, "post_id": 39812577, "comment_id": 66946498, "body": "Bounty awarded to this answer not because it&#39;s correct, but because there are no other correct answers and I do not want to give the highest-voted answerer another bounty for an answer I consider insufficient."}, {"owner": {"reputation": 3785, "user_id": 839925, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dfa54eccd89d7c0d2225e0ca279c1191?s=128&d=identicon&r=PG", "display_name": "Alexandre Angelim", "link": "https://stackoverflow.com/users/839925/alexandre-angelim"}, "reply_to_user": {"reputation": 1335, "user_id": 2248638, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6e4a873186ddd8d431004b6f82dbb721?s=128&d=identicon&r=PG", "display_name": "skensell", "link": "https://stackoverflow.com/users/2248638/skensell"}, "edited": false, "score": 0, "creation_date": 1475504301, "post_id": 39812577, "comment_id": 66957007, "body": "@skensell This snippet returned the avatars in the correct order. The side effects to the users order wasn&#39;t tested because the test case only had one, but you can also force user order before ordering the avatars. The order clause will be used in both queries."}], "tags": [], "owner": {"reputation": 3785, "user_id": 839925, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dfa54eccd89d7c0d2225e0ca279c1191?s=128&d=identicon&r=PG", "display_name": "Alexandre Angelim", "link": "https://stackoverflow.com/users/839925/alexandre-angelim"}, "is_accepted": false, "score": 0, "last_activity_date": 1475504713, "last_edit_date": 1475504713, "creation_date": 1475365795, "answer_id": 39812577, "question_id": 39359361, "link": "https://stackoverflow.com/questions/39359361/rails-ignores-association-scope-when-pre-caching-with-includes/39812577#39812577", "title": "Rails ignores association scope when pre-caching with includes", "body": "<p>The problem stems from including the avatars in your query. That will pull out the avatars in their natural order(id) and the <code>:avatars</code> scope won't be called as each user on the response will already have <code>#avatars</code> bound to them.</p>\n\n<p>I'm afraid you'll have to reinforce the avatars order while building your query: </p>\n\n<pre><code>relation = User.includes(:industries,:avatars)\n.where(industries: {id: [1]}).references(:industries)\n.order(\"users.id asc, avatars.sort_order asc, avatars.created_at asc\")\n\navatars = relation.first.avatars\n</code></pre>\n\n<h3>Update</h3>\n\n<p>To test the side effects on users order, use your initial test case and add another user within the same industry, then add an avatar with <code>sort_order:-1</code>.\n<code>relation.pluck(:id)</code> will return <code>[1,1,1,2]</code>, so user order is preserved.</p>\n"}, {"comments": [{"owner": {"reputation": 1335, "user_id": 2248638, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6e4a873186ddd8d431004b6f82dbb721?s=128&d=identicon&r=PG", "display_name": "skensell", "link": "https://stackoverflow.com/users/2248638/skensell"}, "edited": false, "score": 0, "creation_date": 1475485221, "post_id": 39817700, "comment_id": 66945578, "body": "&quot;However, it is not using the sort order you have mentioned in the avatar model while lazy loading the data&quot; -&gt; Why not? This must be a bug.  I&#39;m also confused by your explanation because it seems that <code>User.includes(:avatars).first.avatars.pluck(:id) # =&gt; [1, 3, 2] the correct order</code> would fall under Case 2, but it works as expected."}, {"owner": {"reputation": 86, "user_id": 4180908, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/1842f4a802c597380bc979f8f6541b54?s=128&d=identicon&r=PG&f=1", "display_name": "Hari Shankar", "link": "https://stackoverflow.com/users/4180908/hari-shankar"}, "reply_to_user": {"reputation": 1335, "user_id": 2248638, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6e4a873186ddd8d431004b6f82dbb721?s=128&d=identicon&r=PG", "display_name": "skensell", "link": "https://stackoverflow.com/users/2248638/skensell"}, "edited": false, "score": 0, "creation_date": 1475493562, "post_id": 39817700, "comment_id": 66950264, "body": "You are loading the User and not avatars as primary resource so sort order for User is getting applied and not the sort order of avatar."}], "tags": [], "owner": {"reputation": 86, "user_id": 4180908, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/1842f4a802c597380bc979f8f6541b54?s=128&d=identicon&r=PG&f=1", "display_name": "Hari Shankar", "link": "https://stackoverflow.com/users/4180908/hari-shankar"}, "is_accepted": false, "score": 0, "last_activity_date": 1475416376, "creation_date": 1475416376, "answer_id": 39817700, "question_id": 39359361, "link": "https://stackoverflow.com/questions/39359361/rails-ignores-association-scope-when-pre-caching-with-includes/39817700#39817700", "title": "Rails ignores association scope when pre-caching with includes", "body": "<p>The prime difference between the two cases is <code>lazy loading</code> of data using <code>includes</code>.</p>\n\n<p>Case 1</p>\n\n<pre><code>u = User.first\nu.avatars.pluck(:id)\n=&gt; [1, 3, 2]\n</code></pre>\n\n<p>In this case, the sql query hit is </p>\n\n<pre><code>SELECT \"avatars\".\"id\" FROM \"avatars\"  WHERE \"avatars\".\"user_id\" = ?  ORDER BY \"avatars\".\"sort_order\" ASC, \"avatars\".\"created_at\" ASC  [[\"user_id\", 1]]\n</code></pre>\n\n<p>since you have not lazy loaded the <code>avatar</code> data here, when you try to fetch the avatar data, it hits the db and uses the sort order which you have mentioned it the model.\nAs you can see, the <code>order by</code> here is the one you mentioned in your scope.</p>\n\n<p>Case 2</p>\n\n<pre><code>User.includes(:avatars, :industries).where(industries: {id: [1]}).references(:industries).first.avatars.map(&amp;:id)\n=&gt; [1, 2, 3]\n</code></pre>\n\n<p>In this case, the sql query hit is </p>\n\n<pre><code>SELECT \"users\".\"id\" AS t0_r0, \"users\".\"name\" AS t0_r1, \"users\".\"created_at\" AS t0_r2, \"users\".\"updated_at\" AS t0_r3, \"avatars\".\"id\" AS t1_r0, \"avatars\".\"user_id\" AS t1_r1, \"avatars\".\"sort_order\" AS t1_r2, \"avatars\".\"created_at\" AS t1_r3, \"avatars\".\"updated_at\" AS t1_r4, \"industries\".\"id\" AS t2_r0, \"industries\".\"name\" AS t2_r1, \"industries\".\"created_at\" AS t2_r2, \"industries\".\"updated_at\" AS t2_r3 FROM \"users\" LEFT OUTER JOIN \"avatars\" ON \"avatars\".\"user_id\" = \"users\".\"id\" LEFT OUTER JOIN \"user_industries\" ON \"user_industries\".\"user_id\" = \"users\".\"id\" LEFT OUTER JOIN \"industries\" ON \"industries\".\"id\" = \"user_industries\".\"industry_id\" WHERE \"industries\".\"id\" IN (1) AND \"users\".\"id\" IN (1)  ORDER BY \"users\".\"id\" ASC\n</code></pre>\n\n<p>As you used the <code>includes</code> in above query, it is lazy loading the avatars and industires. However, it is not using the sort order you have mentioned in the avatar model while lazy loading the data, thus MySql is defaulting to <code>id</code> as sort order which gives (1,2,3)</p>\n\n<p>In this case, since avatar data has already been lazy loaded, when you are running <code>first.avatars</code>, it is not hitting the DB again to fetch the <code>avatar</code> data and simply printing the data from lazy loaded values which is <code>[1,2,3]</code></p>\n"}, {"tags": [], "owner": {"reputation": 1335, "user_id": 2248638, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6e4a873186ddd8d431004b6f82dbb721?s=128&d=identicon&r=PG", "display_name": "skensell", "link": "https://stackoverflow.com/users/2248638/skensell"}, "is_accepted": false, "score": 1, "last_activity_date": 1475486583, "creation_date": 1475486583, "answer_id": 39828293, "question_id": 39359361, "link": "https://stackoverflow.com/questions/39359361/rails-ignores-association-scope-when-pre-caching-with-includes/39828293#39828293", "title": "Rails ignores association scope when pre-caching with includes", "body": "<p>After 2 bounties, I have yet to receive a satisfying answer, so I've concluded it's just a Rails bug and I've created <a href=\"https://github.com/rails/rails/issues/26692\" rel=\"nofollow\">an issue</a> in the Rails repo on Github.</p>\n\n<p>I'm posting a workaround here so others can solve their issue with a little copy-paste.</p>\n\n<pre><code># in user.rb\n\nhas_many :avatars, -&gt; { order([:sort_order =&gt; :asc,:created_at =&gt; :asc])},  dependent: :destroy\ndef sorted_avatars\n  # sometimes the avatars scope is ignored when eagerly loaded with includes\n  avatars.to_a.sort do |a1,a2|\n    comp = (a1.sort_order &lt;=&gt; a2.sort_order)\n    comp.zero? ? (a1.created_at &lt;=&gt; a2.created_at) : comp\n  end\nend\n</code></pre>\n\n<p>I will award this second bounty to Alexandre simply because his comment of changing the title of this question is more valuable to me than the current highest-voted answer.</p>\n"}, {"comments": [{"owner": {"reputation": 1335, "user_id": 2248638, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6e4a873186ddd8d431004b6f82dbb721?s=128&d=identicon&r=PG", "display_name": "skensell", "link": "https://stackoverflow.com/users/2248638/skensell"}, "edited": false, "score": 0, "creation_date": 1475576098, "post_id": 39846514, "comment_id": 66987361, "body": "Thanks, this is by far the most helpful answer so far.  Can you explain this a little better: &quot;Includes considers the order...only when it results in a join query&quot;? Do you mean only when it results in an INNER join query?  Because the query you can see on the README of the sample app is a LEFT OUTER JOIN and the order of avatars is disregarded.  And every query in your console log is an INNER JOIN."}, {"owner": {"reputation": 1335, "user_id": 2248638, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6e4a873186ddd8d431004b6f82dbb721?s=128&d=identicon&r=PG", "display_name": "skensell", "link": "https://stackoverflow.com/users/2248638/skensell"}, "edited": false, "score": 0, "creation_date": 1475589857, "post_id": 39846514, "comment_id": 66996552, "body": "Thank you very much for the detail!  I just wish I could have given you one of the bounties :-/"}, {"owner": {"reputation": 6227, "user_id": 808533, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/qSPq0.jpg?s=128&g=1", "display_name": "prasad.surase", "link": "https://stackoverflow.com/users/808533/prasad-surase"}, "reply_to_user": {"reputation": 1335, "user_id": 2248638, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6e4a873186ddd8d431004b6f82dbb721?s=128&d=identicon&r=PG", "display_name": "skensell", "link": "https://stackoverflow.com/users/2248638/skensell"}, "edited": false, "score": 1, "creation_date": 1475603706, "post_id": 39846514, "comment_id": 67005482, "body": "@skensell It&#39;s fine and am glad that it helped. I came here after seeing the rails issue."}], "tags": [], "owner": {"reputation": 6227, "user_id": 808533, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/qSPq0.jpg?s=128&g=1", "display_name": "prasad.surase", "link": "https://stackoverflow.com/users/808533/prasad-surase"}, "is_accepted": true, "score": 2, "last_activity_date": 1475579747, "last_edit_date": 1475579747, "creation_date": 1475566004, "answer_id": 39846514, "question_id": 39359361, "link": "https://stackoverflow.com/questions/39359361/rails-ignores-association-scope-when-pre-caching-with-includes/39846514#39846514", "title": "Rails ignores association scope when pre-caching with includes", "body": "<p>Includes considers the order of the parent table whose records are going to be retrieved only when it results in a join query. ie in the above case, the avatars order is going to be skipped and the users order is going to be used when the includes query results in a join. You can add a default scope to User and confirm.</p>\n\n<p>If you still want the user.avatars to be sorted as per the defined avatar orders, you need to replace includes with joins. Note that using join will retrieve duplicate user records.</p>\n\n<p>A working solution to retrieve data as expected is to use joins and includes together.</p>\n\n<pre><code>Loading development environment (Rails 4.1.4)\n2.2.0 :001 &gt; User.count\n(0.1ms)  SELECT COUNT(*) FROM \"users\"\n=&gt; 2 \n2.2.0 :002 &gt; User.pluck :id, :name\n(0.2ms)  SELECT \"users\".\"id\", \"users\".\"name\" FROM \"users\"\n=&gt; [[1, \"John\"], [2, \"Jill\"]] \n2.2.0 :003 &gt; User.first.industries.pluck :id, :name\nUser Load (0.2ms)  SELECT  \"users\".* FROM \"users\"   ORDER BY \"users\".\"id\" ASC LIMIT 1\n(0.2ms)  SELECT \"industries\".\"id\", \"industries\".\"name\" FROM \"industries\" INNER JOIN \"user_industries\" ON \"industries\".\"id\" = \"user_industries\".\"industry_id\" WHERE \"user_industries\".\"user_id\" = ?  [[\"user_id\", 1]]\n=&gt; [[1, \"Art\"], [2, \"Music\"]] \n2.2.0 :004 &gt; User.last.industries.pluck :id, :name\nUser Load (1.4ms)  SELECT  \"users\".* FROM \"users\"   ORDER BY \"users\".\"id\" DESC LIMIT 1\n(0.2ms)  SELECT \"industries\".\"id\", \"industries\".\"name\" FROM \"industries\" INNER JOIN \"user_industries\" ON \"industries\".\"id\" = \"user_industries\".\"industry_id\" WHERE \"user_industries\".\"user_id\" = ?  [[\"user_id\", 2]]\n=&gt; [[1, \"Art\"]] \n2.2.0 :005 &gt; User.first.avatars.pluck :id, :sort_order\nUser Load (0.4ms)  SELECT  \"users\".* FROM \"users\"   ORDER BY \"users\".\"id\" ASC LIMIT 1\n(0.3ms)  SELECT \"avatars\".\"id\", \"avatars\".\"sort_order\" FROM \"avatars\"  WHERE \"avatars\".\"user_id\" = ?  ORDER BY \"avatars\".\"sort_order\" ASC, \"avatars\".\"created_at\" ASC  [[\"user_id\", 1]]\n=&gt; [[1, 0], [3, 1], [2, 2]] \n2.2.0 :006 &gt; User.last.avatars.pluck :id, :sort_order\nUser Load (4.1ms)  SELECT  \"users\".* FROM \"users\"   ORDER BY \"users\".\"id\" DESC LIMIT 1\n(0.2ms)  SELECT \"avatars\".\"id\", \"avatars\".\"sort_order\" FROM \"avatars\"  WHERE \"avatars\".\"user_id\" = ?  ORDER BY \"avatars\".\"sort_order\" ASC, \"avatars\".\"created_at\" ASC  [[\"user_id\", 2]]\n=&gt; [[4, 5], [6, 6], [5, 7]] \n2.2.0 :007 &gt; ap User.joins(:avatars, :industries).where(industries: {id: [1]}).references(:industries).count\n(0.2ms)  SELECT COUNT(*) FROM \"users\" INNER JOIN \"avatars\" ON \"avatars\".\"user_id\" = \"users\".\"id\" INNER JOIN \"user_industries\" ON \"user_industries\".\"user_id\" = \"users\".\"id\" INNER JOIN \"industries\" ON \"industries\".\"id\" = \"user_industries\".\"industry_id\" WHERE \"industries\".\"id\" IN (1)\n6\n=&gt; nil \n2.2.0 :008 &gt; ap User.joins(:avatars, :industries).where(industries: {id: [1]}).references(:industries).uniq.count\n(0.3ms)  SELECT DISTINCT COUNT(DISTINCT \"users\".\"id\") FROM \"users\" INNER JOIN \"avatars\" ON \"avatars\".\"user_id\" = \"users\".\"id\" INNER JOIN \"user_industries\" ON \"user_industries\".\"user_id\" = \"users\".\"id\" INNER JOIN \"industries\" ON \"industries\".\"id\" = \"user_industries\".\"industry_id\" WHERE \"industries\".\"id\" IN (1)\n2\n=&gt; nil \n2.2.0 :009 &gt; ap User.joins(:industries).where(industries: {id: [1]}).references(:industries).count\n(0.3ms)  SELECT COUNT(*) FROM \"users\" INNER JOIN \"user_industries\" ON \"user_industries\".\"user_id\" = \"users\".\"id\" INNER JOIN \"industries\" ON \"industries\".\"id\" = \"user_industries\".\"industry_id\" WHERE \"industries\".\"id\" IN (1)\n2\n=&gt; nil \n 2.2.0 :010 &gt; User.joins(:industries).where(industries: {id: [1]}).references(:industries).each{|user| ap user.avatars }\nUser Load (0.3ms)  SELECT \"users\".* FROM \"users\" INNER JOIN \"user_industries\" ON \"user_industries\".\"user_id\" = \"users\".\"id\" INNER JOIN \"industries\" ON \"industries\".\"id\" = \"user_industries\".\"industry_id\" WHERE \"industries\".\"id\" IN (1)\nAvatar Load (0.2ms)  SELECT \"avatars\".* FROM \"avatars\"  WHERE \"avatars\".\"user_id\" = ?  ORDER BY \"avatars\".\"sort_order\" ASC, \"avatars\".\"created_at\" ASC  [[\"user_id\", 1]]\n[\n  [0] #&lt;Avatar:0x007ff03f8ab448&gt; {\n            :id =&gt; 1,\n       :user_id =&gt; 1,\n    :sort_order =&gt; 0,\n    :created_at =&gt; Tue, 04 Oct 2016 07:05:36 UTC +00:00,\n    :updated_at =&gt; Tue, 04 Oct 2016 07:05:44 UTC +00:00\n},\n[1] #&lt;Avatar:0x007ff03ec7e4e0&gt; {\n            :id =&gt; 3,\n       :user_id =&gt; 1,\n    :sort_order =&gt; 1,\n    :created_at =&gt; Tue, 04 Oct 2016 07:05:40 UTC +00:00,\n    :updated_at =&gt; Tue, 04 Oct 2016 07:05:40 UTC +00:00\n},\n[2] #&lt;Avatar:0x007ff03ec7e2d8&gt; {\n            :id =&gt; 2,\n       :user_id =&gt; 1,\n    :sort_order =&gt; 2,\n    :created_at =&gt; Tue, 04 Oct 2016 07:05:38 UTC +00:00,\n    :updated_at =&gt; Tue, 04 Oct 2016 07:05:42 UTC +00:00\n}\n]\nAvatar Load (0.2ms)  SELECT \"avatars\".* FROM \"avatars\"  WHERE \"avatars\".\"user_id\" = ?  ORDER BY \"avatars\".\"sort_order\" ASC, \"avatars\".\"created_at\" ASC  [[\"user_id\", 2]]\n[\n  [0] #&lt;Avatar:0x007ff03f9121e8&gt; {\n            :id =&gt; 4,\n       :user_id =&gt; 2,\n    :sort_order =&gt; 5,\n    :created_at =&gt; Tue, 04 Oct 2016 07:05:44 UTC +00:00,\n    :updated_at =&gt; Tue, 04 Oct 2016 07:05:48 UTC +00:00\n},\n[1] #&lt;Avatar:0x007ff03f911fe0&gt; {\n            :id =&gt; 6,\n       :user_id =&gt; 2,\n    :sort_order =&gt; 6,\n    :created_at =&gt; Tue, 04 Oct 2016 07:05:48 UTC +00:00,\n    :updated_at =&gt; Tue, 04 Oct 2016 07:05:48 UTC +00:00\n},\n[2] #&lt;Avatar:0x007ff03f911dd8&gt; {\n            :id =&gt; 5,\n       :user_id =&gt; 2,\n    :sort_order =&gt; 7,\n    :created_at =&gt; Tue, 04 Oct 2016 07:05:46 UTC +00:00,\n    :updated_at =&gt; Tue, 04 Oct 2016 07:05:48 UTC +00:00\n}\n]\n=&gt; [#&lt;User id: 1, name: \"John\", created_at: \"2016-10-04 07:05:40\", updated_at: \"2016-10-04 07:05:40\"&gt;, #&lt;User id: 2, name: \"Jill\", created_at: \"2016-10-04 07:05:48\", updated_at: \"2016-10-04 07:05:48\"&gt;] \n2.2.0 :011 &gt; User.joins(:industries).where(industries: {id: [1]}).references(:industries).includes(:avatars).each{|user| ap user.avatars }\n\nUser Load (0.3ms)  SELECT \"users\".* FROM \"users\" INNER JOIN \"user_industries\" ON \"user_industries\".\"user_id\" = \"users\".\"id\" INNER JOIN \"industries\" ON \"industries\".\"id\" = \"user_industries\".\"industry_id\" WHERE \"industries\".\"id\" IN (1)\nAvatar Load (0.2ms)  SELECT \"avatars\".* FROM \"avatars\"  WHERE \"avatars\".\"user_id\" IN (1, 2)  ORDER BY \"avatars\".\"sort_order\" ASC, \"avatars\".\"created_at\" ASC\n[\n  [0] #&lt;Avatar:0x007ff03c7f0df8&gt; {\n            :id =&gt; 1,\n       :user_id =&gt; 1,\n    :sort_order =&gt; 0,\n    :created_at =&gt; Tue, 04 Oct 2016 07:05:36 UTC +00:00,\n    :updated_at =&gt; Tue, 04 Oct 2016 07:05:44 UTC +00:00\n},\n[1] #&lt;Avatar:0x007ff03c7f0bf0&gt; {\n            :id =&gt; 3,\n       :user_id =&gt; 1,\n    :sort_order =&gt; 1,\n    :created_at =&gt; Tue, 04 Oct 2016 07:05:40 UTC +00:00,\n    :updated_at =&gt; Tue, 04 Oct 2016 07:05:40 UTC +00:00\n},\n[2] #&lt;Avatar:0x007ff03c7f09c0&gt; {\n            :id =&gt; 2,\n       :user_id =&gt; 1,\n    :sort_order =&gt; 2,\n    :created_at =&gt; Tue, 04 Oct 2016 07:05:38 UTC +00:00,\n    :updated_at =&gt; Tue, 04 Oct 2016 07:05:42 UTC +00:00\n}\n]\n[\n[0] #&lt;Avatar:0x007ff03c7f07b8&gt; {\n            :id =&gt; 4,\n       :user_id =&gt; 2,\n    :sort_order =&gt; 5,\n    :created_at =&gt; Tue, 04 Oct 2016 07:05:44 UTC +00:00,\n    :updated_at =&gt; Tue, 04 Oct 2016 07:05:48 UTC +00:00\n},\n[1] #&lt;Avatar:0x007ff03c7f0588&gt; {\n            :id =&gt; 6,\n       :user_id =&gt; 2,\n    :sort_order =&gt; 6,\n    :created_at =&gt; Tue, 04 Oct 2016 07:05:48 UTC +00:00,\n    :updated_at =&gt; Tue, 04 Oct 2016 07:05:48 UTC +00:00\n},\n[2] #&lt;Avatar:0x007ff03c7f0380&gt; {\n            :id =&gt; 5,\n       :user_id =&gt; 2,\n    :sort_order =&gt; 7,\n    :created_at =&gt; Tue, 04 Oct 2016 07:05:46 UTC +00:00,\n    :updated_at =&gt; Tue, 04 Oct 2016 07:05:48 UTC +00:00\n}\n]\n=&gt; [#&lt;User id: 1, name: \"John\", created_at: \"2016-10-04 07:05:40\", updated_at: \"2016-10-04 07:05:40\"&gt;, #&lt;User id: 2, name: \"Jill\", created_at: \"2016-10-04 07:05:48\", updated_at: \"2016-10-04 07:05:48\"&gt;] \n</code></pre>\n\n<p>Basically, we have 2 eager loading functions: preload and eager_load. When you use includes, it either calls preload or eager_load. preload results in 2 queries(find users &amp; find avatars for retrieved users) wheres eager_load uses only 1 query(the join query). So, when includes results in an join query(ie, results in eager_load), the order of the associations to be retrieved is skipped since its a single query.</p>\n\n<pre><code>User.includes(:avatars, :industries).where(industries: {id: [1]}).references(:industries)\n</code></pre>\n\n<p>results in join cause you are filtering the users based on particular industries which in itself is a 'through' association. 'through' uses a join. Also, remember that 'joins' results in an INNER JOIN whereas eager_load uses LEFT OUTER JOIN.</p>\n\n<pre><code>2.2.0 :050 &gt; User.joins(:industries).where(industries: {id: [1]}).references(:industries)\nUser Load (0.2ms)  SELECT \"users\".* FROM \"users\" INNER JOIN \"user_industries\" ON \"user_industries\".\"user_id\" = \"users\".\"id\" INNER JOIN \"industries\" ON \"industries\".\"id\" = \"user_industries\".\"industry_id\" WHERE \"industries\".\"id\" IN (1)\n=&gt; #&lt;ActiveRecord::Relation [#&lt;User id: 1, name: \"John\", created_at: \"2016-10-04 07:05:40\", updated_at: \"2016-10-04 07:05:40\"&gt;, #&lt;User id: 2, name: \"Jill\", created_at: \"2016-10-04 07:05:48\", updated_at: \"2016-10-04 \n\n2.2.0 :054 &gt;   User.includes(:industries).where(industries: {id: [1]}).references(:industries)\nSQL (0.3ms)  SELECT \"users\".\"id\" AS t0_r0, \"users\".\"name\" AS t0_r1, \"users\".\"created_at\" AS t0_r2, \"users\".\"updated_at\" AS t0_r3, \"industries\".\"id\" AS t1_r0, \"industries\".\"name\" AS t1_r1, \"industries\".\"created_at\" AS t1_r2, \"industries\".\"updated_at\" AS t1_r3 FROM \"users\" LEFT OUTER JOIN \"user_industries\" ON \"user_industries\".\"user_id\" = \"users\".\"id\" LEFT OUTER JOIN \"industries\" ON \"industries\".\"id\" = \"user_industries\".\"industry_id\" WHERE \"industries\".\"id\" IN (1)\n=&gt; #&lt;ActiveRecord::Relation [#&lt;User id: 1, name: \"John\", created_at: \"2016-10-04 07:05:40\", updated_at: \"2016-10-04 07:05:40\"&gt;, #&lt;User id: 2, name: \"Jill\", created_at: \"2016-10-04 07:05:48\", updated_at: \"2016-10-04 07:05:48\"&gt;]&gt; \n\n2.2.0 :057 &gt;   User.eager_load(:industries).where(industries: {id: [1]}).references(:industries)\nSQL (0.3ms)  SELECT \"users\".\"id\" AS t0_r0, \"users\".\"name\" AS t0_r1, \"users\".\"created_at\" AS t0_r2, \"users\".\"updated_at\" AS t0_r3, \"industries\".\"id\" AS t1_r0, \"industries\".\"name\" AS t1_r1, \"industries\".\"created_at\" AS t1_r2, \"industries\".\"updated_at\" AS t1_r3 FROM \"users\" LEFT OUTER JOIN \"user_industries\" ON \"user_industries\".\"user_id\" = \"users\".\"id\" LEFT OUTER JOIN \"industries\" ON \"industries\".\"id\" = \"user_industries\".\"industry_id\" WHERE \"industries\".\"id\" IN (1)\n\n=&gt; #&lt;ActiveRecord::Relation [#&lt;User id: 1, name: \"John\", created_at: \"2016-10-04 07:05:40\", updated_at: \"2016-10-04 07:05:40\"&gt;, #&lt;User id: 2, name: \"Jill\", created_at: \"2016-10-04 07:05:48\", updated_at: \"2016-10-04 07:05:48\"&gt;]&gt;   \n</code></pre>\n\n<p>You can refer <a href=\"http://blog.arkency.com/2013/12/rails4-preloading/\" rel=\"nofollow\">http://blog.arkency.com/2013/12/rails4-preloading/</a> for more examples with explanation. I havent found as to why the types of joins are different. Anyways, I hope this helps. I will try to reproduce the same for later versions of rails.</p>\n"}], "owner": {"reputation": 1335, "user_id": 2248638, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6e4a873186ddd8d431004b6f82dbb721?s=128&d=identicon&r=PG", "display_name": "skensell", "link": "https://stackoverflow.com/users/2248638/skensell"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1542, "favorite_count": 3, "accepted_answer_id": 39846514, "answer_count": 7, "score": 12, "last_activity_date": 1480484711, "creation_date": 1473205697, "last_edit_date": 1480484711, "question_id": 39359361, "link": "https://stackoverflow.com/questions/39359361/rails-ignores-association-scope-when-pre-caching-with-includes", "title": "Rails ignores association scope when pre-caching with includes", "body": "<p><strong>TL;DR:</strong> This question has its own sample app at <a href=\"https://github.com/skensell/SO-question-example\" rel=\"nofollow noreferrer\">https://github.com/skensell/SO-question-example</a> which you can use to debug yourself.  I put a bounty already once on this question, but I'm not convinced of (or I don't understand) the top answerer's reasoning. I am going to put another bounty on this because it's causing me a lot of frustration.</p>\n\n<p><strong>ORIGINAL QUESTION</strong></p>\n\n<p>I have a model <code>User</code> which has an association like so:</p>\n\n<pre><code>has_many :avatars, -&gt; { order([:sort_order =&gt; :asc,:created_at =&gt; :asc])}\n</code></pre>\n\n<p>I have an endpoint which performs a search for users and sets an <code>@users</code> variable to be used by the view.  Here comes the spooky part which I found in the debugger:</p>\n\n<pre><code>@users.first.avatars[0..2].map(&amp;:id)\n# =&gt; [2546, 2547, 2548]\n# This is the correct order.\n\n@users.to_a.first.avatars[0..2].map(&amp;:id)\n# =&gt; [2548, 2546, 2547]\n# Wrong order.\n</code></pre>\n\n<p>What is going on here? </p>\n\n<p>The only difference is <code>to_a</code>. I even tried leaving out the <code>to_a</code>, but I think it's implicitly being called by jbuilder anyways since I set it to a json array.</p>\n\n<p>Maybe the way I'm searching <code>User</code> has something to do with it? I'm using several includes and joins.</p>\n\n<p><strong>UPDATE</strong></p>\n\n<p>Here I can show you a simple example of this weird behavior from the rails console.  It seems that the includes..references is the offender, but I don't get why or how.</p>\n\n<pre><code>User.order(id: :desc)\n    .includes(:avatars, :industries)\n    .where(industries: {id:  [5]})\n    .references(:industries)\n    .limit(5).to_a.second.avatars.map(&amp;:id)\n# =&gt; [2751, 2748, 2749]\n# Wrong order.\n\nUser.order(id: :desc)\n    .includes(:avatars, :industries)\n    .where(industries: {id:  [5]})\n    .references(:industries)\n    .limit(5).second.avatars.map(&amp;:id)\n# =&gt; [2748, 2749, 2751]\n# Correct order.\n</code></pre>\n\n<p>I can verify that these queries refer to the same user, and that the one labeled Correct order is really correct w.r.t <code>sort_order</code> and <code>created_at</code> (which is how the association specifies the ordering).</p>\n\n<p><strong>UPDATE 2</strong></p>\n\n<p>Attached is the requested SQL log. I changed irrelevant fields to \"OMITTED\" and I replaced 34 irrelevant user fields with a '...'.</p>\n\n<pre><code>&gt;&gt; User.order(id: :desc).includes(:avatars, :industries).where(industries: {id:  [5]}).references(:industries).limit(5).to_a.second.avatars.map(&amp;:id)\nSQL (18.5ms)  SELECT  DISTINCT \"users\".\"id\", \"users\".\"id\" AS alias_0 FROM \"users\" LEFT OUTER JOIN \"avatars\" ON \"avatars\".\"user_id\" = \"users\".\"id\" LEFT OUTER JOIN \"user_professions\" ON \"user_professions\".\"user_id\" = \"users\".\"id\" LEFT OUTER JOIN \"industries\" ON \"industries\".\"id\" = \"user_professions\".\"industry_id\" WHERE \"industries\".\"id\" IN (5)  ORDER BY \"users\".\"id\" DESC LIMIT 5\nSQL (8.3ms)  SELECT \"users\".\"id\" AS t0_r0, \"users\".\"OMITTED\" AS t0_r1, \"users\".\"OMITTED\" AS t0_r2, ... AS t0_r36, \"avatars\".\"id\" AS t1_r0, \"avatars\".\"user_id\" AS t1_r1, \"avatars\".\"avatar\" AS t1_r2, \"avatars\".\"created_at\" AS t1_r3, \"avatars\".\"updated_at\" AS t1_r4, \"avatars\".\"OMITTED\" AS t1_r5, \"avatars\".\"OMITTED\" AS t1_r6, \"avatars\".\"sort_order\" AS t1_r7, \"industries\".\"id\" AS t2_r0, \"industries\".\"name\" AS t2_r1, \"industries\".\"created_at\" AS t2_r2, \"industries\".\"updated_at\" AS t2_r3 FROM \"users\" LEFT OUTER JOIN \"avatars\" ON \"avatars\".\"user_id\" = \"users\".\"id\" LEFT OUTER JOIN \"user_professions\" ON \"user_professions\".\"user_id\" = \"users\".\"id\" LEFT OUTER JOIN \"industries\" ON \"industries\".\"id\" = \"user_professions\".\"industry_id\" WHERE \"industries\".\"id\" IN (5) AND \"users\".\"id\" IN (1526, 945, 927, 888, 884)  ORDER BY \"users\".\"id\" DESC\n=&gt; [2751, 2748, 2749]\n\n&gt;&gt; User.order(id: :desc).includes(:avatars, :industries).where(industries: {id:  [5]}).references(:industries).limit(5).second.avatars.map(&amp;:id)\nSQL (0.9ms)  SELECT  DISTINCT \"users\".\"id\", \"users\".\"id\" AS alias_0 FROM \"users\" LEFT OUTER JOIN \"avatars\" ON \"avatars\".\"user_id\" = \"users\".\"id\" LEFT OUTER JOIN \"user_professions\" ON \"user_professions\".\"user_id\" = \"users\".\"id\" LEFT OUTER JOIN \"industries\" ON \"industries\".\"id\" = \"user_professions\".\"industry_id\" WHERE \"industries\".\"id\" IN (5)  ORDER BY \"users\".\"id\" DESC LIMIT 1 OFFSET 1\nSQL (0.8ms)  SELECT \"users\".\"id\" AS t0_r0, \"users\".\"OMITTED\" AS t0_r1, \"users\".\"OMITTED\" AS t0_r2, ... AS t0_r36, \"avatars\".\"id\" AS t1_r0, \"avatars\".\"user_id\" AS t1_r1, \"avatars\".\"avatar\" AS t1_r2, \"avatars\".\"created_at\" AS t1_r3, \"avatars\".\"updated_at\" AS t1_r4, \"avatars\".\"OMITTED\" AS t1_r5, \"avatars\".\"OMITTED\" AS t1_r6, \"avatars\".\"sort_order\" AS t1_r7, \"industries\".\"id\" AS t2_r0, \"industries\".\"name\" AS t2_r1, \"industries\".\"created_at\" AS t2_r2, \"industries\".\"updated_at\" AS t2_r3 FROM \"users\" LEFT OUTER JOIN \"avatars\" ON \"avatars\".\"user_id\" = \"users\".\"id\" LEFT OUTER JOIN \"user_professions\" ON \"user_professions\".\"user_id\" = \"users\".\"id\" LEFT OUTER JOIN \"industries\" ON \"industries\".\"id\" = \"user_professions\".\"industry_id\" WHERE \"industries\".\"id\" IN (5) AND \"users\".\"id\" IN (945)  ORDER BY \"users\".\"id\" DESC\n=&gt; [2748, 2749, 2751]\n&gt;&gt;\n</code></pre>\n\n<p>And here I'll attach a log which shows the user in question's avatars (id, sort_order, and created_at) so you can see that the order should be deterministic.</p>\n\n<pre><code>&gt;&gt; User.find(945).avatars.pluck(:id,:sort_order,:created_at)\nUser Load (5.3ms)  SELECT  \"users\".* FROM \"users\"  WHERE \"users\".\"id\" = $1 LIMIT 1  [[\"id\", 945]]\n(0.2ms)  SELECT \"avatars\".\"id\", \"avatars\".\"sort_order\", \"avatars\".\"created_at\" FROM \"avatars\"  WHERE \"avatars\".\"user_id\" = $1  ORDER BY \"avatars\".\"sort_order\" ASC, \"avatars\".\"created_at\" ASC  [[\"user_id\", 945]]\n=&gt; [[2748, 0, Fri, 13 Nov 2015 00:32:53 UTC +00:00], [2749, 0, Fri, 13 Nov 2015 00:47:02 UTC +00:00], [2751, 0, Fri, 13 Nov 2015 00:48:05 UTC +00:00]]\n</code></pre>\n\n<p>Also, I'm using Rails 4.1.4 and Ruby 2.1.10.</p>\n\n<p><strong>UPDATE 3</strong></p>\n\n<p>I have created a sample app here: <a href=\"https://github.com/skensell/SO-question-example\" rel=\"nofollow noreferrer\">https://github.com/skensell/SO-question-example</a> . What's even stranger in this sample app is that the <code>to_a</code> doesn't even matter. I get the wrong ordering even with just the <code>includes... references</code>.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "rspec"], "answers": [{"tags": [], "owner": {"reputation": 5962, "user_id": 115159, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/ac02a81e50f368f6d5c7a14b99ce2469?s=128&d=identicon&r=PG", "display_name": "Dharam Gollapudi", "link": "https://stackoverflow.com/users/115159/dharam-gollapudi"}, "is_accepted": true, "score": 4, "last_activity_date": 1473204943, "creation_date": 1473204943, "answer_id": 39359250, "question_id": 39358957, "link": "https://stackoverflow.com/questions/39358957/how-to-stub-out-date-that-is-implicitly-referenced-by-years-ago-in-rspec/39359250#39359250", "title": "How to stub out Date that is implicitly referenced by years.ago in RSpec?", "body": "<p>You should check <a href=\"https://github.com/travisjeffery/timecop\" rel=\"nofollow\">timecop</a></p>\n\n<p>Then in your tests, you could freeze the <code>date</code> to your desired value as follows:</p>\n\n<pre><code>describe \"some set of tests to mock\" do\n  before do\n    Timecop.freeze(2010, 1, 1)\n  end\n\n  after do\n    Timecop.return\n  end\n\n  it \"should do blah blah blah\" do\n  end\nend\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 31711, "user_id": 634576, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/48891dab622b535f3c2b4ec1c8765bed?s=128&d=identicon&r=PG", "display_name": "Dave Schweisguth", "link": "https://stackoverflow.com/users/634576/dave-schweisguth"}, "is_accepted": false, "score": 1, "last_activity_date": 1486130200, "last_edit_date": 1486130200, "creation_date": 1473206137, "answer_id": 39359413, "question_id": 39358957, "link": "https://stackoverflow.com/questions/39358957/how-to-stub-out-date-that-is-implicitly-referenced-by-years-ago-in-rspec/39359413#39359413", "title": "How to stub out Date that is implicitly referenced by years.ago in RSpec?", "body": "<p>You can usually control what Ruby and Rails use for the current time by stubbing <code>Time.now</code>:</p>\n\n<pre><code>allow(Time).to receive(:now).and_return(Time.local 2016, 9, 6, 16, 51)\n</code></pre>\n\n<p>That does work for <code>years.ago</code>.</p>\n\n<p>If your code, or the framework code you use, uses both <code>Time.now</code> and <code>Date.today</code>, however, timecop is easier.</p>\n\n<p>If you use timecop, be aware that it's easy to forget to <code>Timecop.return</code>, which can screw up subsequent tests. Prefer timecop's <a href=\"https://github.com/travisjeffery/timecop#timecopsafe_mode\" rel=\"nofollow noreferrer\">safe mode</a>.</p>\n"}], "owner": {"reputation": 6076, "user_id": 4044009, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/42e57031eb7d02c47c9afaecfc878638?s=128&d=identicon&r=PG&f=1", "display_name": "Neil", "link": "https://stackoverflow.com/users/4044009/neil"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 420, "favorite_count": 0, "accepted_answer_id": 39359250, "answer_count": 2, "score": 1, "last_activity_date": 1486130200, "creation_date": 1473202576, "last_edit_date": 1473769670, "question_id": 39358957, "link": "https://stackoverflow.com/questions/39358957/how-to-stub-out-date-that-is-implicitly-referenced-by-years-ago-in-rspec", "title": "How to stub out Date that is implicitly referenced by years.ago in RSpec?", "body": "<p>I know that I can stub out a method on <code>Date</code> like so:</p>\n\n<pre><code>allow(Date).to receive(:today).and_return Date.new(2015,11,10)\n</code></pre>\n\n<p>So now if within my spec the code calls <code>Date.today</code> I can be assured that it will return a Date object with the value of 11/10/2015.</p>\n\n<p>I have a scope that utilizes <code>years.ago.to_date</code>.  The user specifies the <em>number</em> of years ago for the scope:  Ex: <code>5.years.ago</code>, <code>2.years.ago</code>.  </p>\n\n<p>I am trying to test this scope.  In order to do so I need to control the <code>Date</code> that <code>years.ago</code> is referencing.  For instance, I would always want the Date to be 1/1/2010.  This way I will know that <code>5.years.ago</code> will return 1/1/2005, and 2.years.ago would return 1/1/2008.</p>\n\n<p>The issue is that I do not know what to stub out.  I do not know how to keep the Date consistent which <code>years.ago</code> uses.  </p>\n\n<p>Hopefully this makes sense.  I just need to control the Date that <code>years.ago</code> uses.  How can I stub that out?</p>\n\n<p>I looked a bit at <a href=\"http://api.rubyonrails.org/classes/ActiveSupport/Duration.html#method-i-ago\" rel=\"nofollow\">ActiveSupport::Duration</a>, but I'm not sure if that is the right place to look. </p>\n"}, {"tags": ["ruby", "multithreading", "mutex"], "comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1473207275, "post_id": 39358787, "comment_id": 66048775, "body": "Why does <code>@flag</code> start out as an empty string, and then later become one of <code>1</code> or <code>0</code>? Wouldn&#39;t <code>nil</code> be a better starting value? Testing that the thing is a string is a very, very odd way of doing this. You&#39;d be better with <code>x.nil?</code>"}], "answers": [{"tags": [], "owner": {"reputation": 1210, "user_id": 5862726, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-dyBzTE1yNyc/AAAAAAAAAAI/AAAAAAAAAUs/xIiSMA7_Gko/photo.jpg?sz=128", "display_name": "Todd Knarr", "link": "https://stackoverflow.com/users/5862726/todd-knarr"}, "is_accepted": false, "score": 0, "last_activity_date": 1473202138, "creation_date": 1473202138, "answer_id": 39358893, "question_id": 39358787, "link": "https://stackoverflow.com/questions/39358787/ruby-multithreading/39358893#39358893", "title": "Ruby multithreading", "body": "<p>As a general rule, the mutex lock is required (or better yet, a read/write lock so multiple reads can run in parallel and the exclusive lock's only needed when changing the value).</p>\n\n<p>It's possible to avoid needing the lock if you can guarantee that the underlying accesses (both the read and the write) are atomic (they happen as one uninterruptible action so it's not possible for two to overlap). On modern multi-core and multi-processor hardware it's difficult to guarantee that, and when you add in virtualization and semi-interpreted languages like Ruby it's all but impossible. Don't be fooled into thinking that being 99.999% certain there won't be an overlap is enough, that just means you can expect an error due to lack of locking once every 100,000 iterations which translates to several times a second for your code and probably at least once every couple of seconds for the kind of code you'd see in a real application. That's why it's advisable to follow the general rule and not worry about when it's safe to break it until you've exhausted every other option for getting acceptable performance and shown through profiling that it's acquiring/releasing that lock that's the bottleneck.</p>\n"}], "owner": {"reputation": 51, "user_id": 5042632, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/91607cf90272e9d13387db54325a0b4b?s=128&d=identicon&r=PG&f=1", "display_name": "Grr4", "link": "https://stackoverflow.com/users/5042632/grr4"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 105, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1473202138, "creation_date": 1473201370, "question_id": 39358787, "link": "https://stackoverflow.com/questions/39358787/ruby-multithreading", "title": "Ruby multithreading", "body": "<p>I have code that is running in a manner similar to the sample code below. There are two threads that loop at certain time intervals. The first thread sets a flag and depending on the value of this flag the second thread prints out a result. My question is in a situation like this where only one thread is changing the value of the resource (@flag), and the second thread is only accessing its value but not changing it, is a mutex lock required? Any explanations? </p>\n\n<pre><code>Class Sample\n\n  def initialize\n    @flag=\"\"\n    @wait_interval1 = 20\n    @wait_interval2 = 5\n  end\n\n  def thread1(x)\n    Thread.start do\n    loop do\n      if x.is_a?(String)\n        @flag = 0\n      else\n        @flag = 1\n      sleep @wait_interval\n    end\n    end\n  end\n\n  def thread2(y)\n    Thread.start do\n    loop do\n      if @flag == 0\n        if y.start_with?(\"a\")\n          puts \"yes\"\n        else\n          puts \"no\"\n        end\n      end\n    end\n   end\n   end\n\nend\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 636, "user_id": 1253311, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/21acab710c6e17104c2af7bf8390a9d5?s=128&d=identicon&r=PG", "display_name": "Matt", "link": "https://stackoverflow.com/users/1253311/matt"}, "edited": false, "score": 0, "creation_date": 1473201585, "post_id": 39358772, "comment_id": 66047361, "body": "Have you run <code>bundle install</code> from the root of your application directory?"}, {"owner": {"reputation": 109, "user_id": 6802171, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/04d396090100d1f693c341bb3b49da30?s=128&d=identicon&r=PG&f=1", "display_name": "hosam.shafik", "link": "https://stackoverflow.com/users/6802171/hosam-shafik"}, "reply_to_user": {"reputation": 636, "user_id": 1253311, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/21acab710c6e17104c2af7bf8390a9d5?s=128&d=identicon&r=PG", "display_name": "Matt", "link": "https://stackoverflow.com/users/1253311/matt"}, "edited": false, "score": 0, "creation_date": 1473204309, "post_id": 39358772, "comment_id": 66048019, "body": "Yes I ran bundle install"}], "answers": [{"comments": [{"owner": {"reputation": 1344, "user_id": 1150876, "user_type": "registered", "accept_rate": 31, "profile_image": "https://www.gravatar.com/avatar/84bdd2a52f2f327c8397a25d2182ec60?s=128&d=identicon&r=PG&f=1", "display_name": "Guy Dubrovski", "link": "https://stackoverflow.com/users/1150876/guy-dubrovski"}, "reply_to_user": {"reputation": 109, "user_id": 6802171, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/04d396090100d1f693c341bb3b49da30?s=128&d=identicon&r=PG&f=1", "display_name": "hosam.shafik", "link": "https://stackoverflow.com/users/6802171/hosam-shafik"}, "edited": false, "score": 0, "creation_date": 1473204083, "post_id": 39358922, "comment_id": 66047978, "body": "what about the phusion_passenger? try to use the simple webBrick server"}, {"owner": {"reputation": 109, "user_id": 6802171, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/04d396090100d1f693c341bb3b49da30?s=128&d=identicon&r=PG&f=1", "display_name": "hosam.shafik", "link": "https://stackoverflow.com/users/6802171/hosam-shafik"}, "edited": false, "score": 0, "creation_date": 1473205781, "post_id": 39358922, "comment_id": 66048407, "body": "I installed the gem and still getting the same result. I installed Ruby via RVM"}, {"owner": {"reputation": 1344, "user_id": 1150876, "user_type": "registered", "accept_rate": 31, "profile_image": "https://www.gravatar.com/avatar/84bdd2a52f2f327c8397a25d2182ec60?s=128&d=identicon&r=PG&f=1", "display_name": "Guy Dubrovski", "link": "https://stackoverflow.com/users/1150876/guy-dubrovski"}, "reply_to_user": {"reputation": 109, "user_id": 6802171, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/04d396090100d1f693c341bb3b49da30?s=128&d=identicon&r=PG&f=1", "display_name": "hosam.shafik", "link": "https://stackoverflow.com/users/6802171/hosam-shafik"}, "edited": false, "score": 0, "creation_date": 1473205992, "post_id": 39358922, "comment_id": 66048457, "body": "which gem you installed? you mean WebBrick? it comes with rails you shouldn&#39;t install it.."}, {"owner": {"reputation": 109, "user_id": 6802171, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/04d396090100d1f693c341bb3b49da30?s=128&d=identicon&r=PG&f=1", "display_name": "hosam.shafik", "link": "https://stackoverflow.com/users/6802171/hosam-shafik"}, "edited": false, "score": 0, "creation_date": 1473206111, "post_id": 39358922, "comment_id": 66048486, "body": "Would you please say would you mean with trying webrick? I never heard about it before"}, {"owner": {"reputation": 1344, "user_id": 1150876, "user_type": "registered", "accept_rate": 31, "profile_image": "https://www.gravatar.com/avatar/84bdd2a52f2f327c8397a25d2182ec60?s=128&d=identicon&r=PG&f=1", "display_name": "Guy Dubrovski", "link": "https://stackoverflow.com/users/1150876/guy-dubrovski"}, "reply_to_user": {"reputation": 109, "user_id": 6802171, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/04d396090100d1f693c341bb3b49da30?s=128&d=identicon&r=PG&f=1", "display_name": "hosam.shafik", "link": "https://stackoverflow.com/users/6802171/hosam-shafik"}, "edited": false, "score": 0, "creation_date": 1473206810, "post_id": 39358922, "comment_id": 66048674, "body": "WeBrick is the default web server that comes with rails. you can read about it more in here: <a href=\"https://devcenter.heroku.com/articles/ruby-default-web-server#what-is-webrick\" rel=\"nofollow noreferrer\">devcenter.heroku.com/articles/&hellip;</a> As it is your first app, I strongly suggest you to follow this tutorial on how to create your first app: <a href=\"http://guides.rubyonrails.org/getting_started.html\" rel=\"nofollow noreferrer\">guides.rubyonrails.org/getting_started.html</a>"}, {"owner": {"reputation": 109, "user_id": 6802171, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/04d396090100d1f693c341bb3b49da30?s=128&d=identicon&r=PG&f=1", "display_name": "hosam.shafik", "link": "https://stackoverflow.com/users/6802171/hosam-shafik"}, "edited": false, "score": 0, "creation_date": 1473215670, "post_id": 39358922, "comment_id": 66050287, "body": "I think the problem is, I cannot find this folder ruby_supportlib/phusion_passenger  in passenger directory, although I installed passenger gem"}, {"owner": {"reputation": 1344, "user_id": 1150876, "user_type": "registered", "accept_rate": 31, "profile_image": "https://www.gravatar.com/avatar/84bdd2a52f2f327c8397a25d2182ec60?s=128&d=identicon&r=PG&f=1", "display_name": "Guy Dubrovski", "link": "https://stackoverflow.com/users/1150876/guy-dubrovski"}, "reply_to_user": {"reputation": 109, "user_id": 6802171, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/04d396090100d1f693c341bb3b49da30?s=128&d=identicon&r=PG&f=1", "display_name": "hosam.shafik", "link": "https://stackoverflow.com/users/6802171/hosam-shafik"}, "edited": false, "score": 0, "creation_date": 1473255382, "post_id": 39358922, "comment_id": 66070771, "body": "don&#39;t use passenger, try to start with Webrick"}], "tags": [], "owner": {"reputation": 1344, "user_id": 1150876, "user_type": "registered", "accept_rate": 31, "profile_image": "https://www.gravatar.com/avatar/84bdd2a52f2f327c8397a25d2182ec60?s=128&d=identicon&r=PG&f=1", "display_name": "Guy Dubrovski", "link": "https://stackoverflow.com/users/1150876/guy-dubrovski"}, "is_accepted": false, "score": 0, "last_activity_date": 1473202319, "creation_date": 1473202319, "answer_id": 39358922, "question_id": 39358772, "link": "https://stackoverflow.com/questions/39358772/rails-web-application-could-not-be-started/39358922#39358922", "title": "Rails Web application could not be started", "body": "<p>I would first try to understand if you have a problem with the app or the environment.</p>\n\n<p>Try to run the simplest app by:</p>\n\n<pre><code>rails new simple_app\n</code></pre>\n\n<p>if it doesn't work - the problem is the environment.\nif it does work - probably you have some problem with the initializers or config files</p>\n\n<p>Let us know how it works for you! </p>\n"}, {"tags": [], "owner": {"reputation": 714, "user_id": 5159834, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh4.googleusercontent.com/-aH1V7Vjlqn4/AAAAAAAAAAI/AAAAAAAAKuQ/3LCsGyKtPV8/photo.jpg?sz=128", "display_name": "Pierangelo Orizio", "link": "https://stackoverflow.com/users/5159834/pierangelo-orizio"}, "is_accepted": false, "score": 0, "last_activity_date": 1473203357, "creation_date": 1473203357, "answer_id": 39359059, "question_id": 39358772, "link": "https://stackoverflow.com/questions/39358772/rails-web-application-could-not-be-started/39359059#39359059", "title": "Rails Web application could not be started", "body": "<p>Have you try gem install passenger ?</p>\n\n<p>or gem install bundler</p>\n"}, {"tags": [], "owner": {"reputation": 2252, "user_id": 770517, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/368f7a98c9e3225083568b8658236304?s=128&d=identicon&r=PG", "display_name": "whitehat101", "link": "https://stackoverflow.com/users/770517/whitehat101"}, "is_accepted": false, "score": 0, "last_activity_date": 1480481018, "creation_date": 1480481018, "answer_id": 40880478, "question_id": 39358772, "link": "https://stackoverflow.com/questions/39358772/rails-web-application-could-not-be-started/40880478#40880478", "title": "Rails Web application could not be started", "body": "<p>Your error message:</p>\n\n<pre><code>cannot load such file -- /var/lib/gems/2.3.0/gems/passenger-5.0.30/src/ruby_supportlib/phusion_passenger (LoadError)\n</code></pre>\n\n<p>Suggests a permission problem with files in the gem <code>/var/lib/gems/2.3.0/gems/passenger-5.0.30</code>. Either, the files <strong>don't exist</strong>, or they <strong>aren't readable</strong>. </p>\n\n<p>If you query the permissions for that file (make sure to append '.rb'):</p>\n\n<pre><code>ls -l /var/lib/gems/2.3.0/gems/passenger-5.0.30/src/ruby_supportlib/phusion_passenger.rb\n</code></pre>\n\n<p>You'll probably find it's not world readable, or at least not readable by the web server process' user. If it doesn't exist, then you should reinstall.</p>\n\n<p>I saw this error on a system that had a umask of <code>0066</code>, which caused passenger's gem files to be root:root with mode -rw-------.</p>\n"}], "owner": {"reputation": 109, "user_id": 6802171, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/04d396090100d1f693c341bb3b49da30?s=128&d=identicon&r=PG&f=1", "display_name": "hosam.shafik", "link": "https://stackoverflow.com/users/6802171/hosam-shafik"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 2471, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1480481018, "creation_date": 1473201297, "last_edit_date": 1473243461, "question_id": 39358772, "link": "https://stackoverflow.com/questions/39358772/rails-web-application-could-not-be-started", "title": "Rails Web application could not be started", "body": "<p>Getting this error even when I create a new project. I installed Ruby and RoR through RVM</p>\n\n<pre><code>cannot load such file -- /var/lib/gems/2.3.0/gems/passenger-5.0.30/src/ruby_supportlib/phusion_passenger (LoadError)\n  /usr/lib/ruby/2.3.0/rubygems/core_ext/kernel_require.rb:55:in `require'\n  /usr/lib/ruby/2.3.0/rubygems/core_ext/kernel_require.rb:55:in `require'\n  /var/lib/gems/2.3.0/gems/passenger-5.0.30/src/helper-scripts/rack-preloader.rb:74:in `init_passenger'\n  /var/lib/gems/2.3.0/gems/passenger-5.0.30/src/helper-scripts/rack-preloader.rb:155:in `&lt;module:App&gt;'\n  /var/lib/gems/2.3.0/gems/passenger-5.0.30/src/helper-scripts/rack-preloader.rb:30:in `&lt;module:PhusionPassenger&gt;'\n  /var/lib/gems/2.3.0/gems/passenger-5.0.30/src/helper-scripts/rack-preloader.rb:29:in `&lt;main&gt;'\n</code></pre>\n\n<p>I think I found that the problem is in the directory of the gems. I do not know how to change it on Ubuntu</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 1, "creation_date": 1473199398, "post_id": 39358441, "comment_id": 66046866, "body": "have you tried with backticks instead of exec? <code>`cd &#47;ABC&#47;XYZ; grep -E &#47;db&#47;instance db_info.txt | grep username`</code>"}, {"owner": {"reputation": 481, "user_id": 1419464, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FlZVa.jpg?s=128&g=1", "display_name": "LukeS", "link": "https://stackoverflow.com/users/1419464/lukes"}, "edited": false, "score": 1, "creation_date": 1473200084, "post_id": 39358441, "comment_id": 66047087, "body": "also maybe try with single quotes inside your exec statement like so <code>exec(&quot;cd &#47;ABC&#47;XYZ; grep -E &#39;&#47;db&#47;instance&#39; db_info.txt | grep &#39;username&#39;&quot;)</code>"}, {"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 1, "creation_date": 1473202957, "post_id": 39358441, "comment_id": 66047698, "body": "Instead of <code>cd ...; grep ...</code> use <code>grep ... &#47;ABC&#47;XYZ&#47;db_info.txt ...</code>. Are you <i>sure</i> you want to use <code>exec</code>, which <code>&quot;Replaces the current process by running the given external command...&quot;</code>. In other words, your Ruby script disappears and the system call runs, resulting in jRuby thinking the script aborted. Try using <code>%x(...)</code>, or one of the <code>popen</code> variants."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1473207430, "post_id": 39358441, "comment_id": 66048808, "body": "Using Ruby as a fancy shell wrapper for stuff like this is really missing the point of Ruby. Why not <code>File.readlines(&#39;&#47;ABC&#47;XYZ&#47;db_info.txt&#39;).grep(%r[&#47;db&#47;instance]&zwnj;&#8203;).grep(&#47;username&#47;)</code>?"}], "owner": {"reputation": 935, "user_id": 2095793, "user_type": "registered", "accept_rate": 21, "profile_image": "https://www.gravatar.com/avatar/98ec2ef665b7e86cd22ed73e5c149fbd?s=128&d=identicon&r=PG", "display_name": "itsh", "link": "https://stackoverflow.com/users/2095793/itsh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 32, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1473198979, "creation_date": 1473198979, "question_id": 39358441, "link": "https://stackoverflow.com/questions/39358441/logical-operators-in-grep-in-ruby-exec-is-erroring-out", "title": "Logical operators in grep in Ruby exec is erroring out", "body": "<p>While executing the below mentioned shell command in Ruby I am seeing <code>org.jruby.exceptions.MainExitException: aborted</code> error message. Can someone help me in fixing this?</p>\n\n<pre><code>exec(\"cd /ABC/XYZ; grep -E \\\"/db/instance\\\" db_info.txt | grep \\\"username\\\"\")\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "arrays", "ruby"], "comments": [{"owner": {"reputation": 1479, "user_id": 2506819, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3b60435154915157dfd7ebfc04164930?s=128&d=identicon&r=PG", "display_name": "fanta", "link": "https://stackoverflow.com/users/2506819/fanta"}, "edited": false, "score": 1, "creation_date": 1473199323, "post_id": 39358433, "comment_id": 66046849, "body": "you should use <code>detect</code> like this <code>user = users.detect {|u| u.email == &#39;bob@builder.com&#39;}</code>, you&#39;ll get <code>nil</code> if no user with that email was found. And if a user is found then you can just use <code>user.id</code> to get its id."}, {"owner": {"reputation": 8519, "user_id": 3581788, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/ghs5V.jpg?s=128&g=1", "display_name": "Sylar", "link": "https://stackoverflow.com/users/3581788/sylar"}, "reply_to_user": {"reputation": 1479, "user_id": 2506819, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3b60435154915157dfd7ebfc04164930?s=128&d=identicon&r=PG", "display_name": "fanta", "link": "https://stackoverflow.com/users/2506819/fanta"}, "edited": false, "score": 0, "creation_date": 1473199406, "post_id": 39358433, "comment_id": 66046871, "body": "@fanta I need <code>true</code> or <code>false</code>. If <code>true</code>, then get me their <code>id</code>. <code>false</code> will run other code."}, {"owner": {"reputation": 1479, "user_id": 2506819, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3b60435154915157dfd7ebfc04164930?s=128&d=identicon&r=PG", "display_name": "fanta", "link": "https://stackoverflow.com/users/2506819/fanta"}, "edited": false, "score": 0, "creation_date": 1473199560, "post_id": 39358433, "comment_id": 66046917, "body": "you can check <code>if user</code>, if <code>user</code> is <code>nil</code>, then you&#39;ll execute your <code>else</code> in the block."}, {"owner": {"reputation": 8519, "user_id": 3581788, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/ghs5V.jpg?s=128&g=1", "display_name": "Sylar", "link": "https://stackoverflow.com/users/3581788/sylar"}, "reply_to_user": {"reputation": 1479, "user_id": 2506819, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3b60435154915157dfd7ebfc04164930?s=128&d=identicon&r=PG", "display_name": "fanta", "link": "https://stackoverflow.com/users/2506819/fanta"}, "edited": false, "score": 0, "creation_date": 1473199563, "post_id": 39358433, "comment_id": 66046918, "body": "@fanta My bad! It&#39;s late here in the UK. Thanks for that!"}], "answers": [{"tags": [], "owner": {"reputation": 1513, "user_id": 1334750, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/0vTHg.png?s=128&g=1", "display_name": "Pawe\u0142 Duda", "link": "https://stackoverflow.com/users/1334750/pawe%c5%82-duda"}, "is_accepted": false, "score": 0, "last_activity_date": 1473199659, "creation_date": 1473199659, "answer_id": 39358562, "question_id": 39358433, "link": "https://stackoverflow.com/questions/39358433/get-other-field-if-this-is-included-in-the-array-object/39358562#39358562", "title": "Get other field if this is included in the array object", "body": "<p>Since you seem to be using ActiveRecord, it would be faster to query the database for the email:</p>\n\n<pre><code># returns the user id or nil, if not found\nUser.find_by(email: 'bob@builder.com').pluck(:id)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 445, "user_id": 5026941, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/IMpEg.jpg?s=128&g=1", "display_name": "BIlal Khan", "link": "https://stackoverflow.com/users/5026941/bilal-khan"}, "is_accepted": false, "score": 0, "last_activity_date": 1473199867, "creation_date": 1473199867, "answer_id": 39358601, "question_id": 39358433, "link": "https://stackoverflow.com/questions/39358433/get-other-field-if-this-is-included-in-the-array-object/39358601#39358601", "title": "Get other field if this is included in the array object", "body": "<p>You can try like this if you have array of hashes:</p>\n\n<pre><code>arr.map do |h|\n  h[:id] if h[:email] == \"bob@builder.com\"\nend.compact\n</code></pre>\n\n<p>It will return the value of id in an array of all the hashes which satisfies the condition.</p>\n"}], "owner": {"reputation": 8519, "user_id": 3581788, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/ghs5V.jpg?s=128&g=1", "display_name": "Sylar", "link": "https://stackoverflow.com/users/3581788/sylar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 30, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1473199867, "creation_date": 1473198912, "question_id": 39358433, "link": "https://stackoverflow.com/questions/39358433/get-other-field-if-this-is-included-in-the-array-object", "title": "Get other field if this is included in the array object", "body": "<p>Title may sound off but below explains more.</p>\n\n<p>I need to know if an item is included in an array object:</p>\n\n<pre><code>[\n  { id: 12345, name: \"Bob\", email: \"bob@builder.com\" },\n  ...\n  { id: 13456, name: \"job\", email: \"joe@farm.com\" }\n]\n</code></pre>\n\n<p>In english: If this <code>email</code> present, give me their <code>id</code></p>\n\n<pre><code>users = User.all\nusers.any?{|u| u.email == \"bob@builder.com\"} # true\n</code></pre>\n\n<p>That will be true. Now, how to get the <code>id</code> of the user which is \"12345\"? Note, I will not know the <code>id</code>.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "controller"], "comments": [{"owner": {"reputation": 481, "user_id": 1419464, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FlZVa.jpg?s=128&g=1", "display_name": "LukeS", "link": "https://stackoverflow.com/users/1419464/lukes"}, "edited": false, "score": 0, "creation_date": 1473198768, "post_id": 39358379, "comment_id": 66046672, "body": "Not sure what you are trying to achieve exactly here. Can you add more context/explanations/code?"}, {"owner": {"reputation": 2835, "user_id": 3650983, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/92b85e6afaf7b9a06fab7b85a6de5bac?s=128&d=identicon&r=PG", "display_name": "ChaosPredictor", "link": "https://stackoverflow.com/users/3650983/chaospredictor"}, "reply_to_user": {"reputation": 481, "user_id": 1419464, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FlZVa.jpg?s=128&g=1", "display_name": "LukeS", "link": "https://stackoverflow.com/users/1419464/lukes"}, "edited": false, "score": 0, "creation_date": 1473198995, "post_id": 39358379, "comment_id": 66046760, "body": "I&#39;m trying to block the access to show action for user that not meet the conditions"}, {"owner": {"reputation": 1479, "user_id": 2506819, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3b60435154915157dfd7ebfc04164930?s=128&d=identicon&r=PG", "display_name": "fanta", "link": "https://stackoverflow.com/users/2506819/fanta"}, "edited": false, "score": 1, "creation_date": 1473199151, "post_id": 39358379, "comment_id": 66046798, "body": "something like ?: <code>before_action :redirect_if_not_allowed</code>, and then in your <code>redirect_if_not_allowed</code> function: <code>redirect_to index_path if not_logged_in || logged_in_but_not_admin</code>, and then you define the logic in your <code>not_logged_in</code> and <code>logged_in_but_not_admin</code>."}, {"owner": {"reputation": 2835, "user_id": 3650983, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/92b85e6afaf7b9a06fab7b85a6de5bac?s=128&d=identicon&r=PG", "display_name": "ChaosPredictor", "link": "https://stackoverflow.com/users/3650983/chaospredictor"}, "edited": false, "score": 0, "creation_date": 1473199625, "post_id": 39358379, "comment_id": 66046944, "body": "Thanks fanta! I have tried something similar but the functions (Loggen in Admin, etc) already defined and I didn&#39;t succeed to build &quot;redirect_if_not_allowed&quot; function"}, {"owner": {"reputation": 481, "user_id": 1419464, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FlZVa.jpg?s=128&g=1", "display_name": "LukeS", "link": "https://stackoverflow.com/users/1419464/lukes"}, "edited": false, "score": 1, "creation_date": 1473199745, "post_id": 39358379, "comment_id": 66046980, "body": "You might use a gem that already defines these methods. Check your helpers and your gems."}, {"owner": {"reputation": 2835, "user_id": 3650983, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/92b85e6afaf7b9a06fab7b85a6de5bac?s=128&d=identicon&r=PG", "display_name": "ChaosPredictor", "link": "https://stackoverflow.com/users/3650983/chaospredictor"}, "edited": false, "score": 0, "creation_date": 1473199928, "post_id": 39358379, "comment_id": 66047027, "body": "Yes, It&#39;s in the helpers. But there is no way to use it controller without changing it?"}, {"owner": {"reputation": 2835, "user_id": 3650983, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/92b85e6afaf7b9a06fab7b85a6de5bac?s=128&d=identicon&r=PG", "display_name": "ChaosPredictor", "link": "https://stackoverflow.com/users/3650983/chaospredictor"}, "reply_to_user": {"reputation": 481, "user_id": 1419464, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FlZVa.jpg?s=128&g=1", "display_name": "LukeS", "link": "https://stackoverflow.com/users/1419464/lukes"}, "edited": false, "score": 0, "creation_date": 1474097975, "post_id": 39358379, "comment_id": 66401176, "body": "@LukeS if the negative ranking done by one of you. can you please remove it?"}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1474404518, "post_id": 39358379, "comment_id": 66515514, "body": "What is an example of &quot;logged in&quot; user that is not &quot;current&quot;?"}, {"owner": {"reputation": 2835, "user_id": 3650983, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/92b85e6afaf7b9a06fab7b85a6de5bac?s=128&d=identicon&r=PG", "display_name": "ChaosPredictor", "link": "https://stackoverflow.com/users/3650983/chaospredictor"}, "edited": false, "score": 0, "creation_date": 1474447811, "post_id": 39358379, "comment_id": 66530704, "body": "Maybe I&#39;m using the wrong term, but the example is: User A &quot;logged in&quot; want to see User B profile. User A is not &quot;current&quot; for User B"}], "answers": [{"comments": [{"owner": {"reputation": 2835, "user_id": 3650983, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/92b85e6afaf7b9a06fab7b85a6de5bac?s=128&d=identicon&r=PG", "display_name": "ChaosPredictor", "link": "https://stackoverflow.com/users/3650983/chaospredictor"}, "edited": false, "score": 0, "creation_date": 1474098299, "post_id": 39358703, "comment_id": 66401256, "body": "Thank you @max ! now I&#39;m thikning that it&#39;s better to implement it inside the action"}, {"owner": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "reply_to_user": {"reputation": 2835, "user_id": 3650983, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/92b85e6afaf7b9a06fab7b85a6de5bac?s=128&d=identicon&r=PG", "display_name": "ChaosPredictor", "link": "https://stackoverflow.com/users/3650983/chaospredictor"}, "edited": false, "score": 1, "creation_date": 1474281070, "post_id": 39358703, "comment_id": 66451603, "body": "No, its not better to implement it in the action. That leads to you duplicating the same authentication / authorization logic all over your controllers."}, {"owner": {"reputation": 2835, "user_id": 3650983, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/92b85e6afaf7b9a06fab7b85a6de5bac?s=128&d=identicon&r=PG", "display_name": "ChaosPredictor", "link": "https://stackoverflow.com/users/3650983/chaospredictor"}, "edited": false, "score": 0, "creation_date": 1474401146, "post_id": 39358703, "comment_id": 66513808, "body": "may I ask you to vote for the question? this question was closed because I write it not clear, but I have edited it"}], "tags": [], "owner": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "is_accepted": false, "score": 1, "last_activity_date": 1473200890, "creation_date": 1473200890, "answer_id": 39358703, "question_id": 39358379, "link": "https://stackoverflow.com/questions/39358379/ruby-on-rails-before-action-as-action-preventer/39358703#39358703", "title": "Ruby on Rails - before_action as action preventer", "body": "<p>You're conflating two very different things here - authentication and authorization.</p>\n\n<p>You don't really need a a very complex logic gate - you need to seperate callbacks for each concern.</p>\n\n<pre><code>class ApplicationController &lt; ActionController::Base\n\n  private\n\n    def authenticate_user!\n      flash[:error] = \"Please sign in.\"\n      redirect_to new_session_path and return\n    end\nend\n</code></pre>\n\n<p>So lets setup a pretty simple example of authentication and authorization. The rules are as follows:</p>\n\n<hr>\n\n<ul>\n<li>any visitor may view the index and show </li>\n<li>any signed in user may create new books</li>\n<li>the user that has created a book or an admin may alter existing records</li>\n</ul>\n\n<hr>\n\n<pre><code>class BooksController &lt; ApplicationController\n\n  before_action :authenticate_user!, except: [:show, :index]\n  before_action :set_book, except: [:new, :index]\n  before_action :authorize!, except: [:new, :create, :show, :index]\n\n  private \n\n    def set_book    \n      @user = Book.find(params[:id])\n    end\n\n    def authorize!\n      unless @book.user == current_user || current_user.admin?\n        redirect_to users_path, alert: 'You are not authorized.' and return\n      end\n    end\nend\n</code></pre>\n\n<p>However you should start by integrating and learning existing solutions such as Devise, CanCanCan and Pundit. When you have mastered that you can roll your own.</p>\n"}], "owner": {"reputation": 2835, "user_id": 3650983, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/92b85e6afaf7b9a06fab7b85a6de5bac?s=128&d=identicon&r=PG", "display_name": "ChaosPredictor", "link": "https://stackoverflow.com/users/3650983/chaospredictor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 590, "favorite_count": 0, "closed_date": 1473258612, "answer_count": 1, "score": -1, "last_activity_date": 1474404428, "creation_date": 1473198660, "last_edit_date": 1474404428, "question_id": 39358379, "link": "https://stackoverflow.com/questions/39358379/ruby-on-rails-before-action-as-action-preventer", "closed_reason": "Needs details or clarity", "title": "Ruby on Rails - before_action as action preventer", "body": "<p><strong>Edit:</strong> The original goal was to use <code>before_action</code> as blocker of <code>show</code> action for user that not Admin neither Current. In other words let only Admin or Current user execute <code>show</code> action. From my experience I understood that it's the easy way to implement it is by blocking the execution from inside of the action, but it leads to code duplication.</p>\n\n<p><strong>Original:</strong> I'm trying to build some complex before_action configuration:</p>\n\n<p><a href=\"https://i.stack.imgur.com/fioYv.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/fioYv.png\" alt=\"enter image description here\"></a></p>\n\n<p>in boolean logic I can configure it as:\nLogged_in and (Admin or Current)</p>\n\n<p>Logged_in/Not Logged in, Admin and Current function already defined</p>\n\n<pre><code>before_action :logged_in_user,      only: [:show]\nbefore_action :current_user,        only: [:show]    #correct - the some \nbefore_action :admin_user,          only: [:show]\n</code></pre>\n\n<p>It should work by the logic that defined up</p>\n"}, {"tags": ["ruby", "initialization", "instance-variables", "self"], "answers": [{"tags": [], "owner": {"reputation": 481, "user_id": 1419464, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FlZVa.jpg?s=128&g=1", "display_name": "LukeS", "link": "https://stackoverflow.com/users/1419464/lukes"}, "is_accepted": false, "score": 0, "last_activity_date": 1473198549, "creation_date": 1473198549, "answer_id": 39358358, "question_id": 39358296, "link": "https://stackoverflow.com/questions/39358296/understanding-the-access-of-a-variable-assigned-in-initialize-in-ruby/39358358#39358358", "title": "Understanding the access of a variable assigned in initialize in Ruby", "body": "<p><code>@variable</code> will directly access the instance variable for that class. Writing <code>self.variable</code> will send to the object a message <code>variable</code>. By default it will return the instance variable but it could do other things depending on how you set up your object. It could be a call to a method, or a subclass, or anything else.</p>\n\n<p>The difference between calling <code>blogs</code> or <code>self.blogs</code> is totally up to syntax. If you use an opinionated syntax checker like rubocop it will tell you that you have a redundant use of <code>self</code></p>\n"}, {"comments": [{"owner": {"reputation": 57, "user_id": 6658801, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5h6Dg.jpg?s=128&g=1", "display_name": "loopylou", "link": "https://stackoverflow.com/users/6658801/loopylou"}, "edited": false, "score": 0, "creation_date": 1473280763, "post_id": 39358417, "comment_id": 66085171, "body": "Thank you very much!!"}], "tags": [], "owner": {"reputation": 1548, "user_id": 1246279, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e2533d5a4299cad329268e552c47fa8d?s=128&d=identicon&r=PG", "display_name": "philomory", "link": "https://stackoverflow.com/users/1246279/philomory"}, "is_accepted": true, "score": 1, "last_activity_date": 1473199362, "last_edit_date": 1473199362, "creation_date": 1473198835, "answer_id": 39358417, "question_id": 39358296, "link": "https://stackoverflow.com/questions/39358296/understanding-the-access-of-a-variable-assigned-in-initialize-in-ruby/39358417#39358417", "title": "Understanding the access of a variable assigned in initialize in Ruby", "body": "<p>For most method calls on self, <code>self.method_name</code> is equivalent to just <code>method_name</code>. That's not the case for methods whose name ends with an <code>=</code>, though.</p>\n\n<p>The first thing to note, then, is that <code>self.blogs = etc</code> doesn't call a method named <code>blogs</code> and then somehow 'assign etc to it'; that line calls the method <code>blogs=</code>, and passes <code>etc</code> to it as an argument.</p>\n\n<p>The reason you can't shorten that to just <code>blogs = etc</code>, like you can with other method calls, is because <code>blogs = etc</code> is indistinguishable from creating a new local variable named <code>blogs</code>.</p>\n\n<p>When, on the previous line, you see a bare <code>blogs</code>, that is <em>also</em> a method call, and could just as easily have been written <code>self.blogs</code>. Writing it with an implicit receiver is just shorter. Of course, <code>blogs</code> is also potentially ambiguous as the use of a local variable, but in this case the parser can tell it's not, since there's no local variable named <code>blogs</code> assigned previously in the method (and if there had been, a bare <code>blogs</code> would have the value of that local variable, and <code>self.blogs</code> would be necessary if you had meant the method call).</p>\n\n<p>As for using <code>@blogs =</code> instead of <code>self.blogs =</code>, in this case it would have the same effect, but there <em>is</em> a subtle difference: if you later redefine the <code>blogs=</code> method to have additional effects (say, writing a message to a log), the call to <code>self.blogs =</code> will pick up those changes, whereas the bare direct access will not. In the extreme case, if you redefine <code>blogs=</code> to store the value in a database rather than an instance variable, <code>@blogs =</code> won't even be <em>similar</em> anymore (though obviously that sort of major change in infrastructure will probably have knock-on effects internal to the class regardless).</p>\n"}, {"comments": [{"owner": {"reputation": 57, "user_id": 6658801, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5h6Dg.jpg?s=128&g=1", "display_name": "loopylou", "link": "https://stackoverflow.com/users/6658801/loopylou"}, "edited": false, "score": 0, "creation_date": 1473279186, "post_id": 39358677, "comment_id": 66084501, "body": "Thank you so much! You&#39;re explanation has really helped me understand how it&#39;s all working. There&#39;s just one thing I still don&#39;t quite get though - When you say &#39;you can&#39;t omit self. here otherwise it just sets a local variable.&#39; - What would be/go wrong with setting a local variable in initialize? The code still seems to run OK if I use @ instead of self."}, {"owner": {"reputation": 57, "user_id": 6658801, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5h6Dg.jpg?s=128&g=1", "display_name": "loopylou", "link": "https://stackoverflow.com/users/6658801/loopylou"}, "edited": false, "score": 0, "creation_date": 1473280355, "post_id": 39358677, "comment_id": 66085023, "body": "actually don&#39;t worry about my other question here; figured it out with the added help of the below answer too!"}], "tags": [], "owner": {"reputation": 7994, "user_id": 1625339, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/b8ba46f911517c8b2ccc39e0be9050c0?s=128&d=identicon&r=PG", "display_name": "Aetherus", "link": "https://stackoverflow.com/users/1625339/aetherus"}, "is_accepted": false, "score": 2, "last_activity_date": 1473200361, "creation_date": 1473200361, "answer_id": 39358677, "question_id": 39358296, "link": "https://stackoverflow.com/questions/39358296/understanding-the-access-of-a-variable-assigned-in-initialize-in-ruby/39358677#39358677", "title": "Understanding the access of a variable assigned in initialize in Ruby", "body": "<p>To answer your question, we have to reveal the true nature of <code>attr_accessor</code>.</p>\n\n<pre><code>class Foo\n  attr_accessor :bar\nend\n</code></pre>\n\n<p>is completely equivalent to</p>\n\n<pre><code>class Foo\n  def bar\n    @bar\n  end\n\n  def bar=(value)\n    @bar = value\n  end\nend\n</code></pre>\n\n<p>You can see that <code>attr_accessor :bar</code> defines two instance methods <code>Foo#bar</code> and <code>Foo#bar=</code> that access an instance variable <code>@bar</code>.</p>\n\n<p>Lets then look at your code. </p>\n\n<p><code>self.blogs = []</code> in <code>initialize</code> is actually calling the method <code>User#blogs=</code>, and through it sets the instance variable <code>@blogs</code> with an empty array. It can be written as <code>self.blogs=([])</code> but it's noisy, isn't it? By the way, you can't omit <code>self.</code> here otherwise it just sets a local variable.</p>\n\n<p><code>blogs &lt;&lt; added_blog</code> calls the method <code>User#blog</code> which returns the value of <code>@blogs</code>. It can also be written as <code>self.blogs().push(added_blog)</code>, but again it's not rubyish. You can omit <code>self.</code> because there is no local variable named <code>blogs</code> in <code>User#add_blog</code>, so ruby <strong>falls back</strong> to call the instance method.</p>\n\n<p><code>self.blogs = blogs.sort_by { |blog| blog.date }.reverse</code> mixes call to <code>User#blogs=</code> and <code>User#blogs</code>.</p>\n"}], "owner": {"reputation": 57, "user_id": 6658801, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5h6Dg.jpg?s=128&g=1", "display_name": "loopylou", "link": "https://stackoverflow.com/users/6658801/loopylou"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1173, "favorite_count": 0, "accepted_answer_id": 39358417, "answer_count": 3, "score": 2, "last_activity_date": 1473200361, "creation_date": 1473198286, "question_id": 39358296, "link": "https://stackoverflow.com/questions/39358296/understanding-the-access-of-a-variable-assigned-in-initialize-in-ruby", "title": "Understanding the access of a variable assigned in initialize in Ruby", "body": "<p>As a beginner, I've not quite got my head around <code>self</code> so I'm having trouble understanding how the <code>self.blogs</code> in initialize, and <code>blogs</code> then <code>self.blogs</code> on the next line after in the <code>add_blog</code> method, are all working together in the below code.</p>\n\n<p>Why does <code>blogs</code> in the <code>add_blog</code> method access the same variable as <code>self.blogs</code> in initalize?\nAnd then why is <code>self.blogs</code> used afterwards to sort the <code>blogs</code> array?</p>\n\n<p>Also, would it matter if I used <code>@blogs</code> in initialize, instead of <code>self.blogs</code>?</p>\n\n<pre><code>class User\n  attr_accessor :username, :blogs\n\n  def initialize(username)\n    self.username = username\n    self.blogs    = []\n  end\n\n  def add_blog(date, text)\n    added_blog = Blog.new(date, self, text)\n    blogs &lt;&lt; added_blog\n    self.blogs = blogs.sort_by { |blog| blog.date }.reverse\n    added_blog\n  end\nend\n</code></pre>\n"}, {"tags": ["ruby", "build", "jekyll", "serve"], "comments": [{"owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 0, "creation_date": 1473205147, "post_id": 39358123, "comment_id": 66048254, "body": "no idea if this will work but did you try the flag the error suggests <code>Incremental build: disabled. Enable with --incremental</code>"}, {"owner": {"reputation": 1895, "user_id": 5477561, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a8da372e79dbb466c65a7f8a9b934b7?s=128&d=identicon&r=PG", "display_name": "Ross", "link": "https://stackoverflow.com/users/5477561/ross"}, "edited": false, "score": 0, "creation_date": 1473243986, "post_id": 39358123, "comment_id": 66062799, "body": "Could be easier to debug if you provide your GitHub URL. Enabling incremental build won&#39;t fix this. The error message looks similar to this issue: <a href=\"https://github.com/jekyll/github-metadata/issues/57\" rel=\"nofollow noreferrer\">github.com/jekyll/github-metadata/issues/57</a>"}, {"owner": {"reputation": 9244, "user_id": 2397550, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/iAb8N.jpg?s=128&g=1", "display_name": "JoostS", "link": "https://stackoverflow.com/users/2397550/joosts"}, "edited": false, "score": 0, "creation_date": 1473279817, "post_id": 39358123, "comment_id": 66084783, "body": "<code>Error: No such file or directory - git rev-parse HEAD</code> seems to point at a problem with you git."}], "answers": [{"tags": [], "owner": {"reputation": 104, "user_id": 5134426, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/jTwZT.jpg?s=128&g=1", "display_name": "Bogdan Mircea Stanciu", "link": "https://stackoverflow.com/users/5134426/bogdan-mircea-stanciu"}, "is_accepted": false, "score": 0, "last_activity_date": 1475696146, "creation_date": 1475696146, "answer_id": 39882268, "question_id": 39358123, "link": "https://stackoverflow.com/questions/39358123/jekyll-error-serve-only-works-once/39882268#39882268", "title": "Jekyll Error - &quot;serve&quot; only works once", "body": "<p>I also get this error in CMD. You should have <a href=\"https://desktop.github.com/\" rel=\"nofollow\">github's desktop app</a> installed; try running the same commands from the GitShell you get with that app.</p>\n\n<p>For me that works, it saves me the trouble of installing git globally on Windows and setting it up.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user6802143"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 156, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1475696146, "creation_date": 1473197326, "last_edit_date": 1473197937, "question_id": 39358123, "link": "https://stackoverflow.com/questions/39358123/jekyll-error-serve-only-works-once", "title": "Jekyll Error - &quot;serve&quot; only works once", "body": "<p>Started working on an update to my website. It was working fine the other day but now I get an error.</p>\n\n<p>I generally type on CMD (i'm on Windows 10) \"bundle exec Jekyll serve --watch\" and the server goes. I can edit and save and its all reflected in browser upon refresh.</p>\n\n<p>Now I can do this, but if I make one change to any file it works. Do another change and I get an error. I have to terminate and type again.</p>\n\n<p>Below is the error:</p>\n\n<pre><code>D:\\Tristen Grant\\Documents\\GitHub\\portfolio&gt;bundle exec jekyll serve --watch\nDL is deprecated, please use Fiddle\nConfiguration file: D:/Tristen Grant/Documents/GitHub/portfolio/_config.yml\n    Source: D:/Tristen Grant/Documents/GitHub/portfolio\n    Destination: D:/Tristen Grant/Documents/GitHub/portfolio/_site\n Incremental build: disabled. Enable with --incremental\n    Generating...\n    done in 0.595 seconds.\nAuto-regeneration: enabled for 'D:/Tristen Grant/Documents/GitHub/portfolio'\nConfiguration file: D:/Tristen Grant/Documents/GitHub/portfolio/_config.yml\n    Server address: http://127.0.0.1:3000//\nServer running... press ctrl-c to stop.\n    Regenerating: 1 file(s) changed at 2016-09-06 16:16:28 ...done in 0.521498 seconds.\nRegenerating: 1 file(s) changed at 2016-09-06 16:16:30 ...error:\n    Error: No such file or directory - git rev-parse HEAD\n    Error: Run jekyll build --trace for more information.\n[2016-09-06 16:19:35] ERROR Errno::ENOTSOCK: An operation was attempted on something that is not a socket.\n    C:/Ruby21-x64/lib/ruby/2.1.0/webrick/server.rb:170:in `select'\nTerminate batch job (Y/N)? y\nTerminate batch job (Y/N)? y\n</code></pre>\n\n<p>I'm using Ruby 2.1.5 64 bit version. RubyDevKit, Sass, Bourbon. </p>\n\n<p>Any ideas how to fix this? I don't know much about Jekyll or ruby. Just starting out.</p>\n"}, {"tags": ["ruby", "variable-assignment", "local-variables"], "comments": [{"owner": {"reputation": 6687, "user_id": 6496010, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/4d564ef7fd53e4e76e5e520945dcc4c1?s=128&d=identicon&r=PG", "display_name": "davidhu", "link": "https://stackoverflow.com/users/6496010/davidhu"}, "edited": false, "score": 0, "creation_date": 1473206326, "post_id": 39357925, "comment_id": 66048544, "body": "why are you using <code>eval</code>? can&#39;t you just do <code>k.to_s = v.inspect</code>?"}, {"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "reply_to_user": {"reputation": 6687, "user_id": 6496010, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/4d564ef7fd53e4e76e5e520945dcc4c1?s=128&d=identicon&r=PG", "display_name": "davidhu", "link": "https://stackoverflow.com/users/6496010/davidhu"}, "edited": false, "score": 0, "creation_date": 1473231963, "post_id": 39357925, "comment_id": 66055551, "body": "@davidhu2000: There isn&#39;t a single class or module in the entire core or standard library which has a <code>to_s=</code> method defined. Nor does this have anything even remotely to do with setting local variables."}, {"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 0, "creation_date": 1473231986, "post_id": 39357925, "comment_id": 66055567, "body": "It doesn&#39;t matter how bad the idea is, since it doesn&#39;t work. There is no way to dynamically create local variables. You can only set ones which already exist."}, {"owner": {"reputation": 119, "user_id": 2697160, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/b8WNd.jpg?s=128&g=1", "display_name": "virnovus", "link": "https://stackoverflow.com/users/2697160/virnovus"}, "reply_to_user": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 0, "creation_date": 1473751330, "post_id": 39357925, "comment_id": 66249039, "body": "@j&#246;rg: From my original post: <i>Now, some local variables are already defined, but if the method returns new ones, they need to be overridden.</i>  So the variables would already be defined, and I would just be changing them."}, {"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 0, "creation_date": 1473751854, "post_id": 39357925, "comment_id": 66249324, "body": "The problem is not with the ones that are already defined, the problem is with the ones that aren&#39;t."}, {"owner": {"reputation": 119, "user_id": 2697160, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/b8WNd.jpg?s=128&g=1", "display_name": "virnovus", "link": "https://stackoverflow.com/users/2697160/virnovus"}, "reply_to_user": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 0, "creation_date": 1473800727, "post_id": 39357925, "comment_id": 66277101, "body": "@J&#246;rgWMittag Do you know what the  word &quot;overridden&quot; means?  I&#39;m clearly referring to variables that are already defined, and ONLY variables that are already defined.  No need to respond anymore, you clearly have nothing useful to contribute."}, {"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 0, "creation_date": 1473807708, "post_id": 39357925, "comment_id": 66279501, "body": "&quot;Overriden&quot; means &quot;specialized in a subclass&quot;, and I don&#39;t see how that&#39;s relevant here. In your question you say &quot;<b>some</b> local variables are already defined&quot;, and that part is trivial, it is covered in the Ruby documentation and has been asked and answered a dozen times already. In addition, you also say &quot;if the method returns <b>new ones</b>&quot;, and that&#39;s the part that simply won&#39;t work. You cannot create new local variables metaprogrammatically in Ruby. It was possible in Ruby 1.8 and before due to an accidental scope leak in <code>eval</code>, but that leak was plugged in Ruby 1.9 and exists no more."}], "owner": {"reputation": 119, "user_id": 2697160, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/b8WNd.jpg?s=128&g=1", "display_name": "virnovus", "link": "https://stackoverflow.com/users/2697160/virnovus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 47, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1473196353, "creation_date": 1473196353, "question_id": 39357925, "link": "https://stackoverflow.com/questions/39357925/setting-local-ruby-variables-from-a-method-or-procs-return-value", "title": "Setting local Ruby variables from a method or proc&#39;s return value", "body": "<p>Say I have a method or a lambda/proc that I want to call, and it's going to be returning a bunch of named values, presumably in a hash, because that's how it's normally done.  Now, some local variables are already defined, but if the method returns new ones, they need to be overridden.  Since it'd be tedious to go through the list of local variables and do a <code>x ||= h[\"x\"]</code> for each one, how bad of an idea would it be to just do this?</p>\n\n<pre><code>h.each_pair {|k,v| eval(\"#{k.to_s} = #{v.inspect}\") if [String, Symbol].include?(k.class)}\n</code></pre>\n\n<p>I don't think I'd use this for anything more complex than a nested hash, and maybe regexes or ranges at some point, although I might think about properly serializing the output in the future.  But assuming that all of this data is being generated internally, is there anything wrong with doing it this way?  Is there a better way of doing it?</p>\n\n<p>I'd be using it in multiple places, otherwise I wouldn't be going through all this trouble.</p>\n"}, {"tags": ["ruby", "chef-infra"], "comments": [{"owner": {"reputation": 34030, "user_id": 1993366, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/dGJXl.png?s=128&g=1", "display_name": "vikingsteve", "link": "https://stackoverflow.com/users/1993366/vikingsteve"}, "edited": false, "score": 0, "creation_date": 1473195985, "post_id": 39357698, "comment_id": 66045560, "body": "Downvoter, care to comment why? The question seems specific enough to me."}], "answers": [{"comments": [{"owner": {"reputation": 2359, "user_id": 3716049, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/8a4ddc2596b218b0bc7b3814ffa46836?s=128&d=identicon&r=PG&f=1", "display_name": "User 5842", "link": "https://stackoverflow.com/users/3716049/user-5842"}, "edited": false, "score": 0, "creation_date": 1473200982, "post_id": 39358309, "comment_id": 66047222, "body": "I should have mentioned that I wanted to be able to run this through a Ruby script. I&#39;m assuming you meant <code>|</code> as in the pipe special character in Unix?"}, {"owner": {"reputation": 43208, "user_id": 78722, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cf611565f0b79abd0b3dc200ad867661?s=128&d=identicon&r=PG", "display_name": "coderanger", "link": "https://stackoverflow.com/users/78722/coderanger"}, "reply_to_user": {"reputation": 2359, "user_id": 3716049, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/8a4ddc2596b218b0bc7b3814ffa46836?s=128&d=identicon&r=PG&f=1", "display_name": "User 5842", "link": "https://stackoverflow.com/users/3716049/user-5842"}, "edited": false, "score": 0, "creation_date": 1473201703, "post_id": 39358309, "comment_id": 66047390, "body": "No, I meant it in terms of Ruby, <code>Array#|</code> in Ruby does a set union operation which is what you want to do."}], "tags": [], "owner": {"reputation": 43208, "user_id": 78722, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cf611565f0b79abd0b3dc200ad867661?s=128&d=identicon&r=PG", "display_name": "coderanger", "link": "https://stackoverflow.com/users/78722/coderanger"}, "is_accepted": true, "score": 0, "last_activity_date": 1473198349, "creation_date": 1473198349, "answer_id": 39358309, "question_id": 39357698, "link": "https://stackoverflow.com/questions/39357698/check-for-unused-roles-in-chef-server/39358309#39358309", "title": "Check for unused roles in Chef Server", "body": "<p>Not directly, the best approach would be to do a search to grab the <code>roles</code> attribute for every node on your server and then <code>|</code> those together and compare to the list of role names.</p>\n"}], "owner": {"reputation": 2359, "user_id": 3716049, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/8a4ddc2596b218b0bc7b3814ffa46836?s=128&d=identicon&r=PG&f=1", "display_name": "User 5842", "link": "https://stackoverflow.com/users/3716049/user-5842"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 49, "favorite_count": 0, "accepted_answer_id": 39358309, "answer_count": 1, "score": 0, "last_activity_date": 1473200920, "creation_date": 1473195338, "last_edit_date": 1473200920, "question_id": 39357698, "link": "https://stackoverflow.com/questions/39357698/check-for-unused-roles-in-chef-server", "title": "Check for unused roles in Chef Server", "body": "<p>I was wondering if there were a way to check for roles that have not been assigned to any nodes in the Chef Server through a Ruby script.</p>\n\n<p>Thanks</p>\n"}, {"tags": ["ruby", "fibonacci"], "comments": [{"owner": {"reputation": 9786, "user_id": 485864, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f34b46a9a4723bdbc6e1fdcf71b08517?s=128&d=identicon&r=PG", "display_name": "vgoff", "link": "https://stackoverflow.com/users/485864/vgoff"}, "edited": false, "score": 2, "creation_date": 1473195016, "post_id": 39357508, "comment_id": 66045130, "body": "Should this be on <a href=\"https://codereview.stackexchange.com/\">code review</a>?  Unless it is code that is not working.  The title suggests it is, but questioning performance."}, {"owner": {"reputation": 685, "user_id": 2868284, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/76f42be013abf833273224eb4eaef29c?s=128&d=identicon&r=PG", "display_name": "cenouro", "link": "https://stackoverflow.com/users/2868284/cenouro"}, "edited": false, "score": 0, "creation_date": 1473195080, "post_id": 39357508, "comment_id": 66045161, "body": "Do you have a limit on memory? Are you allowed to employ memoization techniques? Only looking at your code, you could optimize the calls to <code>fib</code> on <code>fib_partial_sum</code>: there is some overlap of computation there."}, {"owner": {"reputation": 2393, "user_id": 5252715, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/173d75348dae4a3a945234ac0a528e37?s=128&d=identicon&r=PG", "display_name": "malexanders", "link": "https://stackoverflow.com/users/5252715/malexanders"}, "edited": false, "score": 0, "creation_date": 1473195089, "post_id": 39357508, "comment_id": 66045168, "body": "Maybe, I&#39;ve never used code review....I&#39;ll look into it"}, {"owner": {"reputation": 2393, "user_id": 5252715, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/173d75348dae4a3a945234ac0a528e37?s=128&d=identicon&r=PG", "display_name": "malexanders", "link": "https://stackoverflow.com/users/5252715/malexanders"}, "edited": false, "score": 0, "creation_date": 1473195186, "post_id": 39357508, "comment_id": 66045220, "body": "Yes there is a memory limit - it is presently failing on a memory usage limit. It also takes forever with large inputs."}, {"owner": {"reputation": 685, "user_id": 2868284, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/76f42be013abf833273224eb4eaef29c?s=128&d=identicon&r=PG", "display_name": "cenouro", "link": "https://stackoverflow.com/users/2868284/cenouro"}, "edited": false, "score": 0, "creation_date": 1473195280, "post_id": 39357508, "comment_id": 66045262, "body": "Well, you are basically computing <code>fib</code> for 1 through <code>m</code> then from 1 through <code>n</code>. You could implement (maybe with an inline iteration) from 1 through <code>m</code> then from <code>m</code> through <code>n</code>."}, {"owner": {"reputation": 685, "user_id": 2868284, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/76f42be013abf833273224eb4eaef29c?s=128&d=identicon&r=PG", "display_name": "cenouro", "link": "https://stackoverflow.com/users/2868284/cenouro"}, "edited": false, "score": 3, "creation_date": 1473195642, "post_id": 39357508, "comment_id": 66045414, "body": "By the way, do you have a reason for using an array on <code>fib</code>? Your function basically returns a number; you could easily do the same using two temporary variables instead of an array (which has overhead of allocation/reallocation and garbage collection and also a much larger memory footprint)."}, {"owner": {"reputation": 9030, "user_id": 5101476, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JCQrl.jpg?s=128&g=1", "display_name": "ice\u30c4", "link": "https://stackoverflow.com/users/5101476/ice%e3%83%84"}, "edited": false, "score": 0, "creation_date": 1473198803, "post_id": 39357508, "comment_id": 66046686, "body": "re your first method, why not write <code>a = [0,1]</code> instead and the parameter of your times block is redundant. Also this method doesn&#39;t return the correct number in the sequence. <code>n=3</code> should return 1 but returns 2. These points do not really help answer your question but will help refactor your code."}, {"owner": {"reputation": 182, "user_id": 3605817, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c278ac0b45517a82558f2aa745e93583?s=128&d=identicon&r=PG&f=1", "display_name": "nloveladyallen", "link": "https://stackoverflow.com/users/3605817/nloveladyallen"}, "edited": false, "score": 3, "creation_date": 1473198978, "post_id": 39357508, "comment_id": 66046755, "body": "The final digits of Fibonacci numbers repeat every sixty numbers, so you can replace n and m with n % 60 and m % 60. (You could really just use an array of the final digit sequence, but you&#39;re probably trying to learn algorithm techniques, so that might not be what you&#39;re looking for.)"}, {"owner": {"reputation": 2393, "user_id": 5252715, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/173d75348dae4a3a945234ac0a528e37?s=128&d=identicon&r=PG", "display_name": "malexanders", "link": "https://stackoverflow.com/users/5252715/malexanders"}, "reply_to_user": {"reputation": 9030, "user_id": 5101476, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JCQrl.jpg?s=128&g=1", "display_name": "ice\u30c4", "link": "https://stackoverflow.com/users/5101476/ice%e3%83%84"}, "edited": false, "score": 0, "creation_date": 1473199106, "post_id": 39357508, "comment_id": 66046792, "body": "@sagarpandya82, the assignment is using base 0...so f(2) is 2. I.E [0,1,1,2]"}, {"owner": {"reputation": 2393, "user_id": 5252715, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/173d75348dae4a3a945234ac0a528e37?s=128&d=identicon&r=PG", "display_name": "malexanders", "link": "https://stackoverflow.com/users/5252715/malexanders"}, "reply_to_user": {"reputation": 182, "user_id": 3605817, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c278ac0b45517a82558f2aa745e93583?s=128&d=identicon&r=PG&f=1", "display_name": "nloveladyallen", "link": "https://stackoverflow.com/users/3605817/nloveladyallen"}, "edited": false, "score": 0, "creation_date": 1473199157, "post_id": 39357508, "comment_id": 66046801, "body": "@nloveladyallen, this is exactly what I am trying to implement. Everything else runs to slow. I&#39;ll try your suggestion. Can I just add the array of final digit sequence together??"}, {"owner": {"reputation": 2393, "user_id": 5252715, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/173d75348dae4a3a945234ac0a528e37?s=128&d=identicon&r=PG", "display_name": "malexanders", "link": "https://stackoverflow.com/users/5252715/malexanders"}, "reply_to_user": {"reputation": 182, "user_id": 3605817, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c278ac0b45517a82558f2aa745e93583?s=128&d=identicon&r=PG&f=1", "display_name": "nloveladyallen", "link": "https://stackoverflow.com/users/3605817/nloveladyallen"}, "edited": false, "score": 0, "creation_date": 1473199817, "post_id": 39357508, "comment_id": 66046997, "body": "@nloveladyallen I added an updated using your suggestion, it was definitely an improvement, but not quite there yet. I need to figure out how to add together the remainders without actually storing the whole fibonacci number...I think"}, {"owner": {"reputation": 182, "user_id": 3605817, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c278ac0b45517a82558f2aa745e93583?s=128&d=identicon&r=PG&f=1", "display_name": "nloveladyallen", "link": "https://stackoverflow.com/users/3605817/nloveladyallen"}, "edited": false, "score": 1, "creation_date": 1473205517, "post_id": 39357508, "comment_id": 66048337, "body": "@matthewalexander It&#39;s failing on that input because you only changed the <code>else</code> in <code>fib_partial_sum</code> and in this case n = m. Change the <code>if</code> body to <code>fib(m % 60)</code> and it should work."}, {"owner": {"reputation": 2393, "user_id": 5252715, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/173d75348dae4a3a945234ac0a528e37?s=128&d=identicon&r=PG", "display_name": "malexanders", "link": "https://stackoverflow.com/users/5252715/malexanders"}, "reply_to_user": {"reputation": 182, "user_id": 3605817, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c278ac0b45517a82558f2aa745e93583?s=128&d=identicon&r=PG&f=1", "display_name": "nloveladyallen", "link": "https://stackoverflow.com/users/3605817/nloveladyallen"}, "edited": false, "score": 0, "creation_date": 1473206090, "post_id": 39357508, "comment_id": 66048480, "body": "@nloveladyallen, YES!! Thanks so much, spent the better part of today working on this."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "reply_to_user": {"reputation": 182, "user_id": 3605817, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c278ac0b45517a82558f2aa745e93583?s=128&d=identicon&r=PG&f=1", "display_name": "nloveladyallen", "link": "https://stackoverflow.com/users/3605817/nloveladyallen"}, "edited": false, "score": 0, "creation_date": 1473208282, "post_id": 39357508, "comment_id": 66048981, "body": "@nloveladyallen, if <code>m = 59</code> and <code>n = 60</code>, you suggest one can consider the range from <code>59</code> to <code>0</code>. What does that mean?"}, {"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 0, "creation_date": 1473208614, "post_id": 39357508, "comment_id": 66049050, "body": "Please don&#39;t add &quot;edit&quot; or &quot;update&quot; tags in your text because they&#39;re just visual noise. Instead, incorporate the change as if it&#39;d been in place when you initially created the question. We can tell what&#39;s been changed if we want to know. Also, adding a &quot;working solution&quot; doesn&#39;t really help; By selecting the appropriate answer you award that user. See &quot;<a href=\"http://meta.stackexchange.com/questions/5234/how-does-accepting-an-answer-work\">How does accepting an answer work?</a>&quot;. SO isn&#39;t a discussion board, it&#39;s an online reference, so we do things differently."}, {"owner": {"reputation": 182, "user_id": 3605817, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c278ac0b45517a82558f2aa745e93583?s=128&d=identicon&r=PG&f=1", "display_name": "nloveladyallen", "link": "https://stackoverflow.com/users/3605817/nloveladyallen"}, "reply_to_user": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1473209611, "post_id": 39357508, "comment_id": 66049230, "body": "@CarySwoveland That is correct. All that matters is the last digit of the number. f(60) is 1548008755920 and f(0) is 0, so they are the same for the purposes of this question."}, {"owner": {"reputation": 2393, "user_id": 5252715, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/173d75348dae4a3a945234ac0a528e37?s=128&d=identicon&r=PG", "display_name": "malexanders", "link": "https://stackoverflow.com/users/5252715/malexanders"}, "reply_to_user": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 0, "creation_date": 1473209784, "post_id": 39357508, "comment_id": 66049253, "body": "@theTinMan, thanks I&#39;ll remember for future posts. In this case, no one posted a working answer - I pieced it together from comments. I guess I should have posted the answer by clicking &#39;Answer your question&#39;?"}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1473262201, "post_id": 39357508, "comment_id": 66075924, "body": "I suggest you clean up your question, as many members may view it in future. Questions are not meant to changed, except for clarification. If you wish to offer a solution, make it an answer (which you may choose to accept with \u2705). If you revise your answer, remove the earlier one. I suggest your question end with &quot;Any insight is greatly appreciated.&quot; (without &quot;UPDATE: &quot; preceding &quot;This algorithm...&quot;) and your answer be the text following &quot;UPDATE, WORKING SOLUTION! Big thanks...&quot; You can acknowledge contributions in the question or in a comment. I prefer the latter, to keep answers clean."}, {"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 1, "creation_date": 1473272312, "post_id": 39357508, "comment_id": 66081345, "body": "<code>&quot;Any insight is greatly appreciated.&quot;</code> is also not desirable. While it&#39;s nice to express appreciation for help, SO, being a reference book and not a discussion board, has a bit more formal stance. Think of it as a text book or cookbook and write accordingly. Some familiarity and friendliness is welcome but signatures, greetings and thanks are not and get edited out."}, {"owner": {"reputation": 2393, "user_id": 5252715, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/173d75348dae4a3a945234ac0a528e37?s=128&d=identicon&r=PG", "display_name": "malexanders", "link": "https://stackoverflow.com/users/5252715/malexanders"}, "edited": false, "score": 0, "creation_date": 1473279083, "post_id": 39357508, "comment_id": 66084469, "body": "Thanks for all the tips guys - I&#39;ll make the suggested amendments."}], "answers": [{"comments": [{"owner": {"reputation": 2393, "user_id": 5252715, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/173d75348dae4a3a945234ac0a528e37?s=128&d=identicon&r=PG", "display_name": "malexanders", "link": "https://stackoverflow.com/users/5252715/malexanders"}, "edited": false, "score": 0, "creation_date": 1473198955, "post_id": 39358266, "comment_id": 66046745, "body": "fails on input 1, 2"}, {"owner": {"reputation": 2393, "user_id": 5252715, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/173d75348dae4a3a945234ac0a528e37?s=128&d=identicon&r=PG", "display_name": "malexanders", "link": "https://stackoverflow.com/users/5252715/malexanders"}, "edited": false, "score": 0, "creation_date": 1473202867, "post_id": 39358266, "comment_id": 66047682, "body": "fails on input 1, 3"}, {"owner": {"reputation": 2393, "user_id": 5252715, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/173d75348dae4a3a945234ac0a528e37?s=128&d=identicon&r=PG", "display_name": "malexanders", "link": "https://stackoverflow.com/users/5252715/malexanders"}, "edited": false, "score": 0, "creation_date": 1473206406, "post_id": 39358266, "comment_id": 66048570, "body": "Hi Cary - thanks so much for the effort, please see my latest update for the solution I was after. I had strict time and memory constraints to work with."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "reply_to_user": {"reputation": 2393, "user_id": 5252715, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/173d75348dae4a3a945234ac0a528e37?s=128&d=identicon&r=PG", "display_name": "malexanders", "link": "https://stackoverflow.com/users/5252715/malexanders"}, "edited": false, "score": 0, "creation_date": 1473214680, "post_id": 39358266, "comment_id": 66050093, "body": "I&#39;ve modified my code to incorporate @nloveladyallen&#39;s observation concerning the periodicity of the last digit of Fibonacci numbers."}], "tags": [], "owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "is_accepted": false, "score": 0, "last_activity_date": 1473317138, "last_edit_date": 1473317138, "creation_date": 1473198094, "answer_id": 39358266, "question_id": 39357508, "link": "https://stackoverflow.com/questions/39357508/partial-fibonacci-sum-how-to-improve-performance/39358266#39358266", "title": "Partial Fibonacci Sum, how to improve performance?", "body": "<p>The following requires only a single pass of the numbers between zero and at most <code>[n,m+60].min</code>, where <code>m..n</code> is the range of interest, and has a minimal memory requirement. It makes use of @nloveladyallen's observation that the last digit of Fibonacci numbers has a periodicity of 60.</p>\n\n<p><strong>Code</strong></p>\n\n<pre><code>def fib_last(m,n)\n  n -= 60*((n-m)/60)   \n  fib_sum(m,n) % 10\nend\n\ndef fib_sum(m,n)\n  return nil if m &lt; 0 || m &gt; n\n  return n if n &lt; 2\n  next_to_last, last = fib(m-1)\n  (m..n).reduce(0) do |tot,_|\n    current = next_to_last + last\n    next_to_last = last\n    last = current\n    tot + current\n  end\nend\n\ndef fib(m)\n  next_to_last, last = -1, 1\n  0.upto(m).each do |n|\n    current = next_to_last + last\n    next_to_last, last = last, current\n  end\n  [next_to_last, last]\nend\n</code></pre>\n\n<p><strong>Example</strong></p>\n\n<pre><code>m, n = 6, 12\n(n+1).times { |i| puts \"#{i}: #{fib(i)}\" }\n0:  [0,    0]\n1:  [0,    1]\n2:  [1,    1]\n3:  [1,    2]\n4:  [2,    3]\n5:  [3,    5]\n6:  [5,    8]\n7:  [8,   13]\n8:  [13,  21]\n9:  [21,  34]\n10: [34,  55]\n11: [55,  89]\n12: [89, 144]\n\nfib_last(6,12) #=&gt; 4 (fib_sum(6,12) #=&gt; 8 + 13 + 21 + 34 + 55 + 89 + 144 = 364)\nfib_last(1,2)  #=&gt; 2 (fib_sum(1,2)  #=&gt; 1 + 1 = 2)\nfib_last(1,3)  #=&gt; 4 (fib_sum(1,3)  #=&gt; 1 + 1 + 2 = 4) \nfib_last(1,4)  #=&gt; 7 (fib_sum(1,4)  #=&gt; 1 + 1 + 2 + 3 = 7)\nfib_last(2,3)  #=&gt; 3 (fib_sum(2,3)  #=&gt; 1 + 2 = 3)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2393, "user_id": 5252715, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/173d75348dae4a3a945234ac0a528e37?s=128&d=identicon&r=PG", "display_name": "malexanders", "link": "https://stackoverflow.com/users/5252715/malexanders"}, "is_accepted": false, "score": 1, "last_activity_date": 1473279398, "creation_date": 1473279398, "answer_id": 39378315, "question_id": 39357508, "link": "https://stackoverflow.com/questions/39357508/partial-fibonacci-sum-how-to-improve-performance/39378315#39378315", "title": "Partial Fibonacci Sum, how to improve performance?", "body": "<p>Here is a nice solution to the problem, it passes all time and memory constraints. \nThis way you never have to calculate a fib num greater that f(60). It can handle very large inputs efficiently.</p>\n\n<pre><code>def fib(n)\n    a, b = 0, 1\n    (n-1).times do\n        a, b = b, (a + b) % 10\n    end\n    b\nend\n\ndef fib_partial_sum(m, n)\n    if n == m\n        fib(m % 60)\n    else\n        m = m % 60\n        n = n % 60\n\n        m = fib(m + 1) - 1\n        n = fib(n + 2) - 1\n\n        (n - m) % 10\n    end\nend\n\nif __FILE__ == $0\n    m, n = gets.split().map(&amp;:to_i)\n    puts \"#{fib_partial_sum(m, n)}\"\nend\n</code></pre>\n\n<p>(Max time used: 0.05/5.00, max memory used: 8699904/536870912.)</p>\n"}], "owner": {"reputation": 2393, "user_id": 5252715, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/173d75348dae4a3a945234ac0a528e37?s=128&d=identicon&r=PG", "display_name": "malexanders", "link": "https://stackoverflow.com/users/5252715/malexanders"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 809, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1473317138, "creation_date": 1473194494, "last_edit_date": 1473304336, "question_id": 39357508, "link": "https://stackoverflow.com/questions/39357508/partial-fibonacci-sum-how-to-improve-performance", "title": "Partial Fibonacci Sum, how to improve performance?", "body": "<p>I need to improve the performance of this algorithm. I believe the answer lies in the application of the pisano period. </p>\n\n<p>This algorithm must return the last digit of the sum of fib numbers from f(m) to f(n).</p>\n\n<p>Here is what I have so far:</p>\n\n<pre><code>def fib(n)\n    a = []\n    a &lt;&lt; 0 &lt;&lt; 1\n    (n+1).times do |i|\n        a &lt;&lt; a[-1] + a[-2]\n    end\n     a[n]\nend\n\n\ndef fib_partial_sum(m, n)\n    if n == m\n        fib(m) % 10\n    else\n        m = fib(m + 1) - 1\n        n = fib(n + 2) - 1\n        (n - m) % 10\n    end\nend\n\nif __FILE__ == $0\n  m, n = gets.split().map(&amp;:to_i)\n  puts \"#{fib_partial_sum(m, n)}\"\nend\n</code></pre>\n\n<p>The last digit of any fib num repeats every 60 numbers. Therefore, we can do this,  n, m = n % 60, m % 60. An improvement, but not quite there yet, fails on input 567717153638 567717153638):</p>\n\n<pre><code>def fib(n)\n    a = []\n    a &lt;&lt; 0 &lt;&lt; 1\n    (n+1).times do |i|\n        a &lt;&lt; a[-1] + a[-2]\n    end\n     a[n]\nend\n\ndef fib_partial_sum(m, n)\n    if n == m\n        fib(m)\n    else\n        m = m % 60\n        n = n % 60\n\n        m = fib(m + 1) - 1\n        n = fib(n + 2) - 1\n        (n - m) % 10\n    end\nend\n\nif __FILE__ == $0\n  m, n = gets.split().map(&amp;:to_i)\n  puts \"#{fib_partial_sum(m, n)}\"\nend\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby"], "answers": [{"comments": [{"owner": {"reputation": 1538, "user_id": 655650, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/maO3T.jpg?s=128&g=1", "display_name": "Tass", "link": "https://stackoverflow.com/users/655650/tass"}, "edited": false, "score": 0, "creation_date": 1473275591, "post_id": 39357202, "comment_id": 66082823, "body": "I&#39;m a fan of <code>#pluck</code> but it&#39;s just not elegant in this case: <code>Inventory.where(item_ID:&#39;GXZ44&#39;, store_id:&#39;44555222&#39;).pluck.first</code>. Your solution is better."}], "tags": [], "owner": {"reputation": 4265, "user_id": 4601088, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/bN143.jpg?s=128&g=1", "display_name": "Bart\u0142omiej G\u0142adys", "link": "https://stackoverflow.com/users/4601088/bart%c5%82omiej-g%c5%82adys"}, "is_accepted": true, "score": 2, "last_activity_date": 1473193235, "creation_date": 1473193235, "answer_id": 39357202, "question_id": 39357084, "link": "https://stackoverflow.com/questions/39357084/how-to-get-only-the-value-from-a-rails-query/39357202#39357202", "title": "How to get only the value from a Rails query", "body": "<p>try this: </p>\n\n<pre><code>my_int =  Inventory.where(item_ID:'GXZ44', store_id:'44555222').first.amt_sold\n</code></pre>\n"}], "owner": {"reputation": 1551, "user_id": 5007300, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/d11148e73509997d34aca3951e1e62db?s=128&d=identicon&r=PG&f=1", "display_name": "myhouse", "link": "https://stackoverflow.com/users/5007300/myhouse"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 89, "favorite_count": 0, "accepted_answer_id": 39357202, "answer_count": 1, "score": 1, "last_activity_date": 1473193237, "creation_date": 1473192692, "last_edit_date": 1473193237, "question_id": 39357084, "link": "https://stackoverflow.com/questions/39357084/how-to-get-only-the-value-from-a-rails-query", "title": "How to get only the value from a Rails query", "body": "<p>I want to get the integer value from this query in rails.</p>\n\n<pre><code>Inventory.select(:amt_sold).where(item_ID:'GXZ44', store_id:'44555222')\n</code></pre>\n\n<p>On my controller, I am trying to select the amount sold from my inventory and I want to get only the integer value from the <code>amt_sold</code> column. When I run that query, I get: </p>\n\n<pre><code>&lt; Inventory id: nil, amt_sold: 175.0&gt; \n</code></pre>\n\n<p>How can I just get the 175.0 value as a integer to be able to do arithmetic operations on it?  </p>\n"}, {"tags": ["ruby-on-rails", "arrays", "ruby"], "answers": [{"tags": [], "owner": {"reputation": 1128, "user_id": 3973117, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f52a78aa4cf83a8372e28a27ce3511c?s=128&d=identicon&r=PG", "display_name": "jan.zikan", "link": "https://stackoverflow.com/users/3973117/jan-zikan"}, "is_accepted": false, "score": 1, "last_activity_date": 1473192028, "creation_date": 1473192028, "answer_id": 39356930, "question_id": 39356891, "link": "https://stackoverflow.com/questions/39356891/checking-for-individual-matching-elements-in-two-different-array/39356930#39356930", "title": "Checking for individual matching elements in two different array", "body": "<pre><code>arr1.any? { |item| arr2.include?(item) }\n</code></pre>\n\n<p>This will check if any item from first array is included in the second array.</p>\n"}, {"comments": [{"owner": {"reputation": 9030, "user_id": 5101476, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JCQrl.jpg?s=128&g=1", "display_name": "ice\u30c4", "link": "https://stackoverflow.com/users/5101476/ice%e3%83%84"}, "edited": false, "score": 0, "creation_date": 1473192400, "post_id": 39357003, "comment_id": 66043938, "body": "What do <code>&amp;</code> and <code>any?</code> do?"}, {"owner": {"reputation": 4265, "user_id": 4601088, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/bN143.jpg?s=128&g=1", "display_name": "Bart\u0142omiej G\u0142adys", "link": "https://stackoverflow.com/users/4601088/bart%c5%82omiej-g%c5%82adys"}, "reply_to_user": {"reputation": 9030, "user_id": 5101476, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JCQrl.jpg?s=128&g=1", "display_name": "ice\u30c4", "link": "https://stackoverflow.com/users/5101476/ice%e3%83%84"}, "edited": false, "score": 0, "creation_date": 1473192559, "post_id": 39357003, "comment_id": 66044011, "body": "<code>&amp;</code> is logic operator, if something element exist in two arrays, this return it.   <code>any?</code> checking  something element exist in array, if at least one, it return true"}, {"owner": {"reputation": 9030, "user_id": 5101476, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JCQrl.jpg?s=128&g=1", "display_name": "ice\u30c4", "link": "https://stackoverflow.com/users/5101476/ice%e3%83%84"}, "edited": false, "score": 0, "creation_date": 1473192844, "post_id": 39357003, "comment_id": 66044158, "body": "Thanks @BartekGladys. My point was that this information should be included in your neat solution to make it more complete:)"}], "tags": [], "owner": {"reputation": 4265, "user_id": 4601088, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/bN143.jpg?s=128&g=1", "display_name": "Bart\u0142omiej G\u0142adys", "link": "https://stackoverflow.com/users/4601088/bart%c5%82omiej-g%c5%82adys"}, "is_accepted": true, "score": 3, "last_activity_date": 1473193413, "last_edit_date": 1473193413, "creation_date": 1473192304, "answer_id": 39357003, "question_id": 39356891, "link": "https://stackoverflow.com/questions/39356891/checking-for-individual-matching-elements-in-two-different-array/39357003#39357003", "title": "Checking for individual matching elements in two different array", "body": "<p>I have found a good way to do this:</p>\n\n<pre><code>(arr1 &amp; arr2).any?\n</code></pre>\n\n<p><code>&amp;</code> is a logic operator, if some elements exist in both arrays, this will return these elements. </p>\n\n<p><code>any?</code> checks if any elements exist in the array. If there exists at least one, then it return <code>true</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 9030, "user_id": 5101476, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JCQrl.jpg?s=128&g=1", "display_name": "ice\u30c4", "link": "https://stackoverflow.com/users/5101476/ice%e3%83%84"}, "edited": false, "score": 0, "creation_date": 1473192972, "post_id": 39357065, "comment_id": 66044212, "body": "Which version of Ruby has the <code>present?</code> method included in the <code>Array</code> class?"}, {"owner": {"reputation": 4265, "user_id": 4601088, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/bN143.jpg?s=128&g=1", "display_name": "Bart\u0142omiej G\u0142adys", "link": "https://stackoverflow.com/users/4601088/bart%c5%82omiej-g%c5%82adys"}, "edited": false, "score": 0, "creation_date": 1473193005, "post_id": 39357065, "comment_id": 66044220, "body": "no method error, because <code>present?</code> is not included in Array class"}, {"owner": {"reputation": 445, "user_id": 5026941, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/IMpEg.jpg?s=128&g=1", "display_name": "BIlal Khan", "link": "https://stackoverflow.com/users/5026941/bilal-khan"}, "edited": false, "score": 0, "creation_date": 1473193369, "post_id": 39357065, "comment_id": 66044378, "body": "We have it in rails. We can do [1,2].present? which will return true."}, {"owner": {"reputation": 9030, "user_id": 5101476, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JCQrl.jpg?s=128&g=1", "display_name": "ice\u30c4", "link": "https://stackoverflow.com/users/5101476/ice%e3%83%84"}, "edited": false, "score": 0, "creation_date": 1473193534, "post_id": 39357065, "comment_id": 66044457, "body": "@BIlalKhan nice, +1. Under the hood is it exactly the same as <code>any?</code>"}], "tags": [], "owner": {"reputation": 445, "user_id": 5026941, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/IMpEg.jpg?s=128&g=1", "display_name": "BIlal Khan", "link": "https://stackoverflow.com/users/5026941/bilal-khan"}, "is_accepted": false, "score": 1, "last_activity_date": 1473192605, "creation_date": 1473192605, "answer_id": 39357065, "question_id": 39356891, "link": "https://stackoverflow.com/questions/39356891/checking-for-individual-matching-elements-in-two-different-array/39357065#39357065", "title": "Checking for individual matching elements in two different array", "body": "<p>You do this with intersection between two arrays and after this we can check if there are any matching elements in result. </p>\n\n<pre><code>(arr1 &amp; arr2).present?\n</code></pre>\n\n<p>In your case we have</p>\n\n<pre><code>arr1 = [\"dog\", \"cat\", \"bird\"]\n\narr2 = [\"fish\", \"bear\", \"bird\"]\n</code></pre>\n\n<p>Result can be like this:</p>\n\n<pre><code>(arr1 &amp; arr2).present?\n</code></pre>\n\n<p>It will return <code>['bird']</code>, so its not empty and the present? will return true.</p>\n"}], "owner": {"reputation": 6503, "user_id": 5650878, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/xh7BI.png?s=128&g=1", "display_name": "Bitwise", "link": "https://stackoverflow.com/users/5650878/bitwise"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 178, "favorite_count": 0, "accepted_answer_id": 39357003, "answer_count": 3, "score": 1, "last_activity_date": 1473193413, "creation_date": 1473191884, "question_id": 39356891, "link": "https://stackoverflow.com/questions/39356891/checking-for-individual-matching-elements-in-two-different-array", "title": "Checking for individual matching elements in two different array", "body": "<p>I have these two arrays</p>\n\n<p><code>arr1 = [\"dog\", \"cat\", \"bird\"]</code></p>\n\n<p><code>arr2 = [\"fish\", \"bear\", \"bird\"]</code></p>\n\n<p>Notice how the only matching element is \"bird\" from the two arrays. I want to find a check that will say if any elements are matching return true.</p>\n\n<p>For example this does not work <code>arr1.include?(arr2)</code> but looking for method that will.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "rubymine"], "comments": [{"owner": {"reputation": 12629, "user_id": 4739257, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/MdhEs.jpg?s=128&g=1", "display_name": "Ilya", "link": "https://stackoverflow.com/users/4739257/ilya"}, "edited": false, "score": 0, "creation_date": 1473191495, "post_id": 39356721, "comment_id": 66043528, "body": "did you create any migrations?"}, {"owner": {"reputation": 1119, "user_id": 6797534, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Tu8Gt9iJGt8/AAAAAAAAAAI/AAAAAAAAAI0/Diz261BzMYk/photo.jpg?sz=128", "display_name": "Ray Hamel", "link": "https://stackoverflow.com/users/6797534/ray-hamel"}, "edited": false, "score": 0, "creation_date": 1473191524, "post_id": 39356721, "comment_id": 66043539, "body": "Have you created any models or migrations?"}, {"owner": {"reputation": 3, "user_id": 3102003, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d628d186b3a574586cd37be06d29790?s=128&d=identicon&r=PG&f=1", "display_name": "user3102003", "link": "https://stackoverflow.com/users/3102003/user3102003"}, "edited": false, "score": 0, "creation_date": 1473191711, "post_id": 39356721, "comment_id": 66043631, "body": "I&#39;m currently following the <a href=\"http://guides.rubyonrails.org/getting_started.html\" rel=\"nofollow noreferrer\">guides.rubyonrails.org/getting_started.html</a> tutorial, and this happened at section 5, when I changed the routes.rb"}], "answers": [{"tags": [], "owner": {"reputation": 33, "user_id": 6688708, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/623dc5a937c8fa81394642a0c3b0c2db?s=128&d=identicon&r=PG&f=1", "display_name": "Filipe Santiago", "link": "https://stackoverflow.com/users/6688708/filipe-santiago"}, "is_accepted": false, "score": 0, "last_activity_date": 1473194949, "creation_date": 1473194949, "answer_id": 39357605, "question_id": 39356721, "link": "https://stackoverflow.com/questions/39356721/mysql-database-not-migrating/39357605#39357605", "title": "Mysql database not migrating", "body": "<pre><code>rake db:create\n</code></pre>\n\n<p>what do you mean by this?  i didn't find this command there.</p>\n\n<p>the 2 simple ways to have a database is to \"set it\" and then to \"create it\"</p>\n\n<p>by setting i mean with </p>\n\n<pre><code>rails g scaffold Name text:type text:type\n</code></pre>\n\n<p>or</p>\n\n<pre><code>rails g model Name text:type text:type\n</code></pre>\n\n<p>after that you need to \"create it\"</p>\n\n<p>running</p>\n\n<pre><code>rake db:migrate # on Rails 4\n</code></pre>\n\n<p>or</p>\n\n<pre><code>rails db:migrate # on Rails 5\n</code></pre>\n\n<p>About the RubyMine shortcuts i don't know, because i use sublime+terminal. But u can still use the terminal that RubyMine gives you</p>\n"}], "owner": {"reputation": 3, "user_id": 3102003, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d628d186b3a574586cd37be06d29790?s=128&d=identicon&r=PG&f=1", "display_name": "user3102003", "link": "https://stackoverflow.com/users/3102003/user3102003"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 41, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1473194949, "creation_date": 1473191208, "question_id": 39356721, "link": "https://stackoverflow.com/questions/39356721/mysql-database-not-migrating", "title": "Mysql database not migrating", "body": "<p>I created a project in RubyMine and created the database using <code>rake db:create</code>, then I tried doing <code>rake db:migrate</code> but nothing happened. The terminal just went on the next line.</p>\n\n<p>Under my db folder, are <code>schema.rb</code> and <code>seeds.rb</code>.</p>\n\n<p>This is what's in my database.yml (<a href=\"http://i.stack.imgur.com/XkafJ.png\" rel=\"nofollow\">link to screenshot</a>)</p>\n\n<p>This is what shows up when I run the server and go to localhost:3000 (<a href=\"http://i.stack.imgur.com/PkKOL.png\" rel=\"nofollow\">link to screenshot</a>)</p>\n"}, {"tags": ["arrays", "ruby", "performance", "permutation", "memory-efficient"], "comments": [{"owner": {"reputation": 79161, "user_id": 1064226, "user_type": "registered", "profile_image": "https://graph.facebook.com/36912842/picture?type=large", "display_name": "Frederick Cheung", "link": "https://stackoverflow.com/users/1064226/frederick-cheung"}, "edited": false, "score": 0, "creation_date": 1473194808, "post_id": 39356704, "comment_id": 66045019, "body": "brute forcing it seems rather inefficient since at each step there seem to be only a small number of elements in your array that are eligible (eg the first once must start with a). Your second question is unclear to me"}, {"owner": {"reputation": 13, "user_id": 6801100, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-SUV2z6gHdKU/AAAAAAAAAAI/AAAAAAAAACM/gpN-40HGs3M/photo.jpg?sz=128", "display_name": "Trismegisto", "link": "https://stackoverflow.com/users/6801100/trismegisto"}, "reply_to_user": {"reputation": 79161, "user_id": 1064226, "user_type": "registered", "profile_image": "https://graph.facebook.com/36912842/picture?type=large", "display_name": "Frederick Cheung", "link": "https://stackoverflow.com/users/1064226/frederick-cheung"}, "edited": false, "score": 0, "creation_date": 1473195740, "post_id": 39356704, "comment_id": 66045459, "body": "Hello Frederick, sorry for the second point. It is indeed very poorly written. I will edit it to make it clearer"}, {"owner": {"reputation": 481, "user_id": 1419464, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FlZVa.jpg?s=128&g=1", "display_name": "LukeS", "link": "https://stackoverflow.com/users/1419464/lukes"}, "edited": false, "score": 0, "creation_date": 1473205675, "post_id": 39356704, "comment_id": 66048381, "body": "Looks like a perfect use case for regexes!"}, {"owner": {"reputation": 32008, "user_id": 322020, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/dce43cb8158a14c3fed02bea797becd7?s=128&d=identicon&r=PG", "display_name": "Nakilon", "link": "https://stackoverflow.com/users/322020/nakilon"}, "edited": false, "score": 0, "creation_date": 1473207403, "post_id": 39356704, "comment_id": 66048803, "body": "What does &quot;huge repeated permutations&quot; mean?"}, {"owner": {"reputation": 13, "user_id": 6801100, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-SUV2z6gHdKU/AAAAAAAAAAI/AAAAAAAAACM/gpN-40HGs3M/photo.jpg?sz=128", "display_name": "Trismegisto", "link": "https://stackoverflow.com/users/6801100/trismegisto"}, "reply_to_user": {"reputation": 32008, "user_id": 322020, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/dce43cb8158a14c3fed02bea797becd7?s=128&d=identicon&r=PG", "display_name": "Nakilon", "link": "https://stackoverflow.com/users/322020/nakilon"}, "edited": false, "score": 0, "creation_date": 1473236044, "post_id": 39356704, "comment_id": 66057880, "body": "@Nakilon, what I meant is that by calling the method repeated_permutations(8) or more on the array, it creates too many possibilities and they crash the computer"}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 6801100, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-SUV2z6gHdKU/AAAAAAAAAAI/AAAAAAAAACM/gpN-40HGs3M/photo.jpg?sz=128", "display_name": "Trismegisto", "link": "https://stackoverflow.com/users/6801100/trismegisto"}, "edited": false, "score": 0, "creation_date": 1473241756, "post_id": 39359558, "comment_id": 66061475, "body": "Thank you for the answer @Nakilon, I find that it is slightly more useful than what I had before, but it still takes too long to load when looking at 8 or higher repeated permutations."}, {"owner": {"reputation": 32008, "user_id": 322020, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/dce43cb8158a14c3fed02bea797becd7?s=128&d=identicon&r=PG", "display_name": "Nakilon", "link": "https://stackoverflow.com/users/322020/nakilon"}, "reply_to_user": {"reputation": 13, "user_id": 6801100, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-SUV2z6gHdKU/AAAAAAAAAAI/AAAAAAAAACM/gpN-40HGs3M/photo.jpg?sz=128", "display_name": "Trismegisto", "link": "https://stackoverflow.com/users/6801100/trismegisto"}, "edited": false, "score": 0, "creation_date": 1474658659, "post_id": 39359558, "comment_id": 66637948, "body": "@Trismegisto, also note that sometimes these combinatoric methods from Ruby stdlib work better on sorted data: <a href=\"http://codereview.stackexchange.com/a/128788/665\">codereview.stackexchange.com/a/128788/665</a>"}], "tags": [], "owner": {"reputation": 32008, "user_id": 322020, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/dce43cb8158a14c3fed02bea797becd7?s=128&d=identicon&r=PG", "display_name": "Nakilon", "link": "https://stackoverflow.com/users/322020/nakilon"}, "is_accepted": true, "score": 0, "last_activity_date": 1473208178, "last_edit_date": 1492087236, "creation_date": 1473207295, "answer_id": 39359558, "question_id": 39356704, "link": "https://stackoverflow.com/questions/39356704/heavy-load-on-the-computer-caused-by-repeated-permutations/39359558#39359558", "title": "Heavy load on the computer caused by repeated permutations", "body": "<h2>I.</h2>\n\n<p>You can see that it is at first just an Enumerator (that never freezes your computer until you cast it to Array or iterate through it):</p>\n\n<pre><code>array.repeated_permutation(2)\n=&gt; #&lt;Enumerator: [\"ab\", \"bc\", \"cd\", \"de\", \"bd\", \"ae\"]:repeated_permutation(2)&gt;\n</code></pre>\n\n<p>And the <code>.map</code> converts is to Array. To avoid it you should either use the lazy block form:</p>\n\n<pre><code>array.repeated_permutation(2) do |a, b|\n  break [a, b].join if a[0] == source &amp;&amp; a[-1] == b[0] &amp;&amp; b[1] == target\nend\n</code></pre>\n\n<p>or better call <code>.find</code> on it, so it would return <code>nil</code> (that works like a <code>false</code> in condition statements) if can't find some:</p>\n\n<pre><code>array.repeated_permutation(2).find do |a, b|\n  a[0] == source &amp;&amp; a[-1] == b[0] &amp;&amp; b[1] == target\nend\n</code></pre>\n\n<h2>II.</h2>\n\n<p>I guess you want to find the path from one verticle to another in a graph.<br>\nI believe this was implemented in Ruby here a lot of times and you may have a look at the <a href=\"https://codereview.stackexchange.com/a/65068/665\">\"Optimizing breadth-first-search code\" question on Codereview site</a></p>\n"}], "owner": {"reputation": 13, "user_id": 6801100, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-SUV2z6gHdKU/AAAAAAAAAAI/AAAAAAAAACM/gpN-40HGs3M/photo.jpg?sz=128", "display_name": "Trismegisto", "link": "https://stackoverflow.com/users/6801100/trismegisto"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 85, "favorite_count": 0, "accepted_answer_id": 39359558, "answer_count": 1, "score": 1, "last_activity_date": 1473208539, "creation_date": 1473191160, "last_edit_date": 1473208539, "question_id": 39356704, "link": "https://stackoverflow.com/questions/39356704/heavy-load-on-the-computer-caused-by-repeated-permutations", "title": "Heavy load on the computer caused by repeated permutations", "body": "<p>I'm having the following problem, I want to make every possible combination in an array of strings, and return only a specific combination of elements within the total amount of combinations.</p>\n\n<p>The array looks something like this.</p>\n\n<pre><code>array = ['ab','bc','cd','de','bd','ae']\n</code></pre>\n\n<p>In this example, the input would be</p>\n\n<pre><code>source = 'a'   target = 'd'\n</code></pre>\n\n<p>And the code that I'm using right now to get the string I want is this.</p>\n\n<pre><code>(2..2).flat_map do |n|\n  array.repeated_permutation(n).map(&amp;:join).select do |string|\n    string[0] == source &amp;&amp; string[-1] == target &amp;&amp; string[1..2].squeeze.size == n - 1\n  end\nend\n</code></pre>\n\n<p>The output would look something like this</p>\n\n<pre><code>['abbd']\n</code></pre>\n\n<p>What I want to make sure when I select the strings, is that the last letter of a string is the first one of the next. </p>\n\n<p>Right now it works, but I'm encountering several issues,</p>\n\n<ol>\n<li><p>With huge repeated permutations, 8 or above, the computer just freezes, it is unable to handle such a huge amount of combinations, so I need a different approach to reduce the load.</p></li>\n<li><p>It is difficult to implement a selection procedure prior to the permutations to help reduce the load as it is after the repeated_permutations method is executed that the combinations are generated.</p></li>\n</ol>\n"}, {"tags": ["ruby-on-rails", "json", "ruby", "active-model-serializers"], "answers": [{"comments": [{"owner": {"reputation": 3201, "user_id": 2892779, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uvM8S.jpg?s=128&g=1", "display_name": "Jay Dorsey", "link": "https://stackoverflow.com/users/2892779/jay-dorsey"}, "edited": false, "score": 1, "creation_date": 1541107866, "post_id": 39356244, "comment_id": 93114547, "body": "This doesn&#39;t work, it uses the default serializer name when set to nil"}], "tags": [], "owner": {"reputation": 1002, "user_id": 5479988, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Z_oUVK4Wkuo/AAAAAAAAAAI/AAAAAAAAABA/vn2BD49K67M/photo.jpg?sz=128", "display_name": "Jim Van Fleet", "link": "https://stackoverflow.com/users/5479988/jim-van-fleet"}, "is_accepted": false, "score": -2, "last_activity_date": 1473189093, "last_edit_date": 1592644375, "creation_date": 1473189093, "answer_id": 39356244, "question_id": 39355279, "link": "https://stackoverflow.com/questions/39355279/disable-root-in-active-model-serializers/39356244#39356244", "title": "Disable root in active model serializers", "body": "<p>Per <a href=\"https://github.com/rails-api/active_model_serializers/blob/v0.10.2/docs/general/adapters.md#json\" rel=\"nofollow noreferrer\">the documentation</a>:</p>\n<blockquote>\n<p>The json response is always rendered with a root key.</p>\n<p>The root key can be overridden by:\npassing the root option in the render call. See details in the <a href=\"https://github.com/rails-api/active_model_serializers/blob/v0.10.2/docs/general/rendering.md#overriding-the-root-key\" rel=\"nofollow noreferrer\">Rendering Guides</a>.</p>\n</blockquote>\n<p>So a command like:</p>\n<pre><code>render json: @your_serializer, root: nil, adapter: :json\n</code></pre>\n<p>is worth a try.</p>\n"}, {"tags": [], "owner": {"reputation": 260, "user_id": 1156887, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oUanw.png?s=128&g=1", "display_name": "Terry Ray", "link": "https://stackoverflow.com/users/1156887/terry-ray"}, "is_accepted": false, "score": 1, "last_activity_date": 1477513566, "creation_date": 1477513566, "answer_id": 40271547, "question_id": 39355279, "link": "https://stackoverflow.com/questions/39355279/disable-root-in-active-model-serializers/40271547#40271547", "title": "Disable root in active model serializers", "body": "<p>I couldn't find a way to disable the root key when using the :json adapter. But, it sounds like you want to have some controller methods return meta data and other controller methods NOT return meta data, so you could use the default adapter (attributes) for methods with no meta data and then just declare the :json adapter on the controller methods where you need the meta data.</p>\n\n<p>So, something like:</p>\n\n<pre><code>render json: articles, meta: articles_meta_method(articles), adapter: :json\n</code></pre>\n\n<p>of course articles_meta_method would have to be defined somewhere.</p>\n\n<p>There's an example of using a meta method for pagination <a href=\"https://github.com/rails-api/active_model_serializers/blob/master/docs/howto/add_pagination_links.md\" rel=\"nofollow\">here</a></p>\n"}], "owner": {"reputation": 1542, "user_id": 525717, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/629c66393ea19b73d4624519b3e6b989?s=128&d=identicon&r=PG", "display_name": "user525717", "link": "https://stackoverflow.com/users/525717/user525717"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2599, "favorite_count": 0, "answer_count": 2, "score": 5, "last_activity_date": 1477513566, "creation_date": 1473185317, "question_id": 39355279, "link": "https://stackoverflow.com/questions/39355279/disable-root-in-active-model-serializers", "title": "Disable root in active model serializers", "body": "<p>I'm using active model serializers(0.10.2) with :json adapter because in two serializers I need meta tag(meta tag is not included in :attributes adapter), I have few more serializers where I don't want root, is it possible to disable root per serializer?</p>\n\n<p>Is it possible to use :json adapter in active model serializers v 0.10.2 and disable root?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "templates", "navbar"], "comments": [{"owner": {"reputation": 4369, "user_id": 248349, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f5c118aaeb5bb7162db613a37e595be8?s=128&d=identicon&r=PG", "display_name": "Mick", "link": "https://stackoverflow.com/users/248349/mick"}, "edited": false, "score": 1, "creation_date": 1473185323, "post_id": 39355210, "comment_id": 66040491, "body": "<a href=\"http://stackoverflow.com/questions/1924620/how-to-detect-if-rails-is-at-the-root-url\">How to detect if rails is at the root url</a>"}], "answers": [{"comments": [{"owner": {"reputation": 379, "user_id": 6567055, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-54co2AZ0T6Q/AAAAAAAAAAI/AAAAAAAASWI/ArbHxGqzEeo/photo.jpg?sz=128", "display_name": "Nathaniel Rand", "link": "https://stackoverflow.com/users/6567055/nathaniel-rand"}, "edited": false, "score": 0, "creation_date": 1473190442, "post_id": 39355260, "comment_id": 66043039, "body": "The multiple solutions are appreciated. Would you recommend a specific one for production use?"}, {"owner": {"reputation": 4265, "user_id": 4601088, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/bN143.jpg?s=128&g=1", "display_name": "Bart\u0142omiej G\u0142adys", "link": "https://stackoverflow.com/users/4601088/bart%c5%82omiej-g%c5%82adys"}, "reply_to_user": {"reputation": 379, "user_id": 6567055, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-54co2AZ0T6Q/AAAAAAAAAAI/AAAAAAAASWI/ArbHxGqzEeo/photo.jpg?sz=128", "display_name": "Nathaniel Rand", "link": "https://stackoverflow.com/users/6567055/nathaniel-rand"}, "edited": false, "score": 0, "creation_date": 1473190495, "post_id": 39355260, "comment_id": 66043065, "body": "if only for root i recommend for you last solution with <code>current_page?</code> method"}], "tags": [], "owner": {"reputation": 4265, "user_id": 4601088, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/bN143.jpg?s=128&g=1", "display_name": "Bart\u0142omiej G\u0142adys", "link": "https://stackoverflow.com/users/4601088/bart%c5%82omiej-g%c5%82adys"}, "is_accepted": true, "score": 1, "last_activity_date": 1473185946, "last_edit_date": 1473185946, "creation_date": 1473185206, "answer_id": 39355260, "question_id": 39355210, "link": "https://stackoverflow.com/questions/39355210/ruby-rails-hide-navbar-footer-on-root-page/39355260#39355260", "title": "Ruby / Rails - Hide Navbar &amp; Footer on Root Page", "body": "<p>try this in view <code>application.html.erb</code> : </p>\n\n<pre><code>&lt;% unless controller.controller_name == \"your_root_controller\" &amp;&amp; controller.action_name == \"your_action\" %&gt;\n  &lt;nav&gt; \n       #something\n  &lt;/nav&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>or even you can make in helper something method like this:</p>\n\n<pre><code>def root? \n controller.controller_name == \"your_root_controller\" &amp;&amp; controller.action_name == \"your_action\"\nend\n</code></pre>\n\n<p>and next in view <code>application.html.erb</code>:</p>\n\n<pre><code>if root?\n  #something html\nend\n</code></pre>\n\n<p>or you can also use <code>current_page?</code>method, and in this way:</p>\n\n<p>in view <code>application.html.erb</code></p>\n\n<pre><code>if current_page?(root_path)\n  # your html\nend\n</code></pre>\n"}], "owner": {"reputation": 379, "user_id": 6567055, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-54co2AZ0T6Q/AAAAAAAAAAI/AAAAAAAASWI/ArbHxGqzEeo/photo.jpg?sz=128", "display_name": "Nathaniel Rand", "link": "https://stackoverflow.com/users/6567055/nathaniel-rand"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 822, "favorite_count": 0, "closed_date": 1473187838, "accepted_answer_id": 39355260, "answer_count": 1, "score": 0, "last_activity_date": 1473185946, "creation_date": 1473184992, "question_id": 39355210, "link": "https://stackoverflow.com/questions/39355210/ruby-rails-hide-navbar-footer-on-root-page", "closed_reason": "Duplicate", "title": "Ruby / Rails - Hide Navbar &amp; Footer on Root Page", "body": "<p>I would like to hide the navbar and footer on the root page only. I am using RoR. I currently have my navbar in my application file to prevent repetitiveness. I assume a filter on my application controller? </p>\n"}, {"tags": ["javascript", "jquery", "ruby-on-rails", "ruby", "turbolinks"], "answers": [{"tags": [], "owner": {"reputation": 12542, "user_id": 156746, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/8TsPx.jpg?s=128&g=1", "display_name": "DiegoSalazar", "link": "https://stackoverflow.com/users/156746/diegosalazar"}, "is_accepted": true, "score": 1, "last_activity_date": 1473189577, "creation_date": 1473189577, "answer_id": 39356353, "question_id": 39355071, "link": "https://stackoverflow.com/questions/39355071/disabling-turobolinks-to-serve-page-specific-javascript/39356353#39356353", "title": "Disabling turobolinks to serve page specific javascript", "body": "<p>It is not recommended to serve page specific assets such as javascript. This slows down the user experience since navigating to a new page triggers another asset download. </p>\n\n<p>The whole point of the Rails Asset Pipeline is to gather your assets, minify them and concatenate them all into a single file that the browser downloads only once, the first time a user navigates to your page.</p>\n\n<p>Yes, use jQuery to check if certain elements exist to run some behavior. </p>\n\n<p>The way I've found useful is to not think about js behaviors as page specific but rather, widget specific. e.g. if there's a sortable table in the DOM then initialize the sortable table widget i.e. <code>$(\".sortable\").sortable()</code></p>\n\n<p>The above example uses the <a href=\"https://learn.jquery.com/plugins/basic-plugin-creation/\" rel=\"nofollow\">jQuery plugins</a> pattern. Place your behavior/widget logic inside the jQuery plugin and it will only run when the selector finds elements e.g. <code>$(\"#nonexistant\").something()</code>, <code>something()</code> will not be called. <code>$(\"#definitelyExists\").somethingElse()</code>, <code>somethingElse()</code> will be called. </p>\n\n<p>In the preceding examples, when an element is found and the function is called, the <code>this</code> of the function references the matched elements and you can run your behavior logic on them.</p>\n"}], "owner": {"reputation": 613, "user_id": 1732694, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/bQKtd.jpg?s=128&g=1", "display_name": "AntoineLev", "link": "https://stackoverflow.com/users/1732694/antoinelev"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 49, "favorite_count": 0, "accepted_answer_id": 39356353, "answer_count": 1, "score": 0, "last_activity_date": 1473189577, "creation_date": 1473184321, "question_id": 39355071, "link": "https://stackoverflow.com/questions/39355071/disabling-turobolinks-to-serve-page-specific-javascript", "title": "Disabling turobolinks to serve page specific javascript", "body": "<p>I you have a highly interactive event driven page in rails 5.0.0.1 with Turbolinks. \nHaving different interactions on different pages, events like window.resize will trigger on pages where I don't really need it. </p>\n\n<p>Is it worth to sacrifice navigation time by disabling Turbolinks to serve page specific javascript, or should I not care and just use if statement in Jquery to check if certain elements are present in the page using their ID.</p>\n\n<p>What is the rails way of doing this? </p>\n"}, {"tags": ["ruby-on-rails", "ruby", "actionview"], "comments": [{"owner": {"reputation": 23312, "user_id": 560215, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/bb365e8477053edcc55b40c3d27781d8?s=128&d=identicon&r=PG", "display_name": "sevenseacat", "link": "https://stackoverflow.com/users/560215/sevenseacat"}, "edited": false, "score": 0, "creation_date": 1493541100, "post_id": 39354741, "comment_id": 74453505, "body": "Given the error is coming from the stylesheet inclusion line, can you add your stylesheet to the question?"}], "answers": [{"comments": [{"owner": {"reputation": 23312, "user_id": 560215, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/bb365e8477053edcc55b40c3d27781d8?s=128&d=identicon&r=PG", "display_name": "sevenseacat", "link": "https://stackoverflow.com/users/560215/sevenseacat"}, "edited": false, "score": 0, "creation_date": 1493540885, "post_id": 41411638, "comment_id": 74453446, "body": "This is plainly wrong. The error will go away, but now you&#39;ll have no stylesheets/JavaScript in your app."}], "tags": [], "owner": {"reputation": 62, "user_id": 1397125, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/815e3859e5106e5432bed821c602f5a4?s=128&d=identicon&r=PG", "display_name": "Dataminded", "link": "https://stackoverflow.com/users/1397125/dataminded"}, "is_accepted": false, "score": -2, "last_activity_date": 1483217514, "creation_date": 1483217514, "answer_id": 41411638, "question_id": 39354741, "link": "https://stackoverflow.com/questions/39354741/actionview-template-error-object-not-supported/41411638#41411638", "title": "ActionView: :Template: :Error Object not supported", "body": "<p>You need to change 'application' to 'default' in lines 6 and 7.</p>\n\n<p><code>\n&lt;%= stylesheet_link_tag    'default', media: 'all', 'data-turbolinks-track': 'reload' %&gt;\n&lt;%= javascript_include_tag 'default', 'data-turbolinks-track': 'reload' %&gt;</code></p>\n"}, {"comments": [{"owner": {"reputation": 23312, "user_id": 560215, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/bb365e8477053edcc55b40c3d27781d8?s=128&d=identicon&r=PG", "display_name": "sevenseacat", "link": "https://stackoverflow.com/users/560215/sevenseacat"}, "edited": false, "score": 0, "creation_date": 1493541109, "post_id": 43704414, "comment_id": 74453512, "body": "it&#39;s not the same error, so I doubt the fix will be the same."}, {"owner": {"reputation": 2839, "user_id": 3903274, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/KwCf3.jpg?s=128&g=1", "display_name": "Sticky", "link": "https://stackoverflow.com/users/3903274/sticky"}, "edited": false, "score": 0, "creation_date": 1493541213, "post_id": 43704414, "comment_id": 74453538, "body": "I&#39;m not sure if it&#39;s same error because My error is same as this one in that the stylesheet has problems loading but when I remove the <code>&#47;&#47;= require_tree .</code> from <code>application.js</code> the problem goes away. The quick fix solution is identical."}, {"owner": {"reputation": 23312, "user_id": 560215, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/bb365e8477053edcc55b40c3d27781d8?s=128&d=identicon&r=PG", "display_name": "sevenseacat", "link": "https://stackoverflow.com/users/560215/sevenseacat"}, "edited": false, "score": 0, "creation_date": 1493541296, "post_id": 43704414, "comment_id": 74453559, "body": "That&#39;s another way to avoid the problem without actually fixing it. If you want JavaScript in your app, don&#39;t do that."}, {"owner": {"reputation": 2839, "user_id": 3903274, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/KwCf3.jpg?s=128&g=1", "display_name": "Sticky", "link": "https://stackoverflow.com/users/3903274/sticky"}, "edited": false, "score": 0, "creation_date": 1493541611, "post_id": 43704414, "comment_id": 74453638, "body": "Ok I changed my answer quite a bit after trying a few more things and clarifying. Pls no downvote, I try my best"}], "tags": [], "owner": {"reputation": 2839, "user_id": 3903274, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/KwCf3.jpg?s=128&g=1", "display_name": "Sticky", "link": "https://stackoverflow.com/users/3903274/sticky"}, "is_accepted": false, "score": 1, "last_activity_date": 1495651375, "last_edit_date": 1495651375, "creation_date": 1493540689, "answer_id": 43704414, "question_id": 39354741, "link": "https://stackoverflow.com/questions/39354741/actionview-template-error-object-not-supported/43704414#43704414", "title": "ActionView: :Template: :Error Object not supported", "body": "<p>I think this <a href=\"https://stackoverflow.com/questions/12520456/execjsruntimeerror-on-windows-trying-to-follow-rubytutorial\">SO post</a> has some good details into understanding the problem. I had the exact issue and followed the stack trace and it seemed the cause is from <code>execjs</code>. However what differs is that changing <code>runtimes.rb</code> does NOT fix the issue. Removing the <code>//= require_tree .</code> does fix but that is not right solution either as it is quick fix. </p>\n\n<p>One working good solution is to install Node and I <a href=\"https://github.com/sstephenson/execjs/issues/81#issuecomment-9892952\" rel=\"nofollow noreferrer\">have heard</a> this fixes the problem. I can confirm this fixed the problem for me. I think it has to do with the <code>runtimes.rb</code> file and how the default JS env on Windows sucks.</p>\n"}], "owner": {"reputation": 53, "user_id": 6794595, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0da76d56f063a57df1efd97e86c37815?s=128&d=identicon&r=PG&f=1", "display_name": "M. Vega", "link": "https://stackoverflow.com/users/6794595/m-vega"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 887, "favorite_count": 0, "answer_count": 2, "score": 3, "last_activity_date": 1495651375, "creation_date": 1473183017, "question_id": 39354741, "link": "https://stackoverflow.com/questions/39354741/actionview-template-error-object-not-supported", "title": "ActionView: :Template: :Error Object not supported", "body": "<p>I have been struggling to find an answer to this question, obviously I haven't done it yet. I tried coding my first little bit, I can open the server with no problem but as I open it, but insted of showing me what I coded, the server tells me:\nTypeError: Object doesn't support this property or method\nExtracted source (around line #7):</p>\n\n<pre><code>    CTYPE html&gt;\n&lt;html&gt;\n  &lt;head&gt;\n    &lt;title&gt;Programar101&lt;/title&gt;\n    &lt;%= csrf_meta_tags %&gt;\n\n    &lt;%= stylesheet_link_tag    'application', media: 'all', 'data-turbolinks-track': 'reload' %&gt;\n    &lt;%= javascript_include_tag 'application', 'data-turbolinks-track': 'reload' %&gt;\n  &lt;/head&gt;\n\n  &lt;body&gt;\n    &lt;%= yield %&gt;\n  &lt;/body&gt;\n&lt;/html&gt;\n</code></pre>\n\n<p>In my command prompt, when the error occurs, it gives me this:</p>\n\n<pre><code>ActionView::Template::Error (TypeError: Object doesn't support this property or method):\n    4:     &lt;title&gt;APP&lt;/title&gt;\n    5:     &lt;%= csrf_meta_tags %&gt;\n    6:\n    7:     &lt;%= stylesheet_link_tag    'application', media: 'all', 'data-turbolinks-track': 'reload' %&gt;\n    8:     &lt;%= javascript_include_tag 'application', 'data-turbolinks-track': 'reload' %&gt;\n    9:   &lt;/head&gt;\n   10:\n\napp/views/layouts/application.html.erb:7:in `_app_views_layouts_application_html_erb__332994069_78270120'\n  Rendering C:/RailsInstaller/Ruby2.2.0/lib/ruby/gems/2.2.0/gems/actionpack-5.0.0.1/lib/action_dispatch/middleware/templates/rescues/template_error.html.erb within rescues/layout\n  Rendering C:/RailsInstaller/Ruby2.2.0/lib/ruby/gems/2.2.0/gems/actionpack-5.0.0.1/lib/action_dispatch/middleware/templates/rescues/_source.html.erb\n  Rendered C:/RailsInstaller/Ruby2.2.0/lib/ruby/gems/2.2.0/gems/actionpack-5.0.0.1/lib/action_dispatch/middleware/templates/rescues/_source.html.erb (60.1ms)\n  Rendering C:/RailsInstaller/Ruby2.2.0/lib/ruby/gems/2.2.0/gems/actionpack-5.0.0.1/lib/action_dispatch/middleware/templates/rescues/_trace.html.erb\n  Rendered C:/RailsInstaller/Ruby2.2.0/lib/ruby/gems/2.2.0/gems/actionpack-5.0.0.1/lib/action_dispatch/middleware/templates/rescues/_trace.html.erb (32.6ms)\n  Rendering C:/RailsInstaller/Ruby2.2.0/lib/ruby/gems/2.2.0/gems/actionpack-5.0.0.1/lib/action_dispatch/middleware/templates/rescues/_request_and_response.html.erb\n  Rendered C:/RailsInstaller/Ruby2.2.0/lib/ruby/gems/2.2.0/gems/actionpack-5.0.0.1/lib/action_dispatch/middleware/templates/rescues/_request_and_response.html.erb (3.0ms)\n  Rendered C:/RailsInstaller/Ruby2.2.0/lib/ruby/gems/2.2.0/gems/actionpack-5.0.0.1/lib/action_dispatch/middleware/templates/rescues/template_error.html.erb within rescues/layout (5146.8ms)\n</code></pre>\n\n<p>Thank you in advance</p>\n"}, {"tags": ["ruby", "debugging", "break"], "comments": [{"owner": {"reputation": 3715, "user_id": 1241334, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/fCjAE.jpg?s=128&g=1", "display_name": "Jonny Henly", "link": "https://stackoverflow.com/users/1241334/jonny-henly"}, "edited": false, "score": 1, "creation_date": 1473183276, "post_id": 39354654, "comment_id": 66039479, "body": "You should break out of the loop if the correct user id and password are found, otherwise the next line will be checked and be incorrect."}, {"owner": {"reputation": 191, "user_id": 5361886, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/c903839a228dc28f8d835f401233f66f?s=128&d=identicon&r=PG&f=1", "display_name": "Spandan", "link": "https://stackoverflow.com/users/5361886/spandan"}, "reply_to_user": {"reputation": 3715, "user_id": 1241334, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/fCjAE.jpg?s=128&g=1", "display_name": "Jonny Henly", "link": "https://stackoverflow.com/users/1241334/jonny-henly"}, "edited": false, "score": 0, "creation_date": 1473183492, "post_id": 39354654, "comment_id": 66039600, "body": "@JonnyHenly: yes, there is this problem, I cannot break in ruby. There is a &quot;break if (condition)&quot; but that does not allow executing a block level statement like &quot;login_status = 1&quot;. How to break and execute something at the same time?"}, {"owner": {"reputation": 3715, "user_id": 1241334, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/fCjAE.jpg?s=128&g=1", "display_name": "Jonny Henly", "link": "https://stackoverflow.com/users/1241334/jonny-henly"}, "edited": false, "score": 0, "creation_date": 1473183986, "post_id": 39354654, "comment_id": 66039865, "body": "Can&#39;t you just use <code>break</code>, by itself? <a href=\"http://stackoverflow.com/questions/8502397/ruby-syntax-break-out-from-each-do-block\" title=\"ruby syntax break out from each do block\">stackoverflow.com/questions/8502397/&hellip;</a>"}, {"owner": {"reputation": 91121, "user_id": 179125, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5594142dcc49a24b1902ec8059181f8d?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan Running", "link": "https://stackoverflow.com/users/179125/jordan-running"}, "edited": false, "score": 2, "creation_date": 1473184651, "post_id": 39354654, "comment_id": 66040200, "body": "You certainly can break in Ruby. If you want <code>login_status</code> to be visible outside the block, you need to initialize it outside (before) the block. You don&#39;t need to &quot;break and execute something at the same time.&quot; Execute something, then break."}, {"owner": {"reputation": 191, "user_id": 5361886, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/c903839a228dc28f8d835f401233f66f?s=128&d=identicon&r=PG&f=1", "display_name": "Spandan", "link": "https://stackoverflow.com/users/5361886/spandan"}, "reply_to_user": {"reputation": 91121, "user_id": 179125, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5594142dcc49a24b1902ec8059181f8d?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan Running", "link": "https://stackoverflow.com/users/179125/jordan-running"}, "edited": false, "score": 0, "creation_date": 1473184869, "post_id": 39354654, "comment_id": 66040288, "body": "@Jordan: Exactly. Oh sorry <code>login_status</code> is already initialized outside in my original code at home. But as you mentioned. I need to execute something and break. Like <code>if (x), then do (y) break</code> - but I can&#39;t find that in ruby."}, {"owner": {"reputation": 191, "user_id": 5361886, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/c903839a228dc28f8d835f401233f66f?s=128&d=identicon&r=PG&f=1", "display_name": "Spandan", "link": "https://stackoverflow.com/users/5361886/spandan"}, "reply_to_user": {"reputation": 3715, "user_id": 1241334, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/fCjAE.jpg?s=128&g=1", "display_name": "Jonny Henly", "link": "https://stackoverflow.com/users/1241334/jonny-henly"}, "edited": false, "score": 0, "creation_date": 1473185370, "post_id": 39354654, "comment_id": 66040506, "body": "@JonnyHenly - I don&#39;t want the <code>break if (condition)</code>. I want to execute something such that <code>if (condition), then do something, then break</code>. Doesn&#39;t Ruby have anything functionally equivalent to this syntax?"}, {"owner": {"reputation": 3715, "user_id": 1241334, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/fCjAE.jpg?s=128&g=1", "display_name": "Jonny Henly", "link": "https://stackoverflow.com/users/1241334/jonny-henly"}, "edited": false, "score": 2, "creation_date": 1473185684, "post_id": 39354654, "comment_id": 66040651, "body": "Add <code>break</code> in a new line under the <code>login_saatus = 1</code> line."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1473185890, "post_id": 39354654, "comment_id": 66040765, "body": "<code>line.chomp!</code> once and then use <code>line</code>. There&#39;s no reason to <code>chomp</code> over and over and over and over again."}, {"owner": {"reputation": 25573, "user_id": 676874, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/c8e67ec01dc3e7c402255ff26785863f?s=128&d=identicon&r=PG", "display_name": "knut", "link": "https://stackoverflow.com/users/676874/knut"}, "edited": false, "score": 0, "creation_date": 1473186260, "post_id": 39354654, "comment_id": 66040953, "body": "Instead of multiple <code>if (login_status == )</code> you could use <code>case login_status</code> and use <code>when</code>-statements,"}, {"owner": {"reputation": 191, "user_id": 5361886, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/c903839a228dc28f8d835f401233f66f?s=128&d=identicon&r=PG&f=1", "display_name": "Spandan", "link": "https://stackoverflow.com/users/5361886/spandan"}, "reply_to_user": {"reputation": 25573, "user_id": 676874, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/c8e67ec01dc3e7c402255ff26785863f?s=128&d=identicon&r=PG", "display_name": "knut", "link": "https://stackoverflow.com/users/676874/knut"}, "edited": false, "score": 0, "creation_date": 1473186427, "post_id": 39354654, "comment_id": 66041031, "body": "@knut @tadman - I am already incorporating all your suggestions into my original code, but please help me with the <code>break</code>. I can&#39;t understand why I can&#39;t break it like in <b>C</b> or <b>Java</b>"}, {"owner": {"reputation": 91121, "user_id": 179125, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5594142dcc49a24b1902ec8059181f8d?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan Running", "link": "https://stackoverflow.com/users/179125/jordan-running"}, "reply_to_user": {"reputation": 3715, "user_id": 1241334, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/fCjAE.jpg?s=128&g=1", "display_name": "Jonny Henly", "link": "https://stackoverflow.com/users/1241334/jonny-henly"}, "edited": false, "score": 1, "creation_date": 1473186728, "post_id": 39354654, "comment_id": 66041179, "body": "@JonnyHenly has already explained the solution to your problem. You can do as many things as you want between <code>if</code> and <code>elsif</code>. Set <code>login_status</code> on one line and <code>break</code> on the next: <code>if condition1; do something; break; elsif condition2; do another thing; break; ...</code> (but with newlines instead of semicolons)."}], "answers": [{"comments": [{"owner": {"reputation": 191, "user_id": 5361886, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/c903839a228dc28f8d835f401233f66f?s=128&d=identicon&r=PG&f=1", "display_name": "Spandan", "link": "https://stackoverflow.com/users/5361886/spandan"}, "edited": false, "score": 0, "creation_date": 1473188145, "post_id": 39355714, "comment_id": 66041976, "body": "can a <code>File.each_line do... end</code> be considered a loop? Because I am trying to write the <code>if</code> conditions inside this <code>do... end</code> block"}, {"owner": {"reputation": 25573, "user_id": 676874, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/c8e67ec01dc3e7c402255ff26785863f?s=128&d=identicon&r=PG", "display_name": "knut", "link": "https://stackoverflow.com/users/676874/knut"}, "reply_to_user": {"reputation": 191, "user_id": 5361886, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/c903839a228dc28f8d835f401233f66f?s=128&d=identicon&r=PG&f=1", "display_name": "Spandan", "link": "https://stackoverflow.com/users/5361886/spandan"}, "edited": false, "score": 0, "creation_date": 1473188268, "post_id": 39355714, "comment_id": 66042031, "body": "Just try it - and yes, it can."}], "tags": [], "owner": {"reputation": 25573, "user_id": 676874, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/c8e67ec01dc3e7c402255ff26785863f?s=128&d=identicon&r=PG", "display_name": "knut", "link": "https://stackoverflow.com/users/676874/knut"}, "is_accepted": false, "score": 2, "last_activity_date": 1473189762, "last_edit_date": 1473189762, "creation_date": 1473186970, "answer_id": 39355714, "question_id": 39354654, "link": "https://stackoverflow.com/questions/39354654/ruby-how-to-execute-something-and-then-break-inside-if-block/39355714#39355714", "title": "Ruby - How to Execute something and then Break inside IF block?", "body": "<p>It depends on what you need and where you need it.</p>\n\n<p>A script like this:</p>\n\n<pre><code>condition = 1\ncase condition\n  when 1\n    puts 'one'\n    break\n  when 2\n    puts 'two'\n  else\n    puts 'Other %s' % condition\n  end\n\nputs 'end'\n</code></pre>\n\n<p>has a syntax error. <code>break</code> leaves a loop and there is no loop. </p>\n\n<p>But with a loop, this works:</p>\n\n<pre><code>[1,2,3].each{|condition|\n  case condition\n    when 1\n      puts 'one'\n      break\n    when 2\n      puts 'two'\n    else\n      puts 'Other %s' % condition\n    end\n    puts 'end'\n  }\n  puts 'very end'\n</code></pre>\n\n<p>The output is:</p>\n\n<pre><code>one\nvery end\n</code></pre>\n\n<p>You see, the loop is stopped.</p>\n\n<p>If you want to continue the loop with the next element, you need <code>next</code> (sorry, I'm just not aware what <code>break</code> is doing really in Java - it's been a long time since my last Java program):</p>\n\n<pre><code>[1,2,3].each{|condition|\n  case condition\n    when 1\n      puts 'one'\n      next\n    when 2\n      puts 'two'\n    else\n      puts 'Other %s' % condition\n    end\n    puts 'end %s' % condition\n  }\n  puts 'very end'\n</code></pre>\n\n<p>The result:</p>\n\n<pre><code>one\ntwo\nend 2\nOther 3\nend 3\nvery end\n</code></pre>\n\n<p>When you are not inside a loop (like in your code snippet), you may use <code>exit</code> (leave the program) or <code>return</code> (leave a method).</p>\n"}], "owner": {"reputation": 191, "user_id": 5361886, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/c903839a228dc28f8d835f401233f66f?s=128&d=identicon&r=PG&f=1", "display_name": "Spandan", "link": "https://stackoverflow.com/users/5361886/spandan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1312, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1473189762, "creation_date": 1473182667, "last_edit_date": 1473186270, "question_id": 39354654, "link": "https://stackoverflow.com/questions/39354654/ruby-how-to-execute-something-and-then-break-inside-if-block", "title": "Ruby - How to Execute something and then Break inside IF block?", "body": "<p><strong>EDIT:</strong> Someone pointed out that I needed to <code>break</code> correctly so I am editing the question<br/><br/>\n<strong>Scenario:</strong><br/>\nPlease see following code:<br/></p>\n\n<pre><code>print \"UserID: \"\nuid = $stdin.gets.chomp\nprint \"Password: \"\npwd = $stdin.gets.chomp\nusr_inp =  \"#{uid};#{pwd}\"\nlogin_status = -1\n# login_info.txt - \"#{userid};#{password}\" - format\nFile.open(File.join(File.dirname(__FILE__), 'login_info.txt'), \"r\") do |f|\n    f.each_line do |line|\n        puts line\n        if (line.chomp == usr_inp)\n            login_status = 1\n        elsif (line.chomp != usr_inp &amp;&amp; line.include?(uid)) #case a person inputs invalid password\n            login_status = 0\n        elsif (line.chomp != usr_inp &amp;&amp; !(line.include?(uid))) #case a person inputs an invalid id\n            login_status = 2\n        end\n    end\nend\nif (login_status == 1)\n    puts \"\\nLogged in successfully: #{uid}\"\nelsif (login_status == 2)\n    puts \"\\nSorry, that Employee does not exist.\"\nelsif (login_status == 0)\n    puts \"\\nLogin failed.\\nPlease check credentials.\"\nend\n</code></pre>\n\n<p><strong>Problem:</strong><br/>\n<code>break if (condition)</code> exists in Ruby. But I don't waht that.<br/>\nI want to do something like:</p>\n\n<pre><code>if (condition x)\n    (do something)\n    break\nelsif (condition y)\n    (do something else)\n    break\nelse\n    (whatever)\nend\n</code></pre>\n\n<p>Maybe I am not understanding how ruby code works. Whenever I try to put the <code>break</code> as I want to use it, it associates with the next <code>elsif</code>.<br/>\n<strong>Please help.</strong></p>\n"}, {"tags": ["ruby", "erb"], "comments": [{"owner": {"reputation": 53905, "user_id": 2864740, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/e7a05a144f218bde07b659bc98e1ca7d?s=128&d=identicon&r=PG&f=1", "display_name": "user2864740", "link": "https://stackoverflow.com/users/2864740/user2864740"}, "edited": false, "score": 0, "creation_date": 1473181587, "post_id": 39354320, "comment_id": 66038546, "body": "There is no <a href=\"http://ruby-doc.org/core-2.2.0/String.html\" rel=\"nofollow noreferrer\"><code>String#join</code></a> method, as the error says. The code is likely expecting an Array; the error shows a <i>string representation</i> of some kind of (JSON) array - fix that."}], "answers": [{"comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1473182760, "post_id": 39354494, "comment_id": 66039174, "body": "Worth noting that patterns like <code>&quot;#{x}&quot;</code> are almost always mistakes. Pass through that variable as-is. If you need to convert to a string: <code>x.to_s</code> instead."}], "tags": [], "owner": {"reputation": 208794, "user_id": 229044, "user_type": "moderator", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/591426cbbacd4025d920467bad356911?s=128&d=identicon&r=PG&f=1", "display_name": "meagar", "link": "https://stackoverflow.com/users/229044/meagar"}, "is_accepted": false, "score": 2, "last_activity_date": 1473182105, "creation_date": 1473182105, "answer_id": 39354494, "question_id": 39354320, "link": "https://stackoverflow.com/questions/39354320/ruby-insert-an-array-into-initialize-method-undefined-method-join-for-str/39354494#39354494", "title": "ruby - insert an array into initialize method - undefined method `join&#39; for :String (NoMethodError)", "body": "<p>You're passing a string representation of your array into your Erbfile class. You then invoke <code>.join</code> on that string.</p>\n\n<p>If you want to receive an array in your class, you need to <em>pass in</em> an array.</p>\n\n<p>Replace  <code>Erbfile.new(\"#{ec2}\")</code> with <code>Erbfile.new(ec2)</code>.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user6558246"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 392, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1473182716, "creation_date": 1473181386, "last_edit_date": 1473182716, "question_id": 39354320, "link": "https://stackoverflow.com/questions/39354320/ruby-insert-an-array-into-initialize-method-undefined-method-join-for-str", "title": "ruby - insert an array into initialize method - undefined method `join&#39; for :String (NoMethodError)", "body": "<p>I try to pass an array as argument and use it in my ERB file.</p>\n\n<pre><code>class Erbfile\n  def initialize ec2\n    @ec2 = ec2\n    #@ec2 = [\"Cleveland\", \"Denver\", \"Nashville\"] #this one work\n    @template = File.read('./file.erb')\n  end\n  def render\n      ERB.new(@template).result( binding )\n  end\nend\n\nec2=[]\nec2.instances.each do |instance|\n  tag_name = Facter::Util::Resolution.exec(\"...\")\n  mystring = \"#{tag_name}\"\n  ec2 &lt;&lt; mystring\n  puts \"#{ec2_without_tags}\"        ### [\"test.ec2.mycomany.int\"]\n  @page = Erbfile.new(\"#{ec2}\")\nend\n</code></pre>\n\n<p>I use in the ERB file:</p>\n\n<pre><code>&lt;th&gt; &lt;%= @ec2.join('&lt;br /&gt;') %&gt; &lt;/th&gt;\n</code></pre>\n\n<p>And i get an error:</p>\n\n<pre><code>(erb):20:in `render': undefined method `join' for \"[\\\"test.ec2.mycomany.int\\\"]\":String (NoMethodError)\nDid you mean?  JSON\n</code></pre>\n\n<p>but if I will insert an array manually into the initialize method, it will work.</p>\n\n<pre><code>@ec2 = [\"Cleveland\", \"Denver\", \"Nashville\"]\n</code></pre>\n\n<p>What am I doing wrong ?</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 91121, "user_id": 179125, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5594142dcc49a24b1902ec8059181f8d?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan Running", "link": "https://stackoverflow.com/users/179125/jordan-running"}, "edited": false, "score": 3, "creation_date": 1473181967, "post_id": 39354307, "comment_id": 66038760, "body": "<i>In what way</i> is it not working? When you <code>puts</code> the command instead of calling <code>exec</code> on it, what do you see? Is <code>$USER_HOME</code> an environment variable or a Ruby global? Did you mean <code>ENV[&#39;USER_HOME&#39;]</code> instead?"}, {"owner": {"reputation": 935, "user_id": 2095793, "user_type": "registered", "accept_rate": 21, "profile_image": "https://www.gravatar.com/avatar/98ec2ef665b7e86cd22ed73e5c149fbd?s=128&d=identicon&r=PG", "display_name": "itsh", "link": "https://stackoverflow.com/users/2095793/itsh"}, "reply_to_user": {"reputation": 91121, "user_id": 179125, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5594142dcc49a24b1902ec8059181f8d?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan Running", "link": "https://stackoverflow.com/users/179125/jordan-running"}, "edited": false, "score": 0, "creation_date": 1473182485, "post_id": 39354307, "comment_id": 66039024, "body": "<code>$USER_HOE</code> is not an environment variable. It is suppose to be the path from where user is suppose to run the tool. <code>puts</code> is not printing anything."}, {"owner": {"reputation": 91121, "user_id": 179125, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5594142dcc49a24b1902ec8059181f8d?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan Running", "link": "https://stackoverflow.com/users/179125/jordan-running"}, "edited": false, "score": 0, "creation_date": 1473182671, "post_id": 39354307, "comment_id": 66039126, "body": "Where is <code>$USER_HOME</code> being set? What is its value when this line of code is reached? If this line is being reached then something <i>should</i> be printed if you replace <code>exec</code> with <code>puts</code>\u2014if not the command, then an error message. If nothing is printed then this line of code isn&#39;t being reached, which means your error is elsewhere."}, {"owner": {"reputation": 935, "user_id": 2095793, "user_type": "registered", "accept_rate": 21, "profile_image": "https://www.gravatar.com/avatar/98ec2ef665b7e86cd22ed73e5c149fbd?s=128&d=identicon&r=PG", "display_name": "itsh", "link": "https://stackoverflow.com/users/2095793/itsh"}, "reply_to_user": {"reputation": 91121, "user_id": 179125, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5594142dcc49a24b1902ec8059181f8d?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan Running", "link": "https://stackoverflow.com/users/179125/jordan-running"}, "edited": false, "score": 0, "creation_date": 1473189794, "post_id": 39354307, "comment_id": 66042744, "body": "@Jordan, thank you. I tried to include more <code>puts</code> for debugging purpose and looks like it is failing at the previous line which is similar to what I mentioned earlier i.e., <code>exec(&quot;grep -E \\&quot;&#47;platform&#47;app_name\\&quot; config.txt | grep \\&quot;username\\&quot; &gt; .sub_config.txt ; echo $?&quot;)</code>. Looks like it is running this command successfully by creating the <code>txt</code> and returning <code>exit code 0</code>. But then erroring out by saying <code>org.jruby.exceptions.MainExitException: aborted</code>. What could be the reason? I need more direction on this."}], "owner": {"reputation": 935, "user_id": 2095793, "user_type": "registered", "accept_rate": 21, "profile_image": "https://www.gravatar.com/avatar/98ec2ef665b7e86cd22ed73e5c149fbd?s=128&d=identicon&r=PG", "display_name": "itsh", "link": "https://stackoverflow.com/users/2095793/itsh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 40, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1473181335, "creation_date": 1473181335, "question_id": 39354307, "link": "https://stackoverflow.com/questions/39354307/unix-grep-is-failing-in-ruby", "title": "Unix grep is failing in Ruby", "body": "<p>I am trying to use Unix <code>grep</code> in my ruby code which I am able to run my shell terminal but it is not working when I am calling it through my <code>ruby code</code>. Can someone help me finding the problem?</p>\n\n<p>I am trying to read the lines that match the pattern that starts with <code>/platform/app_name</code> and ends with <code>username or service_name or hostname or port</code> in <code>config.txt</code> file and write them into <code>sub_config.txt</code> file. Below is the piece of code that is blocking me right now.</p>\n\n<pre><code>exec (\"cd #{$USER_HOME}; grep -E \\'(^/platform/app_name/.*/username) | (^/platform/app_name/.*/port) | (^/platform/app_name/.*/service_name) | (^/platform/app_name/.*/hostname) \\' config.txt &gt; .sub_config.txt\")\n</code></pre>\n"}, {"tags": ["ruby", "jruby", "irb"], "comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1473180680, "post_id": 39354008, "comment_id": 66038017, "body": "What version of the OS are you using? I can&#39;t reproduce that on my machine (OS X 10.11, JRuby 9.1.2.0). Is it possible your terminal has some odd setting?"}, {"owner": {"reputation": 171, "user_id": 4100422, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/5c4976b8f46b3ed1958ec966aaaeb631?s=128&d=identicon&r=PG&f=1", "display_name": "hphu", "link": "https://stackoverflow.com/users/4100422/hphu"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1473181233, "post_id": 39354008, "comment_id": 66038371, "body": "I am also using iterm but also reproduced it on bash"}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1473181299, "post_id": 39354008, "comment_id": 66038409, "body": "iTerm is your terminal. <code>bash</code> is your shell. These two are only tangentally related."}, {"owner": {"reputation": 171, "user_id": 4100422, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/5c4976b8f46b3ed1958ec966aaaeb631?s=128&d=identicon&r=PG&f=1", "display_name": "hphu", "link": "https://stackoverflow.com/users/4100422/hphu"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1473181963, "post_id": 39354008, "comment_id": 66038757, "body": "I meant default mac terminal"}], "answers": [{"comments": [{"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1473181581, "post_id": 39354206, "comment_id": 66038544, "body": "The preferences for which piece of software?  Built-in Terminal app has no Advanced tab (for me, at least)"}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "reply_to_user": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 1, "creation_date": 1473182345, "post_id": 39354206, "comment_id": 66038954, "body": "@SergioTulentsev Under &quot;Profiles&quot; select the one you&#39;re using, then switch to the &quot;Advanced&quot; tab there. This is in the stock Terminal app."}, {"owner": {"reputation": 171, "user_id": 4100422, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/5c4976b8f46b3ed1958ec966aaaeb631?s=128&d=identicon&r=PG&f=1", "display_name": "hphu", "link": "https://stackoverflow.com/users/4100422/hphu"}, "edited": false, "score": 0, "creation_date": 1473182719, "post_id": 39354206, "comment_id": 66039148, "body": "This didn&#39;t fix the issue for me"}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1473182886, "post_id": 39354206, "comment_id": 66039247, "body": "Is it possible you have some really wonky <code>stty</code> settings? <code>stty -icrnl</code> causes the <code>^M</code> behaviour for me, <code>stty icrnl</code> fixes it."}, {"owner": {"reputation": 171, "user_id": 4100422, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/5c4976b8f46b3ed1958ec966aaaeb631?s=128&d=identicon&r=PG&f=1", "display_name": "hphu", "link": "https://stackoverflow.com/users/4100422/hphu"}, "edited": false, "score": 0, "creation_date": 1473187056, "post_id": 39354206, "comment_id": 66041358, "body": "tried toggling the <code>stty icrnl</code> but that doesn&#39;t seem to be the issue either"}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1473196118, "post_id": 39354206, "comment_id": 66045615, "body": "Can you reproduce it on other machines? Is this a recent phenomenon?"}], "tags": [], "owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "is_accepted": false, "score": 0, "last_activity_date": 1473180930, "creation_date": 1473180930, "answer_id": 39354206, "question_id": 39354008, "link": "https://stackoverflow.com/questions/39354008/jruby-irb-newline-r-instead-of-n/39354206#39354206", "title": "jruby irb newline \\r instead of \\n", "body": "<p>I was able to reproduce this by pasting in text from another Terminal window and fixed it by disabling the \"Paste newlines as carriage returns\" option under <em>Input</em> of the Advanced tab of the preferences.</p>\n"}], "owner": {"reputation": 171, "user_id": 4100422, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/5c4976b8f46b3ed1958ec966aaaeb631?s=128&d=identicon&r=PG&f=1", "display_name": "hphu", "link": "https://stackoverflow.com/users/4100422/hphu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 135, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1473180930, "creation_date": 1473180182, "question_id": 39354008, "link": "https://stackoverflow.com/questions/39354008/jruby-irb-newline-r-instead-of-n", "title": "jruby irb newline \\r instead of \\n", "body": "<p>Using jruby 9.1.2.0 irb I get ^M instead of \\n when hitting the return key.</p>\n\n<p>To reproduce:\nRun jruby irb \ni.e. \n<code>java -jar jruby-complete-9.1.2.0-complete.jar -S irb</code></p>\n\n<pre><code>&gt; gets\nenteranyinputhere\n</code></pre>\n\n<p>hit the enter or return key and observe</p>\n\n<pre><code>&gt; gets\nenteranyinputhere^M\n</code></pre>\n\n<p>when I expect</p>\n\n<pre><code>&gt; gets\nanyinputhere\n=&gt; \"anyinputhere\\n\"\n</code></pre>\n\n<p>This makes it impossible to gets any input at all. It might have something to do with Mac inputting <code>\\r</code> instead of <code>\\n</code> when hitting enter</p>\n\n<pre><code>&gt; gets(\"\\r\").chomp\nfoo^M=&gt; \"foo\"\n</code></pre>\n\n<p>I also observed this issue with the latest jruby version 9.1.4.0</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-4", "activerecord", "controller"], "comments": [{"owner": {"reputation": 2202, "user_id": 3607039, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/8Bj3I.jpg?s=128&g=1", "display_name": "Bustikiller", "link": "https://stackoverflow.com/users/3607039/bustikiller"}, "edited": false, "score": 0, "creation_date": 1473183993, "post_id": 39353525, "comment_id": 66039871, "body": "I have to say that it is very confusing having two variables with the same name <code>user</code> and <code>@user</code>. I would try to avoid that, it will avoid many headaches."}, {"owner": {"reputation": 2202, "user_id": 3607039, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/8Bj3I.jpg?s=128&g=1", "display_name": "Bustikiller", "link": "https://stackoverflow.com/users/3607039/bustikiller"}, "edited": false, "score": 0, "creation_date": 1473184033, "post_id": 39353525, "comment_id": 66039896, "body": "By the way, I think you don&#39;t really want to write <code>@userfavorite_user_path</code> but <code>userfavorite_user_path</code>"}, {"owner": {"reputation": 159, "user_id": 6789165, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/2390e9333ab37c397ce2b94840de5864?s=128&d=identicon&r=PG&f=1", "display_name": "Gugubaight", "link": "https://stackoverflow.com/users/6789165/gugubaight"}, "reply_to_user": {"reputation": 2202, "user_id": 3607039, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/8Bj3I.jpg?s=128&g=1", "display_name": "Bustikiller", "link": "https://stackoverflow.com/users/3607039/bustikiller"}, "edited": false, "score": 0, "creation_date": 1473184462, "post_id": 39353525, "comment_id": 66040113, "body": "You&#39;re right! I just focused on @User to just get it appear - thanks!"}], "answers": [{"comments": [{"owner": {"reputation": 159, "user_id": 6789165, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/2390e9333ab37c397ce2b94840de5864?s=128&d=identicon&r=PG&f=1", "display_name": "Gugubaight", "link": "https://stackoverflow.com/users/6789165/gugubaight"}, "edited": false, "score": 0, "creation_date": 1473192867, "post_id": 39355442, "comment_id": 66044166, "body": "That works (at least in the controller // don&#39;t gives an error there). But I can&#39;t select attributes like username for example with this solution"}, {"owner": {"reputation": 3728, "user_id": 2612713, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/0a7f606f9e135589780620d1160d941e?s=128&d=identicon&r=PG&f=1", "display_name": "neo", "link": "https://stackoverflow.com/users/2612713/neo"}, "reply_to_user": {"reputation": 159, "user_id": 6789165, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/2390e9333ab37c397ce2b94840de5864?s=128&d=identicon&r=PG&f=1", "display_name": "Gugubaight", "link": "https://stackoverflow.com/users/6789165/gugubaight"}, "edited": false, "score": 0, "creation_date": 1473193184, "post_id": 39355442, "comment_id": 66044302, "body": "It&#39;s a collection, you&#39;ll have to loop thought it"}, {"owner": {"reputation": 159, "user_id": 6789165, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/2390e9333ab37c397ce2b94840de5864?s=128&d=identicon&r=PG&f=1", "display_name": "Gugubaight", "link": "https://stackoverflow.com/users/6789165/gugubaight"}, "edited": false, "score": 0, "creation_date": 1473224525, "post_id": 39355442, "comment_id": 66052252, "body": "That&#39;s what I am doing, but I also want to access certain attributes of an user item in that loop (username)"}, {"owner": {"reputation": 159, "user_id": 6789165, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/2390e9333ab37c397ce2b94840de5864?s=128&d=identicon&r=PG&f=1", "display_name": "Gugubaight", "link": "https://stackoverflow.com/users/6789165/gugubaight"}, "edited": false, "score": 0, "creation_date": 1473249760, "post_id": 39355442, "comment_id": 66066670, "body": "In <i>app/views/tools/index.html</i> I would like to output the username of the User: neither <code>@favorite_users.username</code> nor <code>@favorite_users.user.username</code> works ..."}], "tags": [], "owner": {"reputation": 3728, "user_id": 2612713, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/0a7f606f9e135589780620d1160d941e?s=128&d=identicon&r=PG&f=1", "display_name": "neo", "link": "https://stackoverflow.com/users/2612713/neo"}, "is_accepted": false, "score": 1, "last_activity_date": 1473185898, "creation_date": 1473185898, "answer_id": 39355442, "question_id": 39353525, "link": "https://stackoverflow.com/questions/39353525/rails-4-error-activerecordrecordnotfound-couldnt-find-id/39355442#39355442", "title": "Rails 4 Error: ActiveRecord::RecordNotFound Couldn&#39;t find id=", "body": "<p>change this:</p>\n\n<pre><code>@user = current_user.favorite_user\n</code></pre>\n\n<p>to:</p>\n\n<pre><code>@favorite_users = current_user.favorite_users\n</code></pre>\n\n<p><code>user</code> has_many <code>favorite_users</code></p>\n\n<p>don't forget to rename the instance variable wherever <code>@user</code> was being called.</p>\n"}, {"tags": [], "owner": {"reputation": 159, "user_id": 6789165, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/2390e9333ab37c397ce2b94840de5864?s=128&d=identicon&r=PG&f=1", "display_name": "Gugubaight", "link": "https://stackoverflow.com/users/6789165/gugubaight"}, "is_accepted": true, "score": 0, "last_activity_date": 1473347779, "creation_date": 1473347779, "answer_id": 39394659, "question_id": 39353525, "link": "https://stackoverflow.com/questions/39353525/rails-4-error-activerecordrecordnotfound-couldnt-find-id/39394659#39394659", "title": "Rails 4 Error: ActiveRecord::RecordNotFound Couldn&#39;t find id=", "body": "<p>That's the solution!</p>\n\n<pre><code>@userfavorites = current_user.userfavorites\n</code></pre>\n"}], "owner": {"reputation": 159, "user_id": 6789165, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/2390e9333ab37c397ce2b94840de5864?s=128&d=identicon&r=PG&f=1", "display_name": "Gugubaight", "link": "https://stackoverflow.com/users/6789165/gugubaight"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 166, "favorite_count": 0, "accepted_answer_id": 39394659, "answer_count": 2, "score": 0, "last_activity_date": 1473347779, "creation_date": 1473178457, "last_edit_date": 1473184490, "question_id": 39353525, "link": "https://stackoverflow.com/questions/39353525/rails-4-error-activerecordrecordnotfound-couldnt-find-id", "title": "Rails 4 Error: ActiveRecord::RecordNotFound Couldn&#39;t find id=", "body": "<p>I'm fairly new to rails and into coding my first app. Just can't figure out how to target a user the current_user favorited (Three models: User, Tool, FavoriteUser).</p>\n\n<p>Controller (Tools)</p>\n\n<pre><code>def index\n  @favorites = current_user.favorites.order(\"created_at DESC\")\n  @userfavorites = current_user.userfavorites.order(\"created_at DESC\")\n  @tools = Tool.where(user_id: current_user).order(\"created_at DESC\")\n  @user = current_user.favorite_user # problematic!\n  @cuser = current_user\nend\n</code></pre>\n\n<p>Index View (Tools)</p>\n\n<pre><code>%h2 My Favorite Users\n- @userfavorites.each do |user|\n    = image_tag gravatar_for @user if @user.use_gravatar == true\n    = image_tag @user.avatar_filename.url if @user.use_gravatar == false\n    %h2= link_to @user.username, @user\n    %p= link_to \"Favorite\", userfavorite_user_path(user, type: \"favorite\"), method: :get\n    %p= link_to \"Unfavorite\", userfavorite_user_path(user, type: \"unfavorite\"), method: :get\n</code></pre>\n\n<p>If I run this in my browser it appears following error:</p>\n\n<pre><code>NoMethodError in ToolsController#index\nundefined method `favorite_user' for #&lt;User:0x39df638&gt;\n</code></pre>\n\n<p><strong>FavoriteUser Database:</strong></p>\n\n<pre><code>user_id:integer #favorited\nc_user_id:integer #active user\n</code></pre>\n\n<p>I simply can't figure it out.<br><br>\nThanks in advance for your help!</p>\n\n<p><strong>RELATIONSHIPS:</strong></p>\n\n<p><em>user.rb</em></p>\n\n<pre><code>has_many :favorite_users # just the 'relationships'\n  # Favorite users of user\n  has_many :favorite_relationships, class_name: \"FavoriteUser\", foreign_key: \"c_user_id\"\n  has_many :userfavorites, through: :favorite_relationships, source: :user\n\n  # Favorited by a user\n  has_many :favorited_relationships, class_name: \"FavoriteUser\", foreign_key: \"user_id\"\n  has_many :userfavorited_by, through: :favorited_relationships, source: :c_user\n</code></pre>\n\n<p><em>favorite_user.rb</em></p>\n\n<pre><code>class FavoriteUser &lt; ActiveRecord::Base\n    belongs_to :c_user, class_name: \"User\"\n    belongs_to :user, class_name: \"User\"\nend\n</code></pre>\n\n<p><strong>ROUTES</strong></p>\n\n<pre><code>Rails.application.routes.draw do\n  devise_for :users\n\n  get 'welcome/index'\n  resources :tools do\n    member do \n      get \"like\", to: \"tools#upvote\"\n      get \"dislike\", to: \"tools#downvote\"\n    end\n    get :favorite, on: :member\n  end\n\n  resources :users, only: [:index, :show] do \n    get :userfavorite, on: :member\n  end\n\n  authenticated :user do\n    root 'tools#index', as: \"authenticated_root\"\n  end\n\n  root 'welcome#index'\n\n  get '/search' =&gt; 'tools#search'\n\n  get '/users' =&gt; 'users#index'\nend\n</code></pre>\n"}]