[{"tags": ["ruby-on-rails", "ruby", "activerecord", "devise"], "comments": [{"owner": {"reputation": 2216, "user_id": 7165275, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d8ad41f944f38348a30791dc7f7d02c?s=128&d=identicon&r=PG&f=1", "display_name": "m. simon borg", "link": "https://stackoverflow.com/users/7165275/m-simon-borg"}, "edited": false, "score": 0, "creation_date": 1501198854, "post_id": 45339248, "comment_id": 77686478, "body": "you can easily adapt your current roles using <code>enum</code> to single table inheritance."}], "answers": [{"comments": [{"owner": {"reputation": 2216, "user_id": 7165275, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d8ad41f944f38348a30791dc7f7d02c?s=128&d=identicon&r=PG&f=1", "display_name": "m. simon borg", "link": "https://stackoverflow.com/users/7165275/m-simon-borg"}, "reply_to_user": {"reputation": 6309, "user_id": 2263949, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eeab61900e08675dbd0d3a3fd8b56a0e?s=128&d=identicon&r=PG", "display_name": "Jonathan", "link": "https://stackoverflow.com/users/2263949/jonathan"}, "edited": false, "score": 1, "creation_date": 1501129642, "post_id": 45339611, "comment_id": 77644297, "body": "@Jonathan fair enough, improved the answer. thanks for the feedback"}, {"owner": {"reputation": 6309, "user_id": 2263949, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eeab61900e08675dbd0d3a3fd8b56a0e?s=128&d=identicon&r=PG", "display_name": "Jonathan", "link": "https://stackoverflow.com/users/2263949/jonathan"}, "edited": false, "score": 0, "creation_date": 1501129789, "post_id": 45339611, "comment_id": 77644348, "body": "Awesome job!  I just remove my flag."}, {"owner": {"reputation": 2216, "user_id": 7165275, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d8ad41f944f38348a30791dc7f7d02c?s=128&d=identicon&r=PG&f=1", "display_name": "m. simon borg", "link": "https://stackoverflow.com/users/7165275/m-simon-borg"}, "reply_to_user": {"reputation": 6309, "user_id": 2263949, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eeab61900e08675dbd0d3a3fd8b56a0e?s=128&d=identicon&r=PG", "display_name": "Jonathan", "link": "https://stackoverflow.com/users/2263949/jonathan"}, "edited": false, "score": 0, "creation_date": 1501129825, "post_id": 45339611, "comment_id": 77644363, "body": "Thank you! Still new around here : )"}, {"owner": {"reputation": 293, "user_id": 3901769, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/d6ycu.jpg?s=128&g=1", "display_name": "Talha Meh", "link": "https://stackoverflow.com/users/3901769/talha-meh"}, "edited": false, "score": 1, "creation_date": 1501144528, "post_id": 45339611, "comment_id": 77652118, "body": "@simon Thanks for the answer! What if i dont want to use type as a string but else want to go for a column type as integer and declaring enums in User model?"}, {"owner": {"reputation": 2216, "user_id": 7165275, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d8ad41f944f38348a30791dc7f7d02c?s=128&d=identicon&r=PG&f=1", "display_name": "m. simon borg", "link": "https://stackoverflow.com/users/7165275/m-simon-borg"}, "reply_to_user": {"reputation": 293, "user_id": 3901769, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/d6ycu.jpg?s=128&g=1", "display_name": "Talha Meh", "link": "https://stackoverflow.com/users/3901769/talha-meh"}, "edited": false, "score": 0, "creation_date": 1501339765, "post_id": 45339611, "comment_id": 77741706, "body": "@TalhaMeh was this helpful?"}, {"owner": {"reputation": 293, "user_id": 3901769, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/d6ycu.jpg?s=128&g=1", "display_name": "Talha Meh", "link": "https://stackoverflow.com/users/3901769/talha-meh"}, "edited": false, "score": 0, "creation_date": 1501416684, "post_id": 45339611, "comment_id": 77759886, "body": "@m.simonborg For my case,  yes its suits best i guess."}, {"owner": {"reputation": 2216, "user_id": 7165275, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d8ad41f944f38348a30791dc7f7d02c?s=128&d=identicon&r=PG&f=1", "display_name": "m. simon borg", "link": "https://stackoverflow.com/users/7165275/m-simon-borg"}, "reply_to_user": {"reputation": 293, "user_id": 3901769, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/d6ycu.jpg?s=128&g=1", "display_name": "Talha Meh", "link": "https://stackoverflow.com/users/3901769/talha-meh"}, "edited": false, "score": 0, "creation_date": 1501536375, "post_id": 45339611, "comment_id": 77812483, "body": "@TalhaMeh if you feel like it appropriately answers your question please accept the answer : )"}], "tags": [], "owner": {"reputation": 2216, "user_id": 7165275, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d8ad41f944f38348a30791dc7f7d02c?s=128&d=identicon&r=PG&f=1", "display_name": "m. simon borg", "link": "https://stackoverflow.com/users/7165275/m-simon-borg"}, "is_accepted": true, "score": 4, "last_activity_date": 1502360294, "last_edit_date": 1502360294, "creation_date": 1501116592, "answer_id": 45339611, "question_id": 45339248, "link": "https://stackoverflow.com/questions/45339248/same-model-with-different-columns-rails/45339611#45339611", "title": "Same Model with different columns Rails", "body": "<p>You probably want to look at Single Table Inheritance</p>\n\n<p>Try a <code>Developer</code> and <code>Driver</code> that both inherit from <code>User</code> and share one <code>users</code> database table. Each is effectively its own model, allowing you to define totally independent associations, callbacks, validations, instance methods, etc...</p>\n\n<p>They share all of the same database columns, and anything defined in the <code>User</code> class will be inherited (and can be overwritten).</p>\n\n<p>You will need to add a <code>type</code> column to <code>users</code>. All of the <code>Developer</code> and <code>Driver</code> columns fields should be defined for the <code>users</code> table as well.</p>\n\n<pre><code>class AddTypeColumnToUsers &lt; ActiveRecord::Migration\n  def change\n    add_column :users, :type, :string\n  end\nend\n</code></pre>\n\n<p>And your models</p>\n\n<pre><code>class User &lt; ApplicationRecord\nend\n\nclass Driver &lt; User\nend\n\nclass Developer &lt; User\nend\n\nDriver.new.type # =&gt; \"Driver\"\nDeveloper.new.type # =&gt; \"Developer\"\nUser.new.type # =&gt; nil\nUser.new(type: 'Driver').class # =&gt; Driver\nUser.new(type: 'Developer').class # =&gt; Developer\nUser.new.class # =&gt; User\n</code></pre>\n\n<p>You can run separate queries for them just as you would any other model</p>\n\n<pre><code>Developer.all # queries all users WHERE type=\"Developer\"\nDriver.all # queries all users WHERE type=\"Driver\"\nUser.all # queries all users no matter what type\n</code></pre>\n\n<p>Write your associations just as you would with any other model, and ActiveRecord will take care of everything else.</p>\n\n<pre><code>class Company &lt; ApplicationRecord\n  has_many :users\n  has_many :developers\n  has_many :drivers\nend\n\nclass User &lt; ApplicationRecord\n  belongs_to :company\nend\n\nclass Driver &lt; User\n  belongs_to :company\nend\n\nclass Developer &lt; User\n  belongs_to :company\nend\n\nc = Company.first\nc.developers # =&gt; All developers that belong to the Company\nc.drivers # =&gt; All drivers that belong to the Company\nc.users # =&gt; All users (including developers and drivers) that belong to the Company\n</code></pre>\n\n<p>You can also use <code>enum</code> for the <code>type</code> column, and override the default <code>type</code> column name if you wish</p>\n\n<pre><code>class AddTypeColumnToUsers &lt; ActiveRecord::Migration\n  def change\n    add_column :users, :role, :integer\n  end\nend\n\nclass User &lt; ApplicationRecord\n  self.inheritance_column = :role # This overrides the the \"type\" column name default\n\n  enum role: { Driver: 0, Developer: 1 }\nend\n\nclass Driver &lt; User\nend\n\nclass Developer &lt; User\nend\n</code></pre>\n\n<p>The catch with using <code>enum</code> is you will have to use the capitalized name, and all of your <code>enum</code> helper methods and scopes will be capitalized as well.</p>\n\n<pre><code>User.Driver # =&gt; Scope that returns all drivers\nDriver.all # =&gt; same as User.Driver\nUser.first.Driver? # =&gt; Is the user a Driver?\n</code></pre>\n\n<p><a href=\"http://api.rubyonrails.org/classes/ActiveRecord/Inheritance.html\" rel=\"nofollow noreferrer\">http://api.rubyonrails.org/classes/ActiveRecord/Inheritance.html</a></p>\n\n<p><a href=\"http://siawyoung.com/coding/ruby/rails/single-table-inheritance-in-rails-4.html\" rel=\"nofollow noreferrer\">http://siawyoung.com/coding/ruby/rails/single-table-inheritance-in-rails-4.html</a></p>\n"}, {"comments": [{"owner": {"reputation": 293, "user_id": 3901769, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/d6ycu.jpg?s=128&g=1", "display_name": "Talha Meh", "link": "https://stackoverflow.com/users/3901769/talha-meh"}, "edited": false, "score": 0, "creation_date": 1501144602, "post_id": 45341358, "comment_id": 77652168, "body": "Thanks and by doing so, i&#39;ll be able to validate what i need to."}], "tags": [], "owner": {"reputation": 5239, "user_id": 2680864, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c913ec45c93dce4d2c18c59cd8f85edb?s=128&d=identicon&r=PG&f=1", "display_name": "r3b00t", "link": "https://stackoverflow.com/users/2680864/r3b00t"}, "is_accepted": false, "score": 0, "last_activity_date": 1501129704, "last_edit_date": 1501129704, "creation_date": 1501129267, "answer_id": 45341358, "question_id": 45339248, "link": "https://stackoverflow.com/questions/45339248/same-model-with-different-columns-rails/45341358#45341358", "title": "Same Model with different columns Rails", "body": "<p>Well both approach will solve your problem. Personally I will only have a single table because <code>Developer</code> is also type of <code>User</code> and <code>Driver</code> is also type of <code>User</code>. You can do something like this:</p>\n\n<pre><code>class User &lt; ActiveRecord::Base\nend\n\nclass Developer &lt; User\nend\n\nclass Driver &lt; User \nend\n</code></pre>\n\n<p>If user is Developer then you can fetch extra columns for developers. It's fine to have few column with nil value.</p>\n"}, {"comments": [{"owner": {"reputation": 293, "user_id": 3901769, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/d6ycu.jpg?s=128&g=1", "display_name": "Talha Meh", "link": "https://stackoverflow.com/users/3901769/talha-meh"}, "edited": false, "score": 0, "creation_date": 1501144871, "post_id": 45341519, "comment_id": 77652328, "body": "Thanks. That&#39;d cost in db queries. Single table inheritance seems to be more robust solution."}, {"owner": {"reputation": 443, "user_id": 6733421, "user_type": "registered", "profile_image": "https://graph.facebook.com/1081478385271860/picture?type=large", "display_name": "Sai Chander", "link": "https://stackoverflow.com/users/6733421/sai-chander"}, "reply_to_user": {"reputation": 293, "user_id": 3901769, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/d6ycu.jpg?s=128&g=1", "display_name": "Talha Meh", "link": "https://stackoverflow.com/users/3901769/talha-meh"}, "edited": false, "score": 0, "creation_date": 1501166622, "post_id": 45341519, "comment_id": 77669500, "body": "Yeah, I agree with that, but if you want to increase more roles in future, you&#39;d end up wasting a lot of space due to a lot of empty columns(a lot of null columns). If you don&#39;t have a lot of different columns or more roles then you can go ahead with Single table inheritance."}], "tags": [], "owner": {"reputation": 443, "user_id": 6733421, "user_type": "registered", "profile_image": "https://graph.facebook.com/1081478385271860/picture?type=large", "display_name": "Sai Chander", "link": "https://stackoverflow.com/users/6733421/sai-chander"}, "is_accepted": false, "score": 0, "last_activity_date": 1501130207, "creation_date": 1501130207, "answer_id": 45341519, "question_id": 45339248, "link": "https://stackoverflow.com/questions/45339248/same-model-with-different-columns-rails/45341519#45341519", "title": "Same Model with different columns Rails", "body": "<p>You can decide this based on the number of different columns. If the number of different columns is more which seems to be the case here, Create a user table which contains all the common columns and 2 more tables(developers and drivers) which will contain a user_id to map with the user.</p>\n\n<p>Also create a table named roles. Roles will contain id and role_name(driver, developer etc.) and add role_id column in users table. This structure will give you the flexibility even if you have more than 2 roles.</p>\n\n<p><code>class User &lt; ActiveRecord::Base\n end</code> </p>\n\n<p><code>class Driver &lt; ActiveRecord::Base\n    belongs_to :user\n end</code></p>\n\n<p><code>class Developer &lt; ActiveRecord::Base\n    belongs_to :user\n end</code></p>\n\n<p><code>class Role &lt; ActiveRecord::Base\n end</code></p>\n"}], "owner": {"reputation": 293, "user_id": 3901769, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/d6ycu.jpg?s=128&g=1", "display_name": "Talha Meh", "link": "https://stackoverflow.com/users/3901769/talha-meh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 987, "favorite_count": 1, "accepted_answer_id": 45339611, "answer_count": 3, "score": 4, "last_activity_date": 1502360294, "creation_date": 1501113595, "last_edit_date": 1501188777, "question_id": 45339248, "link": "https://stackoverflow.com/questions/45339248/same-model-with-different-columns-rails", "title": "Same Model with different columns Rails", "body": "<p>I have 2 user roles <code>Developer</code> and <code>Driver</code>. They both are under an <code>User</code> model, but also both have different details such as Developer has <code>hourly_rate</code>, <code>skills</code>, <code>experience</code>, <code>full_name</code> and Driver has <code>cars_he_can_drive</code>, <code>hours_driven</code>, <code>full_name</code> etc. </p>\n\n<p>They have some common columns and some different ones as well. Should there be a separate detail table (<code>develop_details</code>, <code>driver_details</code>) for each of the User? and further, relationships can be made with them. </p>\n\n<p>Else I can have same model with all columns and fetch only the ones required (others will be nil ofcourse).</p>\n\n<p><strong>UPDATE</strong>\nIm using role as and integer in user table and then using enums.\nI'm using Rails 5 with devise 4.3.0.</p>\n"}, {"tags": ["arrays", "ruby"], "comments": [{"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1501113467, "post_id": 45339104, "comment_id": 77640413, "body": "I&#39;m curious why you&#39;d want to do that rather than just <code>a**b</code>."}, {"owner": {"reputation": 9030, "user_id": 5101476, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JCQrl.jpg?s=128&g=1", "display_name": "ice\u30c4", "link": "https://stackoverflow.com/users/5101476/ice%e3%83%84"}, "edited": false, "score": 0, "creation_date": 1501115004, "post_id": 45339104, "comment_id": 77640767, "body": "<code>[a].*(b).inject(:*)</code>"}, {"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 0, "creation_date": 1501314249, "post_id": 45339104, "comment_id": 77734302, "body": "&quot;I need to define a function <i>power(a,b)</i> that takes the value <b>a</b> and repeats it <b>b</b> times and stores it in an array.&quot; \u2013 Then do it! We&#39;re not stopping you!"}], "answers": [{"comments": [{"owner": {"reputation": 9971, "user_id": 8255744, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de22299534b5a8ed244ee8ff4aa6c481?s=128&d=identicon&r=PG&f=1", "display_name": "Simple Lime", "link": "https://stackoverflow.com/users/8255744/simple-lime"}, "edited": false, "score": 0, "creation_date": 1501112804, "post_id": 45339118, "comment_id": 77640273, "body": "You don&#39;t need the initial value for <code>reduce</code>, if omitted it&#39;ll use the first value in the array"}, {"owner": {"reputation": 27144, "user_id": 3857758, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/58c4295826435f049b7fc32b98c240f9?s=128&d=identicon&r=PG&f=1", "display_name": "Ursus", "link": "https://stackoverflow.com/users/3857758/ursus"}, "reply_to_user": {"reputation": 9971, "user_id": 8255744, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de22299534b5a8ed244ee8ff4aa6c481?s=128&d=identicon&r=PG&f=1", "display_name": "Simple Lime", "link": "https://stackoverflow.com/users/8255744/simple-lime"}, "edited": false, "score": 1, "creation_date": 1501112854, "post_id": 45339118, "comment_id": 77640283, "body": "Yeah, if the array is empty you obtain nil, not zero"}, {"owner": {"reputation": 9030, "user_id": 5101476, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JCQrl.jpg?s=128&g=1", "display_name": "ice\u30c4", "link": "https://stackoverflow.com/users/5101476/ice%e3%83%84"}, "edited": false, "score": 1, "creation_date": 1501113149, "post_id": 45339118, "comment_id": 77640340, "body": "Eloquent Ruby:)"}], "tags": [], "owner": {"reputation": 27144, "user_id": 3857758, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/58c4295826435f049b7fc32b98c240f9?s=128&d=identicon&r=PG&f=1", "display_name": "Ursus", "link": "https://stackoverflow.com/users/3857758/ursus"}, "is_accepted": true, "score": 2, "last_activity_date": 1501112605, "creation_date": 1501112605, "answer_id": 45339118, "question_id": 45339104, "link": "https://stackoverflow.com/questions/45339104/a-function-that-makes-an-array-of-length-b-with-all-values-equal-to-a-then-take/45339118#45339118", "title": "A function that makes an array of length b with all values equal to a, then takes the product (Ruby 2.3.3)", "body": "<p>Anything like this?</p>\n\n<pre><code>def power(a, b)\n  Array.new(b, a).inject(1, :*)\nend\n\npower(2, 3)\n=&gt; 8\npower(2, 4)\n=&gt; 16\n</code></pre>\n"}], "owner": {"reputation": 199, "user_id": 8260740, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76bb4522ac125f517a460d94a42d8989?s=128&d=identicon&r=PG&f=1", "display_name": "Tyler Curtis Jowers", "link": "https://stackoverflow.com/users/8260740/tyler-curtis-jowers"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 32, "favorite_count": 0, "accepted_answer_id": 45339118, "answer_count": 1, "score": 0, "last_activity_date": 1501112605, "creation_date": 1501112500, "question_id": 45339104, "link": "https://stackoverflow.com/questions/45339104/a-function-that-makes-an-array-of-length-b-with-all-values-equal-to-a-then-take", "title": "A function that makes an array of length b with all values equal to a, then takes the product (Ruby 2.3.3)", "body": "<p>I need to define a function <em>power(a,b)</em> that takes the value <strong>a</strong> and repeats it <strong>b</strong> times and stores it in an array. Then takes the product of that array. </p>\n\n<p>The idea is to be able to take any number <strong>a</strong> and raise it to the power of <strong>b</strong> using arrays.</p>\n"}, {"tags": ["ruby", "oop", "metaprogramming"], "comments": [{"owner": {"reputation": 9030, "user_id": 5101476, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JCQrl.jpg?s=128&g=1", "display_name": "ice\u30c4", "link": "https://stackoverflow.com/users/5101476/ice%e3%83%84"}, "edited": false, "score": 0, "creation_date": 1501111189, "post_id": 45338874, "comment_id": 77639862, "body": "Should the last key be <code>attr_3</code>?"}, {"owner": {"reputation": 21, "user_id": 7498311, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1fb2c137f20e5b2cbaff637484fca70a?s=128&d=identicon&r=PG&f=1", "display_name": "Calculon", "link": "https://stackoverflow.com/users/7498311/calculon"}, "reply_to_user": {"reputation": 9030, "user_id": 5101476, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JCQrl.jpg?s=128&g=1", "display_name": "ice\u30c4", "link": "https://stackoverflow.com/users/5101476/ice%e3%83%84"}, "edited": false, "score": 0, "creation_date": 1501111755, "post_id": 45338874, "comment_id": 77639990, "body": "@sagarpandya82 You&#39;re right, sorry!"}, {"owner": {"reputation": 9030, "user_id": 5101476, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JCQrl.jpg?s=128&g=1", "display_name": "ice\u30c4", "link": "https://stackoverflow.com/users/5101476/ice%e3%83%84"}, "edited": false, "score": 0, "creation_date": 1501112451, "post_id": 45338874, "comment_id": 77640185, "body": "Have you got a <code>yield</code> in your <code>command</code> definition?"}, {"owner": {"reputation": 21, "user_id": 7498311, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1fb2c137f20e5b2cbaff637484fca70a?s=128&d=identicon&r=PG&f=1", "display_name": "Calculon", "link": "https://stackoverflow.com/users/7498311/calculon"}, "reply_to_user": {"reputation": 9030, "user_id": 5101476, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JCQrl.jpg?s=128&g=1", "display_name": "ice\u30c4", "link": "https://stackoverflow.com/users/5101476/ice%e3%83%84"}, "edited": false, "score": 0, "creation_date": 1501112947, "post_id": 45338874, "comment_id": 77640300, "body": "@sagarpandya82 Yes. Again sorry I didn&#39;t add that in."}], "answers": [{"comments": [{"owner": {"reputation": 2216, "user_id": 7165275, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d8ad41f944f38348a30791dc7f7d02c?s=128&d=identicon&r=PG&f=1", "display_name": "m. simon borg", "link": "https://stackoverflow.com/users/7165275/m-simon-borg"}, "edited": false, "score": 0, "creation_date": 1501130597, "post_id": 45339151, "comment_id": 77644626, "body": "This doesn&#39;t work if the method is defined in a different scope than where it&#39;s called. The block is scoped by its surroundings, so if <code>command</code> is defined in <code>class A</code> but the method is called in <code>class B</code>, <code>@attr_1</code> will be evaluated in the context of <code>B</code>, not <code>A</code>"}], "tags": [], "owner": {"reputation": 9030, "user_id": 5101476, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JCQrl.jpg?s=128&g=1", "display_name": "ice\u30c4", "link": "https://stackoverflow.com/users/5101476/ice%e3%83%84"}, "is_accepted": false, "score": 0, "last_activity_date": 1501113890, "last_edit_date": 1501113890, "creation_date": 1501112846, "answer_id": 45339151, "question_id": 45338874, "link": "https://stackoverflow.com/questions/45338874/how-can-i-reference-parameters-of-an-object-within-a-passed-block/45339151#45339151", "title": "How can I reference parameters of an Object within a passed block?", "body": "<p>Off the top of my head you could do something like this. Caveat being I have no idea if this is suitable for production code.</p>\n\n<p>This code creates instance variables for each key by iterating over the keys of the argument hash. Then when we call <code>command</code>, we can reference each key's value in the block using the corresponding instance_variable:</p>\n\n<pre><code>def command(attributes = {}, &amp;block)\n  attributes.each_key { |key| \n    instance_variable_set(\"@#{key}\",attributes[key])\n  }\n  yield\nend\n\ncommand(attr_1: 'Open Mike Night',\n        attr_2: 2033392,\n        attr_3: [9.29, 10.08, 12.32]) do |event|\n\n  puts \"#{@attr_1}\"\nend\n</code></pre>\n\n<p>prints:</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>Open Mike Night\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2216, "user_id": 7165275, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d8ad41f944f38348a30791dc7f7d02c?s=128&d=identicon&r=PG&f=1", "display_name": "m. simon borg", "link": "https://stackoverflow.com/users/7165275/m-simon-borg"}, "is_accepted": false, "score": 0, "last_activity_date": 1501118452, "last_edit_date": 1501118452, "creation_date": 1501117486, "answer_id": 45339720, "question_id": 45338874, "link": "https://stackoverflow.com/questions/45338874/how-can-i-reference-parameters-of-an-object-within-a-passed-block/45339720#45339720", "title": "How can I reference parameters of an Object within a passed block?", "body": "<p>Yield them to the block : )</p>\n\n<pre><code>def command(attributes = {})\n  yield self, attributes\nend\n\nattributes = { attr_1: 'Open Mike Night', attr_2: 2033392, attr_3: [9.29, 10.08, 12.32] }\n\ncommand(attributes) do |obj, attrs|\n  p \"#{obj.object_id}, #{attrs[:attr_1]}\"\nend \n# =&gt; \"70309890142840, Open Mike Night\"\n</code></pre>\n\n<p>Any method, constant, or variable available within a method scope can be given as an argument to <code>yield</code> to be sent into a block as a block variable. Then you can do with it whatever you wish. In this case <code>attrs</code> would be a completely optional variable as well, and the block would be valid without it.</p>\n\n<pre><code>command(attributes) { |obj| p obj.object_id } # =&gt; 70309890142840\n</code></pre>\n\n<p>P.S. You don't need <code>&amp;block</code> in the method signature if you're using <code>yield</code>. You also weren't giving <code>yield</code> an argument in your question, but were passing an <code>|event|</code> variable into the block, which would have been <code>nil</code>. So I just left that out in the above example. </p>\n"}], "owner": {"reputation": 21, "user_id": 7498311, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1fb2c137f20e5b2cbaff637484fca70a?s=128&d=identicon&r=PG&f=1", "display_name": "Calculon", "link": "https://stackoverflow.com/users/7498311/calculon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 51, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1501118452, "creation_date": 1501110715, "last_edit_date": 1501112977, "question_id": 45338874, "link": "https://stackoverflow.com/questions/45338874/how-can-i-reference-parameters-of-an-object-within-a-passed-block", "title": "How can I reference parameters of an Object within a passed block?", "body": "<p>I'm trying to reference one of the parameters of an Object inside of the block that's passed along with it. </p>\n\n<pre><code>def command(attributes = {}, &amp;block)\n    yield\nend\n\ncommand(attr_1: 'Open Mike Night', \n    attr_2: 2033392,\n    attr_3: [9.29, 10.08, 12.32]) do |event|\n\n    event.message.delete\n\n    puts \"#{self.attributes[:attr_1]}\" # &lt;-- That didn't work.\n\nend\n</code></pre>\n\n<p>Is something like that possible and if so how would I go about doing it? What should I look into?</p>\n"}, {"tags": ["ruby-on-rails", "json", "ruby", "rubygems", "upgrade"], "comments": [{"owner": {"reputation": 188, "user_id": 4490968, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5f8d43ef373ec0201fe724296b2e1637?s=128&d=identicon&r=PG&f=1", "display_name": "Howard", "link": "https://stackoverflow.com/users/4490968/howard"}, "edited": false, "score": 0, "creation_date": 1501114133, "post_id": 45338620, "comment_id": 77640561, "body": "So, in case anybody finds this via Google and similar error messages, i could not figure it out. I copied the <code>views</code> , <code>controllers</code>, <code>routes.rb</code> into a freshly created rails app and added the gems i used into the Gemfile, then it started w/o problems. Thanks gentlemen"}], "answers": [{"comments": [{"owner": {"reputation": 188, "user_id": 4490968, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5f8d43ef373ec0201fe724296b2e1637?s=128&d=identicon&r=PG&f=1", "display_name": "Howard", "link": "https://stackoverflow.com/users/4490968/howard"}, "edited": false, "score": 0, "creation_date": 1501110829, "post_id": 45338808, "comment_id": 77639762, "body": "thanks for the fast reply, the thing is, in the Gemfile, there is nothing about a json gem"}, {"owner": {"reputation": 2216, "user_id": 7165275, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d8ad41f944f38348a30791dc7f7d02c?s=128&d=identicon&r=PG&f=1", "display_name": "m. simon borg", "link": "https://stackoverflow.com/users/7165275/m-simon-borg"}, "reply_to_user": {"reputation": 188, "user_id": 4490968, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5f8d43ef373ec0201fe724296b2e1637?s=128&d=identicon&r=PG&f=1", "display_name": "Howard", "link": "https://stackoverflow.com/users/4490968/howard"}, "edited": false, "score": 0, "creation_date": 1501110952, "post_id": 45338808, "comment_id": 77639788, "body": "@Howard from your <code>Gemfile</code>: <code>gem &#39;json&#39;, github: &#39;flori&#47;json&#39;, branch: &#39;v1.8&#39;</code>. But I would try using <code>bundle exec</code> first if you haven&#39;t already, just to be sure"}, {"owner": {"reputation": 2216, "user_id": 7165275, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d8ad41f944f38348a30791dc7f7d02c?s=128&d=identicon&r=PG&f=1", "display_name": "m. simon borg", "link": "https://stackoverflow.com/users/7165275/m-simon-borg"}, "reply_to_user": {"reputation": 188, "user_id": 4490968, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5f8d43ef373ec0201fe724296b2e1637?s=128&d=identicon&r=PG&f=1", "display_name": "Howard", "link": "https://stackoverflow.com/users/4490968/howard"}, "edited": false, "score": 0, "creation_date": 1501111120, "post_id": 45338808, "comment_id": 77639840, "body": "@Howard I think the problem could be that your Rails version in the <code>Gemfile</code> is <code>4.2.6</code>, and if you got a new machine and did <code>gem install rails</code> then that&#39;s probably <code>5.1.x</code>, so doing <code>$ rails &lt;command&gt;</code> will be using <code>5.1.x</code> and there might be conflicts. If you do <code>bundle exec rails &lt;command&gt;</code> it should use the bundled <code>4.2.6</code>"}, {"owner": {"reputation": 188, "user_id": 4490968, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5f8d43ef373ec0201fe724296b2e1637?s=128&d=identicon&r=PG&f=1", "display_name": "Howard", "link": "https://stackoverflow.com/users/4490968/howard"}, "edited": false, "score": 0, "creation_date": 1501111349, "post_id": 45338808, "comment_id": 77639905, "body": "Yes that with the 5.1. is true. Sorry i got confused with that line in the Gemfile bc i copied the project into multiple folders to try out diff. Gemfile&amp;Gemfile.lock configs. Now i deleted all of them and try to start from scratch w the zip archive from 2016. If in unzip it and run bundle install: <code>An error occurred while installing json (1.8.3), and Bundler cannot continue. Make sure that </code>gem install json -v &#39;1.8.3&#39;` succeeds before bundling.` ... what whas my initial issue why i altered the Gemfiles in the first place. What could i do? Thanks a lot for your help, i very appreciate it"}, {"owner": {"reputation": 188, "user_id": 4490968, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5f8d43ef373ec0201fe724296b2e1637?s=128&d=identicon&r=PG&f=1", "display_name": "Howard", "link": "https://stackoverflow.com/users/4490968/howard"}, "edited": false, "score": 0, "creation_date": 1501111552, "post_id": 45338808, "comment_id": 77639951, "body": "Now i changed the rails version in the Gemfile to <code>5.1.2</code> and hoped that might maybe help when i do a <code>bundle install</code>, but: <code>Bundler could not find compatible versions for gem &quot;railties&quot;:   In Gemfile:     coffee-rails (~&gt; 4.1.0) was resolved to 4.1.0, which depends on       railties (&lt; 5.0, &gt;= 4.0.0)      rails (= 5.1.2) was resolved to 5.1.2, which depends on       railties (= 5.1.2)      sass-rails (~&gt; 5.0) was resolved to 5.0.6, which depends on       railties (&lt; 6, &gt;= 4.0.0)      web-console (~&gt; 2.0) was resolved to 2.3.0, which depends on       railties (&gt;= 4.0) </code>"}, {"owner": {"reputation": 2216, "user_id": 7165275, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d8ad41f944f38348a30791dc7f7d02c?s=128&d=identicon&r=PG&f=1", "display_name": "m. simon borg", "link": "https://stackoverflow.com/users/7165275/m-simon-borg"}, "reply_to_user": {"reputation": 188, "user_id": 4490968, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5f8d43ef373ec0201fe724296b2e1637?s=128&d=identicon&r=PG&f=1", "display_name": "Howard", "link": "https://stackoverflow.com/users/4490968/howard"}, "edited": false, "score": 0, "creation_date": 1501111619, "post_id": 45338808, "comment_id": 77639966, "body": "No, I wouldn&#39;t do that. Restore the entire <code>Gemfile</code>, then <code>$ rm Gemfile.lock</code> and <code>bundle install</code>. You want to start with your original <code>Gemfile</code> and no <code>Gemfile.lock</code>, and let <code>bundler</code> create a brand new <code>Gemfile.lock</code> from scratch. Hopefully that works"}, {"owner": {"reputation": 2216, "user_id": 7165275, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d8ad41f944f38348a30791dc7f7d02c?s=128&d=identicon&r=PG&f=1", "display_name": "m. simon borg", "link": "https://stackoverflow.com/users/7165275/m-simon-borg"}, "reply_to_user": {"reputation": 188, "user_id": 4490968, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5f8d43ef373ec0201fe724296b2e1637?s=128&d=identicon&r=PG&f=1", "display_name": "Howard", "link": "https://stackoverflow.com/users/4490968/howard"}, "edited": false, "score": 0, "creation_date": 1501111945, "post_id": 45338808, "comment_id": 77640048, "body": "Let us <a href=\"http://chat.stackoverflow.com/rooms/150234/discussion-between-m-simon-borg-and-howard\">continue this discussion in chat</a>."}], "tags": [], "owner": {"reputation": 2216, "user_id": 7165275, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d8ad41f944f38348a30791dc7f7d02c?s=128&d=identicon&r=PG&f=1", "display_name": "m. simon borg", "link": "https://stackoverflow.com/users/7165275/m-simon-borg"}, "is_accepted": true, "score": 1, "last_activity_date": 1501119406, "last_edit_date": 1501119406, "creation_date": 1501110228, "answer_id": 45338808, "question_id": 45338620, "link": "https://stackoverflow.com/questions/45338620/error-when-bundling-one-year-old-rails-app-on-new-machine-w-latest-ruby-2-4-1/45338808#45338808", "title": "Error when bundling one year old Rails app on new machine w latest Ruby (2.4.1) + Rails", "body": "<p>If you need to remove a gem you should remove it from your <code>Gemfile</code>, not <code>Gemfile.lock</code>.</p>\n\n<p>In your <code>Gemfile</code>: <code>gem 'json', github: 'flori/json', branch: 'v1.8'</code></p>\n\n<p><code>bundler</code> creates <code>Gemfile.lock</code> for you after it resolves your dependencies during <code>bundle install</code>, based on whatever's in your <code>Gemfile</code>. <code>Gemfile.lock</code> also specifies gems that are not in your <code>Gemfile</code> but are dependencies of gems that are. Editing it manually is almost guaranteed to cause you problems and fix nothing. </p>\n\n<p>But you probably don't need to remove it at all. Right now you're locked onto a version of <code>json</code> that <code>bundler</code>'s having trouble resolving. You should delete <code>Gemfile.lock</code> and let <code>bundler</code> generate a brand new one.</p>\n"}], "owner": {"reputation": 188, "user_id": 4490968, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5f8d43ef373ec0201fe724296b2e1637?s=128&d=identicon&r=PG&f=1", "display_name": "Howard", "link": "https://stackoverflow.com/users/4490968/howard"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 587, "favorite_count": 0, "accepted_answer_id": 45338808, "answer_count": 1, "score": 0, "last_activity_date": 1501143919, "creation_date": 1501109050, "last_edit_date": 1501143919, "question_id": 45338620, "link": "https://stackoverflow.com/questions/45338620/error-when-bundling-one-year-old-rails-app-on-new-machine-w-latest-ruby-2-4-1", "title": "Error when bundling one year old Rails app on new machine w latest Ruby (2.4.1) + Rails", "body": "<p>I just tried to revive an old Rails app of mine, created July 2016. </p>\n\n<p>When bundling on my new machine with fresh installs of Ruby and Rails I got this error, because <code>json</code> is now included into rails, and not needed in the Gemfile anymore:</p>\n\n<pre><code>An error occurred while installing json (1.8.3), and Bundler cannot continue. Make sure that gem install json -v '1.8.3'` succeeds before bundling.\n</code></pre>\n\n<p>If I remove the gem from the Gemfile.lock (edit: this is probably very stupid, but there was no mention of json in the Gemfile, why i looked into the Gemfile.lock), I get <code>Unfortunately, an unexpected error occurred, and Bundler cannot continue.</code> on bundle install:</p>\n\n<pre><code>The git source `git://github.com/flori/json.git` uses the `git` protocol, which transmits data without encryption. Disable this warning with `bundle config git.allow_insecure true`, or switch to the `https` protocol to keep your data secure.\nThe git source `git://github.com/capistrano/rbenv.git` uses the `git` protocol, which transmits data without encryption. Disable this warning with `bundle config git.allow_insecure true`, or switch to the `https` protocol to keep your data secure.\nFetching git://github.com/flori/json.git\nThe git source `git://github.com/flori/json.git` uses the `git` protocol, which transmits data without encryption. Disable this warning with `bundle config git.allow_insecure true`, or switch to the `https` protocol to keep your data secure.\nThe git source `git://github.com/capistrano/rbenv.git` uses the `git` protocol, which transmits data without encryption. Disable this warning with `bundle config git.allow_insecure true`, or switch to the `https` protocol to keep your data secure.\n--- ERROR REPORT TEMPLATE -------------------------------------------------------\n# Error Report\n\n## Questions\n\nPlease fill out answers to these questions, it'll help us figure out\nwhy things are going wrong.\n\n- **What did you do?**\n\n  I ran the command `/home/howard/.rbenv/versions/2.4.1/bin/bundle install`\n\n- **What did you expect to happen?**\n\n  I expected Bundler to...\n\n- **What happened instead?**\n\n  Instead, what happened was...\n\n- **Have you tried any solutions posted on similar issues in our issue tracker, stack overflow, or google?**\n\n  I tried...\n\n- **Have you read our issues document, https://github.com/bundler/bundler/blob/master/doc/contributing/ISSUES.md?**\n\n  ...\n\n## Backtrace\n\n```\nArgumentError: Invalid source: nil\n  /home/howard/.rbenv/versions/2.4.1/lib/ruby/gems/2.4.0/gems/bundler-1.15.3/lib/bundler/source_list.rb:107:in `source_list_for'\n  /home/howard/.rbenv/versions/2.4.1/lib/ruby/gems/2.4.0/gems/bundler-1.15.3/lib/bundler/source_list.rb:56:in `get'\n  /home/howard/.rbenv/versions/2.4.1/lib/ruby/gems/2.4.0/gems/bundler-1.15.3/lib/bundler/definition.rb:746:in `block in converge_locked_specs'\n  /home/howard/.rbenv/versions/2.4.1/lib/ruby/2.4.0/forwardable.rb:229:in `each'\n  /home/howard/.rbenv/versions/2.4.1/lib/ruby/2.4.0/forwardable.rb:229:in `each'\n  /home/howard/.rbenv/versions/2.4.1/lib/ruby/gems/2.4.0/gems/bundler-1.15.3/lib/bundler/definition.rb:743:in `converge_locked_specs'\n  /home/howard/.rbenv/versions/2.4.1/lib/ruby/gems/2.4.0/gems/bundler-1.15.3/lib/bundler/definition.rb:228:in `resolve'\n  /home/howard/.rbenv/versions/2.4.1/lib/ruby/gems/2.4.0/gems/bundler-1.15.3/lib/bundler/definition.rb:159:in `specs'\n  /home/howard/.rbenv/versions/2.4.1/lib/ruby/gems/2.4.0/gems/bundler-1.15.3/lib/bundler/definition.rb:147:in `resolve_remotely!'\n  /home/howard/.rbenv/versions/2.4.1/lib/ruby/gems/2.4.0/gems/bundler-1.15.3/lib/bundler/installer.rb:226:in `resolve_if_need'\n  /home/howard/.rbenv/versions/2.4.1/lib/ruby/gems/2.4.0/gems/bundler-1.15.3/lib/bundler/installer.rb:78:in `run'\n  /home/howard/.rbenv/versions/2.4.1/lib/ruby/gems/2.4.0/gems/bundler-1.15.3/lib/bundler/installer.rb:24:in `install'\n  /home/howard/.rbenv/versions/2.4.1/lib/ruby/gems/2.4.0/gems/bundler-1.15.3/lib/bundler/cli/install.rb:68:in `run'\n  /home/howard/.rbenv/versions/2.4.1/lib/ruby/gems/2.4.0/gems/bundler-1.15.3/lib/bundler/cli.rb:191:in `block in install'\n  /home/howard/.rbenv/versions/2.4.1/lib/ruby/gems/2.4.0/gems/bundler-1.15.3/lib/bundler/settings.rb:92:in `temporary'\n  /home/howard/.rbenv/versions/2.4.1/lib/ruby/gems/2.4.0/gems/bundler-1.15.3/lib/bundler/cli.rb:190:in `install'\n  /home/howard/.rbenv/versions/2.4.1/lib/ruby/gems/2.4.0/gems/bundler-1.15.3/lib/bundler/vendor/thor/lib/thor/command.rb:27:in `run'\n  /home/howard/.rbenv/versions/2.4.1/lib/ruby/gems/2.4.0/gems/bundler-1.15.3/lib/bundler/vendor/thor/lib/thor/invocation.rb:126:in `invoke_command'\n  /home/howard/.rbenv/versions/2.4.1/lib/ruby/gems/2.4.0/gems/bundler-1.15.3/lib/bundler/vendor/thor/lib/thor.rb:369:in `dispatch'\n  /home/howard/.rbenv/versions/2.4.1/lib/ruby/gems/2.4.0/gems/bundler-1.15.3/lib/bundler/cli.rb:22:in `dispatch'\n  /home/howard/.rbenv/versions/2.4.1/lib/ruby/gems/2.4.0/gems/bundler-1.15.3/lib/bundler/vendor/thor/lib/thor/base.rb:444:in `start'\n  /home/howard/.rbenv/versions/2.4.1/lib/ruby/gems/2.4.0/gems/bundler-1.15.3/lib/bundler/cli.rb:13:in `start'\n  /home/howard/.rbenv/versions/2.4.1/lib/ruby/gems/2.4.0/gems/bundler-1.15.3/exe/bundle:30:in `block in &lt;top (required)&gt;'\n  /home/howard/.rbenv/versions/2.4.1/lib/ruby/gems/2.4.0/gems/bundler-1.15.3/lib/bundler/friendly_errors.rb:121:in `with_friendly_errors'\n  /home/howard/.rbenv/versions/2.4.1/lib/ruby/gems/2.4.0/gems/bundler-1.15.3/exe/bundle:22:in `&lt;top (required)&gt;'\n  /home/howard/.rbenv/versions/2.4.1/bin/bundle:22:in `load'\n  /home/howard/.rbenv/versions/2.4.1/bin/bundle:22:in `&lt;main&gt;'\n```\n\n## Environment\n\n```\nBundler   1.15.3\nRubygems  2.6.11\nRuby      2.4.1p111 (2017-03-22 revision 58053) [x86_64-linux]\nGEM_HOME  /home/howard/.rbenv/versions/2.4.1/lib/ruby/gems/2.4.0\nGEM_PATH  /home/howard/.rbenv/versions/2.4.1/lib/ruby/gems/2.4.0:/home/howard/.gem/ruby/2.4.0\nGit       2.7.4\nPlatform  x86_64-linux\nOpenSSL   OpenSSL 1.0.2g  1 Mar 2016\n```\n\n## Bundler settings\n\n```\nwithout\n  Set for your local app (/home/howard/Downloads/telefon/code/.bundle/config): \"development:test\"\n```\n\n## Gemfile\n\n### Gemfile\n\n```ruby\nsource 'https://rubygems.org'\n\n\n# Bundle edge Rails instead: gem 'rails', github: 'rails/rails'\ngem 'rails', '4.2.6'\n# Use sqlite3 as the database for Active Record\ngem 'sqlite3'\n# Use SCSS for stylesheets\ngem 'sass-rails', '~&gt; 5.0'\n# Use Uglifier as compressor for JavaScript assets\ngem 'uglifier', '&gt;= 1.3.0'\n# Use CoffeeScript for .coffee assets and views\ngem 'coffee-rails', '~&gt; 4.1.0'\n# See https://github.com/rails/execjs#readme for more supported runtimes\n# gem 'therubyracer', platforms: :ruby\n\ngem 'capistrano', '~&gt; 3.1.0'\ngem 'capistrano-bundler', '~&gt; 1.1.2'\ngem 'capistrano-rails', '~&gt; 1.1.1'\ngem 'json', github: 'flori/json', branch: 'v1.8'\n\n# Add this if you're using rbenv\ngem 'capistrano-rbenv', github: \"capistrano/rbenv\"\n\ngem \"browser\"\n\n# Use jquery as the JavaScript library\ngem 'jquery-rails'\n# Turbolinks makes following links in your web application faster. Read more: https://github.com/rails/turbolinks\n# gem 'turbolinks'\n# Build JSON APIs with ease. Read more: https://github.com/rails/jbuilder\ngem 'jbuilder', '~&gt; 2.0'\n# bundle exec rake doc:rails generates the API under doc/api.\ngem 'sdoc', '~&gt; 0.4.0', group: :doc\n\n# Use ActiveModel has_secure_password\n# gem 'bcrypt', '~&gt; 3.1.7'\n\n# Use Unicorn as the app server\n# gem 'unicorn'\n\n# Use Capistrano for deployment\n# gem 'capistrano-rails', group: :development\n\ngroup :development, :test do\n  # Call 'byebug' anywhere in the code to stop execution and get a debugger console\n  gem 'byebug'\nend\n\ngroup :development do\n  # Access an IRB console on exception pages or by using &lt;%= console %&gt; in views\n  gem 'web-console', '~&gt; 2.0'\n\n  # Spring speeds up development by keeping your application running in the background. Read more: https://github.com/rails/spring\n  gem 'spring'\nend\n```\n\n### Gemfile.lock\n\n```\nGIT\n  remote: git://github.com/capistrano/rbenv.git\n  revision: e056efc0c361cc15b76ff961d6c5f65ed5e2c57e\n  specs:\n    capistrano-rbenv (2.0.4)\n      capistrano (~&gt; 3.1)\n      sshkit (~&gt; 1.3)\n\nGEM\n  remote: https://rubygems.org/\n  specs:'\n    actionmailer (4.2.6)\n      actionpack (= 4.2.6)\n      actionview (= 4.2.6)\n      activejob (= 4.2.6)\n      mail (~&gt; 2.5, &gt;= 2.5.4)\n      rails-dom-testing (~&gt; 1.0, &gt;= 1.0.5)\n    actionpack (4.2.6)\n      actionview (= 4.2.6)\n      activesupport (= 4.2.6)\n      rack (~&gt; 1.6)\n      rack-test (~&gt; 0.6.2)\n      rails-dom-testing (~&gt; 1.0, &gt;= 1.0.5)\n      rails-html-sanitizer (~&gt; 1.0, &gt;= 1.0.2)\n    actionview (4.2.6)\n      activesupport (= 4.2.6)\n      builder (~&gt; 3.1)\n      erubis (~&gt; 2.7.0)\n      rails-dom-testing (~&gt; 1.0, &gt;= 1.0.5)\n      rails-html-sanitizer (~&gt; 1.0, &gt;= 1.0.2)\n    activejob (4.2.6)\n      activesupport (= 4.2.6)\n      globalid (&gt;= 0.3.0)\n    activemodel (4.2.6)\n      activesupport (= 4.2.6)\n      builder (~&gt; 3.1)\n    activerecord (4.2.6)\n      activemodel (= 4.2.6)\n      activesupport (= 4.2.6)\n      arel (~&gt; 6.0)\n    activesupport (4.2.6)\n      i18n (~&gt; 0.7)\n      json (~&gt; 1.7, &gt;= 1.7.7)\n      minitest (~&gt; 5.1)\n      thread_safe (~&gt; 0.3, &gt;= 0.3.4)\n      tzinfo (~&gt; 1.1)\n    arel (6.0.3)\n    binding_of_caller (0.7.2)\n      debug_inspector (&gt;= 0.0.1)\n    browser (2.1.0)\n    builder (3.2.2)\n    byebug (9.0.5)\n    capistrano (3.1.0)\n      i18n\n      rake (&gt;= 10.0.0)\n      sshkit (~&gt; 1.3)\n    capistrano-bundler (1.1.4)\n      capistrano (~&gt; 3.1)\n      sshkit (~&gt; 1.2)\n    capistrano-rails (1.1.7)\n      capistrano (~&gt; 3.1)\n      capistrano-bundler (~&gt; 1.1)\n    coffee-rails (4.1.1)\n      coffee-script (&gt;= 2.2.0)\n      railties (&gt;= 4.0.0, &lt; 5.1.x)\n    coffee-script (2.4.1)\n      coffee-script-source\n      execjs\n    coffee-script-source (1.10.0)\n    concurrent-ruby (1.0.2)\n    debug_inspector (0.0.2)\n    erubis (2.7.0)\n    execjs (2.7.0)\n    globalid (0.3.6)\n      activesupport (&gt;= 4.1.0)\n    i18n (0.7.0)\n    jbuilder (2.5.0)\n      activesupport (&gt;= 3.0.0, &lt; 5.1)\n      multi_json (~&gt; 1.2)\n    jquery-rails (4.1.1)\n      rails-dom-testing (&gt;= 1, &lt; 3)\n      railties (&gt;= 4.2.0)\n      thor (&gt;= 0.14, &lt; 2.0)\n    loofah (2.0.3)\n      nokogiri (&gt;= 1.5.9)\n    mail (2.6.4)\n      mime-types (&gt;= 1.16, &lt; 4)\n    mime-types (3.1)\n      mime-types-data (~&gt; 3.2015)\n    mime-types-data (3.2016.0521)\n    mini_portile2 (2.1.0)\n    minitest (5.9.0)\n    multi_json (1.12.1)\n    net-scp (1.2.1)\n      net-ssh (&gt;= 2.6.5)\n    net-ssh (3.1.1)\n    nokogiri (1.6.8)\n      mini_portile2 (~&gt; 2.1.0)\n      pkg-config (~&gt; 1.1.7)\n    pkg-config (1.1.7)\n    rack (1.6.4)\n    rack-test (0.6.3)\n      rack (&gt;= 1.0)\n    rails (4.2.6)\n      actionmailer (= 4.2.6)\n      actionpack (= 4.2.6)\n      actionview (= 4.2.6)\n      activejob (= 4.2.6)\n      activemodel (= 4.2.6)\n      activerecord (= 4.2.6)\n      activesupport (= 4.2.6)\n      bundler (&gt;= 1.3.0, &lt; 2.0)\n      railties (= 4.2.6)\n      sprockets-rails\n    rails-deprecated_sanitizer (1.0.3)\n      activesupport (&gt;= 4.2.0.alpha)\n    rails-dom-testing (1.0.7)\n      activesupport (&gt;= 4.2.0.beta, &lt; 5.0)\n      nokogiri (~&gt; 1.6.0)\n      rails-deprecated_sanitizer (&gt;= 1.0.1)\n    rails-html-sanitizer (1.0.3)\n      loofah (~&gt; 2.0)\n    railties (4.2.6)\n      actionpack (= 4.2.6)\n      activesupport (= 4.2.6)\n      rake (&gt;= 0.8.7)\n      thor (&gt;= 0.18.1, &lt; 2.0)\n    rake (11.2.2)\n    rdoc (4.2.2)\n      json (~&gt; 1.4)\n    sass (3.4.22)\n    sass-rails (5.0.4)\n      railties (&gt;= 4.0.0, &lt; 5.0)\n      sass (~&gt; 3.1)\n      sprockets (&gt;= 2.8, &lt; 4.0)\n      sprockets-rails (&gt;= 2.0, &lt; 4.0)\n      tilt (&gt;= 1.1, &lt; 3)\n    sdoc (0.4.1)\n      json (~&gt; 1.7, &gt;= 1.7.7)\n      rdoc (~&gt; 4.0)\n    spring (1.7.1)\n    sprockets (3.6.0)\n      concurrent-ruby (~&gt; 1.0)\n      rack (&gt; 1, &lt; 3)\n    sprockets-rails (3.0.4)\n      actionpack (&gt;= 4.0)\n      activesupport (&gt;= 4.0)\n      sprockets (&gt;= 3.0.0)\n    sqlite3 (1.3.11)\n    sshkit (1.11.1)\n      net-scp (&gt;= 1.1.2)\n      net-ssh (&gt;= 2.8.0)\n    thor (0.19.1)\n    thread_safe (0.3.5)\n    tilt (2.0.5)\n    tzinfo (1.2.2)\n      thread_safe (~&gt; 0.1)\n    uglifier (3.0.0)\n      execjs (&gt;= 0.3.0, &lt; 3)\n    web-console (2.3.0)\n      activemodel (&gt;= 4.0)\n      binding_of_caller (&gt;= 0.7.2)\n      railties (&gt;= 4.0)\n      sprockets-rails (&gt;= 2.0, &lt; 4.0)\n\nPLATFORMS\n  ruby\n\nDEPENDENCIES\n  browser\n  byebug\n  capistrano (~&gt; 3.1.0)\n  capistrano-bundler (~&gt; 1.1.2)\n  capistrano-rails (~&gt; 1.1.1)\n  capistrano-rbenv!\n  coffee-rails (~&gt; 4.1.0)\n  jbuilder (~&gt; 2.0)\n  jquery-rails\n  rails (= 4.2.6)\n  sass-rails (~&gt; 5.0)\n  sdoc (~&gt; 0.4.0)\n  spring\n  sqlite3\n  uglifier (&gt;= 1.3.0)\n  web-console (~&gt; 2.0)\n\nBUNDLED WITH\n   1.12.5\n```\n\n--- TEMPLATE END ----------------------------------------------------------------\n\nUnfortunately, an unexpected error occurred, and Bundler cannot continue.\n\nFirst, try this link to see if there are any existing issue reports for this error:\nhttps://github.com/bundler/bundler/search?q=Invalid+source++nil&amp;type=Issues\n\nIf there aren't any reports for this error yet, please create copy and paste the report template above into a new issue. Don't forget to anonymize any private data! The new issue form is located at:\nhttps://github.com/bundler/bundler/issues/new\n</code></pre>\n\n<p>Does anybody know what i could try to get out of this situation?</p>\n\n<p>Thanks</p>\n"}, {"tags": ["ruby"], "answers": [{"tags": [], "owner": {"reputation": 13441, "user_id": 2199600, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8sl6u.jpg?s=128&g=1", "display_name": "Igor Drozdov", "link": "https://stackoverflow.com/users/2199600/igor-drozdov"}, "is_accepted": false, "score": 1, "last_activity_date": 1501108699, "creation_date": 1501108699, "answer_id": 45338562, "question_id": 45338452, "link": "https://stackoverflow.com/questions/45338452/how-can-i-modify-content-of-an-array-in-one-loop/45338562#45338562", "title": "How can I modify content of an array in one loop", "body": "<p>You can just add <code>lazy</code> not to create an intermediate array for every step.\nIt is still 2 iterations, but memory efficient, yet readable </p>\n\n<pre><code>strings.lazy.select {|string| !string.empty? }.map {|string| string.strip }.to_a\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 9030, "user_id": 5101476, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JCQrl.jpg?s=128&g=1", "display_name": "ice\u30c4", "link": "https://stackoverflow.com/users/5101476/ice%e3%83%84"}, "is_accepted": false, "score": 1, "last_activity_date": 1501108854, "creation_date": 1501108854, "answer_id": 45338588, "question_id": 45338452, "link": "https://stackoverflow.com/questions/45338452/how-can-i-modify-content-of-an-array-in-one-loop/45338588#45338588", "title": "How can I modify content of an array in one loop", "body": "<p>You can use <code>grep</code> here:</p>\n\n<pre><code>strings.grep(/.+/, &amp;:strip)\n #=&gt; [\"Some text\", \"Some another text\"]\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1962, "user_id": 2945616, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/TL0yY.jpg?s=128&g=1", "display_name": "Atul Khanduri", "link": "https://stackoverflow.com/users/2945616/atul-khanduri"}, "is_accepted": false, "score": 0, "last_activity_date": 1501133196, "creation_date": 1501133196, "answer_id": 45342031, "question_id": 45338452, "link": "https://stackoverflow.com/questions/45338452/how-can-i-modify-content-of-an-array-in-one-loop/45342031#45342031", "title": "How can I modify content of an array in one loop", "body": "<p>You can also achieve that with <code>#inject</code> (<a href=\"https://stackoverflow.com/a/710514/2945616\">SO link</a>, <a href=\"https://ruby-doc.org/core-2.2.3/Enumerable.html#method-i-inject\" rel=\"nofollow noreferrer\">Ruby doc link</a>) with one loop:</p>\n\n<pre><code>strings.inject([]) { |arr, val| val.present? ? arr.push(val.strip) : arr }\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 2451, "user_id": 196497, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4fcf2df89ffee8b38eda53b864b60373?s=128&d=identicon&r=PG", "display_name": "Aurril", "link": "https://stackoverflow.com/users/196497/aurril"}, "edited": false, "score": 0, "creation_date": 1501155847, "post_id": 45343830, "comment_id": 77660486, "body": "While this code may answer the question, providing additional context regarding why and/or how this code answers the question improves its long-term value."}, {"owner": {"reputation": 121, "user_id": 6951578, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-DBRhmi-jblE/AAAAAAAAAAI/AAAAAAAAA2s/-i5GvJQZRIg/photo.jpg?sz=128", "display_name": "NEHAL AMIN", "link": "https://stackoverflow.com/users/6951578/nehal-amin"}, "reply_to_user": {"reputation": 2451, "user_id": 196497, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4fcf2df89ffee8b38eda53b864b60373?s=128&d=identicon&r=PG", "display_name": "Aurril", "link": "https://stackoverflow.com/users/196497/aurril"}, "edited": false, "score": 0, "creation_date": 1501160970, "post_id": 45343830, "comment_id": 77664559, "body": "@Aurril I edited and explained above in short. Thanks for the comment."}], "tags": [], "owner": {"reputation": 121, "user_id": 6951578, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-DBRhmi-jblE/AAAAAAAAAAI/AAAAAAAAA2s/-i5GvJQZRIg/photo.jpg?sz=128", "display_name": "NEHAL AMIN", "link": "https://stackoverflow.com/users/6951578/nehal-amin"}, "is_accepted": false, "score": 1, "last_activity_date": 1501160849, "last_edit_date": 1501160849, "creation_date": 1501139749, "answer_id": 45343830, "question_id": 45338452, "link": "https://stackoverflow.com/questions/45338452/how-can-i-modify-content-of-an-array-in-one-loop/45343830#45343830", "title": "How can I modify content of an array in one loop", "body": "<pre><code> `strings.map {|string| string.strip if string.strip.size &gt; 0}`.compact\n\n&gt; [\"Some text\", \"Some another text\"]\n</code></pre>\n\n<p>Explanation:</p>\n\n<pre><code>strings.map {|string| string.strip if string.strip.size &gt; 0}\n</code></pre>\n\n<p>It will return:</p>\n\n<pre><code>&gt; [nil, nil, nil, \"Some text\", nil, \"Some another text\"]\n</code></pre>\n\n<p>nil in case when string is empty. Else it will return stripped text.</p>\n\n<p>.compact: Returns a copy of self with all nil elements removed.</p>\n\n<p>So, <code>[nil, nil, nil, \"Some text\", nil, \"Some another text\"].compact</code> \nwill be:<code>&gt; [\"Some text\", \"Some another text\"]</code></p>\n"}, {"tags": [], "owner": {"reputation": 635, "user_id": 1027220, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/c3376bb6869ac5e702763b4e550d9447?s=128&d=identicon&r=PG", "display_name": "Natan Rubinstein", "link": "https://stackoverflow.com/users/1027220/natan-rubinstein"}, "is_accepted": false, "score": 0, "last_activity_date": 1501145347, "creation_date": 1501145347, "answer_id": 45345754, "question_id": 45338452, "link": "https://stackoverflow.com/questions/45338452/how-can-i-modify-content-of-an-array-in-one-loop/45345754#45345754", "title": "How can I modify content of an array in one loop", "body": "<p>This is not most memory efficient (because you create another array)  buy will do the job in one loop (There may be shorter ways to write this code. I am also using <code>text!=''</code> instead <code>emtpy?</code>because I do not use Rails</p>\n\n<pre><code>strings = ['','','','   Some text', '', '     Some another text']\nstripped_strings = []\nstrings.each do |text|\nif !(text=='')\n   stripped_strings &lt;&lt; text.strip\nend\nputs stripped_strings\n</code></pre>\n\n<p>Output will be ['Some text','Some another text']</p>\n\n<p>The next way works for me in Ruby 2.1.7 I am not sure it will work in other versions. And I think it is a little risky. But you will not need an extra Array</p>\n\n<pre><code>strings = ['','','','   Some text', '', '     Some another text']\nstrings.select! do |text|\n    text.strip!\n    text != ''\nend\n</code></pre>\n\n<p>This works because that Ruby treats the String as an Object. Tell me comment If you want more explanation on this</p>\n\n<p>A third option is also a little risky would be to delete the elements from the array while iterating on it. For this I am not using <code>string.each</code> because removing items from array while running the each can be problematic also. Now I do not need to worry whether the each is cloning the the <code>|text|</code> (then the strip! will not change the original array like in previous example)</p>\n\n<pre><code>strings = ['','','','   Some text', '', '     Some another text']\n$i = strings.length - 1\nwhile $i &gt;= 0 do\n  if strings[$i] == ''\n    strings.delete_at($i)\n  else\n    strings[$i].strip!\n  end\n  $i -= 1\nend\nputs strings\n</code></pre>\n"}], "owner": {"reputation": 1049, "user_id": 4635750, "user_type": "registered", "accept_rate": 49, "profile_image": "https://graph.facebook.com/847597188612174/picture?type=large", "display_name": "Nodir Nasirov", "link": "https://stackoverflow.com/users/4635750/nodir-nasirov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 91, "favorite_count": 0, "answer_count": 5, "score": 0, "last_activity_date": 1501160849, "creation_date": 1501108031, "last_edit_date": 1501139798, "question_id": 45338452, "link": "https://stackoverflow.com/questions/45338452/how-can-i-modify-content-of-an-array-in-one-loop", "title": "How can I modify content of an array in one loop", "body": "<p>I have an array that looks like this:</p>\n\n<pre><code>strings= ['','','','   Some text', '', '     Some another text']\n</code></pre>\n\n<p>how can I map striped text only?\nright now I am doing this:</p>\n\n<pre><code>strings.select!{|string| !string.emtpy?}\nstrings.map!{|string| string.strip}\n</code></pre>\n\n<p>as you can see there are 2 loops. which I think is not efficient</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-5", "backgroundworker", "sidekiq"], "answers": [{"tags": [], "owner": {"reputation": 53136, "user_id": 28376, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/8ec1383b240b5ba15ffb9743fceb3c0e?s=128&d=identicon&r=PG", "display_name": "philnash", "link": "https://stackoverflow.com/users/28376/philnash"}, "is_accepted": true, "score": 8, "last_activity_date": 1501121498, "creation_date": 1501121498, "answer_id": 45340196, "question_id": 45338269, "link": "https://stackoverflow.com/questions/45338269/sidekiq-not-finding-object-in-worker/45340196#45340196", "title": "Sidekiq not finding object in worker", "body": "<p>You are absolutely right, the <code>after_create</code> hook in Active Record actually runs before the record is fully committed to the database. This causes a race condition with your worker script and the database, the results of which are <code>ActiveRecord::RecordNotFound</code> errors in the worker (though if the database wins the race then everything seems to go as planned).</p>\n\n<p>To ensure that your user has been saved to the database before your worker tries to access it, you should use the <code>after_commit</code> callback. Since you are only performing this operation on creation, you need <code>after_commit on: :create</code>.</p>\n\n<p>This does cause one last problem, <code>after_commit</code> callbacks never seem to run under testing. This is because Rails wraps tests in transactions and the test transaction is never actually committed so the callback doesn't fire. <a href=\"http://www.justinweiss.com/articles/a-couple-callback-gotchas-and-a-rails-5-fix/\" rel=\"noreferrer\">This blog post has a good write up on using <code>after_commit</code></a> and recommends the <a href=\"https://github.com/grosser/test_after_commit\" rel=\"noreferrer\"><code>test_after_commit</code> gem</a> to overcome this issue.</p>\n"}], "owner": {"reputation": 1075, "user_id": 6561814, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/AiS9a.png?s=128&g=1", "display_name": "jonhue", "link": "https://stackoverflow.com/users/6561814/jonhue"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 514, "favorite_count": 0, "accepted_answer_id": 45340196, "answer_count": 1, "score": 3, "last_activity_date": 1501121498, "creation_date": 1501107041, "question_id": 45338269, "link": "https://stackoverflow.com/questions/45338269/sidekiq-not-finding-object-in-worker", "title": "Sidekiq not finding object in worker", "body": "<p>When I create a new <code>User</code> in my app, I run an <code>after_create</code> method which then asynchronously triggers a Sidekiq worker.</p>\n\n<p>This worker ...</p>\n\n<pre><code>def perform user_id\n    @user = ::User.find user_id\n    # ...\nend\n</code></pre>\n\n<p>... always returns the following error:</p>\n\n<blockquote>\n  <p>ActiveRecord::RecordNotFound: Couldn't find User with 'id'=315928979197048617</p>\n</blockquote>\n\n<p>But using the rails console to check if the User id findable:</p>\n\n<pre><code>User.find(315928979197048617)\n=&gt; #&lt;User id: 315928979197048617&gt;\n</code></pre>\n\n<hr>\n\n<p>Does this happen because the creation of the new User takes some time and the worker has already performed the method when finished? If, how would I fix that behavior?</p>\n"}, {"tags": ["ruby", "teamcity", "calabash-android"], "answers": [{"comments": [{"owner": {"reputation": 6630, "user_id": 3453898, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/MjQi5.png?s=128&g=1", "display_name": "pixel", "link": "https://stackoverflow.com/users/3453898/pixel"}, "edited": false, "score": 0, "creation_date": 1501171096, "post_id": 45342022, "comment_id": 77672754, "body": "Figured it out, I had it in user path instead of system path.  Moving it to system path solved that issue.  Thanks"}, {"owner": {"reputation": 6630, "user_id": 3453898, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/MjQi5.png?s=128&g=1", "display_name": "pixel", "link": "https://stackoverflow.com/users/3453898/pixel"}, "edited": false, "score": 0, "creation_date": 1501172554, "post_id": 45342022, "comment_id": 77673769, "body": "btw, the path you provided looks strange, can you explain it please? Thanks"}], "tags": [], "owner": {"reputation": 3894, "user_id": 279355, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/87dd83e44550f39bea6f712af8d3aef3?s=128&d=identicon&r=PG", "display_name": "grundic", "link": "https://stackoverflow.com/users/279355/grundic"}, "is_accepted": true, "score": 1, "last_activity_date": 1501133153, "creation_date": 1501133153, "answer_id": 45342022, "question_id": 45337786, "link": "https://stackoverflow.com/questions/45337786/teamcity-not-recognizing-calabash-android/45342022#45342022", "title": "TeamCity not recognizing calabash-android", "body": "<p>The error clearly says what's happened: <code>'calabash-android' is not recognized as an internal or external command, operable program or batch file.</code>, which means that this program is not in <code>PATH</code> variable. </p>\n\n<p>You should <a href=\"https://confluence.jetbrains.com/display/TCD10/Configuring+Build+Parameters\" rel=\"nofollow noreferrer\">create</a> a <code>env.PATH</code> variable in your build configuration with the value alike this:</p>\n\n<pre><code>%calabash_android_path%%teamcity.agent.jvm.file.separator%bin%teamcity.agent.jvm.path.separator%%env.PATH%\n</code></pre>\n\n<p>where <code>%calabash_android_path%</code> must be a variable with full path to the folder with <code>calabash-android</code> executable.</p>\n"}], "owner": {"reputation": 6630, "user_id": 3453898, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/MjQi5.png?s=128&g=1", "display_name": "pixel", "link": "https://stackoverflow.com/users/3453898/pixel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 78, "favorite_count": 0, "accepted_answer_id": 45342022, "answer_count": 1, "score": 0, "last_activity_date": 1501133153, "creation_date": 1501104677, "question_id": 45337786, "link": "https://stackoverflow.com/questions/45337786/teamcity-not-recognizing-calabash-android", "title": "TeamCity not recognizing calabash-android", "body": "<p>TeamCity not recognizing calabash-android when running tests.</p>\n\n<p>I have following Command Line runner type in build steps that is running Custom script</p>\n\n<pre><code>calabash-android run myorg.myapp.android.dev-Signed.apk --format html --out test_report.html --format pretty\n</code></pre>\n\n<p>But running the test fails with Exit code 1 showing this in log</p>\n\n<pre><code>[14:17:37]Step 1/1: Run UI Tests (Command Line)\n[14:17:38][Step 1/1] Starting: C:\\BuildAgent\\temp\\agentTmp\\custom_script2560166106056025753.cmd\n[14:17:38][Step 1/1] in directory: C:\\BuildAgent\\work\\8cb09469a30da521\n[14:17:38][Step 1/1] 'calabash-android' is not recognized as an internal or external command,\n[14:17:38][Step 1/1] operable program or batch file.\n[14:17:38][Step 1/1] Process exited with code 1\n[14:17:38][Step 1/1] Step Run UI Tests (Command Line) failed\n</code></pre>\n"}, {"tags": ["ruby", "math"], "answers": [{"comments": [{"owner": {"reputation": 19, "user_id": 7846230, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "FreddieCodes", "link": "https://stackoverflow.com/users/7846230/freddiecodes"}, "edited": false, "score": 0, "creation_date": 1501107158, "post_id": 45338003, "comment_id": 77638603, "body": "Thank you so much"}], "tags": [], "owner": {"reputation": 13441, "user_id": 2199600, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8sl6u.jpg?s=128&g=1", "display_name": "Igor Drozdov", "link": "https://stackoverflow.com/users/2199600/igor-drozdov"}, "is_accepted": true, "score": 1, "last_activity_date": 1501105614, "creation_date": 1501105614, "answer_id": 45338003, "question_id": 45337446, "link": "https://stackoverflow.com/questions/45337446/last-digit-of-a-large-number-ruby-how-to-deal-with-nan/45338003#45338003", "title": "Last digit of a large number (Ruby) how to deal with NaN?", "body": "<p>There's an effective algorithm which assumes that only the last digit of a number being powered matters. Please, try it out on your tests and feel free to correct any flaw in this implementation that you'll find by running them</p>\n\n<pre><code>def digit_of_power(digit, n)\n  digit = digit % 10\n\n  case digit\n  when 0, 1, 5, 6 then digit\n  else\n    digit_of_square = digit * digit\n\n    if n.even?\n      digit_of_power(digit_of_square, n / 2)\n    else\n      digit * digit_of_power(digit_of_square, (n - 1) / 2) % 10\n    end\n  end\nend\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "is_accepted": false, "score": 0, "last_activity_date": 1501125601, "creation_date": 1501125601, "answer_id": 45340783, "question_id": 45337446, "link": "https://stackoverflow.com/questions/45337446/last-digit-of-a-large-number-ruby-how-to-deal-with-nan/45340783#45340783", "title": "Last digit of a large number (Ruby) how to deal with NaN?", "body": "<p><strong>Code</strong></p>\n\n<pre><code>ENDINGS = [[0,0,0,0], [1,1,1,1], [2,4,8,6], [3,9,7,1], [4,6,4,6],    \n           [5,5,5,5], [6,6,6,6], [7,9,3,1], [8,4,2,6], [9,1,9,1]]\n\ndef last_digit_of_power(digit, power)\n  return 1 if power.zero?\n  ENDINGS[digit][(power-1) % 4]\nend\n</code></pre>\n\n<p><strong>Examples</strong></p>\n\n<p>Let's try it for <code>power</code> equal to <code>5</code> and then <code>6</code>.</p>\n\n<pre><code>(5..6).each do |power|\n  puts \"\\npow = #{power}\"\n  (0..9).each {|digit| puts \"#{digit}: #{last_digit_of_power(digit, power)}\"}\nend\n\npow = 5\n0: 0\n1: 1\n2: 2\n3: 3\n4: 4\n5: 5\n6: 6\n7: 7\n8: 8\n9: 9\n\npow = 6\n0: 0\n1: 1\n2: 4\n3: 9\n4: 6\n5: 5\n6: 6\n7: 9\n8: 4\n9: 1\n</code></pre>\n\n<p><strong>Explanation</strong></p>\n\n<p>This uses the same algorithm as employed by @Igor, but I've implemented it differently. It is known (and can be easily demonstrated) that the last digit of each digit <code>0-9</code> taken to increasing powers cycles among at most <code>4</code> digits. Consider the digit <code>3</code>, for example. Since</p>\n\n<pre><code>[1,2,3,4,5].map { |power| 3**power } \n  #=&gt; [3, 9, 27, 81, 243]\n</code></pre>\n\n<p>the last digits of <code>3</code> taken to each of those <code>5</code> powers is <code>[3, 9, 7, 1, 3]</code>. Since the last digit of <code>3**5</code> is the same as the last digit of <code>3**1</code>, we infer than the last digit of <code>3**6</code> will be the same as the last digit of <code>3**(6-4)</code> (<code>3**2</code>), which is <code>9</code>, and so on.</p>\n\n<p>Now suppose we wished to calculate the last digit of <code>3**15</code>. We see that it will be the same as the last digit of <code>3**(15-4)</code> (<code>3**11</code>), which in turn will equal the last digit of <code>3**7</code> and then the last digit <code>3**3</code>, but we already know the last of these, which is <code>7</code>. It follows that the last digit of <code>3**power</code> is</p>\n\n<pre><code>[3, 9, 7, 1][(power-1) % 4]\n</code></pre>\n\n<p><code>ENDINGS</code> provides the last digits for powers <code>1-4</code> for each of the digits <code>0-9</code>. Note the cycle length is <code>1</code> for <code>0</code>, <code>1</code>, <code>5</code> and <code>6</code>, is <code>2</code> for <code>4</code> and <code>9</code> and is <code>4</code> for <code>2</code>, <code>3</code>, <code>7</code> and <code>8</code>. It's most convenient, however, to use a cycle length of <code>4</code> for all <code>10</code> digits. </p>\n\n<p><code>ENDINGS[digit]</code> equals the four endings of <code>digit</code> taken to the powers of <code>1</code>, <code>2</code>, <code>3</code> and <code>4</code>. The last digit of the digit <code>digit</code> taken to the power <code>power</code> therefore equals</p>\n\n<pre><code>ENDINGS[digit][(power-1) % 4]\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 308, "user_id": 2218094, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/PnUld.jpg?s=128&g=1", "display_name": "SgtPepper", "link": "https://stackoverflow.com/users/2218094/sgtpepper"}, "is_accepted": false, "score": 1, "last_activity_date": 1514745343, "last_edit_date": 1514745343, "creation_date": 1514685274, "answer_id": 48039346, "question_id": 45337446, "link": "https://stackoverflow.com/questions/45337446/last-digit-of-a-large-number-ruby-how-to-deal-with-nan/48039346#48039346", "title": "Last digit of a large number (Ruby) how to deal with NaN?", "body": "<p>This is my solution</p>\n\n<pre><code>def last_digit(n1, n2)\n  return 1 if n2 == 0\n  return 0 if n1 == 0\n  exp = (n2 % 4 == 0) ? 4 : n2 % 4\n  return (n1**exp) % 10\nend\n</code></pre>\n\n<p>You might want to read this article (<a href=\"https://brilliant.org/wiki/finding-the-last-digit-of-a-power/\" rel=\"nofollow noreferrer\">finding the last digit of a power</a>) for a more detailed explanation of the solution to this math problem.</p>\n\n<p>Take a look at the following table: </p>\n\n<p><a href=\"https://i.stack.imgur.com/5JP6Y.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/5JP6Y.png\" alt=\"enter image description here\"></a></p>\n\n<p>You can see that the maximum length for cycle repetition is 4.</p>\n\n<p>For instance: </p>\n\n<ul>\n<li>2 * 2 = 4</li>\n<li>4 * 2 = 8</li>\n<li>8 * 2 = 16</li>\n<li>16 * 2 = 32 </li>\n<li>32 * 2 = 64</li>\n<li>64 * 2 = 128</li>\n<li>128 * 2 = 256</li>\n<li>256 * 2 = 512</li>\n</ul>\n\n<p>The last digit in 32 is 2 ( as it is in 512), meaning that after multiplying the digit by 4, it will repeat itself.</p>\n\n<p>The algorithm follows this logic:</p>\n\n<p>You reduce the exponent, knowing that if it is divisible by 4, its new value is 4 because multiplying it 4 times gives you the last digit according to the table above. Otherwise, its value is <strong>n2 % 4</strong>.</p>\n\n<p>As a final step you do this <strong>n1^exp % 10</strong> because you only need the last number.</p>\n\n<p><strong>Note:</strong> </p>\n\n<p>I tested it successfully with large numbers.</p>\n\n<ul>\n<li>n1 = 38710248912497124917933333333284108412048102948908149081409204712406</li>\n<li>n2 = 226628148126342643123641923461846128214626</li>\n</ul>\n\n<p>By the way, I realize I am late in responding to your question. I just think it might be helpful for someone else someday.</p>\n"}], "owner": {"reputation": 19, "user_id": 7846230, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "FreddieCodes", "link": "https://stackoverflow.com/users/7846230/freddiecodes"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 581, "favorite_count": 0, "accepted_answer_id": 45338003, "answer_count": 3, "score": -1, "last_activity_date": 1514745343, "creation_date": 1501103194, "question_id": 45337446, "link": "https://stackoverflow.com/questions/45337446/last-digit-of-a-large-number-ruby-how-to-deal-with-nan", "title": "Last digit of a large number (Ruby) how to deal with NaN?", "body": "<p>Here's my code:    </p>\n\n<pre><code>def last_digit(n1, n2)\narray = (n1.to_i ** n2.to_i).to_s.split(\"\")\narray[-1].to_i\nend\n</code></pre>\n\n<p>TEST: The last decimal digit of (2^200)^(2^300), which has over 10^92 decimal digits, is 6</p>\n\n<p>I'm trying to return the last digit of a last number and I'm sure this correct but when I run tests 2 return as failing.</p>\n\n<p>I think it's due to the numbers being too large, how do I get this code to remain accurate no matter how large it gets.</p>\n\n<p>And also how do I deal with NaN, I've searched and struggled to find anything useful.</p>\n\n<p>Thanks for your help.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "devise", "devise-confirmable"], "answers": [{"comments": [{"owner": {"reputation": 350, "user_id": 8368360, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7029223df2fd3294837967a9a6416764?s=128&d=identicon&r=PG", "display_name": "djmayank", "link": "https://stackoverflow.com/users/8368360/djmayank"}, "reply_to_user": {"reputation": 3678, "user_id": 5754223, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/HVu1o.png?s=128&g=1", "display_name": "artamonovdev", "link": "https://stackoverflow.com/users/5754223/artamonovdev"}, "edited": false, "score": 1, "creation_date": 1501103408, "post_id": 45337178, "comment_id": 77636977, "body": "edit_password_path(:user)    =&gt; edit_user_password_path"}, {"owner": {"reputation": 350, "user_id": 8368360, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7029223df2fd3294837967a9a6416764?s=128&d=identicon&r=PG", "display_name": "djmayank", "link": "https://stackoverflow.com/users/8368360/djmayank"}, "reply_to_user": {"reputation": 3678, "user_id": 5754223, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/HVu1o.png?s=128&g=1", "display_name": "artamonovdev", "link": "https://stackoverflow.com/users/5754223/artamonovdev"}, "edited": false, "score": 1, "creation_date": 1501103424, "post_id": 45337178, "comment_id": 77636986, "body": "<a href=\"http://www.rubydoc.info/github/plataformatec/devise/master/Devise/Controllers/UrlHelpers\" rel=\"nofollow noreferrer\">rubydoc.info/github/plataformatec/devise/master/Devise/&hellip;</a>     Check this link"}], "tags": [], "owner": {"reputation": 350, "user_id": 8368360, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7029223df2fd3294837967a9a6416764?s=128&d=identicon&r=PG", "display_name": "djmayank", "link": "https://stackoverflow.com/users/8368360/djmayank"}, "is_accepted": true, "score": 1, "last_activity_date": 1501102261, "creation_date": 1501102261, "answer_id": 45337178, "question_id": 45337064, "link": "https://stackoverflow.com/questions/45337064/how-send-url-for-recovery-profile-with-devise-token-auth-gem-like-devise-url/45337178#45337178", "title": "How send url for recovery profile with devise_token_auth gem like devise url", "body": "<p><code>edit_password_path(:user)</code> translate to <code>edit_user_password_path</code></p>\n\n<p>Here path needs to be interchangeable with url.</p>\n\n<p>Hope it worked.</p>\n"}], "owner": {"reputation": 3678, "user_id": 5754223, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/HVu1o.png?s=128&g=1", "display_name": "artamonovdev", "link": "https://stackoverflow.com/users/5754223/artamonovdev"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 50, "favorite_count": 1, "accepted_answer_id": 45337178, "answer_count": 1, "score": 1, "last_activity_date": 1501102261, "creation_date": 1501101836, "question_id": 45337064, "link": "https://stackoverflow.com/questions/45337064/how-send-url-for-recovery-profile-with-devise-token-auth-gem-like-devise-url", "title": "How send url for recovery profile with devise_token_auth gem like devise url", "body": "<p>In my application installed gem Devise and devise_token_auth.</p>\n\n<p>When I request the recovery link then I got this url to my email: <code>http://localhost:3000/api/v1/auth/password/edit?config=default&amp;redirect_url=&amp;reset_password_token=oYGgW9-ht774ztwiigVy</code></p>\n\n<p>but I want this url <code>http://localhost:3000/users/password/edit?reset_password_token=8sfhjjfzErYpgUim-UYt</code></p>\n\n<p>What I must change in my source code?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "activerecord"], "comments": [{"owner": {"reputation": 2216, "user_id": 7165275, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d8ad41f944f38348a30791dc7f7d02c?s=128&d=identicon&r=PG&f=1", "display_name": "m. simon borg", "link": "https://stackoverflow.com/users/7165275/m-simon-borg"}, "edited": false, "score": 0, "creation_date": 1501102264, "post_id": 45337011, "comment_id": 77636340, "body": "Can you clarify the problem? If you include <code>M</code> in <code>C</code> then <code>C</code> instances can call <code>my_method</code> and have access to their own attributes. I don&#39;t know if I understand the question"}, {"owner": {"reputation": 15, "user_id": 5911114, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-T5FtYgYJrD8/AAAAAAAAAAI/AAAAAAAAKEw/PUFoSKuapoI/photo.jpg?sz=128", "display_name": "Bryan Gurney", "link": "https://stackoverflow.com/users/5911114/bryan-gurney"}, "reply_to_user": {"reputation": 2216, "user_id": 7165275, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d8ad41f944f38348a30791dc7f7d02c?s=128&d=identicon&r=PG&f=1", "display_name": "m. simon borg", "link": "https://stackoverflow.com/users/7165275/m-simon-borg"}, "edited": false, "score": 0, "creation_date": 1501102426, "post_id": 45337011, "comment_id": 77636422, "body": "I get a &#39;NoMethodError (undefined method `id&#39; for M:Module):&#39; More specifically, I have a module nested within another module that is included in the class"}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1501102703, "post_id": 45337011, "comment_id": 77636590, "body": "JFYI, ruby community standard for indentation is two spaces."}, {"owner": {"reputation": 2216, "user_id": 7165275, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d8ad41f944f38348a30791dc7f7d02c?s=128&d=identicon&r=PG&f=1", "display_name": "m. simon borg", "link": "https://stackoverflow.com/users/7165275/m-simon-borg"}, "reply_to_user": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1501102921, "post_id": 45337011, "comment_id": 77636727, "body": "If @SergioTulentsev &#39;s answer doesn&#39;t help you then you might want to update your question with more code examples, being as specific as you can."}], "answers": [{"comments": [{"owner": {"reputation": 15, "user_id": 5911114, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-T5FtYgYJrD8/AAAAAAAAAAI/AAAAAAAAKEw/PUFoSKuapoI/photo.jpg?sz=128", "display_name": "Bryan Gurney", "link": "https://stackoverflow.com/users/5911114/bryan-gurney"}, "edited": false, "score": 0, "creation_date": 1501102872, "post_id": 45337296, "comment_id": 77636694, "body": "Does it matter then if the module method is nested inside of another module? <code>module M module N   def my_method     print(&quot;id: #{id}&quot;)     print(&quot;fname: #{f_name}&quot;)     print(&quot;lname: #{l_name}&quot;)     print(&quot;address: #{address}&quot;)   end end end</code>"}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "reply_to_user": {"reputation": 15, "user_id": 5911114, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-T5FtYgYJrD8/AAAAAAAAAAI/AAAAAAAAKEw/PUFoSKuapoI/photo.jpg?sz=128", "display_name": "Bryan Gurney", "link": "https://stackoverflow.com/users/5911114/bryan-gurney"}, "edited": false, "score": 0, "creation_date": 1501102908, "post_id": 45337296, "comment_id": 77636716, "body": "@BryanGurney This piece of code is unreadable. But do try it."}, {"owner": {"reputation": 2216, "user_id": 7165275, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d8ad41f944f38348a30791dc7f7d02c?s=128&d=identicon&r=PG&f=1", "display_name": "m. simon borg", "link": "https://stackoverflow.com/users/7165275/m-simon-borg"}, "reply_to_user": {"reputation": 15, "user_id": 5911114, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-T5FtYgYJrD8/AAAAAAAAAAI/AAAAAAAAKEw/PUFoSKuapoI/photo.jpg?sz=128", "display_name": "Bryan Gurney", "link": "https://stackoverflow.com/users/5911114/bryan-gurney"}, "edited": false, "score": 1, "creation_date": 1501103119, "post_id": 45337296, "comment_id": 77636818, "body": "@BryanGurney Then you have two choices: <code>include N</code> inside of <code>M</code>, and then <code>C</code> will have it as well (as will any class/module that includes <code>M</code>), or inside <code>C</code> you can <code>include M::N</code>"}, {"owner": {"reputation": 15, "user_id": 5911114, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-T5FtYgYJrD8/AAAAAAAAAAI/AAAAAAAAKEw/PUFoSKuapoI/photo.jpg?sz=128", "display_name": "Bryan Gurney", "link": "https://stackoverflow.com/users/5911114/bryan-gurney"}, "edited": false, "score": 0, "creation_date": 1501103310, "post_id": 45337296, "comment_id": 77636925, "body": "I believe this comment is what I was looking for."}], "tags": [], "owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "is_accepted": false, "score": 0, "last_activity_date": 1501102882, "last_edit_date": 1501102882, "creation_date": 1501102683, "answer_id": 45337296, "question_id": 45337011, "link": "https://stackoverflow.com/questions/45337011/access-classes-object-data-from-activerecord-callback-to-external-module/45337296#45337296", "title": "Access Classes Object Data from ActiveRecord callback to external Module", "body": "<p>When you include it like that, then <code>self</code> in <code>my_method</code> will be an instance of C. And so you just access the attributes normally, as if it was a method in C itself.</p>\n\n<pre><code>module M\n  def my_method\n    print(\"id: #{id}\")\n    print(\"fname: #{f_name}\")\n    print(\"lname: #{l_name}\")\n    print(\"address: #{address}\")\n  end\nend\n</code></pre>\n\n<p>Understanding the concept of \"current <code>self</code>\" and how different constructs (including a module, <code>instance_eval</code>, etc.) affect it, is crucial for becoming any good in ruby.</p>\n"}, {"comments": [{"owner": {"reputation": 15, "user_id": 5911114, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-T5FtYgYJrD8/AAAAAAAAAAI/AAAAAAAAKEw/PUFoSKuapoI/photo.jpg?sz=128", "display_name": "Bryan Gurney", "link": "https://stackoverflow.com/users/5911114/bryan-gurney"}, "edited": false, "score": 0, "creation_date": 1501105284, "post_id": 45337526, "comment_id": 77637796, "body": "My problem was i was using a method called self.insert (which was limiting the scope to the module) I believe"}], "tags": [], "owner": {"reputation": 2216, "user_id": 7165275, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d8ad41f944f38348a30791dc7f7d02c?s=128&d=identicon&r=PG&f=1", "display_name": "m. simon borg", "link": "https://stackoverflow.com/users/7165275/m-simon-borg"}, "is_accepted": true, "score": 0, "last_activity_date": 1501104862, "last_edit_date": 1501104862, "creation_date": 1501103557, "answer_id": 45337526, "question_id": 45337011, "link": "https://stackoverflow.com/questions/45337011/access-classes-object-data-from-activerecord-callback-to-external-module/45337526#45337526", "title": "Access Classes Object Data from ActiveRecord callback to external Module", "body": "<p>Including <code>ModuleA</code> in <code>ClassB</code> gives <code>ClassB</code> all of <code>ModuleA</code>'s instance methods as if they had been defined directly in <code>ClassB</code>. The methods are no different than any of <code>ClassB</code>'s other instance methods. You call them the same way (<code>b = ClassB.new; b.a_method</code>), and within the method <code>self</code> will be the instance of <code>ClassB</code> that's calling the method, so you have direct access to any other methods or variables defined within the <code>ClassB</code> instance scope.</p>\n\n<p>If you have a nested Module you can include it in its parent, and then any Class that includes the parent will have access to the nested Module's methods.</p>\n\n<pre><code>module A\n  module B\n    def where_am_i\n      \"Inside mod B\"\n    end\n  end\n\n  include B\nend\n\nclass C\n  include A\nend\n\nc = C.new\nc.where_am_i # =&gt; \"Inside mod B\"\n</code></pre>\n\n<p>In your case the two nested Modules should have different definitions of the same method name, so you want to include only one or the other. You do so with the syntax <code>include ParentModule::NestedModule</code></p>\n\n<pre><code>module M\n  BASE_URL = 'www.googleapis.com'\n  TOKEN = *generated oauth token*\n\n  module N\n    def my_method\n      print(\"id: #{id}\")\n      print(\"fname: #{f_name}\")\n      print(\"lname: #{l_name}\")\n      print(\"address: #{address}\")\n    end\n  end\n\n  module O\n    def my_method\n      #assume this does something different from module N\n      print(\"id: #{id}\")\n      print(\"fname: #{f_name}\")\n      print(\"lname: #{l_name}\")\n      print(\"address: #{address}\")\n    end\n  end\nend\n\nclass C\n  include M::N\n  attr_accessible :id, :f_name, :l_name, :address\n  after_create :my_method\nend\n\nclass D\n  include M::O\n  attr_accessible :id, :f_name, :l_name, :address\n  after_create :my_method\nend\n</code></pre>\n"}], "owner": {"reputation": 15, "user_id": 5911114, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-T5FtYgYJrD8/AAAAAAAAAAI/AAAAAAAAKEw/PUFoSKuapoI/photo.jpg?sz=128", "display_name": "Bryan Gurney", "link": "https://stackoverflow.com/users/5911114/bryan-gurney"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 47, "favorite_count": 0, "accepted_answer_id": 45337526, "answer_count": 2, "score": 0, "last_activity_date": 1501104862, "creation_date": 1501101660, "last_edit_date": 1501103254, "question_id": 45337011, "link": "https://stackoverflow.com/questions/45337011/access-classes-object-data-from-activerecord-callback-to-external-module", "title": "Access Classes Object Data from ActiveRecord callback to external Module", "body": "<p>I have two classes, both make API calls to the same server using an OAuth 2 Bearer Access token. I'm trying to wrap the API related code up in a module so that I can utilize ActiveRecord's callback functionality from both these classes easily.\nI cannot find anywhere that describes how to access the calling class's data (or if I have to pass it as a parameter with the callback).</p>\n\n<pre><code>module M\n  BASE_URL = 'www.googleapis.com'\n  TOKEN = *generated oauth token*\n  module N\n    def my_method\n      print(\"id: #{C.id}\")\n      print(\"fname: #{C.f_name}\")\n      print(\"lname: #{C.l_name}\")\n      print(\"address: #{C.address}\")\n    end\n  end\n  module O\n    def my_method\n      #assume this does something different from module N\n      print(\"id: #{D.id}\")\n      print(\"fname: #{D.f_name}\")\n      print(\"lname: #{D.l_name}\")\n      print(\"address: #{D.address}\")\n    end\n  end\nend\n\nclass C\n    include M\n    attr_accessible :id, :f_name, :l_name, :address\n    after_create N::my_method\nend\nclass D\n  include M\n  attr_accessible :id, :f_name, :l_name, :address\n  after_create O::my_method\nend\n</code></pre>\n\n<p>How would I go about accessing the class C's data from within module M's my_method? Or am I completely off base?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "hash", "charts"], "answers": [{"tags": [], "owner": {"reputation": 1022, "user_id": 8088139, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/12c57f53526db57b9982402c7f4a353f?s=128&d=identicon&r=PG&f=1", "display_name": "Michael Gorman", "link": "https://stackoverflow.com/users/8088139/michael-gorman"}, "is_accepted": false, "score": 0, "last_activity_date": 1501102035, "creation_date": 1501102035, "answer_id": 45337122, "question_id": 45336933, "link": "https://stackoverflow.com/questions/45336933/group-by-month-and-week/45337122#45337122", "title": "Group by month and week", "body": "<p>If you have the hash of data (as a hash) already an option would be to use <code>reduce</code></p>\n\n<p>for the month it would be </p>\n\n<pre><code>data.reduce({}) do |memo, (date, value)|\n  new_date = date.beginning_of_month.strftime(\"%B %Y\")\n  memo[new_date] ||= 0\n  memo[new_date] += value\n  memo\nend\n</code></pre>\n\n<p>for the week it would be</p>\n\n<pre><code>data.reduce({}) do |memo, (date, value)|\n  new_date = date.beginning_of_week.strftime(\"%B %e %Y\")\n  memo[new_date] ||= 0\n  memo[new_date] += value\n  memo\nend\n</code></pre>\n\n<p>You can use <a href=\"https://apidock.com/ruby/Date/strftime\" rel=\"nofollow noreferrer\">this document</a> to modify the <code>strftime</code> format however you want it.</p>\n"}, {"comments": [{"owner": {"reputation": 113, "user_id": 8372392, "user_type": "registered", "accept_rate": 9, "profile_image": "https://www.gravatar.com/avatar/2b7e101bb8fd4cc33a74ef6454932888?s=128&d=identicon&r=PG&f=1", "display_name": "Wako", "link": "https://stackoverflow.com/users/8372392/wako"}, "edited": false, "score": 0, "creation_date": 1501144046, "post_id": 45337271, "comment_id": 77651811, "body": "Thanks ! :) its what i need"}], "tags": [], "owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "is_accepted": false, "score": 1, "last_activity_date": 1501126058, "last_edit_date": 1501126058, "creation_date": 1501102591, "answer_id": 45337271, "question_id": 45336933, "link": "https://stackoverflow.com/questions/45336933/group-by-month-and-week/45337271#45337271", "title": "Group by month and week", "body": "<p>Given the desired result for the OP's example, I've assumed that the OP means \"month and year\" rather than by \"week and month\".</p>\n\n<p>I also assumed that the keys of the input hash are intended to be strings (rather than date objects) and the keys of the hash returned are intended to be strings. In any event, I would use <a href=\"http://ruby-doc.org/core-2.4.0/Hash.html#method-c-new\" rel=\"nofollow noreferrer\">Hash::new</a> with a default value of zero (a <em>counting hash</em>). See the doc for details.</p>\n\n<pre><code>dates = {\"Sat, 23 Apr 2016\"=&gt;6.0, \"Mon, 06 Mar 2017\"=&gt;9.0,\n         \"Tue, 04 Apr 2017\"=&gt;13.0, \"Tue, 11 Apr 2017\"=&gt;25.0}\n\ndates.each_with_object(Hash.new(0)) { |(k,v),h| h[k[-8..-1]] += v.to_i }\n   #=&gt; {\"Apr 2016\"=&gt;6, \"Mar 2017\"=&gt;9, \"Apr 2017\"=&gt;38}\n</code></pre>\n\n<p>If the dates of the input hash are date objects, we can do the following. First create the date objects.</p>\n\n<pre><code>require 'date'\n\ndates =  {\"Sat, 23 Apr 2016\"=&gt;6.0, \"Mon, 06 Mar 2017\"=&gt;9.0,\n         \"Tue, 04 Apr 2017\"=&gt;13.0, \"Tue, 11 Apr 2017\"=&gt;25.0}.\n  map { |str, v| [Date.parse(str), v] }.to_h\n    #=&gt; {#&lt;Date: 2016-04-23 ((2457502j,0s,0n),+0s,2299161j)&gt;=&gt;6.0,\n    #    #&lt;Date: 2017-03-06 ((2457819j,0s,0n),+0s,2299161j)&gt;=&gt;9.0,\n    #    #&lt;Date: 2017-04-04 ((2457848j,0s,0n),+0s,2299161j)&gt;=&gt;13.0,\n    #    #&lt;Date: 2017-04-11 ((2457855j,0s,0n),+0s,2299161j)&gt;=&gt;25.0}\n</code></pre>\n\n<p>Then we can write</p>\n\n<pre><code>dates.each_with_object(Hash.new(0)) { |(k,v),h| h[k.strftime(\"%b %Y\")] += v.to_i }\n  #=&gt; {\"Apr 2016\"=&gt;6, \"Mar 2017\"=&gt;9, \"Apr 2017\"=&gt;38}\n</code></pre>\n\n<p>See <a href=\"http://ruby-doc.org/stdlib-2.4.0/libdoc/date/rdoc/DateTime.html#method-i-strftime\" rel=\"nofollow noreferrer\">DateTime#strftime</a>.</p>\n\n<p>This is a pure-Ruby solution.</p>\n"}], "owner": {"reputation": 113, "user_id": 8372392, "user_type": "registered", "accept_rate": 9, "profile_image": "https://www.gravatar.com/avatar/2b7e101bb8fd4cc33a74ef6454932888?s=128&d=identicon&r=PG&f=1", "display_name": "Wako", "link": "https://stackoverflow.com/users/8372392/wako"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 380, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1501132553, "creation_date": 1501101413, "last_edit_date": 1501132553, "question_id": 45336933, "link": "https://stackoverflow.com/questions/45336933/group-by-month-and-week", "title": "Group by month and week", "body": "<p>I would like to know what is the best way to group my hash of \n<code>{date-&gt;value}</code> in month and week.</p>\n\n<pre><code>{Sat, 23 Apr 2016=&gt;6.0, Mon, 06 Mar 2017=&gt;9.0, Tue, 04 Apr 2017=&gt;13.0, Tue, 11 Apr 2017=&gt;25.0}\n</code></pre>\n\n<p>I would like a result like:</p>\n\n<pre><code>{Apr 2016=&gt;6, Mar 2017=&gt;9, Apr 2017=&gt;38}\n</code></pre>\n\n<p>I tried with Groupdate/Chartkick but I am not getting a good result.</p>\n\n<p>Thanks</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "answers": [{"comments": [{"owner": {"reputation": 318, "user_id": 5685405, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/2dc9cecb4d319605cfe1f823772d32dd?s=128&d=identicon&r=PG&f=1", "display_name": "Acrux", "link": "https://stackoverflow.com/users/5685405/acrux"}, "edited": false, "score": 0, "creation_date": 1501101868, "post_id": 45337001, "comment_id": 77636143, "body": "The error did not appear anymore, but the date was not displayed. Not sure why."}, {"owner": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "reply_to_user": {"reputation": 318, "user_id": 5685405, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/2dc9cecb4d319605cfe1f823772d32dd?s=128&d=identicon&r=PG&f=1", "display_name": "Acrux", "link": "https://stackoverflow.com/users/5685405/acrux"}, "edited": false, "score": 1, "creation_date": 1501101935, "post_id": 45337001, "comment_id": 77636181, "body": "If you need to print such value in the view, then you can use just <code>room.date.strftime(&quot;%B %e, %Y &quot;)</code> as @knut has mentioned, give it a try."}], "tags": [], "owner": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "is_accepted": false, "score": 1, "last_activity_date": 1501101614, "creation_date": 1501101614, "answer_id": 45337001, "question_id": 45336855, "link": "https://stackoverflow.com/questions/45336855/how-to-use-srtftime-in-views/45337001#45337001", "title": "How to use srtftime in views", "body": "<p>It's asking for a String instead a Date data type, pass it a String, try with:</p>\n\n<pre><code>Date.parse(room.date.to_s).strftime(\"%B %e, %Y\")\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 313, "user_id": 7485168, "user_type": "registered", "profile_image": "https://graph.facebook.com/1797273820298202/picture?type=large", "display_name": "Jok\u016bbas Brunonas Pu\u010dinskas", "link": "https://stackoverflow.com/users/7485168/jok%c5%abbas-brunonas-pu%c4%8dinskas"}, "is_accepted": true, "score": 3, "last_activity_date": 1501101766, "creation_date": 1501101766, "answer_id": 45337042, "question_id": 45336855, "link": "https://stackoverflow.com/questions/45336855/how-to-use-srtftime-in-views/45337042#45337042", "title": "How to use srtftime in views", "body": "<p>If your <code>room.date</code> is type of date you shouldn't try to parse it. So I'd suggest first try to use <code>&lt;%= room.date.strftime('%B %e, %Y')</code>. Please  comment below if that wont work.</p>\n"}, {"tags": [], "owner": {"reputation": 25573, "user_id": 676874, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/c8e67ec01dc3e7c402255ff26785863f?s=128&d=identicon&r=PG", "display_name": "knut", "link": "https://stackoverflow.com/users/676874/knut"}, "is_accepted": false, "score": 0, "last_activity_date": 1501101812, "creation_date": 1501101812, "answer_id": 45337056, "question_id": 45336855, "link": "https://stackoverflow.com/questions/45336855/how-to-use-srtftime-in-views/45337056#45337056", "title": "How to use srtftime in views", "body": "<p>When <code>room.date</code> is a date, why do you want to parse it? You could use the Date directly.</p>\n\n<p>Can you try:</p>\n\n<pre><code>&lt;%= room.date.strftime(\"%B %e, %Y \") %&gt;\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 9971, "user_id": 8255744, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de22299534b5a8ed244ee8ff4aa6c481?s=128&d=identicon&r=PG&f=1", "display_name": "Simple Lime", "link": "https://stackoverflow.com/users/8255744/simple-lime"}, "is_accepted": false, "score": 3, "last_activity_date": 1501104265, "creation_date": 1501104265, "answer_id": 45337692, "question_id": 45336855, "link": "https://stackoverflow.com/questions/45336855/how-to-use-srtftime-in-views/45337692#45337692", "title": "How to use srtftime in views", "body": "<p>Just to throw a different hat into the ring, you can also use</p>\n\n<pre><code>&lt;%= l room.date, format: :long %&gt;\n</code></pre>\n\n<p>which, by default, uses <code>\"%B %d, %Y\"</code> but can be easily changed by adding into your <code>config/locales/en.yml</code>.</p>\n\n<pre><code>en:\n  date:\n    formats:\n      long: \"%B %e, %Y\"\n  time:\n    formats:\n      long: \"%B %e, %Y\"\n</code></pre>\n\n<p>Use <code>date:</code> if it's a <code>Date</code> object or <code>time:</code> if it's <code>DateTime</code> or <code>Time</code>. This is short for <code>I18n.l</code> and looks like it works as far back a <a href=\"http://guides.rubyonrails.org/v3.2.13/i18n.html#adding-date-time-formats\" rel=\"nofollow noreferrer\">rails 3.2.13</a> at the least (it's hard to tell which rails you're using).</p>\n\n<p>This way, if you ever want to support different locales the dates are all set up for it and, probably more importantly, it moves the date format out of your views, so if you ever decide you want a different format (<code>\"%A %B %e, %Y\"</code>, for instance) you can change it in one place and all the views displaying dates get updated.</p>\n\n<p>Note: If it is a <code>Time</code> or <code>DateTime</code> you might want to use instead</p>\n\n<pre><code>&lt;%= l room.date, format: :date %&gt;\n</code></pre>\n\n<p>and in <code>config/locales/en.yml</code></p>\n\n<pre><code>en:\n  time:\n    formats:\n      date: \"%B %e, %Y\"\n</code></pre>\n\n<p>so your <code>format: :long</code> still shows the time portion when you want it to</p>\n"}], "owner": {"reputation": 318, "user_id": 5685405, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/2dc9cecb4d319605cfe1f823772d32dd?s=128&d=identicon&r=PG&f=1", "display_name": "Acrux", "link": "https://stackoverflow.com/users/5685405/acrux"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 71, "favorite_count": 0, "accepted_answer_id": 45337042, "answer_count": 4, "score": 0, "last_activity_date": 1501104265, "creation_date": 1501101137, "last_edit_date": 1501104118, "question_id": 45336855, "link": "https://stackoverflow.com/questions/45336855/how-to-use-srtftime-in-views", "title": "How to use srtftime in views", "body": "<p>I am getting an error with <code>strftime</code>.</p>\n\n<p>My views look like:</p>\n\n<p><code>&lt;%=room.date%&gt;</code> which works and yields \"2017-07-27\".</p>\n\n<p>However, I want to convert this to \"July 27, 2017\".</p>\n\n<p><code>&lt;%= Date.parse(room.date).strftime(\"%B %e, %Y \") %&gt;</code> does not work and causes the following error: </p>\n\n<blockquote>\n  <p>ActionView::Template::Error (no implicit conversion of Date into\n  String)</p>\n</blockquote>\n\n<p>My schema is:</p>\n\n<pre><code>t.date     \"date\"\n</code></pre>\n\n<p>I don't know what I am doing wrong. Thanks!</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "postgresql", "ruby-on-rails-4", "heroku"], "comments": [{"owner": {"reputation": 1962, "user_id": 2945616, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/TL0yY.jpg?s=128&g=1", "display_name": "Atul Khanduri", "link": "https://stackoverflow.com/users/2945616/atul-khanduri"}, "edited": false, "score": 0, "creation_date": 1501102709, "post_id": 45336844, "comment_id": 77636594, "body": "Can you print the output of <code>heroku config --app your_app_name</code> command?"}, {"owner": {"reputation": 2157, "user_id": 5849229, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/d77f7eef721220ff7fa979025e6d31b9?s=128&d=identicon&r=PG&f=1", "display_name": "gdfgdfg", "link": "https://stackoverflow.com/users/5849229/gdfgdfg"}, "reply_to_user": {"reputation": 1962, "user_id": 2945616, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/TL0yY.jpg?s=128&g=1", "display_name": "Atul Khanduri", "link": "https://stackoverflow.com/users/2945616/atul-khanduri"}, "edited": false, "score": 0, "creation_date": 1501102904, "post_id": 45336844, "comment_id": 77636714, "body": "LANG:                     en_US.UTF-8 RACK_ENV:                 production RAILS_ENV:                production RAILS_LOG_TO_STDOUT:      enabled RAILS_SERVE_STATIC_FILES: enabled SECRET_KEY_BASE:          yyyyyyyyyyyyyyyyyyyyyyy KEY HERE"}], "answers": [{"comments": [{"owner": {"reputation": 2157, "user_id": 5849229, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/d77f7eef721220ff7fa979025e6d31b9?s=128&d=identicon&r=PG&f=1", "display_name": "gdfgdfg", "link": "https://stackoverflow.com/users/5849229/gdfgdfg"}, "edited": false, "score": 1, "creation_date": 1501103984, "post_id": 45337380, "comment_id": 77637271, "body": "<code>rails_12factor</code> is no needed for Rails 5. Check documentation: <a href=\"https://github.com/heroku/rails_12factor\" rel=\"nofollow noreferrer\">github.com/heroku/rails_12factor</a>"}], "tags": [], "owner": {"reputation": 350, "user_id": 8368360, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7029223df2fd3294837967a9a6416764?s=128&d=identicon&r=PG", "display_name": "djmayank", "link": "https://stackoverflow.com/users/8368360/djmayank"}, "is_accepted": false, "score": 0, "last_activity_date": 1501103292, "last_edit_date": 1501103292, "creation_date": 1501102955, "answer_id": 45337380, "question_id": 45336844, "link": "https://stackoverflow.com/questions/45336844/error-when-run-migrations-on-heroku-postgresql-with-rails-5/45337380#45337380", "title": "Error when run migrations on Heroku, PostgreSQL with Rails 5", "body": "<p>Follow some steps in serial order,</p>\n\n<ol>\n<li><p><code>$ heroku login</code></p></li>\n<li><p>In Gemfile, add the pg gem to your Rails project. Change:</p>\n\n<p><code>gem sqlite</code> <br><br>to</p>\n\n<p><code>gem 'sqlite3', group: :development</code> <br>\n<code>gem 'pg', '0.18.1', group: :production</code></p></li>\n<li><p>In Gemfile, add the rails_12factor gem::</p>\n\n<p><code>gem 'rails_12factor', group: :production</code></p></li>\n<li><p><code>$ bundle install</code></p></li>\n<li><p>Ensure config/database.yml is using the postgresql adapter. Change:</p>\n\n<p><code>production:</code><br>\n<code>&lt;&lt;: *default</code><br>\n<code>database: db/production.sqlite3</code><br>\nto<br></p>\n\n<p><code>production:</code><br>\n<code>&lt;&lt;: *default</code><br>\n<code>adapter: postgresql</code><br>\n<code>database: db/production.sqlite3</code><br></p></li>\n<li><code>$ git add .</code> <br>\n<code>$ git commit -m \"Heroku config\"</code></li>\n<li><code>$ heroku create</code></li>\n<li><code>$ git push heroku master</code></li>\n<li><code>$ heroku run rake db:migrate</code>\n<br>\nI hope it worked.</li>\n</ol>\n\n<p>SO FOLLOW STEP 5 correctly.</p>\n"}, {"tags": [], "owner": {"reputation": 1962, "user_id": 2945616, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/TL0yY.jpg?s=128&g=1", "display_name": "Atul Khanduri", "link": "https://stackoverflow.com/users/2945616/atul-khanduri"}, "is_accepted": true, "score": 11, "last_activity_date": 1501103040, "creation_date": 1501103040, "answer_id": 45337407, "question_id": 45336844, "link": "https://stackoverflow.com/questions/45336844/error-when-run-migrations-on-heroku-postgresql-with-rails-5/45337407#45337407", "title": "Error when run migrations on Heroku, PostgreSQL with Rails 5", "body": "<p>It seems like database is not provided for your app, you need to add one:</p>\n\n<pre><code>heroku addons:create heroku-postgresql\n</code></pre>\n\n<p>You can verify the database was added to your application by running:</p>\n\n<pre><code>heroku config --app your_app_name\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 125670, "user_id": 6464308, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/12PVX.jpg?s=128&g=1", "display_name": "Laurenz Albe", "link": "https://stackoverflow.com/users/6464308/laurenz-albe"}, "edited": false, "score": 0, "creation_date": 1554908652, "post_id": 55615371, "comment_id": 97925041, "body": "Why should OP <i>delete</i> a database when the problem is to connect?"}], "tags": [], "owner": {"reputation": 1, "user_id": 6266388, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/13042f4b646ee9df07925c99c28b35db?s=128&d=identicon&r=PG&f=1", "display_name": "taehyeong Kim", "link": "https://stackoverflow.com/users/6266388/taehyeong-kim"}, "is_accepted": false, "score": -1, "last_activity_date": 1554907306, "creation_date": 1554907306, "answer_id": 55615371, "question_id": 45336844, "link": "https://stackoverflow.com/questions/45336844/error-when-run-migrations-on-heroku-postgresql-with-rails-5/55615371#55615371", "title": "Error when run migrations on Heroku, PostgreSQL with Rails 5", "body": "<p>After delete old DB, you should execute this</p>\n\n<pre><code>heroku pg:promote HEROKU_POSTGRESQL_NEW_DATABASE\n</code></pre>\n\n<p>You can check your DB nickname by</p>\n\n<pre><code>heroku pg:info\n</code></pre>\n"}], "owner": {"reputation": 2157, "user_id": 5849229, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/d77f7eef721220ff7fa979025e6d31b9?s=128&d=identicon&r=PG&f=1", "display_name": "gdfgdfg", "link": "https://stackoverflow.com/users/5849229/gdfgdfg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2611, "favorite_count": 1, "accepted_answer_id": 45337407, "answer_count": 3, "score": 1, "last_activity_date": 1554907306, "creation_date": 1501101091, "last_edit_date": 1524793265, "question_id": 45336844, "link": "https://stackoverflow.com/questions/45336844/error-when-run-migrations-on-heroku-postgresql-with-rails-5", "title": "Error when run migrations on Heroku, PostgreSQL with Rails 5", "body": "<p>I deploy Rails 5 with PostgreSQL to free app in Heroku. This is my configuration from <code>database.yml</code>:</p>\n\n<pre><code>production:\n  adapter: postgresql\n  username: root\n  password:\n  database: example\n</code></pre>\n\n<p>When I run <code>heroku run rake db:migrate</code>, I see this error:</p>\n\n<blockquote>\n  <p>rake aborted!\n  PG::ConnectionBad: could not connect to server: No such file or directory\n      Is the server running locally and accepting\n      connections on Unix domain socket \"/var/run/postgresql/.s.PGSQL.5432\"?</p>\n</blockquote>\n\n<p>If I add this line to <code>database.yml</code>:</p>\n\n<pre><code>host: localhost\n</code></pre>\n\n<p>and run migration again, I see this error:</p>\n\n<blockquote>\n  <p>rake aborted!\n  PG::ConnectionBad: could not connect to server: Connection refused\n      Is the server running on host \"localhost\" (127.0.0.1) and accepting\n      TCP/IP connections on port 5432?</p>\n</blockquote>\n\n<p>How to fix it ?</p>\n"}, {"tags": ["ruby", "set", "data-comparison"], "answers": [{"comments": [{"owner": {"reputation": 301, "user_id": 3875042, "user_type": "registered", "accept_rate": 89, "profile_image": "https://graph.facebook.com/1557167620/picture?type=large", "display_name": "Kurt W", "link": "https://stackoverflow.com/users/3875042/kurt-w"}, "edited": false, "score": 0, "creation_date": 1501102042, "post_id": 45336730, "comment_id": 77636232, "body": "this will not work for my data because I need to dedup based on specific hash keys present in both arrays (&#39;id&#39;, &#39;ref&#39;, &#39;name&#39;).  I don&#39;t want to de-dup on ALL of the key/value pairs as it will lead to too many false positives with my data.   Can you amend or withdraw your answer so this continues to remain visibile?  Thanks in advance!"}, {"owner": {"reputation": 9030, "user_id": 5101476, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JCQrl.jpg?s=128&g=1", "display_name": "ice\u30c4", "link": "https://stackoverflow.com/users/5101476/ice%e3%83%84"}, "reply_to_user": {"reputation": 301, "user_id": 3875042, "user_type": "registered", "accept_rate": 89, "profile_image": "https://graph.facebook.com/1557167620/picture?type=large", "display_name": "Kurt W", "link": "https://stackoverflow.com/users/3875042/kurt-w"}, "edited": false, "score": 1, "creation_date": 1501102361, "post_id": 45336730, "comment_id": 77636388, "body": "@KurtW I&#39;ll keep this answer up for a while, if only to serve as a warning to others to not post the same thing. Sorry I misunderstood your question."}, {"owner": {"reputation": 301, "user_id": 3875042, "user_type": "registered", "accept_rate": 89, "profile_image": "https://graph.facebook.com/1557167620/picture?type=large", "display_name": "Kurt W", "link": "https://stackoverflow.com/users/3875042/kurt-w"}, "edited": false, "score": 0, "creation_date": 1501107300, "post_id": 45336730, "comment_id": 77638656, "body": "@Cary Swoveland, is your answer at <a href=\"https://stackoverflow.com/questions/30494890/ruby-compare-two-arrays-of-hash-with-certain-keys\" title=\"ruby compare two arrays of hash with certain keys\">stackoverflow.com/questions/30494890/&hellip;</a> a perfect match for my question?  Thank you again for all your help in recent months!"}], "tags": [], "owner": {"reputation": 9030, "user_id": 5101476, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JCQrl.jpg?s=128&g=1", "display_name": "ice\u30c4", "link": "https://stackoverflow.com/users/5101476/ice%e3%83%84"}, "is_accepted": false, "score": 0, "last_activity_date": 1501102029, "last_edit_date": 1501102029, "creation_date": 1501100658, "answer_id": 45336730, "question_id": 45336535, "link": "https://stackoverflow.com/questions/45336535/ruby-show-deltas-between-2-array-of-hashes-based-on-subset-of-hash-keys/45336730#45336730", "title": "Ruby - Show Deltas Between 2 array of hashes based on subset of hash keys", "body": "<p>See <a href=\"http://ruby-doc.org/core-2.4.1/Array.html#method-i-2D\" rel=\"nofollow noreferrer\"><code>Array#-</code></a> and <a href=\"http://ruby-doc.org/core-2.4.1/Array.html#method-i-26\" rel=\"nofollow noreferrer\"><code>Array#&amp;</code></a></p>\n\n<pre><code>array1 - array2   #data in array1 but not in array2\narray2 - array1   #data in array2 but not in array1\narray1 &amp; array2   #data in both array1 and array2\n</code></pre>\n\n<p>Since you've tagged this question <a href=\"/questions/tagged/set\" class=\"post-tag\" title=\"show questions tagged &#39;set&#39;\" rel=\"tag\">set</a> you can use sets similarly:</p>\n\n<pre><code>require 'set'\n\nset1 = array1.to_set\nset2 = array2.to_set\n\nset1 - set2\nset2 - set1\nset1 &amp; set2\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 301, "user_id": 3875042, "user_type": "registered", "accept_rate": 89, "profile_image": "https://graph.facebook.com/1557167620/picture?type=large", "display_name": "Kurt W", "link": "https://stackoverflow.com/users/3875042/kurt-w"}, "edited": false, "score": 0, "creation_date": 1501291469, "post_id": 45337128, "comment_id": 77729968, "body": "Thank you so very much for taking the time to help out here!  It&#39;s not as pretty as some things but I haven&#39;t seen a better solution for A -&gt; B, B -&gt; A, and the overlap.  Curious, does this do what I want <a href=\"https://stackoverflow.com/questions/30494890/ruby-compare-two-arrays-of-hash-with-certain-keys\" title=\"ruby compare two arrays of hash with certain keys\">stackoverflow.com/questions/30494890/&hellip;</a> ?  Thanks either way, marked as accepted!"}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1501549050, "post_id": 45337128, "comment_id": 77816008, "body": "Kurt, <code>array1[0]</code> is presently not in the &quot;Object containing data in <code>array1</code> but not in <code>array2</code>&quot; because there is a hash in <code>array2</code>  (<code>array2[0]</code>) whose values for the first three keys equal the values of the corresponding keys in <code>array1[0]</code>. I assume that would still be the case if <code>array2[0][&#39;extra&#39;] =&gt; &#39;Not Sorted On 99&#39;</code> rather than &quot;...<code>Sorted On 5</code>&quot;. If so, yes, I believe the other answer would apply here as well."}, {"owner": {"reputation": 301, "user_id": 3875042, "user_type": "registered", "accept_rate": 89, "profile_image": "https://graph.facebook.com/1557167620/picture?type=large", "display_name": "Kurt W", "link": "https://stackoverflow.com/users/3875042/kurt-w"}, "reply_to_user": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1501625791, "post_id": 45337128, "comment_id": 77858167, "body": "@CarySwoveland, thanks much for getting back to me.  Can you clarify that just a bit? Are you asking if <code>array1</code>/<code>array2</code> both have the <code>extra</code> key/value pair and if it should be considered in the calculation?  If so, <code>extra</code> exists in both sets and has the same value in all cases (e.g. if &#39;id&#39; =&gt; &#39;2&#39;, &#39;ref&#39; =&gt; &#39;1002&#39;, &#39;name&#39; =&gt; &#39;NY&#39;, then <code>extra</code> will always be equal to &#39;Not Sorted On 7&#39;.  Thanks for clarifying.  Also, does Simple Lime&#39;s answer more closely meet my needs?  If so, you seem to be the master of condensing things, maybe you have an improvement suggestion? Thank you again!"}, {"owner": {"reputation": 9971, "user_id": 8255744, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de22299534b5a8ed244ee8ff4aa6c481?s=128&d=identicon&r=PG&f=1", "display_name": "Simple Lime", "link": "https://stackoverflow.com/users/8255744/simple-lime"}, "reply_to_user": {"reputation": 301, "user_id": 3875042, "user_type": "registered", "accept_rate": 89, "profile_image": "https://graph.facebook.com/1557167620/picture?type=large", "display_name": "Kurt W", "link": "https://stackoverflow.com/users/3875042/kurt-w"}, "edited": false, "score": 0, "creation_date": 1501645935, "post_id": 45337128, "comment_id": 77863275, "body": "@KurtW Taking a quick look at Cary&#39;s other post, I had definitely forgotten about <code>values_at</code> which can be used instead of all the <code>{ &#39;id&#39; =&gt; item[&#39;id&#39;], &#39;ref&#39; =&gt; item[&#39;ref&#39;], &#39;name&#39; =&gt; item[&#39;name&#39;] }</code> hashes to check for uniqueness as a quick condensing move. I&#39;ll take a closer look at the rest of his post and see if there&#39;s anything else that might be used here easily to condense some of this"}], "tags": [], "owner": {"reputation": 9971, "user_id": 8255744, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de22299534b5a8ed244ee8ff4aa6c481?s=128&d=identicon&r=PG&f=1", "display_name": "Simple Lime", "link": "https://stackoverflow.com/users/8255744/simple-lime"}, "is_accepted": true, "score": 0, "last_activity_date": 1501102055, "creation_date": 1501102055, "answer_id": 45337128, "question_id": 45336535, "link": "https://stackoverflow.com/questions/45336535/ruby-show-deltas-between-2-array-of-hashes-based-on-subset-of-hash-keys/45337128#45337128", "title": "Ruby - Show Deltas Between 2 array of hashes based on subset of hash keys", "body": "<p>This isn't very pretty, but it works. It creates a third array containing all unique values in both <code>array1</code> and <code>array2</code> and iterates through that.</p>\n\n<p>Then, since <code>include?</code> doesn't allow a custom matcher, we can fake it by using <a href=\"https://ruby-doc.org/core-2.4.0/Enumerable.html#method-i-detect\" rel=\"nofollow noreferrer\"><code>detect</code></a> and looking for an item in the array which has the custom sub-hash matching. We'll wrap that in a custom method so we can just call it passing in <code>array1</code> or <code>array2</code> instead of writing it twice.</p>\n\n<p>Finally, we loop through our <code>array3</code> and determine whether the <code>item</code> came from <code>array1</code>, <code>array2</code>, or both of them and add to the corresponding output array.</p>\n\n<pre><code>array1 = [{'id' =&gt; '1', 'ref' =&gt; '1001', 'name' =&gt; 'CA', 'extra' =&gt; 'Not Sorted On 5'},\n          {'id' =&gt; '2', 'ref' =&gt; '1002', 'name' =&gt; 'NY', 'extra' =&gt; 'Not Sorted On 7'},\n          {'id' =&gt; '3', 'ref' =&gt; '1003', 'name' =&gt; 'WA', 'extra' =&gt; 'Not Sorted On 9'},\n          {'id' =&gt; '7', 'ref' =&gt; '1007', 'name' =&gt; 'OR', 'extra' =&gt; 'Not Sorted On 11'}]\n\narray2 = [{'id' =&gt; '1', 'ref' =&gt; '1001', 'name' =&gt; 'CA', 'extra' =&gt; 'Not Sorted On 5'},\n          {'id' =&gt; '3', 'ref' =&gt; '1003', 'name' =&gt; 'WA', 'extra' =&gt; 'Not Sorted On 9'},\n          {'id' =&gt; '8', 'ref' =&gt; '1002', 'name' =&gt; 'NY', 'extra' =&gt; 'Not Sorted On 7'},\n          {'id' =&gt; '5', 'ref' =&gt; '1005', 'name' =&gt; 'MT', 'extra' =&gt; 'Not Sorted On 10'},\n          {'id' =&gt; '12', 'ref' =&gt; '1012', 'name' =&gt; 'TX', 'extra' =&gt; 'Not Sorted On 85'}]\n\n# combine the arrays into 1 array that contains items in both array1 and array2 to loop through\narray3 = (array1 + array2).uniq { |item| { 'id' =&gt; item['id'], 'ref' =&gt; item['ref'], 'name' =&gt; item['name'] } }\n\n# Array#include? doesn't allow a custom matcher, so we can fake it by using Array#detect\ndef is_included_in(array, object)\n  object_identifier = { 'id' =&gt; object['id'], 'ref' =&gt; object['ref'], 'name' =&gt; object['name'] }\n\n  array.detect do |item|\n    { 'id' =&gt; item['id'], 'ref' =&gt; item['ref'], 'name' =&gt; item['name'] } == object_identifier\n  end\nend\n\n# output array initializing\narray1_only = []\narray2_only = []\narray1_and_array2 = []\n\n# loop through all items in both array1 and array2 and check if it was in array1 or array2\n# if it was in both, add to array1_and_array2, otherwise, add it to the output array that\n# corresponds to the input array\narray3.each do |item|\n  in_array1 = is_included_in(array1, item)\n  in_array2 = is_included_in(array2, item)\n\n  if in_array1 &amp;&amp; in_array2\n    array1_and_array2.push item\n  elsif in_array1\n    array1_only.push item\n  else\n    array2_only.push item\n  end\nend\n\n\nputs array1_only.inspect        # =&gt; [{\"id\"=&gt;\"2\", \"ref\"=&gt;\"1002\", \"name\"=&gt;\"NY\", \"extra\"=&gt;\"Not Sorted On 7\"}, {\"id\"=&gt;\"7\", \"ref\"=&gt;\"1007\", \"name\"=&gt;\"OR\", \"extra\"=&gt;\"Not Sorted On 11\"}]\nputs array2_only.inspect        # =&gt; [{\"id\"=&gt;\"8\", \"ref\"=&gt;\"1002\", \"name\"=&gt;\"NY\", \"extra\"=&gt;\"Not Sorted On 7\"}, {\"id\"=&gt;\"5\", \"ref\"=&gt;\"1005\", \"name\"=&gt;\"MT\", \"extra\"=&gt;\"Not Sorted On 10\"}, {\"id\"=&gt;\"12\", \"ref\"=&gt;\"1012\", \"name\"=&gt;\"TX\", \"extra\"=&gt;\"Not Sorted On 85\"}]\nputs array1_and_array2.inspect  # =&gt; [{\"id\"=&gt;\"1\", \"ref\"=&gt;\"1001\", \"name\"=&gt;\"CA\", \"extra\"=&gt;\"Not Sorted On 5\"}, {\"id\"=&gt;\"3\", \"ref\"=&gt;\"1003\", \"name\"=&gt;\"WA\", \"extra\"=&gt;\"Not Sorted On 9\"}]\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1504048013, "post_id": 45949495, "comment_id": 78857736, "body": "Kurt, I concluded my answer to the <a href=\"https://stackoverflow.com/questions/30494890/ruby-compare-two-arrays-of-hash-with-certain-keys/30495256?noredirect=1#comment78845124_30495256\">question where you left your request</a> is not the best for this problem, so I offered a different solution."}, {"owner": {"reputation": 301, "user_id": 3875042, "user_type": "registered", "accept_rate": 89, "profile_image": "https://graph.facebook.com/1557167620/picture?type=large", "display_name": "Kurt W", "link": "https://stackoverflow.com/users/3875042/kurt-w"}, "edited": false, "score": 0, "creation_date": 1504112560, "post_id": 45949495, "comment_id": 78890965, "body": "Cary, you&#39;ve once again outdone yourself!  Thank you so very much for the detailed and explicit answer!!  I so appreciate you taking the time and thought to help make it clear the flow of what is happening.  Just a note that it might be better to move <code>a1</code>, <code>a2</code>, and <code>common_keys</code> into your main code answer; since it was in the explanation block it initially threw me for a loop as they were undefined.  Thank you so very much once again! A million thanks! I&#39;m not sure what the S.O. etiquette is for this--this answer more directly explains prob/solution; should I accept it this late in the game?"}, {"owner": {"reputation": 301, "user_id": 3875042, "user_type": "registered", "accept_rate": 89, "profile_image": "https://graph.facebook.com/1557167620/picture?type=large", "display_name": "Kurt W", "link": "https://stackoverflow.com/users/3875042/kurt-w"}, "edited": false, "score": 0, "creation_date": 1504134564, "post_id": 45949495, "comment_id": 78901111, "body": "Also Cary, it seems that <code>array1.values_at(*array1.size.times.to_a - idx1).map { |h| h.select { |k,_| keys.include?(k) } }.uniq</code> produces the common values (seen in both <code>array1</code> and <code>array2</code>) but it only produces hashes for the named keys (<code>[&#39;id&#39;, &#39;ref&#39;, &#39;name&#39;]</code>).  Shouldn&#39;t this show the entire hash with all of the key/value pairs--despite only calculating on those 3?  Thanks again!"}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "reply_to_user": {"reputation": 301, "user_id": 3875042, "user_type": "registered", "accept_rate": 89, "profile_image": "https://graph.facebook.com/1557167620/picture?type=large", "display_name": "Kurt W", "link": "https://stackoverflow.com/users/3875042/kurt-w"}, "edited": false, "score": 0, "creation_date": 1504150214, "post_id": 45949495, "comment_id": 78904355, "body": "Thank you for both comments. Regarding #2, I removed that code, which was confusing and probably not of interest. I also change the name of <code>common_keys</code>, which does not refer to the keys of the individual elements of <code>array1</code> and <code>array2</code>, but of <code>a1</code> and <code>a2</code>. In comment #1, please clarify what you mean by &quot;move <code>a1</code>, <code>a2</code> and <code>common_keys</code> into your main code answer.&quot; They are in <code>keepers</code>, which is the main method."}], "tags": [], "owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "is_accepted": false, "score": 1, "last_activity_date": 1504149492, "last_edit_date": 1504149492, "creation_date": 1504047684, "answer_id": 45949495, "question_id": 45336535, "link": "https://stackoverflow.com/questions/45336535/ruby-show-deltas-between-2-array-of-hashes-based-on-subset-of-hash-keys/45949495#45949495", "title": "Ruby - Show Deltas Between 2 array of hashes based on subset of hash keys", "body": "<p>For this type of problem it's generally easiest to work with indices.</p>\n\n<p><strong>Code</strong></p>\n\n<pre><code>def keepers(array1, array2, keys)\n  a1 = make_hash(array1, keys)\n  a2 = make_hash(array2, keys)\n  common_keys_of_a1_and_a2 = a1.keys &amp; a2.keys\n  [keeper_idx(array1, a1, common_keys_of_a1_and_a2),\n   keeper_idx(array2, a2, common_keys_of_a1_and_a2)]\nend\n\ndef make_hash(arr, keys)\n  arr.each_with_index.with_object({}) do |(g,i),h|\n    (h[g.values_at(*keys)] ||= []) &lt;&lt; i\n  end\nend\n\ndef keeper_idx(arr, a, common_keys_of_a1_and_a2)\n  arr.size.times.to_a - a.values_at(*common_keys_of_a1_and_a2).flatten\nend\n</code></pre>\n\n<p><strong>Example</strong></p>\n\n<pre><code>array1 =\n  [{'id' =&gt;  '1', 'ref' =&gt; '1001', 'name' =&gt; 'CA', 'extra' =&gt; 'Not Sorted On 5'},\n   {'id' =&gt;  '2', 'ref' =&gt; '1002', 'name' =&gt; 'NY', 'extra' =&gt; 'Not Sorted On 7'},\n   {'id' =&gt;  '3', 'ref' =&gt; '1003', 'name' =&gt; 'WA', 'extra' =&gt; 'Not Sorted On 9'},\n   {'id' =&gt;  '3', 'ref' =&gt; '1003', 'name' =&gt; 'WA', 'extra' =&gt; 'Not Sorted On 8'},\n   {'id' =&gt;  '7', 'ref' =&gt; '1007', 'name' =&gt; 'OR', 'extra' =&gt; 'Not Sorted On 11'}]\n\narray2 =\n  [{'id' =&gt;  '1', 'ref' =&gt; '1001', 'name' =&gt; 'CA', 'extra' =&gt; 'Not Sorted On 5'},\n   {'id' =&gt;  '3', 'ref' =&gt; '1003', 'name' =&gt; 'WA', 'extra' =&gt; 'Not Sorted On 9'},\n   {'id' =&gt;  '8', 'ref' =&gt; '1002', 'name' =&gt; 'NY', 'extra' =&gt; 'Not Sorted On 7'},\n   {'id' =&gt;  '5', 'ref' =&gt; '1005', 'name' =&gt; 'MT', 'extra' =&gt; 'Not Sorted On 10'},\n   {'id' =&gt;  '5', 'ref' =&gt; '1005', 'name' =&gt; 'MT', 'extra' =&gt; 'Not Sorted On 12'},\n   {'id' =&gt; '12', 'ref' =&gt; '1012', 'name' =&gt; 'TX', 'extra' =&gt; 'Not Sorted On 85'}]\n</code></pre>\n\n<p>Notice that the two arrays are slightly different than those given in the question. The question did not specify whether each array could contain two hashes the have the same values for the specified keys. I therefore added a hash to each array to show has that case is dealt with. </p>\n\n<pre><code>keys = ['id', 'ref', 'name']\n\nidx1, idx2 = keepers(array1, array2, keys)\n  #=&gt; [[1, 4], [2, 3, 4, 5]]\n</code></pre>\n\n<p><code>idx1</code> (<code>idx2</code>) are the indices of the elements of <code>array1</code> (<code>array2</code>) that remain after matches are removed. (<code>array1</code> and <code>array2</code> are not modified, however.)</p>\n\n<p>It follows that the two arrays map to</p>\n\n<pre><code>array1.values_at(*idx1)\n  #=&gt; [{\"id\"=&gt; \"2\", \"ref\"=&gt;\"1002\", \"name\"=&gt;\"NY\", \"extra\"=&gt;\"Not Sorted On 7\"},\n  #    {\"id\"=&gt; \"7\", \"ref\"=&gt;\"1007\", \"name\"=&gt;\"OR\", \"extra\"=&gt;\"Not Sorted On 11\"}]\n</code></pre>\n\n<p>and</p>\n\n<pre><code>array2.values_at(*idx2)\n  #=&gt; [{\"id\"=&gt; \"8\", \"ref\"=&gt;\"1002\", \"name\"=&gt;\"NY\", \"extra\"=&gt;\"Not Sorted On 7\"},\n  #    {\"id\"=&gt; \"5\", \"ref\"=&gt;\"1005\", \"name\"=&gt;\"MT\", \"extra\"=&gt;\"Not Sorted On 10\"},\n  #    {\"id\"=&gt; \"5\", \"ref\"=&gt;\"1005\", \"name\"=&gt;\"MT\", \"extra\"=&gt;\"Not Sorted On 12\"},\n  #    {\"id\"=&gt;\"12\", \"ref\"=&gt;\"1012\", \"name\"=&gt;\"TX\", \"extra\"=&gt;\"Not Sorted On 85\"}]\n</code></pre>\n\n<p>The indices of the hashes that are removed are given as follows.</p>\n\n<pre><code>array1.size.times.to_a - idx1\n  #=&gt; [0, 2, 3]\narray2.size.times.to_a - idx2\n  #[0, 1]\n</code></pre>\n\n<p><strong>Explanation</strong></p>\n\n<p>The steps are as follows.</p>\n\n<pre><code>a1 = make_hash(array1, keys)\n  #=&gt; {[\"1\", \"1001\", \"CA\"]=&gt;[0], [\"2\", \"1002\", \"NY\"]=&gt;[1],\n  #    [\"3\", \"1003\", \"WA\"]=&gt;[2, 3], [\"7\", \"1007\", \"OR\"]=&gt;[4]}    \na2 = make_hash(array2, keys)\n  #=&gt; {[\"1\", \"1001\", \"CA\"]=&gt;[0], [\"3\", \"1003\", \"WA\"]=&gt;[1],\n  #    [\"8\", \"1002\", \"NY\"]=&gt;[2], [\"5\", \"1005\", \"MT\"]=&gt;[3, 4],\n  #    [\"12\", \"1012\", \"TX\"]=&gt;[5]}\ncommon_keys_of_a1_and_a2 = a1.keys &amp; a2.keys\n  #=&gt; [[\"1\", \"1001\", \"CA\"], [\"3\", \"1003\", \"WA\"]]\nkeeper_idx(array1, a1, common_keys_of_a1_and_a2)\n  #=&gt; [1, 4] (for array1)\nkeeper_idx(array2, a2, common_keys_of_a1_and_a2)\n  #=&gt; [2, 3, 4, 5]\u00b7 (for array2)\n</code></pre>\n"}], "owner": {"reputation": 301, "user_id": 3875042, "user_type": "registered", "accept_rate": 89, "profile_image": "https://graph.facebook.com/1557167620/picture?type=large", "display_name": "Kurt W", "link": "https://stackoverflow.com/users/3875042/kurt-w"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 336, "favorite_count": 1, "accepted_answer_id": 45337128, "answer_count": 3, "score": 3, "last_activity_date": 1504149492, "creation_date": 1501099959, "question_id": 45336535, "link": "https://stackoverflow.com/questions/45336535/ruby-show-deltas-between-2-array-of-hashes-based-on-subset-of-hash-keys", "title": "Ruby - Show Deltas Between 2 array of hashes based on subset of hash keys", "body": "<p>I'm attempting to compare two arrays of hashes with very similar hash structure <strong>(identical and always-present keys)</strong> and return the deltas between the two--specifically, I'd like to capture the folllowing:</p>\n\n<ul>\n<li>Hashes part of <code>array1</code> that do not exist in <code>array2</code></li>\n<li>Hashes part of <code>array2</code> that do not exist in <code>array1</code></li>\n<li>Hashes which appear in both data sets</li>\n</ul>\n\n<p>This typically can be achieved by simply doing the following:  </p>\n\n<pre><code>deltas_old_new = (array1-array2)\ndeltas_new_old = (array2-array1)\n</code></pre>\n\n<p>The problem for me (which has turned into a 2-3 hour struggle!) is that I need to identify the deltas <strong>based on the values of 3 keys within the hash ('id', 'ref', 'name')</strong>--the values of these 3 keys are effectively what makes up a unique entry in my data -- <strong>but I must retain the other key/value pairs of the hash</strong> (e.g. <code>'extra'</code> and numerous other key/value pairs not shown for brevity.</p>\n\n<p><strong>Example Data:</strong></p>\n\n<pre><code>array1 = [{'id' =&gt; '1', 'ref' =&gt; '1001', 'name' =&gt; 'CA', 'extra' =&gt; 'Not Sorted On 5'},\n          {'id' =&gt; '2', 'ref' =&gt; '1002', 'name' =&gt; 'NY', 'extra' =&gt; 'Not Sorted On 7'},\n          {'id' =&gt; '3', 'ref' =&gt; '1003', 'name' =&gt; 'WA', 'extra' =&gt; 'Not Sorted On 9'},\n          {'id' =&gt; '7', 'ref' =&gt; '1007', 'name' =&gt; 'OR', 'extra' =&gt; 'Not Sorted On 11'}]\n\narray2 = [{'id' =&gt; '1', 'ref' =&gt; '1001', 'name' =&gt; 'CA', 'extra' =&gt; 'Not Sorted On 5'},\n          {'id' =&gt; '3', 'ref' =&gt; '1003', 'name' =&gt; 'WA', 'extra' =&gt; 'Not Sorted On 9'},\n          {'id' =&gt; '8', 'ref' =&gt; '1002', 'name' =&gt; 'NY', 'extra' =&gt; 'Not Sorted On 7'},\n          {'id' =&gt; '5', 'ref' =&gt; '1005', 'name' =&gt; 'MT', 'extra' =&gt; 'Not Sorted On 10'},\n          {'id' =&gt; '12', 'ref' =&gt; '1012', 'name' =&gt; 'TX', 'extra' =&gt; 'Not Sorted On 85'}]\n</code></pre>\n\n<p><strong>Expected Outcome (3 separate array of hashes):</strong></p>\n\n<p>Object containing data in <code>array1</code> but not in <code>array2</code> --</p>\n\n<pre><code>[{'id' =&gt; '2', 'ref' =&gt; '1002', 'name' =&gt; 'NY', 'extra' =&gt; 'Not Sorted On 7'},\n {'id' =&gt; '7', 'ref' =&gt; '1007', 'name' =&gt; 'OR', 'extra' =&gt; 'Not Sorted On 11'}]\n</code></pre>\n\n<p>Object containing data in <code>array2</code> but not in <code>array1</code> --</p>\n\n<pre><code>[{'id' =&gt; '8', 'ref' =&gt; '1002', 'name' =&gt; 'NY', 'extra' =&gt; 'Not Sorted On 7'},\n {'id' =&gt; '5', 'ref' =&gt; '1005', 'name' =&gt; 'MT', 'extra' =&gt; 'Not Sorted On 10'},\n {'id' =&gt; '12', 'ref' =&gt; '1012', 'name' =&gt; 'TX', 'extra' =&gt; 'Not Sorted On 85'}]\n</code></pre>\n\n<p>Object containing data in BOTH <code>array1</code> and <code>array2</code> --</p>\n\n<pre><code>[{'id' =&gt; '1', 'ref' =&gt; '1001', 'name' =&gt; 'CA', 'extra' =&gt; 'Not Sorted On 5'},\n {'id' =&gt; '3', 'ref' =&gt; '1003', 'name' =&gt; 'WA', 'extra' =&gt; 'Not Sorted On 9'}]\n</code></pre>\n\n<p>I've tried numerous attempts at comparing iterating over the arrays and using <code>Hash#keep_if</code> based on the 3 keys as well as merging both data sets into a single array and then attempting to de-dup based on <code>array1</code> but I keep coming up empty handed.  Thank you in advance for your time and assistance!</p>\n"}, {"tags": ["html", "ruby-on-rails", "ruby", "ruby-on-rails-4"], "answers": [{"comments": [{"owner": {"reputation": 350, "user_id": 8368360, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7029223df2fd3294837967a9a6416764?s=128&d=identicon&r=PG", "display_name": "djmayank", "link": "https://stackoverflow.com/users/8368360/djmayank"}, "edited": false, "score": 0, "creation_date": 1501101077, "post_id": 45336749, "comment_id": 77635705, "body": "can you tell me how you edited that question like that preformatted one???"}, {"owner": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "reply_to_user": {"reputation": 350, "user_id": 8368360, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7029223df2fd3294837967a9a6416764?s=128&d=identicon&r=PG", "display_name": "djmayank", "link": "https://stackoverflow.com/users/8368360/djmayank"}, "edited": false, "score": 0, "creation_date": 1501101175, "post_id": 45336749, "comment_id": 77635757, "body": "Using some markdown @Mayank, hit <code>ctrl-k</code> to make code blocks, there&#39;s also some hints how to use it."}, {"owner": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "reply_to_user": {"reputation": 350, "user_id": 8368360, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7029223df2fd3294837967a9a6416764?s=128&d=identicon&r=PG", "display_name": "djmayank", "link": "https://stackoverflow.com/users/8368360/djmayank"}, "edited": false, "score": 0, "creation_date": 1501101178, "post_id": 45336749, "comment_id": 77635760, "body": "Using some markdown @Mayank, hit <code>ctrl-k</code> to make code blocks, there&#39;s also some hints how to use it."}], "tags": [], "owner": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "is_accepted": true, "score": 0, "last_activity_date": 1501100750, "creation_date": 1501100750, "answer_id": 45336749, "question_id": 45336517, "link": "https://stackoverflow.com/questions/45336517/how-to-set-an-unique-id-for-link-to-tag-in-rails/45336749#45336749", "title": "how to set an unique id for link_to tag in rails?", "body": "<p>Try with:</p>\n\n<pre><code>&lt;%= link_to 'Edit', \n  edit_question_path(question.id),\n  method: :get, \n  remote: true, \n  id: \"myBtn_#{question.id}\" %&gt;\n</code></pre>\n\n<p>You need to see what's the way to access a question variable, as instance or local one (I used a <code>question</code>, as you're doing with the path), and <code>myBtn_&lt;%=question.id%&gt;</code> won't work if you don't have defined a <code>myBtn</code> variable, even less if you try to include erb tags to print inside the erb open-close for the <code>link_to</code>.</p>\n"}], "owner": {"reputation": 350, "user_id": 8368360, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7029223df2fd3294837967a9a6416764?s=128&d=identicon&r=PG", "display_name": "djmayank", "link": "https://stackoverflow.com/users/8368360/djmayank"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 526, "favorite_count": 0, "accepted_answer_id": 45336749, "answer_count": 1, "score": 1, "last_activity_date": 1501100750, "creation_date": 1501099911, "last_edit_date": 1501100352, "question_id": 45336517, "link": "https://stackoverflow.com/questions/45336517/how-to-set-an-unique-id-for-link-to-tag-in-rails", "title": "how to set an unique id for link_to tag in rails?", "body": "<p>I need to separate unique ids for some linking purpose, I just want to know how to make an unique id for <code>link_to</code>?</p>\n\n<p>Like I am using:</p>\n\n<pre><code>&lt;%= link_to \"Edit\", edit_question_path(question.id),method: :get, :remote =&gt; true, :id =&gt; @question.id%&gt;\n</code></pre>\n\n<p>This didn't work then I tried:</p>\n\n<pre><code>&lt;%= link_to \"Edit\", edit_question_path(question.id),method: :get, :remote =&gt; true, id: myBtn_&lt;%=question.id%&gt; %&gt;\n</code></pre>\n\n<p>Nothing worked. Is there any solution?</p>\n"}, {"tags": ["ruby", "chef-infra", "test-kitchen"], "answers": [{"tags": [], "owner": {"reputation": 887, "user_id": 8014301, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/8399d118068d5ccd7d47cbd574095b42?s=128&d=identicon&r=PG&f=1", "display_name": "J0991", "link": "https://stackoverflow.com/users/8014301/j0991"}, "is_accepted": false, "score": 0, "last_activity_date": 1501102211, "creation_date": 1501102211, "answer_id": 45337164, "question_id": 45336274, "link": "https://stackoverflow.com/questions/45336274/chef-test-kitchen-fails-to-converge-on-debian-7-11-instance/45337164#45337164", "title": "Chef test-kitchen fails to converge on Debian 7.11 instance", "body": "<p>Just as a followup for anybody who may also run across this issue, I've found the answer. Per <a href=\"https://github.com/chef/chef/issues/5774\" rel=\"nofollow noreferrer\">Chef's Github repo</a>, it looks like the fix for this issue is clearing out the <code>~/.kitchen/cache</code> directory.</p>\n\n<p>Once I cleared this directory of all files i was able to converge my run list on Debian 7.11 as well as Debian 8.8.</p>\n"}], "owner": {"reputation": 887, "user_id": 8014301, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/8399d118068d5ccd7d47cbd574095b42?s=128&d=identicon&r=PG&f=1", "display_name": "J0991", "link": "https://stackoverflow.com/users/8014301/j0991"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 96, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1501102211, "creation_date": 1501098909, "question_id": 45336274, "link": "https://stackoverflow.com/questions/45336274/chef-test-kitchen-fails-to-converge-on-debian-7-11-instance", "title": "Chef test-kitchen fails to converge on Debian 7.11 instance", "body": "<p>I'm currently using Chef's test-kitchen to test my configurations before applying them to my managed nodes.</p>\n\n<p>I've specified Ubuntu 14.04 + 16.04, as well as Debian 7.11 + 8.8 as the platforms to be tested on. I am able to converge my configuration on the Ubuntu 14.04 + 16.04 instances, as well as the Debian 8.8 instance. When attempting to converge on the Debian 7.11 instance, I receive the following error message:</p>\n\n<pre><code>kitchen converge jenkins-complete-install-debian-711\n-----&gt; Starting Kitchen (v1.16.0)\n-----&gt; Converging &lt;jenkins-complete-install-debian-711&gt;...\n       Preparing files for transfer\n       Preparing dna.json\n       Resolving cookbook dependencies with Berkshelf 5.6.4...\n       Removing non-cookbook files before transfer\n       Preparing validation.pem\n       Preparing client.rb\n-----&gt; Chef Omnibus installation detected (install only if missing)\n       Transferring files to &lt;jenkins-complete-install-debian-711&gt;\n       /opt/chef/embedded/bin/ruby: /lib/x86_64-linux-gnu/libc.so.6: version `GLIBC_2.14' not found (required by /opt/chef/embedded/lib/libruby.so.2.4)\n&gt;&gt;&gt;&gt;&gt;&gt; ------Exception-------\n&gt;&gt;&gt;&gt;&gt;&gt; Class: Kitchen::ActionFailed\n&gt;&gt;&gt;&gt;&gt;&gt; Message: 1 actions failed.\n&gt;&gt;&gt;&gt;&gt;&gt;     Converge failed on instance &lt;jenkins-complete-install-debian-711&gt;.  Please see .kitchen/logs/jenkins-complete-install-debian-711.log for more details\n&gt;&gt;&gt;&gt;&gt;&gt; ----------------------\n&gt;&gt;&gt;&gt;&gt;&gt; Please see .kitchen/logs/kitchen.log for more details\n&gt;&gt;&gt;&gt;&gt;&gt; Also try running `kitchen diagnose --all` for configuration\n</code></pre>\n\n<p>It seems that:</p>\n\n<pre><code>/opt/chef/embedded/bin/ruby: /lib/x86_64-linux-gnu/libc.so.6: version `GLIBC_2.14' not found (required by /opt/chef/embedded/lib/libruby.so.2.4)\n</code></pre>\n\n<p>is the culprit, however I'm not sure what may be causing this error. It looks like Debian 7.11 is supported according to the <a href=\"https://github.com/chef/bento\" rel=\"nofollow noreferrer\">bento project on github</a>, so I'd imagine there's something I need to modify on my side to get this to work. Does anybody have any experience using test-kitchen with Debian 7.11?</p>\n"}, {"tags": ["ruby-on-rails", "json", "ruby", "api", "rspec"], "comments": [{"owner": {"reputation": 3868, "user_id": 2482094, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/81a0ecf0c7d4d429fafbdbbba490f38c?s=128&d=identicon&r=PG", "display_name": "Piotr Galas", "link": "https://stackoverflow.com/users/2482094/piotr-galas"}, "edited": false, "score": 0, "creation_date": 1501099320, "post_id": 45335412, "comment_id": 77634718, "body": "I recommend you to use <a href=\"https://github.com/zipmark/rspec_api_documentation\" rel=\"nofollow noreferrer\">github.com/zipmark/rspec_api_documentation</a> to test your controllers. It has simple syntax and at a bonus you get documentation for free."}], "answers": [{"comments": [{"owner": {"reputation": 15, "user_id": 8064699, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d1889f90dff67ae1f538e4909bd66ea1?s=128&d=identicon&r=PG", "display_name": "fernal9301", "link": "https://stackoverflow.com/users/8064699/fernal9301"}, "edited": false, "score": 0, "creation_date": 1501097526, "post_id": 45335654, "comment_id": 77633726, "body": "Thanks a lot! You&#39;re so fast. It works. As I understand line ``` let(:user) { User.last } ``` is optional, everything works just fine without it."}, {"owner": {"reputation": 13441, "user_id": 2199600, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8sl6u.jpg?s=128&g=1", "display_name": "Igor Drozdov", "link": "https://stackoverflow.com/users/2199600/igor-drozdov"}, "reply_to_user": {"reputation": 15, "user_id": 8064699, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d1889f90dff67ae1f538e4909bd66ea1?s=128&d=identicon&r=PG", "display_name": "fernal9301", "link": "https://stackoverflow.com/users/8064699/fernal9301"}, "edited": false, "score": 0, "creation_date": 1501097754, "post_id": 45335654, "comment_id": 77633858, "body": "<code>let(:user) { User.last }</code> is to get the last user (just created) and verify its email. But, certainly it&#39;s up to you how to design your code :)"}], "tags": [], "owner": {"reputation": 13441, "user_id": 2199600, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8sl6u.jpg?s=128&g=1", "display_name": "Igor Drozdov", "link": "https://stackoverflow.com/users/2199600/igor-drozdov"}, "is_accepted": true, "score": 1, "last_activity_date": 1501096628, "creation_date": 1501096628, "answer_id": 45335654, "question_id": 45335412, "link": "https://stackoverflow.com/questions/45335412/howto-properly-rails-api-rspec-json-test/45335654#45335654", "title": "howto properly rails api rspec json test", "body": "<p>The problem is that you provide <code>User</code> model as a params when <code>Hash</code> is expected.</p>\n\n<p>This is an example of a post request to <code>/users</code> that works:</p>\n\n<pre><code>RSpec.describe UsersController, type: :controller do\n  # Test for POST /users\n  describe 'POST /users' do\n    let(:user) { User.last }\n\n    context '#check valid request' do\n      before { post 'create', params: { user: { email: 'test@mail.ru', password: 'abc123', token: 'anytokenhere' } } }\n\n      it 'creates a user' do\n        json = JSON.parse(response.body)\n        expect(user.email).to eq('test@mail.ru')\n      end\n\n      it 'returns status code 201' do\n        expect(response).to have_http_status(201)\n      end\n    end\n\n  end\nend\n</code></pre>\n"}], "owner": {"reputation": 15, "user_id": 8064699, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d1889f90dff67ae1f538e4909bd66ea1?s=128&d=identicon&r=PG", "display_name": "fernal9301", "link": "https://stackoverflow.com/users/8064699/fernal9301"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 85, "favorite_count": 0, "accepted_answer_id": 45335654, "answer_count": 1, "score": 1, "last_activity_date": 1501133972, "creation_date": 1501095804, "last_edit_date": 1501133972, "question_id": 45335412, "link": "https://stackoverflow.com/questions/45335412/howto-properly-rails-api-rspec-json-test", "title": "howto properly rails api rspec json test", "body": "<p>I've got <code>UsersController</code></p>\n\n<pre><code>def create\n  @user = User.create(user_params)\n  if @user.save\n    render json: @user, status: :created\n  else\n    render json: @user, status: :unprocessable_entity\n  end\nend\n</code></pre>\n\n<p>I need to test this create action with RSPec. Can you please help, how to do it properly </p>\n\n<p>I'm stuck with this code</p>\n\n<pre><code>RSpec.describe UsersController, type: :controller do\n  # Test for POST /users\n  describe 'POST /users' do\n    let(:user) { User.create(email: 'test@mail.ru', password: 'abc123', token: 'anytokenhere') }\n    context '#check valid request' do\n\n      before { post 'create', params: user }\n\n      it 'creates a user' do\n        json = JSON.parse(response.body)\n        expect(json['email']).to eq('test@mail.ru')\n        expect(json['password']).to eq('abc123')\n      end\n\n      it 'returns status code 201' do\n        expect(response).to have_http_status(201)\n      end\n    end\n\n  end\nend\n</code></pre>\n\n<p>got the following error: </p>\n\n<pre><code>Failures:\n\n  1) UsersController POST /users #check valid request creates a user\n     Failure/Error: before { post 'create', params: user }\n\n     NoMethodError:\n       undefined method `symbolize_keys' for #&lt;User:0x0055f95cee9a48&gt;\n     # ./spec/controllers/users_controller_spec.rb:9:in `block (4 levels) in &lt;top (required)&gt;'\n\n  2) UsersController POST /users #check valid request returns status code 201\n     Failure/Error: before { post 'create', params: user }\n\n     NoMethodError:\n       undefined method `symbolize_keys' for #&lt;User:0x0055f95cbebbc0&gt;\n     # ./spec/controllers/users_controller_spec.rb:9:in `block (4 levels) in &lt;top (required)&gt;'\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "coffeescript", "fullcalendar"], "comments": [{"owner": {"reputation": 43836, "user_id": 5947043, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jUK37.png?s=128&g=1", "display_name": "ADyson", "link": "https://stackoverflow.com/users/5947043/adyson"}, "edited": false, "score": 0, "creation_date": 1501158374, "post_id": 45334955, "comment_id": 77662422, "body": "Your call to renderEvent makes no sense. You&#39;ve misunderstood how fullCalendar gets events fed to it. You may be wanting this, I think: <a href=\"https://fullcalendar.io/docs/event_data/events_function/\" rel=\"nofollow noreferrer\">fullcalendar.io/docs/event_data/events_function</a>. Or possibly you can get away with this: <a href=\"https://fullcalendar.io/docs/event_data/events_json_feed/\" rel=\"nofollow noreferrer\">fullcalendar.io/docs/event_data/events_json_feed</a> but defining the &quot;data&quot; option (as shown in the section titled &quot;jQuery $.ajax options&quot;) to get the value of your ID from your dropdown. Then all you have to do when the dropdown &quot;change&quot; event happens is to call the &quot;refetchEvents&quot; method (<a href=\"https://fullcalendar.io/docs/event_data/refetchEvents/\" rel=\"nofollow noreferrer\">fullcalendar.io/docs/event_data/refetchEvents</a>)"}, {"owner": {"reputation": 29, "user_id": 8260117, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2da26b6cba7ea690b54c03ccefc73128?s=128&d=identicon&r=PG&f=1", "display_name": "Andres Fernandes", "link": "https://stackoverflow.com/users/8260117/andres-fernandes"}, "reply_to_user": {"reputation": 43836, "user_id": 5947043, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jUK37.png?s=128&g=1", "display_name": "ADyson", "link": "https://stackoverflow.com/users/5947043/adyson"}, "edited": false, "score": 0, "creation_date": 1501199320, "post_id": 45334955, "comment_id": 77686564, "body": "Ok it worked, but now is creating a new calendar instead of rendering the events on the old one, looks like using the &quot;.fullCalendar()&quot; creates a new one... what can i do? @ADyson"}, {"owner": {"reputation": 43836, "user_id": 5947043, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jUK37.png?s=128&g=1", "display_name": "ADyson", "link": "https://stackoverflow.com/users/5947043/adyson"}, "edited": false, "score": 0, "creation_date": 1501225311, "post_id": 45334955, "comment_id": 77694387, "body": "yes it does. So put the eventsource info within your original calendar declaration, no need to create another one."}, {"owner": {"reputation": 29, "user_id": 8260117, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2da26b6cba7ea690b54c03ccefc73128?s=128&d=identicon&r=PG&f=1", "display_name": "Andres Fernandes", "link": "https://stackoverflow.com/users/8260117/andres-fernandes"}, "reply_to_user": {"reputation": 43836, "user_id": 5947043, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jUK37.png?s=128&g=1", "display_name": "ADyson", "link": "https://stackoverflow.com/users/5947043/adyson"}, "edited": false, "score": 0, "creation_date": 1501264355, "post_id": 45334955, "comment_id": 77720740, "body": "I didn&#39;t understand, can you make a pastie giving me an example? please, and sorry to bother you. @ADyson"}, {"owner": {"reputation": 43836, "user_id": 5947043, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jUK37.png?s=128&g=1", "display_name": "ADyson", "link": "https://stackoverflow.com/users/5947043/adyson"}, "edited": false, "score": 0, "creation_date": 1501668843, "post_id": 45334955, "comment_id": 77876021, "body": "above, you already did <code>calendarDiv.fullCalendar     dayNamesShort: [&quot;D&quot;, &quot;L&quot;, &quot;M&quot;, &quot;M&quot;, &quot;J&quot;, &quot;V&quot;, &quot;S&quot;]...etc</code>. This is where you first declare the calendar, from what I can see. So you just put the eventSources as another option in there, instead of running .fullCalendar again later."}], "owner": {"reputation": 29, "user_id": 8260117, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2da26b6cba7ea690b54c03ccefc73128?s=128&d=identicon&r=PG&f=1", "display_name": "Andres Fernandes", "link": "https://stackoverflow.com/users/8260117/andres-fernandes"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 152, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1501096831, "creation_date": 1501094130, "last_edit_date": 1501096831, "question_id": 45334955, "link": "https://stackoverflow.com/questions/45334955/add-events-to-existing-calendar-with-eventsources-array", "title": "Add events to existing calendar with eventSources array", "body": "<p>recently I was asked in my work to modify an existing module, the calendar, they want me to add filters to it, the events the calendar handles are evaluations, birthdays and announcements.</p>\n\n<p>I have a drop-down menu that has the certain id when a user selects an option the calendar evaluations will disappear and bring only the evaluations from that selected id. my problem is that I can't bring the selected id evaluations because I don't know exactly how. The person who did this is no longer in the company and I have no way of contacting it.</p>\n\n<p>This is how the calendar is created when the page loads: </p>\n\n<pre><code>      calendarDiv = $('#calendar')\n\n  $(document).on 'click', '#create-button', (e) -&gt;\n    $(this).hide()\n\n  $(document).on 'click', '#update-button', (e) -&gt;\n    $(this).hide()\n\n  remove_hidden_modals()\n  fetch_event()\n\n  # page is now ready, initialize the calendar...\n  date = new Date()\n  d = date.getDate()\n  m = date.getMonth()\n  y = date.getFullYear()\n  calendarDiv.fullCalendar\n    dayNamesShort: [\"D\", \"L\", \"M\", \"M\", \"J\", \"V\", \"S\"]\n    firstDay: 1\n    monthNames: [\"Enero\", \"Febrero\", \"Marzo\", \"Abril\", \"Mayo\", \"Junio\", \"Julio\", \"Agosto\", \"Septiembre\", \"Octubre\", \"Noviembre\", \"Diciembre\"]\n    buttonText:\n      today: \"Hoy\"\n    eventSources: [\n      url: \"/calendar/events/\"\n      className: \"school\"\n    ,\n      url: \"/calendar/evaluations/\"\n      className: \"evaluation\"\n    ,\n      url: \"/calendar/employees_birthdays/\"\n      className: \"staff-birthday\"\n    ,\n      url: \"/calendar/students_birthdays/\"\n      className: \"birthday\"\n    ]\n    loading: (isCalendarLoading) -&gt;\n      if (isCalendarLoading)\n        calendarDiv.find('.fc-header-center').append('#{loader_html}')\n      else\n        calendarDiv.find('.fc-header-center').find('.ajax-loader').remove()\n\n    # put your options and callbacks here\n    timeFormat: \"h:mm t{ - h:mm t} \"\n    dragOpacity: \"0.5\"\n\n    #http://arshaw.com/fullcalendar/docs/event_ui/eventDrop/\n    eventDrop: (event, dayDelta, minuteDelta, allDay, revertFunc) -&gt;\n      event.ignoreTimeZone = true\n      updateEvent event\n\n\n    # http://arshaw.com/fullcalendar/docs/event_ui/eventResize/\n    eventResize: (event, dayDelta, minuteDelta, revertFunc) -&gt;\n      updateEvent event\n</code></pre>\n\n<p>Now, when someone selects an option on the drop-down menu triggers this:</p>\n\n<pre><code>    $(document).ready -&gt;\n  selected_course = ''\n\n  $('#school_courses').on 'change', -&gt;\n    selected_course = document.getElementById(\"school_courses\")\n    selected_course = selected_course.options[selected_course.selectedIndex].value\n    allEvents = $('#calendar').fullCalendar('clientEvents');\n\n    userEventIds= [];\n    has_new_events = false\n    $.each allEvents, (index, value) -&gt;\n\n      if value.url  !=  undefined\n        if value.url.search( 'evaluation_info' ) &gt; 0\n          userEventIds.push value.id\n          has_new_events = true\n\n    $.each userEventIds, (index, value) -&gt;\n      $('#calendar').fullCalendar( 'removeEvents', value);\n</code></pre>\n\n<p>here I remove all the evaluations and I try to bring only the ones with the selected id. I was thinking if there's a way to do it with the event sources array, something like</p>\n\n<pre><code>$('#calendar').fullcalendar('renderEvent',         eventSources: [\n      url: \"/calendar/evaluations/\" + selected_course\n      className: \"evaluation\"\n    ])\n</code></pre>\n\n<p>but this doesn't work.</p>\n\n<p>What can I do?</p>\n\n<p>Thank you. </p>\n"}, {"tags": ["ruby-on-rails", "ruby", "rubygems"], "answers": [{"tags": [], "owner": {"reputation": 2343, "user_id": 1176706, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/vaCzZ.jpg?s=128&g=1", "display_name": "Asdrubal", "link": "https://stackoverflow.com/users/1176706/asdrubal"}, "is_accepted": true, "score": 1, "last_activity_date": 1501098321, "creation_date": 1501098321, "answer_id": 45336130, "question_id": 45334592, "link": "https://stackoverflow.com/questions/45334592/gems-configuration-not-being-set-in-rails-initializer/45336130#45336130", "title": "Gem&#39;s configuration not being set in Rails initializer", "body": "<p>In my executable file <code>radin</code> I added:</p>\n\n<pre><code>begin\n  load File.join(Dir.pwd, 'config', 'initializers', 'radin.rb')\nrescue LoadError\n  puts \"Please run `rails generate radin:install` before continuing \"\nend\n</code></pre>\n\n<p>and everything seems to work correctly now. </p>\n"}], "owner": {"reputation": 2343, "user_id": 1176706, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/vaCzZ.jpg?s=128&g=1", "display_name": "Asdrubal", "link": "https://stackoverflow.com/users/1176706/asdrubal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 408, "favorite_count": 1, "accepted_answer_id": 45336130, "answer_count": 1, "score": 1, "last_activity_date": 1501098321, "creation_date": 1501092907, "question_id": 45334592, "link": "https://stackoverflow.com/questions/45334592/gems-configuration-not-being-set-in-rails-initializer", "title": "Gem&#39;s configuration not being set in Rails initializer", "body": "<p>I am making a ruby gem let's call it <strong>Radin</strong>. It is used in Rails projects. There is an installation process that creates <code>config/initializers/radin.rb</code> by running <code>rails generate radin:install</code>.</p>\n\n<p><em>config/initializers/radin.rb</em> (Rails project)</p>\n\n<pre><code>Radin.configure do |config|\n  # Set this options to what makes sense for you\n  config.option = 'test'\nend\n</code></pre>\n\n<p>The generator works as intended (as seen above). In my gem I am following two links <a href=\"https://robots.thoughtbot.com/mygem-configure-block\" rel=\"nofollow noreferrer\">MyGem.configure Block</a> and <a href=\"https://rarlindseysmash.com/posts/config-and-generators-in-gems\" rel=\"nofollow noreferrer\">Config and Generators in Gems</a>.</p>\n\n<p>I have a executable to check if the configurations have been set. </p>\n\n<p><em>/exe/radin</em></p>\n\n<pre><code>#!/usr/bin/env ruby\n\nrequire 'radin'\noutput = {}\noutput[\"option\"] = Radin::Documentor.test_configuration\n\nputs \"Output: #{output}\"\n</code></pre>\n\n<p>My Documentor class only outputs my one configuration option</p>\n\n<p><em>/lib/radin/documentor.rb</em></p>\n\n<pre><code>module Radin\n  class Documentor\n    def self.test_configuration\n      Radin.configuration.option\n    end\n  end\nend\n</code></pre>\n\n<p>Finally I have my <code>Radin</code> module and <code>Configuration</code> class </p>\n\n<p><em>/lib/radin.rb</em></p>\n\n<pre><code>require \"radin/version\"\nrequire 'json'\n\nmodule Radin\n\n  autoload :Documentor, 'radin/documentor'\n\n  class &lt;&lt; self\n    attr_accessor :configuration\n  end\n\n  def self.configure\n    self.configuration ||= Configuration.new\n    yield(configuration)\n  end\n\n  class Configuration\n    attr_accessor :option\n\n    def initialize\n      @option = 'default_option'\n    end\n  end\nend\n</code></pre>\n\n<p>When I run <code>$ radin</code> in a test rails application directory I get an error, despite having the configuration option set in <code>config/initializers/radin.rb</code>. </p>\n\n<blockquote>\n  <p>.../radin/lib/radin/documentor.rb:8:in <code>test_configuration': undefined\n  method</code>option' for nil:NilClass (NoMethodError)</p>\n</blockquote>\n\n<p><strong>Tried &amp; Failed</strong>\nI've tried to set change the module to always have a default set, but despite changing the configuration in the initializer the option never changes from 'default_option'. </p>\n\n<pre><code>module Radin\n\n  class &lt;&lt; self\n    attr_accessor :configuration\n  end\n\n  def self.configuration\n    @configuration ||= Configuration.new\n  end\n\n  def self.configure\n    yield(configuration)\n  end\n\n  ...\n</code></pre>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1501089795, "post_id": 45333459, "comment_id": 77629305, "body": "Please provide a simple example, including the desired result. Where you say, &quot;remove the last integer&quot; do you mean &quot;remove the last diigt&quot;?"}, {"owner": {"reputation": 4150, "user_id": 7470620, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/49f3026fe13841e41d1805178eed9a3c?s=128&d=identicon&r=PG", "display_name": "eiko", "link": "https://stackoverflow.com/users/7470620/eiko"}, "edited": false, "score": 0, "creation_date": 1501089876, "post_id": 45333459, "comment_id": 77629366, "body": "Do you want to remove the last digit <i>and</i> increment it, or just remove the last digit? EG should [3, 2, 4, 10] become [4, 4, 7, 1] or [4, 4, 7, 2] ?"}, {"owner": {"reputation": 757, "user_id": 6939256, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/e25b477a55a8048071d22e032ecf22f0?s=128&d=identicon&r=PG&f=1", "display_name": "Benjamints", "link": "https://stackoverflow.com/users/6939256/benjamints"}, "edited": false, "score": 1, "creation_date": 1501090001, "post_id": 45333459, "comment_id": 77629439, "body": "Have updated for all."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1501092309, "post_id": 45333459, "comment_id": 77630868, "body": "Why the rush to select an answer?"}, {"owner": {"reputation": 9030, "user_id": 5101476, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JCQrl.jpg?s=128&g=1", "display_name": "ice\u30c4", "link": "https://stackoverflow.com/users/5101476/ice%e3%83%84"}, "edited": false, "score": 0, "creation_date": 1501095777, "post_id": 45333459, "comment_id": 77632755, "body": "Have updated my answer (as have others), so you may want to take a look:)"}], "answers": [{"comments": [{"owner": {"reputation": 757, "user_id": 6939256, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/e25b477a55a8048071d22e032ecf22f0?s=128&d=identicon&r=PG&f=1", "display_name": "Benjamints", "link": "https://stackoverflow.com/users/6939256/benjamints"}, "edited": false, "score": 0, "creation_date": 1501090841, "post_id": 45333603, "comment_id": 77629961, "body": "Thanks appreciate the answer"}, {"owner": {"reputation": 4600, "user_id": 5961578, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/df7cbfdd2a92a7926af3bbb8648318aa?s=128&d=identicon&r=PG", "display_name": "moveson", "link": "https://stackoverflow.com/users/5961578/moveson"}, "edited": false, "score": 0, "creation_date": 1501099556, "post_id": 45333603, "comment_id": 77634870, "body": "The conditional is unnecessary. <code>row.remainder 10</code> will return the expected value in all conditions. Lines 3 through 10 can be reduced to <code>(index + row).remainder 10</code>"}], "tags": [], "owner": {"reputation": 9030, "user_id": 5101476, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JCQrl.jpg?s=128&g=1", "display_name": "ice\u30c4", "link": "https://stackoverflow.com/users/5101476/ice%e3%83%84"}, "is_accepted": true, "score": 3, "last_activity_date": 1501099914, "last_edit_date": 1592644375, "creation_date": 1501089603, "answer_id": 45333603, "question_id": 45333459, "link": "https://stackoverflow.com/questions/45333459/adding-the-number-to-the-according-index-it-is-positioned-in/45333603#45333603", "title": "Adding the number to the according index it is positioned in", "body": "<h3>Fixing your code</h3>\n<p>Use <code>map</code> followed by <code>with_index(1)</code>, the argument offsetting the initial index by <code>+1</code>.</p>\n<pre><code>def incrementer(num)\n  num.map.with_index(1) do |row, index|\n    row = index + row\n    if row &gt; 9\n      row.digits.first\n    else \n      row\n    end\n  end\nend\n\nincrementer [3, 2, 4, 10]  #=&gt; [4, 4, 7, 4]\nincrementer [4, 6, 9, 1, 3] #=&gt; [5, 8, 2, 5, 8]\n</code></pre>\n<hr />\n<h3>Negative numbers</h3>\n<p>Numbers can be negative and for which we can use <code>abs.digits</code> but it may be better to use <code>Integer#remainder</code>.</p>\n<pre><code>def incrementer(num)\n  num.map.with_index(1) do |row, index|\n    row = index + row\n    case row\n    when -9..9\n      row\n    else \n      row.remainder 10\n    end\n  end\nend\n\nincrementer [3, 2, 4, 10]\n #=&gt; [4, 4, 7, 4]\nincrementer [4, 6, 9, 1, 3]\n #=&gt; [5, 8, 2, 5,8]\nincrementer [3, 2, 4,-17]\n #=&gt; [4, 4, 7, -3]\nincrementer [4, 6, -22, 1, 3]\n #=&gt; [5, 8, -9, 5, 8]\n</code></pre>\n<p><strong>Why not use <code>%</code> instead of <code>Integer#remainder</code>?</strong></p>\n<p><code>a % b</code> returns <code>a modulo b</code> which is not the same thing as the remainder. This has consequences for negative numbers:</p>\n<pre><code>-12 % 10 #=&gt; 8 not the last digit\n</code></pre>\n<p>So we need to use <code>Integer#remainder</code>, so:</p>\n<pre><code>-12.remainder 10 #=&gt; -2\n</code></pre>\n<p>Which is what we need, i.e. the last digit (parity included). It can be noted in other languages such as JavaScript, <code>a % b</code> returns the remainder.</p>\n<p>As noted by @moveson the above code can be refactored to:</p>\n<pre><code>num.map.with_index(1) { |row, index| (index + row).remainder 10 }\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 9030, "user_id": 5101476, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JCQrl.jpg?s=128&g=1", "display_name": "ice\u30c4", "link": "https://stackoverflow.com/users/5101476/ice%e3%83%84"}, "edited": false, "score": 0, "creation_date": 1501090872, "post_id": 45333984, "comment_id": 77629983, "body": "<a href=\"http://ruby-doc.org/core-2.4.1/Integer.html#method-i-digits\" rel=\"nofollow noreferrer\"><code>Integer#digits</code></a> :)"}, {"owner": {"reputation": 4600, "user_id": 5961578, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/df7cbfdd2a92a7926af3bbb8648318aa?s=128&d=identicon&r=PG", "display_name": "moveson", "link": "https://stackoverflow.com/users/5961578/moveson"}, "reply_to_user": {"reputation": 9030, "user_id": 5101476, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JCQrl.jpg?s=128&g=1", "display_name": "ice\u30c4", "link": "https://stackoverflow.com/users/5101476/ice%e3%83%84"}, "edited": false, "score": 0, "creation_date": 1501090997, "post_id": 45333984, "comment_id": 77630058, "body": "Fair comment--I am using Ruby 2.3 so it did not work in my implementation. But why not just use <code>%</code> in any case and avoid the conditional?"}], "tags": [], "owner": {"reputation": 4600, "user_id": 5961578, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/df7cbfdd2a92a7926af3bbb8648318aa?s=128&d=identicon&r=PG", "display_name": "moveson", "link": "https://stackoverflow.com/users/5961578/moveson"}, "is_accepted": false, "score": 3, "last_activity_date": 1501092040, "last_edit_date": 1501092040, "creation_date": 1501090805, "answer_id": 45333984, "question_id": 45333459, "link": "https://stackoverflow.com/questions/45333459/adding-the-number-to-the-according-index-it-is-positioned-in/45333984#45333984", "title": "Adding the number to the according index it is positioned in", "body": "<p>The <code>#digits</code> method requires Rails or ActiveSupport (or Ruby 2.4+), and it's not necessary. Here is a pure Ruby solution that works with any Ruby version:</p>\n\n<pre><code>def incrementer(array)\n  array.map.with_index(1) { |integer, index| (integer + index) % 10 }\nend\n</code></pre>\n\n<p>This code above says: For each element of the array, add its index (starting from 1), divide the sum by 10, and return the remainder.</p>\n\n<p>The <code>%</code> (modulo) operator divides the number before it by the number after it and returns the remainder. For example, <code>22 % 7</code> returns <code>1</code>. It's an extremely useful tool and can often help avoid the use of conditionals entirely, such as in your example. Using <code>%</code>, you can get the last digit of a number <code>n</code> (whether or not <code>n</code> is greater than 9) by simply taking <code>n % 10</code>. </p>\n\n<p>Now you can do:</p>\n\n<pre><code>&gt;&gt; incrementer([3,2,4,10])\n=&gt; [4, 4, 7, 4]\n&gt;&gt; incrementer([4,6,9,1,3])\n=&gt; [5, 8, 2, 5, 8]\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 4150, "user_id": 7470620, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/49f3026fe13841e41d1805178eed9a3c?s=128&d=identicon&r=PG", "display_name": "eiko", "link": "https://stackoverflow.com/users/7470620/eiko"}, "reply_to_user": {"reputation": 4600, "user_id": 5961578, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/df7cbfdd2a92a7926af3bbb8648318aa?s=128&d=identicon&r=PG", "display_name": "moveson", "link": "https://stackoverflow.com/users/5961578/moveson"}, "edited": false, "score": 0, "creation_date": 1501091450, "post_id": 45334017, "comment_id": 77630333, "body": "@moveson The only thing my answer adds is an explanation, but considering that the question asker originally asked how to use if-statements inside blocks, I thought an explanation would be helpful to them."}, {"owner": {"reputation": 4150, "user_id": 7470620, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/49f3026fe13841e41d1805178eed9a3c?s=128&d=identicon&r=PG", "display_name": "eiko", "link": "https://stackoverflow.com/users/7470620/eiko"}, "reply_to_user": {"reputation": 4600, "user_id": 5961578, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/df7cbfdd2a92a7926af3bbb8648318aa?s=128&d=identicon&r=PG", "display_name": "moveson", "link": "https://stackoverflow.com/users/5961578/moveson"}, "edited": false, "score": 0, "creation_date": 1501091881, "post_id": 45334017, "comment_id": 77630594, "body": "To be fair, I started this answer before sagarpandya84 posted theirs. While I updated it after seeing value in other posted answers, I never set out to copy an already existing answer. Still, I can add attribution if you like."}], "tags": [], "owner": {"reputation": 4150, "user_id": 7470620, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/49f3026fe13841e41d1805178eed9a3c?s=128&d=identicon&r=PG", "display_name": "eiko", "link": "https://stackoverflow.com/users/7470620/eiko"}, "is_accepted": false, "score": 1, "last_activity_date": 1501091988, "last_edit_date": 1501091988, "creation_date": 1501090913, "answer_id": 45334017, "question_id": 45333459, "link": "https://stackoverflow.com/questions/45333459/adding-the-number-to-the-according-index-it-is-positioned-in/45334017#45334017", "title": "Adding the number to the according index it is positioned in", "body": "<p>You've got two separate problems. The first problem is your use of <code>each_with_index</code>. Ruby functions return the value of the last expression they execute, so if you look at your function:</p>\n\n<pre><code>def incrementer(num)\n  num.each_with_index do |row, index|\n    # do some stuff\n  end\nend\n</code></pre>\n\n<p>It essentially calls <code>each_with_index</code> and returns the value. The issue here is that <code>each_with_index</code> iterates over an array and then <em>returns the original array</em>. What you want to do is change each item in the array and return a new array with the new values. For this, you can use map:</p>\n\n<pre><code>def incrementer(num)\n  num.map.with_index(1) do |row, index|\n    # do some stuff\n  end\nend\n</code></pre>\n\n<p>In this case, you can even conveniently pass in the parameter <code>1</code> to tell the iterator to start at index 1.</p>\n\n<p>Now the second problem is that your if-else-statement either iterates a number or wraps it around. But what you actually want to do is iterate a number <em>and</em> wrap it around if it's bigger than 9. You can do that like so:</p>\n\n<pre><code>def incrementer(num)\n  num.map.with_index(1) do |row, index|\n    row = index + row\n    if row &gt; 9\n      row.to_s.reverse.chop.to_i\n    else \n      row\n    end\n  end\nend\n</code></pre>\n\n<p>What we're doing here is iterating the number <em>first</em>, saving it into <code>row</code> and <em>then</em> checking to see if it's over 9. If it is, we return the last digit; otherwise, we just return the value <code>row</code>.</p>\n\n<p>This code will do what you want, but let's make one more change for the sake of clarity. This code:</p>\n\n<pre><code>row.to_s.reverse.chop.to_i\n</code></pre>\n\n<p>Is a little bit confusing. Ruby 2.4 has a convenient method for getting at the digits of an integer:</p>\n\n<pre><code>row.digits.first\n</code></pre>\n\n<p>This is easy to read, but it's a bit slow since it turns an integer into an array of integers. A better way is to use modulus <code>%</code> to get the remainder of your number, divided by 10. This is fast and easy to read for most programmers, since it's a common trick.</p>\n\n<pre><code>row % 10\n</code></pre>\n\n<p>Putting it all together, you get:</p>\n\n<pre><code>def incrementer(num)\n  num.map.with_index(1) do |row, index|\n    row = index + row\n    if row &gt; 9\n      row % 10\n    else \n      row\n    end\n  end\nend\n</code></pre>\n\n<p>Special thanks to (@sagarpandya84) and (@moveson) for allowing me to build on their answers.</p>\n"}], "owner": {"reputation": 757, "user_id": 6939256, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/e25b477a55a8048071d22e032ecf22f0?s=128&d=identicon&r=PG&f=1", "display_name": "Benjamints", "link": "https://stackoverflow.com/users/6939256/benjamints"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 75, "favorite_count": 0, "accepted_answer_id": 45333603, "answer_count": 3, "score": 2, "last_activity_date": 1501099914, "creation_date": 1501089218, "last_edit_date": 1501090360, "question_id": 45333459, "link": "https://stackoverflow.com/questions/45333459/adding-the-number-to-the-according-index-it-is-positioned-in", "title": "Adding the number to the according index it is positioned in", "body": "<pre><code>def incrementer(num)\n  num.map.with_index(1) do |row, index|\n    if row &gt; 9\n      row.to_s.reverse.chop.to_i\n    else \n      index + row\n    end\n  end\nend\n</code></pre>\n\n<p>Hi,</p>\n\n<p>I have a method which adds the number to the according index it is positioned in. However I have two rules:</p>\n\n<ol>\n<li>The index starts at (1)</li>\n<li>If the number is a multiple, remove the first integer off the end of it. 12 would become 2 for example.</li>\n</ol>\n\n<p>The problem is I am unsure how to include an 'if' statement inside a block and I believe I am doing it wrong. I know there is a much better way to write this statement but I am finding it hard.</p>\n\n<p>Example:</p>\n\n<pre><code>incrementer([4,6,9,1,3]) =&gt; [5,8,2,5,8]\n\n  - 9 + 3 (position of 9 in array) = 12 \n  - Only its last digit 2 should be returned\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby"], "answers": [{"tags": [], "owner": {"reputation": 2041, "user_id": 2071800, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/e1f877eccccc9e714b4d4fe03917f2a7?s=128&d=identicon&r=PG", "display_name": "Joe Half Face", "link": "https://stackoverflow.com/users/2071800/joe-half-face"}, "is_accepted": false, "score": 0, "last_activity_date": 1503257629, "last_edit_date": 1503257629, "creation_date": 1501091327, "answer_id": 45334136, "question_id": 45332987, "link": "https://stackoverflow.com/questions/45332987/rails-patch-actioncable-add-new-adapter/45334136#45334136", "title": "Rails: patch ActionCable (add new adapter)", "body": "<p>This is quite bad I suppose, but don't see any other way with this implementation other than:</p>\n\n<pre><code>module ActionCable\n  module Server\n    class Configuration\n      def pubsub_adapter\n        if Rails.env == 'test'\n          require Rails.root.join('lib/core_extensions/action_cable/test.rb')\n          ActionCable::SubscriptionAdapter::Test\n        else\n          super\n        end\n      end\n    end\n  end\nend\n</code></pre>\n\n<p>Any improvements are welcome.</p>\n\n<p><strong>EDIT</strong></p>\n\n<p>possibly much better way is to stub it needed test suits:</p>\n\n<pre><code>  before do\n    ActionCable.server.instance_variable_set(:@pubsub, ActionCable::SubscriptionAdapter::Test)\n  end\n</code></pre>\n"}], "owner": {"reputation": 2041, "user_id": 2071800, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/e1f877eccccc9e714b4d4fe03917f2a7?s=128&d=identicon&r=PG", "display_name": "Joe Half Face", "link": "https://stackoverflow.com/users/2071800/joe-half-face"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 387, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1503257629, "creation_date": 1501087625, "last_edit_date": 1501090684, "question_id": 45332987, "link": "https://stackoverflow.com/questions/45332987/rails-patch-actioncable-add-new-adapter", "title": "Rails: patch ActionCable (add new adapter)", "body": "<p>Question refers to this pull request: <a href=\"https://github.com/rails/rails/pull/23211\" rel=\"nofollow noreferrer\">https://github.com/rails/rails/pull/23211</a></p>\n\n<p>Since it has not been merged yet, I want to monkey patch this into my application.</p>\n\n<p>I put this subscription adapter to <code>lib/core_extenstions/subsctiption_adapter/test.rb</code></p>\n\n<p>Now, in initialize <code>monkey_patch.rb</code> I try:</p>\n\n<pre><code>#require  'lib/action_cable/test.rb'\n#autoload ActionCable::SubscriptionAdapter::Test\nmodule ActionCable\n  module SubscriptionAdapter\n    puts Rails.root.join('lib/core_extensions/action_cable/test.rb').inspect\n    autoload :Test, Rails.root.join('lib/core_extensions/action_cable/test.rb')\n    puts Test.inspect\n  end\nend\n</code></pre>\n\n<p>Then: </p>\n\n<pre><code>MacBook-Pro-Vaceslav:mvp_c slava$ bundle exec rails c test\nRunning via Spring preloader in process 93788\nLoading test environment (Rails 5.0.2)\nirb: warn: can't alias context from irb_context.\nirb(main):001:0&gt; server = ActionCable.server\n=&gt; #&lt;ActionCable::Server::Base:0x007f890e812628 @mutex=#&lt;Monitor:0x007f890e812600 @mon_owner=nil, @mon_count=0, @mon_mutex=#&lt;Thread::Mutex:0x007f890e8125b0&gt;&gt;, @pubsub=nil, @worker_pool=nil, @event_loop=nil, @remote_connections=nil&gt;\nirb(main):002:0&gt; server.pubsub\nLoadError: Could not load 'action_cable/subscription_adapter/test'. Make sure that the adapter in config/cable.yml is valid. If you use an adapter other than 'postgresql' or 'redis' add the necessary adapter gem to the Gemfile.\n</code></pre>\n\n<p>So source of issue is here:</p>\n\n<p><a href=\"https://github.com/rails/rails/blob/master/actioncable/lib/action_cable/server/configuration.rb\" rel=\"nofollow noreferrer\">https://github.com/rails/rails/blob/master/actioncable/lib/action_cable/server/configuration.rb</a></p>\n\n<pre><code>def pubsub_adapter\n    adapter = (cable.fetch(\"adapter\") { \"redis\" })\n    path_to_adapter = \"action_cable/subscription_adapter/#{adapter}\"\n    begin\n      require path_to_adapter\n    rescue Gem::LoadError =&gt; e\n      raise Gem::LoadError, \"Specified '#{adapter}' for Action Cable pubsub adapter, but the gem is not loaded. Add `gem '#{e.name}'` to your Gemfile (and ensure its version is at the minimum required by Action Cable).\"\n    rescue LoadError =&gt; e\n      raise LoadError, \"Could not load '#{path_to_adapter}'. Make sure that the adapter in config/cable.yml is valid. If you use an adapter other than 'postgresql' or 'redis' add the necessary adapter gem to the Gemfile.\", e.backtrace\n    end\n\n    adapter = adapter.camelize\n    adapter = \"PostgreSQL\" if adapter == \"Postgresql\"\n    \"ActionCable::SubscriptionAdapter::#{adapter}\".constantize\n  end\n</code></pre>\n\n<p>Not sure how to workaround this.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "templates", "heroku", "ruby-on-rails-5"], "comments": [{"owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 0, "creation_date": 1501088191, "post_id": 45332924, "comment_id": 77628242, "body": "Where is the <code>errors&#47;not_found.html.erb</code> in your application located?"}, {"owner": {"reputation": 1075, "user_id": 6561814, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/AiS9a.png?s=128&g=1", "display_name": "jonhue", "link": "https://stackoverflow.com/users/6561814/jonhue"}, "reply_to_user": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 0, "creation_date": 1501088330, "post_id": 45332924, "comment_id": 77628340, "body": "@spickermann <code>app&#47;views&#47;errors&#47;not_found.html.haml</code>"}, {"owner": {"reputation": 1075, "user_id": 6561814, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/AiS9a.png?s=128&g=1", "display_name": "jonhue", "link": "https://stackoverflow.com/users/6561814/jonhue"}, "reply_to_user": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 0, "creation_date": 1501088397, "post_id": 45332924, "comment_id": 77628383, "body": "@spickermann I mean it gets rendered, that&#39;s the thing. The error occurs simultaneously."}, {"owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 0, "creation_date": 1501097680, "post_id": 45332924, "comment_id": 77633813, "body": "What version of Rails are you using? Because newer versions of Rails do not support the <code>:template</code> option anymore."}, {"owner": {"reputation": 1075, "user_id": 6561814, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/AiS9a.png?s=128&g=1", "display_name": "jonhue", "link": "https://stackoverflow.com/users/6561814/jonhue"}, "reply_to_user": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 0, "creation_date": 1501106278, "post_id": 45332924, "comment_id": 77638206, "body": "@spickermann <code>5.1.0.rc2</code>"}], "owner": {"reputation": 1075, "user_id": 6561814, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/AiS9a.png?s=128&g=1", "display_name": "jonhue", "link": "https://stackoverflow.com/users/6561814/jonhue"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 319, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1501109862, "creation_date": 1501087414, "question_id": 45332924, "link": "https://stackoverflow.com/questions/45332924/rails-heroku-missing-template-application-not-found", "title": "Rails, Heroku: Missing template application/not_found", "body": "<p>It appears that my Rails 5 app (only in production - on Heroku) causes these missing template errors for <code>application/not_found</code>. This error does not cause the app to crash though.</p>\n\n<pre><code>#&lt;ActionView::MissingTemplate: Missing template application/not_found with {:locale=&gt;[:en], :formats=&gt;[nil], :variants=&gt;[], :handlers=&gt;[:raw, :erb, :html, :builder, :ruby, :coffee, :haml, :jbuilder]}. Searched in: \n   * \"/app/app/views\" \n   * \"/app/vendor/bundle/ruby/2.3.0/gems/devise-authy-1.8.1/app/views\" \n   * \"/app/vendor/bundle/ruby/2.3.0/gems/devise_invitable-1.7.2/app/views\" \n   * \"/app/vendor/bundle/ruby/2.3.0/bundler/gems/devise-71fc5b351a8e/app/views\" \n   * \"/app/vendor/bundle/ruby/2.3.0/gems/kaminari-core-1.0.1/app/views\" \n &gt; \n</code></pre>\n\n<hr>\n\n<p>I routed <code>*path</code> to <code>application#not_found</code> to catch misspelled requests.</p>\n\n<p>In <code>ApplicationController</code>:</p>\n\n<pre><code>rescue_from (ActiveRecord::RecordNotFound) { |exception| handle_exception(exception, 404) }\nrescue_from (AbstractController::ActionNotFound) { |exception| handle_exception(exception, 404) }\nrescue_from (ActionController::RoutingError) { |exception| handle_exception(exception, 404) }\n\n\ndef not_found\n    raise ActionController::RoutingError.new(params[:path] || 'Not Found')\nend\n\nprotected\n\ndef handle_exception ex, status\n    render_error ex, status\n    logger.error ex\nend\n\ndef render_error ex, status\n    @status_code = status\n    respond_to do |format|\n        if status == 404\n            format.html { render template: 'errors/not_found', status: status }\n        end\n        format.all { render nothing: true, status: status }\n    end\nend\n</code></pre>\n\n<p>I thought that by specifying <code>render template: 'errors/not_found'</code> Rails 'd know that a template got rendered.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "rspec", "internationalization"], "comments": [{"owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 0, "creation_date": 1501088324, "post_id": 45332884, "comment_id": 77628332, "body": "How does your spec file look like?"}, {"owner": {"reputation": 1, "user_id": 8371388, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cafe60c46d26b1342e8a5376cb7f290e?s=128&d=identicon&r=PG&f=1", "display_name": "yadhu prakash", "link": "https://stackoverflow.com/users/8371388/yadhu-prakash"}, "reply_to_user": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 0, "creation_date": 1501100202, "post_id": 45332884, "comment_id": 77635204, "body": "@spickermann updated the question to add spec file."}], "answers": [{"tags": [], "owner": {"reputation": 334, "user_id": 6413990, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e1b2789440f48548f5a99ff92ca186d4?s=128&d=identicon&r=PG&f=1", "display_name": "Stanislav Kr.", "link": "https://stackoverflow.com/users/6413990/stanislav-kr"}, "is_accepted": false, "score": 0, "last_activity_date": 1502378472, "creation_date": 1502378472, "answer_id": 45617710, "question_id": 45332884, "link": "https://stackoverflow.com/questions/45332884/is-there-any-way-to-test-custom-pluralization-rules-using-rspec-in-rails/45617710#45617710", "title": "Is there any way to test custom pluralization rules using Rspec in rails", "body": "<p><code>expect(I18n.t('views.project.drawing_log.upload_sub_text', count:1)).to eq 'value'</code></p>\n"}], "owner": {"reputation": 1, "user_id": 8371388, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cafe60c46d26b1342e8a5376cb7f290e?s=128&d=identicon&r=PG&f=1", "display_name": "yadhu prakash", "link": "https://stackoverflow.com/users/8371388/yadhu-prakash"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 141, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1502378472, "creation_date": 1501087288, "last_edit_date": 1501089107, "question_id": 45332884, "link": "https://stackoverflow.com/questions/45332884/is-there-any-way-to-test-custom-pluralization-rules-using-rspec-in-rails", "title": "Is there any way to test custom pluralization rules using Rspec in rails", "body": "<p>I have added custom pluralization rules for Korean locale and was wondering if there was a way to test this using Rspec.To add custom rules I have added the following code at /config/initializers/pluralization.rb:</p>\n\n<pre><code>require \"i18n/backend/pluralization\"\nI18n::Backend::Simple.send(:include, I18n::Backend::Pluralization)\n</code></pre>\n\n<p>and added the custom rules at config/locales/plurals.rb which as of now is </p>\n\n<pre><code>{\n  :ko =&gt; { :i18n =&gt; { :plural =&gt; { :keys =&gt; [:other], :rule =&gt; lambda { |n| :other } } } }\n}\n</code></pre>\n\n<p>When I try testing it using rails console, I see that the custom rules are in effect, but when I try the same translation in my spec folder while running an Rspec test I get the following error:</p>\n\n<pre><code>I18n::InvalidPluralizationData: translation data {:other=&gt;\"%{count} xxxxxxxx\"} can not be used with :count =&gt; 1\n</code></pre>\n\n<p>My spec file looks like this:\nPath: /spec/locales/default_pluralization_key_ko_spec.rb</p>\n\n<pre><code>Rspec.describe \"Korean Locale Pluralization Test\" do\n\n  describe \"checking korean\" do\n    it  \"korean pluralization with keys only :other\" do\n      I18n.locale = :ko\n      I18n.t('views.project.drawing_log.upload_sub_text', count:1)\n\n    end\n  end\nend\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "web-applications"], "comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 1, "creation_date": 1501085143, "post_id": 45332091, "comment_id": 77626170, "body": "Your link to delete is wrong. Can you edit your question and add the relevant view code? The screenshot is not informative."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 2, "creation_date": 1501085183, "post_id": 45332091, "comment_id": 77626199, "body": "Ruby also strongly encourages the use of lower-case only variable and method names, so <code>lastOwner</code> should be <code>last_owner</code>. This is because case has meaning in Ruby, constants are prefixed with capital letters."}, {"owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 0, "creation_date": 1501085725, "post_id": 45332091, "comment_id": 77626582, "body": "How does your <code>config&#47;routes.rb</code> look like? How do you generate the delete button?"}, {"owner": {"reputation": 215, "user_id": 8234241, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/d329af62bb5d6cb53013518b028b4450?s=128&d=identicon&r=PG&f=1", "display_name": "quincosa", "link": "https://stackoverflow.com/users/8234241/quincosa"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1501086023, "post_id": 45332091, "comment_id": 77626819, "body": "@tadman i added the code, thank you."}, {"owner": {"reputation": 215, "user_id": 8234241, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/d329af62bb5d6cb53013518b028b4450?s=128&d=identicon&r=PG&f=1", "display_name": "quincosa", "link": "https://stackoverflow.com/users/8234241/quincosa"}, "reply_to_user": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 0, "creation_date": 1501086037, "post_id": 45332091, "comment_id": 77626834, "body": "@spickermann added my routes"}, {"owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 0, "creation_date": 1501087472, "post_id": 45332091, "comment_id": 77627766, "body": "Perhaps it is just me: Your routes look like you are trying to delete a team, but in your question, you write about deleting a user (or its membership). Can you please clarify?"}, {"owner": {"reputation": 215, "user_id": 8234241, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/d329af62bb5d6cb53013518b028b4450?s=128&d=identicon&r=PG&f=1", "display_name": "quincosa", "link": "https://stackoverflow.com/users/8234241/quincosa"}, "reply_to_user": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 0, "creation_date": 1501087758, "post_id": 45332091, "comment_id": 77627934, "body": "team is just the name of the controller but it handles all the actions for a  user @spickermann"}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1501090632, "post_id": 45332091, "comment_id": 77629837, "body": "That link in the view code you provided should be correct, so are you sure that&#39;s the link you&#39;re actually exercising? It looks like the error results from <code>teams_path, method: delete</code> which is not shown here."}], "answers": [{"tags": [], "owner": {"reputation": 313, "user_id": 7485168, "user_type": "registered", "profile_image": "https://graph.facebook.com/1797273820298202/picture?type=large", "display_name": "Jok\u016bbas Brunonas Pu\u010dinskas", "link": "https://stackoverflow.com/users/7485168/jok%c5%abbas-brunonas-pu%c4%8dinskas"}, "is_accepted": false, "score": 0, "last_activity_date": 1501097161, "creation_date": 1501097161, "answer_id": 45335811, "question_id": 45332091, "link": "https://stackoverflow.com/questions/45332091/validating-a-collection-of-objects-before-deleting-in-ruby/45335811#45335811", "title": "Validating a collection of objects before deleting in ruby", "body": "<p>Try to change <code>redirect_to teams_path</code> to <code>redirect_to teams_url</code> in your <code>respond_to</code> code block.</p>\n"}], "owner": {"reputation": 215, "user_id": 8234241, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/d329af62bb5d6cb53013518b028b4450?s=128&d=identicon&r=PG&f=1", "display_name": "quincosa", "link": "https://stackoverflow.com/users/8234241/quincosa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 52, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1501097161, "creation_date": 1501084942, "last_edit_date": 1501085978, "question_id": 45332091, "link": "https://stackoverflow.com/questions/45332091/validating-a-collection-of-objects-before-deleting-in-ruby", "title": "Validating a collection of objects before deleting in ruby", "body": "<p>I am trying to only allow deletion if there are more than one users with the role \"owner\". I would like to display an error message that they cannot delete the user(with role owner) if it is the only owner. This is what the table looks like.</p>\n\n<p><a href=\"https://i.stack.imgur.com/cGiGe.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/cGiGe.png\" alt=\"enter image description here\"></a></p>\n\n<pre><code>def destroy\n  @user = @organization.users\n  .active\n  .find(params[:id])\n\n  lastOwner = @organization.users\n  .active\n  .where(role: \"owner\")\n  .where.not(id: @user.id)\n  .count\n  .zero?\n\n  if lastOwner\n    flash[:error] = \"There must always be at least one owner, please give another user the role first\"\n    redirect_to teams_path\n    return\n  else\n    if @user &amp;&amp; @user.archive!\n\n      respond_to do |format|\n        format.html { redirect_to teams_path }\n        format.json { head :no_content }\n        format.js   { render :layout =&gt; false }\n      end\n    end\n  end\nend\n</code></pre>\n\n<p>That is my destroy method. </p>\n\n<p>What is happening is that i try to redirect but i am receiving the error </p>\n\n<pre><code>Started DELETE \"/teams\" for ::1 at 2017-07-26 11:45:28 -0400\n\nActionController::RoutingError (No route matches [DELETE] \"/teams\"):\n  actionpack (4.2.3) lib/action_dispatch/middleware/debug_exceptions.rb:21:in `call'\n  actionpack (4.2.3) lib/action_dispatch/middleware/show_exceptions.rb:30:in `call'\n  railties (4.2.3) lib/rails/rack/logger.rb:38:in `call_app'\n  railties (4.2.3) lib/rails/rack/logger.rb:20:in `block in call'\n  activesupport (4.2.3) lib/active_support/tagged_logging.rb:68:in `block in tagged'\n  activesupport (4.2.3) lib/active_support/tagged_logging.rb:26:in `tagged'\n  activesupport (4.2.3) lib/active_support/tagged_logging.rb:68:in `tagged'\n  railties (4.2.3) lib/rails/rack/logger.rb:20:in `call'\n  actionpack (4.2.3) lib/action_dispatch/middleware/request_id.rb:21:in `call'\n  rack (1.6.4) lib/rack/methodoverride.rb:22:in `call'\n  rack (1.6.4) lib/rack/runtime.rb:18:in `call'\n  activesupport (4.2.3) lib/active_support/cache/strategy/local_cache_middleware.rb:28:in `call'\n  rack (1.6.4) lib/rack/lock.rb:17:in `call'\n  actionpack (4.2.3) lib/action_dispatch/middleware/static.rb:116:in `call'\n  rack (1.6.4) lib/rack/sendfile.rb:113:in `call'\n  railties (4.2.3) lib/rails/engine.rb:518:in `call'\n  railties (4.2.3) lib/rails/application.rb:165:in `call'\n  rack (1.6.4) lib/rack/content_length.rb:15:in `call'\n  puma (3.9.1) lib/puma/configuration.rb:224:in `call'\n  puma (3.9.1) lib/puma/server.rb:602:in `handle_request'\n  puma (3.9.1) lib/puma/server.rb:435:in `process_client'\n  puma (3.9.1) lib/puma/server.rb:299:in `block in run'\n  puma (3.9.1) lib/puma/thread_pool.rb:120:in `call'\n  puma (3.9.1) lib/puma/thread_pool.rb:120:in `block in spawn_thread'\n\n\n  Rendered /Users/kristianquincosa/.rvm/gems/ruby-2.2.3/gems/actionpack-4.2.3/lib/action_dispatch/middleware/templates/rescues/_trace.text.erb (0.7ms)\n  Rendered /Users/kristianquincosa/.rvm/gems/ruby-2.2.3/gems/actionpack-4.2.3/lib/action_dispatch/middleware/templates/rescues/routing_error.text.erb (18.7ms)\n</code></pre>\n\n<p>once i receive the error the record does no t delete but the error message is not flashed but the page is redirected. When i refresh the page is when i see the error message. Any help please and thank you!</p>\n\n<p>EDIT</p>\n\n<p>this is the code for the delete </p>\n\n<pre><code>link_to('', team_path(user), method: :delete, data: {confirm: \"Are you sure you want to delete this member?\"}, :remote =&gt; true, class: \"btn btn-danger fa fa-trash delete_user\")\n</code></pre>\n\n<p>these are my routes </p>\n\n<pre><code>teams GET    /teams(.:format)                                         teams#index\n                                         POST   /teams(.:format)                                         teams#create\n                                new_team GET    /teams/new(.:format)                                     teams#new\n                               edit_team GET    /teams/:id/edit(.:format)                                teams#edit\n                                    team PATCH  /teams/:id(.:format)                                     teams#update\n                                         PUT    /teams/:id(.:format)                                     teams#update\n                                         DELETE /teams/:id(.:format)                                     teams#destroy\n</code></pre>\n"}, {"tags": ["ruby", "ruby-on-rails-4", "activerecord"], "answers": [{"comments": [{"owner": {"reputation": 343, "user_id": 3840725, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5un6e.jpg?s=128&g=1", "display_name": "jpheos", "link": "https://stackoverflow.com/users/3840725/jpheos"}, "edited": false, "score": 0, "creation_date": 1501144745, "post_id": 45332918, "comment_id": 77652243, "body": "thanks for you very detailed answer. but I&#39;m not agree with you. You said &quot;before_destroy callback is run for the parent object&quot;, but I think it depend the order of your declaration. In your example you&#39;ve changed the order of the declarations"}, {"owner": {"reputation": 2216, "user_id": 7165275, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d8ad41f944f38348a30791dc7f7d02c?s=128&d=identicon&r=PG&f=1", "display_name": "m. simon borg", "link": "https://stackoverflow.com/users/7165275/m-simon-borg"}, "reply_to_user": {"reputation": 343, "user_id": 3840725, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5un6e.jpg?s=128&g=1", "display_name": "jpheos", "link": "https://stackoverflow.com/users/3840725/jpheos"}, "edited": false, "score": 0, "creation_date": 1501160066, "post_id": 45332918, "comment_id": 77663742, "body": "I think the fact that the order of execution is not obvious to both of us is reason enough not to rely on callbacks for this, don&#39;t you? : ) Callbacks are powerful but can also be overcomplicated for things that can be achieved with built in language features. You also can&#39;t break out of an action like <code>destroy</code> from within a callback. I think using Ruby&#39;s built-in callback system (i.e. <code>super</code>) is a better fit for you. You can control exactly when it will be executed, and are able to return early out of your <code>destroy</code> method unlike with a callback. Ruby&#39;s powerful, it should be used!"}, {"owner": {"reputation": 2216, "user_id": 7165275, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d8ad41f944f38348a30791dc7f7d02c?s=128&d=identicon&r=PG&f=1", "display_name": "m. simon borg", "link": "https://stackoverflow.com/users/7165275/m-simon-borg"}, "reply_to_user": {"reputation": 343, "user_id": 3840725, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5un6e.jpg?s=128&g=1", "display_name": "jpheos", "link": "https://stackoverflow.com/users/3840725/jpheos"}, "edited": false, "score": 0, "creation_date": 1501160158, "post_id": 45332918, "comment_id": 77663826, "body": "I also still don&#39;t think you should rely on an instance variable at all to carry this state. I wouldn&#39;t assume I know when a new object will or won&#39;t be instantiated in a long execution flow like this, wiping out your instance variables. Might as well hit the database one extra time to guarantee the integrity of the object state"}, {"owner": {"reputation": 2216, "user_id": 7165275, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d8ad41f944f38348a30791dc7f7d02c?s=128&d=identicon&r=PG&f=1", "display_name": "m. simon borg", "link": "https://stackoverflow.com/users/7165275/m-simon-borg"}, "reply_to_user": {"reputation": 343, "user_id": 3840725, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5un6e.jpg?s=128&g=1", "display_name": "jpheos", "link": "https://stackoverflow.com/users/3840725/jpheos"}, "edited": false, "score": 0, "creation_date": 1501161141, "post_id": 45332918, "comment_id": 77664743, "body": "You&#39;re right about the order of declaration, sorry about that! I edited the answer. I still hold to the main point though, hope it helps."}], "tags": [], "owner": {"reputation": 2216, "user_id": 7165275, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d8ad41f944f38348a30791dc7f7d02c?s=128&d=identicon&r=PG&f=1", "display_name": "m. simon borg", "link": "https://stackoverflow.com/users/7165275/m-simon-borg"}, "is_accepted": false, "score": 0, "last_activity_date": 1501161082, "last_edit_date": 1501161082, "creation_date": 1501087395, "answer_id": 45332918, "question_id": 45332089, "link": "https://stackoverflow.com/questions/45332089/active-record-use-instance-variable-was-defined-in-before-destroy-block/45332918#45332918", "title": "active record, use instance variable was defined in before_destroy block", "body": "<p>Depending on the order of declaration, your dependent objects can be destroyed before the <code>before_destroy</code> callback is run for the parent object.</p>\n\n<p>You can test this yourself:</p>\n\n<pre><code>class Company &lt; ActiveRecord::Base\n  belongs_to  :owner,     class_name: 'User', foreign_key: 'owner_id'\n  has_many    :employees, class_name: 'User', dependent: :destroy\n\n  before_destroy do\n    @test_variable = \"hi\"\n    puts @test_variable\n    puts \"Company destroyed\"\n  end\nend\n\nclass User &lt; ActiveRecord::Base\n  belongs_to        :company\n\n  before_destroy do\n    puts company.instance_variable_get(:@test_variable)\n    puts \"User destroyed\"\n  end\nend\n</code></pre>\n\n<p><code>\"Company destroyed\"</code> will be the last thing printed after all the <code>users</code> are already gone, and you will get an empty string <code>puts</code>ed in place of \"hi\" for each user, because <code>@test_variable</code> has not yet been set. However if you declare that callback before you declare the associations, <code>\"Company destroyed\"</code> will be printed first, and you should see <code>\"hi\"</code> printed as each <code>User</code> is <code>destroy</code>ed.</p>\n\n<p>If you ask me, that's very unexpected. Callbacks can overcomplicate things and are often overused, how can we guarantee we know exactly what's happening in such a complex execution flow? Ruby has a built-in callback system for descendant objects that is much easier to understand, and very predictable in its behavior: <code>super</code></p>\n\n<pre><code>class Company\n  def destroy(*args, &amp;block)\n    @bool_allow_owner_be_destroyed = true\n    super\n  end\nend\n</code></pre>\n\n<p>Anything you do before the call to <code>super</code> will be guaranteed to run before any of the dependent objects are destroyed or anything else that's triggered by <code>destroy</code>. There's no ambiguity when using <code>super</code>.</p>\n\n<p>To cancel <code>destroy</code> for the <code>owner</code> you could also use <code>super</code>, along with an early <code>return</code>.</p>\n\n<pre><code>class User &lt; ActiveRecord::Base\n  belongs_to :company\n\n  def destroy(*args, &amp;block)\n    return unless can_be_destroyed?\n    super\n  end\n\n  def can_be_destroyed?\n    !is_owner? || company.can_owner_be_destroyed?\n  end\nend\n</code></pre>\n\n<p>Overall I'd suggest that trying to carry state on an ActiveRecord object with an instance variable might get you in trouble at some point, especially if associated objects will rely on that state or you have multiple instances of your app running at the same time.</p>\n\n<p>You could instead make this a db field and persist the change.</p>\n\n<pre><code>class AddAllowOwnerBeDestroyedColumnToCompanies &lt; ActiveRecord::Migration\n  def change\n    add_column :companies, :allow_owner_be_destroyed, :boolean, default: false\n  end\nend\n\nclass Company &lt; ActiveRecord::Base    \n  belongs_to  :owner,     class_name: 'User', foreign_key: 'owner_id'\n  has_many    :employees, class_name: 'User', dependent: :destroy\n\n  # You won't need this method b/c you now have `#allow_owner_be_destroyed?` for free\n  # def can_owner_be_destroyed?\n  #  p allow_owner_be_destroyed\n  #  p object_id\n  #  allow_owner_be_destroyed\n  # end\n\n  def destroy(*args, &amp;block)\n    update allow_owner_be_destroyed: true\n    super\n  end\nend\n\nclass User &lt; ActiveRecord::Base\n  belongs_to :company\n\n  def destroy(*args, &amp;block)\n    return unless can_be_destroyed?\n    super\n  end\n\n  def can_be_destroyed?\n    !is_owner? || company.allow_owner_be_destroyed?\n  end\nend\n</code></pre>\n"}], "owner": {"reputation": 343, "user_id": 3840725, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5un6e.jpg?s=128&g=1", "display_name": "jpheos", "link": "https://stackoverflow.com/users/3840725/jpheos"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 106, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1501161082, "creation_date": 1501084936, "question_id": 45332089, "link": "https://stackoverflow.com/questions/45332089/active-record-use-instance-variable-was-defined-in-before-destroy-block", "title": "active record, use instance variable was defined in before_destroy block", "body": "<p><strong>Some context:</strong></p>\n\n<p>A company has many users. Whose one is the owner.\nYou can destroy everyone on the company except the owner.\nDestroy the owner, it's like destroy the company. So you must do <code>company.destroy</code>\nI prevent destroy user if he is owner, except if you are destroying the company.</p>\n\n<p><strong>My code:</strong></p>\n\n<pre><code>class Company &lt; ActiveRecord::Base\n  before_destroy { @bool_allow_owner_be_destroyed = true ; p object_id }\n\n  belongs_to  :owner,     class_name: 'User', foreign_key: 'owner_id'\n  has_many    :employees, class_name: 'User', dependent: :destroy\n\n  def can_owner_be_destroyed?\n    p @bool_allow_owner_be_destroyed\n    p object_id\n    !!@bool_allow_owner_be_destroyed\n  end\nend\n\nclass User &lt; ActiveRecord::Base\n  belongs_to        :company\n  before_destroy    :cancel_if_owner\n\n  def cancel_if_owner\n    !self.is_owner? || self.company.can_owner_be_destroyed?\n  end\nend\n</code></pre>\n\n<p><strong>My question:</strong></p>\n\n<p>When I call <code>company.destroy</code> I see my debug. I'm passing in <code>before_destroy { @bool_allow_owner_be_destroyed = true ; p object_id }</code> and I see my object_id.\nWhen I passing in <code>can_owner_be_destroyed?</code> method, I have the same object_id, but my <code>@bool_allow_owner_be_destroyed</code> is <code>nil</code>. It's the only place on my code I touch the <code>@bool_allow_owner_be_destroyed</code> variable.</p>\n\n<p>Any ideas?</p>\n"}, {"tags": ["ruby", "web-services", "wsdl", "savon"], "comments": [{"owner": {"reputation": 620, "user_id": 3786539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dc6aa3aa9b8fb584e66bab9c572ec92b?s=128&d=identicon&r=PG&f=1", "display_name": "akshay_kashain", "link": "https://stackoverflow.com/users/3786539/akshay-kashain"}, "edited": false, "score": 0, "creation_date": 1534214906, "post_id": 45331730, "comment_id": 90619987, "body": "Were you able to work around this? I have the exact same problem for promo standards. If you did fix it, would be great if you could put in some code snippet here :)"}, {"owner": {"reputation": 529, "user_id": 584967, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/ccc57756273eba3bc2fcd5c82333ab24?s=128&d=identicon&r=PG", "display_name": "Cryptographic_ICE", "link": "https://stackoverflow.com/users/584967/cryptographic-ice"}, "reply_to_user": {"reputation": 620, "user_id": 3786539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dc6aa3aa9b8fb584e66bab9c572ec92b?s=128&d=identicon&r=PG&f=1", "display_name": "akshay_kashain", "link": "https://stackoverflow.com/users/3786539/akshay-kashain"}, "edited": false, "score": 0, "creation_date": 1535139977, "post_id": 45331730, "comment_id": 90972528, "body": "@akshay_kashain I have edited my question to include the solution I ended up using. There is another answer you may find useful here: <a href=\"https://stackoverflow.com/a/50261599/584967\">stackoverflow.com/a/50261599/584967</a>"}], "answers": [{"tags": [], "owner": {"reputation": 627, "user_id": 1791884, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/76c200f0db428dcf47948631a0ce66f4?s=128&d=identicon&r=PG", "display_name": "skahlert", "link": "https://stackoverflow.com/users/1791884/skahlert"}, "is_accepted": true, "score": 1, "last_activity_date": 1510918717, "creation_date": 1510918717, "answer_id": 47349812, "question_id": 45331730, "link": "https://stackoverflow.com/questions/45331730/ruby-savon-and-wsdl-namespacing/47349812#47349812", "title": "ruby savon and wsdl namespacing", "body": "<p>I think Savon doesn't interpret linked XSD files, which are used here to reference the SharedObject. Had a similar problem and the only solution I found was to manually write the definition of the namespaces.</p>\n\n<p>In your case it might look something like this:</p>\n\n<pre><code>client = Savon.client do\n  endpoint \"http://localhost/OrderShipmentNotificationService.svc\"\n  element_form_default :qualified\n  namespace \"http://www.promostandards.org/WSDL/OrderShipmentNotificationService/1.0.0/\"\n  namespace_identifier :ns\n  namespaces \"xmlns:shar\"=&gt;\"http://www.promostandards.org/WSDL/OrderShipmentNotificationService/1.0.0/SharedObjects/\"\nend\n\nresponse = client.call(\"GetOrderShipmentNotificationRequest\") do |locals|\n  locals.message \"shar:wsVersion\"=&gt;\"1.0.0\",\"shar:id\"=&gt;\"myusername\",...\nend\n</code></pre>\n"}], "owner": {"reputation": 529, "user_id": 584967, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/ccc57756273eba3bc2fcd5c82333ab24?s=128&d=identicon&r=PG", "display_name": "Cryptographic_ICE", "link": "https://stackoverflow.com/users/584967/cryptographic-ice"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 496, "favorite_count": 0, "accepted_answer_id": 47349812, "answer_count": 1, "score": 5, "last_activity_date": 1535139876, "creation_date": 1501083898, "last_edit_date": 1535139876, "question_id": 45331730, "link": "https://stackoverflow.com/questions/45331730/ruby-savon-and-wsdl-namespacing", "title": "ruby savon and wsdl namespacing", "body": "<p>I have an issue that I believe is in regards to namespaces. The WSDL can be downloaded from here: <a href=\"http://promostandards.org/content/wsdl/Order%20Shipment%20NotificationService/1.0.0/OSN-1-0-0.zip\" rel=\"nofollow noreferrer\">http://promostandards.org/content/wsdl/Order%20Shipment%20NotificationService/1.0.0/OSN-1-0-0.zip</a></p>\n\n<p>When the request is generated it looks like this:</p>\n\n<pre><code>&lt;soapenv:Envelope xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xmlns:tns=\"http://www.promostandards.org/WSDL/OrderShipmentNotificationService/1.0.0/\" xmlns:soapenv=\"http://schemas.xmlsoap.org/soap/envelope/\"&gt;\n&lt;soapenv:Body&gt;\n&lt;tns:GetOrderShipmentNotificationRequest&gt;\n  &lt;tns:wsVersion&gt;1.0.0&lt;/tns:wsVersion&gt;\n  &lt;tns:id&gt;myusername&lt;/tns:id&gt;\n  &lt;tns:password&gt;mypassword&lt;/tns:password&gt;\n  &lt;tns:queryType&gt;3&lt;/tns:queryType&gt;\n  &lt;tns:shipmentDateTimeStamp&gt;2017-07-19&lt;/tns:shipmentDateTimeStamp&gt;\n&lt;/tns:GetOrderShipmentNotificationRequest&gt;\n&lt;/soapenv:Body&gt;\n&lt;/soapenv:Envelope&gt;\n</code></pre>\n\n<p>This results in a soap fault.</p>\n\n<p>When SoapUI constructs the request using the same WSDL it looks like this</p>\n\n<pre><code>&lt;soapenv:Envelope xmlns:soapenv=\"http://schemas.xmlsoap.org/soap/envelope/\" xmlns:ns=\"http://www.promostandards.org/WSDL/OrderShipmentNotificationService/1.0.0/\" xmlns:shar=\"http://www.promostandards.org/WSDL/OrderShipmentNotificationService/1.0.0/SharedObjects/\"&gt;\n&lt;soapenv:Header/&gt;\n&lt;soapenv:Body&gt;\n  &lt;ns:GetOrderShipmentNotificationRequest&gt;\n     &lt;shar:wsVersion&gt;1.0.0&lt;/shar:wsVersion&gt;\n     &lt;shar:id&gt;myusername&lt;/shar:id&gt;\n     &lt;shar:password&gt;mypassword&lt;/shar:password&gt;\n     &lt;ns:queryType&gt;3&lt;/ns:queryType&gt;\n     &lt;ns:shipmentDateTimeStamp&gt;2017-07-19&lt;/ns:shipmentDateTimeStamp&gt;\n  &lt;/ns:GetOrderShipmentNotificationRequest&gt;\n&lt;/soapenv:Body&gt;\n&lt;/soapenv:Envelope&gt;\n</code></pre>\n\n<p>You can see that SoapUI has placed the username and password inside the \"shar\" namespace. I noticed that this is not directly listed in the WSDL or in any XSD file directly loaded by the WSDL. It gets loaded something like WSDL => XSD file => XSD file containing shar namespace. could that be the issue? How can I add the namespace to just 3 of the keys? I'm using savon 2.11.1 and nori 2.6.0</p>\n\n<p>Here is the solution I ended up using:</p>\n\n<pre><code>@client = Savon.client(\n    wsdl: 'OSN-1-0-0/WSDL/1.0.0/OrderShipmentNotificationService.wsdl',\n    endpoint: @endpoint,\n    env_namespace: :soapenv,\n    namespaces: { \"xmlns:shar\" =&gt; \"http://www.promostandards.org/WSDL/OrderShipmentNotificationService/1.0.0/SharedObjects/\" },\n    element_form_default: :qualified,\n    headers: { \"accept-encoding\" =&gt; \"identity\" }\n)\n\nresponse = @client.call(:get_order_shipment_notification, message: {\n    'shar:ws_version': @version,\n    'shar:id': @username, \n    'shar:password': @password,\n    query_type: 3,\n    shipment_date_time_stamp: date\n})\n</code></pre>\n"}, {"tags": ["ruby", "chef-infra"], "answers": [{"comments": [{"owner": {"reputation": 887, "user_id": 8014301, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/8399d118068d5ccd7d47cbd574095b42?s=128&d=identicon&r=PG&f=1", "display_name": "J0991", "link": "https://stackoverflow.com/users/8014301/j0991"}, "edited": false, "score": 0, "creation_date": 1501089231, "post_id": 45332877, "comment_id": 77628940, "body": "So I think I understand what you&#39;re saying. I currently have a wrapper cookbook for the Jenkins Supermarket cookbook, which depends on the Java SE and Git cookbooks. I&#39;m just not sure exactly where I would specify the literal apt_update in order for the apt update to occur before the last recipe in the run-list (Git), is converged."}, {"owner": {"reputation": 43208, "user_id": 78722, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cf611565f0b79abd0b3dc200ad867661?s=128&d=identicon&r=PG", "display_name": "coderanger", "link": "https://stackoverflow.com/users/78722/coderanger"}, "reply_to_user": {"reputation": 887, "user_id": 8014301, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/8399d118068d5ccd7d47cbd574095b42?s=128&d=identicon&r=PG&f=1", "display_name": "J0991", "link": "https://stackoverflow.com/users/8014301/j0991"}, "edited": false, "score": 0, "creation_date": 1501089520, "post_id": 45332877, "comment_id": 77629145, "body": "Pretty much, most people end up with a role or cookbook called something like <code>base</code> eventually, so it usually goes in there along with other global setup that is applied to all servers in your infra."}, {"owner": {"reputation": 887, "user_id": 8014301, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/8399d118068d5ccd7d47cbd574095b42?s=128&d=identicon&r=PG&f=1", "display_name": "J0991", "link": "https://stackoverflow.com/users/8014301/j0991"}, "edited": false, "score": 0, "creation_date": 1501090413, "post_id": 45332877, "comment_id": 77629702, "body": "Hmm... Ideally, I&#39;d like to just specify an additional recipe to run in my run list for the node which causes an apt_update. It seems like the most simple solution at this point (and can be reapplied as needed later on). Are there any cookbooks that have such a recipe? I&#39;ve given Chef Public Supermarket a look, but didn&#39;t seem to be able to find anything there."}, {"owner": {"reputation": 43208, "user_id": 78722, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cf611565f0b79abd0b3dc200ad867661?s=128&d=identicon&r=PG", "display_name": "coderanger", "link": "https://stackoverflow.com/users/78722/coderanger"}, "reply_to_user": {"reputation": 887, "user_id": 8014301, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/8399d118068d5ccd7d47cbd574095b42?s=128&d=identicon&r=PG&f=1", "display_name": "J0991", "link": "https://stackoverflow.com/users/8014301/j0991"}, "edited": false, "score": 0, "creation_date": 1501091678, "post_id": 45332877, "comment_id": 77630466, "body": "No, you write it yourself."}], "tags": [], "owner": {"reputation": 43208, "user_id": 78722, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cf611565f0b79abd0b3dc200ad867661?s=128&d=identicon&r=PG", "display_name": "coderanger", "link": "https://stackoverflow.com/users/78722/coderanger"}, "is_accepted": false, "score": 1, "last_activity_date": 1501087256, "creation_date": 1501087256, "answer_id": 45332877, "question_id": 45331631, "link": "https://stackoverflow.com/questions/45331631/git-cookbook-fails-to-converge-unless-apt-get-update-is-manually-run/45332877#45332877", "title": "git cookbook fails to converge unless apt-get update is manually run", "body": "<p>In Chef you usually have a core recipe somewhere in your system that has an <code>apt_update</code> resource, which does the updating for you. We usually opt to not include this in every single community cookbook both because it increases per-platform bloat and increases the time overhead depending on system settings, generally makes it harder to control. So run this yourself from some base recipe or wrapper cookbook. In Chef 13 all you need is a literal <code>apt_update</code>, in Chef 12 you'll need <code>apt_update 'whatever'</code>. If you're on an early Chef 12 release you can use the <code>apt</code> community cookbook to do the same thing.</p>\n"}], "owner": {"reputation": 887, "user_id": 8014301, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/8399d118068d5ccd7d47cbd574095b42?s=128&d=identicon&r=PG&f=1", "display_name": "J0991", "link": "https://stackoverflow.com/users/8014301/j0991"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 71, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1501089484, "creation_date": 1501083645, "last_edit_date": 1501089484, "question_id": 45331631, "link": "https://stackoverflow.com/questions/45331631/git-cookbook-fails-to-converge-unless-apt-get-update-is-manually-run", "title": "git cookbook fails to converge unless apt-get update is manually run", "body": "<p>I'm currently using the <a href=\"https://supermarket.chef.io/cookbooks/git#readme\" rel=\"nofollow noreferrer\">Chef Supermarket cookbook for Git</a>. I'm also using test-kitchen to test my configuration before configuring an actual node with it.</p>\n\n<p>I have a wrapper cookbook which implements the default.rb recipe of the Git cookbook. When I converge the sandbox machine (Ubuntu 14.04), with my specified recipes (in the kitchen.yml file), I receive an error explaining that:</p>\n\n<pre><code>E: Unable to fetch some archives, maybe run apt-get update or try with --fix-missing\n</code></pre>\n\n<p>If I log into the sandbox instance and manually run an <code>apt-get update</code>, then logout of the instance and re-converge, Git is installed successfully.</p>\n\n<p>How might I fix this issue so that Git is able to be installed without manually logging into the machine being configured and running an <code>apt-get update</code>?</p>\n"}, {"tags": ["mysql", "sql", "ruby", "ruby-on-rails-3", "activerecord"], "comments": [{"owner": {"reputation": 48635, "user_id": 6742, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/xPawo.png?s=128&g=1", "display_name": "David Aldridge", "link": "https://stackoverflow.com/users/6742/david-aldridge"}, "edited": false, "score": 0, "creation_date": 1501082918, "post_id": 45331305, "comment_id": 77624456, "body": "It&#39;s unclear from your SQL which tables the various columns you&#39;re referencing are on."}], "answers": [{"tags": [], "owner": {"reputation": 1670, "user_id": 6388521, "user_type": "registered", "accept_rate": 69, "profile_image": "https://lh4.googleusercontent.com/-VdFWPJVSpRc/AAAAAAAAAAI/AAAAAAAAAFo/vCc8QOz6v9Y/photo.jpg?sz=128", "display_name": "Ruslan", "link": "https://stackoverflow.com/users/6388521/ruslan"}, "is_accepted": false, "score": 0, "last_activity_date": 1501083778, "creation_date": 1501083778, "answer_id": 45331685, "question_id": 45331305, "link": "https://stackoverflow.com/questions/45331305/how-to-query-rails-way-rails-3-2/45331685#45331685", "title": "How to query rails way ? Rails 3.2", "body": "<p>Not the rails way but quick and dirty: </p>\n\n<pre><code>ActiveRecord::Base.execute(\"SELECT fixflow_class_name \nFROM error_scopes s\njoin scope_to_fixflow_maps m on s.id=m.error_scope_id\njoin servers serv on serv.id=s.server_id\nwhere error_codes regexp 'error_scope_test'\nand path = 'x'\nand assettag = 'y'\")\n</code></pre>\n\n<p>Returns back an array of hashes that you can work with</p>\n"}, {"comments": [{"owner": {"reputation": 370, "user_id": 4526617, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3fc0643deb79dffedb7bf9dfdc9d9346?s=128&d=identicon&r=PG&f=1", "display_name": "Kavincat", "link": "https://stackoverflow.com/users/4526617/kavincat"}, "edited": false, "score": 0, "creation_date": 1501102794, "post_id": 45336965, "comment_id": 77636646, "body": "<code>ErrorScope.joins(:server, :scope_to_fixflow_map).where(&quot;error_codes LIKE ?&quot;, &quot;%error_scope_test%&quot;)</code> this works good. when i chain with this <code>.where(&quot;server.assettag=&#39;y&#39;&quot;)</code> gives me error. <code>ActiveRecord::StatementInvalid: Mysql2::Error: Unknown column &#39;server.assettag&#39; in &#39;where clause&#39;:</code>"}, {"owner": {"reputation": 1962, "user_id": 2945616, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/TL0yY.jpg?s=128&g=1", "display_name": "Atul Khanduri", "link": "https://stackoverflow.com/users/2945616/atul-khanduri"}, "reply_to_user": {"reputation": 370, "user_id": 4526617, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3fc0643deb79dffedb7bf9dfdc9d9346?s=128&d=identicon&r=PG&f=1", "display_name": "Kavincat", "link": "https://stackoverflow.com/users/4526617/kavincat"}, "edited": false, "score": 0, "creation_date": 1501132180, "post_id": 45336965, "comment_id": 77645165, "body": "@Kavincat Yeah, should have been <code>servers</code> &amp; <code>scope_to_fixflow_maps</code> instead of <code>server</code> &amp; <code>scope_to_fixflow_map</code> respectively. Updated the answer."}], "tags": [], "owner": {"reputation": 1962, "user_id": 2945616, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/TL0yY.jpg?s=128&g=1", "display_name": "Atul Khanduri", "link": "https://stackoverflow.com/users/2945616/atul-khanduri"}, "is_accepted": true, "score": 1, "last_activity_date": 1501132110, "last_edit_date": 1501132110, "creation_date": 1501101504, "answer_id": 45336965, "question_id": 45331305, "link": "https://stackoverflow.com/questions/45331305/how-to-query-rails-way-rails-3-2/45336965#45336965", "title": "How to query rails way ? Rails 3.2", "body": "<p>Something like this:</p>\n\n<pre><code>ErrorScope.joins(:server, :scope_to_fixflow_map)\n.where(\"error_codes LIKE ?\", \"%error_scope_test%\") \n.where(\"servers.assettag='y'\")\n.where(\"scope_to_fixflow_maps.path='x'\")\n.select(\"scope_to_fixflow_maps.fixflow_class_name\")\n</code></pre>\n"}], "owner": {"reputation": 370, "user_id": 4526617, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3fc0643deb79dffedb7bf9dfdc9d9346?s=128&d=identicon&r=PG&f=1", "display_name": "Kavincat", "link": "https://stackoverflow.com/users/4526617/kavincat"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 48, "favorite_count": 0, "accepted_answer_id": 45336965, "answer_count": 2, "score": 0, "last_activity_date": 1501132110, "creation_date": 1501082728, "last_edit_date": 1501083840, "question_id": 45331305, "link": "https://stackoverflow.com/questions/45331305/how-to-query-rails-way-rails-3-2", "title": "How to query rails way ? Rails 3.2", "body": "<p>List of relationship between models:</p>\n\n<pre><code>class ErrorScope  &lt; ActiveRecord::Base\n  belongs_to :server\n  has_many :scope_to_fixflow_map\n  attr_accessible :id, :server_id, :error_codes, :scoping_method, :priority, :error_codes_is_wildcard_match\n  serialize :error_codes\n  .....\nend\n\nclass ScopeToFixflowMap &lt; ActiveRecord::Base\n  belongs_to :error_scope\n  attr_accessible :id, :server_id, :error_scope_id, :path, :fixflow_class_name\n  ......\nend\n\nclass Server &lt; ActiveRecord::Base\n  has_many :error_scopes \n  ......\nend\n</code></pre>\n\n<p>schema.rb</p>\n\n<pre><code>  create_table \"error_scopes\", :force =&gt; true do |t|\n    t.integer \"server_id\",                     :limit =&gt; 8,                    :null =&gt; false\n    t.text    \"error_codes\",                                                   :null =&gt; false\n    t.text    \"scoping_method\"\n    t.integer \"priority\",                                                      :null =&gt; false\n    t.boolean \"error_codes_is_wildcard_match\",              :default =&gt; false\n  end\n\n  create_table \"scope_to_fixflow_maps\", :force =&gt; true do |t|\n    t.integer \"server_id\",          :limit =&gt; 8, :null =&gt; false\n    t.integer \"error_scope_id\",     :limit =&gt; 8, :null =&gt; false\n    t.string  \"path\"\n    t.string  \"fixflow_class_name\",              :null =&gt; false\n  end\n</code></pre>\n\n<p>Now i have a sql query which gives me desired output:</p>\n\n<pre><code>SELECT fixflow_class_name \nFROM error_scopes s\njoin scope_to_fixflow_maps m on s.id=m.error_scope_id\njoin servers serv on serv.id=s.server_id\nwhere error_codes regexp 'error_scope_test'\nand path = 'x'\nand assettag = 'y'\n</code></pre>\n\n<p>What I tried so far. It works</p>\n\n<pre><code>ErrorScope.where(\"error_codes like ?\", \"%error_scope_test\\n%\").select {|tag| tag.server.assettag == \"y\"}[0].scope_to_fixflow_map.select {|y| y.path == \"x\"}[0].fixflow_class_name\n</code></pre>\n\n<p>using joins</p>\n\n<pre><code>ErrorScope.joins(:server, :scope_to_fixflow_map).where(\"error_codes LIKE ?\", \"%error_scope_test%\").select {|tag| tag.server.assettag == \"y\"}[0].scope_to_fixflow_map.select {|y| y.path == \"x\"}[0].fixflow_class_name\n</code></pre>\n\n<p>I am sure there must be better way to do this query?? </p>\n"}, {"tags": ["ruby-on-rails", "ruby", "activerecord"], "comments": [{"owner": {"reputation": 32131, "user_id": 2346461, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/i3xAf.jpg?s=128&g=1", "display_name": "Pavan", "link": "https://stackoverflow.com/users/2346461/pavan"}, "edited": false, "score": 1, "creation_date": 1501082644, "post_id": 45331200, "comment_id": 77624253, "body": "Try changing it to <code>test_count  = (:all, :joins =&gt; joins, :conditions =&gt; conditions, :distinct =&gt; true).count</code>"}, {"owner": {"reputation": 32451, "user_id": 2516474, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a2179a340c0e84edc285d432211145d?s=128&d=identicon&r=PG", "display_name": "SteveTurczyn", "link": "https://stackoverflow.com/users/2516474/steveturczyn"}, "reply_to_user": {"reputation": 32131, "user_id": 2346461, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/i3xAf.jpg?s=128&g=1", "display_name": "Pavan", "link": "https://stackoverflow.com/users/2346461/pavan"}, "edited": false, "score": 1, "creation_date": 1501083235, "post_id": 45331200, "comment_id": 77624730, "body": "@pavan suggestion is best, and as the error text itself suggests you can add to your gemfile <code>gem &#39;activerecord-deprecated_finders&#39;, require: &#39;active_record&#47;deprecated_finders&#39;</code> and that should also fix the issue."}, {"owner": {"reputation": 93, "user_id": 4062739, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-MoQy2sOGTWc/AAAAAAAAAAI/AAAAAAAAA20/pumIRsaEXCk/photo.jpg?sz=128", "display_name": "harika", "link": "https://stackoverflow.com/users/4062739/harika"}, "reply_to_user": {"reputation": 32131, "user_id": 2346461, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/i3xAf.jpg?s=128&g=1", "display_name": "Pavan", "link": "https://stackoverflow.com/users/2346461/pavan"}, "edited": false, "score": 0, "creation_date": 1501093644, "post_id": 45331200, "comment_id": 77631596, "body": "@pavan Thank you for the response. This solution still fails because this syntax is no longer supported in rails 4."}], "answers": [{"tags": [], "owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "is_accepted": false, "score": 2, "last_activity_date": 1618851678, "last_edit_date": 1618851678, "creation_date": 1501083656, "answer_id": 45331634, "question_id": 45331200, "link": "https://stackoverflow.com/questions/45331200/argumenterror-relationcount-does-not-support-finder-options-anymore-rails-4/45331634#45331634", "title": "ArgumentError: Relation#count does not support finder options anymore. Rails 4", "body": "<p>I think your query translates to this:</p>\n<pre><code>joins(joins).where(conditions).distinct.count\n</code></pre>\n<p>Have a look at the Rails Guide about the <a href=\"http://guides.rubyonrails.org/active_record_querying.html\" rel=\"nofollow noreferrer\">Active Record Query Interface</a>.</p>\n"}], "owner": {"reputation": 93, "user_id": 4062739, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-MoQy2sOGTWc/AAAAAAAAAAI/AAAAAAAAA20/pumIRsaEXCk/photo.jpg?sz=128", "display_name": "harika", "link": "https://stackoverflow.com/users/4062739/harika"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 304, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1618851678, "creation_date": 1501082476, "question_id": 45331200, "link": "https://stackoverflow.com/questions/45331200/argumenterror-relationcount-does-not-support-finder-options-anymore-rails-4", "title": "ArgumentError: Relation#count does not support finder options anymore. Rails 4", "body": "<p>I recently upgraded my project from rails3 to rails4. I have below code in my model and it fails in rails 4     </p>\n\n<pre><code>test_count  = count(:all, :joins =&gt; joins, :conditions =&gt; conditions, :distinct =&gt; true)\n</code></pre>\n\n<p>The above line of code gives following error.</p>\n\n<pre><code>ArgumentError: Relation#count does not support finder options anymore. Please build a scope and then call count on it or use the activerecord-deprecated_finders gem to enable this functionality.\n</code></pre>\n\n<p>Any suggestions on how to resolve this error in rails 4?</p>\n\n<p>Thank you</p>\n"}, {"tags": ["ruby", "rubygems", "rubymine"], "answers": [{"tags": [], "owner": {"reputation": 83, "user_id": 674718, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/H1kub.jpg?s=128&g=1", "display_name": "Kev", "link": "https://stackoverflow.com/users/674718/kev"}, "is_accepted": true, "score": 2, "last_activity_date": 1501140847, "creation_date": 1501140847, "answer_id": 45344201, "question_id": 45331083, "link": "https://stackoverflow.com/questions/45331083/rubymine-debug-not-working/45344201#45344201", "title": "RubyMine debug not working", "body": "<p>OK got this working now.\nI opened the Command Prompt as Administrator and then executed the following\nc:\\gem install ruby-debug-ide\nc:\\gem install debase</p>\n\n<p>This time they both executed with no error.\nI then restarted RubyMine and now I can run in debug mode.\nHappy days....</p>\n"}], "owner": {"reputation": 83, "user_id": 674718, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/H1kub.jpg?s=128&g=1", "display_name": "Kev", "link": "https://stackoverflow.com/users/674718/kev"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2618, "favorite_count": 0, "accepted_answer_id": 45344201, "answer_count": 1, "score": 0, "last_activity_date": 1501140847, "creation_date": 1501082171, "question_id": 45331083, "link": "https://stackoverflow.com/questions/45331083/rubymine-debug-not-working", "title": "RubyMine debug not working", "body": "<p>I cannot get debug mode working in RubyMine. Below is what I did to install it all. This is followed by the error details and my setup\nAny advice please</p>\n\n<p>A Download and Install Ruby</p>\n\n<p>1.Download Ruby 2.2.6 - <a href=\"http://rubyinstaller.org/downloads/\" rel=\"nofollow noreferrer\">http://rubyinstaller.org/downloads/</a></p>\n\n<p>2.Install Ruby 2.2.6 to C:\\Ruby</p>\n\n<p>B Download Ruby Dev kit</p>\n\n<p>3.Return to <a href=\"http://rubyinstaller.org/downloads/\" rel=\"nofollow noreferrer\">http://rubyinstaller.org/downloads/</a></p>\n\n<p>4.Under development click on \"<a href=\"https://dl.bintray.com/oneclick/rubyinstaller/DevKit-mingw64-64-4.7.2-20130224-1432-sfx.exe\" rel=\"nofollow noreferrer\">https://dl.bintray.com/oneclick/rubyinstaller/DevKit-mingw64-64-4.7.2-20130224-1432-sfx.exe</a>\"</p>\n\n<p>5.Create Folder C:\\Ruby\\DevKit</p>\n\n<p>6.Unzip \"DevKit-mingw64-64-4.7.2-20130224-1432-sfx.exe\" into C:\\Ruby\\DevKit</p>\n\n<p>8.Go to folder C:\\Ruby\\DevKit , Now press Shift then right click \"Open command window here\"</p>\n\n<p>9.Type \"ruby dk.rb init\" in command prompt and hit enter (c:\\DevKit>ruby dk.rb init)</p>\n\n<p>10.Type \"ruby dk.rb install\" in command prompt and hit enter (c:\\DevKit>ruby dk.rb install)</p>\n\n<p>C Install RubyGems</p>\n\n<p>11.Open command prompt and type the following commands and hit enter every time\nc:\\gem install bundler</p>\n\n<p>Then navigate to your project folder where the Gemfile located and run command 'bundle install'</p>\n\n<p>D Download and Install Ruby Mine</p>\n\n<p>13.Open <a href=\"http://www.jetbrains.com/ruby/download/\" rel=\"nofollow noreferrer\">http://www.jetbrains.com/ruby/download/</a></p>\n\n<p>14.Click on 30 days Trial \"Download Now\"</p>\n\n<p>15.Now Install Ruby Mine</p>\n\n<p>From this point I can load projects and run projects but when I try to debug the \nsame project I get issues.</p>\n\n<p>The message is <em>Test framework quit unexpectedly</em></p>\n\n<pre><code>C:\\Ruby\\bin\\ruby.exe -EUTF-8 -e $stdout.sync=true;$stderr.sync=true;load($0=ARGV.shift) C:/Ruby/lib/ruby/gems/2.2.0/gems/ruby-debug-ide-0.6.0/bin/rdebug-ide --disable-int-handler --evaluation-timeout 10 --rubymine-protocol-extensions --port 62718 --host 0.0.0.0 --dispatcher-port 62719 -- C:\\Ruby\\bin/cucumber C:/git/wiggle-automation/features/checkout.feature --format Teamcity::Cucumber::Formatter --expand --color -r features\nTesting started at 15:58 ...\nC:/Ruby/lib/ruby/2.2.0/rubygems/core_ext/kernel_require.rb:54:in `require': cannot load such file -- debase_internals (LoadError)\n    from C:/Ruby/lib/ruby/2.2.0/rubygems/core_ext/kernel_require.rb:54:in `require'\n    from C:/Ruby/lib/ruby/gems/2.2.0/gems/debase-0.2.2.beta10/lib/debase.rb:4:in `&lt;top (required)&gt;'\n    from C:/Ruby/lib/ruby/2.2.0/rubygems/core_ext/kernel_require.rb:54:in `require'\n    from C:/Ruby/lib/ruby/2.2.0/rubygems/core_ext/kernel_require.rb:54:in `require'\n    from C:/Ruby/lib/ruby/gems/2.2.0/gems/ruby-debug-ide-0.6.0/lib/ruby-debug-ide.rb:8:in `&lt;top (required)&gt;'\n    from C:/Ruby/lib/ruby/gems/2.2.0/gems/ruby-debug-ide-0.6.0/bin/rdebug-ide:8:in `require_relative'\n    from C:/Ruby/lib/ruby/gems/2.2.0/gems/ruby-debug-ide-0.6.0/bin/rdebug-ide:8:in `&lt;top (required)&gt;'\n    from -e:1:in `load'\n    from -e:1:in `&lt;main&gt;'\n\nProcess finished with exit code 1\n</code></pre>\n\n<p>So with this in mind I try to install debase \u2013 gem install debase\nAnd I get this</p>\n\n<pre><code>Building native extensions.  This could take a while...\nThe system cannot find the path specified.\nERROR:  Error installing debase:\n        ERROR: Failed to build gem native extension.\nC:/Ruby/bin/ruby.exe -r ./siteconf20170726-16784-15t9wif.rb extconf.rb\nchecking for vm_core.h... no\nchecking for vm_core.h... no\nchecking for vm_core.h... yes\ncreating Makefile\nextconf failed, exit code 1\nGem files will remain installed in C:/Ruby/lib/ruby/gems/2.2.0/gems/debase-0.2.1 for inspection.\nResults logged to C:/Ruby/lib/ruby/gems/2.2.0/extensions/x64-mingw32/2.2.0/debase-0.2.1/gem_make.out\n</code></pre>\n\n<p>So I look at the gem_make.out file as above and I see this</p>\n\n<pre><code>C:/Ruby/bin/ruby.exe -r ./siteconf20170726-21048-1y9auxw.rb extconf.rb\nchecking for vm_core.h... no\nchecking for vm_core.h... no\nchecking for vm_core.h... yes\ncreating Makefile\nextconf failed, exit code 1\n</code></pre>\n\n<p>Can anyone explain what is happening please.</p>\n\n<p>I am using Windows 7 and Ruby 2.2.6p396</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 32131, "user_id": 2346461, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/i3xAf.jpg?s=128&g=1", "display_name": "Pavan", "link": "https://stackoverflow.com/users/2346461/pavan"}, "edited": false, "score": 0, "creation_date": 1501082317, "post_id": 45331050, "comment_id": 77623976, "body": "What is the value of <code>url</code> in the <code>form</code>?"}, {"owner": {"reputation": 740, "user_id": 2467454, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/784d4fa00e161595564f95894f047042?s=128&d=identicon&r=PG", "display_name": "Jimmy Shaw", "link": "https://stackoverflow.com/users/2467454/jimmy-shaw"}, "reply_to_user": {"reputation": 32131, "user_id": 2346461, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/i3xAf.jpg?s=128&g=1", "display_name": "Pavan", "link": "https://stackoverflow.com/users/2346461/pavan"}, "edited": false, "score": 0, "creation_date": 1501083054, "post_id": 45331050, "comment_id": 77624580, "body": "I&#39;m assuming it&#39;s <code>clone_create_admin_data_provider_location_index_path</code> which is passed into the partial from clone.html.erb. Here&#39;s the thing tough, no matter how I modify <code>url</code> in <code>form</code>, it&#39;s still posting to update. I&#39;ve tried to replace it with <code>:clone_create</code>, <code>{action: &#39;clone_create&#39;}</code>, <code>{controller: &#39;location&#39;, action: &#39;clone_create&#39;}</code>, <code>{:action =&gt; :clone_create}</code>..... etc. Every combination of <code>clone_create</code> or <code>create</code>. Nothing matters as the form still defaults to update."}], "answers": [{"tags": [], "owner": {"reputation": 32451, "user_id": 2516474, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a2179a340c0e84edc285d432211145d?s=128&d=identicon&r=PG", "display_name": "SteveTurczyn", "link": "https://stackoverflow.com/users/2516474/steveturczyn"}, "is_accepted": true, "score": 1, "last_activity_date": 1501083532, "creation_date": 1501083532, "answer_id": 45331589, "question_id": 45331050, "link": "https://stackoverflow.com/questions/45331050/why-form-submit-keep-defaulting-to-a-particular-post-action/45331589#45331589", "title": "Why form submit keep defaulting to a particular POST action?", "body": "<p>I don't see that you need a specific clone_create method.</p>\n\n<pre><code>def clone\n  @location = Location.find(params[:id]).dup\n  render :new\nend\n</code></pre>\n\n<p>Then you have (effectively) a new record which happens to have the same values as the old record, and can be processed by the standard <code>create</code> method.</p>\n\n<p>Note that as long as you're showing an existing record, submit will always take you to the update action.</p>\n"}], "owner": {"reputation": 740, "user_id": 2467454, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/784d4fa00e161595564f95894f047042?s=128&d=identicon&r=PG", "display_name": "Jimmy Shaw", "link": "https://stackoverflow.com/users/2467454/jimmy-shaw"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 38, "favorite_count": 0, "accepted_answer_id": 45331589, "answer_count": 1, "score": 0, "last_activity_date": 1501083532, "creation_date": 1501082107, "question_id": 45331050, "link": "https://stackoverflow.com/questions/45331050/why-form-submit-keep-defaulting-to-a-particular-post-action", "title": "Why form submit keep defaulting to a particular POST action?", "body": "<p>Imagine a typical Rails 4.2 application with a resource called location. Within the LocationsController, we have the usual actions. </p>\n\n<p>The new view and the edit view both utilize a shared partial called _location_form.html.erb. I want to recycle that same partial view for two additional custom actions, clone and clone_create. The clone (GET) action has the same code body as the edit action. The clone_create (POST) action has the same code body as the create action.</p>\n\n<p>The ultimate goal is to add a 'Clone' button on show.html.erb, which leads to clone.html.erb that has a particular location's data already pre-populated on the shared partial. The user modifies the form field values accordingly, clicks submit and the clone_create action is triggered saving that location to the database. Essentially, \"cloning\" is akin to editing a location then creating a new location upon form submit.</p>\n\n<pre><code># new.html.erb\n&lt;h1&gt;New Location&lt;/h1&gt;\n&lt;%= render :partial =&gt; 'admin/shared/location_form', :locals =&gt; { :url =&gt; admin_data_provider_location_index_path } %&gt;\n\n# edit.html.erb\n&lt;h1&gt;Edit Location&lt;/h1&gt;\n&lt;%= render :partial =&gt; 'admin/shared/location_form', :locals =&gt; { :url =&gt; admin_data_provider_location_path(@location) } %&gt;\n\n# clone.html.erb\n&lt;h1&gt;Clone Location&lt;/h1&gt;\n&lt;%= render :partial =&gt; 'admin/shared/location_form', :locals =&gt; { :url =&gt; clone_create_admin_data_provider_location_index_path } %&gt;\n\n# _location_form.html.erb\n&lt;%= simple_form_for [:admin, @location], :url =&gt; url, :html =&gt; { :multipart =&gt; true } do |f| %&gt;\n    .................\n    &lt;%= f.submit nil, :class =&gt; 'btn' %&gt;\n&lt;% end %&gt;\n\n\n# locations_controller.rb\nclass Admin::DataProvider::LocationsController &lt; AdminController\n    ................\n    def new\n        @location = Location.new\n        ...........\n    end\n\n    def create\n        # Creates a location and saves it to the database.\n        ...........\n        render :new\n    end\n\n    def edit\n        @location = Location.find(params[:id])\n        ...........\n    end\n\n    def update\n        @location = Location.find(params[:id])\n        # Saves edited location field values back to same location in the database.\n        ...........\n        render :edit\n    end\n\n    def clone\n        # Same code body as edit.\n    end\n\n    def clone_create\n        # Same code body as create.\n    end\n    ..................\nend\n\n\n# routes.rb\nnamespace :admin do\n    ..........\n    namespace :data_provider do\n        resources :location, :controller =&gt; :locations, :exception =&gt; [:destroy] do\n            get 'clone', :on =&gt; member\n            post 'clone_create', :on =&gt; :collection\n            .............\n\n\n# rake routes | grep location\nclone_admin_data_provider_location GET /admin/data_provider/location/:id/clone(.:format) admin/data_provider/locations#clone\n\nclone_create_admin_data_provider_location_index POST /admin/data_provider/location/clone_create(.:format) admin/data_provider/locations#clone_create\n\nedit_admin_data_provider_location GET /admin/data_provider/location/:id/edit(.:format) admin/data_provider/locations#edit\n\nadmin_data_provider_location PATCH PUT /admin/data_provider/location/:id(.:format) admin/data_provider/locations#update\n\nnew_admin_data_provider_location GET /admin/data_provider/location/new(.:format) admin/data_provider/locations#new\n\nadmin_data_provider_location_index POST /admin/data_provider/location(.:format) admin/data_provider/locations#create\n</code></pre>\n\n<p>The clone action behaves fine. For example, hitting the url /location/123/clone brings up the shared partial form filled with data exactly like hitting /location/123/edit. Great.</p>\n\n<p>The issue comes when the clone form is submitted. The form POST request absolutely refuses to execute the clone_create action. The form posts to update every single time, no matter how I modify clone.html.erb or </p>\n\n<pre><code>&lt;%= simple_form_for [:admin, @location], :url =&gt; url, :html =&gt; { :multipart =&gt; true } do |f| %&gt;\n</code></pre>\n\n<p>This is some high level Rails magic happening here where Rails FORCES posting to a specific action regardless of what the developer code wants. </p>\n\n<p>1) Why does the clone form keep posting to update when I obviously want it to post to clone_create?</p>\n\n<p>2) How do I update the current code or what additional code do I have to write to ensure the clone form posts to clone_create?</p>\n\n<p>Any reference links or resources to better help with my understanding would be helpful. Thanks.</p>\n"}, {"tags": ["ruby", "pdf", "match", "ocr", "partial"], "comments": [{"owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 2, "creation_date": 1501081901, "post_id": 45330716, "comment_id": 77623638, "body": "Perhaps the <a href=\"https://en.wikipedia.org/wiki/Levenshtein_distance\" rel=\"nofollow noreferrer\">Levenshtein Distance</a> might be useful in this context. There are some implementations of this algorithm on <a href=\"https://rubygems.org/search?query=Levenshtein\" rel=\"nofollow noreferrer\">Rubygems</a>."}], "answers": [{"tags": [], "owner": {"reputation": 393, "user_id": 2653671, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a5f7af7f0f845e4effa9c4a5ef8b47f?s=128&d=identicon&r=PG", "display_name": "rodsoars", "link": "https://stackoverflow.com/users/2653671/rodsoars"}, "is_accepted": false, "score": 0, "last_activity_date": 1501095273, "last_edit_date": 1501095273, "creation_date": 1501094629, "answer_id": 45335093, "question_id": 45330716, "link": "https://stackoverflow.com/questions/45330716/ruby-search-file-for-a-similar-word/45335093#45335093", "title": "Ruby - search file for a similar word", "body": "<p>Take a look at the gem Amatch, found <a href=\"https://github.com/flori/amatch\" rel=\"nofollow noreferrer\">here</a>. This gem implements several distance algorithms. Also, read this other <a href=\"https://stackoverflow.com/questions/25540581/difference-between-jaro-winkler-and-levenshtein-distance\">answer</a> about the difference between Levenshtein and Jaro distance algorithms and check which one is more suitable for you.</p>\n\n<p>TL;DR, here is a small snippet to help you get started in solving your problem, using the Amatch gem.</p>\n\n<pre><code>'subscription'.levenshtein_similar('SUBSCR|P||ON') #=&gt; 0.0\n'SUBSCRIPTION'.levenshtein_similar('SUBSCR|P||ON') #=&gt; 0.75\n'subscription'.jaro_similar('SUBSCR|P||ON')        #=&gt; 0.83\n'SUBSCRIPTION'.jaro_similar('SUBSCR|P||ON')        #=&gt; 0.83\n'subscription'.jarowinkler_similar('SUBSCR|P||ON') #=&gt; 0.9\n'SUBSCRIPTION'.jarowinkler_similar('SUBSCR|P||ON') #=&gt; 0.9\n</code></pre>\n\n<p>If you want to evaluate if a given text has any occurrences of a word, try this:</p>\n\n<pre><code>def occurs?(text, target_word)\n  text_words = text.split(' ') # Splits the text into an array of words.\n  text_words.each do |word|\n    return true if word.jaro_similar(target_word) &gt; 0.8\n  end\n  false\nend\n\nexample_text = 'This text has the word SUBSCR|P||ON malformed.'\nother_text = 'This text does not.'\n\noccurs?(example_text, 'SUBSCRIPTION') #=&gt; true\noccurs?(other_text, 'SUBSCRIPTION')   #=&gt; false\n</code></pre>\n\n<p>Notice that you can call method <code>#downcase</code> to the text words too, if you prefer. And you have to parse the text content of your original file first. Hope this helps!</p>\n"}], "owner": {"reputation": 1, "user_id": 7793146, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-LLKjrMfDusw/AAAAAAAAAAI/AAAAAAAAAFw/MJRBMrTj-AI/photo.jpg?sz=128", "display_name": "Sean", "link": "https://stackoverflow.com/users/7793146/sean"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 64, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1501095273, "creation_date": 1501081242, "question_id": 45330716, "link": "https://stackoverflow.com/questions/45330716/ruby-search-file-for-a-similar-word", "title": "Ruby - search file for a similar word", "body": "<p>I have OCR scanned a large number of documents and need to identify a keyword within the scanned files. The problem is, because the OCR is not dependable - for example the word \"SUBSCRIPTION\" may end up being \"SUBSCR|P||ON\" - I will need to search for a <em>near match</em> rather than a full match. </p>\n\n<p>Does anyone know how I can search a file for the word \"SUBSCRIPTION\" and return true if an 80% match is found?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "devise", "rubygems"], "comments": [{"owner": {"reputation": 45, "user_id": 8302656, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/022a1a4800001e80af6b772534f6b0a8?s=128&d=identicon&r=PG&f=1", "display_name": "QandA", "link": "https://stackoverflow.com/users/8302656/qanda"}, "edited": false, "score": 0, "creation_date": 1501081090, "post_id": 45330630, "comment_id": 77622892, "body": "The other gems are fine it is just the devise gem that needs work."}], "answers": [{"comments": [{"owner": {"reputation": 45, "user_id": 8302656, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/022a1a4800001e80af6b772534f6b0a8?s=128&d=identicon&r=PG&f=1", "display_name": "QandA", "link": "https://stackoverflow.com/users/8302656/qanda"}, "edited": false, "score": 0, "creation_date": 1501082075, "post_id": 45330830, "comment_id": 77623779, "body": "Do I have to do that for every version or is there a command that will just get rid of all the old ones except for the most recent version?"}], "tags": [], "owner": {"reputation": 5519, "user_id": 938947, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f611b152b4fa9fe2a05f4ee9b84fdcb7?s=128&d=identicon&r=PG", "display_name": "widjajayd", "link": "https://stackoverflow.com/users/938947/widjajayd"}, "is_accepted": true, "score": 0, "last_activity_date": 1501082227, "last_edit_date": 1501082227, "creation_date": 1501081507, "answer_id": 45330830, "question_id": 45330630, "link": "https://stackoverflow.com/questions/45330630/getting-rid-of-outdated-versions-of-ruby-gems-and-keep-current-versions/45330830#45330830", "title": "Getting rid of outdated versions of Ruby gems and keep current versions", "body": "<p>here is sample to remove specific version of gem</p>\n\n<pre><code>gem uninstall devise --version 4.2.1\n# uninstall older version\ngem uninstall devise --version '&lt;4.3.0'\n</code></pre>\n"}], "owner": {"reputation": 45, "user_id": 8302656, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/022a1a4800001e80af6b772534f6b0a8?s=128&d=identicon&r=PG&f=1", "display_name": "QandA", "link": "https://stackoverflow.com/users/8302656/qanda"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 32, "favorite_count": 0, "accepted_answer_id": 45330830, "answer_count": 1, "score": 0, "last_activity_date": 1501082227, "creation_date": 1501081027, "question_id": 45330630, "link": "https://stackoverflow.com/questions/45330630/getting-rid-of-outdated-versions-of-ruby-gems-and-keep-current-versions", "title": "Getting rid of outdated versions of Ruby gems and keep current versions", "body": "<p>For the <code>devise</code> gem I have multiple different versions and want to get rid of them, but I also want to keep the current version of <code>devise</code> and not have to reinstall it.</p>\n\n<pre><code>$ gem list\n\n*** LOCAL GEMS ***\n\nbigdecimal (1.2.0)\ndevise (4.3.0, 4.2.1, 4.2.0, 3.5.10)\ndrip (0.0.2)\nio-console (0.4.2)\njson (1.7.7)\nminitest (4.3.2)\npsych (2.0.0)\nrake (0.9.6)\nrbtree (0.4.1)\nrdoc (4.0.0)\ntest-unit (2.0.0.0)\n</code></pre>\n\n<p>how can I go about doing it without messing things up?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "heroku", "server", "subdomain"], "answers": [{"tags": [], "owner": {"reputation": 13585, "user_id": 693349, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/b030858982f80cfd886667ec36074da4?s=128&d=identicon&r=PG", "display_name": "Matt Gibson", "link": "https://stackoverflow.com/users/693349/matt-gibson"}, "is_accepted": false, "score": 1, "last_activity_date": 1501080900, "creation_date": 1501080900, "answer_id": 45330577, "question_id": 45330424, "link": "https://stackoverflow.com/questions/45330424/heroku-rails-failed-to-load-resource-the-server-responded-with-a-status-of/45330577#45330577", "title": "Heroku | Rails | Failed to load resource: the server responded with a status of 500 (Internal Server Error)", "body": "<p>Add a logging add-on such as PaperTrail (free) and then see what the logs say. If you've done that and it's empty, then go to the app's dashboard, go to the activity tab, then find the latest deployment and click the 'log' button. You should see the error message in there.</p>\n"}, {"tags": [], "owner": {"reputation": 1418, "user_id": 493674, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/134075878cc4e13e36a6099c277381a5?s=128&d=identicon&r=PG", "display_name": "Vijay Agrawal", "link": "https://stackoverflow.com/users/493674/vijay-agrawal"}, "is_accepted": false, "score": 2, "last_activity_date": 1501081273, "creation_date": 1501081273, "answer_id": 45330727, "question_id": 45330424, "link": "https://stackoverflow.com/questions/45330424/heroku-rails-failed-to-load-resource-the-server-responded-with-a-status-of/45330727#45330727", "title": "Heroku | Rails | Failed to load resource: the server responded with a status of 500 (Internal Server Error)", "body": "<p>On your local, when you refresh the page in browser there should be some exception shown in the console where you started <code>rails s....</code></p>\n\n<p>The error would point you towards the issue on local. Maybe you don't have production db setup on local. </p>\n\n<p>Similary, do this to tail log on heroku to see error when you refresh heroku url in browser:</p>\n\n<pre><code>heroku logs --tail\n</code></pre>\n\n<p>More details: <a href=\"https://devcenter.heroku.com/articles/logging\" rel=\"nofollow noreferrer\">https://devcenter.heroku.com/articles/logging</a></p>\n"}, {"tags": [], "owner": {"reputation": 35, "user_id": 8190515, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh5.googleusercontent.com/-bW8hqwAwTmk/AAAAAAAAAAI/AAAAAAAAAK8/ISRJZV_CSuQ/photo.jpg?sz=128", "display_name": "adnan hajar", "link": "https://stackoverflow.com/users/8190515/adnan-hajar"}, "is_accepted": false, "score": 0, "last_activity_date": 1501081922, "creation_date": 1501081922, "answer_id": 45330983, "question_id": 45330424, "link": "https://stackoverflow.com/questions/45330424/heroku-rails-failed-to-load-resource-the-server-responded-with-a-status-of/45330983#45330983", "title": "Heroku | Rails | Failed to load resource: the server responded with a status of 500 (Internal Server Error)", "body": "<p>[Solved] problem solved by LMo answear in this post</p>\n\n<p>steps :</p>\n\n<p>heroku run rake db:migrate\nAnd add the following gem to your gem file</p>\n\n<p>gem 'rails_12factor'\nThanks for help</p>\n"}], "owner": {"reputation": 35, "user_id": 8190515, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh5.googleusercontent.com/-bW8hqwAwTmk/AAAAAAAAAAI/AAAAAAAAAK8/ISRJZV_CSuQ/photo.jpg?sz=128", "display_name": "adnan hajar", "link": "https://stackoverflow.com/users/8190515/adnan-hajar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1549, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1501081922, "creation_date": 1501080529, "last_edit_date": 1501081859, "question_id": 45330424, "link": "https://stackoverflow.com/questions/45330424/heroku-rails-failed-to-load-resource-the-server-responded-with-a-status-of", "title": "Heroku | Rails | Failed to load resource: the server responded with a status of 500 (Internal Server Error)", "body": "<p>So I was trying to deploying my application to heroku, It built correctly but when I tried to access it. \nIt responds with:\nWe're sorry, but something went wrong.\nIf you are the application owner check the logs for more information.</p>\n\n<p>So I checked the Logs and the logs were empty...</p>\n\n<p>So I tried replicating the same command that heroku uses to run my application:  </p>\n\n<blockquote>\n  <p>rails s -p 41616 -b lvh.me -e production</p>\n</blockquote>\n\n<p>and so it boots on my computer, you can check how the server load <a href=\"https://i.stack.imgur.com/rmMae.png\" rel=\"nofollow noreferrer\">here</a></p>\n\n<p>but I still got the same error, <a href=\"https://i.stack.imgur.com/2t1nt.png\" rel=\"nofollow noreferrer\">here</a>\nthe error code that I receive is: </p>\n\n<blockquote>\n  <p>Failed to load resource: the server responded with a status of 500 (Internal Server Error)</p>\n</blockquote>\n\n<p>Now earlier version of this software was deployable to heroku and worked great. The major change in this push was I added subdomains to my heroku application. Don't know if that caused it</p>\n\n<p>Any idea what might be the reason?</p>\n\n<p>[Solved]  problem solved by LMo answear in this <a href=\"https://stackoverflow.com/questions/19410811/how-do-you-diagnose-a-500-error-on-heroku-when-there-is-no-error-message-in-the\">post</a>   </p>\n\n<p>steps :  </p>\n\n<blockquote>\n  <p>heroku run rake db:migrate</p>\n</blockquote>\n\n<p>And add the following gem to your gem file</p>\n\n<pre><code> gem 'rails_12factor'\n</code></pre>\n\n<p>Thanks for help </p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-4", "ruby-on-rails-3.2", "ruby-on-rails-5"], "answers": [{"comments": [{"owner": {"reputation": 2216, "user_id": 7165275, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d8ad41f944f38348a30791dc7f7d02c?s=128&d=identicon&r=PG&f=1", "display_name": "m. simon borg", "link": "https://stackoverflow.com/users/7165275/m-simon-borg"}, "reply_to_user": {"reputation": 5, "user_id": 7979002, "user_type": "registered", "accept_rate": 20, "profile_image": "https://i.stack.imgur.com/3abNP.jpg?s=128&g=1", "display_name": "raja", "link": "https://stackoverflow.com/users/7979002/raja"}, "edited": false, "score": 1, "creation_date": 1501086266, "post_id": 45330428, "comment_id": 77627010, "body": "@raja it should be the accepted answer, much more informative. As a side note, your <code>list</code> action duplicates your <code>index</code> action. it&#39;s generally not a good idea to override the REST conventions encouraged by Rails unless you have a good reason to do so, and duplication is never a good thing either. However if you really need a <code>&#47;blogs&#47;list</code> route you can just send it to your <code>index</code> action with <code>get :list, as: :list, to: &#39;blogs#index&#39;</code>"}], "tags": [], "owner": {"reputation": 3521, "user_id": 2521680, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/6D935.jpg?s=128&g=1", "display_name": "Rockwell Rice", "link": "https://stackoverflow.com/users/2521680/rockwell-rice"}, "is_accepted": true, "score": 3, "last_activity_date": 1501081852, "last_edit_date": 1501081852, "creation_date": 1501080544, "answer_id": 45330428, "question_id": 45330354, "link": "https://stackoverflow.com/questions/45330354/error-when-creating-new-action-to-scaffold-created-controller-in-rails/45330428#45330428", "title": "Error when creating new action to scaffold created controller in rails", "body": "<p>By including the <code>:list</code> method in your <code>set_blog</code> before action you are forcing it to look for specific blog using the id as a param, but what you want is actually what you have in the list method, which is pulling in all blogs.</p>\n\n<p>So this</p>\n\n<pre><code> def set_blog\n  @blog = Blog.find(params[:id])\n end\n</code></pre>\n\n<p>is overriding this</p>\n\n<pre><code>def list\n  @blogs = Blog.all\nend\n</code></pre>\n\n<p>To fix change this</p>\n\n<pre><code>before_action :set_blog, only: [:show, :edit, :update, :destroy, :list]\n</code></pre>\n\n<p>to this by removing the <code>:list</code> method from the set blog before action</p>\n\n<pre><code>before_action :set_blog, only: [:show, :edit, :update, :destroy]\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 32131, "user_id": 2346461, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/i3xAf.jpg?s=128&g=1", "display_name": "Pavan", "link": "https://stackoverflow.com/users/2346461/pavan"}, "edited": false, "score": 0, "creation_date": 1501082001, "post_id": 45330812, "comment_id": 77623719, "body": "What is the difference between this answer and Rockwell Rice&#39;s answer?"}, {"owner": {"reputation": 97, "user_id": 1498359, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/9b70f2588eb18bf971a85d0bac0a7a38?s=128&d=identicon&r=PG", "display_name": "Vivek S", "link": "https://stackoverflow.com/users/1498359/vivek-s"}, "reply_to_user": {"reputation": 32131, "user_id": 2346461, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/i3xAf.jpg?s=128&g=1", "display_name": "Pavan", "link": "https://stackoverflow.com/users/2346461/pavan"}, "edited": false, "score": 0, "creation_date": 1501095661, "post_id": 45330812, "comment_id": 77632686, "body": "@raja well Rockwell&#39;s is descriptive. That should be the accepted one. (y)"}], "tags": [], "owner": {"reputation": 97, "user_id": 1498359, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/9b70f2588eb18bf971a85d0bac0a7a38?s=128&d=identicon&r=PG", "display_name": "Vivek S", "link": "https://stackoverflow.com/users/1498359/vivek-s"}, "is_accepted": false, "score": 0, "last_activity_date": 1501081475, "creation_date": 1501081475, "answer_id": 45330812, "question_id": 45330354, "link": "https://stackoverflow.com/questions/45330354/error-when-creating-new-action-to-scaffold-created-controller-in-rails/45330812#45330812", "title": "Error when creating new action to scaffold created controller in rails", "body": "<p>Remove </p>\n\n<blockquote>\n  <p>:list</p>\n</blockquote>\n\n<p>from before_action </p>\n\n<blockquote>\n  <p>:set_blog</p>\n</blockquote>\n"}], "owner": {"reputation": 5, "user_id": 7979002, "user_type": "registered", "accept_rate": 20, "profile_image": "https://i.stack.imgur.com/3abNP.jpg?s=128&g=1", "display_name": "raja", "link": "https://stackoverflow.com/users/7979002/raja"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 301, "favorite_count": 0, "accepted_answer_id": 45330428, "answer_count": 2, "score": 0, "last_activity_date": 1501081852, "creation_date": 1501080374, "question_id": 45330354, "link": "https://stackoverflow.com/questions/45330354/error-when-creating-new-action-to-scaffold-created-controller-in-rails", "title": "Error when creating new action to scaffold created controller in rails", "body": "<p>I am trying to create a new action list in my previously created Blog using scaffold. I am getting an error in </p>\n\n<blockquote>\n  <p>Couldn't find Blog with 'id'=</p>\n</blockquote>\n\n<p>on controllers/blogs_controller.rb</p>\n\n<p>Here is my controller code.</p>\n\n<pre><code>class BlogsController &lt; ApplicationController\nbefore_action :authenticate_user!, :except =&gt; [:index, :show]\nlayout 'admin', only:[:new, :create, :update, :destroy, :edit, :list]\nbefore_action :set_blog, only: [:show, :edit, :update, :destroy, \n:list]\n\n# GET /blogs\n# GET /blogs.json\ndef index\n @blogs = Blog.all\nend\n\n# GET /blogs/1\n# GET /blogs/1.json\ndef show\nend\n\ndef list\n @blogs = Blog.all\nend\n\n# GET /blogs/new\ndef new\n @blog = Blog.new\nend\n\n# GET /blogs/1/edit\ndef edit\nend\n\n# POST /blogs\n# POST /blogs.json\ndef create\n @blog = Blog.new(blog_params)\n\n respond_to do |format|\n  if @blog.save\n    format.html { redirect_to @blog, notice: 'Blog was successfully          \n  created.' }\n    format.json { render :show, status: :created, location: @blog }\n  else\n    format.html { render :new }\n    format.json { render json: @blog.errors, status: :unprocessable_entity }\n  end\nend\nend\n\n# PATCH/PUT /blogs/1\n# PATCH/PUT /blogs/1.json\ndef update\n respond_to do |format|\n  if @blog.update(blog_params)\n    format.html { redirect_to @blog, notice: 'Blog was successfully updated.' }\n    format.json { render :show, status: :ok, location: @blog }\n  else\n    format.html { render :edit }\n    format.json { render json: @blog.errors, status: :unprocessable_entity }\n  end\nend\nend\n\n# DELETE /blogs/1\n# DELETE /blogs/1.json\ndef destroy\n@blog.destroy\nrespond_to do |format|\n  format.html { redirect_to blogs_url, notice: 'Blog was successfully destroyed.' }\n  format.json { head :no_content }\nend\nend\n\nprivate\n # Use callbacks to share common setup or constraints between actions.\n def set_blog\n  @blog = Blog.find(params[:id])\n end\n\n # Never trust parameters from the scary internet, only allow the white list through.\ndef blog_params\n  params.require(:blog).permit(:title, :description)\nend\n</code></pre>\n\n<p>end</p>\n\n<p>and my routes.rb is</p>\n\n<pre><code>Rails.application.routes.draw do\n\nresources :blogs do\n collection do\n    get :list, :as =&gt; 'list'\n end\nend\n root to: 'home#index'\nend\n</code></pre>\n\n<p>Now, in my new controller view called list.html.erb, I need to see all the blog post apart from the normal show action.</p>\n\n<p>In my list.html.erb</p>\n\n<pre><code>&lt;td&gt;&lt;%= link_to blog.title %&gt;&lt;/td&gt;\n</code></pre>\n\n<p>The error is showing me in set_blog</p>\n\n<pre><code>private\n # Use callbacks to share common setup or constraints between actions.\n def set_blog\n   @blog = Blog.find(params[:id])\n end\n</code></pre>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 7292, "user_id": 1276128, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/Jat1U.jpg?s=128&g=1", "display_name": "Marko Gresak", "link": "https://stackoverflow.com/users/1276128/marko-gresak"}, "edited": false, "score": 2, "creation_date": 1501079805, "post_id": 45330033, "comment_id": 77621848, "body": "What exactly are you trying to solve? How are these numbers represented?   If you can represent the input as an array, you could use something like <code>[1,2,3].reduce(0, :+)</code>."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 1, "creation_date": 1501080304, "post_id": 45330033, "comment_id": 77622257, "body": "I&#39;m with Marko here. If you&#39;re learning Ruby then you should learn how Ruby approaches problems like this, not invent some kind of anti-Ruby method that you prefer from a style perspective."}, {"owner": {"reputation": 33085, "user_id": 2423164, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/Nxbnp.jpg?s=128&g=1", "display_name": "ndnenkov", "link": "https://stackoverflow.com/users/2423164/ndnenkov"}, "edited": false, "score": 0, "creation_date": 1501081825, "post_id": 45330033, "comment_id": 77623567, "body": "Your <code>add(1)</code> doesn&#39;t return <code>1</code>, but a proc object."}, {"owner": {"reputation": 48635, "user_id": 6742, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/xPawo.png?s=128&g=1", "display_name": "David Aldridge", "link": "https://stackoverflow.com/users/6742/david-aldridge"}, "edited": false, "score": 0, "creation_date": 1501083130, "post_id": 45330033, "comment_id": 77624643, "body": "This looks a bit like the Builder pattern, in which a series of method calls can be chained together. The trick of it is that the method calls should do whatever they need to do, then return <code>self</code>. This means the next method in the chain is sent to the correct class."}], "answers": [{"comments": [{"owner": {"reputation": 48049, "user_id": 6419007, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/CwqtX.jpg?s=128&g=1", "display_name": "Eric Duminil", "link": "https://stackoverflow.com/users/6419007/eric-duminil"}, "edited": false, "score": 0, "creation_date": 1501083567, "post_id": 45330839, "comment_id": 77625002, "body": "<code>You can&#39;t quite do what you are trying to do.</code> [citation needed]"}], "tags": [], "owner": {"reputation": 33085, "user_id": 2423164, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/Nxbnp.jpg?s=128&g=1", "display_name": "ndnenkov", "link": "https://stackoverflow.com/users/2423164/ndnenkov"}, "is_accepted": false, "score": 2, "last_activity_date": 1501082119, "last_edit_date": 1501082119, "creation_date": 1501081531, "answer_id": 45330839, "question_id": 45330033, "link": "https://stackoverflow.com/questions/45330033/adding-numbers-in-succession/45330839#45330839", "title": "Adding numbers in succession", "body": "<p>You can't quite do what you are trying to do. The reason is that you have to return something and that something can't change based on whether you are going to continue the chain or not.</p>\n\n<p>Note that some Rails objects give you the illusion that you can in the REPL (irb, pry), but they actually just redefine <code>#inspect</code>, which is called upon visualisation by said REPL.</p>\n\n<hr>\n\n<p>Instead you can do something very similar, which has an even better interface IMO:</p>\n\n<pre><code>def add(starting_number)\n  sum = starting_number\n\n  accumulator = proc do |next_number|\n    if next_number\n      sum += next_number\n      accumulator\n    else\n      sum\n    end\n  end\nend\n\nadd(1)                # =&gt; #&lt;Proc:0x007fb8ae20e860@(pry):4&gt;\nadd(1).(2)            # =&gt; #&lt;Proc:0x007fb8ae4894f0@(pry):4&gt;\n\nadd(1).()             # =&gt; 1\nadd(1).(2).()         # =&gt; 3\nadd(1).(2).(3).(4).() # =&gt; 10\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 33085, "user_id": 2423164, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/Nxbnp.jpg?s=128&g=1", "display_name": "ndnenkov", "link": "https://stackoverflow.com/users/2423164/ndnenkov"}, "edited": false, "score": 2, "creation_date": 1501083823, "post_id": 45331518, "comment_id": 77625162, "body": "Ok, you win. xd But you know this is evil. Maybe if we could make it work with refinements..."}], "tags": [], "owner": {"reputation": 48049, "user_id": 6419007, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/CwqtX.jpg?s=128&g=1", "display_name": "Eric Duminil", "link": "https://stackoverflow.com/users/6419007/eric-duminil"}, "is_accepted": true, "score": 3, "last_activity_date": 1501172139, "last_edit_date": 1501172139, "creation_date": 1501083339, "answer_id": 45331518, "question_id": 45330033, "link": "https://stackoverflow.com/questions/45330033/adding-numbers-in-succession/45331518#45331518", "title": "Adding numbers in succession", "body": "<p>For reference, this problem comes from CodeWars <a href=\"https://www.codewars.com/kata/539a0e4d85e3425cb0000a88\" rel=\"nofollow noreferrer\">\"A Chain Adding Function\"</a>.</p>\n\n<p>The easiest way to achieve this is to define <code>Integer#call</code>:</p>\n\n<pre><code>class Integer\n  def call(n)\n    self + n\n  end\nend\n\ndef add(n)\n  n\nend\n\nputs add(1)\n# 1\nputs add(1).(2)\n# 3\nputs add(1).(2).(3)\n# 6\n</code></pre>\n\n<p>The returned objects are plain Ruby Integers, not Proxy objects.</p>\n\n<p>Note that it's probably not a good idea to modify such an important class. It's possible to use <a href=\"https://ruby-doc.org/core-2.1.1/doc/syntax/refinements_rdoc.html\" rel=\"nofollow noreferrer\">refinements</a> in order to avoid breaking other Ruby parts:</p>\n\n<pre><code>module ChainAdding\n  refine Integer do\n    def call(n)\n      self + n\n    end\n  end\nend\n\ndef add(n)\n  n\nend\n\nusing ChainAdding\n\nputs add(1)\n# 1\nputs add(1).(2)\n# 3\nputs add(1).(2).(3)\n# 6\n</code></pre>\n\n<p>If you're learning Ruby, this kind of metaprogramming trick isn't what you should concentrate on first. It's cool to know that we can do this, it doesn't mean that we should, though.</p>\n"}], "owner": {"reputation": 345, "user_id": 8370615, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d67dd8d47080a058fde4f5761185cccc?s=128&d=identicon&r=PG&f=1", "display_name": "StormKrow", "link": "https://stackoverflow.com/users/8370615/stormkrow"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 575, "favorite_count": 0, "accepted_answer_id": 45331518, "answer_count": 2, "score": 2, "last_activity_date": 1501172139, "creation_date": 1501079607, "last_edit_date": 1501082024, "question_id": 45330033, "link": "https://stackoverflow.com/questions/45330033/adding-numbers-in-succession", "title": "Adding numbers in succession", "body": "<p>I'm trying to learn Ruby and I came across a problem online where I need to create something similar to this :</p>\n\n<pre><code>add(1)         # =&gt; 1\nadd(1).(2)     # =&gt; 3\nadd(1).(2).(3) # =&gt; 6\n</code></pre>\n\n<p>and so on.</p>\n\n<p>I've read around and the closest I can get to having this work is with the following code :</p>\n\n<pre><code>def add(n)\n  Proc.new { |s| s + n }\nend\n</code></pre>\n\n<p>Which works to an extent. </p>\n\n<p>I can run the following :</p>\n\n<pre><code>add(1)     # =&gt; #&lt;Proc:0x007fb8aac309f0@(pry):2&gt;\n# or\nadd(1).(2) # =&gt; 3\n</code></pre>\n\n<p>But the moment I try doing this :</p>\n\n<pre><code>add(1).(2).(3)\n</code></pre>\n\n<p>I get the following error :</p>\n\n<blockquote>\n  <p><code>NoMethodError</code>: undefined method <code>call</code> for 3:<code>Integer</code></p>\n</blockquote>\n\n<p>Why am I getting this error and how would I change this method so that it will accept as many new values as I give it to add itself without giving me an error?</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 3, "creation_date": 1501079325, "post_id": 45329817, "comment_id": 77621445, "body": "It might seem like a minor thing but do make every effort to keep your indentation consistent and correct. When reading questions here every moment spent trying to figure out what your code even means is time spent not answering the question."}], "answers": [{"comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1501079998, "post_id": 45330127, "comment_id": 77622002, "body": "Promoting that to a global variable is making this even messier than it needs to be. There&#39;s a reason it&#39;s contained within the parent class."}, {"owner": {"reputation": 13359, "user_id": 1779477, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/f62e1d28063f41fd9728d811fea3a84c?s=128&d=identicon&r=PG&f=1", "display_name": "idmean", "link": "https://stackoverflow.com/users/1779477/idmean"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 1, "creation_date": 1501080202, "post_id": 45330127, "comment_id": 77622175, "body": "@tadman You\u2019re absolutely right. My answer is nowhere near as beautiful as yours. I up voted your answer! Sadly, the OP has just accepted my answer."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1501080249, "post_id": 45330127, "comment_id": 77622211, "body": "You were pretty quick to answer, and it works, so I guess someone&#39;s hot to trot! Thanks for the support."}], "tags": [], "owner": {"reputation": 13359, "user_id": 1779477, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/f62e1d28063f41fd9728d811fea3a84c?s=128&d=identicon&r=PG&f=1", "display_name": "idmean", "link": "https://stackoverflow.com/users/1779477/idmean"}, "is_accepted": true, "score": 0, "last_activity_date": 1501079859, "creation_date": 1501079859, "answer_id": 45330127, "question_id": 45329817, "link": "https://stackoverflow.com/questions/45329817/reverse-class-inheritance-in-ruby/45330127#45330127", "title": "Reverse (?) Class inheritance in Ruby", "body": "<p>You definitely haven\u2019t understood classes. Why do you expect to change the behavior of an object by changing one instance variable?</p>\n\n<p>When you do <code>Animals.new</code> you request a new animal. And an Animal behaves exactly like you defined in the Animal class, in which you defined the <code>fly</code> method as:</p>\n\n<pre><code>def fly\nraise \"Not defined !\"\nend\n</code></pre>\n\n<p>So there\u2019s absolutely no reason to expect <code>you cannot fly !</code>.</p>\n\n<hr>\n\n<p>You could do something like this, however: </p>\n\n<pre><code>SPECIES = []\nclass Animals\n  attr_accessor :name\n  def initialize \n    @name = SPECIES.sample\n  end\n\n  def fly\n  raise \"Not defined !\"\n  end\n\n  def interact\n   puts \"You are #{self}\"\n   fly\n  end\n\n  def to_s\n    \"a #{@name}\"\n  end\n\nend\n\nclass Penguin &lt; Animals\n  SPECIES &lt;&lt; self\n\n  def initialize\n    @name = \"penguin\"\n  end\n\n  def fly\n    puts \"you cannot fly !\"\n  end\nend\n\nclass Eagle &lt; Animals\n  SPECIES &lt;&lt; self\n\n  def initialize\n    @name = \"eagle\"\n  end\n\n  def fly\n    puts \"you fly high up the mountains !\"\n  end\nend\n\nSPECIES.sample.new.interact\n</code></pre>\n\n<p>Now the <code>SPECIES</code> variable that I have made global stores the different Animal subclasses. When you call <code>SPECIES.sample</code> you get a class like Penguin or Eagle. You instantiate that class, i.e. you get an instance of Penguin that behaves exactly like a penguin and will correctly no whether it can fly.</p>\n"}, {"tags": [], "owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "is_accepted": false, "score": 2, "last_activity_date": 1501079944, "creation_date": 1501079944, "answer_id": 45330163, "question_id": 45329817, "link": "https://stackoverflow.com/questions/45329817/reverse-class-inheritance-in-ruby/45330163#45330163", "title": "Reverse (?) Class inheritance in Ruby", "body": "<p>While you've got roughly the right idea with subclasses and overriding methods, the mistake here is that your design requires you to instantiate <code>Animals</code> instances before they show up in the parent class, a very unusual way of defining these things. You're also modifying what should be a constant, which is bad form, and your initialize method merely populates the name, it doesn't select the appropriate type.</p>\n\n<p>In Ruby when your <code>initialize</code> method is called your object is locked in with a particular type that cannot be changed. If you want to emit animals of various types then you need to store those in an array already pre-constructed.</p>\n\n<p>You can always request notification when your base class is used for inheritance by defining an <code>inherited</code> method:</p>\n\n<pre><code>class Animals\n  def self.inherited(subclass)\n    (@types ||= [ ]) &lt;&lt; subclass\n  end\nend\n</code></pre>\n\n<p>This allows you to select one at random using a <em>factory method</em>:</p>\n\n<pre><code>class Animals\n  def self.random\n    @types and @types.sample.new\n  end\nend\n</code></pre>\n\n<p>This simplifies the implementation of the other instances and does not require you to do anything special to get them to link up properly:</p>\n\n<pre><code>class Penguin &lt; Animals\n  def initialize\n    @name = \"penguin\"\n  end\n\n  def fly\n    puts \"you cannot fly !\"\n  end\nend\n\nclass Eagle &lt; Animals\n  def initialize\n    @name = \"eagle\"\n  end\n\n  def fly\n    puts \"you fly high up the mountains !\"\n  end\nend\n</code></pre>\n\n<p>So when you call the factory method you should get a random animal instance:</p>\n\n<pre><code>Animals.random\n# =&gt; #&lt;Eagle:0x007fc8f4109090 @name=\"eagle\"&gt;\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 33085, "user_id": 2423164, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/Nxbnp.jpg?s=128&g=1", "display_name": "ndnenkov", "link": "https://stackoverflow.com/users/2423164/ndnenkov"}, "is_accepted": false, "score": 0, "last_activity_date": 1501080431, "last_edit_date": 1501080431, "creation_date": 1501080028, "answer_id": 45330195, "question_id": 45329817, "link": "https://stackoverflow.com/questions/45329817/reverse-class-inheritance-in-ruby/45330195#45330195", "title": "Reverse (?) Class inheritance in Ruby", "body": "<p>Firstly, on the topic of why it doesn't work.</p>\n\n<p><code>Class#new</code> always returns the newly allocated instance, no matter what is your last statement, return statements etc. Hence you will get a non-specific <code>Animal</code> with <code>Animal.new</code>.</p>\n\n<hr>\n\n<p>Secondly, on how to <em>\"properly\"</em> do it.</p>\n\n<p>A class that knows about all of his children is an OO wtf moment. Instead create a separate service for picking an animal:</p>\n\n<pre><code>module AnimalPicker\n  ANIMALS = [Penguin, Eagle]\n\n  def self.random\n    ANIMALS.sample.new\n  end\nend\n\nAnimalPicker.random\n</code></pre>\n\n<hr>\n\n<p>Thirdly, on <em>\"but I really want to do it this way!!!!1111!\"</em>.</p>\n\n<p>You can redefine <code>Animal#new</code>:</p>\n\n<pre><code>class Animal\n  def self.new\n    [Penguin, Eagle].sample.new\n  end\nend\n\nAnimal.new\n</code></pre>\n"}], "owner": {"reputation": 35, "user_id": 8370628, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b77ab0b1e6e591dc78f4da92ba61e94?s=128&d=identicon&r=PG&f=1", "display_name": "iLLUNiS", "link": "https://stackoverflow.com/users/8370628/illunis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 142, "favorite_count": 0, "accepted_answer_id": 45330127, "answer_count": 3, "score": 1, "last_activity_date": 1501080431, "creation_date": 1501079113, "question_id": 45329817, "link": "https://stackoverflow.com/questions/45329817/reverse-class-inheritance-in-ruby", "title": "Reverse (?) Class inheritance in Ruby", "body": "<p>just messing around with Ruby and was trying the following. I know i could do it with a case statement but what would be the proper way to achieve it?</p>\n\n<p>What i want it to be able to type</p>\n\n<pre><code>Animals.new.interact\n</code></pre>\n\n<p>and get a proper reply depending on the Animal. </p>\n\n<p>At the moment i get back a reply</p>\n\n<pre><code>You are a eagle\nNot defined !\n(repl):9:in `fly'\n(repl):14:in `interact'\n(repl):1:in `&lt;main&gt;'\n</code></pre>\n\n<p>but i would expect something along those lines (if the sample is a Penguin for example)</p>\n\n<pre><code>You are a penguin\nyou cannot fly !\n</code></pre>\n\n<p>Any  ideas appreciated.</p>\n\n<pre><code>class Animals\n  SPECIES = []\n  attr_accessor :name\n  def initialize \n    @name = SPECIES.sample\n  end\n\ndef fly\nraise \"Not defined !\"\nend\n\ndef interact\n puts \"You are #{self}\"\n fly\nend\n\n  def to_s\n    \"a #{@name}\"\n  end\n\nend\n\nclass Penguin &lt; Animals\n\n  def initialize\n    @name = \"penguin\"\n    SPECIES &lt;&lt; @name\n  end\n\n  def fly\n    puts \"you cannot fly !\"\n  end\n\nend\n\nclass Eagle &lt; Animals\n\n  def initialize\n    @name = \"eagle\"\n        SPECIES &lt;&lt; @name\n\n  end\n\n  def fly\n    puts \"you fly high up the mountains !\"\n  end\nend\nPenguin.new\nEagle.new\n</code></pre>\n"}, {"tags": ["ruby", "pdf", "wicked-pdf"], "answers": [{"tags": [], "owner": {"reputation": 17497, "user_id": 23915, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b5e935da7b67c03dd56f385b031f485c?s=128&d=identicon&r=PG", "display_name": "Unixmonkey", "link": "https://stackoverflow.com/users/23915/unixmonkey"}, "is_accepted": true, "score": 4, "last_activity_date": 1501268300, "creation_date": 1501268300, "answer_id": 45380590, "question_id": 45329522, "link": "https://stackoverflow.com/questions/45329522/how-use-html-view-partial-to-pdf-view-with-wicked-pdf-gem/45380590#45380590", "title": "how use html view/partial to pdf view with wicked_pdf gem?", "body": "<p>I tried to reproduce your issue in <a href=\"https://github.com/unixmonkey/wicked_pdf_issues/commit/66d7fb289259f7bba96fcb4afea048a9dd3602f0\" rel=\"nofollow noreferrer\">this commit</a> of the <a href=\"https://github.com/unixmonkey/wicked_pdf_issues/\" rel=\"nofollow noreferrer\">Wicked PDF issues project</a> and was successful in accomplishing what you show here, however there is a minor caveat.</p>\n\n<p>Using the Rails model rendering shorthand:</p>\n\n<pre><code># assuming @books = Book.all or some collection of Book objects\n&lt;%= render @books %&gt;\n</code></pre>\n\n<p>It will try and render that collection with the extension of the request.</p>\n\n<p>Meaning, for an html request, it will attempt to render the template at:</p>\n\n<pre><code>app/views/books/_book.html.erb\n</code></pre>\n\n<p>And for a PDF request, it will attempt to render</p>\n\n<pre><code>app/views/books/_book.pdf.erb\n</code></pre>\n\n<p>I worked around this by renaming my partial to:</p>\n\n<pre><code>app/views/books/_book.erb\n</code></pre>\n\n<p>So it will be used regardless of an HTML or PDF request.</p>\n\n<p>If that doesn't work in your situation, you can create a new PDF partial, that renders the HTML one like this:</p>\n\n<pre><code># app/views/books/_book.pdf.erb\n&lt;%= render partial: '/books/book',\n      formats: [:html],\n      locals: { book: book } %&gt;\n</code></pre>\n"}], "owner": {"reputation": 2773, "user_id": 2505904, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/dfbdb599d48dd7b6dba638bf0549599a?s=128&d=identicon&r=PG", "display_name": "Matrix", "link": "https://stackoverflow.com/users/2505904/matrix"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1386, "favorite_count": 0, "accepted_answer_id": 45380590, "answer_count": 1, "score": 2, "last_activity_date": 1501268300, "creation_date": 1501078431, "question_id": 45329522, "link": "https://stackoverflow.com/questions/45329522/how-use-html-view-partial-to-pdf-view-with-wicked-pdf-gem", "title": "how use html view/partial to pdf view with wicked_pdf gem?", "body": "<pre><code>def foo    \n  respond_to do |format|\n    format.html { render layout: 'application' }\n    format.pdf { \n      render pdf: 'foo', layout: 'pdf'\n    }\n  end\nend\n</code></pre>\n\n<p>if I put only <code>hello world</code> in <code>foo.pdf.erb</code> it works !</p>\n\n<p>but now if I want use a html view to iterate on my model (from DB) like :</p>\n\n<pre><code>&lt;p&gt;hello world&lt;/p&gt;    \n&lt;%= render @foo.chapters.order(number: :asc) %&gt;\n</code></pre>\n\n<p>it doest works, the page stay grey, no error in log...</p>\n\n<p>if i comment this line, <code>hello world</code> works again. </p>\n\n<p>So the issu is about using html partial : how can we use the normal html view in pdf view?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "capybara"], "comments": [{"owner": {"reputation": 42014, "user_id": 2709090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/238c2b7cde2c817fc9a5a2b8eaa2ffad?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Walpole", "link": "https://stackoverflow.com/users/2709090/thomas-walpole"}, "edited": false, "score": 0, "creation_date": 1501084878, "post_id": 45329095, "comment_id": 77625985, "body": "Capybara doesn&#39;t provide a <code>:name</code>  selector so it&#39;s not really surprising that doesn&#39;t work (and unless you&#39;re running a pretty old version of Capybara it should have output a warning about an unknown selector) . Please add the methods you&#39;ve tried and the exact error messages they produce to the question - adding the relevant portion of HTML you&#39;re trying to interact with would also be helpful."}, {"owner": {"reputation": 42014, "user_id": 2709090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/238c2b7cde2c817fc9a5a2b8eaa2ffad?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Walpole", "link": "https://stackoverflow.com/users/2709090/thomas-walpole"}, "edited": false, "score": 0, "creation_date": 1501179190, "post_id": 45329095, "comment_id": 77677797, "body": "Post the html of the frame you&#39;re trying to interact with"}, {"owner": {"reputation": 201, "user_id": 6948716, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/57b79e3a77151943a2e0b41b603c38c7?s=128&d=identicon&r=PG&f=1", "display_name": "vladimirProp", "link": "https://stackoverflow.com/users/6948716/vladimirprop"}, "reply_to_user": {"reputation": 42014, "user_id": 2709090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/238c2b7cde2c817fc9a5a2b8eaa2ffad?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Walpole", "link": "https://stackoverflow.com/users/2709090/thomas-walpole"}, "edited": false, "score": 0, "creation_date": 1501230737, "post_id": 45329095, "comment_id": 77697712, "body": "i think that iframe content is disabled by phantom js trying to add some flag like --web-security=no"}], "answers": [{"comments": [{"owner": {"reputation": 201, "user_id": 6948716, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/57b79e3a77151943a2e0b41b603c38c7?s=128&d=identicon&r=PG&f=1", "display_name": "vladimirProp", "link": "https://stackoverflow.com/users/6948716/vladimirprop"}, "edited": false, "score": 0, "creation_date": 1501078146, "post_id": 45329254, "comment_id": 77620437, "body": "hey buddy tried this before find_field(&#39;name[cvc]&#39;)"}, {"owner": {"reputation": 3997, "user_id": 3998420, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/55ea542584d3fd2a430c3d409bdafc95?s=128&d=identicon&r=PG&f=1", "display_name": "bkunzi01", "link": "https://stackoverflow.com/users/3998420/bkunzi01"}, "reply_to_user": {"reputation": 201, "user_id": 6948716, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/57b79e3a77151943a2e0b41b603c38c7?s=128&d=identicon&r=PG&f=1", "display_name": "vladimirProp", "link": "https://stackoverflow.com/users/6948716/vladimirprop"}, "edited": false, "score": 0, "creation_date": 1501078441, "post_id": 45329254, "comment_id": 77620671, "body": "Have you tried the within_frame method?  Checkout this stack post similar issue: <a href=\"https://stackoverflow.com/questions/16034224/handling-iframe-with-capybara-ruby\" title=\"handling iframe with capybara ruby\">stackoverflow.com/questions/16034224/&hellip;</a>"}, {"owner": {"reputation": 201, "user_id": 6948716, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/57b79e3a77151943a2e0b41b603c38c7?s=128&d=identicon&r=PG&f=1", "display_name": "vladimirProp", "link": "https://stackoverflow.com/users/6948716/vladimirprop"}, "edited": false, "score": 0, "creation_date": 1501078613, "post_id": 45329254, "comment_id": 77620813, "body": "yeah tried with within_frame, googled whole day i was able to select root div in iframe, but cannot select input node with cvc card name or card number"}, {"owner": {"reputation": 3997, "user_id": 3998420, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/55ea542584d3fd2a430c3d409bdafc95?s=128&d=identicon&r=PG&f=1", "display_name": "bkunzi01", "link": "https://stackoverflow.com/users/3998420/bkunzi01"}, "reply_to_user": {"reputation": 201, "user_id": 6948716, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/57b79e3a77151943a2e0b41b603c38c7?s=128&d=identicon&r=PG&f=1", "display_name": "vladimirProp", "link": "https://stackoverflow.com/users/6948716/vladimirprop"}, "edited": false, "score": 0, "creation_date": 1501078846, "post_id": 45329254, "comment_id": 77621000, "body": "Perhaps the element inside the iframe hasn&#39;t been loaded?  What are you using with capy?  Any js headless browser etc."}, {"owner": {"reputation": 201, "user_id": 6948716, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/57b79e3a77151943a2e0b41b603c38c7?s=128&d=identicon&r=PG&f=1", "display_name": "vladimirProp", "link": "https://stackoverflow.com/users/6948716/vladimirprop"}, "edited": false, "score": 0, "creation_date": 1501078958, "post_id": 45329254, "comment_id": 77621086, "body": "i have poltergeist and selenium driver"}, {"owner": {"reputation": 42014, "user_id": 2709090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/238c2b7cde2c817fc9a5a2b8eaa2ffad?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Walpole", "link": "https://stackoverflow.com/users/2709090/thomas-walpole"}, "reply_to_user": {"reputation": 201, "user_id": 6948716, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/57b79e3a77151943a2e0b41b603c38c7?s=128&d=identicon&r=PG&f=1", "display_name": "vladimirProp", "link": "https://stackoverflow.com/users/6948716/vladimirprop"}, "edited": false, "score": 0, "creation_date": 1501085747, "post_id": 45329254, "comment_id": 77626596, "body": "@vladimirProp unless the input looks like   <code>&lt;input name=&quot;name[cvc]&quot; ... &gt;</code> - you&#39;re use of <code>find_field</code> is wrong.  <code>find_field</code> takes the name, id, or label text of the input to find, so if your input is . <code>&lt;input name=&quot;cvc&quot; ... &gt;</code>, as I think you&#39;re implying, it would just be <code>find_field(&#39;cvc&#39;)</code>"}, {"owner": {"reputation": 201, "user_id": 6948716, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/57b79e3a77151943a2e0b41b603c38c7?s=128&d=identicon&r=PG&f=1", "display_name": "vladimirProp", "link": "https://stackoverflow.com/users/6948716/vladimirprop"}, "edited": false, "score": 0, "creation_date": 1501146366, "post_id": 45329254, "comment_id": 77653398, "body": "yeah it seems this element cvc isn&#39;t visible in iframe for some reason"}, {"owner": {"reputation": 201, "user_id": 6948716, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/57b79e3a77151943a2e0b41b603c38c7?s=128&d=identicon&r=PG&f=1", "display_name": "vladimirProp", "link": "https://stackoverflow.com/users/6948716/vladimirprop"}, "edited": false, "score": 0, "creation_date": 1501230703, "post_id": 45329254, "comment_id": 77697689, "body": "i think that iframe content is disabled by phantom js trying to add some flag like --web-security=no"}, {"owner": {"reputation": 201, "user_id": 6948716, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/57b79e3a77151943a2e0b41b603c38c7?s=128&d=identicon&r=PG&f=1", "display_name": "vladimirProp", "link": "https://stackoverflow.com/users/6948716/vladimirprop"}, "edited": false, "score": 1, "creation_date": 1502176291, "post_id": 45329254, "comment_id": 78082275, "body": "problem was in outdated version of capybara try to update and iframe will be visible"}], "tags": [], "owner": {"reputation": 3997, "user_id": 3998420, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/55ea542584d3fd2a430c3d409bdafc95?s=128&d=identicon&r=PG&f=1", "display_name": "bkunzi01", "link": "https://stackoverflow.com/users/3998420/bkunzi01"}, "is_accepted": true, "score": 1, "last_activity_date": 1501077836, "creation_date": 1501077836, "answer_id": 45329254, "question_id": 45329095, "link": "https://stackoverflow.com/questions/45329095/cabybara-find-element-based-on-element-name/45329254#45329254", "title": "Cabybara find element based on element name", "body": "<p>Use the capybara <code>find_field</code> method to find field inputs.  Checkout the docs here:\n<a href=\"http://www.rubydoc.info/github/jnicklas/capybara/Capybara/Node/Finders#find_field-instance_method\" rel=\"nofollow noreferrer\">http://www.rubydoc.info/github/jnicklas/capybara/Capybara/Node/Finders#find_field-instance_method</a></p>\n\n<p>Would look something like: <code>find_field('attributes[form_field_attribute_you_need]')</code></p>\n"}, {"comments": [{"owner": {"reputation": 201, "user_id": 6948716, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/57b79e3a77151943a2e0b41b603c38c7?s=128&d=identicon&r=PG&f=1", "display_name": "vladimirProp", "link": "https://stackoverflow.com/users/6948716/vladimirprop"}, "edited": false, "score": 0, "creation_date": 1501078421, "post_id": 45329419, "comment_id": 77620654, "body": "yeah tried that definitely not working with iframe and method within_frame"}, {"owner": {"reputation": 2090, "user_id": 5113690, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/cbKBX.png?s=128&g=1", "display_name": "m3characters", "link": "https://stackoverflow.com/users/5113690/m3characters"}, "reply_to_user": {"reputation": 201, "user_id": 6948716, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/57b79e3a77151943a2e0b41b603c38c7?s=128&d=identicon&r=PG&f=1", "display_name": "vladimirProp", "link": "https://stackoverflow.com/users/6948716/vladimirprop"}, "edited": false, "score": 0, "creation_date": 1501078575, "post_id": 45329419, "comment_id": 77620789, "body": "and you&#39;re sure you have an iframe to navigate to when you try? Have you tried printing out the iframe element to see if it&#39;s available?"}, {"owner": {"reputation": 201, "user_id": 6948716, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/57b79e3a77151943a2e0b41b603c38c7?s=128&d=identicon&r=PG&f=1", "display_name": "vladimirProp", "link": "https://stackoverflow.com/users/6948716/vladimirprop"}, "edited": false, "score": 0, "creation_date": 1501078653, "post_id": 45329419, "comment_id": 77620838, "body": "yeah i was able to select node with root id in it"}, {"owner": {"reputation": 2090, "user_id": 5113690, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/cbKBX.png?s=128&g=1", "display_name": "m3characters", "link": "https://stackoverflow.com/users/5113690/m3characters"}, "reply_to_user": {"reputation": 201, "user_id": 6948716, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/57b79e3a77151943a2e0b41b603c38c7?s=128&d=identicon&r=PG&f=1", "display_name": "vladimirProp", "link": "https://stackoverflow.com/users/6948716/vladimirprop"}, "edited": false, "score": 0, "creation_date": 1501078756, "post_id": 45329419, "comment_id": 77620929, "body": "but I mean the contents of it? isn&#39;t it loaded through stripe checkout.js or something?"}, {"owner": {"reputation": 201, "user_id": 6948716, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/57b79e3a77151943a2e0b41b603c38c7?s=128&d=identicon&r=PG&f=1", "display_name": "vladimirProp", "link": "https://stackoverflow.com/users/6948716/vladimirprop"}, "edited": false, "score": 0, "creation_date": 1501078876, "post_id": 45329419, "comment_id": 77621023, "body": "not sure how to check content, tried to echo something with puts"}, {"owner": {"reputation": 2090, "user_id": 5113690, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/cbKBX.png?s=128&g=1", "display_name": "m3characters", "link": "https://stackoverflow.com/users/5113690/m3characters"}, "reply_to_user": {"reputation": 201, "user_id": 6948716, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/57b79e3a77151943a2e0b41b603c38c7?s=128&d=identicon&r=PG&f=1", "display_name": "vladimirProp", "link": "https://stackoverflow.com/users/6948716/vladimirprop"}, "edited": false, "score": 0, "creation_date": 1501079130, "post_id": 45329419, "comment_id": 77621253, "body": "you can do <code>root_element_object.children.each do |c| puts c.name if c.children.count &gt; 0 c.children.each do |c2| puts c2.name #.... end end end</code> you can nest the loops to further dig, or create a function that digs through and then call it recursively whenever there&#39;s .children.count &gt; 0"}, {"owner": {"reputation": 42014, "user_id": 2709090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/238c2b7cde2c817fc9a5a2b8eaa2ffad?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Walpole", "link": "https://stackoverflow.com/users/2709090/thomas-walpole"}, "edited": false, "score": 1, "creation_date": 1501085506, "post_id": 45329419, "comment_id": 77626441, "body": "You can just do <code>puts page.html</code> when inside the iframe to see the iframes source."}, {"owner": {"reputation": 201, "user_id": 6948716, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/57b79e3a77151943a2e0b41b603c38c7?s=128&d=identicon&r=PG&f=1", "display_name": "vladimirProp", "link": "https://stackoverflow.com/users/6948716/vladimirprop"}, "edited": false, "score": 0, "creation_date": 1501146335, "post_id": 45329419, "comment_id": 77653377, "body": "yeah it seems this element cvc isn&#39;t visible in iframe for some reason"}, {"owner": {"reputation": 201, "user_id": 6948716, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/57b79e3a77151943a2e0b41b603c38c7?s=128&d=identicon&r=PG&f=1", "display_name": "vladimirProp", "link": "https://stackoverflow.com/users/6948716/vladimirprop"}, "edited": false, "score": 0, "creation_date": 1501230717, "post_id": 45329419, "comment_id": 77697700, "body": "i think that iframe content is disabled by phantom js trying to add some flag like --web-security=no"}], "tags": [], "owner": {"reputation": 2090, "user_id": 5113690, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/cbKBX.png?s=128&g=1", "display_name": "m3characters", "link": "https://stackoverflow.com/users/5113690/m3characters"}, "is_accepted": false, "score": 0, "last_activity_date": 1501078182, "creation_date": 1501078182, "answer_id": 45329419, "question_id": 45329095, "link": "https://stackoverflow.com/questions/45329095/cabybara-find-element-based-on-element-name/45329419#45329419", "title": "Cabybara find element based on element name", "body": "<p>Not sure if this works with an iframe, but you should be able to use:</p>\n\n<pre><code>within('#target_form_id') do #or another selector\n  fill_in 'field_name_or_id', with: 'value'\n  fill_in 'another_field', with: 'another_value'\nend\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 201, "user_id": 6948716, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/57b79e3a77151943a2e0b41b603c38c7?s=128&d=identicon&r=PG&f=1", "display_name": "vladimirProp", "link": "https://stackoverflow.com/users/6948716/vladimirprop"}, "edited": false, "score": 0, "creation_date": 1501081264, "post_id": 45329502, "comment_id": 77623075, "body": "i got error The browser raised a syntax error while trying to evaluate css selector &quot;//input[@name=\\&quot;cvc\\&quot;]&quot;"}, {"owner": {"reputation": 397, "user_id": 1642511, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c1f2c418f2e87d63e2ccbf538ed70fdb?s=128&d=identicon&r=PG", "display_name": "Eric Himmelreich", "link": "https://stackoverflow.com/users/1642511/eric-himmelreich"}, "reply_to_user": {"reputation": 201, "user_id": 6948716, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/57b79e3a77151943a2e0b41b603c38c7?s=128&d=identicon&r=PG&f=1", "display_name": "vladimirProp", "link": "https://stackoverflow.com/users/6948716/vladimirprop"}, "edited": false, "score": 0, "creation_date": 1501081304, "post_id": 45329502, "comment_id": 77623108, "body": "The quoting is important <code>&#39;input[@name=&quot;exp-date&quot;]&#39;</code>. It should single quotes containing double quotes just as I wrote it"}, {"owner": {"reputation": 201, "user_id": 6948716, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/57b79e3a77151943a2e0b41b603c38c7?s=128&d=identicon&r=PG&f=1", "display_name": "vladimirProp", "link": "https://stackoverflow.com/users/6948716/vladimirprop"}, "edited": false, "score": 0, "creation_date": 1501081359, "post_id": 45329502, "comment_id": 77623158, "body": "yes this is my code     find(&#39;//input[@name=&quot;cvc&quot;]&#39;, match: :first).set(&#39;1234&#39;)"}, {"owner": {"reputation": 397, "user_id": 1642511, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c1f2c418f2e87d63e2ccbf538ed70fdb?s=128&d=identicon&r=PG", "display_name": "Eric Himmelreich", "link": "https://stackoverflow.com/users/1642511/eric-himmelreich"}, "reply_to_user": {"reputation": 201, "user_id": 6948716, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/57b79e3a77151943a2e0b41b603c38c7?s=128&d=identicon&r=PG&f=1", "display_name": "vladimirProp", "link": "https://stackoverflow.com/users/6948716/vladimirprop"}, "edited": false, "score": 0, "creation_date": 1501081424, "post_id": 45329502, "comment_id": 77623226, "body": "I updated the code that should work. It is just a CSS selector, not XPath, my mistake."}, {"owner": {"reputation": 201, "user_id": 6948716, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/57b79e3a77151943a2e0b41b603c38c7?s=128&d=identicon&r=PG&f=1", "display_name": "vladimirProp", "link": "https://stackoverflow.com/users/6948716/vladimirprop"}, "edited": false, "score": 0, "creation_date": 1501081810, "post_id": 45329502, "comment_id": 77623553, "body": "same sintax error i will try to escape find(&#39;input[@name=\\&quot;cvc\\&quot;]&#39;, match: :first).set(&#39;12345&#39;)"}, {"owner": {"reputation": 201, "user_id": 6948716, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/57b79e3a77151943a2e0b41b603c38c7?s=128&d=identicon&r=PG&f=1", "display_name": "vladimirProp", "link": "https://stackoverflow.com/users/6948716/vladimirprop"}, "edited": false, "score": 0, "creation_date": 1501082278, "post_id": 45329502, "comment_id": 77623943, "body": "not sure why slashes are added &quot;input[@name=\\&quot;cvc\\&quot;]"}, {"owner": {"reputation": 42014, "user_id": 2709090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/238c2b7cde2c817fc9a5a2b8eaa2ffad?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Walpole", "link": "https://stackoverflow.com/users/2709090/thomas-walpole"}, "reply_to_user": {"reputation": 201, "user_id": 6948716, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/57b79e3a77151943a2e0b41b603c38c7?s=128&d=identicon&r=PG&f=1", "display_name": "vladimirProp", "link": "https://stackoverflow.com/users/6948716/vladimirprop"}, "edited": false, "score": 0, "creation_date": 1501085410, "post_id": 45329502, "comment_id": 77626372, "body": "@vladimirProp The slashes are added because to show the inner &quot;s are inside the outer &quot;s - Also, it should be  <code>input[name=&quot;cvc&quot;]</code> -- @ is only used to select attributes in XPath expressions (not CSS)"}, {"owner": {"reputation": 201, "user_id": 6948716, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/57b79e3a77151943a2e0b41b603c38c7?s=128&d=identicon&r=PG&f=1", "display_name": "vladimirProp", "link": "https://stackoverflow.com/users/6948716/vladimirprop"}, "edited": false, "score": 0, "creation_date": 1501230709, "post_id": 45329502, "comment_id": 77697694, "body": "i think that iframe content is disabled by phantom js trying to add some flag like --web-security=no"}], "tags": [], "owner": {"reputation": 397, "user_id": 1642511, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c1f2c418f2e87d63e2ccbf538ed70fdb?s=128&d=identicon&r=PG", "display_name": "Eric Himmelreich", "link": "https://stackoverflow.com/users/1642511/eric-himmelreich"}, "is_accepted": false, "score": 0, "last_activity_date": 1501098310, "last_edit_date": 1501098310, "creation_date": 1501078394, "answer_id": 45329502, "question_id": 45329095, "link": "https://stackoverflow.com/questions/45329095/cabybara-find-element-based-on-element-name/45329502#45329502", "title": "Cabybara find element based on element name", "body": "<p>You can use a CSS selector here:</p>\n\n<pre><code>find('input[name=\"exp-date\"]', match: :first).set('my value')\n</code></pre>\n"}], "owner": {"reputation": 201, "user_id": 6948716, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/57b79e3a77151943a2e0b41b603c38c7?s=128&d=identicon&r=PG&f=1", "display_name": "vladimirProp", "link": "https://stackoverflow.com/users/6948716/vladimirprop"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1103, "favorite_count": 0, "accepted_answer_id": 45329254, "answer_count": 3, "score": 0, "last_activity_date": 1501098310, "creation_date": 1501077468, "question_id": 45329095, "link": "https://stackoverflow.com/questions/45329095/cabybara-find-element-based-on-element-name", "title": "Cabybara find element based on element name", "body": "<p>Hi i am trying to select input field and add value into stripe's iframe, based on element name.\nthis won't work</p>\n\n<pre><code>page.find(:name, 'exp-date')\n</code></pre>\n\n<p>i was able to select root div with id selector, but i can't select input field which is child node somewhere in root div</p>\n\n<pre><code>  find(:id, \"root\")\n</code></pre>\n\n<p>Any idea how to target those  fields</p>\n"}, {"tags": ["ruby"], "answers": [{"comments": [{"owner": {"reputation": 33085, "user_id": 2423164, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/Nxbnp.jpg?s=128&g=1", "display_name": "ndnenkov", "link": "https://stackoverflow.com/users/2423164/ndnenkov"}, "reply_to_user": {"reputation": 6316, "user_id": 1184717, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/7f8710cd5754a79df5dc5cd3d5308da2?s=128&d=identicon&r=PG", "display_name": "Mr.", "link": "https://stackoverflow.com/users/1184717/mr"}, "edited": false, "score": 0, "creation_date": 1501078397, "post_id": 45329120, "comment_id": 77620628, "body": "@MrRoth, happy to help (:"}], "tags": [], "owner": {"reputation": 33085, "user_id": 2423164, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/Nxbnp.jpg?s=128&g=1", "display_name": "ndnenkov", "link": "https://stackoverflow.com/users/2423164/ndnenkov"}, "is_accepted": true, "score": 1, "last_activity_date": 1501078788, "last_edit_date": 1501078788, "creation_date": 1501077538, "answer_id": 45329120, "question_id": 45328719, "link": "https://stackoverflow.com/questions/45328719/ruby-get-caller-full-namespace-with-its-parameter-name-and-argument/45329120#45329120", "title": "ruby get caller full namespace with its parameter name and argument", "body": "<p>What you are looking for is <code>#set_trace_func</code> combined with binding introspection:</p>\n\n<pre><code>module Foo\n  module Bar\n    def self.baz(p, q)\n    end\n  end\nend\n\nintercept_event = proc do |event, _, _, method_name, method_binding, _|\n  if event == 'call'\n    self_in_method = method_binding.eval('self')\n\n    parameter_names = self_in_method.method(method_name).parameters.map(&amp;:last)\n    parameter_list  = parameter_names.map do |name|\n      \"#{name}=#{method_binding.local_variable_get(name)}\"\n    end\n\n    puts \"#{self_in_method}.#{method_name}(#{parameter_list.join ', '})\"\n  end\nend\n\nset_trace_func intercept_event\n\nFoo::Bar.baz 'val1', 'val2' # Foo::Bar.baz(p=val1, q=val2)\n</code></pre>\n\n<hr>\n\n<p><strong>Note</strong> that this will not work for C methods. To handle them, you can check for <code>'c-call'</code> instead of <code>'call'</code>. You will have to move the method parameters in the string <code>eval</code> however, as <code>self</code> in those methods is not the same as in Ruby methods.</p>\n"}], "owner": {"reputation": 6316, "user_id": 1184717, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/7f8710cd5754a79df5dc5cd3d5308da2?s=128&d=identicon&r=PG", "display_name": "Mr.", "link": "https://stackoverflow.com/users/1184717/mr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 98, "favorite_count": 0, "accepted_answer_id": 45329120, "answer_count": 1, "score": 0, "last_activity_date": 1501078788, "creation_date": 1501076439, "last_edit_date": 1501078177, "question_id": 45328719, "link": "https://stackoverflow.com/questions/45328719/ruby-get-caller-full-namespace-with-its-parameter-name-and-argument", "title": "ruby get caller full namespace with its parameter name and argument", "body": "<p>in debugging ruby applications, i am interested in printing in each function the:\n- full method namespace\n- the method parameters and their arguments (values)</p>\n\n<p>for instance, given the following code block</p>\n\n<pre><code>module Foo\n  module Bar\n    def self.baz(p, q)\n    end\n  end\nend\n</code></pre>\n\n<p>when invoking <code>baz</code> with arguments, such as <code>Foo::Bar.baz 'val1', 'val2'</code>, a message should be printed with the following output <code>Foo::Bar.baz(p=val1, q=val2)</code> (or any similar output)</p>\n\n<p>i am familiar with ruby reflection, so i can introduce to each function some additional code to print it. though, single point of modification is a bliss, thus having the each method call another method that will produce such output will be the great.</p>\n\n<p>my questions are:</p>\n\n<ol>\n<li><p>is there anyway to introduce a method, which each other method invoke that will yield an output similar to the above?</p></li>\n<li><p>is there anyway to achieve the same result by binding the printing method (function) to the beginning of any other method?</p></li>\n</ol>\n"}, {"tags": ["ruby-on-rails", "ruby", "metaprogramming", "introspection"], "comments": [{"owner": {"reputation": 4855, "user_id": 3618156, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/b3e1907a7f15ed006abc8ad406cf40fe?s=128&d=identicon&r=PG&f=1", "display_name": "american-ninja-warrior", "link": "https://stackoverflow.com/users/3618156/american-ninja-warrior"}, "edited": false, "score": 0, "creation_date": 1501076284, "post_id": 45328626, "comment_id": 77618830, "body": "oops I think it&#39;s here <a href=\"https://stackoverflow.com/questions/175655/how-to-find-where-a-method-is-defined-at-runtime\" title=\"how to find where a method is defined at runtime\">stackoverflow.com/questions/175655/&hellip;</a>"}, {"owner": {"reputation": 9030, "user_id": 5101476, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JCQrl.jpg?s=128&g=1", "display_name": "ice\u30c4", "link": "https://stackoverflow.com/users/5101476/ice%e3%83%84"}, "edited": false, "score": 0, "creation_date": 1501076757, "post_id": 45328626, "comment_id": 77619236, "body": "From the link you provided: <code>User.new.method(:foo?).owner</code>"}], "answers": [{"tags": [], "owner": {"reputation": 4855, "user_id": 3618156, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/b3e1907a7f15ed006abc8ad406cf40fe?s=128&d=identicon&r=PG&f=1", "display_name": "american-ninja-warrior", "link": "https://stackoverflow.com/users/3618156/american-ninja-warrior"}, "is_accepted": false, "score": 2, "last_activity_date": 1501076386, "creation_date": 1501076386, "answer_id": 45328692, "question_id": 45328626, "link": "https://stackoverflow.com/questions/45328626/ruby-introspection-how-to-ask-ruby-where-a-method-is-defined/45328692#45328692", "title": "ruby introspection: how to ask ruby where a method is defined?", "body": "<pre><code>(byebug) User.last.method(:foo?)\n#&lt;Method: User(#&lt;Module:0x007fd4c0a03da8&gt;)#foo?&gt;\n(byebug) User.last.method(:foo?).source_location\n[\"/Users/user1/.rbenv/versions/2.3.1/lib/ruby/gems/2.3.0/gems/activerecord-4.2.7/lib/active_record/enum.rb\", 122]\n(byebug) \n</code></pre>\n"}], "owner": {"reputation": 4855, "user_id": 3618156, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/b3e1907a7f15ed006abc8ad406cf40fe?s=128&d=identicon&r=PG&f=1", "display_name": "american-ninja-warrior", "link": "https://stackoverflow.com/users/3618156/american-ninja-warrior"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 131, "favorite_count": 0, "closed_date": 1501076746, "answer_count": 1, "score": 0, "last_activity_date": 1501076386, "creation_date": 1501076230, "question_id": 45328626, "link": "https://stackoverflow.com/questions/45328626/ruby-introspection-how-to-ask-ruby-where-a-method-is-defined", "closed_reason": "Duplicate", "title": "ruby introspection: how to ask ruby where a method is defined?", "body": "<p>I have a class like this in a rails app</p>\n\n<pre><code>class User &lt; ActiveRecord::Base\n  ..\nend\n</code></pre>\n\n<p>The class doesn't have a method caller foo?\nNor does any of the <code>include ...</code> files.\nBut User.new.foo? does respond, so how can I ask where this method is defined?</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 3997, "user_id": 3998420, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/55ea542584d3fd2a430c3d409bdafc95?s=128&d=identicon&r=PG&f=1", "display_name": "bkunzi01", "link": "https://stackoverflow.com/users/3998420/bkunzi01"}, "edited": false, "score": 0, "creation_date": 1501078398, "post_id": 45328508, "comment_id": 77620631, "body": "Not sure I&#39;m understanding this correctly.  You want to include variables from other files as local variables in another file?"}, {"owner": {"reputation": 397, "user_id": 1642511, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c1f2c418f2e87d63e2ccbf538ed70fdb?s=128&d=identicon&r=PG", "display_name": "Eric Himmelreich", "link": "https://stackoverflow.com/users/1642511/eric-himmelreich"}, "edited": false, "score": 0, "creation_date": 1501078575, "post_id": 45328508, "comment_id": 77620788, "body": "You could try using an instance variable for <code>@b</code> instead of b"}, {"owner": {"reputation": 1468, "user_id": 2931765, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/eiU4j.jpg?s=128&g=1", "display_name": "Arun G", "link": "https://stackoverflow.com/users/2931765/arun-g"}, "edited": false, "score": 0, "creation_date": 1501129415, "post_id": 45328508, "comment_id": 77644243, "body": "I just want to make <code>apple.rb</code> inline @ called place"}], "answers": [{"comments": [{"owner": {"reputation": 1468, "user_id": 2931765, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/eiU4j.jpg?s=128&g=1", "display_name": "Arun G", "link": "https://stackoverflow.com/users/2931765/arun-g"}, "edited": false, "score": 0, "creation_date": 1501143666, "post_id": 45330352, "comment_id": 77651567, "body": "Thanks for your effort, But I figured it out"}, {"owner": {"reputation": 1468, "user_id": 2931765, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/eiU4j.jpg?s=128&g=1", "display_name": "Arun G", "link": "https://stackoverflow.com/users/2931765/arun-g"}, "edited": false, "score": 0, "creation_date": 1501144142, "post_id": 45330352, "comment_id": 77651867, "body": "Agarwal: Can give upvote for your attempt, Which works perfectly but solution below I figured out make it simple"}, {"owner": {"reputation": 1418, "user_id": 493674, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/134075878cc4e13e36a6099c277381a5?s=128&d=identicon&r=PG", "display_name": "Vijay Agrawal", "link": "https://stackoverflow.com/users/493674/vijay-agrawal"}, "reply_to_user": {"reputation": 1468, "user_id": 2931765, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/eiU4j.jpg?s=128&g=1", "display_name": "Arun G", "link": "https://stackoverflow.com/users/2931765/arun-g"}, "edited": false, "score": 0, "creation_date": 1501170013, "post_id": 45330352, "comment_id": 77672011, "body": "I had a look at it, though it works but not a recommended way of doing things in ruby. When you have performance and maintainability concerns, you should switch"}], "tags": [], "owner": {"reputation": 1418, "user_id": 493674, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/134075878cc4e13e36a6099c277381a5?s=128&d=identicon&r=PG", "display_name": "Vijay Agrawal", "link": "https://stackoverflow.com/users/493674/vijay-agrawal"}, "is_accepted": false, "score": 1, "last_activity_date": 1501084076, "last_edit_date": 1501084076, "creation_date": 1501080370, "answer_id": 45330352, "question_id": 45328508, "link": "https://stackoverflow.com/questions/45328508/include-all-the-ruby-files-from-a-directory-inside-a-block-as-inline-code/45330352#45330352", "title": "Include all the ruby files from a directory inside a block as inline code", "body": "<p>You should separate file \"loading\" from function execution. Redefine your file like this.</p>\n\n<pre><code>class AppleLoader\n\n  def self.load(b)\n    b.value \"apple\" do |brand|\n      brand.value \"6plus\"\n      brand.value \"6s\"\n      brand.value \"6s-plus\"\n      brand.value \"se\"\n      brand.value \"7\"\n      brand.value \"7-plus\"\n      brand.value \"other-model\"\n    end\n  end\nend\n</code></pre>\n\n<p>On top of file you load required classes like this:</p>\n\n<pre><code>require '/catalogues/mobile_phone_brands/apple_loader.rb'\n</code></pre>\n\n<p>And when you want to load Apple brand in the <code>b</code> object:</p>\n\n<pre><code>AppleLoader.load b\n</code></pre>\n\n<p><strong>Better Approach:</strong>\nTo me it feels like <code>Apple.rb</code> defers from <code>Samsung.rb</code> only in terms of data. If that's the case, and functionality for both of them are same then I would rather:</p>\n\n<ol>\n<li><p>put that data in a Yaml file(<code>brands.yml</code>) instead of rb file. </p>\n\n<pre><code>    brands:\n     apple: [\"6plus\", \"6s\"]\n     samsung: [\"galaxy\"]\n</code></pre></li>\n<li><p>Have just one common loader called <code>BrandLoader</code></p>\n\n<pre><code>class BrandLoader\n\n  def self.load(b, brand_name, values)\n    b.value brand_name do |brand|\n      brand_values.each do |value|\n        brand.value value\n      end\n    end\n  end\nend\n</code></pre></li>\n<li><p>Iterate over brands by reading Yaml</p>\n\n<pre><code>configurations = YAML.load \"brands.yml\"\nconfigurations[\"brands\"].each do |brand_name, values|\n  BrandLoader.load(b, brand_name, values)\nend\n</code></pre></li>\n</ol>\n"}, {"tags": [], "owner": {"reputation": 1468, "user_id": 2931765, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/eiU4j.jpg?s=128&g=1", "display_name": "Arun G", "link": "https://stackoverflow.com/users/2931765/arun-g"}, "is_accepted": false, "score": 0, "last_activity_date": 1501220720, "last_edit_date": 1501220720, "creation_date": 1501144027, "answer_id": 45345267, "question_id": 45328508, "link": "https://stackoverflow.com/questions/45328508/include-all-the-ruby-files-from-a-directory-inside-a-block-as-inline-code/45345267#45345267", "title": "Include all the ruby files from a directory inside a block as inline code", "body": "<p>The way I figured out is by using <code>eval</code> but cautious read up <a href=\"https://stackoverflow.com/questions/637421/is-eval-supposed-to-be-nasty\">is-eval-supposed-to-be-nasty</a>, <code>eval</code> works for me as I'm not using user input.</p>\n\n<p>To make any code in different file, execute as the code written in the place of call. Use <code>eval(File.read(file_path)</code></p>\n\n<pre><code> .....\n    c.tree_field :brand, { child_key: :model } do |b|\n      Dir[\n        File.dirname(__FILE__) + '/catalogues/mobile_phone_brands/*.rb'\n      ].each { |brand| eval(File.read(brand)) }\n\n      b.required = true\n    end\n.....\n</code></pre>\n"}], "owner": {"reputation": 1468, "user_id": 2931765, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/eiU4j.jpg?s=128&g=1", "display_name": "Arun G", "link": "https://stackoverflow.com/users/2931765/arun-g"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 117, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1501220720, "creation_date": 1501075930, "last_edit_date": 1501220581, "question_id": 45328508, "link": "https://stackoverflow.com/questions/45328508/include-all-the-ruby-files-from-a-directory-inside-a-block-as-inline-code", "title": "Include all the ruby files from a directory inside a block as inline code", "body": "<p>Structure of ruby file is as shown below,</p>\n\n<pre><code>market\n  |__abcd\n       |__classification\n              |__for_sale_mobile_phone.rb\n              |__catalogues\n                  |__mobile_phone_brands\n                      |__acer.rb\n                      |__apple.rb\n                      |__samsung.rb\n</code></pre>\n\n<p>In <code>for_sale_mobile_phone.rb</code>, I like to include all brands of <code>mobile_phone_brands</code> under a block.</p>\n\n<p>I m trying to include brands in below fashion,</p>\n\n<pre><code> .....\n    c.tree_field :brand, { child_key: :model } do |b|\n      Dir[\n        File.dirname(__FILE__) + '/catalogues/mobile_phone_brands/*.rb'\n      ].each { |brand| load brand }\n\n      b.required = true\n    end\n.....\n</code></pre>\n\n<p>here is how brand file looks like. for example, <code>apple.rb</code></p>\n\n<pre><code>b.value \"apple\" do |brand|\n  brand.value \"6plus\"\n  brand.value \"6s\"\n  brand.value \"6s-plus\"\n  brand.value \"se\"\n  brand.value \"7\"\n  brand.value \"7-plus\"\n  brand.value \"other-model\"\nend\n</code></pre>\n\n<p>I m getting below error,</p>\n\n<pre><code>undefined local variable or method `b' on line 1: apple.rb\n</code></pre>\n\n<p>How can I include file under a block scope?</p>\n\n<p>Thanks in advance!</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "sidekiq"], "answers": [{"comments": [{"owner": {"reputation": 159, "user_id": 2192676, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/00183455117696d8cb5df14585771ae7?s=128&d=identicon&r=PG", "display_name": "Ronny", "link": "https://stackoverflow.com/users/2192676/ronny"}, "edited": false, "score": 0, "creation_date": 1501078971, "post_id": 45328722, "comment_id": 77621101, "body": "I added the API code for the get_extended_sensor, along with the JSON response."}], "tags": [], "owner": {"reputation": 10274, "user_id": 930207, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oy7Q3.png?s=128&g=1", "display_name": "mcfinnigan", "link": "https://stackoverflow.com/users/930207/mcfinnigan"}, "is_accepted": false, "score": 1, "last_activity_date": 1501076440, "creation_date": 1501076440, "answer_id": 45328722, "question_id": 45328475, "link": "https://stackoverflow.com/questions/45328475/getting-a-primary-key-error-in-rails-using-sidekiq-and-sidekiq-cron/45328722#45328722", "title": "Getting a Primary Key error in Rails using Sidekiq and Sidekiq-Cron", "body": "<p>Some thoughts:</p>\n\n<pre><code>recentEvent = MonnitOpenClosedSensor.select('id, \"SensorID\", \"LastCommunicationDate\"') - \n</code></pre>\n\n<p>this is not doing any ordering; you are presuming that the records you retrieve here are the latest records.</p>\n\n<pre><code>m = Monnit.new(\"iMonnit\", 1)\nnewSensor = m.get_extended_sensor(auth_token, sensor)\n</code></pre>\n\n<p>without the implementation details of get_extended_sensor it's impossible to tell you how </p>\n\n<pre><code>sensorRecord.id = newSensor['LastDataMessageMessageGUID']\n</code></pre>\n\n<p>is resolving.  </p>\n\n<p>It's highly likely that you are getting duplicate messages.  It's almost never a good idea to use input data as a primary key - rather autogenerate a GUID in your job, use that as the primary key, and then use the <code>LastDataMessageMessageGUID</code> as a correlation id.</p>\n"}, {"tags": [], "owner": {"reputation": 159, "user_id": 2192676, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/00183455117696d8cb5df14585771ae7?s=128&d=identicon&r=PG", "display_name": "Ronny", "link": "https://stackoverflow.com/users/2192676/ronny"}, "is_accepted": true, "score": 0, "last_activity_date": 1501082786, "creation_date": 1501082786, "answer_id": 45331327, "question_id": 45328475, "link": "https://stackoverflow.com/questions/45328475/getting-a-primary-key-error-in-rails-using-sidekiq-and-sidekiq-cron/45331327#45331327", "title": "Getting a Primary Key error in Rails using Sidekiq and Sidekiq-Cron", "body": "<p>So the issue that I was running into, as it turns out, is as follows:</p>\n\n<ol>\n<li>A sensor event was pulled from the API and queued up in as a worker job in Sidekiq.</li>\n<li>If the queue is running a bit slow, API speed or simply a lot of jobs to process, the 1 minute poll might hit again and pull the same sensor event down and queue it up.</li>\n<li>As the queue processes, the sensor event gets inserted into the database with it's GUID being the primary key</li>\n<li>As the queue continues to catch up with itself, it hits the same event that was scheduled as a secondary job.  This job then fails.</li>\n</ol>\n\n<p>My solution to this was to move my \"does this SensorID and GUID exist in the database\" to the actual job.  So when the job ran the first thing it'd do is check AGAIN for the record to already exist.  This means I am checking twice, but this quick check has low overhead.  </p>\n\n<p>There is still the risk that a check could happen and pass while another job is inserting the record, before it commits it to the database, and then it could fail.  But the retry would catch it, and then clear it on out as a successful process when the check doesn't validate on the second round.  Having said that, however, the check occurs AFTER the API data has been pulled.  Since, in theory, the database persist of a single record from the API data would happen really fast (much faster than the API call would happen), it really does lower the chances of you having to hit a retry on any job....and I mean you'd have a better chance of hitting the lottery than having the second check fail and trigger a retry.</p>\n\n<p>If anyone else has a better, or more clean solution, please feel free to include it as a secondary answer!</p>\n"}], "owner": {"reputation": 159, "user_id": 2192676, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/00183455117696d8cb5df14585771ae7?s=128&d=identicon&r=PG", "display_name": "Ronny", "link": "https://stackoverflow.com/users/2192676/ronny"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 113, "favorite_count": 1, "accepted_answer_id": 45331327, "answer_count": 2, "score": 0, "last_activity_date": 1501082786, "creation_date": 1501075820, "last_edit_date": 1501078936, "question_id": 45328475, "link": "https://stackoverflow.com/questions/45328475/getting-a-primary-key-error-in-rails-using-sidekiq-and-sidekiq-cron", "title": "Getting a Primary Key error in Rails using Sidekiq and Sidekiq-Cron", "body": "<p>I have a Rails project that uses Sidekiq for worker tasks, and Sidekiq-Cron to handle scheduling.  I am running into a problem, though.  I built a controller (below) that handled all of my API querying, validation of data, and then inserting data into the database.  All of the logic functioned properly.</p>\n\n<p>I then tore out the section of code that actually inserts API data into the database, and moved it into a Job class.  This way the Controller method could simply pass all of the heavy lifting off to a job.  When I tested it, all of the logic functioned properly.</p>\n\n<p>Finally, I created a Job that would call the Controller method every minute, do the validation checks, and then kick off the other Job to save the API data (if necessary).  When I do this the first part of the logic seems to work, where it inserts new event data, but the logic where it checks to see if this is the first time we've seen an event for a specific object seems to be failing.  The result is a Primary Key violation in PG.</p>\n\n<p>Code below:</p>\n\n<p><strong><em>Controller</em></strong></p>\n\n<pre><code>require 'date'\n\nclass MonnitOpenClosedSensorsController &lt; ApplicationController\n\n    def holderTester()\n        #MonnitschedulerJob.perform_later(nil)\n    end\n\n    # Create Sidekiq queue to process new sensor readings\n    def queueNewSensorEvents(auth_token, network_id)\n\n        m = Monnit.new(\"iMonnit\", 1)\n\n        # Construct the query to select the most recent communication date for each sensor in the network\n        lastEventForEachSensor = MonnitOpenClosedSensor.select('\"SensorID\", MAX(\"LastCommunicationDate\") as \"lastCommDate\"')\n        lastEventForEachSensor = lastEventForEachSensor.group(\"SensorID\")\n        lastEventForEachSensor = lastEventForEachSensor.where('\"CSNetID\" = ?', network_id)\n\n        todaysDate = Date.today\n        sevenDaysAgo = (todaysDate - 7)\n\n        lastEventForEachSensor.each do |event|\n            # puts event[\"lastCommDate\"]\n            recentEvent = MonnitOpenClosedSensor.select('id, \"SensorID\", \"LastCommunicationDate\"')\n            recentEvent = recentEvent.where('\"CSNetID\" = ? AND \"SensorID\" = ? AND \"LastCommunicationDate\" = ?', network_id, event[\"SensorID\"], event[\"lastCommDate\"])\n\n            recentEvent.each do |recent|\n                message = m.get_extended_sensor(auth_token, recent[\"SensorID\"])\n                if message[\"LastDataMessageMessageGUID\"] != recent[\"id\"]\n                    MonnitopenclosedsensorJob.perform_later(auth_token, network_id, message[\"SensorID\"])\n                    # puts \"hi inner\"\n                    # puts message[\"LastDataMessageMessageGUID\"]\n                    # puts recent['id']\n                    # puts recent[\"SensorID\"]\n                    # puts message[\"SensorID\"]\n                    # raise message\n                end\n            end\n        end\n\n        # Queue up any Sensor Events for new sensors\n        # This would be sensors we've never seen before, from a Postgres standpoint\n        sensors = m.get_sensor_ids(auth_token)\n        sensors.each do |sensor|\n            sensorCheck = MonnitOpenClosedSensor.select(:SensorID)\n            # sensorCheck = MonnitOpenClosedSensor.select(:SensorID)\n            sensorCheck = sensorCheck.group(:SensorID)\n            sensorCheck = sensorCheck.where('\"CSNetID\" = ? AND \"SensorID\" = ?', network_id, sensor)\n            # sensorCheck = sensorCheck.where('id = \"?\"', sensor[\"LastDataMessageMessageGUID\"])\n\n            if sensorCheck.any? == false\n                MonnitopenclosedsensorJob.perform_later(auth_token, network_id, sensor) \n            end\n        end\n\n    end\n\nend\n</code></pre>\n\n<p>The above code breaks Sensor Events for new sensors.  It doesn't recognize that a sensor already exists, first issue, and then doesn't recognize that the event it is trying to create is already persisted to the database (uses a GUID for comparison).</p>\n\n<p><strong><em>Job to persist data</em></strong></p>\n\n<pre><code>class MonnitopenclosedsensorJob &lt; ApplicationJob\n  queue_as :default\n\n  def perform(auth_token, network_id, sensor)\n    m = Monnit.new(\"iMonnit\", 1)\n    newSensor = m.get_extended_sensor(auth_token, sensor)\n\n    sensorRecord = MonnitOpenClosedSensor.new\n    sensorRecord.SensorID = newSensor['SensorID']\n    sensorRecord.MonnitApplicationID = newSensor['MonnitApplicationID']\n    sensorRecord.CSNetID = newSensor['CSNetID']\n\n    lastCommunicationDatePretty = newSensor['LastCommunicationDate'].scan(/[0-9]+/)[0].to_i / 1000.0\n    nextCommunicationDatePretty = newSensor['NextCommunicationDate'].scan(/[0-9]+/)[0].to_i / 1000.0\n    sensorRecord.LastCommunicationDate = Time.at(lastCommunicationDatePretty)\n    sensorRecord.NextCommunicationDate = Time.at(nextCommunicationDatePretty)\n\n    sensorRecord.id = newSensor['LastDataMessageMessageGUID']\n    sensorRecord.PowerSourceID = newSensor['PowerSourceID']\n    sensorRecord.Status = newSensor['Status']\n    sensorRecord.CanUpdate = newSensor['CanUpdate'] == \"true\" ? 1 : 0\n    sensorRecord.ReportInterval = newSensor['ReportInterval']\n    sensorRecord.MinimumThreshold = newSensor['MinimumThreshold']\n    sensorRecord.MaximumThreshold = newSensor['MaximumThreshold']\n    sensorRecord.Hysteresis = newSensor['Hysteresis']\n    sensorRecord.Tag = newSensor['Tag']\n    sensorRecord.ActiveStateInterval = newSensor['ActiveStateInterval']\n    sensorRecord.CurrentReading = newSensor['CurrentReading']\n    sensorRecord.BatteryLevel = newSensor['BatteryLevel']\n    sensorRecord.SignalStrength = newSensor['SignalStrength']\n    sensorRecord.AlertsActive = newSensor['AlertsActive']\n    sensorRecord.AccountID = newSensor['AccountID']\n    sensorRecord.CreatedOn = Time.now.getutc\n    sensorRecord.CreatedBy = \"Monnit Open Closed Sensor Job\"\n    sensorRecord.LastModifiedOn = Time.now.getutc\n    sensorRecord.LastModifiedBy = \"Monnit Open Closed Sensor Job\"\n\n    sensorRecord.save\n\n    sensorRecord = nil\n  end\nend\n</code></pre>\n\n<p><strong><em>Job to call controller every minute</em></strong></p>\n\n<pre><code>class MonnitschedulerJob &lt; ApplicationJob\n  queue_as :default\n\n  def perform(*args)\n    m = Monnit.new(\"iMonnit\", 1)\n    getImonnitUsers = ImonnitCredential.select('\"auth_token\", \"username\", \"password\"')\n    getImonnitUsers.each do |user|\n        # puts user[\"auth_token\"]\n        # puts user[\"username\"]\n        # puts user[\"password\"]\n\n        if user[\"auth_token\"] != nil\n            m.logon(user[\"auth_token\"])\n        else\n            auth_token = m.get_auth_token(user[\"username\"], user[\"password\"])\n            auth_token = auth_token[\"Result\"]\n        end\n\n        network_list = m.get_network_list(auth_token)\n        network_list.each do |network|\n            # puts network[\"NetworkID\"]\n            MonnitOpenClosedSensorsController.new.queueNewSensorEvents(auth_token, network[\"NetworkID\"])\n        end\n    end\n  end\nend\n</code></pre>\n\n<p>Sorry about the length of the post.  I tried to include as much information as I could about the code involved. </p>\n\n<p><strong>EDIT</strong></p>\n\n<p>Here is the code for the extended sensor, along with the JSON response:</p>\n\n<pre><code>def get_extended_sensor(auth_token, sensor_id)\n        response = self.class.get(\"/json/SensorGetExtended/#{auth_token}?SensorID=#{sensor_id}\")\n\n        if response['Result'] != \"Invalid Authorization Token\"\n            response['Result']\n        else\n            response['Result']\n        end\n    end\n\n\n{\n    \"Method\": \"SensorGetExtended\",\n    \"Result\": {\n        \"ReportInterval\": 180,\n        \"ActiveStateInterval\": 180,\n        \"InactivityAlert\": 365,\n        \"MeasurementsPerTransmission\": 1,\n        \"MinimumThreshold\": 4294967295,\n        \"MaximumThreshold\": 4294967295,\n        \"Hysteresis\": 0,\n        \"Tag\": \"\",\n        \"SensorID\": 189092,\n        \"MonnitApplicationID\": 9,\n        \"CSNetID\": 24391,\n        \"SensorName\": \"Open / Closed - 189092\",\n        \"LastCommunicationDate\": \"/Date(1500999632000)/\",\n        \"NextCommunicationDate\": \"/Date(1501010432000)/\",\n        \"LastDataMessageMessageGUID\": \"d474b3db-d843-40ba-8e0e-8c4726b61ec2\",\n        \"PowerSourceID\": 1,\n        \"Status\": 0,\n        \"CanUpdate\": true,\n        \"CurrentReading\": \"Open\",\n        \"BatteryLevel\": 100,\n        \"SignalStrength\": 84,\n        \"AlertsActive\": true,\n        \"CheckDigit\": \"QOLP\",\n        \"AccountID\": 14728\n    }\n}\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "migration", "rails-migrations"], "comments": [{"owner": {"reputation": 1049, "user_id": 5353193, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/b427991caffbc88cf5dccfb942f061a2?s=128&d=identicon&r=PG", "display_name": "Francois", "link": "https://stackoverflow.com/users/5353193/francois"}, "edited": false, "score": 0, "creation_date": 1501076075, "post_id": 45328410, "comment_id": 77618663, "body": "Just to make things clearer: you are trying to create data on your local environment and then push it to production, right? I would say that if it&#39;s test data or something like that you should use <code>seeds.rb</code>, this way you&#39;ll be able to recreate your most &quot;basic&quot; environment anywhere. If it&#39;s business related data, migrations are more suitable in my opinion."}, {"owner": {"reputation": 93, "user_id": 2133208, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f6ad1d9b863e61c73a31d1a92f679da?s=128&d=identicon&r=PG", "display_name": "Jo&#227;o Carlos Ottobboni", "link": "https://stackoverflow.com/users/2133208/jo%c3%a3o-carlos-ottobboni"}, "reply_to_user": {"reputation": 1049, "user_id": 5353193, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/b427991caffbc88cf5dccfb942f061a2?s=128&d=identicon&r=PG", "display_name": "Francois", "link": "https://stackoverflow.com/users/5353193/francois"}, "edited": false, "score": 0, "creation_date": 1501080277, "post_id": 45328410, "comment_id": 77622237, "body": "yep this are production data, created localy and then push to production server to create and alter tables in my database on server"}, {"owner": {"reputation": 1049, "user_id": 5353193, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/b427991caffbc88cf5dccfb942f061a2?s=128&d=identicon&r=PG", "display_name": "Francois", "link": "https://stackoverflow.com/users/5353193/francois"}, "edited": false, "score": 0, "creation_date": 1501144191, "post_id": 45328410, "comment_id": 77651893, "body": "In this case, migrations are just fine according to me"}], "answers": [{"tags": [], "owner": {"reputation": 3868, "user_id": 2482094, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/81a0ecf0c7d4d429fafbdbbba490f38c?s=128&d=identicon&r=PG", "display_name": "Piotr Galas", "link": "https://stackoverflow.com/users/2482094/piotr-galas"}, "is_accepted": false, "score": 1, "last_activity_date": 1501100789, "creation_date": 1501100789, "answer_id": 45336759, "question_id": 45328410, "link": "https://stackoverflow.com/questions/45328410/best-practice-for-migrate-data-to-production-database-rails/45336759#45336759", "title": "Best practice for migrate data to production database Rails?", "body": "<p>It is other gem <a href=\"https://github.com/ilyakatz/data-migrate\" rel=\"nofollow noreferrer\">https://github.com/ilyakatz/data-migrate</a>. It works similar to migrations. So one data migration is run only once.  </p>\n"}], "owner": {"reputation": 93, "user_id": 2133208, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f6ad1d9b863e61c73a31d1a92f679da?s=128&d=identicon&r=PG", "display_name": "Jo&#227;o Carlos Ottobboni", "link": "https://stackoverflow.com/users/2133208/jo%c3%a3o-carlos-ottobboni"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 793, "favorite_count": 2, "answer_count": 1, "score": 3, "last_activity_date": 1501100789, "creation_date": 1501075665, "question_id": 45328410, "link": "https://stackoverflow.com/questions/45328410/best-practice-for-migrate-data-to-production-database-rails", "title": "Best practice for migrate data to production database Rails?", "body": "<p>I have an rails 4 app running, with large migrations done, and i need a better way to do some push and update for data in production.</p>\n\n<p>my team use sql in migrations files for update data, but it's no the better aproach to do this, because when i go up this app in other time, i will give a lot of erros, from updates.</p>\n\n<p>i can do rake tasks to do this ponctual updates, but i dont know if this is the better way..</p>\n\n<p>in my research i find this awesome gem:</p>\n\n<p><a href=\"https://github.com/harrystech/seed_migration\" rel=\"nofollow noreferrer\">https://github.com/harrystech/seed_migration</a></p>\n\n<p>to do migrates for data like rails do migration for table structure, but i crashed in other problem:</p>\n\n<p>i have an app with large ammount of migrations files, \nif a use a seed migration gem for generate data for imput i will have an problem  when i need to up my app, because migrations alter table structure, and migration seed try to imput data in old structure.</p>\n\n<p>i think i need a solution with run synchronous with rails migrations to up data to database.</p>\n\n<p>any solution, opinion?? </p>\n"}, {"tags": ["ruby-on-rails", "ruby", "capistrano", "bundler", "puma"], "comments": [{"owner": {"reputation": 2487, "user_id": 8098012, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0cbdb5ca9b079de1c9700271166feead?s=128&d=identicon&r=PG", "display_name": "Pavel Mikhailyuk", "link": "https://stackoverflow.com/users/8098012/pavel-mikhailyuk"}, "edited": false, "score": 0, "creation_date": 1501077468, "post_id": 45328406, "comment_id": 77619850, "body": "I&#39;ve no idea what the reason, but I know the way when it works in production for years without troubles. Just use system way to start/stop/restart/monit daemons. Like SysV, Upstart \u0438 systemd in Debian."}], "owner": {"reputation": 41, "user_id": 3816455, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4826a8cc312af8c117f9eee14b7db1a6?s=128&d=identicon&r=PG", "display_name": "Prashant Vithani", "link": "https://stackoverflow.com/users/3816455/prashant-vithani"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 636, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1501598737, "creation_date": 1501075661, "last_edit_date": 1501598737, "question_id": 45328406, "link": "https://stackoverflow.com/questions/45328406/capistrano-not-able-to-restart-puma-server-after-deploy", "title": "Capistrano not able to restart Puma server after deploy", "body": "<p>Puma: 3.8.2<br>\ncapistrano3-puma: 3.1.1<br>\nRails: 5.0.1<br>\nRuby: 2.3.3</p>\n\n<p>My system configuration contains 3 servers, there's always one or two servers, in which Puma won't restart after deployment. Though, the deployment log says <code>Command restart sent success</code>.</p>\n\n<p>Then, I logged in to all servers, and ran <code>ps aux | grep puma</code>. The output was weird.</p>\n\n<p><strong>Server 1:</strong> puma works fine, restarted successfully at <code>10:06</code> with release <code>20170726095950</code></p>\n\n<pre><code>deploy   21379  0.0  3.5 2119668 274772 ?      Sl   10:06   0:01 puma 3.8.2 (unix:///var/www/fbdash/shared/tmp/sockets/puma.sock) [20170726095950]                                                        \ndeploy   21384  0.7  8.0 2266296 618124 ?      Sl   10:06   0:35 puma: cluster worker 0: 21379 [20170726095950]                                                                                           \ndeploy   21387  0.9  7.9 2269380 607296 ?      Sl   10:06   0:46 puma: cluster worker 1: 21379 [20170726095950]                                                                                           \ndeploy   21390  1.0  7.4 2271436 569760 ?      Sl   10:06   0:48 puma: cluster worker 2: 21379 [20170726095950]                                                                                           \ndeploy   21394  0.8  7.8 2203948 603500 ?      Sl   10:06   0:41 puma: cluster worker 3: 21379 [20170726095950]                                                                                           \ndeploy   25204  0.0  0.0  10484  2260 pts/2    S+   11:26   0:00 grep --color=auto puma\n</code></pre>\n\n<p><strong>Server 2:</strong> Same as server 1, puma works fine, restarted successfully at <code>10:06</code> with release <code>20170726095950</code></p>\n\n<pre><code>deploy   21379  0.0  3.5 2119668 274772 ?      Sl   10:06   0:01 puma 3.8.2 (unix:///var/www/fbdash/shared/tmp/sockets/puma.sock) [20170726095950]                                                        \ndeploy   21384  0.7  8.0 2266296 618124 ?      Sl   10:06   0:35 puma: cluster worker 0: 21379 [20170726095950]                                                                                           \ndeploy   21387  0.9  7.9 2269380 607296 ?      Sl   10:06   0:46 puma: cluster worker 1: 21379 [20170726095950]                                                                                           \ndeploy   21390  1.0  7.4 2271436 569760 ?      Sl   10:06   0:48 puma: cluster worker 2: 21379 [20170726095950]                                                                                           \ndeploy   21394  0.8  7.8 2203948 603500 ?      Sl   10:06   0:41 puma: cluster worker 3: 21379 [20170726095950]                                                                                           \ndeploy   25204  0.0  0.0  10484  2260 pts/2    S+   11:26   0:00 grep --color=auto puma\n</code></pre>\n\n<p><strong><em>Server 3: Two of the clusters stopped (Didn't restart at all), still pointing at old release <code>20170726080157</code></em></strong></p>\n\n<pre><code>deploy   22364  0.0  3.6 2120888 279128 ?      Sl   09:37   0:00 puma 3.8.2 (unix:///var/www/fbdash/shared/tmp/sockets/puma.sock) [20170726080157]                                                                                                                             \ndeploy   22369  0.1  9.3 2405448 719184 ?      Sl   09:37   0:11 puma: cluster worker 0: 22364 [20170726080157]                                                                                                                                                                \ndeploy   22378  0.2 10.9 2538956 838948 ?      Sl   09:37   0:15 puma: cluster worker 3: 22364 [20170726080157]                                                                                                                                                                \ndeploy   30422  0.0  0.0  10484  2160 pts/2    S+   11:26   0:00 grep --color=auto puma\n</code></pre>\n\n<p>This is causing all requests that are directed to this server to timeout with error code HTTP 408.</p>\n\n<hr>\n\n<p>I've also tried <code>cap production puma:stop</code> followed by <code>cap production puma:start</code>, but it's still not working. I had to exlicitly kill the all the old processes with <code>kill -9 PIDs</code>, and then send <code>cap production puma:start</code></p>\n\n<p>So, technically,   </p>\n\n<pre><code>~/.rvm/bin/rvm default do bundle exec pumactl -S /var/www/fbdash/shared/tmp/pids/puma.state -F /var/www/fbdash/shared/puma.rb stop/restart\n</code></pre>\n\n<p>is doing nothing.</p>\n\n<p>Any idea why this is happening?</p>\n\n<hr>\n\n<p>I also found out that Puma workers are not shutting down gracefully when restarted. This is results in old process still running and nginx listening socket in new release folder (Which is not started yet).</p>\n\n<pre><code>[24498] PumaWorkerKiller: Consuming 3081.06640625 mb with master and 4 workers.\n[24498] PumaWorkerKiller: Consuming 3081.06640625 mb with master and 4 workers.\n[24498] PumaWorkerKiller: Consuming 3081.06640625 mb with master and 4 workers.\n[24498] PumaWorkerKiller: Consuming 3081.06640625 mb with master and 4 workers.\n[24498] PumaWorkerKiller: Consuming 3081.06640625 mb with master and 4 workers.\n[24498] - Gracefully shutting down workers...\n[24498] PumaWorkerKiller: Consuming 1250.91796875 mb with master and 4 workers.\n[24498] PumaWorkerKiller: Consuming 1250.91796875 mb with master and 4 workers.\n[24498] PumaWorkerKiller: Consuming 1250.91796875 mb with master and 4 workers.\n[24498] PumaWorkerKiller: Consuming 1250.91796875 mb with master and 4 workers.\n[24498] PumaWorkerKiller: Consuming 1250.91796875 mb with master and 4 workers.\n[24498] PumaWorkerKiller: Consuming 1250.91796875 mb with master and 4 workers.\n</code></pre>\n\n<p>Notice that it says <code>Gracefully shutting down workers</code> but, in the next line the workers still continue using old PID.</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 535, "user_id": 6062167, "user_type": "registered", "accept_rate": 73, "profile_image": "https://lh4.googleusercontent.com/-0HW4IV0DibE/AAAAAAAAAAI/AAAAAAAAA00/-7ApPvfwHBs/photo.jpg?sz=128", "display_name": "Pedro Adame Vergara", "link": "https://stackoverflow.com/users/6062167/pedro-adame-vergara"}, "edited": false, "score": 3, "creation_date": 1501073504, "post_id": 45327280, "comment_id": 77616645, "body": "I recommend you to not use Windows with ruby/rails. Try a Linux virtual machine"}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 8369606, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-BvmlAxBvPFw/AAAAAAAAAAI/AAAAAAAAIQk/R6UdVf1p8-8/photo.jpg?sz=128", "display_name": "Ada Sz", "link": "https://stackoverflow.com/users/8369606/ada-sz"}, "edited": false, "score": 1, "creation_date": 1501186490, "post_id": 45327715, "comment_id": 77681746, "body": "Thank you!! It went a lot better but now when I try &#39;rails new hello_app&#39;, I got info: run bundle install --local /usr/bin/ruby2.3: No such file or directory -- /usr/bin/bundle (LoadError) run bundle exec spring binstub -all /usr/bin/ruby2.3: No such file or directory -- /usr/bin/bundle (LoadError)"}, {"owner": {"reputation": 224, "user_id": 6366616, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lgwr3.jpg?s=128&g=1", "display_name": "Max L.", "link": "https://stackoverflow.com/users/6366616/max-l"}, "reply_to_user": {"reputation": 11, "user_id": 8369606, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-BvmlAxBvPFw/AAAAAAAAAAI/AAAAAAAAIQk/R6UdVf1p8-8/photo.jpg?sz=128", "display_name": "Ada Sz", "link": "https://stackoverflow.com/users/8369606/ada-sz"}, "edited": false, "score": 0, "creation_date": 1501199326, "post_id": 45327715, "comment_id": 77686565, "body": "@AdaSz I&#39;ve edited an answer. If you&#39;ll have new questions, feel free to ask"}], "tags": [], "owner": {"reputation": 224, "user_id": 6366616, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lgwr3.jpg?s=128&g=1", "display_name": "Max L.", "link": "https://stackoverflow.com/users/6366616/max-l"}, "is_accepted": false, "score": 3, "last_activity_date": 1501199160, "last_edit_date": 1501199160, "creation_date": 1501073886, "answer_id": 45327715, "question_id": 45327280, "link": "https://stackoverflow.com/questions/45327280/installing-ruby-failed-to-build-gem-native-extension/45327715#45327715", "title": "Installing Ruby - Failed to build gem native extension", "body": "<p>Try these commands:</p>\n\n<p><code>sudo apt-get install build-essential patch</code></p>\n\n<p><code>sudo apt-get install ruby-dev zlib1g-dev liblzma-dev</code></p>\n\n<p>Hope it will help!</p>\n\n<p>I also recommend you to install <a href=\"https://github.com/rvm/ubuntu_rvm\" rel=\"nofollow noreferrer\">RVM</a>.</p>\n\n<p>Then run <code>rvm install your_version</code> to install an essential ruby version. You can choose any version you need. For instance <code>rvm install 2.4.1</code></p>\n\n<p>After those steps, run following commands:</p>\n\n<p><code>gem install bundler</code></p>\n\n<p><code>gem install rails</code></p>\n"}, {"tags": [], "owner": {"reputation": 111, "user_id": 4180779, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/S0jLE.jpg?s=128&g=1", "display_name": "Bilal Qadri", "link": "https://stackoverflow.com/users/4180779/bilal-qadri"}, "is_accepted": false, "score": 2, "last_activity_date": 1508680466, "creation_date": 1508680466, "answer_id": 46874850, "question_id": 45327280, "link": "https://stackoverflow.com/questions/45327280/installing-ruby-failed-to-build-gem-native-extension/46874850#46874850", "title": "Installing Ruby - Failed to build gem native extension", "body": "<p>You need ruby development files to build (&amp; install) native extensions <br>\n<strong>sudo apt-get install ruby-dev</strong></p>\n"}], "owner": {"reputation": 11, "user_id": 8369606, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-BvmlAxBvPFw/AAAAAAAAAAI/AAAAAAAAIQk/R6UdVf1p8-8/photo.jpg?sz=128", "display_name": "Ada Sz", "link": "https://stackoverflow.com/users/8369606/ada-sz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5107, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1508680466, "creation_date": 1501072796, "last_edit_date": 1501074189, "question_id": 45327280, "link": "https://stackoverflow.com/questions/45327280/installing-ruby-failed-to-build-gem-native-extension", "title": "Installing Ruby - Failed to build gem native extension", "body": "<p>I don't know anything about the stuff that you write here :) I tried to search for answers online, as I usually do, but unfortunately, couldn't find anything specific.</p>\n\n<p>I am trying to install Ruby on Rails, according to a description from here <a href=\"https://www.railstutorial.org/book/beginning\" rel=\"nofollow noreferrer\">Rails Tutorial</a> </p>\n\n<p>I have installed Bash on Ubuntu on Windows. Could you tell me what have I done wrong? Or how can I fix it to install it properly?</p>\n\n<p>when I check ruby version it shows me:</p>\n\n<pre><code>ruby 2.3.1p112 (2016-04-26) [x86-64-linux-gnu]\n</code></pre>\n\n<p>However an error appears:</p>\n\n<pre><code>ERROR: Failed to build gem native extension.\n\ncurrent directory: /var/lib/gems/2.3.0./gems/nio4r-2.1.0/ext/nio4r/usr/bin/ruby2.3 -r ./siteconf20170726-93-g151dm.rb extconf.rb\nmkmf.rb can't find header files for ruby at /usr/lib/ruby/include/ruby.h\n\nextconf failed, exit code 1\n\nGem files will remain installed in /var/lib/gems/2.3.0/gems/nio4r-2.1.0 for inspection.\nResults logged to /var/lib/gems/2.3.0/extensions/x86_64-linux/2.3.0/nio4r-2.1.0/gem_make.out\n</code></pre>\n\n<p>I have also done:</p>\n\n<pre><code>apt-get install make\napt-get install ruby-dev\n</code></pre>\n\n<p>And now something different appeared:</p>\n\n<pre><code>    ERROR: Failed to build gem native extension.\n\n    current directory: /var/lib/gems/2.3.0./gems/nio4r-2.1.0/ext/nio4r/usr/bin/ruby2.3 -r ./siteconf20170726-530-13b2fuh.rb extconf.rb\nchecking for unistd.h...***extconf.rb failed ***\n\nCould not create Makefile due to some reason, probably lack of necessary libraries and/or headers. Check the mkmf.log file for more details. You may need configuration option.\n</code></pre>\n\n<p>The rest of the code can be found in the file - too much things to write by hand. :) <a href=\"https://i.stack.imgur.com/p6Xob.jpg\" rel=\"nofollow noreferrer\">Ruby 2- command line pict</a></p>\n\n<p>Please help!! I want to learn Ruby :) :) </p>\n\n<p>Plus, is there a way to copy command line and to paste it somehow or do I have to put it here letter by letter? :) </p>\n"}, {"tags": ["ruby-on-rails", "ruby", "devise"], "comments": [{"owner": {"reputation": 2216, "user_id": 7165275, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d8ad41f944f38348a30791dc7f7d02c?s=128&d=identicon&r=PG&f=1", "display_name": "m. simon borg", "link": "https://stackoverflow.com/users/7165275/m-simon-borg"}, "edited": false, "score": 0, "creation_date": 1501072656, "post_id": 45327049, "comment_id": 77615919, "body": "can you post your <code>config&#47;routes.rb</code>?"}, {"owner": {"reputation": 32131, "user_id": 2346461, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/i3xAf.jpg?s=128&g=1", "display_name": "Pavan", "link": "https://stackoverflow.com/users/2346461/pavan"}, "edited": false, "score": 0, "creation_date": 1501072658, "post_id": 45327049, "comment_id": 77615925, "body": "Show us your routes."}, {"owner": {"reputation": 1442, "user_id": 2592424, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/zaexb.jpg?s=128&g=1", "display_name": "beckah", "link": "https://stackoverflow.com/users/2592424/beckah"}, "reply_to_user": {"reputation": 2216, "user_id": 7165275, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d8ad41f944f38348a30791dc7f7d02c?s=128&d=identicon&r=PG&f=1", "display_name": "m. simon borg", "link": "https://stackoverflow.com/users/7165275/m-simon-borg"}, "edited": false, "score": 0, "creation_date": 1501072791, "post_id": 45327049, "comment_id": 77616029, "body": "@m.simonborg routes.rb posted! sorry about that."}, {"owner": {"reputation": 10255, "user_id": 1155142, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/c680db41999d478ca34d1a77a470e30d?s=128&d=identicon&r=PG", "display_name": "gabrielhilal", "link": "https://stackoverflow.com/users/1155142/gabrielhilal"}, "edited": false, "score": 0, "creation_date": 1501072824, "post_id": 45327049, "comment_id": 77616061, "body": "<a href=\"https://github.com/RailsApps/rails3-mongoid-devise/issues/4\" rel=\"nofollow noreferrer\">github.com/RailsApps/rails3-mongoid-devise/issues/4</a>"}, {"owner": {"reputation": 2216, "user_id": 7165275, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d8ad41f944f38348a30791dc7f7d02c?s=128&d=identicon&r=PG&f=1", "display_name": "m. simon borg", "link": "https://stackoverflow.com/users/7165275/m-simon-borg"}, "edited": false, "score": 0, "creation_date": 1501072879, "post_id": 45327049, "comment_id": 77616104, "body": "thanks! output of <code>rake routes</code> might be helpful too"}, {"owner": {"reputation": 1442, "user_id": 2592424, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/zaexb.jpg?s=128&g=1", "display_name": "beckah", "link": "https://stackoverflow.com/users/2592424/beckah"}, "reply_to_user": {"reputation": 2216, "user_id": 7165275, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d8ad41f944f38348a30791dc7f7d02c?s=128&d=identicon&r=PG&f=1", "display_name": "m. simon borg", "link": "https://stackoverflow.com/users/7165275/m-simon-borg"}, "edited": false, "score": 0, "creation_date": 1501073106, "post_id": 45327049, "comment_id": 77616293, "body": "@m.simonborg added :)"}, {"owner": {"reputation": 1442, "user_id": 2592424, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/zaexb.jpg?s=128&g=1", "display_name": "beckah", "link": "https://stackoverflow.com/users/2592424/beckah"}, "reply_to_user": {"reputation": 32131, "user_id": 2346461, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/i3xAf.jpg?s=128&g=1", "display_name": "Pavan", "link": "https://stackoverflow.com/users/2346461/pavan"}, "edited": false, "score": 0, "creation_date": 1501073119, "post_id": 45327049, "comment_id": 77616309, "body": "@Pavan add routes. thanks."}, {"owner": {"reputation": 2216, "user_id": 7165275, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d8ad41f944f38348a30791dc7f7d02c?s=128&d=identicon&r=PG&f=1", "display_name": "m. simon borg", "link": "https://stackoverflow.com/users/7165275/m-simon-borg"}, "edited": false, "score": 0, "creation_date": 1501073207, "post_id": 45327049, "comment_id": 77616393, "body": "try <code>redirect_to new_user_session_url</code>"}, {"owner": {"reputation": 32131, "user_id": 2346461, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/i3xAf.jpg?s=128&g=1", "display_name": "Pavan", "link": "https://stackoverflow.com/users/2346461/pavan"}, "edited": false, "score": 0, "creation_date": 1501073453, "post_id": 45327049, "comment_id": 77616606, "body": "Try moving <code>resources :users</code> above <code>devise_for :users</code>"}, {"owner": {"reputation": 1442, "user_id": 2592424, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/zaexb.jpg?s=128&g=1", "display_name": "beckah", "link": "https://stackoverflow.com/users/2592424/beckah"}, "reply_to_user": {"reputation": 2216, "user_id": 7165275, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d8ad41f944f38348a30791dc7f7d02c?s=128&d=identicon&r=PG&f=1", "display_name": "m. simon borg", "link": "https://stackoverflow.com/users/7165275/m-simon-borg"}, "edited": false, "score": 0, "creation_date": 1501073585, "post_id": 45327049, "comment_id": 77616701, "body": "@m.simonborg unfortunately no luck :/"}, {"owner": {"reputation": 1442, "user_id": 2592424, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/zaexb.jpg?s=128&g=1", "display_name": "beckah", "link": "https://stackoverflow.com/users/2592424/beckah"}, "reply_to_user": {"reputation": 32131, "user_id": 2346461, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/i3xAf.jpg?s=128&g=1", "display_name": "Pavan", "link": "https://stackoverflow.com/users/2346461/pavan"}, "edited": false, "score": 0, "creation_date": 1501073641, "post_id": 45327049, "comment_id": 77616745, "body": "@Pavan no luck :/ makes me lose a lot of my <code>devise&#47;user</code> routes.   got the following error: <code>No route matches [GET] &quot;&#47;users&#47;sign_out&quot;</code>"}, {"owner": {"reputation": 2216, "user_id": 7165275, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d8ad41f944f38348a30791dc7f7d02c?s=128&d=identicon&r=PG&f=1", "display_name": "m. simon borg", "link": "https://stackoverflow.com/users/7165275/m-simon-borg"}, "reply_to_user": {"reputation": 32131, "user_id": 2346461, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/i3xAf.jpg?s=128&g=1", "display_name": "Pavan", "link": "https://stackoverflow.com/users/2346461/pavan"}, "edited": false, "score": 0, "creation_date": 1501073644, "post_id": 45327049, "comment_id": 77616751, "body": "I changed that route helper to the proper <code>new_user_session_url</code>, i had a typo before. if that doesn&#39;t work then @Pavan &#39;s suggestion might work"}, {"owner": {"reputation": 32131, "user_id": 2346461, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/i3xAf.jpg?s=128&g=1", "display_name": "Pavan", "link": "https://stackoverflow.com/users/2346461/pavan"}, "edited": false, "score": 0, "creation_date": 1501073842, "post_id": 45327049, "comment_id": 77616889, "body": "Can you post the full error log?"}, {"owner": {"reputation": 2216, "user_id": 7165275, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d8ad41f944f38348a30791dc7f7d02c?s=128&d=identicon&r=PG&f=1", "display_name": "m. simon borg", "link": "https://stackoverflow.com/users/7165275/m-simon-borg"}, "edited": false, "score": 0, "creation_date": 1501074607, "post_id": 45327049, "comment_id": 77617454, "body": "sorry but did you try the correct route helper after i fixed my typo? new_user_session_url should send a GET to users/sign_in"}, {"owner": {"reputation": 1442, "user_id": 2592424, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/zaexb.jpg?s=128&g=1", "display_name": "beckah", "link": "https://stackoverflow.com/users/2592424/beckah"}, "reply_to_user": {"reputation": 2216, "user_id": 7165275, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d8ad41f944f38348a30791dc7f7d02c?s=128&d=identicon&r=PG&f=1", "display_name": "m. simon borg", "link": "https://stackoverflow.com/users/7165275/m-simon-borg"}, "edited": false, "score": 0, "creation_date": 1501075269, "post_id": 45327049, "comment_id": 77618040, "body": "@m.simonborg I tried but with no luck (thank you so much for your help though). puneet18&#39;s comment about changing <code>config.sign_out_via = :delete</code> to <code>config.sign_out_via = :get</code> was the ticket."}], "answers": [{"comments": [{"owner": {"reputation": 1442, "user_id": 2592424, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/zaexb.jpg?s=128&g=1", "display_name": "beckah", "link": "https://stackoverflow.com/users/2592424/beckah"}, "edited": false, "score": 0, "creation_date": 1501073787, "post_id": 45327596, "comment_id": 77616851, "body": "this results in <code>No route matches [GET] &quot;&#47;users&#47;sign_out&quot;</code> unfortunately"}, {"owner": {"reputation": 4527, "user_id": 5497690, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/577c8ad14fffb59cd619e43634c51dad?s=128&d=identicon&r=PG&f=1", "display_name": "puneet18", "link": "https://stackoverflow.com/users/5497690/puneet18"}, "reply_to_user": {"reputation": 1442, "user_id": 2592424, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/zaexb.jpg?s=128&g=1", "display_name": "beckah", "link": "https://stackoverflow.com/users/2592424/beckah"}, "edited": false, "score": 1, "creation_date": 1501073892, "post_id": 45327596, "comment_id": 77616925, "body": "goto <code>config&#47;initalizer&#47;devise.rb</code> and change line <code>config.sign_out_via = :delete</code> to <code>config.sign_out_via = :get</code>"}, {"owner": {"reputation": 4207, "user_id": 364590, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/995d983b3912d10c0f05feb8d2d70c54?s=128&d=identicon&r=PG", "display_name": "Fa11enAngel", "link": "https://stackoverflow.com/users/364590/fa11enangel"}, "edited": false, "score": 0, "creation_date": 1518975992, "post_id": 45327596, "comment_id": 84712792, "body": "No, they are not in conflict. You have to use <code>devise_for :users</code>  first and then <code>resources :users</code>afterwards. I&#39;m using ruby 2.4.x and 2.5.x with rails 4.2.x to 5.1.5 on different applications."}], "tags": [], "owner": {"reputation": 4527, "user_id": 5497690, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/577c8ad14fffb59cd619e43634c51dad?s=128&d=identicon&r=PG&f=1", "display_name": "puneet18", "link": "https://stackoverflow.com/users/5497690/puneet18"}, "is_accepted": true, "score": 1, "last_activity_date": 1501081627, "last_edit_date": 1592644375, "creation_date": 1501073583, "answer_id": 45327596, "question_id": 45327049, "link": "https://stackoverflow.com/questions/45327049/on-destroying-session-via-devise-couldnt-find-user-with-id-sign-out/45327596#45327596", "title": "On destroying session via Devise &quot;Couldn&#39;t find User with &#39;id&#39;=sign_out&quot;", "body": "<p><code>resources :users</code> and <code>devise_for :users</code> are conflict so</p>\n<p>try below code:</p>\n<h1>routes.rb</h1>\n<pre><code>Rails.application.routes.draw do\n  root to: 'visitors#index'\n  devise_for :users\n  #resources :users //comment the users resources because its already used by devise_for or used some other resources for users\n\n\n  get &quot;home/index&quot;\n  get &quot;home/minor&quot;\n  root to: 'home#index'\n\nend\n</code></pre>\n<p>Additionally, in your <code>config/initalizer/devise.rb</code> file</p>\n<p>Change <code>config.sign_out_via = :delete</code> to <code>config.sign_out_via = :get</code></p>\n"}, {"comments": [{"owner": {"reputation": 174, "user_id": 5355691, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-zrrEfM6LUWc/AAAAAAAAAAI/AAAAAAAAABI/fDweXzZWooM/photo.jpg?sz=128", "display_name": "Jarvis Johnson", "link": "https://stackoverflow.com/users/5355691/jarvis-johnson"}, "edited": false, "score": 0, "creation_date": 1540953932, "post_id": 48854893, "comment_id": 93049204, "body": "The above is true for Rails 5.1 + if you are using webpacker for asset compilation, otherwise, the <code>jquery_ujs</code> method is still the way to go. For me, I needed that, I did not use <code>sign_out_via = :get</code>, but I had to ensure my devise sign out link included <code>method: :delete</code> ala <code>= link_to(&#39;Logout&#39;, destroy_user_session_path, class: &#39;nav__link&#39;, method: :delete)</code>"}], "tags": [], "owner": {"reputation": 4207, "user_id": 364590, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/995d983b3912d10c0f05feb8d2d70c54?s=128&d=identicon&r=PG", "display_name": "Fa11enAngel", "link": "https://stackoverflow.com/users/364590/fa11enangel"}, "is_accepted": false, "score": 2, "last_activity_date": 1531595480, "last_edit_date": 1531595480, "creation_date": 1518976930, "answer_id": 48854893, "question_id": 45327049, "link": "https://stackoverflow.com/questions/45327049/on-destroying-session-via-devise-couldnt-find-user-with-id-sign-out/48854893#48854893", "title": "On destroying session via Devise &quot;Couldn&#39;t find User with &#39;id&#39;=sign_out&quot;", "body": "<p>You've done everything right. The only missing thing is the <code>:method =&gt; :delete</code> call. This is rails specific and you need <em>rails-ujs</em> or for older rails version <em>jquery_ujs</em> to make it work.</p>\n\n<p>Add this to your <em>app/assets/javascripts/application.js</em>:</p>\n\n<pre><code># for rails 5.1 or higher\n//= require rails-ujs\n\n# for rails 5.0 or lower\n//= require jquery\n//= require jquery_ujs\n</code></pre>\n\n<p>If you don't add this, the <code>method: :delete</code> call will not work. If you don't want to use it at all, then change sign_out to work with <em>GET</em>.</p>\n\n<p>Change or add this to your <em>config/initializers/devise.rb</em>:</p>\n\n<pre><code>config.sign_out_via = :get\n</code></pre>\n\n<p>If it's still not working, then you have the wrong order in your <em>config/routes.rb</em> file. <code>devise_for :users</code> must be before <code>resources :users</code>:</p>\n\n<pre><code>devise_for :users\nresources :users\n</code></pre>\n"}], "owner": {"reputation": 1442, "user_id": 2592424, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/zaexb.jpg?s=128&g=1", "display_name": "beckah", "link": "https://stackoverflow.com/users/2592424/beckah"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 669, "favorite_count": 0, "accepted_answer_id": 45327596, "answer_count": 2, "score": 1, "last_activity_date": 1531595480, "creation_date": 1501072198, "last_edit_date": 1501073088, "question_id": 45327049, "link": "https://stackoverflow.com/questions/45327049/on-destroying-session-via-devise-couldnt-find-user-with-id-sign-out", "title": "On destroying session via Devise &quot;Couldn&#39;t find User with &#39;id&#39;=sign_out&quot;", "body": "<p>I'm running Rails 5.1.2 and Ruby 2.4.0.</p>\n\n<p>I've created a method in the ApplicationController called <code>require_login</code> that checks if the user is logged in order not. If and only if they aren't logged in, they are forwarded to the login page.</p>\n\n<p>The problem is that when I sign them out, I get the following error</p>\n\n<pre><code>ActiveRecord::RecordNotFound at /users/sign_out\nCouldn't find User with 'id'=sign_out\n</code></pre>\n\n<p>With the culprit line being:</p>\n\n<pre><code>def show\n    @user = User.find(params[:id]) # right here\n    authorize @user\nend\n</code></pre>\n\n<p>from my UserController.</p>\n\n<p>This is my code:</p>\n\n<p><strong>ApplicationController</strong></p>\n\n<pre><code>class ApplicationController &lt; ActionController::Base\n  protect_from_forgery with: :exception\n  before_action :configure_permitted_parameters, if: :devise_controller?\n  include Pundit\n\n  protected\n\n  def configure_permitted_parameters\n    devise_parameter_sanitizer.permit(:sign_up, keys: [:name])\n    devise_parameter_sanitizer.permit(:account_update, keys: [:name])\n  end\n\n  def require_login\n    unless signed_in?\n      flash[:error] = \"You must be logged in to access this section\"\n      redirect_to login_path # halts request cycle\n    end\n  end\n\nend\n</code></pre>\n\n<p><strong>UsersController</strong></p>\n\n<pre><code>class UsersController &lt; ApplicationController\n  before_action :require_login\n\n  def index\n    @users = User.all\n    authorize User\n  end\n\n  def show\n    @user = User.find(params[:id])\n    authorize @user\n  end\n\n  def update\n    @user = User.find(params[:id])\n    authorize @user\n    if @user.update_attributes(secure_params)\n      redirect_to users_path, :notice =&gt; \"User updated.\"\n    else\n      redirect_to users_path, :alert =&gt; \"Unable to update user.\"\n    end\n  end\n\n  def destroy\n    user = User.find(params[:id])\n    authorize user\n    user.destroy\n    redirect_to users_path, :notice =&gt; \"User deleted.\"\n  end\n\n  private\n\n  def secure_params\n    params.require(:user).permit(:role)\n  end\n\nend\n</code></pre>\n\n<p>My <strong>layouts/topnav.html.erb</strong> where someone can sign out</p>\n\n<pre><code>&lt;div class=\"row border-bottom\"&gt;\n    &lt;nav class=\"navbar navbar-static-top white-bg\" role=\"navigation\" style=\"margin-bottom: 0\"&gt;\n        &lt;div class=\"navbar-header\"&gt;\n            &lt;a class=\"navbar-minimalize minimalize-styl-2 btn btn-primary \" href=\"#\"&gt;&lt;i class=\"fa fa-bars\"&gt;&lt;/i&gt; &lt;/a&gt;\n            &lt;form role=\"search\" class=\"navbar-form-custom\" method=\"post\" action=\"/\"&gt;\n                &lt;div class=\"form-group\"&gt;\n                    &lt;input type=\"text\" placeholder=\"Search for something...\" class=\"form-control\" name=\"top-search\" id=\"top-search\" /&gt;\n                &lt;/div&gt;\n            &lt;/form&gt;\n        &lt;/div&gt;\n        &lt;ul class=\"nav navbar-top-links navbar-right\"&gt;\n            &lt;li&gt;\n                &lt;%= link_to 'Sign out', destroy_user_session_path, :method=&gt;'delete' %&gt;\n            &lt;/li&gt;\n        &lt;/ul&gt;\n    &lt;/nav&gt;\n&lt;/div&gt;\n</code></pre>\n\n<p>My <strong>routes.rb</strong></p>\n\n<pre><code>Rails.application.routes.draw do\n  root to: 'visitors#index'\n  devise_for :users\n  resources :users\n\n\n  get \"home/index\"\n  get \"home/minor\"\n  root to: 'home#index'\n\nend\n</code></pre>\n\n<p>Also <code>rake routes</code> outputs the following:</p>\n\n<pre><code>                  Prefix Verb   URI Pattern                    Controller#Action\n                    root GET    /                              visitors#index\n        new_user_session GET    /users/sign_in(.:format)       devise/sessions#new\n            user_session POST   /users/sign_in(.:format)       devise/sessions#create\n    destroy_user_session DELETE /users/sign_out(.:format)      devise/sessions#destroy\n       new_user_password GET    /users/password/new(.:format)  devise/passwords#new\n      edit_user_password GET    /users/password/edit(.:format) devise/passwords#edit\n           user_password PATCH  /users/password(.:format)      devise/passwords#update\n                         PUT    /users/password(.:format)      devise/passwords#update\n                         POST   /users/password(.:format)      devise/passwords#create\ncancel_user_registration GET    /users/cancel(.:format)        devise/registrations#cancel\n   new_user_registration GET    /users/sign_up(.:format)       devise/registrations#new\n  edit_user_registration GET    /users/edit(.:format)          devise/registrations#edit\n       user_registration PATCH  /users(.:format)               devise/registrations#update\n                         PUT    /users(.:format)               devise/registrations#update\n                         DELETE /users(.:format)               devise/registrations#destroy\n                         POST   /users(.:format)               devise/registrations#create\n                   users GET    /users(.:format)               users#index\n                         POST   /users(.:format)               users#create\n                new_user GET    /users/new(.:format)           users#new\n               edit_user GET    /users/:id/edit(.:format)      users#edit\n                    user GET    /users/:id(.:format)           users#show\n                         PATCH  /users/:id(.:format)           users#update\n                         PUT    /users/:id(.:format)           users#update\n                         DELETE /users/:id(.:format)           users#destroy\n                    page GET    /pages/*id                     high_voltage/pages#show\n</code></pre>\n\n<p>What can I do in order for a person to get forwarded to the Login page if they are not authenticated and how can I probably destroy their session so that when they sign out they are properly forwarded to the login page?</p>\n"}, {"tags": ["ruby", "postgresql", "sql-parametrized-query", "hanami"], "answers": [{"tags": [], "owner": {"reputation": 1175, "user_id": 666135, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2eec8d25158558a8889b6a632b973852?s=128&d=identicon&r=PG", "display_name": "Nikita Shilnikov", "link": "https://stackoverflow.com/users/666135/nikita-shilnikov"}, "is_accepted": false, "score": 1, "last_activity_date": 1501185221, "creation_date": 1501185221, "answer_id": 45359896, "question_id": 45326110, "link": "https://stackoverflow.com/questions/45326110/using-parameterized-views-with-hanami-repositories/45359896#45359896", "title": "Using parameterized views with Hanami repositories", "body": "<p>PostgreSQL doesn't support parameterized views in the way you described. It can have views that call a function which in order can access the current session state and you can set that state just <em>before</em> selecting data from the view. However, I'd recommend you define a method with an argument instead</p>\n\n<pre><code>class UserRepo\n  def user_details(prefix)\n    root.project { [id, user_name] }.where { user_name.ilike(\"#{ prefix }%\") }.to_a\n  end\nend\n</code></pre>\n\n<p>What you get with this is basically the same. If you want to use <code>user_details</code> as a base relation you can define a private method on the repo and call it from other public methods</p>\n\n<pre><code>class UserRepo\n  def user_details_filtered(user_name, min_user_id = 0)\n    user_details(prefix).where { id &gt; min_user_id }.to_a\n  end\n\n  def user_details_created_after(user_name, after)\n    user_details(prefix).where { created_at &gt; after }.to_a\n  end\n\n  private \n\n  # Don't call this method from the app code, this way\n  # you don't leak SQL-specific code into your domain\n  def user_details(prefix)\n    root.project { [id, user_name] }.where { user_name.ilike(\"#{ prefix }%\") }\n  end\nend\n</code></pre>\n"}], "owner": {"reputation": 183, "user_id": 4592096, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/af89de25ba36e49b6b950b5c0536831a?s=128&d=identicon&r=PG&f=1", "display_name": "dewastator", "link": "https://stackoverflow.com/users/4592096/dewastator"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 68, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1501185221, "creation_date": 1501069787, "question_id": 45326110, "link": "https://stackoverflow.com/questions/45326110/using-parameterized-views-with-hanami-repositories", "title": "Using parameterized views with Hanami repositories", "body": "<p>I prepared view in my PostgresDB called <code>user_details</code>. I created <code>UserDetail</code> entity and <code>UserDetailRepository</code>. Here you have shortened version of my view to visualize my problem:</p>\n\n<pre><code>CREATE VIEW user_details AS\nSELECT id, user_name FROM users WHERE user_name like '$1#%'\n</code></pre>\n\n<p>My question is how to inject parameter using Hanami repository? </p>\n\n<p>I can use raw sql in my repos which is described here <a href=\"http://hanamirb.org/guides/models/repositories/\" rel=\"nofollow noreferrer\">http://hanamirb.org/guides/models/repositories/</a> but I prefer to create view in postgres using migrations. I don't want to improve query but to know if I can user parameterized queries with Hanami. Thanks for all answers</p>\n"}, {"tags": ["ruby", "amazon-web-services", "amazon-cloudfront"], "answers": [{"tags": [], "owner": {"reputation": 10274, "user_id": 930207, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oy7Q3.png?s=128&g=1", "display_name": "mcfinnigan", "link": "https://stackoverflow.com/users/930207/mcfinnigan"}, "is_accepted": false, "score": 0, "last_activity_date": 1501069386, "creation_date": 1501069386, "answer_id": 45325961, "question_id": 45325211, "link": "https://stackoverflow.com/questions/45325211/ruby-gem-to-invalidate-cloudfront-distribution/45325961#45325961", "title": "Ruby gem to invalidate CloudFront Distribution?", "body": "<p><a href=\"https://rubygems.org/gems/aws-sdk\" rel=\"nofollow noreferrer\">https://rubygems.org/gems/aws-sdk</a></p>\n\n<p>Specifically the cloudfront module:  </p>\n\n<p><a href=\"https://docs.aws.amazon.com/sdkforruby/api/Aws/CloudFront.html\" rel=\"nofollow noreferrer\">https://docs.aws.amazon.com/sdkforruby/api/Aws/CloudFront.html</a></p>\n\n<p>This should give you full CLI control of your cloudfront resources provided you have the correct IAM roles etc set up.</p>\n"}, {"tags": [], "owner": {"reputation": 916, "user_id": 910295, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a971068b99452ac8e25d42e15c05263d?s=128&d=identicon&r=PG", "display_name": "Nathan Colgate", "link": "https://stackoverflow.com/users/910295/nathan-colgate"}, "is_accepted": false, "score": 1, "last_activity_date": 1563205883, "creation_date": 1563205883, "answer_id": 57043274, "question_id": 45325211, "link": "https://stackoverflow.com/questions/45325211/ruby-gem-to-invalidate-cloudfront-distribution/57043274#57043274", "title": "Ruby gem to invalidate CloudFront Distribution?", "body": "<p>Here's the little script we ended up using to invalidate the entire cache:</p>\n\n<pre><code>require 'aws-sdk-cloudfront'\n\ncf = Aws::CloudFront::Client.new(\n  access_key_id: ENV['FOG_AWS_ACCESS_KEY_ID'],\n  secret_access_key: ENV['FOG_AWS_SECRET_ACCESS_KEY'],\n  region: ENV['FOG_REGION']\n)\n\nresp = cf.create_invalidation({\n  distribution_id: ENV['FOG_DISTRIBUTION_ID'], # required\n  invalidation_batch: { # required\n    paths: { # required\n      quantity: 1, # required\n      items: [\"/*\"],\n    },\n    caller_reference: DateTime.now.to_s, # required\n  },\n})\n\nif resp.is_a?(Seahorse::Client::Response)\n  puts \"Invalidation #{resp.invalidation.id} has been created. Please wait about 60 seconds for it to finish.\"\nelse\n  puts \"ERROR\"\nend \n</code></pre>\n"}], "owner": {"reputation": 465, "user_id": 683587, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b4941a00db312734af5881ce484755e7?s=128&d=identicon&r=PG", "display_name": "nikstep", "link": "https://stackoverflow.com/users/683587/nikstep"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 166, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1563205883, "creation_date": 1501067405, "question_id": 45325211, "link": "https://stackoverflow.com/questions/45325211/ruby-gem-to-invalidate-cloudfront-distribution", "title": "Ruby gem to invalidate CloudFront Distribution?", "body": "<p>I have tried all the gems I can find on Google and Stackoverflow, they all seems to be outdated and unmaintained, so what is the simplest way to invalidate a CloudFront distribution from Ruby?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "nginx", "capistrano", "unicorn"], "comments": [{"owner": {"reputation": 643, "user_id": 2148560, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/104ea27c9f86094417685ce999daa2ea?s=128&d=identicon&r=PG", "display_name": "Sanjiv", "link": "https://stackoverflow.com/users/2148560/sanjiv"}, "edited": false, "score": 0, "creation_date": 1501066651, "post_id": 45324627, "comment_id": 77611412, "body": "By seeing your log file, it seem that you are binding Unicorn on socket connection. Can you check if any instances of unicorn is already running?"}, {"owner": {"reputation": 40732, "user_id": 984621, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/817afccebcbe3a4983a5e8c584f30373?s=128&d=identicon&r=PG", "display_name": "user984621", "link": "https://stackoverflow.com/users/984621/user984621"}, "reply_to_user": {"reputation": 643, "user_id": 2148560, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/104ea27c9f86094417685ce999daa2ea?s=128&d=identicon&r=PG", "display_name": "Sanjiv", "link": "https://stackoverflow.com/users/2148560/sanjiv"}, "edited": false, "score": 0, "creation_date": 1501067775, "post_id": 45324627, "comment_id": 77612239, "body": "Hi @Sanjiv, please, see the updated OP. I have added there the output from <code>ps aux --sort=-pcpu | grep &#39;%CPU\\|unicorn&#39;</code>."}, {"owner": {"reputation": 643, "user_id": 2148560, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/104ea27c9f86094417685ce999daa2ea?s=128&d=identicon&r=PG", "display_name": "Sanjiv", "link": "https://stackoverflow.com/users/2148560/sanjiv"}, "edited": false, "score": 0, "creation_date": 1501068067, "post_id": 45324627, "comment_id": 77612462, "body": "So unicorn is already running and you again trying to start unicorn?. Then it is expected to fail as it is already running."}, {"owner": {"reputation": 40732, "user_id": 984621, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/817afccebcbe3a4983a5e8c584f30373?s=128&d=identicon&r=PG", "display_name": "user984621", "link": "https://stackoverflow.com/users/984621/user984621"}, "reply_to_user": {"reputation": 643, "user_id": 2148560, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/104ea27c9f86094417685ce999daa2ea?s=128&d=identicon&r=PG", "display_name": "Sanjiv", "link": "https://stackoverflow.com/users/2148560/sanjiv"}, "edited": false, "score": 0, "creation_date": 1501068428, "post_id": 45324627, "comment_id": 77612731, "body": "ok, I am going to manually kill them and will try to deploy it again"}], "owner": {"reputation": 40732, "user_id": 984621, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/817afccebcbe3a4983a5e8c584f30373?s=128&d=identicon&r=PG", "display_name": "user984621", "link": "https://stackoverflow.com/users/984621/user984621"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 370, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1501067738, "creation_date": 1501065779, "last_edit_date": 1501067738, "question_id": 45324627, "link": "https://stackoverflow.com/questions/45324627/capistrano-cannot-start-unicorn", "title": "Capistrano: cannot start unicorn", "body": "<p>I am having difficulties to (re)start Unicorn as I am deploying with Capistrano as well as manually.</p>\n\n<p>This is <code>deploy.rb</code>:</p>\n\n<pre><code># config valid only for current version of Capistrano\nlock \"3.8.1\"\n\nset :application, \"project\"\nset :repo_url, \"git@bitbucket.org:username/project.git\"\nset :branch, \"master\"\nset :tmp_dir, '/home/deployer/tmp'\n\nset :deploy_to, \"/home/deployer/apps/project\"\nset :keep_releases, 5\n\n\nset(:executable_config_files, %w(\n  unicorn_init.sh\n))\n\n# files which need to be symlinked to other parts of the\n# filesystem. For example nginx virtualhosts, log rotation\n# init scripts etc.\nset(:symlinks, [\n  {\n    source: \"nginx.conf\",\n    link: \"/etc/nginx/sites-enabled/default\"\n  },\n  {\n    source: \"unicorn_init.sh\",\n    link: \"/etc/init.d/unicorn_#{fetch(:application)}\"\n  },\n  {\n    source: \"log_rotation\",\n   link: \"/etc/logrotate.d/#{fetch(:application)}\"\n  },\n  {\n    source: \"monit\",\n    link: \"/etc/monit/conf.d/#{fetch(:application)}.conf\"\n  }\n])\n\n\nnamespace :deploy do    \n  desc 'Restart application'\n  task :restart do\n    on roles(:app), in: :sequence, wait: 5 do\n      invoke 'unicorn:restart'\n\n    end\n  end\n  after :publishing, :restart\n\n  after :restart, :clear_cache do\n    on roles(:web), in: :groups, limit: 3, wait: 10 do\n      # Here we can do anything such as:\n      # within release_path do\n      #   execute :rake, 'cache:clear'\n      # end\n    end\n  end  \n\n  desc \"Make sure local git is in sync with remote.\"\n  task :check_revision do\n    on roles(:web) do\n      unless `git rev-parse HEAD` == `git rev-parse origin/master`\n        puts \"WARNING: HEAD is not the same as origin/master\"\n        puts \"Run `git push` to sync changes.\"\n        exit\n      end\n    end\n  end\n  before \"deploy\", \"deploy:check_revision\"\nend\n</code></pre>\n\n<p>And during this process of deploying, here's the error that Capistrano gives me:</p>\n\n<pre><code>SSHKit::Runner::ExecuteError: Exception while executing as deployer@IP: Exception while executing as deployer@IP: bundle exit status: 1\nbundle stdout: Nothing written\nbundle stderr: master failed to start, check stderr log for details\n</code></pre>\n\n<p>And here's the unicorn log:</p>\n\n<pre><code>    I, [2017-07-26T09:27:41.274475 #21301]  INFO -- : Refreshing Gem list\n    E, [2017-07-26T09:27:44.101407 #21301] ERROR -- : adding listener failed addr=/tmp/unicorn.project.sock (in use)\n    E, [2017-07-26T09:27:44.101620 #21301] ERROR -- : retrying in 0.5 seconds (4 tries left)\n    E, [2017-07-26T09:27:44.602753 #21301] ERROR -- : adding listener failed addr=/tmp/unicorn.project.sock (in use)\n    E, [2017-07-26T09:27:44.603927 #21301] ERROR -- : retrying in 0.5 seconds (3 tries left)\n    E, [2017-07-26T09:27:45.106551 #21301] ERROR -- : adding listener failed addr=/tmp/unicorn.project.sock (in use)\n    E, [2017-07-26T09:27:45.107051 #21301] ERROR -- : retrying in 0.5 seconds (2 tries left)\n    E, [2017-07-26T09:27:45.608434 #21301] ERROR -- : adding listener failed addr=/tmp/unicorn.project.sock (in use)\n    E, [2017-07-26T09:27:45.608617 #21301] ERROR -- : retrying in 0.5 seconds (1 tries left)\n    E, [2017-07-26T09:27:46.109480 #21301] ERROR -- : adding listener failed addr=/tmp/unicorn.project.sock (in use)\n    E, [2017-07-26T09:27:46.109664 #21301] ERROR -- : retrying in 0.5 seconds (0 tries left)\n    E, [2017-07-26T09:27:46.611021 #21301] ERROR -- : adding listener failed addr=/tmp/unicorn.project.sock (in use)\n    bundler: failed to load command: unicorn (/home/deployer/apps/project/shared/bundle/ruby/2.4.0/bin/unicorn)\n    Errno::EADDRINUSE: Address already in use - connect(2) for /tmp/unicorn.project.sock\n      /home/deployer/apps/project/shared/bundle/ruby/2.4.0/gems/unicorn-5.2.0/lib/unicorn/socket_helper.rb:122:in `initialize'\n\nIt says **    Errno::EADDRINUSE: Address already in use - connect(2) for /tmp/unicorn.project.sock** -- however, what does it mean exactly? How to fix it?\n\nI tried to run Unicorn also manually from the server - `bundle exec unicorn -D -c config/unicorn/production.rb -E production`, but only got\n\n&gt; master failed to start, check stderr log for details\n\nthat's pointing out on the error message from the log above.\n</code></pre>\n\n<p><strong>EDIT:</strong> Instances of Unicorn</p>\n\n<pre><code>USER       PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND\nrails     2134  0.0  0.5  13620  5640 ?        Ss   Jul24   0:00 /bin/bash /home/rails/rails_project/.unicorn.sh\nrails     2347  0.0  1.6  91052 17136 ?        Sl   Jul24   0:04 unicorn master -c /etc/unicorn.conf -E production --debug\nrails     2349  0.0  7.3 270292 74716 ?        Sl   Jul24   0:10 unicorn worker[0] -c /etc/unicorn.conf -E production --debug\nrails     2352  0.0  7.5 270420 77188 ?        Sl   Jul24   0:09 unicorn worker[1] -c /etc/unicorn.conf -E production --debug\nrails     2354  0.0  7.4 270628 75236 ?        Sl   Jul24   0:09 unicorn worker[2] -c /etc/unicorn.conf -E production --debug\nrails     2358  0.0  7.6 270288 77312 ?        Sl   Jul24   0:10 unicorn worker[3] -c /etc/unicorn.conf -E production --debug\ndeployer  9330  0.0  7.9 269032 80364 ?        Sl   08:36   0:02 unicorn master -c /home/deployer/apps/project/current/config/unicorn/production.rb -E deployment -D\ndeployer  9334  0.0  7.2 269560 73800 ?        Sl   08:36   0:00 unicorn worker[0] -c /home/deployer/apps/project/current/config/unicorn/production.rb -E deployment -D\ndeployer  9337  0.0  7.2 269560 73800 ?        Sl   08:36   0:00 unicorn worker[1] -c /home/deployer/apps/project/current/config/unicorn/production.rb -E deployment -D\ndeployer  9340  0.0  7.2 269560 73748 ?        Sl   08:36   0:00 unicorn worker[2] -c /home/deployer/apps/project/current/config/unicorn/production.rb -E deployment -D\ndeployer 24279  0.0  0.1  12948  1080 pts/0    S+   11:13   0:00 grep --color=auto %CPU\\|unicorn\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "heroku"], "comments": [{"owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 2, "creation_date": 1501066711, "post_id": 45324531, "comment_id": 77611459, "body": "Did you have a look at devcenter.heroku.com/articles/ruby-support#supported-runtime&zwnj;&#8203;\u200c\u200bs ? Ruby 1.9.3 reached end of life years ago and is not supported anymore by Heroku&#39;s current stack. You might want to upgrade to a supported version or use an older stack."}, {"owner": {"reputation": 537, "user_id": 4289112, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/spCU9.jpg?s=128&g=1", "display_name": "Mirv - Matt", "link": "https://stackoverflow.com/users/4289112/mirv-matt"}, "edited": false, "score": 0, "creation_date": 1501266567, "post_id": 45324531, "comment_id": 77721821, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/45228434/errors-in-gemfile\">Errors in Gemfile</a>"}], "answers": [{"comments": [{"owner": {"reputation": 29107, "user_id": 122080, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/6fa1cdda524d49996a8bc6917328de3d?s=128&d=identicon&r=PG", "display_name": "Damien MATHIEU", "link": "https://stackoverflow.com/users/122080/damien-mathieu"}, "reply_to_user": {"reputation": 277, "user_id": 4480681, "user_type": "registered", "accept_rate": 32, "profile_image": "https://www.gravatar.com/avatar/3bed032a78ca8ce9381384e5865bc2c8?s=128&d=identicon&r=PG&f=1", "display_name": "Rodrigo", "link": "https://stackoverflow.com/users/4480681/rodrigo"}, "edited": false, "score": 0, "creation_date": 1501072125, "post_id": 45325983, "comment_id": 77615480, "body": "Yes. Using a ruby version that&#39;s been marked as End of Life for several years is very bad anyway. There could be security issues, and they will never be fixed."}, {"owner": {"reputation": 537, "user_id": 4289112, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/spCU9.jpg?s=128&g=1", "display_name": "Mirv - Matt", "link": "https://stackoverflow.com/users/4289112/mirv-matt"}, "edited": false, "score": 0, "creation_date": 1502881453, "post_id": 45325983, "comment_id": 78381643, "body": "No, not the only solution - the the whole reason we use a gemfile is to get around issues like this &amp; heroku has a long list of runtimes for this reason."}, {"owner": {"reputation": 29107, "user_id": 122080, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/6fa1cdda524d49996a8bc6917328de3d?s=128&d=identicon&r=PG", "display_name": "Damien MATHIEU", "link": "https://stackoverflow.com/users/122080/damien-mathieu"}, "edited": false, "score": 0, "creation_date": 1502957277, "post_id": 45325983, "comment_id": 78417020, "body": "Heroku has a list of supported runtimes, but 1.9.x is not one of them anymore. <a href=\"https://devcenter.heroku.com/articles/ruby-support#supported-runtimes\" rel=\"nofollow noreferrer\">devcenter.heroku.com/articles/ruby-support#supported-runtime&zwnj;&#8203;s</a>"}], "tags": [], "owner": {"reputation": 29107, "user_id": 122080, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/6fa1cdda524d49996a8bc6917328de3d?s=128&d=identicon&r=PG", "display_name": "Damien MATHIEU", "link": "https://stackoverflow.com/users/122080/damien-mathieu"}, "is_accepted": false, "score": -1, "last_activity_date": 1501069450, "creation_date": 1501069450, "answer_id": 45325983, "question_id": 45324531, "link": "https://stackoverflow.com/questions/45324531/heroku-ror-project-deployment-an-error-occurred-while-installing-ruby-1-9-3-p5/45325983#45325983", "title": "Heroku RoR project deployment : An error occurred while installing ruby-1.9.3-p551", "body": "<p>Ruby 1.9.1 reached EOL many years ago, and is not supported by Heroku anymore.<br>\nYou should upgrade your ruby version.</p>\n"}, {"tags": [], "owner": {"reputation": 537, "user_id": 4289112, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/spCU9.jpg?s=128&g=1", "display_name": "Mirv - Matt", "link": "https://stackoverflow.com/users/4289112/mirv-matt"}, "is_accepted": false, "score": 0, "last_activity_date": 1501266430, "creation_date": 1501266430, "answer_id": 45380141, "question_id": 45324531, "link": "https://stackoverflow.com/questions/45324531/heroku-ror-project-deployment-an-error-occurred-while-installing-ruby-1-9-3-p5/45380141#45380141", "title": "Heroku RoR project deployment : An error occurred while installing ruby-1.9.3-p551", "body": "<p>Specifically you have to tell heroku to give you the ubuntu server build with cedar-14 &amp; then ensure the <code>gemfile</code> is reflected in the <code>gemfile.lock</code></p>\n\n<p>Details on here ... <a href=\"https://stackoverflow.com/questions/45228434/errors-in-gemfile\">Errors in Gemfile</a></p>\n\n<p>This page contains details on what you need ... <a href=\"https://devcenter.heroku.com/articles/ruby-support#supported-runtimes\" rel=\"nofollow noreferrer\">https://devcenter.heroku.com/articles/ruby-support#supported-runtimes</a></p>\n"}], "owner": {"reputation": 277, "user_id": 4480681, "user_type": "registered", "accept_rate": 32, "profile_image": "https://www.gravatar.com/avatar/3bed032a78ca8ce9381384e5865bc2c8?s=128&d=identicon&r=PG&f=1", "display_name": "Rodrigo", "link": "https://stackoverflow.com/users/4480681/rodrigo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 293, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1501266430, "creation_date": 1501065514, "question_id": 45324531, "link": "https://stackoverflow.com/questions/45324531/heroku-ror-project-deployment-an-error-occurred-while-installing-ruby-1-9-3-p5", "title": "Heroku RoR project deployment : An error occurred while installing ruby-1.9.3-p551", "body": "<p>I am trying to deploy Ruby on Rails project with Ruby-1.9.3-p551 version but it fails on installing Ruby 1.9.3 version giving the error below:</p>\n\n<pre><code> !     An error occurred while installing ruby-1.9.3-p551\n !     \n !     Heroku recommends you use the latest supported Ruby version listed here:\n !     https://devcenter.heroku.com/articles/ruby-support#supported-runtimes\n !     \n !     For more information on syntax for declaring a Ruby version see:\n !     https://devcenter.heroku.com/articles/ruby-versions\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "base64", "faraday"], "comments": [{"owner": {"reputation": 1528, "user_id": 7573791, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0e5e5cf864fb33229ca56750a51d6674?s=128&d=identicon&r=PG&f=1", "display_name": "Sajin", "link": "https://stackoverflow.com/users/7573791/sajin"}, "edited": false, "score": 0, "creation_date": 1501061728, "post_id": 45322878, "comment_id": 77607774, "body": "can you check whether the protocol is present in the url (http/https)"}, {"owner": {"reputation": 7768, "user_id": 1213273, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/cf372446eb8bcca32373052e4dda2164?s=128&d=identicon&r=PG", "display_name": "Severin", "link": "https://stackoverflow.com/users/1213273/severin"}, "reply_to_user": {"reputation": 1528, "user_id": 7573791, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0e5e5cf864fb33229ca56750a51d6674?s=128&d=identicon&r=PG&f=1", "display_name": "Sajin", "link": "https://stackoverflow.com/users/7573791/sajin"}, "edited": false, "score": 0, "creation_date": 1501061804, "post_id": 45322878, "comment_id": 77607840, "body": "@Sajin It&#39;s not. The above is everything I got."}, {"owner": {"reputation": 5800, "user_id": 4287733, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/835e993afb1e20c1981dd6b8b59ded2d?s=128&d=identicon&r=PG", "display_name": "Nermin", "link": "https://stackoverflow.com/users/4287733/nermin"}, "edited": false, "score": 0, "creation_date": 1501061866, "post_id": 45322878, "comment_id": 77607895, "body": "Have you tried to decode url from Base64, and than use that value as URL ?"}, {"owner": {"reputation": 7768, "user_id": 1213273, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/cf372446eb8bcca32373052e4dda2164?s=128&d=identicon&r=PG", "display_name": "Severin", "link": "https://stackoverflow.com/users/1213273/severin"}, "reply_to_user": {"reputation": 5800, "user_id": 4287733, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/835e993afb1e20c1981dd6b8b59ded2d?s=128&d=identicon&r=PG", "display_name": "Nermin", "link": "https://stackoverflow.com/users/4287733/nermin"}, "edited": false, "score": 0, "creation_date": 1501062041, "post_id": 45322878, "comment_id": 77608019, "body": "@Nermin I have tried a couple of webbased decoders, but no luck with any of them."}, {"owner": {"reputation": 1528, "user_id": 7573791, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0e5e5cf864fb33229ca56750a51d6674?s=128&d=identicon&r=PG&f=1", "display_name": "Sajin", "link": "https://stackoverflow.com/users/7573791/sajin"}, "edited": false, "score": 0, "creation_date": 1501062088, "post_id": 45322878, "comment_id": 77608049, "body": "what is the url that works for you in browser?"}, {"owner": {"reputation": 7768, "user_id": 1213273, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/cf372446eb8bcca32373052e4dda2164?s=128&d=identicon&r=PG", "display_name": "Severin", "link": "https://stackoverflow.com/users/1213273/severin"}, "reply_to_user": {"reputation": 1528, "user_id": 7573791, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0e5e5cf864fb33229ca56750a51d6674?s=128&d=identicon&r=PG&f=1", "display_name": "Sajin", "link": "https://stackoverflow.com/users/7573791/sajin"}, "edited": false, "score": 0, "creation_date": 1501062332, "post_id": 45322878, "comment_id": 77608233, "body": "@Sajin Unfortunately I am not at liberty to disclose the real URL"}, {"owner": {"reputation": 1528, "user_id": 7573791, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0e5e5cf864fb33229ca56750a51d6674?s=128&d=identicon&r=PG&f=1", "display_name": "Sajin", "link": "https://stackoverflow.com/users/7573791/sajin"}, "edited": false, "score": 0, "creation_date": 1501062484, "post_id": 45322878, "comment_id": 77608359, "body": "Ok, I get it. Do you mind modifying the actual url and share the structure of the url you are passing to faraday so that we can get an idea"}, {"owner": {"reputation": 7768, "user_id": 1213273, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/cf372446eb8bcca32373052e4dda2164?s=128&d=identicon&r=PG", "display_name": "Severin", "link": "https://stackoverflow.com/users/1213273/severin"}, "reply_to_user": {"reputation": 1528, "user_id": 7573791, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0e5e5cf864fb33229ca56750a51d6674?s=128&d=identicon&r=PG&f=1", "display_name": "Sajin", "link": "https://stackoverflow.com/users/7573791/sajin"}, "edited": false, "score": 0, "creation_date": 1501063250, "post_id": 45322878, "comment_id": 77608965, "body": "@Sajin I added a sample curl where you can see the structure."}], "answers": [{"tags": [], "owner": {"reputation": 2090, "user_id": 5113690, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/cbKBX.png?s=128&g=1", "display_name": "m3characters", "link": "https://stackoverflow.com/users/5113690/m3characters"}, "is_accepted": false, "score": 0, "last_activity_date": 1501062565, "creation_date": 1501062565, "answer_id": 45323345, "question_id": 45322878, "link": "https://stackoverflow.com/questions/45322878/requesting-base64-encoded-url-with-faraday-in-ruby-on-rails/45323345#45323345", "title": "Requesting Base64 encoded URL with Faraday in Ruby on Rails", "body": "<p><a href=\"https://ruby-doc.org/stdlib-2.2.2/libdoc/base64/rdoc/Base64.html\" rel=\"nofollow noreferrer\">https://ruby-doc.org/stdlib-2.2.2/libdoc/base64/rdoc/Base64.html</a></p>\n\n<p>You probably need to split on the first <code>,</code> then <code>.decode64</code> on the remaining?</p>\n"}], "owner": {"reputation": 7768, "user_id": 1213273, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/cf372446eb8bcca32373052e4dda2164?s=128&d=identicon&r=PG", "display_name": "Severin", "link": "https://stackoverflow.com/users/1213273/severin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 395, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1501063234, "creation_date": 1501061407, "last_edit_date": 1501063234, "question_id": 45322878, "link": "https://stackoverflow.com/questions/45322878/requesting-base64-encoded-url-with-faraday-in-ruby-on-rails", "title": "Requesting Base64 encoded URL with Faraday in Ruby on Rails", "body": "<p>I need to get some Data from a server where the URL is provided to me as Base64. I usually use Faraday to connect to JSON APIs (which is the return format). Here is a basic example, including the error I get:</p>\n\n<pre><code>url = \"data:application/json;base64,srighiuerghieurg...\"\nFaraday.get(url)\n\n#=&gt; URI::InvalidURIError: query conflicts with opaque\n</code></pre>\n\n<p>Opening the URL in any browser yields the expected JSON, but how can I make this work using Faraday?</p>\n\n<p>To give you an idea of the structure of the request:</p>\n\n<pre><code>curl 'https://some.site.net/1/indexes/*/queries?some-agent=...' -H 'Accept: application/json' -H 'Accept-Encoding: gzip, deflate, br' -H 'Accept-Language: en-US,en;q=0.5' -H 'Connection: keep-alive' -H 'Content-Type: application/x-www-form-urlencoded' -H 'DNT: 1' -H 'Host: some.site.net' -H 'Origin: https://another.site.com -H 'Referer: https://another.site.com/some/path' -H 'User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/42.0.2311.135 Safari/537.36 Edge/12.10240' --data '{\"requests\":[{\"index\":\"some-name\",\"params\":\"some=params\"}]}'\n</code></pre>\n"}, {"tags": ["json", "ruby"], "comments": [{"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1501060301, "post_id": 45322357, "comment_id": 77606662, "body": "One-liners of that length are unreadable. Format them for readability"}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 1, "creation_date": 1501060479, "post_id": 45322357, "comment_id": 77606806, "body": "Should be <code>logindetails[&#39;data&#39;][&#39;userDetails&#39;][&#39;apiToken&#39;]</code>"}, {"owner": {"reputation": 1772, "user_id": 5743300, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/86b739012f3bafbce2e40f59f3291c0e?s=128&d=identicon&r=PG&f=1", "display_name": "Emjey", "link": "https://stackoverflow.com/users/5743300/emjey"}, "reply_to_user": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1501060480, "post_id": 45322357, "comment_id": 77606807, "body": "@SergioTulentsev Edited"}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1501060537, "post_id": 45322357, "comment_id": 77606854, "body": "yeah, better, but still has a lot of potential for improvement. Take a look at how json looks now."}, {"owner": {"reputation": 1772, "user_id": 5743300, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/86b739012f3bafbce2e40f59f3291c0e?s=128&d=identicon&r=PG&f=1", "display_name": "Emjey", "link": "https://stackoverflow.com/users/5743300/emjey"}, "reply_to_user": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1501060614, "post_id": 45322357, "comment_id": 77606925, "body": "Thanks a lot! Your code worked. And please could you explain why not just <code>logindetails[&#39;apiToken&#39;]</code>? Is it nested inside <code>data</code> and <code>userDetails</code>? if yes, How do I make sure of it"}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 1, "creation_date": 1501060779, "post_id": 45322357, "comment_id": 77607053, "body": "exactly, it is nested two levels deep. When you pretty-print the data, it becomes obvious."}, {"owner": {"reputation": 1772, "user_id": 5743300, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/86b739012f3bafbce2e40f59f3291c0e?s=128&d=identicon&r=PG&f=1", "display_name": "Emjey", "link": "https://stackoverflow.com/users/5743300/emjey"}, "reply_to_user": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1501060864, "post_id": 45322357, "comment_id": 77607115, "body": "you got the json eyes. Thanks a lot @SergioTulentsev"}], "answers": [{"tags": [], "owner": {"reputation": 1037, "user_id": 6812637, "user_type": "registered", "accept_rate": 78, "profile_image": "https://lh4.googleusercontent.com/-QEVKvPalxzI/AAAAAAAAAAI/AAAAAAAAAA8/CSUfpoapG14/photo.jpg?sz=128", "display_name": "Navarro", "link": "https://stackoverflow.com/users/6812637/navarro"}, "is_accepted": true, "score": 2, "last_activity_date": 1501060710, "creation_date": 1501060710, "answer_id": 45322603, "question_id": 45322357, "link": "https://stackoverflow.com/questions/45322357/print-a-value-of-a-key-from-json/45322603#45322603", "title": "Print a value of a key from json", "body": "<p>The token is under <code>data</code> <code>userDetails</code> <code>apiToken</code>:</p>\n\n<pre><code>json['data']['userDetails']['apiToken'] #=&gt; f5c95fd8-efc4-497e-8128-51a014de3a9a\n</code></pre>\n"}], "owner": {"reputation": 1772, "user_id": 5743300, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/86b739012f3bafbce2e40f59f3291c0e?s=128&d=identicon&r=PG&f=1", "display_name": "Emjey", "link": "https://stackoverflow.com/users/5743300/emjey"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 89, "favorite_count": 0, "accepted_answer_id": 45322603, "answer_count": 1, "score": 0, "last_activity_date": 1501060920, "creation_date": 1501060139, "last_edit_date": 1501060920, "question_id": 45322357, "link": "https://stackoverflow.com/questions/45322357/print-a-value-of-a-key-from-json", "title": "Print a value of a key from json", "body": "<p>I am trying to parse a json file and extract the value of a key from it, and pass it to another post request. However, I am not able to extract they value, when I try, it prints the key itself instead of value</p>\n\n<p><strong>PFB the json file</strong></p>\n\n<pre><code>{\n   \"data\":{\n      \"isActivated\":true,\n      \"userDetails\":{\n         \"userId\":\"52321713-add8-4455-9e0c-426eab923338\",\n         \"oktaId\":\"00ub24c5bs6awQyBD0h7\",\n         \"contactId\":\"7234294092390\",\n         \"oktaSessionToken\":\"20111UqAZ9-E1YPlNcXBLRCu_ZHHzBCH2q_j01yiIkPyRp5-0E7HAQQ\",\n         \"oktaSessionId\":\"102a9q79TrqRWek9vHEPkP3yQ\",\n         \"apiToken\":\"f5c95fd8-efc4-497e-8128-51a014de3a9a\",\n         \"firstName\":\"Judy\",\n         \"lastName\":\"Test1\",\n         \"middleName\":null,\n         \"email\":\"abc@mailinator.com\",\n         \"isEmployee\":true,\n         \"pushNotificationStatus\":true\n      },\n      \"companyDetails\":{\n         \"profileScreenBackgroundColor\":\"13253D\",\n         \"companyColor\":\"7ED321\",\n         \"companyName\":\"Mobile App Demo\",\n         \"companyLogo\":\"http://\",\n         \"isSSO\":false\n      }\n   }\n}\n</code></pre>\n\n<p><strong>PFB the hash file:</strong></p>\n\n<pre><code>           {\"data\"=&gt;{\"isActivated\"=&gt;true, \"userDetails\"=&gt;\n            {\"userId\"=&gt;\"52321713-add8-4455-9e0c-426eab923338\", \n             \"oktaId\"=&gt;\"00ub24c5bs6awQyBD0h7\", \"contactId\"=&gt;\"0033300001tZ8k5AAC\", \n        \"oktaSessionToken\"=&gt;\"201112Ncbw364pHojkD4UlzGb1knz9UTZPIy2LFDn9Tgy_FmgEpZmmU\", \n    \"oktaSessionId\"=&gt;\"102Kd-c2yEeSnmwr3YKX8qeyg\", \n\"apiToken\"=&gt;\"f8f070e2-e51b-4d69-8b1a-b7b63d25e781\", \n\"firstName\"=&gt;\"Judy\", \"lastName\"=&gt;\"Test1\",\n \"middleName\"=&gt;nil,\n \"email\"=&gt;\"judy.test1@mailinator.com\",\n \"isEmployee\"=&gt;true, \n\"pushNotificationStatus\"=&gt;true},\n \"companyDetails\"=&gt;{\"profileScreenBackgroundColor\"=&gt;\"13253D\", \"companyColor\"=&gt;\"7ED321\",\n \"companyName\"=&gt;\"Mobile App Demo\", \"companyLogo\"=&gt;\"https:\", \n\"isSSO\"=&gt;false}}}\n</code></pre>\n\n<p><strong>The code below:</strong></p>\n\n<p>I had tried almost all means, not sure what am i missing.</p>\n\n<pre><code>apitoken = RestClient.post(\"https://\", {'email'=&gt;arg,'password'=&gt;'abcs','deviceUUId'=&gt;'udid', 'deviceTypeId'=&gt;1}.to_json, { \"Content-Type\" =&gt; 'application/json','buildNumber' =&gt; '000','deviceTypeId'=&gt;'9'})\n  puts apitoken\n  puts \"**************\"\n  puts apitoken[\"apiToken\"]\n  logindetails = JSON.parse(apitoken)\n  tada = JSON.parse(logindetails)['data']['apitoken']\n  puts tada\n  puts logindetails\n  result = logindetails[\"data\"][\"apiToken\"]\n  puts result\n  puts \"**************\"\n  logindetails.each do |logindetail|\n    puts logindetail\n    puts logindetail[\"apiToken]\n    puts \"**************\"\n  end\n  result = logindetails['apiToken']\n  puts result\n  end\n</code></pre>\n\n<p>The output I get is <code>apiToken</code> instead of the value of it. Any help is greatly appreciated.</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 1528, "user_id": 7573791, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0e5e5cf864fb33229ca56750a51d6674?s=128&d=identicon&r=PG&f=1", "display_name": "Sajin", "link": "https://stackoverflow.com/users/7573791/sajin"}, "edited": false, "score": 2, "creation_date": 1501059733, "post_id": 45322011, "comment_id": 77606192, "body": "Why dont you use <code>badge = Badge.where(&#39;condition &lt;= ?&#39;, @user.points).order(:condition).last</code> ?"}, {"owner": {"reputation": 219, "user_id": 5861200, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/b2e5842f7a19a8752df4b89a3cccab77?s=128&d=identicon&r=PG&f=1", "display_name": "sofarsophie", "link": "https://stackoverflow.com/users/5861200/sofarsophie"}, "reply_to_user": {"reputation": 1528, "user_id": 7573791, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0e5e5cf864fb33229ca56750a51d6674?s=128&d=identicon&r=PG&f=1", "display_name": "Sajin", "link": "https://stackoverflow.com/users/7573791/sajin"}, "edited": false, "score": 0, "creation_date": 1501060121, "post_id": 45322011, "comment_id": 77606511, "body": "@Sajin Oh... right. I&#39;ve been so desperate to use search algorithms that I completely forgot that there is the quick&amp;easy &#39;where&#39; method in ruby... wow I really need my head to be more flexible. So sorry I wasted your time with this basic question! Would you like to put that as an answer or should I just close the question? :)"}, {"owner": {"reputation": 219, "user_id": 5861200, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/b2e5842f7a19a8752df4b89a3cccab77?s=128&d=identicon&r=PG&f=1", "display_name": "sofarsophie", "link": "https://stackoverflow.com/users/5861200/sofarsophie"}, "reply_to_user": {"reputation": 1528, "user_id": 7573791, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0e5e5cf864fb33229ca56750a51d6674?s=128&d=identicon&r=PG&f=1", "display_name": "Sajin", "link": "https://stackoverflow.com/users/7573791/sajin"}, "edited": false, "score": 0, "creation_date": 1501060152, "post_id": 45322011, "comment_id": 77606541, "body": "@sajin Thanks for the great tip by the way!!"}, {"owner": {"reputation": 1528, "user_id": 7573791, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0e5e5cf864fb33229ca56750a51d6674?s=128&d=identicon&r=PG&f=1", "display_name": "Sajin", "link": "https://stackoverflow.com/users/7573791/sajin"}, "edited": false, "score": 0, "creation_date": 1501060167, "post_id": 45322011, "comment_id": 77606547, "body": "I&#39;ll add it as an answer"}, {"owner": {"reputation": 219, "user_id": 5861200, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/b2e5842f7a19a8752df4b89a3cccab77?s=128&d=identicon&r=PG&f=1", "display_name": "sofarsophie", "link": "https://stackoverflow.com/users/5861200/sofarsophie"}, "reply_to_user": {"reputation": 1528, "user_id": 7573791, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0e5e5cf864fb33229ca56750a51d6674?s=128&d=identicon&r=PG&f=1", "display_name": "Sajin", "link": "https://stackoverflow.com/users/7573791/sajin"}, "edited": false, "score": 0, "creation_date": 1501060195, "post_id": 45322011, "comment_id": 77606584, "body": "@Sajin Thanks! :)"}], "answers": [{"tags": [], "owner": {"reputation": 1528, "user_id": 7573791, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0e5e5cf864fb33229ca56750a51d6674?s=128&d=identicon&r=PG&f=1", "display_name": "Sajin", "link": "https://stackoverflow.com/users/7573791/sajin"}, "is_accepted": true, "score": 3, "last_activity_date": 1501060238, "creation_date": 1501060238, "answer_id": 45322402, "question_id": 45322011, "link": "https://stackoverflow.com/questions/45322011/ruby-binary-search-issue-sorted-array-x-is-nil-error/45322402#45322402", "title": "Ruby Binary Search Issue - sorted array / x is nil error", "body": "<p>To fetch the badge based on user points, use:</p>\n\n<pre><code>badge = Badge.where('condition &lt;= ?', @user.points).order(:condition).last\n</code></pre>\n"}], "owner": {"reputation": 219, "user_id": 5861200, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/b2e5842f7a19a8752df4b89a3cccab77?s=128&d=identicon&r=PG&f=1", "display_name": "sofarsophie", "link": "https://stackoverflow.com/users/5861200/sofarsophie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 59, "favorite_count": 0, "accepted_answer_id": 45322402, "answer_count": 1, "score": 0, "last_activity_date": 1501060238, "creation_date": 1501059206, "question_id": 45322011, "link": "https://stackoverflow.com/questions/45322011/ruby-binary-search-issue-sorted-array-x-is-nil-error", "title": "Ruby Binary Search Issue - sorted array / x is nil error", "body": "<p>I know a few questions with a similar title have been closed for ambiguity, so I will try to be as detailed as possible.</p>\n\n<p>I have a rails model called 'Badges' that have 13 badge objects that are predefined. Each badge object has a attr called 'condition', which specifies the number of points that a user must reach to achieve the badge.</p>\n\n<p>My code for a method called 'reward_badge' is like this:</p>\n\n<pre><code>@user = User.find(self.user_id)\n\nconditions = Array.new(13)\nBadge.all.each do |b|\n  conditions &lt;&lt; b.condition\nend\n\nbadge = Badge.find(conditions.bsearch_index{|x| @user.points &gt;= x} + 1)\n@user.badges &lt;&lt; badge unless @user.badges.include? badge\n</code></pre>\n\n<p>So, I have a <strong>sorted array</strong> called 'conditions' which contains the point increments for each of the badges (ex. [1, 5, 10, 50...]). I want to get the badge that has a condition which is just smaller than the user's points, and award the badge if the user doesn't already have it.</p>\n\n<p>And I decided that the 'binary search' that ruby provides is the best way to achieve this. But when I use the above code, I get errors saying that 'x is nil'. (more specifically, the error says that I cannot use the operator '>=' for a nil obj)</p>\n\n<p>I am not sure how to resolve this, as I thought I followed what the ruby library specifies...</p>\n\n<p>At the moment, I decided to temporarily use a case statement. I really hope to use this binary search method for a clearer solution. I appreciate your help.</p>\n"}, {"tags": ["mysql", "ruby-on-rails", "ruby", "ruby-on-rails-4"], "comments": [{"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 4, "creation_date": 1501058165, "post_id": 45321381, "comment_id": 77605045, "body": "<b>DON&#39;T DO THIS: <code>LIKE &#39;#{stripped_name}%&#39;</code></b> -- You&#39;ve just created a <a href=\"http://guides.rubyonrails.org/security.html#sql-injection\" rel=\"nofollow noreferrer\">potential SQL injection vulnerability</a>. What happens if a user enters <code>params[last_name] = &#39;&quot;; DROP TABLE users;--&quot;</code> In this case, you <i>might</i> (?) get away with it, because of the <code>gsub</code>... But don&#39;t risk it, and don&#39;t leave code in a dangerous state where it could easily <i>become</i> a critical security hole."}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 2, "creation_date": 1501058239, "post_id": 45321381, "comment_id": 77605092, "body": "<i>Always</i> parameterise your SQL statements. Use: <code>&quot;... LIKE ?&quot;, &quot;#{stripped_name}%&quot;</code>."}, {"owner": {"reputation": 1528, "user_id": 7573791, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0e5e5cf864fb33229ca56750a51d6674?s=128&d=identicon&r=PG&f=1", "display_name": "Sajin", "link": "https://stackoverflow.com/users/7573791/sajin"}, "edited": false, "score": 0, "creation_date": 1501059397, "post_id": 45321381, "comment_id": 77605941, "body": "<a href=\"https://stackoverflow.com/questions/986826/how-to-do-a-regular-expression-replace-in-mysql\" title=\"how to do a regular expression replace in mysql\">stackoverflow.com/questions/986826/&hellip;</a>"}, {"owner": {"reputation": 1049, "user_id": 5353193, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/b427991caffbc88cf5dccfb942f061a2?s=128&d=identicon&r=PG", "display_name": "Francois", "link": "https://stackoverflow.com/users/5353193/francois"}, "reply_to_user": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1501060174, "post_id": 45321381, "comment_id": 77606562, "body": "Maybe you could use <code>ILIKE</code> to avoid using <code>LOWER()</code>, I think it would be simpler to read. (only if you&#39;re using postgres, thx @TomLord)"}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "reply_to_user": {"reputation": 1049, "user_id": 5353193, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/b427991caffbc88cf5dccfb942f061a2?s=128&d=identicon&r=PG", "display_name": "Francois", "link": "https://stackoverflow.com/users/5353193/francois"}, "edited": false, "score": 1, "creation_date": 1501060370, "post_id": 45321381, "comment_id": 77606712, "body": "@Francois This question was about <code>mysql</code>. <code>ILIKE</code> is only available in <code>postgresql</code>."}, {"owner": {"reputation": 1049, "user_id": 5353193, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/b427991caffbc88cf5dccfb942f061a2?s=128&d=identicon&r=PG", "display_name": "Francois", "link": "https://stackoverflow.com/users/5353193/francois"}, "edited": false, "score": 0, "creation_date": 1501060410, "post_id": 45321381, "comment_id": 77606742, "body": "Oupsie, my bad!"}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1501070784, "post_id": 45321381, "comment_id": 77614499, "body": "<code>REPLACE</code> won\u2019t work with regexp, but what is basically wrong with replacing spaces explicitly <code>LOWER(REPLACE(last_name, &#39; &#39;, &#39;&#39;))</code>?!"}, {"owner": {"reputation": 3618, "user_id": 2968762, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/EhAX3.png?s=128&g=1", "display_name": "Abhi", "link": "https://stackoverflow.com/users/2968762/abhi"}, "reply_to_user": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1501075224, "post_id": 45321381, "comment_id": 77618001, "body": "@mudasobwa It&#39;s not only spaces. <code>\\W</code> is expected to remove any special character including spaces."}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1501075599, "post_id": 45321381, "comment_id": 77618291, "body": "I sorta know. What do you expect there, save for spaces, dots and probably commas? Do three nested REPLACEs"}, {"owner": {"reputation": 3618, "user_id": 2968762, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/EhAX3.png?s=128&g=1", "display_name": "Abhi", "link": "https://stackoverflow.com/users/2968762/abhi"}, "reply_to_user": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1501076505, "post_id": 45321381, "comment_id": 77619032, "body": "@mudasobwa Ok, I get your point. Although the logic would break if it&#39;s any special char. other than <code>.</code>, <code>,</code> and <code>space</code>."}, {"owner": {"reputation": 3618, "user_id": 2968762, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/EhAX3.png?s=128&g=1", "display_name": "Abhi", "link": "https://stackoverflow.com/users/2968762/abhi"}, "reply_to_user": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1501076922, "post_id": 45321381, "comment_id": 77619354, "body": "@mudasobwa The purpose is to prevail search even if user has accidentally inserted any special char."}], "answers": [{"comments": [{"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1501070913, "post_id": 45322997, "comment_id": 77614575, "body": "<code>#{%split_names[1]%}</code> has a couple of errors: 1. it is not valid ruby code and throws an exception, 2. it basically matches \u201cCamp Bell\u201d against \u201cBelly Bellman.\u201d"}, {"owner": {"reputation": 428, "user_id": 2032148, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/R53PU.jpg?s=128&g=1", "display_name": "meshin", "link": "https://stackoverflow.com/users/2032148/meshin"}, "reply_to_user": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1501071977, "post_id": 45322997, "comment_id": 77615385, "body": "I forgott the quotation marks and put <code>%</code> in the wrong place, edited the answer. This is correct: <code>User.where(&#39;name LIKE ? OR (name LIKE ? AND name LIKE ?)&#39;, &quot;%#{stripped_name}%&quot;, &quot;%#{split_names[0]}%&quot;, &quot;%#{split_names[1]}%&quot;)</code>"}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1501074184, "post_id": 45322997, "comment_id": 77617148, "body": "Still matches Belly Belltone."}, {"owner": {"reputation": 428, "user_id": 2032148, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/R53PU.jpg?s=128&g=1", "display_name": "meshin", "link": "https://stackoverflow.com/users/2032148/meshin"}, "reply_to_user": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1501075366, "post_id": 45322997, "comment_id": 77618119, "body": "Everything works fine just checked in the console. Search for \u201cCamp Bell\u201d only returns &quot;Camp Bell\u201d even if &quot;Belly Bellman&quot; exists. You have to have have braces arount this statement just before OR <code>(name LIKE ? AND name LIKE ?)</code> that&#39;s important"}], "tags": [], "owner": {"reputation": 428, "user_id": 2032148, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/R53PU.jpg?s=128&g=1", "display_name": "meshin", "link": "https://stackoverflow.com/users/2032148/meshin"}, "is_accepted": false, "score": 0, "last_activity_date": 1501071878, "last_edit_date": 1501071878, "creation_date": 1501061702, "answer_id": 45322997, "question_id": 45321381, "link": "https://stackoverflow.com/questions/45321381/strip-special-characters-and-space-of-a-db-column-to-compare-in-rails/45322997#45322997", "title": "Strip special characters and space of a DB column to compare in rails", "body": "<p>You can check for both <code>stripped_name</code> without space and ones that include both names seperated with space like this.</p>\n\n<pre><code>stripped_name = params[last_name].gsub(/\\W/, '')\nsplit_names = params[last_name].split(\" \")\n\nUser.where('name LIKE ? OR (name LIKE ? AND name LIKE ?)', \"%#{stripped_name}%\", \"%#{split_names[0]}%\", \"%#{split_names[1]}%\")\n</code></pre>\n\n<p>Next step would to search for complete array of split names not just first two.</p>\n"}, {"comments": [{"owner": {"reputation": 3618, "user_id": 2968762, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/EhAX3.png?s=128&g=1", "display_name": "Abhi", "link": "https://stackoverflow.com/users/2968762/abhi"}, "edited": false, "score": 0, "creation_date": 1501077688, "post_id": 45329079, "comment_id": 77620053, "body": "Thanks for the answer. There is a misunderstanding. I use <code>\\W</code> so as to strip any special character including space. It&#39;s not only <code>space</code>. I have edited the question."}, {"owner": {"reputation": 343, "user_id": 3840725, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5un6e.jpg?s=128&g=1", "display_name": "jpheos", "link": "https://stackoverflow.com/users/3840725/jpheos"}, "reply_to_user": {"reputation": 3618, "user_id": 2968762, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/EhAX3.png?s=128&g=1", "display_name": "Abhi", "link": "https://stackoverflow.com/users/2968762/abhi"}, "edited": false, "score": 0, "creation_date": 1501077704, "post_id": 45329079, "comment_id": 77620071, "body": "I just saw that you use mysql, so you right to use LOWER instead ILIKE, thanks Tom Lord"}], "tags": [], "owner": {"reputation": 343, "user_id": 3840725, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5un6e.jpg?s=128&g=1", "display_name": "jpheos", "link": "https://stackoverflow.com/users/3840725/jpheos"}, "is_accepted": false, "score": 0, "last_activity_date": 1501077421, "creation_date": 1501077421, "answer_id": 45329079, "question_id": 45321381, "link": "https://stackoverflow.com/questions/45321381/strip-special-characters-and-space-of-a-db-column-to-compare-in-rails/45329079#45329079", "title": "Strip special characters and space of a DB column to compare in rails", "body": "<p>Here my solution:</p>\n\n<pre><code>User.where(\"REPLACE(last_name, ' ', '') ILIKE  CONCAT ('%', REPLACE('?', ' ', ''),'%')\", stripped_name)\n</code></pre>\n\n<p><code>ILIKE</code> is like <code>LIKE</code> but the <code>I</code> is for insensitive case.</p>\n\n<p>To understand easily step by step:</p>\n\n<ul>\n<li><code>lastname ILIKE '%campbell%</code> you need <code>%</code> because you want lastname\ncontain this string, not necessary at the begin or the end of you\nstring.\n\n<ul>\n<li><code>'campbell%'</code> => search string who begin by <code>campbell</code></li>\n<li><code>'%campbell'</code> => search string who finish by <code>campbell</code></li>\n</ul></li>\n<li>We need generate <code>'%campbell%</code>, so we use <code>CONCAT</code> for that</li>\n<li>I just use a simply <code>REPLACE</code>, but maybe you should use a regex.</li>\n</ul>\n"}], "owner": {"reputation": 3618, "user_id": 2968762, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/EhAX3.png?s=128&g=1", "display_name": "Abhi", "link": "https://stackoverflow.com/users/2968762/abhi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 360, "favorite_count": 1, "answer_count": 2, "score": 2, "last_activity_date": 1501077594, "creation_date": 1501057638, "last_edit_date": 1501077594, "question_id": 45321381, "link": "https://stackoverflow.com/questions/45321381/strip-special-characters-and-space-of-a-db-column-to-compare-in-rails", "title": "Strip special characters and space of a DB column to compare in rails", "body": "<p>I have 4 types of <strong>last_name</strong>:</p>\n\n<ul>\n<li>\"Camp Bell\"</li>\n<li>\"CAMPBELL\"</li>\n<li>\"CampBellJr.\"</li>\n<li>\"camp bell jr.\"</li>\n</ul>\n\n<p>Now, in rails when an user is searched by it's last name like <code>camp bell</code>, I want to show all the 4 records. So, I tried:</p>\n\n<p><strong>RAILS</strong></p>\n\n<pre><code>stripped_name = params[last_name].gsub(/\\W/, '')\n#=&gt; \"campbell\"\n\nUser.where(\"LOWER(REPLACE(last_name, '/\\W/', '')) LIKE ?\", \"#{stripped_name}%\")\n</code></pre>\n\n<p>Give me only 2 records with following <strong>last_name</strong>:</p>\n\n<ul>\n<li>\"CAMPBELL\"</li>\n<li>\"CampBellJr.\"</li>\n</ul>\n\n<p>I guess, this is because, the mysql <strong>REPLACE</strong> is not working correctly with regex.</p>\n\n<p>Any ideas?</p>\n\n<p><strong>EDIT</strong></p>\n\n<p>Guys, sorry for the confusion. My idea is to strip off all special characters including space. So I'm trying to use <code>\\W</code> regex.</p>\n\n<p>For example, the input can be: <code>camp~bell..</code>. But, it should still fetch result.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "docker", "docker-compose"], "comments": [{"owner": {"reputation": 1037, "user_id": 6812637, "user_type": "registered", "accept_rate": 78, "profile_image": "https://lh4.googleusercontent.com/-QEVKvPalxzI/AAAAAAAAAAI/AAAAAAAAAA8/CSUfpoapG14/photo.jpg?sz=128", "display_name": "Navarro", "link": "https://stackoverflow.com/users/6812637/navarro"}, "edited": false, "score": 0, "creation_date": 1501056029, "post_id": 45320696, "comment_id": 77603627, "body": "Can you execute <code>netstat -tuplen</code> in the database container? It will show if it has bonded to that port and it is listening."}, {"owner": {"reputation": 57, "user_id": 4165225, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/lTP31.jpg?s=128&g=1", "display_name": "Muzammil Ahmed", "link": "https://stackoverflow.com/users/4165225/muzammil-ahmed"}, "reply_to_user": {"reputation": 1037, "user_id": 6812637, "user_type": "registered", "accept_rate": 78, "profile_image": "https://lh4.googleusercontent.com/-QEVKvPalxzI/AAAAAAAAAAI/AAAAAAAAAA8/CSUfpoapG14/photo.jpg?sz=128", "display_name": "Navarro", "link": "https://stackoverflow.com/users/6812637/navarro"}, "edited": false, "score": 0, "creation_date": 1501056323, "post_id": 45320696, "comment_id": 77603815, "body": "tcp        0      0 0.0.0.0:5432            0.0.0.0:*               LISTEN      107        145283      -                  tcp6       0      0 :::5432                 :::*                    LISTEN      107        145284      -"}, {"owner": {"reputation": 488, "user_id": 8193592, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d43181b82224badd58e80c0aad1a328a?s=128&d=identicon&r=PG&f=1", "display_name": "D. Gon&#231;alves", "link": "https://stackoverflow.com/users/8193592/d-gon%c3%a7alves"}, "edited": false, "score": 0, "creation_date": 1501056592, "post_id": 45320696, "comment_id": 77603979, "body": "Is your postgres container in your docker-compose.yml or do you run it independently? It&#39;s not clear in your question"}, {"owner": {"reputation": 1037, "user_id": 6812637, "user_type": "registered", "accept_rate": 78, "profile_image": "https://lh4.googleusercontent.com/-QEVKvPalxzI/AAAAAAAAAAI/AAAAAAAAAA8/CSUfpoapG14/photo.jpg?sz=128", "display_name": "Navarro", "link": "https://stackoverflow.com/users/6812637/navarro"}, "edited": false, "score": 0, "creation_date": 1501056711, "post_id": 45320696, "comment_id": 77604062, "body": "Have you tried <a href=\"https://stackoverflow.com/questions/18460016/connect-from-one-docker-container-to-another\">this</a>? It seems to be very similar to your question."}, {"owner": {"reputation": 57, "user_id": 4165225, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/lTP31.jpg?s=128&g=1", "display_name": "Muzammil Ahmed", "link": "https://stackoverflow.com/users/4165225/muzammil-ahmed"}, "reply_to_user": {"reputation": 488, "user_id": 8193592, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d43181b82224badd58e80c0aad1a328a?s=128&d=identicon&r=PG&f=1", "display_name": "D. Gon&#231;alves", "link": "https://stackoverflow.com/users/8193592/d-gon%c3%a7alves"}, "edited": false, "score": 0, "creation_date": 1501056878, "post_id": 45320696, "comment_id": 77604183, "body": "@D.Gon&#231;alves database postgreSQL is running into separate container by docker-compose.yml file"}, {"owner": {"reputation": 57, "user_id": 4165225, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/lTP31.jpg?s=128&g=1", "display_name": "Muzammil Ahmed", "link": "https://stackoverflow.com/users/4165225/muzammil-ahmed"}, "reply_to_user": {"reputation": 1037, "user_id": 6812637, "user_type": "registered", "accept_rate": 78, "profile_image": "https://lh4.googleusercontent.com/-QEVKvPalxzI/AAAAAAAAAAI/AAAAAAAAAA8/CSUfpoapG14/photo.jpg?sz=128", "display_name": "Navarro", "link": "https://stackoverflow.com/users/6812637/navarro"}, "edited": false, "score": 0, "creation_date": 1501057053, "post_id": 45320696, "comment_id": 77604287, "body": "@Navarro I did it and its shows connection refused"}, {"owner": {"reputation": 263, "user_id": 8187943, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/468e4a7c8d12fd73790e0d1d29731fa2?s=128&d=identicon&r=PG&f=1", "display_name": "vegiops", "link": "https://stackoverflow.com/users/8187943/vegiops"}, "edited": false, "score": 0, "creation_date": 1501058738, "post_id": 45320696, "comment_id": 77605476, "body": "are you able to resolve discourse.org from your app ?"}, {"owner": {"reputation": 414, "user_id": 6556383, "user_type": "registered", "accept_rate": 86, "profile_image": "https://lh4.googleusercontent.com/-rFjQCuJsaAk/AAAAAAAAAAI/AAAAAAAAEio/VDKKrZfNTtM/photo.jpg?sz=128", "display_name": "dendomenko", "link": "https://stackoverflow.com/users/6556383/dendomenko"}, "edited": false, "score": 0, "creation_date": 1501060121, "post_id": 45320696, "comment_id": 77606510, "body": "You don&#39;t need two docker-compose.yml files for DB and for the app. The idea of docker-compose to run and manage several containers by one service"}], "answers": [{"tags": [], "owner": {"reputation": 1103, "user_id": 6156340, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-hQfBBXrnbpI/AAAAAAAAAAI/AAAAAAAABP4/BK5aW9CX7S4/photo.jpg?sz=128", "display_name": "Wassim Dhif", "link": "https://stackoverflow.com/users/6156340/wassim-dhif"}, "is_accepted": false, "score": 1, "last_activity_date": 1501058753, "creation_date": 1501058753, "answer_id": 45321819, "question_id": 45320696, "link": "https://stackoverflow.com/questions/45320696/how-two-docker-containers-communicate-each-other/45321819#45321819", "title": "How two docker containers communicate each other?", "body": "<p>You should use the <a href=\"https://docs.docker.com/compose/compose-file/#links\" rel=\"nofollow noreferrer\">links</a> in docker-compose. You will just have to link to two containers, and inside your configuration, you just reference the service name.</p>\n\n<p>\"Containers for the linked service will be reachable at a hostname identical to the alias, or the service name if no alias was specified.\"</p>\n"}, {"comments": [{"owner": {"reputation": 57, "user_id": 4165225, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/lTP31.jpg?s=128&g=1", "display_name": "Muzammil Ahmed", "link": "https://stackoverflow.com/users/4165225/muzammil-ahmed"}, "edited": false, "score": 0, "creation_date": 1501065848, "post_id": 45322254, "comment_id": 77610869, "body": "Its making connection within the same container DB. I want to build connection with another container&#39;s DB."}], "tags": [], "owner": {"reputation": 414, "user_id": 6556383, "user_type": "registered", "accept_rate": 86, "profile_image": "https://lh4.googleusercontent.com/-rFjQCuJsaAk/AAAAAAAAAAI/AAAAAAAAEio/VDKKrZfNTtM/photo.jpg?sz=128", "display_name": "dendomenko", "link": "https://stackoverflow.com/users/6556383/dendomenko"}, "is_accepted": false, "score": 2, "last_activity_date": 1501059878, "creation_date": 1501059878, "answer_id": 45322254, "question_id": 45320696, "link": "https://stackoverflow.com/questions/45320696/how-two-docker-containers-communicate-each-other/45322254#45322254", "title": "How two docker containers communicate each other?", "body": "<p>Put database to <code>docker-compose.yml</code> and add link to it in your app</p>\n\n<pre><code>version: '2'\nservices:\n  db:\n    container_name: db\n    image: postgres:9.4.1\n    ports:\n      - \"5555:5555\"\n  app:\n    container_name: app\n    build: .\n    command: rails server --port 3000 --binding 0.0.0.0\n    ports:\n      - \"3000:3000\"\n    links:\n      - hobover_db\n    volumes:\n      - .:/app\n</code></pre>\n\n<p>and in <code>database.yml</code> put your container name as host:</p>\n\n<pre><code>development: &amp;default\n  adapter: postgresql\n  encoding: unicode\n  database: myapp_development\n  pool: 5\n  username: postgres\n  password:\n  host: db\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1103, "user_id": 6156340, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-hQfBBXrnbpI/AAAAAAAAAAI/AAAAAAAABP4/BK5aW9CX7S4/photo.jpg?sz=128", "display_name": "Wassim Dhif", "link": "https://stackoverflow.com/users/6156340/wassim-dhif"}, "edited": false, "score": 1, "creation_date": 1501064103, "post_id": 45323498, "comment_id": 77609639, "body": "Your containers IP can change, you should use the links in docker-compose, <a href=\"https://stackoverflow.com/questions/45320696/how-two-docker-containers-communicate-each-other/45321819#45321819\" title=\"how two docker containers communicate each other\">stackoverflow.com/questions/45320696/&hellip;</a>"}], "tags": [], "owner": {"reputation": 57, "user_id": 4165225, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/lTP31.jpg?s=128&g=1", "display_name": "Muzammil Ahmed", "link": "https://stackoverflow.com/users/4165225/muzammil-ahmed"}, "is_accepted": false, "score": 0, "last_activity_date": 1501062923, "creation_date": 1501062923, "answer_id": 45323498, "question_id": 45320696, "link": "https://stackoverflow.com/questions/45320696/how-two-docker-containers-communicate-each-other/45323498#45323498", "title": "How two docker containers communicate each other?", "body": "<p>I did it by using container 'A' IP into container 'B' database.yml file and its connected with PostgreSQL</p>\n\n<hr>\n"}, {"tags": [], "owner": {"reputation": 109, "user_id": 3428411, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c0fb9cdd1e5ac6b974ccdb2119c3a355?s=128&d=identicon&r=PG", "display_name": "S. Alekseenko", "link": "https://stackoverflow.com/users/3428411/s-alekseenko"}, "is_accepted": true, "score": 1, "last_activity_date": 1501076023, "creation_date": 1501076023, "answer_id": 45328541, "question_id": 45320696, "link": "https://stackoverflow.com/questions/45320696/how-two-docker-containers-communicate-each-other/45328541#45328541", "title": "How two docker containers communicate each other?", "body": "<p>Firstly, you can try to set up discourse in multi-container mode: <a href=\"https://github.com/discourse/discourse_docker#single-container-vs-multiple-container\" rel=\"nofollow noreferrer\">https://github.com/discourse/discourse_docker#single-container-vs-multiple-container</a>\nAfter than, you may have single docker-compse.yml file with struct:\napp, db (discourse database) and discourse_app.</p>\n\n<p>Secondly, you can try to run PostgreSQL to outside using <code>EXPOSE</code> operator.\nAdd to your app.yml:</p>\n\n<pre><code>expose:\n ...\n  - \"5432:5432\" # PostgreSQL ports\n</code></pre>\n\n<p>You must have password for postgres user:\nEnter the container:</p>\n\n<pre><code>su - postgres\npsql -d postgres -c \"ALTER USER postgres WITH PASSWORD '&lt;new password&gt;';\"\n</code></pre>\n\n<p>Also you can try to use Docker Networking, like this:</p>\n\n<pre><code>$ docker network ls\n\nNETWORK ID          NAME                DRIVER\n7fca4eb8c647        bridge              bridge\n9f904ee27bf5        none                null\ncf03ee007fb4        &lt;discourse_name&gt;    host\n</code></pre>\n\n<p>You will see network for Discourse container. You can try use it with your application.</p>\n\n<pre><code>version: '2'\nservices:\n  app:\n    build: .\n    command: bundle exec rails s -p 9000 -b '0.0.0.0'\n    volumes:\n       - \".:/slackcron\"\n    ports:\n      - \"9000:9000\"\nnetworks:\n  default:\n    external:\n      name: &lt;discourse_name&gt;\n</code></pre>\n\n<p>After than your RoR application will be run in same network.</p>\n"}], "owner": {"reputation": 57, "user_id": 4165225, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/lTP31.jpg?s=128&g=1", "display_name": "Muzammil Ahmed", "link": "https://stackoverflow.com/users/4165225/muzammil-ahmed"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 905, "favorite_count": 1, "accepted_answer_id": 45328541, "answer_count": 4, "score": 1, "last_activity_date": 1501076023, "creation_date": 1501055590, "question_id": 45320696, "link": "https://stackoverflow.com/questions/45320696/how-two-docker-containers-communicate-each-other", "title": "How two docker containers communicate each other?", "body": "<p>I've two containers and want to communicate with each other. Container 'A' consist discourse.org application with PostgreSQL database on port 5432, container 'B' has ROR application which running on port 1000. I want to make database connection with ROR app to PostgreSQL(which is in another container). How to connect ROR app with PostgreSQL database?</p>\n\n<h3>RoR Application, docker-compose.yml</h3>\n\n<pre><code>version: '2'\nservices:\n  app:\n    build: .\n    command: bundle exec rails s -p 9000 -b '0.0.0.0'\n    volumes:\n      - \".:/slackcron\"\n    ports:\n      - \"9000:9000\"\n</code></pre>\n\n<h3>RoR Application, database.yml</h3>\n\n<pre><code>development:\n  &lt;&lt;: *default\n  database: discourse\n  username: muzammil\n  password: '123'\n  host: 0.0.0.0\n  port: 5432\n</code></pre>\n\n<h3>docker ps</h3>\n\n<pre><code>CONTAINER ID        IMAGE                 COMMAND                  CREATED             STATUS              PORTS                                                                NAMES\n92a9cb961e56        slackcroncom_app      \"bundle exec rails...\"   47 seconds ago      Up 46 seconds       0.0.0.0:9000-&gt;9000/tcp                                               slackcroncom_app_1\nb727c2d0d5ba        local_discourse/app   \"/sbin/boot\"             10 minutes ago      Up 10 minutes       0.0.0.0:443-&gt;443/tcp, 0.0.0.0:5432-&gt;5432/tcp, 0.0.0.0:8080-&gt;80/tcp   app\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "methods"], "comments": [{"owner": {"reputation": 13441, "user_id": 2199600, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8sl6u.jpg?s=128&g=1", "display_name": "Igor Drozdov", "link": "https://stackoverflow.com/users/2199600/igor-drozdov"}, "edited": false, "score": 0, "creation_date": 1501055501, "post_id": 45320599, "comment_id": 77603261, "body": "yes, you&#39;re right, is some cases <code>user == nil</code> or <code>organization == nil</code>"}, {"owner": {"reputation": 1075, "user_id": 6561814, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/AiS9a.png?s=128&g=1", "display_name": "jonhue", "link": "https://stackoverflow.com/users/6561814/jonhue"}, "reply_to_user": {"reputation": 13441, "user_id": 2199600, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8sl6u.jpg?s=128&g=1", "display_name": "Igor Drozdov", "link": "https://stackoverflow.com/users/2199600/igor-drozdov"}, "edited": false, "score": 0, "creation_date": 1501055542, "post_id": 45320599, "comment_id": 77603284, "body": "@IgorDrozdov But then I&#39;d expect it to just jump to the next option."}], "answers": [{"comments": [{"owner": {"reputation": 1075, "user_id": 6561814, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/AiS9a.png?s=128&g=1", "display_name": "jonhue", "link": "https://stackoverflow.com/users/6561814/jonhue"}, "edited": false, "score": 0, "creation_date": 1501055677, "post_id": 45320706, "comment_id": 77603384, "body": "So not possible without conditions?"}, {"owner": {"reputation": 166, "user_id": 6549733, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/vyFYL.png?s=128&g=1", "display_name": "Rooby Doo", "link": "https://stackoverflow.com/users/6549733/rooby-doo"}, "reply_to_user": {"reputation": 1075, "user_id": 6561814, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/AiS9a.png?s=128&g=1", "display_name": "jonhue", "link": "https://stackoverflow.com/users/6561814/jonhue"}, "edited": false, "score": 1, "creation_date": 1501055888, "post_id": 45320706, "comment_id": 77603537, "body": "Not necessarily. You can use &quot;try&quot; as @max said."}], "tags": [], "owner": {"reputation": 166, "user_id": 6549733, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/vyFYL.png?s=128&g=1", "display_name": "Rooby Doo", "link": "https://stackoverflow.com/users/6549733/rooby-doo"}, "is_accepted": false, "score": 0, "last_activity_date": 1501055619, "creation_date": 1501055619, "answer_id": 45320706, "question_id": 45320599, "link": "https://stackoverflow.com/questions/45320599/ruby-throwing-undefined-method-error/45320706#45320706", "title": "Ruby: Throwing undefined method error", "body": "<p>Yes the error occurs when the user/organization is nil. It tries to get email from a nil class. So you can add conditions like <code>user.present? || organization.present?</code>. Get the email after passing through condition. If the condition fails have it as nil. </p>\n"}, {"comments": [{"owner": {"reputation": 1075, "user_id": 6561814, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/AiS9a.png?s=128&g=1", "display_name": "jonhue", "link": "https://stackoverflow.com/users/6561814/jonhue"}, "edited": false, "score": 0, "creation_date": 1501055793, "post_id": 45320709, "comment_id": 77603467, "body": "Didn&#39;t know about the safe navigation operator - nice!"}, {"owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "reply_to_user": {"reputation": 1075, "user_id": 6561814, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/AiS9a.png?s=128&g=1", "display_name": "jonhue", "link": "https://stackoverflow.com/users/6561814/jonhue"}, "edited": false, "score": 1, "creation_date": 1501055934, "post_id": 45320709, "comment_id": 77603571, "body": "@jonhue also note that the <code>self</code> here is unnecessary, unless you&#39;ve defined a local variable <code>user</code> in addition to the method with the same name."}], "tags": [], "owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "is_accepted": true, "score": 3, "last_activity_date": 1501055636, "creation_date": 1501055636, "answer_id": 45320709, "question_id": 45320599, "link": "https://stackoverflow.com/questions/45320599/ruby-throwing-undefined-method-error/45320709#45320709", "title": "Ruby: Throwing undefined method error", "body": "<p>In  <code>self.user.email</code>, if <code>self.user</code> is nill, then you can't call <code>email</code> on it. </p>\n\n<p>If you're using Ruby 2.3 or newer, you can use the <a href=\"http://mitrev.net/ruby/2015/11/13/the-operator-in-ruby/\" rel=\"nofollow noreferrer\">safe navigation operator</a>:</p>\n\n<pre><code>self.user&amp;.email || self.organization&amp;.email\n</code></pre>\n\n<p>Note the <code>|| nil</code> at the end is probably unneccesary. </p>\n\n<p>If you don't want to introduce a dependency to Ruby 2.3 or newer, you could use <a href=\"https://apidock.com/rails/v3.2.1/Object/try\" rel=\"nofollow noreferrer\">Object#try</a> from ActiveSupport (included with Rails):</p>\n\n<pre><code>self.user.try(:email) || self.organization.try(:email)\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 635, "user_id": 1027220, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/c3376bb6869ac5e702763b4e550d9447?s=128&d=identicon&r=PG", "display_name": "Natan Rubinstein", "link": "https://stackoverflow.com/users/1027220/natan-rubinstein"}, "edited": false, "score": 0, "creation_date": 1501055980, "post_id": 45320727, "comment_id": 77603597, "body": "another option is to do user.try(:email) || organization.try(:email). <a href=\"https://apidock.com/rails/NilClass/try\" rel=\"nofollow noreferrer\">apidock.com/rails/NilClass/try</a>  also the self is probably redundant"}, {"owner": {"reputation": 13441, "user_id": 2199600, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8sl6u.jpg?s=128&g=1", "display_name": "Igor Drozdov", "link": "https://stackoverflow.com/users/2199600/igor-drozdov"}, "reply_to_user": {"reputation": 635, "user_id": 1027220, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/c3376bb6869ac5e702763b4e550d9447?s=128&d=identicon&r=PG", "display_name": "Natan Rubinstein", "link": "https://stackoverflow.com/users/1027220/natan-rubinstein"}, "edited": false, "score": 0, "creation_date": 1501056067, "post_id": 45320727, "comment_id": 77603645, "body": "@NatanRubinstein Providing we developing Rails app. Then I&#39;d suggest using <code>NilClass#try!</code>"}], "tags": [], "owner": {"reputation": 13441, "user_id": 2199600, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8sl6u.jpg?s=128&g=1", "display_name": "Igor Drozdov", "link": "https://stackoverflow.com/users/2199600/igor-drozdov"}, "is_accepted": false, "score": 2, "last_activity_date": 1501055684, "creation_date": 1501055684, "answer_id": 45320727, "question_id": 45320599, "link": "https://stackoverflow.com/questions/45320599/ruby-throwing-undefined-method-error/45320727#45320727", "title": "Ruby: Throwing undefined method error", "body": "<p>The following code does what you're expecting:</p>\n\n<pre><code>user &amp;&amp; user.email || organization &amp;&amp; organization.email\n</code></pre>\n\n<p>If you're using <code>ruby &gt;= 2.3.0</code>, there's null propagation feature:</p>\n\n<pre><code>user&amp;.email || organization&amp;.email\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "is_accepted": false, "score": 0, "last_activity_date": 1501056768, "creation_date": 1501056768, "answer_id": 45321075, "question_id": 45320599, "link": "https://stackoverflow.com/questions/45320599/ruby-throwing-undefined-method-error/45321075#45321075", "title": "Ruby: Throwing undefined method error", "body": "<p>Just out of curiosity:</p>\n\n<pre><code>[user, organization].compact.map(&amp;:email).compact.first\n</code></pre>\n\n<p>or, for Ruby2.3+</p>\n\n<pre><code>[user, organization].compact.map(&amp;:email).detect(&amp;:itself)\n</code></pre>\n"}], "owner": {"reputation": 1075, "user_id": 6561814, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/AiS9a.png?s=128&g=1", "display_name": "jonhue", "link": "https://stackoverflow.com/users/6561814/jonhue"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 153, "favorite_count": 0, "accepted_answer_id": 45320709, "answer_count": 4, "score": -1, "last_activity_date": 1501056768, "creation_date": 1501055317, "question_id": 45320599, "link": "https://stackoverflow.com/questions/45320599/ruby-throwing-undefined-method-error", "title": "Ruby: Throwing undefined method error", "body": "<p>Running a statement like this:</p>\n\n<pre><code>self.user.email || self.organization.email || nil\n</code></pre>\n\n<p>Ruby throws the error <code>undefined method 'email' for nil:NilClass</code>, but it should just return <code>nil</code> instead. What am I doing wrong here?</p>\n\n<p>Does it occur because in some cases <code>user</code> || <code>organization</code> is <code>nil</code>?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "nginx", "capistrano", "unicorn"], "comments": [{"owner": {"reputation": 40732, "user_id": 984621, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/817afccebcbe3a4983a5e8c584f30373?s=128&d=identicon&r=PG", "display_name": "user984621", "link": "https://stackoverflow.com/users/984621/user984621"}, "reply_to_user": {"reputation": 1528, "user_id": 7573791, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0e5e5cf864fb33229ca56750a51d6674?s=128&d=identicon&r=PG&f=1", "display_name": "Sajin", "link": "https://stackoverflow.com/users/7573791/sajin"}, "edited": false, "score": 0, "creation_date": 1501054623, "post_id": 45319858, "comment_id": 77602647, "body": "When I log in on the server and run <code>sudo service unicorn_prioject start</code>, I get the error <code>Failed to start unicorn_project.service: Unit unicorn_project.service not found.</code>"}, {"owner": {"reputation": 40732, "user_id": 984621, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/817afccebcbe3a4983a5e8c584f30373?s=128&d=identicon&r=PG", "display_name": "user984621", "link": "https://stackoverflow.com/users/984621/user984621"}, "edited": false, "score": 0, "creation_date": 1501054710, "post_id": 45319858, "comment_id": 77602708, "body": "And when I go to the directory where my app is on the server and run <code>bundle exec unicorn -D -c &#47;home&#47;deployer&#47;apps&#47;[roject&#47;current&#47;config&#47;unicorn.rb -E production</code>, I get  <code>bundler: failed to load command: unicorn (&#47;home&#47;deployer&#47;apps&#47;project&#47;shared&#47;bundle&#47;ruby&#47;2.4.0&#47;bin&#47;un&zwnj;&#8203;icorn) ArgumentError: directory for pid=&#47;home&#47;deployer&#47;apps&#47;project&#47;current&#47;tmp&#47;pids&#47;unicorn.pid not writable...</code>"}, {"owner": {"reputation": 327, "user_id": 2957349, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bee69a2b969ba6d9ed96d5743a87fb8f?s=128&d=identicon&r=PG", "display_name": "skam", "link": "https://stackoverflow.com/users/2957349/skam"}, "edited": false, "score": 0, "creation_date": 1501056991, "post_id": 45319858, "comment_id": 77604248, "body": "does directory <code>pids</code> exist inside tmp ? and does it have required permissions ?"}], "owner": {"reputation": 40732, "user_id": 984621, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/817afccebcbe3a4983a5e8c584f30373?s=128&d=identicon&r=PG", "display_name": "user984621", "link": "https://stackoverflow.com/users/984621/user984621"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 337, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1501052978, "creation_date": 1501052978, "question_id": 45319858, "link": "https://stackoverflow.com/questions/45319858/capistrano-3-nginx-setup-502-bad-gateway", "title": "Capistrano 3 + nginx setup: 502 Bad Gateway", "body": "<p>I am deploying my app via Capistrano 3 to a Ubuntu server, the deployment process goes through well without any issues, but when I load my website (IP), I only get the error message <strong>502 Bad Gateway</strong>.</p>\n\n<p>My setup:</p>\n\n<p><strong>deploy.rb</strong>:</p>\n\n<pre><code>lock \"3.8.1\"\n\nset :application, \"project\"\nset :repo_url, \"git@bitbucket.org:username/project.git\"\nset :branch, \"master\"\nset :tmp_dir, '/home/deployer/tmp'\n\n#set :rvm_type, :user                     # Defaults to: :auto\n#set :rvm_ruby_version, '2.4.0'      # Defaults to: 'default'\n\n# Default branch is :master\n# ask :branch, `git rev-parse --abbrev-ref HEAD`.chomp\n\n# Default deploy_to directory is /var/www/my_app_name\n# set :deploy_to, \"/var/www/my_app_name\"\n\n# Default value for :format is :airbrussh.\n# set :format, :airbrussh\n\n# You can configure the Airbrussh format using :format_options.\n# These are the defaults.\n# set :format_options, command_output: true, log_file: \"log/capistrano.log\", color: :auto, truncate: :auto\n\n# Default value for :pty is false\n# set :pty, true\n\n# Default value for :linked_files is []\n# append :linked_files, \"config/database.yml\", \"config/secrets.yml\"\n\n# Default value for linked_dirs is []\n# append :linked_dirs, \"log\", \"tmp/pids\", \"tmp/cache\", \"tmp/sockets\", \"public/system\"\n\n# Default value for default_env is {}\n# set :default_env, { path: \"/opt/ruby/bin:$PATH\" }\n\n# Default value for keep_releases is 5\nset :keep_releases, 5\n\n\nset(:executable_config_files, %w(\n  unicorn_init.sh\n))\n\n# files which need to be symlinked to other parts of the\n# filesystem. For example nginx virtualhosts, log rotation\n# init scripts etc.\nset(:symlinks, [\n  {\n    source: \"nginx.conf\",\n    link: \"/etc/nginx/sites-enabled/default}\"\n  },\n  {\n    source: \"unicorn_init.sh\",\n    link: \"/etc/init.d/unicorn_#{fetch(:application)}\"\n  },\n  {\n    source: \"log_rotation\",\n   link: \"/etc/logrotate.d/#{fetch(:application)}\"\n  },\n  {\n    source: \"monit\",\n    link: \"/etc/monit/conf.d/#{fetch(:application)}.conf\"\n  }\n])\n\n\n\nnamespace :deploy do\n  desc 'Stop Unicorn'\n  task :stop do\n    on roles(:app) do\n      if test(\"[ -f #{fetch(:unicorn_pid)} ]\")\n        execute :kill, capture(:cat, fetch(:unicorn_pid))\n      end\n    end\n  end\n\n  desc 'Start Unicorn'\n  task :start do\n    on roles(:app) do\n      within current_path do\n        with rails_env: fetch(:rails_env) do\n          execute :bundle, \"exec unicorn -c #{fetch(:unicorn_config)} -D\"\n        end\n      end\n    end\n  end\n\n  desc 'Reload Unicorn without killing master process'\n  task :reload do\n    on roles(:app) do\n      if test(\"[ -f #{fetch(:unicorn_pid)} ]\")\n        execute :kill, '-s USR2', capture(:cat, fetch(:unicorn_pid))\n      else\n        error 'Unicorn process not running'\n      end\n    end\n  end\n\n  desc 'Restart Unicorn'\n  task :restart\n  before :restart, :stop\n  before :restart, :start\n\n=begin\n  task :setup_config do\n    on roles(:app) do\n      sudo \"ln -nfs #{current_path}/config/nginx.conf /etc/nginx/sites-enabled/default\"\n      sudo \"ln -nfs #{current_path}/config/unicorn_init.sh /etc/init.d/unicorn_#{application}\"\n      run \"mkdir -p #{shared_path}/config\"\n      put File.read(\"config/database.example.yml\"), \"#{shared_path}/config/database.yml\"\n      puts \"Now edit the config files in #{shared_path}.\"\n    end\n  end\n  after \"deploy:setup\", \"deploy:setup_config\"\n\n  task :symlink_config do\n    on roles(:app) do\n      run \"ln -nfs #{shared_path}/config/database.yml #{release_path}/config/database.yml\"\n    end\n  end\n  after \"deploy:finalize_update\", \"deploy:symlink_config\"\n=end\n  desc \"Make sure local git is in sync with remote.\"\n  task :check_revision do\n    on roles(:web) do\n      unless `git rev-parse HEAD` == `git rev-parse origin/master`\n        puts \"WARNING: HEAD is not the same as origin/master\"\n        puts \"Run `git push` to sync changes.\"\n        exit\n      end\n    end\n  end\n  before \"deploy\", \"deploy:check_revision\"\nend\n</code></pre>\n\n<p><strong>unicorn.rb</strong></p>\n\n<pre><code>root = \"/home/deployer/apps/project/current\"\nworking_directory root\n\npid \"#{root}/tmp/pids/unicorn.pid\"\n\nstderr_path \"#{root}/log/unicorn.log\"\nstdout_path \"#{root}/log/unicorn.log\"\n\nworker_processes Integer(ENV['WEB_CONCURRENCY'])\ntimeout 30\npreload_app true\n\nlisten '/tmp/unicorn.project.sock', backlog: 64\n\nbefore_fork do |server, worker|\n  Signal.trap 'TERM' do\n    puts 'Unicorn master intercepting TERM and sending myself QUIT instead'\n    Process.kill 'QUIT', Process.pid\n  end\n\n  defined?(ActiveRecord::Base) and\n    ActiveRecord::Base.connection.disconnect!\nend\n\nafter_fork do |server, worker|\n  Signal.trap 'TERM' do\n    puts 'Unicorn worker intercepting TERM and doing nothing. Wait for master to send QUIT'\n  end\n\n  defined?(ActiveRecord::Base) and\n    ActiveRecord::Base.establish_connection\nend\n\n# Force the bundler gemfile environment variable to\n# reference the capistrano \"current\" symlink\nbefore_exec do |_|\n  ENV['BUNDLE_GEMFILE'] = File.join(root, 'Gemfile')\nend\n</code></pre>\n\n<p>on the server: <strong>/etc/nginx/sites-enabled/default</strong></p>\n\n<pre><code>upstream unicorn {\n  server unix:/tmp/unicorn.project.sock fail_timeout=0;\n}\n\nserver {\n  listen 80 default deferred;\n  # server_name example.com;\n  root /home/deployer/apps/project/current/public;\n\n  location ^~ /assets/ {\n    gzip_static on;\n    expires max;\n    add_header Cache-Control public;\n  }\n\n  location ~ ^/(robots.txt|sitemap.xml.gz)/ {\n    root /home/deployer/apps/project/current/public;\n  }\n\n  try_files $uri/index.html $uri @unicorn;\n  location @unicorn {\n    proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;\n    proxy_set_header Host $http_host;\n    proxy_redirect off;\n    proxy_pass http://unicorn;\n  }\n\n  error_page 500 502 503 504 /500.html;\n  client_max_body_size 4G;\n  keepalive_timeout 10;\n}\n</code></pre>\n\n<p>error log from <strong>/var/log/nginx/error.log</strong>:</p>\n\n<pre><code>2017/07/26 06:57:55 [crit] 25631#25631: *1879 connect() to unix:/tmp/unicorn.project.sock failed (2: No such file or directory) while connecting to upstream, client: IP, server: , request: \"GET /favicon.ico HTTP/1.1\", upstream: \"http://unix:/tmp/unicorn.project.sock:/500.html\", host: \"IP\", referrer: \"http://IP/\"\n</code></pre>\n\n<p>How do I solve this error message? I checked the paths, it should be correct, not typos etc.</p>\n\n<p>Also, don't I miss anything (symlinks?) in <strong>deploy.rb</strong> to \"refresh\" the <strong>/etc/nginx/sites-enabled/default</strong> file?</p>\n\n<p>Thank you for every advance.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "scope", "associations", "ruby-on-rails-5"], "answers": [{"comments": [{"owner": {"reputation": 1075, "user_id": 6561814, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/AiS9a.png?s=128&g=1", "display_name": "jonhue", "link": "https://stackoverflow.com/users/6561814/jonhue"}, "edited": false, "score": 0, "creation_date": 1501051313, "post_id": 45318869, "comment_id": 77600409, "body": "Well .........  :)"}], "tags": [], "owner": {"reputation": 1528, "user_id": 7573791, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0e5e5cf864fb33229ca56750a51d6674?s=128&d=identicon&r=PG&f=1", "display_name": "Sajin", "link": "https://stackoverflow.com/users/7573791/sajin"}, "is_accepted": true, "score": 1, "last_activity_date": 1501049828, "creation_date": 1501049828, "answer_id": 45318869, "question_id": 45318765, "link": "https://stackoverflow.com/questions/45318765/rails-scoped-association-resulting-in-error/45318869#45318869", "title": "Rails: Scoped association resulting in error", "body": "<p>Try</p>\n\n<pre><code>has_many :payment_informations, -&gt; { order(position: :asc) }, class_name: 'Customer::PaymentInformation', dependent: :destroy\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1075, "user_id": 6561814, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/AiS9a.png?s=128&g=1", "display_name": "jonhue", "link": "https://stackoverflow.com/users/6561814/jonhue"}, "edited": false, "score": 0, "creation_date": 1501051275, "post_id": 45319124, "comment_id": 77600384, "body": "Thanks for the explanation!"}], "tags": [], "owner": {"reputation": 166, "user_id": 6549733, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/vyFYL.png?s=128&g=1", "display_name": "Rooby Doo", "link": "https://stackoverflow.com/users/6549733/rooby-doo"}, "is_accepted": false, "score": 1, "last_activity_date": 1501050700, "creation_date": 1501050700, "answer_id": 45319124, "question_id": 45318765, "link": "https://stackoverflow.com/questions/45318765/rails-scoped-association-resulting-in-error/45319124#45319124", "title": "Rails: Scoped association resulting in error", "body": "<pre><code>has_many(name, scope = nil, options = {}, &amp;extension)\n</code></pre>\n\n<p>This is the order has_many expects. </p>\n"}], "owner": {"reputation": 1075, "user_id": 6561814, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/AiS9a.png?s=128&g=1", "display_name": "jonhue", "link": "https://stackoverflow.com/users/6561814/jonhue"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 25, "favorite_count": 0, "closed_date": 1501052587, "accepted_answer_id": 45318869, "answer_count": 2, "score": 0, "last_activity_date": 1501050700, "creation_date": 1501049520, "question_id": 45318765, "link": "https://stackoverflow.com/questions/45318765/rails-scoped-association-resulting-in-error", "closed_reason": "Duplicate", "title": "Rails: Scoped association resulting in error", "body": "<p>In a model I have the following scoped association:</p>\n\n<p><em>customer.rb:38</em></p>\n\n<pre><code>has_many :payment_informations, class_name: 'Customer::PaymentInformation', dependent: :destroy, -&gt; { order(position: :asc) }\n</code></pre>\n\n<p>Error:</p>\n\n<blockquote>\n  <p>syntax error, unexpected '\\n', expecting =></p>\n</blockquote>\n\n<p>--</p>\n\n<p>What am I doing wrong here? The error only occurs when scoping the asscoiation.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "activerecord", "active-model-serializers"], "comments": [{"owner": {"reputation": 2673, "user_id": 4172728, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/FQpL7.jpg?s=128&g=1", "display_name": "Gokul", "link": "https://stackoverflow.com/users/4172728/gokul"}, "edited": false, "score": 0, "creation_date": 1501048326, "post_id": 45318360, "comment_id": 77598814, "body": "Post the received <code>params</code> (See server log)"}], "answers": [{"comments": [{"owner": {"reputation": 494, "user_id": 6207614, "user_type": "registered", "accept_rate": 59, "profile_image": "https://i.stack.imgur.com/rkn57.jpg?s=128&g=1", "display_name": "cahyowhy", "link": "https://stackoverflow.com/users/6207614/cahyowhy"}, "edited": false, "score": 0, "creation_date": 1501049701, "post_id": 45318677, "comment_id": 77599485, "body": "its work but it replied    =&gt; {     &quot;imageposts.post&quot;: [         &quot;must exist&quot;     ] }. while i has a post_id attributes"}, {"owner": {"reputation": 13441, "user_id": 2199600, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8sl6u.jpg?s=128&g=1", "display_name": "Igor Drozdov", "link": "https://stackoverflow.com/users/2199600/igor-drozdov"}, "reply_to_user": {"reputation": 494, "user_id": 6207614, "user_type": "registered", "accept_rate": 59, "profile_image": "https://i.stack.imgur.com/rkn57.jpg?s=128&g=1", "display_name": "cahyowhy", "link": "https://stackoverflow.com/users/6207614/cahyowhy"}, "edited": false, "score": 0, "creation_date": 1501050052, "post_id": 45318677, "comment_id": 77599669, "body": "Hm, please, try <code>has_many :imageposts, inverse_of: :post</code> in the Post model. Let&#39;s see if it helps"}], "tags": [], "owner": {"reputation": 13441, "user_id": 2199600, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8sl6u.jpg?s=128&g=1", "display_name": "Igor Drozdov", "link": "https://stackoverflow.com/users/2199600/igor-drozdov"}, "is_accepted": true, "score": 1, "last_activity_date": 1501049256, "creation_date": 1501049256, "answer_id": 45318677, "question_id": 45318360, "link": "https://stackoverflow.com/questions/45318360/rails-strong-parameter-error-on-array-attribute/45318677#45318677", "title": "rails strong parameter error on array attribute", "body": "<p>The <code>strong params</code> are fine. The problem is that <code>imageposts</code> is an association, but, just a guess, it is tried to be set as an attribute <code>post.update_attributes(post_params)</code></p>\n\n<p>If you want it to be updated like this, the possible solution is to use <code>accepts_nested_attributes_for</code>:</p>\n\n<p>Your model must have something like:</p>\n\n<pre><code>class Post\n  belongs_to :user\n  has_many :imageposts\n  accepts_nested_attributes_for :imageposts\nend\n</code></pre>\n\n<p>And the name of params must be <code>imageposts_attributes</code> instead of just <code>imageposts</code>:</p>\n\n<pre><code>def post_params\n  params.require(:post).permit(:title, :user_id, :description, :category, :imageposts_attributes =&gt; [:imageurl])\nend\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 9, "user_id": 6613001, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rgJ2n.jpg?s=128&g=1", "display_name": "Ali Raza", "link": "https://stackoverflow.com/users/6613001/ali-raza"}, "is_accepted": false, "score": 0, "last_activity_date": 1501060783, "last_edit_date": 1501060783, "creation_date": 1501049523, "answer_id": 45318766, "question_id": 45318360, "link": "https://stackoverflow.com/questions/45318360/rails-strong-parameter-error-on-array-attribute/45318766#45318766", "title": "rails strong parameter error on array attribute", "body": "<p>You are passing multiple images. So you can use <code>coocoon gem</code> with <code>accepts_nested_attributes_for</code></p>\n\n<p>for more info <a href=\"https://github.com/nathanvda/cocoon\" rel=\"nofollow noreferrer\">https://github.com/nathanvda/cocoon</a></p>\n"}], "owner": {"reputation": 494, "user_id": 6207614, "user_type": "registered", "accept_rate": 59, "profile_image": "https://i.stack.imgur.com/rkn57.jpg?s=128&g=1", "display_name": "cahyowhy", "link": "https://stackoverflow.com/users/6207614/cahyowhy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 74, "favorite_count": 0, "accepted_answer_id": 45318677, "answer_count": 2, "score": 0, "last_activity_date": 1501060783, "creation_date": 1501048008, "last_edit_date": 1501048686, "question_id": 45318360, "link": "https://stackoverflow.com/questions/45318360/rails-strong-parameter-error-on-array-attribute", "title": "rails strong parameter error on array attribute", "body": "<p>i try to post my json to rails server with this request body</p>\n\n<pre><code>    {\"post\":{\n    \"user_id\": 2,\n    \"title\": \"kehangatan di pagi hari\",\n    \"category\": \"kehangatan di pagi hari\",\n    \"imageposts\": [{\"imageurl\":\"DJAWHDAHWDKJHAW DHJAWDHAWDAWDAD\"}],\n    \"description\":\"&lt;p&gt;memang sange&lt;/p&gt;\"\n  } }\n</code></pre>\n\n<p>and this is my posts_params</p>\n\n<pre><code>  def post_params\n    params.require(:post).permit(:title, :user_id, :description, :category, :imageposts =&gt; [:imageurl])\n  end\n</code></pre>\n\n<p>unfortunately when i make an ajax post i got an error in my terminal</p>\n\n<pre><code>#&lt;ActiveRecord::AssociationTypeMismatch: Imagepost(#42287660) expected, got ActiveSupport::HashWithIndifferentAccess(#30074960)&gt;\n</code></pre>\n\n<p>i've trying this to my imageposts strong parameter but it doesnt work too</p>\n\n<pre><code>imageposts: [:imageurl]\n</code></pre>\n\n<p>can anybody solve this...</p>\n"}, {"tags": ["ruby", "variables", "block"], "comments": [{"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 1, "creation_date": 1501047006, "post_id": 45317818, "comment_id": 77598228, "body": "\u201cWhy are they so?\u201d\u2014because blocks in ruby are closures."}, {"owner": {"reputation": 209, "user_id": 2163495, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/cffad3a83f86235196140261f86526b9?s=128&d=identicon&r=PG", "display_name": "L_G", "link": "https://stackoverflow.com/users/2163495/l-g"}, "reply_to_user": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1501049915, "post_id": 45317818, "comment_id": 77599599, "body": "but why the 2rd block can change &#39;y&#39;\uff1f"}], "answers": [{"comments": [{"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 1, "creation_date": 1501046358, "post_id": 45317936, "comment_id": 77597951, "body": "Technically there is another issue; in the first snippet there are no local variables crossing boundaries of the method definition."}], "tags": [], "owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "is_accepted": false, "score": 2, "last_activity_date": 1501045896, "creation_date": 1501045896, "answer_id": 45317936, "question_id": 45317818, "link": "https://stackoverflow.com/questions/45317818/ruby-block-variable-scope-within-out-the-method/45317936#45317936", "title": "Ruby block variable scope within/out the method", "body": "<p>That is how the scope of a local variable is defined. A local variable can percolate into a block, but not into a method definition.</p>\n"}, {"comments": [{"owner": {"reputation": 209, "user_id": 2163495, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/cffad3a83f86235196140261f86526b9?s=128&d=identicon&r=PG", "display_name": "L_G", "link": "https://stackoverflow.com/users/2163495/l-g"}, "edited": false, "score": 0, "creation_date": 1501055121, "post_id": 45319107, "comment_id": 77603006, "body": "that makes sense for test1, but how about test2\uff1fit seems &quot;Ruby knows what&#39;s going on inside the block&quot;, So y is changed to 20. am I right\uff1f thankyou"}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "reply_to_user": {"reputation": 209, "user_id": 2163495, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/cffad3a83f86235196140261f86526b9?s=128&d=identicon&r=PG", "display_name": "L_G", "link": "https://stackoverflow.com/users/2163495/l-g"}, "edited": false, "score": 0, "creation_date": 1501057774, "post_id": 45319107, "comment_id": 77604773, "body": "In Test 2, it is because <code>y</code> is  defined before the block that <code>y</code> in the  block is the same <code>y</code>. If you remove <code>y = 1</code> and you run the code (try it) you"}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "reply_to_user": {"reputation": 209, "user_id": 2163495, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/cffad3a83f86235196140261f86526b9?s=128&d=identicon&r=PG", "display_name": "L_G", "link": "https://stackoverflow.com/users/2163495/l-g"}, "edited": false, "score": 0, "creation_date": 1501059096, "post_id": 45319107, "comment_id": 77605735, "body": "It is because <code>y</code> is initialized before the block that it is the same <code>y</code> inside the block. Remove <code>y = 1</code> and <code>[x,y]</code> will raise an exception: &quot;Name error: undefined local variable &#39;y&#39;&quot;. It has to be that way for the block to be able to use previously-defined variables in the block calculations. Here <code>y = 1.upto(2) { |x| 20 }</code> would work (but it doesn&#39;t make much sense)."}], "tags": [], "owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "is_accepted": false, "score": 1, "last_activity_date": 1501051061, "last_edit_date": 1501051061, "creation_date": 1501050642, "answer_id": 45319107, "question_id": 45317818, "link": "https://stackoverflow.com/questions/45317818/ruby-block-variable-scope-within-out-the-method/45319107#45319107", "title": "Ruby block variable scope within/out the method", "body": "<pre><code>def myblock\n  x = 1\n  y = 1\n  z = yield(x)\n  puts \"y=#{y}, z=#{z}\"\n  [x, y]\nend\n\nmyblock do |x|\n y = 10\nend\ny=1, z=10\n  #=&gt; [1, 1]\n</code></pre>\n\n<p>This shows that three things are going on here:</p>\n\n<ul>\n<li>The <code>y</code> in the block is unrelated to the <code>y</code> in <code>myblock</code>. That's because the scope of the <code>y</code> in the block is confined to the block. Ruby can only get her hands on what is returned by the block, not on what's going on inside of it.</li>\n<li>The block does indeed return the value of <code>y</code> in the block, but only because <code>y = 10</code> was the last statement executed in the block. The execution of that statement returns <code>10</code>, so <code>10</code> is returned by the block. Had the block contained <code>y = 10; 7</code>, <code>7</code> would have been returned.</li>\n<li>The value of <code>yield(x)</code> is not captured by the variable <code>y</code> in <code>myblock</code>, so it has no effect.<sup>1</sup>.</li>\n</ul>\n\n<p><sup>1 It's a little-known fact that Ruby actually shoots such values into outer space.</sup></p>\n"}, {"tags": [], "owner": {"reputation": 209, "user_id": 2163495, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/cffad3a83f86235196140261f86526b9?s=128&d=identicon&r=PG", "display_name": "L_G", "link": "https://stackoverflow.com/users/2163495/l-g"}, "is_accepted": false, "score": 0, "last_activity_date": 1501059819, "creation_date": 1501059819, "answer_id": 45322233, "question_id": 45317818, "link": "https://stackoverflow.com/questions/45317818/ruby-block-variable-scope-within-out-the-method/45322233#45322233", "title": "Ruby block variable scope within/out the method", "body": "<p>After more testing and searching:</p>\n\n<p>For Test1, x and y is method level local variable and they don't share the scope with block. y in the block is a new local variable(block level).</p>\n\n<p>For Test2, x and y is class level local variable and they share the scope with block, y in the block is still the outside y(class level).</p>\n\n<p>It's all because I messed up the scope, thanks all.</p>\n"}], "owner": {"reputation": 209, "user_id": 2163495, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/cffad3a83f86235196140261f86526b9?s=128&d=identicon&r=PG", "display_name": "L_G", "link": "https://stackoverflow.com/users/2163495/l-g"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 289, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1501059819, "creation_date": 1501045234, "last_edit_date": 1501046066, "question_id": 45317818, "link": "https://stackoverflow.com/questions/45317818/ruby-block-variable-scope-within-out-the-method", "title": "Ruby block variable scope within/out the method", "body": "<p>I get the following different results:</p>\n\n<p>Test 1:</p>\n\n<pre><code>def myblock\n  x = 1\n  y = 1\n  yield(x)\n  [x, y]\nend\n\nmyblock do |x|\n y = 10\nend\n# =&gt; [1,1]\n</code></pre>\n\n<p>Test 2:</p>\n\n<pre><code>x = 1\ny = 1\n\n1.upto(2) do |x|\n  y = 20\nend\n[x,y]\n# =&gt; [1,20]\n</code></pre>\n\n<p>Variables created outside the block are available in the block. Why are they so?</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 0, "creation_date": 1501044089, "post_id": 45317518, "comment_id": 77597163, "body": "What is your question?"}, {"owner": {"reputation": 181, "user_id": 8151655, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a7e99fe1f4d67898437e083f5a3417f8?s=128&d=identicon&r=PG&f=1", "display_name": "LizzyTheLearner", "link": "https://stackoverflow.com/users/8151655/lizzythelearner"}, "reply_to_user": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 0, "creation_date": 1501045402, "post_id": 45317518, "comment_id": 77597589, "body": "@sawa edited the question"}], "answers": [{"comments": [{"owner": {"reputation": 181, "user_id": 8151655, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a7e99fe1f4d67898437e083f5a3417f8?s=128&d=identicon&r=PG&f=1", "display_name": "LizzyTheLearner", "link": "https://stackoverflow.com/users/8151655/lizzythelearner"}, "edited": false, "score": 0, "creation_date": 1501045564, "post_id": 45317710, "comment_id": 77597649, "body": "Hey Gerry, thanks for answering. But I get the same  error. Maybe I&#39;m entering the code wrong. I updated the last portion of  my question with the code I added, does that look right to you?"}, {"owner": {"reputation": 9659, "user_id": 6136634, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d7487290ff90aebf6848d9c638c067bb?s=128&d=identicon&r=PG", "display_name": "Gerry", "link": "https://stackoverflow.com/users/6136634/gerry"}, "reply_to_user": {"reputation": 181, "user_id": 8151655, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a7e99fe1f4d67898437e083f5a3417f8?s=128&d=identicon&r=PG&f=1", "display_name": "LizzyTheLearner", "link": "https://stackoverflow.com/users/8151655/lizzythelearner"}, "edited": false, "score": 0, "creation_date": 1501045804, "post_id": 45317710, "comment_id": 77597736, "body": "@LizzyTheLearner Ohh,  actually <code>@video.video_params.empty?</code> is wrong (i missed that), it should be <code>video_params.empty?</code>. And you must do that check <b>before</b> <code>@video = Video.new(video_params)</code>. Check updated answer (actually, you won&#39;t need to modify <code>video_params</code> at all)."}, {"owner": {"reputation": 181, "user_id": 8151655, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a7e99fe1f4d67898437e083f5a3417f8?s=128&d=identicon&r=PG&f=1", "display_name": "LizzyTheLearner", "link": "https://stackoverflow.com/users/8151655/lizzythelearner"}, "edited": false, "score": 0, "creation_date": 1501046429, "post_id": 45317710, "comment_id": 77597979, "body": "Hey Gerry, thank you so much for helping me. But I am getting this error now: <code>undefined method empty? for nil:NilClass</code> . It is referring the <code>return render &#39;new&#39; if params[:video].empty?</code>"}, {"owner": {"reputation": 9659, "user_id": 6136634, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d7487290ff90aebf6848d9c638c067bb?s=128&d=identicon&r=PG", "display_name": "Gerry", "link": "https://stackoverflow.com/users/6136634/gerry"}, "reply_to_user": {"reputation": 181, "user_id": 8151655, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a7e99fe1f4d67898437e083f5a3417f8?s=128&d=identicon&r=PG&f=1", "display_name": "LizzyTheLearner", "link": "https://stackoverflow.com/users/8151655/lizzythelearner"}, "edited": false, "score": 0, "creation_date": 1501046555, "post_id": 45317710, "comment_id": 77598036, "body": "@LizzyTheLearner Sorry, <code>empty?</code> is not the right method, change it to <code>blank?</code> (i always fall on this)."}, {"owner": {"reputation": 3004, "user_id": 5830036, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/B2b06.png?s=128&g=1", "display_name": "Mayur Shah", "link": "https://stackoverflow.com/users/5830036/mayur-shah"}, "edited": false, "score": 0, "creation_date": 1501046568, "post_id": 45317710, "comment_id": 77598045, "body": "Use <code>return render &#39;new&#39; if params[:video].present?</code>"}, {"owner": {"reputation": 9659, "user_id": 6136634, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d7487290ff90aebf6848d9c638c067bb?s=128&d=identicon&r=PG", "display_name": "Gerry", "link": "https://stackoverflow.com/users/6136634/gerry"}, "reply_to_user": {"reputation": 3004, "user_id": 5830036, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/B2b06.png?s=128&g=1", "display_name": "Mayur Shah", "link": "https://stackoverflow.com/users/5830036/mayur-shah"}, "edited": false, "score": 0, "creation_date": 1501046646, "post_id": 45317710, "comment_id": 77598071, "body": "@MayurShah That will work too, but you will need to change <code>if</code> to <code>unless</code>."}, {"owner": {"reputation": 3004, "user_id": 5830036, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/B2b06.png?s=128&g=1", "display_name": "Mayur Shah", "link": "https://stackoverflow.com/users/5830036/mayur-shah"}, "edited": false, "score": 0, "creation_date": 1501046737, "post_id": 45317710, "comment_id": 77598111, "body": "@Gerry no need to change <code>if</code> to <code>unless</code>, it should be <code>return render &#39;new&#39; if !params[:video].present?</code> simple"}, {"owner": {"reputation": 181, "user_id": 8151655, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a7e99fe1f4d67898437e083f5a3417f8?s=128&d=identicon&r=PG&f=1", "display_name": "LizzyTheLearner", "link": "https://stackoverflow.com/users/8151655/lizzythelearner"}, "edited": false, "score": 0, "creation_date": 1501046911, "post_id": 45317710, "comment_id": 77598182, "body": "Hey guys, I just posted what I did. I totally blanked on adding that small line of code. Thanks a lot for helping ya&#39;ll"}, {"owner": {"reputation": 9659, "user_id": 6136634, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d7487290ff90aebf6848d9c638c067bb?s=128&d=identicon&r=PG", "display_name": "Gerry", "link": "https://stackoverflow.com/users/6136634/gerry"}, "reply_to_user": {"reputation": 3004, "user_id": 5830036, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/B2b06.png?s=128&g=1", "display_name": "Mayur Shah", "link": "https://stackoverflow.com/users/5830036/mayur-shah"}, "edited": false, "score": 0, "creation_date": 1501046938, "post_id": 45317710, "comment_id": 77598197, "body": "@MayurShah Yes, negating <code>if</code> will output same result."}, {"owner": {"reputation": 9659, "user_id": 6136634, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d7487290ff90aebf6848d9c638c067bb?s=128&d=identicon&r=PG", "display_name": "Gerry", "link": "https://stackoverflow.com/users/6136634/gerry"}, "reply_to_user": {"reputation": 181, "user_id": 8151655, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a7e99fe1f4d67898437e083f5a3417f8?s=128&d=identicon&r=PG&f=1", "display_name": "LizzyTheLearner", "link": "https://stackoverflow.com/users/8151655/lizzythelearner"}, "edited": false, "score": 0, "creation_date": 1501047401, "post_id": 45317710, "comment_id": 77598413, "body": "@LizzyTheLearner Good, you found a solution! :)"}], "tags": [], "owner": {"reputation": 9659, "user_id": 6136634, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d7487290ff90aebf6848d9c638c067bb?s=128&d=identicon&r=PG", "display_name": "Gerry", "link": "https://stackoverflow.com/users/6136634/gerry"}, "is_accepted": false, "score": 1, "last_activity_date": 1501048496, "last_edit_date": 1501048496, "creation_date": 1501044660, "answer_id": 45317710, "question_id": 45317518, "link": "https://stackoverflow.com/questions/45317518/render-new-form-if-params-are-empty/45317710#45317710", "title": "Render new form if params are empty", "body": "<p>To properly check if <code>video</code> is empty you could do this:</p>\n\n<pre><code>def create\n    return render 'new' if params[:video].blank?\n\n    @video = Video.new(video_params)\n    @video.userinfo_id = @userinformation.id\n    @video.user_id = current_user.id\n\n    if @video.save\n        redirect_to userinfo_path(@userinformation)\n    else\n        render 'new'\n    end\nend\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 9659, "user_id": 6136634, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d7487290ff90aebf6848d9c638c067bb?s=128&d=identicon&r=PG", "display_name": "Gerry", "link": "https://stackoverflow.com/users/6136634/gerry"}, "edited": false, "score": 2, "creation_date": 1501047341, "post_id": 45318132, "comment_id": 77598383, "body": "Thats a good solution too! Just keep in mind that some browers may not support this attribute (older browsers and i&#39;m not sure if Safari supports it at all), so be sure to test properly."}], "tags": [], "owner": {"reputation": 181, "user_id": 8151655, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a7e99fe1f4d67898437e083f5a3417f8?s=128&d=identicon&r=PG&f=1", "display_name": "LizzyTheLearner", "link": "https://stackoverflow.com/users/8151655/lizzythelearner"}, "is_accepted": false, "score": 0, "last_activity_date": 1501046924, "last_edit_date": 1501046924, "creation_date": 1501046836, "answer_id": 45318132, "question_id": 45317518, "link": "https://stackoverflow.com/questions/45317518/render-new-form-if-params-are-empty/45318132#45318132", "title": "Render new form if params are empty", "body": "<p>if anyone needs to know, the way I went around it is, I added a <code>required: true</code> to the end of the <code>file_field</code> in the form. This way, it doesn't let the user submit the form without choosing a file.</p>\n"}], "owner": {"reputation": 181, "user_id": 8151655, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a7e99fe1f4d67898437e083f5a3417f8?s=128&d=identicon&r=PG&f=1", "display_name": "LizzyTheLearner", "link": "https://stackoverflow.com/users/8151655/lizzythelearner"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 155, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1501048496, "creation_date": 1501043540, "last_edit_date": 1501045379, "question_id": 45317518, "link": "https://stackoverflow.com/questions/45317518/render-new-form-if-params-are-empty", "title": "Render new form if params are empty", "body": "<p>I have a video upload form. It works well when a video is chosen from the computer and submitted. The video gets uploaded. But if a user clicks on the submit button without selecting a video, it throws the following error:</p>\n\n<pre><code>ActionController::ParameterMissing in VideosController#create\nparam is missing or the value is empty: video\n</code></pre>\n\n<p>What am I doing wrong here?</p>\n\n<p>This is my video controller:</p>\n\n<pre><code>class VideosController &lt; ApplicationController\n    before_action :find_userinfo\n    before_action :find_video, only: [:destroy]\n    before_action :authenticate_user!, only: [:new]\n\n    def index\n    end\n\n    def new\n        @video = Video.new\n    end\n\n    def create\n        @video = Video.new(video_params)\n        @video.userinfo_id = @userinformation.id\n        @video.user_id = current_user.id\n\n\n        if @video.save\n            redirect_to userinfo_path(@userinformation)\n        else\n            render 'new'\n        end\n    end\n\n    def edit\n    end\n\n    def update\n    end\n\n    def destroy\n        @video.destroy\n        redirect_to userinfo_path(@userinformation)\n    end\n\n    private\n        def video_params\n            params.require(:video).permit(:introvideo)\n        end\n\n        def find_userinfo\n            @userinformation = Userinfo.friendly.find(params[:userinfo_id])\n        end\n\n        def find_video\n            @video = Video.find(params[:id])\n        end\nend\n</code></pre>\n\n<p>My form view:</p>\n\n<pre><code>&lt;%= simple_form_for([@userinformation, @userinformation.videos.build]) do |f| %&gt;\n    &lt;%= f.file_field :introvideo%&gt;\n    &lt;%= f.button :submit, 'Upload video'%&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>I tried adding the following code to my controller but still didn't work:</p>\n\n<pre><code>def create\n    @video = Video.new(video_params)\n    @video.userinfo_id = @userinformation.id\n    @video.user_id = current_user.id\n\n    if @video.video_params.empty?\n        render 'new'\n    end\n\n    if @video.save\n        redirect_to userinfo_path(@userinformation)\n    else\n        render 'new'\n    end\nend\n</code></pre>\n\n<p>Any help is appreciated. Thanks.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "routing"], "comments": [{"owner": {"reputation": 1223, "user_id": 3012473, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/gSYLc.png?s=128&g=1", "display_name": "buncis", "link": "https://stackoverflow.com/users/3012473/buncis"}, "edited": false, "score": 0, "creation_date": 1501041583, "post_id": 45317099, "comment_id": 77596430, "body": "can you share the rake routes output?, what is prefix of the routes?"}, {"owner": {"reputation": 71, "user_id": 2963365, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/681879e4efe284ac9d844bc57c249d58?s=128&d=identicon&r=PG&f=1", "display_name": "user2963365", "link": "https://stackoverflow.com/users/2963365/user2963365"}, "reply_to_user": {"reputation": 1223, "user_id": 3012473, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/gSYLc.png?s=128&g=1", "display_name": "buncis", "link": "https://stackoverflow.com/users/3012473/buncis"}, "edited": false, "score": 0, "creation_date": 1501042068, "post_id": 45317099, "comment_id": 77596553, "body": "just edited the post, see the inserted picture"}], "answers": [{"comments": [{"owner": {"reputation": 71, "user_id": 2963365, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/681879e4efe284ac9d844bc57c249d58?s=128&d=identicon&r=PG&f=1", "display_name": "user2963365", "link": "https://stackoverflow.com/users/2963365/user2963365"}, "edited": false, "score": 0, "creation_date": 1501045759, "post_id": 45317568, "comment_id": 77597711, "body": "Thank you, that fixed the error I was getting. However now it seems to be calling the pages#show action and displaying the pages/show view. The view_details action isn&#39;t being executed at all. Do you know what could be causing this?"}, {"owner": {"reputation": 71, "user_id": 2963365, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/681879e4efe284ac9d844bc57c249d58?s=128&d=identicon&r=PG&f=1", "display_name": "user2963365", "link": "https://stackoverflow.com/users/2963365/user2963365"}, "edited": false, "score": 0, "creation_date": 1501046140, "post_id": 45317568, "comment_id": 77597860, "body": "nevermind, I was able to fix it using <a href=\"https://stackoverflow.com/questions/30633639/controller-method-show-getting-called\" title=\"controller method show getting called\">stackoverflow.com/questions/30633639/&hellip;</a>"}], "tags": [], "owner": {"reputation": 9659, "user_id": 6136634, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d7487290ff90aebf6848d9c638c067bb?s=128&d=identicon&r=PG", "display_name": "Gerry", "link": "https://stackoverflow.com/users/6136634/gerry"}, "is_accepted": true, "score": 3, "last_activity_date": 1501043833, "creation_date": 1501043833, "answer_id": 45317568, "question_id": 45317099, "link": "https://stackoverflow.com/questions/45317099/routing-with-parameters-in-ruby-on-rails/45317568#45317568", "title": "Routing with Parameters in Ruby on Rails", "body": "<p>The problem is that you are passing a <em>hash</em> as a value for <code>location</code> parameter so, instead of just adding one parameter (i.e. <code>location</code>), it adds two parameters (i.e. <code>latitud</code> and <code>longitude</code>) and your routing fails. </p>\n\n<p>To fix this you could set your route without <code>location</code>, like this:</p>\n\n<pre><code>get 'pages/view_details', to: 'pages#view_details'\n</code></pre>\n\n<p>Now, using the same link you have now, you will receive <code>latitud</code> and <code>longitude</code> parameters grouped in <code>location</code> as a <strong>query string</strong>, something similar to:</p>\n\n<pre><code>pages/view_details?location%5Blatitude%5D=37.3505570824247&amp;location%5Blongitude%5D=121.922104884669\n</code></pre>\n\n<p>And you can use them in your controller with <code>params</code> (as with any other parameter), for example:</p>\n\n<pre><code>latitude = params[:location][:latitude]\nlongitud = params[:location][:longitude]\n</code></pre>\n"}], "owner": {"reputation": 71, "user_id": 2963365, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/681879e4efe284ac9d844bc57c249d58?s=128&d=identicon&r=PG&f=1", "display_name": "user2963365", "link": "https://stackoverflow.com/users/2963365/user2963365"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4304, "favorite_count": 0, "accepted_answer_id": 45317568, "answer_count": 1, "score": 2, "last_activity_date": 1501043833, "creation_date": 1501040908, "last_edit_date": 1501042041, "question_id": 45317099, "link": "https://stackoverflow.com/questions/45317099/routing-with-parameters-in-ruby-on-rails", "title": "Routing with Parameters in Ruby on Rails", "body": "<p>I'm new to rails, and I'm struggling with handling the routing correctly. \nRight now I have a link called \"details,\" and when the user clicks on it I would like the method \"view_details\" (within the pages controller) to be called with a location parameter that I'm passing in:</p>\n\n<pre><code>&lt;%= link_to \"Details\", :controller =&gt; \"pages\", :action =&gt; \"view_details\", \n:location =&gt;  v[\"coordinates\"]%&gt;\n</code></pre>\n\n<p>In my routes.rb file, I have:</p>\n\n<pre><code>get 'pages/view_details/:location', to: 'pages#view_details'\n</code></pre>\n\n<p>I am getting the following error:\n    No route matches [GET] \n    \"/pages/view_details/latitude=37.3505570824247&amp;longitude=-121.922104884669\"</p>\n\n<p>When I rake routes, I see this (with no prefix):\n<a href=\"https://i.stack.imgur.com/MgYhE.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/MgYhE.png\" alt=\"\"></a></p>\n\n<p>How can I fix this?</p>\n"}, {"tags": ["ruby", "tdd", "sublimetext3"], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 8367130, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-PP5E5qmTthY/AAAAAAAAAAI/AAAAAAAAABU/pT4yZkrMjWg/photo.jpg?sz=128", "display_name": "Burping Ushi", "link": "https://stackoverflow.com/users/8367130/burping-ushi"}, "edited": false, "score": 0, "creation_date": 1501084215, "post_id": 45319553, "comment_id": 77625451, "body": "did install the TestRspec package but had encountered this:  <code>ERROR: Could not find &#39;spec&#47;&#39; folder traversing back from the file (path mentioned) INFO: Error occurred, see more in &#39;View -&gt; Show Console INFO: Project root None</code>"}, {"owner": {"reputation": 13101, "user_id": 6059896, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PQiTP.gif?s=128&g=1", "display_name": "tukan", "link": "https://stackoverflow.com/users/6059896/tukan"}, "reply_to_user": {"reputation": 13, "user_id": 8367130, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-PP5E5qmTthY/AAAAAAAAAAI/AAAAAAAAABU/pT4yZkrMjWg/photo.jpg?sz=128", "display_name": "Burping Ushi", "link": "https://stackoverflow.com/users/8367130/burping-ushi"}, "edited": false, "score": 0, "creation_date": 1501138018, "post_id": 45319553, "comment_id": 77647796, "body": "Well that is issue in your project which you did not provide.  <code>Rspec</code> plugin expects you to have <code>spec&#47;</code> folder in your project.  You should create it and store there your tests."}], "tags": [], "owner": {"reputation": 13101, "user_id": 6059896, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PQiTP.gif?s=128&g=1", "display_name": "tukan", "link": "https://stackoverflow.com/users/6059896/tukan"}, "is_accepted": true, "score": 1, "last_activity_date": 1501051995, "creation_date": 1501051995, "answer_id": 45319553, "question_id": 45316570, "link": "https://stackoverflow.com/questions/45316570/how-do-i-run-ruby-unit-tests-within-sublime-sublime-text-3/45319553#45319553", "title": "how do I run ruby unit tests within sublime (sublime text 3)?", "body": "<p>I think you are looking for package <a href=\"https://packagecontrol.io/packages/TestRSpec\" rel=\"nofollow noreferrer\"><code>TestRSpec</code></a>. Which looks like this:<a href=\"https://i.stack.imgur.com/1fMZL.gif\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/1fMZL.gif\" alt=\"TestRSpec screenshot\"></a></p>\n"}], "owner": {"reputation": 13, "user_id": 8367130, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-PP5E5qmTthY/AAAAAAAAAAI/AAAAAAAAABU/pT4yZkrMjWg/photo.jpg?sz=128", "display_name": "Burping Ushi", "link": "https://stackoverflow.com/users/8367130/burping-ushi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 516, "favorite_count": 0, "accepted_answer_id": 45319553, "answer_count": 1, "score": 1, "last_activity_date": 1501051995, "creation_date": 1501037198, "last_edit_date": 1501037811, "question_id": 45316570, "link": "https://stackoverflow.com/questions/45316570/how-do-i-run-ruby-unit-tests-within-sublime-sublime-text-3", "title": "how do I run ruby unit tests within sublime (sublime text 3)?", "body": "<p>How do I run ruby unit tests within sublime (sublime text 3)? currently using rspec and terminal </p>\n"}, {"tags": ["ruby"], "owner": {"reputation": 11, "user_id": 8365928, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1dad58c2880001f698a34008830996a9?s=128&d=identicon&r=PG&f=1", "display_name": "sai", "link": "https://stackoverflow.com/users/8365928/sai"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 22, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1501036391, "creation_date": 1501036391, "question_id": 45316455, "link": "https://stackoverflow.com/questions/45316455/unknown-property-method-wait-on-ec2-windows-server-instance", "title": "unknown property method: &#39;wait&#39; on EC2 windows server Instance", "body": "<p>I am running ruby script  via terminal on windows instance \u201cWindows Server 2012 R2\u201d but facing error I.e.\n\u201cunknown property or method: `Wait'\n          HRESULT error code:0x80020006\n            Unknown name. (NoMethodError) \u201c</p>\n\n<p>Where as the same script is working on my windows machine. Note: Ruby version, DevKit, Gems, Ruby code &amp; mode of execution is same for both PC\u2019s(i.e mine &amp; EC2 WIN instance).</p>\n\n<p>Only difference is, EC2 is a windows server and mine not. Please help me out in resolving above issue.</p>\n"}, {"tags": ["sql", "ruby", "rails-activerecord"], "answers": [{"comments": [{"owner": {"reputation": 370, "user_id": 4526617, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3fc0643deb79dffedb7bf9dfdc9d9346?s=128&d=identicon&r=PG&f=1", "display_name": "Kavincat", "link": "https://stackoverflow.com/users/4526617/kavincat"}, "edited": false, "score": 0, "creation_date": 1501031726, "post_id": 45315843, "comment_id": 77594006, "body": "That will return me empty array []."}, {"owner": {"reputation": 9659, "user_id": 6136634, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d7487290ff90aebf6848d9c638c067bb?s=128&d=identicon&r=PG", "display_name": "Gerry", "link": "https://stackoverflow.com/users/6136634/gerry"}, "reply_to_user": {"reputation": 370, "user_id": 4526617, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3fc0643deb79dffedb7bf9dfdc9d9346?s=128&d=identicon&r=PG&f=1", "display_name": "Kavincat", "link": "https://stackoverflow.com/users/4526617/kavincat"}, "edited": false, "score": 0, "creation_date": 1501032133, "post_id": 45315843, "comment_id": 77594101, "body": "@Kavincat Sorry, i missed that you are using a serialized field; check updated answer."}, {"owner": {"reputation": 9659, "user_id": 6136634, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d7487290ff90aebf6848d9c638c067bb?s=128&d=identicon&r=PG", "display_name": "Gerry", "link": "https://stackoverflow.com/users/6136634/gerry"}, "reply_to_user": {"reputation": 370, "user_id": 4526617, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3fc0643deb79dffedb7bf9dfdc9d9346?s=128&d=identicon&r=PG&f=1", "display_name": "Kavincat", "link": "https://stackoverflow.com/users/4526617/kavincat"}, "edited": false, "score": 0, "creation_date": 1501032572, "post_id": 45315843, "comment_id": 77594195, "body": "@Kavincat After some testing i think i figured out how to do it with sql; check updated answer (again)."}, {"owner": {"reputation": 370, "user_id": 4526617, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3fc0643deb79dffedb7bf9dfdc9d9346?s=128&d=identicon&r=PG&f=1", "display_name": "Kavincat", "link": "https://stackoverflow.com/users/4526617/kavincat"}, "edited": false, "score": 0, "creation_date": 1501034002, "post_id": 45315843, "comment_id": 77594519, "body": "@Thanks but the query with <code>include?</code> (which you have posted before) was 2x faster than this."}, {"owner": {"reputation": 9659, "user_id": 6136634, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d7487290ff90aebf6848d9c638c067bb?s=128&d=identicon&r=PG", "display_name": "Gerry", "link": "https://stackoverflow.com/users/6136634/gerry"}, "reply_to_user": {"reputation": 370, "user_id": 4526617, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3fc0643deb79dffedb7bf9dfdc9d9346?s=128&d=identicon&r=PG&f=1", "display_name": "Kavincat", "link": "https://stackoverflow.com/users/4526617/kavincat"}, "edited": false, "score": 0, "creation_date": 1501034178, "post_id": 45315843, "comment_id": 77594574, "body": "@Kavincat Oh i&#39;ll add the two options then :)"}], "tags": [], "owner": {"reputation": 9659, "user_id": 6136634, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d7487290ff90aebf6848d9c638c067bb?s=128&d=identicon&r=PG", "display_name": "Gerry", "link": "https://stackoverflow.com/users/6136634/gerry"}, "is_accepted": true, "score": 1, "last_activity_date": 1501034120, "last_edit_date": 1501034120, "creation_date": 1501031627, "answer_id": 45315843, "question_id": 45315764, "link": "https://stackoverflow.com/questions/45315764/how-to-get-the-exact-matched-record-in-rails-3/45315843#45315843", "title": "How to get the exact matched record in rails 3?", "body": "<p>Serialized arrays add a <code>\\n</code> at the end of each item, so you can try this:</p>\n\n<pre><code>Item.where(\"item_collection LIKE ?\", \"%LAPTOP\\n%\")\n</code></pre>\n\n<p>Another option would be to fetch all the data and then filter it with <code>select</code>, like this:</p>\n\n<pre><code>Item.all.select { |item| item.item_collection.include?(:LAPTOP) }\n</code></pre>\n"}], "owner": {"reputation": 370, "user_id": 4526617, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3fc0643deb79dffedb7bf9dfdc9d9346?s=128&d=identicon&r=PG&f=1", "display_name": "Kavincat", "link": "https://stackoverflow.com/users/4526617/kavincat"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 37, "favorite_count": 0, "accepted_answer_id": 45315843, "answer_count": 1, "score": 0, "last_activity_date": 1501034120, "creation_date": 1501030968, "last_edit_date": 1501031518, "question_id": 45315764, "link": "https://stackoverflow.com/questions/45315764/how-to-get-the-exact-matched-record-in-rails-3", "title": "How to get the exact matched record in rails 3?", "body": "<p>Items in the database:</p>\n\n<pre><code> =&gt; [#&lt;Item id: 1, item_collection: [:LAPTOP, :COMPUTER, :MOUSE, :SPEAKER]&gt;, \n     #&lt;Item id: 2, item_collection: [:LAPTOPANDKEYBOARD, :DISK, :SCREEN]&gt;] \n</code></pre>\n\n<p>Below query will give me both the records (which include LAPTOP and LAPTOPANDKEYBOARD).</p>\n\n<pre><code>Item.where(\"item_collection like ?\", \"%LAPTOP%\")\n\n =&gt; [#&lt;Item id: 1, item_collection: [:LAPTOP, :COMPUTER, :MOUSE, :SPEAKER]&gt;, \n     #&lt;Item id: 2, item_collection: [:LAPTOPANDKEYBOARD, :DISK, :SCREEN]&gt;] \n</code></pre>\n\n<p>But I only want the record which has LAPTOP only.</p>\n\n<pre><code>#&lt;Item id: 1, item_collection: [:LAPTOP, :COMPUTER, :MOUSE, :SPEAKER]&gt;\n</code></pre>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 1, "creation_date": 1501033527, "post_id": 45315669, "comment_id": 77594423, "body": "What is your question?"}], "answers": [{"comments": [{"owner": {"reputation": 109, "user_id": 8221041, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/67423f3262540ba0ad52c99bd7d6184e?s=128&d=identicon&r=PG&f=1", "display_name": "stuartambient", "link": "https://stackoverflow.com/users/8221041/stuartambient"}, "edited": false, "score": 0, "creation_date": 1501031473, "post_id": 45315739, "comment_id": 77593949, "body": "Well it looked promising but right now I&#39;m getting an <code>&quot;undefined method &#39;join&#39; for nil:Nilclass</code>"}, {"owner": {"reputation": 109, "user_id": 8221041, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/67423f3262540ba0ad52c99bd7d6184e?s=128&d=identicon&r=PG&f=1", "display_name": "stuartambient", "link": "https://stackoverflow.com/users/8221041/stuartambient"}, "edited": false, "score": 0, "creation_date": 1501032088, "post_id": 45315739, "comment_id": 77594090, "body": "update it is working! @m. simon borg I just had to removed the <code>deciphered.join</code> after the <code>end</code>  Works great, much appreciated."}], "tags": [], "owner": {"reputation": 2216, "user_id": 7165275, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d8ad41f944f38348a30791dc7f7d02c?s=128&d=identicon&r=PG&f=1", "display_name": "m. simon borg", "link": "https://stackoverflow.com/users/7165275/m-simon-borg"}, "is_accepted": true, "score": 0, "last_activity_date": 1501030795, "creation_date": 1501030795, "answer_id": 45315739, "question_id": 45315669, "link": "https://stackoverflow.com/questions/45315669/trying-to-concat-2-arrays-that-are-output-from-the-map-method/45315739#45315739", "title": "Trying to concat 2 arrays that are output from the map method", "body": "<pre><code>  sc = str.split(/\\s\\s\\s/)\n\n  deciphered = sc.map do |string|\n    string.split(' ').map {|key| morsecode[key]; }.join\n  end\n\n  deciphered.join(' ')\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "is_accepted": false, "score": 1, "last_activity_date": 1501049265, "last_edit_date": 1501049265, "creation_date": 1501048474, "answer_id": 45318475, "question_id": 45315669, "link": "https://stackoverflow.com/questions/45315669/trying-to-concat-2-arrays-that-are-output-from-the-map-method/45318475#45318475", "title": "Trying to concat 2 arrays that are output from the map method", "body": "<p>There is no need to convert the string to an array, then convert the elements of the array to arrays, join the latter arrays then join the former array. Instead one can simply use the form of <a href=\"http://ruby-doc.org/core-2.4.0/String.html#method-i-gsub\" rel=\"nofollow noreferrer\">String#gsub</a> that employs a hash to make substitutions.</p>\n\n<pre><code>morsecode = {  \".-\"=&gt;\"a\", \"-...\"=&gt;\"b\", \"-.-.\"=&gt;\"c\",  \"-..\"=&gt;\"d\",    \".\"=&gt;\"e\", \"..-.\"=&gt;\"f\",\n              \"--.\"=&gt;\"g\", \"....\"=&gt;\"h\",   \"..\"=&gt;\"i\", \".---\"=&gt;\"j\",  \"-.-\"=&gt;\"k\", \".-..\"=&gt;\"l\",\n               \"--\"=&gt;\"m\",   \"-.\"=&gt;\"n\",  \"---\"=&gt;\"o\", \".--.\"=&gt;\"p\", \"--.-\"=&gt;\"q\",  \".-.\"=&gt;\"r\",\n              \"...\"=&gt;\"s\",    \"-\"=&gt;\"t\",  \"..-\"=&gt;\"u\", \"...-\"=&gt;\"v\",  \".--\"=&gt;\"w\", \"-..-\"=&gt;\"x\",\n             \"-.--\"=&gt;\"y\", \"--..\"=&gt;\"z\",  \"   \"=&gt;\" \",    \" \"=&gt;\"\"}\n</code></pre>\n\n<p>Notice the last two key-value pairs in <code>morsecode</code>.</p>\n\n<pre><code>'.... . -.--   .--- ..- -.. .'.gsub(/[.-]+|   | /, morsecode)\n  #=&gt; \"hey jude\"\n</code></pre>\n\n<p>The regular expression reads, \"match one or more <a href=\"https://en.wikipedia.org/wiki/Morse_code\" rel=\"nofollow noreferrer\">dits and dahs</a> <em>or</em> three spaces <em>or</em> one space\". Note that three spaces must precede the single space in the regex.</p>\n"}], "owner": {"reputation": 109, "user_id": 8221041, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/67423f3262540ba0ad52c99bd7d6184e?s=128&d=identicon&r=PG&f=1", "display_name": "stuartambient", "link": "https://stackoverflow.com/users/8221041/stuartambient"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 64, "favorite_count": 0, "accepted_answer_id": 45315739, "answer_count": 2, "score": 0, "last_activity_date": 1501049265, "creation_date": 1501030301, "last_edit_date": 1501030719, "question_id": 45315669, "link": "https://stackoverflow.com/questions/45315669/trying-to-concat-2-arrays-that-are-output-from-the-map-method", "title": "Trying to concat 2 arrays that are output from the map method", "body": "<p>I'm doing a 'morse code' exercise and running into some difficulty. I'll skip posting the hash I created that stores the code and the letter. </p>\n\n<p>The morse code in the method call has 3 spaces between the 'words'  Example - </p>\n\n<pre><code>decodeMorse('.... . -.--   .--- ..- -.. .')\n</code></pre>\n\n<p>My strategy was to split the words first using <code>split(/\\s\\s\\s/)</code> which gives me separate arrays for each word, but then those arrays need a <code>split(' ')</code> to get to the letters. </p>\n\n<p>This is my code  - </p>\n\n<pre><code>  sc = str.split(/\\s\\s\\s/)\n    sc.each do |string|\n      string.split(' ').map {|key| morsecode[key]; }\n</code></pre>\n\n<p>It works okay, but I'm left with two arrays at the end:</p>\n\n<pre><code>=&gt; [\"h\", \"e\", \"y\"]\n=&gt; [\"j\", \"u\", \"d\", \"e\"]\n</code></pre>\n\n<p>Normally, if I had two or more arrays that had assigned variable names I would know how to concat them but what I've tried and searched on hasn't changed the situation.  Obviously all I get from join('') is the two words together with no space between them.</p>\n"}, {"tags": ["ruby-on-rails", "json", "ruby"], "comments": [{"owner": {"reputation": 2090, "user_id": 5113690, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/cbKBX.png?s=128&g=1", "display_name": "m3characters", "link": "https://stackoverflow.com/users/5113690/m3characters"}, "edited": false, "score": 0, "creation_date": 1501029764, "post_id": 45315523, "comment_id": 77593584, "body": "check this <a href=\"https://stackoverflow.com/a/6225321/5113690\">stackoverflow.com/a/6225321/5113690</a>"}], "answers": [{"comments": [{"owner": {"reputation": 789, "user_id": 5030271, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/94768f7cf8157dc056a26b95991e2b3d?s=128&d=identicon&r=PG&f=1", "display_name": "DNorthrup", "link": "https://stackoverflow.com/users/5030271/dnorthrup"}, "edited": false, "score": 0, "creation_date": 1501070482, "post_id": 45324899, "comment_id": 77614284, "body": "Thanks - Yea the genre things was actually part of my issue on the successful ones. My issue is right now when it gets to any of the columns that are blank, I get a response similar to that of  `NoMethodError: undefined method[]&#39; for nil:NilClass`` - I will try with your logic of having data predefined because I hate the if blocks everywhere."}], "tags": [], "owner": {"reputation": 31, "user_id": 7427735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd7238bababfa6fa59804904fb0e7bc9?s=128&d=identicon&r=PG", "display_name": "Marcin Raszkiewicz", "link": "https://stackoverflow.com/users/7427735/marcin-raszkiewicz"}, "is_accepted": false, "score": 0, "last_activity_date": 1501066556, "creation_date": 1501066556, "answer_id": 45324899, "question_id": 45315523, "link": "https://stackoverflow.com/questions/45315523/rake-task-to-parse-json-some-objects-might-be-missing/45324899#45324899", "title": "Rake Task to parse JSON, some objects might be missing", "body": "<pre><code>games = SteamGame.first(10)\ngames.each do |game|\n    base_url = \"http://store.steampowered.com/api/appdetails?appids=#{game['appid']}\"\n    puts \"base_url: #{base_url}\"\n    results = open(base_url) { |f|\n        result = JSON.parse(f.read)\n        game_appid = game[:appid].to_s\n        result_for_appid = result[game_appid]\n        result_data = result_for_appid[:data]\n        puts result.inspect\n        next if result_for_appid[:success] == false\n        type = result_data[:type]\n        detailed_description = result_data[:detailed_description]\n        about_the_game = result_data[:about_the_game]\n        short_description = result_data[:short_description]\n        supported_languages = result_data[:supported_languages]\n        if result_data[:dlc].present?\n            dlc = result_data[:dlc].flatten\n        end\n        is_free = result_data[:is_free]\n        required_age = result_data[:required_age]\n        # genres = result_data[:genres].map { |g| g[:description] }\n        # Your provided JSON didn't contain 'genres' inside 'data'\n        developers = result_data[:developers]\n        publishers = result_data[:publishers]\n        windows = result_data[:platforms][:windows]\n        mac = result_data[:platforms][:mac]\n        metacritic_score = result_data[:metacritic][:score]\n        metacritic_link = result_data[:metacritic][:url]\n        # game.update_attributes(genres: genres, detailed_description: detailed_description)\n        # Your provided JSON didn't contain 'genres' inside 'data' so no update for this\n        game.update_attributes(detailed_description: detailed_description)\n\n        puts game.inspect\n    }\n    end\nend\n</code></pre>\n\n<p>Few tips for this: \nDRY - Don't Repeat Yourself\nYou can access json keys as symbols\nYou didn't have \"genres' in Your provided JSON\nYou don't have to use IF's - when there's no data You will get: variable = nil. You can later update attributes regarding variables values.</p>\n"}], "owner": {"reputation": 789, "user_id": 5030271, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/94768f7cf8157dc056a26b95991e2b3d?s=128&d=identicon&r=PG&f=1", "display_name": "DNorthrup", "link": "https://stackoverflow.com/users/5030271/dnorthrup"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 93, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1501066556, "creation_date": 1501029035, "last_edit_date": 1501032365, "question_id": 45315523, "link": "https://stackoverflow.com/questions/45315523/rake-task-to-parse-json-some-objects-might-be-missing", "title": "Rake Task to parse JSON, some objects might be missing", "body": "<p>I made a simple Rake Task to parse some JSON and I'm using it to apply some attributes to a game collection.</p>\n\n<p>To avoid a massive list of JSON in this block the JSON can be previewed <a href=\"http://store.steampowered.com/api/appdetails?appids=212160\" rel=\"nofollow noreferrer\">here</a>\nand <a href=\"http://store.steampowered.com/api/appdetails?appids=10\" rel=\"nofollow noreferrer\">here</a> - These are from the Steam Store's API returning game details. My rake worked when I was only pulling two pieces of information present on every single record (Assuming it was a success)</p>\n\n<pre><code>desc 'update steam game info'\n\nnamespace :update_steam_games do\n\n    task scrape_info: :environment do\n     require 'open-uri'\n    #require 'nokogiri'\n    require 'json'\n\n    games = SteamGame.first(10)\n    games.each do |game|\n        base_url = \"http://store.steampowered.com/api/appdetails?appids=#{game['appid']}\"\n        puts \"base_url: #{base_url}\"\n        results = open(base_url) { |f|\n            result = JSON.parse(f.read)\n            puts result.inspect\n            next if result[game['appid'].to_s]['success'] == false\n            type = result[game['appid'].to_s]['data']['type']\n            detailed_description = result[game['appid'].to_s]['data']['detailed_description']\n            about_the_game = result[game['appid'].to_s]['data']['about_the_game']\n            short_description = result[game['appid'].to_s]['data']['short_description']\n            supported_languages = result[game['appid'].to_s]['data']['supported_languages']\n            if !result[game['appid'].to_s]['data']['dlc'].nil?\n                dlc = result[game['appid'].to_s]['data']['dlc'].flatten\n            end\n            is_free = result[game['appid'].to_s]['data']['is_free']\n            required_age = result[game['appid'].to_s]['data']['required_age']\n            genres = result[game['appid'].to_s]['data']['genres'].map { |g| g['description'] }\n            developers = result[game['appid'].to_s]['data']['developers']\n            publishers = result[game['appid'].to_s]['data']['publishers']\n            windows = result[game['appid'].to_s]['data']['platforms']['windows']\n            mac = result[game['appid'].to_s]['data']['platforms']['mac']\n            metacritic_score = result[game['appid'].to_s]['data']['metacritic']['score']\n            metacritic_link = result[game['appid'].to_s]['data']['metacritic']['url']\n            #game.update_attributes(genres: genres, detailed_description: detailed_description)\n\n            puts game.inspect\n        }\n        end\n    end\nend\n</code></pre>\n\n<p>The current error I'm getting is \n<code>NoMethodError: undefined method</code>[]' for nil:NilClass` on line 34 - Which is also the end of the attribute assignment, so I am not sure it's directly related to that line.</p>\n\n<p>I did realize I was trying to store an boolean as an integer and have since fixed it, but am now getting this error.</p>\n\n<p>I've tried wrapping everything into a <code>if XXX .present?</code> wrapper, but then I get the as below</p>\n\n<pre><code>desc 'update steam game info'\n\nnamespace :update_steam_games do\n\n    task scrape_info: :environment do\n     require 'open-uri'\n    #require 'nokogiri'\n    require 'json'\n\n    games = SteamGame.first(10)\n    games.each do |game|\n        base_url = \"http://store.steampowered.com/api/appdetails?appids=#{game['appid']}\"\n        puts \"base_url: #{base_url}\"\n        results = open(base_url) { |f|\n            result = JSON.parse(f.read)\n            puts result.inspect\n            next if result[game['appid'].to_s]['success'] == false\n            if type = result[game['appid'].to_s]['data']['type'].present?\n                type = result[game['appid'].to_s]['data']['type']\n            end\n            if detailed_description = result[game['appid'].to_s]['data']['detailed_description'].present?\n                detailed_description = result[game['appid'].to_s]['data']['detailed_description']\n            end\n            if about_the_game = result[game['appid'].to_s]['data']['about_the_game'].present?\n                about_the_game = result[game['appid'].to_s]['data']['about_the_game']\n            end\n            if short_description = result[game['appid'].to_s]['data']['short_description'].present?\n                short_description = result[game['appid'].to_s]['data']['short_description']\n            end\n            if supported_languages = result[game['appid'].to_s]['data']['supported_languages'].present?\n                supported_languages = result[game['appid'].to_s]['data']['supported_languages']\n            end\n            if result[game['appid'].to_s]['data']['dlc'].present?.present?\n                    dlc = result[game['appid'].to_s]['data']['dlc'].flatten\n            end\n            if is_free = result[game['appid'].to_s]['data']['is_free'].present?\n                is_free = result[game['appid'].to_s]['data']['is_free']\n            end\n            if required_age = result[game['appid'].to_s]['data']['required_age'].present?\n                required_age = result[game['appid'].to_s]['data']['required_age']\n            end\n            if genres = result[game['appid'].to_s]['data']['genres'].map { |g| g['description'] }.present?\n                genres = result[game['appid'].to_s]['data']['genres'].map { |g| g['description'] }\n            end\n            if developers = result[game['appid'].to_s]['data']['developers'].present?\n                developers = result[game['appid'].to_s]['data']['developers']\n            end\n            if publishers = result[game['appid'].to_s]['data']['publishers'].present?\n                publishers = result[game['appid'].to_s]['data']['publishers']\n            end\n            if windows = result[game['appid'].to_s]['data']['platforms']['windows'].present?\n                windows = result[game['appid'].to_s]['data']['platforms']['windows']\n            end\n            if mac = result[game['appid'].to_s]['data']['platforms']['mac'].present?\n                mac = result[game['appid'].to_s]['data']['platforms']['mac']\n            end\n            if metacritic_score = result[game['appid'].to_s]['data']['metacritic']['score'].present?\n                metacritic_score = result[game['appid'].to_s]['data']['metacritic']['score']\n            end\n            if metacritic_link = result[game['appid'].to_s]['data']['metacritic']['url'].present?\n                metacritic_link = result[game['appid'].to_s]['data']['metacritic']['url']\n            end\n            #game.update_attributes(genres: genres, detailed_description: detailed_description)\n\n            puts game.inspect\n        }\n        end\n    end\nend\n</code></pre>\n\n<p>But I actually still end up with the same issue, in addition to the fact that I'm unsure how I'm going to even pass it to <code>game.update_attributes</code> without knowing if it even exists. </p>\n\n<p>How do I inspect what is actually the problem, and make this less redundant?</p>\n\n<p><strong>The JSON</strong></p>\n\n<p>In case you don't want to click the link I have provided a sample of the JSON here. I have removed some of it for bloat. The <code>10</code> that it starts with is the dynamic ID.</p>\n\n<pre><code>  \"10\": {\n    \"success\": true,\n    \"data\": {\n      \"type\": \"game\",\n      \"name\": \"Counter-Strike\",\n      \"steam_appid\": 10,\n      \"required_age\": 0,\n      \"is_free\": false,\n      \"detailed_description\": \"Play the world's number 1 online action game. Engage in an incredibly realistic brand of terrorist warfare in this wildly popular team-based game. Ally with teammates to complete strategic missions. Take out enemy sites. Rescue hostages. Your role affects your team's success. Your team's success affects your role.\",\n      \"about_the_game\": \"Play the world's number 1 online action game. Engage in an incredibly realistic brand of terrorist warfare in this wildly popular team-based game. Ally with teammates to complete strategic missions. Take out enemy sites. Rescue hostages. Your role affects your team's success. Your team's success affects your role.\",\n      \"short_description\": \"\",\n      \"supported_languages\": \"English, French, German, Italian, Spanish, Simplified Chinese, Traditional Chinese, Korean\",\n      \"header_image\": \"http://cdn.akamai.steamstatic.com/steam/apps/10/header.jpg?t=1447887426\",\n      \"website\": null,\n      \"pc_requirements\": {\n        \"minimum\": \"\\n\\t\\t\\t&lt;p&gt;&lt;strong&gt;Minimum:&lt;/strong&gt; 500 mhz processor, 96mb ram, 16mb video card, Windows XP, Mouse, Keyboard, Internet Connection&lt;br /&gt;&lt;/p&gt;\\n\\t\\t\\t&lt;p&gt;&lt;strong&gt;Recommended:&lt;/strong&gt; 800 mhz processor, 128mb ram, 32mb+ video card, Windows XP, Mouse, Keyboard, Internet Connection&lt;br /&gt;&lt;/p&gt;\\n\\t\\t\\t\"\n      },\n      \"mac_requirements\": {\n        \"minimum\": \"Minimum: OS X  Snow Leopard 10.6.3, 1GB RAM, 4GB Hard Drive Space,NVIDIA GeForce 8 or higher, ATI X1600 or higher, or Intel HD 3000 or higher Mouse, Keyboard, Internet Connection\"\n      },\n      \"linux_requirements\": {\n        \"minimum\": \"Minimum: Linux Ubuntu 12.04, Dual-core from Intel or AMD at 2.8 GHz, 1GB Memory, nVidia GeForce 8600/9600GT, ATI/AMD Radeaon HD2600/3600 (Graphic Drivers: nVidia 310, AMD 12.11), OpenGL 2.1, 4GB Hard Drive Space, OpenAL Compatible Sound Card\"\n      },\n      \"developers\": [\n        \"Valve\"\n      ],\n      \"publishers\": [\n        \"Valve\"\n      ],\n      \"price_overview\": {\n        \"currency\": \"USD\",\n        \"initial\": 999,\n        \"final\": 999,\n        \"discount_percent\": 0\n      },\n      \"packages\": [\n        7\n      ],\n      \"package_groups\": [\n        {\n          \"name\": \"default\",\n          \"title\": \"Buy Counter-Strike\",\n          \"description\": \"\",\n          \"selection_text\": \"Select a purchase option\",\n          \"save_text\": \"\",\n          \"display_type\": 0,\n          \"is_recurring_subscription\": \"false\",\n          \"subs\": [\n            {\n              \"packageid\": 7,\n              \"percent_savings_text\": \"\",\n              \"percent_savings\": 0,\n              \"option_text\": \"Counter-Strike: Condition Zero - $9.99\",\n              \"option_description\": \"\",\n              \"can_get_free_license\": \"0\",\n              \"is_free_license\": false,\n              \"price_in_cents_with_discount\": 999\n            }\n          ]\n        }\n      ],\n      \"platforms\": {\n        \"windows\": true,\n        \"mac\": true,\n        \"linux\": true\n      },\n      \"metacritic\": {\n        \"score\": 88,\n        \"url\": \"http://www.metacritic.com/game/pc/counter-strike?ftag=MCD-06-10aaa1f\"\n      }\n    }\n}\n</code></pre>\n\n<p><strong>Update</strong></p>\n\n<p>I realized that I can't check on the existance of <code>platform - windows</code> if <code>platform</code> doesn't exist. The code now successfully executes, however, I am having an issue writing since a lot of parameters may or may not be missing on every pass.</p>\n\n<p>What is the proper method to do this instead of the <code>if</code> blocks everywhere?</p>\n\n<p><strong>Update</strong></p>\n\n<p>My code now works after I realize I stupidly put the <code>if</code> block around the variable definement portion.</p>\n\n<p>However, this is still redundant. Is there a proper way to do this, or is this fine?</p>\n"}, {"tags": ["ruby", "xml", "web-services", "soap", "savon"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 7658783, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BekAG.jpg?s=128&g=1", "display_name": "Bradley T.", "link": "https://stackoverflow.com/users/7658783/bradley-t"}, "edited": false, "score": 0, "creation_date": 1501081738, "post_id": 45326333, "comment_id": 77623501, "body": "Doesn&#39;t seem to alleviate the problem. I tried wrapping in cdata tags but I think the main problem is that the whole payload is being passed as a string. How can I pass it as an object with only the orderXML string and passport as params?"}, {"owner": {"reputation": 377, "user_id": 693554, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3118813167b6e621ded999febc27f12b?s=128&d=identicon&r=PG", "display_name": "corthmann", "link": "https://stackoverflow.com/users/693554/corthmann"}, "reply_to_user": {"reputation": 1, "user_id": 7658783, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BekAG.jpg?s=128&g=1", "display_name": "Bradley T.", "link": "https://stackoverflow.com/users/7658783/bradley-t"}, "edited": false, "score": 0, "creation_date": 1501098809, "post_id": 45326333, "comment_id": 77634448, "body": "@BradleyT. can you try to execute the request with <code>log_level: :debug</code> (option for the <code>Savon.client</code> initialization) ? That will print the request/response and make it easy for you to verify if your code is escaping the whole payload or only the orderXML element as intended."}, {"owner": {"reputation": 377, "user_id": 693554, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3118813167b6e621ded999febc27f12b?s=128&d=identicon&r=PG", "display_name": "corthmann", "link": "https://stackoverflow.com/users/693554/corthmann"}, "reply_to_user": {"reputation": 1, "user_id": 7658783, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BekAG.jpg?s=128&g=1", "display_name": "Bradley T.", "link": "https://stackoverflow.com/users/7658783/bradley-t"}, "edited": false, "score": 0, "creation_date": 1501099012, "post_id": 45326333, "comment_id": 77634563, "body": "also. naturally you&#39;d only need to add: <code>.encode(xml: :text)</code> to the variable that contains the <code>orderXML</code> data"}, {"owner": {"reputation": 1, "user_id": 7658783, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BekAG.jpg?s=128&g=1", "display_name": "Bradley T.", "link": "https://stackoverflow.com/users/7658783/bradley-t"}, "edited": false, "score": 0, "creation_date": 1501165743, "post_id": 45326333, "comment_id": 77668773, "body": "I think that the problem is that the entire payload is currently one big string, when only the order, source, and hash should be strings. When I put a pry in and look at the xml payload that is being passed in, it&#39;s one big string including the version, encoding, envelope, body, etc."}], "tags": [], "owner": {"reputation": 377, "user_id": 693554, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3118813167b6e621ded999febc27f12b?s=128&d=identicon&r=PG", "display_name": "corthmann", "link": "https://stackoverflow.com/users/693554/corthmann"}, "is_accepted": false, "score": 0, "last_activity_date": 1501070665, "last_edit_date": 1501070665, "creation_date": 1501070332, "answer_id": 45326333, "question_id": 45315070, "link": "https://stackoverflow.com/questions/45315070/posting-xml-to-web-service-using-soap-savon-gem-in-ruby-on-rails/45326333#45326333", "title": "Posting XML to web service using SOAP Savon gem in ruby on rails", "body": "<p>From your description it looks like the API is expecting the <code>orderXML</code> element to be a string. I think the problem is that you put XML into the <code>orderXML</code> element, when the API is expecting it to contain a string.</p>\n\n<p>Escaping the contents of the <code>orderXML</code> element and sending it as a string should solve the problem.</p>\n\n<p>The code below shows one way of escaping XML strings:\n<code>\norder_xml_string.encode(xml: :text)\n</code></p>\n"}], "owner": {"reputation": 1, "user_id": 7658783, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BekAG.jpg?s=128&g=1", "display_name": "Bradley T.", "link": "https://stackoverflow.com/users/7658783/bradley-t"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 878, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1501070665, "creation_date": 1501025562, "last_edit_date": 1501026899, "question_id": 45315070, "link": "https://stackoverflow.com/questions/45315070/posting-xml-to-web-service-using-soap-savon-gem-in-ruby-on-rails", "title": "Posting XML to web service using SOAP Savon gem in ruby on rails", "body": "<p>I'm working with ruby and Savon 2. I have been given the following SOAP example: </p>\n\n<pre><code>POST /WebApi/Services/b2bapi.asmx HTTP/1.1\nHost: api.nationsphotolab.com\nContent-Type: text/xml; charset=utf-8\nContent-Length: length\nSOAPAction: \"https://api.nationsphotolab.com/AddNewOrder\"\n\n&lt;?xml version=\"1.0\" encoding=\"utf-8\"?&gt;\n&lt;soap:Envelope xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" \nxmlns:xsd=\"http://www.w3.org/2001/XMLSchema\" \nxmlns:soap=\"http://schemas.xmlsoap.org/soap/envelope/\"&gt;\n  &lt;soap:Body&gt;\n    &lt;AddNewOrder xmlns=\"http://api.nationsphotolab.com/\"&gt;\n      &lt;orderXml&gt;string&lt;/orderXml&gt;\n      &lt;passport&gt;\n        &lt;Source&gt;string&lt;/Source&gt;\n        &lt;Hash&gt;string&lt;/Hash&gt;\n      &lt;/passport&gt;\n    &lt;/AddNewOrder&gt;\n  &lt;/soap:Body&gt;\n&lt;/soap:Envelope&gt;\n</code></pre>\n\n<p>I have tried a bunch of different methods of creating the XML, first using XmlMarkup builder, and then just building a hash and passing it into the savon client call. </p>\n\n<p>The error I've been getting: \n<code>Savon::SOAPFault ((soap:Server) Server was unable to process request. ---&gt; Object reference not set to an instance of an object.):</code></p>\n\n<p>Here's the request: </p>\n\n<pre><code>client = Savon.client(wsdl: \"http://api.nationsphotolab.com/WebApi/Services/b2bapi.asmx?wsdl\")\nresponse = client.call(:add_new_order, message: data)\n</code></pre>\n\n<p>With data being an XML created using XmlMarkup builder. \nAttached is a screenshot of data.</p>\n\n<p>Please let me know if I can provide anymore information</p>\n\n<p>Example data:\n<a href=\"https://i.stack.imgur.com/wmV8w.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/wmV8w.png\" alt=\"enter image description here\"></a></p>\n\n<p>Thank you!</p>\n"}, {"tags": ["ruby", "testing", "watir", "watir-webdriver", "irb"], "comments": [{"owner": {"reputation": 5134, "user_id": 1672197, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i8HkV.png?s=128&g=1", "display_name": "orde", "link": "https://stackoverflow.com/users/1672197/orde"}, "edited": false, "score": 2, "creation_date": 1501022932, "post_id": 45314496, "comment_id": 77591818, "body": "A couple of notes: watir-webdriver is deprecated, so I&#39;d advise looking at the watir gem. And you&#39;re mixing <code>browser</code> and <code>b</code>, which will yield a <code>undefined local variable</code> error."}, {"owner": {"reputation": 2216, "user_id": 7165275, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d8ad41f944f38348a30791dc7f7d02c?s=128&d=identicon&r=PG&f=1", "display_name": "m. simon borg", "link": "https://stackoverflow.com/users/7165275/m-simon-borg"}, "edited": false, "score": 0, "creation_date": 1501101205, "post_id": 45314496, "comment_id": 77635769, "body": "Was any of this helpful?"}], "answers": [{"comments": [{"owner": {"reputation": 45, "user_id": 8366368, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fb7e00f18157eb434739dc4d50250d6f?s=128&d=identicon&r=PG&f=1", "display_name": "JackGruber", "link": "https://stackoverflow.com/users/8366368/jackgruber"}, "edited": false, "score": 0, "creation_date": 1504783447, "post_id": 45314562, "comment_id": 79151780, "body": "Many thanks. Worked a treat. Forgot to reply till now."}], "tags": [], "owner": {"reputation": 2216, "user_id": 7165275, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d8ad41f944f38348a30791dc7f7d02c?s=128&d=identicon&r=PG&f=1", "display_name": "m. simon borg", "link": "https://stackoverflow.com/users/7165275/m-simon-borg"}, "is_accepted": true, "score": 1, "last_activity_date": 1501030064, "last_edit_date": 1501030064, "creation_date": 1501021978, "answer_id": 45314562, "question_id": 45314496, "link": "https://stackoverflow.com/questions/45314496/ruby-script-that-runs-list-of-irb-watir-commands/45314562#45314562", "title": "Ruby Script that runs list of irb watir commands", "body": "<p>Probably the easiest thing to do is create a <code>script.rb</code> file in the root project directory (or wherever you're starting IRB), and write out the Ruby you normally run. Then when you start IRB, just <code>load 'script.rb'</code></p>\n\n<p>However this won't work if you need access to your <code>browser</code> variable after setup. In that case it would make more sense to create a class.</p>\n\n<h2>in <code>./test_browser.rb</code></h2>\n\n<pre><code>require 'watir-webdriver'\nrequire 'irb'\n\nclass TestBrowser &lt; Watir::Browser\n  def self.build\n    browser = new(:chrome)\n    browser.goto 'www.foo.com'\n    # other setup steps\n    browser # return the browser at the end of the method\n  end\nend\n\nIRB.start\n</code></pre>\n\n<p>Then from the shell: <code>$ ruby ./test_browser.rb</code></p>\n\n<p>This will start up IRB with your class loaded. Then all you need to do is call the <code>.build</code> method and store the browser in a variable</p>\n\n<pre><code>browser = TestBrowser.build\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "is_accepted": false, "score": 0, "last_activity_date": 1501026757, "creation_date": 1501026757, "answer_id": 45315249, "question_id": 45314496, "link": "https://stackoverflow.com/questions/45314496/ruby-script-that-runs-list-of-irb-watir-commands/45315249#45315249", "title": "Ruby Script that runs list of irb watir commands", "body": "<p>You can always spin up <code>irb</code> with a particular file in mind:</p>\n\n<pre><code>irb -r./startup.rb\n</code></pre>\n\n<p>Where <code>./startup.rb</code> is the path to whatever file you want to run first before opening the REPL shell.</p>\n\n<p>It's pretty easy to make a wrapper script for this if you do it frequently enough. You can also invoke IRB manually inside a custom script of your own construction, much as <code>rails console</code> does.</p>\n"}], "owner": {"reputation": 45, "user_id": 8366368, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fb7e00f18157eb434739dc4d50250d6f?s=128&d=identicon&r=PG&f=1", "display_name": "JackGruber", "link": "https://stackoverflow.com/users/8366368/jackgruber"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 400, "favorite_count": 0, "accepted_answer_id": 45314562, "answer_count": 2, "score": 1, "last_activity_date": 1501030064, "creation_date": 1501021560, "question_id": 45314496, "link": "https://stackoverflow.com/questions/45314496/ruby-script-that-runs-list-of-irb-watir-commands", "title": "Ruby Script that runs list of irb watir commands", "body": "<p>I regularly use the irb for testing out cucumber watir webdriver steps on a browser. This involves opening the irb and typing in a list of the same commands. The first few commands are always </p>\n\n<ol>\n<li>require 'watir-webdriver'</li>\n<li>browser = Watir::Browser.new(:chrome)</li>\n<li>b.goto 'www.foo.com'</li>\n</ol>\n\n<p>the list of commands goes on like this. Every time I open the irb I have to go through all of these. Does anyone have any idea of a script which could be run to automate a list of commands such as the above? So that it would open the IRB and then go through the commands one by one saving me load of time.</p>\n\n<p>Any help is greatly appreciated.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "google-api", "google-calendar-api", "google-api-client"], "comments": [{"owner": {"reputation": 15264, "user_id": 6143482, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MD37S.jpg?s=128&g=1", "display_name": "noogui", "link": "https://stackoverflow.com/users/6143482/noogui"}, "edited": false, "score": 0, "creation_date": 1501168530, "post_id": 45314274, "comment_id": 77671030, "body": "what scope are you using?"}, {"owner": {"reputation": 4312, "user_id": 166034, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/311eb5cf1152752fafbed2a2c85aff5d?s=128&d=identicon&r=PG", "display_name": "Kerby82", "link": "https://stackoverflow.com/users/166034/kerby82"}, "reply_to_user": {"reputation": 15264, "user_id": 6143482, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MD37S.jpg?s=128&g=1", "display_name": "noogui", "link": "https://stackoverflow.com/users/6143482/noogui"}, "edited": false, "score": 0, "creation_date": 1501174237, "post_id": 45314274, "comment_id": 77674838, "body": "This is the scope I use: SCOPE = Google::Apis::CalendarV3::AUTH_CALENDAR"}], "owner": {"reputation": 4312, "user_id": 166034, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/311eb5cf1152752fafbed2a2c85aff5d?s=128&d=identicon&r=PG", "display_name": "Kerby82", "link": "https://stackoverflow.com/users/166034/kerby82"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 424, "favorite_count": 1, "answer_count": 0, "score": 1, "last_activity_date": 1501078860, "creation_date": 1501020246, "last_edit_date": 1501078860, "question_id": 45314274, "link": "https://stackoverflow.com/questions/45314274/ruby-google-calendar-integration-watch-event-push-notification", "title": "Ruby Google Calendar Integration Watch Event / Push Notification", "body": "<p>The following snippet of code print events for a calendar id, all the calendar configured and try to set a watch notification on a calendar.</p>\n\n<p>Everything works but the the watch event method. I'm getting this error: apis/core/http_command.rb:212:in `check_status': Unauthorized (Google::Apis::AuthorizationError)</p>\n\n<p>thi seems strange since the calendars and events retrieve is working fine.    </p>\n\n<pre><code>service = Google::Apis::CalendarV3::CalendarService.new\nservice.client_options.application_name = APPLICATION_NAME\nservice.authorization = authorize\n\n# Fetch the next 10 events for the user\ncalendar_id = 'us7i4kt2to4mpb0b5et1f9f4co@group.calendar.google.com'\nresponse = service.list_events(calendar_id,\n                               max_results: 10,\n                               single_events: true,\n                               order_by: 'startTime',\n                               time_min: Time.now.iso8601)\n\nputs \"Upcoming events:\"\nputs \"No upcoming events found\" if response.items.empty?\nresponse.items.each do |event|\n  start = event.start.date || event.start.date_time\n  puts \"- #{event.summary} (#{start})\"\nend\n\n@calendar_list = service.list_calendar_lists\n@calendar_list.items.each do |calendar|\n  puts \" #{calendar.summary} =&gt; #{calendar.id}\"\nend\n\n\nchannel = Google::Apis::CalendarV3::Channel.new(address: 'https://66724be7.ngrok.io', id: 100, type: \"web_hook\")\nputs \"Channel created \"\nwebhook = service.watch_event('us7i4kt2to4mpb0b5et1f9f4co@group.calendar.google.com', channel, single_events: true, time_min: Time.now.iso8601)\n</code></pre>\n\n<p>I'm getting this error: apis/core/http_command.rb:212:in `check_status': Unauthorized (Google::Apis::AuthorizationError)</p>\n\n<p>can't find anything related on the web</p>\n"}, {"tags": ["mysql", "ruby-on-rails", "ruby", "forms"], "comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1501019870, "post_id": 45314037, "comment_id": 77590849, "body": "<code>has_and_belongs_to_many</code> is sometimes pretty clunky compared to a <code>has_many</code> and <code>has_many through:</code> relationship pair. Something worth considering when implementing a feature like this. With the <code>through:</code> method you get to pick if you want to deal with the relationship records directly, which is often handy when selecting via check-boxes, and you can easily add metadata to the relationship itself, like roles or other attributes."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1501019900, "post_id": 45314037, "comment_id": 77590864, "body": "You should be able to call <code>publication.authors.each</code> if your data is populated correctly though."}, {"owner": {"reputation": 1223, "user_id": 3012473, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/gSYLc.png?s=128&g=1", "display_name": "buncis", "link": "https://stackoverflow.com/users/3012473/buncis"}, "edited": false, "score": 0, "creation_date": 1501058669, "post_id": 45314037, "comment_id": 77605429, "body": "you can use, accepts_nested_atributes_for and <a href=\"https://github.com/nathanvda/cocoon\" rel=\"nofollow noreferrer\">github.com/nathanvda/cocoon</a> for your dynamic forms"}], "owner": {"reputation": 245, "user_id": 7436247, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/ZCRYJ.jpg?s=128&g=1", "display_name": "league", "link": "https://stackoverflow.com/users/7436247/league"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 72, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1501042485, "creation_date": 1501019154, "question_id": 45314037, "link": "https://stackoverflow.com/questions/45314037/rails-how-do-i-make-a-form-that-updates-two-habtm-tables-at-once", "title": "Rails: How do I make a form that updates two HABTM tables at once?", "body": "<p>I'm working in Rails 5. </p>\n\n<p>In my database, I have a table called <code>publications</code> and a table called <code>authors</code> which have a HABTM relationship. </p>\n\n<p>I want to build a form that lets users insert more publications into my db, and part of this is associating existing (or new) authors to each new publication. </p>\n\n<p>What's the best way to do this?</p>\n\n<p>Here's my relevant code:</p>\n\n<p><em>publication.rb</em></p>\n\n<pre><code>class Publication &lt; ApplicationRecord\n\n  self.table_name = \"publications\"\n  has_and_belongs_to_many :authors\n\nend\n</code></pre>\n\n<p><em>author.rb</em></p>\n\n<pre><code>class Author &lt; ApplicationRecord\n\n  self.table_name = \"authors\"\n  has_and_belongs_to_many :publications\n\nend\n</code></pre>\n\n<p><em>_form.html.erb</em></p>\n\n    \n\n<pre><code>&lt;h3&gt;Publication name:&lt;/h3&gt;\n&lt;p&gt;&lt;%= f.text_field(:name) %&gt;&lt;/p&gt;\n\n&lt;h3&gt;Authors&lt;/h3&gt;\n&lt;p&gt;&lt;%= ??? %&gt;&lt;/p&gt;\n\n&lt;h3&gt;Citation:&lt;/h3&gt;\n&lt;p&gt;&lt;%= f.text_field(:citation) %&gt;&lt;/p&gt;\n</code></pre>\n\n\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-5", "actionmailer", "irb"], "comments": [{"owner": {"reputation": 2216, "user_id": 7165275, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d8ad41f944f38348a30791dc7f7d02c?s=128&d=identicon&r=PG&f=1", "display_name": "m. simon borg", "link": "https://stackoverflow.com/users/7165275/m-simon-borg"}, "edited": false, "score": 0, "creation_date": 1501020388, "post_id": 45313615, "comment_id": 77591045, "body": "exit the console, try <code>spring stop</code>, then run the console again"}, {"owner": {"reputation": 208794, "user_id": 229044, "user_type": "moderator", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/591426cbbacd4025d920467bad356911?s=128&d=identicon&r=PG&f=1", "display_name": "meagar", "link": "https://stackoverflow.com/users/229044/meagar"}, "edited": false, "score": 0, "creation_date": 1501021270, "post_id": 45313615, "comment_id": 77591333, "body": "When in doubt, blame spring.Exiting the console shouldn&#39;t be necessary, but <code>bin&#47;spring stop</code> often fixes some really odd Rails problems."}, {"owner": {"reputation": 2216, "user_id": 7165275, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d8ad41f944f38348a30791dc7f7d02c?s=128&d=identicon&r=PG&f=1", "display_name": "m. simon borg", "link": "https://stackoverflow.com/users/7165275/m-simon-borg"}, "reply_to_user": {"reputation": 208794, "user_id": 229044, "user_type": "moderator", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/591426cbbacd4025d920467bad356911?s=128&d=identicon&r=PG&f=1", "display_name": "meagar", "link": "https://stackoverflow.com/users/229044/meagar"}, "edited": false, "score": 0, "creation_date": 1501021401, "post_id": 45313615, "comment_id": 77591377, "body": "@meagar by &quot;exit the console&quot;, i mean exit the rails console, not the shell terminal : )"}, {"owner": {"reputation": 208794, "user_id": 229044, "user_type": "moderator", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/591426cbbacd4025d920467bad356911?s=128&d=identicon&r=PG&f=1", "display_name": "meagar", "link": "https://stackoverflow.com/users/229044/meagar"}, "reply_to_user": {"reputation": 2216, "user_id": 7165275, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d8ad41f944f38348a30791dc7f7d02c?s=128&d=identicon&r=PG&f=1", "display_name": "m. simon borg", "link": "https://stackoverflow.com/users/7165275/m-simon-borg"}, "edited": false, "score": 0, "creation_date": 1501021445, "post_id": 45313615, "comment_id": 77591389, "body": "@m.simonborg Ah, that makes more sense."}, {"owner": {"reputation": 13, "user_id": 2662464, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c9eec48c8ba391a858dcdda731574cea?s=128&d=identicon&r=PG", "display_name": "Brandon Roehl", "link": "https://stackoverflow.com/users/2662464/brandon-roehl"}, "edited": false, "score": 0, "creation_date": 1501076069, "post_id": 45313615, "comment_id": 77618661, "body": "OK I tried <code>spring stop</code> <code>bin&#47;spring stop</code> and <code>bundle exec spring stop</code> and ran <code>rails c</code> and the above in irb and got the same error. Thanks for the quick replies though"}], "answers": [{"tags": [], "owner": {"reputation": 13, "user_id": 2662464, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c9eec48c8ba391a858dcdda731574cea?s=128&d=identicon&r=PG", "display_name": "Brandon Roehl", "link": "https://stackoverflow.com/users/2662464/brandon-roehl"}, "is_accepted": true, "score": 0, "last_activity_date": 1501078581, "creation_date": 1501078581, "answer_id": 45329587, "question_id": 45313615, "link": "https://stackoverflow.com/questions/45313615/undefined-method-default-for-actionmailer/45329587#45329587", "title": "undefined method `default&#39; for ActionMailer", "body": "<p>The solution turned out to be that if you have a model named <code>mail</code> the <code>ActionMailer</code> will grab that one first instead of the rails class. If this happens then it fails the first time but the second time will load the rails class and try and smash them together. Allowing the submodule to work but treating the main class as a monkey path.</p>\n"}], "owner": {"reputation": 13, "user_id": 2662464, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c9eec48c8ba391a858dcdda731574cea?s=128&d=identicon&r=PG", "display_name": "Brandon Roehl", "link": "https://stackoverflow.com/users/2662464/brandon-roehl"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 706, "favorite_count": 0, "accepted_answer_id": 45329587, "answer_count": 1, "score": 0, "last_activity_date": 1501078581, "creation_date": 1501017356, "question_id": 45313615, "link": "https://stackoverflow.com/questions/45313615/undefined-method-default-for-actionmailer", "title": "undefined method `default&#39; for ActionMailer", "body": "<p>I'm having this weird error with Rails 5 action mailer.</p>\n\n<pre><code># app/mailers/application_mailer.rb\nclass ApplicationMailer &lt; ActionMailer::Base\n  default from: \"from@example.com\"\n  layout 'mailer'\nend\n</code></pre>\n\n<p>irb</p>\n\n<pre><code>~/workspace/rails5 &gt; rails c       ruby-2.4.1@rails5\nRunning via Spring preloader in process 45498\nLoading development environment (Rails 5.1.2)\n2.4.1 :001 &gt; ApplicationMailer\n     NameError: uninitialized constant Mail::TestMailer\n     from app/mailers/application_mailer.rb:1:in `&lt;top (required)&gt;'\n     from (irb):1\n2.4.1 :002 &gt; ApplicationMailer\n     NoMethodError: undefined method `default' for ApplicationMailer:Class\n     from app/mailers/application_mailer.rb:3:in `&lt;class:ApplicationMailer&gt;'\n     from app/mailers/application_mailer.rb:1:in `&lt;top (required)&gt;'\n     from (irb):2\n2.4.1 :003 &gt;\n</code></pre>\n\n<p>This is the default Scaffold of rails 5.</p>\n\n<p>Two really weird things happen the first is that it always tells me the uninitialized constant then trows default is not a method right after.</p>\n\n<p>Just wondering how to fix it or if I should downgrade to Rail 5.0</p>\n"}, {"tags": ["ruby-on-rails", "json", "ruby", "parsing"], "comments": [{"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 1, "creation_date": 1501013112, "post_id": 45312508, "comment_id": 77587583, "body": "Remove all the irrelevant fluff from the code and show actual input."}, {"owner": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "edited": false, "score": 0, "creation_date": 1501013318, "post_id": 45312508, "comment_id": 77587683, "body": "Do you really need to interpolate those values for <code>result</code>?"}, {"owner": {"reputation": 2205, "user_id": 6460122, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/WTsp7.jpg?s=128&g=1", "display_name": "ricks", "link": "https://stackoverflow.com/users/6460122/ricks"}, "reply_to_user": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "edited": false, "score": 0, "creation_date": 1501013558, "post_id": 45312508, "comment_id": 77587809, "body": "@Sebasti&#225;nPalma do you know of a better way i could do it?"}, {"owner": {"reputation": 2205, "user_id": 6460122, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/WTsp7.jpg?s=128&g=1", "display_name": "ricks", "link": "https://stackoverflow.com/users/6460122/ricks"}, "reply_to_user": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1501013596, "post_id": 45312508, "comment_id": 77587824, "body": "@SergioTulentsev i added a test input i am using to make sure that no special characters would make the parsing fail"}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 2, "creation_date": 1501013823, "post_id": 45312508, "comment_id": 77587956, "body": "@RickS: that&#39;s obviously not a valid json. What is it that you want to do here?"}, {"owner": {"reputation": 2205, "user_id": 6460122, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/WTsp7.jpg?s=128&g=1", "display_name": "ricks", "link": "https://stackoverflow.com/users/6460122/ricks"}, "reply_to_user": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1501013937, "post_id": 45312508, "comment_id": 77588027, "body": "@SergioTulentsev i want to allow characters like &#39; and &quot; go through, i know you can replace &#39; with \\&#39; and it will allow it to parse the JSON but i don&#39;t know how i can achieve that in ruby"}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 1, "creation_date": 1501014080, "post_id": 45312508, "comment_id": 77588111, "body": "@RickS: ruby has a variety of string replacement methods. <code>gsub</code> is one of them, check it out."}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 1, "creation_date": 1501014180, "post_id": 45312508, "comment_id": 77588165, "body": "@RickS The problem with your input is that you want to escape the &quot;inner&quot; quotes, but not the &quot;outer&quot; ones. How can you determine which is which is non-trivial, to say the least."}, {"owner": {"reputation": 2205, "user_id": 6460122, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/WTsp7.jpg?s=128&g=1", "display_name": "ricks", "link": "https://stackoverflow.com/users/6460122/ricks"}, "reply_to_user": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1501014252, "post_id": 45312508, "comment_id": 77588218, "body": "@SergioTulentsev you&#39;re right i guess i am going to have to do this on my swift application before it gets sent"}], "answers": [{"tags": [], "owner": {"reputation": 1591, "user_id": 7734948, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/D98nv.png?s=128&g=1", "display_name": "Neha Chopra", "link": "https://stackoverflow.com/users/7734948/neha-chopra"}, "is_accepted": false, "score": 1, "last_activity_date": 1502102574, "last_edit_date": 1502102574, "creation_date": 1502075732, "answer_id": 45538933, "question_id": 45312508, "link": "https://stackoverflow.com/questions/45312508/how-to-parse-json-with-single-and-double-quotes-in-ruby-on-rails/45538933#45538933", "title": "how to parse JSON with single and double quotes in ruby on rails", "body": "<p>1.</p>\n\n<p>Let's first correct the JSON Object which you gave:</p>\n\n<pre><code>  {\n    \"name\":\"Aaacontacttest'/'@\"-jgg&amp;$;$/&amp;/@.'sheh\",\n    \"phone_number\":\",7*#;878545848487849648\",\n    \"detail\":\"\",\n    \"image_url\":\"\",\n    \"email\":\"test@test.com\",\n    \"address\":\"-/:;()$@\"\"\":$;$:$$/!:!/!,!6677bhgv2017-07-25T20:08:54.614283+00:00 app[web.1]: Hsbsbsbb7788$!\",\n    \"city\":\"Hehshdbdb\",\n    \"state\":\"HSSHHSHS$&amp;:$:$\",\n    \"zipcode\":\"3319)\",\n    \"country\":\"United States\"\n}\n</code></pre>\n\n<p>The problem with this JSON object is, it is not closed properly. If you wanted to use quotes in your object then please use Backslash to omit to close the value of the object.</p>\n\n<p>Let's convert the above <strong>invalid JSON Object to valid JSON object</strong> first, such ruby avoid syntax error:</p>\n\n<pre><code> {\n    \"name\":\"Aaacontacttest'/'@\\\"-jgg&amp;$;$/&amp;/@.'sheh\",\n    \"phone_number\":\",7*#;878545848487849648\",\n    \"detail\":\"\",\n    \"image_url\":\"\",\n    \"email\":\"test@test.com\",\n    \"address\":\"-/:;()$@\\\"\\\"\\\":$;$:$$/!:!/!,!6677bhgv2017-07-25T20:08:54.614283+00:00 app[web.1]: Hsbsbsbb7788$!\",\n    \"city\":\"Hehshdbdb\",\n    \"state\":\"HSSHHSHS$&amp;:$:$\",\n    \"zipcode\":\"3319)\",\n    \"country\":\"United States\"\n}\n</code></pre>\n\n<p>What we did over here:\nInitial Hash object with the \"name\" as the key has a value: </p>\n\n<p>\"name\":<strong>\"Aaacontacttest'/'@\"<em></strong>-jgg&amp;$;$/&amp;/@.'sheh\"</em></p>\n\n<p>Area with bold depicting that you have closed the value with quotes where rest of the Italic character is marked as invalid.</p>\n\n<p>Types of errors which ruby would be raised either \"syntax error\" or unexpected 'any char', expecting end-of-input</p>\n\n<p>We have introduced backslash in the value to ensure proper closing of the value.</p>\n\n<p>\"name\":<strong>\"Aaacontacttest'/'@\\\"</strong>-jgg&amp;$;$/&amp;/@.'sheh\"</p>\n\n<p><strong>So where ever you have used quotes in your value please omit them using backslash.</strong></p>\n\n<ol start=\"2\">\n<li><p><strong>The object which you gave is the normal hash object not a JSON object in case of ruby, as Ruby JSON parser expects the argument to be a string and can\u2019t convert objects like a hash or array.</strong></p></li>\n</ol>\n\n<p>If you do <strong>JSON.generate(hash)</strong> you will get the JSON object:</p>\n\n<p>Note: hash if the corrected hashobject.</p>\n\n<p>Adding JSON object over here.</p>\n\n<p>\"{\\\"name\\\":\\\"Aaacontacttest'/'@\\\\\"-jgg&amp;$;$/&amp;/@.'sheh\\\",\\\"phone_number\\\":\\\",7*#;878545848487849648\\\",\\\"detail\\\":\\\"\\\",\\\"image_url\\\":\\\"\\\",\\\"email\\\":\\\"test@test.com\\\",\\\"address\\\":\\\"-/:;()$@\\\\\"\\\\\"\\\\\":$;$:$$/!:!/!,!6677bhgv2017-07-25T20:08:54.614283+00:00 app[web.1]: Hsbsbsbb7788$!\\\",\\\"city\\\":\\\"Hehshdbdb\\\",\\\"state\\\":\\\"HSSHHSHS$&amp;:$:$\\\",\\\"zipcode\\\":\\\"3319)\\\",\\\"country\\\":\\\"United States\\\"}\"</p>\n\n<p>If you do <strong>JSON.parse(HashObject not JSONobject)</strong> the ruby would throw an error:</p>\n\n<p>TypeError: no implicit conversion of Hash into String</p>\n\n<p>Summary:</p>\n\n<ol>\n<li><p>Correct your hashObject.</p></li>\n<li><p>Convert you hashObject into the valid JSON object for ruby. If you wanted to generate JSON use JSON.generate(hash) method.</p></li>\n</ol>\n"}], "owner": {"reputation": 2205, "user_id": 6460122, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/WTsp7.jpg?s=128&g=1", "display_name": "ricks", "link": "https://stackoverflow.com/users/6460122/ricks"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1451, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1502102574, "creation_date": 1501012971, "last_edit_date": 1501013471, "question_id": 45312508, "link": "https://stackoverflow.com/questions/45312508/how-to-parse-json-with-single-and-double-quotes-in-ruby-on-rails", "title": "how to parse JSON with single and double quotes in ruby on rails", "body": "<p>I am Having an issue where if a name comes in with a <code>'</code> or <code>\"</code> my JSON parsing fails. I want to know how i can avoid this.</p>\n\n<p>This is my current code:</p>\n\n<pre><code>def create\n\nputs params\n\n#@contact = Contact.new(contact_params)\n#@contact.user = current_user\n\ncontactsParam = params[:contacts]\n\nif contactsParam\n\n  # contactsParam.each do |contact|\n  # end\n\n  contactValues = contactsParam.map { |c| \n\n    puts \"dulce!!! : \" + c.to_s\n\n    json = JSON.parse(c)\n    result = \"('#{json['name']}', '#{json['phone_number']}', '#{json['detail']}', '#{json['image_url']}', '#{json['email']}', '#{json['address']}', '#{json['city']}', '#{json['state']}', '#{json['zipcode']}', '#{json['country']}', #{current_user.id}, now(), now())\" \n    result\n  }.join(\",\")\n\n  if contactValues.length &gt; 0\n     ActiveRecord::Base.connection.execute(\"INSERT INTO contacts (name, phone_number, detail, image_url, email, address, city, state, zipcode, country, user_id, created_at, updated_at) VALUES #{contactValues}\")\n  end\nend\n</code></pre>\n\n<p>here is an example of a JSON String that fails (i added a bunch of random characters to test).</p>\n\n<pre><code>   {\"name\":\"Aaacontacttest'/'@\"-jgg&amp;$;$/&amp;/@.'sheh\",\"phone_number\":\",7*#;878545848487849648\",\"detail\":\"\",\"image_url\":\"\",\"email\":\"test@test.com\",\"address\":\"-/:;()$@\"\"\":$;$:$$/!:!/!,!6677bhgv\n2017-07-25T20:08:54.614283+00:00 app[web.1]: Hsbsbsbb7788$!\",\"city\":\"Hehshdbdb\",\"state\":\"HSSHHSHS$&amp;:$:$\",\"zipcode\":\"3319)\",\"country\":\"United States\"}\n</code></pre>\n"}, {"tags": ["ruby", "chef-infra", "increment", "chef-recipe", "cookbook"], "answers": [{"comments": [{"owner": {"reputation": 535, "user_id": 1058385, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/b59c82134d48e68f933d704bb11a019a?s=128&d=identicon&r=PG", "display_name": "Stephen Walsh", "link": "https://stackoverflow.com/users/1058385/stephen-walsh"}, "edited": false, "score": 0, "creation_date": 1501014968, "post_id": 45312692, "comment_id": 77588585, "body": "thanks! I&#39;ll give it a try and mark your answer as the accepted one if it works as expected. BTW, what do you mean by non-convergent in this context? As in; if I was to apply this to multiple nodes at the same time, each would have a different value?"}, {"owner": {"reputation": 43208, "user_id": 78722, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cf611565f0b79abd0b3dc200ad867661?s=128&d=identicon&r=PG", "display_name": "coderanger", "link": "https://stackoverflow.com/users/78722/coderanger"}, "reply_to_user": {"reputation": 535, "user_id": 1058385, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/b59c82134d48e68f933d704bb11a019a?s=128&d=identicon&r=PG", "display_name": "Stephen Walsh", "link": "https://stackoverflow.com/users/1058385/stephen-walsh"}, "edited": false, "score": 0, "creation_date": 1501023599, "post_id": 45312692, "comment_id": 77592028, "body": "See <a href=\"https://coderanger.net/thinking/\" rel=\"nofollow noreferrer\">coderanger.net/thinking</a> for more info, but basically when you run recipe code twice, it shouldn&#39;t do anything the second time. This code defines actions, not target state."}, {"owner": {"reputation": 43208, "user_id": 78722, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cf611565f0b79abd0b3dc200ad867661?s=128&d=identicon&r=PG", "display_name": "coderanger", "link": "https://stackoverflow.com/users/78722/coderanger"}, "reply_to_user": {"reputation": 535, "user_id": 1058385, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/b59c82134d48e68f933d704bb11a019a?s=128&d=identicon&r=PG", "display_name": "Stephen Walsh", "link": "https://stackoverflow.com/users/1058385/stephen-walsh"}, "edited": false, "score": 0, "creation_date": 1501023644, "post_id": 45312692, "comment_id": 77592044, "body": "And this is purely local, there is no (non-terrible) way to do an auto-increment across multiple servers in Chef, you would use the shard_seed instead."}], "tags": [], "owner": {"reputation": 43208, "user_id": 78722, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cf611565f0b79abd0b3dc200ad867661?s=128&d=identicon&r=PG", "display_name": "coderanger", "link": "https://stackoverflow.com/users/78722/coderanger"}, "is_accepted": false, "score": 2, "last_activity_date": 1501013678, "creation_date": 1501013678, "answer_id": 45312692, "question_id": 45312408, "link": "https://stackoverflow.com/questions/45312408/chef-increment-value-in-a-file-each-time-the-cookbook-is-applied/45312692#45312692", "title": "Chef: Increment value in a file each time the cookbook is applied", "body": "<p>This is really weird thing to do since it would be non-convergent but whatever floats your boat:</p>\n\n<pre><code>ruby_block 'weird thing' do\n  block do\n    path = '/whatever.txt'\n    value = IO.read(path).to_i\n    IO.write(path, (value + 1).to_s)\n  end\nend\n</code></pre>\n"}], "owner": {"reputation": 535, "user_id": 1058385, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/b59c82134d48e68f933d704bb11a019a?s=128&d=identicon&r=PG", "display_name": "Stephen Walsh", "link": "https://stackoverflow.com/users/1058385/stephen-walsh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 140, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1501013678, "creation_date": 1501012575, "question_id": 45312408, "link": "https://stackoverflow.com/questions/45312408/chef-increment-value-in-a-file-each-time-the-cookbook-is-applied", "title": "Chef: Increment value in a file each time the cookbook is applied", "body": "<p>One of my recipes echoes a static value into a file each time the cookbook is applied to a server, e.g.</p>\n\n<pre><code>bash 'example' do\n  code &lt;&lt;-EOF\n    echo \"1\" &gt; /path/file.txt\n  EOF\nend\n</code></pre>\n\n<p>I would like to increment this value each time the cookbook is applied a server. So the next time, /path/file.txt would contain the value \"2\", then \"3\"...</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1501012387, "post_id": 45312341, "comment_id": 77587143, "body": "show the command"}, {"owner": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "edited": false, "score": 4, "creation_date": 1501012434, "post_id": 45312341, "comment_id": 77587176, "body": "Can you try <code>spring stop</code> before running the rails command?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user7496931"}, "edited": false, "score": 0, "creation_date": 1501012663, "post_id": 45312341, "comment_id": 77587329, "body": "Command i&#39;m using is <code>rails g controller home</code>. It looks like spring stop before running the command made it work. Why is that?"}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1501012705, "post_id": 45312341, "comment_id": 77587357, "body": "bugs in spring."}], "answers": [{"comments": [{"owner": {"reputation": 514, "user_id": 1240882, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/566d884b2a3bc795b8c9cde0572bf441?s=128&d=identicon&r=PG", "display_name": "Chih-Chao Lam", "link": "https://stackoverflow.com/users/1240882/chih-chao-lam"}, "edited": false, "score": 0, "creation_date": 1556647326, "post_id": 45316481, "comment_id": 98506526, "body": "Worked for me even on rails 5.2.3"}], "tags": [], "owner": {"reputation": 2124, "user_id": 839787, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/f330a19645ff0895459fce9ca810b3ce?s=128&d=identicon&r=PG", "display_name": "Stephane Paquet", "link": "https://stackoverflow.com/users/839787/stephane-paquet"}, "is_accepted": false, "score": 5, "last_activity_date": 1501054169, "last_edit_date": 1501054169, "creation_date": 1501036528, "answer_id": 45316481, "question_id": 45312341, "link": "https://stackoverflow.com/questions/45312341/rails-hanging-when-trying-to-generate-controller/45316481#45316481", "title": "Rails hanging when trying to generate controller", "body": "<p>Spring bug. You can find more information here <a href=\"https://github.com/rails/spring/issues/265\" rel=\"noreferrer\">https://github.com/rails/spring/issues/265</a> and <a href=\"https://stackoverflow.com/questions/25027284/ruby-on-rails-console-hanging-when-loading\">ruby on rails console hanging when loading</a> </p>\n\n<p>Two main options:</p>\n\n<ol>\n<li>Stop (or restart spring) <code>bin/spring stop</code></li>\n<li>Try reinstalling in a clean rvm environment</li>\n</ol>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user7496931"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 844, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1501054169, "creation_date": 1501012307, "question_id": 45312341, "link": "https://stackoverflow.com/questions/45312341/rails-hanging-when-trying-to-generate-controller", "title": "Rails hanging when trying to generate controller", "body": "<p>For some reason I can't seem to use the <code>rails generate</code> command. Been trying to generate a controller called <code>home</code> and another one called <code>artists</code> but it seems to keep hanging. </p>\n\n<p>When I cancel the request, I get the following stack:</p>\n\n<pre><code>^C/Users/username/.rvm/gems/ruby-2.3.1/gems/spring-2.0.2/lib/spring/client/run.rb:117:in `gets': Interrupt\n    from /Users/username/.rvm/gems/ruby-2.3.1/gems/spring-2.0.2/lib/spring/client/run.rb:117:in `verify_server_version'\n    from /Users/username/.rvm/gems/ruby-2.3.1/gems/spring-2.0.2/lib/spring/client/run.rb:62:in `run'\n    from /Users/username/.rvm/gems/ruby-2.3.1/gems/spring-2.0.2/lib/spring/client/run.rb:42:in `warm_run'\n    from /Users/username/.rvm/gems/ruby-2.3.1/gems/spring-2.0.2/lib/spring/client/run.rb:35:in `call'\n    from /Users/username/.rvm/gems/ruby-2.3.1/gems/spring-2.0.2/lib/spring/client/command.rb:7:in `call'\n    from /Users/username/.rvm/gems/ruby-2.3.1/gems/spring-2.0.2/lib/spring/client/rails.rb:24:in `call'\n    from /Users/username/.rvm/gems/ruby-2.3.1/gems/spring-2.0.2/lib/spring/client/command.rb:7:in `call'\n    from /Users/username/.rvm/gems/ruby-2.3.1/gems/spring-2.0.2/lib/spring/client.rb:30:in `run'\n    from /Users/username/.rvm/gems/ruby-2.3.1/gems/spring-2.0.2/bin/spring:49:in `&lt;top (required)&gt;'\n    from /Users/username/.rvm/gems/ruby-2.3.1/gems/spring-2.0.2/lib/spring/binstub.rb:31:in `load'\n    from /Users/username/.rvm/gems/ruby-2.3.1/gems/spring-2.0.2/lib/spring/binstub.rb:31:in `&lt;top (required)&gt;'\n    from /Users/username/Code/spotify-tres/bin/spring:15:in `require'\n    from /Users/username/Code/spotify-tres/bin/spring:15:in `&lt;top (required)&gt;'\n    from bin/rails:3:in `load'\n    from bin/rails:3:in `&lt;main&gt;'\n</code></pre>\n\n<p>No clue what's wrong. Any ideas?</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 2, "creation_date": 1501011398, "post_id": 45312097, "comment_id": 77586566, "body": "Start with <code>group_by</code>, <i>then</i> you&#39;ll need <code>map</code>"}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1501026910, "post_id": 45312097, "comment_id": 77592964, "body": "Whenever you give an example please show the desired or expected result as a Ruby object. We must assume that <code>a</code> and<code>b</code> are unstated variables or methods. If they are intended to be strings or symbols write<code>&quot;a&quot;</code> or <code>:a</code>."}], "answers": [{"tags": [], "owner": {"reputation": 4769, "user_id": 1242470, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/18f1b4b172a8f873efe1179ca140f1eb?s=128&d=identicon&r=PG", "display_name": "Mate Solymosi", "link": "https://stackoverflow.com/users/1242470/mate-solymosi"}, "is_accepted": true, "score": 0, "last_activity_date": 1501012130, "creation_date": 1501012130, "answer_id": 45312294, "question_id": 45312097, "link": "https://stackoverflow.com/questions/45312097/using-ruby-map-method-to-combine-arrays-with-unique-nested-values/45312294#45312294", "title": "Using Ruby .map Method To Combine Arrays With Unique Nested Values", "body": "<p>Try this:</p>\n\n<pre><code>arr = [[:a, 1], [:a, 2], [:b, 3], [:b, 4]]\n\narr.group_by(&amp;:first).map { |k, v| [k, v.map(&amp;:last)] }\n#=&gt; [[:a, [1, 2]], [:b, [3, 4]]]\n</code></pre>\n\n<p>Depending on what your goal is, you might want to turn the result into a hash:</p>\n\n<pre><code>Hash[arr.group_by(&amp;:first).map { |k, v| [k, v.map(&amp;:last)] }]\n#=&gt; {:a=&gt;[1, 2], :b=&gt;[3, 4]}\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 8365785, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/20a9fd86e861f6553d0c44f797dfcb0b?s=128&d=identicon&r=PG&f=1", "display_name": "Justin Auvil", "link": "https://stackoverflow.com/users/8365785/justin-auvil"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 145, "favorite_count": 0, "accepted_answer_id": 45312294, "answer_count": 1, "score": -1, "last_activity_date": 1501012130, "creation_date": 1501011332, "last_edit_date": 1501011362, "question_id": 45312097, "link": "https://stackoverflow.com/questions/45312097/using-ruby-map-method-to-combine-arrays-with-unique-nested-values", "title": "Using Ruby .map Method To Combine Arrays With Unique Nested Values", "body": "<p>I'm trying to use the map function to combine an array of arrays into an array of arrays that eliminate a unique value in arr[0][0] but pull arr[0][1] and group it with the corresponding unique value.</p>\n\n<pre><code>arr = [[a, 1], [a, 2], [b,3], [b, 4]]\n=&gt; [[a, [1, 2]], [b, [3,4]]]\n</code></pre>\n\n<p>I'm sure this is pretty basic but I'm rather new to coding in general. Thank you for your help.</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1501010990, "post_id": 45311993, "comment_id": 77586358, "body": "post code, not images of code"}, {"owner": {"reputation": 9030, "user_id": 5101476, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JCQrl.jpg?s=128&g=1", "display_name": "ice\u30c4", "link": "https://stackoverflow.com/users/5101476/ice%e3%83%84"}, "edited": false, "score": 0, "creation_date": 1501011017, "post_id": 45311993, "comment_id": 77586371, "body": "show show show your code..."}, {"owner": {"reputation": 9, "user_id": 8365789, "user_type": "registered", "profile_image": "https://graph.facebook.com/746487472220480/picture?type=large", "display_name": "Mohammed E. EL-Ghazaly", "link": "https://stackoverflow.com/users/8365789/mohammed-e-el-ghazaly"}, "edited": false, "score": 1, "creation_date": 1501011424, "post_id": 45311993, "comment_id": 77586580, "body": "i&#39;m new to the website sorry for the delay."}], "answers": [{"comments": [{"owner": {"reputation": 9, "user_id": 8365789, "user_type": "registered", "profile_image": "https://graph.facebook.com/746487472220480/picture?type=large", "display_name": "Mohammed E. EL-Ghazaly", "link": "https://stackoverflow.com/users/8365789/mohammed-e-el-ghazaly"}, "edited": false, "score": 0, "creation_date": 1501011661, "post_id": 45312117, "comment_id": 77586722, "body": "Still it just asks for the first two questions."}, {"owner": {"reputation": 313, "user_id": 7485168, "user_type": "registered", "profile_image": "https://graph.facebook.com/1797273820298202/picture?type=large", "display_name": "Jok\u016bbas Brunonas Pu\u010dinskas", "link": "https://stackoverflow.com/users/7485168/jok%c5%abbas-brunonas-pu%c4%8dinskas"}, "reply_to_user": {"reputation": 9, "user_id": 8365789, "user_type": "registered", "profile_image": "https://graph.facebook.com/746487472220480/picture?type=large", "display_name": "Mohammed E. EL-Ghazaly", "link": "https://stackoverflow.com/users/8365789/mohammed-e-el-ghazaly"}, "edited": false, "score": 3, "creation_date": 1501012151, "post_id": 45312117, "comment_id": 77587009, "body": "I believe that you miss type conversion to integer. Your if statement should start like this <code>if inputing_unit.to_i == 1 and ending_unit.to_i == 1 then</code>"}, {"owner": {"reputation": 9, "user_id": 8365789, "user_type": "registered", "profile_image": "https://graph.facebook.com/746487472220480/picture?type=large", "display_name": "Mohammed E. EL-Ghazaly", "link": "https://stackoverflow.com/users/8365789/mohammed-e-el-ghazaly"}, "edited": false, "score": 0, "creation_date": 1501012545, "post_id": 45312117, "comment_id": 77587257, "body": "It worked,thank you man :D"}, {"owner": {"reputation": 9030, "user_id": 5101476, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JCQrl.jpg?s=128&g=1", "display_name": "ice\u30c4", "link": "https://stackoverflow.com/users/5101476/ice%e3%83%84"}, "edited": false, "score": 0, "creation_date": 1501017100, "post_id": 45312117, "comment_id": 77589730, "body": "Or you can write <code>inputing_unit == &#39;1&#39;</code> etc"}], "tags": [], "owner": {"reputation": 313, "user_id": 7485168, "user_type": "registered", "profile_image": "https://graph.facebook.com/1797273820298202/picture?type=large", "display_name": "Jok\u016bbas Brunonas Pu\u010dinskas", "link": "https://stackoverflow.com/users/7485168/jok%c5%abbas-brunonas-pu%c4%8dinskas"}, "is_accepted": false, "score": 1, "last_activity_date": 1501011409, "creation_date": 1501011409, "answer_id": 45312117, "question_id": 45311993, "link": "https://stackoverflow.com/questions/45311993/cant-output-the-result-in-after-if/45312117#45312117", "title": "Can&#39;t output the result in after if", "body": "<p>As I can see from that screenshot in the beginning of the description on pre-last line where is your puts statement there is a typo <code>#{input weight * input_ratio}</code>. You should change <code>...#{input weight...</code> to <code>...#{input_weight...</code> (with a dash).</p>\n"}], "owner": {"reputation": 9, "user_id": 8365789, "user_type": "registered", "profile_image": "https://graph.facebook.com/746487472220480/picture?type=large", "display_name": "Mohammed E. EL-Ghazaly", "link": "https://stackoverflow.com/users/8365789/mohammed-e-el-ghazaly"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 48, "favorite_count": 0, "closed_date": 1501025726, "answer_count": 1, "score": 0, "last_activity_date": 1501017770, "creation_date": 1501010940, "last_edit_date": 1501017770, "question_id": 45311993, "link": "https://stackoverflow.com/questions/45311993/cant-output-the-result-in-after-if", "closed_reason": "Needs details or clarity", "title": "Can&#39;t output the result in after if", "body": "<p>I want to make this simple program that returns the weight quantity by choosing the units. When I run the program it runs with no problems and asks the two questions in <code>if</code> but doesn't return the <code>value</code></p>\n\n<p>Here is my code:</p>\n\n<pre><code>puts \"What is your starting weight and ratio unit?\n1:kg.m/h\n2:gm.m/s\n3:mm.m/s\"\n\ninputing_unit = gets.chomp\n\nputs \"What is your ending weight and ratio unit?\n1:kg.m/h\n2:gm.m/s\n3:mm.m/s\"\n\nending_unit = gets.chomp\n\nif inputing_unit == 1 and ending_unit == 1 then\n  puts \"What is your weight?\"\n  input_weight = gets.chomp.to_i\n  puts \"What is your ratio?\"\n  input_ratio = gets.chomp.to_i\n  puts \"Your moving value is #{input weight * input_ratio}\"\nend\n</code></pre>\n"}, {"tags": ["html", "ruby-on-rails", "ruby", "haml"], "comments": [{"owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 1, "creation_date": 1501010734, "post_id": 45311894, "comment_id": 77586226, "body": "<code>html.erb</code> files use <a href=\"https://ruby-doc.org/stdlib-2.4.1/libdoc/erb/rdoc/ERB.html\" rel=\"nofollow noreferrer\">ERB</a>"}, {"owner": {"reputation": 16229, "user_id": 525478, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/3b6c0b47a0c430a0b141baee7ea845be?s=128&d=identicon&r=PG", "display_name": "Brad Werth", "link": "https://stackoverflow.com/users/525478/brad-werth"}, "edited": false, "score": 0, "creation_date": 1501012230, "post_id": 45311894, "comment_id": 77587063, "body": "<a href=\"https://apidock.com/rails/ActionView/Helpers/TagHelper/content_tag\" rel=\"nofollow noreferrer\">apidock.com/rails/ActionView/Helpers/TagHelper/content_tag</a>"}], "answers": [{"tags": [], "owner": {"reputation": 7894, "user_id": 981616, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/92513702d30405c7e2ca056bdc72aa9f?s=128&d=identicon&r=PG", "display_name": "uday", "link": "https://stackoverflow.com/users/981616/uday"}, "is_accepted": false, "score": 2, "last_activity_date": 1501010955, "last_edit_date": 1501010955, "creation_date": 1501010690, "answer_id": 45311926, "question_id": 45311894, "link": "https://stackoverflow.com/questions/45311894/how-can-p-display-a-variable/45311926#45311926", "title": "How can &lt;p&gt; display a variable", "body": "<p>Like this: </p>\n\n<pre><code>&lt;%= @variable %&gt;\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "is_accepted": true, "score": 2, "last_activity_date": 1501010963, "last_edit_date": 1501010963, "creation_date": 1501010708, "answer_id": 45311932, "question_id": 45311894, "link": "https://stackoverflow.com/questions/45311894/how-can-p-display-a-variable/45311932#45311932", "title": "How can &lt;p&gt; display a variable", "body": "<p>You need to print your code and then to interpolate it, try with:</p>\n\n<pre><code>&lt;p&gt;&lt;%= \"#{@variable}\" %&gt;&lt;/p&gt;\n</code></pre>\n\n<p>Or just <code>&lt;p&gt;&lt;%= @variable %&gt;&lt;/p&gt;</code>, depending on what you want to do, then you can interpolate your variables.</p>\n\n<p>With <code>&lt;p&gt;\"#{@variable}\"&lt;/p&gt;</code> you're just printing plain html, nothing is being interpreted by Ruby.</p>\n"}], "owner": {"reputation": 27, "user_id": 5179957, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/19577806771a64ded2f9aadfdb05cd60?s=128&d=identicon&r=PG&f=1", "display_name": "A.Ho", "link": "https://stackoverflow.com/users/5179957/a-ho"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2605, "favorite_count": 0, "accepted_answer_id": 45311932, "answer_count": 2, "score": 1, "last_activity_date": 1501010963, "creation_date": 1501010556, "question_id": 45311894, "link": "https://stackoverflow.com/questions/45311894/how-can-p-display-a-variable", "title": "How can &lt;p&gt; display a variable", "body": "<p>Is there any way that I can load a variable in a 'p' tag?</p>\n\n<p>In my test.html.erb:</p>\n\n<pre><code>&lt;p&gt;\"#{@variable}\"&lt;/p&gt;\n</code></pre>\n\n<p>And in my test_controller.rb</p>\n\n<pre><code>@variable = \"Testing\"\n</code></pre>\n\n<p>However, in the html, it displays \"#{@variable}\". </p>\n\n<p>How should I fix it?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "amazon-web-services", "amazon-cloudfront"], "comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1501026490, "post_id": 45311595, "comment_id": 77592852, "body": "I think you mean <a href=\"https://en.wikipedia.org/wiki/ISO_8601\" rel=\"nofollow noreferrer\">ISO-8601</a>, not RFC. That also seems like a lot of code to do this. Are you sure there&#39;s nothing in the SDK itself which covers this use case?"}, {"owner": {"reputation": 51, "user_id": 8365581, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/252a406459afce7bf3f9c00c4b694265?s=128&d=identicon&r=PG&f=1", "display_name": "Ryan", "link": "https://stackoverflow.com/users/8365581/ryan"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1501029727, "post_id": 45311595, "comment_id": 77593577, "body": "I do mean ISO-8601, thank you (bad choice of variable name but the format should be correct).  The AWS SDK for Ruby does implement this (<a href=\"https://github.com/aws/aws-sdk-ruby/blob/master/aws-sdk-core/lib/aws-sdk-core/signers/v4.rb\" rel=\"nofollow noreferrer\">github.com/aws/aws-sdk-ruby/blob/master/aws-sdk-core/lib/&hellip;</a>) but I unfortunately can&#39;t include that gem for reasons I won&#39;t go into."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1501032137, "post_id": 45311595, "comment_id": 77594102, "body": "If you can&#39;t include the gem outright, at least snip out the parts you need. You&#39;re trying to re-write this thing here, and doing that without thorough unit tests is going to be trouble. You could test this versus a known-good solution independently, then bundle in your tested, trusted code when it&#39;s ready. There&#39;s a lot of very subtle things that can go wrong here, so you&#39;ll probably have to check that every single header is set <i>exactly</i> as expected. I was fighting an issue today with ACL declarations of the form <code>public_read</code> being rejected since <code>public-read</code> is the actual requirement."}, {"owner": {"reputation": 3514, "user_id": 1794802, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9404788dd9ecd74e3070ec684adbf439?s=128&d=identicon&r=PG", "display_name": "strongjz", "link": "https://stackoverflow.com/users/1794802/strongjz"}, "edited": false, "score": 0, "creation_date": 1501089729, "post_id": 45311595, "comment_id": 77629271, "body": "Why not use the SDK to create an Invalidation request?  <a href=\"http://docs.aws.amazon.com/sdkforruby/api/Aws/CloudFront/Types/CreateInvalidationRequest.html\" rel=\"nofollow noreferrer\">docs.aws.amazon.com/sdkforruby/api/Aws/CloudFront/Types/&hellip;</a>"}, {"owner": {"reputation": 51, "user_id": 8365581, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/252a406459afce7bf3f9c00c4b694265?s=128&d=identicon&r=PG&f=1", "display_name": "Ryan", "link": "https://stackoverflow.com/users/8365581/ryan"}, "edited": false, "score": 0, "creation_date": 1501196387, "post_id": 45311595, "comment_id": 77685826, "body": "Full disclosure, what I have written is more or less a duplicate of Amazon&#39;s approach, the main difference being the hexdigest method (Amazon uses an iternal means of deriving that value where I&#39;m attempting to use Digest::SHA256).  I more or less agree with the notion of just using the SDK/ avoid rewriting the header signing code, but am going through the motions of potentially identifying other approaches to some degree.  The team I&#39;m on generally avoids pulling in new gems unless absolutely neccessary."}], "owner": {"reputation": 51, "user_id": 8365581, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/252a406459afce7bf3f9c00c4b694265?s=128&d=identicon&r=PG&f=1", "display_name": "Ryan", "link": "https://stackoverflow.com/users/8365581/ryan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 378, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1501009426, "creation_date": 1501009426, "question_id": 45311595, "link": "https://stackoverflow.com/questions/45311595/aws4-request-signing-with-ruby", "title": "AWS4 request signing with Ruby", "body": "<p>I have a codebase where we work with AWS CloudFront in a limited capacity and am trying to get the status of a distribution invalidation through the API endpoint documented here: <a href=\"http://docs.aws.amazon.com/cloudfront/latest/APIReference/API_GetInvalidation.html\" rel=\"nofollow noreferrer\">http://docs.aws.amazon.com/cloudfront/latest/APIReference/API_GetInvalidation.html</a></p>\n\n<p>This endpoint requires that the request headers are signed using a AWS4 signature, which I'm stuggling with.  I've modeled most of my request signing code based on the signing code in the AWS SDK for Ruby: <a href=\"https://github.com/aws/aws-sdk-ruby/blob/master/aws-sdk-core/lib/aws-sdk-core/signers/v4.rb\" rel=\"nofollow noreferrer\">https://github.com/aws/aws-sdk-ruby/blob/master/aws-sdk-core/lib/aws-sdk-core/signers/v4.rb</a></p>\n\n<p>My code is as follows:</p>\n\n<pre><code>class CFAgent\n\n  RFC8601BASIC = \"%Y%m%dT%H%M%SZ\"\n  CF_AGENT_ACCESS_KEY = \"validaccesskey\"\n  CF_AGENT_SECRET_ACCESS_KEY = \"validsecret\"\n\n  def self.cf_dist_invalidation_status\n    dist_id = \"abc123\"\n    invalidation_id = \"xyz\"\n    url = \"https://cloudfront.amazonaws.com/2017-03-25/#{dist_id}/invalidation/#{invalidation_id}\"\n\n    headers = {\n      \"Content-Type\" =&gt; \"application/json; charset=utf8\"\n    }\n    headers = sign(\"GET\", URI.parse(url), headers, \"{}\", CF_AGENT_ACCESS_KEY, CF_AGENT_SECRET_ACCESS_KEY, \"us-east-1\")\n    puts \"signed headers:\", headers\n\n    res = SimpleHttp.get(url, headers)\n    puts \"Status:\", res.code\n    puts \"Body:\", res.body\n  end\n\n  def self.sign(method, uri, headers, body, access_key, secret_key, region, service_name=nil)\n    method = method.upcase\n    service = service_name || uri.host.split(\".\", 2)[0]\n\n    date_header = headers[\"Date\"] || headers[\"DATE\"] || headers[\"date\"]\n    date = (date_header ? Time.parse(date_header) : Time.zone.now).utc.strftime(RFC8601BASIC)\n\n    body_digest = hexdigest(body)\n\n    headers['X-Amz-Date'] = date\n    headers['Host'] = host(uri)\n    headers['X-Amz-Content-Sha256'] ||= body_digest\n\n    headers['Authorization'] = authorization(method, uri, headers, body_digest, date, access_key, secret_key, region, service)\n    headers\n  end\n\n  private\n\n  def self.host(uri)\n    if ((uri.scheme == 'http' &amp;&amp; uri.port == 80) || (uri.scheme == 'https' &amp;&amp; uri.port = 443))\n      uri.host\n    else\n      \"#{uri.host}:#{uri.port}\"\n    end\n  end\n\n  def self.authorization(method, uri, headers, body_digest, date, access_key, secret_key, region, service)\n    [\n      \"AWS4-HMAC-SHA256 Credential=#{credential(access_key, date, region, service)}\",\n      \"SignedHeaders=#{signed_headers(headers)}\",\n      \"Signature=#{signature(method, uri, headers, body_digest, date, access_key, secret_key, region, service)}\"\n    ].join(', ')\n  end\n\n  def self.credential(access_key, date, region, service)\n    \"#{access_key}/#{credential_string(date, region, service)}\"\n  end\n\n  def self.signature(method, uri, headers, body_digest, date, access_key, secret_key, region, service)\n    k_date = hmac(\"AWS4\" + secret_key, date[0,8])\n    k_region = hmac(k_date, region)\n    k_service = hmac(k_region, service)\n    k_credentials = hmac(k_service, \"aws4_request\")\n    hexhmac(k_credentials, string_to_sign(method, uri, headers, body_digest, date, access_key, secret_key, region, service))\n  end\n\n  def self.string_to_sign(method, uri, headers, body_digest, date, access_key, secret_key, region, service)\n    [\n      'AWS4-HMAC-SHA256',\n      date,\n      credential_string(date, region, service),\n      hexdigest(canonical_request(method, uri, headers, body_digest))\n    ].join(\"\\n\")\n  end\n\n  def self.credential_string(date, region, service)\n    [\n      date[0,8],\n      region,\n      service,\n      \"aws4_request\"\n    ].join(\"/\")\n  end\n\n  def self.canonical_request(method, uri, headers, body_digest)\n    [\n      method,\n      Pathname.new(uri.path).cleanpath.to_s,\n      uri.query,\n      canonical_headers(headers),\n      signed_headers(headers),\n      body_digest\n    ].join(\"\\n\")\n  end\n\n  def self.canonical_headers(headers)\n    c_headers = []\n    headers.each_pair do |k,v|\n      k = k.downcase\n      c_headers &lt;&lt; [k,v]\n    end\n    c_headers = c_headers.sort_by(&amp;:first)\n    c_headers.map{|k,v| \"#{k}:#{canonical_header_value(v.to_s)}\" }.join(\"\\n\")\n  end\n\n  def self.canonical_header_value(value)\n    value.match(/^\".*\"$/) ? value : value.gsub(/\\s+/, ' ').strip\n  end\n\n  def self.signed_headers(headers)\n    headers.keys.inject([]) do |signed_headers, header_key|\n      header_key = header_key.downcase\n      signed_headers &lt;&lt; header_key\n      signed_headers\n    end.sort.join(';')\n  end\n\n  def self.hexdigest(value)\n    Digest::SHA256.new.update(value).hexdigest\n  end\n\n  def self.hmac(key, value)\n    OpenSSL::HMAC.digest(OpenSSL::Digest.new('sha256'), key, value)\n  end\n\n  def self.hexhmac(key, value)\n    OpenSSL::HMAC.hexdigest(OpenSSL::Digest.new('sha256'), key, value)\n  end\n\nend\n</code></pre>\n\n<p>When I call CFAgent.cfinvalidation_status, I receive a 403 error with a \"MissingInvalidationToken\" code.  \"SimpleHTTP\" is a simple library that wraps Net/HTTP to make HTTP/HTTPS requests (please assume this works).</p>\n\n<p>What am I missing?</p>\n\n<p>Thanks in advance.</p>\n"}, {"tags": ["ruby", "capybara"], "answers": [{"tags": [], "owner": {"reputation": 42014, "user_id": 2709090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/238c2b7cde2c817fc9a5a2b8eaa2ffad?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Walpole", "link": "https://stackoverflow.com/users/2709090/thomas-walpole"}, "is_accepted": false, "score": 0, "last_activity_date": 1501010327, "last_edit_date": 1501010327, "creation_date": 1501009896, "answer_id": 45311726, "question_id": 45311358, "link": "https://stackoverflow.com/questions/45311358/setting-a-dynamic-variable-name-that-receives-an-argument-in-ruby-capybara/45311726#45311726", "title": "Setting a dynamic variable name that receives an argument in ruby capybara", "body": "<p>You need to use Object#instance_variable_set, so</p>\n\n<pre><code>instance_variable_set(\u201c@user_value_#{number}\u201d, another_variable)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 7178606, "user_type": "registered", "profile_image": "https://graph.facebook.com/10154257886868155/picture?type=large", "display_name": "Marino K Poletine", "link": "https://stackoverflow.com/users/7178606/marino-k-poletine"}, "is_accepted": false, "score": 0, "last_activity_date": 1502372725, "creation_date": 1502372725, "answer_id": 45615558, "question_id": 45311358, "link": "https://stackoverflow.com/questions/45311358/setting-a-dynamic-variable-name-that-receives-an-argument-in-ruby-capybara/45615558#45615558", "title": "Setting a dynamic variable name that receives an argument in ruby capybara", "body": "<p>This is how I fixed this:</p>\n\n<pre><code> When(/^I have a value to save for user [0-9]$/) do |number|\n   @user_value ||= {}\n   @user_value[number]\n end\n</code></pre>\n\n<p>I hope this helps</p>\n"}], "owner": {"reputation": 1, "user_id": 7178606, "user_type": "registered", "profile_image": "https://graph.facebook.com/10154257886868155/picture?type=large", "display_name": "Marino K Poletine", "link": "https://stackoverflow.com/users/7178606/marino-k-poletine"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 74, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1502372725, "creation_date": 1501008500, "question_id": 45311358, "link": "https://stackoverflow.com/questions/45311358/setting-a-dynamic-variable-name-that-receives-an-argument-in-ruby-capybara", "title": "Setting a dynamic variable name that receives an argument in ruby capybara", "body": "<p>I am trying to set a variable name based on a value passed by the user</p>\n\n<p>My capybara step looks like this:</p>\n\n<pre><code>When(/^I have a value to save for user [0-9]$/) do |number|\n  @user_value_#{number} = another_variable\nend\n</code></pre>\n\n<p>This doesn't seem to work.</p>\n\n<p>Is there a way to do this?</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 5519, "user_id": 938947, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f611b152b4fa9fe2a05f4ee9b84fdcb7?s=128&d=identicon&r=PG", "display_name": "widjajayd", "link": "https://stackoverflow.com/users/938947/widjajayd"}, "edited": false, "score": 0, "creation_date": 1501007187, "post_id": 45310938, "comment_id": 77584184, "body": "what is your rails version?"}, {"owner": {"reputation": 13441, "user_id": 2199600, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8sl6u.jpg?s=128&g=1", "display_name": "Igor Drozdov", "link": "https://stackoverflow.com/users/2199600/igor-drozdov"}, "edited": false, "score": 2, "creation_date": 1501007239, "post_id": 45310938, "comment_id": 77584224, "body": "There are steps in this similar question, it may help you <a href=\"https://stackoverflow.com/questions/39738700/uninitialized-constant-appgeneratorconfig-error\" title=\"uninitialized constant appgeneratorconfig error\">stackoverflow.com/questions/39738700/&hellip;</a>"}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1501026596, "post_id": 45310938, "comment_id": 77592873, "body": "It might be worth installing Rails again to be sure you&#39;re getting the latest version."}], "owner": {"reputation": 37, "user_id": 8360234, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e753b538ce241556d95f196e87d51cc?s=128&d=identicon&r=PG&f=1", "display_name": "m.g.", "link": "https://stackoverflow.com/users/8360234/m-g"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 128, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1501006940, "creation_date": 1501006940, "question_id": 45310938, "link": "https://stackoverflow.com/questions/45310938/having-trouble-with-creating-new-rails-app", "title": "having trouble with creating new rails app", "body": "<p>I've previously created a rails app with the simple \"rails new fileName\", but for some reason, I'm getting the following error when I attempt to create a new app:</p>\n\n<pre><code>$ rails new powTr\nuninitialized constant AppGenerator::Config\nDid you mean?  RbConfig\n</code></pre>\n\n<p>I'm not sure what this means/where to look.  Any help would be appreciated, thanks. </p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ubuntu"], "answers": [{"tags": [], "owner": {"reputation": 313, "user_id": 7485168, "user_type": "registered", "profile_image": "https://graph.facebook.com/1797273820298202/picture?type=large", "display_name": "Jok\u016bbas Brunonas Pu\u010dinskas", "link": "https://stackoverflow.com/users/7485168/jok%c5%abbas-brunonas-pu%c4%8dinskas"}, "is_accepted": true, "score": 1, "last_activity_date": 1501009168, "creation_date": 1501009168, "answer_id": 45311531, "question_id": 45310695, "link": "https://stackoverflow.com/questions/45310695/cant-bundle-install-after-cloning-repo/45311531#45311531", "title": "Can&#39;t bundle install after cloning repo", "body": "<p>Try:   </p>\n\n<ol>\n<li><p>Set correct ruby (rbenv) version <code>rbenv global 2.3.1</code> </p></li>\n<li><p>And then <code>rbenv rehash</code> and then <code>bundle install</code>.</p></li>\n</ol>\n\n<p>If that won't work I think you should reinstall bundler</p>\n\n<ol>\n<li>Once again set correct ruby version <code>rbenv global 2.3.1</code></li>\n<li><code>gem uninstall bundler</code></li>\n<li><code>gem install bundler</code></li>\n<li>And then <code>rbenv rehash</code> and then <code>bundle install</code>.</li>\n</ol>\n"}], "owner": {"reputation": 127, "user_id": 4355939, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh4.googleusercontent.com/-V5DNtWBl6GM/AAAAAAAAAAI/AAAAAAAAAIE/l33mBQ7uPEk/photo.jpg?sz=128", "display_name": "Brian Lau", "link": "https://stackoverflow.com/users/4355939/brian-lau"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 181, "favorite_count": 0, "accepted_answer_id": 45311531, "answer_count": 1, "score": -1, "last_activity_date": 1501009168, "creation_date": 1501006002, "last_edit_date": 1501006280, "question_id": 45310695, "link": "https://stackoverflow.com/questions/45310695/cant-bundle-install-after-cloning-repo", "title": "Can&#39;t bundle install after cloning repo", "body": "<p>Here's my error when I bundle. What's the problem?</p>\n\n<pre><code>bundle install\nrbenv: bundle: command not found\n\nThe `bundle' command exists in these Ruby versions:\n  2.3.1\n\ncommand -v ruby\n/home/brian/.rbenv/shims/ruby\n\ncommand -v bundle\n/home/brian/.rbenv/shims/bundle\n\nruby -v\nruby 2.3.1p112 (2016-04-26 revision 54768) [x86_64-linux]\n\nbundle -v\nBundler version 1.15.3\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "git", "activerecord"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user7496931"}, "edited": false, "score": 0, "creation_date": 1501006607, "post_id": 45310610, "comment_id": 77583839, "body": "So I can play with the database if I use <code>rails console --sandbox</code>, wasn&#39;t there a way I could access the database directly using <code>irb</code> or <code>pry</code>?"}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user7496931"}, "is_accepted": false, "score": 2, "last_activity_date": 1501014067, "last_edit_date": 1501014067, "creation_date": 1501006708, "answer_id": 45310883, "question_id": 45310610, "link": "https://stackoverflow.com/questions/45310610/ruby-on-rails-nameerror-uninitialized-constant-user/45310883#45310883", "title": "Ruby on Rails - NameError: uninitialized constant User", "body": "<p>Use <code>rails console</code> not <code>irb</code> or <code>pry</code> when working within a Ruby on Rails project. Rails has a complicated bootstrap process, and many of its classes are lazily loaded. Generic interactive consoles like <code>irb</code> or <code>pry</code> do not perform the necessary bootstrap to load a rails app,  but <code>rails console</code> will.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user7496931"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 878, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1501014067, "creation_date": 1501005760, "last_edit_date": 1501006152, "question_id": 45310610, "link": "https://stackoverflow.com/questions/45310610/ruby-on-rails-nameerror-uninitialized-constant-user", "title": "Ruby on Rails - NameError: uninitialized constant User", "body": "<p>Haven't used Rails in a while and just cloned a project, trying to work with the database but I'm getting this uninitialized constant error and I can't seem to figure out why. I bundle installed, created the database, migrated and seeded some files but I can't seem to find the root of the issue. It's not a small project and it seemed to be working fine back when I used it... Any help would be appreciated it... </p>\n\n<p>Here's my gemfile:</p>\n\n<pre><code>source 'https://rubygems.org'\n\ngit_source(:github) do |repo_name|\n  repo_name = \"#{repo_name}/#{repo_name}\" unless repo_name.include?(\"/\")\n  \"https://github.com/#{repo_name}.git\"\nend\n\n# Bundle edge Rails instead: gem 'rails', github: 'rails/rails'\ngem 'rails', '~&gt; 5.1.1'\ngem 'httparty'\n# Use postgresql as the database for Active Record\ngem 'pg', '~&gt; 0.18'\n# Use Puma as the app server\ngem 'puma', '~&gt; 3.7'\n# Use SCSS for stylesheets\ngem 'sass-rails', '~&gt; 5.0'\n# Use Uglifier as compressor for JavaScript assets\ngem 'uglifier', '&gt;= 1.3.0'\n# See https://github.com/rails/execjs#readme for more supported runtimes\n# gem 'therubyracer', platforms: :ruby\n# Use CoffeeScript for .coffee assets and views\ngem 'coffee-rails', '~&gt; 4.2'\n# Build JSON APIs with ease. Read more: https://github.com/rails/jbuilder\ngem 'jbuilder', '~&gt; 2.5'\n# Use Redis adapter to run Action Cable in production\n# gem 'redis', '~&gt; 3.0'\n# Use ActiveModel has_secure_password\ngem 'bcrypt', '~&gt; 3.1.7'\n# gem 'bcrypt', git: 'https://github.com/codahale/bcrypt-ruby.git', :require =&gt; 'bcrypt'\ngem 'semantic-ui-sass', git: 'https://github.com/doabit/semantic-ui-sass.git'\n# gem 'capistrano-rails', group: :development\ngem 'pg_search'\n\ngroup :development, :test do\n  # Call 'byebug' anywhere in the code to stop execution and get a debugger console\n  gem 'byebug', platforms: [:mri, :mingw, :x64_mingw]\n  gem 'faker'\nend\n\ngroup :development do\n  # Access an IRB console on exception pages or by using &lt;%= console %&gt; anywhere in the code.\n  gem 'web-console', '&gt;= 3.3.0'\n  gem 'listen', '&gt;= 3.0.5', '&lt; 3.2'\n  # Spring speeds up development by keeping your application running in the background. Read more: https://github.com/rails/spring\n  gem 'spring'\n  gem 'spring-watcher-listen', '~&gt; 2.0.0'\nend\ngem 'rails_12factor', group: :production\n# Windows does not include zoneinfo files, so bundle the tzinfo-data gem\ngem 'tzinfo-data', platforms: [:mingw, :mswin, :x64_mingw, :jruby]\n</code></pre>\n\n<p>And here's the User model:</p>\n\n<pre><code>class User &lt; ApplicationRecord\n  validates :first_name, :last_name, :presence =&gt; true\n  validates :username, :email, :presence =&gt; true, :uniqueness =&gt; true\n  has_many :messages\n  has_many :posts, :foreign_key =&gt; :creator_id\n  has_many :apprenticeships, :foreign_key =&gt; :requestor_id\n  has_many :skills, through: :posts\n\n  has_secure_password\n\n  def full_name\n    \"#{self.first_name} #{self.last_name}\"\n  end\n\nend\n</code></pre>\n\n<p>I have also tried checking if tables were created with <code>ActiveRecord::Base.connection.tables</code> but I'm still getting <code>NameError: uninitialized constant ActiveRecord</code></p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "answers": [{"comments": [{"owner": {"reputation": 101, "user_id": 8365329, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/ec2a9a6a55fad0bf553b7deeca9276a0?s=128&d=identicon&r=PG&f=1", "display_name": "Jacek717", "link": "https://stackoverflow.com/users/8365329/jacek717"}, "edited": false, "score": 0, "creation_date": 1501008006, "post_id": 45310392, "comment_id": 77584650, "body": "Yes. That was my error. Now everything works fine. Thank you Igor!"}], "tags": [], "owner": {"reputation": 13441, "user_id": 2199600, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8sl6u.jpg?s=128&g=1", "display_name": "Igor Drozdov", "link": "https://stackoverflow.com/users/2199600/igor-drozdov"}, "is_accepted": true, "score": 2, "last_activity_date": 1501005023, "creation_date": 1501005023, "answer_id": 45310392, "question_id": 45310362, "link": "https://stackoverflow.com/questions/45310362/ruby-on-rails-cannot-use-permit-require/45310392#45310392", "title": "ruby on rails cannot use permit.require", "body": "<p>That's because there's a typo in the <code>create</code> method</p>\n\n<p><code>@post_save</code> must be <code>@post.save</code></p>\n\n<pre><code>def create\n  @post = Post.new(post_params)\n  if @post.save\n    redirect_to posts_path, :notice =&gt; \"Post has been created\"\n  else\n    render \"new\"\n  end\nend\n</code></pre>\n\n<p>Since <code>@post_save</code> is not defined, <code>else</code> block is evaluated and <code>new</code> page is rendered and nothing happens</p>\n"}, {"tags": [], "owner": {"reputation": 313, "user_id": 7485168, "user_type": "registered", "profile_image": "https://graph.facebook.com/1797273820298202/picture?type=large", "display_name": "Jok\u016bbas Brunonas Pu\u010dinskas", "link": "https://stackoverflow.com/users/7485168/jok%c5%abbas-brunonas-pu%c4%8dinskas"}, "is_accepted": false, "score": 0, "last_activity_date": 1501005345, "creation_date": 1501005345, "answer_id": 45310483, "question_id": 45310362, "link": "https://stackoverflow.com/questions/45310362/ruby-on-rails-cannot-use-permit-require/45310483#45310483", "title": "ruby on rails cannot use permit.require", "body": "<p>I think that you should also permit :author_id if you have such a field in your form. Because, as I understand, post belongs_to :author. That means author_id is mandatory in post creation.\nAnd also, you have a typo, you should change \"@post_save\" => \"@post.save!\" (it was mentioned in earlier answer).</p>\n"}], "owner": {"reputation": 101, "user_id": 8365329, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/ec2a9a6a55fad0bf553b7deeca9276a0?s=128&d=identicon&r=PG&f=1", "display_name": "Jacek717", "link": "https://stackoverflow.com/users/8365329/jacek717"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 41, "favorite_count": 0, "accepted_answer_id": 45310392, "answer_count": 2, "score": 0, "last_activity_date": 1501036500, "creation_date": 1501004921, "last_edit_date": 1501036500, "question_id": 45310362, "link": "https://stackoverflow.com/questions/45310362/ruby-on-rails-cannot-use-permit-require", "title": "ruby on rails cannot use permit.require", "body": "<p>I'm trying to build a simple blog on <code>rails 5</code>. I have created a post model:</p>\n\n<pre><code>create_table \"posts\", force: :cascade do |t|\n  t.string \"title\"\n  t.text \"body\"\n  t.integer \"category_id\"\n  t.integer \"author_id\"\n  t.datetime \"created_at\", null: false\n  t.datetime \"updated_at\", null: false\nend\n</code></pre>\n\n<p>And my controller methods: </p>\n\n<pre><code>def new\n    @post = Post.new\n    @categories = Category.all\n\nend\n\ndef create\n    @post = Post.new(post_params)\n    if @post_save\n        redirect_to posts_path, :notice =&gt; \"Post has benn created\"\n    else\n        render \"new\"\n    end\n\nend\n\ndef post_params\n    params.require(:post).permit(:title, :body, :category_id)\nend \n</code></pre>\n\n<p>When I try to add another post via an html form nothing happens. The page with the form is reloaded and the post itself is not saved. What am I doing wrong?</p>\n"}, {"tags": ["ruby", "algorithm"], "answers": [{"comments": [{"owner": {"reputation": 1281, "user_id": 2308531, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/DV29D.jpg?s=128&g=1", "display_name": "Maxim Fedotov", "link": "https://stackoverflow.com/users/2308531/maxim-fedotov"}, "reply_to_user": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1501063526, "post_id": 45312159, "comment_id": 77609175, "body": "Sorry my bad, that&#39;s a Rails helper, to be precise <code>ActiveSupport</code>. I&#39;ve updated the answer with a slice implementation for Ruby"}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1501072387, "post_id": 45312159, "comment_id": 77615707, "body": "You have nothing to be sorry for. My comment reflected the fact that I don&#39;t know Rails. I deleted my comment and will detete this one as well."}], "tags": [], "owner": {"reputation": 1281, "user_id": 2308531, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/DV29D.jpg?s=128&g=1", "display_name": "Maxim Fedotov", "link": "https://stackoverflow.com/users/2308531/maxim-fedotov"}, "is_accepted": false, "score": 0, "last_activity_date": 1501063586, "last_edit_date": 1501063586, "creation_date": 1501011566, "answer_id": 45312159, "question_id": 45309534, "link": "https://stackoverflow.com/questions/45309534/ruby-algorithm-to-determine-valid-html-structure/45312159#45312159", "title": "Ruby algorithm to determine valid HTML structure", "body": "<p>I am not sure what you mean by <em>brute force recursive</em>, but this can be done with <code>sort_by</code> and <code>map</code>. It's a matter of making your <code>sort_by</code> correct to achieve your required HTML rules.</p>\n\n<pre><code>output = input.sort_by { |hsh| hsh[:start_p] }.map{|x| x.slice(:start_p, :start_t)}\noutput.each do |h|\n  h[:position] = h.delete(:start_p)  \n  h[:tag] = h.delete(:start_t)  \nend\n</code></pre>\n\n<p>Monkey patching slice method.</p>\n\n<pre><code>module MyExtension\n  module Hash \n    def slice(*keys)\n      ::Hash[[keys, self.values_at(*keys)].transpose]\n    end\n  end\nend\nHash.include MyExtension::Hash\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1501015918, "post_id": 45312306, "comment_id": 77589108, "body": "Admission: I don&#39;t know HTML. (Stop snickering, please.) I&#39;ve assumed that if two or more start tags are to be at the same location the corresponding end tags will also be at the same location, and that the order of the start tags is unimportant, but the order the end tags must be in reverse order of the start tags. Please let me know if my assumption is correct, so that I can delete my answer if I&#39;m wrong."}, {"owner": {"reputation": 3028, "user_id": 1300223, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/a24c84d319acafeba6f4c31db82672f8?s=128&d=identicon&r=PG", "display_name": "Eduard", "link": "https://stackoverflow.com/users/1300223/eduard"}, "edited": false, "score": 1, "creation_date": 1501045052, "post_id": 45312306, "comment_id": 77597477, "body": "order of start tags is important. (for example are tags that can&#39;t be contained in certain tags or can&#39;t contain certain tags), but you are right, is not the scope of this algorithm to determine that, so we can assume that starting and ending tags at same position will have a random order of starting tags."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "reply_to_user": {"reputation": 3028, "user_id": 1300223, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/a24c84d319acafeba6f4c31db82672f8?s=128&d=identicon&r=PG", "display_name": "Eduard", "link": "https://stackoverflow.com/users/1300223/eduard"}, "edited": false, "score": 0, "creation_date": 1501049465, "post_id": 45312306, "comment_id": 77599354, "body": "Thanks, @Eduard. Since you said nothing to the contrary, I assume I am correct that (for the purpose of the question) tags with the same start position will have the same end position."}, {"owner": {"reputation": 3028, "user_id": 1300223, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/a24c84d319acafeba6f4c31db82672f8?s=128&d=identicon&r=PG", "display_name": "Eduard", "link": "https://stackoverflow.com/users/1300223/eduard"}, "edited": false, "score": 0, "creation_date": 1501060509, "post_id": 45312306, "comment_id": 77606829, "body": "Thanks for the solution, I did some tests that passed, nice idea to use a float for sorting. Regarding your question, not all tags with same start position will have same end position (actually 90% of the cases will not have the same end), but when will have, the right order of the start tags can&#39;t be set and is not the scope of this question."}, {"owner": {"reputation": 3028, "user_id": 1300223, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/a24c84d319acafeba6f4c31db82672f8?s=128&d=identicon&r=PG", "display_name": "Eduard", "link": "https://stackoverflow.com/users/1300223/eduard"}, "edited": false, "score": 0, "creation_date": 1501061744, "post_id": 45312306, "comment_id": 77607788, "body": "I found a usecase when it is failing:  [{start_p: 0, end_p: 121, start_t: &#39;&lt;span&gt;&#39;, end_t: &#39;&lt;/span&gt;&#39;},     {start_p: 121, end_p: 134, start_t: &#39;&lt;b&gt;&#39;, end_t: &#39;&lt;/b&gt;&#39;},     {start_p: 134, end_p: 147, start_t: &#39;&lt;span&gt;&#39;, end_t: &#39;&lt;/span&gt;&#39;},     {start_p: 138, end_p: 147, start_t: &#39;&lt;strong&gt;&#39;, end_t: &#39;&lt;/strong&gt;&#39;},     {start_p: 147, end_p: 418, start_t: &#39;&lt;span&gt;&#39;, end_t: &#39;&lt;/span&gt;&#39;}] span ending at 147 is closed before strong ending at same position"}], "tags": [], "owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "is_accepted": true, "score": 1, "last_activity_date": 1501015804, "last_edit_date": 1501015804, "creation_date": 1501012170, "answer_id": 45312306, "question_id": 45309534, "link": "https://stackoverflow.com/questions/45309534/ruby-algorithm-to-determine-valid-html-structure/45312306#45312306", "title": "Ruby algorithm to determine valid HTML structure", "body": "<pre><code>input.group_by { |h| h[:start_p] }.\n      values.\n      flat_map do |a|\n        x = 1.0\n        a.flat_map do |h|\n          x /= 2.0\n          [[h[:start_p] += x, h[:start_t]], [h[:end_p] -= x, h[:end_t]]]\n        end\n      end.sort_by(&amp;:first).map(&amp;:last).join\n#=&gt; \"&lt;span&gt;&lt;p&gt;&lt;strong&gt;&lt;p&gt;&lt;em&gt;&lt;/em&gt;&lt;em&gt;&lt;/p&gt;&lt;/em&gt;&lt;em&gt;&lt;/em&gt;&lt;em&gt;&lt;/em&gt;&lt;/strong&gt;&lt;/p&gt;&lt;/span&gt;\"\n</code></pre>\n\n<p>The steps are as follows.</p>\n\n<pre><code>b = input.group_by { |h| h[:start_p] }\n  #=&gt; { 0=&gt;[{:start_p=&gt;0, :end_p=&gt;100, :start_t=&gt;\"&lt;p&gt;\", :end_t=&gt;\"&lt;/p&gt;\"},\n  #        {:start_p=&gt;0, :end_p=&gt;100, :start_t=&gt;\"&lt;span&gt;\", :end_t=&gt;\"&lt;/span&gt;\"}],\n  #    10=&gt;[{:start_p=&gt;10, :end_p=&gt;50, :start_t=&gt;\"&lt;p&gt;\", :end_t=&gt;\"&lt;/p&gt;\"}],\n  #    20=&gt;[{:start_p=&gt;20, :end_p=&gt;30, :start_t=&gt;\"&lt;em&gt;\", :end_t=&gt;\"&lt;/em&gt;\"}],\n  #    40=&gt;[{:start_p=&gt;40, :end_p=&gt;50, :start_t=&gt;\"&lt;em&gt;\", :end_t=&gt;\"&lt;/em&gt;\"}],\n  #    50=&gt;[{:start_p=&gt;50, :end_p=&gt;60, :start_t=&gt;\"&lt;em&gt;\", :end_t=&gt;\"&lt;/em&gt;\"}],\n  #    70=&gt;[{:start_p=&gt;70, :end_p=&gt;80, :start_t=&gt;\"&lt;em&gt;\", :end_t=&gt;\"&lt;/em&gt;\"}],\n  #     8=&gt;[{:start_p=&gt; 8, :end_p=&gt;99, :start_t=&gt;\"&lt;strong&gt;\", :end_t=&gt;\"&lt;/strong&gt;\"}]}\nc = b.values\n  #=&gt; [[{:start_p=&gt;0, :end_p=&gt;100, :start_t=&gt;\"&lt;p&gt;\", :end_t=&gt;\"&lt;/p&gt;\"},\n  #     {:start_p=&gt;0, :end_p=&gt;100, :start_t=&gt;\"&lt;span&gt;\", :end_t=&gt;\"&lt;/span&gt;\"}],\n  #    [{:start_p=&gt;10, :end_p=&gt;50, :start_t=&gt;\"&lt;p&gt;\", :end_t=&gt;\"&lt;/p&gt;\"}],\n  #   ...\n  #    [{:start_p=&gt;8, :end_p=&gt;99, :start_t=&gt;\"&lt;strong&gt;\", :end_t=&gt;\"&lt;/strong&gt;\"}]]\nd = c.flat_map do |a|\n      x = 1.0\n      a.flat_map do |h|\n        x /= 2.0\n        [[h[:start_p] += x, h[:start_t]], [h[:end_p] -= x, h[:end_t]]]\n      end\n    end\n  #=&gt; [[0.5, \"&lt;p&gt;\"], [99.5, \"&lt;/p&gt;\"], [0.25, \"&lt;span&gt;\"], [99.75, \"&lt;/span&gt;\"],\n  #    [10.5, \"&lt;p&gt;\"], [49.5, \"&lt;/p&gt;\"], [20.5, \"&lt;em&gt;\"], [29.5, \"&lt;/em&gt;\"],\n  #    [40.5, \"&lt;em&gt;\"], [49.5, \"&lt;/em&gt;\"], [50.5, \"&lt;em&gt;\"], [59.5, \"&lt;/em&gt;\"],\n  #    [70.5, \"&lt;em&gt;\"], [79.5, \"&lt;/em&gt;\"], [8.5, \"&lt;strong&gt;\"], [98.5, \"&lt;/strong&gt;\"]]\n</code></pre>\n\n<p>The first four element of <code>d</code> (tuples) are the most important to understanding the approach I've taken.</p>\n\n<pre><code>e = d.sort_by(&amp;:first)\n  #=&gt; [[0.25, \"&lt;span&gt;\"], [0.5, \"&lt;p&gt;\"], [8.5, \"&lt;strong&gt;\"], [10.5, \"&lt;p&gt;\"],\n  #    [20.5, \"&lt;em&gt;\"], [29.5, \"&lt;/em&gt;\"], [40.5, \"&lt;em&gt;\"], [49.5, \"&lt;/p&gt;\"],\n  #    [49.5, \"&lt;/em&gt;\"], [50.5, \"&lt;em&gt;\"], [59.5, \"&lt;/em&gt;\"], [70.5, \"&lt;em&gt;\"],\n  #    [79.5, \"&lt;/em&gt;\"], [98.5, \"&lt;/strong&gt;\"], [99.5, \"&lt;/p&gt;\"], [99.75, \"&lt;/span&gt;\"]]\n\nf = e.map(&amp;:last)\n  #=&gt; [\"&lt;span&gt;\", \"&lt;p&gt;\", \"&lt;strong&gt;\", \"&lt;p&gt;\", \"&lt;em&gt;\", \"&lt;/em&gt;\", \"&lt;em&gt;\", \"&lt;/p&gt;\",\n  #    \"&lt;/em&gt;\", \"&lt;em&gt;\", \"&lt;/em&gt;\", \"&lt;em&gt;\", \"&lt;/em&gt;\", \"&lt;/strong&gt;\", \"&lt;/p&gt;\", \"&lt;/span&gt;\"]\nf.join\n  #=&gt; \"&lt;span&gt;&lt;p&gt;&lt;strong&gt;&lt;p&gt;&lt;em&gt;&lt;/em&gt;&lt;em&gt;&lt;/p&gt;&lt;/em&gt;&lt;em&gt;&lt;/em&gt;&lt;em&gt;&lt;/em&gt;&lt;/strong&gt;&lt;/p&gt;&lt;/span&gt;\"\n</code></pre>\n\n<p>I will elaborate the calculation of <code>d</code> above if requested to do so.</p>\n"}], "owner": {"reputation": 3028, "user_id": 1300223, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/a24c84d319acafeba6f4c31db82672f8?s=128&d=identicon&r=PG", "display_name": "Eduard", "link": "https://stackoverflow.com/users/1300223/eduard"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 70, "favorite_count": 1, "accepted_answer_id": 45312306, "answer_count": 2, "score": 3, "last_activity_date": 1501063586, "creation_date": 1501002043, "question_id": 45309534, "link": "https://stackoverflow.com/questions/45309534/ruby-algorithm-to-determine-valid-html-structure", "title": "Ruby algorithm to determine valid HTML structure", "body": "<p>I have to as input data an array with hashes, each hash is description of an html tag (open and end position in the text and type of the tag). I need to generate another array where tags are put in order.</p>\n\n<p>For example:</p>\n\n<pre><code>input = [\n         {start_p: 0, end_p: 100, start_t: '&lt;p&gt;', end_t: '&lt;/p&gt;'},\n         {start_p: 10, end_p: 50, start_t: '&lt;p&gt;', end_t: '&lt;/p&gt;'},\n         {start_p: 0, end_p: 100, start_t: '&lt;span&gt;', end_t: '&lt;/span&gt;'},\n         {start_p: 20, end_p: 30, start_t: '&lt;em&gt;', end_t: '&lt;/em&gt;'},\n         {start_p: 40, end_p: 50, start_t: '&lt;em&gt;', end_t: '&lt;/em&gt;'},\n         {start_p: 50, end_p: 60, start_t: '&lt;em&gt;', end_t: '&lt;/em&gt;'},\n         {start_p: 70, end_p: 80, start_t: '&lt;em&gt;', end_t: '&lt;/em&gt;'},\n         {start_p: 8, end_p: 99, start_t: '&lt;strong&gt;', end_t: '&lt;/strong&gt;'}\n        ]\n\nexpected_output: [&lt;p&gt;&lt;span&gt;&lt;strong&gt;&lt;p&gt;&lt;em&gt;&lt;/em&gt;&lt;em&gt;&lt;/em&gt;&lt;/p&gt;&lt;em&gt;&lt;/em&gt;&lt;em&gt;&lt;/em&gt;&lt;/strong&gt;&lt;/span&gt;&lt;/p&gt;]\n</code></pre>\n\n<p>instead of just tags in output, each tag should be a Hash with position and tag, like:</p>\n\n<pre><code>     {position: 0, tag: '&lt;p&gt;'}\n</code></pre>\n\n<p>The most important thing it to be ordered in right order, respecting HTML rules of not having intersecting tags (if more than one tags are ending on the same position, the one opened last should go first, if one ends and other opens on the same position, end will be first, etc).</p>\n\n<p>This is part of a legacy system and input and output can't be changed at the moment. Also, the input can be very big (hundreds of thousands of elements)</p>\n\n<p>Any better solution than just brute force recursive ?</p>\n"}, {"tags": ["arrays", "ruby", "select"], "comments": [{"owner": {"reputation": 35276, "user_id": 182590, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/134ea397777886d6f0aa992672a50eaa?s=128&d=identicon&r=PG", "display_name": "Mark Thomas", "link": "https://stackoverflow.com/users/182590/mark-thomas"}, "edited": false, "score": 0, "creation_date": 1501000739, "post_id": 45308787, "comment_id": 77580177, "body": "The most efficient way to filter an array of arrays is to not start with an array of arrays to begin with. A hash with your second column as keys would be the fastest way to process it. Can you construct such a hash instead?"}, {"owner": {"reputation": 9030, "user_id": 5101476, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JCQrl.jpg?s=128&g=1", "display_name": "ice\u30c4", "link": "https://stackoverflow.com/users/5101476/ice%e3%83%84"}, "edited": false, "score": 0, "creation_date": 1501001228, "post_id": 45308787, "comment_id": 77580543, "body": "What was your inefficient way?"}, {"owner": {"reputation": 275, "user_id": 8016360, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/a30be4c216a1d7c1546ea2bd5db83c77?s=128&d=identicon&r=PG&f=1", "display_name": "RedOster", "link": "https://stackoverflow.com/users/8016360/redoster"}, "reply_to_user": {"reputation": 35276, "user_id": 182590, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/134ea397777886d6f0aa992672a50eaa?s=128&d=identicon&r=PG", "display_name": "Mark Thomas", "link": "https://stackoverflow.com/users/182590/mark-thomas"}, "edited": false, "score": 0, "creation_date": 1501001506, "post_id": 45308787, "comment_id": 77580730, "body": "@MarkThomas It would probably be more annoying to do it that way. This is a simplified example to demonstrate what I need. Converting to a hash would be really tough."}, {"owner": {"reputation": 275, "user_id": 8016360, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/a30be4c216a1d7c1546ea2bd5db83c77?s=128&d=identicon&r=PG&f=1", "display_name": "RedOster", "link": "https://stackoverflow.com/users/8016360/redoster"}, "reply_to_user": {"reputation": 9030, "user_id": 5101476, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JCQrl.jpg?s=128&g=1", "display_name": "ice\u30c4", "link": "https://stackoverflow.com/users/5101476/ice%e3%83%84"}, "edited": false, "score": 0, "creation_date": 1501001519, "post_id": 45308787, "comment_id": 77580742, "body": "@sagarpandya82 I looped through each element of the filter criteria and rejected the array element if core[x][1] == i"}], "answers": [{"tags": [], "owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "is_accepted": false, "score": 3, "last_activity_date": 1501000151, "creation_date": 1501000151, "answer_id": 45308910, "question_id": 45308787, "link": "https://stackoverflow.com/questions/45308787/filter-array-of-arrays-with-an-array-in-ruby/45308910#45308910", "title": "Filter array of arrays with an array in Ruby", "body": "<p>You can change the filter array to a hash for faster look up. Then the whole thing requires just a single iteration through the core array:</p>\n\n<pre><code>filters = [\"apple\", \"banana\"].each_with_object({}) do |term, obj|\n  obj[term] = true\nend\n# filters == {\"apple\" =&gt; true, \"banana\" =&gt; true}\n\nfiltered = core.reject do |array|\n  filters[array[1]]\nend\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 1, "creation_date": 1501002336, "post_id": 45309487, "comment_id": 77581239, "body": "i always forget about set :("}], "tags": [], "owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "is_accepted": true, "score": 7, "last_activity_date": 1501002201, "last_edit_date": 1501002201, "creation_date": 1501001883, "answer_id": 45309487, "question_id": 45308787, "link": "https://stackoverflow.com/questions/45308787/filter-array-of-arrays-with-an-array-in-ruby/45309487#45309487", "title": "Filter array of arrays with an array in Ruby", "body": "<p>Use <a href=\"http://ruby-doc.org/core-2.4.0/Array.html#method-i-reject\" rel=\"noreferrer\">Array#reject</a> and <a href=\"http://ruby-doc.org/core-2.4.0/Array.html#method-i-include-3F\" rel=\"noreferrer\">Array#include?</a>:</p>\n\n<pre><code>core.reject { |_,fruit,_| filter.include?(fruit) }\n  # =&gt; [[5, \"orange\", \"Thor\"], [15, \"orange\", \"Batman\"], [25, \"orange\", \"Lee Adama\"]]\n</code></pre>\n\n<p>If <code>filter</code> is large, first convert it to a set for faster lookups:</p>\n\n<pre><code>require 'set'\nfilter_set = filter.to_set\ncore.reject { |_,fruit,_| filter_set.include?(fruit) }\n</code></pre>\n\n<p>See <a href=\"http://ruby-doc.org/stdlib-2.4.0/libdoc/set/rdoc/Set.html\" rel=\"noreferrer\">Set</a> and its instance methods. When <code>require</code>d, set adds the instance method <code>to_set</code> to the module <code>Enumerable</code> which is <code>inclued</code>ed by <code>Array</code>. Ruby implements sets with unseen hashes.</p>\n"}, {"tags": [], "owner": {"reputation": 1384, "user_id": 1252245, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EF8gC.jpg?s=128&g=1", "display_name": "sequielo", "link": "https://stackoverflow.com/users/1252245/sequielo"}, "is_accepted": false, "score": 0, "last_activity_date": 1545176572, "creation_date": 1545176572, "answer_id": 53842692, "question_id": 45308787, "link": "https://stackoverflow.com/questions/45308787/filter-array-of-arrays-with-an-array-in-ruby/53842692#53842692", "title": "Filter array of arrays with an array in Ruby", "body": "<p>Why don't you use the <code>intersection</code> operator <code>&amp;</code> ?</p>\n\n<pre><code>core.reject { |k| (k &amp; filter).empty? } \n</code></pre>\n"}], "owner": {"reputation": 275, "user_id": 8016360, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/a30be4c216a1d7c1546ea2bd5db83c77?s=128&d=identicon&r=PG&f=1", "display_name": "RedOster", "link": "https://stackoverflow.com/users/8016360/redoster"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2487, "favorite_count": 0, "accepted_answer_id": 45309487, "answer_count": 3, "score": 2, "last_activity_date": 1545176572, "creation_date": 1500999812, "question_id": 45308787, "link": "https://stackoverflow.com/questions/45308787/filter-array-of-arrays-with-an-array-in-ruby", "title": "Filter array of arrays with an array in Ruby", "body": "<p>Looking for a more efficient way of filtering an array of arrays using another array in Ruby. Let me demonstrate. Starting with this:</p>\n\n<pre><code>core = [[1, \"apple\", \"James Bond\"],\n        [5, \"orange\", \"Thor\"],\n        [10, \"banana\", \"Wolverine\"],\n        [15, \"orange\", \"Batman\"],\n        [20, \"apple\", \"Mickey Mouse\"],\n        [25, \"orange\", \"Lee Adama\"],\n        [30, \"banana\", \"Luke Skywalker\"]]\n\nfilter = [\"apple\", \"banana\"]\n\nresult = core.magical_function(filter)\n\n# result == [[5, \"orange\", \"Thor\"],\n#            [15, \"orange\", \"Batman\"],\n#            [25, \"orange\", \"Lee Adama\"]]\n</code></pre>\n\n<p>The only thing I can think of is looping through the filter elements, but this slows down my code a lot when this toy example gets more complicated.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "postgresql", "sqlite"], "answers": [{"comments": [{"owner": {"reputation": 35, "user_id": 8190515, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh5.googleusercontent.com/-bW8hqwAwTmk/AAAAAAAAAAI/AAAAAAAAAK8/ISRJZV_CSuQ/photo.jpg?sz=128", "display_name": "adnan hajar", "link": "https://stackoverflow.com/users/8190515/adnan-hajar"}, "edited": false, "score": 0, "creation_date": 1500999815, "post_id": 45308700, "comment_id": 77579588, "body": "Perfect, Worked like a charm. Thank you :)                                                      I&#39;ll accept the answer when I can"}], "tags": [], "owner": {"reputation": 13441, "user_id": 2199600, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8sl6u.jpg?s=128&g=1", "display_name": "Igor Drozdov", "link": "https://stackoverflow.com/users/2199600/igor-drozdov"}, "is_accepted": true, "score": 1, "last_activity_date": 1500999601, "creation_date": 1500999601, "answer_id": 45308700, "question_id": 45308658, "link": "https://stackoverflow.com/questions/45308658/switching-from-pq-to-sqlite3-ruby-on-rails/45308700#45308700", "title": "Switching from pq to sqlite3 ruby on rails", "body": "<p>Please, try to change <code>adapter</code> in <code>config/database.yml</code> from <code>postgresql</code> to <code>sqlite3</code>.</p>\n\n<p>It should help.</p>\n"}], "owner": {"reputation": 35, "user_id": 8190515, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh5.googleusercontent.com/-bW8hqwAwTmk/AAAAAAAAAAI/AAAAAAAAAK8/ISRJZV_CSuQ/photo.jpg?sz=128", "display_name": "adnan hajar", "link": "https://stackoverflow.com/users/8190515/adnan-hajar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 70, "favorite_count": 0, "accepted_answer_id": 45308700, "answer_count": 1, "score": -1, "last_activity_date": 1500999784, "creation_date": 1500999458, "last_edit_date": 1500999784, "question_id": 45308658, "link": "https://stackoverflow.com/questions/45308658/switching-from-pq-to-sqlite3-ruby-on-rails", "title": "Switching from pq to sqlite3 ruby on rails", "body": "<p>I'm getting error after trying to change from a pg to sqlite3.</p>\n\n<pre><code>rake db:reset\nrake aborted!\nGem::LoadError: Specified 'postgresql' for database adapter, but the gem is not loaded. Add `gem 'pg'` to your Gemfile (and ensure its version is at the minimum required by ActiveRecord).\n/usr/local/rvm/gems/ruby-2.3.0/gems/activerecord-4.2.5/lib/active_record/connection_adapters/connection_specification.rb:177:in `rescue in spec'\n/usr/local/rvm/gems/ruby-2.3.0/gems/activerecord-4.2.5/lib/active_record/connection_adapters/connection_specification.rb:174:in `spec'\n/usr/local/rvm/gems/ruby-2.3.0/gems/activerecord-4.2.5/lib/active_record/connection_handling.rb:50:in `establish_connection'\n/usr/local/rvm/gems/ruby-2.3.0/gems/activerecord-4.2.5/lib/active_record/railtie.rb:120:in `block (2 levels) in &lt;class:Railtie&gt;'\n/usr/local/rvm/gems/ruby-2.3.0/gems/activesupport-4.2.5/lib/active_support/lazy_load_hooks.rb:38:in `instance_eval'\n/usr/local/rvm/gems/ruby-2.3.0/gems/activesupport-4.2.5/lib/active_support/lazy_load_hooks.rb:38:in `execute_hook'\n/usr/local/rvm/gems/ruby-2.3.0/gems/activesupport-4.2.5/lib/active_support/lazy_load_hooks.rb:28:in `block in on_load'\n/usr/local/rvm/gems/ruby-2.3.0/gems/activesupport-4.2.5/lib/active_support/lazy_load_hooks.rb:27:in `each'\n/usr/local/rvm/gems/ruby-2.3.0/gems/activesupport-4.2.5/lib/active_support/lazy_load_hooks.rb:27:in `on_load'\n/usr/local/rvm/gems/ruby-2.3.0/gems/activerecord-4.2.5/lib/active_record/railtie.rb:116:in `block in &lt;class:Railtie&gt;'\n/usr/local/rvm/gems/ruby-2.3.0/gems/railties-4.2.5/lib/rails/initializable.rb:30:in `instance_exec'\n/usr/local/rvm/gems/ruby-2.3.0/gems/railties-4.2.5/lib/rails/initializable.rb:30:in `run'\n/usr/local/rvm/gems/ruby-2.3.0/gems/railties-4.2.5/lib/rails/initializable.rb:55:in `block in run_initializers'\n/usr/local/rvm/gems/ruby-2.3.0/gems/railties-4.2.5/lib/rails/initializable.rb:54:in `run_initializers'\n/usr/local/rvm/gems/ruby-2.3.0/gems/railties-4.2.5/lib/rails/application.rb:352:in `initialize!'\n/home/ubuntu/workspace/config/environment.rb:5:in `&lt;top (required)&gt;'\n/usr/local/rvm/gems/ruby-2.3.0/gems/activesupport-4.2.5/lib/active_support/dependencies.rb:274:in `require'\n/usr/local/rvm/gems/ruby-2.3.0/gems/activesupport-4.2.5/lib/active_support/dependencies.rb:274:in `block in require'\n/usr/local/rvm/gems/ruby-2.3.0/gems/activesupport-4.2.5/lib/active_support/dependencies.rb:240:in `load_dependency'\n/usr/local/rvm/gems/ruby-2.3.0/gems/activesupport-4.2.5/lib/active_support/dependencies.rb:274:in `require'\n/usr/local/rvm/gems/ruby-2.3.0/gems/railties-4.2.5/lib/rails/application.rb:328:in `require_environment!'\n/usr/local/rvm/gems/ruby-2.3.0/gems/railties-4.2.5/lib/rails/application.rb:457:in `block in run_tasks_blocks'\n/usr/local/rvm/gems/ruby-2.3.0/gems/rake-12.0.0/exe/rake:27:in `&lt;top (required)&gt;'\n/usr/local/rvm/gems/ruby-2.3.0/bin/ruby_executable_hooks:15:in `eval'\n/usr/local/rvm/gems/ruby-2.3.0/bin/ruby_executable_hooks:15:in `&lt;main&gt;'\nGem::LoadError: pg is not part of the bundle. Add it to your Gemfile.\n/usr/local/rvm/gems/ruby-2.3.0/gems/bundler-1.15.1/lib/bundler/rubygems_integration.rb:377:in `block (2 levels) in replace_gem'\n/usr/local/rvm/gems/ruby-2.3.0/gems/activerecord-4.2.5/lib/active_record/connection_adapters/postgresql_adapter.rb:16:in `&lt;top (required)&gt;'\n/usr/local/rvm/gems/ruby-2.3.0/gems/activesupport-4.2.5/lib/active_support/dependencies.rb:274:in `require'\n/usr/local/rvm/gems/ruby-2.3.0/gems/activesupport-4.2.5/lib/active_support/dependencies.rb:274:in `block in require'\n/usr/local/rvm/gems/ruby-2.3.0/gems/activesupport-4.2.5/lib/active_support/dependencies.rb:240:in `load_dependency'\n/usr/local/rvm/gems/ruby-2.3.0/gems/activesupport-4.2.5/lib/active_support/dependencies.rb:274:in `require'\n/usr/local/rvm/gems/ruby-2.3.0/gems/activerecord-4.2.5/lib/active_record/connection_adapters/connection_specification.rb:175:in `spec'\n/usr/local/rvm/gems/ruby-2.3.0/gems/activerecord-4.2.5/lib/active_record/connection_handling.rb:50:in `establish_connection'\n/usr/local/rvm/gems/ruby-2.3.0/gems/activerecord-4.2.5/lib/active_record/railtie.rb:120:in `block (2 levels) in &lt;class:Railtie&gt;'\n/usr/local/rvm/gems/ruby-2.3.0/gems/activesupport-4.2.5/lib/active_support/lazy_load_hooks.rb:38:in `instance_eval'\n/usr/local/rvm/gems/ruby-2.3.0/gems/activesupport-4.2.5/lib/active_support/lazy_load_hooks.rb:38:in `execute_hook'\n/usr/local/rvm/gems/ruby-2.3.0/gems/activesupport-4.2.5/lib/active_support/lazy_load_hooks.rb:28:in `block in on_load'\n/usr/local/rvm/gems/ruby-2.3.0/gems/activesupport-4.2.5/lib/active_support/lazy_load_hooks.rb:27:in `each'\n/usr/local/rvm/gems/ruby-2.3.0/gems/activesupport-4.2.5/lib/active_support/lazy_load_hooks.rb:27:in `on_load'\n/usr/local/rvm/gems/ruby-2.3.0/gems/activerecord-4.2.5/lib/active_record/railtie.rb:116:in `block in &lt;class:Railtie&gt;'\n/usr/local/rvm/gems/ruby-2.3.0/gems/railties-4.2.5/lib/rails/initializable.rb:30:in `instance_exec'\n/usr/local/rvm/gems/ruby-2.3.0/gems/railties-4.2.5/lib/rails/initializable.rb:30:in `run'\n/usr/local/rvm/gems/ruby-2.3.0/gems/railties-4.2.5/lib/rails/initializable.rb:55:in `block in run_initializers'\n/usr/local/rvm/gems/ruby-2.3.0/gems/railties-4.2.5/lib/rails/initializable.rb:54:in `run_initializers'\n/usr/local/rvm/gems/ruby-2.3.0/gems/railties-4.2.5/lib/rails/application.rb:352:in `initialize!'\n/home/ubuntu/workspace/config/environment.rb:5:in `&lt;top (required)&gt;'\n/usr/local/rvm/gems/ruby-2.3.0/gems/activesupport-4.2.5/lib/active_support/dependencies.rb:274:in `require'\n/usr/local/rvm/gems/ruby-2.3.0/gems/activesupport-4.2.5/lib/active_support/dependencies.rb:274:in `block in require'\n/usr/local/rvm/gems/ruby-2.3.0/gems/activesupport-4.2.5/lib/active_support/dependencies.rb:240:in `load_dependency'\n/usr/local/rvm/gems/ruby-2.3.0/gems/activesupport-4.2.5/lib/active_support/dependencies.rb:274:in `require'\n/usr/local/rvm/gems/ruby-2.3.0/gems/railties-4.2.5/lib/rails/application.rb:328:in `require_environment!'\n/usr/local/rvm/gems/ruby-2.3.0/gems/railties-4.2.5/lib/rails/application.rb:457:in `block in run_tasks_blocks'\n/usr/local/rvm/gems/ruby-2.3.0/gems/rake-12.0.0/exe/rake:27:in `&lt;top (required)&gt;'\n/usr/local/rvm/gems/ruby-2.3.0/bin/ruby_executable_hooks:15:in `eval'\n/usr/local/rvm/gems/ruby-2.3.0/bin/ruby_executable_hooks:15:in `&lt;main&gt;'\nTasks: TOP =&gt; db:reset =&gt; environment\n(See full trace by running task with --trace)\n</code></pre>\n\n<p>Now I know that activeRecord is telling me to add the PG gem but my machine is having error running the pq server (rather then being productive and fixing it, I'm being lazy by trying to put sqlite on deve and keeping pg on product)</p>\n\n<p>Any tips on how to solve this?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "rspec"], "comments": [{"owner": {"reputation": 67463, "user_id": 203130, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/1RE8c.jpg?s=128&g=1", "display_name": "coreyward", "link": "https://stackoverflow.com/users/203130/coreyward"}, "edited": false, "score": 0, "creation_date": 1501001195, "post_id": 45308629, "comment_id": 77580523, "body": "This is actually a duplicate: <a href=\"https://stackoverflow.com/questions/40978962/testing-singular-resource-controller-with-rspec\" title=\"testing singular resource controller with rspec\">stackoverflow.com/questions/40978962/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 1387, "user_id": 3981789, "user_type": "registered", "accept_rate": 54, "profile_image": "https://i.stack.imgur.com/OO3JI.jpg?s=128&g=1", "display_name": "Rockster160", "link": "https://stackoverflow.com/users/3981789/rockster160"}, "edited": false, "score": 0, "creation_date": 1500999776, "post_id": 45308698, "comment_id": 77579554, "body": "Where is the spec requesting the plural form? The controller is supposed to be pluralized even with a singular route, if that&#39;s what you were referring to- so I&#39;m not sure where the pluralization is messed up?"}, {"owner": {"reputation": 1387, "user_id": 3981789, "user_type": "registered", "accept_rate": 54, "profile_image": "https://i.stack.imgur.com/OO3JI.jpg?s=128&g=1", "display_name": "Rockster160", "link": "https://stackoverflow.com/users/3981789/rockster160"}, "edited": false, "score": 0, "creation_date": 1501000583, "post_id": 45308698, "comment_id": 77580068, "body": "Switched all of the references to the Controller to singular (by manually assigning the controller in the routes) and the problem still exists."}, {"owner": {"reputation": 67463, "user_id": 203130, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/1RE8c.jpg?s=128&g=1", "display_name": "coreyward", "link": "https://stackoverflow.com/users/203130/coreyward"}, "reply_to_user": {"reputation": 1387, "user_id": 3981789, "user_type": "registered", "accept_rate": 54, "profile_image": "https://i.stack.imgur.com/OO3JI.jpg?s=128&g=1", "display_name": "Rockster160", "link": "https://stackoverflow.com/users/3981789/rockster160"}, "edited": false, "score": 0, "creation_date": 1501001213, "post_id": 45308698, "comment_id": 77580531, "body": "@Rockster160 I added some more info for you."}, {"owner": {"reputation": 1387, "user_id": 3981789, "user_type": "registered", "accept_rate": 54, "profile_image": "https://i.stack.imgur.com/OO3JI.jpg?s=128&g=1", "display_name": "Rockster160", "link": "https://stackoverflow.com/users/3981789/rockster160"}, "edited": false, "score": 0, "creation_date": 1501003250, "post_id": 45308698, "comment_id": 77581756, "body": "I&#39;m having the same issue using plural resources. (Switched to a different controller to try to test, but it&#39;s still failing with the same error)"}, {"owner": {"reputation": 1387, "user_id": 3981789, "user_type": "registered", "accept_rate": 54, "profile_image": "https://i.stack.imgur.com/OO3JI.jpg?s=128&g=1", "display_name": "Rockster160", "link": "https://stackoverflow.com/users/3981789/rockster160"}, "edited": false, "score": 0, "creation_date": 1501005443, "post_id": 45308698, "comment_id": 77583129, "body": "Is there a way to specify the path in my spec? I can&#39;t find a way to manually add in a path. I&#39;ve made the route plural, I&#39;ve tried making the controller singular, I&#39;ve read through the other post you commented and didn&#39;t make any progress. (their issue was, again, invalid routing syntax- like most of the other posts I&#39;ve seen that are similar to this one)"}], "tags": [], "owner": {"reputation": 67463, "user_id": 203130, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/1RE8c.jpg?s=128&g=1", "display_name": "coreyward", "link": "https://stackoverflow.com/users/203130/coreyward"}, "is_accepted": false, "score": 0, "last_activity_date": 1501001204, "last_edit_date": 1501001204, "creation_date": 1500999597, "answer_id": 45308698, "question_id": 45308629, "link": "https://stackoverflow.com/questions/45308629/rails-5-rspec-actioncontrollerurlgenerationerror/45308698#45308698", "title": "Rails 5 Rspec ActionController::UrlGenerationError", "body": "<p>You're using the singular <code>resource</code> in your routes but your spec is requesting the plural form \u201creputation_enhancement<strong>s</strong>\u201d.</p>\n\n<p>See <a href=\"http://guides.rubyonrails.org/routing.html#singular-resources\" rel=\"nofollow noreferrer\">this bit in the routing guide for singular resources</a> and <a href=\"https://github.com/rails/rails/issues/1769\" rel=\"nofollow noreferrer\">this long standing issue</a> in the Rails issue tracker that explains that there's no good way to get <code>url_for</code> to map back to a singular resource. </p>\n\n<p>To resolve it, either specify the path in your spec or add a plural route. </p>\n"}, {"comments": [{"owner": {"reputation": 478, "user_id": 3568626, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/8242a180ffea103035a63a0615154946?s=128&d=identicon&r=PG&f=1", "display_name": "HFX", "link": "https://stackoverflow.com/users/3568626/hfx"}, "edited": false, "score": 1, "creation_date": 1510804238, "post_id": 45312280, "comment_id": 81593488, "body": "Thanks, <code>routes { Rails.application.routes }</code> works. Is there a convenient way to do this? It&#39;s annoying to add this for all <code>describe</code> block."}, {"owner": {"reputation": 1387, "user_id": 3981789, "user_type": "registered", "accept_rate": 54, "profile_image": "https://i.stack.imgur.com/OO3JI.jpg?s=128&g=1", "display_name": "Rockster160", "link": "https://stackoverflow.com/users/3981789/rockster160"}, "reply_to_user": {"reputation": 478, "user_id": 3568626, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/8242a180ffea103035a63a0615154946?s=128&d=identicon&r=PG&f=1", "display_name": "HFX", "link": "https://stackoverflow.com/users/3568626/hfx"}, "edited": false, "score": 0, "creation_date": 1510877408, "post_id": 45312280, "comment_id": 81634769, "body": "Hm. I didn&#39;t look much deeper into, I&#39;m sorry. I do image there is a way to configure some sort of option in rspec to set that automatically."}], "tags": [], "owner": {"reputation": 1387, "user_id": 3981789, "user_type": "registered", "accept_rate": 54, "profile_image": "https://i.stack.imgur.com/OO3JI.jpg?s=128&g=1", "display_name": "Rockster160", "link": "https://stackoverflow.com/users/3981789/rockster160"}, "is_accepted": true, "score": 1, "last_activity_date": 1501012083, "creation_date": 1501012083, "answer_id": 45312280, "question_id": 45308629, "link": "https://stackoverflow.com/questions/45308629/rails-5-rspec-actioncontrollerurlgenerationerror/45312280#45312280", "title": "Rails 5 Rspec ActionController::UrlGenerationError", "body": "<p>Turns out, the issue was that the Controller was part of a gem and the routes to access the controller were not included by default. </p>\n\n<p>Solved by adding <code>routes { Spaceman::Engine.routes }</code> to the top inside of the main <code>describe</code> block.</p>\n\n<p>It's all fine to leave singular routes and everything else was set up correctly. Just had to include the routes.</p>\n"}], "owner": {"reputation": 1387, "user_id": 3981789, "user_type": "registered", "accept_rate": 54, "profile_image": "https://i.stack.imgur.com/OO3JI.jpg?s=128&g=1", "display_name": "Rockster160", "link": "https://stackoverflow.com/users/3981789/rockster160"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1192, "favorite_count": 0, "accepted_answer_id": 45312280, "answer_count": 2, "score": 2, "last_activity_date": 1501012083, "creation_date": 1500999335, "last_edit_date": 1501004074, "question_id": 45308629, "link": "https://stackoverflow.com/questions/45308629/rails-5-rspec-actioncontrollerurlgenerationerror", "title": "Rails 5 Rspec ActionController::UrlGenerationError", "body": "<p>Searched through other similar questions on here, and they all seem to be related to a malformed request of some sort (Not providing an <code>id</code>, or not including the params correctly) but those don't seem to be the problem I'm having.</p>\n\n<p>The route definitely exists, going to the route in the browser works just fine. Page loads, everything. But Rspec is giving me a UrlGenerationError for some reason. </p>\n\n<p>I've tried manually specifying the controller name in the routes, changing to a pluralized controller, and even using a different (pluralized) controller. It's seeming like there is an issue with some other configuration somewhere, but the error that it's a URLGeneration error is extremely unhelpful. I would greatly appreciate any other ideas.</p>\n\n<p>We have API controller specs elsewhere in our app that seem to be functioning correctly, but I cannot tell the difference in set up between those and this one.</p>\n\n<p>My error:</p>\n\n<pre><code>  1) Spaceman::ReputationEnhancementsController GET show has a 200 status code\n     Failure/Error: get :show\n\n     ActionController::UrlGenerationError:\n       No route matches {:action=&gt;\"show\", :controller=&gt;\"spaceman/reputation_enhancements\"}\n     # ./spec/controllers/spaceman/reputation_enhancements_controller_spec.rb:10:in `block (3 levels) in &lt;top (required)&gt;'\n\nFinished in 1.14 seconds (files took 6.13 seconds to load)\n1 example, 1 failure\n\nFailed examples:\n\nrspec ./spec/controllers/spaceman/reputation_enhancements_controller_spec.rb:9 # Spaceman::ReputationEnhancementsController GET show has a 200 status code\n</code></pre>\n\n<p>Routes:</p>\n\n<pre><code>Spaceman::Engine.routes.draw do\n  resource :reputation_enhancement, path: \"reputation-enhancement\", only: [ :show, :create ] do\n    get :filter\n  end\nend\n</code></pre>\n\n<p>Test: (I've tried added <code>type: :controller</code> here, as well as fully qualifying, adding <code>Rspec.describe</code> instead, etc...)</p>\n\n<pre><code>require \"rails_helper\"\n\ndescribe Spaceman::ReputationEnhancementsController do\n\n  describe \"GET show\" do\n    it \"has a 200 status code\" do\n      get :show\n      expect(response.status).to eq(200)\n    end\n  end\n\nend\n</code></pre>\n\n<p><code>rake routes</code></p>\n\n<pre><code>filter_reputation_enhancement GET    /reputation-enhancement/filter(.:format) spaceman/reputation_enhancements#filter\n       reputation_enhancement GET    /reputation-enhancement(.:format)        spaceman/reputation_enhancements#show\n                              POST   /reputation-enhancement(.:format)        spaceman/reputation_enhancements#create\n</code></pre>\n\n<p>EDIT:</p>\n\n<p>I've tried manually specifying the controller name in the routes, changing to a pluralized controller, and even using a different (pluralized) controller. It's seeming like there is an issue with some other configuration somewhere, but the error that it's a URLGeneration error is extremely unhelpful. I would greatly appreciate any other ideas.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "url"], "answers": [{"tags": [], "owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "is_accepted": true, "score": 3, "last_activity_date": 1500995820, "creation_date": 1500995820, "answer_id": 45307393, "question_id": 45304957, "link": "https://stackoverflow.com/questions/45304957/unable-to-convert-url-params-string-to-hash-and-then-back-to-url-string/45307393#45307393", "title": "Unable to convert url params string to hash and then back to url string", "body": "<p>The CGI module is a complete dinosaur and should probably be thrown in the garbage because of how bad it is, but for some reason it persists in the Ruby core. Maybe some day someone will refactor it and make it workable. Until then, skip it and use something better like URI, which is also built-in.</p>\n\n<p>Given your irregular, non-compliant query string:</p>\n\n<pre><code>query_string = 'something=1,2,3,4,5&amp;something_else=6,7,8'\n</code></pre>\n\n<p>You can handle this by using the <code>decode_www_form</code> method which handles query-strings:</p>\n\n<pre><code>require 'uri'\ndecoded = URI.decode_www_form(query_string).to_h\n# =&gt; {\"something\"=&gt;\"1,2,3,4,5\", \"something_else\"=&gt;\"6,7,8\"}\n</code></pre>\n\n<p>To re-encode it you just call <code>encode_www_form</code> and then force <code>unescape</code> to undo what it's correctly doing to handle the <code>,</code> values:</p>\n\n<pre><code>encoded = URI.unescape(URI.encode_www_form(decoded))\n# =&gt; \"something=1,2,3,4,5&amp;something_else=6,7,8\"\n</code></pre>\n\n<p>That should get the effect you want.</p>\n"}], "owner": {"reputation": 1225, "user_id": 1735921, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/3xEka.jpg?s=128&g=1", "display_name": "user1735921", "link": "https://stackoverflow.com/users/1735921/user1735921"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1041, "favorite_count": 0, "accepted_answer_id": 45307393, "answer_count": 1, "score": 1, "last_activity_date": 1500995820, "creation_date": 1500989660, "last_edit_date": 1500995411, "question_id": 45304957, "link": "https://stackoverflow.com/questions/45304957/unable-to-convert-url-params-string-to-hash-and-then-back-to-url-string", "title": "Unable to convert url params string to hash and then back to url string", "body": "<p>Input is a params string (Input format cannot be changed)</p>\n\n<pre><code>something=1,2,3,4,5&amp;something_else=6,7,8\n</code></pre>\n\n<p>Expected Output:</p>\n\n<pre><code>something=1,2,3,4,5&amp;something_else=6,7,8\n</code></pre>\n\n<p>What I am doing:</p>\n\n<pre><code>params = 'something=1,2,3,4,5'\nCGI::parse(params)\nCGI.unescape(CGI.parse(params).to_query)\n</code></pre>\n\n<p>And I am getting this as output:</p>\n\n<pre><code>something[]=1,2,3,4,5\n</code></pre>\n\n<p>When I did <code>CGI::parse(params)</code>\nI am getting this : <code>{\"something\"=&gt;[\"1,2,3,4,5\"]}</code></p>\n\n<p>which is wrong because it is not an array, something is a string which is \"1,2,3,4,5\" but it is being converted as array when I did CGI parse.</p>\n\n<p>The reason I need to do CGI parse is because I need to manipulate the url PARAMS.</p>\n\n<p>Is there any other possible way where I can convert it in the right way and maintain the params format?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "mongodb", "ruby-on-rails-4", "mongoid"], "comments": [{"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1500990065, "post_id": 45304386, "comment_id": 77571850, "body": "I don&#39;t know if <code>mongodb</code> supports complex ordering like that (<a href=\"https://stackoverflow.com/a/38369862/1954610\">a quick google suggests &quot;no&quot;</a>, but I could have missed something). However, for performance you could instead add a <b>new</b> database field called <code>review_text_length</code> or <code>review_text_present</code>? This would allow you to simply order by that field&#39;s size/presence."}, {"owner": {"reputation": 9993, "user_id": 2128691, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/YV6xv.jpg?s=128&g=1", "display_name": "dax", "link": "https://stackoverflow.com/users/2128691/dax"}, "reply_to_user": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1500990266, "post_id": 45304386, "comment_id": 77572029, "body": "@TomLord: good idea, thanks!"}], "owner": {"reputation": 9993, "user_id": 2128691, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/YV6xv.jpg?s=128&g=1", "display_name": "dax", "link": "https://stackoverflow.com/users/2128691/dax"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 42, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1500988189, "creation_date": 1500988189, "question_id": 45304386, "link": "https://stackoverflow.com/questions/45304386/optimizing-queries-which-priortize-non-empty-text-fields", "title": "Optimizing queries which priortize non-empty text fields", "body": "<p>I'm working on a very large, long-running Rails monolith which is using Mongoid.  I've been asked to find and optimize slow running queries, which I've started doing with the help of the mLab plugin in Heroku.  </p>\n\n<p>This query (some column names redacted) comes up as the number one slowest running function: </p>\n\n<pre><code>{\n  \"status\":\"&lt;val&gt;\",\n  \"from\":{\"$regex\":\"&lt;val&gt;\",\"$options\":\"&lt;val&gt;\"},\n  \"text\":{\"$regex\":\"&lt;val&gt;\",\"$options\":\"&lt;val&gt;\"},\n  \"field_x\":{\"$gte\":\"&lt;val&gt;\"},\n  \"field_y\":{\"$gte\":\"&lt;val&gt;\"},\n  \"field_z\":{\"$gte\":\"&lt;val&gt;\"}\n}\n</code></pre>\n\n<p>mLab gives some recommendations to improve slow running queries and I've added the index it suggested, but I wonder if I can make the Rails query itself better.  It looks like this (model names changed): </p>\n\n<pre><code>@reviews = object.reviews.active.and(:text.ne =&gt; nil, :text.ne =&gt; '').desc(:created_at)\n@reviews += object.reviews.active.any_of({text: nil}, {text: ''}).desc(:created_at)\n</code></pre>\n\n<p>I did not write this code, but as I understand it, it wants to prioritize reviews with text so that a 5-star review with text <code>OMG, LIKE TOTALLY AMAZE-BALLZ</code> is listed above a 5-star review with no text.  Is there a better, more efficient to write this?   </p>\n"}, {"tags": ["ruby-on-rails", "ruby", "validation", "ruby-on-rails-5", "http-status-codes"], "comments": [{"owner": {"reputation": 1281, "user_id": 2308531, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/DV29D.jpg?s=128&g=1", "display_name": "Maxim Fedotov", "link": "https://stackoverflow.com/users/2308531/maxim-fedotov"}, "edited": false, "score": 0, "creation_date": 1501009596, "post_id": 45304311, "comment_id": 77585589, "body": "Why don&#39;t you instead of rendering a json, return <code>head :conflict</code>?"}, {"owner": {"reputation": 127, "user_id": 2385232, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/e94c96aa9ea2bf4a8e62c96e4142c50a?s=128&d=identicon&r=PG", "display_name": "Kevin van den Bekerom", "link": "https://stackoverflow.com/users/2385232/kevin-van-den-bekerom"}, "reply_to_user": {"reputation": 1281, "user_id": 2308531, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/DV29D.jpg?s=128&g=1", "display_name": "Maxim Fedotov", "link": "https://stackoverflow.com/users/2308531/maxim-fedotov"}, "edited": false, "score": 0, "creation_date": 1501057729, "post_id": 45304311, "comment_id": 77604740, "body": "@MaximFedotov The job if this rest api server is purely handling rest calls. It does not need to render anything graphical, just some specified json structures ;)"}], "answers": [{"tags": [], "owner": {"reputation": 1281, "user_id": 2308531, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/DV29D.jpg?s=128&g=1", "display_name": "Maxim Fedotov", "link": "https://stackoverflow.com/users/2308531/maxim-fedotov"}, "is_accepted": true, "score": 1, "last_activity_date": 1501010083, "creation_date": 1501010083, "answer_id": 45311773, "question_id": 45304311, "link": "https://stackoverflow.com/questions/45304311/rails-validation-error-messages-add-response-code-to-default-validators/45311773#45311773", "title": "Rails validation error messages: Add response code to default validators", "body": "<p>In this case, creating a custom validator might be one approach and you could always expand the complexity</p>\n\n<pre><code>validates_with NameValidator\n</code></pre>\n\n<p>Custom validator</p>\n\n<pre><code>class NameValidator &lt; ActiveModel::Validator\n  def validate(record)\n    if record.blank? || Model.where(name: record.name).exists?\n      record.errors.add(:base, \"Duplicate names not allowed!\")\n    end\n  end\nend\n</code></pre>\n"}], "owner": {"reputation": 127, "user_id": 2385232, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/e94c96aa9ea2bf4a8e62c96e4142c50a?s=128&d=identicon&r=PG", "display_name": "Kevin van den Bekerom", "link": "https://stackoverflow.com/users/2385232/kevin-van-den-bekerom"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1206, "favorite_count": 1, "accepted_answer_id": 45311773, "answer_count": 1, "score": 3, "last_activity_date": 1501010083, "creation_date": 1500988030, "last_edit_date": 1500988832, "question_id": 45304311, "link": "https://stackoverflow.com/questions/45304311/rails-validation-error-messages-add-response-code-to-default-validators", "title": "Rails validation error messages: Add response code to default validators", "body": "<p>I am looking for a best-practise / solution to render responses with different http-response codes than 422 - unprocessable entity. </p>\n\n<p>I have a simple validator: </p>\n\n<pre><code>validates :name, presence: true, uniqueness: {message: 'duplicate names are not allowed!'}\n</code></pre>\n\n<p>I want to return status code 409 - Conflict (:conflict) when this validation fails. Possible solution:</p>\n\n<ol>\n<li>Add status code to errors hash, e.g. <code>errors.add(status_code: '409')</code>. Then either render the status code from errors, or render 422 if multiple exists.</li>\n</ol>\n\n<p>The problem with the above solution is that I do not know how to call the <code>errors.add</code> function on a 'standard' validator. </p>\n\n<p>My render code:</p>\n\n<pre><code>if model.save\n    render json: model, status: :created\n  else\n    render json: model.errors, status: :unprocessable_entity\n  end\n</code></pre>\n\n<p>Which I would like to extent that it can render different status codes based on validation results.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-3", "ruby-on-rails-4"], "answers": [{"tags": [], "owner": {"reputation": 12085, "user_id": 632688, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b6c6e4e8117bbd27fd25e9e2ea350458?s=128&d=identicon&r=PG", "display_name": "Wizard of Ogz", "link": "https://stackoverflow.com/users/632688/wizard-of-ogz"}, "is_accepted": false, "score": 1, "last_activity_date": 1500988969, "last_edit_date": 1500988969, "creation_date": 1500987455, "answer_id": 45304087, "question_id": 45303762, "link": "https://stackoverflow.com/questions/45303762/best-way-to-get-records-from-another-model-again-and-again-rails/45304087#45304087", "title": "Best way to get records from another model again and again - Rails", "body": "<p>This is called an \"N+1 queries\" problem. In Rails you can use eager loading to resolve it. You could use <code>includes</code> to load records in a single query by changing the first line of your code to</p>\n\n<pre><code>spaces = Space.eager_load(:bookings)\n</code></pre>\n\n<p>Here is a good explanation and comparison of ways (<code>includes</code>, <code>eager_load</code> and <code>preload</code>) to do eager loading in Rails <a href=\"http://blog.arkency.com/2013/12/rails4-preloading/\" rel=\"nofollow noreferrer\">link</a>.</p>\n"}], "owner": {"reputation": 3154, "user_id": 5409748, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/DQWhS.jpg?s=128&g=1", "display_name": "Jai Kumar Rajput", "link": "https://stackoverflow.com/users/5409748/jai-kumar-rajput"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 38, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1500988969, "creation_date": 1500986778, "question_id": 45303762, "link": "https://stackoverflow.com/questions/45303762/best-way-to-get-records-from-another-model-again-and-again-rails", "title": "Best way to get records from another model again and again - Rails", "body": "<p>I have a model <code>Booking</code> which contains <code>space_id</code> attributes associated with <code>Space</code> Model by <code>belongs_to :space</code>.</p>\n\n<p>Now I have multiple spaces and want to count each booking with respect to every id. </p>\n\n<p>I want to get the best way to fatch records from DB without fire query again and again.\nCurrently, I'm doing like this:</p>\n\n<pre><code>spaces = Space.all\nresult = []\nspaces.each do |s|\n    result &lt;&lt; s.as_json.merge(:bookings_counts=&gt;s.bookings.count)\nend\n</code></pre>\n\n<p>but this is firing query again and again form db. is there any best way to do  this?</p>\n"}, {"tags": ["ruby", "multithreading", "jruby"], "answers": [{"comments": [{"owner": {"reputation": 381, "user_id": 531853, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a2ea58853dd8c7433198e4cfc2220ca?s=128&d=identicon&r=PG", "display_name": "Sunu Pinasthika Fajar", "link": "https://stackoverflow.com/users/531853/sunu-pinasthika-fajar"}, "edited": false, "score": 0, "creation_date": 1501021226, "post_id": 45308188, "comment_id": 77591321, "body": "Ah nice. great to know that. one more question. how we proof that it&#39;s run in parallel."}, {"owner": {"reputation": 4150, "user_id": 7470620, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/49f3026fe13841e41d1805178eed9a3c?s=128&d=identicon&r=PG", "display_name": "eiko", "link": "https://stackoverflow.com/users/7470620/eiko"}, "reply_to_user": {"reputation": 381, "user_id": 531853, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a2ea58853dd8c7433198e4cfc2220ca?s=128&d=identicon&r=PG", "display_name": "Sunu Pinasthika Fajar", "link": "https://stackoverflow.com/users/531853/sunu-pinasthika-fajar"}, "edited": false, "score": 0, "creation_date": 1501083352, "post_id": 45308188, "comment_id": 77624820, "body": "@SunuPinasthikaFajar if you&#39;re on Windows, you can open Task Manager, go to the Performance tab, right click and select <code>Change Graph to &gt; Logical processors</code>. This will allow you to monitor all of your processor cores to see if your code is running on all of them or one of them."}, {"owner": {"reputation": 4150, "user_id": 7470620, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/49f3026fe13841e41d1805178eed9a3c?s=128&d=identicon&r=PG", "display_name": "eiko", "link": "https://stackoverflow.com/users/7470620/eiko"}, "reply_to_user": {"reputation": 381, "user_id": 531853, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a2ea58853dd8c7433198e4cfc2220ca?s=128&d=identicon&r=PG", "display_name": "Sunu Pinasthika Fajar", "link": "https://stackoverflow.com/users/531853/sunu-pinasthika-fajar"}, "edited": false, "score": 1, "creation_date": 1501083418, "post_id": 45308188, "comment_id": 77624883, "body": "If you&#39;re on Linux, you can use the <code>htop</code> command to see on which cores your process is running."}, {"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 0, "creation_date": 1501314924, "post_id": 45308188, "comment_id": 77734511, "body": "&quot;Java threads are wrappers for native system threads, so they&#39;re parallel out of the box.&quot; \u2013 That is not true. 1) You are implying that native threads are automatically parallel and green threads aren&#39;t. That&#39;s wrong. E.g. YARV threads are <i>also</i> &quot;wrappers for native system threads&quot;, and they are <i>not</i> parallel, whereas BEAM&#39;s threads are green threads, yet parallel. 2) There is no guarantee in the Java Language Specification that says anything about how threads are implemented, nor does it say anything about whether or not they are parallel. It is perfectly valid to implement Java with \u2026"}, {"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 0, "creation_date": 1501315112, "post_id": 45308188, "comment_id": 77734556, "body": "\u2026 non-parallel threads, and it is perfectly valid to implement Java with green threads, and there <i>are</i> green-threaded Java implementations, non-parallel threaded Java implementations, and both. In fact, Sun&#39;s implementation of Java used to be one of those. 3) even <i>if</i> Java threads are implemented as native system threads, it is perfectly possible for native system threads to <i>not</i> be parallel. There are plenty of operating systems on which threads are not parallel. 4) Even <i>if</i> your OS has parallel threads, they can still only execute in parallel if you have multiple CPUs. There are plenty \u2026"}, {"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 0, "creation_date": 1501315121, "post_id": 45308188, "comment_id": 77734562, "body": "\u2026 of machines that don&#39;t."}, {"owner": {"reputation": 4150, "user_id": 7470620, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/49f3026fe13841e41d1805178eed9a3c?s=128&d=identicon&r=PG", "display_name": "eiko", "link": "https://stackoverflow.com/users/7470620/eiko"}, "reply_to_user": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 0, "creation_date": 1501509699, "post_id": 45308188, "comment_id": 77796757, "body": "@J&#246;rgWMittag thanks, i&#39;ve updated my answer to be less misleading."}], "tags": [], "owner": {"reputation": 4150, "user_id": 7470620, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/49f3026fe13841e41d1805178eed9a3c?s=128&d=identicon&r=PG", "display_name": "eiko", "link": "https://stackoverflow.com/users/7470620/eiko"}, "is_accepted": false, "score": 1, "last_activity_date": 1501509682, "last_edit_date": 1501509682, "creation_date": 1500997996, "answer_id": 45308188, "question_id": 45303695, "link": "https://stackoverflow.com/questions/45303695/does-my-ruby-thread-code-will-run-in-parallel-automatically-when-use-jruby/45308188#45308188", "title": "Does my ruby thread code will run in parallel automatically when use jRuby", "body": "<p>In short, yes, it will be parallel. jruby ships with a custom thread library written in native java, so when you put <code>require 'thread'</code> at the top of your file, you're actually using a java library, not a ruby library. </p>\n\n<p>As long as your java installation supports parallel threads (and most modern ones do), and as long as your operating system supports parallel threads (most mordern ones do), then your jruby code has the potential to run in parallel as well.</p>\n"}], "owner": {"reputation": 381, "user_id": 531853, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a2ea58853dd8c7433198e4cfc2220ca?s=128&d=identicon&r=PG", "display_name": "Sunu Pinasthika Fajar", "link": "https://stackoverflow.com/users/531853/sunu-pinasthika-fajar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 237, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1501509682, "creation_date": 1500986624, "question_id": 45303695, "link": "https://stackoverflow.com/questions/45303695/does-my-ruby-thread-code-will-run-in-parallel-automatically-when-use-jruby", "title": "Does my ruby thread code will run in parallel automatically when use jRuby", "body": "<p>I have this code</p>\n\n<pre><code>require 'thread'\nwork_q = Queue.new\n(0..50).to_a.each{|x| work_q.push x }\nworkers = (0...4).map do\n  Thread.new do\n    begin\n      while x = work_q.pop(true)\n        50.times{print [128000+x].pack \"U*\"}\n      end\n    rescue ThreadError\n    end\n  end\nend\nworkers.map(&amp;:join)\n</code></pre>\n\n<p>I know if I run using MRI, it's only run concurently.</p>\n\n<p>But If I run it on jRuby will it run concurently and parallel, or just concurently</p>\n\n<p>Is it mandatory to write thread code using java on jRuby to achieve the parallel process?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "rubygems", "ruby-on-rails-5"], "comments": [{"owner": {"reputation": 32131, "user_id": 2346461, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/i3xAf.jpg?s=128&g=1", "display_name": "Pavan", "link": "https://stackoverflow.com/users/2346461/pavan"}, "edited": false, "score": 0, "creation_date": 1500986366, "post_id": 45303390, "comment_id": 77568584, "body": "Do you having any problem currently? <code>@user.followers</code> seems correct as per the gem."}, {"owner": {"reputation": 59, "user_id": 8294928, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/05ad6d3286dc3db08e0ac904acc9a885?s=128&d=identicon&r=PG&f=1", "display_name": "Michal", "link": "https://stackoverflow.com/users/8294928/michal"}, "reply_to_user": {"reputation": 32131, "user_id": 2346461, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/i3xAf.jpg?s=128&g=1", "display_name": "Pavan", "link": "https://stackoverflow.com/users/2346461/pavan"}, "edited": false, "score": 0, "creation_date": 1500986889, "post_id": 45303390, "comment_id": 77569034, "body": "Method @user.followers work fine. I want add view with &gt;@user.follows but this method isn&#39;t exist in this gem."}, {"owner": {"reputation": 32131, "user_id": 2346461, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/i3xAf.jpg?s=128&g=1", "display_name": "Pavan", "link": "https://stackoverflow.com/users/2346461/pavan"}, "edited": false, "score": 0, "creation_date": 1500987014, "post_id": 45303390, "comment_id": 77569144, "body": "It has <code>all_follows</code> try it like <code>@user.all_follows</code>"}, {"owner": {"reputation": 32131, "user_id": 2346461, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/i3xAf.jpg?s=128&g=1", "display_name": "Pavan", "link": "https://stackoverflow.com/users/2346461/pavan"}, "edited": false, "score": 0, "creation_date": 1500987236, "post_id": 45303390, "comment_id": 77569322, "body": "If it doesn&#39;t work, try <code>@user.all_following</code>"}, {"owner": {"reputation": 59, "user_id": 8294928, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/05ad6d3286dc3db08e0ac904acc9a885?s=128&d=identicon&r=PG&f=1", "display_name": "Michal", "link": "https://stackoverflow.com/users/8294928/michal"}, "reply_to_user": {"reputation": 32131, "user_id": 2346461, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/i3xAf.jpg?s=128&g=1", "display_name": "Pavan", "link": "https://stackoverflow.com/users/2346461/pavan"}, "edited": false, "score": 1, "creation_date": 1500987377, "post_id": 45303390, "comment_id": 77569449, "body": "@user.all_following works! Thank you!"}, {"owner": {"reputation": 32131, "user_id": 2346461, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/i3xAf.jpg?s=128&g=1", "display_name": "Pavan", "link": "https://stackoverflow.com/users/2346461/pavan"}, "edited": false, "score": 0, "creation_date": 1500987503, "post_id": 45303390, "comment_id": 77569566, "body": "Great! I&#39;ve added it as an answer :)"}], "answers": [{"tags": [], "owner": {"reputation": 32131, "user_id": 2346461, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/i3xAf.jpg?s=128&g=1", "display_name": "Pavan", "link": "https://stackoverflow.com/users/2346461/pavan"}, "is_accepted": false, "score": 0, "last_activity_date": 1500987477, "creation_date": 1500987477, "answer_id": 45304090, "question_id": 45303390, "link": "https://stackoverflow.com/questions/45303390/acts-as-follower-display-follows-ror/45304090#45304090", "title": "Acts_as_follower display follows RoR", "body": "<blockquote>\n  <p>How to display the users I follow?</p>\n</blockquote>\n\n<p>I believe the method you want is <code>all_following</code></p>\n\n<pre><code>user.all_following\n</code></pre>\n\n<blockquote>\n  <p>Returns an array of every followed object for the user, this can be a\n  collection of different object types, eg: User, Book</p>\n</blockquote>\n\n<p>So, the below should work</p>\n\n<pre><code>@user.all_following\n</code></pre>\n"}], "owner": {"reputation": 59, "user_id": 8294928, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/05ad6d3286dc3db08e0ac904acc9a885?s=128&d=identicon&r=PG&f=1", "display_name": "Michal", "link": "https://stackoverflow.com/users/8294928/michal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 57, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1500987477, "creation_date": 1500985917, "last_edit_date": 1500986421, "question_id": 45303390, "link": "https://stackoverflow.com/questions/45303390/acts-as-follower-display-follows-ror", "title": "Acts_as_follower display follows RoR", "body": "<p>I am using a ruby gem called <a href=\"https://github.com/tcocca/acts_as_follower\" rel=\"nofollow noreferrer\">acts_as_follower</a></p>\n\n<p>My code:</p>\n\n<p><strong>user.rb</strong></p>\n\n<pre><code>class User &lt; ApplicationRecord\n\n    acts_as_followable\n    acts_as_follower\nend\n</code></pre>\n\n<p><strong>users_controller.rb</strong></p>\n\n<pre><code>def follow\n  @user = User.find(params[:id])\n  current_user.follow(@user)\n  redirect_to root_path\nend\n\ndef unfollow\n  @user = User.find(params[:id])\n  current_user.stop_following(@user)\n  redirect_to root_path\nend\n</code></pre>\n\n<p><strong>followers.html.erb</strong></p>\n\n<pre><code>&lt;% @user.followers.each do |user| %&gt;\n\n  &lt;div class=\"panel panel-default col-md-offset-3 col-md-6\"&gt;\n  &lt;br&gt;\n    &lt;div class=\"panel panel-heading\"&gt;\n\n      &lt;%= avatar_for(user, size: 50) %&gt;\n      &lt;h1&gt; &lt;%=link_to user.name, user %&gt;&lt;/h1&gt;\n\n   &lt;/div&gt;\n &lt;/div&gt;\n</code></pre>\n\n  \n\n<p><strong>routes.rb</strong></p>\n\n<pre><code>#followers\nresources :users do\n   member do\n     get :follow\n     get :unfollow\n   end\nend\n</code></pre>\n\n<p>How to display the users I follow? </p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-4", "devise", "devise-confirmable"], "comments": [{"owner": {"reputation": 6039, "user_id": 2137458, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8cfca832ee746f3e3d9971148f52dc64?s=128&d=identicon&r=PG", "display_name": "NM Pennypacker", "link": "https://stackoverflow.com/users/2137458/nm-pennypacker"}, "edited": false, "score": 0, "creation_date": 1500984409, "post_id": 45302405, "comment_id": 77566898, "body": "What&#39;s in <code>TransactionsController#create</code>?"}, {"owner": {"reputation": 685, "user_id": 7458849, "user_type": "registered", "accept_rate": 45, "profile_image": "https://i.stack.imgur.com/89kDb.jpg?s=128&g=1", "display_name": "Theopap", "link": "https://stackoverflow.com/users/7458849/theopap"}, "reply_to_user": {"reputation": 6039, "user_id": 2137458, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8cfca832ee746f3e3d9971148f52dc64?s=128&d=identicon&r=PG", "display_name": "NM Pennypacker", "link": "https://stackoverflow.com/users/2137458/nm-pennypacker"}, "edited": false, "score": 0, "creation_date": 1500984707, "post_id": 45302405, "comment_id": 77567154, "body": "its another method which i&#39;m placing the <code>StoreMailer.confirmation_instructions(@store).deliver</code> inside"}, {"owner": {"reputation": 1528, "user_id": 7573791, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0e5e5cf864fb33229ca56750a51d6674?s=128&d=identicon&r=PG&f=1", "display_name": "Sajin", "link": "https://stackoverflow.com/users/7573791/sajin"}, "edited": false, "score": 0, "creation_date": 1500984803, "post_id": 45302405, "comment_id": 77567234, "body": "share that code also"}, {"owner": {"reputation": 685, "user_id": 7458849, "user_type": "registered", "accept_rate": 45, "profile_image": "https://i.stack.imgur.com/89kDb.jpg?s=128&g=1", "display_name": "Theopap", "link": "https://stackoverflow.com/users/7458849/theopap"}, "edited": false, "score": 0, "creation_date": 1500984988, "post_id": 45302405, "comment_id": 77567383, "body": "please check update 1"}], "answers": [{"comments": [{"owner": {"reputation": 685, "user_id": 7458849, "user_type": "registered", "accept_rate": 45, "profile_image": "https://i.stack.imgur.com/89kDb.jpg?s=128&g=1", "display_name": "Theopap", "link": "https://stackoverflow.com/users/7458849/theopap"}, "edited": false, "score": 0, "creation_date": 1500990947, "post_id": 45305406, "comment_id": 77572657, "body": "Thanks for the reply @Lucas Costa, I have already tried this: <code>StoreMailer.confirmation_instructions(@store, token).deliver</code>... and returns error <code>undefined local variable or method token</code>"}, {"owner": {"reputation": 1030, "user_id": 2100645, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5c9894864f33c42fffe19330d2e00d1b?s=128&d=identicon&r=PG", "display_name": "Lucas Costa", "link": "https://stackoverflow.com/users/2100645/lucas-costa"}, "reply_to_user": {"reputation": 685, "user_id": 7458849, "user_type": "registered", "accept_rate": 45, "profile_image": "https://i.stack.imgur.com/89kDb.jpg?s=128&g=1", "display_name": "Theopap", "link": "https://stackoverflow.com/users/7458849/theopap"}, "edited": false, "score": 0, "creation_date": 1500991091, "post_id": 45305406, "comment_id": 77572783, "body": "This is because you don&#39;t have any <code>token</code> variable defined in the scope of your method. I just updated my answer with a fix to it."}, {"owner": {"reputation": 685, "user_id": 7458849, "user_type": "registered", "accept_rate": 45, "profile_image": "https://i.stack.imgur.com/89kDb.jpg?s=128&g=1", "display_name": "Theopap", "link": "https://stackoverflow.com/users/7458849/theopap"}, "edited": false, "score": 0, "creation_date": 1500996921, "post_id": 45305406, "comment_id": 77577436, "body": "Actually I&#39;m after a devise confirmation token, any idea on how to implement this?"}], "tags": [], "owner": {"reputation": 1030, "user_id": 2100645, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5c9894864f33c42fffe19330d2e00d1b?s=128&d=identicon&r=PG", "display_name": "Lucas Costa", "link": "https://stackoverflow.com/users/2100645/lucas-costa"}, "is_accepted": false, "score": 0, "last_activity_date": 1500991044, "last_edit_date": 1500991044, "creation_date": 1500990755, "answer_id": 45305406, "question_id": 45302405, "link": "https://stackoverflow.com/questions/45302405/send-devise-confirmation-email-manually-later/45305406#45305406", "title": "Send devise confirmation email manually later", "body": "<p><code>confirmation_instructions</code> is a method defined in <code>Devise::Mailer</code> (the superclass of your <code>StoreMailer</code> class).<br>\nAs you can see <a href=\"http://www.rubydoc.info/github/plataformatec/devise/Devise%2FMailer%3Aconfirmation_instructions\" rel=\"nofollow noreferrer\">here</a> and <a href=\"https://github.com/plataformatec/devise/wiki/How-To:-Use-custom-mailer\" rel=\"nofollow noreferrer\">here</a>, it accepts 2 mandatory arguments and 1 optional.</p>\n\n<p>You're invoking the method passing just one argument.<br>\nYou must pass the second argument (<code>token</code>) too, like the following:</p>\n\n<pre><code>def create\n  # ...\n\n  # Note: I'm not sure this is the token you really need.\n  # It's your responsibility check if it's correct.\n  token = @result.customer.payment_methods.first.token\n  StoreMailer.confirmation_instructions(@store, token).deliver\n\n  # ...\nend\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2890, "user_id": 1237117, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/H7dfY.jpg?s=128&g=1", "display_name": "mridula", "link": "https://stackoverflow.com/users/1237117/mridula"}, "is_accepted": false, "score": 1, "last_activity_date": 1517823436, "creation_date": 1517823436, "answer_id": 48619465, "question_id": 45302405, "link": "https://stackoverflow.com/questions/45302405/send-devise-confirmation-email-manually-later/48619465#48619465", "title": "Send devise confirmation email manually later", "body": "<pre><code>@store.send_confirmation_instructions.deliver\n</code></pre>\n\n<p>This generates the confirmation token, as well as sends the mail.</p>\n"}, {"tags": [], "owner": {"reputation": 4107, "user_id": 1612469, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/VaKOC.jpg?s=128&g=1", "display_name": "Aleks", "link": "https://stackoverflow.com/users/1612469/aleks"}, "is_accepted": false, "score": 1, "last_activity_date": 1576232566, "creation_date": 1576232566, "answer_id": 59320536, "question_id": 45302405, "link": "https://stackoverflow.com/questions/45302405/send-devise-confirmation-email-manually-later/59320536#59320536", "title": "Send devise confirmation email manually later", "body": "<p>From the title seems like you are trying to manually send the email later. The proposed solution in your question is just postponing the email, not exactly manually triggering it. </p>\n\n<p>If you want to forbid sending the email immediately and then to send it manually you could do it like this:</p>\n\n<pre><code>class RegistrationsController\n...\ndef create\n...\nresource.skip_confirmation_notification!\n...\nend\n</code></pre>\n\n<p>Some other place where you want to trigger the email, call:</p>\n\n<pre><code>User.first.send_confirmation_instructions\n</code></pre>\n\n<p><code>User.first</code> - change with your user</p>\n"}], "owner": {"reputation": 685, "user_id": 7458849, "user_type": "registered", "accept_rate": 45, "profile_image": "https://i.stack.imgur.com/89kDb.jpg?s=128&g=1", "display_name": "Theopap", "link": "https://stackoverflow.com/users/7458849/theopap"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1469, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1576232566, "creation_date": 1500983391, "last_edit_date": 1500989556, "question_id": 45302405, "link": "https://stackoverflow.com/questions/45302405/send-devise-confirmation-email-manually-later", "title": "Send devise confirmation email manually later", "body": "<p>I have added <code>devise :confirmable</code> to my model and created a before_create to skip the confirmation.</p>\n\n<pre><code>before_create :skip_confirmation\n\ndef skip_confirmation\n  self.skip_confirmation!\nend\n</code></pre>\n\n<p>I have a mailer named store_mailer.rb along with appropriate views app/views/stores/mailer/confirmation_instroctions.html.erb to send out the confirmation email.</p>\n\n<pre><code>class StoreMailer &lt; Devise::Mailer\n  helper :application # gives access to all helpers defined within `application_helper`.\n  include Devise::Controllers::UrlHelpers # Optional. eg. `confirmation_url`\n  default template_path: 'store/mailer' # to make sure that your mailer uses the devise views\nend\n</code></pre>\n\n<p>confirmation_instroctions.html.erb</p>\n\n<pre><code>&lt;h2&gt;Resend confirmation instructions&lt;/h2&gt;\n\n&lt;%= form_for(resource, as: resource_name, url: confirmation_path(resource_name), html: { method: :post }) do |f| %&gt;\n  &lt;%= devise_error_messages! %&gt;\n\n  &lt;div class=\"field\"&gt;\n    &lt;%= f.label :email %&gt;&lt;br /&gt;\n    &lt;%= f.email_field :email, autofocus: true, value: (resource.pending_reconfirmation? ? resource.unconfirmed_email : resource.email) %&gt;\n  &lt;/div&gt;\n\n  &lt;div class=\"actions\"&gt;\n    &lt;%= f.submit \"Resend confirmation instructions\" %&gt;\n  &lt;/div&gt;\n&lt;% end %&gt;\n\n&lt;%= render \"stores/shared/links\" %&gt;\n</code></pre>\n\n<p>I'm trying to send the confirmation email with this:\n<code>StoreMailer.confirmation_instructions(@store).deliver</code></p>\n\n<p>But it returns the following error: <code>ArgumentError in TransactionsController#create\nwrong number of arguments (given 1, expected 2..3)</code></p>\n\n<p>Any ideas what might be wrong?</p>\n\n<p><strong>Update 1</strong></p>\n\n<p>transaction_controlller.rb</p>\n\n<pre><code>def create\n   nonce_from_the_client = params['payment_method_nonce']\n   @result = Braintree::Customer.create(\n    first_name: params['first_name'],\n    last_name: params['last_name'],\n    :payment_method_nonce =&gt; nonce_from_the_client\n   )\n\n   if @result.success?\n     puts @result.customer.id\n     puts @result.customer.payment_methods[0].token\n     StoreMailer.confirmation_instructions(@store).deliver\n     redirect_to showcase_index_path, notice: 'Subscribed, please check your inbox for confirmation'\n\n   else\n     redirect_back( fallback_location: (request.referer || root_path),\n                 notice: \"Something went wrong while processing your transaction. Please try again!\")\n   end\n end\n</code></pre>\n"}, {"tags": ["ruby", "rubygems", "jekyll", "bundler"], "answers": [{"comments": [{"owner": {"reputation": 13189, "user_id": 2087628, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/698fddc9acccb5115122e3150f6019fd?s=128&d=identicon&r=PG&f=1", "display_name": "JaskeyLam", "link": "https://stackoverflow.com/users/2087628/jaskeylam"}, "edited": false, "score": 1, "creation_date": 1501052182, "post_id": 45302166, "comment_id": 77600977, "body": "Thank you! I find that my bundle install is failed! I have resolve it and the problem then disappears."}], "tags": [], "owner": {"reputation": 38092, "user_id": 18706, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/cabf735ce7b8b4471ef46ea54f71832d?s=128&d=identicon&r=PG", "display_name": "mahemoff", "link": "https://stackoverflow.com/users/18706/mahemoff"}, "is_accepted": true, "score": 2, "last_activity_date": 1500982758, "creation_date": 1500982758, "answer_id": 45302166, "question_id": 45301378, "link": "https://stackoverflow.com/questions/45301378/bundler-could-not-find-compatible-versions-for-gem-jemoji-when-bundle-exec-j/45302166#45302166", "title": "&#39;Bundler could not find compatible versions for gem &quot;jemoji&quot;&#39; when bundle exec jekyll serve", "body": "<p>Run <code>bundle install</code> alone first (step 4 in the linked README). This should install the necessary packages.</p>\n\n<p>Then you can run <code>bundle exec jekyll serve</code>. The <code>bundle exec</code> means it will use those installed packages.</p>\n"}], "owner": {"reputation": 13189, "user_id": 2087628, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/698fddc9acccb5115122e3150f6019fd?s=128&d=identicon&r=PG&f=1", "display_name": "JaskeyLam", "link": "https://stackoverflow.com/users/2087628/jaskeylam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 382, "favorite_count": 0, "accepted_answer_id": 45302166, "answer_count": 1, "score": 1, "last_activity_date": 1500982758, "creation_date": 1500980528, "question_id": 45301378, "link": "https://stackoverflow.com/questions/45301378/bundler-could-not-find-compatible-versions-for-gem-jemoji-when-bundle-exec-j", "title": "&#39;Bundler could not find compatible versions for gem &quot;jemoji&quot;&#39; when bundle exec jekyll serve", "body": "<p>Actually I don't quite know what bundle nor jekyll is , but I am trying to execute <code>bundle exec jekyll serve</code> follow the guide <a href=\"https://github.com/apache/incubator-rocketmq-site\" rel=\"nofollow noreferrer\">https://github.com/apache/incubator-rocketmq-site</a> , but fails. </p>\n\n<p>I can't find google something similar like this so I post a question here.</p>\n\n<pre><code>$ bundle exec jekyll serve\nC:/Ruby22-x64/lib/ruby/gems/2.2.0/gems/bundler-1.15.3/lib/bundler/resolver.rb:21                                                                                       8:in `rescue in start': Bundler could not find compatible versions for gem \"jemo                                                                                       ji\": (Bundler::VersionConflict)\n  In Gemfile:\n    minimal-mistakes-jekyll x64-mingw32 was resolved to 4.1.0, which depends on\n      jemoji (~&gt; 0.7) x64-mingw32\n\nCould not find gem 'jemoji (~&gt; 0.7) x64-mingw32', which is required by gem 'mini                                                                                       mal-mistakes-jekyll x64-mingw32', in any of the sources.\n        from C:/Ruby22-x64/lib/ruby/gems/2.2.0/gems/bundler-1.15.3/lib/bundler/r                                                                                       esolver.rb:212:in `start'\n        from C:/Ruby22-x64/lib/ruby/gems/2.2.0/gems/bundler-1.15.3/lib/bundler/r                                                                                       esolver.rb:191:in `resolve'\n        from C:/Ruby22-x64/lib/ruby/gems/2.2.0/gems/bundler-1.15.3/lib/bundler/d                                                                                       efinition.rb:235:in `resolve'\n        from C:/Ruby22-x64/lib/ruby/gems/2.2.0/gems/bundler-1.15.3/lib/bundler/d                                                                                       efinition.rb:159:in `specs'\n        from C:/Ruby22-x64/lib/ruby/gems/2.2.0/gems/bundler-1.15.3/lib/bundler/d                                                                                       efinition.rb:218:in `specs_for'\n        from C:/Ruby22-x64/lib/ruby/gems/2.2.0/gems/bundler-1.15.3/lib/bundler/d                                                                                       efinition.rb:207:in `requested_specs'\n        from C:/Ruby22-x64/lib/ruby/gems/2.2.0/gems/bundler-1.15.3/lib/bundler/r                                                                                       untime.rb:109:in `block in definition_method'\n        from C:/Ruby22-x64/lib/ruby/gems/2.2.0/gems/bundler-1.15.3/lib/bundler/r                                                                                       untime.rb:21:in `setup'\n        from C:/Ruby22-x64/lib/ruby/gems/2.2.0/gems/bundler-1.15.3/lib/bundler.r                                                                                       b:101:in `setup'\n        from C:/Ruby22-x64/lib/ruby/gems/2.2.0/gems/bundler-1.15.3/lib/bundler/s                                                                                       etup.rb:19:in `&lt;top (required)&gt;'\n        from C:/Ruby22-x64/lib/ruby/2.2.0/rubygems/core_ext/kernel_require.rb:54                                                                                       :in `require'\n        from C:/Ruby22-x64/lib/ruby/2.2.0/rubygems/core_ext/kernel_require.rb:54                                                                                       :in `require'\n</code></pre>\n\n<p>How can I solve it?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "api", "bigcommerce"], "comments": [{"owner": {"reputation": 1528, "user_id": 7573791, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0e5e5cf864fb33229ca56750a51d6674?s=128&d=identicon&r=PG&f=1", "display_name": "Sajin", "link": "https://stackoverflow.com/users/7573791/sajin"}, "edited": false, "score": 0, "creation_date": 1500984289, "post_id": 45301342, "comment_id": 77566796, "body": "did you try null? or try giving a space as value"}, {"owner": {"reputation": 23, "user_id": 8103723, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/5a9760e298c9e35707dff84229cbb8fa?s=128&d=identicon&r=PG&f=1", "display_name": "Ankur M", "link": "https://stackoverflow.com/users/8103723/ankur-m"}, "reply_to_user": {"reputation": 1528, "user_id": 7573791, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0e5e5cf864fb33229ca56750a51d6674?s=128&d=identicon&r=PG&f=1", "display_name": "Sajin", "link": "https://stackoverflow.com/users/7573791/sajin"}, "edited": false, "score": 0, "creation_date": 1500985182, "post_id": 45301342, "comment_id": 77567559, "body": "passing Null is returning error &quot;label must be a string&quot;. And giving a space as value is working but that is not correct way as it is creating &quot; &quot; as a product option."}], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 8103723, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/5a9760e298c9e35707dff84229cbb8fa?s=128&d=identicon&r=PG&f=1", "display_name": "Ankur M", "link": "https://stackoverflow.com/users/8103723/ankur-m"}, "edited": false, "score": 0, "creation_date": 1501080115, "post_id": 45315001, "comment_id": 77622096, "body": "How we will associate pricing with modifiers?"}, {"owner": {"reputation": 26, "user_id": 8366291, "user_type": "registered", "profile_image": "https://graph.facebook.com/10159229200545245/picture?type=large", "display_name": "Sandeep Ganapatiraju", "link": "https://stackoverflow.com/users/8366291/sandeep-ganapatiraju"}, "reply_to_user": {"reputation": 23, "user_id": 8103723, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/5a9760e298c9e35707dff84229cbb8fa?s=128&d=identicon&r=PG&f=1", "display_name": "Ankur M", "link": "https://stackoverflow.com/users/8103723/ankur-m"}, "edited": false, "score": 0, "creation_date": 1502172395, "post_id": 45315001, "comment_id": 78080182, "body": "you can created adjusters on individual modifiers values which can adjust price,weight, image and purchasing disabled"}], "tags": [], "owner": {"reputation": 26, "user_id": 8366291, "user_type": "registered", "profile_image": "https://graph.facebook.com/10159229200545245/picture?type=large", "display_name": "Sandeep Ganapatiraju", "link": "https://stackoverflow.com/users/8366291/sandeep-ganapatiraju"}, "is_accepted": true, "score": 1, "last_activity_date": 1501025129, "creation_date": 1501025129, "answer_id": 45315001, "question_id": 45301342, "link": "https://stackoverflow.com/questions/45301342/create-variants-of-products-with-null-option-value-label-using-bigcommerce-v3-ap/45315001#45315001", "title": "Create variants of products with null option_value label using BigCommerce v3 API", "body": "<p>In this case seems like you want <code>Self Life</code> and be <code>Dot Info</code> as non required modifiers instead rather than as options</p>\n\n<p>Basically you will create 2 variants each having option values as shown below on above endpoint</p>\n\n<pre><code>\"variants\": [\n{\n   ...\n    \"option_values\": [\n    {\n      \"option_display_name\": \"Size\",\n      \"label\": \"1L Glass Amber\",\n    }\n  ]\n}\n{\n    ...\n    \"option_values\": [\n    {\n      \"option_display_name\": \"Size\",\n      \"label\": \"500ml Glass Amber\",\n    }\n  ]\n}\n</code></pre>\n\n<p>and then create 2 modifiers (one with <code>display_name</code>: <code>Self Life</code> other with <code>display_name</code>:  <code>Dot Info</code>) by posting twice on v3/catalog/products//modifiers</p>\n"}], "owner": {"reputation": 23, "user_id": 8103723, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/5a9760e298c9e35707dff84229cbb8fa?s=128&d=identicon&r=PG&f=1", "display_name": "Ankur M", "link": "https://stackoverflow.com/users/8103723/ankur-m"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 130, "favorite_count": 0, "accepted_answer_id": 45315001, "answer_count": 1, "score": 0, "last_activity_date": 1501025129, "creation_date": 1500980421, "question_id": 45301342, "link": "https://stackoverflow.com/questions/45301342/create-variants-of-products-with-null-option-value-label-using-bigcommerce-v3-ap", "title": "Create variants of products with null option_value label using BigCommerce v3 API", "body": "<p>I am using Bigcommerce v3 API to create products on bigcommerce store. I have a product with two variants having following options</p>\n\n<pre><code>Size                 Self Life      Dot info\n1L Glass Amber       \n500ml Glass Amber    12           Methanol Sol.\n</code></pre>\n\n<p>When I am trying to create product like this </p>\n\n<pre><code>{\n  \"name\": \"Product name\",\n  \"type\": \"physical\",\n  \"sku\": \"CDID-12345\",\n  \"description\": \"Description\",\n  \"weight\": 0,\n  \"width\": 0,\n  \"depth\": 0,\n  \"height\": 0,\n  \"price\": 0,\n  \"cost_price\": 0,\n  \"retail_price\": 0,\n  \"sale_price\": 0,\n  \"categories\": [1],\n  \"variants\": [\n    {\n      \"cost_price\": 0,\n      \"price\": 0,\n      \"weight\": 0,\n      \"sku\": \"MP091236\",\n      \"option_values\": [\n        {\n          \"option_display_name\": \"Size\",\n          \"label\": \"1L Glass Amber\",\n        }\n      ]\n    },\n    {\n      \"cost_price\": 0,\n      \"price\": 0,\n      \"weight\": 0,\n      \"sku\": \"MP091239\",\n      \"option_values\": [\n        {\n          \"option_display_name\": \"Size\",\n          \"label\": \"500ml Glass Amber\",\n        },\n        {\n          \"option_display_name\": \"Self Life\",\n          \"label\": \"12\",\n        },\n        {\n          \"option_display_name\": \"Dot Info\",\n          \"label\": \"Methanol Sol.\",\n        }\n      ]\n    }\n  ]\n}\n</code></pre>\n\n<p>then I am getting error:</p>\n\n<pre><code>Variants must have the the same list option display names.\n</code></pre>\n\n<p>And when I am passing parameters like this:</p>\n\n<pre><code>{\n  \"name\": \"Product name\",\n  \"type\": \"physical\",\n  \"sku\": \"CDID-12345\",\n  \"description\": \"Description\",\n  \"weight\": 0,\n  \"width\": 0,\n  \"depth\": 0,\n  \"height\": 0,\n  \"price\": 0,\n  \"cost_price\": 0,\n  \"retail_price\": 0,\n  \"sale_price\": 0,\n  \"categories\": [1],\n  \"variants\": [\n    {\n      \"cost_price\": 0,\n      \"price\": 0,\n      \"weight\": 0,\n      \"sku\": \"MP091236\",\n      \"option_values\": [\n        {\n          \"option_display_name\": \"Size\",\n          \"label\": \"1L Glass Amber\",\n        },\n        {\n          \"option_display_name\": \"Self Life\",\n          \"label\": \"\",\n        },\n        {\n          \"option_display_name\": \"Dot Info\",\n          \"label\": \"\",\n        }\n      ]\n    },\n    {\n      \"cost_price\": 0,\n      \"price\": 0,\n      \"weight\": 0,\n      \"sku\": \"MP091239\",\n      \"option_values\": [\n        {\n          \"option_display_name\": \"Size\",\n          \"label\": \"500ml Glass Amber\",\n        },\n        {\n          \"option_display_name\": \"Self Life\",\n          \"label\": \"12\",\n        },\n        {\n          \"option_display_name\": \"Dot Info\",\n          \"label\": \"Methanol Sol.\",\n        }\n      ]\n    }\n  ]\n}\n</code></pre>\n\n<p>then I am getting error like this:</p>\n\n<pre><code>\"variants.0.option_values.1.label\": \"label must be a string\"\n</code></pre>\n\n<p>How can I create two SKUs of this product where one will have options Size                 , Self Life and Dot info and other having Size as only option. </p>\n"}, {"tags": ["java", "ruby", "macos", "hadoop", "hbase"], "comments": [{"owner": {"reputation": 27069, "user_id": 2307070, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/l8ha6.jpg?s=128&g=1", "display_name": "Thomas Ayoub", "link": "https://stackoverflow.com/users/2307070/thomas-ayoub"}, "edited": false, "score": 0, "creation_date": 1501253009, "post_id": 45301184, "comment_id": 77714133, "body": "what&#39;s your ruby version? What&#39;s the output of <code>brew doctor</code>?"}, {"owner": {"reputation": 58061, "user_id": 1610034, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/x77Vf.jpg?s=128&g=1", "display_name": "Saurabh", "link": "https://stackoverflow.com/users/1610034/saurabh"}, "reply_to_user": {"reputation": 27069, "user_id": 2307070, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/l8ha6.jpg?s=128&g=1", "display_name": "Thomas Ayoub", "link": "https://stackoverflow.com/users/2307070/thomas-ayoub"}, "edited": false, "score": 0, "creation_date": 1501260340, "post_id": 45301184, "comment_id": 77718648, "body": "@ThomasAyoub Updated in the question."}, {"owner": {"reputation": 2623, "user_id": 625354, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/xc5hf.jpg?s=128&g=1", "display_name": "Dbz", "link": "https://stackoverflow.com/users/625354/dbz"}, "edited": false, "score": 0, "creation_date": 1501543514, "post_id": 45301184, "comment_id": 77814738, "body": "Have you installed developer tools? What happens when you open Xcode? I also think upgrading xcode and reinstalling developer tools may help"}, {"owner": {"reputation": 58061, "user_id": 1610034, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/x77Vf.jpg?s=128&g=1", "display_name": "Saurabh", "link": "https://stackoverflow.com/users/1610034/saurabh"}, "reply_to_user": {"reputation": 2623, "user_id": 625354, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/xc5hf.jpg?s=128&g=1", "display_name": "Dbz", "link": "https://stackoverflow.com/users/625354/dbz"}, "edited": false, "score": 0, "creation_date": 1501582827, "post_id": 45301184, "comment_id": 77831044, "body": "@Dbz XCode:  7.3.1 (7D1014) is installed and it opens normally. Haven&#39;t tried reinstalling developer tools, but those are earlier installed. Also see my latest edit in the question."}, {"owner": {"reputation": 4212, "user_id": 463225, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/99b324795ebf7264b7b2b854fdba6520?s=128&d=identicon&r=PG", "display_name": "WattsInABox", "link": "https://stackoverflow.com/users/463225/wattsinabox"}, "edited": false, "score": 0, "creation_date": 1501597593, "post_id": 45301184, "comment_id": 77842292, "body": "On OSX <code>10.12</code>, I was able to <code>brew install hbase</code>, made sure the links were set up with <code>brew link --overwrite hbase</code> and with no other changes, I was able to boot <code>hbase shell</code>. Java is <code>Java(TM) SE Runtime Environment (build 1.7.0_79-b15)</code>. I did not set <code>HBASE_HOME</code> and I did not edit the path."}, {"owner": {"reputation": 6462, "user_id": 3784008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/55ou4.jpg?s=128&g=1", "display_name": "anothermh", "link": "https://stackoverflow.com/users/3784008/anothermh"}, "edited": false, "score": 0, "creation_date": 1501614742, "post_id": 45301184, "comment_id": 77852784, "body": "If hbase comes with jruby, then I&#39;m going to guess that it requires jruby and will not work with your rvm-installed version of Ruby. This makes even more sense that it works as root -- if you run something as root, it won&#39;t know anything about your rvm installation or your installed rubies."}, {"owner": {"reputation": 4212, "user_id": 463225, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/99b324795ebf7264b7b2b854fdba6520?s=128&d=identicon&r=PG", "display_name": "WattsInABox", "link": "https://stackoverflow.com/users/463225/wattsinabox"}, "reply_to_user": {"reputation": 6462, "user_id": 3784008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/55ou4.jpg?s=128&g=1", "display_name": "anothermh", "link": "https://stackoverflow.com/users/3784008/anothermh"}, "edited": false, "score": 0, "creation_date": 1501770069, "post_id": 45301184, "comment_id": 77934832, "body": "I have RVM installed on my machine, my default ruby is not jruby, and hbase shell works fine so I don&#39;t think that&#39;s it, @anothermh"}], "answers": [{"tags": [], "owner": {"reputation": 9545, "user_id": 5295429, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XcJZr.png?s=128&g=1", "display_name": "Oo.oO", "link": "https://stackoverflow.com/users/5295429/oo-oo"}, "is_accepted": false, "score": 1, "last_activity_date": 1501671352, "creation_date": 1501671352, "answer_id": 45458899, "question_id": 45301184, "link": "https://stackoverflow.com/questions/45301184/running-hbase-shell-giving-error-in-osx/45458899#45458899", "title": "Running &quot;hbase shell&quot; giving error in OSX", "body": "<p>Have you tried using Oracle's JDK and installation from Apache page?</p>\n\n<p><a href=\"http://ftp.ps.pl/pub/apache/hbase/1.3.1/hbase-1.3.1-bin.tar.gz\" rel=\"nofollow noreferrer\">http://ftp.ps.pl/pub/apache/hbase/1.3.1/hbase-1.3.1-bin.tar.gz</a></p>\n\n<p>It works perfectly fine in my case</p>\n\n<pre><code>&gt; ./start-hbase.sh\nstarting master, logging to $HOME/..../hbase-1.3.1/bin/../logs/hbase-michalo-master-pi.local.out\nJava HotSpot(TM) 64-Bit Server VM warning: ignoring option PermSize=128m; support was removed in 8.0\nJava HotSpot(TM) 64-Bit Server VM warning: ignoring option MaxPermSize=128m; support was removed in 8.0\n</code></pre>\n\n<p>And, in another shell</p>\n\n<pre><code>&gt; ./hbase shell\nWARN  [main] util.NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable\nHBase Shell; enter 'help&lt;RETURN&gt;' for list of supported commands.\nType \"exit&lt;RETURN&gt;\" to leave the HBase Shell\nVersion 1.3.1, r930b9a55528fe45d8edce7af42fef2d35e77677a, Thu Apr  6 19:36:54 PDT 2017\n\nhbase(main):001:0&gt;\n</code></pre>\n"}], "owner": {"reputation": 58061, "user_id": 1610034, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/x77Vf.jpg?s=128&g=1", "display_name": "Saurabh", "link": "https://stackoverflow.com/users/1610034/saurabh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 730, "favorite_count": 2, "answer_count": 1, "score": 11, "last_activity_date": 1501671352, "creation_date": 1500979946, "last_edit_date": 1592644375, "question_id": 45301184, "link": "https://stackoverflow.com/questions/45301184/running-hbase-shell-giving-error-in-osx", "title": "Running &quot;hbase shell&quot; giving error in OSX", "body": "<p>Getting following error when trying to run <code>hbase shell</code> in OSX(version: 10.11.4):</p>\n<blockquote>\n<p>warning: -J-Dfile.encoding=UTF-8 argument ignored (launched in same VM?)</p>\n<p>warning: -J-XX:MaxPermSize=1024m argument ignored (launched in same VM?)</p>\n<p>warning: -J-Xmx4096m argument ignored (launched in same VM?)</p>\n<p>TypeError: can't convert Pathname into String   require at org/jruby/RubyKernel.java:1071</p>\n<p>require at file:/usr/local/Cellar/hbase/1.2.6/libexec/lib/jruby-complete-1.6.8.jar!/META INF/jruby.home/lib/ruby/site_ruby/1.8/rubygems/custom_require.rb:36</p>\n<p>(root) at /usr/local/Cellar/hbase/1.2.6/libexec/bin/hirb.rb:118</p>\n</blockquote>\n<p>I installed the Hbase with brew by : <code>brew install hbase</code></p>\n<p>As given in the solution <a href=\"https://stackoverflow.com/a/23822014/1610034\">here</a>, I also trying set PATH variables like following:</p>\n<pre><code>\u279c  ~ export HBASE_HOME=/usr/local/Cellar/hbase/1.2.6/libexec\n\u279c  ~ export PATH=$HBASE_HOME/bin:$PATH\n</code></pre>\n<p>I also have <code>jruby-complete-1.6.8.jar</code> in <code>$HBASE_HOME/lib</code>, as stated <a href=\"https://stackoverflow.com/a/26602300/1610034\">here</a>. But still the same error continues.</p>\n<h2>Edit 1</h2>\n<pre><code>\u279c rvm list:\n\nrvm rubies\n\n   ruby-2.1.2 [ x86_64 ]\n   ruby-2.2.0 [ x86_64 ]\n=* ruby-2.2.2 [ x86_64 ]\n\n# =&gt; - current\n# =* - current &amp;&amp; default\n#  * - default\n\n\n\u279c  ruby -v\nruby 2.0.0p648 (2015-12-16 revision 53162) [universal.x86_64-darwin15]\n\n\n\u279c  which ruby\n/usr/bin/ruby\n</code></pre>\n<p>Guessing that something is wrong in rvm, I uninstalled it via: <code>rvm remove</code> and <code>rvm uninstall</code>. But still the error persists.</p>\n<h2>Edit 2</h2>\n<pre><code>\u279c  brew doctor\nPlease note that these warnings are just used to help the Homebrew maintainers\nwith debugging if you file an issue. If everything you use Homebrew for is\nworking fine: please don't worry and just ignore them. Thanks!\n\nWarning: You have unlinked kegs in your Cellar\nLeaving kegs unlinked can lead to build-trouble and cause brews that depend on\nthose kegs to fail to run properly once built. Run `brew link` on these:\n  mongodb@2.6\n\nWarning: Your Xcode (7.3.1) is outdated.\nPlease update to Xcode 8.2.1 (or delete it).\nXcode can be updated from the App Store.\n\n\nWarning: Some installed formula are missing dependencies.\nYou should `brew install` the missing dependencies:\n  brew install erlang@19\n\nRun `brew missing` for more details.\n\n\u279c  brew missing\nrabbitmq: erlang@19\n</code></pre>\n<h2>Edit 3</h2>\n<p>What I figured out is I am able to run HBASE as a root user, so if I do following:</p>\n<pre><code>&gt; Sudo su\nroot&gt; export JAVA_HOME=/Library/Java/JavaVirtualMachines/jdk1.8.0_131.jdk/Contents/Home\nroot&gt; hbase shell\n       ......It works......\n</code></pre>\n<p>So it seems, it is some permission issue, due to which not able to run normally.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "forms", "model", "error-messaging"], "comments": [{"owner": {"reputation": 32131, "user_id": 2346461, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/i3xAf.jpg?s=128&g=1", "display_name": "Pavan", "link": "https://stackoverflow.com/users/2346461/pavan"}, "edited": false, "score": 2, "creation_date": 1500978685, "post_id": 45300502, "comment_id": 77562643, "body": "Try changing <code>redirect_to &#39;&#47;signup&#39;</code> to <code>render &#39;new&#39;</code>"}, {"owner": {"reputation": 253, "user_id": 8080946, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/33ed775ce8607b3e2acec738c7ceab8a?s=128&d=identicon&r=PG&f=1", "display_name": "Cory L", "link": "https://stackoverflow.com/users/8080946/cory-l"}, "reply_to_user": {"reputation": 32131, "user_id": 2346461, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/i3xAf.jpg?s=128&g=1", "display_name": "Pavan", "link": "https://stackoverflow.com/users/2346461/pavan"}, "edited": false, "score": 1, "creation_date": 1500996025, "post_id": 45300502, "comment_id": 77576721, "body": "Thank you @Pavan that worked! Are you able to explain the difference between the two statements?"}, {"owner": {"reputation": 32131, "user_id": 2346461, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/i3xAf.jpg?s=128&g=1", "display_name": "Pavan", "link": "https://stackoverflow.com/users/2346461/pavan"}, "edited": false, "score": 0, "creation_date": 1500996795, "post_id": 45300502, "comment_id": 77577355, "body": "I&#39;ve added my answer and explained the difference. Hope you find it helpful :)"}], "answers": [{"comments": [{"owner": {"reputation": 253, "user_id": 8080946, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/33ed775ce8607b3e2acec738c7ceab8a?s=128&d=identicon&r=PG&f=1", "display_name": "Cory L", "link": "https://stackoverflow.com/users/8080946/cory-l"}, "edited": false, "score": 1, "creation_date": 1500996918, "post_id": 45307740, "comment_id": 77577433, "body": "Thanks @Pavan! :)"}], "tags": [], "owner": {"reputation": 32131, "user_id": 2346461, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/i3xAf.jpg?s=128&g=1", "display_name": "Pavan", "link": "https://stackoverflow.com/users/2346461/pavan"}, "is_accepted": true, "score": 1, "last_activity_date": 1500996924, "last_edit_date": 1500996924, "creation_date": 1500996748, "answer_id": 45307740, "question_id": 45300502, "link": "https://stackoverflow.com/questions/45300502/form-error-messages-not-generating-in-rails-app/45307740#45307740", "title": "Form Error Messages Not Generating in Rails App", "body": "<p>As I said, you need to change </p>\n\n<pre><code>redirect_to '/signup' \n</code></pre>\n\n<p>to </p>\n\n<pre><code>render 'new'\n</code></pre>\n\n<p>From the <a href=\"http://guides.rubyonrails.org/getting_started.html#adding-some-validation\" rel=\"nofollow noreferrer\"><em>Guides</em></a></p>\n\n<blockquote>\n  <p>The <code>render</code> method is used so that the <code>@user</code> object is passed back\n  to the <code>new</code> template when it is rendered. This rendering is done within\n  the same request as the form submission, whereas the <code>redirect_to</code> will\n  tell the browser to issue another request.</p>\n</blockquote>\n\n<p>That said, so as the <code>redirect_to</code> issues a <strong>new request</strong> to the browser, the values of <code>@user</code> is lost, in other words <code>@user</code> is a new instance that is instantiated again. That is why <code>&lt;% if @user.errors.any? %&gt;</code> <strong>always</strong> returns <code>false</code> as if there are no errors in <code>@user</code>.</p>\n"}], "owner": {"reputation": 253, "user_id": 8080946, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/33ed775ce8607b3e2acec738c7ceab8a?s=128&d=identicon&r=PG&f=1", "display_name": "Cory L", "link": "https://stackoverflow.com/users/8080946/cory-l"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 51, "favorite_count": 0, "accepted_answer_id": 45307740, "answer_count": 1, "score": 1, "last_activity_date": 1500996924, "creation_date": 1500978226, "question_id": 45300502, "link": "https://stackoverflow.com/questions/45300502/form-error-messages-not-generating-in-rails-app", "title": "Form Error Messages Not Generating in Rails App", "body": "<p>Hi I have a simple app that I am building and am having trouble getting the error messages to appear when someone inputs invalid information or no information at all into a field.</p>\n\n<p>The form I am using is to sign up a new user, the code associated with the user and form are below;</p>\n\n<p><strong>users_controller.rb</strong></p>\n\n<pre><code>Class UsersController &lt; ApplicationController\n\n\n  def index\n    @users = User.all\n  end\n\n  def show\n    @user = User.find(params[:id])\n    @country = Country.all\n  end\n\n  def new\n    @user = User.new\n  end\n\n  def create\n    @user = User.new(user_params)\n    if @user.save\n      session[:user_id] = @user.id\n      redirect_to @user\n    else\n      redirect_to '/signup'\n    end\n  end\n\n\n  private \n\n    def user_params\n        params.require(:user).permit(:first_name, :last_name, :email, :password)\n    end\n\n\nend\n</code></pre>\n\n<p><strong>user.rb</strong></p>\n\n<pre><code>class User &lt; ApplicationRecord\n\n  before_save { self.email = email.downcase }\n  validates :first_name, presence: true, length: { maximum: 25 }\n  validates :first_name, presence: true, length: { maximum: 50 }\n  VALID_EMAIL_REGEX = /\\A[\\w+\\-.]+@[a-z\\d\\-]+(\\.[a-z\\d\\-]+)*\\.[a-z]+\\z/i\n  validates :email, presence: true, length: { maximum: 255 }, format: { with: VALID_EMAIL_REGEX }\n  has_secure_password\n  validates :password, presence: true, length: { minimum: 6 }\n\n  has_many :trips\n  has_many :countries, through: :trips\n\nend\n</code></pre>\n\n<p><strong>new.html.erb</strong></p>\n\n<pre><code>&lt;div class=\"container\"&gt;\n  &lt;h1 class=\"text-center\"&gt;Sign up&lt;/h1&gt;\n  &lt;div class=\"row\"&gt;\n    &lt;div class=\"col-md-6 offset-md-3 \"&gt;\n      &lt;%=form_for(@user) do |f| %&gt;\n        &lt;%= render 'shared/error_messages' %&gt;\n\n        &lt;%= f.label :first_name %&gt;\n        &lt;%= f.text_field :first_name, class: \"form-control\" %&gt;\n\n        &lt;%= f.label :last_name %&gt;\n        &lt;%= f.text_field :last_name, class: \"form-control\" %&gt;\n\n        &lt;%= f.label :email %&gt;\n        &lt;%= f.email_field :email, class: \"form-control\" %&gt;\n\n        &lt;%= f.label :password %&gt;\n        &lt;%= f.password_field :password, class: \"form-control\" %&gt;\n\n        &lt;%= f.submit \"Create an account\", class: 'form-control btn btn-primary' %&gt;\n      &lt;% end %&gt; \n    &lt;/div&gt;\n  &lt;/div&gt;\n&lt;/div&gt;\n</code></pre>\n\n<p><strong>_error_messages.html.erb</strong></p>\n\n<pre><code>&lt;% if @user.errors.any? %&gt;\n  &lt;div class=\"alert alert-danger\"&gt;\n    The form contains &lt;%= pluralize(@user.errors.count, \"error\") %&gt;.\n  &lt;/div&gt;\n  &lt;ul&gt;\n  &lt;% @user.errors.full_messages.each do |msg| %&gt;\n    &lt;li&gt;&lt;%= msg %&gt;&lt;/li&gt;\n  &lt;% end %&gt;\n  &lt;/ul&gt;\n&lt;% else %&gt;\n  &lt;h3&gt;test&lt;/h3&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>When I load the form I do see the \"Test\" string, which I put in my _error_messages.html.erb for visibility. However when I enter data in the signup page, it reloads the page (as it should rather than sending it to the user page when all fields are valid). However, the \"Test\" string still appears at the top rather than the error messages that should. </p>\n\n<p>My assumption is I need some sort of session or something to remember what the errors were, as right now it reloads a completely new page with nothing in memory, however, I cannot find the solution to this anywhere at the moment.</p>\n\n<p>Any help would be much appreciated! </p>\n"}]