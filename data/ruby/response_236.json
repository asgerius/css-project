[{"tags": ["ruby", "ruby-on-rails-5", "typeerror"], "comments": [{"owner": {"reputation": 2007, "user_id": 716039, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/76b302eed6a8add5db6b3f2e1c7c9942?s=128&d=identicon&r=PG", "display_name": "dinjas", "link": "https://stackoverflow.com/users/716039/dinjas"}, "edited": false, "score": 2, "creation_date": 1563407481, "post_id": 57085044, "comment_id": 100693687, "body": "Am guessing your <code>@user</code> doesn&#39;t have a referral code. You&#39;ll get the same error if you do <code>CGI::escape(nil)</code>."}, {"owner": {"reputation": 167912, "user_id": 240443, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/495d675e3bc42ed1dee469e2ce701f1b?s=128&d=identicon&r=PG", "display_name": "Amadan", "link": "https://stackoverflow.com/users/240443/amadan"}, "edited": false, "score": 0, "creation_date": 1563425672, "post_id": 57085044, "comment_id": 100697106, "body": "<code>CGI::escape(stuff_that_can_be_nil || &#39;&#39;)</code> if you just want to ignore it, or surround the link with <code>&lt;% if stuff_that_can_be_nil %&gt;</code> if you want to hide or replace the link in case <code>stuff_that_can_be_nil</code> is <code>nil</code>."}, {"owner": {"reputation": 143, "user_id": 5736112, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/4a4992e47e824469a2096ccc288f0b2a?s=128&d=identicon&r=PG&f=1", "display_name": "MaxRah", "link": "https://stackoverflow.com/users/5736112/maxrah"}, "reply_to_user": {"reputation": 2007, "user_id": 716039, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/76b302eed6a8add5db6b3f2e1c7c9942?s=128&d=identicon&r=PG", "display_name": "dinjas", "link": "https://stackoverflow.com/users/716039/dinjas"}, "edited": false, "score": 1, "creation_date": 1563440070, "post_id": 57085044, "comment_id": 100703248, "body": "You&#39;re correct @dinjas. the referral code was missing. Thanks"}], "owner": {"reputation": 143, "user_id": 5736112, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/4a4992e47e824469a2096ccc288f0b2a?s=128&d=identicon&r=PG&f=1", "display_name": "MaxRah", "link": "https://stackoverflow.com/users/5736112/maxrah"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 206, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1563404746, "creation_date": 1563404746, "question_id": 57085044, "link": "https://stackoverflow.com/questions/57085044/typeerror-no-implicit-conversion-of-nil-into-string", "title": "TypeError no implicit conversion of nil into String", "body": "<p>I'm trying to add social sharing to a Rails project, but I keep getting this <code>no implicit conversion of nil into String</code> on both lines below:</p>\n\n<pre><code>&lt;a href=\"http://www.facebook.com/sharer/sharer.php?u=&lt;%= CGI::escape(root_url) %&gt;?ref=&lt;%= CGI::escape(@user.referral_code) %&gt;&amp;title=wdyw\" class=\"fb\" target=\"_blank\"&gt;&lt;/a&gt;\n\n&lt;a href=\"http://twitter.com/share?url=&lt;%= CGI::escape(root_url) %&gt;?ref=&lt;%= CGI::escape(@user.referral_code) %&gt;&amp;text=&lt;%= CGI::escape(twitter_message) %&gt;\" class=\"twit\" target=\"_blank\"&gt;&lt;/a&gt;\n\n</code></pre>\n\n<p>I'm on ruby version 2.6. Not sure what the error is.</p>\n"}, {"tags": ["ruby", "ruby-on-rails-4", "rspec-rails", "webrick", "rails-4-upgrade"], "answers": [{"comments": [{"owner": {"reputation": 1586, "user_id": 1257980, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/20ml2.png?s=128&g=1", "display_name": "Eric Wanchic", "link": "https://stackoverflow.com/users/1257980/eric-wanchic"}, "reply_to_user": {"reputation": 6462, "user_id": 3784008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/55ou4.jpg?s=128&g=1", "display_name": "anothermh", "link": "https://stackoverflow.com/users/3784008/anothermh"}, "edited": false, "score": 0, "creation_date": 1563508232, "post_id": 57084845, "comment_id": 100730918, "body": "I didn&#39;t think it was right to do that, but ok I will. Thanks!"}], "tags": [], "owner": {"reputation": 1586, "user_id": 1257980, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/20ml2.png?s=128&g=1", "display_name": "Eric Wanchic", "link": "https://stackoverflow.com/users/1257980/eric-wanchic"}, "is_accepted": true, "score": 1, "last_activity_date": 1563403115, "creation_date": 1563403115, "answer_id": 57084845, "question_id": 57084844, "link": "https://stackoverflow.com/questions/57084844/problems-upgrading-rails-4-0-0-to-4-0-x-4-0-13-private-method-include-call/57084845#57084845", "title": "Problems upgrading Rails 4.0.0 to 4.0.x (4.0.13) - private method `include&#39; called for ActionDispatch::Assertions:Module (NoMethodError)", "body": "<p>I found a solution via another issue from <a href=\"https://github.com/benedikt/layer-ruby/issues/7\" rel=\"nofollow noreferrer\">layer-ruby</a>: <a href=\"https://github.com/benedikt/layer-ruby/issues/7#issuecomment-136739841\" rel=\"nofollow noreferrer\">NoMethodError: private method `include' called for #-Class:#-Layer::RelationProxy:0x007fd1f67016e0--</a></p>\n\n<p><a href=\"https://github.com/geoffreymm\" rel=\"nofollow noreferrer\">geoffreymm</a> discovered that install Ruby 2.2.0 Fixed the issue.</p>\n\n<p>I installed Ruby 2.2.5, and it did indeed solve the issue for me.</p>\n"}], "owner": {"reputation": 1586, "user_id": 1257980, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/20ml2.png?s=128&g=1", "display_name": "Eric Wanchic", "link": "https://stackoverflow.com/users/1257980/eric-wanchic"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 467, "favorite_count": 0, "accepted_answer_id": 57084845, "answer_count": 1, "score": 1, "last_activity_date": 1563403115, "creation_date": 1563403115, "question_id": 57084844, "link": "https://stackoverflow.com/questions/57084844/problems-upgrading-rails-4-0-0-to-4-0-x-4-0-13-private-method-include-call", "title": "Problems upgrading Rails 4.0.0 to 4.0.x (4.0.13) - private method `include&#39; called for ActionDispatch::Assertions:Module (NoMethodError)", "body": "<p>I could not find a \"direct\" answer to this anywhere. Since I know there will be many other \"Late Upgraders\" to the party, I feel I need to get this out.</p>\n\n<p>I had a Rails 4.0.0 app running Ruby 2.0.0-p247. After upgrading to 4.0.13, I ran into this error:</p>\n\n<pre><code>private method `include' called for ActionDispatch::Assertions:Module (NoMethodError)\n</code></pre>\n\n<p>I received this through rspec and WEBrick.</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 126343, "user_id": 14660, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/e55e0ec3c00f834d78fbdddeaa36e308?s=128&d=identicon&r=PG", "display_name": "Schwern", "link": "https://stackoverflow.com/users/14660/schwern"}, "edited": false, "score": 0, "creation_date": 1563402890, "post_id": 57084802, "comment_id": 100692673, "body": "What&#39;s this accomplishing? Are you trying to put all your models into a module?"}, {"owner": {"reputation": 5036, "user_id": 1223595, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/770fb9d9d0c71f2c21de84c60653c230?s=128&d=identicon&r=PG", "display_name": "steventnorris", "link": "https://stackoverflow.com/users/1223595/steventnorris"}, "reply_to_user": {"reputation": 126343, "user_id": 14660, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/e55e0ec3c00f834d78fbdddeaa36e308?s=128&d=identicon&r=PG", "display_name": "Schwern", "link": "https://stackoverflow.com/users/14660/schwern"}, "edited": false, "score": 0, "creation_date": 1563403146, "post_id": 57084802, "comment_id": 100692747, "body": "@Schwern I&#39;m namespacing by nesting things in modules for organization reasons, yes."}], "answers": [{"comments": [{"owner": {"reputation": 5036, "user_id": 1223595, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/770fb9d9d0c71f2c21de84c60653c230?s=128&d=identicon&r=PG", "display_name": "steventnorris", "link": "https://stackoverflow.com/users/1223595/steventnorris"}, "edited": false, "score": 0, "creation_date": 1563413272, "post_id": 57085046, "comment_id": 100694711, "body": "I feel like this may solve my problem. It certainly smells like an autoload issue. My only problem is this initiative is a code migration, and I was fully taking advantage of the non-eager loading and testing things one controller at a time With eager load on, I need to go sure up some code I wasn&#39;t using so it&#39;ll all load at boot. Will report back. Thanks for the detailed breakdown. Autoload is a small bit of a blackbox to me still."}, {"owner": {"reputation": 5036, "user_id": 1223595, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/770fb9d9d0c71f2c21de84c60653c230?s=128&d=identicon&r=PG", "display_name": "steventnorris", "link": "https://stackoverflow.com/users/1223595/steventnorris"}, "edited": false, "score": 0, "creation_date": 1563413759, "post_id": 57085046, "comment_id": 100694793, "body": "This was absolutely the issue. Since the PetData module had not been autoloaded yet, but was being called as PetData::Pet, the autoload lookup was assuming a relative pathing. This is because of the nested folder PetData/Pet inside models, which you have to have due to Rails&#39; need to have the folders match the namespaces, but it does mess up autoload. Eager loading corrected that. I could likely have added some sort of * based path to eager_load_paths as well, but that gets less reliable. May stick with just full eager_load for now."}, {"owner": {"reputation": 3630, "user_id": 4799659, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153200714295120/picture?type=large", "display_name": "fylooi", "link": "https://stackoverflow.com/users/4799659/fylooi"}, "edited": false, "score": 0, "creation_date": 1563426179, "post_id": 57085046, "comment_id": 100697233, "body": "Autoloading in <code>&#47;models</code> and <code>&#47;controllers</code> is pretty much an established standard. Don&#39;t think turning off auto loading is warranted if this is the only issue on the table."}, {"owner": {"reputation": 5036, "user_id": 1223595, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/770fb9d9d0c71f2c21de84c60653c230?s=128&d=identicon&r=PG", "display_name": "steventnorris", "link": "https://stackoverflow.com/users/1223595/steventnorris"}, "edited": false, "score": 0, "creation_date": 1563456298, "post_id": 57085046, "comment_id": 100712455, "body": "I spoke too soon. This worked, for a bit, then it didn&#39;t. And now it seems to be intermittently a problem. Like the third or fourth time, it fails with the same error."}, {"owner": {"reputation": 5036, "user_id": 1223595, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/770fb9d9d0c71f2c21de84c60653c230?s=128&d=identicon&r=PG", "display_name": "steventnorris", "link": "https://stackoverflow.com/users/1223595/steventnorris"}, "reply_to_user": {"reputation": 3630, "user_id": 4799659, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153200714295120/picture?type=large", "display_name": "fylooi", "link": "https://stackoverflow.com/users/4799659/fylooi"}, "edited": false, "score": 0, "creation_date": 1563462932, "post_id": 57085046, "comment_id": 100716743, "body": "I have added more detail from testing if either you or @fylooi are able to give any more insight. This one is driving me up a wall."}, {"owner": {"reputation": 126343, "user_id": 14660, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/e55e0ec3c00f834d78fbdddeaa36e308?s=128&d=identicon&r=PG", "display_name": "Schwern", "link": "https://stackoverflow.com/users/14660/schwern"}, "reply_to_user": {"reputation": 5036, "user_id": 1223595, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/770fb9d9d0c71f2c21de84c60653c230?s=128&d=identicon&r=PG", "display_name": "steventnorris", "link": "https://stackoverflow.com/users/1223595/steventnorris"}, "edited": false, "score": 0, "creation_date": 1563486513, "post_id": 57085046, "comment_id": 100727074, "body": "@steventnorris Hmm. Does it happen without Spring?"}, {"owner": {"reputation": 5036, "user_id": 1223595, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/770fb9d9d0c71f2c21de84c60653c230?s=128&d=identicon&r=PG", "display_name": "steventnorris", "link": "https://stackoverflow.com/users/1223595/steventnorris"}, "edited": false, "score": 0, "creation_date": 1563487116, "post_id": 57085046, "comment_id": 100727263, "body": "It does. I tried restart Spring, then just removed it entirely and get the same problem."}], "tags": [], "owner": {"reputation": 126343, "user_id": 14660, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/e55e0ec3c00f834d78fbdddeaa36e308?s=128&d=identicon&r=PG", "display_name": "Schwern", "link": "https://stackoverflow.com/users/14660/schwern"}, "is_accepted": false, "score": 2, "last_activity_date": 1563404768, "creation_date": 1563404768, "answer_id": 57085046, "question_id": 57084802, "link": "https://stackoverflow.com/questions/57084802/accessibility-issue-for-model/57085046#57085046", "title": "Accessibility Issue for Model", "body": "<p><a href=\"https://guides.rubyonrails.org/autoloading_and_reloading_constants.html\" rel=\"nofollow noreferrer\">Resolving constants is complicated</a>. Autoloading makes it more complicated. The particular case you cite is <a href=\"https://guides.rubyonrails.org/autoloading_and_reloading_constants.html#autoloading-algorithms-qualified-references\" rel=\"nofollow noreferrer\">very complicated</a>. Getting your models to work inside modules makes it even more complicated.</p>\n\n<p>You could mess around with <code>config.autoload_paths</code>, however...</p>\n\n<blockquote>\n  <p>But using <code>autoload_paths</code> on its own in the past (pre-rails 5) developers might configure <code>autoload_paths</code> to add in extra locations (e.g. lib which used to be an autoload path list years ago, but no longer is). However this is now discouraged for most purposes, as it is likely to lead to production-only errors. It is possible to add new locations to both <code>config.eager_load_paths</code> and <code>config.autoload_paths</code> but use at your own risk.</p>\n</blockquote>\n\n<hr>\n\n<p>What I recommend is turning autoload off entirely and use eager loading in all environments. This avoids much of the complexity of autoloading (eager loading will sometimes autoload), and it brings your dev and test environments closer to production avoiding certain types of release bugs.</p>\n\n<p>Turn on eager loading in <code>config/application.rb</code> and remove autoloading from your environment configs.</p>\n\n<pre><code>config.eager_load = true\n</code></pre>\n\n<p>Rails 5 will load everything in <code>app/</code> or <code>app/*/concerns/</code>, it does not look deeper. See <code>bin/rails r 'puts ActiveSupport::Dependencies.autoload_paths'</code>. You <em>might</em> have to tell it to look for your nested models (I'm writing this answer from memory).</p>\n\n<pre><code>config.eager_load_paths += %W(#{config.root}/app/models/pet_data)\n</code></pre>\n\n<p>If eager loading in development is slow, use a gem such as <a href=\"https://github.com/Shopify/bootsnap\" rel=\"nofollow noreferrer\">bootsnap</a> to make loading the application faster. If that's not fast enough, try <a href=\"https://github.com/rails/spring\" rel=\"nofollow noreferrer\">spring</a> as well, but note it has some caveats.</p>\n"}, {"comments": [{"owner": {"reputation": 5036, "user_id": 1223595, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/770fb9d9d0c71f2c21de84c60653c230?s=128&d=identicon&r=PG", "display_name": "steventnorris", "link": "https://stackoverflow.com/users/1223595/steventnorris"}, "edited": false, "score": 0, "creation_date": 1563456340, "post_id": 57087271, "comment_id": 100712482, "body": "Well, yes, but this shouldn&#39;t be necessary. I&#39;d like to determine how to solve this so that it works properly by loading the models as it should."}, {"owner": {"reputation": 5036, "user_id": 1223595, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/770fb9d9d0c71f2c21de84c60653c230?s=128&d=identicon&r=PG", "display_name": "steventnorris", "link": "https://stackoverflow.com/users/1223595/steventnorris"}, "edited": false, "score": 0, "creation_date": 1563461252, "post_id": 57087271, "comment_id": 100715748, "body": "I&#39;ve restarted the server multiple times. Also restarted Spring. Not using bootsnap. It finds every other namespaced/nested model fine so far, but PetData namespace seems to not be autoloading. I&#39;d like to avoiding having to explicitly call this one model, as it seems to be a bandaid on an actual issue."}, {"owner": {"reputation": 3630, "user_id": 4799659, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153200714295120/picture?type=large", "display_name": "fylooi", "link": "https://stackoverflow.com/users/4799659/fylooi"}, "reply_to_user": {"reputation": 5036, "user_id": 1223595, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/770fb9d9d0c71f2c21de84c60653c230?s=128&d=identicon&r=PG", "display_name": "steventnorris", "link": "https://stackoverflow.com/users/1223595/steventnorris"}, "edited": false, "score": 0, "creation_date": 1563469480, "post_id": 57087271, "comment_id": 100720201, "body": "@steventnorris Explained in detail why it happens for this one model."}, {"owner": {"reputation": 5036, "user_id": 1223595, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/770fb9d9d0c71f2c21de84c60653c230?s=128&d=identicon&r=PG", "display_name": "steventnorris", "link": "https://stackoverflow.com/users/1223595/steventnorris"}, "edited": false, "score": 0, "creation_date": 1563475377, "post_id": 57087271, "comment_id": 100722762, "body": "This is confusing to me since the Identity module doesn&#39;t have this problem. api/v1/identity/users_controller.rb uses <code>Identity::User</code> fine without running into this issue. Is there a reason why that one wouldn&#39;t be failing but PetData::Pet inside of the pets_controller.rb is? Seems like that would cause the same flaw."}, {"owner": {"reputation": 3630, "user_id": 4799659, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153200714295120/picture?type=large", "display_name": "fylooi", "link": "https://stackoverflow.com/users/4799659/fylooi"}, "reply_to_user": {"reputation": 5036, "user_id": 1223595, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/770fb9d9d0c71f2c21de84c60653c230?s=128&d=identicon&r=PG", "display_name": "steventnorris", "link": "https://stackoverflow.com/users/1223595/steventnorris"}, "edited": false, "score": 0, "creation_date": 1563506075, "post_id": 57087271, "comment_id": 100730559, "body": "If <code>Identity::User</code> is autoloaded first, you won&#39;t have any problems. That would most likely have happened during initialization (eg. by Devise). You should be able to achieve the same effect by referencing <code>PetData::Pet</code> in an initializer (database connection sequence issues may apply :P)"}, {"owner": {"reputation": 5036, "user_id": 1223595, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/770fb9d9d0c71f2c21de84c60653c230?s=128&d=identicon&r=PG", "display_name": "steventnorris", "link": "https://stackoverflow.com/users/1223595/steventnorris"}, "edited": false, "score": 0, "creation_date": 1563561390, "post_id": 57087271, "comment_id": 100754499, "body": "That makes sense. I&#39;m using Devise so it likely is an initializer then. I haven&#39;t looked into any sort of custom initializer for Rails, but it seems to make sense that if I have a custom initializer that just includes all the models. It feels... uncomfortable, but could work."}, {"owner": {"reputation": 3630, "user_id": 4799659, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153200714295120/picture?type=large", "display_name": "fylooi", "link": "https://stackoverflow.com/users/4799659/fylooi"}, "reply_to_user": {"reputation": 5036, "user_id": 1223595, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/770fb9d9d0c71f2c21de84c60653c230?s=128&d=identicon&r=PG", "display_name": "steventnorris", "link": "https://stackoverflow.com/users/1223595/steventnorris"}, "edited": false, "score": 0, "creation_date": 1563683432, "post_id": 57087271, "comment_id": 100776945, "body": "I go into high alert for constant lookup issues the moment I see two constants which a) have the same name b) are not fully qualified. Fully qualifying both of them  feels like a very natural solution to me. :)"}], "tags": [], "owner": {"reputation": 3630, "user_id": 4799659, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153200714295120/picture?type=large", "display_name": "fylooi", "link": "https://stackoverflow.com/users/4799659/fylooi"}, "is_accepted": true, "score": 1, "last_activity_date": 1563506220, "last_edit_date": 1563506220, "creation_date": 1563425136, "answer_id": 57087271, "question_id": 57084802, "link": "https://stackoverflow.com/questions/57084802/accessibility-issue-for-model/57087271#57087271", "title": "Accessibility Issue for Model", "body": "<p>You can force Rails' autoload to resolve <code>PetData::Pet</code> in development as a top level constant by qualifying it, eg: </p>\n\n<pre><code># Api::V1::PetData::PetsController\ndef create\n  ::PetData::Pet\nend\n</code></pre>\n\n<p>You might need to restart your dev server / console if you have Bootsnap enabled and this is the first file you're adding in <code>/models/pet_data</code>. </p>\n\n<p>Non-comprehensive explanation on how Rails' autoloading works:</p>\n\n<ol>\n<li>When you call <code>A::B</code>, Rails will resolve <code>A</code> first.  </li>\n<li>If <code>A</code> is already loaded, Rails will use the directory nesting for the resolved constant instead of re-resolving it. Looking up the directory nesting for a constant is a slow process as it needs to go through the file system.</li>\n<li>If constant <code>A</code> is not loaded, Rails will search <code>autoload_paths</code> for a file\nnamed <code>a.rb</code>, which should define a class or module named <code>A</code>.</li>\n<li>If there's no file named <code>a.rb</code>, Rails will look for a directory named <code>a</code> in <code>autoload_paths</code>. If one is found, Rails will create a module named <code>A</code> and continue to autoload <code>B</code> within directory <code>a</code></li>\n<li>If Rails is not able to autoload <code>B</code> within directory <code>a</code>, an error will be raised.    </li>\n</ol>\n\n<hr>\n\n<p>So why does this work flawlessly everywhere except in this particular <code>PetData::PetsController</code> controller? </p>\n\n<p><strong>The PetData constant has already been loaded</strong>. Hence, Rails assumes that any constant nested after <code>PetData</code> will be stored under <code>/app/controllers/api/v1/pet_data</code></p>\n\n<p>You need Rails to load the correct file. This can be done by:</p>\n\n<ol>\n<li>Indicating to Rails that the <code>PetData</code> constant that you're referring to is <code>::PetData</code> instead of <code>Api::V1::PetData</code>. This will trigger autoload. </li>\n<li>Adding <code>require_dependency &lt;path to pet_data/pet.rb&gt;</code> to the top of\nyour controller. Rails will then load the file directly before evaluating the rest of your controller code. </li>\n</ol>\n"}], "owner": {"reputation": 5036, "user_id": 1223595, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/770fb9d9d0c71f2c21de84c60653c230?s=128&d=identicon&r=PG", "display_name": "steventnorris", "link": "https://stackoverflow.com/users/1223595/steventnorris"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 95, "favorite_count": 0, "accepted_answer_id": 57087271, "answer_count": 2, "score": 0, "last_activity_date": 1563506220, "creation_date": 1563402754, "question_id": 57084802, "link": "https://stackoverflow.com/questions/57084802/accessibility-issue-for-model", "title": "Accessibility Issue for Model", "body": "<p>I have a module in <code>/models/pet_data.rb</code> that looks like this:</p>\n\n<pre><code>module PetData\n  def self.table_name_prefix\n    \"\"\n  end\nend\n</code></pre>\n\n<p>I then have a class in <code>/models/pet_data/pet.rb</code> that looks like this:</p>\n\n<p>class PetData::Pet &lt; ApplicationRecord\nend</p>\n\n<p>Finally, there is a controller in <code>/controllers/api/v1/pet_data/pets_controller.rb</code> with a create method, like this:</p>\n\n<pre><code>def create\n    # Make pet \n    @pet = PetData::Pet.new(permitted_attributes(PetData::Pet))\n\n    # Authorize and scope\n    authorize @pet\n    skip_policy_scope\n\n    # Create\n    @pet.save!\n\n    # Return\n    @pet\n  end\n</code></pre>\n\n<p>Now, that throws the error <code>*** NameError Exception: uninitialized constant Api::V1::PetData::PetsController::PetData</code> However, if I put <code>::PetData</code> in the first line of that create method, no error.</p>\n\n<p>Is rails autoload not loading my modules here or something? How do I get it to recognize PetData::Pet as a proper thing?</p>\n"}, {"tags": ["arrays", "ruby", "class"], "comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 2, "creation_date": 1563405516, "post_id": 57084633, "comment_id": 100693294, "body": "Smashing around in ObjectSpace and looking for objects with particular properties is really not the best way to do this. You should have an array or hash structure storing them. Unless there&#39;s a reference to an object there&#39;s no reason for Ruby to keep it around, so theoretically it can discard both of the users you create here if you exit that scope. You must retain a reference somehow, and that&#39;s best done via a proper data structure."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1563408222, "post_id": 57084633, "comment_id": 100693832, "body": "@tadman, &quot;smashing around in ObjectSpace&quot; conjures <a href=\"https://www.cagle.com/paul-zanetti/2016/12/the-trump-in-the-china-shop\" rel=\"nofollow noreferrer\">images</a>."}], "answers": [{"tags": [], "owner": {"reputation": 144312, "user_id": 62076, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/62c90b6f399e6b95554b2da31ca8619a?s=128&d=identicon&r=PG", "display_name": "Alex Wayne", "link": "https://stackoverflow.com/users/62076/alex-wayne"}, "is_accepted": true, "score": 3, "last_activity_date": 1563405440, "last_edit_date": 1563405440, "creation_date": 1563405119, "answer_id": 57085081, "question_id": 57084633, "link": "https://stackoverflow.com/questions/57084633/ruby-class-method-to-return-array-of-emails/57085081#57085081", "title": "Ruby class method to return array of emails", "body": "<p>Your method does not return but only prints out what it finds.</p>\n\n<p>You need to create an array, add to it, then return it.</p>\n\n<pre><code>  def self.find_by_email(pattern)\n    # Create an empty array to store the emails.\n    emails = []\n\n    # Search!\n    ObjectSpace.each_object(self) do |object|\n\n      # If it matches, put the email in the array.\n      if object.email.include? pattern\n        emails &lt;&lt; object.email\n      end\n    end\n\n    # Return the array.\n    emails\n  end\n</code></pre>\n\n<hr>\n\n<p>And just a word of caution. You should probably stay away from <code>ObjectSpace</code>. This very much gets you under the hood of a ruby application, and into some territory where you may not be ready to go. I would recommend studying a lot more ruby foundational concepts before using it. And even then, it's <em>probably</em> a bad idea.</p>\n"}, {"comments": [{"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 1, "creation_date": 1563412183, "post_id": 57085330, "comment_id": 100694544, "body": "I suggest <code>@@instance_collector.each_with_object([]) do |instance, arr| email = instance.email; arr &lt;&lt; email if email.include? pattern; end</code>. Using <code>nil</code> to <code>select</code> is imo hackish and ugly."}], "tags": [], "owner": {"reputation": 6315, "user_id": 5411198, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/FabOI.jpg?s=128&g=1", "display_name": "sergio MAGA", "link": "https://stackoverflow.com/users/5411198/sergio-maga"}, "is_accepted": false, "score": 0, "last_activity_date": 1563407181, "creation_date": 1563407181, "answer_id": 57085330, "question_id": 57084633, "link": "https://stackoverflow.com/questions/57084633/ruby-class-method-to-return-array-of-emails/57085330#57085330", "title": "Ruby class method to return array of emails", "body": "<p>After reading the answer/comments I see how <code>ObjectSpace</code> could affect performance if there are many classes and instances to look for. So I decided to use the following class (using code from <a href=\"https://stackoverflow.com/questions/6365638/how-to-get-class-instances-in-ruby\">another question</a>):</p>\n\n<pre><code>class User\n  attr_accessor :email\n  @@instance_collector = []\n  def initialize\n    @email=\"example@example.com\"\n    @@instance_collector &lt;&lt; self\n  end\n  def self.find_by_email(pattern)\n    @@instance_collector.collect do |instance|\n      instance.email if instance.email.include? pattern\n    end.compact\n  end\nend\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1563408401, "post_id": 57085339, "comment_id": 100693867, "body": "You can also use <code>@@users</code> or define <code>self.users</code> accordingly. Lots of options here."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1563408939, "post_id": 57085339, "comment_id": 100693961, "body": "@tadman, I&#39;ve never used a class variable, for the usual reasons. Maybe I should rethink that."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1563409006, "post_id": 57085339, "comment_id": 100693979, "body": "Sometimes it&#39;s the least ugly of all the ugly options."}], "tags": [], "owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "is_accepted": false, "score": 2, "last_activity_date": 1563407597, "last_edit_date": 1563407597, "creation_date": 1563407256, "answer_id": 57085339, "question_id": 57084633, "link": "https://stackoverflow.com/questions/57084633/ruby-class-method-to-return-array-of-emails/57085339#57085339", "title": "Ruby class method to return array of emails", "body": "<p>This is an example of the approach I believe @tadman is suggesting.</p>\n\n<pre><code>class User\n  attr_accessor :email\n  @users = []\n\n  def initialize\n    @email=\"example@example.com\"\n    self.class.instance_variable_get(:@users) &lt;&lt; self\n  end\n\n  def self.select_by_email(pattern)\n    instance_variable_get(:@users).select { |instance| \n      instance.email.include?(pattern) }\n  end\nend\n</code></pre>\n\n<h1><p></p></h1>\n\n<pre><code>user1=User.new\n  #=&gt; #&lt;User:0x000055aaab80f6f0 @email=\"example@example.com\"&gt; \nuser2=User.new\n  #=&gt; #&lt;User:0x000055aaab8536c0 @email=\"example@example.com\"&gt; \nuser1.email=\"sergio@example.com\"\na = User.select_by_email \"s\"\n  #=&gt; [#&lt;User:0x000055aaab80f6f0 @email=\"sergio@example.com\"&gt;]\n</code></pre>\n\n<p>Note:</p>\n\n<pre><code>User.instance_variable_get(:@users)\n  #=&gt; [#&lt;User:0x000055aaab80f6f0 @email=\"sergio@example.com\"&gt;,\n  #    #&lt;User:0x000055aaab8536c0 @email=\"example@example.com\"&gt;] \n</code></pre>\n\n<p>We might then write:</p>\n\n<pre><code>a.map { |user| user.email }\n  #=&gt; [\"sergio@example.com\"]\n</code></pre>\n\n<p>I used the method <a href=\"https://ruby-doc.org/core-2.6.3/Object.html#method-i-instance_variable_get\" rel=\"nofollow noreferrer\">Object#instance_variable_get</a>, rather than creating a \"getter\" method for <code>@users</code>, because I do not want the content of that (class) instance variable to be accessible outside the class (though I guess I could have made that method private).</p>\n"}], "owner": {"reputation": 6315, "user_id": 5411198, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/FabOI.jpg?s=128&g=1", "display_name": "sergio MAGA", "link": "https://stackoverflow.com/users/5411198/sergio-maga"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 113, "favorite_count": 0, "accepted_answer_id": 57085081, "answer_count": 3, "score": 1, "last_activity_date": 1563407597, "creation_date": 1563401463, "question_id": 57084633, "link": "https://stackoverflow.com/questions/57084633/ruby-class-method-to-return-array-of-emails", "title": "Ruby class method to return array of emails", "body": "<p>I made a <code>User</code> class containing a class method <code>find_by_email</code>:</p>\n\n<pre><code>class User\n  attr_accessor :email\n  def initialize\n    @email=\"example@example.com\"\n  end\n  def self.find_by_email(pattern)\n    ObjectSpace.each_object(self) do |object|\n      puts object.email+\" \"+(object.email.include? pattern).to_s        \n    end\n  end\nend\n</code></pre>\n\n<p>In <code>irb</code> I try:</p>\n\n<pre><code>irb&gt; user1=User.new\nirb&gt; user2=User.new\nirb&gt; user1.email=\"sergio@example.com\"\nirb&gt; User.find_by_email \"s\"\n</code></pre>\n\n<p>which returns:</p>\n\n<pre><code>example@example.com false\nsergio@example.com true\n</code></pre>\n\n<p>I would like <code>find_by_email</code> to return an array with the matching emails. So for this example it should only return <code>[\"sergio@example.com\"]</code>. How can I refactor the <code>find_by_email</code> class to achieve this?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-4", "machinist"], "comments": [{"owner": {"reputation": 21, "user_id": 3757655, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5d48e510734648f88cb08193ff81ab4f?s=128&d=identicon&r=PG&f=1", "display_name": "user3757655", "link": "https://stackoverflow.com/users/3757655/user3757655"}, "edited": false, "score": 0, "creation_date": 1563410226, "post_id": 57084475, "comment_id": 100694194, "body": "The tests are failing from 4.2.8.rc1. Checked the change <a href=\"https://github.com/rails/rails/blob/4-2-stable/activesupport/CHANGELOG.md#rails-428-february-21-2017\" rel=\"nofollow noreferrer\">log</a>. Seems like the changes shouldn&#39;t have issues but they turn up after reload."}, {"owner": {"reputation": 1887, "user_id": 4948732, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh4.googleusercontent.com/-ZnN3lJjklJg/AAAAAAAAAAI/AAAAAAAAAWE/zqGtDAyXfjo/photo.jpg?sz=128", "display_name": "thesecretmaster", "link": "https://stackoverflow.com/users/4948732/thesecretmaster"}, "edited": false, "score": 0, "creation_date": 1563654832, "post_id": 57084475, "comment_id": 100773153, "body": "So what you&#39;re saying is that the time is changed when values are retrieved from the database, whereas in 2.4.7 the time would be the same and just the timezone would change?"}, {"owner": {"reputation": 21, "user_id": 3757655, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5d48e510734648f88cb08193ff81ab4f?s=128&d=identicon&r=PG&f=1", "display_name": "user3757655", "link": "https://stackoverflow.com/users/3757655/user3757655"}, "reply_to_user": {"reputation": 1887, "user_id": 4948732, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh4.googleusercontent.com/-ZnN3lJjklJg/AAAAAAAAAAI/AAAAAAAAAWE/zqGtDAyXfjo/photo.jpg?sz=128", "display_name": "thesecretmaster", "link": "https://stackoverflow.com/users/4948732/thesecretmaster"}, "edited": false, "score": 0, "creation_date": 1563829760, "post_id": 57084475, "comment_id": 100822647, "body": "Yes, that&#39;s what I see."}, {"owner": {"reputation": 21, "user_id": 3757655, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5d48e510734648f88cb08193ff81ab4f?s=128&d=identicon&r=PG&f=1", "display_name": "user3757655", "link": "https://stackoverflow.com/users/3757655/user3757655"}, "reply_to_user": {"reputation": 1887, "user_id": 4948732, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh4.googleusercontent.com/-ZnN3lJjklJg/AAAAAAAAAAI/AAAAAAAAAWE/zqGtDAyXfjo/photo.jpg?sz=128", "display_name": "thesecretmaster", "link": "https://stackoverflow.com/users/4948732/thesecretmaster"}, "edited": false, "score": 0, "creation_date": 1564013760, "post_id": 57084475, "comment_id": 100894729, "body": "Seems like the commit (<a href=\"https://github.com/rails/rails/commit/d569f8dc5f0c6345db476ebd9f228c68c3434a29\" rel=\"nofollow noreferrer\">github.com/rails/rails/commit/&hellip;</a>) is causing the issue. Setting ActiveSupport.to_time_preserves_timezone = true does help the to_time method but not the database reload"}, {"owner": {"reputation": 1887, "user_id": 4948732, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh4.googleusercontent.com/-ZnN3lJjklJg/AAAAAAAAAAI/AAAAAAAAAWE/zqGtDAyXfjo/photo.jpg?sz=128", "display_name": "thesecretmaster", "link": "https://stackoverflow.com/users/4948732/thesecretmaster"}, "edited": false, "score": 0, "creation_date": 1564101502, "post_id": 57084475, "comment_id": 100929360, "body": "Well, does the DB store the timezone? It could be that your DB engine doesn&#39;t store the timezone so rails just assumes UTC."}], "owner": {"reputation": 21, "user_id": 3757655, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5d48e510734648f88cb08193ff81ab4f?s=128&d=identicon&r=PG&f=1", "display_name": "user3757655", "link": "https://stackoverflow.com/users/3757655/user3757655"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 135, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1563410350, "creation_date": 1563400193, "last_edit_date": 1563410350, "question_id": 57084475, "link": "https://stackoverflow.com/questions/57084475/time-zone-change-on-datetime-method-rails-4-2-8", "title": "Time zone change on DateTime method (Rails 4.2.8)", "body": "<p>I am trying to upgrade from rails 4.2.7 to 4.2.8 and found a case where the DateTime method of rails switches the time zone to local on reload from database which was not seen in rails 4.2.7. On rails 4.2.8, the unit test of my app rely on the DateTime method to get beginning of the year, </p>\n\n<pre><code>DateTime.new(2019,1,1,0,0,0)\nTue, 01 Jan 2019 00:00:00 +0000\n</code></pre>\n\n<p>This resultant value, is passed as part of an object to, <br>\n<a href=\"https://www.rubydoc.info/gems/machinist/Machinist/ActiveRecord/Blueprint\" rel=\"nofollow noreferrer\">Class:Machinist::ActiveRecord::Blueprint</a> where the reload happens. </p>\n\n<pre><code>def reload(options = nil)\n  clear_aggregation_cache\n  clear_association_cache\n  self.class.connection.clear_query_cache\n\n  fresh_object =\n    if options &amp;&amp; options[:lock]\n      self.class.unscoped { self.class.lock(options[:lock]).find(id) }\n    else\n      self.class.unscoped { self.class.find(id) }\n    end\n\n  @attributes = fresh_object.instance_variable_get('@attributes')\n  @new_record = false\n  self\nend\n</code></pre>\n\n<p>The instance_variable_get method at, </p>\n\n<pre><code>@attributes = fresh_object.instance_variable_get('@attributes')\n</code></pre>\n\n<p>switches the time zone on Rails 4.2.8 to local(Mon, 31st Dec 2018 16:00:00 -0800) but not on 4.2.7 where just the time zone is switched and not the time (Tue, 1st Jan 2019 00:00:00 -0800). A similar method, Time.new() has got no problem with this as the time zone is set to local by default, </p>\n\n<pre><code>Time.new(2019,1,1,0,0,0)\n2019-01-01 00:00:00 -0800\n</code></pre>\n\n<p>Trying to pinpoint what changed on rails 4.2.8 that doesn't let the time zones persist to UTC for the DateTime method on the reload. \nAny insights on this are helpful. \nThanks</p>\n"}, {"tags": ["ruby", "ssl", "https", "gzip", "faraday"], "answers": [{"tags": [], "owner": {"reputation": 2510, "user_id": 1034223, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/486042df63bea54d7f796ad24bcbf82d?s=128&d=identicon&r=PG", "display_name": "Duke", "link": "https://stackoverflow.com/users/1034223/duke"}, "is_accepted": false, "score": 1, "last_activity_date": 1583609102, "creation_date": 1583609102, "answer_id": 60581405, "question_id": 57084421, "link": "https://stackoverflow.com/questions/57084421/faraday-gem-not-ungzipping-response-body/60581405#60581405", "title": "Faraday gem not ungzipping response body", "body": "<p>Given you are using the faraday-middleware gem, you can just use the <code>:gzip</code> middleware in connection setup.</p>\n\n<p><strong><code>request.use :gzip</code></strong></p>\n\n<p>Using your code as example:</p>\n\n<pre><code>response = connection.get do |request|\n  request.url \"/SystmOneMHS/NHSConnect/Z12345/STU3/1/Patient?#{identifier}\"\n  request.use :gzip\n  request.headers = headers\nend\n</code></pre>\n"}], "owner": {"reputation": 26, "user_id": 1746964, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8470dc7c143ecc5bc66fc2bfe4175171?s=128&d=identicon&r=PG", "display_name": "pacharanero", "link": "https://stackoverflow.com/users/1746964/pacharanero"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 392, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1583609102, "creation_date": 1563399891, "last_edit_date": 1563438009, "question_id": 57084421, "link": "https://stackoverflow.com/questions/57084421/faraday-gem-not-ungzipping-response-body", "title": "Faraday gem not ungzipping response body", "body": "<p>I'm experimenting with the UK NHS 'GP Connect' REST API and trying to wrap some of the connection complexity in a more simple Ruby layer. </p>\n\n<p>I've been successfully playing with the API via Postman and the responses are all correctly unzipped to JSON/FHIR. Taking the simplest of the requests from my Postman session and converting it to Ruby using the Faraday HTTP gem, I can make the request/response cycle work fine, but the response is still gzipped.\n(I'm using Ruby 2.6.1 and Faraday 0.15.4)</p>\n\n<p>(The API requires 'accept-encoding': 'gzip' to work at all.)</p>\n\n<p>Googling the problem I'm having turns up only Faraday middleware which is intended to be used when <strong>not</strong> using Net::HTTP (the default adapter, and what I am using)</p>\n\n<p>The whole thing is a single script at this stage so it's easy enough to show. (There are additionally some client certs and a locally installed CA cert which are all working fine and no issues)</p>\n\n<p>***** = I've blanked it to protect the innocent, although the healthcare endpoint I'm using here is a dummy-test with fictional data anyway.</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>require 'faraday'\n\nidentifier = \"identifier=https://fhir.nhs.uk/Id/nhs-number|*****\"\nbaseurl = \"https://systmoneukdemo1.tpp-uk.com\"\nheaders = {\n  \"authorization\": '*****',\n  \"content-type\": 'application/json+fhir',\n  \"accept-encoding\": 'gzip',\n  \"accept\": 'application/json+fhir',\n  \"ssp-from\": '*****',\n  \"ssp-interactionid\": 'urn:nhs:names:services:gpconnect:fhir:rest:search:patient-1',\n  \"ssp-to\": '123456',\n  \"ssp-traceid\": '*****',\n  \"cache-control\": 'no-cache',\n}\n\nconnection = Faraday.new(\n  url: baseurl,\n  ssl: {\n    ca_file: './certs/cacert.crt',\n    client_cert: OpenSSL::X509::Certificate.new(File.read(\"certs/summer-school-cert.crt\")),\n    client_key: OpenSSL::PKey::RSA.new(File.read(\"certs/summer-school-cert.key\")),\n  }\n)\n\nresponse = connection.get do |request|\n  request.url \"/SystmOneMHS/NHSConnect/Z12345/STU3/1/Patient?#{identifier}\"\n  request.headers = headers\nend\n\nputs response.body\n</code></pre>\n\n<p>The response when I run <code>ruby script.rb</code> is:</p>\n\n<pre><code>\ufffdU\ufffdo\ufffd0\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd-   |Z\ufffd\ue1f4\ufffdU\ufffdn\u04eajrV\ufffdA\ufffdT\ufffd\ufffd\ufffd\ufffd;;dM\ufffdn\ufffd4-\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd{w\u03fd'\n\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd)9f\ufffdW\ufffd\u04ba\ufffdb\ufffd-+\ufffde\ufffd\ufffd7\ufffd\ufffd\ufffd2pZ\ufffd\ufffd\ufffddPr\ufffd5o\ufffd\ufffd\ufffd,m\ufffd\ufffd\\;\n                                                  `*\ufffd:\ufffd\u0386\ufffd\ufffd\ufffd\ufffd\ufffd\ufffdr\ufffd\ufffd1Aju\ufffdH\ufffd\ufffd\uc178T\ufffd\u03d8\ufffd\ufffd\u078d|\ufffd?\ufffd\n                                                                                          \u07f6ih&gt;jy\ufffd\ufffd\ufffd\ufffdD\ufffd\ufffd\ufffd\ufffd5&amp;=\ufffd\ufffdm\ufffd\ufffd/G\ufffd\ufffd\u00d1\ufffd'\ufffd\u03e2#?\ufffd\ufffd'Q6\ufffd~\ufffd\ufffd\ufffdy\ufffd\ufffd^[.\ufffdu\ufffd\ufffd-\ufffd\ufffd@\ufffd\u0221S\u01db^\ufffd~\ufffdb?|A\ufffd#\u05e6\ufffd%eu\ufffd\ufffd:\n                   \ufffd\ufffd \ufffd\ufffd\ufffdh\ufffdM\ufffd4dm\ufffd\ufffdj\ufffdWB\ufffdl\n                                        8\ufffd%\ufffd\ufffdf\ufffd\ufffdb\ufffd\ufffdsf\ufffd\ufffd\ufffd\ufffdC\ufffd&gt;iS[\n\ufffd\ufffdC\ufffdq$\ufffd\u025b\ufffd\ufffd\ufffd\u01e3\ufffd\ufffdh\ufffdoF\ufffd?\ufffdj\u0659R\n                         \ufffd7\ufffdgh\ufffdh\ufffd\ufffd\ufffd\ufffd\ufffdw\ufffd`\ufffd\ufffdd\ufffd:iq\ufffdP\ufffd  \ufffd\ufffd\ufffd\ufffd\ufffd\ufffdYa\ufffdz&lt;\ufffd\ufffd\ufffd\ufffdk\ufffd\ufffdd5X1\ufffd\ufffd\ufffd\ufffdJ\ufffdWfV\ufffd\ufffd}\ufffdy\ufffd@\ufffdw%\ufffd\ufffd0\ufffd\ufffd\ufffd\n\ufffd\ufffd;\u00e0)\ufffd!g\ufffd\ufffd\ufffd\ufffd(\ufffd\ufffdL\ufffdWMm\ufffd&lt;xg\ufffd\ufffdL\ufffd\ufffd\ufffd\ufffdp\ufffdI\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd9\ufffd\ufffd]#\n                                                 \ufffd\ufffdi\ufffdN3\ufffdnz\ufffd\ufffdz\ufffd'\ufffdMf\ufffd\u021bz\ufffd\u06aa\ufffd\ufffd\ufffd\ufffd\ufffd]\"\ufffdy\ufffd\ufffd\ufffd\ufffd\ufffdr'\n                                                                                         j\ufffd\ufffd\ufffd\ufffdgru\ufffd\ufffd_\ufffd\ufffdu\ufffd\ufffdC,\ufffd\ufffdU\ufffd\ufffd /\n\u00fd\"\ufffd\ufffd\ufffdH\ufffd\ufffd\ufffd\ufffdV\ufffd\ufffd0\ufffdkT\ufffd\u0138\ufffd\ufffd.f\ufffd\ufffdpUN\u054aI\ufffd\u074evs\ufffd\ufffdZ\ufffd\ufffd\ufffd\uc7b9\u02c2\ufffd}\ufffd\ufffdg\ufffd\ufffd6Q\ufffd\ufffdv\ufffd\ufffd\ufffdp&lt;\n             \ufffd-.6z\nR\ufffd\u011e\ufffd\ufffd6\ufffdV\ufffd\ufffd  \ufffd\ufffd-Pzs\ufffdL\ufffd\ufffd\u053b\ufffd4\ufffd_\ufffd\ufffdL\ufffd\ufffdZ\ufffdb\ufffd\ufffdg:\ufffd\ufffd;\ufffdOF=g{\ufffdy\ufffd?Ly\ufffd+\ufffd\ufffd\ufffd\ufffdkk\ufffd\ufffd\ufffdH\ufffdy\ufffd\ufffd\ufffd\n\ufffd\ufffd\ufffd\ufffd\ufffd\ufffda\ufffd\ufffds}\ufffd\ufffdO/\ufffdW\ufffd=\ufffd\ufffdr\ufffd\ufffdF\ufffd\ufffd%a\n</code></pre>\n\n<p>however if I pipe that output into gzip:</p>\n\n<pre><code>ruby script.rb | gzip -d\n{\"resourceType\":\"Bundle\",\"id\":\"4D2EAEC0-A8DB-11E9-8B9A-1BA7090BDAD3\",\"meta\":{\"profile\":[\"https://fhir.nhs.uk/STU3/StructureDefinition/GPConnect-Searchset-Bundle-1\"]},\"type\":\"searchset\",\"entry\":[{\"fullUrl\":\"Patient/9222500000000000\",\"resource\":{\"resourceType\":\"Patient\",\"id\":\"9222500000000000\",\"meta\":{\"profile\":[\"https://fhir.nhs.uk/STU3/StructureDefinition/CareConnect-GPC-Patient-1\"],\"versionId\":\"220262D942C746E9D8023C82ABC8F500\",\"lastUpdated\":\"2019-07-17T22:39:05+01:00\"},\"identifier\":[{\"system\":\"https://fhir.nhs.uk/Id/nhs-number\",\"value\":\"6656336566\",\"extension\":[{\"url\":\"https://fhir.nhs.uk/STU3/StructureDefinition/Extension-CareConnect-GPC-NHSNumberVerificationStatus-1\",\"valueCodeableConcept\":{\n    \"coding\":\n    [\n        {\n            \"system\":\"https://fhir.nhs.uk/STU3/CodeSystem/CareConnect-NHSNumberVerificationStatus-1\",\n            \"code\":\"01\",\n            \"display\":\"Number present and verified\"\n        }\n    ]\n}}]}],\"name\":[{\"prefix\":[\"Mr\"],\"given\":[\"Michael\"],\"family\":\"Smith\",\"use\":\"official\"}],\"address\":[{\"use\":\"home\",\"type\":\"both\",\"line\":[\"6 Wren Street\"],\"city\":\"London\",\"postalCode\":\"WC1X 0HD\"}],\"telecom\":[{\"system\":\"phone\",\"use\":\"home\",\"value\":\"01132252263\"},{\"system\":\"email\",\"use\":\"home\",\"value\":\"liang.lin@tpp-uk.com\"}],\"birthDate\":\"1960-01-19\",\"gender\":\"male\",\"active\":true,\"managingOrganization\":{\"reference\":\"Organization/bd00000000000000\"},\"generalPractitioner\":[{\"reference\":\"Practitioner/e576600000000000\"}],\"extension\":[{\"url\":\"https://fhir.nhs.uk/STU3/StructureDefinition/Extension-CareConnect-GPC-RegistrationDetails-1\",\"extension\":[{\"url\":\"registrationPeriod\",\"valuePeriod\":{\"start\":\"2017-01-01T00:00:00Z\"}},{\"url\":\"registrationType\",\"valueCodeableConcept\":{\"coding\":[{\"system\":\"https://fhir.nhs.uk/STU3/CodeSystem/CareConnect-RegistrationType-1\",\"code\":\"O\",\"display\":\"Other\"}]}},{\"url\":\"preferredBranchSurgery\",\"valueReference\":{\"reference\":\"Location/bd00000000000000_0100000000000000\"}}]}]}}]}\ngzip: stdin: unexpected end of file\n</code></pre>\n\n<p>I get un-gzipped FHIR JSON content, which is what I'm expecting. So everything is working right up until the ungzipping stage, which is not being carried out, and the raw ugzipped content is returning to me as the response.</p>\n\n<p>Somehow it seems that Faraday isn't automatically un-gzipping the response body. I've searched in Faraday's documentation for a flag or other control that I perhaps should be setting, but I can't find a clear explanation of how this should be handled.</p>\n\n<p>Clearly I could un-gzip this output directly, but I would like to know if there is a proper internal 'Faraday' way of doing it. If it's using the Faraday Gzip middleware, then great, but how?</p>\n\n<p>If it helps with working out what's going on, I've reimplemented this in plain Net::HTTP and the results are exactly the same, the reponse body is not being un-gzipped. Both Faraday and Net::HTTP say they do the ungzipping automatically, but neither of them are.</p>\n\n<p>Any thoughts or advice welcome.</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 2828, "user_id": 3330613, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/a8pQr.jpg?s=128&g=1", "display_name": "MSC", "link": "https://stackoverflow.com/users/3330613/msc"}, "edited": false, "score": 0, "creation_date": 1563409272, "post_id": 57084304, "comment_id": 100694028, "body": "Not sure this does exactly that but have you tried <a href=\"https://chrome.google.com/webstore/detail/railspanel/gjpfobpafnhjhbajcjgccbbdofdckggg\" rel=\"nofollow noreferrer\">chrome.google.com/webstore/detail/railspanel/&hellip;</a>"}, {"owner": {"reputation": 1387, "user_id": 3981789, "user_type": "registered", "accept_rate": 54, "profile_image": "https://i.stack.imgur.com/OO3JI.jpg?s=128&g=1", "display_name": "Rockster160", "link": "https://stackoverflow.com/users/3981789/rockster160"}, "reply_to_user": {"reputation": 2828, "user_id": 3330613, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/a8pQr.jpg?s=128&g=1", "display_name": "MSC", "link": "https://stackoverflow.com/users/3330613/msc"}, "edited": false, "score": 0, "creation_date": 1563420710, "post_id": 57084304, "comment_id": 100696090, "body": "Not quite. That logs development to the browser. I\u2019m trying to run a console through a page. \ud83d\ude05"}], "answers": [{"tags": [], "owner": {"reputation": 334, "user_id": 2606111, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FUdFG.jpg?s=128&g=1", "display_name": "Mahys116", "link": "https://stackoverflow.com/users/2606111/mahys116"}, "is_accepted": false, "score": 0, "last_activity_date": 1563433912, "creation_date": 1563433912, "answer_id": 57088948, "question_id": 57084304, "link": "https://stackoverflow.com/questions/57084304/rails-console-access-through-web-page-interface/57088948#57088948", "title": "Rails console access through web page interface?", "body": "<p>You can use <strong>web-console</strong> gem in production and run console in admin space, like:</p>\n\n<pre><code>class AdminController &lt; ApplicationController\n  def console_page\n    console\n    render inline: '&lt;h2&gt;console page&lt;/h2&gt;'\n  end\nend\n</code></pre>\n"}], "owner": {"reputation": 1387, "user_id": 3981789, "user_type": "registered", "accept_rate": 54, "profile_image": "https://i.stack.imgur.com/OO3JI.jpg?s=128&g=1", "display_name": "Rockster160", "link": "https://stackoverflow.com/users/3981789/rockster160"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 372, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1563433912, "creation_date": 1563399098, "question_id": 57084304, "link": "https://stackoverflow.com/questions/57084304/rails-console-access-through-web-page-interface", "title": "Rails console access through web page interface?", "body": "<p>This is a bit of an odd request and not certain on how to approach it, but essentially we want an admin portal where devs can access a Rails-type console directly. </p>\n\n<p>Ideally, we'd be able to paste something like this: </p>\n\n<pre><code>count = User.count\n\nputs \"We have #{count} users!!\"\n</code></pre>\n\n<p>and have it output:</p>\n\n<pre><code>We have 872633 users!!\n</code></pre>\n\n<p>Obviously the commands would be more extensive than that, as they could be exporting, making direct updates, etc. The more info we can have outputted the better, such as DEBUG logs, SQL queries, etc, just not sure on how to get access to something like that.</p>\n\n<p>We recognize it's not great practice, but time and time again we need something from the console directly, and we'd like to be able to submit the proposal, require another dev to verify/approve it, and then keep a log of the commands run. </p>\n\n<p>Is there a gem out there that handles this? If not, are there any recommendations on how to implement something like this?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "postgresql"], "answers": [{"tags": [], "owner": {"reputation": 1634, "user_id": 5703217, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/Oj8Lb.jpg?s=128&g=1", "display_name": "Muhammad Faisal Iqbal", "link": "https://stackoverflow.com/users/5703217/muhammad-faisal-iqbal"}, "is_accepted": false, "score": 0, "last_activity_date": 1563439419, "last_edit_date": 1563439419, "creation_date": 1563401213, "answer_id": 57084597, "question_id": 57083942, "link": "https://stackoverflow.com/questions/57083942/rails-bi-directional-looped-associations-doing-weird-queries/57084597#57084597", "title": "Rails bi-directional looped associations doing weird queries", "body": "<p>I don't know why it was happening\nbut changing </p>\n\n<pre><code>current_user.friendships.where(friend_id: permitted_params[:friend_id]).first_or_create\n</code></pre>\n\n<p>To</p>\n\n<pre><code>current_user.friendships.create(friend_id: permitted_params[:friend_id])\n</code></pre>\n\n<p>it took hours but still don't know exact reason</p>\n"}], "owner": {"reputation": 1634, "user_id": 5703217, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/Oj8Lb.jpg?s=128&g=1", "display_name": "Muhammad Faisal Iqbal", "link": "https://stackoverflow.com/users/5703217/muhammad-faisal-iqbal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 67, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1563439419, "creation_date": 1563396876, "last_edit_date": 1563399154, "question_id": 57083942, "link": "https://stackoverflow.com/questions/57083942/rails-bi-directional-looped-associations-doing-weird-queries", "title": "Rails bi-directional looped associations doing weird queries", "body": "<p>I have model named <strong>User</strong> and I want to achieve 2 ways friends functionality using model named <strong>Friendship</strong>.</p>\n\n<p>User:</p>\n\n<pre><code>class User &lt; ApplicationRecord\n\n  has_many :friendships, :class_name =&gt; \"Friendship\", :foreign_key =&gt; 'user_id'\n  has_many :invited, :through =&gt; :friendships, :source =&gt; :friend\n\n  has_many :inverse_friendships , :class_name =&gt; \"Friendship\" , :foreign_key =&gt; \"friend_id\"\n  has_many :invited_by, :through =&gt; :inverse_friendships, :source =&gt; :user\n\nend\n</code></pre>\n\n<p>Friendship:</p>\n\n<pre><code>class Friendship &lt; ApplicationRecord\n  belongs_to :user\n  belongs_to :friend, :class_name =&gt; \"User\"\nend\n</code></pre>\n\n<p>I am creating friendships kind of this</p>\n\n<pre><code>u1 = User.find(1)\nu2 = User.find(2)\n\nu1.friendships.create(friend_id: u2.id)\n</code></pre>\n\n<p>now when in <code>before_save</code> of friendship I try to check if user has already received a friend request like</p>\n\n<pre><code>self.user.inverse_friendships.where(user_id: self.friend_id)\n</code></pre>\n\n<p>I was expecting it to search Friendship table where user_id = 2 and friend_id = 1, instead its generating this query</p>\n\n<blockquote>\n  <p>Friendship Load (0.7ms)  SELECT  \"friendships\".* FROM \"friendships\"\n  WHERE \"friendships\".\"user_id\" = $1 AND \"friendships\".\"friend_id\" = $2\n  AND \"friendships\".\"user_id\" = $3 LIMIT $4  [[\"user_id\", 1],\n  [\"friend_id\", 1], [\"user_id\", 2], [\"LIMIT\", 11]]</p>\n</blockquote>\n\n<p>and even with only </p>\n\n<pre><code>self.user.inverse_friendships\n</code></pre>\n\n<p>I was expecting search on Friendship table where friend_id = 1, its generating query like</p>\n\n<blockquote>\n  <p>Friendship Load (0.0ms)  SELECT  \"friendships\".* FROM \"friendships\"\n  WHERE \"friendships\".\"user_id\" = $1 AND \"friendships\".\"friend_id\" = $2\n  LIMIT $3  [[\"user_id\", 1], [\"friend_id\", 1], [\"LIMIT\", 11]]</p>\n</blockquote>\n\n<p><strong>But If I try query directly from console, it works as expected</strong></p>\n\n<p>Its even working in instance method, only not working in callback\nwhat I am doing wrong here?</p>\n"}, {"tags": ["ruby", "heroku", "ruby-on-rails-5", "cloud9"], "comments": [{"owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 1, "creation_date": 1563396593, "post_id": 57083726, "comment_id": 100690846, "body": "did you run the migration <code>add_activation_to_users</code> as instructed the chapter? Can you show your users table schema (in db/schema.rb) and see if it has the boolean column <code>activated</code> ?"}, {"owner": {"reputation": 11, "user_id": 11799611, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/15a8017cf3b2cb2cfccef685e76a0b5f?s=128&d=identicon&r=PG&f=1", "display_name": "ukpapyrus", "link": "https://stackoverflow.com/users/11799611/ukpapyrus"}, "reply_to_user": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 0, "creation_date": 1563400083, "post_id": 57083726, "comment_id": 100692037, "body": "I did. my users table schema is below.  create_table &quot;users&quot;, force: :cascade do |t|     t.string &quot;name&quot;     t.string &quot;email&quot;     t.datetime &quot;created_at&quot;, null: false     t.datetime &quot;updated_at&quot;, null: false     t.string &quot;password_digest&quot;     t.string &quot;remember_digest&quot;     t.string &quot;profile&quot;     t.string &quot;user_image&quot;     t.string &quot;activation_digest&quot;     t.boolean &quot;activated&quot;, default: false     t.datetime &quot;activated_at&quot;     t.string &quot;reset_digest&quot;     t.datetime &quot;reset_sent_at&quot;     t.index [&quot;email&quot;], name: &quot;index_users_on_email&quot;, unique: true   end"}, {"owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 0, "creation_date": 1563402087, "post_id": 57083726, "comment_id": 100692487, "body": "Do you also get this error running the app &quot;locally&quot; (with rails server), or just on heroku?"}, {"owner": {"reputation": 11, "user_id": 11799611, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/15a8017cf3b2cb2cfccef685e76a0b5f?s=128&d=identicon&r=PG&f=1", "display_name": "ukpapyrus", "link": "https://stackoverflow.com/users/11799611/ukpapyrus"}, "reply_to_user": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 0, "creation_date": 1563408517, "post_id": 57083726, "comment_id": 100693886, "body": "Just on heroku."}], "answers": [{"tags": [], "owner": {"reputation": 1175, "user_id": 2861567, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GRa02.jpg?s=128&g=1", "display_name": "quyetdc", "link": "https://stackoverflow.com/users/2861567/quyetdc"}, "is_accepted": false, "score": 0, "last_activity_date": 1563445301, "creation_date": 1563445301, "answer_id": 57092320, "question_id": 57083726, "link": "https://stackoverflow.com/questions/57083726/cannot-solve-heroku-nomethoderror/57092320#57092320", "title": "Cannot solve Heroku NoMethodError", "body": "<p>Everytime you have changes on your <code>rails</code> database, after pushing your code to <code>heroku</code> using <code>Git</code>, you need to run <code>migrate</code> on <code>Heroku</code> also</p>\n\n<p>You may want to run this from your terminal</p>\n\n<pre><code>heroku run rails db:migrate\n</code></pre>\n\n<p>Let me know if it resolves your problem</p>\n"}], "owner": {"reputation": 11, "user_id": 11799611, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/15a8017cf3b2cb2cfccef685e76a0b5f?s=128&d=identicon&r=PG&f=1", "display_name": "ukpapyrus", "link": "https://stackoverflow.com/users/11799611/ukpapyrus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 48, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1563445301, "creation_date": 1563395720, "question_id": 57083726, "link": "https://stackoverflow.com/questions/57083726/cannot-solve-heroku-nomethoderror", "title": "Cannot solve Heroku NoMethodError", "body": "<p>I'm studying rails tutorial 11 and 12(account activations and password resett).I'm developing a product with cloud9,and use heroku for production environment.It run perfectly with cloud9,but it had some errors with heroku.Seeing heroku logs,some errors were in below.I cannot solve nomehoderror.\n\"activated\" is a column in Users table.I finished adding it to users and using rails db:migrate.</p>\n\n<pre><code>NoMethodError (undefined method `activated?' for \u301c&gt;\nDid you mean?  activate):\n</code></pre>\n\n<p>I searched some articles about this problem, I don't know.</p>\n\n<p>SessionsController</p>\n\n<pre><code>def create\n    user = User.find_by(email: params[:session][:email].downcase)\n    if user &amp;&amp; user.authenticate(params[:session][:password])\n      if user.activated?\n        log_in user\n        params[:session][:remember_me] == '1' ? remember(user) : forget(user)\n        redirect_back(fallback_location:\"/\")\n      else\n        message  = \"\u30a2\u30ab\u30a6\u30f3\u30c8\u304c\u6709\u52b9\u5316\u3055\u308c\u3066\u3044\u307e\u305b\u3093\u3002 \"\n        message += \"\u767b\u9332\u3057\u305f\u30e1\u30fc\u30eb\u30a2\u30c9\u30ec\u30b9\u3078\u9001\u4fe1\u3055\u308c\u305f\u30e1\u30fc\u30eb\u3092\u78ba\u8a8d\u3057\u3001\u30a2\u30ab\u30a6\u30f3\u30c8\u3092\u6709\u52b9\u5316\u3057\u3066\u304f\u3060\u3055\u3044\u3002\"\n        flash[:notice] = message\n        redirect_to (\"/\")\n      end\n    else\n      flash.now[:notice] = '\u30e1\u30fc\u30eb\u30a2\u30c9\u30ec\u30b9\u307e\u305f\u306f\u30d1\u30b9\u30ef\u30fc\u30c9\u304c\u9593\u9055\u3063\u3066\u3044\u307e\u3059'\n      render 'sessions/new'\n    end  \n  end\n</code></pre>\n\n<p>I expect account activations, but the actual output is 500 server error.</p>\n"}, {"tags": ["ruby", "variables", "ruby-on-rails-4", "global-variables", "activesupport-concern"], "comments": [{"owner": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "edited": false, "score": 0, "creation_date": 1563394949, "post_id": 57083318, "comment_id": 100690194, "body": "I&#39;m not sure your example makes it clear WHY you want to do this.  Will you really use <code>ItemType.find_by(:name =&gt; &quot;bar&quot;)</code> in your application? Use of global variables for your use case breaks MVC and basic Rails conventions.  You first need to ask yourself WHY you think you need to do this.  There are likely better more conventional ways to do it."}, {"owner": {"reputation": 23, "user_id": 8412816, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cce4dac3ef68aca5a118d3aa88c2512a?s=128&d=identicon&r=PG&f=1", "display_name": "Danny Trujillo", "link": "https://stackoverflow.com/users/8412816/danny-trujillo"}, "reply_to_user": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "edited": false, "score": 0, "creation_date": 1563395413, "post_id": 57083318, "comment_id": 100690408, "body": "I guess that is my question. What is the conventional/better way to do this using the example above? I would like a variable that is accessible in both of these use cases."}, {"owner": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "edited": false, "score": 0, "creation_date": 1563395594, "post_id": 57083318, "comment_id": 100690487, "body": "The problem is, how can you be sure <code>ItemType.find_by(:name =&gt; &quot;bar&quot;)</code> will even return anything?  Your code makes assumptions about the database."}, {"owner": {"reputation": 23, "user_id": 8412816, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cce4dac3ef68aca5a118d3aa88c2512a?s=128&d=identicon&r=PG&f=1", "display_name": "Danny Trujillo", "link": "https://stackoverflow.com/users/8412816/danny-trujillo"}, "reply_to_user": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "edited": false, "score": 0, "creation_date": 1563395779, "post_id": 57083318, "comment_id": 100690552, "body": "The database is seeded with specific item_types. The database is assumed and designed to have them."}], "answers": [{"comments": [{"owner": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "edited": false, "score": 0, "creation_date": 1563396393, "post_id": 57083799, "comment_id": 100690789, "body": "OP may want to also validate uniqueness of name on the item type"}, {"owner": {"reputation": 14827, "user_id": 645886, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2abb0123e9484284a9cb2d36aa9854b3?s=128&d=identicon&r=PG&f=1", "display_name": "Surya", "link": "https://stackoverflow.com/users/645886/surya"}, "reply_to_user": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "edited": false, "score": 1, "creation_date": 1563396543, "post_id": 57083799, "comment_id": 100690832, "body": "@lacostenycoder: Then OP should mention that in the example code in the post. Anyway, it&#39;s pretty easy to get around it."}, {"owner": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "edited": false, "score": 0, "creation_date": 1563423755, "post_id": 57083799, "comment_id": 100696669, "body": "I agree, and also think you have provided a  fine answer."}], "tags": [], "owner": {"reputation": 14827, "user_id": 645886, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2abb0123e9484284a9cb2d36aa9854b3?s=128&d=identicon&r=PG&f=1", "display_name": "Surya", "link": "https://stackoverflow.com/users/645886/surya"}, "is_accepted": false, "score": 1, "last_activity_date": 1563396136, "creation_date": 1563396136, "answer_id": 57083799, "question_id": 57083318, "link": "https://stackoverflow.com/questions/57083318/how-can-i-set-global-variables-that-can-be-accessed-in-controllers-and-models/57083799#57083799", "title": "How can I set &quot;global&quot; variables that can be accessed in controllers and models in Rails", "body": "<p>I would advocate against such hard-coded or DB state-dependent code. If you must do it, here's how one of the ways I know it can be done:</p>\n\n<pre><code># models\nclass ItemType &lt; ActiveRecord::Base\n  has_many :items\n\n  # caches the value after first call\n  def self.with_bar\n    @@with_bar ||= transaction { find_or_create_by(name: \"bar\") }\n  end\n\n  def self.with_bar_id\n    with_bar.id\n  end\nend\n\nclass Item &lt; ActiveRecord::Base\n  belongs_to :item_type\n  belongs_to :foo\n\n  scope :with_bar_types, -&gt; { where(item_type_id: ItemType.with_bar_id) }\nend\n\nclass Foo &lt; ActiveRecord::Base\n  has_many :items  \n\n  # automatically sets the foo_id, no need to mention explicitly\n  # the chained with_bar_types automatically sets the item_type_id to ItemType.with_bar_id\n  def build_item\n    self.items.with_bar_types.new\n  end\nend\n\n# Controller\nclass ItemsController\n  def update\n    @item.update(item_type_id: ItemType.with_bar_id)\n  end\nend\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 23, "user_id": 8412816, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cce4dac3ef68aca5a118d3aa88c2512a?s=128&d=identicon&r=PG&f=1", "display_name": "Danny Trujillo", "link": "https://stackoverflow.com/users/8412816/danny-trujillo"}, "edited": false, "score": 0, "creation_date": 1563397475, "post_id": 57083818, "comment_id": 100691138, "body": "Thank you. I believe this is what I&#39;m looking for. I was unaware you could declare <code>BAR_TYPE</code> on the ItemType model like this."}, {"owner": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "reply_to_user": {"reputation": 23, "user_id": 8412816, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cce4dac3ef68aca5a118d3aa88c2512a?s=128&d=identicon&r=PG&f=1", "display_name": "Danny Trujillo", "link": "https://stackoverflow.com/users/8412816/danny-trujillo"}, "edited": false, "score": 0, "creation_date": 1563423971, "post_id": 57083818, "comment_id": 100696717, "body": "This is valid ruby syntax but not exactly conventional Rails style.  Surya&#39;s answer below is much more conventional Rails way and has some added benefits, where as my example is more of a hack."}], "tags": [], "owner": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "is_accepted": true, "score": 0, "last_activity_date": 1563396229, "creation_date": 1563396229, "answer_id": 57083818, "question_id": 57083318, "link": "https://stackoverflow.com/questions/57083318/how-can-i-set-global-variables-that-can-be-accessed-in-controllers-and-models/57083818#57083818", "title": "How can I set &quot;global&quot; variables that can be accessed in controllers and models in Rails", "body": "<p>If you MUST use a constant, there are a few ways to do it. But you must take into account that you are instantiating an ActiveRecord model object which is dependent on data being present in the database.  This is not recommend, because you now have model and controller logic relying on data being present in the database. This might be ok if you have seeded your database and that it won't change. </p>\n\n<pre><code>class ItemType\n  BAR_TYPE ||= where(:name =&gt; \"bar\").limit(1).first \n\n  has_many :items\nend\n</code></pre>\n\n<p>Now where ever you need this object you can call it like this:</p>\n\n<pre><code>bar_item_type  = ItemType::BAR_TYPE\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 8412816, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cce4dac3ef68aca5a118d3aa88c2512a?s=128&d=identicon&r=PG&f=1", "display_name": "Danny Trujillo", "link": "https://stackoverflow.com/users/8412816/danny-trujillo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 425, "favorite_count": 0, "accepted_answer_id": 57083818, "answer_count": 2, "score": 2, "last_activity_date": 1563396229, "creation_date": 1563393601, "last_edit_date": 1563394375, "question_id": 57083318, "link": "https://stackoverflow.com/questions/57083318/how-can-i-set-global-variables-that-can-be-accessed-in-controllers-and-models", "title": "How can I set &quot;global&quot; variables that can be accessed in controllers and models in Rails", "body": "<p>I have a table that has set entries. I would like to access those entries as variables in both my models and controllers without querying the database every time to set those variables. </p>\n\n<p>I am able to get it to work by creating duplicate \"concerns\" for my models and controllers. I could also set global variables in my ApplicationController. Or i could initialize them in every place that I need them. What would be the correct rails way to set and access global variables that can be accessed in both controllers and models? </p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>class ItemType\n  has_many :items\nend\n\nclass Item\n  belongs_to :item_type\n  belongs_to :foo\nend\n\nclass Foo \n  has_many :items  \n\n  def build_item\n    bar_item_type = ItemType.find_by(:name =&gt; \"bar\")\n\n    self.items.build(\n      :foo_id =&gt; self.id,\n      :item_type_id =&gt; bar_item_type.id\n    )\n  end\nend\n\nclass ItemsController\n  def update\n    bar_item_type = ItemType.find_by(:name =&gt; \"bar\")\n\n    @item.update(:item_type_id =&gt; bar_item_type.id)\n  end\n\nend\n\n</code></pre>\n\n<p>In the example, you can see that I am declaring the <code>bar_item_type</code> variable in both my Foo model and my ItemsController. I would like to DRY up my code base by being able to create and access that variable once for my rails project instead of having to make that same database call everywhere.</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1563391209, "post_id": 57082723, "comment_id": 100688539, "body": "Note: Ruby is a case-sensitive language and capital letters have specific meaning in terms of syntax. Variables and method names should be lower-case letters. Capitals indicate constants of the form  <code>ClassName</code> or <code>CONSTANT_NAME</code>."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 1, "creation_date": 1563391252, "post_id": 57082723, "comment_id": 100688552, "body": "Presumably avoiding the use of Ruby&#39;s <a href=\"https://docs.ruby-lang.org/en/2.6.0/Prime.html\" rel=\"nofollow noreferrer\">Prime</a> module?"}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1563391654, "post_id": 57082723, "comment_id": 100688727, "body": "If you can use <a href=\"https://ruby-doc.org/stdlib-2.6.3/libdoc/prime/rdoc/Prime.html\" rel=\"nofollow noreferrer\">Prime</a> methods it&#39;s just: <code>require &#39;prime&#39;; Prime.prime?(n)</code>, where <code>n</code> is the randomly-selected integer (possibly non-positive)."}, {"owner": {"reputation": 14827, "user_id": 645886, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2abb0123e9484284a9cb2d36aa9854b3?s=128&d=identicon&r=PG&f=1", "display_name": "Surya", "link": "https://stackoverflow.com/users/645886/surya"}, "edited": false, "score": 0, "creation_date": 1563397148, "post_id": 57082723, "comment_id": 100691032, "body": "Hint: Prime numbers are not divisible by any number from 2 to the square root of the number itself. There&#39;s a &quot;math&quot; library in Ruby, which has <code>Math.sqrt(number)</code> to get the square root of a number."}, {"owner": {"reputation": 73209, "user_id": 290394, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/d7908f05c89e965f6bc5308ad6f41256?s=128&d=identicon&r=PG", "display_name": "steenslag", "link": "https://stackoverflow.com/users/290394/steenslag"}, "edited": false, "score": 0, "creation_date": 1563397943, "post_id": 57082723, "comment_id": 100691336, "body": "Negative numbers are not prime (and not natural numbers)."}, {"owner": {"reputation": 73209, "user_id": 290394, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/d7908f05c89e965f6bc5308ad6f41256?s=128&d=identicon&r=PG", "display_name": "steenslag", "link": "https://stackoverflow.com/users/290394/steenslag"}, "reply_to_user": {"reputation": 14827, "user_id": 645886, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2abb0123e9484284a9cb2d36aa9854b3?s=128&d=identicon&r=PG&f=1", "display_name": "Surya", "link": "https://stackoverflow.com/users/645886/surya"}, "edited": false, "score": 0, "creation_date": 1563398490, "post_id": 57082723, "comment_id": 100691519, "body": "@Surya <code>Integer.sqrt(number)</code> was introduced in Ruby 2.5. <a href=\"https://ruby-doc.org/core-2.5.0/Integer.html#method-c-sqrt\" rel=\"nofollow noreferrer\">ruby-doc.org/core-2.5.0/Integer.html#method-c-sqrt</a>"}], "answers": [{"comments": [{"owner": {"reputation": 35, "user_id": 11799289, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c0c3190059f0fe289d1fb19dd9b6988?s=128&d=identicon&r=PG&f=1", "display_name": "Ivo Evans Storrie", "link": "https://stackoverflow.com/users/11799289/ivo-evans-storrie"}, "edited": false, "score": 0, "creation_date": 1563410472, "post_id": 57084089, "comment_id": 100694229, "body": "OK, I ended the loop after the line increasing_divisor += 1 and began a new conditional based on the results of that loop. The method now provides the right results"}, {"owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "reply_to_user": {"reputation": 35, "user_id": 11799289, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c0c3190059f0fe289d1fb19dd9b6988?s=128&d=identicon&r=PG&f=1", "display_name": "Ivo Evans Storrie", "link": "https://stackoverflow.com/users/11799289/ivo-evans-storrie"}, "edited": false, "score": 0, "creation_date": 1563411798, "post_id": 57084089, "comment_id": 100694474, "body": "@IvoEvansStorrie ok. Feel free to accept the answer if the problem is solved."}], "tags": [], "owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "is_accepted": true, "score": 1, "last_activity_date": 1563397743, "creation_date": 1563397743, "answer_id": 57084089, "question_id": 57082723, "link": "https://stackoverflow.com/questions/57082723/method-involving-a-conditional-loop-is-unexpectedly-returning-nil-for-some-value/57084089#57084089", "title": "Method involving a conditional loop is unexpectedly returning nil for some values", "body": "<p>Your issue is that the body of this <code>until</code> loop is not always run:</p>\n\n<pre><code>until num_absolute % increasing_divisor == 0 || almost_num_absolute == increasing_divisor\n</code></pre>\n\n<p>Let's say that I pass a input of <code>3</code>. This is a prime, so this loop will run <em>until</em> <code>almost_num_absolute == increasing_divisor</code>. At which point the <code>until</code> block will finish, and since your fuction doesn't specify any return value <em>after</em> the <code>until</code> block, it will just return nil (which is the 'default' return value for functions).</p>\n\n<p>Now let's say you pass an input of <code>6</code>. The value of <code>increasing_divisor</code> is 2 (the starting value). 6 is divisible by 2. So, because <code>num_absolute % increasing_divisor == 0</code> is true, the body of the <code>until</code> block will never run. Again, no return value is specified after the <code>until</code> block, so the default return value (nil) is used.</p>\n\n<p>A quick fix would be to add this line at the way end of the function (right before the final <code>end</code>):</p>\n\n<pre><code>almost_num_absolute == increasing_divisor\n</code></pre>\n\n<p>Since both primes and non-primes can reach this point in the code, you want to do a final check here. If <code>almost_num_absolute == increasing_divisor</code> is true, then you know there were no divisors found, and therefore the result <em>is</em> a prime</p>\n"}], "owner": {"reputation": 35, "user_id": 11799289, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c0c3190059f0fe289d1fb19dd9b6988?s=128&d=identicon&r=PG&f=1", "display_name": "Ivo Evans Storrie", "link": "https://stackoverflow.com/users/11799289/ivo-evans-storrie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 90, "favorite_count": 0, "accepted_answer_id": 57084089, "answer_count": 1, "score": 1, "last_activity_date": 1563397743, "creation_date": 1563390794, "last_edit_date": 1563391147, "question_id": 57082723, "link": "https://stackoverflow.com/questions/57082723/method-involving-a-conditional-loop-is-unexpectedly-returning-nil-for-some-value", "title": "Method involving a conditional loop is unexpectedly returning nil for some values", "body": "<p>I'm trying to solve a Ruby <a href=\"https://www.codewars.com/kata/is-a-number-prime/train/ruby\" rel=\"nofollow noreferrer\">challenge</a>. The aim is to write a method that returns true if a random integer (including negative integers and 0) inputted as an argument is prime, and false if it is not. My method returns the right results, when it returns results. </p>\n\n<p>I've tested the method for the numbers 1-20. It returned:</p>\n\n<ul>\n<li>true for all 7 primes under 20 except 3, which was nil </li>\n<li>false for 1, 9 and 15 </li>\n<li>nil for everything else</li>\n</ul>\n\n<p>I also tested 43 (true) and 100 and 80 (nil). I also noticed that if I commented out the lines with return, the method returned nil for all arguments between 1 and 20.</p>\n\n<p>Here's the method:</p>\n\n<pre><code>def isPrime(num)\n  num_absolute = num.abs\n  increasing_divisor = 2\n  almost_num_absolute = num_absolute - 1\n\n  if num_absolute &lt;=1\n    return false\n  elsif num_absolute == 2\n    return true\n  else\n    until num_absolute % increasing_divisor == 0 || almost_num_absolute == increasing_divisor\n      increasing_divisor += 1\n      if num_absolute % increasing_divisor == 0\n        return false\n      elsif almost_num_absolute == increasing_divisor\n        return true\n      end\n    end\n  end\nend\n</code></pre>\n"}, {"tags": ["ruby", "sinatra", "socat"], "answers": [{"tags": [], "owner": {"reputation": 126, "user_id": 10435323, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-4PISXGNsZZM/AAAAAAAAAAI/AAAAAAAAAEo/LK4XVO2_MIc/photo.jpg?sz=128", "display_name": "Val Kalinichenko", "link": "https://stackoverflow.com/users/10435323/val-kalinichenko"}, "is_accepted": true, "score": 0, "last_activity_date": 1563599163, "last_edit_date": 1563599163, "creation_date": 1563545079, "answer_id": 57114178, "question_id": 57082583, "link": "https://stackoverflow.com/questions/57082583/how-to-make-sinatra-listen-on-two-ports-with-socat/57114178#57114178", "title": "How to make Sinatra listen on two ports with socat", "body": "<p>The fix was to install socat first:</p>\n\n<pre><code>apt-get update &amp;&amp; apt-get --allow-unauthenticated -y install socat\n</code></pre>\n"}], "owner": {"reputation": 126, "user_id": 10435323, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-4PISXGNsZZM/AAAAAAAAAAI/AAAAAAAAAEo/LK4XVO2_MIc/photo.jpg?sz=128", "display_name": "Val Kalinichenko", "link": "https://stackoverflow.com/users/10435323/val-kalinichenko"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 104, "favorite_count": 0, "accepted_answer_id": 57114178, "answer_count": 1, "score": 0, "last_activity_date": 1563599319, "creation_date": 1563390069, "last_edit_date": 1563599319, "question_id": 57082583, "link": "https://stackoverflow.com/questions/57082583/how-to-make-sinatra-listen-on-two-ports-with-socat", "title": "How to make Sinatra listen on two ports with socat", "body": "<p>I had a classical Sinatra application which was accessible on two ports. After migrating it to modular style the second port is not working anymore.</p>\n\n<p>My initial implementation was:</p>\n\n<pre><code>require 'sinatra'\n\nset :port, 8080\nset :bind, '0.0.0.0'\n\n----some routes-----\n...\n</code></pre>\n\n<p>The resulting implementation was:</p>\n\n<pre><code>require 'sinatra/base'\nrequire_rel 'lib'\n\nclass MyApp &lt; Sinatra::Base\n\n  register Sinatra::SomeRegister\n  helpers Sinatra::SomeHelper\n\nset :port, 8080\nset :bind, '0.0.0.0'\n\n----some routes-----\n...\nrun!\nend\n</code></pre>\n\n<p>The application is run using:</p>\n\n<pre><code>socat tcp-l:8181,fork,reuseaddr tcp:localhost:8080 &amp;\nruby /path/my_app.rb\n</code></pre>\n\n<p>The application doesn't respond on port 8181 anymore.</p>\n"}, {"tags": ["arrays", "ruby", "formatting"], "answers": [{"comments": [{"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1563397143, "post_id": 57082576, "comment_id": 100691031, "body": "When replying to a comment you should include the target&#39;s username (e.g. &quot;@cary, you&#39;re ...&quot;) so that they will be notified of the comment by SO. I suggest you replace &quot;, for instance, should yield the example output&quot; with <code>#=&gt; [&quot;United Kingdom&quot;, &quot;United States (Arkansas, Massachusetts, Alaska)&quot;, &quot;China&quot;]</code> properly formatted. You can delete your comment above. When you&#39;ve done so I&#39;ll delete this one."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "reply_to_user": {"reputation": 109029, "user_id": 2767755, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/BkC8q.jpg?s=128&g=1", "display_name": "Arup Rakshit", "link": "https://stackoverflow.com/users/2767755/arup-rakshit"}, "edited": false, "score": 0, "creation_date": 1563482921, "post_id": 57082576, "comment_id": 100725785, "body": "bsam, I see you haven&#39;t quite got the hang of formatting at SO. When you want to highlight blocks of code indent 4 spaces or align left, select the code and click on <code>{}</code> above the edit box. Surround code with backticks (<code>`</code>) to highlight it when it is within text. Click on &quot;edited X minutes ago&quot; to see the edit history. (My addition of <code>#&lt;p&gt;&lt;&#47;p&gt;</code> is stylistic only.) I suggest formatting so that readers do not have to scroll horizontally to read it.) Hello @Arup. I&#39;ve compared the return value with the content of my comment 3 times and fail to understand your point."}, {"owner": {"reputation": 109029, "user_id": 2767755, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/BkC8q.jpg?s=128&g=1", "display_name": "Arup Rakshit", "link": "https://stackoverflow.com/users/2767755/arup-rakshit"}, "reply_to_user": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1563483363, "post_id": 57082576, "comment_id": 100725959, "body": "@CarySwoveland the output were far right.. so I read it wrong. :)"}], "tags": [], "owner": {"reputation": 598, "user_id": 5149429, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/f289f89bc9452c9f9c7080eabbb1dc10?s=128&d=identicon&r=PG&f=1", "display_name": "bsam", "link": "https://stackoverflow.com/users/5149429/bsam"}, "is_accepted": true, "score": 1, "last_activity_date": 1563481057, "last_edit_date": 1563481057, "creation_date": 1563390033, "answer_id": 57082576, "question_id": 57082445, "link": "https://stackoverflow.com/questions/57082445/how-to-elegantly-combine-and-format-an-ruby-array/57082576#57082576", "title": "How to elegantly combine and format an Ruby array?", "body": "<pre><code>def pretty_format arr\n   arr.each_slice(2).map do |country, states|\n     \"#{country}#{states.length &gt; 0 ? ' (' + states.join(', ') +')': ''}\"\n   end\nend\n</code></pre>\n\n<h1><p></p></h1>\n\n<pre><code>pretty_format [\"United Kingdom\", [], \"United States\",\n  [\"Arkansas\", \"Massachusetts\",\"Alaska\"],\"China\",[]]\n  #=&gt; [\"United Kingdom\", \"United States (Arkansas, Massachusetts, Alaska)\",\n  #    \"China\"]\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 10351089, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-qR_1vtSy7TU/AAAAAAAAAAI/AAAAAAAAAKU/-adJVusbuzI/photo.jpg?sz=128", "display_name": "Roy Xu", "link": "https://stackoverflow.com/users/10351089/roy-xu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 106, "favorite_count": 0, "accepted_answer_id": 57082576, "answer_count": 1, "score": 0, "last_activity_date": 1563481057, "creation_date": 1563389380, "question_id": 57082445, "link": "https://stackoverflow.com/questions/57082445/how-to-elegantly-combine-and-format-an-ruby-array", "title": "How to elegantly combine and format an Ruby array?", "body": "<p>I have an array of countries and lists of states. When I see a state list, I want to combine that with the country just before it with parentheses. </p>\n\n<p>Example array: \n<code>[\"United Kingdom\",[],\"United States\", [\"Arkansas\",\"Massachusetts\",\"Alaska\"],\"China\",[]]</code></p>\n\n<p>I want to format the array into \n<code>[\"United Kingdom\", \"United States (Arkansas, Massachusetts, Alaska)\", \"China\"]</code></p>\n"}, {"tags": ["ruby-on-rails", "ruby", "http"], "answers": [{"comments": [{"owner": {"reputation": 265, "user_id": 5786832, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b790af396e72c6e20b53794a2a4960b0?s=128&d=identicon&r=PG&f=1", "display_name": "Akra", "link": "https://stackoverflow.com/users/5786832/akra"}, "edited": false, "score": 1, "creation_date": 1563391775, "post_id": 57082682, "comment_id": 100688779, "body": "So given I may have several occurences of the same hash format to send (ex 5 hash1&#39;s and one hash2), this means I must send one hash per POST request."}, {"owner": {"reputation": 654, "user_id": 6683147, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69b3599d7eab61ae82354d60a4464703?s=128&d=identicon&r=PG&f=1", "display_name": "Gilg Him", "link": "https://stackoverflow.com/users/6683147/gilg-him"}, "reply_to_user": {"reputation": 265, "user_id": 5786832, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b790af396e72c6e20b53794a2a4960b0?s=128&d=identicon&r=PG&f=1", "display_name": "Akra", "link": "https://stackoverflow.com/users/5786832/akra"}, "edited": false, "score": 0, "creation_date": 1563478273, "post_id": 57082682, "comment_id": 100723953, "body": "No, you could post with multiple values according to the docu too. params could be hashes separated by a commas."}, {"owner": {"reputation": 654, "user_id": 6683147, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69b3599d7eab61ae82354d60a4464703?s=128&d=identicon&r=PG&f=1", "display_name": "Gilg Him", "link": "https://stackoverflow.com/users/6683147/gilg-him"}, "reply_to_user": {"reputation": 265, "user_id": 5786832, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b790af396e72c6e20b53794a2a4960b0?s=128&d=identicon&r=PG&f=1", "display_name": "Akra", "link": "https://stackoverflow.com/users/5786832/akra"}, "edited": false, "score": 1, "creation_date": 1563478616, "post_id": 57082682, "comment_id": 100724093, "body": "Example from the docu: ` res = Net::HTTP.post_form(uri, &#39;q&#39; =&gt; [&#39;ruby&#39;, &#39;perl&#39;], &#39;max&#39; =&gt; &#39;50&#39;)  ` Notice that the params are a hash mapping from String to String or array of strings. So you have two ways, either push the tow hashes to an array, after transforming them to string type and post one param like this <code>post_form(url, &quot;h1&quot; : [hash1.to_s, hash2.to_s])</code>:, or you could assign the two hashes to two different keys and post them as well. post_form(url, &quot;h1&quot; : hash1.to_s, &quot;h2&quot;: hash2.to_s)`"}], "tags": [], "owner": {"reputation": 654, "user_id": 6683147, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69b3599d7eab61ae82354d60a4464703?s=128&d=identicon&r=PG&f=1", "display_name": "Gilg Him", "link": "https://stackoverflow.com/users/6683147/gilg-him"}, "is_accepted": false, "score": 1, "last_activity_date": 1563390567, "creation_date": 1563390567, "answer_id": 57082682, "question_id": 57082423, "link": "https://stackoverflow.com/questions/57082423/send-an-array-of-different-hashes-in-a-single-post-http-request/57082682#57082682", "title": "Send an array of different hashes in a single POST HTTP request", "body": "<p>In the definition of <a href=\"https://ruby-doc.org/stdlib-2.4.1/libdoc/net/http/rdoc/Net/HTTP.html#method-c-post_form\" rel=\"nofollow noreferrer\">post_form(url, params)</a>:</p>\n\n<blockquote>\n  <p><em>The form data must be provided as a Hash mapping from <strong>String</strong> to <strong>String</em></strong></p>\n</blockquote>\n\n<p>In your example, you have an <strong>Array</strong> that contains two hashes. Consider passing the params as Hash.</p>\n"}, {"tags": [], "owner": {"reputation": 265, "user_id": 5786832, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b790af396e72c6e20b53794a2a4960b0?s=128&d=identicon&r=PG&f=1", "display_name": "Akra", "link": "https://stackoverflow.com/users/5786832/akra"}, "is_accepted": true, "score": 1, "last_activity_date": 1567166355, "creation_date": 1567166355, "answer_id": 57726337, "question_id": 57082423, "link": "https://stackoverflow.com/questions/57082423/send-an-array-of-different-hashes-in-a-single-post-http-request/57726337#57726337", "title": "Send an array of different hashes in a single POST HTTP request", "body": "<p>I ended up solving it in two different ways:</p>\n\n<ol>\n<li><p>I used <code>to_json</code> on the array and I set the header <code>Content-Type</code> to be <code>application/json</code>.\nThis allowed instant access to the properly formatted array and hashes in the server side <code>params[:_json]</code>.\nFor example <code>params[:_json][0]['h1_k1']</code> gives <code>h1_v1</code>.</p></li>\n<li><p>I used <code>to_yaml</code> on the array and I set the header <code>Content-Type</code> to <a href=\"https://stackoverflow.com/questions/332129/yaml-mime-type\">any of the YAML options</a>.\nThe params in the backend side were empty as (I guess) Rails couldn't parse it automatically, but using <code>request.raw_post</code> allowed to get the data from the post body.\nThus using <code>Psych.safe_load(request.raw_post)</code> parsed it back into an array of hashes, which allowed the use of the data just like in method 1 (disregarding <code>params</code>).</p></li>\n</ol>\n"}], "owner": {"reputation": 265, "user_id": 5786832, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b790af396e72c6e20b53794a2a4960b0?s=128&d=identicon&r=PG&f=1", "display_name": "Akra", "link": "https://stackoverflow.com/users/5786832/akra"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 422, "favorite_count": 0, "accepted_answer_id": 57726337, "answer_count": 2, "score": 1, "last_activity_date": 1567166355, "creation_date": 1563389283, "question_id": 57082423, "link": "https://stackoverflow.com/questions/57082423/send-an-array-of-different-hashes-in-a-single-post-http-request", "title": "Send an array of different hashes in a single POST HTTP request", "body": "<p>I have two different kinds of hashes:</p>\n\n<pre><code>hash1 = {\"h1_k1\": \"h1_v1\", \"h1_k2\": [\"h1_v2\"]}\nhash2 = {\"h2_k1\": \"h2_v1\", \"h2_k2\": \"h2_v2\"}\n</code></pre>\n\n<p>I may have numerous occurences of each hash with different values, but the following issue occurs even with a single occurence of each:</p>\n\n<p>I want to send the data to a Rails server in an HTTP post request, and the behavior differs when I send it in a single request for the entire data and in one request per hash.</p>\n\n<p>In the controller, <code>params</code> will be the following:</p>\n\n<p>Single request: I push both hashes into an <code>array</code> and <code>Net::HTTP.post_form(uri, array)</code>.</p>\n\n<pre><code>Parameters: {\"{\\\"h1_k1\\\"=&gt;\\\"h1_v1\\\", \\\"h1_k2\"\\\"=&gt;\"=&gt;{\"\\\"h1_v2\"\\\"\"=&gt;{\"}\"=&gt;nil}, {\\\"h2_k1\\\"=&gt;\\\"h2_v1\\\", {\\\"h2_k2\\\"=&gt;\\\"h2_v2\\\"}\"=&gt;nil}\n</code></pre>\n\n<p>One request per hash: <code>array.each {|hash| Net::HTTP.post_form(uri, hash) }</code></p>\n\n<pre><code>Parameters: {\"h1_k1\": \"h1_v1\", \"h1_k2\": \"h1_v2\"} # array converted to string of only the last element\nParameters: {\"h2_k1\": \"h2_v1\", \"h2_k2\": \"h2_v2\"}\n</code></pre>\n\n<p>What is the reason behind this, and is there any way to properly send the data in a single request?</p>\n"}, {"tags": ["ruby", "rspec"], "comments": [{"owner": {"reputation": 1843, "user_id": 4067720, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a52c645614505bcaeb65a6c5199158c1?s=128&d=identicon&r=PG", "display_name": "Glyoko", "link": "https://stackoverflow.com/users/4067720/glyoko"}, "edited": false, "score": 0, "creation_date": 1563388078, "post_id": 57081613, "comment_id": 100687135, "body": "Just a guess here, but what is subject.body? If subject is, say, a controller response object, then subject.body is a string, not a hash. Assuming that, you&#39;d have to use <code>JSON.parse(subject.body)</code> instead"}, {"owner": {"reputation": 10406, "user_id": 53120, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/43ff17d8be7970744478012d4c48a230?s=128&d=identicon&r=PG", "display_name": "justinhj", "link": "https://stackoverflow.com/users/53120/justinhj"}, "reply_to_user": {"reputation": 1843, "user_id": 4067720, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a52c645614505bcaeb65a6c5199158c1?s=128&d=identicon&r=PG", "display_name": "Glyoko", "link": "https://stackoverflow.com/users/4067720/glyoko"}, "edited": false, "score": 0, "creation_date": 1563464432, "post_id": 57081613, "comment_id": 100717646, "body": "I&#39;ve updated the question, it is an array"}, {"owner": {"reputation": 10406, "user_id": 53120, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/43ff17d8be7970744478012d4c48a230?s=128&d=identicon&r=PG", "display_name": "justinhj", "link": "https://stackoverflow.com/users/53120/justinhj"}, "reply_to_user": {"reputation": 1843, "user_id": 4067720, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a52c645614505bcaeb65a6c5199158c1?s=128&d=identicon&r=PG", "display_name": "Glyoko", "link": "https://stackoverflow.com/users/4067720/glyoko"}, "edited": false, "score": 0, "creation_date": 1563631877, "post_id": 57081613, "comment_id": 100767991, "body": "I&#39;m mostly curious why have_attributes doesn&#39;t work in this context"}], "answers": [{"tags": [], "owner": {"reputation": 613, "user_id": 4580814, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/027bad725fb46b84a2499611073a2ff9?s=128&d=identicon&r=PG&f=1", "display_name": "Abass Sesay", "link": "https://stackoverflow.com/users/4580814/abass-sesay"}, "is_accepted": false, "score": 0, "last_activity_date": 1563386441, "creation_date": 1563386441, "answer_id": 57081779, "question_id": 57081613, "link": "https://stackoverflow.com/questions/57081613/how-do-i-write-an-rspec-test-if-an-array-of-hashes-has-a-attribute-value-pair/57081779#57081779", "title": "How do I write an rspec test if an array of hashes has a attribute/value pair", "body": "<p>I would loop through <code>subject.body</code> and write the expectation within the loop\ne.g</p>\n\n<pre><code>subject.body.each do |entry|\n   it { expect(entry[:some_key]).to eq \"some_value\"}\nend\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "is_accepted": false, "score": 1, "last_activity_date": 1563386911, "creation_date": 1563386911, "answer_id": 57081910, "question_id": 57081613, "link": "https://stackoverflow.com/questions/57081613/how-do-i-write-an-rspec-test-if-an-array-of-hashes-has-a-attribute-value-pair/57081910#57081910", "title": "How do I write an rspec test if an array of hashes has a attribute/value pair", "body": "<p>I would probably do something like this:</p>\n\n<pre><code>it do \n  expect(subject.body.map { |elem| elem[:some_key] }).to all( eq \"some_value\" ) }\nend\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 2174, "user_id": 3448554, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/j7RcG.jpg?s=128&g=1", "display_name": "Kelsey Hannan", "link": "https://stackoverflow.com/users/3448554/kelsey-hannan"}, "edited": false, "score": 0, "creation_date": 1613695209, "post_id": 57826175, "comment_id": 117162428, "body": "Is there a way to do this with a hash of multiple key pairs?  I want to match most of the JSON in a response but exclude the dynamic and always unique changing values for the server, for less brittle tests."}], "tags": [], "owner": {"reputation": 10406, "user_id": 53120, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/43ff17d8be7970744478012d4c48a230?s=128&d=identicon&r=PG", "display_name": "justinhj", "link": "https://stackoverflow.com/users/53120/justinhj"}, "is_accepted": true, "score": 2, "last_activity_date": 1567789937, "creation_date": 1567789937, "answer_id": 57826175, "question_id": 57081613, "link": "https://stackoverflow.com/questions/57081613/how-do-i-write-an-rspec-test-if-an-array-of-hashes-has-a-attribute-value-pair/57826175#57826175", "title": "How do I write an rspec test if an array of hashes has a attribute/value pair", "body": "<p>Make a custom matcher as follows:</p>\n\n<pre><code>RSpec::Matchers.define :have_member_with_value do |expected_key, expected_value|\n  match do |actual|\n    actual[expected_key] == expected_value\n  end\nend\n</code></pre>\n\n<p>Usage:</p>\n\n<p><code>it { expect(some_array).to all( have_member_with_value(:some_key, \"some_value\") ) }</code></p>\n\n<p>Sadly I'm not sure why the approach in the question does not work.</p>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 7011367, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7b672441a51dcd3e6e10178ac6d7dd13?s=128&d=identicon&r=PG", "display_name": "Jesse Zhou", "link": "https://stackoverflow.com/users/7011367/jesse-zhou"}, "is_accepted": false, "score": 1, "last_activity_date": 1614225206, "creation_date": 1614225206, "answer_id": 66362160, "question_id": 57081613, "link": "https://stackoverflow.com/questions/57081613/how-do-i-write-an-rspec-test-if-an-array-of-hashes-has-a-attribute-value-pair/66362160#66362160", "title": "How do I write an rspec test if an array of hashes has a attribute/value pair", "body": "<p>I think the assertion does not work because <code>have_attributes</code> does not work with plain ruby hash <em>keys</em>. You can't access hash keys the same as attributes if you're using a vanilla Ruby hash.</p>\n<p>Consider:</p>\n<pre class=\"lang-rb prettyprint-override\"><code>a = OpenStruct.new(hello: 'you')\nb = { hello: 'you' }\n\na.hello # this is an attribute automatically defined via OpenStruct\n=&gt; &quot;you&quot;\n\nb.hello # this is a regular ol' key\nNoMethodError: undefined method `hello' for {:hello=&gt;&quot;you&quot;}:Hash\nfrom (pry):79:in `&lt;main&gt;'\n</code></pre>\n<p>I believe the matcher would work if the object you were working with had the <em>attribute</em> accessor for whatever key-value you were looking for. Ex. If you had an array of OpenStructs, using both <code>match_array</code> and <code>have_attributes</code> would work. These are usually available automatically via metaprogramming if you're using a fancy library like ActiveRecord or OpenStruct.</p>\n<p>Otherwise, you have to define these attributes yourself, or assert on the hash key rather than the attribute.</p>\n"}], "owner": {"reputation": 10406, "user_id": 53120, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/43ff17d8be7970744478012d4c48a230?s=128&d=identicon&r=PG", "display_name": "justinhj", "link": "https://stackoverflow.com/users/53120/justinhj"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 952, "favorite_count": 0, "accepted_answer_id": 57826175, "answer_count": 4, "score": 2, "last_activity_date": 1614225206, "creation_date": 1563385682, "last_edit_date": 1567789887, "question_id": 57081613, "link": "https://stackoverflow.com/questions/57081613/how-do-i-write-an-rspec-test-if-an-array-of-hashes-has-a-attribute-value-pair", "title": "How do I write an rspec test if an array of hashes has a attribute/value pair", "body": "<p>Given an array of hashes I want to check if each one contains a certain key and value. The following did NOT work:</p>\n\n<pre><code>      it { expect(some_array).to all( have_attributes(:some_key =&gt; 'some_value') ) }\n</code></pre>\n\n<p>I could not tell from the match error why it didn't work but I think it's something to do with expectations have_attributes has about the input arguments or environment.</p>\n"}, {"tags": ["ruby", "rspec"], "answers": [{"tags": [], "owner": {"reputation": 21613, "user_id": 580346, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/ba17945a06aac247b06548d5afe341e8?s=128&d=identicon&r=PG", "display_name": "mrzasa", "link": "https://stackoverflow.com/users/580346/mrzasa"}, "is_accepted": true, "score": 3, "last_activity_date": 1563379424, "last_edit_date": 1563379424, "creation_date": 1563379170, "answer_id": 57080024, "question_id": 57079951, "link": "https://stackoverflow.com/questions/57079951/understand-use-in-rpec-test/57080024#57080024", "title": "Understand :[] use in rpec test", "body": "<p><code>:[]</code> is a method that implements indexing operator in your case e.gg <code>options[:module_name]</code>. </p>\n\n<p><a href=\"https://ruby-doc.org/core-2.5.0/Hash.html#method-i-5B-5D\" rel=\"nofollow noreferrer\">See docs</a></p>\n\n<pre><code>[1] pry(main)&gt; h = {a: 1, b: 2}\n=&gt; {:a=&gt;1, :b=&gt;2}\n[2] pry(main)&gt; h[:a]\n=&gt; 1\n[3] pry(main)&gt; h.send(:[], :a)\n=&gt; 1\n[4] pry(main)&gt; \n</code></pre>\n\n<p>If you want to stub it for multiple calls, use multiple expectations:</p>\n\n<pre><code>expect(provider.options).to receive(:[]).with(:module_name).and_return(nil)\nexpect(provider.options).to receive(:[]).with(:runtime).and_return(nil)\n</code></pre>\n\n<p><a href=\"https://makandracards.com/makandra/51337-rspec-expecting-multiple-calls-of-the-same-method\" rel=\"nofollow noreferrer\">https://makandracards.com/makandra/51337-rspec-expecting-multiple-calls-of-the-same-method</a></p>\n"}, {"comments": [{"owner": {"reputation": 2654, "user_id": 2612651, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/e6d40895bc16ece438b2adb4866eaf40?s=128&d=identicon&r=PG", "display_name": "nerdlyist", "link": "https://stackoverflow.com/users/2612651/nerdlyist"}, "edited": false, "score": 0, "creation_date": 1563379607, "post_id": 57080094, "comment_id": 100683229, "body": "So then what that section of respc is saying is call the hash accessory method looking for a key just splitting it out?"}, {"owner": {"reputation": 152277, "user_id": 438992, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/QouOz.jpg?s=128&g=1", "display_name": "Dave Newton", "link": "https://stackoverflow.com/users/438992/dave-newton"}, "reply_to_user": {"reputation": 2654, "user_id": 2612651, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/e6d40895bc16ece438b2adb4866eaf40?s=128&d=identicon&r=PG", "display_name": "nerdlyist", "link": "https://stackoverflow.com/users/2612651/nerdlyist"}, "edited": false, "score": 0, "creation_date": 1563379707, "post_id": 57080094, "comment_id": 100683289, "body": "@nerdlyist I&#39;m not sure what you&#39;re asking. The original test ensures <code>provider.options</code> receives a <code>:[]</code> call with the <code>:module_name</code> symbol as its parameter. Your test wants to ensure it receives multiple <code>:[]</code> calls, once with <code>:module_name</code> and once with <code>:runtime</code>."}, {"owner": {"reputation": 152277, "user_id": 438992, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/QouOz.jpg?s=128&g=1", "display_name": "Dave Newton", "link": "https://stackoverflow.com/users/438992/dave-newton"}, "reply_to_user": {"reputation": 2654, "user_id": 2612651, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/e6d40895bc16ece438b2adb4866eaf40?s=128&d=identicon&r=PG", "display_name": "nerdlyist", "link": "https://stackoverflow.com/users/2612651/nerdlyist"}, "edited": false, "score": 0, "creation_date": 1563379828, "post_id": 57080094, "comment_id": 100683354, "body": "@nerdlyist (With the caveat that I&#39;m not convinced that the testing of internal implementation is a good idea, because ultimately what is being cared about here is the return value of <code>handler</code>.)"}, {"owner": {"reputation": 2654, "user_id": 2612651, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/e6d40895bc16ece438b2adb4866eaf40?s=128&d=identicon&r=PG", "display_name": "nerdlyist", "link": "https://stackoverflow.com/users/2612651/nerdlyist"}, "edited": false, "score": 0, "creation_date": 1563379846, "post_id": 57080094, "comment_id": 100683363, "body": "This answer helped me understand what <code>:[]</code> was doing I did not realize it was the accessor method for the hash class. Googling those characters does not yield good results."}, {"owner": {"reputation": 2654, "user_id": 2612651, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/e6d40895bc16ece438b2adb4866eaf40?s=128&d=identicon&r=PG", "display_name": "nerdlyist", "link": "https://stackoverflow.com/users/2612651/nerdlyist"}, "edited": false, "score": 0, "creation_date": 1563379980, "post_id": 57080094, "comment_id": 100683445, "body": "Also there is further test that get to testing the implementation of handler the expectation is that a handler_name must be present or else nil is returned."}, {"owner": {"reputation": 152277, "user_id": 438992, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/QouOz.jpg?s=128&g=1", "display_name": "Dave Newton", "link": "https://stackoverflow.com/users/438992/dave-newton"}, "reply_to_user": {"reputation": 2654, "user_id": 2612651, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/e6d40895bc16ece438b2adb4866eaf40?s=128&d=identicon&r=PG", "display_name": "nerdlyist", "link": "https://stackoverflow.com/users/2612651/nerdlyist"}, "edited": false, "score": 1, "creation_date": 1563379983, "post_id": 57080094, "comment_id": 100683447, "body": "@nerdlyist When you see <code>to receive</code> it means you&#39;re expecting a method call. The expected method will be a symbol, which is what the <code>:</code> turns things into."}], "tags": [], "owner": {"reputation": 152277, "user_id": 438992, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/QouOz.jpg?s=128&g=1", "display_name": "Dave Newton", "link": "https://stackoverflow.com/users/438992/dave-newton"}, "is_accepted": false, "score": 3, "last_activity_date": 1563379416, "creation_date": 1563379416, "answer_id": 57080094, "question_id": 57079951, "link": "https://stackoverflow.com/questions/57079951/understand-use-in-rpec-test/57080094#57080094", "title": "Understand :[] use in rpec test", "body": "<p><code>:[]</code> here is a hash accessor, it <em>should</em> accept a single argument (the hash key to access). </p>\n\n<p>IMO this test makes no sense.</p>\n\n<p>You should be testing the return value of <code>handler</code>: <em>how</em> <code>handler</code> creates that value is an internal implementation detail. </p>\n\n<p>If you <em>explicitly</em> need to know that it's accessing the correct <code>option</code> entries then test that it accesses <em>both</em> <code>options[:module_name]</code> and <code>options[:runtime]</code>. But this would be tested by checking the return value of <code>handler</code> and proper test setup.</p>\n"}], "owner": {"reputation": 2654, "user_id": 2612651, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/e6d40895bc16ece438b2adb4866eaf40?s=128&d=identicon&r=PG", "display_name": "nerdlyist", "link": "https://stackoverflow.com/users/2612651/nerdlyist"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 38, "favorite_count": 0, "accepted_answer_id": 57080024, "answer_count": 2, "score": 1, "last_activity_date": 1563379534, "creation_date": 1563378913, "last_edit_date": 1563379200, "question_id": 57079951, "link": "https://stackoverflow.com/questions/57079951/understand-use-in-rpec-test", "title": "Understand :[] use in rpec test", "body": "<p>I decided to take a swing at updating some ruby code for an open source project. Its a stretch because my Ruby experience is nil but I am getting there. Issue I am running into is understanding a line in an rspec test.</p>\n\n<p>Section under test is below. Based on what I understand options is a variable on the class or what is passed in by default to ruby methods.</p>\n\n<pre><code>def handler\n    module_name = options[:module_name] || default_module_name\n    handler_name = option(:handler_name)\n\n    \"#{module_name}.#{handler_name}\"\n  end\n</code></pre>\n\n<p>Test was </p>\n\n<pre><code>expect(provider.options).to receive(:[]).with(:module_name).and_return(nil)\n</code></pre>\n\n<p>I am trying to access a <code>:runtime</code> key on a hash so I updated like this:</p>\n\n<pre><code>def handler\n    module_name = options[:module_name] || default_module_name\n    runtime = options[:runtime] || default_runtime\n    handler_name = option(:handler_name)\n\n    \"#{module_name}.#{handler_name}\"\n  end\n</code></pre>\n\n<p>Updated test </p>\n\n<pre><code>expect(provider.options).to receive(:[]).with(:module_name, :runtime).and_return(nil)\n</code></pre>\n\n<p>My interpretation of <code>to receive(:[]).with(:module_name, :runtime)</code> is take an array object / method(?) and put the values <code>:module_name, :runtime</code> in it.</p>\n\n<p>However, this is clearly not correct because the test fails with:</p>\n\n<pre><code>received :[] with unexpected arguments expected: (:module_name, :runtime) got: (:module_name)\n</code></pre>\n\n<p>So what is <code>:[]</code> and how can it be updated to take 2 arguments?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-5"], "answers": [{"comments": [{"owner": {"reputation": 151, "user_id": 7826153, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/TYORr.jpg?s=128&g=1", "display_name": "Hassam Ali", "link": "https://stackoverflow.com/users/7826153/hassam-ali"}, "edited": false, "score": 0, "creation_date": 1563382023, "post_id": 57080673, "comment_id": 100684446, "body": "Its Working , Thankyou and yes my default editor is vim already. This is so basic why this isnt mentioned anywhere in documents or any other platform?"}, {"owner": {"reputation": 2139, "user_id": 208769, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/7678cf457f3bcd08972a960104761cf9?s=128&d=identicon&r=PG", "display_name": "user208769", "link": "https://stackoverflow.com/users/208769/user208769"}, "reply_to_user": {"reputation": 151, "user_id": 7826153, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/TYORr.jpg?s=128&g=1", "display_name": "Hassam Ali", "link": "https://stackoverflow.com/users/7826153/hassam-ali"}, "edited": false, "score": 0, "creation_date": 1563431667, "post_id": 57080673, "comment_id": 100699065, "body": "It does, but it&#39;s a footnote here: <a href=\"https://guides.rubyonrails.org/security.html#custom-credentials\" rel=\"nofollow noreferrer\">guides.rubyonrails.org/security.html#custom-credentials</a> - it&#39;s quite a new feature, and I only found that page thanks to a link on the changelog..."}], "tags": [], "owner": {"reputation": 2139, "user_id": 208769, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/7678cf457f3bcd08972a960104761cf9?s=128&d=identicon&r=PG", "display_name": "user208769", "link": "https://stackoverflow.com/users/208769/user208769"}, "is_accepted": false, "score": 2, "last_activity_date": 1563381703, "creation_date": 1563381703, "answer_id": 57080673, "question_id": 57079827, "link": "https://stackoverflow.com/questions/57079827/how-to-fix-credentials-error-activesupportmessageencryptorinvalidmessage/57080673#57080673", "title": "How to fix credentials error - ActiveSupport::MessageEncryptor::InvalidMessage", "body": "<p>I've not used this feature yet, but it looks like you're adding unencrypted data to an encrypted file.</p>\n\n<p>The correct command is:</p>\n\n<pre><code>EDITOR=vim rails credentials:edit\n</code></pre>\n\n<p>replacing vim with whatever editor you prefer. You'll need to remove your additions to the file first though...</p>\n\n<p>For more info, try <code>rails credentials:help</code></p>\n\n<p>(Source and more info: <a href=\"https://blog.eq8.eu/til/rails-52-credentials-tricks.html\" rel=\"nofollow noreferrer\">https://blog.eq8.eu/til/rails-52-credentials-tricks.html</a>)</p>\n"}], "owner": {"reputation": 151, "user_id": 7826153, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/TYORr.jpg?s=128&g=1", "display_name": "Hassam Ali", "link": "https://stackoverflow.com/users/7826153/hassam-ali"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 114, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1563384900, "creation_date": 1563378554, "last_edit_date": 1563384900, "question_id": 57079827, "link": "https://stackoverflow.com/questions/57079827/how-to-fix-credentials-error-activesupportmessageencryptorinvalidmessage", "title": "How to fix credentials error - ActiveSupport::MessageEncryptor::InvalidMessage", "body": "<p>I am trying to access the credentials in initializers. Before that I am checking in rails console if I can retrieve it, but it gives me the error</p>\n\n<p>I also tried to remove and create new credentials - it creates new credentials and master file, but error remains the same</p>\n\n<p>my code snap</p>\n\n<p><a href=\"https://i.stack.imgur.com/zutCW.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/zutCW.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["ruby", "loops", "dry"], "comments": [{"owner": {"reputation": 613, "user_id": 4580814, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/027bad725fb46b84a2499611073a2ff9?s=128&d=identicon&r=PG&f=1", "display_name": "Abass Sesay", "link": "https://stackoverflow.com/users/4580814/abass-sesay"}, "edited": false, "score": 0, "creation_date": 1563384882, "post_id": 57079630, "comment_id": 100685704, "body": "You can get rid of the if block and just have guard clause that return -1 at the top of the method e.g. <code>return -1 if &lt;some clause&gt;</code>. No need to check the clause after that, you are only left with the while statement"}, {"owner": {"reputation": 9663, "user_id": 5239030, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/76JEw.png?s=128&g=1", "display_name": "iGian", "link": "https://stackoverflow.com/users/5239030/igian"}, "edited": false, "score": 1, "creation_date": 1563386528, "post_id": 57079630, "comment_id": 100686427, "body": "What about <code>(min..max).sum</code>? Yes there is no <code>while</code>..."}], "answers": [{"tags": [], "owner": {"reputation": 2139, "user_id": 208769, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/7678cf457f3bcd08972a960104761cf9?s=128&d=identicon&r=PG", "display_name": "user208769", "link": "https://stackoverflow.com/users/208769/user208769"}, "is_accepted": false, "score": 3, "last_activity_date": 1563434125, "last_edit_date": 1563434125, "creation_date": 1563382584, "answer_id": 57080866, "question_id": 57079630, "link": "https://stackoverflow.com/questions/57079630/how-could-i-dry-this-while-loop/57080866#57080866", "title": "How could I DRY this while loop?", "body": "<p>Welcome to stack overflow!</p>\n\n<p>Firstly, I should point out that \"DRY\" stands for \"Don't Repeat Yourself\". Since there's no repetition here, that's not really the problem with this code.</p>\n\n<p>The biggest issue here is it's unrubyish. The ruby community has certain things it approves of, and certain things it avoids. That said, <code>while</code> loops are themselves considered bad ruby, so if you've been told to write it with a while loop, I'm guessing you're trying to get us to do your homework for you.</p>\n\n<p>So I'm going to give you a couple of things to do a web search for that will help start you off:</p>\n\n<ul>\n<li>ruby guard clauses - this will reduce your <code>if-else-end</code> into a simple <code>if</code></li>\n<li>ruby array pop - you can do <code>while item = array.pop</code> - since pop returns nil once the array is empty, you don't need a count. Again, bad ruby to do this... but maybe consider <code>while array.any?</code></li>\n<li>ruby implicit method return - generally we avoid commands we don't need</li>\n</ul>\n\n<p>It's worth noting that using the techniques above, you can get the content of the method down to 7 reasonably readable lines. If you're allowed to use <code>.inject</code> or <code>.sum</code> instead of <code>while</code>, this whole method becomes 2 lines.</p>\n\n<p>(as <a href=\"https://stackoverflow.com/a/57081215/208769\">HP_hovercraft</a> points out, the ternary operator reduces this down to 1 line. On production code, I'd be tempted to leave it as 2 lines for readability - but that's just personal preference)</p>\n"}, {"comments": [{"owner": {"reputation": 2139, "user_id": 208769, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/7678cf457f3bcd08972a960104761cf9?s=128&d=identicon&r=PG", "display_name": "user208769", "link": "https://stackoverflow.com/users/208769/user208769"}, "edited": false, "score": 0, "creation_date": 1563433122, "post_id": 57081215, "comment_id": 100699687, "body": "Good point. Funny, I always forget you can do <code>[*(min..max)]</code> - not quite as readable as <code>to_a</code>, but a cool addition. That said, both <code>inject</code> and <code>sum</code> will work on Ranges too, so actually arrayifying the range isn&#39;t required, Also, you could replace the whole inject statement with either <code>.inject(&amp;:+)</code> or <code>.sum</code>..."}, {"owner": {"reputation": 238, "user_id": 2440476, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SNFzq.jpg?s=128&g=1", "display_name": "Mishal Zaman", "link": "https://stackoverflow.com/users/2440476/mishal-zaman"}, "reply_to_user": {"reputation": 2139, "user_id": 208769, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/7678cf457f3bcd08972a960104761cf9?s=128&d=identicon&r=PG", "display_name": "user208769", "link": "https://stackoverflow.com/users/208769/user208769"}, "edited": false, "score": 0, "creation_date": 1563467443, "post_id": 57081215, "comment_id": 100719241, "body": "@user208769 You&#39;re right, sum would make this even shorter!"}], "tags": [], "owner": {"reputation": 238, "user_id": 2440476, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SNFzq.jpg?s=128&g=1", "display_name": "Mishal Zaman", "link": "https://stackoverflow.com/users/2440476/mishal-zaman"}, "is_accepted": false, "score": 1, "last_activity_date": 1563384044, "creation_date": 1563384044, "answer_id": 57081215, "question_id": 57079630, "link": "https://stackoverflow.com/questions/57079630/how-could-i-dry-this-while-loop/57081215#57081215", "title": "How could I DRY this while loop?", "body": "<p>You can put the whole thing in one line with a ternary:</p>\n\n<pre><code>def sum_with_while(min, max)\n  min &gt; max ? -1 : [*(min..max)].inject(0){|sum,x| sum + x }\nend\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1563388975, "post_id": 57081907, "comment_id": 100687536, "body": "Refactoring the original code does seem kind of pointless because, as you illustrate, the Ruby solution is extremely small and simple. The original code seems to be tackling the problem from the wrong direction."}, {"owner": {"reputation": 2139, "user_id": 208769, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/7678cf457f3bcd08972a960104761cf9?s=128&d=identicon&r=PG", "display_name": "user208769", "link": "https://stackoverflow.com/users/208769/user208769"}, "edited": false, "score": 0, "creation_date": 1563432604, "post_id": 57081907, "comment_id": 100699459, "body": "Very close to my 7-line solution - except rather than using parallel assignment, I dropped <code>count</code> altogether and used <code>Array#pop</code>. Also, I presumed that maintaining the method signature was important, as was returning -1 should the min, max be the wrong way around..."}], "tags": [], "owner": {"reputation": 9663, "user_id": 5239030, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/76JEw.png?s=128&g=1", "display_name": "iGian", "link": "https://stackoverflow.com/users/5239030/igian"}, "is_accepted": false, "score": 1, "last_activity_date": 1563386905, "creation_date": 1563386905, "answer_id": 57081907, "question_id": 57079630, "link": "https://stackoverflow.com/questions/57079630/how-could-i-dry-this-while-loop/57081907#57081907", "title": "How could I DRY this while loop?", "body": "<p>This is one option, cleaning up your code, see comments:</p>\n\n<pre><code>def sum_with_while(range) # pass a range\n  array = range.to_a\n  sum, count = 0, 0 # parallel assignment\n  while count &lt; array.length\n    sum += array[count]\n    count += 1\n  end\n  sum # no need to return\nend\n\n\nsum_with_while(10..20)\n#=&gt; 165\n</code></pre>\n\n<p><hr>\nMore Rubyish:</p>\n\n<pre><code>(min..max).sum\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 2139, "user_id": 208769, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/7678cf457f3bcd08972a960104761cf9?s=128&d=identicon&r=PG", "display_name": "user208769", "link": "https://stackoverflow.com/users/208769/user208769"}, "edited": false, "score": 1, "creation_date": 1563432002, "post_id": 57083104, "comment_id": 100699217, "body": "Haha... beautifully confusing! I&#39;m guessing this is an absolute beginner, trying to understand what that while loop is[n&#39;t] doing could take them a while ;)"}, {"owner": {"reputation": 238, "user_id": 2440476, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SNFzq.jpg?s=128&g=1", "display_name": "Mishal Zaman", "link": "https://stackoverflow.com/users/2440476/mishal-zaman"}, "edited": false, "score": 0, "creation_date": 1563467366, "post_id": 57083104, "comment_id": 100719209, "body": "Haha, this would be a good question to ask in an interview for junior dev: Remove the redundant lines of code from this function."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1563469650, "post_id": 57083104, "comment_id": 100720265, "body": "@HPHovercraft and other readers: my initial reading was that a <code>while</code> loop was required, but I now see that&#39;s not the case, so I&#39;ve done an edit. &quot;Haha&quot; in the previous comments were a response to me having written <code>while true; return (max-min+1)*(min+max)&#47;2; end</code>."}, {"owner": {"reputation": 2139, "user_id": 208769, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/7678cf457f3bcd08972a960104761cf9?s=128&d=identicon&r=PG", "display_name": "user208769", "link": "https://stackoverflow.com/users/208769/user208769"}, "edited": false, "score": 1, "creation_date": 1563794736, "post_id": 57083104, "comment_id": 100805014, "body": "@CarySwoveland I think you were right first time - I believe this to be OP&#39;s homework, and as per the comment in their code snippet, they have been told that they must use a <code>while</code> loop. So I think that your original answer technically fulfils the bonkers requirement with an equally bonkers implementation - I love it :D"}], "tags": [], "owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "is_accepted": false, "score": 1, "last_activity_date": 1563470429, "last_edit_date": 1563470429, "creation_date": 1563392609, "answer_id": 57083104, "question_id": 57079630, "link": "https://stackoverflow.com/questions/57079630/how-could-i-dry-this-while-loop/57083104#57083104", "title": "How could I DRY this while loop?", "body": "<p><strong>Rule 1: Choose the right algorithm.</strong></p>\n\n<p>You wish to compute an <em>arithmetic series</em>.<sup>1</sup></p>\n\n<pre><code>def sum_with_while(min, max)\n  max &gt;= min ? (max-min+1)*(min+max)/2 : -1   \nend\n</code></pre>\n\n<h1><p></p></h1>\n\n<pre><code>sum_with_while(4, 4)\n  #=&gt; 4 \nsum_with_while(4, 6)\n  #=&gt; 15 \nsum_with_while(101, 9999999999999)\n  #=&gt; 49999999999994999999994950\n</code></pre>\n\n<p><sup>1. An arithmetic series is the sum of the elements of an arithmetic sequence. Each term of the latter is computed from the previous one by adding a fixed constant <code>n</code> (possibly negative). Here<code>max-min+1</code> is the number of terms in the sequence and <code>(min+max)/2</code>, if <code>(min+max)</code> is even, is the average of the values in the sequence. As <code>(max-min+1)*(min+max)</code> is even, this works when <code>(min+max)</code> is odd as well.</sup> </p>\n"}], "owner": {"reputation": 3, "user_id": 11798548, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/--uL0I5ecQAY/AAAAAAAAAAI/AAAAAAAAAII/J79GXi9R4v4/photo.jpg?sz=128", "display_name": "LovlsGenesis", "link": "https://stackoverflow.com/users/11798548/lovlsgenesis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 257, "favorite_count": 0, "answer_count": 4, "score": 0, "last_activity_date": 1563470429, "creation_date": 1563377903, "question_id": 57079630, "link": "https://stackoverflow.com/questions/57079630/how-could-i-dry-this-while-loop", "title": "How could I DRY this while loop?", "body": "<p>I need to DRY this code but I don't know how.</p>\n\n<p>I tried to dry the if condition but I don't know how to put the while in this.</p>\n\n<pre><code>def sum_with_while(min, max)\n  # CONSTRAINT: you should use a while..end structure\n  array = (min..max).to_a\n  sum = 0\n  count = 0\n  if min &gt; max\n    return -1\n  else\n    while count &lt; array.length\n      sum += array[count]\n      count += 1\n    end\n  end\n\n  return sum\nend\n</code></pre>\n"}, {"tags": ["html", "ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 1012, "user_id": 10347572, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iottG.jpg?s=128&g=1", "display_name": "escanxr", "link": "https://stackoverflow.com/users/10347572/escanxr"}, "edited": false, "score": 0, "creation_date": 1563377683, "post_id": 57079053, "comment_id": 100682073, "body": "Please add the form declaration (<code>&lt;%= simple_form_for [\u2026] %&gt;</code>) and the logs after submit, that will be useful to help you"}, {"owner": {"reputation": 3180, "user_id": 4659816, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/5TNaW.jpg?s=128&g=1", "display_name": "David", "link": "https://stackoverflow.com/users/4659816/david"}, "edited": false, "score": 1, "creation_date": 1563377835, "post_id": 57079053, "comment_id": 100682147, "body": "you are using the wrong params on updating the user. I think you meant to use the user_params"}], "answers": [{"tags": [], "owner": {"reputation": 180, "user_id": 1881608, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ef99f58ba5a8d821ac4cb357b4478d0?s=128&d=identicon&r=PG", "display_name": "Praveen", "link": "https://stackoverflow.com/users/1881608/praveen"}, "is_accepted": true, "score": 1, "last_activity_date": 1563377826, "creation_date": 1563377826, "answer_id": 57079613, "question_id": 57079053, "link": "https://stackoverflow.com/questions/57079053/edit-other-user-as-admin-ruby-on-rails/57079613#57079613", "title": "Edit other user as admin, ruby on rails", "body": "<p>Here in the user_controller update action you are calling secure_params def, which is permitting only \"role\" field.</p>\n\n<p>I think you should to use user_params in update action like below</p>\n\n<pre><code>def update\n  @user = User.find(params[:id])\n  if @user.update(user_params)\n    redirect_to users_path, :notice =&gt; \"User updated.\"\n  else\n    redirect_to users_path, :alert =&gt; \"Unable to update user.\"\n  end\nend\n</code></pre>\n\n<p>Or you will have to permit other params also in secure_params def like </p>\n\n<pre><code>def secure_params\n  params.require(:user).permit(:role,:name,:email)\nend\n</code></pre>\n\n<p>Hope it would help you.</p>\n"}], "owner": {"reputation": 3, "user_id": 11350608, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kMyMi.png?s=128&g=1", "display_name": "Clovis Genevard", "link": "https://stackoverflow.com/users/11350608/clovis-genevard"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 54, "favorite_count": 0, "accepted_answer_id": 57079613, "answer_count": 1, "score": -1, "last_activity_date": 1563442626, "creation_date": 1563376145, "last_edit_date": 1563442626, "question_id": 57079053, "link": "https://stackoverflow.com/questions/57079053/edit-other-user-as-admin-ruby-on-rails", "title": "Edit other user as admin, ruby on rails", "body": "<p>I want, that a user with the admin role can edit other users from users/index.html.erb view. I'm not the first one asking this question, but all the given answers lack clear instructions.</p>\n\n<p>So the problem is; after editing the fields, when I click on the 'Updtate' button in users/index.html.erb view, the page is reloaded but no changes appens.</p>\n\n<p>Aditionnal infos: I'm using Devise and Omniauth facebook.</p>\n\n<p>The users are display in the users/index via a partial:</p>\n\n\n\n<pre><code>  &lt;td&gt;\n    &lt;div class=\"field\"&gt;\n      &lt;%= f.text_field :name, class: 'form-control' %&gt;\n    &lt;/div&gt;\n  &lt;/td&gt;\n\n  &lt;td&gt;\n    &lt;div class=\"field\"&gt;\n      &lt;%= f.text_field :email, class: 'form-control' %&gt;\n    &lt;/div&gt;\n  &lt;/td&gt;\n\n  &lt;td&gt;\n    &lt;div class=\"actions\"&gt;\n      &lt;%= f.submit I18n.translate('control.update'), class: 'btn sign-up-button' %&gt;\n    &lt;/div&gt;\n  &lt;/td&gt;\n\n  &lt;td&gt;\n    &lt;!-- display a delete button if the user is not the current_user --&gt;\n    &lt;%= link_to(I18n.translate('control.delete'), user_path(user), :data =&gt; { :confirm =&gt; \"Are you sure?\" }, :method =&gt; :delete, :class =&gt; 'btn') unless user == current_user %&gt;\n  &lt;/td&gt;\n</code></pre>\n\n\n\n<p>users/index.html.erb:</p>\n\n<pre><code>&lt;div class=\"container\"&gt;\n  &lt;div class=\"row\"&gt;\n    &lt;div class=\"col-sm-6 col-sm-offset-3\"&gt;\n\n      &lt;h2 class=\"text-center\"&gt;&lt;%= I18n.translate('user.users_list') %&gt;&lt;/h2&gt;\n      &lt;div class=\"column\"&gt;\n        &lt;table class=\"table\"&gt;\n          &lt;tbody&gt;\n            &lt;% @users.each do |user| %&gt;\n              &lt;tr&gt;\n                &lt;%= render user %&gt;\n              &lt;/tr&gt;\n            &lt;% end %&gt;\n          &lt;/tbody&gt;\n        &lt;/table&gt;\n      &lt;/div&gt;\n\n      &lt;ul class=\u201dpagination\u201d&gt;\n        &lt;li&gt;&lt;%= will_paginate(@users) %&gt;&lt;/li&gt;\n      &lt;/ul&gt;\n\n    &lt;/div&gt;\n  &lt;/div&gt; \n&lt;/div&gt;\n</code></pre>\n\n<p>My user_controller.rb</p>\n\n<pre><code>class UsersController &lt; ApplicationController\n\n  before_action :ensure_admin, :except =&gt; :show\n\n  def index\n    @users = User.paginate(:page =&gt; params[:page], :per_page =&gt; 8)\n  end\n\n  def show\n    @user = User.find_by_name(params[:id])\n  end\n\n  def edit\n    @user = User.find(params[:id])\n  end\n\n  def update\n    @user = User.find(params[:id])\n    if @user.update(secure_params)\n      redirect_to users_path, :notice =&gt; \"User updated.\"\n    else\n      redirect_to users_path, :alert =&gt; \"Unable to update user.\"\n    end\n  end\n\n  def destroy\n    user = User.find(params[:id])\n    user.destroy\n    redirect_to users_path, :notice =&gt; \"User deleted.\"\n  end\n\n  private\n\n  def ensure_admin\n    if(current_user.role == 'admin')\n      return\n    end\n    redirect_to root_path, :alert =&gt; \"Access denied.\"\n  end\n\n  def secure_params\n    params.require(:user).permit(:role)\n  end\n\n  def user_params\n    params.require(:user).permit(:email, :name, :password)\n  end\nend\n</code></pre>\n\n<p>My routes:</p>\n\n<pre><code>Rails.application.routes.draw do\n  root to: 'pages#index'\n\n  get 'users/index'\n\n  #\u00a0you can type '/users' to view the users\n  match '/users', to: 'users#index', via: 'get'\n\n  devise_for :users, :controllers =&gt; { :registrations =&gt; \"registrations\",\n                                      :path_prefix =&gt; 'd',\n                                      :omniauth_callbacks =&gt; \"users/omniauth_callbacks\" }\n\n  resources :users\n\n  scope '/:locale' do\n    devise_scope :user do\n      get 'login', to: 'devise/sessions#new'\n    end\n    devise_scope :user do\n      get 'signup', to: 'devise/registrations#new'\n    end\nend\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "rspec", "capybara", "selector"], "comments": [{"owner": {"reputation": 42014, "user_id": 2709090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/238c2b7cde2c817fc9a5a2b8eaa2ffad?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Walpole", "link": "https://stackoverflow.com/users/2709090/thomas-walpole"}, "edited": false, "score": 0, "creation_date": 1563385786, "post_id": 57078120, "comment_id": 100686112, "body": "Can you clarify exactly what you&#39;re trying to get.  The &#39;NAME2 NAME3 NAME4 NAME5&#39; are not inside elements with the class <code>.text-right</code> so your statement that the element has those strings doesn&#39;t make sense. Also, by default Capybara will only find visible elements so checking <code>visible?</code> also doesn&#39;t make sense (<code>visible?</code> also only returns true or false so just calling it doesn&#39;t actually verify anything)"}], "answers": [{"tags": [], "owner": {"reputation": 2000, "user_id": 952740, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d758ce8171d8e74b9c5f5a2e701f1b9b?s=128&d=identicon&r=PG", "display_name": "Nick M", "link": "https://stackoverflow.com/users/952740/nick-m"}, "is_accepted": true, "score": 0, "last_activity_date": 1563374598, "creation_date": 1563374598, "answer_id": 57078566, "question_id": 57078120, "link": "https://stackoverflow.com/questions/57078120/selecting-elements-and-its-parent-with-all-strings-that-it-got/57078566#57078566", "title": "Selecting elements and its parent, with all Strings that it got", "body": "<p>I'd suggest adding an ID to the row, for instance:</p>\n\n<pre><code>&lt;tr id=\"thing-&lt;%= thing.id %&gt;\"&gt;\n</code></pre>\n\n<p>So that you can later do:</p>\n\n<pre><code>within(\"tr#thing-#{thing.id}\") do\n  expect(page).to have_content thing.name # or whatever you want to look for\nend\n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 11441800, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-HoX6ojngBPc/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rc5CnU_ViHex3nF6_4ffYBSn4nNjw/mo/photo.jpg?sz=128", "display_name": "maksim korshikov", "link": "https://stackoverflow.com/users/11441800/maksim-korshikov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 39, "favorite_count": 0, "accepted_answer_id": 57078566, "answer_count": 1, "score": 1, "last_activity_date": 1563374598, "creation_date": 1563373275, "last_edit_date": 1563373380, "question_id": 57078120, "link": "https://stackoverflow.com/questions/57078120/selecting-elements-and-its-parent-with-all-strings-that-it-got", "title": "Selecting elements and its parent, with all Strings that it got", "body": "<p>I using Capybara for writing acceptance tests. And I want to make sure that my element is visible on a page. How i can select element and with all Strings that it got?   </p>\n\n<p>A page looks like this </p>\n\n<pre><code>&lt;tr&gt;\n              &lt;td class=\"pl-4\"&gt;ABC&lt;/td&gt;\n              &lt;td class=\"text\"&gt;5000$&lt;/td&gt;\n              &lt;td&gt;\n                &lt;span class=\"spanclass\"&gt;\n                  SpanClassExample\n                &lt;/span&gt;\n\n                  &lt;br&gt;\n                  &lt;a class=\"badge badge-secondary\" href=\"//.../\"&gt;CLASS&lt;/a&gt;\n              &lt;/td&gt;\n              &lt;td class=\"text-right\"&gt;NAME1&lt;/td&gt;\n              &lt;td&gt;NAME2&lt;/td&gt;\n              &lt;td&gt;NAME3&lt;/td&gt;\n              &lt;td&gt;NAME4&lt;/td&gt;\n              &lt;td&gt;NAME5&lt;/td&gt;\n&lt;/tr&gt;\n</code></pre>\n\n<p>For now I use this method</p>\n\n<blockquote>\n  <p>page.all(\".text-right\", text: 'NAME1')[0].visible?</p>\n</blockquote>\n\n<p>But I need to find element with all strings that it got </p>\n\n<blockquote>\n  <p>NAME1\n                NAME2\n                NAME3\n                NAME4\n                NAME5).</p>\n</blockquote>\n\n<p>And also this element</p>\n\n<blockquote>\n  <p>(span class=\"spanclass\" SpanClassExample /span>)</p>\n</blockquote>\n"}, {"tags": ["ruby", "ruby-on-rails-4", "woocommerce", "wordpress-rest-api", "woocommerce-rest-api"], "comments": [{"owner": {"reputation": 123770, "user_id": 2830850, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e48b39b77bf324de9aeefd6c5bfc10c6?s=128&d=identicon&r=PG&f=1", "display_name": "Tarun Lalwani", "link": "https://stackoverflow.com/users/2830850/tarun-lalwani"}, "edited": false, "score": 1, "creation_date": 1563636404, "post_id": 57077492, "comment_id": 100769048, "body": "First try the request using curl instead of code, it may be server misconfiguration as well"}, {"owner": {"reputation": 2198, "user_id": 3842598, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/468955b0edcf30e61a2937cb8b754a1a?s=128&d=identicon&r=PG&f=1", "display_name": "Christian", "link": "https://stackoverflow.com/users/3842598/christian"}, "edited": false, "score": 0, "creation_date": 1564006011, "post_id": 57077492, "comment_id": 100893174, "body": "I have updated my answer below after some research."}, {"owner": {"reputation": 2198, "user_id": 3842598, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/468955b0edcf30e61a2937cb8b754a1a?s=128&d=identicon&r=PG&f=1", "display_name": "Christian", "link": "https://stackoverflow.com/users/3842598/christian"}, "edited": false, "score": 0, "creation_date": 1564528465, "post_id": 57077492, "comment_id": 101058524, "body": "Have you tried using the coupon key within data? Could you solve it?"}], "answers": [{"comments": [{"owner": {"reputation": 172, "user_id": 1893604, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/b4b551e2494b42e80aaacb6f573b0bd2?s=128&d=identicon&r=PG", "display_name": "Aaron Mills", "link": "https://stackoverflow.com/users/1893604/aaron-mills"}, "edited": false, "score": 0, "creation_date": 1564583824, "post_id": 57154773, "comment_id": 101080896, "body": "Thanks for your response trying this today"}], "tags": [], "owner": {"reputation": 2198, "user_id": 3842598, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/468955b0edcf30e61a2937cb8b754a1a?s=128&d=identicon&r=PG&f=1", "display_name": "Christian", "link": "https://stackoverflow.com/users/3842598/christian"}, "is_accepted": true, "score": 5, "last_activity_date": 1612060207, "last_edit_date": 1612060207, "creation_date": 1563836810, "answer_id": 57154773, "question_id": 57077492, "link": "https://stackoverflow.com/questions/57077492/creating-coupon-through-api-and-ruby-returns-error-woocommerce-api-missing-coup/57154773#57154773", "title": "Creating coupon through API and ruby returns error: woocommerce_api_missing_coupon_data", "body": "<p>The paragraph below shows how it was working, at least in API V2 and V3.</p>\n<p>The params / data hash contained a coupon attribute, see <a href=\"https://woocommerce.github.io/woocommerce-rest-api-docs/v3.html#create-a-coupon\" rel=\"nofollow noreferrer\">v3 documentation</a>:</p>\n<pre><code>data = {\n  coupon: {\n    code: &quot;new-coupon&quot;\n    ...\n  }\n}\n</code></pre>\n<p>After some research, I am still not sure that the example in the API description is right, as you can see <a href=\"https://github.com/woocommerce/woocommerce/blob/c63cd802aa149f8f91b33e287aa8d67eb50eab12/includes/legacy/api/v3/class-wc-api-coupons.php#L208\" rel=\"nofollow noreferrer\">here</a>.</p>\n<p>The code below is available for V2 and V3 and there is no other code available, V3 was updated 13 days ago. The error is raised when 'coupon' is not available in data:</p>\n<pre><code>if ( ! isset( $data['coupon'] ) ) {\n throw new WC_API_Exception( 'woocommerce_api_missing_coupon_data', sprintf( __( 'No %1$s data specified to create %1$s', 'woocommerce' ), 'coupon' ), 400 );\n}\n</code></pre>\n<p>I suggest trying with this code:</p>\n<pre><code>data = {\n  coupon: {\n      code: &quot;10off&quot;,\n      discount_type: &quot;percent&quot;,\n      amount: &quot;10&quot;,\n      individual_use: true,\n      exclude_sale_items: true,\n      minimum_amount: &quot;100.00&quot;\n  }\n}\nwoocommerce.post(&quot;coupons&quot;, data).parsed_response\n</code></pre>\n<p>If this works I would stick to the <a href=\"https://woocommerce.github.io/woocommerce-rest-api-docs/v3?ruby#create-a-coupon\" rel=\"nofollow noreferrer\">V3 documentation</a> for the time being or raise an issue e.g. by creating a ticket with Woocommerce. Maybe their documentation team worked faster than development :)</p>\n"}], "owner": {"reputation": 172, "user_id": 1893604, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/b4b551e2494b42e80aaacb6f573b0bd2?s=128&d=identicon&r=PG", "display_name": "Aaron Mills", "link": "https://stackoverflow.com/users/1893604/aaron-mills"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 195, "favorite_count": 0, "accepted_answer_id": 57154773, "answer_count": 1, "score": 8, "last_activity_date": 1612060207, "creation_date": 1563371356, "last_edit_date": 1563732329, "question_id": 57077492, "link": "https://stackoverflow.com/questions/57077492/creating-coupon-through-api-and-ruby-returns-error-woocommerce-api-missing-coup", "title": "Creating coupon through API and ruby returns error: woocommerce_api_missing_coupon_data", "body": "<p>I am trying to create a coupon though the rest api from my rails 4 app using the sample code from the documentation on this page: <a href=\"https://woocommerce.github.io/woocommerce-rest-api-docs/?ruby#create-a-coupon\" rel=\"noreferrer\">https://woocommerce.github.io/woocommerce-rest-api-docs/?ruby#create-a-coupon</a></p>\n\n<p>Here is the code I am using:</p>\n\n<pre><code> data = {\n      code: \"10off\",\n      discount_type: \"percent\",\n      amount: \"10\",\n      individual_use: true,\n      exclude_sale_items: true,\n      minimum_amount: \"100.00\"\n    }\nwoocommerce.post(\"coupons\", data).parsed_response\n</code></pre>\n\n<p>I expect it to return a successful response from the API instead I get <code>{\"errors\"=&gt;[{\"code\"=&gt;\"woocommerce_api_missing_coupon_data\", \"message\"=&gt;\"No coupon data specified to create coupon\"}]}</code></p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 4688, "user_id": 6241184, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/1022848011119215/picture?type=large", "display_name": "Vinicius Brasil", "link": "https://stackoverflow.com/users/6241184/vinicius-brasil"}, "edited": false, "score": 0, "creation_date": 1563367627, "post_id": 57076154, "comment_id": 100675538, "body": "What does <code>rails routes</code> return?"}], "answers": [{"comments": [{"owner": {"reputation": 255, "user_id": 4833080, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/396ff0ca536f8ccb84116a5e99887214?s=128&d=identicon&r=PG&f=1", "display_name": "BillyBib", "link": "https://stackoverflow.com/users/4833080/billybib"}, "edited": false, "score": 0, "creation_date": 1563369845, "post_id": 57076420, "comment_id": 100677110, "body": "Scoped it as per your edit, and it works great. Thanks."}], "tags": [], "owner": {"reputation": 703, "user_id": 3275627, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sFsXG.jpg?s=128&g=1", "display_name": "Jonathan Duarte", "link": "https://stackoverflow.com/users/3275627/jonathan-duarte"}, "is_accepted": true, "score": 2, "last_activity_date": 1563368789, "last_edit_date": 1563368789, "creation_date": 1563368294, "answer_id": 57076420, "question_id": 57076154, "link": "https://stackoverflow.com/questions/57076154/prefixing-a-symbol-to-username-in-url-in-rails/57076420#57076420", "title": "Prefixing a symbol to username in URL in Rails", "body": "<p>Just prefix the route with the <code>@</code> symbol and follow it with the variable name you want to capture, for instance:</p>\n\n<pre><code># config/routes.rb\nget '@:user_id' =&gt; 'users#show'\n</code></pre>\n\n<p>and then in your controller, just refer to the variable name like so:</p>\n\n<pre><code># app/controllers/users_controller.rb\nclass UsersController &lt; ApplicationController\n  def show\n    render json: { user_id: params[:user_id] }.to_json\n  end\nend\n</code></pre>\n\n<p>This is what you'll get:</p>\n\n<pre><code>// http://localhost:3000/@joe\n\n{\n  \"user_id\": \"joe\"\n}\n</code></pre>\n\n<p><strong>EDIT</strong>: If you want to scope pages for that particular <code>@user</code> you can do as well, using the same technique:</p>\n\n<pre><code>  # config/routes.rb\n\n  scope '@:user_id' do\n    get 'scoped', to: 'users#scoped'\n  end\n</code></pre>\n\n<pre><code>http://localhost:3000/@joe/scoped\n</code></pre>\n"}], "owner": {"reputation": 255, "user_id": 4833080, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/396ff0ca536f8ccb84116a5e99887214?s=128&d=identicon&r=PG&f=1", "display_name": "BillyBib", "link": "https://stackoverflow.com/users/4833080/billybib"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 67, "favorite_count": 0, "accepted_answer_id": 57076420, "answer_count": 1, "score": 0, "last_activity_date": 1563368789, "creation_date": 1563367435, "question_id": 57076154, "link": "https://stackoverflow.com/questions/57076154/prefixing-a-symbol-to-username-in-url-in-rails", "title": "Prefixing a symbol to username in URL in Rails", "body": "<p>I'm implementing a username system in my app, and I'm trying to make the URLs pretty. I'd rather not have anything like:</p>\n\n<p><strong>myapp.com/users/joebloggs</strong></p>\n\n<p><strong>myapp.com/u/joebloggs</strong></p>\n\n<p>but rather</p>\n\n<p><strong>myapp.com/joebloggs</strong></p>\n\n<p>If I want the pretty version I'm going to have to whitelist a whole load of paths, which I'd rather not do. I noticed that Medium.com and producthunt.com do the following to solve this:</p>\n\n<p><strong>myapp.com/@joebloggs</strong></p>\n\n<p>How do I go about creating the same in a Rails 6 app where the @ symbol is prefixed to the username? Pretty sure I have to namespace the routes, but unsure how to implement it exactly. I thought something like the following might work, but it doesn't.</p>\n\n<pre><code>namespace :user, path: \"@:username\" do\n  resources :posts\nend\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "rvm", "passenger"], "answers": [{"comments": [{"owner": {"reputation": 1529, "user_id": 1526010, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64c115d3a69fa581e1e81beca6bbab69?s=128&d=identicon&r=PG", "display_name": "244an", "link": "https://stackoverflow.com/users/1526010/244an"}, "edited": false, "score": 0, "creation_date": 1583761929, "post_id": 57074603, "comment_id": 107214635, "body": "Thanks a lot! The funny thing is that on an old server it was just showing the error message but started Passenger anyway. It&#39;s the same app on the new server with the same Ruby/Rails version, and same versions of all gems, the only difference is that the new sever have Ubuntu 18.04, the old have 12.04. Strange. I changed in Gemfile to <code>passenger &#39;~&gt; 6.0.4&#39;</code>, with Rails 4.2.2. Works on both the old and new server."}], "tags": [], "owner": {"reputation": 447, "user_id": 599968, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/ae53d01012948ed0b96f3c81bb16d35e?s=128&d=identicon&r=PG", "display_name": "kaczor1984", "link": "https://stackoverflow.com/users/599968/kaczor1984"}, "is_accepted": true, "score": 2, "last_activity_date": 1563362197, "creation_date": 1563362197, "answer_id": 57074603, "question_id": 57073860, "link": "https://stackoverflow.com/questions/57073860/rvm-ruby-update-unable-to-autodetect-the-currently-active-rvm-gem-set-name/57074603#57074603", "title": "RVM - Ruby update - Unable to autodetect the currently active RVM gem set name", "body": "<p>It looks like updating passenger to newer version did help (it updated to 6.0.2).</p>\n"}], "owner": {"reputation": 447, "user_id": 599968, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/ae53d01012948ed0b96f3c81bb16d35e?s=128&d=identicon&r=PG", "display_name": "kaczor1984", "link": "https://stackoverflow.com/users/599968/kaczor1984"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 467, "favorite_count": 0, "accepted_answer_id": 57074603, "answer_count": 1, "score": 1, "last_activity_date": 1563362197, "creation_date": 1563359654, "last_edit_date": 1563361553, "question_id": 57073860, "link": "https://stackoverflow.com/questions/57073860/rvm-ruby-update-unable-to-autodetect-the-currently-active-rvm-gem-set-name", "title": "RVM - Ruby update - Unable to autodetect the currently active RVM gem set name", "body": "<p>I'm trying to update the ruby version on one of my servers. I've updated the RVM and installed the new Ruby but I have a problem with passenger (standalone).</p>\n\n<p>As far as I can see it was installed as a gem from Gemfile before (Ruby 2.2.5).</p>\n\n<pre><code>bundle exec gem list passenger\n*** LOCAL GEMS ***\npassenger (5.0.30)\n</code></pre>\n\n<p>And it is still installed as a gem from Gemfile (in Ruby 2.6.3):</p>\n\n<pre><code>bundle exec gem list passenger\n*** LOCAL GEMS ***\npassenger (5.0.30)\n</code></pre>\n\n<p>Ruby in my rvm is set as default <code>rvm --default use 2.6.3</code></p>\n\n<p>I'm not using any gemset names (there is the default one @global). </p>\n\n<p>When I try to deploy the application with this config i ran into error when the capistrano is trying to stop the passenger:</p>\n\n<pre><code>00:34 deploy:restart\n  01 ~/.rvm/bin/rvm 2.6.3@global do bundle exec passenger stop\n  01 Unable to autodetect the currently active RVM gem set name. This could happen if you ran this program using 'sudo' instead of 'rvmsudo'. When using RVM, you're always supposed to use 'rvmsudo' instead of 'sudo!'.\n  01\n  01 Please try rerunning this program using 'rvmsudo'. If that doesn't help, please contact this program's author for support.\n</code></pre>\n\n<p>But as you can see I did not use any sudo or rvmsudo...</p>\n\n<p>When I enter the server and try to restart the passenger manually I get the same error:</p>\n\n<pre><code>bundle exec passenger stop --help --verbose\nUnable to autodetect the currently active RVM gem set name. This could happen if you ran this program using 'sudo' instead of 'rvmsudo'. When using RVM, you're always supposed to use 'rvmsudo' instead of 'sudo!'.\n\nPlease try rerunning this program using 'rvmsudo'. If that doesn't help, please contact this program's author for support.\n</code></pre>\n\n<p>Any idea how can I 'make it work' ?</p>\n"}, {"tags": ["ruby", "jira-rest-api"], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 10959813, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6a1de715c0919cff7ca4bff3176dd0d?s=128&d=identicon&r=PG&f=1", "display_name": "Sagar K", "link": "https://stackoverflow.com/users/10959813/sagar-k"}, "edited": false, "score": 0, "creation_date": 1563422929, "post_id": 57073905, "comment_id": 100696503, "body": "Thank you so much for your response, I will try this first."}], "tags": [], "owner": {"reputation": 344, "user_id": 4045620, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/78df2713ecd256952ddcc8df0b43a213?s=128&d=identicon&r=PG&f=1", "display_name": "A. M.", "link": "https://stackoverflow.com/users/4045620/a-m"}, "is_accepted": false, "score": 0, "last_activity_date": 1563359809, "creation_date": 1563359809, "answer_id": 57073905, "question_id": 57073806, "link": "https://stackoverflow.com/questions/57073806/get-all-the-jira-information-by-hitting-api-using-ruby/57073905#57073905", "title": "Get all the jira information by hitting api using ruby", "body": "<p>You didn't specify is you were using Jira Cloud or Jira on-prem.</p>\n\n<p>If you are using the Cloud version, you can use <a href=\"https://confluence.atlassian.com/cloud/api-tokens-938839638.html\" rel=\"nofollow noreferrer\">API tokens</a></p>\n\n<p>If you are using the <a href=\"https://developer.atlassian.com/server/jira/platform/security-overview/\" rel=\"nofollow noreferrer\">on-prem solution</a>, you can use OAuth, or cookies besides basic auth.</p>\n"}, {"tags": [], "owner": {"reputation": 6321, "user_id": 263858, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/ZKsgT.jpg?s=128&g=1", "display_name": "New Alexandria", "link": "https://stackoverflow.com/users/263858/new-alexandria"}, "is_accepted": false, "score": 0, "last_activity_date": 1563372836, "last_edit_date": 1563372836, "creation_date": 1563372172, "answer_id": 57077759, "question_id": 57073806, "link": "https://stackoverflow.com/questions/57073806/get-all-the-jira-information-by-hitting-api-using-ruby/57077759#57077759", "title": "Get all the jira information by hitting api using ruby", "body": "<p>There are two ways to connect to a Jira instance (3 if you count your personal login/password).</p>\n\n<ol>\n<li>Using an account-based API key</li>\n<li>Using a <a href=\"https://confluence.atlassian.com/applinks/oauth-troubleshooting-guide-790632058.html#OAuthtroubleshootingguide-OAuthunknownkey\" rel=\"nofollow noreferrer\">server-generic oauth application key</a></li>\n</ol>\n\n<p>Think of the long-term use case before deciding which one.</p>\n\n<h2>Account based API</h2>\n\n<p>The account based API key is connected with your account (whichever is used to make it).  This means it will have your account's permissions, including however ever they will change.  That could lead to unexpected behavior from the integrated apps, if your perms change without planning / coordination.  </p>\n\n<p>Also, this can be ideal, as the accounts API key is then a 'flexible permissions window' into the Jira server.  It's a good solution if you may want later to change what can go out over the query.  Maybe you want to make a few such accounts with different perms, so that the app can dynamically query data without seeing too much, ever.</p>\n\n<p>Also, you can create these account-based API keys without involving your server's admin. They're just another thing a user can do.</p>\n\n<h3>Where to find it</h3>\n\n<p><a href=\"https://i.stack.imgur.com/rjQ7g.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/rjQ7g.png\" alt=\"URL where to find personal API keys\"></a></p>\n\n<h3>A Revokable Password</h3>\n\n<p><a href=\"https://i.stack.imgur.com/TPadY.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/TPadY.png\" alt=\"revokable password\"></a></p>\n\n<h2>Server generic Oauth</h2>\n\n<p>This kind of connection will always have unfettered access to the Jira instance's data.  This is a master key, and it's permissions can never be reduced.</p>\n\n<p>Oauth keys need to be setup by a Jira <code>site admin</code>, since they bypass all other permissions levels.  They are suitable for do BI data links, which it sounds like that's what you're doing here.  They're more effort to setup, but more predictable long-term.  There's no mistake that the can be delete or changed by any of the admin actions that can impact user accounts. </p>\n"}], "owner": {"reputation": 11, "user_id": 10959813, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6a1de715c0919cff7ca4bff3176dd0d?s=128&d=identicon&r=PG&f=1", "display_name": "Sagar K", "link": "https://stackoverflow.com/users/10959813/sagar-k"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 76, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1563372836, "creation_date": 1563359445, "last_edit_date": 1563359849, "question_id": 57073806, "link": "https://stackoverflow.com/questions/57073806/get-all-the-jira-information-by-hitting-api-using-ruby", "title": "Get all the jira information by hitting api using ruby", "body": "<p>I need to get all the information from a particular <strong>Jira</strong> using rest api in <strong>ruby</strong>, </p>\n\n<p>I have tried using my credentials and my companies Jira URL, it's working fine but I want to do this without my credentials, I don't have much idea about it, using some access token some said it can be done, but I don't know how!</p>\n\n<pre><code>require 'rubygems'\nrequire 'pp'\nrequire 'jira-ruby'\n\noptions = {\n username: '',\n password: '', \n site: '',\n context_path: '',\n auth_type: :basic,\n use_ssl: true\n}\n\nclient = JIRA::Client.new(options)\nprojects = client.Project.all\n\n# Show all projects\n# issues = client.Project.find('ion_authn_engine').issues\n\nprojects.each do |project|\n puts \"name: #{project.name}\"\nend\n</code></pre>\n\n<p>I'm getting all the jira's but I have to use my credentials here, can it be done in other ways.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "watir"], "comments": [{"owner": {"reputation": 5134, "user_id": 1672197, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i8HkV.png?s=128&g=1", "display_name": "orde", "link": "https://stackoverflow.com/users/1672197/orde"}, "edited": false, "score": 1, "creation_date": 1563378695, "post_id": 57073576, "comment_id": 100682673, "body": "The targeted element is being AJAX&#39;d in.  If you add an arbitrary <code>sleep 5</code> statement/hack after the call to <code>goto</code>, the <code>exists?</code> call will return <code>true</code>.  You need to poll/wait for the element.  For reference: <a href=\"http://watir.com/guides/waiting/\" rel=\"nofollow noreferrer\">watir.com/guides/waiting</a>"}], "answers": [{"comments": [{"owner": {"reputation": 225, "user_id": 11330290, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/15iKq.jpg?s=128&g=1", "display_name": "benj-p", "link": "https://stackoverflow.com/users/11330290/benj-p"}, "edited": false, "score": 0, "creation_date": 1563443815, "post_id": 57073979, "comment_id": 100705390, "body": "Thanks for your help, it turns out that this had something to do with your second point - <code>.exists?</code> will not wait for the element to exist before taking action so that&#39;s why it can return something different if called multiple times."}], "tags": [], "owner": {"reputation": 4797, "user_id": 177154, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f719bc9e36272f09feca03728b4a160c?s=128&d=identicon&r=PG", "display_name": "draganstankovic", "link": "https://stackoverflow.com/users/177154/draganstankovic"}, "is_accepted": false, "score": 1, "last_activity_date": 1563360027, "creation_date": 1563360027, "answer_id": 57073979, "question_id": 57073576, "link": "https://stackoverflow.com/questions/57073576/watir-element-exists-but-exists-returns-false/57073979#57073979", "title": "Watir: element exists but .exists? returns false", "body": "<p>I would guess that this is due to either:</p>\n\n<p>1) a bug in <code>exists?</code> (not sure which version you are using) but quickly found this: <a href=\"https://github.com/watir/watir/commit/e036ffaa5d63e8c54c56c630ab7cba2f0bdce463\" rel=\"nofollow noreferrer\">https://github.com/watir/watir/commit/e036ffaa5d63e8c54c56c630ab7cba2f0bdce463</a></p>\n\n<p>2) or some nuances outlined here: <a href=\"http://watir.com/staleness-changes/\" rel=\"nofollow noreferrer\">http://watir.com/staleness-changes/</a> (perhaps your code triggers this 'weird' behavior:</p>\n\n<pre><code>it 'returns different responses when called more than once' do\n  browser.goto(WatirSpec.url_for('forms_with_input_elements.html'))\n  element = browser.text_field(id: 'new_user_email').tap(&amp;:exists?)\n\n  browser.refresh       # all elements become stale\n\n  expect(element.present?).to be false\n  expect(element.present?).to eq true\nend\n</code></pre>\n\n<p>Either way, the best way to find out what is really going on is to go to the source of your gem (wherever it is installed on your machine) and patch (edit) the method and see yourself what is going on.</p>\n"}, {"comments": [{"owner": {"reputation": 225, "user_id": 11330290, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/15iKq.jpg?s=128&g=1", "display_name": "benj-p", "link": "https://stackoverflow.com/users/11330290/benj-p"}, "edited": false, "score": 0, "creation_date": 1563443710, "post_id": 57079902, "comment_id": 100705320, "body": "Thanks a ton! I thought that <code>.exists?</code> would also wait for the element to exist, but now it makes sense."}], "tags": [], "owner": {"reputation": 44680, "user_id": 1200545, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbbfea5f6583c16f96fc11ef821cfeee?s=128&d=identicon&r=PG&f=1", "display_name": "Justin Ko", "link": "https://stackoverflow.com/users/1200545/justin-ko"}, "is_accepted": true, "score": 1, "last_activity_date": 1563378782, "creation_date": 1563378782, "answer_id": 57079902, "question_id": 57073576, "link": "https://stackoverflow.com/questions/57073576/watir-element-exists-but-exists-returns-false/57079902#57079902", "title": "Watir: element exists but .exists? returns false", "body": "<p>This is due to the product list being loaded asynchronously. As a result, you will see that <code>#exists?</code> has a different result based on when you run it:</p>\n\n<ul>\n<li>If you check right after visiting the page, while the spinner is still visible, <code>#exists?</code> will be <code>false</code>.</li>\n<li>If you wait for the product list to load, <code>#exists?</code> will be <code>true</code>.</li>\n</ul>\n\n<p>You can see this clearly by checking <code>#exists?</code> multiple times after loading the page:</p>\n\n<pre><code>b = Watir::Browser.new :chrome\nb.goto \"https://icecat.biz/fr/search?keyword=3030050010763\"\n5.times do\n    p b.a(:class =&gt; \"src-routes-search-product-item-raw-style__descriptionTitle--8-vad\").exists?\nend\n#=&gt; false\n#=&gt; false\n#=&gt; true\n#=&gt; true\n#=&gt; true\n</code></pre>\n\n<p>Note that methods that interact with the element, such as <code>#href</code>, will automatically wait for the element to exist before taking action. </p>\n"}], "owner": {"reputation": 225, "user_id": 11330290, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/15iKq.jpg?s=128&g=1", "display_name": "benj-p", "link": "https://stackoverflow.com/users/11330290/benj-p"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 239, "favorite_count": 0, "accepted_answer_id": 57079902, "answer_count": 2, "score": 0, "last_activity_date": 1563378782, "creation_date": 1563358611, "question_id": 57073576, "link": "https://stackoverflow.com/questions/57073576/watir-element-exists-but-exists-returns-false", "title": "Watir: element exists but .exists? returns false", "body": "<p>I'm using Watir on a Rails project to scrape the following page: <a href=\"https://icecat.biz/fr/search?keyword=3030050010763\" rel=\"nofollow noreferrer\">https://icecat.biz/fr/search?keyword=3030050010763</a></p>\n\n<p>I need to check if the <code>&lt;a&gt;</code> tag with the <code>'src-routes-search-product-item-raw-style__descriptionTitle--8-vad'</code> class exists, which it does, but the .exists? method is returning <code>false</code>.</p>\n\n<pre><code>b = Watir::Browser.new :chrome\nb.goto \"https://icecat.biz/fr/search?keyword=3030050010763\"\np b.a(:class =&gt; \"src-routes-search-product-item-raw-style__descriptionTitle--8-vad\").exists?\n</code></pre>\n\n<p>I know the element exists because the following code is returning the href value of that same element:</p>\n\n<pre><code>b.a(:class =&gt; \"src-routes-search-product-item-raw-style__descriptionTitle--8-vad\").href\n</code></pre>\n\n<p>I've used the .exists? method to check if some elements exist on other pages and it works fine. For example, this is returning <code>true</code>:</p>\n\n<pre><code>b = Watir::Browser.new :chrome\nb.goto \"https://icecat.biz/fr/p/babyliss/bab5586e/hair+dryers-3030050010763-bab5586e-29245899.html\"\np b.a(:data_type =&gt; \"json\").exists?\n</code></pre>\n\n<p>I can't seem to figure out what I'm doing wrong, any help would be appreciated.</p>\n"}, {"tags": ["arrays", "ruby", "range"], "comments": [{"owner": {"reputation": 40865, "user_id": 10431, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/22aac6106c44ae4078bd4c0a564714e0?s=128&d=identicon&r=PG", "display_name": "Keith Nicholas", "link": "https://stackoverflow.com/users/10431/keith-nicholas"}, "edited": false, "score": 7, "creation_date": 1563358695, "post_id": 57073570, "comment_id": 100670739, "body": "what have you tried? we don&#39;t write code for you, we help you when you get stuck with a specific problem"}, {"owner": {"reputation": 69, "user_id": 11451505, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d19d52381d272c448c77e0847c694497?s=128&d=identicon&r=PG", "display_name": "Kourosh Alinaghi", "link": "https://stackoverflow.com/users/11451505/kourosh-alinaghi"}, "reply_to_user": {"reputation": 40865, "user_id": 10431, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/22aac6106c44ae4078bd4c0a564714e0?s=128&d=identicon&r=PG", "display_name": "Keith Nicholas", "link": "https://stackoverflow.com/users/10431/keith-nicholas"}, "edited": false, "score": 0, "creation_date": 1563359417, "post_id": 57073570, "comment_id": 100671101, "body": "i tried some codes, but didn&#39;t work."}, {"owner": {"reputation": 45322, "user_id": 421705, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/581b1760881c962648f99d6040d41829?s=128&d=identicon&r=PG", "display_name": "Holger Just", "link": "https://stackoverflow.com/users/421705/holger-just"}, "edited": false, "score": 7, "creation_date": 1563360432, "post_id": 57073570, "comment_id": 100671573, "body": "Please show us the code you have written and explain what exactly didn&#39;t work."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1563395107, "post_id": 57073570, "comment_id": 100690260, "body": "A small thing, but it&#39;s helpful to express each input as a Ruby object to which a variable is assigned (e.g., <code>arr = [1,2,3,7,9,10,11,13]</code>). That way readers can refer to those variables in answers and comments without having to define them, all readers refer to the same variables (here just <code>arr</code>) and cutting-and-pasting is facilitated. Your statement of the desired output is fine, but you may wish to write <code>&quot;desired output: ...&quot;</code> or <code>&quot;expected output: ...&quot;</code>."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1563395604, "post_id": 57073570, "comment_id": 100690492, "body": "A reminder that SO rules require askers to describe efforts they have made to solve the problem only when it is a homework question, and &quot;efforts made&quot; does not necessarily mean providing code. Low-rep askers are in any event encouraged to describe efforts they made to solve the problem. Even if it&#39;s not a homework problem (e.g., they may be learning Ruby on their own), doing so will head-off requests to do so."}, {"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 0, "creation_date": 1563479727, "post_id": 57073570, "comment_id": 100724550, "body": "&quot;i tried some codes, but didn&#39;t work&quot; is not a precise enough error description for us to help you. <i>What</i> doesn&#39;t work? <i>How</i> doesn&#39;t it work? What trouble do you have with your code? Do you get an error message? What is the error message? Is the result you are getting not the result you are expecting? What result do you expect and why, what is the result you are getting and how do the two differ? Is the behavior you are observing not the desired behavior? What is the desired behavior and why, what is the observed behavior, and in what way do they differ?"}], "answers": [{"comments": [{"owner": {"reputation": 5060, "user_id": 10522579, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7GQ6a.jpg?s=128&g=1", "display_name": "ray", "link": "https://stackoverflow.com/users/10522579/ray"}, "edited": false, "score": 2, "creation_date": 1563367451, "post_id": 57075580, "comment_id": 100675430, "body": "This answer is lit af +1. It will work with <code>map { |x| (x[0]..x[-1]) }</code> further."}, {"owner": {"reputation": 69, "user_id": 11451505, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d19d52381d272c448c77e0847c694497?s=128&d=identicon&r=PG", "display_name": "Kourosh Alinaghi", "link": "https://stackoverflow.com/users/11451505/kourosh-alinaghi"}, "edited": false, "score": 0, "creation_date": 1563372431, "post_id": 57075580, "comment_id": 100678827, "body": "Yes it is! Thanks a lot!"}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 1, "creation_date": 1563396027, "post_id": 57075580, "comment_id": 100690643, "body": "&quot;...so I won&#39;t either&quot;, but you <i>will</i> give a link to code that is ever-ever-ever-so-close to the answer. That&#39;s a mighty fine distinction! :-)"}, {"owner": {"reputation": 48049, "user_id": 6419007, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/CwqtX.jpg?s=128&g=1", "display_name": "Eric Duminil", "link": "https://stackoverflow.com/users/6419007/eric-duminil"}, "reply_to_user": {"reputation": 5060, "user_id": 10522579, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7GQ6a.jpg?s=128&g=1", "display_name": "ray", "link": "https://stackoverflow.com/users/10522579/ray"}, "edited": false, "score": 2, "creation_date": 1563396027, "post_id": 57075580, "comment_id": 100690644, "body": "@ray I&#39;ve got many ruby badges but this is my first &quot;lit af&quot; answer. I&#39;m honored!"}], "tags": [], "owner": {"reputation": 48049, "user_id": 6419007, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/CwqtX.jpg?s=128&g=1", "display_name": "Eric Duminil", "link": "https://stackoverflow.com/users/6419007/eric-duminil"}, "is_accepted": true, "score": 9, "last_activity_date": 1563365646, "creation_date": 1563365646, "answer_id": 57075580, "question_id": 57073570, "link": "https://stackoverflow.com/questions/57073570/how-to-find-all-the-ranges-in-an-array-of-numbers/57075580#57075580", "title": "How to find all the ranges in an array of numbers", "body": "<p>You didn't write any code, so I won't either.</p>\n\n<p>The documentation of <a href=\"https://ruby-doc.org/core-2.6.3/Enumerable.html#method-i-chunk_while\" rel=\"noreferrer\"><code>Enumerable#chunk_while</code></a> has an example which is very similar to yours.</p>\n"}, {"tags": [], "owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "is_accepted": false, "score": 0, "last_activity_date": 1563394853, "creation_date": 1563394853, "answer_id": 57083573, "question_id": 57073570, "link": "https://stackoverflow.com/questions/57073570/how-to-find-all-the-ranges-in-an-array-of-numbers/57083573#57083573", "title": "How to find all the ranges in an array of numbers", "body": "<p>This is a way of doing that without constructing an array of arrays and then converting the inner arrays to ranges.</p>\n\n<pre><code>arr = [1,2,3,7,9,10,11,13]\n\narr.each_with_object([]) do |n,a|\n  if a.any? and a.last.last == n-1\n    a[-1] = (a.last.first..n)\n  else\n    a &lt;&lt; (n..n)\n  end\nend\n  #=&gt; [1..3, 7..7, 9..11, 13..13]\n</code></pre>\n\n<p>Note that parentheses are required around the ranges, lest, for example, <code>a &lt;&lt; n..n</code> be parsed as <code>(a &lt;&lt; n)..n</code>, resulting in <code>ArgumentError (bad value for range)</code>. </p>\n"}], "owner": {"reputation": 69, "user_id": 11451505, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d19d52381d272c448c77e0847c694497?s=128&d=identicon&r=PG", "display_name": "Kourosh Alinaghi", "link": "https://stackoverflow.com/users/11451505/kourosh-alinaghi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 166, "favorite_count": 0, "accepted_answer_id": 57075580, "answer_count": 2, "score": 2, "last_activity_date": 1563394853, "creation_date": 1563358586, "last_edit_date": 1563367566, "question_id": 57073570, "link": "https://stackoverflow.com/questions/57073570/how-to-find-all-the-ranges-in-an-array-of-numbers", "title": "How to find all the ranges in an array of numbers", "body": "<p>I have an array of numbers that sorted. I need a method that return ranges of numbers in this array.</p>\n\n<pre><code>input: [1,2,3,7,9,10,11,13]\noutput: [(1..3),(7..7),(9..11),(13..13)]\n</code></pre>\n"}, {"tags": ["ruby", "cucumber"], "comments": [{"owner": {"reputation": 2164, "user_id": 7121619, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9e413a729d8325c52d4861a97a928959?s=128&d=identicon&r=PG&f=1", "display_name": "Marit", "link": "https://stackoverflow.com/users/7121619/marit"}, "edited": false, "score": 0, "creation_date": 1563373883, "post_id": 57073179, "comment_id": 100679843, "body": "Have a look at the Cucumber docs: <a href=\"https://cucumber.io/docs/cucumber/configuration/#environment-variables\" rel=\"nofollow noreferrer\">cucumber.io/docs/cucumber/configuration/#environment-variabl&zwnj;&#8203;es</a>?"}, {"owner": {"reputation": 41, "user_id": 3569525, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/89a603b07354881cbeadef130d509605?s=128&d=identicon&r=PG&f=1", "display_name": "Manfred Michels", "link": "https://stackoverflow.com/users/3569525/manfred-michels"}, "reply_to_user": {"reputation": 2164, "user_id": 7121619, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9e413a729d8325c52d4861a97a928959?s=128&d=identicon&r=PG&f=1", "display_name": "Marit", "link": "https://stackoverflow.com/users/7121619/marit"}, "edited": false, "score": 0, "creation_date": 1563374757, "post_id": 57073179, "comment_id": 100680377, "body": "Thanks, I had actually seen this beforehand. Unfortunately, it does not specify what happens if the same variable is set multiple times."}, {"owner": {"reputation": 2164, "user_id": 7121619, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9e413a729d8325c52d4861a97a928959?s=128&d=identicon&r=PG&f=1", "display_name": "Marit", "link": "https://stackoverflow.com/users/7121619/marit"}, "edited": false, "score": 0, "creation_date": 1563432333, "post_id": 57073179, "comment_id": 100699358, "body": "Ah, sorry I can&#39;t help you there as I don&#39;t know Ruby. You could try help channel for Ruby on the Cucumber Slack? (get an account here: <a href=\"https://cucumberbdd-slack-invite.herokuapp.com/\" rel=\"nofollow noreferrer\">cucumberbdd-slack-invite.herokuapp.com</a>)"}, {"owner": {"reputation": 3257, "user_id": 4341733, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0b1793f226cb3189da8bc9c6264d72b7?s=128&d=identicon&r=PG", "display_name": "diabolist", "link": "https://stackoverflow.com/users/4341733/diabolist"}, "edited": false, "score": 0, "creation_date": 1563886485, "post_id": 57073179, "comment_id": 100843028, "body": "have you tried <code>cucumber -p profile2 -p profile1</code>?"}, {"owner": {"reputation": 41, "user_id": 3569525, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/89a603b07354881cbeadef130d509605?s=128&d=identicon&r=PG&f=1", "display_name": "Manfred Michels", "link": "https://stackoverflow.com/users/3569525/manfred-michels"}, "edited": false, "score": 0, "creation_date": 1563986585, "post_id": 57073179, "comment_id": 100885455, "body": "Yes I did: in this case <code>profile2</code> will win."}, {"owner": {"reputation": 41, "user_id": 3569525, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/89a603b07354881cbeadef130d509605?s=128&d=identicon&r=PG&f=1", "display_name": "Manfred Michels", "link": "https://stackoverflow.com/users/3569525/manfred-michels"}, "edited": false, "score": 0, "creation_date": 1563986680, "post_id": 57073179, "comment_id": 100885503, "body": "In the meantime I have accepted that fact that my case is too exceptional. I&#39;m going to reorganize such that there is no overlap between the profiles.  Thanks for the help provided."}], "owner": {"reputation": 41, "user_id": 3569525, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/89a603b07354881cbeadef130d509605?s=128&d=identicon&r=PG&f=1", "display_name": "Manfred Michels", "link": "https://stackoverflow.com/users/3569525/manfred-michels"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 50, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1563357344, "creation_date": 1563357344, "question_id": 57073179, "link": "https://stackoverflow.com/questions/57073179/how-does-cucumber-resolve-environment-variables-within-profiles", "title": "How does Cucumber resolve environment variables within profiles?", "body": "<p>I run Cucumber with Ruby with a cucumber.yml like this:</p>\n\n<pre><code>profile1: env_var=value1 env_var=value2\nprofile2: env_var=value3\n</code></pre>\n\n<p>When I start cucumber with the first profile:</p>\n\n<pre><code>cucumber -p profile1\n</code></pre>\n\n<p>then \"env_var\" will be \"value2\", i.e. the last setting wins.</p>\n\n<p>However when I run cucumber with both profiles:</p>\n\n<pre><code>cucumber -p profile1 -p profile2\n</code></pre>\n\n<p>then \"env_var\" will still be \"value2\", i.e. the second profile does not seem to override the environment variable if it was already set in the first profile.</p>\n\n<p>This is certainly an exceptional use case, but I have it currently in my project, and I could not find anything in the documentation. Is this behaviour expected? My expectation would be to see env_var=value3.</p>\n\n<p>Thanks for any hints.</p>\n"}, {"tags": ["regex", "ruby", "web-scraping"], "answers": [{"tags": [], "owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "is_accepted": false, "score": 1, "last_activity_date": 1563359050, "creation_date": 1563359050, "answer_id": 57073709, "question_id": 57072830, "link": "https://stackoverflow.com/questions/57072830/regular-expression-for-web-scraping/57073709#57073709", "title": "Regular expression for web scraping", "body": "<p>Do not parse HTML with regexps. Here the significant part of your interest is located inside JSON objects, use this.</p>\n\n<p>Assuming the whole string is assigned to <code>data</code>, do that:</p>\n\n<pre><code>jsons = data.scan(/{.*?}/).map(&amp;JSON.method(:parse))\n</code></pre>\n\n<p>Now just retrieve your data back:</p>\n\n<pre><code>[jsons.first[\"consumerName\"], jsons.last[\"publishedDate\"]]\n#\u21d2 [\"Antoinette Denis\", \"2019-07-16T21:54:54Z\"]\n</code></pre>\n"}], "owner": {"reputation": 46, "user_id": 11796744, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc53dfbab4d0173f8b9cb941c06efa34?s=128&d=identicon&r=PG&f=1", "display_name": "fasito", "link": "https://stackoverflow.com/users/11796744/fasito"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 76, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1612118971, "creation_date": 1563356202, "last_edit_date": 1612118971, "question_id": 57072830, "link": "https://stackoverflow.com/questions/57072830/regular-expression-for-web-scraping", "title": "Regular expression for web scraping", "body": "<p>I am scraping a web site and need a REGEX to match the following data. Example: I need to grab</p>\n<ol>\n<li>&quot;Antoinette Denis&quot; taking into account that some names are only one, without lastname.</li>\n<li>&quot;2019-07-16&quot;</li>\n<li>Comment, in this case the last paragraph &quot;I have tried ...&quot;</li>\n</ol>\n<p><code>{\\&quot;socialShareUrl\\&quot;:\\&quot;https://au.trustpilot.com/reviews/5d2e47aeccd70b084c6255e8\\&quot;,\\&quot;businessUnitId\\&quot;:\\&quot;5bdc1f534c2c1b0001dc2b39\\&quot;,\\&quot;businessUnitDisplayName\\&quot;:\\&quot;Shapermint\\&quot;,\\&quot;consumerId\\&quot;:\\&quot;5d2e47ad9192678da1522016\\&quot;,\\&quot;consumerName\\&quot;:\\&quot;Antoinette Denis\\&quot;,\\&quot;reviewId\\&quot;:\\&quot;5d2e47aeccd70b084c6255e8\\&quot;,\\&quot;stars\\&quot;:5}\\n\\n\\n\\n\\n        \\n            \\n\\n\\n    \\n    \\n    \\n        \\n            Antoinette Davis\\n        \\n        \\n            \\n                \\n                1 review\\n            \\n                    \\n    \\n\\n\\n        \\n\\n    \\n\\n\\n    \\n        \\n    \\n\\n    \\n        \\n    \\n    \\n        \\n    \\n    \\n        \\n    \\n    \\n        \\n    \\n    \\n        \\n    \\n\\n    \\n        \\n\\n{\\&quot;publishedDate\\&quot;:\\&quot;2019-07-16T21:54:54Z\\&quot;,\\&quot;updatedDate\\&quot;:null,\\&quot;reportedDate\\&quot;:null}\\n\\n\\n\\n    \\n    \\n        \\n\\n{\\&quot;businessUnitDisplayName\\&quot;:\\&quot;Shapermint\\&quot;,\\&quot;consumerName\\&quot;:\\&quot;Antoinette Denis\\&quot;,\\&quot;informationRequestStatus\\&quot;:\\&quot;none\\&quot;,\\&quot;isVerified\\&quot;:true,\\&quot;verificationSource\\&quot;:\\&quot;invitation\\&quot;}\\n\\n    \\n\\n    \\n\\n    \\n    \\n        \\n                Excellent product\\n        \\n        \\n            I have tried spanks and just not comfortable in them but this really works and is very comfortable it was a very pleasant surprise\\n        \\n    \\n\\n    \\n\\n        \\n            \\n\\n\\n    \\n        \\n\\n    \\n        \\n            \\n                \\n                Useful\\n            \\n        \\n    \\n\\n        \\n\\n\\n    \\n        \\n            \\n                \\n                Share\\n            \\n            \\n        \\n    \\n\\n        \\n    \\n        \\n    \\n    Reply</code></p>\n<p>I have this expression but I don't know how to work them together:</p>\n<pre><code>pattern_for_name = /&quot;consumerName\\\\&quot;:\\\\&quot;(?&lt;name&gt;\\w* \\w*)/\npattern_for_date = /&quot;publishedDate\\\\&quot;:\\\\&quot;(?&lt;date&gt;\\d*-\\d*-\\d*)/\n</code></pre>\n"}, {"tags": ["mysql", "ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 514, "user_id": 3815511, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/JzzEx.png?s=128&g=1", "display_name": "msbarnard", "link": "https://stackoverflow.com/users/3815511/msbarnard"}, "edited": false, "score": 1, "creation_date": 1563363436, "post_id": 57072658, "comment_id": 100673145, "body": "Would first_or_initialize work for you? <a href=\"https://apidock.com/rails/ActiveRecord/Relation/first_or_initialize\" rel=\"nofollow noreferrer\">apidock.com/rails/ActiveRecord/Relation/first_or_initialize</a>"}, {"owner": {"reputation": 441, "user_id": 6512253, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e726cad5061b8c5485505d4ca351f05?s=128&d=identicon&r=PG&f=1", "display_name": "Yash Chaudhary", "link": "https://stackoverflow.com/users/6512253/yash-chaudhary"}, "reply_to_user": {"reputation": 514, "user_id": 3815511, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/JzzEx.png?s=128&g=1", "display_name": "msbarnard", "link": "https://stackoverflow.com/users/3815511/msbarnard"}, "edited": false, "score": 0, "creation_date": 1563365105, "post_id": 57072658, "comment_id": 100674003, "body": "yeah it worked already. thanks."}], "owner": {"reputation": 441, "user_id": 6512253, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e726cad5061b8c5485505d4ca351f05?s=128&d=identicon&r=PG&f=1", "display_name": "Yash Chaudhary", "link": "https://stackoverflow.com/users/6512253/yash-chaudhary"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 53, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1563355678, "creation_date": 1563355678, "question_id": 57072658, "link": "https://stackoverflow.com/questions/57072658/create-or-update-rails-on-duplicate-object", "title": "Create or update rails on duplicate object", "body": "<p>The current code crates a duplicate object and changes some of the attributes, now I want create or update a row in db, for update I have to lookup on all the attributes except (entity_count, failed_entity_count, row_count)</p>\n\n<pre><code>peak_row = row.dup\npeak_row[:entity_count] = 10\npeak_row[:row_count] = 30\npeak_row[:failed_entity_count] = 20\npeak_row[:feature_type] = 'peak'\npeak_row[:transaction_type] = 'write'\npeak_row.save\n</code></pre>\n\n<p>What is the best way to do it.</p>\n"}, {"tags": ["ruby", "nokogiri"], "comments": [{"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 0, "creation_date": 1563413120, "post_id": 57072034, "comment_id": 100694682, "body": "On Stack Overflow it&#39;s really important to show your attempt to solve the problem yourself. In this case it&#39;d really help if you showed where you searched and why that search didn&#39;t provide you an answer. Please see &quot;<a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a>&quot; and the linked pages and &quot;<a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">mcve</a>&quot;. As it is, your question is pretty broad because we can&#39;t tell what you did to solve it."}], "answers": [{"comments": [{"owner": {"reputation": 5471, "user_id": 6019903, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/e7h7I.png?s=128&g=1", "display_name": "Brad", "link": "https://stackoverflow.com/users/6019903/brad"}, "edited": false, "score": 0, "creation_date": 1563374299, "post_id": 57076907, "comment_id": 100680121, "body": "Hey, thanks, I had come to the same conclusion since asking the question, I have done this to resolve <code>day_of_non_operation.name if day_of_non_operation.type === Nokogiri::XML::Reader::TYPE_ELEMENT</code> so I only get the lines that are elements and not the text. Thanks for the answer."}], "tags": [], "owner": {"reputation": 703, "user_id": 3275627, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sFsXG.jpg?s=128&g=1", "display_name": "Jonathan Duarte", "link": "https://stackoverflow.com/users/3275627/jonathan-duarte"}, "is_accepted": true, "score": 2, "last_activity_date": 1563413268, "last_edit_date": 1563413268, "creation_date": 1563369727, "answer_id": 57076907, "question_id": 57072034, "link": "https://stackoverflow.com/questions/57072034/node-tag-as-text-with-nokogiri/57076907#57076907", "title": "Node tag as text with nokogiri", "body": "<p>Your element is already there with the tag name <code>MondayToSunday</code>. The issue is that when Nokogiri parses a document is also includes blank lines, that in your case you need to filter it out.</p>\n\n<p>Here's an example:</p>\n\n<pre><code># ex.rb\n\nrequire 'nokogiri'\n\nxml = &lt;&lt;-XML\n&lt;DaysOfWeek&gt;\n    &lt;MondayToSunday/&gt;\n&lt;/DaysOfWeek&gt;\nXML\n\ndays_of_week = Nokogiri::XML(xml).children\n\ndays_of_week.children.each do |el|\n  puts \"Name: #{el.name}\"\n  p el.text\nend\n</code></pre>\n\n<p>Then, when we run this example we can see that we actually have three children for the <code>DaysOfWeek</code> tag:</p>\n\n<pre><code>Name: text\n\"\\n    \"\nName: MondayToSunday\n\"\"\nName: text\n\"\\n\"\n</code></pre>\n\n<p>where there are two named <code>text</code> with new lines in them, and in between the tag <code>MondayToSunday</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 5471, "user_id": 6019903, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/e7h7I.png?s=128&g=1", "display_name": "Brad", "link": "https://stackoverflow.com/users/6019903/brad"}, "edited": false, "score": 0, "creation_date": 1563440553, "post_id": 57085975, "comment_id": 100703516, "body": "This doesn&#39;t work unless you already know that a node exists with the tag &#39;MondayToSunday&#39;"}, {"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "reply_to_user": {"reputation": 5471, "user_id": 6019903, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/e7h7I.png?s=128&g=1", "display_name": "Brad", "link": "https://stackoverflow.com/users/6019903/brad"}, "edited": false, "score": 0, "creation_date": 1563563776, "post_id": 57085975, "comment_id": 100755357, "body": "The point of the code was to show how to access a node correctly. Whether the node exists is beyond the example&#39;s purpose. And, because the OP didn&#39;t tell us how Nokogiri was being used, trying to cover every possible situation would be a tutorial which is why the question was closed as off-topic for the site."}], "tags": [], "owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "is_accepted": false, "score": -2, "last_activity_date": 1563414192, "creation_date": 1563414192, "answer_id": 57085975, "question_id": 57072034, "link": "https://stackoverflow.com/questions/57072034/node-tag-as-text-with-nokogiri/57085975#57085975", "title": "Node tag as text with nokogiri", "body": "<p>We can't tell how you're using Nokogiri, so it might be a simple mistake of doing it wrong. Here's what I'd do:</p>\n\n<pre><code>require 'nokogiri'\n\nxml =&lt;&lt;EOT\n&lt;DaysOfWeek&gt;\n    &lt;MondayToSunday/&gt;\n&lt;/DaysOfWeek&gt;\nEOT\n\ndoc = Nokogiri::XML.parse(xml)\ndoc.at('DaysOfWeek').name # =&gt; \"DaysOfWeek\"\ndoc.at('MondayToSunday').name # =&gt; \"MondayToSunday\"\n</code></pre>\n\n<p><code>at</code> is a quick way to find the first node that matches a particular accessor, in this case, a node named \"<code>DaysOfWeek</code>\" or \"<code>MondayToSunday</code>\". Nokogiri is chock-full of ways to isolate a particular tag, which is its strength; Find it, get information about it, then move to the next one and repeat.</p>\n\n<p>This is all in the regular documentation and in the <a href=\"https://github.com/sparklemotion/nokogiri/wiki/Cheat-sheet\" rel=\"nofollow noreferrer\">cheat sheet</a>.</p>\n"}], "owner": {"reputation": 5471, "user_id": 6019903, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/e7h7I.png?s=128&g=1", "display_name": "Brad", "link": "https://stackoverflow.com/users/6019903/brad"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 95, "favorite_count": 0, "closed_date": 1563456900, "accepted_answer_id": 57076907, "answer_count": 2, "score": -1, "last_activity_date": 1563414192, "creation_date": 1563353562, "last_edit_date": 1563413146, "question_id": 57072034, "link": "https://stackoverflow.com/questions/57072034/node-tag-as-text-with-nokogiri", "closed_reason": "Needs more focus", "title": "Node tag as text with nokogiri", "body": "<p>I have the following XML:</p>\n\n<pre><code>&lt;DaysOfWeek&gt;\n    &lt;MondayToSunday/&gt;\n&lt;/DaysOfWeek&gt;\n</code></pre>\n\n<p>I'm using Nokogiri, if I call <code>node.name</code> it returns \"text\". How can I get the actual name of the tag, like \"MondayToSunday\"?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "postgresql", "group-by", "ruby-on-rails-5"], "answers": [{"tags": [], "owner": {"reputation": 2307, "user_id": 219594, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/87b214a1096bea2042c331b63eb1fa22?s=128&d=identicon&r=PG", "display_name": "andrykonchin", "link": "https://stackoverflow.com/users/219594/andrykonchin"}, "is_accepted": false, "score": 1, "last_activity_date": 1563366784, "creation_date": 1563366784, "answer_id": 57075949, "question_id": 57071447, "link": "https://stackoverflow.com/questions/57071447/how-to-solve-pgcannotcoerce-error-cannot-cast-type-bigint-to-timestamp-with/57075949#57075949", "title": "How to solve &quot;PG::CannotCoerce: ERROR: cannot cast type bigint to timestamp with time zone&quot; error in Rails", "body": "<p>First of all looks like there is a mistake in this line:</p>\n\n<pre><code>@sales = Sale.group_by_month(:id, :created_at,format: \"%B %Y\", time_zone: \"Hanoi\")\n</code></pre>\n\n<p>Look at the example for <a href=\"https://github.com/ankane/groupdate\" rel=\"nofollow noreferrer\">groupdate gem</a>:</p>\n\n<pre><code>User.group_by_week(:created_at, time_zone: \"Pacific Time (US &amp; Canada)\")\n</code></pre>\n\n<p>First argument (<code>id</code>) is excessive and your code should look like:</p>\n\n<pre><code>@sales = Sale.group_by_month(:created_at, format: \"%B %Y\", time_zone: \"Hanoi\")\n</code></pre>\n\n<p>That's why, actually, you receive the error message \"PG::CannotCoerce: ERROR: cannot cast type bigint to timestamp with time zone...\". <code>\"sales\".\"id\"::timestamptz</code> in generated SQL query means converting <code>id</code> column (integer) to timestamp (timestamptz).</p>\n\n<p>I hope it will be helpful.</p>\n"}], "owner": {"reputation": 21, "user_id": 10539499, "user_type": "registered", "profile_image": "https://graph.facebook.com/2211929879055671/picture?type=large", "display_name": "Angel Ria Purnama Sari", "link": "https://stackoverflow.com/users/10539499/angel-ria-purnama-sari"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 257, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1563366784, "creation_date": 1563351296, "question_id": 57071447, "link": "https://stackoverflow.com/questions/57071447/how-to-solve-pgcannotcoerce-error-cannot-cast-type-bigint-to-timestamp-with", "title": "How to solve &quot;PG::CannotCoerce: ERROR: cannot cast type bigint to timestamp with time zone&quot; error in Rails", "body": "<p>i want to show my sales index that group by month, i already try to use filter or groupdate gem, but i got this error </p>\n\n<blockquote>\n  <p>PG::CannotCoerce: ERROR:  cannot cast type bigint to timestamp with\n  time zone LINE 1: ... NULL) GROUP BY (DATE_TRUNC('month',\n  (\"sales\".\"id\"::timestam...\n                                                               ^ : SELECT \"sales\".* FROM \"sales\" WHERE (\"sales\".\"id\" IS NOT NULL) GROUP\n  BY (DATE_TRUNC('month', (\"sales\".\"id\"::timestamptz) AT TIME ZONE\n  'Asia/Bangkok')) AT TIME ZONE 'Asia/Bangkok'</p>\n</blockquote>\n\n<p>i also try to remove the time_zone, but i got error like this </p>\n\n<blockquote>\n  <p>\"invalid argument to TimeZone[]: :created_at\"</p>\n</blockquote>\n\n<pre><code>class SalesController &lt; ApplicationController\n  before_action :set_sale, only: [:show, :edit, :update, :destroy]\n\n  # GET /sales\n  # GET /sales.json\n  def index\n    @sales = Sale.group_by_month(:id, :created_at,format: \"%B %Y\", time_zone: \"Hanoi\")\n  end\n</code></pre>\n\n<p>i expect the index was group by month, that extract from created_at with timestamp type column, like </p>\n\n<pre><code>January\n1, description, total, commission, created_at \n2, description, total, commission, created_at \n\nFebruary\n3, description, total, commission, created_at \n\nMarch\n4, description, total, commission, created_at\n</code></pre>\n\n<p>error : <a href=\"https://i.stack.imgur.com/3dxae.png\" rel=\"nofollow noreferrer\">https://i.stack.imgur.com/3dxae.png</a></p>\n\n<p>source code: <a href=\"https://i.stack.imgur.com/7AJnY.png\" rel=\"nofollow noreferrer\">https://i.stack.imgur.com/7AJnY.png</a></p>\n"}, {"tags": ["ruby", "hash"], "answers": [{"tags": [], "owner": {"reputation": 21613, "user_id": 580346, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/ba17945a06aac247b06548d5afe341e8?s=128&d=identicon&r=PG", "display_name": "mrzasa", "link": "https://stackoverflow.com/users/580346/mrzasa"}, "is_accepted": true, "score": 2, "last_activity_date": 1563350733, "creation_date": 1563350733, "answer_id": 57071258, "question_id": 57071213, "link": "https://stackoverflow.com/questions/57071213/how-to-use-new-hash-syntax/57071258#57071258", "title": "How to use new hash syntax?", "body": "<p>The \"new\" hash syntax is for indexing hashes with symbols (<code>:key</code>) not strings (<code>'key'</code> or <code>\"key\"</code>). So in your case, use:</p>\n\n<pre><code>&gt; hash = { duplex: duplex}\n&gt; hash[:duplex]\n[#&lt;Nokogiri::XML::Element:0x1e8ee04 name=\"duplex\"...\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 38092, "user_id": 18706, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/cabf735ce7b8b4471ef46ea54f71832d?s=128&d=identicon&r=PG", "display_name": "mahemoff", "link": "https://stackoverflow.com/users/18706/mahemoff"}, "is_accepted": false, "score": 2, "last_activity_date": 1563352999, "creation_date": 1563352999, "answer_id": 57071896, "question_id": 57071213, "link": "https://stackoverflow.com/questions/57071213/how-to-use-new-hash-syntax/57071896#57071896", "title": "How to use new hash syntax?", "body": "<p>You can also convert the Hash using ActiveSupport::HashWithIndifferentAccess so it supports both key types. Or Hashie::Mash to make them work as methods too.</p>\n\n<pre><code>hash = Hashie::Mash.new({ duplex: duplex}) # or Hashie::Mash.new({ \"duplex\" =&gt; duplex }), it doesn't matter\nhash[:duplex]\nhash['duplex'] # same\nhash.duplex # same\n</code></pre>\n"}], "owner": {"reputation": 125, "user_id": 8332030, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8e47e9a2a1cc4bad85b7e4212ef87e6?s=128&d=identicon&r=PG&f=1", "display_name": "Bastian", "link": "https://stackoverflow.com/users/8332030/bastian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 72, "favorite_count": 0, "accepted_answer_id": 57071258, "answer_count": 2, "score": 1, "last_activity_date": 1563353685, "creation_date": 1563350609, "last_edit_date": 1563353685, "question_id": 57071213, "link": "https://stackoverflow.com/questions/57071213/how-to-use-new-hash-syntax", "title": "How to use new hash syntax?", "body": "<p>I am trying to use the new hash syntax, but it is not working. What am I doing wrong?</p>\n\n<pre><code>2.6.3 :151 &gt; hash = { duplex: duplex}\n =&gt; {:duplex=&gt;[#&lt;Nokogiri::XML::Element:0x1e8ee04 name=\"duplex\"....\n2.6.3 :152 &gt; hash[\"duplex\"]\n =&gt; nil \n2.6.3 :153 &gt; hash = { \"duplex\" =&gt; duplex}\n =&gt; {\"duplex\"=&gt;[#&lt;Nokogiri::XML::Element:0x1e8ee04 name=\"duplex\" ....\n2.6.3 :154 &gt; hash[\"duplex\"]\n =&gt; [#&lt;Nokogiri::XML::Element:0x1e8ee04 name=\"duplex\" ....\n</code></pre>\n"}, {"tags": ["ruby", "logging", "rspec", "cucumber"], "comments": [{"owner": {"reputation": 2116, "user_id": 6780663, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9207ba3b9163582570078b687f9b2792?s=128&d=identicon&r=PG&f=1", "display_name": "Alejandro Montilla", "link": "https://stackoverflow.com/users/6780663/alejandro-montilla"}, "edited": false, "score": 2, "creation_date": 1563350055, "post_id": 57070687, "comment_id": 100665964, "body": "Did you check this <a href=\"https://stackoverflow.com/questions/35410895/how-to-save-cucumber-test-results-to-a-file/35413366#35413366\">post</a> ?"}, {"owner": {"reputation": 14662, "user_id": 3092298, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/70530902b2446a5eccb717b2d21506fb?s=128&d=identicon&r=PG&f=1", "display_name": "Greg Burghardt", "link": "https://stackoverflow.com/users/3092298/greg-burghardt"}, "edited": false, "score": 0, "creation_date": 1563366328, "post_id": 57070687, "comment_id": 100674724, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/35410895/how-to-save-cucumber-test-results-to-a-file\">How to save Cucumber test results to a file</a>"}], "answers": [{"comments": [{"owner": {"reputation": 271, "user_id": 1873872, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/5ae0c113339aeb55e833184a8cccda9e?s=128&d=identicon&r=PG", "display_name": "Steven Moffat", "link": "https://stackoverflow.com/users/1873872/steven-moffat"}, "edited": false, "score": 0, "creation_date": 1614769972, "post_id": 57108788, "comment_id": 117484449, "body": "I&#39;m attempting to achieve this exact same with Rspec rails  in the helper file I tried to call the config.on_event but it threw an error  NoMethodError:   undefined method `on_event&#39; for #&lt;RSpec::Core::Configuration:0x0000563ce8230228&gt;  have you documented or can you remember where or how configured logger ?"}], "tags": [], "owner": {"reputation": 81, "user_id": 10928405, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c14ed86a9772fbc1074edaa2ddcb427f?s=128&d=identicon&r=PG&f=1", "display_name": "Niall", "link": "https://stackoverflow.com/users/10928405/niall"}, "is_accepted": true, "score": 1, "last_activity_date": 1563526059, "creation_date": 1563526059, "answer_id": 57108788, "question_id": 57070687, "link": "https://stackoverflow.com/questions/57070687/capturing-and-logging-cucumber-test-results/57108788#57108788", "title": "Capturing and logging cucumber test results", "body": "<p>Found that this does exactly what I needed</p>\n\n<pre><code>AfterConfiguration do |config|\n    config.on_event :test_case_finished do |event|\n        p event.result\n    end\nend\n</code></pre>\n"}], "owner": {"reputation": 81, "user_id": 10928405, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c14ed86a9772fbc1074edaa2ddcb427f?s=128&d=identicon&r=PG&f=1", "display_name": "Niall", "link": "https://stackoverflow.com/users/10928405/niall"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2377, "favorite_count": 0, "accepted_answer_id": 57108788, "answer_count": 1, "score": 0, "last_activity_date": 1575534933, "creation_date": 1563348652, "question_id": 57070687, "link": "https://stackoverflow.com/questions/57070687/capturing-and-logging-cucumber-test-results", "title": "Capturing and logging cucumber test results", "body": "<p>I'm adding logging to a test suite. It uses Ruby, Cucumber and Rspec to run. I've already set up an env.rb to log each test and can capture Scenarios and Steps and drop them into the logger but I am at a loss how to grab the actual results. </p>\n\n<p>Each test run will put something like</p>\n\n<pre><code>    1 scenario (1 passed)\n    27 steps (27 passed)\n    0m0.176s\n</code></pre>\n\n<p>into the console.</p>\n\n<p>I know I can grab feature name, scenario name, tags and steps using the Before do |scenario| below but I cannot find anyway of accessing the results. </p>\n\n<pre><code>$logger.level = :info\n$logger.add_appenders \\\nLogging.appenders.stdout,\nLogging.appenders.file(\"logging/#{Time.now.strftime(\"%m-%d-%Y--%H:%M\")}.log\")\nuser = `id -un` #Mac specific, sorry windows users\nuser.delete!(\"\\n\")\n$logger.debug \"Test run by #{user} on #{Time.now.strftime(\"%m/%d/%Y\")}\"\n\nBefore do |scenario|\n  @feature_name = scenario.feature.name\n  @scenario_name = scenario.name\n  @scenario_tags = scenario.source_tag_names\n  $logger.info \"FEATURE: #{@feature_name}\"\n  $logger.info \"SCENARIO: #{@scenario_name}\"\n  $step_index = 0\n  $stop_count = scenario.test_steps.count\n  @scenario = scenario\nend\n\nAfterStep do |step|\n  if $step_index &lt; $stop_count\n    $logger.info \"#{@scenario.test_steps[$step_index].text}\\n\"\n  end\n  $step_index += 2\nend\n</code></pre>\n\n<p>It needs to output to a .log which is why I've so far avoided the html report builders.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-4", "rubygems", "delayed-job"], "owner": {"reputation": 57, "user_id": 7755445, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6ed9cf66c432290fb2974942e4399002?s=128&d=identicon&r=PG&f=1", "display_name": "Wilson.Wang", "link": "https://stackoverflow.com/users/7755445/wilson-wang"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 273, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1563505171, "creation_date": 1563347015, "last_edit_date": 1563505171, "question_id": 57070259, "link": "https://stackoverflow.com/questions/57070259/running-delayed-job-using-bundle-exec", "title": "Running delayed job using bundle exec", "body": "<p>In general, I will start the delayed_job using cmd:</p>\n\n<pre><code>RAILS_ENV=production bin/delayed_job start\n</code></pre>\n\n<p>Now I wrote a simple upstart script to automatically start the delayed job after reboot.</p>\n\n<p>I found that if I wrote the cmd above in the script, it will fail.</p>\n\n<pre><code># this is the execution in the upstart conf\nexec RAILS_ENV=production bin/delayed_job start\n</code></pre>\n\n<p>After some google and test, I found this would work in my script:</p>\n\n<pre><code> exec bundle exec /usr/bin/env RAILS_ENV=production bin/delayed_job start\n</code></pre>\n\n<p>This resulted in my question, I guess <code>/usr/bin/env RAILS_ENV=production</code> is to pass the environment variable into the bin/delay_job script, how about bundle exec here?</p>\n\n<p>Without having bundle exec in the script, it will throw error regarding to </p>\n\n<p><code>require': cannot load such file -- bundler/setup (LoadError)</code>.</p>\n\n<p>I realized that using bundle exec helps run rails under some context of the environment, but why is it necessary in the script?\nOr is <code>bundle exec</code>  necessary when I want to execute cmd like <code>bin/delayed_job</code> or <code>rake</code> in the script?</p>\n\n<p>Thanks.</p>\n\n<p><strong>updated</strong></p>\n\n<p>I copied the upstart script to another node and executed it the same way.\nHowever, it throws the incompatible library version error...\nI run </p>\n\n<pre><code> bundle exec /usr/bin/env RAILS_ENV=production bin/delayed_job start\n</code></pre>\n\n<p>directly on terminal and it worked as expected, but failed when putting the command above in a script.</p>\n\n<p>Could someone tell me why the result differed when executing the same command but in different place?</p>\n"}, {"tags": ["ruby"], "answers": [{"comments": [{"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1563398848, "post_id": 57070596, "comment_id": 100691649, "body": "You could write: <code>select_headers = [&#39;Employee&#39;, &#39;Manager&#39;]; ....find_all do |row| select_headers.any? { |header| header[row].match? regex }</code>. That way you need only change <code>select_headers</code> if they were to change."}], "tags": [], "owner": {"reputation": 2358, "user_id": 1072281, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5900eea054e31a49f94492cc5618ee17?s=128&d=identicon&r=PG&f=1", "display_name": "colinux", "link": "https://stackoverflow.com/users/1072281/colinux"}, "is_accepted": false, "score": 2, "last_activity_date": 1563348289, "creation_date": 1563348289, "answer_id": 57070596, "question_id": 57070013, "link": "https://stackoverflow.com/questions/57070013/find-case-insensitive-records-using-find-all-in-ruby/57070596#57070596", "title": "find case insensitive records using find_all in ruby", "body": "<p>The both Employee &amp; Manager match in solved with a double condition in the block : </p>\n\n<pre><code>@results = @csv_table.find_all do |row|\n  row['Employee'].start_with? @text || row['Manager'].start_with? @text\nend\n</code></pre>\n\n<p>The insensitive problem could be solved in 2 ways : by downcasing (or upcasing) each string compared :</p>\n\n<pre><code>searchable_text = @text.downcase\n@results = @csv_table.find_all do |row|\n  row['Employee'].downcase.start_with? searchable_text ||\n    row['Manager'].downcase.start_with? searchable_text\nend\n</code></pre>\n\n<p>Or in a more elegant way with a insensitive regex :</p>\n\n<pre><code>regex = /^#{@text}/i # notice the ^ to mimic the start_with?\n@results = @csv_table.find_all do |row|\n  row['Employee'].match? regex || row['Manager'].match? regex\nend\n</code></pre>\n\n<p>Depending on the content, the regex may behave slightly differently from <code>start_with?</code>, but for names it should be OK.</p>\n"}], "owner": {"reputation": 15, "user_id": 7321198, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30d085fd97c4f50dd376b2dbd8af3d8d?s=128&d=identicon&r=PG&f=1", "display_name": "Yeshky", "link": "https://stackoverflow.com/users/7321198/yeshky"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 37, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1563350095, "creation_date": 1563346016, "last_edit_date": 1563350095, "question_id": 57070013, "link": "https://stackoverflow.com/questions/57070013/find-case-insensitive-records-using-find-all-in-ruby", "title": "find case insensitive records using find_all in ruby", "body": "<p>I need records to be fetched from a csv from multiple rows using the <code>find_all</code> method</p>\n\n<p>Consider a csv having records of <code>Employee</code> &amp; <code>Manager</code> names. </p>\n\n<pre><code>@csv_table = CSV.parse(data, headers: true)\n@results = @csv_table.find_all { |row| row['Employee'].start_with? @text }\n</code></pre>\n\n<p>I'm able to find only the records in <code>Employee</code> column but don't know how to search from both the <code>Employee</code> &amp; <code>Manager</code> columns and also with the case insensitive condition</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 7096, "user_id": 3990767, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0a5741a212e3b0e6bd46a8a1e6d76a4a?s=128&d=identicon&r=PG", "display_name": "SOFe", "link": "https://stackoverflow.com/users/3990767/sofe"}, "edited": false, "score": 7, "creation_date": 1563346171, "post_id": 57070006, "comment_id": 100663873, "body": "Premature optimization is the root of all evil. Do not start thinking about minor non-algorithmic performance boost unless you have tested the program and confirmed it is a significant main source of slowness. But if minor stuff like this matters for you, maybe you shouldn&#39;t even use Ruby."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "reply_to_user": {"reputation": 7096, "user_id": 3990767, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0a5741a212e3b0e6bd46a8a1e6d76a4a?s=128&d=identicon&r=PG", "display_name": "SOFe", "link": "https://stackoverflow.com/users/3990767/sofe"}, "edited": false, "score": 1, "creation_date": 1563409690, "post_id": 57070006, "comment_id": 100694096, "body": "@SOFe, you&#39;re right. Yesterday a very evil person tried to kill me. I attributed it to premature optimization. sPaGhEtTiCaSe, Code Review, most definitely, since you have a working solution."}], "answers": [{"tags": [], "owner": {"reputation": 33085, "user_id": 2423164, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/Nxbnp.jpg?s=128&g=1", "display_name": "ndnenkov", "link": "https://stackoverflow.com/users/2423164/ndnenkov"}, "is_accepted": true, "score": 6, "last_activity_date": 1563348784, "last_edit_date": 1563348784, "creation_date": 1563347942, "answer_id": 57070514, "question_id": 57070006, "link": "https://stackoverflow.com/questions/57070006/ruby-style-and-performance/57070514#57070514", "title": "Ruby: style and performance", "body": "<blockquote>\n  <p>how to find a perfect balance between style and performance</p>\n</blockquote>\n\n<p>I completely agree with <a href=\"https://stackoverflow.com/questions/57070006/ruby-style-and-performance#comment100663873_57070006\">@SOFe's sentiment</a>.</p>\n\n<hr>\n\n<p>Basically what you should do is:</p>\n\n<ol>\n<li>You write the most readable (\"beautiful\") code you can think of, which isn't obviously dumb.</li>\n<li>If you notice that you have performance issues, you try to optimize your algorithm.</li>\n<li>If there is no room for that kind of optimization, you try to make such micro-performance tradeoffs in the very limited area of the code where you have established you have a performance problem.</li>\n</ol>\n\n<p>For the domains where Ruby is used, you never want to try to optimize without any evidence that the current solution is \"too slow\".</p>\n\n<p>In real world scenarios, performance bottlenecks will rarely derive from CPU intensive usage. It's most commonly a suboptimal usage of databases/networking/various other I/O/etc.</p>\n"}, {"tags": [], "owner": {"reputation": 3630, "user_id": 4799659, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153200714295120/picture?type=large", "display_name": "fylooi", "link": "https://stackoverflow.com/users/4799659/fylooi"}, "is_accepted": false, "score": 3, "last_activity_date": 1563353981, "creation_date": 1563353981, "answer_id": 57072164, "question_id": 57070006, "link": "https://stackoverflow.com/questions/57070006/ruby-style-and-performance/57072164#57072164", "title": "Ruby: style and performance", "body": "<p>Ruby has a standard library which feels quite natural to use (for the most part). However, the library needs to jump through a lot of hoops to provide this natural experience. </p>\n\n<p>The docs for <code>Comparable#between?</code> specify:</p>\n\n<pre><code>between?(min, max) \u2192 true or false\n\nReturns false if obj &lt;=&gt; min is less than zero or if anObject &lt;=&gt; max is greater than zero, true otherwise.\n</code></pre>\n\n<p>Sounds like it's doing a lot more than <code>code &gt;= UPPER_A &amp;&amp; code &lt;= UPPER_Z</code>. But why does it need to do all this extra stuff when all you want is to check whether a number is between A &amp; B? </p>\n\n<p>That extra stuff makes it possible for us to implement the following code:</p>\n\n<pre><code>1.between? 0, 100\n\n'c'.between? 'a', 'z'\n\nDate.parse(\"2019/06/31\").between? Date.parse(\"2019/06/01\"), Date.parse(\"2019/12/01\")\n\nPosition.new(\"Manager\").between? Position.new(\"Trainee\"), Position.new(\"Director\")\n</code></pre>\n\n<p>This implementation of <code>#between?</code> allows us to compare any type of object in an elegant, natural way. But of course, it's going to be slower than <code>code &gt;= UPPER_A &amp;&amp; code &lt;= UPPER_Z</code></p>\n\n<p>So let's say you love the elegance of <code>1.compare?</code> but absolutely need the fastest performance possible? No problem. Just replace the method with your own implementation. You can reopen the class, <code>prepend</code> a module or use a refinement (and more). Eg. </p>\n\n<pre><code>class Integer\n  def between?(a, b)\n    self &gt;= a &amp;&amp; self &lt;= b\n  end\nend\n</code></pre>\n"}], "owner": {"reputation": 306, "user_id": 10919154, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FqfuP.jpg?s=128&g=1", "display_name": "Noctilucente", "link": "https://stackoverflow.com/users/10919154/noctilucente"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 73, "favorite_count": 0, "accepted_answer_id": 57070514, "answer_count": 2, "score": 1, "last_activity_date": 1563353981, "creation_date": 1563345995, "last_edit_date": 1563347232, "question_id": 57070006, "link": "https://stackoverflow.com/questions/57070006/ruby-style-and-performance", "title": "Ruby: style and performance", "body": "<p><strong>Note:</strong> I don't know if this question should be in StackOverflow or CodeReview (StackExchange). If you think it should be in CodeReview, please tell me in the comments.</p>\n\n<p>I have been playing with Ruby for a while now. I love Ruby because it is a very beautiful and expressive programming language. Lately, I have also been a bit obsessed with performance. It seems this obsession is making my Ruby code uglier. Here is a very simple example: a program that returns the ASCII range of a character (not considering accented characters or error handling).</p>\n\n<p>I came up with eight solutions:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>module MyProgram\n  module Character\n    UPPER_A = 65.freeze\n    UPPER_Z = 90.freeze\n    LOWER_A = 97.freeze\n    LOWER_Z = 122.freeze\n\n    module_function\n\n    def ascii_range1(char)\n      code = char.ord\n\n      return [65, 90] if code.between?(65, 90)\n      return [97, 122] if code.between?(97, 122)\n    end\n\n    def ascii_range2(char)\n      code = char.ord\n\n      if code.between?(65, 90)\n        [65, 90]\n      elsif code.between?(97, 122)\n        [97, 122]\n      end\n    end\n\n    def ascii_range3(char)\n      code = char.ord\n\n      return [65, 90] if code &gt;= 65 &amp;&amp; code &lt;= 90\n      return [97, 122] if code &gt;= 97 &amp;&amp; code &lt;= 122\n    end\n\n    def ascii_range4(char)\n      code = char.ord\n\n      if code &gt;= 65 &amp;&amp; code &lt;= 90\n        [65, 90]\n      elsif code &gt;= 97 &amp;&amp; code &lt;= 122\n        [97, 122]\n      end\n    end\n\n    def ascii_range5(char)\n      code = char.ord\n\n      return [UPPER_A, UPPER_Z] if code.between?(UPPER_A, UPPER_Z)\n      return [LOWER_A, LOWER_Z] if code.between?(LOWER_A, LOWER_Z)\n    end\n\n    def ascii_range6(char)\n      code = char.ord\n\n      if code.between?(UPPER_A, UPPER_Z)\n        [UPPER_A, UPPER_Z]\n      elsif code.between?(LOWER_A, LOWER_Z)\n        [LOWER_A, LOWER_Z]\n      end\n    end\n\n    def ascii_range7(char)\n      code = char.ord\n\n      return [UPPER_A, UPPER_Z] if code &gt;= UPPER_A &amp;&amp; code &lt;= UPPER_Z\n      return [LOWER_A, LOWER_Z] if code &gt;= LOWER_A &amp;&amp; code &lt;= LOWER_Z\n    end\n\n    def ascii_range8(char)\n      code = char.ord\n\n      if code &gt;= UPPER_A &amp;&amp; code &lt;= UPPER_Z\n        [UPPER_A, UPPER_Z]\n      elsif code &gt;= LOWER_A &amp;&amp; code &lt;= LOWER_Z\n        [LOWER_A, LOWER_Z]\n      end\n    end\n  end\nend\n</code></pre>\n\n<p>They all do the same thing and the differences are small... or so I thought. For example: the ugly expression <code>n &gt;= a &amp;&amp; n &lt;= b</code> (not ugly in itself, just when compared to Ruby's <code>Comparable#between?</code>) is way faster than <code>n.between?(a, b)</code>.</p>\n\n<p>Here are the benchmark results (using benchmark-ips):</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>Warming up --------------------------------------\n                   1   134.374k i/100ms\n                   2   150.861k i/100ms\n                   3   215.836k i/100ms\n                   4   222.775k i/100ms\n                   5   150.204k i/100ms\n                   6   152.013k i/100ms\n                   7   220.250k i/100ms\n                   8   218.256k i/100ms\nCalculating -------------------------------------\n                   1      2.432M (\u00b1 7.2%) i/s -     12.094M in   5.000927s\n                   2      2.425M (\u00b1 6.9%) i/s -     12.069M in   5.005368s\n                   3      4.142M (\u00b111.4%) i/s -     20.504M in   5.019090s\n                   4      4.442M (\u00b1 4.6%) i/s -     22.278M in   5.026760s\n                   5      2.366M (\u00b1 3.0%) i/s -     11.866M in   5.019090s\n                   6      2.367M (\u00b1 2.7%) i/s -     11.857M in   5.012120s\n                   7      4.372M (\u00b1 3.4%) i/s -     22.025M in   5.043391s\n                   8      4.367M (\u00b1 2.6%) i/s -     22.044M in   5.050882s\n\nComparison:\n                   4:  4441965.7 i/s\n                   7:  4372497.0 i/s - same-ish: difference falls within error\n                   8:  4367421.3 i/s - same-ish: difference falls within error\n                   3:  4141617.7 i/s - same-ish: difference falls within error\n                   1:  2432164.3 i/s - 1.83x  slower\n                   2:  2424708.2 i/s - 1.83x  slower\n                   6:  2367435.3 i/s - 1.88x  slower\n                   5:  2366400.6 i/s - 1.88x  slower\n\n</code></pre>\n\n<p>So it comes down to <code>ascii_range3</code>, <code>ascii_range4</code>, <code>ascii_range7</code> and <code>ascii_range8</code> (<code>ascii_range4</code> being the fastest) when what I really wanted was <code>ascii_range5</code> but faster. I don't find any of these four approaches as beautiful as <code>ascii_range5</code>, so I just pick the most efficient one (which normally is the ugliest one). This has been happening a lot to me lately and it is taking the beauty of my code. That bothers me.</p>\n\n<p>Please, do not misunderstand the question: it is not about the most efficient way of solving this specific problem. It is about how to find a perfect balance between style and performance (and you can use this or any other example in your answer).</p>\n\n<p>Thanks.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "xml", "nokogiri"], "comments": [{"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 0, "creation_date": 1563414531, "post_id": 57069453, "comment_id": 100694945, "body": "We need to know what node your are searching for, and what accessor you&#39;re using to try to find it. Please see &quot;<a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a>&quot; and the linked pages and &quot;<a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">mcve</a>&quot; and use the information there as a guide to improving your question."}], "answers": [{"comments": [{"owner": {"reputation": 125, "user_id": 8332030, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8e47e9a2a1cc4bad85b7e4212ef87e6?s=128&d=identicon&r=PG&f=1", "display_name": "Bastian", "link": "https://stackoverflow.com/users/8332030/bastian"}, "edited": false, "score": 0, "creation_date": 1563346219, "post_id": 57069706, "comment_id": 100663903, "body": "i added some more output. I dont really get what i have to add as my xpath"}, {"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 0, "creation_date": 1563415994, "post_id": 57069706, "comment_id": 100695195, "body": "Almost never do we want to use <code>each</code> on a document to iterate over every node. If nothing else, it results in much slower code as you walk the nodes, plus write a lot of code trying to determine if you&#39;re on a node you want. Instead, Using <code>at</code>, <code>search</code>, <code>css</code>, <code>xpath</code> or one of their variants is much faster and results in less code. <code>each</code> is useful when you are analyzing a document or can&#39;t get to a particular place in the document any other way."}], "tags": [], "owner": {"reputation": 335, "user_id": 5327471, "user_type": "registered", "accept_rate": 83, "profile_image": "https://graph.facebook.com/980076975364738/picture?type=large", "display_name": "Jann Anthony Briza", "link": "https://stackoverflow.com/users/5327471/jann-anthony-briza"}, "is_accepted": false, "score": 0, "last_activity_date": 1563344804, "creation_date": 1563344804, "answer_id": 57069706, "question_id": 57069453, "link": "https://stackoverflow.com/questions/57069453/how-to-access-nested-xml-with-nokogiri/57069706#57069706", "title": "How to access nested XML with Nokogiri", "body": "<p>You could use <code>xpath</code>:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>parsed = Nokogiri::XML::DocumentFragment.parse(xml)\nsiamese_cat = parsed.xpath(.//interface/status/state)\n</code></pre>\n\n<p>Or just iterating thru XML</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>parsed = Nokogiri::XML::DocumentFragment.parse(xml)\nparsed.each do |element|\n   # Some instructions\nend\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "is_accepted": false, "score": 1, "last_activity_date": 1563416829, "last_edit_date": 1563416829, "creation_date": 1563415505, "answer_id": 57086122, "question_id": 57069453, "link": "https://stackoverflow.com/questions/57069453/how-to-access-nested-xml-with-nokogiri/57086122#57086122", "title": "How to access nested XML with Nokogiri", "body": "<p>Your question is really generic and poorly asked so answering a specific question is not possible, but it looks like you need to understand how to access tags in a document using a CSS accessor, which Nokogiri makes very easy.</p>\n\n<p>Meditate on this:</p>\n\n<pre><code>require 'nokogiri'\n\nfoo =&lt;&lt;EOT\n&lt;tag1&gt;\n  &lt;tag2&gt;some text&lt;/tag2&gt;\n  &lt;tag3&gt;some more text&lt;/tag3&gt;\n  &lt;tags&gt;something&lt;/tags&gt;\n  &lt;tags&gt;or&lt;/tags&gt;\n  &lt;tags&gt;other&lt;/tags&gt;\n&lt;/tag1&gt;\nEOT\n\nxml = Nokogiri::XML.parse(foo)\n</code></pre>\n\n<p><code>at</code> finds the first matching occurrence in the document:</p>\n\n<pre><code>xml.at('tag2').content # =&gt; \"some text\"\n</code></pre>\n\n<p><a href=\"https://nokogiri.org/rdoc/Nokogiri/XML/NodeSet.html#at-instance_method\" rel=\"nofollow noreferrer\"><code>at</code></a> is pretty smart, in that it tries to determine whether the accessor is CSS or XPath, so it's a good first tool when you want the <em>first</em> match. If that doesn't work then you can try <a href=\"https://nokogiri.org/rdoc/Nokogiri/XML/Searchable.html#at_css-instance_method\" rel=\"nofollow noreferrer\"><code>at_css</code></a> which specifies that accessor is CSS, because sometimes you can come up with something that could work as CSS or XPath but return different results:</p>\n\n<pre><code>xml.at_css('tag3').content # =&gt; \"some more text\"\nxml.at_css('tag3').text # =&gt; \"some more text\"\n</code></pre>\n\n<p>Similar to <code>at</code> is <a href=\"https://nokogiri.org/rdoc/Nokogiri/XML/Searchable.html#search-instance_method\" rel=\"nofollow noreferrer\"><code>search</code></a>, which also tries to determine whether it's CSS or XPath, but finds all matching nodes throughout the document rather than just the first matching one. Because it returns all matching nodes, it returns a NodeSet, unlike <code>at</code> which returns a Node, so you have to be aware that NodeSets behave differently than Nodes when accessing their <code>content</code> or <code>text</code>:</p>\n\n<pre><code>xml.search('tags').text # =&gt; \"somethingorother\"\n</code></pre>\n\n<p>That's almost never what you want, but you'd be surprised how many people then ask how to split that resulting string into the desired three words. It's usually impossible to do accurately, so a different tactic is needed:</p>\n\n<pre><code>xml.search('tags').map { |t| t.content } # =&gt; [\"something\", \"or\", \"other\"]\nxml.search('tags').map { |t| t.text } # =&gt; [\"something\", \"or\", \"other\"]\nxml.search('tags').map(&amp;:text) # =&gt; [\"something\", \"or\", \"other\"]\n</code></pre>\n\n<p>Both <code>at</code> and <code>search</code> have <code>..._css</code> and <code>..._xpath</code> variations to help you fine-tune your code's behavior, but I always recommend starting with the generic <code>at</code> and <code>search</code> until you're forced to define what the accessor is.</p>\n\n<p>I also recommend starting with CSS accessors over XPath because they tend to be more readable, and more easily learned if you're working inside HTML with CSS. XPath is very powerful, probably still more so than CSS, but learning it takes longer and often results in less readable code, which affects maintainability.</p>\n\n<p>This is all in the <a href=\"https://github.com/sparklemotion/nokogiri/wiki/Cheat-sheet\" rel=\"nofollow noreferrer\">tutorials and cheat sheets</a> and <a href=\"https://nokogiri.org/rdoc/index.html\" rel=\"nofollow noreferrer\">documentation</a>. Nokogiri is extremely powerful but it takes time reading and trying things to learn it. You can also <a href=\"https://stackoverflow.com/search?q=user%3A128421%20nokogiri\">search on SO</a> for other things I've written about searching XML and HTML documents; In particular \"<a href=\"https://stackoverflow.com/questions/8482543/what-are-some-examples-of-using-nokogiri/8482746#8482746\">What are some examples of using Nokogiri?</a>\" helps get an idea how to scrape a page. There's a lot of information covering many different topics related to this. I find it an interesting exercise to parse documents like this as it was part of my professional life for years.</p>\n"}], "owner": {"reputation": 125, "user_id": 8332030, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8e47e9a2a1cc4bad85b7e4212ef87e6?s=128&d=identicon&r=PG&f=1", "display_name": "Bastian", "link": "https://stackoverflow.com/users/8332030/bastian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 265, "favorite_count": 0, "closed_date": 1563449431, "answer_count": 2, "score": 0, "last_activity_date": 1581291096, "creation_date": 1563343502, "last_edit_date": 1581291096, "question_id": 57069453, "link": "https://stackoverflow.com/questions/57069453/how-to-access-nested-xml-with-nokogiri", "closed_reason": "Not suitable for this site", "title": "How to access nested XML with Nokogiri", "body": "<p>I am using Nokogiri to parse XML. I was told to use a CSS selector to search through the XML, but I can't chain it to get through the nested objects.</p>\n\n<p>How do I access the inner elements?</p>\n\n<pre><code>2.6.3 :039 &gt; pp a.css(\"interface\").to_s          \n\"&lt;interface&gt;\\n\" +\n\"    &lt;status&gt;\\n\" +\n\"     &lt;__XML__OPT_Cmd_show_interface_status_down&gt;\\n\" +\n\"      &lt;__XML__OPT_Cmd_show_interface_status___readonly__&gt;\\n\" +\n\"       &lt;__readonly__&gt;\\n\" +\n\"        &lt;TABLE_interface&gt;\\n\" +\n\"         &lt;ROW_interface&gt;\\n\" +\n\"          &lt;interface&gt;mgmt0&lt;/interface&gt;\\n\" +\n\"          &lt;state&gt;connected&lt;/state&gt;\\n\" +\n\"          &lt;vlan&gt;routed&lt;/vlan&gt;\\n\" +\n\"          &lt;duplex&gt;full&lt;/duplex&gt;\\n\" +\n\"          &lt;speed&gt;a-1000&lt;/speed&gt;\\n\" +\n\"          &lt;type&gt;--&lt;/type&gt;\\n\" +\n\"         &lt;/ROW_interface&gt;\\n\" +\n\"         &lt;ROW_interface&gt;\\n\" +\n\"          &lt;interface&gt;Vlan1&lt;/interface&gt;\\n\" +\n\"          &lt;state&gt;down&lt;/state&gt;\\n\" +\n\"          &lt;vlan&gt;routed&lt;/vlan&gt;\\n\" +\n\"          &lt;duplex&gt;auto&lt;/duplex&gt;\\n\" +\n\"          &lt;speed&gt;auto&lt;/speed&gt;\\n\" +\n\"         &lt;/ROW_interface&gt;\\n\" +\n\"         &lt;ROW_interface&gt;\\n\" +\n\"          &lt;interface&gt;Vlan6&lt;/interface&gt;\\n\" +\n\"          &lt;state&gt;down&lt;/state&gt;\\n\" +\n\"          &lt;vlan&gt;routed&lt;/vlan&gt;\\n\" +\n\"          &lt;duplex&gt;auto&lt;/duplex&gt;\\n\" +\n\"          &lt;speed&gt;auto&lt;/speed&gt;\\n\" +\n\"         &lt;/ROW_interface&gt;\\n\" +\n\"         &lt;ROW_interface&gt;\\n\" +\n\"          &lt;interface&gt;Vlan486&lt;/interface&gt;\\n\" +\n\"          &lt;state&gt;down&lt;/state&gt;\\n\" +\n\"          &lt;vlan&gt;routed&lt;/vlan&gt;\\n\" +\n\"          &lt;duplex&gt;auto&lt;/duplex&gt;\\n\" +\n\"          &lt;speed&gt;auto&lt;/speed&gt;\\n\" +\n\"         &lt;/ROW_interface&gt;\\n\" +\n\"        &lt;/TABLE_interface&gt;\\n\" +\n\"       &lt;/__readonly__&gt;\\n\" +\n\"      &lt;/__XML__OPT_Cmd_show_interface_status___readonly__&gt;\\n\" +\n\"     &lt;/__XML__OPT_Cmd_show_interface_status_down&gt;\\n\" +\n\"    &lt;/status&gt;\\n\" +\n\"   &lt;/interface&gt;&lt;interface&gt;mgmt0&lt;/interface&gt;&lt;interface&gt;Vlan1&lt;/interface&gt;&lt;interface&gt;Vlan6&lt;/interface&gt;&lt;interface&gt;Vlan486&lt;/interface&gt;\"\n</code></pre>\n\n<p>I end up with this tree. What is my XPath here? This is only part of the parsed XML:</p>\n\n<pre><code>2.6.3 :043 &gt; pp parsed\n#(DocumentFragment:0x3fce080cd300 {\n  name = \"#document-fragment\",\n  children = [\n    #(ProcessingInstruction:0x3fce080cce14 { name = \"xml\" }),\n    #(Text \"\\n\"),\n    #(Element:0x3fce080cc7d4 {\n      name = \"rpc-reply\",\n      namespace = #(Namespace:0x3fce080cffb0 {\n        prefix = \"nf\",\n        href = \"urn:ietf:params:xml:ns:netconf:base:1.0\"\n        }),\n      children = [\n        #(Text \"\\n\" + \" \"),\n        #(Element:0x3fce080cf22c {\n          name = \"data\",\n          namespace = #(Namespace:0x3fce080cffb0 {\n            prefix = \"nf\",\n            href = \"urn:ietf:params:xml:ns:netconf:base:1.0\"\n            }),\n          children = [\n            #(Text \"\\n\" + \"  \"),\n            #(Element:0x1903f98 {\n              name = \"show\",\n              namespace = #(Namespace:0x1903f20 {\n                href = \"http://www.cisco.com/nxos:1.0:if_manager\"\n                }),\n              children = [\n                #(Text \"\\n\" + \"   \"),\n                #(Element:0x1903700 {\n                  name = \"interface\",\n                  namespace = #(Namespace:0x1903f20 {\n                    href = \"http://www.cisco.com/nxos:1.0:if_manager\"\n                    }),\n                  children = [\n                    #(Text \"\\n\" + \"    \"),\n                    #(Element:0x19030fc {\n                      name = \"status\",\n                      namespace = #(Namespace:0x1903f20 {\n                        href = \"http://www.cisco.com/nxos:1.0:if_manager\"\n                        }),\n                  children = [\n                    #(Text \"\\n\" + \"     \"),\n                    #(Element:0x1902a1c {\n                      name = \"__XML__OPT_Cmd_show_interface_status_down\",\n                      namespace = #(Namespace:0x1903f20 {\n                        href = \"http://www.cisco.com/nxos:1.0:if_manager\"\n                        }),\n</code></pre>\n"}, {"tags": ["node.js", "ruby", "encryption", "cryptography"], "answers": [{"tags": [], "owner": {"reputation": 208794, "user_id": 229044, "user_type": "moderator", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/591426cbbacd4025d920467bad356911?s=128&d=identicon&r=PG&f=1", "display_name": "meagar", "link": "https://stackoverflow.com/users/229044/meagar"}, "is_accepted": false, "score": 6, "last_activity_date": 1595644170, "last_edit_date": 1595644170, "creation_date": 1563339266, "answer_id": 57068730, "question_id": 57068729, "link": "https://stackoverflow.com/questions/57068729/how-can-i-decrypt-data-encrypted-by-nodes-deprecated-createcipher-in-ruby/57068730#57068730", "title": "How can I decrypt data encrypted by Node&#39;s deprecated createCipher, in Ruby?", "body": "<p>The underlying algorithm, aes256, requires a 32 bit key and 16 bit initialization vector, regardless of the interface provided by higher level abstractions like <code>createCipher</code>. Under the hood, it <em>must</em> be producing a 32 bit key and 16 bit initialization vector, derived from the input password.</p>\n<p><code>createCipher</code> does this by repeatedly MD5 hashing on the input password to produce a byte array, from which it extracts the 32 byte key and a 16 byte initialization vector. It was deprecated because this is not a secure way of producing a random IV.</p>\n<p>This happens down inside the C source of Node, in <a href=\"https://github.com/nodejs/node/blob/8c9aaacb333a0223243eda9b3551dbf26fdb260a/deps/openssl/openssl/crypto/evp/evp_key.c#L74\" rel=\"nofollow noreferrer\">/deps/openssl/openssl/crypto/evp/evp_key.c</a>.</p>\n<p>This function has quite a few arguments, but when used to generate a key/iv for <code>createCipher('aes-256-cbc', 'password')</code>, this method is invoked <a href=\"https://github.com/nodejs/node/blob/fc50e6bcc81e4b34f4f3f3fe494b79200ae22efb/src/node_crypto.cc#L3899\" rel=\"nofollow noreferrer\">here</a>, with the following arguments:</p>\n<ul>\n<li><code>const EVP_CIPHER *type</code> // &quot;aes-256-cbc&quot;</li>\n<li><code>const EVP_MD *md</code> // EVP_md5()</li>\n<li><code>const unsigned char *salt</code> // null, unused</li>\n<li><code>const unsigned char *data</code> // &quot;password&quot;</li>\n<li><code>int datal</code> // 8, length of &quot;password&quot;,</li>\n<li><code>int count</code> // 1, unused</li>\n<li><code>unsigned char *key</code> // output key buffer,</li>\n<li><code>unsigned char *iv</code> // output iv buffer</li>\n</ul>\n<p>This method must produce 48 total bytes (32 for the key, and 16 for the IV) and it does so by first running <code>hash = md5(password)</code>, producing 16 bytes.</p>\n<p>Now, for each subsequent set of 16 bytes, it concatenates the previous 16 bytes with the <code>password</code>, and hashes it again: <code>hash = md5(hash + password)</code>.</p>\n<p>Effectively bytes...</p>\n<ul>\n<li>0 to 16 generated via <code>md5(password)</code></li>\n<li>17 to 32 generated via <code>md5(md5(password) + password)</code></li>\n<li>33 to 48 genearted via <code>md5(md5(md5(password) + password) + password)</code>.</li>\n</ul>\n<p>We can implement the same in Ruby to derive the correct key and IV to decrypt a given string via a password:</p>\n<pre class=\"lang-rb prettyprint-override\"><code>require 'digest'\nrequire 'openssl'\n\ndef decrypt(cipher_text, password)\n  bytes = [ Digest::MD5.digest(password) ]\n  bytes &lt;&lt; Digest::MD5.digest(bytes.last + password)\n  bytes &lt;&lt; Digest::MD5.digest(bytes.last + password)\n\n  bytes = bytes.join\n\n  cipher = OpenSSL::Cipher.new('aes-256-cbc')\n  cipher.decrypt\n\n  cipher.key = bytes[0...32]\n  cipher.iv = bytes[32...48]\n\n  # OpenSSL deals in raw bytes, not the hex-encoded representation\n  # 'f3051259f83c7ca2ac012a396c4c0848' =&gt; &quot;\\xF3\\x05\\x12Y\\xF8&lt;|\\xA2\\xAC\\x01*9lL\\bH&quot;\n  cipher_text = cipher_text.unpack('a2' * (cipher_text.length / 2)).map(&amp;:hex).pack('c*')\n\n  cipher.update(cipher_text) + cipher.final\nend\n\ndecrypt('f3051259f83c7ca2ac012a396c4c0848', 'secret password') # =&gt; 'dummy string'\n</code></pre>\n<p>For completeness, here is the equivalent <code>encrypt</code> method, which will allow data encrypted in Ruby to be decrypted in Node's deprecate <code>createDecipher</code>:</p>\n<pre class=\"lang-rb prettyprint-override\"><code> def encrypt(plain_text, password)\n  cipher = OpenSSL::Cipher.new('aes-256-cbc')\n  cipher.encrypt\n\n  bytes = [ Digest::MD5.digest(password) ]\n  bytes &lt;&lt; Digest::MD5.digest(bytes.last + password)\n  bytes &lt;&lt; Digest::MD5.digest(bytes.last + password)\n\n  bytes = bytes.join\n\n  cipher.key = bytes[0...32]\n  cipher.iv = bytes[32...48]\n\n  cipher_text = cipher.update(plain_text) + cipher.final\n\n  # Produce a hex representation\n  # &quot;\\xF3\\x05\\x12Y\\xF8&lt;|\\xA2\\xAC\\x01*9lL\\bH&quot; =&gt; 'f3051259f83c7ca2ac012a396c4c0848'\n  cipher_text.unpack('C*').map { |byte| byte.to_s(16) }.map { |str| str.rjust(2, &quot;0&quot;) }.join\nend\n\nencrypt('dummy string', 'secret password') # =&gt; &quot;f3051259f83c7ca2ac012a396c4c0848&quot;\n</code></pre>\n"}], "owner": {"reputation": 208794, "user_id": 229044, "user_type": "moderator", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/591426cbbacd4025d920467bad356911?s=128&d=identicon&r=PG&f=1", "display_name": "meagar", "link": "https://stackoverflow.com/users/229044/meagar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 374, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1595644170, "creation_date": 1563339266, "question_id": 57068729, "link": "https://stackoverflow.com/questions/57068729/how-can-i-decrypt-data-encrypted-by-nodes-deprecated-createcipher-in-ruby", "title": "How can I decrypt data encrypted by Node&#39;s deprecated createCipher, in Ruby?", "body": "<p>I have some legacy data, encrypted in Node, which I need to decrypt in Ruby.</p>\n\n<p>The problem is, the data was encrypted with a now deprecated method, <a href=\"https://nodejs.org/api/crypto.html#crypto_crypto_createcipher_algorithm_password_options\" rel=\"nofollow noreferrer\"><code>createCipher</code></a>. This method uses a password to perform encryption. It has been replaced by <a href=\"https://nodejs.org/api/crypto.html#crypto_crypto_createcipheriv_algorithm_key_iv_options\" rel=\"nofollow noreferrer\"><code>createCipheriv</code></a>, which requires a 32 byte key and a 16 byte initialization vector.</p>\n\n<p>In Node, I can decrypt the string with the similarly deprecated <a href=\"https://nodejs.org/api/crypto.html#crypto_crypto_createdecipher_algorithm_password_options\" rel=\"nofollow noreferrer\"><code>createDecipher</code></a>, which also accepts a password. However, I'm not aware of any equivalent method in Ruby, which makes sense, since these methods are now known to be insecure and are deprecated.</p>\n\n<p>Ruby's OpenSSL AES Cipher correctly requires a 32 byte key and 16 byte IV like the newer <code>createCipheriv</code>, but I don't have either of these, only the original password I used with <code>createCipher</code>.</p>\n\n<p>How can I get <code>createCipher</code>/<code>createDecipher</code>-like behavior in Ruby? </p>\n\n<p>Specifically, given the following JavaScript...</p>\n\n<pre><code>const crypto = require('crypto');\n\nconst cipher = crypto.createCipher(\"aes-256-cbc\", 'secret password');\ncipherText = cipher.update('dummy string', \"utf8\", \"hex\") + cipher.final(\"hex\");\n\nconsole.log(cipherText); // f3051259f83c7ca2ac012a396c4c0848\n</code></pre>\n\n<p>... how can I use the password <code>'secret password'</code> to decrypt the string <code>'f3051259f83c7ca2ac012a396c4c0848'</code> and arrive back at the input value <code>'dummy string'</code> in Ruby?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-5"], "comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1563328883, "post_id": 57067441, "comment_id": 100659631, "body": "It looks like there&#39;s an extra <code>=</code> in here before <code>comment_json[:replies]</code> which does an inadvertent chain assignment."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1563328950, "post_id": 57067441, "comment_id": 100659647, "body": "Normally for things like that you put them in <code>config&#47;initializers</code> like <code>will_paginate.rb</code> would be the expected file there."}, {"owner": {"reputation": 103, "user_id": 8062293, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e81a9452db8120a5005dbf819c262e70?s=128&d=identicon&r=PG&f=1", "display_name": "Danks", "link": "https://stackoverflow.com/users/8062293/danks"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1563329190, "post_id": 57067441, "comment_id": 100659690, "body": "@tadman thank you and i placed the require on the initializer and still this NoMethodError: undefined method `pages&#39; for # Array! so this is related to the map somehow?  can you test it?"}], "answers": [{"tags": [], "owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "is_accepted": true, "score": 2, "last_activity_date": 1563329588, "creation_date": 1563329588, "answer_id": 57067646, "question_id": 57067441, "link": "https://stackoverflow.com/questions/57067441/nomethoderror-undefined-method-pages-for-array-when-use-as-json/57067646#57067646", "title": "NoMethodError: undefined method `pages&#39; for # Array when use as_json", "body": "<p>When you apply <code>map</code> you yield a raw array which loses the pagination features. You need to preserve that.</p>\n\n<p>One thing you could do here to fix this is to write a <code>as_json</code> method for Comment that properly implements the logic you have in that <code>map</code>, handling the <code>user</code> and <code>replies</code> encoding correctly. The goal here is to get rid of that step in the controller, move that to the model where it belongs.</p>\n\n<p>Then this becomes:</p>\n\n<pre><code>@comments = @commentable.comments.order('created_at desc')\n  .includes(:user,:replies).paginate(page: params[:page])\n\npaginated = @comments.paginate(page: page)\n\nrender(json: {\n  comments: paginated,\n  page: page,\n  pages: paginated.pages,\n  status: 200\n})\n</code></pre>\n"}], "owner": {"reputation": 103, "user_id": 8062293, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e81a9452db8120a5005dbf819c262e70?s=128&d=identicon&r=PG&f=1", "display_name": "Danks", "link": "https://stackoverflow.com/users/8062293/danks"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 128, "favorite_count": 0, "accepted_answer_id": 57067646, "answer_count": 1, "score": 0, "last_activity_date": 1563350192, "creation_date": 1563327749, "last_edit_date": 1563350192, "question_id": 57067441, "link": "https://stackoverflow.com/questions/57067441/nomethoderror-undefined-method-pages-for-array-when-use-as-json", "title": "NoMethodError: undefined method `pages&#39; for # Array when use as_json", "body": "<p>I know that this is a answered question, but today as I setup a simple map over a array this issue comes again!</p>\n\n<p>the map unlike the common way to do it is using <code>as_json</code></p>\n\n<pre><code> def index\n    @allcomments = @commentable.comments.order('created_at desc')\n    .includes(:user,:replies).paginate page: params[:page]\n\n    @comments = @allcomments.map do |comment|\n      comment_json = comment.as_json\n      comment_json[:user] = comment.user.as_json\n      comment_json[:replies] = comment.replies.as_json\n      comment_json\n    end\n\n    render json: {\n      comments: @comments.paginate(page: page),\n      page: page,\n      pages: @comments.pages,\n      status: 200\n    }\n  end\n</code></pre>\n\n<p>As the answer should be place <code>require 'will_paginate/array'</code> on the initializer, I did, or on the <code>ApplicationController</code>, I did too, or on the comments controller I did it too!</p>\n\n<p>So, someone has any clue about this particular issue with <code>will_paginate</code>? </p>\n"}, {"tags": ["regex", "ruby"], "comments": [{"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1563333232, "post_id": 57067069, "comment_id": 100660358, "body": "Is this one string held by a variable or several strings, each held by a variable or the elements of an array? If so, you should to include the sting(s) in quotes and assign variable(s). If not, is it an image of a text file? If so, are there empty lines between each non-empty line?"}], "answers": [{"comments": [{"owner": {"reputation": 9, "user_id": 6279001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cf9403881919eace4857ee5504812725?s=128&d=identicon&r=PG&f=1", "display_name": "Robin", "link": "https://stackoverflow.com/users/6279001/robin"}, "edited": false, "score": 1, "creation_date": 1563419578, "post_id": 57068451, "comment_id": 100695862, "body": "Also a good idea, thanks Emma."}], "tags": [], "owner": {"reputation": 1, "user_id": 6553328, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/omcAX.jpg?s=128&g=1", "display_name": "Emma", "link": "https://stackoverflow.com/users/6553328/emma"}, "is_accepted": true, "score": 0, "last_activity_date": 1563419757, "last_edit_date": 1563419757, "creation_date": 1563337012, "answer_id": 57068451, "question_id": 57067069, "link": "https://stackoverflow.com/questions/57067069/how-to-using-ruby-to-match-string/57068451#57068451", "title": "How to using ruby to match string?", "body": "<p>This expression is likely to extract those desired dates and times right after the <code>HHH</code>:</p>\n\n<pre><code>(?&lt;=HHH)\\s*(\\s*\\d{4}\\s*-\\s*\\d{2}\\s*-\\s*\\d{2})\\s+(.+?)\\s+-\\s+(\\s*\\d{4}\\s*-\\s*\\d{2}\\s*-\\s*\\d{2}\\s*)\\s(.+?)\\s+[A-Z]{3}\n</code></pre>\n\n<p>and it can be also much simplified. </p>\n\n<p>The expression is explained on the top right panel of <a href=\"https://regex101.com/r/qwI2y1/1/\" rel=\"nofollow noreferrer\">this demo</a> if you wish to explore/simplify/modify it. </p>\n\n<h3>Test</h3>\n\n<pre><code>re = /(?&lt;=HHH)\\s*(\\s*\\d{4}\\s*-\\s*\\d{2}\\s*-\\s*\\d{2})\\s+(.+?)\\s+-\\s+(\\s*\\d{4}\\s*-\\s*\\d{2}\\s*-\\s*\\d{2}\\s*)\\s(.+?)\\s+[A-Z]{3}/\nstr = '\n\n2019-07-13 09:01 - 2019-07-17 08:59 CET (+2)\n\nHHH\n\n2019-07-13 09:01 - 2019-07-17 08:59 CET (+2)'\n\nstr.scan(re) do |match|\n    puts match.to_s\nend\n</code></pre>\n\n<h3>Output</h3>\n\n<pre><code>[\"2019-07-13\", \"09:01\", \"2019-07-17\", \"08:59\"]\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 9, "user_id": 6279001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cf9403881919eace4857ee5504812725?s=128&d=identicon&r=PG&f=1", "display_name": "Robin", "link": "https://stackoverflow.com/users/6279001/robin"}, "edited": false, "score": 0, "creation_date": 1563419537, "post_id": 57068711, "comment_id": 100695847, "body": "For my case: <code>&#47;^(?&lt;=#{target}\\n\\n).+&#47;</code>"}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "reply_to_user": {"reputation": 9, "user_id": 6279001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cf9403881919eace4857ee5504812725?s=128&d=identicon&r=PG&f=1", "display_name": "Robin", "link": "https://stackoverflow.com/users/6279001/robin"}, "edited": false, "score": 0, "creation_date": 1563422530, "post_id": 57068711, "comment_id": 100696428, "body": "Re <code>\\n\\n</code> vs <code>\\n</code>, I did ask you about that in a comment, but you never replied."}], "tags": [], "owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "is_accepted": false, "score": 1, "last_activity_date": 1563339600, "last_edit_date": 1563339600, "creation_date": 1563339138, "answer_id": 57068711, "question_id": 57067069, "link": "https://stackoverflow.com/questions/57067069/how-to-using-ruby-to-match-string/57068711#57068711", "title": "How to using ruby to match string?", "body": "<p>I assume the text is a single string (which may have been read from a file).</p>\n\n<pre><code>text =&lt;&lt;END\nAAA\n2019-07-13 02:01 - 2019-07-17 01:59 CST (-5)\nBBB\n2019-07-13 17:01 - 2019-07-17 16:59 AEST (+10)\nCCC\n2019-07-13 15:01 - 2019-07-17 14:59 CST (+8)\nDDD\n2019-07-13 15:01 - 2019-07-17 14:59 CST (+8)\nEEE\n2019-07-13 15:01 - 2019-07-17 14:59 CST (+8)\nFFF\n2019-07-13 09:01 - 2019-07-17 08:59 CET (+2)\nGGG\n2019-07-13 09:01 - 2019-07-17 08:59 CET (+2)\nHHH\n2019-07-13 09:01 - 2019-07-17 08:59 CET (+2)\nIII\n2019-07-13 03:01 - 2019-07-17 02:59 EST (-4)\nJJJ\n2019-07-13 03:01 - 2019-07-17 02:59 EST (-4)\nKKK\n2019-07-13 00:01 - 2019-07-16 23:59 PST (-7)\nLLL\n2019-07-13 15:01 - 2019-07-17 14:59 CST (+8)\nMMM\n2019-07-13 09:01 - 2019-07-17 08:59 CET (+2)\n2019-07-13 07:01 UTC - 2019-07-17 06:59 UTC\nEND\n</code></pre>\n\n<p>We set <code>target</code> equal to the line preceding the line of interest.</p>\n\n<pre><code>target = 'HHH'\n</code></pre>\n\n<p>We can use the following regular expression.</p>\n\n<pre><code>r = /\n    ^              # match the beginning of a line\n    (?&lt;=           # begin a positive lookbehind\n      #{target}    # match the value of target\n      \\n           # match the end of the line\n    )              # end the positive lookbehind\n    .+             # match one or more characters\n    /x             # free-spacing regex-definition mode\n  #=&gt;\n    /\n    ^\n    (?&lt;=\n      HHH\n      \\n\n    )\n   .+\n    /x\n</code></pre>\n\n<p>This is more commonly written as follows:</p>\n\n<pre><code>/^(?&lt;=#{target}\\n).+/\n</code></pre>\n\n<p>This will extract the desired line:</p>\n\n<pre><code>s = text[r]\n  #=&gt; \"2019-07-13 09:01 - 2019-07-17 08:59 CET (+2)\"\n</code></pre>\n\n<p>Now break this up and obtain the desired <code>Time</code> objects.</p>\n\n<pre><code>require 'time'\n\nf,t,z = s.split /\\s-\\s|\\s+(?=\\p{Lu})\n  #=&gt; [\"2019-07-13 09:01\", \"2019-07-17 08:59\", \"CET (+2)\"]\nz = z[/[+-]\\d+/] &lt;&lt; '000'\n  #=&gt; \"+2000\" \nstart_date, end_date = [f,t].map do |s|\n  DateTime.strptime(s+z, '%Y-%m-%d %H:%M%Z')\nend.map(&amp;:to_time)\n  #=&gt; [2019-07-13 09:01:00 +2000, 2019-07-17 08:59:00 +2000]\n</code></pre>\n\n<p>Thus,</p>\n\n<pre><code>start_date\n  #=&gt; 2019-07-13 09:01:00 +2000\nend_date\n  #=&gt; 2019-07-17 08:59:00 +2000\n</code></pre>\n"}], "owner": {"reputation": 9, "user_id": 6279001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cf9403881919eace4857ee5504812725?s=128&d=identicon&r=PG&f=1", "display_name": "Robin", "link": "https://stackoverflow.com/users/6279001/robin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 84, "favorite_count": 0, "closed_date": 1563344624, "accepted_answer_id": 57068451, "answer_count": 2, "score": 0, "last_activity_date": 1563419757, "creation_date": 1563323717, "last_edit_date": 1563337046, "question_id": 57067069, "link": "https://stackoverflow.com/questions/57067069/how-to-using-ruby-to-match-string", "closed_reason": "Not suitable for this site", "title": "How to using ruby to match string?", "body": "<p>I got some strings like above, and I want to get the start time and end time for HHH, I have no idea of how to match the expected string. Is anyone can help me on regular expression to make this come true. </p>\n\n<pre><code>AAA\n\n2019-07-13 02:01 - 2019-07-17 01:59 CST (-5)\n\nBBB\n\n2019-07-13 17:01 - 2019-07-17 16:59 AEST (+10)\n\nCCC\n\n2019-07-13 15:01 - 2019-07-17 14:59 CST (+8)\n\nDDD\n\n2019-07-13 15:01 - 2019-07-17 14:59 CST (+8)\n\nEEE\n\n2019-07-13 15:01 - 2019-07-17 14:59 CST (+8)\n\nFFF\n\n2019-07-13 09:01 - 2019-07-17 08:59 CET (+2)\n\nGGG\n\n2019-07-13 09:01 - 2019-07-17 08:59 CET (+2)\n\nHHH\n\n2019-07-13 09:01 - 2019-07-17 08:59 CET (+2)\n\nIII\n\n2019-07-13 03:01 - 2019-07-17 02:59 EST (-4)\n\nJJJ\n\n2019-07-13 03:01 - 2019-07-17 02:59 EST (-4)\n\nKKK\n\n2019-07-13 00:01 - 2019-07-16 23:59 PST (-7)\n\nLLL\n\n2019-07-13 15:01 - 2019-07-17 14:59 CST (+8)\n\nMMM\n\n2019-07-13 09:01 - 2019-07-17 08:59 CET (+2)\n\n\n2019-07-13 07:01 UTC - 2019-07-17 06:59 UTC\n</code></pre>\n"}, {"tags": ["ruby", "recursion", "stack-overflow", "palindrome"], "comments": [{"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 2, "creation_date": 1563341344, "post_id": 57067057, "comment_id": 100662057, "body": "Doesn&#39;t your recursion get to about 900 deep, which I would think is far more than enough to raise a stack level too deep exception. Note that once you find that  <code>num1*num2</code> is a palindrome there&#39;s no point calling the method with <code>num1</code> decremented by <code>1</code> and <code>num2</code> unchanged, as that cannot lead to a larger palindrome."}], "answers": [{"comments": [{"owner": {"reputation": 175, "user_id": 11659763, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7059fcac02dc17ae08896bbaf20cfa02?s=128&d=identicon&r=PG", "display_name": "user11659763", "link": "https://stackoverflow.com/users/11659763/user11659763"}, "edited": false, "score": 0, "creation_date": 1563347254, "post_id": 57068142, "comment_id": 100664436, "body": "The reason why you need to do that in another file : YARV needs to compile the current file before executing all of its instruction so it&#39;s not aware of your compile option until it compiled everything."}, {"owner": {"reputation": 11741, "user_id": 1934428, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/072774c5d4204a1c2385560e6114a887?s=128&d=identicon&r=PG", "display_name": "user1934428", "link": "https://stackoverflow.com/users/1934428/user1934428"}, "edited": false, "score": 0, "creation_date": 1563347904, "post_id": 57068142, "comment_id": 100664805, "body": "@maxpleaner: Ist this way to enable tail recursion optimization an <i>official</i> feature of Ruby, and if yes, where is it documented? I wonder why it is not enabled automatically, as it is in quite some under languages (Erlang, Haskell,....)."}, {"owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "reply_to_user": {"reputation": 11741, "user_id": 1934428, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/072774c5d4204a1c2385560e6114a887?s=128&d=identicon&r=PG", "display_name": "user1934428", "link": "https://stackoverflow.com/users/1934428/user1934428"}, "edited": false, "score": 0, "creation_date": 1563350293, "post_id": 57068142, "comment_id": 100666076, "body": "@user1934428 I&#39;d assume it is a feature of &quot;official&quot; ruby because it works for me with just a standard ruby installation. I don&#39;t know where the docs are, I just googled to find that snippet to enable it. I do see <a href=\"https://bugs.ruby-lang.org/issues/6602\" rel=\"nofollow noreferrer\">this ruby forum post</a> about enabling it by default"}, {"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 0, "creation_date": 1563479914, "post_id": 57068142, "comment_id": 100724615, "body": "&quot;Ist this way to enable tail recursion optimization an <i>official</i> feature of Ruby&quot; \u2013 No, it is not. It is a private internal implementation detail of some specific versions of YARV. It is not part of Ruby. There is no guarantee that it will work on other Ruby implementations than YARV. There is no guarantee that it will work on future versions of YARV. In fact, <i>everything</i> in the <code>RubyVM</code> namespace is considered to by a private internal implementation detail of a specific version of a specific implementation, and pretty much by definition non-portable."}], "tags": [], "owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "is_accepted": false, "score": 4, "last_activity_date": 1563346321, "last_edit_date": 1563346321, "creation_date": 1563334166, "answer_id": 57068142, "question_id": 57067057, "link": "https://stackoverflow.com/questions/57067057/stack-level-too-deep-in-recursion-for-largest-palindrome-product-question-proje/57068142#57068142", "title": "Stack level too deep in recursion for largest palindrome product question (Project Euler)", "body": "<p>You don't have an infinite recursion bug. The stack is just running out of space because of the size of your input. To prove this, you can run your same function with the range of 2-digit numbers, instead of the 3-digit ones. It returns fine, which shows that there is no flaw with your logic.</p>\n\n<p>How to get around this? Two options.</p>\n\n<p>Option 1: You could simply not use recursion here (just use a regular nested loop instead)</p>\n\n<p>Option 2: Keep your same code and enable tail call optimization:</p>\n\n<pre><code># run_code.rb\n\nRubyVM::InstructionSequence.compile_option = {\n  tailcall_optimization: true,\n  trace_instruction: false\n}\n\nrequire './palindrome_functions.rb'\nputs largest_palindrome_prod\n# =&gt; 906609 \n</code></pre>\n\n<p>Note, for a reason I don't fully understand, the tail call optimization must be enabled <em>in a different file</em> than the code being run. So if you simply moved the compile_option line to the palindrome_functions.rb file, it wouldn't work. </p>\n\n<p>I cant really give you a full explanation of tail call optimization (look it up on Wikipedia) but from my understanding, its a heavy optimization for recursive functions that only works when the recursive call is at the <em>end</em> of the function body. Your function meets this criteria.</p>\n"}, {"tags": [], "owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "is_accepted": false, "score": 2, "last_activity_date": 1563386892, "last_edit_date": 1563386892, "creation_date": 1563347042, "answer_id": 57070264, "question_id": 57067057, "link": "https://stackoverflow.com/questions/57067057/stack-level-too-deep-in-recursion-for-largest-palindrome-product-question-proje/57070264#57070264", "title": "Stack level too deep in recursion for largest palindrome product question (Project Euler)", "body": "<p>@maxpleaner has answered your question and has shown how you can use recursion that avoids the stack level error. He also mentioned the option (which I expect he favours) of simply looping, rather than employing recursion. Below is one looping solution. The following method is used in the search<sup>1</sup>.</p>\n\n<pre><code>def check_ranges(range1, range2 = range1)\n  range1.flat_map do |n|\n    [n].product((range2.first..[n, range2.last].min).to_a)\n  end.map { |x,y| x*y }.\n      sort.\n      reverse_each.\n      find do |z|\n        arr = z.digits\n        arr == arr.reverse\n      end              \nend\n</code></pre>\n\n<p>Let's first find the largest palindrome of the product of two numbers between 960 and 999 (if there are any):</p>\n\n<pre><code>check_ranges(960..999)\n  #=&gt; nil \n</code></pre>\n\n<p>There are none. Note that this calculation was very cheap, requiring the examination of only <code>40*40/2 #=&gt; 800</code> products. Next, find the largest palindrome that is equal to the product of two numbers between 920 and 999.</p>\n\n<pre><code>check_ranges(920..999)\n  #=&gt; 888888\n</code></pre>\n\n<p>Success! Note that this method re-checks the <code>800</code> products we checked earlier. It makes more sense to examine only the cases represented by the following two calls to <code>brute_force</code>:</p>\n\n<pre><code>check_ranges(960..999, 920..959)\n  #=&gt; 888888 \ncheck_ranges(920..959)\n  #=&gt; 861168 \n</code></pre>\n\n<p>The first call computes <code>40*40 #=&gt; 1600</code> products; the second, <code>800</code> products.</p>\n\n<p>Of course, we have not yet necessarily found the largest product that is a palindrome. We do, however, have a lower bound on the largest product, which we can use to advantage. Since</p>\n\n<pre><code>888888/999\n  #=&gt; 889\n</code></pre>\n\n<p>we infer that if the product of two numbers is larger than <code>888888</code>, both of those numbers must be at least 889. We therefore need only check:</p>\n\n<pre><code>check_ranges(889..999, 889..919)\n  #=&gt; 906609 \ncheck_ranges(889..919)\n  #=&gt; 824428 \n</code></pre>\n\n<p>We are finished. This tells us that <code>906609</code> is the largest product of two 3-digit numbers that is a palindrome.</p>\n\n<p>The question does not ask what are the two numbers whose product is the largest palindrome, but we can easily find them:</p>\n\n<pre><code>(889..999).to_a.product((889..919).to_a).find { |x,y| x*y == 906609 }\n  #=&gt; [993, 913] \n993*913\n  #=&gt; 906609\n</code></pre>\n\n<p>Moreover, let:</p>\n\n<pre><code>a = (889..999).to_a.product((889..919).to_a).map { |x,y| x*y }.\n      sort.\n      reverse\n</code></pre>\n\n<p>Then:</p>\n\n<pre><code>a.index { |n| n == 906609 }\n  #=&gt; 84\n</code></pre>\n\n<p>tells us that only the largest <code>84</code> elements of this sorted group of <code>111*31 #=&gt; 3441</code> products had to be examined before a palindrome (<code>906609</code>) was found.  </p>\n\n<p>All of this needs to be organized into a method. Though challenging for a newbie, it should be a good learning experience.</p>\n\n<p><sup>1. It would be useful to test which is faster, <code>arr = z.digits; arr == arr.reverse</code> or <code>s = z.to_s; s == s.reverse</code>.</sup></p>\n"}, {"tags": [], "owner": {"reputation": 9663, "user_id": 5239030, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/76JEw.png?s=128&g=1", "display_name": "iGian", "link": "https://stackoverflow.com/users/5239030/igian"}, "is_accepted": false, "score": 0, "last_activity_date": 1563370901, "last_edit_date": 1563370901, "creation_date": 1563369950, "answer_id": 57076987, "question_id": 57067057, "link": "https://stackoverflow.com/questions/57067057/stack-level-too-deep-in-recursion-for-largest-palindrome-product-question-proje/57076987#57076987", "title": "Stack level too deep in recursion for largest palindrome product question (Project Euler)", "body": "<p>@maxpleaner already answered, @Cary Swoveland already showed one brute force way using <code>ranges</code> and <code>product</code>. I'd like to show another brute force using a nested loop, easier to follow (IMO):</p>\n\n<pre><code>n = 9999\n\nres = [0]\nbottom = 10**(n.digits.size - 1)\n\nn.downto(bottom) do |k|\n  k.downto(bottom) do |j|\n    # puts \"#{k}, #{j}\"\n    res = [k, j, k * j] if check_pal(k * j) &amp;&amp; k * j &gt; res.last\n  end\nend\n\nres\n#=&gt; [9999, 9901, 99000099]\n</code></pre>\n\n<p><hr>\nI guess it can be optimized further, for example, using</p>\n\n<pre><code>n.downto(n*99/100) do |k|\n  k.downto(k*99/100) do |j|\n</code></pre>\n\n<p>Returned <code>[99979, 99681, 9966006699]</code> in 0.7 seconds.</p>\n\n<p><hr>\nNot required, but this increases the speed:</p>\n\n<pre><code>def check_pal(num)\n  word = num.to_s\n  word.reverse == word\nend\n</code></pre>\n"}], "owner": {"reputation": 37, "user_id": 8121296, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/dbefa2e235f2ffb5adf51aeccf9825a0?s=128&d=identicon&r=PG&f=1", "display_name": "user392500", "link": "https://stackoverflow.com/users/8121296/user392500"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 158, "favorite_count": 0, "answer_count": 3, "score": 3, "last_activity_date": 1563386892, "creation_date": 1563323598, "last_edit_date": 1563350338, "question_id": 57067057, "link": "https://stackoverflow.com/questions/57067057/stack-level-too-deep-in-recursion-for-largest-palindrome-product-question-proje", "title": "Stack level too deep in recursion for largest palindrome product question (Project Euler)", "body": "<p>I'm trying to implement a recursive solution to the largest palindrome product <a href=\"https://projecteuler.net/problem=4\" rel=\"nofollow noreferrer\">problem</a></p>\n\n<p>What I'm trying to do is start both numbers at 999 and iterate down to 100 for num1 and then restart num1 at 999 and iterate num2 down by 1. </p>\n\n<p>The goal is basically to mimic a nested for-loop. </p>\n\n<pre><code>def largest_palindrome_prod(num1 = 999, num2 = 999, largest_so_far = 0)\n  prod = num1 * num2\n  largest_so_far = prod if prod &gt; largest_so_far &amp;&amp; check_pal(prod)\n\n  if num2 == 100\n    return largest_so_far\n  elsif num1 == 100\n    largest_palindrome_prod(num1 = 999, num2 -= 1, largest_so_far)\n  else\n    largest_palindrome_prod(num1 -= 1, num2, largest_so_far)\n  end\nend\n\n#I know this function works, just here for reference\ndef check_pal(num)\n  num = num.to_s if num.is_a? Integer\n  if num.length &lt; 2\n    true\n  else\n    num[0] == num[-1] ? check_pal(num[1..-2]) : false\n  end\nend\n</code></pre>\n\n<p><code>rb:10:in</code>largest_palindrome_prod': stack level too deep`</p>\n\n<p>I'm getting this error which is referring to the else statement in the largest_palindrome_prod function, but I can't figure out wast could be causing the stack error.</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 11788620, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b82d40eea5304faa1672a9146c3911be?s=128&d=identicon&r=PG&f=1", "display_name": "Dbbooke", "link": "https://stackoverflow.com/users/11788620/dbbooke"}, "edited": false, "score": 0, "creation_date": 1563319486, "post_id": 57066612, "comment_id": 100658040, "body": "Ive tried that as well but it says it couldn&#39;t find Game without an ID"}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "reply_to_user": {"reputation": 1, "user_id": 11788620, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b82d40eea5304faa1672a9146c3911be?s=128&d=identicon&r=PG&f=1", "display_name": "Dbbooke", "link": "https://stackoverflow.com/users/11788620/dbbooke"}, "edited": false, "score": 1, "creation_date": 1563319641, "post_id": 57066612, "comment_id": 100658065, "body": "@Dbbooke: you don&#39;t even need a game, it seems. Just a merchant_id. Maybe <code>game.user</code> is the same as <code>current_user</code> (but I have no idea). In any case, before using an object, you have to obtain a reference to it <i>somehow</i>."}, {"owner": {"reputation": 1, "user_id": 11788620, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b82d40eea5304faa1672a9146c3911be?s=128&d=identicon&r=PG&f=1", "display_name": "Dbbooke", "link": "https://stackoverflow.com/users/11788620/dbbooke"}, "edited": false, "score": 0, "creation_date": 1563320568, "post_id": 57066612, "comment_id": 100658217, "body": "well current_user would not be the game owner as they would not be purchasing their own game"}, {"owner": {"reputation": 579, "user_id": 4251975, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5e702c6ee92d30ba83aea6f0b064a084?s=128&d=identicon&r=PG", "display_name": "Yurii", "link": "https://stackoverflow.com/users/4251975/yurii"}, "reply_to_user": {"reputation": 1, "user_id": 11788620, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b82d40eea5304faa1672a9146c3911be?s=128&d=identicon&r=PG&f=1", "display_name": "Dbbooke", "link": "https://stackoverflow.com/users/11788620/dbbooke"}, "edited": false, "score": 0, "creation_date": 1563325530, "post_id": 57066612, "comment_id": 100659068, "body": "I&#39;d say you need to hidden game_id input to the form. Can you share snippet with the form? @Dbbooke"}], "tags": [], "owner": {"reputation": 579, "user_id": 4251975, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5e702c6ee92d30ba83aea6f0b064a084?s=128&d=identicon&r=PG", "display_name": "Yurii", "link": "https://stackoverflow.com/users/4251975/yurii"}, "is_accepted": false, "score": 0, "last_activity_date": 1563319222, "creation_date": 1563319222, "answer_id": 57066612, "question_id": 57066564, "link": "https://stackoverflow.com/questions/57066564/undefined-varibale-game-on-stripe-charge/57066612#57066612", "title": "Undefined varibale &quot;game&quot; on stripe charge", "body": "<p>You need to declare <code>game</code> variable before using it at <code>LineItemsController#charge</code></p>\n\n<p>Smth like <code>game = Game.find(params[:game_id])</code> before <code>Stripe::Charge.create...</code></p>\n"}], "owner": {"reputation": 1, "user_id": 11788620, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b82d40eea5304faa1672a9146c3911be?s=128&d=identicon&r=PG&f=1", "display_name": "Dbbooke", "link": "https://stackoverflow.com/users/11788620/dbbooke"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 59, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1563328171, "creation_date": 1563318782, "last_edit_date": 1563328171, "question_id": 57066564, "link": "https://stackoverflow.com/questions/57066564/undefined-varibale-game-on-stripe-charge", "title": "Undefined varibale &quot;game&quot; on stripe charge", "body": "<p>I am using a stripe card which works perfect however I am using stripe connect for a marketplace where it sends out payment to different users depending on their merchant ID. I am getting an error for \"game\".</p>\n\n<p>Iv'e also tried defining the varibale game = Game.find(params[:game_id])\n but I get an error 'Couldn't find Game without an ID'</p>\n\n<p>Here's my stripe method:</p>\n\n<pre><code>class LineItemsController &lt; ApplicationController\n    def charge\n        price = params[:amount].to_f*100\n        Stripe::Charge.create({\n            amount: price.to_i,\n            currency: 'usd',\n            source: params[:stripeToken], # obtained with Stripe.js\n            description: 'plan',\n            :destination =&gt; {\n                :amount =&gt; price * 94, \n                :account =&gt; game.user.merchant_id\n              }\n          })\n\n        rescue Stripe::CardError =&gt; e\n          flash[:error] = e.message\n          redirect_to new_charge_path\n      end\n    end\n</code></pre>\n\n<p><code>line_items</code> belongs to <code>cart</code> and I have a has_many and belongs to association between <code>game</code> and <code>line_items</code>.</p>\n\n<pre><code>class LineItem &lt; ApplicationRecord\n  belongs_to :game\n  belongs_to :cart\n\n  def total_price\n    game.price.to_i * quantity.to_i\n  end\nend\n</code></pre>\n\n<p>Here is my game model:</p>\n\n<pre><code>class Game &lt; ApplicationRecord\n  belongs_to :user\n  has_many :line_items\nend\n</code></pre>\n\n<p>here is my carts/show.html.erb file</p>\n\n<pre><code>&lt;p id=\"notice\"&gt;&lt;%= notice %&gt;&lt;/p&gt;\n\n&lt;%= link_to 'Keep Shopping', games_path %&gt;\n\n&lt;div&gt;\n    &lt;%= render(@cart.line_items) %&gt;\n&lt;/div&gt;\n&lt;div&gt;\n    &lt;%= link_to 'Empty Cart', @cart, method: :delete, data: { confirm: \"Are you sure?\" } %&gt;\n&lt;/div&gt;\n\n&lt;div&gt;\n    Total: &lt;%= number_to_currency(@cart.total_price) %&gt; \n&lt;/div&gt;\n\n\n\n&lt;script src=\"https://js.stripe.com/v3/\"&gt;&lt;/script&gt;\n&lt;form action=\"/charge\" method=\"post\" id=\"payment-form\"&gt;\n  &lt;div id=\"content\" class=\"section-padding\"&gt;\n    &lt;div class=\"container\"&gt;\n      &lt;div class=\"row\"&gt;\n          &lt;div class=\"col-md-12 col-xs-12\"&gt;\n            &lt;%= hidden_field_tag :cart_id , nil, value: @cart.id %&gt;\n            &lt;%= hidden_field_tag :amount , nil, id: \"amount\", value: @line_item.total_price %&gt;\n            &lt;input \n                type=\"submit\" \n                value=\"Pay with Card\"\n                data-key=\"&lt;%= ENV['STRIPE_PUBLISHABLE_KEY'] %&gt;\"\n                data-currency=\"usd\"\n                class=\"btn btn-primary\"\n            /&gt;\n          &lt;/div&gt;\n        &lt;/div&gt;\n      &lt;/div&gt;\n  &lt;/div&gt;\n&lt;/form&gt;\n\n&lt;script src=\"https://checkout.stripe.com/v2/checkout.js\"&gt;&lt;/script&gt;\n&lt;script&gt;\n$(document).ready(function() {\n    $(':submit').on('click', function(event) {\n        event.preventDefault();\n        var $button = $(this),\n            $form = $button.parents('form');\n        var opts = $.extend({}, $button.data(), {\n            token: function(result) {\n                $form.append($('&lt;input&gt;').attr({ type: 'hidden', name: 'stripeToken', value: result.id })).submit();\n            }\n        });\n        StripeCheckout.open(opts);\n    });\n});\n&lt;/script&gt;\n</code></pre>\n\n<p>So whats going on is games has_many line items. Line items belongs to game and cart. Cart just has many line items</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-5"], "answers": [{"comments": [{"owner": {"reputation": 2960, "user_id": 7426461, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/Ldwxy.jpg?s=128&g=1", "display_name": "Cannon Moyer", "link": "https://stackoverflow.com/users/7426461/cannon-moyer"}, "edited": false, "score": 0, "creation_date": 1563320859, "post_id": 57066495, "comment_id": 100658286, "body": "That&#39;s what I&#39;m referring to in regard to ERB. What I don&#39;t understand is many blogs and third party resources claim that html_escape is no longer necessary if you&#39;re rendering a String within your view, but I cannot find any validation of that in the Rails documentation."}], "tags": [], "owner": {"reputation": 5292, "user_id": 2727267, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/0e7c773908a4f6095f63cb9553bbc7af?s=128&d=identicon&r=PG", "display_name": "Beartech", "link": "https://stackoverflow.com/users/2727267/beartech"}, "is_accepted": true, "score": 1, "last_activity_date": 1563323924, "last_edit_date": 1563323924, "creation_date": 1563318156, "answer_id": 57066495, "question_id": 57066022, "link": "https://stackoverflow.com/questions/57066022/properly-escaping-a-string-inside-a-view/57066495#57066495", "title": "Properly Escaping a String inside a View", "body": "<p>Found it:</p>\n\n<p><a href=\"https://guides.rubyonrails.org/3_0_release_notes.html\" rel=\"nofollow noreferrer\">https://guides.rubyonrails.org/3_0_release_notes.html</a></p>\n\n<p>\"7.4.3 Other Changes\nYou no longer need to call h(string) to escape HTML output, it is on by default in all view templates. If you want the unescaped string, call raw(string).\"</p>\n\n<hr>\n\n<p>escapeHTML() (or its alias h()) are from CGI::escapeHTML, which is a Ruby API implementation. If you aren't using Rails you still have a way to escape HTML. Rails may do some automagical handling of HTML in ERB files for display, and that is what you are probably referring to with <code>html_escape \"some string\"</code> and <code>&lt;%= \"some string\" %&gt;</code>. I think you are possibly confusing <code>html_escape</code> which you might need when displaying urls and such that are stored in the DB and you want the ERB processor to not mess it up? I know sometimes, particularly in <code>.js.erb</code> files I need to escape some things to get the result I was expecting. This is different than sanitizing. It seems in your example they are referring to something that you might accept and then redisplay, like a search string. If you put <code>&lt;i&gt;hello&lt;/i&gt;</code> into a search box you would want to sanitize the input before passing it to the back end, or if you are using some javascript to filter you might want to escape it both for security reasons and to let it re-display correctly in the search box after you've filtered. </p>\n\n<p>Edit: I was not able to find the answer to your comment in the ri doc either. But I tried:</p>\n\n<pre><code>&lt;%= \"&lt;b&gt;hello&lt;/b&gt;\" %&gt;\n&lt;%= h(\"&lt;b&gt;hello&lt;/b&gt;\") %&gt;\n</code></pre>\n\n<p>And got the same result in the browser:</p>\n\n<pre><code>&amp;lt;b&amp;gt;hello&amp;lt;/b&amp;gt;\n&amp;lt;b&amp;gt;hello&amp;lt;/b&amp;gt;\n</code></pre>\n\n<p>So if you are asking if it is true, then I would say yes.</p>\n"}], "owner": {"reputation": 2960, "user_id": 7426461, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/Ldwxy.jpg?s=128&g=1", "display_name": "Cannon Moyer", "link": "https://stackoverflow.com/users/7426461/cannon-moyer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 78, "favorite_count": 0, "accepted_answer_id": 57066495, "answer_count": 1, "score": 0, "last_activity_date": 1563323924, "creation_date": 1563314591, "question_id": 57066022, "link": "https://stackoverflow.com/questions/57066022/properly-escaping-a-string-inside-a-view", "title": "Properly Escaping a String inside a View", "body": "<p>I've read in multiple places that as of Rails 3 you no longer have to use <code>html_escape \"some string\"</code> to actually escape a string in a view and that simply writing <code>&lt;%= \"some string\" %&gt;</code> would escape the string by default. However, I cannot find this information in the docs. I read through the XSS in the Rails guides section that stated this:</p>\n\n<p><a href=\"https://guides.rubyonrails.org/security.html#cross-site-scripting-xss\" rel=\"nofollow noreferrer\">https://guides.rubyonrails.org/security.html#cross-site-scripting-xss</a></p>\n\n<blockquote>\n  <p>As a second step, it is good practice to escape all output of the application, especially when re-displaying user input, which hasn't been input-filtered (as in the search form example earlier on). Use escapeHTML() (or its alias h()) method to replace the HTML input characters &amp;, \", &lt;, and > by their uninterpreted representations in HTML (&amp;, &quot;, &lt;, and &gt;).</p>\n</blockquote>\n\n<p>Then I see several blogs that state that it is escaped by default. For example: <a href=\"https://www.netsparker.com/blog/web-security/preventing-xss-ruby-on-rails-web-applications/\" rel=\"nofollow noreferrer\">https://www.netsparker.com/blog/web-security/preventing-xss-ruby-on-rails-web-applications/</a></p>\n\n<p><a href=\"https://dzone.com/articles/preventing-cross-site-scripting-vulnerabilities-wh\" rel=\"nofollow noreferrer\">https://dzone.com/articles/preventing-cross-site-scripting-vulnerabilities-wh</a></p>\n"}, {"tags": ["regex", "ruby", "date-parsing"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 11666817, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f94bfbc906f8ac86327d3f953cea3315?s=128&d=identicon&r=PG&f=1", "display_name": "Abhinav Kannojia", "link": "https://stackoverflow.com/users/11666817/abhinav-kannojia"}, "edited": false, "score": 0, "creation_date": 1563397652, "post_id": 57067965, "comment_id": 100691211, "body": "Thanks it was a great explanation."}], "tags": [], "owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "is_accepted": true, "score": 1, "last_activity_date": 1563332887, "last_edit_date": 1563332887, "creation_date": 1563332505, "answer_id": 57067965, "question_id": 57065644, "link": "https://stackoverflow.com/questions/57065644/when-i-used-guard-case-in-sum-time-method-one-test-case-failed-any-suggestions/57067965#57067965", "title": "When I used guard case in sum_time method one test case failed, any suggestions?", "body": "<p>Firstly, I would recommend against polluting the core Ruby class <code>Time</code>. The needed methods could be housed in a custom class or possibly defined at the level of <code>main</code> (as I have done below).</p>\n\n<p>Nor would I make use of the classes <code>Time</code> or <code>DateTime</code>. It's easier to just deal with strings. Begin by constructing a regular expression that will be used to determine if each time string is valid. </p>\n\n<pre><code>VALID_TIME = /\n             \\A        # match beginning of string\n             (?:       # begin non-capture of group\n               0?\\d    # optionally match a zero followed by a digit\n               |       # or\n               1\\d     # match 1 followed by a digit\n               |       # or\n               2[0-3]  # match 2 followed by a digit 0, 1, 2 or 3\n             )         # end non-capture group\n             (?:       # begin a non-capture group\n               :       # match a colon\n               [0-5]   # match a digit 0, 1, 2, 3, 4 or 5\n               \\d      # match a digit\n             )         # end non-capture group\n             {2}       # execute the previous non-capture group twice\n             /x        # free-spacing regex-definition mode\n</code></pre>\n\n<p>Writing regular expressions in free-spacing mode has the advantage that it makes them self-documenting. This regular expression is conventionally written as follows:</p>\n\n<pre><code>/\\A(?:0?\\d|1\\d|2[0-3])(?::[0-5]\\d){2}/\n</code></pre>\n\n<p>Our main method might be <code>total_times</code>, to which is passed one or more strings representing twenty-four hour times.</p>\n\n<pre><code>def total_times(*time_strings)\n  seconds    = tot_seconds(*time_strings)\n  days, hrs  = seconds.divmod(24*3600)\n  hrs,  mins = hrs.divmod(3600)\n  mins, secs = mins.divmod(60)\n  [days, hrs, mins, secs]\nend\n</code></pre>\n\n<p>This first calls a method <code>tot_seconds</code>, having the same arguments. That method returns the sum of the number of seconds since midnight for each of the times it is passed. Once the total number of seconds is obtained, <a href=\"http://ruby-doc.org/core-2.6.3/Integer.html#method-i-divmod\" rel=\"nofollow noreferrer\">Integer#divmod</a> is used repeatedly to compute the equivalent numbers of days, hour, minutes and seconds.</p>\n\n<pre><code>def tot_seconds(*time_strings)\n  time_strings.sum { |time_str| time_str_to_seconds(time_str) }\nend\n</code></pre>\n\n<p>This method passes each time string to the method <code>time_str_to_seconds</code>, which returns the number of seconds since midnight for that time string.</p>\n\n<pre><code>def time_str_to_seconds(time_str)\n  raise ArgumentError, \"'#{time_str}' is an invalid 24-hour time value\" unless\n    time_str.match?(VALID_TIME)\n  [3600, 60, 1].zip(time_str.split(':')).\n                reduce(0) { |tot,(n,s)| tot + n*s.to_i }\nend\n</code></pre>\n\n<p>This method first checks the validity of the time string. If it is found to be invalid an exception is raised. This seemed like the best place to put the validity check. If the string is found to be valid it is split into strings representing hours, minutes and seconds, which are then converted to integers and combined to obtain number of seconds.</p>\n\n<p>Suppose:</p>\n\n<pre><code>time_str = \"9:35:08\"\n</code></pre>\n\n<p>Then the calculations in <code>time_str_to_seconds</code> are as follows:</p>\n\n<pre><code>time_str.match?(VALID_TIME)\n  #=&gt; true\na = time_str.split(':')\n  #=&gt; [\"9\", \"35\", \"08\"] \nb = [3600, 60, 1].zip(a)\n  #=&gt; [[3600, \"9\"], [60, \"35\"], [1, \"08\"]]\nb.reduce(0) { |tot,(n,s)| tot + n*s.to_i }\n  #=&gt; 3600*9 + 60*35 + 1*8 =&gt; 34508\n</code></pre>\n\n<p>See <a href=\"http://ruby-doc.org/core-2.6.3/String.html#method-i-match-3F\" rel=\"nofollow noreferrer\">String#match?</a> and <a href=\"http://ruby-doc.org/core-2.6.3/Array.html#method-i-zip\" rel=\"nofollow noreferrer\">Array#zip</a>.</p>\n\n<p>Let's now try this with an example.</p>\n\n<pre><code>arr = total_times \"2:33:41\", \"23:46:08\"\n  #=&gt; [1, 2, 19, 49]\n</code></pre>\n\n<p>We might use these results as follows:</p>\n\n<pre><code>puts \"%d day &amp; %d:%2d:%2d\" % arr\n\"1 day &amp; 2:19:49\"\n</code></pre>\n\n<p>In some cases it might be preferable to write:</p>\n\n<pre><code>days, hrs, mins, secs = total_times \"2:33:41\", \"23:46:08\"\n</code></pre>\n\n<p>We can easily confirm these results.</p>\n\n<pre><code>tot_secs =  2*3600 + 33*60 + 41 +\n           23*3600 + 46*60 +  8\n  #=&gt; 94789 \ndays, hrs  = tot_secs.divmod(24*3600)\n  #=&gt; [1, 8389] \nhrs, mins  = hrs.divmod(3600)\n  #=&gt; [2, 1189] \nmins, secs = mins.divmod(60)\n  #=&gt; [19, 49] \n[days, hrs, mins, secs] \n  #=&gt; [1, 2, 19, 49] \n</code></pre>\n\n<p>Two more examples:</p>\n\n<pre><code>total_times \"11:23:07\", \"22:53:45\", \"0:23:23\", \"23:45:56\"\n  #=&gt; [2, 10, 26, 11]\ntotal_times \"24:01:10\", \"10:30:50\"\n  #=&gt; ArgumentError ('24:01:10' is an invalid 24-hour time value)\n</code></pre>\n\n<p>Note that it is not necessary to use a regular expression to determine the validity of a time string. One could write:</p>\n\n<pre><code>time_str = \"9:35:08\"\nhr, min, sec = time_str.split(':').map(&amp;:to_i)\n  #=&gt; [9, 35, 8] \n(0..23).cover?(hr) &amp;&amp; (0..59).cover?(min) &amp;&amp; (0..59).cover?(sec)\n  #=&gt; true\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 11666817, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f94bfbc906f8ac86327d3f953cea3315?s=128&d=identicon&r=PG&f=1", "display_name": "Abhinav Kannojia", "link": "https://stackoverflow.com/users/11666817/abhinav-kannojia"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 53, "favorite_count": 0, "accepted_answer_id": 57067965, "answer_count": 1, "score": -1, "last_activity_date": 1563332887, "creation_date": 1563312347, "last_edit_date": 1563313437, "question_id": 57065644, "link": "https://stackoverflow.com/questions/57065644/when-i-used-guard-case-in-sum-time-method-one-test-case-failed-any-suggestions", "title": "When I used guard case in sum_time method one test case failed, any suggestions?", "body": "<p>Write a method that sums up multiple 24-hour time values(h:m:s). Validate the time using regular expressions.</p>\n\n<p>Input and output format :\nEg: (\"11:23:07\",\"22:53:45\",\"0:23:23\",\"23:45:56\") -> \"2 day &amp; 10:26:11\"\n(\"11:23:07\") -> \"11:23:07\"</p>\n\n<p>My code is failing with one test case i.e\n\"24:01:10\" \"10:30:50\"</p>\n\n<p>Solution:</p>\n\n<pre><code>require 'time'\n# Time_Sum\nclass Time\n  KEY = /^(0\\d|1\\d|2[0-3]|\\d):[0-5]\\d?:[0-5]\\d?$/\n  def to_seconds(timestamp)\n    timestamp.hour * 3600 + timestamp.min * 60 + timestamp.sec\n  end\n\n  def validate?(time_string)\n    time_string.match(KEY)\n  end\n\n  def sum_time(*time)\n    total_seconds = 0\n    time.each do |time_item|\n      timestamp = Time.parse(time_item) if validate?(time_item)\n      total_seconds += to_seconds(timestamp) if validate?(time_item)\n      'Invalid 24-hour time value'\n    end\n    display_results(total_seconds)\n  end\n\n  def display_results(total_seconds)\n    sum_time_string = ''\n    days = (total_seconds / (24 * 3600)).to_i\n    sum_time_string = \"#{days} day &amp; \" if days &gt; 0\n    sum_time_string + Time.at(total_seconds).utc.strftime('%H:%M:%S')\n  end\nend\nreader = Time.new\nif ARGV.empty?\n  puts 'Please provide an input'\nelse\n  p reader.sum_time(*ARGV)\nend\n</code></pre>\n\n<p>Expected output : \n\"Invalid 24-hour time value\"\nActual output : \n\"10:30:50\"</p>\n\n<p>Also can someone please suggest better regex Key ?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-5.2"], "answers": [{"comments": [{"owner": {"reputation": 4416, "user_id": 2012677, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/8d7cb2fe712fb17f44f8c354bf37e7b5?s=128&d=identicon&r=PG&f=1", "display_name": "user2012677", "link": "https://stackoverflow.com/users/2012677/user2012677"}, "edited": false, "score": 0, "creation_date": 1563311279, "post_id": 57065339, "comment_id": 100656011, "body": "Genius, so how do I call Rails.application.credentials.test, as variable? like send(:test)"}], "tags": [], "owner": {"reputation": 21613, "user_id": 580346, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/ba17945a06aac247b06548d5afe341e8?s=128&d=identicon&r=PG", "display_name": "mrzasa", "link": "https://stackoverflow.com/users/580346/mrzasa"}, "is_accepted": true, "score": 3, "last_activity_date": 1563311413, "last_edit_date": 1563311413, "creation_date": 1563310681, "answer_id": 57065339, "question_id": 57065292, "link": "https://stackoverflow.com/questions/57065292/passing-test-caused-argumenterror-wrong-number-of-arguments-given-0-expected/57065339#57065339", "title": "Passing :test caused ArgumentError: wrong number of arguments (given 0, expected 2..3)", "body": "<p><code>test</code> is a private method defined in <a href=\"http://ruby-doc.org/core-2.1.1/Kernel.html#method-i-test\" rel=\"nofollow noreferrer\"><code>Kernel</code></a> module. <code>Kernel</code> is included in every ruby object.\nWhen you call <code>.send(:test)</code>  this method is invoked and it requires 2 or 3 arguments.</p>\n\n<p>It can be reproduced on other objects as well:</p>\n\n<pre><code>[15] pry(main)&gt; :a.send(:test)\nArgumentError: wrong number of arguments (given 0, expected 2..3)\nfrom (pry):23:in `test'\n[16] pry(main)&gt; 1.send(:test)\nArgumentError: wrong number of arguments (given 0, expected 2..3)\nfrom (pry):24:in `test'\n</code></pre>\n\n<p>EDIT</p>\n\n<p>I'm not sure what object is <code>credentials</code>, so I can't say it's the case for sure, but when you define <code>method_missing</code> it's invoked before private methods called directly, but not with <code>send</code>, see below:</p>\n\n<pre><code>class B\n   def method_missing(*args)\n     puts args\n   end\nend\n\npry&gt; B.new.send(:test)\nArgumentError: wrong number of arguments (given 0, expected 2..3)\nfrom (pry):32:in `test'\n\npry&gt; B.new.test\ntest\n=&gt; nil\n</code></pre>\n\n<p>EDIT2:</p>\n\n<p>In general safer than <code>#send</code> <a href=\"https://ruby-doc.org/core-2.6.3/Object.html#method-i-public_send\" rel=\"nofollow noreferrer\"><code>#public_send</code></a>. It won't let you call a private method and also it's caught by <code>#method_missing</code>:</p>\n\n<pre><code>[28] pry(main)&gt; B.new.public_send(:test)\ntest\n=&gt; nil\n</code></pre>\n"}], "owner": {"reputation": 4416, "user_id": 2012677, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/8d7cb2fe712fb17f44f8c354bf37e7b5?s=128&d=identicon&r=PG&f=1", "display_name": "user2012677", "link": "https://stackoverflow.com/users/2012677/user2012677"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 631, "favorite_count": 1, "accepted_answer_id": 57065339, "answer_count": 1, "score": 2, "last_activity_date": 1563311413, "creation_date": 1563310475, "last_edit_date": 1563311180, "question_id": 57065292, "link": "https://stackoverflow.com/questions/57065292/passing-test-caused-argumenterror-wrong-number-of-arguments-given-0-expected", "title": "Passing :test caused ArgumentError: wrong number of arguments (given 0, expected 2..3)", "body": "<p>Both of these work:</p>\n\n<pre><code>Rails.application.credentials.development\nRails.application.credentials.send(:development)\n</code></pre>\n\n<p>However, the first one, <code>.test</code> works, but (:test) does not.</p>\n\n<pre><code>Rails.application.credentials.test\nRails.application.credentials.send(:test)\n</code></pre>\n\n<p>Why is :test special? What would make this not work?  I get</p>\n\n<pre><code>[5] pry(#&lt;Cred&gt;)&gt;Rails.application.credentials.send(:test)\nArgumentError: wrong number of arguments (given 0, expected 2..3)\nfrom (pry):5:in `test'\n\n</code></pre>\n"}, {"tags": ["ruby", "metaprogramming"], "answers": [{"comments": [{"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 2, "creation_date": 1563309585, "post_id": 57064989, "comment_id": 100655307, "body": "<code>foo()</code> will also work as it enforces the method call over the local variable definition"}], "tags": [], "owner": {"reputation": 36, "user_id": 7768631, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-_i7O9OLMwVs/AAAAAAAAAAI/AAAAAAAAANo/X4eHzVffSBw/photo.jpg?sz=128", "display_name": "Varun Sharma", "link": "https://stackoverflow.com/users/7768631/varun-sharma"}, "is_accepted": false, "score": 2, "last_activity_date": 1563309000, "creation_date": 1563309000, "answer_id": 57064989, "question_id": 57064525, "link": "https://stackoverflow.com/questions/57064525/why-doesnt-instance-exec-overwrite-local-variables-present-in-a-proc-objects-b/57064989#57064989", "title": "Why doesn&#39;t instance_exec overwrite local variables present in a Proc object&#39;s binding?", "body": "<p>You can use <code>self.foo</code> explicitely</p>\n\n<p>Using it will call the bindings of the object self currently refers to rather then the closure of the state when proc/block is created.</p>\n"}], "owner": {"reputation": 31, "user_id": 9245734, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-ajs2w8AHHJ0/AAAAAAAAAAI/AAAAAAAAAfw/tkZYemt8XU4/photo.jpg?sz=128", "display_name": "Nick deLannoy", "link": "https://stackoverflow.com/users/9245734/nick-delannoy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 53, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1563309000, "creation_date": 1563306756, "question_id": 57064525, "link": "https://stackoverflow.com/questions/57064525/why-doesnt-instance-exec-overwrite-local-variables-present-in-a-proc-objects-b", "title": "Why doesn&#39;t instance_exec overwrite local variables present in a Proc object&#39;s binding?", "body": "<p>I'm writing a DSL for a project and I've run into an issue involving local variables bleeding into nested procs when I don't want them to. It seems like no matter what I try, I can't overwrite a local variable's value with something from another scope once it's been set into a proc's binding.</p>\n\n<p>an example of what I'm trying to get to work:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>class Obj\n  def foo\n    :foo\n  end\nend\n\ndef run_proc(context, &amp;block)\n  context.instance_exec(&amp;block)\nend\n\ndef run_example(context)\n  # This `foo` the local var that ends up in the binding of\n  # the proc on the next line that I can't seem to overwrite\n  foo = :bar   \n  run_proc(context) { foo }\n  # ^ I want to be able to eval `foo` based on the passed context obj\nend\n\nobj = Obj.new\n# I want all three of these calls to return `:foo`\nobj.foo                   #=&gt; :foo  # works as expected\nobj.instance_exec { foo } #=&gt; :foo  # works as expected\nrun_example(obj)          #=&gt; :bar  # doesn't work, since the `run_example`\n                                    #  method's local `foo` var takes precedence\n                                    #  over the passed object's `foo` method\n</code></pre>\n\n<p>I did some digging around and found answers with a similar approach to what I've been trying: <a href=\"https://stackoverflow.com/questions/10058996/change-the-binding-of-a-proc-in-ruby\">Change the binding of a Proc in Ruby</a>. I've also looked into the possibility of undefining the local variables in a proc's binding but this answer claims doing so is impossible: <a href=\"https://stackoverflow.com/questions/2011654/undefine-variable-in-ruby/3200814#3200814\">Undefine variable in Ruby</a>. </p>\n\n<p>So my question now is this: Should I just give up trying to nest procs and/or find a workaround that doesn't have local var/method name conflict issues, or is there actually a way to get around this?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-5", "activeadmin"], "comments": [{"owner": {"reputation": 2184, "user_id": 8352929, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a74f883702be71738a2e3d6f59e466ed?s=128&d=identicon&r=PG&f=1", "display_name": "adesurirey", "link": "https://stackoverflow.com/users/8352929/adesurirey"}, "edited": false, "score": 0, "creation_date": 1563403223, "post_id": 57061317, "comment_id": 100692769, "body": "Did my answer help you?"}, {"owner": {"reputation": 109, "user_id": 11581296, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/efcb42096f543aa1ba87060e8ad0cc60?s=128&d=identicon&r=PG&f=1", "display_name": "Chris Kenworthy", "link": "https://stackoverflow.com/users/11581296/chris-kenworthy"}, "reply_to_user": {"reputation": 2184, "user_id": 8352929, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a74f883702be71738a2e3d6f59e466ed?s=128&d=identicon&r=PG&f=1", "display_name": "adesurirey", "link": "https://stackoverflow.com/users/8352929/adesurirey"}, "edited": false, "score": 0, "creation_date": 1563546677, "post_id": 57061317, "comment_id": 100747896, "body": "Yes thank you - it&#39;s great. But it doesn&#39;t quite work yet. I&#39;ve posted a comment below. I think I&#39;ve complicated it with my nested resources. (Also not sure if this is best as a member or collection action.)"}, {"owner": {"reputation": 2184, "user_id": 8352929, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a74f883702be71738a2e3d6f59e466ed?s=128&d=identicon&r=PG&f=1", "display_name": "adesurirey", "link": "https://stackoverflow.com/users/8352929/adesurirey"}, "edited": false, "score": 1, "creation_date": 1563547587, "post_id": 57061317, "comment_id": 100748395, "body": "As you said you need the record id, you have no other choice than making it a member action"}, {"owner": {"reputation": 109, "user_id": 11581296, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/efcb42096f543aa1ba87060e8ad0cc60?s=128&d=identicon&r=PG&f=1", "display_name": "Chris Kenworthy", "link": "https://stackoverflow.com/users/11581296/chris-kenworthy"}, "reply_to_user": {"reputation": 2184, "user_id": 8352929, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a74f883702be71738a2e3d6f59e466ed?s=128&d=identicon&r=PG&f=1", "display_name": "adesurirey", "link": "https://stackoverflow.com/users/8352929/adesurirey"}, "edited": false, "score": 0, "creation_date": 1563548301, "post_id": 57061317, "comment_id": 100748786, "body": "That&#39;s correct. But the ID is for the resource nested above it - so the user has already selected a support_allocation ID. Now they&#39;re looking at all support_sessions (of which there are many on this page, no specific ID) for the current support allocation (specific ID). My custom method would send an email which includes ALL support sessions for the current support allocation: i.e. it sends an email which isn&#39;t restricted to any particular support session ID."}], "answers": [{"comments": [{"owner": {"reputation": 109, "user_id": 11581296, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/efcb42096f543aa1ba87060e8ad0cc60?s=128&d=identicon&r=PG&f=1", "display_name": "Chris Kenworthy", "link": "https://stackoverflow.com/users/11581296/chris-kenworthy"}, "edited": false, "score": 0, "creation_date": 1563546591, "post_id": 57061433, "comment_id": 100747842, "body": "This is fantastic! Thank you. It almost works... The error I get is something to do with the path, I think (&#39;undefined local variable or method&#39; in the link_to part of action_item). If I rake routes I can see a new route is generated, but this is a nested resource remember: request_approval_support_allocation_support_session. However, if I use request_approval_support_allocation_support_session_path in link_to it still creates an exception."}, {"owner": {"reputation": 109, "user_id": 11581296, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/efcb42096f543aa1ba87060e8ad0cc60?s=128&d=identicon&r=PG&f=1", "display_name": "Chris Kenworthy", "link": "https://stackoverflow.com/users/11581296/chris-kenworthy"}, "edited": false, "score": 0, "creation_date": 1563547349, "post_id": 57061433, "comment_id": 100748267, "body": "Sorry, that should read: &#39;request_approval_support_allocation_support_sessions_path&#39; - but this still raises and exception error (my method is called request_approval)."}, {"owner": {"reputation": 2184, "user_id": 8352929, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a74f883702be71738a2e3d6f59e466ed?s=128&d=identicon&r=PG&f=1", "display_name": "adesurirey", "link": "https://stackoverflow.com/users/8352929/adesurirey"}, "reply_to_user": {"reputation": 109, "user_id": 11581296, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/efcb42096f543aa1ba87060e8ad0cc60?s=128&d=identicon&r=PG&f=1", "display_name": "Chris Kenworthy", "link": "https://stackoverflow.com/users/11581296/chris-kenworthy"}, "edited": false, "score": 1, "creation_date": 1563547366, "post_id": 57061433, "comment_id": 100748277, "body": "@ChrisKenworthy Oh yes I forgot that, if you made a <code>:patch</code> action as suggested in my answer the link should be: <code>link_to &#39;Request approvals&#39;, request_approval_support_allocation_support_sessions_path, method: :patch</code> I&#39;ll update the answer"}], "tags": [], "owner": {"reputation": 2184, "user_id": 8352929, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a74f883702be71738a2e3d6f59e466ed?s=128&d=identicon&r=PG&f=1", "display_name": "adesurirey", "link": "https://stackoverflow.com/users/8352929/adesurirey"}, "is_accepted": false, "score": 2, "last_activity_date": 1563547434, "last_edit_date": 1563547434, "creation_date": 1563293218, "answer_id": 57061433, "question_id": 57061317, "link": "https://stackoverflow.com/questions/57061317/custom-action-item-with-custom-method-in-active-admin/57061433#57061433", "title": "Custom action_item with custom method in Active Admin", "body": "<p>You should code the action first, in your file: </p>\n\n<pre><code>member_action :send_for_approval, method: :patch do\n  # send your email here you can access to :resource which is your record\n  YourMailer.with(support_session_id: resource.id).your_email.deliver_now\n  # redirect to your admin index or show path\nend\n</code></pre>\n\n<p>Then <code>rails routes</code> will give you the correct path to it so you can pass it to <code>action_item</code>, it will look something like that: </p>\n\n<pre><code>action_item only: :index  do\n   link_to 'Request approvals', send_for_approval_admin_support_session_path, method: :patch\nend\n</code></pre>\n\n<p>References: </p>\n\n<p><a href=\"https://activeadmin.info/8-custom-actions.html#member-actions\" rel=\"nofollow noreferrer\">https://activeadmin.info/8-custom-actions.html#member-actions</a></p>\n\n<p><a href=\"https://activeadmin.info/8-custom-actions.html#action-items\" rel=\"nofollow noreferrer\">https://activeadmin.info/8-custom-actions.html#action-items</a></p>\n"}], "owner": {"reputation": 109, "user_id": 11581296, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/efcb42096f543aa1ba87060e8ad0cc60?s=128&d=identicon&r=PG&f=1", "display_name": "Chris Kenworthy", "link": "https://stackoverflow.com/users/11581296/chris-kenworthy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 997, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1563547434, "creation_date": 1563292805, "question_id": 57061317, "link": "https://stackoverflow.com/questions/57061317/custom-action-item-with-custom-method-in-active-admin", "title": "Custom action_item with custom method in Active Admin", "body": "<p>I have a nested resource in Active Admin which shows all SupportSessions (like meetings) for a particular SupportAllocation (which defines a teacher-pupil relationship):</p>\n\n<pre><code>ActiveAdmin.register SupportSession do\n  belongs_to :support_allocation\n</code></pre>\n\n<p>On my index page, I'd like a button at the top that the user can click (like they can click 'New Support Session'), which then executes a custom method which sends an email using ApplicationMailer. There is no 'page' where the button goes to - it just redirects back to the current index page with a message indicating success or otherwise.</p>\n\n<p>I can get the 'Request Approvals' button to appear on the index page with this code:</p>\n\n<pre><code>  # Adds a new button\n  action_item only: :index  do\n      link_to 'Request approvals', send_for_approval #custom method\n  end\n</code></pre>\n\n<p>But obviously this raises an exception:</p>\n\n<pre><code>undefined local variable or method `send_for_approval'\n</code></pre>\n\n<p>Because I haven't defined this custom method anywhere.</p>\n\n<p>I've created my mailer class but I'm not sure how to 'connect' it to my resource. I realise this will involve a new route of some sort, or use the existing 'put' method. I'd need to hand the current SupportAllocation ID to the method, so it knows which records/data to deal with when it sends email messages. </p>\n\n<p>Any tips on how do I do create a button that runs this custom method + parameter? Where do I define this new custom method?</p>\n\n<p>Thank you for your help.</p>\n"}, {"tags": ["ruby", "sinatra"], "comments": [{"owner": {"reputation": 6462, "user_id": 3784008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/55ou4.jpg?s=128&g=1", "display_name": "anothermh", "link": "https://stackoverflow.com/users/3784008/anothermh"}, "edited": false, "score": 0, "creation_date": 1563303398, "post_id": 57060846, "comment_id": 100652730, "body": "<code>c.key = key</code> returns <code>ArgumentError: key must be 24 bytes</code>. Please provide a valid example."}], "answers": [{"tags": [], "owner": {"reputation": 45322, "user_id": 421705, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/581b1760881c962648f99d6040d41829?s=128&d=identicon&r=PG", "display_name": "Holger Just", "link": "https://stackoverflow.com/users/421705/holger-just"}, "is_accepted": true, "score": 2, "last_activity_date": 1563309721, "last_edit_date": 1563309721, "creation_date": 1563305071, "answer_id": 57064172, "question_id": 57060846, "link": "https://stackoverflow.com/questions/57060846/ruby-opensslcipher-giving-different-result-tripple-des-in-cbc-mode/57064172#57064172", "title": "Ruby OpenSSL::Cipher giving different result Tripple DES in CBC Mode", "body": "<p>To get your expected results, you need to adjust your code so that OpenSSL actually knows that you are using hex-encoded data. Since OpenSSL deals with plain bytes anyway, you thus need to encode your hex string to raw bytes first:</p>\n\n<pre><code>key = [\"2315208C9110AD402315208C9110AD40\"].pack('H*')\niv = [\"0000000000000000\"].pack('H*')\ninput_text = [\"2020205a4f534135366461746574696d653d32303138313032343130303332333b6578706972793d313232323b70616e3d343233363031373839303132333435362121212121212121\"].pack('H*')\n</code></pre>\n\n<p>After that, you need to chose the right encryption algorithm. There are multiple distinct flavours of 3DES which (among other details) differ in the expected key length. Since you are dealing with a 16 byte key, it appears you are using what OpenSSL calls <code>des-ede-cbc</code></p>\n\n<pre><code>flavour = 'des-ede-cbc'\n</code></pre>\n\n<p>These adjustments alone should normally be enough to cause the same result as you would see on the website you linked to. However, for some reason unknown to me, they silently change the input data before actually encrypting it.</p>\n\n<p>The specific rules they use are unknown to me but to get the same ciphertext output as the website, you need to remove any trailing exclamation marks and remove a leading space character from your input string.</p>\n\n<pre><code>input_text # packed as you provided it originally\n# =&gt; \"   ZOSA56datetime=20181024100323;expiry=1222;pan=4236017890123456!!!!!!!!\"\n\n# remove trailing exclamation marks\ninput_text = input_text.sub(/!*$/, '') \n# remove the first character\ninput_text = input_text[1..-1]\n</code></pre>\n\n<p>Finally, you can now encrypt your \"improved\" <code>input_text</code>:</p>\n\n<pre><code>begin\n  c = OpenSSL::Cipher.new(flavour)\n  c.encrypt\n  c.key = key\n  c.iv = iv\n  enc = c.update(input_text) + c.final\n  puts \"#{flavour} gives us #{enc.unpack('H*').first.upcase}\"\nrescue =&gt; e\n  puts \"#{flavour} didn't work because #{e.message}\"\nend\n</code></pre>\n\n<p>This should result in almost the expected cipher text.</p>\n\n<p>It only slightly differs at the final block of 8 bytes though. I assume the website uses some strange non-standard padding (which is required to ensure the input text can be divided into full 8 byte chunks) which results in the final block being different.</p>\n\n<p>In any case, you can decrypt the result (as well as the \"expected\" ciphertext form the website with this code:</p>\n\n<pre><code>flavour = 'des-ede-cbc'\nkey = [\"2315208C9110AD402315208C9110AD40\"].pack('H*')\niv = [\"0000000000000000\"].pack('H*')\nencrypted = [\"4A9E9B245BBDC16D76998143CB6FC1C2B8780539C1C9A100AEC3D745B8BF00DF43A4B51A29A6205845E510E18E26AB940152F90F12E86543A9E5239B30DFDBCD8D3FCDB65F603979\"].pack('H*')\n\nc = OpenSSL::Cipher.new(flavour)\nc.decrypt\nc.key = key\nc.iv = iv\n\ndecrypted = c.update(encrypted)\n</code></pre>\n\n<p>How to get the padding right to match the result from the website will be left as an exercise to the reader :) Unfortunately, I have not found any documentation or source code for their tool.</p>\n\n<p>In any case, please note that 3DES is an incredibly outdated encryption algorithm which is not considered secure anymore. Unless you have to actually use 3DES, you should use a more secure algorithm.</p>\n\n<p>The libsodium project provides hardened implementations of secure algorithms for encryption and signing which can form a valid and secure basis for your desired protocol. There are Ruby bindings available with the <a href=\"https://github.com/crypto-rb/rbnacl\" rel=\"nofollow noreferrer\">rbnacl</a> gem.</p>\n"}], "owner": {"reputation": 75, "user_id": 3944137, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/28a1b28df6d8ff7f9b61e5b9b2938e63?s=128&d=identicon&r=PG&f=1", "display_name": "Usman Arshad", "link": "https://stackoverflow.com/users/3944137/usman-arshad"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 246, "favorite_count": 0, "accepted_answer_id": 57064172, "answer_count": 1, "score": 1, "last_activity_date": 1563309721, "creation_date": 1563291244, "question_id": 57060846, "link": "https://stackoverflow.com/questions/57060846/ruby-opensslcipher-giving-different-result-tripple-des-in-cbc-mode", "title": "Ruby OpenSSL::Cipher giving different result Tripple DES in CBC Mode", "body": "<p>I need to encrypt data with double-length Triple-DES (TDEA) symmetric key in CBC mode. I am using Ruby OpenSSl::Cipher. But it give different result as compared to BP-tool Cryptographic calculator and EMV DES Calculator. Following is my code</p>\n\n<p>Can any body help me why my results are different? I have check online tool also to verify my result. </p>\n\n<p><a href=\"http://www.emvlab.org/descalc/?key=2315208C9110AD402315208C9110AD40&amp;iv=0000000000000000&amp;input=20205A4F534135366461746574696D653D32303138313032343130303332333B6578706972793D313232323B70616E3D343233363031373839303132333435362121212121212121&amp;mode=cbc&amp;action=Encrypt&amp;output=20205A4F534135366461746574696D653D32303138313032343130303332333B6578706972793D313232323B70616E3D343233363031373839303132333435362121212121212121\" rel=\"nofollow noreferrer\">http://www.emvlab.org/descalc/?key=2315208C9110AD402315208C9110AD40&amp;iv=0000000000000000&amp;input=20205A4F534135366461746574696D653D32303138313032343130303332333B6578706972793D313232323B70616E3D343233363031373839303132333435362121212121212121&amp;mode=cbc&amp;action=Encrypt&amp;output=20205A4F534135366461746574696D653D32303138313032343130303332333B6578706972793D313232323B70616E3D343233363031373839303132333435362121212121212121</a></p>\n\n<p>It give same result as BP-tool.</p>\n\n<pre><code>flavour = 'des-ede3-cbc'\n# key and input text are in hexadecimal  \nkey = \"2315208C9110AD402315208C9110AD40\"\niv = \"0000000000000000\"\ninput_text = \"2020205a4f534135366461746574696d653d32303138313032343130303332333b6578706972793d313232323b70616e3d343233363031373839303132333435362121212121212121\"\nbegin\n  c = OpenSSL::Cipher.new flavour\n  c.encrypt\n  c.key = key\n  c.iv = iv\n  str = input_text\n  enc = c.update(str) + c.final\n  puts \"#{flavour} gives us #{enc.unpack('H*').first.upcase}\"\nrescue =&gt; e\n    puts \"#{flavour} didn't work because #{e.message}\"\nend\n</code></pre>\n\n<pre><code>Result:\n8AF0D655A844EC016E171F1892188DD5C77E6F76D79A4582313D2415D9AD6944E16C7CA680CCD0C251BA8921E7C35153F345126A89ECCD68E4B0485FFDCDA778DBBE32B38451A59AFA443A96C46E30BD7CE983078EA40F8F0196C607FF537E5A36B910A40C3B0DB8C42BD2AB135928B0BDDF6DC85CF516EACCD14E0C21B93CE428A9E4F78A13AE9834966B41C4C1835B1910BE5716D117F7\n\nThe expected result should be:\n4A9E9B245BBDC16D76998143CB6FC1C2B8780539C1C9A100AEC3D745B8BF00DF43A4B51A29A6205845E510E18E26AB940152F90F12E86543A9E5239B30DFDBCD8D3FCDB65F603979\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "error-handling", "stripe-payments", "standard-error"], "answers": [{"comments": [{"owner": {"reputation": 106, "user_id": 7987618, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pxqZ6.jpg?s=128&g=1", "display_name": "ethaning", "link": "https://stackoverflow.com/users/7987618/ethaning"}, "reply_to_user": {"reputation": 4416, "user_id": 2012677, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/8d7cb2fe712fb17f44f8c354bf37e7b5?s=128&d=identicon&r=PG&f=1", "display_name": "user2012677", "link": "https://stackoverflow.com/users/2012677/user2012677"}, "edited": false, "score": 1, "creation_date": 1563294444, "post_id": 57061560, "comment_id": 100648814, "body": "You can raise it by making some kind of invalid request, e.g. <code>retrieve</code> or <code>delete</code> an object that doesn&#39;t exist. You could also raise it forcefully by writing <code>raise Stripe::InvalidRequestError.new(&#39;No such plan: test_plan&#39;, &#39;plan&#39;)</code>"}, {"owner": {"reputation": 4416, "user_id": 2012677, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/8d7cb2fe712fb17f44f8c354bf37e7b5?s=128&d=identicon&r=PG&f=1", "display_name": "user2012677", "link": "https://stackoverflow.com/users/2012677/user2012677"}, "edited": false, "score": 0, "creation_date": 1563294512, "post_id": 57061560, "comment_id": 100648846, "body": "How can I raise it manually ? Without making an invalid request?"}, {"owner": {"reputation": 106, "user_id": 7987618, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pxqZ6.jpg?s=128&g=1", "display_name": "ethaning", "link": "https://stackoverflow.com/users/7987618/ethaning"}, "reply_to_user": {"reputation": 4416, "user_id": 2012677, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/8d7cb2fe712fb17f44f8c354bf37e7b5?s=128&d=identicon&r=PG&f=1", "display_name": "user2012677", "link": "https://stackoverflow.com/users/2012677/user2012677"}, "edited": false, "score": 0, "creation_date": 1563294641, "post_id": 57061560, "comment_id": 100648923, "body": "just edited my post a bit after you made the last comment :)"}], "tags": [], "owner": {"reputation": 106, "user_id": 7987618, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pxqZ6.jpg?s=128&g=1", "display_name": "ethaning", "link": "https://stackoverflow.com/users/7987618/ethaning"}, "is_accepted": true, "score": 1, "last_activity_date": 1563293721, "creation_date": 1563293721, "answer_id": 57061560, "question_id": 57060390, "link": "https://stackoverflow.com/questions/57060390/create-error-object-for-stripeerror-ruby-on-rails/57061560#57061560", "title": "Create Error object for Stripe::Error (Ruby on rails)", "body": "<p>You can find the latest method definitions for Stripe Errors here: <a href=\"https://github.com/stripe/stripe-ruby/blob/ec91de6849f34d8d6701a6e91a1b2ee0d50c21ea/lib/stripe/errors.rb\" rel=\"nofollow noreferrer\">https://github.com/stripe/stripe-ruby/blob/ec91de6849f34d8d6701a6e91a1b2ee0d50c21ea/lib/stripe/errors.rb</a></p>\n\n<p>Here is the method definition for <code>Stripe::InvalidRequestError</code></p>\n\n<pre><code>class InvalidRequestError &lt; StripeError\n  attr_accessor :param\n\n  def initialize(message, param, http_status: nil, http_body: nil,\n                 json_body: nil, http_headers: nil, code: nil)\n    super(message, http_status: http_status, http_body: http_body,\n                   json_body: json_body, http_headers: http_headers,\n                   code: code)\n    @param = param\n  end\nend\n</code></pre>\n\n<p>So, in answer to your question, the second argument is the <code>param</code> argument. \nGenerally, this seems to represent a stripe resource.</p>\n\n<p>For example, if I wanted to create an InvalidRequestError having tried to do something related to the <code>Stripe::Plan</code> class, I would use the following code:</p>\n\n<pre><code>Stripe::InvalidRequestError.new('No such plan: test_plan', 'plan')\n</code></pre>\n\n<p>Hope that helps!</p>\n"}], "owner": {"reputation": 4416, "user_id": 2012677, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/8d7cb2fe712fb17f44f8c354bf37e7b5?s=128&d=identicon&r=PG&f=1", "display_name": "user2012677", "link": "https://stackoverflow.com/users/2012677/user2012677"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 232, "favorite_count": 0, "accepted_answer_id": 57061560, "answer_count": 1, "score": 1, "last_activity_date": 1563293721, "creation_date": 1563289736, "last_edit_date": 1563290055, "question_id": 57060390, "link": "https://stackoverflow.com/questions/57060390/create-error-object-for-stripeerror-ruby-on-rails", "title": "Create Error object for Stripe::Error (Ruby on rails)", "body": "<p>I am able to create standard errors as below...</p>\n\n<pre><code>StandardError.new(\"No such customer: invalid-id\")\n</code></pre>\n\n<p>However, I would like to know how to create specific errors, specifically Stripe errors...</p>\n\n<p><a href=\"https://stripe.com/docs/api/errors/handling\" rel=\"nofollow noreferrer\">https://stripe.com/docs/api/errors/handling</a>\n<a href=\"https://github.com/stripe/stripe-ruby/blob/382ae0b45d848304f7c1739696f33458c86bee4f/lib/stripe/errors.rb#L99\" rel=\"nofollow noreferrer\">https://github.com/stripe/stripe-ruby/blob/382ae0b45d848304f7c1739696f33458c86bee4f/lib/stripe/errors.rb#L99</a></p>\n\n<pre><code>Stripe::RateLimitError\nStripe::InvalidRequestError\nStripe::AuthenticationError\nStripe::InvalidRequestError\nStripe::StripeError\n</code></pre>\n\n<p>What is the best way to create these errors?  Which I use to pass to the my mock Api library.  I found this...</p>\n\n<p><a href=\"https://github.com/stripe/stripe-ruby/blob/master/test/stripe/errors_test.rb\" rel=\"nofollow noreferrer\">https://github.com/stripe/stripe-ruby/blob/master/test/stripe/errors_test.rb</a></p>\n\n<p>I have tried...\n<code>Stripe::InvalidRequestError.new('this is a test')</code>\n, but I get a ArgumentError (wrong number of arguments (given 1, expected 2)).  </p>\n\n<p>What is the required second argument?</p>\n"}, {"tags": ["regex", "ruby", "nokogiri"], "answers": [{"tags": [], "owner": {"reputation": 1012, "user_id": 10347572, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iottG.jpg?s=128&g=1", "display_name": "escanxr", "link": "https://stackoverflow.com/users/10347572/escanxr"}, "is_accepted": false, "score": 1, "last_activity_date": 1563564402, "last_edit_date": 1563564402, "creation_date": 1563289067, "answer_id": 57060183, "question_id": 57059787, "link": "https://stackoverflow.com/questions/57059787/how-to-parse-html-text-after-element-with-ruby/57060183#57060183", "title": "How to parse HTML text after element with Ruby", "body": "<p>You can do it very quickly with <a href=\"https://github.com/sparklemotion/nokogiri\" rel=\"nofollow noreferrer\">Nokogiri</a> without having to parse your HTML with regex.</p>\n\n<p>You\u2019ll be able to get the <code>h2</code> elements then extract the content in them.</p>\n\n<p>Some examples ar at <a href=\"https://www.rubyguides.com/2012/01/parsing-html-in-ruby/\" rel=\"nofollow noreferrer\">https://www.rubyguides.com/2012/01/parsing-html-in-ruby/</a></p>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user557597"}, "is_accepted": true, "score": 1, "last_activity_date": 1563567026, "last_edit_date": 1563567026, "creation_date": 1563292281, "answer_id": 57061159, "question_id": 57059787, "link": "https://stackoverflow.com/questions/57059787/how-to-parse-html-text-after-element-with-ruby/57061159#57061159", "title": "How to parse HTML text after element with Ruby", "body": "<p>This should work,<br>\nGroup 1 contains the heading text,\nGroup 2 contains the body.  </p>\n\n<p>Whitespace trim is included  </p>\n\n<p><code>/&lt;h2\\s*&gt;\\s*([\\S\\s]*?)\\s*&lt;\\/h2\\s*&gt;\\s*([\\S\\s]*?)(?=\\s*&lt;h2\\s*&gt;|\\s*$)/</code>  </p>\n\n<p><a href=\"https://regex101.com/r/pgLIi0/1\" rel=\"nofollow noreferrer\">https://regex101.com/r/pgLIi0/1</a></p>\n\n<p>Readable regex  </p>\n\n<pre><code> &lt;h2 \\s* &gt;\n \\s*     \n ( [\\S\\s]*? )                  # (1) Heading\n \\s* \n &lt;/h2 \\s* &gt;\n \\s*   \n ( [\\S\\s]*? )                  # (2) Body\n (?= \\s* &lt;h2 \\s* &gt; | \\s* $ )\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 168120, "user_id": 102937, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/1233ec65168f4aae4d939ae8fe6cde1e?s=128&d=identicon&r=PG", "display_name": "Robert Harvey", "link": "https://stackoverflow.com/users/102937/robert-harvey"}, "edited": false, "score": 0, "creation_date": 1563673058, "post_id": 57120467, "comment_id": 100775851, "body": "The post you linked actually explains nothing."}, {"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "reply_to_user": {"reputation": 168120, "user_id": 102937, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/1233ec65168f4aae4d939ae8fe6cde1e?s=128&d=identicon&r=PG", "display_name": "Robert Harvey", "link": "https://stackoverflow.com/users/102937/robert-harvey"}, "edited": false, "score": 0, "creation_date": 1563673170, "post_id": 57120467, "comment_id": 100775860, "body": "In my reading of it it has some very good points about why regex fails, when it&#39;s possible to use it, and why parsers are more robust. Probably the link should point to the question itself, so I can tweak that, otherwise I find it a usable page with good discussions."}, {"owner": {"reputation": 168120, "user_id": 102937, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/1233ec65168f4aae4d939ae8fe6cde1e?s=128&d=identicon&r=PG", "display_name": "Robert Harvey", "link": "https://stackoverflow.com/users/102937/robert-harvey"}, "edited": false, "score": 0, "creation_date": 1563673369, "post_id": 57120467, "comment_id": 100775875, "body": "FWIW, Nokogiri isn&#39;t a <i>standard;</i> it&#39;s just a library.  It might be a very popular library, but popularity doesn&#39;t make something a &quot;standard;&quot; it just makes it popular."}, {"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "reply_to_user": {"reputation": 168120, "user_id": 102937, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/1233ec65168f4aae4d939ae8fe6cde1e?s=128&d=identicon&r=PG", "display_name": "Robert Harvey", "link": "https://stackoverflow.com/users/102937/robert-harvey"}, "edited": false, "score": 0, "creation_date": 1563673681, "post_id": 57120467, "comment_id": 100775910, "body": "I don&#39;t see the word &quot;standard&quot; anywhere on the page, except in your comment. Nokogiri is the most popular (de facto) parser for Ruby though, and it was the tag the OP used. I&#39;m unsure what the comment was about."}, {"owner": {"reputation": 168120, "user_id": 102937, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/1233ec65168f4aae4d939ae8fe6cde1e?s=128&d=identicon&r=PG", "display_name": "Robert Harvey", "link": "https://stackoverflow.com/users/102937/robert-harvey"}, "edited": false, "score": 0, "creation_date": 1563673938, "post_id": 57120467, "comment_id": 100775936, "body": "You made that assertion in one of your comments in that appalling (now deleted) conversation below the OP."}, {"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "reply_to_user": {"reputation": 168120, "user_id": 102937, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/1233ec65168f4aae4d939ae8fe6cde1e?s=128&d=identicon&r=PG", "display_name": "Robert Harvey", "link": "https://stackoverflow.com/users/102937/robert-harvey"}, "edited": false, "score": 0, "creation_date": 1563674058, "post_id": 57120467, "comment_id": 100775952, "body": "Ah, well, usually I say &quot;de facto&quot;."}], "tags": [], "owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "is_accepted": false, "score": 0, "last_activity_date": 1563673325, "last_edit_date": 1563673325, "creation_date": 1563577538, "answer_id": 57120467, "question_id": 57059787, "link": "https://stackoverflow.com/questions/57059787/how-to-parse-html-text-after-element-with-ruby/57120467#57120467", "title": "How to parse HTML text after element with Ruby", "body": "<p>What you're trying to do is strongly discouraged and \"<a href=\"https://stackoverflow.com/questions/1732348/regex-match-open-tags-except-xhtml-self-contained-tags\">RegEx match open tags except XHTML self-contained tags</a>\" helps explain why. Only in the most trivial cases where you own the generation of the code should you use patterns. If you don't own the generator, then any change in the HTML can break your code, often in ways that are irreparable, especially late at night during a critical outage with your boss hounding you to get it running immediately.</p>\n\n<p>Using Nokogiri, this will get you into the ballpark in a more robust and recommended way. This example only collects the <code>h2</code> and following <code>p</code> nodes. Figuring out how to display them is left as an exercise.</p>\n\n<pre><code>require 'nokogiri'\n\nhtml = &lt;&lt;EOT\n&lt;h2&gt;heading 1&lt;/h2&gt;\n&lt;p&gt;content 1a&lt;b&gt;test&lt;/b&gt;&lt;/p&gt;\n&lt;p&gt;content 1b&lt;/p&gt;\n\n&lt;h2&gt;heading 2&lt;/h2&gt;\n&lt;p&gt;content 2a&lt;/p&gt;\nEOT\n\ndoc = Nokogiri::HTML.parse(html)\n\noutput = doc.search('h2').map { |h|\n\n  next_node = h.next_sibling\n  break unless next_node\n\n  paragraphs = []\n\n  loop do\n\n    case \n    when next_node.text? &amp;&amp; next_node.blank?\n    when next_node.name == 'p'\n      paragraphs &lt;&lt; next_node \n    else\n      break\n    end\n\n    next_node = next_node.next_sibling\n    break unless next_node\n\n  end\n\n  [h, paragraphs]\n}\n</code></pre>\n\n<p>Which results in <code>output</code> containing an array of arrays containing the nodes:</p>\n\n<pre><code># =&gt; [[#(Element:0x3ff4e4034be8 {\n#        name = \"h2\",\n#        children = [ #(Text \"heading 1\")]\n#        }),\n#      [#(Element:0x3ff4e4034b98 {\n#         name = \"p\",\n#         children = [\n#           #(Text \"content 1a\"),\n#           #(Element:0x3ff4e3807ccc {\n#             name = \"b\",\n#             children = [ #(Text \"test\")]\n#             })]\n#         }),\n#       #(Element:0x3ff4e4034ad0 {\n#         name = \"p\",\n#         children = [ #(Text \"content 1b\")]\n#         })]],\n#     [#(Element:0x3ff4e4034a6c {\n#        name = \"h2\",\n#        children = [ #(Text \"heading 2\")]\n#        }),\n#      [#(Element:0x3ff4e40349a4 {\n#         name = \"p\",\n#         children = [ #(Text \"content 2a\")]\n#         })]]]\n</code></pre>\n\n<p>The code makes some assumptions about the format of the HTML also, but won't spit out garbage if the format changes. It assumes a format like:</p>\n\n<pre><code>&lt;h2&gt;\n&lt;p&gt;\n...\n</code></pre>\n\n<p>where <code>h2</code> is always followed by <code>p</code> tags until some other tag occurs, including a subsequent <code>h2</code>.</p>\n\n<p>This test:</p>\n\n<pre><code>when next_node.text? &amp;&amp; next_node.blank?\n</code></pre>\n\n<p>is necessary because HTML doesn't require formatting, but when it is there are \"TEXT\" nodes inserted that contain only whitespace which results in the indentation we expect with \"pretty HTML\". The parser and browser don't care whether it's there except in the case of preformatted text, only humans do. And actually it'd be better to not have them because they bloat the file and slow down transmission of it. But people are finicky that way. In reality the HTML sample in the code really looks more like:</p>\n\n<pre><code>&lt;h2&gt;heading 1&lt;/h2&gt;\\n&lt;p&gt;content 1a&lt;b&gt;test&lt;/b&gt;&lt;/p&gt;\\n&lt;p&gt;content 1b&lt;/p&gt;\\n\\n&lt;h2&gt;heading 2&lt;/h2&gt;\\n&lt;p&gt;content 2a&lt;/p&gt;\\n\n</code></pre>\n\n<p>and the <code>when</code> statement is ignoring those \"<code>\\n</code>\" nodes.</p>\n"}], "owner": {"reputation": 156, "user_id": 5494294, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-4oaf4Q9Q5jA/AAAAAAAAAAI/AAAAAAAAbkA/_-1VuNhGeSg/photo.jpg?sz=128", "display_name": "Alex A", "link": "https://stackoverflow.com/users/5494294/alex-a"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 160, "favorite_count": 0, "accepted_answer_id": 57061159, "answer_count": 3, "score": -1, "last_activity_date": 1563673325, "creation_date": 1563287809, "last_edit_date": 1563564657, "question_id": 57059787, "link": "https://stackoverflow.com/questions/57059787/how-to-parse-html-text-after-element-with-ruby", "title": "How to parse HTML text after element with Ruby", "body": "<p>How can I parse and group the example HTML with Ruby?</p>\n\n<p>HTML text:</p>\n\n<pre class=\"lang-html prettyprint-override\"><code>&lt;h2&gt;heading one&lt;/h2&gt;\n&lt;p&gt;different content in here &lt;a&gt;test&lt;/a&gt; &lt;b&gt;test&lt;/b&gt;&lt;/p&gt;\n&lt;p&gt;different content in here &lt;a&gt;test&lt;/a&gt; &lt;b&gt;test&lt;/b&gt;&lt;/p&gt;\n\n&lt;h2&gt;heading two&lt;/h2&gt;\n&lt;p&gt;different content in here &lt;a&gt;test&lt;/a&gt; &lt;b&gt;test&lt;/b&gt;&lt;/p&gt;\n\n&lt;h2&gt;heading three&lt;/h2&gt;\n&lt;p&gt;different content in here &lt;a&gt;test&lt;/a&gt; &lt;b&gt;test&lt;/b&gt;&lt;/p&gt;\n&lt;p&gt;different content in here &lt;a&gt;test&lt;/a&gt; &lt;b&gt;test&lt;/b&gt;&lt;/p&gt;\n&lt;p&gt;different content in here &lt;a&gt;test&lt;/a&gt; &lt;b&gt;test&lt;/b&gt;&lt;/p&gt;\n</code></pre>\n\n<p>Elements are not nested, and I want to group them by heading. When I find a <code>&lt;h2&gt;</code>, I want to extract its text and all the content that comes after it as is until encountering the next <code>&lt;h2&gt;</code>. The last heading does not have another h2 as a delimiter.</p>\n\n<p>This is example output:</p>\n\n<pre><code>- Heading one\n\"&lt;p&gt;different content in here &lt;a&gt;test&lt;/a&gt; &lt;b&gt;test&lt;/b&gt;&lt;/p&gt;\n&lt;p&gt;different content in here &lt;a&gt;test&lt;/a&gt; &lt;b&gt;test&lt;/b&gt;&lt;/p&gt;\"\n\n- Heading 2\n\"&lt;p&gt;different content in here &lt;a&gt;test&lt;/a&gt; &lt;b&gt;test&lt;/b&gt;&lt;/p&gt;\"\n</code></pre>\n"}, {"tags": ["ruby", "linux", "honeypot"], "answers": [{"comments": [{"owner": {"reputation": 501, "user_id": 7693321, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/85ab52064f6673d7b488e118ced79c99?s=128&d=identicon&r=PG&f=1", "display_name": "Siqueira", "link": "https://stackoverflow.com/users/7693321/siqueira"}, "edited": false, "score": 0, "creation_date": 1563316298, "post_id": 57065309, "comment_id": 100657404, "body": "Thanks! It makes sense."}], "tags": [], "owner": {"reputation": 9254, "user_id": 625365, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/ab819ffb4ef53da36f840e46dd72e967?s=128&d=identicon&r=PG", "display_name": "spike", "link": "https://stackoverflow.com/users/625365/spike"}, "is_accepted": true, "score": 1, "last_activity_date": 1563317249, "last_edit_date": 1563317249, "creation_date": 1563310560, "answer_id": 57065309, "question_id": 57059398, "link": "https://stackoverflow.com/questions/57059398/error-when-executing-honeyc-require-cannot-load-such-file/57065309#57065309", "title": "Error when executing HoneyC - `require&#39;: cannot load such file", "body": "<p>The most recent commit on this codebase is from 2007 (and that's transferring it to git, I'm not sure whether the original subversion commits are even older). Ruby has come a long way since then, and the UnitTester you're running relies on some metaprogramming behavior that's changed over the years. It's trying to look through all the ruby files in the source tree to load them to find tests, but the way it's doing that doesn't work in modern rubies. There are at least two things wrong:</p>\n\n<ol>\n<li><p>Starting in ruby 1.9, released in 2009, the current directory is no longer (by default) in the load path, so when you try to <code>require</code> a module/class that's defined in the current directory it'll fail. They'd need to switch to <code>require_relative</code> (<a href=\"https://stackoverflow.com/questions/2900370/why-does-ruby-1-9-2-remove-from-load-path-and-whats-the-alternative\">Why does Ruby 1.9.2 remove &quot;.&quot; from LOAD_PATH, and what&#39;s the alternative?</a>)</p></li>\n<li><p>The codebase is doing something very bizarre (but maybe once necessary) in how it's crawling the object tree to try to figure out what classes/modules have been defined (<a href=\"https://github.com/honeynet/honeyc/blob/master/UnitTester.rb#L10\" rel=\"nofollow noreferrer\">https://github.com/honeynet/honeyc/blob/master/UnitTester.rb#L10</a>). This doesn't work properly in modern rubies.</p></li>\n</ol>\n\n<p>You can get the UnitTests running with ruby 1.8.7, but be aware that version of ruby hasn't been supported since 04/01/2017. The unit tests mostly pass except some are querying web services that no longer exist.</p>\n\n<p>I don't think you can really use this codebase without significant work upgrading it, which is probably off-topic here. </p>\n"}], "owner": {"reputation": 501, "user_id": 7693321, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/85ab52064f6673d7b488e118ced79c99?s=128&d=identicon&r=PG&f=1", "display_name": "Siqueira", "link": "https://stackoverflow.com/users/7693321/siqueira"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 60, "favorite_count": 0, "accepted_answer_id": 57065309, "answer_count": 1, "score": 1, "last_activity_date": 1563317249, "creation_date": 1563286600, "last_edit_date": 1563287535, "question_id": 57059398, "link": "https://stackoverflow.com/questions/57059398/error-when-executing-honeyc-require-cannot-load-such-file", "title": "Error when executing HoneyC - `require&#39;: cannot load such file", "body": "<p>I am trying to execute HoneyC, which code is on this link: <a href=\"https://github.com/honeynet/honeyc\" rel=\"nofollow noreferrer\">HoneyC Source Code</a>. I have followed the 'readme' document instructions, which says that the UnitTest have to be run first. </p>\n\n<p>It says: \"Unpack the HoneyC distribution into a directory, cd into that directory, and execute \u2018ruby UnitTester.rb\u2019. This will start the unit tests executing some basic module tests. (Note that you need to have network connectivity and direct outgoing access on port 80 for the unit tests to succeed.)\"</p>\n\n<p>I am using Ruby version 2.3.1p112 (2016-04-26) [x86_64-linux-gnu]</p>\n\n<p>*I've never programmed using Ruby before.</p>\n\n<p>Port 80 seems to be okay ... if I run the command netstat I get:</p>\n\n<blockquote>\n  <p>:~$ netstat -tulnap (Not all processes could be\n  identified, non-owned process info  will not be shown, you would have\n  to be root to see it all.) Active Internet connections (servers and\n  established) Proto Recv-Q Send-Q Local Address           Foreign\n  Address         State       PID/Program name tcp        0      0\n  127.0.0.1:3306          0.0.0.0:*               LISTEN      -                tcp        0      0 127.0.0.1:30800         0.0.0.0:*<br>\n  LISTEN      -                tcp        0      0 0.0.0.0:80<br>\n  0.0.0.0:*               LISTEN      -                tcp        0      0 127.0.0.1:30900         0.0.0.0:*               LISTEN      -<br>\n  tcp        0      0 127.0.1.1:53            0.0.0.0:*<br>\n  LISTEN</p>\n</blockquote>\n\n<p>However, I am getting the following error when I try to run the UnitTest:</p>\n\n<pre><code>:~/honeypot/honeyc-master$ ruby UnitTester.rb\n/usr/lib/ruby/2.3.0/rubygems/core_ext/kernel_require.rb:55:in `require': cannot load such file -- HoneyCConfiguration (LoadError)\n    from /usr/lib/ruby/2.3.0/rubygems/core_ext/kernel_require.rb:55:in `require'\n    from UnitTester.rb:39:in `block in suite'\n    from /usr/lib/ruby/2.3.0/find.rb:49:in `block (2 levels) in find'\n    from /usr/lib/ruby/2.3.0/find.rb:48:in `catch'\n    from /usr/lib/ruby/2.3.0/find.rb:48:in `block in find'\n    from /usr/lib/ruby/2.3.0/find.rb:43:in `each'\n    from /usr/lib/ruby/2.3.0/find.rb:43:in `find'\n    from UnitTester.rb:29:in `suite'\n    from /usr/lib/ruby/vendor_ruby/test/unit/ui/testrunner.rb:12:in `initialize'\n    from /usr/lib/ruby/vendor_ruby/test/unit/ui/console/testrunner.rb:38:in `initialize'\n    from /usr/lib/ruby/vendor_ruby/test/unit/ui/testrunnerutilities.rb:24:in `new'\n    from /usr/lib/ruby/vendor_ruby/test/unit/ui/testrunnerutilities.rb:24:in `run'\n    from UnitTester.rb:54:in `&lt;main&gt;'\n</code></pre>\n\n<p>The ruby code of the Unit Test is:</p>\n\n<pre><code> require 'test/unit/testsuite'\n require 'test/unit/ui/console/testrunner'\n require 'find'\n\nmodule Kernel\n  def get_class_for_name(name, objects = [Object])\n    #STDERR.puts name.to_s\n    return nil if objects.size == 0\n    object = objects.shift\n    object.constants.each do |constant_name|\n      real_object = object.const_get(constant_name)\n      case real_object\n      when Class\n    return real_object if constant_name == name\n      when Module\n    objects &lt;&lt; real_object\n      end\n    end\n    return get_class_for_name(name, objects)\n  end\nend\n\nclass UnitTester\n   def self.suite\n    exceptions = [\"HoneyC\",\"UnitTester\"]\n    suite = Test::Unit::TestSuite.new(\"HoneyC Unit Tests\")\n\n    #find all rb files\n    Find.find(\".\") do |full_file_name|\n        if /.rb/ =~ full_file_name and !(/.svn/ =~ full_file_name)\n            /.*\\// =~ full_file_name\n            path = $&amp;[2..$&amp;.length]\n            classname = full_file_name[$&amp;.length..-4]\n\n            if !exceptions.index(classname)\n                #assume test is under classname + \"Test\"\n                #run unit test on them except on the exceptions\n\n                require path + classname\n                classname.sub!(/\\.tab/,\"\") #silly replacement for the snortruleparser, since this is an automatically generated class.\n                unit_test = get_class_for_name(classname + \"Test\")\n                if(unit_test==nil)\n                    STDERR.puts \"No unit test defined for class \" + classname + \".\"\n                else\n                    suite &lt;&lt; unit_test.suite    \n                end\n            end\n        end\n    end\n\n    return suite\n   end\n end\n Test::Unit::UI::Console::TestRunner.run(UnitTester)\n</code></pre>\n\n<p>What should I do to get this honeypot running?</p>\n"}, {"tags": ["ruby", "loops", "hash"], "comments": [{"owner": {"reputation": 9663, "user_id": 5239030, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/76JEw.png?s=128&g=1", "display_name": "iGian", "link": "https://stackoverflow.com/users/5239030/igian"}, "edited": false, "score": 0, "creation_date": 1563284995, "post_id": 57058075, "comment_id": 100643202, "body": "Try a nested loop: <code>h.each { |k, v| v.each { |kk, vv| puts &quot;#{k} - #{kk}: #{vv}&quot; } }</code>"}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1563295168, "post_id": 57058075, "comment_id": 100649182, "body": "You need to clarify your desired result. Is it text to be displayed or do you wish to return an array or some other object? If the latter, please show a valid Ruby object (e.g., <code>[&quot;AC - ACRELANDIA: 419&quot;, ...]</code>. I suggest you replace &quot;.. and so on for each city.&quot; with the two lines from your example. Better to say you have a hash whose values are hashes. A &quot;3D&quot; hash is ill-defined, and even there were agreement on what it meant, I expect it would be a &quot;2D&quot; hash. :-)"}], "answers": [{"comments": [{"owner": {"reputation": 352, "user_id": 727685, "user_type": "registered", "profile_image": "https://graph.facebook.com/100001952158450/picture?type=large", "display_name": "otaviko", "link": "https://stackoverflow.com/users/727685/otaviko"}, "edited": false, "score": 2, "creation_date": 1563286129, "post_id": 57058849, "comment_id": 100643959, "body": "You can use <code>flat_map</code> instead of <code>map</code> then <code>flatten</code>"}], "tags": [], "owner": {"reputation": 5060, "user_id": 10522579, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7GQ6a.jpg?s=128&g=1", "display_name": "ray", "link": "https://stackoverflow.com/users/10522579/ray"}, "is_accepted": true, "score": 2, "last_activity_date": 1563288437, "last_edit_date": 1563288437, "creation_date": 1563284994, "answer_id": 57058849, "question_id": 57058075, "link": "https://stackoverflow.com/questions/57058075/how-to-iterate-over-3d-hashes/57058849#57058849", "title": "How to iterate over 3D hashes", "body": "<p>You can do as below,</p>\n\n<pre><code>hash = {\n   \"AC\"=&gt; { \"ACRELANDIA\"=&gt;419, \"ASSIS BRASIL\"=&gt;111 },\n   \"AL\"=&gt; { \"AGUA BRANCA\"=&gt;2701, \"ANADIA\"=&gt;2703 }\n}\n\nhash.flat_map { |x,y| y.map { |z| \"#{x} - #{z[0]}: #{z[1]}\" } }\n\n# =&gt; [\"AC - ACRELANDIA: 419\", \"AC - ASSIS BRASIL: 111\", \"AL - AGUA BRANCA: 2701\", \"AL - ANADIA: 2703\"]\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2572, "user_id": 2862049, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffd65bc37e559c2c407f064f308828a4?s=128&d=identicon&r=PG&f=1", "display_name": "Lukas Baliak", "link": "https://stackoverflow.com/users/2862049/lukas-baliak"}, "is_accepted": false, "score": 0, "last_activity_date": 1563285514, "creation_date": 1563285514, "answer_id": 57059018, "question_id": 57058075, "link": "https://stackoverflow.com/questions/57058075/how-to-iterate-over-3d-hashes/57059018#57059018", "title": "How to iterate over 3D hashes", "body": "<p>In this case i would prefere <a href=\"https://apidock.com/rails/Enumerable/each_with_object\" rel=\"nofollow noreferrer\">Enumerable#each_with_object</a></p>\n\n<pre><code>hash = {\n   \"AC\"=&gt; { \"ACRELANDIA\"=&gt;419, \"ASSIS BRASIL\"=&gt;111 },\n   \"AL\"=&gt; { \"AGUA BRANCA\"=&gt;2701, \"ANADIA\"=&gt;2703 }\n}\n\narr = hsh.each_with_object([]) {|(key, cities), data| cities.each{|name, i| data &lt;&lt; \"#{key} - #{name}: #{i}\"}}\n# =&gt; [\"AC - ACRELANDIA: 419\", \"AC - ASSIS BRASIL: 111\", \"AL - AGUA BRANCA: 2701\", \"AL - ANADIA: 2703\"]\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "is_accepted": false, "score": 1, "last_activity_date": 1563286695, "creation_date": 1563286695, "answer_id": 57059430, "question_id": 57058075, "link": "https://stackoverflow.com/questions/57058075/how-to-iterate-over-3d-hashes/57059430#57059430", "title": "How to iterate over 3D hashes", "body": "<p>Just out of curiosity. Works for hashes of any length (assuming lengths are the same.)</p>\n\n<pre><code>hash.\n  flat_map { |k, v| [k].product(v.to_a) }.\n  map { |e| e.join('\u00a0\u2014\u00a0') }\n#\u21d2\u00a0[\"AC\u00a0\u2014\u00a0ACRELANDIA\u00a0\u2014\u00a0419\",\n#   \"AC\u00a0\u2014\u00a0ASSIS BRASIL\u00a0\u2014\u00a0111\",\n#   \"AL\u00a0\u2014\u00a0AGUA BRANCA\u00a0\u2014\u00a02701\",\n#   \"AL\u00a0\u2014\u00a0ANADIA\u00a0\u2014\u00a02703\"]\n</code></pre>\n\n<p>or:</p>\n\n<pre><code>hash.\n  map { |k, v| [k].product(v.to_a) }.\n  flatten(1).\n  map { |e| e.join('\u00a0\u2014\u00a0') }\n</code></pre>\n"}], "owner": {"reputation": 15, "user_id": 11792219, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-bgAH1j9YZQc/AAAAAAAAAAI/AAAAAAAAdQ4/IOI_FOwxQ_8/photo.jpg?sz=128", "display_name": "Bia Gidzinski", "link": "https://stackoverflow.com/users/11792219/bia-gidzinski"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 70, "favorite_count": 0, "accepted_answer_id": 57058849, "answer_count": 3, "score": 0, "last_activity_date": 1563288437, "creation_date": 1563282697, "last_edit_date": 1563286399, "question_id": 57058075, "link": "https://stackoverflow.com/questions/57058075/how-to-iterate-over-3d-hashes", "title": "How to iterate over 3D hashes", "body": "<p>I have a 3D hash that is being generated using data from a <code>yaml</code> file. I need to get the key of each array and join it to it's values in order to display them on a select field on a form.</p>\n\n<p>I tried using <code>each</code>, <code>for...in</code>, <code>hash.keys</code>, <code>hash.values</code> and <code>map</code> but they return the hashes as one and not separated values</p>\n\n<p>This is the structure of the hash:</p>\n\n<pre><code>{\n   \"AC\"=&gt;\n       {\n         \"ACRELANDIA\"=&gt;419,\n         \"ASSIS BRASIL\"=&gt;111\n       },\n    \"AL\"=&gt;\n        {\n         \"AGUA BRANCA\"=&gt;2701,\n         \"ANADIA\"=&gt;2703\n        }\n}\n</code></pre>\n\n<p>In the end I was hoping for the result to be like this:</p>\n\n<pre><code>AC - ACRELANDIA: 419\n\nAC - ASSIS BRASIL: 111\n</code></pre>\n\n<p>... and so on for each city.</p>\n"}, {"tags": ["ruby", "git", "branch", "rugged"], "comments": [{"owner": {"reputation": 4327, "user_id": 1397097, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/c6fdb449031f010da19a644df8b0f031?s=128&d=identicon&r=PG", "display_name": "quinn", "link": "https://stackoverflow.com/users/1397097/quinn"}, "edited": false, "score": 0, "creation_date": 1567196818, "post_id": 57058021, "comment_id": 101905678, "body": "want to exactly this thing. Did you ever figure this out??"}, {"owner": {"reputation": 17523, "user_id": 518204, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/d3096adc28daa2f0b01cfbe5b90a37db?s=128&d=identicon&r=PG", "display_name": "Fabio", "link": "https://stackoverflow.com/users/518204/fabio"}, "reply_to_user": {"reputation": 4327, "user_id": 1397097, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/c6fdb449031f010da19a644df8b0f031?s=128&d=identicon&r=PG", "display_name": "quinn", "link": "https://stackoverflow.com/users/1397097/quinn"}, "edited": false, "score": 1, "creation_date": 1567442488, "post_id": 57058021, "comment_id": 101956682, "body": "@quinn yes I did it, here&#39;s the code: <a href=\"https://github.com/uala/drone-rancher-deploy/blob/master/lib/rancher_deployer/tag_checker.rb#L33-L45\" rel=\"nofollow noreferrer\">github.com/uala/drone-rancher-deploy/blob/master/lib/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 17523, "user_id": 518204, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/d3096adc28daa2f0b01cfbe5b90a37db?s=128&d=identicon&r=PG", "display_name": "Fabio", "link": "https://stackoverflow.com/users/518204/fabio"}, "is_accepted": true, "score": 1, "last_activity_date": 1567442602, "creation_date": 1567442602, "answer_id": 57760379, "question_id": 57058021, "link": "https://stackoverflow.com/questions/57058021/implement-git-branch-contains-with-rugged-library/57760379#57760379", "title": "Implement git branch --contains with rugged library", "body": "<p>Finally solved with <a href=\"https://github.com/uala/drone-rancher-deploy/blob/master/lib/rancher_deployer/tag_checker.rb#L33-L45\" rel=\"nofollow noreferrer\">this code</a>:</p>\n\n<pre><code>def branches_for_tag(tag_name, repo_path = Dir.pwd)\n  @branches ||= begin\n    repo = Rugged::Repository.new(repo_path)\n    # Convert tag to sha1 if matching tag found\n    full_sha = repo.tags[tag_name] ? repo.tags[tag_name].target_id : tag_name\n    logger.debug \"Inspecting repo at #{repo.path}, branches are #{repo.branches.map(&amp;:name)}\"\n    # descendant_of? does not return true for it self, i.e. repo.descendant_of?(x, x) will return false for every commit\n    # @see https://github.com/libgit2/libgit2/pull/4362\n    repo.branches.select { |branch| repo.descendant_of?(branch.target_id, full_sha) || full_sha == branch.target_id }\n  end\nend\n</code></pre>\n"}], "owner": {"reputation": 17523, "user_id": 518204, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/d3096adc28daa2f0b01cfbe5b90a37db?s=128&d=identicon&r=PG", "display_name": "Fabio", "link": "https://stackoverflow.com/users/518204/fabio"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 70, "favorite_count": 1, "accepted_answer_id": 57760379, "answer_count": 1, "score": 2, "last_activity_date": 1567442602, "creation_date": 1563282516, "question_id": 57058021, "link": "https://stackoverflow.com/questions/57058021/implement-git-branch-contains-with-rugged-library", "title": "Implement git branch --contains with rugged library", "body": "<p>I'm working with a ruby script that execute the following git command on a given git repository.</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>  branches = `git branch -a --contains #{tag_name}`\n</code></pre>\n\n<p>This approach has some drawbacks with command output (that may change in different git versions) and is subject to git binary version on the hosting machine, so I was trying to see if it's possible to replace that command using <a href=\"https://github.com/libgit2/rugged\" rel=\"nofollow noreferrer\">rugged</a> but I wasn't able to find anything similar to that.</p>\n\n<p>Maybe in rugged there's no way to implement <code>--contains</code> flag, but I think it should be pretty easy to implement this behavior: </p>\n\n<p>Given any git <em>commit-ish</em> (a tag, a commit sha, etc.) how to get (with rugged) the list of branches (both local and remote) that contains that commit-ish?</p>\n\n<p>I need to implement something like github commit show page, i.e. <code>tag xyz is contained in master, develop, branch_xx</code></p>\n"}, {"tags": ["ruby", "money-rails"], "comments": [{"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1563281798, "post_id": 57057608, "comment_id": 100641173, "body": "Just <a href=\"https://github.com/RubyMoney/money-rails#configuration-parameters\" rel=\"nofollow noreferrer\">reading the README</a> and checking <a href=\"https://github.com/RubyMoney/money-rails/blob/c8c1dc8501f6c33e3f104289e722570d8b747bde/lib/money-rails/helpers/action_view_extension.rb#L33-L50\" rel=\"nofollow noreferrer\">the source code</a>... Does this work? <code>h.money_without_cents(price, symbol: true, rounding_mode: BigDecimal::ROUND_CEILING)</code>"}, {"owner": {"reputation": 314, "user_id": 2916803, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/cf4d2b53d362ecf102683795a5c2d07b?s=128&d=identicon&r=PG&f=1", "display_name": "drifterOcean19", "link": "https://stackoverflow.com/users/2916803/drifterocean19"}, "reply_to_user": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1563282178, "post_id": 57057608, "comment_id": 100641415, "body": "That didn&#39;t work -  it gave me &#163;785"}, {"owner": {"reputation": 314, "user_id": 2916803, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/cf4d2b53d362ecf102683795a5c2d07b?s=128&d=identicon&r=PG&f=1", "display_name": "drifterOcean19", "link": "https://stackoverflow.com/users/2916803/drifterocean19"}, "reply_to_user": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1563282442, "post_id": 57057608, "comment_id": 100641571, "body": "Also tried - <code>h.humanized_money(space.price.from_price, symbol: true, rounding_mode: BigDecimal::ROUND_CEILING)</code> but gave me &#163;785.71"}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1563282765, "post_id": 57057608, "comment_id": 100641757, "body": "This is ugly, but what about <code>Money.with_rounding_mode(BigDecimal::ROUND_CEILING) { h.money_with_cents_and_with_symbol(price) }</code>? (<a href=\"https://github.com/RubyMoney/money/blob/8754d9ae614b8903525746589a6fed104d469344/lib/money/money.rb#L234-L239\" rel=\"nofollow noreferrer\">link</a>)"}, {"owner": {"reputation": 314, "user_id": 2916803, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/cf4d2b53d362ecf102683795a5c2d07b?s=128&d=identicon&r=PG&f=1", "display_name": "drifterOcean19", "link": "https://stackoverflow.com/users/2916803/drifterocean19"}, "reply_to_user": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1563283114, "post_id": 57057608, "comment_id": 100642016, "body": "I got  - undefined method `with_rounding_mode&#39; for Money:Class"}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1563283553, "post_id": 57057608, "comment_id": 100642282, "body": "<code>Money.with_rounding_mode</code> was <a href=\"https://github.com/RubyMoney/money/blob/master/CHANGELOG.md#6133\" rel=\"nofollow noreferrer\">added to version <code>6.13.3</code></a> of the <code>money</code> gem. Unless you say otherwise, I&#39;m going to assume you&#39;re using the latest version of the gem. In older versions, it seems the method was called <code>Money.with_rounding_mode</code>."}, {"owner": {"reputation": 314, "user_id": 2916803, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/cf4d2b53d362ecf102683795a5c2d07b?s=128&d=identicon&r=PG&f=1", "display_name": "drifterOcean19", "link": "https://stackoverflow.com/users/2916803/drifterocean19"}, "reply_to_user": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1563284217, "post_id": 57057608, "comment_id": 100642694, "body": "I tried that, it didn&#39;t work either. Still giving me &#163;785"}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1563285068, "post_id": 57057608, "comment_id": 100643250, "body": "*<code>Money.rounding_mode</code>. (Shame SO doesn&#39;t let me edit comments :( ... )"}], "owner": {"reputation": 314, "user_id": 2916803, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/cf4d2b53d362ecf102683795a5c2d07b?s=128&d=identicon&r=PG&f=1", "display_name": "drifterOcean19", "link": "https://stackoverflow.com/users/2916803/drifterocean19"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 93, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1563281412, "creation_date": 1563281183, "last_edit_date": 1563281412, "question_id": 57057608, "link": "https://stackoverflow.com/questions/57057608/money-rails-rounding-up-method", "title": "money-rails - rounding up method", "body": "<p>I have this method below:</p>\n\n<pre><code>  def formatted_from_net_per_day\n    return unless object.price.available?\n    formatted_price_for(object.price.from_price)\n  end\n</code></pre>\n\n<p>As an example, it outputs:</p>\n\n<pre><code>#&lt;Money fractional:78571 currency:GBP&gt;\n</code></pre>\n\n<p>The <code>formatted_price_for</code> method is as below where it strips away the cents.</p>\n\n<pre><code>  def formatted_price_for(price)\n    formatted_price = h.money_without_cents_and_with_symbol(price)\n    unit = I18n.t(\"space.pricings.pricing.day\")\n\n    format('%s/%s', formatted_price, unit)\n  end\n</code></pre>\n\n<p>Instead of stripping the cents away, I want to round up the money and retain the currency. So using the example output above - <code>\u00a3785.71 -&gt; \u00a3786</code></p>\n\n<p>How can I achieve that?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-5"], "comments": [{"owner": {"reputation": 153, "user_id": 10634638, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JJGEM.jpg?s=128&g=1", "display_name": "bestinamir", "link": "https://stackoverflow.com/users/10634638/bestinamir"}, "edited": false, "score": 1, "creation_date": 1563282187, "post_id": 57057483, "comment_id": 100641421, "body": "May be it\u2019s not supported <a href=\"https://docs.oracle.com/cd/E17952_01/mysql-5.5-en/charset-charsets.html\" rel=\"nofollow noreferrer\">docs.oracle.com/cd/E17952_01/mysql-5.5-en/charset-charsets.h&zwnj;&#8203;tml</a>"}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "reply_to_user": {"reputation": 153, "user_id": 10634638, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JJGEM.jpg?s=128&g=1", "display_name": "bestinamir", "link": "https://stackoverflow.com/users/10634638/bestinamir"}, "edited": false, "score": 0, "creation_date": 1563303169, "post_id": 57057483, "comment_id": 100652625, "body": "@bestinamir This is Oracle DB, not MySQL."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 1, "creation_date": 1563303219, "post_id": 57057483, "comment_id": 100652649, "body": "Try with some random emoji. This tests that &gt;3 byte characters work. \ud867\ude3d is a 4-byte character. If you&#39;re having trouble with those characters, check that your column type supports 4-byte UTF-8."}, {"owner": {"reputation": 1, "user_id": 9595075, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HGGN4.jpg?s=128&g=1", "display_name": "Rupali Parse", "link": "https://stackoverflow.com/users/9595075/rupali-parse"}, "edited": false, "score": 0, "creation_date": 1563432857, "post_id": 57057483, "comment_id": 100699553, "body": "yes, column type supports 4-byte UTF-8"}], "owner": {"reputation": 1, "user_id": 9595075, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HGGN4.jpg?s=128&g=1", "display_name": "Rupali Parse", "link": "https://stackoverflow.com/users/9595075/rupali-parse"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 25, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1563303148, "creation_date": 1563280727, "last_edit_date": 1563303148, "question_id": 57057483, "link": "https://stackoverflow.com/questions/57057483/surrogate-character-from-ruby-on-rails-application-gets-saved-to-oracle-d", "title": "Surrogate character( &#171581;&#134047;) from ruby on rails application gets saved to oracle database in question mark format (?)", "body": "<p>Surrogate character( \ud867\ude3d\ud842\udf9f) from ruby on rails application gets saved to oracle database in question mark format (?)</p>\n\n<p>Ruby -2.4.1\nRails - 5.0\nOracle - 11.2</p>\n\n<p>Using above configurations </p>\n\n<p>firing below query </p>\n\n<pre><code>UPDATE table_name SET my_message = N'\u30c6\u30b9\u30c8\u30c8\u30c8 VP\uff0d\ud867\ude3d\ud842\udf9f' WHERE table_name.MERCHANT_ID = 'merchant4'  \n</code></pre>\n\n<p>While updating above record it gets saved to db as '\u30c6\u30b9\u30c8\u30c8\u30c8 VP\uff0d\uff1f\uff1f'</p>\n\n<p>Please suggest.</p>\n\n<p>Thank you in advance.</p>\n"}, {"tags": ["ios", "ruby", "xcode", "bundle", "riot"], "answers": [{"tags": [], "owner": {"reputation": 2116, "user_id": 2915020, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/03c397f3a76288cca06c950b7fcbae18?s=128&d=identicon&r=PG", "display_name": "Kathiresan Murugan", "link": "https://stackoverflow.com/users/2915020/kathiresan-murugan"}, "is_accepted": true, "score": 0, "last_activity_date": 1563346993, "last_edit_date": 1592644375, "creation_date": 1563346993, "answer_id": 57070251, "question_id": 57057168, "link": "https://stackoverflow.com/questions/57057168/riot-ios-error-while-run-bundle-exec-pod-install/57070251#57070251", "title": "Riot-iOS Error: while run bundle exec pod install", "body": "<p>I found a solution for this question and now workspace was created.</p>\n<p>Before I run this command <code>bundle exec</code> have to run <code>Xcode-select</code></p>\n<p>Like</p>\n<blockquote>\n<p>sudo xcode-select -s /Applications/Xcode.app/Contents/Developer</p>\n<p>bundle exec pod install</p>\n</blockquote>\n"}], "owner": {"reputation": 2116, "user_id": 2915020, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/03c397f3a76288cca06c950b7fcbae18?s=128&d=identicon&r=PG", "display_name": "Kathiresan Murugan", "link": "https://stackoverflow.com/users/2915020/kathiresan-murugan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 162, "favorite_count": 0, "accepted_answer_id": 57070251, "answer_count": 1, "score": 1, "last_activity_date": 1563346993, "creation_date": 1563279662, "last_edit_date": 1592644375, "question_id": 57057168, "link": "https://stackoverflow.com/questions/57057168/riot-ios-error-while-run-bundle-exec-pod-install", "title": "Riot-iOS Error: while run bundle exec pod install", "body": "<p>I have tried to run a <a href=\"https://github.com/vector-im/riot-ios\" rel=\"nofollow noreferrer\">project</a></p>\n<p>So, I download a files and run a build instructions.\nWhen I run a</p>\n<blockquote>\n<p>bundle exec pod install</p>\n</blockquote>\n<p>is showing error. I can't able to understand. Please help me.</p>\n<p><a href=\"https://i.stack.imgur.com/6LAbj.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/6LAbj.png\" alt=\"enter image description here\" /></a></p>\n<p>After that I have run below commands</p>\n<blockquote>\n<p>brew update</p>\n<p>brew install cmake</p>\n</blockquote>\n<p>Now error was showing like</p>\n<p><a href=\"https://i.stack.imgur.com/LFKKm.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/LFKKm.png\" alt=\"enter image description here\" /></a></p>\n"}, {"tags": ["ruby", "xml", "ruby-on-rails-4", "xmlhttprequest", "net-http"], "answers": [{"tags": [], "owner": {"reputation": 21613, "user_id": 580346, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/ba17945a06aac247b06548d5afe341e8?s=128&d=identicon&r=PG", "display_name": "mrzasa", "link": "https://stackoverflow.com/users/580346/mrzasa"}, "is_accepted": true, "score": 1, "last_activity_date": 1563279819, "creation_date": 1563279819, "answer_id": 57057217, "question_id": 57057096, "link": "https://stackoverflow.com/questions/57057096/how-to-send-xml-file-using-post-request-in-ruby/57057217#57057217", "title": "How to send XML file using Post request in Ruby", "body": "<p>You need to load the file content to memory if you want to use it as a request body, use <code>#read</code> method:</p>\n\n<pre><code>request_body = File.open('example/file.xml').read\n</code></pre>\n\n<p>and it'll work.</p>\n"}], "owner": {"reputation": 33, "user_id": 11441800, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-HoX6ojngBPc/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rc5CnU_ViHex3nF6_4ffYBSn4nNjw/mo/photo.jpg?sz=128", "display_name": "maksim korshikov", "link": "https://stackoverflow.com/users/11441800/maksim-korshikov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 540, "favorite_count": 0, "accepted_answer_id": 57057217, "answer_count": 1, "score": 1, "last_activity_date": 1563280390, "creation_date": 1563279458, "question_id": 57057096, "link": "https://stackoverflow.com/questions/57057096/how-to-send-xml-file-using-post-request-in-ruby", "title": "How to send XML file using Post request in Ruby", "body": "<p>I am writing a code that send http post request. Now I write xml body in my code, and its working correctly.</p>\n\n<p>But if I want to send request using xml file I get<br>\n  undefined method `bytesize' for # \n  \n  Did you mean?  bytes</p>\n\n<p>My code below</p>\n\n<pre><code>require 'net/http'\n\nrequest_body = &lt;&lt;EOF\n&lt;xml_expamle&gt;\nEOF\n\nuri = URI.parse('http://example')\npost = Net::HTTP::Post.new(uri.path, 'content-type' =&gt; 'text/xml; charset=UTF-8')\npost.basic_auth 'user','passcode'\nNet::HTTP.new(uri.host, uri.port).start {|http|\n  http.request(post, request_body) {|response|\n    puts response.body\n  }\n}\n\n\n**But if I want to make send file**\n\nrequire 'net/http'\n\nrequest_body = File.open('example/file.xml')\n\n\nuri = URI.parse('http://example')\npost = Net::HTTP::Post.new(uri.path, 'content-type' =&gt; 'application/xml; charset=UTF-8')\npost.basic_auth 'user','passcode'\nNet::HTTP.new(uri.host, uri.port).start {|http|\n  http.request(post, request_body) {|response|\n    puts response.body\n  }\n}\n</code></pre>\n\n<p>I get \n<strong>undefined method `bytesize' for #\nDid you mean?  bytes</strong> </p>\n"}, {"tags": ["ruby", "google-maps-api-3", "google-api", "ruby-on-rails-5"], "comments": [{"owner": {"reputation": 1012, "user_id": 10347572, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iottG.jpg?s=128&g=1", "display_name": "escanxr", "link": "https://stackoverflow.com/users/10347572/escanxr"}, "edited": false, "score": 0, "creation_date": 1563279917, "post_id": 57056199, "comment_id": 100640040, "body": "Have you tried to put  <code>data-turbolinks=&quot;false&quot;</code> on your page\u2019s wrapper instead that in your link? I had a problem like yours, with another script, due to turbolinks."}, {"owner": {"reputation": 2292, "user_id": 5448888, "user_type": "registered", "accept_rate": 56, "profile_image": "https://graph.facebook.com/898095120243525/picture?type=large", "display_name": "Chakreshwar Sharma", "link": "https://stackoverflow.com/users/5448888/chakreshwar-sharma"}, "reply_to_user": {"reputation": 1012, "user_id": 10347572, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iottG.jpg?s=128&g=1", "display_name": "escanxr", "link": "https://stackoverflow.com/users/10347572/escanxr"}, "edited": false, "score": 0, "creation_date": 1563281182, "post_id": 57056199, "comment_id": 100640786, "body": "page wrapper ? Sorry I haven&#39;t understand it , are u talking about adding this on javascript?"}, {"owner": {"reputation": 1012, "user_id": 10347572, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iottG.jpg?s=128&g=1", "display_name": "escanxr", "link": "https://stackoverflow.com/users/10347572/escanxr"}, "edited": false, "score": 0, "creation_date": 1563281874, "post_id": 57056199, "comment_id": 100641222, "body": "Nop sorry, I misspoke. On the div that encompass your script and content, you can add <code>data-turbolinks=&quot;false&quot;</code>. It fixed the problem for me (I had to add this data-attribute on the guest homepage\u2019s body)"}, {"owner": {"reputation": 2292, "user_id": 5448888, "user_type": "registered", "accept_rate": 56, "profile_image": "https://graph.facebook.com/898095120243525/picture?type=large", "display_name": "Chakreshwar Sharma", "link": "https://stackoverflow.com/users/5448888/chakreshwar-sharma"}, "reply_to_user": {"reputation": 1012, "user_id": 10347572, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iottG.jpg?s=128&g=1", "display_name": "escanxr", "link": "https://stackoverflow.com/users/10347572/escanxr"}, "edited": false, "score": 0, "creation_date": 1563282372, "post_id": 57056199, "comment_id": 100641533, "body": "I have added like below &lt;div class=&quot;mui-textfield&quot; data-turbolinks=&quot;false&quot;&gt;             &lt;input type=&quot;hidden&quot; name=&quot;id&quot; value=&#39;&#39; id=&quot;user_id&quot;&gt;             &lt;%= text_field_tag :location, nil, id: &#39;txtPlaces&#39;, class: &quot;form-text&quot;, placeholder: &#39;&#39;, required: true %&gt;             &lt;%= hidden_field_tag :full_address, nil, id: &#39;full_address&#39;, class: &quot;form-text&quot;, placeholder: &#39;&#39; %&gt;           &lt;/div&gt;  but not works"}, {"owner": {"reputation": 1012, "user_id": 10347572, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iottG.jpg?s=128&g=1", "display_name": "escanxr", "link": "https://stackoverflow.com/users/10347572/escanxr"}, "edited": false, "score": 0, "creation_date": 1563285468, "post_id": 57056199, "comment_id": 100643502, "body": "Your script still outside this div with the data-turbolinks attribute so that could explain why you have to reload. Maybe you should add the script in your assets and load it in the head with the asset pipeline"}], "owner": {"reputation": 2292, "user_id": 5448888, "user_type": "registered", "accept_rate": 56, "profile_image": "https://graph.facebook.com/898095120243525/picture?type=large", "display_name": "Chakreshwar Sharma", "link": "https://stackoverflow.com/users/5448888/chakreshwar-sharma"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 101, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1563282720, "creation_date": 1563276412, "last_edit_date": 1563282720, "question_id": 57056199, "link": "https://stackoverflow.com/questions/57056199/google-api-autocomplete-not-working-in-rails-but-works-after-reload", "title": "Google API autocomplete not working in rails but works after reload", "body": "<p>I am trying to add google autocomple api, but it works only after page reload and sometimes doesn't works even after ``page reload , Below is the code: </p>\n\n<pre><code>&lt;%= javascript_include_tag 'https://maps.googleapis.com/maps/api/js?key=' + Rails.application.secrets.google_api_key + '&amp;libraries=places' %&gt;\n&lt;div class=\"mui-textfield\" data-turbolinks=\"false\"&gt;\n    &lt;input type=\"hidden\" name=\"id\" value='' id=\"user_id\"&gt;\n    &lt;%= text_field_tag :location, nil, id: 'txtPlaces', class: \"form-text\", placeholder: '', required: true %&gt;\n        &lt;%= hidden_field_tag :full_address, nil, id: 'full_address', class: \"form-text\", placeholder: '' %&gt;\n&lt;/div&gt;\n&lt;script&gt;\n  var ready = function () {\n\n    var options = {\n          type:['(regions)'],\n          componentRestrictions: {\n            country: ['au']\n          }\n        };\n\n        google.maps.event.addDomListener(window, 'load', function () {\n            var input = document.getElementById('txtPlaces');\n            var places = new google.maps.places.Autocomplete(input, options);\n            google.maps.event.addListener(places, 'place_changed', function () {\n               $(\"#full_address\").val($(\"#txtPlaces\").val());\n            });\n          });\n      // This is some custom requirement\n        $('.save-address').on('click', function(e){\n\n          if($(\"#full_address\").val() !== $(\"#txtPlaces\").val()){\n            e.preventDefault();\n            e.stopPropagation();\n            $(\"#txtPlaces\").val('');\n            $(this).submit();\n          }\n        });\n    };\n    &lt;%#*$(document).ready(ready);%&gt;\n    &lt;%#*$(document).on('page:load', ready);%&gt;\n    $(document).on(\"turbolinks:load\", ready);\n&lt;/script&gt;\n</code></pre>\n\n<p>I have tried both above <strong>ready  and page:load</strong> function as well but no luck\nOther than this, below is the code to reach above page</p>\n\n<pre><code>&lt;li&gt;&lt;%= link_to('Active', admin_staffs_path(status: 'accepted'), data: { turbolinks: false })\n</code></pre>\n"}, {"tags": ["ruby", "quoted-printable"], "comments": [{"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1563279805, "post_id": 57055734, "comment_id": 100639973, "body": "Regarding 2) that page is all about ISO-8859-1 aka ISO Latin 1. In Ruby, strings are UTF-8 by default."}], "answers": [{"comments": [{"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1563279632, "post_id": 57057034, "comment_id": 100639867, "body": "You can pass the source encoding as the 2nd argument: <code>encode(&#39;utf-8&#39;, &#39;iso-8859-1&#39;)</code>"}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "reply_to_user": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1563281505, "post_id": 57057034, "comment_id": 100640984, "body": "@Stefan yes, I decided that way it\u2019s somewhat more explicit. Maybe I\u2019m wrong, I\u2019ll update the answer."}], "tags": [], "owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "is_accepted": true, "score": 2, "last_activity_date": 1563281558, "last_edit_date": 1563281558, "creation_date": 1563279293, "answer_id": 57057034, "question_id": 57055734, "link": "https://stackoverflow.com/questions/57055734/how-to-properly-decode-string-with-quoted-printable-encoding-in-ruby/57057034#57057034", "title": "How to properly decode string with quoted-printable encoding in Ruby", "body": "<p>Try to avoid weird Rails stuff when you have plain old good ruby to accomplish a task. <a href=\"https://ruby-doc.org/core/String.html#method-i-unpack\" rel=\"nofollow noreferrer\"><code>String#unpack</code></a> is your friend. </p>\n\n<pre><code>\"Demarcation by Theresa Castel=E3o-Lawless\".\n  unpack(\"M\").first. # unpack as quoted printable\n  force_encoding(Encoding::ISO_8859_1).\n  encode(Encoding::UTF_8)\n#\u21d2 \"Demarcation by Theresa Castel\u00e3o-Lawless\"\n</code></pre>\n\n<p>or, as suggested in comments by @Stefan, one can pass the source encoding as the 2nd argument: </p>\n\n<pre><code>\"Demarcation by Theresa Castel=E3o-Lawless\".\n  unpack(\"M\").first. # unpack as quoted printable\n  encode('utf-8', 'iso-8859-1')\n</code></pre>\n\n<p><em>Note:</em> <code>force_encoding</code> is needed to tell the engine this is single-byte ISO with european accents before encoding into target <code>UTF-8</code>.</p>\n"}], "owner": {"reputation": 35, "user_id": 11694529, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/103d27e980e4044266815c3a98a53806?s=128&d=identicon&r=PG&f=1", "display_name": "JustinCEO", "link": "https://stackoverflow.com/users/11694529/justinceo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 423, "favorite_count": 0, "accepted_answer_id": 57057034, "answer_count": 1, "score": 2, "last_activity_date": 1563281558, "creation_date": 1563274799, "question_id": 57055734, "link": "https://stackoverflow.com/questions/57055734/how-to-properly-decode-string-with-quoted-printable-encoding-in-ruby", "title": "How to properly decode string with quoted-printable encoding in Ruby", "body": "<p>I'm trying to decode what I think is some quoted-printable encoded text that appears in an MBox email archive. I will give one example of some text I am having trouble with.</p>\n\n<p>In the MBox, the following text appears:</p>\n\n<p>\"Demarcation by Theresa Castel=E3o-Lawless\"</p>\n\n<p>Properly decoded, I think this should appear as:</p>\n\n<p>\"Demarcation by Theresa Castel\u00e3o-Lawless\"</p>\n\n<p>I'm basing my statement of what it should properly look like both off of </p>\n\n<p>1) a web archive of the email in which the text is properly rendered as \"Demarcation by Theresa Castel\u00e3o-Lawless\"</p>\n\n<p>and 2) this page, which shows \"=E3\" as corresponding to a \"\u00e3\" for quoted-printable <a href=\"https://www.ic.unicamp.br/~stolfi/EXPORT/www/ISO-8859-1-Encoding.html\" rel=\"nofollow noreferrer\">https://www.ic.unicamp.br/~stolfi/EXPORT/www/ISO-8859-1-Encoding.html</a></p>\n\n<p>I've tried the code below but it gives the wrong output.</p>\n\n<pre><code>\nstring = \"Demarcation by Theresa Castel=E3o-Lawless\"\n\ndecoded_string = Mail::Encodings::QuotedPrintable.decode(string)\n\nputs decoded_string + \"\\n\"\n</code></pre>\n\n<p>The result from the code above is \n\"Demarcation by Theresa Castel?o-Lawless\"\nbut as stated above, I want\n\"Demarcation by Theresa Castel\u00e3o-Lawless\"</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "class", "message"], "answers": [{"comments": [{"owner": {"reputation": 337, "user_id": 11664580, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KxGXw.png?s=128&g=1", "display_name": "JimmyTheCode", "link": "https://stackoverflow.com/users/11664580/jimmythecode"}, "edited": false, "score": 0, "creation_date": 1563297914, "post_id": 57054272, "comment_id": 100650334, "body": "Thanks, and you were dead right. I&#39;d generated the scaffold Message, just as you said."}], "tags": [], "owner": {"reputation": 786, "user_id": 2502372, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ETaor.jpg?s=128&g=1", "display_name": "Lucas Wieloch", "link": "https://stackoverflow.com/users/2502372/lucas-wieloch"}, "is_accepted": false, "score": 1, "last_activity_date": 1563270387, "last_edit_date": 1563270387, "creation_date": 1563269805, "answer_id": 57054272, "question_id": 57054163, "link": "https://stackoverflow.com/questions/57054163/in-ruby-on-rails-where-is-the-class-message-stored/57054272#57054272", "title": "In Ruby on Rails, where is the class &quot;Message&quot; stored?", "body": "<p>it is in your models folder, it is not a base class. Those methods, these classes, files etc were probably created using the <code>scaffold</code> command. If you did not use this command at all, try creating a new project and type in your terminal <code>rails g scaffold Message content:string</code> and check the logs so you can understand what is happening. If you are curious about it, there is more info on <code>scaffold</code> <a href=\"https://guides.rubyonrails.org/command_line.html\" rel=\"nofollow noreferrer\">here</a></p>\n\n<p>Also, <code>ActiveRecord</code> is Rails default ORM (which is why your models will inherit from it). You can check out more info about it on <a href=\"https://guides.rubyonrails.org/active_record_basics.html\" rel=\"nofollow noreferrer\">this guide</a>.</p>\n"}, {"tags": [], "owner": {"reputation": 2000, "user_id": 952740, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d758ce8171d8e74b9c5f5a2e701f1b9b?s=128&d=identicon&r=PG", "display_name": "Nick M", "link": "https://stackoverflow.com/users/952740/nick-m"}, "is_accepted": true, "score": 0, "last_activity_date": 1563271255, "creation_date": 1563271255, "answer_id": 57054717, "question_id": 57054163, "link": "https://stackoverflow.com/questions/57054163/in-ruby-on-rails-where-is-the-class-message-stored/57054717#57054717", "title": "In Ruby on Rails, where is the class &quot;Message&quot; stored?", "body": "<p>The Message class \"inherits\" from ActiveRecord and is \"defined\" in app/models/message.rb and generated either by a scaffolding operation as Lucas said, or you can write them manually. Using the scaffolding feature has its advantages especially when dealing with simple CRUD features - it creates the model, migration, spec/test files, then controllers and views. You can customize these further to your liking.</p>\n\n<p>Here's a guide on the typical Rails application directory structure: <a href=\"https://www.sitepoint.com/a-quick-study-of-the-rails-directory-structure/\" rel=\"nofollow noreferrer\">https://www.sitepoint.com/a-quick-study-of-the-rails-directory-structure/</a></p>\n\n<p>If you're asking where Messages are \"stored\", they are stored/persisted wherever ActiveRecord is configured to persist data. </p>\n\n<p>ActiveRecord is the class responsible for persisting (storing) and retrieving your data as you model it using model files such as message.rb located in the app/models directory.</p>\n\n<p>ActiveRecord can use sqlite, mysql/mariadb, postgres databases and many more using \"adapters\". In your application you can check config/database.yml to see what's configured and/or change the storage backend.</p>\n\n<p>The file(s) where classes are \"defined\" follow a certain naming and location convention with Rails so the loader knows what to look for, eg <code>gems/activerecord-6.0.0.rc1/lib/active_record.rb</code> (ActiveRecord) or <code>app/models/message.rb</code> (Message). You will always be saving your application models under app/models/.</p>\n"}], "owner": {"reputation": 337, "user_id": 11664580, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KxGXw.png?s=128&g=1", "display_name": "JimmyTheCode", "link": "https://stackoverflow.com/users/11664580/jimmythecode"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 148, "favorite_count": 0, "accepted_answer_id": 57054717, "answer_count": 2, "score": 0, "last_activity_date": 1563354176, "creation_date": 1563269419, "last_edit_date": 1563354176, "question_id": 57054163, "link": "https://stackoverflow.com/questions/57054163/in-ruby-on-rails-where-is-the-class-message-stored", "title": "In Ruby on Rails, where is the class &quot;Message&quot; stored?", "body": "<p>I'm trying to understand the syntax and meaning of terms in a Ruby On Rails Codecademy course. It appears that there is a class 'Message' that is a default class (one that I haven't defined). </p>\n\n<p>(EDIT: It turns out that Message isn't a default class. It was defined in ~/app/models/ and I wasn't aware. It was created when I entered the command:\n<code>rails generate model Message</code>. Any readers of this can probably ignore the rest of my question as it becomes irrelevant.\n)</p>\n\n<p>For example in the Messages Controller the following method has been defined:</p>\n\n<pre><code>~app/controllers/messages_controller\ndef new \n@message = Message.new \nend\n</code></pre>\n\n<p>I understand the above to instruct to create a new instance variable: \"@message\" of the class: \"Message\". Before we do this, we usually have to create a class \"Message\" beforehand, but I don't recall ever doing this, which suggests that Message is a default class.</p>\n\n<p>So my question is, where is the class \"Message\" defined, and where do these default actions \"new\", \"all\", etc come from?</p>\n\n<p>I've searched for \"Message\" in my rails files and have found the following:</p>\n\n<pre><code>~app/node_modules/@rails/activestorage/README.md:\n   64  \n   65  ```ruby\n   66: class Message &lt; ApplicationRecord\n   67    has_many_attached :images\n   68  end\n</code></pre>\n\n<p>Which suggests the class Message inherits from the ApplicationRecord superclass. I've done a search and there are loads of files called \"active_record.rb\". This raises further questions. How does Ruby know which \"active_record.rb\" file to refer to?</p>\n\n<p>One of the \"active_record.rb\" files is saved here:</p>\n\n<pre><code>~app/vendor/bundle/ruby/2.6.0/gems/activerecord-6.0.0.rc1/lib/active_record.rb\n</code></pre>\n"}, {"tags": ["ruby", "ruby-on-rails-6"], "comments": [{"owner": {"reputation": 4216, "user_id": 9269043, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a2763bcfa8917a365c88f8639494de7?s=128&d=identicon&r=PG", "display_name": "Vasilisa", "link": "https://stackoverflow.com/users/9269043/vasilisa"}, "edited": false, "score": 1, "creation_date": 1563280314, "post_id": 57053784, "comment_id": 100640286, "body": "Please, edit the question and make it readable"}, {"owner": {"reputation": 21, "user_id": 11785707, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VjWuu.jpg?s=128&g=1", "display_name": "Zee", "link": "https://stackoverflow.com/users/11785707/zee"}, "reply_to_user": {"reputation": 4216, "user_id": 9269043, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a2763bcfa8917a365c88f8639494de7?s=128&d=identicon&r=PG", "display_name": "Vasilisa", "link": "https://stackoverflow.com/users/9269043/vasilisa"}, "edited": false, "score": 0, "creation_date": 1563356825, "post_id": 57053784, "comment_id": 100669695, "body": "A new app &#39;rails s&#39; doesn&#39;t work.Create a new app,when I run rails s ,it throws me a cannot load such file --bindex error.I try run gem install bindex,it throws me the same error,try bundle update,the same error,try gem update,the same error.I have no idea how to fix this. please help me out.Three thousand times of appreciate for advise."}, {"owner": {"reputation": 4216, "user_id": 9269043, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a2763bcfa8917a365c88f8639494de7?s=128&d=identicon&r=PG", "display_name": "Vasilisa", "link": "https://stackoverflow.com/users/9269043/vasilisa"}, "edited": false, "score": 0, "creation_date": 1563365906, "post_id": 57053784, "comment_id": 100674431, "body": "I cloned your project from Github, it works well. What is the path to your project on your local machine?"}, {"owner": {"reputation": 21, "user_id": 11785707, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VjWuu.jpg?s=128&g=1", "display_name": "Zee", "link": "https://stackoverflow.com/users/11785707/zee"}, "reply_to_user": {"reputation": 4216, "user_id": 9269043, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a2763bcfa8917a365c88f8639494de7?s=128&d=identicon&r=PG", "display_name": "Vasilisa", "link": "https://stackoverflow.com/users/9269043/vasilisa"}, "edited": false, "score": 0, "creation_date": 1563432925, "post_id": 57053784, "comment_id": 100699589, "body": "You mean&#39;s this: /Users/sujize/app_7 ?"}, {"owner": {"reputation": 21, "user_id": 11785707, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VjWuu.jpg?s=128&g=1", "display_name": "Zee", "link": "https://stackoverflow.com/users/11785707/zee"}, "reply_to_user": {"reputation": 4216, "user_id": 9269043, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a2763bcfa8917a365c88f8639494de7?s=128&d=identicon&r=PG", "display_name": "Vasilisa", "link": "https://stackoverflow.com/users/9269043/vasilisa"}, "edited": false, "score": 0, "creation_date": 1563433226, "post_id": 57053784, "comment_id": 100699740, "body": "I&#39;m new for ruby-on-rails."}, {"owner": {"reputation": 4216, "user_id": 9269043, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a2763bcfa8917a365c88f8639494de7?s=128&d=identicon&r=PG", "display_name": "Vasilisa", "link": "https://stackoverflow.com/users/9269043/vasilisa"}, "edited": false, "score": 1, "creation_date": 1563433518, "post_id": 57053784, "comment_id": 100699891, "body": "Try to delete tmp/cache folder inside the project"}, {"owner": {"reputation": 21, "user_id": 11785707, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VjWuu.jpg?s=128&g=1", "display_name": "Zee", "link": "https://stackoverflow.com/users/11785707/zee"}, "reply_to_user": {"reputation": 4216, "user_id": 9269043, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a2763bcfa8917a365c88f8639494de7?s=128&d=identicon&r=PG", "display_name": "Vasilisa", "link": "https://stackoverflow.com/users/9269043/vasilisa"}, "edited": false, "score": 0, "creation_date": 1563519763, "post_id": 57053784, "comment_id": 100734155, "body": "Run: rm -rf tmp/cache,same error.You cloned the project and it works well,it means the project is well.So,maybe the problem is my local machine?"}, {"owner": {"reputation": 4216, "user_id": 9269043, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a2763bcfa8917a365c88f8639494de7?s=128&d=identicon&r=PG", "display_name": "Vasilisa", "link": "https://stackoverflow.com/users/9269043/vasilisa"}, "edited": false, "score": 0, "creation_date": 1563529245, "post_id": 57053784, "comment_id": 100738897, "body": "Yes, looks like issue is related to your local machine and bootsnap cache"}, {"owner": {"reputation": 21, "user_id": 11785707, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VjWuu.jpg?s=128&g=1", "display_name": "Zee", "link": "https://stackoverflow.com/users/11785707/zee"}, "reply_to_user": {"reputation": 4216, "user_id": 9269043, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a2763bcfa8917a365c88f8639494de7?s=128&d=identicon&r=PG", "display_name": "Vasilisa", "link": "https://stackoverflow.com/users/9269043/vasilisa"}, "edited": false, "score": 0, "creation_date": 1563547500, "post_id": 57053784, "comment_id": 100748358, "body": "All of my new project and cloned other people&#39;s project cannot work,I don&#39;t know what the problem is?"}, {"owner": {"reputation": 21, "user_id": 11785707, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VjWuu.jpg?s=128&g=1", "display_name": "Zee", "link": "https://stackoverflow.com/users/11785707/zee"}, "reply_to_user": {"reputation": 4216, "user_id": 9269043, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a2763bcfa8917a365c88f8639494de7?s=128&d=identicon&r=PG", "display_name": "Vasilisa", "link": "https://stackoverflow.com/users/9269043/vasilisa"}, "edited": false, "score": 0, "creation_date": 1564567390, "post_id": 57053784, "comment_id": 101071006, "body": "This project is fine,the problem is my local machine,and considering that both my native rails and ruby are the latest versions.So I tried to degrade rails and ruby, and the problem was solved.Thank you very much,you did a good job."}, {"owner": {"reputation": 4216, "user_id": 9269043, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a2763bcfa8917a365c88f8639494de7?s=128&d=identicon&r=PG", "display_name": "Vasilisa", "link": "https://stackoverflow.com/users/9269043/vasilisa"}, "edited": false, "score": 0, "creation_date": 1564582443, "post_id": 57053784, "comment_id": 101079992, "body": "Glad that you found the solution!"}, {"owner": {"reputation": 1911, "user_id": 3163663, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/dfc7587fd73f2efa19d6f1f9611b70ba?s=128&d=identicon&r=PG", "display_name": "Jason FB", "link": "https://stackoverflow.com/users/3163663/jason-fb"}, "edited": false, "score": 0, "creation_date": 1581442939, "post_id": 57053784, "comment_id": 106432305, "body": "I am seeing this on brand new Rails app 6.0.2.1 using Ruby 2.7.0 via RVM"}], "owner": {"reputation": 21, "user_id": 11785707, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VjWuu.jpg?s=128&g=1", "display_name": "Zee", "link": "https://stackoverflow.com/users/11785707/zee"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1273, "favorite_count": 1, "answer_count": 0, "score": 1, "last_activity_date": 1563365759, "creation_date": 1563268078, "last_edit_date": 1563365759, "question_id": 57053784, "link": "https://stackoverflow.com/questions/57053784/bootsnaploadpathcachefallbackscan-cannot-load-such-file-bindex", "title": "Bootsnap::LoadPathCache::FallbackScan - cannot load such file -- bindex", "body": "<p>When I run <code>rails s</code>, it throws me <code>cannot load such file -- bindex</code> error. I tried <code>gem install bindex</code>, it throws me the same error, tried <code>bundle update</code> - the same error, tried <code>gem update</code> - the same error. I have no idea how to fix this. </p>\n\n<ul>\n<li>macos mojave 10.14.5</li>\n<li>rails 6.0.o.rc1</li>\n<li>ruby 2.6.1</li>\n</ul>\n\n<p>result of <code>rails s</code></p>\n\n<pre><code>app_7 \u2b80 \u2b60 master\u00b1 \u2b80 rails s\n=&gt; Booting Puma\n=&gt; Rails 6.0.0.rc1 application starting in development\n=&gt; Run `rails server --help` for more startup options\nExiting\nTraceback (most recent call last):\nbin/rails: Bootsnap::LoadPathCache::FallbackScan\n    77: from bin/rails:3:in `&lt;main&gt;'\n    76: from bin/rails:3:in `load'\n    75: from /Users/sujize/app_7/bin/spring:15:in `&lt;top (required)&gt;'\n    74: from /Users/sujize/app_7/bin/spring:15:in `require'\n    73: from /Users/sujize/.rvm/gems/ruby-2.6.1/gems/spring-2.1.0/lib/spring/binstub.rb:11:in `&lt;top (required)&gt;'\n    72: from /Users/sujize/.rvm/gems/ruby-2.6.1/gems/spring-2.1.0/lib/spring/binstub.rb:11:in `load'\n    71: from /Users/sujize/.rvm/gems/ruby-2.6.1/gems/spring-2.1.0/bin/spring:49:in `&lt;top (required)&gt;'\n    70: from /Users/sujize/.rvm/gems/ruby-2.6.1/gems/spring-2.1.0/lib/spring/client.rb:30:in `run'\n    69: from /Users/sujize/.rvm/gems/ruby-2.6.1/gems/spring-2.1.0/lib/spring/client/command.rb:7:in `call'\n    68: from /Users/sujize/.rvm/gems/ruby-2.6.1/gems/spring-2.1.0/lib/spring/client/rails.rb:28:in `call'\n    67: from /Users/sujize/.rvm/gems/ruby-2.6.1/gems/spring-2.1.0/lib/spring/client/rails.rb:28:in `load'\n    66: from /Users/sujize/app_7/bin/rails:9:in `&lt;top (required)&gt;'\n    65: from /Users/sujize/.rvm/gems/ruby-2.6.1/gems/activesupport-6.0.0.rc1/lib/active_support/dependencies.rb:302:in `require'\n    64: from /Users/sujize/.rvm/gems/ruby-2.6.1/gems/activesupport-6.0.0.rc1/lib/active_support/dependencies.rb:268:in `load_dependency'\n    63: from /Users/sujize/.rvm/gems/ruby-2.6.1/gems/activesupport-6.0.0.rc1/lib/active_support/dependencies.rb:302:in `block in require'\n    62: from /Users/sujize/.rvm/gems/ruby-2.6.1/gems/bootsnap-1.4.4/lib/bootsnap/load_path_cache/core_ext/kernel_require.rb:30:in `require'\n    61: from /Users/sujize/.rvm/gems/ruby-2.6.1/gems/bootsnap-1.4.4/lib/bootsnap/load_path_cache/core_ext/kernel_require.rb:21:in `require_with_bootsnap_lfi'\n    60: from /Users/sujize/.rvm/gems/ruby-2.6.1/gems/bootsnap-1.4.4/lib/bootsnap/load_path_cache/loaded_features_index.rb:92:in `register'\n    59: from /Users/sujize/.rvm/gems/ruby-2.6.1/gems/bootsnap-1.4.4/lib/bootsnap/load_path_cache/core_ext/kernel_require.rb:22:in `block in require_with_bootsnap_lfi'\n    58: from /Users/sujize/.rvm/gems/ruby-2.6.1/gems/bootsnap-1.4.4/lib/bootsnap/load_path_cache/core_ext/kernel_require.rb:22:in `require'\n    57: from /Users/sujize/.rvm/gems/ruby-2.6.1/gems/railties-6.0.0.rc1/lib/rails/commands.rb:18:in `&lt;main&gt;'\n    56: from /Users/sujize/.rvm/gems/ruby-2.6.1/gems/railties-6.0.0.rc1/lib/rails/command.rb:46:in `invoke'\n    55: from /Users/sujize/.rvm/gems/ruby-2.6.1/gems/railties-6.0.0.rc1/lib/rails/command/base.rb:65:in `perform'\n    54: from /Users/sujize/.rvm/gems/ruby-2.6.1/gems/thor-0.20.3/lib/thor.rb:387:in `dispatch'\n    53: from /Users/sujize/.rvm/gems/ruby-2.6.1/gems/thor-0.20.3/lib/thor/invocation.rb:126:in `invoke_command'\n    52: from /Users/sujize/.rvm/gems/ruby-2.6.1/gems/thor-0.20.3/lib/thor/command.rb:27:in `run'\n    51: from /Users/sujize/.rvm/gems/ruby-2.6.1/gems/railties-6.0.0.rc1/lib/rails/commands/server/server_command.rb:138:in `perform'\n    50: from /Users/sujize/.rvm/gems/ruby-2.6.1/gems/railties-6.0.0.rc1/lib/rails/commands/server/server_command.rb:138:in `tap'\n    49: from /Users/sujize/.rvm/gems/ruby-2.6.1/gems/railties-6.0.0.rc1/lib/rails/commands/server/server_command.rb:147:in `block in perform'\n    48: from /Users/sujize/.rvm/gems/ruby-2.6.1/gems/railties-6.0.0.rc1/lib/rails/commands/server/server_command.rb:37:in `start'\n    47: from /Users/sujize/.rvm/gems/ruby-2.6.1/gems/railties-6.0.0.rc1/lib/rails/commands/server/server_command.rb:77:in `log_to_stdout'\n    46: from /Users/sujize/.rvm/gems/ruby-2.6.1/gems/rack-2.0.7/lib/rack/server.rb:354:in `wrapped_app'\n    45: from /Users/sujize/.rvm/gems/ruby-2.6.1/gems/rack-2.0.7/lib/rack/server.rb:219:in `app'\n    44: from /Users/sujize/.rvm/gems/ruby-2.6.1/gems/rack-2.0.7/lib/rack/server.rb:319:in `build_app_and_options_from_config'\n    43: from /Users/sujize/.rvm/gems/ruby-2.6.1/gems/rack-2.0.7/lib/rack/builder.rb:40:in `parse_file'\n    42: from /Users/sujize/.rvm/gems/ruby-2.6.1/gems/rack-2.0.7/lib/rack/builder.rb:49:in `new_from_string'\n    41: from /Users/sujize/.rvm/gems/ruby-2.6.1/gems/rack-2.0.7/lib/rack/builder.rb:49:in `eval'\n    40: from config.ru:in `&lt;main&gt;'\n    39: from config.ru:in `new'\n    38: from /Users/sujize/.rvm/gems/ruby-2.6.1/gems/rack-2.0.7/lib/rack/builder.rb:55:in `initialize'\n    37: from /Users/sujize/.rvm/gems/ruby-2.6.1/gems/rack-2.0.7/lib/rack/builder.rb:55:in `instance_eval'\n    36: from config.ru:3:in `block in &lt;main&gt;'\n    35: from /Users/sujize/.rvm/gems/ruby-2.6.1/gems/bootsnap-1.4.4/lib/bootsnap/load_path_cache/core_ext/kernel_require.rb:48:in `require_relative'\n    34: from /Users/sujize/.rvm/gems/ruby-2.6.1/gems/activesupport-6.0.0.rc1/lib/active_support/dependencies.rb:302:in `require'\n    33: from /Users/sujize/.rvm/gems/ruby-2.6.1/gems/activesupport-6.0.0.rc1/lib/active_support/dependencies.rb:268:in `load_dependency'\n    32: from /Users/sujize/.rvm/gems/ruby-2.6.1/gems/activesupport-6.0.0.rc1/lib/active_support/dependencies.rb:302:in `block in require'\n    31: from /Users/sujize/.rvm/gems/ruby-2.6.1/gems/zeitwerk-2.1.8/lib/zeitwerk/kernel.rb:23:in `require'\n    30: from /Users/sujize/.rvm/gems/ruby-2.6.1/gems/bootsnap-1.4.4/lib/bootsnap/load_path_cache/core_ext/kernel_require.rb:30:in `require'\n    29: from /Users/sujize/.rvm/gems/ruby-2.6.1/gems/bootsnap-1.4.4/lib/bootsnap/load_path_cache/core_ext/kernel_require.rb:21:in `require_with_bootsnap_lfi'\n    28: from /Users/sujize/.rvm/gems/ruby-2.6.1/gems/bootsnap-1.4.4/lib/bootsnap/load_path_cache/loaded_features_index.rb:92:in `register'\n    27: from /Users/sujize/.rvm/gems/ruby-2.6.1/gems/bootsnap-1.4.4/lib/bootsnap/load_path_cache/core_ext/kernel_require.rb:22:in `block in require_with_bootsnap_lfi'\n    26: from /Users/sujize/.rvm/gems/ruby-2.6.1/gems/bootsnap-1.4.4/lib/bootsnap/load_path_cache/core_ext/kernel_require.rb:22:in `require'\n    25: from /Users/sujize/app_7/config/environment.rb:5:in `&lt;main&gt;'\n    24: from /Users/sujize/.rvm/gems/ruby-2.6.1/gems/railties-6.0.0.rc1/lib/rails/application.rb:362:in `initialize!'\n    23: from /Users/sujize/.rvm/gems/ruby-2.6.1/gems/railties-6.0.0.rc1/lib/rails/initializable.rb:60:in `run_initializers'\n    22: from /Users/sujize/.rvm/rubies/ruby-2.6.1/lib/ruby/2.6.0/tsort.rb:205:in `tsort_each'\n    21: from /Users/sujize/.rvm/rubies/ruby-2.6.1/lib/ruby/2.6.0/tsort.rb:226:in `tsort_each'\n    20: from /Users/sujize/.rvm/rubies/ruby-2.6.1/lib/ruby/2.6.0/tsort.rb:347:in `each_strongly_connected_component'\n    19: from /Users/sujize/.rvm/rubies/ruby-2.6.1/lib/ruby/2.6.0/tsort.rb:347:in `call'\n    18: from /Users/sujize/.rvm/rubies/ruby-2.6.1/lib/ruby/2.6.0/tsort.rb:347:in `each'\n    17: from /Users/sujize/.rvm/rubies/ruby-2.6.1/lib/ruby/2.6.0/tsort.rb:349:in `block in each_strongly_connected_component'\n    16: from /Users/sujize/.rvm/rubies/ruby-2.6.1/lib/ruby/2.6.0/tsort.rb:431:in `each_strongly_connected_component_from'\n    15: from /Users/sujize/.rvm/rubies/ruby-2.6.1/lib/ruby/2.6.0/tsort.rb:350:in `block (2 levels) in each_strongly_connected_component'\n    14: from /Users/sujize/.rvm/rubies/ruby-2.6.1/lib/ruby/2.6.0/tsort.rb:228:in `block in tsort_each'\n    13: from /Users/sujize/.rvm/gems/ruby-2.6.1/gems/railties-6.0.0.rc1/lib/rails/initializable.rb:61:in `block in run_initializers'\n    12: from /Users/sujize/.rvm/gems/ruby-2.6.1/gems/railties-6.0.0.rc1/lib/rails/initializable.rb:32:in `run'\n    11: from /Users/sujize/.rvm/gems/ruby-2.6.1/gems/railties-6.0.0.rc1/lib/rails/initializable.rb:32:in `instance_exec'\n    10: from /Users/sujize/.rvm/gems/ruby-2.6.1/gems/web-console-4.0.0/lib/web_console/railtie.rb:11:in `block in &lt;class:Railtie&gt;'\n     9: from /Users/sujize/.rvm/gems/ruby-2.6.1/gems/activesupport-6.0.0.rc1/lib/active_support/dependencies.rb:302:in `require'\n     8: from /Users/sujize/.rvm/gems/ruby-2.6.1/gems/activesupport-6.0.0.rc1/lib/active_support/dependencies.rb:268:in `load_dependency'\n     7: from /Users/sujize/.rvm/gems/ruby-2.6.1/gems/activesupport-6.0.0.rc1/lib/active_support/dependencies.rb:302:in `block in require'\n     6: from /Users/sujize/.rvm/gems/ruby-2.6.1/gems/zeitwerk-2.1.8/lib/zeitwerk/kernel.rb:23:in `require'\n     5: from /Users/sujize/.rvm/gems/ruby-2.6.1/gems/bootsnap-1.4.4/lib/bootsnap/load_path_cache/core_ext/kernel_require.rb:26:in `require'\n     4: from /Users/sujize/.rvm/gems/ruby-2.6.1/gems/bootsnap-1.4.4/lib/bootsnap/load_path_cache/core_ext/kernel_require.rb:40:in `rescue in require'\n     3: from /Users/sujize/.rvm/gems/ruby-2.6.1/gems/bootsnap-1.4.4/lib/bootsnap/load_path_cache/core_ext/kernel_require.rb:21:in `require_with_bootsnap_lfi'\n     2: from /Users/sujize/.rvm/gems/ruby-2.6.1/gems/bootsnap-1.4.4/lib/bootsnap/load_path_cache/loaded_features_index.rb:89:in `register'\n     1: from /Users/sujize/.rvm/gems/ruby-2.6.1/gems/bootsnap-1.4.4/lib/bootsnap/load_path_cache/core_ext/kernel_require.rb:22:in `block in require_with_bootsnap_lfi'\n/Users/sujize/.rvm/gems/ruby-2.6.1/gems/bootsnap-1.4.4/lib/bootsnap/load_path_cache/core_ext/kernel_require.rb:22:in `require': **cannot load such file -- bindex (LoadError)**\n</code></pre>\n\n<p>The error:</p>\n\n<pre><code>1: from /Users/sujize/.rvm/gems/ruby-2.6.1/gems/bootsnap-1.4.4/lib/bootsnap/load_path_cache/core_ext/kernel_require.rb:22:in `block in require_with_bootsnap_lfi'\n/Users/sujize/.rvm/gems/ruby-2.6.1/gems/bootsnap-1.4.4/lib/bootsnap/load_path_cache/core_ext/kernel_require.rb:22:in `require': **cannot load such file -- bindex (LoadError)**\n</code></pre>\n\n<p>Here is my <a href=\"https://github.com/Zeesui/app_7\" rel=\"nofollow noreferrer\">repo</a> on Github</p>\n"}, {"tags": ["ruby", "youtube-api"], "comments": [{"owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 0, "creation_date": 1563264872, "post_id": 57052270, "comment_id": 100632001, "body": "Take a look at the &quot;view source&quot; in the docs <a href=\"https://www.rubydoc.info/github/google/google-api-ruby-client/Google%2FApis%2FYoutubeV3%2FYouTubeService:list_comments\" rel=\"nofollow noreferrer\">here</a>. I wonder if it would work to patch this to accept the <code>videoId</code> param. You could add another line in there: <code>command.query[&#39;videoId&#39;] = videoId unless videoId.nil?</code> No guarantee this will work, just a hunch"}, {"owner": {"reputation": 11, "user_id": 11790481, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a47366260381c200fea84a10bf5fbb95?s=128&d=identicon&r=PG&f=1", "display_name": "Kdubs", "link": "https://stackoverflow.com/users/11790481/kdubs"}, "reply_to_user": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 0, "creation_date": 1563268508, "post_id": 57052270, "comment_id": 100633982, "body": "Thanks for your reply Max! I&#39;ve seen the library you pointed me to, but that&#39;s the method&#39;s actual implementation by the API.."}, {"owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 0, "creation_date": 1563292251, "post_id": 57052270, "comment_id": 100647745, "body": "Yes, im saying you could patch that method"}], "answers": [{"tags": [], "owner": {"reputation": 11, "user_id": 11790481, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a47366260381c200fea84a10bf5fbb95?s=128&d=identicon&r=PG&f=1", "display_name": "Kdubs", "link": "https://stackoverflow.com/users/11790481/kdubs"}, "is_accepted": false, "score": 0, "last_activity_date": 1563351690, "last_edit_date": 1563351690, "creation_date": 1563333551, "answer_id": 57068081, "question_id": 57052270, "link": "https://stackoverflow.com/questions/57052270/list-comments-ruby-implementation-with-youtube-video-id/57068081#57068081", "title": "list_comments Ruby implementation with YouTube video_id", "body": "<p>Found the solution! The method that allows you to specify video_id (or channel_id) to select a specific resource is: list_comment_threads from the Google::Apis::YoutubeV3::YouTubeService module.</p>\n\n<pre><code>response = service.list_comment_threads('snippet', video_id: 'hy1v891n3kA').to_json\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 11790481, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a47366260381c200fea84a10bf5fbb95?s=128&d=identicon&r=PG&f=1", "display_name": "Kdubs", "link": "https://stackoverflow.com/users/11790481/kdubs"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 86, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1563351690, "creation_date": 1563262713, "last_edit_date": 1563266046, "question_id": 57052270, "link": "https://stackoverflow.com/questions/57052270/list-comments-ruby-implementation-with-youtube-video-id", "title": "list_comments Ruby implementation with YouTube video_id", "body": "<p>Having trouble implementing the list_comments method in the following code example (n.b. the API is initialised successfully):</p>\n\n<pre><code># initialize API\nservice = Google::Apis::YoutubeV3::YouTubeService.new\nservice.client_options.application_name = APPLICATION_NAME\nservice.authorization = authorize\n\nresponse = service.list_comments('snippet, replies')\n</code></pre>\n\n<p>Currently the method returns the following error: </p>\n\n<blockquote>\n  <p>missingRequiredParameter: No filter selected. Expected one of: <code>id</code>, <code>idParam</code>, <code>parentId</code> (<code>Google::Apis::ClientError</code>)</p>\n</blockquote>\n\n<p>I have successfully tested the API call here:\n<a href=\"https://developers.google.com/youtube/v3/docs/comments/list\" rel=\"nofollow noreferrer\">https://developers.google.com/youtube/v3/docs/comments/list</a></p>\n\n<p>What I'm struggling with is when I test the API call I can pass a <code>videoId</code> to identify a resource, however the method implementation does not allow for this. Could anyone shed some light on how to pass a <code>videoId</code> to the method call?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "capistrano", "rbenv"], "comments": [{"owner": {"reputation": 19261, "user_id": 4758119, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/F4dJY.jpg?s=128&g=1", "display_name": "Deepak Mahakale", "link": "https://stackoverflow.com/users/4758119/deepak-mahakale"}, "edited": false, "score": 0, "creation_date": 1563261404, "post_id": 57051268, "comment_id": 100630232, "body": "Try moving the <code>capistrano-rbenv</code> to staging group in Gemfile if you don&#39;t already have it there"}, {"owner": {"reputation": 566, "user_id": 2940397, "user_type": "registered", "accept_rate": 52, "profile_image": "https://i.stack.imgur.com/VYkZH.jpg?s=128&g=1", "display_name": "Marat", "link": "https://stackoverflow.com/users/2940397/marat"}, "reply_to_user": {"reputation": 19261, "user_id": 4758119, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/F4dJY.jpg?s=128&g=1", "display_name": "Deepak Mahakale", "link": "https://stackoverflow.com/users/4758119/deepak-mahakale"}, "edited": false, "score": 0, "creation_date": 1563266325, "post_id": 57051268, "comment_id": 100632741, "body": "@DeepakMahakale it&#39;s already in dev group"}], "answers": [{"comments": [{"owner": {"reputation": 566, "user_id": 2940397, "user_type": "registered", "accept_rate": 52, "profile_image": "https://i.stack.imgur.com/VYkZH.jpg?s=128&g=1", "display_name": "Marat", "link": "https://stackoverflow.com/users/2940397/marat"}, "edited": false, "score": 0, "creation_date": 1563267166, "post_id": 57052018, "comment_id": 100633249, "body": "thank you, answer from that issue helped. So here&#39;s what you have to exactly do:  if Rake.application.top_level_tasks.first == &quot;staging&quot;   require &#39;capistrano/rbenv&#39; end"}, {"owner": {"reputation": 19261, "user_id": 4758119, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/F4dJY.jpg?s=128&g=1", "display_name": "Deepak Mahakale", "link": "https://stackoverflow.com/users/4758119/deepak-mahakale"}, "reply_to_user": {"reputation": 566, "user_id": 2940397, "user_type": "registered", "accept_rate": 52, "profile_image": "https://i.stack.imgur.com/VYkZH.jpg?s=128&g=1", "display_name": "Marat", "link": "https://stackoverflow.com/users/2940397/marat"}, "edited": false, "score": 0, "creation_date": 1563269809, "post_id": 57052018, "comment_id": 100634640, "body": "@Marat Good to know. I will add that snippet in the answer in case someone else stumbles upon the same issue"}], "tags": [], "owner": {"reputation": 19261, "user_id": 4758119, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/F4dJY.jpg?s=128&g=1", "display_name": "Deepak Mahakale", "link": "https://stackoverflow.com/users/4758119/deepak-mahakale"}, "is_accepted": true, "score": 1, "last_activity_date": 1563269849, "last_edit_date": 1563269849, "creation_date": 1563261817, "answer_id": 57052018, "question_id": 57051268, "link": "https://stackoverflow.com/questions/57051268/rails-capistrano-deploy-with-and-without-rbenv/57052018#57052018", "title": "Rails Capistrano deploy with and without rbenv", "body": "<p>To avoid the gem getting loaded in <code>production</code> environment,</p>\n\n<p>Try moving the <code>capistrano-rbenv</code> to <code>staging</code> group in Gemfile if you don't already have it there. </p>\n\n<p>Also, you must have an entry in Capfile</p>\n\n<pre><code>require 'capistrano/rbenv'\n</code></pre>\n\n<p>You need to make it conditional so that you don't end up requiring it in production environment</p>\n\n<p>There is an old issue which solves a similar issue, please take a look</p>\n\n<p><a href=\"https://github.com/capistrano/rbenv/issues/31\" rel=\"nofollow noreferrer\">https://github.com/capistrano/rbenv/issues/31</a></p>\n\n<p>Add this in Capfile</p>\n\n<pre><code>if Rake.application.top_level_tasks.first == \"staging\"\n  require 'capistrano/rbenv'\nend\n</code></pre>\n"}], "owner": {"reputation": 566, "user_id": 2940397, "user_type": "registered", "accept_rate": 52, "profile_image": "https://i.stack.imgur.com/VYkZH.jpg?s=128&g=1", "display_name": "Marat", "link": "https://stackoverflow.com/users/2940397/marat"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 169, "favorite_count": 0, "accepted_answer_id": 57052018, "answer_count": 1, "score": 0, "last_activity_date": 1563269849, "creation_date": 1563258679, "last_edit_date": 1563259063, "question_id": 57051268, "link": "https://stackoverflow.com/questions/57051268/rails-capistrano-deploy-with-and-without-rbenv", "title": "Rails Capistrano deploy with and without rbenv", "body": "<p>Old rails project on production has no rbenv, uses ruby installed manually. I've set a staging for it WITH rbenv, added capistrano-rbenv gem and capistrano staging deploy config params. Now it keeps searching for rbenv folders even while deploying to production and it of course fails.</p>\n\n<p>Is there a way I can configure capistrano not to use rbenv while deploying to production?</p>\n\n<p>Here are my current config files:</p>\n\n<p><strong>deploy.rb</strong></p>\n\n<pre><code># config valid only for Capistrano 3.1\nlock '3.4.1'\n\n# Git repo URL\nset :repo_url, '...'\n\n# Default value for :pty is false\nset :pty, true\n\n# Don't use sudo\nset :use_sudo, false\n\n# Default value for :linked_files is []\nset :linked_files, %w{config/database.yml config/secrets.yml}\n\n# Default value for linked_dirs is []\nset :linked_dirs, %w{bin log tmp/pids tmp/cache tmp/sockets vendor/bundle public/system public/uploads}\n\n# Default value for default_env is {}\n# set :default_env, { path: \"/opt/ruby/bin:$PATH\" }\n\nnamespace :deploy do\n ...\nend\n</code></pre>\n\n<p><strong>deploy/staging.rb</strong></p>\n\n<pre><code># Application name\nset :application, '...'\n\n# Use a specific tmp dir\nset :tmp_dir, \"/home/user_name/apps/#{fetch(:application)}/tmp\"\n\n# Deploy to this location\nset :deploy_to, \"/home/user_name/apps/#{fetch(:application)}\"\n\n# Branch to deploy from\nset :branch, 'staging'\n\n# rbenv stuff\nset :rbenv_type, :user\nset :rbenv_ruby, '2.2.5'\nset :rbenv_prefix, \"RBENV_ROOT=#{fetch(:rbenv_path)} RBENV_VERSION=#{fetch(:rbenv_ruby)} #{fetch(:rbenv_path)}/bin/rbenv exec\"\nset :rbenv_map_bins, %w{rake gem bundle ruby rails}\nset :rbenv_roles, :all # default value\n\n# General\nserver '...', user: 'user_name', roles: %w{app web db}\n</code></pre>\n\n<p><strong>deploy/production.rb</strong></p>\n\n<pre><code># Application name\nset :application, 'production'\n\n# Use a specific tmp dir\nset :tmp_dir, \"/home/user_name/apps/#{fetch(:application)}/tmp\"\n\n# Deploy to this location\nset :deploy_to, \"/home/user_name/apps/#{fetch(:application)}\"\n\n# Branch to deploy from\nset :branch, 'master'\n\n# General\nserver '...', user: 'user_name', roles: %w{app web db}\n</code></pre>\n\n<p><strong>production ruby</strong></p>\n\n<pre><code>production@server_name:~$ ruby -v\nruby 2.2.10p489 (2018-03-28 revision 63023) [x86_64-linux]\n\nproduction@server_name:~$ which ruby\n/usr/bin/ruby\n</code></pre>\n"}, {"tags": ["ruby", "sorbet"], "comments": [{"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 5, "creation_date": 1563256623, "post_id": 57050827, "comment_id": 100628279, "body": "<i>Sidenote:</i> it makes zero sense to return <code>self</code> as well as anything else from <code>initialize</code>. The returned value is effectively discarded."}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 2, "creation_date": 1563256668, "post_id": 57050827, "comment_id": 100628295, "body": "What line is 39? Please also show the whole code of this class, including declaration."}, {"owner": {"reputation": 6973, "user_id": 98634, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2bb923c57a1fdc3a2eb484bb8d565fd2?s=128&d=identicon&r=PG", "display_name": "paracycle", "link": "https://stackoverflow.com/users/98634/paracycle"}, "edited": false, "score": 0, "creation_date": 1563300276, "post_id": 57050827, "comment_id": 100651391, "body": "Also, it would be great if you can recreate the same error in <a href=\"https://sorbet.run\" rel=\"nofollow noreferrer\">sorbet.run</a> and post the link to it here."}, {"owner": {"reputation": 9, "user_id": 11071183, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-CQAxkUPoaxI/AAAAAAAAAAI/AAAAAAAAALM/MnOhTNQDA1A/photo.jpg?sz=128", "display_name": "Swadhin Kumar", "link": "https://stackoverflow.com/users/11071183/swadhin-kumar"}, "edited": false, "score": 0, "creation_date": 1563350366, "post_id": 57050827, "comment_id": 100666120, "body": "Attaching a link to sorbet playground - <a href=\"https://sorbet.run/#%23%20typed%3A%20strict%0Aclass%20A%0A%20%20extend%20T%3A%3ASig%0A%0A%20%20sig%20%7Breturns(Integer)%7D%0A%20%20attr_accessor%20%3Ax%0A%20%20%0A%20%20sig%20%7Bparams(y%3A%20Integer).void%7D%0A%20%20def%20initiazlize(y)%0A%20%20%20%20%40x%20%3D%20y%0A%20%20end%0A%0A%20%20sig%7Breturns(Integer)%7D%0A%20%20def%20simple_operation%0A%20%20%20%20%40x%20%3D%205%0A%20%20%20%20%40x%0A%20%20end%0A%0Aend\" rel=\"nofollow noreferrer\">sorbet.run/&hellip;</a>"}, {"owner": {"reputation": 74087, "user_id": 214790, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f878c8230342730990acd21f889301d4?s=128&d=identicon&r=PG", "display_name": "matt", "link": "https://stackoverflow.com/users/214790/matt"}, "edited": false, "score": 1, "creation_date": 1563395405, "post_id": 57050827, "comment_id": 100690404, "body": "You need to declare the instance variable inside the <code>initialize</code> method, not the <code>initiazlize</code> method which is what you have (note the extra <code>z</code>)."}], "answers": [{"tags": [], "owner": {"reputation": 5595, "user_id": 77040, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/6343ef938226f72218388cb8f0eec754?s=128&d=identicon&r=PG", "display_name": "dustyburwell", "link": "https://stackoverflow.com/users/77040/dustyburwell"}, "is_accepted": false, "score": 2, "last_activity_date": 1563808428, "creation_date": 1563808428, "answer_id": 57149014, "question_id": 57050827, "link": "https://stackoverflow.com/questions/57050827/sorbet-instance-variables-must-be-declared-inside-initialize/57149014#57149014", "title": "Sorbet: Instance variables must be declared inside `initialize`", "body": "<p>It appears you've maybe typo'd the <code>initialize</code> method name. <a href=\"https://sorbet.run/#%23%20typed%3A%20strict%0Aclass%20A%0A%20%20extend%20T%3A%3ASig%0A%0A%20%20sig%20%7Breturns(Integer)%7D%0A%20%20attr_accessor%20%3Ax%0A%20%20%0A%20%20sig%20%7Bparams(y%3A%20Integer).void%7D%0A%20%20def%20initialize(y)%0A%20%20%20%20%40x%20%3D%20T.let(y%2C%20Integer)%0A%20%20end%0A%0A%20%20sig%7Breturns(Integer)%7D%0A%20%20def%20simple_operation%0A%20%20%20%20%40x%20%3D%205%0A%20%20%20%20%40x%0A%20%20end%0A%0Aend\" rel=\"nofollow noreferrer\">fixed example</a></p>\n"}], "owner": {"reputation": 9, "user_id": 11071183, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-CQAxkUPoaxI/AAAAAAAAAAI/AAAAAAAAALM/MnOhTNQDA1A/photo.jpg?sz=128", "display_name": "Swadhin Kumar", "link": "https://stackoverflow.com/users/11071183/swadhin-kumar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 690, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1563808428, "creation_date": 1563256379, "last_edit_date": 1563395627, "question_id": 57050827, "link": "https://stackoverflow.com/questions/57050827/sorbet-instance-variables-must-be-declared-inside-initialize", "title": "Sorbet: Instance variables must be declared inside `initialize`", "body": "<p>Getting - Instance variables must be declared inside <code>initialize</code> even though I have already declared the instance variables inside initialize.</p>\n\n<p>I am using <code>typed: strict</code> to type check my ruby code. One of the instance methods I am using an instance variable <code>@updated</code>. Sorbet threw an error - \"Use of an undeclared variable\". I created an initialize method to declare it. And then \"Use of an undeclared variable\" got replaced with \"Instance variables must be declared inside <code>initialize</code>\"</p>\n\n<pre><code>sig{returns(&lt;&lt;redacted&gt;&gt;)}\ndef initialize\n  @updated = T.let(Time.now, Time)\n  self\nend\n</code></pre>\n\n<p>The error is - </p>\n\n<pre><code>Instance variables must be declared inside `initialize` https://srb.help/5005\n    39 |       @updated = T.let(Time.now, Time)\n</code></pre>\n\n<p>Expected - There shouldn't be any error as instance variable is declared in <code>def initialize</code></p>\n\n<p>Edit: I have reproduced this in <a href=\"https://sorbet.run/#%23%20typed%3A%20strict%0Aclass%20A%0A%20%20extend%20T%3A%3ASig%0A%0A%20%20sig%20%7Breturns(Integer)%7D%0A%20%20attr_accessor%20%3Ax%0A%20%20%0A%20%20sig%20%7Bparams(y%3A%20Integer).void%7D%0A%20%20def%20initiazlize(y)%0A%20%20%20%20%40x%20%3D%20y%0A%20%20end%0A%0A%20%20sig%7Breturns(Integer)%7D%0A%20%20def%20simple_operation%0A%20%20%20%20%40x%20%3D%205%0A%20%20%20%20%40x%0A%20%20end%0A%0Aend\" rel=\"nofollow noreferrer\">Sorbet Playground</a></p>\n\n<pre><code># typed: strict\nclass A\n  extend T::Sig\n\n  sig {returns(Integer)}\n  attr_accessor :x\n\n  sig {params(y: Integer).void}\n  def initiazlize(y)\n    @x = y\n  end\n\n  sig{returns(Integer)}\n  def simple_operation\n    @x = 5\n    @x\n  end\nend\n\n# -- error\neditor.rb:10: Instance variables must be declared inside `initialize` https://srb.help/5005\n    10 |    @x = T.let(y, Integer)\n            ^^\nErrors: 1\n</code></pre>\n"}, {"tags": ["ruby", "ruby-on-rails-5"], "owner": {"reputation": 31, "user_id": 9640695, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/x1zgJ.jpg?s=128&g=1", "display_name": "Jay Kevadiya", "link": "https://stackoverflow.com/users/9640695/jay-kevadiya"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 66, "favorite_count": 0, "closed_date": 1563252582, "answer_count": 0, "score": 2, "last_activity_date": 1563250579, "creation_date": 1563250355, "last_edit_date": 1563250579, "question_id": 57049931, "link": "https://stackoverflow.com/questions/57049931/how-to-redirect-another-page-after-send-file-from-controller-in-rails", "closed_reason": "Duplicate", "title": "How to redirect another page after send_file from controller in Rails?", "body": "<p>I'm submitting one form and after data saved from controller side, one file generation completed and before redirect want to send_file which through file in browser. Some documents shows that you can't do both <code>send_file</code> and redirection from same action, is that right?</p>\n"}, {"tags": ["ruby", "sass"], "answers": [{"comments": [{"owner": {"reputation": 7856, "user_id": 79068, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/FNeR0.png?s=128&g=1", "display_name": "Ben Hull", "link": "https://stackoverflow.com/users/79068/ben-hull"}, "edited": false, "score": 0, "creation_date": 1563262106, "post_id": 57051838, "comment_id": 100630565, "body": "Excellent detective work, thank you! I assumed it was something like this, but I&#39;d never seen it (and I&#39;ve been using SASS for close to 10 years). What an odd convention - I wonder what the rationale behind it was."}, {"owner": {"reputation": 2642, "user_id": 9718056, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/40NGR.png?s=128&g=1", "display_name": "Arkellys", "link": "https://stackoverflow.com/users/9718056/arkellys"}, "reply_to_user": {"reputation": 7856, "user_id": 79068, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/FNeR0.png?s=128&g=1", "display_name": "Ben Hull", "link": "https://stackoverflow.com/users/79068/ben-hull"}, "edited": false, "score": 0, "creation_date": 1563262750, "post_id": 57051838, "comment_id": 100630873, "body": "You&#39;re welcome, I actually enjoyed to look for that information!"}], "tags": [], "owner": {"reputation": 2642, "user_id": 9718056, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/40NGR.png?s=128&g=1", "display_name": "Arkellys", "link": "https://stackoverflow.com/users/9718056/arkellys"}, "is_accepted": true, "score": 3, "last_activity_date": 1563261758, "last_edit_date": 1563261758, "creation_date": 1563261087, "answer_id": 57051838, "question_id": 57048607, "link": "https://stackoverflow.com/questions/57048607/what-is-this-odd-sass-property-syntax/57051838#57051838", "title": "What is this odd SASS property syntax?", "body": "<p>I had to use <a href=\"https://web.archive.org/web/20150208082452/http://sass-lang.com/documentation/file.INDENTED_SYNTAX.html\" rel=\"nofollow noreferrer\">Wayback Machine</a> to find the \"official\" information, and it seems that it is just the old SASS way to write a declaration:</p>\n\n<blockquote>\n  <h3>Property Syntax</h3>\n  \n  <p>The indented syntax supports two ways of declaring CSS\n  properties. The first is just like CSS, except without the semicolon.\n  The second, however, places the colon before the property name. For\n  example:</p>\n\n<pre><code>#main\n  :color blue\n  :font-size 0.3em\n</code></pre>\n  \n  <p>By default, both ways may be used. However, the <a href=\"https://web.archive.org/web/20150207060610/http://sass-lang.com/documentation/file.SASS_REFERENCE.html#property_syntax-option\" rel=\"nofollow noreferrer\">:property_syntax option</a> may be used to specify that\n  only one property syntax is allowed.</p>\n</blockquote>\n\n<p>I also found some others mentions of this syntax here:</p>\n\n<ul>\n<li><a href=\"https://stackoverflow.com/q/3062241/9718056\">Using colon syntax and variables in Sass</a></li>\n<li><a href=\"https://gist.github.com/aarongray/7376335\" rel=\"nofollow noreferrer\">Convert Sass stylesheets from the old colon syntax</a></li>\n<li><a href=\"https://github.com/sass/sass/issues/2245\" rel=\"nofollow noreferrer\">Deprecate old-style property syntax</a></li>\n</ul>\n\n<hr>\n\n<p><strong>Edit</strong> : there is also an online reference about this <a href=\"https://www.javatpoint.com/sass-syntax\" rel=\"nofollow noreferrer\">here</a>.</p>\n"}], "owner": {"reputation": 7856, "user_id": 79068, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/FNeR0.png?s=128&g=1", "display_name": "Ben Hull", "link": "https://stackoverflow.com/users/79068/ben-hull"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 76, "favorite_count": 0, "accepted_answer_id": 57051838, "answer_count": 1, "score": 4, "last_activity_date": 1563261758, "creation_date": 1563236534, "question_id": 57048607, "link": "https://stackoverflow.com/questions/57048607/what-is-this-odd-sass-property-syntax", "title": "What is this odd SASS property syntax?", "body": "<p>I'm working with some SASS code, written for ruby-sass v3.2. In some of the stylesheets, property declarations are written like:</p>\n\n<pre><code>.something\n  :height 10em\n  :width 100%\n  :font-size 1.5em\n</code></pre>\n\n<p>This compiles and appears to be valid, but I can't find reference to it anywhere. Is this just a quirk of Ruby parsing them as symbols, or something in SASS I've never seen before?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "rails-api", "jbuilder", "ruby-on-rails-6"], "answers": [{"tags": [], "owner": {"reputation": 1228, "user_id": 960819, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/382c8d761371f83ff28f5e96da0204fe?s=128&d=identicon&r=PG", "display_name": "Pere Joan Martorell", "link": "https://stackoverflow.com/users/960819/pere-joan-martorell"}, "is_accepted": false, "score": 0, "last_activity_date": 1565863459, "creation_date": 1565863459, "answer_id": 57508016, "question_id": 57048081, "link": "https://stackoverflow.com/questions/57048081/rendering-activestorage-blobs-from-a-jbuilder-view-in-a-rails-6-api-only-applica/57508016#57508016", "title": "Rendering ActiveStorage blobs from a JBuilder view in a Rails 6 API-only application", "body": "<p>Sorry, but <code>ActionController::API</code> is not intended to render HTML, it does not render  templates either. This line is not going to work for sure:</p>\n\n<pre><code>json.content render partial: 'api/posts/post-content.html.erb', locals: { post: post }\n</code></pre>\n\n<p>Why don't you just put <code>json.content</code> instead of rendering a template?</p>\n"}], "owner": {"reputation": 845, "user_id": 1133224, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/a5474911b8ef3c583c7516df1d29227d?s=128&d=identicon&r=PG", "display_name": "TWGerard", "link": "https://stackoverflow.com/users/1133224/twgerard"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 480, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1568116658, "creation_date": 1563231340, "last_edit_date": 1568116658, "question_id": 57048081, "link": "https://stackoverflow.com/questions/57048081/rendering-activestorage-blobs-from-a-jbuilder-view-in-a-rails-6-api-only-applica", "title": "Rendering ActiveStorage blobs from a JBuilder view in a Rails 6 API-only application", "body": "<p>I am building an API-only backend using Rails 6.0.0.rc1. My base controller extends <code>ApplicationController::API</code> and renders JBuilder views. My <code>Post</code> model has an ActionText rich text attribute called <code>content</code>. In order to render <code>Post.content</code> properly my JBuilder view renders an HTML partial. This works well except that any ActiveStorage images get the wrong domain name in their URLs (example.org).</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code># app/controllers/api/api_controller.rb\n\nclass Api::ApiController &lt; ActionController::API\n  include ActionView::Layouts\n  layout 'api'\n\n  before_action :set_default_response_format\n\n  private\n\n  def set_default_response_format\n    request.format = :json\n  end\nend\n</code></pre>\n\n<pre class=\"lang-rb prettyprint-override\"><code># app/controllers/api/posts_controller.rb\n\nclass Api::PostsController &lt; Api::ApiController\n  def index\n    @posts = Post.published\n  end\nend\n</code></pre>\n\n<pre class=\"lang-rb prettyprint-override\"><code># app/views/api/posts/index.json.jbuilder\n\njson.posts @posts, partial: 'api/posts/post', as: :post\n</code></pre>\n\n<pre class=\"lang-rb prettyprint-override\"><code># app/views/api/posts/_post.json.jbuilder\n\njson.extract! post,\n              :id,\n              :type,\n              :slug,\n              :path,\n              :title,\n              :excerpt\n\njson.content render partial: 'api/posts/post-content.html.erb', locals: { post: post }\n</code></pre>\n\n<pre class=\"lang-rb prettyprint-override\"><code># app/views/api/posts/_post-content.html.erb\n\n&lt;%= post.content %&gt;\n</code></pre>\n\n<p>I have tried various methods of changing the renderers default http_host value but none of them have worked. The only way I can fix this problem is to change my controller to inherit from <code>ApplicationController::Base</code> instead of <code>API</code>, which is not ideal. I'd prefer to selectively include whichever modules are required to make this work, but I haven't been able to figure out which ones this might be. I suspect that it might be the difference between <code>Rendering</code> and <code>ApiRendering</code>, but from what I can tell there's no way to mix those two.</p>\n\n<p><strong>\"Fix\":</strong></p>\n\n<pre class=\"lang-rb prettyprint-override\"><code># app/controllers/api/api_controller.rb\n\n# We want to extend ActionController::API here\n# but it's messing up the asset paths\nclass Api::ApiController &lt; ActionController::Base\n  # include ActionView::Layouts\n  layout 'api'\n\n  ...\nend\n</code></pre>\n\n<p>Is there any way to fix the asset paths while extending <code>ApplicationController::API</code>?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-5", "yaml", "libyaml"], "comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1563230347, "post_id": 57047968, "comment_id": 100623137, "body": "Gems are often locked to the lowest version in a &quot;minor&quot; series, so all 2.5.x gems go into 2.5.0 and so on. This means when you update to 2.5.x+1 you don&#39;t need to reinstall everything."}], "answers": [{"comments": [{"owner": {"reputation": 135, "user_id": 9011983, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/71412d045963c1fdaa41d46073e6e17b?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel", "link": "https://stackoverflow.com/users/9011983/daniel"}, "edited": false, "score": 0, "creation_date": 1563287456, "post_id": 57053260, "comment_id": 100644885, "body": "The Gemfile and Gemfile.lock both refernce the Ruby build as 2.5.3p105, I wasn&#39;t able to find any reference to 2.5 or 2.5.0 unfortunately."}], "tags": [], "owner": {"reputation": 38092, "user_id": 18706, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/cabf735ce7b8b4471ef46ea54f71832d?s=128&d=identicon&r=PG", "display_name": "mahemoff", "link": "https://stackoverflow.com/users/18706/mahemoff"}, "is_accepted": false, "score": 0, "last_activity_date": 1563266255, "creation_date": 1563266255, "answer_id": 57053260, "question_id": 57047968, "link": "https://stackoverflow.com/questions/57047968/ruby-missing-psych-for-yaml-ouput/57053260#57053260", "title": "Ruby missing psych for YAML ouput", "body": "<p>It says the project is running 2.5.0 based on a directive like <code>ruby '~&gt; 2.5'</code> in the Gemfile. Try changing that to the actual version you're running, run <code>bundle</code> to setup Gemfile.lock again, and retry the command.</p>\n"}, {"tags": [], "owner": {"reputation": 135, "user_id": 9011983, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/71412d045963c1fdaa41d46073e6e17b?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel", "link": "https://stackoverflow.com/users/9011983/daniel"}, "is_accepted": true, "score": 0, "last_activity_date": 1563334694, "creation_date": 1563334694, "answer_id": 57068191, "question_id": 57047968, "link": "https://stackoverflow.com/questions/57047968/ruby-missing-psych-for-yaml-ouput/57068191#57068191", "title": "Ruby missing psych for YAML ouput", "body": "<p>I had Ruby 2.5.1 installed from \u2018sudo apt install Ruby\u2019 and 2.5.3 installed from RVM.  I wiped all installed Rubies and RVM, reinstalled 2.5.3 via RVM on the root directory and was good to go.</p>\n"}], "owner": {"reputation": 135, "user_id": 9011983, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/71412d045963c1fdaa41d46073e6e17b?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel", "link": "https://stackoverflow.com/users/9011983/daniel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 178, "favorite_count": 0, "accepted_answer_id": 57068191, "answer_count": 2, "score": 0, "last_activity_date": 1563334694, "creation_date": 1563230255, "question_id": 57047968, "link": "https://stackoverflow.com/questions/57047968/ruby-missing-psych-for-yaml-ouput", "title": "Ruby missing psych for YAML ouput", "body": "<p>I created a Rails/React app with Webpacker on my Mac running Ruby 2.5.3 and it runs without issue.  However when I clone it to my Ubuntu 18.04 machine, I get the below error :</p>\n\n<pre><code>/usr/lib/ruby/2.5.0/yaml.rb:5: warning: It seems your ruby installation is missing psych (for YAML output).\nTo eliminate this warning, please install libyaml and reinstall your ruby.\n</code></pre>\n\n<p>My Ubuntu machine is also running Ruby 2.5.3, so I'm confused why it references 2.5.0 in the error.</p>\n\n<p>I am able to launch the Rails server with <code>rails s</code>, but when I try to launch the full app with <code>foreman start -f Procfile.dev</code>, I get the error.  I've tried reinstalling libyaml and all the Ruby versions on my machine with RVM with no impact on the error.  I've also changed my local Ruby version to 2.5.0, and I get a different error message about how my machine is running Ruby 2.5.0 but the project is running 2.5.3.</p>\n\n<p>Procfile.dev file:</p>\n\n<pre><code>rails: bundle exec rails s\nwebpack: ./bin/webpack-dev-serer\n</code></pre>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 2, "creation_date": 1563228364, "post_id": 57047568, "comment_id": 100622729, "body": "Looks like you don&#39;t need to recalculate partial sum from scratch each time. Or do any of the shifts. What if you could somehow calculate each of the intermediate sums in constant time? \ud83e\udd14"}, {"owner": {"reputation": 3945, "user_id": 2325598, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/wbO59.jpg?s=128&g=1", "display_name": "Dan Rubio", "link": "https://stackoverflow.com/users/2325598/dan-rubio"}, "reply_to_user": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1563229386, "post_id": 57047568, "comment_id": 100622936, "body": "Thanks for that input. I appreciate it and see how it could be better."}], "answers": [{"comments": [{"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1563229304, "post_id": 57047832, "comment_id": 100622913, "body": "Indeed, this is what minimal modification of OPs code would look like (mine turned out similar). With a bit of polishing, this can be condensed into a nice and readable <code>inject</code> one-liner."}], "tags": [], "owner": {"reputation": 51, "user_id": 8742551, "user_type": "registered", "profile_image": "https://graph.facebook.com/10214454203734978/picture?type=large", "display_name": "Valery Zajkov", "link": "https://stackoverflow.com/users/8742551/valery-zajkov"}, "is_accepted": true, "score": 2, "last_activity_date": 1563229085, "creation_date": 1563229085, "answer_id": 57047832, "question_id": 57047568, "link": "https://stackoverflow.com/questions/57047568/execution-timed-out-12000-ms-how-can-i-optimize-this-simple-kata-to-run-faste/57047832#57047832", "title": "Execution Timed Out (12000 ms): How can I optimize this simple kata to run faster?", "body": "<p>The issue with the code is that you are performing an <code>inject</code> on every iteration of your loop, which is unnecessarily slow.</p>\n\n<p>You only need to sum the elements of the array once, outside of any loop. Once you have that sum, you can iterate through the elements of the array and perform a constant time subtraction from the current sum and push it into the <code>sums</code> array. </p>\n\n<pre><code>def part_sums(ls)\n  sum = ls.inject(:+)\n  sums = [sum]\n  ls.each do |val|\n    sum -= val\n    sums &lt;&lt; sum\n  end\n  sums\nend\n</code></pre>\n\n<p>There is also no need to shift, if you iterate through the array with the <code>each</code> iterator or keep a counter and use a <code>while</code> loop.</p>\n"}, {"comments": [{"owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "reply_to_user": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1563229519, "post_id": 57047868, "comment_id": 100622960, "body": "@SergioTulentsev go big or go home"}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1563229712, "post_id": 57047868, "comment_id": 100623002, "body": "Interesting. My first reaction was &quot;what? Isn&#39;t prepend super-inefficient?&quot; Guess they optimized insertion to the head really well. Your version is indeed the fastest so far."}, {"owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "reply_to_user": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1563229842, "post_id": 57047868, "comment_id": 100623030, "body": "@SergioTulentsev that was accidental, this is just how I conceptualized it, versus the subtraction-based approach of Valery which is nonetheless clever"}, {"owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "reply_to_user": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 1, "creation_date": 1563230211, "post_id": 57047868, "comment_id": 100623104, "body": "@SergioTulentsev I am actuallly seeing Valery&#39;s as faster anyway, with a higher input like 10_000_000 its clear"}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1563230818, "post_id": 57047868, "comment_id": 100623219, "body": "Indeed. Another surprise of the night: just how much overhead <code>reduce</code> adds. :/ <code>ls.reduce([ls.sum]) { |memo, elem| memo &lt;&lt; (memo.last - elem) }</code> is &quot;cleverer&quot;, but 1.5x slower."}], "tags": [], "owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "is_accepted": false, "score": 0, "last_activity_date": 1563229506, "last_edit_date": 1563229506, "creation_date": 1563229419, "answer_id": 57047868, "question_id": 57047568, "link": "https://stackoverflow.com/questions/57047568/execution-timed-out-12000-ms-how-can-i-optimize-this-simple-kata-to-run-faste/57047868#57047868", "title": "Execution Timed Out (12000 ms): How can I optimize this simple kata to run faster?", "body": "<p>This version of the function runs much faster:</p>\n\n<pre><code>def parts_sums_2(ls)\n sums = []\n last_sum = 0\n (ls.length - 1).downto(0).each do |i|\n   last_sum += ls[i]\n   sums.prepend last_sum\n end\n sums + [0]\nend\n</code></pre>\n\n<p>The key here is going <em>backwards</em> through the array - starting with the smallest sum (only the last element). Each subsequent step moves one index towards the beginning, and adds that value to the previous sum.</p>\n\n<p>Since the problem statement requires you to <em>shift</em> each step, your result must have the largest sums at the beginning, even though these are the last ones to be computed. This is why my code uses <em>prepend</em> rather than push. </p>\n\n<p>This is O(N) time complexity instead of O(N^2), which is an order of magnitude difference.</p>\n\n<p>With 100_000 inputs, your original function took 7.040443 seconds, while mine here took 0.000008 seconds</p>\n\n<p>Also in general you should try to avoid mutating the input to your methods (as you were doing with <em>shift</em>). </p>\n"}, {"tags": [], "owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "is_accepted": false, "score": 3, "last_activity_date": 1563232097, "last_edit_date": 1563232097, "creation_date": 1563231775, "answer_id": 57048112, "question_id": 57047568, "link": "https://stackoverflow.com/questions/57047568/execution-timed-out-12000-ms-how-can-i-optimize-this-simple-kata-to-run-faste/57048112#57048112", "title": "Execution Timed Out (12000 ms): How can I optimize this simple kata to run faster?", "body": "<pre><code>def parts_sums(ls)\n  ls.each_with_object([ls.sum]) { |n,arr| arr &lt;&lt; arr.last - n }\nend\n\nparts_sums([0, 1, 3, 6, 10])\n  #=&gt; [20, 20, 19, 16, 10, 0] \n</code></pre>\n"}], "owner": {"reputation": 3945, "user_id": 2325598, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/wbO59.jpg?s=128&g=1", "display_name": "Dan Rubio", "link": "https://stackoverflow.com/users/2325598/dan-rubio"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1488, "favorite_count": 0, "accepted_answer_id": 57047832, "answer_count": 3, "score": 1, "last_activity_date": 1563232097, "creation_date": 1563227154, "question_id": 57047568, "link": "https://stackoverflow.com/questions/57047568/execution-timed-out-12000-ms-how-can-i-optimize-this-simple-kata-to-run-faste", "title": "Execution Timed Out (12000 ms): How can I optimize this simple kata to run faster?", "body": "<p>I'm practicing my coding chops after a long break and ran into this kata on CodeWars</p>\n\n<p>With an input of numbers in an array, return the sums of its parts. So for example:</p>\n\n<pre><code>def parts_sums(ls)\n sums = []\n  until ls.size == 0\n    sums &lt;&lt; ls.inject(:+)\n    ls.shift\n  end\n  sums &lt;&lt; 0\nend\n\n######### INPUT #######\nparts_sums([0, 1, 3, 6, 10])\n\n######### EXPECTED OUTPUT ######\n[20, 20, 19, 16, 10, 0]\n\n0 + 1 + 3 + 6 + 10 = 20\n1 + 6 + 3 + 10 = 20\n3 + 6 + 10 = 19\n6 + 10 = 16\n10 = 10 \n0 = 0\n</code></pre>\n\n<p>My solution solves the kata, however once I reach arrays of around 30,000+ my solution takes too long to solve.</p>\n\n<p>So my question is to the community, how would I even attempt to make this go faster. I know that recursion is usually slow, and that for loops and its variants are usually sufficient to get the job done. What happens when that fails? What are some things to try to make my code above faster? </p>\n\n<p>I'm looking for some advice and some examples if anyone has any. Appreciate the input. Thanks.</p>\n"}, {"tags": ["ruby", "macos", "permissions", "homebrew"], "comments": [{"owner": {"reputation": 6462, "user_id": 3784008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/55ou4.jpg?s=128&g=1", "display_name": "anothermh", "link": "https://stackoverflow.com/users/3784008/anothermh"}, "edited": false, "score": 2, "creation_date": 1563246120, "post_id": 57047419, "comment_id": 100625999, "body": "Not sure how you&#39;re going to dig yourself out of the hole you&#39;re in now, but never use brew to install Ruby. Always use a Ruby manager like RVM, and <b>only</b> a Ruby manager like RVM. Should be as simple as <code>rvm install 2.1.10</code>, then <code>rvm use 2.1.10</code>, then <code>ruby -v</code>."}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1563254889, "post_id": 57047419, "comment_id": 100627762, "body": "Even robust package managers like those on Linux OS cannot deal with multiple versions of Ruby in an appropriate way. Use <a href=\"http://rvm.io/\" rel=\"nofollow noreferrer\">rvm</a> or <a href=\"https://github.com/rbenv/rbenv\" rel=\"nofollow noreferrer\">rbenv</a> or <a href=\"https://github.com/postmodern/chruby\" rel=\"nofollow noreferrer\">chruby</a>."}, {"owner": {"reputation": 445, "user_id": 2241384, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/137db4f33c57fcb3c134cc6427b316f2?s=128&d=identicon&r=PG", "display_name": "Halfacre", "link": "https://stackoverflow.com/users/2241384/halfacre"}, "reply_to_user": {"reputation": 6462, "user_id": 3784008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/55ou4.jpg?s=128&g=1", "display_name": "anothermh", "link": "https://stackoverflow.com/users/3784008/anothermh"}, "edited": false, "score": 0, "creation_date": 1563390677, "post_id": 57047419, "comment_id": 100688310, "body": "@anothermh Can I not uninstall all ruby and start again? What hole exactly am I in?"}, {"owner": {"reputation": 6462, "user_id": 3784008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/55ou4.jpg?s=128&g=1", "display_name": "anothermh", "link": "https://stackoverflow.com/users/3784008/anothermh"}, "edited": false, "score": 0, "creation_date": 1563391870, "post_id": 57047419, "comment_id": 100688824, "body": "The hole of having changed permissions across your filesystem &amp; installed Ruby via brew. If you can get everything undone and switch to RVM exclusively you should be fine."}, {"owner": {"reputation": 445, "user_id": 2241384, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/137db4f33c57fcb3c134cc6427b316f2?s=128&d=identicon&r=PG", "display_name": "Halfacre", "link": "https://stackoverflow.com/users/2241384/halfacre"}, "edited": false, "score": 0, "creation_date": 1563392432, "post_id": 57047419, "comment_id": 100689065, "body": "I ran the above commands because I found them here on SO \u2013 including using brew to install Ruby. Can you tell me where I changed permission across my file system?"}, {"owner": {"reputation": 445, "user_id": 2241384, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/137db4f33c57fcb3c134cc6427b316f2?s=128&d=identicon&r=PG", "display_name": "Halfacre", "link": "https://stackoverflow.com/users/2241384/halfacre"}, "edited": false, "score": 0, "creation_date": 1563393414, "post_id": 57047419, "comment_id": 100689516, "body": "Concerning this hole, I have system backups. Can I possibly just restore a certain directory or directories from a few days back in order to undo the damage? Or would I have to restore everything?"}], "owner": {"reputation": 445, "user_id": 2241384, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/137db4f33c57fcb3c134cc6427b316f2?s=128&d=identicon&r=PG", "display_name": "Halfacre", "link": "https://stackoverflow.com/users/2241384/halfacre"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 55, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1563226057, "creation_date": 1563226057, "question_id": 57047419, "link": "https://stackoverflow.com/questions/57047419/trouble-upgrading-ruby-on-mac-high-sierra", "title": "Trouble upgrading ruby on mac high sierra", "body": "<p>Trying to install Jekyll, I get a warning that I need Ruby 2.1. I am running 2.0.0. </p>\n\n<p>I run:\n <code>brew upgrade ruby</code></p>\n\n<p>Goes through the process a bit, then throws this error:</p>\n\n<p><code>Error: The following directories are not writable by your user:\n/usr/local/opt\n/usr/local/share/zsh\n/usr/local/share/zsh/site-functions</code></p>\n\n<p>So I run (as prompted):</p>\n\n<p><code>chmod u+w /usr/local/opt /usr/local/share/zsh /usr/local/share/zsh/site-functions</code></p>\n\n<p>then again run:</p>\n\n<p><code>brew upgrade ruby</code></p>\n\n<p>New error:</p>\n\n<p><code>Error: Permission denied @ unlink_internal - /usr/local/lib/ruby/2.0.0</code></p>\n\n<p>So I run:</p>\n\n<p><code>sudo chown -R $(whoami) /usr/local/lib/ruby/2.0.0</code></p>\n\n<p>Then run:</p>\n\n<p><code>brew upgrade ruby</code></p>\n\n<p>and get:</p>\n\n<p><code>Error: ruby 2.6.3 already installed</code></p>\n\n<p>Okay... so I run:</p>\n\n<p><code>ruby -v</code></p>\n\n<p>and get:</p>\n\n<p><code>ruby 2.0.0p247 (2013-06-27 revision 41674) [x86_64-darwin12.5.0]</code></p>\n\n<p>So Ruby 2.6.3 is installed, but I'm still running 2.0.0. So I run:</p>\n\n<p><code>which -a ruby</code></p>\n\n<p>and get:</p>\n\n<p><code>/Users/me/.rvm/rubies/ruby-2.0.0-p247/bin/ruby\n/Users/me/.rvm/bin/ruby\n/usr/bin/ruby</code></p>\n\n<p>No sign of 2.6.3.</p>\n\n<p>I'm out of my element here. Can anyone help me out?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "sorbet"], "comments": [{"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1563222280, "post_id": 57046641, "comment_id": 100620830, "body": "The ruby class is <code>DateTime</code> with an upper case <code>T</code> not sure if this is supported but it will avoid what I can only assume is <code>UnInitialized Constant</code> errors right now"}, {"owner": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "edited": false, "score": 3, "creation_date": 1563225027, "post_id": 57046641, "comment_id": 100621805, "body": "Also <code>DateTime</code> is not an ISO8601 datetime. Its a class that encapsulates pretty much the whole concept of time. ISO8601 is just a set of standards for string representation of a timestamp. <code>DateTime</code> just happens to use ISO8601 when you call <code>.to_s</code> on it. You should also consider the use of <code>ActiveSupport::TimeWithZone</code>."}, {"owner": {"reputation": 6462, "user_id": 3784008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/55ou4.jpg?s=128&g=1", "display_name": "anothermh", "link": "https://stackoverflow.com/users/3784008/anothermh"}, "edited": false, "score": 1, "creation_date": 1563245994, "post_id": 57046641, "comment_id": 100625977, "body": "Not an answer to your question but if you&#39;re truly new to Ruby then don&#39;t start out using Sorbet. Learn Ruby first, then look into the utility (or not) of Sorbet."}], "owner": {"reputation": 2070, "user_id": 3412674, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d828b5882e2d091c90cc5fe840c5aa2b?s=128&d=identicon&r=PG", "display_name": "JLF", "link": "https://stackoverflow.com/users/3412674/jlf"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 231, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1563221908, "creation_date": 1563221908, "question_id": 57046641, "link": "https://stackoverflow.com/questions/57046641/sorbet-ruby-set-type-signature-as-datetime-for-iso8601", "title": "Sorbet Ruby: Set type signature as &quot;datetime&quot; for ISO8601", "body": "<p>New to both ruby and sorbet \u2013 but excited.</p>\n\n<p>I can't tell if it's just not supported or if I'm reading the documentation incorrectly but I can't seem to find a type for Datetimes on Sorbet.org.</p>\n\n<p>I'm looking to check that <code>\"2019-07-15T16:15:13-04:00\"</code> is not only a string but an ISO8601 datetime.</p>\n\n<p>Something to this effect:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>  sig {params(location_id: String, starts_at: Datetime, ends_at: Datetime).returns(HTTParty::Response)}\n  def get_availability(location_id, starts_at, ends_at)\n    self.class.get(\"/availabilities/?location_id=#{location_id}&amp;starts_at=#{starts_at}&amp;ends_at=#{ends_at}\", {\n      headers: make_headers\n    })\n  end\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "edited": false, "score": 0, "creation_date": 1563219549, "post_id": 57045990, "comment_id": 100619870, "body": "This looks like you are doing something really strange with the primary key in your model. Please include the model."}, {"owner": {"reputation": 641, "user_id": 11750453, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Ukwo8wIwYxA/AAAAAAAAAAI/AAAAAAAAAIs/JAHcH6TWHBw/photo.jpg?sz=128", "display_name": "Trisma", "link": "https://stackoverflow.com/users/11750453/trisma"}, "reply_to_user": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "edited": false, "score": 0, "creation_date": 1563219686, "post_id": 57045990, "comment_id": 100619922, "body": "There is no primary key here, this is to link to tables together, I added the <code>Participant</code> table"}, {"owner": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "edited": false, "score": 1, "creation_date": 1563220183, "post_id": 57045990, "comment_id": 100620088, "body": "You need a primary key for ActiveRecord to actually work properly. You could possibly get around it with <code>Participant.where(conditions).delete_all</code> but this smacks of bad design."}, {"owner": {"reputation": 641, "user_id": 11750453, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Ukwo8wIwYxA/AAAAAAAAAAI/AAAAAAAAAIs/JAHcH6TWHBw/photo.jpg?sz=128", "display_name": "Trisma", "link": "https://stackoverflow.com/users/11750453/trisma"}, "reply_to_user": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "edited": false, "score": 0, "creation_date": 1563222631, "post_id": 57045990, "comment_id": 100620969, "body": "How can I do this then? There are a lot of cases where the database don&#39;t have id&#39;s."}, {"owner": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "edited": false, "score": 0, "creation_date": 1563231682, "post_id": 57045990, "comment_id": 100623366, "body": "&quot;How can I do this then?&quot; - I have already explained that you don&#39;t. Add primary keys to the tables you want to use for ActiveRecord models. It just does not work otherwise. You can have &quot;headless&quot; assocations with <code>has_and_belongs_to_many</code> (association with no model), but having a model without a PK is just stupid since there is no effective way to identify it, and AR does not support compound PKs."}, {"owner": {"reputation": 641, "user_id": 11750453, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Ukwo8wIwYxA/AAAAAAAAAAI/AAAAAAAAAIs/JAHcH6TWHBw/photo.jpg?sz=128", "display_name": "Trisma", "link": "https://stackoverflow.com/users/11750453/trisma"}, "reply_to_user": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "edited": false, "score": 0, "creation_date": 1563265000, "post_id": 57045990, "comment_id": 100632054, "body": "Ok thanks, I&#39;ll do it like that. You can post this as an answer if you want it."}], "owner": {"reputation": 641, "user_id": 11750453, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Ukwo8wIwYxA/AAAAAAAAAAI/AAAAAAAAAIs/JAHcH6TWHBw/photo.jpg?sz=128", "display_name": "Trisma", "link": "https://stackoverflow.com/users/11750453/trisma"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 72, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1563219722, "creation_date": 1563218512, "last_edit_date": 1563219722, "question_id": 57045990, "link": "https://stackoverflow.com/questions/57045990/sqlexception-no-such-column-on-destroy", "title": "SQLException no such column on destroy", "body": "<p>So I'm getting an entry in my database like this :</p>\n\n<p><code>participant = Participant.where(id_request: params[:id_request], user_id: params[:user_id]).first</code></p>\n\n<p>This will get the actual <code>Participant</code> because I logged it underneath, this is what that logs : </p>\n\n<p><code>#&lt;Participant id_request: \"2\", user_id: \"titivermeesch@gmail.com\"&gt;</code></p>\n\n<p>So that is ok because it corresponds to the parameters that are giving from my frontend.</p>\n\n<p>Now the thing is, I'm doing this to destroy that : \n<code>participant.destroy</code></p>\n\n<p>Once this is executed I will get this error : </p>\n\n<pre><code>ActiveRecord::StatementInvalid (SQLite3::SQLException: no such column: participants.: DELETE FROM \"participants\" WHERE \"participants\".\"\" IS NULL):\n\napp/controllers/participants_controller.rb:35:in `destroy'\n</code></pre>\n\n<p>So why do I get this? <code>participant</code> isn't null and the parameters are not null too.</p>\n\n<p><code>Participant</code> tabel:</p>\n\n<pre><code>class Participant &lt; ApplicationRecord\n    validates :id_request, presence: true\n    validates :user_id, presence: true, uniqueness: {scope: :id_request}\nend\n</code></pre>\n\n<p>I'm using this to link <code>Request</code> and <code>User</code></p>\n"}, {"tags": ["ruby-on-rails", "ruby", "routes", "ruby-on-rails-5.2"], "comments": [{"owner": {"reputation": 364, "user_id": 5182994, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/T60S4.jpg?s=128&g=1", "display_name": "Stanislav Zaleski", "link": "https://stackoverflow.com/users/5182994/stanislav-zaleski"}, "edited": false, "score": 0, "creation_date": 1563230365, "post_id": 57045768, "comment_id": 100623144, "body": "It seems to work on my computer  <code>~&#47;projects&#47;sandbox&#47;rcomments$ cat config&#47;routes&#47;api&#47;v1&#47;base.rb  get &#39;&#47;foobar&#39;, to: &#39;users#index&#39; resources :bars</code>    <code>~&#47;projects&#47;sandbox&#47;rcomments$ rake routes [...] GET    &#47;api&#47;foobar(.:format) POST   &#47;api&#47;bars(.:format) GET    &#47;api&#47;bars&#47;new(.:format) GET    &#47;api&#47;bars&#47;:id&#47;edit(.:format) GET    &#47;api&#47;bars&#47;:id(.:format) [...]</code>  How did you declare your nested routes?"}, {"owner": {"reputation": 5036, "user_id": 1223595, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/770fb9d9d0c71f2c21de84c60653c230?s=128&d=identicon&r=PG", "display_name": "steventnorris", "link": "https://stackoverflow.com/users/1223595/steventnorris"}, "reply_to_user": {"reputation": 364, "user_id": 5182994, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/T60S4.jpg?s=128&g=1", "display_name": "Stanislav Zaleski", "link": "https://stackoverflow.com/users/5182994/stanislav-zaleski"}, "edited": false, "score": 0, "creation_date": 1563231499, "post_id": 57045768, "comment_id": 100623335, "body": "@sigmaray The routes file is above. The <code>draw :base</code> call is not returning under the <code>scope :api</code>. a call to <code>rails routes</code> shows those as root level routes, not <code>api&#47;...</code>."}, {"owner": {"reputation": 364, "user_id": 5182994, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/T60S4.jpg?s=128&g=1", "display_name": "Stanislav Zaleski", "link": "https://stackoverflow.com/users/5182994/stanislav-zaleski"}, "edited": false, "score": 0, "creation_date": 1563232417, "post_id": 57045768, "comment_id": 100623509, "body": "Could you please share the content of <code>config&#47;routes&#47;api&#47;v1&#47;base.rb</code>? Putting  <code>get &#39;&#47;foobar&#39;, to: &#39;users#index&#39;</code> <code>resources :bars</code> into this file worked for me, it generated routes in correct scope (/api/foobar, api/bars)"}, {"owner": {"reputation": 5036, "user_id": 1223595, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/770fb9d9d0c71f2c21de84c60653c230?s=128&d=identicon&r=PG", "display_name": "steventnorris", "link": "https://stackoverflow.com/users/1223595/steventnorris"}, "reply_to_user": {"reputation": 364, "user_id": 5182994, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/T60S4.jpg?s=128&g=1", "display_name": "Stanislav Zaleski", "link": "https://stackoverflow.com/users/5182994/stanislav-zaleski"}, "edited": false, "score": 0, "creation_date": 1563234251, "post_id": 57045768, "comment_id": 100623857, "body": "@sigmaray Added above. My actual is nested double deep, but neither api nor v1 seem to be prefixed to my routes or namespacing the controllers."}], "answers": [{"tags": [], "owner": {"reputation": 364, "user_id": 5182994, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/T60S4.jpg?s=128&g=1", "display_name": "Stanislav Zaleski", "link": "https://stackoverflow.com/users/5182994/stanislav-zaleski"}, "is_accepted": true, "score": 1, "last_activity_date": 1563236224, "creation_date": 1563236224, "answer_id": 57048573, "question_id": 57045768, "link": "https://stackoverflow.com/questions/57045768/nested-routes-files-rails/57048573#57048573", "title": "Nested Routes Files Rails", "body": "<p><code>Rails.application.routes.draw</code> was redundant</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code># config/routes.rb\nRails.application.routes.draw do\n  scope :api do\n    [\"v1\"].map { |version| draw :base, \"api/\" + version }\n  end\nend\n</code></pre>\n\n<pre class=\"lang-rb prettyprint-override\"><code># config/routes/api/v1/base.rb\nnamespace :v1 do\n  # Rails.application.routes.draw do\n    [:identity].map { |path| draw path, \"api/v1\"}\n  # end\nend\n</code></pre>\n\n<pre class=\"lang-rb prettyprint-override\"><code># config/routes/api/v1/identity.rb\n# Rails.application.routes.draw do\n  # Ensures proper namespace when fetching controllers, but does not add to path for routes\n  scope module: :identity do\n\n    namespace :users do\n      put '/', action: :update\n      patch '/', action: :update\n      get 'user_from_token', action: :update\n    end\n\n  end\n# end\n</code></pre>\n\n<pre><code>$ rake routes\n                   Prefix Verb  URI Pattern                                                                              Controller#Action\n                 v1_users PUT   /api/v1/users(.:format)                                                                  v1/identity/users#update\n                          PATCH /api/v1/users(.:format)                                                                  v1/identity/users#update\n v1_users_user_from_token GET   /api/v1/users/user_from_token(.:format)                                                  v1/identity/users#update\n       rails_service_blob GET   /rails/active_storage/blobs/:signed_id/*filename(.:format)                               active_storage/blobs#show\nrails_blob_representation GET   /rails/active_storage/representations/:signed_blob_id/:variation_key/*filename(.:format) active_storage/representations#show\n       rails_disk_service GET   /rails/active_storage/disk/:encoded_key/*filename(.:format)                              active_storage/disk#show\nupdate_rails_disk_service PUT   /rails/active_storage/disk/:encoded_token(.:format)                                      active_storage/disk#update\n     rails_direct_uploads POST  /rails/active_storage/direct_uploads(.:format)                                           active_storage/direct_uploads#create\n</code></pre>\n"}], "owner": {"reputation": 5036, "user_id": 1223595, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/770fb9d9d0c71f2c21de84c60653c230?s=128&d=identicon&r=PG", "display_name": "steventnorris", "link": "https://stackoverflow.com/users/1223595/steventnorris"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 96, "favorite_count": 0, "accepted_answer_id": 57048573, "answer_count": 1, "score": 1, "last_activity_date": 1563236224, "creation_date": 1563217469, "last_edit_date": 1563234185, "question_id": 57045768, "link": "https://stackoverflow.com/questions/57045768/nested-routes-files-rails", "title": "Nested Routes Files Rails", "body": "<p>I have crafted some nested routes files using the below in my config/initializers:</p>\n\n<pre><code>class ActionDispatch::Routing::Mapper\n  def draw(routes_name, sub_path=nil)\n    if sub_path.present?\n      instance_eval(File.read(Rails.root.join(\"config/routes/#{sub_path}/#{routes_name}.rb\")))\n    else\n      instance_eval(File.read(Rails.root.join(\"config/routes/#{routes_name}.rb\")))\n    end\n  end\nend\n</code></pre>\n\n<p>However, when used like this in the routes file:</p>\n\n<pre><code>Rails.application.routes.draw do\n  scope :api do\n    [\"v1\"].map { |version| draw :base, \"api/\" + version }\n  end\nend\n</code></pre>\n\n<p>The routes there do not appear nested as <code>api/users</code> etc. Not sure why the scope is getting ignored there.</p>\n\n<p>EDIT: More Detailed Example</p>\n\n<p>routes.rb</p>\n\n<pre><code>namespace :api, defaults: { format: :json } do\n    Rails.application.routes.draw do\n      [\"v1\"].map { |version| draw :base, \"api/\" + version }\n    end\nend\n</code></pre>\n\n<p>base.rb</p>\n\n<pre><code>  namespace :v1 do\n      Rails.application.routes.draw do\n        [:identity].map { |path| draw path, \"api/v1\"}\n      end\n  end\n</code></pre>\n\n<p>identity.rb</p>\n\n<pre><code>Rails.application.routes.draw do\n      # Ensures proper namespace when fetching controllers, but does not add to path for routes\n      scope module: :identity do\n\n        namespace :users do\n          put '/', action: :update\n          patch '/', action: :update\n          get 'user_from_token', action: :update\n        end\n\n      end\nend\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "httparty"], "comments": [{"owner": {"reputation": 126343, "user_id": 14660, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/e55e0ec3c00f834d78fbdddeaa36e308?s=128&d=identicon&r=PG", "display_name": "Schwern", "link": "https://stackoverflow.com/users/14660/schwern"}, "edited": false, "score": 0, "creation_date": 1563214884, "post_id": 57044951, "comment_id": 100618124, "body": "Arbitrarily altering the response body would be pretty weird. It&#39;s something else. Have you looked at the unparsed response body? Check they&#39;re sending the same request: same headers, URL, domain, and cookies."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1563217273, "post_id": 57044951, "comment_id": 100618970, "body": "What code generates that?"}, {"owner": {"reputation": 7224, "user_id": 448934, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TXtux.jpg?s=128&g=1", "display_name": "Pascal", "link": "https://stackoverflow.com/users/448934/pascal"}, "edited": false, "score": 0, "creation_date": 1563220773, "post_id": 57044951, "comment_id": 100620296, "body": "I&#39;d assume that the response is containing the same variables multiple times and the two libraries are parsing them differently?  Look at the raw response and also show the code how you build the request with HTTParty.   Also: why HTTParty? Just use raw net/http (which has a somewhat weird API but will reduce the number of gems which is always a good idea)"}, {"owner": {"reputation": 6462, "user_id": 3784008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/55ou4.jpg?s=128&g=1", "display_name": "anothermh", "link": "https://stackoverflow.com/users/3784008/anothermh"}, "edited": false, "score": 0, "creation_date": 1563245908, "post_id": 57044951, "comment_id": 100625958, "body": "I&#39;ve never heard of a Rubyist saying &quot;Why HTTParty? Just use raw net/http.&quot; HTTParty exists for a reason: we all use it, and only suckers use net/http directly."}, {"owner": {"reputation": 45, "user_id": 6788322, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9cd9721e0facff7146343046dc769f16?s=128&d=identicon&r=PG&f=1", "display_name": "Tom Hen", "link": "https://stackoverflow.com/users/6788322/tom-hen"}, "edited": false, "score": 0, "creation_date": 1563260469, "post_id": 57044951, "comment_id": 100629802, "body": "I checked raw response again: puts response.to_a, puts response.inspect, puts response.body. I coudn&#39;t find any difference. I think I&#39;ll give a try with Faraday and see if I get any difference.."}, {"owner": {"reputation": 16407, "user_id": 157752, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Qgx5T.jpg?s=128&g=1", "display_name": "Thilo", "link": "https://stackoverflow.com/users/157752/thilo"}, "edited": false, "score": 0, "creation_date": 1563271177, "post_id": 57044951, "comment_id": 100635321, "body": "You can use the <a href=\"https://github.com/trusche/httplog\" rel=\"nofollow noreferrer\">httplog</a> gem to take a look at the raw response as it comes over the wire, and compare it with the parsed response object HTTParty turns that into. Maybe that will give a clue. If you compare Postman with your own code, you can&#39;t be sure that the request is 100% identical, so the response might not be either."}], "owner": {"reputation": 45, "user_id": 6788322, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9cd9721e0facff7146343046dc769f16?s=128&d=identicon&r=PG&f=1", "display_name": "Tom Hen", "link": "https://stackoverflow.com/users/6788322/tom-hen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 56, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1563271223, "creation_date": 1563213508, "last_edit_date": 1563271223, "question_id": 57044951, "link": "https://stackoverflow.com/questions/57044951/is-httparty-clearing-a-variable-in-responses", "title": "Is HTTParty clearing a variable in responses", "body": "<p>I found a weird case using httparty, in one of the API I do receive expected JSON object expect one key which has an empty value. This key's name is PaymentToken. Wondering if this is some configuration to hide / clear value of variables with Token / Payment in the name?</p>\n\n<p>I was trying to reproduce the same issue on Postman, with exactly the same request and receiving the same structure of object with the same keys values + PaymentToken value is there.</p>\n\n<p>Postman:</p>\n\n<pre><code>{\n    \"ActionType\": \"RES\",\n    \"IsActive\": false,\n    \"BookingCode\": null,\n    \"PaymentToken\": \"/ON9lFhfw2VYR9BiIep/peByEOtPSmtI7t+vxbcHFtsJctezBgS3mwKcVxSNCzZqKHXi4qPh8pMPGRMJOU6+1ZhSQ=\",\n    \"Customer\": null,\n    \"Mode\": 0\n}\n</code></pre>\n\n<p>HTTParty:</p>\n\n<pre><code>{\n    \"ActionType\": \"RES\",\n    \"IsActive\": false,\n    \"BookingCode\": null,\n    \"PaymentToken\": \"\",\n    \"Customer\": null,\n    \"Mode\": 0\n}\n</code></pre>\n\n<p>Has anyone experienced the same issue?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "selenium", "rspec-rails", "google-chrome-headless"], "answers": [{"tags": [], "owner": {"reputation": 1667, "user_id": 6860421, "user_type": "registered", "profile_image": "https://graph.facebook.com/953309974791428/picture?type=large", "display_name": "Roman Alekseiev", "link": "https://stackoverflow.com/users/6860421/roman-alekseiev"}, "is_accepted": false, "score": 0, "last_activity_date": 1580805677, "creation_date": 1580805677, "answer_id": 60053525, "question_id": 57044376, "link": "https://stackoverflow.com/questions/57044376/how-to-disable-cookies-when-running-selenium-headless-chrome-in-rspec/60053525#60053525", "title": "How to disable cookies when running Selenium + Headless Chrome in RSpec", "body": "<p>It depends on your chromedriver version. In release <code>2.31</code> developers changed:</p>\n\n<pre><code>Feature request: change chromeOptions to goog:chromeOptions\n</code></pre>\n\n<p>So for now it would look like:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>  caps = Selenium::WebDriver::Remote::Capabilities.chrome(\n    'goog:chromeOptions' =&gt; {\n      'args' =&gt; [\n        '--lang=en',\n        '--no-default-browser-check',\n        '--start-maximized',\n        '--no-sandbox'\n      ],\n      'prefs' =&gt; { \n          \"profile.default_content_settings.cookies\" =&gt; 2 } \n        }\n      }\n    }\n  )\n</code></pre>\n\n<p>Give it a try!</p>\n"}], "owner": {"reputation": 21, "user_id": 9773266, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a2084c815c3145180870056e9aef3fec?s=128&d=identicon&r=PG&f=1", "display_name": "Nate Rubin", "link": "https://stackoverflow.com/users/9773266/nate-rubin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 371, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1580805677, "creation_date": 1563210637, "question_id": 57044376, "link": "https://stackoverflow.com/questions/57044376/how-to-disable-cookies-when-running-selenium-headless-chrome-in-rspec", "title": "How to disable cookies when running Selenium + Headless Chrome in RSpec", "body": "<p><strong>Background:</strong></p>\n\n<p>I'm currently writing tests for a Rails project using RSpec + Capybara. We're using Selenium + Headless Chrome to simulate browser interactions.</p>\n\n<p><strong>Problem:</strong></p>\n\n<p>I want to disable browser cookies for a test. We're currently instantiating the web driver this way in our <code>spec/spec_helper.rb</code></p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>\nchrome_capabilities = Selenium::WebDriver::Remote::Capabilities.chrome(\n  chromeOptions: {\n    w3c: false,\n    args: %w[headless no-sandbox window-size=1280,2000 no-proxy-server disable-gpu disable-dev-shm-usage],\n  },\n  loggingPrefs:{browser: 'ALL'},\n)\n\nCapybara.register_driver :headless_chrome do |app|\n  Capybara::Selenium::Driver.new(app, \n    browser: :chrome, \n    desired_capabilities: chrome_capabilities\n  )\nend\n</code></pre>\n\n<p>I've seen many <a href=\"https://stackoverflow.com/questions/18106588/how-to-disable-cookies-using-webdriver-for-chrome-and-firefox-java\">Java examples</a> that disable cookies by passing this setting when instantiating Headless Chrome: <code>\"profile.default_content_setting_values.cookies\" =&gt; 2</code></p>\n\n<p>However, I haven't been able to get to this to work.</p>\n\n<p>Does anyone know the correct way to instantiate the Headless Chrome instance so that cookies are disabled?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "rubygems"], "answers": [{"tags": [], "owner": {"reputation": 8371, "user_id": 1094339, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/Cibe3.png?s=128&g=1", "display_name": "Deekor", "link": "https://stackoverflow.com/users/1094339/deekor"}, "is_accepted": true, "score": 0, "last_activity_date": 1563218121, "creation_date": 1563218121, "answer_id": 57045915, "question_id": 57043873, "link": "https://stackoverflow.com/questions/57043873/import-a-gems-dependencys-stylesheet/57045915#57045915", "title": "Import a gem&#39;s dependency&#39;s stylesheet?", "body": "<p>Requiring the gem in my <code>Engine</code> class did the trick!</p>\n\n<pre><code>module SharedStyles\n  class Railtie &lt; ::Rails::Engine\n    require 'bootstrap-sass'\n  end\nend\n</code></pre>\n"}], "owner": {"reputation": 8371, "user_id": 1094339, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/Cibe3.png?s=128&g=1", "display_name": "Deekor", "link": "https://stackoverflow.com/users/1094339/deekor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 26, "favorite_count": 0, "accepted_answer_id": 57045915, "answer_count": 1, "score": 0, "last_activity_date": 1563218121, "creation_date": 1563208359, "question_id": 57043873, "link": "https://stackoverflow.com/questions/57043873/import-a-gems-dependencys-stylesheet", "title": "Import a gem&#39;s dependency&#39;s stylesheet?", "body": "<p>I'm building a shared stylesheet gem for our multiple applications. Our apps currently run on bootstrap 3 via the <code>bootstrap-sass</code> gem. </p>\n\n<p>I've created one <code>shared-styles.sass</code> file inside my gem that I then import into my application's <code>application.sass</code> file. This all works fine.</p>\n\n<p>Now I'm attempting to add <code>bootstrap-sass</code> gem to my share stylesheet gem's <code>Gemfile</code> and importing bootstrap into <code>application.sass</code> or <code>shared-styles.sass</code> (neither seems to work). This gives a <code>couldn't find file 'bootstrap'</code> inside my application.</p>\n\n<p>The goal here was to not have to install bootstrap on each application and have the version managed by the gem.</p>\n\n<p>Is there a way to share my gem's dependencies with my application?</p>\n"}, {"tags": ["ruby", "stripe-payments"], "comments": [{"owner": {"reputation": 3169, "user_id": 9769731, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8f45dd611cc4ebd5218b399c926da68b?s=128&d=identicon&r=PG&f=1", "display_name": "karllekko", "link": "https://stackoverflow.com/users/9769731/karllekko"}, "edited": false, "score": 1, "creation_date": 1563211603, "post_id": 57043337, "comment_id": 100616867, "body": "You should use this syntax to attach a PaymentMethod to a Customer : <a href=\"https://stripe.com/docs/api/payment_methods/attach?lang=ruby\" rel=\"nofollow noreferrer\">stripe.com/docs/api/payment_methods/attach?lang=ruby</a> . PaymentMethods are different from sources, they are <i>not</i> embedded in the customer object(you list them using <a href=\"https://stripe.com/docs/api/payment_methods/list?lang=ruby\" rel=\"nofollow noreferrer\">stripe.com/docs/api/payment_methods/list?lang=ruby</a> for example, not looking at <code>customer.sources</code>; and there is no <code>payment_method</code> field on a Customer, hence the second error you got) so you should generally use the attach endpoint explicitly."}, {"owner": {"reputation": 1012, "user_id": 10347572, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iottG.jpg?s=128&g=1", "display_name": "escanxr", "link": "https://stackoverflow.com/users/10347572/escanxr"}, "reply_to_user": {"reputation": 3169, "user_id": 9769731, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8f45dd611cc4ebd5218b399c926da68b?s=128&d=identicon&r=PG&f=1", "display_name": "karllekko", "link": "https://stackoverflow.com/users/9769731/karllekko"}, "edited": false, "score": 0, "creation_date": 1563262987, "post_id": 57043337, "comment_id": 100631000, "body": "Thank you @karllekko, I\u2019m now able to attach a customer to a PaymentMethod. Have a good day"}], "owner": {"reputation": 1012, "user_id": 10347572, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iottG.jpg?s=128&g=1", "display_name": "escanxr", "link": "https://stackoverflow.com/users/10347572/escanxr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 339, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1563206087, "creation_date": 1563206087, "question_id": 57043337, "link": "https://stackoverflow.com/questions/57043337/stripe-customer-undefined-method-payment-method", "title": "Stripe customer: undefined method `payment_method`", "body": "<p>I\u2019m working on the update of Stripe. We used the Stripe\u2019s charge object but it\u2019s not compatible with 3DSecure, so I migrate to the PaymentIntent API.</p>\n\n<p>The problem is that, when I create a Stripe customer, I want to attach the payment_method as its mentioned in the documentation: <a href=\"https://stripe.com/docs/api/customers/create#create_customer-payment_method\" rel=\"nofollow noreferrer\">https://stripe.com/docs/api/customers/create#create_customer-payment_method</a></p>\n\n<p>In my console, I\u2019m able to do:</p>\n\n<pre><code>customer = Stripe::Customer.create(email: user.email)\ncustomer.payment_method = 12345\ncustomer.payment_method\n=&gt; 12345\n</code></pre>\n\n<p>First strange behaviour:</p>\n\n<pre><code>customer = Stripe::Customer.create(email: user.email)\ncustomer.payment_method\n=&gt; NoMethodError (undefined method `payment_method' for #&lt;Stripe::Customer:0x00007fd894fda560&gt;)\n</code></pre>\n\n<p><code>customer.payment_method</code> raises a NoMethodError instead of nil if there\u2019s no value.</p>\n\n<p>Anyway. In the console, I\u2019m able to create a Stripe customer then attach a payment_method.</p>\n\n<p>But when I try from a service with this code:</p>\n\n<pre><code>  def self.update_source(customer, payment_method_id)\n    customer.payment_method = payment_method_id\n    customer.save\n  end\n</code></pre>\n\n<p>I get an error:</p>\n\n<pre><code>17:42:26 server.1 | (Status 400) (Request req_4aDqavkYeg5q3m) Received unknown parameter: payment_method_id excluded from capture: Not configured to send/capture in environment 'development'\n17:42:26 server.1 |\n17:42:26 server.1 | Stripe::InvalidRequestError (Received unknown parameter: payment_method_id):\n</code></pre>\n\n<p>I don\u2019t know why the code works in the console but not from my service. I use the latest version of Stripe gem\u2026</p>\n\n<p>Any idea?</p>\n"}, {"tags": ["regex", "ruby", "gsub"], "answers": [{"tags": [], "owner": {"reputation": 238, "user_id": 2440476, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SNFzq.jpg?s=128&g=1", "display_name": "Mishal Zaman", "link": "https://stackoverflow.com/users/2440476/mishal-zaman"}, "is_accepted": true, "score": 1, "last_activity_date": 1563214213, "last_edit_date": 1563214213, "creation_date": 1563206828, "answer_id": 57043523, "question_id": 57043222, "link": "https://stackoverflow.com/questions/57043222/how-to-substitute-integers-with-letters-in-ruby/57043523#57043523", "title": "How to substitute integers with letters in Ruby", "body": "<p>I am not sure what you are trying to do, but I believe you are trying to map an integer with a string? If so, you can use a hash:</p>\n\n<pre><code># straight_high Integer\n# returns String\ndef get_card(straight_high)\n  card_values = {\n    11 =&gt; 'J',\n    12 =&gt; 'Q',\n    13 =&gt; 'K',\n    14 =&gt; 'Ace',\n  }\n\n  card_values[straight_high]\nend\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 61, "user_id": 11646813, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-tJbY0L65rG0/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3re91dzE3Ww7ABTDRFesCX5eNbqihA/mo/photo.jpg?sz=128", "display_name": "L&#233;on Boutrand", "link": "https://stackoverflow.com/users/11646813/l%c3%a9on-boutrand"}, "is_accepted": false, "score": 2, "last_activity_date": 1563209825, "creation_date": 1563209825, "answer_id": 57044186, "question_id": 57043222, "link": "https://stackoverflow.com/questions/57043222/how-to-substitute-integers-with-letters-in-ruby/57044186#57044186", "title": "How to substitute integers with letters in Ruby", "body": "<p>Maybe you should use a case statement:</p>\n\n<pre><code>def get_card(number)\n  case number\n  when 2..10\n    return number.to_s\n  when 11\n   return 'J'\n  when 12\n   return 'Q'\n  when 13\n   return 'J'\n  when 14\n   return 'Ace'\n  end\nend\n</code></pre>\n"}], "owner": {"reputation": 61, "user_id": 11787324, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56b9713156ee1b4e98df7ba1d9ba9ade?s=128&d=identicon&r=PG&f=1", "display_name": "JeffD", "link": "https://stackoverflow.com/users/11787324/jeffd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 112, "favorite_count": 0, "accepted_answer_id": 57043523, "answer_count": 2, "score": 0, "last_activity_date": 1563214213, "creation_date": 1563205718, "last_edit_date": 1563206118, "question_id": 57043222, "link": "https://stackoverflow.com/questions/57043222/how-to-substitute-integers-with-letters-in-ruby", "title": "How to substitute integers with letters in Ruby", "body": "<p>I am new to Ruby and programming. I am working on a card game. I have a variable (<code>straightHigh</code>) currently filled with a number <code>n</code> representing a rank of a card. I want certain numbers (11-14) to be replaced with specific letters (11 => J, 12 => Q, 13 => K, 14 => A).</p>\n\n<p>I've tried <code>gsub</code> and <code>gsub!</code> with and without regular expressions. But regular expressions are very foreign to me.</p>\n\n<pre><code>if y == 5\n  straightHigh = n + 4\n\n  @straightHigh.to_s.gsub!(/[11-14]/, 11 =&gt; 'J', 12 =&gt; 'Q', 13 =&gt; 'k', 14 =&gt; 'A')\n  p straightHigh.to_s\n\nend\n</code></pre>\n\n<p>I've tried:</p>\n\n<pre><code>straightHigh.to_s.gsub!(/[11-14]/, 14 =&gt; 'Ace', 13 =&gt; K, 12 =&gt; Q, 11 =&gt; J)\n</code></pre>\n\n<p>which resulted in syntax errors.</p>\n\n<p>I've tried</p>\n\n<pre><code>straightHigh.to_s.gsub!(/[11-14]/, 'Ace')\n</code></pre>\n\n<p>this does not throw an error, but does not seem to alter the values either.</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 12440, "user_id": 308731, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/eQxFn.jpg?s=128&g=1", "display_name": "Eyeslandic", "link": "https://stackoverflow.com/users/308731/eyeslandic"}, "edited": false, "score": 1, "creation_date": 1563204214, "post_id": 57042644, "comment_id": 100613300, "body": "<a href=\"https://stackoverflow.com/questions/3823581/how-to-retrieve-all-translations-from-yml-files-in-rails-i18n\" title=\"how to retrieve all translations from yml files in rails i18n\">stackoverflow.com/questions/3823581/&hellip;</a>"}, {"owner": {"reputation": 950, "user_id": 1838621, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d7b4a2f6943e65c088b8bbf57ba94dc3?s=128&d=identicon&r=PG", "display_name": "Ashutosh Tiwari", "link": "https://stackoverflow.com/users/1838621/ashutosh-tiwari"}, "edited": false, "score": 0, "creation_date": 1563222859, "post_id": 57042644, "comment_id": 100621061, "body": "I18n.backend.send(:translations)[:en]  REF:  <a href=\"https://stackoverflow.com/questions/18282245/list-rails-i18n-strings-with-full-keys\" title=\"list rails i18n strings with full keys\">stackoverflow.com/questions/18282245/&hellip;</a>"}], "owner": {"reputation": 1770, "user_id": 2097966, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/oIqx1.jpg?s=128&g=1", "display_name": "andy4thehuynh", "link": "https://stackoverflow.com/users/2097966/andy4thehuynh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 90, "favorite_count": 0, "closed_date": 1563226667, "answer_count": 0, "score": 0, "last_activity_date": 1563204379, "creation_date": 1563203578, "last_edit_date": 1563204379, "question_id": 57042644, "link": "https://stackoverflow.com/questions/57042644/rails-i18n-how-to-get-all-keys-for-a-locale-file", "closed_reason": "Duplicate", "title": "Rails i18n how to get all keys for a locale file?", "body": "<p>I want to create translation overrides for customers in my app. I want a list of locale section's key to render for a form.</p>\n\n<p>In Rails I18n, how do I get all keys for a given locale file?</p>\n\n<pre><code>en:\n  foo:\n    bar:\n      some_term: \"a translation\"\n      some_other_term: \"another translation\" \n  baz:\n    bizz: \"hello\"\n</code></pre>\n\n<p>Results would look something like</p>\n\n<pre><code>[\n  \"foo[bar][some_term]\",\n  \"foo[bar][some_other_term]\",\n  \"baz[bizz]\"\n]\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "youtube-api", "youtube-data-api"], "comments": [{"owner": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "edited": false, "score": 0, "creation_date": 1563226821, "post_id": 57042505, "comment_id": 100622343, "body": "Are you sure that you need to manually encode it?"}], "answers": [{"tags": [], "owner": {"reputation": 2602, "user_id": 3477940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/20lqd.jpg?s=128&g=1", "display_name": "analog-nico", "link": "https://stackoverflow.com/users/3477940/analog-nico"}, "is_accepted": false, "score": 0, "last_activity_date": 1565915024, "creation_date": 1565915024, "answer_id": 57517627, "question_id": 57042505, "link": "https://stackoverflow.com/questions/57042505/what-encoding-technique-needs-to-be-used-on-keywords-containing-special-characte/57517627#57517627", "title": "What encoding technique needs to be used on keywords containing special characters to fetch YouTube videos", "body": "<p>Since it is a GET request to the endpoint documented here <a href=\"https://developers.google.com/youtube/v3/docs/search/list\" rel=\"nofollow noreferrer\">https://developers.google.com/youtube/v3/docs/search/list</a> and the search term is passed as the <code>q</code> query string, you only need to use standard query string encoding as for any url. Even works with emojis.</p>\n\n<p>Thus: <code>...?q=Color%26Co</code></p>\n"}], "owner": {"reputation": 27, "user_id": 10008201, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DtbLv.jpg?s=128&g=1", "display_name": "Suhas Shinde", "link": "https://stackoverflow.com/users/10008201/suhas-shinde"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 74, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1565915024, "creation_date": 1563203085, "question_id": 57042505, "link": "https://stackoverflow.com/questions/57042505/what-encoding-technique-needs-to-be-used-on-keywords-containing-special-characte", "title": "What encoding technique needs to be used on keywords containing special characters to fetch YouTube videos", "body": "<p>I'm trying to fetch YouTube videos for keyword 'Color&amp;Co' but I'm unable to get similar response through YouTube API as compared to manually searching same keyword on youtube.com.</p>\n\n<p>I have tried following encoding techniques to get response from YouTube API similar to manually searching on youtube.com:</p>\n\n<p>keyword = 'Color&amp;Co'</p>\n\n<ol>\n<li><p>URI.encode(keyword)</p></li>\n<li><p>CGI.escape(keyword)</p></li>\n<li><p>ERB::Util.url_encode(keyword)</p></li>\n<li><p>keyword.encode('iso-8859-1').encode('utf-8')</p></li>\n<li><p>keyword.encode('iso-8859-1').force_encoding('utf-8')</p></li>\n<li><p>keyword.force_encoding('iso-8859-1').encode('utf-8')</p></li>\n</ol>\n\n<p>I'm expecting YouTube API to return response similar to searching same keywords with special characters on youtube.com.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "amazon-s3", "aws-sdk"], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 5448657, "user_type": "registered", "profile_image": "https://graph.facebook.com/1651879398431467/picture?type=large", "display_name": "Sannithi Balaji", "link": "https://stackoverflow.com/users/5448657/sannithi-balaji"}, "edited": false, "score": 0, "creation_date": 1563227647, "post_id": 57047625, "comment_id": 100622556, "body": "note the object should be public in order to download."}], "tags": [], "owner": {"reputation": 21, "user_id": 5448657, "user_type": "registered", "profile_image": "https://graph.facebook.com/1651879398431467/picture?type=large", "display_name": "Sannithi Balaji", "link": "https://stackoverflow.com/users/5448657/sannithi-balaji"}, "is_accepted": false, "score": 0, "last_activity_date": 1563227575, "creation_date": 1563227575, "answer_id": 57047625, "question_id": 57042285, "link": "https://stackoverflow.com/questions/57042285/how-to-get-file-url-using-awss3client-having-bucket-and-filename/57047625#57047625", "title": "How to get file URL using Aws::S3::Client having bucket and filename?", "body": "<p>url is:\nhttps://.s3-.amazonaws.com/</p>\n\n<p>example:\n<a href=\"https://testbucket.s3-us-east-1.amazonaws.com/sample_folder/image.jpeg\" rel=\"nofollow noreferrer\">https://testbucket.s3-us-east-1.amazonaws.com/sample_folder/image.jpeg</a></p>\n"}], "owner": {"reputation": 2315, "user_id": 1428109, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/VBHeU.jpg?s=128&g=1", "display_name": "deny7ko", "link": "https://stackoverflow.com/users/1428109/deny7ko"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 82, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1563227575, "creation_date": 1563202237, "last_edit_date": 1563218871, "question_id": 57042285, "link": "https://stackoverflow.com/questions/57042285/how-to-get-file-url-using-awss3client-having-bucket-and-filename", "title": "How to get file URL using Aws::S3::Client having bucket and filename?", "body": "<p>I have the following code to get the file data:</p>\n\n<pre><code>client = Aws::S3::Client.new(***settings***)\nclient.get_object(bucket: Settings.aws.data_migrations.s3_bucket, key: filename)\n</code></pre>\n\n<p>It returns <code>Aws::S3::Types::GetObjectOutput</code></p>\n\n<p>Is it possible to get file URL using the bucket and filename?</p>\n"}, {"tags": ["ruby", "cucumber", "bdd"], "answers": [{"comments": [{"owner": {"reputation": 3908, "user_id": 322863, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/cff6feb283b9f194892e8f6737eed875?s=128&d=identicon&r=PG", "display_name": "aef", "link": "https://stackoverflow.com/users/322863/aef"}, "edited": false, "score": 0, "creation_date": 1563213931, "post_id": 57044771, "comment_id": 100617773, "body": "As far as I know the whole point of World ist, that there is a new instance of it for each scenario, so the the steps in the scenario share a state."}, {"owner": {"reputation": 3257, "user_id": 4341733, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0b1793f226cb3189da8bc9c6264d72b7?s=128&d=identicon&r=PG", "display_name": "diabolist", "link": "https://stackoverflow.com/users/4341733/diabolist"}, "reply_to_user": {"reputation": 3908, "user_id": 322863, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/cff6feb283b9f194892e8f6737eed875?s=128&d=identicon&r=PG", "display_name": "aef", "link": "https://stackoverflow.com/users/322863/aef"}, "edited": false, "score": 0, "creation_date": 1563266944, "post_id": 57044771, "comment_id": 100633110, "body": "You are correct there is a separate world for each scenario. However once that instance is available World isn&#39;t, as self is World. You might be able to do what you want by extending self. See what self is in your hook."}], "tags": [], "owner": {"reputation": 3257, "user_id": 4341733, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0b1793f226cb3189da8bc9c6264d72b7?s=128&d=identicon&r=PG", "display_name": "diabolist", "link": "https://stackoverflow.com/users/4341733/diabolist"}, "is_accepted": false, "score": 0, "last_activity_date": 1563212620, "creation_date": 1563212620, "answer_id": 57044771, "question_id": 57041952, "link": "https://stackoverflow.com/questions/57041952/extending-world-from-inside-before-hook-in-cucumber-to-alter-helper-behavior-bas/57044771#57044771", "title": "Extending World from inside Before hook in Cucumber to alter helper behavior based on tag", "body": "<p>First of all what you are trying to do seems to me to be a really bad idea. Why do you want to do this?</p>\n\n<p>Technically perhaps World doesn't exist when Before is parsed, so you can't add to it. This is just a guess, you can explore this by debugging and pausing execution just before you try to add to World. Another possibility is that World isn't accessible from the scope inside before, that might be resolved by using <code>::World</code>.</p>\n\n<p>Another thing to bear in my mind is that World may not be recreated for each scenario. So what you are doing wouldn't actually work anyhow, as after one special scenario and one normal scenario have run, both modules would be in World with duplicate methods with different definitions.</p>\n"}], "owner": {"reputation": 3908, "user_id": 322863, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/cff6feb283b9f194892e8f6737eed875?s=128&d=identicon&r=PG", "display_name": "aef", "link": "https://stackoverflow.com/users/322863/aef"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 39, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1563212620, "creation_date": 1563201061, "question_id": 57041952, "link": "https://stackoverflow.com/questions/57041952/extending-world-from-inside-before-hook-in-cucumber-to-alter-helper-behavior-bas", "title": "Extending World from inside Before hook in Cucumber to alter helper behavior based on tag", "body": "<p>I am testing my Ruby 2.6.x project with Cucumber 3.1.2.</p>\n\n<p>Now I would like to include different helper modules into World, depending on the tags of the scenario, like this:</p>\n\n<pre><code>module NormalHelper\n  def do_something\n    \"something\"\n  end\nend\n\nmodule SpecialHelper\n  def do_something\n    \"something different\"\n  end\nend\n\nBefore(\"~@special\") do\n  World(NormalHelper)\nend\n\nBefore(\"@special\") do\n  World(SpecialHelper)\nend\n</code></pre>\n\n<p>However, when I run <code>cucumber</code>, I am told</p>\n\n<pre><code>undefined method `World' for #&lt;Cucumber::Rails::World:0x\u2026&gt; (NoMethodError)\n</code></pre>\n\n<p>Outside of the <code>Before</code> hook, calling <code>World</code> works nicely.</p>\n\n<p>What am I doing wrong?</p>\n"}, {"tags": ["ruby", "ruby-on-rails-4", "openssl"], "comments": [{"owner": {"reputation": 21613, "user_id": 580346, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/ba17945a06aac247b06548d5afe341e8?s=128&d=identicon&r=PG", "display_name": "mrzasa", "link": "https://stackoverflow.com/users/580346/mrzasa"}, "edited": false, "score": 1, "creation_date": 1563200487, "post_id": 57041732, "comment_id": 100611154, "body": "It&#39;s a known bug: <a href=\"https://github.com/jruby/jruby-openssl/issues/137\" rel=\"nofollow noreferrer\">github.com/jruby/jruby-openssl/issues/137</a>"}, {"owner": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "edited": false, "score": 0, "creation_date": 1563200495, "post_id": 57041732, "comment_id": 100611161, "body": "does <code>uri.scheme == &#39;https&#39;</code> return true when you get this error?"}, {"owner": {"reputation": 2850, "user_id": 375265, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/d796e3ec853c86069d40b815571a3b54?s=128&d=identicon&r=PG", "display_name": "spyderman4g63", "link": "https://stackoverflow.com/users/375265/spyderman4g63"}, "edited": false, "score": 0, "creation_date": 1563215435, "post_id": 57041732, "comment_id": 100618292, "body": "Is this only a jruby bug? It seems to work for me in standard ruby."}], "owner": {"reputation": 2850, "user_id": 375265, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/d796e3ec853c86069d40b815571a3b54?s=128&d=identicon&r=PG", "display_name": "spyderman4g63", "link": "https://stackoverflow.com/users/375265/spyderman4g63"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 341, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1563200331, "creation_date": 1563200331, "question_id": 57041732, "link": "https://stackoverflow.com/questions/57041732/handshake-failure-in-ruby-when-using-opensslsslverify-none", "title": "Handshake_failure in Ruby when using OpenSSL::SSL::VERIFY_NONE", "body": "<p>I'm trying to ignore certs on an https request using net/https in ruby. </p>\n\n<p>I'm passing the  OpenSSL::SSL::VERIFY_NONE but it's still giving me a handshake error:</p>\n\n<pre><code>Net::HTTP.start(uri.host, uri.port,        \n     :use_ssl =&gt; uri.scheme == 'https',\n     :verify_mode =&gt; OpenSSL::SSL::VERIFY_NONE,\n     :ssl_version =&gt; :TLSv1_2) do |http|\n       request = Net::HTTP::Post.new uri\n       response = http.request request\n   end\n</code></pre>\n\n<p>The output:</p>\n\n<pre><code>Received fatal alert: handshake_failure\n</code></pre>\n\n<p>We're using the following:</p>\n\n<pre><code>ruby '2.3.3', :engine =&gt; 'jruby', :engine_version =&gt; '9.1.15.0'\ngem 'rails', '4.2.10'\n</code></pre>\n"}, {"tags": ["ruby", "palindrome"], "comments": [{"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 3, "creation_date": 1563200382, "post_id": 57041406, "comment_id": 100611083, "body": "The first value of <code>idx</code> is <code>0</code>, not <code>1</code>. You want <code>if  str[idx] != str[-1-idx]</code>."}, {"owner": {"reputation": 31, "user_id": 11786869, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-_dbncySKdGA/AAAAAAAAAAI/AAAAAAAAAl0/Mx7w-lRqAGM/photo.jpg?sz=128", "display_name": "nashsibanda", "link": "https://stackoverflow.com/users/11786869/nashsibanda"}, "reply_to_user": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1563249532, "post_id": 57041406, "comment_id": 100626599, "body": "@CarySwoveland That was it! Thanks!"}], "answers": [{"comments": [{"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1563209155, "post_id": 57042720, "comment_id": 100615805, "body": "&quot;and really shorter and simpler version&quot; - and significantly more wasteful. Requires O(N) memory. JFYI."}, {"owner": {"reputation": 31, "user_id": 11786869, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-_dbncySKdGA/AAAAAAAAAAI/AAAAAAAAAl0/Mx7w-lRqAGM/photo.jpg?sz=128", "display_name": "nashsibanda", "link": "https://stackoverflow.com/users/11786869/nashsibanda"}, "edited": false, "score": 0, "creation_date": 1563249499, "post_id": 57042720, "comment_id": 100626594, "body": "Thanks for the comment and suggestion. The exercise in question specifically prohibits using the reverse function, but adding downcase to the method is a great idea!"}], "tags": [], "owner": {"reputation": 153, "user_id": 10375027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9bc241d54cc334f8a3a0c7c083ace68c?s=128&d=identicon&r=PG&f=1", "display_name": "BBB", "link": "https://stackoverflow.com/users/10375027/bbb"}, "is_accepted": false, "score": 2, "last_activity_date": 1563203863, "creation_date": 1563203863, "answer_id": 57042720, "question_id": 57041406, "link": "https://stackoverflow.com/questions/57041406/why-does-the-string-xabcx-return-as-a-palindrome-in-my-method-ruby/57042720#57042720", "title": "Why does the string &#39;xabcx&#39; return as a palindrome in my method? (Ruby)", "body": "<p>As Cary Swoveland already pointed out your indexing is wrong. To make debugging easier for you the next time I would recommend printing out both the values of the indices your using as well as the actual value of the char you select from the strings for each iteration of the loop.</p>\n\n<p>As an alternative and really shorter and simpler version you could also use:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>def palindrome?(str)\n  str == str.reverse\nend\n</code></pre>\n\n<p>or - taking into account ignoring upper / lower case:</p>\n\n<pre><code>def palindrome?(str)\n  str.downcase == str.downcase.reverse\nend\n</code></pre>\n"}], "owner": {"reputation": 31, "user_id": 11786869, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-_dbncySKdGA/AAAAAAAAAAI/AAAAAAAAAl0/Mx7w-lRqAGM/photo.jpg?sz=128", "display_name": "nashsibanda", "link": "https://stackoverflow.com/users/11786869/nashsibanda"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 51, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1563203863, "creation_date": 1563199294, "question_id": 57041406, "link": "https://stackoverflow.com/questions/57041406/why-does-the-string-xabcx-return-as-a-palindrome-in-my-method-ruby", "title": "Why does the string &#39;xabcx&#39; return as a palindrome in my method? (Ruby)", "body": "<p>I'm going through some exercises on App Academy Open, and I've come across a test case that I can't quite figure out. I've written a method to detect if a given string is a palindrome or not, and it seems to work fine for all strings I've thrown at it - apart from 'xabcx'. Am I missing something?</p>\n\n<pre><code>def palindrome?(str)\n  (str.length / 2).times do |idx|\n    if str[idx - 1] != str[idx * -1]\n      return false\n    end\n  end\n  true\nend\n\np palindrome?(\"xabcx\")\n</code></pre>\n\n<p>I expect an output of <code>false</code>, but I get <code>true</code>. The method works as expected for every other word I've tried.</p>\n"}, {"tags": ["ruby", "module", "instance", "metaprogramming"], "comments": [{"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 1, "creation_date": 1563195965, "post_id": 57040169, "comment_id": 100608493, "body": "<code>class &lt;&lt; self</code> is a reference to the <code>Person</code>&#39;s singleton class (eigenclass). If you take a look at the inheritance pattern <code>Person.ancestors #=&gt; [Person, MainParams, Object,..]</code> but the singleton class does not include <code>MainParams</code> e.g. <code>Person.singleton_class.ancestors #=&gt; [#&lt;Class:Person&gt;, #&lt;Class:Object&gt;, #&lt;Class:BasicObject&gt;, ...]</code>"}, {"owner": {"reputation": 5060, "user_id": 10522579, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7GQ6a.jpg?s=128&g=1", "display_name": "ray", "link": "https://stackoverflow.com/users/10522579/ray"}, "edited": false, "score": 0, "creation_date": 1563198905, "post_id": 57040169, "comment_id": 100610255, "body": "I was going to answer but best explanation is already provided <a href=\"https://stackoverflow.com/a/16422167/10522579\">here</a>"}], "owner": {"reputation": 1, "user_id": 6405062, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bddda4108754ff7244c504f57738d3ab?s=128&d=identicon&r=PG&f=1", "display_name": "Sinah", "link": "https://stackoverflow.com/users/6405062/sinah"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 40, "favorite_count": 0, "closed_date": 1563201174, "answer_count": 0, "score": 0, "last_activity_date": 1563198985, "creation_date": 1563195143, "last_edit_date": 1563198985, "question_id": 57040169, "link": "https://stackoverflow.com/questions/57040169/what-different-between-define-method-like-self-method-name-and-class-classname", "closed_reason": "Duplicate", "title": "What different between define method like self.method_name and class Classname; class &lt;&lt; self; def method_name in ruby", "body": "<p>I cannot understand how ruby works in next case.</p>\n\n<p>I have next code:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>module MainParams\n CATEGORY = 'Animals'\nend\n\nclass Person\n  include MainParams\n\n  class &lt;&lt; self\n    def get_category\n      CATEGORY\n    end\n  end\nend\n</code></pre>\n\n<p>When I tried invoke <code>Person.get_category</code> I've received</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>uninitialized constant #&lt;Class:Person&gt;::CATEGORY (NameError)\n</code></pre>\n\n<p>But when I changed Person class:</p>\n\n<pre><code>class Person\n  include MainParams\n\n  def self.get_category\n    CATEGORY\n  end\nend\n</code></pre>\n\n<p>And when I invoked </p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>Person.get_category\n</code></pre>\n\n<p>I received success result</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>\"Animals\"\n</code></pre>\n\n<p>Can you explain how it works? Earlier I thought that is the same way to define methods to class. Or give me link to documentation, where is explanation this case.</p>\n"}, {"tags": ["ruby", "jekyll", "liquid"], "answers": [{"tags": [], "owner": {"reputation": 63, "user_id": 11663715, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lVmjB.jpg?s=128&g=1", "display_name": "Yangwook Ian Jeong", "link": "https://stackoverflow.com/users/11663715/yangwook-ian-jeong"}, "is_accepted": true, "score": 0, "last_activity_date": 1563323774, "creation_date": 1563323774, "answer_id": 57067072, "question_id": 57040107, "link": "https://stackoverflow.com/questions/57040107/jekyll-running-jekyll-on-docker/57067072#57067072", "title": "Jekyll: Running jekyll on docker", "body": "<p>It was surprisingly easy to solve. The above liquid door was wrapped as shown below:</p>\n\n<pre><code>{% raw %}\n  {% include head.html %}\n{% endraw %}\n</code></pre>\n\n<p>Of course, you can wrap several liquid blocks like this:</p>\n\n<pre><code>{% raw %}\n  {% if %}\n    {% include head.html %}\n  {% endif %}\n{% endraw %}\n</code></pre>\n"}], "owner": {"reputation": 63, "user_id": 11663715, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lVmjB.jpg?s=128&g=1", "display_name": "Yangwook Ian Jeong", "link": "https://stackoverflow.com/users/11663715/yangwook-ian-jeong"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 79, "favorite_count": 0, "accepted_answer_id": 57067072, "answer_count": 1, "score": 0, "last_activity_date": 1563323774, "creation_date": 1563194915, "last_edit_date": 1563199444, "question_id": 57040107, "link": "https://stackoverflow.com/questions/57040107/jekyll-running-jekyll-on-docker", "title": "Jekyll: Running jekyll on docker", "body": "<p>I'm running a blog with jekyll. I tried using jekyll on the docker and I got the following error:</p>\n\n<pre><code>Error: A Liquid tag in the excerpt of _posts/2019-05-21-jekyll-caching.md couldn't be parsed.\nError: could not read file /srv/jekyll/_posts/2019-05-21-jekyll-caching.md: undefined method `ancestors' for nil:NilClass\n</code></pre>\n\n<p>In the error file, I wrote a little trick to make the liquid statement html. Below is the content of the blog:</p>\n\n<p>(...)\nliquid is a template language written by Shopify on top of html in <code>{{\" {% include head.html \"}}%}</code> format.</p>\n\n<p>It looks like an error using <code>{{\"{% include head.html\"}}%}</code>, but this error did not occur until jekyll was run on the docker. I searched on google and I could not find the cause of the error and asked stackoverflow. Note that the server runs fine though there is an error.</p>\n\n<p>Please let me know if there's more information you need to know to answer.</p>\n"}, {"tags": ["ruby", "rake"], "comments": [{"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 1, "creation_date": 1563193142, "post_id": 57039129, "comment_id": 100606923, "body": "Can you post an example on what you are trying to do? Why do you have to pass data around in the first place?"}, {"owner": {"reputation": 2181, "user_id": 5598574, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/aUJPQ.jpg?s=128&g=1", "display_name": "Hairi", "link": "https://stackoverflow.com/users/5598574/hairi"}, "reply_to_user": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1563193347, "post_id": 57039129, "comment_id": 100607054, "body": "I am trying to pass object of this type ( <a href=\"https://docs.ruby-lang.org/en/2.0.0/Net/HTTPResponse.html\" rel=\"nofollow noreferrer\">docs.ruby-lang.org/en/2.0.0/Net/HTTPResponse.html</a> ) from child to parent task. Each task is in different namespace."}, {"owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 0, "creation_date": 1563209368, "post_id": 57039129, "comment_id": 100615922, "body": "Way easier to write your task bodies as standalone classes, and then call the functions of those classes from the rake tasks."}], "owner": {"reputation": 2181, "user_id": 5598574, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/aUJPQ.jpg?s=128&g=1", "display_name": "Hairi", "link": "https://stackoverflow.com/users/5598574/hairi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 61, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1563194059, "creation_date": 1563191371, "last_edit_date": 1563194059, "question_id": 57039129, "link": "https://stackoverflow.com/questions/57039129/how-to-pass-data-between-task-in-ruby-rake", "title": "How to pass data between task in Ruby Rake?", "body": "<p>So how to pass data between task in Ruby Rake?\nBelieve me I read a lot bout this in the internet and none makes sense.</p>\n\n<p>I found the ENV['some_var'] approach, But I can't share objects without some conversions, unnecessary additional conversions that cost time to me and the processor :(. Additionally: \"Come on, is this the best that they made up?\"</p>\n\n<p>Somebody said use instance or class variables. It is hacky isn't it? I mean it is semantic fiasco. The modules in Ruby are places to put methods and constants- I read somewhere, which makes sense at some some extend, but class and instance variables in modules? Why classes then? </p>\n\n<p>So how can I share data between two rake tasks without doing some hacking? </p>\n\n<p>For example: How to pass the response object from task <code>get</code> to task <code>ping_server</code>:</p>\n\n<pre><code>require 'net/http'\nrequire 'uri'\n\n\nnamespace :http_request do\n    desc 'Request server to obtain status, and stores the data in the memcache specified by the environment'\n    # This task is made generic so it can serve as a low level routine for other tasks.\n    # Thus avoiding repetitive code.\n        task :get, [:url] =&gt; [:environment] do |t, args|\n            #configuration\n            WAIT_RESPONSE_TO_IN_SECONDS = 5\n            uri = URI.parse(args[:url])\n            http = Net::HTTP.new(uri.host, uri.port)\n\n            # We cannot wait for response forever, therefore provide timeout\n            http.open_timeout = WAIT_RESPONSE_TO_IN_SECONDS # in seconds\n\n            request = Net::HTTP::Get.new(uri.path)\n\n\n            # The response may take too long, or the URI may be bad(invalid)\n            begin\n                response = http.request(request)\n                puts response.code\n                ENV['req_response'] = {status: \"ok\", val: response.inspect}.to_s\n                # Rails.cache.write(args[:name], response.code)\n            rescue Exception =&gt; e\n                puts \"\\nRequest filed: #{e}\\n\"\n                ENV['req_response'] = {status: e.to_s, val: nil.to_s}.to_s\n            end\n        end\n\n      end\nnamespace :server_state do\n\n    desc \"write cache\"\n    task :ping_server, [:url] =&gt; \"http_request:get\" do\n        response = eval(ENV['req_response'])\n        puts \"\\n\\nRESULT = #{response}\"\n        puts \"\\n\\nRESULT = #{response[:val]}\"\n    end\n\nend\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "webpack", "time", "webpacker"], "answers": [{"comments": [{"owner": {"reputation": 163, "user_id": 10717993, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d5c8e32c70295e81ff828a9d446aee30?s=128&d=identicon&r=PG&f=1", "display_name": "OBrooks", "link": "https://stackoverflow.com/users/10717993/obrooks"}, "edited": false, "score": 0, "creation_date": 1563358380, "post_id": 57041513, "comment_id": 100670589, "body": "Hi, thank you for your answer ! Indeed, it was set to true. But even after the update, my app still need more than 30 sec to update (without React). Updated my question with the matter of &quot;allocations&quot; (Rails 6.0)"}], "tags": [], "owner": {"reputation": 1113, "user_id": 4701098, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4QnL4.jpg?s=128&g=1", "display_name": "Samy Kacimi", "link": "https://stackoverflow.com/users/4701098/samy-kacimi"}, "is_accepted": false, "score": 2, "last_activity_date": 1563199644, "creation_date": 1563199644, "answer_id": 57041513, "question_id": 57038000, "link": "https://stackoverflow.com/questions/57038000/insane-loading-time-after-adding-webpacker-to-rails-app/57041513#57041513", "title": "Insane loading time after adding Webpacker to Rails App", "body": "<p>Did you make sure that, in <code>config/webpacker.yml</code>, <code>compile</code> is set to <code>false</code> in dev?</p>\n\n<pre><code>development:\n  &lt;&lt;: *default\n  compile: false\n</code></pre>\n\n<p>Otherwise it will compile your assets on demand</p>\n"}], "owner": {"reputation": 163, "user_id": 10717993, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d5c8e32c70295e81ff828a9d446aee30?s=128&d=identicon&r=PG&f=1", "display_name": "OBrooks", "link": "https://stackoverflow.com/users/10717993/obrooks"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 172, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1563358788, "creation_date": 1563187165, "last_edit_date": 1563358788, "question_id": 57038000, "link": "https://stackoverflow.com/questions/57038000/insane-loading-time-after-adding-webpacker-to-rails-app", "title": "Insane loading time after adding Webpacker to Rails App", "body": "<p>I ran a Ruby on Rail's app, and everything was OK until I installed Webpacker.</p>\n\n<p>Now the loading time is between 180 000ms and 400 000ms, when I try to render any page. Removing the yield cause exacly the same problem.\nAs I'm using Turbolinks I have a fast loading time when navigating in my app.</p>\n\n<p>I use Ruby 2.6.3, Rails 6.0.0.rc1.</p>\n\n<p>I installed Webpack via webpacker 4.0.7 gem, and Yarn, and then installed React.</p>\n\n<p>I ran <code>./bin/webpack-dev-server</code>\nthen launched <code>rails server</code>\n.</p>\n\n<p>Unfortunately, I haven't any clue on what to do or search...\nThis questions is related to this : <a href=\"https://stackoverflow.com/questions/51295118/webpacker-after-installation-pages-in-the-application-began-to-load-for-a-very/57037203?noredirect=1#comment100603503_57037203\">webpacker: after installation pages in the application began to load for a very long time</a>, which has no answer</p>\n\n<hr>\n\n<p>EDIT</p>\n\n<hr>\n\n<p>I uninstalled all, deleted old package.json, and reinstalled only Webpack. My app now needs between 30 and 50 sec to load.\nI'm wondering, if it's normal that 7 556 736 allocations are loading, related to node_modules folder I guess ?\n<a href=\"https://i.stack.imgur.com/WHhKp.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/WHhKp.png\" alt=\"Print of my console\"></a></p>\n"}, {"tags": ["ruby-on-rails", "ruby", "google-chrome", "lsof"], "comments": [{"owner": {"reputation": 3881, "user_id": 799550, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/070aab749e66879e8ad53d186cc064b5?s=128&d=identicon&r=PG", "display_name": "songyy", "link": "https://stackoverflow.com/users/799550/songyy"}, "edited": false, "score": 0, "creation_date": 1563182237, "post_id": 57036238, "comment_id": 100601497, "body": "killing chrome won&#39;t help reloading Rails. You probably only need to restart rails."}, {"owner": {"reputation": 3881, "user_id": 799550, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/070aab749e66879e8ad53d186cc064b5?s=128&d=identicon&r=PG", "display_name": "songyy", "link": "https://stackoverflow.com/users/799550/songyy"}, "edited": false, "score": 0, "creation_date": 1563182285, "post_id": 57036238, "comment_id": 100601522, "body": "But you shouldn&#39;t even restart rails.. Rails hot-reloading would auto reload. How do u start your rails server? is it via <code>rails serve</code>?"}, {"owner": {"reputation": 5312, "user_id": 6535997, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/10156345016155058/picture?type=large", "display_name": "Mark", "link": "https://stackoverflow.com/users/6535997/mark"}, "edited": false, "score": 0, "creation_date": 1563184835, "post_id": 57036238, "comment_id": 100602758, "body": "Have you tried just refreshing the chrome browser and checking your serve logs for the puts you insert?"}, {"owner": {"reputation": 61, "user_id": 11646813, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-tJbY0L65rG0/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3re91dzE3Ww7ABTDRFesCX5eNbqihA/mo/photo.jpg?sz=128", "display_name": "L&#233;on Boutrand", "link": "https://stackoverflow.com/users/11646813/l%c3%a9on-boutrand"}, "reply_to_user": {"reputation": 3881, "user_id": 799550, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/070aab749e66879e8ad53d186cc064b5?s=128&d=identicon&r=PG", "display_name": "songyy", "link": "https://stackoverflow.com/users/799550/songyy"}, "edited": false, "score": 0, "creation_date": 1563188048, "post_id": 57036238, "comment_id": 100604355, "body": "@songyy I start it with rails s"}, {"owner": {"reputation": 61, "user_id": 11646813, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-tJbY0L65rG0/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3re91dzE3Ww7ABTDRFesCX5eNbqihA/mo/photo.jpg?sz=128", "display_name": "L&#233;on Boutrand", "link": "https://stackoverflow.com/users/11646813/l%c3%a9on-boutrand"}, "reply_to_user": {"reputation": 5312, "user_id": 6535997, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/10156345016155058/picture?type=large", "display_name": "Mark", "link": "https://stackoverflow.com/users/6535997/mark"}, "edited": false, "score": 0, "creation_date": 1563188096, "post_id": 57036238, "comment_id": 100604371, "body": "@Mark yes, it doesn&#39;t change anything..."}, {"owner": {"reputation": 1012, "user_id": 10347572, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iottG.jpg?s=128&g=1", "display_name": "escanxr", "link": "https://stackoverflow.com/users/10347572/escanxr"}, "edited": false, "score": 0, "creation_date": 1563194486, "post_id": 57036238, "comment_id": 100607662, "body": "Do you work on MacOS? I had some weird problems like yours on Mojave with another Macbook\u2026 they went away on their own, after I tried a lot of things without success"}], "owner": {"reputation": 61, "user_id": 11646813, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-tJbY0L65rG0/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3re91dzE3Ww7ABTDRFesCX5eNbqihA/mo/photo.jpg?sz=128", "display_name": "L&#233;on Boutrand", "link": "https://stackoverflow.com/users/11646813/l%c3%a9on-boutrand"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 59, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1563201724, "creation_date": 1563180648, "last_edit_date": 1563201724, "question_id": 57036238, "link": "https://stackoverflow.com/questions/57036238/im-forced-to-restart-rails-server-to-update-modifications-in-controller-because", "title": "I&#39;m forced to restart Rails Server to update modifications in controller because of Chrome", "body": "<p>Normaly, I don't need to restart rails s when I modify something in controller. But now it doesn't longer work. If I only want to add a \"puts\" line, I need to kill the server, kill Chrome then restart all, it makes me lose a lot of time.</p>\n\n<p>In fact, when I kill rails s and I launch <code>lsof -wni tcp:3000</code>\nI still get chrome as: </p>\n\n<pre><code>COMMAND  PID USER   FD   TYPE DEVICE SIZE/OFF NODE NAME\nchrome  2112 leon  250u  IPv6  84701      0t0  TCP [::1]:59116-&gt;[::1]:3000 (CLOSE_WAIT)\nchrome  2112 leon  275u  IPv6  80767      0t0  TCP [::1]:59080-&gt;[::1]:3000 (CLOSE_WAIT)\n</code></pre>\n"}, {"tags": ["javascript", "ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 18854, "user_id": 1083572, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/9xSFI.png?s=128&g=1", "display_name": "Kokodoko", "link": "https://stackoverflow.com/users/1083572/kokodoko"}, "edited": false, "score": 0, "creation_date": 1563178811, "post_id": 57035223, "comment_id": 100599916, "body": "Ruby happens on the server and javascript on the client. You need AJAX to communicate between them."}, {"owner": {"reputation": 114, "user_id": 2515743, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ib3BP.jpg?s=128&g=1", "display_name": "Ritesh katare", "link": "https://stackoverflow.com/users/2515743/ritesh-katare"}, "edited": false, "score": 0, "creation_date": 1563179166, "post_id": 57035223, "comment_id": 100600070, "body": "In append you passing a string, so use  &quot;phone&quot;+x+&quot;[...rest of string]&quot;."}], "answers": [{"tags": [], "owner": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "is_accepted": true, "score": 2, "last_activity_date": 1563179260, "creation_date": 1563179260, "answer_id": 57035920, "question_id": 57035223, "link": "https://stackoverflow.com/questions/57035223/how-to-use-jquery-variables-in-ruby/57035920#57035920", "title": "How to use jquery variables in ruby?", "body": "<p>Your expectations are completely wrong - Ruby (ERB) is executed on the server while this javascript is executed later on the client.</p>\n\n<p>There is no way that you can read a javascript variable on the fly in a javascript erb template. Its just an advanced version of string interpolation, which renders javascript just the same way as it does HTML. It does not actually execute the resulting code.</p>\n\n<p>A better alternative is just to use ERB to produce a template string and modify the elements with javascript.</p>\n\n<pre><code>var x = 1;\n$(add_button).click(function(e){ //on add input button click\n  var $template = $('&lt;div class=\"sampleclass\"&gt;&lt;%= f.label :phone\", class: \"control-label col-md-3\" %&gt;&lt;div class=\"col-md-8\"&gt;&lt;%= f.text_field :phone, class: \"form-control\" %&gt;&lt;a href=\"#\" class=\"remove_field\"&gt;Remove&lt;/a&gt;&lt;/div&gt;&lt;/div&gt;');\n  e.preventDefault();\n  if(x &lt; max_fields){ //max input box allowed\n    x++;\n    $template.find('label').text(\"phone \" + x);\n    $template.find('input').attr(name: \"phone_\" + x);\n    $(wrapper).append(template); //add input box\n  }\n});\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 5961654, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-ImmciBBtjlc/AAAAAAAAAAI/AAAAAAAAGrE/qnNYYzJ3b6A/photo.jpg?sz=128", "display_name": "Pratham Sharma", "link": "https://stackoverflow.com/users/5961654/pratham-sharma"}, "is_accepted": false, "score": 0, "last_activity_date": 1563214838, "creation_date": 1563214838, "answer_id": 57045237, "question_id": 57035223, "link": "https://stackoverflow.com/questions/57035223/how-to-use-jquery-variables-in-ruby/57045237#57045237", "title": "How to use jquery variables in ruby?", "body": "<p>You can not use rails tags inside the *.js file unless it is something like *.js.erb</p>\n\n<p>I can figure out what you are trying to accomplish here. You have to use the HTML to make the whole element on the go.</p>\n\n<p>You can use something like this.</p>\n\n<pre><code>    $(wrapper).append('&lt;div class=\"sampleclass\"&gt;&lt;label class=\"control-label col-md-3\"&gt; Phone'+ x +' &lt;/label&gt;&lt;div class=\"col-md-8\"&gt;&lt;input type=text name=\"phone'+ x +'\" class=\"form-control\"&gt;&lt;a href=\"#\" class=\"remove_field\"&gt;Remove&lt;/a&gt;&lt;/div&gt;&lt;/div&gt;');\n</code></pre>\n\n<p>Adding a sample of how it would look with your code.</p>\n\n<p><a href=\"https://i.stack.imgur.com/sVxca.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/sVxca.png\" alt=\"sample of code\"></a></p>\n"}], "owner": {"reputation": 34, "user_id": 10321356, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-HJGza_yaE-I/AAAAAAAAAAI/AAAAAAAAABY/LVOnzyTohQM/photo.jpg?sz=128", "display_name": "Akhil G Krishnan", "link": "https://stackoverflow.com/users/10321356/akhil-g-krishnan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 228, "favorite_count": 0, "accepted_answer_id": 57035920, "answer_count": 2, "score": 0, "last_activity_date": 1563214838, "creation_date": 1563176325, "question_id": 57035223, "link": "https://stackoverflow.com/questions/57035223/how-to-use-jquery-variables-in-ruby", "title": "How to use jquery variables in ruby?", "body": "<p>When I try to access a javascript variable in ruby it showing an undefined variable error.</p>\n\n<p>I tried to access the variable x in the ruby code \"phone#{x}\"</p>\n\n<p>var x = 1;</p>\n\n<pre><code>$(add_button).click(function(e){ //on add input button click\n  e.preventDefault();\n  if(x &lt; max_fields){ //max input box allowed\n\n    x++;\n\n    $(wrapper).append('&lt;div class=\"sampleclass\"&gt;&lt;%= f.label :\"phone#{x}\", class: \"control-label col-md-3\" %&gt;&lt;div class=\"col-md-8\"&gt;&lt;%= f.text_field :\"phone#{x}\", class: \"form-control\" %&gt;&lt;a href=\"#\" class=\"remove_field\"&gt;Remove&lt;/a&gt;&lt;/div&gt;&lt;/div&gt;'); //add input box\n  }\n});\n</code></pre>\n\n<p>I expect the output phone#{x} to phone2</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 9663, "user_id": 5239030, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/76JEw.png?s=128&g=1", "display_name": "iGian", "link": "https://stackoverflow.com/users/5239030/igian"}, "edited": false, "score": 1, "creation_date": 1563169135, "post_id": 57033583, "comment_id": 100596056, "body": "Check this out: <a href=\"https://stackoverflow.com/questions/7169277/ruby-variable-as-same-object-pointers\" title=\"ruby variable as same object pointers\">stackoverflow.com/questions/7169277/&hellip;</a>"}, {"owner": {"reputation": 7224, "user_id": 448934, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TXtux.jpg?s=128&g=1", "display_name": "Pascal", "link": "https://stackoverflow.com/users/448934/pascal"}, "edited": false, "score": 0, "creation_date": 1563171049, "post_id": 57033583, "comment_id": 100596582, "body": "the string is already interpreted and will not change after that. what is the exact use case?"}], "answers": [{"comments": [{"owner": {"reputation": 5060, "user_id": 10522579, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7GQ6a.jpg?s=128&g=1", "display_name": "ray", "link": "https://stackoverflow.com/users/10522579/ray"}, "edited": false, "score": 0, "creation_date": 1563175169, "post_id": 57034605, "comment_id": 100598210, "body": "I just provided reason, but you demonstrated! +1"}], "tags": [], "owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "is_accepted": true, "score": 4, "last_activity_date": 1563173783, "creation_date": 1563173783, "answer_id": 57034605, "question_id": 57033583, "link": "https://stackoverflow.com/questions/57033583/theres-some-way-to-reuse-string/57034605#57034605", "title": "There&#39;s some way to reuse string?", "body": "<p>Let's talk about naming conventions first. Uppercase identifiers are used for constants in Ruby. Per default assigning a new value to an already initialized constant raises a warning in Ruby:</p>\n\n<pre><code>A = 'B'\nA = 'C'\n#=&gt; warning: already initialized constant A\n#=&gt; warning: previous definition of A was here\n</code></pre>\n\n<p>Therefore I will use normal instance variables and reader methods in the following example. As Pascal Betz already pointed out: If you want <code>b</code> to depend on the current value of <code>a</code> then <code>b</code> should be a method:</p>\n\n<pre><code>def b\n  @a\nend\n\n@a = 'A'\nb\n#=&gt; \"A\"\n\n@a = 'C'\nb\n#=&gt; \"C\"\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 48049, "user_id": 6419007, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/CwqtX.jpg?s=128&g=1", "display_name": "Eric Duminil", "link": "https://stackoverflow.com/users/6419007/eric-duminil"}, "is_accepted": false, "score": 2, "last_activity_date": 1563190004, "creation_date": 1563190004, "answer_id": 57038729, "question_id": 57033583, "link": "https://stackoverflow.com/questions/57033583/theres-some-way-to-reuse-string/57038729#57038729", "title": "There&#39;s some way to reuse string?", "body": "<p>If you do this:</p>\n\n<pre><code>a = \"A\"\nb = \"#{a}\"\n</code></pre>\n\n<p><code>a</code> and <code>b</code> are strings with the same content, but they're not the same objects:</p>\n\n<pre><code>b == a\n# =&gt; true\nb.equal? a\n# =&gt; false\na.object_id\n# =&gt; 24494240\nb.object_id\n# =&gt; 24679880\n</code></pre>\n\n<p>Ruby strings are mutable. So if <code>b</code> and <code>a</code> refer to the same string, modifying <code>a</code> will automatically update <code>b</code> too:</p>\n\n<pre><code>a = \"A\"\n# =&gt; \"A\" \nb = a\n# =&gt; \"A\" \na.replace 'C'\n# =&gt; \"C\" \nb\n# =&gt; \"C\" \n</code></pre>\n\n<p>It works in both directions:</p>\n\n<pre><code>b.gsub!('C', 'D')\n# =&gt; \"D\" \na\n# =&gt; \"D\" \n</code></pre>\n"}], "owner": {"reputation": 25, "user_id": 7059586, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QUGKi.jpg?s=128&g=1", "display_name": "The Pug", "link": "https://stackoverflow.com/users/7059586/the-pug"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 73, "favorite_count": 0, "accepted_answer_id": 57034605, "answer_count": 2, "score": 1, "last_activity_date": 1563190004, "creation_date": 1563167793, "last_edit_date": 1563168431, "question_id": 57033583, "link": "https://stackoverflow.com/questions/57033583/theres-some-way-to-reuse-string", "title": "There&#39;s some way to reuse string?", "body": "<p>In case,</p>\n\n<pre><code>A = \"A\"\nB = \"#{A}\"\n</code></pre>\n\n<p>It's <code>B = \"A\"</code>, right?</p>\n\n<p>And now I would like to change (<code>A = \"C\"</code>) and want <code>B</code> to change by effect of <code>A</code> too.</p>\n\n<p>Is there some way to do that?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "sorbet"], "answers": [{"tags": [], "owner": {"reputation": 327, "user_id": 714058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/68b4ed657ecc33c96dd02730556fb41e?s=128&d=identicon&r=PG", "display_name": "hdoan", "link": "https://stackoverflow.com/users/714058/hdoan"}, "is_accepted": true, "score": 1, "last_activity_date": 1563163728, "creation_date": 1563163728, "answer_id": 57033161, "question_id": 57032717, "link": "https://stackoverflow.com/questions/57032717/using-union-types-with-flow-sensitivity/57033161#57033161", "title": "Using union types with flow sensitivity", "body": "<p>In the code posted, each <code>.args</code> call is treated like a new variable. If you capture the returning value in a local variable, the flow sensitivity will work. </p>\n\n<p>See an example on <a href=\"https://sorbet.run/ace/#extend%20T%3A%3ASig%0A%0Asig%20%7B%20returns(T.any(Hash%2C%20Array))%20%7D%0Adef%20get_args%0A%20%20return%20T.unsafe(nil)%0Aend%0A%0A%23%20doesnt%20work%0Aif%20get_args.is_a%3F(Hash)%0A%20%20get_args.to_hash%0Aend%0A%0A%23%20this%20works%0Aargs%20%3D%20get_args%0Aif%20args.is_a%3F(Hash)%0A%20%20args.to_hash%0Aend%0A%0A\" rel=\"nofollow noreferrer\">sorbet.run</a></p>\n"}], "owner": {"reputation": 37, "user_id": 8678276, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7749277831353da6c548be887745c0d6?s=128&d=identicon&r=PG&f=1", "display_name": "jek339", "link": "https://stackoverflow.com/users/8678276/jek339"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 59, "favorite_count": 0, "accepted_answer_id": 57033161, "answer_count": 1, "score": 0, "last_activity_date": 1563163728, "creation_date": 1563158696, "question_id": 57032717, "link": "https://stackoverflow.com/questions/57032717/using-union-types-with-flow-sensitivity", "title": "Using union types with flow sensitivity", "body": "<p>I'm trying to use union types with <code>is_a?</code> for flow control, but I'm still getting sorbet errors. I've tried casting as well, and I'm still running into the same error, which is:</p>\n\n<p><code>Method to_hash does not exist on T::Array[T.untyped] component of T.any(T::Array[T.untyped], T::Hash[Symbol, T.untyped]) https://srb.help/7003</code></p>\n\n<p>I have the following struct:</p>\n\n<pre><code>  class PostProcessingMethod &lt; T::Struct\n    prop :method_name, Symbol\n    prop :args, T.any(Array, T::Hash[Symbol, T.untyped]), default: []\n    prop :changed_fields, T::Array[String], default: []\n    prop :all, T::Boolean, default: false\n    prop :force, T::Boolean, default: false\n  end\n</code></pre>\n\n<p>and I'm using it in a method that (currently) looks like this:</p>\n\n<pre><code>    sig { params(post_processing_methods: T::Array[Documents::PostProcessingMethod]).void }\n    def call(post_processing_methods)\n      post_processing_methods.each do |post_processing_method|\n        next unless should_call_method?(post_processing_method)\n\n        if @object.respond_to?(post_processing_method.method_name)\n          if post_processing_method.args.is_a?(Array)\n            @object.send(post_processing_method.method_name, *post_processing_method.args)\n          elsif post_processing_method.args.is_a?(Hash)\n            @object.send(post_processing_method.method_name, **post_processing_method.args)\n          end\n        end\n      end\n    end\n</code></pre>\n\n<p>I've tried incorporating <code>T.cast</code> to ensure that sorbet knows it's a Hash in the elsif, but that doesn't seem to have made a difference.</p>\n\n<p>My expectation is that <code>is_a?</code> should allow sorbet to know that <code>post_processing_method</code> is a <code>Hash</code> in the <code>elseif</code>. But if that's not the case, the <code>T.cast</code> should certainly handle this.</p>\n"}, {"tags": ["ruby", "csv", "byte-order-mark"], "comments": [{"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 1, "creation_date": 1563158190, "post_id": 57032550, "comment_id": 100594179, "body": "See @matt&#39;s answer <a href=\"https://stackoverflow.com/questions/20717902/parsing-a-csv-file-using-different-encodings-and-libraries\">here</a>."}], "answers": [{"comments": [{"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 1, "creation_date": 1563175387, "post_id": 57032681, "comment_id": 100598313, "body": "It\u2019s probably worth to mention that <code>b</code> there between <code>r</code> and <code>:bom</code> means <code>binary</code>."}], "tags": [], "owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "is_accepted": true, "score": 1, "last_activity_date": 1563158222, "creation_date": 1563158222, "answer_id": 57032681, "question_id": 57032550, "link": "https://stackoverflow.com/questions/57032550/what-does-rbbomutf-8-mean-in-csv-open-in-ruby/57032681#57032681", "title": "What does rb:bom|utf-8 mean in CSV.open in Ruby?", "body": "<p>When reading a text file in Ruby you need to specify the encoding or it will revert to the default, which might be wrong.</p>\n\n<p>If you're reading CSV files that are BOM encoded then you need to do it that way.</p>\n\n<p>Pure UTF-8 encoding can't deal with the BOM header so you need to read it and skip past that part before treating the data as UTF-8. That notation is how Ruby expresses that requirement.</p>\n"}, {"comments": [{"owner": {"reputation": 419, "user_id": 4352306, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Hh7mG.jpg?s=128&g=1", "display_name": "rellampec", "link": "https://stackoverflow.com/users/4352306/rellampec"}, "edited": false, "score": 0, "creation_date": 1599749091, "post_id": 60794851, "comment_id": 112875947, "body": "could you please provide a reference? I could not find any official documentation explaining the above. I am unsure how it comes that reading as <code>binary</code> instead of <code>text</code> works in this case"}, {"owner": {"reputation": 106086, "user_id": 15809, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/2ULwK.jpg?s=128&g=1", "display_name": "Mecki", "link": "https://stackoverflow.com/users/15809/mecki"}, "reply_to_user": {"reputation": 419, "user_id": 4352306, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Hh7mG.jpg?s=128&g=1", "display_name": "rellampec", "link": "https://stackoverflow.com/users/4352306/rellampec"}, "edited": false, "score": 1, "creation_date": 1599749614, "post_id": 60794851, "comment_id": 112876259, "body": "@rellampec It&#39;s all documented on the Ruby IO documentation page <a href=\"https://docs.ruby-lang.org/en/2.1.0/IO.html\" rel=\"nofollow noreferrer\">docs.ruby-lang.org/en/2.1.0/IO.html</a> Look for &quot;Open Mode&quot; and keep reading."}], "tags": [], "owner": {"reputation": 106086, "user_id": 15809, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/2ULwK.jpg?s=128&g=1", "display_name": "Mecki", "link": "https://stackoverflow.com/users/15809/mecki"}, "is_accepted": false, "score": 2, "last_activity_date": 1584837946, "creation_date": 1584837946, "answer_id": 60794851, "question_id": 57032550, "link": "https://stackoverflow.com/questions/57032550/what-does-rbbomutf-8-mean-in-csv-open-in-ruby/60794851#60794851", "title": "What does rb:bom|utf-8 mean in CSV.open in Ruby?", "body": "<p>(The accepted answer is not incorrect but incomplete)</p>\n\n<p><code>rb:bom|utf-8</code> converted to a human readable sentence means:</p>\n\n<p><em>Open the file for reading (<code>r</code>) in binary mode (<code>b</code>) and look for an Unicode BOM marker (<code>bom</code>) to detect the encoding or, in case no BOM marker is found, assume UTF-8 encoding (<code>utf-8</code>).</em></p>\n\n<p>A BOM marker can be used to detect if a file is UTF-8 or UTF-16 and in case it is UTF-16, whether that is little or big endian UTF-16. There is also a BOM marker for UTF-32, yet Ruby doesn't support UTF-32 as of today. A BOM marker is just a special reserved byte sequence in the Unicode standard that is only used for the purpose of detecting the encoding of a file and it must be the first \"character\" of that file. It's recommended and typically used for UTF-16 as it exists in two different variants, it's optional for UTF-8 and usually if a file is Unicode but has no BOM marker, it is assumed to be UTF-8.</p>\n"}], "owner": {"reputation": 1331, "user_id": 6359753, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/73961b0d8661795d0b3f8300b633124c?s=128&d=identicon&r=PG&f=1", "display_name": "Henry Yang", "link": "https://stackoverflow.com/users/6359753/henry-yang"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 278, "favorite_count": 0, "accepted_answer_id": 57032681, "answer_count": 2, "score": 1, "last_activity_date": 1584837946, "creation_date": 1563156512, "last_edit_date": 1563162393, "question_id": 57032550, "link": "https://stackoverflow.com/questions/57032550/what-does-rbbomutf-8-mean-in-csv-open-in-ruby", "title": "What does rb:bom|utf-8 mean in CSV.open in Ruby?", "body": "<p>What does the <code>'rb:bom|utf-8'</code> mean in:</p>\n\n<p><code>CSV.open(csv_name, 'rb:bom|utf-8', headers: true, return_headers: true) do |csv|</code></p>\n\n<p>I can understand that:</p>\n\n<ol>\n<li><code>r</code> means read</li>\n<li><code>bom</code> is a file format with <code>\\xEF\\xBB\\xBF</code> at the start of a file to\nindicate endianness. </li>\n<li><code>utf-8</code> is a file format</li>\n</ol>\n\n<p>But:</p>\n\n<ol>\n<li>I don't know how they fits together and why is it necessary to write all these for reading a csv</li>\n<li>I'm struggling to find the documentation for\nthis. It doesn't seem to be documented in<br>\n<a href=\"https://ruby-doc.org/stdlib-2.6.1/libdoc/csv/rdoc/CSV.html\" rel=\"nofollow noreferrer\">https://ruby-doc.org/stdlib-2.6.1/libdoc/csv/rdoc/CSV.html</a></li>\n</ol>\n\n<p>Update:</p>\n\n<p>Found a very useful documentation:\n<a href=\"https://ruby-doc.org/core-2.6.3/IO.html#method-c-new-label-Open+Mode\" rel=\"nofollow noreferrer\">https://ruby-doc.org/core-2.6.3/IO.html#method-c-new-label-Open+Mode</a></p>\n"}, {"tags": ["ruby", "if-statement", "integer", "flow-control"], "comments": [{"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 1, "creation_date": 1563141660, "post_id": 57029369, "comment_id": 100591779, "body": "By &quot;...to ensure that the user enters only a number&quot;, I assume you mean, &quot;...to ensure that the user enters the string representation of an integer&quot;. Being as precise in your language as in your code will pay dividends."}], "answers": [{"comments": [{"owner": {"reputation": 57, "user_id": 11731014, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d8b3b5548fecb5bb795bf05e34e61bb2?s=128&d=identicon&r=PG&f=1", "display_name": "cwhitt91", "link": "https://stackoverflow.com/users/11731014/cwhitt91"}, "edited": false, "score": 0, "creation_date": 1563125277, "post_id": 57029512, "comment_id": 100588198, "body": "\u279c  RubyPractice ruby flow-control-practice.rb         Enter a number.         er         flow-control-practice.rb:5:in <code>&lt;main&gt;&#39;: undefined method </code>match?&#39; for 0:Integer          (NoMethodError)"}, {"owner": {"reputation": 57, "user_id": 11731014, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d8b3b5548fecb5bb795bf05e34e61bb2?s=128&d=identicon&r=PG&f=1", "display_name": "cwhitt91", "link": "https://stackoverflow.com/users/11731014/cwhitt91"}, "edited": false, "score": 0, "creation_date": 1563125302, "post_id": 57029512, "comment_id": 100588203, "body": "I just tried using &quot;unless&quot; in the way you have above, and that error was outputted on the terminal"}, {"owner": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "reply_to_user": {"reputation": 57, "user_id": 11731014, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d8b3b5548fecb5bb795bf05e34e61bb2?s=128&d=identicon&r=PG&f=1", "display_name": "cwhitt91", "link": "https://stackoverflow.com/users/11731014/cwhitt91"}, "edited": false, "score": 0, "creation_date": 1563125424, "post_id": 57029512, "comment_id": 100588227, "body": "Sorry, isn&#39;t because of the <code>unless</code> addition, it&#39;s because you&#39;re calling <code>to_i</code> on <code>variable</code>. Remove that part and try again, match? is a String method."}, {"owner": {"reputation": 57, "user_id": 11731014, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d8b3b5548fecb5bb795bf05e34e61bb2?s=128&d=identicon&r=PG&f=1", "display_name": "cwhitt91", "link": "https://stackoverflow.com/users/11731014/cwhitt91"}, "edited": false, "score": 0, "creation_date": 1563125841, "post_id": 57029512, "comment_id": 100588336, "body": "I think that worked. I had to reverse the logic on my flow control statment. Thank you!"}, {"owner": {"reputation": 57, "user_id": 11731014, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d8b3b5548fecb5bb795bf05e34e61bb2?s=128&d=identicon&r=PG&f=1", "display_name": "cwhitt91", "link": "https://stackoverflow.com/users/11731014/cwhitt91"}, "edited": false, "score": 0, "creation_date": 1563125857, "post_id": 57029512, "comment_id": 100588341, "body": "Can I ask what (/^-?\\d*$/) does?"}, {"owner": {"reputation": 57, "user_id": 11731014, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d8b3b5548fecb5bb795bf05e34e61bb2?s=128&d=identicon&r=PG&f=1", "display_name": "cwhitt91", "link": "https://stackoverflow.com/users/11731014/cwhitt91"}, "edited": false, "score": 0, "creation_date": 1563126147, "post_id": 57029512, "comment_id": 100588411, "body": "I assume that is just checking to see that the variable is a string method."}, {"owner": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "reply_to_user": {"reputation": 57, "user_id": 11731014, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d8b3b5548fecb5bb795bf05e34e61bb2?s=128&d=identicon&r=PG&f=1", "display_name": "cwhitt91", "link": "https://stackoverflow.com/users/11731014/cwhitt91"}, "edited": false, "score": 1, "creation_date": 1563128564, "post_id": 57029512, "comment_id": 100588954, "body": "That&#39;s a regular expression to check if the whole string is a number which may contain a dash at the beginning in case of being negative."}], "tags": [], "owner": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "is_accepted": true, "score": 1, "last_activity_date": 1563124625, "last_edit_date": 1563124625, "creation_date": 1563124211, "answer_id": 57029512, "question_id": 57029369, "link": "https://stackoverflow.com/questions/57029369/how-to-use-flow-control-to-request-the-user-inputs-an-integer-as-opposed-to-a-st/57029512#57029512", "title": "How to use flow control to request the user inputs an integer as opposed to a string", "body": "<p>The only way to compare Integer and get true is comparing Integer with Integer:</p>\n\n<pre><code>Integer == Integer\n# true\n</code></pre>\n\n<p>What you need in that case is to use <a href=\"https://ruby-doc.org/core-2.6.1/Object.html#method-i-is_a-3F\" rel=\"nofollow noreferrer\"><code>Object#is_a?</code></a> which <em>returns true if class is the class of obj, or if class is one of the superclasses of obj or modules included in obj</em>:</p>\n\n<pre><code>module M;    end\nclass A\n  include M\nend\nclass B &lt; A; end\nclass C &lt; B; end\n\nb = B.new\nb.is_a? A          #=&gt; true\nb.is_a? B          #=&gt; true\nb.is_a? C          #=&gt; false\nb.is_a? M          #=&gt; true\n</code></pre>\n\n<p>That allows you to check if the object is Integer \"based\", but, notice that you're redefining <code>variable</code> to its <code>to_i</code> version, which will return an Integer always.</p>\n\n<p>You could use <a href=\"https://ruby-doc.org/core-2.6.1/String.html#method-i-match-3F\" rel=\"nofollow noreferrer\"><code>String#match</code></a> to check if the value entered by the user matches a number (positive or negative Integer):</p>\n\n<pre><code>unless variable.match?(/^-?\\d*$/)\n  ...\nend\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 57, "user_id": 11731014, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d8b3b5548fecb5bb795bf05e34e61bb2?s=128&d=identicon&r=PG&f=1", "display_name": "cwhitt91", "link": "https://stackoverflow.com/users/11731014/cwhitt91"}, "edited": false, "score": 0, "creation_date": 1563139495, "post_id": 57030017, "comment_id": 100591366, "body": "Ah, ok. So I could just use"}, {"owner": {"reputation": 57, "user_id": 11731014, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d8b3b5548fecb5bb795bf05e34e61bb2?s=128&d=identicon&r=PG&f=1", "display_name": "cwhitt91", "link": "https://stackoverflow.com/users/11731014/cwhitt91"}, "edited": false, "score": 0, "creation_date": 1563139511, "post_id": 57030017, "comment_id": 100591370, "body": "if variable.is_integer? ?"}, {"owner": {"reputation": 759, "user_id": 9174431, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4a8f67982fb2ef93d0ebf92453b00fe5?s=128&d=identicon&r=PG", "display_name": "Giuseppe Schembri", "link": "https://stackoverflow.com/users/9174431/giuseppe-schembri"}, "reply_to_user": {"reputation": 57, "user_id": 11731014, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d8b3b5548fecb5bb795bf05e34e61bb2?s=128&d=identicon&r=PG&f=1", "display_name": "cwhitt91", "link": "https://stackoverflow.com/users/11731014/cwhitt91"}, "edited": false, "score": 0, "creation_date": 1563214508, "post_id": 57030017, "comment_id": 100617994, "body": "@cwhitt91 Yes, I edited the answer I hope should be clearer."}], "tags": [], "owner": {"reputation": 759, "user_id": 9174431, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4a8f67982fb2ef93d0ebf92453b00fe5?s=128&d=identicon&r=PG", "display_name": "Giuseppe Schembri", "link": "https://stackoverflow.com/users/9174431/giuseppe-schembri"}, "is_accepted": false, "score": 2, "last_activity_date": 1563214188, "last_edit_date": 1563214188, "creation_date": 1563128453, "answer_id": 57030017, "question_id": 57029369, "link": "https://stackoverflow.com/questions/57029369/how-to-use-flow-control-to-request-the-user-inputs-an-integer-as-opposed-to-a-st/57030017#57030017", "title": "How to use flow control to request the user inputs an integer as opposed to a string", "body": "<p>The problem are <code>!= and ==</code> methods.</p>\n\n<p>For a better way to check if a String can be converted to a valid Integer refer to:\n<a href=\"https://stackoverflow.com/questions/1235863/test-if-a-string-is-basically-an-integer-in-quotes-using-ruby\">Test if a string is basically an integer in quotes using Ruby?</a></p>\n\n<p>You'de better use an <code>if else statement</code>.</p>\n\n<p>If you add an is_integer? method to the String class as shown in the link above (but you do not have to is just a way) you can check like this:</p>\n\n<pre><code>var_string = gets.chomp\nif var_string.is_integer?\n  do_something\nelse\n  do_something_else\nend\n</code></pre>\n"}], "owner": {"reputation": 57, "user_id": 11731014, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d8b3b5548fecb5bb795bf05e34e61bb2?s=128&d=identicon&r=PG&f=1", "display_name": "cwhitt91", "link": "https://stackoverflow.com/users/11731014/cwhitt91"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 50, "favorite_count": 0, "accepted_answer_id": 57029512, "answer_count": 2, "score": 1, "last_activity_date": 1563214188, "creation_date": 1563123104, "last_edit_date": 1563145080, "question_id": 57029369, "link": "https://stackoverflow.com/questions/57029369/how-to-use-flow-control-to-request-the-user-inputs-an-integer-as-opposed-to-a-st", "title": "How to use flow control to request the user inputs an integer as opposed to a string", "body": "<p>My program asks a user for a number. I'm working with flow control to ensure that the user enters only a number, and if the user enters anything other than a number, the program prompts the user to \"Please enter a number\". Even when the user enters a number, the flow control statement asking the user to \"Please enter a number\" runs. </p>\n\n<p>I'm not getting any error messages, but one of my <code>if</code>/<code>else</code> statements must have inappropriate syntax. I've done research about what \"variable\" should be set to to achieve the desired output, but I must not have the appropriate boolean value. </p>\n\n<pre><code>puts \"Enter a number.\"\nvariable = gets.chomp\nvariable = variable.to_i\n\nif variable != Integer\n puts \"Please enter a number.\"\nelsif variable == Integer \n puts \"Thank you. Your number is #{variable}.\"\nend\n</code></pre>\n\n<p>Even when I actually enter a number in the terminal, I only get \"Please enter a number.\" I expect that when I enter a number, I will get \"<code>Thank you. Your number is #{variable}.</code>\"</p>\n"}, {"tags": ["ruby", "fiddle", "ruby-ffi"], "answers": [{"tags": [], "owner": {"reputation": 954, "user_id": 3259651, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/xrrkE.jpg?s=128&g=1", "display_name": "Rojj", "link": "https://stackoverflow.com/users/3259651/rojj"}, "is_accepted": false, "score": 0, "last_activity_date": 1563258007, "creation_date": 1563258007, "answer_id": 57051111, "question_id": 57029124, "link": "https://stackoverflow.com/questions/57029124/ruby-fiddle-reload-dynamic-library/57051111#57051111", "title": "Ruby Fiddle - Reload dynamic library", "body": "<p>Just in case someone needs this in the future. You can use</p>\n\n<pre><code>@handler.handlers.each {|h| h.close unless h.close_enabled? } unless @handler.nil?\nGC.start\n</code></pre>\n\n<p>So you first close all the handlers and then force the garbage collection.</p>\n"}], "owner": {"reputation": 954, "user_id": 3259651, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/xrrkE.jpg?s=128&g=1", "display_name": "Rojj", "link": "https://stackoverflow.com/users/3259651/rojj"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 65, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1563258007, "creation_date": 1563121190, "question_id": 57029124, "link": "https://stackoverflow.com/questions/57029124/ruby-fiddle-reload-dynamic-library", "title": "Ruby Fiddle - Reload dynamic library", "body": "<p>I am using <code>Fiddle</code> to load a function from a dynamic library written in C. During development I need to make changes to the library and reload it for testing. The problem is that <code>dlload</code> does not reload the library unless I relaunch the script. I am developing a plugin in Ruby for SketchUp so \"relaunching\" the script would actually mean to restart the application.</p>\n\n<p>Sample code to show the issue:</p>\n\n<pre><code>require 'fiddle'\nrequire 'fiddle/import'\nrequire 'fileutils'\n\nmodule RG\n  extend Fiddle::Importer  \n  dlload 'utils.dylib'\nend\n\nFileUtils.rm 'utils.dylib'\n\nmodule RG\n  extend Fiddle::Importer  \n  dlload 'utils.dylib'\nend\n</code></pre>\n\n<p>If you launch the script the first time there is no error. If you launch it the second time you get the error: <code>image not found</code>, as expected. </p>\n\n<p>So it seems that during the execution the library is imported only once.\nAny suggestion on how to force <code>Fiddle</code> to reload the library?</p>\n\n<p>I am using <code>macos</code> and <code>Ruby 2.0</code></p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 152277, "user_id": 438992, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/QouOz.jpg?s=128&g=1", "display_name": "Dave Newton", "link": "https://stackoverflow.com/users/438992/dave-newton"}, "edited": false, "score": 1, "creation_date": 1563114942, "post_id": 57028182, "comment_id": 100585769, "body": "That&#39;s called a regex."}, {"owner": {"reputation": 135, "user_id": 2354951, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/3bb88ecb05e50cebce7cc132f70d98df?s=128&d=identicon&r=PG", "display_name": "Michael", "link": "https://stackoverflow.com/users/2354951/michael"}, "reply_to_user": {"reputation": 152277, "user_id": 438992, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/QouOz.jpg?s=128&g=1", "display_name": "Dave Newton", "link": "https://stackoverflow.com/users/438992/dave-newton"}, "edited": false, "score": 0, "creation_date": 1563115423, "post_id": 57028182, "comment_id": 100585858, "body": "@DaveNewton, is there a way to use %{} syntax with regex?"}, {"owner": {"reputation": 152277, "user_id": 438992, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/QouOz.jpg?s=128&g=1", "display_name": "Dave Newton", "link": "https://stackoverflow.com/users/438992/dave-newton"}, "edited": false, "score": 0, "creation_date": 1563117459, "post_id": 57028182, "comment_id": 100586329, "body": "Not that I&#39;m aware of, although you can do named captures, and converting to a named-capture regex with (relatively simple) templating strings shouldn&#39;t be <i>too</i> hard... but likely not worth it. What&#39;s the ultimate problem you&#39;re trying to solve?"}, {"owner": {"reputation": 135, "user_id": 2354951, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/3bb88ecb05e50cebce7cc132f70d98df?s=128&d=identicon&r=PG", "display_name": "Michael", "link": "https://stackoverflow.com/users/2354951/michael"}, "reply_to_user": {"reputation": 152277, "user_id": 438992, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/QouOz.jpg?s=128&g=1", "display_name": "Dave Newton", "link": "https://stackoverflow.com/users/438992/dave-newton"}, "edited": false, "score": 0, "creation_date": 1563118042, "post_id": 57028182, "comment_id": 100586458, "body": "I parse an HTML and want to have some string in the config, which could be used both for searching it in the page and extract variable values from found strings. Something like <code>http:&#47;&#47;some.site&#47;event&#47;%{id}</code>. I can search for events on the page with <code>CONFIG[:event_link] % {id: &#39;&#39;}</code>, but don&#39;t know how to use it for extracting id of found events."}, {"owner": {"reputation": 152277, "user_id": 438992, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/QouOz.jpg?s=128&g=1", "display_name": "Dave Newton", "link": "https://stackoverflow.com/users/438992/dave-newton"}, "edited": false, "score": 2, "creation_date": 1563123204, "post_id": 57028182, "comment_id": 100587713, "body": "Are all the things you need to look for the same? Or are they arbitrary? There&#39;s no &quot;going back&quot; from most/all string templating systems that I&#39;m aware of, although some may provide an AST of the template, which would make it (somewhat) easier to automagically create the corresponding regex. IIRC there are also systems that&#39;ll let you provide sample input and create a &quot;parser&quot; out of it, but I don&#39;t know of any off the top of my head."}], "answers": [{"comments": [{"owner": {"reputation": 135, "user_id": 2354951, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/3bb88ecb05e50cebce7cc132f70d98df?s=128&d=identicon&r=PG", "display_name": "Michael", "link": "https://stackoverflow.com/users/2354951/michael"}, "edited": false, "score": 0, "creation_date": 1563205213, "post_id": 57028933, "comment_id": 100613954, "body": "Great thanks! It&#39;s not a &#171;common way&#187; I looked for, but it definitely does the job and may be very useful for similar situations."}, {"owner": {"reputation": 135, "user_id": 2354951, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/3bb88ecb05e50cebce7cc132f70d98df?s=128&d=identicon&r=PG", "display_name": "Michael", "link": "https://stackoverflow.com/users/2354951/michael"}, "edited": false, "score": 0, "creation_date": 1563206516, "post_id": 57028933, "comment_id": 100614601, "body": "One fix though: the last regex for converting a string to an integer should be this one: <code>&#47;\\A\\-?\\d+\\z&#47;</code>"}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "reply_to_user": {"reputation": 135, "user_id": 2354951, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/3bb88ecb05e50cebce7cc132f70d98df?s=128&d=identicon&r=PG", "display_name": "Michael", "link": "https://stackoverflow.com/users/2354951/michael"}, "edited": false, "score": 0, "creation_date": 1563212342, "post_id": 57028933, "comment_id": 100617170, "body": "Michael, the minus sign need only be escaped within a <i>character class</i> to avoid it being interpreted as denoting a range. For example, <code>&#39;-&#39;.match? &#47;[a-z]&#47;  #=&gt; false</code>, <code>&#39;-&#39;.match? &#47;[a\\-z]&#47; #=&gt; true</code>. Moreover, if a minus sign appears at the beginning or end of the character class it need not be escaped because it obviously would not denote a range: <code>&#39;-&#39;.match? &#47;[-ab]&#47; #=&gt; true</code>, <code>&#39;-&#39;.match? &#47;[ab-]&#47; #=true</code>."}, {"owner": {"reputation": 135, "user_id": 2354951, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/3bb88ecb05e50cebce7cc132f70d98df?s=128&d=identicon&r=PG", "display_name": "Michael", "link": "https://stackoverflow.com/users/2354951/michael"}, "edited": false, "score": 0, "creation_date": 1563293038, "post_id": 57028933, "comment_id": 100648181, "body": "Ok, thanks for explaining. But I added a backslash before <b>d</b>, not before <b>minus</b>. So, the right regexp should be <code>&#47;\\A-?\\d+\\z&#47;</code>, right?"}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "reply_to_user": {"reputation": 135, "user_id": 2354951, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/3bb88ecb05e50cebce7cc132f70d98df?s=128&d=identicon&r=PG", "display_name": "Michael", "link": "https://stackoverflow.com/users/2354951/michael"}, "edited": false, "score": 0, "creation_date": 1563294118, "post_id": 57028933, "comment_id": 100648666, "body": "That&#39;s correct. I don&#39;t know what happened to the backslash before <code>d</code>. It obviously was there when I executed the method. Thanks for the catch. Your second comment has a backslash before the minus sign as well, which is what caught my eye."}], "tags": [], "owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "is_accepted": false, "score": 2, "last_activity_date": 1563294003, "last_edit_date": 1563294003, "creation_date": 1563119571, "answer_id": 57028933, "question_id": 57028182, "link": "https://stackoverflow.com/questions/57028182/how-to-extract-values-from-string-with-its-formatted-mask-in-ruby/57028933#57028933", "title": "How to extract values from string with its formatted mask in Ruby", "body": "<pre><code>def doit(s1, s2)\n  a1 = s1.split \n  a2 = s2.split\n  a2.each_index.with_object({}) do |i,h|\n    word = a2[i][/(?&lt;=%\\{).+(?=\\})/]\n    h[word.to_sym] = a1[i] unless word.nil?\n  end.transform_values { |s| s.match?(/\\A\\-?\\d+\\z/) ? s.to_i : s }\nend\n</code></pre>\n\n<h1><p></p></h1>\n\n<pre><code>s1 = \"I have 5 apples\"\ns2 = \"I have %{amount} %{food}\"\ndoit(s1, s2)\n  #=&gt; {:amount=&gt;5, :food=&gt;\"apples\"} \n\ns1 = \"223 parcels were delivered last month\"\ns2 = \"%{number} parcels were %{action} last %{period}\"\ndoit(s1, s2)\n  #=&gt; {:number=&gt;223, :action=&gt;\"delivered\", :period=&gt;\"month\"}\n</code></pre>\n\n<p>The regular expression reads, \"match one or more characters (<code>.+</code>), immediately preceded by <code>\"%{\"</code> (<code>(?&lt;=%\\{)</code> being a <em>positive lookbehind</em>) and immediately followed by <code>\"}\"</code> (<code>(?=\\})</code> being a <em>positive lookahead</em>).</p>\n"}, {"tags": [], "owner": {"reputation": 48049, "user_id": 6419007, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/CwqtX.jpg?s=128&g=1", "display_name": "Eric Duminil", "link": "https://stackoverflow.com/users/6419007/eric-duminil"}, "is_accepted": false, "score": 0, "last_activity_date": 1563119741, "creation_date": 1563119741, "answer_id": 57028958, "question_id": 57028182, "link": "https://stackoverflow.com/questions/57028182/how-to-extract-values-from-string-with-its-formatted-mask-in-ruby/57028958#57028958", "title": "How to extract values from string with its formatted mask in Ruby", "body": "<p>If the substrings are separated with spaces, you could find the corresponding regex with <a href=\"https://ruby-doc.org/core-2.6.3/Regexp.html#method-i-named_captures\" rel=\"nofollow noreferrer\">named captures</a>:</p>\n\n<pre><code>text = \"I have 5 apples\"\n# \"I have %{amount} %{food}\"\nformat = /\\AI have (?&lt;amount&gt;\\S+) (?&lt;food&gt;\\S+)\\z/\n\np text.match(format).named_captures\n# {\"amount\"=&gt;\"5\", \"food\"=&gt;\"apples\"}\n</code></pre>\n\n<p>You didn't show any code, so I'll leave it as an exercise to transform the <code>\"I have %{amount} %{food}\"</code> string into the <code>/\\AI have (?&lt;amount&gt;\\S+) (?&lt;food&gt;\\S+)\\z/</code> regex.</p>\n"}], "owner": {"reputation": 135, "user_id": 2354951, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/3bb88ecb05e50cebce7cc132f70d98df?s=128&d=identicon&r=PG", "display_name": "Michael", "link": "https://stackoverflow.com/users/2354951/michael"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 156, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1563294003, "creation_date": 1563113821, "question_id": 57028182, "link": "https://stackoverflow.com/questions/57028182/how-to-extract-values-from-string-with-its-formatted-mask-in-ruby", "title": "How to extract values from string with its formatted mask in Ruby", "body": "<p>We can do it in Ruby: <code>\"I have %{amount} %{food}\" % {amount: 5, food: 'apples'}</code> to get \"I have 5 apples\". Is there common way for the inverse transformation: using \"I have 5 apples\" and \"I have %{amount} %{food}\" to get <code>{amount: 5, food: 'apples'}</code>?</p>\n"}, {"tags": ["ruby-on-rails", "arrays", "ruby", "rubygems", "ruby-on-rails-5"], "comments": [{"owner": {"reputation": 498, "user_id": 10384879, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-5HTxyDEG1Qo/AAAAAAAAAAI/AAAAAAAAAeQ/9iMyCvOw2A4/photo.jpg?sz=128", "display_name": "giri dharan", "link": "https://stackoverflow.com/users/10384879/giri-dharan"}, "edited": false, "score": 0, "creation_date": 1563113451, "post_id": 57027830, "comment_id": 100585457, "body": "gcc&lt;&lt;all_countries(sortedarray)"}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1563115988, "post_id": 57027830, "comment_id": 100585998, "body": "The GCC countries at the beginning of your \u201cdesired output\u201d are not sorted, despite the fact that you said you want to sort <code>all_countries</code>. Please edit to either correct the desired output or better explain how you want <code>all_countries</code> to be sorted. This is a pure-Ruby question, so you should neither mention Rails nor have a Rails tag. When giving examples it\u2019s best for them to be complete (e.g., no \u2019...`), to allow readers to test their code."}, {"owner": {"reputation": 973, "user_id": 1659370, "user_type": "registered", "accept_rate": 32, "profile_image": "https://www.gravatar.com/avatar/6d120a0452ccef4756d5e1af5ae01383?s=128&d=identicon&r=PG", "display_name": "kashif", "link": "https://stackoverflow.com/users/1659370/kashif"}, "reply_to_user": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1563118939, "post_id": 57027830, "comment_id": 100586655, "body": "@CarySwoveland there is no need to have proper order for GCC countries (if we can its fine) but for NON-GCC countries, we need to keep in order."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1563121139, "post_id": 57027830, "comment_id": 100587212, "body": "I&#39;ve deleted my answer because I misunderstood your question. Your example is poor. <code>gcc</code> should contain just a few elements, say 3, and <code>all_countries</code> should contain perhaps 6-8 elements, <i>including</i> the elements of <code>gcc</code>. You need to state whether <code>all_countries</code> is already sorted, even though that seems to be the case from your example."}], "answers": [{"comments": [{"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 1, "creation_date": 1563121286, "post_id": 57028277, "comment_id": 100587250, "body": "If, as suggested by <code>all_countries</code> in the question, <code>.sort</code> may not be necessary. Note <a href=\"http://ruby-doc.org/core-2.5.1/Array.html#method-i-2D\" rel=\"nofollow noreferrer\">Array#-</a> states, &quot;The order is preserved from the original array.&quot;."}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "reply_to_user": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 1, "creation_date": 1563122691, "post_id": 57028277, "comment_id": 100587581, "body": "@CarySwoveland yes, probably. But with <code>sort</code> it surely works, no matter how the <code>all_countries</code> is sorted upfront."}], "tags": [], "owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "is_accepted": false, "score": 3, "last_activity_date": 1563114542, "creation_date": 1563114542, "answer_id": 57028277, "question_id": 57027830, "link": "https://stackoverflow.com/questions/57027830/rails-sort-array-based-on-an-other-array/57028277#57028277", "title": "Rails: Sort Array based on an other array", "body": "<pre><code>gcc + (all_countries - gcc).sort\n</code></pre>\n"}], "owner": {"reputation": 973, "user_id": 1659370, "user_type": "registered", "accept_rate": 32, "profile_image": "https://www.gravatar.com/avatar/6d120a0452ccef4756d5e1af5ae01383?s=128&d=identicon&r=PG", "display_name": "kashif", "link": "https://stackoverflow.com/users/1659370/kashif"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 56, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1563118310, "creation_date": 1563110707, "last_edit_date": 1563118310, "question_id": 57027830, "link": "https://stackoverflow.com/questions/57027830/rails-sort-array-based-on-an-other-array", "title": "Rails: Sort Array based on an other array", "body": "<p>I want to Sort Array in <strong>Ruby on Rails</strong> based on an other Array but still wants to keep first Array values in the result :-</p>\n\n<pre><code>all_countries = [\"Afghanistan\", \"Aland Islands\", \"Albania\", \"Algeria\", \"American Samoa\", \"Andorra\", \"Angola\", \"Anguilla\", \"Antarctica\", \"Argentina\", \"Armenia\", \"Armenien\", \"Australia\", ....,]\n\n\ngcc = [\"UAE\", \"Saudi Arabia\", \"Qatar\", \"Bahrain\", \"Kuwait\", \"Oman\"] \n</code></pre>\n\n<p><strong>Desired OUTPUT</strong>:</p>\n\n<p>I want to sort all countries but want GCC countries (Without Sorting - any order) to appear first, remaining countries should appear in sorting (A-Z).</p>\n\n<pre><code>[\"UAE\", \"Saudi Arabia\", \"Qatar\", \"Bahrain\", \"Kuwait\", \"Oman\", \"Afghanistan\", \"Aland Islands\", \"Albania\", \"Algeria\", \"American Samoa\" .....]\n</code></pre>\n\n<p>I can do it in following way but it doesn't seem to be very good code and break alphabetical sorting for non-gcc countries. </p>\n\n<pre><code> countries.sort_by{|x| gcc.index(x) || gcc.size }\n</code></pre>\n\n<p><strong>Any better way to do it ?</strong></p>\n"}, {"tags": ["ruby", "linux", "permissions", "tmp"], "comments": [{"owner": {"reputation": 6462, "user_id": 3784008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/55ou4.jpg?s=128&g=1", "display_name": "anothermh", "link": "https://stackoverflow.com/users/3784008/anothermh"}, "edited": false, "score": 2, "creation_date": 1563062671, "post_id": 57023455, "comment_id": 100577319, "body": "Why not use <a href=\"https://ruby-doc.org/stdlib-2.4.0/libdoc/tempfile/rdoc/Tempfile.html\" rel=\"nofollow noreferrer\">ruby-doc.org/stdlib-2.4.0/libdoc/tempfile/rdoc/Tempfile.html</a> ?"}, {"owner": {"reputation": 82953, "user_id": 608639, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/aPIhh.jpg?s=128&g=1", "display_name": "jww", "link": "https://stackoverflow.com/users/608639/jww"}, "edited": false, "score": 0, "creation_date": 1563063216, "post_id": 57023455, "comment_id": 100577389, "body": "This question should be on-topic at Stack Overflow. The problem with it is, it is missing a <a href=\"http://stackoverflow.com/help/mcve\">Minimal, Complete, and Verifiable example</a>. <code>File#writable?(str)</code> is not enough information to assist you."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1563065613, "post_id": 57023455, "comment_id": 100577690, "body": "On many systems <code>&#47;tmp</code> is not a regular filesystem so you may not be able to use that directly."}, {"owner": {"reputation": 3820, "user_id": 10678955, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gRpbG.jpg?s=128&g=1", "display_name": "root", "link": "https://stackoverflow.com/users/10678955/root"}, "edited": false, "score": 0, "creation_date": 1563067113, "post_id": 57023455, "comment_id": 100577829, "body": "<code>&#47;tmp</code> is writeable on the popular Linux distributions. you can run <code>strace -o $HOME&#47;trace irb</code> and repeat the session, The output in <code>$HOME&#47;trace irb</code> will tell you what <code>irb</code> is asking the OS to do and what the OS replies. There could be ACL issues, or the filesystem could be mounted read-only. I suppose a &quot;proper&quot; way to implement <code>File#writable</code> is via the <code>access</code>(2) OS call - <code>strace</code>(1) should tell you if it does."}, {"owner": {"reputation": 82953, "user_id": 608639, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/aPIhh.jpg?s=128&g=1", "display_name": "jww", "link": "https://stackoverflow.com/users/608639/jww"}, "reply_to_user": {"reputation": 3820, "user_id": 10678955, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gRpbG.jpg?s=128&g=1", "display_name": "root", "link": "https://stackoverflow.com/users/10678955/root"}, "edited": false, "score": 0, "creation_date": 1563078428, "post_id": 57023455, "comment_id": 100579142, "body": "@root - Not always true. The majority of machines at the <a href=\"https://gcc.gnu.org/wiki/CompileFarm\" rel=\"nofollow noreferrer\">GCC Compile Farm</a> are Linux, but they do not have user writeable <code>&#47;tmp</code>. If you have an account on the farm your need to <code>export TMPDIR=&quot;$HOME&#47;tmp&quot;</code> if you plan on using a temp directory."}, {"owner": {"reputation": 100768, "user_id": 1899640, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/47374ccb28e4b0d2454b64f7b975bc66?s=128&d=identicon&r=PG", "display_name": "that other guy", "link": "https://stackoverflow.com/users/1899640/that-other-guy"}, "edited": false, "score": 0, "creation_date": 1563083246, "post_id": 57023455, "comment_id": 100579731, "body": "I am unable to reproduce this. This is what I tried (as non-root): <code>sudo mount -t tmpfs none &#47;mnt</code>, <code>echo foo &gt; &#47;mnt&#47;myfile</code>, <code>chmod 777 &#47;mnt&#47;myfile</code>, <code>sudo bash -c &#39;echo more &gt;&gt; &#47;mnt&#47;myfile&#39;</code>. According to your post I should get an error, but instead it exits with success and <code>cat &#47;mnt&#47;myfile</code> shows &quot;foo more&quot; as expected"}, {"owner": {"reputation": 1341, "user_id": 11089758, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XQ5gw.jpg?s=128&g=1", "display_name": "S.Goswami", "link": "https://stackoverflow.com/users/11089758/s-goswami"}, "reply_to_user": {"reputation": 3820, "user_id": 10678955, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gRpbG.jpg?s=128&g=1", "display_name": "root", "link": "https://stackoverflow.com/users/10678955/root"}, "edited": false, "score": 0, "creation_date": 1563084776, "post_id": 57023455, "comment_id": 100579934, "body": "@root, /tmp is writable. But you wrote a file called <code>a</code> as user x, as far as I saw, you can&#39;t write the file as user <code>y</code> even with 666 permissions... It&#39;s weird. My script needs root privilege in order to do some task. But well, I might at least check if the file exists already and if that is owned by root or not in Ruby..."}, {"owner": {"reputation": 1341, "user_id": 11089758, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XQ5gw.jpg?s=128&g=1", "display_name": "S.Goswami", "link": "https://stackoverflow.com/users/11089758/s-goswami"}, "edited": false, "score": 0, "creation_date": 1563085300, "post_id": 57023455, "comment_id": 100580005, "body": "Well, actually I have 2 other computers. This behaviour is seen on my laptop running arch x86_64. Just to make sure, I tried my raspberry pi running Arch Linux ARM. Steps: (1) Go to /tmp. (2) <code>touch file</code> (3) <code>chmod 777 file</code>. (4) <code>su</code> (5) <code>nano file</code>  And the same behaviour is seen on the Pi. If you see the permissions, it&#39;s 777 and anybody can read, write, and execute it. But if the file is on /tmp/ other users (even root) can&#39;t write to it.  I am running Kernel <code>5.2.0-arch2-1-ARCH</code> on laptop, and <code>4.19.57-1-ARCH</code> on the Raspberry Pi 3 model B."}, {"owner": {"reputation": 1341, "user_id": 11089758, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XQ5gw.jpg?s=128&g=1", "display_name": "S.Goswami", "link": "https://stackoverflow.com/users/11089758/s-goswami"}, "reply_to_user": {"reputation": 100768, "user_id": 1899640, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/47374ccb28e4b0d2454b64f7b975bc66?s=128&d=identicon&r=PG", "display_name": "that other guy", "link": "https://stackoverflow.com/users/1899640/that-other-guy"}, "edited": false, "score": 0, "creation_date": 1563085726, "post_id": 57023455, "comment_id": 100580067, "body": "@thatotherguy, yes, it&#39;s weird. If you type <code>echo &gt; file</code> yes it works. But nano, vi TUI editors and Geany, Mousepad, atom GUI editors can&#39;t write to it. Once you do <code>echo &gt; file</code> as root, you can&#39;t write it as regular user on those editors. Yes, ruby also fails to write the file. Only redirection works!"}, {"owner": {"reputation": 1341, "user_id": 11089758, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XQ5gw.jpg?s=128&g=1", "display_name": "S.Goswami", "link": "https://stackoverflow.com/users/11089758/s-goswami"}, "edited": false, "score": 0, "creation_date": 1563096539, "post_id": 57023455, "comment_id": 100581831, "body": "Hi, I have uploaded 2 screenshots at imgur: <a href=\"https://imgur.com/tB4T5Jl\" rel=\"nofollow noreferrer\">imgur.com/tB4T5Jl</a> <a href=\"https://imgur.com/hzc5s27\" rel=\"nofollow noreferrer\">imgur.com/hzc5s27</a>"}, {"owner": {"reputation": 3820, "user_id": 10678955, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gRpbG.jpg?s=128&g=1", "display_name": "root", "link": "https://stackoverflow.com/users/10678955/root"}, "edited": false, "score": 0, "creation_date": 1563098530, "post_id": 57023455, "comment_id": 100582224, "body": "(1) what distro are you using on your laptop? (2) what&#39;s the output of <code>test -w &#47;tmp&#47;ruby.rb; echo $?</code>? (3) what&#39;s the output of <code>su -c &#39;test -w &#47;tmp&#47;ruby.rb; echo $?&#39;</code>? (4) what&#39;s the output of <code>mount | grep &#47;tmp</code>? (5) what&#39;s the output of <code>getfacl &#47;tmp&#47;ruby.rb</code>? (6) what&#39;s the output of <code>ls -ld &#47;tmp</code>?"}, {"owner": {"reputation": 100768, "user_id": 1899640, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/47374ccb28e4b0d2454b64f7b975bc66?s=128&d=identicon&r=PG", "display_name": "that other guy", "link": "https://stackoverflow.com/users/1899640/that-other-guy"}, "edited": false, "score": 0, "creation_date": 1563130683, "post_id": 57023455, "comment_id": 100589475, "body": "I can reproduce this on ArchLinux but not on any other distro."}, {"owner": {"reputation": 1341, "user_id": 11089758, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XQ5gw.jpg?s=128&g=1", "display_name": "S.Goswami", "link": "https://stackoverflow.com/users/11089758/s-goswami"}, "edited": false, "score": 0, "creation_date": 1563130841, "post_id": 57023455, "comment_id": 100589519, "body": "Same. I have 3 systems running Arch Linux. So I thought this can be reproduced on an system. Actually then I told my friend (who uses Ubuntu) to do it. He told that everything goes as expected. Then I fired up my Linux Mint virtual machine, and my question was no more applicable. Pardon me. I didn&#39;t know that this could be only for Arch Linux. I don&#39;t know why. Let me post this on Arch Linux forum! Let&#39;s not worry about downvotes ;) ... Learnt something new as always ;)"}, {"owner": {"reputation": 1341, "user_id": 11089758, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XQ5gw.jpg?s=128&g=1", "display_name": "S.Goswami", "link": "https://stackoverflow.com/users/11089758/s-goswami"}, "edited": false, "score": 0, "creation_date": 1563131778, "post_id": 57023455, "comment_id": 100589732, "body": "Ok, here&#39;s something I found: <a href=\"https://bbs.archlinux.org/viewtopic.php?id=244482\" rel=\"nofollow noreferrer\">bbs.archlinux.org/viewtopic.php?id=244482</a>"}], "answers": [{"comments": [{"owner": {"reputation": 1341, "user_id": 11089758, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XQ5gw.jpg?s=128&g=1", "display_name": "S.Goswami", "link": "https://stackoverflow.com/users/11089758/s-goswami"}, "edited": false, "score": 0, "creation_date": 1563061037, "post_id": 57023531, "comment_id": 100577103, "body": "Nope, <code>File.open...</code> doesn&#39;t work. Well yes, I can require <code>fileutils</code> and add <code>FileUtils.chmod(0777, &#39;ruby.rb&#39;)</code> and still have the same problem. I also considered doing <code>0666</code> at first. You know the permission was set to <code>0644</code> at first which means it was writable! Anyways, doesn&#39;t work in any case! I have faced this issue only on the <code>&#47;tmp&#47;</code> directory..."}], "tags": [], "owner": {"reputation": 9, "user_id": 5811903, "user_type": "registered", "profile_image": "https://graph.facebook.com/10201664069680295/picture?type=large", "display_name": "nishant217", "link": "https://stackoverflow.com/users/5811903/nishant217"}, "is_accepted": false, "score": -1, "last_activity_date": 1563060724, "creation_date": 1563060724, "answer_id": 57023531, "question_id": 57023455, "link": "https://stackoverflow.com/questions/57023455/why-does-ruby-on-linux-return-true-to-file-writable-tmp-file-but-raises-err/57023531#57023531", "title": "Why does Ruby on Linux return true to File.writable?(&#39;/tmp/file&#39;) but raises Errno::EACCES while trying to write the file?", "body": "<p>Could be one of 2 things, file is not being opened for writing, or permissions issue with user.</p>\n\n<p>Try to open the file for writing with either <code>'w'</code> or <code>'w+'</code></p>\n\n<pre><code>File.open('ruby.rb', 'w') { |file| file.write(\"#!/usr/bin/ruby -w\") }\n</code></pre>\n\n<p>If that doesn't work, try using chmod to update file permissions for <code>ruby.rb</code> with </p>\n\n<pre><code>chmod -R 777 &lt;path_to_file&gt;\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1341, "user_id": 11089758, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XQ5gw.jpg?s=128&g=1", "display_name": "S.Goswami", "link": "https://stackoverflow.com/users/11089758/s-goswami"}, "is_accepted": true, "score": 1, "last_activity_date": 1563134617, "last_edit_date": 1563134617, "creation_date": 1563132230, "answer_id": 57030460, "question_id": 57023455, "link": "https://stackoverflow.com/questions/57023455/why-does-ruby-on-linux-return-true-to-file-writable-tmp-file-but-raises-err/57030460#57030460", "title": "Why does Ruby on Linux return true to File.writable?(&#39;/tmp/file&#39;) but raises Errno::EACCES while trying to write the file?", "body": "<p>Okay this is not a Ruby specific problem. That said, any programming language will have such problem because it's all about the file system protection implemented in systemd.</p>\n\n<p>The option <code>fs.protected_regular</code> is implemented in Linux Kernel 4.19+ <a href=\"https://github.com/systemd/systemd/blob/03b6fa0c5b51b0d39334ff6ba183a3391443bcf6/NEWS#L53\" rel=\"nofollow noreferrer\">to make data spoofing attacks harder</a>.</p>\n\n<p>So, firstly you need to check:</p>\n\n<pre><code>sysctl fs.protected_regular\n</code></pre>\n\n<p>In your case, it should print <code>1</code></p>\n\n<p>So, change the value to 0:</p>\n\n<pre><code>sysctl fs.protected_regular=0\n</code></pre>\n\n<p>Hopefully the problem will get solved. Or try this:</p>\n\n<pre><code>sysctl fs.protected_regular=0\nsysctl fs.protected_fifos=0\n</code></pre>\n\n<p>Note that the  option is enabled by default. You may not prefer telling every user of your program to set the above to 0! They may not even prefer that!</p>\n\n<p>So, in Ruby:</p>\n\n<ol>\n<li>You can delete the file:</li>\n</ol>\n\n<pre><code>File.delete('file') if File.exist?('file')\n# Better use the '/tmp/file' or File.join(%w(/ tmp file)) otherwise the file will get delete from the Dir.pwd\n</code></pre>\n\n<p>Which will delete the file every time the script runs.</p>\n\n<ol start=\"2\">\n<li>You can also use <code>begin ... rescue</code> block and use <code>Warning.warn</code> or <code>Kernel.warn</code> or <code>STDERR.puts</code> to print a warning message.</li>\n</ol>\n"}], "owner": {"reputation": 1341, "user_id": 11089758, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XQ5gw.jpg?s=128&g=1", "display_name": "S.Goswami", "link": "https://stackoverflow.com/users/11089758/s-goswami"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 181, "favorite_count": 0, "accepted_answer_id": 57030460, "answer_count": 2, "score": 0, "last_activity_date": 1563178082, "creation_date": 1563059721, "last_edit_date": 1563178082, "question_id": 57023455, "link": "https://stackoverflow.com/questions/57023455/why-does-ruby-on-linux-return-true-to-file-writable-tmp-file-but-raises-err", "title": "Why does Ruby on Linux return true to File.writable?(&#39;/tmp/file&#39;) but raises Errno::EACCES while trying to write the file?", "body": "<p>I am using a GNU/Linux system.</p>\n\n<p>Firstly, I have:</p>\n\n<ul>\n<li><p>Moved to the <code>/tmp/</code> directory.</p></li>\n<li><p>Created a file called <code>ruby.rb</code> as a non-root user.</p></li>\n<li><p>Opened <code>irb</code> as su user.</p></li>\n</ul>\n\n<p>Now in IRB:</p>\n\n<pre><code>\u250c\u2504\u2504[root::archlinux]\u2508[/tmp]\n\u2514\u2500\u2500\u257c\u2b9a irb\nirb(main):001:0&gt; File.writable?('ruby.rb')\n=&gt; true\nirb(main):002:0&gt; File.stat('ruby.rb')\n=&gt; #&lt;File::Stat dev=0x2d, ino=819138, mode=0100644, nlink=1, uid=1000, gid=1000, rdev=0x0, size=0, blksize=4096, blocks=0, atime=2019-07-14 04:44:13 +0530, mtime=2019-07-14 04:44:13 +0530, ctime=2019-07-14 04:44:13 +0530&gt;\nirb(main):003:0&gt; File.write('ruby.rb', '#!/usr/bin/ruby -w')\nTraceback (most recent call last):\n        3: from /root/.irb:351:in `&lt;main&gt;'\n        2: from (irb):3\n        1: from (irb):3:in `write'\nErrno::EACCES (Permission denied @ rb_sysopen - ruby.rb)\nirb(main):004:0&gt; \n</code></pre>\n\n<p>Apart from this, actually I am trying to do is writing a log file. I am checking if the file is writable. If not, it sends notification to the user.</p>\n\n<p>I have faced the problem previously where <code>File#writable?(str)</code> returned true in such case (and it works on the <code>/tmp/</code> directory). And just used a <code>begin &lt;...&gt; rescue Errno::EACCES</code> block to fix the problem. But in the current project, I don't want to use a rescue block.</p>\n\n<p>Why does the <code>File#writable?(str)</code> return true in the first place?</p>\n\n<p>EDIT: First of all this should be moved to unix.stackexchange.</p>\n\n<p>Secondly I understood</p>\n\n<ul>\n<li><p>You can't modify a file on a tmp filesystem: I have mounted a mere 4 MiB partition as tmpfs on /mnt. Created a file as local user. Then changed the permission to omnipotent 777! Then I changed my account to root. I tried to edit the contents with nano. It's not possible.</p></li>\n<li><p>Ruby's File#writable? probably doesn't detect the mounted filesystem type. Whether it's XFS or EXT4 or procfs or tmpfs. If all it does is checking the mode, in such scenario, the File#writable? returns true while in reality, it's not actually writable!</p></li>\n</ul>\n\n<p>Edit 2: I have uploaded 2 screenshots at imgur:</p>\n\n<p><img src=\"https://i.imgur.com/tB4T5Jl.png\" alt=\"Screenshot 1\"></p>\n\n<p><img src=\"https://i.imgur.com/hzc5s27.png\" alt=\"Screenshot 2\"></p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "edited": false, "score": 1, "creation_date": 1563137424, "post_id": 57023168, "comment_id": 100590976, "body": "In Rails conventions you would place mixins that are shared among models in <code>&#47;app&#47;models&#47;concerns&#47;</code>."}], "answers": [{"comments": [{"owner": {"reputation": 6462, "user_id": 3784008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/55ou4.jpg?s=128&g=1", "display_name": "anothermh", "link": "https://stackoverflow.com/users/3784008/anothermh"}, "edited": false, "score": 4, "creation_date": 1563062783, "post_id": 57023516, "comment_id": 100577329, "body": "Rails 5 autoloads <code>app</code> and its subdirectories. Ref: <a href=\"https://stackoverflow.com/a/40019108/3784008\">stackoverflow.com/a/40019108/3784008</a>"}], "tags": [], "owner": {"reputation": 5519, "user_id": 938947, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f611b152b4fa9fe2a05f4ee9b84fdcb7?s=128&d=identicon&r=PG", "display_name": "widjajayd", "link": "https://stackoverflow.com/users/938947/widjajayd"}, "is_accepted": false, "score": 0, "last_activity_date": 1563060502, "creation_date": 1563060502, "answer_id": 57023516, "question_id": 57023168, "link": "https://stackoverflow.com/questions/57023168/right-way-to-architect-rails-project/57023516#57023516", "title": "Right way to architect Rails project", "body": "<p>you can add subfolder to autoload with this way</p>\n\n<p>open config/application.rb and add folder path to autoload_paths</p>\n\n<pre><code>class Application &lt; Rails::Application\n  ...\n  config.autoload_paths += [\n      \"#{Rails.root}/app/services/models\",\n      \"#{Rails.root}/app/services/other_folder\"\n    ]\n  end\nend\n</code></pre>\n\n<p>rails will autoload all module files within that folders</p>\n"}, {"comments": [{"owner": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "edited": false, "score": 1, "creation_date": 1563137700, "post_id": 57023667, "comment_id": 100591038, "body": "I would say that using <code>app&#47;lib</code> is an anti-pattern. The app directory is for application code - <code>&#47;lib</code> is for project code that is not quite application code. Using <code>&#47;app&#47;models&#47;concerns</code> is far more appropriate."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "reply_to_user": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "edited": false, "score": 1, "creation_date": 1563138831, "post_id": 57023667, "comment_id": 100591253, "body": "@max If it&#39;s part of the application, it&#39;s application code. The nice thing about <code>&#47;app</code> is it will auto-reload, anything out side of that, with the exception of <code>config&#47;routes.rb</code>, requires a manual stop/start of the server. This can make iterating on code outside of <code>&#47;app</code> a lot more tedious. You can call the directory whatever you want. <code>&#47;app&#47;models&#47;concerns</code> should be for things that relate to models, not used as a dumping ground for non-model code."}], "tags": [], "owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "is_accepted": true, "score": 3, "last_activity_date": 1563062978, "creation_date": 1563062978, "answer_id": 57023667, "question_id": 57023168, "link": "https://stackoverflow.com/questions/57023168/right-way-to-architect-rails-project/57023667#57023667", "title": "Right way to architect Rails project", "body": "<p>If your class doesn't fit neatly into any of the pre-defined locations within <code>app/</code> you can just make your own. Common names are <code>lib/</code> or <code>concerns/</code> depending on your preference, at least in Rails 5+ where this behaviour was introduced. Prior to this you needed to manually add paths in your application configuration.</p>\n\n<p>In this case, <code>app/lib/obfuscate.rb</code> will be auto-loaded as <code>Obfuscate</code>, which is what you want.</p>\n\n<p>In general terms <code>app/*/x.rb</code> auto-loads as <code>X</code> for any value in the middle. The intermediate path name is basically irrelevant and is only used for organization and grouping.</p>\n"}], "owner": {"reputation": 762, "user_id": 7583514, "user_type": "registered", "accept_rate": 46, "profile_image": "https://i.stack.imgur.com/LHYzB.png?s=128&g=1", "display_name": "Anthony", "link": "https://stackoverflow.com/users/7583514/anthony"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 65, "favorite_count": 0, "accepted_answer_id": 57023667, "answer_count": 2, "score": 1, "last_activity_date": 1563062978, "creation_date": 1563055786, "last_edit_date": 1563059810, "question_id": 57023168, "link": "https://stackoverflow.com/questions/57023168/right-way-to-architect-rails-project", "title": "Right way to architect Rails project", "body": "<p>This is my current Rails file structure:</p>\n\n<pre><code>hello-app\n  app\n    assets\n    controller\n    helpers\n    models\n      application_record.rb\n      short_link.rb\n      obfuscate.rb\n</code></pre>\n\n<p>PROBLEM: The obfuscate.rb file is located next to the short_link.rb file where it doesn't belong.</p>\n\n<p>GOAL: I want to move the obfuscate.rb file to a different location, see new structure below:</p>\n\n<pre><code>hello-app\n  app\n    assets\n    controller\n    helpers\n    models\n      application_record.rb\n      short_link.rb\n    services\n      models\n        obfuscate.rb\n</code></pre>\n\n<p>And import the obfuscate.rb module into the short_link.rb model.</p>\n\n<p>Here is my current short_link.rb model file:</p>\n\n<pre><code>require 'obfuscate'\n\nclass ShortLink &lt; ApplicationRecord\n  include Obfuscate\n\n  def to_param\n    encrypt(id)\n  end\nend\n</code></pre>\n\n<p>And my obfuscate.rb file:</p>\n\n<pre><code>require 'openssl'\nrequire 'base64'\n\nmodule Obfuscate\n  def self.included(base)\n    base.extend self\n  end\n\n  def cipher\n    OpenSSL::Cipher::Cipher.new('aes-256-cbc')\n  end\n\n  def cipher_key\n    'custom_cipher_key'\n  end\n\n  def decrypt(value)\n    c = cipher.decrypt\n    c.key = Digest::SHA256.digest(cipher_key)\n    c.update(Base64.urlsafe_decode64(value.to_s)) + c.final\n  end\n\n  def encrypt(value)\n    c = cipher.encrypt\n    c.key = Digest::SHA256.digest(cipher_key)\n    Base64.urlsafe_encode64(c.update(value.to_s) + c.final)\n  end\nend\n</code></pre>\n\n<p>Also, is it a good practice to move the obfuscate.rb file to hello-app>>app>>services>>models>>obfuscate.rb? Or would there be a better location for this extra logic?</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 9663, "user_id": 5239030, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/76JEw.png?s=128&g=1", "display_name": "iGian", "link": "https://stackoverflow.com/users/5239030/igian"}, "edited": false, "score": 3, "creation_date": 1563038567, "post_id": 57021331, "comment_id": 100572993, "body": "Remove the bang <code>!</code> after <code>reverse</code>"}], "answers": [{"comments": [{"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 0, "creation_date": 1563039499, "post_id": 57021410, "comment_id": 100573182, "body": "The fact that <code>reverse!</code> is in-place is not really the relevant bit. In fact, it is actually mostly irrelevant what <code>reverse!</code> does. The salient bit is that it returns <code>self</code>, in other words, it returns the object <code>word</code> points to."}, {"owner": {"reputation": 9663, "user_id": 5239030, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/76JEw.png?s=128&g=1", "display_name": "iGian", "link": "https://stackoverflow.com/users/5239030/igian"}, "reply_to_user": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 0, "creation_date": 1563041334, "post_id": 57021410, "comment_id": 100573676, "body": "@J&#246;rgWMittag, thank you for pointing it for a deeper understanding. Which leads to the difference between <code>==</code> and <a href=\"https://ruby-doc.org/core-2.6.3/Object.html#method-i-eql-3F\" rel=\"nofollow noreferrer\">equal?</a>"}, {"owner": {"reputation": 48049, "user_id": 6419007, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/CwqtX.jpg?s=128&g=1", "display_name": "Eric Duminil", "link": "https://stackoverflow.com/users/6419007/eric-duminil"}, "edited": false, "score": 0, "creation_date": 1563118859, "post_id": 57021410, "comment_id": 100586632, "body": "Since <code>reverse!</code> returns <code>self</code>, there wouldn&#39;t be any difference between <code>==</code> and <code>equal?</code>."}], "tags": [], "owner": {"reputation": 9663, "user_id": 5239030, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/76JEw.png?s=128&g=1", "display_name": "iGian", "link": "https://stackoverflow.com/users/5239030/igian"}, "is_accepted": true, "score": 4, "last_activity_date": 1563038951, "creation_date": 1563038951, "answer_id": 57021410, "question_id": 57021331, "link": "https://stackoverflow.com/questions/57021331/why-is-my-palindrome-detector-not-workingreturning-only-one-input/57021410#57021410", "title": "Why is my palindrome detector not working(returning only one input)?", "body": "<p>You need to remove the bang <code>!</code> because <a href=\"https://ruby-doc.org/core-2.6.3/String.html#method-i-reverse-21\" rel=\"nofollow noreferrer\">String#reverse!</a> reverses the string in place and the condition is always true.</p>\n\n<p>This is what is happening:</p>\n\n<pre><code>word = \"whathever\"\nword.reverse!\n#=&gt; \"revehtahw\"\n\nword\n#=&gt; \"revehtahw\"\n\n\"revehtahw\" == \"revehtahw\"\n#=&gt; true\n</code></pre>\n\n<p>This is what you need:</p>\n\n<pre><code>word = \"whathever\"\nword.reverse\n#=&gt; \"revehtahw\"\n\nword\n#=&gt; \"whathever\"\n\n\"revehtahw\" == \"whathever\"\n#=&gt; false\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 1, "creation_date": 1563101489, "post_id": 57021457, "comment_id": 100582865, "body": "Interesting that \u2013 unlike most other <code>!</code> methods in <code>String</code> \u2013 this one doesn&#39;t return <code>nil</code> if the receiver already happens to be a palindrome."}], "tags": [], "owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "is_accepted": false, "score": 2, "last_activity_date": 1563039410, "creation_date": 1563039410, "answer_id": 57021457, "question_id": 57021331, "link": "https://stackoverflow.com/questions/57021331/why-is-my-palindrome-detector-not-workingreturning-only-one-input/57021457#57021457", "title": "Why is my palindrome detector not working(returning only one input)?", "body": "<p><a href=\"https://ruby-doc.org/core/String.html#method-i-reverse-21\" rel=\"nofollow noreferrer\"><code>String#reverse!</code> returns <code>self</code></a>, i.e. the object the <code>reverse!</code> message was sent to. So, in other words, <code>word.reverse!</code> returns the object referenced to by <code>word</code>, which is always equal to itself, ergo </p>\n\n<pre><code>word.reverse! == word\n</code></pre>\n\n<p>is always <code>true</code>.</p>\n\n<p>What you are looking for is <a href=\"https://ruby-doc.org/core/String.html#method-i-reverse\" rel=\"nofollow noreferrer\"><code>String#reverse</code></a>, which returns <em>a new string</em>.</p>\n"}, {"tags": [], "owner": {"reputation": 9, "user_id": 5811903, "user_type": "registered", "profile_image": "https://graph.facebook.com/10201664069680295/picture?type=large", "display_name": "nishant217", "link": "https://stackoverflow.com/users/5811903/nishant217"}, "is_accepted": false, "score": 0, "last_activity_date": 1563059038, "creation_date": 1563059038, "answer_id": 57023414, "question_id": 57021331, "link": "https://stackoverflow.com/questions/57021331/why-is-my-palindrome-detector-not-workingreturning-only-one-input/57023414#57023414", "title": "Why is my palindrome detector not working(returning only one input)?", "body": "<p>Like the others said, you need to remove the <code>!</code> operator as <code>str.reverse!</code>manipulates the string in-place. </p>\n\n<p>If you're new to Ruby, some cool things you can also do are put code before if statements to make it more readable and shorten it. Also, the ternary operator <code>(?:)</code> is useful as well.</p>\n\n<p><strong>Code Before If Example</strong></p>\n\n<pre><code>print \"Enter a Word and check if it's a Palindrome!\"\nword = gets.chomp\n\nprint \"The word you entered was a Palindrome!\" if word.reverse == word\nprint \"The word is not a Palindrome!\" if word.reverse != word\n</code></pre>\n\n<p><strong>Ternary Example</strong></p>\n\n<pre><code>print \"Enter a Word and check if it's a Palindrome!\"\nword = gets.chomp\n\nputs word.reverse == word ? \"It's a Palindrome!\" : \"It's not a Palindrome!\"\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 51, "user_id": 11247139, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8S9Po.jpg?s=128&g=1", "display_name": "RainbowNinja", "link": "https://stackoverflow.com/users/11247139/rainbowninja"}, "is_accepted": false, "score": 0, "last_activity_date": 1563096022, "creation_date": 1563096022, "answer_id": 57026081, "question_id": 57021331, "link": "https://stackoverflow.com/questions/57021331/why-is-my-palindrome-detector-not-workingreturning-only-one-input/57026081#57026081", "title": "Why is my palindrome detector not working(returning only one input)?", "body": "<p>When you add a \"!\" to a method (like you have with word.reverse!) ruby takes it to mean change the original permanently so word would become word.reverse. So when you compare word.reverse! to word, you have already changed word to be the reverse so every word you put in came back as true.</p>\n\n<p>What you need to change is </p>\n\n<pre><code>if word.reverse == word\n</code></pre>\n\n<p>this will actually check if the current word is equal to the reversed word.</p>\n"}], "owner": {"reputation": 13, "user_id": 11760456, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e3fb8bf439eca6ddf5eb2c9e19053126?s=128&d=identicon&r=PG&f=1", "display_name": "Jake S", "link": "https://stackoverflow.com/users/11760456/jake-s"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 70, "favorite_count": 0, "accepted_answer_id": 57021410, "answer_count": 4, "score": 1, "last_activity_date": 1563096022, "creation_date": 1563038350, "last_edit_date": 1563038488, "question_id": 57021331, "link": "https://stackoverflow.com/questions/57021331/why-is-my-palindrome-detector-not-workingreturning-only-one-input", "title": "Why is my palindrome detector not working(returning only one input)?", "body": "<p>I am trying to practice Ruby, and am making a palindrome detector.</p>\n\n<p>I have tried changing the <code>else</code> to <code>elsif</code> but neither worked.</p>\n\n<pre><code>print \"Enter a Word and check if it's a Palindrome!\"\nword = gets.chomp\nif word.reverse! == word\n  print \"The word you entered was a Palindrome!\"\nelse  \n  print \"The word is not a Palindrome!\"\nend\n</code></pre>\n\n<p>It only returns <code>\"The word you entered was a Palindrome!\"</code> but it should be returning one or the other.</p>\n"}]