[{"tags": ["ruby-on-rails", "ruby", "bootstrap-4", "bootstrap-modal"], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 11798548, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/--uL0I5ecQAY/AAAAAAAAAAI/AAAAAAAAAII/J79GXi9R4v4/photo.jpg?sz=128", "display_name": "LovlsGenesis", "link": "https://stackoverflow.com/users/11798548/lovlsgenesis"}, "edited": false, "score": 0, "creation_date": 1571275182, "post_id": 58422948, "comment_id": 103189313, "body": "Now, the modal isn&#39;t being displayed with<code>#editNote#{n.id}</code> . And how can I call the edit method without the link_to ?"}, {"owner": {"reputation": 3, "user_id": 11798548, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/--uL0I5ecQAY/AAAAAAAAAAI/AAAAAAAAAII/J79GXi9R4v4/photo.jpg?sz=128", "display_name": "LovlsGenesis", "link": "https://stackoverflow.com/users/11798548/lovlsgenesis"}, "edited": false, "score": 0, "creation_date": 1571275652, "post_id": 58422948, "comment_id": 103189402, "body": "Update : I&#39;ve solved it using this <code>&lt;div class=&quot;modal fade&quot; id=&quot;editNote&lt;%=n.id%&gt;&quot; tabindex=&quot;-1&quot; role=&quot;dialog&quot; aria-labelledby=&quot;EditingNote&quot;  aria-hidden=&quot;true&quot;&gt;</code>"}], "tags": [], "owner": {"reputation": 18856, "user_id": 1359650, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/dffc4318ac93e728a26c8e8b51b4eb37?s=128&d=identicon&r=PG", "display_name": "jvillian", "link": "https://stackoverflow.com/users/1359650/jvillian"}, "is_accepted": true, "score": 1, "last_activity_date": 1571268837, "creation_date": 1571268837, "answer_id": 58422948, "question_id": 58422628, "link": "https://stackoverflow.com/questions/58422628/edit-an-object-modal-ruby-on-rails/58422948#58422948", "title": "Edit an object Modal Ruby on Rails", "body": "<p>Every modal has the id <code>#EditNote</code>. And every edit link has:</p>\n\n<pre><code>data: { toggle: \"modal\", target: \"#EditNote\", whatever: \"@getbootstrap\"}\n</code></pre>\n\n<p>So, I suppose the click - regardless of which link you're clicking - is always showing the first modal with the id <code>#EditNote</code> which is always the modal for the first note. </p>\n\n<p>Perhaps try: </p>\n\n<pre><code>data: { toggle: \"modal\", target: \"#editNote#{n.id}\", whatever: \"@getbootstrap\"}\n</code></pre>\n\n<p>...and: </p>\n\n<pre><code>&lt;div class=\"modal fade\" id=\"editNote#{n.id}\"  tabindex=\"-1\" role=\"dialog\" aria-labelledby=\"EditingNote\"  aria-hidden=\"true\"&gt;\n</code></pre>\n\n<p>So that every modal has a unique <code>id</code> and every link points at that unique <code>id</code>. </p>\n\n<p>BTW, it seems using a <code>link_to</code> isn't really necessary since you're not doing anything in the controller action, but it's probably not doing any harm either. It's just an unnecessary request-response cycle. </p>\n"}], "owner": {"reputation": 3, "user_id": 11798548, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/--uL0I5ecQAY/AAAAAAAAAAI/AAAAAAAAAII/J79GXi9R4v4/photo.jpg?sz=128", "display_name": "LovlsGenesis", "link": "https://stackoverflow.com/users/11798548/lovlsgenesis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 37, "favorite_count": 0, "accepted_answer_id": 58422948, "answer_count": 1, "score": 0, "last_activity_date": 1571268837, "creation_date": 1571266100, "last_edit_date": 1571266449, "question_id": 58422628, "link": "https://stackoverflow.com/questions/58422628/edit-an-object-modal-ruby-on-rails", "title": "Edit an object Modal Ruby on Rails", "body": "<p>Yoo, I'm trying to make a modal with which I can edit a Note. </p>\n\n<p>But when I click on the edit button. It opens the modal but it only display the first note's infos even clicking on the others note it always redirects me to edit the first note of the table. </p>\n\n<p>I can't seem to figure it out.</p>\n\n<p>Here's my index view</p>\n\n<pre><code>  &lt;table class=\"table mt-5\"&gt;\n    &lt;thead&gt;\n      &lt;tr&gt;\n        &lt;th&gt;&lt;p&gt;Titulo&lt;/p&gt;&lt;/th&gt;\n        &lt;th&gt;&lt;p&gt;Conteudo&lt;/p&gt;&lt;/th&gt;\n        &lt;th&gt;&lt;p&gt;Data&lt;/p&gt;&lt;/th&gt;\n        &lt;th&gt;&lt;p&gt;Prioridade&lt;/p&gt;&lt;/th&gt;\n        &lt;th&gt;&lt;/th&gt;\n        &lt;th&gt;&lt;/th&gt;\n      &lt;/tr&gt;\n    &lt;/thead&gt;\n\n    &lt;tbody&gt;\n      &lt;% current_user.notes.each do |n| %&gt;\n      &lt;tr&gt;\n        &lt;td&gt;&lt;%= n.title %&gt;&lt;/td&gt;\n        &lt;td&gt;&lt;%= n.content %&gt;&lt;/td&gt;\n        &lt;td&gt;&lt;%= n.date %&gt;&lt;/td&gt;\n        &lt;td&gt;&lt;%= n.priority %&gt;&lt;/td&gt;\n        &lt;td&gt; &lt;%= link_to \"Editar\", edit_note_path(n), class: \"btn btn-outline-warning\",data: { toggle: \"modal\", target: \"#EditNote\", whatever: \"@getbootstrap\"} %&gt;&lt;/td&gt;\n        &lt;td&gt;&lt;%= link_to \"Apagar\", note_path(n), method: :delete, data: { confirm: 'Tem certeza ?' }, class: \"btn btn-outline-danger\" %&gt;\n        &lt;/td&gt;\n      &lt;/tr&gt;\n      &lt;div class=\"modal fade\" id=\"EditNote\"  tabindex=\"-1\" role=\"dialog\" aria-labelledby=\"EditingNote\"  aria-hidden=\"true\"&gt;\n        &lt;div class=\"modal-dialog\" role=\"document\"&gt;\n          &lt;div class=\"modal-content\"&gt;\n          &lt;div class=\"modal-header\"&gt;\n            &lt;h5 class=\"modal-title\" id=\"CreatingNote\"&gt;Editar Anota\u00e7\u00e3o&lt;/h5&gt;\n            &lt;button type=\"button\" class=\"close\" data-dismiss=\"modal\" aria-label=\"Fechar\"&gt;\n              &lt;span aria-hidden=\"true\"&gt;&amp;times;&lt;/span&gt;\n            &lt;/button&gt;\n          &lt;/div&gt;\n            &lt;div class=\"modal-body\"&gt;\n              &lt;%= simple_form_for n do |f| %&gt;\n                  &lt;%= f.input :title, label: \"Title\", placeholder: \"Title\" %&gt;\n                  &lt;%= f.input :content, placeholder: \"Escreve aqui\" %&gt;\n                  &lt;%= f.input :date %&gt;\n                  &lt;%= f.input :priority, :collection =&gt; %w[Baixa M\u00e9dia Alta] %&gt;\n            &lt;/div&gt;\n            &lt;div class=\"modal-footer\"&gt;\n                &lt;%= f.submit \"Editar\", class: \"btn btn-warning btn-block\" %&gt;\n              &lt;% end %&gt;\n            &lt;/div&gt;\n          &lt;/div&gt;\n        &lt;/div&gt;\n      &lt;/div&gt;\n      &lt;% end %&gt;\n    &lt;/tbody&gt;\n  &lt;/table&gt;\n</code></pre>\n\n<p>Here's my Controller </p>\n\n<pre><code>class NotesController &lt; ApplicationController\n  before_action :set_note, only: %w[edit update destroy]\n\n  def index\n    @notes = Note.all\n    @note = Note.new\n  end\n\n  def new\n    @note = Note.new\n  end\n\n  def create\n    @note = Note.new(note_params)\n    @note.user = current_user\n    if @note.save\n      redirect_to notes_path\n      flash[:alert] = \"Anota\u00e7\u00e3o salva\"\n    else\n      flash[:alert] = \"Tenta de novo\"\n      render :new\n    end\n  end\n\n  def edit\n  end\n\n  def update\n    @note.update(note_params)\n    redirect_to notes_path\n  end\n\n  def destroy\n    @note.destroy\n    redirect_to notes_path\n  end\n\n  private\n\n  def set_note\n    @note = Note.find(params[:id])\n  end\n\n  def note_params\n    params.require(:note).permit(:title, :content, :date, :priority, :user_id)\n  end\nend\n</code></pre>\n"}, {"tags": ["ruby", "ruby-on-rails-3", "conditional-statements"], "comments": [{"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1571288074, "post_id": 58422618, "comment_id": 103191978, "body": "This is a pure-Ruby issue, so you shouldn&#39;t have a Rails tag."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1571289245, "post_id": 58422618, "comment_id": 103192285, "body": "I don&#39;t think <code>Test2</code> is needed, as the question is perfectly clear without it. If anything it muddles the question. Note that there is no need for the keyword <code>return</code> in the last lines of <code>a</code> and <code>b</code>. If removed, <code>true</code> and <code>false</code> would be last expressions evaluated in each method, and therefore would be the respective return values. <code>return</code> does no harm, but the practice is to not use it when it is superfluous."}, {"owner": {"reputation": 3, "user_id": 2371326, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d21ae129407be59f83cb59459f0b1fe?s=128&d=identicon&r=PG", "display_name": "bigtaw", "link": "https://stackoverflow.com/users/2371326/bigtaw"}, "reply_to_user": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1571345688, "post_id": 58422618, "comment_id": 103220874, "body": "@CarySwoveland thanks for feedback on composition of the question."}], "answers": [{"comments": [{"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 1, "creation_date": 1571289343, "post_id": 58423281, "comment_id": 103192309, "body": "You might be more specific: <code>a</code> returns <code>true</code> and <code>true.nil? #=&gt; false</code>."}], "tags": [], "owner": {"reputation": 309, "user_id": 8539925, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3FIuP.jpg?s=128&g=1", "display_name": "Omar Donnadieu Mercado", "link": "https://stackoverflow.com/users/8539925/omar-donnadieu-mercado"}, "is_accepted": true, "score": 1, "last_activity_date": 1571272018, "creation_date": 1571272018, "answer_id": 58423281, "question_id": 58422618, "link": "https://stackoverflow.com/questions/58422618/instance-variable-in-ruby-resetting-as-nil/58423281#58423281", "title": "Instance Variable in Ruby Resetting as Nil", "body": "<p>In this example your method <code>b</code> never executes: <code>&amp;&amp;</code> returns its first argument if it is falsy. Otherwise, it evaluates and returns its second argument. Since <code>a.nil?</code> evaluates to <code>false</code> the second expression never gets called.</p>\n\n<p>Try this:</p>\n\n<pre><code>  def process \n    return if a &amp;&amp; b\n    puts @some\n  end\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 2371326, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d21ae129407be59f83cb59459f0b1fe?s=128&d=identicon&r=PG", "display_name": "bigtaw", "link": "https://stackoverflow.com/users/2371326/bigtaw"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 102, "favorite_count": 0, "accepted_answer_id": 58423281, "answer_count": 1, "score": 0, "last_activity_date": 1571288680, "creation_date": 1571266016, "question_id": 58422618, "link": "https://stackoverflow.com/questions/58422618/instance-variable-in-ruby-resetting-as-nil", "title": "Instance Variable in Ruby Resetting as Nil", "body": "<p>My instance variables gets turned back to nil, even though it was set in a separate function that is called.</p>\n\n<p>I've tried printing out before and after values for the instance variable, and have seen where it turns to nil. It's quite puzzling though. Attaching an example (<a href=\"https://repl.it/repls/FirebrickPresentKeyboard\" rel=\"nofollow noreferrer\">https://repl.it/repls/FirebrickPresentKeyboard</a>) also below:</p>\n\n<pre><code>class Test\n  def process \n    return if a.nil? &amp;&amp; b.nil?\n    puts @some\n  end\n\n  def a\n    @some = nil\n    return true\n  end\n\n  def b\n    @some = \"abc\"\n    return false\n  end\n\nend\n\nclass Test2\n  def process \n    return if c.nil?\n    puts @hello\n  end\n\n  def c\n    @hello = \"hello\"\n    return true\n  end\nend\n\nt = Test.new\nt.process\n\nt2 = Test2.new\nt2.process\n</code></pre>\n\n<p>In the Test class, I expect <em>@some</em> to print \"abc\" since it is set during the \"b\" function. However, it prints nil.</p>\n\n<p>In the Test2 class, I expect <em>@hello</em> to print \"hello\" and it certainly does.</p>\n"}, {"tags": ["ruby", "loops", "nokogiri"], "comments": [{"owner": {"reputation": 6462, "user_id": 3784008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/55ou4.jpg?s=128&g=1", "display_name": "anothermh", "link": "https://stackoverflow.com/users/3784008/anothermh"}, "edited": false, "score": 0, "creation_date": 1571264256, "post_id": 58421753, "comment_id": 103186985, "body": "I have reformatted your indentation and line breaks. This makes your code much easier to read, both for you and for us."}, {"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 0, "creation_date": 1571376030, "post_id": 58421753, "comment_id": 103227449, "body": "Welcome to SO! Please take the time to use proper grammar when posing a question or providing an answer. SO isn&#39;t a message board, instead it&#39;s more of an online encyclopedia of programming problems and solutions, where grammar counts because we&#39;re educating future users seeking a solution to the same problem you encountered. That effort pays off for us all."}], "answers": [{"comments": [{"owner": {"reputation": 25, "user_id": 9990240, "user_type": "registered", "profile_image": "https://graph.facebook.com/10160444465810332/picture?type=large", "display_name": "Alejandra Cantu", "link": "https://stackoverflow.com/users/9990240/alejandra-cantu"}, "edited": false, "score": 0, "creation_date": 1571263235, "post_id": 58422196, "comment_id": 103186678, "body": "Thanks! That works in pry but it doesn&#39;t puts it when i call the method on the &quot;call&quot; method. basically I am just getting this in the terminal::  <code>These are the services that Kefoto offers:  </code>          and then it ends"}, {"owner": {"reputation": 31, "user_id": 4358726, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b6903839d5c0207b84214be5f4b78a9a?s=128&d=identicon&r=PG&f=1", "display_name": "Taylor Wong", "link": "https://stackoverflow.com/users/4358726/taylor-wong"}, "reply_to_user": {"reputation": 25, "user_id": 9990240, "user_type": "registered", "profile_image": "https://graph.facebook.com/10160444465810332/picture?type=large", "display_name": "Alejandra Cantu", "link": "https://stackoverflow.com/users/9990240/alejandra-cantu"}, "edited": false, "score": 0, "creation_date": 1571263404, "post_id": 58422196, "comment_id": 103186734, "body": "Is <code>@product_names</code> empty?"}, {"owner": {"reputation": 25, "user_id": 9990240, "user_type": "registered", "profile_image": "https://graph.facebook.com/10160444465810332/picture?type=large", "display_name": "Alejandra Cantu", "link": "https://stackoverflow.com/users/9990240/alejandra-cantu"}, "edited": false, "score": 0, "creation_date": 1571263525, "post_id": 58422196, "comment_id": 103186768, "body": "no in pry i do get the list. not outside of pry. maybe i need to move the call method to the end of the file and start with the other methods? it feels like its going one by one"}, {"owner": {"reputation": 25, "user_id": 9990240, "user_type": "registered", "profile_image": "https://graph.facebook.com/10160444465810332/picture?type=large", "display_name": "Alejandra Cantu", "link": "https://stackoverflow.com/users/9990240/alejandra-cantu"}, "edited": false, "score": 0, "creation_date": 1571263593, "post_id": 58422196, "comment_id": 103186786, "body": "yes product services is nil but it populates once i call in the service_names method several times on pry"}, {"owner": {"reputation": 31, "user_id": 4358726, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b6903839d5c0207b84214be5f4b78a9a?s=128&d=identicon&r=PG&f=1", "display_name": "Taylor Wong", "link": "https://stackoverflow.com/users/4358726/taylor-wong"}, "reply_to_user": {"reputation": 25, "user_id": 9990240, "user_type": "registered", "profile_image": "https://graph.facebook.com/10160444465810332/picture?type=large", "display_name": "Alejandra Cantu", "link": "https://stackoverflow.com/users/9990240/alejandra-cantu"}, "edited": false, "score": 0, "creation_date": 1571263718, "post_id": 58422196, "comment_id": 103186818, "body": "in your <code>call</code> method, run <code>service_names</code> first to populate your <code>@product_names</code> before you <code>list_products</code>"}, {"owner": {"reputation": 25, "user_id": 9990240, "user_type": "registered", "profile_image": "https://graph.facebook.com/10160444465810332/picture?type=large", "display_name": "Alejandra Cantu", "link": "https://stackoverflow.com/users/9990240/alejandra-cantu"}, "edited": false, "score": 0, "creation_date": 1571263749, "post_id": 58422196, "comment_id": 103186828, "body": "&#39;&#39;&#39;[1] pry(#&lt;KefotoScraper::CLI&gt;)&gt; @product_names =&gt; [] [2] pry(#&lt;KefotoScraper::CLI&gt;)&gt; service_names =&gt; [&quot;foto-enmarcada&quot;, &quot;impresion-fotografica&quot;, &quot;photobooks&quot;, &quot;impresion-directa-canvas&quot;, &quot;impresion-acrilico&quot;, &quot;fotoregalos&quot;] [3] pry(#&lt;KefotoScraper::CLI&gt;)&gt; @product_names =&gt; [&quot;foto-enmarcada&quot;, &quot;impresion-fotografica&quot;, &quot;photobooks&quot;, &quot;impresion-directa-canvas&quot;, &quot;impresion-acrilico&quot;, &quot;fotoregalos&quot;] ```"}, {"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 1, "creation_date": 1571376331, "post_id": 58422196, "comment_id": 103227530, "body": "Don&#39;t just toss out code, explain how it works and why it&#39;s a good solution. The idea is to educate so the OP doesn&#39;t have to ask again, but instead understands how to solve similar problems in the future."}, {"owner": {"reputation": 31, "user_id": 4358726, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b6903839d5c0207b84214be5f4b78a9a?s=128&d=identicon&r=PG&f=1", "display_name": "Taylor Wong", "link": "https://stackoverflow.com/users/4358726/taylor-wong"}, "edited": false, "score": 0, "creation_date": 1571768855, "post_id": 58422196, "comment_id": 103348269, "body": "the Tin Man, responded to your comment with an edit in my original answer"}], "tags": [], "owner": {"reputation": 31, "user_id": 4358726, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b6903839d5c0207b84214be5f4b78a9a?s=128&d=identicon&r=PG&f=1", "display_name": "Taylor Wong", "link": "https://stackoverflow.com/users/4358726/taylor-wong"}, "is_accepted": false, "score": 2, "last_activity_date": 1571768821, "last_edit_date": 1571768821, "creation_date": 1571263072, "answer_id": 58422196, "question_id": 58421753, "link": "https://stackoverflow.com/questions/58421753/how-to-puts-a-number-list-of-items-in-the-array-using-an-until-loop/58422196#58422196", "title": "How to &#39;puts&#39; a number list of items in the array using an &#39;until&#39; loop", "body": "<pre><code>def list_products\n  @product_names.each_with_index do |list_item, i|\n    puts \"#{i} #{list_item}\"\n  end\nend\n</code></pre>\n\n<p>edit: thanks for the feedback, the Tin Man.\nWith your current code, you're looping through <code>@product_names</code> once with <code>until</code> and inside of that you're looping through <code>@product_names</code> with <code>.each</code>. For example if <code>@product_names.length == 3</code>, you'd print <code>3 * 3 == 9</code> times!</p>\n\n<p>Since you only need to loop through <code>@product_names</code> once, pick either <code>until</code> or <code>.each</code>. My example above uses <code>.each</code> and here is an example using <code>until</code>:</p>\n\n<pre><code>i = 1\nuntil @product_names.length &lt; i do\n  puts \"#{i} #{@product_names[i-1]}\"\n  i += 1\nend\n</code></pre>\n"}], "owner": {"reputation": 25, "user_id": 9990240, "user_type": "registered", "profile_image": "https://graph.facebook.com/10160444465810332/picture?type=large", "display_name": "Alejandra Cantu", "link": "https://stackoverflow.com/users/9990240/alejandra-cantu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 48, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1571768821, "creation_date": 1571260223, "last_edit_date": 1571376182, "question_id": 58421753, "link": "https://stackoverflow.com/questions/58421753/how-to-puts-a-number-list-of-items-in-the-array-using-an-until-loop", "title": "How to &#39;puts&#39; a number list of items in the array using an &#39;until&#39; loop", "body": "<p>I am using loops and a counter to put out a numbered list of items. It lists them all at once under 1, and then 2 is another round of listing of all of the items.</p>\n\n<p>The <code>while</code> loop doesn't work and I figured <code>until</code> was better. I also moved <code>counter</code> outside of the first iteriation but that doesn't work either.</p>\n\n<pre><code>require 'pry'\nrequire 'rubygems'\nrequire 'open-uri'\nrequire 'nokogiri'\n\nclass KefotoScraper::CLI\n  def initialize\n    @product_names = []\n    @page_url = \"https://kefotos.mx/\"\n  end\n\n  def call\n    puts \"These are the services that Kefoto offers:\"\n    list_products\n  end\n\n  private\n\n  def home_html\n    Nokogiri::HTML(open(@page_url))\n  end\n\n  def service_names\n    @service_names = home_html.css(\".nav-link\").map do |link|\n      link['href'].to_s.gsub(/.php/, \"\")\n    end\n\n    @service_names.each do |pr|\n      @product_names &lt;&lt; pr\n    end\n\n    @product_names\n  end\n\n  def list_products\n    i = 1\n    n = 0\n\n    until @product_names.length &lt; n do\n      @product_names.each {|list_item| puts \"#{i} #{list_item}\"}\n      i += 1\n      n += 1\n    end\n  end\n\n  def service_links\n    @service_links ||= home_html.css(\".nav-item\").map { |link| link['href'] }\n  end\nend\n</code></pre>\n\n<p>The list repeats itself over and over again. </p>\n\n<pre><code>[3] pry(#&lt;KefotoScraper::CLI&gt;)&gt; @product_names\n=&gt; [\"foto-enmarcada\", \"impresion-fotografica\", \"photobooks\", \"impresion-directa-canvas\", \"impresion-acrilico\", \"fotoregalos\"]\n[4] pry(#&lt;KefotoScraper::CLI&gt;)&gt; list_products\n1 foto-enmarcada\n1 impresion-fotografica\n1 photobooks\n1 impresion-directa-canvas\n1 impresion-acrilico\n1 fotoregalos\n2 foto-enmarcada\n2 impresion-fotografica\n2 photobooks\n2 impresion-directa-canvas\n2 impresion-acrilico\n2 fotoregalos\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "macos"], "comments": [{"owner": {"reputation": 6462, "user_id": 3784008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/55ou4.jpg?s=128&g=1", "display_name": "anothermh", "link": "https://stackoverflow.com/users/3784008/anothermh"}, "edited": false, "score": 0, "creation_date": 1571263486, "post_id": 58420706, "comment_id": 103186760, "body": "What directory are you in when you run <code>ruby -v</code> and what directory are you in when you run <code>rails -v</code>? If you&#39;re in an project directory there may be a <code>.ruby-version</code> file that RVM reads that automatically switches your Ruby version. Also, what shell are you using and what user are you logged in as when doing these operations? RVM installs Ruby for your current user profile only; make sure you haven&#39;t used <code>su</code> or changed shells. Order of operations should be: <code>echo $SHELL; cd ~; echo $HOME; whoami; rvm list; ruby -v; rails -v</code> -- post the output here."}, {"owner": {"reputation": 2623, "user_id": 625354, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/xc5hf.jpg?s=128&g=1", "display_name": "Dbz", "link": "https://stackoverflow.com/users/625354/dbz"}, "edited": false, "score": 0, "creation_date": 1571421075, "post_id": 58420706, "comment_id": 103248987, "body": "Tony, was this figured out?"}], "answers": [{"comments": [{"owner": {"reputation": 125, "user_id": 697675, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/cd22511eb4b24a74f1b3765e1ebaa07a?s=128&d=identicon&r=PG", "display_name": "Tony Staunton", "link": "https://stackoverflow.com/users/697675/tony-staunton"}, "edited": false, "score": 0, "creation_date": 1571257340, "post_id": 58420819, "comment_id": 103184493, "body": "which ruby outputs: /Users/tonystaunton/.rvm/rubies/ruby-2.6.3/bin/ruby"}, {"owner": {"reputation": 125, "user_id": 697675, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/cd22511eb4b24a74f1b3765e1ebaa07a?s=128&d=identicon&r=PG", "display_name": "Tony Staunton", "link": "https://stackoverflow.com/users/697675/tony-staunton"}, "edited": false, "score": 0, "creation_date": 1571257519, "post_id": 58420819, "comment_id": 103184569, "body": "which -a ruby outputs: /usr/bin/ruby"}, {"owner": {"reputation": 125, "user_id": 697675, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/cd22511eb4b24a74f1b3765e1ebaa07a?s=128&d=identicon&r=PG", "display_name": "Tony Staunton", "link": "https://stackoverflow.com/users/697675/tony-staunton"}, "edited": false, "score": 0, "creation_date": 1571257548, "post_id": 58420819, "comment_id": 103184587, "body": "echo $PATH outputs: /Users/tonystaunton/.rvm/gems/ruby-2.6.3/bin:/Users/tonystau&zwnj;&#8203;nton/.rvm/gems/ruby-&zwnj;&#8203;2.6.3@global/bin:/Us&zwnj;&#8203;ers/tonystaunton/.rv&zwnj;&#8203;m/rubies/ruby-2.6.3/&zwnj;&#8203;bin:/Users/tonystaun&zwnj;&#8203;ton/.rvm/bin:/Librar&zwnj;&#8203;y/Frameworks/Python.&zwnj;&#8203;framework/Versions/3&zwnj;&#8203;.7/bin:/anaconda3/bi&zwnj;&#8203;n:/anaconda3/condabi&zwnj;&#8203;n:/usr/local/bin:/us&zwnj;&#8203;r/bin:/bin:/usr/sbin&zwnj;&#8203;:/sbin:/Library/TeX/&zwnj;&#8203;texbin"}, {"owner": {"reputation": 24560, "user_id": 4880924, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/d40e83be235d4f70428da0d42e12d427?s=128&d=identicon&r=PG&f=1", "display_name": "BKSpurgeon", "link": "https://stackoverflow.com/users/4880924/bkspurgeon"}, "edited": false, "score": 0, "creation_date": 1571260317, "post_id": 58420819, "comment_id": 103185698, "body": "I agree with Dbz - using rbenv obviates the need to fiddle around with gemsets."}, {"owner": {"reputation": 6462, "user_id": 3784008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/55ou4.jpg?s=128&g=1", "display_name": "anothermh", "link": "https://stackoverflow.com/users/3784008/anothermh"}, "edited": false, "score": 0, "creation_date": 1571263154, "post_id": 58420819, "comment_id": 103186644, "body": "I&#39;ve used rvm for over six years and have never had to &quot;fiddle around with gemsets.&quot; In my experience, rbenv and its shims cause way, way more compatibility issues than using rvm. The solution to rbenv problems is always &quot;use rvm.&quot;"}, {"owner": {"reputation": 2623, "user_id": 625354, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/xc5hf.jpg?s=128&g=1", "display_name": "Dbz", "link": "https://stackoverflow.com/users/625354/dbz"}, "reply_to_user": {"reputation": 125, "user_id": 697675, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/cd22511eb4b24a74f1b3765e1ebaa07a?s=128&d=identicon&r=PG", "display_name": "Tony Staunton", "link": "https://stackoverflow.com/users/697675/tony-staunton"}, "edited": false, "score": 0, "creation_date": 1571268447, "post_id": 58420819, "comment_id": 103187996, "body": "@TonyStaunton please edit your original question with all of the outputs. It makes it much easier to debug because I can tell that some of the data got lost when pasting into the comment"}], "tags": [], "owner": {"reputation": 2623, "user_id": 625354, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/xc5hf.jpg?s=128&g=1", "display_name": "Dbz", "link": "https://stackoverflow.com/users/625354/dbz"}, "is_accepted": false, "score": 1, "last_activity_date": 1571268644, "last_edit_date": 1571268644, "creation_date": 1571255739, "answer_id": 58420819, "question_id": 58420706, "link": "https://stackoverflow.com/questions/58420706/trying-to-install-rails-6-using-rvm/58420819#58420819", "title": "Trying to install Rails 6 using RVM", "body": "<p>You're running <code>ruby 2.3.7p456</code>. You need to set your local ruby version to <code>2.6.3</code>.</p>\n\n<p>Try <code>which ruby</code> to see which ruby version is loaded.</p>\n\n<pre><code>rvm install 2.6.3\nrvm use 2.6.3\n</code></pre>\n\n<p>You can then see which ruby is running with <code>which ruby</code>.</p>\n\n<p>See the basics on the <a href=\"https://rvm.io/rvm/basics\" rel=\"nofollow noreferrer\">rvm docs</a></p>\n\n<p>As an aside, I also recommend recommend rbenv over rvm; however, you can only have one installed. If you have both installed, you're going to have a bad time.</p>\n\n<p>To make sure you do not have both installed try <code>which rbenv</code>, and that should return <code>rbenv not found</code></p>\n\n<p>Please edit your original question with the output of the following commands:</p>\n\n<ol>\n<li><code>which -a ruby</code></li>\n<li><code>echo $PATH</code> (That will help debug if your $PATH is set up incorrectly.)</li>\n<li><code>which rbenv</code></li>\n<li><code>ls</code> (in your project directory)</li>\n</ol>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 2171057, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7aWP8.jpg?s=128&g=1", "display_name": "Shaurabh14", "link": "https://stackoverflow.com/users/2171057/shaurabh14"}, "is_accepted": false, "score": 0, "last_activity_date": 1572493341, "creation_date": 1572493341, "answer_id": 58636638, "question_id": 58420706, "link": "https://stackoverflow.com/questions/58420706/trying-to-install-rails-6-using-rvm/58636638#58636638", "title": "Trying to install Rails 6 using RVM", "body": "<p>i also had the similar problem which i resolved by uninstalling rvm completely and then installing rbenv.</p>\n"}], "owner": {"reputation": 125, "user_id": 697675, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/cd22511eb4b24a74f1b3765e1ebaa07a?s=128&d=identicon&r=PG", "display_name": "Tony Staunton", "link": "https://stackoverflow.com/users/697675/tony-staunton"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1185, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1572493341, "creation_date": 1571255260, "question_id": 58420706, "link": "https://stackoverflow.com/questions/58420706/trying-to-install-rails-6-using-rvm", "title": "Trying to install Rails 6 using RVM", "body": "<p>I have installed RVM successfully on my Mac and using it I have installed Ruby 2.6.3. I have set my current and default version of Ruby to be 2.6.3. Everything seems to be fine because when I enter ruby -v into the terminal it tells me I'm using ruby 2.6.3.</p>\n\n<p>My problem comes when I try to install Rails 6, I'm entering:</p>\n\n<pre><code>gem install rails --version=6.0.0 -no-ri -no-rdoc\n</code></pre>\n\n<p>It seems to install correctly however when I try to confirm with:</p>\n\n<pre><code>rails -v\n</code></pre>\n\n<p>I get:</p>\n\n<pre><code>Rails 6 requires Ruby 2.5.0 or newer.\n\nYou're running\n  ruby 2.3.7p456 (2018-03-28 revision 63024) [universal.x86_64-       darwin18]\n\nPlease upgrade to Ruby 2.5.0 or newer to continue.\n</code></pre>\n\n<p>Why am I getting this message when my ruby -v command is telling me that I am using ruby 2.6.3</p>\n\n<p>Any help would be very welcome.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "gzip", "zlib"], "comments": [{"owner": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "edited": false, "score": 0, "creation_date": 1571255739, "post_id": 58420524, "comment_id": 103183758, "body": "where are you defining <code>body</code> ?"}, {"owner": {"reputation": 31, "user_id": 4358726, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b6903839d5c0207b84214be5f4b78a9a?s=128&d=identicon&r=PG&f=1", "display_name": "Taylor Wong", "link": "https://stackoverflow.com/users/4358726/taylor-wong"}, "reply_to_user": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "edited": false, "score": 0, "creation_date": 1571257997, "post_id": 58420524, "comment_id": 103184775, "body": "@lacostenycoder <code>body</code> is a string that I&#39;m pulling from an S3 bucket"}], "answers": [{"comments": [{"owner": {"reputation": 31, "user_id": 4358726, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b6903839d5c0207b84214be5f4b78a9a?s=128&d=identicon&r=PG&f=1", "display_name": "Taylor Wong", "link": "https://stackoverflow.com/users/4358726/taylor-wong"}, "edited": false, "score": 0, "creation_date": 1571257576, "post_id": 58421002, "comment_id": 103184606, "body": "Thanks for the response! I have tried this and got the same result:  <code>file = File.open(&quot;test.json.gz&quot;, &quot;w+&quot;); file.puts string_io; file.close; # File.size(&quot;test.json.gz&quot;) == 27738775;  data = &quot;&quot;; Zlib::GzipReader.open(file.path) do |gz|;     data &lt;&lt; gz.read; end; # data.length == 603537;</code>"}, {"owner": {"reputation": 1342, "user_id": 1143549, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/45da1bf4376d6f184e41de57e03789b9?s=128&d=identicon&r=PG", "display_name": "Derek Wright", "link": "https://stackoverflow.com/users/1143549/derek-wright"}, "reply_to_user": {"reputation": 31, "user_id": 4358726, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b6903839d5c0207b84214be5f4b78a9a?s=128&d=identicon&r=PG&f=1", "display_name": "Taylor Wong", "link": "https://stackoverflow.com/users/4358726/taylor-wong"}, "edited": false, "score": 2, "creation_date": 1571322464, "post_id": 58421002, "comment_id": 103210242, "body": "You are most likely writing your file incorrectly. Write the file, exit to shell and attempt using the gunzip tool to extract and be sure it works. You should probably use Zlib::GzipWriter to write the file: <a href=\"https://ruby-doc.org/stdlib/libdoc/zlib/rdoc/Zlib/GzipWriter.html\" rel=\"nofollow noreferrer\">ruby-doc.org/stdlib/libdoc/zlib/rdoc/Zlib/GzipWriter.html</a> - Also see my update about decoding base64 that is possibly returned from S3 api"}], "tags": [], "owner": {"reputation": 1342, "user_id": 1143549, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/45da1bf4376d6f184e41de57e03789b9?s=128&d=identicon&r=PG", "display_name": "Derek Wright", "link": "https://stackoverflow.com/users/1143549/derek-wright"}, "is_accepted": false, "score": 2, "last_activity_date": 1571322580, "last_edit_date": 1571322580, "creation_date": 1571256633, "answer_id": 58421002, "question_id": 58420524, "link": "https://stackoverflow.com/questions/58420524/zlib-gunzip-only-returning-partial-file/58421002#58421002", "title": "Zlib gunzip only returning partial file", "body": "<p>Instead of opening a file and passing a file handler, have you tried using <code>Zlib::GzipReader.open()</code>? It's documented here <a href=\"https://ruby-doc.org/stdlib/libdoc/zlib/rdoc/Zlib/GzipReader.html\" rel=\"nofollow noreferrer\">https://ruby-doc.org/stdlib/libdoc/zlib/rdoc/Zlib/GzipReader.html</a></p>\n\n<p>I tested locally and was able to get proper results:</p>\n\n<pre><code>data = ''\n=&gt; \"\"\n\nZlib::GzipReader.open('file.tar.gz') { |gz|\n  data &lt;&lt; gz.read\n}\n\ndata.length\n=&gt; 750003\n</code></pre>\n\n<p>Then checked the file size uncompressed:</p>\n\n<pre><code>gzip -l file.tar.gz                                                                                                                           \n  compressed uncompressed  ratio uncompressed_name\n      315581       754176  58.1% file.tar\n</code></pre>\n\n<p>Edit: Saw your update that you are pulling the data via S3 API. Make sure you are Base64 decoding your body before writing it to a file.</p>\n"}], "owner": {"reputation": 31, "user_id": 4358726, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b6903839d5c0207b84214be5f4b78a9a?s=128&d=identicon&r=PG&f=1", "display_name": "Taylor Wong", "link": "https://stackoverflow.com/users/4358726/taylor-wong"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 56, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1571322580, "creation_date": 1571254410, "last_edit_date": 1571258178, "question_id": 58420524, "link": "https://stackoverflow.com/questions/58420524/zlib-gunzip-only-returning-partial-file", "title": "Zlib gunzip only returning partial file", "body": "<p>I have a 27MB .gz file (127MB unzipped). Using ruby's Zlib to ungzip the file returns correctly formatted data, but the file is truncated to a fraction of the expected size (1290 rows of data out of 253,000).</p>\n\n<pre><code>string_io = StringIO.new(body)\nfile = File.new(\"test.json.gz\", \"w+\")\nfile.puts string_io.read\nfile.close\n\n# string_io.read.length == 26_675_650\n# File.size(\"test.json.gz\") == 27_738_775\n</code></pre>\n\n<p>Using GzipReader:</p>\n\n<pre><code>data = \"\"\nFile.open(file.path) do |f|\n  gz = Zlib::GzipReader.new(f)\n  data &lt;&lt; gz.read\n  gz.close\nend\n# data.length = 603_537\n</code></pre>\n\n<p>Using a different GzipReader method:</p>\n\n<pre><code>data = \"\"\nZlib::GzipReader.open(file.path) do |gz|\n  data &lt;&lt; gz.read\nend\n# data.length == 603_537\n\n</code></pre>\n\n<p>Using gunzip:</p>\n\n<pre><code>gz = Zlib.gunzip(string_io.read)\n# gz.length == 603_537\n</code></pre>\n\n<p>The expected size is 127,604,690 but I'm only able to extract 603,537. Using gunzip in my terminal correctly extracts the entire file but I'm looking for a programmatic way to handle this.</p>\n"}, {"tags": ["ruby", "rest", "api", "authentication", "rest-client"], "comments": [{"owner": {"reputation": 6462, "user_id": 3784008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/55ou4.jpg?s=128&g=1", "display_name": "anothermh", "link": "https://stackoverflow.com/users/3784008/anothermh"}, "edited": false, "score": 0, "creation_date": 1571264552, "post_id": 58420348, "comment_id": 103187065, "body": "The error is explicitly clear: <code>404 Not Found</code>. That means <code>https:&#47;&#47;moviesite.com&#47;movies</code> doesn&#39;t exist. It&#39;s not even that you&#39;re using the wrong request method; e.g. if it allowed GET but not POST you&#39;d see <code>405 Method Not Allowed</code>."}, {"owner": {"reputation": 95, "user_id": 5266815, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gzhvu.jpg?s=128&g=1", "display_name": "George S", "link": "https://stackoverflow.com/users/5266815/george-s"}, "reply_to_user": {"reputation": 6462, "user_id": 3784008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/55ou4.jpg?s=128&g=1", "display_name": "anothermh", "link": "https://stackoverflow.com/users/3784008/anothermh"}, "edited": false, "score": 0, "creation_date": 1571272783, "post_id": 58420348, "comment_id": 103188875, "body": "That is a dummy site, but i dont think that is the issue because the actual endpoint im hitting i know for a fact exists because I can reach it using postman"}, {"owner": {"reputation": 6462, "user_id": 3784008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/55ou4.jpg?s=128&g=1", "display_name": "anothermh", "link": "https://stackoverflow.com/users/3784008/anothermh"}, "edited": false, "score": 0, "creation_date": 1571274286, "post_id": 58420348, "comment_id": 103189137, "body": "The code doesn\u2019t lie. Double and triple check EVERYTHING in your code and in your postman config."}], "owner": {"reputation": 95, "user_id": 5266815, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gzhvu.jpg?s=128&g=1", "display_name": "George S", "link": "https://stackoverflow.com/users/5266815/george-s"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 50, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1571253652, "creation_date": 1571253652, "question_id": 58420348, "link": "https://stackoverflow.com/questions/58420348/how-to-send-a-multi-part-authorization-using-the-rest-client-gem-api", "title": "How to send a multi part authorization using the rest-client gem api", "body": "<p>I am trying to use the rest-client gem to make api calls for test automation purposes. This requires me to authenticate first with an initial request. Then the following requests must contain the returned token from the first request and the user email. I am currently stuck on how to send the second request properly do this in a post request to create an object.</p>\n\n<p>First request to get token which works fine and returns me the token i need:</p>\n\n<pre><code>request = '{\n            \"user\": {\n                \"password\" : \"abcdefg\",\n                \"email\" : \"example@email.com\"\n                }\n            }'\n\nresponse = RestClient.post \"https://moviesite.com/sign_in\", \n            request, {\n                accept: \"application/json\", \n                content_type: \"application/json\"\n            }\n</code></pre>\n\n<p>I save the token value like so:</p>\n\n<pre><code>results = JSON.parse(response)\n            puts results\n            token_value = results['token']\n            puts token_value\n</code></pre>\n\n<p>Second request where I attempt to use the token in order to make an action on an object:</p>\n\n<pre><code>request2 = '{\n            \"movie\": {\n                \"title\": \"new movie\",\n                \"status\": \"release\"\n                }\n            }'\n\nresponse2 = RestClient.post \"https://moviesite.com/movies\", \n            request2, {\n                accept: \"application/json\", \n                content_type: \"application/json\",\n                :Authorization =&gt; \"Token token=#{token_value}, email='example@email.com'\"\n            }\n\nfirst request executes just fine and returns the token, i then try to insert the token in the second request but when the second request executes im getting an exception which makes me wonder if i correctly put it together.\n\n\nTraceback (most recent call last):\n        9: from APITest.rb:46:in `&lt;main&gt;'\n        8: from /Users/user/.rvm/gems/ruby-2.6.3/gems/rest-client-2.1.0/lib/restclient.rb:70:in `post'\n        7: from /Users/user/.rvm/gems/ruby-2.6.3/gems/rest-client-2.1.0/lib/restclient/request.rb:63:in `execute'\n        6: from /Users/user/.rvm/gems/ruby-2.6.3/gems/rest-client-2.1.0/lib/restclient/request.rb:163:in `execute'\n        5: from /Users/user/.rvm/gems/ruby-2.6.3/gems/rest-client-2.1.0/lib/restclient/request.rb:727:in `transmit'\n        4: from /Users/user/.rvm/rubies/ruby-2.6.3/lib/ruby/2.6.0/net/http.rb:920:in `start'\n        3: from /Users/user/.rvm/gems/ruby-2.6.3/gems/rest-client-2.1.0/lib/restclient/request.rb:743:in `block in transmit'\n        2: from /Users/user/.rvm/gems/ruby-2.6.3/gems/rest-client-2.1.0/lib/restclient/request.rb:836:in `process_result'\n        1: from /Users/user/.rvm/gems/ruby-2.6.3/gems/rest-client-2.1.0/lib/restclient/abstract_response.rb:129:in `return!'\n/Users/user/.rvm/gems/ruby-2.6.3/gems/rest-client-2.1.0/lib/restclient/abstract_response.rb:249:in `exception_with_response': 404 Not Found (RestClient::NotFound)\n</code></pre>\n"}, {"tags": ["ruby"], "answers": [{"tags": [], "owner": {"reputation": 2251, "user_id": 9785060, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IUduC.png?s=128&g=1", "display_name": "Viktor", "link": "https://stackoverflow.com/users/9785060/viktor"}, "is_accepted": false, "score": 6, "last_activity_date": 1574503739, "last_edit_date": 1574503739, "creation_date": 1571254425, "answer_id": 58420531, "question_id": 58420347, "link": "https://stackoverflow.com/questions/58420347/how-to-combine-elements-from-one-array-with-each-element-from-another-array/58420531#58420531", "title": "How to combine elements from one array with each element from another array", "body": "<p>You can use <a href=\"https://ruby-doc.org/core-2.6.3/Array.html#method-i-product\" rel=\"nofollow noreferrer\"><code>#product</code></a>:</p>\n\n<pre><code>num = [1,2,3]\nlet = [\"a\",\"b\",\"c\"]\n\nnum.product let\n#=&gt;[[1, \"a\"], [1, \"b\"], [1, \"c\"], [2, \"a\"], [2, \"b\"], [2, \"c\"], [3, \"a\"], [3, \"b\"], [3, \"c\"]]\n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 12228552, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/581b84966164d95ce92c47f235e85944?s=128&d=identicon&r=PG&f=1", "display_name": "Pedro", "link": "https://stackoverflow.com/users/12228552/pedro"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 111, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1574503739, "creation_date": 1571253651, "last_edit_date": 1571318102, "question_id": 58420347, "link": "https://stackoverflow.com/questions/58420347/how-to-combine-elements-from-one-array-with-each-element-from-another-array", "title": "How to combine elements from one array with each element from another array", "body": "<p>I'm trying to combine elements from one array with every element from another array, I tried looking for some solutions but I couldn't figure it out.</p>\n\n<p>Take these two arrays for example:</p>\n\n<pre><code>num = [1,2,3]\n\nlet = [\"a\",\"b\",\"c\"]\n</code></pre>\n\n<p>I want to combine them in order to obtain:</p>\n\n<pre><code>combined = [[1, \"a\"], [1, \"b\"], [1, \"c\"], [2, \"a\"], [2, \"b\"], [2, \"c\"], \n            [3, \"a\"], [3, \"b\"], [3, \"c\"]]\n</code></pre>\n"}, {"tags": ["ruby", "batch-file", "ceedling"], "comments": [{"owner": {"reputation": 28755, "user_id": 5047996, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/la3kD.png?s=128&g=1", "display_name": "aschipfl", "link": "https://stackoverflow.com/users/5047996/aschipfl"}, "edited": false, "score": 0, "creation_date": 1571303542, "post_id": 58420324, "comment_id": 103198856, "body": "This question is not really <a href=\"https://stackoverflow.com/questions/tagged/batch-file\">batch-file</a>-related, is it?"}, {"owner": {"reputation": 914, "user_id": 2081050, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/719c508be5b66081378f47b100dcf7ba?s=128&d=identicon&r=PG", "display_name": "Michael Miner", "link": "https://stackoverflow.com/users/2081050/michael-miner"}, "reply_to_user": {"reputation": 28755, "user_id": 5047996, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/la3kD.png?s=128&g=1", "display_name": "aschipfl", "link": "https://stackoverflow.com/users/5047996/aschipfl"}, "edited": false, "score": 0, "creation_date": 1571326025, "post_id": 58420324, "comment_id": 103212248, "body": "It was failing to open a batch file"}, {"owner": {"reputation": 28755, "user_id": 5047996, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/la3kD.png?s=128&g=1", "display_name": "aschipfl", "link": "https://stackoverflow.com/users/5047996/aschipfl"}, "edited": false, "score": 0, "creation_date": 1571327092, "post_id": 58420324, "comment_id": 103212851, "body": "Put the closing <code>&quot;</code> in the batch file path behind <code>mdb.bat</code>, then put its argument path in between <code>&quot;&quot;</code> too..."}], "answers": [{"tags": [], "owner": {"reputation": 914, "user_id": 2081050, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/719c508be5b66081378f47b100dcf7ba?s=128&d=identicon&r=PG", "display_name": "Michael Miner", "link": "https://stackoverflow.com/users/2081050/michael-miner"}, "is_accepted": false, "score": 1, "last_activity_date": 1571254694, "creation_date": 1571254694, "answer_id": 58420590, "question_id": 58420324, "link": "https://stackoverflow.com/questions/58420324/ruby-io-popen-permission-denied/58420590#58420590", "title": "Ruby IO.popen Permission Denied", "body": "<p>I am not 100% sure of the difference but this code works!</p>\n\n<pre><code>require 'rbconfig'\nis_windows = (RbConfig::CONFIG['host_os'] =~ /mswin|mingw|cygwin/)\nOUT_FILE = \"./test/simulation/out.txt\"\nFile.delete OUT_FILE if File.exists? OUT_FILE\nif is_windows\n    path = '\"C:\\\\Program Files (x86)\\\\Microchip\\\\MPLABX\\\\v5.05\"'\n    var = IO.popen(path + \"\\\\mplab_platform\\\\bin\\\\mdb.bat ./test/simulation/sim_instructions.txt &gt; \" + OUT_FILE)\nelse\n    var = IO.popen(\"#{ENV['MPLABX_ROOT']}mplab_ide/bin/mdb.sh ./test/simulation/sim_instructions.txt &gt; \" + OUT_FILE)\nend\nProcess.wait\nif File.exists? OUT_FILE\n    file_contents = File.read OUT_FILE\n    print file_contents\nend\n</code></pre>\n"}], "owner": {"reputation": 914, "user_id": 2081050, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/719c508be5b66081378f47b100dcf7ba?s=128&d=identicon&r=PG", "display_name": "Michael Miner", "link": "https://stackoverflow.com/users/2081050/michael-miner"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 115, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1571254694, "creation_date": 1571253543, "question_id": 58420324, "link": "https://stackoverflow.com/questions/58420324/ruby-io-popen-permission-denied", "title": "Ruby IO.popen Permission Denied", "body": "<p>I am very close to getting the Microchip MPLABX MDB (debugger) working with an automated test suite called ceedling. I have a ruby file called <code>sim_test_fixture.rb</code></p>\n\n<p>This file is to open the <code>mdb.bat</code> and pass it a config file called <code>sim_instructions.txt</code>. When I run the ruby file I am given a permission denied error. Why is that?</p>\n\n<p>The script runs the command <code>\"C:\\Program Files (x86)\\Microchip\\MPLABX\\v5.05\\mplab_platform\\bin\\\"mdb.bat C:\\Users\\MichaelMi\\Documents\\SourceTree\\LED-Lighting-Driver\\test\\simulation\\sim_instructions.txt</code>\nWhen I run the command myself it works just fine. Only when I try to run it from the following ruby file does it fail.</p>\n\n<pre><code>require 'rbconfig'\nis_windows = (RbConfig::CONFIG['host_os'] =~ /mswin|mingw|cygwin/)\n\nOUT_FILE = \"./test/simulation/out.txt\"\nFile.delete OUT_FILE if File.exists? OUT_FILE\npath = '\"C:\\Program Files (x86)\\Microchip\\MPLABX\\v5.05\\mplab_platform\\bin\\\"mdb.bat C:\\Users\\MichaelMi\\Documents\\SourceTree\\LED-Lighting-Driver\\test\\simulation\\sim_instructions.txt'\nvar = IO.popen(path)\nProcess.wait\nif File.exists? OUT_FILE\n    file_contents = File.read OUT_FILE\n    file_contents.gsub!(\"\\n\", \"\")\n    print file_contents\nend \n</code></pre>\n"}, {"tags": ["arrays", "ruby", "variables", "nokogiri"], "comments": [{"owner": {"reputation": 6462, "user_id": 3784008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/55ou4.jpg?s=128&g=1", "display_name": "anothermh", "link": "https://stackoverflow.com/users/3784008/anothermh"}, "edited": false, "score": 2, "creation_date": 1571253661, "post_id": 58420056, "comment_id": 103182870, "body": "Please do not post images of plaintext. <a href=\"https://meta.stackoverflow.com/a/285557/3784008\">Images of plaintext are not appropriate on StackOverflow</a>. You have access to the plaintext; please copy and paste it into your question."}, {"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 0, "creation_date": 1571376592, "post_id": 58420056, "comment_id": 103227608, "body": "Welcome to SO! Please take the time to use correct grammar and format your posting for readability. See &quot;<a href=\"https://meta.stackexchange.com/questions/22186/how-do-i-format-my-code-blocks\">How do I format my code blocks?</a>&quot; and &quot;<a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a>&quot; and the linked pages and &quot;<a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">mcve</a>&quot;. It helps everyone."}, {"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 0, "creation_date": 1571377079, "post_id": 58420056, "comment_id": 103227770, "body": "I&#39;d recommend reducing the example to its bare minimum that still demonstrates the problem you&#39;re having. Show us an example of what you expect as a result of the code."}], "answers": [{"comments": [{"owner": {"reputation": 25, "user_id": 9990240, "user_type": "registered", "profile_image": "https://graph.facebook.com/10160444465810332/picture?type=large", "display_name": "Alejandra Cantu", "link": "https://stackoverflow.com/users/9990240/alejandra-cantu"}, "edited": false, "score": 0, "creation_date": 1571693560, "post_id": 58478101, "comment_id": 103318594, "body": "hi there. thanks for your reply. I am incorporating &#39;httpart&#39;  into it instead of Nokogiri::HTML and also the Regex you used. However, When I use HTTParty on it i get error <code>bad argument (expected URI object or URI string) (ArgumentError)</code> I have used it like this: <code>HTTParty.get(@page_url)</code> where @page_url = &quot;<a href=\"https://kefotos.mx/\" rel=\"nofollow noreferrer\">kefotos.mx</a>&quot;  in an initialize method. Here is my repo: <a href=\"https://github.com/acantu101/scraping_final/blob/master/kefoto/lib/kefoto_scraper/CLI.rb\" rel=\"nofollow noreferrer\">github.com/acantu101/scraping_final/blob/master/kefoto/lib/&hellip;</a>"}], "tags": [], "owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "is_accepted": false, "score": 1, "last_activity_date": 1571614807, "last_edit_date": 1571614807, "creation_date": 1571613816, "answer_id": 58478101, "question_id": 58420056, "link": "https://stackoverflow.com/questions/58420056/how-to-parse-data-and-store-it-into-variables-using-nokogiri-and-ruby/58478101#58478101", "title": "How to parse data and store it into variables using Nokogiri and Ruby", "body": "<p>Nokogiri's command-line IRB is your friend. Use <code>nokogiri \"https://kefotos.mx/\"</code> at the shell to start it up:</p>\n\n<pre><code>irb(main):006:0&gt; @doc.css('.nav-link[href]').map { |l| l['href'].sub(/\\.php$/, '') }\n=&gt; [\"foto-enmarcada\", \"impresion-fotografica\", \"photobooks\", \"impresion-directa-canvas\", \"impresion-acrilico\", \"fotoregalos\"]\n</code></pre>\n\n<p>That tells us it's not dynamic HTML and shows how I'd retrieve those values. Since an <code>a</code> tag doesn't have to contain <code>href</code> parameters I guarded against retrieving any such tags by accident.</p>\n\n<p>You've got bugs, potential bugs and bad practices. Here are some untested but likely to work ways to fix them:</p>\n\n<p>Running the code results in:</p>\n\n<pre><code>uninitialized constant KefotoScraper (NameError)\n</code></pre>\n\n<p>In your code you have <code>@service</code> and <code>@service_links</code> which are never initialized so...?</p>\n\n<p>Don't do this because it's cruel:</p>\n\n<pre><code>def home_html\n  Nokogiri::HTML(open(PAGE_URL))\nend\n</code></pre>\n\n<p>Every time you call <code>home_html</code> you (re)open and (re)read the page from the remote site and wasting your and their CPU and network time. Instead, cache the parsed document in a variable kind of like you did in your commented-out line using HTTParty. It's much more friendly to not hit sites repeatedly and helps avoid getting banned.</p>\n\n<p>Moving on:</p>\n\n<pre><code>def service_names\n  @service_names = home_html.css(\".nav-link\").map do\n    |link| link['href'].to_s.gsub(/.php/, \"\")\n  end\n  @service_names.each do |pr|\n    @@product_names &lt;&lt; pr\n  end\nend\n</code></pre>\n\n<p>I'd use something like <code>get_product_names</code> and return the array like I did in Nokogiri above:</p>\n\n<pre><code>def get_product_names\n  get_html.css('.nav-link[href]').map { |l|\n    l['href'].sub(/\\.php$/, '')\n  }\nend\n:\n:\n@@product_names = get_product_names()\n</code></pre>\n\n<p>Here's why I'd do it another way. You used:</p>\n\n<pre><code>link['href'].to_s.gsub(/.php/, \"\")\n</code></pre>\n\n<ol>\n<li><p><code>to_s</code> is redundant because <code>link['href']</code> is already returning a string. Stringizing a string wastes brain cycles when rereading/debugging the code. Be kind to yourself and don't do that.</p>\n\n<pre><code>require 'nokogiri'\nhtml = '&lt;a href=\"foo\"&gt;'\ndoc = Nokogiri::HTML(html)\ndoc.at('a')['href'] # =&gt; \"foo\"\ndoc.at('a')['href'].class # =&gt; String\n</code></pre></li>\n<li><p><code>gsub</code> Ew. How many occurrences of the target string do you anticipate to find and replace? If only one, which is extremely likely in a URL \"href\", instead use <code>sub</code> because it's more efficient; It only runs once and moves on whereas <code>gsub</code> looks through the string at least one additional time to see if it needs to run again.</p></li>\n<li><p><code>/.php/</code> doesn't mean what you think it does, and it's a very subtle bug in waiting. <code>/.php/</code> means \"some character followed by \"php\", but you most likely meant \"a period followed by 'php'\". This was something I used to see all the time because other programmers I worked with didn't bother to figure out what they were doing, and being the senior guy it was my job to pick their code apart and find bugs. Instead you should use <code>/\\.php/</code> which removes the special meaning of <code>.</code>, resulting in your desired pattern which is not going to trigger if it encounters <code>\"aphp\"</code> or something similar. See \"<a href=\"https://ruby-doc.org/core-2.4.0/Regexp.html#class-Regexp-label-Metacharacters+and+Escapes\" rel=\"nofollow noreferrer\">Metacharacters and Escapes</a>\" and the following section on that page for more information.</p></li>\n<li><p>On top of the above, the pattern needs to be anchored to avoid wasting more CPU. <code>/\\.php/</code> will cause the regular expression engine to start at the beginning of the string and walk through it until it reaches the end. As strings get longer that process gets slower, and in production code that is processing GB of data it can slow down a system markedly. Instead, using an anchor like <code>/\\.php$/</code> or <code>/\\.php\\z/</code> gives the engine a hint where it should start looking and can result in big speedups. I've got some answers on SO that go into this, and the included benchmarks show how they help. See \"<a href=\"https://ruby-doc.org/core-2.4.0/Regexp.html#class-Regexp-label-Anchors\" rel=\"nofollow noreferrer\">Anchors</a>\" for more information.</p></li>\n</ol>\n\n<p>That should help you but I didn't try modifying your code to see if it did. When asking questions about bugs in your code we need the minimum code necessary to reproduce the problem. That lets us help you more quickly and efficiently. Please see \"<a href=\"https://stackoverflow.com/help/how-to-ask\">ask</a>\" and the linked pages and \"<a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">mcve</a>\".</p>\n"}], "owner": {"reputation": 25, "user_id": 9990240, "user_type": "registered", "profile_image": "https://graph.facebook.com/10160444465810332/picture?type=large", "display_name": "Alejandra Cantu", "link": "https://stackoverflow.com/users/9990240/alejandra-cantu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 108, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1571614807, "creation_date": 1571252461, "last_edit_date": 1571376871, "question_id": 58420056, "link": "https://stackoverflow.com/questions/58420056/how-to-parse-data-and-store-it-into-variables-using-nokogiri-and-ruby", "title": "How to parse data and store it into variables using Nokogiri and Ruby", "body": "<p>When I assign variable names such as <code>service_names</code> and <code>name_array</code> they are nil and nothing goes to the class variable <code>@@product_names</code>.</p>\n\n<p>I used Pry to try the code without storing it into a variable and it works. It has the values I need. </p>\n\n<p>I had this split up in more variables before to make cleaner code, for example:</p>\n\n<pre><code>require 'pry'\nrequire 'rubygems'\nrequire 'open-uri'\nrequire 'nokogiri'\n\n\n  class KefotoScraper::CLI\n      @@product_names =[]\n      PAGE_URL = \"https://kefotos.mx/\"\n\n\n    def call\nbinding.pry\n    puts \"These are the services that Kefoto offers:\"\n    #list_products\n    puts \"which service would you like to select?\"\n    @selection = gets.chomp\n    view_price_range\n    puts \"Would you like to go back to the service menu? y/n\"\n    answer = gets.chomp\n      if answer == \"y\"\n      call\n      end\n    end\n\n    private\n\n    def home_html\n        # @home_html ||=\n        #     HTTParty.get root_path\n\n        Nokogiri::HTML(open(PAGE_URL))\n\n\n    end\n    #\n    # # TODO: read about ruby memoization\n    # def home_node\n    #\n    #     @home_node ||=\n    #      Nokogiri::HTML(PAGE_URL)\n    # end\n\ndef service_names\n      @service_names = home_html.css(\".nav-link\").map do\n        |link| link['href'].to_s.gsub(/.php/, \"\")\n      end\n      @service_names.each do |pr|\n        @@product_names &lt;&lt; pr\n      end\n    end\n\n     def list_products\n       i = 1\n       n = 0\n\n       while @@product_names.length &lt; n\n        @@product_names.each do |list_item|\n\n         puts \"#{i} #{list_item[n]}\"\n       i += 1\n       n += 1\n       end\n      end\n   end\n\n     def view_price_range\n       price_range = []\n       @service_links.each do |link|\n         if @service = link\n           link.css(\".row\").map {|price| price[\"p\"].value}\n            price_range &lt;&lt; p\n         end\n         price_range\n     end\n\n\n    def service_links\n        @service_links ||=\n        home_html.css(\".nav-item\").map { |link| link['href'] }\n    end\n\nend\nend\n</code></pre>\n\n<p><code>@@product_names</code> should contain the code that comes out of</p>\n\n<pre><code>home_html.css(\".nav-link\").map { |link| link['href'] }.to_s.gsub(/.php/, \"\")\n</code></pre>\n\n<p>which later I turn back to an array.</p>\n\n<p>This is what it looks like in Pry:</p>\n\n<pre><code>9] pry(#&lt;KefotoScraper::CLI&gt;)&gt; home_html.css(\".nav-link\").map { |link| link['href'] }.to_s.gsub(/.php/, \"\").split(\",\")\n=&gt; [\"[\\\"foto-enmarcada\\\"\", \" \\\"impresion-fotografica\\\"\", \" \\\"photobooks\\\"\", \" \\\"impresion-directa-canvas\\\"\", \" \\\"impresion-acrilico\\\"\", \" \\\"fotoregalos\\\"]\"]\n[10] pry(#&lt;KefotoScraper::CLI&gt;)&gt; home_html.css(\".nav-link\").map { |link| link['href'] }.to_s.gsub(/.php/, \"\").split(\",\")[0]\n=&gt; \"[\\\"foto-enmarcada\\\"\"\n</code></pre>\n"}, {"tags": ["arrays", "ruby", "data-structures"], "answers": [{"tags": [], "owner": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "is_accepted": false, "score": 3, "last_activity_date": 1571252929, "creation_date": 1571252929, "answer_id": 58420167, "question_id": 58420046, "link": "https://stackoverflow.com/questions/58420046/make-an-array-from-list-where-first-element-of-the-array-is-the-first-element-in/58420167#58420167", "title": "Make an array from list where first element of the array is the first element in list", "body": "<p>You can take the first value (<code>:name</code>) and get its product with every remaning element by using <a href=\"https://ruby-doc.org/core-2.5.1/Array.html#method-i-product\" rel=\"nofollow noreferrer\"><code>Array#product</code></a>:</p>\n\n<pre><code>array = [:name, :max, :john, :raj, :sam]\np [array[0]].product(array[1..-1])\n# [[:name, :max], [:name, :john], [:name, :raj], [:name, :sam]]\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 9663, "user_id": 5239030, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/76JEw.png?s=128&g=1", "display_name": "iGian", "link": "https://stackoverflow.com/users/5239030/igian"}, "is_accepted": true, "score": 2, "last_activity_date": 1571258412, "last_edit_date": 1571258412, "creation_date": 1571257965, "answer_id": 58421284, "question_id": 58420046, "link": "https://stackoverflow.com/questions/58420046/make-an-array-from-list-where-first-element-of-the-array-is-the-first-element-in/58421284#58421284", "title": "Make an array from list where first element of the array is the first element in list", "body": "<p><a href=\"https://ruby-doc.org/core-2.6.5/Array.html#method-i-product\" rel=\"nofollow noreferrer\">Array#product</a> is better, but you can also use <a href=\"https://ruby-doc.org/core-2.6.5/Array.html#method-i-zip\" rel=\"nofollow noreferrer\">Array#zip</a>:</p>\n\n<pre><code>ary = [:a, :b, :c, :d]\n\n([ary.first]*(ary.size-1)).zip ary[1..]\n#=&gt; [[:a, :b], [:a, :c], [:a, :d]]\n</code></pre>\n\n<p>Or also:</p>\n\n<pre><code>ary.then { |a, *rest| ([a] * rest.size).zip rest }\n</code></pre>\n\n<p>But yes, product is cleaner:</p>\n\n<pre><code>ary.then { |a, *rest| [a].product rest }\n</code></pre>\n"}], "owner": {"reputation": 135, "user_id": 2374333, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/48667ec3d6ad31e2abb316af0b12b147?s=128&d=identicon&r=PG", "display_name": "Max Ahmed", "link": "https://stackoverflow.com/users/2374333/max-ahmed"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 40, "favorite_count": 0, "accepted_answer_id": 58421284, "answer_count": 2, "score": 2, "last_activity_date": 1571296173, "creation_date": 1571252423, "last_edit_date": 1571296173, "question_id": 58420046, "link": "https://stackoverflow.com/questions/58420046/make-an-array-from-list-where-first-element-of-the-array-is-the-first-element-in", "title": "Make an array from list where first element of the array is the first element in list", "body": "<p>I am very new to ruby so excuse me if this is a basic question. </p>\n\n<p>I have a list that looks like this:</p>\n\n<pre><code>    [name, max, john, raj, sam]\n</code></pre>\n\n<p>And i want to make a new array that will look like this:</p>\n\n<pre><code>    [[name, max], [name, john], [name, raj], [name, sam]]\n</code></pre>\n\n<p>Here is what i am trying to do:</p>\n\n<pre><code>    row.xpath('td').each_with_index do |cell, index|\n     if index == 0\n      tarray['name'] &lt;&lt; cell.text\n     else\n      tarray['values'] &lt;&lt; cell.text\n    end\n</code></pre>\n\n<p>I know i am doing it wrong because when i have ['name'] it will not be logically possible to have ['values']\nPlease advice me on how i can achieve this using the best method.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "xml", "sitemap"], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 10015804, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a24c268c7a3dc005e71c93982e1fb81?s=128&d=identicon&r=PG&f=1", "display_name": "Voloshin", "link": "https://stackoverflow.com/users/10015804/voloshin"}, "is_accepted": false, "score": 0, "last_activity_date": 1571574411, "creation_date": 1571574411, "answer_id": 58472977, "question_id": 58419980, "link": "https://stackoverflow.com/questions/58419980/problem-with-sitemap-xml-in-ruby-on-rails-app/58472977#58472977", "title": "Problem with sitemap.xml in Ruby on Rails app", "body": "<p>As I know, sitemap_generator creates sitemap.xml.gz file. Try open <code>your-site.com/sitemap.xml.gz</code>. Works on my project.</p>\n"}], "owner": {"reputation": 266, "user_id": 5779471, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/664d4fd2113141c6c85e7b9c3052b1ef?s=128&d=identicon&r=PG&f=1", "display_name": "Miro", "link": "https://stackoverflow.com/users/5779471/miro"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 303, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1571574411, "creation_date": 1571252140, "last_edit_date": 1571257910, "question_id": 58419980, "link": "https://stackoverflow.com/questions/58419980/problem-with-sitemap-xml-in-ruby-on-rails-app", "title": "Problem with sitemap.xml in Ruby on Rails app", "body": "<p>I have Ruby on Rails app and I created <b>sitemap.xml</b> file (in public directory) with <b>sitemap_generator</b> gem but it can't be readable in production.</p>\n\n<p><b>sitemap.rb</b></p>\n\n<pre><code># Set the host name for URL creation\nSitemapGenerator::Sitemap.default_host = \"https://example.com\"\n\nSitemapGenerator::Sitemap.namer = SitemapGenerator::SimpleNamer.new(:sitemap, :extension =&gt; '.xml')\n\nSitemapGenerator::Sitemap.create do\n\n  Category.find_each do |cat|\n    add category_path(cat), priority: 0.8, changefreq: 'daily', lastmod: cat.updated_at\n  end\n\n  Job.where(status: true).find_each do |job|\n    add job_path(job), priority: 0.6, lastmod: job.updated_at\n  end\n\nend\n</code></pre>\n\n<p><b>errors_controller.rb</b></p>\n\n<pre><code>class ErrorsController &lt; ApplicationController\n\n  def not_found\n    render status: 404\n  end\n\n  def unprocessable_entity\n    render status: 422\n  end\n\n  def internal_server_error\n    render status: 500\n  end\n\nend\n</code></pre>\n\n<p>I have all views for each kind of errors but <b>Heroku logs</b> show me:</p>\n\n<pre><code>I, [2019-10-16T11:57:53 #4]  INFO -- : Processing by ErrorsController#not_found as XML\nI, [2019-10-16T11:57:53 #4]  INFO -- : Completed 500 Internal Server Error in 2ms (ActiveRecord: 0.0ms)\n2019-10-16T11:57:53 app[web.1]: Error during failsafe response: Missing template errors/not_found, application/not_found with {:locale=&gt;[:en], :formats=&gt;[:xml], :variants=&gt;[], :handlers=&gt;[:raw, :erb, :html, :builder, :ruby, :coffee, :jbuilder, :haml]}. Searched in:\n2019-10-16T11:57:53 app[web.1]: * \"/app/app/views\"\n</code></pre>\n\n<p>The command <b>heroku run rails sitemap:refresh:no_ping</b> is creating all links that I want but when I try to see the link <a href=\"https://mywebsite.com/sitemap.xml\" rel=\"nofollow noreferrer\">https://mywebsite.com/sitemap.xml</a> - I get 500 error and I can't see the content - I don't know why. I think it can be some problems with error controller because <a href=\"https://mywebsite.com/sitemap\" rel=\"nofollow noreferrer\">https://mywebsite.com/sitemap</a> (without .xml) displays 404 page. With .xml it is 500 error.</p>\n\n<p>On localhost everything works fine but in production mode on Heroku I have problems.</p>\n"}, {"tags": ["ruby", "cucumber", "capybara", "httparty"], "comments": [{"owner": {"reputation": 42014, "user_id": 2709090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/238c2b7cde2c817fc9a5a2b8eaa2ffad?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Walpole", "link": "https://stackoverflow.com/users/2709090/thomas-walpole"}, "edited": false, "score": 0, "creation_date": 1571283408, "post_id": 58419873, "comment_id": 103190950, "body": "It&#39;s not clear what the Capybara tag has to do with this? There is no actual code shown that would use Capybara, please see <a href=\"https://stackoverflow.com/help/how-to-ask\">stackoverflow.com/help/how-to-ask</a>"}], "answers": [{"tags": [], "owner": {"reputation": 96, "user_id": 4211756, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/fcad15e66847672c70a8d1c8facd9756?s=128&d=identicon&r=PG&f=1", "display_name": "Rob Geraghty", "link": "https://stackoverflow.com/users/4211756/rob-geraghty"}, "is_accepted": true, "score": 0, "last_activity_date": 1571316569, "creation_date": 1571316569, "answer_id": 58433084, "question_id": 58419873, "link": "https://stackoverflow.com/questions/58419873/how-to-add-the-value-of-another-field-to-an-httparty-field-using-ruby/58433084#58433084", "title": "How to add the value of another field to an HTTParty field using Ruby", "body": "<p>You could persist the password by saving it to a variable before entering the <code>@@body</code> block.</p>\n\n<pre><code>@@base_url  = 'https://api-de-tarefas.herokuapp.com/users'\nfake_password = Faker::number(6)\n@@body = \n{\n  \"user\": {\n    \"email\": Faker::Internet.email,\n    \"password\": fake_password,\n    \"password_confirmation\": fake_password\n\n   }    \n}.to_json\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 12217238, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mBJhM2hlduAOH9IQNjscb7FCwNrRGC5e539D6dcfA=k-s128", "display_name": "Silvio Aulik", "link": "https://stackoverflow.com/users/12217238/silvio-aulik"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 40, "favorite_count": 0, "accepted_answer_id": 58433084, "answer_count": 1, "score": 0, "last_activity_date": 1571316569, "creation_date": 1571251635, "last_edit_date": 1571270581, "question_id": 58419873, "link": "https://stackoverflow.com/questions/58419873/how-to-add-the-value-of-another-field-to-an-httparty-field-using-ruby", "title": "How to add the value of another field to an HTTParty field using Ruby", "body": "<p>Is possible to use this: Add password-generated faker content to \"<strong>passoword_confirmation</strong>\". If so, what is the syntax, try various ways and failed !. Thank's </p>\n\n<blockquote>\n  <p>\"email\": Faker::Internet.email,\n      \"password\": Faker::number(6),\n      \"password_confirmation\":</p>\n</blockquote>\n\n<pre><code>@@base_url  = 'https://api-de-tarefas.herokuapp.com/users'\n    @@body = \n    {\n    \"user\": {\n    \"email\": Faker::Internet.email,\n    \"password\": Faker::number(6),\n    \"password_confirmation\":      here I want to receive the password generated from Faker.\n\n     }    \n}.to_json\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "rails-activerecord"], "comments": [{"owner": {"reputation": 1171, "user_id": 4466467, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8fa3cb584327391e71cfa7d6f7f652b1?s=128&d=identicon&r=PG&f=1", "display_name": "Sujan Adiga", "link": "https://stackoverflow.com/users/4466467/sujan-adiga"}, "edited": false, "score": 1, "creation_date": 1571252054, "post_id": 58419764, "comment_id": 103182201, "body": "Are you sure if <code>Customer.create</code> successfully executed?"}, {"owner": {"reputation": 13378, "user_id": 1430810, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/v669u.jpg?s=128&g=1", "display_name": "arieljuod", "link": "https://stackoverflow.com/users/1430810/arieljuod"}, "edited": false, "score": 0, "creation_date": 1571288145, "post_id": 58419764, "comment_id": 103192005, "body": "Why don&#39;t you use ActiveRecord&#39;s validations instead of that Costumer.exists? condition? You can set the uniqueness of the username instead and loop until you have no error on that attribute."}], "answers": [{"tags": [], "owner": {"reputation": 24560, "user_id": 4880924, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/d40e83be235d4f70428da0d42e12d427?s=128&d=identicon&r=PG&f=1", "display_name": "BKSpurgeon", "link": "https://stackoverflow.com/users/4880924/bkspurgeon"}, "is_accepted": true, "score": 0, "last_activity_date": 1571260155, "creation_date": 1571260155, "answer_id": 58421738, "question_id": 58419764, "link": "https://stackoverflow.com/questions/58419764/ruby-on-rails-active-record/58421738#58421738", "title": "ruby on rails active record", "body": "<p>Your code will only enter the loop if there is already a customer existing with those credentials. Can you confirm that a customer with that name already exists, and there there are no validation errors like @SujaAdiga suggests?</p>\n\n<p>You can test it out with the following:</p>\n\n<pre><code>    def create_account\n  # You can assign the 'get' method results to a var if you want\n  puts \"Enter your full name\"\n  get_full_name = gets.chomp\n\n  puts 'Enter your email address'\n  get_email = gets.chomp\n\n  puts 'Enter your desired username.'\n  get_username = gets.chomp\n\n\n  ## It will only enter the lop if such a customer already exists.\n  ## Let's add one:\n\ncustomer = Customer.create(\n    first_last_name: get_full_name,\n    email_address:   get_email,\n    username:        get_username,\n    password:        \"password\")\n\nif customer.errors.full_messages.empty?\n  puts \"******successfully created customer*******\"\n  puts customer\nelse\n  puts \"*****ok we could not create the customer*****\"\nend\n\n  while Customer.exists?(username: get_username) do\n    puts \"This username is already taken. Please enter a different one\"\n    get_username = gets.chomp\n    break if !Customer.exists?(username: get_username)\n  end\n\n  puts \"Please enter password\"\n  get_password = gets.chomp\n\n  customer = Customer.create(\n    first_last_name: get_full_name,\n    email_address:   get_email,\n    username:        get_username,\n    password:        get_password)\nend\n</code></pre>\n"}], "owner": {"reputation": 193, "user_id": 11020140, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bbcae66fef24695f210144e178acd7d6?s=128&d=identicon&r=PG&f=1", "display_name": "hannah", "link": "https://stackoverflow.com/users/11020140/hannah"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 43, "favorite_count": 0, "accepted_answer_id": 58421738, "answer_count": 1, "score": 0, "last_activity_date": 1571260155, "creation_date": 1571251214, "last_edit_date": 1571252660, "question_id": 58419764, "link": "https://stackoverflow.com/questions/58419764/ruby-on-rails-active-record", "title": "ruby on rails active record", "body": "<p>For this method I am having an issue with the while loop. If I enter a username that already exists it is supposed to prompt me again to enter another username but what is going on is that it is skipping that part and jumping straight to prompt for the user to enter a password.</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>def create_account\n  # You can assign the 'get' method results to a var if you want\n  puts \"Enter your full name\"\n  get_full_name = gets.chomp\n\n  puts 'Enter your email address'\n  get_email = gets.chomp\n\n  puts 'Enter your desired username.'\n  get_username = gets.chomp\n\n  while Customer.exists?(username: get_username) do\n    puts \"This username is already taken. Please enter a different one\"\n    get_username = gets.chomp\n    break if !Customer.exists?(username: get_username)\n  end\n\n  puts \"Please enter password\"\n  get_password = gets.chomp\n\n  customer = Customer.create(\n    first_last_name: get_full_name,\n    email_address:   get_email,\n    username:        get_username,\n    password:        get_password)\nend\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "cucumber", "capybara", "timecop"], "comments": [{"owner": {"reputation": 42014, "user_id": 2709090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/238c2b7cde2c817fc9a5a2b8eaa2ffad?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Walpole", "link": "https://stackoverflow.com/users/2709090/thomas-walpole"}, "edited": false, "score": 0, "creation_date": 1571283586, "post_id": 58419303, "comment_id": 103191000, "body": "It&#39;s unclear from your examples but are you accepting/using the browser time anywhere?  Timecop will only affect your server time, and only if you&#39;re letting Capybara run the app and tests in the same process.  If you need to mock the browser time too you need to look for a JS library to do that like sinon.js, etc."}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 12228222, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-f42gSxTistM/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfoBxLjyz9tdl7ICqwYSiYJZLE7-g/photo.jpg?sz=128", "display_name": "\u042f\u0440\u043e\u0441\u043b\u0430\u0432 \u041a\u043e\u0440\u043e\u0431\u0435\u0439\u043d\u0438\u043a\u043e\u0432", "link": "https://stackoverflow.com/users/12228222/%d0%af%d1%80%d0%be%d1%81%d0%bb%d0%b0%d0%b2-%d0%9a%d0%be%d1%80%d0%be%d0%b1%d0%b5%d0%b9%d0%bd%d0%b8%d0%ba%d0%be%d0%b2"}, "edited": false, "score": 0, "creation_date": 1571278855, "post_id": 58419690, "comment_id": 103190045, "body": "<a href=\"https://api.rubyonrails.org/classes/ActiveSupport/Testing/TimeHelpers.html#method-i-travel_to\" rel=\"nofollow noreferrer\">travel_to</a> was first what i try to do, and i have nothing, and after i try to use Timecop gem"}], "tags": [], "owner": {"reputation": 363, "user_id": 2272145, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ebc232d2f2cf15b4b0481b8b8b8f66ba?s=128&d=identicon&r=PG", "display_name": "LucasM", "link": "https://stackoverflow.com/users/2272145/lucasm"}, "is_accepted": false, "score": 0, "last_activity_date": 1571250911, "creation_date": 1571250911, "answer_id": 58419690, "question_id": 58419303, "link": "https://stackoverflow.com/questions/58419303/timecop-doesnt-work-with-cucumber-capybara/58419690#58419690", "title": "Timecop doesn&#39;t work with cucumber capybara", "body": "<p>Have you tried <a href=\"https://api.rubyonrails.org/classes/ActiveSupport/Testing/TimeHelpers.html#method-i-travel_to\" rel=\"nofollow noreferrer\">travel_to</a> helper in your specs?</p>\n\n<p>You said you are using Timecop but have not attached any examples.</p>\n\n<p><a href=\"https://andycroll.com/ruby/replace-timecop-with-rails-time-helpers-in-rspec/\" rel=\"nofollow noreferrer\">Here is a nice article</a> from Andy Croll about moving from a Timecop to built in helpers</p>\n"}], "owner": {"reputation": 11, "user_id": 12228222, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-f42gSxTistM/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfoBxLjyz9tdl7ICqwYSiYJZLE7-g/photo.jpg?sz=128", "display_name": "\u042f\u0440\u043e\u0441\u043b\u0430\u0432 \u041a\u043e\u0440\u043e\u0431\u0435\u0439\u043d\u0438\u043a\u043e\u0432", "link": "https://stackoverflow.com/users/12228222/%d0%af%d1%80%d0%be%d1%81%d0%bb%d0%b0%d0%b2-%d0%9a%d0%be%d1%80%d0%be%d0%b1%d0%b5%d0%b9%d0%bd%d0%b8%d0%ba%d0%be%d0%b2"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 121, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1571279138, "creation_date": 1571249302, "last_edit_date": 1571279138, "question_id": 58419303, "link": "https://stackoverflow.com/questions/58419303/timecop-doesnt-work-with-cucumber-capybara", "title": "Timecop doesn&#39;t work with cucumber capybara", "body": "<p>Sorry for my english, it's not my native language</p>\n\n<p>I have some time sensetive test. It's about some alert message when before event left less than 24h or more than 24h.</p>\n\n<blockquote>\n  <p>Some part of my code to find required events</p>\n</blockquote>\n\n<pre><code>left_less_than_24_hours_to_event = full_events_room.select{ |event| Time.now &lt; Time.parse(event['event_time']) &amp;&amp; Time.parse(event['event_time']) &lt; (Time.now + 24.hours) }\nleft_more_than_24_hours_to_event = full_events_room.select{ |event| (Time.now + 24.hours) &lt; Time.parse(event['event_time']) }\n</code></pre>\n\n<p>And have some cucumber scenario (fast translate to English (but it's dosen't matter about language))</p>\n\n<pre><code>\u0421\u0446\u0435\u043d\u0430\u0440\u0438\u0439: User came in 2019-10-15 12:00\n\u0414\u043e\u043f\u0443\u0441\u0442\u0438\u043c current date is \"2019-10-15 12:00\"\n\u0418 go to root page\n\u0422\u043e see red message \"Event Lesson-41 without room to Python-2 group\"\n\u0418 time return\n</code></pre>\n\n<p>I try binding.pry in my scenario and have time i really needed\n<a href=\"https://i.stack.imgur.com/GvGSZ.png\" rel=\"nofollow noreferrer\">In step definitions i have time which i needed</a></p>\n\n<p>But in the same time i binding.pry my endpoint action in controller and have another time of my system! \n<a href=\"https://i.stack.imgur.com/sH2zQ.png\" rel=\"nofollow noreferrer\">Screenshot with time</a></p>\n\n<p>Maybe i do something wrong? or how can i test something about time and output of browser like alert(bootstrap) messages in the same time? </p>\n\n<p>This is what happen in step definitions</p>\n\n<pre><code>\u0414\u043e\u043f\u0443\u0441\u0442\u0438\u043c /^current date is \"([^\"]*)\"/ do |date|\n time_to_travel = Time.parse(date)\n Timecop.travel(time_to_travel)\nend\n\n\u0418 /^time return/ do\n  Timecop.return\nend\n</code></pre>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1571247381, "post_id": 58418765, "comment_id": 103180149, "body": "Tip: Not every variable has to be an instance variable (<code>@</code>-prefixed). Think about which things you want to persist beyond the method call and which are temporary."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1571247428, "post_id": 58418765, "comment_id": 103180171, "body": "You&#39;re doing a lot of <code>each.with_index(0)</code> calls. <code>with_index</code> defaults to <code>0</code>, so you can do <code>each.with_index</code> and ignore the argument."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 1, "creation_date": 1571247482, "post_id": 58418765, "comment_id": 103180190, "body": "It&#39;s not really clear what the comparison is supposed to do. Can you strip out the Postgres stuff and show the data you&#39;re trying to compare? A more complete example in that regard would help a lot. Ruby arrays and hashes can be compared directly if you structure them properly."}], "owner": {"reputation": 13, "user_id": 12161078, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mAHNqZC8b9MJctmhTbjWR5g-AIkMo84yng_fxQCdg=k-s128", "display_name": "Victor Coelho", "link": "https://stackoverflow.com/users/12161078/victor-coelho"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 29, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1571247402, "creation_date": 1571247024, "last_edit_date": 1571247402, "question_id": 58418765, "link": "https://stackoverflow.com/questions/58418765/create-array-with-index-and-compare-from-other-array", "title": "Create array with index, and compare from other array", "body": "<p>I'm trying to create an array with index to search values and compare with another array from <code>pgcon</code>:</p>\n\n<pre><code>@trunks = []\n\n#trunks local\n@trunks_local = []\n\n#dados_local\n@bd_local = {}\n\n@c_local = PG.connect(:hostaddr =&gt; 'myhost', :port =&gt; 5432, :dbname =&gt; \"testdb\", :user =&gt; \"test\", :connect_timeout =&gt; 90)\n\n@bd_local = @c_local.exec(\"SELECT trunk_id, name,phone_number,active FROM callback_trunks\")\n\n@bd_local.each.with_index(0) do |h|\n  @trunks_local &lt;&lt; h\nend\n</code></pre>\n\n<p>This is the comparison:</p>\n\n<pre><code>@trunks.each.with_index(0) do |trunks|\n@trunks_local.each.with_index(0) do |trunk_local|\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "plaid"], "comments": [{"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 1, "creation_date": 1571248992, "post_id": 58418632, "comment_id": 103180844, "body": "<code>.exchange(&#39;[Plaid Link public_token]&#39;)</code> is that literal? If so this is incorrect and I belive you should be submitting your &quot;params[&quot;plaidToken&quot;]&quot; (e.g. <code>client.item.public_token.exchange(params[&quot;plaidToken&quot;])</code>). <code>public_key</code> should come from <i>&quot;...your Plaid dashboard&quot;</i> according to the <a href=\"https://github.com/plaid/plaid-ruby#creating-a-plaid-client\" rel=\"nofollow noreferrer\">Docs</a>"}], "answers": [{"tags": [], "owner": {"reputation": 599, "user_id": 11544569, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xEqDN.jpg?s=128&g=1", "display_name": "RomanOks", "link": "https://stackoverflow.com/users/11544569/romanoks"}, "is_accepted": true, "score": 2, "last_activity_date": 1571299203, "last_edit_date": 1571299203, "creation_date": 1571297989, "answer_id": 58427359, "question_id": 58418632, "link": "https://stackoverflow.com/questions/58418632/plaid-ruby-gem-exchange-token-throwing-provided-public-token-is-in-an-invalid/58427359#58427359", "title": "plaid ruby gem: exchange token throwing &#39;provided public token is in an invalid format&#39; error", "body": "<p>In <code>public_key</code> you must use your key which is listed in the Plaid account. <a href=\"https://dashboard.plaid.com/account/keys\" rel=\"nofollow noreferrer\">https://dashboard.plaid.com/account/keys</a></p>\n\n<pre><code>def set_plaid_token\n  public_token = params[:plaid_token]\n\n  client = Plaid::Client.new(env: :sandbox,\n                       client_id: ENV['plaid_client_id'],\n                          secret: ENV['plaid_secret'],\n                      public_key: ENV['plaid_public_key'])\n\n  exchange_token_response = client.item.public_token.exchange(public_token)\n  access_token = exchange_token_response.access_token\n  ...\nend\n</code></pre>\n\n<p>Link:</p>\n\n<pre><code>let linkHandler = Plaid.create({\n    clientName: 'Name',\n    env: 'sandbox',\n    key: 'your-public-key-from-dashboard',\n    product: ['auth'],\n    onSuccess: function(public_token, metadata) {\n      $.post('/plaid/set_plaid_token', {\n          plaid_token: public_token\n      });\n      console.log('Pub tok = ' + public_token);\n      console.log('Account = ' + metadata.account_id);\n    }\n});\n\ndocument.getElementById('linkButton').onclick = function() {\n   linkHandler.open();\n};\n</code></pre>\n"}], "owner": {"reputation": 509, "user_id": 7254473, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Fkwvm.jpg?s=128&g=1", "display_name": "Jonny B", "link": "https://stackoverflow.com/users/7254473/jonny-b"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 293, "favorite_count": 0, "accepted_answer_id": 58427359, "answer_count": 1, "score": 2, "last_activity_date": 1571299203, "creation_date": 1571246437, "last_edit_date": 1571251274, "question_id": 58418632, "link": "https://stackoverflow.com/questions/58418632/plaid-ruby-gem-exchange-token-throwing-provided-public-token-is-in-an-invalid", "title": "plaid ruby gem: exchange token throwing &#39;provided public token is in an invalid format&#39; error", "body": "<p>I am using Link in React to link to Items and then passing the public_token to my rails server where I'm attempting to exchange the public token for a access token. Link is successfully returning the public token to me which looks like <code>public-sandbox-6df92f82-3260-4cb4-8489-65e6ac955e7a</code> and I am passing that to my rails server where I use the plaid-ruby gem to attempt to exchange tokens. However, I'm getting an <code>INVALID_INPUT</code> error.</p>\n\n<p>plaid-ruby code (<code>params[\"plaidToken\"] == public-sandbox-6df92f82-3260-4cb4-8489-65e6ac955e7a</code>):</p>\n\n<pre><code>  def set_plaid_token\n    client = Plaid::Client.new(env: :sandbox,\n                               client_id: '*******',\n                               secret: '*******',\n                               public_key: params[\"plaidToken\"])\n\n    exchange_token_response = client.item.public_token.exchange('[Plaid Link public_token]')\n    access_token = exchange_token_response.access_token\n\n    #TODO users can add same bank twice.\n    user = UserToken.find_by(token: params[\"userToken\"]).user\n    token = UserToken.new(user_id: user.id, token: access_token, token_type: \"plaid_token\")\n    token.save\n  end\n</code></pre>\n\n<p>The error message below just tells me to format the token like it is already formatted so I'm not sure what else could be wrong.</p>\n\n<p>Error Message:</p>\n\n<pre><code>Plaid::InvalidInputError (\nError Type      : INVALID_INPUT\nError Code      : INVALID_PUBLIC_TOKEN\nError Message   : provided public token is in an invalid format. expected format: public-&lt;environment&gt;-&lt;identifier&gt;\nDisplay Message : \nRequest ID      : vaAqIgjQNZ2Zj07\n):\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 24560, "user_id": 4880924, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/d40e83be235d4f70428da0d42e12d427?s=128&d=identicon&r=PG&f=1", "display_name": "BKSpurgeon", "link": "https://stackoverflow.com/users/4880924/bkspurgeon"}, "edited": false, "score": 0, "creation_date": 1571246493, "post_id": 58418401, "comment_id": 103179723, "body": "Can you set the rails environment to production on your development PC? Have you altered sessions/New in any way?"}, {"owner": {"reputation": 3425, "user_id": 1493116, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/9371f372f90b7c283579b097c67b9cd2?s=128&d=identicon&r=PG", "display_name": "LewlSauce", "link": "https://stackoverflow.com/users/1493116/lewlsauce"}, "reply_to_user": {"reputation": 24560, "user_id": 4880924, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/d40e83be235d4f70428da0d42e12d427?s=128&d=identicon&r=PG&f=1", "display_name": "BKSpurgeon", "link": "https://stackoverflow.com/users/4880924/bkspurgeon"}, "edited": false, "score": 0, "creation_date": 1571246783, "post_id": 58418401, "comment_id": 103179871, "body": "Getting the same error. Troubleshooting it locally as well to see what&#39;s up. Very strange."}], "answers": [{"comments": [{"owner": {"reputation": 3425, "user_id": 1493116, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/9371f372f90b7c283579b097c67b9cd2?s=128&d=identicon&r=PG", "display_name": "LewlSauce", "link": "https://stackoverflow.com/users/1493116/lewlsauce"}, "edited": false, "score": 0, "creation_date": 1571246135, "post_id": 58418540, "comment_id": 103179577, "body": "I just temporarily cleared out the entire <code>devise&#47;sessions&#47;new.html.erb</code> file and the error still shows up. Very weird."}], "tags": [], "owner": {"reputation": 217, "user_id": 5614121, "user_type": "registered", "accept_rate": 18, "profile_image": "https://lh6.googleusercontent.com/-tQHo4e3wPag/AAAAAAAAAAI/AAAAAAAAAzE/tAyftVVFsvc/photo.jpg?sz=128", "display_name": "Elvyn Mejia", "link": "https://stackoverflow.com/users/5614121/elvyn-mejia"}, "is_accepted": false, "score": 0, "last_activity_date": 1571246039, "creation_date": 1571246039, "answer_id": 58418540, "question_id": 58418401, "link": "https://stackoverflow.com/questions/58418401/rails-redirect-loop-in-production-everything-is-fine-in-development/58418540#58418540", "title": "Rails redirect loop in production, everything is fine in development", "body": "<p>Can you show the contents of <code>devise/sessions/new.html.erb</code></p>\n\n<p>It seems you are attempting to access a hash by key  e.g. <code>my_hash[:my_key]</code>  but <code>my_hash</code> in nil  </p>\n"}, {"tags": [], "owner": {"reputation": 3425, "user_id": 1493116, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/9371f372f90b7c283579b097c67b9cd2?s=128&d=identicon&r=PG", "display_name": "LewlSauce", "link": "https://stackoverflow.com/users/1493116/lewlsauce"}, "is_accepted": false, "score": 0, "last_activity_date": 1571248313, "creation_date": 1571248313, "answer_id": 58419063, "question_id": 58418401, "link": "https://stackoverflow.com/questions/58418401/rails-redirect-loop-in-production-everything-is-fine-in-development/58419063#58419063", "title": "Rails redirect loop in production, everything is fine in development", "body": "<p>After troubleshooting this some more, it finally boiled down to a stylesheet ending in <code>.css</code> rather than <code>.css.scss</code> since it was loading some rails stuff. I only came across this because <code>rake assets:precompile</code> kept failing.</p>\n"}], "owner": {"reputation": 3425, "user_id": 1493116, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/9371f372f90b7c283579b097c67b9cd2?s=128&d=identicon&r=PG", "display_name": "LewlSauce", "link": "https://stackoverflow.com/users/1493116/lewlsauce"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 37, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1571248313, "creation_date": 1571245518, "last_edit_date": 1571247547, "question_id": 58418401, "link": "https://stackoverflow.com/questions/58418401/rails-redirect-loop-in-production-everything-is-fine-in-development", "title": "Rails redirect loop in production, everything is fine in development", "body": "<p>I am running into an issue with Rails where in production it generates an error in the log file, but nothing in the development mode:</p>\n\n<pre><code>I, [2019-10-16T12:02:16.953954 #11866]  INFO -- : [e5d5e3b6-2a9c-4d27-b1f3-2d5a1b76ce5a] Started GET \"/\" for 155.186.157.103 at 2019-10-16 12:02:16 -0500\nI, [2019-10-16T12:02:16.955549 #11866]  INFO -- : [e5d5e3b6-2a9c-4d27-b1f3-2d5a1b76ce5a] Processing by Devise::SessionsController#new as HTML\nI, [2019-10-16T12:02:16.956733 #11866]  INFO -- : [e5d5e3b6-2a9c-4d27-b1f3-2d5a1b76ce5a]   Rendering devise/sessions/new.html.erb within layouts/application\nI, [2019-10-16T12:02:16.958443 #11866]  INFO -- : [e5d5e3b6-2a9c-4d27-b1f3-2d5a1b76ce5a]   Rendered devise/shared/_links.html.erb (0.3ms)\nI, [2019-10-16T12:02:16.958796 #11866]  INFO -- : [e5d5e3b6-2a9c-4d27-b1f3-2d5a1b76ce5a]   Rendered devise/sessions/new.html.erb within layouts/application (2.0ms)\nE, [2019-10-16T12:02:29.471353 #11866] ERROR -- : [2c2037b2-3b07-495d-b936-778c070e1ad7] undefined method `[]' for nil:NilClass\nI, [2019-10-16T12:02:29.473147 #11866]  INFO -- : [2c2037b2-3b07-495d-b936-778c070e1ad7] Redirected to [redacted-for-stackoverflow]\nI, [2019-10-16T12:02:29.473928 #11866]  INFO -- : [2c2037b2-3b07-495d-b936-778c070e1ad7] Completed 302 Found in 22438ms (ActiveRecord: 0.0ms)\nE, [2019-10-16T12:02:39.225917 #11866] ERROR -- : [e5d5e3b6-2a9c-4d27-b1f3-2d5a1b76ce5a] undefined method `[]' for nil:NilClass\nI, [2019-10-16T12:02:39.227867 #11866]  INFO -- : [e5d5e3b6-2a9c-4d27-b1f3-2d5a1b76ce5a] Redirected to [redacted-for-stackoverflow]\nI, [2019-10-16T12:02:39.229075 #11866]  INFO -- : [e5d5e3b6-2a9c-4d27-b1f3-2d5a1b76ce5a] Completed 302 Found in 22273ms (ActiveRecord: 0.0ms)\n</code></pre>\n\n<p>However, if I load development mode, the login page comes up just fine. I can't figure out what could possibly be causing this error since the error isn't descriptive as to where the issue resides.</p>\n\n<p>I ran across another post to temporarily change <code>config.consider_all_requests_local       = false</code> to <code>config.consider_all_requests_local       = true</code> in <code>config/environments/production.rb</code> but that hasn't changed anything. No additional information is being provided.</p>\n\n<p>How can I trace down this issue that's only occurring in production?</p>\n\n<p>I have literally replaced everything in <code>layouts/application.html.erb</code> to try pin pointing where the issue is, but no luck. I noticed that <code>rake assets:precompile</code> fails as well with the same error, so perhaps it has some kind of issue in there.</p>\n"}, {"tags": ["ruby", "rspec", "factory-bot"], "comments": [{"owner": {"reputation": 482, "user_id": 3609100, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/6fte8.png?s=128&g=1", "display_name": "Krzysztof Witczak", "link": "https://stackoverflow.com/users/3609100/krzysztof-witczak"}, "edited": false, "score": 1, "creation_date": 1571244143, "post_id": 58418012, "comment_id": 103178705, "body": "Have you tried using before :each instead of before :all?"}, {"owner": {"reputation": 350, "user_id": 9498724, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zelZl.jpg?s=128&g=1", "display_name": "Ruslan Valeev", "link": "https://stackoverflow.com/users/9498724/ruslan-valeev"}, "reply_to_user": {"reputation": 482, "user_id": 3609100, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/6fte8.png?s=128&g=1", "display_name": "Krzysztof Witczak", "link": "https://stackoverflow.com/users/3609100/krzysztof-witczak"}, "edited": false, "score": 0, "creation_date": 1571282432, "post_id": 58418012, "comment_id": 103190740, "body": "Yes I have, but nothing changed"}, {"owner": {"reputation": 116, "user_id": 11236159, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb476ec41be9fb66aad685837f837047?s=128&d=identicon&r=PG&f=1", "display_name": "IlyaOsotov", "link": "https://stackoverflow.com/users/11236159/ilyaosotov"}, "edited": false, "score": 0, "creation_date": 1571296788, "post_id": 58418012, "comment_id": 103195231, "body": "Please, show your spec_helper.rb file"}, {"owner": {"reputation": 350, "user_id": 9498724, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zelZl.jpg?s=128&g=1", "display_name": "Ruslan Valeev", "link": "https://stackoverflow.com/users/9498724/ruslan-valeev"}, "edited": false, "score": 0, "creation_date": 1571307673, "post_id": 58418012, "comment_id": 103201301, "body": "Added spec_helper.rb to question body"}, {"owner": {"reputation": 482, "user_id": 3609100, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/6fte8.png?s=128&g=1", "display_name": "Krzysztof Witczak", "link": "https://stackoverflow.com/users/3609100/krzysztof-witczak"}, "edited": false, "score": 0, "creation_date": 1571328291, "post_id": 58418012, "comment_id": 103213487, "body": "Have you tried using this: <a href=\"https://github.com/DatabaseCleaner/database_cleaner\" rel=\"nofollow noreferrer\">github.com/DatabaseCleaner/database_cleaner</a>?"}, {"owner": {"reputation": 350, "user_id": 9498724, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zelZl.jpg?s=128&g=1", "display_name": "Ruslan Valeev", "link": "https://stackoverflow.com/users/9498724/ruslan-valeev"}, "edited": false, "score": 0, "creation_date": 1571331082, "post_id": 58418012, "comment_id": 103214727, "body": "I have no database. Object initializing with build and therefore I don&#39;t use Database cleaner"}, {"owner": {"reputation": 14010, "user_id": 3109182, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/a4b305f0077055b4fdcf715067775d5a?s=128&d=identicon&r=PG", "display_name": "Anthony", "link": "https://stackoverflow.com/users/3109182/anthony"}, "edited": false, "score": 0, "creation_date": 1571344170, "post_id": 58418012, "comment_id": 103220269, "body": "you have both <code>allow(Message).to receive(:new).and_return(message)</code> and <code>expect(Message).to have_received(:new).exactly(expected_message_count).times</code> - you need to pick."}, {"owner": {"reputation": 13378, "user_id": 1430810, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/v669u.jpg?s=128&g=1", "display_name": "arieljuod", "link": "https://stackoverflow.com/users/1430810/arieljuod"}, "edited": false, "score": 0, "creation_date": 1571456194, "post_id": 58418012, "comment_id": 103257060, "body": "Clean your test database and then try setting the <code>use_transactional_fixtures</code> config to true <a href=\"https://relishapp.com/rspec/rspec-rails/docs/transactions\" rel=\"nofollow noreferrer\">relishapp.com/rspec/rspec-rails/docs/transactions</a>"}, {"owner": {"reputation": 350, "user_id": 9498724, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zelZl.jpg?s=128&g=1", "display_name": "Ruslan Valeev", "link": "https://stackoverflow.com/users/9498724/ruslan-valeev"}, "edited": false, "score": 0, "creation_date": 1571545502, "post_id": 58418012, "comment_id": 103274021, "body": "Friends! Thank you very much, but let me remind you, there is no rails, there is no database. And this solutions doesn&#39;t work here (I tried) because it is for rails and database apps only."}], "owner": {"reputation": 350, "user_id": 9498724, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zelZl.jpg?s=128&g=1", "display_name": "Ruslan Valeev", "link": "https://stackoverflow.com/users/9498724/ruslan-valeev"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 173, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1571307650, "creation_date": 1571243964, "last_edit_date": 1571307650, "question_id": 58418012, "link": "https://stackoverflow.com/questions/58418012/rspec-doesnt-clear-factory-objects-after-some-specs", "title": "Rspec doesn&#39;t clear factory objects after some specs", "body": "<p>Im using clear ruby (ruby 2.3.5) without Rails and ActiveRecord and trying to write specs for some service. And if I run only part of file (including problem spec), it passed. If I run the whole file - the problem spec is failed.</p>\n\n<p>By the way, I already use rspec/retry, and it settings for 20 times retry (And I see in logs, that the problem spec is failed in all 20 times).</p>\n\n<p>ballot_spec.rb</p>\n\n<pre><code># frozen_string_literal: true\n\nrequire 'spec_helper'\nrequire 'byebug'\n\nRSpec.describe Ballot do\n  describe '#run' do\n    let(:kingdoms) { build_list(:kingdom, 6) }\n    let(:service) { described_class.new(kingdoms) }\n    before { allow(service).to receive(:hold_ballot) }\n    it 'holds ballot if cannot_finish_ballot? returns true' do\n      allow(service).to receive(:cannot_finish_ballot?).and_return(true)\n      service.run\n      expect(service).to have_received(:hold_ballot).at_least(:once)\n    end\n    it \"doesn't hold ballot if cannot_finish_ballot? returns false\" do\n      allow(service).to receive(:cannot_finish_ballot?).and_return(false)\n      service.run\n      expect(service).not_to have_received(:hold_ballot)\n    end\n    it 'returns Struct object' do\n      expect(service.run.class.superclass).to be Struct\n    end\n  end\n\n  describe '#hold_ballot' do\n    let(:all_kingdoms) { build_list(:kingdom, rand(2..10)) }\n    let(:pretendents) { all_kingdoms.first(rand(2..all_kingdoms.count)) }\n    let(:message) { build(:message, from: all_kingdoms.sample, to: all_kingdoms.sample) }\n    let(:expected_message_count) { pretendents.count * all_kingdoms.count }\n    let(:new_service) { described_class.new(pretendents) }\n\n    before do\n      allow(Message).to receive(:new).and_return(message)\n      allow(message).to receive(:send)\n      new_service.send('hold_ballot')\n    end\n\n\\/\\/ THE PROBLEM IS IN THIS SPEC \\/\\/\n    it 'prepares messages to all existed kingdoms from every pretendent' do\n      expect(Message).to have_received(:new).exactly(expected_message_count).times\n    end\n    it 'only 6 of messages will be selected to be sent' do\n      expect(message).to have_received(:send).exactly(6).times\n    end\n    it 'resets Kingdoms' do\n      allow(Kingdom).to receive(:reset)\n      new_service.run\n      expect(Kingdom).to have_received(:reset).at_least(:once)\n    end\n  end\nend\n</code></pre>\n\n<p>when I run rspec spec/services/ballot_spec.rb:26 (for test whole method '#hold_ballot') every spec is passed.\nwhen I run rspec spec/services/ballot_spec.rb, I got failure:</p>\n\n<pre><code>  1) Ballot#hold_ballot prepares messages to all existed kingdoms from every pretendent\n     Failure/Error: expect(Message).to have_received(:new).exactly(expected_message_count).times\n\n       (Message (class)).new(*(any args))\n           expected: 4 times with any arguments\n           received: 260 times with any arguments\n</code></pre>\n\n<p>when I use byebug, I see, that class Kingdom has dozens of objects, but variables \"all_kingdoms\" and \"pretendents\" contains not more than 10 objects.</p>\n\n<p>So the once rootcause I can see here - rspec doesn't clear kingdoms, created during testing method '#run', but how to push it destroy them? I don't use ActiveRecord, don't use Rails, so cannot tun \"reload!\" or \"destroy\" explicitly. Tried to run GC.start, but it doesn't help. What can I do? Many thanks! )</p>\n\n<p>spec_helper.rb</p>\n\n<pre><code># frozen_string_literal: true\n\nrequire './models/kingdom.rb'\nrequire './models/message.rb'\nrequire './services/message_compose.rb'\nrequire 'factory_bot'\nrequire 'ffaker'\nrequire 'capybara'\nrequire 'rspec/retry'\nrequire './spec/factories/kingdom.rb'\nrequire './spec/factories/message.rb'\n\nRSpec.configure do |config|\n  config.verbose_retry = true\n  config.display_try_failure_messages = true\n  config.around :each do |ex|\n    ex.run_with_retry retry: 20 unless ex.run_with_retry\n  end\n  config.include FactoryBot::Syntax::Methods\n\n  config.expect_with :rspec do |expectations|\n    expectations.include_chain_clauses_in_custom_matcher_descriptions = true\n  end\n  config.mock_with :rspec do |mocks|\n    mocks.verify_partial_doubles = true\n  end\n  config.shared_context_metadata_behavior = :apply_to_host_groups\nend\n</code></pre>\n"}, {"tags": ["ruby", "include"], "comments": [{"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 2, "creation_date": 1571241450, "post_id": 58417338, "comment_id": 103177440, "body": "Do you just want to skip every other line or actually detect &quot;lorem ipsum&quot; as the title implies?"}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1571242194, "post_id": 58417338, "comment_id": 103177788, "body": "Whenever you give an example <i>always</i> show the desired result (i.e., return value). Please edit."}, {"owner": {"reputation": 1, "user_id": 11726285, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93d37f8f25d5f1050b21744c55a389f4?s=128&d=identicon&r=PG&f=1", "display_name": "downwiththe.click", "link": "https://stackoverflow.com/users/11726285/downwiththe-click"}, "edited": false, "score": 0, "creation_date": 1571243444, "post_id": 58417338, "comment_id": 103178355, "body": "Okay I edited the question a bit. Let me know if it makes sense now"}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1571302287, "post_id": 58417338, "comment_id": 103198119, "body": "When you say <i>&quot;I need to detect the Lorem Ipsum in every other line and skip it&quot;</i> \u2013 what does <i>&quot;detect the Lorem Ipsum&quot;</i> mean? Why not just skip every other line?"}], "answers": [{"comments": [{"owner": {"reputation": 13442, "user_id": 3982562, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2a3c7aae1d762372cda697833c602ec8?s=128&d=identicon&r=PG", "display_name": "3limin4t0r", "link": "https://stackoverflow.com/users/3982562/3limin4t0r"}, "edited": false, "score": 1, "creation_date": 1571242583, "post_id": 58417370, "comment_id": 103177967, "body": "<code>i % 2 == 0</code> could also be written as <code>i.even?</code>"}, {"owner": {"reputation": 2251, "user_id": 9785060, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IUduC.png?s=128&g=1", "display_name": "Viktor", "link": "https://stackoverflow.com/users/9785060/viktor"}, "reply_to_user": {"reputation": 13442, "user_id": 3982562, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2a3c7aae1d762372cda697833c602ec8?s=128&d=identicon&r=PG", "display_name": "3limin4t0r", "link": "https://stackoverflow.com/users/3982562/3limin4t0r"}, "edited": false, "score": 0, "creation_date": 1571242635, "post_id": 58417370, "comment_id": 103177984, "body": "@3limin4t0r Thanks for the suggestion"}, {"owner": {"reputation": 2251, "user_id": 9785060, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IUduC.png?s=128&g=1", "display_name": "Viktor", "link": "https://stackoverflow.com/users/9785060/viktor"}, "reply_to_user": {"reputation": 13442, "user_id": 3982562, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2a3c7aae1d762372cda697833c602ec8?s=128&d=identicon&r=PG", "display_name": "3limin4t0r", "link": "https://stackoverflow.com/users/3982562/3limin4t0r"}, "edited": false, "score": 0, "creation_date": 1571243232, "post_id": 58417370, "comment_id": 103178250, "body": "I tried to make a version that checks the full Lorem Ipsum text for each line in the file that OP provided and skips the line if it&#39;s included in the Lorem text, but I couldn&#39;t find the full text. Every version I found didn&#39;t contain the second sentence from OP&#39;s question."}, {"owner": {"reputation": 1, "user_id": 11726285, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93d37f8f25d5f1050b21744c55a389f4?s=128&d=identicon&r=PG&f=1", "display_name": "downwiththe.click", "link": "https://stackoverflow.com/users/11726285/downwiththe-click"}, "edited": false, "score": 0, "creation_date": 1571243465, "post_id": 58417370, "comment_id": 103178368, "body": "I changed the Lorem Ipsum text"}, {"owner": {"reputation": 2251, "user_id": 9785060, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IUduC.png?s=128&g=1", "display_name": "Viktor", "link": "https://stackoverflow.com/users/9785060/viktor"}, "reply_to_user": {"reputation": 1, "user_id": 11726285, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93d37f8f25d5f1050b21744c55a389f4?s=128&d=identicon&r=PG&f=1", "display_name": "downwiththe.click", "link": "https://stackoverflow.com/users/11726285/downwiththe-click"}, "edited": false, "score": 0, "creation_date": 1571243778, "post_id": 58417370, "comment_id": 103178508, "body": "@downwiththe.click These solutions still produce the expected output :)"}, {"owner": {"reputation": 2251, "user_id": 9785060, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IUduC.png?s=128&g=1", "display_name": "Viktor", "link": "https://stackoverflow.com/users/9785060/viktor"}, "reply_to_user": {"reputation": 1, "user_id": 11726285, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93d37f8f25d5f1050b21744c55a389f4?s=128&d=identicon&r=PG&f=1", "display_name": "downwiththe.click", "link": "https://stackoverflow.com/users/11726285/downwiththe-click"}, "edited": false, "score": 0, "creation_date": 1571244400, "post_id": 58417370, "comment_id": 103178808, "body": "@downwiththe.click I added a third solution, keep in mind the Lorem Ipsum lines from the example have to be contained in the Lorem Ipsum text :)"}, {"owner": {"reputation": 1, "user_id": 11726285, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93d37f8f25d5f1050b21744c55a389f4?s=128&d=identicon&r=PG&f=1", "display_name": "downwiththe.click", "link": "https://stackoverflow.com/users/11726285/downwiththe-click"}, "edited": false, "score": 0, "creation_date": 1571244927, "post_id": 58417370, "comment_id": 103179041, "body": "Thanks! I&#39;m trying to method chain and I think my method is getting too large! Thank you so much. I&#39;m a bit confused I&#39;m a new coder. The problem is i will be tested against a file that may have different Lorem text so I&#39;m not sure whats the best way to go about this"}, {"owner": {"reputation": 2251, "user_id": 9785060, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IUduC.png?s=128&g=1", "display_name": "Viktor", "link": "https://stackoverflow.com/users/9785060/viktor"}, "reply_to_user": {"reputation": 1, "user_id": 11726285, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93d37f8f25d5f1050b21744c55a389f4?s=128&d=identicon&r=PG&f=1", "display_name": "downwiththe.click", "link": "https://stackoverflow.com/users/11726285/downwiththe-click"}, "edited": false, "score": 0, "creation_date": 1571245028, "post_id": 58417370, "comment_id": 103179079, "body": "@downwiththe.click Why can&#39;t you use my first solution, which skips every second line? It&#39;s the most simple approach"}, {"owner": {"reputation": 1, "user_id": 11726285, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93d37f8f25d5f1050b21744c55a389f4?s=128&d=identicon&r=PG&f=1", "display_name": "downwiththe.click", "link": "https://stackoverflow.com/users/11726285/downwiththe-click"}, "edited": false, "score": 0, "creation_date": 1571245913, "post_id": 58417370, "comment_id": 103179491, "body": "I started there and I got an error that says: ArgumentError: wrong number of arguments (given 1, expected 0)"}, {"owner": {"reputation": 2251, "user_id": 9785060, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IUduC.png?s=128&g=1", "display_name": "Viktor", "link": "https://stackoverflow.com/users/9785060/viktor"}, "reply_to_user": {"reputation": 1, "user_id": 11726285, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93d37f8f25d5f1050b21744c55a389f4?s=128&d=identicon&r=PG&f=1", "display_name": "downwiththe.click", "link": "https://stackoverflow.com/users/11726285/downwiththe-click"}, "edited": false, "score": 0, "creation_date": 1571349854, "post_id": 58417370, "comment_id": 103222188, "body": "@downwiththe.click On which line of code did you get the error ? Can you be more specific? I tested the code and it doesn&#39;t raise and error"}], "tags": [], "owner": {"reputation": 2251, "user_id": 9785060, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IUduC.png?s=128&g=1", "display_name": "Viktor", "link": "https://stackoverflow.com/users/9785060/viktor"}, "is_accepted": false, "score": 3, "last_activity_date": 1571244317, "last_edit_date": 1571244317, "creation_date": 1571241447, "answer_id": 58417370, "question_id": 58417338, "link": "https://stackoverflow.com/questions/58417338/ignore-lorem-ipsum-text-in-a-file-ruby/58417370#58417370", "title": "Ignore Lorem Ipsum text in a file Ruby", "body": "<p>If you just want to skip every second line you can do something like this:</p>\n\n<pre><code>File.open(\"text.txt\", \"r\") do |f|\n  f.each_line.with_index do |line, i|\n    next unless i.even?\n    puts line\n  end\nend\n\n#Spade, Kate\n#Vuitton, Louis\n#Bucks, Star\n#Cage, Nicholas\n#Brown, James\n</code></pre>\n\n<p>Now I'm not really good with regexp, but you could also do something like this to process only the lines that are two words, both starting with a capital letter separated by a comma and space (basically first name and last name):</p>\n\n<pre><code>File.open(\"text.txt\", \"r\") do |f|\n  f.each_line do |line|\n    next unless line =~ /[A-Z][a-z]+, [A-Z][a-z]+/\n    puts line\n  end\nend\n\n#Spade, Kate\n#Vuitton, Louis\n#Bucks, Star\n#Cage, Nicholas\n#Brown, James\n</code></pre>\n\n<p>You could also load the full Lorem Ipsum text from a file like this:</p>\n\n<pre><code>lorem = File.open(\"lorem.txt\", \"r\").map(&amp;:chomp).join(\" \")\n</code></pre>\n\n<p>And then check each line if it's contained in the Lorem Ipsum text:</p>\n\n<pre><code>File.open(\"text.txt\", \"r\") do |f|\n  f.each_line do |line|\n    next if lorem.include?(line[0...-1]) #removing the last character because you seem to have a dot at the end even though in the lorem text there's no dot on these positions.\n    puts line\n  end\nend\n\n#Spade, Kate\n#Vuitton, Louis\n#Bucks, Star\n#Cage, Nicholas\n#Brown, James\n</code></pre>\n\n<p>Now depending on what you want to do with the data you can replace the <code>puts line</code> line with something else.</p>\n"}, {"tags": [], "owner": {"reputation": 63078, "user_id": 220147, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b3881a28fe402dd2d1de44717486cae8?s=128&d=identicon&r=PG", "display_name": "Michael Kohl", "link": "https://stackoverflow.com/users/220147/michael-kohl"}, "is_accepted": false, "score": 1, "last_activity_date": 1571242652, "creation_date": 1571242652, "answer_id": 58417705, "question_id": 58417338, "link": "https://stackoverflow.com/questions/58417338/ignore-lorem-ipsum-text-in-a-file-ruby/58417705#58417705", "title": "Ignore Lorem Ipsum text in a file Ruby", "body": "<p>Your description is unclear. If you just want to skip every other line, you can do something like this:</p>\n\n<pre><code>File.foreach(\"test.txt\").with_index(1) do |l, i|\n  next if i.even?\n  puts l\nend\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 73209, "user_id": 290394, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/d7908f05c89e965f6bc5308ad6f41256?s=128&d=identicon&r=PG", "display_name": "steenslag", "link": "https://stackoverflow.com/users/290394/steenslag"}, "is_accepted": false, "score": 3, "last_activity_date": 1571243057, "creation_date": 1571243057, "answer_id": 58417809, "question_id": 58417338, "link": "https://stackoverflow.com/questions/58417338/ignore-lorem-ipsum-text-in-a-file-ruby/58417809#58417809", "title": "Ignore Lorem Ipsum text in a file Ruby", "body": "<p>Reading 2 lines and ignoring the second:</p>\n\n<pre><code>File.open(\"test.txt\", \"r\") do |f|\n  f.each_slice(2) do |odd, _even|\n    puts odd\n  end\nend\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "is_accepted": false, "score": 0, "last_activity_date": 1571291955, "creation_date": 1571291955, "answer_id": 58425839, "question_id": 58417338, "link": "https://stackoverflow.com/questions/58417338/ignore-lorem-ipsum-text-in-a-file-ruby/58425839#58425839", "title": "Ignore Lorem Ipsum text in a file Ruby", "body": "<p>Let's first create a file.</p>\n\n<pre><code>FName = 'temp.txt'\n</code></pre>\n\n<h1><p></p></h1>\n\n<pre><code>IO.write(FName,\n&lt;&lt;~END\nSpade, Kate\nVoluptatem ipsam et at.\nVuitton, Louis\nFacere et necessitatibus animi.\nBucks, Star\nEveniet temporibus ducimus amet eaque.\nCage, Nicholas\nUnde voluptas sit fugit.\nBrown, James\nMaiores ab officia sed.\nEND\n)\n  #=&gt; 211 \n</code></pre>\n\n<p>Here's one way to return every other line.</p>\n\n<pre><code>IO.foreach(FName).each_slice(2).map(&amp;:first)\n  #=&gt; [\"Spade, Kate\\n\", \"Vuitton, Louis\\n\", \"Bucks, Star\\n\",\n  #    \"Cage, Nicholas\\n\", \"Brown, James\\n\"]\n</code></pre>\n\n<p>See <a href=\"https://ruby-doc.org/core-2.6.3/IO.html#method-c-write\" rel=\"nofollow noreferrer\">IO::write</a>, <a href=\"https://ruby-doc.org/core-2.6.3/IO.html#method-c-foreach\" rel=\"nofollow noreferrer\">IO::foreach</a>, <a href=\"https://ruby-doc.org/core-2.6.3/Enumerable.html#method-i-each_slice\" rel=\"nofollow noreferrer\">Enumerable#each_slice</a> and <a href=\"https://ruby-doc.org/core-2.6.3/Array.html#method-i-map\" rel=\"nofollow noreferrer\">Array#map</a>.</p>\n\n<p>Note that <code>foreach</code>, <code>each_slice</code> and <code>map</code> all return enumerators when they are not given block. We therefore obtain the following:</p>\n\n<pre><code>enum0 = IO.foreach(FName)\n  #=&gt; #&lt;Enumerator: IO:foreach(\"temp.txt\")&gt; \nenum1 = enum0.each_slice(2)\n  #=&gt; #&lt;Enumerator: #&lt;Enumerator: IO:foreach(\"temp.txt\")&gt;:each_slice(2)&gt; \nenum2 = enum1.map\n  #=&gt; #&lt;Enumerator: #&lt;Enumerator: #&lt;Enumerator: IO:foreach(\"temp.txt\")&gt;\n  #     :each_slice(2)&gt;:map&gt; \nenum2.each(&amp;:first)\n  #=&gt; [\"Spade, Kate\\n\", \"Vuitton, Louis\\n\", \"Bucks, Star\\n\",\n  #    \"Cage, Nicholas\\n\", \"Brown, James\\n\"] \n</code></pre>\n\n<p>Examine the return values for the calculation of <code>enum1</code> and <code>enum2</code>. It may be helpful to think of these as These could be thought of as <em>compound</em> enumerators.</p>\n\n<p>Two other ways:</p>\n\n<pre><code>enum = [true, false].cycle\n  #=&gt; #&lt;Enumerator: [true, false]:cycle&gt; \nIO.foreach(FName).select { enum.next }\n  #=&gt; &lt;as above&gt;\n\nkeep = false\nIO.foreach(FName).select { keep = !keep }\n  #=&gt; &lt;as above&gt;\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 11726285, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93d37f8f25d5f1050b21744c55a389f4?s=128&d=identicon&r=PG&f=1", "display_name": "downwiththe.click", "link": "https://stackoverflow.com/users/11726285/downwiththe-click"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 57, "favorite_count": 0, "answer_count": 4, "score": 0, "last_activity_date": 1571291955, "creation_date": 1571241321, "last_edit_date": 1571243232, "question_id": 58417338, "link": "https://stackoverflow.com/questions/58417338/ignore-lorem-ipsum-text-in-a-file-ruby", "title": "Ignore Lorem Ipsum text in a file Ruby", "body": "<p>I have a .txt file that has last name, first name on one line and on every other line I have Lorem Ipsum text. I need to detect the Lorem Ipsum in every other line and skip it.</p>\n\n<p>example txt.file</p>\n\n<pre><code>Spade, Kate\nVoluptatem ipsam et at.\nVuitton, Louis\nFacere et necessitatibus animi.\nBucks, Star\nEveniet temporibus ducimus amet eaque.\nCage, Nicholas\nUnde voluptas sit fugit.\nBrown, James\nMaiores ab officia sed.\n</code></pre>\n\n<p>expected output:</p>\n\n<pre><code>#Spade, Kate\n#Vuitton, Louis\n#Bucks, Star\n#Cage, Nicholas\n#Brown, James\n</code></pre>\n"}, {"tags": ["ruby", "gitlab", "jekyll", "gitlab-ci"], "comments": [{"owner": {"reputation": 18079, "user_id": 503402, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/873ad707fb34aac8fbdfbfec676e02e9?s=128&d=identicon&r=PG", "display_name": "Max", "link": "https://stackoverflow.com/users/503402/max"}, "edited": false, "score": 0, "creation_date": 1571240275, "post_id": 58416972, "comment_id": 103176838, "body": "Look at your browser&#39;s developer console: <code>Loading failed for the &lt;script&gt; with source \u201chttps:&#47;&#47;unveiled_adri.gitlab.io&#47;assets&#47;javascripts&#47;main.js\u201d</code>"}, {"owner": {"reputation": 141, "user_id": 10682895, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nNBpS.jpg?s=128&g=1", "display_name": "Adri&#225;n Jaramillo", "link": "https://stackoverflow.com/users/10682895/adri%c3%a1n-jaramillo"}, "reply_to_user": {"reputation": 18079, "user_id": 503402, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/873ad707fb34aac8fbdfbfec676e02e9?s=128&d=identicon&r=PG", "display_name": "Max", "link": "https://stackoverflow.com/users/503402/max"}, "edited": false, "score": 0, "creation_date": 1571240598, "post_id": 58416972, "comment_id": 103177011, "body": "I saw it yes, but I don&#39;t know what this means. I can&#39;t understand where this problem is coming from and how to solve it :/"}, {"owner": {"reputation": 18079, "user_id": 503402, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/873ad707fb34aac8fbdfbfec676e02e9?s=128&d=identicon&r=PG", "display_name": "Max", "link": "https://stackoverflow.com/users/503402/max"}, "edited": false, "score": 0, "creation_date": 1571240932, "post_id": 58416972, "comment_id": 103177187, "body": "Probably the CSS/javascript files are not ending up in right location, or the paths for loading those files in gitlab are looking in the wrong place. You need to make sure you&#39;re putting these files in the right place in the repo and that you&#39;re specifying their location in a way that is portable"}, {"owner": {"reputation": 141, "user_id": 10682895, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nNBpS.jpg?s=128&g=1", "display_name": "Adri&#225;n Jaramillo", "link": "https://stackoverflow.com/users/10682895/adri%c3%a1n-jaramillo"}, "reply_to_user": {"reputation": 18079, "user_id": 503402, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/873ad707fb34aac8fbdfbfec676e02e9?s=128&d=identicon&r=PG", "display_name": "Max", "link": "https://stackoverflow.com/users/503402/max"}, "edited": false, "score": 0, "creation_date": 1571241193, "post_id": 58416972, "comment_id": 103177319, "body": "Well I didn&#39;t anything, I&#39;m just creating the markdown files and generating the files with jekyll, and in the config I changed the theme. That&#39;s basically all I did, but when I deploy this, it&#39;s broken. Locally it&#39;s working but with the docker vm in gitlab is not working, so I guess that something is happening, but I really can&#39;t tell"}, {"owner": {"reputation": 18763, "user_id": 472495, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/4rtxd.png?s=128&g=1", "display_name": "halfer", "link": "https://stackoverflow.com/users/472495/halfer"}, "edited": false, "score": 0, "creation_date": 1571335345, "post_id": 58416972, "comment_id": 103216590, "body": "Please read <a href=\"//meta.stackoverflow.com/q/326569\">Under what circumstances may I add \u201curgent\u201d or other similar phrases to my question, in order to obtain faster answers?</a> - the summary is that this is not an ideal way to address volunteers, and is probably counterproductive to obtaining answers. Please refrain from adding this to your questions."}, {"owner": {"reputation": 141, "user_id": 10682895, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nNBpS.jpg?s=128&g=1", "display_name": "Adri&#225;n Jaramillo", "link": "https://stackoverflow.com/users/10682895/adri%c3%a1n-jaramillo"}, "edited": false, "score": 0, "creation_date": 1571336881, "post_id": 58416972, "comment_id": 103217208, "body": "Thanks for the suggestion I&#39;ll take that into account for my next posts. I was just running out of time and I desperately looked for help"}], "answers": [{"comments": [{"owner": {"reputation": 46692, "user_id": 1548376, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qCZQw.gif?s=128&g=1", "display_name": "David Jacquel", "link": "https://stackoverflow.com/users/1548376/david-jacquel"}, "edited": false, "score": 1, "creation_date": 1571253639, "post_id": 58417775, "comment_id": 103182859, "body": "Tip of the day : <a href=\"https://stackoverflow.com/questions/27386169/change-site-url-to-localhost-during-jekyll-local-development/27400343#27400343\" title=\"change site url to localhost during jekyll local development\">stackoverflow.com/questions/27386169/&hellip;</a>"}], "tags": [], "owner": {"reputation": 141, "user_id": 10682895, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nNBpS.jpg?s=128&g=1", "display_name": "Adri&#225;n Jaramillo", "link": "https://stackoverflow.com/users/10682895/adri%c3%a1n-jaramillo"}, "is_accepted": false, "score": 1, "last_activity_date": 1571245018, "last_edit_date": 1571245018, "creation_date": 1571242901, "answer_id": 58417775, "question_id": 58416972, "link": "https://stackoverflow.com/questions/58416972/css-styles-and-links-are-not-working-on-jekyll-deployment-with-gitlab-ci/58417775#58417775", "title": "CSS styles and links are not working on jekyll deployment with gitlab CI", "body": "<h2>SOLUTION</h2>\n\n<p>I just needed to change this in _config.yml</p>\n\n<pre><code>baseurl: \"/jekyll_project\" # the subpath of your site, e.g. /blog\nurl: \"https://unveiled_adri.gitlab.io/\" # the base hostname &amp; protocol for your site, e.g. http://example.com\n\n</code></pre>\n\n<p>When I was first testing this locally I didn't need to fill this fields, but since now I am deploying the website on gitlab pages hosting, then I needed to fill the fields. I found this solution thanks to this post <a href=\"https://gitlab.com/pages/jekyll/issues/22\" rel=\"nofollow noreferrer\">https://gitlab.com/pages/jekyll/issues/22</a></p>\n\n<p>Finally yep, it works, but I don't really understand why this is working. If someone could comment on this answer and explain to me what happened I would be really glad, I always want to learn what is happening and why! &lt;3</p>\n"}], "owner": {"reputation": 141, "user_id": 10682895, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nNBpS.jpg?s=128&g=1", "display_name": "Adri&#225;n Jaramillo", "link": "https://stackoverflow.com/users/10682895/adri%c3%a1n-jaramillo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 217, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1571335326, "creation_date": 1571240101, "last_edit_date": 1571335326, "question_id": 58416972, "link": "https://stackoverflow.com/questions/58416972/css-styles-and-links-are-not-working-on-jekyll-deployment-with-gitlab-ci", "title": "CSS styles and links are not working on jekyll deployment with gitlab CI", "body": "<p><a href=\"https://stackoverflow.com/questions/58403499/using-jekyll-with-gitlab-pages-it-says-when-its-deploying-the-website-with-git/58406923#58406923\">This question</a> was the start of the problems, but that was solved, and now I have another one.</p>\n\n<p>After having problems saying that the theme could not be found, when I solved the issue, now the webpage is deployed but CSS styles and links are not working. I know this deployment can be done, in my local vm it worked, and it's a really simple page with a basic theme (not the default, but still basic).</p>\n\n<p>If you want to see the code, you can <a href=\"https://gitlab.com/unveiled_adri/jekyll_project\" rel=\"nofollow noreferrer\">see my repo here</a>. If you want to check out the website, <a href=\"https://unveiled_adri.gitlab.io/jekyll_project/\" rel=\"nofollow noreferrer\">you can do it here</a>.</p>\n\n<h2>Edit</h2>\n\n<p>Here you have all the output of the job in gitlab which deployed the web</p>\n\n<pre><code>Running with gitlab-runner 12.3.0 (a8a019e0)\n  on docker-auto-scale ed2dce3a\nUsing Docker executor with image ruby:2.5 ...\nPulling docker image ruby:2.5 ...\nUsing docker image sha256:092689b795107d1b2eadb82494acf4764191baa0aa5bf4673b8ee2a50f70ba97 for ruby:2.5 ...\nRunning on runner-ed2dce3a-project-14628881-concurrent-0 via runner-ed2dce3a-srm-1571224453-869b1d6e...\nFetching changes with git depth set to 50...\nInitialized empty Git repository in /builds/unveiled_adri/jekyll_project/.git/\nCreated fresh repository.\nFrom https://gitlab.com/unveiled_adri/jekyll_project\n * [new ref]         refs/pipelines/89187526 -&gt; refs/pipelines/89187526\n * [new branch]      master                  -&gt; origin/master\nChecking out 94a836f5 as master...\n\nSkipping Git submodules setup\n$ gem install jekyll\nSuccessfully installed public_suffix-4.0.1\nSuccessfully installed addressable-2.7.0\nSuccessfully installed colorator-1.1.0\nBuilding native extensions. This could take a while...\nSuccessfully installed http_parser.rb-0.6.0\nBuilding native extensions. This could take a while...\nSuccessfully installed eventmachine-1.2.7\nSuccessfully installed em-websocket-0.5.1\nSuccessfully installed concurrent-ruby-1.1.5\n\nHEADS UP! i18n 1.1 changed fallbacks to exclude default locale.\nBut that may break your application.\n\nPlease check your Rails app for 'config.i18n.fallbacks = true'.\nIf you're using I18n (&gt;= 1.1.0) and Rails (&lt; 5.2.2), this should be\n'config.i18n.fallbacks = [I18n.default_locale]'.\nIf not, fallbacks will be broken in your app by I18n 1.1.x.\n\nFor more info see:\nhttps://github.com/svenfuchs/i18n/releases/tag/v1.1.0\n\nSuccessfully installed i18n-1.7.0\nBuilding native extensions. This could take a while...\nSuccessfully installed ffi-1.11.1\nBuilding native extensions. This could take a while...\nSuccessfully installed sassc-2.2.1\nSuccessfully installed jekyll-sass-converter-2.0.1\nSuccessfully installed rb-fsevent-0.10.3\nSuccessfully installed rb-inotify-0.10.0\nSuccessfully installed listen-3.2.0\nSuccessfully installed jekyll-watch-2.2.1\nSuccessfully installed kramdown-2.1.0\nSuccessfully installed kramdown-parser-gfm-1.1.0\nSuccessfully installed liquid-4.0.3\nSuccessfully installed mercenary-0.3.6\nSuccessfully installed forwardable-extended-2.6.0\nSuccessfully installed pathutil-0.16.2\nSuccessfully installed rouge-3.12.0\nSuccessfully installed safe_yaml-1.0.5\nSuccessfully installed unicode-display_width-1.6.0\nSuccessfully installed terminal-table-1.8.0\n-------------------------------------------------------------------------------------\nJekyll 4.0 comes with some major changes, notably:\n\n  * Our `link` tag now comes with the `relative_url` filter incorporated into it.\n    You should no longer prepend `{{ site.baseurl }}` to `{% link foo.md %}`\n    For further details: https://github.com/jekyll/jekyll/pull/6727\n\n  * Our `post_url` tag now comes with the `relative_url` filter incorporated into it.\n    You shouldn't prepend `{{ site.baseurl }}` to `{% post_url 2019-03-27-hello %}`\n    For further details: https://github.com/jekyll/jekyll/pull/7589\n\n  * Support for deprecated configuration options has been removed. We will no longer\n    output a warning and gracefully assign their values to the newer counterparts\n    internally.\n-------------------------------------------------------------------------------------\nSuccessfully installed jekyll-4.0.0\n26 gems installed\n$ gem install jekyll-theme-basically-basic -v 1.4.1\nSuccessfully installed i18n-0.9.5\nSuccessfully installed sass-listen-4.0.0\n\nRuby Sass has reached end-of-life and should no longer be used.\n\n* If you use Sass as a command-line tool, we recommend using Dart Sass, the new\n  primary implementation: https://sass-lang.com/install\n\n* If you use Sass as a plug-in for a Ruby web framework, we recommend using the\n  sassc gem: https://github.com/sass/sassc-ruby#readme\n\n* For more details, please refer to the Sass blog:\n  https://sass-lang.com/blog/posts/7828841\n\nSuccessfully installed sass-3.7.4\nSuccessfully installed jekyll-sass-converter-1.5.2\nSuccessfully installed kramdown-1.17.0\nSuccessfully installed jekyll-3.8.6\nSuccessfully installed jekyll-sitemap-1.3.1\nSuccessfully installed jekyll-seo-tag-2.6.1\nSuccessfully installed jekyll-paginate-1.1.0\nSuccessfully installed jekyll-feed-0.12.1\nSuccessfully installed jekyll-theme-basically-basic-1.4.1\n11 gems installed\n$ gem install tzinfo -v 1.2.2\nSuccessfully installed thread_safe-0.3.6\nSuccessfully installed tzinfo-1.2.2\n2 gems installed\n$ gem install tzinfo-data\nSuccessfully installed tzinfo-data-1.2019.3\n1 gem installed\n$ bundle install\nFetching gem metadata from https://rubygems.org/...........\nFetching gem metadata from https://rubygems.org/.\nResolving dependencies...\nUsing public_suffix 4.0.1\nUsing addressable 2.7.0\nUsing bundler 1.17.3\nUsing colorator 1.1.0\nUsing concurrent-ruby 1.1.5\nUsing eventmachine 1.2.7\nUsing http_parser.rb 0.6.0\nUsing em-websocket 0.5.1\nUsing ffi 1.11.1\nUsing forwardable-extended 2.6.0\nUsing i18n 1.7.0\nUsing sassc 2.2.1\nUsing jekyll-sass-converter 2.0.1\nUsing rb-fsevent 0.10.3\nUsing rb-inotify 0.10.0\nUsing listen 3.2.0\nUsing jekyll-watch 2.2.1\nUsing kramdown 2.1.0\nUsing kramdown-parser-gfm 1.1.0\nUsing liquid 4.0.3\nUsing mercenary 0.3.6\nUsing pathutil 0.16.2\nUsing rouge 3.12.0\nUsing safe_yaml 1.0.5\nUsing unicode-display_width 1.6.0\nUsing terminal-table 1.8.0\nUsing jekyll 4.0.0\nUsing jekyll-feed 0.12.1\nUsing jekyll-paginate 1.1.0\nUsing jekyll-seo-tag 2.6.1\nUsing jekyll-sitemap 1.3.1\nFetching jekyll-theme-basically-basic 1.4.4\nInstalling jekyll-theme-basically-basic 1.4.4\nFetching minima 2.5.1\nInstalling minima 2.5.1\nBundle complete! 4 Gemfile dependencies, 33 gems now installed.\nBundled gems are installed into `/usr/local/bundle`\n$ jekyll build --trace -d public/\nConfiguration file: /builds/unveiled_adri/jekyll_project/_config.yml\n            Source: /builds/unveiled_adri/jekyll_project\n       Destination: /builds/unveiled_adri/jekyll_project/public\n Incremental build: disabled. Enable with --incremental\n      Generating... \n       Jekyll Feed: Generating feed for posts\n                    done in 0.442 seconds.\n Auto-regeneration: disabled. Use --watch to enable.\nUploading artifacts...\npublic: found 52 matching files                    \nUploading artifacts to coordinator... ok            id=322520499 responseStatus=201 Created token=PxjpDi2z\nJob succeeded\n</code></pre>\n\n<p>The website it's deployed but as I said, no errors, but css and links are not working</p>\n"}, {"tags": ["ruby", "sorting", "hash", "grouping"], "comments": [{"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1571242547, "post_id": 58416288, "comment_id": 103177952, "body": "That is 12 hashes, not one. Do you mean it to be an array of hashes? If so (even though you&#39;ve selected an answer), please edit to make it so. Also, it would be helpful if you would assign a variable to the array (e.g., <code>arr = [{...}, {...},...,{...}]</code>), so that readers could refer to the variable in answers and comments without having to define it. Also, why did you select the first answer offered? You don&#39;t want to see others?"}, {"owner": {"reputation": 23, "user_id": 7952432, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30ad296c48b7488309945722a9db31e1?s=128&d=identicon&r=PG&f=1", "display_name": "Eduardo Wagner", "link": "https://stackoverflow.com/users/7952432/eduardo-wagner"}, "reply_to_user": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1571328238, "post_id": 58416288, "comment_id": 103213466, "body": "I&#39;ve selected as answered because it fits my needs but hey, you&#39;re all welcome to comment aswell!"}], "answers": [{"comments": [{"owner": {"reputation": 1534, "user_id": 4453714, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fv4Fb.jpg?s=128&g=1", "display_name": "Yurii Verbytskyi", "link": "https://stackoverflow.com/users/4453714/yurii-verbytskyi"}, "edited": false, "score": 1, "creation_date": 1571238799, "post_id": 58416400, "comment_id": 103175996, "body": "Looks good, the only thing is sorting by date. Wouldnt it be better to use something like <code>.sort_by { |e| Date.strptime(e[&#39;prevInicioStr&#39;], &#39;%d&#47;%m&#47;%Y&#39;) }</code>"}, {"owner": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "reply_to_user": {"reputation": 1534, "user_id": 4453714, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fv4Fb.jpg?s=128&g=1", "display_name": "Yurii Verbytskyi", "link": "https://stackoverflow.com/users/4453714/yurii-verbytskyi"}, "edited": false, "score": 1, "creation_date": 1571238987, "post_id": 58416400, "comment_id": 103176115, "body": "That would be nice, but I don&#39;t know if it&#39;s needed since <code>p &quot;05&#47;11&#47;2019&quot; &lt;=&gt; &quot;21&#47;10&#47;2019&quot; # -1; p &quot;21&#47;10&#47;2019&quot; &lt;=&gt; &quot;05&#47;11&#47;2019&quot; # 1; p &quot;21&#47;10&#47;2019&quot; &lt;=&gt; &quot;21&#47;10&#47;2019&quot; # 0</code>."}, {"owner": {"reputation": 23, "user_id": 7952432, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30ad296c48b7488309945722a9db31e1?s=128&d=identicon&r=PG&f=1", "display_name": "Eduardo Wagner", "link": "https://stackoverflow.com/users/7952432/eduardo-wagner"}, "edited": false, "score": 0, "creation_date": 1571240131, "post_id": 58416400, "comment_id": 103176754, "body": "Done! Just removed the keys in my code and let only the values and everything is fine now!"}, {"owner": {"reputation": 13442, "user_id": 3982562, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2a3c7aae1d762372cda697833c602ec8?s=128&d=identicon&r=PG", "display_name": "3limin4t0r", "link": "https://stackoverflow.com/users/3982562/3limin4t0r"}, "edited": false, "score": 0, "creation_date": 1571240571, "post_id": 58416400, "comment_id": 103176996, "body": "@SebastianPalma It isn&#39;t needed in iso8601 format, since the date is represented in the other direction. Currently you&#39;re sorting by day, then by month, then by year. Meaning that <code>&quot;01&#47;01&#47;2050&quot;</code> comes before <code>&quot;06&#47;01&#47;1850&quot;</code>, since <code>&quot;01&quot;</code> is smaller than <code>&quot;06&quot;</code>."}], "tags": [], "owner": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "is_accepted": true, "score": 2, "last_activity_date": 1571238187, "creation_date": 1571238187, "answer_id": 58416400, "question_id": 58416288, "link": "https://stackoverflow.com/questions/58416288/ruby-sorting-by-id-and-grouping-by-date-in-hash/58416400#58416400", "title": "Ruby - Sorting by id and grouping by date in hash", "body": "<p>You must group first, and then sort (actually, you sort the values):</p>\n\n<pre><code>data = [{\"idprj\"=&gt;13351, \"prevInicioStr\"=&gt;\"21/10/2019\"}, {\"idprj\"=&gt;14473, \"prevInicioStr\"=&gt;\"22/10/2019\"}, {\"idprj\"=&gt;14165, \"prevInicioStr\"=&gt;\"23/10/2019\"}, {\"idprj\"=&gt;14165, \"prevInicioStr\"=&gt;\"23/10/2019\"}, {\"idprj\"=&gt;14165, \"prevInicioStr\"=&gt;\"28/10/2019\"}, {\"idprj\"=&gt;14165, \"prevInicioStr\"=&gt;\"28/10/2019\"}, {\"idprj\"=&gt;14518, \"prevInicioStr\"=&gt;\"29/10/2019\"}, {\"idprj\"=&gt;14518, \"prevInicioStr\"=&gt;\"29/10/2019\"}, {\"idprj\"=&gt;13351, \"prevInicioStr\"=&gt;\"05/11/2019\"}, {\"idprj\"=&gt;14305, \"prevInicioStr\"=&gt;\"06/11/2019\"}, {\"idprj\"=&gt;14305, \"prevInicioStr\"=&gt;\"08/11/2019\"}, {\"idprj\"=&gt;14305, \"prevInicioStr\"=&gt;\"13/01/2020\"}]\npp data.group_by { |e| e['idprj'] }\n       .transform_values { |values| values.sort_by { |e| e['prevInicioStr'] } }\n\n# {13351=&gt;\n#   [{\"idprj\"=&gt;13351, \"prevInicioStr\"=&gt;\"05/11/2019\"},\n#    {\"idprj\"=&gt;13351, \"prevInicioStr\"=&gt;\"21/10/2019\"}],\n#  14473=&gt;[{\"idprj\"=&gt;14473, \"prevInicioStr\"=&gt;\"22/10/2019\"}],\n#  14165=&gt;\n#   [{\"idprj\"=&gt;14165, \"prevInicioStr\"=&gt;\"23/10/2019\"},\n#    {\"idprj\"=&gt;14165, \"prevInicioStr\"=&gt;\"23/10/2019\"},\n#    {\"idprj\"=&gt;14165, \"prevInicioStr\"=&gt;\"28/10/2019\"},\n#    {\"idprj\"=&gt;14165, \"prevInicioStr\"=&gt;\"28/10/2019\"}],\n#  14518=&gt;\n#   [{\"idprj\"=&gt;14518, \"prevInicioStr\"=&gt;\"29/10/2019\"},\n#    {\"idprj\"=&gt;14518, \"prevInicioStr\"=&gt;\"29/10/2019\"}],\n#  14305=&gt;\n#   [{\"idprj\"=&gt;14305, \"prevInicioStr\"=&gt;\"06/11/2019\"},\n#    {\"idprj\"=&gt;14305, \"prevInicioStr\"=&gt;\"08/11/2019\"},\n#    {\"idprj\"=&gt;14305, \"prevInicioStr\"=&gt;\"13/01/2020\"}]}\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 7952432, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30ad296c48b7488309945722a9db31e1?s=128&d=identicon&r=PG&f=1", "display_name": "Eduardo Wagner", "link": "https://stackoverflow.com/users/7952432/eduardo-wagner"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 32, "favorite_count": 0, "accepted_answer_id": 58416400, "answer_count": 1, "score": 2, "last_activity_date": 1571240456, "creation_date": 1571237861, "last_edit_date": 1571240456, "question_id": 58416288, "link": "https://stackoverflow.com/questions/58416288/ruby-sorting-by-id-and-grouping-by-date-in-hash", "title": "Ruby - Sorting by id and grouping by date in hash", "body": "<p>I've been struggling with this in a bit and could not get a satisfactory result. I have this hash:</p>\n\n<pre><code>{\"idprj\"=&gt;13351, \"prevInicioStr\"=&gt;\"21/10/2019\"}\n{\"idprj\"=&gt;14473, \"prevInicioStr\"=&gt;\"22/10/2019\"}\n{\"idprj\"=&gt;14165, \"prevInicioStr\"=&gt;\"23/10/2019\"}\n{\"idprj\"=&gt;14165, \"prevInicioStr\"=&gt;\"23/10/2019\"}\n{\"idprj\"=&gt;14165, \"prevInicioStr\"=&gt;\"28/10/2019\"}\n{\"idprj\"=&gt;14165, \"prevInicioStr\"=&gt;\"28/10/2019\"}\n{\"idprj\"=&gt;14518, \"prevInicioStr\"=&gt;\"29/10/2019\"}\n{\"idprj\"=&gt;14518, \"prevInicioStr\"=&gt;\"29/10/2019\"}\n{\"idprj\"=&gt;13351, \"prevInicioStr\"=&gt;\"05/11/2019\"}\n{\"idprj\"=&gt;14305, \"prevInicioStr\"=&gt;\"06/11/2019\"}\n{\"idprj\"=&gt;14305, \"prevInicioStr\"=&gt;\"08/11/2019\"}\n{\"idprj\"=&gt;14305, \"prevInicioStr\"=&gt;\"13/01/2020\"}\n</code></pre>\n\n<p>And I wanted to sort by 'prevInicioStr' AND group by 'idprj' (you can see id 13351 isn't grouped as it should). To get this result I did this:</p>\n\n<pre><code>result.sort_by { |hash| [ Date.parse(hash['prevInicioStr']), hash['idprj'] ] } \n</code></pre>\n"}, {"tags": ["ruby", "metaprogramming"], "answers": [{"comments": [{"owner": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "edited": false, "score": 1, "creation_date": 1571236317, "post_id": 58415602, "comment_id": 103174357, "body": "I&#39;m trying to invoke <code>a</code> on <code>func</code> and it returns <code>private method &#39;a&#39; called for :func:Symbol (NoMethodError)</code>, Ruby 2.6.1p33 [x86_64-darwin18]."}, {"owner": {"reputation": 21613, "user_id": 580346, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/ba17945a06aac247b06548d5afe341e8?s=128&d=identicon&r=PG", "display_name": "mrzasa", "link": "https://stackoverflow.com/users/580346/mrzasa"}, "reply_to_user": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "edited": false, "score": 0, "creation_date": 1571236613, "post_id": 58415602, "comment_id": 103174568, "body": "please, paste what you&#39;re trying to do."}, {"owner": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "edited": false, "score": 1, "creation_date": 1571236908, "post_id": 58415602, "comment_id": 103174767, "body": "Exactly the same what&#39;s in your answer <a href=\"https://repl.it/@vnhnhm/PureBlaringSymbols\" rel=\"nofollow noreferrer\">repl.it/@vnhnhm/PureBlaringSymbols</a> (Ruby 2.5.5p157 this time, as well)."}, {"owner": {"reputation": 21613, "user_id": 580346, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/ba17945a06aac247b06548d5afe341e8?s=128&d=identicon&r=PG", "display_name": "mrzasa", "link": "https://stackoverflow.com/users/580346/mrzasa"}, "reply_to_user": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "edited": false, "score": 0, "creation_date": 1571236996, "post_id": 58415602, "comment_id": 103174824, "body": "works for me on <code>ruby 2.5.1p57</code>. Try in a new console."}, {"owner": {"reputation": 51, "user_id": 10156833, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6853873debb961b3bc4dba4a826e0ac0?s=128&d=identicon&r=PG&f=1", "display_name": "unnamed_road", "link": "https://stackoverflow.com/users/10156833/unnamed-road"}, "edited": false, "score": 0, "creation_date": 1571237282, "post_id": 58415602, "comment_id": 103175009, "body": "thanks a lot for the explanation! one more question: why dont we have to specify <code>:func</code> as a symbol to call <code>func.func</code> or <code>func.a</code> (the way we do it with <code>:asd</code>)? because of the <code>self</code> ?"}, {"owner": {"reputation": 21613, "user_id": 580346, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/ba17945a06aac247b06548d5afe341e8?s=128&d=identicon&r=PG", "display_name": "mrzasa", "link": "https://stackoverflow.com/users/580346/mrzasa"}, "edited": false, "score": 0, "creation_date": 1571237358, "post_id": 58415602, "comment_id": 103175061, "body": "I don&#39;t get what you&#39;re asking about. Could you tell it another way?"}, {"owner": {"reputation": 51, "user_id": 10156833, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6853873debb961b3bc4dba4a826e0ac0?s=128&d=identicon&r=PG&f=1", "display_name": "unnamed_road", "link": "https://stackoverflow.com/users/10156833/unnamed-road"}, "edited": false, "score": 0, "creation_date": 1571237603, "post_id": 58415602, "comment_id": 103175241, "body": "oh sorry:) what i mean is that <code>Method definition returns a symbol and you can call any globally-defined method on the symbol, that&#39;s why you can call func.func</code> my question is that  why we can call <code>func.func</code> instead of <code>:func.func</code> (skipping symbol sign <code>:</code>)"}, {"owner": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "edited": false, "score": 1, "creation_date": 1571237789, "post_id": 58415602, "comment_id": 103175381, "body": "Tried with Ruby 2.5.1p57 (2018-03-29 revision 63029) [x86_64-darwin18], same error."}, {"owner": {"reputation": 2251, "user_id": 9785060, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IUduC.png?s=128&g=1", "display_name": "Viktor", "link": "https://stackoverflow.com/users/9785060/viktor"}, "edited": false, "score": 0, "creation_date": 1571240245, "post_id": 58415602, "comment_id": 103176819, "body": "I get the same error as Sebastian if I run it on repl.it or write it in a file and run the file. It does work the way mrzasa described it if I test it in IRB. It also works if I add the <code>public</code> keyword before <code>def a</code> which doesn&#39;t make any sense since it should be public already :)"}, {"owner": {"reputation": 13442, "user_id": 3982562, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2a3c7aae1d762372cda697833c602ec8?s=128&d=identicon&r=PG", "display_name": "3limin4t0r", "link": "https://stackoverflow.com/users/3982562/3limin4t0r"}, "edited": false, "score": 0, "creation_date": 1571243060, "post_id": 58415602, "comment_id": 103178156, "body": "Code snippet works fine for me in MRI Ruby 2.4.1 irb."}, {"owner": {"reputation": 13442, "user_id": 3982562, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2a3c7aae1d762372cda697833c602ec8?s=128&d=identicon&r=PG", "display_name": "3limin4t0r", "link": "https://stackoverflow.com/users/3982562/3limin4t0r"}, "reply_to_user": {"reputation": 51, "user_id": 10156833, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6853873debb961b3bc4dba4a826e0ac0?s=128&d=identicon&r=PG&f=1", "display_name": "unnamed_road", "link": "https://stackoverflow.com/users/10156833/unnamed-road"}, "edited": false, "score": 2, "creation_date": 1571243300, "post_id": 58415602, "comment_id": 103178275, "body": "@sofi The point is if you define a method in the irb global namespace it&#39;s added to <code>Kernel</code> which is included by almost all Ruby objects. <code>1.a</code> would work, <code>:foo.a</code> works, <code>&quot;foo&quot;.a</code> works by just defining the <code>a</code> method in the global namespace. When calling <code>foo.foo</code> you simply call <code>foo</code> on the return value of the first <code>foo</code> call."}], "tags": [], "owner": {"reputation": 21613, "user_id": 580346, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/ba17945a06aac247b06548d5afe341e8?s=128&d=identicon&r=PG", "display_name": "mrzasa", "link": "https://stackoverflow.com/users/580346/mrzasa"}, "is_accepted": false, "score": 5, "last_activity_date": 1571235744, "creation_date": 1571235744, "answer_id": 58415602, "question_id": 58415458, "link": "https://stackoverflow.com/questions/58415458/could-someone-explain-please-how-the-code-works/58415602#58415602", "title": "Could someone explain please how the code works", "body": "<p>You define a method inside a method in a global scope. Method definition returns a symbol with it's name. </p>\n\n<ol>\n<li>When you call <code>func</code> for the first time, it's redefined, by the inner <code>func</code>. That's why subsequent calls to <code>func</code> return <code>1</code>.</li>\n<li>Method definition returns a symbol and you can call any globally-defined method on the symbol, that's why you can call <code>func.func</code>. Try to define other method and you'll be able to call it on any symbol:</li>\n</ol>\n\n<pre><code>def func\n   def func\n      1\n   end\nend\ndef a\n  'a'\nend\nfunc.a\n# 'a'\n:asd.a\n# 'a'\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 18079, "user_id": 503402, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/873ad707fb34aac8fbdfbfec676e02e9?s=128&d=identicon&r=PG", "display_name": "Max", "link": "https://stackoverflow.com/users/503402/max"}, "is_accepted": false, "score": 4, "last_activity_date": 1571316238, "last_edit_date": 1571316238, "creation_date": 1571240673, "answer_id": 58417151, "question_id": 58415458, "link": "https://stackoverflow.com/questions/58415458/could-someone-explain-please-how-the-code-works/58417151#58417151", "title": "Could someone explain please how the code works", "body": "<p>This is complicated. This really <em>shouldn't</em> work in Ruby, but it does.</p>\n\n<p><code>def func</code> at the top-level defines a global method. But how does that work in Ruby? It actually uses two hacks:</p>\n\n<ol>\n<li>It adds the method to <code>Object</code> so that you can call it from anywhere (because <code>self</code> is always an <code>Object</code>)</li>\n<li>It makes the method <code>private</code>, because the rule for private methods is that they can't have an \"explicit receiver\" i.e. you have to call them without putting an object and a dot before them. This is to prevent mistakes like if I think that a class <code>Foo</code> has its own <code>puts</code> method but it actually doesn't, <code>Foo.new.puts</code> will raise an error, rather than call the global <code>puts</code>.</li>\n</ol>\n\n<p>So if your code were just</p>\n\n<pre><code>def func\n  1\nend\n\n1.func\n</code></pre>\n\n<p>It would crash because you're trying to call a private method on the object <code>1</code>.</p>\n\n<p><em>But</em> here's where it gets weird. If you define a method inside another method, it defines a <em>normal</em> instance method as if it were not nested at all</p>\n\n<pre><code>class A\n  def outer\n    def inner\n      3\n    end\n  end\nend\n\nx = A.new\ny = A.new\nx.outer\ny.inner # calls the method defined by x\n</code></pre>\n\n<p>This wasn't really an intentional design in Ruby, but more of a fallback for a weird situation. The <a href=\"https://bugs.ruby-lang.org/issues/11665#note-3\" rel=\"nofollow noreferrer\">lead designer</a> doesn't like that it's even possible</p>\n\n<blockquote>\n  <p>...the current behavior of nested method definition is useless. It should be made obsolete to open up the future possibility (I'd vote for warning).</p>\n</blockquote>\n\n<p>Your code behaves so strangely because you're doing it at the top level where <code>self</code> is just an <code>Object</code>:</p>\n\n<pre><code>def func # normal private method in Object\n  def func # adds a normal instance method to the current class i.e. Object\n    1\n  end\nend\n\nObject.private_methods.include?(:func) # true\nfunc # returns :func, but also now re-defines func to be a normal method on Object\nObject.private_methods.include?(:func) # false\nfunc.func # same as 1.func, which is OK because it's not private\n</code></pre>\n"}], "owner": {"reputation": 51, "user_id": 10156833, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6853873debb961b3bc4dba4a826e0ac0?s=128&d=identicon&r=PG&f=1", "display_name": "unnamed_road", "link": "https://stackoverflow.com/users/10156833/unnamed-road"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 81, "favorite_count": 0, "answer_count": 2, "score": 4, "last_activity_date": 1571316238, "creation_date": 1571235272, "last_edit_date": 1571235875, "question_id": 58415458, "link": "https://stackoverflow.com/questions/58415458/could-someone-explain-please-how-the-code-works", "title": "Could someone explain please how the code works", "body": "<p>There is some code: </p>\n\n<pre><code>def func\n   def func\n      1\n   end\nend\n</code></pre>\n\n<p>then I try the following in <code>irb</code>:</p>\n\n<pre><code>func\nfunc.func\nfunc\n</code></pre>\n\n<p>and get the result:</p>\n\n<pre><code>:func\n1\n1\n</code></pre>\n\n<p>Could anyone please explain what's going on? I kinda understand the first output but not the latter. Thanks!</p>\n"}, {"tags": ["arrays", "ruby", "hash"], "comments": [{"owner": {"reputation": 152277, "user_id": 438992, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/QouOz.jpg?s=128&g=1", "display_name": "Dave Newton", "link": "https://stackoverflow.com/users/438992/dave-newton"}, "edited": false, "score": 3, "creation_date": 1571232765, "post_id": 58414340, "comment_id": 103171973, "body": "I&#39;m unclear on the reasoning here: there&#39;s no reason to put it in a hash &quot;so&quot; you can check who is 21. You have all the information you need in the array of hashes. Not saying you don&#39;t need (or want) it in a hash for some <i>other</i> reason, but you certainly don&#39;t for the reason stated."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "reply_to_user": {"reputation": 152277, "user_id": 438992, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/QouOz.jpg?s=128&g=1", "display_name": "Dave Newton", "link": "https://stackoverflow.com/users/438992/dave-newton"}, "edited": false, "score": 1, "creation_date": 1571244718, "post_id": 58414340, "comment_id": 103178954, "body": "Further to @Dave&#39;s point, how could you possibly make use of the keys in the hash? They differ only by the digits at the end of their names. You could extract the digits from a key, and then convert them to an integer. That would allow you to extract the key&#39;s value from the array, but you already have that value from the hash. Alternatively, you could start with an offset into the array, then construct the associated hash key, which would give you the value of that key, but you already have that from the array. Why do you want the hash? It seems to have no purpose."}], "answers": [{"tags": [], "owner": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "is_accepted": false, "score": 4, "last_activity_date": 1571232625, "last_edit_date": 1571232625, "creation_date": 1571232237, "answer_id": 58414448, "question_id": 58414340, "link": "https://stackoverflow.com/questions/58414340/ruby-string-array-to-hash/58414448#58414448", "title": "Ruby string array to hash", "body": "<p>You can use <code>each_with_object</code> to iterate over \"peaple\", and assign to a new hash the current element using as a key the prefix <em>person</em> plus the index of the current element (person).</p>\n\n<pre><code>peaple\n  .each_with_object({})\n  .with_index(1) do |(person, hash), index|\n    hash[\"person#{index}\"] = person\n  end\n\n#\u00a0{\"person1\"=&gt;{:name=&gt;\"Sam\", :year=&gt;\"21\"},\n#  \"person2\"=&gt;{:name=&gt;\"cole\", :partition=&gt;\"20\"},\n#  \"person3\"=&gt;{:name=&gt;\"bart\", :year=&gt;\"21\"}}\n</code></pre>\n\n<hr>\n\n<p>Another version just out of curiosity would be to create an array of strings with the same length of \"peaple\", having as values the prefix \"person\" plus its index plus 1. Zipping that with the current value and invoking <code>to_h</code> on it gives the same result:</p>\n\n<pre><code>Array.new(peaple.length) { |i| \"person#{i + 1}\" }.zip(peaple).to_h\n</code></pre>\n\n<hr>\n\n<p>If the idea is getting who's 21 by using the \"year\" key, then you can select those elements with year 21 and mapping then their names:</p>\n\n<pre><code>peaple\n  .select { |person| person[:year] == \"21\" }\n  .map { |person| person[:name] }\n# [\"Sam\", \"bart\"]\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "edited": false, "score": 1, "creation_date": 1571292272, "post_id": 58414526, "comment_id": 103193253, "body": "You can use <code>each_with_object({}).with_object(1)</code> to get rid of <code>people_hash</code> and <code>index + 1</code>."}, {"owner": {"reputation": 2869, "user_id": 160213, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/uEsMN.jpg?s=128&g=1", "display_name": "tjbp", "link": "https://stackoverflow.com/users/160213/tjbp"}, "reply_to_user": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "edited": false, "score": 0, "creation_date": 1571312976, "post_id": 58414526, "comment_id": 103204393, "body": "@SebastianPalma while I personally prefer using handy methods like that, I think they&#39;re harder to understand for a beginner, especially if they come from other languages with much smaller standard libs. Also I&#39;m sure you meant .with_index(1), as in your own answer!"}], "tags": [], "owner": {"reputation": 2869, "user_id": 160213, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/uEsMN.jpg?s=128&g=1", "display_name": "tjbp", "link": "https://stackoverflow.com/users/160213/tjbp"}, "is_accepted": true, "score": 1, "last_activity_date": 1571244487, "last_edit_date": 1571244487, "creation_date": 1571232467, "answer_id": 58414526, "question_id": 58414340, "link": "https://stackoverflow.com/questions/58414340/ruby-string-array-to-hash/58414526#58414526", "title": "Ruby string array to hash", "body": "<p>First of all, it happens to be spelled \"people\" ;)</p>\n\n<p>Since the keys <code>person1</code>, <code>person2</code>, etc. need to be generated, I would loop through your original array, placing each element into a new hash with an appropriate key:</p>\n\n<pre><code>people_hash = {}\n\npeople.each_with_index do |person, index|\n    next unless person[:year] == 21 # This will skip any element that doesn't have an :age of 21\n\n    people_hash[\"person#{index + 1}\"] = person\nend\n\npeople_hash\n#=&gt; {\"person1\"=&gt;{:name=&gt;\"Sam\", :year=&gt;\"21\"}, \"person2\"=&gt;{:name=&gt;\"cole\", :partition=&gt;\"20\"}, \"person3\"=&gt;{:name=&gt;\"bart\", :year=&gt;\"21\"}}\n</code></pre>\n\n<p>The <code>each_with_index</code> method will loop through each element of the array, but will also provide the current index of the element, so that we can use it for the hash keys. I've used string interpolation to create the hash keys - since you wanted to start at 1, I've added 1 to the index each time.</p>\n"}], "owner": {"reputation": 35, "user_id": 12224893, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-cEmc-6dbRz0/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfHcDFY6w4kPBeNv1nt8hNUMn_hPQ/photo.jpg?sz=128", "display_name": "Daan R.", "link": "https://stackoverflow.com/users/12224893/daan-r"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 200, "favorite_count": 0, "accepted_answer_id": 58414526, "answer_count": 2, "score": 1, "last_activity_date": 1571244487, "creation_date": 1571231922, "last_edit_date": 1571243573, "question_id": 58414340, "link": "https://stackoverflow.com/questions/58414340/ruby-string-array-to-hash", "title": "Ruby string array to hash", "body": "<p>In Ruby how do you convert an array to a hash?\nI have an array like this</p>\n\n<pre><code>people = [\n  {\"name\":\"Sam\",\"year\":\"21\"},\n  {\"name\":\"cole\",\"partition\":\"20\"},\n  {\"name\":\"bart\",\"year\":\"21\"}\n]\n</code></pre>\n\n<p>I want to put this array of in a hash like below so I can check who is 21:</p>\n\n<pre><code>{\n  person1 =&gt; {\"name\"=&gt;\"Sam\",\"year\"=&gt;\"21\"},\n  person2 =&gt; {\"name\"=&gt;\"cole\",\"partition\"=&gt;\"20\"},\n  person3 =&gt; {\"name\"=&gt;\"bart\",\"year\"=&gt;\"21\"}\n}\n</code></pre>\n\n<p>How can I convert this array of to a hash? And how do i check who is 21?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "apipie"], "comments": [{"owner": {"reputation": 13378, "user_id": 1430810, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/v669u.jpg?s=128&g=1", "display_name": "arieljuod", "link": "https://stackoverflow.com/users/1430810/arieljuod"}, "edited": false, "score": 0, "creation_date": 1571233063, "post_id": 58414101, "comment_id": 103172169, "body": "your index returns a json response but your requests is <code>.html</code>, also, I don&#39;t see how you do the request and how do you hande that <code>.en</code> from the url"}, {"owner": {"reputation": 48004, "user_id": 216513, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/30a45c64b2ef288f7ec098c5fb353a22?s=128&d=identicon&r=PG", "display_name": "nathanvda", "link": "https://stackoverflow.com/users/216513/nathanvda"}, "edited": false, "score": 0, "creation_date": 1571234493, "post_id": 58414101, "comment_id": 103173132, "body": "This link is generated from the Apipie documentation, right? It uses the default locale which is <code>en</code>: do you have defined that locale? The error can only be caused when either the api-version, resource, method or language is not found in the api-documentation."}], "answers": [{"tags": [], "owner": {"reputation": 1230, "user_id": 511203, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ec96aadd672b8056173e4e8a5225d8b?s=128&d=identicon&r=PG", "display_name": "Mike Gorski", "link": "https://stackoverflow.com/users/511203/mike-gorski"}, "is_accepted": false, "score": 0, "last_activity_date": 1605900805, "creation_date": 1605900805, "answer_id": 64935786, "question_id": 58414101, "link": "https://stackoverflow.com/questions/58414101/oops-method-index-en-not-found-for-resource-items/64935786#64935786", "title": "Oops!! Method index.en not found for resource items", "body": "<p>In your <code>config/initializers/apipie.rb</code> add <code>config.languages = ['en']</code> to the config block. So it should look something like this:</p>\n<pre><code>Apipie.configure do |config|\n  config.app_name                = &quot;MyApp&quot;\n  config.api_base_url            = &quot;/api&quot;\n  config.doc_base_url            = &quot;/apipie&quot;\n  config.languages = ['en']\n  config.api_controllers_matcher = &quot;#{Rails.root}/app/controllers/api/**/*.rb&quot;\nend\n</code></pre>\n<p>Then restart your rails server.</p>\n"}, {"tags": [], "owner": {"reputation": 53, "user_id": 2737444, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pEaY5.jpg?s=128&g=1", "display_name": "Renat", "link": "https://stackoverflow.com/users/2737444/renat"}, "is_accepted": false, "score": 1, "last_activity_date": 1610558642, "last_edit_date": 1610558642, "creation_date": 1610556761, "answer_id": 65706323, "question_id": 58414101, "link": "https://stackoverflow.com/questions/58414101/oops-method-index-en-not-found-for-resource-items/65706323#65706323", "title": "Oops!! Method index.en not found for resource items", "body": "<p>Just add to &quot;<em>config/initialize/apipie.rb</em>&quot; one line of code:</p>\n<pre><code>config.translate = false\n</code></pre>\n"}], "owner": {"reputation": 1506, "user_id": 4265308, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/GOuYQ.jpg?s=128&g=1", "display_name": "Pooja Mokariya", "link": "https://stackoverflow.com/users/4265308/pooja-mokariya"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 158, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1610558642, "creation_date": 1571231296, "question_id": 58414101, "link": "https://stackoverflow.com/questions/58414101/oops-method-index-en-not-found-for-resource-items", "title": "Oops!! Method index.en not found for resource items", "body": "<p>I have used <code>https://github.com/Apipie/apipie-rails</code> for API docs.</p>\n\n<p>This is working fine with rails 4 vestion after that I have updated my rails version to this <code>rails 5.2.3</code> and it stoped working.</p>\n\n<pre><code># app/controllers/api/v1/items_controller.rb\nmodule Api\n  module V1\n    class ItemsController &lt; API::V1::BaseApiController\n      api :GET, '/items', 'All items'\n      def index\n        render json: @items\n      end\n    end\n  end\nend\n</code></pre>\n\n<p>I am getting this kind of error</p>\n\n<pre><code>Started GET \"/api-doc/1.0/items/index.en.html\" for ::1 at 2019-10-16 18:32:08 +0530\nProcessing by Apipie::ApipiesController#index as HTML\nParameters: {\"version\"=&gt;\"1.0\", \"resource\"=&gt;\"items\", \"method\"=&gt;\"index.en.html\"}\nRendering /Users/sc/.rvm/gems/ruby-2.6.3/gems/apipie-rails-0.5.16/app/views/apipie/apipies/apipie_404.html.erb within layouts/apipie/apipie\nRendered /Users/sc/.rvm/gems/ruby-2.6.3/gems/apipie-rails-0.5.16/app/views/apipie/apipies/apipie_404.html.erb within layouts/apipie/apipie (2.1ms)\nCompleted 404 Not Found in 659ms (Views: 13.5ms | ActiveRecord: 0.0ms)\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "amazon-s3", "shrine"], "answers": [{"tags": [], "owner": {"reputation": 7938, "user_id": 988414, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/376e4eb9dc6c2e33d1330262edc4f109?s=128&d=identicon&r=PG", "display_name": "janko-m", "link": "https://stackoverflow.com/users/988414/janko-m"}, "is_accepted": true, "score": 0, "last_activity_date": 1571298728, "creation_date": 1571298728, "answer_id": 58427551, "question_id": 58413741, "link": "https://stackoverflow.com/questions/58413741/configure-the-way-file-id-attribute-is-generated-on-shrine-gem/58427551#58427551", "title": "Configure the way file ID attribute is generated on Shrine gem", "body": "<p>Yes, you can use <a href=\"https://shrinerb.com/docs/plugins/presign_endpoint#location\" rel=\"nofollow noreferrer\"><code>:presign_location</code></a>:</p>\n\n<pre><code>Shrine.plugin :presign_endopint, presign_location: -&gt; (request) do\n  \"#{SecureRandom.hex}/#{request.params[\"filename\"]}\" # for example\nend\n</code></pre>\n"}], "owner": {"reputation": 69, "user_id": 8518731, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fKKrS.jpg?s=128&g=1", "display_name": "jpac", "link": "https://stackoverflow.com/users/8518731/jpac"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 83, "favorite_count": 1, "accepted_answer_id": 58427551, "answer_count": 1, "score": 0, "last_activity_date": 1571298728, "creation_date": 1571230208, "question_id": 58413741, "link": "https://stackoverflow.com/questions/58413741/configure-the-way-file-id-attribute-is-generated-on-shrine-gem", "title": "Configure the way file ID attribute is generated on Shrine gem", "body": "<p>Shrine creates a random <code>ID</code> for the uploaded file to AWS S3 when calling <code>presign_endpoint</code>. Is there a way to change the way the <code>ID</code> is generated using Shrine's configuration?</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 2251, "user_id": 9785060, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IUduC.png?s=128&g=1", "display_name": "Viktor", "link": "https://stackoverflow.com/users/9785060/viktor"}, "edited": false, "score": 1, "creation_date": 1571229972, "post_id": 58413426, "comment_id": 103170228, "body": "What&#39;s the starting day, where did you get <code>2019-10-05:</code> from? What&#39;s the ending date, where did you get <code>2019-10-13: </code> from ?"}, {"owner": {"reputation": 61, "user_id": 9794081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65d20607ef5e19f4fea4388fbaa398e0?s=128&d=identicon&r=PG&f=1", "display_name": "Databaas7894", "link": "https://stackoverflow.com/users/9794081/databaas7894"}, "reply_to_user": {"reputation": 2251, "user_id": 9785060, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IUduC.png?s=128&g=1", "display_name": "Viktor", "link": "https://stackoverflow.com/users/9785060/viktor"}, "edited": false, "score": 0, "creation_date": 1571230114, "post_id": 58413426, "comment_id": 103170328, "body": "As an example. probably going to use something like <code>3.months.ago..Date.today</code>."}, {"owner": {"reputation": 13442, "user_id": 3982562, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2a3c7aae1d762372cda697833c602ec8?s=128&d=identicon&r=PG", "display_name": "3limin4t0r", "link": "https://stackoverflow.com/users/3982562/3limin4t0r"}, "edited": false, "score": 0, "creation_date": 1571231330, "post_id": 58413426, "comment_id": 103171052, "body": "<code>3.months.ago</code> doesn&#39;t have a <code>succ</code> method, so you cant iterate it with a range, you&#39;ll have to convert it to a date first. <code>3.months.ago.to_date</code> should work. See: <a href=\"https://ruby-doc.org/core-2.6.5/Range.html#class-Range-label-Custom+Objects+in+Ranges\" rel=\"nofollow noreferrer\">ruby-doc.org/core-2.6.5/&hellip;</a>"}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1571236425, "post_id": 58413426, "comment_id": 103174426, "body": "1. When you address comments that ask for clarification please edit your question rather than elaborating in comments. Questions should stand on their own; readers should not be expected to read through all the comments to understand what is being asked. 2. Are the elements of the array always in date order, as they are in the example? 3. Please no \u201cprobably going to use\u201d. That\u2019s like asking \u201cwhat is <code>x + 2</code> when <code>x</code> probably equals <code>2</code>?\u201d. Be precise and definite. 4. The title refers to a second array. Where is it?..."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1571237050, "post_id": 58413426, "comment_id": 103174863, "body": "...5. Whenever you give an example please attach a variable to all inputs: <code>arr = [#&lt;Order id: 1,...]</code>, <code>start_date = ...</code>, <code>end_date = ...</code>.  That allows readers to reference those variable in answers and comments without having to define them."}], "answers": [{"tags": [], "owner": {"reputation": 63078, "user_id": 220147, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b3881a28fe402dd2d1de44717486cae8?s=128&d=identicon&r=PG", "display_name": "Michael Kohl", "link": "https://stackoverflow.com/users/220147/michael-kohl"}, "is_accepted": false, "score": 0, "last_activity_date": 1571230201, "creation_date": 1571230201, "answer_id": 58413739, "question_id": 58413426, "link": "https://stackoverflow.com/questions/58413426/loop-two-arrays-at-once/58413739#58413739", "title": "Loop two arrays at once", "body": "<p>I'd start with something like this:</p>\n\n<ol>\n<li>Group the array of orders by date: <code>lookup = orders.group_by(:date)</code></li>\n<li>Iterate over your date range, use date as key into <code>lookup</code>, so at least you don't need to traverse the <code>orders</code> array repeatedly.</li>\n</ol>\n"}, {"tags": [], "owner": {"reputation": 13378, "user_id": 1430810, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/v669u.jpg?s=128&g=1", "display_name": "arieljuod", "link": "https://stackoverflow.com/users/1430810/arieljuod"}, "is_accepted": false, "score": 0, "last_activity_date": 1571230240, "creation_date": 1571230240, "answer_id": 58413753, "question_id": 58413426, "link": "https://stackoverflow.com/questions/58413426/loop-two-arrays-at-once/58413753#58413753", "title": "Loop two arrays at once", "body": "<p>I would do a mix of both:</p>\n\n<pre><code># rearange your array of hashes into a hash with [date, ids] pairs\norders_by_date = {}\norders.each do |id, date|\n  orders_by_date[date] ||= []\n  orders_by_date[date] &lt;&lt; id\nend\n\n# iterate over the range and check if the previous hash has the key\ndate_range.each do |date|\n  date_s = date.strftime('%Y-%m-%d')\n  date_ids = orders_by_date.fetch(date_s, []).map { |x| \"id: #{x}\" }.join(', ')\n  puts \"#{date_s}: #{date_ids}\"\nend\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1571340973, "post_id": 58413873, "comment_id": 103218906, "body": "This is incorrect. For one, you want <code>ords.date</code>, not <code>ords[:date]</code>. I suggest you test before posting."}, {"owner": {"reputation": 13378, "user_id": 1430810, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/v669u.jpg?s=128&g=1", "display_name": "arieljuod", "link": "https://stackoverflow.com/users/1430810/arieljuod"}, "reply_to_user": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1571359533, "post_id": 58413873, "comment_id": 103224274, "body": "@CarySwoveland, originally, the orders where hashes and not objects, that&#39;s why <code>ords[:date]</code> was used, the OP modified the question after the answers"}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "reply_to_user": {"reputation": 13378, "user_id": 1430810, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/v669u.jpg?s=128&g=1", "display_name": "arieljuod", "link": "https://stackoverflow.com/users/1430810/arieljuod"}, "edited": false, "score": 0, "creation_date": 1571366010, "post_id": 58413873, "comment_id": 103225479, "body": "@arieljuod, I see. Presumably that applies to you answer as well. I hate it when OP&#39;s change their questions, especially when it&#39;s done after answers have been posted. Not only is it a time-waster for those answering but it generally also renders their answers incorrect, even nonsensical."}], "tags": [], "owner": {"reputation": 1023, "user_id": 3552298, "user_type": "registered", "accept_rate": 12, "profile_image": "https://www.gravatar.com/avatar/8540fb02a16712af1b873b8bd8b6b318?s=128&d=identicon&r=PG&f=1", "display_name": "sureshprasanna70", "link": "https://stackoverflow.com/users/3552298/sureshprasanna70"}, "is_accepted": false, "score": 0, "last_activity_date": 1571230592, "creation_date": 1571230592, "answer_id": 58413873, "question_id": 58413426, "link": "https://stackoverflow.com/questions/58413426/loop-two-arrays-at-once/58413873#58413873", "title": "Loop two arrays at once", "body": "<p>Try <code>group_by</code>. You can find the documentation at <a href=\"https://apidock.com/ruby/Enumerable/group_by\" rel=\"nofollow noreferrer\">https://apidock.com/ruby/Enumerable/group_by</a></p>\n\n<pre><code>grouped_orders = orders.group_by{|ords| ords[:date]}\n</code></pre>\n\n<pre class=\"lang-rb prettyprint-override\"><code>(start_date..end_date).each do |order_date|\n  puts order_date\n  grouped_orders.fetch(order_date).map{|m| puts m.id}\nend\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 13442, "user_id": 3982562, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2a3c7aae1d762372cda697833c602ec8?s=128&d=identicon&r=PG", "display_name": "3limin4t0r", "link": "https://stackoverflow.com/users/3982562/3limin4t0r"}, "edited": false, "score": 0, "creation_date": 1571232176, "post_id": 58414412, "comment_id": 103171610, "body": "Plain Ruby users should <code>require &#39;ostruct&#39;</code> and <code>require &#39;date&#39;</code>."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1571341459, "post_id": 58414412, "comment_id": 103219121, "body": "Good answer. It would be helpful to display what is <code>puts</code>&#39;d, in part to show that you&#39;ve tested."}, {"owner": {"reputation": 13442, "user_id": 3982562, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2a3c7aae1d762372cda697833c602ec8?s=128&d=identicon&r=PG", "display_name": "3limin4t0r", "link": "https://stackoverflow.com/users/3982562/3limin4t0r"}, "reply_to_user": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1571348517, "post_id": 58414412, "comment_id": 103221805, "body": "@CarySwoveland Agreed, I&#39;ve updated the question with the console output."}], "tags": [], "owner": {"reputation": 13442, "user_id": 3982562, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2a3c7aae1d762372cda697833c602ec8?s=128&d=identicon&r=PG", "display_name": "3limin4t0r", "link": "https://stackoverflow.com/users/3982562/3limin4t0r"}, "is_accepted": false, "score": 1, "last_activity_date": 1571348475, "last_edit_date": 1571348475, "creation_date": 1571232144, "answer_id": 58414412, "question_id": 58413426, "link": "https://stackoverflow.com/questions/58413426/loop-two-arrays-at-once/58414412#58414412", "title": "Loop two arrays at once", "body": "<p>Similar to what <a href=\"https://stackoverflow.com/a/58413739/3982562\">Michael Kohl</a> and <a href=\"https://stackoverflow.com/a/58413753/3982562\">arieljuod</a> describe in their answers. First group your dates based on date, then loop through the dates and grab the groups that are relevant.</p>\n\n<pre><code># mock\norders = [{id: 1, date: '2019-10-07'}, {id: 2, date: '2019-10-08'}, {id: 3, date: '2019-10-10'}, {id: 4, date: '2019-10-10'}, {id: 5, date: '2019-10-12'}]\norders.map!(&amp;OpenStruct.method(:new))\n\n# solution\norders = orders.group_by(&amp;:date)\norders.default = []\n\ndate_range = Date.new(2019, 10, 5)..Date.new(2019, 10, 13)\ndate_range.map(&amp;:iso8601).each do |date|\n  ids = orders[date].map { |order| \"id: #{order.id}\" }.join(', ')\n  puts \"#{date}: #{ids}\"\nend\n# 2019-10-05:\n# 2019-10-06:\n# 2019-10-07: id: 1\n# 2019-10-08: id: 2\n# 2019-10-09:\n# 2019-10-10: id: 3, id: 4\n# 2019-10-11:\n# 2019-10-12: id: 5\n# 2019-10-13:\n#=&gt; [\"2019-10-05\", \"2019-10-06\", \"2019-10-07\", \"2019-10-08\", \"2019-10-09\", \"2019-10-10\", \"2019-10-11\", \"2019-10-12\", \"2019\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "is_accepted": false, "score": 0, "last_activity_date": 1571341694, "last_edit_date": 1571341694, "creation_date": 1571284250, "answer_id": 58424643, "question_id": 58413426, "link": "https://stackoverflow.com/questions/58413426/loop-two-arrays-at-once/58424643#58424643", "title": "Loop two arrays at once", "body": "<p><strong>Data</strong></p>\n\n<p>We are given an array of instances of the class <code>Order</code>:</p>\n\n<pre><code>require 'date'\n\nclass Order\n  attr_reader :id, :date\n  def initialize(id,date)\n    @id = id\n    @date = date\n  end\nend\n\narr = ['2019-10-07', '2019-10-08', '2019-10-10', '2019-10-10', '2019-10-12'].\n  map.each.with_index(1) { |s,i| Order.new(i, Date.iso8601(s)) }\n  #=&gt; [#&lt;Order:0x00005a49d68ad8b8 @id=1,\n  #      @date=#&lt;Date: 2019-10-07 ((2458764j,0s,0n),+0s,2299161j)&gt;&gt;,\n  #    #&lt;Order:0x00005a49d68ad6d8 @id=2,\n  #      @date=#&lt;Date: 2019-10-08 ((2458765j,0s,0n),+0s,2299161j)&gt;&gt;,\n  #    #&lt;Order:0x00005a49d68ad3b8 @id=3,\n  #      @date=#&lt;Date: 2019-10-10 ((2458767j,0s,0n),+0s,2299161j)&gt;&gt;,\n  #    #&lt;Order:0x00005a49d68ad138 @id=4,\n  #      @date=#&lt;Date: 2019-10-10 ((2458767j,0s,0n),+0s,2299161j)&gt;&gt;,\n  #    #&lt;Order:0x00005a49d68aceb8 @id=5,\n  #      @date=#&lt;Date: 2019-10-12 ((2458769j,0s,0n),+0s,2299161j)&gt;&gt;] \n</code></pre>\n\n<p>and start and end dates:</p>\n\n<pre><code>start_date = '2019-10-05'\nend_date   = '2019-10-13'\n</code></pre>\n\n<p><strong>Assumption</strong></p>\n\n<p>I assume that:</p>\n\n<pre><code>Date.iso8601(start_date) &lt;= arr.first.date &amp;&amp;\n  arr.first.date &lt;= arr.last.date &amp;&amp;\n  arr.last.date &lt;= Date.iso8601(end_date)\n  #=&gt; true\n</code></pre>\n\n<p>There is no need for the elements of <code>arr</code> to be sorted by date.</p>\n\n<p><strong>Code</strong></p>\n\n<pre><code>h = (start_date..end_date).each_with_object({}) { |d,h| h[d] = d + ':' }\narr.each do |inst|\n  date = inst.date.strftime('%Y-%m-%d')\n  h[date] += \"#{h[date][-1] == ':' ? '' : ','} id #{inst.id}\"\nend\nh.values\n  #=&gt; [\"2019-10-05:\",\n  #    \"2019-10-06:\",\n  #    \"2019-10-07: id 1\",\n  #    \"2019-10-08: id 2\",\n  #    \"2019-10-09:\",\n  #    \"2019-10-10: id 3, id 4\",\n  #    \"2019-10-11:\",\n  #    \"2019-10-12: id 5\",\n  #    \"2019-10-13:\"] \n</code></pre>\n\n<p><strong>Explanation</strong></p>\n\n<p>The first step is to construct the hash <code>h</code>:</p>\n\n<pre><code>h = (start_date..end_date).each_with_object({}) { |d,h| h[d] = d + ':' }\n  #=&gt; {\"2019-10-05\"=&gt;\"2019-10-05:\", \"2019-10-06\"=&gt;\"2019-10-06:\",\n  #    \"2019-10-07\"=&gt;\"2019-10-07:\", \"2019-10-08\"=&gt;\"2019-10-08:\",\n  #    \"2019-10-09\"=&gt;\"2019-10-09:\", \"2019-10-10\"=&gt;\"2019-10-10:\",\n  #    \"2019-10-11\"=&gt;\"2019-10-11:\", \"2019-10-12\"=&gt;\"2019-10-12:\",\n  #    \"2019-10-13\"=&gt;\"2019-10-13:\"} \n</code></pre>\n\n<p>Now we will loop through the elements <code>inst</code> (instances of <code>Order</code>) of <code>arr</code>, and for each will alter the value of the key in <code>h</code> that equals <code>inst.date</code> converted to a string:</p>\n\n<pre><code>arr.each do |inst|\n  date = inst.date.strftime('%Y-%m-%d')\n  h[date] += \"#{h[date][-1] == ':' ? '' : ','} id #{inst.id}\"\nend\n</code></pre>\n\n<p>Resulting in:</p>\n\n<pre><code>h #=&gt; {\"2019-10-05\"=&gt;\"2019-10-05:\",\n  #    \"2019-10-06\"=&gt;\"2019-10-06:\",\n  #    \"2019-10-07\"=&gt;\"2019-10-07: id 1\",\n  #    \"2019-10-08\"=&gt;\"2019-10-08: id 2\",\n  #    \"2019-10-09\"=&gt;\"2019-10-09:\",\n  #    \"2019-10-10\"=&gt;\"2019-10-10: id 3, id 4\",\n  #    \"2019-10-11\"=&gt;\"2019-10-11:\",\n  #    \"2019-10-12\"=&gt;\"2019-10-12: id 5\",\n  #    \"2019-10-13\"=&gt;\"2019-10-13:\"} \n</code></pre>\n\n<p>All that remains is to extract the values of the hash <code>h</code>:</p>\n\n<pre><code>h.values\n  #=&gt; [\"2019-10-05:\",\n  #    \"2019-10-06:\",\n  #    \"2019-10-07: id 1\",\n  #    \"2019-10-08: id 2\",\n  #    \"2019-10-09:\",\n  #    \"2019-10-10: id 3, id 4\",\n  #    \"2019-10-11:\",\n  #    \"2019-10-12: id 5\",\n  #    \"2019-10-13:\"] \n</code></pre>\n"}], "owner": {"reputation": 61, "user_id": 9794081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65d20607ef5e19f4fea4388fbaa398e0?s=128&d=identicon&r=PG&f=1", "display_name": "Databaas7894", "link": "https://stackoverflow.com/users/9794081/databaas7894"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 84, "favorite_count": 1, "answer_count": 5, "score": 2, "last_activity_date": 1571348475, "creation_date": 1571229167, "last_edit_date": 1571229638, "question_id": 58413426, "link": "https://stackoverflow.com/questions/58413426/loop-two-arrays-at-once", "title": "Loop two arrays at once", "body": "<p>I do have an array with orders, each with a date. Like: </p>\n\n<pre><code>[\n#&lt;Order id: 1, date: '2019-10-07'&gt;,\n#&lt;Order id: 2, date: '2019-10-08'&gt;,\n#&lt;Order id: 3, date: '2019-10-10'&gt;,\n#&lt;Order id: 4, date: '2019-10-10'&gt;,\n#&lt;Order id: 5, date: '2019-10-12'&gt;\n]\n</code></pre>\n\n<p>I want to display it like this:</p>\n\n<pre><code>2019-10-05:\n2019-10-06:\n2019-10-07: id 1\n2019-10-08: id 2\n2019-10-09:\n2019-10-10: id 3, id 4\n2019-10-11:\n2019-10-12: id 5\n2019-10-13: \n</code></pre>\n\n<p>What is the best way to do this?</p>\n\n<p>I can think of the following options: </p>\n\n<ol>\n<li><code>date_range.each do ...</code> and check if there are any corresponding orders on that date. </li>\n<li>First sort the array of orders, then do <code>orders.each do ...</code> and check if there are any dates skipped.</li>\n</ol>\n\n<p>Is there some 3rd way, that is walking through both arrays simultaneously? Like starting with the dates, when there is a corresponding order, start continue with the orders until there is a new date?</p>\n"}, {"tags": ["ruby", "web-scraping"], "comments": [{"owner": {"reputation": 794, "user_id": 2587326, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/Jbcjl.jpg?s=128&g=1", "display_name": "Palo", "link": "https://stackoverflow.com/users/2587326/palo"}, "edited": false, "score": 0, "creation_date": 1571223850, "post_id": 58411702, "comment_id": 103166707, "body": "Welcome to StackOverflow. You may want to tell us what is the delay between your 4-6 requests?"}, {"owner": {"reputation": 11, "user_id": 12225857, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/521f1f0ec9350148a3e8d08c03d0ebf1?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas frl", "link": "https://stackoverflow.com/users/12225857/thomas-frl"}, "reply_to_user": {"reputation": 794, "user_id": 2587326, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/Jbcjl.jpg?s=128&g=1", "display_name": "Palo", "link": "https://stackoverflow.com/users/2587326/palo"}, "edited": false, "score": 0, "creation_date": 1571232752, "post_id": 58411702, "comment_id": 103171966, "body": "Thank you for your answer. The delay is 20 seconds."}], "answers": [{"tags": [], "owner": {"reputation": 11, "user_id": 12225857, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/521f1f0ec9350148a3e8d08c03d0ebf1?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas frl", "link": "https://stackoverflow.com/users/12225857/thomas-frl"}, "is_accepted": false, "score": 0, "last_activity_date": 1571232895, "creation_date": 1571232895, "answer_id": 58414662, "question_id": 58411702, "link": "https://stackoverflow.com/questions/58411702/is-there-a-way-to-make-http-request-without-being-banned/58414662#58414662", "title": "Is there a way to make http request without being banned?", "body": "<p>I managed to do as many request I want, thanks to the following code:</p>\n\n<pre><code>driver = Selenium::WebDriver.for :firefox\n10.times do\n  driver.get 'https://odmiana.net/'\n  sleep 3\nend\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 12225857, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/521f1f0ec9350148a3e8d08c03d0ebf1?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas frl", "link": "https://stackoverflow.com/users/12225857/thomas-frl"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 42, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1571232895, "creation_date": 1571223458, "question_id": 58411702, "link": "https://stackoverflow.com/questions/58411702/is-there-a-way-to-make-http-request-without-being-banned", "title": "Is there a way to make http request without being banned?", "body": "<p>I want to do some scrapping n the website odmiana.net. However I am banned only after a few request (4 or 6). These requests are spaced in time</p>\n\n<p>robots.txt : </p>\n\n<pre><code>User-agent: Mediapartners-Google\nDisallow:\n\nUser-agent: *\nAllow: /\n\nSitemap: https://odmiana.net/sitemap.xml.gz\n</code></pre>\n\n<p>current code:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>require 'rest_client'\n\nresponse = RestClient.get 'https://odmiana.net/'\n</code></pre>\n\n<p>I don't understand why am I detected as a robot and how not to be.\nSomeone has an idea?</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 21613, "user_id": 580346, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/ba17945a06aac247b06548d5afe341e8?s=128&d=identicon&r=PG", "display_name": "mrzasa", "link": "https://stackoverflow.com/users/580346/mrzasa"}, "edited": false, "score": 0, "creation_date": 1571220652, "post_id": 58410810, "comment_id": 103165071, "body": "What is the error you&#39;re referring to? What is the backtrace?"}, {"owner": {"reputation": 43, "user_id": 11996777, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd21f38f987e269a12e4476ac6fbe7a9?s=128&d=identicon&r=PG&f=1", "display_name": "sstwg", "link": "https://stackoverflow.com/users/11996777/sstwg"}, "reply_to_user": {"reputation": 21613, "user_id": 580346, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/ba17945a06aac247b06548d5afe341e8?s=128&d=identicon&r=PG", "display_name": "mrzasa", "link": "https://stackoverflow.com/users/580346/mrzasa"}, "edited": false, "score": 0, "creation_date": 1571220797, "post_id": 58410810, "comment_id": 103165137, "body": "fixed error shown"}, {"owner": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "edited": false, "score": 1, "creation_date": 1571220949, "post_id": 58410810, "comment_id": 103165213, "body": "Check <a href=\"https://stackoverflow.com/q/6712298/5025116\">this</a> for further information."}, {"owner": {"reputation": 43, "user_id": 11996777, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd21f38f987e269a12e4476ac6fbe7a9?s=128&d=identicon&r=PG&f=1", "display_name": "sstwg", "link": "https://stackoverflow.com/users/11996777/sstwg"}, "edited": false, "score": 0, "creation_date": 1571221923, "post_id": 58410810, "comment_id": 103165673, "body": "Must be put, just points ran out for today :)"}], "answers": [{"tags": [], "owner": {"reputation": 21613, "user_id": 580346, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/ba17945a06aac247b06548d5afe341e8?s=128&d=identicon&r=PG", "display_name": "mrzasa", "link": "https://stackoverflow.com/users/580346/mrzasa"}, "is_accepted": true, "score": 1, "last_activity_date": 1571220983, "creation_date": 1571220983, "answer_id": 58410937, "question_id": 58410810, "link": "https://stackoverflow.com/questions/58410810/why-there-is-an-error-in-the-code-dynamic-constant-assignment-ruby/58410937#58410937", "title": "Why there is an error in the code dynamic constant assignment Ruby", "body": "<p>You reassign <code>WAYS_TO_WIN</code> every time <code>win_play</code> is called</p>\n\n<pre><code>def win_play(board)\n\n    WAYS_TO_WIN =\n</code></pre>\n\n<p>define <code>WAYS_TO_WIN</code> outside of the method, e.g. with all the other constants</p>\n\n<pre><code>NUMBER_SQUARES = 9  # number of fields on the board\nWAYS_TO_WIN = ...\n</code></pre>\n"}], "owner": {"reputation": 43, "user_id": 11996777, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd21f38f987e269a12e4476ac6fbe7a9?s=128&d=identicon&r=PG&f=1", "display_name": "sstwg", "link": "https://stackoverflow.com/users/11996777/sstwg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 35, "favorite_count": 0, "closed_date": 1612388423, "accepted_answer_id": 58410937, "answer_count": 1, "score": 1, "last_activity_date": 1571221024, "creation_date": 1571220552, "last_edit_date": 1571221024, "question_id": 58410810, "link": "https://stackoverflow.com/questions/58410810/why-there-is-an-error-in-the-code-dynamic-constant-assignment-ruby", "closed_reason": "Duplicate", "title": "Why there is an error in the code dynamic constant assignment Ruby", "body": "<pre><code># Global constants\n\nX = \"X\"             # cross\nO = \"O\"             # toe\nEMPTY = \"\"          # empty board\nTIE = \"DRAW\"        # draw state\nNUMBER_SQUARES = 9  # number of fields on the board\n</code></pre>\n\n<p>Creates a new game board - \na list of nine elements equal to <code>EMPTY</code> and returns it</p>\n\n<pre><code>def new_playing_board\n    create_board = Array.new(NUMBER_SQUARES) { EMPTY }\nend\n\nboard = new_playing_board\n</code></pre>\n\n<p>The function takes the board and returns the winner of the game.\nFour possible values \u200b\u200bcan be returned: <code>\"X\"</code>, <code>\"O\"</code> - computer or human, \n<code>TIE</code> - if all fields are completed, \n<code>nil</code> - one of the fields is empty and the winner is not defined</p>\n\n<pre><code>def win_play(board)\n\n    WAYS_TO_WIN = [    # backtrace error: dynamic constant assignment WAYS_TO_WIN = [ rb:136\n                [0, 1, 2],\n                [3, 4, 5],\n                [6, 7, 8],\n                [0, 3, 6],\n                [1, 4, 7],\n                [2, 5, 8],\n                [0, 4, 8],\n                [2, 4, 6]\n                ]\n\n\n    WAYS_TO_WIN.each do |row|\n        if (board[row[0]] == board[row[1]] &amp;&amp; board[row[0]] == board[row[2]]) != EMPTY\n            winner = board[row[0]]\n            return winner\n        end\n\n        unless board.include?(EMPTY)\n            return TIE\n        end\n    end\n\n    return nil \n\nend\n\n\nwin_play(board)\n</code></pre>\n\n<p>backtrace: dynamic constant assignment WAYS_TO_WIN = [ rb:136</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "enums"], "comments": [{"owner": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "edited": false, "score": 1, "creation_date": 1571219737, "post_id": 58410492, "comment_id": 103164528, "body": "Remove temporarily the <code>museum</code> enum, try with <code>CollectionContext.method(: museum?).source_location</code>. That should tell you where that method is defined, if it is."}, {"owner": {"reputation": 616, "user_id": 3258059, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YfxT7.jpg?s=128&g=1", "display_name": "whatapalaver", "link": "https://stackoverflow.com/users/3258059/whatapalaver"}, "reply_to_user": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "edited": false, "score": 0, "creation_date": 1571221107, "post_id": 58410492, "comment_id": 103165292, "body": "Thanks for trying to help. With that command I get: <code>undefined method museum?&#39; for class &#39;#...&#39;</code>"}, {"owner": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "edited": false, "score": 0, "creation_date": 1571221248, "post_id": 58410492, "comment_id": 103165360, "body": "Interesting, do you have a way to replicate this problem? Maybe a small repo."}, {"owner": {"reputation": 616, "user_id": 3258059, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YfxT7.jpg?s=128&g=1", "display_name": "whatapalaver", "link": "https://stackoverflow.com/users/3258059/whatapalaver"}, "reply_to_user": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "edited": false, "score": 0, "creation_date": 1571221825, "post_id": 58410492, "comment_id": 103165625, "body": "I&#39;m working on a rather large legacy codebase so I imagine it would be extremely hard to replicate on a small scale."}, {"owner": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "edited": false, "score": 0, "creation_date": 1571221903, "post_id": 58410492, "comment_id": 103165661, "body": "Got it. Try globally looking where else <code>museum</code> is defined. What&#39;s in the <code>Authority::Abilities</code> file?"}, {"owner": {"reputation": 616, "user_id": 3258059, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YfxT7.jpg?s=128&g=1", "display_name": "whatapalaver", "link": "https://stackoverflow.com/users/3258059/whatapalaver"}, "reply_to_user": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "edited": false, "score": 0, "creation_date": 1571226462, "post_id": 58410492, "comment_id": 103168161, "body": "Not sure about Authority::Abilities is that in the authority.rb file, perhaps this is the section? `  # ABILITIES   # =========   # Teach Authority how to understand the verbs and adjectives in your system.   # Perhaps you need {:microwave =&gt; &#39;microwavable&#39;}. I&#39;m not saying you do, of   # course. Stop looking at me like that.   #   # Defaults are as follows:   #   # config.abilities =  {   #   :create =&gt; &#39;creatable&#39;,   #   :read   =&gt; &#39;readable&#39;,   #   :update =&gt; &#39;updatable&#39;,   #   :delete =&gt; &#39;deletable&#39;   # }`"}, {"owner": {"reputation": 616, "user_id": 3258059, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YfxT7.jpg?s=128&g=1", "display_name": "whatapalaver", "link": "https://stackoverflow.com/users/3258059/whatapalaver"}, "reply_to_user": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "edited": false, "score": 0, "creation_date": 1571226562, "post_id": 58410492, "comment_id": 103168212, "body": "I also tried the _suffix trick with <code>enum catalogue: %i[museum library], _suffix: true</code> but I get the same error <code>ArgumentError: You tried to define an enum named &quot;catalogue&quot; on the model &quot;CollectionContext&quot;, but this will generate a instance method &quot;museum_catalogue?&quot;, which is already defined by another enum</code> Which makes me wonder if this issue is relevant.<a href=\"https://github.com/rails/rails/issues/20643\" rel=\"nofollow noreferrer\">github.com/rails/rails/issues/20643</a> Could I be loading the model somewhere else?"}, {"owner": {"reputation": 467, "user_id": 6863652, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ee89337e6aead8c5203cbac4fccc5aa?s=128&d=identicon&r=PG&f=1", "display_name": "Mansi Shah", "link": "https://stackoverflow.com/users/6863652/mansi-shah"}, "edited": false, "score": 0, "creation_date": 1574341185, "post_id": 58410492, "comment_id": 104204204, "body": "I am also facing same issue &amp; there is no duplication in enum values in my codebase too. Did you find any solution for it? @whatapalaver"}, {"owner": {"reputation": 616, "user_id": 3258059, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YfxT7.jpg?s=128&g=1", "display_name": "whatapalaver", "link": "https://stackoverflow.com/users/3258059/whatapalaver"}, "edited": false, "score": 0, "creation_date": 1574349663, "post_id": 58410492, "comment_id": 104209570, "body": "No I&#39;m afraid not..."}, {"owner": {"reputation": 2262, "user_id": 4101569, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/15c4c64e58bc5cdeec8e7ce067131a54?s=128&d=identicon&r=PG", "display_name": "katafrakt", "link": "https://stackoverflow.com/users/4101569/katafrakt"}, "edited": false, "score": 0, "creation_date": 1576084809, "post_id": 58410492, "comment_id": 104786752, "body": "@whatapalaver which version of Rails are you using? I encountered this in 5.1.7 and I&#39;m pretty sure this is Rails bug, although I&#39;m not yet sure what causes it and what&#39;s the solution. Knowing your version would help to narrow the problem down."}, {"owner": {"reputation": 616, "user_id": 3258059, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YfxT7.jpg?s=128&g=1", "display_name": "whatapalaver", "link": "https://stackoverflow.com/users/3258059/whatapalaver"}, "reply_to_user": {"reputation": 2262, "user_id": 4101569, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/15c4c64e58bc5cdeec8e7ce067131a54?s=128&d=identicon&r=PG", "display_name": "katafrakt", "link": "https://stackoverflow.com/users/4101569/katafrakt"}, "edited": false, "score": 0, "creation_date": 1576235941, "post_id": 58410492, "comment_id": 104842850, "body": "Hi @katafrakt I&#39;n using Rails 5.2.2.1"}, {"owner": {"reputation": 2262, "user_id": 4101569, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/15c4c64e58bc5cdeec8e7ce067131a54?s=128&d=identicon&r=PG", "display_name": "katafrakt", "link": "https://stackoverflow.com/users/4101569/katafrakt"}, "edited": false, "score": 0, "creation_date": 1576236902, "post_id": 58410492, "comment_id": 104843362, "body": "@whatapalaver My problem turned out to be caused by defining enum within ActiveSupport.on_load block, which was called every time autoreload in dev kicked in (so, basically, on each request). But in your case it seems to be something else unfortunately."}], "answers": [{"tags": [], "owner": {"reputation": 996, "user_id": 879854, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/30f2de7af9b9f26154c585a3a5a1f824?s=128&d=identicon&r=PG", "display_name": "BF4", "link": "https://stackoverflow.com/users/879854/bf4"}, "is_accepted": false, "score": 1, "last_activity_date": 1603254026, "creation_date": 1603254026, "answer_id": 64456627, "question_id": 58410492, "link": "https://stackoverflow.com/questions/58410492/rails-error-instance-method-already-defined-by-another-enum-but-there-are-no-re/64456627#64456627", "title": "Rails error: instance method already defined by another enum but there are no repeats", "body": "<p>Probably related to having spring or some other such thing running.  Try starting dev with DISABLE_SPRING=1 or just removing spring.</p>\n<p>Other possibilities include there is a boolean column named <code>museum</code> which is where the <code>museum?</code> method is coming from and some other code we don't see.</p>\n<p>In terms of debugging, I'd just open up Rails where the stacktrace is point to the error being raised and use introspection there to see where the detected existing method is defined?  sure, there are other tools in the toolbelt like method_added and tracepoint, but I like the 'find where it's raised and do <code>method(:museum?).source_location</code> or some such.</p>\n<p>To avoid re-evaluating an enum line in my Rails apps I often will define it for example like</p>\n<pre class=\"lang-rb prettyprint-override\"><code>  enum catalogue: %i[museum archive library] unless method_defined?(:museum?)\n</code></pre>\n"}], "owner": {"reputation": 616, "user_id": 3258059, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YfxT7.jpg?s=128&g=1", "display_name": "whatapalaver", "link": "https://stackoverflow.com/users/3258059/whatapalaver"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 691, "favorite_count": 1, "answer_count": 1, "score": 2, "last_activity_date": 1603254026, "creation_date": 1571219505, "last_edit_date": 1571327003, "question_id": 58410492, "link": "https://stackoverflow.com/questions/58410492/rails-error-instance-method-already-defined-by-another-enum-but-there-are-no-re", "title": "Rails error: instance method already defined by another enum but there are no repeats", "body": "<p>I am trying to debug some errors that appear when I run <code>bundle exec rake</code>  tasks.</p>\n\n<pre><code>ArgumentError: You tried to define an enum named \"catalogue\" on the model \"CollectionContext\", but this will generate a instance method \"museum?\", which is already defined by another enum.\n</code></pre>\n\n<p>There are a number of questions on SO relating to this problem but all seem to come down to the use of the same value for different enums within the same model, which can be resolved with the use of _suffix or _prefix.</p>\n\n<p>Here's an excellent explanation of enum usage in Rails <a href=\"https://naturaily.com/blog/ruby-on-rails-enum\" rel=\"nofollow noreferrer\">https://naturaily.com/blog/ruby-on-rails-enum</a></p>\n\n<p>In my case I cannot see a duplicate in my model. How can I debug the error further?</p>\n\n<pre><code>class CollectionContext &lt; ActiveRecord::Base\n  include Authority::Abilities\n  self.authorizer_name = 'ManagedContentAuthorizer'\n\n  has_many :context_sets, inverse_of: :collection_context\n  has_many :museum_collections, through: :context_sets,\n                                source: :contextable,\n                                source_type: 'MuseumCollection'\n\n  enum catalogue: %i[museum archive library]\n  enum vocabulary: {category: 10,\n                    collection: 20,\n                    concept: 30,\n                    event: 40,\n                    gallery: 50,\n                    material: 60,\n                    organisation: 70,\n                    people: 80,\n                    person: 90,\n                    place: 100,\n                    style: 110,\n                    technique: 120}\n\n  validate :check_multiple\n\n  def check_multiple\n    if [identifier, query, query_url].compact.count != 1\n      errors[:base] &lt;&lt; \" cannot set multiple context links\"\n    end\n  end\nend\n</code></pre>\n\n<p>I've now discovered that if I run rake with my rails environment set to TEST, it doesn't show any problems in the console. So it is a development only problem. I have experimented with my gemfile and put all dev only gems into the dev and test group but I still get the error when running rake in dev.</p>\n\n<p>This is my config/development.rb file</p>\n\n<pre><code># frozen_string_literal: true\n\nRails.application.configure do\n  config.webpacker.check_yarn_integrity = false\n  config.cache_classes = false\n  config.eager_load = false\n  config.consider_all_requests_local = true\n  config.action_controller.perform_caching = false\n  config.action_mailer.raise_delivery_errors = false\n  config.active_support.deprecation = :log\n  config.active_record.migration_error = :page_load\n  config.assets.debug = true\n  config.assets.digest = true\n  config.assets.raise_runtime_errors = true\n  config.web_console.whitelisted_ips = '10.xxxx'\nend\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 2345, "user_id": 4988918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/x1BRI.png?s=128&g=1", "display_name": "Mark Merritt", "link": "https://stackoverflow.com/users/4988918/mark-merritt"}, "edited": false, "score": 0, "creation_date": 1571217531, "post_id": 58409790, "comment_id": 103163323, "body": "What is going wrong when you run this query? Please add the issue/output to your question"}, {"owner": {"reputation": 161, "user_id": 2918956, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/9ca0002ba7b1ba0989598bec6431e72d?s=128&d=identicon&r=PG&f=1", "display_name": "Ajith", "link": "https://stackoverflow.com/users/2918956/ajith"}, "reply_to_user": {"reputation": 2345, "user_id": 4988918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/x1BRI.png?s=128&g=1", "display_name": "Mark Merritt", "link": "https://stackoverflow.com/users/4988918/mark-merritt"}, "edited": false, "score": 0, "creation_date": 1571217701, "post_id": 58409790, "comment_id": 103163410, "body": "rows with status Pending and Enrouted are not getting selected."}, {"owner": {"reputation": 2345, "user_id": 4988918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/x1BRI.png?s=128&g=1", "display_name": "Mark Merritt", "link": "https://stackoverflow.com/users/4988918/mark-merritt"}, "edited": false, "score": 0, "creation_date": 1571217828, "post_id": 58409790, "comment_id": 103163480, "body": "Your question/where clause suggests that is the intent...no?"}, {"owner": {"reputation": 161, "user_id": 2918956, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/9ca0002ba7b1ba0989598bec6431e72d?s=128&d=identicon&r=PG&f=1", "display_name": "Ajith", "link": "https://stackoverflow.com/users/2918956/ajith"}, "reply_to_user": {"reputation": 2345, "user_id": 4988918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/x1BRI.png?s=128&g=1", "display_name": "Mark Merritt", "link": "https://stackoverflow.com/users/4988918/mark-merritt"}, "edited": false, "score": 0, "creation_date": 1571217907, "post_id": 58409790, "comment_id": 103163521, "body": "yes. its a wrong query. what i need  as output is different. its in the problem description"}, {"owner": {"reputation": 761, "user_id": 7786120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3acd54907ef6cb3d7de0ebd91177850d?s=128&d=identicon&r=PG&f=1", "display_name": "Akshay Goyal", "link": "https://stackoverflow.com/users/7786120/akshay-goyal"}, "edited": false, "score": 0, "creation_date": 1571218064, "post_id": 58409790, "comment_id": 103163620, "body": "Your query according to your question is correct. Maybe you phrased your question wrong?"}, {"owner": {"reputation": 2345, "user_id": 4988918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/x1BRI.png?s=128&g=1", "display_name": "Mark Merritt", "link": "https://stackoverflow.com/users/4988918/mark-merritt"}, "edited": false, "score": 0, "creation_date": 1571218079, "post_id": 58409790, "comment_id": 103163636, "body": "I do see now but you may want to reword your question to be more clear...and explain what the current output of the query vs expected output"}, {"owner": {"reputation": 161, "user_id": 2918956, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/9ca0002ba7b1ba0989598bec6431e72d?s=128&d=identicon&r=PG&f=1", "display_name": "Ajith", "link": "https://stackoverflow.com/users/2918956/ajith"}, "edited": false, "score": 0, "creation_date": 1571218341, "post_id": 58409790, "comment_id": 103163805, "body": "i made changes. now is it understandable ?"}, {"owner": {"reputation": 761, "user_id": 7786120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3acd54907ef6cb3d7de0ebd91177850d?s=128&d=identicon&r=PG&f=1", "display_name": "Akshay Goyal", "link": "https://stackoverflow.com/users/7786120/akshay-goyal"}, "edited": false, "score": 0, "creation_date": 1571218489, "post_id": 58409790, "comment_id": 103163875, "body": "What happens for other states? For ex: &quot;Pending&quot; also follows the same structure? i.e only pending with updated at within last 24 hours should come and all other objects with state other than &quot;Pending&quot; should come?"}, {"owner": {"reputation": 161, "user_id": 2918956, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/9ca0002ba7b1ba0989598bec6431e72d?s=128&d=identicon&r=PG&f=1", "display_name": "Ajith", "link": "https://stackoverflow.com/users/2918956/ajith"}, "edited": false, "score": 0, "creation_date": 1571218576, "post_id": 58409790, "comment_id": 103163933, "body": "no. only status completed within 24 hours along with all enroute and pending records must come"}, {"owner": {"reputation": 161, "user_id": 2918956, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/9ca0002ba7b1ba0989598bec6431e72d?s=128&d=identicon&r=PG&f=1", "display_name": "Ajith", "link": "https://stackoverflow.com/users/2918956/ajith"}, "edited": false, "score": 0, "creation_date": 1571218786, "post_id": 58409790, "comment_id": 103164068, "body": "in short, all the records must be fetched with all different statuses. if the status is completed then only those status as completed records which were updated within last 24 hours be fetched along with enroute and pending status record"}, {"owner": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "edited": false, "score": 0, "creation_date": 1571219289, "post_id": 58409790, "comment_id": 103164320, "body": "What RDBMS are you using?"}], "answers": [{"tags": [], "owner": {"reputation": 761, "user_id": 7786120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3acd54907ef6cb3d7de0ebd91177850d?s=128&d=identicon&r=PG&f=1", "display_name": "Akshay Goyal", "link": "https://stackoverflow.com/users/7786120/akshay-goyal"}, "is_accepted": true, "score": 1, "last_activity_date": 1571220387, "last_edit_date": 1571220387, "creation_date": 1571219396, "answer_id": 58410467, "question_id": 58409790, "link": "https://stackoverflow.com/questions/58409790/select-table-columns-only-if-it-matches-certain-conditions/58410467#58410467", "title": "select table columns only if it matches certain conditions", "body": "<pre><code>includes(Model2: [:model3, :model4, :model5, :model6])\n               .where(conditions)\n               .where('(Model1.status = ? AND Model1.updated_at &gt; ?) OR ( Model1.status != ?)', \"Completed\", 24.hours.ago, \"Completed\")\n               .order('Model1.created_at DESC')\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "is_accepted": false, "score": 1, "last_activity_date": 1571219407, "creation_date": 1571219407, "answer_id": 58410468, "question_id": 58409790, "link": "https://stackoverflow.com/questions/58409790/select-table-columns-only-if-it-matches-certain-conditions/58410468#58410468", "title": "select table columns only if it matches certain conditions", "body": "<p>So you basically need this:</p>\n\n<pre><code>Model.where('Completed', 24.hours.ago)\n     .or(Model.where(status: ['pending', 'enroute']))\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 5060, "user_id": 10522579, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7GQ6a.jpg?s=128&g=1", "display_name": "ray", "link": "https://stackoverflow.com/users/10522579/ray"}, "is_accepted": false, "score": 0, "last_activity_date": 1571220625, "last_edit_date": 1571220625, "creation_date": 1571220189, "answer_id": 58410707, "question_id": 58409790, "link": "https://stackoverflow.com/questions/58409790/select-table-columns-only-if-it-matches-certain-conditions/58410707#58410707", "title": "select table columns only if it matches certain conditions", "body": "<p>You can do following,</p>\n\n<pre><code>Model.where('Model1.status = ? AND Model1.updated_at &gt; ?', 'Completed', 24.hours.ago)\n     .or(Model.where(status: ['pending', 'enroute']))\n</code></pre>\n\n<p>Or you can go through <code>Arel</code>,</p>\n\n<pre><code>model = Model.arel_table\narel1 = model[:status].eq('Completed').and(model[:updated_at].gteq(24.hours.ago))\narel2 = model[:status].in(['pending', 'enroute'])\n\nModel.where(arel1.or(arel2))\n</code></pre>\n"}], "owner": {"reputation": 161, "user_id": 2918956, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/9ca0002ba7b1ba0989598bec6431e72d?s=128&d=identicon&r=PG&f=1", "display_name": "Ajith", "link": "https://stackoverflow.com/users/2918956/ajith"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 49, "favorite_count": 0, "accepted_answer_id": 58410467, "answer_count": 3, "score": 0, "last_activity_date": 1571220625, "creation_date": 1571217183, "last_edit_date": 1571219151, "question_id": 58409790, "link": "https://stackoverflow.com/questions/58409790/select-table-columns-only-if-it-matches-certain-conditions", "title": "select table columns only if it matches certain conditions", "body": "<p>Rails 5.2 ruby 2.6</p>\n\n<p>Hi all,</p>\n\n<p>I have a model which has status and updated_at created_at columns(also has few other columns). possible status values can be 'Pending', 'Enroute', 'Completed'.</p>\n\n<p>I want to query the table such that:</p>\n\n<ul>\n<li>All the records must come with status Pending, Enroute and Completed. </li>\n<li>If the status is 'completed' then its updated_at must be within the last 24 hours.\n\n<ul>\n<li>All other records with status 'completed' with different timestamps should not be selected.</li>\n</ul></li>\n</ul>\n\n<pre class=\"lang-rb prettyprint-override\"><code>@result =\n  Model1.includes(Model2: [:model3, :model4, :model5, :model6])\n        .where(conditions)\n        .where('Model1.status = ? AND Model1.updated_at &gt; ?', 'Completed', 24.hours.ago)\n        .order('Model1.created_at DESC') \n</code></pre>\n\n<p>The above is a sample structure of the active record querying. This query only prints completed within last 24 hours. but all other status are not collected.</p>\n"}, {"tags": ["android", "ruby", "bitbucket-pipelines"], "answers": [{"tags": [], "owner": {"reputation": 3819, "user_id": 2183102, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/750da49ea5892511d8211bbe9e3c8c7f?s=128&d=identicon&r=PG", "display_name": "Alexander Zhukov", "link": "https://stackoverflow.com/users/2183102/alexander-zhukov"}, "is_accepted": true, "score": 0, "last_activity_date": 1571237158, "creation_date": 1571237158, "answer_id": 58416065, "question_id": 58409504, "link": "https://stackoverflow.com/questions/58409504/running-pipelines-with-an-android-build-environment-image-and-ruby/58416065#58416065", "title": "Running pipelines with an android build environment image and ruby", "body": "<p>The <code>uber/android-build-environment:latest</code> uses a non-root user, which doesn't have permissions to run some commands, for example <code>apt-get</code>. You should rebuild an image with root user or temporary change the user to root. In your <code>Dockerfile</code> add:</p>\n\n<pre><code>USER root\n\ninstall/updates\n\nUSER solr\n</code></pre>\n\n<p>See more details about the issue here <a href=\"https://stackoverflow.com/questions/32576928/how-to-install-new-packages-into-non-root-docker-container\">How to install new packages into non-root Docker Container?</a></p>\n\n<p>P.S. You don't need to run pipeline as root. If you run under the root inside the docker container, you will be able to install your dependencies.</p>\n"}, {"tags": [], "owner": {"reputation": 9280, "user_id": 987753, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/e48a721814fa3a27f8a1eaedcc328cfa?s=128&d=identicon&r=PG&f=1", "display_name": "kingston", "link": "https://stackoverflow.com/users/987753/kingston"}, "is_accepted": false, "score": 0, "last_activity_date": 1571388493, "last_edit_date": 1571388493, "creation_date": 1571303343, "answer_id": 58428909, "question_id": 58409504, "link": "https://stackoverflow.com/questions/58409504/running-pipelines-with-an-android-build-environment-image-and-ruby/58428909#58428909", "title": "Running pipelines with an android build environment image and ruby", "body": "<p>I ended using a different android build env image:</p>\n\n<pre><code>image: mingc/android-build-box:v1.2.0\n\npipelines:\n  default:\n    - step:\n        caches:\n          - gradle\n          - gradlewrapper\n          - androidavd\n          - bundler\n        script:\n          - apt-get update &amp;&amp; apt-get install -y awscli\n          - gem update --system\n          - gem install bundler\n          - gem install danger\n          - bundle install\n          - bundle exec fastlane test\n          - bundle exec fastlane build\ndefinitions:\n  caches:\n    gradlewrapper: ~/.gradle/wrapper\n    androidavd: $ANDROID_HOME/.android/avd\n    bundler: ./vendor\n</code></pre>\n"}], "owner": {"reputation": 9280, "user_id": 987753, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/e48a721814fa3a27f8a1eaedcc328cfa?s=128&d=identicon&r=PG&f=1", "display_name": "kingston", "link": "https://stackoverflow.com/users/987753/kingston"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 104, "favorite_count": 0, "accepted_answer_id": 58416065, "answer_count": 2, "score": 0, "last_activity_date": 1571388493, "creation_date": 1571216271, "question_id": 58409504, "link": "https://stackoverflow.com/questions/58409504/running-pipelines-with-an-android-build-environment-image-and-ruby", "title": "Running pipelines with an android build environment image and ruby", "body": "<p>I'm using the following yml file</p>\n\n<pre><code>image: uber/android-build-environment:latest\n\npipelines:\n  default:\n    - step:\n        caches:\n          - bundler\n        script: # Modify the commands below to build your repository.\n          - apt-get update &amp;&amp; apt-get install -y awscli\n          - apt-get install rubygems\n          - gem install bundler\n          - bundle install\n          - bundle exec fastlane test\n          - bundle exec fastlane build\ndefinitions:\n  caches:\n    bundler: ./vendor\n</code></pre>\n\n<p>Please notice that I'm using an Android build environment image.</p>\n\n<p>The build fails on</p>\n\n<p>apt-get install rubygems\nwith the error:</p>\n\n<blockquote>\n  <p>E: Could not open lock file /var/lib/dpkg/lock - open (13: Permission\n  denied)E: Unable to lock the administration directory\n  (/var/lib/dpkg/), are you root?</p>\n</blockquote>\n\n<p>so it looks like the build script does not run as root.</p>\n\n<p>If I try to use <code>sudo</code>, it fails with the error</p>\n\n<blockquote>\n  <p>sudo: no tty present and no askpass program specified</p>\n</blockquote>\n\n<p>What should I do to be able to run ruby gems with an Android build environment image?</p>\n"}, {"tags": ["arrays", "ruby", "string"], "comments": [{"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1571215094, "post_id": 58409003, "comment_id": 103161997, "body": "Is this vanilla ruby, or in a rails project? I ask because there&#39;s an <code>ActiveSupport</code> method that might help: <code>String#dasherize</code>."}, {"owner": {"reputation": 765, "user_id": 9015957, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xwHPf.jpg?s=128&g=1", "display_name": "vikas95prasad", "link": "https://stackoverflow.com/users/9015957/vikas95prasad"}, "reply_to_user": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1571215298, "post_id": 58409003, "comment_id": 103162116, "body": "@TomLord String#dasherize will do this  dasherize(&#39;puni_puni&#39;) # =&gt; &quot;puni-puni&quot;  <a href=\"https://api.rubyonrails.org/classes/ActiveSupport/Inflector.html#method-i-dasherize\" rel=\"nofollow noreferrer\">api.rubyonrails.org/classes/ActiveSupport/&hellip;</a>"}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 2, "creation_date": 1571215361, "post_id": 58409003, "comment_id": 103162150, "body": "Also, can you please clarify what logic you&#39;re aiming to achieve? How do you want to count characters -- before or after truncation? (E.g. Does the <code>&quot;.&quot;</code> count as a character?) And if the truncation ends partway through a word, how should this be handled?"}, {"owner": {"reputation": 765, "user_id": 9015957, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xwHPf.jpg?s=128&g=1", "display_name": "vikas95prasad", "link": "https://stackoverflow.com/users/9015957/vikas95prasad"}, "reply_to_user": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1571215475, "post_id": 58409003, "comment_id": 103162211, "body": "I&#39;m trying to achieve a friendly id i.e url for the blogs. Truncate the words"}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1571216345, "post_id": 58409003, "comment_id": 103162721, "body": "Oh.. and sorry, I meant <a href=\"https://api.rubyonrails.org/classes/ActiveSupport/Inflector.html#method-i-parameterize\" rel=\"nofollow noreferrer\"><code>String#parameterize</code></a> not <code>dasherize</code>. You didn&#39;t answer my question, though: Is this a rails project, or vanilla ruby?"}], "answers": [{"tags": [], "owner": {"reputation": 5060, "user_id": 10522579, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7GQ6a.jpg?s=128&g=1", "display_name": "ray", "link": "https://stackoverflow.com/users/10522579/ray"}, "is_accepted": true, "score": 2, "last_activity_date": 1571227738, "last_edit_date": 1571227738, "creation_date": 1571216168, "answer_id": 58409467, "question_id": 58409003, "link": "https://stackoverflow.com/questions/58409003/how-to-add-in-the-sting-in-ruby/58409467#58409467", "title": "How to add &quot;-&quot; in the sting in ruby", "body": "<p>I assume that your string will be proper text but perhaps it can have full stop (.), comma (,), question mark(?) and exlamation(!). As per your provided example in which you have ommitted full stop, I guess you are removing these special characters. </p>\n\n<p>So here is little attempt to reach upto your scenario,</p>\n\n<pre><code>str = \"This is my string. We need to truncate this string to certain length\"\nstr.downcase.gsub(/[^0-9A-Za-z\\s]/, '').gsub(/\\s+/, '-')\n# =&gt; \"this-is-my-string-we-need-to-truncate-this-string-to-certain-length\"\n</code></pre>\n"}], "owner": {"reputation": 765, "user_id": 9015957, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xwHPf.jpg?s=128&g=1", "display_name": "vikas95prasad", "link": "https://stackoverflow.com/users/9015957/vikas95prasad"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 62, "favorite_count": 0, "accepted_answer_id": 58409467, "answer_count": 1, "score": -1, "last_activity_date": 1571227738, "creation_date": 1571214726, "question_id": 58409003, "link": "https://stackoverflow.com/questions/58409003/how-to-add-in-the-sting-in-ruby", "title": "How to add &quot;-&quot; in the sting in ruby", "body": "<p>Input <code>str = \"This is my string. We need to truncate this string to certain length\"</code></p>\n\n<p>Output <code>str = \"this-is-my-string-we-need\"</code></p>\n\n<p>I tried this but need little bit efficient code : \n<code>str.split(\" \").map{ |word| word + \"-\"}.join()</code></p>\n"}, {"tags": ["ruby"], "answers": [{"tags": [], "owner": {"reputation": 5060, "user_id": 10522579, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7GQ6a.jpg?s=128&g=1", "display_name": "ray", "link": "https://stackoverflow.com/users/10522579/ray"}, "is_accepted": true, "score": 3, "last_activity_date": 1571213238, "creation_date": 1571213238, "answer_id": 58408570, "question_id": 58408311, "link": "https://stackoverflow.com/questions/58408311/ruby-time-parse-incorrectly-returns-timestamp-for-string/58408570#58408570", "title": "Ruby Time.parse incorrectly returns timestamp for String", "body": "<p>Internally <code>time.rb</code> uses, following,</p>\n\n<pre><code>def parse(date, now=self.now)\n  comp = !block_given?\n  d = Date._parse(date, comp)\n  year = d[:year]\n  year = yield(year) if year &amp;&amp; !comp\n  make_time(date, year, d[:mon], d[:mday], d[:hour], d[:min], d[:sec], d[:sec_fraction], d[:zone], now)\nend\n</code></pre>\n\n<p>It used to parse day, month later year by precision, Range of digits when exeed to 3, it consider it as year</p>\n"}], "owner": {"reputation": 979, "user_id": 4544984, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/629540edf2ba1727ddf31b6b102a1510?s=128&d=identicon&r=PG&f=1", "display_name": "Adrian E", "link": "https://stackoverflow.com/users/4544984/adrian-e"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 47, "favorite_count": 0, "accepted_answer_id": 58408570, "answer_count": 1, "score": 4, "last_activity_date": 1571214205, "creation_date": 1571212151, "last_edit_date": 1571214205, "question_id": 58408311, "link": "https://stackoverflow.com/questions/58408311/ruby-time-parse-incorrectly-returns-timestamp-for-string", "title": "Ruby Time.parse incorrectly returns timestamp for String", "body": "<p>I am facing a weird bug (?) in Ruby</p>\n\n<p><code>Time.parse(\"David\").to_i</code> returns \"no time information in \"David\"`</p>\n\n<p><code>Time.parse(\"David1\").to_i</code> returns \"no time information in \"David1\"`</p>\n\n<p>However</p>\n\n<p><code>Time.parse(\"David10\").to_i</code> returns 1570654800</p>\n\n<p>It seems that any string with more than 2 numbers at the end manages to pass the Time conversion in Ruby. Is this a bug? </p>\n\n<p>I am trying to create a single method than can handle conversion of strings to Timestamps where relevant or simply back to strings if conversion is not possible but for instances where my string includes 2+ numbers, it fails</p>\n\n<pre><code>if value.is_a? String\n  # if it's string of a date format\n  begin\n    Time.parse(value).to_i\n  rescue StandardError =&gt; e\n    value.downcase\n  end\n  # it's another object type - probably DateTime, Time or Date\nelse\n  value.nil? ? 0 : value.to_f\nend\n</code></pre>\n"}, {"tags": ["python", "ruby"], "comments": [{"owner": {"reputation": 538888, "user_id": 104349, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/0f4cefeedec5163556751d61625eedd0?s=128&d=identicon&r=PG", "display_name": "Daniel Roseman", "link": "https://stackoverflow.com/users/104349/daniel-roseman"}, "edited": false, "score": 1, "creation_date": 1571210990, "post_id": 58407464, "comment_id": 103159843, "body": "<code>.count</code> is a <i>method</i>. In Python you always need calling parentheses with methods and functions. (Methods themselves are always boolean true.)"}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1571229787, "post_id": 58407464, "comment_id": 103170106, "body": "<i>&quot;So Python evaluates x[0] as well although there is no reason to evaluate it&quot;</i> \u2013 nope, Python evaluates <code>x[0]</code> because <code>x.count &gt; 0</code> returns <code>True</code>. Try to figure out why and you&#39;ll see what&#39;s wrong with your code."}], "answers": [{"tags": [], "owner": {"reputation": 73869, "user_id": 532312, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/kEKs8.jpg?s=128&g=1", "display_name": "Rakesh", "link": "https://stackoverflow.com/users/532312/rakesh"}, "is_accepted": false, "score": 3, "last_activity_date": 1571209583, "creation_date": 1571209583, "answer_id": 58407581, "question_id": 58407464, "link": "https://stackoverflow.com/questions/58407464/how-to-do-this-ruby-if-with-and-in-python-and-not-get-list-index-out-of-range/58407581#58407581", "title": "How to do this Ruby if-with-and in Python and not get list index out of range", "body": "<p>Looks like you need <code>len</code>.</p>\n\n<pre><code>x = []\nif len(x) &gt; 0 and x[0]:\n    print(\"hi ho\")\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 21613, "user_id": 580346, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/ba17945a06aac247b06548d5afe341e8?s=128&d=identicon&r=PG", "display_name": "mrzasa", "link": "https://stackoverflow.com/users/580346/mrzasa"}, "is_accepted": false, "score": 0, "last_activity_date": 1571209609, "creation_date": 1571209609, "answer_id": 58407585, "question_id": 58407464, "link": "https://stackoverflow.com/questions/58407464/how-to-do-this-ruby-if-with-and-in-python-and-not-get-list-index-out-of-range/58407585#58407585", "title": "How to do this Ruby if-with-and in Python and not get list index out of range", "body": "<p>Python <a href=\"https://docs.python.org/3/library/stdtypes.html#boolean-operations-and-or-not\" rel=\"nofollow noreferrer\">supports short-circuiting on <code>and</code></a> so if the first argument is <code>False</code> the second one is not evaluated.</p>\n\n<p><code>x.count &gt; 0</code>  is always true:</p>\n\n<pre><code>In [12]: [].count &gt; 0\nOut[12]: True\n</code></pre>\n\n<p>You should replace it with <code>len(x)</code> and it works correctly:</p>\n\n<pre><code>if len(x) &gt; 0 and x[0]:\n  # ...\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 628, "user_id": 9017295, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e3cf061b31e6325ac190bc226a14aebe?s=128&d=identicon&r=PG&f=1", "display_name": "Torkel Velure", "link": "https://stackoverflow.com/users/9017295/torkel-velure"}, "is_accepted": false, "score": 0, "last_activity_date": 1571209669, "last_edit_date": 1592644375, "creation_date": 1571209669, "answer_id": 58407607, "question_id": 58407464, "link": "https://stackoverflow.com/questions/58407464/how-to-do-this-ruby-if-with-and-in-python-and-not-get-list-index-out-of-range/58407607#58407607", "title": "How to do this Ruby if-with-and in Python and not get list index out of range", "body": "<p>Python does lazy evaluation on boolean expression when using <code>and</code> or <code>or</code>.</p>\n<p>From the docs:</p>\n<blockquote>\n<p>The expression x and y first evaluates x; if x is false, its value is returned; otherwise, y is evaluated and the resulting value is returned.</p>\n<p>The expression x or y first evaluates x; if x is true, its value is returned; otherwise, y is evaluated and the resulting value is returned.</p>\n</blockquote>\n<p>Python list method count() returns count of how many times obj occurs in list.</p>\n<p>You should use <code>len(x)</code> to get the length of a list.</p>\n<pre><code>x = []\nif len(x) &gt; 0 and x[0]:\n  print &quot;hi ho&quot; \n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 538888, "user_id": 104349, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/0f4cefeedec5163556751d61625eedd0?s=128&d=identicon&r=PG", "display_name": "Daniel Roseman", "link": "https://stackoverflow.com/users/104349/daniel-roseman"}, "edited": false, "score": 2, "creation_date": 1571211060, "post_id": 58407687, "comment_id": 103159880, "body": "OP&#39;s Ruby code also expects the existence of x; there&#39;s no need for the name/value error checks."}], "tags": [], "owner": {"reputation": 2025, "user_id": 1440764, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/ukUvD.jpg?s=128&g=1", "display_name": "RightmireM", "link": "https://stackoverflow.com/users/1440764/rightmirem"}, "is_accepted": true, "score": 2, "last_activity_date": 1571211183, "last_edit_date": 1571211183, "creation_date": 1571209934, "answer_id": 58407687, "question_id": 58407464, "link": "https://stackoverflow.com/questions/58407464/how-to-do-this-ruby-if-with-and-in-python-and-not-get-list-index-out-of-range/58407687#58407687", "title": "How to do this Ruby if-with-and in Python and not get list index out of range", "body": "<blockquote>\n  <p>So Python evaluates x[0] as well although there is no reason to evaluate it. </p>\n</blockquote>\n\n<p>I'm assuming this would work for you, in its most basic form: </p>\n\n<pre><code>if len(x) &gt; 0: \n    print(\"Hi Ho!\")\n</code></pre>\n\n<p>This evaluates the length of X, and (if greater than 0) responds True. </p>\n\n<p>However, if the variable \"x\" does not exist, it will error. Evaluating if \"x\" exists at all, and contains at least one item, is (I assume) what you're trying to accomplish with ...</p>\n\n<pre><code>if x[0]:\n    print(\"Hi Ho!\")\n</code></pre>\n\n<p>Python will evaluate to <code>True</code> if the variable <em>exists</em> and contains any value. It will evaluate to <code>False</code> if the variable <em>exists</em>, but <em>does not contain a value</em>. Python will error if the variable does not exist. </p>\n\n<p>So, this may be what you're looking for...</p>\n\n<pre><code>try:\n    if len(x) &gt; 0:\n        print(\"Hi Ho!\")\n    else:\n        print(\"Variable does not seem to contain a value!\")\nexcept (NameError, AttributeError, ValueError): \n    print(\"Variable does not exist!\")\n</code></pre>\n\n<p><strong>EDIT:</strong></p>\n\n<p>Note,that if <code>x</code> exists as a list, but contains no values, <code>len(x)</code> will evaluate to <code>0</code>. However, if you try to evaluate <code>x[0]</code> you will <em>still</em> get an error, but it is a <code>IndexError</code> rather than the \"Variable doesn't exist\" error. </p>\n"}], "owner": {"reputation": 4121, "user_id": 202576, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/bdf45a8317ff3471cdcc7ba2f18c79a1?s=128&d=identicon&r=PG", "display_name": "onknows", "link": "https://stackoverflow.com/users/202576/onknows"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 60, "favorite_count": 0, "accepted_answer_id": 58407687, "answer_count": 4, "score": 2, "last_activity_date": 1571211183, "creation_date": 1571209134, "last_edit_date": 1571209647, "question_id": 58407464, "link": "https://stackoverflow.com/questions/58407464/how-to-do-this-ruby-if-with-and-in-python-and-not-get-list-index-out-of-range", "title": "How to do this Ruby if-with-and in Python and not get list index out of range", "body": "<p>In Ruby I can do something like:</p>\n\n<pre><code>irb(main):001:0&gt; x = []\n=&gt; []\nirb(main):003:0&gt; puts \"hi ho\" if x.count &gt; 0 and x[0]\n=&gt; nil\n</code></pre>\n\n<p>Ruby first evaluates <code>x.count &gt;0</code> as false and does not bother to evaluate <code>x[0]</code>.</p>\n\n<p>In Python I can have for example a file with:</p>\n\n<pre><code>x = []\nif x.count &gt; 0 and x[0]:\n  print \"hi ho\" \n</code></pre>\n\n<p>When I run:</p>\n\n<pre><code>[onknows:/tmp] $ python test-if.py \nTraceback (most recent call last):\n  File \"test-if.py\", line 2, in &lt;module&gt;\n    if x.count &gt; 0 and x[0]:\nIndexError: list index out of range\n[onknows:/tmp] 1\n</code></pre>\n\n<p>So Python evaluates <code>x[0]</code> as well although there is no reason to evaluate it. Is there a way to use only one if and not resort to nested if in Python? I don't want to do something like:</p>\n\n<pre><code>if x.count &gt; 0:\n  if x[0]:\n     print \"hi ho\" \n</code></pre>\n"}, {"tags": ["ruby", "oop", "inheritance", "hierarchy", "class-hierarchy"], "comments": [{"owner": {"reputation": 5060, "user_id": 10522579, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7GQ6a.jpg?s=128&g=1", "display_name": "ray", "link": "https://stackoverflow.com/users/10522579/ray"}, "edited": false, "score": 2, "creation_date": 1571208489, "post_id": 58407188, "comment_id": 103158616, "body": "You must read <a href=\"https://stackoverflow.com/q/4967556/10522579\">Ruby craziness: Class vs Object?</a>"}, {"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 0, "creation_date": 1571212218, "post_id": 58407188, "comment_id": 103160455, "body": "&quot;This might seem stupid, am I missing something?&quot; \u2013 You are missing that you are wrong. <code>Object</code> is not a subclass of <code>Class</code>."}, {"owner": {"reputation": 778, "user_id": 4229641, "user_type": "registered", "accept_rate": 36, "profile_image": "https://i.stack.imgur.com/VxtFd.jpg?s=128&g=1", "display_name": "vishnuprasanth", "link": "https://stackoverflow.com/users/4229641/vishnuprasanth"}, "reply_to_user": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 0, "creation_date": 1571213891, "post_id": 58407188, "comment_id": 103161311, "body": "@J&#246;rgWMittag Yeah I know, I was trying to make sense of what I read <a href=\"https://medium.com/@ensallee/ruby-inheritance-and-object-hierarchy-e0f908630fc7\" rel=\"nofollow noreferrer\">here</a> by imagining that silly scenario"}, {"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 2, "creation_date": 1571215036, "post_id": 58407188, "comment_id": 103161961, "body": "That article makes no sense. It is exactly the same as claiming &quot;<code>&#39;Hello&#39;</code> is an instance of <code>String</code>. <code>String</code> is a subclass of <code>Object</code>. Therefore, <code>&#39;Hello&#39;</code> is a subclass of <code>Object</code>.&quot; In this case, it is much more obvious that this is wrong, since <code>&#39;Hello&#39;</code> isn&#39;t even a class <i>at all</i>, and therefore <i>cannot possibly be</i> a &quot;subclass&quot; of something. The exact same thing is true for <code>Object</code>, except that <code>Object</code> also happens to be a class, which confuses the matter slightly, if you&#39;re not careful about whether you are currently talking about <code>Object</code> as an object or <code>Object</code> as a class."}], "answers": [{"comments": [{"owner": {"reputation": 778, "user_id": 4229641, "user_type": "registered", "accept_rate": 36, "profile_image": "https://i.stack.imgur.com/VxtFd.jpg?s=128&g=1", "display_name": "vishnuprasanth", "link": "https://stackoverflow.com/users/4229641/vishnuprasanth"}, "edited": false, "score": 0, "creation_date": 1571208700, "post_id": 58407266, "comment_id": 103158715, "body": "Object &lt; BasicObject right? Why then Object.class #=&gt; Class ?"}, {"owner": {"reputation": 48413, "user_id": 1279683, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1veuT.jpg?s=128&g=1", "display_name": "Marek Lipka", "link": "https://stackoverflow.com/users/1279683/marek-lipka"}, "reply_to_user": {"reputation": 778, "user_id": 4229641, "user_type": "registered", "accept_rate": 36, "profile_image": "https://i.stack.imgur.com/VxtFd.jpg?s=128&g=1", "display_name": "vishnuprasanth", "link": "https://stackoverflow.com/users/4229641/vishnuprasanth"}, "edited": false, "score": 0, "creation_date": 1571208780, "post_id": 58407266, "comment_id": 103158749, "body": "Because <code>Object</code> is class, you can instantize it with <code>Object.new</code> etc. <code>Kernel</code> is a module mixed into an <code>Object</code> class."}, {"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "reply_to_user": {"reputation": 778, "user_id": 4229641, "user_type": "registered", "accept_rate": 36, "profile_image": "https://i.stack.imgur.com/VxtFd.jpg?s=128&g=1", "display_name": "vishnuprasanth", "link": "https://stackoverflow.com/users/4229641/vishnuprasanth"}, "edited": false, "score": 0, "creation_date": 1571215137, "post_id": 58407266, "comment_id": 103162020, "body": "@vishnuprasanth: The class of a string is <code>String</code>. Does that surprise you? The class of an integer is <code>Integer</code>. Does that surprise you? Then, it shouldn&#39;t surprise you that the class of a class is <code>Class</code>, no?"}, {"owner": {"reputation": 778, "user_id": 4229641, "user_type": "registered", "accept_rate": 36, "profile_image": "https://i.stack.imgur.com/VxtFd.jpg?s=128&g=1", "display_name": "vishnuprasanth", "link": "https://stackoverflow.com/users/4229641/vishnuprasanth"}, "reply_to_user": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 0, "creation_date": 1571216865, "post_id": 58407266, "comment_id": 103162971, "body": "@J&#246;rgWMittag What surprises me is Object.class #=&gt; Class."}, {"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "reply_to_user": {"reputation": 778, "user_id": 4229641, "user_type": "registered", "accept_rate": 36, "profile_image": "https://i.stack.imgur.com/VxtFd.jpg?s=128&g=1", "display_name": "vishnuprasanth", "link": "https://stackoverflow.com/users/4229641/vishnuprasanth"}, "edited": false, "score": 1, "creation_date": 1571216951, "post_id": 58407266, "comment_id": 103163017, "body": "@vishnuprasanth: Because <code>Object</code> is a class, and therefore its class is <code>Class</code>, in <i>exactly the same way</i> that <code>&#39;Hello&#39;</code> is a string, and therefore its class is <code>String</code> and not <code>&#39;Hello&#39;</code>. Now, <code>Object</code> <i>also</i> happens to be an object, in <i>exactly the same way</i> that <code>&#39;Hello&#39;</code> also happens to be an object, which is why both <code>Class</code> and <code>String</code> ultimately inherit from <code>Object</code>."}], "tags": [], "owner": {"reputation": 48413, "user_id": 1279683, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1veuT.jpg?s=128&g=1", "display_name": "Marek Lipka", "link": "https://stackoverflow.com/users/1279683/marek-lipka"}, "is_accepted": false, "score": 2, "last_activity_date": 1571208402, "creation_date": 1571208402, "answer_id": 58407266, "question_id": 58407188, "link": "https://stackoverflow.com/questions/58407188/how-can-ruby-object-be-a-subclass-of-object/58407266#58407266", "title": "How can ruby Object be a subclass of Object?", "body": "<p><code>Object</code> class is NOT a subclass of <code>Class</code>, obviously. In fact, <code>Object</code> is a subclass of <code>BasicObject</code> and a default superclass for other classes:</p>\n\n<pre><code>Object.superclass\n# =&gt; BasicObject\n\nclass A\nend\n\nA.superclass\n# =&gt; Object\n</code></pre>\n\n<p>You've mistaken object's <code>class</code> (which indicates of what class is the given object, <code>Object</code> is a class, so this method indicates properly) with inheritance, I guess.</p>\n"}], "owner": {"reputation": 778, "user_id": 4229641, "user_type": "registered", "accept_rate": 36, "profile_image": "https://i.stack.imgur.com/VxtFd.jpg?s=128&g=1", "display_name": "vishnuprasanth", "link": "https://stackoverflow.com/users/4229641/vishnuprasanth"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 34, "favorite_count": 0, "closed_date": 1571209008, "answer_count": 1, "score": 1, "last_activity_date": 1571208402, "creation_date": 1571208092, "question_id": 58407188, "link": "https://stackoverflow.com/questions/58407188/how-can-ruby-object-be-a-subclass-of-object", "closed_reason": "Duplicate", "title": "How can ruby Object be a subclass of Object?", "body": "<pre><code>2.3.3 :001 &gt; Object.class #=&gt; Class\n2.3.3 :002 &gt; Class.ancestors #=&gt; [Class, Module, Object, Kernel, BasicObject]\n</code></pre>\n\n<p>I just can't wrap my head around this concept.</p>\n\n<p>What I imagine is something like shown below</p>\n\n<pre><code>class Object &lt; Class\n  ...\nend\n\nclass Class &lt; Module\n  ...\nend\n\nclass Module &lt; Object\n  ...\nend\n</code></pre>\n\n<p>This might seem stupid, am I missing something? I can't seem to find any related answers.</p>\n"}, {"tags": ["sql", "ruby-on-rails", "ruby", "activerecord"], "answers": [{"comments": [{"owner": {"reputation": 1285, "user_id": 10443890, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de817ef35c4a2bdd0501efbdc6d9a338?s=128&d=identicon&r=PG&f=1", "display_name": "mr_muscle", "link": "https://stackoverflow.com/users/10443890/mr-muscle"}, "edited": false, "score": 0, "creation_date": 1571208658, "post_id": 58407236, "comment_id": 103158687, "body": "To pull out <code>company_name</code> I need to do either - <code>company_name.first&amp;.value</code> where company_name is equal this whole join."}], "tags": [], "owner": {"reputation": 5060, "user_id": 10522579, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7GQ6a.jpg?s=128&g=1", "display_name": "ray", "link": "https://stackoverflow.com/users/10522579/ray"}, "is_accepted": false, "score": 1, "last_activity_date": 1571208308, "creation_date": 1571208308, "answer_id": 58407236, "question_id": 58407102, "link": "https://stackoverflow.com/questions/58407102/rails-pull-out-and-sort-data-with-join/58407236#58407236", "title": "Rails pull out and sort data with join", "body": "<p>You can sort ascending as below,</p>\n\n<pre><code>  company_name = Process.first.inquiry_field_responses\n                  .joins(:inquiry_field)\n                  .where(inquiry_fields: { name: 'company_name' })\n                  .order(\"inquiry_fields.name\")\n</code></pre>\n\n<p>To sort desceding, use <code>order(\"inquiry_fields.name desc\")</code></p>\n"}], "owner": {"reputation": 1285, "user_id": 10443890, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de817ef35c4a2bdd0501efbdc6d9a338?s=128&d=identicon&r=PG&f=1", "display_name": "mr_muscle", "link": "https://stackoverflow.com/users/10443890/mr-muscle"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 30, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1571208308, "creation_date": 1571207758, "question_id": 58407102, "link": "https://stackoverflow.com/questions/58407102/rails-pull-out-and-sort-data-with-join", "title": "Rails pull out and sort data with join", "body": "<p>I want to pull out and sort all <code>Process</code> by <code>company_name</code>. To get company_name for one process I need to do something like this:</p>\n\n<pre><code>  company_name = Process.first.inquiry_field_responses\n                  .joins(:inquiry_field)\n                  .where(inquiry_fields: { name: 'company_name' })\n\n  company_name.first&amp;.value\n</code></pre>\n\n<p>How to pull out and order those processes by company_name?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "link-to"], "comments": [{"owner": {"reputation": 48413, "user_id": 1279683, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1veuT.jpg?s=128&g=1", "display_name": "Marek Lipka", "link": "https://stackoverflow.com/users/1279683/marek-lipka"}, "edited": false, "score": 1, "creation_date": 1571206301, "post_id": 58406770, "comment_id": 103157718, "body": "Make sure you don&#39;t have any errors in JS console."}, {"owner": {"reputation": 141, "user_id": 10043524, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e81c8d061b996ff7555a797692ce7d7?s=128&d=identicon&r=PG&f=1", "display_name": "leafeve", "link": "https://stackoverflow.com/users/10043524/leafeve"}, "edited": false, "score": 0, "creation_date": 1571207891, "post_id": 58406770, "comment_id": 103158334, "body": "please update your routes"}], "answers": [{"tags": [], "owner": {"reputation": 33, "user_id": 10405030, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MfYo6.jpg?s=128&g=1", "display_name": "Emirhan Kaplan", "link": "https://stackoverflow.com/users/10405030/emirhan-kaplan"}, "is_accepted": false, "score": 0, "last_activity_date": 1571277695, "last_edit_date": 1571277695, "creation_date": 1571271371, "answer_id": 58423209, "question_id": 58406770, "link": "https://stackoverflow.com/questions/58406770/link-to-redirecting-to-show-method-instead-of-delete/58423209#58423209", "title": "link_to redirecting to &quot;SHOW&#39; method instead of &quot;DELETE&quot;", "body": "<p>Probably It's about your layout html code. I had the same problem. If you deleted all the code that rails gives you for layout, it'll do this. So this is the code you need to put in your layout's which you wanna make action as destroy. Put in head tag.</p>\n\n<pre class=\"lang-html prettyprint-override\"><code>&lt;head&gt;\n     &lt;%= csrf_meta_tags %&gt;\n     &lt;%= csp_meta_tag %&gt;\n     &lt;%= stylesheet_link_tag 'application', media: 'all', 'data-turbolinks-track': 'reload' %&gt;\n     &lt;%= javascript_pack_tag 'application', 'data-turbolinks-track': 'reload' %&gt;\n       .\n       .\n       .\n&lt;/head&gt;\n</code></pre>\n\n<p>And this is because as you know html don't(like to idk why) destroy by itself... you need to put certain codes for example like this to make html ruthless :) </p>\n"}], "owner": {"reputation": 145, "user_id": 10546447, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-BMNDe0IgPvo/AAAAAAAAAAI/AAAAAAAAAoo/hKDEMwI4ry0/photo.jpg?sz=128", "display_name": "Sheriff Hussain", "link": "https://stackoverflow.com/users/10546447/sheriff-hussain"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 55, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1571277695, "creation_date": 1571206228, "question_id": 58406770, "link": "https://stackoverflow.com/questions/58406770/link-to-redirecting-to-show-method-instead-of-delete", "title": "link_to redirecting to &quot;SHOW&#39; method instead of &quot;DELETE&quot;", "body": "<pre><code>= link_to multimedium_path(f), method: :delete, data: { confirm: 'Are you sure to delete this multimedia?' } do\n\n     i.fa.fa-trash.fa-lg.mr-2.text-danger \n</code></pre>\n\n<p>When i use link_to, the button is redirecting me to show method of the multimedia controller.\nUsing <code>button_to</code> solves this problem, but the <code>confirm</code> is not working properly.</p>\n\n<pre><code>= button_to multimedium_path(f), method: :delete, data: { confirm: 'Are you sure to delete this multimedia?' } do\n\n     i.fa.fa-trash.fa-lg.mr-2.text-danger \n</code></pre>\n\n<p>Can someone explain to me what is happening? Thank you!!!</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 43, "user_id": 11996777, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd21f38f987e269a12e4476ac6fbe7a9?s=128&d=identicon&r=PG&f=1", "display_name": "sstwg", "link": "https://stackoverflow.com/users/11996777/sstwg"}, "reply_to_user": {"reputation": 5134, "user_id": 1672197, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i8HkV.png?s=128&g=1", "display_name": "orde", "link": "https://stackoverflow.com/users/1672197/orde"}, "edited": false, "score": 0, "creation_date": 1571204722, "post_id": 58406152, "comment_id": 103157152, "body": "fixed question."}], "answers": [{"comments": [{"owner": {"reputation": 43, "user_id": 11996777, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd21f38f987e269a12e4476ac6fbe7a9?s=128&d=identicon&r=PG&f=1", "display_name": "sstwg", "link": "https://stackoverflow.com/users/11996777/sstwg"}, "edited": false, "score": 0, "creation_date": 1571205546, "post_id": 58406571, "comment_id": 103157451, "body": "new_playing_board after this method, for some reason I have an empty array"}, {"owner": {"reputation": 5060, "user_id": 10522579, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7GQ6a.jpg?s=128&g=1", "display_name": "ray", "link": "https://stackoverflow.com/users/10522579/ray"}, "reply_to_user": {"reputation": 43, "user_id": 11996777, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd21f38f987e269a12e4476ac6fbe7a9?s=128&d=identicon&r=PG&f=1", "display_name": "sstwg", "link": "https://stackoverflow.com/users/11996777/sstwg"}, "edited": false, "score": 0, "creation_date": 1571205641, "post_id": 58406571, "comment_id": 103157482, "body": "@sstwg i tested above for empty array, <code>$board = Array.new(9) { &#39;&#39; }</code>"}], "tags": [], "owner": {"reputation": 5060, "user_id": 10522579, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7GQ6a.jpg?s=128&g=1", "display_name": "ray", "link": "https://stackoverflow.com/users/10522579/ray"}, "is_accepted": true, "score": 1, "last_activity_date": 1571205587, "last_edit_date": 1571205587, "creation_date": 1571205242, "answer_id": 58406571, "question_id": 58406152, "link": "https://stackoverflow.com/questions/58406152/why-my-table-is-not-displayed-correctly-ruby/58406571#58406571", "title": "Why my table is not displayed correctly Ruby", "body": "<p>Try following,</p>\n\n<pre><code>def display_playing_board\n    print $board[0..2].join(' | ')\n    puts '', \"---------\"\n    print $board[3..5].join(' | ')\n    puts '', '----------'\n    print $board[6..8].join(' | ')\nend\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 43, "user_id": 11996777, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd21f38f987e269a12e4476ac6fbe7a9?s=128&d=identicon&r=PG&f=1", "display_name": "sstwg", "link": "https://stackoverflow.com/users/11996777/sstwg"}, "is_accepted": false, "score": 0, "last_activity_date": 1571206541, "creation_date": 1571206541, "answer_id": 58406832, "question_id": 58406152, "link": "https://stackoverflow.com/questions/58406152/why-my-table-is-not-displayed-correctly-ruby/58406832#58406832", "title": "Why my table is not displayed correctly Ruby", "body": "<p>all code</p>\n\n<pre><code>def new_playing_board\n    $board = Array.new(NUMBER_SQUARES) { X }\nend\n\ndef display_playing_board\n    puts \n    print \"\\t\", $board[0..2].join('   |  ') \n    puts  ' ', \"\\t---------------\" \n    print \"\\t\", $board[3..5].join('   |  ') \n    puts  ' ', \"\\t---------------\" \n    print \"\\t\", $board[6..8].join('   |  ')\n    puts \nend\n\nnew_playing_board\ndisplay_playing_board\n</code></pre>\n"}], "owner": {"reputation": 43, "user_id": 11996777, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd21f38f987e269a12e4476ac6fbe7a9?s=128&d=identicon&r=PG&f=1", "display_name": "sstwg", "link": "https://stackoverflow.com/users/11996777/sstwg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 55, "favorite_count": 0, "accepted_answer_id": 58406571, "answer_count": 2, "score": 0, "last_activity_date": 1571206541, "creation_date": 1571202905, "last_edit_date": 1571204703, "question_id": 58406152, "link": "https://stackoverflow.com/questions/58406152/why-my-table-is-not-displayed-correctly-ruby", "title": "Why my table is not displayed correctly Ruby", "body": "<p>initial data, fields</p>\n\n<pre><code>puts \" 0 | 1 | 2 \"\nputs \"-----------\"\nputs \" 3 | 4 | 5 \"\nputs \"-----------\"\nputs \" 6 | 7 | 8 \"\n\n#Global const\nEMPTY = \"\"          #empty board\nX = \"X\"             #cross\nO = \"O\"             #toe\nNUMBER_SQUARES = 9  #number of fields on the board\n\n# global var\n$board = []         #playing board\n</code></pre>\n\n<p>Creates a new game board - \na list of nine elements equal to EMPTY and returns it</p>\n\n<pre><code>def new_playing_board\n\n    NUMBER_SQUARES.times do \n        $board &lt;&lt; EMPTY\n        return $board\n    end\n                                # if check pp board [\"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\"]\nend\n</code></pre>\n\n<p>Displays the board passed to her. \nElements of the board are spaces, the letters \"X\", \"O\", \nthen they can be printed with the print function.</p>\n\n<pre><code>def display_playing_board\n    puts \"\\n\\t \", $board[0], \"|\", $board[1], \"|\", $board[2]\n    puts \"\\t\", \"---------\"\n    puts \"\\t \", $board[3], \"|\", $board[4], \"|\", $board[5]\n    puts \"\\t\", \"---------\"\n    puts \"\\t \", $board[6], \"|\", $board[7], \"|\", $board[8], \"\\n\"\nend\n\ndisplay_playing_board\n</code></pre>\n\n<p>Data output</p>\n\n<pre><code>#output.txt\n|\n\n|\n\n\n---------\n\n\n|\n\n|\n\n\n---------\n\n\n|\n\n|\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-5"], "answers": [{"comments": [{"owner": {"reputation": 5060, "user_id": 10522579, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7GQ6a.jpg?s=128&g=1", "display_name": "ray", "link": "https://stackoverflow.com/users/10522579/ray"}, "edited": false, "score": 0, "creation_date": 1571207492, "post_id": 58405893, "comment_id": 103158174, "body": "This is very clean and short"}], "tags": [], "owner": {"reputation": 2345, "user_id": 4988918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/x1BRI.png?s=128&g=1", "display_name": "Mark Merritt", "link": "https://stackoverflow.com/users/4988918/mark-merritt"}, "is_accepted": true, "score": 3, "last_activity_date": 1571201016, "creation_date": 1571201016, "answer_id": 58405893, "question_id": 58405743, "link": "https://stackoverflow.com/questions/58405743/remove-group-by-field-from-final-result-rails/58405893#58405893", "title": "Remove group_by field from final result rails", "body": "<p>Pluck is your friend...</p>\n\n<pre><code>City.pluck(:id, :name).to_h\n</code></pre>\n"}], "owner": {"reputation": 2029, "user_id": 6703569, "user_type": "registered", "accept_rate": 74, "profile_image": "https://lh4.googleusercontent.com/-SEU_x8PjYg4/AAAAAAAAAAI/AAAAAAAAAA8/9Ht4S0ndBuI/photo.jpg?sz=128", "display_name": "Bhawan", "link": "https://stackoverflow.com/users/6703569/bhawan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 259, "favorite_count": 0, "accepted_answer_id": 58405893, "answer_count": 1, "score": 2, "last_activity_date": 1571201016, "creation_date": 1571199830, "question_id": 58405743, "link": "https://stackoverflow.com/questions/58405743/remove-group-by-field-from-final-result-rails", "title": "Remove group_by field from final result rails", "body": "<p>I am using rails 5.2.0.</p>\n\n<p>I have a <code>City</code> model in which <code>id is a Primary key</code> and <code>name</code> represents name of city.</p>\n\n<p>I am using group_by to achieve something like this:</p>\n\n<p>Expected Output: </p>\n\n<pre><code>{10571=&gt;\"\u039corocco Town\", 17741=&gt; \"S-HERTOGENBOSCH\"}\n</code></pre>\n\n<p>I am trying something like this: </p>\n\n<pre><code>City.all.select('name', 'id').group_by(&amp;:id)\n</code></pre>\n\n<p>The result I am getting is:</p>\n\n<pre><code>10571=&gt;[#&lt;City id: 10571, name: \"\u039corocco Town\"&gt;], 17741=&gt;[#&lt;City id: 17741, name: \"S-HERTOGENBOSCH\"&gt;]}\n</code></pre>\n\n<p>The key part is correct. <br>\nI need to <code>get rid of the id field</code> coming in the hash value and also, a single hash value instead of an array with name as key.</p>\n\n<p>Any suggestions? <br></p>\n\n<p>Using group_by is not mandatory. Any other inbuilt functions will also work.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "devise"], "answers": [{"tags": [], "owner": {"reputation": 2345, "user_id": 4988918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/x1BRI.png?s=128&g=1", "display_name": "Mark Merritt", "link": "https://stackoverflow.com/users/4988918/mark-merritt"}, "is_accepted": true, "score": 2, "last_activity_date": 1571203591, "creation_date": 1571203591, "answer_id": 58406267, "question_id": 58405599, "link": "https://stackoverflow.com/questions/58405599/devise-edit-registration-now-working-properly/58406267#58406267", "title": "Devise edit_registration now working properly", "body": "<p>The obvious issue is that you haven't permitted additional parameters, which are just being ignored. </p>\n\n<p>Make sure to read the <a href=\"https://github.com/plataformatec/devise\" rel=\"nofollow noreferrer\">Devise Documentation</a>, in full.</p>\n\n<p>Most likely fix...</p>\n\n<pre><code>class ApplicationController &lt; ActionController::Base\n  before_action :configure_permitted_parameters, if: :devise_controller?\n\n  protected\n\n  def configure_permitted_parameters\n    devise_parameter_sanitizer.permit(:sign_up, keys: [:first_name,\n                                                       :last_name,\n                                                       :contact_no,\n                                                       :address])\n  end\nend\n</code></pre>\n\n<p>In addition to this...your User validations for <code>email</code> and <code>password</code> are redundant (Devise handles this validation for you). </p>\n"}], "owner": {"reputation": 145, "user_id": 10546447, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-BMNDe0IgPvo/AAAAAAAAAAI/AAAAAAAAAoo/hKDEMwI4ry0/photo.jpg?sz=128", "display_name": "Sheriff Hussain", "link": "https://stackoverflow.com/users/10546447/sheriff-hussain"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 169, "favorite_count": 0, "accepted_answer_id": 58406267, "answer_count": 1, "score": 2, "last_activity_date": 1571203591, "creation_date": 1571198545, "question_id": 58405599, "link": "https://stackoverflow.com/questions/58405599/devise-edit-registration-now-working-properly", "title": "Devise edit_registration now working properly", "body": "<p>I am trying to edit the current user's information using the <code>edit_user_registration_path</code>.</p>\n\n<p>This is the code of the edit_registration.html.erb</p>\n\n<pre><code>&lt;h2&gt;Edit &lt;%= resource_name.to_s.humanize %&gt;&lt;/h2&gt;\n\n&lt;%= form_for(resource, as: resource_name, url: registration_path(resource_name), html: { method: :put }) do |f| %&gt;\n  &lt;%= render \"devise/shared/error_messages\", resource: resource %&gt;\n\n\n  &lt;div class=\"field\"&gt;\n    &lt;%= f.label :first_name %&gt;&lt;br /&gt;\n    &lt;%= f.text_field :first_name, autofocus: true, autocomplete: \"email\" %&gt;\n  &lt;/div&gt;\n  &lt;div class=\"field\"&gt;\n    &lt;%= f.label :last_name %&gt;&lt;br /&gt;\n    &lt;%= f.text_field :last_name, autofocus: true, autocomplete: \"email\" %&gt;\n  &lt;/div&gt;\n  &lt;div class=\"field\"&gt;\n    &lt;%= f.label :contact_no %&gt;&lt;br /&gt;\n    &lt;%= f.text_field :contact_no, autofocus: true, autocomplete: \"email\" %&gt;\n  &lt;/div&gt;\n  &lt;div class=\"field\"&gt;\n    &lt;%= f.label :address %&gt;&lt;br /&gt;\n    &lt;%= f.text_field :address, autofocus: true, autocomplete: \"email\" %&gt;\n  &lt;/div&gt;\n  &lt;div class=\"field\"&gt;\n    &lt;%= f.label :email %&gt;&lt;br /&gt;\n    &lt;%= f.email_field :email, autofocus: true, autocomplete: \"email\" %&gt;\n  &lt;/div&gt;\n\n  &lt;% if devise_mapping.confirmable? &amp;&amp; resource.pending_reconfirmation? %&gt;\n    &lt;div&gt;Currently waiting confirmation for: &lt;%= resource.unconfirmed_email %&gt;&lt;/div&gt;\n  &lt;% end %&gt;\n\n  &lt;div class=\"field\"&gt;\n    &lt;%= f.label :password %&gt; &lt;i&gt;(leave blank if you don't want to change it)&lt;/i&gt;&lt;br /&gt;\n    &lt;%= f.password_field :password, autocomplete: \"new-password\" %&gt;\n    &lt;% if @minimum_password_length %&gt;\n      &lt;br /&gt;\n      &lt;em&gt;&lt;%= @minimum_password_length %&gt; characters minimum&lt;/em&gt;\n    &lt;% end %&gt;\n  &lt;/div&gt;\n\n  &lt;div class=\"field\"&gt;\n    &lt;%= f.label :password_confirmation %&gt;&lt;br /&gt;\n    &lt;%= f.password_field :password_confirmation, autocomplete: \"new-password\" %&gt;\n  &lt;/div&gt;\n\n  &lt;div class=\"field\"&gt;\n    &lt;%= f.label :current_password %&gt; &lt;i&gt;(we need your current password to confirm your changes)&lt;/i&gt;&lt;br /&gt;\n    &lt;%= f.password_field :current_password, autocomplete: \"current-password\" %&gt;\n  &lt;/div&gt;\n\n  &lt;div class=\"actions\"&gt;\n    &lt;%= f.submit \"Update\" %&gt;\n  &lt;/div&gt;\n&lt;% end %&gt;\n\n&lt;h3&gt;Cancel my account&lt;/h3&gt;\n\n&lt;p&gt;Unhappy? &lt;%= button_to \"Cancel my account\", registration_path(resource_name), data: { confirm: \"Are you sure?\" }, method: :delete %&gt;&lt;/p&gt;\n\n&lt;%= link_to \"Back\", :back %&gt;\n\n</code></pre>\n\n<p>After I click the update button, i am redirected another page, and i get a flash message that says 'Your account has been updated successfully.'</p>\n\n<p>But the information is not updated at all, and same old information is being displayed. </p>\n\n<p>Additional Information: \nAlso i have some validations in the <code>user.rb</code> model file, as:</p>\n\n<pre><code>  validates :email, :password, presence: true, on: :create\n  validates :email, uniqueness: true\n  validates :password, confirmation: true, if: :password_present?\n  enum kind: {Admin: 0, Publisher: 1, Editor: 2}\n\n  def password_present?\n    password.present?\n  end\n</code></pre>\n\n<p>This file is used for the other edit page that i have for user in the path <code>edit_organization_user_path</code>.</p>\n\n<pre><code>= form_for [current_organization,@user] do |f|\n  - if @user.errors.any?\n    #error_explanation\n      h2 = \"#{pluralize(@user.errors.count, \"error\")} prohibited this organization from being saved:\"\n      ul\n        - @user.errors.full_messages.each do |message|\n          li = message\n  .field\n    = f.label :first_name\n    = f.text_field :first_name\n  .field\n    = f.label :last_name\n    = f.text_field :last_name\n  .field\n    = f.label :contact_no\n    = f.text_field :contact_no\n  .field\n    = f.label :address\n    = f.text_field :address\n  .field\n    = f.label :email\n    = f.text_field :email\n  .field\n    = f.label :password\n    = f.password_field :password, autocomplete: 'disabled'\n  .field\n    = f.label :password_confirmation\n    = f.password_field :password_confirmation\n  .actions = f.submit\n  = link_to \"Back\", organizations_path\n</code></pre>\n"}, {"tags": ["ruby", "gitlab", "jekyll", "gitlab-ci", "jekyll-theme"], "answers": [{"comments": [{"owner": {"reputation": 141, "user_id": 10682895, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nNBpS.jpg?s=128&g=1", "display_name": "Adri&#225;n Jaramillo", "link": "https://stackoverflow.com/users/10682895/adri%c3%a1n-jaramillo"}, "edited": false, "score": 0, "creation_date": 1571210227, "post_id": 58406923, "comment_id": 103159498, "body": "The reason why I commented all the gem lines in the Gemfile is because the vm in gitlab was saying that it couldn&#39;t find the gems in the gem source. This was so strange for me because in my Gemfile, the gem source is the default one, and I also checked that the gems exist in that source. In addition, this was all working on my local vm. So, I reached the solution that I needed to install the gems in the .gitlab-ci.yml, but then I came across with this error. What do you think then I should do?"}, {"owner": {"reputation": 141, "user_id": 10682895, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nNBpS.jpg?s=128&g=1", "display_name": "Adri&#225;n Jaramillo", "link": "https://stackoverflow.com/users/10682895/adri%c3%a1n-jaramillo"}, "edited": false, "score": 0, "creation_date": 1571211142, "post_id": 58406923, "comment_id": 103159917, "body": "anyways I&#39;ll try what you said again, maybe magic happens @David Jacquel"}, {"owner": {"reputation": 141, "user_id": 10682895, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nNBpS.jpg?s=128&g=1", "display_name": "Adri&#225;n Jaramillo", "link": "https://stackoverflow.com/users/10682895/adri%c3%a1n-jaramillo"}, "edited": false, "score": 0, "creation_date": 1571231695, "post_id": 58406923, "comment_id": 103171299, "body": "I&#39;ll mark your answer as the solution because it actually solved the question. The problem now is that the webpage is deployed in a weird way. I mean, the css is broken and some links doesn&#39;t work. You can check the gitlab page of the repository if you want to see and maybe you know what happened. Anyways, I&#39;ll open here another post to ask about that"}, {"owner": {"reputation": 15926, "user_id": 474597, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/cf5fcf12effe4798f02aa84def25c684?s=128&d=identicon&r=PG", "display_name": "lulalala", "link": "https://stackoverflow.com/users/474597/lulalala"}, "reply_to_user": {"reputation": 141, "user_id": 10682895, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nNBpS.jpg?s=128&g=1", "display_name": "Adri&#225;n Jaramillo", "link": "https://stackoverflow.com/users/10682895/adri%c3%a1n-jaramillo"}, "edited": false, "score": 0, "creation_date": 1590680675, "post_id": 58406923, "comment_id": 109777941, "body": "@Adri&#225;nJaramillo you need to set <code>url</code> properly for the CSS url to be accssible."}], "tags": [], "owner": {"reputation": 46692, "user_id": 1548376, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qCZQw.gif?s=128&g=1", "display_name": "David Jacquel", "link": "https://stackoverflow.com/users/1548376/david-jacquel"}, "is_accepted": true, "score": 1, "last_activity_date": 1571206996, "creation_date": 1571206996, "answer_id": 58406923, "question_id": 58403499, "link": "https://stackoverflow.com/questions/58403499/using-jekyll-with-gitlab-pages-it-says-when-its-deploying-the-website-with-git/58406923#58406923", "title": "Using jekyll with gitlab pages, it says when it&#39;s deploying the website with gitlab CI that theme could not be found, and I already installed it", "body": "<p>In your <code>Gemfile</code>, uncomment <code>#gem \"jekyll-theme-basically-basic\"</code> to read <code>gem \"jekyll-theme-basically-basic\"</code>.</p>\n\n<p>For some reasons, in your <code>.gitlab-ci.yml</code>, all the <code>gem install ...</code> are useless, and it's the <code>bundle install</code> that does the required job.</p>\n"}], "owner": {"reputation": 141, "user_id": 10682895, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nNBpS.jpg?s=128&g=1", "display_name": "Adri&#225;n Jaramillo", "link": "https://stackoverflow.com/users/10682895/adri%c3%a1n-jaramillo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 265, "favorite_count": 0, "accepted_answer_id": 58406923, "answer_count": 1, "score": 0, "last_activity_date": 1571206996, "creation_date": 1571179441, "question_id": 58403499, "link": "https://stackoverflow.com/questions/58403499/using-jekyll-with-gitlab-pages-it-says-when-its-deploying-the-website-with-git", "title": "Using jekyll with gitlab pages, it says when it&#39;s deploying the website with gitlab CI that theme could not be found, and I already installed it", "body": "<h2>My objetive</h2>\n\n<p>To have a repository with the jekyll site configuration files (but not the _site), and each time I push to the repository, a gitlab pipeline runs. With that pipeline, the site is build with Jekyll (I'm using this theme <a href=\"https://github.com/mmistakes/jekyll-theme-basically-basic\" rel=\"nofollow noreferrer\">https://github.com/mmistakes/jekyll-theme-basically-basic</a>)</p>\n\n<h2>A quick view on the essential files which I'm troubling with</h2>\n\n<p>Gemfile</p>\n\n<pre><code>source \"https://rubygems.org\"\n# Hello! This is where you manage which Jekyll version is used to run.\n# When you want to use a different version, change it below, save the\n# file and run `bundle install`. Run Jekyll with `bundle exec`, like so:\n#\n#     bundle exec jekyll serve\n#\n# This will help ensure the proper Jekyll version is running.\n# Happy Jekylling!\ngem \"jekyll\", \"~&gt; 4.0.0\"\n# This is the default theme for new Jekyll sites. You may change this to anything you like.\n\n#######\n#THEMES\n#######\n\n# MANUALLY COMMENTED\n#gem \"minima\", \"~&gt; 2.5\"\n# New content by me\n#gem \"jekyll-theme-basically-basic\"\n#gem 'jekyll-theme-basically-basic', '~&gt; 1.4', '&gt;= 1.4.4'\n\n########################\n\n\n\n# If you want to use GitHub Pages, remove the \"gem \"jekyll\"\" above and\n# uncomment the line below. To upgrade, run `bundle update github-pages`.\n# gem \"github-pages\", group: :jekyll_plugins\n# If you have any plugins, put them here!\ngroup :jekyll_plugins do\n  gem \"jekyll-feed\", \"~&gt; 0.12\"\nend\n\n# Windows and JRuby does not include zoneinfo files, so bundle the tzinfo-data gem\n# and associated library.\ninstall_if -&gt; { RUBY_PLATFORM =~ %r!mingw|mswin|java! } do\n  # gem \"tzinfo\", \"~&gt; 1.2\"\n  # gem \"tzinfo-data\"\nend\n\n# Performance-booster for watching directories on Windows\n# gem \"wdm\", \"~&gt; 0.1.1\", :install_if =&gt; Gem.win_platform?\n\n</code></pre>\n\n<p>Maybe you are wondering why so many comments there. That's because I was having problems with the deployment in gitlab, and I found out that If I installed them in the .gitlab-ci.yml, I wouldn't encounter those problems.  </p>\n\n<p>_config.yml</p>\n\n<pre><code># Welcome to Jekyll!\n#\n# This config file is meant for settings that affect your whole blog, values\n# which you are expected to set up once and rarely edit after that. If you find\n# yourself editing this file very often, consider using Jekyll's data files\n# feature for the data you need to update frequently.\n#\n# For technical reasons, this file is *NOT* reloaded automatically when you use\n# 'bundle exec jekyll serve'. If you change this file, please restart the server process.\n#\n# If you need help with YAML syntax, here are some quick references for you: \n# https://learn-the-web.algonquindesign.ca/topics/markdown-yaml-cheat-sheet/#yaml\n# https://learnxinyminutes.com/docs/yaml/\n#\n# Site settings\n# These are used to personalize your new site. If you look in the HTML files,\n# you will see them accessed via {{ site.title }}, {{ site.email }}, and so on.\n# You can create any custom variable you would like, and they will be accessible\n# in the templates via {{ site.myvariable }}.\n\nlang: es-ES\ntitle: La casa de los titanes\nemail: adristudy@gmail.com\ndescription: &gt;- # this means to ignore newlines until \"baseurl:\"\n  Write an awesome description for your new site here. You can edit this\n  line in _config.yml. It will appear in your document head meta (for\n  Google search results) and in your feed.xml site description.\nbaseurl: \"\" # the subpath of your site, e.g. /blog\nurl: \"\" # the base hostname &amp; protocol for your site, e.g. http://example.com\nauthor:\n  name: Adri\u00e1n Jaramillo\ntwitter_username: sample\ngithub_username: sample\n\n# Build settings\ntheme: jekyll-theme-basically-basic\n#theme: minima\nplugins:\n  - jekyll-feed\n\n# Exclude from processing.\n# The following items will not be processed, by default.\n# Any item listed under the `exclude:` key here will be automatically added to\n# the internal \"default list\".\n#\n# Excluded items can be processed by explicitly listing the directories or\n# their entries' file path in the `include:` list.\n#\n# exclude:\n#   - .sass-cache/\n#   - .jekyll-cache/\n#   - gemfiles/\n#   - Gemfile\n#   - Gemfile.lock\n#   - node_modules/\n#   - vendor/bundle/\n#   - vendor/cache/\n#   - vendor/gems/\n#   - vendor/ruby/\n\n# New content by me \n# theme: jekyll-theme-basically-basic\n\n</code></pre>\n\n<p>.gitlab-ci.yml</p>\n\n<pre><code>image: ruby:2.5\n\npages:\n  script:\n  - gem install jekyll\n  #- gem install minima\n  - gem install jekyll-theme-basically-basic -v 1.4.1\n  - gem install tzinfo -v 1.2.2\n  - gem install tzinfo-data\n  - bundle install\n  - jekyll build --trace -d public/\n  artifacts:\n    paths:\n    - public\n  only:\n  - master\n\n</code></pre>\n\n<h2>Furthermore, you have here the public repository</h2>\n\n<p><a href=\"https://gitlab.com/unveiled_adri/jekyll_project\" rel=\"nofollow noreferrer\">https://gitlab.com/unveiled_adri/jekyll_project</a></p>\n\n<h2>And of course, the whole process of deployment on the docker vm of gitlab, which shows the error</h2>\n\n<pre><code>Running with gitlab-runner 12.3.0 (a8a019e0)\n  on docker-auto-scale ed2dce3a\nUsing Docker executor with image ruby:2.5 ...\nPulling docker image ruby:2.5 ...\nUsing docker image sha256:092689b795107d1b2eadb82494acf4764191baa0aa5bf4673b8ee2a50f70ba97 for ruby:2.5 ...\nRunning on runner-ed2dce3a-project-14628881-concurrent-0 via runner-ed2dce3a-srm-1571178048-5f8825dc...\nFetching changes with git depth set to 50...\nInitialized empty Git repository in /builds/unveiled_adri/jekyll_project/.git/\nCreated fresh repository.\nFrom https://gitlab.com/unveiled_adri/jekyll_project\n * [new ref]         refs/pipelines/89060084 -&gt; refs/pipelines/89060084\n * [new branch]      master                  -&gt; origin/master\nChecking out 745d8811 as master...\n\nSkipping Git submodules setup\n$ gem install jekyll\nSuccessfully installed public_suffix-4.0.1\nSuccessfully installed addressable-2.7.0\nSuccessfully installed colorator-1.1.0\nBuilding native extensions. This could take a while...\nSuccessfully installed http_parser.rb-0.6.0\nBuilding native extensions. This could take a while...\nSuccessfully installed eventmachine-1.2.7\nSuccessfully installed em-websocket-0.5.1\nSuccessfully installed concurrent-ruby-1.1.5\n\nHEADS UP! i18n 1.1 changed fallbacks to exclude default locale.\nBut that may break your application.\n\nPlease check your Rails app for 'config.i18n.fallbacks = true'.\nIf you're using I18n (&gt;= 1.1.0) and Rails (&lt; 5.2.2), this should be\n'config.i18n.fallbacks = [I18n.default_locale]'.\nIf not, fallbacks will be broken in your app by I18n 1.1.x.\n\nFor more info see:\nhttps://github.com/svenfuchs/i18n/releases/tag/v1.1.0\n\nSuccessfully installed i18n-1.7.0\nBuilding native extensions. This could take a while...\nSuccessfully installed ffi-1.11.1\nBuilding native extensions. This could take a while...\nSuccessfully installed sassc-2.2.1\nSuccessfully installed jekyll-sass-converter-2.0.1\nSuccessfully installed rb-fsevent-0.10.3\nSuccessfully installed rb-inotify-0.10.0\nSuccessfully installed listen-3.2.0\nSuccessfully installed jekyll-watch-2.2.1\nSuccessfully installed kramdown-2.1.0\nSuccessfully installed kramdown-parser-gfm-1.1.0\nSuccessfully installed liquid-4.0.3\nSuccessfully installed mercenary-0.3.6\nSuccessfully installed forwardable-extended-2.6.0\nSuccessfully installed pathutil-0.16.2\nSuccessfully installed rouge-3.12.0\nSuccessfully installed safe_yaml-1.0.5\nSuccessfully installed unicode-display_width-1.6.0\nSuccessfully installed terminal-table-1.8.0\n-------------------------------------------------------------------------------------\nJekyll 4.0 comes with some major changes, notably:\n\n  * Our `link` tag now comes with the `relative_url` filter incorporated into it.\n    You should no longer prepend `{{ site.baseurl }}` to `{% link foo.md %}`\n    For further details: https://github.com/jekyll/jekyll/pull/6727\n\n  * Our `post_url` tag now comes with the `relative_url` filter incorporated into it.\n    You shouldn't prepend `{{ site.baseurl }}` to `{% post_url 2019-03-27-hello %}`\n    For further details: https://github.com/jekyll/jekyll/pull/7589\n\n  * Support for deprecated configuration options has been removed. We will no longer\n    output a warning and gracefully assign their values to the newer counterparts\n    internally.\n-------------------------------------------------------------------------------------\nSuccessfully installed jekyll-4.0.0\n26 gems installed\n$ gem install jekyll-theme-basically-basic -v 1.4.1\nSuccessfully installed i18n-0.9.5\nSuccessfully installed sass-listen-4.0.0\n\nRuby Sass has reached end-of-life and should no longer be used.\n\n* If you use Sass as a command-line tool, we recommend using Dart Sass, the new\n  primary implementation: https://sass-lang.com/install\n\n* If you use Sass as a plug-in for a Ruby web framework, we recommend using the\n  sassc gem: https://github.com/sass/sassc-ruby#readme\n\n* For more details, please refer to the Sass blog:\n  https://sass-lang.com/blog/posts/7828841\n\nSuccessfully installed sass-3.7.4\nSuccessfully installed jekyll-sass-converter-1.5.2\nSuccessfully installed kramdown-1.17.0\nSuccessfully installed jekyll-3.8.6\nSuccessfully installed jekyll-sitemap-1.3.1\nSuccessfully installed jekyll-seo-tag-2.6.1\nSuccessfully installed jekyll-paginate-1.1.0\nSuccessfully installed jekyll-feed-0.12.1\nSuccessfully installed jekyll-theme-basically-basic-1.4.1\n11 gems installed\n$ gem install tzinfo -v 1.2.2\nSuccessfully installed thread_safe-0.3.6\nSuccessfully installed tzinfo-1.2.2\n2 gems installed\n$ gem install tzinfo-data\nSuccessfully installed tzinfo-data-1.2019.3\n1 gem installed\n$ bundle install\nFetching gem metadata from https://rubygems.org/...........\nFetching gem metadata from https://rubygems.org/.\nResolving dependencies...\nUsing public_suffix 4.0.1\nUsing addressable 2.7.0\nUsing bundler 1.17.3\nUsing colorator 1.1.0\nUsing concurrent-ruby 1.1.5\nUsing eventmachine 1.2.7\nUsing http_parser.rb 0.6.0\nUsing em-websocket 0.5.1\nUsing ffi 1.11.1\nUsing forwardable-extended 2.6.0\nUsing i18n 1.7.0\nUsing sassc 2.2.1\nUsing jekyll-sass-converter 2.0.1\nUsing rb-fsevent 0.10.3\nUsing rb-inotify 0.10.0\nUsing listen 3.2.0\nUsing jekyll-watch 2.2.1\nUsing kramdown 2.1.0\nUsing kramdown-parser-gfm 1.1.0\nUsing liquid 4.0.3\nUsing mercenary 0.3.6\nUsing pathutil 0.16.2\nUsing rouge 3.12.0\nUsing safe_yaml 1.0.5\nUsing unicode-display_width 1.6.0\nUsing terminal-table 1.8.0\nUsing jekyll 4.0.0\nUsing jekyll-feed 0.12.1\nBundle complete! 2 Gemfile dependencies, 28 gems now installed.\nBundled gems are installed into `/usr/local/bundle`\n$ jekyll build --trace -d public/\nConfiguration file: /builds/unveiled_adri/jekyll_project/_config.yml\n/usr/local/bundle/gems/jekyll-4.0.0/lib/jekyll/theme.rb:76:in `rescue in gemspec': The jekyll-theme-basically-basic theme could not be found. (Jekyll::Errors::MissingDependencyException)\n    from /usr/local/bundle/gems/jekyll-4.0.0/lib/jekyll/theme.rb:73:in `gemspec'\n    from /usr/local/bundle/gems/jekyll-4.0.0/lib/jekyll/theme.rb:18:in `root'\n    from /usr/local/bundle/gems/jekyll-4.0.0/lib/jekyll/theme.rb:12:in `initialize'\n    from /usr/local/bundle/gems/jekyll-4.0.0/lib/jekyll/site.rb:487:in `new'\n    from /usr/local/bundle/gems/jekyll-4.0.0/lib/jekyll/site.rb:487:in `configure_theme'\n    from /usr/local/bundle/gems/jekyll-4.0.0/lib/jekyll/site.rb:58:in `config='\n    from /usr/local/bundle/gems/jekyll-4.0.0/lib/jekyll/site.rb:23:in `initialize'\n    from /usr/local/bundle/gems/jekyll-4.0.0/lib/jekyll/commands/build.rb:30:in `new'\n    from /usr/local/bundle/gems/jekyll-4.0.0/lib/jekyll/commands/build.rb:30:in `process'\n    from /usr/local/bundle/gems/jekyll-4.0.0/lib/jekyll/command.rb:89:in `block in process_with_graceful_fail'\n    from /usr/local/bundle/gems/jekyll-4.0.0/lib/jekyll/command.rb:89:in `each'\n    from /usr/local/bundle/gems/jekyll-4.0.0/lib/jekyll/command.rb:89:in `process_with_graceful_fail'\n    from /usr/local/bundle/gems/jekyll-4.0.0/lib/jekyll/commands/build.rb:18:in `block (2 levels) in init_with_program'\n    from /usr/local/bundle/gems/mercenary-0.3.6/lib/mercenary/command.rb:220:in `block in execute'\n    from /usr/local/bundle/gems/mercenary-0.3.6/lib/mercenary/command.rb:220:in `each'\n    from /usr/local/bundle/gems/mercenary-0.3.6/lib/mercenary/command.rb:220:in `execute'\n    from /usr/local/bundle/gems/mercenary-0.3.6/lib/mercenary/program.rb:42:in `go'\n    from /usr/local/bundle/gems/mercenary-0.3.6/lib/mercenary.rb:19:in `program'\n    from /usr/local/bundle/gems/jekyll-4.0.0/exe/jekyll:15:in `&lt;top (required)&gt;'\n    from /usr/local/bundle/bin/jekyll:23:in `load'\n    from /usr/local/bundle/bin/jekyll:23:in `&lt;main&gt;'\nERROR: Job failed: exit code 1\n</code></pre>\n\n<h2>Conclusion</h2>\n\n<p>I have tried everything but at this almost last point of the deployment I'm completely lost. I could solve the installation problems but now I don't know how to solve this.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "unit-testing", "testing", "rspec"], "comments": [{"owner": {"reputation": 5751, "user_id": 10555785, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LjnQT.jpg?s=128&g=1", "display_name": "chans", "link": "https://stackoverflow.com/users/10555785/chans"}, "edited": false, "score": 0, "creation_date": 1571180054, "post_id": 58403486, "comment_id": 103152077, "body": "Are you using factories and databaserewinder to create objects in db"}, {"owner": {"reputation": 405, "user_id": 5356423, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WIfv6.jpg?s=128&g=1", "display_name": "airvine", "link": "https://stackoverflow.com/users/5356423/airvine"}, "reply_to_user": {"reputation": 5751, "user_id": 10555785, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LjnQT.jpg?s=128&g=1", "display_name": "chans", "link": "https://stackoverflow.com/users/10555785/chans"}, "edited": false, "score": 0, "creation_date": 1571187860, "post_id": 58403486, "comment_id": 103153703, "body": "@chans factories"}, {"owner": {"reputation": 405, "user_id": 5356423, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WIfv6.jpg?s=128&g=1", "display_name": "airvine", "link": "https://stackoverflow.com/users/5356423/airvine"}, "reply_to_user": {"reputation": 5751, "user_id": 10555785, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LjnQT.jpg?s=128&g=1", "display_name": "chans", "link": "https://stackoverflow.com/users/10555785/chans"}, "edited": false, "score": 0, "creation_date": 1571237267, "post_id": 58403486, "comment_id": 103174992, "body": "The alternative that I went for was testing what &#39;set_user&#39; returns. I did expect(controller.set_user).to eq(mockedUser)"}], "answers": [{"tags": [], "owner": {"reputation": 13378, "user_id": 1430810, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/v669u.jpg?s=128&g=1", "display_name": "arieljuod", "link": "https://stackoverflow.com/users/1430810/arieljuod"}, "is_accepted": false, "score": 1, "last_activity_date": 1571180253, "creation_date": 1571180253, "answer_id": 58403588, "question_id": 58403486, "link": "https://stackoverflow.com/questions/58403486/how-do-i-test-an-instance-variable-in-a-controller/58403588#58403588", "title": "How do I test an instance variable in a controller?", "body": "<p>Use <code>assigns(:user)</code> to get the instance variable <code>@user</code>. In your spec, <code>@user</code> is a variable on that test context, it's not the same <code>@user</code> from the controller.</p>\n\n<p><a href=\"https://relishapp.com/rspec/rspec-rails/docs/controller-specs\" rel=\"nofollow noreferrer\">https://relishapp.com/rspec/rspec-rails/docs/controller-specs</a></p>\n"}, {"tags": [], "owner": {"reputation": 2599, "user_id": 12201472, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-PcsKV9F65CQ/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3repCiEtFeVMa1z1D-JpXuqg5wlw6w/photo.jpg?sz=128", "display_name": "Marian13", "link": "https://stackoverflow.com/users/12201472/marian13"}, "is_accepted": false, "score": 1, "last_activity_date": 1571181641, "last_edit_date": 1571181641, "creation_date": 1571180831, "answer_id": 58403660, "question_id": 58403486, "link": "https://stackoverflow.com/questions/58403486/how-do-i-test-an-instance-variable-in-a-controller/58403660#58403660", "title": "How do I test an instance variable in a controller?", "body": "<p>In addition to <a href=\"https://stackoverflow.com/a/58403693/12201472\">@chans</a> and <a href=\"https://stackoverflow.com/a/58403588/12201472\">@arieljuod</a> answers, it worth to mention in order to use <a href=\"https://apidock.com/rails/v5.0.0.1/ActionDispatch/TestProcess/assigns\" rel=\"nofollow noreferrer\"><code>assigns</code></a> in your specs, you need to set up <a href=\"https://github.com/rails/rails-controller-testing\" rel=\"nofollow noreferrer\"><code>rails-controller-testing</code></a> gem, because <a href=\"https://apidock.com/rails/v5.0.0.1/ActionDispatch/TestProcess/assigns\" rel=\"nofollow noreferrer\"><code>assigns</code></a> is deprecated starting from Rails 5.</p>\n\n<pre><code># File actionpack/lib/action_dispatch/testing/test_process.rb, line 6\ndef assigns(key = nil)\n  raise NoMethodError,\n    \"assigns has been extracted to a gem. To continue using it,\n    add `gem 'rails-controller-testing'` to your Gemfile.\"\nend\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 5751, "user_id": 10555785, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LjnQT.jpg?s=128&g=1", "display_name": "chans", "link": "https://stackoverflow.com/users/10555785/chans"}, "is_accepted": false, "score": 1, "last_activity_date": 1571181134, "creation_date": 1571181134, "answer_id": 58403693, "question_id": 58403486, "link": "https://stackoverflow.com/questions/58403486/how-do-i-test-an-instance-variable-in-a-controller/58403693#58403693", "title": "How do I test an instance variable in a controller?", "body": "<p>The controller test case looks like this    </p>\n\n<pre><code>describe 'GET #set_user' do\n  let!(:mock_user) { \n      @mockuserObj = { id: 1, name: \"username\" }\n  }\n  before(:each) do\n    controller.instance_variable_set(:current_user, @mockuserObj)\n    get :set_user\n  end\n  context 'when current_user is present' do\n    it \"sets the current user\" do\n      expect(assigns(:user)).to eq(@mockuserObj)\n    end\n  end\nend\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "edited": false, "score": 2, "creation_date": 1571184780, "post_id": 58403869, "comment_id": 103153094, "body": "I don&#39;t really think your mentors are stupid. They are probably just out of touch with current best practices. If you want more concrete advice on how to write the test then I would ask a new question and describe the application behaviour you want to test instead."}, {"owner": {"reputation": 2345, "user_id": 4988918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/x1BRI.png?s=128&g=1", "display_name": "Mark Merritt", "link": "https://stackoverflow.com/users/4988918/mark-merritt"}, "edited": false, "score": 2, "creation_date": 1571191386, "post_id": 58403869, "comment_id": 103154320, "body": "The optimism in me says that this is just a learning exercise that his mentors gave him to better understand how RSpec/Rails work, especially considering that he already acknowledges that the tests aren&#39;t really doing anything useful because they are already covered by integration specs."}, {"owner": {"reputation": 405, "user_id": 5356423, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WIfv6.jpg?s=128&g=1", "display_name": "airvine", "link": "https://stackoverflow.com/users/5356423/airvine"}, "edited": false, "score": 0, "creation_date": 1571237194, "post_id": 58403869, "comment_id": 103174957, "body": "My mentor is definitely not stupid. I think they mostly want to help me get the idea of how to test and mock things. I do agree that controller specs should not be written as they are going away."}, {"owner": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "edited": false, "score": 0, "creation_date": 1571411592, "post_id": 58403869, "comment_id": 103244831, "body": "There are much better ways to teach that though. One key thing about mocking is that its crucial to understand when to mock and the drawbacks of mocking. The very problem with controller tests in the first place is that they mock too much of the system surrounding the controller which is why you can still get routing errors and other bugs that slip through."}], "tags": [], "owner": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "is_accepted": true, "score": 5, "last_activity_date": 1571183030, "last_edit_date": 1571183030, "creation_date": 1571182635, "answer_id": 58403869, "question_id": 58403486, "link": "https://stackoverflow.com/questions/58403486/how-do-i-test-an-instance-variable-in-a-controller/58403869#58403869", "title": "How do I test an instance variable in a controller?", "body": "<p>Your mentors are being stupid. While it can be good to understand controller specs as they are everywhere in legacy applications adding them to new applications is not a good practice.</p>\n\n<blockquote>\n  <p>For new Rails apps: we don't recommend adding the\n  rails-controller-testing gem to your application. The official\n  recommendation of the Rails team and the RSpec core team is to write\n  request specs instead. Request specs allow you to focus on a single\n  controller action, but unlike controller tests involve the router, the\n  middleware stack, and both rack requests and responses. This adds\n  realism to the test that you are writing, and helps avoid many of the\n  issues that are common in controller specs.</p>\n</blockquote>\n\n<p>DHH explains pretty well what is wrong with testing the instance variables of your controller and what you should be doing instead:</p>\n\n<blockquote>\n  <p>Testing what instance variables are set by your controller is a bad\n  idea. That's grossly overstepping the boundaries of what the test\n  should know about. You can test what cookies are set, what HTTP code\n  is returned, how the view looks, or what mutations happened to the DB,\n  but testing the innards of the controller is just not a good idea.</p>\n</blockquote>\n\n<p>Which is why <code>assigns</code> was extracted to a separate gem. It all boils down to testing what your code does - not how it does it.</p>\n\n<p>See:</p>\n\n<ul>\n<li><a href=\"https://github.com/rspec/rspec-rails/issues/1838\" rel=\"noreferrer\">https://github.com/rspec/rspec-rails/issues/1838</a></li>\n<li><a href=\"https://github.com/rails/rails/issues/22496\" rel=\"noreferrer\">https://github.com/rails/rails/issues/22496</a></li>\n<li><a href=\"https://github.com/rails/rails/issues/18950\" rel=\"noreferrer\">https://github.com/rails/rails/issues/18950</a></li>\n</ul>\n"}], "owner": {"reputation": 405, "user_id": 5356423, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WIfv6.jpg?s=128&g=1", "display_name": "airvine", "link": "https://stackoverflow.com/users/5356423/airvine"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 991, "favorite_count": 0, "accepted_answer_id": 58403869, "answer_count": 4, "score": 1, "last_activity_date": 1571183030, "creation_date": 1571179314, "question_id": 58403486, "link": "https://stackoverflow.com/questions/58403486/how-do-i-test-an-instance-variable-in-a-controller", "title": "How do I test an instance variable in a controller?", "body": "<p>A couple of my mentors have told me to test a piece of code with controller spec even though the contents are being tested by some request specs. I am wondering if I can test whether an instance variable like <code>@user</code> can be set to <code>someObject</code> or <code>nil</code> from within an rspec controller test?</p>\n\n<p>I've tried a couple different ways to test this so far, but my skills regarding rspec testing are to say the least, elementary. The first thing I tried was mocking out the current_user and the 'User.get_from_auth_user(current_user). The mocked object prints fine and outputs. The problem is... I want to be able to say something like <code>expect(@user).to equal(mockedUser)</code> but this never seems to work. I always get something like:</p>\n\n<pre><code>Expect does not equal received\nexpected is nil\nreceived is { someMockedObject }\n</code></pre>\n\n<p>Here is the code I want to test.</p>\n\n<pre><code>class ApplicationController &lt; ActionController::Base\n  before_action :set_user\n\n  def set_user\n    return if current_user.nil?\n\n    @user = User.get_from_auth_user(current_user)\n  end\nend\n</code></pre>\n\n<p>I want to know if I'm going down the right path or what would be the better alternative to fully test this chunk of code. I feel like the answer should be a simple one.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "slack"], "answers": [{"tags": [], "owner": {"reputation": 59, "user_id": 1599186, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/c8249a476cbe567b783366285dd4b4fd?s=128&d=identicon&r=PG", "display_name": "Andres Salazar Lopez", "link": "https://stackoverflow.com/users/1599186/andres-salazar-lopez"}, "is_accepted": false, "score": 0, "last_activity_date": 1583792102, "creation_date": 1583792102, "answer_id": 60609070, "question_id": 58403112, "link": "https://stackoverflow.com/questions/58403112/rails-authentication-with-slack-workspace/60609070#60609070", "title": "Rails: Authentication with slack workspace", "body": "<p>maybe you need to put something like this</p>\n\n<pre><code> Rails.application.config.middleware.use OmniAuth::Builder do\n   provider :slack,\n   ENV['CLIENT_ID'],\n   ENV['CLIENT_SECRET'],\n   scope:'chat:write,commands,im:write,users:read'\n  end \n</code></pre>\n\n<p>and if you are going to use the Api methods you need to configure slack with the token</p>\n\n<pre><code>class SlackMessages\n\n  def Initialize\n\n   Slack.configure do |config|\n    config.token = \"xoxp-xxxxxx234234324...\"\n   end\n\n    @client = ::Slack::Web::Client.new\n\n  end\n\n  def postmessage\n    @client.chat_postMessage(options)\n  end\n\nend\n</code></pre>\n\n<p>create an initializer named slack and put something like this:</p>\n\n<pre><code>Slack::Events.configure do |config|\n  config.signing_secret = ENV['SIGNING_SECRET']\nend\n</code></pre>\n"}], "owner": {"reputation": 555, "user_id": 10813827, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b736f8f0de40f55f19c595a02be8b667?s=128&d=identicon&r=PG&f=1", "display_name": "k10a", "link": "https://stackoverflow.com/users/10813827/k10a"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 110, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1583792102, "creation_date": 1571176243, "question_id": 58403112, "link": "https://stackoverflow.com/questions/58403112/rails-authentication-with-slack-workspace", "title": "Rails: Authentication with slack workspace", "body": "<p>Currently I am trying to add Slack integration into an application. The users on the app should post on the app at the same time post to their own slack workspace automatically.</p>\n\n<p>Gem <code>omniauth_slack</code> makes it access to the workspace I myself own, but this is not working for authenticating with other workspace.</p>\n\n<p><a href=\"https://api.slack.com/docs/oauth\" rel=\"nofollow noreferrer\">The authentication for workspace</a> requires these info below:\n* client_id\n* scope\n* redirect_uri\n* state\n* team</p>\n\n<p>Update <code>omniauth.rb</code> like this.</p>\n\n<pre><code>Rails.application.config.middleware.use OmniAuth::Builder do\n  provider :slack,\n      'CLIENT_ID',\n      scope: 'team:read,users:read,identify,bot',\n      token: \"XXXXXXXXXXXXXXXXXXXXXX\"\nend\n</code></pre>\n\n<p>Other codes are here.</p>\n\n<p><strong>apps/controllers/slack_controller.rb</strong></p>\n\n<pre><code>class SlackController &lt; ApplicationController\n  def callback\n    p request.env['omniauth.auth'].info\n    redirect_to '/'\n  end    \nend\n</code></pre>\n\n<p><strong>apps/views/home/index.html.erb</strong></p>\n\n<pre><code>&lt;%= link_to 'Slack authentication', '/auth/slack' %&gt;\n</code></pre>\n\n<p><strong>Gemfile</strong></p>\n\n<pre><code>gem 'omniauth-slack'\n</code></pre>\n\n<p><strong>config/routes.eb</strong></p>\n\n<pre><code>Rails.application.routes.draw do\n  root 'home#index'\n  get 'auth/:provider/callback' =&gt; 'slack#callback'\n  # For details on the DSL available within this file, see http://guides.rubyonrails.org/routing.html\nend\n</code></pre>\n"}, {"tags": ["ruby", "docker", "passenger"], "answers": [{"tags": [], "owner": {"reputation": 93, "user_id": 6260898, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/3bed447cab30ef3b73089b8a3c56b1df?s=128&d=identicon&r=PG&f=1", "display_name": "Michael Giacomo", "link": "https://stackoverflow.com/users/6260898/michael-giacomo"}, "is_accepted": true, "score": 1, "last_activity_date": 1571775791, "creation_date": 1571775791, "answer_id": 58511765, "question_id": 58402906, "link": "https://stackoverflow.com/questions/58402906/why-is-phusion-passenger-timing-out-after-roughly-60-seconds-within-docker-conta/58511765#58511765", "title": "Why is Phusion Passenger timing out after roughly 60 seconds within docker container running a ruby app?", "body": "<p>Resolved. Turned out to be that I was running my ruby app twice. Had two instances of the run myapp command in the main app.rb and the config.ru rackup config file. Should only have one instance of that in ruby project.</p>\n"}], "owner": {"reputation": 93, "user_id": 6260898, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/3bed447cab30ef3b73089b8a3c56b1df?s=128&d=identicon&r=PG&f=1", "display_name": "Michael Giacomo", "link": "https://stackoverflow.com/users/6260898/michael-giacomo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 656, "favorite_count": 0, "accepted_answer_id": 58511765, "answer_count": 1, "score": 2, "last_activity_date": 1571775791, "creation_date": 1571175128, "last_edit_date": 1592644375, "question_id": 58402906, "link": "https://stackoverflow.com/questions/58402906/why-is-phusion-passenger-timing-out-after-roughly-60-seconds-within-docker-conta", "title": "Why is Phusion Passenger timing out after roughly 60 seconds within docker container running a ruby app?", "body": "<p>I'm running a ruby sinatra app inside passenger within a docker container using one of the passenger-docker images(phusion/passenger-ruby26). This app is a simple web app that makes calls to a database(it does not constantly talk with the database, statements are only called when a certain button is clicked). I can start the app up fine and click around in my web app for a short amount of time but it always errors out at around 60 seconds of uptime saying:</p>\n<blockquote>\n<p>Could not spawn process for application /home/app/my_app: A timeout occurred while starting a preloader process.</p>\n<p>Error ID: 3b9633ef</p>\n<p>Error details saved to: /tmp/passenger-error-aFglsc.html</p>\n</blockquote>\n<p>Mind you this happens even when I don't click anything. Within the html file it states:</p>\n<blockquote>\n<p>The Phusion Passenger application server tried to start the web application, but this took too much time, so Passenger put a stop to that.</p>\n</blockquote>\n<p>It suggests that the server may be low on resources but I've given it unlimited resources(4 core 2.2GHz, 16GB ram, &amp; 4GB swap), here are the load averages(memory used was 3%)</p>\n<p><a href=\"https://i.stack.imgur.com/JQwAQ.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/JQwAQ.png\" alt=\"load averages\" /></a></p>\n<p>Here is the 'Problem Location', shows that it errored out at the 'Load Application' subprocess.</p>\n<p><a href=\"https://i.stack.imgur.com/pchhT.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/pchhT.png\" alt=\"problem location\" /></a></p>\n<p>Things I've tried:</p>\n<ul>\n<li>Running passenger from Nginx(same error)</li>\n<li>Removing all stdout logging functions in my ruby app</li>\n<li>Increasing passenger_start_timeout</li>\n<li>Making sure folder/file privileges are set correctly</li>\n<li>Starting passenger with a custom nginx-config-template that maxes out timeouts and resources</li>\n<li>Gave my docker container unlimited resources</li>\n</ul>\n<p>Tried a few other miscellaneous things that I can't recall but those didn't prove effective either.</p>\n<p>Does anyone have any idea what might be going on? I'll provide more info if needed.</p>\n<p>Versions used:</p>\n<ul>\n<li>Passenger 6.0.3</li>\n<li>Ruby 2.6.3</li>\n<li>Sinatra 2.0.5</li>\n<li>Docker 18.09.0</li>\n</ul>\n<p>Running on MacOS 10.14.6</p>\n"}, {"tags": ["ruby", "amazon-web-services", "aws-sdk", "amazon-route53"], "answers": [{"comments": [{"owner": {"reputation": 3536, "user_id": 5314903, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/63b7f28e96e254a2618902d079e06dba?s=128&d=identicon&r=PG&f=1", "display_name": "Alex Cohen", "link": "https://stackoverflow.com/users/5314903/alex-cohen"}, "edited": false, "score": 0, "creation_date": 1571781125, "post_id": 58493614, "comment_id": 103352862, "body": "So it seems that this is unsupported on any default Aws::Route53 functions.  This may go outside the scope of the original question, but would it be possible to filter for health checks without tags using <a href=\"https://docs.aws.amazon.com/sdkforruby/api/Aws/ResourceGroupsTaggingAPI/Client.html#get_resources-instance_method\" rel=\"nofollow noreferrer\">Aws::ResourceGroupsTaggingAPI::Client.get_resources-instance&zwnj;&#8203;_method</a>? If so what would the correct <code>resource_type_filters</code> arn be? I&#39;ve been attempting to use <code>&quot;route53:::healthcheck&quot;</code> but I think that is incorrect."}, {"owner": {"reputation": 659, "user_id": 2695716, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/51Wgc.jpg?s=128&g=1", "display_name": "Dennis", "link": "https://stackoverflow.com/users/2695716/dennis"}, "reply_to_user": {"reputation": 3536, "user_id": 5314903, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/63b7f28e96e254a2618902d079e06dba?s=128&d=identicon&r=PG&f=1", "display_name": "Alex Cohen", "link": "https://stackoverflow.com/users/5314903/alex-cohen"}, "edited": false, "score": 1, "creation_date": 1571904003, "post_id": 58493614, "comment_id": 103396004, "body": "Created a health check to play with it:  <code>resource_type_filters: [&quot;route53:healthcheck&quot;]</code> worked for me (region: us-east-1)."}, {"owner": {"reputation": 659, "user_id": 2695716, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/51Wgc.jpg?s=128&g=1", "display_name": "Dennis", "link": "https://stackoverflow.com/users/2695716/dennis"}, "reply_to_user": {"reputation": 3536, "user_id": 5314903, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/63b7f28e96e254a2618902d079e06dba?s=128&d=identicon&r=PG&f=1", "display_name": "Alex Cohen", "link": "https://stackoverflow.com/users/5314903/alex-cohen"}, "edited": false, "score": 1, "creation_date": 1571904375, "post_id": 58493614, "comment_id": 103396201, "body": "+ as the documentation indicates, this does only return tagged resources (so it will not work to simplify your code)"}], "tags": [], "owner": {"reputation": 659, "user_id": 2695716, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/51Wgc.jpg?s=128&g=1", "display_name": "Dennis", "link": "https://stackoverflow.com/users/2695716/dennis"}, "is_accepted": true, "score": 3, "last_activity_date": 1571689379, "creation_date": 1571689379, "answer_id": 58493614, "question_id": 58401889, "link": "https://stackoverflow.com/questions/58401889/ruby-awsroute53client-filter-for-objects-without-tags/58493614#58493614", "title": "Ruby Aws::Route53::Client filter for objects without tags", "body": "<p>To do something <em>within</em> the list_tags_for_resources method to make it returned a filtered list, you'd have to monkey patch the method. You could do something like this (untested, probably incorrect, but shows the principle):</p>\n\n<pre><code>module Aws::Route53\n  class Client &lt; Seahorse::Client::Base\n    def list_tags_for_resource(params = {}, options = {})\n      req = build_request(:list_tags_for_resource, params)\n      req.send_request(options)[:resource_tag_sets].select{|check| check[:tags].empty?}.map {|check| check[:resource_id]}\n    end\n  end\nend\n</code></pre>\n"}], "owner": {"reputation": 3536, "user_id": 5314903, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/63b7f28e96e254a2618902d079e06dba?s=128&d=identicon&r=PG&f=1", "display_name": "Alex Cohen", "link": "https://stackoverflow.com/users/5314903/alex-cohen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 98, "favorite_count": 0, "accepted_answer_id": 58493614, "answer_count": 1, "score": 1, "last_activity_date": 1571689379, "creation_date": 1571169692, "last_edit_date": 1571169995, "question_id": 58401889, "link": "https://stackoverflow.com/questions/58401889/ruby-awsroute53client-filter-for-objects-without-tags", "title": "Ruby Aws::Route53::Client filter for objects without tags", "body": "<p>I am gathering up untagged health checks using the ruby Aws::Route53::Client with <a href=\"https://docs.aws.amazon.com/sdkforruby/api/Aws/Route53/Client.html#list_tags_for_resources-instance_method\" rel=\"nofollow noreferrer\">two</a> <a href=\"https://docs.aws.amazon.com/sdkforruby/api/Aws/Route53/Client.html#list_health_checks-instance_method\" rel=\"nofollow noreferrer\">functions</a> and then tagging them.  Right now I am gathering all health checks, then filtering for ones without tags.  Is there a filter I can used to directly gather all the health checks without tags?</p>\n\n<p>Heres the snip of my code that currently does this:</p>\n\n<pre><code>...\n    # lookup checks, list_tags_for_resources has a max search of 10 items\n    checks_search = client.list_health_checks(marker: marker, max_items: 10)\n    ids = checks_search.to_h[:health_checks].map {|check| check[:id]}\n    list_check_tags = client.list_tags_for_resources({\n      resource_type: \"healthcheck\", \n      resource_ids: ids, \n    }).to_h\n\n    untagged = list_check_tags[:resource_tag_sets].select{|check| check[:tags].empty?}.map {|check| check[:resource_id]}\n...\n</code></pre>\n\n<p>At the least is there a way to run <a href=\"https://docs.aws.amazon.com/sdkforruby/api/Aws/Route53/Client.html#list_tags_for_resources-instance_method\" rel=\"nofollow noreferrer\">list_tags_for_resources</a> while only filtering for resources without any tags?</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 16672, "user_id": 22237, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/hkobD.png?s=128&g=1", "display_name": "Kris", "link": "https://stackoverflow.com/users/22237/kris"}, "edited": false, "score": 2, "creation_date": 1571164106, "post_id": 58400598, "comment_id": 103146519, "body": "You can use <code>Thread.new</code>?"}, {"owner": {"reputation": 167912, "user_id": 240443, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/495d675e3bc42ed1dee469e2ce701f1b?s=128&d=identicon&r=PG", "display_name": "Amadan", "link": "https://stackoverflow.com/users/240443/amadan"}, "edited": false, "score": 1, "creation_date": 1571193445, "post_id": 58400598, "comment_id": 103154698, "body": "<code>grosser&#47;parallel</code> is super-easy. What specific problem do you have with it? You could literally just change <code>servers.each</code> with <code>Parallel.each(servers)</code> for the basic functionality. For the problem you had below (server overwhelmed), you can add <code>in_threads: 5</code> or <code>in_processes: 5</code> parameter to limit the number of agents."}, {"owner": {"reputation": 317, "user_id": 6836881, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/c145c9cbd56933e6158bc0200bd144f8?s=128&d=identicon&r=PG&f=1", "display_name": "Steve", "link": "https://stackoverflow.com/users/6836881/steve"}, "edited": false, "score": 0, "creation_date": 1571204500, "post_id": 58400598, "comment_id": 103157080, "body": "Thanks for your encouraging and helpful words, Amadan! I&#39;ll have a second look and give it a try."}, {"owner": {"reputation": 317, "user_id": 6836881, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/c145c9cbd56933e6158bc0200bd144f8?s=128&d=identicon&r=PG&f=1", "display_name": "Steve", "link": "https://stackoverflow.com/users/6836881/steve"}, "edited": false, "score": 1, "creation_date": 1571249160, "post_id": 58400598, "comment_id": 103180917, "body": "Excellent. It&#39;s rather much simpler than I thought, as you said, and working very nicely. Thanks so much, Amadan!"}], "answers": [{"comments": [{"owner": {"reputation": 317, "user_id": 6836881, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/c145c9cbd56933e6158bc0200bd144f8?s=128&d=identicon&r=PG&f=1", "display_name": "Steve", "link": "https://stackoverflow.com/users/6836881/steve"}, "edited": false, "score": 0, "creation_date": 1571168384, "post_id": 58400695, "comment_id": 103148258, "body": "Excellent,. Thanks, Kris! Is it also possible to serialize the output so that I can log all outputs in sequence, server by server?"}, {"owner": {"reputation": 317, "user_id": 6836881, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/c145c9cbd56933e6158bc0200bd144f8?s=128&d=identicon&r=PG&f=1", "display_name": "Steve", "link": "https://stackoverflow.com/users/6836881/steve"}, "edited": false, "score": 0, "creation_date": 1571180686, "post_id": 58400695, "comment_id": 103152250, "body": "Well, just used Thread to launch an ssh job to 100 servers and it made my hosting server sick and I had to reboot it. :)"}], "tags": [], "owner": {"reputation": 16672, "user_id": 22237, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/hkobD.png?s=128&g=1", "display_name": "Kris", "link": "https://stackoverflow.com/users/22237/kris"}, "is_accepted": true, "score": 5, "last_activity_date": 1571164234, "creation_date": 1571164234, "answer_id": 58400695, "question_id": 58400598, "link": "https://stackoverflow.com/questions/58400598/ruby-how-to-run-tasks-in-parallel-in-the-simplest-possible-way/58400695#58400695", "title": "Ruby: How to run tasks in parallel in the simplest possible way", "body": "<pre><code>servers = [ 'server1.example.com', 'server2.example.com', 'server3.example.com' ]\n\ncmd = 'iostat 1 10'\n\nservers.map do |server|\n  Thread.new do\n    puts server\n    system(\"sshpass -f mypwfile ssh #{server} #{cmd}\")\n  end\nend.each(&amp;:join)\n</code></pre>\n\n<p>You need to call <code>join</code> on every thread otherwise they will be killed when the processes main thread exists.</p>\n"}], "owner": {"reputation": 317, "user_id": 6836881, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/c145c9cbd56933e6158bc0200bd144f8?s=128&d=identicon&r=PG&f=1", "display_name": "Steve", "link": "https://stackoverflow.com/users/6836881/steve"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 51, "favorite_count": 0, "accepted_answer_id": 58400695, "answer_count": 1, "score": 1, "last_activity_date": 1571164234, "creation_date": 1571163888, "question_id": 58400598, "link": "https://stackoverflow.com/questions/58400598/ruby-how-to-run-tasks-in-parallel-in-the-simplest-possible-way", "title": "Ruby: How to run tasks in parallel in the simplest possible way", "body": "<p>I'm looking for the simplest possible way to use it handy for system administration in general.</p>\n\n<p>I checked parallel/forkmanager, grosser/parallel, etc. but all seem to be not that simple to grasp.</p>\n\n<pre><code>#!/usr/bin/ruby\n\nservers = [ 'server1.example.com', 'server2.example.com', 'server3.example.com' ]\n\ncmd = 'iostat 1 10'\n\nservers.each do |server|\n  puts server\n  system(\"sshpass -f mypwfile ssh #{server} #{cmd}\")\nend\n</code></pre>\n\n<p>Thanks in advance!</p>\n"}, {"tags": ["ruby", "logging", "activesupport", "ruby-on-rails-6"], "answers": [{"tags": [], "owner": {"reputation": 39041, "user_id": 27358, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/fed1635f89478c88eda07e87de452bcf?s=128&d=identicon&r=PG", "display_name": "David Moles", "link": "https://stackoverflow.com/users/27358/david-moles"}, "is_accepted": false, "score": 1, "last_activity_date": 1571165219, "creation_date": 1571165219, "answer_id": 58400921, "question_id": 58400272, "link": "https://stackoverflow.com/questions/58400272/stop-activesupporttaggedlogging-from-interfering-with-structured-logs/58400921#58400921", "title": "Stop ActiveSupport::TaggedLogging from interfering with structured logs", "body": "<p>The solution given in the <a href=\"https://github.com/tilfin/ougai/wiki/Use-as-Rails-logger#with-activesupporttaggedlogging\" rel=\"nofollow noreferrer\">Ougai docs</a> is to monkey-patch <code>TaggedLogging</code> to eliminate this behavior.</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>module ActiveSupport::TaggedLogging::Formatter\n  def call(severity, time, progname, data)\n    data = { msg: data.to_s } unless data.is_a?(Hash)\n    tags = current_tags\n    data[:tags] = tags if tags.present?\n    _call(severity, time, progname, data)\n  end\nend\n</code></pre>\n\n<p>Note that <code>_call</code> only works if for Ougai-based <code>Formatters</code>.</p>\n"}], "owner": {"reputation": 39041, "user_id": 27358, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/fed1635f89478c88eda07e87de452bcf?s=128&d=identicon&r=PG", "display_name": "David Moles", "link": "https://stackoverflow.com/users/27358/david-moles"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 164, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1571165219, "creation_date": 1571162372, "question_id": 58400272, "link": "https://stackoverflow.com/questions/58400272/stop-activesupporttaggedlogging-from-interfering-with-structured-logs", "title": "Stop ActiveSupport::TaggedLogging from interfering with structured logs", "body": "<p><code>ActiveSupport::TaggedLogging</code> works by appending <code>ActiveSupport::TaggedLogging::Formatter</code> to the inheritance chain of the current formatter via <code>Object#extend</code>.</p>\n\n<p>Unfortunately, <code>ActiveSupport::TaggedLogging::Formatter#call</code>\nassumes the <code>msg</code> argument is always a string, resulting in\ngarbage when it prepends tags to a hash (e.g. with Lograge and <a href=\"https://github.com/tilfin/ougai\" rel=\"nofollow noreferrer\">Ougai</a>). And certain standard libraries, like <a href=\"https://github.com/rails/webpacker/blob/master/lib/webpacker/railtie.rb#L77\" rel=\"nofollow noreferrer\">Webpacker</a>, insist on injecting <code>TaggedLogging</code>.</p>\n\n<p>I've come up with the metaprogramming hack below to prevent <code>ActiveSupport::TaggedLogging::Formatter#call</code> from overriding the superclass implementation (in this case from Ougai):</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>class MyBunyanFormatter &lt; Ougai::Formatters::Bunyan\n  def extend(mod)\n    return super unless mod.method_defined?(:call)\n\n    call_original = self.method(:call)            # 1. preserve original\n    super(mod)                                    # 2. overridden here\n    define_singleton_method(:call, call_original) # 3. de-overridden here\n  end\nend\n</code></pre>\n\n<p>But it's clunky and counterintuitive, and I'm not excited about it.</p>\n\n<p>The other alternative, <a href=\"https://github.com/rails/webpacker/blob/master/lib/webpacker/railtie.rb#L74\" rel=\"nofollow noreferrer\">at least in the case of Webpacker</a>, seems to be to write a custom logger that implements <code>tagged()</code>:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>class MyLogger &lt; Ougai::Logger\n  def tagged(*tags)\n    # do something with tags\n    yield self\n  end\nend\n</code></pre>\n\n<p>This at least doesn't involve any metaprogramming shenanigans, but I wonder if I can count on other libraries besides Webpacker not to inject <code>TaggedLogging</code> anyway.</p>\n\n<p>Surely I'm not the first person to have this problem since people started trying to do structured logging from Rails apps. What's the right solution?</p>\n"}, {"tags": ["ruby", "ruby-on-rails-3", "haml"], "comments": [{"owner": {"reputation": 16672, "user_id": 22237, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/hkobD.png?s=128&g=1", "display_name": "Kris", "link": "https://stackoverflow.com/users/22237/kris"}, "edited": false, "score": 0, "creation_date": 1571164644, "post_id": 58399986, "comment_id": 103146745, "body": "<code>%p draw ! </code> looks suspect"}, {"owner": {"reputation": 16672, "user_id": 22237, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/hkobD.png?s=128&g=1", "display_name": "Kris", "link": "https://stackoverflow.com/users/22237/kris"}, "edited": false, "score": 0, "creation_date": 1571164679, "post_id": 58399986, "comment_id": 103146761, "body": "also it looks like you have indented with tabs instead of double spaces."}, {"owner": {"reputation": 157, "user_id": 9322828, "user_type": "registered", "profile_image": "https://graph.facebook.com/10215722452876336/picture?type=large", "display_name": "Damien Comp&#232;re", "link": "https://stackoverflow.com/users/9322828/damien-comp%c3%a8re"}, "reply_to_user": {"reputation": 16672, "user_id": 22237, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/hkobD.png?s=128&g=1", "display_name": "Kris", "link": "https://stackoverflow.com/users/22237/kris"}, "edited": false, "score": 0, "creation_date": 1571167565, "post_id": 58399986, "comment_id": 103147956, "body": "@Kris yes, but what&#39;s wrong with the %p draw ?"}], "answers": [{"tags": [], "owner": {"reputation": 74087, "user_id": 214790, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f878c8230342730990acd21f889301d4?s=128&d=identicon&r=PG", "display_name": "matt", "link": "https://stackoverflow.com/users/214790/matt"}, "is_accepted": true, "score": 2, "last_activity_date": 1571168941, "creation_date": 1571168941, "answer_id": 58401732, "question_id": 58399986, "link": "https://stackoverflow.com/questions/58399986/haml-ruby-on-rails-error-encountered-a-syntax-error-while-rendering-template/58401732#58401732", "title": "Haml, ruby on rails error: Encountered a syntax error while rendering template", "body": "<p>Your indentation is wrong, I think you want something like this:</p>\n\n<pre><code>%section\n    %article\n        - if @toss % 2 === 0\n            %p the player #{@player_one.name} start the fight !\n        - else \n            %p the player #{@player_two.name} start the fight !\n\n        - while @hp_player_one &gt; 0 &amp;&amp; @hp_player_two &gt; 0 \n            - @hp_player_one -=  @player_two.attack\n            %p  There is only #{@hp_player_one.to_s} point to #{@player_one.name}\n            - @hp_player_two -=  @player_one.attack\n            %p  There is only #{@hp_player_two.to_s} point to #{@player_two.name}\n            -if @hp_player_one &lt;= 0 &amp;&amp; @hp_player_two &gt; 0\n                %p #{@player_one.name} lost \n            -elsif @hp_player_two &lt;= 0 &amp;&amp; @hp_player_one &gt; 0\n                %p #{@player_two.name} lost \n            -else \n                %p draw ! \n</code></pre>\n\n<p>In particular you shouldn\u2019t indent after a line like</p>\n\n<pre><code>- @hp_player_one -=  @player_two.attack\n</code></pre>\n\n<p>as this doesn\u2019t start a block. Haml sees the indentation after this line and assumes that it is the start of a block, and so inserts a corresponding <code>end</code> into the generated Ruby. These extra <code>end</code>s will give you <code>unexpected end, expecting end-of-input</code> syntax errors.</p>\n"}], "owner": {"reputation": 157, "user_id": 9322828, "user_type": "registered", "profile_image": "https://graph.facebook.com/10215722452876336/picture?type=large", "display_name": "Damien Comp&#232;re", "link": "https://stackoverflow.com/users/9322828/damien-comp%c3%a8re"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1428, "favorite_count": 0, "accepted_answer_id": 58401732, "answer_count": 1, "score": 1, "last_activity_date": 1571689219, "creation_date": 1571161168, "last_edit_date": 1571689219, "question_id": 58399986, "link": "https://stackoverflow.com/questions/58399986/haml-ruby-on-rails-error-encountered-a-syntax-error-while-rendering-template", "title": "Haml, ruby on rails error: Encountered a syntax error while rendering template", "body": "<p>I tried to execute the following code but I got:</p>\n\n<pre><code>\"Encountered a syntax error while rendering template:\"\n</code></pre>\n\n<p>Here is my view: </p>\n\n<pre><code>%section\n    %article\n        - if @toss % 2 === 0\n            %p the player #{@player_one.name} start the fight !\n        - else \n            %p the player #{@player_two.name} start the fight !\n\n        - while @hp_player_one &gt; 0 &amp;&amp; @hp_player_two &gt; 0 \n            - @hp_player_one -=  @player_two.attack\n                %p  There is only #{@hp_player_one.to_s} point to #{@player_one.name}\n            - @hp_player_two -=  @player_one.attack\n                %p  There is only #{@hp_player_two.to_s} point to #{@player_two.name}\n                -if @hp_player_one &lt;= 0 &amp;&amp; @hp_player_two &gt; 0\n                    %p #{@player_one.name} lost \n                -elsif @hp_player_two &lt;= 0 &amp;&amp; @hp_player_one &gt; 0\n                    %p #{@player_two.name} lost \n                -else \n                    %p draw ! \n</code></pre>\n\n<p>How do I fix it?</p>\n"}, {"tags": ["ruby", "activerecord"], "comments": [{"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1571166105, "post_id": 58399594, "comment_id": 103147384, "body": "Are you trying to have 1 model connect to 2 databases or individual models connecting to their own databases?"}, {"owner": {"reputation": 124, "user_id": 1412562, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e4c38cf608f86dc02d42a9c8e89b93a4?s=128&d=identicon&r=PG", "display_name": "psulightning", "link": "https://stackoverflow.com/users/1412562/psulightning"}, "reply_to_user": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1571166572, "post_id": 58399594, "comment_id": 103147565, "body": "collections of models connecting to their own databases."}], "owner": {"reputation": 124, "user_id": 1412562, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e4c38cf608f86dc02d42a9c8e89b93a4?s=128&d=identicon&r=PG", "display_name": "psulightning", "link": "https://stackoverflow.com/users/1412562/psulightning"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 246, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1571167175, "creation_date": 1571159276, "last_edit_date": 1571167175, "question_id": 58399594, "link": "https://stackoverflow.com/questions/58399594/activerecord-6-without-rails-multiple-databases", "title": "ActiveRecord 6 without Rails (Multiple Databases)", "body": "<p>I'm aware that Rails 6.x now supports multiple database connections.  However, I am inheriting a codebase written without Rails, but I want to leverage the new feature available in ActiveRecord 6.  Looking through the AR gem, I was able to load the connections manually (set up environment as \"default_env\") and have <code>connects_to</code> running correctly on my model.</p>\n\n<p>Where I am stuck is handling the connection switching.  I am going to assume that I will not be able to use the automatic switching (<a href=\"https://edgeguides.rubyonrails.org/active_record_multiple_databases.html#activating-automatic-connection-switching\" rel=\"nofollow noreferrer\">https://edgeguides.rubyonrails.org/active_record_multiple_databases.html#activating-automatic-connection-switching</a>) since there is no Rack or Rails.  I can in <code>irb</code> do <code>Model.connected_to</code> correctly, but I'm not sure that I would be able to use that on <code>find</code> methods without manually defining those methods.</p>\n\n<p>Is there a way to set up the automatic switching without the <code>ActiveRecord::Middleware::DatabaseSelector</code> or some other way to leverage that class?</p>\n\n<p><strong>UPDATE</strong></p>\n\n<p>database.yml</p>\n\n<pre><code>connection: &amp;conn\n  username: ***\n  password: ***\n  adapter: mysql2\n  host: ***\n  pool: 5\n\ndefault_env:\n  db1:\n    &lt;&lt;: *conn\n    database: db1\n  db2:\n    &lt;&lt;: *conn\n    database: db2\n</code></pre>\n\n<pre class=\"lang-rb prettyprint-override\"><code>\nclass A &lt; ActiveRecord::Base\n#uses db1 connection\nend\n\nclass B &lt; ActiveRecord::Base\nconnects_to database: { writing: :db2, reading: :db2 }\nend\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "excel", "xls", "downloadfile"], "comments": [{"owner": {"reputation": 16672, "user_id": 22237, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/hkobD.png?s=128&g=1", "display_name": "Kris", "link": "https://stackoverflow.com/users/22237/kris"}, "edited": false, "score": 0, "creation_date": 1571164808, "post_id": 58399571, "comment_id": 103146817, "body": "You could try changing the MIME type to <code>text&#47;csv</code>."}], "answers": [{"comments": [{"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 1, "creation_date": 1571170393, "post_id": 58400848, "comment_id": 103148985, "body": "Additionally the MIME type is wrong for an &quot;xls&quot; file any way. &quot;application/vnd.openxmlformats-officedocument.spreadsheetml&zwnj;&#8203;.sheet&quot; would be for a &quot;xlsx&quot; file and &quot;xls&quot; would be &quot;application/vnd.ms-excel&quot;"}, {"owner": {"reputation": 5064, "user_id": 524740, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/d217125368b3d2afc1be2129674d39e2?s=128&d=identicon&r=PG", "display_name": "Prem", "link": "https://stackoverflow.com/users/524740/prem"}, "edited": false, "score": 0, "creation_date": 1571177353, "post_id": 58400848, "comment_id": 103151428, "body": "I have implemented to_csv custom method to return csv/excel depending upon the separator. So, i am trying to download excel fiel here in &#39;xls&#39; format. Tried type: &#39;application/vnd.ms-excel&#39;. I am able to see the data after opening the file. But want to avoid the warning message given above, which could demotivate my customers from downloading/viewing data."}, {"owner": {"reputation": 16672, "user_id": 22237, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/hkobD.png?s=128&g=1", "display_name": "Kris", "link": "https://stackoverflow.com/users/22237/kris"}, "reply_to_user": {"reputation": 5064, "user_id": 524740, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/d217125368b3d2afc1be2129674d39e2?s=128&d=identicon&r=PG", "display_name": "Prem", "link": "https://stackoverflow.com/users/524740/prem"}, "edited": false, "score": 0, "creation_date": 1571230406, "post_id": 58400848, "comment_id": 103170509, "body": "I&#39;d recommend not outputing non-CSV from a method called <code>to_csv</code>. But instead using a separate object, e.g. <code>ConvertToSpreadsheet</code>, which can output the correct format. But anyway it proberbly what @Prem said that the MIME is wrong."}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "reply_to_user": {"reputation": 5064, "user_id": 524740, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/d217125368b3d2afc1be2129674d39e2?s=128&d=identicon&r=PG", "display_name": "Prem", "link": "https://stackoverflow.com/users/524740/prem"}, "edited": false, "score": 0, "creation_date": 1571241094, "post_id": 58400848, "comment_id": 103177265, "body": "@Prem as suggested use 2 different mechanisms one for csv and one for excel. In addition I would recommend generating &quot;xslx&quot; files as they can be read by more than just excel (e.g. OpenOffice, googledocs, etc.) Also what are you using to generate this document as there are very few if any libraries that will generate a &quot;xls&quot; file anyway since that is a Microsoft proprietary binary format"}], "tags": [], "owner": {"reputation": 16672, "user_id": 22237, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/hkobD.png?s=128&g=1", "display_name": "Kris", "link": "https://stackoverflow.com/users/22237/kris"}, "is_accepted": false, "score": 1, "last_activity_date": 1571230482, "last_edit_date": 1571230482, "creation_date": 1571164904, "answer_id": 58400848, "question_id": 58399571, "link": "https://stackoverflow.com/questions/58399571/rails-4-downloaded-excel-file-using-send-data-method-is-giving-format-error/58400848#58400848", "title": "Rails 4 downloaded excel file using send_data method is giving format error", "body": "<p>It isn't an XLS file you are creating but a CSV file, so you should change the filename to <code>'filename.csv'</code>. It will still be openable in Excel.</p>\n\n<p>You might also want to change the MIME type to <code>text/csv</code>.</p>\n\n<p>The correct MIME for an Excel file can be found <a href=\"https://stackoverflow.com/questions/974079/setting-mime-type-for-excel-document\">here</a>.</p>\n"}], "owner": {"reputation": 5064, "user_id": 524740, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/d217125368b3d2afc1be2129674d39e2?s=128&d=identicon&r=PG", "display_name": "Prem", "link": "https://stackoverflow.com/users/524740/prem"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 477, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1571230482, "creation_date": 1571159172, "question_id": 58399571, "link": "https://stackoverflow.com/questions/58399571/rails-4-downloaded-excel-file-using-send-data-method-is-giving-format-error", "title": "Rails 4 downloaded excel file using send_data method is giving format error", "body": "<p>I am downloading data in excel format in my Rails 4 app using send_data method as mentioned below. </p>\n\n<pre><code>send_data collection.to_csv(col_sep: \"\\t\"), \n    type: 'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet',\n    filename: 'filename.xls'\n</code></pre>\n\n<p>I am able to download the data, but while opening the downloaded  excel file, i am getting below warning message.</p>\n\n<pre><code>The file format and extension of 'file.xls' don't match. The file could be corrupted or unsafe.\nUnless you trust its source, dont open it. D want to open it anyway?\n</code></pre>\n\n<p>Even it is warning, it would cause confusion to customers while downloading and opening the file. Any one has any clue about, what is it about and how could it be fixed?</p>\n\n<p>Any help would be greatly appreciated.</p>\n"}, {"tags": ["ruby", "syntax"], "answers": [{"tags": [], "owner": {"reputation": 1892, "user_id": 3158810, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/1ebf9e065f654642fecfee399b439030?s=128&d=identicon&r=PG&f=1", "display_name": "G4143", "link": "https://stackoverflow.com/users/3158810/g4143"}, "is_accepted": false, "score": 0, "last_activity_date": 1571160821, "last_edit_date": 1571160821, "creation_date": 1571160033, "answer_id": 58399755, "question_id": 58399266, "link": "https://stackoverflow.com/questions/58399266/grid-battleship-board-how-do-i-insert-newline-characters-at-certain-points/58399755#58399755", "title": "Grid battleship board - How do I insert newline characters at certain points?", "body": "<p>I'd try group_by</p>\n\n<pre><code>%w(a1 a2 a3 b1 b2 b3 c1 c2 c3).sort.group_by{|e| e[0]}\n</code></pre>\n\n<p>A more complete answer:</p>\n\n<pre><code>%w(a1 a2 a3 b1 b2 b3 c1 c2 c3).sort.group_by{|e| e[0]}.each{|k, v| v.each{|e| print \"#{k}=&gt;#{e} \"}; puts}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 9663, "user_id": 5239030, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/76JEw.png?s=128&g=1", "display_name": "iGian", "link": "https://stackoverflow.com/users/5239030/igian"}, "is_accepted": false, "score": 0, "last_activity_date": 1571169171, "creation_date": 1571169171, "answer_id": 58401785, "question_id": 58399266, "link": "https://stackoverflow.com/questions/58399266/grid-battleship-board-how-do-i-insert-newline-characters-at-certain-points/58401785#58401785", "title": "Grid battleship board - How do I insert newline characters at certain points?", "body": "<p>Let's say this is your class:</p>\n\n<pre><code>class Cell\n  attr_accessor :fired, :coordinate, :render, :ship\n\n  def initialize(coord)\n    @coordinate = coord\n    @fired = false\n    @render = '='\n  end\n\n  def fired!\n    @fired = true\n    @render = 'x'\n  end\n\nend\n</code></pre>\n\n<p>and you define your table Hash:</p>\n\n<pre><code>n = 4\nrows = (:a..:z).first(n)\ncols = (1..n).to_a\ncells = rows.product(cols).map(&amp;:join)\n#=&gt; [\"a1\", \"a2\", \"a3\", \"a4\", \"b1\", \"b2\", \"b3\", \"b4\", \"c1\", \"c2\", \"c3\", \"c4\", \"d1\", \"d2\", \"d3\", \"d4\"]\ntable = cells.map { |coord| [coord, Cell.new(coord)] }.to_h\n</code></pre>\n\n<p>Let's fire one cell:</p>\n\n<pre><code>table[\"c3\"].fired!\n</code></pre>\n\n<p>This is an option you could render the table (unless you mess up the Hash by changing the order of the cells):</p>\n\n<pre><code>table.values.map { |cell| cell.render }.each_slice(n).to_a\n# [[\"=\", \"=\", \"=\", \"=\"], [\"=\", \"=\", \"=\", \"=\"], [\"=\", \"=\", \"x\", \"=\"], [\"=\", \"=\", \"=\", \"=\"]]\n</code></pre>\n\n<p>Or as a string:</p>\n\n<pre><code>puts table.values.map { |cell| cell.render }.each_slice(n).map(&amp;:join).join(\"\\n\")\n# ====\n# ====\n# ==x=\n# ====\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 12221762, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mCrXOCmJ7vz8abJue_GWoXQF1tOxh34SLw9ZA4Qcg=k-s128", "display_name": "Paul Debevec", "link": "https://stackoverflow.com/users/12221762/paul-debevec"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 65, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1571169171, "creation_date": 1571157888, "question_id": 58399266, "link": "https://stackoverflow.com/questions/58399266/grid-battleship-board-how-do-i-insert-newline-characters-at-certain-points", "title": "Grid battleship board - How do I insert newline characters at certain points?", "body": "<p>I'm building battleship while teaching myself Ruby.\nIn my board class I populate all of the cells in a range (1..4, \"A\"..\"D\"), so it comes out as \"A1\", \"A2\", \"A3\", etc... The letters show the row, and the numbers show the column.</p>\n\n<p>Now, what I'm trying to do is to render the board. I thought I could take my hash of cells, seperate the keys(the alpha-numeric coordinate) and insert a newline character after each letter combination ends (A's, then B's on \\n, and C's on \\n, etc...)\nI can make it work in a very static way, but what I'm not sure is how to make it more dynamic to match the board - To allow a custom sized board.\nMy current output looks like this when I call board.cells...</p>\n\n<pre><code>{\"A1\"=&gt;#&lt;Cell:0x007f8edf3231e0 @coordinate=\"A1\", @fired=false, @render=**\".\", @ship=nil**&gt;,\n\"A2\"=&gt;#&lt;Cell:0x007f8edf323118 @coordinate=\"A2\", @fired=false, @render=**\".\", @ship=nil**&gt;,\n\"A3\"=&gt;#&lt;Cell:0x007f8edf323000 @coordinate=\"A3\", @fired=false, @render=**\".\", @ship=nil**&gt;,\n\"A4\"=&gt;#&lt;Cell:0x007f8edf322ee8 @coordinate=\"A4\", @fired=false, @render=**\".\", @ship=nil**&gt;,\n\"B1\"=&gt;#&lt;Cell:0x007f8edf322da8 @coordinate=\"B1\", @fired=false, @render=**\".\", @ship=nil**&gt;,\n\"B2\"=&gt;#&lt;Cell:0x007f8edf322cb8 @coordinate=\"B2\", @fired=false, @render=**\".\", @ship=nil**&gt;,\n\"B3\"=&gt;#&lt;Cell:0x007f8edf322ba0 @coordinate=\"B3\", @fired=false, @render=**\".\", @ship=nil**&gt;,\n\"B4\"=&gt;#&lt;Cell:0x007f8edf322a88 @coordinate=\"B4\", @fired=false, @render=**\".\", @ship=nil**&gt;,\n...C...D...etc...}\n</code></pre>\n\n<p>I'm currently working on rendering the board, so my logic was if I can get the cells to split on each different letter (cell.keys[0]), then I will be able to work on triggering the @render and manipulating it from there.</p>\n\n<p>Please tell me if my logic is crap :) I need feedback to learn. Also, if you know how to make the \\n work in the way I'm thinking, can you point me in the right direction? If I'm thinking about it wrong, please explain.</p>\n\n<p>Thank you!</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 87, "user_id": 11251897, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IH1ZZ.png?s=128&g=1", "display_name": "Kernel", "link": "https://stackoverflow.com/users/11251897/kernel"}, "reply_to_user": {"reputation": 2251, "user_id": 9785060, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IUduC.png?s=128&g=1", "display_name": "Viktor", "link": "https://stackoverflow.com/users/9785060/viktor"}, "edited": false, "score": 0, "creation_date": 1571157913, "post_id": 58399150, "comment_id": 103143954, "body": "I only have an array of objects that below to another module, and I want to go through an array and compare one of the attributes of the objects with a number"}, {"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 0, "creation_date": 1571202829, "post_id": 58399150, "comment_id": 103156524, "body": "&quot;I can&#39;t find where is the error here&quot; \u2013 Just read the error message. The file name, line number inside the file, and the name of the containing method are listed <i>right there</i>."}], "answers": [{"tags": [], "owner": {"reputation": 3559, "user_id": 260411, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/b6b9ca3212a110fb665c5e805d026999?s=128&d=identicon&r=PG", "display_name": "Toribio", "link": "https://stackoverflow.com/users/260411/toribio"}, "is_accepted": false, "score": 0, "last_activity_date": 1571157791, "creation_date": 1571157791, "answer_id": 58399242, "question_id": 58399150, "link": "https://stackoverflow.com/questions/58399150/typeerror-cant-convert-module1myclass-into-integer-i-cant-find-where-is-th/58399242#58399242", "title": "TypeError: can&#39;t convert Module1::MyClass into Integer, I can&#39;t find where is the error here", "body": "<p>In a <code>for x in y</code> loop, the <code>x</code> is not the counter, but the item inside the <code>y</code> in the current iteration. So by using <code>@array[i].value</code> you're essentially doing <code>@array[@array[i].value].value</code> which throws the type error.</p>\n\n<p>You want to do something like this:</p>\n\n<pre><code>for a in @array\n  if a.value &gt; num2\n    num2 = a.value\n    j = i # what is this?\n  end\nend\n</code></pre>\n\n<p>Or you can also use something like <code>@array.length.times do |i|</code> if you want to use <code>i</code> as a counter.</p>\n"}], "owner": {"reputation": 87, "user_id": 11251897, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IH1ZZ.png?s=128&g=1", "display_name": "Kernel", "link": "https://stackoverflow.com/users/11251897/kernel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 24, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1571157791, "creation_date": 1571157365, "question_id": 58399150, "link": "https://stackoverflow.com/questions/58399150/typeerror-cant-convert-module1myclass-into-integer-i-cant-find-where-is-th", "title": "TypeError: can&#39;t convert Module1::MyClass into Integer, I can&#39;t find where is the error here", "body": "<p>I want to compare an attribute of different objects in a different module of the classes of these objects, but I'm getting this error:</p>\n\n<p>TypeError: can't convert Module1::MyClass into Integer</p>\n\n<p>I wrote attr_reader :value, and when I write \"puts array[0].value\" everything is right. The problem comes with the loop:</p>\n\n<pre><code>num2 = 0\nj = 0\n\n\n\nfor i in @array\n  if  @array[i].value &gt; num2\n    num2 = @array[i].value\n    j = i\n  end\nend\n</code></pre>\n"}, {"tags": ["ruby", "file", "rubygems"], "comments": [{"owner": {"reputation": 152277, "user_id": 438992, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/QouOz.jpg?s=128&g=1", "display_name": "Dave Newton", "link": "https://stackoverflow.com/users/438992/dave-newton"}, "edited": false, "score": 0, "creation_date": 1571155625, "post_id": 58398484, "comment_id": 103142872, "body": "It&#39;d be just as quick to just run each chunk of code in the REPL to see what it&#39;s creating, no? (It&#39;s weird to use both <code>collect</code> and <code>map</code>, but that&#39;s secondary.) I mean, hopefully <code>readlines</code> is pretty self-explanatory, and <code>collect</code>/<code>map</code> are pretty typical operations. What specifically is the issue with the code other than whatever <code>auc</code> is isn&#39;t providing the result you think you should get?"}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 2, "creation_date": 1571157163, "post_id": 58398484, "comment_id": 103143618, "body": "This code does naive CSV parsing. The proper way is with the <a href=\"https://ruby-doc.org/stdlib-2.6.1/libdoc/csv/rdoc/CSV.html\" rel=\"nofollow noreferrer\">built-in CSV module</a>."}, {"owner": {"reputation": 6462, "user_id": 3784008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/55ou4.jpg?s=128&g=1", "display_name": "anothermh", "link": "https://stackoverflow.com/users/3784008/anothermh"}, "edited": false, "score": 0, "creation_date": 1571159020, "post_id": 58398484, "comment_id": 103144406, "body": "Please take a moment to write a new title for your question. This title is completely generic and gives no insight into what you&#39;re asking. See <a href=\"https://stackoverflow.com/help/how-to-ask\">How do I ask a good question?</a>, specifically: <i>&quot;The title is the first thing potential answerers will see, and if your title isn&#39;t interesting, they won&#39;t read the rest. So make it count.&quot;</i>"}, {"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 1, "creation_date": 1571159515, "post_id": 58398484, "comment_id": 103144603, "body": "It would be helpful if you could explain what <i>precisely</i> is unclear to you about the documentation of those methods, and which parts of the code you <i>do</i> and <i>don&#39;t</i> understand. Do you know what a variable is? Do you know what a message send is? Do you know what an assignment is? Do you know what an argument list is? Do you know what a block is? Do you know what a parameter list is? Do you know what a string is? Do you know what a float is? Do you know what a constant is? And so on. For one, this will allow us to focus our answers. And second, this will allow the Ruby developers to \u2026"}, {"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 1, "creation_date": 1571159551, "post_id": 58398484, "comment_id": 103144625, "body": "\u2026 improve the documentation, so that future developers don&#39;t stumble over the same problems you did. Help make the world a better place!"}], "answers": [{"comments": [{"owner": {"reputation": 57, "user_id": 937529, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39d6a5eac7446ae24809ebece7d8f7a1?s=128&d=identicon&r=PG", "display_name": "Roy", "link": "https://stackoverflow.com/users/937529/roy"}, "edited": false, "score": 0, "creation_date": 1571165721, "post_id": 58399516, "comment_id": 103147234, "body": "When I read your response it wasn&#39;t clear to me how the code you translated for me would produce and array like the one you show in the standard library example.  I then copied your csv code, fed it a text file exactly like the second one in my copied output above and it returned the a vertical listing of the numbers, one per line. I then used the original line in question and it, too, printed out a vertical listing, one number per line.  So it seems to me to remain unclear what roc needs and, if it needs an array, how it gets one given the code provided."}, {"owner": {"reputation": 13442, "user_id": 3982562, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2a3c7aae1d762372cda697833c602ec8?s=128&d=identicon&r=PG", "display_name": "3limin4t0r", "link": "https://stackoverflow.com/users/3982562/3limin4t0r"}, "reply_to_user": {"reputation": 57, "user_id": 937529, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39d6a5eac7446ae24809ebece7d8f7a1?s=128&d=identicon&r=PG", "display_name": "Roy", "link": "https://stackoverflow.com/users/937529/roy"}, "edited": false, "score": 0, "creation_date": 1571170676, "post_id": 58399516, "comment_id": 103149107, "body": "@Roy I don&#39;t have any experience with the roc-curve, but the library also offers <code>ROC.curve_points(my_data)</code>, you could check if that yields any results."}, {"owner": {"reputation": 57, "user_id": 937529, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39d6a5eac7446ae24809ebece7d8f7a1?s=128&d=identicon&r=PG", "display_name": "Roy", "link": "https://stackoverflow.com/users/937529/roy"}, "edited": false, "score": 0, "creation_date": 1571183141, "post_id": 58399516, "comment_id": 103152803, "body": "that&#39;s a separate method that plots the ROC curve itself.  Interesting but not what I need."}, {"owner": {"reputation": 13442, "user_id": 3982562, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2a3c7aae1d762372cda697833c602ec8?s=128&d=identicon&r=PG", "display_name": "3limin4t0r", "link": "https://stackoverflow.com/users/3982562/3limin4t0r"}, "reply_to_user": {"reputation": 57, "user_id": 937529, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39d6a5eac7446ae24809ebece7d8f7a1?s=128&d=identicon&r=PG", "display_name": "Roy", "link": "https://stackoverflow.com/users/937529/roy"}, "edited": false, "score": 0, "creation_date": 1571214272, "post_id": 58399516, "comment_id": 103161515, "body": "You say that, but both <code>auc</code> and <code>curve_points</code> call the same method. <a href=\"https://github.com/stevenbedrick/RROC/blob/b0352dc3e6d8a1ded11a244000c7a9a9ed38ed77/lib/rroc.rb#L15-L28\" rel=\"nofollow noreferrer\">github.com/stevenbedrick/RROC/blob/&hellip;</a>"}], "tags": [], "owner": {"reputation": 13442, "user_id": 3982562, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2a3c7aae1d762372cda697833c602ec8?s=128&d=identicon&r=PG", "display_name": "3limin4t0r", "link": "https://stackoverflow.com/users/3982562/3limin4t0r"}, "is_accepted": false, "score": 1, "last_activity_date": 1571158920, "creation_date": 1571158920, "answer_id": 58399516, "question_id": 58398484, "link": "https://stackoverflow.com/questions/58398484/what-dos-this-ruby-statement-mean/58399516#58399516", "title": "What dos this Ruby statement mean?", "body": "<p>The explanation of the code:</p>\n\n<pre><code>open('some_data.csv') # open the some_data.csv file\n  .readlines          # returns an array with each element being a line\n  .collect { |l|      # for each line do the following tranformation\n    l.strip           # remove proceeding and trailing whitespace characters\n     .split(',')      # split the line based on the \",\" character (returning an array)\n     .map(&amp;:to_f)     # call .to_f on each element in the array, converting them to a float value\n  }\n</code></pre>\n\n<p><code>map</code>/<code>collect</code> are aliases of each other.</p>\n\n<p>However, like tadman already said <a href=\"https://stackoverflow.com/questions/58398484/what-dos-this-ruby-statement-mean#comment103143618_58398484\">in the comments</a> you're better of using the <a href=\"https://ruby-doc.org/stdlib-2.6.5/libdoc/csv/rdoc/index.html\" rel=\"nofollow noreferrer\">csv</a> standard library. The same can be achieved with:</p>\n\n<pre><code>require 'csv'\n\nmy_data = CSV.read('some_data.csv', converters: :float)\n# should output\n#=&gt; [[90, 1], [80, 1], [70,-1], [60,1], [55,1], [54,1], [53,-1], [52,-1], [51,1], [50,-1], [40,1], [39,-1], [38,1], [37,-1], [36,-1], [35,-1], [34,1], [33,-1], [30,1], [10,-1]]\n</code></pre>\n"}], "owner": {"reputation": 57, "user_id": 937529, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39d6a5eac7446ae24809ebece7d8f7a1?s=128&d=identicon&r=PG", "display_name": "Roy", "link": "https://stackoverflow.com/users/937529/roy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 54, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1571160130, "creation_date": 1571154600, "last_edit_date": 1571160130, "question_id": 58398484, "link": "https://stackoverflow.com/questions/58398484/what-dos-this-ruby-statement-mean", "title": "What dos this Ruby statement mean?", "body": "<p>The code below comes from the documentation for the Ruby Gem rroc. I desperately need to calculate the AUC for my AI project.  However I have virtually no knowledge of Ruby file I/O, not having had occasion to learn. The documentation says rroc expects an n by 2 array but the first line of code below suggest that the data is in a csv file and it will be formatted into my_data for roc to calculate the auc.</p>\n\n<p>I have tried every conceivable combination of csv data and arrays as both files for the first line to read or direct input into the line calculating auc. At best the code works, without error but gives a useless output of 0.  My hope is that if I had a fuller understand of what that line does, I could either fix the problem or give up on the gem since a previous version of this gem was shown to be obsolete and this one's 8 years old. I took the data from the article referenced by the gem author and am pretty sure it's not the problem, but then,...</p>\n\n<p>So, to refine the question: from that statement, can we tell what kind of data should be in 'some_data.cvs'? And what will be done to it to make my_data?</p>\n\n<pre><code>require 'rroc'\n\nmy_data = open('some_data.csv').readlines.collect { |l| l.strip.split(\",\").map(&amp;:to_f) }\nauc = ROC.auc(my_data)\nputs auc\n</code></pre>\n\n<p>Below I've copied the output for two runs, the first with array data read in, the second with csv values (each in separate files). I added a line to read out the input file just to be sure.</p>\n\n<pre><code>RoyiMac:ruby $ ruby PDaucT.rb\n[[90, 1], [80, 1], [70,-1], [60,1], [55,1], [54,1], [53,-1], [52,-1], [51,1], [50,-1], [40,1], [39,-1], [38,1], [37,-1], [36,-1], [35,-1], [34,1], [33,-1], [30,1], [10,-1]] \n\n0.0\nRoyiMac:ruby $ ruby PDaucT.rb\n90,1,80,1,70,-1,60,1,55,1,54,1,53,-1,52,-1,51,1,50,-1,40,1,39,-1,38,1,37,-1,36,-1,35,-1,34,1,33,-1,30,1,10,-1\n\n0.0\n</code></pre>\n"}, {"tags": ["ruby"], "answers": [{"comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1571157019, "post_id": 58398343, "comment_id": 103143560, "body": "<code>send</code> is the recommended method. The <code>method</code> approach is <a href=\"https://gist.github.com/tadman/ed6bf2f9e9b2bb68a8818cc52075495e\" rel=\"nofollow noreferrer\">about 5x slower</a> but is useful in other situations where <code>send</code> isn&#39;t practical."}], "tags": [], "owner": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "is_accepted": true, "score": 8, "last_activity_date": 1584167862, "last_edit_date": 1584167862, "creation_date": 1571154072, "answer_id": 58398343, "question_id": 58398293, "link": "https://stackoverflow.com/questions/58398293/how-to-pass-operator-as-a-parameter-in-ruby/58398343#58398343", "title": "How to pass operator as a parameter in ruby?", "body": "<p>You can use <code>public_send</code> or (<code>send</code> depending the method):</p>\n\n<pre><code>operator = :&gt;\n5.public_send(operator, 4)\n# true\n</code></pre>\n\n<p><code>public_send</code> (as <code>send</code>) can receive a method as String or Symbol.</p>\n\n<p>In case the method you're using isn't defined in the object class, Ruby will raise a <code>NoMethodError</code>.</p>\n\n<hr>\n\n<p>You can also do <code>receiver.method(method_name).call(argument)</code>, but that's just more typing:</p>\n\n<pre><code>5.method(operator).call(4)\n# true\n</code></pre>\n\n<p>Thanks @tadman for the benchmark comparing <code>send</code> and <code>method(...).call</code>:</p>\n\n<pre><code>require 'benchmark'\n\nBenchmark.bm do |bm|\n  repeat = 10000000\n\n  bm.report('send')        { repeat.times { 5.send(:&gt;, 2) } }\n  bm.report('method.call') { repeat.times { 5.method(:&gt;).call(2) } }\nend\n\n#              user       system     total    real\n# send         0.640115   0.000992   0.641107 (  0.642627)\n# method.call  2.629482   0.007149   2.636631 (  2.644439)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 5312, "user_id": 6535997, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/10156345016155058/picture?type=large", "display_name": "Mark", "link": "https://stackoverflow.com/users/6535997/mark"}, "is_accepted": false, "score": 3, "last_activity_date": 1571154076, "creation_date": 1571154076, "answer_id": 58398344, "question_id": 58398293, "link": "https://stackoverflow.com/questions/58398293/how-to-pass-operator-as-a-parameter-in-ruby/58398344#58398344", "title": "How to pass operator as a parameter in ruby?", "body": "<p>Check out <a href=\"https://stackoverflow.com/questions/20019668/ruby-string-to-operator\">Ruby string to operator</a> - you need to use public send:</p>\n\n<pre><code>operator = '&gt;'\n5.public_send(operator, 4)\n=&gt; true\noperator = '-'\n5.public_send(operator, 4)\n=&gt; 1\n</code></pre>\n"}], "owner": {"reputation": 12669, "user_id": 1482709, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/ef49d195f8555bdc65d793cf965a2f6f?s=128&d=identicon&r=PG", "display_name": "Prashanth Sams", "link": "https://stackoverflow.com/users/1482709/prashanth-sams"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 104, "favorite_count": 0, "accepted_answer_id": 58398343, "answer_count": 2, "score": 3, "last_activity_date": 1584167862, "creation_date": 1571153903, "last_edit_date": 1571154078, "question_id": 58398293, "link": "https://stackoverflow.com/questions/58398293/how-to-pass-operator-as-a-parameter-in-ruby", "title": "How to pass operator as a parameter in ruby?", "body": "<p>Here is what I have:</p>\n\n<p><code>operator = '&gt;'</code></p>\n\n<p>Here is what I tried:</p>\n\n<pre><code>5 operator.to_sym 4\n\n#invalid result =&gt; \n5 :&gt;= 4 \n</code></pre>\n\n<p><strong>Expected</strong>:\n<code>5 &gt; 4</code></p>\n"}, {"tags": ["ruby", "urlencode"], "comments": [{"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 1, "creation_date": 1571152666, "post_id": 58397368, "comment_id": 103141261, "body": "What&#39;s your plan for dealing with servers that don&#39;t like the <i>encoded</i> form of some characters?"}, {"owner": {"reputation": 13442, "user_id": 3982562, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2a3c7aae1d762372cda697833c602ec8?s=128&d=identicon&r=PG", "display_name": "3limin4t0r", "link": "https://stackoverflow.com/users/3982562/3limin4t0r"}, "edited": false, "score": 0, "creation_date": 1571153178, "post_id": 58397368, "comment_id": 103141556, "body": "The W3 specification states: 1) Spaces should be replaced with <code>+</code> characters. 2) The characters <code>*</code>, <code>-</code>, <code>.</code>, <code>0</code> to <code>9</code>, <code>A</code> to <code>Z</code>, <code>_</code> and <code>a</code> to <code>z</code> can be left as is. 3) Replace all other characters with their percent encoded representation. See: <a href=\"https://www.w3.org/TR/2013/CR-html5-20130806/forms.html#url-encoded-form-data\" rel=\"nofollow noreferrer\">w3.org/TR/2013/CR-html5-20130806/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1571174720, "post_id": 58398791, "comment_id": 103150636, "body": "Oh so that&#39;s where <code>URI.escape</code> ran off to."}, {"owner": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "edited": false, "score": 1, "creation_date": 1571185299, "post_id": 58398791, "comment_id": 103153193, "body": "Forking sounds like a much better idea than monkeypatching since you may want to just include this at the application boundry."}, {"owner": {"reputation": 13086, "user_id": 1431239, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/e0085b2fdc60b5c84310fa29529a6648?s=128&d=identicon&r=PG", "display_name": "Mike Mackintosh", "link": "https://stackoverflow.com/users/1431239/mike-mackintosh"}, "edited": false, "score": 0, "creation_date": 1571199295, "post_id": 58398791, "comment_id": 103155772, "body": "Agreed on the forking approach"}], "tags": [], "owner": {"reputation": 13086, "user_id": 1431239, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/e0085b2fdc60b5c84310fa29529a6648?s=128&d=identicon&r=PG", "display_name": "Mike Mackintosh", "link": "https://stackoverflow.com/users/1431239/mike-mackintosh"}, "is_accepted": true, "score": 3, "last_activity_date": 1571155824, "creation_date": 1571155824, "answer_id": 58398791, "question_id": 58397368, "link": "https://stackoverflow.com/questions/58397368/url-encode-every-possible-character/58398791#58398791", "title": "URL encode every possible character", "body": "<p><code>URI.escape</code> was deprecated and replaced by <code>CGI::escape</code> which is RFC compliant by grabbing non-alphanum characters and converting them. This is the module that does it:</p>\n\n<pre><code># https://ruby-doc.org/stdlib-2.4.3/libdoc/cgi/rdoc/CGI/Util.html\n\n# File cgi/util.rb, line 11\ndef escape(string)\n  encoding = string.encoding\n  string.b.gsub(/([^ a-zA-Z0-9_.-]+)/) do |m|\n    '%' + m.unpack('H2' * m.bytesize).join('%').upcase\n  end.tr(' ', '+').force_encoding(encoding)\nend      \n</code></pre>\n\n<p>At the end of the day, it's the server that needs fixing, not your code. You can monkeypatch or fork CGI and remove the <code>-</code> from the regex, or <code>gsub()</code> the character.</p>\n"}], "owner": {"reputation": 4220, "user_id": 1661012, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/abc04c76810d98405fc0f27f96c6c5e5?s=128&d=identicon&r=PG", "display_name": "user137369", "link": "https://stackoverflow.com/users/1661012/user137369"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 124, "favorite_count": 0, "accepted_answer_id": 58398791, "answer_count": 1, "score": 1, "last_activity_date": 1571155824, "creation_date": 1571150898, "last_edit_date": 1571151316, "question_id": 58397368, "link": "https://stackoverflow.com/questions/58397368/url-encode-every-possible-character", "title": "URL encode every possible character", "body": "<p>It\u2019s common that I make a request in Ruby that fails because the server doesn\u2019t like the encoding. A common example is having spaces as <code>+</code> when the server only understands <code>%20</code>. Today I bumped into a server that doesn\u2019t like unencoded hyphens (<code>-</code>), requiring <code>%2D</code> instead.</p>\n\n<p>I\u2019ve tried <code>CGI.escape</code>, <code>URI.escape</code>, <code>ERB::Util.url_encode</code>, <code>WEBrick::HTTPUtils.escape</code>, and none encodes hyphens.</p>\n\n<p>In the past I\u2019ve resorted to <code>gsub</code>ing the offending characters as needed, but as I find more servers with more idiosyncrasies, I\u2019d prefer a more stable solution.</p>\n\n<p>Is there a standard (i.e. no external dependencies) approach that percent encodes everything that\u2019s possible?</p>\n\n<p>I\u2019m not looking for just hyphen encoding or <code>gsub</code>ing everything one at a time.</p>\n"}, {"tags": ["ruby"], "answers": [{"comments": [{"owner": {"reputation": 4855, "user_id": 3618156, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/b3e1907a7f15ed006abc8ad406cf40fe?s=128&d=identicon&r=PG&f=1", "display_name": "american-ninja-warrior", "link": "https://stackoverflow.com/users/3618156/american-ninja-warrior"}, "edited": false, "score": 0, "creation_date": 1571151122, "post_id": 58397393, "comment_id": 103140343, "body": "can yield help here?"}, {"owner": {"reputation": 2923, "user_id": 783912, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/98e9b626cf9e9e74ae50c190da325a5e?s=128&d=identicon&r=PG&f=1", "display_name": "FlyingFoX", "link": "https://stackoverflow.com/users/783912/flyingfox"}, "reply_to_user": {"reputation": 4855, "user_id": 3618156, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/b3e1907a7f15ed006abc8ad406cf40fe?s=128&d=identicon&r=PG&f=1", "display_name": "american-ninja-warrior", "link": "https://stackoverflow.com/users/3618156/american-ninja-warrior"}, "edited": false, "score": 0, "creation_date": 1571151845, "post_id": 58397393, "comment_id": 103140759, "body": "@american-ninja-warrior I don&#39;t think so, but my ruby is a bit rusty. Does creating a method not work with VCR or why do you ask about yield?"}], "tags": [], "owner": {"reputation": 2923, "user_id": 783912, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/98e9b626cf9e9e74ae50c190da325a5e?s=128&d=identicon&r=PG&f=1", "display_name": "FlyingFoX", "link": "https://stackoverflow.com/users/783912/flyingfox"}, "is_accepted": false, "score": -1, "last_activity_date": 1571150963, "creation_date": 1571150963, "answer_id": 58397393, "question_id": 58397185, "link": "https://stackoverflow.com/questions/58397185/can-an-i-make-this-block-wrapping-optional-in-a-idiomatic-neat-way/58397393#58397393", "title": "Can an I make this &quot;block wrapping&quot; optional in a idiomatic/neat way?", "body": "<p>You could put the duplicate code into a method and call that method either wrapped in the VCR do block or without VCR.</p>\n"}, {"comments": [{"owner": {"reputation": 2599, "user_id": 12201472, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-PcsKV9F65CQ/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3repCiEtFeVMa1z1D-JpXuqg5wlw6w/photo.jpg?sz=128", "display_name": "Marian13", "link": "https://stackoverflow.com/users/12201472/marian13"}, "reply_to_user": {"reputation": 4855, "user_id": 3618156, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/b3e1907a7f15ed006abc8ad406cf40fe?s=128&d=identicon&r=PG&f=1", "display_name": "american-ninja-warrior", "link": "https://stackoverflow.com/users/3618156/american-ninja-warrior"}, "edited": false, "score": 0, "creation_date": 1571177751, "post_id": 58403201, "comment_id": 103151538, "body": "Docs for <code>#call</code> can be found <a href=\"https://ruby-doc.org/core-2.6.3/Proc.html#method-i-call\" rel=\"nofollow noreferrer\">there</a>."}], "tags": [], "owner": {"reputation": 2599, "user_id": 12201472, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-PcsKV9F65CQ/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3repCiEtFeVMa1z1D-JpXuqg5wlw6w/photo.jpg?sz=128", "display_name": "Marian13", "link": "https://stackoverflow.com/users/12201472/marian13"}, "is_accepted": false, "score": 0, "last_activity_date": 1571178911, "last_edit_date": 1571178911, "creation_date": 1571177048, "answer_id": 58403201, "question_id": 58397185, "link": "https://stackoverflow.com/questions/58397185/can-an-i-make-this-block-wrapping-optional-in-a-idiomatic-neat-way/58403201#58403201", "title": "Can an I make this &quot;block wrapping&quot; optional in a idiomatic/neat way?", "body": "<p>You can try to use the following approach:</p>\n\n<pre><code>def get_remote_date\n  record_request { Net::HTTP.get('example.com', '/index.json') }\nend\n\ndef record_request(&amp;request)\n  ENV['RECORD_REQUEST'] ? VCR.use_cassette(\"cassette_001\", &amp;request) : request.call\nend\n\n</code></pre>\n\n<p>This is a nice <a href=\"https://mixandgo.com/learn/mastering-ruby-blocks-in-less-than-5-minutes\" rel=\"nofollow noreferrer\">article</a>, which explains what does <code>&amp;block</code> (ampersand parameter) mean and how it relates to <code>yield</code> keyword. </p>\n"}, {"tags": [], "owner": {"reputation": 4855, "user_id": 3618156, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/b3e1907a7f15ed006abc8ad406cf40fe?s=128&d=identicon&r=PG&f=1", "display_name": "american-ninja-warrior", "link": "https://stackoverflow.com/users/3618156/american-ninja-warrior"}, "is_accepted": false, "score": 0, "last_activity_date": 1571235020, "creation_date": 1571235020, "answer_id": 58415378, "question_id": 58397185, "link": "https://stackoverflow.com/questions/58397185/can-an-i-make-this-block-wrapping-optional-in-a-idiomatic-neat-way/58415378#58415378", "title": "Can an I make this &quot;block wrapping&quot; optional in a idiomatic/neat way?", "body": "<p>Illustrating a yield based solution,</p>\n\n<pre><code>  def maybe_cache_http_requests(cassette)\n    if ENV['CACHE_HTTP_REQUESTS'] == \"1\"\n      require 'vcr'\n      VCR.configure do |config|\n        config.cassette_library_dir = \"vcr_cassettes\"\n        config.hook_into :webmock\n      end\n      VCR.use_cassette(cassette) do\n        yield\n      end\n    else\n      yield\n    end\n  end\n</code></pre>\n"}], "owner": {"reputation": 4855, "user_id": 3618156, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/b3e1907a7f15ed006abc8ad406cf40fe?s=128&d=identicon&r=PG&f=1", "display_name": "american-ninja-warrior", "link": "https://stackoverflow.com/users/3618156/american-ninja-warrior"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 56, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1571235020, "creation_date": 1571150345, "question_id": 58397185, "link": "https://stackoverflow.com/questions/58397185/can-an-i-make-this-block-wrapping-optional-in-a-idiomatic-neat-way", "title": "Can an I make this &quot;block wrapping&quot; optional in a idiomatic/neat way?", "body": "<p>In ruby, you can call a remote api like this</p>\n\n<pre><code>def get_remote_date\n  Net::HTTP.get('example.com', '/index.json')\nend\n</code></pre>\n\n<p>If you do <code>gem install vcr</code>, you can do this</p>\n\n<pre><code>def get_remote_date\n  VCR.use_cassette(\"cassette_001\") do\n    Net::HTTP.get('example.com', '/index.json')\n  end\nend\n</code></pre>\n\n<p>Vcr recording/playback helps during development, when \nthe remote api is expensive.\nWhether to use vcr or not should be optional, indicated\nby the first argument of the function:</p>\n\n<pre><code>def get_remote_date(should_use_vcr)\n  VCR.use_cassette(\"cassette_001\") do\n    Net::HTTP.get('example.com', '/index.json')\n  end\nend\n</code></pre>\n\n<p>My question is, how do I rewrite the method so that the \"block wrapping\" / \"VCR.use_cassette(\"cassette_001\") do\" is conditional on the boolean value of the should_use_vcr local variable.</p>\n\n<p>I could do</p>\n\n<pre><code>def get_remote_date(should_use_vcr)\n  if conditional here\n    VCR.use_cassette(\"cassette_001\") do\n      Net::HTTP.get('example.com', '/index.json')\n    end\n  else\n    Net::HTTP.get('example.com', '/index.json')     \n  end\nend\n</code></pre>\n\n<p>but for a complex method that has \"Net::HTTP.get( \" plus a dozen more lines, there's too much duplication of code,\nso looking for a neater way to do it.</p>\n"}, {"tags": ["python", "ruby"], "comments": [{"owner": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "edited": false, "score": 0, "creation_date": 1571146445, "post_id": 58395965, "comment_id": 103137444, "body": "That should be raising a SyntaxError in <code>response == (&quot;y&quot; || &quot;n&quot;)</code>. Try with <code>response == &quot;y&quot; || response == &quot;n&quot; || guessed_it</code>."}, {"owner": {"reputation": 43, "user_id": 11996777, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd21f38f987e269a12e4476ac6fbe7a9?s=128&d=identicon&r=PG&f=1", "display_name": "sstwg", "link": "https://stackoverflow.com/users/11996777/sstwg"}, "reply_to_user": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "edited": false, "score": 0, "creation_date": 1571146562, "post_id": 58395965, "comment_id": 103137517, "body": "works but does not continue the cycle"}, {"owner": {"reputation": 43, "user_id": 11996777, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd21f38f987e269a12e4476ac6fbe7a9?s=128&d=identicon&r=PG&f=1", "display_name": "sstwg", "link": "https://stackoverflow.com/users/11996777/sstwg"}, "reply_to_user": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "edited": false, "score": 0, "creation_date": 1571146628, "post_id": 58395965, "comment_id": 103137566, "body": "if I enter another letter, he must again ask &quot;y&quot; or &quot;n&quot;"}, {"owner": {"reputation": 43, "user_id": 11996777, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd21f38f987e269a12e4476ac6fbe7a9?s=128&d=identicon&r=PG&f=1", "display_name": "sstwg", "link": "https://stackoverflow.com/users/11996777/sstwg"}, "edited": false, "score": 0, "creation_date": 1571148229, "post_id": 58395965, "comment_id": 103138605, "body": "fixed indentation code"}], "answers": [{"comments": [{"owner": {"reputation": 43, "user_id": 11996777, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd21f38f987e269a12e4476ac6fbe7a9?s=128&d=identicon&r=PG&f=1", "display_name": "sstwg", "link": "https://stackoverflow.com/users/11996777/sstwg"}, "edited": false, "score": 0, "creation_date": 1571147025, "post_id": 58396045, "comment_id": 103137833, "body": "can you briefly say what he is doing  (!) exclamation point    ???"}, {"owner": {"reputation": 538888, "user_id": 104349, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/0f4cefeedec5163556751d61625eedd0?s=128&d=identicon&r=PG", "display_name": "Daniel Roseman", "link": "https://stackoverflow.com/users/104349/daniel-roseman"}, "reply_to_user": {"reputation": 43, "user_id": 11996777, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd21f38f987e269a12e4476ac6fbe7a9?s=128&d=identicon&r=PG&f=1", "display_name": "sstwg", "link": "https://stackoverflow.com/users/11996777/sstwg"}, "edited": false, "score": 0, "creation_date": 1571147275, "post_id": 58396045, "comment_id": 103138002, "body": "Yes, <code>until</code> is clearer, changed. @sstwg <code>!</code> is &quot;not&quot;."}, {"owner": {"reputation": 43, "user_id": 11996777, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd21f38f987e269a12e4476ac6fbe7a9?s=128&d=identicon&r=PG&f=1", "display_name": "sstwg", "link": "https://stackoverflow.com/users/11996777/sstwg"}, "edited": false, "score": 0, "creation_date": 1571148785, "post_id": 58396045, "comment_id": 103138937, "body": "response is return response? 7 line"}, {"owner": {"reputation": 13442, "user_id": 3982562, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2a3c7aae1d762372cda697833c602ec8?s=128&d=identicon&r=PG", "display_name": "3limin4t0r", "link": "https://stackoverflow.com/users/3982562/3limin4t0r"}, "edited": false, "score": 0, "creation_date": 1571149556, "post_id": 58396045, "comment_id": 103139401, "body": "<code>response = gets.downcase.strip until %w[y n].include?(response)</code> would collapse four lines into one. Allowing you to remove <code>response = nil</code> up to <code>end</code> (of <code>until</code>)."}, {"owner": {"reputation": 13442, "user_id": 3982562, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2a3c7aae1d762372cda697833c602ec8?s=128&d=identicon&r=PG", "display_name": "3limin4t0r", "link": "https://stackoverflow.com/users/3982562/3limin4t0r"}, "reply_to_user": {"reputation": 43, "user_id": 11996777, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd21f38f987e269a12e4476ac6fbe7a9?s=128&d=identicon&r=PG&f=1", "display_name": "sstwg", "link": "https://stackoverflow.com/users/11996777/sstwg"}, "edited": false, "score": 0, "creation_date": 1571149934, "post_id": 58396045, "comment_id": 103139624, "body": "@sstwg <a href=\"https://ruby-doc.org/core-2.6.5/doc/syntax/methods_rdoc.html#label-Return+Values\" rel=\"nofollow noreferrer\">By default, a method returns the last expression that was evaluated in the body of the method.</a> You don&#39;t have to use <code>return</code>, only if you want to return early."}], "tags": [], "owner": {"reputation": 538888, "user_id": 104349, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/0f4cefeedec5163556751d61625eedd0?s=128&d=identicon&r=PG", "display_name": "Daniel Roseman", "link": "https://stackoverflow.com/users/104349/daniel-roseman"}, "is_accepted": true, "score": 2, "last_activity_date": 1571147239, "last_edit_date": 1571147239, "creation_date": 1571146526, "answer_id": 58396045, "question_id": 58395965, "link": "https://stackoverflow.com/questions/58395965/why-the-loop-does-not-want-to-continue/58396045#58396045", "title": "Why the loop does not want to continue", "body": "<p>The logic of your Ruby code isn't the same as the Python version, and would be just as incorrect in Python as it is in Ruby.</p>\n\n<p><code>(\"y\" || \"n\")</code> is a boolean operation on two strings; since all strings are true in Ruby, the result is the first string. So therefore the result of the whole boolean operation is also true, so the <code>unless</code> is false, and the block is never entered.</p>\n\n<p>You can use <code>include?</code> to do the same as the Python version:</p>\n\n<pre><code>unless [\"y\", \"n\"].include?(response) || guessed_it\n</code></pre>\n\n<p>but the whole Ruby version can be translated much more directly:</p>\n\n<pre><code>def ask_yes_no(question)\n    puts question\n    response = nil\n    until [\"y\", \"n\"].include?(response) do\n        response = gets.downcase.strip\n    end\n    response\nend\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1892, "user_id": 3158810, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/1ebf9e065f654642fecfee399b439030?s=128&d=identicon&r=PG&f=1", "display_name": "G4143", "link": "https://stackoverflow.com/users/3158810/g4143"}, "is_accepted": false, "score": 1, "last_activity_date": 1571154324, "creation_date": 1571154324, "answer_id": 58398417, "question_id": 58395965, "link": "https://stackoverflow.com/questions/58395965/why-the-loop-does-not-want-to-continue/58398417#58398417", "title": "Why the loop does not want to continue", "body": "<p>You could also use Ruby regex's.</p>\n\n<pre><code>def ask_yes_no(question)\n\n    until (print question; gets.chomp.downcase =~ /y|n/) do\n    end\n\n    $~.to_s\n\nend\n</code></pre>\n"}], "owner": {"reputation": 43, "user_id": 11996777, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd21f38f987e269a12e4476ac6fbe7a9?s=128&d=identicon&r=PG&f=1", "display_name": "sstwg", "link": "https://stackoverflow.com/users/11996777/sstwg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 87, "favorite_count": 0, "accepted_answer_id": 58396045, "answer_count": 2, "score": 1, "last_activity_date": 1571154324, "creation_date": 1571146269, "last_edit_date": 1571148194, "question_id": 58395965, "link": "https://stackoverflow.com/questions/58395965/why-the-loop-does-not-want-to-continue", "title": "Why the loop does not want to continue", "body": "<p>The function asks a question, the answer to which should be YES or NO. It takes the text of the question and returns the letter \"y\" or \"n\". I have a Python code, I need to transform it to Ruby.</p>\n\n<pre><code>#Python code \ndef ask_yes_no(question):\n    response = None\n    while response not in (\"y\", \"n\"):\n        respone = input(question).lower()\n    return response\n</code></pre>\n\n<p>What did i do</p>\n\n<pre><code># Ruby code\ndef ask_yes_no(question)\n\n    guessed_it = false\n    response = \"\"\n\n    puts question\n    loop do\n\n        unless (response == (\"y\" || \"n\"))  || guessed_it\n\n            response = gets.downcase\n            return response #&amp;&amp; guessed_it == true\n\n        end\n\n        break if guessed_it == true \n    end\nend\n\nask_yes_no(\"\nHow is the weather?\")\n</code></pre>\n"}, {"tags": ["ruby", "rubygems", "chef-infra", "chef-recipe"], "comments": [{"owner": {"reputation": 18079, "user_id": 503402, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/873ad707fb34aac8fbdfbfec676e02e9?s=128&d=identicon&r=PG", "display_name": "Max", "link": "https://stackoverflow.com/users/503402/max"}, "edited": false, "score": 1, "creation_date": 1571149361, "post_id": 58395955, "comment_id": 103139287, "body": "I can tell you a bit about the bug. Chef is trying to run <code>bundle install</code> to install dependencies. It does this by passing the command to <code>shell_out</code>. In the docs for that it says &quot;on windows, array args aren&#39;t supported &#91;so] its up to the caller to join(&quot; &quot;) on arrays of strings.&quot; You&#39;re on windows, so it&#39;s supposed to pass the string <code>&quot;bundle install&quot;</code> but instead it&#39;s passing the array <code>[&quot;bundle&quot;, &quot;install&quot;]</code>. It looks to me like a bug in Chef because somewhere it&#39;s supposed to convert the array into a string and isn&#39;t. Post it on their github."}, {"owner": {"reputation": 6462, "user_id": 3784008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/55ou4.jpg?s=128&g=1", "display_name": "anothermh", "link": "https://stackoverflow.com/users/3784008/anothermh"}, "edited": false, "score": 0, "creation_date": 1571159181, "post_id": 58395955, "comment_id": 103144454, "body": "Please do not link to external sites that host your code. If you have code that is relevant to your question then you must include it directly in your question."}], "answers": [{"tags": [], "owner": {"reputation": 45, "user_id": 9871766, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/061a5a6c376f372c717286b8ef711737?s=128&d=identicon&r=PG&f=1", "display_name": "Sankareswar", "link": "https://stackoverflow.com/users/9871766/sankareswar"}, "is_accepted": true, "score": 0, "last_activity_date": 1571223946, "creation_date": 1571223946, "answer_id": 58411850, "question_id": 58395955, "link": "https://stackoverflow.com/questions/58395955/fatal-nomethoderror-undefined-method-each-char-for-bundle-installarr/58411850#58411850", "title": "FATAL: NoMethodError: undefined method `each_char&#39; for [&quot;bundle&quot;, &quot;install&quot;]:Array Did you mean? each_cons", "body": "<p>Thanks @anothermh , It was a ChefDK triage and was fixed on next update. Upgrading Chef DK and Chef-client to latest version fixed my issue</p>\n"}], "owner": {"reputation": 45, "user_id": 9871766, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/061a5a6c376f372c717286b8ef711737?s=128&d=identicon&r=PG&f=1", "display_name": "Sankareswar", "link": "https://stackoverflow.com/users/9871766/sankareswar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 210, "favorite_count": 0, "accepted_answer_id": 58411850, "answer_count": 1, "score": 1, "last_activity_date": 1571223946, "creation_date": 1571146240, "last_edit_date": 1571149379, "question_id": 58395955, "link": "https://stackoverflow.com/questions/58395955/fatal-nomethoderror-undefined-method-each-char-for-bundle-installarr", "title": "FATAL: NoMethodError: undefined method `each_char&#39; for [&quot;bundle&quot;, &quot;install&quot;]:Array Did you mean? each_cons", "body": "<p>I am working on Chef to automate a deployment procedures, I have configured everything on my Chef environment.</p>\n\n<pre><code>OS &amp; Version details are as below\nChef Server - RHEL7\nChef Workstation - Windows 7 Professional\nChef node : Windows 2016 Server Datacenter\n\n\nChef Development Kit Version: 3.3.23\nchef-client version: 14.5.33\nberks version: 7.0.6\nkitchen version: 1.23.2\ninspec version: 2.2.112\n</code></pre>\n\n<p>Created a sample cookbook just to create a test.txt file in node where we are executing chef-client.\nBelow is the files resource which we are using on recipe.</p>\n\n<pre><code>file 'C:\\\\temp\\\\something.txt' do\n  rights :read, 'Everyone'\n  #rights :full_control, 'DOMAIN\\\\User'\n  action :create\nend\n</code></pre>\n\n<p>Getting below error on running chef-client on remote node</p>\n\n<pre><code>Running handlers:\n[2019-10-15T19:25:18+08:00] ERROR: Running exception handlers\nRunning handlers complete\n[2019-10-15T19:25:18+08:00] ERROR: Exception handlers complete\nChef Client failed. 0 resources updated in 15 seconds\n[2019-10-15T19:25:18+08:00] INFO: Sending resource update report (run-id: 5ea7d4d4-2cd4-4456-bcf4-5458fbfdb31d)\n[2019-10-15T19:25:19+08:00] FATAL: Stacktrace dumped to c:/chef/cache/chef-stacktrace.out\n[2019-10-15T19:25:19+08:00] FATAL: Please provide the contents of the stacktrace.out file if you file a bug report\n[2019-10-15T19:25:19+08:00] FATAL: NoMethodError: undefined method 'each_char' for [\"bundle\", \"install\"]:Array\nDid you mean?  each_cons\n</code></pre>\n\n<p>I don't have much knowledge on ruby.\nattached <a href=\"https://app.box.com/s/wam4mnmd4vcfqpym9gh4sfo4w1qlyqrb\" rel=\"nofollow noreferrer\">stacktrace.out</a></p>\n"}, {"tags": ["ruby", "windows", "rubygems", "gtk3"], "answers": [{"tags": [], "owner": {"reputation": 68, "user_id": 5582257, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eR0ry.jpg?s=128&g=1", "display_name": "Mohamed Hakki", "link": "https://stackoverflow.com/users/5582257/mohamed-hakki"}, "is_accepted": true, "score": 0, "last_activity_date": 1571748034, "creation_date": 1571748034, "answer_id": 58504547, "question_id": 58394751, "link": "https://stackoverflow.com/questions/58394751/how-to-deliver-a-gem-with-gtk3/58504547#58504547", "title": "How to deliver a gem with GTK3?", "body": "<p>I've put the question directly to the GTK3 developers.</p>\n\n<p><a href=\"https://github.com/ruby-gnome/ruby-gnome/issues/1306\" rel=\"nofollow noreferrer\">here is their answer.</a></p>\n\n<p>Which means that if you choose to use GTK3 today with Ruby, you have to:</p>\n\n<ul>\n<li>Deliver MSYS2 and Ruby with your GEM (more than 1GB package !).</li>\n<li>Deliver your gem and tell users to install themselves msys2 (with updates) and ruby and your gem with dependencies.</li>\n</ul>\n"}], "owner": {"reputation": 68, "user_id": 5582257, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eR0ry.jpg?s=128&g=1", "display_name": "Mohamed Hakki", "link": "https://stackoverflow.com/users/5582257/mohamed-hakki"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 59, "favorite_count": 1, "accepted_answer_id": 58504547, "answer_count": 1, "score": 0, "last_activity_date": 1571748034, "creation_date": 1571142596, "last_edit_date": 1571152425, "question_id": 58394751, "link": "https://stackoverflow.com/questions/58394751/how-to-deliver-a-gem-with-gtk3", "title": "How to deliver a gem with GTK3?", "body": "<p>How can I make an independent gem once I have completed a development? do I need to deliver msys2 too?</p>\n\n<p>My environment:</p>\n\n<ul>\n<li>windows 10</li>\n<li>ruby 2.4.5</li>\n<li>my_gem depend on <a href=\"https://rubygems.org/gems/gtk3/versions/3.4.0\" rel=\"nofollow noreferrer\">gtk3</a> gem</li>\n<li><a href=\"https://www.msys2.org/\" rel=\"nofollow noreferrer\">msys2</a></li>\n</ul>\n"}, {"tags": ["ruby-on-rails", "ruby", "model-associations", "rails-models"], "comments": [{"owner": {"reputation": 13442, "user_id": 3982562, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2a3c7aae1d762372cda697833c602ec8?s=128&d=identicon&r=PG", "display_name": "3limin4t0r", "link": "https://stackoverflow.com/users/3982562/3limin4t0r"}, "edited": false, "score": 0, "creation_date": 1571151974, "post_id": 58394397, "comment_id": 103140835, "body": "How do you know who is a manager and who isn&#39;t? Do you have an attribute to mark an user as manager? Or is a user a manager if it has at least one employee? (In this last case you can&#39;t have managers without any employees.)"}, {"owner": {"reputation": 534, "user_id": 1520965, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/9d3599fdb032a18e0066027529da8085?s=128&d=identicon&r=PG&f=1", "display_name": "Manuk Karapetyan", "link": "https://stackoverflow.com/users/1520965/manuk-karapetyan"}, "reply_to_user": {"reputation": 13442, "user_id": 3982562, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2a3c7aae1d762372cda697833c602ec8?s=128&d=identicon&r=PG", "display_name": "3limin4t0r", "link": "https://stackoverflow.com/users/3982562/3limin4t0r"}, "edited": false, "score": 0, "creation_date": 1571298197, "post_id": 58394397, "comment_id": 103195945, "body": "@3limin4t0r The user is manager until <code>manager_id</code> is <code>nil</code>, or I can add if need one more boolean attribute for manager."}], "answers": [{"tags": [], "owner": {"reputation": 761, "user_id": 7786120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3acd54907ef6cb3d7de0ebd91177850d?s=128&d=identicon&r=PG&f=1", "display_name": "Akshay Goyal", "link": "https://stackoverflow.com/users/7786120/akshay-goyal"}, "is_accepted": false, "score": 1, "last_activity_date": 1571142639, "creation_date": 1571142639, "answer_id": 58394767, "question_id": 58394397, "link": "https://stackoverflow.com/questions/58394397/manager-employee-association-one-level-in-rails/58394767#58394767", "title": "Manager -&gt; Employee association one level in rails", "body": "<p>I think it's better to have one more field <code>manager: boolean</code> in your table. On the basis of this field you can decide whether a user is manager or not. Also you can add validations that manager_id must be blank if manager field is true.</p>\n\n<pre><code>validate :manager_id_blank_for_manager\n\nhas_many :employees, class_name: \"User\", foreign_key: \"manager_id\", dependent: :restrict_with_exception\n\nscope :managers, -&gt;{ where(manager: true) }\n\ndef manager?\n  manager\nend\n\nprivate\n\ndef manager_id_blank_for_manager\n  if manager_id.present? &amp;&amp; manager?\n    errors.add(:manager_id, :must_be_blank_for_manager) # Move this error to yml file\n  end\nend\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "edited": false, "score": 1, "creation_date": 1571181445, "post_id": 58403657, "comment_id": 103152447, "body": "There are some edge cases to be aware of though. Like if you do <code>u = User.new(manager: user_1); u.employees.new; u.save!&quot;</code> it won&#39;t raise an error. It just doesn&#39;t persist the employee."}, {"owner": {"reputation": 534, "user_id": 1520965, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/9d3599fdb032a18e0066027529da8085?s=128&d=identicon&r=PG&f=1", "display_name": "Manuk Karapetyan", "link": "https://stackoverflow.com/users/1520965/manuk-karapetyan"}, "edited": false, "score": 0, "creation_date": 1571231361, "post_id": 58403657, "comment_id": 103171070, "body": "how to restrict that edge case ?"}, {"owner": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "reply_to_user": {"reputation": 534, "user_id": 1520965, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/9d3599fdb032a18e0066027529da8085?s=128&d=identicon&r=PG&f=1", "display_name": "Manuk Karapetyan", "link": "https://stackoverflow.com/users/1520965/manuk-karapetyan"}, "edited": false, "score": 1, "creation_date": 1571235016, "post_id": 58403657, "comment_id": 103173492, "body": "You could use an association callback that raises an exception."}], "tags": [], "owner": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "is_accepted": true, "score": 1, "last_activity_date": 1571180810, "creation_date": 1571180810, "answer_id": 58403657, "question_id": 58394397, "link": "https://stackoverflow.com/questions/58394397/manager-employee-association-one-level-in-rails/58403657#58403657", "title": "Manager -&gt; Employee association one level in rails", "body": "<p>What you have is a really standard self-joining setup (with a few small issues). You can limit the depth of the tree by just adding a custom validation:</p>\n\n<pre><code>class User &lt; ApplicationRecord\n  # optional: true is needed in Rails 5+ since belongs_to is no\n  # longer optional by default\n  belongs_to :manager, class_name: 'User',\n                       optional: true\n  # pay attention to pluralization\n  has_many :employees, class_name: 'User',\n                       foreign_key: 'manager_id'\n  # calls the custom validation we will define later\n  validate :manager_must_be_a_manager, unless: :manager?\n\n  def manager?\n    manager.nil?\n  end\n\n  private\n    # our custom validation method\n    def manager_must_be_a_manager\n      errors.add(:manager, 'is not a manager') unless manager.manager?\n    end\nend\n</code></pre>\n\n<p>So now if we run:</p>\n\n<pre><code>user_1 = User.create!\nuser_2 = User.create!(manager: user_1)\nUser.create!(manager: user_2)\n</code></pre>\n\n<p>The third line will raise <code>ActiveRecord::RecordInvalid: Validation failed: Manager is not a manager</code>.</p>\n"}], "owner": {"reputation": 534, "user_id": 1520965, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/9d3599fdb032a18e0066027529da8085?s=128&d=identicon&r=PG&f=1", "display_name": "Manuk Karapetyan", "link": "https://stackoverflow.com/users/1520965/manuk-karapetyan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 220, "favorite_count": 0, "accepted_answer_id": 58403657, "answer_count": 2, "score": 0, "last_activity_date": 1571180810, "creation_date": 1571141455, "last_edit_date": 1571143523, "question_id": 58394397, "link": "https://stackoverflow.com/questions/58394397/manager-employee-association-one-level-in-rails", "title": "Manager -&gt; Employee association one level in rails", "body": "<p>I want to create manager->employee association.</p>\n\n<ul>\n<li>Manager have many employees</li>\n<li>Employee belongs to only one manager</li>\n<li>Manager does not have another manager</li>\n</ul>\n\n<p>How to implement this design ? \nI created something closer(code is below) but in my design manager can have other manager. </p>\n\n<pre><code>class User &lt; ApplicationRecord\n  has_many :employee, class_name: \"User\", foreign_key: \"manager_id\"\n  belongs_to :manager, class_name: \"User\", foreign_key: \"manager_id\"\nend\n</code></pre>\n\n<p>Any help is highly appreciated!</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-4"], "comments": [{"owner": {"reputation": 1243, "user_id": 10476417, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/07b57114718c234f1f44a28f5396026e?s=128&d=identicon&r=PG&f=1", "display_name": "Abhishek Aravindan", "link": "https://stackoverflow.com/users/10476417/abhishek-aravindan"}, "edited": false, "score": 1, "creation_date": 1571141707, "post_id": 58394308, "comment_id": 103134510, "body": "to have <code>CustomerNote.customer_note_versions</code> the customernote should be already saved in database.... you are creating a active record with the id blank using <code>CustomerNote.new</code> . id will be filled only after the record is saved."}, {"owner": {"reputation": 2104, "user_id": 1216272, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/77512fe46dec389c7bc5d85c6a321638?s=128&d=identicon&r=PG", "display_name": "Kunal Vashist", "link": "https://stackoverflow.com/users/1216272/kunal-vashist"}, "reply_to_user": {"reputation": 1243, "user_id": 10476417, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/07b57114718c234f1f44a28f5396026e?s=128&d=identicon&r=PG&f=1", "display_name": "Abhishek Aravindan", "link": "https://stackoverflow.com/users/10476417/abhishek-aravindan"}, "edited": false, "score": 0, "creation_date": 1571141756, "post_id": 58394308, "comment_id": 103134535, "body": "id should be autogenerated right"}, {"owner": {"reputation": 2104, "user_id": 1216272, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/77512fe46dec389c7bc5d85c6a321638?s=128&d=identicon&r=PG", "display_name": "Kunal Vashist", "link": "https://stackoverflow.com/users/1216272/kunal-vashist"}, "reply_to_user": {"reputation": 1243, "user_id": 10476417, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/07b57114718c234f1f44a28f5396026e?s=128&d=identicon&r=PG&f=1", "display_name": "Abhishek Aravindan", "link": "https://stackoverflow.com/users/10476417/abhishek-aravindan"}, "edited": false, "score": 0, "creation_date": 1571141800, "post_id": 58394308, "comment_id": 103134568, "body": "main problem is with rspec"}, {"owner": {"reputation": 1243, "user_id": 10476417, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/07b57114718c234f1f44a28f5396026e?s=128&d=identicon&r=PG&f=1", "display_name": "Abhishek Aravindan", "link": "https://stackoverflow.com/users/10476417/abhishek-aravindan"}, "edited": false, "score": 1, "creation_date": 1571141835, "post_id": 58394308, "comment_id": 103134591, "body": "<code>CustomerNote.new</code> will create a  record with id=&gt;nill , id will be assigned automatically when saved"}, {"owner": {"reputation": 1243, "user_id": 10476417, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/07b57114718c234f1f44a28f5396026e?s=128&d=identicon&r=PG&f=1", "display_name": "Abhishek Aravindan", "link": "https://stackoverflow.com/users/10476417/abhishek-aravindan"}, "edited": false, "score": 0, "creation_date": 1571141903, "post_id": 58394308, "comment_id": 103134634, "body": "try to call the CustomerNote.customer_note_versions with a record already saved in db."}, {"owner": {"reputation": 16396, "user_id": 2564298, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/BhG1x.jpg?s=128&g=1", "display_name": "Rajdeep Singh", "link": "https://stackoverflow.com/users/2564298/rajdeep-singh"}, "edited": false, "score": 2, "creation_date": 1571169983, "post_id": 58394308, "comment_id": 103148857, "body": "@KunalVashist Please share RSpec code if that&#39;s the main problem"}], "owner": {"reputation": 2104, "user_id": 1216272, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/77512fe46dec389c7bc5d85c6a321638?s=128&d=identicon&r=PG", "display_name": "Kunal Vashist", "link": "https://stackoverflow.com/users/1216272/kunal-vashist"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 668, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1571141201, "creation_date": 1571141201, "question_id": 58394308, "link": "https://stackoverflow.com/questions/58394308/unknown-primary-key-for-table-in-model", "title": "Unknown primary key for table in model", "body": "<p>I am getting unknown primary key for table, I am not able to judge why this is coming\nMy Table has primary key </p>\n\n<p>CustomerNote</p>\n\n<pre><code># == Schema Information\n#\n# Table name: customer_notes\n#\n#  id                       :integer          not null, primary key\n#  title                    :string\n#  company_id               :integer\n#  customer_id              :integer          not null\n#  user_id                  :integer\n\nCustomer Note Version\n# == Schema Information\n#\n# Table name: customer_note_versions\n#\n#  id                       :integer          not null, primary key\n#  title                    :string\n#  user_id                  :integer\n#  company_id               :integer\n#  customer_note_id         :integer\n#\n#Foreign Keys\n# fk_rails_...  (customer_note_id =&gt; customer_notes.id)\n</code></pre>\n\n<p>CustomerNoteVersion</p>\n\n<pre><code>belongs_to :customer_note\nvalidates :title, :user_id, :customer_note_id, presence: true\n</code></pre>\n\n<p>CustomerNote</p>\n\n<pre><code>has_many :customer_note_versions, dependent: :destroy\nvalidates :title, presence: true\n</code></pre>\n\n<p>I am trying to call \nCustomerNote.new.customer_note_versions\nIts throwing error on test console</p>\n\n<blockquote>\n  <p>ActiveRecord::UnknownPrimaryKey: Unknown primary key for table\n  customer_notes in model CustomerNote.</p>\n</blockquote>\n"}, {"tags": ["ruby-on-rails", "ruby", "rbenv"], "comments": [{"owner": {"reputation": 52685, "user_id": 980550, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/8emhY.jpg?s=128&g=1", "display_name": "lurker", "link": "https://stackoverflow.com/users/980550/lurker"}, "edited": false, "score": 1, "creation_date": 1571135456, "post_id": 58392508, "comment_id": 103131212, "body": "Exactly how are you trying to install it? By what command(s)?  Are there online steps you are following? If so, what are they? It appears you are also using <code>rbenv</code>?"}, {"owner": {"reputation": 19, "user_id": 12219932, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mC7W7pqQWGlgh6CRr54GiTb2foeG-4vFR-GG3D7=k-s128", "display_name": "Ruchira Bandara", "link": "https://stackoverflow.com/users/12219932/ruchira-bandara"}, "reply_to_user": {"reputation": 52685, "user_id": 980550, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/8emhY.jpg?s=128&g=1", "display_name": "lurker", "link": "https://stackoverflow.com/users/980550/lurker"}, "edited": false, "score": 0, "creation_date": 1571135632, "post_id": 58392508, "comment_id": 103131318, "body": "Yes I was following the below article. <a href=\"https://gorails.com/setup/osx/10.14-mojave\" rel=\"nofollow noreferrer\">gorails.com/setup/osx/10.14-mojave</a> I was trying with the following command as well. rbenv install 2.3.5"}, {"owner": {"reputation": 52685, "user_id": 980550, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/8emhY.jpg?s=128&g=1", "display_name": "lurker", "link": "https://stackoverflow.com/users/980550/lurker"}, "edited": false, "score": 0, "creation_date": 1571137354, "post_id": 58392508, "comment_id": 103132224, "body": "It would help if you showed exactly what you entered at the command line in your question. Just the error out of context is less clear. There&#39;s an <a href=\"https://stackoverflow.com/posts/58392508/edit\">edit</a> link below your question."}, {"owner": {"reputation": 19, "user_id": 12219932, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mC7W7pqQWGlgh6CRr54GiTb2foeG-4vFR-GG3D7=k-s128", "display_name": "Ruchira Bandara", "link": "https://stackoverflow.com/users/12219932/ruchira-bandara"}, "reply_to_user": {"reputation": 52685, "user_id": 980550, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/8emhY.jpg?s=128&g=1", "display_name": "lurker", "link": "https://stackoverflow.com/users/980550/lurker"}, "edited": false, "score": 0, "creation_date": 1571141062, "post_id": 58392508, "comment_id": 103134149, "body": "I updated my question with the command I tried in the console."}], "answers": [{"tags": [], "owner": {"reputation": 2323, "user_id": 5012862, "user_type": "registered", "accept_rate": 71, "profile_image": "https://graph.facebook.com/10153310796509376/picture?type=large", "display_name": "mayorsanmayor", "link": "https://stackoverflow.com/users/5012862/mayorsanmayor"}, "is_accepted": false, "score": 0, "last_activity_date": 1571141404, "creation_date": 1571141404, "answer_id": 58394377, "question_id": 58392508, "link": "https://stackoverflow.com/questions/58392508/ruby-installation-issues/58394377#58394377", "title": "Ruby installation issues", "body": "<p>Found an <a href=\"https://github.com/rbenv/rbenv/issues/1030\" rel=\"nofollow noreferrer\">issue in rbenv repo</a> which suggests that you need an extension to get rbenv to properly work. </p>\n\n<p>Follow the instruction <a href=\"https://github.com/rbenv/ruby-build\" rel=\"nofollow noreferrer\">here</a> to install and get rbenv to work properly. </p>\n"}, {"tags": [], "owner": {"reputation": 10843, "user_id": 5101148, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bc92fb51fd3b1f946847ccd36d63aee6?s=128&d=identicon&r=PG&f=1", "display_name": "Simba", "link": "https://stackoverflow.com/users/5101148/simba"}, "is_accepted": false, "score": 0, "last_activity_date": 1571205744, "creation_date": 1571205744, "answer_id": 58406673, "question_id": 58392508, "link": "https://stackoverflow.com/questions/58392508/ruby-installation-issues/58406673#58406673", "title": "Ruby installation issues", "body": "<p><code>rbenv</code> is a ruby manager. It builds different <code>ruby</code> from source. To make it work, you need to install <code>rbenv</code> and <code>rbenv-build</code>.</p>\n\n<pre class=\"lang-sh prettyprint-override\"><code>brew install rbenv rbenv-build\n</code></pre>\n\n<p>Secondly, you need to install dependencies <code>readline</code> and <code>openssl@1.1</code>.</p>\n\n<pre class=\"lang-sh prettyprint-override\"><code>brew install realine openssl@1.1\n</code></pre>\n\n<p>The error <code>missing extensions</code> is related to <code>ruby-build</code>, you may forget to install it or the dependencies.</p>\n"}], "owner": {"reputation": 19, "user_id": 12219932, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mC7W7pqQWGlgh6CRr54GiTb2foeG-4vFR-GG3D7=k-s128", "display_name": "Ruchira Bandara", "link": "https://stackoverflow.com/users/12219932/ruchira-bandara"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 727, "favorite_count": 0, "answer_count": 2, "score": -2, "last_activity_date": 1571205744, "creation_date": 1571135189, "last_edit_date": 1571143044, "question_id": 58392508, "link": "https://stackoverflow.com/questions/58392508/ruby-installation-issues", "title": "Ruby installation issues", "body": "<p>I am trying to install the ruby version 2.3.5 in my mac OS environment which is Mojave. I am getting the following issues. Appreciate If anyone can help me to sort out the issue ?</p>\n\n<pre><code>ERROR: Ruby install aborted due to missing extensions\nConfigure options used:\n  --prefix=/Users/efutures/.rbenv/versions/2.3.5\n  --with-openssl-dir=/usr/local/opt/openssl@1.1\n  --with-readline-dir=/usr/local/opt/readline\n  CC=clang\n  CFLAGS= -O3 -Wno-error=shorten-64-to-32 \n  LDFLAGS=-L/Users/efutures/.rbenv/versions/2.3.5/lib \n  CPPFLAGS=-I/Users/efutures/.rbenv/versions/2.3.5/include \n</code></pre>\n\n<p>I tried the following command.</p>\n\n<pre><code>rbenv install 2.3.5\n</code></pre>\n"}, {"tags": ["ruby", "logstash"], "answers": [{"comments": [{"owner": {"reputation": 2251, "user_id": 9785060, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IUduC.png?s=128&g=1", "display_name": "Viktor", "link": "https://stackoverflow.com/users/9785060/viktor"}, "reply_to_user": {"reputation": 15, "user_id": 2931829, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/38459a747ddb97bce43304b1bf48b6b9?s=128&d=identicon&r=PG&f=1", "display_name": "user2931829", "link": "https://stackoverflow.com/users/2931829/user2931829"}, "edited": false, "score": 0, "creation_date": 1571142400, "post_id": 58392631, "comment_id": 103134934, "body": "@user2931829 If this answer solved you problem, <a href=\"https://meta.stackexchange.com/questions/5234/how-does-accepting-an-answer-work\">Accept it</a>. If you have another question, open a new question instead of posting additional questions in the answers section."}], "tags": [], "owner": {"reputation": 63078, "user_id": 220147, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b3881a28fe402dd2d1de44717486cae8?s=128&d=identicon&r=PG", "display_name": "Michael Kohl", "link": "https://stackoverflow.com/users/220147/michael-kohl"}, "is_accepted": true, "score": 1, "last_activity_date": 1571135564, "creation_date": 1571135564, "answer_id": 58392631, "question_id": 58392468, "link": "https://stackoverflow.com/questions/58392468/logstash-event-timestamp-adjustment/58392631#58392631", "title": "Logstash event @timestamp adjustment", "body": "<blockquote>\n  <p>event.set('event.duration', event.get('event.duration').to_i * 1000000000))</p>\n</blockquote>\n\n<p>You have 2 opening <code>(</code> and 3 closing <code>)</code>, which leads to the <code>unexpected ')'</code> error. Just remove the final closing parenthesis that the compiler indicated with a <code>^</code>.</p>\n"}], "owner": {"reputation": 15, "user_id": 2931829, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/38459a747ddb97bce43304b1bf48b6b9?s=128&d=identicon&r=PG&f=1", "display_name": "user2931829", "link": "https://stackoverflow.com/users/2931829/user2931829"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 73, "favorite_count": 0, "accepted_answer_id": 58392631, "answer_count": 1, "score": 0, "last_activity_date": 1571139499, "creation_date": 1571135058, "question_id": 58392468, "link": "https://stackoverflow.com/questions/58392468/logstash-event-timestamp-adjustment", "title": "Logstash event @timestamp adjustment", "body": "<p>i want to calculate \"event.start\" from \"event.end\" and \"event.duration\", so a subtraction of \"event.end\" and \"event.duration\"</p>\n\n<p>\"event.end\": \"2019-10-15T07:34:14.000Z\",</p>\n\n<p>\"event.duration\": 30, (sec.)</p>\n\n<p>Thereafter, event.duration is to be converted into nanoseconds, ie multiplication * 1000000000.</p>\n\n<p>I've looked at using the ruby plug in but my ruby knowledge is zero.</p>\n\n<p>My first attempt is this:</p>\n\n<pre><code>if !([event.duration] == 0) {\n    mutate  {\n        add_field =&gt; {\"event.end\" =&gt; \"%{@timestamp}\" }\n            }\n            ruby {\n#                   init =&gt; \"require 'time'\"\n#                   code =&gt; \"\n#                           diff = event.get('start_date') - event.get('end_date')\n#                           event.set('timediff') = diff;\n#                           \"\n                        code =&gt; \"event.set('event.duration', event.get('event.duration').to_i * 1000000000))\"   \n            }\n        }\n</code></pre>\n\n<p>But get the following error message:</p>\n\n<pre><code>[2019-10-15T12:11:05,640][ERROR][org.logstash.Logstash    ] java.lang.IllegalStateException: Logstash stopped processing because of an error: (SyntaxError) (ruby filter code):2: syntax error, unexpected ')'\n event.set('event.duration', event.get('event.duration').to_i * 1000000000)) \n                                                                           ^\n</code></pre>\n\n<p>Thanks for any help.</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 3, "creation_date": 1571131524, "post_id": 58391140, "comment_id": 103129173, "body": "You probably already have the exact content. See <code>&quot;\\#$&quot;.length #=&gt; 2</code> or <code>&quot;\\#$&quot;[0] =&gt; &quot;#&quot;</code> \u2013 there&#39;s no actual backslash in the string, it&#39;s just an <a href=\"https://en.wikipedia.org/wiki/Escape_character\" rel=\"nofollow noreferrer\">escape character</a> because <code>#</code> has special meaning (just like backslash itself)."}, {"owner": {"reputation": 2251, "user_id": 9785060, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IUduC.png?s=128&g=1", "display_name": "Viktor", "link": "https://stackoverflow.com/users/9785060/viktor"}, "edited": false, "score": 1, "creation_date": 1571132714, "post_id": 58391140, "comment_id": 103129832, "body": "The character sequence is 1 char longer after being loaded using the <code>#read</code> method (probably because of the backslash added before the initial backslash) and reading from the CSV file with the special characters and writing the result to a new CSV will keep the added characters which seems a bit odd and inconvenient"}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 1, "creation_date": 1571132947, "post_id": 58391140, "comment_id": 103129935, "body": "Can you provide a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>?"}, {"owner": {"reputation": 2251, "user_id": 9785060, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IUduC.png?s=128&g=1", "display_name": "Viktor", "link": "https://stackoverflow.com/users/9785060/viktor"}, "edited": false, "score": 0, "creation_date": 1571133774, "post_id": 58391140, "comment_id": 103130364, "body": "Sorry, you&#39;re absolutely right. The mistake was on my side, saved the array of arrays instead of just the value. Worked like expected when I did it the proper way."}, {"owner": {"reputation": 572, "user_id": 6799634, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh3.googleusercontent.com/-2cRegFLGv1s/AAAAAAAAAAI/AAAAAAAAAxg/N7-OFe4bwlY/photo.jpg?sz=128", "display_name": "arunkumar sambu", "link": "https://stackoverflow.com/users/6799634/arunkumar-sambu"}, "edited": false, "score": 0, "creation_date": 1571147264, "post_id": 58391140, "comment_id": 103137994, "body": "Thanks Stefan, gotcha. Can I ignore the escape characters while reading the csv file"}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1571148493, "post_id": 58391140, "comment_id": 103138759, "body": "@arunkumarsambu not sure what you mean. The escape characters are not part of the string. If you need further help, please provide an example that I can copy and paste."}], "owner": {"reputation": 572, "user_id": 6799634, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh3.googleusercontent.com/-2cRegFLGv1s/AAAAAAAAAAI/AAAAAAAAAxg/N7-OFe4bwlY/photo.jpg?sz=128", "display_name": "arunkumar sambu", "link": "https://stackoverflow.com/users/6799634/arunkumar-sambu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 90, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1571130714, "creation_date": 1571130714, "question_id": 58391140, "link": "https://stackoverflow.com/questions/58391140/read-csv-file-with-all-special-characters-using-ruby", "title": "Read CSV file with all special characters using Ruby", "body": "<p>I have a scenario to import the csv file then validate the content, I have a cell with following special characters</p>\n\n<pre><code>\u201c\u00a0!#$%&amp;\u2019()*+,-./:;&lt;=&gt;?@[\\]^_`{|}\u201d~\n</code></pre>\n\n<p>When I read the CSV file with above characters in cell using <code>CSV.read(\"csv_filepath\")</code>, I am getting following</p>\n\n<pre><code>\u201c !\\#$%&amp;\u2019()*+,-./:;&lt;=&gt;?@[\\\\]^_`{|}\u201d~\n</code></pre>\n\n<p>backslash(\\) is added for # and \\, how to read the exact content</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-4", "internationalization", "rails-i18n"], "comments": [{"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1571132488, "post_id": 58390974, "comment_id": 103129716, "body": "This is obviously a complete guess, since I don&#39;t have access to any of your source code... But maybe you have some code in your application (e.g. in a gem) that&#39;s changing global state with <code>I18n.locale = :en</code> -- and then since your production server has multiple processes, only some of these get stuck in the alternate locale."}, {"owner": {"reputation": 2323, "user_id": 5012862, "user_type": "registered", "accept_rate": 71, "profile_image": "https://graph.facebook.com/10153310796509376/picture?type=large", "display_name": "mayorsanmayor", "link": "https://stackoverflow.com/users/5012862/mayorsanmayor"}, "edited": false, "score": 0, "creation_date": 1571142445, "post_id": 58390974, "comment_id": 103134963, "body": "It is possible that you didn&#39;t properly set the default locale. I have used I18n in so many apps and never experienced this issue. Do you have a <code>set_locale</code> method in your application controller? with <code>before_action :set_locale</code> , this will probably be a <code>before_filter</code> in rails 4."}, {"owner": {"reputation": 1, "user_id": 9822539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3553cf6920a96937f33ffc28aa58d19?s=128&d=identicon&r=PG&f=1", "display_name": "Malduan", "link": "https://stackoverflow.com/users/9822539/malduan"}, "reply_to_user": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1571185827, "post_id": 58390974, "comment_id": 103153291, "body": "@TomLord Thanks for the suggestion! That&#39;s the line I&#39;m currently investigating for the lack of other clues. I have no such code in the project itself, but gems are a possibility, however the problem is that I have about 230 gems in my bundle..."}, {"owner": {"reputation": 1, "user_id": 9822539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3553cf6920a96937f33ffc28aa58d19?s=128&d=identicon&r=PG&f=1", "display_name": "Malduan", "link": "https://stackoverflow.com/users/9822539/malduan"}, "reply_to_user": {"reputation": 2323, "user_id": 5012862, "user_type": "registered", "accept_rate": 71, "profile_image": "https://graph.facebook.com/10153310796509376/picture?type=large", "display_name": "mayorsanmayor", "link": "https://stackoverflow.com/users/5012862/mayorsanmayor"}, "edited": false, "score": 0, "creation_date": 1571193592, "post_id": 58390974, "comment_id": 103154723, "body": "@mayorsanmayor Thanks for the comment! However I don&#39;t thinks this is the case, since the project is actually a working one and normally there are no problems with the (Japanese) locale whatsoever. But on some very rare occasions (normally) it would try to load ENG for some reason. As for application controller, I don&#39;t use the <code>set_locale</code> method there, but I set locale in <b>/config/application.rb</b> which I think should be sufficient normally..."}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 9822539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3553cf6920a96937f33ffc28aa58d19?s=128&d=identicon&r=PG&f=1", "display_name": "Malduan", "link": "https://stackoverflow.com/users/9822539/malduan"}, "is_accepted": false, "score": 0, "last_activity_date": 1571216247, "creation_date": 1571216247, "answer_id": 58409494, "question_id": 58390974, "link": "https://stackoverflow.com/questions/58390974/wrong-i18n-locale-is-loaded-randomly/58409494#58409494", "title": "Wrong I18n locale is loaded randomly", "body": "<p>I have figured the reason why <code>:en</code> locale was loading.  </p>\n\n<p>The <code>config.i18n.fallbacks</code> was actually set to <code>true</code> later in code.\nAnd since the <code>config.i18n.available_locales</code> wasn't set in <strong>application.rb</strong> explicitly, <code>I18n</code> gem had <code>:en</code> locale included there and when the <code>:ja</code> locale, which was set in <code>config.i18n.locale</code> and <code>config.i18n.default_locale</code> failed to load (for reason yet unknown), it tried to fallback to <code>:en</code> locale which led to the problem.</p>\n\n<p>Unfortunately, still no idea why would <code>:js</code> locale fail to load, but I guess that's entirely another question.</p>\n\n<p>Thanks for the hints!</p>\n"}], "owner": {"reputation": 1, "user_id": 9822539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3553cf6920a96937f33ffc28aa58d19?s=128&d=identicon&r=PG&f=1", "display_name": "Malduan", "link": "https://stackoverflow.com/users/9822539/malduan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 651, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1571216247, "creation_date": 1571130249, "question_id": 58390974, "link": "https://stackoverflow.com/questions/58390974/wrong-i18n-locale-is-loaded-randomly", "title": "Wrong I18n locale is loaded randomly", "body": "<p>Sometimes instead of expected Japanese language config, the English config is being loaded, which actually doesn't exist and isn't set anywhere neither as a default_locale nor as a fallback one.  </p>\n\n<p>The problem is that it happens occasionally/randomly and was impossible to replicate before, but today it started occurring really often. That is, just by staying on the same page and pressing F5 resulted on average in about 50/50% of occurrences of EN/JAP locales (no pattern, just random).<br>\nThe thing is that the site DOESN'T even have the ENG locale implemented at all, so when it tries to load ENG locale it fails with an understandable error:</p>\n\n<pre><code>ERROR -- : .... translation missing: en.some_translation...\n</code></pre>\n\n<p>And this is the only error occurring.</p>\n\n<p>But it SHOULD NOT be even attempting to load ENG locale.<br>\nThe locale is firmly set in application.rb:</p>\n\n<pre><code>config.i18n.default_locale = :ja\nconfig.i18n.locale = :ja\n</code></pre>\n\n<p>production.rb shouldn't be overwriting this setting as it only contains:</p>\n\n<pre><code>config.i18n.fallbacks = false\n</code></pre>\n\n<p>It happens only in production.<br>\n\"god restart app_name\" fixes it for some time, but it seems like it occurs more as the time passes by, but I can't say for sure about it.<br>\nThe error that occurs in ENG locale seems to be the same if when I set default_locale to:</p>\n\n<pre><code>config.i18n.default_locale = :en\n</code></pre>\n\n<p>But I have grepped my application code for the \"default_locale\" and couldn't find any code that changes it. Could some gem be a culprit?  </p>\n\n<p>Rails version: 4.2.7.1<br>\nI18n vesrion: 0.7.0</p>\n\n<p>Would much appreciate any hint at this point.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "slack"], "answers": [{"tags": [], "owner": {"reputation": 555, "user_id": 10813827, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b736f8f0de40f55f19c595a02be8b667?s=128&d=identicon&r=PG&f=1", "display_name": "k10a", "link": "https://stackoverflow.com/users/10813827/k10a"}, "is_accepted": false, "score": 0, "last_activity_date": 1571173596, "creation_date": 1571173596, "answer_id": 58402647, "question_id": 58390266, "link": "https://stackoverflow.com/questions/58390266/rails-failed-to-authenticate-with-slack/58402647#58402647", "title": "Rails: Failed to authenticate with Slack", "body": "<p>I have mistyped <code>client_id</code> on credentials.<br>\nThis requires not <code>.</code>.</p>\n"}], "owner": {"reputation": 555, "user_id": 10813827, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b736f8f0de40f55f19c595a02be8b667?s=128&d=identicon&r=PG&f=1", "display_name": "k10a", "link": "https://stackoverflow.com/users/10813827/k10a"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 39, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1571173596, "creation_date": 1571127783, "question_id": 58390266, "link": "https://stackoverflow.com/questions/58390266/rails-failed-to-authenticate-with-slack", "title": "Rails: Failed to authenticate with Slack", "body": "<p>Thank you so much to help me in advance. I'm working on an application where people authenticate with Slack and it send a notification to their workspace at the same time the contents generated automatically.</p>\n\n<p>But oauth error occurs:</p>\n\n<pre><code>OAuth Error: Invalid client_id parameter\n</code></pre>\n\n<p>URL is like below:</p>\n\n<pre><code>https://slack.com/oauth/authorize?client_id=XXXXXXXXXXX&amp;scope=bot%2Cusers%3Aread.email%2Ccommands%2Cusers%3Aread&amp;state=XXXXXXXXXXXXX&amp;tracked=1\n</code></pre>\n\n<p>I had a same issue when trying to build with <code>omniauth_slack</code> gem.</p>\n\n<p><strong>app/views/home/index.html.erb</strong></p>\n\n<pre><code>&lt;%= link_to \"Sign in with Slack\", slack_activate_path %&gt;\n</code></pre>\n\n<p><strong>app/controllers/slack_controller.rb</strong></p>\n\n<pre><code>class SlackController &lt; ApplicationController\n  def activate\n    oauth_state = \"XXXXXXXXXXXXX\"\n    uri = URI('https://slack.com/oauth/authorize')\n    uri.query = {\n      client_id: Rails.application.credentials[:slack][:client_id],\n      scope: 'bot,users:read.email,commands,users:read',\n      state: oauth_state,\n    }.to_query\n\n    redirect_to uri.to_s\n  end\n\n  def callback\n  end\nend\n</code></pre>\n\n<p><strong>config/routes.rb</strong></p>\n\n<pre><code>Rails.application.routes.draw do\n  root 'home#index'\n\n  match '/slack/activate', to: 'slack#activate', via: 'get'\n  match '/slack/callback', to: 'slack#callback', via: 'get'\n\n  # For details on the DSL available within this file, see http://guides.rubyonrails.org/routing.html\nend\n</code></pre>\n"}, {"tags": ["ruby", "mailgun", "ruby-on-rails-6"], "answers": [{"tags": [], "owner": {"reputation": 303, "user_id": 1290490, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/269fd38cdeffb5c16d6a76c617383f77?s=128&d=identicon&r=PG", "display_name": "cpt_peter", "link": "https://stackoverflow.com/users/1290490/cpt-peter"}, "is_accepted": false, "score": 2, "last_activity_date": 1571173716, "creation_date": 1571173716, "answer_id": 58402673, "question_id": 58390229, "link": "https://stackoverflow.com/questions/58390229/rails-6-actionmailbox-with-mailgun-returning-404/58402673#58402673", "title": "Rails 6 ActionMailbox with Mailgun returning 404", "body": "<p>Well, turns out it was the most stupid of mistakes.  In <strong>config/application.rb</strong> the final configuration was wrong.  I needed to replace <code>:mail_gun</code> with <code>:mailgun</code>:</p>\n\n<pre><code>    # Set the ActionMailbox ingress here for now.\n    config.action_mailbox.ingress = :mailgun\n</code></pre>\n\n<p>Unfortunately, the Rails error message was not very helpful here.</p>\n\n<p>To give a little more info, ActionMailbox has a number of different routes defined for different email processors.  Therefore, the URL to which the email processor posts the incoming email defines the controller to use.  On receiving an email, Rails checks that the URL to which the email has been posted matches the <code>ingress</code> class that is set in the config.  If not, you get the error I saw.</p>\n"}], "owner": {"reputation": 303, "user_id": 1290490, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/269fd38cdeffb5c16d6a76c617383f77?s=128&d=identicon&r=PG", "display_name": "cpt_peter", "link": "https://stackoverflow.com/users/1290490/cpt-peter"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 217, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1572211833, "creation_date": 1571127660, "last_edit_date": 1572211833, "question_id": 58390229, "link": "https://stackoverflow.com/questions/58390229/rails-6-actionmailbox-with-mailgun-returning-404", "title": "Rails 6 ActionMailbox with Mailgun returning 404", "body": "<p>I am developing an in-house expenses application on Rails 6 with ActionMailbox to replace Excel spreadsheets.  As many of our receipts are now in email form (for example airline tickets), the idea is that users will be able to simply forward a receipt to the application and it will automatically be associated with the expense entry.</p>\n\n<p>I am using ActionMailbox with Mailgun as the email receiver. As suggested by the Gorails Pro tutorial I have exposed my app using localtunnel to the general Internet. I have used Mailgun's facility to send a test email to my application.  </p>\n\n<p>My post address is:</p>\n\n<pre><code>https://xxxxxxxx.localtunnel.me/rails/action_mailbox/mailgun/inbound_emails/mime\n</code></pre>\n\n<p>However, I have run into an issue where the incoming email from Mailgun is not being processed correctly but is being returned with a 404 error.  The Rails log shows the message being received as a POST.  The last two entries in the log are:</p>\n\n<pre><code>2019-10-15T07:50:07.646Z 10260 TID-gn609ivg8 INFO: Filter chain halted as :ensure_configured rendered or redirected\n2019-10-15T07:50:07.646Z 10260 TID-gn609ivg8 INFO: Completed 404 Not Found in 0ms (ActiveRecord: 0.0ms | Allocations: 144)\n</code></pre>\n\n<p>My configuration is:\n<strong>config/routes.rb</strong></p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>Rails.application.routes.draw do\n  devise_for :users\n  resources :categories\n\n  resources :expense_claims do\n    get 'export_excel', on: :member\n    post 'barclay_csv_import', on: :collection\n  end\n\n  resources :expense_entries\n\n  root 'expense_claims#index'\n\n  # Enable the sidekiq console.\n  require 'sidekiq/web'\n  mount Sidekiq::Web =&gt; '/sidekiq'\nend\n</code></pre>\n\n<p><strong>config/application.rb</strong></p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>module Expenses\n  class Application &lt; Rails::Application\n    # Initialize configuration defaults for originally generated Rails version.\n    config.load_defaults 5.2\n\n    # Settings in config/environments/* take precedence over those specified here.\n    # Application configuration can go into files in config/initializers\n    # -- all .rb files in that directory are automatically loaded after loading\n    # the framework and any gems in your application.\n\n    # Set the ActionMailbox ingress here for now.\n    config.action_mailbox.ingress = :mail_gun\n  end\nend\n</code></pre>\n\n<p><strong>config/environments/development.rb</strong></p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>Rails.application.configure do\n\n  [... lot of stuff removed as not relevant]\n  # Settings specified here will take precedence over those in config/application.rb.\n  config.action_mailer.default_url_options = { host: '0.0.0.0', port: 3000 }\n  config.action_mailer.delivery_method = :smtp\n  config.action_mailer.smtp_settings = { address: '0.0.0.0', port: 1025 }\n\n  # Set the active job queue adapter to Sidekiq/Redis\n  # config.active_job.queue_adapter = :sidekiq\n  # Alternatively, when debugging, you can set to in-line (or :async)\n  config.active_job.queue_adapter = :inline\n\n  # Don't care if the mailer can't send.\n  config.action_mailer.raise_delivery_errors = false\n\n  config.action_mailer.perform_caching = false\n\n\n  # Set so we can test Devise self registration\n  config.action_mailer.default_url_options = { host: 'localhost', port: 3000 }\n\n  # Allow traffic from localtunnel\n  config.hosts &lt;&lt; 'xxxxxx.localtunnel.me'\nend\n\n</code></pre>\n\n<p><strong>app/mailboxes/application_mailbox.rb</strong></p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>class ApplicationMailbox &lt; ActionMailbox::Base\n  routing :all =&gt; :receipt\nend\n</code></pre>\n\n<p><strong>app/mailboxes/receipt_mailbox.rb</strong></p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>class ReceiptMailbox &lt; ApplicationMailbox\n  # mail =&gt; Mail object\n  # inbound_email =&gt; ActionMailboxEmail record\n  def process\n\n  end\nend\n</code></pre>\n"}, {"tags": ["sql", "ruby-on-rails", "ruby", "rubygems", "ruby-on-rails-5"], "answers": [{"tags": [], "owner": {"reputation": 3926, "user_id": 2190621, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4c464f439212bca87517b234f7c9bd3e?s=128&d=identicon&r=PG&f=1", "display_name": "demir", "link": "https://stackoverflow.com/users/2190621/demir"}, "is_accepted": false, "score": 0, "last_activity_date": 1571127766, "creation_date": 1571127766, "answer_id": 58390260, "question_id": 58390160, "link": "https://stackoverflow.com/questions/58390160/use-a-sql-file-to-populate-data-in-ruby/58390260#58390260", "title": "Use a sql file to populate data in ruby", "body": "<p>You can use <code>pg_restore</code> like this:</p>\n\n<pre><code>rails db:drop\nrails db:create\npg_restore -d db_name file_name.sql\n</code></pre>\n"}], "owner": {"reputation": 35, "user_id": 8002952, "user_type": "registered", "profile_image": "https://graph.facebook.com/661748747364922/picture?type=large", "display_name": "Shahbaz Zaidi", "link": "https://stackoverflow.com/users/8002952/shahbaz-zaidi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 23, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1571127766, "creation_date": 1571127415, "question_id": 58390160, "link": "https://stackoverflow.com/questions/58390160/use-a-sql-file-to-populate-data-in-ruby", "title": "Use a sql file to populate data in ruby", "body": "<p>I have a sql file and i want to use it to populate the psql in RoR.\nthe  psql ___ &lt; ______.sql is not working ? Can you please guide me on how to use this sql file and use it</p>\n"}, {"tags": ["ruby", "sum", "nomethoderror"], "comments": [{"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 3, "creation_date": 1571127373, "post_id": 58390077, "comment_id": 103126910, "body": "<code>sum</code> was added in Ruby 2.4, you&#39;re probably running an older version."}, {"owner": {"reputation": 358, "user_id": 8708097, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/APLHT.jpg?s=128&g=1", "display_name": "Saif chaudhry", "link": "https://stackoverflow.com/users/8708097/saif-chaudhry"}, "edited": false, "score": 2, "creation_date": 1571127623, "post_id": 58390077, "comment_id": 103127040, "body": "You can do [1,2,3,4].inject(:+)"}, {"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 0, "creation_date": 1571141489, "post_id": 58390077, "comment_id": 103134376, "body": "According to which Ruby documentation? Are you 100% sure that the documentation you are reading is for your version of Ruby and not some other version?"}], "answers": [{"comments": [{"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1571128741, "post_id": 58390267, "comment_id": 103127662, "body": "You might want to pass a default value, i.e. <code>ary.inject(0, :+)</code> to account for empty arrays."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2373368"}, "edited": false, "score": 0, "creation_date": 1617240087, "post_id": 58390267, "comment_id": 118252043, "body": "Thank you, it was a version problem I had 2.3.7, not 2.4."}], "tags": [], "owner": {"reputation": 32451, "user_id": 2516474, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a2179a340c0e84edc285d432211145d?s=128&d=identicon&r=PG", "display_name": "SteveTurczyn", "link": "https://stackoverflow.com/users/2516474/steveturczyn"}, "is_accepted": true, "score": 5, "last_activity_date": 1571132931, "last_edit_date": 1571132931, "creation_date": 1571127785, "answer_id": 58390267, "question_id": 58390077, "link": "https://stackoverflow.com/questions/58390077/no-method-error-when-using-sum-to-an-array-in-ruby/58390267#58390267", "title": "No Method Error when using .sum to an array in Ruby", "body": "<p>Check what version of ruby you're using with <code>ruby -v</code></p>\n\n<p>If you have a version older than 2.4, you can use inject instead.</p>\n\n<pre><code>[1, 2, 3, 4].inject(0,:+)\n</code></pre>\n\n<p>The above is a shorthand for</p>\n\n<pre><code>   [1, 2, 3, 4].inject(0) {|sum, value| sum + value}\n</code></pre>\n\n<p>The zero <code>0</code> is needed to handle empty arrays, which otherwise would return <code>nil</code></p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user2373368"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 165, "favorite_count": 0, "accepted_answer_id": 58390267, "answer_count": 1, "score": 3, "last_activity_date": 1617240584, "creation_date": 1571127083, "last_edit_date": 1617240584, "question_id": 58390077, "link": "https://stackoverflow.com/questions/58390077/no-method-error-when-using-sum-to-an-array-in-ruby", "title": "No Method Error when using .sum to an array in Ruby", "body": "<p>The below function will throw a NoMethodError when it is expected to calculate the sum of a given array.</p>\n<p>By printing the result &quot;p&quot; it should return 10.</p>\n<pre><code>p [1,2,3,4].sum\n#=&gt; 10\n</code></pre>\n<p>Instead of getting the result of the sum, I get the error below.</p>\n<pre><code>undefined method `sum' for [1, 2, 3, 4]:Array (NoMethodError)\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-6"], "comments": [{"owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 0, "creation_date": 1571126132, "post_id": 58389408, "comment_id": 103126315, "body": "Can you be more specific about the problem you&#39;re having/"}, {"owner": {"reputation": 49, "user_id": 11231142, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b6521790d4e29e8127ca7d61600ed1e5?s=128&d=identicon&r=PG&f=1", "display_name": "albert", "link": "https://stackoverflow.com/users/11231142/albert"}, "reply_to_user": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 0, "creation_date": 1571126258, "post_id": 58389408, "comment_id": 103126366, "body": "I want the draft to change from true to false but it is not changing, I guess the problem is from my model"}, {"owner": {"reputation": 5312, "user_id": 6535997, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/10156345016155058/picture?type=large", "display_name": "Mark", "link": "https://stackoverflow.com/users/6535997/mark"}, "edited": false, "score": 0, "creation_date": 1571126557, "post_id": 58389408, "comment_id": 103126518, "body": "Have you called <code>@auction.publish!</code>? If you do that, the action you&#39;ve published should appear in your published scope and not your draft scope"}, {"owner": {"reputation": 49, "user_id": 11231142, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b6521790d4e29e8127ca7d61600ed1e5?s=128&d=identicon&r=PG&f=1", "display_name": "albert", "link": "https://stackoverflow.com/users/11231142/albert"}, "reply_to_user": {"reputation": 5312, "user_id": 6535997, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/10156345016155058/picture?type=large", "display_name": "Mark", "link": "https://stackoverflow.com/users/6535997/mark"}, "edited": false, "score": 0, "creation_date": 1571127462, "post_id": 58389408, "comment_id": 103126949, "body": "@mark Do you mean I should call <code>&lt;% @auctions.published.each do |auction| %&gt;</code> in my view? or where should I call the @auction.publish!"}, {"owner": {"reputation": 5312, "user_id": 6535997, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/10156345016155058/picture?type=large", "display_name": "Mark", "link": "https://stackoverflow.com/users/6535997/mark"}, "edited": false, "score": 0, "creation_date": 1571128020, "post_id": 58389408, "comment_id": 103127269, "body": "Wherever you intend to publish the auction :) How are you triggering it in your app? I&#39;m guessing there will be some controller you use when you try to publish the auction?"}, {"owner": {"reputation": 5312, "user_id": 6535997, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/10156345016155058/picture?type=large", "display_name": "Mark", "link": "https://stackoverflow.com/users/6535997/mark"}, "edited": false, "score": 0, "creation_date": 1571128086, "post_id": 58389408, "comment_id": 103127306, "body": "Basically whichever controller action you&#39;re going through (you&#39;ll see it in your server logs), you need to add the <code>@action.publish!</code> line to - that bit of code will never execute and make an auction published unless you manually call it or trigger it in a controller"}], "owner": {"reputation": 49, "user_id": 11231142, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b6521790d4e29e8127ca7d61600ed1e5?s=128&d=identicon&r=PG&f=1", "display_name": "albert", "link": "https://stackoverflow.com/users/11231142/albert"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 26, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1571125393, "creation_date": 1571124693, "last_edit_date": 1571125393, "question_id": 58389408, "link": "https://stackoverflow.com/questions/58389408/scheduling-auctions", "title": "Scheduling Auctions", "body": "<p>I am working on an auctions site and I want to schedule auction so users can set the date and time they want their auction to start and end. I added Published_at, end_time and draft which is default to true in my db migration and I can create an auction and select a published_at time and end_time which stores in db but I am having difficulty making the auction to now show on the date and time selected and end on the date and time selected. </p>\n\n<p>Model/auction.rb</p>\n\n<pre><code>class Auction &lt; ApplicationRecord\n  mount_uploader :image, ImageUploader\n  belongs_to :user\n  has_many :bids, dependent: :destroy\n\n  scope :draft, -&gt; {\n    where(:draft =&gt; true)\n  }\n\n  # scope :draft, where(:draft =&gt; true)\n  scope :published, proc {\n    where(:draft =&gt; false).where('published_at &lt;= ?', Time.zone.now)\n  }\n\n\n  before_save :ensure_published_at, :unless =&gt; :draft?\n  protected\n  def ensure_published_at\n    # Set it to current time if none has been specified.\n    self.published_at ||= Time.zone.now\n  end\n\n  def publish!\n    self.draft = false\n    self.save!\n  end\nend\n</code></pre>\n\n<p>auctions_controller.rb</p>\n\n<pre><code>def index\n  @auctions = Auction.published\nend\n</code></pre>\n\n<p>so I guess what I am trying to do in the model is for the draft to change from true to false so I can show in Index controller, but seems I'm getting many things wrong.</p>\n\n<p>I would appericiate any help please.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "rails-i18n"], "comments": [{"owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 0, "creation_date": 1571123883, "post_id": 58388123, "comment_id": 103125116, "body": "The gem only provides translations for the default error messages. All other texts including the name of certain attributes are not translated by that gem. You need to provide translations for all models and attributes yourself. Did you do that?"}, {"owner": {"reputation": 848, "user_id": 11249670, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f29532e75e13b5f3b631012229f22829?s=128&d=identicon&r=PG&f=1", "display_name": "reesaspieces", "link": "https://stackoverflow.com/users/11249670/reesaspieces"}, "reply_to_user": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 0, "creation_date": 1571124387, "post_id": 58388123, "comment_id": 103125373, "body": "No, I was under the impression that the gem would insert the attribute names in English. That was the behaviour in a different Rails project using the same i18n gem - the same error message would look like this: <code>\u30d0\u30ea\u30c7\u30fc\u30b7\u30e7\u30f3\u306b\u5931\u6557\u3057\u307e\u3057\u305f: First name\u3092\u5165\u529b\u3057\u3066\u304f\u3060\u3055\u3044</code>."}, {"owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 0, "creation_date": 1571124796, "post_id": 58388123, "comment_id": 103125604, "body": "Then you probably defined the translations to fallback to English and not to raise errors in that project. I advise reading about <a href=\"https://guides.rubyonrails.org/i18n.html\" rel=\"nofollow noreferrer\">internationalization in the Rails Guides</a>"}, {"owner": {"reputation": 3926, "user_id": 2190621, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4c464f439212bca87517b234f7c9bd3e?s=128&d=identicon&r=PG&f=1", "display_name": "demir", "link": "https://stackoverflow.com/users/2190621/demir"}, "edited": false, "score": 0, "creation_date": 1571125032, "post_id": 58388123, "comment_id": 103125732, "body": "Dif you check config/locales/ja.yml? You also need to restart the server."}, {"owner": {"reputation": 848, "user_id": 11249670, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f29532e75e13b5f3b631012229f22829?s=128&d=identicon&r=PG&f=1", "display_name": "reesaspieces", "link": "https://stackoverflow.com/users/11249670/reesaspieces"}, "edited": false, "score": 0, "creation_date": 1571126410, "post_id": 58388123, "comment_id": 103126438, "body": "Regarding: <i>&quot;Then you probably defined the translations to fallback to English and not to raise errors in that project.&quot;</i> I don&#39;t recall doing anything like that, and <code>config.i18n.fallbacks = true</code> is setup for both projects. But I will see if there&#39;s anything else that may be causing this difference."}, {"owner": {"reputation": 848, "user_id": 11249670, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f29532e75e13b5f3b631012229f22829?s=128&d=identicon&r=PG&f=1", "display_name": "reesaspieces", "link": "https://stackoverflow.com/users/11249670/reesaspieces"}, "reply_to_user": {"reputation": 3926, "user_id": 2190621, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4c464f439212bca87517b234f7c9bd3e?s=128&d=identicon&r=PG&f=1", "display_name": "demir", "link": "https://stackoverflow.com/users/2190621/demir"}, "edited": false, "score": 1, "creation_date": 1571126960, "post_id": 58388123, "comment_id": 103126688, "body": "@demir You&#39;re right! It was because someone else working on the project had defined errors&#39; formats to be this: <code>%{message}</code>. So the <code>attribute</code> part of the error had been omitted."}], "answers": [{"tags": [], "owner": {"reputation": 848, "user_id": 11249670, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f29532e75e13b5f3b631012229f22829?s=128&d=identicon&r=PG&f=1", "display_name": "reesaspieces", "link": "https://stackoverflow.com/users/11249670/reesaspieces"}, "is_accepted": true, "score": 0, "last_activity_date": 1578388091, "creation_date": 1578388091, "answer_id": 59625226, "question_id": 58388123, "link": "https://stackoverflow.com/questions/58388123/rails-i18n-gem-excludes-attribute-name-from-error-messages-for-non-english-local/59625226#59625226", "title": "Rails i18n gem excludes attribute name from error messages for non-English locale", "body": "<p>As @demir suspected, it was because of configuration done to amend the format of error messages. This caused the <code>attribute</code> part to be omitted from error messages.</p>\n\n<pre><code># Original format\nformat: \"%{attribute} %{message}\"\n\n# Configured format\nformat: \"%{message}\"\n</code></pre>\n"}], "owner": {"reputation": 848, "user_id": 11249670, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f29532e75e13b5f3b631012229f22829?s=128&d=identicon&r=PG&f=1", "display_name": "reesaspieces", "link": "https://stackoverflow.com/users/11249670/reesaspieces"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 475, "favorite_count": 0, "accepted_answer_id": 59625226, "answer_count": 1, "score": 0, "last_activity_date": 1578388091, "creation_date": 1571119303, "question_id": 58388123, "link": "https://stackoverflow.com/questions/58388123/rails-i18n-gem-excludes-attribute-name-from-error-messages-for-non-english-local", "title": "Rails i18n gem excludes attribute name from error messages for non-English locale", "body": "<p>The Rails app I am working on uses the Japanese locale.\nIn order to use default translations for error messages, I installed the <a href=\"https://github.com/svenfuchs/rails-i18n\" rel=\"nofollow noreferrer\"><code>rails-i18n</code></a> gem, but I am having trouble getting it to display full error messages.</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code># Locale configuration in application.rb\nconfig.i18n.default_locale = :ja\n</code></pre>\n\n<p>Before installing this gem, the error messages for validation errors told me that the translation is missing, as expected.</p>\n\n<pre><code>*** ActiveRecord::RecordInvalid Exception: translation missing: ja.activerecord.errors.messages.record_invalid\n</code></pre>\n\n<p>However, even after installing the gem, the Japanese translation for the same message does not include the attribute whose validation failed. The blank space after the final colon is supposed to be the attribute name.</p>\n\n<pre><code>*** ActiveRecord::RecordInvalid Exception: \u30d0\u30ea\u30c7\u30fc\u30b7\u30e7\u30f3\u306b\u5931\u6557\u3057\u307e\u3057\u305f: \u3092\u5165\u529b\u3057\u3066\u304f\u3060\u3055\u3044\n</code></pre>\n\n<p>To illustrate, this is what the error message looks like with the locale set to <code>:en</code>. In Japanese, it's as if the column name <code>First name</code> is missing, so the error message reads <code>&lt;No subject&gt; can't be blank</code>.</p>\n\n<pre><code>*** ActiveRecord::RecordInvalid Exception: Validation failed: First name can't be blank\n</code></pre>\n\n<p>What am I missing here? Do I need some additional configuration?\nThank you for any help in advance.</p>\n\n<hr>\n\n<p>Note: I use rails 6.0.0.</p>\n"}, {"tags": ["sql", "ruby-on-rails", "ruby", "database"], "comments": [{"owner": {"reputation": 6462, "user_id": 3784008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/55ou4.jpg?s=128&g=1", "display_name": "anothermh", "link": "https://stackoverflow.com/users/3784008/anothermh"}, "edited": false, "score": 1, "creation_date": 1571121877, "post_id": 58386915, "comment_id": 103124138, "body": "You shouldn&#39;t mix camel case and snake case. Stick with snake case when working in Rails; it&#39;ll make your life a lot easier."}, {"owner": {"reputation": 1217, "user_id": 10430642, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/p5jzL.jpg?s=128&g=1", "display_name": "Dimitrius Lachi", "link": "https://stackoverflow.com/users/10430642/dimitrius-lachi"}, "edited": false, "score": 0, "creation_date": 1571147020, "post_id": 58386915, "comment_id": 103137828, "body": "Can you post full code from the <code>Work Client Author</code> classes?"}, {"owner": {"reputation": 61, "user_id": 9267899, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/32d2eeca4b103ef0dad994d5e7e1b5e4?s=128&d=identicon&r=PG&f=1", "display_name": "Mattia", "link": "https://stackoverflow.com/users/9267899/mattia"}, "reply_to_user": {"reputation": 6462, "user_id": 3784008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/55ou4.jpg?s=128&g=1", "display_name": "anothermh", "link": "https://stackoverflow.com/users/3784008/anothermh"}, "edited": false, "score": 0, "creation_date": 1571154748, "post_id": 58386915, "comment_id": 103142426, "body": "@anothermh thanks for the advice, I&#39;ll follow that."}, {"owner": {"reputation": 61, "user_id": 9267899, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/32d2eeca4b103ef0dad994d5e7e1b5e4?s=128&d=identicon&r=PG&f=1", "display_name": "Mattia", "link": "https://stackoverflow.com/users/9267899/mattia"}, "reply_to_user": {"reputation": 1217, "user_id": 10430642, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/p5jzL.jpg?s=128&g=1", "display_name": "Dimitrius Lachi", "link": "https://stackoverflow.com/users/10430642/dimitrius-lachi"}, "edited": false, "score": 0, "creation_date": 1571154751, "post_id": 58386915, "comment_id": 103142428, "body": "@DimitriusLachi these are the whole models for each of them, there&#39;s nothing else inside, it&#39;s a really simple app (plus I want to make sure all the relationships work without problem before adding anything else)"}], "answers": [{"tags": [], "owner": {"reputation": 61, "user_id": 9267899, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/32d2eeca4b103ef0dad994d5e7e1b5e4?s=128&d=identicon&r=PG&f=1", "display_name": "Mattia", "link": "https://stackoverflow.com/users/9267899/mattia"}, "is_accepted": false, "score": 0, "last_activity_date": 1571180410, "creation_date": 1571180410, "answer_id": 58403607, "question_id": 58386915, "link": "https://stackoverflow.com/questions/58386915/rails-saving-in-a-table-and-update-creating-in-another-one/58403607#58403607", "title": "Rails - Saving in a table and update/creating in another one", "body": "<p>After dozens of tests I eventually came up with a sort of solution - it's not \"elegant\" and probably it's not the best, but at least it works without interruptions:</p>\n\n<pre><code> def edit\n    @work = Work.find(params[:id])\n\n    if @work.client.nil?\n      @work.build_client\n    end \n\n    if @work.author.nil?\n      @work.build_author\n    end\n\n  end\n\n  def update\n    @work = Work.find(params[:id])\n\n    @work.client = Client.where(clientName: work_params[\"client_attributes\"][\"clientName\"]).first_or_create\n    @work.author = Author.where(authorName: work_params[\"author_attributes\"][\"authorName\"]).first_or_create\n\n    if @work.update(update_params) \n      flash[:notice] = \"work: #{@work.title} updated successfully.\"\n      redirect_to(project_path(@work))\n    else\n      redirect_to new_project_path\n    end\n\n  end\n\nprivate\n\n    def work_params\n      params.require(:work).permit(:title, :date, client_attributes: [:id, :clientName], author_attributes: [:id, :authorName])\n    end\n\n    def update_params\n      params.require(:work).permit(:title, :date)\n    end\n</code></pre>\n\n<p>Being that <code>first_or_initialize</code> works smoothly with <code>save</code> method, but it gets stuck - at least in my code - with <code>update</code>, I replaced it with <code>first_or_create</code>. </p>\n\n<p>This time, however, I am using another private method <code>update_params</code> which simply ignores <code>:client_attributes</code> and <code>:authors_attributes</code>.</p>\n\n<p>This results in an <code>Unpermitted parameters: :author_attributes, :client_attributes</code> error, as expected, but at least everything goes through and gets updated.</p>\n\n<p>Honestly I am not quite sure that I totally understood why it's working. But it does.</p>\n\n<p>Anyway, if anyone have a better solution to this problem I am totally open to improve it.</p>\n"}], "owner": {"reputation": 61, "user_id": 9267899, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/32d2eeca4b103ef0dad994d5e7e1b5e4?s=128&d=identicon&r=PG&f=1", "display_name": "Mattia", "link": "https://stackoverflow.com/users/9267899/mattia"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 71, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1571180410, "creation_date": 1571110808, "last_edit_date": 1571156092, "question_id": 58386915, "link": "https://stackoverflow.com/questions/58386915/rails-saving-in-a-table-and-update-creating-in-another-one", "title": "Rails - Saving in a table and update/creating in another one", "body": "<p>I am creating a small app to manage my own online portfolio but I can't solve an issue with <code>update</code>.</p>\n\n<p>The main table of my database is <code>works</code>, then there's the tables <code>authors</code> and <code>clients</code> where I set the fields <code>authorName</code> and <code>clientName</code> as <code>unique</code>. Authors and clients can have multiple works, but a work can only have one of each.</p>\n\n<p>In the form where I create works I have a field for the <code>authorName</code> and another one for <code>clientName</code>: if the author doesn't exist in the authors table it gets created, otherwise the existing one gets linked to the work. Same thing with the client. To achieve this I am using <code>first_or_initialize</code> and it works perfectly. Problems start when I try to use the same method inside the <code>update</code> action. These are my models:</p>\n\n<p><strong>Work Model</strong></p>\n\n<pre><code> class Work &lt; ApplicationRecord\n\n    has_one :description\n\n    belongs_to :author\n    belongs_to :client\n\n    accepts_nested_attributes_for :client\n    accepts_nested_attributes_for :author\n\n    scope :active, lambda {where(:isActive =&gt; true)}\n    scope :descOrder, lambda {order(:date =&gt; :desc)}\n    scope :cover, lambda {where(:isCover =&gt; true)}\n\nend \n</code></pre>\n\n<p><strong>Author Model</strong></p>\n\n<pre><code>class Author &lt; ApplicationRecord\n\n    has_many :works\n\nend\n</code></pre>\n\n<p><strong>Client Model</strong></p>\n\n<pre><code>class Client &lt; ApplicationRecord\n\n    has_many :works\n\nend\n</code></pre>\n\n<p><em>Quick edit: the models as you see them are exactly as they are in my app. No code has been removed.</em></p>\n\n<p>This is the form in my view:</p>\n\n<pre><code>&lt;%= form_for(@work, :url =&gt; { :controller =&gt; \"projects\", :action =&gt; \"update\"} ) do |f| %&gt;\n    &lt;%= f.label(\"title\") %&gt;\n    &lt;%= f.text_field(:title) %&gt;\n\n    &lt;%= f.fields_for(:author) do |author| %&gt;\n        &lt;%= author.label(\"author\") %&gt;\n        &lt;%= author.text_field(:authorName) %&gt;\n    &lt;% end %&gt;\n\n    &lt;%= f.fields_for(:client) do |client| %&gt;\n        &lt;%= client.label(\"client\") %&gt;\n        &lt;%= client.text_field(:clientName) %&gt;\n    &lt;% end %&gt;\n\n    &lt;%= f.label(\"date\") %&gt;\n    &lt;%= f.date_field(:date) %&gt;\n\n\n    &lt;%= f.submit(\"update\") %&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>And this is how I am handling it in the controller:</p>\n\n<pre><code>def edit\n  @work = Work.find(params[:id])\n\n  if @work.client.nil?\n    @work.build_client\n  end\n\n  if @work.author.nil?\n    @work.build_author\n  end\nend\n\ndef update\n  @work = Work.find(params[:id])\n\n  @work.client = Client.where(clientName: work_params[\"client_attributes\"][\"clientName\"]).first_or_initialize\n  @work.author = Author.where(authorName: work_params[\"author_attributes\"][\"authorName\"]).first_or_initialize\n\n  if @work.update(work_params)\n    flash[:notice] = \"work: #{@work.title} updated successfully.\"\n    redirect_to(project_path(@work))\n  else\n    redirect_to new_project_path\n  end\nend\n\nprivate\n\ndef work_params\n  params.require(:work).permit(:title, :date, client_attributes: [:id, :clientName], author_attributes: [:id, :authorName])\nend\n</code></pre>\n\n<p>This is the error that I get:</p>\n\n<pre><code>Started PATCH \"/projects/21\" for ::1 at 2019-10-14 20:00:27 -0700\nProcessing by ProjectsController#update as HTML\n  Parameters: {\"authenticity_token\"=&gt;\"rw3X7VJg8CDnOibniv1jKHTVTGp7pjE4ep6xHpHy0Zp8Xv/0uQd6y5xqq629M2FOOQNoYyOAXH//w5/VoeNEOA==\", \"work\"=&gt;{\"title\"=&gt;\"Progetto1\", \"author_attributes\"=&gt;{\"authorName\"=&gt;\"Autore1\", \"id\"=&gt;\"34\"}, \"client_attributes\"=&gt;{\"clientName\"=&gt;\"Cliente4\", \"id\"=&gt;\"30\"}, \"date\"=&gt;\"\"}, \"commit\"=&gt;\"update\", \"id\"=&gt;\"21\"}\n  Work Load (0.7ms)  SELECT `works`.* FROM `works` WHERE `works`.`id` = 21 LIMIT 1\n  \u21b3 app/controllers/projects_controller.rb:42:in `update'\n  Client Load (0.6ms)  SELECT `clients`.* FROM `clients` WHERE `clients`.`clientName` = 'Cliente4' ORDER BY `clients`.`id` ASC LIMIT 1\n  \u21b3 app/controllers/projects_controller.rb:44:in `update'\n  Author Load (0.6ms)  SELECT `authors`.* FROM `authors` WHERE `authors`.`authorName` = 'Autore1' ORDER BY `authors`.`id` ASC LIMIT 1\n  \u21b3 app/controllers/projects_controller.rb:45:in `update'\nCompleted 404 Not Found in 15ms (ActiveRecord: 1.9ms | Allocations: 3805)\n\n\n\nActiveRecord::RecordNotFound (Couldn't find Client with ID=30 for Work with ID=21):\n\napp/controllers/projects_controller.rb:47:in `update'\n</code></pre>\n\n<p>Even though those record <strong>do</strong> exist in the database (with those IDs that you see in the error) and their foreign keys are correctly stored in the <code>works</code> table (I checked in mysql).</p>\n\n<p>What I am expecting to achieve is the same behaviour of the <code>new</code> action (that I described in the beginning of my post).</p>\n\n<p>How can I solve this? Thank you!</p>\n\n<hr>\n\n<p><em>Small update</em>: if I change <code>first_or_initialize</code> with <code>first_or_create</code> it does create the author (or client), if not existing, but in the same time it still gives me the same error.</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 2007, "user_id": 716039, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/76b302eed6a8add5db6b3f2e1c7c9942?s=128&d=identicon&r=PG", "display_name": "dinjas", "link": "https://stackoverflow.com/users/716039/dinjas"}, "edited": false, "score": 0, "creation_date": 1571107834, "post_id": 58386397, "comment_id": 103120395, "body": "Did you <code>require &#39;concurrent&#39;</code>?"}, {"owner": {"reputation": 5580, "user_id": 490454, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/RqygM.jpg?s=128&g=1", "display_name": "BobRodes", "link": "https://stackoverflow.com/users/490454/bobrodes"}, "reply_to_user": {"reputation": 2007, "user_id": 716039, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/76b302eed6a8add5db6b3f2e1c7c9942?s=128&d=identicon&r=PG", "display_name": "dinjas", "link": "https://stackoverflow.com/users/716039/dinjas"}, "edited": false, "score": 0, "creation_date": 1571108356, "post_id": 58386397, "comment_id": 103120508, "body": "@dinjas Would have gotten an error if not."}, {"owner": {"reputation": 2034, "user_id": 2695642, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/95dOY.png?s=128&g=1", "display_name": "TangMonk", "link": "https://stackoverflow.com/users/2695642/tangmonk"}, "reply_to_user": {"reputation": 2007, "user_id": 716039, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/76b302eed6a8add5db6b3f2e1c7c9942?s=128&d=identicon&r=PG", "display_name": "dinjas", "link": "https://stackoverflow.com/users/716039/dinjas"}, "edited": false, "score": 0, "creation_date": 1571109396, "post_id": 58386397, "comment_id": 103120747, "body": "@dinjas, absolutely"}, {"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 1, "creation_date": 1571126792, "post_id": 58386397, "comment_id": 103126595, "body": "I don&#39;t know how <code>Concurrent::Async</code> works, but just by looking at the code, I see that you fire off an asynchronous method and then <i>immediately exit</i> the script. This is an obvious race condition where the thread that runs the asynchronous method races against the main thread that shuts down the interpreter, thus killing all threads."}], "answers": [{"tags": [], "owner": {"reputation": 2291, "user_id": 1752333, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1009edfa56c5a71d0e6de2738342bee7?s=128&d=identicon&r=PG", "display_name": "scorix", "link": "https://stackoverflow.com/users/1752333/scorix"}, "is_accepted": true, "score": 1, "last_activity_date": 1571207568, "creation_date": 1571207568, "answer_id": 58407060, "question_id": 58386397, "link": "https://stackoverflow.com/questions/58386397/why-concurrent-ruby-exit-immediately/58407060#58407060", "title": "Why concurrent-ruby exit immediately", "body": "<pre><code>require 'concurrent'\n\nclass Echo\n  include Concurrent::Async\n\n  def echo(msg)\n    p msg\n  end\nend\n\nhorn = Echo.new\n\n# t is an instance of Concurrent::IVar which includes Concurrent::Concern::Obligation\nt = horn.async.echo('one')\n\n# wait until obligation is complete or the timeout has been reached\nt.wait! \n</code></pre>\n\n<p><a href=\"https://github.com/ruby-concurrency/concurrent-ruby/blob/master/lib/concurrent/concern/obligation.rb\" rel=\"nofollow noreferrer\">souce code</a></p>\n"}], "owner": {"reputation": 2034, "user_id": 2695642, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/95dOY.png?s=128&g=1", "display_name": "TangMonk", "link": "https://stackoverflow.com/users/2695642/tangmonk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 63, "favorite_count": 0, "accepted_answer_id": 58407060, "answer_count": 1, "score": 0, "last_activity_date": 1571207568, "creation_date": 1571106469, "last_edit_date": 1571109302, "question_id": 58386397, "link": "https://stackoverflow.com/questions/58386397/why-concurrent-ruby-exit-immediately", "title": "Why concurrent-ruby exit immediately", "body": "<p>I am try to use <a href=\"https://github.com/ruby-concurrency/concurrent-ruby\" rel=\"nofollow noreferrer\">concurrent-ruby</a> to do some parallel tasks, I am following doc and using <code>Concurrent::Async</code>:</p>\n\n<pre><code>require 'concurrent'\n\nclass Echo\n  include Concurrent::Async\n\n  def echo(msg)\n    p msg\n  end\nend\n\nhorn = Echo.new\nhorn.async.echo('one')\n</code></pre>\n\n<p>and run it in terminal , but process is print nothing, and exit immediately</p>\n"}, {"tags": ["ruby", "activerecord"], "comments": [{"owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 0, "creation_date": 1571105393, "post_id": 58386221, "comment_id": 103119899, "body": "I&#39;m pretty sure even the second approach callls <code>find</code> under the hood. See <a href=\"https://edgeguides.rubyonrails.org/active_job_basics.html#globalid\" rel=\"nofollow noreferrer\">edgeguides.rubyonrails.org/active_job_basics.html#globalid</a> also the Serializers section. Also see <a href=\"https://stackoverflow.com/questions/32015598/activejob-globalid-and-in-memory-activerecord-objects\" title=\"activejob globalid and in memory activerecord objects\">stackoverflow.com/questions/32015598/&hellip;</a> . Personally I think the <code>find</code> in the job is unnecessary so I would prefer to use the Serializer system or just serialize the arguments to hash yourselff by some other means."}, {"owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 0, "creation_date": 1571105460, "post_id": 58386221, "comment_id": 103119918, "body": "This also deals with an edge case where the record was deleted before the job ran"}, {"owner": {"reputation": 24560, "user_id": 4880924, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/d40e83be235d4f70428da0d42e12d427?s=128&d=identicon&r=PG&f=1", "display_name": "BKSpurgeon", "link": "https://stackoverflow.com/users/4880924/bkspurgeon"}, "edited": false, "score": 0, "creation_date": 1571105492, "post_id": 58386221, "comment_id": 103119926, "body": "You gotta run numbers on this thing: benchmark and then optimise only the bottle necks. Nothing beats solid numbers."}, {"owner": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "edited": false, "score": 1, "creation_date": 1571118751, "post_id": 58386221, "comment_id": 103122931, "body": "If working with Sidekiq, pass always the values, not the whole object, <a href=\"https://github.com/mperham/sidekiq/wiki/Best-Practices#1-make-your-job-parameters-small-and-simple\" rel=\"nofollow noreferrer\">see</a>."}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 1, "creation_date": 1571127102, "post_id": 58386221, "comment_id": 103126761, "body": "Option 2 implies that you already have the object on the caller&#39;s side. Why would you want to fetch the record again from the database? Unless of course you&#39;re implementing Sidekiq&#39;s <code>perform</code> method \u2013 that is supposed to take simple identifiers because of the de/serialization."}], "owner": {"reputation": 4855, "user_id": 3618156, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/b3e1907a7f15ed006abc8ad406cf40fe?s=128&d=identicon&r=PG&f=1", "display_name": "american-ninja-warrior", "link": "https://stackoverflow.com/users/3618156/american-ninja-warrior"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 41, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1571126796, "creation_date": 1571104841, "last_edit_date": 1571126796, "question_id": 58386221, "link": "https://stackoverflow.com/questions/58386221/ruby-is-it-better-to-pass-the-numeric-id-of-an-active-record-object-or-the-obj", "title": "ruby: Is it better to pass the numeric id of an active record object, or the object itself?", "body": "<p>My application has long suffered from memory leaks. It's work is mostly long running sidekiq work.</p>\n\n<p>Today I'm adding a method, and I'm wondering what's best way to do it, considering memory efficiency is the #1 priority:</p>\n\n<pre><code># option 1\ndef func1(product_id)\n  product = Product.find(product_id)\n  # do something with product\nend\n\n# option 2\ndef func1(product)\n  # do something with product\nend\n</code></pre>\n\n<p>Which one is best? option 1 passed only integer, and the method does an active record find() call to work the object.</p>\n\n<p>Option 2 gets the object itself, so the method doesn't have to\nfind() the object.</p>\n\n<p>The method runs several million times per day btw.</p>\n"}, {"tags": ["regex", "ruby", "regex-group"], "answers": [{"comments": [{"owner": {"reputation": 760, "user_id": 2522723, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/d2b968f0d5e83d8f5207d28e0d70c761?s=128&d=identicon&r=PG", "display_name": "Andrew", "link": "https://stackoverflow.com/users/2522723/andrew"}, "edited": false, "score": 0, "creation_date": 1571103077, "post_id": 58386021, "comment_id": 103119557, "body": "Sorry that was dumb. I don&#39;t know why I couldn&#39;t figure that out. Thank you"}], "tags": [], "owner": {"reputation": 13635, "user_id": 1061413, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/0beb915463288cb6e8b50e8121860717?s=128&d=identicon&r=PG", "display_name": "Amit Kumar Gupta", "link": "https://stackoverflow.com/users/1061413/amit-kumar-gupta"}, "is_accepted": true, "score": 3, "last_activity_date": 1571102853, "creation_date": 1571102853, "answer_id": 58386021, "question_id": 58385972, "link": "https://stackoverflow.com/questions/58385972/match-long-group-of-characters-until-multiple-consecutive-whitespaces-ruby-regex/58386021#58386021", "title": "Match long group of characters until multiple consecutive whitespaces ruby regex", "body": "<p>Split the string where the split delimiter should be a pattern matching 2 or more whitespaces:</p>\n\n<pre><code>&gt; \"ICE - Oct '19 v'19 I                      Bid            Offer\".split(/\\s{2,}/)\n=&gt; [\"ICE - Oct '19 v'19 I\", \"Bid\", \"Offer\"]\n</code></pre>\n"}], "owner": {"reputation": 760, "user_id": 2522723, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/d2b968f0d5e83d8f5207d28e0d70c761?s=128&d=identicon&r=PG", "display_name": "Andrew", "link": "https://stackoverflow.com/users/2522723/andrew"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 52, "favorite_count": 0, "accepted_answer_id": 58386021, "answer_count": 1, "score": 0, "last_activity_date": 1571102853, "creation_date": 1571102402, "last_edit_date": 1571102601, "question_id": 58385972, "link": "https://stackoverflow.com/questions/58385972/match-long-group-of-characters-until-multiple-consecutive-whitespaces-ruby-regex", "title": "Match long group of characters until multiple consecutive whitespaces ruby regex", "body": "<p>I've searched high and low and tried a million combos on rubular and still cannot get this to work. Apologies in advance.</p>\n\n<p>I have the string</p>\n\n<pre><code>ICE - Oct '19 v'19 I                      Bid            Offer        \n</code></pre>\n\n<p>Any I want to write a regex to group this into chunks of text where a chunk can have any combination of the characters <code>[\\w\\d-']</code> and any number of whitespaces as long as they are not consecutive. I want the grouping to terminate as soon as there is more than one white space.</p>\n\n<p>The ouput would be </p>\n\n<p><code>[\"ICE - Oct '19 v'19 I\", \"Bid\", \"Offer\"]</code></p>\n\n<p>Another option is to say that I want to capture everything, but start a new grouping as soon as there are two consecutive whitespaces.</p>\n\n<p>So the output here would be \n<code>[\"ICE - Oct '19 v'19 I\", \"                      Bid\", \"         Offer\"]</code></p>\n\n<p>and then I could stip this\nSolutions using split are opposed to match will work.</p>\n\n<p>Right now I'm trying something along the lines of \n<code>^[\\s*\\w\\-\\']+</code> which doesn't work because I don't know how to specify that everything besides the white space can be <code>+</code> but that whitespace is acceptable but only a single one.</p>\n\n<p>Thanks</p>\n"}, {"tags": ["ruby", "libgosu"], "comments": [{"owner": {"reputation": 689, "user_id": 10280525, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ar3KN.jpg?s=128&g=1", "display_name": "Nifriz", "link": "https://stackoverflow.com/users/10280525/nifriz"}, "edited": false, "score": 1, "creation_date": 1571133062, "post_id": 58385630, "comment_id": 103129996, "body": "An advice... use <code>Math:PI</code> instead of <code>3.14159265358979323846264338327950289</code>"}], "answers": [{"tags": [], "owner": {"reputation": 46, "user_id": 9754794, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fHYix.jpg?s=128&g=1", "display_name": "action", "link": "https://stackoverflow.com/users/9754794/action"}, "is_accepted": true, "score": 3, "last_activity_date": 1571105887, "creation_date": 1571105887, "answer_id": 58386329, "question_id": 58385630, "link": "https://stackoverflow.com/questions/58385630/error-in-my-program-there-is-no-rendering-queue-for-this-operation/58386329#58386329", "title": "Error in my program!!!! There is no rendering queue for this operation", "body": "<p>Your <code>Destroy#update</code> method calls <code>Player#fire</code> which calls <code>Bullet#draw</code> which calls <code>Gosu::Image#draw_rot</code>. You can't call draw methods from within the main <code>update</code> method.</p>\n\n<p>You will have to move your <code>@bullet.draw</code> method call out from <code>Player#fire</code> (which gets called during main <code>update</code>) and into <code>Player#draw</code> (which gets called during main <code>draw</code>)</p>\n"}], "owner": {"reputation": 13, "user_id": 12217397, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/z6ZTe.jpg?s=128&g=1", "display_name": "oof baroomf", "link": "https://stackoverflow.com/users/12217397/oof-baroomf"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 589, "favorite_count": 0, "accepted_answer_id": 58386329, "answer_count": 1, "score": 1, "last_activity_date": 1571151251, "creation_date": 1571099218, "last_edit_date": 1571151251, "question_id": 58385630, "link": "https://stackoverflow.com/questions/58385630/error-in-my-program-there-is-no-rendering-queue-for-this-operation", "title": "Error in my program!!!! There is no rendering queue for this operation", "body": "<p>I'm creating a game with ruby and gosu, and I get an error:</p>\n\n<blockquote>\n  <p>C:/Ruby26-x64/destroy!/bullet.rb:14:in <code>draw_rot': There is no rendering queue for this operation (RuntimeError)\n      from C:/Ruby26-x64/destroy!/bullet.rb:14:in</code>draw'\n      from C:/Ruby26-x64/destroy!/player.rb:45:in <code>fire'\n      from C:/Ruby26-x64/destroy!/destroy.rb:36:in</code>update'\n      from C:/Ruby26-x64/lib/ruby/gems/2.6.0/gems/gosu-0.14.5-x64-mingw32/lib/gosu/patches.rb:72:in <code>tick'\n      from C:/Ruby26-x64/lib/ruby/gems/2.6.0/gems/gosu-0.14.5-x64-mingw32/lib/gosu/patches.rb:72:in</code>tick'\n      from C:/Ruby26-x64/destroy!/destroy.rb:40:in `'\n  [Finished in 0.517s]</p>\n</blockquote>\n\n<p>I've tried to change draw in the bullet class to draw_rot, but no avail.</p>\n\n<p><strong>My Classes</strong></p>\n\n<p><strong>Destroy</strong></p>\n\n<pre><code>require 'gosu'\nrequire 'cmath'\nrequire_relative 'player.rb'\nrequire_relative 'enemy.rb'\nrequire_relative 'bullet.rb'\nclass Destroy &lt; Gosu::Window\n  def initialize\n    super(800, 600)\n    self.caption = 'Destroy!'\n    @player = Player.new(self)\n    @enemies = []\n    @enemies.push(Enemy.new(self))\n  end\n\n  def draw\n    @player.draw\n    @enemies.each do |enemy|\n      enemy.draw\n    end\n  end\n\n  def update\n    @player.righturn if button_down?(Gosu::KbRight)\n    @player.lefturn if button_down?(Gosu::KbLeft)\n    @player.startmove\n    @player.move if button_down?(Gosu::KbUp)\n    @freq = 0.0025\n    if rand &lt; @freq\n      @enemies.push(Enemy.new(self))\n    end\n    @enemies.each do |enemy|\n      enemy.move\n      enemy.update(@player.x, @player.y)\n    end\n    if @freq &lt; 0.5\n      @freq += 0.0002\n    end\n    @player.fire(self)\n  end\nend\nwindow = Destroy.new\nwindow.show\n</code></pre>\n\n<p><strong>Bullet</strong></p>\n\n<pre><code>class Bullet\n  attr_accessor :x\n  attr_accessor :y\n  attr_accessor :fired\n\n  def initialize(window)\n    @image = Gosu::Image.new('C:\\Ruby26-x64\\destroy!\\images\\bullet.png')\n    @fired = 0\n    @x = 0\n    @y = 0\n  end\n\n  def draw(x, y)\n    @x = x\n    @y = y\n    @image.draw_rot(x, y, 1, 0)\n    @fired = 1\n  end\n\n  def update(angle)\n    @xspeed = Gosu.offset_x(angle, 2)\n    @yspeed = Gosu.offset_y(angle, 2)\n    if (@x &gt; 800 || @x &lt; 0 || @y &gt; 600 || @y &lt; 0)\n      @fired = 0\n    end\n  end\nend\n</code></pre>\n\n<p><strong>Player</strong></p>\n\n<pre><code>require_relative 'bullet.rb'\nrequire 'gosu'\nclass Player\n  attr_accessor :x\n  attr_accessor :y\n\n  def initialize(window)\n    @x = 200\n    @y = 200\n    @xspeed = 0\n    @yspeed = 0\n    @angle = 0\n    @image = Gosu::Image.new('C:/Ruby26-x64/destroy!/images/man.png')\n  end\n\n  def draw\n    @image.draw_rot(@x, @y, 1, @angle)\n  end\n\n  def righturn\n    @angle += 3\n  end\n\n  def lefturn\n    @angle -= 3\n  end\n\n  def startmove\n    @xspeed = Gosu.offset_x(@angle, 2)\n    @yspeed = Gosu.offset_y(@angle, 2)\n  end\n\n  def move\n    if @x &gt; 767\n      @xpeed = 0\n      @x = 767\n    end\n    if @x &lt; 33\n      @xpeed = 0\n      @x = 33\n    end\n    if @y &gt; 567\n      @yspeed = 0\n      @y = 567\n    end\n    @x += @xspeed\n    @y += @yspeed\n  end\n\n  def fire(window)\n    @bullet = Bullet.new(window)\n    @bullet.draw(@x, @y)\n    while @bullet.fired = 1\n      @bullet.update(@angle)\n    end\n  end\nend\n</code></pre>\n\n<p><strong>Enemy</strong></p>\n\n<pre><code>require 'cmath'\nclass Enemy\n  def initialize(window)\n    @flipped = 0\n    @x = rand(800 - 2 * 30) + 30\n    @y = rand(600 - 2 * 30) + 30\n    @firefreq = 1 / 60\n    @health = 5\n    @numkilled = 0\n    @dead = 0\n    @xspeed = 0\n    @yspeed = 0\n    @angle = 0\n    @image = Gosu::Image.new('C:/Ruby26-x64/destroy!/images/enemy.png')\n    @imageflipped = Gosu::Image.new('C:/Ruby26-x64/destroy!/images/enemyflip.png')\n  end\n\n  def gethit\n    @health -= 1\n  end\n\n  def die\n    @numkilled += 1\n    @dead = 1\n  end\n\n  def move\n    if rand &lt; 0.1\n      @xspeed = rand(-3..3)\n      @yspeed = rand(-3..3)\n    end\n    if @x + @xspeed &gt; 800\n      @x = 800\n    end\n    if @x + @xspeed &lt; 0\n      @x = 0\n    end\n    if @y + @yspeed &gt; 600\n      @y = 600\n    end\n    if @y + @yspeed &lt; 0\n      @y = 0\n    end\n    if !(@y + @yspeed &lt; 0 &amp;&amp; @y + @yspeed &gt; 600 &amp;&amp; @x + @xspeed &lt; 0 &amp;&amp; @x + @xspeed &gt; 800)\n      @y += @yspeed\n      @x += @xspeed\n    end\n  end\n\n  def draw\n    if @dead == 0\n      if @flipped == 1\n        @imageflipped.draw_rot(@x, @y, 1, @angle)\n      end\n      if @flipped == 0\n        @image.draw_rot(@x, @y, 1, @angle)\n      end\n    end\n  end\n\n  def update(xdist, ydist)\n    if @x &lt; xdist\n      (@angle = CMath.atan((ydist - @y) / (xdist - @x)) * 180 / 3.14159265358979323846264338327950289)\n      @flipped = 0\n    end\n    if @x &gt; xdist\n      (@angle = CMath.atan(-(ydist - @y) / (@x - xdist)) * 180 / 3.14159265358979323846264338327950289)\n      @flipped = 1\n    end\n  end\nend\n</code></pre>\n\n<p>I do not get this at all.</p>\n"}, {"tags": ["ruby", "cucumber", "bdd"], "comments": [{"owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 0, "creation_date": 1571095253, "post_id": 58385124, "comment_id": 103118219, "body": "Why don&#39;t you assign a var to the result of <code>CRUD.create</code>? Then try calling <code>parsed_response</code> on that"}, {"owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 0, "creation_date": 1571099041, "post_id": 58385124, "comment_id": 103118872, "body": "The real issue is that the instance vars you define in your method call aren&#39;t available in your tests. It&#39;s a different context."}, {"owner": {"reputation": 2151, "user_id": 10068463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c3df811097b7fb8fef67238aad1151ca?s=128&d=identicon&r=PG&f=1", "display_name": "Nate", "link": "https://stackoverflow.com/users/10068463/nate"}, "edited": false, "score": 0, "creation_date": 1571117183, "post_id": 58385124, "comment_id": 103122426, "body": "It seems like you need to read up on classes, instances, and instance variables. You\u2019re doing a lot of things that don\u2019t make sense. For example, you don\u2019t have access to <code>@request</code> outside of <code>CRUD</code>. While you can use instance variables in class methods, the way you\u2019re using them isn\u2019t benefiting you at all, and is not thread safe. And calling <code>create</code> over and over is inefficient, as it would perform your web request every time you do it \u2014 you should be caching the result. Your problems run much deeper than HTTParty."}, {"owner": {"reputation": 13, "user_id": 12217238, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mBJhM2hlduAOH9IQNjscb7FCwNrRGC5e539D6dcfA=k-s128", "display_name": "Silvio Aulik", "link": "https://stackoverflow.com/users/12217238/silvio-aulik"}, "edited": false, "score": 0, "creation_date": 1571182106, "post_id": 58385124, "comment_id": 103152578, "body": "OK Nate, if you want to teach me how you do instead of criticizing me I accept and thank you."}, {"owner": {"reputation": 13, "user_id": 12217238, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mBJhM2hlduAOH9IQNjscb7FCwNrRGC5e539D6dcfA=k-s128", "display_name": "Silvio Aulik", "link": "https://stackoverflow.com/users/12217238/silvio-aulik"}, "edited": false, "score": 0, "creation_date": 1571185105, "post_id": 58385124, "comment_id": 103153162, "body": "See that, i can to made that and make a sense!!    .  puts CRUD.class_variable_get(:@@request).parsed_response[&#39;data&#39;][&zwnj;&#8203;&#39;attributes&#39;][&#39;email&zwnj;&#8203;&#39;]"}], "answers": [{"tags": [], "owner": {"reputation": 13, "user_id": 12217238, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mBJhM2hlduAOH9IQNjscb7FCwNrRGC5e539D6dcfA=k-s128", "display_name": "Silvio Aulik", "link": "https://stackoverflow.com/users/12217238/silvio-aulik"}, "is_accepted": true, "score": 0, "last_activity_date": 1571181512, "creation_date": 1571181512, "answer_id": 58403733, "question_id": 58385124, "link": "https://stackoverflow.com/questions/58385124/im-having-a-problem-with-parsed-response-when-i-use-class-httparty/58403733#58403733", "title": "I&#39;m having a problem with parsed_response when I use class httparty", "body": "<pre><code>[OK, I made the adjustments and the test ran, but I have a problem now !. Why is the query email (get)is different from the inclusion email (post)?\n\nsee my class\n\nrequire 'HTTParty'\nrequire 'httparty/request'\nrequire 'httparty/response/headers'\n\n#require_relative '..features/pages/hooks/hook.rb'\n\nclass CRUD\n\n   include HTTParty\n\n   def create  \n\n  @base_url  = 'https://api-de-tarefas.herokuapp.com/users'\n    @body = \n    {\n    \"user\": {\n    \"email\": Faker::Internet.email,\n    \"password\":  :@password,\n    \"password_confirmation\": :@password\n\n     }    \n}.to_json\n\n@headers = {\n             \"Accept\": 'application/vnd.tasksmanager.v2',\n                      'Content-Type': 'application/json'\n}   \n\n  @request = CRUD.post(@base_url, body: @body, headers: @headers)\n end\n\n  def retrieve\n    @response  = CRUD.get('https://api-de-tarefas.herokuapp.com/contacts') \n end \nend\n\n\nSee my step_definitions\n\nDado(\"que eu tenha um payload padr\u00e3o\") do\n  @manter_user = CRUD.new\n end\n\nQuando(\"\u00e9 enviada uma requisi\u00e7\u00e3o para a cria\u00e7\u00e3o do usu\u00e1rio\") do\n   @manter_user.create\n    puts \"Requisi\u00e7\u00e3o com exito: #{@manter_user.create.message} para c\u00f3digo #{@manter_user.create.code}\" \n end\n\nEnt\u00e3o(\"s\u00e3o retornadas as informa\u00e7\u00f5es da inclus\u00e3o\") do\n   puts @manter_user.create.body\n   puts @manter_user.create.parsed_response\\['data'\\]\\['attributes'\\]\\['email'\\] \n end\n\n  Dado(\"que eu tenha o usu\u00e1rio cadastrado\") do \n    @manter_user = CRUD.new                                       \n    @manter_user.create\n    puts @manter_user.create.body\n\n  end                                                                                 \n\n  Quando(\"\u00e9 enviada uma requisi\u00e7\u00e3o de consulta\") do                                   \n    @manter_user.retrieve\n    puts \"Consulta processada com sucesso #{@manter_user.retrieve.code}\"\n  end                                                                                \n\n  Ent\u00e3o(\"a API me retorna a informa\u00e7\u00e3o do usu\u00e1rio\") do                                \n    puts @manter_user.create.parsed_response\\['data'\\]\\['attributes'\\]\\['email'\\] \n  end][1]  \n\nenter code here\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 12217238, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mBJhM2hlduAOH9IQNjscb7FCwNrRGC5e539D6dcfA=k-s128", "display_name": "Silvio Aulik", "link": "https://stackoverflow.com/users/12217238/silvio-aulik"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 50, "favorite_count": 0, "accepted_answer_id": 58403733, "answer_count": 1, "score": 0, "last_activity_date": 1571181512, "creation_date": 1571094527, "last_edit_date": 1571116667, "question_id": 58385124, "link": "https://stackoverflow.com/questions/58385124/im-having-a-problem-with-parsed-response-when-i-use-class-httparty", "title": "I&#39;m having a problem with parsed_response when I use class httparty", "body": "<p><img src=\"https://i.stack.imgur.com/F84Cm.jpg\" alt=\"enter image description here\"><br>\nI'm have a problem with class <code>httparty</code> </p>\n\n<pre><code> class CRUD\n\n       include HTTParty\n\n       def self.create   \n\n      @base_url  = 'https://api-de-tarefas.herokuapp.com/users'\n        @body = \n        {\n        \"user\": {\n        \"email\": Faker::Internet.email,\n        \"password\": :@password,\n        \"password_confirmation\": :@password\n         }    \n    }.to_json\n\n    @headers = {\n                 \"Accept\": 'application/vnd.tasksmanager.v2',\n                          'Content-Type': 'application/json'\n    }   \n\n      @request = HTTParty.post(@base_url, body: @body, headers: @headers)\n          end \n      end \n</code></pre>\n\n<p>My step_definitions         </p>\n\n<pre><code>When(\"\u00e9 enviada uma requisi\u00e7\u00e3o para a cria\u00e7\u00e3o do usu\u00e1rio\") do\n   CRUD.create\n    puts \"Requisi\u00e7\u00e3o com exito: #{CRUD.create.message} para c\u00f3digo #{CRUD.create.code}\" \n end\n\nthen(\"s\u00e3o retornadas as informa\u00e7\u00f5es da inclus\u00e3o\") do\n   puts CRUD.create.body\n   puts CRUD(@request.parsed_response['data']['attributes']['email'])\n end\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "date", "heroku"], "answers": [{"comments": [{"owner": {"reputation": 1369, "user_id": 481176, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/dc7f9d36ad6af05bc0de729eb5ca00d9?s=128&d=identicon&r=PG", "display_name": "BC00", "link": "https://stackoverflow.com/users/481176/bc00"}, "edited": false, "score": 0, "creation_date": 1571096379, "post_id": 58384886, "comment_id": 103118405, "body": "Thanks Mark, apologies if my question wasn&#39;t clear, I&#39;ll update the question, but I am referring more to if you have something say with an expired_at timestamp, and you want your designer to be able to easily fast forward to the state where it is expired, what would the best way to be able to do that?"}, {"owner": {"reputation": 1369, "user_id": 481176, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/dc7f9d36ad6af05bc0de729eb5ca00d9?s=128&d=identicon&r=PG", "display_name": "BC00", "link": "https://stackoverflow.com/users/481176/bc00"}, "edited": false, "score": 0, "creation_date": 1571097075, "post_id": 58384886, "comment_id": 103118526, "body": "no task is run the state of the object is just different and therefore impacts the application differently"}, {"owner": {"reputation": 1369, "user_id": 481176, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/dc7f9d36ad6af05bc0de729eb5ca00d9?s=128&d=identicon&r=PG", "display_name": "BC00", "link": "https://stackoverflow.com/users/481176/bc00"}, "edited": false, "score": 0, "creation_date": 1571155619, "post_id": 58384886, "comment_id": 103142868, "body": "agreed, but I guess what I am looking for is a way for non-devs to be able to emulate and test"}, {"owner": {"reputation": 2345, "user_id": 4988918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/x1BRI.png?s=128&g=1", "display_name": "Mark Merritt", "link": "https://stackoverflow.com/users/4988918/mark-merritt"}, "reply_to_user": {"reputation": 1369, "user_id": 481176, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/dc7f9d36ad6af05bc0de729eb5ca00d9?s=128&d=identicon&r=PG", "display_name": "BC00", "link": "https://stackoverflow.com/users/481176/bc00"}, "edited": false, "score": 0, "creation_date": 1571197346, "post_id": 58384886, "comment_id": 103155394, "body": "I&#39;m skeptical about how an object&#39;s state changes once the <code>expiration_date</code> is met without a task. If there is logic in the code that checks for this...it almost certainly belongs in a task instead. As @max suggested, creating a separate environment for non-devs to test against expired records would work."}], "tags": [], "owner": {"reputation": 2345, "user_id": 4988918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/x1BRI.png?s=128&g=1", "display_name": "Mark Merritt", "link": "https://stackoverflow.com/users/4988918/mark-merritt"}, "is_accepted": false, "score": 2, "last_activity_date": 1571092753, "creation_date": 1571092753, "answer_id": 58384886, "question_id": 58384734, "link": "https://stackoverflow.com/questions/58384734/rails-heroku-test-a-future-time/58384886#58384886", "title": "Rails/Heroku test a future time", "body": "<p>There is no way to test a production environment in the future. Even if there was, it wouldn't make sense to do so. All you should be concerned about is if it works right now. 2 high-level questions to ask are...</p>\n\n<ol>\n<li><p>Does it work in your development/test environments (in other words, is the logic correct?)</p></li>\n<li><p>Does your production service provide some type of task management and how reliable is it? </p></li>\n</ol>\n\n<p>Because you are using Heroku and did not specify the exact problem you are facing, lets just say you are using Heroku Scheduler, as an example. </p>\n\n<p>If your application logic is correct and you are able to run a task with <code>$ heroku run rails your_task</code>, then there is nothing left for you to test. You can be confident that it will work. Anything beyond that would be testing Heroku itself (or whatever production service you are using).  </p>\n"}, {"tags": [], "owner": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "is_accepted": false, "score": 0, "last_activity_date": 1571414511, "last_edit_date": 1571414511, "creation_date": 1571194797, "answer_id": 58405129, "question_id": 58384734, "link": "https://stackoverflow.com/questions/58384734/rails-heroku-test-a-future-time/58405129#58405129", "title": "Rails/Heroku test a future time", "body": "<p>You could write a piece of middleware that uses Timecop to modify the time on your staging environment:</p>\n\n<pre><code># /app/middlewares/time_traveler.rb\nclass TimeTraveler\n  def initialize(app)\n    @app = app\n  end\n\n  def call(env)\n    Timecop.travel(Time.local(2015, 10, 21, 12, 0, 0)) do\n      Rails.logger.info('Great Scott!')\n      @app.call(env)\n    end\n  end\nend\n</code></pre>\n\n<pre><code># /config/environments/staging.rb\nRails.application.configure do\n  # ...\n  config.middleware.use TimeTraveler\nend\n</code></pre>\n\n<p>This uses a fixed time but you could use input from the request (env.request) such as parameters, headers or cookies instead.</p>\n\n<p>However this only changes Rubys interpretation of time. And not:</p>\n\n<ul>\n<li>The databases concept of time. For example any code that uses the SQL <code>NOW()</code> function may break.</li>\n<li>System time. Any cron jobs or recurring tasks will stil be running on a different clock.</li>\n<li>Time in the client. Caches will be invalid. Things might break.</li>\n</ul>\n\n<p>I would not consider doing this on the actual production server to be a good idea. Instead setup a staging environment (a seperate Heroku app).</p>\n"}, {"tags": [], "owner": {"reputation": 712, "user_id": 929251, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69ef9fdd5a6cd663670253f5a73527a4?s=128&d=identicon&r=PG", "display_name": "Igor Kasyanchuk", "link": "https://stackoverflow.com/users/929251/igor-kasyanchuk"}, "is_accepted": false, "score": 0, "last_activity_date": 1610834492, "creation_date": 1610834492, "answer_id": 65755185, "question_id": 58384734, "link": "https://stackoverflow.com/questions/58384734/rails-heroku-test-a-future-time/65755185#65755185", "title": "Rails/Heroku test a future time", "body": "<p>I've created my own solution for this: <a href=\"https://github.com/igorkasyanchuk/rails_time_travel\" rel=\"nofollow noreferrer\">https://github.com/igorkasyanchuk/rails_time_travel</a></p>\n<p>This gem is using a timecop too, but it has a UI and you can select any datetime.</p>\n"}], "owner": {"reputation": 1369, "user_id": 481176, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/dc7f9d36ad6af05bc0de729eb5ca00d9?s=128&d=identicon&r=PG", "display_name": "BC00", "link": "https://stackoverflow.com/users/481176/bc00"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 102, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1610834492, "creation_date": 1571091547, "last_edit_date": 1571096503, "question_id": 58384734, "link": "https://stackoverflow.com/questions/58384734/rails-heroku-test-a-future-time", "title": "Rails/Heroku test a future time", "body": "<p>I have alot of features that rely on expiration dates and future times, we use timecop in our rspec/unit tests but I was wondering if anyone had any clever solutions for how a product/QA person could emulate some time in the future when they are testing a feature, like if it would be possible to start the heroku server based on an environment variable with some future time etc?</p>\n\n<p>An example would be you have a coupon, with an expires_at timestamp 3 days in the future, if I wanted my QA/product team to be able to quickly see that state, where its expired, is there a clever way to do that by tricking the server somehow? We could build tools to auto-adjust the records to expire at the current time etc. But when you start to have alot of features that have such future time based logic it becomes more unpleasant</p>\n"}, {"tags": ["ruby-on-rails", "arrays", "ruby"], "comments": [{"owner": {"reputation": 1810, "user_id": 1301840, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/ad9bbcb458c0923c2946f85b6b98107b?s=128&d=identicon&r=PG&f=1", "display_name": "lusketeer", "link": "https://stackoverflow.com/users/1301840/lusketeer"}, "edited": false, "score": 0, "creation_date": 1571091564, "post_id": 58384650, "comment_id": 103117399, "body": "what would the return be if there are more than 2 sub arrays?"}, {"owner": {"reputation": 341, "user_id": 647400, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/776b75bdfda413c9a5d8d3e9dfbd22fd?s=128&d=identicon&r=PG", "display_name": "bopritchard", "link": "https://stackoverflow.com/users/647400/bopritchard"}, "reply_to_user": {"reputation": 1810, "user_id": 1301840, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/ad9bbcb458c0923c2946f85b6b98107b?s=128&d=identicon&r=PG&f=1", "display_name": "lusketeer", "link": "https://stackoverflow.com/users/1301840/lusketeer"}, "edited": false, "score": 0, "creation_date": 1571091666, "post_id": 58384650, "comment_id": 103117421, "body": "@lusketeer even if there are 10 sub arrays, I still need the shared values across all 10"}, {"owner": {"reputation": 1810, "user_id": 1301840, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/ad9bbcb458c0923c2946f85b6b98107b?s=128&d=identicon&r=PG&f=1", "display_name": "lusketeer", "link": "https://stackoverflow.com/users/1301840/lusketeer"}, "edited": false, "score": 0, "creation_date": 1571091743, "post_id": 58384650, "comment_id": 103117439, "body": "so for <code>[[a, b], [b, c], [a, c]]</code> would return <code>[]</code>?"}, {"owner": {"reputation": 341, "user_id": 647400, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/776b75bdfda413c9a5d8d3e9dfbd22fd?s=128&d=identicon&r=PG", "display_name": "bopritchard", "link": "https://stackoverflow.com/users/647400/bopritchard"}, "reply_to_user": {"reputation": 1810, "user_id": 1301840, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/ad9bbcb458c0923c2946f85b6b98107b?s=128&d=identicon&r=PG&f=1", "display_name": "lusketeer", "link": "https://stackoverflow.com/users/1301840/lusketeer"}, "edited": false, "score": 0, "creation_date": 1571091816, "post_id": 58384650, "comment_id": 103117453, "body": "@lusketeer yes...but the way my data is configured, there will ALWAYS be a match"}, {"owner": {"reputation": 1810, "user_id": 1301840, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/ad9bbcb458c0923c2946f85b6b98107b?s=128&d=identicon&r=PG&f=1", "display_name": "lusketeer", "link": "https://stackoverflow.com/users/1301840/lusketeer"}, "edited": false, "score": 1, "creation_date": 1571091861, "post_id": 58384650, "comment_id": 103117466, "body": "okay, someone already posted what I wanted to post, should work for your case"}], "answers": [{"comments": [{"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 1, "creation_date": 1571126613, "post_id": 58384767, "comment_id": 103126533, "body": "Since <code>&amp;</code> has special meaning in Ruby&#39;s syntax, it might be worth noting that here <code>:&amp;</code> is merely a symbol referring to the operator method <a href=\"https://ruby-doc.org/core-2.6.5/Array.html#method-i-26\" rel=\"nofollow noreferrer\"><code>Array#&amp;</code></a>. So <code>[a, b, c].inject(:&amp;)</code> translates to <code>a &amp; b &amp; c</code>"}], "tags": [], "owner": {"reputation": 2251, "user_id": 9785060, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IUduC.png?s=128&g=1", "display_name": "Viktor", "link": "https://stackoverflow.com/users/9785060/viktor"}, "is_accepted": true, "score": 3, "last_activity_date": 1571131298, "last_edit_date": 1571131298, "creation_date": 1571091773, "answer_id": 58384767, "question_id": 58384650, "link": "https://stackoverflow.com/questions/58384650/find-values-that-each-subarray-of-an-array-contains/58384767#58384767", "title": "Find values that each subarray of an array contains", "body": "<p>You can combine <a href=\"https://ruby-doc.org/core-2.6.3/Enumerable.html#method-i-inject\" rel=\"nofollow noreferrer\">inject</a> with Array's <a href=\"https://ruby-doc.org/core-2.6.3/Array.html#method-i-26\" rel=\"nofollow noreferrer\">Set Intersection (<code>#&amp;</code>)</a> method like this</p>\n\n<pre><code>array.inject(:&amp;)\n</code></pre>\n\n<p>to get the desired result:</p>\n\n<pre><code>array=[[\"66892885\", \"66891801\", \"66924833\", \"66892255\", \"1\", \"33\"],\n       [\"65167829\", \"65167828\", \"66924833\", \"1\", \"33\", \"44\"], \n       [\"2344\", \"66924833\", \"1\", \"33\"]]\n\narray.inject(:&amp;)\n#=&gt;[\"66924833\", \"1\", \"33\"]\n</code></pre>\n"}], "owner": {"reputation": 341, "user_id": 647400, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/776b75bdfda413c9a5d8d3e9dfbd22fd?s=128&d=identicon&r=PG", "display_name": "bopritchard", "link": "https://stackoverflow.com/users/647400/bopritchard"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 90, "favorite_count": 0, "accepted_answer_id": 58384767, "answer_count": 1, "score": 2, "last_activity_date": 1571151380, "creation_date": 1571091002, "last_edit_date": 1571151380, "question_id": 58384650, "link": "https://stackoverflow.com/questions/58384650/find-values-that-each-subarray-of-an-array-contains", "title": "Find values that each subarray of an array contains", "body": "<p>I've got an <code>Array</code> of arrays. There can be two or more subarrays: </p>\n\n<pre><code>array = [\n  [\"66892885\", \"66891801\", \"66924833\", \"66892255\"],\n  [\"65167829\", \"65167828\", \"66924833\"],\n  [\"66924833\", \"66891801\"]\n]\n</code></pre>\n\n<p>I need only the values found across each subarray. So in this case <code>\"66924833\"</code> would be the only match. For a value to show up in the result, each subarray has to contain it.</p>\n\n<p>How can I do this?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "activerecord", "associations"], "answers": [{"comments": [{"owner": {"reputation": 509, "user_id": 7254473, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Fkwvm.jpg?s=128&g=1", "display_name": "Jonny B", "link": "https://stackoverflow.com/users/7254473/jonny-b"}, "edited": false, "score": 0, "creation_date": 1571145526, "post_id": 58384583, "comment_id": 103136879, "body": "You are amazing! Thanks!"}, {"owner": {"reputation": 2251, "user_id": 9785060, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IUduC.png?s=128&g=1", "display_name": "Viktor", "link": "https://stackoverflow.com/users/9785060/viktor"}, "reply_to_user": {"reputation": 509, "user_id": 7254473, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Fkwvm.jpg?s=128&g=1", "display_name": "Jonny B", "link": "https://stackoverflow.com/users/7254473/jonny-b"}, "edited": false, "score": 0, "creation_date": 1571146249, "post_id": 58384583, "comment_id": 103137331, "body": "Glad I could help :)"}], "tags": [], "owner": {"reputation": 2251, "user_id": 9785060, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IUduC.png?s=128&g=1", "display_name": "Viktor", "link": "https://stackoverflow.com/users/9785060/viktor"}, "is_accepted": true, "score": 1, "last_activity_date": 1571091356, "last_edit_date": 1571091356, "creation_date": 1571090534, "answer_id": 58384583, "question_id": 58384264, "link": "https://stackoverflow.com/questions/58384264/has-one-association-not-adding-methods-to-belongs-to-class/58384583#58384583", "title": "has_one association not adding methods to belongs_to class", "body": "<p>What you want is:</p>\n\n<pre><code>UserToken.where(user_id: 1).first.user\n</code></pre>\n\n<p>or better yet:</p>\n\n<pre><code>UserToken.find_by(user_id: 1).user\n</code></pre>\n\n<p>You're getting the \"undefined method\" error because <code>#where</code> returns an <code>ActiveRecord::Relation</code> and an ActiveRecord Relation has no <code>#user</code> method.</p>\n\n<pre><code>UserToken.where(user_id: 1).class.name\n#=&gt; \"ActiveRecord::Relation\"\nUserToken.where(user_id: 1).first.class.name\n#=&gt; \"UserToken\"\n</code></pre>\n"}], "owner": {"reputation": 509, "user_id": 7254473, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Fkwvm.jpg?s=128&g=1", "display_name": "Jonny B", "link": "https://stackoverflow.com/users/7254473/jonny-b"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 34, "favorite_count": 0, "accepted_answer_id": 58384583, "answer_count": 1, "score": 1, "last_activity_date": 1571105955, "creation_date": 1571088452, "last_edit_date": 1571105955, "question_id": 58384264, "link": "https://stackoverflow.com/questions/58384264/has-one-association-not-adding-methods-to-belongs-to-class", "title": "has_one association not adding methods to belongs_to class", "body": "<p>I have two tables User and UserToken. User <code>has_one: token</code> and UserToken <code>belongs_to :user</code>. I was under the impression this would add UserToken#User method to the UserToken class. However, I am getting:</p>\n\n<blockquote>\n  <p>undefined method 'user' for '#' with the\n  following 'UserToken.where(user_id: 1).user</p>\n</blockquote>\n\n<p>Do I not understand the association correctly or have I not set it up right?</p>\n\n<p>UsersController:</p>\n\n<pre><code>  def get\n    user = UserToken.where(user_id: 1).user\n\n    render json: user.to_json\n  end\n</code></pre>\n\n<p>User Model:</p>\n\n<pre><code>class User &lt; ApplicationRecord\n  has_one :user_token\nend\n</code></pre>\n\n<p>UserToken Model:</p>\n\n<pre><code>class UserToken &lt; ApplicationRecord\n  belongs_to :user\nend\n</code></pre>\n\n<p>Migration:</p>\n\n<pre><code>    def change\n        create_table :users do |t|\n      # This id comes from Auth0\n      t.datetime :date\n      t.timestamp :updated_at\n      t.timestamp :created_at\n    end\n\n    create_table :user_tokens do |t|\n      t.belongs_to :user\n      # This comes from plaid when a user signs in\n      t.string :token\n      t.timestamp :updated_at\n      t.timestamp :created_at\n    end\n  end\n</code></pre>\n\n<p>Schema:</p>\n\n<pre><code>ActiveRecord::Schema.define(version: 2019_09_19_004350) do\n\n  create_table \"user_tokens\", force: :cascade do |t|\n    t.bigint \"user_id\"\n    t.string \"token\"\n    t.datetime \"updated_at\"\n    t.datetime \"created_at\"\n    t.index [\"user_id\"], name: \"index_user_tokens_on_user_id\"\n  end\n\n  create_table \"users\", force: :cascade do |t|\n    t.datetime \"date\"\n    t.datetime \"updated_at\"\n    t.datetime \"created_at\"\n  end\nend\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "activerecord"], "comments": [{"owner": {"reputation": 795, "user_id": 3662748, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8acc15309c4109ea00f420a59be35a47?s=128&d=identicon&r=PG&f=1", "display_name": "sam", "link": "https://stackoverflow.com/users/3662748/sam"}, "edited": false, "score": 0, "creation_date": 1571089722, "post_id": 58383385, "comment_id": 103116939, "body": "Did you write your scripts using Active Record gem alone, or inside a Rails application?"}, {"owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 0, "creation_date": 1571091165, "post_id": 58383385, "comment_id": 103117286, "body": "I believer you can also pass a URL to establish_connetion. And you could define that URL in an env var"}, {"owner": {"reputation": 43, "user_id": 10415666, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-2G3aT6kx9Xk/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DVS5xA0z6q0_LZK2fUdsX4TbGWIEQ/mo/photo.jpg?sz=128", "display_name": "shawn bright", "link": "https://stackoverflow.com/users/10415666/shawn-bright"}, "edited": false, "score": 0, "creation_date": 1571091395, "post_id": 58383385, "comment_id": 103117346, "body": "i updated my questions. I am not using this in a rails application. only using the activerecord gem"}], "answers": [{"tags": [], "owner": {"reputation": 43, "user_id": 10415666, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-2G3aT6kx9Xk/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DVS5xA0z6q0_LZK2fUdsX4TbGWIEQ/mo/photo.jpg?sz=128", "display_name": "shawn bright", "link": "https://stackoverflow.com/users/10415666/shawn-bright"}, "is_accepted": false, "score": 0, "last_activity_date": 1571343533, "creation_date": 1571343533, "answer_id": 58440176, "question_id": 58383385, "link": "https://stackoverflow.com/questions/58383385/how-to-import-and-execute-database-connection-in-a-script/58440176#58440176", "title": "how to import and execute database connection in a script", "body": "<p>found my best answer here to be to just make a hash in another file with connection parameters, then pass that hash into the establish_connection</p>\n\n<p>so i have a file\ndb_params.rb</p>\n\n<pre><code>def params \n  return {\n    :adapter   =&gt; 'mysql',                                                                                                                                                                                                              \n    :host      =&gt; 'ip.address',                                                                                                                                                                                                         \n    :database  =&gt; 'test-db',                                                                                                                                                                                                            \n    :username  =&gt; 'userName',                                                                                                                                                                                                           \n    :password  =&gt; 'passWord'\n  }\nend\n</code></pre>\n\n<p>i require('db_params.rb')\nthen in the file I need to connect, i use..</p>\n\n<pre><code>p = params()\nActiveRecord::Base::establish_connection(p)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 40236, "user_id": 923315, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/j6lLI.jpg?s=128&g=1", "display_name": "peter", "link": "https://stackoverflow.com/users/923315/peter"}, "is_accepted": false, "score": 1, "last_activity_date": 1571344612, "creation_date": 1571344612, "answer_id": 58440396, "question_id": 58383385, "link": "https://stackoverflow.com/questions/58383385/how-to-import-and-execute-database-connection-in-a-script/58440396#58440396", "title": "how to import and execute database connection in a script", "body": "<p>The usual way is defining your connection and other data that could change is in a configuration file. In Ruby this means most of the times a YAML file.\nYou can define multiple environments (develop, production, ..) in your config so you won't have to change a thing when moving your code or you can have multiple configs.</p>\n\n<p>In your config.yaml file</p>\n\n<pre><code>connection:\n    adapter:  mysql\n    host:     xxx.xxx.xxx.xxx                                                                                                                                                                                                      \n    database: test-db                                                                                                                                                                                                            \n    username: userName                                                                                                                                                            \n    password: passWord\n</code></pre>\n\n<p>In your main, helpers or model file</p>\n\n<pre><code>$config = YAML::load_file(\"./config.yaml\")\nActiveRecord::Base.establish_connection($config.connection)\n</code></pre>\n"}], "owner": {"reputation": 43, "user_id": 10415666, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-2G3aT6kx9Xk/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DVS5xA0z6q0_LZK2fUdsX4TbGWIEQ/mo/photo.jpg?sz=128", "display_name": "shawn bright", "link": "https://stackoverflow.com/users/10415666/shawn-bright"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 58, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1571344612, "creation_date": 1571083402, "last_edit_date": 1571091334, "question_id": 58383385, "link": "https://stackoverflow.com/questions/58383385/how-to-import-and-execute-database-connection-in-a-script", "title": "how to import and execute database connection in a script", "body": "<p>I am writing many scripts to run housekeeping tasks on our system. At the top of each script, I establish a connection to the database using ActiveRecord::Base.connection. I would like to keep this bit in it's own file, so If I move to another server, i can change it in only one place, but I have not found a way to do this.</p>\n\n<pre><code>ActiveRecord::Base::establish_connection({                                                                                                                                                                                              \n    :adapter   =&gt; 'mysql',                                                                                                                                                                                                              \n    :host      =&gt; 'ip.address',                                                                                                                                                                                                         \n    :database  =&gt; 'test-db',                                                                                                                                                                                                            \n    :username  =&gt; 'userName',                                                                                                                                                                                                           \n    :password  =&gt; 'passWord'})   \n\nload_models\nkeyWord = KeyWord.find(:all)\n</code></pre>\n\n<p>i need something like a function i can just call like</p>\n\n<pre><code>def set_connection\n   connection code here\n   return connection\nend\n</code></pre>\n\n<p>where, if run, my script will be connected to the database.</p>\n\n<p>i write my scripts using only the rubygems and activerecord gems. Not inside a rails app.</p>\n\n<p>thanks for any tips</p>\n"}, {"tags": ["ruby"], "answers": [{"tags": [], "owner": {"reputation": 3559, "user_id": 260411, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/b6b9ca3212a110fb665c5e805d026999?s=128&d=identicon&r=PG", "display_name": "Toribio", "link": "https://stackoverflow.com/users/260411/toribio"}, "is_accepted": true, "score": 0, "last_activity_date": 1571084104, "creation_date": 1571084104, "answer_id": 58383509, "question_id": 58383228, "link": "https://stackoverflow.com/questions/58383228/cli-data-gem-using-ruby/58383509#58383509", "title": "CLI Data Gem using Ruby", "body": "<p>You're not checking for <code>exit</code> input inside the loop. Changing the last <code>else</code> to this should work:</p>\n\n<pre><code>elsif input != \"exit\"\n  puts \"No Bueno. Type 1, 2, list, or exit\"\nend\n</code></pre>\n"}], "owner": {"reputation": 15, "user_id": 3251999, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/405a7c5a8f4bf2988cb8bd50dd168da0?s=128&d=identicon&r=PG&f=1", "display_name": "user3251999", "link": "https://stackoverflow.com/users/3251999/user3251999"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 28, "favorite_count": 0, "accepted_answer_id": 58383509, "answer_count": 1, "score": 0, "last_activity_date": 1571084104, "creation_date": 1571082670, "question_id": 58383228, "link": "https://stackoverflow.com/questions/58383228/cli-data-gem-using-ruby", "title": "CLI Data Gem using Ruby", "body": "<p>Newbie question here. I'm working on my first CLI Data Gem project that scrapes live data from 2 websites. </p>\n\n<p>The user can press '1' to see article #1 or '2' to see article #2. \nThe user can type 'list' to see both article titles stacked one on top of the other. \nTyping 'exit' should exit the app with \"See you tomorrow for more articles.\"</p>\n\n<p>When the user types literally anything else, the program should say \"No Bueno. Type 1, 2, list, or exit\"</p>\n\n<p>So far, pressing '1' or '2' works. Typing 'list' works</p>\n\n<p><strong>The error happens when</strong> I press 'exit'..</p>\n\n<p>It will say \n\"No Bueno. Type 1, 2, list, or exit\" (my custom error message)\nand\n\"See you tomorrow for more articles.\"   </p>\n\n<p>when it should just say - \"See you tomorrow for more articles.\"  </p>\n\n<pre><code>\n def call\n    list_items\n    menu\n    goodbye\n  end\n\n  def list_items\n    # here doc - http://blog.jayfields.com/2006/12/ruby-multiline-strings-here-doc-or.html\n    puts \"Today's Designer News:\"\n    @articles = DesignerNews::Article.today\n    @articles.each.with_index(1) do |article, i|\n      puts \"#{i}. #{article.title} - #{article.name} - #{article.date} - #{article.url}\"\n    end\n  end\n\n  def menu\n    input = nil \n    while input !=\"exit\"\n      puts \"Enter the number of the item you'd like to read, type list to see the list, or type exit:\"\n      input = gets.strip.downcase\n\n      if input.to_i &gt; 0 \n        the_article = @articles[input.to_i-1]\n        puts \"#{the_article.title} - #{the_article.name} - #{the_article.date} - #{the_article.url}\"\n      elsif input == \"list\"\n        list_items\n      else\n        puts \"No Bueno. Type 1, 2, list, or exit\"\n      end\n    end\n  end\n\n  def goodbye\n    puts \"See you tomorrow for more articles.\"\n  end\nend\n</code></pre>\n\n<p>any and all help is appreciated.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-5.2"], "comments": [{"owner": {"reputation": 1349, "user_id": 6163262, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c7f3655350c57cb94195d64808b7ba61?s=128&d=identicon&r=PG&f=1", "display_name": "whodini9", "link": "https://stackoverflow.com/users/6163262/whodini9"}, "edited": false, "score": 0, "creation_date": 1571084101, "post_id": 58382871, "comment_id": 103115033, "body": "Are <code>Players</code> and <code>Leaders</code> their own Model or is this data stored on the Friend?"}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 2, "creation_date": 1571084705, "post_id": 58382871, "comment_id": 103115272, "body": "Is there some reason that the value of <code>&quot;authenticity_token&quot;</code> in your example needs to be 90 characters in length? Examples should be as small as possible while still conveying the essence of the problem.  Also, if you write <code>params = {&quot;utf8&quot;=&gt;&quot;\u2713&quot;, ....}</code>, readers can simply cut-and-paste."}, {"owner": {"reputation": 2573, "user_id": 5787849, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0885a24e8501106661f4475a59fe1a0b?s=128&d=identicon&r=PG&f=1", "display_name": "Aniket Shivam Tiwari", "link": "https://stackoverflow.com/users/5787849/aniket-shivam-tiwari"}, "reply_to_user": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1571120992, "post_id": 58382871, "comment_id": 103123787, "body": "@CarySwoveland Nice suggestion I will keep that in mind"}, {"owner": {"reputation": 2573, "user_id": 5787849, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0885a24e8501106661f4475a59fe1a0b?s=128&d=identicon&r=PG&f=1", "display_name": "Aniket Shivam Tiwari", "link": "https://stackoverflow.com/users/5787849/aniket-shivam-tiwari"}, "reply_to_user": {"reputation": 1349, "user_id": 6163262, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c7f3655350c57cb94195d64808b7ba61?s=128&d=identicon&r=PG&f=1", "display_name": "whodini9", "link": "https://stackoverflow.com/users/6163262/whodini9"}, "edited": false, "score": 0, "creation_date": 1571125689, "post_id": 58382871, "comment_id": 103126085, "body": "@whodini9 players and leaders are the array field stored in friends model. My association is user has one friend"}], "answers": [{"comments": [{"owner": {"reputation": 13442, "user_id": 3982562, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2a3c7aae1d762372cda697833c602ec8?s=128&d=identicon&r=PG", "display_name": "3limin4t0r", "link": "https://stackoverflow.com/users/3982562/3limin4t0r"}, "edited": false, "score": 0, "creation_date": 1571085088, "post_id": 58383668, "comment_id": 103115421, "body": "<i>&quot;You can fetch values of <code>ActionController::Parameters</code> using either <code>:key</code> or <code>&quot;key&quot;</code>.&quot;</i> - <a href=\"https://api.rubyonrails.org/classes/ActionController/Parameters.html\" rel=\"nofollow noreferrer\">documentation</a> There is no need to use <code>with_indifferent_access</code>."}, {"owner": {"reputation": 1520, "user_id": 11500664, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1xAgW.jpg?s=128&g=1", "display_name": "Jake Luby", "link": "https://stackoverflow.com/users/11500664/jake-luby"}, "edited": false, "score": 0, "creation_date": 1571085140, "post_id": 58383668, "comment_id": 103115441, "body": "Maybe include a link to where you can read about that method?"}], "tags": [], "owner": {"reputation": 1, "user_id": 12213900, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-ACLTxlNXfKI/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3ret7e9BMRTO6h1aPxD3VojD6j1lsA/photo.jpg?sz=128", "display_name": "Vuka", "link": "https://stackoverflow.com/users/12213900/vuka"}, "is_accepted": false, "score": 0, "last_activity_date": 1571084927, "creation_date": 1571084927, "answer_id": 58383668, "question_id": 58382871, "link": "https://stackoverflow.com/questions/58382871/update-params-hash-in-rails/58383668#58383668", "title": "update params hash in rails", "body": "<p>Your params are hash, require and permit method are instance method of ActionController::Parameters. Also you try dig by symbol instead string.</p>\n\n<pre><code>params.dig('user', 'friend_attributes')\n</code></pre>\n\n<p>Or if you want to continue using the symbol you can write it like this</p>\n\n<pre><code>params.with_indifferent_access.dig(:user, :friend_attributes)\n</code></pre>\n\n<p>Please, read more about with_indifferent_access method.</p>\n\n<p>:)</p>\n"}, {"comments": [{"owner": {"reputation": 13442, "user_id": 3982562, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2a3c7aae1d762372cda697833c602ec8?s=128&d=identicon&r=PG", "display_name": "3limin4t0r", "link": "https://stackoverflow.com/users/3982562/3limin4t0r"}, "edited": false, "score": 0, "creation_date": 1571086952, "post_id": 58383785, "comment_id": 103116111, "body": "If you&#39;ve never seen the <code>%i[...]</code> notation, you can find the documentation <a href=\"https://ruby-doc.org/core-2.6.5/doc/syntax/literals_rdoc.html#label-Percent+Strings\" rel=\"nofollow noreferrer\">here</a>."}, {"owner": {"reputation": 2573, "user_id": 5787849, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0885a24e8501106661f4475a59fe1a0b?s=128&d=identicon&r=PG&f=1", "display_name": "Aniket Shivam Tiwari", "link": "https://stackoverflow.com/users/5787849/aniket-shivam-tiwari"}, "edited": false, "score": 0, "creation_date": 1571118694, "post_id": 58383785, "comment_id": 103122914, "body": "From the view, it is not possible because I am sending this data from javascript. Also, the above solution you gave didn&#39;t work for me. Let me update your solution in my question"}, {"owner": {"reputation": 2573, "user_id": 5787849, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0885a24e8501106661f4475a59fe1a0b?s=128&d=identicon&r=PG&f=1", "display_name": "Aniket Shivam Tiwari", "link": "https://stackoverflow.com/users/5787849/aniket-shivam-tiwari"}, "edited": false, "score": 0, "creation_date": 1571118714, "post_id": 58383785, "comment_id": 103122920, "body": "From the view, it is not possible because I am sending this data from javascript. Also, the above solution you gave didn&#39;t work for me. Let me update your solution in my question"}, {"owner": {"reputation": 13442, "user_id": 3982562, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2a3c7aae1d762372cda697833c602ec8?s=128&d=identicon&r=PG", "display_name": "3limin4t0r", "link": "https://stackoverflow.com/users/3982562/3limin4t0r"}, "reply_to_user": {"reputation": 2573, "user_id": 5787849, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0885a24e8501106661f4475a59fe1a0b?s=128&d=identicon&r=PG&f=1", "display_name": "Aniket Shivam Tiwari", "link": "https://stackoverflow.com/users/5787849/aniket-shivam-tiwari"}, "edited": false, "score": 0, "creation_date": 1571138028, "post_id": 58383785, "comment_id": 103132542, "body": "@AniketShivamTiwari Supplying the parameters through JavaScript only makes the request more customizable. Could you add the way you compose the request parameters and make the request?"}, {"owner": {"reputation": 2573, "user_id": 5787849, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0885a24e8501106661f4475a59fe1a0b?s=128&d=identicon&r=PG&f=1", "display_name": "Aniket Shivam Tiwari", "link": "https://stackoverflow.com/users/5787849/aniket-shivam-tiwari"}, "edited": false, "score": 0, "creation_date": 1571159151, "post_id": 58383785, "comment_id": 103144441, "body": "@3limi4t0r Thanks It worked now. I was making a silly mistake. Instead of permitting leaders and players as an array. I was giving it as a string"}, {"owner": {"reputation": 13442, "user_id": 3982562, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2a3c7aae1d762372cda697833c602ec8?s=128&d=identicon&r=PG", "display_name": "3limin4t0r", "link": "https://stackoverflow.com/users/3982562/3limin4t0r"}, "reply_to_user": {"reputation": 2573, "user_id": 5787849, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0885a24e8501106661f4475a59fe1a0b?s=128&d=identicon&r=PG&f=1", "display_name": "Aniket Shivam Tiwari", "link": "https://stackoverflow.com/users/5787849/aniket-shivam-tiwari"}, "edited": false, "score": 1, "creation_date": 1571159438, "post_id": 58383785, "comment_id": 103144569, "body": "@AniketShivamTiwari I&#39;ve updated the answer to better clarify that you should update the permitted params, since that wasn&#39;t clear enough apparently."}, {"owner": {"reputation": 2573, "user_id": 5787849, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0885a24e8501106661f4475a59fe1a0b?s=128&d=identicon&r=PG&f=1", "display_name": "Aniket Shivam Tiwari", "link": "https://stackoverflow.com/users/5787849/aniket-shivam-tiwari"}, "edited": false, "score": 0, "creation_date": 1571159547, "post_id": 58383785, "comment_id": 103144622, "body": "@3limi4t0r Thanks"}], "tags": [], "owner": {"reputation": 13442, "user_id": 3982562, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2a3c7aae1d762372cda697833c602ec8?s=128&d=identicon&r=PG", "display_name": "3limin4t0r", "link": "https://stackoverflow.com/users/3982562/3limin4t0r"}, "is_accepted": true, "score": 2, "last_activity_date": 1571159348, "last_edit_date": 1571159348, "creation_date": 1571085538, "answer_id": 58383785, "question_id": 58382871, "link": "https://stackoverflow.com/questions/58382871/update-params-hash-in-rails/58383785#58383785", "title": "update params hash in rails", "body": "<p>Something like this would do the job:</p>\n\n<pre><code>if (attributes = params.dig(:user, :friend_attributes))\n  %i[players leaders].each do |key|\n    next unless attributes.has_key?(key)\n    attributes[key] = attributes[key].split(',').map(&amp;:to_i)\n  end\nend\n</code></pre>\n\n<p>The problem currently lies in <code>(friend_params.dig(:friend_attributes) || []).each</code> which loops though the key-value pairs, or if not present through an empty array. You then call the <code>#[]</code> method on the value (which is a string). eg. <code>\"50589,50590\"['players']</code> tries the find the substring <code>'players'</code> inside <code>\"50589,50590\"</code> the result of this should be <code>nil</code>. Followed by an \"NoMethodError: undefined method `split' for nil:NilClass\" exception.</p>\n\n<p>You should simply use the returned collection, rather than looping through the key-value pairs.</p>\n\n<hr>\n\n<p>The better question is, why do you need to transform your parameters at all?</p>\n\n<p>Can't the view be arranged in such a way to provide the parameters in array format?</p>\n\n<pre class=\"lang-html prettyprint-override\"><code>&lt;input name=\"user[friend_attributes][players][]\" type=\"checkbox\" value=\"1\" /&gt;\n&lt;input name=\"user[friend_attributes][players][]\" type=\"checkbox\" value=\"2\" /&gt;\n&lt;input name=\"user[friend_attributes][players][]\" type=\"checkbox\" value=\"3\" /&gt;\n</code></pre>\n\n<p>Would send an array of numbers to the controller to start with, eliminating the need to convert parameters into the correct format.</p>\n\n<p><strong>Note:</strong> If you supply the parameters in the above format you should update your permited params to:</p>\n\n<pre><code>params.require(:user).permit(:first_name, :last_name, friend_attributes: [:phone_number, :title, :role, players: [], leaders: []])\n# players and leaders are now expecting an array instead of a scalar value\n</code></pre>\n"}], "owner": {"reputation": 2573, "user_id": 5787849, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0885a24e8501106661f4475a59fe1a0b?s=128&d=identicon&r=PG&f=1", "display_name": "Aniket Shivam Tiwari", "link": "https://stackoverflow.com/users/5787849/aniket-shivam-tiwari"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 551, "favorite_count": 0, "accepted_answer_id": 58383785, "answer_count": 2, "score": 1, "last_activity_date": 1571159348, "creation_date": 1571080722, "last_edit_date": 1571125869, "question_id": 58382871, "link": "https://stackoverflow.com/questions/58382871/update-params-hash-in-rails", "title": "update params hash in rails", "body": "<p>I need a way to modify the params hash. I tried a couple of things but none of it actually worked.  </p>\n\n<pre><code>Unpermitted parameters: :players, :leaders\n</code></pre>\n\n<p><strong>Params</strong></p>\n\n<pre><code>{\"utf8\"=&gt;\"\u2713\", \"authenticity_token\"=&gt;\"asa\", \"user\"=&gt;{\"first_name\"=&gt;\"anikeeet\", \"last_name\"=&gt;\"tiwariii\", \"friend_attributes\"=&gt;{\"players\"=&gt;\"50589,50590\", \"leaders\"=&gt;\"16,6,18\", \"phone_number\"=&gt;\"\", \"title\"=&gt;\"aasdassd\", \"role\"=&gt;\"abcdef\"}}}\n</code></pre>\n\n<p>I tried this way</p>\n\n<pre><code>(friend_params.dig(:friend_attributes) || []).each do |_, attributes|\n      attributes['players'] = attributes['players'].split(',').map(&amp;:to_i)\n      attributes['leaders'] = attributes['leaders'].split(',').map(&amp;:to_i)\n    end\n</code></pre>\n\n<p>this way</p>\n\n<pre><code>(friend_params.dig(:friend_attributes) || []).each do |key, val|\n  friend_params[\"friend_attributes\"][\"#{key}\"] = val.split(',').map(&amp;:to_i) if key == 'players' || key == 'leaders'\nend\n</code></pre>\n\n<p>this way</p>\n\n<pre><code>(params.dig(:user, :friend_attributes) || []).each do |key, val|\n  params[\"user\"][\"friend_attributes\"][\"#{key}\"] = val.split(',').map(&amp;:to_i) if key == 'players' || key == 'leaders'\nend\n</code></pre>\n\n<p>and this way</p>\n\n<pre><code> if (attributes = params.dig(:user, :friend_attributes))\n      %i[players leaders].each do |key|\n        next unless attributes.has_key?(key)\n        attributes[key] = attributes[key].split(',').map(&amp;:to_i)\n      end\n    end\n</code></pre>\n\n<p>But none of the ways worked for me. I am sharing my full controller code</p>\n\n<pre><code>class FriendsController &lt; ApplicationController\n\n  def update\n    # (friend_params.dig(:friend_attributes) || []).each do |_, attributes|\n    #   attributes['players'] = attributes['players'].split(',').map(&amp;:to_i)\n    #   attributes['leaders'] = attributes['leaders'].split(',').map(&amp;:to_i)\n    # end\n\n    # (friend_params.dig(:friend_attributes) || []).each do |key, val|\n    #   friend_params[\"friend_attributes\"][\"#{key}\"] = val.split(',').map(&amp;:to_i) if key == 'players' || key == 'leaders'\n    # end\n\n    # (params.dig(:user, :friend_attributes) || []).each do |key, val|\n    #   params[\"user\"][\"friend_attributes\"][\"#{key}\"] = val.split(',').map(&amp;:to_i) if key == 'players' || key == 'leaders'\n    # end\n\n     if (attributes = params.dig(:user, :friend_attributes))\n       %i[players leaders].each do |key|\n         next unless attributes.has_key?(key)\n         attributes[key] = attributes[key].split(',').map(&amp;:to_i)\n       end\n     end\n\n\n    if current_user.update(friend_params)\n      render json: { success: true }\n    else\n      render json: {error: \"something went wrong\"}\n    end\n  end\n\n  private\n  def friend_params\n    params.require(:user).permit(:first_name, :last_name, friend_attributes: [:phone_number, :title, :role, :players, :leaders])\n  end\nend\n</code></pre>\n\n<p>Association</p>\n\n<pre><code>Class User &lt; ApplicationRecord \n  has_one :friend, foreign_key: :user_id, dependent: :destroy\n  accepts_nested_attributes_for :friend\nend\n\nclass Friend &lt; ApplicationRecord\n  self.table_name = 'schema.friends'\n  belongs_to :user\nend\n</code></pre>\n\n<p>players and leaders are the array field stored in friends table\nCan anyone tell what I am doing wrong?</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 56502, "user_id": 271475, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b00f41e5f2a69734051f2a78f4f3785?s=128&d=identicon&r=PG", "display_name": "Chris Heald", "link": "https://stackoverflow.com/users/271475/chris-heald"}, "edited": false, "score": 1, "creation_date": 1571079666, "post_id": 58382570, "comment_id": 103113384, "body": "<code>no time information in &quot;&quot;</code> indicates that the string you&#39;re passing to <code>Time.parse</code> is empty. Double check that you&#39;re passing the data you think you are."}, {"owner": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "edited": false, "score": 0, "creation_date": 1571079667, "post_id": 58382570, "comment_id": 103113385, "body": "Somehow you&#39;re storing an empty string in <code>@hours</code>. Try pushing to <code>to_return</code> only if the value isn&#39;t an empty string. Also move @hours outside the each_with_object block."}, {"owner": {"reputation": 2630, "user_id": 1706670, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c7a901672979d5870dc01f9787c0b2a4?s=128&d=identicon&r=PG", "display_name": "PGill", "link": "https://stackoverflow.com/users/1706670/pgill"}, "edited": false, "score": 2, "creation_date": 1571236465, "post_id": 58382570, "comment_id": 103174452, "body": "change <code>@hours.compact</code> to <code>@hours.reject(&amp;:blank?)</code>. This will remove empty strings"}], "answers": [{"tags": [], "owner": {"reputation": 126343, "user_id": 14660, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/e55e0ec3c00f834d78fbdddeaa36e308?s=128&d=identicon&r=PG", "display_name": "Schwern", "link": "https://stackoverflow.com/users/14660/schwern"}, "is_accepted": true, "score": 1, "last_activity_date": 1572329501, "creation_date": 1572329501, "answer_id": 58602199, "question_id": 58382570, "link": "https://stackoverflow.com/questions/58382570/ruby-parsing-time-from-a-string/58602199#58602199", "title": "Ruby: Parsing time from a string", "body": "<blockquote>\n  <p>This is very odd to me, because if I remove the Time.parse(time_slot) and simply try to convert the time using time_slot.strftime(\"%I:%M %p\") it throws an error undefined method `strftime' for \"08:00:00\":String. The object is clearly being passed in - am I not understanding something?</p>\n</blockquote>\n\n<p><code>time_helper</code> is being called with an Array like <code>[\"08:00:00\", \"\", \"18:00:00\"]</code>.</p>\n\n<p><code>\"08:00:00\"</code> is parsed, but then <code>Time.parse</code> chokes on the <code>\"\"</code>. If you try <code>time_slot.strftime(\"%I:%M %p\")</code> <code>strftime</code> errors on <code>\"08:00:00\"</code> because it is a String, not a Time.</p>\n\n<p>You can fix this as PGiII suggests by using <a href=\"https://ruby-doc.org/core-2.6.5/Enumerable.html#method-i-reject\" rel=\"nofollow noreferrer\"><code>@hours.reject(&amp;:blank?)</code></a> which will remove <a href=\"https://api.rubyonrails.org/classes/Object.html#method-i-blank-3F\" rel=\"nofollow noreferrer\"><code>nil</code> as well as empty strings</a>. Although you may still want to figure out why <code>@facility.access_hours</code> has blanks in it.</p>\n"}], "owner": {"reputation": 277, "user_id": 4774554, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d72ff795ced575525d4f5cf033d65520?s=128&d=identicon&r=PG&f=1", "display_name": "VegaStudios", "link": "https://stackoverflow.com/users/4774554/vegastudios"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 93, "favorite_count": 0, "accepted_answer_id": 58602199, "answer_count": 1, "score": 0, "last_activity_date": 1572329501, "creation_date": 1571079333, "last_edit_date": 1572328597, "question_id": 58382570, "link": "https://stackoverflow.com/questions/58382570/ruby-parsing-time-from-a-string", "title": "Ruby: Parsing time from a string", "body": "<p>I'm trying to pass an array of times kept as strings (<code>[\"08:00:00\", \"18:00:00\"]</code>) and return them in a more readable manner via a helper method. </p>\n\n<p>However, I keep receiving an argument error in the helper method. This is very odd to me, because if I remove the <code>Time.parse(time_slot)</code> and simply try to convert the time using <code>time_slot.strftime(\"%I:%M %p\")</code> it throws an error <code>undefined method `strftime' for \"08:00:00\":String</code>. The object is clearly being passed in - am I not understanding something?</p>\n\n<blockquote>\n  <p>line 4: hours &lt;&lt;  Time.parse(time_slot).strftime(\"%I:%M %p\")<br>\n  no time information in \"\"</p>\n</blockquote>\n\n<p>Code:</p>\n\n<pre><code>1: - I18n.t('date.day_names').each do |day|\n2:   - %w[starts ends].each_with_object([]) do |time_type, to_return|\n3:     - @hours = to_return &lt;&lt; @facility.access_hours[\"#{time_type}_#{day.downcase}\"]\n4:   - @hours.compact.tap do |hours|\n5:     = day\n6:     = hours\n7:     = time_helper(hours)\n8:     = byebug\n(byebug) hours = [\"08:00:00\", \"18:00:00\"]\n(byebug) time_helper(hours) = \"08:00 AM - 06:00 PM\"\n</code></pre>\n\n<p>Helper method</p>\n\n<pre><code>def time_helper(time)\n  hours = []\n  time.each do |time_slot|\n    hours &lt;&lt;  Time.parse(time_slot).strftime(\"%I:%M %p\")\n  end\n  hours.join(' - ')\nend\n</code></pre>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 2251, "user_id": 9785060, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IUduC.png?s=128&g=1", "display_name": "Viktor", "link": "https://stackoverflow.com/users/9785060/viktor"}, "edited": false, "score": 0, "creation_date": 1571078519, "post_id": 58382259, "comment_id": 103112970, "body": "<code>@ipx = q</code> Looks like you&#39;re overwriting <code>@ipx</code> each time a new record loads"}, {"owner": {"reputation": 2251, "user_id": 9785060, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IUduC.png?s=128&g=1", "display_name": "Viktor", "link": "https://stackoverflow.com/users/9785060/viktor"}, "edited": false, "score": 0, "creation_date": 1571078948, "post_id": 58382259, "comment_id": 103113113, "body": "What you probably want is to initialize <code>@ipx</code> outside the loops and then add a new element into <code>@ipx</code> in each iteration of the <code>#each</code> loop"}, {"owner": {"reputation": 13, "user_id": 12161078, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mAHNqZC8b9MJctmhTbjWR5g-AIkMo84yng_fxQCdg=k-s128", "display_name": "Victor Coelho", "link": "https://stackoverflow.com/users/12161078/victor-coelho"}, "reply_to_user": {"reputation": 2251, "user_id": 9785060, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IUduC.png?s=128&g=1", "display_name": "Viktor", "link": "https://stackoverflow.com/users/9785060/viktor"}, "edited": false, "score": 0, "creation_date": 1571079295, "post_id": 58382259, "comment_id": 103113241, "body": "exactly! but even initializing it from outside only prints a single value;"}, {"owner": {"reputation": 2251, "user_id": 9785060, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IUduC.png?s=128&g=1", "display_name": "Viktor", "link": "https://stackoverflow.com/users/9785060/viktor"}, "edited": false, "score": 0, "creation_date": 1571079559, "post_id": 58382259, "comment_id": 103113341, "body": "I&#39;m not sure how you plan on storing the values in a hash. For each record from the database, whats the key and whats the value? Where in your code do you add the key/value pair to the <code>@ipx</code> hash? Where exactly did you initialize the <code>@ipx</code> hash? Outside both loops? Where are you printing the values of <code>@ipx</code> so it only shows 1 record? What you&#39;re saying doesn&#39;t match the code you posted"}, {"owner": {"reputation": 13, "user_id": 12161078, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mAHNqZC8b9MJctmhTbjWR5g-AIkMo84yng_fxQCdg=k-s128", "display_name": "Victor Coelho", "link": "https://stackoverflow.com/users/12161078/victor-coelho"}, "reply_to_user": {"reputation": 2251, "user_id": 9785060, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IUduC.png?s=128&g=1", "display_name": "Viktor", "link": "https://stackoverflow.com/users/9785060/viktor"}, "edited": false, "score": 0, "creation_date": 1571080145, "post_id": 58382259, "comment_id": 103113568, "body": "#GET ALL DATA and set to hash @bd_remote   bd_remote = @c_remote.exec(&quot;SELECT id,name,phone_number,active FROM trunks&quot;)"}, {"owner": {"reputation": 13, "user_id": 12161078, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mAHNqZC8b9MJctmhTbjWR5g-AIkMo84yng_fxQCdg=k-s128", "display_name": "Victor Coelho", "link": "https://stackoverflow.com/users/12161078/victor-coelho"}, "reply_to_user": {"reputation": 2251, "user_id": 9785060, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IUduC.png?s=128&g=1", "display_name": "Viktor", "link": "https://stackoverflow.com/users/9785060/viktor"}, "edited": false, "score": 0, "creation_date": 1571080192, "post_id": 58382259, "comment_id": 103113586, "body": "bd_remote.each do |q| ipx = q"}], "owner": {"reputation": 13, "user_id": 12161078, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mAHNqZC8b9MJctmhTbjWR5g-AIkMo84yng_fxQCdg=k-s128", "display_name": "Victor Coelho", "link": "https://stackoverflow.com/users/12161078/victor-coelho"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 42, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1571077856, "creation_date": 1571077856, "question_id": 58382259, "link": "https://stackoverflow.com/questions/58382259/populate-hash-with-each-key-and-value-from-pg-object", "title": "Populate Hash with each key and value from pg object", "body": "<p>could you help me I am not getting out of this, I am trying to get the returns straight to my hash but I need to perform insertion of three pgcon objects below my code.</p>\n\n<p>i try with each.</p>\n\n<p>I tried with two each but the variable if called outside has only 1 value and not all records.</p>\n\n<pre><code>@bd_local = {}\n@bd_remote = {}\n@c_local = PG.connect(:hostaddr =&gt; '10.11.12.36', :port =&gt; 5432, :dbname =&gt; \"cnet\", :user =&gt; \"cuser\", :connect_timeout =&gt; 90)\n\n#get adress from local bd to acess remote bd\n@bdlocal_ip_remote.each do |k|\n  @ips = {}\n  @ips = k\n\n#conect in remote servers\n  @c_remote = PG.connect(:hostaddr =&gt; @ips[\"host\"], :port =&gt; 5432, :dbname =&gt; \"cdbs\", :user =&gt; \"cnet\", :connect_timeout =&gt; 90)\n\n#GET ALL DATA and set to hash @bd_remote\n  @bd_remote = @c_remote.exec(\"SELECT id,name,phone_number,active FROM trunks\")\n    @bd_remote.each do |q|\n    @ipx = {}\n    @ipx = q\n  #puts \"Server: #{@ips[\"host\"]} - ID: #{@ipx[\"id\"]} - Phone: - #{@ipx[\"phone\"]} - Status #{@ipx[\"active\"]}\"\n  end\nend\n</code></pre>\n\n<p>I get 74 records when I perform this way.</p>\n\n<p>but running outside of each I have only the first record of one of the remote servers.</p>\n\n<p>I need to access all 74 records that were obtained by each in a hash outside of each to start a hash comparison process but I can't.</p>\n\n<blockquote>\n  <p>Example: puts bd_remote[\"id\"]</p>\n  \n  <p>id=1 id=2 id=3 id=4 id=5 and others... from outside each to execute hash compare.</p>\n</blockquote>\n"}, {"tags": ["ruby", "firebase", "google-cloud-platform", "google-cloud-firestore"], "comments": [{"owner": {"reputation": 233128, "user_id": 807126, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xpNqK.jpg?s=128&g=1", "display_name": "Doug Stevenson", "link": "https://stackoverflow.com/users/807126/doug-stevenson"}, "edited": false, "score": 0, "creation_date": 1571076594, "post_id": 58381997, "comment_id": 103112225, "body": "How many times through the loop does it get before the error?"}, {"owner": {"reputation": 6462, "user_id": 3784008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/55ou4.jpg?s=128&g=1", "display_name": "anothermh", "link": "https://stackoverflow.com/users/3784008/anothermh"}, "edited": false, "score": 0, "creation_date": 1571079573, "post_id": 58381997, "comment_id": 103113349, "body": "You should be writing this in a batch. See <a href=\"https://cloud.google.com/firestore/docs/best-practices#read_and_write_operations\" rel=\"nofollow noreferrer\">here</a> and <a href=\"https://cloud.google.com/firestore/docs/manage-data/transactions#batched-writes\" rel=\"nofollow noreferrer\">here</a>. Also are you writing to that document more than once in that loop? Because writes per document should be at most 1 per second."}, {"owner": {"reputation": 228, "user_id": 3726706, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4c3sf.jpg?s=128&g=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/3726706/alex"}, "edited": false, "score": 0, "creation_date": 1571080082, "post_id": 58381997, "comment_id": 103113542, "body": "Doug: per the output, it hangs on the first attempt."}, {"owner": {"reputation": 228, "user_id": 3726706, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4c3sf.jpg?s=128&g=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/3726706/alex"}, "edited": false, "score": 0, "creation_date": 1571080259, "post_id": 58381997, "comment_id": 103113616, "body": "anothermh: &quot;1 write/sec per document&quot; is new to me. thanks for the link. given that i&#39;ve been (unknowingly) violating this rule pretty badly, how do i extricate myself from this situation? i can&#39;t seem to read or write anything in any document at the moment."}, {"owner": {"reputation": 6462, "user_id": 3784008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/55ou4.jpg?s=128&g=1", "display_name": "anothermh", "link": "https://stackoverflow.com/users/3784008/anothermh"}, "edited": false, "score": 0, "creation_date": 1571080677, "post_id": 58381997, "comment_id": 103113793, "body": "What happens in the Firebase console? Can you read or write there?"}, {"owner": {"reputation": 228, "user_id": 3726706, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4c3sf.jpg?s=128&g=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/3726706/alex"}, "edited": false, "score": 0, "creation_date": 1571081274, "post_id": 58381997, "comment_id": 103114022, "body": "looks like i am able to read &amp; write via the Firebase console."}, {"owner": {"reputation": 6462, "user_id": 3784008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/55ou4.jpg?s=128&g=1", "display_name": "anothermh", "link": "https://stackoverflow.com/users/3784008/anothermh"}, "edited": false, "score": 0, "creation_date": 1571084272, "post_id": 58381997, "comment_id": 103115090, "body": "Post the actual error you get when attempting a read or write from Ruby. You could also try re-issuing your service credentials (<code>firebase-credentials.json</code>) and retrying with the new credentials. Not sure what else might to try."}, {"owner": {"reputation": 228, "user_id": 3726706, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4c3sf.jpg?s=128&g=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/3726706/alex"}, "edited": false, "score": 0, "creation_date": 1571086878, "post_id": 58381997, "comment_id": 103116085, "body": "actual error is in the post. &quot;GaxError RPC failed, caused by 4:Deadline Exceeded (Google::Gax::DeadlineExceededError)&quot;"}, {"owner": {"reputation": 430, "user_id": 9687449, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-ScUTO6CKvdQ/AAAAAAAAAAI/AAAAAAAAAAA/BXKGYIn6Wwk/photo.jpg?sz=128", "display_name": "Oliver Aragon", "link": "https://stackoverflow.com/users/9687449/oliver-aragon"}, "edited": false, "score": 0, "creation_date": 1573745815, "post_id": 58381997, "comment_id": 103991872, "body": "Were you able to get this resolved?"}, {"owner": {"reputation": 228, "user_id": 3726706, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4c3sf.jpg?s=128&g=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/3726706/alex"}, "edited": false, "score": 0, "creation_date": 1573851545, "post_id": 58381997, "comment_id": 104036347, "body": "i believe the issue was writing much too frequently to a single document. i ended up deleting the  containing collection and re-creating it. i&#39;ve been following the &quot;max 1 update/sec&quot; rule since then and haven&#39;t had further problems."}], "answers": [{"tags": [], "owner": {"reputation": 228, "user_id": 3726706, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4c3sf.jpg?s=128&g=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/3726706/alex"}, "is_accepted": false, "score": 1, "last_activity_date": 1573851622, "creation_date": 1573851622, "answer_id": 58884596, "question_id": 58381997, "link": "https://stackoverflow.com/questions/58381997/timeout-reading-writing-data-in-firebase-firestore/58884596#58884596", "title": "timeout reading &amp; writing data in firebase firestore", "body": "<p>i believe the issue was writing much too frequently to a single document. i ended up deleting the containing collection and re-creating it. i've been following the \"max 1 update/sec\" rule since then and haven't had further problems.</p>\n\n<p><a href=\"https://cloud.google.com/firestore/docs/best-practices#updates_to_a_single_document\" rel=\"nofollow noreferrer\">https://cloud.google.com/firestore/docs/best-practices#updates_to_a_single_document</a></p>\n"}], "owner": {"reputation": 228, "user_id": 3726706, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4c3sf.jpg?s=128&g=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/3726706/alex"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 566, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1573851622, "creation_date": 1571076445, "last_edit_date": 1571820750, "question_id": 58381997, "link": "https://stackoverflow.com/questions/58381997/timeout-reading-writing-data-in-firebase-firestore", "title": "timeout reading &amp; writing data in firebase firestore", "body": "<p>i'm encountering a <code>Google::Cloud::DeadlineExceededError</code> error when creating a document in Firebase <a href=\"https://firebase.google.com/docs/firestore/\" rel=\"nofollow noreferrer\">Cloud Firestore</a> using the <a href=\"https://github.com/googleapis/google-cloud-ruby/tree/master/google-cloud-firestore\" rel=\"nofollow noreferrer\">ruby client</a>.</p>\n\n<p>Similar code has been working flawlessly up to this point. I've never seen a timeout before today, so i'm quite confused what could be going wrong.</p>\n\n<p>other troubleshooting i've done:</p>\n\n<ol>\n<li>i've updated to a pay-as-you-go Firestore plan, and i have verified that I am not exceeding any quotas. (So if this is rate-limiting it's some limit which isn't readily visible.)</li>\n<li>the <a href=\"https://status.cloud.google.com/\" rel=\"nofollow noreferrer\">status page</a> doesn't show any issues with Firestore currently. (10/24/2019) </li>\n</ol>\n\n<p>has anyone run into similar behavior - an app is working fine, and then suddenly Firestore begins timing out?</p>\n\n<p>i have a guess that perhaps i've triggered some rate-limiting, because this has only begun today when i've started hitting firestore with increased amounts of traffic. (trying to load test as i get closer to launching the app in production.) But I have zero actual evidence that this is the reason.</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code># bin/load-test\nrequire \"thor\"\n\nclass LoadTest &lt; Thor\n  desc \"setup\", \"set up a game for load testing\"\n  method_option :game, type: :string, required: true, aliases: '-g'\n  method_option :player_count, type: :numeric, required: true, aliases: '-c'\n  def setup\n    log = Logger.new($stdout, level: Logger::DEBUG)\n    root_dir = Pathname.new(File.expand_path('../..', __FILE__))\n    Google::Cloud::Firestore.configure do |config|\n      config.credentials = root_dir.join('firebase-credentials.json').to_s\n    end\n\n    game = db.doc(\"games/#{options[:game]}\")\n\n    options[:player_count].times do\n      player_id = SecureRandom.hex\n      log.debug \"creating player #{player_id}\"\n\n      # =====&gt; this is line 47 in the actual file. this is where the timeout happens.\n      game.collection('players').doc(player_id).set({is_active: true})\n\n    end\n\n    log.info \"created #{options[:player_count]} player records.\"\n  end\nend\n\nLoadTest.start\n</code></pre>\n\n<pre><code>$ bin/load-test setup --game 20191014-test-game --player-count 200\nD, [2019-10-14T12:49:07.562328 #85721] DEBUG -- : creating player 10d81b445239d94e9d9f047ae3eee952\nTraceback (most recent call last):\n    23: from bin/load-test:129:in `&lt;main&gt;'\n    22: from /Users/alex/.rvm/rubies/ruby-2.6.3/lib/ruby/gems/2.6.0/gems/thor-0.20.3/lib/thor/base.rb:466:in `start'\n    21: from /Users/alex/.rvm/rubies/ruby-2.6.3/lib/ruby/gems/2.6.0/gems/thor-0.20.3/lib/thor.rb:387:in `dispatch'\n    20: from /Users/alex/.rvm/rubies/ruby-2.6.3/lib/ruby/gems/2.6.0/gems/thor-0.20.3/lib/thor/invocation.rb:126:in `invoke_command'\n    19: from /Users/alex/.rvm/rubies/ruby-2.6.3/lib/ruby/gems/2.6.0/gems/thor-0.20.3/lib/thor/command.rb:27:in `run'\n    18: from bin/load-test:44:in `setup'\n    17: from bin/load-test:44:in `times'\n    16: from bin/load-test:47:in `block in setup'\n    15: from /Users/alex/.rvm/rubies/ruby-2.6.3/lib/ruby/gems/2.6.0/gems/google-cloud-firestore-1.1.0/lib/google/cloud/firestore/document_reference.rb:322:in `set'\n    14: from /Users/alex/.rvm/rubies/ruby-2.6.3/lib/ruby/gems/2.6.0/gems/google-cloud-firestore-1.1.0/lib/google/cloud/firestore/client.rb:582:in `batch'\n    13: from /Users/alex/.rvm/rubies/ruby-2.6.3/lib/ruby/gems/2.6.0/gems/google-cloud-firestore-1.1.0/lib/google/cloud/firestore/batch.rb:403:in `commit'\n    12: from /Users/alex/.rvm/rubies/ruby-2.6.3/lib/ruby/gems/2.6.0/gems/google-cloud-firestore-1.1.0/lib/google/cloud/firestore/service.rb:159:in `commit'\n    11: from /Users/alex/.rvm/rubies/ruby-2.6.3/lib/ruby/gems/2.6.0/gems/google-cloud-firestore-1.1.0/lib/google/cloud/firestore/service.rb:208:in `execute'\n    10: from /Users/alex/.rvm/rubies/ruby-2.6.3/lib/ruby/gems/2.6.0/gems/google-cloud-firestore-1.1.0/lib/google/cloud/firestore/service.rb:160:in `block in commit'\n     9: from /Users/alex/.rvm/rubies/ruby-2.6.3/lib/ruby/gems/2.6.0/gems/google-cloud-firestore-1.1.0/lib/google/cloud/firestore/v1/firestore_client.rb:846:in `commit'\n     8: from /Users/alex/.rvm/rubies/ruby-2.6.3/lib/ruby/gems/2.6.0/gems/google-gax-1.7.1/lib/google/gax/api_callable.rb:260:in `block in create_api_call'\n     7: from /Users/alex/.rvm/rubies/ruby-2.6.3/lib/ruby/gems/2.6.0/gems/google-gax-1.7.1/lib/google/gax/api_callable.rb:230:in `block in create_api_call'\n     6: from /Users/alex/.rvm/rubies/ruby-2.6.3/lib/ruby/gems/2.6.0/gems/google-gax-1.7.1/lib/google/gax/api_callable.rb:401:in `block in add_timeout_arg'\n     5: from /Users/alex/.rvm/rubies/ruby-2.6.3/lib/ruby/gems/2.6.0/gems/grpc-1.24.0-universal-darwin/src/ruby/lib/grpc/generic/client_stub.rb:171:in `block in request_response'\n     4: from /Users/alex/.rvm/rubies/ruby-2.6.3/lib/ruby/gems/2.6.0/gems/grpc-1.24.0-universal-darwin/src/ruby/lib/grpc/generic/interceptors.rb:170:in `intercept!'\n     3: from /Users/alex/.rvm/rubies/ruby-2.6.3/lib/ruby/gems/2.6.0/gems/grpc-1.24.0-universal-darwin/src/ruby/lib/grpc/generic/client_stub.rb:172:in `block (2 levels) in request_response'\n     2: from /Users/alex/.rvm/rubies/ruby-2.6.3/lib/ruby/gems/2.6.0/gems/grpc-1.24.0-universal-darwin/src/ruby/lib/grpc/generic/active_call.rb:377:in `request_response'\n     1: from /Users/alex/.rvm/rubies/ruby-2.6.3/lib/ruby/gems/2.6.0/gems/grpc-1.24.0-universal-darwin/src/ruby/lib/grpc/generic/active_call.rb:181:in `attach_status_results_and_complete_call'\n/Users/alex/.rvm/rubies/ruby-2.6.3/lib/ruby/gems/2.6.0/gems/grpc-1.24.0-universal-darwin/src/ruby/lib/grpc/generic/active_call.rb:31:in `check_status': 4:Deadline Exceeded (GRPC::DeadlineExceeded)\n    16: from bin/load-test:129:in `&lt;main&gt;'\n    15: from /Users/alex/.rvm/rubies/ruby-2.6.3/lib/ruby/gems/2.6.0/gems/thor-0.20.3/lib/thor/base.rb:466:in `start'\n    14: from /Users/alex/.rvm/rubies/ruby-2.6.3/lib/ruby/gems/2.6.0/gems/thor-0.20.3/lib/thor.rb:387:in `dispatch'\n    13: from /Users/alex/.rvm/rubies/ruby-2.6.3/lib/ruby/gems/2.6.0/gems/thor-0.20.3/lib/thor/invocation.rb:126:in `invoke_command'\n    12: from /Users/alex/.rvm/rubies/ruby-2.6.3/lib/ruby/gems/2.6.0/gems/thor-0.20.3/lib/thor/command.rb:27:in `run'\n    11: from bin/load-test:44:in `setup'\n    10: from bin/load-test:44:in `times'\n     9: from bin/load-test:47:in `block in setup'\n     8: from /Users/alex/.rvm/rubies/ruby-2.6.3/lib/ruby/gems/2.6.0/gems/google-cloud-firestore-1.1.0/lib/google/cloud/firestore/document_reference.rb:322:in `set'\n     7: from /Users/alex/.rvm/rubies/ruby-2.6.3/lib/ruby/gems/2.6.0/gems/google-cloud-firestore-1.1.0/lib/google/cloud/firestore/client.rb:582:in `batch'\n     6: from /Users/alex/.rvm/rubies/ruby-2.6.3/lib/ruby/gems/2.6.0/gems/google-cloud-firestore-1.1.0/lib/google/cloud/firestore/batch.rb:403:in `commit'\n     5: from /Users/alex/.rvm/rubies/ruby-2.6.3/lib/ruby/gems/2.6.0/gems/google-cloud-firestore-1.1.0/lib/google/cloud/firestore/service.rb:159:in `commit'\n     4: from /Users/alex/.rvm/rubies/ruby-2.6.3/lib/ruby/gems/2.6.0/gems/google-cloud-firestore-1.1.0/lib/google/cloud/firestore/service.rb:208:in `execute'\n     3: from /Users/alex/.rvm/rubies/ruby-2.6.3/lib/ruby/gems/2.6.0/gems/google-cloud-firestore-1.1.0/lib/google/cloud/firestore/service.rb:160:in `block in commit'\n     2: from /Users/alex/.rvm/rubies/ruby-2.6.3/lib/ruby/gems/2.6.0/gems/google-cloud-firestore-1.1.0/lib/google/cloud/firestore/v1/firestore_client.rb:846:in `commit'\n     1: from /Users/alex/.rvm/rubies/ruby-2.6.3/lib/ruby/gems/2.6.0/gems/google-gax-1.7.1/lib/google/gax/api_callable.rb:259:in `block in create_api_call'\n/Users/alex/.rvm/rubies/ruby-2.6.3/lib/ruby/gems/2.6.0/gems/google-gax-1.7.1/lib/google/gax/api_callable.rb:264:in `rescue in block in create_api_call': GaxError RPC failed, caused by 4:Deadline Exceeded (Google::Gax::DeadlineExceededError)\n    13: from bin/load-test:129:in `&lt;main&gt;'\n    12: from /Users/alex/.rvm/rubies/ruby-2.6.3/lib/ruby/gems/2.6.0/gems/thor-0.20.3/lib/thor/base.rb:466:in `start'\n    11: from /Users/alex/.rvm/rubies/ruby-2.6.3/lib/ruby/gems/2.6.0/gems/thor-0.20.3/lib/thor.rb:387:in `dispatch'\n    10: from /Users/alex/.rvm/rubies/ruby-2.6.3/lib/ruby/gems/2.6.0/gems/thor-0.20.3/lib/thor/invocation.rb:126:in `invoke_command'\n     9: from /Users/alex/.rvm/rubies/ruby-2.6.3/lib/ruby/gems/2.6.0/gems/thor-0.20.3/lib/thor/command.rb:27:in `run'\n     8: from bin/load-test:44:in `setup'\n     7: from bin/load-test:44:in `times'\n     6: from bin/load-test:47:in `block in setup'\n     5: from /Users/alex/.rvm/rubies/ruby-2.6.3/lib/ruby/gems/2.6.0/gems/google-cloud-firestore-1.1.0/lib/google/cloud/firestore/document_reference.rb:322:in `set'\n     4: from /Users/alex/.rvm/rubies/ruby-2.6.3/lib/ruby/gems/2.6.0/gems/google-cloud-firestore-1.1.0/lib/google/cloud/firestore/client.rb:582:in `batch'\n     3: from /Users/alex/.rvm/rubies/ruby-2.6.3/lib/ruby/gems/2.6.0/gems/google-cloud-firestore-1.1.0/lib/google/cloud/firestore/batch.rb:403:in `commit'\n     2: from /Users/alex/.rvm/rubies/ruby-2.6.3/lib/ruby/gems/2.6.0/gems/google-cloud-firestore-1.1.0/lib/google/cloud/firestore/service.rb:159:in `commit'\n     1: from /Users/alex/.rvm/rubies/ruby-2.6.3/lib/ruby/gems/2.6.0/gems/google-cloud-firestore-1.1.0/lib/google/cloud/firestore/service.rb:207:in `execute'\n/Users/alex/.rvm/rubies/ruby-2.6.3/lib/ruby/gems/2.6.0/gems/google-cloud-firestore-1.1.0/lib/google/cloud/firestore/service.rb:211:in `rescue in execute': 4:Deadline Exceeded (Google::Cloud::DeadlineExceededError)\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-6"], "answers": [{"tags": [], "owner": {"reputation": 116, "user_id": 5975852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a231e93f312cd6eff139701a31f4a5bd?s=128&d=identicon&r=PG", "display_name": "Marcus Havranek", "link": "https://stackoverflow.com/users/5975852/marcus-havranek"}, "is_accepted": true, "score": 0, "last_activity_date": 1571085037, "creation_date": 1571085037, "answer_id": 58383683, "question_id": 58381744, "link": "https://stackoverflow.com/questions/58381744/how-to-use-rails-web-app-as-ruby-script-input-and-output/58383683#58383683", "title": "How to use Rails Web App as ruby script input and output", "body": "<p>I think you are thinking about this the wrong way around. What you want is more \"a web app/web form that does something with input\". Rails might be too much for your use case. If you are not bound to Rails you might want to look into other / lighter web frameworks in ruby like Sinatra or Hanami. This could help: <a href=\"https://stackoverflow.com/questions/9418597/run-ruby-script-from-a-html-form\">Run ruby script from a HTML form</a></p>\n"}], "owner": {"reputation": 59, "user_id": 6272532, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-INtAIiFdEtw/AAAAAAAAAAI/AAAAAAAABS4/mh7H3fOz4aw/photo.jpg?sz=128", "display_name": "Gregorio Pompei", "link": "https://stackoverflow.com/users/6272532/gregorio-pompei"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 32, "favorite_count": 0, "accepted_answer_id": 58383683, "answer_count": 1, "score": 0, "last_activity_date": 1571085037, "creation_date": 1571075175, "question_id": 58381744, "link": "https://stackoverflow.com/questions/58381744/how-to-use-rails-web-app-as-ruby-script-input-and-output", "title": "How to use Rails Web App as ruby script input and output", "body": "<p>I'm new to rails and I'm working on this project:\nI have done a ruby script which needs an input and that prints some outputs.\nBasically it takes the first <em>n</em> decimal digits of PI and then it calculates some stats.\nI need to use a rails web app to insert the input, which is a number, and to print the decimal digits and 10 stats rows.</p>\n\n<hr>\n\n<p>This is the ruby script</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>require 'bigdecimal/math'\n#PI decimals generator\ni = 0\nj = 0\na_pi = Array.new\nprint \"Insert how many digits do you want to calculate: \"\ndig_n = gets.chomp.to_i\nx = BigMath.PI(dig_n)\na_pi = x.to_s.split('')\n\nbegin\n  a_pi.shift\n  i += 1\nend until i == 3\n\narr_length = a_pi.length\n\nbegin\n  a_pi.pop\n  j += 1\nend until j == arr_length - dig_n\n\npi_dec = a_pi.join.to_i\nputs pi_dec\n</code></pre>\n\n<p>I'm using Ruby 2.6 and Rails 6</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "carrierwave"], "answers": [{"tags": [], "owner": {"reputation": 2345, "user_id": 4988918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/x1BRI.png?s=128&g=1", "display_name": "Mark Merritt", "link": "https://stackoverflow.com/users/4988918/mark-merritt"}, "is_accepted": true, "score": 1, "last_activity_date": 1571087787, "creation_date": 1571087787, "answer_id": 58384172, "question_id": 58381706, "link": "https://stackoverflow.com/questions/58381706/how-does-attribute-changed-work-with-carrierwave-mount-uploader-attribute/58384172#58384172", "title": "How does &quot;[attribute]_changed?&quot; work with CarrierWave mount_uploader :[attribute]?", "body": "<p><code>some_attr_changed?</code> is an instance method so you need to call it on an instance of your model. </p>\n\n<p>So, instead of this...</p>\n\n<pre><code>before_validation :parse_template_file, if: :template_file_changed?\n</code></pre>\n\n<p>Try something like this...</p>\n\n<pre><code>before_validation :parse_template_file, if: :file_changed?\n\nprivate\n\ndef file_changed?\n  self.template_file_changed?  # self can be implied\nend\n</code></pre>\n"}], "owner": {"reputation": 39, "user_id": 7535204, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/554057e822f577cdf5e9b701a0fe0df1?s=128&d=identicon&r=PG&f=1", "display_name": "Eugene", "link": "https://stackoverflow.com/users/7535204/eugene"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 100, "favorite_count": 0, "accepted_answer_id": 58384172, "answer_count": 1, "score": 0, "last_activity_date": 1571087787, "creation_date": 1571075042, "question_id": 58381706, "link": "https://stackoverflow.com/questions/58381706/how-does-attribute-changed-work-with-carrierwave-mount-uploader-attribute", "title": "How does &quot;[attribute]_changed?&quot; work with CarrierWave mount_uploader :[attribute]?", "body": "<p>I have got CarrierWave uploader in my model.</p>\n\n<pre><code>before_validation :parse_template_file, if: :template_file_changed?\nmount_uploader :template_file\n</code></pre>\n\n<p>My code above doesn't work throwing  <code>NoMethodError template_file_changed?</code>.</p>\n\n<p>How can I check the file was changed before saving the record?</p>\n"}, {"tags": ["ruby", "string", "null", "assign"], "comments": [{"owner": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "edited": false, "score": 0, "creation_date": 1571072658, "post_id": 58381145, "comment_id": 103110634, "body": "For the safe navigation operator you must add a dot <code>.</code> (<code>&#39;&#39; &amp;.&lt;&lt; &#39;foo&#39;</code>, <code>nil .&lt;&lt; &#39;foo&#39;</code>)"}, {"owner": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "edited": false, "score": 0, "creation_date": 1571072784, "post_id": 58381145, "comment_id": 103110683, "body": "The easiest is to use the safe navigation operator. But depending on the context of your question, there might be a better approach."}, {"owner": {"reputation": 394580, "user_id": 479863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ArUCE.jpg?s=128&g=1", "display_name": "mu is too short", "link": "https://stackoverflow.com/users/479863/mu-is-too-short"}, "edited": false, "score": 3, "creation_date": 1571073843, "post_id": 58381145, "comment_id": 103111108, "body": "But if <code>summary = nil</code> and you <code>summary &amp;.&lt;&lt; &#39;foo&#39;</code>, you&#39;re still left with <code>summary.nil?</code> being true. You&#39;re stuck because you have to change what <code>summary</code> refers to and the only sane way of doing that is to use an assignment. So why can <code>summary</code> be <code>nil</code> at all? Why can&#39;t you initialize it to an empty string?"}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "reply_to_user": {"reputation": 394580, "user_id": 479863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ArUCE.jpg?s=128&g=1", "display_name": "mu is too short", "link": "https://stackoverflow.com/users/479863/mu-is-too-short"}, "edited": false, "score": 1, "creation_date": 1571074880, "post_id": 58381145, "comment_id": 103111558, "body": "Not simply <code>(summary ||= &#39;&#39;) &lt;&lt; &#39;foo&#39;</code>? @muistooshort, I could imagine something like <code>[&#39;dog&#39;, &#39;cat&#39;].find { |s| s == &#39;pig&#39; } &lt;&lt; &quot;hello&quot;</code>"}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1571075252, "post_id": 58381145, "comment_id": 103111702, "body": "@maxpleaner, alas, no Rails tag."}, {"owner": {"reputation": 2282, "user_id": 10853463, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kg5ZZ.jpg?s=128&g=1", "display_name": "red_menace", "link": "https://stackoverflow.com/users/10853463/red-menace"}, "edited": false, "score": 0, "creation_date": 1571076339, "post_id": 58381145, "comment_id": 103112120, "body": "Still a comparison, but maybe a ternary statement?  e.g. <code>summary ? summary &lt;&lt; reason : summary = reason</code>"}, {"owner": {"reputation": 3090, "user_id": 4454732, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh3.googleusercontent.com/-8OrTJkCtkn4/AAAAAAAAAAI/AAAAAAAAA4s/7jp2lrThK2k/photo.jpg?sz=128", "display_name": "David Hempy", "link": "https://stackoverflow.com/users/4454732/david-hempy"}, "edited": false, "score": 0, "creation_date": 1571078191, "post_id": 58381145, "comment_id": 103112840, "body": "Good ideas, everyone. There is no problem if <code>reason</code> is nil -- only if the destination of the shovel (&#39;summary&#39;) is nil. The critical outcome is that the value of summary changes, so safe navigation operator doesn&#39;t help (much)."}, {"owner": {"reputation": 3090, "user_id": 4454732, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh3.googleusercontent.com/-8OrTJkCtkn4/AAAAAAAAAAI/AAAAAAAAA4s/7jp2lrThK2k/photo.jpg?sz=128", "display_name": "David Hempy", "link": "https://stackoverflow.com/users/4454732/david-hempy"}, "reply_to_user": {"reputation": 394580, "user_id": 479863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ArUCE.jpg?s=128&g=1", "display_name": "mu is too short", "link": "https://stackoverflow.com/users/479863/mu-is-too-short"}, "edited": false, "score": 0, "creation_date": 1571078362, "post_id": 58381145, "comment_id": 103112907, "body": "I <i>could</i> initialize <code>summary</code> with an empty string...except someone in a galaxy far, far away is running <code>.where(&#39;summary&#39; is not null&#39;)</code> .  I&#39;m more inclined to add an <code>if</code> to my code than go chasing down other people&#39;s code elsewhere.  @muistooshort And, these reasons can be added asynchronously, so I don&#39;t have very clear before/after points to initialize/clean up the summary."}, {"owner": {"reputation": 394580, "user_id": 479863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ArUCE.jpg?s=128&g=1", "display_name": "mu is too short", "link": "https://stackoverflow.com/users/479863/mu-is-too-short"}, "reply_to_user": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 1, "creation_date": 1571094965, "post_id": 58381145, "comment_id": 103118168, "body": "@CarySwoveland I guess you could but I tend to prefer clarity over cleverness. Maybe an odd attitude in Ruby-land. I&#39;d lean towards initializing <code>summary</code> or the OP&#39;s <code>Array#join</code> solution."}, {"owner": {"reputation": 394580, "user_id": 479863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ArUCE.jpg?s=128&g=1", "display_name": "mu is too short", "link": "https://stackoverflow.com/users/479863/mu-is-too-short"}, "edited": false, "score": 1, "creation_date": 1571095380, "post_id": 58381145, "comment_id": 103118238, "body": "@DavidHempy You could start with an empty string, do whatever needs to be done, and then map empty strings back to <code>nil</code> before sending them into the database. I often do things like <code>self.whatever = whatever.to_s.mangle.presence</code> in Rails to hide a bunch of <code>nil</code> checks, the <code>#to_s</code> converts <code>nil</code> to <code>&#39;&#39;</code> while leaving strings alone and the <code>#presence</code> call converts <code>&#39;&#39;</code> to <code>nil</code> while leaving strings alone. Similar things apply to <code>nil</code>s that can be arrays or hashes as <code>NilClass#to_a</code> and <code>NilClass#to_h</code> do The Right Thing."}, {"owner": {"reputation": 3090, "user_id": 4454732, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh3.googleusercontent.com/-8OrTJkCtkn4/AAAAAAAAAAI/AAAAAAAAA4s/7jp2lrThK2k/photo.jpg?sz=128", "display_name": "David Hempy", "link": "https://stackoverflow.com/users/4454732/david-hempy"}, "reply_to_user": {"reputation": 394580, "user_id": 479863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ArUCE.jpg?s=128&g=1", "display_name": "mu is too short", "link": "https://stackoverflow.com/users/479863/mu-is-too-short"}, "edited": false, "score": 1, "creation_date": 1571103780, "post_id": 58381145, "comment_id": 103119649, "body": "I like that last idea, @muistooshort. I didn&#39;t know that <code>&#39;&#39;.presence</code> converted empty string to nil. I&#39;ll tuck that idea away for sure."}], "answers": [{"tags": [], "owner": {"reputation": 3663, "user_id": 226622, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/01cda64f5be17aec3429166eb88182cd?s=128&d=identicon&r=PG", "display_name": "Oto Brglez", "link": "https://stackoverflow.com/users/226622/oto-brglez"}, "is_accepted": true, "score": 2, "last_activity_date": 1571076416, "creation_date": 1571076416, "answer_id": 58381991, "question_id": 58381145, "link": "https://stackoverflow.com/questions/58381145/ruby-idiom-to-shovel-into-a-string-or-nil-e-g-shovel-or-assign-safe-shovel/58381991#58381991", "title": "Ruby idiom to shovel into a string or nil? (e.g. shovel or assign / safe shovel)", "body": "<p>You can solve this with something like this; with the help of <code>||</code>.</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>summary = (summary || '') + reason\n</code></pre>\n\n<p>Or like so with the help of <code>||=</code> and <code>&lt;&lt;</code>:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>(summary ||= '') &lt;&lt; reason\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 394580, "user_id": 479863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ArUCE.jpg?s=128&g=1", "display_name": "mu is too short", "link": "https://stackoverflow.com/users/479863/mu-is-too-short"}, "edited": false, "score": 1, "creation_date": 1571095075, "post_id": 58382694, "comment_id": 103118190, "body": "I actually like this better: straight forward and to the point without any unnecessary syntactical line noise or cleverness."}], "tags": [], "owner": {"reputation": 3090, "user_id": 4454732, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh3.googleusercontent.com/-8OrTJkCtkn4/AAAAAAAAAAI/AAAAAAAAA4s/7jp2lrThK2k/photo.jpg?sz=128", "display_name": "David Hempy", "link": "https://stackoverflow.com/users/4454732/david-hempy"}, "is_accepted": false, "score": 3, "last_activity_date": 1571079885, "creation_date": 1571079885, "answer_id": 58382694, "question_id": 58381145, "link": "https://stackoverflow.com/questions/58381145/ruby-idiom-to-shovel-into-a-string-or-nil-e-g-shovel-or-assign-safe-shovel/58382694#58382694", "title": "Ruby idiom to shovel into a string or nil? (e.g. shovel or assign / safe shovel)", "body": "<p>I prefer @Oto Brglez's answer, but it inspired another solution that might be useful to someone:</p>\n\n<pre><code>summary = [summary, reason].join\n</code></pre>\n\n<p>This may or may not be easier to read, and probably is less performant. But it handles the nil summary problem without explicit alternation. </p>\n"}], "owner": {"reputation": 3090, "user_id": 4454732, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh3.googleusercontent.com/-8OrTJkCtkn4/AAAAAAAAAAI/AAAAAAAAA4s/7jp2lrThK2k/photo.jpg?sz=128", "display_name": "David Hempy", "link": "https://stackoverflow.com/users/4454732/david-hempy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 136, "favorite_count": 0, "accepted_answer_id": 58381991, "answer_count": 2, "score": 0, "last_activity_date": 1571081113, "creation_date": 1571072454, "last_edit_date": 1571081113, "question_id": 58381145, "link": "https://stackoverflow.com/questions/58381145/ruby-idiom-to-shovel-into-a-string-or-nil-e-g-shovel-or-assign-safe-shovel", "title": "Ruby idiom to shovel into a string or nil? (e.g. shovel or assign / safe shovel)", "body": "<p>I'd like to do this:</p>\n\n<pre><code>summary &lt;&lt; reason\n</code></pre>\n\n<p>In my case, <code>summary</code> is a string, containing several sentences, and <code>reason</code> is one such sentence.</p>\n\n<p>This works fine if the target already has a value, but sometimes <code>summary</code> can be <code>nil</code>. In that case, this raises:</p>\n\n<pre><code>NoMethodError: undefined method `&lt;&lt;' for nil:NilClass\n</code></pre>\n\n<p>So, I could write something like this:</p>\n\n<pre><code>if summary \n  summary &lt;&lt; reason\nelse \n  summary = reason\nend\n</code></pre>\n\n<p>This is cumbersome and ugly. I can hide it away in a new method like <code>append(summary, reason)</code>, but I'm hoping there's a ruby idiom that can wrap this up concisely. </p>\n\n<p>I've optimistically tried a few variants, without success:</p>\n\n<pre><code>summary += reason\nsummary &amp;&lt;&lt; reason\n</code></pre>\n\n<p>In other scenarios, I might build an array of reasons (you can shovel into an empty array just fine), then finally join them into a summary...but that's not viable in my current project.</p>\n\n<p>I also can't seed summary with an empty string (shoveling into an empty string also works fine), as other code depends on it being nil at times.</p>\n\n<p>So, is there a \"safe shovel\" or simple \"shovel or assign\" idiom in Ruby, particularly for strings that might be nil?</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "answers": [{"tags": [], "owner": {"reputation": 96, "user_id": 7364610, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c47e66c4ebc4cdc0e71ca75ff9252f3?s=128&d=identicon&r=PG&f=1", "display_name": "Riseagain", "link": "https://stackoverflow.com/users/7364610/riseagain"}, "is_accepted": false, "score": 1, "last_activity_date": 1571068425, "creation_date": 1571068425, "answer_id": 58380199, "question_id": 58379982, "link": "https://stackoverflow.com/questions/58379982/rails-dont-rollback-and-dont-update-attribute-either/58380199#58380199", "title": "Rails don&#39;t rollback and don&#39;t update attribute either", "body": "<p>You can not update counter cache column in Rails, because it is added to the containing model's list of read-only attributes through <code>attr_readonly</code>. Instead you should use <code>update_counters</code> or <code>reset_counters</code>.</p>\n"}], "owner": {"reputation": 1285, "user_id": 10443890, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de817ef35c4a2bdd0501efbdc6d9a338?s=128&d=identicon&r=PG&f=1", "display_name": "mr_muscle", "link": "https://stackoverflow.com/users/10443890/mr-muscle"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 46, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1571068425, "creation_date": 1571067477, "question_id": 58379982, "link": "https://stackoverflow.com/questions/58379982/rails-dont-rollback-and-dont-update-attribute-either", "title": "Rails don&#39;t rollback and don&#39;t update attribute either", "body": "<p>In the terminal (later I need to add this to the migration) I want to update <code>total_campaign_codes_amount</code> which represents all campaign codes for each credit campaign. This field is a counter_cache and to do so in terminal I've got this script:</p>\n\n<pre><code>CreditCampaign.all.each do |cc|\n  cc.update!(\n    total_campaign_codes_amount: cc.campaign_codes.count\n  )\nend\n</code></pre>\n\n<p>I didn't received any errors in my sql, everything should worked but these values are not saved to - <code>total_campaign_codes_amount</code> for each CreditCampaign shows 0.</p>\n\n<pre><code>  CreditCampaign Update (0.2ms)  UPDATE \"credit_campaigns\" SET \"updated_at\" = $1 WHERE \"credit_campaigns\".\"id\" = $2  [[\"updated_at\", \"2019-10-14 15:26:54.010779\"], [\"id\", 1]]\n   (0.4ms)  COMMIT\n   (0.2ms)  SELECT COUNT(*) FROM \"campaign_codes\" WHERE \"campaign_codes\".\"credit_campaign_id\" = $1  [[\"credit_campaign_id\", 2]]\n   (0.1ms)  BEGIN\n  CreditCampaign Update (0.2ms)  UPDATE \"credit_campaigns\" SET \"updated_at\" = $1 WHERE \"credit_campaigns\".\"id\" = $2  [[\"updated_at\", \"2019-10-14 15:26:54.013239\"], [\"id\", 2]]\n   (0.2ms)  COMMIT\n =&gt; [#&lt;CreditCampaign id: 1, amount: 0.25e3, interest_rate: 0.12e2, installment_amount: 0.1e3, duration_in_months: 24, start_date: \"2019-10-10\", end_date: \"2019-11-10\", created_at: \"2019-10-10 14:54:27\", updated_at: \"2019-10-14 15:26:54\", name: \"Credit Campaign #1\", total_campaign_codes_amount: 15, used_campaign_codes_amount: 6&gt;, #&lt;CreditCampaign id: 2, amount: 0.1e1, interest_rate: 0.1e1, installment_amount: 0.1e1, duration_in_months: 1, start_date: \"2011-01-01\", end_date: \"2020-01-01\", created_at: \"2019-10-14 13:40:02\", updated_at: \"2019-10-14 15:26:54\", name: \"test\", total_campaign_codes_amount: 10, used_campaign_codes_amount: 0&gt;]\n</code></pre>\n\n<p>I was trying to use <code>update_attributes!</code> instead of <code>update!</code> and <code>find_each</code> instead of <code>all.each</code> but without any results.</p>\n"}, {"tags": ["ruby", "plugins", "redis", "logstash", "elk"], "comments": [{"owner": {"reputation": 5122, "user_id": 1123206, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f2e6bbd4548aa3f2d748646da4bc073?s=128&d=identicon&r=PG", "display_name": "leandrojmp", "link": "https://stackoverflow.com/users/1123206/leandrojmp"}, "edited": false, "score": 1, "creation_date": 1571154213, "post_id": 58379149, "comment_id": 103142136, "body": "The <code>logstash-filter-redis</code> is not bundled with logstash and it seems that the developer didn&#39;t update it in years, you can try to install it, but it probably won&#39;t work with the newer versions."}], "answers": [{"comments": [{"owner": {"reputation": 700, "user_id": 150878, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/b569a616b13eda9dfea07719a8dc2acc?s=128&d=identicon&r=PG", "display_name": "sami", "link": "https://stackoverflow.com/users/150878/sami"}, "edited": false, "score": 3, "creation_date": 1580451932, "post_id": 59300363, "comment_id": 106109167, "body": "thanks for sharing this - the suggested approach above worked for me - a couple of additional things - you will need to add the redis gem first (<a href=\"https://stackoverflow.com/a/54224889/150878\">stackoverflow.com/a/54224889/150878</a>) and if you have a remote server, use this: $rc = Redis.new(host: &quot;&lt;host_ip&gt;&quot;, port: &lt;host_port&gt;)"}, {"owner": {"reputation": 449, "user_id": 6076655, "user_type": "registered", "accept_rate": 60, "profile_image": "https://lh5.googleusercontent.com/-4XzrxOa_mfA/AAAAAAAAAAI/AAAAAAAAABo/C7YXXfUm7io/photo.jpg?sz=128", "display_name": "Rohail Abbas", "link": "https://stackoverflow.com/users/6076655/rohail-abbas"}, "edited": false, "score": 0, "creation_date": 1581576686, "post_id": 59300363, "comment_id": 106483073, "body": "Thank you @Val. It surely helped and we used the same to serve the purpose. No other filter worked."}, {"owner": {"reputation": 163519, "user_id": 4604579, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/reC2t.jpg?s=128&g=1", "display_name": "Val", "link": "https://stackoverflow.com/users/4604579/val"}, "edited": false, "score": 0, "creation_date": 1581576965, "post_id": 59300363, "comment_id": 106483185, "body": "Awesome, glad it helped!"}], "tags": [], "owner": {"reputation": 163519, "user_id": 4604579, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/reC2t.jpg?s=128&g=1", "display_name": "Val", "link": "https://stackoverflow.com/users/4604579/val"}, "is_accepted": true, "score": 3, "last_activity_date": 1576139083, "creation_date": 1576139083, "answer_id": 59300363, "question_id": 58379149, "link": "https://stackoverflow.com/questions/58379149/how-to-use-redis-inside-logstash-filter/59300363#59300363", "title": "How to use redis inside logstash filter?", "body": "<p>There are indeed no supported Redis filters in Logstash. You can find two community filters <a href=\"https://github.com/synlay/logstash-filter-cache-redis\" rel=\"nofollow noreferrer\">by synlay</a> and <a href=\"https://github.com/meulop/logstash-filter-redis\" rel=\"nofollow noreferrer\">meulop</a> but I'm unsure how well they are supported and maintained.</p>\n\n<p>I just learned recently another way of enriching your data from Redis by accessing Redis through a <code>ruby</code> filter like this :</p>\n\n<pre><code>filter {\n   ...\n   ruby {\n      init =&gt; 'require \"redis\"; $rc = Redis.new(path: \"/var/run/redis/redis.sock\", db: 0)'\n      code =&gt; 'event.set(\"enriched_field\", $rc.get(event.get(\"key_field\")))'\n   }\n}\n</code></pre>\n"}], "owner": {"reputation": 449, "user_id": 6076655, "user_type": "registered", "accept_rate": 60, "profile_image": "https://lh5.googleusercontent.com/-4XzrxOa_mfA/AAAAAAAAAAI/AAAAAAAAABo/C7YXXfUm7io/photo.jpg?sz=128", "display_name": "Rohail Abbas", "link": "https://stackoverflow.com/users/6076655/rohail-abbas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1114, "favorite_count": 1, "accepted_answer_id": 59300363, "answer_count": 1, "score": 0, "last_activity_date": 1576139110, "creation_date": 1571064339, "last_edit_date": 1576139110, "question_id": 58379149, "link": "https://stackoverflow.com/questions/58379149/how-to-use-redis-inside-logstash-filter", "title": "How to use redis inside logstash filter?", "body": "<p>I am upgrading my ELK+Redis from a very old version to the latest one.</p>\n\n<pre><code>ES 1.6 to 7.4\nLS 1.4 to 7.4\nRedis 2.8 to 5.0\n</code></pre>\n\n<p>I freshly installed everything in a fresh machine. Things went smooth except one thing: logstash-filter-redis plugin</p>\n\n<p>Here is my logstash conf file </p>\n\n<pre><code>input\n  {\n    redis {\n      host\n      port =&gt; 6380\n      data_type\n      key\n    }\n  }\nfilter {\n  grok {\n    match =&gt; [ \"message\", \"\" ]\n  }\n  redis {\n    host =&gt; \"\"\n    port =&gt; 6379\n    key =&gt; \"\"\n    }\noutput {\n  elasticsearch {\n    host =&gt; \"\"\n    index =&gt; \"\"\n  }\n</code></pre>\n\n<p>Here, the first redis:6380 inside input { } is being used to fetch logs (working as logstash input source)</p>\n\n<p>while second redis:6379 is being called inside filter { } to get data associated with those logs.</p>\n\n<p>I cannot see any logstash-filter-redis plugin at <a href=\"https://www.elastic.co/guide/en/logstash/current/filter-plugins.html\" rel=\"nofollow noreferrer\">https://www.elastic.co/guide/en/logstash/current/filter-plugins.html</a></p>\n\n<p>Can someone please help me with that?</p>\n\n<p>Thanks</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "forms", "ruby-on-rails-3"], "comments": [{"owner": {"reputation": 13378, "user_id": 1430810, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/v669u.jpg?s=128&g=1", "display_name": "arieljuod", "link": "https://stackoverflow.com/users/1430810/arieljuod"}, "edited": false, "score": 1, "creation_date": 1571062481, "post_id": 58378569, "comment_id": 103105799, "body": "What does &quot;doesn&#39;t work&quot; mean? be more specific. What happens and what should happen? Do you have any error? anything?"}, {"owner": {"reputation": 5060, "user_id": 10522579, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7GQ6a.jpg?s=128&g=1", "display_name": "ray", "link": "https://stackoverflow.com/users/10522579/ray"}, "reply_to_user": {"reputation": 13378, "user_id": 1430810, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/v669u.jpg?s=128&g=1", "display_name": "arieljuod", "link": "https://stackoverflow.com/users/1430810/arieljuod"}, "edited": false, "score": 0, "creation_date": 1571062675, "post_id": 58378569, "comment_id": 103105906, "body": "@arieljuod OP want to say selected players did not fight on submit"}, {"owner": {"reputation": 157, "user_id": 9322828, "user_type": "registered", "profile_image": "https://graph.facebook.com/10215722452876336/picture?type=large", "display_name": "Damien Comp&#232;re", "link": "https://stackoverflow.com/users/9322828/damien-comp%c3%a8re"}, "edited": false, "score": 0, "creation_date": 1571062867, "post_id": 58378569, "comment_id": 103106022, "body": "Oups sorry, i have the error : Encountered a syntax error while rendering template on my line &quot;&lt;%= form_tag (&quot;/fight&quot;, :method =&gt; &quot;get&quot;) do %&gt;&quot;"}, {"owner": {"reputation": 2251, "user_id": 9785060, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IUduC.png?s=128&g=1", "display_name": "Viktor", "link": "https://stackoverflow.com/users/9785060/viktor"}, "edited": false, "score": 1, "creation_date": 1571062913, "post_id": 58378569, "comment_id": 103106045, "body": "Edit the question instead of posting additional info in the comment section"}, {"owner": {"reputation": 2251, "user_id": 9785060, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IUduC.png?s=128&g=1", "display_name": "Viktor", "link": "https://stackoverflow.com/users/9785060/viktor"}, "edited": false, "score": 0, "creation_date": 1571063066, "post_id": 58378569, "comment_id": 103106122, "body": "I think you want a <code>submit_tag</code> or something instead of  <code>&lt;%= form.submit &#39;Fight&#39; %&gt;</code>.  <code>form</code> isn&#39;t defined anywhere"}, {"owner": {"reputation": 157, "user_id": 9322828, "user_type": "registered", "profile_image": "https://graph.facebook.com/10215722452876336/picture?type=large", "display_name": "Damien Comp&#232;re", "link": "https://stackoverflow.com/users/9322828/damien-comp%c3%a8re"}, "edited": false, "score": 0, "creation_date": 1571063225, "post_id": 58378569, "comment_id": 103106210, "body": "Thanks for your answer, I edited my post and also tried with submit tag, but still the same error"}], "answers": [{"comments": [{"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 2, "creation_date": 1571063731, "post_id": 58378957, "comment_id": 103106471, "body": "That may be a &quot;better&quot; way to write it, but it should get the same result?... I don&#39;t understand OP&#39;s error, and I don&#39;t know why this would solve it."}, {"owner": {"reputation": 2251, "user_id": 9785060, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IUduC.png?s=128&g=1", "display_name": "Viktor", "link": "https://stackoverflow.com/users/9785060/viktor"}, "edited": false, "score": 0, "creation_date": 1571063989, "post_id": 58378957, "comment_id": 103106638, "body": "Why can&#39;t you put a space between the method call and arguments ? This seems weird"}, {"owner": {"reputation": 5060, "user_id": 10522579, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7GQ6a.jpg?s=128&g=1", "display_name": "ray", "link": "https://stackoverflow.com/users/10522579/ray"}, "reply_to_user": {"reputation": 2251, "user_id": 9785060, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IUduC.png?s=128&g=1", "display_name": "Viktor", "link": "https://stackoverflow.com/users/9785060/viktor"}, "edited": false, "score": 0, "creation_date": 1571064236, "post_id": 58378957, "comment_id": 103106797, "body": "@\u0412\u0438\u043a\u0442\u043e\u0440 This is basic you should know, read <a href=\"https://stackoverflow.com/a/16533154/10522579\">here</a>"}, {"owner": {"reputation": 157, "user_id": 9322828, "user_type": "registered", "profile_image": "https://graph.facebook.com/10215722452876336/picture?type=large", "display_name": "Damien Comp&#232;re", "link": "https://stackoverflow.com/users/9322828/damien-comp%c3%a8re"}, "edited": false, "score": 0, "creation_date": 1571064271, "post_id": 58378957, "comment_id": 103106818, "body": "thanks for your answer, i changed the line but now i got the error &quot;undefined method `select_field&#39; &quot;, should I use select_tag instead of select_field ?"}, {"owner": {"reputation": 2251, "user_id": 9785060, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IUduC.png?s=128&g=1", "display_name": "Viktor", "link": "https://stackoverflow.com/users/9785060/viktor"}, "edited": false, "score": 0, "creation_date": 1571065188, "post_id": 58378957, "comment_id": 103107294, "body": "@ray Well now I do :) <a href=\"https://stackoverflow.com/questions/26480823/why-does-white-space-affect-ruby-function-calls\">here&#39;s</a> another explanation on the issue if anyone else didn&#39;t know this."}, {"owner": {"reputation": 157, "user_id": 9322828, "user_type": "registered", "profile_image": "https://graph.facebook.com/10215722452876336/picture?type=large", "display_name": "Damien Comp&#232;re", "link": "https://stackoverflow.com/users/9322828/damien-comp%c3%a8re"}, "edited": false, "score": 0, "creation_date": 1571065378, "post_id": 58378957, "comment_id": 103107378, "body": "Thanks ! Here is my final code &quot;select_tag &#39;character_id&#39;, options_for_select(@characters.collect{ |u| [u.name, u.id] })&quot; and the display is OK !"}], "tags": [], "owner": {"reputation": 5060, "user_id": 10522579, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7GQ6a.jpg?s=128&g=1", "display_name": "ray", "link": "https://stackoverflow.com/users/10522579/ray"}, "is_accepted": true, "score": 2, "last_activity_date": 1571063751, "last_edit_date": 1571063751, "creation_date": 1571063627, "answer_id": 58378957, "question_id": 58378569, "link": "https://stackoverflow.com/questions/58378569/how-to-get-with-ruby-on-rails-form/58378957#58378957", "title": "how to &quot;get&quot; with Ruby on rails form", "body": "<p>Error occured due to space provided between method <code>form_tag</code> and arguments provided in brackets, it should be like,</p>\n\n<pre><code>form_tag(\"/fight\", :method =&gt; \"get\")\n</code></pre>\n\n<p>You can also write in following manners,</p>\n\n<pre><code>&lt;%= form_tag fight_path, method: \"get\" do %&gt;\n</code></pre>\n\n<p>or</p>\n\n<pre><code>&lt;%= form_tag url: \"fight\", method: \"get\" do %&gt;\n</code></pre>\n"}], "owner": {"reputation": 157, "user_id": 9322828, "user_type": "registered", "profile_image": "https://graph.facebook.com/10215722452876336/picture?type=large", "display_name": "Damien Comp&#232;re", "link": "https://stackoverflow.com/users/9322828/damien-comp%c3%a8re"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 124, "favorite_count": 0, "accepted_answer_id": 58378957, "answer_count": 1, "score": 2, "last_activity_date": 1571063751, "creation_date": 1571062193, "last_edit_date": 1571063354, "question_id": 58378569, "link": "https://stackoverflow.com/questions/58378569/how-to-get-with-ruby-on-rails-form", "title": "how to &quot;get&quot; with Ruby on rails form", "body": "<p>I try get 2 players from a list that i created, all I need is to get all the informations about those 2 players (name, descrption etc...) and once i have selected both, I need to be redirected to /fight path. My form doesnt work and I don't understand why.</p>\n\n<p>I have the error encountered a syntax error while rendering template on line <code>&lt;%= form_tag (\"/fight\", :method =&gt; \"get\") do %&gt;</code></p>\n\n<p>Could someone help me please ? </p>\n\n<p>Here is my view : </p>\n\n<pre><code>&lt;%= form_tag (\"/fight\", :method =&gt; \"get\") do %&gt;\n  &lt;%= label_tag :player1 %&gt;\n  &lt;%= select_field :character, @characters.collect{|u| [u.name, u.id]} %&gt;\n  &lt;%= label_tag :playe2 %&gt;\n  &lt;%= select_field :character, @characters.collect{|u| [u.name, u.id]} %&gt;\n  &lt;%= submit_tag 'Fight' %&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>My pages_controller</p>\n\n<pre><code>def index \n  @characters = Character.all\nend\n</code></pre>\n\n<p>And my routes </p>\n\n<pre><code>get 'fight' =&gt; 'pages#index'\n</code></pre>\n"}, {"tags": ["ruby", "encryption", "openssl", "cryptography", "tls1.2"], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 12119143, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mDBycXn6tEwlMmi753FD8p-Dk8GhrLrnxbCRSJM=k-s128", "display_name": "chenxi li", "link": "https://stackoverflow.com/users/12119143/chenxi-li"}, "is_accepted": false, "score": 0, "last_activity_date": 1571151139, "creation_date": 1571151139, "answer_id": 58397452, "question_id": 58378447, "link": "https://stackoverflow.com/questions/58378447/a-very-strange-phenomenon-when-decrypt-aes-128-gcm-tls-package-using-openssl-in/58397452#58397452", "title": "A Very Strange phenomenon when decrypt aes-128-gcm tls package using OpenSSL in ruby", "body": "<p>I have solved this question eventually!\nIf anyone want to use this test vector, do not forget to add \"789c\" as zlib compress</p>\n"}], "owner": {"reputation": 1, "user_id": 12119143, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mDBycXn6tEwlMmi753FD8p-Dk8GhrLrnxbCRSJM=k-s128", "display_name": "chenxi li", "link": "https://stackoverflow.com/users/12119143/chenxi-li"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 90, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1571151139, "creation_date": 1571061728, "last_edit_date": 1571062096, "question_id": 58378447, "link": "https://stackoverflow.com/questions/58378447/a-very-strange-phenomenon-when-decrypt-aes-128-gcm-tls-package-using-openssl-in", "title": "A Very Strange phenomenon when decrypt aes-128-gcm tls package using OpenSSL in ruby", "body": "<p>I'm implimenting my own ssl/tls library for learning purpose. These days when I seed encrypted message to server, I will a receive \"bad mac\" alert. Today I use <a href=\"https://stackoverflow.com/questions/28198379/decrypt-tls-1-2-aes-gcm-packet\">this question</a>'s record to debug my code. </p>\n\n<p>This is where the strange thing happend. I use his server_random, client_random and master-secret to generate client_write_key and client_write_iv. Then I get the same output as his. However, when I use the client_wrtie_key and client_write_iv to decrypt the \"GET / HTTP/1.0\\n\" message, I get this output:</p>\n\n<pre class=\"lang-no prettyprint-override\"><code>Q\u2592W\u2592            \u25927\u25923\u2592\u2592\u2592\n</code></pre>\n\n<p>This is so different from the correct message! My whole debug output is </p>\n\n<pre class=\"lang-no prettyprint-override\"><code>C:/Users/ayanamists/.babun/cygwin/home/ayanamists/my_ssl_in_ruby/encrypt_handler/aes_gcm_handler.rb:87:in `final': OpenSSL::Cipher::CipherError\n        from C:/Users/ayanamists/.babun/cygwin/home/ayanamists/my_ssl_in_ruby/encrypt_handler/aes_gcm_handler.rb:87:in `recv_decrypt'\n        from decrypt.rb:72:in `&lt;main&gt;'\nclient write key is\n 4b 11 9d fb fc 93 0a be 13 00 30 bd 53 c3 bf 78\nnonce is\n 20 29 ca e2 c9 1d e0 05 e2 ae 50 a8\nwhat to be decrypt:\n a5 7a be e5 5c 18 36 67 b1 36 34 3f ee f4 a3 87 cb 7c f8 30 30\nthe tag is\n a4 7e 23 0a f2 68 37 8c 4f 33 c8 b5 ba b3 d2 6d\nthe additional data is\n 00 00 00 00 00 00 00 01 17 03 03 00 00 15\ndecrypter is\n OpenSSL::Cipher::AES\nQ\u2592W\u2592            \u25927\u25923\u2592\u2592\u2592\noutput is\n bd 8c e8 87 b7 ab c6 f7 eb 31 fd cb 65 4c d4 a9 16 ae 1b ca da\nthe correct is\n 47 45 54 20 2f 20 48 54 54 50 2f 31 2e 30 0a\n</code></pre>\n\n<p>You can see that my key and nonce have no different with his key and nonce, but why the result is wrong?\nThe code is:</p>\n\n<pre class=\"lang-ruby prettyprint-override\"><code>require_relative 'encrypt_message_handler'\nrequire 'pp'\n\nclass AES_CGM_Handler\n    include EncryptMessageHandler\n    attr_accessor :send_cipher, :recv_cipher, :send_implicit, :recv_implicit,\n    :send_seq_num, :recv_seq_num\n    def initialize(server_random, client_random, certificate = '', length = 0, \n        usage = 'client', version_major = 0x03, version_minor = 0x03)\n        if block_given?\n            @master = yield\n            @version = [0x03, 0x03]\n        else\n            super(server_random, client_random, certificate)\n        end\n        # the nonce of AES_GCM is defined by:\n        # +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n        # +  0  1  2  3 | 0  1  2  3  4  5  6  7    +\n        # +     salt    |     nonce_explicit        +\n        # +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n        # salt is server_write_iv or client_write_iv, so you need 4 * 2\n        # and length need to /8(bit-&gt;byte) and * 2(both server and client), so it's length/4\n        key_block = (length/4 + 4 * 2).tls_prf(@master, \"key expansion\", server_random + client_random)\n        arr = key_block.unpack \"a#{length/8}a#{length/8}a4a4\"\n        client_write_key = arr[0]\n        server_write_key = arr[1]\n        client_write_iv = arr[2]\n        server_write_iv = arr[3]\n\n        @send_cipher = OpenSSL::Cipher::AES.new(length, :GCM).encrypt\n        @recv_cipher = OpenSSL::Cipher::AES.new(length, :GCM).decrypt\n        if usage == 'client'\n            @send_cipher.key = client_write_key\n            @send_implicit = client_write_iv\n            @recv_cipher.key = server_write_key\n            @recv_implicit = server_write_iv\n            puts \"server write key is #{server_write_key.to_hex}\"\n        elsif usage == 'server'\n            @send_cipher.key = server_write_key\n            @send_implicit = server_write_iv\n            @recv_cipher.key = client_write_key\n            @recv_implicit = client_write_iv\n            puts \"client write key is\\n #{client_write_key.to_hex}\"\n        else\n            raise \"AES_GCM_HANDLER: BAD_ARGUMENT\"\n        end\n\n        @send_seq_num = 0\n        @recv_seq_num = 0\n    end\n\n    def send_encrypt(type = 22, seqence = '')\n        nonce_explicit = OpenSSL::Random.random_bytes(8)\n        nonce = @send_implicit + nonce_explicit\n        @send_cipher.iv = nonce\n        length = seqence.length\n        #the handle of seq_num may be wrong\n        @send_cipher.auth_data = [0, @send_seq_num,\n            type, @version[0], @version[1], 0 ,length].pack(\"NNCCCCn\")\n        encrypt = @send_cipher.update(seqence) + @send_cipher.final\n        encrypt = encrypt + @send_cipher.auth_tag\n        return encrypt\n    end\n\n    def recv_decrypt(type = 22, sequence = '', seq_num = 0)\n        if seq_num != 0\n            @recv_seq_num = seq_num\n        end\n        template = 'a8a*'\n        arr = sequence.unpack(template)\n        nonce_explicit = arr[0]\n        length = sequence.length - 8 - 16\n        sequence = arr[1]\n        encrypted = sequence[0, sequence.length - 16]\n        @recv_cipher.auth_tag = sequence[sequence.length - 16, sequence.length]\n        @recv_cipher.iv = @recv_implicit + nonce_explicit\n        puts \"nonce is\\n #{(@recv_implicit + nonce_explicit).to_hex}\"\n        puts \"what to be decrypt: \\n #{encrypted.to_hex}\" \n        puts \"the tag is \\n #{sequence[sequence.length - 16, sequence.length].to_hex}\"\n        @recv_cipher.auth_data =\n            [0, @recv_seq_num, type ,@version[0], @version[1], 0 ,length].pack(\"NNCCCCn\")\n        puts \"the additional data is\\n #{([0, @recv_seq_num, type ,@version[0], @version[1], 0 ,length].pack(\"NNCCCCn\")).to_hex }\"\n        puts \"decrypter is\\n #{@recv_cipher.class}\"\n        puts @recv_cipher.update(encrypted)\n        puts \"output is\\n #{@recv_cipher.update(encrypted).to_hex}\"\n        puts \"the correct is\\n #{\"GET / HTTP/1.0\\n\".to_hex}\"\n        decrypt = @recv_cipher.update(encrypted) + @recv_cipher.final\n        return decrypt\n    end\nend\n</code></pre>\n\n<p>Please help me to solve this problem, I'll be very grateful!</p>\n"}, {"tags": ["ruby", "selenium", "capybara"], "answers": [{"comments": [{"owner": {"reputation": 141, "user_id": 10261206, "user_type": "registered", "profile_image": "https://graph.facebook.com/1014898652026353/picture?type=large", "display_name": "Cleicy Gui&#227;o", "link": "https://stackoverflow.com/users/10261206/cleicy-gui%c3%a3o"}, "edited": false, "score": 0, "creation_date": 1571059610, "post_id": 58377415, "comment_id": 103104290, "body": "I tried it and I received the follow message: undefined method `switch_to_default_content&#39; for #&lt;Capybara::Session&gt;       Did you mean?  switch_to_frame (NoMethodError)"}, {"owner": {"reputation": 12118, "user_id": 4714829, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fd1b66c22707be26afda19fe995e17ea?s=128&d=identicon&r=PG&f=1", "display_name": "supputuri", "link": "https://stackoverflow.com/users/4714829/supputuri"}, "reply_to_user": {"reputation": 141, "user_id": 10261206, "user_type": "registered", "profile_image": "https://graph.facebook.com/1014898652026353/picture?type=large", "display_name": "Cleicy Gui&#227;o", "link": "https://stackoverflow.com/users/10261206/cleicy-gui%c3%a3o"}, "edited": false, "score": 1, "creation_date": 1571060267, "post_id": 58377415, "comment_id": 103104652, "body": "sorry, I over looked the Capybara tag. You should be able to sue <code>:top</code> or <code>:parent</code> based on your requirement."}, {"owner": {"reputation": 12118, "user_id": 4714829, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fd1b66c22707be26afda19fe995e17ea?s=128&d=identicon&r=PG&f=1", "display_name": "supputuri", "link": "https://stackoverflow.com/users/4714829/supputuri"}, "reply_to_user": {"reputation": 141, "user_id": 10261206, "user_type": "registered", "profile_image": "https://graph.facebook.com/1014898652026353/picture?type=large", "display_name": "Cleicy Gui&#227;o", "link": "https://stackoverflow.com/users/10261206/cleicy-gui%c3%a3o"}, "edited": false, "score": 1, "creation_date": 1571060424, "post_id": 58377415, "comment_id": 103104746, "body": "You can find more information <a href=\"https://github.com/teamcapybara/capybara/blob/master/lib/capybara/session.rb\" rel=\"nofollow noreferrer\">here</a>"}], "tags": [], "owner": {"reputation": 12118, "user_id": 4714829, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fd1b66c22707be26afda19fe995e17ea?s=128&d=identicon&r=PG&f=1", "display_name": "supputuri", "link": "https://stackoverflow.com/users/4714829/supputuri"}, "is_accepted": true, "score": 1, "last_activity_date": 1571060201, "last_edit_date": 1571060201, "creation_date": 1571058008, "answer_id": 58377415, "question_id": 58377189, "link": "https://stackoverflow.com/questions/58377189/how-can-i-back-to-current-frame-in-ruby/58377415#58377415", "title": "How can I back to current frame in Ruby?", "body": "<p><strong>Capybara:</strong>\nI would suggest using <code>within_frame</code> so that the handle will set back once the operations are done in the frame.</p>\n\n<pre><code>def check_report(report)\n  frame = @session.find(\"//*[@id=\\\"OF_jreport\\\"]\")\n  within_frame(frame) do\n    # write your logic to perform operations in the frame\n  end\nend\n</code></pre>\n\n<p>Or you can try the below to switch to the default frame.</p>\n\n<pre><code>@session.switch_to_frame(:top)\n</code></pre>\n\n<p><strong>Ruby:</strong>\nPlease use the below to switch to the default content.</p>\n\n<pre><code> @session.switch_to_default_content\n</code></pre>\n\n<p>If you want to switch to the parent frame then use the below</p>\n\n<pre><code>@session.switch_to_parent_frame\n</code></pre>\n"}], "owner": {"reputation": 141, "user_id": 10261206, "user_type": "registered", "profile_image": "https://graph.facebook.com/1014898652026353/picture?type=large", "display_name": "Cleicy Gui&#227;o", "link": "https://stackoverflow.com/users/10261206/cleicy-gui%c3%a3o"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 119, "favorite_count": 0, "accepted_answer_id": 58377415, "answer_count": 1, "score": 0, "last_activity_date": 1571060201, "creation_date": 1571057248, "last_edit_date": 1571058002, "question_id": 58377189, "link": "https://stackoverflow.com/questions/58377189/how-can-i-back-to-current-frame-in-ruby", "title": "How can I back to current frame in Ruby?", "body": "<p>I'm developing an automation test using Capybara and Ruby. I switch frame to access some WebElement in the Report page, and then I need to came back to current frame, but it doesn't have an ID. \nHow can I do that?</p>\n\n<p>This is my code when I switch frame to access the Report page:</p>\n\n<pre><code>def check_report(report)\n  frame = @session.find(\"//*[@id=\\\"OF_jreport\\\"]\")\n  @session.switch_to_frame(frame)\nend\n</code></pre>\n\n<p>Than I tried it:</p>\n\n<pre><code> @session.switch_to.default_content()\n</code></pre>\n\n<p>I received a message asking if did I mean switch_to_frame, but it doesn't work too.</p>\n\n<p>In my HTML code don't have another Iframe ID, and my WebElement xpath is <code>/html/body/div[11]/div[1]/div[2]/a</code></p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 303, "user_id": 9479253, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cd34f4996365a59ad414df6950d6d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ashok Damaniya", "link": "https://stackoverflow.com/users/9479253/ashok-damaniya"}, "edited": false, "score": 2, "creation_date": 1571052096, "post_id": 58375645, "comment_id": 103100323, "body": "if you are using rails 6 then try actiontext feature, which by default gives you such features which you are asking for. good luck!"}, {"owner": {"reputation": 2251, "user_id": 9785060, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IUduC.png?s=128&g=1", "display_name": "Viktor", "link": "https://stackoverflow.com/users/9785060/viktor"}, "edited": false, "score": 1, "creation_date": 1571060469, "post_id": 58375645, "comment_id": 103104770, "body": "The question is a bit too broad for StackOverflow. You should look up a tutorial or guide on how to make advanced views in Rails and go from there. If you stumble upon a specific issue along the way, this is the right place to ask. Good luck with Ruby and Rails :)"}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 12200890, "user_type": "registered", "profile_image": "https://graph.facebook.com/1597396463623746/picture?type=large", "display_name": "Muhammad Abdullah Khalil", "link": "https://stackoverflow.com/users/12200890/muhammad-abdullah-khalil"}, "is_accepted": false, "score": -1, "last_activity_date": 1571058982, "creation_date": 1571058982, "answer_id": 58377654, "question_id": 58375645, "link": "https://stackoverflow.com/questions/58375645/how-to-implement-articles-in-ruby-on-rails/58377654#58377654", "title": "How to implement articles in Ruby on Rails?", "body": "<p>Since I don't have ample experience with Rails 6, I guess it would be about how you store things. For charts you can use or store data points and use a graph making gem or api or something to make it. <a href=\"https://chartkick.com/\" rel=\"nofollow noreferrer\">You can see more on charts here.</a></p>\n\n<p>For storing the pictures you can look into this gem. <a href=\"https://github.com/thoughtbot/paperclip\" rel=\"nofollow noreferrer\">Paperclip</a></p>\n\n<p>For other things, you can take a lot of guidance from here. <a href=\"http://railscasts.com/episodes/207-syntax-highlighting?view=asciicast\" rel=\"nofollow noreferrer\">Railscast Lecture</a></p>\n"}, {"tags": [], "owner": {"reputation": 469, "user_id": 9848115, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Cody Elhard", "link": "https://stackoverflow.com/users/9848115/cody-elhard"}, "is_accepted": false, "score": -1, "last_activity_date": 1571064301, "creation_date": 1571064301, "answer_id": 58379136, "question_id": 58375645, "link": "https://stackoverflow.com/questions/58375645/how-to-implement-articles-in-ruby-on-rails/58379136#58379136", "title": "How to implement articles in Ruby on Rails?", "body": "<p>You will want to store it in plan text. You can create your own preview using something like <a href=\"https://github.com/evilstreak/markdown-js\" rel=\"nofollow noreferrer\">https://github.com/evilstreak/markdown-js</a> to create the HTMl in realtime or just the HTML without a preview. However to store into the database and display to the user, you will want to use something like <a href=\"https://github.com/vmg/redcarpet\" rel=\"nofollow noreferrer\">https://github.com/vmg/redcarpet</a>.</p>\n"}, {"tags": [], "owner": {"reputation": 311, "user_id": 7105526, "user_type": "registered", "profile_image": "https://graph.facebook.com/1812496678973073/picture?type=large", "display_name": "B&#249;i Nh\u1eadt Duy", "link": "https://stackoverflow.com/users/7105526/b%c3%b9i-nh%e1%ba%adt-duy"}, "is_accepted": false, "score": 0, "last_activity_date": 1571099947, "creation_date": 1571099947, "answer_id": 58385693, "question_id": 58375645, "link": "https://stackoverflow.com/questions/58375645/how-to-implement-articles-in-ruby-on-rails/58385693#58385693", "title": "How to implement articles in Ruby on Rails?", "body": "<p>For images you can use a <code>attachment</code> table to attach image to your article. I suggest you use some polymorphic relationships in your table like <code>attachment</code>,<code>code</code>,... </p>\n"}], "owner": {"reputation": 96, "user_id": 7364610, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c47e66c4ebc4cdc0e71ca75ff9252f3?s=128&d=identicon&r=PG&f=1", "display_name": "Riseagain", "link": "https://stackoverflow.com/users/7364610/riseagain"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 70, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1571099947, "creation_date": 1571051793, "question_id": 58375645, "link": "https://stackoverflow.com/questions/58375645/how-to-implement-articles-in-ruby-on-rails", "title": "How to implement articles in Ruby on Rails?", "body": "<p>The Getting Started with Rails guide describes how to implement basic articles in Ruby on Rails.\nThe body of each article is stored in simple <code>text</code> column in the database table.\nBut I want to have nice articles with images, links, charts, code snippets, and so on.\nHow can I implement such functionality? Do I have to store HTML in the database table field?</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 1, "creation_date": 1571055245, "post_id": 58375403, "comment_id": 103101910, "body": "<i>&quot;Given that [....] it does have the variant method&quot;</i> \u2013 your conclusion is wrong. Messages and methods are closely related, but independent of each other in general. An object can respond to a message without implementing a method with the same name. An object can also implement a certain method without responding to the corresponding message."}, {"owner": {"reputation": 18939, "user_id": 2756409, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/UIrGI.jpg?s=128&g=1", "display_name": "TylerH", "link": "https://stackoverflow.com/users/2756409/tylerh"}, "edited": false, "score": 0, "creation_date": 1573487548, "post_id": 58375403, "comment_id": 103889022, "body": "Does this answer your question? <a href=\"https://stackoverflow.com/questions/8595184/how-to-list-all-methods-for-an-object-in-ruby\">How to list all methods for an object in Ruby?</a>"}], "answers": [{"comments": [{"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 2, "creation_date": 1571054773, "post_id": 58376339, "comment_id": 103101683, "body": "It&#39;s worth mentioning that if you expose fake methods via <code>method_missing</code>, you should mirror the changes in <code>respond_to_missing?</code>"}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 1, "creation_date": 1571055737, "post_id": 58376339, "comment_id": 103102159, "body": "And instead of raising your own <code>NoMethodError</code>, you should just call <code>super</code>."}, {"owner": {"reputation": 25573, "user_id": 676874, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/c8e67ec01dc3e7c402255ff26785863f?s=128&d=identicon&r=PG", "display_name": "knut", "link": "https://stackoverflow.com/users/676874/knut"}, "reply_to_user": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1571060526, "post_id": 58376339, "comment_id": 103104794, "body": "@Stefan: Thanks for the hint. I adapted my answer"}, {"owner": {"reputation": 25573, "user_id": 676874, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/c8e67ec01dc3e7c402255ff26785863f?s=128&d=identicon&r=PG", "display_name": "knut", "link": "https://stackoverflow.com/users/676874/knut"}, "reply_to_user": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1571061505, "post_id": 58376339, "comment_id": 103105296, "body": "@SergioTulentsev I extende my answer. Thanks for the hint."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1571072456, "post_id": 58376339, "comment_id": 103110549, "body": "Good answer. There&#39;s no need for &quot;Addition&quot;. Just edit as though you were responding to comments made on a draft of an article or book."}], "tags": [], "owner": {"reputation": 25573, "user_id": 676874, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/c8e67ec01dc3e7c402255ff26785863f?s=128&d=identicon&r=PG", "display_name": "knut", "link": "https://stackoverflow.com/users/676874/knut"}, "is_accepted": true, "score": 8, "last_activity_date": 1571061482, "last_edit_date": 1571061482, "creation_date": 1571054434, "answer_id": 58376339, "question_id": 58375403, "link": "https://stackoverflow.com/questions/58375403/ruby-actually-get-all-methods-for-an-instance/58376339#58376339", "title": "Ruby - actually get ALL methods for an instance", "body": "<p>Maybe you missed the last paragraph in the accepted answer of linked post <a href=\"https://stackoverflow.com/questions/8595184/how-to-list-all-methods-for-an-object-in-ruby\">How to list all methods for an object in Ruby?</a>:</p>\n\n<blockquote>\n  <p><strong>Added</strong> Note that :has_many does not add methods directly. Instead, the ActiveRecord machinery uses the Ruby method_missing and responds_to techniques to handle method calls on the fly. As a result, the methods are not listed in the methods method result.</p>\n</blockquote>\n\n<p>To make it clearer what happens a code example:</p>\n\n<pre><code>class Foo\n  def hello\n    puts 'Hello'\n  end\n\n  def method_missing(name, *args, &amp;block)\n    case name\n      when :unknown_method\n        puts \"handle unknown method %s\" % name # name is a symbol\n      else\n        super #raises NoMethodError unless there is something else defined\n    end\n  end\nend\n\nfoo = Foo.new\np foo.respond_to?(:hello) #-&gt; true\np foo.respond_to?(:unknown_method) #-&gt; false\nfoo.unknown_method  #-&gt; 'handle unknown method unknown_method'\nfoo.another_unknown_method  #-&gt; Exception\n</code></pre>\n\n<p>The method <code>unknown_method</code> is never defined, but there is a method to handle unknown methods. So the class makes the impression of an existing method, but there is none.</p>\n\n<p>Maybe <a href=\"https://stackoverflow.com/questions/3393096/how-can-i-get-source-code-of-a-method-dynamically-and-also-which-file-is-this-me\">How can I get source code of a method dynamically and also which file is this method locate in</a> helps the get information about the content:</p>\n\n<pre><code>Foo.instance_method(:method_missing).source_location\n</code></pre>\n\n<h2>Addition</h2>\n\n<p>When you define your own <code>method_missing</code>, then you should also change the behaviour of <code>respond_to?</code> with <code>respond_to_missing?</code></p>\n\n<pre><code>  def respond_to_missing?(method, *)\n    return method == :unknown_method || super\n    #or if you have a list of methods:\n    #~ return %i{unknown_method}.include?(method) || super\n    #or with a regex for \n    #~ method =~ /another_(\\w+)/ || super\n  end\nend\n</code></pre>\n\n<p>See also <a href=\"https://stackoverflow.com/questions/13793060/respond-to-vs-respond-to-missing\">`respond_to?` vs. `respond_to_missing?`</a> for details.</p>\n"}], "owner": {"reputation": 12442, "user_id": 849697, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/0c91f58ffa7bbf4151cae13b5c8b9ccd?s=128&d=identicon&r=PG", "display_name": "xxjjnn", "link": "https://stackoverflow.com/users/849697/xxjjnn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 183, "favorite_count": 1, "accepted_answer_id": 58376339, "answer_count": 1, "score": 6, "last_activity_date": 1573646713, "creation_date": 1571050848, "last_edit_date": 1573646713, "question_id": 58375403, "link": "https://stackoverflow.com/questions/58375403/ruby-actually-get-all-methods-for-an-instance", "title": "Ruby - actually get ALL methods for an instance", "body": "<p>In this question:</p>\n\n<p><a href=\"https://stackoverflow.com/questions/8595184/how-to-list-all-methods-for-an-object-in-ruby\">How to list all methods for an object in Ruby?</a></p>\n\n<p>You can call <code>foo.methods</code> and get all methods. But this does not get all methods. Example in Rails, with ActiveStorage:</p>\n\n<pre><code>Image.first.specimens.first.methods.include?(:variant)\n#\u00a0=&gt; false\nImage.first.specimens.first.respond_to?(:variant)\n#\u00a0=&gt; true\nImage.first.specimens.first.variant\nTraceback (most recent call last):\n        1: from (irb):3\nArgumentError (wrong number of arguments (given 0, expected 1))\nImage.first.specimens.first.method(:variant)\n#\u00a0=&gt; #&lt;Method: ActiveStorage::Attachment(id: integer, name: string, record_type: string, record_id: integer, blob_id: integer, created_at: datetime)#variant&gt;\n</code></pre>\n\n<p>Given that an ArgumentError is being raised, it <code>respond_to?</code>s, and I can grab the method, it <em><strong>does</strong></em> have the variant method. But it is not shown with <code>.methods</code>. How can I see a full list of methods?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "graphql-ruby"], "comments": [{"owner": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "edited": false, "score": 0, "creation_date": 1571046786, "post_id": 58374118, "comment_id": 103097729, "body": "You have another problem here in that <code>.find</code> is used to find records by id. If you want to find records by another unique column use <code>.find_by(username: username)</code>. Thats also a somewhat strange use of keyword arguments."}, {"owner": {"reputation": 11, "user_id": 12213539, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mB8qVZEvYRYT_uG0adI6P3Jm4be-QY29bVf86lWPw=k-s128", "display_name": "Julian Mourell", "link": "https://stackoverflow.com/users/12213539/julian-mourell"}, "reply_to_user": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "edited": false, "score": 0, "creation_date": 1571047296, "post_id": 58374118, "comment_id": 103097971, "body": "Thank you max, I don&#39;t actually know proper usage I&#39;m just trying to hack away and learn while doing what would be a better way?"}, {"owner": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "edited": false, "score": 0, "creation_date": 1571047433, "post_id": 58374118, "comment_id": 103098032, "body": "Well if you only have one argument then it makes more sense that its a positonal argument. And I would name the method something that tells you about what it actually does like <code>find_user_by_username</code>."}, {"owner": {"reputation": 11, "user_id": 12213539, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mB8qVZEvYRYT_uG0adI6P3Jm4be-QY29bVf86lWPw=k-s128", "display_name": "Julian Mourell", "link": "https://stackoverflow.com/users/12213539/julian-mourell"}, "reply_to_user": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "edited": false, "score": 0, "creation_date": 1571047858, "post_id": 58374118, "comment_id": 103098240, "body": "Is this the same when you use graphql-ruby <a href=\"https://graphql-ruby.org/fields/arguments\" rel=\"nofollow noreferrer\">graphql-ruby.org/fields/arguments</a> , I&#39;m just trying to follow the docs here. It still displays the same error even with find_by"}, {"owner": {"reputation": 11, "user_id": 12213539, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mB8qVZEvYRYT_uG0adI6P3Jm4be-QY29bVf86lWPw=k-s128", "display_name": "Julian Mourell", "link": "https://stackoverflow.com/users/12213539/julian-mourell"}, "reply_to_user": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "edited": false, "score": 0, "creation_date": 1571058785, "post_id": 58374118, "comment_id": 103103799, "body": "I&#39;ve tried to use find and the id as well and I still get this same problem. If anyone has any clues or they think they know whats going on I would really appreciate any advice or suggestions."}, {"owner": {"reputation": 11, "user_id": 12213539, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mB8qVZEvYRYT_uG0adI6P3Jm4be-QY29bVf86lWPw=k-s128", "display_name": "Julian Mourell", "link": "https://stackoverflow.com/users/12213539/julian-mourell"}, "reply_to_user": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "edited": false, "score": 0, "creation_date": 1571058844, "post_id": 58374118, "comment_id": 103103828, "body": "<code>field :users, [UserType], null:false, description: &quot;Get all the users&quot;       def users       User.all     end</code> This code when I query for all users raises no issues."}, {"owner": {"reputation": 11, "user_id": 12213539, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mB8qVZEvYRYT_uG0adI6P3Jm4be-QY29bVf86lWPw=k-s128", "display_name": "Julian Mourell", "link": "https://stackoverflow.com/users/12213539/julian-mourell"}, "reply_to_user": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "edited": false, "score": 0, "creation_date": 1571065723, "post_id": 58374118, "comment_id": 103107573, "body": "In schema.rb it tries to call  ``` if extended_args.any?                   field_receiver.public_send(@resolver_method, **extended_args)                 else                   field_receiver.public_send(@resolver_method)                 end ```  It tries to call the public send passing in the extended_args of query:1 and throws an error. If any ruby / graphql-ruby experienced developers could help, I&#39;d be very grateful"}], "answers": [{"tags": [], "owner": {"reputation": 11, "user_id": 12213539, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mB8qVZEvYRYT_uG0adI6P3Jm4be-QY29bVf86lWPw=k-s128", "display_name": "Julian Mourell", "link": "https://stackoverflow.com/users/12213539/julian-mourell"}, "is_accepted": false, "score": 1, "last_activity_date": 1571103145, "creation_date": 1571103145, "answer_id": 58386057, "question_id": 58374118, "link": "https://stackoverflow.com/questions/58374118/graphql-ruby-mapping-using-active-record/58386057#58386057", "title": "Graphql-Ruby Mapping using Active Record", "body": "<p>Turns out there was an issue with Ruby gem I was using upgraded to the new gem and it solved the problem. See - <a href=\"https://github.com/rmosolgo/graphql-ruby/issues/2537\" rel=\"nofollow noreferrer\">https://github.com/rmosolgo/graphql-ruby/issues/2537</a></p>\n"}], "owner": {"reputation": 11, "user_id": 12213539, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mB8qVZEvYRYT_uG0adI6P3Jm4be-QY29bVf86lWPw=k-s128", "display_name": "Julian Mourell", "link": "https://stackoverflow.com/users/12213539/julian-mourell"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 249, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1571103145, "creation_date": 1571046292, "question_id": 58374118, "link": "https://stackoverflow.com/questions/58374118/graphql-ruby-mapping-using-active-record", "title": "Graphql-Ruby Mapping using Active Record", "body": "<p>I am completely new to using Rails, I'm trying to create a basic crud application using ruby-graphql to do a simple find query with active record to a sqlite3 database.\nI set up a user type </p>\n\n<pre><code>  class UserType &lt; Types::BaseObject\n    description \"A user type \"\n    field :id, ID, null: false\n    field :username, String, null: false\n    field :email, String, null: false\n    field :email_confirmed, Boolean, null:false\n    field :first_name, String , null:false\n    field :last_name, String, null:false\n    field :biography, String, null:true\n    field :avatar, String, null:true\n    field :created_at, GraphQL::Types::ISO8601DateTime, null:false\n    field :updated_at, GraphQL::Types::ISO8601DateTime, null:false\n  end\n</code></pre>\n\n<p>Then I setup the query :</p>\n\n<pre><code>field :user, UserType, null:false,\n      description: \"Get a single user\" do\n      argument :username, String, required: true\n      end\n    def user(username:)\n      User.find(username)\n    end\n</code></pre>\n\n<p>My query is :</p>\n\n<pre><code>{\n  user(username:\"test\"){\n    username\n  }\n}\n\n</code></pre>\n\n<p>I  get the following error : </p>\n\n<pre><code>{\n  \"error\": {\n    \"message\": \"no implicit conversion of #&lt;Class:0x000000000b975440&gt; into Hash\",\n    \"backtrace\": [\n      \"C:/Ruby26-x64/lib/ruby/gems/2.6.0/gems/graphql-1.9.13/lib/graphql/schema/field.rb:519:in `block in resolve'\",\n</code></pre>\n\n<p>If anyone could help me I would really appreciate it.\nHow do I do this conversion in Ruby / Rails?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "stripe-payments", "plaid"], "comments": [{"owner": {"reputation": 3926, "user_id": 2190621, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4c464f439212bca87517b234f7c9bd3e?s=128&d=identicon&r=PG&f=1", "display_name": "demir", "link": "https://stackoverflow.com/users/2190621/demir"}, "edited": false, "score": 0, "creation_date": 1571046005, "post_id": 58373656, "comment_id": 103097278, "body": "Have you tried to print public_token and metadata in the console? Check the values."}, {"owner": {"reputation": 599, "user_id": 11544569, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xEqDN.jpg?s=128&g=1", "display_name": "RomanOks", "link": "https://stackoverflow.com/users/11544569/romanoks"}, "reply_to_user": {"reputation": 3926, "user_id": 2190621, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4c464f439212bca87517b234f7c9bd3e?s=128&d=identicon&r=PG&f=1", "display_name": "demir", "link": "https://stackoverflow.com/users/2190621/demir"}, "edited": false, "score": 0, "creation_date": 1571047888, "post_id": 58373656, "comment_id": 103098248, "body": "<code>public_token</code> is working correctly."}, {"owner": {"reputation": 3926, "user_id": 2190621, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4c464f439212bca87517b234f7c9bd3e?s=128&d=identicon&r=PG&f=1", "display_name": "demir", "link": "https://stackoverflow.com/users/2190621/demir"}, "edited": false, "score": 0, "creation_date": 1571047983, "post_id": 58373656, "comment_id": 103098292, "body": "What&#39;s in public_token? Can the metadata be in public_token?"}, {"owner": {"reputation": 599, "user_id": 11544569, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xEqDN.jpg?s=128&g=1", "display_name": "RomanOks", "link": "https://stackoverflow.com/users/11544569/romanoks"}, "reply_to_user": {"reputation": 3926, "user_id": 2190621, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4c464f439212bca87517b234f7c9bd3e?s=128&d=identicon&r=PG&f=1", "display_name": "demir", "link": "https://stackoverflow.com/users/2190621/demir"}, "edited": false, "score": 0, "creation_date": 1571048080, "post_id": 58373656, "comment_id": 103098334, "body": "<code>public_token = public-sandbox-ce9c11...</code> and <code>metadata = {&quot;institution&quot;=&gt;{&quot;name&quot;=&gt;&quot;Chase&quot;, &quot;institution_id&quot;=&gt;&quot;ins_3&quot;}, &quot;account&quot;=&gt;{&quot;id&quot;=&gt;&quot;&quot;, &quot;name&quot;=&gt;&quot;&quot;, &quot;type&quot;=&gt;&quot;&quot;, &quot;subtype&quot;=&gt;&quot;&quot;, &quot;mask&quot;=&gt;&quot;&quot;}, &quot;account_id&quot;=&gt;&quot;&quot;, &quot;accounts&quot;=&gt;{&quot;0&quot;=&gt;{&quot;id&quot;=&gt;&quot;PG7xK5xVJ5tqe...&quot;, &quot;name&quot;=&gt;&quot;Plaid Checking&quot;, &quot;mask&quot;=&gt;&quot;0000&quot;, &quot;type&quot;=&gt;&quot;depository&quot;, &quot;subtype&quot;=&gt;&quot;checking&quot;},..</code>"}, {"owner": {"reputation": 599, "user_id": 11544569, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xEqDN.jpg?s=128&g=1", "display_name": "RomanOks", "link": "https://stackoverflow.com/users/11544569/romanoks"}, "reply_to_user": {"reputation": 3926, "user_id": 2190621, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4c464f439212bca87517b234f7c9bd3e?s=128&d=identicon&r=PG&f=1", "display_name": "demir", "link": "https://stackoverflow.com/users/2190621/demir"}, "edited": false, "score": 0, "creation_date": 1571048233, "post_id": 58373656, "comment_id": 103098393, "body": "@demir <code>metadata</code> same as picture in my question."}, {"owner": {"reputation": 3926, "user_id": 2190621, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4c464f439212bca87517b234f7c9bd3e?s=128&d=identicon&r=PG&f=1", "display_name": "demir", "link": "https://stackoverflow.com/users/2190621/demir"}, "edited": false, "score": 0, "creation_date": 1571048936, "post_id": 58373656, "comment_id": 103098728, "body": "From plaid documantation: &quot;The metadata object contains info about the institution the user selected and the account ID or IDs, if the Select Account view is enabled.&quot; Did you enable <code>Select Account</code> view  from dashboard?"}, {"owner": {"reputation": 599, "user_id": 11544569, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xEqDN.jpg?s=128&g=1", "display_name": "RomanOks", "link": "https://stackoverflow.com/users/11544569/romanoks"}, "reply_to_user": {"reputation": 3926, "user_id": 2190621, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4c464f439212bca87517b234f7c9bd3e?s=128&d=identicon&r=PG&f=1", "display_name": "demir", "link": "https://stackoverflow.com/users/2190621/demir"}, "edited": false, "score": 1, "creation_date": 1571049545, "post_id": 58373656, "comment_id": 103099039, "body": "@demir Thank you very much! I re-read the documentation, but didn&#39;t find it. Included account selection, now I have  ID."}], "answers": [{"tags": [], "owner": {"reputation": 599, "user_id": 11544569, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xEqDN.jpg?s=128&g=1", "display_name": "RomanOks", "link": "https://stackoverflow.com/users/11544569/romanoks"}, "is_accepted": false, "score": 0, "last_activity_date": 1580711571, "creation_date": 1580711571, "answer_id": 60034143, "question_id": 58373656, "link": "https://stackoverflow.com/questions/58373656/plaid-integration-rails/60034143#60034143", "title": "Plaid integration Rails", "body": "<p>Enable <code>Select Account</code> view from Plaid dashboard.</p>\n"}], "owner": {"reputation": 599, "user_id": 11544569, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xEqDN.jpg?s=128&g=1", "display_name": "RomanOks", "link": "https://stackoverflow.com/users/11544569/romanoks"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 403, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1580711571, "creation_date": 1571044792, "question_id": 58373656, "link": "https://stackoverflow.com/questions/58373656/plaid-integration-rails", "title": "Plaid integration Rails", "body": "<p>I would like to make a payment using <em>Stripe ACH</em>.</p>\n\n<p>I use gem <code>plaid</code>.</p>\n\n<p>Here is my Link code:</p>\n\n<pre><code>var linkHandler = Plaid.create({\n    clientName: 'Some Name',\n    env: 'sandbox',\n    key: ENV['key'],\n    product: ['auth'],\n    onSuccess: function(public_token, metadata) {\n        $.post('/plaid/set_auth', {\n            public_token: public_token,\n            account: metadata.account_id\n        });\n\n        console.log('Public Token: ' + public_token);\n        console.log('Selected account ID: ' + metadata.account_id);\n    }\n});\n</code></pre>\n\n<p>Plaid controller:</p>\n\n<pre><code>def set_auth\n  public_token = params['public_token']\n  account_id   = params['account']\n\n  client = Plaid::Client.new(env: :sandbox, \n                       client_id: ENV['client_id'],\n                          secret: ENV['secret'],\n                      public_key: ENV['public_key'])\n\n  exchange_token_response = client.item.public_token.exchange(public_token)\n  access_token = exchange_token_response.access_token\n\n\n  #Create a Stripe bank_account_token\n\n  stripe_response = client.processor.stripe.bank_account_token.create(access_token, account_id)\n  bank_account_token = stripe_response.stripe_bank_account_token\n\n  customer = Stripe::Customer.retrieve(\"&lt;customer-id&gt;\")\n\n  customer.sources.create({\n    :source =&gt; bank_account_token\n  })\n\n  #...Stripe::Charge.create()...\nend\n</code></pre>\n\n<p><strong>The problem</strong> is that <code>metadata.account_id</code> parameter is not passed to controller.</p>\n\n<p>Browser console: <code>Selected account ID: null</code></p>\n\n<p>If i do <code>puts client.accounts.get(access_token)</code> I get several accounts with different balances.</p>\n\n<p><a href=\"https://i.stack.imgur.com/NBVzK.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/NBVzK.png\" alt=\"accounts\"></a></p>\n"}, {"tags": ["ruby-on-rails", "ruby", "postgresql"], "comments": [{"owner": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "edited": false, "score": 1, "creation_date": 1571045141, "post_id": 58373532, "comment_id": 103096756, "body": "If you can express the two ranges as SQL queries its as simple as <code>WHERE appointments.id IN (SELECT id FROM appartments WHERE ...)</code>. You would typically do this in Rails by <code>.where(appointments: { id: x})</code> where x is an ActiveRecord::Relation object. Make sure you don&#39;t actually load the records by doing the very common (and very stupid) <code>.pluck(:id)</code>."}, {"owner": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "edited": false, "score": 1, "creation_date": 1571045741, "post_id": 58373532, "comment_id": 103097122, "body": "But as always if you are looking for a good answer on how to make a query more effective you need to provide an example of the models, data and desired output so that people looking to help can actually run and test different options."}], "answers": [{"comments": [{"owner": {"reputation": 61, "user_id": 7442869, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/68860a551874421019300d7ee369327c?s=128&d=identicon&r=PG&f=1", "display_name": "Patrick Jones", "link": "https://stackoverflow.com/users/7442869/patrick-jones"}, "edited": false, "score": 0, "creation_date": 1571055141, "post_id": 58376221, "comment_id": 103101859, "body": "I knew there was a better way! That&#39;s some beautiful logic Steve; really appreciate it! I&#39;ve gone from loading 315 appointments into an instance variable to loading 51. This should definitely reduce some of those pesky R14 heroku errors too. :-D"}], "tags": [], "owner": {"reputation": 32451, "user_id": 2516474, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a2179a340c0e84edc285d432211145d?s=128&d=identicon&r=PG", "display_name": "SteveTurczyn", "link": "https://stackoverflow.com/users/2516474/steveturczyn"}, "is_accepted": true, "score": 1, "last_activity_date": 1571053999, "creation_date": 1571053999, "answer_id": 58376221, "question_id": 58373532, "link": "https://stackoverflow.com/questions/58373532/efficient-postgresql-query-for-sorting-appointments-on-simple-calendar-with-rail/58376221#58376221", "title": "Efficient Postgresql Query for Sorting Appointments on Simple Calendar with Rails", "body": "<pre><code>from_time = '2019-05-26'.to_date\nto_time = '2919-06-30'.to_date\n\n@appointments = Appointment.where('start_time &lt;= ? AND end_time &gt;= ?', to_time, from_time)\n</code></pre>\n\n<p>The above will select all appointments that are included in or overlap the from_time and to_time range, and also appointments that start before the range and end after the range.</p>\n"}], "owner": {"reputation": 61, "user_id": 7442869, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/68860a551874421019300d7ee369327c?s=128&d=identicon&r=PG&f=1", "display_name": "Patrick Jones", "link": "https://stackoverflow.com/users/7442869/patrick-jones"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 59, "favorite_count": 0, "accepted_answer_id": 58376221, "answer_count": 1, "score": 2, "last_activity_date": 1571053999, "creation_date": 1571044318, "last_edit_date": 1571052648, "question_id": 58373532, "link": "https://stackoverflow.com/questions/58373532/efficient-postgresql-query-for-sorting-appointments-on-simple-calendar-with-rail", "title": "Efficient Postgresql Query for Sorting Appointments on Simple Calendar with Rails", "body": "<p><strong>TL;DR:</strong>\nI have a database with thousands of appointments that have start_time and end_time attributes. Given a date range (May 26-June 31), how do I find \nevery appointment that happens throughout this range?</p>\n\n<p><em>Appointment from May 15 to May 25 NOT included</em><br>\nAppointment from May 15 to May 29 needs to be included<br>\nAppointment from June 1 to June 3 needs to be included<br>\nAppointment from June 20 to July 5 needs to be included<br>\nAppointment from May 15 to July 15 needs to be included (most difficult part of the problem)<br>\n<em>Appointment from July 1 to July 4 NOT included</em> </p>\n\n<hr>\n\n<p>We have an appointment model that has a start_time and an end_time. If an appointment occurs on any days during the monthly view, it needs to be loaded into the instance variable (@monthly_appointments) so that the simple_calendar gem can display it on the calendar.</p>\n\n<p>Example: An appointment from June 1 to June 3 needs to show up when the user views the \"June 2020\" calendar. An appointment from May 15 to July 15 also needs to show up every single day during June.</p>\n\n<p>There's 6-day padding on each side of the calendar dates, since if the week starts on a Saturday (June 1), you'll have May 26 - May 31 showing on the June calendar (see picture).</p>\n\n<p>You'd think it was just as easy as saying \"If an appointment starts or ends during the given month, add that appointment to the instance variable. However, there are cases when an appointment starts on May 15 and goes for 60 days, until July 15. The appointment neither starts nor ends during June, but it needs to still show up on the calendar. </p>\n\n<p>Originally, we told users, \"appointments cannot last longer than 6 months\" and then we used this lookup where we assumed, <strong>\"if the appointment started during the last 6 months, include it in the variable and then we'll let the calendar gem work out the rest.\"</strong></p>\n\n<p><code>@monthly_appointments = current_user.appointments.includes(:pet).where(start_time: (Time.zone.now).beginning_of_month - 6.months..(Time.zone.now).end_of_month + 6.days))</code></p>\n\n<p>However, this query can sometimes save 3,000+ appointments in the variable, when, in reality, there are only 50-70 appointments that NEED to be shown for that month. </p>\n\n<p>So, I wrote up the following code, and it succeeds in finding appointments that occur on at least one day during the calendar's timeframe. It compares the monthly calendar's range(May 26..June 31) and an appointment's range(June 1..June 3), and then looks for any dates that occur in both arrays (&amp;). It works well, but it takes a bit of time because it needs to load ALL the appointments for a user (thousands) and then goes through each one to see if it occurs during that month. </p>\n\n<p>Does anyone have any other clever solutions to this query issue? I'm sure something exists out there, but I haven't found it yet. Thanks!</p>\n\n<pre><code>month_dates = ((Time.zone.now.beginning_of_month - 6.days)..(Time.zone.now.end_of_month + 6.days)).to_a\n\n@monthly_appointments = current_user.appointments.includes(:pet).select do |appt|\n  #create array of appointment dates and see if it intersects any of the monthly date array\n  appt_dates = (appt.start_time.to_date..appt.end_time.to_date).to_a\n  (month_dates &amp; appt_dates).present?\nend\n</code></pre>\n\n<pre><code>Models:\nAppointment(start_time, end_time, note, user_id, pet_id)\n\nPet\nhas_many appointments\n\nUser\nhas_many appointments\n\nHere's an example.\n\ncarley = Pet.find(12)\n\nAppointment.create(pet_id: carley.id, start_time: \"May 15 2020 06:00:00\", end_time: \"July 15 2020 06:00:00\"...)\n</code></pre>\n\n<p>When I'm looking at the June 2020 calendar, this appointment needs to show up on every single day.</p>\n\n<p><a href=\"https://i.stack.imgur.com/hT5ho.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/hT5ho.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["c++", "ruby-on-rails", "ruby", "ruby-c-extension", "stack-level"], "comments": [{"owner": {"reputation": 22416, "user_id": 5494370, "user_type": "registered", "profile_image": "https://graph.facebook.com/10152989584621642/picture?type=large", "display_name": "Alan Birtles", "link": "https://stackoverflow.com/users/5494370/alan-birtles"}, "edited": false, "score": 0, "creation_date": 1571044929, "post_id": 58372966, "comment_id": 103096629, "body": "Probably stack corruption somewhere"}, {"owner": {"reputation": 15619, "user_id": 1548468, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0745dce203d52699e63a575b3103ad70?s=128&d=identicon&r=PG", "display_name": "Botje", "link": "https://stackoverflow.com/users/1548468/botje"}, "edited": false, "score": 0, "creation_date": 1571052068, "post_id": 58372966, "comment_id": 103100315, "body": "What does <code>DataProtector</code> look like?"}], "owner": {"reputation": 155, "user_id": 8154557, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/670ef6987f7761baeaf5ff2fc8fd65de?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent", "link": "https://stackoverflow.com/users/8154557/vincent"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 110, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1571054017, "creation_date": 1571042361, "last_edit_date": 1571054017, "question_id": 58372966, "link": "https://stackoverflow.com/questions/58372966/stack-level-too-deep-error-in-ruby-native-extension-how-to-reduce-stack-level", "title": "Stack level too deep error in ruby native extension, how to reduce stack level?", "body": "<p>I have a Ruby on Rails api which handles a simple API call and returns some encrypted data. The encryption is done in C++, using the ruby native C api. (reference <a href=\"https://github.com/ruby/ruby/blob/trunk/doc/extension.rdoc\" rel=\"nofollow noreferrer\">here</a>).</p>\n\n<p>The native part works fine when compiled and linked as a standalone program, and also when used with ruby in IRB.</p>\n\n<p>However, when I use it from within the Rails API, I <strong>sometimes</strong> get a \"Stack level too deep\" error. </p>\n\n<p>The error seems to occur or not depending on the size of the data processed.</p>\n\n<p>According to <a href=\"https://stackoverflow.com/a/13886570/8154557\">this answer</a>, the stack 'level' is actually stack space, so it would make sense that if I have more data to process, then I have more data in the stack, so it fills up quicker etc...</p>\n\n<p>I had initially left all my variables in the stack, for simplicity and to avoid forgetting to free allocated memory. Seeing this error, I switched to a dynamical allocation approach. However contrarily to what I was expecting, the Stack level too deep error occurs for even smaller data size.</p>\n\n<p>data_controller.rb</p>\n\n<pre><code>  def load_data data_path, width\n    authorize!                                                                                                                                                               \n\n    encrypted = NativeDataProtector.encrypt(data_path, get_key(), get_iv())\n    return [ encrypted, \"application/octet-stream\" ]\n  end\n</code></pre>\n\n<p>native_encryptor.cpp</p>\n\n<pre><code>VALUE encrypt_n(VALUE _self, VALUE data_path, VALUE key, VALUE salt){\n  DataProtector protector;\n  string *b64 = protector.encrypt(StringValueCStr(data_path),   \\\n                 StringValueCStr(key),   \\\n                 StringValueCStr(salt));\n\n    VALUE ret = rb_str_new(b64-&gt;c_str(), b64-&gt;length());\n    delete(b64);\n  return ret;\n}\n\nextern \"C\" void Init_data_protector() {\n  VALUE mod = rb_define_module(\"NativeDataProtector\");\n  rb_define_module_function(mod, \"encrypt\", (VALUE(*)(ANYARGS))encrypt_n, 3);\n}\n</code></pre>\n\n<p>encrypt.h</p>\n\n<pre><code>#include &lt;ruby.h&gt;\n#include \"extconf.h\"\n\n#include &lt;iostream&gt;\n#include &lt;fstream&gt;\n#include &lt;vector&gt;\n#include &lt;list&gt;\n\n#include &lt;openssl/conf.h&gt;\n#include &lt;openssl/evp.h&gt;\n#include &lt;openssl/err.h&gt;\n\nclass DataProtector {\n\n private :\n  int pad_cleartext(vector&lt;unsigned char&gt; *cleartext);\n  vector&lt;unsigned char&gt; *read_data(string path);\n  int aes_encrypt(vector&lt;unsigned char&gt; *plaintext, string key,\n          string iv, unsigned char *ciphertext);\n  string to_b64(unsigned char* in);\n  void handleErrors(void);\n\n public :\n  string *encrypt(string data_path, string key, string salt);\n};\n\n</code></pre>\n\n<p>encrypt.cpp</p>\n\n<pre><code>string *DataProtector::encrypt(string data_path, string key, string salt) {\n  vector&lt;unsigned char&gt; *cleartext = readData(data_path);\n  int length = pad_cleartext(cleartext);\n\n  unsigned char* output = new unsigned char[length + 16];\n\n  int ciphertext_len;\n\n  // encrypt\n  string *encrypted = new string(\"\");\n  ciphertext_len = aes_encrypt(&amp;((*cleartext), key, iv, output);\n  (*encrypted) += to_b64(output);\n\n  delete(cleartext);\n  delete(output);\n\n  return encrypted;\n}\n\nint DataProtector::aes_encrypt(vector&lt;unsigned char&gt; *plaintext, string key,\n  string iv, unsigned char *ciphertext)\n{\n  EVP_CIPHER_CTX *ctx;\n\n  int len;\n\n  int ciphertext_len;\n\n  /* Create and initialise the context */\n  if(!(ctx = EVP_CIPHER_CTX_new())) handleErrors();\n\n  /* Initialise the encryption operation. IMPORTANT - ensure you use a key\n   * and IV size appropriate for your cipher\n   * In this example we are using 256 bit AES (i.e. a 256 bit key). The\n   * IV size for *most* modes is the same as the block size. For AES this\n   * is 128 bits */\n  if(1 != EVP_EncryptInit_ex(ctx, EVP_aes_128_cbc(), NULL, (const unsigned char *)key.c_str(), (const unsigned char *)iv.c_str()))\n    handleErrors();\n\n  /* Provide the message to be encrypted, and obtain the encrypted output.\n   * EVP_EncryptUpdate can be called multiple times if necessary\n   */\n  if(1 != EVP_EncryptUpdate(ctx, ciphertext, &amp;len, reinterpret_cast&lt;unsigned char*&gt;(plaintext-&gt;data()), plaintext-&gt;size()))\n    handleErrors();\n  ciphertext_len = len;\n\n  /* Finalise the encryption. Further ciphertext bytes may be written at\n   * this stage.\n   */\n  if(1 != EVP_EncryptFinal_ex(ctx, ciphertext + len, &amp;len)) handleErrors();\n  ciphertext_len += len;\n\n  /* Clean up */\n  EVP_CIPHER_CTX_free(ctx);\n\n  return ciphertext_len;\n}\n\nint DataProtector::pad_cleartext(vector&lt;unsigned char&gt; *in) {\n  // padds to length multiple of 16\n  int nb_blocks = in-&gt;size() / 16 + ((in-&gt;size()%16 == 0)? 1:1);\n  int size = nb_blocks*16;\n\n  for (unsigned int i=in-&gt;size(); i&lt;size; i++) {\n    unsigned char c = '0';\n    in-&gt;push_back(c);\n  }\n  return size;\n}\n\nvector&lt;unsigned char&gt; *DataProtector::read_data(string path) {\n    streampos size;\n    ifstream file(path, ios::binary);\n\n    file.seekg(0, ios::end);\n    size = file.tellg();\n    file.seekg(0, ios::beg);\n\n    vector&lt;unsigned char&gt; *data = new vector&lt;unsigned char&gt;(fileSize);\n    file.read((char*) &amp;data[0], size);\n    return data;\n}\n\nvoid DataProtector::handleErrors(void) {\n  ERR_print_errors_fp(stderr);\n  abort();\n}\n\n</code></pre>\n\n<p>(the actual encryption is from <a href=\"https://stackoverflow.com/q/44635285/8154557\">here</a>)</p>\n\n<p>The error stack trace I get :</p>\n\n<pre><code>SystemStackError (stack level too deep):\n\napp/controllers/data_controller.rb:41:in `encrypt'\napp/controllers/data_controller.rb:41:in `load_data'\napp/controllers/data_controller.rb:15:in `show'\n</code></pre>\n\n<p>Is <em>Believe</em> that the reason for this error is too much data allocated on the stack, and <em>not</em> a recursion issue. However, I don't understand why switching to heap allocation did not improve anything.</p>\n\n<p>I can imagine 2 solutions :</p>\n\n<ol>\n<li>cutting up the data in ruby and calling the native method several times with less data.</li>\n<li>increasing the ruby stack size.\nHowever both these solutions are unideal for my project, for performance/resource issues.</li>\n</ol>\n\n<p>Is there any other way I can reduce the usage of the stack by my program ?</p>\n"}]